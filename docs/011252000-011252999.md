# StackOverflow 问答 11252000-11252999

# mysql - 根据 MySQL 中的特定月份检索所有记录

> ID：11252000
> 
> 赞同：0
> 
> 时间：2012-06-28T20:00:47.037
> 
> 标签：mysql

我表中的日期是以下格式的字符串：

```
"10/12/2009" 
```

现在如何获得一个月的所有记录，比如说六月（提供数字“6”）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:04:02.080

检查 MySQL 函数[STR_TO_DATE](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)。

但是，您不应该将日期存储为字符串。使用日期类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:30:19.507

对您的问题的简短回答是，您可以使用`STR_TO_DATE`and`MONTH`函数来 1）将字符串表示形式转换为 DATE，以及 2）从日期中提取月份部分：

```
SELECT t.*
  FROM mytable t
 WHERE MONTH(STR_TO_DATE(t.dateasstringcol,'%M/%d/%Y')) = 6 
```

（这里假设到 '10/12/2009'，您指定的是 10 月 12 日，而不是 12 月 10 日。如果不是这种情况，您需要调整格式字符串。）

或者，如果月份确实是日期的前导部分，您可以进行简单的字符串比较，如果月份是前导部分：

```
SELECT t.*
  FROM mytable t
 WHERE t.dateasstringcol LIKE '6/%' 
    OR t.dateasstringcol LIKE '06/%' 
```

（如果您为表示日期的字符串值指定了精确格式，则可以消除其中一个谓词：如果月份始终存储为两位数 - 或者 - 月份永远不会以前导零存储。）

如果您要传递该月的参数，例如“6”，那么您可以构建您的语句，如下所示：

```
 WHERE t.dateasstringcol LIKE '6' + '/%' 
```

如果月份是日期的第二个组成部分，那么您可以使用：

```
SELECT t.*
  FROM mytable t
 WHERE t.dateasstringcol LIKE '%/' + '6' + '/%' 
    OR t.dateasstringcol LIKE '%/' + '06' + /%' 
```

**笔记：**

前面的所有示例查询都将返回任何一年（2009 年、2010 年、2011 年）六月的行

您可以扩展这些示例，并对年份执行类似的操作，使用 YEAR 函数代替 MONTH 函数，或用于字符串比较

```
 AND t.dateasstringcol LIKE '%/%/2011' 
```

通常，我们会使用日期范围提取特定年份特定月份的行，例如：

```
SELECT t.*
  FROM mytable t
 WHERE MONTH(STR_TO_DATE(t.dateasstring,'%M/%d/%Y')) >= '2011-06-01'
   AND MONTH(STR_TO_DATE(t.dateasstring,'%M/%d/%Y')) <  '2011-07-01' 
```

当然，当日期值存储为`DATE`数据类型而不是 VARCHAR 时，这意味着我们不需要 STR_TO_DATE 和 MONTH 函数，我们可以指定与本机 DATE 列的比较。这种方法允许我们在日期列上使用索引，这可以提高对大表的查询性能。

```
SELECT t.*
  FROM mytable t
 WHERE t.realdatecol >= '2011-06-01'
   AND t.realdatecol <  '2011-07-01' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:04:37.727

STR_TO_DATE 函数在这里是您的朋友：

```
SELECT * FROM my_table
WHERE STR_TO_DATE('10/12/2009','%M/%d/%Y') >= '2012-06-01'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-20T09:38:14.403

如果我们想要当前月份或特定月份的数据，[MONTH应该在这里有所帮助。](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_month)例如：

```
$month = date('m'); OR particular month.
SELECT * FROM users WHERE MONTH(str_to_date("10/12/2009",'%e/%m/%Y')) = $month; 
```

# c# - WPF StringFormat 在 .Net 3.5 和 4.0 中不同

> ID：11252005
> 
> 赞同：1
> 
> 时间：2012-06-28T20:01:19.130
> 
> 标签：c#, .net, wpf

在属性绑定中使用 StringFormat 时，.Net 3.5 和 4.0 有什么区别？

我有一个 WPF 窗口，其中只有一个文本框，其 Text 属性绑定到 double 类型的属性。在 3.5 中，当我编辑数字时，文本框按预期工作，但在 4.0 中，我只能编辑小数位的一侧，使用退格或删除会导致出现奇怪的格式并覆盖数据。展示这一点的最佳方式是尝试针对不同框架的示例。

```
 <TextBox FontSize="16" Text="{Binding Path=SetPoint, UpdateSourceTrigger=PropertyChanged, StringFormat=0.000}"  Margin="185,130,209,146" /> 
```

我还注意到，当我删除 UpdateSourceTrigger 时，.Net 4.0 就像 3.5 版本一样工作。UpdateSourceTriggers 在不同版本中是否颠倒了？

```
 <TextBox FontSize="16" Text="{Binding Path=SetPoint, StringFormat=0.000}"  Margin="185,130,209,146" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T02:56:52.377

我相信这个[Microsoft Connect](https://connect.microsoft.com/VisualStudio/feedback/details/588343/changed-behaviour-from-net-3-5-to-net-4-0-of-wpf-textbox-formatting-when-proper)问题描述了您所看到的问题。

> > 在 3.5 中，绑定将在每次击键后将新值写回源，而不更改 TextBox 文本。但是该文本可能无法准确地表示源的值，可能是因为它不包括格式和转换，或者因为源将值（在属性设置器中）更改为其他值。这导致了频繁和激烈的抱怨——人们希望 TextBox 显示源的值，就像 TextBlock 绑定到具有相同转换器和格式的相同属性时一样。UI 应该显示数据中的实际内容，而不是最终用户键入的内容。
> > 
> > 为了修复 4.0 中的此类错误，绑定现在在每次更新后将格式和转换应用于源的新值。（LostFocus 绑定在 3.5 中已经这样做了。）TextBox 现在显示数据中的内容，但这会使用户的输入更加复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:51:35.697

标准 WPF 在 xaml 代码中有点不同，使用：

```
.., StringFormat={}{0:C2}}"
.., StringFormat={}{0:dd/MM/yyyy}}" 
```

其他示例：
[http ://elegantcode.com/2009/04/07/wpf-stringformat-in-xaml-with-the-stringformat-attribute/](http://elegantcode.com/2009/04/07/wpf-stringformat-in-xaml-with-the-stringformat-attribute/)
[http://www.codeproject.com/Articles/195436/Formatting-text -在-Silverlight-XAML-使用-StringFo](http://www.codeproject.com/Articles/195436/Formatting-text-in-Silverlight-XAML-using-StringFo)

# c# - 更改 Crystal Report 的 XML 数据源

> ID：11252007
> 
> 赞同：5
> 
> 时间：2012-06-28T20:01:40.020
> 
> 标签：c#, xml, ado.net, crystal-reports

我创建了一个 Crystal Report 并将其连接到位于`C:\SomeDir\Data.xml`.

在运行时，我可能需要将数据放入`C:\SomeOtherDir\Data.xml`.

到目前为止，我的代码如下所示：

```
ReportDocument report = new ReportDocument();
report.Load("Report.rpt");
PrinterSettings printerSettings = new PrinterSettings();
PageSettings pageSettings = printerSettings.DefaultPageSettings;
report.PrintToPrinter(printerSettings, pageSettings, false); 
```

这将打印带有数据的报告`C:\SomeDir\Data.xml`。我希望它在`C:\SomeOtherDir\Data.xml`.

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T18:46:26.213

```
ReportDocument report = new ReportDocument();
report.Load("Report.rpt");

DataSet reportData = new DataSet();
reportData.ReadXml(@"C:\SomeOtherDir\Data.xml");
report.SetDataSource(reportData);

PrinterSettings printerSettings = new PrinterSettings();
PageSettings pageSettings = printerSettings.DefaultPageSettings;
report.PrintToPrinter(printerSettings, pageSettings, false); 
```

如果 XML 的架构发生变化，您需要在 CR 编辑器中打开报表并“验证数据库”以更新其绑定的架构，否则会抛出神秘的“登录失败”错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-23T22:10:12.907

```
Imports CrystalDecisions.Shared
Imports CrystalDecisions.CrystalReports.Engine
Imports BL

Public Class frmRptViewer
    Dim strReportName As String
    Dim ds As New DataSet
    Public bl As New BL.InvoiceBL
    Private Sub configureCrystalReports()
        Dim strReportName As String
        Try
            strReportName = "Inv"
            ds = bl.FillHDDT(TrnCode)
            Dim strReportPath As String = Application.StartupPath & "\Reports\" & strReportName & ".rpt"
            Dim rptDocument As New CrystalDecisions.CrystalReports.Engine.ReportDocument
            ds.WriteXml(Application.StartupPath & "\xmlFiles\INVOICE.xml", XmlWriteMode.WriteSchema)
            rptDocument.Load(strReportPath)

            Dim crpConnectionInfo As New CrystalDecisions.Shared.ConnectionInfo
            With crpConnectionInfo
                .ServerName = Application.StartupPath & "\xmlFiles\INVOICE.xml"
                .DatabaseName = "NewDataset"
                .UserID = ""
                .Password = ""
            End With

            Dim tblCurrent As Table
            Dim crpTableLogOnInfo As New CrystalDecisions.Shared.TableLogOnInfo()
            For Each tblCurrent In rptDocument.Database.Tables
                tblCurrent.LogOnInfo.ConnectionInfo.ServerName = Application.StartupPath & "\xmlFiles\INVOICE.xml"
                tblCurrent.LogOnInfo.ConnectionInfo.DatabaseName = "NewDataset"
                tblCurrent.LogOnInfo.ConnectionInfo.UserID = ""
                tblCurrent.LogOnInfo.ConnectionInfo.Password = ""
                tblCurrent.LogOnInfo.ConnectionInfo.Type = CrystalDecisions.Shared.ConnectionInfoType.MetaData
            Next
            rptDocument.Database.Tables(0).SetDataSource(ds.Tables("Table"))
            rptDocument.Database.Tables(1).SetDataSource(ds.Tables("Table1"))

            crptViewer.ShowRefreshButton = False
            crptViewer.ShowCloseButton = False
            crptViewer.ShowGroupTreeButton = False
            crptViewer.ReportSource = rptDocument
        Catch ex As Exception
        End Try
    End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T15:30:12.557

在 Java 中，如果我希望在运行时替换一组新数据，我通常会加载该数据（无论是来自 db 或 xml 的结果集还是其他），然后通过 rpt.Database.Tables.setDataSource 将其推送原始数据的“表别名”，因此 CR 知道要覆盖什么。在 C# 中可能会类似。您可能想复习一下，尝试一下，然后再提出更多问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-05T10:39:42.663

如果您需要从头开始，请考虑您需要使用 XML 在 Crystelreport 中打印 DataGridView 数据

```
**(This is very helpful if you not using any database)** 
```

1.  首先制作数据表
2.  然后将数据添加到数据表（这里从 DataGridview 添加）
3.  制作 XML 文件
4.  运行报告

这里示例代码

```
 DataTable dt = new DataTable();
 dt.Columns.Add("Item_Id", typeof(string));
 dt.Columns.Add("Categry", typeof(string));
 dt.Columns.Add("Item_Name", typeof(string));
 dt.Columns.Add("Unit_Price", typeof(double));
 dt.Columns.Add("Quantity", typeof(int));
 dt.Columns.Add("Discount", typeof(string));
 dt.Columns.Add("Total_Payable", typeof(double));
  foreach (DataGridViewRow dgr in DGVsell.Rows) 
 {
   dt.Rows.Add(dgr.Cells[0].Value, dgr.Cells[1].Value, dgr.Cells[2].Value, dgr.Cells[3].Value, dgr.Cells[4].Value, dgr.Cells[5].Value, dgr.Cells[6].Value);
 }
 ds.Tables.Add(dt);
 ds.WriteXmlSchema("Bill.xml"); 
```

**注意**如果在制作 Xml 更改*App.config*文件时出错，如下所示

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  </startup>-->
    <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

生成xml文件后，可以调用Crystel报告

```
 frmreport obj = new frmreport(); //load report viwer form
 obj.ShowDialog(); 
```

在报告查看器中

```
crBill cr = new crBill();
cr.SetDataSource(frmSell.ds);
crystalReportViewer1.ReportSource = cr;
crystalReportViewer1.RefreshReport();
crystalReportViewer1.Refresh(); 
```

# qt - 在 PySide 中保持 QtTableWidget 和列表同步的正确方法是什么？

> ID：11252011
> 
> 赞同：0
> 
> 时间：2012-06-28T20:02:13.450
> 
> 标签：qt, pyside, qtablewidget

我有一个简单的清单： `mylist = ["foo", "bar", "baz"]`

和一个带有 1 列的 QtTableWidget。我想让 mylist 中的数据与 QtTableWidget 中的数据保持同步，包括允许拖放重新排序（即，用户可以这样做，并`mylist`得到更新）和编程更改（即，我更新`mylist`并且表格得到更新）。

这样做的*正确*方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:44:41.137

请注意，通常在 Qt/C++ 中无法将通用数据结构与视图链接起来。模型是这样的仪器数据结构，允许与视图进行简单的链接——通用列表，比如`QStringList`不能那样使用。

在 Python 中，应该可以将属性注入到任何列表的现有实例中，以将其转换为模型，通知其视图对其所做的更改。我不知道是否有任何 Qt 到 Python 的桥可以做这种事情，我只能给出 C++ 的观点。欢迎了解 PyQt 或 PySide 的人加入并酌情进行编辑。

使用 a[`QStringListModel`](http://qt-project.org/doc/qt-4.8/qstringlistmodel.html)作为模型。在视图上启用拖放重新排序，如下所示：

```
view.setDragEnabled(true);
view.setDropIndicatorShown(true);
view.setDragDropMode(QAbstractItemView::InternalMove); 
```

我的[另一个答案](https://stackoverflow.com/a/11237916/1329652)[`QListWidget`](http://qt-project.org/doc/qt-4.8/qlistwidget.html)有一个完整的例子，它使用带有内置模型的便利小部件。作为起点，这可能会更好，对于可以用鼠标合理操作的列表，这是一个不错的选择。一般来说，如果一个模型有 100 多个项目，如果没有进行实时查找或某种修剪的方法，只用鼠标就无法轻松操作它——滚动这么多项目是可用性的噩梦。所以不要这样做。

Qt 的文档将是一个很好的开始学习的平台。阅读[模型/视图框架](http://qt-project.org/doc/qt-4.8/model-view-programming.html)。然后查看[`QStringListModel`](http://qt-project.org/doc/qt-4.8/qstringlistmodel.html)您选择的视图，例如[`QTableView`](http://qt-project.org/doc/qt-4.8/qstringlistmodel.html)或[`QListView`](http://qt-project.org/doc/qt-4.8/qlistview.html)。

# android - onClick() 简单问题

> ID：11252013
> 
> 赞同：0
> 
> 时间：2012-06-28T20:02:22.323
> 
> 标签：android, onclick

我有一个（简单的）逻辑问题`onClick()`。

我的代码看起来像这样。

```
Myobject myobject ;
onCreate() {
    ...
    myobject = ... ;
    Button button=...
    button.setOnClickListener(new OnClickListener() {   
        public void onClick(View v) {
        }
    });
} 
```

在 my`onClick()`中，我注意到我无法访问 myobject。它的值始终为 null（但不在`onClick()`.

所以，我的问题很简单。如何访问myobject里面`onClick()`？（并且没有将 myobject 设置为 final）。

谢谢回答 ！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:31:00.030

这是部分格式化的代码。在我的 xml 布局中，我在底部有一个列表视图和一些按钮。

如果我启动此代码并单击我的按钮，我将得到以下结果：

Asu : thenameim正在寻找

阿苏：空

阿苏：空

```
public class AlertSetupEditorActivity extends Activity{

private ListView listView2;
AlertSetupEditorAdapter adapter;

AlertSetUpObject asu = new AlertSetUpObject();

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);

setContentView(R.layout.alertsetupeditorlistview);  

    asu = getAsu();
    Log.d("debug","Asu :"+asu.getName());

Button button = (Button)findViewById(R.id.btn_gauche);
button.setOnClickListener(new OnClickListener() {

    public void onClick(View v) {
        Log.d("debug","Asu :"+asu.getName());
                    Log.d("debug","Asu: "+AlertSetupEditorActivity.this.asu.getName());

    }
});

   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:12:23.510

您可以访问类级别的变量，例如，

```
YourClassName.this.classLevelVariableName.someMethod(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:08:10.380

很难说，因为您的代码在您的问题中的格式不正确，但我会尝试回答以下问题。

如果您完全引用您的 MyObject，例如`myActivity.this.myobject`您应该能够访问该变量。从活动中的代码中，您可以通过在活动类名称前面加上前缀来访问活动“this”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:09:36.413

看看我是如何设置我的 Context ctx 的，这就是你要找的。根据使用方式，您可能还需要做一些线程工作。

```
public class WineSearch extends Activity {

    private static String[] names;
    private static float[] ratings;
    private static int[] ids;

    ListView lv;
    Context ctx;
    TextView searchHeader;
    ProgressDialog prgDiag;
    Spinner spn;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ctx = this;

        searchHeader = (TextView) findViewById(R.id.SearchHeader);
        lv = (ListView) findViewById(R.id.WineListView);
        spn = (Spinner) findViewById(R.id.ListSpin);

        ArrayAdapter adapter = ArrayAdapter.createFromResource( this, R.array.list_choice, android.R.layout.simple_spinner_item); 
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spn.setAdapter(adapter);
        spn.setOnItemSelectedListener(new OnItemSelectedListener() {
          @Override
          public void onItemSelected(AdapterView<?> parent, View view, int position, long arg3) {
            Toast.makeText(parent.getContext(), parent.getItemAtPosition(position).toString(), Toast.LENGTH_LONG).show();
          }

          @Override
          public void onNothingSelected(AdapterView<?> arg0) {

          }     
        });

        prgDiag = new ProgressDialog(this);
        prgDiag.setCancelable(false);

        this.refreshList();
    } 
```

# java - 如何在 Wicket 应用程序中生成唯一链接？

> ID：11252017
> 
> 赞同：1
> 
> 时间：2012-06-28T20:02:41.417
> 
> 标签：java, wicket

我们的 Wicket 1.5 应用程序有很多用于不同任务的链接。我们要求我们的应用程序生成的链接必须是唯一的（并且不可收藏）。

我们怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:23:27.460

默认情况下，每个链接都不可添加书签，因为它包含页面版本 ID 并绑定到特定会话。

编辑：可添加书签的链接和无状态页面是此规则的例外。不要使用它们，你是安全的。

第二次编辑：为了确保在当前会话中没有来自另一个会话的有效 URL，您可以通过使用或实现[通常描述的](http://wicketinaction.com/2011/07/wicket-1-5-mounting-pages/)[MountMapper](http://ci.apache.org/projects/wicket/apidocs/1.5.x/org/apache/wicket/request/mapper/mount/MountMapper.html) 为您的链接添加一些独特的值。此映射器可以包含来自当前网络会话的变量作为参数，并在读取 URL 时检查该值...

# oracle - 我正在尝试用 like 搜索长列，但 Oracle 抱怨

> ID：11252018
> 
> 赞同：3
> 
> 时间：2012-06-28T20:02:43.127
> 
> 标签：oracle, constraints, sql-like

请注意，我们使用的是 11g，我别无选择。我正在查看 all_constraints 并尝试检查 search_condition 列，如下所示：

```
 select * from all_constraints
   where table_name = UPPER('STVTERM') AND 
   constraint_type = 'C' AND 
   CAST(search_condition AS VARCHAR2(100)) NOT LIKE '%IS NOT NULL'; 
```

我希望将其放入一个快速而肮脏的过程中，该过程会吐出一个 Grails 域。约束是唯一缺​​失的部分。有没有一种简单的方法可以排除那些“不为空”的约束，而不是我缺少的地方/类似的地方？我已经尝试了明显的，Oracle 也不愿将 long 转换为 varchar 然后检查。由于我可能想要对此列进行其他操作，因此我创建了一个执行 kludgy PL-SQL 转换、检查并返回“匹配/不匹配”结果的函数的一些解决方案不是也有很大帮助。

有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T01:27:38.727

为了后代，这是我在尝试解决相同问题时使用的：

```
-- Create the decoder function

create function funk_decode( p_cons_name in varchar2 ) return varchar2
    authid current_user
    is
        l_search_condition user_constraints.search_condition%type;
    begin
        select search_condition into l_search_condition
          from user_constraints
         where constraint_name = p_cons_name;

       return l_search_condition;
   end;
   /

-- Then use it in your select

SELECT constraint_name, constraint_type, status, search_condition FROM USER_CONSTRAINTS where funk_decode(constraint_name) like '%SEARCH_TERM%';

--- Then clean up
drop function funk_decode; 
```

当然，替换`SEARCH_TERM`为您要查找的任何内容。它基于我在这里找到的一些代码：http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID: [839298816582](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:839298816582)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T06:05:13.867

有一个函数可以将 LONG 转换为 varchar2：

[http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_sql.htm#i1025399](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_sql.htm#i1025399)

# cocoa - 是否有一个组件可以在我的 Cocoa 应用程序中为我提供一个日志记录控制台？

> ID：11252019
> 
> 赞同：1
> 
> 时间：2012-06-28T20:02:45.023
> 
> 标签：cocoa, logging

是否有框架或其他东西可以为我的 Mac Cocoa 应用程序提供一个带有应用程序控制台输出的窗口，可能还有一些不错的格式化和过滤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:51:35.130

这不是一个常见的需求，因此似乎不太可能有人会坐下来接受成熟的实现。但是[自己实现它](https://stackoverflow.com/questions/2406204/what-is-the-best-way-to-redirect-stdout-to-nstextview-in-cocoa)并不太难。

但是，我会质疑您是否真的想向用户显示所有标准输出和/或标准错误。库和框架可能会出乎意料地冗长并抛出您可能不想要的控制台消息。拥有一个打印到文本视图的特殊日志功能对我来说似乎是一个更好的主意。

# c++ - 从给定数字中查找和删除数字

> ID：11252021
> 
> 赞同：-4
> 
> 时间：2012-06-28T20:02:53.860
> 
> 标签：c++

例如，用户输入 digit `542035`。应用程序必须从给定的数字中删除所有`5`s 和`0`s 并打印`423`。想不出一个简单的方法来写像“查找并删除”数字中的所有 0 和 5 之类的东西？有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T20:04:37.273

将数字转换为字符串，执行替换（将数字替换为“”），显示结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:17:51.070

这是一个使用 C++11 的示例。

**注意：**如果这是一个家庭作业问题，这可能*不是*老师想要的答案，尽管它是惯用的。

```
#include <string>
#include <algorithm>
#include <iostream>

int main()
{
   std::string s("542035");

   std::cout << "Input: " << s << "\n";

   auto new_end = std::remove_if(
      s.begin(),
      s.end(),
      [] (const char c) -> bool
   {
      switch(c)
      {
      case '5':
      case '0':
         return true;
      default:
         return false;
      }
   });

   s.assign(s.begin(), new_end);

   std::cout << "Result: " << s << "\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:49:38.527

这段代码似乎对我有用。我不确定它是否是最好的解决方案。

```
#include <iostream>
#include <string>
#include <sstream>
#include <vector>
using namespace std;

int main()
{
int userinput;

cin >> userinput;

string s;

stringstream out;

out << userinput;

s = out.str();

cout << s << " " << userinput << endl;

vector<char> editted;

string::iterator it;

for (it = s.begin() ; it < s.end(); it++ )
{
if ((*it) == '5' || (*it) == '0')
{}
else 
editted.push_back((*it));
}

for (int i = 0; i <editted.size(); i++)
{
cout << editted[i] << endl;
} 

return 0;
} 
```

# symfony - Twig 中的目录路径

> ID：11252023
> 
> 赞同：0
> 
> 时间：2012-06-28T20:03:05.460
> 
> 标签：symfony, twig

在我的树枝文件中，我有一个 JS 方法，它需要一个指向位于 web/bundles/bm/swf/.. 中的 flash 文件的路径。我不需要加载特定文件，只需将该方法指向该路径即可。

```
{% block javascripts %}

    {{parent()}}
    <script type="text/javascript" src="{{ asset('bundles/bm/js/soundmanager2.js') }}"></script>

    <script>

        soundManager.url = ''; < needs the path to web/bundles/bm/swf/
        soundManager.onload = function() { }

    </script>
{% endblock %} 
```

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:26:46.747

```
{% block javascripts %}
    {{parent()}}
    <script type="text/javascript" src="{{ asset('bundles/bm/js/soundmanager2.js') }}"></script>

    <script type="text/javascript">
        soundManager.url = '{{ asset('bundles/bm/swf/')}}';
        soundManager.onload = function() { }
    </script>
{% endblock %} 
```

# android - 获取图像视图上的触摸事件坐标

> ID：11252024
> 
> 赞同：0
> 
> 时间：2012-06-28T20:03:07.117
> 
> 标签：android, imageview, screen, touch-event, ontouchlistener

我在 ImageView 上有一个 onTouchListener，我使用 event.getX() 或 getY()。我的目标是在用户触摸我的图像的特定部分时显示图像并启动对话框或其他东西。问题是对于不同的屏幕，我的图像视图的同一部分的 X et Y 值会发生变化。

如何在每个屏幕上以像素为单位获得事件的真实位置？例如，我想显示一个 Android 面孔，并在用户点击他的眼睛时做一些事情......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:18:52.283

编写代码以使用固定分辨率（例如 480x640）检测指定点的触摸。然后使用 DisplayMetrics 获取运行应用程序的设备的分辨率。计算 xScale 和 yScale（例如 DisplayMetrics.widthPixels / 480）并将您的 x 和 y 乘以这些比例因子。

# desire2learn - 向 Desire2Learn Dropbox 提交文件

> ID：11252025
> 
> 赞同：0
> 
> 时间：2012-06-28T20:03:14.197
> 
> 标签：desire2learn

尝试通过 PHP 向 Desire2Learn 学习套件提交文件到 Dropbox。我没有看到记录包含该文件的字段名称。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:13:35.910

不，你没有错过什么。Dropbox 提交的文件没有字段名称。发布提交文件时，将 name 属性保留为空字符串。

提交请求应如下所示：

```
POST http://{domain_name}/d2l/api/le/{version}/{org_unit}/dropbox/folders/{folder_id}/submissions/mysubmissions/?x_a={app_id}&x_b={token_id}&x_d={token_sig}&x_c={app_sig}&x_t={time} HTTP/1.1  
Content-Type: multipart/mixed; boundary=8cf23611201b7ae  
Host: {domain_name}  
Content-Length: 775926

--8cf23611201b7ae  
Content-Type: application/json

{"Text":"Here you go","HTML":null}  
--8cf23611201b7ae  
Content-Disposition: form-data; name=""; filename="Jellyfish.jpg"  
Content-Type: image/jpeg

{binary data}  
--8cf23611201b7ae-- 
```

# c++ - 将 Qt Creator 与 Allegro 一起使用

> ID：11252026
> 
> 赞同：1
> 
> 时间：2012-06-28T20:03:14.453
> 
> 标签：c++, windows, qt-creator, allegro

我想让 Allegro 4 (MSCV 9) 与 Qt Creator 一起工作。我正在使用 Windows XP。我已将这些行添加到我的 .pro 中：

```
INCLUDEPATH += C:/Allegro/include \
LIBS += C:/Allegro/lib/allegro-4.4.2-md.lib \
        C:/Allegro/lib/allegro-4.4.2-monolith-md.lib \
        C:/Allegro/lib/allegrogl-0.4.4-md.lib \
        C:/Allegro/lib/loadpng-1.5-md.lib \ 
```

我的代码如下所示：

```
#include <iostream>
#include <allegro.h>

volatile int closedWindow = false;

void CloseButtonCallback() {closedWindow = true;}
END_OF_FUNCTION(CloseButtonCallback())

int main()
{
    allegro_init();
    set_color_depth(32);
    set_gfx_mode(GFX_AUTODETECT_WINDOWED, 400, 300, 0, 0);
    set_window_title("Testing");

    LOCK_FUNCTION(closeButtonCallback)
    set_close_button_callback(CloseButtonCallback);
    while(!closedWindow){}
    allegro_exit();
    return 0;
}
END_OF_MAIN() 
```

当我尝试编译时，我不断收到这样的错误：

main.obj：-1：错误：LNK2019：**函数“int __cdecl _manangled_main（void）”（？_manangled_main@@YAHXZ）中引用的未解析的外部符号imp__allegro_exit main.obj：-1：错误：LNK2019：未解析的外部符号_imp *_set_close_button_callback*在函数“int __cdecl _mangled_main(void)”(?_mangled_main@@YAHXZ) main.obj:-1 中引用：错误：LNK2019：未解析的外部符号_imp *_set_window_title*在函数“int __cdecl _mangled_main(void)”(?_mangled_main@ @YAHXZ）main.obj：-1：错误：LNK2019：函数“int __cdecl _mangled_main（void）”（?_mangled_main@@YAHXZ）中引用的未解析的外部符号*_imp_set_gfx_mode* main.obj：-1：错误：LNK2019：未解决外部符号*_imp*_set_color_depth 在函数“int __cdecl _mangled_main(void)”(?_mangled_main@@YAHXZ) main.obj:-1: error: LNK2019: unresolved external symbol __imp** _install_allegro_version_check 在函数“int __cdecl _mangled_main(void)”(?_mangled_main@ @YAHXZ）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T17:17:09.247

我正在使用来自[http://www.allegro.cc/files/](http://www.allegro.cc/files/)的 MinGW 的预编译 Allegro 4.4 。我将存档中的这三个文件夹（bin、include、lib）合并到具有相同文件夹的 MinGW 文件夹中。然后添加`LIBS += liballegro-4.4.2-mt`到 .pro 文件中，一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T22:18:47.697

看起来你必须为 Qt 使用 GCC 编译的 Allegro 版本。

就像是

```
LIBS +="path_to_allegro_for_mingw/lib/liballegro-4.4.2-md.a" 
```

GCC 使用不同的名称修饰和不同的导出库，因此即使您使用 Allegro dll，MSVC 编译的 .lib 也无法工作。

# jquery - 抓住最后一个孩子，但不是某个班级

> ID：11252036
> 
> 赞同：1
> 
> 时间：2012-06-28T20:04:07.587
> 
> 标签：jquery

所以我正在尝试这个：`inner.children('.image:not(dont):last-child').width();`

结合 not(classname) 和 :last-child 的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:06:50.690

尝试

```
inner.children('.image:last-child:not(.dont)').width() 
```

# java - 用java铸造，技术信息

> ID：11252040
> 
> 赞同：0
> 
> 时间：2012-06-28T20:04:11.510
> 
> 标签：java, oop, inheritance, casting

我试图了解当有人将一个特定类的对象投射到另一个类时会发生什么。即有两个类

```
 public class Aclass{

   private String attribute1;

   private List<String> attribute2;

   //get/set methods

 }

 public class Bclass{

   private String attribute1;

   private List<int> attribute2;

   //get/set methods

 } 
```

现在在另一个类中，我拥有这两个对象，然后我将它们投射。

```
public class Cclass{

   Aclass aclass=new Aclass();

   //returneddata is a method that returns an Aclass object that contained dta for the Aclass attributes
   aclass=returneddata();

   Bclass bclass=new Bclass();

   bclass=Bclass.class.cast(aclass);

} 
```

从前面提到的类中，我得到了一个 java.lang.ClassCastException。

问题是我有两个类，每个类不只包含两个属性，而是包含两个属性 20。这些属性中的 16 个在两个类中都很常见。

此外，returneddata 方法返回从存储库中检索到的对象。如您所见，我想找到一种方法并将对象 Aclass 的 16 个数据属性传输到对象 Bclass。

我想：

1）找到一种方法将16个公共属性数据从一个对象重写到另一个对象

2) 演员的总体工作方式

有什么提议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T20:08:00.830

这两个类具有相似的属性这一事实并不重要。重要的是它们`Aclass`彼此`Bclass`无关：一个不是另一个的超类。如果您想在这些类之间共享或移动数据，您需要自己将数据从一个实例复制到另一个实例。

### 铸造示例

假设我们有一个对象`Fruit fruit = new Banana();`。现在，如果您需要`Banana`在代码中调用稍后的方法，您可以`fruit`使用 cast 进行转换`(Banana)`。为什么？因为您碰巧知道这`fruit`是 a`Banana`但 Java 编译器不知道（它认为它是 a`Fruit`并且它也可能是不同的水果）。因此，您必须添加演员表以添加有关的附加信息`fruit`并安全地执行操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:12:04.630

两个类 Aclass 和 Bclass 没有公共的超类或接口，因此 ClassCastException。在这种特殊情况下，您可以使用 BeanUtils，[http:](http://commons.apache.org/beanutils/) //commons.apache.org/beanutils/，将公共属性从 Aclass 复制到 Bclass。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T20:16:58.223

Java 类和接口基于它们由`extends`or`implements`关键字定义的关系形成一个 DAG。

如果`A extends B`或`A implements B`，则 B 是 A 的直接超类或超接口。
如果 A 是 B 的直接超类/接口且 B 与 C 类似，则 A 是 C 的间接超类/接口。
类`java.lang.Object`是每个类的超类.

如果 B 是 A 的超类/接口（或者当 A 和 B 是同一个类），则 A 类的对象只能转换为 B。

对于某些构造（数组、原始类型）也有一些特殊规则，但上述规则应该清楚地说明为什么您的演员表不起作用。

完整的描述可以在[这里](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.5.1)找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-28T20:19:55.950

这里最好的解决方案是编写包含两个类的公共元素的超类，然后让你的每个子类扩展超类，这样你就可以拥有一个 SuperClass 类型的列表

```
public class SuperClass{
   protected String att1_common;
   protected List<String> att2_common;
}

import SuperClass
public class Aclass extends SuperClass {
   private String uniqueAtt1; 
   //get/set methods
}

import SuperClass
public class Bclass extends superClass{
   private String uniqueAtt1;
   //get/set methods
} 
```

注意受保护的范围修饰符，这意味着除了子类之外是私有的

所以现在：

```
List<SuperClass> listofstuff;
try{ Aclass item = listofstuff[0];}
catch( java.lang.ClassCastException e){try Bclass item = listofstuff[0];} 
```

# jquery - 通过上一个和下一个按钮在 DIV 中旋转

> ID：11252042
> 
> 赞同：2
> 
> 时间：2012-06-28T20:04:21.150
> 
> 标签：jquery, html

我想创建一个函数，通过点击“下一步”按钮来循环遍历 3 个 DIV 块，该按钮将在面板的 1、2 和 3 之间连续旋转。点击“Prev”按钮将返回上一个 DIV 面板。

真的，我只想循环浏览几个 DIVS 面板 - 隐藏和显示它们中的每一个，效果与 jsFiddle 相同。

我知道很多让函数循环执行的肮脏方法，但我知道有一种更简单的方法，而不是为每个步骤和按钮添加类、单独的函数。

这是我的jsFiddle。单击下一个按钮，您将看到我希望如何循环“面板”。

[http://jsfiddle.net/QWQYS/](http://jsfiddle.net/QWQYS/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:13:59.150

[http://jsfiddle.net/QWQYS/4/](http://jsfiddle.net/QWQYS/4/)

编辑了您的小提琴，以便下一个按钮起作用。如果您也希望我执行上一个按钮，请告诉我。它只是查看可见的面板，将其隐藏，然后在代码中显示下一个面板。

编辑：也添加了上一个按钮功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:11:07.477

[http://jsfiddle.net/QWQYS/1/](http://jsfiddle.net/QWQYS/1/)

NEXT 按钮跟踪它所在的面板（并设置初始面板），允许无限制地更改面板。对 PREV 执行相同操作应该相当简单（当然，您必须在一个位置跟踪当前面板）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:01:52.267

如果在我的滑块中使用类似的结构，

**JS**

```
var active = 0;
$('.btn').click(function() {
    var $btn = $(this);
    var $box = $('#area-wrap').find('.box'); 
    $box.eq(active).slideUp(function() {
        if ($btn.hasClass('next')) {
            if (active == $box.length - 1) {
                active = 0;
            }
            else {
                active ++;
            }
        }
        else {
            if (active == 0) {
                active = $box.length - 1;
            }
            else {
                active --;
            }
        } 
        $box.eq(active).delay(500).slideDown();
    });

});​ 
```

**标记：**

```
<div id="area-wrap">

    <!-- First Panel (Start) -->
    <div class='box'>
    <div class="left-panel1">1st Panels</div>
    <div class="right-panel1">1st Panels</div>
    </div>
    <!-- Second Panel (Hidden) -->
    <div class='box hidden'>
        <div class="left-panel2">2nd Panels</div>
        <div class="right-panel2">2nd Panels</div>
    </div>
    <!-- Third Panel (Hidden) -->
    <div class='box hidden'>
    <div class="left-panel3" >3rd Panels</div>
    <div class="right-panel3">3rd Panels</div>
    </div>
    <div style="clear:both"></div>

    <div class="btn next">NEXT</div>
    <div class="btn prev">PREV</div>

</div>​ 
```

并添加

```
.hidden{
display:none;
} 
```

到 CSS。

[演示](http://jsfiddle.net/zpSrj/4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:15:39.053

[http://jsfiddle.net/QWQYS/1/](http://jsfiddle.net/QWQYS/1/)

服用@Explosion Pills 并做到了，所以当你在第 3 次时，它会在你下一次击球时回到第 1 次。

# asp.net - 合并后面的代码

> ID：11252049
> 
> 赞同：1
> 
> 时间：2012-06-28T20:05:00.833
> 
> 标签：asp.net, .net, forms

我正在尝试将我找到的.net 代码后面的一些代码与原始代码合并。Ultimatley，我正在尝试创建一个允许文件附件的表单。我所做的一切都会产生错误，并且找不到可以识别我的问题的站点。这是表单的代码...

```
<form id="form1" runat="server">
    <asp:FileUpload id="FileUploadControl" runat="server" />
    <asp:Button runat="server" id="UploadButton" text="Upload" onclick="UploadButton_Click" />
    <br /><br />
    <asp:Label runat="server" id="StatusLabel" text="Upload status: " />
</form> 
```

这是背后的代码。

```
protected void UploadButton_Click(object sender, EventArgs e)
{
    if(FileUploadControl.HasFile)
    {
        try
        {
            string filename = Path.GetFileName(FileUploadControl.FileName);
            FileUploadControl.SaveAs(Server.MapPath("~/") + filename);
            StatusLabel.Text = "Upload status: File uploaded!";
        }
        catch(Exception ex)
        {
            StatusLabel.Text = "Upload status: The file could not be uploaded. The following error occured: " + ex.Message;
        }
    }
} 
```

如何将这些合并到一个页面上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:55:18.293

在文件的开头，添加这个...

```
 <%@ Page Language="C#" %>
 <script runat="server">
 [code goes here]
 </script>
 <html>
 [page continues here] 
```

我个人不建议将代码和标记放在同一页面上 - 我认为它们应该放在单独的文件中

# css - 如果不适合则隐藏 DIV

> ID：11252054
> 
> 赞同：1
> 
> 时间：2012-06-28T20:05:31.877
> 
> 标签：css, css-float

我有一个包含 3 个框的包装器（绿色：300 像素，蓝色：200 像素和黄色：100 像素）。容器的宽度可以是 500 像素或 300 像素。

我想要的是，在包装器的宽度为 500px 的情况下，绿色和蓝色框对齐，黄色被隐藏（案例 A）。在另一种情况（B）中，如果包装器的宽度为 300px，我希望绿色框位于顶部，而其他 2 个框在底部对齐。

有没有办法做到这一点？

所有高度都相等（例如 100px）

**更新**：我无法提前控制包装的宽度。所以我需要一个适用于这两种情况的解决方案，而不是 2 种解决方案（每个适用于 1 种情况）。

![](../Images/822cd787d7698cbfbab15073ceb3b805.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:29:59.267

```
<!doctype html>
<html>
    <head>
        <title>Demo</title>
        <style>
            #caseA {width: 500px; float: left;}
            #caseB {width: 300px; float: left; clear: both; margin-top: 100px;}
            #caseA > div, #caseB > div {height:100px; position: relative;}

            .boxGreen {background-color:green; width: 300px; float: left; z-index: 3;}
            .boxBlue {background-color:blue; width: 200px; float: right; z-index: 2;}
            .boxYellow {background-color:yellow; width: 100px; float: right; margin-left:-100px; z-index: 1;}
        </style>
    </head>
    <body>
        <div id="caseA">
            <div class="boxGreen"></div>
            <div class="boxBlue"></div>
            <div class="boxYellow"></div>
        </div>

        <div id="caseB">
            <div class="boxGreen"></div>
            <div class="boxBlue"></div>
            <div class="boxYellow"></div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:29:33.557

我想你想要这样的[东西](http://jsfiddle.net/oswaldoacauan/FKDNP/5/)？

**更新**：[现在](http://jsfiddle.net/oswaldoacauan/FKDNP/5/)使用@media 查询。

PS。调整小提琴 html painel 的大小以查看结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:19:03.983

这个怎么样：

```
<style>
    #wrapper{
        overflow:hidden;
    }
    .wide{
        width:500px;
        height:100px;
    }
    .narrow{
        width:300px;
        height:200px;
    }
    #green{
        width:300px;
        height:100px;
        background-color:Green;
        float:left;
    }
    #blue{
        width:200px;
        height:100px;
        background-color:Blue;
        float:right;
    }
    #yellow{
        width:100px;
        height:100px;
        background-color:Yellow;
        float:left;
    }
</style>

<div id="wrapper" class="wide">
    <div id="green">&nbsp;</div>
    <div id="blue">&nbsp;</div>
    <div id="yellow">&nbsp;</div>
</div> 
```

然后，当您需要切换样式时，您可以来回交换 2 个类。

# javascript - 在 rails/html/js 中创建时间线

> ID：11252056
> 
> 赞同：1
> 
> 时间：2012-06-28T20:05:37.170
> 
> 标签：javascript, ruby-on-rails, html, html5-canvas

我正在开发一个包含事件的 Rails 应用程序，我希望能够显示事件的时间线。有一个 Event 模型，而事件有一个`start_date`和`end_date`。

我可以按日期等显示事件而没有任何问题。但是，我想做的是创建一个水平的“时间线”，类似于 Github 上的网络图。基本上我希望能够绘制一个图表，其中包含从开始日期到结束日期的线条，对于任何给定的事件集，我希望顶部的时间线从最早事件的日期开始，然后以均匀的时间增量水平跨越到最后一个事件的结束日期。

你将如何在 HTML / JS 中完成类似的事情？我相信我对服务器端的了解足以从应用程序中提取任何需要的数据，我不明白如何从中获取视图。老实说，我什至不知道从哪里开始。

我非常感谢有关如何着手解决此问题的任何反馈或建议。我意识到这个问题比理想问题更开放，我很乐意尝试使其更具体以回应评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:45:54.347

试试[event_calendar ，你可能会](https://github.com/elevation/event_calendar)[在这里](http://dev.elevationblog.com/2009/7/23/event-calendar-rails-plugin)看到一些屏幕截图，这是[railscast](http://railscasts.com/episodes/213-calendars)

HTH :)

# ios - NSLayoutConstraint 使 ViewController 崩溃

> ID：11252057
> 
> 赞同：105
> 
> 时间：2012-06-28T20:05:37.920
> 
> 标签：ios, nslayoutconstraint

> **可能重复：**
> [presentViewController：在 iOS 6 上崩溃（自动布局）](https://stackoverflow.com/questions/11198981/presentviewcontroller-crash-on-ios-6-autolayout)

单击应用程序中的按钮时出现此错误：

```
2012-06-28 21:43:36.860 AppName[2403:707] *** Terminating app due to uncaught exception 'NSInvalidUnarchiveOperationException', reason: 'Could not instantiate class named NSLayoutConstraint'
*** First throw call stack:
(0x3568788f 0x37a2e259 0x35687789 0x356877ab 0x333a254d 0x333a26bb 0x333a2423 0x33333001 0x332a13c7 0x3317ec59 0x330f4c17 0x330ff267 0x330ff1d5 0x3319e59b 0x3319d367 0x331f86a7 0x8fb11 0x355e13fd 0x330d6e07 0x3319c5e7 0x355e13fd 0x330d6e07 0x330d6dc3 0x330d6da1 0x330d6b11 0x330d7449 0x330d592b 0x330d5319 0x330bb695 0x330baf3b 0x3727a22b 0x3565b523 0x3565b4c5 0x3565a313 0x355dd4a5 0x355dd36d 0x37279439 0x330e9cd5 0x8f6cb 0x8f628)
terminate called throwing an exception 
```

错误抱怨这行代码：

```
-(IBAction) goToAbout {
    About *screen = [[ About alloc] initWithNibName:@"About" bundle:nil];
    screen.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    [self presentModalViewController:screen animated:YES];
} 
```

该错误仅出现在我的 iPhone 上，但不在模拟器上...

* * *

## 回答 #1

> 赞同：263
> 
> 时间：2012-06-28T20:10:27.097

`NSLayoutConstraint`在尝试在不支持新类的设备上运行此东西之前，您必须取消选中 NIB 中显示“使用自动布局”的框。

![在此处输入图像描述](../Images/a3d97f32429731ad22df82959ac274fa.png)

# c# - 当我在 Visual Studio 中调试时，UI 的行为有所不同

> ID：11252060
> 
> 赞同：0
> 
> 时间：2012-06-28T20:05:49.030
> 
> 标签：c#, wpf, xceed-datagrid

我在 xceed 网格中使用了一些拖放功能。当我尝试将项目向下拖动一行时，它不起作用。但是如果我在我的 drop 方法中设置一个断点然后执行 drop，当我回到 UI 时它已经改变了。无论我是否闯入代码，什么可能导致它的行为不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:40:25.117

如果您使用调试器断点“暂停”您的应用程序，系统的状态（例如鼠标按钮状态）可能会在暂停时发生变化，因此当您允许程序继续运行时会有所不同。这可能会导致与程序正常运行时截然不同的行为。因此，使用断点调试拖放问题通常是不可能的。

在这些情况下，一个好的方法通常是回到基础并使用 a `Debug.WriteLine`（或类似的）在变量“正常”运行时转储有关变量状态的有用信息（而不是用断点杀死它）。然后，您可以在程序完成拖动后，在闲暇时检查这些转储信息，以便了解过程中每个阶段发生的情况并找出失败的原因。

# emacs - 在 lisp 程序结束后继续的 emacs lisp 中的启动进程

> ID：11252061
> 
> 赞同：2
> 
> 时间：2012-06-28T20:05:54.487
> 
> 标签：emacs, elisp

如何在 emacs lisp 程序结束后启动将继续运行的 emacs lisp 进程？我正在编写一个应该启动交互式 GUI 程序并退出的实用程序脚本。

提前致谢。

编辑：我想我正在寻找这个 C++ 代码的 emacs lisp 等价物。

```
#include <cstdlib>
#include <sys/types.h>
#include <unistd.h>

int main() {
    using namespace std;

    pid_t p = fork();
    if (p == 0) {
        // child process
        execl("process_to_run", "process_to_run", nullptr);
    } else {
        // stuff for parent to do
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T08:33:54.450

据我所知，没有任何方法可以阻止 Emacs 在退出时终止其子进程，无论是同步、异步还是通过`shell-command`. 如果您使用任何 Emacs 原语来执行子进程（即，`start-process`或`call-process`它们的变体）并尝试在进程完成之前退出 Emacs，Emacs 总是会提示您终止它们，或者如果您设置了自动终止它们`process-query-on-exit-flag`为`nil`每个所述过程。尝试使用某种基于 shell 的hackery`shell-command`以及诸如, ,等`bash`内置函数是没有意义的，因为最终会调用上述或原语。`bg``disown``setsid``shell-command``start-process``call-process`

顺便说一句，我认为 ELisp 是一个非常糟糕的脚本选择（如果您的脚本不是完全用 ELisp 编写的，那么我无法理解为什么需要从 Emacs 本身执行子进程）。您可能会考虑的一种可能性是将 Emacs 作为守护程序启动（它会自动将 Emacs 从控制终端分离并启动`emacsclient`可以与之通信的服务器进程）并使用`emacsclient -e`它来向它发出命令。我不知道这是否适用，但它可能有用。

您还没有真正提供有关您的脚本的任何细节，因此目前很难提供任何进一步的具体建议。我会这样说：明智的做法是简单地编写脚本中需要独立于 Emacs 运行的部分，`bash`并使用其作业控制机制（即运行后台进程和`disown`它等），或其他一些脚本语言，例如 Perl（我相信它明确地有自己的`fork()`功能）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-26T16:17:42.820

它可能无法完全回答您的问题，但以下软件包与您想要的非常相似：[https ://bitbucket.org/jpkotta/openwith/overview](https://bitbucket.org/jpkotta/openwith/overview)

它基本上用外部程序（如 okular、gimp...）打开一个文件，然后

> “在 Unix 上将命令包装在 nohup 中，因此如果 Emacs 退出，启动的进程将不会退出。”

我不知道它的实现细节，但你可以尝试阅读他们的代码。为我工作。

# javascript - 在 iPad 上播放 HTML5 视频并寻找

> ID：11252062
> 
> 赞同：8
> 
> 时间：2012-06-28T20:06:11.623
> 
> 标签：javascript, ios, ipad, html, video

非常奇怪的错误，我似乎无法弄清楚。

当用户点击播放时，我试图让 HTML5 视频从某个位置播放。我试图让它在视频开始播放时正确搜索。

在我的游戏活动中，我做`this.currentTime = X`

在浏览器上它工作正常。但是在 iPad 上，当我播放视频时，视频不会找到正确的位置（它从零开始）。

更奇怪的是，如果我`this.currentTime = X`在 1 秒的 setTimeout 中进行调用，它可以在 iPad 上运行（有时）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:26:09.113

在 iOS 上，视频[在播放时](http://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html)加载（参见第 2 项），而不是在页面加载时加载。我的猜测是你运行时没有加载视频`this.currentTime = X`，所以它没有效果。这也解释了为什么延迟操作有时可以解决问题：有时它会在一秒钟后加载，有时不会。

我没有要测试的 iOS 设备，但我建议将[`loadeddata`](https://developer.mozilla.org/en/DOM/Media_events)侦听器绑定到视频，以便您的`currentTime`操作仅在视频开始加载后发生：

```
// within the play event handler...
if(!isIOSDevice) {
     this.currentTime = X;
} else {
    function trackTo(evt) {
        evt.target.currentTime = X;
        evt.target.removeEventListener("loadeddata", trackTo)
    });
    this.addEventListener("loadeddata", trackTo);
} 
```

您需要`isIOSDevice`根据当前访问是否来自 iOS 设备，在代码中的其他位置进行设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T19:06:30.407

虽然这个问题很老，但问题仍然存在。我发现了一个适用于 iOS 5 和 6（iOS3+4 未测试）的多个经过测试的 iPad (1+2+3) 的解决方案：

基本上，您首先必须等待初始`playing`事件，然后添加一次性活页夹，然后再添加`canplaythrough`-`progress`只有这样您才能真正更改`currentTime`值。在此之前的任何尝试都将失败！

视频必须首先开始播放，这使得视频元素顶部的黑色层有点方便。不幸的是，视频中的声音无法通过 JavaScript 停用 --> 不是完美的 UX

```
// https://github.com/JoernBerkefeld/iOSvideoSeekOnLoad / MIT License 
// requires jQuery 1.8+
// seekToInitially (float) : video-time in seconds
function loadingSeek(seekToInitially, callback) {
    if("undefined"==typeof callback) {
        callback = function() {};
    }
    var video = $("video"),
        video0 = video[0],
        isiOS = navigator.userAgent.match(/(iPad|iPhone|iPod)/) !== null,
        test;
    if(isiOS) { // get the iOS Version
        test =navigator.userAgent.match("OS ([0-9]{1})_([0-9]{1})");
        // you could add a loading spinner and a black layer onPlay HERE to hide the video as it starts at 0:00 before seeking
        // don't add it before or ppl will not click on the play button, thinking the player still needs to load
    }
    video.one("playing",function() { 
        if(seekToInitially > 0) {
            //log("seekToInitially: "+seekToInitially);
            if(isiOS) {
                // iOS devices fire an error if currentTime is set before the video started playing
                // this will only set the time on the first timeupdate after canplaythrough... everything else fails
                video.one("canplaythrough",function() { 
                    video.one("progress",function() { 
                        video0.currentTime = seekToInitially;
                        video.one("seeked",function() {
                            // hide the loading spinner and the black layer HERE if you added one before

                            // optionally execute a callback function once seeking is done
                            callback();
                        });
                    });
                });
            } else {
                // seek directly after play was executed for all other devices
                video0.currentTime = seekToInitially; 

                // optionally execute a callback function once seeking is done
                callback();
            }
        } else {
            // seek not necessary

            // optionally execute a callback function once seeking is done
            callback();
        }
    });
} 
```

整个东西可以从[我的 GitHub repo下载](https://github.com/JoernBerkefeld/iOSvideoSeekOnLoad/ "我的 GitHub 存储库")

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-29T08:46:13.917

[apsillers](https://stackoverflow.com/users/710446/apsillers)是对的。一旦视频开始播放，Quicktime 播放器就会出现，并且在触发第一个“进度”事件之前，视频将无法搜索。如果您在此之前尝试搜索，您将收到无效状态错误。这是我的代码：

```
cueVideo = function (video, pos) {
    try {
        video.currentTime = pos;

    // Mobile Safari's quicktime player will error if this doesn't work.
    } catch(error) {
        if (error.code === 11) { // Invalid State Error

            // once 'progress' happens, the video will be seekable.
            $(video).one('progress', cueVideo.bind(this, video, pos));
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-29T17:29:26.400

感谢以下答案的尝试。不幸的是，如果当前时间 > 0 并且 < 1，则不得不求助于检查内部 timeupdate，如果它随后转到视频的那部分并删除了 timeupdate 的侦听器。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-28T20:15:35.710

尝试将您限制在`X`小数点后 1 位

```
X.toFixed(1); 
```

正如您所提到的，它有时会在 1 秒后起作用。您是否尝试在`playing`事件触发后设置位置？或者甚至是`canplaythrough`事件

[查看此页面](http://www.w3.org/2010/05/video/mediaevents.html)的来源以查看可以使用的事件的完整列表（在 javascript 文件中）

# jquery - 获取鼠标左侧的工具提示

> ID：11252064
> 
> 赞同：0
> 
> 时间：2012-06-28T20:06:26.367
> 
> 标签：jquery, tooltip

我正在尝试在我的网站上实现一个简单的工具提示。它工作正常，在光标右侧显示工具提示，但现在我试图获得仅位于光标左侧的相同效果。我如何实现这一目标？

这是我的代码：http: [//jsfiddle.net/3r5aq/](http://jsfiddle.net/3r5aq/)

可能是一个新手问题，但我自己似乎无法弄清楚这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:17:16.713

您可以计算工具提示的宽度。显然，如果页面上有多个，则需要更新选择器。

```
.mousemove(function(e) {
            var mousex = e.pageX - 5 - $(".tooltip").width(); //Get X coordinates
            var mousey = e.pageY;      //Get Y coordinates
            $('.tooltip')
            .css({ top: mousey, left: mousex})
    }); 
```

[http://jsfiddle.net/3r5aq/18/](http://jsfiddle.net/3r5aq/18/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:17:19.300

我会使用以下内容：

```
var mousex;
var left = e.pageX - $('.tooltip').width() - 20;
if(left > 0)            
    mousex = left;
else
    mousex = 0; 
```

这样，如果链接在页面上离得太远，工具提示就不会在可见区域之外运行。

[**演示**](http://jsfiddle.net/3r5aq/22/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:16:46.180

您可以通过简单地根据工具提示的大小修改 x 值来将其更改为向左移动：

```
var mousex = e.pageX - $('.tooltip').width() - 20; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:20:47.917

```
$(document).ready(function() {
        // Tooltip only Text
        $('.nextTooltip').hover(function(){
                // Hover over code
                var title = $(this).attr('title');
                $(this).data('tipText', title).removeAttr('title');
                $('<p class="tooltip"></p>')
                .text(title)
                .appendTo('body')
                .fadeIn('fast');
        }, function() {
                // Hover out code
                $(this).attr('title', $(this).data('tipText'));
                $('.tooltip').remove();
        }).mousemove(function(e) {
                var mousex = e.pageX;      //Get X coordinates
                var mousey = e.pageY;      //Get Y coordinates
                $('.tooltip').each(function(ix, item) {
                    $(item).css({
                        top: mousey,
                        left: mousex - $(item).width() - 20
                    });
                });
        });
});​ 
```

# c++ - 检查 WCHAR 是否包含字符串

> ID：11252066
> 
> 赞同：11
> 
> 时间：2012-06-28T20:06:32.093
> 
> 标签：c++, wchar

我有变量`WCHAR sDisplayName[1024];`

如何检查是否`sDisplayName`包含字符串“example”？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-28T20:11:06.643

```
if(wcscmp(sDisplayName, L"example") == 0)
    ; //then it contains "example"
else
    ; //it does not 
```

这不包括字符串`sDisplayName`以“example”开头或中间有“example”的情况。对于这些情况，您可以使用`wcsncmp`和`wcsstr`。

此检查也区分大小写。

如果包含垃圾，这也会中断`sDisplayName`- 即不是空终止的。

考虑改用 std::wstring 。这就是 C++ 的方式。

编辑：如果你想匹配字符串的开头：

```
if(wcsncmp(sDisplayName, L"Adobe", 5) == 0)
    //Starts with "Adobe" 
```

如果你想找到中间的字符串

```
if(wcsstr(sDisplayName, L"Adobe") != 0)
    //Contains "Adobe" 
```

请注意，如果找到字符串，wcsstr 将返回*非零值，这与其他字符串不同。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:11:07.397

您可以使用`wchar_t` [标准 C 函数的变体](http://msdn.microsoft.com/en-us/library/z9da80kz%28v=vs.80%29.aspx)（即`wcsstr`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:16:56.057

wscstr 将在 sDisplayName 的任何位置找到您的字符串，wsccmp 将查看 sDisplayName 是否正是您的字符串。

# android - 如何在 android 中以编程方式获取 ScreenSize

> ID：11252067
> 
> 赞同：79
> 
> 时间：2012-06-28T20:06:33.613
> 
> 标签：android, android-screen

Android 将屏幕尺寸定义为 Normal Large XLarge 等。

它会自动在适当文件夹中的静态资源之间进行选择。我在我的 java 代码中需要有关当前设备的这些数据。DisplayMetrics 仅提供有关当前设备密度的信息。没有关于屏幕尺寸的信息。

[我确实在这里](http://grepcode.com/file/repo1.maven.org/maven2/com.android/common/r16/com/android/resources/ScreenSize.java?av=h#ScreenSize)的 grep 代码中找到了 ScreenSize 枚举 但是这对我来说似乎不适用于 4.0 SDK。有没有办法获取这些信息？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-06-28T20:21:03.343

将此代码复制并粘贴到您的代码`Activity`中，执行时将`Toast`显示设备的屏幕尺寸类别。

```
int screenSize = getResources().getConfiguration().screenLayout &
        Configuration.SCREENLAYOUT_SIZE_MASK;

String toastMsg;
switch(screenSize) {
    case Configuration.SCREENLAYOUT_SIZE_LARGE:
        toastMsg = "Large screen";
        break;
    case Configuration.SCREENLAYOUT_SIZE_NORMAL:
        toastMsg = "Normal screen";
        break;
    case Configuration.SCREENLAYOUT_SIZE_SMALL:
        toastMsg = "Small screen";
        break;
    default:
        toastMsg = "Screen size is neither large, normal or small";
}
Toast.makeText(this, toastMsg, Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2013-12-29T12:30:39.887

```
private static String getScreenResolution(Context context)
{
    WindowManager wm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
    Display display = wm.getDefaultDisplay();
    DisplayMetrics metrics = new DisplayMetrics();
    display.getMetrics(metrics);
    int width = metrics.widthPixels;
    int height = metrics.heightPixels;

    return "{" + width + "," + height + "}";
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-10-24T05:18:49.343

**确定屏幕尺寸：**

```
int screenSize = getResources().getConfiguration().screenLayout &Configuration.SCREENLAYOUT_SIZE_MASK;
  switch(screenSize) {
      case Configuration.SCREENLAYOUT_SIZE_LARGE:
        Toast.makeText(this, "Large screen",Toast.LENGTH_LONG).show();
         break;
       case Configuration.SCREENLAYOUT_SIZE_NORMAL:
          Toast.makeText(this, "Normal screen",Toast.LENGTH_LONG).show();
           break;
       case Configuration.SCREENLAYOUT_SIZE_SMALL:
           Toast.makeText(this, "Small screen",Toast.LENGTH_LONG).show();
           break;
       default:
           Toast.makeText(this, "Screen size is neither large, normal or small" , Toast.LENGTH_LONG).show();

 } 
```

**确定密度：**

```
int density= getResources().getDisplayMetrics().densityDpi;
   switch(density)
  {
  case DisplayMetrics.DENSITY_LOW:
     Toast.makeText(context, "LDPI", Toast.LENGTH_SHORT).show();
      break;
  case DisplayMetrics.DENSITY_MEDIUM:
       Toast.makeText(context, "MDPI", Toast.LENGTH_SHORT).show();
      break;
  case DisplayMetrics.DENSITY_HIGH:
      Toast.makeText(context, "HDPI", Toast.LENGTH_SHORT).show();
      break;
  case DisplayMetrics.DENSITY_XHIGH:
       Toast.makeText(context, "XHDPI", Toast.LENGTH_SHORT).show();
      break;
  } 
```

参考： [http ://devl-android.blogspot.in/2013/10/wifi-connectivity-and-hotspot-in-android.html](http://devl-android.blogspot.in/2013/10/wifi-connectivity-and-hotspot-in-android.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-04-25T05:13:06.917

我认为这是一段非常简单的代码！

```
public Map<String, Integer> deriveMetrics(Activity activity) {
    try {
        DisplayMetrics metrics = new DisplayMetrics();

        if (activity != null) {
            activity.getWindowManager().getDefaultDisplay().getMetrics(metrics);
        }

        Map<String, Integer> map = new HashMap<String, Integer>();
        map.put("screenWidth", Integer.valueOf(metrics.widthPixels));
        map.put("screenHeight", Integer.valueOf(metrics.heightPixels));
        map.put("screenDensity", Integer.valueOf(metrics.densityDpi));

        return map;
    } catch (Exception err) {
        ; // just use zero values
        return null;
    }
} 
```

这种方法现在可以在任何地方独立使用。无论您想在哪里获取有关设备屏幕的信息，请执行以下操作：

```
 Map<String, Integer> map = deriveMetrics2(this);
        map.get("screenWidth");
        map.get("screenHeight");
        map.get("screenDensity"); 
```

希望这可能对那里的人有所帮助，并且可能会发现它更易于使用。如果我需要重新更正或改进，请不要犹豫，让我知道！:-)

干杯！！！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-07-01T07:29:30.270

```
DisplayMetrics displayMetrics = new DisplayMetrics();

getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);

int width = displayMetrics.widthPixels;

int height = displayMetrics.heightPixels; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-09-14T13:28:16.413

获取 DisplayMetrics 的方法：

1.

```
val dm = activity.resources.displayMetrics 
```

```
val dm = DisplayMetrics() 
activity.windowManager.defaultDisplay.getMetrics(dm) 
```

3.  val dm = DisplayMetrics() val wm = context.getSystemService(Context.WINDOW_SERVICE) as WindowManager wm..defaultDisplay.getMetrics(dm)

然后得到

以每英寸点数表示的屏幕密度。可以是 DENSITY_LOW、DENSITY_MEDIUM 或 DENSITY_HIGH

```
dm.densityDpi 
```

可用显示大小的绝对高度（以像素为单位）。

```
dm.heightPixels 
```

可用显示大小的绝对宽度（以像素为单位）。

```
dm.widthPixels 
```

X 维度上每英寸屏幕的精确物理像素。

```
dm.xdpi 
```

Y 维度上每英寸屏幕的精确物理像素。

```
dm.ydpi 
```

[显示指标](https://developer.android.com/reference/android/util/DisplayMetrics)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-28T20:26:20.267

您可以使用此代码获取以像素为单位的显示大小。

```
Display display = getWindowManager().getDefaultDisplay();
SizeUtils.SCREEN_WIDTH = display.getWidth();
SizeUtils.SCREEN_HEIGHT = display.getHeight(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-09-13T13:44:34.103

## 你可以试试这个，它正在工作示例

```
DisplayMetrics displaymetrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(displaymetrics);
int ht = displaymetrics.heightPixels;
int wt = displaymetrics.widthPixels;

if ((getResources().getConfiguration().screenLayout &     Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE) {
Toast.makeText(this, "Large screen", Toast.LENGTH_LONG).show();}

  else if ((getResources().getConfiguration().screenLayout &  Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_NORMAL) {
Toast.makeText(this, "Normal sized screen", Toast.LENGTH_LONG)
        .show();

  } else if ((getResources().getConfiguration().screenLayout &        Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_SMALL) {
Toast.makeText(this, "Small sized screen", Toast.LENGTH_LONG)
        .show();
 } else {
Toast.makeText(this,
        "Screen size is neither large, normal or small",
        Toast.LENGTH_LONG).show();
 }

 // Determine density
 DisplayMetrics metrics = new DisplayMetrics();
 getWindowManager().getDefaultDisplay().getMetrics(metrics);
 int density = metrics.densityDpi;

 if (density == DisplayMetrics.DENSITY_HIGH) {
Toast.makeText(this,
        "DENSITY_HIGH... Density is " + String.valueOf(density),
        Toast.LENGTH_LONG).show();
 } else if (density == DisplayMetrics.DENSITY_MEDIUM) {
Toast.makeText(this,
        "DENSITY_MEDIUM... Density is " + String.valueOf(density),
        Toast.LENGTH_LONG).show();
 } else if (density == DisplayMetrics.DENSITY_LOW) {
Toast.makeText(this,
        "DENSITY_LOW... Density is " + String.valueOf(density),
        Toast.LENGTH_LONG).show();
 } else {
Toast.makeText(
        this,
        "Density is neither HIGH, MEDIUM OR LOW.  Density is "
                + String.valueOf(density), Toast.LENGTH_LONG)
        .show();
 }

 // These are deprecated
 Display display = ((WindowManager) getSystemService(Context.WINDOW_SERVICE))
    .getDefaultDisplay();
 int  width = display.getWidth();
 int height = display.getHeight(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-09-14T12:49:23.517

带装饰物（包括按钮栏）：

```
private static String getScreenResolution(Context context) {
    DisplayMetrics metrics = new DisplayMetrics();
    ((WindowManager) context.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay().getRealMetrics(metrics);
    return "{" + metrics.widthPixels + "," + metrics.heightPixels + "}";
} 
```

无装饰：

```
private static String getScreenResolution(Context context) {
    DisplayMetrics metrics = new DisplayMetrics();
    ((WindowManager) context.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay().getMetrics(metrics);
    return "{" + metrics.widthPixels + "," + metrics.heightPixels + "}";
} 
```

区别在于Display 类的**getMetrics()**与**getRealMetrics()方法。**

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-10-04T10:57:27.647

该代码将为您提供以下格式的结果：宽度 x 高度

```
String displayResolution = getResources().getDisplayMetrics().widthPixels + "x" + getResources().getDisplayMetrics().heightPixels; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-06-28T20:30:00.643

西蒙-

不同的屏幕尺寸具有不同的像素密度。与 26 英寸电视相比，您手机上的 4 英寸显示屏可能有更多或更少的像素。如果我理解正确，他想检测当前屏幕是哪个尺寸组，小、正常、大和特大。我唯一能想到的就是检测像素密度并用它来确定屏幕的实际尺寸。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-10-26T02:36:02.463

我的几个应用程序都需要这个，下面的代码是我解决这个问题的方法。仅显示 onCreate 中的代码。这是一个独立的应用程序，可以在任何设备上运行以返回屏幕信息。

```
setContentView(R.layout.activity_main);
    txSize = (TextView) findViewById(R.id.tvSize);

    density = (TextView) findViewById(R.id.density);
    densityDpi = (TextView) findViewById(R.id.densityDpi);
    widthPixels = (TextView) findViewById(R.id.widthPixels);
    xdpi = (TextView) findViewById(R.id.xdpi);
    ydpi = (TextView) findViewById(R.id.ydpi);

    Configuration config = getResources().getConfiguration();

    if ((getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_LARGE) {
        Toast.makeText(this, "Large screen", Toast.LENGTH_LONG).show();
        txSize.setText("Large screen");
    } else if ((getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_NORMAL) {
        Toast.makeText(this, "Normal sized screen", Toast.LENGTH_LONG)
                .show();
        txSize.setText("Normal sized screen");
    } else if ((getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_SMALL) {
        Toast.makeText(this, "Small sized screen", Toast.LENGTH_LONG)
                .show();
        txSize.setText("Small sized screen");
    } else if ((getResources().getConfiguration().screenLayout & Configuration.SCREENLAYOUT_SIZE_MASK) == Configuration.SCREENLAYOUT_SIZE_XLARGE) {
        Toast.makeText(this, "xLarge sized screen", Toast.LENGTH_LONG)
                .show();
        txSize.setText("Small sized screen");
    } else {
        Toast.makeText(this,
                "Screen size is neither large, normal or small",
                Toast.LENGTH_LONG).show();
        txSize.setText("Screen size is neither large, normal or small");
    }

    Display display = getWindowManager().getDefaultDisplay();
    DisplayMetrics metrics = new DisplayMetrics();
    display.getMetrics(metrics);

    Log.i(TAG, "density :" + metrics.density);
    density.setText("density :" + metrics.density);

    Log.i(TAG, "D density :" + metrics.densityDpi);
    densityDpi.setText("densityDpi :" + metrics.densityDpi);

    Log.i(TAG, "width pix :" + metrics.widthPixels);
    widthPixels.setText("widthPixels :" + metrics.widthPixels);

    Log.i(TAG, "xdpi :" + metrics.xdpi);
    xdpi.setText("xdpi :" + metrics.xdpi);

    Log.i(TAG, "ydpi :" + metrics.ydpi);
    ydpi.setText("ydpi :" + metrics.ydpi); 
```

和一个简单的 XML 文件

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical"
tools:context=".MainActivity" >

<TextView
    android:id="@+id/tvSize"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     />
<TextView
    android:id="@+id/density"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     />
<TextView
    android:id="@+id/densityDpi"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     />
<TextView
    android:id="@+id/widthPixels"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     />
<TextView
    android:id="@+id/xdpi"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
     />
<TextView
    android:id="@+id/ydpi"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    /> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-11-13T14:57:42.553

如果您处于非活动状态，即 Fragment、Adapter、Model 类或任何其他不扩展的 java 类将`Activity`无法`getResources()`正常工作。您可以`getActivity()`在片段中使用或使用`context`您传递给相应类的内容。

```
mContext.getResources() 
```

我建议让一个类说 Utils，它将具有用于常见工作的方法/方法。这样做的好处是，您可以在应用程序中调用此方法的任何位置使用单行代码获得所需的结果。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-04-05T07:22:02.813

下面的算法可用于识别哪个类别将用于在静态资源之间进行挑选，也可以满足较新的 XX 和 XXX 高密度

```
 DisplayMetrics displayMetrics = new DisplayMetrics();
    activity.getWindowManager().getDefaultDisplay().getMetrics(displayMetrics);
    mDensityDpi = displayMetrics.densityDpi;
    mDensity = displayMetrics.density;
    mDisplayWidth = displayMetrics.widthPixels;
    mDisplayHeight = displayMetrics.heightPixels;

    String densityStr = "Unknown";
    int difference, leastDifference = 9999;

    difference = Math.abs(mDensityDpi - DisplayMetrics.DENSITY_LOW);
    if (difference < leastDifference) {
        leastDifference = difference;
        densityStr = "LOW";
    }

    difference = Math.abs(mDensityDpi - DisplayMetrics.DENSITY_MEDIUM);
    if (difference < leastDifference) {
        leastDifference = difference;
        densityStr = "MEDIUM";
    }

    difference = Math.abs(mDensityDpi - DisplayMetrics.DENSITY_HIGH);
    if (difference < leastDifference) {
        leastDifference = difference;
        densityStr = "HIGH";
    }

    difference = Math.abs(mDensityDpi - DisplayMetrics.DENSITY_XHIGH);
    if (difference < leastDifference) {
        leastDifference = difference;
        densityStr = "XHIGH";
    }

    difference = Math.abs(mDensityDpi - DisplayMetrics.DENSITY_XXHIGH);
    if (difference < leastDifference) {
        leastDifference = difference;
        densityStr = "XXHIGH";
    }

    difference = Math.abs(mDensityDpi - DisplayMetrics.DENSITY_XXXHIGH);
    if (difference < leastDifference) {
        densityStr = "XXXHIGH";
    }

    Log.i(TAG, String.format("Display [h,w]: [%s,%s] Density: %s Density DPI: %s [%s]", mDisplayHeight, mDisplayWidth, mDensity, mDensityDpi, densityStr)); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-09-29T04:53:27.557

在 Kotlin 中获取屏幕分辨率或屏幕尺寸

```
fun getScreenResolution(context: Context): Pair<Int, Int> {
    try {
        val wm = context.getSystemService(Context.WINDOW_SERVICE) as WindowManager
        val display = wm.defaultDisplay
        val metrics = DisplayMetrics()
        display.getMetrics(metrics)
        val width = metrics.widthPixels
        val height = metrics.heightPixels
        //Log.d(AppData.TAG, "screenSize: $width, $height")
        return Pair(width, height)

    } catch (error: Exception) {
        Log.d(AppData.TAG, "Error : autoCreateTable()", error)
    }

    return Pair(0, 0)
} 
```

# sql-server - 如何在映射中告诉 ssis 默认 Unicode 字符串 [DT_WSTR] 到字符串 [DT_STR]

> ID：11252081
> 
> 赞同：3
> 
> 时间：2012-06-28T20:07:44.840
> 
> 标签：sql-server, sql-server-2008, excel, ssis

我们在我们的 sql 服务器上使用非 unicode。我们使用 ssis 进行了大量的 excel 文件导入，我们花费了大量时间将 excel unicode 映射到我们的 sql server 非 unicode 列。在 ssis 中是否有一些地方可以设置默认值或某个选项，以便 SSIS 可以默认将其源 unicode 列映射到它检测到 unicode 的目标非 unicode ？此[链接](http://www.mssqltips.com/sqlservertip/1393/import-excel-unicode-data-with-sql-server-integration-services/)显示了我们现在执行的步骤。最好在 ssis 中有一个选项说“在导入 excel 文件时使用这个模板..”或类似的东西。我相信你们中的很多人通过 ssis 导入 excel 文件，我希望你们能提供一些这方面的提示。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T01:20:01.403

There is no mechanism around the way in which the Excel Connection Manager treats text. It is going to treat text in the safest manner possible by assuming it's Unicode. The only option you have with the Connection Manager is exactly what you are doing.

An alternative however, would be to disregard the Excel Connection Manager and use an OLE Connection manager as I describe in this answer. [Excel Source as Lookup Transformation Connection](https://stackoverflow.com/questions/7953531/excel-source-as-lookup-transformation-connection/7954984#7954984)

Instead of sending that data to a Cache Connection Manager, just a query to pull data in from your spreadsheet and your conversion issues should be a distant memory.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:17:22.850

您是否尝试过配置平面文件连接管理器并在那里更改每列的类型，这可能是一个选项。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-04-15T10:44:35.010

使用 .csv 文件，平面文件连接管理器默认使用 DT_STR。

# python - 为 url_for 指定端口

> ID：11252082
> 
> 赞同：0
> 
> 时间：2012-06-28T20:07:45.040
> 
> 标签：python, flask

如何指定用于 Flask`url_for`方法的端口？或者，我可以将 Flask 配置为使用它正在运行的任何端口`url_for`吗？我的问题是我在端口 8080 上运行服务器，但`url_for`没有将此端口添加到生成的任何 URL，因此任何生成的 URL 都使用端口 80 并且不解析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:03:42.977

似乎指定端口的唯一方法`url_for`是使用如下`_external=True`参数：

```
url_for('handle_contact_form', _external=True) 
```

这会生成一个类似的 URL `http://localhost:5000/contact-us`。不幸的`:5000/contact-us`是 a 不是有效的相对 URL。因此，如果不使用完整的外部 URL，则无法指定端口。

# javascript - 如何使用 javascript 或 Jquery 在 LI nodeObject 下返回此跨度的 ID

> ID：11252083
> 
> 赞同：0
> 
> 时间：2012-06-28T20:07:50.487
> 
> 标签：javascript, jquery

所以我有

```
<li>
<span id="foobar"> abc </span>
</li> 
```

我现在有`li`一个 nodeObject。我可以`"LI"`通过使用`li.nodeName`.

现在我怎么能`"foobar"`摆脱`li`它里面的一个跨度的ID。

我试过了：

```
 $node = li;
 alert($node>span.Id); 
```

但不工作，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:11:30.263

这将起作用：

```
var node = $('li');
alert(node.children('span').attr('id')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:11:12.180

你可以这样做...

```
alert(li.firstElementChild.id); 
```

或这个...

```
alert(li.getElementsByTagName('span')[0].id); 
```

或这个...

```
alert(li.children[0].id); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:20:45.713

似乎很容易。看一下这个：

```
var test = $("li span").attr("id");
alert(test); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:11:15.490

您可以使用标签选择器和 id 选择器来选择正确的元素，这样您就可以使用下面来选择 li 内带有 id 的 span

```
$(li#foobar") 
```

# windows - 在批处理文件中使用重定向

> ID：11252084
> 
> 赞同：2
> 
> 时间：2012-06-28T20:07:51.267
> 
> 标签：windows, batch-file

这似乎我遗漏了一些明显的东西，但我无法让重定向 (>) 在 .bat / .cmd 文件中工作。

从命令行，这按预期工作，并将输出和错误流发送到日志文件：

```
doxygen doxygen.config 2>&1 > doxygen.log 
```

但是，将完全相同的行放在批处理文件中并运行它不起作用。看起来它试图将整个命令写入日志文件而不是执行它然后循环？

如何让输出重定向在 bat / cmd 文件中工作？如果它有所作为，我正在使用 Win7 并尝试过 cmd 和 powershell。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:20:31.567

也许批处理脚本正在调用自己。我建议您明确指定脚本正在调用的可执行文件的扩展名：

```
doxygen**.exe** doxygen.config 2>&1 > doxygen.log 
```

# ruby-on-rails - Rails ActionMailer 忽略 environment.rb 中的设置

> ID：11252087
> 
> 赞同：7
> 
> 时间：2012-06-28T20:07:54.963
> 
> 标签：ruby-on-rails, ruby-on-rails-3, actionmailer

我将我的 ActionMailer 配置放在我的`config/environment.rb`文件中，如下所示：

```
MyApp::Application.initialize!
MyApp::Application.configure do

  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
      address: "smtp.elasticemail.com",
      port: 2525,
      domain: "myapp.com",
      authentication: "plain",
      user_name: "my_username",
      password: "my_password",
      enable_starttls_auto: true
  }

end 
```

我的理解是，这是配置适用于所有环境的设置的正确方法。

这在开发中运行良好，但是当我部署到我的登台服务器（使用自定义`config/environments/staging.rb`配置文件）时，当它尝试传递邮件时出现“连接被拒绝”错误。`staging.rb`根本没有与邮件程序相关的设置。

所以我用 启动了登台服务器上的控制台`RAILS_ENV=staging rails c`，“puts Rails.application.config.action_mailer”显示我输入的设置`environment.rb`确实有效，但由于某种原因 ActionMailer 没有使用它们。

通过实验，我发现直接将配置复制到`staging.rb`可以解决问题。为什么这是必要的？如果 rails 控制台显示设置生效，为什么 ActionMailer 不使用它们？

深入挖掘，我发现我的邮件类的 delivery_method 没有按预期设置：

```
MyMailer.foo(Person.find(1)).delivery_method

 => #<Mail::SMTP:0x0000000370d4d0 @settings={:address=>"localhost", :port=>25, :domain=>"localhost.localdomain", :user_name=>nil, :password=>nil, :authentication=>nil, :enable_starttls_auto=>true, :openssl_verify_mode=>nil, :ssl=>nil, :tls=>nil}> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T20:09:58.767

放

```
MyApp::Application.configure do

  config.action_mailer.delivery_method = :smtp
  config.action_mailer.smtp_settings = {
      address: "smtp.elasticemail.com",
      port: 2525,
      domain: "myapp.com",
      authentication: "plain",
      user_name: "my_username",
      password: "my_password",
      enable_starttls_auto: true
  }

end 
```

前`MyApp::Application.initialize!`

# php - 根据日期范围动态输入年份

> ID：11252088
> 
> 赞同：1
> 
> 时间：2012-06-28T20:07:55.680
> 
> 标签：php

我的申请从当年 9 月 1 日开始有效，到次年 1 月 15 日结束。

我需要做的是在他们提交申请时将当前年份输入数据库。

如果用户在 2012 年 9 月 1 日至 2013 年 1 月 15 日之间完成申请 - 2012 年将被输入表格。

假设是 2013 年 1 月 2 日 - 它将在年份列中输入 2012

假设是 2012 年 11 月 10 日 - 它将在年份列中输入 2012

假设是 2013 年 12 月 5 日 - 它将在年份列中输入 2013。

我不知道如何插入适当的年份（无论如何在这种情况下）。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:16:38.543

新年过后，您将给自己 15 天的宽限期。当用户提交表单时，捕获日期和年份。如果日期在 1 月 1 日和 1 月 15 日之间，则从当前年份减去 1，如果不使用当前年份。

就像是：

```
$date = date('Y-m-d');
$year = date('Y');

if( $date >= date('Y-01-01') && $date <= date('Y-01-15') ) {
  $year--;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:15:15.957

```
$today = time();
$date1 = strtotime('9/1/2012');
$date2 = strtotime('1/15/2012');
$currentYear = '';
if ($today < $date1) {
    $currentYear = '2011';
}
else if ($today < $date2) {
    $currentYear = '2012';
}
else {
    $currentYear = '2013';
} 
```

这对于未来几年显然不是动态的，并且会在不到 2012 年 9 月 1 日时对您想要做什么做出一些假设，但希望这能让您开始。

# java - 正则表达式模式从数学/代数表达式中匹配和提取变量

> ID：11252091
> 
> 赞同：2
> 
> 时间：2012-06-28T20:08:02.487
> 
> 标签：java, regex, pattern-matching

我正在尝试编写一个正则表达式/方法，它从表示“数学/代数表达式”的输入字符串和一个看起来像“PROPERTY（AnyOtherAplhaNumeric）”的特殊模式中提取变量，它也可以是一个变量。

**我对变量的定义：**

1) 只能包含字母数字值

2) 必须至少为 1 个字符或更多

3) 不能以数字开头，必须以 [A-Za-z] 开头

4) 一个变量，例如“X”，可以被这个字符串“PROPERTY(X)”包围，因此变量变成了“PROPERTY(X)”</p>

**我当前的方法和正则表达式（仅在某些情况下有效）：**

```
public Set<String> extractUniqueVarsFromExpression(String expression) {
        Set<String> varsSet = null;
        Pattern p = null;
        Matcher m = null;
        System.out.println(expression);
        if (expression != null) {
            varsSet = new java.util.LinkedHashSet<String>();
            //"[A-Za-zPROPERTY(?)_][A-Za-z0-9PROPERTY(?)_]*||[A-Za-z_][A-Za-z0-9_]*"
            //"[[A-Za-z_][A-Za-z0-9_]*"
            p = Pattern.compile("[A-Za-zPROPERTY(?)_][A-Za-z0-9PROPERTY(?)_]*||[A-Za-z_][A-Za-z0-9_]*",
                    Pattern.CASE_INSENSITIVE);
            m = p.matcher(expression);
            while (m.find()) {

                    String group = m.group().trim();
                //do not add duplicates     

                         if (!varsSet.contains(group)) 
                         {
                    varsSet.add(group);

                    System.out.println(" Variable : " + group);
                         }//end if not duplicate 

            }// end while

        }
        System.out.println();
        return varsSet;
    } 
```

**示例/案例：**

**例如#1：**

输入：[(ibdweight / ibdheight) * ibdheight] * 703

输出：

变量：属性（ibdweight）

变量：属性（ibdheight）

**例#2：**

输入：[ibdweight / ibdheight * ibdheight] * 703

输出：

变量：ibdweight

变量：ibdheight

**例如#3：**

输入：[PROPERTY(ibdweight) / [PROPERTY(ibdheight) * PROPERTY(ibdheight)] * 703

输出：

变量：属性（ibdweight）

变量：属性（ibdheight）

**例如 #:4**

**这些是不起作用的情况（示例 4 到 6）：**

**问题是括号被选为变量：**

输入：（质量*（加速度+任何））

输出：

多变的 ： （

变量：质量

变量：加速度

变量：随便

多变的 ： ））

**例如 #:5**

**问题是括号被选为变量：**

输入：（底 * 高）/ 2

输出：

多变的 ： （

变量：基础

变量：高度

多变的 ： ）

**例如 #:6**

**问题是括号被拾取为变量或附加到变量：**

输入： [((( var * var2 ) var3 ) + ( var1 / var4 ) var5) / var6 ]

输出：

多变的 ： （（（

变量：var

变量：var2

多变的 ： ）

变量：var3

多变的 ： （

变量：var1

变量：var4

变量：var5)

变量：var6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:27:05.960

正则表达式的问题在于括号内有括号和单词“PROPERTY *”*。括号用于指定一组字符，而不是字符串，其中任何成员都将匹配。

一个适合您的简单（尽管可能不是最佳）变体是：
`(PROPERTY\([A-Za-z][A-Za-z0-9_]*\))|([A-Za-z][A-Za-z0-9_]*)`

稍微好一点的版本是：
`(PROPERTY\([A-Za-z]\w*\))|([A-Za-z]\w*)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:26:02.967

部分问题是您考虑正则表达式的方式。

举个例子：

```
 [A-Za-zPROPERTY(?)_] 
```

这本质上是一个“字符类”，它的行为方式与您期望的不同。它将匹配输入字符串中与类中的任何字符匹配的任何单个字符。它不会将 PROPERTY 视为单个实体，而是将其视为单独的大写字母（无论如何，它们已经包含在 AZ 中。此外，在您的字符类中包含 (?) 匹配“（”，我确信这不是什么）你要。

# ruby-on-rails - 无法启动新的 Rails 项目

> ID：11252094
> 
> 赞同：2
> 
> 时间：2012-06-28T20:08:16.680
> 
> 标签：ruby-on-rails, ruby-on-rails-4

我正在尝试开始一个新的 Rails 项目，但我遇到了一个非常奇怪的错误。当我做：

```
rails new my_project 
```

我收到一个错误：

```
/usr/local/Cellar/ruby/1.9.3-p125/lib/ruby/1.9.1/rubygems.rb:314:in `bin_path': can't find gem rails ([">= 0"]) with executable rails (Gem::GemNotFoundException)
    from /usr/bin/rails:19:in `<main>' 
```

我应该怎么做才能开始一个新项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:25:39.167

似乎实际上并未安装rails。

您可以使用`gem install rails`.

如果它似乎不太可能没有安装，请尝试运行`gem list --local | grep "rails"`.

如果它返回一些东西，那么请确保您的 ruby​​gems 没有通过运行来配置不同的 ruby​​ 安装`gem environment`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:12:46.897

该错误似乎意味着没有安装rails。您是否安装了 RVM（Ruby 版本管理器）？如果这样做，`rvm install rails`请在终端中运行以安装最新版本的 rails

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T17:49:30.033

`$curl -L https://get.rvm.io | bash -s stable --rails`

或者你可以使用

1`$curl -L https://get.rvm.io | bash -s stable --ruby`

2`$rvm requirements`

3`$sudo apt-get install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion pkg-config`

4`$gem install rails`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-30T01:03:15.397

如果您使用 ruby​​ 版本工具，那可能就是问题所在。检查您当前的 gemset，您可能没有使用您认为的那个。

我在 RubyMine 中遇到了同样的问题。

问题是 rails project create 默认使用的 rvm gemset。
使用“RVM：ruby-1.9.3-p392”，
需要是“RVM：ruby-1.9.3-p392 [global]”。

# entity-framework-4 - 如何将实体框架中的 DbSet 转换为 ObjectQuery

> ID：11252096
> 
> 赞同：12
> 
> 时间：2012-06-28T20:08:31.753
> 
> 标签：entity-framework-4, linq-to-entities, ef-code-first, dbcontext

我正在使用 CodeFirst 方法，但遇到了需要将 DbSet 转换为 ObjectQuery 的问题。这就是我为转换所做的。

```
ObjectContext objectContext = ((IObjectContextAdapter)db).ObjectContext;
ObjectSet<Request> objectSet = objectContext.CreateObjectSet<Request>(); 
```

其中 db 是从 DbContext 继承的上下文，Request 是类。

因此，当我尝试将期望 ObjectQuery 的方法调用为 ObjectQueryMethod(objectSet) 时，它会引发以下错误。

“无法确定条件表达式的类型，因为 'System.Data.Entity.DbSet<>' 和 'System.Data.Objects.ObjectQuery<>' 之间没有隐式转换”

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-29T13:29:33.550

我找到了答案。当然，可以使用以下代码行将 Entity 框架中的 DbSet 转换为 ObjectQuery。

```
ObjectContext objectContext = ((IObjectContextAdapter)db).ObjectContext;  
ObjectSet<Request> objectSet = objectContext.CreateObjectSet<Request>("Requests"); 
```

在哪里，

*   `db`- 上下文类继承自`DbContext`.
*   `Requests`-`DbSet<Request>`在上下文类中定义。
*   `objectSet`- 现在可以作为`ObjectQuery`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-18T07:38:22.340

感谢“启发我自己”的正确答案；这只是为了详细说明您的答案。我设法用泛型类型做到了这一点，所以只是为了分享它：

```
private List<T> GetByCustomCriteria<T>(string criteria) where T: class
{
  var objectContext = ((IObjectContextAdapter)_myModelEntities).ObjectContext;
  //note: _myModelEntities is a DbContext in EF6.
  var objectSet = objectContext.CreateObjectSet<T>();
  return new List<T>(objectSet.Where(criteria));
 } 
```

我认为上面的帖子可以举例说明发送什么标准，所以这里有一个例子：

```
 //sample criteria for int field:
 var myClientById = GetByCustomCriteria<Client>("it.Id == 1");`

//sample criteria for string field, note the single quotes
var myClientByName = GetByCustomCriteria<Client>("it.Surname == 'Simpson'"); 
```

# sql-server - 设置变量的快捷方式

> ID：11252098
> 
> 赞同：1
> 
> 时间：2012-06-28T20:08:58.577
> 
> 标签：sql-server, tsql

有一个快捷方式，而不必一直指定 SET 对吗？

所以我认为你可以像这样结合声明和赋值：

```
DECLARE @Field1 = 24.00,
        @Field2 = 11.10,
        @Field3  decimal = .50 
```

我这样做是错的还是不可能的，我必须声明变量，然后在每隔一行使用 SET ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:13:35.290

如果您使用的是 SQL Server 2008，这应该可以：

```
DECLARE @Field1 decimal = 24.00,
        @Field2 decimal = 11.10,
        @Field3  decimal = .50 
```

看起来您只是省略了前两个变量的类型。

# javascript - 是否可以使用 javascript 更改我的 css sprite 显示的子图像？

> ID：11252100
> 
> 赞同：1
> 
> 时间：2012-06-28T20:09:13.417
> 
> 标签：javascript, html, css

我希望我的图像精灵根据用户所在的页面显示我在图像文件中的另一个子图像。我可以在 javascript 中识别页面并正确显示我的 css sprite，当前在无序列表中的 li 标签内，其中也包括锚标签。

这是我的css的一个例子

```
<style type="text/css">
#theList{position:relative;}
#theList li{margin:0;padding:0;list-style:none;position:absolute;}
#theList li, #navlist a{height:40px;display:block;}

#one{left:-10px;top:-55px;width:200px;}
#one{background:url('../../images/dashboardNavigationMasterSprite.jpg') 0px 0px;}
#one a:hover{background: url('../../images/dashboardNavigationMasterSprite.jpg') 0px -40px;}

#two{left:193px;top:-55px;width:200px;}
#two{background:url('../../images/dashboardNavigationMasterSprite.jpg') -202px 0px;}
#two a:hover{background: url('../../images/dashboardNavigationMasterSprite.jpg') -202px -40px;}
</style> 
```

这是我的html

```
<ul id="theList">
<li id="one"><a href="http://bert2007sql64/sites/budgettool/FIDs/Pages/Dashboards/Dashboard_Exec_Home.aspx"></a></li>
  <li id="two"><a href="http://bert2007sql64/sites/budgettool/FIDs/Pages/Dashboards/Dashboard_Budget_Controls.aspx"></a></li> 
```

基本上我想知道的是如何使用 javascript 或 jquery 访问和更改 xpos 和 ypos 属性。我试图操纵的 xpos 和 ypos 值是下面一行中列出的值

```
#one{background:url('../../images/dashboardNavigationMasterSprite.jpg') 0px 0px;} 
```

非常感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:15:21.040

扩展您的样式，使相同标签上的不同类（或其他一些 CSS-selector-criteria）指向精灵中的不同位置。然后在 Javascript 中，更改标签的类以获取不同的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:15:32.423

您可以像这样以编程方式更改它（使用 JQuery）

```
$('#id').css( {backgroundPosition: "0 0"} ) 
```

[这](http://snook.ca/archives/javascript/jquery-bg-image-animations/)是一个很好的例子

您可以尝试的东西（未经测试）：

```
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function() {
        $('#one').css( {backgroundPosition: "20px 10px"} )
    });
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:18:32.590

这应该适用于您使用 jQuery：

```
$('#one').css( 'backgroundPosition', '0px 0px' ); 
```

# ruby-on-rails - Backbone.js + Handlebars 各

> ID：11252107
> 
> 赞同：7
> 
> 时间：2012-06-28T20:09:38.440
> 
> 标签：ruby-on-rails, ruby-on-rails-3, backbone.js, coffeescript, handlebars.js

我正在尝试将 Ryan[在 Backbone.js 上的 RailsCast](http://railscasts.com/episodes/323-backbone-on-rails-part-1)转换为与 Handlebars 一起使用，但遇到了一个简单的问题。

我似乎无法遍历 JSON 数组并显示结果。我在我的 Gemfile 中使用这些宝石

```
gem 'backbone-on-rails'
gem 'handlebars_assets' 
```

在我的`index.jst.hbs`中，我有以下内容：

```
{{entries.length}}

<ul>
    {{#each entries.models}}
        <li>{{name}}</li>
    {{/each}}
</ul> 
```

正如您在屏幕截图中的 7 计数中看到的那样，API 调用似乎正在工作。 ![在此处输入图像描述](../Images/5202e44c04b9b11855a915342e9dcd2a.png)

但是，不会显示每个模型的内容。下面是视图 (index.js.coffee) 和 JSON 响应。

```
 class Raffler.Views.EntriesIndex extends Backbone.View
      template: JST['entries/index']

      initialize: ->
        #triggered when view gets created, listen to 'reset' event, then re-@render, pass 'this' for context binding
        @collection.on('reset', @render, this)

      render: ->
        $(@el).html(@template(entries: @collection))
        this 
```

JSON：

```
[
{
"created_at":"2012-06-28T18:54:28Z",
"id":1,
"name":"Matz",
"updated_at":"2012-06-28T18:54:28Z",
"winner":null
},
{
"created_at":"2012-06-28T18:54:28Z",
"id":2,
"name":"Yehuda Katz",
"updated_at":"2012-06-28T18:54:28Z",
"winner":null
},
{
"created_at":"2012-06-28T18:54:28Z",
"id":3,
"name":"DHH",
"updated_at":"2012-06-28T18:54:28Z",
"winner":null
},
{
"created_at":"2012-06-28T18:54:28Z",
"id":4,
"name":"Jose Valim",
"updated_at":"2012-06-28T18:54:28Z",
"winner":null
},
{
"created_at":"2012-06-28T18:54:29Z",
"id":5,
"name":"Dr Nic",
"updated_at":"2012-06-28T18:54:29Z",
"winner":null
},
{
"created_at":"2012-06-28T18:54:29Z",
"id":6,
"name":"John Nunemaker",
"updated_at":"2012-06-28T18:54:29Z",
"winner":null
},
{
"created_at":"2012-06-28T18:54:29Z",
"id":7,
"name":"Aaron Patterson",
"updated_at":"2012-06-28T18:54:29Z",
"winner":null
}
] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-28T20:47:09.817

你`@collection`的大概是一个`Backbone.Collection`. Handlebars 会将其视为某种数组，因此`{{entries.length}}`可以按预期工作并`{{#each entries.models}}`迭代正确的次数；但是，Handlebars 不知道如何处理`Backbone.Model`里面的 s `@collection.models`。

使用将 转换`@collection`为原始数据[`toJSON`](http://backbonejs.org/#Collection-toJSON)，Handlebars 知道如何处理简单的 JavaScript 数组和对象：

```
render: ->
    @$el.html(@template(entries: @collection.toJSON()))
    @ 
```

然后调整您的模板以查看`entries`而不是`entries.models`：

```
<ul>
    {{#each entries}}
        <li>{{name}}</li>
    {{/each}}
</ul> 
```

演示：http: [//jsfiddle.net/ambiguous/tKna3/](http://jsfiddle.net/ambiguous/tKna3/)

Backbone 的一般规则是传递`model.toJSON()`或传递`collection.toJSON()`给您的模板，这样他们就不必知道 Backbone 方法（例如`get`），并且您的模板不会意外更改您的模型和集合。

# javascript - Ajax 选项卡 - 用于检查选择了哪个选项卡的 javascript

> ID：11252109
> 
> 赞同：0
> 
> 时间：2012-06-28T20:09:42.373
> 
> 标签：javascript, ajaxcontroltoolkit

我有一个带有 2 个选项卡的 AjaxControlToolKit TabContainer，我通过 C# 中的自定义控件加载这些选项卡。在选项卡之间切换时，我需要触发一个事件。

我应该检查哪个 javascript 事件以确定选择了哪个选项卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:45:46.867

```
var ai = $find('tc_id').get_activeTabIndex();
if (ai == "1") {
    setDetail1Sync();
}
else {
    setDetail0Sync();
} 
```

# javascript - 节点检查器如何工作

> ID：11252110
> 
> 赞同：3
> 
> 时间：2012-06-28T20:09:53.743
> 
> 标签：javascript, node.js, node-inspector

因为 node-inspector 是一个非常有用的程序，所以我想我应该看看源代码，看看我是否无法拼凑出它是如何工作的。据我所知，该程序充当浏览器和活动调试会话之间的中介，促进它们之间的通信。它通过 paperboy 和套接字与浏览器进行通信的方式看起来非常简单。我很难理解的是节点检查器如何与在不同进程中进行的节点调试会话进行通信。

为了更加清晰和具体，我通常以这种方式运行节点检查器：

1.  我像这样运行我的脚本：

    节点 --debug-brk myscript.js

2.  然后我打开一个新终端并运行 node-inspector &

我很想知道的是 node-inspector 如何找到我想要调试的脚本然后连接到它。我发现了一个“调试器”对象，它似乎实现了一个与节点调试会话通信的接口，但它最初如何连接到它对我来说有点神秘。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T09:09:02.017

好吧，V8 附带了一个[调试器协议](http://code.google.com/p/v8/wiki/DebuggerProtocol)，任何应用程序都可以使用它。正如第一篇文章所述，基于 JSON 的 API 用于进程外通信。当您使用该`--debug-brk`标志运行节点进程时，您只需指示 v8 引擎等待调试器（实现此协议）被附加并侦听指定（或默认）端口。

这有帮助吗？

# asp.net - Gridview 所选值未填充下拉列表

> ID：11252113
> 
> 赞同：-1
> 
> 时间：2012-06-28T20:10:02.810
> 
> 标签：asp.net, sql, gridview, drop-down-menu

在我的 ASP.NET 页面中，我有一个 gridview 和一个下拉列表，我希望下拉列表填充来自我的 gridview 中选定行的值。我的下拉列表中填充了一条 sql 语句：

```
dt = dal.FillDataTable(dbType.SqlServer, "SELECT V_VendorNo + ' | ' + V_VendorName FROM VendorTbl")
    ddlVendorEncum.DataSource = dt
    ddlVendorEncum.DataTextField = dt.Columns.Item(0).ToString
    ddlVendorEncum.DataValueField = dt.Columns.Item(0).ToString
    ddlVendorEncum.DataBind() 
```

我的gridview模板字段是这样的......

```
<asp:TemplateField HeaderText="Vendor">
    <EditItemTemplate>
        <asp:TextBox ID="TextBox1" runat="server" Text='<%# Eval("v_vendorno").ToString + " | " + Eval("v_vendorname").ToString %>'></asp:TextBox>
    </EditItemTemplate>
    <ItemTemplate>
        <asp:Label ID="Label1" runat="server" Text='<%#  Eval("v_vendorno").ToString + " | " + Eval("v_vendorname").ToString %>'></asp:Label>
    </ItemTemplate>
    <ItemStyle Font-Size="X-Small" />
    </asp:TemplateField> 
```

我试过这段代码：

```
ddlVendorEncum.Text = gvEncumbered.SelectedRow.Cells(1).ToString 
```

在我的 gridview 的 selectedIndexChanged 事件中，但我一直返回错误（“ddlVendorEncum.Items.Add(gvEncumbered.SelectedRow.Cells(1).ToString()) ”）。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T07:08:25.843

1.  Use following code this might remove your error:

    ```
     ListItem item = new ListItem();
            item.Text = gvEncumbered.SelectedRow.Cells(1).ToString;
            item.Value = gvEncumbered.SelectedRow.Cells(1).ToString;
            ddlVendorEncum.Items.Add(item); 
    ```

# jquery - 造型收音机，一次只允许检查 1 个

> ID：11252125
> 
> 赞同：1
> 
> 时间：2012-06-28T20:10:48.600
> 
> 标签：jquery, html

我通常知道为无线电输入分配一个名称属性只会允许一次检查一个，但我正在使用 jQuery 重新设置我的输入，这将不再有效。我在 jQuery 中的效率还不够高，还无法理解如何克服这个问题。

HTML

```
​&lt;input type="radio" class="radio" name="one" />
<input type="radio" class="radio" name="one" />​​​​​​​ 
```

jQuery

```
$('.radio').each(function() {
    $(this).hide();

    var $image = $("<img class='checkbox' src='assets/images/layout/checkbox/unchecked.png' />").insertAfter(this);

    $image.click(function() {
        var $checkbox = $(this).prev('.radio');
        $checkbox.prop('checked', !$checkbox.prop('checked'));

        if($checkbox.prop("checked")) {
            $image.attr("src", "assets/images/layout/checkbox/checked.png");
        } else {
            $image.attr("src", "assets/images/layout/checkbox/unchecked.png");
        }
    });
}); 
```

我认为在更改图像之前，我需要更改条件语句以针对是否检查具有特定名称（例如“1”）的输入。不幸的是，我所有的尝试都失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:27:14.873

对于每个单选按钮，获取它的`name`属性。然后，在复选框图像上单击，获取所有具有该选项的单选按钮元素`name`并取消选中它们，然后将选中的值应用于单击的那个。

[使用您的 jsFiddle 的示例](http://jsfiddle.net/ud7aM/1/)

# iphone - 如何确定一组特定实验值的比例因子

> ID：11252132
> 
> 赞同：0
> 
> 时间：2012-06-28T20:11:10.387
> 
> 标签：iphone, objective-c, ios, c, exponential

我有一组实验值。例如，我有一个 1120 像素的值，我需要某种因子 z 来将这 1120 个像素相乘以获得大约 1.15 的值。此外，我有 800 个像素，需要将其乘以相同的因子 z 以获得大约 1.2 的值。这是我的实验值：

```
1120 * z = approximately 1.15

800  * z = approx. 1.2

720  * z = approx. 1.25

640  * z = approx. 1.3

560  * z = approx. 1.4

480  * z = approx. 1.5

320  * z = approx. 2.0 
```

我不需要低于 1.15 或高于 2.0 的值。

所以我的问题是我如何确定 z 有多大。这在我看来有点指数化，但我不知道如何在 Objective-C 中处理它。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:51:15.107

它在我看来也是指数级的。我使用[Grapher](http://guides.macrumors.com/Grapher)解决了这个问题。

由于 Grapher 不擅长插值指数函数，所以我绘制了点并修改了一个指数方程，直到我得到它非常接近。然后我输入我找到的值作为插值的起点。您可以在应用程序中使用的等式是：

`4.3069 * powf(M_E, -x/200.0f) + 1.1327f`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:26:31.447

试试 Wolfram Alpha。在 wolfram alpha 中键入最适合的 {1120,1.15},{800,1.2},{720,1.25},{640, 1.3},{560,1.4}, {480,1.5}, {320,2.0} 会给你一个三次方程，R^2 值为 0.998，指数为 99.2。但这一切都取决于您的基础模型是什么。Wolfram 的好处是您可以修改输入数据并查看方程对可能的错误有多敏感。

# java - 在 GWT 中布局元素的最佳方式是什么？

> ID：11252137
> 
> 赞同：1
> 
> 时间：2012-06-28T20:11:23.690
> 
> 标签：java, css, gwt, layout, panels

在 GWT 小部件中指定元素位置的最佳实践是什么？

假设您有一个任务：在页面布局中放置一组小部件。您将使用什么来按某种顺序定位所有按钮和输入？

1.  标准 HTML 标记，带有用于定位的表格/div + CSS 样式
2.  GWT 小部件：面板、网格、表格 + 用于定位的 CSS 样式
3.  GWT 小部件：面板、网格、表格 + 用于定位的原生属性

如果是 2 或 3 - 你会用什么来重现带有 colspans、固定宽度列和填充的标准 HTML 表格？

ps UIBinder 和 XML 标记。GWT 2.4

* * *

**我的观点：** *GWT 的最大优势之一是能够防止程序员编写 HTML 标记并为接口添加跨浏览器支持。我们不应该放弃这些点，所以最好选择 p.3 并尝试仅使用 CSS 进行装饰 - 即颜色、字体等。*

**另一种观点：** *将任何样式内联放置是一个坏主意。通过在 XML 标记中指定小部件的属性，我们实际上就是在这样做。此外，GWT 没有足够的小部件来生成正常的布局。例如，您需要创建一个具有 collspans 和固定列宽的简单表格。你会怎么做？看起来你必须将几个 Horizo​​ntalPanels 嵌入 VerticalPanels，在每个人中指定宽度/高度，并以此生成一篇很棒的 XML 论文。*

* * *

那么你的意见是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-28T20:27:01.110

GWT 生成可怕的、可怕的、不好的、非常糟糕的 HTML。这只是我的看法，其他人可能不同意。但是我每天都在和 GWT 打交道，无限嵌套的 div 和表格足以让一个新手 Web 开发人员哭泣。而且它的所有样式都是内联的，所以如果你想用外部样式表应用或覆盖它们，你最终会得到一堆`!important`声明。

然而，它确实生成了非常可爱的 JavaScript。作为曾经不得不维护和开发极其复杂的 DHTML 项目并为 IE 5.5 及更高版本提供支持的*人*——我不得不承认，这是 GWT 最好的部分。

不可否认，我是一个 DHTML 纯粹主义者，早在我成为软件开发人员之前就已经是一名 Web 开发人员。我个人认为 HTML 应该只用于结构，CSS 应该提供样式，JavaScript 应该提供其他功能，三者应该完全分开。GWT 在最后一部分——JavaScript——方面做得很好，但它生成的 HTML 冒犯了我的感受，而且至少比它必须的复杂十倍。但话又说回来，大多数生成的代码都是。（考虑在 MS Word 中创建的网站或从 WYSIWYG 风格的编辑器生成的 HTML。）

鉴于复杂的基于 Web 的应用程序——以及对滚动 Ruby on Rails 应用程序的限制——我很乐意使用 GWT。但我的应用程序几乎是`FlowPanel`s（编译为 HTML `<div>`s）和 GWT 生成的 Javascript 的集合，顶部有我自己的 CSS。因此，在 OP 规定的情况下，我将使用 FlowPanel，添加元素（例如 GWT 表单元素），应用任何服务器端逻辑，然后使用外部 CSS 进行样式设置。

在查看 GWT 时，您可能需要考虑是否需要在以后重新设计您的应用程序，或者是否希望让设计师或其他非程序员创建模板/样式/CSS 以在上面应用。如果出现这种情况，那么在设计 GWT 应用程序时要非常小心，不要应用样式而是应用类和 id。

另外作为测试方面的说明：如果您打算使用 Selenium 进行 UI 测试，那么您*真的*很想在事物上挂上 id。生成的 HTML 中的 xpath 实际上是不合适的，并且可以延伸到数百个字符的长度。

话虽如此，我很想听听其他人的经历，特别是如果他们与我的不同。

**tl;博士版本：**

1.  GWT 生成的 HTML 对于嵌套表和多层嵌套`<div>`s 非常糟糕（超过必要）
2.  GWT 不生成 CSS 样式表，而是将所有样式内联。这使得使用外部样式表变得乏味和困难。
3.  GWT 在跨浏览器 Javascript 方面表现出色。
4.  默认情况下，GWT 不会将 id 附加到元素，因此如果您打算使用像 Selenium 这样的工具，则必须手动添加自己的 id，否则将面临前所未有的长 xpath。

# javascript - Youtube 播放器 API playVideo 返回 api_video_info 作为 player_204

> ID：11252138
> 
> 赞同：0
> 
> 时间：2012-06-28T20:11:27.357
> 
> 标签：javascript, actionscript-3, youtube, youtube-javascript-api, chromeless

一些视频无法在 AS3 无铬播放器中加载，尽管它们在 youtube 网站上播放良好。我已经检查过这些视频没有被嵌入式播放器禁用。同样的事情不仅发生在我的播放器上，也发生在 youtube 演示页面上的演示播放器上。问题似乎是间歇性的。我之前在 as3 chromeless player 中成功播放过这个视频，但有时它会失败，并且在 youtube chromless player 中没有触发错误事件。如果我看一下协议跟踪，api_video_info 之后的请求是 player_204（表示流错误）而不是正常的 get_video 请求。你能解释一下发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T10:10:18.323

某些 Youtube 视频无法在 Chromeless 播放器中播放。有时是因为该视频因版权原因被阻止，有时是因为作者限制了该视频在 Chromeless 播放器中的使用。

在这里查看更多信息：

[http://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html](http://apiblog.youtube.com/2011/12/understanding-playback-restrictions.html)

# objective-c - 目标c从代码运行文件

> ID：11252139
> 
> 赞同：0
> 
> 时间：2012-06-28T20:11:29.163
> 
> 标签：objective-c

我曾经`[[NSWorkspace sharedworkspace] openFile:@"_file"]]`运行一个命令，当我在 Xcode 中运行应用程序时它运行良好。但是当我尝试从 finder 运行我的 .app 并运行命令时它不起作用。.command 文件仍在捆绑包中。我做错了什么？

# java - 从 JavaScript 调用时，签名的 Java Applet 会给出 AccessControlException

> ID：11252145
> 
> 赞同：0
> 
> 时间：2012-06-28T20:12:09.863
> 
> 标签：java, javascript, swing, security, applet

首先，我知道我的问题与[此处](https://stackoverflow.com/questions/1068271/signed-applet-gives-accesscontrolexception-access-denied-when-calling-from-jav)相同。但是这个问题对我没有帮助。

我有自签名小程序。

```
jarsigner -verify sJSApplet.jar
jar verified.

Warning:
This jar contains entries whose signer certificate will expire within six months. 
```

Applet 的目的是从 LAN 机器上打开 MS Word 文档。到目前为止，我已经尝试使用`Desktop.open()`and打开`Runtime.exec()`。`AccessController.doPrivileged`有无。我总是得到`java.security.AccessControlException: access denied`。

我别无选择。我还能做什么？

我不能使用 java.policy 文件。

**HTML**

```
<html>
    <head>
        <script>
            function openFile( command ) {
                    var applet = "<object type='application/x-java-applet' height='100' width='100' name='jsApplet'><param name='code' value='com.avacoda.swing.JSApplet'/><param name='archive' value='sJSApplet.jar' /><param name='mayscript' value='true'/><param name='filePath' value='C:\\note.txt'/>Applet failed to run.  No Java plug-in was found.</object>";

                    var body = document.getElementsByTagName("body")[0];
                    var div = document.createElement("div");
                    div.innerHTML = applet;
                    body.appendChild(div);
            }
        </script>
    </head>
    <body>
        <a href="#" onclick="openFile('C:/note.txt');">Open file</a>
    </body>
</html> 
```

**Java代码：**

```
public class WordApplet extends JApplet {

    @Override
    public void init() {
        openFile(getParameter("filePath"));
    };

    public void openFile(final String path) {
        AccessController.doPrivileged(new PrivilegedAction<Object>() {

            @Override
            public Object run() {
                try {
                        Runtime.getRuntime().exec("winword " + path); 
                        //Desktop.getDesktop().open(new File(path));
                } catch (Exception e) {
                    e.printStackTrace();
                }
                return null;
            }
        });
    }
} 
```

**完整的堆栈跟踪**

```
java.security.AccessControlException: access denied (java.io.FilePermission <<ALL FILES>> execute)
    at java.security.AccessControlContext.checkPermission(Unknown Source)
    at java.security.AccessController.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkPermission(Unknown Source)
    at java.lang.SecurityManager.checkExec(Unknown Source)
    at java.lang.ProcessBuilder.start(Unknown Source)
    at java.lang.Runtime.exec(Unknown Source)
    at java.lang.Runtime.exec(Unknown Source)
    at java.lang.Runtime.exec(Unknown Source)
    at com.test.applet.JSApplet$1.run(JSApplet.java:34)
    at java.security.AccessController.doPrivileged(Native Method)
    at com.avacoda.swing.JSApplet.openFile(JSApplet.java:29)
    at com.avacoda.swing.JSApplet.init(JSApplet.java:25)
    at com.sun.deploy.uitoolkit.impl.awt.AWTAppletAdapter.init(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
basic: Applet initialized 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:28:27.083

本质上不允许您从 applet 在用户机器上执行代码。这可能会造成很多麻烦。但是，请考虑使用 Applet 将文件输出到用户的计算机，然后使用 jScript 和 ActiveX 在记事本中打开文档。我在网上找到了一个例子：

```
<html>
    <head>
        <script type="text/javascript">
            function runApp(which) {
                WshShell = new ActiveXObject("WScript.Shell");
                WshShell.Run (which,1,false);
            }
        </script>
    </head>
    <body>
        <!-- Two ways to create a link to run the app. -->
        <font onClick="runApp('file://c:/winnt/notepad.exe');" style="cursor: hand;">
            <u>Notepad</u>
        </font>
        <br>
        <!-- Or use <a> descriptor -->
        <a href="runApp('file://c:/test.bat');">Batch File</a>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T07:48:40.917

上面的代码示例没有任何问题。两种情况都`Desktop.getDesktop().open()`可以`Runtime.getRuntime().exec()`完美运行。

我的问题是包装不好的 jar。

# android - 如何制作自己的安卓应用地图？

> ID：11252146
> 
> 赞同：2
> 
> 时间：2012-06-28T20:12:15.100
> 
> 标签：android, google-maps, google-maps-api-3, arcgis-server

我正在为 Android 上的一所大学开发地图应用程序。我正在使用谷歌地图 API。问题是我发现谷歌地图没有显示建筑物。和路由服务。我需要在大学的总面积上展示这些。如何在大学中创建地理、建筑和路由服务？

[地图图片](http://imgur.com/a/anoAx/rearrange)

我的意思是多边形和折线。

谢谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:30:34.907

Google Maps API**确实**包含一种显示建筑物等的方法 - `mapView.setSatellite(true)`. 但是，我不知道连接到路由服务的方法。在 SO 上已经讨论过很多次了，似乎路由违反了 Google 的服务条款，或者 Google 删除了它。可以对 Web 数据库进行查询，如此处[所示](https://stackoverflow.com/questions/1612533/android-drivingdirections-removed-since-api-1-0-how-to-do-it-in-1-5-1-6)。至于在地图上绘制多边形（我*认为*这是您想要做的），您可以创建自己的类扩展`Overlay`和覆盖`onDraw()`以在`Canvas`. 祝你好运！

# cordova - 带有 Sencha Touch 2 的 Phonegap 1.8.1 应用程序仅启动一次

> ID：11252150
> 
> 赞同：1
> 
> 时间：2012-06-28T20:12:18.327
> 
> 标签：cordova, sencha-touch-2

我在 Android 上使用 Phonegap 1.8.1 包装器（Phonehap build）部署 Sencha Touch 2.0.1.1 应用程序时遇到问题。

当应用程序在没有 Phonegap api 的 sencha**生产构建之后运行时，一切都很好。**但是当 Phonegap api 添加到应用程序时，它只运行一次。当我关闭应用程序并再次打开它时，我只看到加载指示器，没有任何反应。

我以这种方式添加 Phonegap api：

```
"js": [
            {   
        "path": "phonegap/cordova-1.8.1.js",
        "update": "full"
    },
    {
        "path": "sdk/sencha-touch.js",
        "update": "full"
    },
    {
        "path": "app.js",
        "bundle": true,  /* Indicates that all class dependencies are concatenated into this file when build */
        "update": "full"
    }
], 
```

我什至不在我的应用程序中使用 api 函数。只需添加 js 文件即可构建。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T15:16:14.497

嗯...经过几天的麻烦，我发现原因是微加载器。当我使用 sencha microloader 添加 javascript 文件时，该应用程序仅运行一次。如果我通过将脚本标签添加到 index.html 来手动添加文件，一切都很好。一般来说，microloader 有很多奇怪的东西，尤其是生产版本......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T15:38:49.550

你用的是什么android api版本？我正在测试 15 和 10。

如果您使用 sencha build（生产、测试​​），在 10 时，我可以确认应用程序仅在安装后运行。使用 api 15 没有这样的 ... 行为。

# ruby-on-rails - 如何使用 FactoryGirl 3.3 中的回调在 has_many 关联中创建子对象？

> ID：11252153
> 
> 赞同：0
> 
> 时间：2012-06-28T20:12:33.770
> 
> 标签：ruby-on-rails, rspec2, factory-bot

这个问题可能已经被问过很多次了。这是我们的版本。我们的 rails 3.1 应用程序中有 user 和 user_level 模型。一个用户有_many user_levels。

```
class User < ActiveRecord::Base
  has_many :user_levels
  accepts_nested_attributes_for :user_levels, :allow_destroy => true
  validates_presence_of :user_levels
end

class UserLevel < ActiveRecord::Base
  belongs_to :user 
  validates :position, :presence => true
end 
```

这是我们在 FactoryGirl 3.3 中所拥有的：

```
FactoryGirl.define do

  factory :user_level do 
    position             "admin"
    user
  end

  factory :user do     
    name                  "Test User"
    login                 'testuser'
    password              "password1"

    factory :user_with_levels do
      #user_levels
      after(:create) do |user|
        FactoryGirl(:user_level, :user => user)
      end
    end
  end
end 
```

`u = FactoryGirl.build(:user_with_levels) or u = FactoryGirl.create(:user_with_levels)`在我们的 rspec 中使用。创建后回调不起作用，并且有错误说`Validation failed: User levels can't be blank`。上面的回调有什么问题？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T17:16:29.323

这是一个有效的解决方案。它基于 Tim Riley 的以下帖子：http: [//icelab.com.au/articles/factorygirl-and-has-many-associations/](http://icelab.com.au/articles/factorygirl-and-has-many-associations/)

```
FactoryGirl.define do

  factory :user_level do 
    position             "admin"
    user
  end

  factory :user do     
    name                  "Test User"
    login                 'testuser'
    password              "password1"

    #user_levels
    after(:build) do |user|
      user.user_levels << FactoryGirl.build(:user_level, :user => user)
    end
  end
end 
```

问题（用户级别不能为空）是因为保存用户时没有用户级别。用户级别需要与用户一起构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T16:13:33.693

我认为这是因为每当`create`尝试到`save`工厂`user`时，对嵌套模型的验证都会触发。您是否尝试过使用`after(:build)`回调？

# c# - 如何更新其他班级的进度条？

> ID：11252156
> 
> 赞同：6
> 
> 时间：2012-06-28T20:12:44.090
> 
> 标签：c#, .net, progress-bar

我有一个用 c# 编写的命令行工具（我有它的来源），我正在 Visual Studio 2010 中制作一个 gui。在 gui 中，我想更新进度条以反映工具操作的进度。我将如何从工具内部发出已取得进展的信号并更新进度条？我在做什么的一些简化示例代码。

```
private void doThings_Click(object sender, EventArgs e)
{
  myToolInstance.doWorkThatNeedsToReportProgress();
} 
```

该工具正在完成的工作是一系列函数调用，通常在 30 个左右。我想在其中一个完成时更新进度条。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-28T20:16:59.470

在包含进度条的表单中创建公共属性或公共方法

```
public void SetProgress(int progress)
{
    progressBar.Progress = progress;
} 
```

现在您可以使用更新进度条

```
myForm.SetProgress(50); 
```

* * *

另一种方法是在`ProgressChanged`某处有一个事件并让表单订阅该事件。

```
public class Tool {
    public event Action<int> ProgressChanged;

    private void OnProgressChanged(int progress) 
    {
        var eh = ProgressChanged;
        if (eh != null) {
            eh(progress);
        }
    }

    public void DoSomething()
    {
        ...
        OnProgressChanged(30);
        ...
    }
} 
```

在表格中你会有这样的东西

```
private Tool _tool;

public MyForm () // Constructor of your form
{
    _tool = new Tool();
    _tool.ProgressChanged += Tool_ProgressChanged;
}

private void Tool_ProgressChanged(int progress)
{
    progressBar.Progress = progress;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-09T10:58:50.043

金铲子候选人，不过我遇到了类似的问题，我想在这里分享我的解决方案。

一般来说，由于计算复杂性，我有一个异步运行的方法。输入参数之一是进度条本身。
由于`ProgressBar`是可为空的类型，因此在调用该方法时它不是强制性的。
在方法内部，我在其调度程序中执行进度条前进 - 在许多情况下，该方法将在拥有进度条的其他线程上运行。为了处理进度条为空的可能性，我使用了`nullable`运算符：

```
private string MyMethod(int input, ProgressBar progressBar)
{
    while(!done)
    {
        // Do the hard work.

        progressBar?.Dispatcher.Invoke(() => progressBar.Value++);
    }
} 
```

现在，我需要`Maxiumim`在调用方法之前设置进度条，并且它必须设置为预期的长度。

有人可能会说，每次我需要推进进度条时，我都会调用调度程序导致效率非常低。是的，我同意这一点，但这完全取决于我们需要经历多少步骤。这就是我运行一些快速基准测试的原因。

就我而言，我有超过 300,000（三十万）个步骤（每个步骤都将一些数据格式化为字符串并将该字符串写入文件）。在没有进度条更新的情况下运行该方法是我的参考。

*   **每**一步更新进度条使运行时间延长超过**2,000%**（延长 20 倍）
*   **每 10 步**更新进度条使运行时间延长**250% 以上**（延长两倍半）
*   **每 100 步**更新进度条使运行时间延长约**15%**（延长约 1/8）
*   **每 1000 步**更新进度条使运行时间延长约**3%**（边际差异）

由于我的进度条为 240 像素宽，我已将进度条设置为最大约 300 像素，并相应地对其进行更新，从而获得非常流畅的动画效果，而不会造成明显的性能损失。

# machine-learning - 可以拒绝对 x% 的测试数据进行分类的分类器？（提高精度）

> ID：11252159
> 
> 赞同：1
> 
> 时间：2012-06-28T20:12:57.527
> 
> 标签：machine-learning, classification

我正在进行一项研究，我想提出一种拒绝对测试数据的某些恒定部分进行分类的方法（例如，20%，五分之一的分类可以被算法回答为“我不确定”）。这个想法是有一个算法可以有效地选择哪些分类最有可能是错误的并拒绝回答它们（以提高整体准确性）。

我想知道是否有任何通用的机器学习方法（独立于使用的分类器）来实现这一点？

任何答案都会有所帮助，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:48:49.043

我知道您可以向神经网络添加一个称为拒绝输出的特殊输出。更多细节在[这里。](http://cdn.intechopen.com/pdfs/5799/InTech-Designing_a_pattern_recognition_neural_network_with_a_reject_output_and_many_sets_of_weights_and_biases.pdf)

不过要小心，我认为这样的输出只对大数据集有意义；在小数据集中，您不知道似乎是异常值的给定个体是否不会成为更大数据集中类的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T23:22:50.750

逻辑回归分类器将输出示例属于正面或负面类别的概率。在这种情况下，设置阈值以将示例标记为“未知”将起作用。例如，任何返回正或负概率 <.6 的东西都可以标记为未知。

正如另一位发帖人所建议的那样，另一种方法是将问题视为排名问题。线性分类器（如 SVM 和逻辑回归）输出示例与分离超平面的距离。您可以使用此距离的绝对值对示例进行排序，然后将 20% 的具有最低等级（最接近分离超平面）的测试示例分类为未知。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-02T21:09:30.360

只需谷歌搜索“弃权分类器”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:47:30.217

我假设您谈论二进制分类？

此外，当您说“哪些分类最有可能是错误的并拒绝回答它们”时，我假设您的意思是您想要定义一个分类器无法决定的灰色区域。您可以使用两个决策阈值而不是一个：一个高于该阈值确定您的样本为阳性，一个低于该阈值确定您的样本为阴性。介于两者之间的任何东西都是“未知的”。

如果您的意思是“哪些样本可能是错误的”，那么在这种情况下，它听起来更像是排名任务而不是分类任务。

# c - 在 OpenGL 中使用 GL_QUAD_STRIP 将纹理映射到圆柱体

> ID：11252165
> 
> 赞同：0
> 
> 时间：2012-06-28T20:13:31.730
> 
> 标签：c, opengl, graphics, 3d, textures

所以我在openGL中有一个圆柱体，我不是使用gluCylinder而是使用分段的GL_QUAD_STRIP来创建一个圆形管的印象。我想得到一个纹理图像来环绕圆柱体，但不知道怎么做；当谈到 OpenGL 中的纹理时，我还是个新手，所以也许我不像我想的那样理解纹理。这是我绘制圆柱体并尝试对其进行纹理处理的代码：

```
float x,z,angle;            // Used to calculate cylinder wall
float height = 75.0f;       // Height of the cylinder
float diameter = 10.0f;     // Diameter of the cylinder, or more specifically, 
float normal[3],corners[2][3];  // Storeage for vertex calculations
float numSides = 100.0f;
float step;
float sideLength;
float perimeter;            // Not perimeter of ideal circular cylinder
                            // but actual perimeter of what is drawn
int whichSide;              // Used to keep track of which side you are on during the loop

step = (GL_PI/numSides/2.0f);   // Approximate the cylinder wall with
                                // some number of flat segments
sideLength = 
    2.0f*diameter*(float)sin(GL_PI/(2.0f*numSides)); // Calculate the length of each side

perimeter = numSides * sideLength;

printf("There are %f sides on the small cylinder\nthat are each %f units
     long.\nThe dimensions of the texture must be\nclose to %f x %f\n\n\n", numSides,
     sideLength, perimeter, height);

// Set material color for head of screw
glColor3f(1.0f, 1.0f, 1.0f);

// Assemble the wall as 100 quadrilaterals formed by
// placing adjoining Quads together
glFrontFace(GL_CCW);
glBegin(GL_QUAD_STRIP);

for(angle = (2.0f*GL_PI); angle > 0.0f; angle -= step)
{
    // Calculate x and y position of the first vertex
    x = diameter*(float)sin(angle);
    z = diameter*(float)cos(angle);

    // Get the coordinate for this point and extrude the 
    // length of the cylinder.
    corners[0][0] = x;
    corners[0][1] = -height/2.0f;
    corners[0][2] = z;

    corners[1][0] = x;
    corners[1][1] = height/2.0f;
    corners[1][2] = z;

    // Instead of using real normal to actual flat section
    // Use what the normal would be if the surface was really
    // curved. Since the cylinder goes up the Y axis, the normal 
    // points from the Y axis out directly through each vertex. 
    // Therefore we can use the vertex as the normal, as long as
    // we reduce it to unit length first and assume the y component 
    // to be zero
    normal[0] = corners[1][0];
    normal[1] = 0.0f;
    normal[2] = corners[1][2];

//@@@@@#####*****TEXTURING DONE HERE *****#####@@@@@//

    // Reduce to length of one and specify for this point
    ReduceToUnit(normal);
    glNormal3fv(normal);
    glTexCoord2f(((float)whichSide)/numSides,0.0f);
    glVertex3fv(corners[0]);
    glTexCoord2f(((float)whichSide)/numSides,1.0f);
    glVertex3fv(corners[1]);

    whichSide++;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:26:14.790

如果您将纹理映射过程视为将一张纸包裹在圆柱体周围（因此圆柱体的高度 = 纸张的高度，圆柱体的周长 = 纸张的宽度），您需要做的就是生成 texcoords随角度更改 Y（或 X）（但这将从 0-1 变为角度从 0 变为 Pi）。另一个纹理坐标 X（或 Y）将是 0 和 1，因此它映射到该轴上的全部范围。

# ruby-on-rails - Capybara/Cucumber 无法点击 twitter bootstrap rails 应用程序中的链接/按钮

> ID：11252171
> 
> 赞同：4
> 
> 时间：2012-06-28T20:13:44.447
> 
> 标签：ruby-on-rails, twitter-bootstrap, cucumber, capybara

好的，所以我很确定我在这里做了一些愚蠢的事情，但这是为我的页面上的按钮生成的 HTML
`<a href="/courses/1" class="btn" id="Enroll in Course">Enroll in Course</a>`

Cucumber 步骤定义如下：

```
When /^I go to the course homepage$/ do 
  visit("/courses/#{@course.id}")
end 

Then /^I should see the "(.*?)" button$/ do |button|
  has_button?(button)
end

When /^I click on "(.*?)"$/ do |button| 
  click_on(button)
end 
```

检查页面上是否存在按钮的第二步完美通过，但单击按钮的第三步显示未找到按钮或链接（`click_on`应该同时处理按钮和链接）。

知道为什么会这样吗？

我正在使用 twitter 引导程序，这里是生成上述 html 的 erb 文件的片段：
`<%= link_to 'Enroll in Course',course_path, :class => 'btn', :id => 'Enroll in Course' %>`

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-27T13:33:36.023

在最坏的情况下，您可以通过其 css 选择器找到该元素并强制单击它。

```
find('#enrollInCourse').click 
```

# ios - ios - 打开 sqlite 数据库

> ID：11252173
> 
> 赞同：4
> 
> 时间：2012-06-28T20:14:12.843
> 
> 标签：ios, xcode, sqlite

我正在尝试从 sqlite 数据库中读取数据并将其显示在 ios 应用程序的表视图中。但由于某种原因，我无法打开 sqlite 数据库，并且应用程序崩溃并显示消息 - 无法打开数据库。

我使用 Firefox sqlite 管理器创建了数据库并将文件复制到 Xcode 项目中。

这是我的代码 -

```
-(NSString *)dataFilePath{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory , NSUserDomainMask, YES);
    NSString *documentsDir = [paths objectAtIndex:0];
    return [documentsDir stringByAppendingPathComponent:kFilename];
} 
```

我正在尝试使用 viewDidLoad 中的 sqlite3_open_v2 命令打开数据库

```
sqlite3 *database;

    if (sqlite3_open_v2([[self dataFilePath] UTF8String], &database, SQLITE_OPEN_READWRITE, NULL) != SQLITE_OK) {
        sqlite3_close(database); // not sure you need to close if the open failed
        NSAssert(0, @"Failed to open database");
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T20:29:30.487

这就是我打开数据库的方式。我已经很久没有做 SQLite 了，除了提供我在自己的应用程序中使用的代码之外，我无法给你太多帮助。这是我在我的应用程序中使用的一个类。

```
static sqlite3 *database;
static sqlite3_stmt *enableForeignKey;

@implementation DBAdapter

+ (sqlite3 *)sharedInstance {

    if (database == NULL) {
        sqlite3 *newDBconnection;

        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *path = [documentsDirectory stringByAppendingPathComponent:@"klb_db.sqlite"];

        if (sqlite3_open([path UTF8String], &newDBconnection) == SQLITE_OK) {   
            //NSLog(@"Database Successfully Opened :)");
            database = newDBconnection;

            if (sqlite3_prepare_v2(database, "PRAGMA foreign_keys = ON", -1, &enableForeignKey, NULL) != SQLITE_OK) {
                NSLog(@"ERROR IN PRAGMA!");
            }

            sqlite3_finalize(enableForeignKey);

        } else {
            NSLog(@"Error in opening database :(");
            database = NULL;
        }
    }

    return database;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-29T00:35:06.217

我是否正确假设您的问题在我们讨论[ios-sqlite 准备语句](https://stackoverflow.com/questions/11242298)的评论中得到了回答？也就是说，我们要确保数据库包含在包中（通过在 Xcode 中为您的目标的“构建阶段”确认“复制包资源”设置）并且您希望您的应用程序检查数据库的存在在您的文档文件夹中，如果它不存在，您会将其从捆绑包 ( `[[[NSBundle mainBundle] bundlePath] stringByAppendingPathComponent:kFilename]`) 复制到您的文档文件夹。

这可能超出了您最初问题的范围，但是当您考虑最终部署您的应用程序，更重要的是，您的应用程序的后续升级/发布时，您可能希望将一些表添加到您的数据库中，其中包含一些内部数据库版本号您可以使用它来确定用户在其文档文件夹中拥有的数据库版本，并对该数据库进行任何您可能需要的修改以支持您的应用程序的最新版本。只是一个想法。

无论如何，如果您仍有任何未解决的问题，请告诉我们。否则我会假设我们已经解决了你的问题。

# javascript - Jquery attr src 从 src 中删除了一个字符串，但没有删除更复杂的字符串，为什么？

> ID：11252174
> 
> 赞同：0
> 
> 时间：2012-06-28T20:14:17.570
> 
> 标签：javascript, jquery, html, vimeo

我正在使用 jquery 通过单击某个列表项从嵌入式 vimeo 视频中删除 src 。当我在 src 字符串中使用这个嵌入代码时工作正常：

```
video1.attr('src','http://player.vimeo.com/video/43550778); 
```

但是我宁愿使用更复杂的嵌入代码来摆脱一些难看的默认嵌入设置：

```
video1.attr('src','http://player.vimeo.com/video/43550778?title=0&amp;byline=0&amp;portrait=0&amp;color=ababab'); 
```

这行不通。当点击触发该属性被移除的列表项时，它不起作用。除此以外，所有其他功能均有效。这个嵌入代码有问题吗？一些非法字符？我想不通。

任何帮助表示赞赏！

编辑：我已经像这样设置了我的 jquery：

```
nav.filter(':nth-child(1)').on( 'click', function(){
        images.filter(':nth-child(1)').slideDown(800).siblings().slideUp(50);
        video2.attr('src','');
        video1.attr('src','http://player.vimeo.com/video/43550778?title=0&byline=0&portrait=0&color=ababab');
    }); 
```

我正在使用空的 src 实际上在视频向上滑动时停止视频。如您所见，页面上还有一个不同的视频也被隐藏了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:19:54.917

以下对我有用。你的代码有什么不同？

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

<img src="foobar">

<a href="#" onclick="$('img').attr('src', 'http://player.vimeo.com/video/43550778?title=0&amp;byline=0&amp;portrait=0&amp;color=ababab');">click</a>

<a href="#" onclick="$('img').removeAttr('src');">remove</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:21:37.040

正如@TrentSeed 建议的那样，您不需要在javascript 源代码中将与符号编码为HTML 实体。只需使用文字 & 符号。

[http://jsfiddle.net/xdUMN/](http://jsfiddle.net/xdUMN/)

# xml - XSD 中复杂类型的选择

> ID：11252175
> 
> 赞同：4
> 
> 时间：2012-06-28T20:14:36.057
> 
> 标签：xml, xsd, complextype

在 XML 模式中，复杂类型可以包含其他复杂类型的选择吗？我找不到任何相关信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:19:29.277

是的，请参阅XML Schema 参考的[第 3.4.2 节](http://www.w3.org/TR/xmlschema-1/#declare-type)；a`complexType`确实可以包含一个`choice`元素。

类似地，一个`choice`元素可以包含一个或多个`complexType`元素（参见[第 3.8.2 节](http://www.w3.org/TR/xmlschema-1/#declare-contentModel)）。

# bash - 访问 Hive 表并将查询转储到 txt 文件

> ID：11252176
> 
> 赞同：0
> 
> 时间：2012-06-28T20:14:36.477
> 
> 标签：bash, hive

我正在尝试访问配置单元表并将结果转储回文本文件。当我尝试这样做时，我总是被拒绝许可？有什么我想念的吗？

```
bash-3.00$ 'select * from ATTRIBUTE_DATA_REALTIME LIMIT 10' > test.txt
bash: test.txt: Permission denied 
```

在这种情况下我需要什么许可？还是我的查询有误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:59:45.993

首先 - 你错过了一个`hive -e`. 有了你现在所拥有的，Bash 将寻找一个名为`select * from ATTRIBUTE_DATA_REALTIME LIMIT 10`!

但是对于权限问题，有两种可能：

*   如果`test.txt`已经存在，那么您需要以有权写入文件的用户身份运行命令。（`ls -l test.txt`用于查看谁拥有该文件及其权限。）
*   如果`test.txt` *不*存在，那么您需要以有权写入*包含*该文件的目录（即当前目录）的用户身份运行您的命令。（`ls -ld .`用于查看谁拥有该目录及其权限。）

# objective-c - 在 Objective-C 中将 double 与 int 相乘

> ID：11252178
> 
> 赞同：-1
> 
> 时间：2012-06-28T20:14:43.823
> 
> 标签：objective-c, ios

我正在为 iOS 创建一个应用程序，但我遇到了一个数学问题。我不知道如何将一个 double 乘以一个 int。这甚至可能吗？这是我卡住的地方：

```
double *one = 465654753464353;
int *two = 4;
double *sum = one * two; 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:17:14.073

首先，我很确定你的意思是

```
double one = 465654753464353; 
```

使用星号创建一个指向双精度的指针。

所以试试这个：

```
double one = 465654753464353;
int two = 4;
double sum = one * two; 
```

这应该有效。

如果您打算使用指针，请查看@JAB 的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:18:21.163

你不应该有指针。这就是你的代码应该是这样的：

```
double one = 465654753464353;
int two = 4;
double sum = one * two; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:34:28.943

在objective-c中有两种不同类型的变量。对象和原始数据。两者之间有许多不同之处，但是，这稍微超出了我的回答范围。通常原始数据类型不需要指针（名称之前的 *）。

为了便于记忆，原始数据类型将像保留字一样以粉红色显示。对象将是蓝色或绿色（取决于您制作的类或苹果制作的类）。- 颜色基于默认语法突出显示，但是，它们适用于 xCode 附带的大多数主题。

ints 和 doubles 都是原始数据类型，因此在定义它们时不需要使用星号。查看 qegal 的答案以了解您的代码应该如何。

# asp.net - 为什么我的 JsonpMediaTypeFormatter 没有处理我的 WCF 请求？

> ID：11252189
> 
> 赞同：1
> 
> 时间：2012-06-28T20:15:38.633
> 
> 标签：asp.net, wcf, jsonp, wcf-data-services, odata

G'day 朋友（我是美国人，但 G'day 听起来很酷）

我刚刚安装了 WCF 数据服务 5.0 包以及最新的 ASP.NET Web API 并且遇到了一个非常烦人的问题。通过在 Google 上搜索，我绝对不是唯一遇到这个问题的人，但没有一个我发现的解决方案似乎有效。

我的问题是主机应用程序不接受包含该`$`字符的请求，无论我尝试什么，它都不会将请求传递给我的`JsonpMediaTypeFormatter`. 因此，我不知道格式化程序是否会解决实际问题。

使用提琴手，我可以看到请求是用一个“ `Accepts`”头的“ `*/*`”发出的，我想它不会通过我的格式化程序，我不能将“ `*/*`”添加到，`MediaTypeHeaderValue`因为它抱怨它是一个范围。

请任何帮助或建议将不胜感激！

* * *

### 设置的完整描述

我创建了一个沙盒解决方案来进行测试，它由两个 ASP.NET Web 应用程序项目组成。第一个项目被调用`ClientApplication`，第二个被调用`HostApplication`（我相信你可以推断出哪个做了什么）。它们中的每一个都由我的本地 IIS 托管在不同的网站和 IP 地址中。我尽我所能来创建它们，就好像它们在物理上完全分离而实际上不需要服务器。

### 主机应用程序

有一个简单的 EDMX 文件映射到一个简单的数据库，里面有一些基本的表，没什么特别的。我也有我的服务类如下：

```
public class ODataService : DataService<Data.SandboxEntities>
{
    public static void InitializeService(DataServiceConfiguration config)
    {
        config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3;
        config.UseVerboseErrors = true;
        config.SetEntitySetAccessRule("Customers", EntitySetRights.All);
        config.SetEntitySetAccessRule("Employees", EntitySetRights.All);
        config.SetEntitySetAccessRule("RandomDatas", EntitySetRights.All);
        config.SetEntitySetAccessRule("Schedules", EntitySetRights.All);
        config.SetEntitySetAccessRule("Shifts", EntitySetRights.All);
    }
} 
```

我正在使用与`JsonpMediaTypeFormatter`Peter Moberg 对问题的评论中使用的相同代码：[JSONP with ASP.NET Web API](https://stackoverflow.com/questions/9421312/jsonp-with-asp-net-web-api)

最后，我`JsonpMediaTypeFormatter`在`Global.asax`文件中注册了我的：

```
 protected void Application_Start(object sender, EventArgs e)
    {
        var config = GlobalConfiguration.Configuration;
        config.Formatters.Insert(0, new JsonpMediaTypeFormatter());
    } 
```

### 客户端应用程序

为了将它们结合在一起，我在客户端应用程序中有一个非常简单的页面，其中包含以下代码：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Service Client Application</title>
    <script src="Scripts/jquery-1.7.2.js" type="text/javascript"></script>
    <script type="text/javascript">
        function makeServiceCall()
        {
            try
            {
                /*
                $.getJSON('http://10.10.1.7/ODataService.svc/Customers?$format=json&$callback=?',
                function (response)
                {
                    $.each(response.d, function (index, value)
                    {
                        var div = document.createElement('div');
                        div.innerHTML = value.ClientName;
                        $('#result').append(div);
                    })
                });
                */

                $.ajax({
                    type: "POST",
                    url: "http://10.10.1.7/ODataService.svc/Customers",
                    dataType: "json",
                    contentType: "application/json",
                    success: function (result) { alert("Winning."); },
                    error: function (result) { alert("Losing..."); }
                });
            }
            catch (err)
            {
                alert(err);
            }
        }
    </script>
</head>
<body>
    <form id="MainForm" runat="server">
        <div id="result" style="border:1px solid black;background-color:#E8E8E8;"></div>
        <button onclick="makeServiceCall();return false;">Call Service</button>
    </form>
</body>
</html> 
```

您可能会注意到其中有一些带注释的 javascript。这是因为我尝试了两种不同的方法来进行服务调用（这两种方法都不起作用），我想一定要向你们说明这一点。

再次感谢！杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T06:59:08.777

您尝试使用的 JSONP 帮助程序旨在与 WebAPI 一起使用。您的服务使用 WCF 数据服务。即使它们执行相似的操作，它们也不相同。而且 JSONP 帮助程序不能与 WCF 数据服务一起使用。可以在这里找到有效的方法：http: [//archive.msdn.microsoft.com/DataServicesJSONP](http://archive.msdn.microsoft.com/DataServicesJSONP)

请注意，在 WCF DS 5.0 中，围绕 JSON 的行为发生了变化，上面页面上的注释显示了如何修复代码以使其也适用于 5.0。

# javascript - Google Analytics 电子商务跟踪仅接收 3 项中的 2 项

> ID：11252192
> 
> 赞同：1
> 
> 时间：2012-06-28T20:15:45.237
> 
> 标签：javascript, google-analytics

这是我第一次使用 Google Analytics 电子商务跟踪来获取购买的多件商品的数据。我只在 GA 收到 Morning Round 和 Additional Donation 产品，总订单为 21 美元。我尝试使用 GA 调试器，但它没有给我任何错误。有任何想法吗？

```
<script type="text/javascript">

var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-XXXXXXX-2']);

_gaq.push(['_setDomainName', 'mercyhome.org']);
_gaq.push(['_trackPageview']);
_gaq.push(['_addTrans',
'1234567890',// order ID - required
'Golf Classic Registration',// affiliation or store name
'1,520.00',// total - required
  '0.00',           // tax
  '0.00',              // shipping
'Chicago',// city
'IL',// state or province
'US'// country
]);

//add item might be called for every item in the shopping cart
//where your ecommerce engine loops through each item in the cart and
//prints out _addItem for each
_gaq.push(['_addItem',
'1234567890',// order ID - required
'13M88GO901',// SKU/code - required
'Afternoon Round Individual Golfer',// product name
'Golf Classic',   // category or variation
'300',// unit price - required
'1'// quantity - required
]);
_gaq.push(['_addItem',
'1234567890',// order ID - required
'13M88GO901',// SKU/code - required
'Morning Round Playing Foursome',// product name
'Golf Classic',   // category or variation
'1,200',// unit price - required
'1'// quantity - required
]);
_gaq.push(['_addItem',
'1234567890',// order ID - required
'13M88GO902',// SKU/code - required
'Additional Donation',// product name
'Golf Classic',   // category or variation
'20.00',// unit price - required
'1'// quantity - required
]);
_gaq.push(['_trackTrans']); //submits transaction to the Analytics servers

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +     '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T22:29:14.187

下午和早上的商品似乎具有相同的 SKU。从`_addItem()` [文档](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEcommerce#_gat.GA_Tracker_._addItem)：

```
Ensure that each item in your inventory has a unique SKU.
If your inventory has different items with the same SKU, and a visitor purchases both of them, you will receive data for only the most recently added. 
```

# facebook - Symfony2 + PHP Facebook API

> ID：11252195
> 
> 赞同：2
> 
> 时间：2012-06-28T20:16:09.543
> 
> 标签：facebook, symfony

我正在尝试在 Symfony2 Bundle 中使用 Facebook API for PHP。

我的问题是如何将这些类包含在我的 Bundle 中。

在我的自动加载文件中，我包含了命名空间**DIR** .'/../vendor/facebook/src'，但它仍然不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:18:45.220

只需使用 即可满足`FOSFacebookBundle`您的所有`facebook`需求。

可以在此处找到该捆绑包： [https ://github.com/FriendsOfSymfony/FOSFacebookBundle](https://github.com/FriendsOfSymfony/FOSFacebookBundle)

如果此捆绑包对您没有帮助，则只需将其添加到您的底部`autoload.php`

```
//Loading facebook from vendor
require_once __DIR__ . '/../vendor/facebook/src/facebook.php'; 
```

然后在控制器调用中：

```
$facebook = new \Facebook(array(
  'appId'  => 'YOUR_APP_ID',
  'secret' => 'YOUR_APP_SECRET',
)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-23T06:11:31.843

如果您使用 Composer - 添加到您的 composer.json：

```
{
  "require" : {
    "facebook/php-sdk-v4" : "4.0.*"
  }
} 
```

更多信息：[https ://developers.facebook.com/docs/php/gettingstarted](https://developers.facebook.com/docs/php/gettingstarted)

# node.js - 使用 node 和 express 的 REST 调用在本地成功，但在部署到 azure 后失败

> ID：11252196
> 
> 赞同：0
> 
> 时间：2012-06-28T20:16:14.953
> 
> 标签：node.js, rest, azure, express

我有一个非常基本的 REST 调用，它是使用 node / express 编写的，它以 2 个日期时间作为参数（http://localhost:3000/schedules/'2012-06-28T16:00:00'/'2012-06-28T19: 00:00'）当我直接对节点可执行文件（在 Windows 和我的 Mac 上）运行测试时，它在本地运行良好，但是当我通过 git 将其部署到 Azure 时，我得到了臭名昭著的黄屏。

来自 azure 的调试日志是空的（永远不会到达我的 console.logs 节点），所以我猜测错误发生在 iisnode 中的某个地方，然后才被路由到节点 exe。如果我使用以下格式（http://localhost:3000/schedules/2012-06-28/2012-06-29），调用确实可以正常工作。我正要安装 iisnode 以进行更多测试，但在深入研究之前，我想知道是否有其他人遇到过这个问题。

以下是部分代码块：

路线

```
app.param('startdate',
function(req, res, next, startdate) {
    req.startdate = startdate;
    next();
});

app.param('enddate',
function(req, res, next, enddate) {
    req.enddate = enddate;
    next();
});

app.get('/schedules/:startdate/:enddate',scheduleController.getSchedulesByStartDateAndEndDate); 
```

调度控制器

```
exports.getSchedulesByStartDateAndEndDate = function(req, res){
    console.log('getSchedulesByStartDateAndEndDate');
    console.log('StartDate'+req.params.startdate);
    console.log('EndDate'+req.params.enddate);
    ScheduleProvider.getSchedulesByStartDateAndEndDate(req.params.startdate,     req.params.enddate,function(schedules){
        res.send(schedules);
    });
}; 
```

调度提供者

```
ScheduleProvider.prototype.getSchedulesByStartDateAndEndDate =     function(startdate,enddate,callback){
console.log(startdate);
console.log(enddate);
var stDate = startdate;
var endDate = enddate;
if (stDate !== undefined) {
    var startDate = new Date(unescape(stDate.toString()).replace(/'/gi, ""));
    endDate = new Date(endDate === undefined ? startDate: unescape(endDate.toString()).replace(/'/gi, ""));
    var sttimes = getTimes(startDate);
    var endtimes = getTimes(endDate);
    console.log(startDate);
    console.log(endDate);
    console.log(sttimes[0]);
    console.log(sttimes[1]);
    console.log(endtimes[0]);
    console.log(endtimes[1]);

    Schedule.find({
        $or: [
        {
            'StartDate': {
                $gte: sttimes[0],
                $lt: endtimes[1]
            }
        },
        {
            'EndDate': {
                $gt: sttimes[0],
                $lte: endtimes[1]
            }
        }
        ]
    }, function(err, schedules){
    callback(schedules);
}).sort('StartDate', 'ascending');
}
}; 
```

我正在使用 mongoose 进行调用，但我认为它不会访问提供程序或控制器代码。这几乎就像 azure 不喜欢传入的日期并引发异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T00:47:35.120

在本地运行时，您直接使用 Node 来托管应用程序。在 Windows Azure 网站中运行时，您同时使用 IIS 和 IISNode 以及 Node.js。我怀疑您在 IIS 处理单引号时遇到问题，而 Node（本地）没有这样做。您应该尝试在 IIS（使用 IISNode）中本地运行该站点，以查看是否存在相同的问题。可能最简单的方法是在 Windows Azure 模拟器中运行该站点，因为您可以使用该工具来部署您的应用程序。

# ruby-on-rails - Windows 上的 Rails 部署环境

> ID：11252199
> 
> 赞同：11
> 
> 时间：2012-06-28T20:16:31.780
> 
> 标签：ruby-on-rails, windows, ruby-on-rails-3, apache, deployment

有没有什么好的方法可以在 Windows 机器上部署基于 Ruby 1.9.3 和 Rails 3.2.6 和 Apache 的 Ruby on Rails 应用程序？我花了几个小时搜索论坛，但所有帖子似乎都太旧了，无法使用最新版本的 Ruby 和 Rails。Mongrel 不再处于开发阶段，并且经常导致 Rails 崩溃，thin 只有基本的 Windows 支持，并且在我的计算机上导致 Ruby 运行时“以不寻常的方式终止自身”，Passenger 仅适用于 Linux ......我有点迷路了在此刻。

是否有任何稳定的、有据可查的解决方案来为基于 Windows 上的 Apache 的最新框架构建的 Rails 应用程序提供服务？

**更新**

我终于找到了自己的解决方案。请在下面查看有关在 Windows 上部署 Rails 的最新指南。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-23T20:25:08.920

**更新：**我刚刚回到我部署此流程的公司。在产品使用期间完全无人维护 11 个月后，应用程序和服务器环境仍然可以完美运行 :)

好吧，看来我*终于*想通了。请注意，我正在部署到公司 Intranet 上的一小部分用户，因此我的解决方案可能不适用于所有人。我正在使用优秀的[Bitnami RubyStack](http://bitnami.org/stack/rubystack/)，它包含一个集成的 Apache/Rails/MySQL 安装。从那里我做了以下事情（适用于 Rails 3.2.6 和 Ruby 1.9.3）：

1.  关闭所有 Apache 和 Rails (WEBrick/Thin/Mongrel/Unicorn) 服务器。如果您打开了任何开发版本，请退出您的网站。清除浏览器缓存。

2.  如果您还没有，请将您的数据库迁移到生产模式。从 RubyStack 命令行， cd 到您的应用程序目录，然后运行`bundle exec rake db:migrate db:schema:load RAILS_ENV="production"`​​. 警告：db:schema:load 将删除生产数据库中的所有数据。

3.  预编译您的资产：`bundle exec rake assets:precompile`. 请注意，这可能需要*很*长时间，具体取决于您的资产。

4.  在你的`httpd.conf`（对我来说是 C:\RubyStack-3.2.5-0\apache2\conf\httpd.conf）

    确保没有注释掉必要的模块：

    ```
    LoadModule expires_module modules/mod_expires.so
    LoadModule headers_module modules/mod_headers.so
    LoadModule proxy_module modules/mod_proxy.so
    LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
    LoadModule proxy_http_module modules/mod_proxy_http.so
    LoadModule rewrite_module modules/mod_rewrite.so 
    ```

    然后将以下代码粘贴到文件中的某处，`app_name`作为 Rails 应用程序的文件夹名称和`*:82`Apache 正在侦听的任何端口号（由命令表示`Listen <port_number>`：

    ```
    <VirtualHost *:82>

      # Your server's web or IP address goes here.
      # You can leave at localhost if deploying to
      # company intranet or some such thing.
      ServerName localhost

      # Customize the next two lines with your app's public directory
      DocumentRoot "C:/RubyStack-3.2.5-0/projects/app_name/public"
      <Directory "C:/RubyStack-3.2.5-0/projects/app_name/public">
        Allow from all
        Options -MultiViews
      </Directory>

      RewriteEngine On

      # Redirect all non-static requests to Rails server,
      # but serve static assets via Apache
      RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
      RewriteRule ^/(.*)$ balancer://app_balancers%{REQUEST_URI} [P,QSA,L]

      # Serves dynamic rails assets from multiple servers
      # to improve performance. A Rails server such as
      # thin or WEBrick must be running on at least one of
      # these ports in order for Apache to serve your site
      <Proxy balancer://app_balancers>
        BalancerMember http://localhost:3001/
        BalancerMember http://localhost:3002/
      </Proxy>

      # Support for far-futures expires header
      <LocationMatch "^/assets/.*$">
        Header unset ETag
        FileETag None
        # RFC says only cache for 1 year
        ExpiresActive On
        ExpiresDefault "access plus 1 year"
      </LocationMatch>
    </VirtualHost> 
    ```

5.  为您的应用程序将使用的每个 Rails 服务器创建一个 Windows 批处理文件 (*.bat)。确保在平衡器的端口上以生产模式运行它们。例如，对于您的第一台服务器：

    ```
    @echo off
    cd D:\your_app_folder
    rails s -e production -p 3001 
    ```

6.  注意：接下来的几个步骤是必要的，因为 Rails 服务器需要作为服务运行，否则如果没有用户登录到服务器，它们将被关闭。这也允许它们在失败时自动重新启动。但是，Windows 无法将批处理文件作为服务运行，因此我们必须将它们转换为 Windows EXE。但是标准的 Windows EXE 不能用作服务，因为它们不响应 OnStart 和 OnStop 方法。所以，为了最终让我们的服务器作为 Windows 服务运行，我们必须使用 Non-Sucking Service Manager 作为我们的 Windows EXE 的前端。

7.  下载一个 BAT 到 EXE 转换器（只需 google 一个）并从您的批处理文件中制作 EXE。确保您获得的转换器具有在运行时隐藏命令窗口的选项（该选项通常称为“可见性”或类似名称。）

8.  下载[非吸吮服务管理器](http://nssm.cc)(nssm.exe)。把它放在永久的地方，然后将该文件夹添加到您的路径中。

9.  启动命令提示符。类型`nssm install <servicename>`，`<servicename>`您希望调用的服务在哪里。系统将提示您输入您希望作为服务运行的应用程序的路径；选择您在步骤 7 中创建的 Windows EXE，然后单击安装，将命令行选项留空。

10.  对平衡器中的所有端口重复步骤 6-8，为每个 Rails 服务器创建不同的服务。

11.  启动您刚刚创建的所有服务（开始菜单 -> 管理工具 -> 服务）。服务应该立即启动，但您必须给 Rails 服务器至少 30 秒的时间来初始化。

12.  启动阿帕奇。如果它没有启动，请检查您是否包含了所有必要的模块（在第 4 步的第一部分中列出）。

13.  导航到`localhost:82`，如果您对其进行了自定义，请将您的端口号替换为 82。您应该看到您的网站看起来与开发中的完全一样。

请让我知道这是否太长而不适合 StackOverflow。我刚刚花了很多时间来解决这个问题，并认为现在是时候有人为 Windows 上的 Rails 部署编写最新指南了（如果有的话，我还没有看到）。祝你好运，如果有人对此有问题或改进，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T15:09:46.750

XAMPP 可能会帮助您实现这一目标，这里有不错的指南：[http ://www.andriets.com/development-en/ruby/ruby-xampp-en.html](http://www.andriets.com/development-en/ruby/ruby-xampp-en.html)

# python - 如何在 webkit gtk 中禁用网络安全（跨源请求）

> ID：11252206
> 
> 赞同：2
> 
> 时间：2012-06-28T20:16:56.610
> 
> 标签：python, webkit, gtk, pygobject

我正在尝试为几个站点编写一个特定于站点的浏览器，并且遇到了 webkitgtk 的问题。WebKitGtk 阻止某些跨域请求作为安全措施，并且无法在 WebKitGtk API 中禁用它

Python 简单示例

```
from gi.repository import Gtk, WebKit
window = Gtk.Window()
webview = WebKit.WebView()
webview.load_uri('http://drive.google.com')
window.add(webview)
window.show_all()
Gtk.main() 
```

输出：

```
 ** Message: console message:  @0: Unable to post message to https://0.drive.google.com. Recipient has origin https://drive.google.com. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-15T17:52:52.963

目前不可能。错误：[https ://bugs.webkit.org/show_bug.cgi?id=58378](https://bugs.webkit.org/show_bug.cgi?id=58378)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:34:42.137

与我相关的唯一设置是`enable-xss-auditor`：

```
settings = WebKit.WebSettings()
settings.set_property('enable-xss-auditor', False)
webview.set_settings(settings) 
```

# html - twitter bootstrap 复选框 html 无法正常运行

> ID：11252209
> 
> 赞同：0
> 
> 时间：2012-06-28T20:17:04.160
> 
> 标签：html, twitter-bootstrap

出于某种原因，当我使用 jquery 生成它来填充我的表时。复选框不会像 twitter bootstrap 那样出现。

```
<tr>
  <td align="center">
    <label class="checkbox inline">
      <input id="cbox" type="checkbox" name="CheckGroup1" value="somenumber"; />
    </label>
  </td>
  <td align="center">
  <label class="radio">
    <input id= "box" type="radio" name="RadioGroup1" value="somenumber" />
  </label>
  </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T03:25:23.377

在查看您在 Google Chrome 中发布的 fiddle，然后使用 Chrome 的调试器（F12），然后在调试器中查看 Console 时，您可能会发现以下错误：

> Uncaught SyntaxError: Unexpected token ILLEGAL

语法错误指向这里：

```
attributes = ['blah", "blah", "blah", "blah... 
```

因此，在数组的第一`blah`项中，封闭的引号是混合的：单引号和双引号。但是，如果您将其更改为：

```
attributes = ["blah", "blah", "blah", "blah... 
```

...然后您的 html 应该正确呈现，就像您的小提琴的以下分支一样。 [http://jsfiddle.net/cykm5/4/](http://jsfiddle.net/cykm5/4/)

Is this what you meant when you said, "The checkboxes don't come out as they should..."?

# android - 加载小图像Drawable时Android内存不足

> ID：11252216
> 
> 赞同：0
> 
> 时间：2012-06-28T20:17:21.287
> 
> 标签：android, bitmap, drawable, out-of-memory

我想知道在视图中使用图像可绘制对象时如何将它们加载到内存中。

我的问题是我有一个大尺寸的图像（大约 600x700），它的重量只有 4kb。我认为没有必要创建一个 9-patch 图像，因为图像足够小。但是，当我尝试将此图像用作背景时，Android 出现内存不足错误。

```
06-28 14:54:09.359: E/dalvikvm-heap(2272): Out of memory on a 6816336-byte allocation.
06-28 14:54:09.359: I/dalvikvm(2272): "main" prio=5 tid=1 RUNNABLE
06-28 14:54:09.359: I/dalvikvm(2272):   | group="main" sCount=0 dsCount=0 obj=0x40a5d460 self=0x12828
06-28 14:54:09.359: I/dalvikvm(2272):   | sysTid=2272 nice=0 sched=0/0 cgrp=default handle=1074603144
06-28 14:54:09.359: I/dalvikvm(2272):   | schedstat=( 0 0 0 ) utm=162 stm=18 core=0
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.Bitmap.nativeCreate(Native Method)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.Bitmap.createBitmap(Bitmap.java:605)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.Bitmap.createBitmap(Bitmap.java:551)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.Bitmap.createScaledBitmap(Bitmap.java:437)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.BitmapFactory.finishDecode(BitmapFactory.java:524)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:499)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:351)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:773)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.content.res.Resources.loadDrawable(Resources.java:1937)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.content.res.Resources.getDrawable(Resources.java:664)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.view.View.setBackgroundResource(View.java:11588)
06-28 14:54:09.359: I/dalvikvm(2272):   at com.telcel.olmpiadas2012.gui.viewcontrollers.medals.MedalsDetail.<init>(MedalsDetail.java:14)
06-28 14:54:09.359: I/dalvikvm(2272):   at com.telcel.olmpiadas2012.gui.viewcontrollers.medals.MedalsHomeVC.onCreate(MedalsHomeVC.java:53)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.app.Activity.performCreate(Activity.java:4465)
06-28 14:54:09.359: I/dalvikvm(2272):   at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.app.ActivityThread.access$600(ActivityThread.java:122)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.os.Handler.dispatchMessage(Handler.java:99)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.os.Looper.loop(Looper.java:137)
06-28 14:54:09.367: I/dalvikvm(2272):   at android.app.ActivityThread.main(ActivityThread.java:4340)
06-28 14:54:09.367: I/dalvikvm(2272):   at java.lang.reflect.Method.invokeNative(Native Method)
06-28 14:54:09.367: I/dalvikvm(2272):   at java.lang.reflect.Method.invoke(Method.java:511)
06-28 14:54:09.367: I/dalvikvm(2272):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
06-28 14:54:09.367: I/dalvikvm(2272):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
06-28 14:54:09.367: I/dalvikvm(2272):   at dalvik.system.NativeStart.main(Native Method) 
```

我已经毫无问题地添加了其他大图像作为背景，我怀疑我的应用程序占用了除了 4kb 之外的所有内存空间，因为其他活动加载的资源比这个更多，而且我访问它们没有问题。

我应该考虑其他方面而不是最终图像字节大小吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T13:27:57.033

位图未压缩，并且 600x700 的大小使其对于内存来说非常大，如果质量不是问题，您可以尝试缩小它。

编辑：

600*700*32/8=1680000

# android - Android match_parent 向后兼容性问题不会编译 Eclipse

> ID：11252220
> 
> 赞同：3
> 
> 时间：2012-06-28T20:17:33.473
> 
> 标签：android, compatibility

> 注意：在解析 XML 资源时，Android 会忽略当前设备不支持的 XML 属性。因此，您可以安全地使用仅受新版本支持的 XML 属性，而不必担心旧版本在遇到该代码时会中断。例如，如果您设置 targetSdkVersion="11"，则您的应用在 Android 3.0 及更高版本上默认包含 ActionBar。要将菜单项添加到操作栏，您需要在菜单资源 XML 中设置 android:showAsAction="ifRoom"。在跨版本的 XML 文件中执行此操作是安全的，因为旧版本的 Android 会简单地忽略 showAsAction 属性（也就是说，您不需要在 res/menu-v11/ 中使用单独的版本）。

来源：http: [//developer.android.com/training/basics/supporting-devices/platforms.html](http://developer.android.com/training/basics/supporting-devices/platforms.html)

[^ 尽管有这种说法，eclipse 拒绝从这里](http://developer.android.com/training/basics/fragments/index.html)的同一站点编译未更改的片段基础版本。

给出的错误信息是：

> 不允许使用字符串类型（在“layout_width”处，值为“match_parent”）。

无论如何我可以在 XML 中抑制这个错误，比如某种无声标记，表明它们只适用于特定的 API 级别？理想情况下，我希望该项目在 Eclipse 中工作，并保持 1.6 的向后兼容性。

注意：所有其他错误都与未生成 R 相关，因此这是唯一的第一代错误。

清单文件确实包含该行

```
<uses-sdk android:minSdkVersion="4" android:targetSdkVersion="15" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T21:08:52.727

您可以在较新的 API 中进行编译，并且应用程序仍将在旧 API 中运行，从而消除这些错误，只要您在未先提供相关检查的情况下不使用 .java 文件中的任何不受支持的功能即可。我以为我必须针对最低的 API 而不是最高的 API 进行编译，但是已经使用 1.6 AVD 进行了测试，以运行使用 4.0 编译的项目，并且它运行完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:24:45.320

您是否尝试使用“fill_parent”而不是“match_parent”？如果您想为不同的 api 级别设置不同的属性值，您还可以通过将它们放在 values-4 (1.6 android) 和 values (其他所有) 文件夹中来创建一个带有这些属性的样式 xml 条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:31:36.383

如果您要针对 API 8 或更低版本构建应用程序，则需要使用`fill_parent`. 也就是说，如今大多数开发人员都使用 API 8 作为支持的*最低 sdk*，因此您确实应该考虑针对较新的 API 构建您的应用程序。

# javascript - JS--自定义图片属性

> ID：11252221
> 
> 赞同：0
> 
> 时间：2012-06-28T20:17:42.757
> 
> 标签：javascript, json, image, html

我需要能够定义这样一个事实，即[像这样的棋盘游戏图块](http://russcon.org/RussCon/carcassonne/city1rsw.png)的上边缘有一座城市，左边缘和下边缘有道路，右边缘有草。

我怎样才能做到这一点？从我读到的关于 HTML5 自定义数据属性的内容来看，它们似乎是一个可行的选择（例如，“data-left='road'...”），但我希望在获得更多编码经验之前得到确认深入项目。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:30:36.290

是的，您可以在 HTML 5 中使用自定义数据属性。只需在它们前面加上“data-”，例如

```
<img src="foo.jpg" data-some-arbitrary-attribute="foo" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:31:24.197

您可以使用 toske 所说的自定义属性，但我建议您创建场景的数据对象模型表示（使用 JSON），然后他们处理此模型以呈现您的界面。

编辑：[这是一个例子](http://jsfiddle.net/URWT9/)。数据是包含一些代表每个图块的对象的图块数组。我使用了 jQuery，但你可以使用你想要的 JavaScript 库。如果您不知道如何使用它，我建议您学习 jQuery。这是一个非常强大和简单的库。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-28T20:28:11.327

您绝对可以将自定义属性放在 HTML5 标记中，例如：

```
 <img left-connection="road" right-connection="railroad"... /> 
```

虽然我宁愿建议只用 id 标记 img 标签，然后有一个 JSON 对象将 ID 映射到连接数据，例如：

```
 <img id="a11" src="..." />

    <script type="text/javascript> 
       var connectivityData = { a11 : { left : 'road',right:'railroad'}}
    </script> 
```

# wpf - 从调用属性更改回调的方法中设置依赖属性

> ID：11252222
> 
> 赞同：1
> 
> 时间：2012-06-28T20:17:44.330
> 
> 标签：wpf, dependency-properties

我的 WPF 控件有一个奇怪的问题。基本上我有一个控件，它在我的主要内容前面呈现模态内容。我的控制是对[此处](https://stackoverflow.com/a/11234797/577417)显示的答案的修改。

我有一个`Bool`名为的依赖属性`IsShown`，用于隐藏/显示模式内容。属性定义如下：

```
public static readonly DependencyProperty IsShownProperty =
    = DependencyProperty.Register("IsShown",
    typeof(bool), 
    typeof(ModalContentControl), 
    new UIPropertyMetadata(false, IsShownChangedCallback)); 
```

它有一个标准的 .Net 属性包装器，如下所示：

```
public bool IsShown
{
    get { return (bool)GetValue(IsShownProperty); }
    set { SetValue(IsShownProperty, value); }
} 
```

属性更改回调如下所示：

```
private static void IsShownChangedCallback(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    ModalContentControl control = (ModalContentControl)d;

    if ((bool)e.NewValue == true)
    {
        control.ShowModalContent();
    }
    else
    {
        control.HideModalContent();
    }
} 
```

`ShowModalContent`和`HideModalContent`方法分别包含显示和隐藏模态内容的逻辑。

我的窗口中有这个控件，并且该`IsShown`属性绑定到我的 viewModel。我可以按下一个按钮，该按钮调用一个命令，该命令更改绑定到`IsShown`我的控件属性的布尔属性。模态内容按预期显示和隐藏。

我的问题来自`ShowModalContent`and`HideModalContent`方法是公共的，因此可以从代码中调用它们。例如，我想要做的是 call `ShowModalContent`，当我查询`IsShown`属性时，它应该报告正确的值（在这种情况下为真） EG 如果我使用的是常规属性，我将有一个类型的支持`Bool`字段在方法中进行更新。然后该字段将由属性 get 语句返回。

但是因为我的属性是依赖属性，所以我无权访问支持字段。我可以从该方法更新值的唯一方法是通过 .net 包装器设置依赖属性，但这会阻止我的控件工作（一旦显示内容，我就无法再次摆脱它）。

我认为这种行为可能是由于在方法中设置`IsShown`属性引起的，该方法调用了属性更改回调，该回调设置了`IsShown`调用的属性。但我记得在某处读过 WPF 可以防止这种情况。

那么如何解决这个问题，以便我的布尔依赖属性报告正确的值呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:33:16.247

经过一番思考（和一些运气），我设法弄清楚了问题所在。为了让它发挥作用，我需要改变两件事。

第一个问题是`ShowModalContent`and`HideModalContent`方法做了两件事。

1.  设置`IsShown`属性。
2.  更新控件的状态。

这是一个问题，因为更改`IsShown`属性`IsChangedCallback`会调用`ShowModalContent`和`HideModalContent`然后更改`IsShown`属性的方法。我认为`WPF`阻止了无限循环的发生，但即使试图通过缓存值在代码中管理它也是一个令人头疼的问题。

当我意识到公共方法*唯一*应该做的事情就是设置属性时，我的灵感就来了。我的公共方法现在看起来像这样：

```
public void ShowModalContent()
{
    IsShown = true;
}

public void HideModalContent()
{
    IsShown = false;
} 
```

然后这会触发属性更改回调，该回调会更新控件的状态。

我的第二个灵感时刻是当我意识到我的 ViewModel 没有准确地反映`IsShown`属性的状态时，这是由于默认依赖属性绑定模式显然是`OneWay`. 我只是将我的`DependencyProperty`定义绑定模式更新为`BindsTwoWayByDefault`，现在一切正常。

```
IsShownProperty = DependencyProperty.Register("IsShown",
    typeof(bool), typeof(ModalContentControl), 
    new FrameworkPropertyMetadata(false, 
        FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, 
        IsShownChangedCallback)); 
```

# javascript - 在 window.beforeunload 中，如何捕获他们试图导航到的 url？

> ID：11252225
> 
> 赞同：0
> 
> 时间：2012-06-28T20:17:54.267
> 
> 标签：javascript, browser, dom-events, onbeforeunload

我正在尝试捕获一些数据`window.beforeunload`：

```
window.onbeforeunload = function () {
        var newLocation = location.href;
        promise = doAjaxStuff

        promise.done(function () {
            //navigate to new location or close browser
            console.log(newLocation);
        });

    }; 
```

我怎样才能获得链接的网址等...他们希望导航到？包括浏览器返回和下一步。另外，如果他们关闭浏览器，我希望我的调用成功然后关闭浏览器。这可能吗？此函数使用的是，如果您返回一个字符串，它将打开一个确认关闭对话框等...我想要基本上没有对话框的类似行为。任何链接、代码、提示或技巧总是受欢迎的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:20:27.060

出于隐私原因，这永远不可能。

让网站找出用户下一步要去哪里是一个非常糟糕的主意。

# excel - 如何在 Excel 中添加具有相同第一列的列？

> ID：11252227
> 
> 赞同：0
> 
> 时间：2012-06-28T20:18:16.920
> 
> 标签：excel, group-by, reporting, excel-formula

我在 Excel 中有一个类似于以下内容的大型报表。我需要为每个名称添加所有数字并平均所有百分比。

```
Name    Number    Percent
-------------------------
Alan    1         20%
Barb    2         20%
Corey   3         40%
Barb    1         30%
Alan    2         20%
Daniel  3         80%
Alan    1         10% 
```

我在找：

```
Name    Number    Percent
-------------------------
Alan    4         17%
Barb    3         25%
Corey   3         40%
Daniel  3         80% 
```

表一将有原始数据，表二将有摘要。如何在按另一列（“名称”）分组时添加一列（“数字”）？这个函数将如何改变以以同样的方式平均第三列？（不使用 VBA）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T23:21:47.107

如果您真的想要对“大型”数据集进行简单的求和和平均，那么数据透视表是迄今为止最快的解决方案。

但是，查看您的样本结果，我怀疑您确实想要权重在哪里的加权平均值*（*即使某些样本结果看起来很松散，但我猜这是因为您的样本结果代表了更大的数据集） . 这也可以使用数据表中的辅助列快速完成。`Percent``Number`

*   在数据表中添加一个新列，`ExtPercent`计算方式为 Number * Percent
*   创建数据透视表以在源数据中包含新列
*   放置`Name`在行区域
*   使用公式将计算字段添加到名为“加权平均百分比”的 PT`= ExtPercent / Percent`并将其添加到数据区域
*   当然，您也可以将总和添加`Number`到数据区域

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-30T06:16:58.097

您想只执行一次（即一些手动干预）还是定期执行此操作（即 [Array] 公式或 VBA）？

为了识别重复项，我会在例如 D3 中使用 =countif(A$3:A$9,A3) 并将公式复制下来。为排名。如果您只想识别第一个唯一值，您可以使用 =IF(COUNTIF(A3:A$9,A3)>1,”Duplicate”,”Unique”)。我专门从 A3 中删除了 $，所以这个公式向下复制时使用缩小的查找范围。

我会使用 SumIf(range, criteria, sum_range) 来添加分数。所以在这种情况下 =SumIf(A$3:A$9,A3, B$3:B$9)。

如果您想使用公式创建此精简列表，请查看此处。 [http://www.get-digital-help.com/2009/03/30/how-to-extract-a-unique-list-and-the-duplicates-in-excel-from-one-column/](http://www.get-digital-help.com/2009/03/30/how-to-extract-a-unique-list-and-the-duplicates-in-excel-from-one-column/)

# javascript - 在 Firefox 中停止请求，重新启动并再次执行

> ID：11252229
> 
> 赞同：1
> 
> 时间：2012-06-28T20:18:19.547
> 
> 标签：javascript, firefox, firefox-addon

我有一个监听器在导航器发出请求之前阻止特定站点。

```
window.addEventListener('load', registerMyListener, false);
function registerMyListener() {
    window.getBrowser().addTabsProgressListener(myListener);
}
var myListener = {
        onStateChange:function(aBrowser,aProgress,aRequest,aFlag,aStatus) {
                if ( /* check if the request is 'www.example.com' */) {
                        blockSite(aBrowser, aRequest.URI.host, aRequest.URI.spec);
                }
        }
} 
```

这是我的问题：我转到“www.google.com”（允许的 url），页面照常加载。然后我键入“www.example.com”（被阻止的 url），blockSite 函数被执行，使用“window.stop()”停止请求并显示警报。当我重新启动 Firefox 时，它会加载“www.google.com”（请求的最后一个 url），但地址栏中会显示“www.example.com”。

我需要使用什么事件来停止“www.example.com”的请求，而 Firefox 仍在处理该请求，所以当我重新启动时，Firefox 再次请求它（而不是“www.google.com”）？

我认为问题在于当我停止请求时，因为我在 Firefox“知道我要去哪里”之前就这样做了。

# php - 在 PHP 中为动态类成员赋值的语法？

> ID：11252240
> 
> 赞同：2
> 
> 时间：2012-06-28T20:18:52.733
> 
> 标签：php, class, syntax, member

我有一个结构如下的类：

```
class Test {

    private $var1;
    private $var2;
    private $var3;

    public function __construct($params) {

        foreach($params as $key => $value) {

            $this->$key = $value;

        }

    }

} 
```

这个想法是我可以在实例化一个我认为合适的新对象时传递任意数量的参数。所以例如我可以这样做：

```
$params['var2'] = "Variable 2 Instantiated";
$params['var3'] = "Test";
$test = new Test($params); 
```

这只会实例化 $test->var2 和 $test->var3。

到目前为止，我一直在写一个分配列表，但是如果我想实例化一个只有一半可用成员的对象，我必须检查是否设置了值等。

所以实际的问题是：

将值分配给动态类成员的正确语法是什么？

```
$this->$var = $var2 
```

按照我的例子，不工作。我尝试谷歌搜索没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:24:07.793

您的示例已经完美运行。[在 codepad.org 上查看它](http://codepad.org/tMP4PdE3)。

# javascript - 为什么这个疯狂的括号 Javascript 不会导致语法错误？

> ID：11252241
> 
> 赞同：4
> 
> 时间：2012-06-28T20:18:52.653
> 
> 标签：javascript

今天我在玩一些 Javascript 代码片段，并注意到这段代码实际上会运行：

```
{{for(var i = 0; i < 3; i++) {{{{
  alert(i);
}}}}}} 
```

您可以[在 jsFiddle 上亲自尝试一下](http://jsfiddle.net/xbdgH/)。

为什么它运行时没有任何语法错误？重复的括号是什么意思？Javascript 是否只是忽略重复的花括号？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-28T20:20:24.077

它创建了一个新块，这实际上是无用的¹因为 JavaScript 没有块范围²。

[¹这是一个美丽的矛盾。
²然而。]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T20:21:25.223

`{ x++; }`是一个“[块语句](https://developer.mozilla.org/en/JavaScript/Guide/Statements#Block_Statement)”。

`{{{ x++; }}}`是块内的块内的块。

每个块内的代码都被执行。所以在一些事情周围添加额外`{}`的东西并没有做任何事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-28T20:22:06.747

括号中的括号只是描述的代码块。您的样本可以扩展到：

```
{
    {
        for(var i = 0; i < 3; i++)
        {
            {
                {
                    { 
                        alert(i); 
                    }
                }
            }
        }
    }
} 
```

这很愚蠢，但很好

# php - ::base.html.twig 中不存在变量“csrf_token”

> ID：11252246
> 
> 赞同：1
> 
> 时间：2012-06-28T20:19:15.377
> 
> 标签：php, symfony, fosuserbundle

Symfony2 和 FOS 用户包问题...

我已经在页面顶部实现了自己的登录表单（按照[http://forum.symfony-project.org/viewtopic.php?f=31&t=37767](http://forum.symfony-project.org/viewtopic.php?f=31&t=37767)中的说明使用 FOS 用户包。）

现在，我收到错误消息

```
Variable "csrf_token" does not exist in ::base.html.twig 
```

该论坛上的其他人（上面的网址）有完全相同的问题，并通过像这样输入隐藏的 csrf 字段来解决它

```
<input type="hidden" name="_csrf_token" value="{{ csrf_token }}" /> 
```

我的问题是：在 /login 路径上工作正常，但我的重点是不需要那个单独的登录页面，我希望我的表单始终集成在页面头中，而且似乎 {{csrf_token}} 只是当登录控制器呈现页面时可用...

另外，我如何在其中获取错误消息（闪烁），我假设我必须以某种方式将登录控制器包含在我的 defaultController 中，以便每次都使用它来获取所有这些变量，或者......？或者我应该在标题的那部分呈现 userBundle 控制器，而不是将一些 userBundle 模板粘贴到我的脑海中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:48:03.103

如果您使用 Form 组件创建自己的登录表单，那么您应该已经有一个 csrf 令牌作为隐藏字段。该`csrf_token`变量仅在 /login 上可用的原因是因为默认的 FOSUserBundle 登录控制器不使用表单，而是他们只是手动生成一个 csrf 令牌，如此处所示[并将](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Controller/SecurityController.php#L43)其传递给视图。

因此，要么确保您使用类似的东西渲染表单上的所有隐藏字段，要么`{{ form_rest(form) }}`像 FOSUserBundle 在[这里](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Controller/SecurityController.php#L43)所做的那样手动生成 csrf_token 并使用您已有的代码渲染它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:03:05.863

要从您的控制器中生成一个正常工作的 csrf 控制器，请[参阅上一篇文章](https://stackoverflow.com/questions/10903114/symfony-fosuserbundle-include-login-form-in-layout-template)。

此示例使我能够解决您遇到的问题。让这成为扩展 FOS 用户捆绑表单的任何其他人的参考。

# java - 计算对象的“重量”，如何

> ID：11252249
> 
> 赞同：2
> 
> 时间：2012-06-28T20:19:22.457
> 
> 标签：java, memory-management, garbage-collection

> **可能重复：**
> [在 Java 中，确定对象大小的最佳方法是什么？](https://stackoverflow.com/questions/52353/in-java-what-is-the-best-way-to-determine-the-size-of-an-object)

假设您有一个允许您向其中添加数据的数据结构，例如一个列表：

```
List<KeyValuePair> 
```

由于系统的客户端实际上添加了内容......在某些时候，JVM会耗尽内存，这只是何时发生的问题。定期将包含此列表的对象保存到磁盘和`gc`其余部分会很好。

**使用 Java，是否可以估计一个对象现在占用了多少内存？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:26:47.507

该`getObjectSize()`方法可能是您正在寻找的。[来自Interface Instrumentation](http://docs.oracle.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html)文档
的引用：

> **getObjectSize(Object objectToSize)**
> 返回指定对象消耗的存储量的特定于实现的近似值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T20:30:07.493

你正在寻找`java.lang.instrument.Instrumentation.getObjectSize(Object object)`

*文档：*

> 返回指定对象消耗的存储量的特定于实现的近似值。结果可能包括对象的部分或全部开销，因此对于实现内的比较有用，而不是实现之间的比较。估计值可能会在 JVM 的单次调用期间发生变化。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/instrument/Instrumentation.html#getObjectSize%28java.lang.Object%29](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/instrument/Instrumentation.html#getObjectSize%28java.lang.Object%29)

但为了能够使用它：

> 访问 Instrumentation 接口实例的唯一方法是以指示代理类的方式启动 JVM - 请参阅包规范。Instrumentation 实例被传递给代理类的 premain 方法。一旦代理获得了 Instrumentation 实例，代理就可以随时调用实例上的方法。

良好的实现示例： [http ://www.javalobby.org/java/forums/t19309.html](http://www.javalobby.org/java/forums/t19309.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:05:48.253

您可以通过制作许多相同的对象并测量所占用的内存来做到这一点。我现在已经多次使用这种技术，结果稳定、可重复。在大纲中，

```
public static void main(String[] args) {
  final Object[] a = new Object[10000];
  final long startMem = memTaken();
  for (int i = 0; i < a.length; i++) a[i] = new Object();
  System.out.println((memTaken() - startMem) / a.length);
  a.hashCode();
}
static long memTaken() {
  final Runtime rt = getRuntime();
  try {
    rt.gc(); Thread.sleep(50);
    rt.gc(); Thread.sleep(50);
  } catch (InterruptedException e) {}
  final long memTaken = rt.totalMemory() - rt.freeMemory();
  System.out.println("Mem taken " + memTaken);
  return memTaken;
} 
```

这可靠地在我的机器上产生了数字 24。这种方法的优点是它会自动考虑对象的有效堆影响，并考虑所有因素。当然，在信任它之前，您应该检查它在您的设置中是否可靠。

# svn - Statsvn可以按日期过滤统计信息吗

> ID：11252252
> 
> 赞同：0
> 
> 时间：2012-06-28T20:19:41.123
> 
> 标签：svn, statsvn

只是想检查是否有任何配置或参数可以在提供的日期范围内获取统计信息，而不是提供 DAY1 的统计信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T07:20:22.650

由于 StatSVN 在语言环境日志文件上运行，因此完全有可能：

1.  从 Subversion 查看项目的工作副本。

    `svn co svn://server/repo/trunk/modulename`

2.  创建一个 Subversion 日志文件，指定所需的日期范围：

    `svn log -v -r {2012-05-01}:{2012-05-31} --xml > logfile.log`

3.  运行 StatSVN：

    `java -jar /path/to/statsvn.jar /path/to/module/logfile.log /path/to/module`

    此命令在当前目录中创建 HTML 报告。

更多详细信息可从[用户手册](http://wiki.statsvn.org/User%20Manual.ashx)中获得。

# button - Jython 上的 SWT 上没有出现按钮

> ID：11252257
> 
> 赞同：1
> 
> 时间：2012-06-28T20:19:55.313
> 
> 标签：button, swt, jython

我曾尝试在 Jython 的课堂上设置一个按钮。我正在使用 SWT 组件来创建我的 GUI。按钮不出现，但窗口正常出现。我已经在 J​​ava 中创建了这个类，并且运行良好。

这是我的代码，有什么问题？

```
from java.lang import Thread as JThread, InterruptedException
from org.eclipse.swt import widgets, layout, SWT 
from org.eclipse.swt.layout import GridLayout, GridData, FillLayout
from org.eclipse.swt.widgets import Composite, Listener#, Event
from org.yakindu.sct.runtime.java.new64 import New64CycleBasedStatemachine
import time

class Cycle(object):
    def __init__(self):

        self.display = widgets.Display()
        self.shell = widgets.Shell(self.display, SWT.SHELL_TRIM | SWT.APPLICATION_MODAL)
        self.shell.setLayout(layout.RowLayout())
        self.shell.setText("Message Window")
        self.shell.setLocation(300, 300)
        self.shell.setSize(300, 150)
        self.thread = JThread()
        self.shell.open()

    def run(self):
        self.statemachine = New64CycleBasedStatemachine()
        self.statemachine.enter()
        while not self.thread.isInterrupted():
            self.statemachine.getInterfaceNewTest().getVarMessage()
            self.statemachine.runCycle()
            try: 
                time.sleep(100)
            except InterruptedException: 
                self.thread.interrupt()

        self.thread.start()

    def show_window(self):
        while not self.shell.isDisposed():
            if not self.display.readAndDispatch():
                self.display.sleep()
        self.display.dispose()

        self.thread.interrupted()

    def create_button(self, statemachine, shell):
        self.buttonComposite = Composite(shell, SWT.NO_SCROLL)
        self.buttonCompositeGridData =  GridData()
        self.buttonCompositeGridData.horizontalAlignment = GridData.FILL
        self.buttonCompositeGridData.grabExcessHorizontalSpace = True
        self.buttonComposite.setLayoutData(self.buttonCompositeGridData)
        self.buttonCompositeLayout = FillLayout()
        self.buttonCompositeLayout.type = SWT.HORIZONTAL
        fillLayout = FillLayout()

        self.buttonComposite.setLayout(fillLayout)
        self.button = widgets.Button(self.buttonComposite, SWT.PUSH);
        self.button.setText("Ok")

foo = Cycle()
foo.run()
foo.create_button()
foo.show_window() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:59:44.357

有多个问题：

1.  的位置`self.shell.open()`。您在**打开**外壳`create_button()`后调用！请参阅 .java 文档。**`shell.open()`**
***   您正在使用`RowLayout`，然后创建 a `GridData`，然后设置 a `FillLayout`。我不会告诉你问题所在。运行代码看看。**

 ****片段中的工作示例**

```
from java.lang import Thread as JThread, InterruptedException
from org.eclipse.swt import widgets, layout, SWT 
from org.eclipse.swt.layout import GridLayout, GridData, FillLayout
from org.eclipse.swt.widgets import Composite, Listener#, Event

import time

class Cycle(object):
    def __init__(self):

        self.display = widgets.Display()
        self.shell = widgets.Shell(self.display, SWT.SHELL_TRIM | SWT.APPLICATION_MODAL)
        self.shell.setLayout(layout.RowLayout())
        self.shell.setText("Message Window")
        self.shell.setLocation(300, 300)
        self.shell.setSize(300, 150)

    def show_window(self):
        self.shell.open() // I have moved it here. After all the control creation !!
        while not self.shell.isDisposed():
            if not self.display.readAndDispatch():
                self.display.sleep()
        self.display.dispose()

    def create_button(self):
        self.buttonComposite = Composite(self.shell, SWT.NO_SCROLL)
        #self.buttonCompositeGridData =  GridData()
        #self.buttonCompositeGridData.horizontalAlignment = GridData.FILL
        #self.buttonCompositeGridData.grabExcessHorizontalSpace = True
        #self.buttonComposite.setLayoutData(self.buttonCompositeGridData)
        self.buttonCompositeLayout = FillLayout()
        self.buttonCompositeLayout.type = SWT.HORIZONTAL
        fillLayout = FillLayout()

        self.buttonComposite.setLayout(fillLayout)
        self.button = widgets.Button(self.buttonComposite, SWT.PUSH);
        self.button.setText("Ok")

foo = Cycle()
foo.create_button()
foo.show_window() 
```

***`Output-`***

![在此处输入图像描述](../Images/fb78ea5005f46c19c6387765f5222bac.png)**

# c# - 如果它不包含字符串，则匹配正则表达式

> ID：11252260
> 
> 赞同：-5
> 
> 时间：2012-06-28T20:20:08.573
> 
> 标签：c#, .net, regex

有很多地方会告诉您匹配不包含单词的字符串。我想要做的是使用正则表达式来匹配一个字符串，然后测试该字符串是否包含一个单词。

换句话说，这就是我要找的：

我有文字：

.........（注意每个块都以 <"number"><"hex number"> 开头）

```
<1><35c>: Abbrev Number: 7 (DW_TAG_array_type)
    <35d>   DW_AT_sibling     : <0x369> 
    <361>   DW_AT_type        : DW_FORM_ref4 <0x4d01>   
<2><366>: Abbrev Number: 8 (DW_TAG_subrange_type)
    <367>   DW_AT_upper_bound : 127 
<1><369>: Abbrev Number: 7 (DW_TAG_array_type)
    <36a>   DW_AT_sibling     : <0x377> 
    <36e>   DW_AT_type        : DW_FORM_ref4 <0x4d01>   
<2><373>: Abbrev Number: 8 (DW_TAG_subrange_type)
    <374>   DW_AT_upper_bound : 511 
<1><377>: Abbrev Number: 9 (DW_TAG_structure_type)
    <378>   DW_AT_sibling     : <0x4cb> 
    <37c>   DW_AT_name        : mem_pool    
    <385>   DW_AT_byte_size   : 68  
<2><386>: Abbrev Number: 10 (DW_TAG_member)
    <387>   DW_AT_type        : DW_FORM_ref4 <0x4d28>   
    <38c>   DW_AT_accessibility: 1  (public)
    <38d>   DW_AT_name        : Type    
    <392>   DW_AT_data_member_location: 2 byte block: 23 0  (DW_OP_plus_uconst: 0)
<1><357>: Abbrev Number: 9 (DW_TAG_structure_type)
    <37c>   DW_AT_name        : mem_pool2   
    <385>   DW_AT_byte_size   : 28  
<1><35c>: Abbrev Number: 7 (DW_TAG_array_type)
    <378>   DW_AT_sibling     : <0x4cb> 
    <37c>   DW_AT_name        : mem_pool    
    <385>   DW_AT_byte_size   : 68 
```

然后得到`DW_TAG_structure_type`我使用正则表达式的块：

```
(?s)\n[^\n]+?DW_TAG_structure_type.*?(?=..\d+><) 
```

匹配：

1)

```
 <1><377>: Abbrev Number: 9 (DW_TAG_structure_type)
    <378>   DW_AT_sibling     : <0x4cb> 
    <37c>   DW_AT_name        : mem_pool    
    <385>   DW_AT_byte_size   : 68 
```

和

2)

```
<1><357>: Abbrev Number: 9 (DW_TAG_structure_type)
    <37c>   DW_AT_name        : mem_pool2   
    <385>   DW_AT_byte_size   : 28 
```

**现在我的问题是**，如果它包含字符串，我想排除第一个匹配项`sibling`。所以我为解决这个问题所做的是：

```
 (?s)(?!.*sibling)\n[^\n]+?DW_TAG_structure_type.*?(?=..\d+><) 
```

注意我添加`(?!.*sibling)`到首先环顾四周以测试兄弟姐妹一词不存在。但这不匹配任何东西。

## 编辑

如果我的第一个正则表达式会很好：

```
 (?s)\n[^\n]+?DW_TAG_structure_type.*?(?=..\d+><) 
```

我可以在一个组中捕获它，然后测试我需要什么。做类似的事情

```
 (?s)(\n[^\n]+?DW_TAG_structure_type.*?(?=..\d+><))(?=\1 "if group1 cointains sibling then..." 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-28T20:31:47.863

试试这个：`(?s)\n[^\n]+?DW_TAG_structure_type.*?\n(?![^\n]*sibling).*?(?=..\d+><)`

# iphone - 在容器视图中延迟加载视图控制器

> ID：11252264
> 
> 赞同：0
> 
> 时间：2012-06-28T20:20:24.420
> 
> 标签：iphone

像这样延迟加载多个视图控制器

```
-(void)playpauseAction:(id)sender {
if([audioPlayer isPlaying])
{
[sender setImage:[UIImage imageNamed:@"Play Icon.png"] forState:UIControlStateSelected];
[audioPlayer pause];
[self pauseTimer];
[self pauseLayer:self.view.layer];
}else{
[sender setImage:[UIImage imageNamed:@"pause.png"] forState:UIControlStateNormal];
[audioPlayer play];
[self resumeTimer];
[self resumeLayer:self.view.layer];  
if(isFirstTime == YES)
  {
 self.timer = [NSTimer scheduledTimerWithTimeInterval:11.0
                                     target:self
                                     selector:@selector(displayviewsAction:)
                                     userInfo:nil
                                     repeats:NO];
        isFirstTime  = NO;
    }}}

- (void)displayviewsAction:(id)sender
  {  
   First *firstController = [[First alloc] init];
   firstController.view.frame = CGRectMake(0, 0, 320, 480);
   CATransition *transitionAnimation = [CATransition animation];   
    [transitionAnimation setDuration:1];
    [transitionAnimation setType:kCATransitionFade];    
    [transitionAnimation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];    
    [self.view.layer addAnimation:transitionAnimation forKey:kCATransitionFade];
    [self.view addSubview:firstController.view];
    [self.view addSubview:toolbar];
    [firstController release];   
    self.timer = [NSTimer scheduledTimerWithTimeInterval:23 target:self selector:@selector(Second) userInfo:nil repeats:NO];     
    }

   -(void)Second 
   {
Second *secondController = [[Second alloc] init];
secondController.view.frame = CGRectMake(0, 0, 320, 480);
CATransition *transitionAnimation = [CATransition animation];
[transitionAnimation setDuration:1];
[transitionAnimation setType:kCATransitionReveal];
[transitionAnimation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseIn]];
[self.view.layer addAnimation:transitionAnimation forKey:kCATransitionReveal];
[self.view addSubview:secondController.view]; 
[self.view addSubview:toolbar];
[secondController release];
self.timer = [NSTimer scheduledTimerWithTimeInterval:27 target:self selector:@selector(Third) userInfo:nil repeats:NO];
 } 
```

要求是添加一个容器视图并在容器视图中加载所有视图控制器。

所以，在加载视图中可以像这样创建uiview和容器视图

```
 - (void)loadView
    {
// set up the base view
CGRect frame = [[UIScreen mainScreen] applicationFrame];
UIView *view = [[UIView alloc] initWithFrame:frame];
view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
view.backgroundColor = [UIColor blueColor];

// set up content view a bit inset
frame = CGRectInset(view.bounds, 0, 100);
_containerView = [[UIView alloc] initWithFrame:frame];
_containerView.backgroundColor = [UIColor redColor];
_containerView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
[view addSubview:_containerView];} 
```

在 AppDelegate 中可以这样做

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
  {
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

ContainerViewController *container = [[ContainerViewController alloc] init];    
self.window.rootViewController = container;

// make an array of 23 PageVCs
NSMutableArray *controllers = [NSMutableArray array];
   [controllers addObject:firstcontroller];
   [controllers addObject:secondcontroller];
   [controllers addObject:.....];
    [controllers addObject:twentythreecontroller];

for (int i=0; i<23; i++)
{
    First *firstController = [[First alloc] init];

[controllers addObject:firstcontroller, secondcontroller, .....,twentythreecontroller];
}

// set these as sub VCs
[container setSubViewControllers:controllers];

    [self.window makeKeyAndVisible];
    return YES;} 
```

像这样在容器视图中加载所有视图控制器是可以的，或者在这里做错事。

感谢您对此的帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:24:53.280

首先删除**nstimer**并使用**performSelector:withObject:afterDelay:**方法，如下所示：

```
 // add delay and method according to your requirement
[self performSelector:@selector(oneView) withObject:nil afterDelay:10];

-(void)oneView
{
    //add firstView and perform second selector
   [self performSelector:@selector(secondView) withObject:nil afterDelay:10];
}

-(void)secondView
{
    //add secondView and perform thirdselector
   [self performSelector:@selector(thirdView) withObject:nil afterDelay:10];
}

goes on ....................... 
```

# java - 具有评分策略的类的 Java 评分程序

> ID：11252268
> 
> 赞同：-4
> 
> 时间：2012-06-28T20:20:34.747
> 
> 标签：java, methods

我必须为具有以下评分政策的课程编写评分程序。

> 1.有2个小测验，每个小测验以10分计分。
> 
> 2.期中考试1次，期末考试1次，每期以100分计分。
> 
> 3.期末考试占成绩的50%，期中考试占25%，2个小测验加起来占25%。（不要忘记标准化测验分数。）

将根据以下标准给出字母等级： 90 – 100 A
80 – 89 B 70 – 79 C 60 – 69 D 0 – 59 E

该程序将从文本文件中读取学生的成绩，并输出学生的记录，其中包括姓名、2 次测验和 2 次考试成绩以及学生在整个课程中的平均数字分数和最终字母成绩。我想为学生记录定义和使用一个班级。所有分数均为整数，学生姓名不超过 10 个字符。我必须证明你的输出文件。

原来是导师给的 我就是不知道在哪里给星

```
import java.until.*;
import java.io.*;

public class Assign7{
   public static void main(String[] args)throws Exception{
    Record.setGP(1.25, 1.25, 0.25, 0.50);

 Scanner myIn = new Scanner( new File("scores.txt") );

 public static void main getLetterGrade  
   if (finalScore > 90)  
       letter = 'A'; 
  else if (finalScore > 80) 
     letter = 'B';
  else if (finalScore > 70)  
     letter = 'C';
  else if (finalScore > 60)
     letter = 'D';
  else  
     letter = 'F';

    System.out.println( myIn.nextLine() +"  avg  "+"letter");

    while( myIn.hasNext() ){
       Record myR = new Record(myIn.next(), myIn.nextInt(), myIn.nextInt(), myIn.nextInt(),
myIn.nextInt());

       System.out.println( myR );

    } 
  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T20:41:29.063

让我们走到这一步：

```
// Why not "class" (lower case)?
// Should "class Assign7" be "public" (is it the main class in the module)?
// Did you put any "import" statements above this?
Class Assign7{

   // Do you want to declare any member data before you start your "main()" function?
   public static void main(String[] args)throws Exception{

   // Is "Record.setGP()" a "static method"?
   Record.setGP(1.25, 1.25, 0.25, 0.50);

  // Isn't this class-wide data?  If so, shouldn't you put it *above* "main()"?    
  int quiz1, quiz2;
  int tMidterm, tFinal,tQuiz
  int midterm = 0;
  int finalExam = 0;
  String name;
  char grade;

  // Do you really want to just bomb out of the program if this fails?
  Scanner myIn = new Scanner( new File("scores.txt") );

   // Whoa!!!!  Why are we starting a new function, *inside of "main()"*?!?!
   void getScore()  
   {  
   tQuiz = ((quiz1 + quiz2)/20)*.25;  
   tMidTerm = (midTermExam/100)*.25;  
   tFinal = (finalExam/100)*.50;  
   finalScore = tQuiz + tMidTerm + tFinal;  
   }

   // It looks like we're starting a new function here, too.
   // Where's your parenthesis and curly brace after "getLetterGrade"????  
   void getLetterGrade  

   if (finalScore >= 90)  
   {  
   grade = 'A';  
   }  

   // Supposing the grade was "99"?  
   // Would the student get a "B" here?  Or even a "D" below???
   if (finalScore >= 80)  
   {  
   grade = 'B';  
   }
   ... 
```

建议：

1.  编写最小的、最小的程序，只是“编译”。

2.  一次添加一件事。验证更改是否有效。

3.  采取“小步骤”来获得完整的解决方案。

4.  根据需要发回有关特定问题的特定问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-28T20:49:32.753

您的代码有很多问题，而且似乎根本不理解 Java 语法。不要试图在 main 的内部定义方法。它们应该在 main 之外定义。

我真的不知道从哪里开始，所以我会建议你需要彻底改变的一件事：

```
if (finalScore >= 90)  
{  
grade = 'A';  
}  
if (finalScore >= 80)  
{  
grade = 'B';  
}
# etc... 
```

说`finalScore`是`100`。然后第一个条件`if`将评估为`true`并将`grade`被分配`'A'`。然后下`if`一条语句： 100 大于 80 所以这也计算为`true`。你看到问题了吗？ `grade`将被重新分配给`'B'`。

请阅读文档以了解此处`else if`的`else`说明如何帮助您：http: [//docs.oracle.com/javase/tutorial/java/nutsandbolts/if.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/if.html) （示例是如何实际分配成绩，您的确切问题是工作中！）

# python-2.7 - 我什么时候把变量放在 .open() 的括号中，什么时候把它放在 .open() 的前面

> ID：11252269
> 
> 赞同：1
> 
> 时间：2012-06-28T20:20:37.427
> 
> 标签：python-2.7

```
1 from sys import argv
2 from os.path import exists
3
4 script, from_file, to_file = argv
5
6 print "Copying from %s to %s" % (from_file, to_file)
7
8 # we could do these two on one line too, how?
9 input = open(from_file)
10 indata = input.read()
11
12 print "The input file is %d bytes long" % len(indata)
13
14 print "Does the output file exist? %r" % exists(to_file)
15 print "Ready, hit RETURN to continue, CTRL-C to abort."
16 raw_input()
17
18 output = open(to_file, 'w')
19 output.write(indata)
20
21 print "Alright, all done."
22
23 output.close()
24 input.close() 
```

我不确定第 19 行之间的规则差异是什么，其中在句点之前和括号内有一个变量。我是初学者，想澄清这一点，因为我试图编写一些代码并且对这一点感到困惑......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:23:20.787

这意味着您正在调用对象的方法。让我们看一下第 18 行：

```
output = open(to_file, 'w') 
```

这将返回一个文件对象并将其分配给变量`output`。您现在可以调用文件对象的方法（例如`output.read()`读取文件的内容）。同样，您可以使用`output.write(...)`将数据写入文件：

```
output.write(indata) 
```

上面一行的意思是：将内容写入`indata`文件对象`output`。您是正确的，此操作涉及两个变量。

# jquery - Fancybox 移除添加的样式

> ID：11252273
> 
> 赞同：1
> 
> 时间：2012-06-28T20:20:56.340
> 
> 标签：jquery, styles, fancybox

我在一个网站上使用 Fancybox 2 并注意到当我检查元素时，一些 div 有一个“样式”属性，其中有一些 CSS。

所有这些我都可以在我的 styles.css 中完成，所以我想知道如何删除这些添加的“样式”属性，或者至少删除诸如填充和顶部/左侧定位之类的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T02:28:18.673

我更新说，在尝试了一切之后，似乎根本没有办法删除 Fancybox 添加的内联样式。我接受这是正确的答案，即使它真的不是一个很好的答案。如果有人确实找到了解决方案，我很想听听。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-31T17:26:35.930

我通过添加以下代码来做到这一点： $("#div_for_overlay").css({'width': '800px', 'height': '400px'});

并在 fancibox.js 文件中设置 padding:0 而不是 padding:15px

这删除了 ​​fancybox-overlay 的内联样式

要为 fancybox-inner 和 fancybox-outer div 删除相同的内容，只需执行相同操作即可。看看您是否可以使用一些 jquery 代码进行编辑，例如 $(".fancybox_outer").css({'width': '800px', 'height': '400px'});

如果没有，请在 fancybox.js 文件中找到它的设置位置并进行内联编辑。那应该行得通。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:27:54.323

您可以使用 Jquery [.CSS()](http://api.jquery.com/CSS/)将填充设置为 0，或使用[.removeAttr()](http://api.jquery.com/removeAttr/)删除所有样式，您可以向其中添加自己的类。

# visual-studio-2010 - 是否可以在 vs2010 中引用另一个观察表达式的值？

> ID：11252277
> 
> 赞同：0
> 
> 时间：2012-06-28T20:21:01.793
> 
> 标签：visual-studio-2010

当我遇到断点时，我的监视窗口中有“this”

```
this -> 0x2cceb42c 
```

我将该值复制到我的监视窗口中的新行中（它以十六进制显示名称和值）

```
0x2cceb42c -> 0x2cceb42c 
```

在第三行，我将我的值转换为指向我的类的指针：

```
(MyClass*)0x2cceb42c -> { members of class... } 
```

问题是，下次我运行程序时地址已经改变，所以我必须在第三行编辑地址。只是，我不仅在第三行使用它，还在其他 5 个手表表达式中使用它。这意味着下次我运行程序时，我必须更改所有 5 个观察表达式中的地址。

我想做的是让我的 5 个手表表达式引用第 2 行中的值 - 然后我只需要在一个地方更改地址，我所有的手表都会自动更新。

这可能吗？或者任何人都可以提出一个尽可能接近这一目标的技巧吗？

* * *

澄清：当我在代码中其他地方的断点处时，我想查看我的 5 个监视表达式的结果（其中“this”不再是我感兴趣的值，这就是我将地址复制出来的原因这个的”）。

# mysql - 存储在另一列中的几个 MySQL 列的总和？

> ID：11252289
> 
> 赞同：3
> 
> 时间：2012-06-28T20:22:12.930
> 
> 标签：mysql

我在 MySQL 数据库中有几列我想添加并存储在另一列中：

```
column1     column2     column3    subtotal
10          10          10         30 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:23:39.757

```
update yourtable set subtotal = col1 + col2 + col3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:38:32.747

如果您只是更新小计，则必须*保持*其值 - 即每次更新其他列之一时，您的代码也必须记住更新小计。

有两种方法可以解决这个问题：

1.  创建一个在行更新时触发的触发器。此选项需要数据库“功夫”，并且对于查看触发器存在的表的其他人来说并不是立即显而易见的
2.  创建一个`VIEW`进行计算的

我认为选项 2 是最好的方法。

下面介绍如何编写视图。

```
create view mytable_totalled as
select col1, col2, col3,  col1 + col2 + col3 as subtotal
from mytable 
```

创建后，视图可以像表格一样使用（有一些注意事项），但您当然可以对其进行任何类型的选择。新列在选中时即时计算

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:28:18.847

好吧，如果这只是一次性交易，您可以像这样执行更新查询：

```
UPDATE MyTable set subtotal = (column1 + column2 + column3) 
```

如果您希望在插入时计算它，您可以有一个计算列。

我个人会等到你需要它来计算它，这样可以很容易地从你的数据中得出的信息不会让你的数据库膨胀。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:40:14.943

这个怎么样？

```
UPDATE tableName SET subtotal = (column1 + column2 + column3) 
```

## 更新 1

如果您真的不需要表中的小计列，只需使用查询作为

```
SELECT *, (column1 + column2 + column3) as subtotal
FROM tableName 
```

## [演示](http://sqlfiddle.com/#!2/203e2/2)

# python - 如何从2个值形成一个字符串

> ID：11252292
> 
> 赞同：1
> 
> 时间：2012-06-28T20:22:29.847
> 
> 标签：python, string, variables, floating-point

好的，我需要创建一个定义为 rootString 的字符串，如下所示：

```
F:0.0 
```

字母 F 源自先前的字符串，通过以下方式获得：

```
root = str(newickString[-1]) 
```

并且 float 0.0 可以是这样的：

```
rootD = 0.0 
```

我的问题是，如何将变量名和浮点值与冒号结合起来？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:28:08.820

```
>>> string = 'WWF'
>>> num = 0.0
>>> print ("{0}:{1}".format(string[-1],num))
F:0.0 
```

在较旧版本的 Python (<2.6) 上，您需要执行以下操作：

```
"%s:%s" % (string[-1], num) 
```

代替

```
"{0}:{1}".format(string[-1],num) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:26:44.307

您可以只使用`+`符号并将它们连接在一起：

```
>>> old_string = 'oldF'
>>> float_val = 0.0
>>> rootString = old_string[-1] + ':' + str(float_val)
>>> print rootString
F:0.0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:29:07.427

Python 中的字符串插值非常简单。对于大多数版本的 Python，您可以编写：

```
template = "%s:%f"
root = "F"
rootD = 0.0
result = template % (root, rootD)
# and result is "F:0.0" 
```

看看[http://docs.python.org/library/stdtypes.html#string-formatting](http://docs.python.org/library/stdtypes.html#string-formatting)

（请注意，如果您使用的是足够新的 Python 版本，您可能更喜欢`.format`在字符串上使用更新的方法——请参阅[http://docs.python.org/library/string.html#new-string-formatting](http://docs.python.org/library/string.html#new-string-formatting)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:25:26.510

这是一种组合两个值并将它们打印出来的方法。

```
string_value = 'BOF'
float_value = 0.0
print "%s:%s" % (string_value[-1], float_value)
>>F:0.0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T20:26:48.987

试试这个：

```
'%s:%0.1f' % (root, rootD) 
```

[在此处阅读有关字符串格式的更多信息。](http://docs.python.org/library/stdtypes.html#string-formatting)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-28T20:41:50.200

如果您想要一个变量将其存储为字符串（或建议的其他几种方法）：

```
rootString = "%s:%s" % (root,rootD) 
```

如果您打算稍后使用/更改该值，最好设置一个像此示例代码中的类（另外，您仍然可以轻松打印字符串）：

```
class rootString:
    def __init__(self,root,rootD):
    self.root = root
    self.rootD = rootD

    def getRoot(self):
    return self.root

    def getRootD(self):
    return self.rootD

    def setRoot(self, root):
        self.root = root

    def setRootD(self, rootD):
        self.rootD = rootD

    def __str__(self):
    return "%s:%s" % (self.root,self.rootD)

if __name__=='__main__': 
    myRootStr = rootString("F",0.0)
    print myRootStr #gives string output you want                                                                                                                                                                                                                             
    print myRootStr.getRootD() #but you can still get the float easily                                                                                                                                                                                                        
    myRootStr.setRootD(3.14) #or change it if you need to                                                                                                                                                                                                                     
    print myRootStr 
```

# pyqt - PyQt QComboBox 设置下拉列表中可见项目的数量

> ID：11252299
> 
> 赞同：8
> 
> 时间：2012-06-28T20:23:05.293
> 
> 标签：pyqt, pyqt4, qcombobox

我正在研究 PyQt 中的一个应用程序，它采用对象字典并允许您实时绘制来自机器人的变量流。我正在努力启用此功能的其中一件事是下拉菜单。不幸的是，我们有几百个变量，所以我的 PyQt Combobox 会在单击时从屏幕顶部弹出到底部，其中包含项目。我想将一次显示的项目数限制为 20 个，并且可以滚动查看其余项目。我试过使用记录在案的 setMaxVisibleItems 方法，但它根本不影响下拉菜单。有什么建议吗？

代码在这里：

```
#!/usr/bin/env python

from PyQt4.QtCore import Qt
from PyQt4.QtGui import QComboBox, QApplication

from cli.parc2_od import cli_od
import sys

app = QApplication(sys.argv)

items = cli_od.OD.keys() #Items to populate dropdown.
combo = QComboBox()

#The solution:
combo.setStyleSheet("QComboBox { combobox-popup: 0; }")
combo.setMaxVisibleItems(10)

combo.addItems(items)

combo.resize(300, 30)
combo.show()

sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T23:53:02.997

根据文档：

> [对于为`QStyle::SH_ComboBox_Popup](http://qt-project.org/doc/qt-4.8/qstyle.html#StyleHint-enum)（例如 Mac 样式或 Gtk+ 样式）`maxVisibleItems`返回 true 的样式中的不可编辑组合框，该属性将被忽略。

您可以使用样式表覆盖该`SH_ComboBox_Popup`样式提示：

```
combo.setStyleSheet("QComboBox { combobox-popup: 0; }"); 
```

# hadoop - 无法让 HBase 连接到 Hadoop

> ID：11252304
> 
> 赞同：4
> 
> 时间：2012-06-28T20:23:37.160
> 
> 标签：hadoop, hbase

编辑：我能够让它工作。我创建了一个教程来展示如何： [http ://www.dreamsyssoft.com/blog/blog.php?/archives/5-How-to-use-HBase-Hadoop-Clustered.html](http://www.dreamsyssoft.com/blog/blog.php?/archives/5-How-to-use-HBase-Hadoop-Clustered.html)

当我设置 hbase-site.xml 属性时，我可以让 HBase 正常工作：

```
<name>hbase.rootdir</name>
<value>file:///app/hbase/hbase/</value> 
```

这工作得很好，它按预期将数据存储在目录中，但是我希望它现在连接到我正在运行的 hadoop 实例，而不是使用本地文件。我把它设置为

```
<value>hdfs://localhost:9000/</value> 
```

而不是本地文件，它将不起作用。我需要在 hadoop 端做一些额外的配置来支持这个吗？Hadoop 正在运行并使用端口 9000。

这是我来自 hadoop 的 core-site.xml：

```
<configuration>
        <property>
                <name>fs.default.name</name>
                <value>hdfs://localhost:9000</value>
        </property>
</configuration> 
```

这也是尝试在 hbase shell 中执行“列表”时出现的错误：

```
hbase(main):001:0> list
TABLE
12/06/28 15:26:29 ERROR zookeeper.RecoverableZooKeeper: ZooKeeper exists failed after 3 retries
12/06/28 15:26:29 WARN zookeeper.ZKUtil: hconnection Unable to set watcher on znode /hbase/master
org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /hbase/master
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
        at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
        at org.apache.zookeeper.ZooKeeper.exists(ZooKeeper.java:1021)
        at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.exists(RecoverableZooKeeper.java:154)
        at org.apache.hadoop.hbase.zookeeper.ZKUtil.watchAndCheckExists(ZKUtil.java:226)
        at org.apache.hadoop.hbase.zookeeper.ZooKeeperNodeTracker.start(ZooKeeperNodeTracker.java:76)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.setupZookeeperTrackers(HConnectionManager.java:580)
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.<init>(HConnectionManager.java:569)
        at org.apache.hadoop.hbase.client.HConnectionManager.getConnection(HConnectionManager.java:186)
        at org.apache.hadoop.hbase.client.HBaseAdmin.<init>(HBaseAdmin.java:98)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at org.jruby.javasupport.JavaConstructor.newInstanceDirect(JavaConstructor.java:275)
        at org.jruby.java.invokers.ConstructorInvoker.call(ConstructorInvoker.java:91)
        at org.jruby.java.invokers.ConstructorInvoker.call(ConstructorInvoker.java:178) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:31:04.113

我使用了[http://hbase.apache.org/book.html#zookeeper](http://hbase.apache.org/book.html#zookeeper)中建议的配置 stop Ipatables 并以 root 模式启动 hbase。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-24T12:56:00.047

可能存在兼容性问题，请检查[http://rajkrrsingh.blogspot.in/2013/11/hbase-compatibility-with-hadoop-2x.html](http://rajkrrsingh.blogspot.in/2013/11/hbase-compatibility-with-hadoop-2x.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T03:00:34.320

我相信 Hbase 找不到 zookeeper quorum，你必须在 hbase-site.xml 中设置 hbase.zookeeper.quorum 属性。还要检查类路径是否设置正确，请查看此文档

[http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/mapreduce/package-summary.html#classpath](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/mapreduce/package-summary.html#classpath)

# javascript - 隐藏添加此共享工具默认图标

> ID：11252313
> 
> 赞同：1
> 
> 时间：2012-06-28T20:23:59.463
> 
> 标签：javascript, css, addthis

有谁知道我如何隐藏添加此（addthis.com）共享小部件默认使用的默认图标来替换我自己的图标？

我正在使用的代码如下，添加这个小部件会带来图标，但我想使用我的 main_icons.gif。提前致谢。

```
<style type="text/css">
.share strong { line-height:17px; }
.share strong, .share a { float:left; display:inline; font-weight:normal; }
.share a { width:17px; height:17px; background:transparent url(main_icons.gif) no-repeat 0px -1772px; margin-left:7px; text-indent:-9999px; }
.share a.btn_twitter { background-position:-24px -1772px; }
.share a.btn_share { background-position:-47px -1772px; }
</style>

<div class="share addthis_toolbox addthis_default_style">
<strong>Share this:</strong>
<a class="addthis_button_facebook" href="">Share with Facebook</a>
<a class="btn_twitter addthis_button_twitter" href="">Share with Twitter</a>
    <a class="btn_share addthis_button_compact" href="">Share</a>
</div>

<script type="text/javascript">
var addthis_config = {
    "data_track_addressbar":true,
    "services_exclude":'facebook,twitter',
}
</script>
<script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid=myusername"></script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:43:27.200

好的，我在这里找到了答案：http: [//support.addthis.com/customer/portal/articles/381236-custom-buttons#.T-zBZ_VRL90](http://support.addthis.com/customer/portal/articles/381236-custom-buttons#.T-zBZ_VRL90)

您只是一个图像标签，其中包含您的自定义图像的 src 在您的标签中......例如

```
<a class="addthis_button" href="http://www.addthis.com/bookmark.php"><img src="customButton.gif" width="16" height="16" border="0" alt="Share" /></a> 
```

# regex - 如何使用 Perl 有选择地修改 HTML 文档中脚本标签的 src 属性？

> ID：11252314
> 
> 赞同：2
> 
> 时间：2012-06-28T20:24:00.937
> 
> 标签：regex, perl, html-parsing, html-parser

我需要在 Perl 中编写一个正则表达式，它将在所有 src 前面加上 [perl]texthere[/perl]，如下所示：

```
 <script src="[perl]texthere[/perl]/text"></script> 
```

有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:40:14.573

使用适当的解析器，例如[HTML::TokeParser::Simple](http://search.cpan.org/perldoc/HTML%3a%3aTokeParser%3a%3aSimple)：

```
#!/usr/bin/env perl

use strict; use warnings;
use HTML::TokeParser::Simple;

my $parser = HTML::TokeParser::Simple->new(handle => \*DATA);

while (my $token = $parser->get_token('script')) {
    if ($token->is_tag('script')
            and defined(my $src = $token->get_attr('src'))) {
            $src =~ m{^https?://}
                or  $token->set_attr('src', "[perl]texthere[/perl]$src");
    }
    print $token->as_is;
}

__DATA__
<script src="/js/text.text.js/"></script>

And at the same time, ignore scrs that begin with http, as such:

 <script src="https://websitewebsitewebsite"></script> 
```

输出：

```
<script src="[perl]texthere[/perl]/js/text.text.js/"></script>

同时，忽略以 http 开头的 scrs，如下所示：

 <script src="https://websitewebsitewebsite"></script>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:33:10.903

使用负前瞻模式（在下面的第三行）：

```
s{
  (<script\s+src\s*=\s*[\'"])
  (?!https?://)
}{$1\[perl]texthere[/perl]}gsx; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:44:17.130

这应该有效：

```
 s{(?<=src=)(?!"https?)}{[perl]texthere[/perl]} 
```

测试：

```
 my @olnk = ('<script src=/js/text.text.js/"></script>',
             '<script src="https://websitewebsitewebsite"></script>' );
 my @nlnk = map {
                  s{(?<=src=)(?!"https?)}{[perl]texthere[/perl]}; $_
                } @olnk; 
```

结果：

```
 print join "\n", @nlnk;

 <script src=[perl]texthere[/perl]/js/text.text.js/"></script>
 <script src="https://websitewebsitewebsite"></script> 
```

问候

rbo

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:33:23.790

我可以匹配任何 src=" 除了 http via：`^<script src="(?!(https:)).*$` 如果有任何问题，请告诉我，我会修复它。

尝试使用：[this website](http://www.regular-expressions.info/lookaround.html) as a regex tutorial和[this website](http://regexpal.com) to test regex。

# c# - C#句柄中的try-catch块可以输入多个catch块吗？

> ID：11252315
> 
> 赞同：-3
> 
> 时间：2012-06-28T20:24:02.940
> 
> 标签：c#, exception, try-catch

我有一些这样的代码：

```
try 
{
    doStuff();
}
catch(SpecificException) 
{
    if(e.Message == interestingMessage)
        doOtherStuff();
    else
        throw;
}
catch(Exception e)
{
    doSomethingElse();
} 
```

当第一个 catch 块重新抛出它的异常时，它会被第二个 catch 块捕获吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T20:25:51.157

不，如果您将异常重新抛出给方法调用者。

if inside `SpecificException`catch 表示您需要将该异常拆分为（至少）两种不同的类型。

# c# - 如何将多个列表与 Lambda 表达式相交？

> ID：11252320
> 
> 赞同：3
> 
> 时间：2012-06-28T20:24:15.623
> 
> 标签：c#, lambda, intersect

我有几个清单。他们的人数不清楚。

例如（对于 4 个列表）：

```
List1   List2    List3     List4 
-----   -----    -----     -----
  1       2        3         4
  2       4        8         3   
  3       8        4         5   
  4       11       6         1    
  5       3        7         7    
  6       9        11        9 
```

我想找到常见的项目。它可以在 MSSQL 中使用 T-SQL。

结果将是这样的：

```
ResultList : (3, 4) 
```

Lambda 表达式是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T20:28:36.010

您可以使用[Enumerable.Intersect](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)

```
var commonItems = list1.Intersect(list2).Intersect(list3).Intersect(list4); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:41:45.710

对于任意数量的列表，您可以执行以下操作：

```
var List<List<int>> lists; //This contains the lists I assume...
var result = lists.Skip(1).Aggregate(lists.First(), (accum, cur) => accum.Intersect(cur)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:28:51.877

```
list1.Intersect(list2).Intersect(list3).Intersect(list4); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:28:39.987

你在找[`Intersect`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T20:29:01.623

您可以使用[Enumerable.Intersect](http://msdn.microsoft.com/en-us/library/bb460136.aspx)并将 List1 与 List1 相交，并将其结果与 List3 相交，依此类推。

```
 List1.Intersect(List2).Intersect(List3).Intersect(List4) 
```

# sql - 从内部复杂的 SELECT 更新

> ID：11252330
> 
> 赞同：-1
> 
> 时间：2012-06-28T20:25:14.610
> 
> 标签：sql, sql-server, tsql

```
UPDATE DB4010.dbo.EntityStagedData
SET
EntityData = (
    SELECT 
        geo.City + ' ' + geo.Description + ' ' + geo.Street + ' ' +
        geo2.City + ' ' + geo2.Description + ' ' + geo2.Street
    FROM DB4010.dbo.RouteTemplates templates
        INNER JOIN DB4010.dbo.RouteTemplateClients clients 
        ON clients.RouteTemplateID = templates.RouteTemplateID
        INNER JOIN DB4010.dbo.RouteTemplateStopMasters masters 
        ON masters.RouteTemplateClientID = clients.RouteTemplateClientID
        INNER JOIN DB4010.dbo.RouteTemplateStopDetails details 
        ON details.RouteTemplateStopID = masters.PickupStopID
        INNER JOIN DB4010.dbo.RouteTemplateStopDetails details2 
        ON details2.RouteTemplateStopID = masters.DeliveryStopID
        INNER JOIN DB4010.dbo.Geofences geo 
        ON geo.GeofenceID = details.GeofenceID
        INNER JOIN DB4010.dbo.Geofences geo2 
        ON geo2.GeofenceID = details2.GeofenceID
    WHERE clients.RouteTemplateID = DB4010.dbo.EntityStagedData.EntityID
)
WHERE EXISTS ( SELECT RouteTemplateID FROM DB4010.dbo.RouteTemplates ) 
```

这给了我一个错误：

> 消息 515，级别 16，状态 2，第 1 行
> 无法将值 NULL 插入列 'EntityData'，表 'DB4010.dbo.EntityStagedData'；列不允许空值。更新失败。

对于我的一生，我无法弄清楚如何从内部 Select 语句的结果中更新+连接“EntityData”......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:27:41.927

您可以将第一部分包装在[COALESCE](http://msdn.microsoft.com/en-us/library/ms190349.aspx)语句中，如下所示：

```
SET EntityData = COALESCE((     SELECT          geo.City + ' ' + geo.Description 
    + ' ' + geo.Street + ' ' +         geo2.City + ' ' + geo2.Description + ' ' 
    + geo2.Street     
FROM DB4010.dbo.RouteTemplates templates         
INNER JOIN DB4010.dbo.RouteTemplateClients clients ON clients.RouteTemplateID = 
    templates.RouteTemplateID         
INNER JOIN DB4010.dbo.RouteTemplateStopMasters masters ON 
    masters.RouteTemplateClientID = clients.RouteTemplateClientID         
INNER JOIN DB4010.dbo.RouteTemplateStopDetails details ON 
    details.RouteTemplateStopID = masters.PickupStopID         
INNER JOIN DB4010.dbo.RouteTemplateStopDetails details2 ON 
    details2.RouteTemplateStopID = masters.DeliveryStopID         
INNER JOIN DB4010.dbo.Geofences geo ON geo.GeofenceID = details.GeofenceID         
INNER JOIN DB4010.dbo.Geofences geo2 ON geo2.GeofenceID = details2.GeofenceID     
WHERE clients.RouteTemplateID = DB4010.dbo.EntityStagedData.EntityID ), '') 
```

将值设置为空白值。

如果您想获得尽可能多的信息，请将每个单独的部分包装在`COALESCE`语句中以删除`NULL`值，例如：

```
SELECT          COALESCE(geo.City, '') + ' ' + COALESCE(geo.Description, '') ... 
```

这样，如果您在子选择中的一个值是`NULL`，您将不会因为连接而获得 NULL 值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:36:24.243

我做了一些改变：

*   单字母别名以提高可读性
*   修复专有的 SQL Server UPDATE FROM 语法
*   消除不相关的 WHERE EXISTS 子句

在 geo.City 等包含 NULL 值的情况下，您可能仍需要决定该怎么做。您可能需要简单地将表达式包装在 COALESCE 中，或者将 NULL 行完全从连接中过滤出来。

```
UPDATE s SET EntityData = 
        geo.City + ' ' + geo.Description + ' ' + geo.Street + ' ' +
        geo2.City + ' ' + geo2.Description + ' ' + geo2.Street
FROM DB4010.dbo.EntityStagedData AS s
INNER JOIN DB4010.dbo.RouteTemplateClients AS c
  ON c.RouteTemplateID = s.EntityID
INNER JOIN DB4010.dbo.RouteTemplates AS t
  ON t.RouteTemplateID = c.RouteTemplateID
INNER JOIN DB4010.dbo.RouteTemplateStopMasters AS m
  ON m.RouteTemplateClientID = c.RouteTemplateClientID
INNER JOIN DB4010.dbo.RouteTemplateStopDetails AS d
  ON d.RouteTemplateStopID = m.PickupStopID
INNER JOIN DB4010.dbo.RouteTemplateStopDetails AS d2 
  ON d2.RouteTemplateStopID = m.DeliveryStopID
INNER JOIN DB4010.dbo.Geofences AS geo
  ON geo.GeofenceID = d.GeofenceID
INNER JOIN DB4010.dbo.Geofences AS geo2 
  ON geo2.GeofenceID = d2.GeofenceID; 
```

# java - 有什么方法可以从 spring 上下文中获取 Hibernate SequenceGenerator 吗？

> ID：11252332
> 
> 赞同：4
> 
> 时间：2012-06-28T20:25:21.003
> 
> 标签：java, spring, hibernate

有问题的应用程序有 spring 为休眠定义 LocalSessionFactoryBean，它从休眠 xml 文件加载休眠配置。在休眠映射文件中，指定了序列生成器类。有没有办法将一个spring bean指定为序列生成器，而不是让hibernate根据映射配置创建一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:12:37.817

~~简短的回答：没有。~~

问题是，即使在 spring 3.1 中支持 hibernate4，spring 类也只是只读的`org.hibernate.cfg.Configuration`“包装器”。`IdentifierGeneratorFactory`（[http://docs.jboss.org/hibernate/core/3.6/javadocs/org/hibernate/cfg/Configuration.html](http://docs.jboss.org/hibernate/core/3.6/javadocs/org/hibernate/cfg/Configuration.html)）

~~除非您将其子类化并将其包装到 spring 中，否则我认为没有办法做到这一点。:(~~

编辑：

误读你的问题对不起。

您可以创建自己的序列生成器（[https://community.jboss.org/wiki/CustomSequences](https://community.jboss.org/wiki/CustomSequences)），如果您为它创建一个工厂，那么该工厂可以很容易地感知弹簧，并且可以从弹簧完全配置和注入

# php - 使用可选参数时允许可选的尾部斜杠

> ID：11252337
> 
> 赞同：5
> 
> 时间：2012-06-28T20:25:48.477
> 
> 标签：php, slim

鉴于此路径：`/page(/:pageID)`，我如何允许以下变体：

*   `/page`和`/page/`（即使缺少 pageID 部分。
*   `/page/1`和`/page/1/`

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T16:24:19.447

您必须以这种方式定义您的路线：

```
$app->get('/page(/:id/?)', function ($id = NULL) use ($app) {
    ; // your code
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T17:25:10.590

@inst 提供的答案在这里不起作用（在 XAMPP 上运行的 Slim 2.0.0）：/page/ 给出 404。

这适用于所有四种情况：

```
$app->get('/page(/)(:id/?)', function ($id = NULL) use ($app) {
  echo 'success';
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T19:07:31.770

如[文档](http://docs.slimframework.com/#Route-Parameters)中所述，可选段可能会根据使用情况而不稳定。例如，用 Fabien Snauwaert 给出的答案，以及以下路线：

```
/:controller(/)(:action(/)(:overflow+/?))
/:controller(/)(:action(/:overflow+/?))
```

如果未填写所有参数，则在获取参数值时，这些将位于右侧的位置，从而导致`action == controller`and `overflow == action`。

为了防止这种情况，一个简单的解决方案是将可选的斜杠放在路由的末尾。

```
/:controller(/:action(/:overflow+))/?
/:controller(/:action(/:overflow+))(/)
```

而且它更具可读性，不是吗？

我无法评论其他答案，因此我在这里写了有关 Igor 回复的详细信息。

这种方法的一个“问题”是，如果用户试图访问一个不存在的页面，并且还使用尾部斜杠，那么将是一个 301 重定向以显示一个 404 页面。也许有点奇怪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-30T21:11:34.377

我发现这种方法可以在启用 Apache mod_rewrite 的情况下实现这一点。片段`.htaccess`

```
RewriteEngine On

# remove trailing slash
RewriteCond %{HTTPS} off
RewriteRule ^(.+[^/])/$ http://%{HTTP_HOST}/$1 [R=301,L]
RewriteCond %{HTTPS} on
RewriteRule ^(.+[^/])/$ https://%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-27T08:32:21.897

Slim V3 的示例：

```
/[{param1:[0-9]+}[/[{param2:[0-9]+}[/]]]] 
```

这将包括：

```
/
/1
/1/
/1/2
/1/2/ 
```

# javascript - 将变量传递给 HTML 表单 Javascript

> ID：11252339
> 
> 赞同：0
> 
> 时间：2012-06-28T20:25:57.117
> 
> 标签：javascript

请原谅我的经验不足，因为我不是一个程序员，只是一个试图让某些东西工作的人。我不确定正确的术语和复杂的解释会直接让我头疼！

本质上，我试图将网页的部分 URL 传递给链接到购物车的简单表单。即如何将文件名转换为我有xxxxxxx 的形式。Javascript可以吗？

```
<script type="text/javascript">
var url = window.location.pathname;
var filename = url.substring(url.lastIndexOf('/')+1);
document.write (filename);

</script>
<form action="http://www.mywebspace.com/cf/add.cfm" method="post">
<input type="hidden" name="userid" value="12345678">
<input type="hidden" name="product" value="xxxxxxx">
<input type="hidden" name="price" value="5.00">
<input type="Submit" value="Buy now!">
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:30:43.387

我提供了一个片段代码，可以与您当前的 HTML 结构一起使用。虽然我确实建议你给产品字段一个 id 以防止循环和搜索元素的必要性：

```
var url = window.location.pathname,
    filename = url.substring(url.lastIndexOf('/')+1);
    fields = document.getElementsByTagName('input');

for(var i = 0; i < fields.length; i++){
    if(fields[i].name == 'product') {
        fields[i].value = filename;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:30:45.167

如果表单在给定页面上只存在一次，这是一个简单的解决方案：

将其更改为：

```
<input type="hidden" id="productField" name="product" value="xxxxxxx"> 
```

在你的 javascript 中，

```
document.getElementById('productField').value = filename; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:29:52.573

是的，这是可能的。

您需要更新表单，而不是执行 document.write。假设您的文件名值当前是正确的：

```
 //js
 document.getElementById( "name-of-file").value = filename;

 <!- html --> 
```

……

# excel - 如何在 Excel 中显示唯一名称？

> ID：11252340
> 
> 赞同：1
> 
> 时间：2012-06-28T20:26:02.610
> 
> 标签：excel, duplicates, excel-formula

给定第一页上的下表：

```
Name
-------
Alan
Barb
Corey
Barb
Alan
Daniel
Alan 
```

如何在第二张表上生成下表？

```
Name
-------
Alan
Barb
Corey
Daniel 
```

我不能像这样留下空行：

```
Name
-------
Alan
Barb
Corey

Daniel 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:37:45.570

我假设您有 Excel 2007 或更高版本。

将整个列表、重复项和全部复制到工作表 2。

然后转到数据选项卡。在数据工具部分有一个名为“删除重复项”的大按钮。它会这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T22:40:58.887

有一种不依赖于版本的公式化方法。参见[奥斯卡的网站](http://www.get-digital-help.com/2009/03/30/how-to-extract-a-unique-list-and-the-duplicates-in-excel-from-one-column/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:33:50.843

据我所知，没有办法公式化地做到这一点。

但是，如果您只需要一次性副本，[本文](http://www.techrepublic.com/blog/msoffice/generate-a-list-of-unique-entries-in-an-excel-column/637)将介绍如何进行。

# php - 无法在 Windows 中使用 flush()

> ID：11252342
> 
> 赞同：1
> 
> 时间：2012-06-28T20:26:08.317
> 
> 标签：php, apache2

我们有一个 ubuntu 测试服务器，这个简单的脚本可以在每秒向浏览器输出一个数字的地方正常工作

```
<?
    for ($i=0; $i<3; $i++) 
    {
        echo $i.'<br>';
        flush();
        sleep(1);
    } 
```

但是在我的本地开发框（Windows 环境）上，我无法让它工作，它会在 3 秒后全部输出。

我在本地机器上使用相同的 php 版本（5.3.13）和 apache（2.2.22）版本作为测试服务器。我已经镜像了 php.ini 和 httpd.conf 中的大部分设置这是我设置的设置（与测试服务器相同）

```
output_buffering 0
zlib.output_compression = Off
zlib.output_compression_level = -1 
```

我没有安装 mod_gzip。

我什至尝试在我的盒子上进行 wamp 安装，但它也不起作用。

我无法想象它是客户端（浏览器——firefox 13）问题，因为我使用完全相同的浏览器查看测试服务器上的脚本，并且运行良好

我尝试过启用隐式刷新、执行 ob_flush 等。没有运气。

有人对如何使它工作有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:41:31.560

请记住@Wrikken 所说的，不建议这样做。

所以我在想，你所做的一切似乎都是对的。我复制了你的设置并尝试了。我遇到了同样的问题。我从命令行执行脚本，它工作。

然后我必须做最后一个测试，Wireshark。在前几个数据包之后，很明显服务器正在正确发送所有内容，因此它必须是浏览器的缓冲区。

所以我尝试在循环之前发送一些数据，你猜怎么着？有效！

干得好：

```
<?php
ini_set('output_buffering','off');
ini_set('zlib.output_compression', 0);
echo str_repeat(" ", 1024), "\n";
for($i=0;$i<6;$i++) {
      echo $i."<br />\n";
      ob_flush();
      flush();
      sleep(1);
}
?> 
```

我不确定您想到的应用程序，但这显然不是一个好主意，我强烈建议您考虑其他选项。

**更新：** 经过长时间的谷歌搜索，我发现[了这个](http://gtmetrix.com/specify-a-character-set-early.html)和[这个](https://developers.google.com/speed/docs/best-practices/rendering)

> 由于浏览器在不知道如何构造页面字符的情况下无法正确呈现页面，因此大多数浏览器在执行任何 JavaScript 或绘制页面之前会缓冲一定数量的字节

和

> 为了避免这些延迟，对于任何大于 1 KB（准确地说是**1024 字节**，这是我们测试过的任何浏览器使用的最大缓冲区限制）的任何 HTML 文档，您都应该尽早指定字符编码。

所以我尝试先发送字符集而不是填充缓冲区：（它有效）

```
<?php
ini_set('output_buffering','off');
ini_set('zlib.output_compression', 0);
//echo str_repeat(" ", 1024), "\n";
header('Content-Type: text/html; charset=iso-8859-1');
//Note that it shoudn't matter which charset you send
for($i=0;$i<6;$i++) {
      echo $i."<br />\n";
      ob_flush();
      flush();
      sleep(1);
}
?> 
```

**那么为什么它与第一台服务器一起工作而不是第二台服务器呢？**

很可能是因为您的第一个服务器正在发送带有标题的字符集，而第二个不是。

但是，在您的情况下，我会进行以下更改

```
<?php
ini_set('output_buffering','off');
ini_set('zlib.output_compression', 0);
//Plain text MIME type since you'll use for logging purposes
//and if you run it from CLI, you can ignore the whole header line
header('Content-Type: text/plain; charset=iso-8859-1');
for($i=0;$i<6;$i++) {
      //No need to echo <br /> once you'll run it from CLI
      echo $i."\n";
      ob_flush();
      flush();
      sleep(1);
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T01:13:01.890

我找到了解决我的问题的方法。出于某种原因添加该行

```
default_charset = "utf-8" 
```

我的 php.ini 使它工作。我确认我删除了线路.. 冲洗没有工作。添加它，它工作。也许是因为它添加了额外的标头，为浏览器缓冲区提供了足够的空间。

# c# - AvalonEdit (C#) XSHD 文件中的自定义属性

> ID：11252359
> 
> 赞同：3
> 
> 时间：2012-06-28T20:27:22.440
> 
> 标签：c#, xaml, avalonedit

我正在努力突出一种小型脚本语言（它不是任何内置语言的派生语言），并且我为不同的语法关键字等设置了自定义 XML 文件。

我真的很想使用 AvalonEdit 中存在的 XSHD 系统来加载自定义关键字，但我需要在其中包含自定义属性。

所以基本上，在大量搜索源代码之后，我无法真正确定读取并指定关键字和规则集的文件。

这里有谁知道我可以在哪里编辑所需的类来读取一些自定义属性并存储它们？

我在 AvalonEdit 中的所有 XSHD 和突出显示的东西都已关闭并正常工作，所以问题不是使用它，也就是说，更多的是在 XSHD 文件的关键字集合中使用自定义属性的问题。

例如：

```
<Keywords>
   <Word defaultValue="hello" requiresShader="shadertype1, shadertype2" someCustomAttr="value">wordname</word>
</Keyword> 
```

因此，我需要为 XSHD 文件的解析器设置一些自定义属性，以加载这些自定义属性并将它们存储在我创建的自定义类中，该类处理一些对我正在尝试做的事情至关重要的逻辑组件。

我已经有一个可以工作的解析器来解析我所有的关键字及其属性的 XML 文件（但我将它写到 ScintillaNET，但后来发现 AvalonEdit，它与 WPF 等配合得更好）。

我将使用此信息编辑原始帖子，对于可能的错误信息，我深表歉意。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T20:38:55.490

要加载 XSHD 文件，您需要导入以下库：

```
using ICSharpCode.AvalonEdit;
using ICSharpCode.AvalonEdit.Highlighting;
using ICSharpCode.AvalonEdit.Highlighting.Xshd; 
```

然后无论您在何处创建文本编辑器（如果您在 XAML 中创建它，则省略第一行并仅引用 TextEditor），使用以下代码加载 def.xshd。

```
// TextEditor is an AvalonEdit.TextEditor
TextEditor edit = new TextEditor();
XmlReader reader = XmlReader.Create("def.xshd");
edit.SyntaxHighlighting = HighlightingLoader.Load(reader, HighlightingManager.Instance); 
```

我在作品中用于语言的一个很好的示例 xshd 文件是：

```
<SyntaxDefinition name="XAPL"
    xmlns="http://icsharpcode.net/sharpdevelop/syntaxdefinition/2008">
<Color name="Comment" foreground="Green" />
<Color name="String" foreground="Pink" />
<Color name="Xml" foreground="Orange" />
<!-- This is the main ruleset. -->
<RuleSet>
    <Span color="Comment" begin="//" />
    <Span color="Comment" multiline="true" 
       begin="/\*" end="\*/" />

    <Span color="String">
        <Begin>"</Begin>
        <End>"</End>
        <RuleSet>
            <!-- nested span for escape sequences -->
            <Span begin="\\" end="." />
        </RuleSet>
    </Span>

  <Span color="Xml" multiline="false">
    <Begin>spaz</Begin>
    <End>spaz</End>
  </Span>

    <Keywords fontWeight="bold" foreground="Blue">
        <Word>dealwith</Word>
        <Word>import</Word>
        <Word>end</Word>
        <Word>var</Word>
        <Word>default</Word>
        <Word>template</Word>
        <Word>sub</Word>
        <Word>category</Word>
        <Word>if</Word>
        <Word>otherwise</Word>
        <Word>and</Word>
        <Word>xor</Word>
        <Word>string</Word>
        <Word>int</Word>
        <Word>convert</Word>
        <Word>to</Word>
        <Word>escape</Word>
        <Word>native</Word>
        <Word>loop</Word>
        <Word>is</Word>
        <Word>to</Word>
        <Word>from</Word>
        <Word>by</Word>
    </Keywords>

    <!-- Digits -->
    <Rule foreground="DarkGray">
        \b0[xX][0-9a-fA-F]+  # hex number
    |    \b
        (    \d+(\.[0-9]+)?   #number with optional floating point
        |    \.[0-9]+         #or just starting with floating point
        )
        ([eE][+-]?[0-9]+)? # optional exponent
    </Rule>
</RuleSet>
</SyntaxDefinition> 
```

# php - 2 个变量彼此相邻

> ID：11252362
> 
> 赞同：-3
> 
> 时间：2012-06-28T20:27:34.463
> 
> 标签：php

我想输入名字和姓氏的字段，但我也希望它们一起显示，但我还不太清楚如何使两个名称变量彼此相邻！这是我的代码：

```
$first_name = $poster_data['first_name'];

$last_name = $poster_data['last_name'];

$name = $first_name, $last_name; 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T20:30:05.607

要组合字符串，请使用连接运算符：`.`.

```
$name = $first_name . $last_name; 
```

尽管您可能希望它们之间有一个空格：

```
$name = $first_name . ' ' . $last_name; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-28T20:30:39.020

```
$name = "{$first_name}, {$last_name}"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T20:29:21.847

```
$name = $first_name." ". $last_name; 
```

额外`" "`的用于两者之间的空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-28T20:29:25.777

```
$name = $first_name.', '.$last_name; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-28T20:29:30.890

它被称为**string concatenation**，在 PHP 中它是这样表达的，使用`.`运算符：

```
$name = $first_name . $last_name; 
```

这将打印“ `JohnDoe`”。如果要添加空格：

```
$name = $first_name . " " . $last_name; 
```

这将打印“ `John Doe`”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-28T20:30:06.130

```
echo $firstname . " " . $lastname 
```

显示名称为 John Smith

# javascript - Javascript图像循环器

> ID：11252364
> 
> 赞同：0
> 
> 时间：2012-06-28T20:27:40.240
> 
> 标签：javascript, image, timer, slideshow

在计时器之后，图像 div 变为空白，而不是切换到下一张图片。它应该循环图像1-4并无限重复

```
$('.carouselImageJavascriptActive').removeClass('carouselImageJavascriptActive');
$(this).addClass('carouselImageJavascriptActive');
var imgs=$(this).attr('.carouselImage')
var self = $(this);
var myImage = new Array();
var x=0;

myImage[0]='img/image1.jpg';
myImage[1]='img/image2.jpg';
myImage[2]='img/image3.jpg';
myImage[3]='img/image4.jpg';

setTimeout(function() {

    var img = document.getElementById('.carouselImageJavascriptActive');
    img.src = myImage[x];
    x++;

    if(x >= myImage.length){
        x = 0;
    } 
},2000); 
```

HTML

```
<div id='challengeTwoImageJavascript' class='sectionChallengeCarouselImage'>
    <img id='imgj1' imgn='1' class='carouselImage carouselImageJavascriptActive' src='img/image1.jpg'/>
    <img id='imgj2' imgn='2' class='carouselImage' src='img/image2.jpg'/>
    <img id='imgj3' imgn='3' class='carouselImage' src='img/image3.jpg'/>
    <img id='imgj4' imgn='4'class='carouselImage' src='img/image4.jpg'/>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:32:48.047

这些图像的 id 都不是“.carouselImageJavascriptActive”。

# php - 使用 Apache .htaccess 设置 DYNAMIC Php $_SERVER 值 ($_SERVER['something'])

> ID：11252365
> 
> 赞同：6
> 
> 时间：2012-06-28T20:27:41.003
> 
> 标签：php, apache, .htaccess

这是对[这个问题](https://stackoverflow.com/questions/612228/setting-a-php-server-value-serversomething-using-apache-htaccess)的一个扩展，我们了解到我们可以使用 var 设置一个`$_SERVER`var `SetEnv`。

下一个问题是：有没有办法像这样使用 SetEnv：

/var/www/www.example.com/module/unique_section/.htaccess：

```
SetEnv RESOURCE_ROOT %{DIRECTORY} 
```

/var/www/www.example.com/module/unique_section/some/path/file.php

```
<?php echo $_SERVER['RESOURCE_ROOT']; ?> 
```

输出：`/var/www/www.example.com/module/unique_section/`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:44:59.237

根据您需要的信息，您*可以*使用`RewriteRule`. 例如：

```
RewriteEngine On
RewriteCond %{DOCUMENT_ROOT} (.*)
RewriteRule (.*) - [E=RESOURCE_ROOT:%1] 
```

将设置 PHP var`$_SERVER['RESOURCE_ROOT']`或`$_SERVER['REDIRECT_RESOURCE_ROOT']`您的 Apache 文档根目录。有关完整详细信息，请参阅[mod_rewrite 手册](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)`%{DOCUMENT_ROOT}`，但,`%{PATH_INFO}`和的某些组合`%{REQUEST_FILENAME}`可能对您有用。

我认为文件不可能`.htaccess`知道它所在的目录。所以我认为您需要在`.htaccess`文件中使用硬编码路径。举个例子：

```
RewriteEngine On
RewriteCond %{DOCUMENT_ROOT} (.*)
RewriteRule (.*) - [E=RESOURCE_ROOT:%1/module/unique_section/] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T20:49:35.433

据我所知， setEnv 无权访问 apache 环境变量。因此 %{DIRECTORY} 将不起作用，除非您希望该值专门为“%{DIRECTORY}”。使用 mod_rewrite，这对我来说可以获取正在加载的文件的路径：

```
RewriteEngine On

RewriteCond %{SCRIPT_FILENAME} ((.*)/)
RewriteRule (.*) - [E=RESOURCE_ROOT:%1] 
```

输出：

```
var_dump(__FILE__);
//outputs: string(27) "/var/www/sub/test/index.php" 
var_dump($_SERVER['RESOURCE_ROOT']);
//outputs: string(24) "/var/www/sub/test/" 
```

除此之外，仅使用 php 并做`dirname(__FILE__)`or有什么问题`dirname($_SERVER['PHP_SELF'])`吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T20:53:23.233

您可以使用该功能`apache_getenv`来获得您想要的东西。

链接： http: [//php.net/manual/en/function.apache-getenv.php](http://php.net/manual/en/function.apache-getenv.php)

不要忘记阅读文档：

> 此功能**需要 Apache 2**，否则未定义。

例子 ：

```
<?php
$ret = apache_getenv("SERVER_ADDR");
echo $ret;
?> 
```

上面的示例将输出类似于：

```
42.24.42.240 
```

但是，正如这个威胁中所建议的那样，您可以只使用`dirname(__FILE__)`并且从 PHP 5.3.0 开始，您可以将`__DIR__`其用作魔术常量。

# flash - 如何在动作脚本中绘制对角线

> ID：11252368
> 
> 赞同：0
> 
> 时间：2012-06-28T20:27:49.740
> 
> 标签：flash, animation, actionscript

如何使用Action Script在Flash中绘制对角线效果？我使用补间动画制作动画，然后尝试从该补间动画生成动作脚本，但动画从屏幕中间开始，然后绘制它。它应该从左角开始，因为它是在常规动画中制作的。这是它生成的动作脚本：

```
import fl.motion.Animator;
var laser_xml:XML = <Motion duration="75" xmlns="fl.motion.*" xmlns:geom="flash.geom.*" xmlns:filters="flash.filters.*">
    <source>
        <Source frameRate="25" x="13.6" y="13.25" scaleX="1" scaleY="1" rotation="0" elementType="drawing object">
            <dimensions>
                <geom:Rectangle left="10" top="10" width="7.25" height="6.5"/>
            </dimensions>
            <transformationPoint>
                <geom:Point x="-1.3793103448275863" y="-1.5384615384615385"/>
            </transformationPoint>
        </Source>
    </source>

    <Keyframe index="0"/>

    <Keyframe index="74" x="188.70000000000002" y="189.05"/>
</Motion>;

var laser_animator:Animator = new Animator(laser_xml, laser);
laser_animator.play(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:19:57.130

不确定您是在询问如何修改生成的代码，还是仅使用 AS3 进行。如果是后者，这会给你想要的效果。请注意，虽然使用 Tweening 库（例如 TweenLite 或 GTween）会更干净：

```
var s:Shape = new Shape();
addChild(s); 

var startPoint:Point = new Point();
var endPoint:Point = new Point();
var prog:Number = 0;
var frames:int = 200;

animateLine(100,100,50,50);

function animateLine(startX:Number, startY:Number, endX:Number, endY:Number, time:Number = 120):void {
    startPoint.x = startX;
    startPoint.y = startY;
    endPoint.x = endX;
    endPoint.y = endY;

    frames = time;
    prog = 0;
    this.addEventListener(Event.ENTER_FRAME, tick);
}

function drawLineTick(progress:Number):void{
    s.graphics.clear();
    s.graphics.lineStyle(3,0xFF0000);
    s.graphics.moveTo(startPoint.x,startPoint.y);
    s.graphics.lineTo(startPoint.x + ((endPoint.x - startPoint.x) * progress), startPoint.y + ((endPoint.y - startPoint.y) * progress));
}

function tick(e:Event):void {
    trace("tick",prog);
    if(prog >= frames){
        this.removeEventListener(Event.ENTER_FRAME, tick);
    }

    drawLineTick(prog / frames);
    prog += 1;
} 
```

# backbone.js - Backbone.js 只读集合视图渲染

> ID：11252369
> 
> 赞同：1
> 
> 时间：2012-06-28T20:27:51.280
> 
> 标签：backbone.js, backbone-views, backbone-routing

*我的问题的快速总结：视图的第一次渲染包含集合中的元素，而第二次渲染不包含。请继续阅读以了解详细信息...*

*另外值得注意的是：我确实意识到以下代码代表了幸福的道路，并且有很多潜在的错误处理代码丢失，等等，等等......这是为了简洁而故意的。*

我对backbone.js 很陌生，并且在找出为以下场景实施解决方案的正确方法时遇到了一些麻烦：

我有一个带有两个主要区域的页面，以包含/显示将成为应用程序主要布局的渲染内容。一般来说，它看起来像这样：

```
-------------------------------------------
|                          |              |
|                          |              |
|         Content          |   Actions    |
|          Panel           |    Panel     |
|                          |              |
|                          |              |
|                          |              |
|                          |              |
|                          |              |
|                          |              |
------------------------------------------- 
```

我有一个从中获取数据的 HTTP API，它实际上以 JSON 结果的形式提供各种模块的资源信息，这些信息来自`OPTIONS`对每个模块的基本 URL 的调用。例如，`OPTIONS`请求`http://my/api/donor-corps`返回：

```
[
    {
        "Id":0,
        "Name":"GetDonorCorps",
        "Label":"Get Donor Corps",
        "HelpText":"Returns a list of Donor Corps",
        "HttpMethod":"GET",
        "Url":"https://my/api/donor-corps",
        "MimeType":"application/json",
        "Resources":null
    }
] 
```

该应用程序有一个我正在调用的主干集合，`DonorCorpsCollection`它将是一个只读`DonorCorpModel`对象集合，可能由多个不同的主干视图呈现并以不同的方式显示在应用程序的不同页面上（最终......稍后...... .目前情况并非如此）。该`url`属性`DonorCorpsCollection`将需要将对象的属性与初始调用结果的`Url`“GetDonorCorps”属性一起获取API模块资源（如上所示）。`Name``OPTIONS`

该应用程序顶部有一个菜单栏，其中包含链接，单击这些链接将呈现应用程序的各个页面。目前，应用程序中只有两个页面，“主页”页面和“预排序”页面。在“主页”视图中，两个面板中都只有占位符信息，表明用户应该单击菜单栏上的链接来选择要执行的操作。当用户单击“预排序”页面链接时，我只想显示一个主干视图，该视图`DonorCorpsCollection`在操作面板中呈现为无序列表。

我目前正在使用[JavaScript 模块模式](http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth)来组织和封装我的应用程序代码，我的模块目前看起来像这样：

```
var myModule = (function () {

// Models
    var DonorCorpModel = Backbone.Model.extend({ });

// Collections
    var DonorCorpsCollection = Backbone.Collection.extend({ model : DonorCorpModel });

// Views
    var DonorCorpsListView = Backbone.View.extend({
        initialize : function () {
            _.bindAll(this, 'render');
            this.template = _.template($('#pre-sort-actions-template').html());
            this.collection.bind('reset', this.render); // the collection is read-only and should never change, is this even necessary??
        },

        render : function () {
            $(this.el).html(this.template({})); // not even exactly sure why, but this doesn't feel quite right

            this.collection.each(function (donorCorp) {
                var donorCorpBinView = new DonorCorpBinView({
                    model : donorCorp,
                    list : this.collection
                });

                this.$('.donor-corp-bins').append(donorCorpBinView.render().el);
            });

            return this;            
        }
    });

    var DonorCorpListItemView = Backbone.View.extend({
        tagName : 'li',
        className : 'donor-corp-bin',

        initialize : function () {
            _.bindAll(this, 'render');
            this.template = _.template($('#pre-sort-actions-donor-corp-bin-view-template').html());
            this.collection.bind('reset', this.render);
        },

        render : function () {
            var content = this.template(this.model.toJSON());
            $(this.el).html(content);
            return this;
        }
    });

// Routing
    var App = Backbone.Router.extend({
        routes : {
            '' : 'home',
            'pre-sort', 'preSort'
        },

        initialize : function () { },

        home : function () {
            // ...
        },

        preSort : function () {
            // what should this look like??
            // I currently have something like...

            if (donorCorps.length < 1) {
                donorCorps.url = _.find(donorCorpResources, function (dc) { return dc.Name === "GetDonorCorps"; }).Url;
                donorCorps.fetch();
            }

            $('#action-panel').empty().append(donorCorpsList.render().el);
        }
    })

// Private members
    var donorCorpResources;
    var donorCorps = new DonorCorpsCollection();
    var donorCorpsList = new DonorCorpsListView({ collection : donorCorps });

// Public operations
    return {
        Init: function () { return init(); }
    };

// Private operations
    function init () {
        getAppResources();
    }

    function getAppResources () {
        $.ajax({
            url: apiUrl + '/donor-corps',
            type: 'OPTIONS',
            contentType: 'application/json; charset=utf-8',
            success: function (results) {
                donorCorpResources = results;
            }
        });
    }

}(myModule || {})); 
```

最后，这一切都使用以下 HTML：

```
...
<div class="row-fluid">
    <div id="viewer" class="span8">
    </div>
    <div id="action-panel" class="span4">
    </div>
</div>
...
<script id="pre-sort-actions-template" type="text/template">
    <h2>Donor Corps</h2>
    <ul class="donor-corp-bins"></ul>
</script>

<script id="pre-sort-actions-donor-corp-bin-view-template" type="text/template">
    <div class="name"><%= Name %></div>
</script>

<script>
    $(function () {
        myModule.Init();
    });
</script>
... 
```

到目前为止，当我*第*一次点击“预排序”菜单链接时，我已经能够让它工作。当我单击它时，它会按预期呈现捐赠者军团的列表。但是，如果我然后单击“主页”链接，然后再次单击“预排序”链接，这次我会看到标题，但它`<ul class="donor-corp-bins"></ul>`是空的，其中没有列表项。...而且我*不知道*为什么或我需要做不同的事情。我觉得我一般理解backbone.js 视图和路由器，但在实践中，我显然遗漏了一些东西。

总的来说，这似乎是一个相当直接的场景，我不觉得我在这里尝试做任何特殊的事情，但我无法让它正常工作，而且似乎无法弄清楚原因。非常感谢您的协助，或者至少向正确的方向轻推。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:47:59.367

对于 DonorCorpListView，您的渲染代码对我来说看起来很奇怪 - 看起来您在获得任何数据之前就在进行模板化。您需要使用数据编译该模板*以*获取 HTML 输出。

所以，渲染逻辑应该是这样的：

```
var template = $([get the template).html();
template.compile(this.collection.toJSON());
this.el.append(template.render()); 
```

我在这里使用了一些伪代码，因为我不确定您的模板机制是什么（我自己喜欢 Handlebars）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T19:07:29.913

所以，我在这里想出了一个解决方案。不确定它是*最好*的还是正确的解决方案，但它至少目前有效。

似乎有几个问题。根据 Rob Conery 的反馈，我开始研究使用我的视图模板渲染集合的不同选项，这就是我想出的：

正如我在评论中提到的，我们使用[Handlebars](http://handlebarsjs.com/)进行视图模板，所以这段代码使用它。

我最终将视图模板更改为如下所示：

```
<script id="pre-sort-actions-template" type="text/x-handlebars-template">
    <h2>Donor Corps</h2>
    <ul class="donor-corp-bins">
    {{#each list-items}}
        <li class="donor-corp-bin">{{this.Name}}</li>
    {{/each}}
    </ul>
</script> 
```

然后，我完全删除`DonorCorpListItemView`，并改为`DonorCorpsListView`现在看起来像这样：

```
var DonorCorpsListView = Backbone.View.extend({
    initialize : function () {
        _.bindAll(this, 'render');
        this.collection.bind('reset', this.render);
    },
    render : function () {
        var data = { 'list-items' : this.collection.toJSON() };
        var template = Handlebars.compile($('#pre-sort-actions-template').html());
        var content = template(data);
        $(this.el).html(content);

        return this;
    }
}); 
```

所以，这似乎正在工作，并且正在做我现在需要做的事情。

我显然仍然需要了解很多关于 JS 和 Backbone.js 如何工作的知识，因为***以下内容***不起作用（引发错误）......而且我不知道为什么：

```
var DonorCorpsListView = Backbone.View.extend({
    initialize : function () {
        _.bindAll(this, 'render');
        this.template = Handlebars.compile($('#pre-sort-actions-template').html());
        this.collection.bind('reset', this.render);
    },
    render : function () {
        var data = { 'list-items' : this.collection.toJSON() };
        var content = this.template(data);
        $(this.el).html(content);

        return this;
    }
}); 
```

希望这对某人有所帮助。

# .htaccess - HTACCESS mod-rewrite 和子目录

> ID：11252370
> 
> 赞同：0
> 
> 时间：2012-06-28T20:27:54.250
> 
> 标签：.htaccess

我试图理解为什么它会给我一个内部服务器错误：

```
RewriteEngine on
rewritecond %{http_host} ^website.ca [NC]
rewriterule ^(.*)$ http://www.website.ca/$1 [R=301,nc]

RewriteRule ^/$ index.php
RewriteRule ^realisations.html$ realisations.php
RewriteRule ^couvreur-toiture/services-de-toiture.html$ services-de-toiture.php 
```

基本上我需要 .php 文件显示为 .html 并且主 public_html 目录上的某些页面出现在子目录中。

我的错误在哪里？先感谢您。

# c++ - Why uncalled template class members aren't instantiated?

> ID：11252378
> 
> 赞同：5
> 
> 时间：2012-06-28T20:28:17.040
> 
> 标签：c++, class, templates

I was wondering that when I create an instance of a class template with specifying the template type parameter.
**1)** why the non-called function do not get instatiated ? .
**2)** dont they get compiled until I try to use it ?
**3)** what is the logic behind this behavior ?

**Example**

```
template <class T>
class cat{
public:

T a;
void show(){
   cout << a[0];
}
void hello(){
   cout << "hello() get called \n";
}
}; 

int main(){
cat<int> ob1; // I know that show() did not get instatiated, otherwise I will get an    error since a is an int
ob1.hello();

 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:35:14.430

Templates aren't code - they're a pattern used to make the actual code. The template isn't complete until you supply the parameters so the code can't be made ahead of time. If you don't call a function with a particular set of template parameters, the code never gets generated.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T20:32:38.347

If they instantiated the entire class, then you might get invalid code.

You don't always want that.

Why? Because in C++, it's *difficult* (and in some cases, outright impossible, as far as I know) to say, "only compile this code if X, Y, and Z are true".

For example, how would you say, "only my copy constructor if the embedded object can be copied"? As far as I know, you can't.

So they just made them not compile unless you actually call them.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-28T21:01:00.903

To embellish a little more: this is typically called [duck typing](http://en.wikipedia.org/wiki/Duck_typing), and the bottom line is that it allows you to write "class patterns" of which *some* member functions may apply when instantiated with one template type, *other* members may apply when instantiated with a second template type, and by only requiring the ones you actually call to compile, you get to write a lot less code for operations that wind up being common ones.

By not requiring all member functions to be compiled you get all the niceties of static type checking on the functions that *actually are* compiled.

For example, imagine you had:

```
 template <typename E> 
  class myContainer {

      // Imagine that constructors, setup functions, etc. were here

      void sort();   // this function might make sense only if E has an operator< defined

      E max();   // compute the max element, again only makes sense with a operator<

      E getElement(int i);  // return the ith element

      E transmogrify();  // perhaps this operation only makes sense on vectors
  }; 
```

Then you have

```
 // sort() and getElement() makes total sense on this, but not transmogrify()
  myContainer<int> mci;         

  // sort and max might not be needed, but getElement() and transmogrify() might
  myContainer<vector<double>> mcvd; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-28T20:32:08.610

No code is generated for `cat<int>::show()` because you never call it. If you did call it you would get a compilation error. Template functions which are never called do not exist.

Templates are little more than test substitution mechanisms. This makes them very powerful. You, as the programmer, may want to create a `cat<int>` knowing that you will never call `show()` or call anything else that would be invalid. The compiler lets you know if you did, so it works out nicely.

So if your question is "why does it work this way", I would ask you "why not"? It's a design choice. This choice allows me to use a template type safely and still benefit from other parts of the code. What's the harm? You also generate less code, which is a good thing, right?

# ajax - 如何在 AJAX 请求期间“打印”主题（Drupal）

> ID：11252379
> 
> 赞同：2
> 
> 时间：2012-06-28T20:28:18.113
> 
> 标签：ajax, callback, drupal-7, drupal-theming, graphael

当用户点击一个按钮（带有`id`图表）时，我想用一个 graphael 实例 填充默认的 Drupal 内容`div`（ ）。`<div class="content">`

JavaScript：

```
jQuery(document).ready(function($) {

   $('#toggle #graph').click(function() {

    $.ajax({
      url: "http://www.mysite.com/?q=publications/callback",
      type: 'POST',
      data: {
        'format' : 'graph'
      },
      success: function(response) {
        $('div#content div.content').html(response);
      }
    });
  });
}); 
```

PHP：

```
$items['publications/callback'] = array(
  'type' => MENU_CALLBACK,  
  'title' => 'All Publications Callback',
  'page callback' => '_process_publications',
  'page arguments' => array(t('journal')),
  'access callback' => TRUE,
); 
```

这导致页面回调：（我关心`if`代码块）

```
function _process_publications($venue) {

if( isset($_POST['format']) && $_POST['format'] == "graph" ){
    _make_bar_chart($venue);
}
elseif( isset($_POST['format']) && $_POST['format'] == "list" ) {
    _make_list($venue);
}
else{
    return("<p>blah</p>");
}

} 
```

最后是回调函数中调用的函数：

```
function _make_bar_chart($venue) {

// get active database connection 
$mysql = Database::getConnection();

// if connection is successful, proceed
if($mysql){
       // do stuff

        $graphael = array(
            'method' => 'bar',
            'values' => $ycoordinates,

            'params' => array(
              'colors' => $colors,
              'font' => '10px Arial, sans-serif',
              'opts' => array(
                'gutter' => '20%',
                'type' => 'square',
              ),
              'label' => array(
                'values' => $xcoordinates,
                'isBottom' => true,
              ),
            ),

            'extend' => array(
              'label' => array(
                'values' => $ycoordinates,
                'params' => array('attrText' => array(
                  'fill' =>  '#aaa',
                  'font' => '10px Arial, sans-serif',
                )),
              ),
            ),
        );

    return theme('graphael', $graphael);

}

// else, connection was unsuccessful
else{
    print("<p>bad connection</p>");
}

} 
```

**问题：**返回主题并不会真正将任何内容发送回 AJAX 请求（与`print`语句不同）。我试图打印主题，但这会产生白屏死机。我如何在不打印东西的情况下生成图表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T16:46:13.363

非常感谢Drupal 论坛上的*nevets*提供的有用提示：[http ://drupal.org/node/1664798#comment-6177944](http://drupal.org/node/1664798#comment-6177944)

如果您想将 AJAX 与 Drupal 一起使用，您最好实际使用 Drupal 特定的 AJAX 相关函数。在我的主题`page.tpl.php`文件中，我添加了以下内容来创建调用 AJAX 的链接：

```
<?php
    // drupal_add_library is invoked automatically when a form element has the
    // '#ajax' property, but since we are not rendering a form here, we have to
    // do it ourselves.
    drupal_add_library('system', 'drupal.ajax');

        // The use-ajax class is special, so that the link will call without causing
        // a page reload. Note the /nojs portion of the path - if javascript is
        // enabled, this part will be stripped from the path before it is called.
        $link1 = l(t('Graph'), 'ajax_link_callback/graph/nojs/', array('attributes' => array('class' => array('use-ajax'))));
        $link2 = l(t('List'), 'ajax_link_callback/list/nojs/', array('attributes' => array('class' => array('use-ajax'))));
        $link3 = l(t('Create Alert'), 'ajax_link_callback/alert/nojs/', array('attributes' => array('class' => array('use-ajax'))));

        $output = "<span>$link1</span><span>$link2</span><span>$link3</span><div id='myDiv'></div>";
        print $output;

?> 
```

当点击上述链接之一时，回调函数被调用（例如 ajax_link_callback/graph）：

```
// A menu callback is required when using ajax outside of the Form API.
  $items['ajax_link_callback/graph'] = array(
   'page callback' => 'ajax_link_response_graph',
   'access callback' => 'user_access',
   'access arguments' => array('access content'),
   'type' => MENU_CALLBACK,
  ); 
```

.. 以及它所指的回调：

```
function ajax_link_response_graph($type = 'ajax') {
  if ($type == 'ajax') {
   $output = _make_bar_chart('journal');
   $commands = array();
   // See ajax_example_advanced.inc for more details on the available commands
   // and how to use them.
   $commands[] = ajax_command_html('div#content div.content', $output);
   $page = array('#type' => 'ajax', '#commands' => $commands);
   ajax_deliver($page);
  }
 else {
   $output = t("This is some content delivered via a page load.");
   return $output;
 }
} 
```

这会将其中的任何 HTML 替换为从上面`<div class="content">`的*_make_bar_chart*返回的图形图表。

# django-templates - 带有“安全”参数的 url 模板标签？

> ID：11252380
> 
> 赞同：0
> 
> 时间：2012-06-28T20:28:18.537
> 
> 标签：django-templates

我正在尝试使用`{% url %}`模板标记，但稍后将在 Javascript 中替换一个参数。它看起来像这样：

```
var pid = '7a8b323f-52b1-466c-91d3-b4i4d85b1c32';
var status_url = '{% url quote_status form_urlname inquiry_id instance_id '{0}' %}'.format(pid); 
```

我尝试同时使用`{% autoescape off %}`and `|safe`，但似乎都不起作用。有没有好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T11:35:27.110

（剪掉之前的回答，不好意思，看的不够仔细）

如果构建 url 需要参数，它就不起作用 - 模板标签在服务器上执行，javascript 在浏览器上执行。

# java - system.out.println 必须在 edt 上吗？

> ID：11252388
> 
> 赞同：2
> 
> 时间：2012-06-28T20:28:36.600
> 
> 标签：java, swing, event-dispatch-thread, println, swingutilities

我正在运行一些在 swingworker 中打印输出的代码。我没有得到打印输出，所以我使用`SwingUtilities.invokeLater`了，现在它可以工作了。没想到是这样的结果，怎么会这样？我原以为`System.out.println`可以在 EDT 之外运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:03:30.833

这本来很容易测试（不是说，即使输入所有代码来测试它也比在此处发布它的工作量少）：

```
import java.awt.EventQueue;
public class HelloWorld {
  public static void main( String[] args ) {
    System.out.println("Hello world");
    System.out.println( EventQueue.isDispatchThread());
  }
} 
```

结果是

```
Hello world
false 
```

在控制台上。

所以是的，`System.out.println`可以在 EDT 之外使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:30:18.877

> 我会认为system.out.println 可以在edt 之外运行。

那是真实的。要对此进行测试，请创建一个线程，在其中放置循环和打印输出并亲自查看:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:35:41.560

System.out.println 确实在 edt 之外运行。当你使用 swingworker 运行它时，你让它在里面运行。从理论上讲，您应该始终能够直接从代码块中打印结果。我建议：

```
Runnable runnable = new Runnable() {

        public void run() {

        }
    };
SwingUtilities.invokeLater(runnable); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:56:28.933

虽然可以，但除了调试之外，它的应用程序很少。

替代输出的示例是 JOptionPane：

```
JOptionPane.showMessageDialog(frame/* sets up the message, can also be replaced with null to remove formatting*/,
"Eggs are not supposed to be green."/* this is your main message*/,
"A plain message"/* this is what shows in the title spot (first parameter must not be null)*/,
JOptionPane.PLAIN_MESSAGE/*shows no icon, also replacable with WARNING_MESSAGE, ERROR_MESSAGE, INFORMATION_MESSAGE*/); 
```

所有这些都在一行上，但我将它分解为在这里格式化一行版本：

```
JOptionPane.showMessageDialog(frame/* sets up the message, can also be replaced with null to remove formatting*/, "Eggs are not supposed to be green."/* this is your main message*/, "A plain message"/* this is what shows in the title spot (first parameter must not be null)*/, JOptionPane.PLAIN_MESSAGE/*shows no icon, also replacable with WARNING_MESSAGE, ERROR_MESSAGE, INFORMATION_MESSAGE*/); 
```

没有评论：

```
JOptionPane.showMessageDialog(frame, "Eggs are not supposed to be green.", "A plain message", JOptionPane.PLAIN_MESSAGE); 
```

在你的程序中用苏斯博士的名言来欺骗你的老师是很有趣的。

# html - 如何链接到浏览器无法查看的下载文件？

> ID：11252389
> 
> 赞同：4
> 
> 时间：2012-06-28T20:28:37.680
> 
> 标签：html, hyperlink, download

在 HTML 中，如何链接到浏览器只能下载而不能查看的文件？例如，假设我有一个 zip 文件*my-program.zip*。我希望我网站的访问者在单击链接时能够下载该文件。链接如下所示：[下载我的程序](http://example.com/)。在我的网络服务器上，HTML 文件和 zip 文件位于同一目录中，因此 zip 文件的相对路径就是它的文件名。

但是如果我只是链接到带有`<a href="my-program.zip">`标签的文件，浏览器将无法识别该链接，对吧？因为浏览器无法打开 zip 文件。那么链接到它的正确方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-28T20:28:38.460

实际上，您的示例*是*链接到文件的正确方法：

```
<a href="my-program.zip">download my program</a> 
```

您永远无法确定浏览器无法查看文件。您只需链接到它；由浏览器来做他们认为最好的事情——显示、下载或做其他事情。不用担心; 浏览器通常会做正确的事情。

这遵循了网络的原则，即您不知道浏览器将如何处理您发送给它的文件和页面。您提到了一个 ZIP 文件，但想想 PDF 文件。它们就像一个 ZIP 文件：它们不是 HTML，它们不是为浏览器制作的，浏览器可能会下载它。但是有一些插件，例如[Adob​​e PDF Reader](http://get.adobe.com/reader/)和[Schubert 的 PDF 浏览器插件](http://www.schubert-it.com/pluginpdf/)，可以直接在浏览器中显示 PDF 文件的内容。同样，假设浏览器可能有一个 ZIP 文件查看器——它可能会在浏览器中向用户显示 ZIP 文件的内容，并让用户决定在哪里提取这些内容。

大多数浏览器*没有*描述的假设 ZIP 文件查看器，因此文件只会下载，就像您想要的那样。但这并不重要。只需写下您的链接，一切都会好起来的。

除了立即查看文件或下载文件之外，浏览器还可以做其他事情。它还可以询问用户是否要下载文件。或者它可以开始下载文件，检测其中的病毒，然后立即将其删除。关键是，这取决于浏览器对文件的处理方式。

请注意，此政策是相反的。您的 HTML 页面在浏览器中看起来就像文件一样——它们都是“资源”。“资源”是“URL”中的“R”。当您通过访问 URL 访问 HTML 页面时，浏览器会认为“这是一个 HTML 资源。我该怎么办？哦，我可以在主窗口中显示它——我会这样做的。” 这与单击 URL 链接后下载 ZIP 文件的过程相同，它认为“这是一个 ZIP 资源。我该怎么办？我无法显示它——我想我会开始下载它并打开下载窗口，这样用户就可以看到发生了什么。” 如果您要求，大多数浏览器甚至允许您像下载文件一样下载页面的 HTML。

如果您的文件有多种格式，并且想让浏览器选择它可以查看的最佳格式，那么您可以使用[HTTP Accept 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)设置系统。例如，如果您同时拥有*my-program*的 ZIP 和 RAR 版本，那么您可以制作它以便您链接到 just`my-program`并且浏览器选择它最喜欢的版本。但是为此的设置可能很复杂，并且这种系统通常不需要仅用于文件下载。Accept 标头通常用于获取浏览器要*查看*的内容的正确版本——例如，浏览器可能会选择 MP4 视频文件而不是 WMV 视频文件，因为它没有任何可以播放嵌入式 WMV 的编解码器视频。

* * *

如果您想强制浏览器下载文件*，即使*浏览器可以自行查看文件，请参阅[此问题](https://stackoverflow.com/q/3238657/578288)。

# objective-c - 新的 Clang Objective-C 文字可以重定向到自定义类吗？

> ID：11252392
> 
> 赞同：19
> 
> 时间：2012-06-28T20:28:41.300
> 
> 标签：objective-c, clang, objective-c-literals

尽管 的重载`@`开始涉足危险领域，但我喜欢在 Clang 3.1 中添加新的 Objective-C 文字。不幸的是，新文字对我的用处有限。除了代码需要与 AppKit 交互的情况外，我大多放弃使用 Foundation 类，转而使用我自己的自定义框架（出于各种原因；其中大部分是我需要直接控制所使用的内存分配模式按对象）。

我总是可以使用一些运行时技巧将新创建的对象作为我的自定义类传递（这是我已经与字符串对象文字有关的事情，因为只有非 Apple GCC 运行时支持该`-fconstantstring=class`标志），但这是一个 hack充其量并抛出我通过替换等效的基础课程获得的所有好处。

与字符串对象字面量不同，Clang 实现的新字面量实际上并不是常量类（内存布局是硬编码的）；相反，适当的消息被发送到它们各自的类，以在运行时创建和初始化一个新对象。效果与您自己创建对象没有什么不同。从理论上讲，这意味着新文字所使用的类和调用的方法不是硬编码的。在实践中，我找不到任何方法将它们更改为指向我自己的自定义类和方法（事实上，我很乐意指向自定义类；在运行时将虚拟方法指向实际方法并不困难）。

当我第一次研究这个时，我真的希望找到一组可以用来做我所要求的标志，但由于我没有找到任何标志，我希望有人有一个解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-23T00:08:22.500

`@compatibility_alias`您可以用关键字技巧替换一些 Objective-C 文字的类。

这是一个例子。

```
@compatibility_alias NSNumber AAA; 
```

当然，您应该为新类提供正确的实现。

```
#import <Foundation/NSObject.h>

@interface  AAA : NSObject
+ (id)numberWithInt:(int)num;
@end

@implementation AAA
+ (id)numberWithInt:(int)num
{
    return  @"AAAAA!!!";    // Abused type system just to check result.
}
@end

@compatibility_alias NSNumber AAA; 
```

现在 Clang 将为您完成这项工作。我确认这适用于数字、数组、字典文字。不幸的是，字符串文字似乎是静态发出的，所以它不起作用。

有关`@compatibility_alias`关键字的更多信息，[请参见此处](https://stackoverflow.com/questions/178434/what-is-the-best-way-to-solve-an-objective-c-namespace-collision#180674)。

## 笔记

由于`@compatibility_alias`关键字是适用于当前编译单元的编译器指令，因此您需要将编译单元分开以避免与 Apple Foundation Kit 中的 NSObject 类的符号重复。这就是我的做法。

主文件

```
#import "test.h" // Comes before Foundation Kit.
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{
    @autoreleasepool
    {
        NSLog(@"return of test = %@", test());
        // insert code here...
        NSLog(@"Hello, World!");

    }
    return 0;
} 
```

测试.h

```
id test(); 
```

测试.m

```
#import "test.h"
#import <Foundation/NSObject.h>

@interface  
AAA : NSObject
+ (id)numberWithInt:(int)v;
+ (id)arrayWithObjects:(id*)pobj count:(int)c;
+ (id)dictionaryWithObjects:(id*)pvals forKeys:(id*)pkeys count:(int)c;
@end
@implementation AAA
+ (id)numberWithInt:(int)v
{
    return  @"AAAAA as number!!!";
}
+ (id)arrayWithObjects:(id*)pobj count:(int)c
{
    return  @"AAAAA as array!!!";
}
+ (id)dictionaryWithObjects:(id*)pvals forKeys:(id*)pkeys count:(int)c
{
    return  @"AAAAA as dictionary!!!";
}
@end

@compatibility_alias NSDictionary AAA;
@compatibility_alias NSArray AAA;
@compatibility_alias NSNumber AAA;

id test()
{
//  return  @{};
//  return  @[];
    return  @55;
} 
```

结果。

```
2013-03-23 08:54:42.793 return of test = AAAAA!!!
2013-03-23 08:54:42.796 Hello, World! 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-24T22:17:22.090

评论都正确，但只是总结一下：

*   不。

* * *

Apple 的 、 和文字的含义`@{}`被`@[]`硬`@""`编码到 Clang 中。你可以在这里看到它：http: [//llvm.org/viewvc/llvm-project/cfe/trunk/lib/AST/NSAPI.cpp](http://llvm.org/viewvc/llvm-project/cfe/trunk/lib/AST/NSAPI.cpp?view=markup) ?view=markup这都是相当模块化的，这意味着它不会很难Clang 黑客添加了她自己的文字语法……但“模块化”并不意味着“可从外部访问”。添加新语法甚至将现有语法重定向到新类肯定需要自己重建 Clang。

这是一篇关于`NSURL`通过对其内部进行黑客攻击来向 Clang 添加文字的博客文章：http: [//www.stuartcarnie.com/2012/06/llvm-clang-hacking-part-3.html](http://www.stuartcarnie.com/2012/06/llvm-clang-hacking-part-3.html)（感谢@Josh Caswell）

* * *

如果您愿意使用带有 C++11 扩展的 Objective-C++，您可以拥有“用户定义的文字”，它允许您编写类似的东西

```
NSURL *operator ""URL (const char *s) { return [NSURL URLWithString: @(s)]; }

int main() {
    ...
    NSURL *myurl = "ftp://foo"URL;
    ...
} 
```

Mike Ash 博客上的评论中提到了这一点。[http://www.mikeash.com/pyblog/friday-qa-2012-06-22-objective-c-literals.html](http://www.mikeash.com/pyblog/friday-qa-2012-06-22-objective-c-literals.html)但这看起来不太像 Objective-C-ish（或非常 C++ish！） ，并且它仅适用于 Objective-C++11 编译器，一般情况下请不要这样做。:)

# silverlight - Silverlight 应用程序中的命名空间冲突

> ID：11252393
> 
> 赞同：1
> 
> 时间：2012-06-28T20:28:43.903
> 
> 标签：silverlight, model-view-controller

我的应用程序具有以下结构：

*   myproject（主要 Silverlight 项目）
*   myproject.Web（应用程序的网站）
*   myproject.Controls（类库，所以我可以用控件做一些继承）
*   myproject.Classes（表示控件绑定到的数据的类）

将这些拆分为具有自己的子命名空间的项目似乎是一个好主意，但我遇到了很多耦合问题，这导致了循环依赖命名空间问题。

从我所做的小 iOS 开发来看，感觉有点像我正在尝试在这里推出我自己的 MVC 解决方案。在 Silverlight 应用程序中使用数据支持控件（基本上是表单）的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:37:57.257

如果命名空间和程序集名称匹配，这些项目看起来很好。您可以执行以下操作：

*   myproject.Classes 可以引用无
*   myproject.Controls 可以引用 myproject.Classes
*   myproject 可以引用 myproject.Controls 和 myproject.Classes
*   myproject.Web 可以引用 myproject.Classes，但不需要

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-28T21:10:26.597

*我建议在*主 Silverlight 应用程序本身（具有多个文件夹的单个项目）中进行拆分。除非您现在知道必须在不同 Silverlight 应用程序中重用类和控件名称空间中的代码，否则我会避免这样做。Silverlight 是 UI，您想要重用的任何内容都应该在项目的 ASP.NET 部分中（逻辑、数据库访问、业务规则等）。

如果您采用这种方法，您的 UI 将不会成为您脖子上的信天翁。

让您的 Silverlight 应用程序保持轻薄、快速和美观 - 我保证您不会后悔。

**编辑：** downvote让我意识到我不清楚（下面更清晰，更简洁的版本）：

不要将您的解决方案拆分为基于名称空间的项目——这会导致不必要的复杂化。在项目中使用命名空间来组织代码。将项目数量保持在最低限度，并且仅在有迫切需要时才拆分。

祝你好运！

# objective-c - UIViewController 的视图有奇怪的 20px y 边距

> ID：11252395
> 
> 赞同：11
> 
> 时间：2012-06-28T20:28:51.873
> 
> 标签：objective-c, ios, cocoa-touch

我正在将 UIViewController 的视图添加到另一个 UIViewController 的视图中（使用新的 UIViewController 包含 API）。在将 vc 的视图添加为另一个的 subivew 之后，从顶部有一个奇怪的 20px 边距。

我记录了视图，它的来源是 0,0。但是，当我记录视图的超级视图时，它是：

```
<UIViewControllerWrapperView: 0x6c5e2c0; frame = (0 20; 703 748); autoresize = RM+BM; layer = <CALayer: 0x6c54190>> 
```

我显然可以将它的框架更改为 0,0。但我想知道这样做的正确方法是什么？为什么vc的view的superview的frame是0,20？我应该修改这个还是有更好的方法来绕过这个奇怪的边距？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-28T13:17:28.290

To fix this problem just `check the box "Wants Full Screen"` on the storyboard.

The problem appears because the ParentViewController is showing the navigation bar.

As apple documentation said :

If your app displays the status bar, the view shrinks so that it does not underlap the status bar. After all, if the status bar is opaque, there is no way to see or interact with the content lying underneath it. However, if your app displays a translucent status bar, you can set the value of your view controller’s wantsFullScreenLayout property to YES to allow your view to be displayed full screen. The status bar is drawn over the top of the view.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-29T06:00:48.987

Found out what the problem was. Need to call addChildViewController: on self. So, here's the sequence of calls you need to make to get the containment to work properly:

```
[self addChildViewController:navVC];
[navVC didMoveToParentViewController:self];
[mainView addSubview:navVC.view]; 
```

self is the parent view controller. navVC is the child view controller you are adding. mainView is the view in parent view controller to which you ae going to add child view controller's view.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-13T14:55:58.497

I prefer the code below, works for me.

```
 [self.view setFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-09T11:20:11.097

### You need to add one line before first view controller load

```
- (void) viewDidLoad 
{
     self.automaticallyAdjustsScrollViewInsets = NO;
     [super viewDidLoad];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T21:17:05.673

即使您尝试将状态栏下拉菜单设置为“无”，也要检查视图的大小属性。确保它仍然没有硬编码的高度值 460，或 20 的 y 原点（在 Xcode 的图形设计器中）。如果您希望此视图填充其整个父视图，请确保在属性中设置自动调整大小蒙版以固定到所有侧面（顶部、左侧、底部、右侧），并且也可能设置为拉伸。

只需查看您的调试输出，看起来自动调整大小属性可能仅设置为`UIViewAutoresizingFlexibleBottomMargin`and `UIViewAutoresizingFlexibleRightMargin`。

最后，包含视图可能需要选中其**Autoresize Subviews**复选框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-05T05:40:52.323

Take a look at the wantsFullScreenLayout property. If set to YES the view will extend below the UIStatusBar.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-12T08:56:59.293

I had the same problem, but I solved it in IOS 9 by using constraints (in interface builder). I did not use full screen because it is deprecated. Add a leading and a trailingMargin constraint and give them the Constant -20

[![enter image description here](../Images/126d95c9cac635514675065788f27b90.png)](https://i.stack.imgur.com/To9lP.png)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-06-28T21:02:23.577

虽然我没有使用包含 API 的经验，但通过在 Identity Inspector 中将状态栏设置为 None（见下文），我已经解决了许多“20 岁以下”问题。

![](../Images/f88d37080b5422bd4617a9da0448771a.png)

* * *

## 回答 #9

> 赞同：-9
> 
> 时间：2013-07-22T21:20:21.307

Just use this viewport meta tag.

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> 
```

Putting "height=device-height" in there will cause this problem.

# ios - 为什么 instantiateViewControllerWithIdentifier: 不分配更多内存？

> ID：11252397
> 
> 赞同：2
> 
> 时间：2012-06-28T20:28:59.470
> 
> 标签：ios, uiviewcontroller, uistoryboard

根据[文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIStoryboard_Class/Reference/Reference.html)，`instantiateViewControllerWithIdentifier`“每次调用时都会创建指定视图控制器的新实例”。

我正在使用 Instruments 的 Activity Monitor 运行我的应用程序（使用 ARC），当我使用实例化之前实例化的 ViewController 时，我注意到内存使用量完全没有区别。

这是为什么？见`goToPreviousPage`下面的方法：

```
@implementation CBNavigator

int currentPage = 0;

-(IBAction)goToNextPage{
    [self dismissViewControllerAnimated:YES completion:^{
        currentPage++;
        UIViewController *nextPageVC = [self.storyboard instantiateViewControllerWithIdentifier:[NSString stringWithFormat:@"%d", currentPage ]];
        [self presentModalViewController:nextPageVC animated:YES];
    }];        
}

-(IBAction)goToPreviousPage{    
    [self dismissViewControllerAnimated:YES completion:^{
        currentPage--;
        UIViewController *previousPageVC = [self.storyboard instantiateViewControllerWithIdentifier:[NSString stringWithFormat:@"%d", currentPage ]];
        [self presentModalViewController:previousPageVC animated:YES];
    }];
}
@end 
```

# r - XPath在R中的br标签之后提取文本

> ID：11252407
> 
> 赞同：11
> 
> 时间：2012-06-28T20:29:36.443
> 
> 标签：r, xpath

如何`br`在以下行中的标签后提取文本：

```
<div id='population'>
    The Snow Leopard Survival Strategy (McCarthy <em>et al.</em> 2003, Table
    II) compiled national snow leopard population estimates, updating the work
    of Fox (1994). Many of the estimates are acknowledged to be rough and out
    of date, but the total estimated population is 4,080-6,590, as follows:<br>
    <br>
    Afghanistan: 100-200?<br>
    Bhutan: 100-200?<br>
    China: 2,000-2,500<br>
    India: 200-600<br>
    Kazakhstan: 180-200<br>
    Kyrgyzstan: 150-500<br>
    Mongolia: 500-1,000<br>
    Nepal: 300-500<br>
    Pakistan: 200-420<br>
    Russia: 150-200<br>
    Tajikistan: 180-220<br>
    Uzbekistan: 20-50
</div> 
```

我做到了：

```
xpathSApply(h, '//div[@id="population"]', xmlValue) 
```

但我现在被困住了......

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-28T20:54:40.997

如果您意识到文本也是一个节点，它会有所帮助。div 中的所有文本`<br/>`都可以通过以下方式检索：

```
//div[@id="population"]/text()[preceding-sibling::br] 
```

从技术上讲，标签*之间* `<br/>`意味着：

```
//div[@id="population"]/text()[preceding-sibling::br and following-sibling::br] 
```

...但我想这不是你现在想要的。

# asp.net - 为什么在 ASP.Net 中单击按钮后字段的值会被删除？

> ID：11252409
> 
> 赞同：1
> 
> 时间：2012-06-28T20:29:44.950
> 
> 标签：asp.net

在单击一个 asp 按钮以单击另一个 asp 按钮后，我需要一个字段来存储一些信息。

我看到它不起作用，所以我编写了以下简单的页面代码隐藏（认为可能是我的一些代码导致了它）但在这里我可以看到该字段确实被重新初始化。

我想每个按钮单击都会重新加载页面。这是真的？如果是这样 - 如果没有静态变量，如何解决这个问题（因为如果不止一个人同时访问同一个页面怎么办......）？

```
public partial class _Default : System.Web.UI.Page
{
    string s = "a";

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Button1_Click(object sender, EventArgs e)
    {
        s = "b";
    }

    protected void Button2_Click(object sender, EventArgs e)
    {
        here.InnerText = s;// "here" is an id.
        //returns "a" despite Button1 having been clicked before.
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:32:39.707

添加您的代码（EnableViewState）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:33:45.197

每次您请求（获取或发布）页面时，都会创建（然后销毁）`_Default`类的新实例（派生），包含的控件也会发生同样的情况。`System.Web.UI.Page`

请参阅[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。

> 当 ASP.NET 页面运行时，页面会经历一个生命周期，在该生命周期中它会执行一系列处理步骤。其中包括初始化、实例化控件、恢复和维护状态、运行事件处理程序代码和呈现。了解页面生命周期对您来说很重要，这样您就可以在适当的生命周期阶段编写代码以获得您想要的效果。

您可以使用不同的技术（cookie、会话、缓存、视图状态等）持久化一个值（在您的情况下是 field 的值`s`），另请参见[ASP.NET 状态管理概述](http://msdn.microsoft.com/en-us/library/75x4ha6s.aspx)。

# javascript - 按字母顺序对 Backbone 集合进行排序

> ID：11252417
> 
> 赞同：13
> 
> 时间：2012-06-28T20:30:05.387
> 
> 标签：javascript, backbone.js, underscore.js

有没有办法使用 _.sortBy 方法或库的任何其他部分开箱即用地做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-28T20:35:32.493

你的意思是[这样](http://jsfiddle.net/uHtUX/)吗？

```
var array = [
    { name: "banana" },
    { name: "carrot" },
    { name: "apple" }
];

var sorted = _(array).sortBy("name"); 
```

我会说它开箱即用。

如果你想对一个普通的*字符串*数组进行排序，你可能只想使用[`sort`](http://www.w3schools.com/jsref/jsref_sort.asp)：

```
var flatArray = ["banana", "carrot", "apple"];

flatArray.sort(); 
```

见[这里](http://jsfiddle.net/uHtUX/1/)。也有效。

请注意，下划线`sortBy`返回一个已排序的*新*数组，其中 JavaScript 的内置`sort`函数对数组进行了适当的排序。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-28T20:40:28.177

由于您使用backbone.js 标签标记了您的问题，我假设您的意思是对集合进行排序，您只需要在您的集合上提供一个[比较器](http://backbonejs.org/#Collection-comparator)功能，并且主干将保持集合排序。

如果您的问题特别是按字母排序，我相信这是默认排序，来自主干.js 文档（我在上面链接到它）

```
chapters.comparator = function(chapter) {
  return chapter.get("page");
}; 
```

# php - PHP cURL 不包含主机 http 标头

> ID：11252421
> 
> 赞同：0
> 
> 时间：2012-06-28T20:30:18.347
> 
> 标签：php, curl

执行请求时，PHP 的 curl 似乎不包含 Host 标头：

```
<?php
    $handle = curl_init('http://example.com/');
curl_setopt_array($handle, array(
    CURLOPT_USERAGENT => 'test ua',
    CURLOPT_REFERER => 'http://example.org/',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_PROXY => '127.0.0.1:8080',
    CURLOPT_PROXYTYPE => CURLPROXY_HTTP,

    //Doesn't work if you specify it manually or leave it out:
    CURLOPT_HTTPHEADER => array(
        'Host: example.com'
    )
));

print_r(curl_getinfo($handle));
echo curl_exec($handle);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:36:16.270

主机头由[curl_init](http://php.net/manual/en/function.curl-init.php) ()的参数定义

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:38:50.560

当`Host`您指定请求 URL 时，标头已由 PHP 自动生成。

以下示例应该足以确认：

```
<?php
$handle = curl_init('http://pgl.yoyo.org/http/browser-headers.php');
curl_setopt($handle, CURLOPT_RETURNTRANSFER, true);

echo curl_exec($handle);
?> 
```

`Host: pgl.yoyo.org`输出 HTML按预期列出了请求标头，其中我们看到了 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:04:25.320

这是一个完全不相关的错误，它是由用户代理内部的换行符发生的，例如：

```
curl_setopt_array($handle, array(
    CURLOPT_USERAGENT => "user-agent\n"
)); 
```

# javascript - 编写 JSON 解析器以格式化饼图（HighCharts）的数据

> ID：11252424
> 
> 赞同：2
> 
> 时间：2012-06-28T20:30:33.530
> 
> 标签：javascript, jquery, json, parsing, highcharts

为了格式化选项的数据输入，我与 HighCharts 争论了好几个小时`series`。最后我看到[**这里**](https://stackoverflow.com/a/8216335/1413598)的链接解决了我的数据格式化和输入问题。

HighCharts 饼图可以识别的数据格式是这样`(format 1)`的，如上面的链接所示：

```
[["chrome",15],["firefox",20]] 
```

我实际上想要从外部 URL 输入**动态**数据并格式化数据，以便 HighCharts 可以识别它。我从 URL 得到的数据格式是这样的`(format 2)`：

```
[
    {
        "status": "Stopped \/ Idle",
        "val": 17.469444444444,
    }, {
        "status": "Working",
        "val": 0,
    }, {
        "status": "Headland Turning",
        "val": 0,
    }, {
        "status": "Transport",
        "val": 0.15333333333333,
    }
] 
```

这已经是 JSON 格式了。

我只是想知道我有必要为 to 的数据编写解析器`format 2`吗`format 1`？或者我是否缺少 HighCharts 可以识别 JSON 格式数据并且我实际上不需要编写解析器的东西？

我是 HighCharts 的新手，所以如果我的一些问题描述没有意义，请随时指出。谢谢！

**编辑**：感谢所有回答我问题的人！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:53:05.663

当脚本需要特定格式的数据时，您通常必须将数据映射到适合格式。这可以在服务器代码中修改或使用 javascript

可以使用 jQuery`$.map`将一个对象或数组重新配置为另一个数组。

演示：http: [//jsfiddle.net/qpsSe/1](http://jsfiddle.net/qpsSe/1)

**请注意，示例 JSON 中的尾随逗号需要删除以验证 JSON**

```
/* "json" is your response object, modify variable names to match */
var chartData=$.map( json, function( obj,i){
        return [[ obj.status, obj.val]];                            
}) 
```

**[$.map API 文档](http://api.jquery.com/jQuery.map/)**

本机javascript中的替代方法

```
var chartData=[];
for( i=0; i<json.length; i++){
   chartData.push( [ json[i]['status'], json[i]['val'] ])
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:36:23.913

AFAIK 这正是 Highcharts 想要其数据的方式。话虽如此，解析器非常简单：

```
var data;  // this is your received data
var highchartsData = []; // this is data for highcharts

$.each(data, function(i, e) {
    highchartsData.push([e.status, e.val]);
}); 
```

需要注意的一点是，如果您收到的数据是文本形式的（例如，来自 AJAX 调用的响应），那么您需要将其转换为 javascript 对象，如下所示：

```
var data = $.parseJSON(textData); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:25:01.350

[如HighCharts 预处理](http://www.highcharts.com/documentation/how-to-use#preprocessing)中所述，您需要在分配选项时制作解析器 基本上，您解析数据并将其包含在选项中：

```
var serie1 = json.map( function(e) {
    return [e.status, e.val];
});
options.series.push({data: serie1}); 
```

[这是一个使用 $.map 和 Fiddle 中的选项的工作示例](http://jsfiddle.net/pdejuan/SREcf/6/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-10T15:05:13.963

从 Highcharts 3.0 开始，还可以通过为每个点命名并将轴类型设置为“类别”来提取类别。

对于柱形图，这将是：

```
 xAxis: {
        type: 'category',
    },

    series: [{
        data: [{
            name: 'Point 1',
            color: '#00FF00',
            y: 1
        }, {
            name: 'Point 2',
            color: '#FF00FF',
            y: 5
        }]
    }] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-20T09:32:28.783

您可以直接将图表与 JSON 数据绑定。您只需将 json 属性名称设置为 highchart 标准。'Y' 表示值，'name' 表示标签。

您的 JSON 应如下所示：

```
[
    {
        name: "Stopped \/ Idle",
        y: 17.469444444444
    }, {
        name: "Working",
        y: 0
    }, {
        name: "Headland Turning",
        y: 0
    }, {
        name: "Transport",
        y: 0.15333333333333
    }
] 
```

# objective-c - Objective-C 属性 - getter 行为

> ID：11252433
> 
> 赞同：6
> 
> 时间：2012-06-28T20:31:01.033
> 
> 标签：objective-c, properties, getter

以下内容在技术上存在什么问题：

```
@property(nonatomic, assign) NSUInteger timestamp;
@property(nonatomic, readonly, getter = timestamp) NSUInteger startTime;
@property(nonatomic, assign) NSUInteger endTime; 
```

我确信我可以找到一种更好的方法来组织它，但这就是我在项目中的某个时刻得到的结果，我注意到**访问 startTime 属性总是返回 0，即使时间戳属性设置为正确的时间戳**.

似乎已将 startTime 的 getter 设置为现有属性（时间戳），当我这样做时它不会转发时间戳的值：

```
event.startTime => 0
event.timestamp => 1340920893 
```

顺便说一下，所有这些都是时间戳。

只是提醒一下，我知道上述情况应该发生在我的项目中，但我不明白为什么访问 startTime 不会转发到时间戳属性。

更新

在我的实现中，我正在综合所有这些属性：

```
@synthesize timestamp, endTime, startTime; 
```

请查看我在 GitHub 上的 gist 中演示的示例对象：[https ://gist.github.com/3013951](https://gist.github.com/3013951)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:06:32.980

在您的描述方法中，您没有使用该属性，而是在访问 ivar。

```
-(NSString*) description
{
    return [NSString stringWithFormat:@"Event< timestamp:%d, start:%d >", 
             timestamp, 
             startTime]; // <-- This is accessing the instance variable, not the property.
} 
```

这将为您工作：

```
-(NSString*) description
{
    return [NSString stringWithFormat:@"Event< timestamp:%d, start:%d >", 
             timestamp, 
             self.startTime]; // <-- This is using the property accessor.
} 
```

property-vs-ivar 的事情总是把人们搞得一团糟，所以请原谅我在闲聊一分钟。:) 如果您已经知道所有这些，请跳过。

当您创建和合成一个属性时，就像上面所做的那样，会发生两件事：

1.  一个 ivar 被创建为正确的类型。
2.  创建了一个 getter 函数，该函数返回该 ivar。

关于第 2 点的重要部分是，默认情况下，*ivar 和 getter 函数（因此，属性）具有相同的名称*。

所以这：

```
@interface Event
@property(nonatomic, assign) NSUInteger timestamp;
@property(nonatomic, readonly, getter = timestamp) NSUInteger startTime;
@end

@implementation Event
@synthesize timestamp, startTime;
@end 
```

...变成这样：

```
@interface Event {
    NSUInteger timestamp;
    NSUInteger startTime;
}
@end

@implementation Event
- (NSUInteger) timestamp {
    return timestamp
}

- (void) setTimestamp:(NSUInteger) ts {
    timestamp = ts;
}

- (NSUInteger) startTime {
    return [self timestamp];
}
@end 
```

点语法的工作原理是这样的：

```
NSUInteger foo = myEvent.startTime; 
```

真的

```
NSUInteger foo = [myEvent startTime]; 
```

综上所述，当您访问 ivar 时，您就是在……嗯，访问 ivar。当您使用属性时，您正在调用一个返回值的函数。更重要的是，当你想要做另一件事时，做一件事是非常容易的，因为语法非常相似。正是由于这个原因，许多人经常用前导下划线合成他们的 ivars，这样就更难搞砸了。

```
@property(nonatomic, assign) NSUInteger timestamp;
@property(nonatomic, readonly, getter = timestamp) NSUInteger startTime;

@synthesize timestamp = _timestamp;
@synthesize startTime = _startTime;

NSLog( @"startTime = %d", _startTime );  // OK, accessing the ivar.
NSLog( @"startTime = %d", self.startTime );  // OK, using the property.
NSLog( @"startTime = %d", startTime );  // NO, that'll cause a compile error, and 
                                        // you'll say "whoops", and then change it 
                                        // to one of the above, thereby avoiding
                                        // potentially hours of head-scratching.  :) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:40:48.263

确保以正确的顺序进行合成，以便 getter 存在于`startTime`.

```
//implementation
@synthesize timestamp;
@synthesize statTime; 
```

# python - Google App Engine 开发服务器中的 PyCrypto “ImportError: cannot import name blockalgo”

> ID：11252436
> 
> 赞同：5
> 
> 时间：2012-06-28T20:31:10.250
> 
> 标签：python, google-app-engine, jinja2, pycrypto

我有一个使用 PyCrypto 使用 AES 加密字符串的函数。当我在单元测试中调用该函数时，一切正常。在生产环境中，它也可以正常工作。但是，在 GAE 开发服务器上调用该函数时，会抛出错误：“ImportError: cannot import name blockalgo”。我在 Windows 7（64 位）和 Mac OS 10.5 上对其进行了测试。两者都导致相同的错误。我正在使用带有 Python 2.7 的 Google App Engine。可能是什么问题呢？

应用程序.yaml

```
application: xxx
version: 6
runtime: python27
api_version: 1
threadsafe: true

libraries:
- name: django
  version: "1.2"
- name: webapp2
  version: "2.3"
- name: jinja2
  version: "2.6"
- name: pycrypto
  version: "2.3"
- name: PIL
  version: "1.1.7"

builtins:
- appstats: on
- remote_api: on

inbound_services:
- mail
- warmup 
```

加密功能：

```
def encrypt(plaintext):
    from Crypto.Cipher import AES
    import hashlib

    password = 'xxx'
    key = hashlib.sha256(password).digest()

    mode = AES.MODE_ECB
    encryptor = AES.new(key, mode)

    BLOCK_SIZE = 16
    PADDING = '{'
    pad = lambda s: s + (BLOCK_SIZE - len(s) % BLOCK_SIZE) * PADDING
    EncodeAES = lambda c, s: b58encode(c.encrypt(pad(s)))

    encrypted = EncodeAES(encryptor, plaintext)

    if len(encrypted) < 22:
        for i in range (len(encrypted), 22):
            encrypted += "_"
    return encrypted 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-29T16:44:01.790

确保本地系统上安装的 PyCrypto 版本与 app.yaml 中指定的版本相同。在将软件包升级到最新版本之前请三思。

# drupal - 在 Drupal 6 中，我用来覆盖 user_pas_submit 的钩子是什么？

> ID：11252437
> 
> 赞同：1
> 
> 时间：2012-06-28T20:31:20.607
> 
> 标签：drupal, drupal-6

我需要一些额外的功能添加到 user_pass_submit。必须在不更改核心的情况下添加它。我会用什么钩子来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T23:45:50.430

您应该能够使用您自己的模块副本`hook_form_FORM_ID_alter()`替换表单的提交处理程序，并根据需要进行更改。`user_pass``user_pass_submit`

像这样的东西...

```
function MODULE_form_user_pass_alter(&$form, &$form_state) {
  $form['#submit'] = array('MODULE_user_pass_submit');
}

function MODULE_user_pass_submit($form, &$form_state) {
  global $language;

  $account = $form_state['values']['account'];
  // Mail one time login URL and instructions using current language.
  _user_mail_notify('password_reset', $account, $language);
  watchdog('user', 'Password reset instructions mailed to %name at %email.', array('%name' => $account->name, '%email' => $account->mail));
  drupal_set_message(t('Further instructions have been sent to your e-mail address.'));

  $form_state['redirect'] = 'user';
  return;
} 
```

当然，如果您有多个模块尝试这样做，这就会失败

# ruby - 如何解决在 ruby 中无法通过引用传递的问题？

> ID：11252439
> 
> 赞同：0
> 
> 时间：2012-06-28T20:31:26.057
> 
> 标签：ruby, arrays, pass-by-reference

我的问题是我无法在 Ruby 中通过引用传递。我有两个功能`searching`和`get_title_ids`.

我有两个数组`searching`

(1) 标题 (2) href
需要*更新*。

```
def searching
    title = []
    href = []
    (0..20).step(10) do |i|
        prev= title.length
        title, href = get_title_ids(i, title, href) ## <<-- Should have just done "get_title_ids(i, title, href)"
        ## something which on next iteration will increase the ids and hrefs
        puts "\nthe title lenght is #{title.length} and href length is #{href.length}\n"
        assert_operator prev,:<,title.length,"After scrolling to bottom no new jobs are getting added" 
    end
end

def get_title_ids (start_from=0, title=[], href=[])
    #Part of code which can store all links and titles of jobs displayed
    (start_from..(titles.length-1)).each do |i|
            unless titles[i].text.chomp
                title << titles[i].text.chomp
                href << titles[i].attribute("href")
            end     
        end
    end
    return [title, href] ### <<---- this is what messed it up
end 
```

问题是我无法将`push` *新*元素添加到数组中`title`并且`href`已经在`searching`.

每次我打电话时`get_title_ids`，我都不想收集我以前收集的数据（因此是 start_form）。

我的问题不是记忆而是时间。所以我不太担心调用`get_title_ids` 函数时数据被复制，而不是我不得不浪费时间来报废我在前一个 for 循环中已经报废的数据。

任何人都知道如何在 Ruby 中通过引用破解通行证。

## 编辑

所以通过阅读下面的问题，我发现我不需要执行`return`from `get_title_ids`。然后这一切都奏效了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:40:36.347

ruby 中的数组肯定是按引用传递的（从技术上讲，它们是按值传递的，但该值是指向数组的指针）。观察：

```
def push_new ary
  ary << 'new element'
end

a = ['first element']
push_new a
a # => ["first element", "new element"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:43:03.807

即使引用类型的对象是按值传递的，它仍然是在引用内存中的同一个对象。如果不是这种情况，那么下面的示例将不起作用。

例子：

```
> def searching
>   title = []
>   href = []
>   test(title, href)
>   puts "Title: #{title.inspect} Href: #{href.inspect}"
> end

> def test(title, href)
>   title << "title1"
>   title << "title2"
>   href << "www.title1.com"
>   href << "www.title2.com"
> end

> searching

Title: ["title1", "title2"] Href: ["www.title1.com", "www.title2.com"] 
```

# c# - C# COM Interop Excel：在文本字符串中保留前导零

> ID：11252441
> 
> 赞同：0
> 
> 时间：2012-06-28T20:31:43.043
> 
> 标签：c#, excel, formatting, interop, com-interop

我正在输出一个 Excel 工作表，其中包含hh:mm:ss 形式的**字符串**。但是，Excel 认为删除任何前导零是合适的，即使它们是文本。我试过 myRange.NumberFormat = "@" 但这会导致奇怪的十进制表示。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:41:55.067

问得太早了。设置 range.NumberFormat = "hh:mm:ss" 可以做到这一点，而不会影响该列中的其他字符串。

# silverlight - Silverlight：更改绘制对象的属性。-- 应该很容易以及如何调试代码

> ID：11252444
> 
> 赞同：0
> 
> 时间：2012-06-28T20:32:12.327
> 
> 标签：silverlight

假设我有一个在 Blend 中创建的 silverlight 矩形。如何更改对象的背景填充。

XAML

```
<Rectangle x:Name="Background" Stroke="Black" StrokeThickness="0" Height="480" Width="640">
            <Rectangle.Fill>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="Black" Offset="0"/>
                    <GradientStop Color="White" Offset="1"/>
                    <GradientStop Color="#FED40707" Offset="0.164"/>
                    <GradientStop Color="#FED5EB0E" Offset="0.392"/>
                    <GradientStop Color="#FE849AF4" Offset="0.595"/>
                    <GradientStop Color="#FE2C9937" Offset="0.797"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle> 
```

## .cs 文件

```
Rectangle Background = new Rectangle();
string fileName = "Images/yello.png";
BitmapImage image = new BitmapImage(new Uri(fileName, UriKind.Relative));
ImageBrush brush = new ImageBrush();
brush.ImageSource = image;
Background.Fill = brush;
Background.UpdateLayout(); 
```

这运行但没有任何反应。另外我该如何调试这段代码。我将项目文件加载到 VS 2012 中，但是当它运行时它不会在断点处停止。

## 也试过：

Background.Fill = new SolidColorBrush(Colors.Red);

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T06:00:58.540

您的 .cs 代码失败，因为您正在新建一个名为 的矩形`Background`，这与 XAML 文件中名为 Background 的元素无关。

*当您在 XAML 文件中命名元素时，将在设计器文件中生成该名称的 C# 成员，并且该属性连接到 XAML 元素（通过按加载的 XAML 元素树的名称进行搜索）。这意味着所有命名元素都可以在后面的代码中简单地作为属性引用。*查看您的设计器文件，了解幕后发生的事情。

删除该`Rectangle Background = new Rectangle();`行并重试。你也不应该需要打电话`Background.UpdateLayout();`

您可能还想为矩形元素选择另一个名称，而不是，因为这可能会导致与所有元素`Background`的属性混淆`Background``Panel`

可能还有其他问题，但最好先解决这些问题 :)

# ruby-on-rails - 使用 Timecop 的意外 Rspec 结果

> ID：11252448
> 
> 赞同：0
> 
> 时间：2012-06-28T20:32:19.373
> 
> 标签：ruby-on-rails, rspec, timecop

这是规范的基本思想：

```
before :each do
  Timecop.freeze(Time.local(2012, 07, 01, 12, 0, 0)) #frozen at July 1st, 2012 at noon
  #create record code
end
it 'shows how long ago the message was recieved' do
  Timecop.travel(Time.local(2012, 07, 02, 12, 0, 0)) #move to July 2nd
  page.should have_content "1 day ago"
end
after :each do
  Timecop.return #release freeze
end 
```

它出错了：

```
expected there to be content "1 day ago" in "less than a minute ago" 
```

我正在展示`<%= "#{time_ago_in_words(m.created_at)} ago" %>`我希望完全不同的 24 小时。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:05:49.253

问题是误解了旅行方法与冻结方法的目的。

冻结在选定的时刻停止时间，旅行将时间设置到选定的时刻，但它从那里自由移动。

我通过在示例中将 Travel 替换为 Freeze 解决了这个问题。

# nhibernate - 使用 S#arp 架构的 SQL Azure 联合

> ID：11252453
> 
> 赞同：2
> 
> 时间：2012-06-28T20:32:42.590
> 
> 标签：nhibernate, azure-sql-database, s#arp-architecture, sharp-architecture, federation

我正在使用 S#harp 架构，有没有人找到使用它访问 SQL Azure 联合的方法？

我知道以下命令必须在事务之外执行，因为 SQL Azure 不允许在事务中“使用联合”语句。

```
use Federation CustomerFederation (CustomerID=2) with reset, filtering=on 
GO
<some sql statement...>
GO 
```

这里还有一篇文章展示了一个创建自定义 NHibernate Session 类的示例，但是如何使用 S#arp 架构来完成/扩展呢？

我还知道 SQL Azure 联合还有其他分片选项，例如 NHibernate.Shards 或多租户 S#arp 架构扩展，但请继续回答这个问题，而不是提供其他选项。

我知道我不是唯一使用 S#arp Architecture 和 SQL Azure Federations 的人，而且 Google 没有提供太多，所以如果其他人找到了解决方案，请分享。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T20:04:21.710

由于还没有人回复我的帖子，所以经过几天的研究，我正在回复它。我能够与具有 1 个接口和 3 个类的 S#harp 集成（我希望它们是一个开箱即用的解决方案？）。

下面提供的代码可以复制并粘贴到任何应用程序中，它应该可以正常工作。唯一的例外是 FederationSessionHelper 类。这是特定于每个应用程序的，因为您获得的信息可能会发生变化。我的 web.config 中有一个应用程序设置部分，其中包含联合名称等。此外，当用户进行身份验证时，我会解析他们来自的根 url，然后查询联合根以找出它们是什么租户（我有一个我创建的自定义租户表）。然后，我将租户 ID 放在密钥“FederationKeyValue_Key”下的会话中，然后将在 FederationSession 类中使用它来构建 Use Federation 语句。

```
/// <summary>
/// Interface used to retrieve app specific info about your federation.
/// </summary>
public interface IFederationSessionHelper
{
    string ConnectionString { get; }
    string FederationName { get; }
    string DistributionName { get; }
    string FederationKeyValue { get; }
}

/// <summary>
/// This is were you would get things specific for your application. I have 3 items in the web.config file and 1 stored in session. You could easily change this to get them all from the repository or wherever meets the needs of your application.
/// </summary>
public class FederationSessionHelper : IFederationSessionHelper
{
    private const string ConnectionStringKey = "ConnectionString_Key";
    private const string FederationNameKey = "FederationName_Key";
    private const string DistributionNameKey = "DistributionName_Key";
    private const string FederationKeyValueKey = "FederationKeyValue_Key";

    public string ConnectionString { get { return ConfigurationManager.ConnectionStrings[ConnectionStringKey].ConnectionString; } }
    public string FederationName { get { return ConfigurationManager.AppSettings[FederationNameKey]; } }
    public string DistributionName { get { return ConfigurationManager.AppSettings[DistributionNameKey]; } }

    //When user authenitcates, retrieve key value and store in session. This will allow to retrieve here.
    public string FederationKeyValue { get { return Session[FederationKeyValueKey]; } }       
}

/// <summary>
/// This is were the magic begins and where the integration with S#arp occurs. It manually creates a Sql Connections and adds it the S#arps storage.  It then runs the Use Federation command and leaves the connection open. So now when you use an NhibernateSession.Current it will work with Sql Azure Federation.
/// </summary>
public class FederationSession : IDisposable
{
    private SqlConnection _sqlConnection;

    public void Init(string factoryKey,
                       string federationName,
                       string distributionName,
                       string federationKeyValue,
                       bool doesFilter,
                       string connectionString)
    {
        var sql = string.Format("USE FEDERATION {0}({1} = '{2}') WITH RESET, FILTERING = {3};", federationName, distributionName, federationKeyValue, (doesFilter) ? "ON" : "OFF");
        _sqlConnection = new SqlConnection(connectionString);

        _sqlConnection.Open();
        var session = NHibernateSession.GetSessionFactoryFor(factoryKey).OpenSession(_sqlConnection);
        NHibernateSession.Storage.SetSessionForKey(factoryKey, session);

        var query = NHibernateSession.Current.CreateSQLQuery(sql);
        query.UniqueResult();
    }

    public void Dispose()
    {
        if (_sqlConnection != null && _sqlConnection.State != ConnectionState.Closed)
            _sqlConnection.Close();
    }
}

/// <summary>
/// This was just icing on the cake.  It inherits from S#arps TransactionAttribute and calls the FederationSession helper to open a connection.  That way all you need to do in decorate your controller with the newly created [FederationTransaction] attribute and thats it.
/// </summary>
public class FederationTransactionAttribute : TransactionAttribute
{
    private readonly string _factoryKey = string.Empty;
    private bool _doesFilter = true;

    /// <summary>
    ///     When used, assumes the <see cref = "factoryKey" /> to be NHibernateSession.DefaultFactoryKey
    /// </summary>
    public FederationTransactionAttribute()
    { }

    /// <summary>
    ///     Overrides the default <see cref = "factoryKey" /> with a specific factory key
    /// </summary>
    public FederationTransactionAttribute(string factoryKey = "", bool doesFilter = true)
        : base(factoryKey)
    {
        _factoryKey = factoryKey;
        _doesFilter = doesFilter;
    }        

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var federationSessionHelper = ServiceLocator.Current.GetInstance<IFederationSessionHelper>();
        var factoryKey = GetEffectiveFactoryKey();
        new FederationSession().Init(factoryKey,
                                        federationSessionHelper.FederationName,
                                        federationSessionHelper.DistributionName,
                                        federationSessionHelper.FederationKeyValue,
                                        _doesFilter,
                                        federationSessionHelper.ConnectionString);

        NHibernateSession.CurrentFor(factoryKey).BeginTransaction();
    }

    private string GetEffectiveFactoryKey()
    {
        return String.IsNullOrEmpty(_factoryKey) ? SessionFactoryKeyHelper.GetKey() : _factoryKey;
    }        
} 
```

现在我可以用新创建的 [FederationTransaction] 替换 S#arp 的 [Transaction] 属性，如下所示：

```
[HttpGet] 
[FederationTransaction]
public ActionResult Index()
{
   var viewModel = NHibernateSession.Current.QueryOver<SomeDemoModel>().List()
   return View(viewModel);            
} 
```

控制器中的任何代码都不需要知道它使用 Sql Azure 联合。这一切都应该正常工作。

有什么想法吗？有人找到更好的解决方案吗？请分享。

# javascript - Javascript createElement 和 appendchild 一步到位

> ID：11252455
> 
> 赞同：2
> 
> 时间：2012-06-28T20:32:50.533
> 
> 标签：javascript, appendchild, createelement

我想创建一个元素，然后一步将其与其他元素一起附加。

```
var header = document.createElement("thead").appendChild(document.createElement("tr")); 
```

为什么此代码输出唯一的 TR 而不是 Thead？

当我使用此代码时，它是正确的（thead + tr 在那里）

```
var header = CH.createElement("thead");
    header.appendChild(CH.createElement("tr")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:34:31.673

因为[`Node.appendChild()`](https://developer.mozilla.org/en/DOM/Node.appendChild)返回*附加的孩子*......

```
var appendedChild = element.appendChild(child); 
```

..你可以简单地引用孩子的[`parentNode`](https://developer.mozilla.org/en/DOM/Node.parentNode)像这样（[示例小提琴](http://jsfiddle.net/ad3Tp/1)）：

```
var header = document.createElement("thead")
    .appendChild(document.createElement("tr"))
    .parentNode; // the row's parentNode, i.e.: thead 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:44:08.453

@antisanity 有一个很好的解决方案。如果您的变量是预先声明的，另一种解决方案是这样做......

```
(header = document.createElement('thead'))
      .appendChild(document.createElement('tr')); 
```

这可确保分配 to`header`发生在`.appendChild()`.

# grails - 如何在 Grails 中保存多部分表单；文本和文件上传

> ID：11252458
> 
> 赞同：-1
> 
> 时间：2012-06-28T20:33:10.983
> 
> 标签：grails, multipart

我正在尝试提交带有上传文件的表单条目，但我似乎无法让控制器正确保存数据。

本质上，我想以一种形式发布标题和上传的源。

我的域类的一个例子：

```
class Image {
    String caption
    Date dateCreated
    Date lastUpated
    String source
} 
```

我不知道如何存储源文件并保存条目。

这是我到目前为止所做的：

```
def upload () {
    def f = request.getFile('source')
    f.transferTo(new File("/path/to/file.tmp"))
    return
}
def save () {
    upload()
    def img = new Image(params)
    img.save(flush: true)
    ...runtime exception...
} 
```

文件创建工作，但显然保存图像条目的详细信息不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T13:09:40.440

考虑回答这个问题。问题不在于 Grails，而是我未能安装将数据插入数据库所需的插件的微小细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-30T19:16:01.797

请参阅此源代码[Grails 文件上传示例](https://github.com/cavneb/FileUploader)或此演示文稿[Uploading files with Grails](http://www.slideshare.net/cavneb/upload-files-with-grails)。

希望这可以帮助

# c++ - 求解矩阵中的高斯消元问题

> ID：11252463
> 
> 赞同：1
> 
> 时间：2012-06-28T20:33:25.850
> 
> 标签：c++, gaussian

```
float aMatrix[10][11];
float bMatrix[10]; 
```

// 这样调用... `solveMatrix(aMatrix, bMatrix, actualCol);`

```
float* solveMatrix(float aMatrix[][DEFCOLS+1],float bMatrix[DEFCOLS], size_t cols){
    std::cout << "\nInside solveMatrix...: " << endl;
    size_t N2 = cols;

std::cout << "\N2 is...: " << N2 << endl;
for(size_t p=0; p<N2; p++){
    //std::cout << "\nInside 1st for loop...: " << endl;
    // find pivot row and swap
    int max = p;

    for(size_t i=p+1; i<N2; i++){
        //std::cout << "\nInside 2nd for loop...: " << endl;
        if ( abs(aMatrix[i][p]) > abs(aMatrix[max][p]) ){
            max = i;
        }
    }

    //std::cout << "\nJust b4 all the swapping...: " << endl;

    float temp[] = { *aMatrix[p] };
    *aMatrix[p] = *aMatrix[max];

    *aMatrix[max] = *temp;

    float t = bMatrix[p];
    bMatrix[p] = bMatrix[max];

    bMatrix[max] = t;
    //std::cout << "\nDone all the swapping...: " << endl;

    if ( abs(aMatrix[p][p]) <= MINISCULE) {
        //std::cout << "***** Error matrix value too small. Matrix is singular" << endl;
        //exit;
    }

    //std::cout << "\nJust the pivoting...: " << endl;

    // Pivot /in A and b
    for(size_t i=p+1; i<N2; i++){
        //std::cout << "\nInside the 1st pivoting loop...: " << endl;

        //std::cout << "\nAbout to do the  [aMatrix[p][p]] division in back subst..: " << endl;
        float alpha = aMatrix[i][p] / aMatrix[p][p];

        bMatrix[i] = alpha * bMatrix[p];

        for(size_t j=p; j<N2; j++){
            //std::cout << "\nInside the 2nd pivoting loop...: " << endl;
            aMatrix[i][j] -= alpha * aMatrix[p][j];
        }

    }
    std::cout << "\nAbout to do the back subst..: " << endl;
    // back subst.
    float outMatrix[DEFROWS] = {0.0};

    for(size_t i=N2-1; i>=0; i--){
        std::cout << "\nInside the 1st back subst for loop..: " << endl;
        float sum = 0.0;

        for(size_t j=i+1; j<N2; j++){
            std::cout << "\nInside the 2nd back subst for loop..: " << endl;
            sum += aMatrix[i][j] * outMatrix[j];
        }

        std::cout << "\nAbout to do the [aMatrix[i][i]] division in back subst..: " << endl;

            std::cout << "\n*outMatrix[i]: " << outMatrix[i] << endl;
            std::cout << "\n( bMatrix[i] - sum ) : " << ( bMatrix[i] - sum )  << endl;
            std::cout << "\n****aMatrix[i][i] : " << aMatrix[i][i]  << endl;            

        if (aMatrix[i][i] > 0){
            std::cout << "\nDid the division [aMatrix[i][i]] > 0 division in back subst..: " << endl;
            std::cout << "\n*outMatrix[i]: " << outMatrix[i] << endl;
            std::cout << "\n( bMatrix[i] - sum ) : " << ( bMatrix[i] - sum )  << endl;
            std::cout << "\naMatrix[i][i] : " << aMatrix[i][i]  << endl;

            outMatrix[i] =  ( bMatrix[i] - sum ) / aMatrix[i][i];

            std::cout << "\nDid the division [aMatrix[i][i]] > 0 division in back subst..DONE: " << endl;

        }else {
            std::cout << "\nDid the divirion [aMatrix[i][i]] = 0 division in back subst..: " << endl;
            outMatrix[i] = 0.0;
            std::cout << "\nDid the divirion [aMatrix[i][i]] = 0 division in back subst..DONE: " << endl;
        }

        std::cout << "\nDid the [aMatrix[i][i]] division in back subst..: " << endl;
    }

    std::cout << "\nLeft the back subst for loops..: " << endl;

    return outMatrix;
}  
}  // end solveMatrix() 
```

我的问题是我的程序似乎在运行，但似乎超过了矩阵的末尾并崩溃了。另外，我得到了一些大的指数数字，数组中的最大数字是 1-10。

这是输出的屏幕截图：似乎无法从截图工具中粘贴。但问题似乎是在“反向替换”开始后开始的。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:40:50.467

我不确定所有问题是什么，但一个明显的问题是您的`outMatrix`. 您正在返回一个指向本地数组的指针。数组在函数结束时被销毁。您返回的指针现在是垃圾。

更改此行：

```
float outMatrix[DEFROWS] = {0.0}; 
```

至：

```
float* outMatrix = new float[DEFROWS]; 
```

然后你需要把它归零。

**注意：**如果你使用 a 并返回它会更好`vector<float>`，但是你用原始指针编写它，所以我用原始指针回答。原始指针会导致内存泄漏。应尽可能避免使用它们。使用现代 C++，很少需要分配原始指针。

编辑：见[有效 C++ 项目 #31](http://iskren.info/reading/info/C++/effective%20c++/EC/EI31_FR.HTM)

EDIT2：更改为使用向量，如果您的编译器支持 C++11 标准中定义的移动运算符和构造函数，则返回向量是一种廉价的操作。

```
std::vector<float> solveMatrix(/* Your arguments */)
{

    std::vector<float> outMatrix(DEFROWS, 0.0);

    // Your code

    return outMatrix;
} 
```

# tkinter - 特金特；在画布中使用滚动条

> ID：11252464
> 
> 赞同：2
> 
> 时间：2012-06-28T20:33:26.553
> 
> 标签：tkinter, scrollbar, frame, tkinter-canvas

我正在尝试在我的程序的一部分中创建一个滚动条。父框架有三个标签框架小部件，其中一个需要显示多达 50 个选项菜单，因此需要滚动条。

我知道你不能使用滚动条来滚动标签框架，所以在这个标签框架内我创建了一个可以滚动的画布。然后我在画布内插入了一个框架，我将用它来显示选项菜单。然后我将滚动条附加到画布上，滚动条放置在标签框架内。问题是滚动条看起来很实用，但只有前 10 个选项菜单可见，无论我滚动了多少。下面是一个例子：

```
from Tkinter import *

app = Tk()
app.title("Example App")
app.geometry("550x400+300+300")

# Creating the first label frame
entryframe = LabelFrame(app,text="Entry",width=250,height=250)
entryframe.pack(side="top",fill=BOTH)

# Creating a frame to contain the options selected by the user; also using a canvas & 
# label frame to enable the use of a scrollbar
outcomesframe = LabelFrame(app,text="User Input",width=250,height=650)
outcomesframe.pack(side="left",fill=BOTH)
outcomescanvas = Canvas(outcomesframe,relief=SUNKEN)
outcomescanvas.config(width=230,height=650)
outcomescanvas.config(scrollregion=(0,0,300,1000))
outcomescanvas.config(highlightthickness=0)

# Creating scrollbar
scrollbar = Scrollbar(outcomesframe)
scrollbar.config(command=outcomescanvas.yview)
outcomescanvas.config(yscrollcommand=scrollbar.set)
scrollbar.pack(side="right",fill=Y)
outcomescanvas.pack(side="left",expand=YES,fill=BOTH)

# Creating the frame in which the option menus will be inserted
outcomesframe2 = Frame(outcomescanvas,width=230,height=1000)
outcomesframe2.pack(side="top",fill=BOTH)

# Creating the third label frame
statsframe = LabelFrame(app,text="Third Label Frame",width=250,height=250)
statsframe.pack(side="right",fill=BOTH)

# Creating the option menus
for i in range(50):
    vars()["labeltext"+str(i)] = StringVar()
    vars()["labeltext"+str(i)].set("Menu"+str(i+1)+":")
    vars()["label"+str(i)] = Label(outcomesframe2,textvariable=vars()["labeltext"+str(i)])
    vars()["label"+str(i)].grid(row=i,column=0)

    vars()["variable"+str(i)] = StringVar()
    vars()["variable"+str(i)].set("Select...")
    vars()["menu"+str(i)] = OptionMenu(outcomesframe2,vars()["variable"+str(i)],"Option1","Option2")
    vars()["menu"+str(i)].pack()

app.mainloop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:34:10.177

滚动画布时，它只会滚动画布对象的项目。这意味着您必须使用`create_window`在画布中放置一个窗口，而不是使用`pack`or `grid`。

```
...
outcomescanvas.create_window(0,0,window=outcomesframe2, anchor="nw")
... 
```

# c# - 创建的图像上的文件锁定？

> ID：11252467
> 
> 赞同：1
> 
> 时间：2012-06-28T20:33:47.990
> 
> 标签：c#, .net

我正在寻找服务中的资源泄漏，并且很好奇以下代码实际上是否可以在创建此文件后锁定它。似乎它被锁定了，因为它在打开后被删除，然后再次保存？

**根据评论进行编辑：**

稍后将访问该文件并返回一个 IOException 消息，指出该文件无法访问，因为它正被另一个进程使用。

另外，“img = new Bitmap(...) 在创建文件时是否实际上没有访问文件？或者我对此是否感兴趣？

```
 using (Image img = new Bitmap(imgPath))
 {
     path = m_fpService.GetProcessedPath(irec, true);
     if (File.Exists(imgPath))
     {
         File.Delete(imgPath);
     }

     img.RotateFlip((RotateFlipType)adjustedRotation);
     img.Save(imgPath);
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T11:16:52.790

从[文档](http://msdn.microsoft.com/en-us/library/0cbhe98f.aspx)

> 文件名和路径可以是相对于应用程序的，也可以是绝对路径。使用此构造函数打开具有以下文件格式的图像：BMP、GIF、EXIF、JPG、PNG 和 TIFF。有关支持的格式的更多信息，请参阅位图类型。该文件保持锁定状态，直到释放位图。

不知道为什么会这样，但我想这个`Bitmap`类可以延迟加载文件的一部分。对于该功能，它需要在构造函数运行后访问。

您可以使用构造函数的 Stream-take 重载，并在您选择的时间关闭流。

# asp.net - 如何填写 asp:DropDown 客户端？

> ID：11252471
> 
> 赞同：9
> 
> 时间：2012-06-28T20:34:05.803
> 
> 标签：asp.net, ajax

`<asp:DropDown>`我有一个带有两个控件的网页：

![在此处输入图像描述](../Images/7c0aa62b08ea8460e2e4d639221e3058.png)

当用户选择一个**国家**时，我想填写州列表。

* * *

## 尝试 #1 - OnSelectedIndexChanged

第一件事很简单：在`OnSelectedIndexChanged`第一个下拉菜单中，填写第二个框：

```
//be sure to set AutoPostBack of cbCountry to true in the properties window

protected void cbCountry_SelectedIndexChanged(object sender, EventArgs e)
{
   cbState.Items.Clear();
   FetchStatesForCountryIntoStateDropDown(cbState, cbCountry.SelectedValue);
   if (cbState.Items.Count > 0)
      cbState.SelectedIndex = 0;
} 
```

这工作得很好，除了它触发了页面刷新。发送帖子时用户被打断，页面被重新加载。页面不再是他们离开的地方，他们不再坐在下拉菜单中。

* * *

## 尝试 #2 - 老式的 kludgey UpdatePanels

[@Seglo 将 UpdatePanels 称为老式的杂物](https://stackoverflow.com/a/11182209/12597)。但是因为我找不到更好的东西 - 让我们试试吧！将这些东西包装在更新面板中，让它发挥作用：

![在此处输入图像描述](../Images/2ba795229bb9521cee1d80dea4bae554.png)

这样做的问题是，当`UpdatePanel`更新时，它会删除两个控件并用新控件替换它们。这意味着用户在第一个下拉菜单中失去了焦点。人们建议[使用 javascript 尝试保存和恢复焦点的可怕 kludges](http://vincexu.blogspot.ca/2009/06/keep-textbox-focus-inside-updatepanel.html)。但我宁愿正确地做事。

* * *

## 尝试 #3 - 仅 UpdatePanel 您需要更新的内容

我不需要*更新*国家下拉列表（也不**需要**标签）。我只**需要**更新**状态**下拉列表；那么为什么不只将它包装*在*一个`<asp:UpdatePanel>`. 事实上[，这是 StackOverflow 上建议的答案](https://stackoverflow.com/questions/4583948/focus-lost-on-partial-postback-with-usercontrols-inside-updatepanel)：

![在此处输入图像描述](../Images/0848db43df28383db4b4cda68969f5ce.png)

那行得通。国家**下拉**菜单不会失去焦点。事件`OnSelectedIndexChanged`触发，**状态**下拉列表填充...

...我第一次更改国家/地区下拉菜单。

*如果我再次*更改**Country** ，则会引发异常：

 *> 无效的回发或回调参数。

不知何故，*更新面板*弄乱了 WebForms 控件；使回发数据无效。这是有道理的，因为弄乱了 WebForms 控件会使回发数据无效。

* * *

## 尝试 #4 - 尝试自己使用 javascript 伪造回发

它不会给你带来任何好处；但[人们已经尝试通过 javascript 手动触发回发](https://stackoverflow.com/questions/11179821/updating-updatepanels-based-on-texbox-focus-lost-in-asp-net)：

```
$('#userControl1').on('focusout', function() {
     __doPostback('UpdatePanel2UniqueId', '');
}); 
```

除非不知道and `ClientID`，否则脚本不会运行；我也不知道它是否能解决我的问题`cbCountry``UpdatePanel1`

* * *

## 尝试 #5 -`PageMethods`用于获取状态列表。

现在我只链接其他人的随机建议。我需要大约 4 个小时来尝试实施任何建议。这意味着我已经失去了一天半的时间来尝试填充组合框。

我不能为我在谷歌上找到的每一个随机建议浪费一天的时间；我需要一个*实际*的答案。所以我把他们包括在内只是为了向脾气暴躁的人展示研究工作（好像研究工作很重要）。

有人[建议调用 ASP.net `PageMethods`，并更新`cbState`客户端 javascript](http://www.aspsnippets.com/Articles/Populate-Bind-DropDownList-using-JavaScript-and-ASP.Net-AJAX.aspx)：

```
function GetStates(country)
{
    PageMethods.GetTeam(teamCode, CountryCallback);
}

function CountryCallback(result)
{
    var teamName = $get('TeamName');
    var seed = $get('Seed');
    var rpi = $get('RPI');
    var scoutingReport = $get('ScoutingReport');
    teamName.innerText = result.TeamName;
    seed.innerText = result.Seed;
    rpi.innerText = result.RPI;
    scoutingReport.innerText = result.ScoutingReport;
}

onchange="GetTeam(this.options[this.selectedIndex].value);" 
```

这里的问题与尝试#2 相同。视图状态将是错误的，因为我已经搞砸了 ASP.net 背后的表单。

* * *

似乎存在一个根本问题，即 ASP.net 和**viewstate**从根本上与客户端 DOM 更新不兼容。任何修改页面客户端的尝试都会使整个 ASP.net Web 表单编程模型无效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T15:59:10.430

使用 AJAX 控制工具包......它有一个 CascadingDropDown ，这将是完美的！:)

[http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/CascadingDropDown/CascadingDropDown.aspx](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/CascadingDropDown/CascadingDropDown.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T17:28:36.873

我有一个技巧，它有效。它在状态下拉列表的同一更新窗格中使用隐藏按钮。

```
<script type="text/javascript">
    function ddlCountry_changed() {
        document.getElementById('<%= btnLoad.ClientID %>').click();
    }
</script>

Country:
<asp:DropDownList ID="ddlCountry" runat="server" onchange="ddlCountry_changed();">
    <asp:ListItem Text="Vietnam" Value="1"></asp:ListItem>
    <asp:ListItem Text="United State" Value="2"></asp:ListItem>
</asp:DropDownList>

<asp:UpdatePanel ID="updatePanel" runat="server">
    <ContentTemplate>
        <asp:Button ID="btnLoad" style="display: none" runat="server" OnClick="btnLoad_OnClick" />
        State:
        <asp:DropDownList ID="ddlState" runat="server">
        </asp:DropDownList>
    </ContentTemplate>
</asp:UpdatePanel> 
```

后面的代码：

```
 protected void btnLoad_OnClick(object sender, EventArgs e)
    {
        ddlState.Items.Clear();

        if (ddlCountry.SelectedValue == "2")
        {
            ddlState.Items.Add(new ListItem() { Text = "California", Value = "1" });
        }
        else
        {
            ddlState.Items.Add(new ListItem() { Text = "Saigon", Value = "2" });
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T13:57:16.903

与尝试#1 解决页面位置问题相关，您可以尝试在 aspx 页眉中使用它

```
<%@ Page MaintainScrollPositionOnPostback="true" %> 
```

并在方法中注册一个 javascript 以`cbCountry_SelectedIndexChanged`在状态组合框中设置焦点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:52:16.203

使用 javascript更新`DropDownList`控件不会更改视图状态，这意味着在每个帖子中更改将被覆盖。

我已经对隐藏字段中列表的内容进行了类似的序列化，然后在服务器代码中对每个帖子进行反序列化

这是一个答案，显示了一个完整的工作示例以显示类似的内容（检查接受的答案）。

[ASP.NET jQuery 双列表框编辑和保存](https://stackoverflow.com/q/11217770/1268570)

## 编辑 1

顺便说一句，为了摆脱：

> 无效的回发或回调参数。

您可以禁用视图状态验证，但不建议这样做，您应该只在您大部分时间可以*信任用户的 Intranet 中执行此操作*

```
<%@ Page EnableEventValidation="false" 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-12-14T14:24:22.857

进入下拉列表的设置

设置 AutoPostBack=True ,*

# c - 使用 fscanf() 在 C 中以科学格式读取数字时出现问题

> ID：11252472
> 
> 赞同：0
> 
> 时间：2012-06-28T20:34:07.173
> 
> 标签：c, linux, ubuntu, scanf

我有多个文本文件，其数据如下：

```
 0.000000E+0 0.000000E+0
    1.800000E-1 0.000000E+0
    4.200000E-1 0.000000E+0
    6.950000E-1 0.000000E+0
    9.450000E-1 0.000000E+0
    1.225000E+0 0.000000E+0 
```

这是由测试仪器生成的。两列数据由制表符分隔。我正在尝试将此数据文件读入程序以进行进一步处理。我写的代码如下：

```
#include <stdio.h>
#include <stdlib.h>

float **make_array(int size); //function to make 2D array

int main(int argc, char **argv)
{
        FILE *infile;
        infile=fopen(argv[1], "r");

//count number of lines in file
        char c;
        int i=0, numlines=0;
        while((c=fgetc(infile))!=EOF)
                if(c == '\n') numlines++;

        printf("numlines: %d\n", numlines);

        float **entry = make_array(numlines);

//read inputfile
        for(i=0; i< numlines; i++)
                fscanf(infile, " %G\t%G", &entry[0][i], &entry[1][i]);
//verify read values
        printf("\n");
        for(i=0; i<numlines; i++)
                printf("%E\t%E\n", entry[0][i], entry[1][i]);

//clean up before exiting
        free(entry[0]);
        free(entry[1]);
        free(entry);
        fclose(infile);
return 0;
}

//create a 2D array of 2 by {size}
float **make_array(int size){
        int i;
        float **entry = malloc(2*sizeof(float *));
        if(entry==NULL) exit(1);
        entry[0] = malloc(size*sizeof(float *));
        for(i=0;i<size;i++) entry[0][i] == 0.0;
        entry[1] = malloc(size*sizeof(float *));
        for(i=0;i<size;i++) entry[1][i] == 0.0;

return entry;
} 
```

当我编译并运行程序时，它会正确打印出文件中的行数，但用于验证读入数组的数据的 printf 语句`entry`只会打印出全零，如下所示：

```
numlines: 252

0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00
0.000000E+00    0.000000E+00 
```

我尝试了不同的格式说明符，`fscanf`但`%g,%e,%f,%G etc`它们都给出了相同的结果。另外，我正在使用带有 GCC 4.6 的 Ubuntu 12.04。任何指向错误的指针将不胜感激。

卡迪亚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:44:21.120

您的初始循环：

```
while((c=fgetc(infile))!=EOF)
    if(c == '\n') numlines++; 
```

读取整个输入文件（以确定数组的大小）。一旦你这样做了，你对`fscanf`all 的调用就会失败，因为你已经在文件的末尾了。

假设输入文件是可查找的（如果它是磁盘文件则应该是可查找的），您可以使用`rewind()`或`fseek()`回到开头并再次读取它。

顺便说一句，您使用`%G`和`%E`格式说明符是有效的，但`%g`更`%e`常见（并且应该以完全相同的方式工作）。

你真的应该`argc`在引用之前检查`argv[1]`; 如果在没有命令行参数的情况下调用该程序可能会崩溃。您还应该检查是否`fopen()`成功，`fscanf()`返回 2 表示它成功读取了两个数据项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:54:23.643

所以，问题出在：

```
while((c=fgetc(infile))!=EOF)
            if(c == '\n') numlines++; 
```

执行该 while 循环后，您的 FILE* 指向 EOF，因此当您到达：

```
for(i=0; i< numlines; i++)
            fscanf(infile, " %G\t%G", &entry[0][i], &entry[1][i]); 
```

每个 fscanf 返回 EOF 并且您根本不扫描值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:55:32.223

基思指出了*问题*，但您应该考虑其他一些事情：

*   检查结果`fscanf`；它将返回成功转换和分配的数量。如果返回小于 2，则说明您没有正确读取数据；

*   您在`malloc`调用中使用了错误的数据类型`entry[0]`and `entry[1]`; 你应该使用`sizeof (float)`，而不是`sizeof (float *)`。你可以通过写来清理`entry[0] = malloc(sizeof *entry[0] * size);`——这样你就不会出现那种类型的不匹配。

*   两次读取文件效率低下且不必要；由于无论如何您都在动态分配数组，因此您可以在读取文件 时扩展`entry[0]`和`entry[1]`使用数组的大小。`realloc`

# sql - 对父子表中的 sql 数据进行历史记录

> ID：11252475
> 
> 赞同：1
> 
> 时间：2012-06-28T20:34:21.483
> 
> 标签：sql, sql-server, database-design, foreign-key-relationship

1 个地图有 N 个图像。当用户更新地图数据时，我不会进行更新，因为那时我会丢失旧数据。因此，我使用相同的自动递增 Id 但新的日期时间戳在 Map 表中执行插入操作。这样，我想在用户界面中记录地图上的所有更改。

表映射：PK 是 Id + CreatedAt

```
 [Id] [int] IDENTITY(1,1) NOT NULL, 
 [CreatedAt] [datetime] NOT NULL,   
 ... 
```

表图像：PK 是 Id，FK 是 MapId + CreatedAt

```
[Id] [int] IDENTITY(1,1) NOT NULL,
[Image] [varbinary](max) NOT NULL,
[VisibleIndex] [int] NOT NULL,
[CreatedAt] [datetime] NOT NULL,
[MapId] [int] NOT NULL, 
```

如果我的 PK 有 2 个字段，我的 FK 也必须有 2 个字段。

但这在我的情况下不起作用，因为表 Images 中的 CreatedAt 日期不能是表 Map 中的 createdAt 日期。

您将如何进行历史“更新”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:45:49.913

~~如果表中的主键`Map`是单列`Id`，那么`Images`表中的外键实际上只是列`MapId`，它引用`Id`父表上的列。~~

~~如果表上的主键`Map`是单列`Id`，那么您将无法插入与 具有相同值的另一行`Id`。~~

可以为 IDENTITY 列插入具有指定值的行，但是你必须做一个`SET IDENTITY_INSERT tablename ON`语句，然后你必须记住做一个相应的`SET IDENTITY_INSERT tablename OFF`语句。

* * *

为了实现 Map 表内容的历史记录，我会考虑创建一个单独的“MapHistory”表来存储更改历史记录，并使用触发器来维护它。

```
CREATE TABLE MapHistory (
[change_date] datetime NOT NULL,
[Id]          int      NOT NULL,
[CreatedAt]   datetime NOT NULL,
... 
```

要存储更新前行的“历史记录” `Map`，您可以引用`deleted`触发器中的特殊逻辑表。（为了完整起见，当从 Map 表中删除一行时，我还可能在历史表中存储一行。）

```
CREATE TRIGGER map_update ON Map AFTER UPDATE,DELETE AS
BEGIN
   SET NOCOUNT ON
   -- store column values as they existed prior to the update or delete
   INSERT MapHistory (change_date, Id, CreatedAt, ... )
   SELECT CURRDATE(), Id, CreatedAt, ... FROM deleted
END 
```

使用这种方法，您的代码可以简单得多。您需要做的就是`UPDATE`在`Map`表上执行，数据库将负责维护 MapHistory 表。

这种方法的一个小缺点是现在“当前”值在一个表中，而先前值的历史记录在另一个表中。

如果您希望将当前值也存储在`MapHistory`表中，则可以修改触发器以改为触发`AFTER INSERT, UPDATE`，并改为引用特殊逻辑`inserted`表，以便将插入的更新行的“副本”创建到历史表中。

也可以在历史记录表中同时存储“旧”和“新”行，但这样您实际上会存储冗余数据。在这种情况下，您可能希望包含一个列，指示该行是来自“已删除”表还是“插入”表。

```
CREATE TRIGGER map_update ON Map AFTER INSERT,UPDATE,DELETE AS
BEGIN
   SET NOCOUNT ON

   -- store column values as they existed prior to an update or delete
   INSERT MapHistory (source, change_date, Id, CreatedAt, ... )
   SELECT 'D', CURRDATE(), Id, CreatedAt, ... FROM deleted

   -- store column values as they exist after an update or insert
   INSERT MapHistory (source, change_date, Id, CreatedAt, ... )
   SELECT 'I' CURRDATE(), Id, CreatedAt, ... FROM inserted

END 
```

* * *

附录：

这种方法允许您将`Id`IDENTITY 作为`Map`表中的简单主键。我认为`change_date`我在表格中添加的列`MapHistory`可能是多余的，它可能符合您为该`CreatedAt`列指定的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:14:56.193

将地图的“恒定”和“可演化”方面分离到两个表中：

![在此处输入图像描述](../Images/d87f6c7269af3e659b1e4bdf214e24e0.png)

这假设您只想对地图字段而不是图像进行版本控制。

* * *

如果您还想对图像进行版本控制，您可以这样做：

![在此处输入图像描述](../Images/da34178f789b89513b77147d4314b493.png)

创建新地图版本时：

*   对于未更改的图像：只需复制链接但不要创建新的图像版本。
*   对于确实发生变化的图像：创建新的图像版本**和**链接。

这样，您不必仅仅因为地图发生了变化而对图像内容进行昂贵的复制。仅当映像本身发生更改时，您才创建新的映像版本。

*注意：这个模型有点太笼统了。它允许在多个地图之间共享相同的图像（不仅仅是同一地图的多个版本）。如果您想限制它，请告诉我。*

* * *

要使图像对地图“私有”，您可以执行以下操作：

![在此处输入图像描述](../Images/36cb9b4e1116eabcc58de46f60d0195f.png)

请注意我们**如何不**引入任何代理键。相反，我们让识别关系产生“自然”键，然后在菱形依赖项的底部合并：`ImageLink.MapId`外键朝向“菱形”的两个“边缘”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:45:31.447

当您想要保留旧的父子关系时，另一种方法是将旧数据插入新行，然后将旧行更新为新数据。如果您有唯一索引或其他约束会影响有两个类似的记录，但事务期间的代理键除外，则可能需要三个步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:10:37.297

我建议**创建另一个表历史记录**，在其中保留所有最后的值，包括实际值，这样你就可以只用键来映射表。 `[Id] [int] IDENTITY(1,1) NOT NULL` 您可以使用触发器或过程执行此操作，使用更改日期时间将当前记录插入历史表中，然后在您**更新**记录的普通 Map 表中插入当前记录。

# excel - 查找仅在单个单词周围替换引号

> ID：11252481
> 
> 赞同：0
> 
> 时间：2012-06-28T20:34:38.037
> 
> 标签：excel

我需要删除仅围绕单个单词的引号，保留围绕双字的引号。

所以...

"Orange","Yellow Banana","Red Apple"
应该是：
Orange,"Yellow Banana","Red Apple"

和

“黄香蕉”、“红苹果”、“橙子”
应该是这样的：
“黄香蕉”、“红苹果”、橙子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:23:09.130

```
Sub DeQuoteSingleWords()

    Dim c As Range, arr, x

    For Each c In Selection.Cells
        arr = Split(Trim(c.Value), ",")
        For x = LBound(arr) To UBound(arr)
            arr(x) = Trim(arr(x))
            If InStr(arr(x), " ") = 0 Then
                arr(x) = Replace(arr(x), """", "")
            End If
        Next x
        c.Offset(0, 1).Value = Join(arr, ", ")
    Next c

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:53:10.527

如果您的列表格式不正确（缺少空格或额外的标点符号），这可以工作，但它不是最佳的:)

您没有指定文本在哪里或如何访问它，所以只是做了任何事情:)

```
Public Sub fixQuotes(ByVal Target As Range)
Dim Words() As String
Dim Word As String
Dim Index As Long
Dim Result As String

Words = Split(Target.Value, " ")

Result = ""

For Index = LBound(Words) To UBound(Words)
    Word = Words(Index)

    Word = Replace(Word, ",", "")
    Word = Replace(Word, ".", "")

    If Left(Word, 1) = Chr(34) And Right(Word, 1) = Chr(34) Then

        Result = Result & Replace(Words(Index), Chr(34), "") & " "

    Else

        Result = Result & Words(Index) & " "

    End If

Next Index

Target.Value = Result

End Sub 
```

查看您的示例后，我发现前一个示例根本无法正常工作（列表项之间需要空格）

所以我做了一个新的:)

```
Public Function fixQuotes2(ByVal Text As String) As String
Dim Index As Integer
Dim Character As String
Dim Quote As Boolean
Dim A As Integer
Dim Result As String

Index = 1

Do

    If Mid(Text, Index, 1) = Chr(34) And Index < Len(Text) Then
        A = 1
        Quote = False
        Do
            Character = Mid(Text, Index + A, 1)

            If Character = " " Then
                Quote = True
            End If
            If Character = Chr(34) Then
                Exit Do
            Else
                If Index + 1 >= Len(Text) Then
                    Exit Do
                Else
                    A = A + 1
                End If
            End If
        Loop

        If Quote = True Then
            Result = Result & Mid(Text, Index, A + 1)
        Else
            Result = Result & Mid(Text, Index + 1, A - 1)
        End If
        Index = Index + A + 1
    Else
        If Index >= Len(Text) Then
            Exit Do
        Else
            Result = Result & Mid(Text, Index, 1)
            Index = Index + 1
        End If
    End If
Loop

    fixQuotes2 = Result

End Function 
```

与第一个不同，您可以将其用作工作表功能。

注意：在尝试之前确保你已经保存了你的东西！（制作时有几个无限循环：p）

```
Public Sub fixMacro()
ActiveCell.Value = fixQuotes2(CStr(ActiveCell.Value))
End Sub 
```

将其与 fixQuotes2 一起添加，您将在宏列表中获得“fixMacro”，当您运行宏时，它将在活动单元格上运行该函数，并将其值替换为固定版本。

# android - 如何正确处理返回屏幕？

> ID：11252483
> 
> 赞同：0
> 
> 时间：2012-06-28T20:34:42.277
> 
> 标签：android, android-layout, android-fragments

我有下一个序列：

*   创建活动；
*   将片段放入其中；
*   转到下一个片段；
*   使用后退按钮返回上一个片段。

好吧，让我们做吧。

这就是我在导航中转到下一个片段的方式：

```
public static void addFragment(Fragment currentFragment, Fragment fragment, int frameLayout) {
    FragmentTransaction fragmentTransaction = currentFragment.getFragmentManager().beginTransaction();
    fragmentTransaction.replace(frameLayout, fragment);
    fragmentTransaction.addToBackStack(null);
    fragmentTransaction.commit();
}

public static void replaceFragment(Fragment currentFragment, Fragment fragment, int frameLayout) {
    FragmentManager fragmentManager = currentFragment.getFragmentManager();
    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
    Fragment topFragment = fragmentManager.findFragmentById(frameLayout);
    int transactionsCount = fragmentManager.getBackStackEntryCount();
    if (transactionsCount > 0 && topFragment == currentFragment) {
        fragmentManager.popBackStack();
        fragmentTransaction.replace(frameLayout, fragment);
        fragmentTransaction.addToBackStack(null);
    }   else {
        fragmentTransaction.replace(frameLayout, fragment);
    }
    fragmentTransaction.commit();
} 
```

在`onCreateView`第一个片段中，我加载了一些数据并在完成后隐藏活动指示器

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    LinearLayout homeLayout = new LinearLayout(activity);
    inflater.inflate(R.layout.screen_home, homeLayout);

    setupCategoryButtons();
    setupHomeGenderRadioButton(mainLayout);
    setupMagazinesPreviews(mainLayout);

    return homeLayout;
}

private void setupCategoryButtons() {
    if(categoriesButtons.size() > 0) {
        View categoriesWaitIndicator = activity.findViewById(R.id.categoriesWaitIndicator);
        categoriesWaitIndicator.setVisibility(View.INVISIBLE);

        LinearLayout categoriesButtonsLayout = (LinearLayout)activity.findViewById(R.id.categoryButtonsLayout);

        for(CategoryButton categoryButton : categoriesButtons) {
            categoriesButtonsLayout.addView(categoryButton);
        }

        refreshCategoriesButtons();
    }
} 
```

没什么特别的。而且效果很好。直到我回到这个屏幕。

当我返回此屏幕时，我会进入`NullPointerException`这些行：

```
categoriesWaitIndicator.setVisibility(View.INVISIBLE);
categoriesButtonsLayout.addView(categoryButton); 
```

该应用程序似乎找不到这些视图！我试图这样做，`onResume`但它具有相同的效果。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:41:38.013

我不知道这个片段究竟做了什么，但它正在操纵`Activity`. 由于片段可能在`Activity`视图被构建或销毁之前存在，它可能试图获取已被其无法控制的元素销毁和/或修改的视图。如果片段被隔离以便处理它自己的视图会更好。

# c# - Microsoft.WindowsAzure.ServiceRuntime 的 NuGet 包在哪里？

> ID：11252486
> 
> 赞同：68
> 
> 时间：2012-06-28T20:35:11.820
> 
> 标签：c#, azure, nuget, azure-sdk-.net, azure-service-runtime

我们之前一直通过 SDK 引用我们的 Windows Azure 库，我注意到[他们现在有 NuGet 包](http://nuget.org/packages?q=windowsazureofficial)。这显然要好得多，所以我将所有这些引用换成 NuGet 包。

但是，我找不到包含[RoleEnvironment](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.serviceruntime.roleenvironment.aspx)等 类的 Microsoft.WindowsAzure.ServiceRuntime.dll 的 NuGet 包。

我们是否应该从 SDK 安装中引用这个 dll 而不是 nuget 包？这似乎非常奇怪。我只是没有看到这个程序集的包装吗？

我现在已经安装了所有带有“windowsazureofficial”标签的包（只是暂时的），但它们似乎都没有正确的参考！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-28T22:01:50.543

最新的[Windows Azure SDK 是 1.7](https://www.windowsazure.com/en-us/develop/net/)，因此如果您需要更新 Microsoft.WindowsAzure.ServiceRuntime，您必须在您的计算机中手动安装 SDK 并将这些引用添加到您的角色。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-05-23T14:10:50.713

[![如何添加 Microsoft.WindowsAzure.ServiceRuntime](../Images/fef8ee795518beebaf132dc0f9505e2a.png)](https://i.stack.imgur.com/EY3Zd.png)

对于仍在战斗的​​任何人，请确保您在“程序集”>“扩展”下查看；）现在这让我在 3 个月内获得了两次！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-06-24T13:05:26.923

我有一个类似的问题。

**选项1）**

`dll`我在我的 Google Drive Storage 中添加了一个库： [Microsoft.WindowsAzure.CloudDrive](https://drive.google.com/folderview?id=0B5-vV6C0Mbm4fi16bTcxNmhzdEZMYWhTZDVpbFNKdWdMRXVIbC0zelk4U25iS2NWbXM1VVU&usp=sharing)

在这种情况下，您应该下载并创建一个“静态”链接。

**选项 2)**

我找到了一个 NuGet 包：

[Azure SDK 2.2 DLL](https://www.nuget.org/packages/AzureSDK2.2DLLs/)

`PM> Install-Package AzureSDK2.2DLLs`

如果您需要更多信息，请与我联系。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-19T23:31:51.547

您需要安装要用于构建的特定版本的 Azure SDK。

实际上，您只需要安装它的某些部分，包括参考库（SDK 的多个部分您可以单独下载） - 这取决于您要查找的程序集。

例如，对于 2.2 或 2.3 SDK 和**Microsoft.WindowsAzure.ServiceRuntime**或**Microsoft.WindowsAzure.Diagnostics**程序集，您需要“WindowsAzureAuthoringTools”MSI 安装程序 - 而不是“WindowsAzureLibsForNet-x64”MSI，它会安装一些其他参考库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-28T20:54:36.720

目前似乎没有，但我发现了这个： [AnglicanGeek's Unofficial Windows Azure Service Runtime 1.6](http://nuget.org/packages/AnglicanGeek.WindowsAzure.ServiceRuntime)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-09-26T21:38:00.127

它现在是 NuGet 上的常规包：

`Install-Package Microsoft.WindowsAzure.SDK`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-28T23:14:57.923

他们可能不想分发 SDK 的核心部分，因此您仍然需要安装实际的 SDK。我（通过 nuget）向“windowsazureofficial”nuget 软件包的所有者发送了消息，并要求提供反馈，如果我收到回复，我会更新此信息。

至于升级，请先获取[sdk](https://www.windowsazure.com/en-us/develop/net/)，然后按照[此处](http://msdn.microsoft.com/en-us/library/windowsazure/jj131257)的升级说明进行操作。引用将自动更新，并且如果可以，它也会将本地引用转换为 nuget 包引用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-19T09:40:59.847

列出所有 Azure 包：[适用于 .NET 的 Azure SDK](http://azure.microsoft.com/en-us/downloads/archive-net-downloads/)

> 注意：在下载 SDK 文件之前，请查看安装步骤以了解安装 SDK 所涉及的过程和依赖项。对于 SDK 1.7 及更高版本，请使用以下手动安装程序链接中包含的安装步骤。对于 SDK 1.6 及更早版本，请按照本页后面列出的安装步骤进行操作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-03T05:16:52.357

您可以`Microsoft.WindowsAzure.ServiceRuntime.dll`在路径中找到：

```
Program Files\Microsoft SDKs\Windows Azure\.NET SDK\<sdk_version>\bin\runtimes\base 
```

# css - 分层未按预期工作

> ID：11252493
> 
> 赞同：0
> 
> 时间：2012-06-28T20:35:38.580
> 
> 标签：css

所以我试图让两个并排的div，但是，它们似乎总是重叠看到...... [JFiddle](http://jsfiddle.net/mkbAr/4)

我尝试弄乱 z 索引，但这似乎没有帮助。

这应该很容易有人能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:39:16.627

两个都试一下`float:left`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:40:38.883

添加`float:left;`到`#content #item2`. 看到[这个 jsfiddle](http://jsfiddle.net/mkbAr/5/)。

# c# - 捕获外部进程的错误

> ID：11252494
> 
> 赞同：0
> 
> 时间：2012-06-28T20:35:39.830
> 
> 标签：c#, process, error-handling

如何捕获或重定向针对 a 发生的错误`Process`？

我希望能够获得错误消息信息。

下面的代码不这样做。

```
try
{
    myProcess.StartInfo.UseShellExecute = false;
    myProcess.StartInfo.FileName = process_to_run;
    myProcess.StartInfo.Arguments = p_arg + " > "+process_to_run+".txt 2>&1";
    myProcess.StartInfo.CreateNoWindow = true;
    myProcess.Start();
    myProcess.WaitForExit();

}
catch (Exception ep)
{
    richTextBox1.AppendText("\n" + ep.Message);
    time_date = get_time();
    log_file.Write(time_date);
    log_file.WriteLine(process_to_run + "...Failed. ERROR: " + ep.Message);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:40:25.103

您可以[重定向标准错误](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandarderror.aspx)，然后对其进行解析以确定是否存在错误。

```
// Start the child process.
 Process p = new Process();
 // Redirect the error stream of the child process.
 p.StartInfo.UseShellExecute = false;
 p.StartInfo.RedirectStandardError = true;
 p.StartInfo.FileName = "Write500Lines.exe";
 p.Start();
 // Do not wait for the child process to exit before
 // reading to the end of its redirected error stream.
 // p.WaitForExit();
 // Read the error stream first and then wait.
 string error = p.StandardError.ReadToEnd();
 p.WaitForExit(); 
```

# c++ - 如果某些函数没有被调用，我可以强制编译错误吗？

> ID：11252496
> 
> 赞同：2
> 
> 时间：2012-06-28T20:35:43.417
> 
> 标签：c++, visual-studio-2010, compiler-errors

受[这个问题](https://stackoverflow.com/questions/10727418)的启发，我想知道是否有任何技巧（如 SFINAE）来实现相反的效果。

**编辑：添加示例**

我有这样的东西（它非常简化，因为它有很多细节）：

```
#include <iostream>

class Base {
public:
  Base(){}
  virtual ~Base(){
  }
  void initialize() { implementation(); }
private:
  virtual void implementation() = 0;
};

class Derived : public Base {
private:
  virtual void implementation() { std::cout << "initialization" << std::endl;}
};

int main() {

  std::unique_ptr<Base> b(new Derived());
  b->initialize();

  return 0;
} 
```

**必须**调用初始化方法。

但是如果我将初始化方法放在 Base 构造函数中，它将调用一个纯虚拟方法。我想知道是否有办法防止有人不正确地使用构造的对象。

**编辑：我的“解决方案”：**

```
#include <iostream>

class Base {
public:
  virtual ~Base(){
  }
  Base() {};
private:
  void initialize() { implementation(); }
  virtual void implementation() = 0;
  template<class DerivedType> friend Base *factory();
};

class Derived : public Base {
private:
  Derived() {}
  virtual void implementation() { std::cout << "initialization" << std::endl;}
  template<class DerivedType> friend Base *factory();
};

template<class DerivedType>
static Base *factory(){
  Base *b = new DerivedType();
  b->initialize();
  return b;
}

int main() {

  std::unique_ptr<Base> b(factory<Derived>());

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:42:28.183

您不能强制编译器错误，但还有其他选择。

如果您的类型的实例根本无效，除非调用 initialize，并且如果记录该事实或在使用时抛出异常（如果未初始化）是不可接受的，那么您应该将构造函数设为私有并公开一个静态方法来创建您的类型的实例。

这样，您的代码客户端根本无法使用您类型的未初始化实例。如果有更好、更优雅的方法，我不知道（但也许这里有人知道）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-03T10:36:37.687

请注意，这不应该是必需的，因为当您创建对象时，该对象可以正确初始化自身，而无需调用初始化函数。

这听起来可能很奇怪，但在大多数情况下，该`initialization()`功能是不正确的：

```
class A
{
public:
    A() { do initialization of A fields here; }
};

class B : public A
{
public:
    B() { do initialization of B fields here; }
}; 
```

在大多数情况下，这应该足够了。

如果将参数传递给构造函数，则可能需要一些接口（不要在#include 中创建循环），然后只需传递这些参数，如下所示：

```
class C;
class D;

class A
{
public:
    A(C c) { do initialization of A fields here; }
};

class B : public A
{
public:
    B(C c, D d) : A(c) { do initialization of B fields here; }
}; 
```

否则，为了在运行时进行验证，[boost](http://www.boost.org/)和我的[受控](https://sourceforge.net/projects/controlled-vars/)变量（使 int 等类型安全的模板，终于！）提供了检查字段是否已初始化的工具，它可以抛出并返回默认值。

否则，我不知道编译器中有任何工具可以进行此类测试。但是，如果您编写测试（无论如何您都应该进行测试！），那么您的测试可以进行此类验证。

请注意，我首先想到了探查器，但这需要一个测试，无论如何都会告诉您您是否正确，探查器可以告诉您初始化已被调用，但您不知道是否在所有情况下都发生了这种情况。

但是，如 Ed S. 所述，要真正在编译时强制执行此类初始化（假设您确实需要它），最好的方法可能是使用工厂。这样所有丑陋的初始化代码都被隐藏起来了。

# azure - 神秘消失的 Azure 开发存储资产

> ID：11252499
> 
> 赞同：6
> 
> 时间：2012-06-28T20:35:50.977
> 
> 标签：azure, blob, azure-storage, azure-storage-emulator

我们正在构建一个由 Azure 存储支持的站点。一个工作角色有一些文件，它在启动时从 blob 下载。这些文件一旦存储就永远不会被修改，我们只是将它们拉下来并使用它们。

有时，当尝试从开发存储下载这些文件时，Storage Emulator 服务会返回 500 错误。我们可以列出 blob 中的文件并获取元数据，但不能下载文件本身。我们找到的唯一解决方案是删除 blob 并重新上传。

有没有其他人遇到过这个？

**更新**：1.7 SDK

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-06T11:10:13.593

## 可能的解决方案（解决方法）

1.  退出存储模拟器；
2.  打开管理 Sql Server Management Studio 2012；
3.  附加`C:\Users\<username>\DevelopmentStorageDb201206.mdf`文件（`<username>`受影响用户的名称在哪里）；
4.  如果不允许附加，请将 mdf 和日志文件复制到其他驱动器然后附加，否则您可以访问 LocalDB ( `(localdb)\v11.0`)；
5.  查找存储过程`CommitBlockList`；
6.  更改`SET UncommittedBlockIdLength = NULL`为`SET UncommittedBlockIdLength = 0`;
7.  执行它；
8.  关闭管理工作室；
9.  将这些编辑过的 mdf、日志文件复制到原始位置；
10.  启动存储模拟器；

## 我是怎么到那里的

我发现大约每 7 天只有一次 BLOCK Blob 被删除。
在开发/测试过程中，为了测试目的再次创建这些 blob 是很痛苦的。
试图找到存储模拟器源代码，但找不到。 通过添加以下内容
打开登录`C:\Users\<username>\AppData\Local\DevelopmentStorage``DevelopmentStorage.201206.config`

```
<LogPath>C:\Users\<username>\AppData\Local\DevelopmentStorage\Logs</LogPath>  
<LoggingEnabled>true</LoggingEnabled> 
```

经过痛苦的等待，在日志中发现以下内容：

> DefragmentBlobFiles BlobInfo Name 40f5e12f-65a5-4a3a-ae46-41c71c8514c0/file1.txt，ContainerName storage1，目录 c:\users\username\appdata\local\developmentstorage\ldb\blockblobroot\1\12735b4b-f9ed-481b-a091-78387facf05b， ROFile , RWFile c:\users\username\appdata\local\developmentstorage\ldb\blockblobroot\1\12735b4b-f9ed-481b-a091-78387facf05b\1, Size5

我不认为碎片整理会导致任何问题。
找到另一个日志：

> BlockBlob：加载间隔失败。IsGC：是的，Microsoft.WindowsAzure.DevelopmentStorage.Store.BlockBlobGarbageCollector.GetTimerIntervalOrDefault（Boolean isGC）的 System.Number.ParseDouble（字符串值，NumberStyles 选项，NumberFormatInfo numfmt）异常

因此，对于 BlockBlob，未提交的块由该 BlockBlobGarbageCollector 进行垃圾收集。我无法找到这些未提交的块被垃圾收集的频率。我认为即使这也不会导致问题。

另一个日志：

> BlockBlob：检查有效目录列表中的目录 C:\Users\username\AppData\Local\DevelopmentStorage\LDB\BlockBlobRoot\1\0477877c-4cb3-4ddb-a035-14a5cf52d86f
> BlockBlob：删除目录 C:\Users\username\AppData \Local\DevelopmentStorage\LDB\BlockBlobRoot\1\0477877c-4cb3-4ddb-a035-14a5cf52d86f

上面的日志显示了问题。模拟器必须确定有效的块块目录。

检查数据库的架构`DevelopmentStorageDb201206`。发现几个列，如`IsCommitted`和`UncommittedBlockIdLength`。发现`ClearUncommittedBlocks`设置`UncommittedBlockIdLength`为`null`. 任何未被删除的 Blob 的`UncommittedBlockIdLength`值为 0。因此检查存储过程`CommitBlockList`并更改`UncommittedBlockIdLength`为 0 而不是`null`. 我认为以前版本中的模拟器必须检查`IsCommitted`并`UncommittedBlockIdLength`确定有效的块 blob 目录，而在这个版本中，它可能只检查`UncommittedBlockIdLength`并`null`删除所有这些块 blob 文件。

正如我所说，大约需要 7 天才能确定此解决方案是否永久修复它。我还有 4 天的时间去验证它。

如果这是一种可行的解决方法，...微软欠我 6 小时；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T21:27:03.120

我没有解决方案，但我可以补充一点，当存储模拟器的后备存储是 SQL Server 2012 时，也会发生这种行为。我们已经多次看到这种情况。一切都很好，然后斑点消失了。我们的经验是，所有或几乎所有 blob 从文件系统中消失，而数据库引用仍然存在。不知道为什么会发生这种情况——没有明显的诱发事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T13:30:37.333

我遇到了同样的问题。我怀疑 Azure 存储模拟器在 LocalDB 上运行时出现问题。原因如下：

*   当您遇到 500 错误时，使用 Management Studio 或 Server Explorer 打开 Blob 表，并找到有问题的 blob 的 DirectoryPath 字段的值（类似于 c:\users\username\appdata\local\developmentstorage\ldb\blockblobroot\1 \305469d0-7b68-4b1e-a41a-a429c21b6b9d

*   使用资源管理器导航到该路径并注意该目录为空

*   现在重新上传您的文件并导航到它上传到的新目录，注意有您的文件

那么，现在的问题是为什么 blob 文件会消失？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-03T10:20:04.673

我还看到存储模拟器偶尔会返回有效请求。但通常重试请求会正常工作。始终建议重试失败的请求，除非响应表明请求无效（在这种情况下重试无论如何都不起作用）。即使您使用云存储，偶尔也可能会遇到临时网络不可用等问题。事实上，对于所有与网络相关的操作，都建议使用重试策略。

此外，如果您使用 .NET 存储客户端库，则可以利用内置的重试策略：http: [//blogs.msdn.com/b/windowsazurestorage/archive/2011/02/03/overview-of -retry-policies-in-the-windows-azure-storage-client-library.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/02/03/overview-of-retry-policies-in-the-windows-azure-storage-client-library.aspx)。

此致，

明旭。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-05T19:53:31.580

也许解决这个问题的更简单的方法是升级到 Azure SDK 1.8——因为我已经从 1.7（大约两周前从 2012 年 11 月 23 日开始）升级，我的 blob 不再消失。

即使决定使用旧库，您也可以利用新的存储模拟器 - 实际上这些库是并排安装的，只有模拟器被升级（即新版本替换旧版本）但它们仍然与旧版本兼容版本。例如，我现在正在使用新的存储模拟器，但我仍然在我的 .NET 项目中引用 1.7 库。

**更新 2013 年 8 月 30 日 18:00 UTC**我在 Azure SDK 2.0 上再次遇到了这个问题——现在我写了几个星期的 blob，几分钟后我在访问它们时得到了 HTTP 500。我想知道这种行为是否是由我的存储模拟器的某些特性（例如太多的 blob 和/或容器）触发的——在这方面我想补充一点，我通过重命名数据库文件从存储模拟器 1.8 升级自架构（与 Visual Studio 相比）似乎是相同的，但也许我错过了一些重要的东西。

我现在正在评估是否升级到 Azure SDK 2.1 并希望这个问题得到修复或切换到使用真实存储帐户进行开发。

**更新 2013-09-02 18:00 UTC**我决定使用真实的存储帐户，原因如下：

*   通过 Azure SDK 更新维护存储数据的能力——存储模拟器通常会更改数据库的架构或位置，而在发行说明中没有任何注释，从而强制进行一些手动迁移；
*   能够使用 Azure 存储的所有功能，而不必担心生产和存储模拟器之间的差异（正如 Richard Astbury 在他的评论中所说）；
*   避免 SQL Server 实现特有的性能和维护问题（对我来说这是一个意外的复杂性）。

# c++ - 我怎么知道 boost::regex_replace 是否进行了更改？

> ID：11252502
> 
> 赞同：3
> 
> 时间：2012-06-28T20:36:10.290
> 
> 标签：c++, boost

在 perl 中，我可以做到这一点

```
if($str =~ s/a/b/) {
  do something
} 
```

在 C++ 中，我知道如何进行搜索/替换部分：

```
str = boost::regex_replace(str, boost::regex("a"), "b",  
                           boost::match_default | boost::format_perl ) ; 
```

我怎么知道是否进行了更换？

我可以将旧值与新值进行比较。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:52:29.947

也许有更好的方法可以做到这一点，但我在[文档](http://www.boost.org/doc/libs/release/libs/regex/doc/html/boost_regex/ref/regex_replace.html)中看不到任何提示。该功能似乎将输入格式化和/或复制到输出。所以直接的解决方案是这样的：

```
std::string result = boost::regex_replace(str, boost::regex("a"), "b",
                                          boost::match_default | boost::format_perl);
if (result != str) {
    // Do something with "result".
} 
```

但是，如果您觉得您需要一个非常有效的实现，您可以使用[`regex_match()`](http://www.boost.org/doc/libs/release/libs/regex/doc/html/boost_regex/ref/regex_match.html)它来准确地告诉您匹配的内容，然后自己替换子字符串。

# php - 种子的哈希信息

> ID：11252505
> 
> 赞同：0
> 
> 时间：2012-06-28T20:36:23.137
> 
> 标签：php, hash, bittorrent

我正在与我的网站最近的一位开发人员交谈，他建议我将 torrent 的哈希信息存储到数据库中，所以我对`hash_info`torrent 有一些疑问。

1.  在 RAM 和 CPU 使用方面，存储种子的哈希信息将完成什么？

2.  创建种子时；哈希信息是否实际存储在种子文件中？

他告诉我，通过将哈希信息存储到数据库中，然后将其作为变量再次调用，这将减少创建种子所需的时间，但我不确定这会发生什么以及如何发生。

# actionscript-3 - 激活鼠标事件的影片剪辑内容

> ID：11252517
> 
> 赞同：0
> 
> 时间：2012-06-28T20:37:33.663
> 
> 标签：actionscript-3

我正在制作一张地图，其中有许多鼠标悬停在淡入电影剪辑文本的“点”上。我遇到的问题是包含在父影片剪辑中的文本本身也变成了鼠标悬停区域。我只想让点本身激活鼠标事件，而不是它的内容。我在网上搜索了整个网络并找到了诸如 mouseChildren = false 之类的“解决方案”；和mouseEnabled = false；不工作。我不知道我只是编码错误还是什么。任何帮助，将不胜感激。这是我的代码：

```
clayton.buttonMode = true;
clayton.addEventListener(MouseEvent.ROLL_OVER, over);
clayton.addEventListener(MouseEvent.ROLL_OUT, out);

function over(event:MouseEvent):void{
    clayton.gotoAndPlay("over");

}

function out(event:MouseEvent):void{
    clayton.gotoAndPlay("out"); 
} 
```

将鼠标悬停在父影片剪辑上后，包含的文本会正确淡入。当鼠标移出父影片剪辑时，包含的文本会正确淡出。但是，在将鼠标悬停在父动画剪辑上并移出之后，所包含的文本就会像父动画剪辑一样，并激活鼠标悬停动画。这是一个显示实际问题的视频。请注意，当我一开始将鼠标悬停在地图的中心区域时，什么也没有发生。但是在我将鼠标悬停在地图上的点上之后，中心区域就会激活动画。

这是我的问题的视频示例： [http ://www.youtube.com/watch?v=OC2vVjMQTH4](http://www.youtube.com/watch?v=OC2vVjMQTH4)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:10:16.037

视频有帮助！

看起来正在发生的事情是您的初始鼠标悬停时出现的信息框即使在淡出后仍保持加载，因此即使您看不到它（淡出），它仍然存在并触发您的翻转.

您可以通过多种不同的方式解决此问题。最快的（尽管最草率的）是在停止/循环之前在“出”动画的末尾添加一个空帧。

更好的做法可能是将您的 roll_over 侦听器附加到点对象本身上。（您可以将 roll_out 留在父级 'clayton' 上）。

# jsf - PrimeFaces 3.3.1 日历在国际应用中禁用未来日期

> ID：11252522
> 
> 赞同：1
> 
> 时间：2012-06-28T20:38:01.293
> 
> 标签：jsf, primefaces

我正在 Tomcat 6 上使用 Primefaces 3.3.1 编写 JSF 2.0 Mojarra 应用程序。使用 PrimeFaces`<p:calendar>`组件，我需要禁用未来日期。我意识到我必须将 maxdate 属性设置为当前日期。但是，我不确定完成此操作的最简单方法是什么。

我意识到我可以创建一个 Managed Bean `java.util.Date`，但这是一个国际应用程序，我需要考虑用户的位置。如果用户在世界的​​另一端，则服务器日期对他来说可能不正确。

**那么，在用户位置检索当前日期并将`<p:calendar>`maxdate 属性设置为等于该值的最简单方法是什么？** 如果可能的话，一个完全的客户端解决方案将是理想的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T11:40:37.290

正如 primefaces-chief **Cagatay Civici**已经说过的那样，您可以使用 `p:calendar` `maxDate`它。因为我不打算将我的 facelets 与 JS 混为一谈，所以我是这样做的：

方面：

```
<p:calendar maxdate="#{bean.today}" /> 
```

豆：

```
public Date getToday() {
        return new Date();
    } 
```

所以没有未来可以选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:26:41.473

您可以获得客户端系统日期。

`<p:calendar>`calendar 是一个 jquery-ui 小部件，您可以通过定义 widgetVar 并使用 javascript 设置 maxdate 来对其进行客户端访问。

```
<p:calendar widgetVar="myCalendar" />
<script type="text/javascript">
     jQuery(document).ready(function(){
        myCalendar.jqEl.datepicker("option", "maxDate", +0);//set maxDate to today
     });     
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-11T13:09:33.807

我们也可以使用 faces-config.xml 来定义 currentDate bean

```
enter code here
<managed-bean>
    <managed-bean-name>currentDate</managed-bean-name>
    <managed-bean-class>java.util.Date</managed-bean-class>
    <managed-bean-scope>request</managed-bean-scope>
</managed-bean> 
```

然后在 .xhtml 中使用

```
<p:calendar maxdate="#{currentDate}" /> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-11T21:36:48.520

它比它禁用所有过去的日期直到当天更简单

# mysql - mysql join or select where tablename1.col1 = tablename2.col1

> ID：11252526
> 
> 赞同：1
> 
> 时间：2012-06-28T20:38:20.953
> 
> 标签：mysql, select, inner-join

我在mysql中实现了两个表...

```
 id            name               password

           1            name1              password1
           2            name2              password2 
```

***和***

```
 id            age               address

           1            age1              address1
           2            age2              address2 
```

现在我需要组合形式的选择查询结果

```
 id     name      password    age   address

          1      ....      ........     ...  .....  
          2      ....       .. ..  .    ..   ... .. 
```

现在我使用以下两个查询进行了尝试...

`SELECT * FROM table1, table2 WHERE table1.id=table2.id;`

***而且我也试过***

`SELECT * FROM table1 INNER JOIN table2 ON table1.id = table2.id;`

我确实得到了我想要的结果...... ***但我只是想知道哪种方法比较好，考虑到列或数据条目的数量......？？？***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:42:57.457

根据[之前的 StackOverflow 问题](https://stackoverflow.com/questions/670980/performance-of-inner-join-compared-to-cross-join)，性能似乎通常大致相当。尝试`EXPLAIN`对这些查询中的每一个运行，看看哪些在您的数据集上运行得更好——尽管 MySQL 很可能会为每个查询遵循相同的过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T20:43:20.777

最有效的方法是有一个表。我认为没有理由像那样分手

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:43:56.467

什么是更好的”？这两种方法都是有效的，并且速度应该相同。但是知道姓名、密码、年龄和地址都是一个人的属性，将这些值存储在一张表中是合乎逻辑的......

# algorithm - 算法和函数的泛化

> ID：11252527
> 
> 赞同：0
> 
> 时间：2012-06-28T20:38:21.450
> 
> 标签：algorithm, data-structures, recursive-datastructures

我承认我的数学函数有点差。
但我真的很想解开这个谜。
如何表达`x(n)=x(n-1)+x(n-2)+1`where`n>1`和. 就函数而言where和和。 我在一些关于 AVL 树的 pdf 中找到了答案，对于高度为 n 的 AVL 树的最小节点数 nmin(n)。 `x(0)=0``x(1)=1`
`y(n)=y(n-1)+n``n>1``y(0)=0``y(1)=1`
`x(n)=y(n+2)-1`

请解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:37:36.577

请更清楚您真正想要什么以及为什么（如果相关）。

你的第一个方程不是齐次的。为了使其同质化，你可以这样写：

`x[n]+1 = (x[n-1]+1)+(x[n-2]+1)`

并代替`u[n] = x[n] + 1`得到

`u[n] = u[n-1]+u[n-2]`与`u[0] = 1`, `u[1]=2`.

这些数字被称为[斐波那契数字](http://en.wikipedia.org/wiki/Fibonacci_number)。关于这些数字有几个公式和结果。例如

`u[n-2] = (phi^n - (-phi)^(-n)) / sqrt5`和`phi = (1 + sqrt 5) / 2 = 1.618...`

`x[n]`它在你的原始方程中给出了一个公式：

`(phi^(n+2) - (-phi)^(-n-2)) / sqrt5 - 1`

另一方面，您的其他等式`y[n] = y[n-1] + n`可以重申为

`y[n] = y[n-1] + n = y[n-2] + (n-1) + n = ... = 1 + 2 + ... + n`

众所周知，这笔款项是`y[n] = n(n+1)/2`

我认为你提供的`x[n]`和之间没有明显的关系。`y[n]`

# clojure - 遍历一系列记录

> ID：11252529
> 
> 赞同：2
> 
> 时间：2012-06-28T20:38:39.690
> 
> 标签：clojure, record

我正在尝试使用 for-macro 显示 menu-items 变量中的项目：

```
(defrecord MenuItem
  [select-char description])

(def menu-items [(MenuItem. "1" "add an expense")
         (MenuItem. "2" "add an income")
         (MenuItem. "0" "exit")])

(defn display-menu [items]
  (for [item items]
    (println (:select-char item))))

(defn menu-prompt [items]
  (display-menu items)
  (read-val ">>>"))

(println menu-items)
(menu-prompt menu-items) 
```

但是，只显示 >>> 提示。有人可以解释为什么会这样，以及如何显示这些项目吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:49:33.573

这是“懒虫”的案例

for 生成一个惰性序列，该序列仅在读取时进行评估。
对 display-menu 的调用只是返回对列表的引用，然后继续它的结婚方式，什么也没做。

将其包装在调用中`doall`

```
user> (def a (for [x (range 10)] (println "doing work" x)))
#'用户/一个
用户>一个
（工作0
做工作 1
做工作 2
做工作 3
做作业 4
做作业 5
做作业 6
做作业 7
工作 8
工作 9
无 无 无 无 无 无 无 无 无 无 无）

```

如果您使用 doall 或 dorun 那么它将立即完成工作。

```
user> (dorun (for [x (range 10)] (println "doing work" x)))
工作 0
做工作 1
做工作 2
做工作 3
做作业 4
做作业 5
做作业 6
做作业 7
工作 8
工作 9
零
user> (doall (for [x (range 10)] (println "doing work" x)))
工作 0
做工作 1
做工作 2
做工作 3
做作业 4
做作业 5
做作业 6
做作业 7
工作 8
工作 9
(无 无 无 无 无 无 无 无 无 无 )

```

# jquery - Fancybox (1.3) 正在为我的内容添加额外的 div

> ID：11252532
> 
> 赞同：0
> 
> 时间：2012-06-28T20:38:41.090
> 
> 标签：jquery, fancybox

我的网站页脚中有一个时事通讯注册表单。在侧边栏中，我有一个链接，它使用注册表单的 div 作为其内容来触发一个花式框窗口。

正如预期的那样，这会导致表单从页脚中消失并在灯箱中弹出。

我关闭灯箱，它又回到了原来的样子。有一个非常烦人的例外：它被包裹在一个额外的`div`. 我打开和关闭灯箱窗口的次数越多`div`，它积累的越多。

现在，我通常只会让 fancybox 从隐藏的 div（表单的第二个副本）中抓取内容，但它是由 WordPress（mailchimp）中的插件生成的，我无法更改 #id 或表单名称。

所以这要么是一个错误，要么是 fancybox 的一个特性。我 99.9% 确定不是我做错了什么。有人有办法可以删除包装的 div 吗？我想我可以尝试放置一些 jquery 代码段，`onClosed`其中从#email_signup 中删除一个 div ......但我可能会等到明天再这样做。

**相关代码：**

js

```
jQuery("#signMeUpBox a").fancybox({width:250}); 
```

html

```
<a href="#email_signup"><img src="...." /></a> 
```

**这是几个fancybox打开/关闭后的页脚代码：**

```
<div style="width:auto;height:auto;overflow: auto;position:relative;">
<div style="width:auto;height:auto;overflow: auto;position:relative;">

    <div id="email_signup" style="">
        <h1 style="">email signup</h1>
        <div id="mc_signup" style="">
            <form method="post" action="#mc_signup" id="mc_signup_form" style="">
                <!-- ... -->
            </form><!-- /mc_signup_form -->
        </div><!-- /mc_signup_container -->
    </div>

</div>
</div> 
```

**编辑**

我整理了一个jsfiddle来说明这种情况。 [http://jsfiddle.net/UD9P9/](http://jsfiddle.net/UD9P9/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:52:24.817

是的，这是使用`inline`内容时的一个已知错误。作为一种解决方法，请`onCleanup`按如下方式添加回调：

```
jQuery("#signMeUpBox a").fancybox({
 "width":250,
 "onCleanup": function() {
  var myContent = this.href;
  jQuery(myContent).unwrap();
 }
}); 
```

您可以在此处了解更多信息：[http ://groups.google.com/group/fancybox/browse_thread/thread/fab7b6d81a173b33](http://groups.google.com/group/fancybox/browse_thread/thread/fab7b6d81a173b33)

**注意**：解决方法适用于 v1.3.x，此错误在 v2.x 中不存在

# mysql - 基于距离的优化用户数据库搜索

> ID：11252534
> 
> 赞同：0
> 
> 时间：2012-06-28T20:38:55.250
> 
> 标签：mysql, database, zipcode

抱歉，如果这已经被回答（如果有的话，我相信有人会向我抛出链接）。前段时间想了一个类似的问题，但现在找不到了。

因此，对于这个问题：我正在为我正在开发的网站构建用户搜索，其中一个搜索条件将基于与搜索用户的距离。我已经有一张美国邮政编码及其对应的经纬度表。我还想出了如何确定边界框（最大纬度/最小纬度 - 最大长度/最小长度）以确定哪些拉链符合标准（我们不会担心精确的半径。地理正方形暂时够用了）。我的问题 - 我应该如何构建查询以优化速度？我是不是该：

*   执行所需的数学以确定边界框，然后查询邮政编码表以查找所有潜在候选邮政编码，然后搜索具有这些邮政编码的用户？

或者

*   确定纬度/经度边界框，将 zip 表与用户表连接起来，并返回纬度/经度介于参数之间的用户的结果？

我想第二种方法会更快，但我没有支持证据/具体经验表明它会。我知道足够多的 SQL 来解决问题，但我对它还是有点陌生​​，并且对于不同类型操作的相对性能一无所知。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:35:26.687

我相信您的最终查询应如下所示：

```
-- compute @minLat, @maxLat, @minLon, @maxLon

SELECT users.*
FROM users
JOIN locations ON locations.id = users.location
WHERE locations.latitude BETWEEN @minLat AND @maxLat
AND locations.longitude BETWEEN @minLon AND @maxLon 
```

所以在这种情况下，我不明白你的担忧，因为一切都是一次性发生的。查询优化器通常比任何人都知道`JOIN`首先执行哪个。

如果您想实现更复杂的计算来确定邮政编码是否在范围内，那么我宁愿首先建立一个邮政编码列表，然后匹配居住在这些地区的用户。

这假设计算邮政编码是否在搜索范围内是操作中成本最高的部分。因此，我更喜欢使用尽可能小的数据集（即仅邮政编码，而不是邮政编码 + 用户）运行此计算。即使在这种情况下，查询优化器也可能会为您做出正确的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:35:55.283

您描述的两种算法可以这样示意性地描述：

```
A INNER JOIN B WHERE A satisfies condition 
```

和

```
(A WHERE A satisfies condition) INNER JOIN B 
```

前者只是一个连接（条件可以是连接条件或 WHERE 条件，但这对于 INNER JOIN 和 MySQL 并不重要）。

后者涉及子查询。您的描述似乎假设首先计算子查询，然后是连接，但通常[情况并非如此](http://www.mysqlperformanceblog.com/2010/10/25/mysql-limitations-part-3-subqueries/)。首先评估内部连接，然后评估子查询，这很可能会为您提供与第一种情况相同的执行计划。

所以从性能的角度来看，这两种方法似乎没有什么不同，您应该专注于选择一种最容易阅读和维护的方法，并在这一天到来时对其进行[分析](https://serverfault.com/questions/3120/how-do-i-profile-mysql)和优化。

# android - 如何停止活动的动画

> ID：11252536
> 
> 赞同：1
> 
> 时间：2012-06-28T20:38:59.343
> 
> 标签：android

我有一个使用以下自定义主题显示为对话框的活动：

```
<style name="ThemeDialogNoAnimation">
    <item name="android:windowAnimationStyle">@null</item>
    <item name="android:windowEnterAnimation">@null</item>
    <item name="android:windowExitAnimation">@null</item>
    <item name="android:windowFrame">@null</item>
    <item name="android:windowContentOverlay">@null</item>
    <item name="android:windowIsFloating">true</item>
    <item name="android:background">@android:color/transparent</item>
    <item name="android:windowNoTitle">true</item>
    <item name="android:backgroundDimEnabled">true</item>
</style> 
```

注意我没有设置动画，但是当活动存在时仍然向右滑动。如何阻止它制作动画？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:56:26.460

您看到的动画很可能来自系统，但它们很容易被覆盖。

如果您不想在活动开始时进行转换：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    overridePendingTransition(0, 0);
} 
```

如果您不想在活动完成时进行转换：

```
@Override
public void finish() {
    super.finish();

    overridePendingTransition(0, 0);
} 
```

在覆盖转换信号时传入 0 向系统发出不使用转换的信号。代替 0，您还可以通过将资源标识符传递给动画资源来添加自己的自定义过渡。

# ipv6 - 将任意 IPv6 地址映射到单个 RIR（ARIN、RIPE 等）

> ID：11252538
> 
> 赞同：1
> 
> 时间：2012-06-28T20:39:20.873
> 
> 标签：ipv6, iana

将 IPv4 地址映射到它们的控制 RIR（ARIN、RIPE 等）很容易，因为 v4 地址由 IANA 在 /8 块中分发。我可以编写一个函数，它采用任意 IPv4 地址并通过检查该地址的前 8 位来计算出正确的 RIR。

不过，根据[http://www.iana.org/assignments/ipv6-unicast-address-assignments/ipv6-unicast-address-assignments.txt](http://www.iana.org/assignments/ipv6-unicast-address-assignments/ipv6-unicast-address-assignments.txt)，全球单播 IPv6 地址以不同大小的块形式分发。我看不出为什么这些块按照它们的大小分配的任何押韵或原因。这可能会使编写上述函数的 IPv6 版本变得很麻烦。

有没有一种简单的方法来判断哪个（全球单播）IPv6 地址属于哪个 RIR？还是我必须遍历所有分配的网络块，看看我的地址是否被其中一个覆盖？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:21:35.243

唯一的方法是匹配您提到的列表：解析列表并将您的地址与条目匹配。应该只有一个匹配的条目；这是你的结果。

为什么块有不同的大小？嗯，我认为这是有历史原因的。首先，只`2001:`分发地址；分配的块大小可能会因客户的不同需求而死。很快，他们注意到 /23 太小了。最终（在 2006 年左右），他们为每个 RIR 分配了一个 /12，现在必须考虑如何处理这个问题。这应该会持续一段时间；如果它们都被使用，将分配新的块。

# objective-c - freadoddity - 只阅读少量项目

> ID：11252541
> 
> 赞同：1
> 
> 时间：2012-06-28T20:39:38.813
> 
> 标签：objective-c, xcode, macos, fread

在一个相当大的命令行应用程序的中间，它一直在工作。进行了一些更改以处理大于我可以缓冲的文件并遇到来自`fread`.

```
DebugLog(@"Reading %d samples of a total %d samples of size %d, leaving %d samples remaining", numSamplesToRead, numSamplesInFile, sizeof(short) * channels * scaleFactor, numSamplesRemainingInFile);
DebugLog(@"Position in file is %d", ftell(in));
items = fread(dataBuffer, sizeof(short) * channels * scaleFactor, numSamplesToRead, in);
DebugLog(@"%d samples read", items);
DebugLog(@"Position in file is %d", ftell(in)); 
```

这将产生以下输出：

```
<main:(604)> Reading 29278208 samples of a total 115202048 samples of size 8, leaving 85923840 samples remaining
<main:(605)> Position in file is 512
<main:(607)> 448 samples read
<main:(608)> Position in file is 58560512 
```

（有问题的文件大小为 225008K。）

那么我如何才能读取每个 8 字节的 448 个样本并从位置 512 移动到位置 58560512？为什么没有读取请求的数据量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T06:44:38.653

的返回值`fread()`应与`nitems`参数相同（`numItemsToRead`在您的情况下为 ）。`items`和不同的事实`numItemsToRead`表明读取出现问题，但是由于文件指针已经超过已读取的内容，因此您的缓冲区可能有问题？

您应该检查`errno`和/或`ferror()`查看是否有任何相关信息。

# objective-c - CGPoint 到 CLLLocationCoordinate2D - convertPoint toCoordinateFromView 不起作用

> ID：11252542
> 
> 赞同：0
> 
> 时间：2012-06-28T20:39:56.550
> 
> 标签：objective-c

我有一个几个月前写的映射项目，我在其中使用了一个辅助类，它将触摸参数传递给我的主 mapview 类。使用以下方法，我通常可以将 CGPoint x 和 y 信息转换为地理坐标：

```
- (void)moveDetect:(NSSet *)touches :(UIEvent *)event {

UITouch *touch = [[event allTouches] anyObject];
CGPoint touchPoint = [touch locationInView:self.view];
NSLog(@"X:%f  Y:%f", touchPoint.x, touchPoint.y);

CLLocationCoordinate2D touchCoordinate = [self.mapView convertPoint:touchPoint toCoordinateFromView:self.mapView];

float lat = touchCoordinate.latitude;
float lng = touchCoordinate.longitude;
NSLog(@"Touch Coordinate: %f %f", lat, lng);} 
```

我最近尝试在不同的项目中重用代码，但没有发生转换。停止并进入 touchCoordinate 变量最初会显示值（纬度 = {CLLocationDegrees}3.23141e-306 和经度={CLLocationDegrees}5.46786e-48），但一旦你到达下一行代码，值都是 0。我已经审查了这两个项目，但无法弄清楚为什么一个有效而另一个无效。我很感激这段时间，并期待任何可以引导我走向正确方向的建议。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:49:57.807

用这个：

```
 - (void)moveDetect:(NSSet *)touches :(UIEvent *)event {

    UITouch *touch = [[event allTouches] anyObject];
    CGPoint touchPoint = [touch locationInView:self.mapView]; //here locationInView it would be mapView
    NSLog(@"X:%f  Y:%f", touchPoint.x, touchPoint.y);

    CLLocationCoordinate2D touchCoordinate = [self.mapView convertPoint:touchPoint toCoordinateFromView:self.mapView];
 } 
```

# sbt - macport 安装 sbt 0.11.3

> ID：11252544
> 
> 赞同：1
> 
> 时间：2012-06-28T20:39:57.423
> 
> 标签：sbt, macports

我的项目需要 sbt 0.11.3，但是，port install 只给了我 0.11.2。如何使用 macport 安装 sbt 0.11.3？

```
$ sudo port install sbt
--->  Installing sbt @0.11.2_0
--->  Activating sbt @0.11.2_0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T20:38:06.047

首先，您可以联系列为端口维护者的人。（一定`port info sbt`要找维护者）。然而，维护者更新端口可能需要一些时间，或者可能没有分配维护者（显示为“nomaintainer@macports.org”）。

[或者，您也可以在macports trac](http://trac.macports.org/)上提交票证。

但是如果你马上需要更新的版本，并且不想手动构建 sbt (configure;make;make install)。然后，您可以在本地 portfile 存储库中创建 sbt 的 portfile 的副本并更新该 portfile。

1.  创建本地 portfile 存储库：[howto](http://guide.macports.org/#development.local-repositories)
2.  复制 sbt portfile 目录（名为“sbt”的目录（路径“/opt/local/var/macports/sources/rsync.macports.org/release/ports/devel/sbt/”），包含文件“Portfile”和目录“文件”）到您的本地端口文件存储库
3.  编辑本地 sbt Portfile 以包含新的 sbt 版本号和校验和。
4.  `portindex`在本地 portfile 存储库中再次运行
5.  安装 sbt`port install -s sbt`

这仅适用于新版本与旧版本非常相似且不需要更改构建过程的情况。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T03:53:37.427

我在 8 月 16 日将 MacPorts 中的 sbt 更新为 0.12.0。正如 Vortexfive 所说，最好是使用 MacPorts 的 trac 来请求更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T21:51:31.890

据我了解，您安装的 sbt 只是启动器。如果你想使用不同版本的 sbt，你可以在 project/build.properties 中指定它，如下所示：

```
sbt.version=0.11.3

```

然后 0.11.2 sbt 启动器应该下载 sbt 版本 0.11.3，你可以在你的项目中使用它。我在我的本地机器上试过这个，它可以工作。

有关启动器的更多信息[https://github.com/harrah/xsbt/wiki/Launcher](https://github.com/harrah/xsbt/wiki/Launcher)

# f# - F# 计算表达式：如何使用“for”返回一个“seq”？

> ID：11252545
> 
> 赞同：5
> 
> 时间：2012-06-28T20:40:03.227
> 
> 标签：f#, computation-expression

我正在编写一个本质上实现**State monad**的计算表达式，并且我正在尝试使用`for`表达式。

我可以使用样板函数`forLoop`甚至`MBuilder.For()`，它们都返回一个`M<seq<'U>, _>`可以通过进一步`let!`表达处理的 nice 。但是当我尝试对`for`表达式做同样的事情时，它无法编译告诉我里面的表达式`for`必须 return `unit`。

对于无法缩小的大代码块，我感到很抱歉。

```
type M<'T, 'E> = 'T * 'E                 // Monadic type is a simple tuple
type MFunc<'T, 'U, 'E> = 'T -> M<'U, 'E> // A function producing monadic value

// typical boilerplate functions
let bind (x: M<'T, 'E>) (f: MFunc<'T, 'U, 'E>) : M<'U, 'E> =
    let a, s = x
    let b, s1 = f a
    b, s1 + s
let combine (e1: M<'T, 'E>) (e2: M<'U, 'E>) : M<'U, 'E> = bind e1 (fun _ -> e2)
let delay f = (fun () -> f())()

// These two are explained below
let combineList (e1: M<'T, 'E>) (e2: M<'T seq, 'E>) : M<'T seq, 'E> =
    bind
        e1
        (fun x1 ->
            let e2body, e2state = e2
            seq{yield! e2body; yield x1}, e2state
        )
let forLoop (xs: seq<'T>) (f: MFunc<'T, 'U, 'E>) : M<seq<'U>, 'E> =
    Seq.fold
        (fun s x -> combineList (f x) s)
        (Seq.empty<'U>, 0)
        xs

// Builder class
type MBuilder() =
    member this.Bind (x: M<'T, 'E>, f: MFunc<'T, 'U, 'E>) : M<'U, 'E> = bind x f
    member this.Return(a) = a, 0
    member this.Combine(e1,e2) = combine e1 e2
    member this.Delay(f) = delay f
    member this.Zero() = (), 0
    member this.For (xs: seq<'T>, f: MFunc<'T, 'U, 'E> ) : M<seq<'U>, 'E> = forLoop xs f
let stateful = new MBuilder()

let mTest = stateful {
    // below is the typical use, just for example
    let! var1 = "q", 3
    let! var2 = true, 4
    // so far so good, the monad returns ("test", 7)
    return "test"
    } 
```

现在，我正在尝试使用循环。以下三个调用按预期工作，增加状态的次数与`myList`. 他们还返回一个美丽的`string seq`，显然除了最后一个电话：

```
 let myList = ["one"; "two"; "three"] // define test data

    let! var3 = stateful.For(myList, (fun x -> x, 1))
    let! var4 = forLoop myList (fun x -> x, 1)

    // No return value, as expected
    for str in myList do
        let! _ = str, 1
        return "" 
```

但以下内容无法编译：`error FS0001: This expression was expected to have type M<'a,int> but here has type unit`

```
 let! var5 =
        for str in myList do
            let! _ = str, 1
            return "" 
```

所以我的问题是 -**我做错了**什么？

我也对[这里](http://msdn.microsoft.com/en-us/library/dd233182.aspx)`For`描述的两个重载以及如何使用它们感到有点困惑。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-28T20:51:17.920

您尝试编写的代码在语法上不是有效的计算表达式。该语法不允许`e`在`let! v = e`.

如果要使用嵌套计算表达式，则必须编写：

```
let mtest = stateful {
  let! var5 = 
    stateful { for str in myList do 
                 let! _ = str, 1 
                 return "" }
  return "something here" } 
```

这应该可以回答您的直接问题，但是我发现您的定义有很多令人困惑的地方：

*   你的类型`For`令人困惑。它应该是`seq<'T> -> ('T -> M<'R>) -> M<'R>`（如果您的 monad 可以组合多个结果）或`seq<'T> -> ('T -> M<unit>) -> M<unit>`（如果您的计算只返回一个值）

*   您有时在结果中使用`seq<'T>`inside `M<_>`(in `For`)，但有时您的 monad 只返回一个值。您应该在任何地方使用相同的单子类型。

*   该构造可以用和`For`来定义。除非您正在做一些特别的事情，否则这是最好的方法。请参阅[F# 规范中的示例](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html)。`Zero``Combine`

如果您想要更详细的文档，请查看[这篇文章](http://www.cl.cam.ac.uk/~tp322/drafts/notations.pdf)，其中描述了各种选项。

# ruby-on-rails-3 - Rails 教程 --> 如何“使用会话而不是 cookie”（第 8 章，练习 2）

> ID：11252564
> 
> 赞同：0
> 
> 时间：2012-06-28T20:41:10.747
> 
> 标签：ruby-on-rails-3, railstutorial.org

我被第 8 章的练习 2 难住了：

```
Use session instead of cookies so that users are automatically signed out when they close
their browsers. 
```

戳这里和 github，似乎实现这一点的方法是像这样修改 SessionsController：

```
def create
  user = User.find_by_email(params[:session][:email])
  if user && user.authenticate(params[:session][:password])
... 
```

但是当我这样做时，我无法再登录：

```
NoMethodError in SessionsController#create
undefined method `[]' for nil:NilClass 
```

我还需要修改什么才能使用会话而不是 cookie 进行身份验证？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-06T22:15:02.267

线索在错误中`NoMethodError in SessionsController#create`

# 那里的意思是 SessionsController 中的 create 方法。

# web-services - 如何使用对称密钥工作获取用户名？

> ID：11252566
> 
> 赞同：0
> 
> 时间：2012-06-28T20:41:33.483
> 
> 标签：web-services, security, jakarta-ee, glassfish, jax-ws

我有一个 Web 服务，它包装了一个使用 roleallowed annotation 和 jdbc realm 的 ejb 层。为了使我的 Swing 客户端的客户端身份验证工作，我启用了使用对称密钥（客户端+服务器）的用户名身份验证并设置了我的回调处理程序（客户端）。当我运行客户端并尝试访问受保护的方法时，我得到了这个异常：

```
Grave: WSSTUBE0025: Error in Verifying Security in the Inbound Message.
com.sun.xml.wss.impl.PolicyViolationException: ERROR: No security header found in the message
    at com.sun.xml.wss.impl.policy.verifier.MessagePolicyVerifier.verifyPolicy(MessagePolicyVerifier.java:138)
    at com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.createMessage(SecurityRecipient.java:1003)
    at com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.validateMessage(SecurityRecipient.java:248) 
```

在服务器端我得到：

```
Key used to decrypt EncryptedKey cannot be null
com.sun.xml.wss.logging.impl.opt.crypto Error occured while decrypting EncryptedKey     

WSITPVD0035: Error in Verifying Security in Inbound Message. com.sun.xml.wss.impl.WssSoapFaultException: Invalid Security Header at 
```

和

```
com.sun.xml.ws.security.opt.impl.util.SOAPUtil.newSOAPFaultException(SOAPUtil.java:159) at 
    com.sun.xml.ws.security.opt.impl.incoming.EncryptedKey.getKey(EncryptedKey.java:354) at 
    com.sun.xml.ws.security.opt.impl.incoming.KeySelectorImpl.resolveDirectReference(KeySelectorImpl.java:540) at 
    com.sun.xml.ws.security.opt.impl.incoming.processor.SecurityTokenProcessor.processDirectReference(SecurityTokenProcessor.java:267) at 
    com.sun.xml.ws.security.opt.impl.incoming.processor.SecurityTokenProcessor.resolveReference(SecurityTokenProcessor.java:143) at 
    com.sun.xml.ws.security.opt.impl.incoming.processor.KeyInfoProcessor.processKeyInfo(KeyInfoProcessor.java:152) at 
    com.sun.xml.ws.security.opt.impl.incoming.processor.KeyInfoProcessor.getKey(KeyInfoProcessor.java:132) at 
    com.sun.xml.ws.security.opt.impl.incoming.EncryptedData.process(EncryptedData.java:156) at 
    com.sun.xml.ws.security.opt.impl.incoming.EncryptedData.<init>(EncryptedData.java:113) at 
    com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.handleSecurityHeader(SecurityRecipient.java:458) at 
    com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.cacheHeaders(SecurityRecipient.java:291) at 
    com.sun.xml.ws.security.opt.impl.incoming.SecurityRecipient.validateMessage(SecurityRecipient.java:241) at 
    com.sun.xml.wss.provider.wsit.WSITServerAuthContext.verifyInboundMessage(WSITServerAuthContext.java:588) at 
    com.sun.xml.wss.provider.wsit.WSITServerAuthContext.validateRequest(WSITServerAuthContext.java:361) at 
    com.sun.xml.wss.provider.wsit.WSITServerAuthContext.validateRequest(WSITServerAuthContext.java:264) at 
    com.sun.enterprise.security.webservices.CommonServerSecurityPipe.processRequest(CommonServerSecurityPipe.java:173) at 
    com.sun.enterprise.security.webservices.CommonServerSecurityPipe.process(CommonServerSecurityPipe.java:144) at 
    com.sun.xml.ws.api.pipe.helper.PipeAdapter.processRequest(PipeAdapter.java:119) at 
    com.sun.xml.ws.api.pipe.Fiber.__doRun(Fiber.java:961) at 
    com.sun.xml.ws.api.pipe.Fiber._doRun(Fiber.java:910) at 
    com.sun.xml.ws.api.pipe.Fiber.doRun(Fiber.java:873) at 
    com.sun.xml.ws.api.pipe.Fiber.runSync(Fiber.java:775) at 
    com.sun.xml.ws.server.WSEndpointImpl$2.process(WSEndpointImpl.java:386) at 
    com.sun.xml.ws.transport.http.HttpAdapter$HttpToolkit.handle(HttpAdapter.java:640) at 
    com.sun.xml.ws.transport.http.HttpAdapter.handle(HttpAdapter.java:263) at 
    com.sun.xml.ws.transport.http.servlet.ServletAdapter.handle(ServletAdapter.java:163) at 
    org.glassfish.webservices.Ejb3MessageDispatcher.handlePost(Ejb3MessageDispatcher.java:120) at 
    org.glassfish.webservices.Ejb3MessageDispatcher.invoke(Ejb3MessageDispatcher.java:91) at 
    org.glassfish.webservices.EjbWebServiceServlet.dispatchToEjbEndpoint(EjbWebServiceServlet.java:200) at 
    org.glassfish.webservices.EjbWebServiceServlet.service(EjbWebServiceServlet.java:131) at 
    javax.servlet.http.HttpServlet.service(HttpServlet.java:770) at 
    com.sun.grizzly.http.servlet.ServletAdapter$FilterChainImpl.doFilter(ServletAdapter.java:1059) at 
    com.sun.grizzly.http.servlet.ServletAdapter$FilterChainImpl.invokeFilterChain(ServletAdapter.java:999) at 
    com.sun.grizzly.http.servlet.ServletAdapter.doService(ServletAdapter.java:434) at 
    com.sun.grizzly.http.servlet.ServletAdapter.service(ServletAdapter.java:384) at 
    com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179) at 
    com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117) at 
    com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354) at 
    com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195) at 
    com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849) at 
    com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746) at 
    com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045) at 
    com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228) at 
    com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137) at 
```

这是我第一次使用 Web 服务安全性，可能我忘记了要添加的基本内容。

你能帮助我吗 ？

谢谢 。

**编辑：** 这是 web 服务客户端 xml： *删除导致空间不足* **和服务器端**

```
<?xml version="1.0" encoding="UTF-8"?> 
<definitions 
    xmlns="http://schemas.xmlsoap.org/wsdl/" 
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" name="custom_ws" targetNamespace="http://ejb/" xmlns:tns="http://ejb/" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:fi="http://java.sun.com/xml/ns/wsit/2006/09/policy/fastinfoset/service" xmlns:tcp="http://java.sun.com/xml/ns/wsit/2006/09/policy/soaptcp/service" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:sc="http://schemas.sun.com/2006/03/wss/server" xmlns:wspp="http://java.sun.com/xml/ns/wsit/policy" 
>
    <message name="hmd"/>
    <message name="hmdResponse"/>
    <portType name="custom_ws">
        <operation name="hmd">
            <input message="tns:hmd"/>
            <output message="tns:hmdResponse"/>
        </operation>
    </portType>
    <binding name="custom_wsPortBinding" type="tns:custom_ws">
        <wsp:PolicyReference URI="#custom_wsPortBindingPolicy"/>
        <operation name="hmd">
            <input>
                <wsp:PolicyReference URI="#custom_wsPortBinding_hmd_Input_Policy"/>
            </input>
            <output>
                <wsp:PolicyReference URI="#custom_wsPortBinding_hmd_Output_Policy"/>
            </output>
        </operation>
    </binding>
    <service name="custom_ws">
        <port name="custom_wsPort" binding="tns:custom_wsPortBinding"/>
    </service>
    <wsp:Policy wsu:Id="custom_wsPortBindingPolicy">
        <wsp:ExactlyOne>
            <wsp:All>
                <wsam:Addressing wsp:Optional="false"/>
                <sp:SymmetricBinding>
                    <wsp:Policy>
                        <sp:ProtectionToken>
                            <wsp:Policy>
                                <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
                                    <wsp:Policy>
                                        <sp:WssX509V3Token10/>
                                        <sp:RequireIssuerSerialReference/>
                                    </wsp:Policy>
                                </sp:X509Token>
                            </wsp:Policy>
                        </sp:ProtectionToken>
                        <sp:Layout>
                            <wsp:Policy>
                                <sp:Strict/>
                            </wsp:Policy>
                        </sp:Layout>
                        <sp:IncludeTimestamp/>
                        <sp:OnlySignEntireHeadersAndBody/>
                        <sp:AlgorithmSuite>
                            <wsp:Policy>
                                <sp:Basic128/>
                            </wsp:Policy>
                        </sp:AlgorithmSuite>
                    </wsp:Policy>
                </sp:SymmetricBinding>
                <sp:Wss11>
                    <wsp:Policy>
                        <sp:MustSupportRefIssuerSerial/>
                        <sp:MustSupportRefThumbprint/>
                        <sp:MustSupportRefEncryptedKey/>
                    </wsp:Policy>
                </sp:Wss11>
                <sp:SignedEncryptedSupportingTokens>
                    <wsp:Policy>
                        <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                            <wsp:Policy>
                                <sp:WssUsernameToken10/>
                            </wsp:Policy>
                        </sp:UsernameToken>
                    </wsp:Policy>
                </sp:SignedEncryptedSupportingTokens>
                <sc:KeyStore wspp:visibility="private" location="C:\glassfish312\glassfish\domains\domain1\config\keystore.jks" type="JKS" storepass="changeit" alias="xws-security-server"/>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
    <wsp:Policy wsu:Id="custom_wsPortBinding_hmd_Input_Policy">
        <wsp:ExactlyOne>
            <wsp:All>
                <sp:EncryptedParts>
                    <sp:Body/>
                </sp:EncryptedParts>
                <sp:SignedParts>
                    <sp:Body/>
                    <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                    <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                    <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                    <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                </sp:SignedParts>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
    <wsp:Policy wsu:Id="custom_wsPortBinding_hmd_Output_Policy">
        <wsp:ExactlyOne>
            <wsp:All>
                <sp:EncryptedParts>
                    <sp:Body/>
                </sp:EncryptedParts>
                <sp:SignedParts>
                    <sp:Body/>
                    <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing"/>
                    <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                    <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                    <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                    <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702"/>
                </sp:SignedParts>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
</definitions> 
```

**编辑 2** 我添加了客户端似乎缺少的部分，但它仍然无法正常工作，我得到了同样的异常，但有很多警告

```
 <?xml version='1.0' encoding='UTF-8'?><!-- Published by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is Metro/2.2-b13 (branches/2.2-6964; 2012-01-09T18:04:18+0000) JAXWS-RI/2.2.6-promoted-b20 JAXWS/2.2 svn-revision#unknown. --><!-- Generated by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is Metro/2.2-b13 (branches/2.2-6964; 2012-01-09T18:04:18+0000) JAXWS-RI/2.2.6-promoted-b20 JAXWS/2.2 svn-revision#unknown. -->
    <definitions xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsp1_2="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://ejb/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/wsdl/" targetNamespace="http://ejb/" name="custom_ws" xmlns:sc="http://schemas.sun.com/2006/03/wss/client" xmlns:wspp="http://java.sun.com/xml/ns/wsit/policy">
        <types>
            <xsd:schema>
                <xsd:import namespace="http://ejb/" schemaLocation="http://myurl.net:8080/custom_ws/custom_ws?xsd=1"/>
            </xsd:schema>
        </types>
        <message name="hmd">
            <part name="parameters" element="tns:hmd"/>
        </message>
        <message name="hmdResponse">
            <part name="parameters" element="tns:hmdResponse"/>
        </message>
        <portType name="custom_ws">
            <operation name="hmd">
                <input wsam:Action="http://ejb/custom_ws/hmdRequest" message="tns:hmd"/>
                <output wsam:Action="http://ejb/custom_ws/hmdResponse" message="tns:hmdResponse"/>
            </operation>
        </portType>
        <binding name="custom_wsPortBinding" type="tns:custom_ws">
            <wsp:PolicyReference URI="#custom_wsPortBindingPolicy"/>
            <soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
            <operation name="hmd">
                <soap:operation soapAction=""/>
                <input>
                    <soap:body use="literal"/>
                </input>
                <output>
                    <soap:body use="literal"/>
                </output>
            </operation>
        </binding>
        <service name="custom_ws">
            <port name="custom_wsPort" binding="tns:custom_wsPortBinding">
                <soap:address location="http://my_url.net:8080/custom_ws/custom_ws"/>
            </port>
        </service>
        <wsp:Policy wsu:Id="custom_wsPortBindingPolicy">
            <wsp:ExactlyOne>
                <wsp:All>
                   <wsam:Addressing wsp:Optional="false"/>
                    <wsp:SymmetricBinding>
                        <wsp:Policy>
                            <wsp:ProtectionToken>
                                <wsp:Policy>
                                    <wsp:X509Token wsp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
                                        <wsp:Policy>
                                            <wsp:WssX509V3Token10/>
                                            <wsp:RequireIssuerSerialReference/>
                                        </wsp:Policy>
                                    </wsp:X509Token>
                                </wsp:Policy>
                            </wsp:ProtectionToken>
                            <wsp:Layout>
                                <wsp:Policy>
                                    <wsp:Strict/>
                                </wsp:Policy>
                            </wsp:Layout>
                            <wsp:IncludeTimestamp/>
                            <wsp:OnlySignEntireHeadersAndBody/>
                            <wsp:AlgorithmSuite>
                                <wsp:Policy>
                                    <wsp:Basic128/>
                                </wsp:Policy>
                            </wsp:AlgorithmSuite>
                        </wsp:Policy>
                    </wsp:SymmetricBinding>
                    <wsp:Wss11>
                        <wsp:Policy>
                            <wsp:MustSupportRefIssuerSerial/>
                            <wsp:MustSupportRefThumbprint/>
                            <wsp:MustSupportRefEncryptedKey/>
                        </wsp:Policy>
                    </wsp:Wss11>
                    <wsp:SignedEncryptedSupportingTokens>
                        <wsp:Policy>
                            <wsp:UsernameToken wsp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                                <wsp:Policy>
                                    <wsp:WssUsernameToken10/>
                                </wsp:Policy>
                            </wsp:UsernameToken>
                        </wsp:Policy>
                    </wsp:SignedEncryptedSupportingTokens>

                    <sc:TrustStore wspp:visibility="private" location="C:\glassfish312\glassfish\domains\domain1\config\cacerts.jks" type="JKS" storepass="changeit" peeralias="xws-security-server"/>
                    <sc:CallbackHandlerConfiguration wspp:visibility="private">
                        <sc:CallbackHandler name="usernameHandler" classname="Gui.ociCallBackHandler"/>
                        <sc:CallbackHandler name="passwordHandler" classname="Gui.ociCallBackHandler"/>
                    </sc:CallbackHandlerConfiguration>
                </wsp:All>
            </wsp:ExactlyOne>
        </wsp:Policy>
    </definitions> 
```

警告 *删除导致空间不足*

**编辑 3** 这是第二次尝试使用 xml 客户端文件：

```
<?xml version='1.0' encoding='UTF-8'?><!-- Published by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is Metro/2.2-b13 (branches/2.2-6964; 2012-01-09T18:04:18+0000) JAXWS-RI/2.2.6-promoted-b20 JAXWS/2.2 svn-revision#unknown. --><!-- Generated by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is Metro/2.2-b13 (branches/2.2-6964; 2012-01-09T18:04:18+0000) JAXWS-RI/2.2.6-promoted-b20 JAXWS/2.2 svn-revision#unknown. -->
<definitions xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsp1_2="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://ejb/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/wsdl/" targetNamespace="http://ejb/" name="custom_ws" xmlns:sc="http://schemas.sun.com/2006/03/wss/client" xmlns:wspp="http://java.sun.com/xml/ns/wsit/policy">
    <types>
        <xsd:schema>
            <xsd:import namespace="http://ejb/" schemaLocation="http://my_url.net:8080/custom_ws/custom_ws?xsd=1"/>
        </xsd:schema>
    </types>
    <message name="hmd" />
    <message name="hmdResponse" />
    <portType name="custom_ws">
        <operation name="hmd">
            <input message="tns:hmd" />
            <output message="tns:hmdResponse" />
        </operation>
    </portType>
    <binding name="custom_wsPortBinding" type="tns:custom_ws">
        <wsp:PolicyReference URI="#custom_wsPortBindingPolicy" />
        <operation name="hmd">
            <input>
                <wsp:PolicyReference URI="#custom_wsPortBinding_hmd_Input_Policy" />
            </input>
            <output>
                <wsp:PolicyReference URI="#custom_wsPortBinding_hmd_Output_Policy" />
            </output>
        </operation>
    </binding>
    <service name="custom_ws">
        <port name="custom_wsPort" binding="tns:custom_wsPortBinding" />
    </service>
    <wsp:Policy wsu:Id="custom_wsPortBindingPolicy">
        <wsp:All>
            <wsp:Policy>
                <wsp:ExactlyOne>
                    <wsp:All>
                        <sc:TrustStore wspp:visibility="private" location="C:\glassfish312\glassfish\domains\domain1\config\cacerts.jks" type="JKS" storepass="changeit" peeralias="xws-security-server" />
                        <sc:CallbackHandlerConfiguration wspp:visibility="private">
                            <sc:CallbackHandler name="usernameHandler" classname="Gui.ociCallBackHandler" />
                            <sc:CallbackHandler name="passwordHandler" classname="Gui.ociCallBackHandler" />
                        </sc:CallbackHandlerConfiguration>
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
            <wsp:Policy>
                <wsp:ExactlyOne>
                    <wsp:All>
                        <wsam:Addressing wsp:Optional="false" />
                        <wsp:SymmetricBinding>
                            <wsp:Policy>
                                <wsp:ProtectionToken>
                                    <wsp:Policy>
                                        <wsp:X509Token wsp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
                                            <wsp:Policy>
                                                <wsp:WssX509V3Token10 />
                                                <wsp:RequireIssuerSerialReference />
                                            </wsp:Policy>
                                        </wsp:X509Token>
                                    </wsp:Policy>
                                </wsp:ProtectionToken>
                                <wsp:Layout>
                                    <wsp:Policy>
                                        <wsp:Strict />
                                    </wsp:Policy>
                                </wsp:Layout>
                                <wsp:IncludeTimestamp />
                                <wsp:OnlySignEntireHeadersAndBody />
                                <wsp:AlgorithmSuite>
                                    <wsp:Policy>
                                        <wsp:Basic128 />
                                    </wsp:Policy>
                                </wsp:AlgorithmSuite>
                            </wsp:Policy>
                        </wsp:SymmetricBinding>
                        <wsp:Wss11>
                            <wsp:Policy>
                                <wsp:MustSupportRefIssuerSerial />
                                <wsp:MustSupportRefThumbprint />
                                <wsp:MustSupportRefEncryptedKey />
                            </wsp:Policy>
                        </wsp:Wss11>
                        <wsp:SignedEncryptedSupportingTokens>
                            <wsp:Policy>
                                <wsp:UsernameToken wsp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                                    <wsp:Policy>
                                        <wsp:WssUsernameToken10 />
                                    </wsp:Policy>
                                </wsp:UsernameToken>
                            </wsp:Policy>
                        </wsp:SignedEncryptedSupportingTokens>
                        <sc:KeyStore wspp:visibility="private" location="C:\glassfish312\glassfish\domains\domain1\config\keystore.jks" type="JKS" storepass="changeit" alias="xws-security-server" />
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
        </wsp:All>
    </wsp:Policy>
    <wsp:Policy wsu:Id="custom_wsPortBinding_hmd_Input_Policy">
        <wsp:ExactlyOne>
            <wsp:All>
                <wsp:EncryptedParts>
                    <wsp:Body />
                </wsp:EncryptedParts>
                <wsp:SignedParts>
                    <wsp:Body />
                    <wsp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <wsp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <wsp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <wsp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                </wsp:SignedParts>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
    <wsp:Policy wsu:Id="custom_wsPortBinding_hmd_Output_Policy">
        <wsp:ExactlyOne>
            <wsp:All>
                <wsp:EncryptedParts>
                    <wsp:Body />
                </wsp:EncryptedParts>
                <wsp:SignedParts>
                    <wsp:Body />
                    <wsp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                    <wsp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <wsp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <wsp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <wsp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                </wsp:SignedParts>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
</definitions> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:33:04.023

哇哦。客户端 wsdl 没有 ws-sec-policy。客户应该如何知道使用它？客户端和服务器 wsdl 必须相同，除了一些实现细节。（例如密码回调处理程序类名，但这些可以对客户端隐藏）

始终为客户端使用已发布的 wsdl，否则整个 wsdl 合同毫无意义：可以说客户端和服务器将使用不同的语言进行交谈。

使用客户端上的原始 wsdl 并将回调特定策略放在 wsit.xml 中。

编辑：

如果没有自动 wsit 合并（我猜您使用 CXF，因为 Metro 会为您完成），您必须手动合并：

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" name="custom_ws" targetNamespace="http://ejb/" xmlns:tns="http://ejb/" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:fi="http://java.sun.com/xml/ns/wsit/2006/09/policy/fastinfoset/service" xmlns:tcp="http://java.sun.com/xml/ns/wsit/2006/09/policy/soaptcp/service" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:sc="http://schemas.sun.com/2006/03/wss/server" xmlns:wspp="http://java.sun.com/xml/ns/wsit/policy">
    <message name="hmd" />
    <message name="hmdResponse" />
    <portType name="custom_ws">
        <operation name="hmd">
            <input message="tns:hmd" />
            <output message="tns:hmdResponse" />
        </operation>
    </portType>
    <binding name="custom_wsPortBinding" type="tns:custom_ws">
        <wsp:PolicyReference URI="#custom_wsPortBindingPolicy" />
        <operation name="hmd">
            <input>
                <wsp:PolicyReference URI="#custom_wsPortBinding_hmd_Input_Policy" />
            </input>
            <output>
                <wsp:PolicyReference URI="#custom_wsPortBinding_hmd_Output_Policy" />
            </output>
        </operation>
    </binding>
    <service name="custom_ws">
        <port name="custom_wsPort" binding="tns:custom_wsPortBinding" />
    </service>
    <wsp:Policy wsu:Id="custom_wsPortBindingPolicy">
        <wsp:All>
            <wsp:Policy>
                <wsp:ExactlyOne>
                    <wsp:All>
                        <sc:TrustStore wspp:visibility="private" location="C:\glassfish312\glassfish\domains\domain1\config\cacerts.jks" type="JKS" storepass="changeit" peeralias="xws-security-server" />
                        <sc:CallbackHandlerConfiguration wspp:visibility="private">
                            <sc:CallbackHandler name="usernameHandler" classname="Gui.ociCallBackHandler" />
                            <sc:CallbackHandler name="passwordHandler" classname="Gui.ociCallBackHandler" />
                        </sc:CallbackHandlerConfiguration>
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
            <wsp:Policy>
                <wsp:ExactlyOne>
                    <wsp:All>
                        <wsam:Addressing wsp:Optional="false" />
                        <sp:SymmetricBinding>
                            <wsp:Policy>
                                <sp:ProtectionToken>
                                    <wsp:Policy>
                                        <sp:X509Token sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/Never">
                                            <wsp:Policy>
                                                <sp:WssX509V3Token10 />
                                                <sp:RequireIssuerSerialReference />
                                            </wsp:Policy>
                                        </sp:X509Token>
                                    </wsp:Policy>
                                </sp:ProtectionToken>
                                <sp:Layout>
                                    <wsp:Policy>
                                        <sp:Strict />
                                    </wsp:Policy>
                                </sp:Layout>
                                <sp:IncludeTimestamp />
                                <sp:OnlySignEntireHeadersAndBody />
                                <sp:AlgorithmSuite>
                                    <wsp:Policy>
                                        <sp:Basic128 />
                                    </wsp:Policy>
                                </sp:AlgorithmSuite>
                            </wsp:Policy>
                        </sp:SymmetricBinding>
                        <sp:Wss11>
                            <wsp:Policy>
                                <sp:MustSupportRefIssuerSerial />
                                <sp:MustSupportRefThumbprint />
                                <sp:MustSupportRefEncryptedKey />
                            </wsp:Policy>
                        </sp:Wss11>
                        <sp:SignedEncryptedSupportingTokens>
                            <wsp:Policy>
                                <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
                                    <wsp:Policy>
                                        <sp:WssUsernameToken10 />
                                    </wsp:Policy>
                                </sp:UsernameToken>
                            </wsp:Policy>
                        </sp:SignedEncryptedSupportingTokens>
                        <sc:KeyStore wspp:visibility="private" location="C:\glassfish312\glassfish\domains\domain1\config\keystore.jks" type="JKS" storepass="changeit" alias="xws-security-server" />
                    </wsp:All>
                </wsp:ExactlyOne>
            </wsp:Policy>
        </wsp:All>
    </wsp:Policy>
    <wsp:Policy wsu:Id="custom_wsPortBinding_hmd_Input_Policy">
        <wsp:ExactlyOne>
            <wsp:All>
                <sp:EncryptedParts>
                    <sp:Body />
                </sp:EncryptedParts>
                <sp:SignedParts>
                    <sp:Body />
                    <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                </sp:SignedParts>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
    <wsp:Policy wsu:Id="custom_wsPortBinding_hmd_Output_Policy">
        <wsp:ExactlyOne>
            <wsp:All>
                <sp:EncryptedParts>
                    <sp:Body />
                </sp:EncryptedParts>
                <sp:SignedParts>
                    <sp:Body />
                    <sp:Header Name="To" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="From" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="FaultTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="ReplyTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="MessageID" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="RelatesTo" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="Action" Namespace="http://www.w3.org/2005/08/addressing" />
                    <sp:Header Name="AckRequested" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <sp:Header Name="SequenceAcknowledgement" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <sp:Header Name="Sequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                    <sp:Header Name="CreateSequence" Namespace="http://docs.oasis-open.org/ws-rx/wsrm/200702" />
                </sp:SignedParts>
            </wsp:All>
        </wsp:ExactlyOne>
    </wsp:Policy>
</definitions> 
```

希望它会工作。请注意包含客户端策略。这可能看起来很奇怪，但最终这一切都是有道理的。

请参阅[http://www.w3.org/TR/ws-policy/](http://www.w3.org/TR/ws-policy/)以获取完整参考。

# c# - 如何使用 ASP.NET 反序列化 JavaScript 数组

> ID：11252568
> 
> 赞同：2
> 
> 时间：2012-06-28T20:41:42.320
> 
> 标签：c#, javascript, jquery, asp.net, json

我有以下 JavaScript 代码：

```
var x = ['CFMG','JMFMG','CPMAF'];
var y = $.param({'test':x});
var data = "Operation=xxx&" + y;
$.post(
    "xxx.ashx",
    data,
    function() { ... }
); 
```

铬合金`console.log(data)`

```
Operation=xxx&test%5B%5D=4CFMG&test%5B%5D=JMFMG&test%5B%5D=CPMAF 
```

我的 ASP.NET 代码收到了这个：

```
{Operation=xxx&test%5b%5d=4CFMG&test%5b%5d=JMFMG&test%5b%5d=CPMAF}
[System.Web.HttpValueCollection]: {Operation=xxx&test%5b%5d=4CFMG&test%5b%5d=JMFMG&test%5b%5d=CPMAF}
base {System.Collections.Specialized.NameObjectCollectionBase}: {Operation=xxx&test%5b%5d=4CFMG&test%5b%5d=JMFMG&test%5b%5d=CPMAF}
AllKeys: {Dimensions:[2]} 
```

全键

```
{Dimensions:[2]}
[0]: "Operation"
[1]: "test[]" 
```

在即时窗口中，如果我输入，`?var["Test[]"]`我会得到：

```
?var["Test[]"]
"4CFMG,JMFMG,CPMAF" 
```

如何将`Test[]`值转换为数组？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:33:25.853

将您的 javascrpt 数组转换为 json 对象，然后将您的数据发布到服务器。我建议您使用[JSON.NET](http://james.newtonking.com/projects/json-net.aspx)。它是一个开源库，可将您的 c# 对象序列化和反序列化为 json，反之亦然...

例如：

```
string json = @"{
  ""Name"": ""Apple"",
  ""Expiry"": new Date(1230422400000),
  ""Price"": 3.99,
  ""Sizes"": [
    ""Small"",
    ""Medium"",
    ""Large""
  ]
}";

JObject o = JObject.Parse(json);

string name = (string)o["Name"];
// Apple

JArray sizes = (JArray)o["Sizes"];

string smallest = (string)sizes[0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T19:41:43.213

我更改了我的 JavaScript 代码，现在可以了。

我曾经`JSON.stringify`将 JavaScript 数组解析为字符串并将其发送到 ASP.NET。

新的 JavaScript 代码：

```
var x = ['CFMG','JMFMG','CPMAF'];
var y = JSON.stringify(x);
var data = "Operation=xxx&test=" + y;
$.post(
    "xxx.ashx",
    data,
    function() { ... }
); 
```

铬合金`console.log(data)`

```
Operation=xxx&test=["4CFMG","JMFMG","CPMAF"] 
```

我的 ASP.NET 代码现在收到这个：

```
{Operation=xxx&test=%5b%224CFMG%22%2c%22JMFMG%22%2c%22CPMAF%22%5d}
[System.Web.HttpValueCollection]: {Operation=xxx&test=%5b%224CFMG%22%2c%22JMFMG%22%2c%22CPMAF%22%5d}
base {System.Collections.Specialized.NameObjectCollectionBase}: {Operation=xxx&test=%5b%224CFMG%22%2c%22JMFMG%22%2c%22CPMAF%22%5d}
AllKeys: {Dimensions:[2]} 
```

全键

```
{Dimensions:[2]}
[0]: "Operation"
[1]: "test" 
```

在即时窗口中，如果我输入，`?vari["test"]`我会得到：

```
?vari["test"]
"[\"4CFMG\",\"JMFMG\",\"CPMAF\"]" 
```

ASP.Net 代码转换为数组

```
string[] blah = json.Deserialize<string[]>(vari["test"]); 
```

即时窗口：`?blah`

```
?blah
{Dimensions:[3]}
[0]: "4CFMG"
[1]: "JMFMG"
[2]: "CPMAF" 
```

非常感谢你！

# python - 如何检查网站上的值是否已更改

> ID：11252576
> 
> 赞同：10
> 
> 时间：2012-06-28T20:42:16.570
> 
> 标签：python, compare

基本上，如果网站上的值发生变化，我会尝试运行一些代码（Python 3.2），否则请稍等片刻，稍后再检查。

首先，我认为我可以将值保存在变量中，并将其与下次运行脚本时获取的新值进行比较。但这很快就遇到了问题，因为当脚本再次运行并初始化该变量时，该值被覆盖。

因此，我尝试将网页的 html 保存为文件，然后将其与下次脚本运行时调用的 html 进行比较。那里也没有运气，因为即使没有变化，它也会不断出现 False。

接下来是对网页进行腌制，然后尝试将其与 html 进行比较。有趣的是，这在脚本中也不起作用。但是，如果我在脚本运行后键入 file = pickle.load( open( 'D:\Download\htmlString.p', 'rb')) 然后 file == html，它会在没有出现时显示 True任何变化。

我有点困惑为什么脚本运行时它不起作用，但如果我执行上述操作，它会显示正确的答案。

编辑：感谢到目前为止的回复。我遇到的问题并不是关于其他方法来解决这个问题（尽管学习更多完成任务的方法总是好的！）而是为什么下面的代码在作为脚本运行时不起作用，但是如果我脚本运行后在提示符处重新加载 pickle 对象，然后针对 html 对其进行测试，如果没有任何更改，它将返回 True 。

```
try: 
    file = pickle.load( open( 'D:\\Download\\htmlString.p', 'rb'))
    if pickle.load( open( 'D:\\Download\\htmlString.p', 'rb')) == htmlString:
        print("Values haven't changed!")
        sys.exit(0)
    else:
        pickle.dump( htmlString, open( 'D:\\Download\\htmlString.p', "wb" ) )  
        print('Saving')
except: 
    pickle.dump( htmlString, open( 'D:\\Download\\htmlString.p', "wb" ) )
    print('ERROR') 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T23:01:56.390

**编辑**：我没有意识到您只是在寻找脚本的问题。这就是我认为的问题，然后是我的原始答案，它解决了您要解决的更大问题的另一种方法。

你的脚本是使用一揽子`except`陈述的危险的一个很好的例子：你抓住了一切。在这种情况下，包括您的`sys.exit(0)`.

我假设你被`try`阻止是为了捕捉`D:\Download\htmlString.p`尚不存在的情况。那个错误被称为`IOError`，你可以专门用`except IOError:`

这是您的脚本和一些代码，可以解决您的`except`问题：

```
import sys
import pickle
import urllib2

request = urllib2.Request('http://www.iana.org/domains/example/')
response = urllib2.urlopen(request) # Make the request
htmlString = response.read()

try: 
    file = pickle.load( open( 'D:\\Download\\htmlString.p', 'rb'))
    if file == htmlString:
        print("Values haven't changed!")
        sys.exit(0)
    else:
        pickle.dump( htmlString, open( 'D:\\Download\\htmlString.p', "wb" ) )  
        print('Saving')
except IOError: 
    pickle.dump( htmlString, open( 'D:\\Download\\htmlString.p', "wb" ) )
    print('Created new file.') 
```

作为旁注，您可能会考虑使用[`os.path`](http://docs.python.org/dev/library/os.path.html)文件路径——它将帮助以后想要在另一个平台上使用您的脚本的任何人，并且它可以为您节省丑陋的双反斜杠。

**编辑 2**：适用于您的特定 URL。

该页面上的广告有一个动态生成的数字，该数字随着每次页面加载而变化。在所有内容之后，它就在末尾附近，因此我们可以在该点拆分 HTML 字符串并取前半部分，丢弃带有动态数字的部分。

```
import sys
import pickle
import urllib2

request = urllib2.Request('http://ecal.forexpros.com/e_cal.php?duration=weekly')
response = urllib2.urlopen(request) # Make the request
# Grab everything before the dynabic double-click link
htmlString = response.read().split('<iframe src="http://fls.doubleclick')[0]

try: 
    file = pickle.load( open( 'D:\\Download\\htmlString.p', 'r'))
    if pickle.load( open( 'D:\\Download\\htmlString.p', 'r')) == htmlString:
        print("Values haven't changed!")
        sys.exit(0)
    else:
        pickle.dump( htmlString, open( 'D:\\Download\\htmlString.p', "w" ) )  
        print('Saving')
except IOError: 
    pickle.dump( htmlString, open( 'D:\\Download\\htmlString.p', "w" ) )
    print('Created new file.') 
```

如果这很重要，您的字符串*不再*是有效的 HTML 文档。如果是这样，您可能会删除该行或其他内容。可能有一种更优雅的方式来做到这一点——也许用正则表达式删除数字——但这至少可以满足你的问题。

**原始答案**-解决您的问题的另一种方法。

来自 Web 服务器的响应标头是什么样的？HTTP 指定了一个[`Last-Modified`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.29)属性，您可以使用它来检查内容是否已更改（假设服务器说的是真话）。`HEAD`正如 Uku 在他的回答中显示的那样，将这个与请求一起使用。如果您想节省带宽并对正在轮询的服务器友好。

还有一个[`If-Modified-Since`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.25)标题，听起来像您可能正在寻找的东西。

如果我们把它们结合起来，你可能会想出这样的东西：

```
import sys
import os.path
import urllib2

url = 'http://www.iana.org/domains/example/'
saved_time_file = 'last time check.txt'

request = urllib2.Request(url)
if os.path.exists(saved_time_file):
    """ If we've previously stored a time, get it and add it to the request"""
    last_time = open(saved_time_file, 'r').read()
    request.add_header("If-Modified-Since", last_time)

try:
    response = urllib2.urlopen(request) # Make the request
except urllib2.HTTPError, err:
    if err.code == 304:
        print "Nothing new."
        sys.exit(0)
    raise   # some other http error (like 404 not found etc); re-raise it.

last_modified = response.info().get('Last-Modified', False)
if last_modified:
    open(saved_time_file, 'w').write(last_modified)
else:
    print("Server did not provide a last-modified property. Continuing...")
    """
    Alternately, you could save the current time in HTTP-date format here:
    http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.3
    This might work for some servers that don't provide Last-Modified, but do
    respect If-Modified-Since.
    """

"""
You should get here if the server won't confirm the content is old.
Hopefully, that means it's new.
HTML should be in response.read().
""" 
```

另[请查看](http://stii.co.za/python/http-conditional-get-with-python-urllib2/)Stii 的这篇博文，它可能会提供一些灵感。我不太了解`ETags`将它们放在我的示例中，但他的代码也会检查它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T20:59:16.637

执行 HEAD 请求并检查文档的 Content-Length 会更有效。

```
import urllib2
"""
read old length from file into variable
"""
request = urllib2.Request('http://www.yahoo.com')
request.get_method = lambda : 'HEAD'

response = urllib2.urlopen(request)
new_length = response.info()["Content-Length"]
if old_length != new_length:
    print "something has changed" 
```

请注意，虽然内容长度不太可能完全相同，但同时是最有效的方式。根据您期望的更改类型，此方法可能合适或不合适。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-28T21:01:44.887

您始终可以通过散列两者的内容来判断本地存储文件和远程文件之间数据中的任何更改。这通常用于验证下载数据的真实性。要进行连续检查，您将需要一个 while 循环。

```
import hashlib
import urllib

num_checks = 20
last_check = 1
while last_check != num_checks:
    remote_data = urllib.urlopen('http://remoteurl').read()
    remote_hash = hashlib.md5(remote_data).hexdigest()

    local_data = open('localfilepath').read()
    local_hash = hashlib.md5(local_data).hexdigest()
    if remote_hash == local_hash:
        print('right now, we match!')
    else:
        print('right now, we are different') 
```

如果实际数据永远不需要保存在本地，我只会存储 md5 哈希并在检查时动态计算它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-24T03:47:08.310

这个答案是@DeaconDesperado 的答案的延伸

为了简单和更快的代码执行，可以首先创建一个本地哈希（而不是存储页面的副本）并将其与新获得的哈希进行比较

要创建本地存储的哈希，**最初**可以使用此代码

```
import hashlib
import urllib

    remote_data = urllib.urlopen('http://remoteurl').read()
    remote_hash = hashlib.md5(remote_data).hexdigest()

    # Open a file with access mode 'a'
    file_object = open('localhash.txt', 'a')
    # Append  at the end of file
    file_object.write(remote_hash)
    # Close the file
    file_object.close() 
```

并替换`local_data = open('localfilepath').read()`为`local_data = open('local\file\path\localhash.txt').read()`

那是

```
 import hashlib
    import urllib

    num_checks = 20
    last_check = 1
    while last_check != num_checks:

    remote_data = urllib.urlopen('http://remoteurl').read()
    remote_hash = hashlib.md5(remote_data).hexdigest()

    local_hash = open('local\file\path\localhash.txt').read()`

    if remote_hash == local_hash:

    print( 'right now, we match!' )

    else:

    print('right now, we are different' ) 
```

来源：-https://thispointer.com/how-to-append-text-or-lines-to-a-file-in-python/

执事亡命之徒的回答

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T22:03:28.027

我不完全清楚您是否只想看看网站是否发生了变化，或者您是否打算对网站的数据做更多的事情。如果是前者，肯定是哈希，如前所述。这是一个工作（mac 上的python 2.6.1）示例，它将完整的旧 html 与新 html 进行比较；它应该很容易修改，因此它可以根据需要使用散列或仅使用网站的特定部分。希望评论和文档字符串能让一切变得清晰。

```
import urllib2

def getFilename(url):
    '''
    Input: url
    Return: a (string) filename to be used later for storing the urls contents
    '''
    return str(url).lstrip('http://').replace("/",":")+'.OLD'

def getOld(url):
    '''
    Input: url- a string containing a url
    Return: a string containing the old html, or None if there is no old file
    (checks if there already is a url.OLD file, and make an empty one if there isn't to handle the case that this is the first run)
    Note: the file created with the old html is the format url(with : for /).OLD
    '''
    oldFilename = getFilename(url)
    oldHTML = ""
    try:
        oldHTMLfile = open(oldFilename,'r')
    except:
        # file doesn't exit! so make it
        with open(oldFilename,'w') as oldHTMLfile:
            oldHTMLfile.write("")
        return None
    else:
        oldHTML = oldHTMLfile.read()
        oldHTMLfile.close()

    return oldHTML

class ConnectionError(Exception):
    def __init__(self, value):
        if type(value) != type(''):
            self.value = str(value)
        else:
            self.value = value
    def __str__(self):
        return 'ConnectionError: ' + self.value       

def htmlHasChanged(url):
    '''
    Input: url- a string containing a url
    Return: a boolean stating whether the website at url has changed
    '''

    try:
        fileRecvd = urllib2.urlopen(url).read()
    except:
        print 'Could not connect to %s, sorry!' % url
        #handle bad connection error...
        raise ConnectionError("urlopen() failed to open " + str(url))
    else:
        oldHTML = getOld(url)
        if oldHTML == fileRecvd:
            hasChanged = False
        else:
            hasChanged = True

        # rewrite file
        with open(getFilename(url),'w') as f:
            f.write(fileRecvd)

        return hasChanged

if __name__ == '__main__':
    # test it out with whatismyip.com
    try:
        print htmlHasChanged("http://automation.whatismyip.com/n09230945.asp")
    except ConnectionError,e:
        print e 
```

# php - MySQL 选择名字和名字像 x 和 x 的用户

> ID：11252577
> 
> 赞同：1
> 
> 时间：2012-06-28T20:42:29.620
> 
> 标签：php, mysql

我想不出一个办法来表达标题，很抱歉，基本上我的网站上有一个搜索功能，它应该从数据库中选择用户，其中输入的查询就像他们的第一个，第二个，第一个和第二个，或者是他们的名字和第二个、名字或第二个名字。（这让我很困惑打字）

编码：

```
 $query = mysql_real_escape_string(htmlentities(strip_tags(stripslashes(@$_GET['q']))));
    $searchArray = explode(" ", $query);
    $query = trim($query);

if($query == "" || $searchArray == "") {
                    echo("<div id='result'><p>Please enter a search term</p></div>");
                }
                if (!isset($query) || !isset($searchArray)){
                    echo("<div id='result'><p>Please enter a search term</p></div>");
                }
                if (count($searchArray) > 1) {
                    $sq = mysql_query("
                    SELECT * FROM users WHERE fname LIKE '%{$searchArray[0]}%' 
                    OR fname LIKE '%{$searchArray[1]}%' 
                    OR sname LIKE '%{$searchArray[0]}%' 
                    OR sname LIKE '%{$searchArray[1]}%' 
                    OR fname LIKE '%{$searchArray[0]}%' AND sname LIKE '%{$searchArray[1]}%' 
                    OR fname LIKE '%{$searchArray[1]}%' AND sname LIKE '%{$searchArray[0]}%'
                    OR fname = '%{$searchArray[0]}%' AND sname = '%{$searchArray[1]}%' 
                    OR fname = '%{$searchArray[1]}%' AND sname = '%{$searchArray[0]}%' 
                    ");
                } 

                else{
                    $sql = "SELECT * FROM users WHERE fname AND sname LIKE '%$query%' OR email LIKE '%$query%'";
                } 
```

在我的数据库中，我有以下用户： Declan Smith Joseph Brailsford 测试用户 测试用户 2

如果我搜索电子邮件，我会得到正确的结果。如果我搜索 Dec、Declan 或 Smith，我会得到正确的结果。如果我搜索测试、测试用户或用户，我没有得到任何结果。如果我搜索 Joseph、Brailsford 或 Joseph Brailsford，我没有得到任何结果。如果我搜索 Declan Smith，我会得到 Joseph Brailsford 作为结果。

显然，这根本不对，所以有人可以告诉我我做错了什么吗？：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:53:19.167

```
$sql = "SELECT * FROM users WHERE fname AND sname LIKE '%$query%' OR email LIKE '%$query%'"; 
```

应该

```
$sql = "SELECT * FROM users
        WHERE 
             fname LIKE '%$query%' OR
             sname LIKE '%$query%' OR 
             email LIKE '%$query%'"; 
```

或者

```
$sql = "SELECT * FROM users WHERE CONCAT(fname, ', ', sname, ', ', email) LIKE '%$query%'"; 
```

这样您就不必编写那些 OR 条件...

您的第一个查询也应该是

```
SELECT * FROM users
WHERE concat(fname, ', ', sname) LIKE '%{$searchArray[0]}%' 
OR concat(fname, ', ', sname) LIKE '%{$searchArray[1]}%' 
```

另请阅读***[这两个查询之间有区别吗？](https://stackoverflow.com/a/10815979/1066828)***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:52:59.423

我不确定你写的逻辑，但我认为只有这些是必要的：

```
SELECT * FROM users
  WHERE fname LIKE '%{$searchArray[0]}%' 
     OR fname LIKE '%{$searchArray[1]}%' 
     OR sname LIKE '%{$searchArray[0]}%' 
     OR sname LIKE '%{$searchArray[1]}%' 
```

WHERE 子句的所有其他部分似乎都是多余的。但是，如果您确实需要它们，我认为您需要括号。否则，“AND”会破坏它工作的任何希望：

```
SELECT * FROM users 
  WHERE fname LIKE '%{$searchArray[0]}%' 
     OR fname LIKE '%{$searchArray[1]}%' 
     OR sname LIKE '%{$searchArray[0]}%' 
     OR sname LIKE '%{$searchArray[1]}%' 
     OR (fname LIKE '%{$searchArray[0]}%' AND sname LIKE '%{$searchArray[1]}%')
     OR (fname LIKE '%{$searchArray[1]}%' AND sname LIKE '%{$searchArray[0]}%')
     OR (fname = '%{$searchArray[0]}%' AND sname = '%{$searchArray[1]}%')
     OR (fname = '%{$searchArray[1]}%' AND sname = '%{$searchArray[0]}%') 
```

最后两行...为什么要使用等于测试的 % ？当然你不需要那些。

# jquery - 如何复制 Pinterest 网站的模态效果？

> ID：11252579
> 
> 赞同：32
> 
> 时间：2012-06-28T20:42:41.340
> 
> 标签：jquery, modal-dialog, pinterest

当您单击图像时，我想创建与[**Pinterest上相同的效果：打开一个模式窗口，但页面的 URL 也会更改。**](http://pinterest.com/)最后一部分至关重要：浏览器地址栏中的 URL 已更改，但我们仍然在后台看到原始页面内容（这就是为什么我称它为模态，尽管它可能比这要复杂得多）。理想情况下，我正在寻找一个 jQuery 解决方案。

[编辑] 我应该补充一点，Pinterest 行为当然不会破坏返回按钮，这也是至关重要的。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-06-28T22:41:15.563

这是我对**Pinterest**如何实现其独特的模态外观以及如何复制它的评估。

首先，对 URL 链接处理进行**服务器端分析**，以查看链接是否来自 Pinterest 网站本身。也就是说，**浏览器 URL 地址栏**和**历史记录**是动态创建的，而**不是**由访问者实际执行的。

**澄清一下：**地址栏不是您进行模型体验时的实际位置！为了证明这一点，单击**Pinterest 对象**，在*模式视图*中转到**地址栏**，在该 URL 位置的末尾将**鼠标光标**放在那里，然后**单击 enter**。然后，您会将自己**重定向到****该位置**！要进一步验证您从未离开过主页，请查看Firebug/Firefox中的**“网络”选项卡****或**Chrome 中的“网络”选项卡。

 **以下方法是**Pinterest**在访问主页时所做的。请谨慎查看：

1.  显示主页。

2.  等待访问者点击 Pinterest 对象。

3.  被点击的对象有一个独特的网页可以直接访问。

4.  不跟随点击的对象。

5.  浏览器栏将使用此单击的对象位置填充自身，但您实际上并不存在。

6.  浏览器历史将通过 JavaScrict 或服务器端处理接收点击位置。

7.  AJAX 将从对象的页面加载一段数据（通过 ID 模态的肉）。可通过 HTTPRequest 验证。

8.  主页上被点击的对象已经消失（这可以通过 Inspect Element 进行验证）。

9.  AJAX 进程会将那条数据放在屏幕中央，并带有白色覆盖层。

10.  滚动主页被禁用，而 AJAX“模态”数据通过`#zoomScroll`.

11.  单击模态背景将对象返回到网页，并且 URL 地址栏被“视觉”还原。

**为了重新创建Pinterest**使用的模型效果，我将研究支持**HTML/iframed**内容**的不同灯箱。**查看上述过程中的编号步骤将展示如何为您的网站实现所需的外观。

 **一个关键步骤是将灯箱设置为使用**所有视口**，如果需要，修改灯箱 CSS 规则以避免任何关闭按钮皮肤图形和边框。

然后，灯箱可以使用由 AJAX 填充的**单个模板文件。**`div`Said`div`在半透明背景上的视口中水平居中。iframe 本身是透明的，这将允许底层主页显示出来。

加入一些类似于**Pinterest的****滚动规则**，你就有了一个**不错的克隆方法**可以使用。

 ****至于复制**Pinterest 网页布局**，请参阅此[**SO 答案**](https://stackoverflow.com/a/8000254/1195891)。

要使用***text-link***、***thumbnail***或***两者组合的*****自定义Pinterest 按钮**，请参阅此[**SO Answer**](https://stackoverflow.com/a/11488760/1195891)。***[](https://stackoverflow.com/a/11488760/1195891)***

 *****对于使用 jsFiddle 教程的**Data Scrape Pinterest流程，请参阅此**[**SO Answer**](https://stackoverflow.com/a/13814799/1195891)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-17T22:27:27.867

我没有足够的代表来评论 arttronics 的答案，但我想补充一下：

浏览器栏是通过较新的 HTML 5 历史来操作的。这种特殊情况可以通过以下方式完成：

```
window.history.pushState({}, "Some Title", "the url") 
```

[https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history/#The_pushState().C2.A0method](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history/#The_pushState%28%29.C2.A0method)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T23:11:40.877

这是一个带有 JQuery 模式对话框的代码的示例。

[http://jsfiddle.net/aDCQL/2/](http://jsfiddle.net/aDCQL/2/)

这实际上只是一个概念证明，可能会扩展......

利用散列库，您可以基于 URL 执行某些功能并提供指向这些相同功能的直接链接。这个库支持我们关心的所有浏览器。

实际路径路由库也存在，它们也简化了其中一些路径定义。

[https://github.com/cowboy/jquery-hashchange](https://github.com/cowboy/jquery-hashchange)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T21:11:14.147

这家伙称之为 pinterest 风格

但模态窗口打开看起来不同

[http://codecanyon.net/item/jquery-pinterest-style-gallery-plugin/2463876](http://codecanyon.net/item/jquery-pinterest-style-gallery-plugin/2463876)

如果你可以添加白色覆盖它看起来。

也看这个

[http://hasin.me/2012/03/10/building-a-nice-image-gallery-like-pinterestfriendsheet-using-facebook-graph-api-and-lightbulb/](http://hasin.me/2012/03/10/building-a-nice-image-gallery-like-pinterestfriendsheet-using-facebook-graph-api-and-lightbulb/)

这个也是

[http://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T21:37:11.493

漂亮照片怎么[样](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/#prettyPhoto)？它将#prettyPhoto[gallery]/x/ 添加到URL。*************

# c# - 循环遍历 C# 中的类并更改每个对象的属性值

> ID：11252581
> 
> 赞同：1
> 
> 时间：2012-06-28T20:42:59.723
> 
> 标签：c#, asp.net, webforms

我正在用 Asp.net 编写仪表板应用程序。当我加载主页时，我会捕获控制设置并动态创建仪表、图表、图像等，并将它们加载到 HTML 表格中的单元格中。将提供给每个控件的数据将每 3 秒更新一次。我目前将仪表存储在一个名为 BoldGauge 的类中。在该类内部有一个 GaugeValue 属性，需要每 3 秒更新一次。如何循环遍历类并在运行时更改创建的每个仪表的值？我的课看起来像这样：

```
public class BoldGauge
{
    private ASPxGaugeControl m_Gauge;
    private int m_GaugeTimer;
    private string m_GaugeValue;
    private string m_GaugeDataType;
    private float m_GaugeMinValue;
    private float m_GaugeMaxValue;

    public BoldGauge(ASPxGaugeControl Gauge, string GaugeValue, string GaugeDataType, float GaugeMinValue, float GaugeMaxValue)
    {
        m_Gauge = Gauge;
        m_GaugeValue = GaugeValue;
        m_GaugeDataType = GaugeDataType;
        m_GaugeMinValue = GaugeMinValue;
        m_GaugeMaxValue = GaugeMaxValue;

    }

    public string GaugeValue
    {
        get
        {
            return m_GaugeValue;
        }
        set
        {
            m_GaugeValue = value;
        }
    }

    public int GaugeTimer
    {
        get
        {
            return m_GaugeTimer;
        }
        set
        {
            m_GaugeTimer = value;
        }
    }

    public string GaugeDataType
    {
        get
        {
            return m_GaugeDataType;
        }
        set
        {
            m_GaugeDataType = value;
        }
    }

    public ASPxGaugeControl Gauge
    {
        get
        {
            return m_Gauge;
        }
        set
        {
            m_Gauge = value;
        }
    }

    public float GaugeMinValue
    {
        get
        {
            return m_GaugeMinValue;
        }
        set
        {
            m_GaugeMinValue = value;
        }
    }

    public float GaugeMaxValue
    {
        get
        {
            return m_GaugeMaxValue;
        }
        set
        {
            m_GaugeMaxValue = value;
        }
    }
} 
```

在主页上，我生成新对象，如下所示：

```
newBoldGauge = new BoldGauge(boldGaugeControl, gaugeValue, controlData, minimumGaugeValue, MaximumGaugeValue); 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:48:01.197

您需要一个集合来存储所有仪表。当您拥有它时，您可以简单地遍历集合并依次更新每个仪表。

```
var gauges = new List<BoldGague>()

gauges.Add(new BoldGauge(boldGaugeControl, gaugeValue, controlData, 
    minimumGaugeValue, MaximumGaugeValue));
...

foreach(var gauge in gauges)
{
    // update the value
} 
```

或者，您可以将它们放入字典中，然后按名称更新它们：

```
var gauges = new Dictionary<string, BoldGauge>();

gauges.add("name of gauge", new BoldGauge(boldGaugeControl, gaugeValue, 
    controlData, minimumGaugeValue, MaximumGaugeValue));

...

//  Update the value of a named gauge
gauges["name of gauge"].GaugeValue = newValue; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:49:00.613

```
IEnumerable<Control> EnumerateControlsRecursive(Control parent)
{
    foreach (Control child in parent.Controls)
    {
        yield return child;
        foreach (Control descendant in EnumerateControlsRecursive(child))
            yield return descendant;
    }
} 
```

并像这样使用它：

```
 foreach (Control c in EnumerateControlsRecursive(Page))
    {
        if(c is BoldGauge)
        {
            BoldGauge.GaugeValue = "some value"
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:49:44.570

创建一个`BoldGague`对象集合，然后遍历该集合并进行必要的更改。

```
List<BoldGague> gagues = new List<BoldGague>();

foreach(BoldGague gague in gagues)
{
    // change values here.
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T21:00:03.130

仅供参考，使用较新的自动获取器/设置器，您可以像这样重写您的确切类：

```
public class BoldGauge
{
    public BoldGauge(ASPxGaugeControl gauge, string gaugeValue, string gaugeDataType, float gaugeMinValue, float gaugeMaxValue)
    {
        Gauge = gauge;
        GaugeValue = gaugeValue;
        GaugeDataType = gaugeDataType;
        GaugeMinValue = gaugeMinValue;
        GaugeMaxValue = gaugeMaxValue;    
    }

    public string GaugeValue { get; set; }
    public int GaugeTimer { get; set; }
    public string GaugeDataType { get; set; }
    public ASPxGaugeControl Gauge { get; set; }
    public float GaugeMinValue { get; set; }
    public float GaugeMaxValue { get; set; }
} 
```

# debugging - EBP 寄存器（基帧指针）是否仅用于 x86 中的调试？

> ID：11252587
> 
> 赞同：15
> 
> 时间：2012-06-28T20:43:35.040
> 
> 标签：debugging, memory-management, assembly, x86

学习 x86 汇编和帧指针让我有点吃惊。我从这个[SO question](https://stackoverflow.com/questions/579262/what-is-the-purpose-of-the-frame-pointer)中了解到，EBP 让调试变得很棒。这很好，但我很好奇，“EBP 还有什么用途？” 查看[调用堆栈](http://en.wikipedia.org/wiki/Call_stack#The_stack_and_frame_pointers)Wikipedia 文章，EBP 是动态堆栈分配所必需的。

正如我一直假设动态分配在堆上进行的那样。那么，我为什么要使用动态堆栈分配——为什么堆还不够好？而且，EBP 对此有何用处？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-29T09:36:04.407

您错误地假设`ebp`堆栈帧分配是必需的。这不是真的，`esp`可以直接使用。现在完全没有必要将其`ebp`用作堆栈帧指针。有几点是有用的：

*   在 16 位代码中，`sp`（堆栈指针）在寻址中的使用受到严重限制，在 x86 中根本不可能直接使用相对寻址，可以在所有`bp`可用的寻址模式中使用。

*   这种有限支持的原因可能是当时可用的编译器，使用帧指针生成代码然后跟踪不断变化的`sp`. 还有更多的处理器对堆栈帧指令有特殊的支持，比如`leave`or `enter`，但是 AFAIK 除了英特尔之外没有其他人已经`sp`在这个过程中削弱了现实:-)

*   调试。当帧指针可用时，展开堆栈要容易得多，但现代调试器甚至可以做到。

如果要在堆栈上分配 100 字节空间，只需执行`sub esp, #100`，访问`move [esp + x]`where`x`介于 0 和 99 之间的空间并清理，`add esp, #100`就完成了。我什至会争辩说，在手写汇编中使用堆栈帧指针就像复制一个有 30 年历史的编译器的行为，当时编译器真的很愚蠢，不能没有。如果您正在编写汇编，那么它既*没有*必要也没有用。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-28T21:37:23.680

与堆分配相比，从堆栈分配少量内存非常快。当我们从堆中分配内存时，我们必须调用 API 或内存管理器。

**是**的，您也可以将 EBP 寄存器用于任何其他目的，例如其他 32 位寄存器，但您必须首先存储其内容，然后在退出程序之前恢复。

您可以`PUSH EBP`用于将 EBP 内容存储到堆栈和`POP EBP`用于恢复。

# jetty - SSOJAASUserRealm 示例

> ID：11252589
> 
> 赞同：0
> 
> 时间：2012-06-28T20:43:38.933
> 
> 标签：jetty

我对 Jetty 完全陌生，所以我提前为我的 n00bess 道歉。我有使用 JAASRealm 进行身份验证的 Jetty，我想实现 SSO，所以我正在查看[SSOJAASUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/SSOJAASUserRealm.html)但没有好的文档可以帮助我了解如何使用它。Jetty 站点有[HashSSORealm](http://docs.codehaus.org/display/JETTY/Single+Sign+On+-+Jetty+HashSSORealm)的文档，但没有 SSOJAASUserRealm 的文档。

在我看来，查看[JAASUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/JAASUserRealm.html)和[HashUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/security/HashUserRealm.html)的 Java 文档， JAASUserRealm 没有实现 SSORealm 接口，所以即使我使用[SSOJAASUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/SSOJAASUserRealm.html)我也必须坚持使用[HashUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/security/HashUserRealm.html)。

有没有关于如何将[SSOJAASUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/SSOJAASUserRealm.html)与 [JAASUserRealm](http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/JAASUserRealm.html)一起使用的示例？

我正在使用码头 6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T19:33:21.753

看来 SSOJAASUserRealm 实现并不完整。我从也实现了 SSORealm 的 HashSSORealm 中得到了一个线索。您可以查看 HashSSORealm.java 类并针对您的用例对其进行修改。您需要做的就是实现 setSingleSignOn() 和 getSingleSignOn() 方法。我没有使用 cookie（如在 HashSSORealm 类中），而是使用了我的会话 ID。

# css - css 标准标签边距取决于前/后元素

> ID：11252590
> 
> 赞同：1
> 
> 时间：2012-06-28T20:43:44.290
> 
> 标签：css

我想将标准标签 (p h1...h6 ul li) 的 css 边距属性设置为依赖于紧接在标签之前或之后的元素。例如，如果 DOM 中它之前的元素是 p，我想将 h1 的 margin-top 设置为 10px，但如果它之前的元素是 /ul，则设置为 20px。我需要仅使用 css 来完成此操作，而不使用分隔符或 div ——因为内容是由 CMS 用户插入的，除了将普通的 p h1...h6 ul li 应用于他们的文本之外，他们无法做任何事情。

这可以用css吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:47:57.787

您可以使用相邻的兄弟 CSS 选择器：

```
p + h1 {
   margin-top: 10px;
} 
```

将 10px 的 margin-top 应用于`h1`紧跟在元素之后的`p`元素。

**[这是一篇关于这个主题的好文章。](http://css-tricks.com/child-and-sibling-selectors/ "CSS-Tricks - 子和兄弟选择器")**

# javascript - 如何在 Three.js 中更改面部颜色

> ID：11252592
> 
> 赞同：21
> 
> 时间：2012-06-28T20:43:53.690
> 
> 标签：javascript, three.js

我正在尝试更改网格单个面上的颜色。这是在 WebGL 上下文中。我可以更改整个网格颜色，但不能更改单个面。相关代码如下：

```
// Updated Per Lee!

var camera = _this.camera;      
var projector = new THREE.Projector();
var vector = new THREE.Vector3( ( event.clientX / window.innerWidth ) * 2 - 1,                                  - ( event.clientY / window.innerHeight ) * 2 + 1, 0.5 );
projector.unprojectVector( vector, camera );

var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
var intersects = ray.intersectObjects( kage.scene.children );

if ( intersects.length > 0 ) {
    face = intersects[0].face;
    var faceIndices = ['a', 'b', 'c', 'd'];         
    var numberOfSides = ( face instanceof THREE.Face3 ) ? 3 : 4;
    // assign color to each vertex of current face
    for( var j = 0; j < numberOfSides; j++ )  {
        var vertexIndex = face[ faceIndices[ j ] ];
    // initialize color variable
    var color = new THREE.Color( 0xffffff );
    color.setRGB( Math.random(), 0, 0 );
    face.vertexColors[ j ] = color;
    }
} 
```

我还初始化了对象，在本例中为 Cube，如下所示：

```
// this material causes a mesh to use colors assigned to vertices
var material = new THREE.MeshBasicMaterial( { 
    color: 0xf0f0f0, 
    shading: THREE.FlatShading,
    vertexColors: THREE.VertexColors 
});

var directionalLight = new THREE.DirectionalLight(0xEEEEEE);
directionalLight.position.set(10, 1, 1).normalize();
kage.scene.add(directionalLight);

var cube = new THREE.Mesh(new THREE.CubeGeometry(300, 300, 300,1,1,1), material);
cube.dynamic = true;
kage.scene.add(cube); 
```

更改材质会使立方体变为白色，而不管光的颜色如何。相交逻辑仍然有效，这意味着我选择了正确的面，但可惜颜色没有改变。

我是 Stackoverflow 的新手 [很好地提出一个问题，所以希望我的编辑不会令人困惑]

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-24T08:08:22.633

*   将库更新到 r53。
*   加入`vertexColors: THREE.FaceColors`材料。
*   最后使用`face.color.setRGB( Math.random(), Math.random(), Math.random())`.

    现在无需为 4 面 (a,b,c,d)`THREE.Face4`或 3 面 (a,b,c) 遍历循环`THREE.Face3`。

    这适用于 WebGL 和 Canvas 渲染。

[例子](http://jsfiddle.net/RnFqz/22/)

[三.js r53](https://raw.github.com/mrdoob/three.js/master/build/three.min.js)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-29T15:16:07.570

假设“myGeometry”是包含要更改颜色的面的几何图形，而“faceIndex”是要更改颜色的特定面的索引。

```
// the face's indices are labeled with these characters 
var faceIndices = ['a', 'b', 'c', 'd'];  

var face = myGeometry.faces[ faceIndex ];   

// determine if face is a tri or a quad
var numberOfSides = ( face instanceof THREE.Face3 ) ? 3 : 4;

// assign color to each vertex of current face
for( var j = 0; j < numberOfSides; j++ )  
{
    var vertexIndex = face[ faceIndices[ j ] ];
    // initialize color variable
    var color = new THREE.Color( 0xffffff );
    color.setRGB( Math.random(), 0, 0 );
    face.vertexColors[ j ] = color;
} 
```

然后，网格需要使用以下材质，以便从顶点派生面颜色：

```
// this material causes a mesh to use colors assigned to vertices
var cubeMaterial = new THREE.MeshBasicMaterial( 
    { color: 0xffffff, shading: THREE.FlatShading, 
    vertexColors: THREE.VertexColors } ); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-02-27T17:06:03.983

我对three.js 比较陌生，但是这些示例中的大多数似乎都过于冗长和复杂。以下代码似乎为立方体的所有 12 个三角形面着色......（WebGLRenderer r73）。

这样做时我注意到的一件事是面孔的顺序有点奇怪（至少对我来说是新手）。

```
var geometry = new THREE.BoxGeometry( 1, 1, 1 );
console.log(geometry.faces.length); // 12 triangles
geometry.faces[0].color = new THREE.Color(0x000000); //Right 1
geometry.faces[1].color = new THREE.Color(0xFF0000); //Right 2
geometry.faces[2].color = new THREE.Color(0xFF8C08); //Left 1
geometry.faces[3].color = new THREE.Color(0xFFF702); //Left 2
geometry.faces[4].color = new THREE.Color(0x00FF00); //Top 1
geometry.faces[5].color = new THREE.Color(0x0000FF); //Top 2
geometry.faces[6].color = new THREE.Color(0x6F00FF); //Bottom 1
geometry.faces[7].color = new THREE.Color(0x530070); //Bottom 2
geometry.faces[8].color = new THREE.Color(0x3F3F3F); //Front 1
geometry.faces[9].color = new THREE.Color(0x6C6C6C); //Front 2
geometry.faces[10].color = new THREE.Color(0xA7A7A7);//Rear 1
geometry.faces[11].color = new THREE.Color(0xFFFFFF);//Rear 2 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-26T19:13:45.393

根据[三个 JS 几何](https://threejs.org/docs/index.html#api/core/Geometry)文档，要在此面中发出更新信号，***`Geometry.elementsNeedUpdate`***需要设置为 true。

下面的代码片段改变了所有面孔的颜色。

*`mesh.material.vertexColors = THREE.FaceColors`*

```
var faces = mesh.geometry.faces;

for(var i = 0 ; i < faces.length; i++){
  var face = faces[i];
  var color = new THREE.Color("rgb(255, 0, 0)");
  face.color = color;
}

mesh.geometry.elementsNeedUpdate = true;

render(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-23T01:27:34.583

我认为上面列出的方法只适用于`WebGLRenderer`. 如果您想要在两者中都有效的东西，`CanvasRenderer`并且`WebGLRenderer`它有点复杂，但我怀疑最终结果在内存使用和性能方面都更有效。

在浏览了 THREE.jS Projector.js 源代码后，我是这样做的：

```
// create the face materials
var material_1 = new THREE.MeshLambertMaterial(
    {color : 0xff0000, shading: THREE.FlatShading, overdraw : true}
);
var material_2 = new THREE.MeshLambertMaterial(
    {color : 0x00ff00, shading: THREE.FlatShading, overdraw : true}
);

// create a geometry (any should do)
var geom = new THREE.CubeGeometry(1,1,1);

// add the materials directly to the geometry
geom.materials.push(material_1);
geom.materials.push(material_2);

// assign the material to individual faces (note you assign the index in 
// the geometry, not the material)
for( var i in geom.faces ) {
    var face = geom.faces[i];
    face.materialIndex = i%geom.materials.length;
}

// create a special material for your mesh that tells the renderer to use the 
// face materials
var material = new THREE.MeshFaceMaterial();
var mesh = new THREE.Mesh(geom, material); 
```

这个例子改编自我拥有的工作代码，但我不得不承认我实际上并没有运行这个确切的代码块，而且我没有很好的记录，先把一切都做好，但希望它能帮助任何人谁在挣扎

# php - 如何跟踪运行给定进程的 PHP 脚本？

> ID：11252595
> 
> 赞同：7
> 
> 时间：2012-06-28T20:44:08.787
> 
> 标签：php, process, strace, pid

我有一个在 VPS 托管服务上运行的自定义脚本的网站。所有脚本都通过 index.php 使用 mod_rewrite 和 .htaccess 来获取友好的 URL

我的脚本中的某些内容正在产生高 CPU 使用率，如下所示： ![CPU使用率](../Images/b2682019b5d076d7be2153ec5cccc6c9.png)

当我去`strace`一个给定的过程时，我得到了我不明白的：

```
 setitimer(ITIMER_PROF, {it_interval={0, 0}, it_value={90, 0}}, NULL) = 0
    rt_sigaction(SIGPROF, {0x7a6b8f, [PROF], SA_RESTORER|SA_RESTART, 0x2af8ae8742f0}, {0x7a6b8f, [PROF],    SA_RESTORER|SA_RESTART, 0x2af8ae8742f0}, 8) = 0
    rt_sigprocmask(SIG_UNBLOCK, [PROF], NULL, 8) = 0 
```

这在无限循环中不断重复。

我需要知道的是如何追踪导致此问题的确切 PHP 脚本。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:51:57.423

如果您可以[将 PECL proctitle 包](http://pecl.php.net/package/proctitle)安装到您的 PHP 安装中，您可以使用它来`index.php`将其进程标题设置为它传递给的脚本的名称。（更改后的流程标题可能会或可能不会出现在特定的流程表可视化工具中；`ps`如果所有其他方法都失败，请使用。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:47:45.287

在脚本中使用 getmypid() 函数。只需将其输出到日志文件或其他内容即可查看哪个脚本是哪个。

编辑：使用 auto_prepend_file 配置设置自动将此片段包含在所有文件中：

```
php_value auto_prepend_file append.php 
```

# python - 在python中进行移位排列

> ID：11252597
> 
> 赞同：2
> 
> 时间：2012-06-28T20:44:20.687
> 
> 标签：python, permutation

我需要做一个排列，看起来像一个 1-N 的序列，其中一个 0 填充到位#k。

这种方法有效，但是使用内置函数有什么更简单的吗？

```
def permshift(n,k):
   return [0 if x == k else x+(x<k) for x in range(n)]

>>> permshift(7,0)
[0, 1, 2, 3, 4, 5, 6]
>>> permshift(7,1)
[1, 0, 2, 3, 4, 5, 6]
>>> permshift(7,2)
[1, 2, 0, 3, 4, 5, 6]
>>> permshift(7,3)
[1, 2, 3, 0, 4, 5, 6]
>>> permshift(7,4)
[1, 2, 3, 4, 0, 5, 6]
>>> permshift(7,5)
[1, 2, 3, 4, 5, 0, 6]
>>> permshift(7,6)
[1, 2, 3, 4, 5, 6, 0] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T20:50:29.463

只需创建一个新列表，然后将其插入`0`您需要的任何位置。

```
def permshift(n, k):
    lst = range(1, n)
    lst.insert(k, 0)
    return lst 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:50:54.293

更多行，但我认为它更简单：

```
def permshift(n, k):
   x = range(1, n)
   x.insert(k, 0)
   return x 
```

这是一个比最流行的重复答案更短的有趣答案：

```
def permshift(n, k):
   x = range(1, n)
   return x[:k] + [0] + x[k:] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T20:52:07.643

呵呵 - 当这么多人想出相同的解决方案时，这很有趣

```
def permshift(n,k):
     r = range(1,n)
     r.insert(k,0)
     return r 
```

为了完整起见，如果您真的关心效率，这里有一个生成器表达式

```
def permshift(n,k):
    for i in xrange(1,n):
        yield i
        if i == k:
            yield 0

print list(permshift(7,2)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T20:58:38.060

已经有了很好的答案，但这里有一个用于踢球和咯咯笑的单行版本：

```
permshift = lambda n,k: range(1, k+1) + [0] + range(k+1, n) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T21:20:53.457

```
from itertools import chain

def permshift(n,k):
    return chain(xrange(1,k+1), [0], xrange(k+1,n)) 
```

# c# - C# 控制台用户输入

> ID：11252612
> 
> 赞同：6
> 
> 时间：2012-06-28T20:45:46.300
> 
> 标签：c#

好的，我想首先说我不是学生，所以这个问题与家庭作业完全无关。我正在尝试学习 C#，因为我想为之工作的公司正在使用它。我听说 C# 与 java 非常相似，所以我正在使用我的 java 书，其中有练习题来练习 c#。这是我的问题，我正在尝试制作一个简单的程序，用户输入 3 个等级并将其存储在一个数组中，然后显示输入的三个等级。问题是它没有存储成绩。但是它确实会显示一些随机数，例如如果我输入 34、44 和 54，它会返回 51。这是我的代码，谢谢大家：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Practice1
{
    class Program
    {
        static void Main(string[] args)
        {
            int[] test = new int[4];

            int i = 1;

            for (i = 1; i <= 3; i++)
            {
                Console.WriteLine("Please enter test " + i);
                test[i] = Console.Read();
                Console.ReadLine();

            }
            for (i = 1; i <=3; i++)
            {
                Console.WriteLine(test[i]);
                Console.ReadLine();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T20:48:52.587

你的问题在这里：

```
test[i] = Console.Read(); 
```

这是将一个字符（它是一个整数字符代码）放入您的测试数组中。

而是做

```
test[i] = int.Parse(Console.ReadLine()); 
```

**编辑：**如果您不确定用户会输入一个可解析的整数，也许他们会输入“六”，例如您可以考虑使用 try/catch（如果您想知道它为什么不解析） ，或 int.TryParse，它返回 true 以指示成功并将解析的整数分配给变量、字段或数组索引：

```
if(int.TryParse(Console.ReadLine(), out test[1])
   Console.WriteLine("Successfully parsed integer");
else
   Console.WriteLine("Please enter an integer."); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T20:49:50.823

Console.Read() 返回输入键的 ASCII 值。例如，如果您输入“A”，您将得到值 65，它是“A”的 ASCII 码。

您需要将字符串解析为整数：

```
for (i = 0; i < 4; i++)
{
    Console.WriteLine("Please enter test " + i);
    string input = Console.ReadLine();
    int value;
    bool success = int.TryParse(input, out value);
    if (success)
    {
        test[i] = value
    }
    else
    {
        // Show an error message that the user must enter an integer.
    }

    Console.ReadLine();

} 
```

另请注意，数组在 C# 中从 0 开始索引，而不是您的代码假设的 1。

或者，您仍然可以使用[Console.Read](http://msdn.microsoft.com/en-us/library/system.console.read) ()，它返回输入字符的整数表示，确认该字符实际上是一个数字，并将 ASCII 代码转换为适当的数字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T20:50:03.370

来自[文档](http://msdn.microsoft.com/en-us/library/system.console.read.aspx) `Console.Read()`“从标准输入流中读取下一个字符”。

你想要下一个整数，所以像

```
bool cont = false;
int val = 0;
do
{
    cont = int.TryParse(Console.ReadLine(), out val);
    if(!cont){Console.WriteLine( "please enter a real number you fool" );}
} while (!cont); 
```

应该管用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-28T20:50:06.523

```
 int[] test = new int[3];

        for (int i = 0; i < 3; i++)
        {
            Console.WriteLine("Please enter test " + i + 1);
            test[i] = Int.Parse(Console.ReadLine());
        }
        for (int i = 0; i < 3; i++)
        {
            Console.WriteLine(test[i]);
            Console.ReadLine();
        } 
```

可以看到，数组是从索引0开始的，所以不需要定义int[4]（比需要的多一个int），需要从索引0循环到length-1

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-28T20:50:07.267

问题是您正在阅读角色。因此，您看到的“51”是数字 3 的十进制（以 10 为基数）ASCII 值。您需要执行以下操作：

```
string result = Console.ReadLine();
int grade = 0;
int.TryParse(result, out grade)
test[i] = grade; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-28T20:48:49.353

`Console.Read()`返回一个字符。您想`string`从控制台读取 a ，将其转换为 a `int`，然后将该值存储在您的数组中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-01T01:41:13.323

这是代码：

int[] 测试 = 新的 int[3];

```
 for (int e = 0; e < 3; e++)
        {
            Console.WriteLine("Please enter test ");
            test[e] = int.Parse(Console.ReadLine());
        }

        Console.WriteLine("000000000000000000000000000\n");

        for (int e = 0; e < 3; e++)
        {

            Console.WriteLine(test[e]);
            //Console.ReadLine();

        } 
```

# javascript - d3.js - 在堆叠图表上移动 y 轴

> ID：11252614
> 
> 赞同：12
> 
> 时间：2012-06-28T20:45:48.940
> 
> 标签：javascript, d3.js

我还在 Google 组[https://groups.google.com/forum/?fromgroups#!topic/d3-js/DYiVeC544ws](https://groups.google.com/forum/?fromgroups#!topic/d3-js/DYiVeC544ws)上发布了这个问题，但看到它更喜欢在这里提出帮助问题。我只是无法将 y 轴移到图表的左侧，以免妨碍第一列。我在 google group 上提供了一张图片，所以你可以看到我在说什么。

创建轴的代码如下：

```
 var MARGINS = {top: 20, right: 20, bottom: 20, left: 60}; // margins around the graph
var xRange = d3.scale.linear().range([MARGINS.left, width - MARGINS.right]), // x range function
    yRange = d3.scale.linear().range([height - MARGINS.top, MARGINS.bottom]), // y range function

    xAxis = d3.svg.axis().scale(xRange).tickSize(16).tickSubdivide(true), // x axis function
    yAxis = d3.svg.axis().scale(yRange).tickSize(10).orient("right").tickSubdivide(true); // y axis function

// create the visualization chart
var vis = d3.select("#chart")
   .append("svg")
    .attr("width", width)
    .attr("height", height + margin);

    // add in the x axis
  vis.append("svg:g") // container element
    .attr("class", "x axis") // so we can style it with CSS
    .attr("transform", "translate(0," + height + ")") // move into position
   // .call(xAxis); // add to the visualisation

  // add in the y axis
  vis.append("svg:g") // container element
    .attr("class", "y axis") // so we can style it with CSS
    .call(yAxis); // add to the visualisation 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-29T17:46:25.683

使用[transform 属性](http://www.w3.org/TR/SVG/coords.html#TransformAttribute)来移动 y 轴，就像你对 x 轴所做的那样。例如：

```
svg.append("g")
    .attr("class", "y axis")
    .attr("transform", "translate(" + width + ",0)")
    .call(yAxis); 
```

这仅在使用正确方向时才有必要。当轴指向左侧时，默认定位通常很好。

此外，我建议对边距使用以下约定：

*   将 SVG 元素的原点设置为内部图表区域的左上角。
*   定义`width`和`height`作为内部宽度和高度。

例如：

```
var margin = {top: 20, right: 10, bottom: 20, left: 10},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var x = d3.scale.linear()
    .range([0, width]);

var y = d3.scale.linear()
    .range([height, 0]);

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); 
```

如果您愿意，您还可以存储内部和外部尺寸，例如，

```
var outerWidth = 960,
    outerHeight = 500,
    innerWidth = outerWidth - margin.left - margin.right,
    innerHeight = outerHeight - margin.top - margin.bottom; 
```

以下是对约定的直观解释：

*   [http://bl.ocks.org/3019563](http://bl.ocks.org/3019563)

# syncfusion - Syncfusion gridDataControl 分页 - 9.0.1.20 版

> ID：11252618
> 
> 赞同：1
> 
> 时间：2012-06-28T20:46:32.643
> 
> 标签：syncfusion

我使用的是旧版本的 syncfusion，版本 9.0.1.20。我想知道这个版本是否为 gridDataControl 提供分页支持？还是只添加到 10 之后的版本中？另外，我想知道是否有任何解决方法可以使用我正在使用的 syncfusion 版本在 gridDataControl 中实现分页（OnDemandPaging）。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T08:40:02.617

分页支持仅在 9.3.0.61 版本中添加，但是如果您想显示数据而不进行排序和过滤，那么您可以尝试以下解决方法，

“创建GridDataControl，根据页面导航改变GridDataControl的ItemSource。这样你就可以在 OnDemand 中加载 ItemSource”</p>

# mysql - 从两个不同的表中提取并订购

> ID：11252621
> 
> 赞同：0
> 
> 时间：2012-06-28T20:46:53.383
> 
> 标签：mysql

```
TABLE 1
id  time1   info
1   110 info1
2   120 info2

TABLE 2
id  time2   info
1   100 info3
2   130 info4 
```

我怎么能一次从两个表中提取数据并按 time1 和 time2 排序（同样的事情，但字段有不同的名称）

```
Expected result row ids:
1 // table 2
1 // table 1
2 // table 1
2 // table 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:48:33.413

您应该使用`UNION JOIN`查询，将公共排序列（time1 和 time2）命名为具有相同名称并对整个重新组合的结果集进行排序。

```
(SELECT id, time1 AS time, info FROM table1)
    UNION
(SELECT id, time2 AS time, info FROM table2)
    ORDER BY time 
```

不幸的是，这意味着不能为每个表返回不同的表结构。他们必须匹配列数等。

解决方法是这样的：

```
(SELECT id, time1 AS time, info, extra_column FROM table1)
    UNION
(SELECT id, time2 AS time, info, NULL AS extra_column FROM table2)
    ORDER BY time 
```

# objective-c - Objective-C/Giac - 矩阵的正则表达式

> ID：11252631
> 
> 赞同：0
> 
> 时间：2012-06-28T20:47:48.013
> 
> 标签：objective-c, regex, matrix, nsregularexpression

我想找到一个正则表达式来检查给定的字符串是否是一个矩阵。Giac 库中的矩阵定义如下

[[1,2,3],[4,5,6],[7,8,9]]

以“[”开头，以“]”结尾，每一行（向量）用“，”分隔向量以类似的方式定义：[1,2,3] 因此，矩阵就像向量的向量。

我创建了一个正则表达式

```
NSString *pattern = @"\\[(\\[-?([0123456789]+(\\.[0123456789]+)?,)+-?[0123456789]+(\\.[0123456789]+)?])+,\\[-?([0123456789]+(\\.[0123456789]+)?,)+-?[0123456789]+(\\.[0123456789]+)?]]"; 
```

但我找不到如何检查每个向量（行）是否具有相同数量的元素......

例如，像 "[[1,2],[3,4,5],[6,7,8,9,0]]" 这样的字符串与正则表达式匹配，但它不是矩阵......

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T23:57:47.067

正如我的一位教授告诉我的那样，这是无法做到的，因为它不是一种*正则语言*，所以它不能用正则表达式来描述......

# iphone - Core Data 并发与新的 iOS 5 线程选项

> ID：11252632
> 
> 赞同：0
> 
> 时间：2012-06-28T20:47:51.200
> 
> 标签：iphone, ios, cocoa, core-data

我正在使用新的 iOS 5 核心数据并发选项。我有两个线程：

```
mainContext: NSMainQueueConcurrencyType
backgroundContext: NSPrivateQueueConcurrencyType, parent = mainContext 
```

我有一个名为 squareObject 的对象，它当前由主上下文获取并拥有。我修改了这个对象的一个​​属性，比如说

```
squareObject = [getSquareObjectForContext:mainContext];
squareObject.isPendingChange = [NSNumber numberWithBool:YES]; 
```

然后我保存这个上下文。现在，我在 backgroundContext 上执行 fetch：

```
[backgroundContext performBlock^{
    ...
    pendingSquares = [[appDelegate.serverMOC executeFetchRequest:fetchRequest error:&error] mutableCopy];
    [pendingSquares filterUsingPredicate:[NSPredicate predicateWithFormat:@"isPendingChange == YES"]];
}]; 
```

但是，我确实取回了项目，但它们都没有 isPendingChange 的新值 1。

为什么更改没有传播到 backgroundContext？根据文档：

> 您在一个上下文中对托管对象所做的更改不会传播到不同上下文中的相应托管对象，除非您重新获取或重新故障该对象。

所以我确实重新获取了，但没有提交更改。而且我认为在进行更改后我真的不需要保存 mainContext 以使其出现在 backgroundContext 中，对吗？

如果方形对象归 backgroundContext 所有，那么一切正常：

```
 squareObject = [getSquareObjectForContext:backgroundContext];
   squareObject.isPendingChange = [NSNumber numberWithBool:YES]; 
```

显然，当我在 backgroundContext 中获取这些更改时会出现这些更改，因为更改是在该上下文中进行的。我只是不明白为什么子上下文无法使用全新的获取请求获取父上下文所做的更改。我以为这是这样做的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T07:53:31.747

> 所以我确实重新获取了，但没有提交更改。而且我认为在进行更改后我真的不需要保存 mainContext 以使其出现在 backgroundContext 中，对吗？

这个假设是不正确的。您必须保存子上下文才能使更改出现在父上下文中。

但是当你保存父上下文时，它会自动触发先保存子上下文。

> 即使保存，当我获取时它也不会出现在子上下文中。

This is because changes are propagated from child to parent, not the other way around.

# php - 我的表单 php 不工作，我不知道我哪里出错了

> ID：11252637
> 
> 赞同：-3
> 
> 时间：2012-06-28T20:48:01.217
> 
> 标签：php, forms, sendmail, html-email

我对这一切都很陌生，但我创建了一个表单，这就是我写的发送它。我在这里使用了“example@gmail.com”而不是真实地址

```
<?php

/* Set e-mail recipient */
$myemail  = "example@gmail.com";

/* Check all form inputs using check_input function */
$names = check_input($_POST['names'], "Please return to our Application Form and enter your and your future spouse's names.");
$weddingtype = check_input($_POST['weddingtype'], "Please return to our Application Form and fill in what kind of wedding you will be having.");
$religioussect = check_input($_POST['religioussect'], "Please return to our Application Form and tell us about your religion and wedding traditions.");
$dateone = check_input($_POST['dateone'], "Please return to our Application Form and give us the date for at least one event.");
$eventone = check_input($_POST['eventone'], "Please return to our Application Form and list at least one event.");
$locationone = check_input($_POST['locationone'], "Please return to our Application Form and give us the location for at least one event.");
$durationone = check_input($_POST['durationone'], "Please return to our Application Form and give us the duration of at least one event.");
$typeone = check_input($_POST['typeone'], "Please return to our Application Form and tell us whether you would like video, photo or both for at least one event.");
$datetwo = $_POST['datetwo'];
$eventtwo = $_POST['eventtwo'];
$locationtwo = $_POST['locationtwo'];
$durationtwo = $_POST['durationtwo'];
$typetwo = $_POST['typetwo'];
$datethree = $_POST['datethree'];
$eventthree = $_POST['eventthree'];
$locationthree = $_POST['locationthree'];
$durationthree = $_POST['durationthree'];
$typethree = $_POST['typethree'];
$datefour = $_POST['datefour'];
$eventfour = $_POST['eventfour'];
$locationfour = $_POST['locationfour'];
$durationfour = $_POST['durationfour'];
$typefour = $_POST['typefour'];
$guests1 = check_input($_POST['guests1'], "Please return to our Application Form and tell us how many guests will attend at least one event.");
$guests2 = $_POST['guests2'];
$guests3 = $_POST['guests3'];
$guests4 = $_POST['guests4'];
$concerns = $_POST['concerns'];

if(!isset($_POST['submit'])){

$subject = "Quote Application";

/*Message for the e-mail */
$message = "Hello!

Another happy couple has filled out a Quote Application Form :D Hooray!

Their names are $names.

What sort of wedding are they having?
'$weddingtype'.

What religious sect and wedding traditions are they following?
'$religioussect'.

Now for their wedding events... Ooh boy!

1\.  $dateone    
$eventone
$durationone
$typeone
Estimated guests: $guests1

$locationone

2\.  $datetwo    
$eventtwo
$durationtwo
$typetwo
Estimated guests: $guests2

$locationtwo

3\.  $datethree  
$eventthree
$durationthree
$typethree
Estimated guests: $guests3

$locationthree

4\.  $datefour 
$eventfour
$durationfour
$typefour
Estimated guests: $guests4

$locationfour

Any concerns the couple have follow here:
'$concerns'

You better be ready to get to work now!
And also, have a really good day :)
";

/* Functions used */
function check_input($data, $problem='')
{
$data = trim($data);
$data = stripslashes($data);
$data = htmlspecialchars($data);
if ($problem && strlen($data) == 0)
{
    show_error($problem);
}
return $data;
}

function show_error($myError)
{
?>

<b>We apologize for the inconvenience, an error occurred.</b><br />
<?php echo $myError; ?>

<?php
exit();
}

/* Send the message using mail() function */
mail($myemail, $subject, $message);

/* Redirect visitor to the thank you page */
header('Location: thanks.html');
exit();

?> 
```

请帮我找出我做错了什么，我在这里几乎不是初学者。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:59:06.220

`PHP Parse error:syntax error, unexpected $end in /var/www/test.php on line 133`

通过在最后一个关闭 PHP 标记之前放置一个缺失的 '}' 来修复`?>`

这揭示了：`PHP Fatal Error: Call to undefined function check_input() in /var/www/test.php on line 7`

将其移至顶部：

```
function check_input($data, $problem='')
{
$data = trim($data);
$data = stripslashes($data);
$data = htmlspecialchars($data);
if ($problem && strlen($data) == 0)
{
    show_error($problem);
}
return $data;
} 
```

表明我们必须将另一个向上移动到另一个函数的正下方。

```
function show_error($myError)
{
?>
<b>We apologize for the inconvenience, an error occurred.</b><br />
<?php echo $myError; ?>
<?php
exit();
} 
```

它是固定的。完整的固定代码（比较草率，我没有清理）：[[链接]](http://pastebin.com/NvR7BgeR)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:13:31.480

*我试图帮助清理您的代码并修复逻辑错误。我没有测试过这段代码，所以一定要测试一下。我还建议您花一点时间检查所使用的语言结构，例如`foreach`，因为写出这样的一长串变量可能会非常难以调试。*

```
<?php

if(! isset($_POST['submit'])) exit;

// Error messages
$error_messages = array(
    'names'         => 'Please return to our Application Form and enter your and your future spouse\'s names.',
    'weddingtype'   => 'Please return to our Application Form and fill in what kind of wedding you will be having.',
);

$errors = array();

foreach ($_POST as $key => &$value) {
    // If value is empty and error message exists, add error to the list
    if (empty($value) AND in_array($key, $error_messages)) {
        $errors[] = $error_messages[$key];
        continue;
    }

    // Variable variables, worth learning. $_POST['key'] becomes $key in your script.
    ${$key} = htmlspecialchars(trim($value), ENT_QUOTES, 'UTF-8');
}

// Errors existed, let's show them all
if (! empty($errors)) {
    echo '<b>We apologize for the inconvenience but there were errors:</b><br />';

    foreach ($errors as &$error) {
        echo $error . '<br />';
    }

    exit;
}

// All good, let's send
$email  = "example@gmail.com";
$subject = "Quote Application";

$message = "
    Hello!

    Another happy couple has filled out a Quote Application Form :D Hooray!

    Their names are $names.

    What sort of wedding are they having?
    '$weddingtype'.

    What religious sect and wedding traditions are they following?
    '$religioussect'.

    Now for their wedding events... Ooh boy!

    1\.  $dateone    
    $eventone
    $durationone
    $typeone
    Estimated guests: $guests1

    $locationone

    2\.  $datetwo    
    $eventtwo
    $durationtwo
    $typetwo
    Estimated guests: $guests2

    $locationtwo

    3\.  $datethree  
    $eventthree
    $durationthree
    $typethree
    Estimated guests: $guests3

    $locationthree

    4\.  $datefour 
    $eventfour
    $durationfour
    $typefour
    Estimated guests: $guests4

    $locationfour

    Any concerns the couple have follow here:
    '$concerns'

    You better be ready to get to work now!
    And also, have a really good day :)
";

mail($email, $subject, $message);

header('Location: thanks.html');
exit;

?> 
```

# jquery - 如何扩展 JQuery UI 插件

> ID：11252639
> 
> 赞同：1
> 
> 时间：2012-06-28T20:48:02.610
> 
> 标签：jquery, user-interface, dialog, extend

现有的对话框插件没有在单击模态覆盖时关闭对话框的选项，如何添加选项以提供该功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T20:48:03.640

```
(function($){
   var _init = $.ui.dialog.prototype._init;
   $.ui.dialog.prototype._init = function(){
        var self = this;
        _init.apply(this,arguments);
        $('.ui-widget-overlay').live('click', function(){
            if (self.options['overlay_close']){
                self.destroy();
            }
        });
    }
})($); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:15:34.913

如果自己提供的答案有效，那就更好了。

在对话框外单击时我没有得到任何响应。这是我用于测试的[jsFiddle](http://jsfiddle.net/styson/menjK/)。

也许我做错了什么，但它似乎没有发挥它想要的功能。

@JamesLin 提供了关键见解。我需要在初始化中添加新选项：

```
$("#myDialog").dialog({
    overlay_close:true,
    modal: true
}); 
```

jsFiddle 也更新了。

# wpf - WPF中消失的控件

> ID：11252643
> 
> 赞同：1
> 
> 时间：2012-06-28T20:48:19.877
> 
> 标签：wpf, wpf-controls

我有一个现有的 WPF xaml 布局，我在其中添加了一个带有标签和按钮的 stackview。但是，添加后，“列”和“布局列”树视图会在运行应用程序时消失。这是表单的 xaml：

```
<UserControl xmlns:my="clr-namespace:MyNamespace.Controls.LayoutEditors.OrderableList"  x:Class="MyNamespace.Controls.LayoutEditors.LayoutColumnsEditor"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         mc:Ignorable="d" 
         d:DesignHeight="832" d:DesignWidth="595"
         >
<Grid Name="Grid">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="110" />
            <RowDefinition Height="5" />                
        </Grid.RowDefinitions>
        <Grid Name="gridLabels">
            <StackPanel Orientation="Vertical">
                <Label Style="{StaticResource SubHeaderLabel}" Content="Properties" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" />
                <StackPanel Margin="0 5"  Orientation="Horizontal">
                    <Label Content="Layout Name:" HorizontalContentAlignment="Right" Width="120"  />
                    <TextBox Width="488" HorizontalAlignment="Left" VerticalAlignment="Top" Name="EditLayoutName" LostKeyboardFocus="TextBoxLayoutNameLostFocus" MaxLength="50" />
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <Label Content="Description:" HorizontalContentAlignment="Right" Width="120" />
                    <TextBox Height="50" Name="EditDescription" VerticalScrollBarVisibility="Auto"  Width="483" TextWrapping="WrapWithOverflow" HorizontalScrollBarVisibility="Auto" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" >
                    <Label Content="Search for Columns:" HorizontalContentAlignment="Right" Width="120"></Label>
                    <TextBox Height="50" Name="txtColumnName" Width="200" TextWrapping="NoWrap" HorizontalScrollBarVisibility="Hidden" TextChanged="txtColumnName_TextChanged"></TextBox>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Grid>
    <Grid Grid.Row="2" Name="gridColumns">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="300" MinWidth="40" />
            <ColumnDefinition Width="7" />
            <ColumnDefinition MinWidth="40" />
        </Grid.ColumnDefinitions>
        <Grid Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="20" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Label Grid.Row="0" Content="Columns:" Height="21" HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" Name="labelColumns" VerticalAlignment="Top" Style="{StaticResource SubHeaderLabel}" />
            <telerik:RadTreeView Background="White" ScrollViewer.VerticalScrollBarVisibility="Auto" ScrollViewer.HorizontalScrollBarVisibility="Auto" FontSize="11" Grid.Row="1" Name="TreeColumns" HorizontalAlignment="Stretch" IsDragDropEnabled="False" IsTextSearchEnabled="True" ItemDoubleClick="TreeColumnsItemDoubleClick" IsEditable="True" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" />
        </Grid>
        <GridSplitter Grid.Column="1" HorizontalAlignment="Left" Name="gridSpiliter" Width="7" Background="#FF4D6798" VerticalAlignment="Stretch" ResizeDirection="Columns" BorderBrush="#FF021E4B" BorderThickness="1" />
        <Grid Grid.Column="2" Name="TileViewGrid" MinWidth="40">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="174*" />
                <ColumnDefinition Width="114*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="20" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <Label Content="Layout Columns:" Height="21" Name="labelLauoutColumns" VerticalAlignment="Top" HorizontalContentAlignment="Left" HorizontalAlignment="Stretch" Style="{StaticResource SubHeaderLabel}" Grid.RowSpan="2" Grid.ColumnSpan="2" />
            <ScrollViewer Grid.Row="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" VerticalScrollBarVisibility="Auto" Grid.ColumnSpan="2">
                <my:OrderableList x:Name="ListLayoutColumns" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="White" />
            </ScrollViewer>
        </Grid>
    </Grid>
</Grid>
 </UserControl> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:57:30.620

为元素添加`Grid.Column`和`Grid.Row`值。例如：

```
<Label Content="Layout Columns:" Height="21" Name="labelLauoutColumns" 
    VerticalAlignment="Top" HorizontalContentAlignment="Left" 
    HorizontalAlignment="Stretch" Style="{StaticResource SubHeaderLabel}" 
    Grid.RowSpan="2" Grid.ColumnSpan="2" 
    Grid.Column="0" Grid.Row="0"
/> 
```

事实上，请确保您对将包含在网格中的**每个UI 元素执行此操作。**通过这种方式，您可以确保控件*恰好*位于您想要的位置。

！

# asp.net-mvc - 带有问号的 MVC 路由段？

> ID：11252650
> 
> 赞同：5
> 
> 时间：2012-06-28T20:48:57.947
> 
> 标签：asp.net-mvc, asp.net-mvc-3

在Sam Saffron 的[这篇文章](http://samsaffron.com/archive/2011/10/13/optimising-asp-net-mvc3-routing)中，他提到 Stack Overflow 的路由如下所示：

```
questions/{id}/{title?} 
```

那是错字吗？这个问号有什么作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:04:44.073

来自[http://maproutes.codeplex.com/](http://maproutes.codeplex.com/)：

```
[Url("store/{category?}")]
public ActionResult Products(string category)
{
    return View();
} 
```

> “？” 参数末尾的符号`{category?}`表示它是可选的。`UrlParameter.Optional`将是它的默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:57:54.880

StackOverflow 使用[基于属性的路由](http://kevinmontrose.com/2011/07/25/why-i-love-attribute-based-routing/)，所以我猜问号将该路由参数标记为可选。

# php - 使用 SESSIONS 进行基本登录

> ID：11252655
> 
> 赞同：-5
> 
> 时间：2012-06-28T20:49:32.733
> 
> 标签：php, mysql, session, cookies

我在使用 php 和 mysql 进行简单登录时遇到问题。

这是我的代码：

登录.PHP

```
 <?php

    //include 'core/init.php';
    include 'functions.php';

    //JH check if user is logged in already
    if (loggedin()) {
        header("location: userarea.php");
        exit();
    }

    if ($_POST['login']) { 
        $user = $_POST['user'];
        $pass = $_POST['pass'];
        $remember = $_POST['remember'];
        $password_encrip = hash('md5', $pass);

    if ($user&&$pass) {
        $login = mysql_query("SELECT * FROM users WHERE user='$user'");
        while  ($row = mysql_fetch_assoc($login))   
        $db_pass = $row['pass']; {

        if ($password_encrip==$db_pass) 
            $login_ok = TRUE;
        else 
            $login_ok = FALSE;
        }

        if ($login_ok==TRUE) {

            if ($remember=="on")
                setcookie("user", $user, time()+7200);

            else if ($remember=="")
                $_SESSION['user']=$user;

            header("Location: userarea.php");
            exit();

        } else 
            echo "ERROR: Username/Password combination incorrect!";

        } else 
            die("ERROR: Hit back and enter username and password!");
    }

    ?>

    <form action="login.php" method="POST">
    <b style="font-size:150%;">Log in</b><br/>
    Username: <input type="text" name="user"/><br/>
    Password: <input type="password" name="pass"/><br/>
    <input type="checkbox" name="remember" />Remember me<br/>
    <input type="submit" name="login" value="Log in"/>
    </form> 
```

函数.PHP

```
 <?php 

    // REPORT ERRORS?
    //error_reporting(E_ALL);

    // SESSIONS CHECK
    session_start();

    //CONNECT TO DATABASE/CONNECT
    mysql_connect("localhost","MYSQL","PASS") or die();
    mysql_select_db('DB') or die();

    // LOGIN CHECK FUNCTION
    function loggedin()
    {
        if (isset($_SESSION['$user']) || isset($_COOKIE['$user']))
        {
            $loggedin = TRUE;
            return $loggedin;
        }
    }

    ?> 
```

用户区.PHP

```
 <?php 

    //include 'core/init.php';
    include 'functions.php';

    //JH check if user is logged in already
    if (!loggedin())
    {
        header("location: login.php");
        exit();
    }

    ?>

    <p>Welcome! You're Logged in</p> <a href="logout.php">Logout</a><br/>

    <?php
        echo "Welcome SESS: ".$_SESSION['user']. "<br/>";
        echo "Welcome Cookie: ".$_COOKIE['user']. "<br/>";
    ?> 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:52:09.970

在 PHP 的顶部，放置`session_start();`（您发布的第一页）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:35:33.053

试一试，一件大事是你总是想在添加到查询之前清理用户输入，而且如果没有设置 $_post 值，它们不会返回 false，所以这样做 if($_POST['something']) 会返回一个错误

```
----------------------------------- LOGIN.PHP

<?php

    //include 'core/init.php';
    include 'functions.php';

    //JH check if user is logged in already
    if (loggedin()) {
        header("location: userarea.php");
        exit();
    }

    if ($_POST['login']) {
        $user = mysql_real_escape_string($_POST['user']);
        $pass = mysql_real_escape_string($_POST['pass']);
        $remember = mysql_real_escape_string($_POST['remember']);
        $password_encrip = hash('md5', $pass);

        if (!empty($user) && !empty($pass)) {
            $login = mysql_query("SELECT * FROM users WHERE user='$user' AND pass = '$password_encrip'");

            while ($row = mysql_fetch_assoc($login)) {

                if (count($row) > 0) {
                    $login_ok = TRUE;
                } else {
                    $login_ok = FALSE;
                }
            }

            if ($login_ok) {

                if ($remember == "on") {
                    setcookie("user", $user, time() + 7200);
                } else if ($remember == "") $_SESSION['user'] = $user;

                header("Location: userarea.php");
                exit();

            } else {
                echo "ERROR: Username/Password combination incorrect!";
            }

        } else {
            die("ERROR: Hit back and enter username and password!");
        }
    }

?>

<form action="login.php" method="POST">
    <b style="font-size:150%;">Log in</b><br/>
    Username: <input type="text" name="user"/><br/>
    Password: <input type="password" name="pass"/><br/>
    <input type="checkbox" name="remember"/>Remember me<br/>
    <input type="submit" name="login" value="Log in"/>
</form>

------------------------------------------ FUNCTIONS.PHP

<?php

    // REPORT ERRORS?
    //error_reporting(E_ALL);

    // SESSIONS CHECK
    session_start();

    //CONNECT TO DATABASE/CONNECT
    mysql_connect("localhost", "MYSQL", "PASS") or die();
    mysql_select_db('DB') or die();

    // LOGIN CHECK FUNCTION
    function loggedin() {
        if (isset($_SESSION['$user']) || isset($_COOKIE['$user'])) {
            $loggedin = TRUE;
            return $loggedin;
        }
    }

?>

---------------------------------------------- USERAREA.PHP

<?php

    //include 'core/init.php';
    include 'functions.php';

    //JH check if user is logged in already
    if (!loggedin()) {
        header("location: login.php");
        exit();
    }

?>

<p>Welcome! You're Logged in</p> <a href="logout.php">Logout</a><br/>

<?php
    echo "Welcome SESS: " . $_SESSION['user'] . "<br/>";
    echo "Welcome Cookie: " . $_COOKIE['user'] . "<br/>";
?> 
```

# android - 停止绑定服务

> ID：11252665
> 
> 赞同：0
> 
> 时间：2012-06-28T20:50:06.140
> 
> 标签：android, binding, service

我有一个大型短信应用程序，我正在使用服务来处理大多数操作。该应用程序有大约 10 个不同的活动，它们绑定到服务以执行不同的操作。每个活动都在 onResume 中绑定到服务，并在 onStop 中取消绑定（我也将此处的引用设为无效）。该服务还接收 startService 命令以在应用程序首次打开时启动。

我正在尝试实现一个终止开关，以便当从某个号码发送带有某个关键字的文本时，它将关闭应用程序，除了单独的活动和许可服务以侦听重新激活文本。

主要的短信服务也作为前台服务运行，因此它显示在通知栏中。现在，当它收到停用文本时，它永远不会从通知栏中删除自己。我可以通过运行 stopForeground() 手动将其取出，但这只会将其从通知栏中取出。如果应用程序接收到激活文本，则服务会获取 onStartCommand，但不会获取 onCreate（我将其设置为前台服务）。

该服务似乎也从未调用 onDestroy() 方法。我在这里和其他地方读到过，当您使用 startService 并绑定到服务时，您必须首先确保取消绑定服务，然后运行 ​​stopService。正如我上面所说，我在绑定 onStop 的所有活动中取消绑定服务，因此如果这些活动都不可见，则不应绑定它们。我也打电话给 stopService 。

似乎服务还保留着一些东西，但我不知道是什么。我在此服务中存在 6 个单独的线程，我确保在尝试停止它之前将其销毁（以及取消注册短信接收器）。

关于如何进一步诊断的任何想法？

# javascript - new Function() 无法访问参数？

> ID：11252669
> 
> 赞同：3
> 
> 时间：2012-06-28T20:50:19.123
> 
> 标签：javascript

我尝试`new Function()`在计算器中使用，但发现它无法访问我传递给它所在函数的参数。我像这样使用它：

```
function go(a, b, c) {
    return new Function('return a + b + c')();
}

go(4, '/', 2); 
```

但它不起作用，因为它说 a 是未定义的。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T20:53:31.063

你可能想要：

```
function go(a, b, c) {
    return new Function('return ' + a + b + c + ';')();
}

go(4, '/', 2); 
```

但这不是正确的方法。为您支持的每个操作创建一个独特的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:00:18.703

也许这个？

```
var add = function (a, b, c) {
  return a + b + c;
}; 
```

然后像这样调用：

```
var sum = add(3, 4, 5); // sum is 12 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:17:08.360

我相信@Truth 对您要达到的目标的评估是正确的。但是，我很好奇为什么`a`未定义。

事实证明，规范声明当`Function`用作构造函数时，评估函数体的范围是全局环境： [第 15.3.2.1 节](http://ecma-international.org/ecma-262/5.1/#sec-15.3.2.1)

这与`eval()`使用当前范围不同。

# iphone - 不同的 UITableViewCell 高度

> ID：11252675
> 
> 赞同：15
> 
> 时间：2012-06-28T20:50:51.490
> 
> 标签：iphone, objective-c, ipad, uitableview

我在情节提要中构建了三个不同的单元，并将所有出口连接起来，每个单元都有一个唯一的标识符。

例如，我有一个包含图片的单元格，另一个包含标签，另一个包含其他内容，因此它们都是唯一的，并且每种单元格类型都需要自己的高度（动态或状态，没关系）。

但是，我怎么能让一个带有“indentifier1”的单元格返回某个高度，然后其他单元格返回不同的高度？

我知道我可以使用`- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath`，但我不确定如何区分这些细胞。

我正在使用核心数据并从中获取 tableview 的结果。

## 编辑

我已经用标签尝试过这个，但它在第一条`if`语句中崩溃了：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    CGFloat cellHeight;

    if ([[tableView cellForRowAtIndexPath:indexPath] tag] == 1) cellHeight = 170;
    else if ([[tableView cellForRowAtIndexPath:indexPath] tag] == 2) cellHeight = 100;
    else if ([[tableView cellForRowAtIndexPath:indexPath] tag] == 3) cellHeight = 140;

    return cellHeight;
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-28T20:55:56.853

**更新**

**现在使用 UITableView 的动态高度，因为它很容易，因为 UITableView 会自动计算它**

**老的**

使用此方法满足您的要求，下面是一个示例：

```
 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{

  //calculate height according to text and on basis of indexPath
  if(indexpath.row == 0)
  {
    return 60.0f;
  }
  else if(indexpath.row == 1)
  {
    return 70.0f;
  }
  else
  {
    return 55.0f;
  }
} 
```

**注意**：如果您的尺寸不固定，那么您将计算它然后根据您的要求在上述方法中提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:30:01.593

你不应该`cellForRowAtIndexPath`在内部调用，`heightForRowAtIndexPath`否则你会进入一个无限循环，这将导致应用程序崩溃。

您应该以与确定相同单元格类型相同的方式确定每个单元格的高度`cellForRowAtIndexPath`。

这是我认为的唯一解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:54:25.787

您将完全按照您在`cellForRowAtIndexPath:`. 如果您没有按部分对它们进行分组，那么您必须轮询您的数据以查找相关的特定 indexPath，然后确定高度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T20:55:52.217

我将为每个 UITableView Cell 设置标签，以便在 heightForRowAtIndexPath 中您可以通过以下方式进行区分：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
if ([self.tableview cellForRowAtIndexPath:indexPath].tag == yourTag){
     //perform your action for cell 1, 2, or 3
  }
else if (etc...)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T21:38:32.327

当然它崩溃了，因为你在一个委托方法中，（你是一个委托`UITableView`）并且从这样的方法回调这些`UITableView`方法有很高的崩溃风险。

您调用的方法 ( `[tableView cellForRowAtIndexPath:indexPath]`) 将再次为单元格的高度调用委托方法，它会导致无限循环，也就是崩溃。

这是正常行为。

**关键在您的原始数据源中，您可以将每一行的高度存储在原始数据源中，并且您可以从那里读取所有内容，在您的委托方法中没有任何风险。**

您的代码片段没有说明您的数据源在哪里以及您的数据源是什么类型，因此在缺少它的情况下我无法给出更准确的解决方案，但想法就是这样。

# c++ - C++ 制作代码编写器

> ID：11252676
> 
> 赞同：1
> 
> 时间：2012-06-28T20:50:52.697
> 
> 标签：c++, io, generator, game-engine, writer

首先，我对 c++ 的经验是有限的！我正在为游戏引擎开发关卡编辑器，我想知道如果在关卡编辑器中完成了一些事情并且程序将为用户编写 c++ 代码，我是否可以拥有某种系统。现在没有什么复杂的了，只是在函数中添加了几行代码。

我对要开始一无所知，所以我希望有人能指点我一本书或某种指导，以便为你编写一些东西来读写 C++ 代码。以前做过这件事是不需要的吗？

或者有解决办法吗？

大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:54:15.470

最好使用[Lua](http://www.lua.org/)或[Python](http://www.python.org/)等语言作为游戏引擎的脚本语言。为游戏内事件和脚本编写更多的 C++ 是没有意义的（因为它需要编译，并且该语言比其他语言的编写要求更高）。

# excel - Excel - 将单元格格式设置为持续时间 (mm:ss)

> ID：11252689
> 
> 赞同：2
> 
> 时间：2012-06-28T20:51:23.433
> 
> 标签：excel, format, duration

> **可能重复：**
> [Excel 2007：如何显示 mm:ss 格式而不是 DateTime（例如 73:07）？](https://stackoverflow.com/questions/11095994/excel-2007-how-to-display-mmss-format-not-as-a-datetime-e-g-7307)

我正在尝试在 excel 中进行一些慢跑训练，并且真的很惊讶按照我的意愿格式化单元格是多么困难。

任务很简单，我想将数据显示为 mm:ss，如果会话时间长于此，hh:mm:ss。那可能吗？我以为它可以与 [h]:mm:ss 一起使用，但它只是将单元格格式化为 1900-01-xx yy:zz 之类的东西...

所以困难的事情可能是我想默认写分钟。比如 27:59 或 72:59。（在第二种情况下，自动转换为 01:12:59 将是一件好事）

# web-services - 为什么 cfreturn 为空？

> ID：11252690
> 
> 赞同：1
> 
> 时间：2012-06-28T20:51:35.223
> 
> 标签：web-services, coldfusion, coldfusion-9, cfc

我代理了对 cfc 的调用，该 cfc 对本地临时文件执行 ftp“获取”。然后它读取文件并应该将文件内容作为字符串返回。我知道代码有效，当我将其从 cfc 中拉出到常规 cfm 文件中时，它完全符合预期。但是，在我的代理`callBackHandler`中，cfc 结果似乎为空。这是代理代码：

```
 <cfajaxproxy cfc="ftpfunc" jsclassname="jsobj" />
    function getFTP() {
       ...
       var instance = new jsobj();
       instance.setCallbackHandler(ftpSuccess);
       instance.setErrorHandler(ftpError);
       instance.setReturnFormat('plain');
       instance.getJCL(lpar,remoteFile,userName,password); 
    } 
```

.. 然后是 callbackHandler，它应该有从 cfc 返回的字符串：

```
 function ftpSuccess(ftpReturn)
    {
     // error thrown right here: "ftpReturn is Null"
       if (ftpReturn.length==0)
           { alert("Your FTP Get returned a blank file"); }
     } 
```

是否有要使用的特定语法？例如，当返回类型是结构或查询时，您必须使用类似`ftpReturn.DATA`. 直弦呢？

谢谢你的帮助

**编辑：这是cfc**

```
<cffunction name="getJCL" output="false" access="remote" securejson="true">
    <cfargument name="lpar" type="string" required="yes">
    <cfargument name="remoteFile" type="string" required="yes">
    <cfargument name="userName" type="string" required="yes">
    <cfargument name="password" type="string" required="yes">
    <cfset var ftpReturn = "">

    <cfftp action="open"
        connection="getConnection"
        password="#arguments.password#"
        secure="yes" 
        server="#arguments.lpar#" 
        stopOnError="no" 
        timeout="30" 
        username="#arguments.username#">

    <cfset tempFile="D:\myDir\#RandRange(10000000,99999999)#.tmp">

    <cfftp action="getFile"
        connection="getConnection"
        localFile="#tempFile#"
        remoteFile="#arguments.remoteFile#"
        transferMode="auto">

    <cffile action = "read" file = "#tempFile#" variable = "Message">

    <cfset ftpReturn = Message>

    <cfreturn ftpReturn>
</cffunction> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T14:09:40.763

> if i remove the callbackHandler function, i can see in the Console\Response tab of fireBug the actual file content, which is "test"
> ...
> i've installed fiddler too, under the json tag i only get "The response does not contain valid JSON text"

So you're not currently returning valid JSON?

It may or not be a bug in CF that it passes null if it receives invalid content (rather than throwing an error), but change the file contents to something that [validates](http://jsonlint.com/) and maybe it'll work?

You could also try something like...

```
<cftry>
    <cfset deserializeJson(ftpReturn) />
    <cfcatch>
        <cfset ftpReturn = '{"error":"invalid json"}' />
    </cfcatch>
</cftry> 
```

...to detect inside the function if it's valid JSON and if not return appropriate message.

Don't forget you need `output=false` on the cfcomponent tag itself, otherwise you might still get whitespace added from the area outside the functions.

A couple of other things - you're not actually using the `Message` variable, so just do:

```
<cffile action = "read" file = "#tempFile#" variable = "ftpReturn"> 
```

Also, random numbers are *not* guaranteed to be unique, so there's a small chance of getting data corruption unless you switch to:

```
<cfset tempFile="D:\myDir\#createUuid()#.tmp"> 
```

# c# - 访问值的多列列表框

> ID：11252693
> 
> 赞同：0
> 
> 时间：2012-06-28T20:51:54.473
> 
> 标签：c#, wpf, listbox

> **可能重复：**
> [WPF Listview 访问 SelectedItem 和子项](https://stackoverflow.com/questions/1402878/wpf-listview-access-to-selecteditem-and-subitems)

我有一个这样定义的列表视图：

```
<ListView Height="234.522" Name="chartListView" Width="260" SelectionChanged="chartListView_SelectionChanged" HorizontalAlignment="Left" Margin="251,38,0,38">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="op1" DisplayMemberBinding="{Binding op1}" Width="50"/>
                <GridViewColumn Header="op2" DisplayMemberBinding="{Binding op2}" Width="50"/>
                <GridViewColumn Header="op3" DisplayMemberBinding="{Binding op3}" Width="50"/>
                <GridViewColumn Header="op4" DisplayMemberBinding="{Binding op4}" Width="50"/>
                <GridViewColumn Header="op5." DisplayMemberBinding="{Binding op5}" Width="50"/>
            </GridView>
        </ListView.View>
    </ListView> 
```

我使用以下内容添加数据：

```
chartListView.Items.Add(new { 
  op1 = "test1", op2 = "test2", op3 = "test3", op4 = "test4", op5 = "test5" }); 
```

如何访问选定的项目之一，以便我可以查看列具有的值（`op3`例如）？以下代码显示了所有值，但我只想查看`op3`.

```
MessageBox.Show(chartListView.SelectedItem.ToString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:15:14.460

我建议使用**MVVM 模式**来将您的 UI 与底层逻辑连接起来。

在 Internet 上，您会找到大量有关 M* *VVM 模式** 的信息和资源。

核心思想是拥有一个保存数据结构和变量的**ViewModel (VM)。**这些数据结构和变量是完全自主的，不依赖于 UI 层。从 VM 到 UI/ **View** (V) 的结构和变量的连接位于**DataBindings**中。

因此，您需要做的（*在很短*的时间内）将列表控件的 ItemSource 属性与一些底层数据结构连接起来（这里通常的结构是**ObservableCollection** - 阅读文献以找出原因）。

这是第一步。第二步可能是向**ViewModel**添加一个 object 类型的变量，该变量将保存列表中当前选定的项目。要完成这项工作，您只需将列表的*SelectedItem* - 属性与此变量连接。

从那时起，每当您在列表中选择一个项目时，您在**视图**中的变量都会保存它的值。

当然，这是非常简短且相当粗略的，但也许它让您产生了深入研究**MVVM 模式**的想法——这是经过深思熟虑的 ;)

# mysql - MySql 的 Mybatis 序列生成器

> ID：11252694
> 
> 赞同：2
> 
> 时间：2012-06-28T20:51:55.820
> 
> 标签：mysql, ibatis, mybatis

我是 Mybatis 的新手，试图在 Spring 支持下实现 Mybatis。

我必须在表中插入一条记录，但是 Ibatis 是否有像休眠一样的序列生成器？

如果不必手动执行，例如 sequence.nextVal？我不喜欢。

任何建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T02:28:57.280

如果你自己声明了映射器，你必须这样做：

```
<insert id="insert" parameterType="com.your.app.Product">
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Integer">
        SELECT LAST_INSERT_ID()
    </selectKey>
    INSERT INTO product (name, value)
    VALUES (#{name,jdbcType=VARCHAR}, #{value,jdbcType=DOUBLE})
</insert> 
```

但是，如果您使用的是 MyBatis 生成器，您可以通过使用`generatedKey`table 标签内的标签来做到这一点，它会生成您需要的映射器。

例子：

```
<table tableName="product" alias="product">
    <generatedKey column="id" sqlStatement="MySql" identity="true" />
</table> 
```

# iphone - Xcode 项目 (iphone) 统计

> ID：11252702
> 
> 赞同：0
> 
> 时间：2012-06-28T20:52:31.877
> 
> 标签：iphone, xcode

我正在尝试快速了解我的 iphone 项目统计信息，例如

.m/.h/.nib 文件 LOC 的数量

# 班级

等等

[我只在http://www.literatureandlatte.com/freestuff/index.html](http://www.literatureandlatte.com/freestuff/index.html)找到 Xcode Statistician

这看起来不包括 .nib 文件

非常感谢任何其他有用的工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T20:57:33.583

您可以使用`wc`（字数）来计算行数（名称有点误导，它也可以行）。也许用一个简单`grep`的管道过滤掉空行。您也可以使用 grep 来搜索关键字`@interface`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-23T21:50:10.590

您可以检查并尝试[Xcode 的 Project Statistics](https://itunes.apple.com/us/app/project-statistics-for-xcode/id650764572?mt=12)。这是一款非常不错的软件。

# php - MySQL删除超过X分钟的记录？

> ID：11252704
> 
> 赞同：11
> 
> 时间：2012-06-28T20:52:46.660
> 
> 标签：php, mysql, sql

我进行了相当多的搜索，发现了一些最终对我不起作用并且无法理解原因的解决方案。

我有一个带有时间戳列的表。此列的 MySQL 类型是“日期时间”。我从 PHP 中将以下内容插入到此表中。

```
date('Y-m-d H:i:s') 
```

这输入，看起来像 MySQL 日期时间的正确值。

```
2012-06-28 15:31:46 
```

我想使用此列删除早于 10 分钟的行。我正在运行以下查询，但它不起作用。它影响 0 行。

```
DELETE FROM adminLoginLog WHERE timestamp < (NOW() - INTERVAL 10 MINUTE); 
```

谁能阐明我做错了什么以及为什么它不能正常工作？

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-28T20:58:46.527

由于 TIMESTAMP() 是一个返回当前时间戳的内置函数，因此您的查询将永远不会返回任何结果。

尝试将列包装在反引号中，让 MySQL 知道您的意思是该列，而不是保留字：

```
DELETE FROM adminLoginLog WHERE `timestamp` < (NOW() - INTERVAL 10 MINUTE); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T21:08:55.650

`timestamp`是mysql中的保留关键字。要`timestamp`用作字段名称，您必须将其放在反引号中，如下所示。

```
`timestamp` 
```

如果 time_created 是一个**unix timestamp (int)**，你应该能够使用这样的东西：

```
DELETE FROM adminLoginLog WHERE `timestamp` < (UNIX_TIMESTAMP() - 600); 
```

（600 秒 = 10 分钟 - 显然）

否则（如果 time_created 是**mysql timestamp**），你可以试试这个：

```
DELETE FROM adminLoginLog WHERE `timestamp` < (NOW() - INTERVAL 10 MINUTE) 
```

## 更新 1

```
DELETE FROM adminLoginLog WHERE `timestamp` < DATE_SUB( CURRENT_TIME(), INTERVAL 10 MINUTE) 
```

## 更新 2

```
DELETE FROM adminLoginLog WHERE `timestamp` < DATE_SUB( NOW(), INTERVAL 10 MINUTE) 
```

## [演示](http://sqlfiddle.com/#!2/c426e/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:02:50.947

我会在 php 中生成时间戳，然后将其传递给您的 mysql 查询：

```
$date = new DateTime();
$date->modify("-10 minutes") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:17:59.747

您的查询是正确的，如果您有权访问 phpmyadmin，请在 SQL 控制台中执行该命令，该命令将为您提供更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-01T14:36:51.187

PHP代码：

```
//Your Database Details

$conn = mysqli_connect("localhost","root","","tifu");

//Actual Core thing

$delete_otp = mysqli_query($conn,"DELETE FROM temp_project_member_details WHERE create_at < ('" . date("Y-m-d H:i:s"). "' - INTERVAL 10 MINUTE)"); 
```

注意：这里 temp_project_member_details ：数据库tifu中的表名

和 create_at ：表 temp_project_member_details 中的字段名称，其中使用相同的函数存储日期和时间`'" . date("Y-m-d H:i:s"). "'`

[10分钟后删除代码截图](https://i.stack.imgur.com/9pS4B.jpg)

[如答案所述，在表的 create_at 字段中存储日期和时间的屏幕截图](https://i.stack.imgur.com/4ETZj.jpg)

# ruby-on-rails - 在 Rails 中，我将如何最好地做到这一点？模型样本需要根据第一个模型属性进行随机化

> ID：11252705
> 
> 赞同：0
> 
> 时间：2012-06-28T20:52:50.930
> 
> 标签：ruby-on-rails, ruby, activerecord, model

[在 Rails 中，如何根据第一个属性自动分配项目的所有属性](https://stackoverflow.com/questions/11250930/in-rails-how-do-you-assign-all-attributes-of-an-item-automatically-depending-on)

我的问题的第一部分在上面的链接中，

我使用示例@ring.display_name = Ring::DISPLAY_NAME.sample 抓取了一个随机属性。这不是问题。困扰我的是抓住其余的属性。

我现在需要根据为 display_name 随机选择的内容来抓取 @ring.gold、@ring.roll 和 @ring.bonus。现在看一下我的模型，我知道这是错误的，但是您能告诉我是否有更好的方法可以做到这一点，也许可以吗？

```
class Ring < ActiveRecord::Base

  # Display_name
  DISPLAY_NAME = [ 'Beginners', 'Silver', 'Gold', 'Diamond' ]

  # Gold
  if Ring.display_name == 'Beginners'
    GOLD = [ 0 ]
  end
  if Ring.display_name == 'Silver'
    GOLD = [ 0 ]
  end
  if Ring.display_name == 'Gold'
    GOLD = [ 0 ]
  end
  if Ring.display_name == 'Diamond'
    GOLD = [ 0 ]
  end

  # Roll
  if @ring.display_name == 'Beginners'
    ROLL = [ 1 ]
  end  
  if @ring.display_name == 'Silver'
    ROLL = [ 1, 2, 3 ]
  end
  if @ring.display_name == 'Gold'
    ROLL = [ 2, 3, 4 ]
  end
  if @ring.display_name == 'Diamond'
    ROLL = [ 4, 5, 6 ]
  end

  # Bonus
  if Ring.display_name == 'Beginners'
    BONUS = [ ring.user.level + 1 ]
  end  
  if Ring.display_name == 'Silver'
    BONUS = [ ring.user.level + (1 + rand(3)) ]
  end
  if Ring.display_name == 'Gold'
    BONUS = [ ring.user.level + (1 + rand(5)) ]
  end
  if Ring.display_name == 'Diamond'
    BONUS = [ ring.user.level + (1 + rand(8)) ]
  end

  attr_accessible :description, :display_name, :roll, :bonus, :total, :image, :gold

end 
```

正如您从代码中看到的那样，我尝试使用“if Ring.display_name”和“if @ring.display_name”这两种方法都不起作用，因为我假设任何阅读本文的人都知道他们不会。

谢谢！

**更新！**

这是我目前正在使用的代码。这是不对的，我不太明白如何使用这种技术。看看我有什么。

```
class Ring < ActiveRecord::Base

  # Display_name
  DISPLAY_NAME = [ 'Silver', 'Gold', 'Diamond' ]

  # Rolls
  ROLL = {
    'Silver'    => [1, 2, 3],
    'Gold'      => [2, 3, 4],
    'Diamond'   => [4, 5, 6]
  }
  self.roll = ROLL[self.display_name]

  BUY = {
    'Silver'    => [100..180],
    'Gold'      => [140..200],
    'Diamond'   => [180..350]
  }
  self.buy = BUY[self.display_name]

  BONUS = {
    'Silver'    => [(1 + rand(3))],
    'Gold'      => [(3 + rand(5))],
    'Diamond'   => [(5 + rand(8))]
  }
  self.bonus = BONUS[self.display_name].call

  attr_accessible :user, :active, :display_name, :description, :gold, :buy, :sell, :roll, :bonus, :total, :image, :description

end 
```

在我的控制器中：

```
def create
    @ring = Ring.new
    @ring.display_name = Ring::DISPLAY_NAME.sample

    @ring.save

    redirect_to @ring
  end 
```

我理解的方式，如果我告诉它选择一个随机的 display_name，所有其他字段将根据我在模型中的内容填写，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:20:39.613

您可以从条件句中生成哈希值，如下所示：

```
class Ring < ActiveRecord::Base

  # Display_name
  DISPLAY_NAME = [ 'Silver', 'Gold', 'Diamond' ]

  # Rolls
  ROLL = {
    'Silver'    => [1, 2, 3],
    'Gold'      => [2, 3, 4],
    'Diamond'   => [4, 5, 6]
  }

  BUY = {
    'Silver'    => [100..180],
    'Gold'      => [140..200],
    'Diamond'   => [180..350]
  }

  BONUS = {
    'Silver'    => ->(){(1 + rand(3))},
    'Gold'      => ->(){(3 + rand(5))},
    'Diamond'   => ->(){(5 + rand(8))}
  }

  attr_accessible :user, :active, :display_name, :description, :gold, :buy, :sell, :roll, :bonus, :total, :image, :description

  def display_name=(name)
    super(name)
    self.roll = ROLL[self.display_name]
    self.buy = BUY[self.display_name]
    self.bonus = BONUS[self.display_name].call
  end
end 
```

# ios - iOS：在用户交互/滚动时执行操作

> ID：11252706
> 
> 赞同：13
> 
> 时间：2012-06-28T20:52:51.510
> 
> 标签：ios, uiscrollview, performselector

我试图让我的应用程序在延迟后执行一个操作，但必须在用户与`UIScrollView`.

我不确定为什么两者都不会`performSelector:withObject:afterDelay`或`scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:`不会开火。是因为他们在后台线程上吗？

有什么建议或帮助吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-28T21:07:41.233

两者`NSTimer`并且`performSelector:withObject:afterDelay:`默认情况下仅在正常运行循环模式下触发。滚动时，运行循环处于事件跟踪模式。

您必须在所有常见模式下安排定时操作：

```
NSTimer *timer = [NSTimer timerWithTimeInterval:0.016 target:self selector:@selector(fire:) userInfo:nil repeats:YES];
[[NSRunLoop currentRunLoop] addTimer:timer forMode:NSRunLoopCommonModes]; 
```

或者

```
[self performSelector:@selector(fire:) withObject:nil afterDelay:1.0 inModes:[NSArray arrayWithObject:NSRunLoopCommonModes]]; 
```

还有专用的`NSEventTrackingRunLoopMode`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-15T08:06:39.087

确保延迟触发发生在`NSRunLoopCommonModes`. 默认值是`NSDefaultRunLoopMode`在滚动时不会收到消息。

```
[self performSelector:@selector(fire:) withObject:nil afterDelay:2.0 inModes:@[NSRunLoopCommonModes]]; 
```

或者，您可以使用`GCD`which 也以相同的方式运行（不确定它使用哪种运行循环模式）

```
double delayInSeconds = 2.0;
dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));
dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
    <#code to be executed on the main queue after delay#>
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-22T09:56:38.260

对于斯威夫特：

```
performSelector(#selector(fire:), withObject: sender, afterDelay: 1.0, inModes: [NSRunLoopCommonModes]) 
```

# c - 如何制作可以运行 x86 十六进制代码的 C 程序

> ID：11252707
> 
> 赞同：8
> 
> 时间：2012-06-28T20:52:56.490
> 
> 标签：c, x86, inline-assembly

我有一组可以转换为汇编指令的十六进制代码，我想用 C 语言创建可以执行这些代码的程序。

```
unsigned char rawData[5356] = {
    0x4C, 0x01, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x64, 0x0C, 0x00, 0x00,
    0x3D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x01, 0x2E, 0x74, 0x65, 0x78,
    0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xB4, 0x05, 0x00, 0x00, 0xA4, 0x01, 0x00, 0x00, 0x68, 0x08, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x61, 0x00, 0x00, 0x00, 0x20, 0x00, 0x30, 0x60,
    0x2E, 0x64, 0x61, 0x74, 0x61, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x40, 0x00, 0x30, 0xC0, 0x2E, 0x62, 0x73, 0x73, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x30, 0xC0, 0x2F, 0x34, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x14, 0x00, 0x00, 0x00, 0x58, 0x07, 0x00, 0x00, 0x32, 0x0C, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x20, 0x10, 0x30, 0x60,
    0x2F, 0x33, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x6C, 0x07, 0x00, 0x00,...and so on 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T22:09:11.537

使用 x86 是可能的。

这是一个小样本。分配具有写入/执行权限的页面并在那里复制您的操作码。

```
#ifdef _WIN32
#include <windows.h>
#else
#include <sys/mman.h>
#include <unistd.h>
#endif

int main(){
    char opcodes[] = { ..... }; 

    #ifdef _WIN32

    HANDLE mem_handle = CreateFileMappingA( INVALID_HANDLE_VALUE, NULL, PAGE_EXECUTE_READWRITE, 0,  length, NULL);

    void* mem_map = MapViewOfFile( mem_handle, FILE_MAP_ALL_ACCESS | FILE_MAP_EXECUTE, 0x0, 0x0, length);

    #else // posix
    void* mem_map = mmap(NULL, sizeof(opcodes), PROT_EXEC|PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANON, -1, 0);
    #endif

    memcpy(mem_map, opcodes, sizeof(opcodes));

    (( void(*)() )mem_map)();

    return 0;
} 
```

对于 POSIX 系统，使用 mmap() 调用。

另请阅读有关蹦床的信息。见链接： http: [//pages.cs.wisc.edu/~weinrich/papers/method_dispatch.pdf](http://pages.cs.wisc.edu/~weinrich/papers/method_dispatch.pdf)

你没有说这是一个完整的程序还是一个单一的功能。相对/绝对寻址可能存在问题。

小备注：此代码也适用于启用 MMU 的 PowerPC 和 ARM。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T20:56:15.527

声明一个函数指针，然后调用该函数。

```
void (*f)(void) = (void (*)(void)) rawData;
f(); 
```

当然，这是未定义的行为，不能保证有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-29T07:02:47.523

在某些平台上，您不能只声明：

```
void (*f)(void) = (void (*)(void)) rawData; 
```

并尝试

```
f(); 
```

运行十六进制代码。

由于数据页可能无法执行。在不关心函数内容的情况下定义函数的一种便捷方法是将`.s`文件添加到项目中。

用 GNU as 编译它，并将它的目标文件链接到您的最终程序。

例如：

**主程序**

```
int main()
{
    helloasm();
    return 0;
} 
```

**xs**

代码像 C 语句一样工作：`printf("Hello ASM\n"); exit(11);`

```
.global helloasm
helloasm:
.byte 0x48, 0xc7, 0xc7, 0x01, 0x00, 0x00, 0x00, 0xe8, 0x0b, 0x00, 0x00, 0x00, 0x48, 0x65, 0x6c, 0x6c
.byte 0x6f, 0x20, 0x41, 0x53, 0x4d, 0x21, 0x0a, 0x5e, 0x48, 0xc7, 0xc2, 0x0b, 0x00, 0x00, 0x00, 0xb8
.byte 0x01, 0x00, 0x00, 0x00, 0x0f, 0x05, 0xbf, 0x0b, 0x00, 0x00, 0x00, 0xb8, 0x3c, 0x00, 0x00, 0x00
.byte 0x0f, 0x05 
```

编译运行

```
as x.s -o x.o
gcc main.c x.o -o main
./main
Hello ASM! 
```

此外，如果您的十六进制代码数组位于二进制文件中，例如**a.bin**

```
hexdump -C a.bin
00000000  48 c7 c7 01 00 00 00 e8  0b 00 00 00 48 65 6c 6c  |H...........Hell|
00000010  6f 20 41 53 4d 21 0a 5e  48 c7 c2 0b 00 00 00 b8  |o ASM!.^H.......|
00000020  01 00 00 00 0f 05 bf 0b  00 00 00 b8 3c 00 00 00  |............<...|
00000030  0f 05                                             |..|
00000032 
```

那么你的**xs**可能是：

```
.global helloasm
helloasm:
.incbin "a.bin" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T21:12:53.440

查看头文件 elf.h 。

您需要使用 OPCodes 完成这些结构中的字段。

在 x86 中有一个加载可执行文件的协议，否则在链接器将控制权传递给加载的代码后，它会崩溃。

看这里如何创建一个有效的可执行文件：

[http://bellard.org/otcc/otccelfn.c](http://bellard.org/otcc/otccelfn.c)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-28T20:56:23.897

您不能将它们输出到文件然后使用`system()`调用吗？这样您就不必担心该数组是否遵循 C 调用约定。

# ruby-on-rails - 使用 OmniAuth 错误更改的 Facebook 登录被拒绝

> ID：11252713
> 
> 赞同：2
> 
> 时间：2012-06-28T20:53:07.240
> 
> 标签：ruby-on-rails, facebook, ruby-on-rails-3, heroku, omniauth

[我能够使用 Omniauth http://railscasts.com/episodes/241-simple-omniauth](http://railscasts.com/episodes/241-simple-omniauth)我的 Rails 应用程序设置我的 Facebook 和 Twitter 登录。我的登录在我的计算机上完美运行（我在生产和开发中都进行了测试），直到有人在尝试使用 Facebook 登录时通过电子邮件发送给我这个问题时，我才发现问题：

`The change you wanted was rejected. Maybe you tried to change something you didn't have access to.`

事实证明，除了我在我的开发计算机上，没有其他人可以通过 FB 或 Twitter 登录或创建帐户。

从其他解决方案中，我删除`protect_from_forgery`并添加`skip_before_filter :verify_authenticity_token`到了我的 application_controller.rb，但我仍然遇到同样的问题。

我在 Heroku 上托管我的应用程序。

有谁知道发生了什么？让我知道你们是否需要任何其他信息。

# jquery - 为什么这个幻灯片/切换只运行一次？

> ID：11252719
> 
> 赞同：-1
> 
> 时间：2012-06-28T20:53:26.060
> 
> 标签：jquery, slidetoggle

我只是想不通，为什么这个滑动切换不起作用。它只运行一次：

HTML：

```
<div class="text">bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
    <br />
    bla bla bla bla
</div>
<div class="button">Show</div>​ 
```

CSS：

```
.text{
  height:0;
  overflow:hidden;
}
.heightAuto{
    height:auto;
}​ 
```

功能：

```
$(function(){
    $(".button").toggle(function()

        {
            var $text = $(".text");
            var contentHeight = $text.addClass('heightAuto').height();

            $text.removeClass('heightAuto').animate({ height: contentHeight}, 500);

        }, function() {

            $(".text").animate({ height: "0"}, 500);

        });
}) ; 
```

​</p>

这是小提琴：

[http://jsfiddle.net/QwmJP/10/](http://jsfiddle.net/QwmJP/10/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:59:06.807

因为 contentHeight 变量在第一个动画之后再次为 0。

如果您不覆盖它，它将起作用：

```
$(function() {
    var $text = $(".text");
    var contentHeight = $text.addClass('heightAuto').height();
    $text.removeClass('heightAuto');

    $(".button").toggle(function() {    
        $text.removeClass('heightAuto').animate({
            height: contentHeight
        }, 500);

    }, function() {

        $(".text").animate({
            height: "0"
        }, 500);
    });
});​ 
```

[http://jsfiddle.net/QwmJP/13/](http://jsfiddle.net/QwmJP/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T20:57:17.453

相反，请使用以下 jQuery

```
$('.button').on('click', function() {
    $('.text').slideToggle();
});​ 
```

看这个活生生的[例子](http://jsfiddle.net/QwmJP/12/)

# ruby-on-rails - Ruby on Rails：尝试添加到集合时出现多对多错误

> ID：11252722
> 
> 赞同：1
> 
> 时间：2012-06-28T20:54:05.743
> 
> 标签：ruby-on-rails, ruby, arrays

我有 2 个模型 (`model1`和`model2`) 具有多对多关系。一个表已经存在，它只包含每个模型的主键。这些`has_many through`关系是在它们各自的模型中建立的。但是，当我在 POST 中尝试以下操作时，我得到了经典

```
NoMethodError: You have a nil object when you didn't expect it!    
You might have expected an instance of Array. The error occurred while 
evaluating nil.[]": 
```

```
model1 = Model1.find(params[:id])
model2 = Model2.find(params[:model2_id])
model1.model2s << model2 
```

`model1`不是零。 `model1.model2s`不是零。 `model2`不是零。这个错误来自哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:21:53.063

如果您有一个**仅**包含每个模型的主键的连接表，那么您`has_and_belongs_to_many`不希望`has_many :through`

# r - 代理变量分析因“下标越界”而失败

> ID：11252724
> 
> 赞同：1
> 
> 时间：2012-06-28T20:54:07.450
> 
> 标签：r, bioconductor

我正在尝试使用[Bioconductor 的 sva 包](http://www.bioconductor.org/packages/release/bioc/html/sva.html)应用代理变量分析。[小插图](http://www.bioconductor.org/packages/release/bioc/vignettes/sva/inst/doc/sva.pdf)中的示例工作正常，但是当我尝试使用真实数据时，出现“下标越界”错误`irwsva.build`：

```
$ R

R version 2.15.0 (2012-03-30)
…
> trainData <- read.table('http://www.broadinstitute.org/~ljosa/svaproblem/trainData.txt')
> trainpheno <- read.table('http://www.broadinstitute.org/~ljosa/svaproblem/trainpheno.txt')
> testData <- read.table('http://www.broadinstitute.org/~ljosa/svaproblem/testData.txt')
> trainData <- as.matrix(trainData)
> testData <- as.matrix(testData)
> library(sva)
> trainMod <- model.matrix(~as.factor(label), trainpheno)
> num.sv(trainData, trainMod)
[1] 8
> trainMod0 <- model.matrix(~1, trainpheno)
> trainSv <- sva(trainData, trainMod, trainMod0)
Number of significant surrogate variables is:  8 
Iteration (out of 5 ):1  2  3  4  5  Error in irwsva.build(dat = dat, mod = mod, mod0 = mod0, n.sv = n.sv,  : 
  subscript out of bounds 
```

试图缩小范围的尝试`debug()`显示`fast.svd`正在调用一个全零的 453 x 100 矩阵。（尺寸 453 x 100 与我的训练集相同。）这导致 a`V`为 100 x 0；“下标越界”错误是因为`irwsva.build`尝试索引到`V`. 我的数据一定有某些东西导致了这种行为——但是什么？

作为一种可能的解决方法，我尝试`sva`使用以下方法调用`method="two-step"`：

```
> trainSv <- sva(trainData, trainMod, trainMod0, method='two-step')
Number of significant surrogate variables is:  8 
```

这有效，但我需要随后调用`fsva`. 那失败了，因为调用`sva`with`method="two-step"`导致`trainSv$pprob.b`为 NULL。

那么我的数据与小插图中的数据有何不同？在这两种情况下，训练和测试数据都是矩阵。在小插图中，训练矩阵为 22283 x 30；在我的例子中，它是 453 x 100。在小插图中，感兴趣的变量 ( *cancer* ) 是二进制的；在我的例子中，因变量可以取 12 个不同的值。

最后一个区别似乎很重要，因为如果我将范围缩小到 [0, 7]，它会起作用：

```
> trainMod <- model.matrix(~as.factor(label), trainpheno %% 8)
> trainSv <- sva(trainData, trainMod, trainMod0)
Number of significant surrogate variables is:  9 
Iteration (out of 5 ):1  2  3  4  5  > 
```

考虑到 100 个样本（列）可能不足以容纳 12 个类，我尝试了一个包含 293 个列的类似数据集。（数据来自同一个实验，但分析了 293 个单独的样本而不是 100 个处理。）它没有帮助：

```
> trainData <- read.table('http://www.broadinstitute.org/~ljosa/svaproblem/trainData3.txt')
> trainpheno <- read.table('http://www.broadinstitute.org/~ljosa/svaproblem/trainpheno.txt')
> trainData <- as.matrix(trainData)
> trainMod <- model.matrix(~as.factor(label), trainpheno)
> trainMod0 <- model.matrix(~1, trainpheno)
> trainSv <- sva(trainData, trainMod, trainMod0)
Number of significant surrogate variables is:  11 
Iteration (out of 5 ):1  2  3  4  5  Error in irwsva.build(dat = dat, mod = mod, mod0 = mod0, n.sv = n.sv,  : 
  subscript out of bounds 
```

如果我将 sva 限制为一次迭代，它能够运行完成，但我不知道我是否可以相信结果：

```
> trainSv <- sva(trainData, trainMod, trainMod0, B=1)
Number of significant surrogate variables is:  11 
Iteration (out of 1 ):1  > 
```

有没有人理解`irwsva`得足以说出为什么会发生这种情况？我能做些什么来让它在我的数据上工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:06:34.193

失败的最接近的原因是`irwa.build`使用快速奇异值分解，它只返回矩阵的*正*奇异值，如`?fast.svd`. 在您的数据中，唯一的值是零，这不是正数，因此您必须使用 plain`svd`而不是`fast.svd`.

我创建了一个修补函数`sva.patched`，它稍微修补`irwa.build`和`sva`函数来处理这种外部情况。我基本上改变了一行`irwa.build`：

```
# Before
sv = fast.svd(dats, tol = 0)$v[, 1:n.sv]
# After
if(any(dats!=0)) sv = fast.svd(dats, tol = 0)$v[, 1:n.sv]
else sv=svd(dats)$v[, 1:n.sv] 
```

您可以在[此处](http://textsnip.com/aaa078)获取代码：

但真正的问题是，为什么这些数据最终会产生一个零值矩阵？我对这种方法了解不多，但我可以给你一些线索。

据我所知，您正确使用了这些功能。但是，如果您检查循环`irwsva.build`函数，您会发现如果该函数返回 0，它将返回一个零矩阵`edge.ldfr`。该函数仅在没有`f.pvalue`大于 0.8 的 p 值返回时返回零。

分解`irwa.build`，这是从您的数据开始的方式：

```
dat=trainData
mod=trainMod
mod0=trainMod0
Id <- diag(ncol(dat))
resid <- dat %*% (Id - mod %*% solve(t(mod) %*% mod) %*% t(mod))
uu <- eigen(t(resid) %*% resid)
# Iterations begin.
mod.b <- cbind(mod, uu$vectors[, 1:n.sv])
mod0.b <- cbind(mod0, uu$vectors[, 1:n.sv])
ptmp <- f.pvalue(dat, mod.b, mod0.b)
which(ptmp>0.8)
# Only one value 
```

现在，第一次循环时，只有一个 p 值高于 0.8。通过第二次迭代，没有，这是所有零的原因。

如果您在小插图数据上运行相同的代码，您会发现它有许多高于 0.8 的 p 值，这就是它不返回错误的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T19:00:53.830

[来自Bioconductor 邮件列表](https://stat.ethz.ch/pipermail/bioconductor/2012-July/046639.html)的 John Leek（作者`sva`）的回复：

> 这个问题可能是因为您正在考虑的基因/特征数量较少（453）和响应变量的高维度（12）。由于响应变量有这么多不同的水平，许多特征可能与响应显着相关。sva 算法中的部分迭代是降低与响应强相关的特征的权重，因此整个数据集的权重被降低到 0。
> 
> 我建议只运行一次 sva 迭代。通常需要非常少的迭代才能收敛，并且由于您的数据在特征数量上的维数相对较低，因此如果您正在进行工件发现，这可能是您可以做的最好的事情。

# iphone - 通过自定义 UITableViewCell 推送到新的 UIViewController

> ID：11252729
> 
> 赞同：0
> 
> 时间：2012-06-28T20:54:32.590
> 
> 标签：iphone, ios5, storyboard

我正在使用此功能，但它不起作用。我正在使用 StoryBoard 和 xcode 4.3。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

     pushnavViewController *detailViewController = [[pushnavViewController alloc] initWithNibName:@"pushnavViewController" bundle:nil];

    detailViewController.pushh.text = [listt objectAtIndex:indexPath.row];
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T05:20:33.010

这是答案：

当您使用故事板时，您必须使用

```
pushnavViewController *detailViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"pushnavViewController"]; 
```

不是

```
 pushnavViewController *detailViewController = [[pushnavViewController alloc] initWithNibName:@"pushnavViewController" bundle:nil]; 
```

另外，不要忘记从 storyborad 设置标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T22:25:59.633

我想我会从评论中删除这个并尝试解决方案。抱歉，这不是一个直接的解决方案，而是更多的建议......

也许最好的做法是（如果您使用 Xcode 4.x）创建一个新项目，选择“主从应用程序”模板。查看 AppDelegate 类，看看 MasterViewController 是如何添加为 UINavigationController 的根视图控制器的。看看这是如何工作的，并尝试将其应用于您的情况。

此外，请查看 UINavigationController 的类参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T01:46:57.100

1- 创建故事板标识符：pushnavViewController 点击 ViewController，选择标签身份检查器 ==> 故事板 ID：pushnavViewController

2- 使用 Storyboard Identifier 启动 UIViewController

```
 UIStoryboard *mainStoryboard = self.storyboard;
    UIViewController *mainViewController = [mainStoryboard instantiateViewControllerWithIdentifier:@"pushnavViewController"]; 
```

3- 推送到另一个 ViewController [self.navigationController pushViewController:mainViewController animated:YES];

这是代码：

```
-(void) openABCPage
{
    UIStoryboard *mainStoryboard = self.storyboard;
    UIViewController *mainViewController = [mainStoryboard instantiateViewControllerWithIdentifier:@"pushnavViewController"];
    [self.navigationController pushViewController:mainViewController animated:YES];

} 
```

# javascript - 更有效的可折叠列表定位

> ID：11252734
> 
> 赞同：1
> 
> 时间：2012-06-28T20:54:43.030
> 
> 标签：javascript, jquery, slidetoggle, collapse

我试图弄清楚当我点击这些可折叠元素时，是否有办法使用 jquery 的 slideDown/slideUp/slideToggle 函数来制作动画。这是元素的 html 布局的片段：

```
<ul> 
                    <li class="category1"><a href="#"></a></li>
                        <ul>
                            <div class="tag1">
                                <li class="cat2"><a href="#">derp</a></li>
                                <li class="cat2"><a href="#">derp</a></li>
                                <li class="cat2"><a href="#">derp</a></li>
                            </div>

                        </ul>
                    <li class="category2"><a href="#"></a></li>
                        <ul>
                            <div class="tag2">
                                <li class="cat2"><a href="#">derp</a></li>
                                <li class="cat2"><a href="#">derp</a></li>
                                <li class="cat2"><a href="#">derp</a></li>
                            </div>  
                        </ul>
                    <li class="category3"><a href="#"></a></li>
                        <ul>
                            <div class="tag3">
                                <li class="cat2"><a href="#">derp</a></li>
                                <li class="cat2"><a href="#">derp</a></li>
                                <li class="cat2"><a href="#">derp</a></li>
                            </div>  
                        </ul>

</ul> 
```

这是我尝试过的javascript代码。它有效，但它很长。我想知道是否有更有效的方法来完成同样的事情。

```
$('.category1').click(function(){
    $('.tag1').slideToggle('200');
    $('.tag2').slideUp('200');
    $('.tag3').slideUp('200');
        return false;
});

$('.category2').click(function(){
    $('.tag1').slideUp('200');
    $('.tag2').slideToggle('200');
    $('.tag3').slideUp('200');
        return false;
});

$('.category3').click(function(){
    $('.tag1').slideUp('200');
    $('.tag2').slideUp('200');
    $('.tag3').slideToggle('200');
        return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:09:50.120

好吧，我很确定您的标记是无效的，因为只有`li`元素应该嵌套在`ul`元素中（如果我错了，请有人纠正我）。我将标记更改为：

```
<ul class="outer"> 
    <li>
        <a href="#"></a>
        <ul>
            <li class="cat1"><a href="#">derp</a></li>
            <li class="cat1"><a href="#">derp</a></li>
            <li class="cat1"><a href="#">derp</a></li>    
        </ul>
    </li>
    <li>
        <a href="#"></a>
        <ul>
            <li class="cat2"><a href="#">derp</a></li>
            <li class="cat2"><a href="#">derp</a></li>
            <li class="cat2"><a href="#">derp</a></li>    
        </ul>
    </li>
    <li>
        <a href="#"></a>
        <ul>
            <li class="cat3"><a href="#">derp</a></li>
            <li class="cat3"><a href="#">derp</a></li>
            <li class="cat4"><a href="#">derp</a></li>    
        </ul>
    </li>
</ul>​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

这是脚本：

```
$(".outer > li > a").on("click", function(event) {
    event.preventDefault();
    $(".outer ul").slideUp();   
    var next = $(this).next();
    if(next.is(":visible")) { return; }         
    next.slideDown();
});​ 
```

[这是工作示例](http://jsfiddle.net/uSBTv/4/)。

如您所见，我只是向上滑动*所有*`ul`部分，然后在单击的锚点之后向下滑动下一个部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:06:13.140

您需要稍微重组您的列表，您希望将孩子保留`<ul>`在父母中`<li>`

```
$('li[class^=category]').click(function(){
  var cls = $(this).attr('class');
  cls = cls.split('y');
  cls = cls[1];
  $('.tag'+cls).slideToggle('200');          
  $('div[class^=tag]').not("div[class=tag"+cls+"]").slideUp('200');
  return false;
}); 
```

# eclipse - 禁用 TeXlipse 自动构建，但继续构建项目的其余部分

> ID：11252736
> 
> 赞同：3
> 
> 时间：2012-06-28T20:54:55.657
> 
> 标签：eclipse, tex

我在同一个项目中有 Java 代码和 TeX 文档。我使用 TeXlipse（因为我喜欢编辑器的功能），但我不希望它在每次项目自动构建时都尝试构建我的 TeX 文档。原因是我的 TeX 文档树的配置很复杂，我使用 Makefiles 来编译那些文档，并且不想配置 TeXlipse 来为 bib 文件等找到所有正确的位置。同时，我想项目的其余部分（主要是 Java 代码）像往常一样自动构建。

是否可以阻止 TeXlipse 成为项目构建的一部分？目前，每次我保存 Java 文件时，都会出现一个讨厌的窗口“来自外部程序的问题”，其中会不断弹出一些 LaTeX 问题。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T20:59:20.020

哎呀——我刚刚找到了怎么做：项目>属性>生成器：禁用乳胶生成器。

# git - 告诉 git 将一组文件视为“一次性”

> ID：11252737
> 
> 赞同：0
> 
> 时间：2012-06-28T20:54:55.913
> 
> 标签：git

我在代码旁边有一个带有 sqlite 开发数据库的存储库。与应用程序的任何交互都倾向于更新数据库，因为这是存储会话的地方。经常在切换分支时，开发人员必须在切换之前重置或提交 sqlite 文件。

例如：

```
>git checked branch2
error: Your local changes to the following files would be overwritten by checkout:
    sqlite3.db
Please, commit your changes or stash them before you can switch branches.
Aborting

>git checkout sqlite3.db
>git checked branch2
Switched to branch 'branch2' 
```

这是一个小而烦人的问题。我希望能够告诉 git 在切换分支时简单地为我做这件事，假设这个单个文件是**唯一**改变的东西。

当然，当还有其他文件要提交时，我仍然希望能够签入对该文件的更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T11:20:51.177

使用以下命令查看您想要的分支`git checkout --force my_branch`：

```
-f, --force
       When switching branches, proceed even if the index or the working tree differs from HEAD. This is used to throw away local changes. 
```

这将删除这些文件中的任何更改，但如果您想在签出到不同的分支之前手动提交它们，您可以手动提交它们。

# c# - 应用程序全景不会移动我的控件

> ID：11252739
> 
> 赞同：0
> 
> 时间：2012-06-28T20:55:16.513
> 
> 标签：c#, windows-phone-7, windows-phone-7.1

我已经为 Windows Phone 创建了一个小应用程序 Panorama。我已经插入了几个控件。

当我运行我的应用程序时，当我在第二个全景项目上滑动时，程序继续执行第二个项目，但我的控件始终处于打开状态。

我认为我的控件没有“打开”我的第一个全景项目。

这是 y XAML 代码

`

```
<!--LayoutRoot est la grille racine où tout le contenu de la page est placé-->
<Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <!--Contrôle Panorama-->
    <controls:Panorama Title="Data arbitror" Background="{x:Null}" Margin="0,15,0,-15" Grid.ColumnSpan="2">
        <!--Élément un de panorama-->
        <controls:Panorama.TitleTemplate>
            <DataTemplate>
                <TextBlock Text="{Binding Content, RelativeSource={RelativeSource TemplatedParent}}" FontSize="85" Margin="0,50,0,0" />
            </DataTemplate>
        </controls:Panorama.TitleTemplate>

        <controls:PanoramaItem Header="Paramètres" HeaderTemplate="{StaticResource MyPanoramaHeaderTemplate}">

            <!--Liste double trait avec habillage du texte-->
        </controls:PanoramaItem>

        <!--Élément deux de panorama-->
        <!--Utilisez 'Orientation="Horizontal"' pour activer un panneau qui s'affiche horizontalement-->
        <controls:PanoramaItem Header="A propos" HeaderTemplate="{StaticResource MyPanoramaHeaderTemplate}">
            <!--Liste double trait avec espace réservé pour une image et habillage du texte-->
        </controls:PanoramaItem>
    </controls:Panorama>
    <TextBlock Height="43" HorizontalAlignment="Left" Margin="22,276,0,0" Name="textBlock1" Text="Désactiver les connexions de données entre" VerticalAlignment="Top" Width="401" Grid.ColumnSpan="2" FontFamily="{StaticResource PhoneFontFamilyNormal}" />

    <toolkit:TimePicker HorizontalAlignment="Left" Margin="46,325,0,0" Name="TimeBegin" VerticalAlignment="Top" />
    <toolkit:TimePicker HorizontalAlignment="Left" Margin="46,429,0,0" Name="TimeEnd" VerticalAlignment="Top" />
    <TextBlock Height="30" HorizontalAlignment="Left" Margin="90,396,0,0" Name="textBlock2" Text="et" VerticalAlignment="Top" />
    <TextBlock Height="43" HorizontalAlignment="Left" Margin="22,547,0,0" Name="textBlock3" Text="Désactiver les connexions de données après" VerticalAlignment="Top" Width="401" Grid.ColumnSpan="2" />
    <TextBox Height="72" HorizontalAlignment="Left" Margin="46,0,0,130" Name="textBoxMinutes" Text="1" VerticalAlignment="Bottom" Width="101" />
    <TextBlock Height="43" HorizontalAlignment="Left" Margin="155,615,0,0" Name="textBlock4" Text="minutes d'innactivitée" VerticalAlignment="Top" Width="401" Grid.ColumnSpan="2" />

    <toolkit:ToggleSwitch Margin="232,371,21,0" Header="Etat" Name="toggleSwitch1" VerticalAlignment="Top" Height="124" Width="227" SwitchForeground="#78BC27" />
    <toolkit:ToggleSwitch Height="124" Header="Etat" Margin="232,0,21,12" Name="toggleSwitch2" VerticalAlignment="Bottom" Width="227" SwitchForeground="#78BC27" />
</Grid> 
```

`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:04:07.130

查看您发布的架构，它显示底部的所有控件（TimePickers 和 TextBlocks）都在控件之外：Panorma 节点。将它们移动到该节点*内*，而不是当前包含它们和全景的网格内。您可能希望将它们一直移动到 PanoramaItem 节点内，具体取决于您要实现的目标。

# c++ - 链接器错误 LNK1109

> ID：11252740
> 
> 赞同：1
> 
> 时间：2012-06-28T20:55:18.780
> 
> 标签：c++, visual-c++, visual-studio-2005, linker-errors, tao

我尝试使用 Microsoft Visual Studio 2005 SP1 编译[ACE](http://download.dre.vanderbilt.edu/) 5.6.1 库。本项目包含 609 个子项目。并且每次我尝试全部重建它们时，有些不一样的东西不会编译并退出，并出现以下错误[LNK1109](http://msdn.microsoft.com/library/207183ye%28v=vs.80%29.aspx)。我敢肯定，在我的情况下，没有一个描述性的共振是匹配的。那么还能是什么呢？

作为一种解决方法，我只是按了“构建”，结果它看起来可以工作（现在将构建缺少的子项目）。所以我的另一个问题是，结果是否与一开始的成功重建相同？所以我可以确保没有文件损坏？为什么它现在起作用了？

我已经尝试减少并行构建的数量，无论我选择一个还是四个都没关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T08:33:09.880

我过去曾看到过由病毒检查程序持有打开的文件引起的类似问题。虽然我最近没有看到它可能值得检查？

# java - 如何为 Eclipse 启用代码推荐器？

> ID：11252741
> 
> 赞同：13
> 
> 时间：2012-06-28T20:55:30.773
> 
> 标签：java, eclipse, eclipse-plugin

我从首选项中单击“启用智能呼叫完成”，但仍然不推荐。还有什么需要做的吗？当我查看所有的罐子时，似乎没有任何推荐模型与任何罐子相关联，它显示所有的解决状态都未解决。我尝试使用几个不同的 SDK，1.6 和 1.7。是因为我在代理后面吗？接收 eclipse 的更新是可行的，所以我认为这不是问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-01T08:12:16.063

[尚不支持所有库](http://www.eclipse.org/recommenders/documentation/usr.html)。

> 在编写本节（1.0.0.rc2）时，Code Recommenders 部分支持 Java 标准库，即 java.* 下的主要包和 javax.* 下的一些包。由于推荐模型仅从 Eclipse Juno Release Train 代码库生成，因此不支持 java.awt 或 javax.swing 等包，因为在生成时没有可用数据。有关支持哪些库或包的详细列表，请查看 Code Recommenders 主页上的报告部分。

我还看到我所有的 Android 库、Apache commons、Google commons 等都没有得到解决。

除了解决问题之外，您肯定知道您可以使用 Ctrl-Space 多次循环浏览所有可用的建议，或者您可以在 Preferences -> Java -> Editor -> Content Assist -> Advanced 中重新排序建议列表（一旦您解决了你的库）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T07:32:05.900

您的 .metdata/.plugins/.org.eclipse.recommenders.rcp 文件夹是什么样的？您是否使用代理连接到互联网？

有一个可用的修复程序。见[http://www.eclipse.org/forums/index.php/t/366941/](http://www.eclipse.org/forums/index.php/t/366941/)有关详细信息，

# d3.js - 如何在 d3 中嵌套选择？

> ID：11252746
> 
> 赞同：0
> 
> 时间：2012-06-28T20:55:45.763
> 
> 标签：d3.js

我想画三个不同颜色的连续正方形（没问题，它在“比例”变量中）并在每个大颜色下面放置可变数量的小正方形（我不能这样做，“点”变量） . 我究竟做错了什么？这是我的代码，要点[https://gist.github.com/3013836](https://gist.github.com/3013836)：

```
var data = [-1,0,1]

var rect_size = 25; //px

var x = d3.scale.ordinal().domain(d3.range(data.length)).rangeBands([0, rect_size*data.length]);
var color = d3.scale.linear().domain([-1.5, 0, 1.5]).range(["#278DD6","#ffffff","#d62728"]).clamp(false);

var svg = d3.select("body").append("svg")
    .attr("width", 800)
    .attr("height", 200)

scale = svg.selectAll("rect")
    .data(data)
  .enter().append("rect")
    .attr("x", function(d,i) { return x(i); })
    .attr("y",0)
    .attr("width", rect_size)
    .attr("height", rect_size)
    .style("fill", function(d) { return color(d); });

dots = [[1,2,3],[1,2],[1,2,3,4]]
var y = d3.scale.ordinal().domain(d3.range(dots.length)).rangeBands([0, (rect_size/2)*dots.length]);
scale.selectAll("g")
    .data(dots, function(d){return d;})
  .enter().append("rect")
    .attr("x", function(d,i) {return x(i);})
    .attr("y", function(d,i) {return y(i);})
    .attr("width", rect_size/2)
    .attr("height", rect_size/2)
    .style("fill", "black"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:19:43.143

您已将选择定义`scale`为三个矩形元素。然后，您在其中的每一个中添加了另外三个 rect 元素。如果您使用浏览器的元素检查器，生成的结构将如下所示：

```
<rect class="outer">
  <rect class="inner"></rect>
  <rect class="inner"></rect>
  <rect class="inner"></rect>
</rect> 
```

这只显示三个矩形，因为矩形不是SVG 中的[容器元素](http://www.w3.org/TR/SVG/intro.html#TermContainerElement)；内部矩形被忽略。

如果要对元素进行分组，则需要一个[g（组）元素](http://www.w3.org/TR/SVG/struct.html#Groups)。你想要这样的结构：

```
<g>
  <rect class="outer"></rect>
  <rect class="inner"></rect>
  <rect class="inner"></rect>
  <rect class="inner"></rect>
</g> 
```

您可以通过首先使用[data-join](http://bost.ocks.org/mike/join/)创建一组 g 元素来做到这一点。然后将单个外部矩形[附加到 g 元素。](https://github.com/mbostock/d3/wiki/Selections#wiki-append)最后使用[嵌套连接](http://bost.ocks.org/mike/nest/)来创建内部矩形。就像是：

```
var g = svg.selectAll("g")
    .data(outerData)
  .enter().append("g");

var outerRect = g.append("rect")
    .attr("class", "outer");

var innerRect = g.selectAll(".inner")
    .data(innerData)
  .enter().append("rect")
    .attr("class", "inner"); 
```

其他几件事：

*   您可以对 g 元素使用变换，这样您就不必分别定位外部和内部矩形。这样，内部矩形可以相对于外部矩形定位，并且代码更简单。

*   您的最后一次连接被破坏，因为您选择“g”并附加“rect”；您附加的任何内容都应与您的选择器匹配。

*   除非您还处理更新和退出，否则您通常不需要数据连接的[关键功能。](http://bost.ocks.org/mike/constancy/#key-functions)由于您只在联接中处理输入，并且您知道选择为空，因此不需要 key 功能。

# mysql - 如何在多个循环下连接来自不同行的因子

> ID：11252750
> 
> 赞同：0
> 
> 时间：2012-06-28T20:56:11.027
> 
> 标签：mysql, loops, join

我正在尝试获取一个包含列（品牌、名称、id、时间、价格）的表，并将之前的价格添加到同一行中，因此新列（品牌、名称、id、时间、价格，上一个价格）。在这个价格和 prev_price 都是整数。

我遇到的挑战是我正在使用的数据库中每个都有许多不同的变量。例如：品牌 A、B、C、D 名称：1 - 100（品牌各不相同） id：80 - 300（品牌也各不相同）

品牌和名称保持不变的示例表以及我希望 prev_price 因子包含的内容

```
品牌名称 id 时间 价格 prev_price
A 25 80 1 103 空
25 80 2 105 103
A 25 81 1 24 空
25 81 2 24 0
25 81 3 14 -10

```

任何人都可以帮助推荐如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:11:15.123

我认为您需要首先确定`time`每个`(brand,name,id)`三元组的前一个，然后在该时间进行自加入以提取`prev_time`：

```
SELECT mytable.*, prev.price AS prev_price
FROM   mytable
  LEFT JOIN (
    SELECT   mytable.*, MAX(t2.time) AS prev_time
    FROM     mytable LEFT JOIN mytable AS prev ON
             prev.brand = mytable.brand
         AND prev.name  = mytable.name
         AND prev.id    = mytable.id
         AND prev.time  < mytable.time
    GROUP BY mytable.brand, mytable.name, mytable.id, mytable.time
  ) AS pairs USING (brand, name, id, time)
  LEFT JOIN mytable AS prev ON
        prev.brand = pairs.brand
    AND prev.name  = pairs.name
    AND prev.id    = pairs.id
    AND prev.time  = pairs.prev_time 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T00:34:37.310

在这种情况下，试试这个：

```
Select mytable.*, x.price AS prev_price
FROM mytable LEFT JOIN
    (SELECT * FROM mytable) AS x ON
    mytable.id = x.id
    AND mytable.brand = x.brand
    AND mytable.name = x.name
    AND mytable.time = x.time + 1 
```

# text - 在 d3 中旋转 x 轴文本

> ID：11252753
> 
> 赞同：83
> 
> 时间：2012-06-28T20:56:17.237
> 
> 标签：text, svg, transform, d3.js

我是 d3 和 svg 编码的新手，正在寻找一种在图表的 xAxis 上旋转文本的方法。我的问题是 xAxis 标题通常比条形图中的条长宽。所以我希望旋转文本以在 xAxis 下方垂直（而不是水平）运行。

我试过添加变换属性： .attr("transform", "rotate(180)")

但是当我这样做时，文本完全消失了。我尝试增加 svg 画布的高度，但仍然无法查看文本。

任何关于我做错了什么的想法都会很棒。我还需要调整 x 和 y 位置吗？而且，如果是这样，多少（当我在 Firebug 中看到它时很难排除故障）。

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2012-06-29T06:30:11.047

如果您设置旋转（180）的变换，它会**相对于原点**旋转元素，而不是相对于文本锚点。因此，如果您的文本元素还设置了*x*和*y*属性来定位它们，则很可能您已将文本旋转到屏幕外。例如，如果您尝试过，

```
<text x="200" y="100" transform="rotate(180)">Hello!</text> 
```

文本锚点将位于⟨-200,100⟩。如果你想让文本锚点停留在⟨200,100⟩，那么你可以在旋转之前使用变换来定位文本，从而改变原点。

```
<text transform="translate(200,100)rotate(180)">Hello!</text> 
```

另一种选择是使用可选的*cx*和*cy*参数来进行 SVG 的[旋转变换](http://www.w3.org/TR/SVG/coords.html#TransformAttribute)，这样您就可以指定旋转的原点。这最终有点多余，但为了完整起见，它看起来像这样：

```
<text x="200" y="100" transform="rotate(180,200,100)">Hello World!</text> 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-05-31T18:26:42.950

无耻[地从别处](http://www.d3noob.org/2013/01/how-to-rotate-text-labels-for-x-axis-of.html)采摘，全归功于作者。

包含的边距仅用于显示底部边距，应增加。

```
var margin = {top: 30, right: 40, bottom: 50, left: 50},

svg.append("g")
   .attr("class", "x axis")
   .attr("transform", "translate(0," + height + ")")
   .call(xAxis)
     .selectAll("text")  
     .style("text-anchor", "end")
     .attr("dx", "-.8em")
     .attr("dy", ".15em")
     .attr("transform", "rotate(-65)"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-17T06:43:18.457

这种旋转 D3 轴标签的一个问题是，每次渲染轴时都必须重新应用此逻辑。这是因为您无权访问轴用于呈现刻度和标签的输入-更新-退出选择。

d3fc 是一个组件库，它具有[装饰模式](https://d3fc.io/introduction/decorate-pattern.html)，允许您访问组件使用的底层数据连接。

它有一个 D3 轴的替代品，其中轴标签旋转按如下方式执行：

```
var axis = fc.axisBottom()
  .scale(scaleBand)
  .decorate(function(s) {
    s.enter()
        .select('text')
        .style('text-anchor', 'start')
        .attr('transform', 'rotate(45 -10 10)');
  }); 
```

请注意，旋转仅应用于输入选择。

[![在此处输入图像描述](../Images/94a1b565c77aa42c7bd2d2ff37c179a9.png)](https://i.stack.imgur.com/6Oc2n.png)

[您可以在轴文档页面](https://d3fc.io/components/svg/axis.html)上看到此模式的其他一些可能用途。

# php - 为什么通过 php 代理调用此 API 时不再起作用？我该如何解决？

> ID：11252757
> 
> 赞同：3
> 
> 时间：2012-06-28T20:56:37.377
> 
> 标签：php, ajax, json, proxy, sencha-touch-2

这是 API：[http ://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=true](http://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=true)

如果你去 url 你可以看到 JSON 对象

我从这里找到了一个简单 PHP 代理的源代码：[http ://www.daniweb.com/web-development/php/code/216729/php-proxy-solution-for-cross-domain-ajax-scripting](http://www.daniweb.com/web-development/php/code/216729/php-proxy-solution-for-cross-domain-ajax-scripting)

我可以使用代理访问网站，但是当我通过代理调用 API 时，出现错误。有谁知道为什么会这样，以及如何解决？

调用某些其他站点也会发生此错误。只是以谷歌为例。

`(www.mydomain.com/proxy.php?proxy_url=http://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway,+Mountain+View,+CA&sensor=true)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:15:55.160

我想出了如何解决它。在将其附加到代理之前，我需要在 url 上调用 encodeURIComponent。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:26:43.893

该[代理类](http://www.troywolf.com/articles/php/class_http/proxy.phps)使用同一作者的[http 类](http://www.troywolf.com/articles/php/class_http/)。其文档规定用户（您）负责对请求的 IURL进行[urlencoding 。](http://php.net/manual/en/function.urlencode.php)

# ios - 什么会导致 iPad（第 3 代）在启动时崩溃但在模拟器中工作？

> ID：11252759
> 
> 赞同：1
> 
> 时间：2012-06-28T20:57:06.477
> 
> 标签：ios, ipad-3

我收到了来自 Apple 的拒绝消息。

> 我们发现该应用在 iPad（第 3 代）上启动时退出

我已经在第一代和第二代 iPad 上测试了我的 iPhone 应用程序，没有任何问题，并使用视网膜模式下的模拟器来测试第三代 iPad。Apple 没有向我提供崩溃日志，所以在我去另一台测试设备上花更多钱之前，这是我的问题。

是否有要检查的项目列表，这些项目已知会导致设备崩溃但在模拟器中工作？视网膜分辨率下的@2x 图形会不会是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:09:04.837

真实设备和模拟器之间的一些不同之处：

1.  设备上的内存更少；iPad 3 将使用@2x 图像，因此与 iPad 1/2 相比，它将使用双倍的图像内存；

2.  设备速度较慢（OpenGL 和其他经过优化的图形任务除外）：在启动时，应用程序最多有 5 秒的时间来完成`applicationDidFinishLaunching`，否则将被杀死；

3.  设备文件系统区分大小写：如果您使用不区分大小写的名称引用资源，设备会报错。

当然还有更多。此外，模拟器和设备之间存在普遍差异，因此您不能完全信任模拟器，但我知道这对您没有帮助。

希望能帮助到你。

# .net - 休眠标准分页

> ID：11252764
> 
> 赞同：0
> 
> 时间：2012-06-28T20:57:20.077
> 
> 标签：.net, nhibernate, pagination, nhibernate-criteria

我需要的是在类列表中添加“分页”。乙：

```
A级
  清单 B

```

所以我需要将 B 的列表限制为某个值

我正在做的是（使用标准，而且都是动态的）：

```
ICriteria 标准 = Session.createCriteria();

ICriteria criteriaParcial = criteria.CreateCriteria("B");

criteriaParcial.SetFirstResult(0).SetMaxResults(10);

标准列表（）；

```

这是一个例子，真正的代码都是动态的和迭代的。

此机制可用于查找过滤值，但不适用于分页。

任何想法？坦克

**更新！！！**

此方法不起作用，因为此方法执行`criteria.CreateCriteria("B").setMAxResults(10)`修改为根标准而不是我想的 subCriteria。

所以我现在的建议是。可以限制或分页，类内的列表？

像这样：我有一个带有地址列表的 Person 类，所以我想加载一个 Person，但只有地址列表中的两个第一个对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T15:20:41.613

这是不可能的AFAIK。但无论哪种方式，这种方法都是错误的。最好加载根实体数据，并在另一个查询中加载子列表，这样您就可以根据需要进行分页过滤和排序。

列表属性不是为了显示得好，它们只是包含对象列表以及它们的作用。这就是为什么创建另一个仅返回这些项目的查询是最佳方法的原因。

您可以使用 Future<> 查询来提高数据库性能。

# .htaccess - 将 MyBB 页面重定向到 vBulletin

> ID：11252767
> 
> 赞同：2
> 
> 时间：2012-06-28T20:57:26.433
> 
> 标签：.htaccess, vbulletin, mybb

我最近购买了一个由 MyBB 提供支持的非常小的论坛，并将数据与我更大的 vBulletin 论坛合并。

正常的重定向将不起作用，因为 vBulletin 板是一个长期建立的板，而在另一个域上，MyBB 板上的线程 2 现在是 vBulletin 站点上的线程 546。

在 htaccess 中是否有可能将 mybbsite.com/forum/showthread.php?tid=2 重定向到 vbsite.com/forum/showthread.php?t=546

就像我说的，MyBB 板非常小，只有 50 个线程，所以如果不能做到这一点也不是什么大问题。

亲切的问候

——马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T03:49:57.483

您可以使用 mod_rewrite 匹配查询字符串。您可以在 .htaccess 文件中添加类似的内容：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} mybbsite.com$ [NC]
RewriteCond %{QUERY_STRING} ^tid=2$
RewriteRule ^forum/showthread.php$ http://vbsite.com/forum/showthread.php?t=546 [L,R=301] 
```

您可以为 50 个左右的线程复制这 2 个条件和重写规则。

# javascript - 如何访问类实例上的事件侦听器？

> ID：11252771
> 
> 赞同：0
> 
> 时间：2012-06-28T20:57:41.047
> 
> 标签：javascript

寻求创建一个事件处理程序，该处理程序注册一个回调并根据事件进行迭代。

一个早期的工作示例是这样的：

```
var elt = document.getElementById("square"),
      clickCount = 0;

  // call a priviledged method with access to prviate vars from 
  // outer scope
  var count = function () {
    clickCount += 1;
    alert("you clicked me " + clickCount + " times!");
  };

  elt.addEventListener("click", count, false); 
```

现在我想真正写一些我可以使用的js。这是目前的建设：

```
//Create a class object
function CountMe () {

 //privately scoped variables
  var clickCount = 0;

 //methods on 'class' CountMe
  this.countClick = function () {
    //who's context am I in?
    this.addCount();
    alert("you clicked me " + clickCount + " times!");
  };

  this.addCount = function() {
    clickCount += 1 
  };
};

// Create an instance of countMe class
var clickMe = new CountMe();

//Add an event listener for clicks 
document.getElementById("square").addEventListener("click", clickMe.countClick ,false) 
```

我收到的错误是`Uncaught TypeError: Object #<CountMe> has no method 'addEventListener'` 给定一个这样的 html 页面：

```
<html>
<body>
 <div style="width:50px; height:50px; background-color:red;" id="square">
 </div>
</body>
</html> 
```

我的问题是：

*   应该如何构造它以使`onclick`事件像在第一种方法中一样起作用？
*   在方法`countClick`中嵌套 this 的上下文是什么？我怀疑的类的实例`CountMe`，只是想要别人的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:07:48.910

> 应该如何构造它以便 onclick 事件像在第一种方法中一样起作用？
> 
> 未捕获的类型错误：对象 # 没有方法“addEventListener”

这显然是原因。您需要将事件侦听器添加到 DOM 元素，因此您可以执行以下操作：

```
var clickMe = new CountMe();
document.getElementById("square").addEventListener("click", clickMe.countClick, false); 
```

正如正确注释的那样，该变量`elt`是私有范围的，不能从外部访问。这意味着您应该将添加过程移动到构造函数中（如果元素是可确定的），或者完全删除它。

> 在方法 countClick 中嵌套 this 的上下文是什么？我怀疑的 CountMe 类的实例，只是想要别人的。

这取决于调用。使用您的代码

```
clickMe.countClick(); 
```

实例`clickMe`将是上下文，但是当函数作为事件侦听器调用时，DOM 元素将是上下文。请参阅 MDN 的[`this`关键字](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)概述。您可以使用闭包范围的变量来保存对实际实例的引用，例如[此处](https://stackoverflow.com/questions/1081499/accessing-an-objects-property-from-an-event-listener-call-in-javascript?lq=1)描述的示例（对此有很多问题）。

三种可能的快速修复：

*   `domel.addEventListener("click", clickMe.countClick.bind(clickMe), false)`
*   `domel.addEventListner("click", function(){clickMe.countClick();}, false)`
*   `var that=this; this.countClick=function(){ that.addCount(); alert(); };`

# regex - 一个简单的正则表达式

> ID：11252775
> 
> 赞同：0
> 
> 时间：2012-06-28T20:57:55.227
> 
> 标签：regex

我不熟悉正则表达式。

对于一个字符串，我想把所有非字母和非数字的字符都换成空格，然后合并空格，这样就没有两个连续的空格了。

如何使用正则表达式来实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:59:40.353

您将需要 2 张通行证

代替

```
[^a-zA-Z0-9] 
```

有 1 个空格

代替

```
[ ]{2,} 
```

有 1 个空格

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:00:13.693

使用两个替换：

1.  `[^a-zA-Z0-9]`用空格代替
2.  `[ ]{2,}`用一个空格替换（这里只需要字符类，因为 SO 的解析器搞砸了——通常一个空格就足够了）

在 PowerShell 中看起来像

```
$s -replace '[^a-zA-Z0-9]', ' ' -replace ' {2,}', ' ' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T20:59:33.333

听起来你需要一个

```
replace(mystring, "[^a-zA-Z0-9]+", " "); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:29:36.663

不确定是否使用单个正则表达式执行此操作，但两个似乎可以解决问题

```
 echo -n 'dog*&$\@$ cat   On1 tw0' |
     perl -pe 's/([^([:alnum:])]|\s)/ /g' |
         perl -pe 's/\s+/ /g' 
```

**输出**=`dog cat On1 tw0`

# iphone - iPhone 的 144x144 应用程序图标的名称是什么？

> ID：11252779
> 
> 赞同：0
> 
> 时间：2012-06-28T20:58:21.613
> 
> 标签：iphone, ipad, retina-display

我正在制作一款 iPhone 游戏。除了用于 Retina iPad 的应用程序大小外，我拥有所有必需的应用程序大小。我认为图标的大小需要为 144x144。但是不知道取什么名字！

我尝试了 Icon-144.png（类似于 Icon-72.png），但是当我在 Retina iPad 上运行我的应用程序时，它似乎使用 Default.png 图像作为图标。很诡异！

谁能告诉我 144x144 的图标名称需要是什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:00:57.977

如果：

```
Icon@2x.png 
```

不是您要查找的名称，请尝试在 MacRumors 上查看此线程，了解[为新的视网膜 iPad 更新图形](http://forums.macrumors.com/showthread.php?t=1335403)。

我建议尝试：

```
Icon-72@2x.png 
```

以下是高分辨率图标名称查找的语法：

```
<ImageName>@2x<device_modifier>.<filename_extension> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:02:12.043

您应该将其命名为 Icon@2x.png。[来源](https://developer.apple.com/library/ios/#qa/qa1686/_index.html#//apple_ref/doc/uid/DTS40009882)

你也可以试试“Icon-iPad@2x.png”。[来源](http://developer.anscamobile.com/forum/2012/03/17/hi-res-app-icons-ipad-3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T11:14:10.117

对于 144X144 ipad 视网膜，它应该是 Icon-72@2x.png。非常糟糕的文档苹果 ios 总是缺少一些东西和令人困惑的概念。应该在文档中提到名称

# scope - AngularJS中控制器之间通信的正确方法是什么？

> ID：11252780
> 
> 赞同：474
> 
> 时间：2012-06-28T20:58:29.690
> 
> 标签：scope, angularjs

控制器之间通信的正确方法是什么？

我目前正在使用一种可怕的软糖，涉及`window`：

```
function StockSubgroupCtrl($scope, $http) {
    $scope.subgroups = [];
    $scope.handleSubgroupsLoaded = function(data, status) {
        $scope.subgroups = data;
    }
    $scope.fetch = function(prod_grp) {
        $http.get('/api/stock/groups/' + prod_grp + '/subgroups/').success($scope.handleSubgroupsLoaded);
    }
    window.fetchStockSubgroups = $scope.fetch;
}

function StockGroupCtrl($scope, $http) {
    ...
    $scope.select = function(prod_grp) {
        $scope.selectedGroup = prod_grp;
        window.fetchStockSubgroups(prod_grp);
    }
} 
```

* * *

## 回答 #1

> 赞同：460
> 
> 时间：2013-10-21T15:00:52.473

**编辑**：此答案中解决的问题已在 angular.js[版本 1.2.7](https://github.com/angular/angular.js/blob/master/CHANGELOG.md#performance-improvements-44)中得到解决。`$broadcast`现在避免在未注册的范围上冒泡，并且运行速度与 $emit 一样快。 ![$broadcast 性能与 angular 1.2.16 的 $emit 相同](../Images/01d5bb991f1cbd7de4404f8811f65a86.png)

**所以，现在你可以：**

*   `$broadcast`从使用`$rootScope`
*   从需要了解事件`$on` **的当地人`$scope`**那里收听

* * *

**原答案如下**

我强烈建议不要使用`$rootScope.$broadcast`+`$scope.$on`而是使用`$rootScope.$emit`+ `$rootScope.$on`。前者可能会导致@numan 提出的严重性能问题。那是因为事件将在**所有**范围内冒泡。

但是，后者（使用`$rootScope.$emit`+ `$rootScope.$on`）**不受**此影响，因此可以用作快速通信通道！

从角度文档`$emit`：

> 通过范围层次结构向上调度事件名称，通知已注册的

由于没有上述范围`$rootScope`，因此不会发生冒泡。`$rootScope.$emit()`将/`$rootScope.$on()`用作 EventBus是完全安全的。

但是，在 Controller 中使用它时有一个问题。如果您直接从控制器中绑定到，则当您的本地被破坏`$rootScope.$on()`时，您必须自己清理绑定。`$scope`这是因为控制器（与服务相比）可以在应用程序的生命周期内多次实例化，这将导致绑定总结最终在整个地方造成内存泄漏:)

要取消注册，只需监听您`$scope`的`$destroy`事件，然后调用返回的函数`$rootScope.$on`。

```
angular
    .module('MyApp')
    .controller('MyController', ['$scope', '$rootScope', function MyController($scope, $rootScope) {

            var unbind = $rootScope.$on('someComponent.someCrazyEvent', function(){
                console.log('foo');
            });

            $scope.$on('$destroy', unbind);
        }
    ]); 
```

我想说，这并不是一个真正的角度特定的事情，因为它也适用于其他 EventBus 实现，你必须清理资源。

但是，对于这些情况，您*可以*让您的生活更轻松。例如，您可以猴子补丁`$rootScope`并给它一个`$onRootScope`订阅在 上发出的事件，但也可以在本地被破坏`$rootScope`时直接清理处理程序。`$scope`

猴子补丁`$rootScope`提供这种`$onRootScope`方法的最干净的方法是通过装饰器（运行块可能也可以做到这一点，但是pssst，不要告诉任何人）

为了确保`$onRootScope`在枚举时属性不会出现意外，`$scope`我们使用`Object.defineProperty()`并设置`enumerable`为`false`. 请记住，您可能需要 ES5 垫片。

```
angular
    .module('MyApp')
    .config(['$provide', function($provide){
        $provide.decorator('$rootScope', ['$delegate', function($delegate){

            Object.defineProperty($delegate.constructor.prototype, '$onRootScope', {
                value: function(name, listener){
                    var unsubscribe = $delegate.$on(name, listener);
                    this.$on('$destroy', unsubscribe);

                    return unsubscribe;
                },
                enumerable: false
            });

            return $delegate;
        }]);
    }]); 
```

使用这种方法，上面的控制器代码可以简化为：

```
angular
    .module('MyApp')
    .controller('MyController', ['$scope', function MyController($scope) {

            $scope.$onRootScope('someComponent.someCrazyEvent', function(){
                console.log('foo');
            });
        }
    ]); 
```

因此，作为所有这一切的最终结果，我强烈建议您使用`$rootScope.$emit`+ `$scope.$onRootScope`。

顺便说一句，我正试图说服 Angular 团队解决 Angular 核心中的问题。这里正在进行讨论：[https ://github.com/angular/angular.js/issues/4574](https://github.com/angular/angular.js/issues/4574)

这是一个 jsperf，它显示了`$broadcast`在只有 100 个的体面场景中性能影响有多大`$scope`。

[http://jsperf.com/rootscope-emit-vs-rootscope-broadcast](http://jsperf.com/rootscope-emit-vs-rootscope-broadcast)

![jsperf 结果](../Images/8bb029cc336aba0bb5eebcb7ec0ea5de.png)

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2014-09-26T13:15:14.607

正如@zumalifeguard 提到的那样，这里的[最佳答案](https://stackoverflow.com/a/19498009/2036135)是解决不再存在的Angular问题（至少在版本> 1.2.16和“可能更早”中）。但是我在没有实际解决方案的情况下阅读所有这些答案。

在我看来，现在的答案应该是

*   `$broadcast`从使用`$rootScope`
*   从需要了解事件`$on` **的当地人`$scope`**那里收听

所以要发布

```
// EXAMPLE PUBLISHER
angular.module('test').controller('CtrlPublish', ['$rootScope', '$scope',
function ($rootScope, $scope) {

  $rootScope.$broadcast('topic', 'message');

}]); 
```

并订阅

```
// EXAMPLE SUBSCRIBER
angular.module('test').controller('ctrlSubscribe', ['$scope',
function ($scope) {

  $scope.$on('topic', function (event, arg) { 
    $scope.receiver = 'got your ' + arg;
  });

}]); 
```

冲锋衣

*   [常规 $scope 语法](http://plnkr.co/edit/WokHeUdyYbrXFoQxMqtx?p=preview)（如上所示）
*   [新`Controller As`语法](http://plnkr.co/edit/PgPBf5UjYOBBYxThNa7j?p=preview)

如果在 local 上注册监听器，当关联的控制器被移除时，[它](https://stackoverflow.com/questions/22169888/angular-js-destroy-event-should-i-manually-unbind)`$scope`会[自动销毁。`$destroy`](https://stackoverflow.com/questions/22169888/angular-js-destroy-event-should-i-manually-unbind)

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2012-06-28T21:17:14.973

使用[$rootScope.$broadcast](http://docs.angularjs.org/api/ng.$rootScope.Scope#$broadcast)和 $scope.$on 进行 PubSub 通信。

另外，请参阅这篇文章：[AngularJS – 在控制器之间进行通信](http://onehungrymind.com/angularjs-communicating-between-controllers/)

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2014-02-17T03:30:50.007

由于defineProperty存在浏览器兼容性问题，我认为我们可以考虑使用服务。

```
angular.module('myservice', [], function($provide) {
    $provide.factory('msgBus', ['$rootScope', function($rootScope) {
        var msgBus = {};
        msgBus.emitMsg = function(msg) {
        $rootScope.$emit(msg);
        };
        msgBus.onMsg = function(msg, scope, func) {
            var unbind = $rootScope.$on(msg, func);
            scope.$on('$destroy', unbind);
        };
        return msgBus;
    }]);
}); 
```

并像这样在控制器中使用它：

*   控制器 1

    ```
    function($scope, msgBus) {
        $scope.sendmsg = function() {
            msgBus.emitMsg('somemsg')
        }
    } 
    ```

*   控制器 2

    ```
    function($scope, msgBus) {
        msgBus.onMsg('somemsg', $scope, function() {
            // your logic
        });
    } 
    ```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-07-10T20:47:26.397

[GridLinked](http://www.gridlinked.info)发布了一个[PubSub](http://jsfiddle.net/ThomasBurleson/sv7D5/)解决方案，该解决方案似乎设计得很好。可以在[此处](http://www.gridlinked.info/angularJS/modules/MessagingServices.js)找到该服务。

还有他们的服务图：

![消息服务](../Images/13dba4540f5c14836ba260d16a2a8394.png)

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-08-18T04:30:08.183

实际上使用发射和广播是低效的，因为事件在范围层次结构中上下冒泡，这很容易降低复杂应用程序的性能瓶颈。

我建议使用服务。这是我最近在我的一个项目中实现它的方式 - [https://gist.github.com/3384419](https://gist.github.com/3384419)。

基本思想 - 将 pubsub/event bus 注册为服务。然后在您需要订阅或发布事件/主题的任何地方注入该事件总线。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2014-10-14T15:10:40.583

在服务中使用 get 和 set 方法，您可以非常轻松地在控制器之间传递消息。

```
var myApp = angular.module("myApp",[]);

myApp.factory('myFactoryService',function(){

    var data="";

    return{
        setData:function(str){
            data = str;
        },

        getData:function(){
            return data;
        }
    }

})

myApp.controller('FirstController',function($scope,myFactoryService){
    myFactoryService.setData("Im am set in first controller");
});

myApp.controller('SecondController',function($scope,myFactoryService){
    $scope.rslt = myFactoryService.getData();
}); 
```

在 HTML HTML 中，您可以像这样检查

```
<div ng-controller='FirstController'>  
</div>

<div ng-controller='SecondController'>
    {{rslt}}
</div> 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-05-11T07:08:08.030

关于原始代码 - 您似乎希望在范围之间共享数据。要在 $scope 之间共享数据或状态，文档建议使用服务：

*   要运行跨控制器共享的无状态或有状态代码——请改用 Angular 服务。
*   实例化或管理其他组件的生命周期（例如，创建服务实例）。

[参考：Angular Docs 链接在这里](https://docs.angularjs.org/guide/controller)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-05-07T22:55:31.157

我实际上已经开始使用 Postal.js 作为控制器之间的消息总线。

作为消息总线，它有很多好处，例如 AMQP 样式绑定、postal 可以集成 w/iFrames 和 Web 套接字的方式，等等。

我使用了一个装饰器来设置 Postal `$scope.$bus`...

```
angular.module('MyApp')  
.config(function ($provide) {
    $provide.decorator('$rootScope', ['$delegate', function ($delegate) {
        Object.defineProperty($delegate.constructor.prototype, '$bus', {
            get: function() {
                var self = this;

                return {
                    subscribe: function() {
                        var sub = postal.subscribe.apply(postal, arguments);

                        self.$on('$destroy',
                        function() {
                            sub.unsubscribe();
                        });
                    },
                    channel: postal.channel,
                    publish: postal.publish
                };
            },
            enumerable: false
        });

        return $delegate;
    }]);
}); 
```

这是有关该主题的博客文章的链接...
[http://jonathancreamer.com/an-angular-event-bus-with-postal-js/](http://jonathancreamer.com/an-angular-event-bus-with-postal-js/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-07-31T09:37:44.743

这就是我使用[Factory / Services](https://docs.angularjs.org/guide/services)和简单[依赖注入 (DI)](https://docs.angularjs.org/guide/di)的方式。

```
myApp = angular.module('myApp', [])

# PeopleService holds the "data".
angular.module('myApp').factory 'PeopleService', ()->
  [
    {name: "Jack"}
  ]

# Controller where PeopleService is injected
angular.module('myApp').controller 'PersonFormCtrl', ['$scope','PeopleService', ($scope, PeopleService)->
  $scope.people = PeopleService
  $scope.person = {} 

  $scope.add = (person)->
    # Simply push some data to service
    PeopleService.push angular.copy(person)
]

# ... and again consume it in another controller somewhere...
angular.module('myApp').controller 'PeopleListCtrl', ['$scope','PeopleService', ($scope, PeopleService)->
  $scope.people = PeopleService
] 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-10-04T08:59:19.083

我喜欢如何`$rootscope.emit`用于实现互通的方式。我建议在不污染全局空间的情况下清洁且性能有效的解决方案。

```
module.factory("eventBus",function (){
    var obj = {};
    obj.handlers = {};
    obj.registerEvent = function (eventName,handler){
        if(typeof this.handlers[eventName] == 'undefined'){
        this.handlers[eventName] = [];  
    }       
    this.handlers[eventName].push(handler);
    }
    obj.fireEvent = function (eventName,objData){
       if(this.handlers[eventName]){
           for(var i=0;i<this.handlers[eventName].length;i++){
                this.handlers[eventName][i](objData);
           }

       }
    }
    return obj;
})

//Usage:

//In controller 1 write:
eventBus.registerEvent('fakeEvent',handler)
function handler(data){
      alert(data);
}

//In controller 2 write:
eventBus.fireEvent('fakeEvent','fakeData'); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-07-30T19:51:35.570

这是快速而肮脏的方法。

```
// Add $injector as a parameter for your controller

function myAngularController($scope,$injector){

    $scope.sendorders = function(){

       // now you can use $injector to get the 
       // handle of $rootScope and broadcast to all

       $injector.get('$rootScope').$broadcast('sinkallships');

    };

} 
```

这是在任何兄弟控制器中添加的示例函数：

```
$scope.$on('sinkallships', function() {

    alert('Sink that ship!');                       

}); 
```

当然这是你的 HTML：

```
<button ngclick="sendorders()">Sink Enemy Ships</button> 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-24T10:15:57.513

从 Angular 1.5 开始，它是基于组件的开发重点。组件交互的推荐方式是使用“require”属性和属性绑定（输入/输出）。

一个组件需要另一个组件（例如根组件）并获得对其控制器的引用：

```
angular.module('app').component('book', {
    bindings: {},
    require: {api: '^app'},
    template: 'Product page of the book: ES6 - The Essentials',
    controller: controller
}); 
```

然后，您可以在子组件中使用根组件的方法：

```
$ctrl.api.addWatchedBook('ES6 - The Essentials'); 
```

这是根组件控制器功能：

```
function addWatchedBook(bookName){

  booksWatched.push(bookName);

} 
```

这是一个完整的架构概述：[组件通信](https://github.com/kevinvanhove/angular-structure-styleguide/blob/master/README.md#component_communications)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-03-18T09:56:54.803

您可以在模块中的任何位置访问此 hello 函数

控制器一

```
 $scope.save = function() {
    $scope.hello();
  } 
```

第二控制器

```
 $rootScope.hello = function() {
    console.log('hello');
  } 
```

[更多信息在这里](http://angulartutorial.blogspot.in/2014/03/communicate-with-controllers-in-angular.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-06-06T10:41:23.460

我将创建一个服务并使用通知。

1.  在通知服务中创建一个方法
2.  在 Notification Service 中创建一个用于广播通知的通用方法。
3.  从源控制器调用 notificationService.Method。如果需要，我还会传递相应的对象以持久化。
4.  在该方法中，我将数据保存在通知服务中并调用通用通知方法。
5.  在目标控制器中，我侦听 ($scope.on) 广播事件并从通知服务访问数据。

在任何时候通知服务都是单例的，它应该能够提供持久的数据。

希望这可以帮助

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-12-28T22:00:08.230

您应该使用 Service ，因为`$rootscope`是从整个 Application 访问，它会增加负载，或者如果您的数据不多，您可以使用 rootparams。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-12-30T09:19:28.863

您可以使用 AngularJS 内置服务`$rootScope`并将此服务注入您的两个控制器中。然后，您可以侦听在 $rootScope 对象上触发的事件。

$rootScope 提供了两个事件调度`$emit and $broadcast`器，分别负责调度事件（可能是自定义事件）和使用`$rootScope.$on`函数添加事件监听器。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-03-12T07:23:35.630

```
function mySrvc() {
  var callback = function() {

  }
  return {
    onSaveClick: function(fn) {
      callback = fn;
    },
    fireSaveClick: function(data) {
      callback(data);
    }
  }
}

function controllerA($scope, mySrvc) {
  mySrvc.onSaveClick(function(data) {
    console.log(data)
  })
}

function controllerB($scope, mySrvc) {
  mySrvc.fireSaveClick(data);
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-05-25T13:16:41.067

您可以通过使用 $emit 和 $broadcast 的角度事件来做到这一点。据我们所知，这是最好、最有效和最有效的方法。

首先，我们从一个控制器调用一个函数。

```
var myApp = angular.module('sample', []);
myApp.controller('firstCtrl', function($scope) {
    $scope.sum = function() {
        $scope.$emit('sumTwoNumber', [1, 2]);
    };
});
myApp.controller('secondCtrl', function($scope) {
    $scope.$on('sumTwoNumber', function(e, data) {
        var sum = 0;
        for (var a = 0; a < data.length; a++) {
            sum = sum + data[a];
        }
        console.log('event working', sum);

    });
}); 
```

您也可以使用 $rootScope 代替 $scope。相应地使用您的控制器。

# php - 在 Facebook 墙上发布我的网站链接时出现 PHP 语法错误

> ID：11252782
> 
> 赞同：0
> 
> 时间：2012-06-28T20:58:31.593
> 
> 标签：php, facebook, syntax, hyperlink, facebook-comments

当我尝试在 facebook 上发布[http://www.247limosales.com](http://www.247limosales.com)作为评论时，我收到以下消息：

[http://247limosales.com/](http://247limosales.com/) ：语法错误，意外的 T_STRING，期待 ',' 或 ';' 在第 462 行的 /home/content/e/c/o/ecommphppro/html/247limosales/listings.php

我检查了我的 PHP 代码，它很好，我在实际网站本身上也没有问题，它可以正确生成 HTML，我不明白为什么 facebook 会给出这个错误。即使我去网站上的“查看代码”，我也看不到像上面那样的错误

这是第 462 行的代码：

```
// See if we have a unique hit      
$hitquery = mysql_query("SELECT * FROM listinghits WHERE hitip='" . $_SERVER["REMOTE_ADDR"] . "' AND adid='" . $adid . "' LIMIT 1");

  if (!$hitquery)

  { echo mysql_error(); }
  if (mysql_num_rows($hitquery)==0)
  {
    $hitquery = mysql_query("INSERT INTO listinghits (hitid, date, hitip, adid) VALUES ('', CURDATE(), '" . $_SERVER["REMOTE_ADDR"] . "', '" . $adid . "')");
    if (!$hitquery)
    { echo mysql_error(); }
  } 
```

最后一行是第 62 行

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T22:10:30.690

它将是您的 adid 字符串中的 ' 或 " （使用 mysql_real_escape_string($adid) 或正在发生的是 $_SERVER[REMOTE_ADDR] 中的句点被视为连接，因此它变为：

```
select * from table where htip='".128.10.50.125."'" and it is breaking the string as it is expecting a ' or ". 
```

尝试：

```
select * from table where htip='".{$_SERVER[REMOTE_ADDR]}."' 
```

# mysql - 必须插入一条记录，然后更新相同的记录保证 1:1 关系设计？

> ID：11252783
> 
> 赞同：1
> 
> 时间：2012-06-28T20:58:34.817
> 
> 标签：mysql, sql, database-design, database-performance, relationships

假设一个`Order`有许多`Line`项目，我们将订单的总成本（基于订单行上的价格总和）存储在订单表中。

```
--------------
orders
--------------
id
ref
total_cost
--------------

--------------
lines
--------------
id
order_id
price
-------------- 
```

在一个简单的应用程序中，订单和行是在结帐过程的同一步骤中创建的。所以这意味着

```
INSERT INTO orders .... 

-- Get ID of inserted order record
INSERT into lines VALUES(null, order_id, ...), ... 
```

我们在创建订单记录后获取订单 ID。

我遇到的问题是试图找出存储订单**总成本**的最佳方式。我不想

1.  创建订单
2.  在订单上创建行
3.  根据行计算订单成本，然后更新在 1\. 在订单表中创建的记录

这意味着初学者的订单上有一个可为空的 total_cost 字段......

到目前为止，我的解决方案是创建一个与**orders**表 1:1 关系的**order_totals**表。但我认为这是多余的。理想情况下，由于计算总成本（订单行）所需的所有内容都在数据库中，所以每次需要时我都会计算出该值，但这非常昂贵。

 **你怎么认为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:02:29.110

我认为最好不要有订单总计列或表格。

只要您需要显示它们，只需通过对 Line 记录求和来计算订单总额。想象一下，如果行记录发生变化，那么您将不得不不断维护另一个列或表来更新订单的总价格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T21:05:54.730

该表不是必需的，因为它可以存储为订单表的列。

是否值得将其存储为新列取决于您将读取值与所做更改的次数（以及计算成本）。

如果它被阅读了很多但没有经常更改，并且需要花费不可接受的时间来计算，那么维护一个新的总列是值得的。否则你最好每次都计算它，也许是通过一个视图，这样你就不必在它选择的任何地方都在计算中编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-28T21:15:38.917

我同意其他评论者的观点，除非计算订单项的总成本在资源方面异常昂贵，否则您最好使用 SUM/GROUP BY 查询即时执行此操作。

但是，如果您仍想进行前期总成本计算，只需在开始运行 SQL 插入之前在内存中计算它。毕竟，您有数据要插入到行项目中，所以只需对其进行迭代并先总结总成本，然后创建带有总成本的订单记录。紧随其后的是订单项插入。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-28T21:32:25.787

正如其他人所建议的那样，动态计算总和可能更好。

我只想补充一点，[InnoDB 将其表集群](http://www.ovaistariq.net/521/understanding-innodb-clustered-indexes/)化，因此如果您`lines`正确选择 PK，相同订单的行将**物理上靠近**存储在一起，您将能够以最小的 I 计算整个订单的总和/O（即非常迅速）。

为此，请放弃替代 PK`lines`并使用自然 PK: `{order_id, line_no}`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-28T21:33:47.200

我会回应其他答案并说，除非这样做的成本高得无法接受，否则我会在需要`lines`时从表格中计算总成本。

或者，可以定义`orders.total_cost`适当更新的触发器。`INSERT`但是，需要在`UPDATE`和`DELETE`on之后定义触发器`lines`：

```
CREATE TRIGGER after_insert_lines AFTER INSERT ON lines FOR EACH ROW
  UPDATE orders SET total_cost = total_cost + NEW.price;

CREATE TRIGGER after_update_lines AFTER UPDATE ON lines FOR EACH ROW
  UPDATE orders SET total_cost = total_cost - OLD.price + NEW.price;

CREATE TRIGGER after_delete_lines AFTER DELETE ON lines FOR EACH ROW
  UPDATE orders SET total_cost = total_cost - OLD.price; 
```**

# jquery - 带有编辑和删除选项的 Jquery 移动列表视图拆分按钮

> ID：11252784
> 
> 赞同：3
> 
> 时间：2012-06-28T20:58:37.713
> 
> 标签：jquery, jquery-mobile

是否可以在 jquery mobile listview 中的行按钮中放置一些操作/选择？

这是我尝试过的代码，但它不起作用。我不知道这是否可以做到？

```
<ul data-role="listview" data-split-icon="gear">
  <li>
    <a href="/somewhere/">Somewhere description</a>
    <div data-role="controlgroup" data-type="horizontal">
      <a href="/somewhere/delete/">ble</a>
      <a href="/somewhere/delete/">Delete</a>
    </div></li>
  </li>
</ul> 
```

有两个选项我会觉得很有帮助。- 2 个图标（删除和编辑图标）而不是一个“齿轮”图标）或 - 一个启动选择（编辑/删除）的图标或某种带有 2 个选项的对话框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-19T04:43:59.890

try

```
<ul data-role="listview" data-split-theme="a" data-inset="true">
    <li>
        <div class="ui-grid-a" >

            <div class="left-li ui-block-a "  >
                <h3>xxxxx xxx xxxx x xx xxxxx xxx xxxx x xx</h3>
            </div>
            <div class="right-li ui-block-b "   >
                <a class="ui-shadow ui-btn ui-corner-all ui-icon-edit ui-btn-icon-notext ui-btn-inline">Button</a>
                <a class="ui-shadow ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-inline">Button</a>
            </div>

        </div>
    </li>
    </ul>

<style>
.right-li {
    text-align: right;
}
.left-li {

}

.ui-grid-a>.ui-block-a{
width:75%;
}

.ui-grid-a>.ui-block-b {
width:25%;

}

</style> 
```

Note I am using jquery mobile 1.4.3.

# iis - 盒子上的所有 IIS 站点现在挑战/响应

> ID：11252786
> 
> 赞同：0
> 
> 时间：2012-06-28T20:58:41.570
> 
> 标签：iis

我有一个开发服务器，几个月后我才返回（2003 R2，IIS 6），突然间，我在那里运行以进行开发和测试的本地站点在打开匿名时挑战我的凭据他们全部。它也不接受任何凭据，甚至是本地管理员。

这些不是 .NET 站点。

有什么想法是怎么发生的以及我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:02:49.533

当您选择匿名访问时，您必须键入要在其下运行的用户的凭据。您确定那里的凭据有效吗？有时，如果您在该帐户上的密码已过期且未更改，则可能会发生此类行为。

与此相关的另一件事是确保用户对为您的站点配置的文件夹和资源具有足够的权限。

# jquery - 如何选择所有具有id的元素，适用于正则表达式

> ID：11252789
> 
> 赞同：1
> 
> 时间：2012-06-28T20:58:54.653
> 
> 标签：jquery

我需要计算所有具有 'hi*' 之类的 id 的元素。

例如，如果我们有以下标记：

```
<div id="hi1"></div>
<div id="hi2"></div> 
```

数值必须为“2”。

在网上我发现了这个：

```
var num = $('.insttip:regex(id,'+ id[0] + '*').length; 
```

但这不起作用:(谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:01:40.890

## *[jsBin 演示](http://jsbin.com/iyolih/edit#javascript,html,live)*

尝试：

```
var num = $('div[id^=hi]').length; 
```

选择器的`^`意思是`starts with`。希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:09:24.213

如果您想在不使用 jQuery 插件的情况下针对元素的属性测试正则表达式，您可以使用[`.filter()`](http://api.jquery.com/filter/). 例子：

```
$('div').filter(function () {
    return /^hi.*$/.test(this.id);
}); 
```

或者，如果您只想要数字：

```
$('div').filter(function () {
    return /^hi\d+$/.test(this.id);
}); 
```

在这种情况下，您可以使用`[id^="hi"]`其他答案中记录的选择器。但这不是使用正则表达式的一般方法。该`.filter()`方法比内置的 jQuery 选择器提供了更多的灵活性，因此它通常是一个熟悉的好方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:02:08.760

尝试这个：

```
$('div[id^="hi"]').length; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:02:40.750

对于这种情况，有一个特定的 jQuery 选择器：[Starts with](http://api.jquery.com/attribute-starts-with-selector/)

你可以这样做：

```
$('div[id^="hi"]').length 
```

# android - 无法在 Android 应用程序中过滤 logcat

> ID：11252791
> 
> 赞同：0
> 
> 时间：2012-06-28T20:59:03.360
> 
> 标签：android

我正在开发一个应用程序并使用以下代码在文本视图中显示该应用程序，但它显示的唯一命令是`logcat -d`.

我希望它过滤带有标签的东西`dalvikvm`。我试过`logcat -s dalvikvm`了，但我的应用程序没有在设备上显示任何日志信息。

这是我的代码。

```
 try {
        Process process = Runtime.getRuntime().exec("logcat -s dalvikvm");
        BufferedReader bufferedReader = new BufferedReader(
        new InputStreamReader(process.getInputStream()));

        StringBuilder log=new StringBuilder();
        String line;
        while ((line = bufferedReader.readLine()) != null) {
          log.append(line);
        }
        TextView tv = (TextView)findViewById(R.id.textlog);
        tv.setText(log.toString());
      } catch (IOException e) {
      }
    }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T03:34:11.763

对 logcat.cpp 的检查证实了我的怀疑，即来自程序本身的任何错误消息都将写入 stderr——只有实际的日志消息会写入 stdout。

因此，如果您的尝试有任何问题，您将什么也看不到。很可能出错的事情是在您的应用清单中没有读取日志权限；没有这个，由您的应用程序运行的 logcat，因此在您的应用程序的用户 ID 下，将无法访问日志缓冲区。它的抱怨将是标准错误而不是标准输出。

两个建议：

*   尝试打开 process.getErrorStream() ，看看是否收到错误消息。

*   确保您具有读取日志清单权限

# php - 尝试从应用程序发布到 Facebook 墙时出现错误 100？

> ID：11252797
> 
> 赞同：0
> 
> 时间：2012-06-28T20:59:25.200
> 
> 标签：php, facebook, api, post, oauth

我正在使用 Facebook API，并且已经足够将访问令牌放入我的应用程序，但是当我实际向我的 Facebook 墙发送帖子时，我收到错误消息，`{"error":{"message":"(#100) You can't post this because it has a blocked link.","type":"OAuthException","code":100}}1`我没有尝试发送任何类型的链接，只是“你好，世界！” 所以这对我来说似乎很奇怪：\这是我到目前为止的代码：

```
$content = urlencode("Hello, World!");
$accesstoken = urlencode($row['fbid']);    
$result = getPageWithPOST("https://graph.facebook.com/me/feed", "access_token=" . $accesstoken . "&message=" . $content);
echo $result; 
```

getPageWithPOST 在哪里，

```
function getPageWithPOST($url, $posts) {
    $c = curl_init();
    curl_setopt($c, CURLOPT_URL, $url);
    curl_setopt($c, CURLOPT_POST, true);
    curl_setopt($c, CURLOPT_POSTFIELDS, $posts);
    $content = curl_exec ($c);
    curl_close ($c);
    return $content; 
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T22:03:27.027

首先，我建议您下载并使用 PHP SDK，因为它可以让您免去许多功能的麻烦：http: [//developers.facebook.com/docs/reference/php/](http://developers.facebook.com/docs/reference/php/)。然后有一个完美的例子可以复制到以下页面：http: [//developers.facebook.com/docs/reference/php/facebook-api/](http://developers.facebook.com/docs/reference/php/facebook-api/)

但是直接回答这个问题：这个错误没有出现任何具体的问题，但建议您发布的服务器可能已被 Facebook 阻止 - 可能是被 Facebook“禁止”的共享服务器？在不同的服务器上尝试，看看你是否能得到更好的结果。

# asp.net - 在 VisualBasic2010 Web 应用程序中隐藏和显示多行文本（如帮助）的最佳方法

> ID：11252801
> 
> 赞同：0
> 
> 时间：2012-06-28T20:59:39.343
> 
> 标签：asp.net, visual-studio-2010

在 VisualBasic2010 Web 应用程序中，我应该使用工具箱中的哪个控件来显示和隐藏页面上的多行文本块？

接下来我将有一个名为“隐藏”的链接按钮，当用户单击它时，文本的 .visible 属性将设置为 false。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:03:14.837

我会制作 html 服务器端标签

```
<div class="tooltip" runat="server" ID="myTooltip" Visible="true">Some multiline text</div> 
```

并在后面的代码中更改它的可见属性。

```
linkButton1_Click(object sender, EventArgs e)
{
 myTooltip.Visible = false;
} 
```

非常基本的解决方案，但对我来说非常有用。

其他选项是您也可以使用 Tooltip 控件。

# sql-server - 使用 CASE 表达式设置变量

> ID：11252804
> 
> 赞同：0
> 
> 时间：2012-06-28T20:59:49.637
> 
> 标签：sql-server, tsql

我有一个如下所示的查询：

```
SELECT  LossCost, CoverageID                
FROM BGILossCost] 
WHERE CoverageID IN (1, 2) AND
      StateID = @StateID AND
      ConstructionID = @ConstructionID AND
      PropertyClassCodeID = @PropertyClassCodeID AND
      (BGIDistrictID = @BGIDistrictID OR BGIDistrictID IS NULL) 
```

并返回以下数据，这是正确的：

```
LossCost                                CoverageID
--------------------------------------- -----------
0.012                                   1
0.034                                   2 
```

但我想要做的是根据 CoverageID 的值设置两个变量

这是伪代码：

```
SELECT  @Var1 = CASE CoverageID = 1 THEN LossCost END,
  @Var2 = CASE CoverageID = 2 THEN LossCost END             
FROM BGILossCost] 
WHERE CoverageID IN (1, 2) AND
      StateID = @StateID AND
      ConstructionID = @ConstructionID AND
      PropertyClassCodeID = @PropertyClassCodeID AND
      (BGIDistrictID = @BGIDistrictID OR BGIDistrictID IS NULL) 
```

我总是可以执行以下操作，但我希望出于性能原因我不必两次加入同一张桌子

```
SELECT  @Var1 = LossCost                    
FROM BGILossCost] 
WHERE CoverageID = 1 AND
      StateID = @StateID AND
      ConstructionID = @ConstructionID AND
      PropertyClassCodeID = @PropertyClassCodeID AND
      (BGIDistrictID = @BGIDistrictID OR BGIDistrictID IS NULL) 

SELECT  @Var2 = LossCost                    
FROM BGILossCost] 
WHERE CoverageID = 2 AND
      StateID = @StateID AND
      ConstructionID = @ConstructionID AND
      PropertyClassCodeID = @PropertyClassCodeID AND
      (BGIDistrictID = @BGIDistrictID OR BGIDistrictID IS NULL) 
```

任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:12:03.553

你非常接近，这不起作用：

```
SELECT
  @Var1 = MAX(CASE WHEN CoverageID = 1 THEN LossCost END),
  @Var2 = MAX(CASE WHEN CoverageID = 2 THEN LossCost END)  
FROM BGILossCost
WHERE CoverageID IN (1, 2) AND
      StateID = @StateID AND
      ConstructionID = @ConstructionID AND
      PropertyClassCodeID = @PropertyClassCodeID AND
      (BGIDistrictID = @BGIDistrictID OR BGIDistrictID IS NULL); 
```

# c - 在整个文件的不同位置定义静态全局变量是不好的做法吗？

> ID：11252807
> 
> 赞同：1
> 
> 时间：2012-06-28T21:00:05.013
> 
> 标签：c, coding-style

当我第一次开始编程时，我总是遵循在文件顶部定义全局变量的约定，例如：

```
static int a[10];
static int b[10];

void firstFn(void)
{
    a[0] = 1;
}

void secondFn(void)
{
    b[4] = 2;
}

void thirdFn(void)
{
    b[5] = 2;
} 
```

但最近我正在做一些事情，我希望将全局变量的定义与一些对文件中进一步定义的变量进行操作的函数分组：

```
static int a[10];

void firstFn(void)
{
    a[0] = 1;
}

static int b[10];

void secondFn(void)
{
    b[4] = 2;
}

void thirdFn(void)
{
    b[5] = 2;
} 
```

另一位程序员正在审查这段代码，并说这是他最讨厌的事情之一。是否有充分的理由坚持最高定义的约定？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:09:11.603

静态变量是编译单元的本地变量。只要在程序中第一次使用之前声明它们，它们的位置就完全没有区别。

尽管将静态声明保留在文件顶部没有纯粹的技术原因，但这是一个相当普遍的约定。我已经看到它在几家公司的编码标准中明确写出。当所有程序员都遵循相同的约定时，代码看起来更加统一，统一是朝着代码可维护性迈出的一大步。当其他人打开您的文件并且代码格式看起来很熟悉时，这是一个很大的优势。因此，如果您团队中的其他同事确实遵循此约定，您也应该遵循它。

# sql - 特定表的 syscolumns 中的所有列的列表以及 sys.indexes 表中的 isprimarykey 列

> ID：11252812
> 
> 赞同：1
> 
> 时间：2012-06-28T21:00:15.083
> 
> 标签：sql

我试图从 sys.indexes 表中获取特定表的所有列的列表以及数据类型和 is_primary_key 列。但我无法正确获取 is_primary_key 列。我希望 is_primary_key 仅针对作为表主键的列设置为 1。所有列都设置为 1

下面是我正在使用的查询

```
select distinct c.name,c.system_type_id,is_primary_key from sys.columns c 
   inner join  sys.tables t on c.object_id=t.object_id
   inner join sys.index_columns ic on ic.column_id=c.column_id 
   inner join sys.indexes i on i.index_id=ic.index_id
   and t.name='comp' and i.is_primary_key=1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:07:53.900

兑换

```
inner join sys.indexes i on i.index_id=ic.index_id 
```

至

```
inner join sys.indexes i on i.index_id=ic.index_id and i.object_id=ic.object_id 
```

的主键`sys.indexes`是`(object_id, index_id)`。你有一个类似的错误`sys.index_columns`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T14:52:37.163

```
select '['+name+']',system_type_id, case when primarykeyCol.column_id is null then 0 else 1 end primaryCol  from sys.columns c 
left join (select c.column_id from sys.indexes i  
inner join sys.index_columns ic on i.index_id = ic.index_id and i.is_primary_key = 1 and i.object_id = object_id(@srctablename) and  ic.object_id = object_id(@srctablename)
inner join sys.columns c on ic.column_id = c.column_id and c.object_id = object_id(@srctablename) 
) primarykeyCol on primarykeyCol.column_id = c.column_id 

where c.object_id = object_id(@srctablename) 
```

# php - 在数组中添加一个键，即使值为空 PHP

> ID：11252814
> 
> 赞同：0
> 
> 时间：2012-06-28T21:00:21.797
> 
> 标签：php, arrays

我有一个表格，其中可以是几行相同的输入几次，就像这样，

```
<input type="text" name="company[]"><input type="text" name="type[]">
<input type="text" name="company[]"><input type="text" name="type[]">
<input type="text" name="company[]"><input type="text" name="type[]"> 
```

现在我必须将这些字段输入到数据库中，所以我遍历输入字段并且它工作正常。

但我有一个问题：有时循环中的字段可能为空。即公司将有一个价值，但没有类型。那么我怎样才能使循环应该在这样的键中输出空值：

```
Array(
   company => array(
          [0] => string0
          [1] => string1
          [2] => string2
     )
   type => array(
          [0] => 
          [1] => string1
          [2] => string2
     )
) 
```

所以你可以看到第一个类型的键是空的，那么我该如何实现呢，

我正在尝试这样做但没有结果，

```
$postFields = array('company', 'type');
$postArray = array();
foreach($postFields as $postVal){
    if($postVal == ''){
        $postArray[$postVal] = '';
    }
    else {
        $postArray[$postVal] = $_POST[$postVal];
    }
} 
```

感谢任何帮助，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:05:06.727

这个 HTML：

```
<input type="text" name="company[]"><input type="text" name="type[]"> 
```

将动态填充数组的键。`0`我认为只要提交了其中一个文本字段，您就永远不会得到一个空元素。相反，您最终会得到不匹配的数组长度，您将无法确定省略了哪个数字。

解决方案是在 HTML 中显式声明键，如下所示：

```
<input type="text" name="company[0]"><input type="text" name="type[0]">
<input type="text" name="company[1]"><input type="text" name="type[1]">
<input type="text" name="company[2]"><input type="text" name="type[2]"> 
```

现在，您可以遍历数组，如果未设置某个键，则可以将其设置为空字符串：

```
foreach( range( 0, 2) as $i) {
    if( !isset( $_POST['company'][$i]))
        $_POST['company'][$i] = "";

    if( !isset( $_POST['type'][$i]))
        $_POST['type'][$i] = "";
} 
```

# css - 为什么 Firefox 不显示表格单元格右边框或左边框？

> ID：11252815
> 
> 赞同：1
> 
> 时间：2012-06-28T21:00:23.063
> 
> 标签：css, firefox, html-table, opera, css-tables

我有一个为所有表格单元格设置边框的表格。这用于日历。当前日期的表格单元格包含一个更改该表格单元格背景颜色的 div。但是，在 Firefox 中查看时，它会覆盖（或覆盖 - 我不确定）表格右侧和底部的单元格边框。它覆盖了 Opera 中的顶部和左侧表格单元格边框。它在 Chrome 和 Safari 中运行良好。它尚未在 IE 中进行测试。如何在 Firefox 和 Opera 中显示所有边框？这是代码：

HTML：

```
<table class="calendar" frame="box" rules="none">
    <tr>
        <td></td>...//seven td's total
    </tr>
    <tr><td class="very_light_gray"><div class="calendar_day_wrap">Today</div></td>...</tr>
    .... // 5 or 6 table rows total
</table> 
```

CSS：

```
.calendar {
    position:inherit;
    margin:auto;
    height:100%;
    width:100%;
    z-index:99999;
    border-collapse:collapse;
}

.calendar tr {
    height:20%;
    position:relative;
    z-index:2;
}

.calendar td {
    border:1px solid #ccc !important;
    width:14%;
    vertical-align: top;
    position:relative;
    z-index:2;
}

.calendar_day_wrap {
    position:relative;    
    width:100%;
    height:100%;
}

.very_light_gray {
    background-color:#F8F8F8 !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T01:45:11.277

您设置`rules="none"`，它明确关闭列和行边界。

然后设置`border-collapse:collapse`，它使用列/行边框折叠单元格边框。对于每个边界段，都有一个列表，其中列出了哪些边界声明优先，并且“显式关闭”具有每个规范的最高优先级。

您想使用`border-collapse: separate`或不设置`rules="none"`. 很有可能，你也不想要`frame="box"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:30:34.103

这段在 Opera 12.0 和 Firefox 中运行的代码怎么样？

```
.calendar {
    margin:auto;
    height:100%;
    width:100%;
    border-collapse:collapse;
    border:1px solid #ccc;}

.calendar tr {height:20%;}

.calendar tr:nth-child(1) td {
    border:1px solid #ccc;
    height:20%;}

.calendar td {
    width:14%;
    vertical-align: top;}

.calendar_day_wrap {
    width:100%;
    height:100%;}

.very_light_gray {
    background-color:#F8F8F8;} 
```

# amazon-elb - 弹性负载均衡器后面的 mod_pagespeed

> ID：11252824
> 
> 赞同：2
> 
> 时间：2012-06-28T21:01:10.913
> 
> 标签：amazon-elb, mod-pagespeed

mod_pagespeed 重写了我的 CSS 链接

链接 href="/css/file.css" rel="stylesheet"

类似于：

链接 href="http://example.com/css/file.css.pagespeed.ce.97987.css" rel="stylesheet"

问题是，如果负载均衡器后面的服务器之一没有在 pagespeed 缓存中创建 file.css.pagespeed.ce.97987.css，则可能找不到它。

它对 .js 文件和图像做同样的事情

是否可以在本地服务器上访问这些文件，而不是要求负载均衡器为它们提供服务？

编辑：

这已通过以下方式解决：

ModPagespeedEnableFilters trim_urls

重写为

链接 href="/css/file.css.pagespeed.ce.97987.css" rel="stylesheet"

编辑2：

这重写了 a 链接中的 href 并从中删除了基本 url，这不好，因为我希望它们重定向到负载均衡器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:48:48.867

如果您的 .htaccess 中没有任何目录重写规则，则可以创建粘性策略。这意味着 elb 在定义的时间内保持与伸缩组的一个实例的 tcp 连接。此外，您必须将粘性策略添加到侦听器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T18:29:05.200

我也在探索。我认为使用“ModPagespeedMapOriginDomain”将您的本地服务器 IP 映射到您的负载平衡域或 IP 将告诉 modpagespeed 引用每台服务器上的本地缓存文件。这意味着您的 pagespeed.conf 在每台服务器上都必须是唯一的。

例子：

```
ModPagespeedMapOriginDomain localhost <domain>
ModPagespeedMapOriginDomain localhost https://<domain> 
```

或使用 IP：

```
ModPagespeedMapOriginDomain x.x.x.x <domain>
ModPagespeedMapOriginDomain x.x.x.x https://<domain> 
```

或使用虚拟主机：

```
ModPagespeedMapOriginDomain x.x.x.x/virutalhostroot <domain>
ModPagespeedMapOriginDomain x.x.x.x/virutalhostroot https://<domain> 
```

在我的情况下，SSL 仅为主要 VHost 设置

# c# - 正则表达式允许字母数字，只有一个空格，然后是字母数字

> ID：11252826
> 
> 赞同：7
> 
> 时间：2012-06-28T21:01:12.050
> 
> 标签：c#, .net, regex

我已经搜索和搜索并尝试了许多不同的方法，但我似乎无法弄清楚这一点。我正在寻找一种只允许字母数字字符，然后只有一个空格，然后是字母数字字符的方法。我敢肯定这很容易，但我不知道。

我想要的例子：

```
    第一个最后允许
    第一个最后一个不允许
    FirstLast 不允许
    第一个 最后一个 不允许
    First La'st 不允许

```

然后我想从字符串中删除无效字符。

如果您需要更多信息，请告诉我。非常感谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T21:04:25.383

```
^[a-zA-Z0-9]+ [a-zA-Z0-9]+$ 
```

……应该这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T21:04:18.300

这应该这样做：

```
^[0-9a-zA-Z]+ [0-9a-zA-Z]+$ 
```

演示：http: [//jsfiddle.net/5m6RH/](http://jsfiddle.net/5m6RH/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-28T21:08:13.153

使用这个正则表达式：

```
^[\p{L}\d]+ [\p{L}\d]+$ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-28T23:00:50.080

我相信你不想要名称中的数字，你正在寻找这个正则表达式：

```
^\p{L}+ \p{L}+$ 
```

或者

```
^\p{L}+\s\p{L}+$ 
```

where`\p{L}+`匹配一个或多个“字母”字符，因此不仅是`a-z`and `A-Z`，还有其他语言的字符。例如，*埃莉斯·威尔逊*。

* * *

如果你真的只想要字母数字字符，输入应该有两个部分，中间有一个空格；并且必须删除无效字符，然后：

1.  `[^\s\dA-Za-z]+`用空字符串替换所有匹配项，
2.  通过替换`^\s*`为空字符串来修剪前导空格，
3.  通过替换`\s*$`为空字符串来修剪尾随空格，以及
4.  使用正则表达式检查/验证此类字符串`^[\da-zA-Z]+ [\da-zA-Z]+$`

要从字符串中排除数字，请`\d`从上述模式中删除。

要允许更长的空间，而不仅仅是一个空格字符，请在第一个模式中添加`+`空格字符或在第二个模式后面添加空格字符`\s`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-28T22:30:57.823

**这应该工作**

```
(?i)\b[a-z\d]+ [a-z\d]+\b 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-11T07:56:22.357

这对于字母数字非常有效，如果适用，它们之间只有一个空格

```
 @"^[a-zA-Z0-9]+([ ]{0,1}[a-zA-Z0-9]+)*$" 
```

它将允许类似的值

```
 anand
    anand dev
    anand123 
    anand123 dev
    123anand
    123anand dev123
    my user name is anand123
    anand123  dev               **Not allowed due to multiple space**
     anand dev                  **not allowed due to space at begining** 
```

希望这会帮助你。谢谢。

# selenium - 如何与 selenium grid 2 并行启动测试

> ID：11252827
> 
> 赞同：0
> 
> 时间：2012-06-28T21:01:17.257
> 
> 标签：selenium, grid, installation

我对此很陌生。我想要做的是同时在多个浏览器上启动测试用例。这是我用来运行的 xml 文件：

```
<suite name="Selenium Grid with webdriver" verbose="3" parallel="tests" thread-count="2">
    <test name ="Selenium Grid demo">
        <parameter name ="browser" value = "iexplore"/>
        <classes>
            <class name="test.GridWithWebdriver"/>

        </classes>
    </test>

    <test name ="Selenium Grid demo2">
        <parameter name ="browser" value = "firefox"/>
        <classes>
            <class name="test.GridWithWebdriver"/>
        </classes>
    </test>

</suite> 
```

问题是在 Firefox 上运行的第二个测试仅在 IE 上运行完成后才运行。我尝试通过以下命令运行最大实例数 = 5 的集线器：

```
java -jar selenium-server-standalone-2.24.1.jar -role hub -maxInstances=5 
```

但是我仍然看到没有指定警告最大实例，使用默认 = 1 所以也许这就是它没有并行运行的原因？另外，如果我想在 3 个 IE 浏览器上启动相同的测试用例，我该怎么做？请帮助我进行设置。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T12:35:39.617

您必须再向 Selenium 网格 HUB 注册一个节点。让我们举个例子：

```
/*These two will only start the hub*/
start java -jar selenium-server-standalone-2.25.0.jar -role hub
start java -jar selenium-server-standalone-2.25.0.jar -role node 

/*Register node to port 5556*/
java -jar selenium-server-standalone-2.25.0.jar -role webdriver -hub http://localhost:4444/grid/register -port 5556 -browser browserName=firefox

/*Register node to port 5556*/
java -jar selenium-server-standalone-2.25.0.jar -role webdriver -hub http://localhost:4444/grid/register -port 5557 -browser browserName=firefox 
```

关于 IE，看看这个例子：[GRID2 configuration - in parallel](http://qtp-help.blogspot.co.at/2011/09/selenium-grid-with-webdriver.html)

编辑：更好的解决方案是做这里解释的事情：[多个实例](https://stackoverflow.com/questions/8313310/selenium-grid2-is-it-possible-to-run-10-chrome-instances)。这个想法是使用以下参数打开节点：

```
-maxSession x -browser browserName=firefox,maxInstances=x 
```

在你的情况下，而不是 x，放 5。

# html - 在下拉菜单中选择不下拉

> ID：11252829
> 
> 赞同：1
> 
> 时间：2012-06-28T21:01:22.793
> 
> 标签：html, css, drop-down-menu, jinja2, html-select

为什么我的下拉菜单不下拉？我不熟悉使用样式表，并且想知道是否必须告诉它一些事情，因为在没有 css 的早期 appengine 工作中，菜单按预期下降。

![不下拉的下拉菜单。](../Images/e596ba315a9e3b6f389ef123a11ba475.png)

**问题可能是 jinja2 语法与该模板所基于的 django 语法不同吗？**对于这种情况，我找不到任何 jinja2 文档。

```
#inputdata {margin:0 20%}
#inputdata {background:#bfe2f9}

<div id="inputdata">
    <label>Year:</label>
      <select name="year">
        {% for year in years %}
        <option 
    {% ifequal year yearset %}
    selected="selected"
    {% endifequal %}
        value={{year}}>{{year}}</option>
        {% endfor %}
      </select>
    <label>Month:</label>
      <select name="month">
        {% for month in months %}
        <option 
    {% ifequal month monthset %}
    selected="selected"
    {% endifequal %}
        value={{month}}>{{month}}</option>
        {% endfor %}
      </select>
    <label>Day:</label>
      <select name="day">
        {% for day in days %}
        <option 
    {% ifequal day dayset %}
    selected="selected"
    {% endifequal %}
        value={{day}}>{{day}}</option>
        {% endfor %}
      </select>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:06:20.107

它需要看起来像

```
<select>
<option value="2012">2012</option>
<option value="2013">2013</option>
<option value="2014">2014</option>
</select> 
```

[http://www.tizag.com/htmlT/htmlselect.php/](http://www.tizag.com/htmlT/htmlselect.php/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:06:38.157

> ```
> <select><option value="All the years!">[2012,2013,2014]</option></select> 
> ```

这不是`<select>`标签的工作方式。你只有*一个选项*，所以没有什么可下拉的。

您需要将可选择的项目分解为它们自己的选项标签：

```
<select>
  <option>2012</option>
  <option>2013</option>
  <option>2014</option>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T04:44:44.260

看起来你正在传递`years`，`months`并且`days`作为嵌套太深的列表。如果`len(years) == 1`那时你想改变你传递给 Jinja 的内容：

```
years = [[2012, 2013, 2014]] 
```

对此：

```
years = [2012, 2013, 2014] 
```

`months`（对和做同样的事情`days`）。

此外，Jinja2 没有`ifequals`标签 - 你可以只使用`if`块：

```
{% for year in years %}
<option {% if year == yearmark %}selected="selected"{% endif %} value="{{year}}">
{{ year }}</option>
{% endfor %} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:09:00.187

看起来您的语法类似于：

```
<select>
  <option>[2012, 2013, 2014]</option>
</select> 
```

什么时候应该看起来像：

```
<select>
  <option value="2012">2012</option>
  <option value="2013">2013</option>
  <option value="2014">2014</option>
</select> 
```

# testing - PHPUnit/DBUnit 处理时间戳列

> ID：11252830
> 
> 赞同：4
> 
> 时间：2012-06-28T21:01:23.800
> 
> 标签：testing, phpunit, database-testing

我正在尝试使用 PHPUnit/DBUnit 来测试我的 Zend Framework DbTable 模型。我被带有时间戳的表绊倒了。

我正在尝试使用 assertDataSetsEqual 将插入的实际结果与预期结果进行比较。当然，当我将记录插入带有时间戳的表中时，时间戳字段会填充当前日期/时间。代表预期数据的数据集是静态的，因此时间戳不匹配。

我该如何处理这种情况？我可以让断言忽略时间戳列吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:37:32.893

[多亏了这篇博文](http://digitalsandwich.com/archives/78-improved-phpunit-filters.html)，我才找到了一个更好的解决方案。

我创建了一个函数，让我可以轻松地断言我的两个数据集是相等的。

```
protected function assertDataSetEquals(
        $ExpectedXMLFileName,
        array $options = array()) {

    $model  = (isset($options['model'])) ?
        $options['model'] :
        $this->_object;
    $excludeColumns = (isset($options['excludeColumns'])) ?
        $options['excludeColumns'] :
        null;

    $ds = new Zend_Test_PHPUnit_Db_DataSet_DbTableDataSet();
    $ds->addTable($model);

    $dsFiltered = (isset($excludeColumns)) ?
        $this->filterColumns($model, $ds, $excludeColumns) :
        $ds;

    $this->assertDataSetsEqual(
        $this->createFlatXmlDataSet(
            APPLICATION_PATH 
            . '/../tests/fixtures/models/'
                . $ExpectedXMLFileName . '.xml'
        ),
        $dsFiltered
    );
} 
```

以及一个返回过滤数据集的私有函数。

```
private function filterColumns(
        $model,
        $dataSet,
        $excludeColumns) {

    $dsFiltered = 
        new PHPUnit_Extensions_Database_DataSet_DataSetFilter($dataSet);
    $dsFiltered->setExcludeColumnsForTable(
            $model->getName(),
            $excludeColumns
        );

    return $dsFiltered;
} 
```

现在要比较两个数据集，同时排除任何列，我只是这样做。

```
 $this->assertDataSetEquals(
            'TableWithTimestampIWantToIgnoreUpdate',
            array('excludeColumns'=>array('timestamp','id'))
        ); 
```

这使得测试与具有时间戳列的表相对应的模型变得更容易/更清晰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T19:29:26.963

我还没有找到任何让我认为这是可能的东西。

我最终解决它的方法是在更新后查询表，将结果保存在一个数组中，然后使用 assertEquals 确保正确的字段被更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-22T23:11:21.857

感谢 bconrad，我在我的测试类中添加了这个函数：

```
/**
 * @param Zend_Test_PHPUnit_Db_DataSet_QueryDataSet $dataSet
 * @param array $excludeTheseColumnsOfTheseTables Array where the keys are table names and the values are arrays of column names to exclude.
 * @return PHPUnit_Extensions_Database_DataSet_DataSetFilter
 * @see http://stackoverflow.com/a/11636295/470749
 */
protected function filterColumns($dataSet, $excludeTheseColumnsOfTheseTables)
{
    $filteredDataset = new \PHPUnit_Extensions_Database_DataSet_DataSetFilter($dataSet);
    foreach ($excludeTheseColumnsOfTheseTables as $tableName => $excludedColumns) {
        $filteredDataset->setExcludeColumnsForTable($tableName, $excludedColumns);
    }
    return $filteredDataset;
} 
```

然后过滤数据集就这么简单：

```
$queryDataSet = new \Zend_Test_PHPUnit_Db_DataSet_QueryDataSet($this->getConnection());
$queryDataSet->addTable('posts', 'SELECT * FROM posts');
$queryDataSet->addTable('users', 'SELECT * FROM users');
$excludeTheseColumnsOfTheseTables = array(
    'users' => array('created', 'modified'),
    'posts' => array('modified'));
$filteredDataset = $this->filterColumns($queryDataSet, $excludeTheseColumnsOfTheseTables);
$this->assertDataSetsEqual($this->getAssertionXmlDataSet('asrt.xml'), $filteredDataset); 
```

# c++ - stringstream 代码分隔单词 - 这东西是如何工作的？里面的代码片段

> ID：11252831
> 
> 赞同：1
> 
> 时间：2012-06-28T21:01:26.380
> 
> 标签：c++, bitwise-operators, stringstream

我有这段代码，我发现它可以将字符串切成单词。我无法弄清楚 while 部分是如何工作的。它怎么知道将没有空格的单词提取到 buf 变量中？似乎提取运算符 (>>) 既用于将位推进到缓冲区中，又用于为循环返回 true - 我只是不知道它是如何知道用空格剪切单词的。

```
string buf; // Have a buffer string
stringstream ss(str); // Insert the string into a stream

vector<string> tokens; // Create vector to hold our words

while (ss >> buf)
    tokens.push_back(buf); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:25:53.570

> 我只是想不通它是如何知道用空格切割单词的

由于的类型`buf`是`std::string`，您需要阅读它的描述，`operator>>`左边`std::istream`是 a `std::string`，右边是 a。

引用[cppreference.com](http://en.cppreference.com/w/cpp/string/basic_string/operator_ltltgtgt)

> 字符被提取并附加到`str`，直到：
> 
> `N`读取字符，如果是`N`，否则是，`is.width()``is.width() > 0``N``str.max_size()`
> 
> 从 中读取 EOF 标记`is`，或
> 
> `isspace(c,is.getloc())`中的下一个字符为真`is`。

最后一个子句用英语说，“如果下一个字符是空格，则停止”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-28T21:10:16.783

也就是说[`std::operator>>`](http://en.cppreference.com/w/cpp/string/basic_string/operator_ltltgtgt)，不是按位运算符，而是用于提取格式化数据，在这种情况下是 a `std::string`。它返回对正在读取的流的引用。

由于它的转换， A`stringstream`可以在布尔上下文中使用[`operator void*()`](http://en.cppreference.com/w/cpp/io/basic_ios/operator_bool)，允许它用作循环中的终止条件。

# xml - 如何避免 NSXMLParser 中重复的 Core Data 元素？

> ID：11252840
> 
> 赞同：0
> 
> 时间：2012-06-28T21:02:04.277
> 
> 标签：xml, nsxmlparser, nsfetchrequest, nssortdescriptor

我正在阅读一个基本上如下所示的 XML 文件：

```
<teams>
    <team id = "A1">
        <player>Tom</player>
        <player>Dick</player>
        <player>Harry</player>
    </team>
    <team id = "A2">
        <player>John</player>
        <player>Tom</player>
    </team>
</teams> 
```

我使用 NSXMLParser 并在`didEndElement`委托方法中创建核心数据实体，如下所示：

```
if ([elementName isEqualToString:@"player"]) {
    if ([nodeContent length] != 0) {
        player = [NSEntityDescription insertNewObjectForEntityForName:@"Player" inManagedObjectContext:savedContext];            
        player.name = nodeContent;
    }
} 
```

并为 'team' on 做类似的事情`didStartElement`。' `nodeContent`' 是我从中得到的`foundCharacters`。到目前为止，一切都很好。一切正常。然而，在这个例子中，我有一个球员（汤姆）在两支球队打球。这是可能的，但我不希望我的核心数据中有两个汤姆实体。因此，我检查是否已经存在具有该名称的玩家：

```
 Player *player = nil;

    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Player"];
    request.predicate = [NSPredicate predicateWithFormat:@"name = %@", nodeContent];
    NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES];
    request.sortDescriptors = [NSArray arrayWithObject:sortDescriptor];

    NSError *error = nil;
    NSArray *players = [savedContext executeFetchRequest:request error:&error];

    if (!players || ([players count] > 1)) {
        NSLog(@"WTF?!");
    } else if ([players count] == 0) {
        player = [NSEntityDescription insertNewObjectForEntityForName:@"Player" inManagedObjectContext:savedContext];            
        player.name = nodeContent;
    } else {
        player = [players lastObject];
    }            
    [player addPlaysInTeamObject:team]; 
```

...如果是这样的话，我只使用那个实体。如果没有，我像以前一样创建一个新的。

现在，当我在前台同步运行解析时，这一切都有效，但我不想在下载内容时冻结我的应用程序。所以我把所有这些都放在一个线程中。它有时可以正常工作，但有时我会收到以下错误`executeFetchRequest`：

```
*** Terminating app due to uncaught exception 'NSGenericException', reason: '*** Collection <__NSCFSet: 0x8177a90> was mutated while being enumerated.'
*** First throw call stack:
(0x12d3022 0x1784cd6 0x12d2bf1 0x41314 0xd5b9 0xceaa25 0x19118f6 0x191dab0 0xce901d 0xcf8d 0xc3a5 0x1f31330 0x1f32439 0x908b9b24 0x908bb6fe)
terminate called throwing an exception(lldb) 
```

它有时会在我不使用（前台）UI 时发生，但*总是*在我触摸任何 UI 元素时发生，即使该 UI 元素不使用我在后台加载的数据。我查看了这个论坛，并得出结论，这可能是由于解析器填满了数据库，同时`NSFetchRequest`使用数据库搜索了某个名称。（虽然我不太明白，因为所有这些都发生在同一个线程中。）

有谁可以告诉我我做错了什么？

谢谢！

--国标

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T07:22:34.390

显然，当另一个线程仍在创建/更新核心数据数据库时，您无法访问核心数据实体。

在这种情况下，我最终将 XML 解析和核心数据创建分开。所以基本上，我解析整个 XML 内容并将其存储在 NSDictionary 中。之后，我使用上面的算法来查找或创建具有该 NSDictionary 的核心数据实体。

# python - 在 Python 中解析正则表达式

> ID：11252843
> 
> 赞同：2
> 
> 时间：2012-06-28T21:02:21.920
> 
> 标签：python, regex

假设我有一个格式如下的字符串：
`myString={"name", "age", "address", "contacts", "Email"}`

我需要`myString`使用 python 将所有项目放入列表中。这是我所做的：

```
r = re.search("myString=\{\"(.+)\", $\}", line)

if r:
     items.append(r.group(1)) 
print(items) 
```

这`line`是保存我的文本文件内容的变量。

我必须对我的正则表达式进行哪些更改才能获取所有项目`myString`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T21:13:54.320

看起来像有效的集合表示法，所以你可以使用 ast 模块来解析它：

```
import ast
mystr  = 'myString={"name", "age", "address", "contacts", "Email"}'

tree   = ast.parse(mystr)
name   = tree.body[0].targets[0].id
values = [val.s for val in tree.body[0].value.elts]

print name, values
# prints: myString ['name', 'age', 'address', 'contacts', 'Email'] 
```

编辑：根据输入文件的实际格式，我会使用正则表达式来解析块，然后像上面那样解析块，或者像下面这样去掉引号：

```
import re
block_re = re.compile(r'v_dims=\{(.*?)\}', re.S)

with open("C:\XXXX\nemo\Test.mrk") as f:
    doc = f.read()

block = block_re.search(doc)
[s.strip().strip('"') for s in block.group(1).split(',')] 
```

但可能最好的方法是将两者结合起来：

```
import ast
import re

with open("C:\XXXX\nemo\Test.mrk") as f:
    doc = f.read()

block_re = re.compile(r'v_dims=\{.*?\}', re.S)
tree     = ast.parse(block_re.search(doc).group(0))

print [val.s for val in tree.body[0].value.elts]
# ['name', 'age', 'address', 'contacts', 'Email'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T21:07:06.883

```
mystr = """myString={"name", "age", "address", "contacts", "Email"}"""
print mystr.split('"')[1::2] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:08:25.053

字符串是否保证具有该结构？如果是这样，您可以这样做：

```
>>> s = 'myString={"name", "age", "address", "contacts", "Email"}'
>>> data = s[s.find('{') + 1:s.rfind('}')]
>>> data
'"name", "age", "address", "contacts", "Email"'
>>> result = [t.strip() for t in data.split(',')]
>>> result
['"name"', ' "age"', '"address"', '"contacts"', '"Email"'] 
```

如您所见，我们执行以下步骤：

1.  查找`{`和字符之间的字符串`}`。
2.  用逗号分割字符串。这给出了一个字符串列表。
3.  然后我们从这些字符串中去除任何空格以获取项目。

如果您不需要引号，您可以从上面的结果列表中的每个字符串中删除第一个和最后一个字符。

# go - const if 语句是否与 Go 中的 #ifdef 宏做同样的事情？

> ID：11252846
> 
> 赞同：4
> 
> 时间：2012-06-28T21:02:24.730
> 
> 标签：go

Go 中没有文本预处理。像 Java 和其他类似的东西一样，如果我想删除一个代码块，我可以使用一个`const`值并用`if`.

如果我这样做，编译器是否会优化来自 AST 和生成代码的代码？还是每次都执行条件？

编辑：如果我想复制`#ifdef`最好的方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-29T03:50:09.703

条件不变的 if 语句不一样，`#ifdef`因为里面的代码无论如何都会被编译。但是，编译器会尽可能优化它。考虑这个程序：

```
package main

import (
    "fmt"
)

func main() {
    if false {
        fmt.Println("Hello, world!")
    }
} 
```

如果我们运行`go tool 6g -S test.go`，这里是函数的汇编输出`main`：

```
--- prog list "main" ---
0000 (test.go:7) TEXT    main+0(SB),$40-0
0001 (test.go:11) RET     , 
```

死代码消失了，所以它所做的只是返回。

如果您确实需要实际有条件地编译部分代码，最好通过构建系统来完成。

# jquery - 使用 addClass 时如何禁用队列？

> ID：11252851
> 
> 赞同：1
> 
> 时间：2012-06-28T21:02:42.603
> 
> 标签：jquery

当我不使用 .animate() 时，我不知道如何禁用队列。我认为 .clearQueue() 可能会起作用，但我不知道该放在哪里。谢谢！！

```
$('.one').hover(
  function () {
    $(this).addClass('bigger-outer', 1000);
    $(this).find('.inner').addClass('bigger-inner', 1000);
  }, 
  function () {
    $(this).removeClass('bigger-outer', 1000);
    $(this).find('.inner').removeClass('bigger-inner', 1000)
  }
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:06:53.773

`clearQueue` *将*清空队列，*但*它会让*当前*动画（如果有的话）继续运行。

如果您还想停止当前动画，请参见[`stop()`](http://api.jquery.com/stop)，并将两个参数都设置为 true（第一个用于清除队列，第二个用于跳转到末尾）。

至于将它们放在哪里，您很可能在*两个*事件处理程序中都需要它；

```
$('.one').hover(
  function () {
    $(this).stop(true, true).addClass('bigger-outer', 1000);
    $(this).find('.inner').addClass('bigger-inner', 1000);
  }, 
  function () {
    $(this).stop(true, true).removeClass('bigger-outer', 1000);
    $(this).find('.inner').removeClass('bigger-inner', 1000)
  }
); 
```

**Note** that jQuery's [`addClass()`](http://api.jquery.com/addClass) does not accept a second parameter; it's effect is instantaneous, but [jQuery UI does](http://jqueryui.com/demos/addClass/) (apparently, which is stupid).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:06:44.633

您可以链接`.stop(true)`以清除动画队列

[http://api.jquery.com/stop/](http://api.jquery.com/stop/)

# apache - 设置 Cookie 的 RewriteRule、RewriteMap 配合不好

> ID：11252862
> 
> 赞同：0
> 
> 时间：2012-06-28T21:04:04.867
> 
> 标签：apache, cookies

我使用 mod_rewrite 使用 apache httpd 2.2.15 (Unix)

我正在进行这个重写：

```
RewriteEngine On
RewriteLogLevel 7
RewriteMap encode-map prg:/var/www/centos6.local/encode.pl
RewriteLog "/var/log/httpd/centos6.local-rewrite_log" 
RewriteCond %{QUERY_STRING} CID=(.*)
RewriteRule .* - [L,CO=NDD_COOKIE:${encode-map:%1}:ndipiazza.test.local:50000] 
```

这样做的目的是检测您是否在查询字符串的任何位置找到 CID=xyz。如果这样做，请创建一个带有 xyz 的 cookie NDD_COOKIE，由自定义 perl 脚本 /var/www/centos6.local/encode.pl 编码

这只会设置一次cookie，然后在服务器完全重新启动之前不会再次设置cookie。

0) 设置 hosts 文件，使 ndpiazza.test.local 指向 192.168.2.7

1) 启动[http://ndipiazza.test.local/test.html?CID=test123](http://ndipiazza.test.local/test.html?CID=test123)

结果：编码的cookie按预期写入

2）切换到新的浏览器或清除浏览缓存。

3) 启动[http://ndipiazza.test.local/test.html?CID=new567](http://ndipiazza.test.local/test.html?CID=new567)

结果：没有写入cookie！

[这是 encode.pl 脚本的链接](http://pastebin.com/8f5U8DvR)

为什么会这样？

这是[http://ndipiazza.test.local/test.html?UID=sfsfsfd888m](http://ndipiazza.test.local/test.html?UID=sfsfsfd888m)在它不起作用时的重写日志：

```
192.168.2.3 - - [28/Jun/2012:16:33:29 --0500] [ndipiazza.test.local/sid#7fc041c0c880][rid#7fc041d34608/initial] (2) init rewrite engine with requested uri /test.html
192.168.2.3 - - [28/Jun/2012:16:33:29 --0500] [ndipiazza.test.local/sid#7fc041c0c880][rid#7fc041d34608/initial] (3) applying pattern '.*' to uri '/test.html'
192.168.2.3 - - [28/Jun/2012:16:33:29 --0500] [ndipiazza.test.local/sid#7fc041c0c880][rid#7fc041d34608/initial] (4) RewriteCond: input='UID=sfsfsfd888' pattern='UID=(.*)' => matched
192.168.2.3 - - [28/Jun/2012:16:33:29 --0500] [ndipiazza.test.local/sid#7fc041c0c880][rid#7fc041d34608/initial] (5) map lookup OK: map=encode-map key=sfsfsfd888 -> val=
192.168.2.3 - - [28/Jun/2012:16:33:29 --0500] [ndipiazza.test.local/sid#7fc041c0c880][rid#7fc041d34608/initial] (5) setting cookie 'WS_CUID=ndipiazza.test.local; path=/; domain=50000'
192.168.2.3 - - [28/Jun/2012:16:33:29 --0500] [ndipiazza.test.local/sid#7fc041c0c880][rid#7fc041d34608/initial] (1) pass through /test.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T18:57:26.170

如[http://httpd.apache.org/docs/current/rewrite/rewritemap.html#prg](http://httpd.apache.org/docs/current/rewrite/rewritemap.html#prg)中所述，该脚本仅在启动 Apache HTTPD 时调用。应该为每个请求返回不同值的 RewriteMap 可能应该使用 dbd 处理程序（仅在加载和配置 mod_dbd 时可用）。

您可以将脚本作为 CGI 运行，甚至可以使用[http://perldoc.perl.org/CGI/Cookie.html](http://perldoc.perl.org/CGI/Cookie.html)从 perl 代码设置 cookie ，或者使用 shell_exec 从 PHP 调用脚本并使用该值设置 cookie由该函数返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T21:39:25.753

答：系统只会打开一次encode.pl。预计将持续监听标准输入。

但是您仍然可以使用 prg rewritemap 来执行此操作。

我缺少的一件大事是我需要在 perl 中的 while 循环。

这是我最终解决问题的方法：

**httpd.conf 条目：**

```
RewriteEngine On
RewriteLogLevel 6
RewriteLog "/var/log/httpd/centos6.local-rewrite_log" 
RewriteCond %{QUERY_STRING} UID=(.*)
RewriteMap encode-map prg:/var/www/centos6.local/encode.pl
RewriteRule .* - [L,CO=NDD_COOKIE:${encode-map:%1}:ndipiazza.test.local:50000] 
```

**编码.pl：**

```
#!/usr/bin/perl
sub trim($) 
{ 
   my $string = shift; 
   $string =~ s/^\s+//; 
   $string =~ s/\s+$//; 
   return $string; 
} 
    $| = 1; # Turn off I/O buffering    
    while (<STDIN>) {
        s/-/0/g; # Replace dashes with 0's
     $a = $_;    
     $s = '';
     for ($i=0; $i<length($a); ++$i) {
        $c = substr($a, $i, 1);     
            if ($c eq 'Z') { 
              $s = $s . 'a'; 
           } elsif ($c eq 'z') { 
              $s = $s . 'A'; 
           } elsif ($c eq '9') { 
           $s = $s . '0'; 
        } else { 
              $s = $s . chr(ord($c)+1); 
            }
     }
     $s = scalar reverse trim($s);
        print "$s\n";
    } 
```

# python - 是否有理由不将 Python 文件的模式设置为开源 git 存储库中的可执行文件？

> ID：11252864
> 
> 赞同：0
> 
> 时间：2012-06-28T21:04:11.887
> 
> 标签：python, git, packaging

我正在启动一个开源 Python 库，我的公司希望我们所有的客户都可以使用它。由于我很喜欢正确的演示和实践，因此我对 git 保存的文件模式有疑问。但是，我想避免将其变成 StackOverflow 不鼓励的最佳实践类型的讨论，所以这里的问题是寻求具体答案的形式：

为什么我*不应该*在我的库中将 Python 示例设置为可执行？我倾向于在 Python 上设置我需要运行的可执行标志，并且更愿意这样做（仅仅是因为它通常*比*`./`键入更容易`python`），但我注意到大多数开源库与实践中的不同。我不觉得这种安全应该以那种方式表现出来，但我想确定一下。我不会将库文件设置为可执行，只是我认为应该是可执行的示例文件或测试。

作为一个相关问题，不应该直接执行的库文件是否应该省略`#!/usr/bin/env python`第一行的 hashbang ( ) ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T22:06:46.663

就个人而言，我只将我打算作为脚本执行的文件设置为可执行文件。在安全性方面，使用最小许可模型是一种明智的设计选择，即使不是理想的选择。如果您不需要这些权限，请不要使用它们。

我看不出有什么理由省略 shebang 是一个坏主意，除非其他人想让文件可执行，他们有两个步骤而不是一个步骤。

# python - 定期更新 Tkinter 中的标签

> ID：11252865
> 
> 赞同：2
> 
> 时间：2012-06-28T21:04:12.293
> 
> 标签：python, tkinter, python-2.x

我已经阅读了这个问题的许多解决方案，但我仍然无法使这个简单的程序工作。我知道这可能真的很简单，但我不知道我错过了什么。

我有这个简单的程序：

```
from Tkinter import *
import subprocess

def run():
    process=subprocess.Popen(some_script, shell=True, stdout=subprocess.PIPE)
    while True:
        nextline = process.stdout.readline()
        if not nextline:
            break
        output.set(nextline)
        root.update_idletasks()

root = Tk()
output = StringVar()

label1 = Label(root, textvariable=output)
label1.pack()

button1 = Button(root, text="Go", command=run)
button1.pack()

root.mainloop() 
```

所以当我点击按钮时， some_script 被执行。我希望标签定期更新脚本的输出，但它没有。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:46:17.767

我猜当你运行它时 GUI 会变得无响应。如果是这样，那么您正在阻止 Tkinter 的主循环。您需要在线程中运行子进程位并使用 Tkinter 的任何线程安全方法来更新您的 GUI。我发现这篇旧文章听起来与您正在做的非常相似：http: [//effbot.org/zone/tkinter-threads.htm](http://effbot.org/zone/tkinter-threads.htm)

还有这个方便的食谱：[http ://code.activestate.com/recipes/82965-threads-tkinter-and-asynchronous-io/](http://code.activestate.com/recipes/82965-threads-tkinter-and-asynchronous-io/)

# ruby-on-rails - Ruby on rails 参数出现在 url

> ID：11252874
> 
> 赞同：1
> 
> 时间：2012-06-28T21:05:17.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, parameter-passing, url-parameters

嗨，我有两个动作`check`，`display`在我`controller`和我有两个视图`check.html.erb`，并且`display.html.erb`在对应于这些动作的视图中。check 方法在它的视图中有一个表单 这是 check.html.erb

```
<%= form_for :display_command_list, :method => "get", :url => {:action => "display"} do |f| %>
                  <%= f.label :username %>
                  <%= f.text_field :username %><br />
                  <%= f.label :password %>
                  <%= f.password_field (:password) %><br />
                  <%= f.submit "Submit"%>
                <% end%> 
```

以下是这两个动作：

```
def check
end

def display
#some code here
respond_to do |format|
format.html
end
end 
```

当我在检查视图中填写表单时，它会提交表单显示操作和显示操作重定向到显示视图。但问题是 /display.html.erb 在它的 url 中提交了表单中的所有参数 - `/display?%username%=myname`...我认为我的 check 方法需要在其中写入一些内容，以便将表单提交给 display 方法和url 不包含表单中的参数。我不能在使用 params 的 check 方法中使用参数，因为它们是空的，并且会引发 nil object 错误请帮助

更新：

[在看到如何隐藏传递给方法的参数](https://stackoverflow.com/questions/1931364/how-can-i-hide-params-i-transmit-to-a-method-like-form-for-seems-to-do)后，我使用了 :method => post 而不是 :method=> 进入 form_for 标记 （就像 form_for 似乎一样）？

并且它没有在 url 中显示任何参数。但是现在当我从 display.html.erb（比如 do_something.html.erb）转到另一个视图并单击后退按钮返回到我的 display.html.erb 时，它说网页已过期。

如果我在问这个问题时不清楚，或者我在这里做的事情明显错误，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T01:32:31.013

你为什么不喜欢在 url 中有参数？这是标准做法。无论如何，您应该使用 POST 并面对浏览器行为的一些问题（例如返回您所描述的页面或 Ctrl-R-ing 页面）或使用 GET 并在 url 中包含所有参数。这就是 HTTP 的工作原理。

# php - 在变量的每一行前面加上一个字符串

> ID：11252875
> 
> 赞同：4
> 
> 时间：2012-06-28T21:05:21.390
> 
> 标签：php

如何使用 PHP 在多行字符串变量的每一行添加一个字符串，比如`'a'`存储在变量中？`$x`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-28T21:15:29.757

还可以使用：

```
echo preg_replace('/^/m', $prefix, $string); 
```

是[分隔](http://php.net/manual/en/regexp.reference.delimiters.php)符`/`。匹配字符串的[开头](http://php.net/manual/en/regexp.reference.meta.php)。使它成为多[行](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)。`^``m`

[演示](http://codepad.viper-7.com/rerOGh)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-28T21:06:58.017

有很多方法可以实现这一目标。

一种是：

```
$multi_line_var = $x.str_replace("\n", "\n".$x, $multi_line_var); 
```

另一个是：

```
$multi_line_var = explode("\n", $multi_line_var);
foreach($multi_line_var AS &$single_line_var) {
    $single_line_var = $x.$single_line_var;
}
$multi_line_var = implode("\n", $multi_line_var); 
```

或者作为一个欺骗性简单的在线人：

```
$multi_line_var = $x.implode("\n".$x, explode("\n", $multi_line_var)); 
```

与第一个相比，第二个非常浪费。它为字符串数组分配内存。它遍历每个数组项并对其进行修改。并将这些碎片重新粘合在一起。

但是，如果一个连接不是您对这些文本行所做的唯一更改，它可能会很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-28T21:14:49.843

由于您对**每一行**的要求，我将首先使用 将字符串拆分为一个数组`explode`，然后循环遍历该数组并将文本添加到每行的开头，然后将数组转回使用`implode`. 只要行数不是很大，这可以是一个合适的解决方案。

代码示例：

```
$arr = explode("\n", $x);
foreach ($arr as $key => $value) {
    $arr[$key] = 'a' . $arr[$key];
}
$x = implode("\n", $arr); 
```

示例：[http ://codepad.org/0WpJ41LE](http://codepad.org/0WpJ41LE)

# android - 检查是否在 Android 应用中启用了同步

> ID：11252876
> 
> 赞同：10
> 
> 时间：2012-06-28T21:05:22.057
> 
> 标签：android, sync

有没有办法在我的 Android 应用程序中以编程方式检查“设置”>“帐户和同步”>“数据和同步”下的特定设置是否启用？

有没有办法检查是否启用了常规同步设置？

谢谢！

* * *

如果它有助于了解“为什么”，我目前正在推出自己的同步功能（不使用 SyncAdapter）。但是，如果可能的话，我希望在数据和同步下列出我的同步服务。现在我打算破解一个什么都不做的虚拟同步服务，并让我的应用程序的同步服务查询是否启用了虚拟同步服务。这将告诉我是否同步。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-11-20T14:31:29.987

要知道是否启用了同步（并且不像[rajpara 的回答](https://stackoverflow.com/a/11253155/775894)那样处于活动状态），请使用以下命令：

```
AccountManager am = AccountManager.get(YourActivity.this);
Account account = am.getAccountsByType(YOUR_ACCOUNT_TYPE)[0];
boolean isYourAccountSyncEnabled = ContentResolver.getSyncAutomatically(account, DataProvider.AUTHORITY);
boolean isMasterSyncEnabled = ContentResolver.getMasterSyncAutomatically();
```

“主”同步状态是用户可以用来禁用手机上的所有同步的全局同步开关。如果主同步关闭，您的帐户将不会同步，即使您的帐户同步状态表明它已启用。

正如@HiB 提到的，`android.permission.READ_SYNC_SETTINGS`访问同步状态需要权限。`android.permission.WRITE_SYNC_SETTINGS`需要启用/禁用它。

`android.permission.GET_ACCOUNTS`正如 MeetM 提到的，您还需要获取帐户。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-28T21:26:55.807

[您可以在下面的代码和本](http://developer.android.com/reference/android/content/ContentResolver.html#isSyncActive%28android.accounts.Account,%20java.lang.String%29)[**文档**](http://developer.android.com/reference/android/content/ContentResolver.html#isSyncActive%28android.accounts.Account,%20java.lang.String%29)的帮助下检查是否启用了同步[](http://developer.android.com/reference/android/content/ContentResolver.html#isSyncActive%28android.accounts.Account,%20java.lang.String%29)

 **```
AccountManager am = AccountManager.get(YourActivity.this);
Account account = am.getAccountsByType(Const.ACCOUNT_TYPE)[0];
  if(ContentResolver.isSyncActive(account, DataProvider.AUTHORITY){
     // sync is enable
  } 
```

您还可以借助此功能以编程方式设置启用/`ContentResolver.setSyncAutomatically`禁用`ContentResolver.setMasterSyncAutomatically`

**更新**：

如果当前在待处理列表中存在针对给定帐户或权限的同步操作，或者正在积极处理，isSyncActive 将返回 true。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-06T10:38:55.517

```
boolean isEnabled = ContentResolver.getSyncAutomatically(account, MyProvider);
if(isEnabled)
{
...do something
} 
```

为我工作**

# c++ - std::map 中的 [] 运算符给了我分段错误

> ID：11252877
> 
> 赞同：-3
> 
> 时间：2012-06-28T21:05:30.800
> 
> 标签：c++, stdmap

我有一个

```
std::map<std::string, myClass*> myMap 
```

然后我插入如下：

```
if(!myKey.empty())
{
    myMap[myKey] = this;
} 
```

这有时会引发分段错误。

为什么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:30:49.247

也许您的 myMap 不再可访问。例如，它可能是对已删除指针的引用，或者更可能是已删除类的成员变量：

```
class MyClass {
  public:
    selfInsert(std::string myKey) {
      if(!myKey.empty()) {
        myMap[myKey] = this;
      }
    }

  private:
    std::map<std::string, myClass*> myMap;
}

int main()
{
  MyClass *a = new MyClass();
  delete a;
  a->selfInsert();
} 
```

# html - 使用 jQuery mobile 加载页面时是否需要完整的 html 页面？

> ID：11252880
> 
> 赞同：0
> 
> 时间：2012-06-28T21:05:48.987
> 
> 标签：html, mobile, jquery-mobile

我目前正在研究 jQuery mobile 及其使用 XmlHttpRequest 加载网页的系统。例如，因此可以在两个页面之间自动执行过渡动画。

但是，我不清楚。如果我理解正确，jQuery 移动驱动网站的每个新页面都被注入到初始网页的 DOM 中。jQuery mobile 的文档甚至告诉我们，由于这种机制，`<title>`新网页的标签没有被考虑在内。

因此，在某种程度上，如果我的初始网页 A.html 加载了页面 B.html，我会倾向于认为网页 B.html 不需要具有完整的 HTML 语法和`<html>`,`<head>`或`<body>`标签。

`<div>`我的页面 B.html 可以直接以元素开头。

我对吗？
使用 jQuery mobile 加载 HTML 页面时是否需要完整的 html 页面？
使用错误/截断 HTML 语法的网页有哪些优点和缺点（除了这个页面不应该直接访问，而是通过主页）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:14:05.490

在使用 jQuery mobile 时，您“应该”使用完整页面，但它当然会变得很长，然后将所有内容加载到 DOM 中需要很长时间。很多开发者不喜欢这样。

回答你的问题：只要你有一个有效的 html 页面（你的 jquery 移动应用程序的主页），它就可以加载一个“错误/trumcated”的 html 文件。它还可以很好地加载格式正确的 html 文件。无论您觉得看起来更干净，都由您决定。

这是一个类似的问答，有助于支持我的观点：[jQuery mobile multiple HTML files](https://stackoverflow.com/questions/6097905/jquery-mobile-multiple-html-files)

**一个警告：**如果这是一个可以在线访问的网站，并且如果您采用拥有多个（和碎片化）页面的方法，您可能需要停下来考虑一下 SEO。您可能需要一个 robots 文件阻止 Google 漫游器抓取其他页面。如果您完全关心整个网站的 SEO，那么您应该查看 Google 撰写[的关于移动响应式网页设计的](http://googlewebmastercentral.blogspot.ca/2012/06/recommendations-for-building-smartphone.html)这篇文章。它可以从一开始就改变你的整体观点。

我的意见是您应该将您的 jQuery Mobile 网站全部放在一个页面上。您总是可以根据需要使用 JavaScript/jQuery 注入额外的标记。这就是我为 jQuery Mobile 网站采用的方法。另一方面，如果您将其包装在 PhoneGap 中以部署为原生移动应用程序，那么我将使用碎片页面，因为 a) SEO 不适用于它，b) 我希望 DOM 加载速度尽可能快尽可能让它看起来像“真正的原生应用程序”一样加载。我相信碎片化页面会帮助它更快地加载，而且我知道根据需要使用 JavaScript/jQuery 注入代码会使其加载速度更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:34:28.367

但是，当用户从 开始`A.html`，然后转到`B.html`，然后刷新页面时会发生什么？jQuery Mobile 使用一个`pushState`插件来更新 URL，就像用户`B.html`正常访问页面一样。这意味着如果用户在 上刷新`B.html`，如果它不是一个完整的文档，将不会有适当的包含来创建您的移动站点。

我的建议是在每个文档中包含 jQuery Mobile JS/CSS 文件，在每个文档中包含 jQuery Core JS 文件，并包含包含所有必要 JS 和 CSS 的外部自定义 JS/CSS 文件。这样，无论用户访问您网站中的哪个页面，它都将包含所有必要的信息。这不会给您的网站增加很多臃肿，每页只包含几行内容。大多数情况下，当 jQuery Mobile 通过 AJAX 将页面拉入 DOM 时，所有这些包含将被忽略（jQuery Mobile 仅抓取第一个`data-role="page"`元素及其内容，文档中的其他所有内容都被忽略）。

**长话短说：**

为每个文档省略适当的 HTML 结构所带来的性能优势不值得破坏用户对常见事件的体验，例如刷新页面（当用户打开浏览器到已经打开的页面时，在许多设备上会自动发生这种情况）。

不使用有效 HTML 结构的一个主要**缺点**是您正在损害您的 SEO。文档中的元标记`<head>`对于页面中的内容仍然应该是唯一的，以便搜索引擎爬虫可以正确索引您的站点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:39:01.653

如果您尝试加载外部 html 文件，最好有一个完整的 html 页面。该html页面也应该有`<div data-role="page">`标签。我认为 jquery mobile 会查找该标签并基于该标签加载新页面。

您还可以将所有页面的 html 包含在一个页面中，例如“A.html”。每个页面 html 应该以`<div data-role="page">`

# javascript - 如何验证facebox中的表单字段？

> ID：11252881
> 
> 赞同：0
> 
> 时间：2012-06-28T21:05:52.043
> 
> 标签：javascript, forms, facebox

我需要验证我在 facebox 中显示的表单字段。

问题是我无法使用 javascript 获取字段的值。

例如： document.form.field_name.value 不返回其值。

代码示例：

```
<script type="text/javascript">
function validate()
{
  if (document.form1.field.value=='')
{
   alert ("Field cannot be left blank");
}
}

</script>

<form name="form1" onsubmit="return validate()">
<input type="text" name="field" /> 

</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T03:36:21.493

Facebox 复制显示的 DOM 块，有效地创建具有重复 id 的元素。HTML 标准不允许这样做。您的 javascript 疯狂寻找由其 id 唯一标识的单个元素，但它找到了其中的 2 个...

这是 Facebox 中的一个巨大错误。facebox 中的任何代码都不应该有 id。当显示面框时，您的所有绑定都应更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:24:34.920

一种方法是将值直接从表单传递到验证代码。

```
<form name="form" id="form" onsubmit="return validate(this.field.value)">
<input type="text" id="field" /> 
</form> 
```

或者您甚至可以使用没有表单的文本框：

```
<input type="text" id="field" 
onkeydown="if (event.keyCode == 13) return validate(this.value)" /> 
```

更新脚本以允许新的 value 参数：

```
<script type="text/javascript">
 function validate(val) {
   if (val.length < 1)
   {
      alert ("field cannot be left blank");
      return false; //to stop the default action of submitting the form
   } else {
      alert ("Value: "+val);
      return true; //allow to submit the page
   }
 }

</script> 
```

这实际上是一个非常简单的验证，但不要忘记根据您是否希望系统继续提交来设置返回操作。

我不确定您从远程 html 地址还是本地存储的 div 中提取页面。所以我不确定为什么你从 DOM 中提取值的解决方案不起作用。我通常没有问题使用 jquery 来获取和设置来自 Facebook 窗口中不同字段的值。

注意：您必须小心放置脚本的位置。这取决于您的应用程序，但有时您可能希望将脚本放在根文档而不是 facebox 页面中，因为如果您加载远程 facebox div，您的范围会发生变化，并且可能需要参考 parent.document 来访问父字段该脚本嵌入在远程 facebox div 中。

# html - 将 CSS 放入正文并维护有效的 HTML5 代码？

> ID：11252888
> 
> 赞同：0
> 
> 时间：2012-06-28T21:06:16.517
> 
> 标签：html, css

有没有办法将`<style>`标签包含在`<body>`其中并且仍然具有有效的 HTML5 代码？

创建模块化网站非常方便

1.  模板 #1 - 样式、javascript、html
2.  模板 #2 - 样式、javascript、html

并不是：

1.  模板 #1 - javascript、html
2.  模板 #2 - javascript、html
3.  所有风格混在一起`<head>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:10:16.317

在这里阅读：

[http://html5doctor.com/the-scoped-attribute/](http://html5doctor.com/the-scoped-attribute/)

Scoped 还没有完全标准化。给它一些时间。

# ruby - sed 命令在 ruby 中不起作用，但它在终端中起作用

> ID：11252892
> 
> 赞同：1
> 
> 时间：2012-06-28T21:06:43.777
> 
> 标签：ruby, bash, sed, terminal

当我从 ruby​​ 脚本中运行这行 sed 时，我遇到了问题：

```
sed -ne '/^<div class="results">/,/<\/body>/p' blah.html 
```

我试图在反引号 `` 中运行它，但它不会在 Ruby 脚本中正确执行。blah.html 的内容如下...

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>RSpec results</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Expires" content="-1" />
  <meta http-equiv="Pragma" content="no-cache" />
  <style type="text/css">
  body {
    margin: 0;
    padding: 0;
    background: #fff;
    font-size: 80%;
  }
  </style>
  <script type="text/javascript">
    // <![CDATA[

function addClass(element_id, classname) {
  document.getElementById(element_id).className += (" " + classname);
}

function removeClass(element_id, classname) {
  var elem = document.getElementById(element_id);
  var classlist = elem.className.replace(classname,'');
  elem.className = classlist;
}

function moveProgressBar(percentDone) {
  document.getElementById("rspec-header").style.width = percentDone +"%";
}

function makeRed(element_id) {
  removeClass(element_id, 'passed');
  removeClass(element_id, 'not_implemented');
  addClass(element_id,'failed');
}

function makeYellow(element_id) {
  var elem = document.getElementById(element_id);
  if (elem.className.indexOf("failed") == -1) {  // class doesn't includes failed
    if (elem.className.indexOf("not_implemented") == -1) { // class doesn't include not_implemented
      removeClass(element_id, 'passed');
      addClass(element_id,'not_implemented');
    }
  }
}

function apply_filters() {
  var passed_filter = document.getElementById('passed_checkbox').checked;
  var failed_filter = document.getElementById('failed_checkbox').checked;
  var pending_filter = document.getElementById('pending_checkbox').checked;

  assign_display_style("example passed", passed_filter);
  assign_display_style("example failed", failed_filter);
  assign_display_style("example not_implemented", pending_filter);

  assign_display_style_for_group("example_group passed", passed_filter);
  assign_display_style_for_group("example_group not_implemented", pending_filter, pending_filter || passed_filter);
  assign_display_style_for_group("example_group failed", failed_filter, failed_filter || pending_filter || passed_filter);
}

function get_display_style(display_flag) {
  var style_mode = 'none';
  if (display_flag == true) {
    style_mode = 'block';
  }
  return style_mode;
}

function assign_display_style(classname, display_flag) {
  var style_mode = get_display_style(display_flag);
  var elems = document.getElementsByClassName(classname)
  for (var i=0; i<elems.length;i++) {
    elems[i].style.display = style_mode;
  }
}

function assign_display_style_for_group(classname, display_flag, subgroup_flag) {
  var display_style_mode = get_display_style(display_flag);
  var subgroup_style_mode = get_display_style(subgroup_flag);
  var elems = document.getElementsByClassName(classname)
  for (var i=0; i<elems.length;i++) {
    var style_mode = display_style_mode;
    if ((display_flag != subgroup_flag) && (elems[i].getElementsByTagName('dt')[0].innerHTML.indexOf(", ") != -1)) {
      elems[i].style.display = subgroup_style_mode;
    } else {
      elems[i].style.display = display_style_mode;
    }
  }
}

    // ]]>
  </script>
  <style type="text/css">
#rspec-header {
  background: #65C400; color: #fff; height: 4em;
}

.rspec-report h1 {
  margin: 0px 10px 0px 10px;
  padding: 10px;
  font-family: "Lucida Grande", Helvetica, sans-serif;
  font-size: 1.8em;
  position: absolute;
}

#label {
  float:left;
}

#display-filters {
  float:left;
  padding: 28px 0 0 40%;
  font-family: "Lucida Grande", Helvetica, sans-serif;
}

#summary {
  float:right;
  padding: 5px 10px;
  font-family: "Lucida Grande", Helvetica, sans-serif;
  text-align: right;
}

#summary p {
  margin: 0 0 0 2px;
}

#summary #totals {
  font-size: 1.2em;
}

.example_group {
  margin: 0 10px 5px;
  background: #fff;
}

dl {
  margin: 0; padding: 0 0 5px;
  font: normal 11px "Lucida Grande", Helvetica, sans-serif;
}

dt {
  padding: 3px;
  background: #65C400;
  color: #fff;
  font-weight: bold;
}

dd {
  margin: 5px 0 5px 5px;
  padding: 3px 3px 3px 18px;
}

dd .duration {
  padding-left: 5px;
  text-align: right;
  right: 0px;
  float:right;
}

dd.example.passed {
  border-left: 5px solid #65C400;
  border-bottom: 1px solid #65C400;
  background: #DBFFB4; color: #3D7700;
}

dd.example.not_implemented {
  border-left: 5px solid #FAF834;
  border-bottom: 1px solid #FAF834;
  background: #FCFB98; color: #131313;
}

dd.example.pending_fixed {
  border-left: 5px solid #0000C2;
  border-bottom: 1px solid #0000C2;
  color: #0000C2; background: #D3FBFF;
}

dd.example.failed {
  border-left: 5px solid #C20000;
  border-bottom: 1px solid #C20000;
  color: #C20000; background: #FFFBD3;
}

dt.not_implemented {
  color: #000000; background: #FAF834;
}

dt.pending_fixed {
  color: #FFFFFF; background: #C40D0D;
}

dt.failed {
  color: #FFFFFF; background: #C40D0D;
}

#rspec-header.not_implemented {
  color: #000000; background: #FAF834;
}

#rspec-header.pending_fixed {
  color: #FFFFFF; background: #C40D0D;
}

#rspec-header.failed {
  color: #FFFFFF; background: #C40D0D;
}

.backtrace {
  color: #000;
  font-size: 12px;
}

a {
  color: #BE5C00;
}

/* Ruby code, style similar to vibrant ink */
.ruby {
  font-size: 12px;
  font-family: monospace;
  color: white;
  background-color: black;
  padding: 0.1em 0 0.2em 0;
}

.ruby .keyword { color: #FF6600; }
.ruby .constant { color: #339999; }
.ruby .attribute { color: white; }
.ruby .global { color: white; }
.ruby .module { color: white; }
.ruby .class { color: white; }
.ruby .string { color: #66FF00; }
.ruby .ident { color: white; }
.ruby .method { color: #FFCC00; }
.ruby .number { color: white; }
.ruby .char { color: white; }
.ruby .comment { color: #9933CC; }
.ruby .symbol { color: white; }
.ruby .regex { color: #44B4CC; }
.ruby .punct { color: white; }
.ruby .escape { color: white; }
.ruby .interp { color: white; }
.ruby .expr { color: white; }

.ruby .offending { background-color: gray; }
.ruby .linenum {
  width: 75px;
  padding: 0.1em 1em 0.2em 0;
  color: #000000;
  background-color: #FFFBD3;
}

  </style>
</head>
<body>
<div class="rspec-report">

<div id="rspec-header">
  <div id="label">
    <h1>RSpec Code Examples</h1>
  </div>

  <div id="display-filters">
    <input id="passed_checkbox" name="passed_checkbox" type="checkbox" checked onchange="apply_filters()" value="1"> <label for="passed_checkbox">Passed</label>
    <input id="failed_checkbox" name="failed_checkbox" type="checkbox" checked onchange="apply_filters()" value="2"> <label for="failed_checkbox">Failed</label>
    <input id="pending_checkbox" name="pending_checkbox" type="checkbox" checked onchange="apply_filters()" value="3"> <label for="pending_checkbox">Pending</label>
  </div>

  <div id="summary">
    <p id="totals">&nbsp;</p>
    <p id="duration">&nbsp;</p>
  </div>
</div>

<div class="results">
<div id="div_group_1" class="example_group passed">
  <dl style="margin-left: 0px;">
  <dt id="example_group_1" class="passed">Ark - Header (styles)</dt>
  </dl>
</div>
<div id="div_group_2" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_2" class="passed">that we have hit a valid URL</dt>
    <script type="text/javascript">moveProgressBar('14.2');</script>
    <dd class="example passed"><span class="passed_spec_name">should not return an invalid error message</span><span class='duration'>7.76052s</span></dd>
  </dl>
</div>
<div id="div_group_3" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_3" class="passed">Ark Home Button</dt>
    <script type="text/javascript">moveProgressBar('28.5');</script>
    <dd class="example passed"><span class="passed_spec_name">should exist</span><span class='duration'>2.22255s</span></dd>
  </dl>
</div>
<div id="div_group_4" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_4" class="passed">Ark Sign in link</dt>
    <script type="text/javascript">moveProgressBar('42.8');</script>
    <dd class="example passed"><span class="passed_spec_name">should exist</span><span class='duration'>1.68413s</span></dd>
  </dl>
</div>
<div id="div_group_5" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_5" class="passed">Ark Home Button Style</dt>
    <script type="text/javascript">moveProgressBar('57.1');</script>
    <dd class="example passed"><span class="passed_spec_name">should have accurate styling</span><span class='duration'>2.98297s</span></dd>
  </dl>
</div>
<div id="div_group_6" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_6" class="passed">Ark SignIn Button Style</dt>
    <script type="text/javascript">moveProgressBar('71.4');</script>
    <dd class="example passed"><span class="passed_spec_name">should have accurate styling</span><span class='duration'>3.77360s</span></dd>
  </dl>
</div>
<div id="div_group_7" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_7" class="passed">Ark header Topbar Style</dt>
    <script type="text/javascript">moveProgressBar('85.7');</script>
    <dd class="example passed"><span class="passed_spec_name">should have accurate styling</span><span class='duration'>2.78883s</span></dd>
  </dl>
</div>
<div id="div_group_8" class="example_group passed">
  <dl style="margin-left: 15px;">
  <dt id="example_group_8" class="passed">Post Sign-In Style</dt>
    <script type="text/javascript">moveProgressBar('100.0');</script>
    <dd class="example passed"><span class="passed_spec_name">should have accurate styling</span><span class='duration'>17.62036s</span></dd>
  </dl>
</div>
<script type="text/javascript">document.getElementById('duration').innerHTML = "Finished in <strong>38.83569 seconds</strong>";</script>
<script type="text/javascript">document.getElementById('totals').innerHTML = "7 examples, 0 failures";</script>
</div>
</div>
</body>
</html> 
```

当我从 mac osx 的终端尝试相同的命令时，它可以正常工作...

这是我尝试从 Ruby 中运行命令时遇到的错误：

```
sed: 2: "/^<div class="results"> ...": undefined label 'ody>/p' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T21:18:46.653

Ruby在执行命令之前将`\/`序列替换为一个简单的序列。`/`所以你的 sed 脚本被毁了。尝试使用双反斜杠 ( `\\/`)。

# jquery - 如何删除没有内部元素的div

> ID：11252897
> 
> 赞同：5
> 
> 时间：2012-06-28T21:07:04.977
> 
> 标签：jquery, jquery-selectors

我想删除一个 div 元素，但没有它的子元素。例如，假设我有一个带有 id 包装器的 div，里面有 5 个段落。

我只想删除包装器 div，但要保留段落。我已经尝试过 remove() 和 detach()，但它们都清除了内部元素。

有什么建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-28T21:09:36.600

[http://api.jquery.com/unwrap/](http://api.jquery.com/unwrap/)应该这样做：

> 该`.unwrap()`方法删除元素的父元素。这实际上与[.wrap()](http://api.jquery.com/wrap/)方法相反。匹配的元素（以及它们的兄弟姐妹，如果有的话）在 DOM 结构中替换它们的父元素......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-28T21:10:28.750

[jsFiddle 演示](http://jsfiddle.net/roXon/d9PQY/)

```
$('#element').contents().unwrap(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-28T21:09:15.473

查看[`.replaceWith()`](http://api.jquery.com/replaceWith/)

```
$('#theDiv').replaceWith($('#theDiv').contents()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:13:57.077

```
$('#yourdivIDtoremove').replaceWith($(this).text()); 
```

应该做 ;）

# xslt - XSLT 在下一个循环中获取节点的值

> ID：11252898
> 
> 赞同：0
> 
> 时间：2012-06-28T21:07:05.777
> 
> 标签：xslt

下面是xml。现在我正在寻找一个 xslt，在`<ns0:EBLoop1>`EB01 = 1 的第一个循环中，我需要 `<EB05>PACKAGE A STANDARD PLAN</EB05>` 在下一个 EBLoop1 中获取值。

我怎样才能做到这一点。

```
<ns0:EBLoop1>
  <ns0:EB>
    <EB01>1</EB01> 
    <EB05>This</EB05> 
    <EB07>0</EB07> 
  </ns0:EB>
  <ns0:MSG>
    <MSG01>Please See the Provider Manual</MSG01> 
  </ns0:MSG>
</ns0:EBLoop1>
<ns0:EBLoop1>
  <ns0:EB>
    <EB01>D</EB01> 
    <EB05>PACKAGE A STANDARD PLAN</EB05> 
    <EB07>0</EB07> 
  </ns0:EB>
</ns0:EBLoop1>
<ns0:EBLoop1>
  <ns0:EB>
    <EB01>F</EB01> 
    <EB03>30</EB03> 
    <EB07>0</EB07> 
  </ns0:EB>
</ns0:EBLoop1> 
```

谢谢，戈皮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:20:27.437

假设上下文节点是您的`EBLoop1`元素，您可以使用 xpath 获取下一个：

```
../following-sibling::ns:EBLoop1[1]/ns:EB/EB05 
```

但是您需要定义名称空间并使用 xpath 中的前缀。

# svn - 如何在工作副本和不相关分支之间进行 svn 差异

> ID：11252900
> 
> 赞同：2
> 
> 时间：2012-06-28T21:07:09.770
> 
> 标签：svn, merge, branch, diff

这是场景：

用户 1

1.  创建分支/X
2.  svn checkout 分支/X 到本地机器
3.  修改文件.txt
4.  提交更改

另一个用户，用户 2，

1.  创建分支/Y
2.  svn checkout 分支/Y 到他的本地机器
3.  将分支/X 合并到本地机器（从而将 file.txt 合并到分支/Y）
4.  在提交更改之前，使用 svn diff 验证对本地分支/Y 副本中的 file.txt 的更改是否成功。

由于 svn diff 无法将本地工作副本与 URL 的工作副本进行比较，因此用户 2 的步骤 4 在不首先将更改提交到分支/Y 的情况下是不可能完成的。但这违背了在提交合并更改之前验证合并是否产生正确结果的整个目的。

我已经对此进行了谷歌搜索，但没有找到任何可用的解决方案。唯一推荐的解决方案是检查分支/X，以便 svn 可以比较两条路径。由于尚未签入合并更改，因此我无法将 svn diff 与两个 URL 一起使用。

仅检查分支/X 和分支/Y 以便我可以执行差异是不切实际的，更不用说耗时和乏味了。

有没有办法将本地工作副本中尚未提交的合并更改与合并分支中的更改进行比较？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-29T21:29:00.170

Johan Corveleyn 为我提供了答案。我在这里发布它，以便其他人可以看到答案。

svn diff 确实可以将本地路径上的工作副本文件与存储库中的另一个版本进行比较，因此可以通过 URL 引用。下面是语法：

```
svn diff --old=http://repository/branches/X/file.txt --new=file.txt 
```

# c# - 如何正确访问/分发使用 MongoDB 的应用程序

> ID：11252901
> 
> 赞同：0
> 
> 时间：2012-06-28T21:07:26.347
> 
> 标签：c#, .net, mongodb

我对 C# 相当陌生，对数据库完全陌生。

目前我已经创建了一个电影数据库和一个与之配套的 GUI。我可以很好地查询数据库，但我有一个关于访问和分发我的应用程序的问题。

现在我必须在启动我的应用程序之前运行 mongod.exe。我对此的理解是 mongod.exe 让我的程序访问数据库。

我的问题是：

1.  有没有办法让我的应用程序运行而无需显式运行 mongod.exe？
2.  如果是这样，怎么做？

我问的原因是因为我想在多台计算机上分发我的应用程序，并且我不想在每台计算机上安装 MongoDB，并且必须在每次启动我的应用程序之前运行 mongod.exe。

如果我完全误解了这个问题，有人会介意我指出正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:39:35.443

Mongod 必须安装在某个地方，无论是 MongoHQ 之类的托管服务，还是远程服务器甚至客户端计算机上。没有……MongoDB，MongoDB 就无法存在。

如果您希望分发您的应用程序，为什么不建立一个中央数据库服务器供他们交谈？这将是一种更好的方法。

# asp.net - 如何使用 VisualBasic2010 Web 应用程序设置 cookie 以无限期过期

> ID：11252902
> 
> 赞同：0
> 
> 时间：2012-06-28T21:07:38.547
> 
> 标签：asp.net, visual-studio-2010

response.Cookies(SOFTWARE_PROGRAM_NAME).Expires = datetime.now.adddays(365*10)

这将到期设置为 10 年。

无论如何设置它为无限？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-06-28T21:24:19.843

Cookie 旨在存储临时状态信息，例如标识购物车或用户身份验证会话的令牌。用户当然可以通过清除浏览器缓存来轻松删除您的 cookie。如果你想要一个永远存在的 cookie，你永远不会得到它，这不是 cookie 的用途。如果您想永久存储基于用户的信息，请考虑将其存储在您的数据库或其他服务器端存储中。

来自[RFC2109](http://www.w3.org/Protocols/rfc2109/rfc2109)：

当然，有许多不同的潜在上下文，因此有许多不同的潜在会话类型。设计师通过交换 cookie 创建的会话范例具有以下关键属性：

1.  每个会话都有开始和结束。

2.  每个会话都相对短暂。

3.  用户代理或源服务器都可以终止会话。

4.  会话隐含在状态信息的交换中。

即 cookie 必须过期，因为每个会话都有开始和结束。

# android - 安卓屏幕尺寸

> ID：11252904
> 
> 赞同：0
> 
> 时间：2012-06-28T21:07:52.353
> 
> 标签：android

根据“android多屏设计”：

“当你为不同的屏幕尺寸设计 UI 时，你会发现每个设计都需要最少的空间。因此，上面的每个通用屏幕尺寸都有一个由系统定义的相关最小分辨率。这些最小尺寸在 "dp " 单位——你应该在定义布局时使用相同的单位——这使系统可以避免担心屏幕密度的变化。

*   超大屏幕至少为 960dp x 720dp
*   大屏幕至少为 640dp x 480dp
*   普通屏幕至少为 470dp x 320dp
*   小屏幕至少为 426dp x 320dp"

DisplayMetrics 类让我可以访问屏幕的实际宽度和高度。但是，上表是否可以通过编程方式获得。或者我是否需要将这些值作为常量存储在我的应用程序中。第二种选择似乎很老套。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T10:51:24.530

您的问题是您尝试为 x 已知分辨率进行固定设计，而 Android 的框架基于您事先不知道您的应用程序将在其上运行的设备的确切尺寸的想法。如果你看看 Android 市场，这是一个很好的假设。

如果您充分利用：
- 选择器，如“sw600dp”(7" tablet)
-nine-patchs (stretchables assets ) -dimensions
in dip 用于需要固定大小的东西（例如，按钮至少需要 48dp为了足够大）

您可以做出非常好的设计，以适应从 2 英寸手机到 10 英寸平板电脑的所有外形尺寸。

# ruby-on-rails - Rails redirect_to https 同时保留所有参数

> ID：11252910
> 
> 赞同：13
> 
> 时间：2012-06-28T21:08:28.703
> 
> 标签：ruby-on-rails, parameters

我像这样重定向到https：

```
redirect_to :protocol => 'https://', :status => :moved_permanently 
```

但是，参数不会像这样通过。我可以像这样传递特定的参数：

```
redirect_to :protocol => 'https://', :status => :moved_permanently, :param1 => params[:param1], :param2 => params[:param2] 
```

我将如何使它只传递 url 上的每个参数，而不必显式声明每个参数？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-28T21:56:07.137

弄清楚了：

```
redirect_to({:protocol => 'https://'}.merge(params), :flash => flash) 
```

这将通过重定向保留所有 URL 参数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-10-14T18:47:34.653

对于 Rails 4.2 及更高版本，传递整个`params`哈希将导致添加`?controller=foo&action=bar`到查询字符串中。相反，您应该这样做：

```
redirect_to protocol: 'https', params: request.query_parameters 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:14:30.463

如果您只需要在控制器级别，您可以使用：

```
MyController < ApplicationController
  force_ssl
end 
```

您可以使用 :only 或 :except 如果您只需要在某个操作上使用它。请参阅文档：

[http://api.rubyonrails.org/classes/ActionController/ForceSSL/ClassMethods.html](http://api.rubyonrails.org/classes/ActionController/ForceSSL/ClassMethods.html)

或者，如果您只想让整个应用程序使用 ssl（假设 rails 3.1 或更高版本）：

```
# config/application.rb
module MyApp
  class Application < Rails::Application
    config.force_ssl = true
  end
end 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-10-10T17:33:57.770

您可以将 params 作为参数传递，如下所示：

```
redirect_to :protocol => 'http://', :status => :moved_permanently, :params => params 
```

# python - hashlib - 为什么摘要匹配但裸对象不匹配？

> ID：11252911
> 
> 赞同：3
> 
> 时间：2012-06-28T21:08:31.513
> 
> 标签：python, md5, hashlib

我想知道在 python 2.7 中观察到的行为的实际原因是什么：

```
import hashlib
hashlib.md5('foo') == hashlib.md5('foo') 
```

返回假。但...

```
import hashlib
hashlib.md5('foo').hexdigest() == hashlib.md5('foo').hexdigest() 
```

返回真。我知道 hexdigest/digest 返回最终的字符串表示形式，但是由于相同的数据已直接输入到两个哈希对象中，它们不应该评估为彼此相等吗？调用魔术方法时，对象不会`md5 HASH`知道内部身份吗？`__eq__`出于什么原因，对象本身会评估不平等？真的只是好奇。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-28T21:12:23.510

对象没有相等比较，`hashlib.md5`因此，由于它们是不同的对象，结果是错误的。

该`.hexdigest`方法生成一个字符串（如果您使用的是 Python 3，则为字节字符串）并且可以比较字符串。

顺便提一句：

```
x = hashlib.md5('foo')
x == x # is True because it's the same object 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T17:11:36.093

原因可能是使用 == 来比较校验和会受到定时攻击：[https](https://groups.google.com/forum/?fromgroups=#!topic/keyczar-discuss/VXHsoJSLKhM) ://groups.google.com/forum/?fromgroups=#! topic/keyczar-discuss/VXHsoJSLKhM（归功于[https://中的 jwilkins stackoverflow.com/a/14487254/821378](https://stackoverflow.com/a/14487254/821378)）

在最近的 Python 版本中，添加了一个函数，但我忘记了它是用于所有哈希还是仅用于 HMAC：[http ://docs.python.org/3/library/hmac#hmac.compare_digest](http://docs.python.org/3/library/hmac#hmac.compare_digest)

# javascript - iOS 版 Chrome 中的 JavaScript 可以播放声音吗？

> ID：11252912
> 
> 赞同：0
> 
> 时间：2012-06-28T21:08:31.697
> 
> 标签：javascript, chrome-for-ios

Apple 长期以来一直阻止移动 Safari 播放声音——播放声音的常用 JavaScript 命令在它上不起作用。今天发布的 iOS 版 Chrime 浏览器是否允许播放声音？

附言。用户诱发的声音可以在两者上播放——我的问题仅涉及由 JavaScript 启动的声音。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T23:21:21.590

[适用于 iOS](https://www.google.com/intl/en/chrome/browser/mobile/ios.html)的Chrome[只是内置 Safari 浏览器的一个皮肤](http://www.pcmag.com/article2/0,2817,2406477,00.asp)。也就是说，它*不是*WebKit 的 Chrome 版本。它的行为应该与 Safari 本身相同。如果 Safari 被阻止播放声音，Chrome 浏览器也会被阻止。

# tsql - 如何使用 TSQL 从连接字符串中提取目录名称？

> ID：11252913
> 
> 赞同：0
> 
> 时间：2012-06-28T21:08:31.760
> 
> 标签：tsql, pattern-matching

假设我有以下字符串值：

```
declare @cs nvarchar(100) = 
   'Data Source=server\instance;Initial Catalog=MyDatabase;Integrated Security=True'; 
```

从中提取字符串的 T-SQL 是`MyDatabase`什么`@cs`？

或者，我应该查看哪些 T-SQL 函数来为自己解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-05T12:17:17.923

您可能会发现这要容易得多，只需将 from_table 更改为您的表并将连接字符串字段更改为您的字段。

```
SELECT SUBSTRING(SUBSTRING([ConnectionString], CHARINDEX('Initial Catalog=', [ConnectionString]) + LEN('Initial Catalog='), 100), 0, CHARINDEX(';', SUBSTRING([ConnectionString], CHARINDEX('Initial Catalog=', [ConnectionString]) + LEN('Initial Catalog='), 100)))
AS DbName
FROM [from_table] 
```

我假设在获取字符串后您可能想要执行以下操作：（
迭代名称并查询一些数据库）

```
DECLARE @DbName varchar(max)
DECLARE @QaQuery NVARCHAR(MAX);

DECLARE MY_CURSOR CURSOR 
  LOCAL STATIC READ_ONLY FORWARD_ONLY
FOR 
SELECT SUBSTRING(SUBSTRING([ConnectionString], CHARINDEX('Initial Catalog=', [ConnectionString]) + LEN('Initial Catalog='), 100), 0, CHARINDEX(';', SUBSTRING([ConnectionString], CHARINDEX('Initial Catalog=', [ConnectionString]) + LEN('Initial Catalog='), 100)))
AS Connections
FROM [ConnTable]

OPEN MY_CURSOR
FETCH NEXT FROM MY_CURSOR INTO @DbName
WHILE @@FETCH_STATUS = 0
BEGIN 
    --PRINT @DbName
    SET @QaQuery = N'SELECT TOP 10 [RecordID],[SomeStuff]
                        FROM ['+@DbName+'].[dbo].[SomeTable]
                        WHERE [SomeStuff] IS NOT NULL'
  EXEC sp_executesql @QaQuery;
  FETCH NEXT FROM MY_CURSOR INTO @DbName
END
CLOSE MY_CURSOR
DEALLOCATE MY_CURSOR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T09:20:02.950

这不是很漂亮，我相信你可以使用 regex / clr patindex & substrings 更快地做到这一点，但是一个非常快速和简单的方法是使用下面的拆分函数来做这样的事情：

**示例用法：**

```
DECLARE @cs NVARCHAR(100) = 'Data Source=server\instance;Initial Catalog=MyDatabase;Integrated Security=True';

SELECT  id ,
        Data ,
        dbo.fnParseString(2, '=', Data)
FROM    dbo.fnc_Split(@cs, ';')
WHERE   Data LIKE '%Initial Catalog%' 
```

**回报：**

```
2        Initial Catalog=MyDatabase        MyDatabase 
```

至于拆分函数，第一个将字符串拆分为表，第二个将字符串拆分为列：

**拆分成表格：**

```
CREATE FUNCTION dbo.fnc_Split
    (
      @Data VARCHAR(2000) ,
      @Sep VARCHAR(5)
    )
RETURNS @Temp TABLE
    (
      Id INT IDENTITY(1, 1) ,
      Data NVARCHAR(100)
    )
AS 
    BEGIN
        DECLARE @Cnt INT
        SET @Cnt = 1
        WHILE ( CHARINDEX(@Sep, @Data) > 0 ) 
            BEGIN
                INSERT  INTO @Temp
                        ( data
                        )
                        SELECT  Data = LTRIM(RTRIM(SUBSTRING(@Data, 1, CHARINDEX(@Sep, @Data) - 1)))
                SET @Data = SUBSTRING(@Data, CHARINDEX(@Sep, @Data) + 1, LEN(@Data))
                SET @Cnt = @Cnt + 1
            END
        INSERT  INTO @Temp
                ( data )
                SELECT  Data = LTRIM(RTRIM(@Data))
        RETURN
    END
GO 
```

**拆分为列：**

```
CREATE FUNCTION dbo.fnParseString
    (
      @Section SMALLINT ,
      @Delimiter CHAR ,
      @Text VARCHAR(MAX)
    )
RETURNS VARCHAR(8000)
AS 
    BEGIN
        DECLARE @NextPos SMALLINT ,
            @LastPos SMALLINT ,
            @Found SMALLINT

        --#### Uncomment the following 2 lines to emulate PARSENAME functionality
        --IF @Section > 0 
        --    SELECT  @Text = REVERSE(@Text)

        SELECT  @NextPos = CHARINDEX(@Delimiter, @Text, 1) ,
                @LastPos = 0 ,
                @Found = 1

        WHILE @NextPos > 0
            AND ABS(@Section) <> @Found 
            SELECT  @LastPos = @NextPos ,
                    @NextPos = CHARINDEX(@Delimiter, @Text, @NextPos + 1) ,
                    @Found = @Found + 1

        RETURN  CASE
            WHEN @Found <> ABS(@Section) OR @Section = 0 THEN NULL
            --#### Uncomment the following lines to emulate PARSENAME functionality
            --WHEN @Section > 0 THEN REVERSE(SUBSTRING(@Text, @LastPos + 1, CASE WHEN @NextPos = 0 THEN DATALENGTH(@Text) - @LastPos ELSE @NextPos - @LastPos - 1 END))
            WHEN @Section > 0 THEN SUBSTRING(@Text, @LastPos + 1, CASE WHEN @NextPos = 0 THEN DATALENGTH(@Text) - @LastPos ELSE @NextPos - @LastPos - 1 END)

            ELSE SUBSTRING(@Text, @LastPos + 1, CASE WHEN @NextPos = 0 THEN DATALENGTH(@Text) - @LastPos ELSE @NextPos - @LastPos - 1 END)
        END
    END 
```

# c# - 具有继承的 C# 强类型“发送者”事件

> ID：11252915
> 
> 赞同：0
> 
> 时间：2012-06-28T21:08:46.283
> 
> 标签：c#, events, generics, inheritance

我不确定这在 C# 中是否可行，但我希望在具有强类型化“发送者”参数的抽象类中包含事件。

有我的代码

```
abstract class Base
{
    public degate void MyDelegate(Base sender, object arg);
    public event MyDelegate SomeEvent;

    protected void RaiseSomeEvent(object arg)
    {
        if (SomeEvent != null)
            SomeEvent(this, arg)
    }
}

class Derived : Base
{
    // ?
}

var obj = new Derived();
obj += EventHandler;

public void EventHandler(Derived sender, object arg)
{

} 
```

那么，例如通过操作通用 where 子句可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:23:16.007

你绝对可以让它通用 - 但在你给出的情况下你不会真的想要。

`Base.SomeEvent`不“知道”（在编译时）它是什么类型 - 所以你不能让它依赖于某些类型参数，它将是“正确的类型”。你*可以*做一些可怕的事情，比如：

```
abstract class Base<T> where T : Base
{
    delegate void MyDelegate(T sender, object arg);

    public event MyDelegate SomeEvent;

    protected void RaiseSomeEvent(object arg)
    {
        if (SomeEvent != null)
            SomeEvent((T) this, arg)
    } 
} 
```

（您可能需要`(T) (object) this`让编译器满意。）

接着：

```
class Derived : Base<Derived> 
```

但它变得非常丑陋，没有什么可以阻止这种情况的发生：

```
class Evil : Base<Derived> 
```

那时，当事件引发时，演员表将失败。

我建议，如果您真的想确定发件人是正确的类型，请忽略该`sender`参数并首先捕获您用于订阅的变量：

```
Derived derived = new Derived();
derived.SomeEvent += (ignored, arg) => DoSomething(derived, arg); 
```

# iphone - 以相对方式访问视图

> ID：11252923
> 
> 赞同：1
> 
> 时间：2012-06-28T21:09:12.340
> 
> 标签：iphone, xcode4, uiviewcontroller

我是 xcode 的新手，我有一个关于 ViewController 中相对访问视图的基本问题。

下面是 ViewController 中的情况：

```
View
  1
    1.1
  2 
```

问题：

1.  如何从 View 访问 2
2.  如何从 2 访问 1.1
3.  如何从 1.1 访问查看

非常感谢，单行代码将是完美的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:15:58.763

1.  您可以使用标记。我不喜欢这种方法，但实施起来很快。见`viewWithTag:`。
2.  或者您可以将视图保存为实例变量。

# visual-studio - 有没有办法在程序未运行时在 Visual Studio 中获取枚举的整数值？

> ID：11252926
> 
> 赞同：1
> 
> 时间：2012-06-28T21:09:19.127
> 
> 标签：visual-studio, enums

我有几个像这样使用的大型枚举

```
switch(someEnumValue)
{
  case SomeEnum.Value1:
  DoSomething();
  break;

  case SomeEnum.Value2:
  DoSomethingElse();
  break;

  ...

  case someEnum.ValueBigNumber:
  break;
} 
```

在 Visual Studio 2010 中有没有办法让我在不实际运行程序且不手动计算枚举定义中的值的情况下查看 someEnum.SomeValue 的整数值是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-14T13:51:48.270

今天我正在寻找解决这个问题的方法。我找不到像视觉工作室扩展这样的酷解决方案。相反，我发现了一个使用模板代码解决这个问题的有用技巧！

```
template<bool, int> class Value_of_someEnumValue_is;
template<>      class Value_of_someEnumValue_is<false, someEnumValue> {};
Value_of_someEnumValue_is<true, someEnumValue> i; 
```

如果编译此代码，您将在错误消息中看到“someEnumValue”的整数值。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:17:47.197

虽然您可以直接使用实际整数值定义枚举，但没有内置任何内容，因此查看枚举声明会告诉您成员值：

```
public enum SomeEnum
{
   Value1 = 0,
   Value2 = 1,
   ...
   ValueN = 78897
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T21:27:09.030

目前尚不清楚您为什么要这样做，但要考虑一下；将枚举定义复制到 excel 中并查看行号或复制到 Visual Studio 中的新文本文件中并检查光标的行号（想想它在 ide 的右下角）。从第一个中选择值甚至可以为您提供选定的行数。

# graph - Dojo 图形工具提示箭头显示不正确

> ID：11252930
> 
> 赞同：2
> 
> 时间：2012-06-28T21:09:30.653
> 
> 标签：graph, tooltip, dojo, dojox.charting

出于某种原因，每个图形点的工具提示上的箭头出现在实际标签下方（见图）。我已尝试尽一切努力移动它，但无法弄清楚为什么会这样。工具提示由 dojo 的图表库自动生成。它在演示中看起来很好。

有人知道为什么吗？![损坏的工具提示的图像](../Images/13588b0321a1ed93026f51ce7a452f77.png)

编辑：我正在使用 Dojo 1.7.2。代码问题是 this.linePlotName 是下面方法所在的对象的一部分。

```
var anim = new dojox.charting.action2d.Tooltip(newLineChart, this.linePlotName); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T14:03:08.583

在将 Dojo 从 1.6 升级到 1.7.2 后，我遇到了同样的问题，但这个问题实际上是一个错误，现在在 1.7.3 中已修复：http: [//bugs.dojotoolkit.org/ticket/15016](http://bugs.dojotoolkit.org/ticket/15016) 升级和它应该没事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T16:27:41.290

很难说，没有看到你的代码中发生了什么。但是，重要的是要记住，工具提示的行为受它所包含的小部件/div/框架的影响。如果没有足够的空间在绘图线的顶部渲染工具提示图形，它将被绘制在它下面。尝试增加包含图表的容器的大小，并尝试增加图表本身的大小，以便在绘图线上方有足够的空间显示工具提示，或者甚至尝试向上/向下滚动。最好先排除简单的修复。:) 如果这不起作用，请发表评论，我们可以从那里开始......

# opensocial - Open Social Gadget 中的滚动问题

> ID：11252937
> 
> 赞同：0
> 
> 时间：2012-06-28T21:10:06.690
> 
> 标签：opensocial, google-gadget

我有一个应该是动态高度的小工具，它应该有滚动条。

我尝试在我的 java 类中使用这个注解：
*@ModulePrefs(scrolling = true)*

它返回以下 XML 代码：
*ModulePrefs scrolling="true"*

但我的 iframe 仍然有*“scrolling=no”*属性。

难道我做错了什么？

我将不胜感激任何帮助/提示。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T16:48:36.820

显然这是 shindig 中的一个错误，因为它会生成一个带有硬编码“scrolling=no”属性的 javascript 文件。由于这个 js 是使用 servlet 创建的，所以我覆盖了 servlet 并输入：
*replaceAll("scrolling=\"no\"", "scrolling=\"auto\"");*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T16:54:29.557

iFrame 是否滚动实际上取决于容器。容器可能会选择让您的小工具随心所欲地增长，在这种情况下您可能永远看不到滚动条。或者容器可以让 iFrame 周围的 DOM 元素滚动。如果容器变大，它甚至可以在小工具 iFrame 滚动中包含 BODY 元素。无论容器决定做什么，您的小工具所要做的就是包含动态高度功能并在它想要调整其高度时调用 gadgets.window.adjustHeight()。

至于 ModulePrefs 的滚动属性，我认为这是错误，我认为它不是有效属性。我在当前规范中看到的唯一引用是在 Gadget XML Schema [1] 中，这让我认为它在某个时候被删除了，只是没有从 XML Schema 中删除。

[1] [http://opensocial-resources.googlecode.com/svn/spec/2.0.1/Core-Gadget.xml#GadgetXmlSchema](http://opensocial-resources.googlecode.com/svn/spec/2.0.1/Core-Gadget.xml#GadgetXmlSchema)

# asp.net-mvc - ASP.NET MVC3 第二个自定义验证器方法未触发

> ID：11252938
> 
> 赞同：1
> 
> 时间：2012-06-28T21:10:07.787
> 
> 标签：asp.net-mvc, jquery-validate, asp.net-mvc-validation

我正在尝试在我的 ASP.NET MVC3 表单上实现自定义验证。

第一个自定义验证仅验证是否在文件上传输入中选择了文件。

当我只有一种客户端验证方法时，它运行良好。当我尝试添加第二个时。永远不会触发第二种验证方法。

**我的属性类中的 GetValidationRules 方法**

```
public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
{
    var rule = new ModelClientValidationRule
                   {
                       ValidationType = "file",
                       ErrorMessage = "ResumeEmptyError".Translate("fordia_subform")
                   };

    var rule2 = new ModelClientValidationRule
    {
        ValidationType = "extension",
        ErrorMessage = "ResumeFileFormatError".Translate("fordia_subform")
    };

    var list = new List<ModelClientValidationRule>();

    list.Add(rule2);
    list.Add(rule);
    return list;
} 
```

**我认为我的 javascript 代码**

```
<script type="text/javascript">
    jQuery.validator.addMethod("file", function (value, element) {
        return $('#ResumeFileName').val() != '';
    });

    jQuery.validator.addMethod("extension", function (value, element) {
        return $('#ResumeFileName').val() == 'a';
    });
    jQuery.validator.unobtrusive.adapters.add("file", function (options) {

        options.rules["file"] = options.params.param;
        if (options.message) {
            options.messages['file'] = options.message;
        }
    });
    jQuery.validator.unobtrusive.adapters.add("extension", function (options) {

        options.rules["extension"] = options.params.param;
        if (options.message) {
            options.messages["extension"] = options.message;
        }
    });
 </script> 
```

当我查看我的 HTML 源代码时，我的输入元素上有以下 HTML 属性：

```
<input data-val="true" data-val-extension="Erreur: format error" data-val-file="Required" id="Resume" name="Resume" type="file" value="" class="input-validation-error"> 
```

在此表单上使用多种客户端验证方法我缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T06:29:01.330

在您展示的脚本中，您似乎正在使用一些`options.params.param`从未声明或从您的验证属性传递的参数。因此，在目前的形式下，即使使用单一规则，您的脚本也无法正常工作。你说它正在工作，但我想你一定是在代码中改变了一些东西，因为你所展示的东西没有机会工作。

因此，如果您没有参数，您可以这样做（注意作为第二个参数传递给 add 适配器方法的空数组）：

```
jQuery.validator.addMethod("file", function (value, element) {
    return $('#ResumeFileName').val() != '';
});
jQuery.validator.unobtrusive.adapters.add("file", [], function (options) {
    options.rules["file"] = options.params;
    if (options.message) {
        options.messages['file'] = options.message;
    }
});

jQuery.validator.addMethod("extension", function (value, element) {
    return $('#ResumeFileName').val() == 'a';
});
jQuery.validator.unobtrusive.adapters.add("extension", [], function (options) {
    options.rules["extension"] = options.params;
    if (options.message) {
        options.messages["extension"] = options.message;
    }
}); 
```

如果您有参数，则需要先在属性返回的验证规则上声明它们，然后在适配器中使用它们，如[本文](https://stackoverflow.com/a/4784986/29407)所示。

# json - ios5：使用 POST 将 JSON 数据从 iPhone 发送到 REST

> ID：11252939
> 
> 赞同：1
> 
> 时间：2012-06-28T21:10:10.247
> 
> 标签：json, ios5, http-post

我正在尝试将 JSON 格式的数据发送到 REST api。发送参数时，Web 服务不返回任何数据，而是给出以下错误：解析 JSON 时出错：Error Domain=NSCocoaErrorDomain Code=3840 “无法完成操作。（Cocoa 错误 3840。）”（JSON 文本没有不以数组或对象和允许未设置片段的选项开头。）

这是因为 Web 服务无法读取该参数。但是，如果我将此参数直接添加到 URL，则会返回正确的结果例如：http://localhost:8080/de.vogella.jersey.final/rest/notes/63056

以下是发送参数的代码：

```
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://localhost:8080/de.vogella.jersey.final/rest/notes/"]];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"]; 

    NSString *postString = @"{\"notes\":\"63056\"}";
    NSLog(@"Request: %@", postString);
   // NSString *postString = @"";

    [request setValue:[NSString stringWithFormat:@"%d",[postString length]] forHTTPHeaderField:@"Content-length"];
    [request setHTTPBody:[postString dataUsingEncoding:NSUTF8StringEncoding]];

    NSData *returnData = [NSURLConnection sendSynchronousRequest: request returningResponse: nil error: nil ];
    NSLog(@"Return Data%@",returnData);

    //Getting the task types from the JSON array received  
    NSMutableArray *jsonArray =[NSJSONSerialization JSONObjectWithData:returnData options:kNilOptions error:&error];
    NSLog(@"jsonArray is %@",jsonArray);
    taskTypes =[[NSMutableArray alloc]init ];
    if (!jsonArray) {
        NSLog(@"Error parsing JSON: %@",error);
    } else {
        for(NSDictionary *taskType in jsonArray) {

            [taskTypes addObject:[taskType objectForKey:@"TaskName"]];
        }

    } 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-12T15:21:32.660

您的错误“JSON 文本没有以数组或对象开头，并且允许未设置片段的选项”可能意味着两件事：

1.  您指定您希望响应对象采用 JSON 格式，但它不是（例如，如果您使用 AFJSONRequestOperation 并且服务器返回 JSON 以外的其他内容，则会发生这种情况）

**修复**：获取服务器代码并确保它返回有效的 JSON 对象

2.  您尚未指定可以接收 JSON 以外的其他内容

**修复**：如果您使用的是 AFNetworking，请将 NSJSONReadingAllowFragments 传递给您的 AFHTTPClient 子类的 [NSJSONSerialization JSONObjectWithData:options:error:] （[使用 JSON (iOS) 向 Cocoa 错误 3840](https://stackoverflow.com/questions/14171111/cocoa-error-3840-using-json-ios)大喊此答案）。

# ruby-on-rails - Rails 模型中的实例变量

> ID：11252940
> 
> 赞同：5
> 
> 时间：2012-06-28T21:10:11.513
> 
> 标签：ruby-on-rails, model, instance-variables

我想在我的 Rails 模型中初始化一个实例变量，该变量将保存一个数组，并且我想在我的模型中的其他方法中访问这个变量。我试过这个：

```
class Participant < ActiveRecord::Base

  @possible_statuses = [
    'exists',
    'paired',
    'quiz_finished',
    'quiz_results_seen',
    'money_sent'
  ]

  def statuses
    @possible_statuses
  end 
```

但是当我使用 rails 控制台尝试以下操作时：

```
 Participant.first.statuses 
```

我返回零:(

为什么会这样？有没有办法完成我想要完成的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-28T21:12:44.113

对于这种情况，我建议使用常量：

```
class Participant < ActiveRecord::Base

  STATUSES = [
    'exists',
    'paired',
    'quiz_finished',
    'quiz_results_seen',
    'money_sent'
  ] 
```

如果您想从内部类访问该数组，只需执行`STATUSES`，并从外部类使用`Participant::STATUSES`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:52:50.183

在您的示例中，@possible_statuses 是类上的变量，而不是对象的每个实例上的变量。这是一个相当冗长的示例，说明如何完成此操作：

```
class Participant < ActiveRecord::Base

  @possible_statuses = [
    'exists',
    'paired',
    'quiz_finished',
    'quiz_results_seen',
    'money_sent'
  ]

  def self.possible_statuses
    @possible_statuses
  end

  def possible_statuses
    self.class.possible_statuses
  end

  def statuses
    possible_statuses
  end

end 
```

如其他答案中所述，如果该状态列表从未更改，则应使用常量而不是变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-17T19:16:54.647

对我来说最好的答案是创建一个类变量，而不是实例变量：

```
@@possible_statuses = [
    'exists',
    'paired',
    'chat1_ready',
    'chat1_complete'
] 
```

然后我可以在类的方法中自由地访问它：

```
 def status=(new_status)
    self.status_data = @@possible_statuses.index(new_status)
  end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-28T21:53:59.650

实例变量仅在您创建模型时存在，因为它没有存储在任何地方的数据库中。根据大雄的建议，您将希望将其设为常数。或者，你可以把它做成一个模块，比如......

```
module Status
  EXISTS = "exists"
  PAIRED = "paired"
  QUIZ_FINISHED = "quiz_finished"
  QUIZ_RESULTS_SEEN = "quiz_results_seen"
  MONEY_SENT = "money_sent"

  def self.all
    [EXISTS, PAIRED, QUIZ_FINISHED, QUIZ_RESULTS_SEEN, MONEY_SENT]
  end
end 
```

这给了你更多的控制和灵活性，IMO。您将包含嵌套在模型中的代码。

# c# - NHibernate，如何循环并获得结果？

> ID：11252948
> 
> 赞同：-1
> 
> 时间：2012-06-28T21:10:33.683
> 
> 标签：c#, nhibernate

在 NHibernate 中，如何循环并获得结果？例如，如何获得 'totalAmount' 和 'MY_CODE' ？

```
var criteria = Session.CreateCriteria<MyClass>();
ProjectionList projectionList = Projections.ProjectionList();
projectionList.Add(Projections.RowCount(), "totalAmount");
projectionList.Add(Projections.GroupProperty("MY_CODE"));
criteria.SetProjection(projectionList);

var resultList = criteria.List();
// how to get 'totalAmount' and 'MY_CODE' 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T21:17:59.693

如果我没记错的话，该查询将返回一个`object[]`. 所以你需要做

```
int totalAmount = resultList[i][0];
string myCode= resultList[i][1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:56:42.657

“如何循环并获得结果”你可以：

```
 var total = 0;
 var code = "";
 foreach(var result in resultList)
 {
      total = result[0]; // or result["totalAmount"]
      code = result[1];  // or result["my_code"]
      //then do something with em
 } 
```

# c - 编译 C 程序时出错

> ID：11252953
> 
> 赞同：0
> 
> 时间：2012-06-28T21:10:49.860
> 
> 标签：c, xcode

这是我的2个源文件：

**主.c：**

```
#include <stdio.h>
#include "part2.c"

extern int var1;
extern int array1[];

int main()
{
    var1 = 4;
    array1[0] = 2;
    array1[1] = 4;
    array1[2] = 5;
    array1[3] = 7;

    display();

    printf("---------------");

    printf("Var1: %d", var1);
    printf("array elements:");

    int x;
    for(x = 0;x < 4;++x)
        printf("%d: %d", x, array1[x]);

    return 0;
} 
```

**第 2 部分.c**

```
#include <stdio.h>

int var1;
int array1[4];

void display(void);

void display(void)
{
    printf("Var1: %d", var1);
    printf("array elements:");

    int x;
    for(x = 0;x < 4;++x)
        printf("%d: %d", x, array1[x]);
} 
```

当我尝试编译程序时，这就是我得到的：

> ld /Users/John/Library/Developer/Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Products/Debug/Test normal x86_64 cd /Users/John/Xcode/Test setenv MACOSX_DEPLOYMENT_TARGET 10.7 /Applications/Xcode.app/Contents/Developer/工具链/XcodeDefault.xctoolchain/usr/bin/clang -arch x86_64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk -L/Users/John/Library /Developer/Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Products/Debug -F/Users/John/Library/Developer/Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Products/Debug -filelist /Users/John/Library/Developer /Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Intermediates/Test.build/Debug/Test.build/Objects-normal/x86_64/Test.LinkFileList -mmacosx-version-min=10。7 -o /Users/John/Library/Developer/Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Products/Debug/Test
> 
> ld：在 /Users/John/Library/Developer/Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Intermediates/Test.build/Debug/Test.build/Objects-normal/x86_64/part2.o 和 /Users/ 中**重复符号**_display John/Library/Developer/Xcode/DerivedData/Test-blxrdmnozbbrbwhcekmouessaprf/Build/Intermediates/Test.build/Debug/Test.build/Objects-normal/x86_64/main.o for architecture x86_64 clang：错误：链接器命令失败，退出代码1（使用 -v 查看调用）

我正在使用 Xcode，这两个文件都在一个名为的 C 项目中`Test`

是什么导致了错误，我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:13:33.977

去掉“ `#include "part2.c"`”，改成“ `#include "part2.h`”

并移动您的函数声明：

```
void display(void); 
```

从“ `part.c`”文件的顶部到名为“ `part2.h`”的文件中，该文件应包含在两个 .c 文件中（或放在其顶部）。

# android - 如何在禁用触摸屏的情况下将 android 设备保持在昏暗唤醒状态？

> ID：11252959
> 
> 赞同：1
> 
> 时间：2012-06-28T21:11:15.413
> 
> 标签：android, accelerometer, wakelock

我想编写一个需要加速度计数据的应用程序，而用户将设备放在口袋里。然而，至少在我的手机上（摩托罗拉 Defy 采用夜间 CM9 构建），需要一个昏暗的唤醒锁，因为加速度计不知何故与屏幕一起关闭。但是如果屏幕保持打开状态，用户可能会随着他的身体动作触发随机触摸动作。我可以只显示一个黑色区域，但这不会保护菜单键。那么，我应该怎么做才能保护设备免受意外的用户交互呢？我想到的事情：

*   使用 root 访问权限以某种方式深入系统并需要解锁模式左右 - 但我作为用户会犹豫是否提供应用程序 root 只是因为它想阻止我的输入，如果我作为编码人员犯了错误，我可能锁定用户 -> 可能有效，但可能是最糟糕的解决方案
*   以某种方式为此使用锁定屏幕-但我不知道如何安全地，无论设备上的设置是什么，无需root即可激活该锁定屏幕

Gah，这一切对我来说看起来都很糟糕。有什么方法可以解决这个问题吗？

# biztalk - 验证编排中的消息，或接收端口

> ID：11252960
> 
> 赞同：0
> 
> 时间：2012-06-28T21:11:29.967
> 
> 标签：biztalk, biztalk-2010

我一直在假设进入编排的消息已针对消息模式进行了验证，但最近才意识到情况并非如此。似乎没有验证形状，所以我想知道是否有一个干净的可重用模式来实现这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T06:52:05.230

您可以在 XMLReceive 管道上验证消息，但不幸的是，这需要指定 DocumentSpecNames，这会降低接收的灵活性。

一种解决方法是使用自定义“ [ValidatingXmlPipeline](http://blogs.msdn.com/b/nabeelp/archive/2008/05/14/biztalk-does-not-validate-my-message.aspx) ”并向其添加 XMLValidator 管道组件。

根据您最初的问题，在分配消息变量时调用了调试下的[配置设置。](http://anantm.wordpress.com/2010/05/21/validating-the-document-in-biztalk-receive-location/)我不能说我已经使用了它，因为它可能会影响性能。`btsntsvc.config``ValidateSchemas`

# vb.net - 构造函数中的构造函数

> ID：11252963
> 
> 赞同：4
> 
> 时间：2012-06-28T21:11:42.917
> 
> 标签：vb.net, oop, constructor, initialization, instantiation

这是一个坏主意吗？在公共构造函数中调用通用私有构造函数是否会创建多个实例，或者这是初始化类变量的有效方法？

```
Private Class MyClass
    Dim _msg As String

    Sub New(ByVal name As String)
        Me.New()
        'Do stuff
    End Sub

    Sub New(ByVal name As String, ByVal age As Integer)
        Me.New()
        'Do stuff
    End Sub

    Private Sub New() 'Initializer constructor
        Me._msg = "Hello StackOverflow"
        'Initialize other variables
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T21:13:57.563

这是完全有效的，也是重用构造函数代码的常用方法。只有一个对象被实例化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:18:34.693

这是一种有效的方法。可以在哪里调用新函数有一些注意事项：

> Sub New 构造函数只能在创建类时运行一次。除了来自同一类或派生类的另一个构造函数的第一行代码之外，不能在任何地方显式调用它。

在 MSDN 上阅读有关[对象生命周期的更多信息。](http://msdn.microsoft.com/en-us/library/hks5e2k6%28v=vs.100%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-28T21:14:15.077

像这样链接构造函数肯定不会创建额外的对象实例。

最好只为初始化的某个部分编写代码一次。这是一种常见且有效的初始化模式。

# ios - 根据我的设置包中的更改添加/删除 UILocalNotification

> ID：11252974
> 
> 赞同：1
> 
> 时间：2012-06-28T21:12:45.640
> 
> 标签：ios, uilocalnotification, settings.bundle

我有一个应用程序，每天在同一时间发送通知，提醒用户输入数据。但是，我想给用户选项来禁用它，因为这可能会很烦人，所以我在自定义设置包中有一个“启用警报”。我的问题是，当用户在设置包中切换开关时，我可以添加/删除已经安排好的通知，而无需再次进入应用程序吗？

注意：我正在构建和支持 iOS 4.2.1，我不知道为什么，但在设置应用程序的“通知”下，我的应用程序没有出现。我在 ios 5.x 设备上看到它

# qthread - Qthread - 关闭线程的麻烦

> ID：11252978
> 
> 赞同：3
> 
> 时间：2012-06-28T21:13:12.053
> 
> 标签：qthread

在过去的几天里，我一直在尝试使用 QThreads 而不继承 QThread 的新的首选方法。我遇到的麻烦是当我尝试关闭我创建的一组线程时。我经常收到“在线程仍在运行时被破坏”消息（如果我在调试模式下运行，我还会收到一个分段错误对话框）。我的代码非常简单，我尝试按照我在互联网上找到的示例进行操作。

我的基本设置如下：我有一个简单的类，我想在单独的线程中运行；事实上，我想运行这个类的 5 个实例，每个实例都在一个单独的线程中。我有一个简单的对话框，其中包含一个启动每个线程的按钮和一个停止每个线程的按钮（10 个按钮）。当我单击其中一个“开始”按钮时，会创建一个新的测试类实例，创建一个新的 QThread，调用 movetothread 以将测试类对象传递给线程......另外，因为我有几个在测试类中需要移动到线程的其他成员中，我使用这些其他项目额外调用了几次 movetothread。请注意，其中一项是 QUdpSocket，虽然这可能没有意义，但我想确保可以以这种方式将套接字移动到单独的线程......我没有

线程的启动似乎一切正常。当我使用 linux top 命令查看线程是否已创建并运行时，它们会按预期显示。

当我开始停止线程时会出现问题。我随机（或看起来是随机的）得到上述错误。

在单独线程中运行的类：

```
// Declaration
class TestClass : public QObject
{
Q_OBJECT
public:
explicit TestClass(QObject *parent = 0);
QTimer m_workTimer;
QUdpSocket m_socket;

Q_SIGNALS:
void finished();

public Q_SLOTS:
void start();
void stop();
void doWork();

};

// Implementation
TestClass::TestClass(QObject *parent) :
QObject(parent)
{

}

void TestClass::start()
{
  connect(&m_workTimer, SIGNAL(timeout()),this,SLOT(doWork()));
  m_workTimer.start(50);
}

void TestClass::stop()
{
  m_workTimer.stop();
  emit finished();
}

void TestClass::doWork()
{
int j;
for(int i = 0; i<10000; i++)
  {
    j = i;
  }
} 
```

在我的主应用程序中，调用了启动第一个线程的代码（其他每个线程都存在类似的代码）：

```
mp_thread1 = new QThread();
mp_testClass1 = new TestClass();
mp_testClass1->moveToThread(mp_thread1);
mp_testClass1->m_socket.moveToThread(mp_thread1);
mp_testClass1->m_workTimer.moveToThread(mp_thread1);

connect(mp_thread1, SIGNAL(started()), mp_testClass1, SLOT(start()));
connect(mp_testClass1, SIGNAL(finished()), mp_thread1, SLOT(quit()));
connect(mp_testClass1, SIGNAL(finished()), mp_testClass1, SLOT(deleteLater()));
connect(mp_testClass1, SIGNAL(finished()), mp_thread1, SLOT(deleteLater()));
connect(this,SIGNAL(stop1()),mp_testClass1,SLOT(stop()));

mp_thread1->start(); 
```

同样在我的主应用程序中，当为特定线程（在本例中为线程 1）单击停止按钮时，将调用此代码：

```
emit stop1(); 
```

有时似乎线程被停止和销毁而没有问题。其他时候，我收到上述错误。

任何指导将不胜感激。

谢谢，

布莱恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T07:15:22.007

[http://mayaposch.wordpress.com/2011/11/01/how-to-really-truly-use-qthreads-the-full-explanation/](http://mayaposch.wordpress.com/2011/11/01/how-to-really-truly-use-qthreads-the-full-explanation/)

“最后，为了防止由于线程在被删除时还没有完全关闭而导致严重的崩溃，我们将线程的finished()（不是worker！）连接到它自己的deleteLater()槽。这将导致线程只有在完全关闭后才能删除。”

请尝试更换：

```
 connect(mp_testClass1, SIGNAL(finished()), mp_thread1, SLOT(deleteLater())); 
```

和：

```
 connect(mp_thread1, SIGNAL(finished()), mp_thread1, SLOT(deleteLater())); 
```

# c# - 将控件添加到动态创建的 GroupBox

> ID：11252979
> 
> 赞同：0
> 
> 时间：2012-06-28T21:13:22.107
> 
> 标签：c#, wpf, itemscontrol, groupbox

我使用以下方法将 GroupBoxes 动态添加到 ItemsControl：

```
string name_ = "TestName", header_ = "TestHeader"
GroupBox MyGroupBox = new GroupBox { Name = name_, Header= header_, Width = 240, Height = 150, Foreground=new SolidColorBrush(Color.FromArgb(255, 0, 0, 0)) };

MyItemsControl.Items.Add(MyGroupBox); 
```

现在我需要向这个 GroupBox 添加内容，就像创建的几个 TextBlocks 一样：

```
TextBlock MyTextBlock = new TextBlock {Text = "test"}; 
```

但我不知道该怎么做。通常对于网格或类似的东西，我只会使用 .Children.Add(MyTextBlock)，但这在这里不起作用。

此外，我必须能够再次从 ItemsControl 中删除特定项目（最好是项目的名称，在本例中为 name_）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T21:31:06.420

尝试类似的东西

```
GroupBox groupBox1 = new GroupBox();
Grid grid1 = new Grid();
TextBlock MyTextBlock = new TextBlock {Text = "test"};
groupBox1.Width = 185;
groupBox1.Height = 160;
grid1.Height =  185;
grid1.Width =  160;
grid1.Children.Add(MyTextBlock);
groupBox1.Content = grid1;
mainWindow.canvas.Children.Add(groupBox1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T21:28:55.933

GroupBox 只有一个[Content](http://msdn.microsoft.com/en-us/library/system.windows.controls.contentcontrol.aspx)属性，用于保存 ContentPresentor。您可以将网格/画布等添加到 GroupBox，然后将您的内容添加到其中。

# r - 将因子更改为 R 中的日期格式

> ID：11252989
> 
> 赞同：1
> 
> 时间：2012-06-28T21:13:51.590
> 
> 标签：r, date

我有一个格式为日期的文件`YYYY-mm`。我正在尝试为时间序列分析准备数据，因此需要将格式从因子转换为`Date`格式。

我试过的：

```
x <- '2011-11'
as.Date(as.character(a), "%Y-%m") 
```

最后一行给了我一个输出`NA`。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-28T21:22:16.100

“2011-11”不是日期（*哪一天*）？添加一天：

```
a <- '2011-11'
as.Date(paste0(a,'-01')) 
```

或使用动物园的`yearmon`课程：

```
library(zoo)
as.yearmon(a) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T21:21:41.740

“2011-11”不是日期。用于`paste(your.year.month.strs, '01', sep='-')`将 day 组件添加到您的字符串中，然后`as.Date`使用`"%Y-%m-%d"`.

# javascript - 带有新创建行的 Javascript tr 点击事件（更新 css）

> ID：11252996
> 
> 赞同：2
> 
> 时间：2012-06-28T21:14:22.697
> 
> 标签：javascript, jquery, css, html-table

我对网络开发非常陌生。我目前正在使用[tablesorter](http://tablesorter.com/docs/) jquery 插件来创建一个动态表，用户可以在其中添加和删除行。单击时更改**新**创建行的背景颜色时遇到问题。它适用于在 html 中硬编码的行。以下是相关代码：

```
$(document).ready(
    function() {
        $('table.tablesorter td').click(
            function (event) {
                $(this).parent('tr').toggleClass('rowclick');
                $(this).parent('tr').siblings().removeClass('rowclick');
        });
    }
) 
```

rowclick 是一个 CSS 类：

```
table.tablesorter tbody tr.rowclick td {
    background-color: #8dbdd8;
} 
```

我尝试将以下内容添加到添加新行的 Javascript 函数中：

```
var createClickHandler = 
        function(newrow) {
            return function(event) {
                //alert(newrow.cells[0].childNodes[0].data);
                newrow.toggleClass('rowclick');
                newrow.siblings().removeClass('rowclick');
            };
        }
row.onclick = createClickHandler(row); 
```

当我单击新行时，警报会正确显示该行第一列中的文本。但是，我的新行不响应 CSS 类。有人有想法么？

我还应该提到，在应用 clickHandler 之前，我已经更新了 tablesorter：

```
$("#TASKTABLE").trigger("update");
$("#TASKTABLE").trigger("appendCache"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T21:16:45.283

委托您的可点击`td`元素，例如：

```
$('table.tablesorter').on('click','td', function(){ 
```

`.on()`从 jQuery 1.7 开始使用：

> 从 jQuery 1.7 开始，.on() 方法提供了附加事件 > 处理程序所需的所有功能。有关从旧的 jQuery 事件方法转换的帮助，请参阅 .bind()、.delegate()、> 和 .live()。要删除与 .on() 绑定的事件，请参阅 .off()。要附加一个仅运行一次然后自行删除的事件，请参阅 .one()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:17:46.173

试试这个：

```
$(newrow).toggleClass('rowclick');
$(newrow).siblings().removeClass('rowclick'); 
```

# jms - ActiveMq，如果 Client 在 Ack 之前终止会发生什么

> ID：11252998
> 
> 赞同：4
> 
> 时间：2012-06-28T21:14:35.303
> 
> 标签：jms, activemq

我有一个持久队列，非事务性，客户端确认，消费者使用 jms.prefetchPolicy.queuePrefetch=1&wireFormat.maxInactivityDuration=50000 读取

一旦消费者处理了一条消息，它就会确认该消息。

如果消费者读取了消息，并且在它可以发送 ack 之前，进程突然终止，那么 ActiveMq 中会发生什么？（什么 ActiveMq 参数在这里起作用？）

这与消费者需要 10 分钟来处理消息有什么不同（因此消费者任务是活动的并且正在工作），ActiveMq 如何知道消息仍在处理中？（它是否监视 TCP/IP 连接，如果连接断开，它会假定消息不会被确认？）

我如何确定一条消息是否是“毒丸”，即它使消费者崩溃？（如果消费者任务没有终止，重新传递计数似乎是有效的；消息中是否有一个内部计数器显示“它已被读取 n 次而没有成功确认？”）

作为一个实验，我发送了 6 条消息，其中一条是“毒丸”（在消费者可以发送 ack 之前杀死消费者），同时运行 2 个消费者（并自动重新启动消费者以使计数达到 2 每当消费者死）。查看队列（使用 jconsole，我使用 broker.setUseJmx(true) 启用 jmx），有 4 条消息已传递，2 条正在传输中。为什么会有 2 个在飞行中而不是只有一个？

我已经阅读 ActiveMq 和 JMS 规范有一段时间了，但没有明确/确凿的答案，因此任何关于哪些参数起作用以及是否存在任何已知错误的见解都将非常有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T01:40:37.107

这纯粹是基于我对 JMS 的理解——可能并不完全正确：

*如果消费者读取了消息，并且在它可以发送 ack 之前，进程突然终止，ActiveMq 中会发生什么*

我的理解是，由于这发生在与 JMS 提供者的会话的上下文中，JMS 提供者知道会话是否不再处于活动状态或已失败，并且任何未确认为会话一部分的消息将在会话重新传递时重新传递已确立的。

*我如何确定一条消息是否是“毒丸”，即它使消费者崩溃？*

就像您提到的那样，JMS 提供程序会跟踪可能在消息头中重新传递消息的次数

*4 条消息已发送，2 条正在发送中*

不确定这一点