# StackOverflow 问答 000274000-000274999

# c# - C# 解析最佳实 践

> ID：274007
> 
> 赞同：0
> 
> 时间：2008-11-07T23:36:40.630
> 
> 标签：c#, regex, text-files

我需要解析一些已知的文件格式，其中之一是[CUSCAR](http://www.unece.org/trade/untdid/d00a/trmd/cuscar_c.htm)格式，我坚信 RegEx 会完成这项工作，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T00:34:18.500

我刚刚查看了 CUSCAR 规范，我想你会得到一些非常丑陋的正则表达式代码来解析它。如果你只解析它的一部分，你可以侥幸逃脱。您必须测试速度，因为您的主要瓶颈是 I/O。

我对来自 QWEST 的供应商文件做了类似的事情。这些野兽是分层的文本文件。解析那些糟透的！我目前正在（每天）创建和解析 4 到 5000 万行的文本文件。

有一个很好的框架叫做[FileHelpers Library](http://filehelpers.sourceforge.net/)。该框架将帮助您创建面向对象的记录表示（文本行）。它甚至有一个很好的向导来引导您创建这些代表记录的对象。它将轻松处理主细节、分隔和固定格式。

# delphi - 为什么插入符号突然在编辑字段中居中？

> ID：274009
> 
> 赞同：4
> 
> 时间：2008-11-07T23:36:57.727
> 
> 标签：delphi

我在 Delphi 2006 登录表单上有一个“用户名”TEdit。当应用程序启动时，用户被要求输入用户名。TEdit 获得焦点，并且插入符号由于某种原因被放置在其水平中心。一旦键入任何内容，插入符号就会再次左对齐，一切看起来都很正常。

也很奇怪，它并不总是这样。这种行为是几年前突然开始的（相信当时我们还在用Delphi 6）。知道可能是什么原因造成的吗？

附加信息（已被要求）：

*   问题很普遍：D2006 和 D6（我相信），5 或 6 个 Delphi 实例在尽可能多的计算机上，所有应用程序都使用该登录表单。效果仅限于表单，但不会出现在其他 TEdits 上。*   TEdit 没有填充空格（首先这样做会很奇怪）。
更多信息（11 月 13 日）：*   插入符号不完全居中，它*几乎*居中。*   目前它似乎只发生在 DLL 中。常规的可执行文件中使用了相同的登录对话框，并且在那里没有显示问题（尽管我相信它有时会出现）。*   编辑字段是密码编辑，OnChange 处理程序仅设置该表单的整数字段，该编辑字段上没有其他事件处理程序。*   我添加了另一个普通的 TEdit，它也是 ActiveControl，以便在表单显示时具有焦点（就像密码编辑一样）。我还删除了默认文本“Edit1”。现在问题以相同的方式出现在该 TEdit 中。*   如果输入了一个字符或者如果我通过控件进行选项卡，“居中”插入符号会恢复正常 - 当我回到 TEdit 时，它看起来很正常。这与密码编辑相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-20T16:45:14.970

我在 Delphi 2007 中也遇到了同样的问题，
将 TEdit 放置在通过双击网格调用的模态表单中。

我做了一些测试，从 TSpeedButton 启动相同的表单。我注意到 TEdit 的问题仅在网格聚焦时出现。

**经过更多测试后，问题似乎是 VCL 中的错误**。
在 TCustomGrid.paint 中有一个 SetCaretPos 调用，即使网格不在活动窗体上。

```
 ../..
      Focused := IsActiveControl;
      if Focused and (CurRow = Row) and (CurCol = Col)  then
      begin
        SetCaretPos(Where.Left, Where.Top);          
        Include(DrawState, gdFocused);
      end;
      ../.. 
```

上面的代码来自该代码中 Grids.pas 中的 TCustomGrid.paint，如果网格是父窗体的“activeControl”，则 Focused 设置为 true，代码不考虑窗体是否处于活动状态。

然后，如果需要重新绘制网格，则使用网格坐标调用 setCaretPos，从而导致问题中提到的错误。

该错误很难注意到，因为在大多数情况下，插入符号只是从活动表单中消失，而不是在 TEdit 中间附近闪烁。

**重现错误的步骤：**

1.  启动新的 VCL 表单应用程序。
2.  将 TStringGrid 添加到其中。
3.  向应用程序添加第二个表单，其中只有一个 TEdit。
4.  返回主窗体 (unit1) 并从网格 DblClick 事件调用 form2.showmodal。

就是这样：您可以启动应用程序并双击网格单元格。如果您将模态窗体拖离主窗体，则需要重新绘制网格，然后导致插入符号从模态窗体中消失（或者如果您非常幸运，它会出现在 TEdit 的中间）

所以，我认为 Grids.pas 需要修复。

在上面 grid.pas 的摘录中，我建议通过调用一个名为 IsFocusedControl 的新函数来替换函数 IsActiveControl 的调用：

```
// new function introduced to fix a bug
// this function is a duplicate of the function IsActiveControl
// with a minor modification (see comment)
function TCustomGrid.IsFocusedControl: Boolean;
var
  H: Hwnd;
  ParentForm: TCustomForm;
begin
  Result := False;
  ParentForm := GetParentForm(Self);
  if Assigned(ParentForm) then
  begin
    if (ParentForm.ActiveControl = Self) then
      //Result := True;            // removed by DamienD
      Result := ParentForm.Active; // added by DamienD
  end
  else
  begin
    H := GetFocus;
    while IsWindow(H) and (Result = False) do
    begin
      if H = WindowHandle then
        Result := True
      else
        H := GetParent(H);
    end;
  end;
end; 
```

这个修复（在 Delphi2007 中制作）对我来说效果很好，但不能保证。
（另外，[不要直接修改 VCL 的单位](https://stackoverflow.com/questions/1055010/how-to-recompile-a-specific-unit-from-the-vcl/1055021#1055021)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T08:21:27.637

只是几个额外的问题：

1.  这个问题是在一台电脑上还是在多台电脑上？
2.  它发生在一个应用程序上还是在所有应用程序上？
3.  它只发生在您的 Delphi 应用程序上还是所有应用程序上？

如果它只在一台电脑上，我认为这是一个奇怪的注册表设置。如果它在更多的电脑上，但你只有一台德尔福开发电脑，它仍然可能是一个注册表设置。但还有其他可能性。

你可以尝试一些测试：

1.  在开发电脑上创建一个简单的应用程序并在另一台电脑上运行它。这是否显示效果。
2.  使用一个由Delphi创建但在另一台不显示效果的pc上构建的应用程序，并在dev pc上运行它，这是否显示效果？

我真的认为这是一个注册表设置。根据您给我的信息，它从 Delphi 6 开始就发生了，并且仍在发生。它也可以是语言环境设置，但它必须在更多程序中发生。

**编辑：** 感谢您提供额外的信息。所以看起来问题可以被隔离到一个单一的形式。但它发生在所有电脑上。

您可以做的是删除编辑，然后重新添加一个新的。这样可以节省搜索奇怪的属性值。

*   TEdit 上是否有可以解释效果的事件？
*   设置了哪些属性值？（但我更喜欢看一下 dfm 和代码，因为这样我就可以重现这种效果。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T15:14:02.320

I've also noticed this behaviour in richedits.

One place in our app is a double click on a grid which displays another screen containing a RichEdit. The caret always seems to appear in the Richedit in the same place as the double click on the grid occured, ie if the dblclick was on the 3rd line of the grid, the caret will appear ~3 lines down on the edit. As soon as a key is pressed, the caret resets to the correct position of top left.

Its not limited to a certain form or pc as it happens on all developers machines and also on clients machines. The app was originally developed in Delphi 5, but the problem didn't occur (or wasn't noticed) until we moved to D2006.

Its not a particularily big problem, just... irritating.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T09:22:21.943

你确定这是一个简单的 TEdit 吗？它可能用几个空格而不是空字符串来初始化。然后 onChange 处理程序可能会在您开始键入时立即删除空格。TEdit 扩展可能将文本对齐设置为居中而不是左侧，并且仅在 onChange 上设置文本对齐。

[编辑] 请显示 TEdit 的事件处理程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-24T02:17:16.883

另一种解决方法：

在显示第二个表单之前，防止第一个表单上的网格执行 Paint 动作。代码片段如下。

```
Gird.BeginUpdate;

try

  //Show the second form here

finally

  Grid.EndUpdate;

end; 
```

# crystal-reports - Crystal Reports 8.5 分组

> ID：274010
> 
> 赞同：2
> 
> 时间：2008-11-07T23:37:06.807
> 
> 标签：crystal-reports, grouping, user-defined-fields

我使用公式 fCity 进行分组，如下所示 If {X.MailingCity} > "" Then {X.MailingCity} Else {X.City} 我的视图中有两个不同的字段（主城市和邮寄城市）

现在，这些领域包含许多农村社区，在我的报告中，我希望将这些较小的农村社区包括在它附近的主要城市中。我创建了另一个组（指定顺序）并创建了主要城市，并试图将农村城市纳入这些组。最后，我最终将许多社区归为“其他”类别。它只是从 X.MailingCity 领域而不是 X.City 或我的公式 fCity 中挑选农村社区。

我是不是把你弄糊涂了。如果有人明白我在做什么，请回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T21:38:16.623

您需要以某种方式将农村城市和主要城市联系起来，然后您可以按主要城市分组（或按公式，将主要城市归为农村）。

# regex - 基于正则表达式的随机文本生成器

> ID：274011
> 
> 赞同：33
> 
> 时间：2008-11-07T23:37:13.997
> 
> 标签：regex

我想知道是否有软件，给定一个正则表达式，当然还有一些其他的约束，比如长度，产生总是匹配给定正则表达式的随机文本。谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-10-19T19:31:05.420

[Xeger](http://code.google.com/p/xeger)有能力做到这一点：

```
String regex = "[ab]{4,6}c";
Xeger generator = new Xeger(regex);
String result = generator.generate();
assert result.matches(regex); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-04-12T18:53:57.947

是的，存在可以生成随机匹配正则表达式的软件：

*   [运行](https://github.com/asciimoo/exrex)程序
*   [脚本](https://www.npmjs.com/package/pxeger)_
*   正则[表达式-genex](https://github.com/audreyt/regex-genex)
*   [爪哇](https://github.com/bluezio/xeger)_
*   [赛格](https://github.com/crdoconnor/xeger)_
*   [通用](https://github.com/mifmif/Generex)型
*   [rxrdg](https://github.com/GoranSiska/rxrdg) , C#
*   [字符串::随机](http://search.cpan.org/~steve/String-Random-0.20/Random.pm)，Perl
*   注册[表单](https://regldg.com/)
*   [分页](https://github.com/gajus/paggern)器
*   [反向正则](https://github.com/icomefromthenet/ReverseRegex)表达式
*   [randexp.js](https://fent.github.io/randexp.js/) , Javascript
*   [白鹭](https://github.com/elarsonSU/egret), Python/C++
*   [互斥](https://github.com/fmselab/mutrex)体
*   [票价](https://github.com/moodmosaic/Fare), C#
*   [字符串](https://pypi.python.org/pypi/rstr/2.1.3)_
*   [randexp](https://github.com/benburkert/randexp) , Ruby
*   [戈尔](https://github.com/zach-klippenstein/goregen)根
*   [二进制](https://github.com/six2six/bfgex)文件
*   [正则](https://github.com/arh23/regexgen)表达式
*   [字符串生成](https://github.com/paul-wolf/strgen)器
*   随机[字符串](https://github.com/moznion/java-random-string)
*   [正则表达式展开](https://launchpad.net/regexp-unfolder)器
*   [随机](https://hackage.haskell.org/package/string-random)字符串
*   [rxrdg](https://code.google.com/archive/p/rxrdg/) , C#
*   [正则表达式::Genex](http://search.cpan.org/~bowmanbs/Regexp-Genex-0.07/lib/Regexp/Genex.pm) , Perl
*   [字符串生成](https://pypi.python.org/pypi/StringGenerator/0.2.0)器
*   [链](https://github.com/Songmu/strrand),走
*   [再生](https://godoc.org/github.com/zach-klippenstein/goregen)_
*   [雷克斯](https://www.microsoft.com/en-us/research/project/rex-regular-expression-exploration/)_
*   正则[表达式示例](https://github.com/tom-lord/regexp-examples)
*   [基因x.js](https://github.com/alixaxel/genex.js)，JavaScript
*   [基因](https://github.com/alixaxel/genex)_

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-07T23:58:13.143

所有正则表达式都可以表示为上下文无关文法。并且[已经制定了一个很好的算法，](http://www.cosc.canterbury.ac.nz/research/reports/TechReps/1997/tr_9710.pdf)用于从任何 CFG 生成给定长度的随机句子。因此，将正则表达式上转换为 cfg，应用算法，然后就完成了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-07T23:54:11.187

查看[RandExp](http://github.com/benburkert/randexp) Ruby gem。它做你想做的事，虽然只是以有限的方式。（它不适用于所有可能的正则表达式，仅适用于满足某些限制的正则表达式。）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-03-04T07:33:16.890

如果您想要 Javascript 解决方案，请尝试[randexp.js](http://fent.github.com/randexp.js/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-07T23:49:52.927

不久前，我们在 Python 中为我们编写的[RegEx 游戏](http://www.pyweek.org/e/RegExExpress/)做了*类似的事情。*我们的约束是正则表达式必须是随机生成的，并且选择的单词必须是真实的单词。您可以在此处下载完整的游戏 EXE ，并[在](http://media.pyweek.org/dl/7/RegExExpress/regex_express-1.3.zip)[此处](http://samwashburn.com/hanclinto/RegExExpress%201.3%20EXE.zip)下载Python 源代码。

这是一个片段：

```
def generate_problem(level):
  keep_trying = True
  while(keep_trying):
    regex = gen_regex(level)
    # print 'regex = ' + regex
    counter = 0
    match = 0
    notmatch = 0
    goodwords = []
    badwords = []
    num_words = 2 + level * 3
    if num_words > 18:
      num_words = 18
    max_word_length = level + 4
    while (counter < 10000) and ((match < num_words) or (notmatch < num_words)):
      counter += 1
      rand_word = words[random.randint(0,max_word)]
      if len(rand_word) > max_word_length:
        continue
      mo = re.search(regex, rand_word)
      if mo:
        match += 1
        if len(goodwords) < num_words:
          goodwords.append(rand_word)
      else:
        notmatch += 1
        if len(badwords) < num_words:
          badwords.append(rand_word)
    if counter < 10000:
      new_prob = problem.problem()
      new_prob.title = 'Level ' + str(level)
      new_prob.explanation = 'This is a level %d puzzle. ' % level
      new_prob.goodwords = goodwords
      new_prob.badwords = badwords
      new_prob.regex = regex
      keep_trying = False
      return new_prob 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-09T17:02:38.977

为时已晚，但它可以帮助新手，这是一个有用的[java 库](https://github.com/mifmif/Generex)，它提供了许多使用正则表达式生成字符串的功能（随机生成，根据它的索引生成字符串，生成所有字符串..）在[这里查看](https://github.com/mifmif/Generex)。

例子 ：

```
 Generex generex = new Generex("[0-3]([a-c]|[e-g]{1,2})");

    // generate the second String in lexicographical order that match the given Regex.
    String secondString = generex.getMatchedString(2);
    System.out.println(secondString);// it print '0b'

    // Generate all String that matches the given Regex.
    List<String> matchedStrs = generex.getAllMatchedStrings();

    // Using Generex iterator
    Iterator iterator = generex.iterator();
    while (iterator.hasNext()) {
        System.out.print(iterator.next() + " ");
    }
    // it print 0a 0b 0c 0e 0ee 0e 0e 0f 0fe 0f 0f 0g 0ge 0g 0g 1a 1b 1c 1e
    // 1ee 1e 1e 1f 1fe 1f 1f 1g 1ge 1g 1g 2a 2b 2c 2e 2ee 2e 2e 2f 2fe 2f 2f 2g
    // 2ge 2g 2g 3a 3b 3c 3e 3ee 3e 3e 3f 3fe 3f 3f 3g 3ge 3g 3g 1ee

    // Generate random String
    String randomStr = generex.random();
    System.out.println(randomStr);// a random value from the previous String list 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T23:40:54.257

而不是从正则表达式开始，您应该考虑编写一个小的上下文无关语法，这将允许您轻松生成此类随机文本。不幸的是，我知道没有工具可以直接为您执行此操作，因此您需要自己编写一些代码才能实际生成文本。如果您以前没有使用过语法，我建议您在继续之前阅读一些有关 bnf 格式和“编译器编译器”的信息......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-07T23:41:55.033

我不知道任何，虽然它应该是可能的。通常的方法是编写语法而不是正则表达式，然后为每个非终结符创建函数，随机决定扩展哪个产生式。如果您可以发布您想要生成的字符串类型以及您使用的语言的描述，我们也许可以帮助您入门。

# c# - 我如何发音.Net中的lambda表达式中使用的“=>”

> ID：274022
> 
> 赞同：159
> 
> 时间：2008-11-07T23:44:57.850
> 
> 标签：c#, .net, lambda, conventions

我很少遇到其他程序员！

当我第一次看到这个标记时，我的想法是“暗示”，因为这就是它在数学证明中的理解，但这显然不是它的意义。

那么我该如何说或读“=>”，如下所示：-

```
IEnumerable<Person> Adults = people.Where(p => p.Age > 16) 
```

还是有一种约定俗成的说法？

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2008-11-07T23:46:21.763

在阅读该运算符时，我通常会说“这样”。

在您的示例中，p => p.Age > 16 读作“P，因此 p.Age 大于 16”。

事实上，我在官方 linq 预发布论坛上问过这个问题，Anders Hejlsberg 回答说

> 我通常将 => 运算符解读为“成为”或“为哪个”。例如，
> 函数 f = x => x * 2；
> 功能测试 = c => c.City == "伦敦";
> 读作“x变成x * 2”和“c.City等于伦敦的c”

至于“去”——这对我来说从来没有意义。'p' 不会去任何地方。

在通过电话向某人阅读代码的情况下，只要他们是 C# 程序员，我就会使用“lambda”这个词——即“p lambda p dot age greater-than十六。”

在评论中，Steve Jessop 在转换的情况下提到了“映射到”——所以以 Anders 为例：

```
x => x * 2; 
```

会读

> x 映射到 x 乘以 2。

对于这种情况，这似乎比“成为”更接近代码的实际意图。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-11-08T11:23:05.070

来自[MSDN](http://msdn.microsoft.com/en-us/library/bb397687.aspx)：

> 所有 lambda 表达式都使用 lambda 运算符 =>，读作“goes to”。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-11-07T23:47:37.220

[通过电话阅读代码](http://blogs.msdn.com/ericlippert/archive/2008/05/16/reading-code-over-the-telephone.aspx)

来自埃里克·利珀特：

我个人会说 c=>c+1 为“见多识广”。我听到的一些变化：

对于投影，(Customer c)=>c.Name: "customer see become see dot name"

对于谓词，(Customer c)=>c.Age > 21: "customer see such that see dot age is greater than 21"

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-12-26T07:16:39.890

我一直称它为“wang operator”:-)

“p wang 年龄 p 大于 16”

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-07T23:47:46.457

我见过人们说，“箭”。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-07T23:48:30.060

我使用“goes to”是因为一本 LINQ 书告诉我：)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-01-24T21:14:17.107

“映射到”怎么样？它比其他选择。虽然如果 MSDN 页面似乎暗示已经有一个标准，也许您应该使用它（至少对于 C# 代码）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-01-24T21:27:39.460

“映射到”是我喜欢的发音。从数学上讲，函数将其参数“映射”到其返回值（甚至可以将函数称为“映射”），因此在编程中使用这个术语对我来说是有意义的，特别是作为函数式编程（尤其是 lambda 演算）非常接近数学。它也比“成为”、“去”等更中立，因为它并不暗示状态的改变，正如 contextfree 提到的那样。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-08T01:15:57.357

除了获取前面的作用域（在出现 lambda 表达式的地方，正常代码行范围内的所有变量和常量都可用于表达式的代码）之外，lambda 表达式本质上是内联函数的语法糖。

产生式运算符 ("=>") 左侧的值列表提供了用于调用此函数的堆栈帧的结构和内容。你可以说值列表贡献了参数声明和传递的参数。在更传统的代码中，这些决定了用于调用函数的堆栈帧的结构和内容。

结果，值“转到”表达式代码。你更愿意说“定义堆栈框架”还是“去”？:)

在用作过滤条件的布尔表达式的狭义应用中（该问题的其他答案广泛考虑的 lambda 表达式的主要用途）跳过该方法以支持代码的意图是非常合理的，这会导致“为此”同样简洁，并更多地说明了代码的含义。

但是，lambda 表达式并不是 Linq 的唯一领域，在此上下文之外，应该使用更一般的形式“goes to”。

* * *

## 但为什么“去”？

因为“填充以下代码的堆栈帧”太长了，不能一直说。我想你可以说“是/被传递给”。

显式传递的参数和捕获的变量之间的一个关键区别（如果我没记错的话——如果我错了，请纠正我）是前者通过引用传递，而后者通过值传递。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-08T02:28:45.400

我没有想太多，但我只是简洁地说“to”。它简短明了，暗示将变量传递*给*表达式。我想它可能会与数字 2（“二”）混淆，但我在说话时倾向于将“to”发音为更像“ta”。没有人（至少知道 lambdas）告诉我他们认为它模棱两可......

```
// "Func f equals x to x times two"
Func f = x=> x * 2;

// "Func test equals c to c dot City equals London"
Func test = c => c.City == "London" 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-08T19:43:49.037

我的简短回答：“c 'lambda-of' e”。尽管我坚持使用“'lambda' c 'function' e”，但我认为 lambda-of 是普遍的妥协。分析如下。

如果只是为了奇怪的答案，这是一个很好的问题。大多数翻译具有除 lambda 表达式之外的其他含义，导致了奇异的解释。作为一个老的 lambda 表达式黑客，我只是忽略了 .NET 符号，并在我的脑海中将其重写为 lambda，同时希望他们为此做了几乎任何其他事情。

* * *

对于通过电话叙述代码，您希望有人能够按顺序写下代码。当然，这是一个问题，但 lambda-arrow 或其他东西可能是你能得到的最好的，或者可能是 lambda-in，但 lambda-of 是最准确的。

问题是中缀用法以及如何命名整个事物以及左右部分的作用与在中缀位置说话时起作用的东西。

这可能是一个过度约束的问题！

* * *

我不会使用“这样”，因为这意味着右侧是左侧应该满足的谓词。这与谈论将左侧抽象为功能参数的右侧非常不同。（关于“所有 lambda 表达式”的 MSDN 声明简直令人反感且不准确。）

尽管它可能与我们所能得到的一样接近，但对“去”的一些东西感到愤怒。“Goes to”意味着转换，但并不完全有某个变量 c 可以用于 c 中的表达式。对函数的抽象有点难以捉摸。我可以习惯这一点，但我仍然渴望强调变量抽象的东西。

由于在目前使用的情况下，左侧始终是一个简单的标识符[但请等待稍后可能会混淆这一点的扩展]，我认为对于“c => 表达式”，我会阅读“c 'lambda-function' 表达式"' 甚至是 "c 'arg' 'function' 表达式"。在最后一种情况下，我可以说诸如“b 'arg' c 'arg' 'function' expression”之类的东西。

最好更清楚地说明正在引入 lambda 表达式并说出类似“'arg' b 'arg' c 'function' expression”之类的内容。

弄清楚如何将所有这些翻译成其他语言是学生的练习 [;<)。

我仍然担心“（b，c）=>表达式”和其他可能出现的变体，如果它们还没有出现的话。也许是“'args' b, c 'function' 表达式”。

* * *

在所有这些沉思之后，我注意到我开始将“c => e”翻译为“'lambda' c 'function' e”，并注意到要通过上下文来理解精确形式的映射：λc(e ), c => e, f**其中**f(c) = e 等。

我希望“直接”的解释会占上风，因为这是占主导地位的大多数人第一次看到 lambda 表达式的地方。这真遗憾。一个好的折衷方案可能是“c ' **lambda-of** ' e”

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-04-29T03:45:19.160

如果您将 lambda 表达式想象为它的匿名方法，那么“goes to”就足够有意义了。

```
(n => n == String.Empty) 
```

n “转到”表达式 n == String.Empty。

它转到匿名方法，因此您不必转到代码中的方法！

对此感到抱歉。

老实说，我不喜欢在脑海中使用“goes to”，但我看到其他人说这似乎很奇怪，我想我会澄清这一点。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-07T23:49:19.947

部分问题在于，您可以根据其结构不同大声朗读。可惜它不像 ruby​​ 的 |'s 那样漂亮或集成。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-30T20:41:07.130

在 Ruby 中，同样的 sybmol 称为“hashrocket”，我听说 C# 程序员也使用这个术语（尽管这样做是错误的）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-08T16:57:48.277

我的两分钱：

```
s => s.Age > 12 && s.Age < 20 
```

“带有参数 s 的 Lambda 表达式是 { `return s.Age > 12 && s.Age < 20;`}”

我喜欢这个，因为它让我想起了 lamdba 表达式的来源

```
delegate(Student s) { return s.Age > 12 && s.Age < 20; }; 
```

=> 只是一个快捷方式，因此您不必使用委托关键字并包含类型信息，因为它可以由编译器推断。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-02-29T16:16:21.717

我的 => 术语应用于显示结果的示例

```
'result = s => s.Age > 12 && s.Age < 20' 
```

s 其中 s.Age 大于 12 且 s.Age 小于 20

```
'result = x => x * 2' 
```

x 其中 x 乘以 2

```
'result = c => c.City == "London"' 
```

c 其中 c.city 相当于“伦敦”

```
'result = n => n == String.Empty' 
```

n 其中 n 是一个空字符串

# regex - 正则表达式：浏览器之间的差异

> ID：274024
> 
> 赞同：1
> 
> 时间：2008-11-07T23:46:14.183
> 
> 标签：regex, cross-browser, consistency

我越来越意识到浏览器解释正则表达式的方式肯定存在重大差异。
例如，一位同事编写了这个正则表达式，以验证上传的文件是否具有 PDF 扩展名：

```
^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))(.pdf)$ 
```

这适用于 Internet Explorer 和 Google Chrome，但不适用于 Firefox。测试总是失败，即使是实际的 PDF。所以我认为额外的东西是无关紧要的，并将其简化为：

```
^.+\.pdf$ 
```

现在它在 Firefox 中运行良好，并且继续在 IE 和 Chrome 中运行。
这是 ASP.NET 中的 asp:FileUpload 和 RegularExpressionValidator 控件特有的怪癖，还是仅仅是因为不同的浏览器以不同的方式支持正则表达式？无论哪种方式，您遇到过哪些后者？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T01:47:53.140

关于实际问题：原始正则表达式要求该值以驱动器号或 UNC 设备名称开头。Firefox 很可能根本不将其包含在文件名中。另请注意，如果您有任何跨平台的意图，那么无论浏览器如何，该正则表达式都会在任何非 Windows 系统上失败，因为它们不使用驱动器号或 UNC 路径。您的简化正则表达式（“接受任何东西，只要它以 .pdf 结尾”）与您将获得的文件名检查一样好。

*但是*，乔纳森对原始问题的评论怎么强调都不过分。永远，永远，*永远*不要相信文件名是确定其内容的充分手段。或者 MIME 类型，就此而言。与您的 Web 服务器（甚至可能不是浏览器）通信的客户端软件可能会在任何事情上对您撒谎，除非您验证它，否则您永远不会知道。在这种情况下，这意味着将接收到的文件输入到一些可以理解 PDF 格式的代码中，并让该代码告诉您它是否是有效的 PDF。检查文件名可能有助于防止人们尝试提交明显不正确的文件，但这并不足以对收到的文件进行测试。

（我知道您可能知道需要进行额外验证，但下一个遇到类似情况并发现您的问题的人可能不知道。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T00:32:24.993

据我所知，Firefox 不会让您拥有完整的上传路径。在这种情况下，正则表达式的解释似乎无关紧要。我还没有看到现代浏览器在正则表达式执行方面的任何区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T23:59:20.117

如果您使用的是 javascript，则不使用斜杠将正则表达式括起来会导致 Firefox 出错。

尝试做`var regex = /^(([a-zA-Z]:)|(\\{2}\w+)\$?)(\\(\w[\w].*))(.pdf)$/;`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T02:04:37.367

正如 Dave 所提到的，Firefox 不提供路径，只提供文件名。正如他所提到的，它没有考虑操作系统之间的差异。我认为您可以做的最好的检查是检查文件名是否以 PDF 结尾。此外，这并不能确保它是有效的 PDF，只是文件名以 PDF 结尾。根据您的需要，您可能希望通过检查内容来验证它实际上是 PDF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T00:42:15.473

我没有注意到浏览器之间在模式语法方面的差异。但是，我注意到 C# 和 Javascript 之间的区别，因为 C# 的实现允许反向引用，而 Javascript 的实现则不允许。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T16:15:59.363

我相信 JavaScript RE 是由 ECMA 标准定义的，我怀疑 JS 解释器之间存在许多差异。我没有在我的程序中找到任何内容，也没有在文章中看到任何内容。

您的消息实际上有点令人困惑，因为您将 ASP 东西扔在那里。当您谈论服务器端技术或生成的代码时，我不明白您如何得出结论是浏览器的错。实际上，我们甚至不知道您是在谈论浏览器上的 JS，上传字段的验证（您不能再这样做，至少以简单的方式，使用 FF3）还是在服务器端（FF 和 Opera 都不是） Safari也没有上传上传文件的完整路径。我很惊讶Chrome确实喜欢IE ...)。

# windows - 给定崩溃偏移量、.PDB 和源代码，我如何找到源代码行？

> ID：274034
> 
> 赞同：18
> 
> 时间：2008-11-07T23:49:22.960
> 
> 标签：windows, debugging

我有一个 Windows 事件日志条目，给出了触发应用程序崩溃的失败调用的偏移量。我有一个发布版本、相应的 .PDB 文件和源代码。

我没有 .MAP 或 .COD 文件。

如何找到失败的源代码行？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-08T01:36:01.700

WinDbg 有一个`ln`命令可以为您提供最近的地址符号。

使用以下命令打开您的二进制文件：

```
WinDbg -z somebin.dll 
```

在命令窗口中，键入：

```
ln <address> 
```

找到它所在的功能后，运行

```
uf somebin!SomeFunc 
```

找到离地址最近的线路。

# asp.net-mvc - 解决 Controller 和 Action 上的 FilterAttributes

> ID：274039
> 
> 赞同：3
> 
> 时间：2008-11-07T23:53:24.900
> 
> 标签：asp.net-mvc

我想这样做：

```
[RequiresAuthentication(CompanyType.Client)]
public class FooController
{    
     public ActionResult OnlyClientUsersCanDoThis()

     public ActionResult OnlyClientUsersCanDoThisToo()

     [RequiresAuthentication]
     public ActionResult AnyTypeOfUserCanDoThis() 
```

您可以看到为什么这不起作用。在第三个操作中，控制器级别的过滤器将阻止非客户端。相反，我想“解决”冲突的过滤器。我希望更具体的过滤器（动作过滤器）总是获胜。这看起来自然而直观。

曾几何时，filterContext 为执行操作暴露了 MethodInfo。那会让这很容易。我考虑过使用路线信息自己做一些反思。那是行不通的，因为它可能会超载操作，我无法判断哪个是当前正在执行的操作。

另一种方法是在控制器级别或动作级别对过滤器进行范围过滤，但不要混合，这会产生很多额外的属性噪音。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T05:50:47.660

我们正在寻找一种公开其他过滤器的方法，但没有任何承诺。

将过滤器应用于控制器并不是真正的“范围”，它只是将其应用于所有过滤器的简写。不幸的是，这意味着您不能只包含一项操作。您可以做到这一点的一种简单方法是将一种方法放在另一个控制器中。您甚至可以为这种情况添加自定义路由，这样 URL 就不必更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-13T20:49:23.107

您可以将授权逻辑放入控制器的 OnActionExecuting(..) 方法中，即

```
public override void OnActionExecuting(ActionExecutingContext filterContext) {
    base.OnActionExecuting(filterContext);
    new RequiresAuthentication()
    { /* initialization */ }.OnActionExecuting(filterContext);
} 
```

希望这可以帮助，

托马斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-29T08:00:27.120

您可以使用控制器上的通用身份验证过滤器和操作上的特定身份验证过滤器更改过滤器顺序。不知何故像这样：

```
[RequiresAuthentication]
public class FooController
{
  [RequiresAuthentication(CompanyType.Client)]
  public ActionResult OnlyClientUsersCanDoThis()

  [RequiresAuthentication(CompanyType.Client)]
  public ActionResult OnlyClientUsersCanDoThisToo()

  public ActionResult AnyTypeOfUserCanDoThis() 
```

# c# - 如何在 C# 中的类上创建扩展方法？

> ID：274049
> 
> 赞同：3
> 
> 时间：2008-11-07T23:59:09.960
> 
> 标签：c#, extension-methods

我想为字符串编写一个扩展方法，它在 System.String 上显示为静态方法 - 我还没有设法完成。

那可能吗？如果有怎么办？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-08T00:05:51.583

这是不可能的。扩展方法允许您添加看起来像实例方法的东西，而不是静态方法。

# java - 长寿的 JMS 会话。保持 JMS 连接/JMS 会话是否总是一种不好的做法？

> ID：274051
> 
> 赞同：10
> 
> 时间：2008-11-07T23:59:13.297
> 
> 标签：java, jms

保持 JMS 连接/会话/消费者总是打开一个不好的做法吗？

代码草稿示例：

```
// app startup code

ConnectionFactory cf = (ConnectionFactory)jndiContext.lookup(CF_JNDI_NAME);
Connection connection = cf.createConnection(user,pass);
Session session = connection.createSession(true,Session.TRANSACTIONAL);
MessageConsumer consumer = session.createConsumer(new Queue(queueName));
consumer.setMessageListener(new MyListener()); 
connection.start();
connection.setExceptionListener(new MyExceptionHandler()); // handle connection error

// ... Message are processed on MyListener asynchronously ...

// app shutdown code

consumer.close();
session.close();
connection.close(); 
```

有什么建议可以改进这种 JMS 使用模式吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-10T10:51:29.843

同意。这里有一些[关于如何有效使用 JMS 的好技巧](http://activemq.apache.org/how-do-i-use-jms-efficiently.html)，包括保持连接/会话/生产者/消费者。

如果您对最大化性能感兴趣，您可能还想查看[有关使用事务的建议。](http://activemq.apache.org/should-i-use-transactions.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T02:01:56.653

在处理长期连接时，这是一种非常普遍且可接受的做法。实际上，对于许多 JMS 服务器来说，每次需要时都创建一个新连接更可取。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-30T03:42:38.030

选择保持连接/会话/生产者/消费者是否长时间打开应该基于生产者/消费者发送/接收消息的频率。

如果生产者发送或消费者频繁接收消息，则连接/会话/生产者/消费者应保持打开状态。另一方面，如果消息发送/接收不频繁，那么让这些 JMS 对象保持打开状态将消耗系统资源（如套接字）是不好的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-10T21:46:24.033

在我们的应用程序中，我们将一次打开数月的连接/会话/消费者/生产者。我们不得不与我们的供应商 (BEA) 合作，以使这项工作可靠。但任何与此相关的问题都是供应商需要修复的错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-10-24T11:34:01.867

FYI, there is no need to close the sessions, producers, and consumers of a closed connection( [javax.jms.Connection](http://grepcode.com/file/repo1.maven.org/maven2/org.codehaus.fabric3.api/javax-jms/1.1.1/javax/jms/Connection.java?av=f#276) ). The code below should be enough to release the resources:

```
try { 
        this.connection.close();
    } catch (JMSException e) {
        //
    } 
```

# c# - 如何在数据绑定中继器中创建条件内容

> ID：274056
> 
> 赞同：4
> 
> 时间：2008-11-08T00:01:01.920
> 
> 标签：c#, asp.net, dynamic, user-controls, repeater

我正在设置一个由 XML 配置驱动的用户控件。用例子来解释更容易。看看下面的配置片段：

```
<node>
  <text lbl="Text:"/>
  <checkbox lbl="Check me:" checked="true"/>
</node> 
```

我试图实现将该片段转换为单个文本框和复选框控件。当然，如果代码片段包含更多节点，则会自动生成更多控件。

鉴于任务的迭代性质，我选择使用Repeater。在其中我放置了两个（更多，见下文）控件，一个 CheckBox 和一个 Editbox。为了选择激活哪个控件，我使用了内联 switch 命令，检查当前配置节点的名称。

可悲的是，这行不通。问题在于，在数据绑定发生很久之后，切换是在渲染期间运行的。仅此一项就不是问题，不是因为配置节点可能会为数据绑定提供所需的信息。考虑一下如果复选框控件将尝试绑定到上面代码片段中的文本节点，拼命寻找它的“已选中”属性会发生什么。

任何想法如何使这成为可能？

谢谢，波阿斯

这是我当前的代码：

这是我的代码（运行的语法比上面的更复杂）：

```
<asp:Repeater ID="settingRepeater" runat="server">
        <ItemTemplate>
           <% 
              switch (((XmlNode)Page.GetDataItem()).LocalName)
              {
                 case "text":
           %>
           <asp:Label ID="settingsLabel" CssClass="editlabel" Text='<%# XPath("@lbl") %>' runat="server" />
           <asp:TextBox ID="settingsLabelText" Text='<%# SettingsNode.SelectSingleNode(XPath("@xpath").ToString()).InnerText %>'
              runat="server" AutoPostBack="true"  Columns='<%#  XmlUtils.OptReadInt((XmlNode)Page.GetDataItem(),"@width",20) %>'
              />
           <% break;
                 case "checkbox":
           %>
           <asp:CheckBox ID="settingsCheckBox" Text='<%# XPath("@lbl") %>' runat="server"
                         Checked='<%# ((XmlElement)SettingsNode.SelectSingleNode(XPath("@xpath").ToString())).HasAttribute(XPath("@att").ToString()) %>'
            />
          <% break;
              } %>
           &nbsp;&nbsp;
        </ItemTemplate>
     </asp:Repeater> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-09T22:35:47.897

一个周末后，这是我提出的解决方案。我的主要目标是找到既可以工作又可以让您在标记中继续指定项目模板的确切内容的东西。从代码中做事会起作用，但仍然很麻烦。

代码应该是直截了当的，但问题的要点在于两部分。

第一个是使用Repeater item created 事件来过滤掉模板中不需要的部分。

第二个是存储在 ViewState 中做出的决定，以便在回发期间重新创建页面。后者至关重要，因为您会注意到我使用了 Item.DataItem 。在回发期间，控件重新生成在页面生命周期的早期发生。当 ItemCreate 触发时，DataItem 为空。

这是我的解决方案：

**控制标记**

```
 <asp:Repeater ID="settingRepeater" runat="server" 
            onitemcreated="settingRepeater_ItemCreated" 
          >
        <ItemTemplate>
             <asp:PlaceHolder  ID="text" runat="server">
                  <asp:Label ID="settingsLabel" CssClass="editlabel" Text='<%# XPath("@lbl") %>' runat="server" />
                  <asp:TextBox ID="settingsLabelText"  runat="server"
                      Text='<%# SettingsNode.SelectSingleNode(XPath("@xpath").ToString()).InnerText %>'
                     Columns='<%#  XmlUtils.OptReadInt((XmlNode)Page.GetDataItem(),"@width",20) %>'

                   />

            </asp:PlaceHolder>
            <asp:PlaceHolder ID="att_adder" runat="server">
               <asp:CheckBox ID="settingsAttAdder" Text='<%# XPath("@lbl") %>' runat="server"
                             Checked='<%# ((XmlElement)SettingsNode.SelectSingleNode(XPath("@xpath").ToString())).HasAttribute(XPath("@att").ToString()) %>'
                />
            </asp:PlaceHolder>
      </ItemTemplate>
  </asp:Repeater> 
```

*注意：*为了更加方便，我添加了 PlaceHolder 控件来对事物进行分组，并更容易决定删除哪些控件。

**背后的代码**

下面的代码是建立在每个转发器项都是一个类型的概念之上的。类型是从配置 xml 中提取的。在我的特定场景中，我可以通过 ID 将该类型设置为单个控件。如果需要，这可以很容易地修改。

```
 protected List<string> repeaterItemTypes
   {
      get
      {
         List<string> ret = (List<string>)ViewState["repeaterItemTypes"];
         if (ret == null)
         {
            ret = new List<string>();
            ViewState["repeaterItemTypes"] = ret;
         }
         return ret;
      }
   }

   protected void settingRepeater_ItemCreated(object sender, RepeaterItemEventArgs e)
   {
      string type;
      if (e.Item.DataItem != null)
      {
         // data binding mode..
         type = ((XmlNode)e.Item.DataItem).LocalName;
         int i = e.Item.ItemIndex;
         if (i == repeaterItemTypes.Count)
            repeaterItemTypes.Add(type);
         else
            repeaterItemTypes.Insert(e.Item.ItemIndex, type);
      }
      else
      {
         // restoring from ViewState
         type = repeaterItemTypes[e.Item.ItemIndex];
      }

      for (int i = e.Item.Controls.Count - 1; i >= 0; i--)
      {
         if (e.Item.Controls[i].ID != type) e.Item.Controls.RemoveAt(i);
      }
   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T02:30:53.070

你需要看起来更像这样的东西：

```
<ItemTemplate>
    <%# GetContent(Page.GetDataItem()) %>
</ItemTemplate> 
```

然后在代码隐藏中生成所有控件。

# .net - .NET 名称生成器

> ID：274062
> 
> 赞同：8
> 
> 时间：2008-11-08T00:05:15.783
> 
> 标签：.net, generator

有没有人写过或知道一个库，可以生成相当准确的西欧风格名称？即 John、Susan、Smith、Julien、April 等，等等……

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T00:10:00.123

不确定这是否可行，但检查[FakeNameGenerator](http://www.fakenamegenerator.com/)它将生成名称和一些信息。一次一个或一批。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-05T23:41:33.883

我创建了一个 .net 随机名称生成库 (dll)，它使用 HanClinto 提到的列表（即[美国人口普查名称列表](http://www.census.gov/genealogy/names/names_files.html)）中的数据。它允许您生成名字和姓氏或仅生成名字或姓氏。您还可以生成特定的男性或女性名字，或者让它随机确定名字的性别。

[您可以在此博客文章中试用或下载](http://www.markdavidrogers.com/random-name-generator-net-library/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T00:12:09.293

我只是抓取[美国人口普查名单](http://www.census.gov/genealogy/names/names_files.html)并从中随机选择。男性名单只有 41k —— 不算太大，尤其是压缩后。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T00:07:03.033

如果您的目标是数据库，[RedGate 数据生成器](http://www.red-gate.com/Products/SQL_Data_Generator/)是一个不错的选择。

Visual Studio 数据库版也有类似的功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T00:09:35.413

Jon Galloway 在他的博客上写了一篇关于名称生成的帖子 -[生成随机假姓氏](http://weblogs.asp.net/jongalloway/code-puzzle-2-generate-random-fake-surnames)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T00:09:18.863

为什么不直接抓取姓名列表并从列表中随机选择一个呢？我怀疑是否会有一种特殊的方式来“生成”现实的名字。

[http://www.ssa.gov/OACT/babynames/](http://www.ssa.gov/OACT/babynames/)

您*可以*尝试使用此列表生成[马尔可夫链](http://en.wikipedia.org/wiki/Markov_chain)，这可能会产生一些有用的结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T00:12:31.913

我所知道的唯一名称生成器使用统计分析来分析名称，并在此基础上创建新名称。[它不完全是一个“库”，但它有示例 C++ 代码以及算法，可能只需要一两个小时即可实现；或者您可以将其编译为 C++/CLI](http://www.gamasutra.com/features/19990917/infinite_03.htm)。页面上的示例使用了任意文本，但如果您使用一堆名称，那么我很确定它会顺利进行。

# windows-mobile - 构建自动化：MSBuild 与 Windows Mobile SDK

> ID：274064
> 
> 赞同：2
> 
> 时间：2008-11-08T00:07:01.193
> 
> 标签：windows-mobile, msbuild, build-process, continuous-integration, build-automation

我正在尝试自动化我正在处理的项目的构建。我的最终目标是最终拥有一个持续集成服务器，到目前为止一切都很好。为了找出我可以为我的项目进行的最小设置，我开始配置一个新安装的系统，并偶然发现了安装 Visual Studio IDE 以安装 Windows Mobile 5 SDK 的要求。我觉得在构建服务器上拥有一个成熟的 IDE 是不对的。有没有人尝试过使用 WM 5.0 项目实际自动化构建？它们完全可以自动化吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T16:53:07.463

虽然我同意在 CI 或构建服务器上安装 IDE 不是一个好主意，但不幸的是你是对的。

要安装 Mobile SDK 5，您需要安装 Visual Studio（2005 或 2008）。您还需要根据您的构建机器操作系统安装移动设备中心/ActiveSync。如果您正在为构建机器（例如 Windows Server 2008）运行服务器操作系统，则必须启用“桌面体验”和/或安装 Windows Media Player 以安装 SDK（是的，这很奇怪），这是安装所需的移动设备中心/ActiveSync。

我们目前有 Windows Server 2008 构建机器来构建和测试我们的产品，其中包括重要的 Windows Mobile / .NET CF 代码库。我们的构建甚至创建了移动 CAB 安装，所以***是的，它是可能的***。

我们目前正在使用[TeamCity](http://www.jetbrains.com/teamcity/) for CI，这是一款出色的产品，我强烈推荐。使用[TeamCity](http://www.jetbrains.com/teamcity/)允许构建代理位于不同的机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T02:52:19.877

我没有使用 Windows Mobile 构建自动化的经验，但我确实有使用通用构建服务器的经验。

如果您计划使用诸如 msbuild 和 mstest 之类的东西来自动化您的构建过程，我相当肯定您将需要以任何一种方式安装 Visual Studio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T10:37:15.007

您可以单独安装 de SDK 以使用 msbuild。
在 Continuos 集成服务器上安装 IDE 不是一个好主意。这就是我们使用 NUnit 而不是 mstest 的原因。

# c++ - 在整个项目中搜索包含在 Eclipse CDT 中

> ID：274066
> 
> 赞同：7
> 
> 时间：2008-11-08T00:07:43.233
> 
> 标签：c++, eclipse, eclipse-cdt

我有一个庞大的现有 c++ 代码库。通常，代码库的用户使用 gvim 编辑源代码，但我们想开始使用 Eclipse 中漂亮的 IDE 功能。代码库有一个广泛的目录层次结构，但是由于我们在构建过程中使用了一些巫术，源文件使用了没有路径的包含指令。当我在 Eclipse 中将源链接到我的项目时，索引器抱怨它找不到任何头文件（因为我们没有在包含中指定路径。）如果我手动将工作区中的目录添加到包含路径，那么一切都很好，但显然手动添加数百个目录是不可行的。是否有一种简单的方法可以告诉 Eclipse 在项目中的任何位置查找包含文件，而不必一个一个地添加它们？如果不，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T01:49:26.820

CDT 管理构建路径的方式是查看项目目录基础中的 .cdtbuild xml 文件（它在 Windows 上可能是不同的名称......不确定）

在这你应该看到类似

```
<option id="gnu.c.compiler.option.include.paths....>
<listoptionValue builtIn="false" value="&quot;${workspace_loc:/some/path}$quot;" />
<listOptionValue ... />

...
</option> 
```

这是放置您在 gui 中配置的所有构建路径的位置。使用简单的 perl 脚本来遍历项目并生成所有 listOptionValue 条目，将所有目录添加到此应该很容易。

这显然不是理想的方法。但我很好奇，你从什么构建系统迁移，如果它是基于 make 的，你应该能够让 eclipse 使用你的 make 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-06T17:57:35.800

此功能已在当前的 CDT 开发流程中实现，并将在 CDT 6.0 中提供，CDT 6.0 将于 2009 年 6 月与 Eclipse 3.5 一起发布。

基本上，如果您有一个#include 并且头文件存在于您的项目中，那么 CDT 将能够找到它，而无需手动设置包含路径。

如果您现在需要该功能，您可以下载并安装最新的 CDT 开发版本。

Eclipse Bugzilla：[https://bugs.eclipse.org/bugs/show_bug.cgi?id=21356](https://bugs.eclipse.org/bugs/show_bug.cgi?id=21356)
最新 CDT 6.0 版本：[http://download.eclipse.org/tools/cdt/builds/6.0.0/index.html](http://download.eclipse.org/tools/cdt/builds/6.0.0/index.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-13T15:38:05.547

通过阅读[这个 Eclipse CDT FAQ 条目](http://wiki.eclipse.org/index.php/CDT/User/FAQ#I_am_using_a_non_gnu_compiler_and_I_get_the_following_messages:_.22Error_launching_external_scanner_info_generator_.28gcc_-E_-P_-v_-dD.22_and_.22File_not_indexed_because_it_was_not_built_.22._How_do_I_get_rid_of_them.3F)，如果您从 Eclipse 中启动构建并且如果您的构建在实际启动/之前输出`gcc`/`g++`命令，则听起来 Eclipse 可以自动生成包含目录的列表。您可以通过在 Project Properties 下选择 C/C++ Build 类别并在对话框右侧查找 Build Command 选项来更改 Eclipse 启动构建的方式。`gcc``g++`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T03:55:57.470

根据您在构建过程中执行的 voodoo 数量，Eclipse 可能无法正确解析您的源文件，尤其是当您为不同的源文件具有类似命名的标头时。如果您真的想充分利用 Eclipse，您将需要确保无论您有什么设置，您都不会混淆解析器。我个人建议有一个简单的布局和构建过程。

至于手头的问题，一一添加目录几乎是您最好的选择。

# database-design - 使用 O/R 映射时从哪里开始设计？对象还是数据库表？

> ID：274090
> 
> 赞同：9
> 
> 时间：2008-11-08T00:28:49.743
> 
> 标签：database-design, orm

我正在启动一个新的数据库应用程序，我想知道是从对象（使用 UML）开始设计并相应地构建数据库模式，还是从数据库设计（使用 ER）开始并创建对象会更好因此。

两种方法的优缺点是什么？

（我认为这并不重要，但以防万一：我打算使用 Java 和 Hibernate）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-08T00:47:50.173

取决于您的应用程序是为满足用户需求而设计的，还是为满足开发人员的需求而设计的。

从用户故事开始，直接了解 OOP 类。你的用户会喜欢你的。

否则，您最终会得到一个将用户变成数据输入员的应用程序。（你会有很多陪伴。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T00:46:25.853

从数据库入手的优点是您将考虑到性能和 DBA。

从 OOP 方面开始的优点是您将拥有更纯粹的 OO 设计，但您的 ORM 可能表现不佳。

我发现黑盒 ORM 的局限性太大，所以我的系统都是手工编码或生成和修改的代码，所以我的数据库通常非常紧凑，我的 OO 模型是纯的。我坚信聪明的人是解决阻抗不匹配的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-08T15:29:41.360

这取决于你的优势在哪里，以及你想去哪里。

如果您从正确的位置开始，您可以从对象开始，并且做得很好，包括在数据库中进行良好的表设计。

从面向对象的分析开始，而不是面向对象的设计。我不能足够强烈地强调分析和设计之间的区别。写面向对象分析的人，其中一些人使用 UML 作为工具，试图清楚地做出这种区分。分析属于问题域，而设计属于解决方案域。无论您的方法是否面向对象，这些都可以很容易地相互混淆。

如果您对项目的需求进行了良好的 OOA 分析，您可能可以合理地并行构建概念数据模型，并使这两者保持同步。当你建立一个概念数据模型时，我建议你保留一个像 ER 模型这样的模型。

ER 模型不会告诉您如何设计数据库。这就是重点。在数据建模中将分析关注点与设计关注点分开的方法是使用 ER 建模进行分析，使用关系数据建模进行设计，至少在开始时是这样。

OOA 和 ER 之间的映射非常简单，因此您可以并行管理这两个模型。可能有更新的工具可以为您管理这两种模型。ER 和 RDM 之间的映射看似简单。在最简单的映射中，您将每个实体转换为以实体身份为键的表，并将每个关系转换为以引用实体的外键为键的单独表。通过将一些外键插入实体表来减少表的数量是可能且可取的，但这是一个细节。

从OOA，您继续进行设计的OOD和编程的OOP。

从 ER 进行概念数据建模，您继续到 RDM 进行逻辑数据建模，并继续使用 DBMS 特定的 SQL 方言进行物理数据建模。如果您的项目太大而无法在纸或白板上建模，那么肯定有工具可以帮助您。

定期地，你构建你已经拥有的东西，也许为未构建的部分使用存根，然后你将你的应用程序设计与你的数据库设计相协调。如果你做得好，在一天结束的时候，你应该处于相当好的状态。

如果您同时设计一个数据库和多个应用程序，事情会变得非常有趣。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T00:41:18.237

从数据库级别开始肯定会让您创建一个更容易由常规关系数据库处理的数据库。因此，如果您希望获得数十万甚至数百万个对象，这就是我会采取的方法。但是，如果您不希望获得那么多数据，或者如果性能无关紧要，我会选择对象方法，因为它允许您建模一个更适合您的实际应用程序的解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T00:47:47.007

这取决于您希望在哪里获得最佳性能。如果您希望数据库成为您的瓶颈，那么请从那里开始设计，以便您可以调整它的性能。如果您只使用数据库来保存一些需要在应用程序中执行的对象的状态，那么请相应地设计它们。O/R 映射软件在性能调优方面不如一个好的编译器可靠（目前，而且它们不会很快赶上）。您仍然会在性能设计方面做得更好（尽管前期开发成本更高）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-08T00:58:58.090

如果您正在编写 OO 应用程序，那么我发现首先设计对象是开始的地方。我宁愿创建一个好的 OO 设计，然后尝试优化数据库，而不是构建数据库，然后尝试将对象适合数据库。

ORM 工具使您可以自由地将注意力集中在对象设计上。

但是，它并不能取代好的数据库设计。您仍然需要密切关注数据库。我发现经过仔细考虑，可以完成 OR 映射，从而使创建的数据库得到相当优化。如果您发现某些查询表现不佳，您可以随时查看查询并尝试优化它们。

您不必构建符合数据库模型的应用程序，数据库应该设计为支持您的应用程序。ORM 工具确实允许您创建优化的数据库和查询。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T01:18:10.423

那要看。你是在做面向对象编程还是面向 SQL 编程？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T01:54:32.927

任何一种方法都可以工作，并且每种方法都有其优点和缺点。以数据库为中心的方法非常适合许多共享数据的应用程序。以对象为中心的方法非常适合启动和运行单个应用程序。

如果数据库不存在，我会考虑构建应用程序而不用担心它。也许像 db4objs 这样的东西会在您将应用程序发展成有用的东西时为您提供所需的对象持久性。后来，当设计新的应用程序来共享数据，或者临时查询变得重要时，关系数据库映射就更有意义了。也许你永远不需要关系。在需要时构建它。

如果数据库已经存在，或者需要在那里获取数据，我仍然会尝试尽可能长时间地推迟关系工作并让对象和代码正常工作。但是，如果我看到自己编写可以通过 SQL 完成的复杂代码，我会改变主意。

# windows-server-2008 - Windows 2008 网页版有可靠的邮件服务器吗？

> ID：274096
> 
> 赞同：0
> 
> 时间：2008-11-08T00:34:24.600
> 
> 标签：windows-server-2008, web-hosting

我目前正在寻找一个为我的 ASP.NET 应用程序提供 Windows 2008 虚拟或专用托管的虚拟主机。在专用主机上，您按月支付 Windows 费用，我注意到网络版和标准版之间的成本存在明显差异，所以，我的问题是：

MS Exchange 附带标准版吗？如果是这样，网络版中是否有任何可靠的等价物？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T01:00:33.423

Exchange 没有任何版本的 Windows Server 2008 OS（Web、Standard、Enterprise）。它们都具有基本的外发 smtp 功能，但如果您需要 imap、pop3 或 webmail，则需要寻找第 3 方产品。

流行的免费邮件服务器是[SmarterMail](http://www.smartertools.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T01:04:17.457

据我所知，网络版仅用于托管网站。它不包括任何邮件服务器，如交换。它应该有一个 smtp 服务器并且应该能够接受邮件，但不像 Exchange。

可以在网络版上安装邮件服务器，但我没有足够的知识来确定。

在过去的版本中，您无法在 web 版本上安装 sql server。我不确定这是否已经改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T01:07:32.583

另一个不错的免费电子邮件服务器是[hMailServer](http://www.hmailserver.com/)。我一直在使用它，它的灰名单功能确实减少了垃圾邮件。但是，我不知道这是否会在 Windows Server 的 Web 版上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T18:47:12.370

我刚刚在 SmartTools 论坛上看到 SmarterMail 将在网络版上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-11T02:08:40.563

有没有人知道通过 Web 版获得标准版 Server 2008 的目的？我使用 MySQL 5、SmarterMail 和 SmarterStats 托管 ASP.NET 网站，并且需要至少 4 GB 的内存。网络版会为此工作吗？只是想确保它不会阻塞端口或任何东西。我在另一个网站上读到，他们不允许您在网络版上运行邮件服务器。两者之间的价格差异是巨大的。

# .net - 您如何处理开发人员对 Windows 服务器的访问？

> ID：274123
> 
> 赞同：5
> 
> 时间：2008-11-08T00:58:12.850
> 
> 标签：.net, windows, sysadmin

在代码启动方面，您如何处理开发人员对服务器的访问？他们是否可以通过 RDP 访问机器来部署代码和进行更改？他们是否只授予对服务器 docroot 的 ftps 访问权限，并且任何 .NET 配置更改都由系统管理员处理？开发人员是否甚至可以访问生产 docrooots 进行部署，或者系统管理员是否处理任何向实时服务器启动的代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T01:03:43.277

我使用过的最佳设置具有 3 级层次结构：

*   DEV - 开发人员可以完全访问这些服务器。
*   STAGE - 这是为开发人员和 QA 准备的。
*   LIVE - 只有系统管理员和构建工程师才能接触这些。

这也将取决于公司的预算和心态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T01:01:20.707

这取决于，在我们的工作场所，开发人员会做所有事情。没有系统管理员说什么（因为我是系统管理员和开发人员）

但不好的部分是，在我反对并试图停止但还没有运气的现场环境中正在进行大量测试。

我的最后一个工作场所也是由开发人员处理的，但在上线之前是分阶段的，很多阶段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T01:03:01.500

多年来，我已经看到了其中的一些，到目前为止，当开发人员拥有完全访问权限时，最好的结果已经出现。当然，所有更改仍应在版本控制中记录和提交，并在部署之前在测试系统上进行测试，等等。让开发人员进入生产服务器的回报是出现问题时。开发人员是能够最快看穿问题的人。在有严格限制的情况下，我看到关键的单行错误修复需要几天时间才能部署。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T01:07:29.277

我们使用多种方法。对于我是主要开发人员并且它托管在专用服务器（或 VM）上的应用程序，我可以完全访问 Web 服务器。对于我只开发大型应用程序的一部分，或者应用程序适合更大框架的应用程序，我可以访问可以发布的目录。对于测试环境（或原型新服务），它通常是完全访问权限。我有自己的专用 QA 盒子，我可以完全访问以进行 QA 工作。SQL 服务器的处理方式不同。我在本地完全安装了我开发的 SQL 服务器。我通常与 DBA 交互以在测试和生产服务器上设置数据库，但对数据库具有完全的管理访问权限，但对服务器没有访问权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T06:18:25.967

我可以完全访问我们的大部分生产系统。有很多问题对我来说比 IT 更容易解决。尽管除非绝对必要，否则我通常不会对生产进行更改。如果我确实进行了更改，我会告诉我们的管理员，以便他们记录下来。我们已经尝试在访问受限的情况下进行此操作，但我作为一个非常小的团队的一员工作，所以这不是一个选择。现在，如果我们只给管理员访问权限，那么 2 个人将不得不处理生产问题。这对于待命时间表来说是很困难的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T04:32:41.950

我可以完全访问我公司拥有的每台生产服务器。但是我们是一家非常小的公司，我做了很多系统管理员的工作以及所有的开发工作。

# c# - WIA 吐温支持 C#

> ID：274127
> 
> 赞同：4
> 
> 时间：2008-11-08T01:01:12.657
> 
> 标签：c#, .net, twain, wia

如何在 C# 中使用 WIA 和 Twain？[位于http://www.codeproject.com/KB/dotnet/twaindotnet.aspx](http://www.codeproject.com/KB/dotnet/twaindotnet.aspx)的 TWIAIN/C# 示例在 TwainLib.cs 的第 59 行抛出异常“尝试加载格式不正确的程序”。在 Vista 64 上。

我会使用 WIA，但它不支持我想使用的所有设备。

有没有一种简单的方法可以在 C# 中的 WIA 中启用 TWAIN 支持？我知道这是可以做到的，但我找不到有关该主题的任何文档。我不是在寻找商业产品。我可以弄清楚如何很好地使用 WIA - 但事实上我无法启用 TWIAN 支持，这很烦人。

也欢迎使用 C++/CLI 或 VB.net 中的示例。

谢谢。

**编辑**

谢谢，克里斯蒂安利巴多。你帮了我很多，我现在可能会继续使用 TWIAN。但是我还是想用WIA；所以我还不接受你的回答。对于刚刚看到这篇文章的人来说，这里有更多信息。所有人都在回应这个答案：

是的，这样做是为了支持 TWIAN；谢谢！不过我还是想用WIA；但现在我有一些工作要做。但是，当我选择我的 USB 相机作为源并点击获取时，应用程序挂起。我的相机适用于其他商业 TWIAN 应用程序。

通过注释掉第 100 到 104 行（检查“DScap（appid，srcds，TwDG.Control，TwDAT.Capability，TwMSG.Set，cap）;”的代码是否返回 TwRC.Success，我的相机现在可以工作了。我没有了解这段代码的作用；因为关于这个主题的文档几乎没有。

好的; 它是一个名为“CAP_XFERCOUNT”的常量，与每个会话扫描多个图像有关。使相机不支持它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T01:10:33.623

可能是一个很长的镜头，但您是否尝试过使用 x86 作为平台目标构建或更改线程单元状态？

# css - 在打印模式下重复表格标题

> ID：274149
> 
> 赞同：125
> 
> 时间：2008-11-08T01:12:35.757
> 
> 标签：css, css-tables

是否可以在 CSS 中使用 @page 内的属性来表示如果表格分布在多个页面上，则表头（th）应该在每个页面上重复？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2008-11-08T01:19:34.617

这就是[THEAD](http://htmlhelp.com/reference/html40/tables/thead.html)元素的用途。官方文档[在这里](http://www.w3.org/TR/html4/struct/tables.html#edef-THEAD)。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2008-11-08T01:37:15.050

一些浏览器在每个页面上重复该`thead`元素，因为它们应该这样做。其他人需要一些帮助：将其添加到您的 CSS 中：

```
thead {display: table-header-group;}
tfoot {display: table-footer-group;} 
```

无论您尝试什么，Opera 7.5 和 IE 5 都不会重复标题。

[（[来源](http://css-discuss.incutio.com/?page=PrintingTables)）]

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2010-04-13T22:57:23.993

如果您将以下内容添加到 CSS 中，[Flying Saucer xhtmlrenderer会在 PDF 输出的每一页上重复 THEAD：](http://code.google.com/p/flying-saucer/)

```
 table {
            -fs-table-paginate: paginate;
        } 
```

（至少从 R8 版本开始就可以使用。）

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2012-03-15T00:09:50.843

**更新：**看起来这可能已在 2016 年修复！[https://bugs.chromium.org/p/chromium/issues/detail?id=24826#c45](https://bugs.chromium.org/p/chromium/issues/detail?id=24826#c45)

**原始答案 (2012)：** 在您实施此解决方案之前，重要的是要知道 Webkit 目前不这样做。

这是 Chrome 问题跟踪器上的相关问题：[http ://code.google.com/p/chromium/issues/detail?id=24826](http://code.google.com/p/chromium/issues/detail?id=24826)

在 Webkit 问题跟踪器上：[https ://bugs.webkit.org/show_bug.cgi?id=17205](https://bugs.webkit.org/show_bug.cgi?id=17205)

如果您想表明它对您很重要（我做过），请在 Chrome 问题跟踪器上加注星标。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-12-17T12:27:20.520

Chrome 和 Opera 浏览器不支持`thead {display: table-header-group;}`，但其他浏览器正常支持。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-12-21T06:26:01.437

我如何打印 HTML 表格。每页的页眉和页脚

也适用于 Webkit 浏览器

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script type="text/javascript">
        function PrintPage() {
            document.getElementById('print').style.display = 'none';
            window.resizeTo(960, 600);
            document.URL = "";
            window.location.href = "";
            window.print();
        }

    </script>
    <style type="text/css" media="print">
        @page
        {
            size: auto; /* auto is the initial value */
            margin: 2mm 4mm 0mm 0mm; /* this affects the margin in the printer settings */
        }
        thead
        {
            display: table-header-group;
        }
        tfoot
        {
            display: table-footer-group;
        }
    </style>
    <style type="text/css" media="screen">
        thead
        {
            display: block;
        }
        tfoot
        {
            display: block;
        }
    </style>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <table style="width: 500px; margin: 0 auto;">
            <thead>
                <tr>
                    <td>
                        header comes here for each page
                    </td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>
                        1
                    </td>
                </tr>
                <tr>
                    <td>
                        2
                    </td>
                </tr>
                <tr>
                    <td>
                        3
                    </td>
                </tr>
                <tr>
                    <td>
                        4
                    </td>
                </tr>
                <tr>
                    <td>
                        5
                    </td>
                </tr>
                <tr>
                    <td>
                        6
                    </td>
                </tr>
                <tr>
                    <td>
                        7
                    </td>
                </tr>
                <tr>
                    <td>
                        8
                    </td>
                </tr>
                <tr>
                    <td>
                        9
                    </td>
                </tr>
                <tr>
                    <td>
                        10
                    </td>
                </tr>
                <tr>
                    <td>
                        11
                    </td>
                </tr>
                <tr>
                    <td>
                        12
                    </td>
                </tr>
                <tr>
                    <td>
                        13
                    </td>
                </tr>
                <tr>
                    <td>
                        14
                    </td>
                </tr>
                <tr>
                    <td>
                        15
                    </td>
                </tr>
                <tr>
                    <td>
                        16
                    </td>
                </tr>
                <tr>
                    <td>
                        17
                    </td>
                </tr>
                <tr>
                    <td>
                        18
                    </td>
                </tr>
                <tr>
                    <td>
                        19
                    </td>
                </tr>
                <tr>
                    <td>
                        20
                    </td>
                </tr>
                <tr>
                    <td>
                        21
                    </td>
                </tr>
                <tr>
                    <td>
                        22
                    </td>
                </tr>
                <tr>
                    <td>
                        23
                    </td>
                </tr>
                <tr>
                    <td>
                        24
                    </td>
                </tr>
                <tr>
                    <td>
                        25
                    </td>
                </tr>
                <tr>
                    <td>
                        26
                    </td>
                </tr>
                <tr>
                    <td>
                        27
                    </td>
                </tr>
                <tr>
                    <td>
                        28
                    </td>
                </tr>
                <tr>
                    <td>
                        29
                    </td>
                </tr>
                <tr>
                    <td>
                        30
                    </td>
                </tr>
                <tr>
                    <td>
                        31
                    </td>
                </tr>
                <tr>
                    <td>
                        32
                    </td>
                </tr>
                <tr>
                    <td>
                        33
                    </td>
                </tr>
                <tr>
                    <td>
                        34
                    </td>
                </tr>
                <tr>
                    <td>
                        35
                    </td>
                </tr>
                <tr>
                    <td>
                        36
                    </td>
                </tr>
                <tr>
                    <td>
                        37
                    </td>
                </tr>
                <tr>
                    <td>
                        38
                    </td>
                </tr>
                <tr>
                    <td>
                        39
                    </td>
                </tr>
                <tr>
                    <td>
                        40
                    </td>
                </tr>
                <tr>
                    <td>
                        41
                    </td>
                </tr>
                <tr>
                    <td>
                        42
                    </td>
                </tr>
                <tr>
                    <td>
                        43
                    </td>
                </tr>
                <tr>
                    <td>
                        44
                    </td>
                </tr>
                <tr>
                    <td>
                        45
                    </td>
                </tr>
                <tr>
                    <td>
                        46
                    </td>
                </tr>
                <tr>
                    <td>
                        47
                    </td>
                </tr>
                <tr>
                    <td>
                        48
                    </td>
                </tr>
                <tr>
                    <td>
                        49
                    </td>
                </tr>
                <tr>
                    <td>
                        50
                    </td>
                </tr>
                <tr>
                    <td>
                        51
                    </td>
                </tr>
                <tr>
                    <td>
                        52
                    </td>
                </tr>
                <tr>
                    <td>
                        53
                    </td>
                </tr>
                <tr>
                    <td>
                        54
                    </td>
                </tr>
                <tr>
                    <td>
                        55
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td>
                        footer comes here for each page
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
    <br clear="all" />
    <input type="button" id="print" name="print" value="Print" onclick="javascript:PrintPage();"
        class="button" />
    </form>
</body>
</html> 
```

# php - Wordpress、PHP、URL 编码问题

> ID：274157
> 
> 赞同：2
> 
> 时间：2008-11-08T01:17:46.963
> 
> 标签：php, wordpress, urlencode

Wordpress 提供了一个名为“the_permalink()”的函数，它在帖子循环中返回给定帖子的永久链接，您猜对了！

我正在尝试对该永久链接进行 URL 编码，并且当我执行此代码时：

```
<?php
print(the_permalink());
$permalink = the_permalink();
print($permalink);
print(urlencode(the_permalink()));
print(urlencode($permalink));
$url = 'http://wpmu.local/graphjam/2008/11/06/test4/';
print($url);
print(urlencode($url));
?> 
```

它以 HTML 格式生成这些结果：

```
http://wpmu.local/graphjam/2008/11/06/test4/
http://wpmu.local/graphjam/2008/11/06/test4/
http://wpmu.local/graphjam/2008/11/06/test4/
http://wpmu.local/graphjam/2008/11/06/test4/
http%3A%2F%2Fwpmu.local%2Fgraphjam%2F2008%2F11%2F06%2Ftest4%2F 
```

我希望输出的第 2、3 和 5 行是 URL 编码的，但只有第 5 行是这样。想法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-08T01:22:47.670

根据文档，[`the_permalink`](http://codex.wordpress.org/Template_Tags/the_permalink)打印永久链接并返回它。所以，`urlencode`没有得到任何编码。

试试[`get_permalink`](http://codex.wordpress.org/Template_Tags/get_permalink)。

* * *

[**编辑**]

编辑有点晚了，但我没有意识到打印数量是个问题。

他们都来自这里：

```
<?php
print(the_permalink());                                // prints (1)
$permalink = the_permalink();                          // prints (2)
print($permalink);                                     // nothing
print(urlencode(the_permalink()));                     // prints (3)
print(urlencode($permalink));                          // nothing
$url = 'http://wpmu.local/graphjam/2008/11/06/test4/'; 
print($url);                                           // prints (4)
print(urlencode($url));                                // prints (5)
?> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-12T09:45:22.160

`the_permalink()` **呼应**永久链接

`get_the_permalink()` **返回**永久链接，以便可以将其分配给变量。

（WordPress 中的大多数函数也是如此：the_something() 有一个 get_the_something() 来返回值而不是回显它）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-08T03:27:22.987

@Jonathan has the reason why, and the way you should deal with it in WordPress (ie. use the right function for the job).

Here is how to fix it when there isn't a function that returns a string:

```
ob_start();
the_permalink();
$permalink = ob_get_clean();
print(urlencode($permalink)); 
```

# c# - C# ushort[] 到字符串的转换；这可能吗？

> ID：274158
> 
> 赞同：3
> 
> 时间：2008-11-08T01:18:08.660
> 
> 标签：c#, string, ushort

我有一个非常痛苦的库，目前它正在接受 C# 字符串作为获取数据数组的一种方式；显然，这使得编组 pinvokes 更容易。

那么如何将 ushort 数组按字节转换为字符串呢？我试过了：

```
int i;
String theOutData = "";
ushort[] theImageData = inImageData.DataArray;
 //this is as slow like molasses in January
 for (i = 0; i < theImageData.Length; i++) {
     byte[] theBytes = System.BitConverter.GetBytes(theImageData[i]);
     theOutData += String.Format("{0:d}{1:d}", theBytes[0], theBytes[1]);
 } 
```

我可以这样做，但它不会在任何接近理智的时间内完成。

我应该在这里做什么？不安全？通过某种 IntPtr 中间体？

如果它是 C++ 中的 char*，这会容易得多......

编辑：函数调用是

```
DataElement.SetByteValue(string inArray, VL Length); 
```

其中 VL 是一个“值长度”，一个 DICOM 类型，并且函数本身是由 SWIG 作为 C++ 库的包装器生成的。似乎选择的表示是字符串，因为它可以相对容易地跨越托管/非托管边界，但是在整个项目中的 C++ 代码（这是 GDCM）中，char* 只是用作字节缓冲区。所以，当你想设置你的图像缓冲区指针时，在 C++ 中它相当简单，但在 C# 中，我遇到了这个奇怪的问题。

这是黑客攻击，我知道最好的办法可能是让 SWIG 库正常工作。我真的不知道该怎么做，如果存在的话，我宁愿在 C# 端快速解决。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T02:02:56.980

P/Invoke 实际上可以在大多数时间使用 StringBuilder 创建可写缓冲区来处理您所需要的内容，例如，请参阅[pinvoke.net 上的 GetWindowText 和相关函数](http://www.pinvoke.net/search.aspx?search=GetWindowText)。

然而，除此之外，数据为 ushort，我假设它是用 UTF-16LE 编码的。如果是这种情况，您可以使用 Encoding.Unicode.GetString()，但这将期望一个字节数组而不是一个 ushort 数组。要将您的 ushorts 转换为字节，您可以分配一个单独的字节数组并使用 Buffer.BlockCopy，如下所示：

```
ushort[] data = new ushort[10];
for (int i = 0; i < data.Length; ++i)
    data[i] = (char) ('A' + i);

string asString;
byte[] asBytes = new byte[data.Length * sizeof(ushort)];
Buffer.BlockCopy(data, 0, asBytes, 0, asBytes.Length);
asString = Encoding.Unicode.GetString(asBytes); 
```

但是，如果不安全代码是可以的，您还有另一个选择。以 ushort* 形式获取数组的开头，并将其硬转换为 char*，然后将其传递给字符串构造函数，如下所示：

```
string asString;
unsafe
{
    fixed (ushort *dataPtr = &data[0])
        asString = new string((char *) dataPtr, 0, data.Length);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T02:02:12.037

您可以做的一件事是从使用字符串切换到 stringBuilder，它将极大地提高性能。

如果您愿意使用不安全的代码，您可以使用指针并像您的 c++ 一样实现您的 c# 代码。或者你可以编写一个小的 c++\cli dll 来实现这个功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T02:16:43.363

查看[Buffer](http://msdn.microsoft.com/en-us/library/system.buffer.aspx)类：

```
ushort[] theImageData = inImageData.DataArray;

byte[] buf = new byte[Buffer.ByteLength(theImageData)]; // 2 bytes per short
Buffer.BlockCopy(theImageData, 0, buf, 0, Buffer.ByteLength(theImageData));

string theOutData = System.Text.Encoding.ASCII.GetString(buf); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T13:57:56.860

仅供参考，这已在以后的修订版（gdcm 2.0.10）中得到修复。看这里：

[http://gdcm.sourceforge.net/](http://gdcm.sourceforge.net/)

-> [http://apps.sourceforge.net/mediawiki/gdcm/index.php?title=GDCM_Release_2.0](http://apps.sourceforge.net/mediawiki/gdcm/index.php?title=GDCM_Release_2.0)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T02:14:29.390

我不太喜欢这个，但考虑到以下假设，它似乎有效：

**1.** 每个 ushort 都是 0 到 127 之间的 ASCII 字符

**2.** （好吧，我想只有一个假设）

```
 ushort[] data = inData; // The ushort array source

        Byte[] bytes = new Byte[data.Length];  // Assumption - only need one byte per ushort

        int i = 0;
        foreach(ushort x in data) {
            byte[] tmp = System.BitConverter.GetBytes(x);
            bytes[i++] = tmp[0];
            // Note: not using tmp[1] as all characters in 0 < x < 127 use one byte.
        }

        String str = Encoding.ASCII.GetString(bytes); 
```

我确信有更好的方法可以做到这一点，但这是我能很快想到的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-23T14:00:19.333

您可以通过这种方式避免不必要的复制：

```
public static class Helpers
{
    public static string ConvertToString(this ushort[] uSpan)
    {
        byte[] bytes = new byte[sizeof(ushort) * uSpan.Length];

        for (int i = 0; i < uSpan.Length; i++)
        {
            Unsafe.As<byte, ushort>(ref bytes[i * 2]) = uSpan[i];
        }

        return Encoding.Unicode.GetString(bytes);
    }
} 
```

# asp.net-mvc - 在 MVC 中使用 HtmlHelper 有什么好处吗？

> ID：274162
> 
> 赞同：11
> 
> 时间：2008-11-08T01:21:05.207
> 
> 标签：asp.net-mvc

`Html.CheckBox`我应该使用, `Html.TextBox`, etc 方法而不是仅仅手动编写 HTML是否有特定的原因？

```
<%= Html.TextBox("uri") %> 
```

呈现以下 HTML

```
<input type="text" value="" name="uri" id="uri"/> 
```

它猜想它可以为您节省一些击键，但除此之外。是否有特定的原因为什么我应该尽可能地使用 HtmlHelpers 或者它只是一种偏好？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T02:59:19.067

另一个好处是，如果您的 ViewData 包含与字段名称匹配的值，它将被填充。

例如

```
ViewData["FirstName"] = "Joe Bloggs"; 

<%=Html.TextBox("FirstName") %> 
```

将呈现

```
<input type="text" value="Joe Bloggs" id="FirstName" /> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T03:13:13.203

有巨大的好处：

就像 ViewState 一样，它具有预填充值的重载方法（格式化且对 HTML 安全）。

它允许内置支持 MVC 的验证功能。

它允许您通过提供自己的 DLL 来更改渲染（一种“控制器适配器”类型的方法）来覆盖渲染。

它导致了构建自己的“控件”的想法：[http ://www.singingeels.com/Articles/Building_Custom_ASPNET_MVC_Controls.aspx](http://www.singingeels.com/Articles/Building_Custom_ASPNET_MVC_Controls.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T01:28:57.830

一件事是为了一致性......我总是忘记 name 属性。另外，您可以为自己的项目扩展功能。他们不是无缘无故被称为**帮手**的！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T02:49:08.150

使用抽象层的好处是以可插入的方式在未来证明您的代码。也许今天，您创建 HTML 4 页面，但明天您想要创建 XHTML 页面或 XAML 或 XUL。如果您只是在各处对标签进行硬编码，那将有很多变化，尤其是在您有数百页的情况下。如果一切都在调用这个库，那么你所要做的就是重写这个库。缺点是人们通常认为它的可读性略低。因此，它很可能会增加对维护程序员的认知需求。这些优点和缺点确实与 MVC 无关。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T02:59:49.987

它实际上首先根据您的 ViewData.Model.uri 和第二个通过 ViewData [“uri”] 自动填充您的文本框。手动执行，您需要执行`<input value="<%Html.Encode(ViewData.Model.Uri"%>" />`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T01:28:50.077

我做MVC的时间不长，但是我已经写了一些扩展方法来基于Html.ActionLink生成菜单选项卡。它允许我与我的用法保持一致，如果我决定更改我的 CSS 菜单的工作方式，只需修改一个方法来输出新的选项卡格式。

我对它们的另一个用途是在条件输出中使用 ViewData 为控件提供值。

# vb.net - 类型参数不能用作限定符

> ID：274172
> 
> 赞同：2
> 
> 时间：2008-11-08T01:31:06.653
> 
> 标签：vb.net, generics

VB.Net2005

简化代码：

```
 MustInherit Class InnerBase(Of Inheritor)
End Class

MustInherit Class OuterBase(Of Inheritor)
    Class Inner
        Inherits InnerBase(Of Inner)
    End Class
End Class

Class ChildClass
    Inherits OuterBase(Of ChildClass)
End Class

Class ChildClassTwo
    Inherits OuterBase(Of ChildClassTwo)
End Class

MustInherit Class CollectionClass(Of _
        Inheritor As CollectionClass(Of Inheritor, Member), _
        Member As OuterBase(Of Member))
    Dim fails As Member.Inner ' Type parameter cannot be used as qualifier
    Dim works As New ChildClass.Inner
    Dim failsAsExpected As ChildClassTwo.Inner = works ' type conversion failure
End Class 
```

“失败”行上的错误消息在主题中，并且“Member.Inner”被突出显示。顺便说一句，尝试调用 OuterBase 的共享方法时也会发生同样的错误。

“works”行有效，但现实生活中有十几个（并且还在增加） ChildClass 类。

“failsAsExpected”行表明，对于泛型，每个 ChildClass 都有自己独特的 Inner 类。

我的问题：有没有办法在 CollectionClass 类中获取一个变量，定义为 Member.Inner 类型？编译器无法遵循的关键区别是什么？

（我最终能够通过创建一个 param 类型的虚拟对象并调用 OuterBase 中定义的方法来生成一个对象。这不是最干净的方法。）

编辑 2008/12/2 更改的代码以使两个“基”类通用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T02:23:54.927

```
Dim succeeds as OuterBase.Inner 
```

.net 没有*C* ++ 的模板类和 typedef 的组合，这意味着您尝试做的事情是不可能的，甚至在 .net 中也没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T07:39:27.083

`ChildClass.Inner`并且`SomeOtherChildClass.Inner`是同一类型。这是一个简短但完整的程序来演示：

```
Imports System

MustInherit Class InnerBase
End Class

MustInherit Class OuterBase
   Class Inner
      Inherits InnerBase
   End Class
End Class

Class ChildClass
   Inherits OuterBase
End Class

Class OtherChildClass
   Inherits OuterBase
End Class

Class Test
    Shared Sub Main()
        Dim x as new ChildClass.Inner
        Dim y as new OtherChildClass.Inner

        Console.WriteLine(x.GetType())
        Console.WriteLine(y.GetType())
    End Sub
End Class 
```

输出是：

```
OuterBase+Inner
OuterBase+Inner 
```

您试图通过使用“参数化”嵌套类来实现什么？我怀疑它*要么*不能按照你想要的方式工作，*要么*你可以通过使用`OuterBase.Inner`to start with 来实现它。

现在，如果您的每个子类都声明了自己的嵌套类，那将是另一种情况——泛型对您没有帮助。

# java - 在 Windows 上使用 RXTX Java 库的 NoSuchPortException？

> ID：274179
> 
> 赞同：1
> 
> 时间：2008-11-08T01:32:59.787
> 
> 标签：java, windows, rxtx

[我已按照http://www.jcontrol.org/download/readme_rxtx_en.html](http://www.jcontrol.org/download/readme_rxtx_en.html)的说明在 Windows 上设置 rxtx 。

我所做的就是将 rxtxSerial.dll 复制到“C:\Program Files\Java\jdk1.6.0_07\jre\bin”，并将 RXTXcomm.jar 复制到“C:\Program Files\Java\jdk1.6.0_07\jre\ lib\ext"（我的 JAVA_HOME 变量设置为 C:\Program Files\Java\jdk1.6.0_07\jre）

我还将 RXTXcomm.jar 添加到我的 Eclipse 项目中。

但是当我运行它时，它仍然显示“NoSuchPortException”

```
开发库
==========================================
本机库版本 = RXTX-2.0-7pre1
Java 库版本 = RXTX-2.0-7pre1
java.lang.ClassCastException：gnu.io.RXTXCommDriver 无法转换为 gnu.io.CommDriver 在加载 gnu.io.RXTXCommDriver 时抛出
gnu.io.NoSuchPortException
    在 gnu.io.CommPortIdentifier.getPortIdentifier(CommPortIdentifier.java:218)
    在 TwoWaySerialComm.connect(TwoWaySerialComm.java:20)
    在 TwoWaySerialComm.main(TwoWaySerialComm.java:107)

```

在我的 java 文件中，我告诉它：

```
        尝试
        {
            (new TwoWaySerialComm()).connect("COM4");
        }

```

我也尝试过 Java Comm API。两者都无法识别我的串行端口，但我确信我正确地遵循了说明。那里有文件。

有人知道它可能是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T02:37:12.090

试着放进`rxtxSerial.dll`去

```
C:\Program Files\Java\jdk1.6.0_07\jre\lib\bin
                                      ^^^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T08:44:20.323

我对RXTX不太熟悉，但这正常吗？

```
java.lang.ClassCastException: gnu.io.RXTXCommDriver cannot be cast to gnu.io.CommDriver thrown while loading gnu.io.RXTXCommDriver 
```

否则，问题可能不在于端口本身，而在于类本身？只是一个猜测。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T07:18:13.020

您可以使用 CommPortIdentifier.getPortIdentifiers()

识别系统找到的所有可能的端口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-25T12:08:23.167

您还可以尝试专门为 Windows 实施的替代解决方案。应该有很多可用的，您可以从[http://www.caerustech.com/JCommWin32.php获得其中之一](http://www.caerustech.com/JCommWin32.php)

舒尔茨

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T06:46:59.667

可能是您的系统没有定义 COM4 或无法访问。很难猜测可能出了什么问题，因为您还没有发布您的端口初始化代码 - 您发布的内容看起来像包装器代码。

这是我使用 javax.comm API（但使用来自 serialio.com 的 SerialPort）的工作初始化代码：

```
// name comes from config and is "COM1", "COM2", ...
SerialPort port=(SerialPort)CommPortIdentifier.getPortIdentifier(name).open("YourPortOwnerIdHere",5000);      // owner and ms timeout
port.setSerialPortParams(bau,dtb,stb,par);
port.setFlowControlMode(SerialPort.FLOWCONTROL_RTSCTS_IN|SerialPort.FLOWCONTROL_RTSCTS_OUT);
port.enableReceiveTimeout(1000); 
```

希望这会为您指明正确的方向。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-10T19:51:24.637

在 serialEvent 函数中关闭 serialPort 时，我也遇到了问题。也许这是一个死锁问题，close方法永远等待serialEvent的锁被释放。启动一个新线程来关闭端口对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-29T10:40:39.157

对于您的问题，我的代码如下：

```
if (idPuerto == null)
{
            formulario = form;
            boolean encontrado = false;

            listaPuertos = CommPortIdentifier.getPortIdentifiers();

            while( listaPuertos.hasMoreElements() && encontrado == false )
            {
              idPuerto = (CommPortIdentifier)listaPuertos.nextElement();
              //System.out.println(idPuerto.getName());

              if( idPuerto.getPortType() == CommPortIdentifier.PORT_SERIAL )
              {
                if( idPuerto.getName().equals(RFIDBascApp.ComBasc) )
                {        
                    encontrado = true;
                    logger.AddInfoUser("Puerto serie encontrado");

                  }
                }
              } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-21T01:26:51.700

我同意你的问题看起来像 ClassCastException 而不是另一个。

对于 Windows，我在[http://www.engidea.com/blog/informatica/winjcom/winjcom.html](http://www.engidea.com/blog/informatica/winjcom/winjcom.html)使用“Windows Java Serial Com Port Driver”，而且设置起来要容易得多。

无论哪种情况，您都需要 BIN 目录中的 DLL，而不是建议的 LIB\BIN。至少这对我有用。我正在使用 NetBeans，我还发现将 jar 和 dll 放入 JDK 中的各种 bin 和 lib\ext 文件夹中很有帮助。

请注意，如果您的机器上有多个版本的 JRE，您可能没有使用您认为正在使用的那个。此外，作为一个实际问题，我发现将 jar 和 dll 都复制到各种 bin 和 lib\ext 文件夹中更有帮助。使它只是一个粘贴，粘贴，粘贴操作。

对于 Windows，我推荐“Windows Java Serial Com Port Driver”，因为它解决了我的 USB 串口问题。我适合 RXTX，因为拔下 USB 时它会崩溃。winjcom 也解决了这个问题和其他问题。它有非常有用的错误异常。

此外，请确保您的串行驱动程序是最新的。下载更新修复了我的另一个错误。-斯托什

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-02-08T15:46:58.827

你有`NoSuchPortException`，所以首先迭代所有可用的端口！

```
import gnu.io.CommPortIdentifier;        
import java.util.Enumeration;  

public class ListAvailablePorts {  

    public void list() {  
        Enumeration ports = CommPortIdentifier.getPortIdentifiers();  

        while(ports.hasMoreElements()){  
            CommPortIdentifier port = (CommPortIdentifier) ports.nextElement();
            System.out.println(port.getName());
        }
    }  

    public static void main(String[] args) {  
        new ListAvailablePorts().list();  
    }  
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-12-30T07:04:03.003

@Pinheiro 你可能想看看[这个](http://rxtx.qbang.org/wiki/index.php/Trouble_shooting#How_does_rxtx_detect_ports.3F__Can_I_override_it.3F)

# merge - 是否有合并两个 GZIP 文件而不解压缩它们的 GZIP 合并？

> ID：274185
> 
> 赞同：14
> 
> 时间：2008-11-08T01:37:07.470
> 
> 标签：merge, gzip, deflate

假设有 a.gz 和 b.gz。

$ gzip_merge a.gz b.gz -输出 c.gz

我想要这个程序。当然，

$ cat a.gz b.gz > c.gz

不起作用。因为a.gz的最终DEFLATE块有BFINAL，b.gz的GZIP头。(参考 RFC1951, RFC1952) 但是如果你取消了 BFINAL，丢掉第二个 GZIP 头并且遍历第二个 gzip 文件的字节边界，你可以合并它。

其实我也想过为这件事写一个开源程序，但是不知道怎么发布。所以我请乔尔做我的项目经理，我给他讲解了我的解释和辩护，他终于明白了我想做什么，但说他太忙了。:(

当然，我可以自己写一个，然后尝试以我的方式发布它。但我不能一个人做这件事，因为我的日常工作属于我雇主的财产。

有志愿者吗？我们可以作为程序员（我）、出版商（你）或程序员（你）、出版商（我）工作。我需要的只是一些信用。我曾经实现过 RFC3320 中描述的通用解压器虚拟机。所以我知道这是可行的。

或者，您可以将我指向那个程序。这对于管理日志文件非常有用，例如将 365（天）gzip 压缩日志文件合并为一个。;)

谢谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-08T01:44:58.543

> 当然， cat a.gz b.gz > c.gz 不起作用。

实际上，它工作得很好。我刚刚测试了它。它甚至在 gzip 手册页中记录（有点）。

```
 Multiple  compressed  files  can  be concatenated. In this case, gunzip
   will extract all members at once. For example:

         gzip -c file1  > foo.gz
         gzip -c file2 >> foo.gz

   Then

         gunzip -c foo

   is equivalent to

         cat file1 file2 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-12T21:52:48.423

您还可以：

```
zcat a.gz b.gz > c.txt && gzip c.txt 
```

只要你的 Linux/Unix 发行版内置了 zcat，它们中的大多数都这样做（你可以为那些没有的发行版安装它。）

或者：

```
zcat a.gz b.gz | gzip -c > c.txt.gz 
```

# image-processing - 图片库推荐

> ID：274191
> 
> 赞同：0
> 
> 时间：2008-11-08T01:45:33.317
> 
> 标签：image-processing

我正在寻找一些可以使用多种格式（jpg、gif、png）的图像库，并且可以快速将图像显示到屏幕上。

此外，如果我可以只指定要渲染到屏幕的图像的一部分，那就太好了。

最后，我希望在屏幕上有很多可以平移和缩放的图像。

这是我的 ppc powerbook 上的个人项目，如果库是 c++ ，我更喜欢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T01:51:20.763

[免费图片。](http://freeimage.sourceforge.net/)

那是为了加载。

对于显示，您可以使用 FreeImage 方法制作位图，然后您可以在某些控件中显示（取决于您的 UI）。

对于显示的真正热度，您将需要使用[OpenGL](http://www.opengl.org)。

此外，与此同时，我发现了[CImg](http://cimg.sourceforge.net/)，它与其说是一个库，不如说是一个用于执行许多常见成像应用程序并在 C++ 中工作的框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T02:01:51.600

[ImageMagick](http://www.imagemagick.org/Magick++/)有多种语言的库来做你想做的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T03:02:05.970

Imagemagick 似乎是黄金标准，并被用于各种地方。你在什么样的环境中工作——Linux？视窗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-23T23:32:39.040

还有：

*   Framewave 基于[AMD 性能库](http://framewave.sourceforge.net/)，提供信号和图像处理功能
*   [GraphicsMagick](http://www.graphicsmagick.org/)多线程衍生自[ImageMagick](http://www.imagemagick.org/)

检查相关问题

*   [快速跨平台 C/C++ 图像处理库](https://stackoverflow.com/questions/796364/fast-cross-platform-c-c-image-processing-libraries/)
*   [图像处理库](https://stackoverflow.com/questions/1418631/image-processing-libraries)

# compression - 压缩独特的数据流

> ID：274196
> 
> 赞同：3
> 
> 时间：2008-11-08T01:50:27.833
> 
> 标签：compression, zlib

我有大量的整数数组。每个整数都有几千个整数，每个整数通常与之前的整数相同，或者仅相差一两位。我想将每个阵列缩小到尽可能小，以减少我的磁盘 IO。

Zlib 将其缩小到其原始大小的 25% 左右。这很好，但我不认为它的算法特别适合这个问题。有谁知道压缩库或简单算法可能对此类信息表现更好？

更新：zlib 将其转换为 xor deltas 数组后将其缩小到原始大小的 20% 左右。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T03:03:43.970

如果大多数整数真的和前面的一样，而且符号间的差异通常可以表示为一个位翻转，这听起来像是 XOR 的工作。

采用如下输入流：

```
1101
1101
1110
1110
0110 
```

和输出：

```
1101
0000
0010
0000
1000 
```

一点伪代码

```
compressed[0] = uncompressed[0]
loop
  compressed[i] = uncompressed[i-1] ^ uncompressed[i] 
```

我们现在已经将大部分输出减少到 0，即使高位被更改。您使用的任何其他工具中的 RLE 压缩都会有一个现场日。它在 32 位整数上的效果会更好，而且它仍然可以对流中弹出的完全不同的整数进行编码。您可以省去自己处理位打包的麻烦，因为一切都是整数大小的数量。

当你想解压时：

```
uncompressed[0] = compressed[0]
loop
  uncompressed[i] = uncompressed[i-1] ^ compressed[i] 
```

这还具有一个简单的算法的优点，它将运行得非常非常快，因为它只是 XOR。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T02:02:48.290

您是否考虑过[运行长度编码](http://en.wikipedia.org/wiki/Run-length_encoding)？

或者试试这个：不是存储数字本身，而是存储数字之间的差异。1 1 2 2 2 3 5 变为 1 0 1 0 0 1 2。现在您必须编码的大多数数字都非常小。要存储一个小整数，请使用 8 位整数，而不是您将在大多数平台上编码的 32 位整数。那是 4 的因数。如果您确实需要为比这更大的间隙做好准备，请指定 8 位整数的高位表示“这个数字也需要接下来的 8 位”。

您可以将其与游程编码相结合，以获得更好的压缩率，具体取决于您的数据。

这些选项都不是特别难以实现，而且它们都运行得非常快且内存非常少（与 bzip 相反）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T02:09:47.620

[也许答案是以类似于用于创建小型 PNG 图像](http://www.libpng.org/pub/png/spec/iso/index-object.html#9Filters)的过滤的方式对数组进行预过滤。这里有一些想法就在我的脑海中。我没有尝试过这些方法，但如果你喜欢玩，它们可能会很有趣。

1.  将每个整数分解为 4 个字节，因此 i [0]、 i [1]、 i [2]、 ...、 i [n]变为 b [0,0]、 b [0,1]、 b [0,2]、 b [0,3]、 b [1,0] , b [1,1] , b [1,2] , b [1,3] , ..., b [n,0] , b [n,1] , b [n,2] , b [n,3]。然后写出所有的 b [i,0] s，然后是 b [i,1] s、b [i,2] s 和 b [i,3]s。如果大多数情况下您的数字仅相差一两点，您应该得到很好的长时间重复字节，使用 Run-length Encoding 或 zlib 之类的东西应该可以很好地压缩。这是我介绍的方法中我最喜欢的。

2.  如果每个数组中的整数与之前的整数密切相关，您可以存储原始整数，然后存储与前一个条目的差异 - 这应该会提供一组较小的值来提取，这通常会导致更压缩形式。

3.  如果您有各种不同的位，您仍然可能有较大的差异，但如果您更有可能有较大的数字差异对应于（通常）一个或两个不同的位，那么您最好使用创建 ahebyte 的方案数组 - 使用前 4 个字节对第一个整数进行编码，然后对于每个后续条目，使用 0 个或更多字节来指示应该翻转哪些位 - 在字节中存储 0、1、2、... 或 31，有一个哨兵（比如 32）来指示你什么时候完成。这可能导致表示所需的原始字节数和整数平均接近 2，其中大多数字节来自有限的集合 (0 - 32)。通过 zlib 运行该流，也许你会感到惊喜。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T02:11:36.587

您想要预处理您的数据——首先将其可逆地转换为更适合您的后端数据压缩方法的某种形式。详细信息将取决于后端压缩方法，以及（更重要的是）您期望从您正在压缩的数据中获得的属性。

在您的情况下，zlib 是一种按字节压缩的方法，但是您的数据以（32 位？）整数形式出现。您不需要自己重新实现 zlib，但您确实需要阅读它是如何工作的，这样您就可以弄清楚如何使用易于压缩的数据来呈现它，或者它是否完全适合您的目的。

Zlib 实现了一种 Lempel-Ziv 编码形式。JPG 和许多其他的后端使用 Huffman 编码。游程编码在许多特殊用途中很流行。等等等等……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T01:56:11.393

您为此尝试过 bzip2 吗？ [http://bzip.org/](http://bzip.org/)

对我来说，它总是比 zlib 更好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T02:26:12.253

由于您关心的是减少磁盘 IO，因此您需要独立压缩每个整数数组，而不参考其他整数数组。

您的场景的常用技术是存储差异，因为可以使用短代码字对少量差异进行编码。听起来您需要为差异提出自己的编码方案，因为它们是多位差异，也许使用像这样的 8 位字节作为起点：

*   1 位表示后面跟着一个完整的新整数，或者该字节编码与上一个整数的差异，
*   1 位表示后面有更多字节，记录相同整数的更多个位差异。
*   6 位记录从您之前的整数切换的位数。

如果有超过 4 位不同，则存储整数。

如果您还有许多完全不同的代码，则此方案可能不合适，因为它们现在每个占用 5 个字节而不是 4 个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T05:10:14.263

“Zlib 将其缩小了大约 4 倍。” 表示现在100K的文件占用**负**300K；从任何定义来看，这都令人印象深刻:-)。我假设您的意思是将其缩小 75%，即缩小到其原始大小的 1/4。

一种优化压缩的可能性如下（它假定一个 32 位整数和最多 3 位从一个元素到另一个元素变化）。

*   输出第一个整数（32 位）。
*   输出位数变化（n=0-3，2位）。
*   输出 n 位说明符（0-31，每个 5 位）。

这种压缩的最坏情况是每个整数（2+5+5+5 位）发生 3 位变化，这将趋向于原始大小的 17/32（46.875% 压缩）。

我说“趋向于”，因为第一个整数总是 32 位，但是对于任何大小合适的数组，第一个整数可以忽略不计。

最好的情况是相同整数的文件（每个整数没有位更改，只有 2 个零位） - 这将趋向于原始大小的 2/32（93.75% 压缩）。

如果每个连续整数平均有 2 位不同（正如您所说的是您的常见情况），您将获得每个整数 2+5+5 位，这将趋向于 12/32 或 62.5% 的压缩。

您的收支平衡点（如果 zlib 提供 75% 压缩）是每个整数 8 位，这将是

*   单位变化（2+5 = 7 位）：80% 的转换。
*   双位变化（2+5+5 = 12 位）：20% 的转换。

这意味着您的平均每个整数必须更改 1.2 位才能使这变得有价值。

我建议看的一件事是 7zip——它有一个非常自由的许可证，你可以将它与你的代码链接起来（我认为源代码也是可用的）。

我注意到（无论如何我的东西）它在 Windows 平台上的性能比 WinZip 好得多，因此它也可能优于 zlib *。*

# sql-server - SQL Server 2008 或 Excel 中的交叉引用距离图？

> ID：274211
> 
> 赞同：0
> 
> 时间：2008-11-08T02:05:17.210
> 
> 标签：sql-server, excel, charts, grid, distance

我想交叉引用构建一个与[此处类似的距离图表（例如道路距离交叉引用图表）](http://www.servasaustralia.org/index.php?option=com_content&task=view&id=18&Itemid=32)，理想情况下，将数据存储在 SQL Server 2008（最好是 Express 版本）中。它需要这些属性/能力

*   每列都有一个具有相同名称的对应行（即没有像我的示例那样拼写错误）。
*   更改一个 Row-Column 交叉点的值将更新镜像交叉点（Column-Row），或者可以忽略镜像数据。
*   距离值需要最终用户可编辑。
*   最终用户需要能够添加、删除或重命名列/行对。
*   最终用户需要能够对列进行排序并让行自动移动。
*   可能有数百对。
*   查找查询需要找到给定起点和目的地的距离（行和列）

距离图在 Excel 中实现起来相当简单。考虑到这一点，我是不是更好...

*   使用 Excel 作为用户编辑 UI，然后用新数据更新 SQL '东西'？
*   使用 Excel 作为数据源，即使这意味着查询数据的性能问题？
*   使用答案中详述的尚未发现的天才笔触？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T02:52:21.653

对我来说，当然看起来像是一个 Excel 应用程序，从头到尾。（呵呵）

我无法想象您的用户输入了足够多的数据以使性能成为问题。Excel 将只占用 32757 行的同上列。如果这就够了，我会说你是金子。

# algorithm - 填充操作在油漆应用中是如何工作的？

> ID：274213
> 
> 赞同：6
> 
> 时间：2008-11-08T02:08:29.560
> 
> 标签：algorithm, image-processing

所有绘画程序，无论它们多么简单或复杂，都带有填充工具。这基本上用另一种颜色替换了封闭区域的颜色。我知道有不同的 API 可以做到这一点，但我对算法很感兴趣。实现此工具的有效算法是什么？

我能很快想到的几件事是：

1.  将图像转换为二进制图，其中要替换的颜色中的像素为`1`，所有其他颜色为`0`。
2.  在要更改的点周围找到一个封闭区域，使里面的所有像素都为 1，所有相邻的像素都为 0。

[示例图像](http://img206.imageshack.us/my.php?image=toolfillsv5.jpg)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-08T02:15:04.570

许多实现是作为递归征服和划分算法完成的。如果您对“洪水填充算法”进行快速 google，您会发现大量资源，包括关于[该主题](http://en.wikipedia.org/wiki/Flood_fill)的优秀 wikipedia 页面。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T04:15:46.807

洪水填充算法是最常用的。以下是直接来自我的旧大学教科书“使用 OpenGL 的计算机图形学”的一个幼稚版本，作者是 Hearn Baker，第 3 版：

```
void floodFill4 (int x, int y, int fillColor, int interiorColor)
{
  int color;

  /* Set current color to fillColor, then perform the following operations */
  getPixel(x, y, color);
  if (color == interiorColor) 
  {
    setPixel(x,y);  // Set color of pixel to fillColor.
    floodFill4(x + 1, y, fillColor, interiorColor);
    floodFill4(x - 1, y, fillColor, interiorColor);
    floodFill4(x, y + 1, fillColor, interiorColor);
    floodFill4(x, y - 1, fillColor, interiorColor);
  }
} 
```

但是，对于大图像，由于对每个像素进行递归，上述内容可能会给您一个堆栈溢出错误。通常，该算法会被修改，以便在填充一行像素时使用迭代，然后递归地填充上面和下面的行。正如@kasperjj 所说，维基百科对此有一篇很好的文章。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T04:20:07.797

这些算法在[*计算机图形学：原理与实践*](https://rads.stackoverflow.com/amzn/click/com/0201848406)中有详细讨论。如果你有兴趣了解如何在不使用 DirectX 或 OpenGL API 的情况下光栅化线条、填充多边形、编写 3d 代码，我强烈推荐这本书。当然，对于现实世界的应用程序，您可能希望使用现有的库，但如果您对这些库的工作方式感到好奇，那么这是一本很棒的读物。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T02:18:20.630

如果您想要一个不太关心内存效率的高效算法，您可以通过以下方式实现：

1）保留您已经访问过的单元格的布尔内存：`Vis[]`

2）保留您已经访问但尚未标记邻居的点列表：`Busy[]`

3）将这两个都启动为空

4）将您的起点添加到`Busy`

5)

```
while you have a point P in Busy:
{
    for each neighbour N of the point P for which Vis[N] is still false
    {
       if appropriate (not crossing the boundary of the fill region)
       {
           set Vis[N] to true
           update the colour of N in the bitmap
           add N to the end of Busy[]
       }
       remove P from Busy[]
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-11T13:50:29.903

另请阅读有关连接组件标签的信息。这是一种查找连接像素的有效方法，同时只访问每个像素两次。

[维基百科文章。](http://en.wikipedia.org/wiki/Connected_Component_Labeling)

这样做的好处是像素值不一定必须相同，或者将像素描述为连接的函数可能不是原始值 - 也许是梯度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-23T23:30:07.220

一般思想被描述为[洪水填充算法](https://stackoverflow.com/questions/367226/flood-fill-algorithms)，并且对其进行了各种修改。一种常见的方法是扫描线填充。请参阅相关问题[基于扫描线的 2d 渲染引擎如何工作？](https://stackoverflow.com/questions/1217199/how-scanline-based-2d-rendering-engines-works)

# inversion-of-control - Castle-Windsor 是否通过 XML 配置支持 ForwardedTypes

> ID：274220
> 
> 赞同：9
> 
> 时间：2008-11-08T02:12:42.217
> 
> 标签：inversion-of-control, castle-windsor, castle

我有一个实现多个接口的类。我想通过 XML 注册这些接口。我找到的只是新 Fluent Interface 的文档。此选项是否通过 XML 支持？添加此功能将涉及什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-08T03:26:49.337

[**更新**] 这现在可以在 Windsor 2.1 或更新版本中实现。[请参阅此处](http://stw.castleproject.org/Windsor.Registering-components.ashx?NoRedirect=1#Component_with_multiple_services_forwarded_types_5)的语法文档。

* * *

这个特性还没有在 XML 解释器中实现。但是通过工具添加对它的支持并不困难（显然，当想要添加现有配置解析器中缺少的其他特性时，这种技术也很有用）。

因此，首先我们添加了一个工具，它将检测何时为一个类型创建了处理程序，同时将注册任何转发的服务，以便它们指向现有的处理程序：

```
public class HandlerForwardingFacility : AbstractFacility
{
  IConversionManager conversionManager;

  protected override void Init()
  {
    conversionManager = (IConversionManager)Kernel.GetSubSystem(SubSystemConstants.ConversionManagerKey);
    Kernel.HandlerRegistered += new HandlerDelegate(Kernel_HandlerRegistered);      
  }

  void Kernel_HandlerRegistered(IHandler handler, ref bool stateChanged)
  {
    if (handler is ForwardingHandler) return;

    var model = handler.ComponentModel;

    if (model.Configuration == null) return;

    var forward = model.Configuration.Children["forward"];
    if (forward == null) return;

    foreach (var service in forward.Children)
    {
      Type forwardedType = (Type)conversionManager.PerformConversion(service, typeof (Type));
      Kernel.RegisterHandlerForwarding(forwardedType, model.Name);
    }
  }
} 
```

然后当然我们需要在代码中使用它，对于这个例子，我将有一个突变的鸭/狗组件，它支持两个独立的服务 - IDuck 和 IDog：

```
public interface IDog
{
  void Bark();
}

public interface IDuck
{
  void Quack();
}

public class Mutant : IDog, IDuck
{
  public void Bark()
  {
    Console.WriteLine("Bark");
  }

  public void Quack()
  {
    Console.WriteLine("Quack");
  }
} 
```

现在来实际配置容器：

```
 <castle>
  <facilities>
    <facility id="facility.handlerForwarding" type="Example.Facilities.HandlerForwardingFacility, Example" />
  </facilities>
  <components>
    <component id="mutant" service="Example.IDog, Example" type="Example.Mutant, Example">
      <forward>
        <service>Example.IDuck, Example</service>
      </forward>
    </component>
  </components>
</castle> 
```

现在我们可以愉快地执行这样的测试：

```
 WindsorContainer container = new WindsorContainer(new XmlInterpreter());

  var dog = container.Resolve<IDog>();
  var duck = container.Resolve<IDuck>();

  Assert.AreSame(dog, duck); 
```

希望这可以帮助。

# open-source - 什么是提高生产力的最佳免费软件产品？

> ID：274230
> 
> 赞同：60
> 
> 时间：2008-11-08T02:19:35.043
> 
> 标签：open-source

什么是提高生产力的最佳免费软件产品？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-08T02:41:09.587

对于开发人员来说，最好的生产力工具汇编之一——至少对于 Windows 来说是这样——是

[适用于 Windows 的 Scott Hanselman 的终极开发人员和高级用户工具列表](http://www.hanselman.com/tools)

许多（但不是全部）是免费的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-08T02:44:42.123

[谷歌阅读器](http://www.google.com/reader/view/)。

不完全是。

我用它来阅读大量优秀程序员的博客，这本身就是一个很棒的学习工具。

但是，然后，当我发现一个特别有趣的花絮时，我会标记它并保存以备后用。

对于不同的开发领域，我有不同的标签，所以当我在特定领域需要帮助或建议时，我会去那个标签，我有大量适用的建议和代码示例等着我。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-08T02:30:18.110

显然每个人的环境都非常不同，但我一直使用以下内容，发现它们中的每一个都非常有用：

*   颠覆[http://subversion.tigris.org/](http://subversion.tigris.org/)
*   Xcode [http://developer.apple.com/technology/](http://developer.apple.com/technology/)
*   Java [http://java.sun.com/](http://java.sun.com/)
*   海合会[http://gcc.gnu.org/](http://gcc.gnu.org/)
*   NetBeans [http://www.netbeans.org/](http://www.netbeans.org)
*   PostgreSQL [http://www.postgresql.org](http://www.postgresql.org/)
*   OpenSSL [http://www.openssl.org](http://www.openssl.org/)
*   OpenSSH [http://www.openssh.org](http://www.openssh.org/)
*   阿帕奇项目[http://www.apache.org/](http://www.apache.org/)

当然，还有很多我日常使用的其他产品，尤其是像这样的 Google 产品和网站，但这个列表包括我一直使用的东西，我认为它们本身就是令人惊叹的免费软件包。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-11-08T04:34:45.253

堆栈溢出 ：-）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-08T02:23:56.703

Firefox 及其扩展。

[http://www.mozilla.com/en-US/firefox/](http://www.mozilla.com/en-US/firefox/)

如：

*   萤火虫（[http://getfirebug.com/](http://getfirebug.com/)）
*   Web 开发工具栏 ( [http://chrispederick.com/work/web-developer/](http://chrispederick.com/work/web-developer/) )
*   DownThemAll ( [http://www.downthemall.net/](http://www.downthemall.net/) )

（我敢肯定还有很多很多）

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-11-08T07:00:31.793

目前全部免费且所有未付费用：

*   腻子（SSH客户端）
*   vlc（所有视频）
*   vmware player（用于开发服务器）
*   filezilla (s/ftp 客户端)
*   intype（受 textmate 启发的免费 alpha/beta 编辑器）
*   草图（谷歌 3d cad）
*   福昕 (pdf fu)
*   gimp（图片）
*   数字（漂亮的电子表格）
*   virtualbox（创建新虚拟机的免费和开源虚拟化）
*   launchy（真棒发射器）
*   mysql（只是禁用 UAC 以在 Vista 上安装，否则很好）
*   MSYS + MinGW（Windows 的 C 编译器和 gnu 基础知识）
*   pdf creator（windows下打印为pdf）
*   postgresql（不适合在 Windows 上密集使用，但更符合 SQL 标准）
*   prism（从网络应用程序制作桌面应用程序）
*   r（统计）
*   Skype
*   乌龟SVN
*   真加密
*   vim
*   赢SCP

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-11-08T02:56:41.927

不得不说：Emacs。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-11-08T05:56:12.000

我喜欢并在以下方面发现巨大价值的那些：

源代码帮助：
* [http://www.campwoodsw.com/sourcemonitor.html](http://www.campwoodsw.com/sourcemonitor.html) -- 用于源代码指标
* [http://www.mythicsoft.com/agenttransack/](http://www.mythicsoft.com/agentransack/) -- 用于 Windows 中类似 grep 的搜索
* [http:/ /www.componentsoftware.com/Products/CSDiff/](http://www.componentsoftware.com/Products/CSDiff/) - 一个漂亮的视觉差异工具
* [http://www.scintilla.org/SciTE.html](http://www.scintilla.org/SciTE.html) - 轻量级编码文本编辑器
* [http://www.icharpcode.net/OpenSource /SD/](http://www.icsharpcode.net/OpenSource/SD/) - 一个很棒的 IDE（包括 boo 支持）
* [http://www.microsoft.com/express/](http://www.microsoft.com/express/) - MS Visual Studio 2008 Express Editions
* [http://www.flashdevelop.org/wikidocs/index.php?标题=功能](http://www.flashdevelop.org/wikidocs/index.php?title=Features)- 用于 Flash 开发

生产力帮助
* [http://www.python.org](http://www.python.org) - 一种很棒的语言。
* [http://www.cherrypy.org](http://www.cherrypy.org) - 一个很棒的网络框架。
* [http://www.icsharpcode.net/OpenSource/SharpZipLib/Default.aspx](http://www.icsharpcode.net/OpenSource/SharpZipLib/Default.aspx) - Zip 库
* [http://www.blender.org/](http://www.blender.org/) - 3D 创作软件
* [http://www.planetside.co.uk/terragen /](http://www.planetside.co.uk/terragen/) - 自定义 3D 风景生成器
* [http://www.openoffice.org/](http://www.openoffice.org/) - MS Office 替换
* [http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/) - SSH / SFTP 客户端。
* [http://www.red-gate.com/products/reflector/](http://www.red-gate.com/products/reflector/) - 查看 .Net DLL 内部！
* [http://www.mozilla-europe.org/en/firefox/](http://www.mozilla-europe.org/en/firefox/) - 用于网络浏览器。
* [http://www.getpaint.net/](http://www.getpaint.net/) - 图像/照片编辑器
* [http://www.7-zip.org/](http://www.7-zip.org/) - 很棒的压缩工具

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-11-08T02:33:51.473

Paint.NET - 我用它来满足我所有的图形需求。

[http://getpaint.net](http://getpaint.net)

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-11-08T03:39:28.003

The winner is GNU/Linux/Debian/Ubuntu in a landslide!

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2008-11-08T03:48:49.653

I'd say [LaTeX](http://en.wikipedia.org/wiki/LaTeX). It's a document markup language. It makes writing anything involving mathematical symbols a breeze, and the documents can be immediately compiled into postscript or pdf format. It's the standard tool of choice for scientists publishing research papers. Personally, I've used it to write math homework, my resume, personal letters...once you learn it you'll never use MS Word again. Download and documentation can be found [here](http://www.latex-project.org/). Best of all it's completely free, both as in speech and as in beer!

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2008-11-08T03:19:06.763

Launchy (Windows & Linux) AutoComplete 用于运行程序。

智能和零努力的用户界面。您按 Alt-空格键开始输入应用程序名称或文件夹等。启动自动为您完成。

[http://www.launchy.net/](http://www.launchy.net/)

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2008-11-08T04:14:55.590

The GNU tools, from the helpful non-standard switches (-q on grep) to bash, I don't miss the bad old days of using a non-GNU userland.

Linux has already been mentioned, but only once.

vim and gvim, especially with the :vsp (vertical split screen).

Eclipse is big and heavy, but it can be very handy as a window manager when working on big projects on large multi-monitor desktops. Strange, but that's how I use it.

OpenOffice has been the standard office suite for documentation the last few start-ups I've done. OpenOffice 3.0 is a HUGE improvement, especially on the Mac. It also finally supports side-by-side pages (2-up editing) in the word processor.

Bugzilla isn't pretty but has nearly everything I want in a bug tracking system to be able to quantify bug metrics.

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2008-11-08T02:21:56.990

海湾合作委员会，当然。作为一名 Mac 程序员，没有它我就无法完成我的工作。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2008-11-08T03:56:41.383

My favorites:

*   [NUnit](http://www.nunit.org/index.php)
*   [NDoc](http://ndoc.sourceforge.net/)
*   [NAnt](http://nant.sourceforge.net/)
*   [TortoiseSVN](http://tortoisesvn.tigris.org/)
*   [Visual SVN Server](http://www.visualsvn.com/server/)

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2008-11-08T05:44:22.663

1.  .Net 反射器

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2008-11-08T15:20:30.927

除了上述答案之外，我还要提到一些免费的通用实用程序（适用于 Windows），它们在我的程序员生活中可以节省时间，即使它们不一定是编程工具：

*   CLCL，优秀的剪贴板管理器
*   MWSnap 满足我的截屏需求
*   Zoom+ 可仔细查看像素并进行测量
*   VirtuaWin，一台显示器有多个窗口
*   WinMerge 用于文件比较
*   HxD 检查二进制文件
*   7-Zip 用于压缩和解压缩文件（适用于大文件！）
*   FileZilla 满足我的 FTP 需求
*   PuTTY 用于远程登录
*   Wireshark 用于嗅探网络并查看发生了什么
*   BabelMap 查找 Unicode 字符
*   灵活的重命名器来更改文件的名称，使用正则表达式或许多其他方法
*   grepWin 在文件中查找和替换
*   用于许多小任务的 FileMenu 工具
*   WinSpy++ 观看 Windows 消息
*   WinDirStat 看看我硬盘上的空间都去了哪里！
*   所有 Sysinternals 实用程序！
*   SlickRun 运行以上所有内容！

还有更多，但我列出了我每天使用的大部分内容。我省略了文本编辑器（SciTE）和图形编辑器（主要是 Gimp）。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2008-11-08T02:23:27.983

我使用许多很棒的免费软件工具来保持高效率，但我整天都在使用的软件是 OpenSSH 和 VI。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-11-08T03:10:12.103

在 OSX 上：

GUI SVN 客户端 - [http://www.versionsapp.com](http://www.versionsapp.com)

GUI MySQL 客户端 - [http://code.google.com/p/sequel-pro/](http://code.google.com/p/sequel-pro/)

图形用户界面 - [http://code.google.com/p/macvim/](http://code.google.com/p/macvim/)

IRC 客户端 - [http://colloquy.info/](http://colloquy.info/) <= IRC，尤其是 freenode.net 为您的大多数 OSS 项目提供了丰富的资源。通常，您实际上也会遇到开发人员......

Teamviewer - [http://www.teamviewer.com](http://www.teamviewer.com) - 跨越防火墙的跨平台“VNC”，非常适合远程支持

MacPorts - [http://www.macports.com](http://www.macports.com) - 适用于您的 OSX 机器的体面大小的 BSD/Unix 应用程序库。安装 Wireshark 的最简单方法。

Neta - [http://code.google.com/p/neta/](http://code.google.com/p/neta/) - 网络分析器，Wireshark 灯实现

Charles - [http://www.charlesproxy.com/](http://www.charlesproxy.com/) - 我最喜欢的网络调试代理。（无论如何，免费演示。）

Macfuse - [http://code.google.com/p/macfuse/](http://code.google.com/p/macfuse/) - 通过多种不同的协议挂载远程文件系统 - [http://code.google.com/p/macfuse/](http://code.google.com/p/macfuse/)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2008-11-08T02:24:17.140

NetBeans（或 Eclipse）、SVN 和 Firefox。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2008-11-08T14:08:22.680

除了许多已经提到的工具外，我还使用：

*   [ClipX](http://clipx.org)在任何程序中都支持多个剪贴板，不仅在 Visual Studio 中
*   [SlickRun](http://www.bayden.com/SlickRun/)用于快速执行命令
*   [Find and Run Robot](http://www.donationcoder.com/Software/Mouser/findrun/index.html)使用 Locate32 插件进行快速桌面/开始菜单搜索或文件系统搜索
*   [用于键盘重新映射的AutoHotkey](http://www.autohotkey.com/)，带有我自己的键盘映射，

    F4+F4 关闭任何窗口 Alt+Alt 打开 Find and Run Robot 进程列表（类似于 Alt+Tab 但带有过滤器）

    Alt+1 将活动窗口发送到半屏（用于在一台显示器中进行比较）

    Alt+2 将活动窗口发送到半屏

    Alt+0 切换活动窗口以监控 1-2

    ...

*   [MouseGestures](http://www.autohotkey.com/docs/scripts/MouseGestures.htm)（AutoHotkey 脚本）在应用程序中启用鼠标手势

*   [AutoIt](http://www.autoitscript.com/autoit3/)作为通用自动化工具

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-11-08T04:06:52.283

*   editors:

    *   Kate
    *   Quanta+
    *   KDevelop
*   languages:

    *   Python
    *   Lua
    *   Bash
*   libraries:

    *   Django
*   general UI:

    *   KDE
    *   ssh
    *   screens

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-11-08T03:06:53.387

[代码::块](http://www.codeblocks.org/)。它在 Windows 和 Linux 中的工作原理和外观相同，此外还内置了一个分析器，以及您需要来自一个好的 C/C++ IDE 的所有花里胡哨。它比 Eclipse 或 Visual Studio 要快得多。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2008-11-08T06:05:06.383

[ProGuard](http://proguard.sourceforge.net) Java 代码混淆器/收缩器。

无耻的自我插件：我也发现我自己的[RefactorBuddy](http://www.SoftwareMonkey.org/Program)非常宝贵。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2008-11-10T00:23:08.817

这个是用来分发的，但我们不能忘记[Inno Setup](http://www.innosetup.com/isinfo.php)

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-11-08T10:16:44.627

ECLIPSE 是迄今为止我用过的最好的 IDE。因为我几个月前就开始开发 RCP 应用程序，所以它被证明不仅仅是一个 IDE。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-11-08T02:38:38.123

几年前我写过一篇关于这个主题的文章。被称为程序员的[顶级 OSS](http://www.transitionchoices.com/cgi-bin/article.pl?id=17)，我真的不能说我会改变这个列表，除了我稍后发布的这个[更新](http://ploneglenn.blogspot.com/2007/11/son-of-open-source.html)。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-11-12T01:48:06.883

我很惊讶没有人提到现代程序员真正不可或缺的工具 google.com！

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2008-11-08T05:26:21.297

[http://www.taskcoach.org/](http://www.taskcoach.org/)和 [谷歌文档](http://docs.google.com)有利于组织自我。

拥有良好的剪贴板控制也可以节省大量时间。[http://clipdiary.com](http://clipdiary.com)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2008-11-08T10:06:42.963

一个非常好的工具是[WinMover ，它允许您通过 Alt + 单击窗口中的](http://majorgeeks.com/WinMover_d4961.html)*任意位置*并拖动来移动窗口（命令提示符窗口除外 - 啊！）（就像在 Linux 中一样）。因为它不能移动命令提示符窗口，所以失去了一半的用处，但它仍然是一个很棒的工具。

同样在“将酷的东西从 Linux 转移到 Windows”阵营中，[Virtual Dimension](http://virt-dimension.sourceforge.net/)可以方便地使用多个桌面。这不是唯一的解决方案，但它和任何解决方案一样好，也许更好。非侵入性，可合理配置并完成工作。

另一个对屏幕共享有用的工具是[CrossLoop](http://www.crossloop.com/)。它可以很容易地让某人访问您的桌面（包括允许他们共享对您的鼠标/键盘的控制），并且它可以很好地通过防火墙（即，您只需从另一方获得访问代码，然后将其粘贴并敲打） !，您已连接）。

寻找免费（r）替代品的 Total Commander 的粉丝可能会对[FreeCommander](http://www.freecommander.com/)感兴趣。不像 TC 那样流畅，但在功能方面几乎不相上下，甚至还有一些额外的功能（或相同功能的更好实现）。

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2008-11-08T10:49:53.470

另一个非常重要的工具是[junit](http://www.junit.org/)。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-01-20T20:12:51.557

对于差异和合并，SourceGear 的[DiffMerge](http://www.sourcegear.com/diffmerge/)是我免费找到的最好的（虽然不是开源的）。[WinMerge](http://winmerge.org/)和[KDiff3](http://kdiff3.sourceforge.net/)在某些任务上也有其优点。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-04-18T00:42:39.303

在 Mac OS X 上：TextWrangler、Firefox、Firebug。也用于本地 PHP/MySQL 开发的 MAMP。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-04-18T00:46:55.003

没有人说[jQuery](http://jquery.com/) ??

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-01-20T19:46:06.853

For a Mac, it would have to be [TextWrangler](http://www.barebones.com/products/textwrangler/). Great all around programmers text editor.

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-01-20T19:56:59.313

For Windows

*   Reflector - best .NET tool ever
*   Vim and ViEmu for Visual Studio
*   GNU Unix tools (find, grep, tail, wc, etc.)
*   SysInternals tools (pslist, pskill, all the cool monitors, etc.)
*   WinDbg, Sos.dll and sosex.dll - great debugging tools
*   ActiveState Perl

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2008-11-08T10:16:03.850

我经常使用编辑器[jEdit](http://www.jedit.org/)。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2008-11-08T10:59:22.653

Subversion 对我来说是最重要的 OSS 工具。每当我编写没有颠覆的代码时，我都会感到脆弱和不安。

NUnit 是一个强大的 #2

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2008-11-08T11:20:50.707

很多很好的答案。我使用的两个我没有提到过：

*   [Mercurial](http://www.selenic.com/mercurial/wiki/)（源代码控制系统）
*   [PIDA](http://pida.co.uk/)（唯一真正的 IDE）

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2009-03-15T01:27:00.590

我维护的库，正是出于这个原因而创建的：[SixPack](http://code.google.com/p/sixpack-library/)

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-05-04T00:59:34.047

我写的一个免费的像素标尺：

[Windows 标尺](http://www.arulerforwindows.com)

请享用！

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2008-11-21T21:13:30.717

我对这个问题有点惊讶，对大多数答案来说更是如此。这就像在问：我需要一辆新车，我应该买哪辆？

当然有一些一般性的答案，但开源世界已经如此庞大以至于很难告诉你什么是最好的。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2010-10-02T17:47:14.543

对于像我这样的 Web 开发人员，[**Firebug**](http://www.getfirebug.com/)有很大帮助。缺点它仅适用于 Mozilla Firefox。

# java - 在 Java 3d 中将截锥体转换为投影矩阵

> ID：274241
> 
> 赞同：2
> 
> 时间：2008-11-08T02:24:34.283
> 
> 标签：java, java-3d

我需要为考试做准备，这是考试的可能问题。给定一个平截头体方法，如 frustum(-1,1, -0.5, 0.5, 1, 2) 如何将其转换为投影矩阵？上面的例子来自我的教科书，但作者没有详细定义它。如果有人能详细解释这一点，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T03:01:07.673

这在文档中有所描述：http: [//download.java.net/.../ViewModel.html](http://download.java.net/media/java3d/javadoc/1.5.2/javax/media/j3d/doc-files/ViewModel.html) *（在底部）*

# delphi - Delphi 中的 Vista 语音识别

> ID：274255
> 
> 赞同：5
> 
> 时间：2008-11-08T02:35:46.883
> 
> 标签：delphi, windows-vista, speech-recognition, text-services-framework

我希望能够使用 Microsoft Vista 的语音识别在我的 Delphi 应用程序中进行口述。但是，当尝试将口述输入 TMemo 时，它根本不起作用。我注意到 Firefox 3.0 也有同样的问题，在他们联系微软解决这个问题后，他们[告诉](https://bugzilla.mozilla.org/show_bug.cgi?id=395484#c15)他们需要为他们的应用程序实现[文本服务框架](http://msdn.microsoft.com/en-us/library/ms629032(VS.85).aspx)。

我想知道是否有任何方法可以在 Delphi 中实现这一点，以便我可以口述到 TMemo 或 TRichEdit 中。在 Google 上搜索解决方案未返回任何相关结果。我从哪里开始寻找解决方案？

**编辑：**我发现有一种方法可以在所有程序中启用语音识别，即使是那些不支持它的程序，只需转到 Windows Speech Recognition 的选项并选择**Enable dictation anywhere**。但是，当您使用它来指示不使用文本服务框架的编辑框时，它总是会弹出“**替代面板**”，其中显示提示**说您想要的项目旁边的数字，然后是 OK**。虽然这可能适用于短句，但它没有许多有用的功能，例如更正或删除单词。因此，我仍在尝试弄清楚如何在不依赖“**随处启用听写**”选项的情况下启用语音识别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-26T04:48:14.360

我发现有一种方法可以在所有程序中启用语音识别，即使是那些不支持它的程序，只需转到 Windows Speech Recognition 的选项并选择**Enable dictation anywhere**。但是，当您使用它来指示不使用文本服务框架的编辑框时，它总是会弹出“**替代面板**”，其中显示提示**说您想要的项目旁边的数字，然后是 OK**。虽然这可能适用于短句，但它没有许多有用的功能，例如更正或删除单词。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-11-09T05:28:08.797

[Vista中的文字转语音](https://stackoverflow.com/questions/207653/text-to-speech-in-vista)

刚刚使用该页面上的演示代码之类的按钮对其进行了测试，在 Vista SP1/D2007 中运行良好。（有趣的是，我点击了“Vista”标签链接并在那里找到了它......）

# css - 如何在不使用“绝对”或“浮动”的情况下布局侧边栏和主体？

> ID：274265
> 
> 赞同：7
> 
> 时间：2008-11-08T02:49:29.163
> 
> 标签：css, xhtml, html

我一生都无法找到一种方法来完成这项工作。

如果我有 3 个 div（一个左侧边栏、一个主体和一个页脚），我怎样才能让侧边栏和主体彼此相邻而不将它们的位置设置为“绝对”或浮动它们？执行这些选项中的任何一个都会导致页脚 div 不会被其中一个或另一个下推。

无论这些元素之前是什么（比如另一个标题 div 或其他东西），我怎么能做到这一点？

如果它有帮助，这里是我试图允许的两种情况的说明：

![替代文字](https://i.stack.imgur.com/zjEzC.jpg)

这是我目前设置的 HTML 的简化版本：

```
<div id="sidebar"></div>
<div id="content"></div>
<div id="footer"></div> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-08T02:54:14.100

您需要指定页脚以清除浮动：

```
#footer{
 clear: both;
} 
```

这迫使它在浮动元素下。

清除的其他选项是左和右。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-01T07:22:45.803

执行这些选项中的任何一个都会导致页脚 div 不会被其中一个或另一个下推？

试试[这个工具](http://www.pagecolumn.com/2_column_div_generator.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-12T16:46:50.897

现在，如果您不想浮动任何东西，也不想使用 position: absolute，那么您将非常绝望。

剩下的唯一选择是：

*   对侧边栏和内容 div 使用 display:inline-block （目前并非所有浏览器都支持）
*   等待[css 高级布局模块](http://www.w3.org/TR/css3-layout)或其他一些列模块（可能需要永远）
*   回到使用表格

# security - 从 HTTP 表单提交到 HTTPS 是否安全？

> ID：274274
> 
> 赞同：74
> 
> 时间：2008-11-08T03:00:07.847
> 
> 标签：security, https

通过 https 从 http 表单提交是否可以接受？看起来它应该是安全的，但它允许中间人攻击（[这里有一个很好的讨论](http://ask.metafilter.com/48531/are-http-forms-posted-thru-https-secure)）。像[mint.com](http://www.mint.com)这样的网站允许您从 http 页面登录，但会发布 https 帖子。在我的站点中，请求是有一个 http 登录页面，但能够安全登录。是否不值得冒可能的安全风险，我是否应该让所有用户访问安全页面进行登录（或使登录页面安全）？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-08T03:05:14.547

将表单从 http 页面发布到 https 页面确实会在以最简单的术语传输表单中的数据时对其进行加密。如果存在中间人攻击，浏览器会发出警告。

但是，如果原始的http表单被中间人攻击，并且https的回发地址被攻击者修改，那么您将不会收到任何警告。数据实际上仍将被加密，但中间人攻击者将能够解密（因为他首先向您发送了密钥）并读取数据。

此外，如果表单通过其他方式（脚本连接）发回内容，则可能会在表单发布之前通过线路发送未加密的数据（尽管任何好的网站都不会使用任何类型的敏感数据） .

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-11-08T03:08:03.480

是否有任何理由*不在*整个交易中使用 HTTPS？如果你找不到一个很好的，使用它！

*   它可以说比切换协议更简单。

*   MITM 风险是真实存在的。

*   在您的链接之后，用户“Helios”提出了一个很好的观点，即使用 100% HTTPS 对用户的困惑要小得多。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-08T05:56:09.333

这种事情在网络上到处都是，尤其是在登录是可选的网站中。然而，由于非常微妙的原因，它本质上是不安全的，并且给用户一种虚假的安全感。[我认为最近在codinghorror.com](http://codinghorror.com)上有一篇关于此的文章。

危险在于，当您发送带有“ [https://xxx](https://xxx) ”的发布目标的页面时，出现该引用的页面并不安全，因此攻击者可以在传输过程中对其进行修改以指向攻击者的任何 URL愿望。因此，如果我访问您的网站，我必须查看来源以验证我的凭据是否已发布到安全地址，并且该验证*仅*与该特定提交相关。如果我明天回来，我必须再次查看源代码，因为该页面的特定交付可能已受到攻击并且帖子目标被破坏 - 如果我不每次都验证，当我知道帖子目标被破坏时，它是太晚了——我已经将我的凭据发送到了攻击者的 URL。

您应该*只*提供登录页面的链接；只要您登录，登录页面和之后的所有内容都应该是 HTTPS。而且，真的，没有理由不这样做；SSL 的负担在于初始协商；随后的连接将使用 SSL 会话缓存，并且用于链接数据的对称加密实际上是极低的开销。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-16T15:05:30.807

[IE 博客](http://blogs.msdn.com/ie/archive/2005/04/20/410240.aspx)解释：**严重错误 #1：非 HTTPS 登录页面（即使提交到 HTTPS 页面）**

*   用户如何知道表单是通过 HTTPS 提交的？大多数浏览器都没有这样的 UI 提示。
*   用户如何知道它正在访问正确的 HTTPS 页面？如果登录表单是通过 HTTP 传递的，则不能保证它在服务器和客户端之间没有更改。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-08T06:29:21.840

Jay 和 Kiwi 对 MITM 攻击的看法是正确的。然而，重要的是要注意攻击者不必破坏表单并给出一些错误消息；攻击者可以插入 JavaScript 来发送表单数据两次，一次给他，一次给你。

但是，老实说，你不得不问，攻击者拦截你的登录页面并在飞行中修改它的可能性有多大？它与 (a) 在 SSL 会话上进行 MITM 攻击并希望用户按“确定”继续的风险相比如何；(b) 在您最初重定向到 SSL 时执行 MITM（例如，从[http://example.com](http://example.com)到[https://example.com](https://example.com)）并改为重定向到[https://doma1n.com](https://doma1n.com)，这在攻击者的控制之下; (c) 您的网站某处存在 XSS、XSRF 或 SQL 注入漏洞。

是的，我建议在 SSL 下运行登录表单，没有任何理由不这样做。但如果不是，我不会太担心，可能会有很多较低的果实。

## 更新

上面的答案来自 2008 年。从那时起，许多其他威胁变得明显。例如，从随机不受信任的网络（如 WiFi 热点）访问站点（附近的*任何人都*可能发起该攻击）。现在我会说是的，您绝对应该加密您的登录页面，并进一步加密您的整个网站。此外，现在有初始重定向问题的解决方案（HTTP 严格传输安全）。[Open Web Application Security Project](https://www.owasp.org/)提供了几个最佳实践指南。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-08T03:12:19.210

[这篇文章](http://ask.metafilter.com/48531/are-http-forms-posted-thru-https-secure#738842)是关键。是的，如果用户的数据被发送给您，它就会安全地到达某个地方。但是没有理由相信某个地方会是您的站点。此时，攻击者不仅要监听各个方向的数据移动。他将成为用户会话的另一端。您的网站只会认为用户从不费心提交表单。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-08T07:51:31.410

对我（作为最终用户）来说，HTTPS 会话的价值不仅在于数据已加密，而且我已验证我正在输入超级机密的页面来自我想要的位置到。

在非 HTTPS 会话中使用表单会破坏这种保证。

（我知道 - 这只是表示表单受到 MITM 攻击的另一种说法）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T03:14:22.467

不，从 HTTP 转到 HTTPS 是不安全的。请求的发起点和结果点必须是 HTTPS，才能建立和使用安全通道。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-30T18:16:10.970

每个建议您只提供登录页面链接的人似乎都忘记了可以使用 MITM 攻击轻松更改该链接。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-10T23:52:51.070

在上述所有内容中遗漏的最大的事情之一是在主页上放置登录是一种普遍趋势（用户体验趋势中的巨大趋势）。

这里最大的问题是谷歌不喜欢搜索安全页面有充分的理由，所以所有那些想知道为什么不让它全部安全的开发人员，如果你想让你的页面对谷歌不可见，那就确保一切安全。否则，从 http 发布到 https 的第二个最佳选择是此时两害相权取其轻？

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-11-08T19:03:41.817

我认为这个问题的主要考虑与用户知道的 URL 和浏览器默认替换的协议方案 (http:) 有关。

在这种情况下，想要确保加密通道的站点的正常行为是将[http://home-page](http://home-page)重定向到[https://home-page](https://home-page)。仍然存在欺骗/中间人的机会，但如果是通过 DNS 中毒，风险并不比从 https: URL 开始的风险高。如果另一个域名回来了，那么您需要担心。

这可能已经足够安全了。毕竟，如果您受制于有针对性的中间人，您不妨开始担心键盘记录器、您的本地 HOSTS 文件以及各种其他方式来找出涉及您的系统已被拥有的安全交易。

# javascript - 如何从 IE WebBrowser（IHtmlWindow2 或 Javascript）确定导航方向

> ID：274284
> 
> 赞同：0
> 
> 时间：2008-11-08T03:09:17.487
> 
> 标签：javascript, wpf, internet-explorer, browser, mshtml

我正在使用 WPF Web 浏览器控件，当它触发 Navigating 事件时，事件参数始终包含 NavigationMode.New。如果用户从 Web 控件中选择“返回”，则应将其设置为 NavigationMode.Back。

所以它关闭到下面的 COM ActiveX 控件来确定导航的方向。我一直在查看 IHtmlWindow2 和 IHtmlDocument2 和 IOmHistory，但没有看到导航上发生的任何事情来告诉我导航是由后退、前进、新地址还是刷新引起的。

由于 IHtmlWindow 和 Javascript 具有相同的 DOM，也许有人知道如何从 Javascript。

我也一直在查看 IWebBrowser2 界面，但在那里也找不到任何东西。

是否有我需要检查的事件或财产？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T03:27:10.350

事实证明这可能是不可能的。由于 API 模仿了 Javascript API，并且出于安全原因，JS 不应该能够通过 Internet 发送您的浏览历史记录，因此没有通过 COM 的 API。

# php - PHP - 连接到远程数据库非常慢

> ID：274286
> 
> 赞同：3
> 
> 时间：2008-11-08T03:11:27.870
> 
> 标签：php, mysql, dns, lag, remote-connection

我有一个新的 VPS 服务器，我正试图让它连接到同一 ISP 的另一台服务器。当我通过mysql的命令行工具连接时，连接速度非常快。

当我使用 PHP 连接到远程数据库时，连接时间可能需要 5 秒。之后的查询会快速执行。

这不仅限于 mysql，使用 file_get_contents() 从几乎任何其他服务器下载文件都会产生相同的延迟。使用 wget 获取文件没有这个滞后。

我使用 dns_get_record() 在 PHP 中对 DNS 查询进行计时，这些查询速度很快（1-2 毫秒）。

关于 php 配置中可能导致这种情况的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T04:07:20.643

我会检查一下 PHP 正在以什么模式运行，是否出于某种原因将脚本作为 CGI 运行。基本上是 PHP 本身真的很慢，并且只有在运行远程操作时才明显。

检查 Web 服务器的配置。此外，如果它是一个选项，请从命令行尝试 PHP，看看它是否在不涉及 Web 服务器层的情况下表现更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T21:05:41.260

我最终从 PHP 5.1.6 升级到 PHP 5.2.6，问题就消失了。这肯定是 PHP 中的 DNS 查找问题，以下运行大约需要 5 秒：

```
gethostbyname('example.com') 
```

我觉得 IPV6 是一个问题（主要是从网上阅读到的预感），但我没有任何证据。

# xml - 任何使用客户端 XSLT 的大网站？

> ID：274290
> 
> 赞同：22
> 
> 时间：2008-11-08T03:13:29.863
> 
> 标签：xml, xslt, frameworks

最近，我一直在思考在服务器端构建原始 XML，然后在客户端使用 XSLT 样式表将 XML 转换为完整 UI 的有点非主流的体系结构。当然，如果客户端不具备客户端 XSLT 的能力，则必须存在回退机制，在这种情况下，我们只需在服务器端为它们进行转换。

我已经非常熟悉 XSLT，而且这种方法似乎是一种清晰的表示和内容分离，完全将数据强制转换为 XML，并使用 XSLT 进行表示。

我也知道这确实给应用程序增加了一层额外的复杂性，这只是另一个可能失败的移动部分。

我的问题是：是否有任何大牌或大流量网站使用这种方法，如果有：你从中学到了什么限制/教训？

感谢互联网，扎克

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-08T23:49:29.250

就像其他人提到的那样，暴雪有许多客户端 xsl 网站。我建议避免使用客户端 xsl。这是一个非常酷的想法，但是您需要解决许多不寻常的错误。

在 Firefox 中，任何使用 document.write 的 javascript 都会破坏 DOM。此外，firefox 的 noscript 插件会停止客户端 xsl。在这两种情况下，用户都看不到任何东西。似乎没有办法检测到这种错误，所以回退是行不通的。

在 IE 中，如果您有任何 30 倍重定向到不同来源的东西（从 http 到 https 或跨子域），您将收到违反[相同来源策略](http://en.wikipedia.org/wiki/Same_origin_policy)的错误。你并没有真正违反同源政策，但 IE 的行为就像你一样。例如，如果您访问[http://foo.example.com/login](http://foo.example.com/login)并执行 302 重定向到[https://bar.example.com/login.xml](https://bar.example.com/login.xml)，IE 会将 xsl 视为来自 bar .example.com，它会将 xml 视为来自 foo.example.com。因此，您需要恢复为重定向的元刷新等内容。

这些是我从头顶想出来的东西。这是一个好主意，但要注意这些问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T03:49:03.943

我无法详细告诉你它是如何实现的，但是[魔兽世界](http://www.worldofwarcraft.com/index.xml)非常大而且流量很大，而且他们的网站是按照你描述的那样实现的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-09T18:19:26.477

我不知道任何使用客户端 XSLT 转换的大型公共网站（好吧，除了 Joel 提到的魔兽世界 :-)。所以我不能直接回答你的问题。

但是，有时我自己也在思考同样的问题，我有一个假设，互联网上此类网站的数量一定非常接近于零。:-)

这个假设背后的我的理论的简短版本是这样的：除了一些非常奇特的情况外，提供客户端 XSLT 选项根本不值得麻烦。:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T11:07:33.057

我在 2001 年工作的公司发布了一个服务器产品，它完全实现了你描述的架构。我们非常成功地将处理卸载到客户身上。此外，使用 HTTP 用户代理进行客户端检测，我们能够使用服务器端 XSL 处理来满足非常特定的客户端，例如日本手机。我认为使用这种技术的网站/服务/产品对客户来说非常透明。但是，我认为最近的趋势是在服务器端进行处理，这样您就不必依赖或测试针对各种客户端的特定 XSL 实现，并且您可以获得对某些您无法实现的 XSL 扩展的支持在支持绝大多数浏览器时使用。

我知道我并没有直接回答你命名一些大牌网站的问题，但我希望我能为这个问题提供一些有价值的东西。所以，基本上我的观点是，除非进行模板处理节省的性能比必须进行 QA、支持和开发三个或四个没有扩展的浏览器更有价值，否则你应该坚持使用服务器端处理。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-02-06T16:10:44.370

我目前正在使用客户端 XSLT 运行一些小页面，虽然都是瑞典语（lillemanfestivalen.se、resihop.nu 和 beta 项目）。我最担心的是谷歌没有索引我的页面内容，只是没有转换的 XML。然而，自从我一周前启动了 resihop.nu 后，它就在谷歌**上出现了**变化！:D

现在我的另一个问题是 facebook 和其他社交网站，它们不知道如何处理它。然而，我仍然认为有利的一面大于不利的一面。我得到的惊人的速度和分离是可怕的。对于 resihop.nu，我什至不开发单独的 API，我只是将开发人员指向该站点本身。（虽然需要做更多的工作才能使它变得更好）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T06:47:23.580

我同意以利亚的回答。我认为使用客户端 XSLT 是一项艰巨的工作。你必须为此做很多质量检查。但是，对于服务器端，您不需要进行 QA。在使用客户端时，您必须照顾所有类型的客户端和可能性。在使用客户端 XSLT 时，您的代码可能会中断。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T23:40:50.537

当我这么说时，我可能有偏见，但是在基于 Web 的应用程序上工作，我讨厌它。它甚至可行的唯一原因是因为客户端只有 IE6+。即便如此，它也存在问题。我发现 XSLT 非常困难，如果您打算这样做以获得调试和编辑 XSLT 的好工具，我会建议您这样做。为什么不使用 JSON 和 jquery？必须更标准，客户端可变性更少。

# c# - 有人知道.NET 中的货币类型吗？

> ID：274296
> 
> 赞同：20
> 
> 时间：2008-11-08T03:20:41.363
> 
> 标签：c#, .net, currency

有谁知道支持 i18n（货币、格式等）的 .NET 框架已经实现的货币类型？我一直在寻找一种实现良好的类型，但似乎找不到。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-08T03:54:47.037

检查这篇文章[CLR 的货币类型](http://www.codeproject.com/KB/recipes/MoneyTypeForCLR.aspx)

> 一种方便、高性能的 CLR 货币结构，它可以处理算术运算、货币类型、格式以及仔细分配和舍入而不会丢失。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-08T03:44:45.277

我认为您想使用十进制数据类型，并为[ToString()](http://msdn.microsoft.com/en-us/library/fzeeb5cd.aspx)使用适当的重载。

```
CultureInfo current  = CultureInfo.CurrentCulture;
decimal myMoney = 99.99m;

//formats as money in current culture, like $99.99
string formattedMoney = myMoney.ToString("C", current); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T05:12:49.873

我将使用整数/长整数，并使用非常低的面额，如美分（或便士）——这样就没有小数可以使用，所有计算都可以四舍五入到最接近的美分。

或者，看看 Martin Fowler 的《企业应用程序架构模式》一书。在那本书中，他谈到了如何实现货币类。[http://www.amazon.com/Enterprise-Application-Architecture-Addison-Wesley-Signature/dp/0321127420](https://rads.stackoverflow.com/amzn/click/com/0321127420)

# ruby-on-rails - 如何进行自动测试以正确调整单数模型和复数控制器

> ID：274307
> 
> 赞同：2
> 
> 时间：2008-11-08T03:32:33.197
> 
> 标签：ruby-on-rails, tdd

举个例子，如果我有一个`Book`模型和一个自动测试`BooksController`，ZenTest 套件的一部分将获取两者之间的关联并加载`test/unit/book_test.rb`并`test/functional/books_controller_test.rb`进入测试套件。另一方面，如果我有一个`Story`模型和一个`StoriesController`，自动测试拒绝“注意到”`test/functional/stories_controller_test.rb`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-17T20:01:56.683

不幸的是 ZenTest 不是一个 Rails 插件，所以它不能从 ActiveSupport 的复数方法中受益。因此它使用简单的正则表达式来匹配文件名。查看 ZenTest/autotest/rails.rb 以查看 Rails 的现有映射列表。

最后，您有两个选择：

*   (monkey) 修补你自己的映射规则
*   忘记多元化

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-01T19:57:58.087

您可以覆盖`.autotest`文件中的映射。在您的主目录或项目的根目录中。你可以`require 'active_support'`在那里得到`String#pluralize`和`String#singularize`。

借用 rspec-rails 插件中的代码[`lib/autotest/rails_rspec.rb`](http://github.com/dchelimsky/rspec-rails/blob/ba8c3eb84eacb8e9bc449c224cb57deebb7576f6/lib/autotest/rails_rspec.rb)，它似乎已经使用 ActiveSupport 实现了单数/复数的魔力。不过，您可能需要从那里抽出 RSpec 的特定假设。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T02:55:45.467

终于搞明白是怎么回事了，毕竟跟多元化一点关系都*没有。*

它与“*故事*”这个词有关，它可以是一个测试库（RSpec？Cucumber？我忘了）的特殊目录，所以它作为一个例外列在我的 ~/.autotest 配置文件中*！*我不确定我何时将片段剪切并粘贴到文件中，可能是当我第一次开始使用 ZenTest 并且不知道我真正在做什么时。

 *```
Autotest.add_hook :initialize do |at|
  %w{... stories ...}.each {|exception|at.add_exception(exception)}
end 
```

添加一个尾部斜线（“stories/”）恢复了测试并从我的额头上移除了砖痕。

所以我想吸取的教训是：调试时检查杂散的配置文件。

# dns - 通过 IP 进行地理查找是如何工作的？

> ID：274308
> 
> 赞同：28
> 
> 时间：2008-11-08T03:35:25.873
> 
> 标签：dns, ip, ip-geolocation

哪些 IP 分配给哪些 ISP 公开信息？地理 IP 服务如何获取这些信息并维护这些信息？

在不使用这些服务之一的情况下，我如何亲自找出某个 IP 所属的位置？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-10T10:25:45.233

值得一提的是，我在 ISP 行业的高级职位工作了十多年，所以我在这方面有相当多的经验。

[IANA](http://www.iana.org/)会根据需要将大型 IP 范围分配给每个[地区互联网注册管理机构](http://en.wikipedia.org/wiki/Regional_Internet_Registry)。

这些区域的大小通常是大陆性的 - IP 地址 **不是**按国家/地区分配的。

然后，RIR 将 IP 地址分配给 ISP，ISP 又将它们分配给最终用户。

每个 RIR 都维护一个`whois`服务器，可以查询该服务器不仅可以查明哪个 ISP 已分配了任何网络块，还可以在一定程度上查明哪个最终用户以及该最终用户的地址。

请注意，许多 ISP 不会为每个客户填写此信息。因此，如果您是 DSL 服务的住宅用户，地理记录可能会提供您的 ISP 的地址，而不是您自己的地址。

各种 GeoLocation 提供商主要通过挖掘这些`whois`记录来工作。请注意，这样做的合法性是一个灰色地带 - RIPE 的数据库版权声明在[这里](http://www.ripe.net/db/copyright.html)。

IANA 还维护 DNS 的根区域，但它与任何 IP 分配功能完全分开。保持域名操作和IP地址之间的区别非常重要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-05T00:03:36.220

有多种库具有映射表以及可以合并到代码中的服务。

要了解的最重要的事情是，IP 地址与世界任何地方之间**没有直接关系。**这些地址以大块的形式分配给大致地理上的组织，这些组织又分配较小的块，对于任何给定的 IP 地址，这可能发生在多个级别（Alnitak 很好地解释了该过程）。

事实是：WHOIS 数据不一定要准确。如果我有一个地址块，我可以说它在火星上。即使您缩小最终组织的位置（比如阿拉斯加的一个非常小的 ISP），用户也可能使用来自夏威夷的拨号，或者服务器可能托管来自关岛的公司。

因此，在将 IP 地址（或域名）映射到物理位置时，总是存在风险/估计因素。这并不是说您永远不应该这样做，在许多应用程序中，粗糙或不完善的信息非常有用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-11T21:18:39.793

回答关于“它是如何工作的”的具体问题：**涉及大量体力劳动，并且数据库在很大程度上是手动维护的**。正如其他答案所指出的那样，IP范围和国家之间没有真正的相关性，更不用说特定地区了。最近，IP 地址空间分配系统更加分散，这意味着小型私人供应商可以获取 IPv4 地址范围，而不受地理区域的影响。这就是谷歌收购 Urchin 的原因，以便他们可以将他们的服务用于谷歌分析，该分析提供*非常*准确的 IP 到地理区域的信息。

如果您不想使用[MaxMind](http://www.maxmind.com/app/locate_ip)（个人免费使用，并且数据库在一定程度上是开放的）或[Google Analytics](http://www.google.com/analytics/)（个人免费使用）之类的服务，则有免费的（因此总是有些过时的）数据库在四处游荡，有时作为平面文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T03:59:28.460

请注意，数据的更新速度通常很慢，复制速度甚至更慢。几年前，我的工作地点改变了 ISP，我们被分配了一组以前的加拿大 IP 地址（我们位于美国），几个月来，谷歌继续将 google.ca 作为我们的默认搜索引擎。大约 1/2 的时间我的家庭 IP 地址来自我的城镇，另外 1/2 来自另一个州的城镇。

Jason 说得对，流程相同，但更新速度更慢，数据更不准确。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-05T00:08:07.680

Alnitak 的回答非常符合要求。

作为旁注，如果您想使用 .dll 来确定用户的位置，那么您可以尝试在[CodePlex](http://www.codeplex.com/)上找到的这个[IPAddressExtension](http://www.codeplex.com/IPAddressExtensions "点我！ 点我！")。它有一个 ISP 到位置的内部数据库。正如 Alnitak 上面提到的，每个 ISP 都有 IP 块 .. 所以这些信息都隐藏在 .dll 中:)

它真的很容易使用。只需引用 .dll，然后创建[System.Net.IpAddress](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.aspx)对象的实例！扩展名列在上面。

我还需要声明我是那个 codeplex 项目/产品的作者。

请检查一下 ：）

编辑：添加了有关我是该产品作者的信息。

# winsock - 与 BSD 样式的套接字函数相比，使用 windows winsock API 函数有什么好处吗？

> ID：274309
> 
> 赞同：0
> 
> 时间：2008-11-08T03:37:40.737
> 
> 标签：winsock, sockets

与 BSD 风格的函数相比，在 Windows 上使用 WSA winsock 函数有什么好处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T03:39:43.977

仅当您计划部署到像 Windows 95 这样的旧平台或 winsock API 中有一些您绝对不能没有并且您不想滚动自己的东西时（<--值得怀疑）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-09T23:47:30.840

最显着的区别是 Winsock 中异步事件样式 API 的可用性。

使用 Berkeley 套接字，每次您`read`或`write`您的应用程序都会“阻塞”直到网络准备好，这可能会使您的应用程序无响应（除非网络 I/O 在不同的线程中处理）。

使用异步接口，您可以安排在每次接收到数据或传输缓冲区为空时调用回调函数作为正常 Windows 消息循环的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-10T17:28:37.297

如果您围绕 BSD 范式进行设计，您的代码可以在移植工作较少的其他平台上运行。如果您假设您的网络库将支持异步 I/O（正如 Alnitak 所提到的），那么如果从您的手下撤出，您将不得不做更多的工作。

当然，如果你确定永远不会离开微软温暖的怀抱，那就去镇上吧。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T17:22:37.980

关于 Alnitak 的回答，我同意 - 我只是补充一点，您不需要使用消息循环来在套接字上使用异步操作。使用 I/O 完成端口是构建高性能网络应用程序的一种非常可扩展的方式。

# c# - C# WebBrowser HTML with references to scripts and images

> ID：274315
> 
> 赞同：6
> 
> 时间：2008-11-08T03:41:30.900
> 
> 标签：c#, .net, webserver, resources, href

I'm writing a C# app using the WebBrowser control, and I want all content I display to come from embedded resources - not static local files, and not remote files.

Setting the initial text of the control to an embedded HTML file works great with this code inspired by [this post](http://blog.topholt.com/2008/03/18/c-trick-load-embedded-resources-in-a-class-library/):

```
browser.DocumentText=loadResourceText("myapp.index.html");

private string loadResourceText(string name)
{
    Assembly assembly = Assembly.GetExecutingAssembly();
    Stream stream = assembly.GetManifestResourceStream(name);
    StreamReader streamReader = new StreamReader(stream);
    String myText = streamReader.ReadToEnd();
    return myText;
} 
```

As good as that is, files referred to in the HTML - javascript, images like `<img src="whatever.png"/>` etc, don't work. I found similar questions [here](https://stackoverflow.com/questions/72103/how-do-i-reference-a-local-resource-in-generated-html-in-winforms-webbrowser-co#273840) and [here](https://stackoverflow.com/questions/153748/webbrowser-control-from-net-how-to-inject-javascript), but neither is asking *exactly* what I mean, namely referring to *embedded* resources in the exe, not files.

I tried `res://...` and using a `<base href='..."` but neither seemed to work (though I may have not got it right).

Perhaps (following my own suggestion on [this question](https://stackoverflow.com/questions/72103/how-do-i-reference-a-local-resource-in-generated-html-in-winforms-webbrowser-co#273840)), using a little embedded C# webserver is the only way... but I would have thought there is some trick to get this going?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T08:39:10.487

我可以看到三种方法来实现这一点：

1：将您需要的文件写入临时区域中的平面文件，导航`WebBrowser`到html文件，并在页面加载后将其删除

2：正如你所说，一个嵌入式网络服务器 - 也许是`HttpListener`- 但请注意，这使用 HTTP.SYS，因此需要管理员权限（或者你需要[预先打开端口](https://stackoverflow.com/questions/169904/)）

3：与 1 类似，但使用命名管道服务器来避免写入文件

不得不说，第一个简单很多，需要零配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-24T12:44:21.543

```
/// Hi try this may help u.
private string CheckImages(ExtendedWebBrowser browser)
{
      StringBuilder builderHTML = new StringBuilder(browser.Document.Body.Parent.OuterHtml);
      ProcessURLS(browser, builderHTML, "img", "src");                
      ProcessURLS(browser, builderHTML, "link", "href");
      // ext...

      return builderHTML.ToString();

}

private static void ProcessURLS(ExtendedWebBrowser browser, StringBuilder builderHTML, string strLink, string strHref)
{
     for (int k = 0; k < browser.Document.Body.Parent.GetElementsByTagName(strLink).Count; k++)
     {
          string strURL = browser.Document.Body.Parent.GetElementsByTagName(strLink)[k].GetAttribute(strHref);
          string strOuterHTML = browser.Document.Body.Parent.GetElementsByTagName(strLink)[k].OuterHtml;
          string[] strlist = strOuterHTML.Split(new string[] { " " }, StringSplitOptions.None);
          StringBuilder builder = new StringBuilder();
          for (int p = 0; p < strlist.Length; p++)
          {
              if (strlist[p].StartsWith(strHref))                        
                  builder.Append (strlist[p].Contains("http")? strlist[p] + " ":
                      (strURL.StartsWith("http") ?  strHref + "=" + strURL + " ":
                           strHref + "= " + "http://xyz.com" + strURL + " " ));                           
              else
                  builder.Append(strlist[p] + " ");
          }

          builderHTML.Replace(strOuterHTML, builder.ToString());
      }
} 
```

# java - Mixing different versions of Java libraries

> ID：274317
> 
> 赞同：8
> 
> 时间：2008-11-08T03:45:49.613
> 
> 标签：java, dependencies

My project uses Java libraries that have their own dependencies (Hadoop, Jetty for example). I end up with different versions of the same dependencies, like ant 1.4.5, 1.4.6\. My project may want to use ant 1.4.7\. This is a small example, can get more complicated with larger dependencies like HTTP Commons.

How do I get all the libraries and dependencies to play nice? Is there a way to isolate each library (Hadoop, Jetty) so they only use their dependencies?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T04:25:01.403

您可以选择使用依赖管理框架（如 OSGI）来管理所有这些。看看spring框架动态模块[http://www.springsource.org/osgi](http://www.springsource.org/osgi)

您还可以查看 Eclipse 实现 OSGI 的框架部分。看看这里[http://www.eclipse.org/osgi/](http://www.eclipse.org/osgi/)

简短的回答就是寻找最小的公分母。请记住，'endorsed' 目录是您的朋友——在管理冲突的依赖项时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T05:04:31.217

Maven 通常也会很好地处理这个问题。如果不完全，它至少会处理大部分，然后你可以解决剩下的问题。

当然这意味着你必须改变你的构建过程，但你可能值得花点时间不要为此而烦恼。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-10T04:03:54.503

[JarJar](http://code.google.com/p/jarjar/)来救援！

ant 认为 1) 将许多 jar 打包到一个中，2) 允许您重命名类文件中的依赖项，从而加载同一库的两个版本！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T03:57:48.013

If you have the source code, compile everything together. If you don't, unfortunately you will have to target your source for the lowest-common-denominator with the target option to javac. You only have to do this if there are actual issues when running the application, which there rarely should be as long as the jvm is a current version (Java is very strict about binary compatibility with older versions).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T09:21:00.230

JG 提到了 OSGi，这甚至是我在阅读这个问题时的第一个想法。

拥有同一个库的多个版本是 OSGi 的强项。如果我们已经提到了一些第三方产品，我认为提及其背后的规范也是公平的。

您可以从官方 osgi 网站[http://osgi.org获取](http://osgi.org)

# ios - 编辑 UITextField 时如何关闭键盘

> ID：274319
> 
> 赞同：187
> 
> 时间：2008-11-08T03:47:54.100
> 
> 标签：ios, iphone, cocoa-touch, uitextfield, uikeyboard

我知道当我想关闭键盘时，我需要告诉我的 UITextField 让第一响应者辞职，但我不确定如何知道用户何时按下了键盘上的“完成”键。有我可以关注的通知吗？

* * *

## 回答 #1

> 赞同：354
> 
> 时间：2008-11-08T04:16:41.437

我将代表设置`UITextField`为我的`ViewController`班级。

在那个类中，我实现了这个方法如下：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    [textField resignFirstResponder];
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-08T03:51:31.923

如果您将文本字段的 DidEndOnExit 事件连接到 InterfaceBuilder 中的操作 (IBAction)，它将在用户关闭键盘（使用返回键）时收到消息，并且发送者将是对触发事件的 UITextField 的引用。

例如：

```
-(IBAction)userDoneEnteringText:(id)sender
{
    UITextField theField = (UITextField*)sender;
    // do whatever you want with this text field
} 
```

然后，在 InterfaceBuilder 中，将文本字段的 DidEndOnExit 事件链接到控制器上的此操作（或用于链接 UI 事件的任何东西）。每当用户输入文本并关闭文本字段时，控制器都会收到此消息。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-01T20:20:55.590

您还可以在控制器中创建一个方法

```
 -(IBAction)editingEnded:(id)sender{
    [sender resignFirstResponder]; 
} 
```

然后在 IB 的 Connection Inspector 中将事件“Did End On Exit”连接到它。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-11-13T02:44:36.050

库比，谢谢。您的代码有效。就像你说的那样明确（对于新手来说），你必须将`UITextField`'s`delegate`设置为等于文本字段所在的 ViewController 。您可以随心所欲地执行此操作。我选择了`viewDidLoad`方法。

```
- (void)viewDidLoad 
{
    // sets the textField delegates to equal this viewController ... this allows for the keyboard to disappear after pressing done
    daTextField.delegate = self;
} 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2010-12-14T22:51:33.537

这是一个无需代码即可获得自动键盘关闭行为的技巧。在 nib 中，编辑 Identity inspector 中的 First Responder 代理对象，添加一个新的 First Responder 动作；让我们称之为`dummy:`。现在将文本字段的 Did End on Exit 事件挂钩到`dummy:`First Responder 代理对象的操作。就是这样！由于文本字段的 Did End on Exit 事件现在有一个动作-目标对，所以当用户点击 Return 时，文本字段会自动关闭其键盘；并且由于没有为在响应者链上发送的消息找到处理程序不会受到惩罚，因此即使在`dummy:`任何地方都没有实现，应用程序也不会崩溃。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-08-19T00:50:21.337

只需添加

```
[textField endEditing:YES]; 
```

您要在其中禁用键盘并显示选择器视图。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2016-05-08T23:22:18.307

在 Swift 中，您可以在 Controller 中编写 IBAction 并将文本字段的**Did End On Exit**事件设置为该操作

```
@IBAction func returnPressed(sender: UITextField) {
    self.view.endEditing(true)
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2019-07-09T03:26:48.403

`Swift 4.2`它会 100% 工作

```
import UIKit

class ViewController: UIViewController, UITextFieldDelegate {

    @IBOutlet weak var textField: UITextField!

    override func viewDidLoad() {
        super.viewDidLoad()

        self.textField.delegate = self

    }

    // hide key board when the user touches outside keyboard

    override func touchesBegan(_ touches: Set<UITouch>, with event: UIEvent?) {
        self.view.endEditing(true)
    }

    // user presses return key

    func textFieldShouldReturn(_ textField: UITextField) -> Bool {
        textField.resignFirstResponder()
        return true
    }

} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-09-16T07:36:02.660

你也可以使用

```
 - (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
  {

   [self.yourTextField resignFirstResponder];

  } 
```

如果你有很多 Uitextfields 最好的一个：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
 {    
     [self.view endEditing:YES];
 } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-10-01T02:18:30.920

您会注意到“textFieldShouldReturn”方法提供了按下 DONE 键的文本字段对象。如果您设置标签，您可以打开该文本字段。或者您可以跟踪对象的指针并将其与其创建者存储的某些成员值进行比较。

我的自学方法是这样的：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    NSLog(@"%s", __FUNCTION__);

    bool fDidResign = [textField resignFirstResponder];

    NSLog(@"%s: did %resign the keyboard", __FUNCTION__, fDidResign ? @"" : @"not ");

    return fDidResign;
} 
```

同时，我进行了否定辞职的“验证”测试。这只是为了说明，所以如果用户输入 NO！进场，它不会解散。行为如我所愿，但输出顺序与我预期不同。

```
- (BOOL)textFieldShouldEndEditing:(UITextField *)textField {
    NSLog(@"%s", __FUNCTION__);

    if( [[textField text] isEqualToString:@"NO!"] ) {
        NSLog(@"%@", textField.text);
        return NO;
    } else {
        return YES;
    }
} 
```

以下是我拒绝接受的 NSLog 输出。您会注意到我正在返回辞职结果，但我希望它返回 FALSE 给我以向调用者报告？！除此之外，它具有必要的行为。

```
13.313 StudyKbd[109:207] -[StudyKbdViewController textFieldShouldReturn:]
13.320 StudyKbd[109:207] -[StudyKbdViewController textFieldShouldEndEditing:]
13.327 StudyKbd[109:207] 不！
13.333 StudyKbd[109:207] -[StudyKbdViewController textFieldShouldReturn:]：确实放弃了键盘
59.891 StudyKbd[109:207] -[StudyKbdViewController textFieldShouldReturn:]
59.897 StudyKbd[109:207] -[StudyKbdViewController textFieldShouldEndEditing:]
59.917 StudyKbd[109:207] -[StudyKbdViewController doneEditText]：否
59.928 StudyKbd[109:207] -[StudyKbdViewController textFieldShouldReturn:]：确实放弃了键盘

```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-06-21T16:52:57.590

这是我必须做的才能让它工作，我认为对于任何有数字键盘的人来说都是必要的（或任何其他没有完成按钮的人：

1.  我将 ViewController 中的 UIView 更改为 UIControl。
2.  我创建了一个名为

    ```
    -(IBAction)backgroundIsTapped:(id)sender 
    ```

这也在 .h 文件中定义。

在此之后，我链接到 Interface Builder 中 ViewController 的“touch down”位。

在“背景被挖掘”功能中，我放了这个：

```
 [answerField resignFirstResponder]; 
```

请记住将“answerField”更改为您要从中删除键盘的 UITextField 的名称（显然请确保您的 UITextField 定义如下：）

```
 IBOutlet UITextField * <nameoftextfieldhere>; 
```

我知道这个话题可能很久以前就死了......但我希望这会在某个地方对某人有所帮助！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-08T00:54:30.300

**这是使用返回键或在后台触摸结束版本的一种非常干净的方法。**

在界面生成器中，将您的字段嵌入到 UIFormView 类的视图中

这堂课是什么：

*   自动将自身附加为字段委托（从 nib 唤醒或手动添加）
*   保留对当前编辑字段的引用
*   返回时关闭键盘或在后台触摸

这是代码：

*界面*

```
#import <UIKit/UIKit.h>

@interface UIFormView : UIView<UITextFieldDelegate>

-(BOOL)textFieldValueIsValid:(UITextField*)textField;
-(void)endEdit;

@end 
```

*执行*

```
#import "UIFormView.h"

@implementation UIFormView
{
    UITextField* currentEditingTextField;
}

// Automatically register fields

-(void)addSubview:(UIView *)view
{
    [super addSubview:view];
    if ([view isKindOfClass:[UITextField class]]) {
        if ( ![(UITextField*)view delegate] ) [(UITextField*)view setDelegate:self];
    }
}

// UITextField Protocol

-(void)textFieldDidBeginEditing:(UITextField *)textField
{
    currentEditingTextField = textField;
}

-(void)textFieldDidEndEditing:(UITextField *)textField
{
    currentEditingTextField = NULL;
}

-(void)touchesBegan:(NSSet<UITouch *> *)touches withEvent:(UIEvent *)event
{
    [self endEdit];
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    if ([self textFieldValueIsValid:textField]) {
        [self endEdit];
        return YES;
    } else {
        return NO;
    }
}

// Own functions

-(void)endEdit
{
    if (currentEditingTextField) {
        [currentEditingTextField endEditing:YES];
        currentEditingTextField = NULL;
    }
}

// Override this in your subclass to handle eventual values that may prevent validation.

-(BOOL)textFieldValueIsValid:(UITextField*)textField
{
    return YES;
}

@end 
```

*   通过子类化表单并覆盖 `textFieldValueIsValid:`方法，如果给定字段的值不正确，您可以避免编辑结束。

*   如果某个字段在 Interface Builder 中设置了委托，则表单不会更改它。我看不出有很多理由为特定字段设置不同的委托，但为什么不……</p>

有很多方法可以改进这个表单视图类 - 附加一个委托，做一些布局，当键盘覆盖一个字段时处理（使用 currentEditingTextField 框架），自动开始下一个字段的编辑，......

我个人将它保存在我的框架中，并始终将其子类化以添加功能，它通常“按原样”有用。

我希望它会有所帮助。祝大家欢呼

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-11-03T10:25:29.747

如果你想在 UIViewController 中进行所有编辑，你可以使用。

```
[[self view]endEditing:YES]; 
```

如果你想关闭一个特定的 UITextField 键盘隐藏然后使用。

1.在 viewcontroller.h 中添加委托

```
<UITextFieldDelegate> 
```

2.  使委派无法访问您的文本字段。

    self.yourTextField.delegate = self;

3.  将此方法添加到您的视图控制器中。

    -(BOOL)textFieldShouldEndEditing:(UITextField *)textField{ [textField resignFirstResponder]; 返回是;}

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-12-28T05:27:08.270

以编程方式在 swift 3 中设置 UITextField 的委托

**在您的 ViewController.Swift 文件中实现 UITextFieldDelegate（例如 class ViewController: UIViewController, UITextFieldDelegate { ）**

```
 lazy var firstNameTF: UITextField = {

    let firstname = UITextField()
    firstname.placeholder = "FirstName"
    firstname.frame = CGRect(x:38, y: 100, width: 244, height: 30)
    firstname.textAlignment = .center
    firstname.borderStyle = UITextBorderStyle.roundedRect
    firstname.keyboardType = UIKeyboardType.default
    firstname.delegate = self
    return firstname
}()

lazy var lastNameTF: UITextField = {

    let lastname = UITextField()
    lastname.placeholder = "LastName"
    lastname.frame = CGRect(x:38, y: 150, width: 244, height: 30)
    lastname.textAlignment = .center
    lastname.borderStyle = UITextBorderStyle.roundedRect
    lastname.keyboardType = UIKeyboardType.default
    lastname.delegate = self
    return lastname
}()

lazy var emailIdTF: UITextField = {

    let emailid = UITextField()
    emailid.placeholder = "EmailId"
    emailid.frame = CGRect(x:38, y: 200, width: 244, height: 30)
    emailid.textAlignment = .center
    emailid.borderStyle = UITextBorderStyle.roundedRect
    emailid.keyboardType = UIKeyboardType.default
    emailid.delegate = self
    return emailid
}() 
```

// 标记：- 处理委托文本字段..

```
override func touchesBegan(_ touches: Set<UITouch>, with event: UIEvent?) {
    view.endEditing(true)
}

func textFieldShouldReturn(_ textField: UITextField) -> Bool {

    if textField == firstNameTF {

        lastNameTF.becomeFirstResponder()
    }

    else if textField == lastNameTF {

        emailIdTF.becomeFirstResponder()
    }
    else {
        view.emailIdTF(true)
    }
    return true
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-12T10:12:12.773

创建一个函数 hidekeyboard 并将其链接到 .xib 文件中的文本字段并选择 DidEndOnExit

```
-(IBAction)Hidekeyboard    
{    
      textfield_name.resignFirstResponder;    
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-11-13T09:50:29.283

如果你已经使用Interface Builder创建了视图，使用下面的创建方法即可，

```
-(IBAction)dismissKeyboard:(id)sender
{
[sender resignFirstResponder];
} 
```

只需右键单击视图中的文本字段，并将事件设置为退出时结束，并将其连接到方法“dismissKeyboard”。

适合初学者的最佳指南是“Head First iPhone and iPad Development, 2nd Edition”

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-01-31T13:52:16.457

试试这个

```
- (BOOL) textView: (UITextView*) textView shouldChangeTextInRange: (NSRange) range replacementText: (NSString*) text
{
    if ([text isEqualToString:@"\n"]) {
        [textView resignFirstResponder];
        return NO;
    }
    return YES;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-09-14T02:52:43.763

```
//====================================================
//                  textFieldShouldReturn:
//====================================================
-(BOOL) textFieldShouldReturn:(UITextField*) textField { 
    [textField resignFirstResponder];
    if(textField.returnKeyType != UIReturnKeyDone){
        [[textField.superview viewWithTag: self.nextTextField] becomeFirstResponder];
    }
    return YES;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-01-06T15:53:37.583

任何寻找**Swift 3的人**

1) 确保你的**UITextField 的 Delegate**连接到 Storyboard 中的 ViewController

2) 在你的 ViewController.Swift 文件中实现**UITextFieldDelegate** (eg class ViewController: UIViewController, UITextFieldDelegate { )

3）使用下面的委托方法

```
func textFieldShouldReturn(textField: UITextField) -> Bool { 
   textField.resignFirstResponder()  
return false } 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-02-22T08:52:11.867

这就是我在 Swift 4.2 中关闭键盘的方式，它对我有用：

```
 override func viewDidLoad() {
    super.viewDidLoad()

    let tap = UITapGestureRecognizer(target: self, action: 
    #selector(dismissKeyboard))

    view.addGestureRecognizer(tap)
    }

    @objc func dismissKeyboard (_ sender: UITapGestureRecognizer) {
    numberField.resignFirstResponder()
    } 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2017-09-04T22:18:02.740

斯威夫特 3，iOS 9+

`@IBAction private func noteFieldDidEndOnExit(_ sender: UITextField) {}`

UPD：它对我来说仍然很好用。我认为提供此答案的人只是不明白他需要将此操作绑定到情节提要上的 UITextField 。

* * *

## 回答 #22

> 赞同：-6
> 
> 时间：2013-06-24T17:41:34.993

```
textField.returnKeyType = UIReturnKeyDone; 
```

# .net - Best way to make fancy UIs in .NET

> ID：274339
> 
> 赞同：0
> 
> 时间：2008-11-08T04:04:14.503
> 
> 标签：.net, user-interface

How would one create fancy UIs in .NET, with glossy buttons and smooth animations? You can point me to 3rd party frameworks, but I would like to understand the technical details also.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T04:06:31.067

Maybe take a look at [WPF](http://msdn.microsoft.com/en-us/library/ms754130.aspx).

In terms of 3rd party libraries:

*   [DevExpress](http://devexpress.com/)
*   [Telerik](http://www.telerik.com/)
*   [Infragistics](http://www.infragistics.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T04:11:52.867

There's a free toolkit called [Krypton ToolKit](http://www.componentfactory.com/) that has some nice glossy controls.

I hope somebody else posts about where to find out about the actual technical details, as I don't usually go that deep into that sort of code.

WPF is supposed to eventually replace Winforms. Some of what you learn with WPF is transferable to Silverlight as well.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T04:43:21.633

我发现 .NET 对很多这些事情都太过分了，尤其是对于 AJAX 的东西。我会学习使用 jQuery，甚至直接进入 Prototype 库（查看[scriptaculous](http://script.aculo.us/)）。

至于有光泽的按钮，请**找一位出色的设计师**。如果它是一个宠物项目，你可以在那里找到一些很棒的 Photoshop 教程。但是，如果这对客户来说是一个真正的交易项目，那就把一些钱花在一个摇滚明星设计师身上。它会让你的生活更轻松。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T04:46:12.907

或者，更好的是，不要使用非标准的 GUI 工具包或方法。如果在软件中有什么我不能忍受的，那就是过度使用皮肤和样式来使事情看起来更好，而不是可用性成本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T10:05:19.393

银光2.0

# c# - lock(objlocker) 是否使该对象在应用程序范围内线程安全？静态成员是否自动线程安全？

> ID：274344
> 
> 赞同：1
> 
> 时间：2008-11-08T04:07:48.257
> 
> 标签：c#, multithreading, thread-safety, static-members

当您锁定一个对象时，该对象是否在整个应用程序中都被锁定？

例如，这个来自 C# 3.0 的简而言之第 19.6.1 节“线程安全和 .NET 框架类型”中的片段：

```
static void AddItems(  )
  {
    for (int i = 0; i < 100; i++)
      lock (list)
        list.Add ("Item " + list.Count);

    string[] items;
    lock (list) items = list.ToArray(  );
    foreach (string s in items) Console.WriteLine (s);
  } 
```

是否第一次锁定：

```
lock (list)
        list.Add ("Item " + list.Count); 
```

阻止另一个线程访问：

```
lock (list) items = list.ToArray(  ); 
```

还是可以同时执行？

CLR 会自动使您的静态方法线程安全吗？还是这取决于开发商？

谢谢，约翰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T09:42:25.070

要注意的另一件事是静态构造函数由运行时以线程安全的方式执行。如果您正在创建一个单例并将其声明为：

```
public class Foo
{
    private static Foo instance = new Foo();

    public static Foo Instance
    {
        get { return instance; }
    }
} 
```

然后它将是线程安全的。**但是，如果您在**Instance getter 中实例化一个新的 Foo ，那么您需要编写自己的线程安全性（即锁定对象）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T04:13:55.547

CLR 不会自动使静态方法成为线程安全的；你必须自己做。

lock(list) 将该对象用作锁，因此如果不同的线程使用 lock(list) 到达另一个点（具有相同的“列表”对象），则另一个线程将阻塞，直到第一个线程释放锁。

需要明确的是，lock(foo) 不会“锁定 foo 对象”，而是获取与 foo 对象关联的锁，以便临界区（构造“lock(o) stmt”中的语句）仅在以下情况下运行当前线程已获得锁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T04:19:20.807

```
class UsefulStuff {
    object _TheLock = new object { };
    public void UsefulThingNumberOne() {
        lock(_TheLock) {
            //CodeBlockA
        }
    }
    public void UsefulThingNumberTwo() {
        lock(_TheLock) {
            //CodeBlockB
        }
    }
} 
```

`CodeBlockA`并且`CodeBlockB`被阻止在不同的线程中同时执行，因为它们都被锁定在同一个对象实例上`_TheLock`。

方法`_TheLock`本身完全不受影响。

# c# - Binding one collection to multiple tabs with filters

> ID：274348
> 
> 赞同：3
> 
> 时间：2008-11-08T04:14:05.343
> 
> 标签：c#, wpf, vb.net, data-binding, .net-3.5

In my small WPF project, I have a `TabControl` with three tabs. On each tab is a `ListBox`. This project keeps track of groceries we need to buy. (No, it's not homework, it's for my wife.) So I have a list of `ShoppingListItem`s, each of which has a `Name` and a `Needed` property: `true` when we need the item, and `false` after we buy it.

So the three tabs are All, Bought, and Needed. They should all point to the same `ShoppingListItemCollection` (which inherits from `ObservableCollection<ShoppingListItem>`). But Bought should only show the items where Needed is false, and Needed should only show items where Needed is true. (The All tab has checkboxes on the items.)

This doesn't seem *that* hard, but after a couple hours, I'm no closer to figuring this out. It seems like a CollectionView or CollectionViewSource is what I need, but I can't get anything to happen; I check and uncheck the boxes on the All tab, and the items on the other two tabs just sit there staring at me.

Any ideas?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T06:34:12.703

您可以使用[CollectionViewSource](http://msdn.microsoft.com/en-us/library/system.windows.data.collectionviewsource.aspx)通过过滤器重用原始集合。

```
<Window.Resources>
    <CollectionViewSource x:Key="NeededItems" Source="{Binding Items}" Filter="NeededCollectionViewSource_Filter" />
    <CollectionViewSource x:Key="BoughtItems" Source="{Binding Items}" Filter="BoughtCollectionViewSource_Filter" />
</Window.Resources>

<TabControl>
    <TabItem Header="All">
        <ListBox DisplayMemberPath="Name" ItemsSource="{Binding Items}" />
    </TabItem>
    <TabItem Header="Bought">
        <ListBox DisplayMemberPath="Name" ItemsSource="{Binding Source={StaticResource BoughtItems}}" />
    </TabItem>
    <TabItem Header="Needed">
        <ListBox DisplayMemberPath="Name" ItemsSource="{Binding Source={StaticResource NeededItems}}" />
    </TabItem>
</TabControl> 
```

过滤器需要一些代码。

```
private void NeededCollectionViewSource_Filter(object sender, FilterEventArgs e)
{
    e.Accepted = ((ShoppingListItem) e.Item).Needed;
}

private void BoughtCollectionViewSource_Filter(object sender, FilterEventArgs e)
{
    e.Accepted = !((ShoppingListItem) e.Item).Needed;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T05:48:07.417

这里有几个想法：

1.  当标签购买并需要负载时，请自己通过所需的项目创建新的收藏品，或者
2.  当标签购买和需要加载时，覆盖列表项数据绑定并根据需要切换可见性

# ruby-on-rails - 运行单轨单元/功能测试

> ID：274349
> 
> 赞同：30
> 
> 时间：2008-11-08T04:14:37.790
> 
> 标签：ruby-on-rails, unit-testing, automated-tests

如题。

ruby test/functionals/whatevertest.rb 不起作用，这需要我全部替换`require 'test_helper'`为`require File.dirname(__FILE__) + '/../test_helper'`. 出于某种原因，这些测试模板中的大多数都有这样的问题，所以我宁愿看看是否有一个我可以绕过它的 hack。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2011-11-02T19:35:13.830

以下答案基于：[如何从 Rails 测试套件运行单个测试？](https://stackoverflow.com/q/1506780/664833)（堆栈溢出）

但很简单，这是答案：

```
ruby -I test test/functional/whatevertest.rb 
```

对于*特定* `functional`的测试，运行：

```
ruby -I test test/functional/whatevertest.rb -n test_should_get_index 
```

只需将下划线放在测试名称中的空格位置（如上），或引用标题如下：

```
ruby -I test test/functional/whatevertest.rb -n 'test should get index' 
```

请注意，对于`unit`测试，只需在上面的示例中替换`functional`为。`unit`如果您使用**bundler**来管理应用程序的 gem 依赖项，则必须执行以下测试`bundle exec`：

```
bundle exec ruby -I test test/unit/specific_model_test.rb
bundle exec ruby -I test test/unit/specific_model_test.rb -n test_divide_by_zero
bundle exec ruby -I test test/unit/specific_model_test.rb -n 'test divide by zero' 
```

**最重要**的是，请注意`-n`switch 的参数是*测试的名称，并在其前面加上“test”一词*，根据您是否引用名称，使用空格或下划线。原因是这`test`是一种方便的方法。以下两种方法是*等效*的：

```
test "should get high" do
  assert true
end

def test_should_get_high
  assert true
end 
```

...并且可以作为以下*任*一方式执行（它们是*等效*的）：

```
bundle exec ruby -I test test/integration/misc_test.rb -n 'test should get high'
bundle exec ruby -I test test/integration/misc_test.rb -n test_should_get_high 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-13T21:43:19.697

试试这个：

ruby -Ilib:test 测试/功能/whatevertest.rb

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-08T07:50:23.767

在 Linux 上？为什么不试试`(cd test && ruby functionals/whatevertest.rb)`。请注意，括号很重要，否则您的当前目录将更改为子目录。它所做的是`fork`另一个shell，切换到其中的子目录，然后运行测试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-06T09:20:00.553

如果您使用的是 Rails 4，那么 rake 支持文件/目录参数。例子：

```
rake test test/unit/user_test.rb
rake test test/unit 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-08-26T17:25:35.870

标题问题的答案是：

```
ruby unit/post_test.rb -n selected_test # use to run only one selected test 
```

但是对于问题的主体，[tvanfosson](https://stackoverflow.com/users/12950/tvanfosson)给出了很好的答案。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-05T13:45:23.863

在花了无数个小时之后，我终于找到了解决方案（在 Rails 3.0.7 中）：

```
ruby -I test test/functional/users_controller_test.rb -n "/the_test_name/" 
```

**请注意，这仅适用于命令中的下划线 (_)。它不适用于空格！**

将带有空格的测试定义为：

```
test "the test name" do 
```

此解决方案使用模式匹配，因此您可以使用部分测试名称。如果测试是“应该做 foo”，那么下面的任何一个都可以。

```
ruby -I test test/functional/alerts_controller_test.rb -n "/foo/"
ruby -I test test/functional/alerts_controller_test.rb -n "/do_foo/" 
```

以下（带空格）***将不起作用***：

```
ruby -I test test/functional/alerts_controller_test.rb -n "/do foo/" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-27T07:35:13.300

2和3最常规的方法是：

ruby -I 测试测试/功能/your_test_file.rb

# php - 检查实例的类是否实现了接口？

> ID：274360
> 
> 赞同：173
> 
> 时间：2008-11-08T04:24:28.397
> 
> 标签：php, interface, oop

给定一个类实例，是否可以确定它是否实现了特定接口？据我所知，没有内置函数可以直接执行此操作。我有哪些选择（如果有）？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2008-11-08T04:27:41.273

```
interface IInterface
{
}

class TheClass implements IInterface
{
}

$cls = new TheClass();
if ($cls instanceof IInterface) {
    echo "yes";
} 
```

您可以使用“instanceof”运算符。要使用它，左操作数是类实例，右操作数是接口。如果对象实现了特定接口，则返回 true。

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2012-08-20T01:38:40.043

正如[那里](https://stackoverflow.com/users/8331/therefromhere)指出的那样，您可以使用`class_implements()`. 就像反射一样，这允许您将类名指定为字符串，并且不需要类的实例：

```
interface IInterface
{
}

class TheClass implements IInterface
{
}

$interfaces = class_implements('TheClass');

if (isset($interfaces['IInterface'])) {
    echo "Yes!";
} 
```

`class_implements()`是 SPL 扩展的一部分。

见： http: [//php.net/manual/en/function.class-implements.php](http://php.net/manual/en/function.class-implements.php)

# 性能测试

一些简单的性能测试显示了每种方法的成本：

## 给定一个对象的实例

```
循环外的对象构造（100,000 次迭代）
 _______________________________________
| 类实现 | 反射 | 实例 |
|-------|------------|------------|
| 140 毫秒 | 290 毫秒 | 35 毫秒 |
'--------------------------------------------'

循环内的对象构造（100,000 次迭代）
 _______________________________________
| 类实现 | 反射 | 实例 |
|-------|------------|------------|
| 182 毫秒 | 340 毫秒 | 83 毫秒 | 便宜的构造函数
| 431 毫秒 | 607 毫秒 | 338 毫秒 | 昂贵的构造函数
'--------------------------------------------'

```

## 只给出一个类名

```
100,000 次迭代
 _______________________________________
| 类实现 | 反射 | 实例 |
|-------|------------|------------|
| 149 毫秒 | 295 毫秒 | 不适用 |
'--------------------------------------------'

```

昂贵的 __construct() 是：

```
public function __construct() {
    $tmp = array(
        'foo' => 'bar',
        'this' => 'that'
    );  

    $in = in_array('those', $tmp);
} 
```

这些测试基于[这个简单的代码](http://pastebin.com/2xftNXip)。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2008-11-08T07:00:31.030

nlaq 指出`instanceof`可用于测试对象是否是实现接口的类的实例。

但`instanceof`不区分类类型和接口。您不知道该对象是否是一个碰巧被调用的*类*`IInterface`。

您还可以使用 PHP 中的反射 API 来更具体地进行测试：

```
$class = new ReflectionClass('TheClass');
if ($class->implementsInterface('IInterface'))
{
  print "Yep!\n";
} 
```

见[http://php.net/manual/en/book.reflection.php](http://php.net/manual/en/book.reflection.php)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-02-17T10:46:04.350

只是为了帮助将来的搜索[is_subclass_of](http://bg2.php.net/is_subclass_of)也是一个很好的变体（对于 PHP 5.3.7+）：

```
if (is_subclass_of($my_class_instance, 'ISomeInterfaceName')){
    echo 'I can do it!';
} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2020-03-04T01:25:44.240

# 更新

此处缺少该`is_a` [功能](https://www.php.net/manual/en/function.is-a.php)作为替代功能。

我做了一些性能测试来检查哪种方式是最好的。

# 超过 100k 次迭代的结果

```
 instanceof [object] took   7.67 ms | +  0% | ..........
            is_a [object] took  12.30 ms | + 60% | ................
             is_a [class] took  17.43 ms | +127% | ......................
class_implements [object] took  28.37 ms | +270% | ....................................
       reflection [class] took  34.17 ms | +346% | ............................................ 
```

添加了一些点以实际“感觉”看到差异。

由此生成：[https ://3v4l.org/8Cog7](https://3v4l.org/8Cog7)

# 结论

如果您有要检查的*对象*`instanceof`，请使用已接受答案中提到的方法。

如果您有要检查的*课程*，请使用`is_a`.

# 奖金

考虑到你想基于你需要的接口来实例化一个类，使用`is_a`. 只有一个例外 - 当构造函数为空时。

例子： `is_a(<className>, <interfaceName>, true);`

It will return `bool`. The third parameter "[allow_string](https://www.php.net/manual/en/function.is-a.php#refsect1-function.is-a-parameters)" allows it to check class names **without** instantiating the class.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-08-31T09:22:01.070

您还可以执行以下操作

```
public function yourMethod(YourInterface $objectSupposedToBeImplementing) {
   //.....
} 
```

`$objectSupposedToBeImplementing`如果没有实现`YourInterface`接口，它将抛出一个可恢复的错误。

# python - UTF-8 latin-1 转换问题，python django

> ID：274361
> 
> 赞同：3
> 
> 时间：2008-11-08T04:24:45.353
> 
> 标签：python, django, utf-8, character-encoding

好的，所以我的问题是我有字符串 '\222\222\223\225'，它在数据库中存储为 latin-1。我从 django 得到的（通过打印它）是以下字符串，'ââââ¢' 我认为它是它的 UTF 转换。现在我需要将字符串传递给执行此操作的函数：

```
strdecryptedPassword + chr(ord(c) - 3 - intCounter - 30) 
```

我收到此错误：

> chr() arg 不在范围内 (256)

如果我首先尝试将字符串编码为 latin-1，则会收到此错误：

> 'latin-1' 编解码器无法对位置 0-3 中的字符进行编码：序数不在范围内（256）

我已经阅读了很多关于字符编码如何工作的内容，但我缺少一些东西，因为我只是不明白！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T05:29:37.937

您的第一个错误 'chr() arg not in range(256)' 可能意味着您已下溢该值，因为 chr 不能采用负数。我不知道当 inputcounter + 33 大于实际字符表示时加密算法应该做什么，你必须检查在这种情况下该怎么做。

关于第二个错误。您必须对常规字符串对象进行 decode() 而不是 encode() 才能获得数据的正确表示。encode() 接受一个 unicode 对象（以 u' 开头的对象）并生成一个常规字符串以输出或写入文件。decode() 接受一个字符串对象并生成一个带有相应代码点的 unicode 对象。当从字符串对象生成时，这是通过 unicode() 调用完成的，您也可以改为调用 a.decode('latin-1') 。

```
>>> a = '\222\222\223\225'
>>> u = unicode(a,'latin-1')
>>> u
u'\x92\x92\x93\x95'
>>> print u.encode('utf-8')
ÂÂÂÂ
>>> print u.encode('utf-16')
ÿþ
>>> print u.encode('latin-1')

>>> for c in u:
...   print chr(ord(c) - 3 - 0 -30)
...
q
q
r
t
>>> for c in u:
...   print chr(ord(c) - 3 -200 -30)
...
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
ValueError: chr() arg not in range(256) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T06:08:07.047

正如 Vinko 所指出的，Latin-1 或 ISO 8859-1 没有您引用的八进制字符串的可打印字符。根据我对 8859-1 的注释，“C1 控件 (0x80 - 0x9F) 来自 ISO/IEC 6429:1992。它没有定义 80、81 或 99 的名称”。代码点名称与 Vinko 列出的一样：

```
\222 = 0x92 => PRIVATE USE TWO
\223 = 0x93 => SET TRANSMIT STATE
\225 = 0x95 => MESSAGE WAITING 
```

正确的 UTF-8 编码是（Unicode、二进制、十六进制）：

```
U+0092 = %11000010 %10010010 = 0xC2 0x92
U+0093 = %11000010 %10010011 = 0xC2 0x93
U+0095 = %11000010 %10010101 = 0xC2 0x95 
```

带有 CIRCUMFLEX 的拉丁文小写字母 A 是 ISO 8859-1 代码 0xE2，因此是 Unicode U+00E2；在 UTF-8 中，即 %11000011 %10100010 或 0xC3 0xA2。

CENT SIGN 是 ISO 8859-1 代码 0xA2，因此是 Unicode U+00A2；在 UTF-8 中，即 %11000011 %10000010 或 0xC3 0x82。

因此，无论您看到什么，您似乎都没有看到 ISO 8859-1 的 UTF-8 编码。除此以外，您只看到 5 个字节，而您必须看到 8 个字节。

*补充*：答案的前一部分解决了“UTF-8 编码”声明，但忽略了问题的其余部分，其中说：

```
Now I need to pass the string into a function that does this operation:

    strdecryptedPassword + chr(ord(c) - 3 - intCounter - 30)

I get this error: chr() arg not in range(256).  If I try to encode the
string as Latin-1 first I get this error: 'latin-1' codec can't encode
characters in position 0-3: ordinal not in range(256). 
```

您实际上并没有向我们展示 intCounter 是如何定义的，但是如果它每个字符缓慢递增，迟早 ' `ord(c) - 3 - intCounter - 30`' 将是负数（顺便说一下，为什么不结合常量并使用 ' `ord(c) - intCounter - 33`'？），在哪一点，`chr()`很可能会抱怨。如果值为负，则需要添加 256，或使用模运算确保您有一个介于 0 和 255 之间的正值传递给`chr()`. 由于我们看不到 intCounter 是如何递增的，因此我们无法判断它是从 0 循环到 255 还是单调递增。如果是后者，那么您需要一个表达式，例如：

```
chr(mod(ord(c) - mod(intCounter, 255) + 479, 255)) 
```

其中 256 - 33 = 223，当然，479 = 256 + 223。这保证了传递给的值`chr()`是正数，并且对于任何输入字符 c 和任何 intCounter 值都在 0..255 范围内（并且，因为`mod()`函数永远不会得到否定的论点，不管`mod()`它的论点是否定的时行为如何，它也可以工作）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T05:42:00.173

好吧，因为它是用一些糟糕的方案加密的，只是通过一些请求改变了字符的 ord()，所以从数据库中出来的字符串已经被加密，这会解密它。您在上面提供的内容似乎不起作用。在数据库中它是 latin-1，django 将其转换为 unicode，但我无法将其作为 unicode 传递给函数，但是当我尝试将其编码为 latin-1 时，我看到了该错误。

# c++ - 拦截到 memcached 的流量以进行统计/分析

> ID：274375
> 
> 赞同：1
> 
> 时间：2008-11-08T04:51:52.600
> 
> 标签：c++, c, linux, networking, memcached

我想建立一个统计监控平台来监视特定的服务，但我不确定如何去做。处理截获的数据不是我关心的，只是如何去做。一个想法是在客户端应用程序和服务之间设置一个代理，以便所有 TCP 流量首先到达我的代理，然后代理会将截获的消息委托给等待线程/fork 以传递消息并接收结果。另一个是尝试嗅探客户端和服务之间的流量。

我的主要目标是避免客户端和应用程序之间的传输速度出现任何严重损失，但在客户端和服务之间获得 100% 的完整通信。

环境：UBuntu 8.04

语言：c/c++

在后台，我正在考虑使用完全在内存中运行的 sqlite DB 或从属于我的进程的 20-25MB 内存缓存守护进程。

更新：具体来说，我正在尝试跟踪 memcache 守护程序的键的使用情况，将设置/获取成功/失败的数量存储在键上。这个想法是大多数键都有某种分隔字符 [`|_-#] 来创建一种命名空间。这个想法是在守护进程和客户端之间介入，通过配置的分隔符将键分开并记录它们的统计信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T05:08:56.713

你到底想追踪什么？如果您想要一个简单的数据包或字节计数，或基本标头信息，那么 `iptables`将为您记录：

```
iptables -I INPUT -p tcp -d $HOST_IP --dport $HOST_PORT -j LOG $LOG_OPTIONS 
```

如果您需要更详细的信息，请查看`iptables ULOG`目标，它将每个数据包发送到用户空间进行分析。

有关*非常*详尽的文档，请参见[http://www.netfilter.org 。](http://www.netfilter.org)

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T22:16:32.910

如果您想使用嗅探器方式，使用 tcpflow 而不是 tcpdump 或 libpcap 可能更容易。tcpflow 只会输出 TCP 有效负载，因此您无需关心自己重新组装数据流。如果您更喜欢使用库而不是将一堆程序粘合在一起，您可能会对 libnids 感兴趣。

libnids 和 tcpflow 也可用于其他 Unix 风格，并且不限制您仅使用 Linux（与 iptables 相反）。

[http://www.circlemud.org/~jelson/software/tcpflow/](http://www.circlemud.org/~jelson/software/tcpflow/) [http://libnids.sourceforge.net/](http://libnids.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T07:06:01.393

您没有提到一种方法：您可以修改 memcached 或您的客户端来记录您需要的统计信息。这可能是最简单和最干净的方法。

在代理和 libpcap 方法之间，有几个权衡：

```
- If you do the packet capture approach, you have to reassemble the TCP
  streams into something usable yourself. OTOH, if your monitor program
  gets bogged down, it'll just lose some packets, it won't break the cache.
  Same if it crashes. You also don't have to reconfigure anything; packet
  capture is transparent. 

- If you do the proxy approach, the kernel handles all the TCP work for
  you. You'll never lose requests. But if your monitor bogs down, it'll bog
  down the app. And if your monitor crashes, it'll break caching. You
  probably will have to reconfigure your app and/or memcached servers so
  that the connections go through the proxy. 
```

简而言之，代理可能更容易编码，但实现它可能会很痛苦，最好是完美的，否则它会取消你的缓存。更改应用程序或 memcached 对我来说似乎是最明智的方法。

BTW：你看过 memcached 的内置统计报告吗？我认为它的粒度不足以满足您的需求，但是如果您还没有看到它，请在进行实际工作之前先看看 :-D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T13:32:54.013

iptables 提供**libipq**，一个用户空间数据包队列库。从手册页：

> Netfilter 提供了一种机制，用于将数据包从堆栈中传递出来以排队到用户空间，然后将这些数据包接收回内核，并通过一个裁决指定如何处理这些数据包（例如 ACCEPT 或 DROP）。这些数据包也可以在重新注入内核之前在用户空间中进行修改。

通过设置将数据包转发到 libipq的定制**iptables规则，除了为它们指定判决外，还可以进行数据包检查以进行统计分析。**

另一个可行的选择是通过带有套接字过滤器支持的 libpcap 或 PF_PACKET 套接字手动嗅探数据包。

# ruby-on-rails - 如何使用 Rails 跨多个域共享用户会话？

> ID：274384
> 
> 赞同：9
> 
> 时间：2008-11-08T04:58:57.687
> 
> 标签：ruby-on-rails, session, single-sign-on, production

是否有人知道任何允许用户在一个域中登录网站并在同一会话中自动获得对其他合作伙伴域的访问权限的 gem、教程或解决方案？

我有两个 Rails 应用程序正在运行，我们称它们为 App-A 和 App-B。App-A 有一个与之关联的数据库，为 App-A.com 上的注册和登录提供动力。我现在想让所有拥有 App-A.com 帐户的用户访问 App-B.com，而无需让他们重新注册或单独手动登录 App-B.com。

提前感谢您的帮助！ - 标记

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T11:38:45.163

您可以在两个应用程序中设置相同的 session_key。在 appA environment.rb 中更改 session_key，像这样

```
Rails::Initializer.run do |config|
   ...  
 config.action_controller.session = {
   :session_key => '_portal_session',
   :secret      => '72bf006c18d459acf51836d2aea01e0afd0388f860fe4b07a9a57dedd25c631749ba9b65083a85af38bd539cc810e81f559e76d6426c5e77b6064f42e14f7415'
  }
  ...
end 
```

在 AppB 中执行相同的操作。（记得使用相同的秘密）

现在您已共享会话。假设您使用 restfull_authentication，它设置了一个名为**user_id**的会话变量。当您在 appA 中进行身份验证时，它会在会话中设置 user_id。现在，在 appB 中，您只需验证会话中是否存在 user_id。

这是整体架构，您可以使用此想法进行更多详细说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T19:03:52.707

如果您想为您的应用程序创建单点登录解决方案，那么我建议您查看[RubyCAS](http://code.google.com/p/rubycas-server/)解决方案。它还可以用于为其他非 Rails 应用程序提供单点登录，并且您可以将身份验证与 LDAP 或其他身份验证提供程序集成。

# c# - 如何在 C# 中为移动设备确定屏幕的方向？

> ID：274404
> 
> 赞同：4
> 
> 时间：2008-11-08T05:29:38.200
> 
> 标签：c#, user-interface, windows-mobile

我如何在 C#-Application 中知道移动设备的屏幕朝向哪个方向？（即水平或垂直）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T09:23:17.090

在 Microsoft.WindowsMo​​bile.Status 中有一个类可以跟踪设备的各种属性。除了您需要的 DisplayRotation 之外，它还包含有关电话覆盖范围、未接来电数量、下一次约会等的属性。有关详细信息，请参阅[msdn](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.status.systemproperty.aspx)。

您还可以添加一个事件处理程序以通知这些属性的更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T10:59:34.243

向您的项目添加对 Microsoft.WindowsCE.Forms 的引用。然后可以参考Microsoft.WindowsCE.Forms。**SystemSettings.ScreenOrientation**属性，它将为您提供所需的内容。

顺便说一句，你可以设置这个属性，所以它也可以用来设置你的屏幕方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T08:41:31.043

您应该在项目中添加 2 个引用：Microsoft.WindowsMo​​bile Microsoft.WindowsMo​​bile.Status

那么您可以使用此代码来确定方向：

```
int orientation=Microsoft.WindowsMobile.Status.SystemState.DisplayRotation;
if(orientation== 90 || orientation==-90 || orientation==270) //Landscape is 90 or -90 or 270
{
    //your code;
}
else
{
    //your code;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T06:30:53.570

只是猜测，但我的第一次尝试是：

```
var rect = System.Windows.Forms.Screen.PrimaryScreen.Bounds;
// or var rect = System.Windows.Forms.Screen.PrimaryScreen.WorkingArea;

var ratio = rect.Width / rect.Height;

if (ratio == 1.0) // square screen.
if (ratio > 1.0) // landscape.
if (ratio < 1.0) // portrait. 
```

# c# - 使用 SMO 获取表默认值的创建脚本

> ID：274408
> 
> 赞同：4
> 
> 时间：2008-11-08T05:33:51.593
> 
> 标签：c#, sql-server, smo

我正在尝试为我正在使用的本地数据库创建一个数据库脚本工具。

我已经能够为表、主键、索引和外键生成创建脚本，但是我找不到任何方法来为表默认值生成创建脚本。

对于索引，它就像

```
foreach (Index index in table.Indexes)
{
    ScriptingOptions drop = new ScriptingOptions();
    drop.ScriptDrops = true;
    drop.IncludeIfNotExists = true;

    foreach (string dropstring in index.Script(drop))
    {
        createScript.Append(dropstring);
    }

    ScriptingOptions create = new ScriptingOptions();
    create.IncludeIfNotExists = true;

    foreach (string createstring in index.Script(create))
    {
        createScript.Append(createstring);
    }
} 
```

但是 Table 对象没有 Defaults 属性。是否有其他方法可以为表默认值生成脚本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T10:03:19.460

尝试使用带有 DriAll 选项集的[Scripter对象：](https://docs.microsoft.com/en-US/dotnet/api/microsoft.sqlserver.management.smo.scripter?view=sql-smo-160)

```
Server server = new Server(@".\SQLEXPRESS");
Database db = server.Databases["AdventureWorks"];
List<Urn> list = new List<Urn>();
DataTable dataTable = db.EnumObjects(DatabaseObjectTypes.Table);
foreach (DataRow row in dataTable.Rows)
{
   list.Add(new Urn((string)row["Urn"]));
}
Scripter scripter = new Scripter();
scripter.Server = server;
scripter.Options.IncludeHeaders = true;
scripter.Options.SchemaQualify = true;
scripter.Options.SchemaQualifyForeignKeysReferences = true;
scripter.Options.NoCollation = true;
scripter.Options.DriAllConstraints = true;
scripter.Options.DriAll = true;
scripter.Options.DriAllKeys = true;
scripter.Options.DriIndexes = true;
scripter.Options.ClusteredIndexes = true;
scripter.Options.NonClusteredIndexes = true;
scripter.Options.ToFileOnly = true;
scripter.Options.FileName = @"C:\tables.sql";
scripter.Script(list.ToArray()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T08:03:11.293

虽然我没有使用过 SMO，但我查阅了 MSDN，这就是我发现的。

表有一个 Columns 属性（列集合），它应该引用每一列。
每个 Column 都有一个 DefaultConstraint 属性。

这是你想要的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-20T14:48:30.347

**除了帕维尔的答案。**

我只需要为一个单独的表获取脚本。1\. 我想将表模式名和表名作为参数传递并生成脚本。2\. 将脚本分配给变量而不是写入文件。

单个表的代码：

```
/*get a particular table script only*/
Table myTable = db.Tables["TableName", "SchemaName"];
scripter.Script(new Urn[] { myTable.Urn}); 
```

将脚本写入变量：

```
StringCollection sc = scripter.Script(new Urn[] { myTable.Urn });
foreach (string script in sc)
{
    sb.AppendLine();
    sb.AppendLine("--create table");
    sb.Append(script + ";");
} 
```

希望对以后的读者有所帮助。

# qt - OpenGL背景透明度？

> ID：274410
> 
> 赞同：1
> 
> 时间：2008-11-08T05:35:51.043
> 
> 标签：qt, opengl, rendering

我正在使用 QT 的 QGLFramebufferObject 进行离屏渲染。
渲染到缓冲区后，我使用 glReadPixels() 读取结果
问题是，有时我读取的背景颜色只是 0（透明黑色），有时是 0xFF000000（不透明黑色）
这似乎与缓冲区的时间有关初始化。如果缓冲区是从 QGLWidget 继承的类的成员，则为 0。如果在其他任何地方初始化，则为 0xFF000000。

有人知道这里发生了什么吗？这次阅读的良好预期结果是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T06:19:42.377

您是否设置了正确的清除颜色 (glClearColor) 并实际执行清除 (​​glClear)？您是否确保您的颜色写入 (glColorMask) 掩码已完全启用（它也会影响清除）。接下来，您可以检查 QT 是否设置了一些奇怪的像素复制传输（除了默认设置，请参阅 glPixelStore、glPixelTransfer 和 glPixelMap）。您确定在这两种情况下都获取（并读取）RGBA 缓冲区，而不仅仅是 RGB？最后，帧缓冲区对象扩展很有可能在您的特定显卡/驱动程序组合上存在错误，如果没有主要的可见窗口则更是如此。至少检查两家供应商的卡片。当然，在所有可能失败的操作之后总是检查 glGetError 。重新阅读您的问题后，您是否在非 QGLWidget 案例中得到任何其他有效的渲染？清楚地说绿色，返回绿色？因为在这种情况下，您很可能只是没有初始化任何有效的 OpenGL 上下文。帧缓冲区对象，不像 pbuffers 需要外部上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T07:24:16.363

谜团解开
了看来我给GLWidget的清色是0，默认清色是0xff000000。根据我初始化帧缓冲区对象的时间，它会接收 GLWidget 的当前清除颜色。

# .net - 存储过程真的能提高 MS SQL / .NET 的性能吗？

> ID：274411
> 
> 赞同：25
> 
> 时间：2008-11-08T05:41:01.843
> 
> 标签：.net, sql-server, performance, stored-procedures

[Jeff Atwood在这里](https://blog.codinghorror.com/who-needs-stored-procedures-anyways/)写了这篇文章，虽然我理解存储过程可以提供的理论上的性能提升，但它看起来确实是一个巨大的痛苦。

使用存储过程时，您会看到哪些类型的查询能够最大程度地提高性能，您更愿意即时构建哪些类型的查询？

任何一种或另一种方式的文档将不胜感激。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-08T05:54:45.453

存储过程/无存储过程参数已成为一个宗教问题。对于每个强调 procs 优化执行计划的人来说，另一个人指出常见的动态查询在大多数现代 DBMS 中被缓存和优化。对于任何指出 proc 可能提供的安全性的人，另一个人解释说动态查询可以同样安全。一些人喜欢在不重新编译应用程序的情况下更改 proc 的灵活性，而另一些人则认为应该在应用程序代码中捕获查询，以便它们在相同的代码库中生存和发展。

我说...

你喜欢什么。我怀疑我们能否得出正确的答案。如果 procs 很麻烦，请不要使用它们。如果它们看起来是个好主意，那就去做吧。我已经使用过这两种模型，老实说，我没有偏好。不管有没有他们，我都很有效率。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-08T08:59:49.027

在过去的日子里，使用存储过程有*相当大*的性能优势，但查询计划重用现在明显更好，因此在许多情况下两者几乎相同。

如果您在服务器上构建动态 SQL，则可以通过使用 sp_ExecuteSQL（而不仅仅是 EXEC）来执行 SQL，从而进一步提高查询计划的重复使用（和注入安全性）。

使用存储过程有一些优点：

*   他们准确地修复了数据库将发生的事情
*   对于严格的安全场景，您可以严格控制对存储过程（而不是表）的访问
*   如果计划在某些地方变得怪异（嗅探），您可以细分查询

但是，SQL 也有一些优点：

*   它允许 ORM 工具（例如 LINQ）即时编写可组合查询（第 4 页，按 Foo,Bar 排序）
*   它允许您以更具表现力的语言编写动态代码（TSQL 并不是真的打算用来编写 TSQL！）
*   你通常有更好的工具

我肯定会使用 SP 的一些事情是在（例如）数据迁移步骤中 - 即对于批量操作，我可能使用 SqlBulkCopy 将数据推送到临时表中，然后使用存储过程来移动数据。除此之外，我相当灵活。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-08T18:15:19.140

与软件一样，SQL 缓存问题比看起来更微妙。例如，让我们看一下**临时 SQL**查询的缓存：

```
-- First, clear the cache
DBCC FREEPROCCACHE

-- Look at what executable plans are in cache
SELECT sc.*
FROM master.dbo.syscacheobjects AS sc
WHERE sc.cacheobjtype = 'Executable Plan'

-- Execute the following statement
SELECT t.*
FROM pubs.dbo.titles AS t
WHERE t.price = 19.99

-- Look at what executable plans are in cache and you'll 
-- find that there's a plan for a NUMERIC(4,2)
SELECT sc.*
FROM master.dbo.syscacheobjects AS sc
WHERE sc.cacheobjtype = 'Executable Plan'

-- If you execute the EXACT same statement with a 4,2 
-- then you will get THAT plan. But if you execute with a 5,2
-- then you'll get a new plan. Try this:
SELECT t.*
FROM pubs.dbo.titles AS t
WHERE price = 199.99

-- Look again at the cached executable plans, and you'll see a NEW one...
SELECT sc.*
FROM master.dbo.syscacheobjects AS sc
WHERE sc.cacheobjtype = 'Executable Plan' 
```

但是，您可以使用**sp_executesql**键入参数并强制缓存计划。所有后续使用都会得到相同的计划，但是有些人不喜欢这种方法的晦涩难懂：

```
DECLARE @ExecStr nvarchar(4000)
SELECT @ExecStr = N'SELECT t.* FROM dbo.titles AS t WHERE t.price = @price'
EXEC sp_executesql @ExecStr, N'@price money', 19.99 
```

现在，如果您创建一个类似的查询作为带有价格参数的**存储过程**，则该计划将在第一次执行时创建并缓存在内存（而不是磁盘）中，并且无论参数的值如何都可以重用。

存储过程计划缓存在内存中而不是磁盘上的事实意味着它会在服务器重新启动时或由于低重用率而从缓存中消失。如果过程所依赖的数据变化到足以导致统计信息失效，它也可能会从缓存中掉出来。这会导致 SQL Server 使计划无效。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-08T09:24:04.110

我们发现存储过程的一个好处是，一旦由开发人员最初创建，它们可以移交给 DBA 或数据库调优专家，以便在需要时出于性能原因更好地编写。

DBA 显然不需要访问应用程序代码来执行此操作，并且可以与待处理的应用程序发布一起工作。

当然，内联或嵌入式 SQL 查询也是如此，但我认为存储过程更适合这种合作的、更大的团队工作方式。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-08T08:39:26.087

在我看来，存储过程的最大优点是：

1/ 它们集中在数据库管理系统中，因此 DBA 确切地知道他们在做什么，并且可以优化数据库以适应他们。来自客户的即席查询更难做到这一点。我已经看到数据库因为 DBA 允许不受限制的查询而被收购。他们还迫使客户考虑他们需要什么。

2/ 他们可以在服务器上进行非常复杂的处理，从而最大限度地减少通过网络发送的数据量。这使应用程序免于获取大量数据、从中做出决定、然后获取更多数据等等。

无论如何，在开发过程中允许任何随机查询，但在您投入生产之前，请确定哪些数据库操作应该移动到存储过程中。

作为兼职 DBA，我认为这意味着所有这些，但只要您对应用程序可以发送的查询保持一点控制，就没有必要。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-08T05:58:51.683

提供性能优势的存储过程是 SQL Server 早期版本的神话。SQL Server > 版本 7 对所有查询一视同仁，并将缓存所有常用查询的执行计划，无论它们的起源如何。

我想知道这个神话还会存在多少年。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-08T05:46:41.957

Frans Bouma 不久前就这个话题[引起了轰动。](http://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)

在 SQL Server 上，更重要的是要了解任何性能提升都是由于缓存了查询计划。查询计划的编译成本非常高，因此缓存它们是有意义的。编辑：即席 SQL 不太可能与缓存的查询计划匹配。如果通过调用 sp_executesql 运行动态 SQL，则可以缓存它。

如果您使用 EXEC 运行 SQL，例如'EXEC @dynamic_sql'，它将缓存一个计划但不会参数化（或规范化它），这意味着除非发送完全相同的查询，否则它将不会重新使用缓存的查询计划。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-08T11:41:19.153

存储过程背后的一个想法是，它允许您在一次访问数据库中做几件事。

MSSQL 允许在单个请求中提交查询批次；这大致等价。

但是，原理是一样的。在大规模分布式系统中，数据库延迟（而不是查询在服务器上花费的时间）可能是一个性能问题。发出更少的查询可能是有益的。

因此，使用查询批处理或存储过程与发出单个查询相比，在分布式系统中是一种潜在的性能优势。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-08T05:44:42.803

存储过程更快背后的想法是它们可以存储缓存的查询计划，有点像预编译存储过程。因此，如果该过程非常复杂，大量表之间有大量连接，您可能会看到速度优势。

我认为存储过程需要的不仅仅是它们的速度，它们有助于抽象数据库模式并有助于防止 sql 注入攻击。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-08T06:09:36.763

写得不好的存储过程不会提高性能。与糟糕的内联查询相同，其性能将比经过深思熟虑的查询更差。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-08T19:55:42.210

人们正在跳过的一件事是所有这些 CRUD 存储过程都充满了合并和 if 语句，这些语句非常缓慢。

如果您使用参数化语句与使用存储过程的合并，则动态语句将获胜。

# .net - 如何在 C#.NET 中保持存储过程 DRY？

> ID：274418
> 
> 赞同：3
> 
> 时间：2008-11-08T05:45:55.843
> 
> 标签：.net, stored-procedures, dry

我们对数据库的*每个查询*都使用存储过程。这似乎令人难以置信的未[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)：

1.  设计桌子
2.  为该表设计 CRUD 操作 SP
3.  设计代码（最好是一个类）来填充参数并执行 CRUD SP

如果我们添加单个列或更改数据类型，我们必须在 .NET 的一个类中编辑表、少量 SP 和少量函数。

有哪些减少这种重复的技巧？

更新：

结合 Vinko 的想法，我发现[了这个](http://aspnet.4guysfromrolla.com/articles/092408-1.aspx#postadlink)。这是我为需要它的人提出的一些代码（在 C# 中）：

```
SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["MySQLConnString"].ConnectionString);
SqlCommand comm = new SqlCommand("NameOfStoredProcedure", conn);
comm.CommandType = CommandType.StoredProcedure;

conn.Open();
SqlCommandBuilder.DeriveParameters(comm);
conn.Close();

foreach (SqlParameter param in comm.Parameters)
{ /* do stuff */ } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T05:50:49.390

我建议使用代码生成工具，例如 NetTiers 来生成您的 CRUD 层。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T06:03:13.577

避免修改至少 SP 的一个技巧是编写它们以使用“自省”，即从内部表或 information_schema 视图中推断列名和数据类型。

它的代码编写起来更复杂，但它可以避免每次表更改时都必须修改它，并且可以在其余的 SP 中重用。

创建一个将为您描述表的 SP，例如使用您将从其余 SP 调用的临时表（colname varchar，type varchar）。

顺便说一句，如果您的查询很复杂，这可能会变得非常复杂甚至不可行，但另一方面，如果不是，它可以为您节省很多麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T05:53:13.613

OOP 设计原则适用于过程代码，而不是声明性代码。特别是，重用 SP 是非常成问题的。

基于 CRUD 生成器的 UI 设计很有名。另一种将用户明确转变为数据录入员的方法。如果您使用这些，请确保您在它们产生的内容和用户必须处理的内容之间有一个很好的抽象层。

> 如果我们添加单个列或更改数据类型，我们必须在 .NET 的一个类中编辑表、少量 SP 和少量函数。

听起来您的数据库设计确实决定了您的 OOP 要求。而是从另一个方向开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T06:05:44.463

一旦 SQL 超出单个表，所有这些元查询方法都会死掉。或者想要一个计算列。或者 ...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-09T22:49:02.487

就个人而言，我不太喜欢将查询代码放入存储过程中。除了高度复杂的事情外，这似乎是多余的矫枉过正。

以下是我处理数据库和 crud 对象设计的方式：

1.  我创建数据模型
2.  我为每个表创建一个视图
3.  我为每个表创建插入、更新和删除过程。
4.  我所有的 C# 代码都指向视图和过程。

这使我能够：

1.  拥有高度灵活的查询目标（视图）
2.  以我需要的任何方式查询视图，无需冗余。
3.  通过数据库安全性防止直接访问表
4.  抽象数据模型，以防我需要在不破坏代码的情况下重构底层数据模型（我知道，这可能会产生性能成本）

拥有一个代表目标表的视图可能会处理许多查询，即使没有，最糟糕的情况是您需要专门为查询创建一个视图，这相当于为它创建一个 proc，所以没有缺点。

我听说有人建议使用存储过程来防止 SQL 注入攻击，但是如果您在查询视图时使用参数化查询，这无论如何都不是问题。...而且我们总是以任何方式使用参数化查询...对吗？;-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T15:50:52.177

您使用的“DeriveParameters”方法确实有效，但每个请求涉及 2 次数据库旅行。这种方法会对性能产生影响。Microsoft 的数据访问应用程序块 SqlHelper 类将通过执行完全相同的“自省”来缓解这种情况，但可以选择缓存参数以供重用。这将让您创建单行 SP 调用，而无需重复“goo”设置参数等。

[http://msdn.microsoft.com/en-us/library/cc309504.aspx](http://msdn.microsoft.com/en-us/library/cc309504.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T10:16:46.407

我不认为这真的属于 DRY 指南。这只是关于持久性，如果您手动执行#3，那么您应该考虑采用使这更容易的工具集之一。LINQ to SQL 是我个人最喜欢的，但也有很多。

您的#2 也可以轻松实现自动化。减少1）设计数据模型（在概念上）2）在持久层实现它（创建表或添加列）3）在应用程序级别使用它所需的整体工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-09T22:53:15.177

有些表没有 CRUD，不应该从您的应用程序访问，并且是数据库实现模型的工件。特别是，您的应用程序不应访问多对多链接表，它们应由数据库通过存储过程进行管理。

# c# - 内置 .Net 算法将值四舍五入到最接近的 10 间隔

> ID：274439
> 
> 赞同：71
> 
> 时间：2008-11-08T06:05:52.030
> 
> 标签：c#, math, rounding

如何在 C# 中将任何值舍入到 10 间隔？例如，如果我有 11，我希望它返回 10，如果我有 136，那么我希望它返回 140。

我可以很容易地用手做

```
return ((int)(number / 10)) * 10; 
```

但我正在寻找一种内置算法来完成这项工作，比如 Math.Round()。我不想手动做的原因是我不想在我的项目中编写相同或相似的代码，即使是像上面这样简单的事情。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-11-08T07:13:29.223

类库中没有内置函数可以执行此操作。最接近的是[System.Math.Round()](http://msdn.microsoft.com/en-us/library/system.math.round.aspx)，它仅用于将 Decimal 和 Double 类型的数字舍入到最接近的整数值。但是，如果您使用的是 .NET 3.5，则可以将语句包装在扩展方法中，这将使您可以更干净地使用该函数。

```
public static class ExtensionMethods
{
    public static int RoundOff (this int i)
    {
        return ((int)Math.Round(i / 10.0)) * 10;
    }
}

int roundedNumber = 236.RoundOff(); // returns 240
int roundedNumber2 = 11.RoundOff(); // returns 10 
```

如果您正在针对旧版本的 .NET 框架进行编程，只需从 RoundOff 函数中删除“this”，然后像这样调用该函数：

```
int roundedNumber = ExtensionMethods.RoundOff(236); // returns 240
int roundedNumber2 = ExtensionMethods.RoundOff(11); // returns 10 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-08T06:22:17.860

使用 Math.Ceiling 总是四舍五入。

```
int number = 236;
number = (int)(Math.Ceiling(number / 10.0d) * 10); 
```

Modulus(%) 得到余数，所以你得到：

```
// number = 236 + 10 - 6 
```

将其放入扩展方法中

```
public static int roundupbyten(this int i){
    // return i + (10 - i % 10); <-- logic error. Oops!
    return (int)(Math.Ceiling(i / 10.0d)*10); // fixed
}

// call like so:
int number = 236.roundupbyten(); 
```

以上编辑：我本应本能地使用 Math.Ceiling

我[在计算 UPC 校验位时写了一篇博客](http://atomiton.blogspot.com/2007/12/calculating-checkdigit-using.html)。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-11-24T07:16:18.870

这可能有点太晚了，但我想有一天这可能会有所帮助......

我试过这个：

```
public int RoundOff(int number, int interval){
    int remainder = number % interval;
    number += (remainder < interval / 2) ? -remainder : (interval - remainder);
    return number;
} 
```

要使用：

```
int number = 11;
int roundednumber = RoundOff(number, 10); 
```

这样，您可以选择将间隔的一半向上舍入还是向下舍入。=)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-08T06:18:12.660

将浮点数舍入为整数类似于 (int)(x+0.5)，而不是简单地转换 x - 如果您想要 10 的倍数，您可以轻松适应它。

如果您只想进行整数数学并将其四舍五入到十，请尝试 (x+10/2)/10*10。

**编辑：**我注意到这个回复不符合原作者的要求，也是一种我不喜欢做的有偏见的四舍五入形式。然而，另一个接受的回应已经指出 Math.round()，这是一个更好的解决方案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-24T04:24:08.760

老问题，但这里有一种方法可以完成所要求的事情，而且我将其扩展为能够将任何数字四舍五入到你想要的 sig figs 的数量。

```
 private double Rounding(double d, int digits)
    {
        int neg = 1;
        if (d < 0)
        {
            d = d * (-1);
            neg = -1;
        }

        int n = 0;
        if (d > 1)
        {
            while (d > 1)
            {
                d = d / 10;
                n++;
            }
            d = Math.Round(d * Math.Pow(10, digits));
            d = d * Math.Pow(10, n - digits);
        }
        else
        {
            while (d < 0.1)
            {
                d = d * 10;
                n++;
            }
            d = Math.Round(d * Math.Pow(10, digits));
            d = d / Math.Pow(10, n + digits);
        }

        return d*neg;
    }

   private void testing()
   {
       double a = Rounding(1230435.34553,3);
       double b = Rounding(0.004567023523,4);
       double c = Rounding(-89032.5325,2);
       double d = Rounding(-0.123409,4);
       double e = Rounding(0.503522,1);
       Console.Write(a.ToString() + "\n" + b.ToString() + "\n" + 
           c.ToString() + "\n" + d.ToString() + "\n" + e.ToString() + "\n");
   } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-06T04:56:07.060

我宁愿不引入`Math`库也不要使用浮点数，所以我的建议是像下面这样进行整数运算，然后向上舍入到下一个 1K。如果您不想重复，请将其包装在方法或 lambda 片段或其他内容中。

```
int MyRoundedUp1024Int = ((lSomeInteger + 1023) / 1024) * 1024; 
```

我没有对这种方式与其他方式进行性能测试，但我敢打赌这是最快的方式来保存可能是位的移位和旋转版本。

# iphone - 使用默认选项卡控制器创建项目...第一个视图控制器不响应 addsubview

> ID：274457
> 
> 赞同：0
> 
> 时间：2008-11-08T06:33:41.147
> 
> 标签：iphone, objective-c, ios, cocoa-touch

我使用默认选项卡控制器项目创建了一个项目。我正在使用界面生成器来编辑 .xib 文件并添加图像和按钮。我将它们连接到界面生成器中的 FirstViewController 对象（我创建并将其类设置为与代码文件相同）。我使用`IBoutlets`and连接了所有东西`IBActions`。

一切工作正常，但后来我在界面构建器中做了一些更改（添加了`UILabel`一个就好像它没有被执行一样。该方法（和代码运行）执行没有错误（根据调试器），但视图根本没有被添加。这发生在我通过界面生成器进行一些更改之后。

现在，如果我通过单击适当的选项卡并将 拖到 将按钮连接到“选定的第一个视图控制器” ，`IBOutlet`则`UILabel`该标签现在具有多个引用出口。现在，如果我对按钮执行相同的操作，方法 (the `IBAction`) 会执行两次，但实际上会添加并显示子视图。但是，我得到一个内存访问错误，因为我的`IBAction`（按钮）方法访问了一个存储一些东西的属性。我猜这与以某种方式在第一个视图控制器中创建内存但试图在选定的第一个视图控制器中访问它有关？如果那有意义的话？

我不知道为什么会发生这种情况，为什么只是按钮突然停止工作。我试图尽我所能解释这个问题，这有点令人困惑。但是，如果有人有任何提示或想法，我很想听听你们对这个问题的看法以及如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T16:28:52.770

听起来 - 如果我弄错了，请随时纠正我 - 您正在将选项卡栏加载的视图中的操作附加到选项卡栏的控制器。这两个实体完全不同，您希望从视图访问的任何数据都应该从视图的控制器而不是选项卡栏的控制器（在加载和卸载其他视图控制器时应该有一个相当轻量级的工作）引用。同样，您不应该向视图控制器添加子视图，它不知道如何处理子视图 - 您应该使用视图控制器向视图添加子视图。虽然看起来是语义问题，但视图控制器与视图根本不同。前者负责管理视图的内容和行为并响应视图'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T13:15:45.017

您确定第一个插座实际上已连接。如果您命名一个插座，使其与在 nib 加载时设置的其他一些属性冲突（通过 initWithCoder:），它可能导致事情最终无法正确连接。您可以通过 NSLog'ing 输出 awakeFromNib 中的网点值来检查这一点。

# asp.net - Ajax 下拉列表限制

> ID：274459
> 
> 赞同：2
> 
> 时间：2008-11-08T06:35:20.567
> 
> 标签：asp.net, ajax, controls

几乎和标题所说的一样。

我正在使用 Ajax 下拉菜单，如下所示：

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/DropDown/DropDown.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/DropDown/DropDown.aspx)

使用链接按钮...有没有办法限制列表？

谢谢你。

编辑：我认为可能是 VB 6，您可以在下拉列表中选择“LimitToList”。这意味着用户只能选择下拉列表中的值，而不能输入自己的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T06:46:52.647

由于您正在扩展一个文本框，我认为最好的选择是附加一个使按键无效的事件侦听器，您可以在 ASPX 中执行此操作：

```
<asp:Textbox id="txtFoo" onkeypress="return false;" runat="server"/> 
```

或者，在后面的代码中：

```
txtFoo.Attributes.Add("OnKeyPress","return false;"); 
```

这将阻止用户在文本框中输入内容，从而创建您想要的效果。

一个额外的副作用是，如果禁用了 javascript 并且下拉扩展器不起作用，则允许用户自由输入条目。

# internet-explorer - IE 中的 ActiveX。对话框未显示 XP 视觉样式

> ID：274461
> 
> 赞同：2
> 
> 时间：2008-11-08T06:43:47.803
> 
> 标签：internet-explorer, activex, dialog, wtl, xp-theme

我在 IE (7) 中有一个 ActiveX 控件。当它显示一个对话框时，该对话框不以 XP 视觉样式显示。我试过嵌入清单无济于事。有人知道吗？顺便说一句，对话框是使用 wtl 实现的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T19:24:55.157

使用#define ISOLATION_AWARE_ENABLED 1 构建您的 dll。或者将编译器指令 /D ISOLATION_AWARE_ENABLED=1。不要忘记清单应该嵌入 id 2。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/aa815321%28VS.85%29.aspx#_slate_set_the_isolation_aware_enabled_directive](http://msdn.microsoft.com/en-us/library/aa815321%28VS.85%29.aspx#_slate_set_the_isolation_aware_enabled_directive)

顺便说一句，即使 ActiveX 嵌入到没有清单的可执行文件中，使用这些设置构建的 ActiveX 显示的对话框也会被蒙皮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-15T12:05:51.310

您可能想尝试在 Code Project 上对[WTL 对话框进行蒙皮。](http://www.codeproject.com/KB/wtl/CDialogRegionT.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-29T23:02:54.680

我认为这是因为 IE 正在读取通过 COM 公开的控件，而 .NET 使用它自己的方法从清单文件中读取。

尝试在表单加载之前调用 Application.EnableVisualStyles。这对我有用。

# java - 如何让 for 循环并排运行？

> ID：274462
> 
> 赞同：4
> 
> 时间：2008-11-08T06:45:55.503
> 
> 标签：java, loops

我一直在做一个幼稚的小程序：屏幕上有一堆小圆圈，颜色和大小不一。当一个较大的圆圈遇到一个较小的圆圈时，它会吃掉较小的圆圈，当一个圆圈吃掉足够多的其他圆圈时，它就会繁殖。这有点整洁！

然而，我实现它的方式是，检测附近圆圈并检查它们是否可食用的过程是通过一个循环来完成的，该循环遍历整个活生生的圆圈群体......随着人口趋于激增，这需要越来越长的时间在它开始下降之前的3000。这个过程不会让我的电脑变慢，我可以去玩《战争黎明》或其他什么的，而且没有任何变慢：它只是检查每个圈子看它是否与其他圈子发生碰撞的过程。 .

所以我想到的是，我可以尝试将应用程序窗口分成四个象限，并让象限中的圆圈同时进行检查，因为它们几乎没有机会相互干扰：或者类似的东西！

那么，我的问题是：如何让 for 循环并排运行？在Java中，说。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-08T07:16:16.380

您在这里遇到的问题实际上可以在没有线程的情况下解决。

您需要的是空间数据结构。四叉树最好，或者如果球体移动的场是固定的（我假设是），您可以使用简单的网格。继承人的想法。

将显示区域划分为一个方形网格，其中每个单元格至少与您最大的圆圈一样大。对于每个单元格，保留一个列表（最好是链表），其中包含中心在该单元格中的所有圆圈。然后在碰撞检测步骤中遍历每个单元格并检查该单元格中的每个圆圈与该单元格和周围单元格中的所有其他圆圈。

从技术上讲，您不必检查每个单元格周围的所有单元格，因为其中一些单元格可能已经被检查过。

您可以将此技术与多线程技术结合使用，以获得更好的性能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-08T06:51:04.403

计算机通常是单任务的，这意味着它们通常可以每个 CPU 或内核一次执行一条指令。

但是，正如您所注意到的，您的操作系统（和其他程序）似乎同时运行许多任务。

这是通过将工作拆分为进程来实现的，每个进程都可以通过产生线程来进一步实现并发。操作系统然后在每个进程和线程之间非常快速地切换，从而产生多任务的错觉。

在您的情况下，您的 java 程序是一个进程，您需要创建 4 个线程，每个线程都运行自己的循环。它可能会变得很棘手，因为线程需要同步它们对局部变量的访问，以防止一个线程在另一个线程试图访问它时编辑一个变量。

因为线程是一个复杂的主题，所以需要比我在这里做的更多的解释。

但是，您可以阅读 Suns 优秀的并发教程，其中涵盖了您需要了解的所有内容：

[http://java.sun.com/docs/books/tutorial/essential/concurrency/](http://java.sun.com/docs/books/tutorial/essential/concurrency/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-08T07:00:31.950

您正在寻找的不是让这些同时运行的方法（正如人们所指出的，这取决于您拥有多少内核，并且只能提供 2 倍或 4 倍的加速），而是以某种方式减少您必须检测的碰撞次数。

您应该考虑使用[四叉树](http://en.wikipedia.org/wiki/Quadtree)。简而言之，您递归地将您的 2D 区域分解为四个象限（根据需要），然后只需要检测附近组件中的对象之间的碰撞。在好的情况下，它可以有效地将您的碰撞检测时间从 N^2 减少到 N * log N。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T18:23:27.623

您可能希望寻找碰撞检测优化，而不是尝试进行并行处理。因为在很多情况下，在一个线程中执行较少的计算比在多个线程之间分配计算要好，而且在这种多线程业务中很容易自爆。尝试使用谷歌搜索“碰撞检测算法”，看看它在哪里;）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T06:50:32.470

如果您的计算机有多个处理器或多个内核，那么您可以轻松运行多个线程并在每个线程中运行较小的循环部分。如今，许多 PC 确实有多个内核——所以要有它，以便每个线程获得循环计数的 1/n，然后创建 n 个线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T06:52:38.440

如果你真的想进入并发编程，你需要学习如何使用线程。

Sun 在这里有一个 Java 线程编程教程：http: [//java.sun.com/docs/books/tutorial/essential/concurrency/](http://java.sun.com/docs/books/tutorial/essential/concurrency/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-25T08:04:32.203

这听起来和我的一个实验很相似——检查一下……

[http://tinyurl.com/3fn8w8](http://tinyurl.com/3fn8w8)

我也对四叉树感兴趣（这就是我来这里的原因）......希望你能明白这一切。

# asp.net - ASP.NET Web 应用程序的身份验证系统？

> ID：274465
> 
> 赞同：0
> 
> 时间：2008-11-08T06:48:02.787
> 
> 标签：asp.net, authentication, authorization

我有一个问题：

如何制作基于角色的 Web 应用程序？比如在论坛站点中，有很多用户类型，admin、moderator 等等……这些用户类型的角色是存储在数据库还是 web.config 中的？而当一个用户登录到我们的站点时，如何控制这个用户的角色呢？简而言之，我想了解授权和身份验证。

谢谢..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-08T06:51:22.530

查看这篇文章和视频：

*   [会员介绍](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)
*   [使用角色管理授权](http://msdn.microsoft.com/en-us/library/9ab2fxh0.aspx)
*   [为 SQL Server 创建应用程序服务数据库](http://msdn.microsoft.com/en-us/library/x28wfk74.aspx)
*   [检查 ASP.NET 2.0 的成员资格、角色和配置文件](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
*   [ASP.NET 2.0 中的成员资格和角色提供程序](http://www.odetocode.com/Articles/427.aspx)（教程）
*   [ASP .NET 安全视频](http://www.asp.net/LEARN/security-videos/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T06:58:26.853

我发现内置的授权方案非常适用于您只需要基本验证谁可以进入和谁可以离开的简单情况，但对于自定义情况（例如拥有特殊管理员帐户等）则不适用。

在这些情况下，我创建了自己的身份验证方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T07:09:27.720

@马维拉：

基本上，它的概念是在您自己的数据库中拥有自己的用户表，您可以在其中管理权限和存储登录信息（当然是正确散列）。在多级权限方案的情况下，我通常使用两个或多个表，例如：

```
TblUsers:
-----------------------------------------------------------------
| UserID (PK) | UserName | HashedPassword | PermissionLevel (FK)|
|---------------------------------------------------------------|
|     1       | BobTables| adfafs2312     |         2           |
-----------------------------------------------------------------

TblPermissions
-------------------------------------
|  PermissionID (PK) | Description   |
--------------------------------------
|         1          |     User      |
|         2          |   SuperUser   |
|         3          |     Admin     |
-------------------------------------- 
```

您可以添加第三个表，其中包含 TblPermissions 之间的一对多关系，该关系公开了用户可能被允许执行的实际能力。

查询用户很简单：

```
SELECT TblUser.Username, TblPermissions.Description 
    FROM TblUsers, TblPermissions 
    WHERE TblUser.UserID = @UserID 
    AND TblUser.PermissionLevel = TblPermission.PermissionID; 
```

创建一个自定义类来封装该信息，并在他们登录时将其存储在 ASP.NET 会话中。

# shell - 无法使用从 1 到 n 循环的 i 重复执行 shell 脚本

> ID：274469
> 
> 赞同：3
> 
> 时间：2008-11-08T06:51:33.840
> 
> 标签：shell, for-loop, applescript, repeat, osascript

这有效（打印，例如，“3 个参数”）：

```
to run argv
    do shell script "echo " & (count argv) & " arguments"
end run 
```

这不会（仅打印“参数 3：三个”，而不是前两个参数）：

```
to run argv
    do shell script "echo " & (count argv) & " arguments"

    repeat with i from 1 to (count argv)
        do shell script "echo 'Argument " & i & ": " & (item i of argv) & "'"
    end repeat
end run 
```

在这两种情况下，我都`osascript`在 Mac OS X 10.5.5 上运行脚本。示例调用：

```
osascript 'Script that takes arguments.applescript' Test argument three 
```

我没有重定向输出，所以我知道脚本没有抛出错误。

如果我在`display dialog`上面添加一个语句`do shell script`，它会抛出“不允许用户交互”错误，所以我知道它正在执行循环体。

我究竟做错了什么？这个循环导致 osascript 不打印任何东西的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T08:58:28.607

尝试这样做以避免必须使用临时文件。

```
to run argv
        set accumulator to do shell script "echo " & (count argv) & " arguments" altering line endings false
        repeat with i from 1 to (count argv)
                set ln to do shell script "echo 'Argument " & i & ": " & (item i of argv) & "'" altering line endings false
                set accumulator to accumulator & ln
        end repeat
        return accumulator
end run 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T08:35:06.050

就此而言，您的问题似乎与循环或 argv 的使用无关。这是一个更简单的测试用例，其中只有最后一个`do shell script`实际返回结果：

```
do shell script "echo foo"
delay 2
do shell script "echo bar" 
```

此外，以下细微的变化将产生预期的结果：

```
to run argv
    do shell script "echo " & (count argv) & " arguments > /test.txt"

    repeat with i from 1 to (count argv)
        do shell script "echo 'Argument " & i & ": " & (item i of argv) & "' >> /test.txt"
    end repeat
end run 
```

`test.txt`将包含四行，如下所示：

```
3 arguments
Argument 1: foo
Argument 2: bar
Argument 3: baz 
```

此解决方法失败：

```
to run argv
    do shell script "echo " & (count argv) & " arguments > /tmp/foo.txt"

    repeat with i from 1 to (count argv)
        do shell script "echo 'Argument " & i & ": " & (item i of argv) & "' >> /tmp/foo.txt"
    end repeat

    do shell script "cat /tmp/foo.txt"
    do shell script "rm /tmp/foo.txt"
end run 
```

即使是现在，也只返回最后一行。这可能与[TN2065](http://developer.apple.com/technotes/tn2002/tn2065.html)的以下问题有关：

> 问：我的脚本会在很长一段时间内产生输出。当他们进来时，我如何阅读结果？
> 
> 答：同样，简短的回答是你不这样做——在命令完成之前，shell 脚本不会返回。在 Unix 术语中，它不能用于创建管道。但是，您可以做的是将命令置于后台（请参阅下一个问题），将其输出发送到文件，然后在文件填满时读取文件。

唉，我没有足够的 AppleScript-fu 知道如何让 AppleScript 本身读取多行，我怀疑这会起作用。

# vb.net - 在 VB.NET 中创建 DLNA 服务器/服务

> ID：274470
> 
> 赞同：12
> 
> 时间：2008-11-08T06:51:43.463
> 
> 标签：vb.net, upnp, dlna

我想在 VB.NET 中创建一个 DLNA 服务器。由于很多多媒体设备开始支持 DLNA，我想看看有什么可能。不仅可以流式传输视频/音频和图片，还可以查看还能做什么。

## 有人有起点吗？协议信息，一些开始的基本代码？

DLNA 基于 UPnP，所以我猜这是我必须开始寻找的方向。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-16T09:27:38.730

[使用 Intels SDK for Windows Home Server 和 Xbox 360 的 UPnP MediaServer](http://www.mperfect.net/whsUpnp360/)是用 C# 编写的，不具备所需的所有功能，但它只是一个开始。

我希望看到 .NET 中 DLNA 的开源实现

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-23T23:27:52.877

这是一个易于理解的 UPnP AV 控制点 VB.Net[示例](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=6104&lngWId=10)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-08T09:03:58.767

您必须成为 DLNA 社区的成员或支付 500 美元才能根据其[主页](http://www.dlna.org/industry/certification/guidelines/ "主页")获得协议的完整规范。

英特尔在其主页上有一个用于生成符合 DLNA 的源代码的[工具。](http://www.intel.com/cd/ids/developer/asmo-na/eng/downloads/upnp/tools/index.htm "英特尔 DLNA 工具")这可能是一个很好的开始，可以在不购买规范的情况下随意尝试和尝试您的想法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-11T17:27:31.327

[您可以从此处](http://www.upnp.org/resources/default.asp)的 UPNP 网站获得有关各种 UPNP 协议（​​包括 DLNA）的大量信息。这包括一个 zip 文件，其中包含所有服务定义和您可以从中开始的现有 SDK 列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-11T13:44:30.137

Mono 项目有一个很好的 UPnP 协议的开源实现。 [https://github.com/mono/mono-upnp](https://github.com/mono/mono-upnp)

# java - 如何将 JDK6 ToolProvider 和 JavaCompiler 与上下文类加载器一起使用？

> ID：274474
> 
> 赞同：6
> 
> 时间：2008-11-08T06:59:31.967
> 
> 标签：java, javac, classloader, java-compiler-api

我的用例是使用 JDK 6 中提供的 ToolProvider 和 JavaCompiler 类从 java 程序编译生成的源文件。源文件包含对上下文类加载器中类的引用（它在 J2EE 容器中运行），但不在系统类加载器中。我的理解是，默认情况下 ToolProvider 将使用系统类加载器创建 JavaCompiler 实例。

有没有办法指定一个类加载器供 JavaCompiler 使用？

我尝试了这种方法，根据 IBM DeveloperWorks 上的某些内容进行了修改：

```
FileManagerImpl fm = 
    new FileManagerImpl(compiler.getStandardFileManager(null, null, null);); 
```

FileManagerImpl 定义为：

```
static final class FileManagerImpl 
    extends ForwardingJavaFileManager<JavaFileManager> {

   public FileManagerImpl(JavaFileManager fileManager) {
      super(fileManager);
   }

   @Override
   public ClassLoader getClassLoader(JavaFileManager.Location location) {
      new Exception().printStackTrace();
      return Thread.currentThread().getContextClassLoader();
   }

} 
```

堆栈跟踪表明它在注释处理期间仅被调用一次。我验证了要编译的源文件中引用的类不在系统类路径上，但可以从上下文类加载器中获得。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T12:15:21.927

如果您知道 contextclassloader 已知的文件的类路径，则可以将它们传递给编译器：

```
 StandardJavaFileManager fileManager = compiler.getStandardFileManager(this /* diagnosticlistener */, null, null);
// get compilationunits from somewhere, for instance via fileManager.getJavaFileObjectsFromFiles(List<file> files)
List<String> options = new ArrayList<String>();
options.add("-classpath");
StringBuilder sb = new StringBuilder();
URLClassLoader urlClassLoader = (URLClassLoader) Thread.currentThread().getContextClassLoader();
for (URL url : urlClassLoader.getURLs())
    sb.append(url.getFile()).append(File.pathSeparator);
options.add(sb.toString());
CompilationTask task = compiler.getTask(null, fileManager, this /* diagnosticlistener */, options, null, compilationUnits);
task.call(); 
```

此示例假设您使用的是 URLClassloader（它允许您检索类路径），但如果您愿意，您可以插入自己的类路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T22:33:47.510

另一种选择是使用[Commons JCI](http://commons.apache.org/jci/usage.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-23T14:03:02.063

你在这里问两个不同的问题。

一是如何编译系统类路径中找不到的类。这很容易通过将“-classpath”命令行参数传递给编译器来解决（正如 Leihca 首次提到的那样）。

二是如何在线程上下文类加载器上实例化ToolProvider和JavaCompiler。在撰写本文时，这是一个未解决的问题：[Using javax.tools.ToolProvider from a custom classloader?](https://stackoverflow.com/questions/2315719/how-to-interact-with-javax-tools-toolprovider-outside-the-system-classloader)

# php - CodeIgniter 问题：原生 PHP 会话、代码流、布局问题？

> ID：274482
> 
> 赞同：4
> 
> 时间：2008-11-08T07:06:09.160
> 
> 标签：php, codeigniter

我刚刚开始使用 CodeIgniter，我正在尝试对我的常规模块/函数进行散列，以使它们在 MVC 框架中正常工作。对于拥有强大 CodeIgniter 背景的任何人，我有几个具体问题：

**会议**

CodeIgniter 会话将客户端的会话数据存储在 cookie 中，这对我不起作用。我知道有一些替代品，或者我可以构建自己的库/助手；但我只是看不到使用`$_SESSION`.

如果我只使用`$_SESSION`，我会对框架的其余部分有任何问题吗？框架的任何其他部分是否依赖于使用 CodeIgniter 会话？

对于这么基本的东西，我对跳出框架感到有点奇怪，但我对普通的 PHP 很满意。我基本上只是希望将 CodeIgniter 用于 MVC，并为我的项目实施更加模块化的方面。

**代码流程和配置**

我有一些配置项需要在几乎其他任何事情之前完成。

例如，假设我有一个常量`APP_LIVE`，它根据当前服务器的名称设置为真/假。这必须尽早发生，因为路径、错误报告、CodeIgniter 系统和应用程序文件夹等都将基于它进行设置。

问题是`system_folder`, 和`application_folder`（将根据代码运行的服务器设置）在`index.php`文件中首先设置，在任何配置加载之前。

此外，我有一个功能可以检查 URL 中的内容，并且可以在页面加载之前重定向。例如，某些页面需要`www.`在 URL 中出现（用于 SEO）、跟踪关联公司、访问者来源、营销标志等。

把这种必须很早就发生的事情放在哪里最好？我知道有一个配置文件、一个自动加载文件、一个常量文件等，但是对于某些项目来说已经太晚了。将这些东西简单地放在主`index.php`文件的顶部，或者将它们包含到全局配置文件中是一种不好的做法吗？再一次，我觉得我正在走出框架，想知道我这样做是不是因为我对它还没有一个扎实的理解？

**布局/页眉页脚**

像大多数人一样，我有一个顶部页眉、导航、页脚等。我习惯于将它们放在文件中，这些文件包含在我的页面模板中。我相信我可以通过让它们查看并将它们包含在我的主页视图中来以同样的方式做到这一点。这是最好的方法吗？其中一些需要一些数据；比如他们在哪个页面上进行导航等。处理导航、共享页眉/页脚等的最佳方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T07:48:56.627

新发布的 CI 1.7 处理数据库中的会话（如果您正在使用）。

但是，CI 被设计为松散耦合，因此如果您决定改用 $_SESSION，您应该不会注意到任何重大问题。

对于您的页眉/页脚/导航，您可以创建（例如）headerview.php、footerview.php 和 contentview.php，并通过在控制器中执行以下操作将数据传递给您的视图：

```
$data['title'] = 'about us';
$data['content'] = 'hello world!';

$this->load->view('headerview', $data);
$this->load->view('contentview', $data);
$this->load->view('footerview'); 
```

基本上，您可以像对待包含一样对待这些视图，但还有一个额外的好处是您可以更改其中的变量。我会避免从视图中调用其他视图，但这可能只是我。

我自己添加了一次或两次 index.php，以设置初始值等，并且从未遇到过问题。

恭喜您选择了框架；我相信你不会失望的。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T08:02:15.680

您可以在每个控制器中有多个 load->view 行，但我个人认为它是耦合的。我强烈建议您查看 CodeIgniter 中的钩子，您可以在其中定义将在每个控制器/方法之后自动运行的函数（AOP 的一个很好的示例）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T23:00:56.690

实际上 $_SESSION 数组似乎没有设置，因此您不能使用本机 PHP 会话（至少在 1.7 上）。然而，在 CodeIgniter wiki 中有一个使用原生 php 会话的会话类 - 您可以像使用其他会话一样使用它，但它仅在 cookie 中存储 session_id。这是： [http ://codeigniter.com/wiki/Native_session/](http://codeigniter.com/wiki/Native_session/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-17T04:05:25.363

@lacho 我在 $_SESSION 上创建了自己的身份验证库。它在 1.7 上运行良好。

我相信 $_SESSION 更安全，因为 CI“会话”是存储在客户端的 cookie，它们被归类为不可信任的“用户传递信息”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T06:29:52.483

您可以使用自己的会话类尝试使用本机

[http://www.moreofless.co.uk/using-native-php-sessions-with-codeigniter/](http://www.moreofless.co.uk/using-native-php-sessions-with-codeigniter/)

# domain-driven-design - 数据传输对象、域对象和存储库

> ID：274484
> 
> 赞同：8
> 
> 时间：2008-11-08T07:08:48.657
> 
> 标签：domain-driven-design

我试图弄清楚所有这些是如何协同工作的。我知道 DTO 基本上只是域对象来回传递给表单等的数据容器。域对象是否包含 DTO 或 DTO 和域对象恰好具有将手动映射的所有相同属性？

如果我在服务中公开我的 DTO 类型，如何在不为客户端上的每个 get/set 操作创建往返的情况下使用 getter 和 setter？我知道你可以有一个很长的构造函数，但是如果你有超过 7 个属性，那会变得很丑。

在实现存储库模式时，我是传入 DTO 还是域对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T06:31:31.170

*   DTO 和域对象应该是分开的。
*   应该有一个映射器将 DTO 映射到域对象，并将域对象映射到 DTO。这个映射器应该是一个接口的实现，默认映射器使用反射将对象相互映射。
*   存储库应该是一个服务，它返回域对象，它们本身应该服务。
*   如果 DTO 是由 Web 服务公开的类，则创建的 WSDL 将属性定义为元素，而在另一端创建的代理仅创建在客户端本身上运行的 getter/setter 属性，因此 getter 和 setter 不会导致往返。
*   即使您只是在 DTO 中创建一个公共变量，代理也将作为 getter 和 setter 实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T13:51:43.400

我认为最好让 DTO 包含对 Domain 对象的引用，以便 DTO 的消费者可以开始使用 Domain 对象。也就是说，如果 DTO 的使用者不能改变 Domain 对象，您可能需要让 DTO 包含封装在 Domain 对象中的值。这可能很困难，因为您可能需要对域对象进行深层复制。

我不确定为什么将 DTO 类型公开为服务会导致使用其 getter/setter 进行往返是一个问题。如果服务是远程服务，则返回的 DTO 无论如何都会被序列化，并且您的 getter/setter 将获得值的副本。如果服务不是远程的，那么执行“往返”似乎不会造成太大的损失，因为客户端和服务在同一个进程空间中。

# c++ - 并行快速排序：使用 Boost Bind 进行递归？

> ID：274490
> 
> 赞同：1
> 
> 时间：2008-11-08T07:15:52.620
> 
> 标签：c++, multithreading, boost

我正在努力使快速排序并行，线程是第一次尝试。非线程版本正确排序，但线程不正确（这并不奇怪）。我发现有趣的是，当我删除线程但保留 boost::bind 调用时它仍然不起作用。如果 boost::bind 不是我想要的，请提出建议。Bind 似乎是使我的函数与 boost 线程一起工作的最简单（或唯一）的方法。

```
void Quicksort( fVec &Array, const int Left, const int Right )
{
    if( Right <= Left )
        return;

    int pivot = Left;
    const int pivotNewIndex = Partition( Array, Left, Right, pivot );

    // These function calls make it work fine
    //Quicksort( Array, Left, pivotNewIndex - 1 );
    //Quicksort( Array, pivotNewIndex + 1, Right );

    // boost::bind calls only swaps one element, doesn't actually sort
    boost::bind( &Quicksort, Array, Left, pivotNewIndex - 1 )();
    boost::bind( &Quicksort, Array, pivotNewIndex + 1, Right )();

    // threaded version that doesn't work, same as above
    //boost::thread threadA( boost::bind( &Quicksort, Array, Left, pivotNewIndex - 1 ) );
    //threadA.join();
    //boost::thread threadB( boost::bind( &Quicksort, Array, pivotNewIndex + 1, Right ) );
    //threadB.join();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T07:31:43.417

Boost bind 或多或少地创建了一个仿函数，当被调用时，它将使用你想要的参数调用你想要的函数。在这种情况下，您正在创建仿函数但从不调用它。尝试：

```
boost::bind( &Quicksort, Array, Left, pivotNewIndex - 1 )();
boost::bind( &Quicksort, Array, pivotNewIndex + 1, Right )(); 
```

我猜第一个论点是什么搞砸了。我认为 bind 需要参数是可复制的，而引用不是真的，它可能正在创建一个副本并将引用传递给它，这就是为什么没有任何变化的原因。尝试：

```
boost::bind( &Quicksort, boost::ref(Array), Left, pivotNewIndex - 1 )();
boost::bind( &Quicksort, boost::ref(Array), pivotNewIndex + 1, Right )(); 
```

了解 fVec 是什么以及为什么不将指针传递给要排序的数组会有所帮助。

另请注意，这种线程化方法可能不会提供太多加速，因为当您获得非常小的排序时，启动和调度新线程的开销远大于收益（另外，您将创建大量线程，即坏的）。您真正想要的是一个线程池，它可以在某个最佳大小的块或更大的块上运行，并且具有固定数量的线程。当达到小于限制的大小时，它会依次执行所有操作（对于更小的尺寸，您显然希望从快速排序更改为插入排序）。

另请注意，您加入的顺序无论如何都会导致串行执行......您希望在启动两个线程后加入两个线程。

# python - 如何在 Python 中复制带有进度条的文件？

> ID：274493
> 
> 赞同：10
> 
> 时间：2008-11-08T07:21:53.200
> 
> 标签：python, file-io

使用 复制大文件时`shutil.copy()`，您看不到操作的进展情况。

我把一些有用的东西放在一起——它使用一个简单的 ProgressBar 类（它简单地返回一个简单的 ASCII 进度条，作为一个字符串），以及一个循环`open().read()`并`.write()`进行实际复制。它显示进度条使用`sys.stdout.write("\r%s\r" % (the_progress_bar))`有点骇人听闻，但它可以工作。

[你可以在这里看到 github 上](http://github.com/dbr/checktveps/tree/1be8f4445fbf766eba25f98f78ec52e955571608/autoPathTv.py#L64-153)的代码（在上下文中）

是否有任何内置模块可以做得更好？是否可以对此代码进行任何改进？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-08T07:28:43.937

两件事情：

*   我会让默认块大小比 512 大很多。我会从 16384 开始，也许更多*。*
*   对于模块化，最好让`copy_with_prog`函数本身不输出进度条，而是调用回调函数，以便调用者决定如何显示进度。

也许是这样的：

```
def copy_with_prog(src, dest, callback = None):
    while True:
        # copy loop stuff
        if callback:
            callback(pos, total)

prog = ProgressBar(...)
copy_with_prog(src, dest, lambda pos, total: prog.update(pos, total)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-09T14:08:26.733

矫枉过正？也许。但在几乎任何系统上，Linux、Mac 和 Windows 上的快速 wxWidgets 安装，您都可以获得真正的交易，在 gui 设置中带有暂停和取消按钮。如今，Mac 附带 wxWidgets，它是 Linux 上的常用软件包。

单个文件非常快（它会立即完成并看起来很损坏），因此您可能会考虑创建一个 fileSet 作业，该作业在每个文件而不是每个块上运行一次。享受！

——吉姆·卡罗尔

```
"""
Threaded Jobs.

Any class that does a long running process can inherit
from ThreadedJob.  This enables running as a background
thread, progress notification, pause and cancel.  The
time remaining is also calculated by the ThreadedJob class.
"""
import wx.lib.newevent
import thread
import exceptions
import time

(RunEvent, EVT_RUN) = wx.lib.newevent.NewEvent()
(CancelEvent, EVT_CANCEL) = wx.lib.newevent.NewEvent()
(DoneEvent, EVT_DONE) = wx.lib.newevent.NewEvent()
(ProgressStartEvent, EVT_PROGRESS_START) = wx.lib.newevent.NewEvent()
(ProgressEvent, EVT_PROGRESS) = wx.lib.newevent.NewEvent()

class InterruptedException(exceptions.Exception):
    def __init__(self, args = None):
        self.args = args
    #
#

class ThreadedJob:
    def __init__(self):
        # tell them ten seconds at first
        self.secondsRemaining = 10.0
        self.lastTick = 0

        # not running yet
        self.isPaused = False
        self.isRunning = False
        self.keepGoing = True

    def Start(self):
        self.keepGoing = self.isRunning = True
        thread.start_new_thread(self.Run, ())

        self.isPaused = False
    #

    def Stop(self):
        self.keepGoing = False
    #

    def WaitUntilStopped(self):
        while self.isRunning:
            time.sleep(0.1)
            wx.SafeYield()
        #
    #

    def IsRunning(self):
        return self.isRunning
    #

    def Run(self):
        # this is overridden by the
        # concrete ThreadedJob
        print "Run was not overloaded"
        self.JobFinished()

        pass
    #

    def Pause(self):
        self.isPaused = True
        pass
    #

    def Continue(self):
        self.isPaused = False
        pass
    #

    def PossibleStoppingPoint(self):
        if not self.keepGoing:
            raise InterruptedException("process interrupted.")
        wx.SafeYield()

        # allow cancel while paused
        while self.isPaused:
            if not self.keepGoing:
                raise InterruptedException("process interrupted.")

            # don't hog the CPU
            time.sleep(0.1)
        #
    #

    def SetProgressMessageWindow(self, win):
        self.win = win
    #

    def JobBeginning(self, totalTicks):

        self.lastIterationTime = time.time()
        self.totalTicks = totalTicks

        if hasattr(self, "win") and self.win:
            wx.PostEvent(self.win, ProgressStartEvent(total=totalTicks))
        #
    #

    def JobProgress(self, currentTick):
        dt = time.time() - self.lastIterationTime
        self.lastIterationTime = time.time()
        dtick = currentTick - self.lastTick
        self.lastTick = currentTick

        alpha = 0.92
        if currentTick > 1:
            self.secondsPerTick = dt * (1.0 - alpha) + (self.secondsPerTick * alpha)
        else:
            self.secondsPerTick = dt
        #

        if dtick > 0:
            self.secondsPerTick /= dtick

        self.secondsRemaining = self.secondsPerTick * (self.totalTicks - 1 - currentTick) + 1

        if hasattr(self, "win") and self.win:
            wx.PostEvent(self.win, ProgressEvent(count=currentTick))
        #
    #

    def SecondsRemaining(self):
        return self.secondsRemaining
    #

    def TimeRemaining(self):

        if 1: #self.secondsRemaining > 3:
            minutes = self.secondsRemaining // 60
            seconds = int(self.secondsRemaining % 60.0)
            return "%i:%02i" % (minutes, seconds)
        else:
            return "a few"
    #

    def JobFinished(self):
        if hasattr(self, "win") and self.win:
            wx.PostEvent(self.win, DoneEvent())
        #

        # flag we're done before we post the all done message
        self.isRunning = False
    #
#

class EggTimerJob(ThreadedJob):
    """ A sample Job that demonstrates the mechanisms and features of the Threaded Job"""
    def __init__(self, duration):
        self.duration = duration
        ThreadedJob.__init__(self)
    #

    def Run(self):
        """ This can either be run directly for synchronous use of the job,
        or started as a thread when ThreadedJob.Start() is called.

        It is responsible for calling JobBeginning, JobProgress, and JobFinished.
        And as often as possible, calling PossibleStoppingPoint() which will 
        sleep if the user pauses, and raise an exception if the user cancels.
        """
        self.time0 = time.clock()
        self.JobBeginning(self.duration)

        try:
            for count in range(0, self.duration):
                time.sleep(1.0)
                self.JobProgress(count)
                self.PossibleStoppingPoint()
            #
        except InterruptedException:
            # clean up if user stops the Job early
            print "canceled prematurely!"
        #

        # always signal the end of the job
        self.JobFinished()
        #
    #

    def __str__(self):
        """ The job progress dialog expects the job to describe its current state."""
        response = []
        if self.isPaused:
            response.append("Paused Counting")
        elif not self.isRunning:
            response.append("Will Count the seconds")
        else:
            response.append("Counting")
        #
        return " ".join(response)
    #
#

class FileCopyJob(ThreadedJob):
    """ A common file copy Job. """

    def __init__(self, orig_filename, copy_filename, block_size=32*1024):

        self.src = orig_filename
        self.dest = copy_filename
        self.block_size = block_size
        ThreadedJob.__init__(self)
    #

    def Run(self):
        """ This can either be run directly for synchronous use of the job,
        or started as a thread when ThreadedJob.Start() is called.

        It is responsible for calling JobBeginning, JobProgress, and JobFinished.
        And as often as possible, calling PossibleStoppingPoint() which will 
        sleep if the user pauses, and raise an exception if the user cancels.
        """
        self.time0 = time.clock()

        try:
            source = open(self.src, 'rb')

            # how many blocks?
            import os
            (st_mode, st_ino, st_dev, st_nlink, st_uid, st_gid, st_size, st_atime, st_mtime, st_ctime) = os.stat(self.src)
            num_blocks = st_size / self.block_size
            current_block = 0

            self.JobBeginning(num_blocks)

            dest = open(self.dest, 'wb')

            while 1:
                copy_buffer = source.read(self.block_size)
                if copy_buffer:
                    dest.write(copy_buffer)
                    current_block += 1
                    self.JobProgress(current_block)
                    self.PossibleStoppingPoint()
                else:
                    break

            source.close()
            dest.close()

        except InterruptedException:
            # clean up if user stops the Job early
            dest.close()
            # unlink / delete the file that is partially copied
            os.unlink(self.dest)
            print "canceled, dest deleted!"
        #

        # always signal the end of the job
        self.JobFinished()
        #
    #

    def __str__(self):
        """ The job progress dialog expects the job to describe its current state."""
        response = []
        if self.isPaused:
            response.append("Paused Copy")
        elif not self.isRunning:
            response.append("Will Copy a file")
        else:
            response.append("Copying")
        #
        return " ".join(response)
    #
#

class JobProgress(wx.Dialog):
    """ This dialog shows the progress of any ThreadedJob.

    It can be shown Modally if the main application needs to suspend
    operation, or it can be shown Modelessly for background progress
    reporting.

    app = wx.PySimpleApp()
    job = EggTimerJob(duration = 10)
    dlg = JobProgress(None, job)
    job.SetProgressMessageWindow(dlg)
    job.Start()
    dlg.ShowModal()

    """
    def __init__(self, parent, job):
        self.job = job

        wx.Dialog.__init__(self, parent, -1, "Progress", size=(350,200))

        # vertical box sizer
        sizeAll = wx.BoxSizer(wx.VERTICAL)

        # Job status text
        self.JobStatusText = wx.StaticText(self, -1, "Starting...")
        sizeAll.Add(self.JobStatusText, 0, wx.EXPAND|wx.ALL, 8)

        # wxGague
        self.ProgressBar = wx.Gauge(self, -1, 10, wx.DefaultPosition, (250, 15))
        sizeAll.Add(self.ProgressBar, 0, wx.EXPAND|wx.ALL, 8)

        # horiz box sizer, and spacer to right-justify
        sizeRemaining = wx.BoxSizer(wx.HORIZONTAL)
        sizeRemaining.Add((2,2), 1, wx.EXPAND)

        # time remaining read-only edit
        # putting wide default text gets a reasonable initial layout.
        self.remainingText = wx.StaticText(self, -1, "???:??")
        sizeRemaining.Add(self.remainingText, 0, wx.LEFT|wx.RIGHT|wx.ALIGN_CENTER_VERTICAL, 8)

        # static text: remaining
        self.remainingLabel = wx.StaticText(self, -1, "remaining")
        sizeRemaining.Add(self.remainingLabel, 0, wx.ALL|wx.ALIGN_CENTER_VERTICAL, 8)

        # add that row to the mix
        sizeAll.Add(sizeRemaining, 1, wx.EXPAND)

        # horiz box sizer & spacer
        sizeButtons = wx.BoxSizer(wx.HORIZONTAL)
        sizeButtons.Add((2,2), 1, wx.EXPAND|wx.ADJUST_MINSIZE)

        # Pause Button
        self.PauseButton = wx.Button(self, -1, "Pause")
        sizeButtons.Add(self.PauseButton, 0, wx.ALL, 4)
        self.Bind(wx.EVT_BUTTON, self.OnPauseButton, self.PauseButton)

        # Cancel button
        self.CancelButton = wx.Button(self, wx.ID_CANCEL, "Cancel")
        sizeButtons.Add(self.CancelButton, 0, wx.ALL, 4)
        self.Bind(wx.EVT_BUTTON, self.OnCancel, self.CancelButton)

        # Add all the buttons on the bottom row to the dialog
        sizeAll.Add(sizeButtons, 0, wx.EXPAND|wx.ALL, 4)

        self.SetSizer(sizeAll)
        #sizeAll.Fit(self)
        sizeAll.SetSizeHints(self)

        # jobs tell us how they are doing
        self.Bind(EVT_PROGRESS_START, self.OnProgressStart)
        self.Bind(EVT_PROGRESS, self.OnProgress)
        self.Bind(EVT_DONE, self.OnDone)

        self.Layout()
    #

    def OnPauseButton(self, event):
        if self.job.isPaused:
            self.job.Continue()
            self.PauseButton.SetLabel("Pause")
            self.Layout()
        else:
            self.job.Pause()
            self.PauseButton.SetLabel("Resume")
            self.Layout()
        #
    #

    def OnCancel(self, event):
        self.job.Stop()
    #

    def OnProgressStart(self, event):
        self.ProgressBar.SetRange(event.total)
        self.statusUpdateTime = time.clock()
    #

    def OnProgress(self, event):
        # update the progress bar
        self.ProgressBar.SetValue(event.count)

        self.remainingText.SetLabel(self.job.TimeRemaining())

        # update the text a max of 20 times a second
        if time.clock() - self.statusUpdateTime > 0.05:
            self.JobStatusText.SetLabel(str(self.job))
            self.statusUpdateTime = time.clock()
            self.Layout()
        #
    #

    # when a job is done
    def OnDone(self, event):
        self.ProgressBar.SetValue(0)
        self.JobStatusText.SetLabel("Finished")
        self.Destroy()
    #
#

if __name__ == "__main__":
    app = wx.PySimpleApp()
    #job = EggTimerJob(duration = 10)
    job = FileCopyJob("VeryBigFile.mp4", "/tmp/test_junk.mp4", 1024*1024*10)
    dlg = JobProgress(None, job)
    job.SetProgressMessageWindow(dlg)
    job.Start()
    dlg.ShowModal()
# 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-28T17:13:15.597

我有这个带有进度条的 shutil.copy() ，只需使用内置模块即可以简单的方式制作。如果您使用的是 utf-8 编码，您可以获得类似于 gif 图像中的第二个示例的进度： [进度条示例：](https://i.stack.imgur.com/Qocmx.gif)

阅读评论以更改样式和颜色。第一个和最后一个示例不需要 utf-8。你可以使用命令 CPprogress(SOURCE, DESTINATION) 就在你有 shutil.copy(src, dst) 的地方：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
'''
CPprogress(SOURCE, DESTINATION)

I made this to give shutil.copy() [or shutil.copy2() in this case] a progress bar.

You can use CPprogress(SOURCE, DESTINATION) just like shutil.copy(src, dst). SOURCE must be a file path and DESTINATION a file or folder path.

It will give you a progress bar for each file copied. Just copy this code above the place where you want to use CPprogress(SOURCE, DESTINATION) in your code.

You can easily change the look of the progress bar:
    - To keep the style and just change the colors, replace the colors values of progressCOLOR and finalCOLOR (orange code at the end of the lines).
    - The use a solid block progress bar, # -*- coding: utf-8 -*- is required. Otherwise, you will get an encoding error. Some basic terminals, like xterm, may not show the progress bar because of the utf-8 characters.
      To use this style, remove the comments #STYLE# in lines ###COLORS### - BlueCOLOR and endBLOCK.
      In def getPERCECENTprogress() remove the comments  #STYLE# AND COMMENT THE PREVIOUS line. Do the same in def CPprogress()
      If you don't want the utf-8 encoding, delete the four lines beginning with #STYLE#.

NOTE: If you want to copy lots of small files, the copy process for file is so fast 
      that all you will see is a lot of lines scrolling in you terminal window - not enough time for a 'progress'.
      In that case, I use an overall progress that shows only one progress bar to the complete job.   nzX
'''
import os
import shutil
import sys
import threading
import time

######## COLORS ######
progressCOLOR = '\033[38;5;33;48;5;236m' #\033[38;5;33;48;5;236m# copy inside '' for colored progressbar| orange:#\033[38;5;208;48;5;235m
finalCOLOR =  '\033[38;5;33;48;5;33m' #\033[38;5;33;48;5;33m# copy inside '' for colored progressbar| orange:#\033[38;5;208;48;5;208m
#STYLE#BlueCOLOR = '\033[38;5;33m'#\033[38;5;33m# copy inside '' for colored progressbar Orange#'\033[38;5;208m'# # BG progress# #STYLE# 
#STYLE#endBLOCK = '' # ▌ copy OR '' for none # BG progress# #STYLE# requires utf8 coding header
########

BOLD    = '\033[1m'
UNDERLINE = '\033[4m'
CEND    = '\033[0m'

def getPERCECENTprogress(source_path, destination_path):
    time.sleep(.24)
    if os.path.exists(destination_path):
        while os.path.getsize(source_path) != os.path.getsize(destination_path):
            sys.stdout.write('\r')
            percentagem = int((float(os.path.getsize(destination_path))/float(os.path.getsize(source_path))) * 100)
            steps = int(percentagem/5)
            copiado = int(os.path.getsize(destination_path)/1000000)# Should be 1024000 but this get's equal to Thunar file manager report (Linux - Xfce)
            sizzz = int(os.path.getsize(source_path)/1000000)
            sys.stdout.write(("         {:d} / {:d} Mb   ".format(copiado, sizzz)) +  (BOLD + progressCOLOR + "{:20s}".format('|'*steps) + CEND) + ("   {:d}% ".format(percentagem))) # BG progress
            #STYLE#sys.stdout.write(("         {:d} / {:d} Mb   ".format(copiado, sizzz)) +  (BOLD + BlueCOLOR + "▐" + "{:s}".format('█'*steps) + CEND) + ("{:s}".format(' '*(20-steps))+ BOLD + BlueCOLOR + endBLOCK+ CEND) +("   {:d}% ".format(percentagem))) #STYLE# # BG progress# closer to GUI but less compatible (no block bar with xterm) # requires utf8 coding header
            sys.stdout.flush()
            time.sleep(.01)

def CPprogress(SOURCE, DESTINATION):
    if os.path.isdir(DESTINATION):
        dst_file = os.path.join(DESTINATION, os.path.basename(SOURCE))
    else: dst_file = DESTINATION
    print " "
    print (BOLD + UNDERLINE + "FROM:" + CEND + "   "), SOURCE
    print (BOLD + UNDERLINE + "TO:" + CEND + "     "), dst_file
    print " "
    threading.Thread(name='progresso', target=getPERCECENTprogress, args=(SOURCE, dst_file)).start()
    shutil.copy2(SOURCE, DESTINATION)
    time.sleep(.02)
    sys.stdout.write('\r')
    sys.stdout.write(("         {:d} / {:d} Mb   ".format((int(os.path.getsize(dst_file)/1000000)), (int(os.path.getsize(SOURCE)/1000000)))) +  (BOLD + finalCOLOR + "{:20s}".format('|'*20) + CEND) + ("   {:d}% ".format(100))) # BG progress 100%
    #STYLE#sys.stdout.write(("         {:d} / {:d} Mb   ".format((int(os.path.getsize(dst_file)/1000000)), (int(os.path.getsize(SOURCE)/1000000)))) +  (BOLD + BlueCOLOR + "▐" + "{:s}{:s}".format(('█'*20), endBLOCK) + CEND) + ("   {:d}% ".format(100))) #STYLE# # BG progress 100%# closer to GUI but less compatible (no block bar with xterm) # requires utf8 coding header
    sys.stdout.flush()
    print " "
    print " "

'''
#Ex. Copy all files from root of the source dir to destination dir

folderA = '/path/to/SOURCE' # SOURCE
folderB = '/path/to/DESTINATION' # DESTINATION
for FILE in os.listdir(folderA):
    if not os.path.isdir(os.path.join(folderA, FILE)):
        if os.path.exists(os.path.join(folderB, FILE)): continue # as we are using shutil.copy2() that overwrites destination, this skips existing files
        CPprogress(os.path.join(folderA, FILE), folderB) # use the command as if it was shutil.copy2() but with progress

         75 / 150 Mb  ||||||||||         |  50%
''' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-14T13:05:40.747

如果您想使用带有进度的 Windows 复制对话框，您可以使用这些：

*   [https://github.com/tjguk/winshell/](https://github.com/tjguk/winshell/)
*   [https://github.com/frmdstryr/pywinutils](https://github.com/frmdstryr/pywinutils)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-28T17:19:17.677

如果你想要一个整体的进步，你可以使用这样的东西（为另一个脚本制作）。请注意，在这种情况下，调用进度条的“threading.Thread”被放置在“for”循环之外。此外，需要以不同的方式采取措施。这是上一个答案中 gif 图像的第三个示例（非 utf-8）。它添加了一个文件“ToGo”计数：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

'''
Ex.
CopyProgress('/path/to/SOURCE', '/path/to/DESTINATION')

I think this 'copy with overall progress' is very 'plastic' and can be easily adapted.
By default, it will RECURSIVELY copy the CONTENT of  'path/to/SOURCE' to 'path/to/DESTINATION/' keeping the directory tree.

Paying attention to comments, there are 4 main options that can be immediately change:

1 - The LOOK of the progress bar: see COLORS and the PAIR of STYLE lines in 'def getPERCECENTprogress'(inside and after the 'while' loop);

2 - The DESTINATION path: to get 'path/to/DESTINATION/SOURCE_NAME' as target, comment the 2nd 'DST =' definition on the top of the 'def CopyProgress(SOURCE, DESTINATION)' function;

3 - If you don't want to RECURSIVELY copy from sub-directories but just the files in the root source directory to the root of destination, you can use os.listdir() instead of os.walk(). Read the comments inside 'def CopyProgress(SOURCE, DESTINATION)' function to disable RECURSION. Be aware that the RECURSION changes(4x2) must be made in both os.walk() loops;

4 - Handling destination files: if you use this in a situation where the destination filename may already exist, by default, the file is skipped and the loop will jump to the next and so on. On the other way shutil.copy2(), by default, overwrites destination file if exists. Alternatively, you can handle files that exist by overwriting or renaming (according to current date and time). To do that read the comments after 'if os.path.exists(dstFILE): continue' both in the count bytes loop and the main loop. Be aware that the changes must match in both loops (as described in comments) or the progress function will not work properly.

'''

import os
import shutil
import sys
import threading
import time

progressCOLOR = '\033[38;5;33;48;5;236m' #BLUEgreyBG
finalCOLOR =  '\033[48;5;33m' #BLUEBG
# check the color codes below and paste above

###### COLORS #######
# WHITEblueBG = '\033[38;5;15;48;5;33m'
# BLUE = '\033[38;5;33m'
# BLUEBG  = '\033[48;5;33m'
# ORANGEBG = '\033[48;5;208m'
# BLUEgreyBG = '\033[38;5;33;48;5;236m'
# ORANGEgreyBG = '\033[38;5;208;48;5;236m' # = '\033[38;5;FOREGROUND;48;5;BACKGROUNDm' # ver 'https://i.stack.imgur.com/KTSQa.png' para 256 color codes
# INVERT = '\033[7m'
###### COLORS #######

BOLD    = '\033[1m'
UNDERLINE = '\033[4m'
CEND    = '\033[0m'

FilesLeft = 0

def FullFolderSize(path):
    TotalSize = 0
    if os.path.exists(path):# to be safely used # if FALSE returns 0
        for root, dirs, files in os.walk(path):
            for file in files:
                TotalSize += os.path.getsize(os.path.join(root, file))
    return TotalSize

def getPERCECENTprogress(source_path, destination_path, bytes_to_copy):
    dstINIsize = FullFolderSize(destination_path)
    time.sleep(.25)
    print " "
    print (BOLD + UNDERLINE + "FROM:" + CEND + "   "), source_path
    print (BOLD + UNDERLINE + "TO:" + CEND + "     "), destination_path
    print " "
    if os.path.exists(destination_path):
        while bytes_to_copy != (FullFolderSize(destination_path)-dstINIsize):
            sys.stdout.write('\r')
            percentagem = int((float((FullFolderSize(destination_path)-dstINIsize))/float(bytes_to_copy)) * 100)
            steps = int(percentagem/5)
            copiado = '{:,}'.format(int((FullFolderSize(destination_path)-dstINIsize)/1000000))# Should be 1024000 but this get's closer to the file manager report
            sizzz = '{:,}'.format(int(bytes_to_copy/1000000))
            sys.stdout.write(("         {:s} / {:s} Mb  ".format(copiado, sizzz)) +  (BOLD + progressCOLOR + "{:20s}".format('|'*steps) + CEND) + ("  {:d}% ".format(percentagem)) + ("  {:d} ToGo ".format(FilesLeft))) #  STYLE 1 progress default # 
            #BOLD# sys.stdout.write(BOLD + ("        {:s} / {:s} Mb  ".format(copiado, sizzz)) +  (progressCOLOR + "{:20s}".format('|'*steps) + CEND) + BOLD + ("  {:d}% ".format(percentagem)) + ("  {:d} ToGo ".format(FilesLeft))+ CEND) # STYLE 2 progress BOLD # 
            #classic B/W# sys.stdout.write(BOLD + ("        {:s} / {:s} Mb  ".format(copiado, sizzz)) +  ("|{:20s}|".format('|'*steps)) + ("  {:d}% ".format(percentagem)) + ("  {:d} ToGo ".format(FilesLeft))+ CEND) # STYLE 3 progress classic B/W #
            sys.stdout.flush()
            time.sleep(.01)
        sys.stdout.write('\r')
        time.sleep(.05)
        sys.stdout.write(("         {:s} / {:s} Mb  ".format('{:,}'.format(int((FullFolderSize(destination_path)-dstINIsize)/1000000)), '{:,}'.format(int(bytes_to_copy/1000000)))) +  (BOLD + finalCOLOR + "{:20s}".format(' '*20) + CEND) + ("  {:d}% ".format( 100)) + ("  {:s}      ".format('    ')) + "\n") #  STYLE 1 progress default # 
        #BOLD# sys.stdout.write(BOLD + ("        {:s} / {:s} Mb  ".format('{:,}'.format(int((FullFolderSize(destination_path)-dstINIsize)/1000000)), '{:,}'.format(int(bytes_to_copy/1000000)))) +  (finalCOLOR + "{:20s}".format(' '*20) + CEND) + BOLD + ("  {:d}% ".format( 100)) + ("  {:s}      ".format('    ')) + "\n" + CEND ) # STYLE 2 progress BOLD # 
        #classic B/W# sys.stdout.write(BOLD + ("        {:s} / {:s} Mb  ".format('{:,}'.format(int((FullFolderSize(destination_path)-dstINIsize)/1000000)), '{:,}'.format(int(bytes_to_copy/1000000)))) +  ("|{:20s}|".format('|'*20)) + ("  {:d}% ".format( 100)) + ("  {:s}      ".format('    ')) + "\n" + CEND ) # STYLE 3 progress classic B/W # 
        sys.stdout.flush()
        print " "
        print " "

def CopyProgress(SOURCE, DESTINATION):
    global FilesLeft
    DST = os.path.join(DESTINATION, os.path.basename(SOURCE))
    # <- the previous will copy the Source folder inside of the Destination folder. Result Target: path/to/Destination/SOURCE_NAME
    # -> UNCOMMENT the next (# DST = DESTINATION) to copy the CONTENT of Source to the Destination. Result Target: path/to/Destination
    DST = DESTINATION # UNCOMMENT this to specify the Destination as the target itself and not the root folder of the target 
    #
    if DST.startswith(SOURCE):
        print " "
        print BOLD + UNDERLINE + 'Source folder can\'t be changed.' + CEND
        print 'Please check your target path...'
        print " "
        print BOLD + '        CANCELED' + CEND
        print " "
        exit()
    #count bytes to copy
    Bytes2copy = 0
    for root, dirs, files in os.walk(SOURCE): # USE for filename in os.listdir(SOURCE): # if you don't want RECURSION #
        dstDIR = root.replace(SOURCE, DST, 1) # USE dstDIR = DST # if you don't want RECURSION #
        for filename in files:                # USE if not os.path.isdir(os.path.join(SOURCE, filename)): # if you don't want RECURSION #
            dstFILE = os.path.join(dstDIR, filename)
            if os.path.exists(dstFILE): continue # must match the main loop (after "threading.Thread")
            #                                      To overwrite delete dstFILE first here so the progress works properly: ex. change continue to os.unlink(dstFILE)
            #                                      To rename new files adding date and time, instead of deleating and overwriting, 
            #                                      comment 'if os.path.exists(dstFILE): continue'
            Bytes2copy += os.path.getsize(os.path.join(root, filename)) # USE os.path.getsize(os.path.join(SOURCE, filename)) # if you don't want RECURSION #
            FilesLeft += 1
    # <- count bytes to copy
    #
    # Treading to call the preogress
    threading.Thread(name='progresso', target=getPERCECENTprogress, args=(SOURCE, DST, Bytes2copy)).start()
    # main loop
    for root, dirs, files in os.walk(SOURCE): # USE for filename in os.listdir(SOURCE): # if you don't want RECURSION #
        dstDIR = root.replace(SOURCE, DST, 1) # USE dstDIR = DST # if you don't want RECURSION #
        if not os.path.exists(dstDIR):
            os.makedirs(dstDIR)
        for filename in files:                # USE if not os.path.isdir(os.path.join(SOURCE, filename)): # if you don't want RECURSION #
            srcFILE = os.path.join(root, filename) # USE os.path.join(SOURCE, filename) # if you don't want RECURSION #
            dstFILE = os.path.join(dstDIR, filename)
            if os.path.exists(dstFILE): continue # MUST MATCH THE PREVIOUS count bytes loop 
            #   <- <-                              this jumps to the next file without copying this file, if destination file exists. 
            #                                      Comment to copy with rename or overwrite dstFILE
            #
            # RENAME part below
            head, tail = os.path.splitext(filename)
            count = -1
            year = int(time.strftime("%Y"))
            month = int(time.strftime("%m"))
            day = int(time.strftime("%d"))
            hour = int(time.strftime("%H"))
            minute = int(time.strftime("%M"))
            while os.path.exists(dstFILE):
                count += 1
                if count == 0:
                    dstFILE = os.path.join(dstDIR, '{:s}[{:d}.{:d}.{:d}]{:d}-{:d}{:s}'.format(head, year, month, day, hour, minute, tail))
                else:
                    dstFILE = os.path.join(dstDIR, '{:s}[{:d}.{:d}.{:d}]{:d}-{:d}[{:d}]{:s}'.format(head, year, month, day, hour, minute, count, tail))
            # END of RENAME part
            shutil.copy2(srcFILE, dstFILE)
            FilesLeft -= 1
            #

'''
Ex.
CopyProgress('/path/to/SOURCE', '/path/to/DESTINATION')
''' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-18T09:27:46.847

或者，您可以`ROBOCOPY`与`os`模块一起使用。它不会给你一个进度条，但它会在最后给你一个百分比指标以及一个强大的摘要。

```
import os

def robocopy(source, destination, extension=''):
    os.system("robocopy {} {} {} /xx /njh".format(source, destination, extension))

# Usage example
robocopy(r'C:\Users\Example\Downloads', r'C:\Users\Example\Desktop', '*.mov') 
```

上面的示例将所有 .mov 文件复制到桌面

留空`extension`会将源文件夹中的所有文件复制到目标文件夹。

`/xx`从列表中删除额外的文件/目录

`/njh`删除作业标题

有关更多信息，请参阅文档： [https ://docs.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-19T21:13:13.820

这是简单的 PySide 应用程序可以将任何文件从源复制到目标

```
#!/usr/bin/python3

import os
import sys
from PySide2.QtWidgets import QProgressBar, QApplication, QDialog, QMainWindow, QPushButton
from PySide2.QtCore import QThread, Signal, Slot

class ProgressDialog(QDialog):
    def __init__(self, parent, source, destination):
        QDialog.__init__(self, parent)

        self.resize(400, 50)

        self.parent = parent
        self.source = source
        self.destination = destination

        self.prog = QProgressBar(self)
        self.prog.setMaximum(100)
        self.prog.setMinimum(0)
        self.prog.setFormat("%p%")

    def start(self):
        self.show()
        self.copy()

    def copy(self):
        copy_thread = CopyThread(self, self.source, self.destination)
        copy_thread.procPartDone.connect(self.update_progress)
        copy_thread.procDone.connect(self.finished_copy)
        copy_thread.start()

    def update_progress(self, progress):
        self.prog.setValue(progress)

    def finished_copy(self, state):
        self.close()

class CopyThread(QThread):

    procDone = Signal(bool)
    procPartDone = Signal(int)

    def __init__(self, parent, source: str, destination: str):
        QThread.__init__(self, parent)

        self.source = source
        self.destination = destination

    def run(self):
        self.copy()
        self.procDone.emit(True)

    def copy(self):
        source_size = os.stat(self.source).st_size
        copied = 0

        with open(self.source, "rb") as source, open(self.destination, "wb") as target:
            while True:
                chunk = source.read(1024)
                if not chunk:
                    break

                target.write(chunk)
                copied += len(chunk)

                self.procPartDone.emit(copied * 100 / source_size)

class MainWindow(QMainWindow):
    def __init__(self, parent: object = None) -> None:
        super().__init__(parent)

        self.src = "/path/to/file.ext"
        self.dest = "/path/to/file.ext"

        self.btn = QPushButton(self)
        self.btn.setText("Start copy")
        self.btn.clicked.connect(self.run)

        self.setCentralWidget(self.btn)

    def run(self):
        self.prog = ProgressDialog(self, self.src, self.dest)
        self.prog.start()

def main():   
    app = QApplication(sys.argv)

    window = MainWindow()
    window.show()

    sys.exit(app.exec_())

if __name__ == "__main__":
    main() 
```

#### 将此脚本保存在“main.py”文件中并执行命令

```
python3 main.py 
```

# php - 使用 PhpBB 会话数据的应用程序 - 不能使用短代码

> ID：274496
> 
> 赞同：1
> 
> 时间：2008-11-08T07:26:50.587
> 
> 标签：php, codeigniter, phpbb3

在此之前，我使用 phpBB 会话和用户数据构建了 Web 应用程序。常见的做法是使用如下代码：

```
define('IN_PHPBB', true);
//replace $phpbb_root_path with path to your forum
$phpbb_root_path = '../forum/';
$phpEx = substr(strrchr(__FILE__, '.'), 1);
include($phpbb_root_path . 'common.' . $phpEx);

// Start session management
$user->session_begin();
$auth->acl($user->data);
$user->setup(); 
```

但是，通过包含`common.php`，我带来了一大堆其他方法，这些方法会运行到我设置的其他方法中。

在我的示例中，我使用 CodeIgniter 运行应用程序，它已经具有“重定向”方法。这个问题应该适用于任何拥有可能遇到 phpBB 方法的预构建方法的人。

基本上，我需要做的就是：

1.  确保用户已登录`$user->data[username] == Anonymous`
2.  利用来自 '$user->data' 的数据，例如用户的 ID、屏幕名称等。

我可以抓住`$user->data`阵列，并以某种方式将其保存到我自己的会话中吗？有人对此有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T23:40:49.293

你遇到了我讨厌框架的主要原因。你永远不知道包含了什么。特别是当代码不是面向对象的时候。（如果您的函数属于对象，而不是在全局空间中自由浮动，那就更好了。）

假设您的代码已经定义了会话处理程序，那么没有什么可以阻止您使用常规会话命令。

例如： $_SESSION['user_data_array'] = $user->data ;

然后稍后使用会话数据

$data = $_SESSION['user_data_array'];

编写会话处理程序时，它会替换当前的会话处理程序。（我假设已经完成，以便会话存储在数据库中，而不是服务器上。）

如果它没有被替换，那么您仍然可以使用 PHP 的默认会话处理程序。请记住，会话详细信息保存在当前网络服务器上的文件夹中。因此，如果您的应用程序跨多个服务器运行，如果用户在后续访问中由不同的服务器提供服务，则会话数据将不可用。（因此需要编写会话处理程序来保存多个服务器之间的会话数据。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T23:47:31.697

phpBB 将验证存储在数据库中的密码的算法从 2.x 版本更改为 3.0。（它曾经只是一个 MD5 函数。）但如果你能找到他们的半 SDK 网址（手头没有），那里有关于如何在比你描述的更高抽象级别上使用他们的用户验证的帖子.

在这种情况下，如果您要利用他们的资源，则需要按照他们的方式进行（在这种情况下，这比以前更加明确。）

我同意无论哪种方式都是一个冒险的决定。特别是因为 phpBB 在设计质量方面没有特别令人钦佩的记录。

# windows - Windows 上用于生产服务器的良好 SMTP 服务器

> ID：274512
> 
> 赞同：11
> 
> 时间：2008-11-08T07:54:11.840
> 
> 标签：windows, smtp

我将很快将我的网站托管在 VPS 或专用服务器（使用 Windows 2008）上，因此我正在尝试提前计划。我想知道 IIS7 附带的内置 SMTP 服务器对于生产服务器是否足够可靠，或者我应该寻找替代方案吗？我听说了有关 hmailserver 的好消息，而且最重要的是它是免费的，您是否有在高流量网站上使用内置 SMTP 的经验。

非常感谢任何建议

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-06-17T17:19:04.840

我通过谷歌点击了这个帖子，但我正在寻找一个仅用于交易电子邮件的出站 SMTP 服务器（客户注册确认等，但不是营销），然后我发现了一些事情：

SMTP 在 Windows Server 2008 中仍然存在。

服务器管理器 > 功能（不是角色）> 右键单击​​，添加 > SMTP 服务器 - 然后配置 IIS 7 SMTP 以指向本地服务器。

然后使用Framework做生意：http: [//msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)

Jango 为这类事情提供了付费但足够便宜的服务。免费帐户仅允许 200/月，但可能对某些人有用。

[http://www.jangosmtp.com/Pricing.asp](http://www.jangosmtp.com/Pricing.asp)

祝你好运！

**更新**

我写了一篇关于在 Windows Server 2008 上设置原始 MS SMTP 服务器的博客。

[http://www.lukepuplett.com/2010/06/how-to-send-email-from-microsoft-server.html](http://www.lukepuplett.com/2010/06/how-to-send-email-from-microsoft-server.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-08T13:26:46.723

[邮件服务器](https://www.hmailserver.com/)。免费和开源。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T10:00:40.150

在工作中，我们多年来一直使用 IIS 6.0 中的 SMTP 服务器，它非常好。

最终，我们只是不希望出现运行 SMTP 服务器带来的所有问题，因此我们将 MX 记录映射到第三方服务并继续我们的生活。

将您的 MX 记录映射到第三方提供商（如 Google）实际上并不是一个坏主意。配置少了一项服务，打补丁少了一项服务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T08:25:44.913

**[xmailserver](http://www.xmailserver.org/)**怎么样（如this [SO question](https://stackoverflow.com/questions/30076/need-a-lightweight-free-windows-smtp-server)中所建议）？

它是免费的，适用于 Windows 或 linux（如果您在 linux 服务器平台上迁移）

[![替代文字](https://i.stack.imgur.com/kSVTT.gif)](https://i.stack.imgur.com/kSVTT.gif)
[（来源：[xmailserver.org](http://www.xmailserver.org/logoxmail.gif)）]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-26T15:15:56.973

这是一篇旧帖子，但我想我会提出建议，因为这似乎经常出现。

在我看来，如果可以的话，你应该尽量避免在你的`VPS/Dedicated`服务器上运行邮件。这是另一件需要管理的事情，也是一件令人头疼的事情。我的建议是使用像 sendgrid.com 这样的第三方服务，它允许您通过它们中继邮件。这样，您就不必担心您的新服务器会被列入黑名单或被视为信誉评分低，并且您的邮件不会从用户的垃圾邮件箱中取出。另一个问题是，当你设置你的邮件服务器时，你需要保护它并且你需要确保它有一个反向 DNS 条目，许多提供商不会提供这个和/或他们会回收 IP 地址以便 IP您的服务器地址实际上声誉不佳。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T08:52:04.487

在 Windows 上，您最好的选择可能是 IIS。

如果是Linux，我建议使用postfix。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T09:42:09.800

您没有提到您是需要接收邮件还是只是发送邮件。Windows 邮件服务器最好的全方位解决方案之一是 IpSwitch 的 iMail ( [http://www.ipswitch.com/](http://www.ipswitch.com/) )，但它的成本很高。

如果您主要需要发送邮件，那么最好的选择是使用上游 smtp 服务器。

IIS smtp 服务通常没有用处。如果您使用 Exchange，它会变得更好一些，但仍然不是很有效，而且无论如何都不是最安全的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-08T08:11:03.710

也许通过 gmail 发送它是一个不错的选择：P 好的，认真的。~~IIS7 似乎我听说有一些不错的改进。~~如果不这样做，我想你可以尝试免费的东西，比如 mailenable。（不，我找不到关于 IIS SMTP 改进的证据，知道的人请发表评论）

但是，从长远来看，您最终可能会将其拆分为基于 linux 的 smtp，如果它过于疯狂，这会给您在服务器农场方面提供一些灵活性。

如果它用于任何可能触发垃圾邮件服务器阻止的群发邮件，请不要尝试将其与其他重要内容一起托管 - 如果您的服务器被阻止，您希望让自己有后退一步。

# delphi - Form.Release + NIL

> ID：274523
> 
> 赞同：11
> 
> 时间：2008-11-08T08:29:03.660
> 
> 标签：delphi, winapi, vcl

如果在使用表单后调用 Form.Release，它将释放所有相关内存但不会将表单变量设置为 nil。

```
if not assigned (Form1) then
  begin
    Application.CreateForm(Tform1, Form1);
    try
      // Do something
    finally
      Form1.Release
    end;
  end; 
```

为了能够再次调用相同的代码，Form1 必须在某个时候设置为 nil。从 Release 我不能做的描述

```
Form1 := nil; 
```

在 Release 之后，因为 Release 过程将在被调用之后和实际释放表单之前直接返回。我无法检测到 Form.Release 何时完成将表单 var 设置为 nil。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-08T09:12:50.450

放线

```
 Form1 := nil; 
```

就在调用 Release 之后。

Release 只是将 CM_RELEASE 消息发布到 Form，它允许 Form 在处理 CM_RELEASE 消息之前完成其队列（事件处理程序）中的内容，这意味着通常只是调用 Free。
因此，在调用 Release 之后，您不应假定 Form 变量仍然指向有效的 Form，从而将 nil 放入变量中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-08T09:22:22.427

发布只是（可能）延迟的免费。调用 Release 后您应该做的第一件事是取消变量。
然后，即使某些代码在实际销毁 Form1 之前尝试引用它，您也将是安全的。在像您的代码中这样的情况下，它只会安全地重新创建另一个 Form1 以供新用途，而不会打扰被销毁的那个。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-08T19:58:43.563

你们可以总是这样称呼：

```
procedure FreeOrReleaseAndNil(var Obj);
var
  Temp: TObject;
begin
  Temp := TObject(Obj);
  Pointer(Obj) := nil;
  if Temp is TCustomForm then
    TCustomForm(Temp).Release
  else
    Temp.Free;
end; 
```

请务必在转换为 TObject 后检查类型，因为您无法测试 Obj 的类型。这*应该*是安全的，因为与 Free 一样，Release 是非虚拟的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T13:47:24.453

如前所述，如果要关闭/释放自身，Release 只是表单使用的延迟释放。其他然后被推迟它与发布没有什么不同。所以在那个例子中调用 Release 是没有用的。调用 Free 似乎更合乎逻辑。您可以在调用 Free 或使用 FreeAndNil 后将其设置为 nil。

如果您仍想使用 Release，那很好。只需将变量值设置为 nil 即可。这样做不会使论坛的行为有所不同。但请记住，在这种情况下，调用 Free 而不是 Release 会更有效且更具确定性。我的偏好是只在真正需要的地方使用 Release。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T08:53:05.497

在 Delphi Win32 中，释放对象的适当方法是调用

```
FreeAndNil(Form1) 
```

这在一次调用中完成了这两项工作。

但是，我有一种偷偷摸摸的感觉，你的问题比表面上看到的要多。您是否使用 Delphi for .NET - 如果是，是哪个版本？

# django - 如何在我的 Django 模型中列出项目？

> ID：274529
> 
> 赞同：2
> 
> 时间：2008-11-08T08:37:45.733
> 
> 标签：django, django-templates

我正在使用 django Publisher 示例，我想通过我的 list_publisher.html 模板列出数据库中的所有发布者，我的模板看起来像；

```
{% extends "admin/base_site.html" %}
{% block title %}List of books by publisher{% endblock %}
{% block content %}

<div id="content-main">
<h1>List of publisher:</h1>

{%regroup publisher by name as pub_list %}

{% for pub in pub_list %}

<li>{{ pub.name }}</li>

{% endfor %}
</div>
{% endblock %} 
```

但是当我运行“ [http://127.0.0.1:8000/list_publisher/](http://127.0.0.1:8000/list_publisher/) ”时，模板只会打印页面标题而没有错误！我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T08:53:36.667

几点建议：

*   检查您的 base_site.html 是否定义了一个`{% block content %}{% endblock %}`要由您的 my list_publisher.html 优化的部分
*   检查列表的基数：`{%regroup publisher by name as pub_list %}{{ pub_list|length }}`. 那至少应该显示列表的长度。如果是'0'......你知道为什么它不显示任何东西
*   在使用重组之前检查您的列表是否确实按名称排序，或者使用 a`{% regroup publisher|dictsort:"name" by name as pub_list %}`来确定

如果长度为“0”，则必须确保发布者已定义（已从数据库初始化），并进行了适当的排序。

换句话说，您是否在任何地方看到（在您的模板中或在定义的模板中）：

```
publisher = Publisher.objects.all().order_by("name") 
```

?
（同样，按名称排序很重要，以确保您的重组标签正常工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T17:38:43.597

VonC的好答案。

查看 pub_list 的一种快速而肮脏的方法是粘贴`[{{pub_list}}]`您的模板。我把它放在方括号里，以防它是空的。顺便说一句，您可能会得到类似`[,,,,,]`. 这是因为对象引用包含在 <> 中，而您的浏览器正在运行 WTF？只需查看源代码，您就会看到完整的结果。

# wcf - 为 WCF 选择最佳安全选项

> ID：274533
> 
> 赞同：0
> 
> 时间：2008-11-08T08:51:04.160
> 
> 标签：wcf, security

我们有一个项目，其中包含 WCF 服务和一些连接到它的客户端。其中一些是使用 NetTcp 连接到服务的 PC。很少有人在 Windows Mobile 设备（Compact Framework）上运行，使用 BasicHttp 进行连接。我们不能使用 Windows 身份验证，因为不同的 PC 使用不同的 Windows 帐户。我们如何确保服务仅允许有效的 PC 和移动设备使用它而拒绝其他设备？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T03:30:26.223

我相信您可以启用的最佳安全性是通过 HTTP 的 SSL 和通过用户名和密码的标准身份验证方案。要对 WCF 的各个安全方面进行非常全面的审查，请查看 Codeplex 站点： http: [//www.codeplex.com/WCFSecurity](http://www.codeplex.com/WCFSecurity)

特别是这个页面： http: [//www.codeplex.com/WCFSecurityGuide](http://www.codeplex.com/WCFSecurityGuide)

# asp.net-mvc - ASP.NET MVC - 脚本组合

> ID：274536
> 
> 赞同：14
> 
> 时间：2008-11-08T08:53:06.543
> 
> 标签：asp.net-mvc, performance

ASP.NET 团队在 3.5 SP1 中发布了脚本组合功能，详见[http://www.asp.net/Learn/3.5-SP1/video-296.aspx](http://www.asp.net/Learn/3.5-SP1/video-296.aspx)。MVC 框架是否已经有类似的功能？如果不是，这是否在范围内，或者是否有可能以某种方式利用 MVC 中的网络表单功能？我看到这个站点使用了一个自定义的 jquery.package.master，我假设他们已经自己滚动了（可能进入了构建周期，但是它并没有全部缩小，因此我认为他们已经手动将脚本附加在一起而不是一些自动缩小 &结合任务）。会对如何在 MVC 中实现这一点感兴趣，但我不想开始滚动我自己的任何功能，以防我会复制正在进行的工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T15:38:55.053

这就是我所做的，以防万一。

在我的后期构建中，我调用了Dean [Edwards 的 Packer的](http://dean.edwards.name)[命令行版本](http://svn.offwhite.net/trac/SmallSharpTools.Packer/wiki)。它结合了脚本并为我打包它们。

不过现在，我将所有东西分开，并使用 Helper 方法来包含我的脚本，如果调试标志不存在，它将包含打包版本，否则包含解包版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-15T02:03:01.197

另一个选项在 Telerik Native UI Extensions for MVC（免费库和开源）中，称为 ScriptRegistar。它将为您组合和压缩 javascript，并且功能相当丰富。还有一个类也可以对 css 做同样的事情。

我正在使用它将+20个javascript文件组合成一个由浏览器下载的文件。

[http://www.telerik.com/products/aspnet-mvc.aspx](http://www.telerik.com/products/aspnet-mvc.aspx)，您可以通过 NuGet 获取它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-01T02:04:04.087

每天都有不同的做事方式和技术变化。

此时CodePlex中发布了一个非常好的Nuget Package。

Combres - WebForm & MVC 客户端资源组合库
[http://combres.codeplex.com/](http://combres.codeplex.com/)

[http://weblogs.asp.net/gunnarpeipman/archive/2009/07/04/asp-net-mvc-how-to-combine-scripts-and-other-resources.aspx](http://weblogs.asp.net/gunnarpeipman/archive/2009/07/04/asp-net-mvc-how-to-combine-scripts-and-other-resources.aspx)

# asp.net - 如何发布我们的 Web 服务

> ID：274540
> 
> 赞同：0
> 
> 时间：2008-11-08T08:58:12.883
> 
> 标签：asp.net, web-services

我创建了一个需要发布此服务的 Web 服务。我需要托管和经过身份验证的用户需要使用 ASP.net 2.0 访问我的服务

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-08T14:00:51.803

我不确定您是否要求替代方案，但我一直在试验[这段代码](http://www.codeproject.com/KB/WCF/generic_wcf_host.aspx)，该代码似乎在 codeproject.com (CP) 上运行良好。

如果您的问题是关于安全性的，也许[这篇](http://www.codeproject.com/KB/WCF/wcfcertificates.aspx)关于 CP 的文章是一个有用的开始。

# c# - 从属性构造函数中检索带注释的方法

> ID：274544
> 
> 赞同：2
> 
> 时间：2008-11-08T09:10:14.840
> 
> 标签：c#

如果我用属性注释类的方法，然后我可以检索该类的自定义属性并查看它是否具有该属性。例如，我正在构建一个面向消息的程序，所以我有类似的类

```
public class ErrorHandler
{
  [HandleMessage(ErrorHandling.ERROR)]
  private static void OnError(string message, object context, params object[] args)
  {
    Exception e;
    args.Extract(out e);

    Console.WriteLine(e.Message + Environment.NewLine + e.StackTrace);
  }
} 
```

在运行时我可以这样做：

```
public static void RegisterStaticHandlers(Type type)
{
  foreach (var mInfo in type.GetMethods(BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Static))
  {
    var mAttr = mInfo.GetCustomAttribute<HandleMessageAttribute>();
    if (mAttr != null)
      RegisterInstanceHandler(mAttr.Message, mInfo.CreateDelegate<MessageHandler>());
  }
} 
```

（我有一些扩展方法来简化代码，它们现在不相关。）

我的问题是：我可以完全摆脱这个`RegisterStaticHandlers`方法并在属性构造函数中注册处理程序吗？

```
public class HandleMessageAttribute : Attribute
{
  public string Message { get; private set; }

  public HandleMessageAttribute(string message)
  {
    Message = message;

    Messages.RegisterInstanceHandler(message, ... method reference here ...);
  }
} 
```

有没有办法检索由属性构造函数中的属性注释的方法，而不是获取方法并获取其属性的相反（和常规）方式？

[编辑]我刚刚意识到我至少可以在静态构造函数中做到这一点：

```
static ErrorHandler()
{
  Messages.RegisterStaticHandlers(typeof(ErrorHandler));
} 
```

这至少可以在该类中保留一个类的注册，就我而言这很棒:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T09:12:13.493

简而言之，您不能从属性构造函数中执行此操作，当构造属性时，它无法访问应用它的目标方法/类/字段/等。

从代码中，我假设您希望代码在启动时自动注册？一种方法可能是探测您的程序集（一次，在启动时） - 枚举所有类 ( `foreach(Type type in assembly)`)，找到具有候选错误处理程序的那些。这减少了维护负担。另一种选择是使用配置文件类似的东西。

# vb6 - 使用 VB6 将 WAV 文件转换为 MP3？

> ID：274553
> 
> 赞同：1
> 
> 时间：2008-11-08T09:25:13.327
> 
> 标签：vb6, encoding, mp3

我需要帮助将 WAV 文件转换为 VB6 中的 MP3 格式。我确实已经[在 C# 中找到了源代码](http://www.codeproject.com/KB/audio-video/MP3Compressor/MP3Compressor.zip)，但我不能使用它

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T12:41:59.030

这是地球上最伟大的程序员（谷歌）的代码示例：

[VB6 Lame MP3 编码器](http://www.vbaccelerator.com/home/vb/code/vbmedia/audio/MP3_Encoding_with_LAME/VB6_Lame_MP3_Encoder.asp)

不要让“lame”这个词愚弄你——我想它代表“ **LA** me **M** p3 **E** ncoder”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T09:31:57.870

AFAIK，MP3 压缩已获得专利，您只能通过购买许可证合法地做到这一点。

或者，像许多其他软件一样，使用 Lame DLL 而不分发它，但要求在不受相同法律约束的站点中下载它......

不知何故，这就是 Opera 使用 GPL 软件的方式：它们不提供开箱即用的拼写更正，但它们指示下载并安装 aspell...

请注意，您可以使用免费的替代品，例如 Ogg Vobis，这取决于您的目的。

# encryption - 如何测试公共/私有 DSA 密钥对？

> ID：274560
> 
> 赞同：177
> 
> 时间：2008-11-08T09:36:32.477
> 
> 标签：encryption, ssl, openssl, key

有没有一种简单的方法来验证给定的私钥是否与给定的公钥匹配？我有`*.pub`几个`*.key`文件，我需要检查哪个文件。

同样，这些是 pub/key 文件，DSA。

我真的更喜欢某种单线...

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2008-11-08T12:22:00.473

我找到了一种似乎对我更有效的方法：

```
ssh-keygen -y -f <private key file> 
```

该命令将输出给定私钥的公钥，因此只需将输出与每个 *.pub 文件进行比较。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-11-11T13:48:05.057

我总是使用以下命令比较模数的 MD5 哈希：

```
Certificate: openssl x509 -noout -modulus -in server.crt | openssl md5
Private Key: openssl rsa -noout -modulus -in server.key | openssl md5
CSR: openssl req -noout -modulus -in server.csr | openssl md5 
```

如果哈希匹配，那么这两个文件一起去。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2008-11-08T11:06:04.480

对于 DSA 密钥，使用

```
 openssl dsa -pubin -in dsa.pub -modulus -noout 
```

打印公钥，然后

```
 openssl dsa -in dsa.key -modulus -noout 
```

显示与私钥对应的公钥，然后进行比较。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2008-11-08T09:49:43.527

假设您在 X.509 证书中有公钥，并假设它们是 RSA 密钥，那么对于每个公钥，执行

```
 openssl x509 -in certfile -modulus -noout 
```

对于每个私钥，执行

```
 openssl rsa -in keyfile -modulus -noout 
```

然后按模数匹配键。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-03-23T18:50:38.797

使用 diff 可以更轻松地进行检查：

```
diff <(ssh-keygen -y -f $private_key_file) $public_key_file 
```

唯一奇怪的是，如果文件相同，diff 什么也不说，所以只有公共和私人*不*匹配时才会告诉你。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-03-04T18:46:32.903

输入以下命令，**检查私钥和公钥是否是**$USER/.ssh 目录中的匹配集（相同）或不匹配集（不同）。cut 命令防止比较公钥中行尾的注释，只允许比较密钥。

```
ssh-keygen -y -f ~/.ssh/id_rsa | diff -s - <(cut -d ' ' -f 1,2 ~/.ssh/id_rsa.pub) 
```

输出看起来像这些行中的任何一个。

```
Files - and /dev/fd/63 are identical

Files - and /dev/fd/63 differ 
```

我编写了一个 shell 脚本，用户使用它来检查他们的 ~/.ssh/files 和匹配的密钥集的文件权限。它解决了我在用户事件设置 ssh 时遇到的挑战。它可能会帮助你。 [https://github.com/BradleyA/docker-security-infrastructure/tree/master/ssh](https://github.com/BradleyA/docker-security-infrastructure/tree/master/ssh)

注意：我之前的回答（2018 年 3 月）不再适用于最新版本的 openssh。上一个答案： diff -qs <(ssh-keygen -yf ~/.ssh/id_rsa) <(cut -d ' ' -f 1,2 ~/.ssh/id_rsa.pub)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-08T12:35:59.120

删除公钥并从私钥生成新的。将它们保存在单独的目录中，或使用命名约定使它们保持直截了当。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-09-27T10:49:06.557

如果您在 Windows 中并且想要使用 GUI，您可以使用[puttygen](https://the.earth.li/~sgtatham/putty/latest/x86/puttygen.exe)将您的私钥导入其中：

[![在此处输入图像描述](https://i.stack.imgur.com/8MfK5.png)](https://i.stack.imgur.com/8MfK5.png)

导入后，您可以保存其公钥并将其与您的进行比较。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-08T09:38:12.350

用公钥加密一些东西，看看哪个私钥解密它。

这篇由[Jeff Atwood撰写的](https://en.wikipedia.org/wiki/Jeff_Atwood)[Code Project 文章](http://www.codeproject.com/KB/security/SimpleEncryption.aspx)围绕 .NET 加密类实现了一个简化的包装器。假设这些密钥是为与 RSA 一起使用而创建的，请使用非对称类和您的公钥进行加密，并使用您的私钥进行解密。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-05-06T17:59:51.347

最简单的方法是比较指纹，因为公钥和私钥相同。通过将两个命令放在同一行上，视觉比较非常容易：

```
ssh-keygen -l -f PRIVATE_KEY; ssh-keygen -l -f PUBLIC_KEY 
```

以编程方式，您需要忽略注释部分

```
diff -s <(ssh-keygen -l -f PRIVATE_KEY | cut -d' ' -f2) <(ssh-keygen -l -f PUBLIC_KEY | cut -d' ' -f2) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-04-08T10:52:39.327

如果它什么都不返回，那么它们匹配：

```
cat $HOME/.ssh/id_rsa.pub >> $HOME/.ssh/authorized_keys
ssh -i $HOME/.ssh/id_rsa localhost 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2013-11-13T09:41:06.703

只需使用[puttygen](http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html)并将您的私钥加载到其中即可。它提供了不同的选项，例如导出相应的公钥。

# asp.net - 学习用于 ASP.NET 的 Ext JS 的最佳方法是什么？

> ID：274565
> 
> 赞同：1
> 
> 时间：2008-11-08T09:43:04.023
> 
> 标签：asp.net, extjs

我对 Javascript 有非常基本的了解，现在我期待学习 Ext JS 并在我的 ASP.NET 应用程序中实现。

如果有人能指导我如何开始以及我应该遵循哪本书，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T19:14:17.117

不确定这是否是最快的方法，但我所做的（以及与我一起工作的另一位开发人员）只是查看 ExtJS 文档和示例库（并查看它们的源代码）。

将 ExtJS 与 ASP.NET 一起使用时要注意的一个大问题是，当使用 BorderLayout 时，您会疯狂地试图弄清楚为什么 Postbacks 不再起作用。 [不过有一个解决方法](http://extjs.com/forum/archive/index.php/t-14261.html)。

另一个 ASP.NET 陷阱是，如果您使用 ExtJS 与 ASP.NET Web 服务（或 WCF）对话，您必须做一些特殊的事情才能让它工作（用特殊属性装饰您的 webmethod，或者向 web.net 添加一些东西。配置等）。

除了学习和掌握 ExtJS 本身之外，这是我能记得的仅有的两个问题。

# c++ - 如何使用 Microsoft Visual C++ 调试器调试 MinGW EXE？

> ID：274566
> 
> 赞同：2
> 
> 时间：2008-11-08T09:44:38.547
> 
> 标签：c++, visual-c++, debugging, mingw

如何使用 Microsoft Visual C++ 调试器调试 MinGW EXE？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T10:28:50.983

您可以将 Visual C++ 调试器附加到系统上运行的任何进程（从 Visual C++ 菜单）。但是为了能够单步执行您的源代码，Visual C++ 必须加载符号文件（如果我没记错的话是 .pdb）并且我认为 GCC 不会生成这些文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-25T09:04:03.930

存在许多 Visual Studio 扩展，例如我们：WinGDB、VisualGDB，您可以在 Web 上找到它。它允许您作为常规 Visual Studio 项目进行调试。这些项目不是免费的，但它有 30 天的完整功能试用期。它有一些限制，但已经足够好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-23T14:38:32.930

**问题：**

GCC 编译器（即 MinGW 的 gcc）生成带有“-g”标志的调试信息。调试信息嵌入到生成的可执行文件中。另一方面，Windows 的编译器使用一种特殊的“.pdb”格式来存储调试信息。例如，Microsoft Visual Studio 的调试器不仅需要可执行文件 (.exe)，还需要其调试信息 (.pdb) 可用。

**解决方案：**

有一个小程序可以从用 gcc 编译的可执行文件中提取 .pdb 文件。它被称为 cv2pdb，可在[https://github.com/rainers/cv2pdb](https://github.com/rainers/cv2pdb)获得。

*   下载 cv2pdb [https://github.com/rainers/cv2pdb](https://github.com/rainers/cv2pdb)

*   将 cv2pdb.exe 放在路径中的某个位置，可能是自定义 bin 文件夹，以便可以通过命令行访问它。

*   像往常一样使用 MinGW 的 gcc 编译器编译您的文件，并带有“-g”标志，以便包含调试信息。

*   只需在可执行文件上运行 cv2pdb.exe。

    cv2pdb out.exe

    这将在同一目录中生成一个 out.pdb 文件。

*   （如果您安装了 Microsoft Visual Studio）直接在 Microsoft Visual Studio 中打开可执行文件

    开发环境输出.exe

**注意：**此命令只是在 Microsoft Visual Studio 中打开可执行文件，而不为它创建项目。实际上，您可以使用任何文本编辑器 + 构建系统来构建可执行文件，然后仅将 Visual Studio 用作独立调试器。

# php - 如何扩展这个简单的 DataMapper？

> ID：274567
> 
> 赞同：1
> 
> 时间：2008-11-08T09:45:14.067
> 
> 标签：php, design-patterns, orm, datamapper

有人可以从以下内容中得出一个具体的例子：

[http://www.urdalen.com/blog/?p=210](http://www.urdalen.com/blog/?p=210)

..这表明如何处理`one-to-many`和`many-to-many`关系？

我前段时间给作者发了邮件，但没有收到回复。我喜欢他的想法，但不知道如何在简单的单表关系之外实现它。

注意：我不想使用成熟的 ORM。我喜欢手工编写 SQL。不过，我想改进我的应用程序代码的设计。现在，每个域对象都有自己的类，其中充满了封装在静态方法中的查询。它们只是根据查询返回标量、一维数组（记录）或二维数组（记录集）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T12:51:59.197

ORM（所谓的阻抗失配）的问题正是与关系有关。在对象图中（内存中的对象），关系是指向其他对象的指针。在关系数据库中，关系是颠倒的；这使得不可能在两个模型之间进行简单的映射，这就是 ORM 如此复杂的原因。

如果您想靠近数据库（避免使用 ORM），那么您不应该尝试抽象关系。我编写数据映射器的方式如下：

```
$car42 = $car_gateway->fetch(42);
$wheels = $wheel_gateway->selectByCar($car42); 
```

对比ORM方式：

```
$car42 = $car_gateway->fetch(42);
$wheels = $car42->selectWheels(); 
```

这确实意味着网关最终出现在您的客户端代码中，但它也使事情变得非常透明并接近数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T22:06:20.417

如果您正在寻找一个简单且可移植的 DataMapper ORM，请查看[phpDataMapper](http://phpdatamapper.com)。它仅依赖于 PHP5 和 PDO，而且它非常小巧轻便。它还支持表关系和其他一些非常好的特性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T13:10:22.250

鉴于您对 Tom 的回答，我建议您查看 Zend Framework 之类的东西。它的 ORM 具有可以分阶段实施的“接受或离开”架构。

当我来到我现在的雇主那里时，他们有一份几个月前刚刚完成的申请，但已经通过了一两个之前的版本，而当前版本的开发时间比预期的要长六个月。但是，代码库很混乱。例如，数据库访问逻辑和业务逻辑之间没有抽象。而且，他们希望我推动网站向前发展，构建新功能、扩展现有功能并修复代码中的现有错误。更复杂的是，他们没有在数据输入或输出上使用任何形式的卫生设施。

当我开始涉足这个问题时，我意识到我需要一个可以分步实施的抽象问题的解决方案，因为它们显然不会完全重写。我最初的方法是编写一个自定义的 ORM 和 DAL，这将为我完成繁重的工作。它工作得很好，因为它没有侵入现有的代码库，因此它允许我以不显眼的方式将应用程序的整个部分移动到新架构中。

然而，在将我们网站的大部分用户区域移植到这个新结构并在我的自定义框架上构建了一个完整的应用程序（其中还包括一个自定义前端控制器和 mvc 实现）之后，我正在切换到 Zend 框架（这是我的选择，尽管我确信其他一些框架也可以在这种情况下工作）。

在切换到 Zend 框架时，我完全不担心遗留代码库，因为：

*   我可以不显眼地构建新模型和重构旧模型（构建在我的自定义框架上）。
*   我可以重构现有的控制器（例如它们），使其封装在一个行为方式与 Zend 的 MVC 框架一致的类中，这样实际开始使用 Zend 的前端控制器就成了一个小问题。
*   我们的视图已经在 Smarty 中构建，因此我不必担心分离控制器和视图逻辑，但我将能够扩展 Zend 框架，以便我可以在 Smarty 中呈现现有模板，同时在直接 PHP 中构建新模板。

基本上，Zend Framework 有一个接受它或离开的架构，这使得在现有项目中使用它是一种乐趣，因为新代码和重构代码不需要侵入现有代码。

# wcf - 在 NETCF 中实现消息安全

> ID：274568
> 
> 赞同：2
> 
> 时间：2008-11-08T09:46:09.103
> 
> 标签：wcf, compact-framework, x509

据我所知，NETCF 仅支持 WS-Security 1.0 版的一个子集，它使用 X.509 证书。如何获得这样的证书以在我的应用程序中实现它并防止其他人使用我的 WCF 服务？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2008-11-08T09:50:13.650

本文[介绍](http://blogs.microsoft.co.il/blogs/applisec/archive/2008/04/08/creating-x-509-certificates-using-makecert-exe.aspx)如何创建 X.509 证书。这个[描述](http://msdn.microsoft.com/en-us/library/aa702621.aspx)了如何使 WCF 可以访问证书。

# metrics - LOC 计数是否应该包括测试和评论？

> ID：274575
> 
> 赞同：14
> 
> 时间：2008-11-08T09:59:44.350
> 
> 标签：metrics, code-metrics

虽然 LOC（# 代码行）是衡量代码复杂性的一个有问题的衡量标准，但它是最流行的一种，如果使用得非常小心，至少可以粗略估计代码库的相对复杂性（即，如果一个程序是 10KLOC另一个是 100KLOC，由具有大致相同能力的团队用相同的语言编写，第二个程序几乎肯定要复杂得多）。

在计算代码行数时，您更喜欢计算注释吗？测试呢？

我已经看到了各种方法。cloc 和 sloccount 等工具允许包含或排除注释。其他人认为注释是代码的一部分及其复杂性。

单元测试也存在同样的困境，有时会达到被测代码本身的大小，甚至超过它。

我已经看到了各种方法，从仅计算“可操作”非注释非空白行到“XXX 行测试、注释代码”，这更像是在所有代码文件上运行“wc -l”项目”。

你的个人偏好是什么，为什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-08T10:50:17.103

在管理程序员时，一位智者曾经告诉我“你得到你所衡量的”。

如果您在其 LOC 输出中对它们进行惊人的评价，您往往会得到很多代码行。

如果您根据他们关闭的错误数量对他们进行评分，那么令人惊讶的是，您会修复很多错误。

如果您根据添加的功能对它们进行评分，您将获得很多功能。

如果你根据圈复杂度对它们进行评分，你会得到非常简单的函数。

由于如今代码库的主要问题之一是它们的增长速度以及它们一旦增长就很难改变，我倾向于完全避免使用 LOC 作为衡量标准，因为它会导致错误的基本行为.

也就是说，如果您必须使用它，请计算无评论和测试，并且需要一致的编码风格。

但是，如果您真的想要衡量“代码大小”，只需 tar.gz 代码库。它倾向于作为对“内容”的更好粗略估计，而不是计算易受不同编程风格影响的行数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-08T12:49:58.140

也必须维护测试和评论。如果您打算使用 LOC 作为指标（我只是假设我不能说服您放弃它），您应该给出所有三个（真实代码行、注释、测试）。

最重要（并且希望是显而易见的）事情是你要始终如一。不要报告一个项目只有几行真实代码，而另一个项目结合了这三行。查找或创建一个工具，为您自动执行此过程并生成报告。

```
Lines of Code:       75,000
Lines of Comments:   10,000
Lines of Tests:      15,000
                  ---------
Total:              100,000 
```

这样你就可以确定它会

1.  完成。
2.  每次都以同样的方式完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T10:11:26.463

我个人认为 LOC 指标本身并不像其他一些代码指标那样有用。

[NDepend](http://www.ndepend.com/)将为您提供 LOC 指标，但也会为您提供许多其他指标，例如循环复杂度。这里没有列出所有这些，而是​​列表的[链接](http://www.ndepend.com/Metrics.aspx)。

[Reflector](http://www.red-gate.com/products/reflector/)还有一个免费的CodeMetric[插件](http://www.codeplex.com/reflectoraddins)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T10:15:42.353

我不打算直接回答你的问题，原因很简单：我*讨厌*代码行数。无论您要测量什么，都很难做得比 LOC 更差；几乎任何其他你关心的指标都会变得更好。

特别是，您似乎想要衡量代码的*复杂性*。总体[循环复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)（也称为 McCabe 复杂度）是更好的度量标准。

具有高循环复杂度的例程是您想要集中注意力的例程。正是这些例程难以测试，因漏洞而腐烂到核心并且难以维护。

有许多工具可以测量这种复杂性。用你最喜欢的语言在谷歌上快速搜索一下，就会发现有几十种工具可以实现这种复杂性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T10:23:24.740

*代码行数的*确切含义是：不计算注释或空行。为了使其与其他源代码具有可比性（无论其指标是否有用），您至少需要类似的编码风格：

```
for (int i = 0; i < list.count; i++)
{
    // do some stuff
}

for (int i = 0; i < list.count; i++){
    // do some stuff
} 
```

第二个版本完全相同，但少了一个 LOC。当你有很多嵌套循环时，这可以总结很多。这就是发明[功能点](http://en.wikipedia.org/wiki/Function_point)等指标的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T13:22:05.627

取决于您使用 LOC 的目的。

作为一种复杂性度量 - 不是那么多。也许 100KLOC 主要是从一个简单的表生成的代码，而 10KLOC 是 5KLOC 正则表达式。

但是，我看到与运行成本相关的每一行代码。只要程序存在，您就需要为每一行付费：它需要在维护时读取，它可能包含需要修复的错误，它会增加编译时间、从源代码控制获取和备份时间，然后再进行更改或删除它，您可能需要确定是否有人依赖它等。平均成本可能是每行和每天几分钱，但这是加起来的东西。

KLOC 可以成为项目需要多少基础设施的第一手指标。在这种情况下，我将包括注释和测试——即使注释行的运行成本远低于第二个项目中的正则表达式之一。

[编辑] [对代码大小有类似看法的人] [1](http://steve-yegge.blogspot.com/2007/12/codes-worst-enemy.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-20T18:18:59.807

我们只使用代码行数来衡量一件事——一个函数*应该*包含足够少的代码行，以便在不滚动屏幕的情况下阅读。比这更大的函数通常很难阅读，即使它们的循环复杂度非常低。对于他的使用，我们确实计算了空格和注释。

*看看你在重构过程中删除*了多少行代码也很不错——在这里你只想计算实际的代码行数、不利于可读性的空格和无用的注释（不能自动化）。

最后是免责声明 - 明智地使用指标。指标的一个很好的用途是帮助回答“代码的哪一部分将从重构中受益最多”或“最新签入的代码审查有多紧迫？”的问题。- 一个圈复杂度为 50 的 1000 行函数是一个闪烁的霓虹灯，上面写着“现在重构我”。对指标的不好使用是“程序员 X 的生产力如何”或**“我的软件有多复杂”**。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-30T16:46:33.920

文章摘录：[如何计算代码行数 (LOC) ？](http://codebetter.com/blogs/patricksmacchia/archive/2007/10/03/how-do-you-count-your-number-of-lines-of-code-loc.aspx)相对于计算.NET 程序的逻辑[代码行](http://www.ndepend.com/Metrics.aspx#NbLinesOfCode)数的工具 NDepend 。

* * *

# 您如何计算代码行数 (LOC) ？

你算方法签名声明吗？你计算只有括号的行吗？当一个方法调用因为大量参数而写在多行时，您是否计算了几行？你计算“命名空间”和“使用命名空间”声明吗？你计算接口和抽象方法声明吗？您在声明字段分配时计算它们吗？你算空行吗？

根据每个开发人员的编码风格和选择的语言（C#、VB.NET……），通过测量 LOC 可能会有显着差异。

显然，从解析源文件中测量 LOC 看起来像是一个复杂的主题。由于机敏，有一种简单的方法可以准确地测量所谓的逻辑 LOC。与物理 LOC（从解析源文件推断的 LOC）相比，逻辑 LOC 有 2 个显着优势：

*   编码风格不会干扰逻辑 LOC。例如，LOC 不会更改，因为由于参数数量较多，方法调用在多行中产生。
*   逻辑 LOC 独立于语言。从用不同语言编写的程序集中获得的值具有可比性并且可以相加。

在 .NET 世界中，逻辑 LOC 可以从 PDB 文件中计算出来，这些文件被调试器用来链接 IL 代码和源代码。工具 NDepend 以这种方式计算方法的逻辑 LOC：它等于在 PDB 文件中为方法找到的序列点的数量。序列点用于标记 IL 代码中与原始源中的特定位置相对应的点。有关序列点的更多信息在这里。请注意，对应于 C# 大括号'{' 和 '}' 的序列点没有被考虑在内。

显然，类型的 LOC 是其方法的 LOC 之和，命名空间的 LOC 是其类型的 LOC 之和，程序集的 LOC 是其命名空间的 LOC 之和，应用程序的 LOC 是其程序集 LOC 的总和。以下是一些观察：

*   接口、抽象方法和枚举的 LOC 等于 0。计算 LOC 时只考虑有效执行的具体代码。
*   命名空间、类型、字段和方法声明不被视为代码行，因为它们没有对应的序列点。
*   当 C# 或 VB.NET 编译器面临内联实例字段初始化时，它会为每个实例构造函数生成一个序列点（同样的注释适用于内联静态字段初始化和静态构造函数）。
*   从匿名方法计算的 LOC 不会干扰其外部声明方法的 LOC。
*   NbILInstructions 和 LOC（在 C# 和 VB.NET 中）之间的总体比率通常在 7 左右。

# html - 理解十六进制 html 颜色代码的直观方式？

> ID：274581
> 
> 赞同：14
> 
> 时间：2008-11-08T10:06:32.777
> 
> 标签：html, colors, mnemonics

是否有一种直观的方法或一个好的助记符来理解颜色与其十六进制值之间的对应关系？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-08T10:35:38.223

您只需要记住，刻度是 00（无颜色效果）到 FF（全彩效果），三联体的三个部分是红色、绿色和蓝色。

000000 是黑色（即无颜色），FFFFFF 是白色（混合所有三种原色）。

难点是记住混合物，我使用以下助记符：

*   **非常好的山药**：红+绿=黄（土豆是我最喜欢的食物）。
*   **非常糟糕的李子**：红色+蓝色=紫色（我真的很讨厌李子）。
*   **好/坏苹果**：绿色+蓝色=水色（我对苹果无动于衷）。

显然，如果您的食物口味与我的不同，您可能必须想出自己的助记符。但我发现这对我来说是最简单的方法。

然后只需改变数量以添加多一点红色或少一点蓝色等等。我通常只使用 00、40、80、C0 和 FF 的值，因为这为您提供了 125 色的调色板可供选择，我不希望有太多的选择让我慢下来。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-08T11:12:29.867

您需要在这里了解三个不同的事情。

1.  以十六进制读取和写入数字。这只需要练习并熟悉它。颜色代码的范围从 00（零）到 FF（= 255），所以花一点时间（在科学模式下使用 calc.exe，也许？）选择一个数字并尝试猜测它会是十六进制，反之亦然. 以十进制计数可能是您的第二天性；以十六进制计数是相同的概念，具有不同的符号和规则。

2.  如何将 RGB 颜色代码读取为三个分量值。RGB 代码可以写为三位 (#FFF) 或六位 (#FFFFFF)。在第一种情况下，每个数字都是一个颜色分量；红色，绿色，然后是蓝色。0 = 空，F = '满'（最大值）。第二个是相同的，但额外的数字为您提供了更广泛的音调，因为每个组件有 256 种可能的强度，而不是 16 种。

3.  了解 RGB 颜色模型。你的原色是红色、绿色和蓝色。您的辅助颜色是黄色 (R+G)、洋红色 (R+B) 和青色 (G+B)。增加所有值会使颜色变浅；将它们全部减少会使它变暗。纯灰度将具有三个相等的分量 - 例如#ddd、#222。通过将其中一个颜色值稍微调高一点来为灰色着色 - #866 将为您提供带有一丝红色的深灰色。这一点你只需要通过经验来学习。玩它。获取像[Instant Eyedropper](http://instant-eyedropper.com/)这样的工具，并使用它来查找已知颜色的十六进制值。

让它完全正确是非常非常困难的，但不会超过几天你就可以说“对......我想要橙色，它介于红色 (#F00) 和黄色 (#FF0) 之间“

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T10:49:51.720

把它想象成混合油漆。

RR、GG、BB、（RRGGBB）三种成分可以混合不同的强度。请记住，00 是最低强度，而 ff 是最高强度。

例如，我们知道 000000 在所有颜色上都是低强度的，并且是黑色的。同样，ffffff 在所有三个颜色分量中最高，并且将是白色的。

您可以通过使某一部分变强或变弱来添加或删除颜色。例如，从黑色 000000 开始，添加一点红色作为 330000，或者添加一点蓝色与 000033。两者都添加，看看 330033 会发生什么。

添加很多红色，带有ff0000。或者为 006600 添加适量的绿色。

如果所有三个分量都接近相同的强度，它们就会相互抵消，你就会得到灰度，这将取决于颜色的强度是亮的还是暗的。所以 000000、333333、666666、999999 和 ffffff 是黑色、深灰色、浅灰色和白色。

如果你取一个中灰色，再加一点蓝色，你最终会得到一个蓝灰色，比如 888899。红色、绿色和蓝色几乎相等，几乎是灰色，但蓝色更多一些。你可以对它们进行一些试验。

查看颜色代码的一个非常棒的工具是这个（小而免费）：

[http://www.nattyware.com/pixie.html](http://www.nattyware.com/pixie.html)

希望有帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T10:13:31.857

我不确定您的意思，但我始终记得它是一种 RGB 颜色：前两位代表红色，第二对代表绿色，最后两位代表蓝色。

像这样：*#RRGGBB*

当然，要记住较低的数字会产生较暗的颜色。

如果您正在寻找某种方法来记住橙色的颜色代码，恐怕您不走运。我总是需要看那个...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T10:13:10.593

十六进制颜色的格式为#RRGGBB，其中 RR 为红色，GG 为绿色，BB 为蓝色。由于它们是十六进制，它们的范围是 00-FF。从中可以很容易地大致衡量您正在处理的颜色类型，例如#FF12A3 将是相当红色的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T10:15:27.093

将颜色分解为代表红色、绿色和蓝色的三组值。每个段中的十六进制值越高，则该颜色就越多。所以#000000 是黑色，#FF0000 全是红色，#FF00FF 是紫色等等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T12:30:37.417

我认为获得一个好的[HTML 颜色图表](http://www.visibone.com/color/hexagon_800.gif)并将其放在办公桌旁很有用。我喜欢[Visibone](http://html-color-codes.com/)鼠标垫和海报。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T12:43:51.087

记住：

1) 十六进制对的顺序是红色、绿色和蓝色。这很容易记住，因为我们后面会谈到 RGB 颜色、RGB 屏幕等。

2) 数字应解释为颜色中的光量。所以 00 是没有光，而 FF 是该颜色的最大光。

3）我所有三种颜色都是同一级别的，它们“相互抵消”，所以我们得到一个灰度颜色。00 是最小光，例如，如果所有三种颜色都是 00，我们就没有光 - 即。黑色的。如果所有三种颜色都是最大光（#FFFFFF），我们得到白色，中间的任何数字都是灰色。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-08T10:57:11.067

好吧，显示器使用“RGB”配色方案。十六进制数中的颜色顺序为 RRGGBB。所以只要记住配色方案的名称就可以告诉你什么去哪里了。然后您可以将#RRGGBB 解析为三个数字RR、GG 和BB。

数字越高，特定组件越亮。

然后你只需要记住小学的加色轮。;)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-08T12:49:16.973

我现在设法直观地创建颜色（当然，通过一些试验和错误），已经练习了很多。播放/使用混色器（例如红色/绿色/蓝色滑块）有助于理解关系。现在，我知道 FFFF00 是黄色，FF00FF 是洋红色，00FFFF 是青色，当然还有原色，所有其他颜色都介于两者之间。

# testing - 模拟......和验证者？

> ID：274585
> 
> 赞同：2
> 
> 时间：2008-11-08T10:10:16.637
> 
> 标签：testing, mocking

目前，我正在更深入地研究测试技术，尽管我不确定我是否仍然居住在 unittest 领域或已经将其留在了集成测试领域。

让我详细说明一下，给定两个组件 A 和 B 并且 A 使用 B，那么我们对 B 有一定的“向上合同”，对于 A 有一定的“向下合同”。基本上这意味着：如果 A 正确使用 B 并且B 行为正确，那么两个合同都将得到履行，一切都会正常工作。

我认为模拟是一种保证给定测试用例所需的向上契约子集的方法。例如，如果数据记录之前已插入，则数据库连接可能具有检索数据记录的向上合同。数据库连接模拟保证返回某些记录，而不需要将它们插入数据库。

但是，我目前想知道是否也有办法验证向下合同。给定数据库连接的示例，向下契约可能是：您必须连接到数据库并确保连接存在且有效，并输入正确的 SQL 查询。

有没有人做这样的事情？这值得为更复杂的合同工作吗？（例如，数据库连接可能需要 SQL 解析器才能完全验证对数据库层的调用）

问候，泰达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T10:54:18.373

*有人这样做吗？*

是的，我有时使用模拟来验证“向下合同”。

例如，您可以使用 DB 模拟来检查用于登录的凭据是否正确。特别是，如果您有其他子系统的接口，那么您可以模拟它们并让模型检查使用违规。

例如，如果子系统需要初始化调用或某种注册，那么您的子系统接口模型也可以强制执行此操作。

* * *

*值得这份工作吗？*

这取决于你希望你的测试有多深，让我给你一些不同“深度”的例子：

1.  如果您想检查对接口的正确调用顺序，那么一个简单的状态机可能就足够了。
2.  如果您想验证界面语言（在您的示例中为 SQL）的正确使用，您必须使用解析器。
3.  If You want to verify that it actually works with the real subsystem, then make an integration test (cannot be done with mockups).

**Conclusion:**

If appropriate, it should be done. However, You cannot expect a mockup to find each and every wrong use of the interface. E.g. a database mockup hardly detects, if there will be a deadlock caused by two concurrent transactions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T10:54:51.133

This is really the [difference between mocks and stubs](http://martinfowler.com/articles/mocksArentStubs.html) - mocks verify exactly that (or at least can do so - you can use mocks as stubs with most frameworks). Essentially, mocks allows you to do *protocol testing* rather than just "if you call X I'll give you Y". Every mocking framework I've used allows you to easily verify things like "all these calls were made" and "these calls happened in a particular order".

The more protocol you enforce between components, the more brittle the tests will be - sometimes that's entirely appropriate (e.g. "you *must* authenticate *before* you perform any other operations") but it's easy to end up with tests which have to be changed every time you change the implementation, even in a reasonable way.

# asp.net-mvc - 在 ASP.NET MVC Html.ActionLink 中包含锚标记

> ID：274586
> 
> 赞同：154
> 
> 时间：2008-11-08T10:10:20.007
> 
> 标签：asp.net-mvc

在 ASP.NET MVC 中，我试图创建一个包含锚标记的链接（即，将用户定向到页面和页面的特定部分）。

我尝试创建的 URL 应如下所示：

```
<a href="/category/subcategory/1#section12">Title for a section on the page</a> 
```

我的路由是按照标准设置的：

```
routes.MapRoute("Default", "{controller}/{action}/{categoryid}"); 
```

我使用的操作链接语法是：

```
<%foreach (Category parent in ViewData.Model) { %>
<h3><%=parent.Name %></h3>
<ul>
<%foreach (Category child in parent.SubCategories) { %>
    <li><%=Html.ActionLink<CategoryController>(x => x.Subcategory(parent.ID), child.Name) %></li>
<%} %>
</ul>
<%} %> 
```

我的控制器方法如下：

```
public ActionResult Subcategory(int categoryID)
{
   //return itemList

   return View(itemList);
} 
```

上面正确返回一个 URL 如下：

```
<a href="/category/subcategory/1">Title for a section on the page</a> 
```

我不知道如何添加**#section12**部分。“section”这个词只是我用来分解页面部分的约定，12是子类别的ID，即child.ID。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：285
> 
> 时间：2008-11-09T01:53:43.910

有带有**片段**参数的 ActionLink 重载。将“section12”作为您的片段传递将使您获得您所追求的行为。

例如，调用[LinkExtensions.ActionLink 方法 (HtmlHelper, String, String, String, String, String, String, Object, Object)](http://msdn.microsoft.com/en-us/library/dd460522.aspx)：

```
<%= Html.ActionLink("Link Text", "Action", "Controller", null, null, "section12-the-anchor", new { categoryid = "blah"}, null) %> 
```

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2008-11-08T11:30:59.580

我可能会手动构建链接，如下所示：

```
<a href="<%=Url.Action("Subcategory", "Category", new { categoryID = parent.ID }) %>#section12">link text</a> 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-09-28T18:52:33.123

我不记得在哪个版本的 ASP.NET MVC（我相信是 ASP.NET MVC 3+）/ Razor 中引入了参数标签声明或任何所谓的（参数：x）功能，但对我来说，这绝对是正确的方法在 ASP.NET MVC 中建立一个带有锚点的链接。

```
@Html.ActionLink("Some link text", "MyAction", "MyController", protocol: null, hostName: null, fragment: "MyAnchor", routeValues: null, htmlAttributes: null) 
```

甚至来自[这个答案](https://stackoverflow.com/a/274637/687549)的 Ed Blackburns 反模式论点也无法与之抗衡。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-06-18T08:26:06.537

我只是这样做：

```
<a href="@Url.Action("Index","Home")#features">Features</a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-02T12:28:16.770

这是现实生活中的例子

```
@Html.Grid(Model).Columns(columns =>
    {
           columns.Add()
                   .Encoded(false)
                   .Sanitized(false)
                   .SetWidth(10)
                   .Titled(string.Empty)
                   .RenderValueAs(x => @Html.ActionLink("Edit", "UserDetails", "Membership", null, null, "discount", new { @id = @x.Id }, new { @target = "_blank" }));

  }).WithPaging(200).EmptyText("There Are No Items To Display") 
```

并且目标页面有TABS

```
<ul id="myTab" class="nav nav-tabs" role="tablist">

        <li class="active"><a href="#discount" role="tab" data-toggle="tab">Discount</a></li>
    </ul> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-19T11:02:20.827

如果您将 ActionFilter 应用于 Subcategory 操作方法，我的解决方案将起作用，只要您始终希望将用户重定向到同一个书签：

[http://spikehd.blogspot.com/2012/01/mvc3-redirect-action-to-html-bookmark.html](http://spikehd.blogspot.com/2012/01/mvc3-redirect-action-to-html-bookmark.html)

它修改 HTML 缓冲区并输出一小段 javascript 来指示浏览器附加书签。

当然，您可以修改 javascript 以手动滚动，而不是在 URL 中使用书签！

希望能帮助到你 ：）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-12T10:11:30.920

我这样做了，它适用于重定向到我认为的其他视图如果你在它之后添加#sectionLink它将起作用

```
<a class="btn yellow" href="/users/Create/@Model.Id" target="_blank">
                                        Add As User
                                    </a> 
```

# flash - 在 Flash 中使用双向 localConnection 可能会导致连接错误？

> ID：274599
> 
> 赞同：1
> 
> 时间：2008-11-08T10:21:26.567
> 
> 标签：flash, actionscript, localconnection

我正在尝试在同一网页上的两个 Flash 对象之间设置双向 localConnection (LC)。一个对象是 AS2，另一个是 AS3。

1.  我使用一个 LC 对象在每个 swf 上发送和接收数据。（这应该没关系，对吧？我尝试使用两个对象，一个用于发送，一个用于接收，但遇到了同样的问题）。

他们 .connect() 正确，以便他们都听。但是当我尝试将数据从 AS2 SWF 发送到 AS3 LC 时出现错误。这发生在 95% 的时间，但有时它确实有效，所以我知道 LC 名称不是问题（我检查过，显然）

有时一两条消息通过，随后的消息失败。

关于可能导致它的任何想法？

我的目标是创建一个多对一的连接映射，以便许多 AS2 swf 可以连接到一个 AS3 swf。这会是个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T03:26:15.750

一个可能的原因是我注意到同一个 LC 名称的多个侦听器似乎不起作用。要了解我的意思，请在两个不同的选项卡上打开[此页面](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_16243)，您应该会看到两个“发送”SWF 都有效，但仅在您打开的第一个选项卡上接收到消息。我猜您只使用了两个 SWF，但如果它们都尝试收听相同的 LC 名称，您可能会看到类似的东西？

此外，我相信 LC 在某种程度上禁用了隐藏页面元素内的 SWF，甚至可能只是在屏幕外。你在做这样的事吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T12:55:59.000

您不会碰巧有两个不同的浏览器打开同一个页面吗？LocalConnection 将跨浏览器连接，这可能会导致该问题。

通常我确保 LC 名称唯一的方法是在服务器上生成一个随机的 LC 名称，然后使用 FlashVars 将该 LC 名称传递给两个 swf。

它也可能与 swf 的加载顺序有关。可能是在创建连接的 swf 尝试连接后，正在加载侦听连接的 swf。然后，在另外 5% 的时间里，swf 的加载顺序正确。也许如果发生错误，只需尝试再次连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T00:51:41.397

我终于弄清楚是什么导致了问题。

似乎虽然在 AS3 中您可以使用相同的 LC 对象来发送和接收事件，但在 AS2 中这样做会在一段时间后给您错误（可能是在接收后尝试发送时）。

# clr - 如何列出所有正在运行的 CLR 实例

> ID：274603
> 
> 赞同：2
> 
> 时间：2008-11-08T10:34:00.427
> 
> 标签：clr

只是忘记了我曾经在 DOS Prompt 上执行的命令，以列出机器上所有正在运行的 CLR 实例。有人记得吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T22:18:21.393

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T10:58:56.803

我知道了 - 它是任务列表 /m mscor*

# c# - 调试 NUnit 测试的最佳方法是什么？

> ID：274619
> 
> 赞同：12
> 
> 时间：2008-11-08T10:59:01.547
> 
> 标签：c#, visual-studio-2008, nunit

我的平台：Visual C# 2008 Express Edition with NUnit 2.2.7

我有一个解决方案，我的代码在一个项目中，我的 NUnit 单元测试在同一个解决方案的不同项目中。

我一直在努力调试和单步执行 NUnit 测试。我在网上找到了一些参考资料，建议调用以下内容：

```
NUnit.ConsoleRunner.Runner.Main(args); 
```

但这甚至没有编译 - 它有编译器错误：

> 错误 1 ​​命名空间“NUnit.ConsoleRunner”中不存在类型或命名空间名称“Runner”（您是否缺少程序集引用？）

我已经添加了我能找到的所有程序集引用，但没有任何效果。

最后，这是我一起破解的，它有效，但也许你的好读者可以提出更好的解决方案：

1）在我的测试项目中，我要调试的一个测试用例的类名是MyTestClass。它有一个名为 Init() 的 [TestFixtureSetUp] 方法，实际的测试用例在 [Test] 函数 MyTest()

2) 在我的代码项目中，我有一个控制台程序 TestProgram.cs，它可以编译为 EXE。

在 TestProgram.cs 中，我通过以下方式调用测试用例

```
// First instantiate the test class
MyTestClass tc = new MyTestClass();

// Call the TestFixtureSetup method
tc.Init();

// Now call the actual test
tc.MyTest(); 
```

这可行，我可以调试并单步执行测试用例。

如果有人对使用 Visual Studio 2008 Express 有任何更好的建议*而无需支付额外的插件*，我很感激您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T13:18:26.837

乔恩是一种好方法，但不是更自动的方法；）

这是我[在 SO 上已经说过的话](https://stackoverflow.com/questions/247900/is-there-a-free-visual-studio-addin-for-nunit#247920)：

您可以创建一个空白项目（例如选择控制台应用程序），然后在项目的属性中选择 DEBUG 标签并选择`Start External Program`. 把Nunit的路径。然后，在开始选项中，命令行参数选择包含所有测试的 DLL（我的总是在 nunit\bin...）。比选择`Enable unmanaged code debugging`，您将能够在 VS 中启动项目，甚至可以逐步使用调试器。

这样，您不需要每次都执行宏或任何操作，它只是一个普通的 F5 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-08T21:17:44.177

看看[http://nunit.com/blogs/?p=28](http://nunit.com/blogs/?p=28)

这是一种享受。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T11:13:39.847

由于您使用的是 Visual Studio 的 Express 版本，因此您不能使用免费的 TestDriven.NET 插件。这很不幸，因为这确实是我用来调试单元测试的最佳工具。

该类`Runner`可以在*nunit-console-runner.dll*程序集中找到，因此请务必添加对它的引用。我不确定它有什么你的简单入口点没有的东西，但最好使用它来保证安全和未来的兼容性。

另一个值得一提的（脏）选项是让您的单元测试调用`Debugger.Attach()`. 我没有尝试过快速安装，但是当你的单元测试运行时，你应该被提示附加一个调试器。然后，您可以选择现有的 VS 实例并使用它进行调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-08T21:22:04.697

如果您安装了 ReSharper，它应该能够检测到您的 [Test] 夹具并在每个要运行的方法的左侧放置一个图标，并在每个测试夹具的左侧放置一个图标以运行所有。我更喜欢这种方式。

大多数工作人员也有TestDriven.NET，由于某种原因不在我的机器上，所以他们想知道发生了什么。这有点好笑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T11:07:39.923

在我的商店，我们的做法与您完全一样。不利的一面是，这意味着设置可能与 NUnit 不完全一样。从好的方面来说，它做起来很简单，并且允许创建一个最小的环境来重现错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T13:13:36.097

> 我在网上找到了一些建议调用以下内容的参考资料： `NUnit.ConsoleRunner.Runner.Main(args);` 但这甚至无法编译 - 它有编译器错误：

JFYI 您需要在 NUnit DLL 包中添加对**nunit-console-runner**程序集的 .NET DLL 引用（我有 2.2.4.0 ）似乎该类也已重命名，但如果您需要它就在那里。

```
NUnit.ConsoleRunner.ConsoleUi.Main(args); 
```

# c++ - 什么是对象切片？

> ID：274626
> 
> 赞同：837
> 
> 时间：2008-11-08T11:10:13.897
> 
> 标签：c++, inheritance, c++-faq, object-slicing

有人在 IRC 中将其称为切片问题。

* * *

## 回答 #1

> 赞同：680
> 
> 时间：2008-11-08T11:22:52.497

“切片”是将派生类的对象分配给基类的实例，从而丢失部分信息 - 其中一些信息被“切片”掉了。

例如，

```
class A {
   int foo;
};

class B : public A {
   int bar;
}; 
```

所以一个类型的对象`B`有两个数据成员，`foo`和`bar`。

那么如果你要写这个：

```
B b;

A a = b; 
```

然后`b`about member`bar`中的信息丢失在`a`.

* * *

## 回答 #2

> 赞同：579
> 
> 时间：2013-01-22T15:00:04.963

这里的大多数答案都无法解释切片的实际问题是什么。他们只解释了切片的良性案例，而不是危险的案例。假设，与其他答案一样，您正在处理两个类`A`和`B`，其中`B`（公开）派生自`A`。

在这种情况下，C++ 允许您传递`B`to `A`的赋值运算符（以及复制构造函数）的实例。这是有效的，因为可以将 的实例`B`转换为`const A&`，这是赋值运算符和复制构造函数所期望的参数。

### 良性案例

```
B b;
A a = b; 
```

那里没有什么不好的事情发生 - 你要求一个实例，`A`它是 的副本`B`，而这正是你得到的。当然，`a`不会包含一些`b`'s 成员，但是应该怎么做呢？`A`毕竟是a，不是a ，`B`所以连这些成员*都没听说过*，更别说能储存了。

### 诡计多端的案子

```
B b1;
B b2;
A& a_ref = b2;
a_ref = b1;
//b2 now contains a mixture of b1 and b2! 
```

你可能会认为那`b2`将是`b1`之后的副本。但是，唉，它**不是**！如果你检查它，你会发现这`b2`是一个科学怪人的生物，由一些块`b1`（`B`继承自的块`A`）和一些块`b2`（只`B`包含的块）组成。哎哟!

发生了什么？好吧，默认情况下 C++ 不会将赋值运算符视为`virtual`. 因此，该行将`a_ref = b1`调用 的赋值运算符`A`，而不是的赋值运算符`B`。这是因为，对于非虚拟函数，**声明**的（正式：*静态*）类型（即`A&`）确定调用哪个函数，而不是**实际**（正式：*动态*）类型（即`B`，因为`a_ref`引用 的实例`B`） . 现在，`A`的赋值运算符显然只知道在 中声明的成员`A`，因此它只会复制那些，而添加的成员`B`保持不变。

### 一个解法

只分配对象的一部分通常没有什么意义，但不幸的是，C++ 没有提供禁止这种情况的内置方法。但是，您可以自己滚动。第一步是使赋值运算符*virtual*。这将保证总是调用**实际**类型的赋值运算符，而不是**声明**的类型。第二步是用来`dynamic_cast`验证分配的对象是否具有兼容的类型。第三步是在（受保护的！）成员中进行实际分配`assign()`，因为`B`'s`assign()`可能想要使用`A`'s`assign()`来复制`A`'s, 成员。

```
class A {
public:
  virtual A& operator= (const A& a) {
    assign(a);
    return *this;
  }

protected:
  void assign(const A& a) {
    // copy members of A from a to this
  }
};

class B : public A {
public:
  virtual B& operator= (const A& a) {
    if (const B* b = dynamic_cast<const B*>(&a))
      assign(*b);
    else
      throw bad_assignment();
    return *this;
  }

protected:
  void assign(const B& b) {
    A::assign(b); // Let A's assign() copy members of A from b to this
    // copy members of B from b to this
  }
}; 
```

请注意，为了纯粹的方便，`B`'s`operator=`协变地覆盖了返回类型，因为它**知道**它正在返回一个`B`.

* * *

## 回答 #3

> 赞同：167
> 
> 时间：2008-11-08T11:28:05.530

如果您有一个基类`A`和一个派生类`B`，那么您可以执行以下操作。

```
void wantAnA(A myA)
{
   // work with myA
}

B derived;
// work with the object "derived"
wantAnA(derived); 
```

现在该方法`wantAnA`需要一个`derived`. 但是，`derived`无法完全复制该对象，因为该类`B`可能会发明其基类中没有的其他成员变量`A`。

因此，要调用`wantAnA`，编译器将“切掉”派生类的所有附加成员。结果可能是您不想创建的对象，因为

*   可能不完整，
*   它的行为就像一个`A`-object （类的所有特殊行为`B`都丢失了）。

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2014-08-22T18:33:09.370

这些都是很好的答案。我想在按值与按引用传递对象时添加一个执行示例：

```
#include <iostream>

using namespace std;

// Base class
class A {
public:
    A() {}
    A(const A& a) {
        cout << "'A' copy constructor" << endl;
    }
    virtual void run() const { cout << "I am an 'A'" << endl; }
};

// Derived class
class B: public A {
public:
    B():A() {}
    B(const B& a):A(a) {
        cout << "'B' copy constructor" << endl;
    }
    virtual void run() const { cout << "I am a 'B'" << endl; }
};

void g(const A & a) {
    a.run();
}

void h(const A a) {
    a.run();
}

int main() {
    cout << "Call by reference" << endl;
    g(B());
    cout << endl << "Call by copy" << endl;
    h(B());
} 
```

输出是：

```
Call by reference
I am a 'B'

Call by copy
'A' copy constructor
I am an 'A' 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-11-08T11:14:52.170

谷歌中“C++ 切片”的第三场比赛给了我这篇维基百科文章[http://en.wikipedia.org/wiki/Object_slicing](http://en.wikipedia.org/wiki/Object_slicing)和这个（激烈，但前几篇文章定义了问题）：[http ://bytes.com/论坛/thread163565.html](http://bytes.com/forum/thread163565.html)

因此，当您将子类的对象分配给超类时。超类对子类中的附加信息一无所知，并且没有空间存储它，因此附加信息被“切掉”。

如果这些链接没有为“好的答案”提供足够的信息，请编辑您的问题，让我们知道您还在寻找什么。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-11-08T11:56:54.410

切片问题很严重，因为它会导致内存损坏，并且很难保证程序不会受到影响。为了在语言之外设计它，支持继承的类应该只能通过引用访问（而不是通过值）。D 编程语言具有此属性。

考虑 A 类和从 A 派生的 B 类。如果 A 部分具有指针 p，并且 B 实例将 p 指向 B 的附加数据，则可能发生内存损坏。然后，当附加数据被切掉时， p 指向垃圾。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2018-03-07T09:35:58.140

在 C++ 中，派生类对象可以分配给基类对象，但其他方式是不可能的。

```
class Base { int x, y; };

class Derived : public Base { int z, w; };

int main() 
{
    Derived d;
    Base b = d; // Object Slicing,  z and w of d are sliced off
} 
```

当派生类对象分配给基类对象时，会发生对象切片，派生类对象的附加属性被切掉以形成基类对象。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-09-12T11:27:28.147

当数据成员被切片时发生对象切片时，我看到所有提到的答案。这里我举一个例子，这些方法没有被覆盖：

```
class A{
public:
    virtual void Say(){
        std::cout<<"I am A"<<std::endl;
    }
};

class B: public A{
public:
    void Say() override{
        std::cout<<"I am B"<<std::endl;
    }
};

int main(){
   B b;
   A a1;
   A a2=b;

   b.Say(); // I am B
   a1.Say(); // I am A
   a2.Say(); // I am A   why???
} 
```

B（对象 b）派生自 A（对象 a1 和 a2）。b 和 a1，如我们所料，调用它们的成员函数。但是从多态性的角度来看，我们不期望由 b 分配的 a2 不会被覆盖。基本上，a2 只保存 b 的 A 类部分，即 C++ 中的对象切片。

为了解决这个问题，应该使用引用或指针

```
 A& a2=b;
 a2.Say(); // I am B 
```

或者

```
A* a2 = &b;
a2->Say(); // I am B 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-11-08T17:38:54.750

那么......为什么丢失派生信息不好？...因为派生类的作者可能已经更改了表示，因此切掉额外信息会更改对象所表示的值。如果派生类用于缓存对某些操作更有效的表示，但转换回基本表示的成本很高，则可能会发生这种情况。

还认为有人还应该提到你应该做些什么来避免切片......获取一份 C++ 编码标准、101 条规则指南和最佳实践的副本。处理切片是#54。

它提出了一个稍微复杂的模式来完全处理这个问题：有一个受保护的复制构造函数、一个受保护的纯虚拟 DoClone 和一个带有断言的公共克隆，它会告诉你（进一步的）派生类是否无法正确实现 DoClone。（Clone 方法对多态对象进行适当的深拷贝。）

您还可以在基显式上标记复制构造函数，如果需要，它允许显式切片。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-11-09T00:31:36.523

C++ 中的切片问题源于其对象的值语义，这主要是由于与 C 结构的兼容性。您需要使用显式引用或指针语法来实现在大多数其他处理对象的语言中发现的“正常”对象行为，即对象总是通过引用传递。

*简短的回答是，您通过按 value*将派生对象分配给基础对象来对对象进行切片，即剩余对象只是派生对象的一部分。为了保留值语义，切片是一种合理的行为，并且使用相对较少，这在大多数其他语言中是不存在的。有些人认为它是 C++ 的一个特性，而许多人认为它是 C++ 的怪癖/错误之一。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-01-28T18:00:11.983

**一、切片问题的定义**

如果 D 是基类 B 的派生类，则可以将 Derived 类型的对象分配给 Base 类型的变量（或参数）。

*例子*

```
class Pet
{
 public:
    string name;
};
class Dog : public Pet
{
public:
    string breed;
};

int main()
{   
    Dog dog;
    Pet pet;

    dog.name = "Tommy";
    dog.breed = "Kangal Dog";
    pet = dog;
    cout << pet.breed; //ERROR 
```

尽管上述赋值是允许的，但赋值给变量 pet 的值会丢失其品种字段。这称为**切片问题**。

**2.如何解决切片问题**

为了解决这个问题，我们使用指向动态变量的指针。

*例子*

```
Pet *ptrP;
Dog *ptrD;
ptrD = new Dog;         
ptrD->name = "Tommy";
ptrD->breed = "Kangal Dog";
ptrP = ptrD;
cout << ((Dog *)ptrP)->breed; 
```

在这种情况下，ptrD（后代类对象）指向的动态变量的任何数据成员或成员函数都不会丢失。另外，如果需要使用函数，函数必须是虚函数。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-07-24T19:45:41.790

在我看来，除了您自己的类和程序的架构/设计不佳之外，切片并不是什么大问题。

如果我将一个子类对象作为参数传递给一个方法，该方法接受一个超类类型的参数，我当然应该意识到这一点并且在内部知道，被调用的方法将只与超类（又名基类）对象一起使用。

在我看来，只有不合理的期望是，在请求基类的地方提供子类，会以某种方式导致子类特定的结果，会导致切片成为问题。它要么是使用该方法的糟糕设计，要么是糟糕的子类实现。我猜它通常是牺牲良好的 OOP 设计以换取权宜之计或性能提升的结果。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-10-18T03:22:56.423

好的，在阅读了许多解释对象切片的帖子后，我会尝试一下，但不知道它是如何成为问题的。

可能导致内存损坏的恶性场景如下：

*   类在多态基类上提供（偶然地，可能是编译器生成的）赋值。
*   客户端复制和切片派生类的实例。
*   客户端调用访问切片状态的虚拟成员函数。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-03-12T18:08:10.250

切片意味着当子类的对象通过值或从期望基类对象的函数传递或返回时，子类添加的数据将被丢弃。

**说明：** 考虑以下类声明：

```
 class baseclass
          {
                 ...
                 baseclass & operator =(const baseclass&);
                 baseclass(const baseclass&);
          }
          void function( )
          {
                baseclass obj1=m;
                obj1=m;
          } 
```

由于基类复制函数对派生一无所知，因此只复制派生的基础部分。这通常称为切片。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-11-29T12:32:58.673

```
class A 
{ 
    int x; 
};  

class B 
{ 
    B( ) : x(1), c('a') { } 
    int x; 
    char c; 
};  

int main( ) 
{ 
    A a; 
    B b; 
    a = b;     // b.c == 'a' is "sliced" off
    return 0; 
} 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2016-05-11T07:39:54.693

当派生类对象分配给基类对象时，派生类对象的附加属性会从基类对象中切掉（丢弃）。

```
class Base { 
int x;
 };

class Derived : public Base { 
 int z; 
 };

 int main() 
{
Derived d;
Base b = d; // Object Slicing,  z of d is sliced off
} 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2017-07-19T08:02:27.403

当派生类对象分配给基类对象时，派生类对象的所有成员都被复制到基类对象中，但基类中不存在的成员除外。这些成员被编译器切掉。这称为对象切片。

**这是一个例子：**

```
#include<bits/stdc++.h>
using namespace std;
class Base
{
    public:
        int a;
        int b;
        int c;
        Base()
        {
            a=10;
            b=20;
            c=30;
        }
};
class Derived : public Base
{
    public:
        int d;
        int e;
        Derived()
        {
            d=40;
            e=50;
        }
};
int main()
{
    Derived d;
    cout<<d.a<<"\n";
    cout<<d.b<<"\n";
    cout<<d.c<<"\n";
    cout<<d.d<<"\n";
    cout<<d.e<<"\n";

    Base b = d;
    cout<<b.a<<"\n";
    cout<<b.b<<"\n";
    cout<<b.c<<"\n";
    cout<<b.d<<"\n";
    cout<<b.e<<"\n";
    return 0;
} 
```

**它将生成：**

```
[Error] 'class Base' has no member named 'd'
[Error] 'class Base' has no member named 'e' 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2017-10-13T08:17:24.367

我刚刚遇到了切片问题并迅速降落在这里。所以让我把我的两分钱加到这个上面。

让我们举一个“生产代码”（或类似的东西）的例子：

* * *

假设我们有一些调度动作的东西。例如控制中心 UI。
此 UI 需要获取当前能够分派的事物的列表。所以我们定义了一个包含调度信息的类。让我们称之为`Action`。所以 an`Action`有一些成员变量。为简单起见，我们只有 2，即 a`std::string name`和 a `std::function<void()> f`。然后它有一个`void activate()`只执行`f`成员的。

所以 UI 得到了一个`std::vector<Action>`供应。想象一些功能，如：

```
void push_back(Action toAdd); 
```

* * *

现在我们已经确定了从 UI 的角度来看它的外观。到目前为止没有问题。但是其他一些在这个项目上工作的人突然决定在对象中有需要更多信息的特殊操作`Action`。因为什么原因。这也可以通过 lambda 捕获来解决。这个例子不是从代码中 1-1 取的。

所以这家伙派生出来`Action`添加他自己的味道。
他将他自制的课程的一个实例传递给了，`push_back`但随后程序出现了混乱。

所以发生了什么事？
您*可能*已经猜到了：对象已被切片。

来自实例的额外信息已经丢失，`f`现在容易出现未定义的行为。

* * *

我希望这个例子能为那些在谈论`A`s 和`B`s 以某种方式派生时无法真正想象事物的人带来启发。

# python - 默认 xampp-linux 安装中缺少 config_vars.mk

> ID：274638
> 
> 赞同：3
> 
> 时间：2008-11-08T11:31:32.590
> 
> 标签：python, apache, xampp, mod-wsgi

我在 Ubuntu 8.10 系统上提取了 xampp 包 xampp-linux-1.6.7 并按照 mod_wsgi 文档中的说明进行操作。我收到以下错误：

```
ravi@Ibex:~/mod_wsgi-2.3$ ./configure  --with-apxs=/opt/lampp/bin/apxs 
checking Apache version... cannot open /opt/lampp/build/config_vars.mk: No such file or directory at /opt/lampp/bin/apxs line 218.
cannot open /opt/lampp/build/config_vars.mk: No such file or directory at /opt/lampp/bin/apxs line 218.
./configure: line 1696: /: is a directory

checking for python... /usr/bin/python
cannot open /opt/lampp/build/config_vars.mk: No such file or directory at /opt/lampp/bin/apxs line 218.
configure: creating ./config.status
config.status: error: cannot find input file: Makefile.in 
```

我无法通过谷歌搜索有关在 xampp 上运行 mod_wsgi 的说明。请帮忙。

解决方案：解决方案隐藏在评论中。感谢[Martin v. Löwis](https://stackoverflow.com/users/33006/martin-v-l246wis)，我能够解决这个问题。当 apxs 抛出错误并抱怨缺少 config_vars.mk 时，这意味着缺少 Apache 的构建目录。Fox xampp 用户的解决方案是也下载 xampp-dev 并将其解压缩到相同的路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-26T08:10:54.893

当 apxs 抛出错误并抱怨缺少 config_vars.mk 时，这意味着缺少 Apache 的构建目录。Fox xampp 用户的解决方案是也下载 xampp-dev 并将其解压缩到相同的路径。

# firefox - 如何创建一个快速最小化的 Firefox 扩展？

> ID：274639
> 
> 赞同：19
> 
> 时间：2008-11-08T11:35:40.600
> 
> 标签：firefox, xul

开始开发 Firefox 扩展所需的最低基本设置是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-08T11:47:24.880

注意：为了防止破坏您的默认 Firefox 体验，请在新创建的一次性测试帐户上尝试以下提示。

第 1 步：创建一个新的 Firefox 配置文件。为此，您需要通过命令行选项调用 Profile Manager：

```
firefox.exe -profilemanager 
```

单击配置文件管理器的“创建配置文件”按钮，这将调用一个向导。为配置文件命名。使用“选择文件夹”按钮并将配置文件保存在适当命名的文件夹中。这个文件夹是我们要创建快速而肮脏的 Firefox 扩展的地方。

第 2 步：将目录更改为第 1 步中创建的配置文件文件夹中的“扩展”文件夹。现在我们需要为 Firefox 扩展提供一个全局唯一名称。类似电子邮件的名称就足够了。例如，OneMinuteFirefoxExtension@ec29.com 将是一个足够好的扩展名。在“扩展”文件夹下，创建一个文件夹，其名称为刚刚选择的唯一名称。

第 3 步：创建文件 chrome.manifest 和 install.rdf。您可以将示例复制粘贴到此处，并适当更改名称和描述。

chrome.manifest：

```
content 1mffext chrome/ 
```

并安装.rdf：

```
<?xml version="1.0"?>
<RDF:RDF xmlns:em="http://www.mozilla.org/2004/em-rdf#"
         xmlns:NC="http://home.netscape.com/NC-rdf#"
         xmlns:RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <RDF:Description RDF:about="rdf:#$Fsv+Z3"
                   em:id="{ec8030f7-c20a-464f-9b0e-13a3a9e97384}"
                   em:minVersion="2.0"
                   em:maxVersion="3.0.*" />
  <RDF:Description RDF:about="urn:mozilla:install-manifest"
                   em:id="1m-ff-ext@ec29.com"
                   em:type="2"
                   em:name="OneMinuteFirefoxExtension@ec29.com"
                   em:version="0.0.1"
                   em:description="One Minute FireFox extension"
                   em:creator="labsji "
                   em:homepageURL="http://labsji.wordpress.com">
    <em:contributor>Venkat83</em:contributor>
    <em:targetApplication RDF:resource="rdf:#$Fsv+Z3"/>
  </RDF:Description> 
```

第 4 步创建名为 chrome 的文件夹，并在该文件夹中创建一个名为 test.txt 的文本文件。文件夹中的文件可以通过 chrome://1mffext/content/test.txt 等 chrome url 访问

现在，最低限度的扩展已准备就绪。常规的 html/javascript 文件可用于创建所需的功能。

测试扩展：调用 Firefox 以使用上面创建的配置文件。

```
firefox.exe -profile <path of the newly created profile> -no-remote 
```

我创建了一个 googlecode 项目来共享按照上述步骤创建的结果代码。[Just a Minute Firefox Extension](http://code.google.com/p/jam-firefox-ext/)提供了代码和运行脚本

Sim-OnDemand-个人虚拟世界即服务的[启动器应用程序](http://code.google.com/p/simond/)是使用此方法打包和分发的应用程序的一个示例。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-21T20:53:14.393

第 1 步：使用[Add-on Builder](https://addons.mozilla.org/en-US/developers/tools/builder)生成所有必要的文件。

第 2 步：将下载的文件解压到您的开发区。

第 3 步：在您的配置文件的扩展文件夹中创建一个文本文件，根据下载的 install.rdf 文件中的 em:id 命名，将提取文件的完整路径放入其中，然后重新启动 Firefox（如果需要，删除文本文件以卸载） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T12:24:36.147

要使用不同的配置文件启动另一个 Firefox 实例，您可以使用以下命令：

```
firefox -P My_test_profile -no-remote 
```

这样，您可以运行 2 种不同的 firefox，并使用其中一种来测试扩展，而不会弄乱您经常使用的那种。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T12:44:53.393

有趣的信息。
现在回答这个问题，我想说：创建一个 Greasemonkey 脚本（或 Chickenfoot，或 iMacros 等）。
可能会受到更多限制（例如在更改 FF UI 时），但适合大多数需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T15:40:46.267

以下是为什么有人想要创建一个最小的 Firefox 扩展的原因。

1.  当您希望创建基于本地计算机（磁盘）驻留浏览器的应用程序时，如果应用程序被构造为扩展，则可以与文件系统进行交互以进行读写。
2.  无需担心 XmlHttpRequest 跨域问题的快速原型设计。当您作为普通应用程序运行时，每当尝试 XmlHttpRequest 时，用户都会受到弹出窗口的困扰。
3.  很多时候，安装扩展程序会引起很多焦虑，即“这会与我的其他自定义设置混淆吗？”。正在进行的扩展可以与配置文件一起分发，以便用户可以预览、测试它。无需担心会破坏默认的 Firefox 浏览体验。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-23T01:03:21.803

附加 SDK 使简单的附加开发变得更加容易。 [https://developer.mozilla.org/en-US/Add-ons/SDK](https://developer.mozilla.org/en-US/Add-ons/SDK)

Mac/Linux 的步骤：

*   从此页面下载并解压 zip：[https ://developer.mozilla.org/en-US/Add-ons/SDK/Tutorials/Installation](https://developer.mozilla.org/en-US/Add-ons/SDK/Tutorials/Installation)
*   在 add-on-sdk- *version*文件夹中，运行`source bin/activate`
*   `mkdir plugin_name`
*   `cd plugin_name`
*   编辑 lib/main.js 以包含您的代码。
*   `cfx init`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-08T11:50:38.697

我建议在 Firefox 的便携版上进行测试。

# c# - 用于在解决方案中快速搜索文件的 Visual Studio 插件

> ID：274645
> 
> 赞同：9
> 
> 时间：2008-11-08T11:44:42.500
> 
> 标签：c#, visual-studio, resources, solution-explorer

我想为 Visual Studio 编写一个加载项，为解决方案资源管理器提供即时搜索。因此，您按下一个组合键，当您首先键入一个包含解决方案资源管理器所有文件的列表时，会缩小范围。

但是如何使用 C# 访问解决方案资源管理器？有没有人有一些好的资源？

* * *

编辑：我编辑了标题，使其与内容更相关，因为你们发布的所有内容都已经制作了插件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T13:20:45.537

[Sonic File Finder](http://jens-schaller.de/sonictools/sonicfilefinder/index.htm)它是免费的

当您点击快捷方式时，您会看到一个带有自动完成功能的搜索框： [alt text http://jens-schaller.de/files/images/SonicFileFinder/sonicFileFinderToolWindow.png](http://jens-schaller.de/files/images/SonicFileFinder/sonicFileFinderToolWindow.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-17T22:48:53.183

Visual Studio 已经完全有能力做到这一点；只需将“Edit.GoToFindCombo”拖到工具栏上，如果它还没有的话。（如果是，请按 Ctrl+D 激活）并为所有以字母 's' 开头的文件键入“>of s”。

[![带有“打开”命令的 GoToFindCombo 示例](https://i.stack.imgur.com/nV3qg.png)](https://i.stack.imgur.com/nV3qg.png)
[（来源：[aaronlerch.com](http://www.aaronlerch.com/files/blog/TheTalentedMr.GoToFindCombo_F0A5/image_thumb_5.png)）]

GoToFindCombo 比这更强大，您可以为 Visual Studio 中的几乎每个命令设置别名 ">alias $aliasHere $SomeCommand"。例如，要为文件中的查找创建别名，请键入“>alias ff Edit.FindinFiles”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-08T13:05:45.597

为什么要重新发明轮子？DevExpress + Microsoft 联手在 PDC2008 上免费提供[CodeRush Express](http://devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)，如果我理解正确的话。

[![](https://lh4.ggpht.com/_nxgDpneh8yk/SSQl0PG3-zI/AAAAAAAAAX4/vd9o19FJNQ4/s800/JumpToFile_Ctrl_Alt_F.JPG)](http://picasaweb.google.com/lh/photo/aVLvpHBVEh2Dxis2SbwbNQ?authkey=By-dpK_Zc1Q)

AFAIR 我认为跳转到文件的魔术键组合是 Ctrl+Alt+F，它也可以匹配子字符串。我试过了，它对我有用。很漂亮。这是录音[的链接](http://channel9.msdn.com/pdc2008/TL46/)，以防我在实际击键时搞砸了……里面有一些非常好的提示。

**更新**：为那些没有时间的人写[了一篇博文。](http://madcoderspeak.blogspot.com/2008/11/ide-ninja-shortcuts-with-vs2008-and.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-17T14:41:25.690

DPack 确实击败了所有这些（而且它是免费的）。
查看 Alt+U 和 Alt+M 快捷键（我也推荐其他快捷键）。

此外，如果您想跳转到另一个文件中的特定点（类型成员）（真的非常快），我发现 StudioTools 具有非常令人印象深刻的 GoTo 功能。

注意：R# 也有这样的功能，但 IMO 它比 DPack 的版本弱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T17:59:52.963

不要忘记[Workspace Whiz](http://workspacewhiz.com/) - 它可免费用于非商业用途。我不能没有它，我只是买了一个许可证。它还做了很多其他的事情......

[![替代文字](https://i.stack.imgur.com/ZH1Kb.png)](https://i.stack.imgur.com/ZH1Kb.png)
[（来源：[workspacewhiz.com](http://workspacewhiz.com/FileOpen.png)）]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-15T07:06:18.287

没有什么比微软的生产力工具和它的免费。

[http://visualstudiogallery.msdn.microsoft.com/3a96a4dc-ba9c-4589-92c5-640e07332afd](http://visualstudiogallery.msdn.microsoft.com/3a96a4dc-ba9c-4589-92c5-640e07332afd)

# asp.net - ASP.NET [HttpException (0x80004005): 无法使用前导 .. 退出顶级目录。]

> ID：274646
> 
> 赞同：1
> 
> 时间：2008-11-08T11:45:00.580
> 
> 标签：asp.net

加载页面时出现以下错误。

[HttpException (0x80004005): 不能使用前导 .. 退出顶级目录。]

不知道该怎么办？谁能帮我 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T12:56:46.940

我猜你做过这样的事情：

```
Response.Redirect("../SomePage.aspx"); 
```

使用相对路径时，您只能导航到与发出请求的页面位于同一虚拟目录中的页面。您所做的是从位于虚拟目录树顶部的页面中调用它。所以你有一些选择：

1.  更正您的网址，使其不指向更高级别。即：删除`../`
2.  使用完整的网址。IE：`http://www.example.com/SomePage.aspx`
3.  使用 IIS 在更高级别设置虚拟目录。

对于选项 3：

1.  打开 IIS 管理器。
2.  转到页面所在的目录并右键单击/属性。
3.  在虚拟目录选项卡上选择删除。
4.  关闭对话框并在您想要成为根目录的目录上右键单击/属性。
5.  在虚拟目录选项卡上选择添加

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T14:20:12.303

很可能是 googlebot 或其他一些机器人正在扼杀您的网站。

[http://www.kowitz.net/archive/2006/12/11/asp.net-2.0-mozilla-browser-detection-hole.aspx](http://www.kowitz.net/archive/2006/12/11/asp.net-2.0-mozilla-browser-detection-hole.aspx)

[http://todotnet.com/post/2006/07/01/Get-GoogleBot-to-crash-your-NET-20-site.aspx](http://todotnet.com/post/2006/07/01/Get-GoogleBot-to-crash-your-NET-20-site.aspx)

解决方案是在您网站的 app_browser 文件夹中添加 .browser 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-02T18:07:17.250

我意识到这和罪一样古老，但对我来说，导致它的原因是我在数据库集中有一个带有 ../ 的图像的相对链接。当我的页面尝试在根目录中加载图像的 ImageUrl 时，它工作正常，但在子目录中它却出现了。

将其更改为 ~ 解决了问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T14:58:05.707

我可以通过在 web.config 中的 forms-tag 上设置 cookieless-attribute 来解决这个问题：

```
<authentication>
   <forms cookieless="UseCookies" />
</authentication> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T13:39:02.487

根据您的情况，这可能会或可能不会有帮助，但我上周遇到了这个错误。我的解决方案是更改 My Project 中的 Web 设置以使用本地 IIS 服务器而不是 Visual Studio Web 服务器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T22:09:06.253

抱歉，因为这已经很老了，但是我在 MVC3 应用程序上已经有几天这个问题了。我不断地进入我的 _Layout.cshtml 文件并删除对 css 文件或 javascript 的任何引用（我在这个应用程序中使用 JQuery）以找到可怕的 ../ 引用。我找不到一个。然后我试图通过将重定向放到我的应用程序的根目录中来绕过我的问题。那也失败了。YellowScreenOfDeath 上的堆栈轨迹给了我一个线索：

`[HttpException (0x80004005): Cannot use a leading .. to exit above the top directory.] System.Web.Util.UrlPath.ReduceVirtualPath(String path) +11496719 System.Web.Util.UrlPath.Reduce(String path) +171 System.Web.Configuration.**AuthenticationConfig**.GetCompleteLoginUrl(HttpContext context, String loginUrl) +218 System.Web.Security.FormsAuthenticationModule.OnEnter(Object source, EventArgs eventArgs) +156 System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +270`

最重要的是，我的 web.config 中有这个，带有“../”删除它或更改向上引用解决了我的问题。

```
 <authentication mode="Forms">
     <forms loginUrl="../home.aspx" timeout="2880" />
    </authentication> 
```

# c# - VSTO 问题 - 无法创建 Visual Studio excel 工作簿项目

> ID：274653
> 
> 赞同：2
> 
> 时间：2008-11-08T11:53:06.180
> 
> 标签：c#, visual-studio-2008, vsto, excel-2007

当我尝试在 Visual Studio 2008 中创建 Excel 2007 工作簿项目时，我收到以下错误消息：

> 无法创建项目，因为“Excel Visual Studio 设计时适配器加载项”工作不正常。Excel 可能已禁用加载项或使其处于非活动状态，或者您的信任中心设置中可能已禁用所有加载项。检查 Excel 选项中的加载项状态。如果加载项处于活动状态并已启用，请重新安装或修复 Visual Studio Tools for Office。

我已验证该加载项未处于非活动状态或已禁用，并且我已尝试多次修复和卸载/重新安装 VSTO。

该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T12:32:56.287

万一您还没有检查信任设置，这个[MSDN 页面](http://msdn.microsoft.com/en-us/library/bb386131.aspx)描述了如何检查。

我在 MSDN 论坛上遇到了这个问题：

> 要使修复工作，您必须使用管理员权限运行 VS 命令提示符（右键单击，以管理员身份运行）。然后运行这个命令行：
> 
> C:>AddinUtil -AddInRoot:"%CommonProgramFiles%\Microsoft Shared\VSTA\AppInfoDocument" -Rebuild
> 
> 如果它仍然不起作用，您可能还有一个损坏的管道存储，可以这样修复：
> 
> C:>AddinUtil -PipelineRoot:"%CommonProgramFiles%\Microsoft Shared\VSTA\Pipeline" -Rebuild
> 
> 您会从该命令收到一个警告，但这是意料之中的。

如果做不到这一点，我认为您将不得不对 Visual Studio 2008 安装进行修复（将安装 DVD 放入驱动器中，然后选择修复选项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-24T18:42:07.600

我会将 Excel 2003 设置为默认打开 XLS 文件。在我从“添加/删除程序”菜单修复 Office 2007 之前，我看到了与您相同的错误消息。

# linux - Building Subversion 1.5.4 on Debian: could not find library containing RSA_new

> ID：274656
> 
> 赞同：1
> 
> 时间：2008-11-08T12:03:23.930
> 
> 标签：linux, svn, version-control, debian

I've been trying to build subversion (on a limited account) for a long time but without any luck :(

The instructions I'm following: [http://wiki.dreamhost.com/Subversion_Installation](http://wiki.dreamhost.com/Subversion_Installation)

Running this:

```
./configure --prefix=${RUN} --without-berkeley-db --with-ssl --with-zlib --enable-shared 
```

Gives me this error:

```
checking for library containing RSA_new... not found
configure: error: could not find library containing RSA_new
configure failed for neon 
```

Can someone explain to me:

1.  Possible reasons for this
2.  Possible ways to circumvent it
3.  Optional: What these modules are and what their purpose is (Neon/RSA_new)

Thanks!

## Log file contents:

Trying to find interesting bits from the neon config.log file:

```
configure:27693: gcc -o conftest -g -O2   conftest.c  >&5
/tmp/ccazXdJz.o: In function `main':
/home/stpinst/soft/subversion-1.5.4/neon/conftest.c:93: undefined reference to `RSA_new'
collect2: ld returned 1 exit status
configure:27699: $? = 1
configure: failed program was:
...
| int
| main ()
| {
| RSA_new();
|   ;
|   return 0;
| }
configure:27742: gcc -o conftest -g -O2   conftest.c  -lcrypto  -lz >&5
/usr/bin/ld: cannot find -lcrypto
collect2: ld returned 1 exit status
configure:27748: $? = 1 
```

--

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-08T12:21:30.227

1.  you don't have libcrypto.a and libcrypto.so on your system
2.  you need to install install libcrypto, which is in the libssl-dev package (`aptitude install libssl-dev`)
3.  Neon is the WebDAV library included in subversion; WebDAV being one of the wire protocols that subversion supports (http:). RSA is an encryption algorithm. Neon doesn't actually need it itself - it's just that configure uses it to determine whether libcrypto is available.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-11T19:42:34.563

Finally got it to work. How: download openssl-0.x.x.tar.gz, unpack, cd into it

install it somewhere, like (for me)

```
$ ./config shared --prefix=$HOME/installs && make clean && make && make install

$  export CFLAGS= "-O2 -g -I/root/installs/include"
$  export CFLAGS="-O2 -g -I/root/installs/include"
$  export LDFLAGS="-L/root/installs/lib"
$  export CPP="gcc -E -I/root/installs/include" 
```

unpack the subversion + its deps

go into the neon subdirectory

```
$ ./configure --with-ssl=openssl --prefix=$HOME/installs && make clean && make && make install 
```

delete the neon directory

go into the subversion directory

```
$ ./configure --with-ssl --prefix=$HOME/installs --with-neon=/root/installs/bin/neon-config && make clean && make && make install 
```

Note: you might be able to get away without all the exports by using --with-ssl=/root/installs or something along those lines.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T16:29:55.560

You either need to install OpenSSL first, or configure --without-ssl (or just omit the --with-ssl option if you have been following the instructions literally).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T04:45:22.177

Check out my response over [here](https://stackoverflow.com/questions/189906/upgrade-subversion-143-to-152-on-debian-hosted-account#330061).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T12:26:30.403

did you check [Compiling Subversion with SSL Support](http://blogs.oracle.com/rama/entry/compiling_subversion_with_ssl_support), where the following varaibles were needed to complete the process ?

```
setenv CC "gcc -I/usr/local/ssl/include -L/usr/local/ssl/lib"
setenv CFLAGS "-O2 -g -I/usr/local/ssl/include"
setenv LDFLAGS "-L/usr/local/ssl/lib"
setenv CPP "gcc -E -I/usr/local/ssl/include" 
```

And the post [could not find library containing RSA_new](http://svn.haxx.se/users/archive-2006-05/0483.shtml), recommend to made sure the headers were also installed on the system (Debian-Ubuntu-Dapper-Beta2: "apt-get install libssl-dev"), or as [Martin says](https://stackoverflow.com/questions/274656/building-subversion-154-on-debian-could-not-find-library-containing-rsanew#274661): aptitude install libssl-dev.

In short, either the headers are not there, or they are not in the proper path during the configure process.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T16:56:34.633

If I skip the SSL:

```
./configure --prefix=${RUN} --without-ssl 
```

I get this error:

```
checking for openssl/opensslv.h... no
configure: error: We require OpenSSL; try --with-openssl
configure failed for serf 
```

If i do:

```
 ./configure --prefix=${RUN} --with-openssl 
```

I get a warning:

```
configure: WARNING: Unrecognized options: --with-openssl
...
configure: error: '--with-openssl requires a path to a directory'
configure failed for serf 
```

:-s

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T16:20:42.753

NB: I'm using a **shared host** so I'm not able to do some things.

Calling

```
apt-get install libssl-dev 
```

gives me this error:

```
E: Could not open lock file /var/lib/dpkg/lock - open (13 Permission denied)
E: Unable to lock the administration directory (/var/lib/dpkg/), are you root? 
```

Calling aptitude install libssl-dev

gives me this error:

```
E: Could not open lock file /var/lib/dpkg/lock - open (13 Permission denied) 
E: Unable to lock the administration directory (/var/lib/dpkg/), are you root 
```

As you can perhaps see, I'm totally lost so any further hand-holding would be greatly appreciated! :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-08T22:18:54.060

I think I've finally got the "configure" part to work.

First, I retrieved openssl locally:

```
wget http://www.openssl.org/source/openssl-0.9.8a.tar.gz
tar zxvf openssl-0.9.8a.tar.gz
cd openssl-0.9.8a
./configure --prefix=${RUN}
make
make install 
```

Then I built subversion with a reference to that folder:

```
./configure --prefix=${RUN} --without-berkeley-db --with-openssl=$HOME/soft/openssl-0.9.8a 
```

I actually got this warning:

```
configure: WARNING: Unrecognized options: --with-openssl 
```

Now that I though I had it all covered, it compiles for a few minutes but then gives me this error:

```
link: warning: `/usr/lib/gcc/x86_64-linux-gnu/4.1.2/../../..//libsqlite                                                                        3.la' seems to be moved
libtool: link: warning: `/usr/lib/gcc/x86_64-linux-gnu/4.1.2/../../..//libsqlite                                                                        .la' seems to be moved
libtool: link: warning: `/usr/lib/gcc/x86_64-linux-gnu/4.1.2/../../..//libexpat.                                                                        la' seems to be moved
/usr/bin/ld: cannot find -lssl
collect2: ld returned 1 exit status
make[1]: *** [libserf-0.la] Error 1
make[1]: Leaving directory `/mnt/local/home/stpinst/soft/subversion-1.5.4/serf'
make: *** [external-all] Error 1 
```

This seems to be the neverending story... can I somewhere just download the latest binaries?

# testing - 你有任何 SQL 注入测试“Ammo”吗？

> ID：274659
> 
> 赞同：17
> 
> 时间：2008-11-08T12:09:33.697
> 
> 标签：testing, xss, sql-injection

在阅读 SQL 注入和 XSS 时，我想知道你们是否有一个字符串可以用来识别这些漏洞和其他漏洞。

一个字符串，可以被扔到网站数据库中以黑盒检查该字段是否安全。（将对一些内部工具进行大型测试）

粗略的例子，想知道你们是否知道更多？

“一个”或“1”=“1”

"center'> <脚本>alert('test')</script>"

编辑：在 SO 上找到了一个不错的[XSS 问题](https://stackoverflow.com/questions/255723/xss-torture-test-does-it-exist)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-08T12:26:58.250

我发现了一些不错的 Firefox 插件可以解决问题。

[跨站脚本我](https://addons.mozilla.org/en-US/firefox/addon/7598)

[SQL 注入我](https://addons.mozilla.org/en-US/firefox/addon/7597)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T14:10:31.363

[https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)有很多用于测试 SQL 注入的示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T12:32:01.780

[http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/](http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/)

包括大多数数据库的版本，包括绕过标准转义的十六进制技巧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T14:25:09.243

老实说，有一些工具可以很好地测试 SQL 注入，但老实说，它们并不能完全替代手动测试和代码审查。

要使用您的示例，在某些情况下“或（1 = 1）”不起作用，但“或/** /（1 = 1）；--”起作用。

有时调整某些字符串会提供不同的结果，这取决于字符编码和一般创造力等因素。还值得一提的是，有时您的 Web 应用程序中的 3rd 方工具也不安全。永远不要低估人们的创造力，特别是如果你有一个公共网站。

这是一个很好的[备忘](http://ferruh.mavituna.com/sql-injection-cheatsheet-oku/)单。

为了进行测试，我使用[Paros](http://www.parosproxy.org/index.shtml)，它有一个有趣的网站扫描工具，你也可以运行它来发现一些问题。

这个问题重复了这个[SQL 注入](http://xkcd.com/327/)漫画。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T13:11:42.620

有关示例，请参见[OWASP](http://www.owasp.org/index.php/Main_Page)站点。

# status-message - 如何以编程方式设置 Live Messenger 的状态消息？

> ID：274668
> 
> 赞同：2
> 
> 时间：2008-11-08T12:28:24.830
> 
> 标签：status-message

我希望能够更改 Live Messenger 的状态消息，但我发现的所有内容仅适用于音乐消息（请参阅[此屏幕截图](http://coldacid.net/images/screenshots/live-messenger-status-and-music-messages)以了解两者之间的区别）。

可以这样做，因为有些程序可以更改它，Live Messenger 的一些备用客户端也可以自己设置状态消息。我只需要自己知道如何做到这一点。

**澄清：**该解决方案需要使用最新版本的 Live Messenger（即 wave 3 beta）。使用旧版本也很好，但我正在使用的是 14.x 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T12:43:21.430

当然，在任何对话窗口中，一个简单的“ `/psm new message`”都会更新消息状态字段。

但*以编程方式*：

您将在此处找到一个[VB 源文件](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=71057&lngWId=1)，该文件向您的 Live Messenger 窗口的 PSM（个人状态消息）发送了一条新消息。可能会有所帮助。

提炼：

```
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long
Private Declare Function PostMessage Lib "user32" Alias "PostMessageA" (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long
Private Const WM_COMMAND = &H111
Private Const WM_CHAR = &H102
Private Const VK_RETURN = &HD

Private Function SetPSM(ByVal text As String) As Boolean
   Dim hParentWnd, hChildWnd As Long
   SetPSM = False
   hParentWnd = FindWindow("MSBLWindowClass", vbNullString)
   If hParentWnd <> 0 Then
      hChildWnd = FindWindowEx(hParentWnd, 0, "DirectUIHWND", vbNullString)
      If hChildWnd <> 0 Then
         PostMessage hParentWnd, WM_COMMAND, 56606, 0
         Dim i As Integer
         For i = 1 To Len(text)
            Call PostMessage(hChildWnd, WM_CHAR, Asc(Mid$(text, i, 1)), 0)
         Next i
         PostMessage hChildWnd, WM_CHAR, VK_RETURN, 0
         SetPSM = True
      End If
   End If
End Function

Private Sub cmdSetPSM_Click()
   SetPSM txtPSM.text
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T14:19:34.607

您可以通过您的 MSN [MsgPlus](http://www.msgplus.net/)进行安装，这将为您提供一个 API 以通过 MSN 进行编程。然后，您可以创建一个脚本来调用您的程序或调用 MSN 的程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T23:08:43.290

没有编程方式来设置适用于包括 Live Wave 3 在内的版本的 Live Messenger 状态消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-23T16:34:45.850

克里斯，如何以编程方式设置音乐信息？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T09:40:42.623

您可能会使用 Windows API 函数来模拟用户输入。

# c# - 如何注入不断变化的依赖项

> ID：274685
> 
> 赞同：1
> 
> 时间：2008-11-08T12:52:41.333
> 
> 标签：c#, dependency-injection, ioc-container

我是依赖注入的新手，我想知道您将如何处理以下情况。我们有如下内容：

```
public class DatabaseContext
{
  public string ConnectionString {get;}
}

public interface IDataAccess
{
  string GetString(int id);
}

public class DataAccessImpl : IDataAccess
{
  private DatabaseContext _context;
  public DataAccessImpl(DatabaseContext context)
  {
    this._context=context;
  }

  public string GetString(int id)
  {
    return "some data";
  }
} 
```

对于 Web 应用程序，每个请求都可以构建不同的 DatabaseContext 以指向不同的数据库。对于 windows 窗体，我们可以更改当前的 DatabaseContext。di 框架如何处理可以更改的依赖项？这样当我请求 IDataAccess 时，它总是具有适当的/当前的 DatabaseContext。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T13:51:11.247

我采用的方法不是注入 DataContext 而是注入 DataContext 工厂，这是一个具有返回适当类型的 DataContext 的方法的类。我有两个构造函数，在我的例子中，一个控制器类是默认构造函数，另一个是使用工厂（和其他注入对象）。默认构造函数只是简单地调用带有参数的构造函数，并且所有参数都为空。如果相应的参数为空，则参数化构造函数会创建默认类型的对象。

使用工厂允许我的控制器操作在调用时创建一个新的 DataContext，而不是在应用程序的整个生命周期中都存在一个 DataContext。可以构建工厂以返回现有上下文（如果可用）并根据需要创建新上下文，但我更喜欢将它们限定为工作单元。

PS 工厂实际上产生了一个围绕 DataContext 的包装类，而不是实际的 DataContext，作为接口（IDataContextWrapper）。这使得从我的控制器测试中模拟实际数据库变得更加容易。以上所有都假设 LINQ/ASP.NET MVC，但我认为这些原则是普遍适用的。

# api - Yahoo! 是否有程序化接口？信使？

> ID：274687
> 
> 赞同：1
> 
> 时间：2008-11-08T12:54:26.383
> 
> 标签：api, yahoo

我们可以直接从我们的程序以编程方式使用我们的 ID 登录到 Yahoo 服务、发送即时消息、使用网络摄像头服务等等吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T14:56:22.583

由于您不太清楚要实现的目标，因此最有可能的两个答案是：

**您想编写某种形式的 IM 机器人。**为此，您需要雅虎通网络的 API，在这种情况下，最好的选择是[libpurple](http://developer.pidgin.im/wiki/WhatIsLibpurple)、[jYMSG](http://jymsg9.sourceforge.net/)或[libyahoo](http://libyahoo2.sourceforge.net/)。这将允许您登录，并向联系人发送/接收消息，理论上可以执行常规雅虎通客户端可以执行的任何操作。

您还可以使用 Yahoo Messenger 协议直接与 Yahoo 服务器通信，该协议未在此处正式记录，这是[此处](http://www.ycoderscookbook.com/)[的](http://www.venkydude.com/articles/yahoo.htm)一个很好的资源。这将是*很多*工作，您可能最好使用 libpurple 等。

 ***控制 Yahoo Messenger 客户端本身。**为此，您可能最好将您想做的任何事情写成一个插件，其中有[一个 API](http://developer.yahoo.com/messenger/)。

或者，在 OS X 上，您可以使用 AppleScript 来控制界面（通过脚本按钮按下/文本输入，如此[处](http://www.apple.com/applescript/uiscripting/)所述）。在 Windows 上，您可以使用[AutoHotkey](http://www.autohotkey.com/)来做类似的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T14:35:49.597

你可以看看[libpurple](http://developer.pidgin.im/wiki/WhatIsLibpurple)，虽然我不确定它的网络摄像头支持是什么样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-17T17:31:12.087

你可以使用这个：http: [//developer.yahoo.com/messenger/guide/chapterintrotomessengersdk.html](http://developer.yahoo.com/messenger/guide/chapterintrotomessengersdk.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T13:03:45.273

雅虎通有一个[插件 SDK](http://developer.yahoo.com/messenger/)。很难知道这是否满足您的需求，因为您不是很清楚。

例如，如果您希望通过 Java 访问 Yahoo Messenger 服务，您可以尝试使用[API](http://jymsg9.sourceforge.net/)。

# linux - 系统调用：UNIX、Linux、BSD 和 Solaris 变体

> ID：274700
> 
> 赞同：3
> 
> 时间：2008-11-08T13:13:10.403
> 
> 标签：linux, unix, solaris, bsd, system-calls

### 主要 *NIX 变体中的系统调用数量是否存在差异？

### 哪些系统调用将得到普遍支持？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-08T13:30:32.693

任何不是 posix 标准的东西都可能是额外的系统调用，或者可能是系统调用层之上的额外库功能。如果您的目标是编写可移植代码，请坚持使用 posix，并尽可能多地使用 c 库（而不是直接系统调用）。

如果您只是好奇，它们的差异很大。为了符合 posix 标准，您不需要以系统调用的方式支持太多。它指定了您需要支持的接口，但是您是通过调用内核还是跳转到共享库来实现这一点几乎取决于您。

Mac OS X 甚至不保证版本之间系统调用的二进制兼容性，他们认为它们是系统库和操作系统之间的私有接口。大多数人认为的系统调用实际上是调用内核的动态库中的小存根，如果您直接进行系统调用而不是链接到该动态库并调用存根函数，那么您的代码可能会在操作系统之间中断发布。

这种灵活性意味着许多操作系统实现的系统调用与它们支持 posix 所需的完全不同，然后处理它们库中的差异。例如，Linux 的线程实现基于一个名为 clone() 的系统调用，并且它们处理大部分簿记以使 pthreads 接口在它们的库中工作。

因此，如果您的目标是实现一个不与其他任何东西链接并在多个 unix 上工作的标准库，那么在某些情况下您可能会发现事情有点棘手。如果你的目标是编写一些链接到各种 Unix 上的标准库的东西，你可以获得一个普遍统一的接口。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T13:34:12.543

我能找到的最好的是[Unix-Linux-BSD Cheat-Sheets](http://www.scribd.com/doc/2345014/Unix-Linux-BSD-Cheat-Sheets-I)，用于各种系统调用变体，与[Solaris 系统调用](http://docs.oracle.com/cd/E19683-01/816-0212/6m6nd4n86/index.html "Solaris 9 手册页，第 2 节：系统调用")进行比较。

仅对于 Unix，系统调用的数量或多或少增加了四倍，具体取决于您所说的“系统调用”。
Advanced UNIX Programming 第一版只关注大约 70 个真正的内核系统调用——例如，open、read 和 write；但不是像 fopen、fread 和 fwrite 这样的库调用。
第二版包括大约 300 个。（总共有大约 1,100 个标准函数调用，但其中许多是标准 C 库的一部分，或者显然不是内核工具。）
今天的 UNIX 有线程、实时信号、异步 I/ O，以及新的进程间通信特性（POSIX IPC），这些特性在 20 年前都不存在

# terminology - “第二方开发者”这个词什么时候不再被用来指代用户了？

> ID：274708
> 
> 赞同：2
> 
> 时间：2008-11-08T13:19:10.437
> 
> 标签：terminology

我一直认为，当涉及到平台软件时，各方都是这样称呼的：

> 第一方：平台的所有者/创建者
> 
> 第二方：平台用户
> 
> 第三方：不是第一方的开发者。

现在第二方似乎被用来指代平台所有者/创建者拥有/签约的开发者。术语的这种变化是什么时候发生的，我们是否仅指“用户创建的软件”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T18:35:42.203

我认为这个概念可以追溯到商业安排。第一方和第二方是直接的生产者-购买者关系。第三方是第二方与之打交道的第一方以外的第三方。（注意语法人不太合适，但这是一个可爱的想法。如果第一方是客户，第二方是主要供应商，效果会更好。）

在这种情况下，说第二方开发者这个词可能太过分了。第二方可能是一个 IT 组织，并且必须执行许多活动来安装和使用第一方的产品和服务。它也可能将其中的很多内容外包给第三方。

或许关键在于第三方通常不属于第一方和第二方之间的（业务）关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T13:56:35.713

我同意，我一直认为这是标准英语语法的双关语或扩展：[第一人称](http://en.wikipedia.org/wiki/First-person_narrative)、第二人称和第三人称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-03T16:34:32.383

第一方开发商是硬件所有者、子部门或被硬件公司收购的公司。第二方开发者是受出版商委托根据概念制作游戏的公司，而第三方开发者是独立的，通过使用开发工具包和许可来开发游戏，并向硬件制造商支付费用。

# asp.net - 哪个平台允许更快速的开发，ASP.NET webforms 还是 MVC？

> ID：274709
> 
> 赞同：6
> 
> 时间：2008-11-08T13:19:52.543
> 
> 标签：asp.net, asp.net-mvc, webforms

使用 webforms 或 MVC 进行开发是否有明显的生产力提升？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-02-08T19:51:23.913

当您处理 ASP.NET MVC 与 ASP.NET Web 窗体的生产力时，请考虑这两个开发人员。

1.  **通用 .NET 开发人员**，具有编写 WinForms 和 WebForms 应用程序的丰富经验。
2.  **通用 Web 应用程序开发人员**，可以编写 C# 代码，但对 HTML、CSS 和 jQuery/MooTools/等非常了解。

**通用 .NET 开发人员**在原始**ASP.NET Web 窗体**中编写代码时效率最高。这是因为他们非常了解事件模型（因为它们反映在 WinForms 和 WebForms 之间），并且能够使用这种思维模型快速构建网站。

*   MVC 将有一个很大的学习曲线，因为它完全背离了他现有的*“Web 工作原理”*知识。这些是开发人员在使用 MVC 时会发现的绊脚石：
    *   必须学习 HTML 和 CSS 以了解正在发生的事情以及事物之间的交互方式。
    *   学习 javascript 以及如何为 ajax 回调服务器。
    *   弄清楚如何维护状态，找出 cookie 不安全并且该会话具有某些“陷阱”。

**通用 Web 应用程序开发人员**在**ASP.NET MVC**中效率最高，因为该框架反映了他们对 Web 应用程序的看法——没有事件、没有应用程序状态等。他们已经知道如何编写好的 HTML 并使用 CSS 设置样式，他们知道如何将 ajax 调用写回服务器。

*   对于这个开发人员来说，Web Forms 不是一个好的模型，因为它背离了他现有的*“Web 工作原理”*知识。这些是开发人员在使用 ASP.NET Web 窗体时会发现的绊脚石：
    *   必须花费时间来弄清楚页面生命周期是如何工作的。
    *   ViewState 会导致很多问题，导致页面膨胀。
    *   通常必须进行大量 HttpRequest 黑客攻击，以修复某些 WebForm 控件产生的所有错误代码。
    *   学习如何处理 AJAX 回调，而不是仅仅使用他们现有的关于如何从 jQuery 调用 URL 的知识。

我的主要观点是，不同的开发人员将根据他们以前的 Web 开发经验有不同的生产力水平。我个人更喜欢 ASP.NET MVC，我可以非常快速地构建一些东西并让它准确地输出我想要的东西。

我是第 2 类开发人员，我用 Ruby on Rails、Django、ASP.NET Web Forms 和 ASP.NET MVC 编写了 Web 应用程序（大部分都很小）。这 3 个框架之间的 Web 开发知识几乎可以互换（除了必须了解宿主语言 - ruby​​、python 和 c#）。

*我发现 ASP.NET Web Forms 最令人气愤的是，它试图为*开发人员做太多事情（例如应用程序状态、Web 事件等），代码输出通常不能很好地与 Web 标准配合使用，Web Forms 2.0 是直接绑定到 XHTML 1.0 过渡。与在 ASP.NET MVC 中编写相比，任何超出快速且脏的 DataGrid 和 Form 到数据库中的 CRUD 行的东西通常会导致更多的痛苦和痛苦。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T13:48:33.997

使用 MVC，您永远不会花时间试图弄清楚为什么 ItemDataBound 和 ItemCommand 没有在您期望的时候触发它们。

如果您认为这会节省您的时间，那么 MVC 可能适合您。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-08T13:23:29.180

不。就我个人而言，我发现 MVC 的工作方式更像是我的大脑所做的工作，非常清楚地区分了什么去哪里和为什么去。我在几周内用 MVC 敲定了一个完整的原型商务网站，我敢肯定，这至少是使用 webforms 的两倍。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-08T13:34:25.710

在这一点上，WebForms，更加成熟了。例如，我希望验证（客户端和服务器端）在 MVC 中有更好的支持。但是，我完全希望，随着时间的推移，这种情况会有所改善。从我的角度来看，MVC 最好的一点是 MVC 使我的代码更易于测试。我留下了很多未经 WebForms 测试的代码，只是因为测试代码隐藏太难了。现在我可以为我的所有控制器逻辑编写单元测试。

即使最终证明 MVC 有点慢（而且我猜它不会），增强的可测试性也会让它变得值得。最终我会收回那段时间，因为以后会减少回过头来修复错误的、未经测试的代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-10T00:47:56.567

我发现 MVC 更适合 Web 开发。正如之前的海报所指出的，您无需处理由 Web 表单页面执行生命周期引发的奇怪错误，无疑可以节省时间。

此外，能够更快地为您的逻辑编写单元测试（并且减少对模拟的依赖！）是一个很大的优势。

最后，我发现使用 MVC 框架编写 css 和客户端脚本要容易得多，因为您可以在 HTML 元素上指定自己的 ID。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-31T23:45:53.637

当我听到“快速开发”一词时，我发现人们通常在“我能以多快的速度开发新解决方案”的背景下使用它。在构建合理的答案之前，必须考虑很多因素。

*   开发人员对该框架的熟悉程度如何？
*   设计有多全面？
*   要求有多复杂？
*   框架有多稳定？

在 1.0 发布前不久，我第一次接触到 ASP.NET MVC。在此之前，我对 ASP.NET WebForms 非常熟悉并且非常熟悉，但我仍然对整个开发过程感到沮丧。我知道围绕关注点分离的目标，并且知道如果不与框架创建的电流相冲突，WebForms 就不可能实现清晰的分离。

自从使用 ASP.NET MVC 以来，我很快发现我在很多事情上都错过了这条船。虽然 WebForms 允许您“更快”地构建事物，但您基本上受制于 Microsoft 的实现，而不是允许您在不涉及 Microsoft 的环境中更轻松地消化已建立的标准（例如 JavaScript、CSS 和 AJAX）。此外，新工具、行为和功能的创建不应以销售和盈利为动力，而是因为开发人员社区的技术需求需要它。自四月以来，我一直在从事这个当前的 MVC 项目。我非常喜欢使用这个框架，并且会向所有有兴趣远离 WebForms 的人强烈推荐它。学习这个框架需要一点时间，但是一旦你理解了它，

您可以使用 WebForms 更快地构建应用程序，但是，如果您想要具有专业外观的网站，您将不得不投资组件库，这些组件库仍然需要您学习那些既定标准才能正确利用它们。如果我 11 岁的儿子明天表示有兴趣学习 Web 开发，那么在选择 WebForms 或 MVC 的情况下，我会选择 MVC。话虽如此，在他接触 MVC 之前，我仍然会指导他学习 JavaScript、jQuery 和 AJAX，因为理解这些框架可以让理解几乎所有其他框架变得容易得多。

就个人而言，我并不提倡“快速发展”。我的职业生涯是作为企业开发人员度过的，并将内部开发视为一项投资。我宁愿在设计和开发上多花 20% 的时间，而不是为了满足不切实际的最后期限而将项目缩短 20%。由于维护成本、再教育和因新要求而发生的架构更改，在初始开发期间“节省”的每一美元很容易花费您至少 1.50 美元。但是，并不是每个人都像我一样思考，所以……我的简单答案是 MVC。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-10T01:06:33.443

我认为最终 MVC 将成为 Web 开发人员的明显赢家。然而，ASP.Net 将保留一个非常重要的角色，因为总会有 .NET 人认为自己是真正的 .NET winform 人的 Web 开发人员。没有 MVC 的 ASP.NET 让您可以非常快速地将东西组合在一起，但您很容易以可怕、糟糕、不洁的 HTML、CSS 和 javascript 告终。MVC 为精彩打开了大门，但需要开发人员采用更严格的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-09T01:10:25.263

自从 2000 年在奥兰多的专业开发者大会上发布第一个测试版以来，我一直在使用 ASP.NET。所以显然，我对 WebForms 更满意，因为这是我开始使用的。大多数对 WebForms 的反对意见都可以通过合理的开发机制来克服。但是，即使 WebForms 为 Web 上的 RAD 提供了基础架构，我也喜欢 MVC。MVC 仍在成熟中，我相信它会变得更好。底线是开发学习时间表上的“你在哪里”，以及你以前有什么经验。你必须自己做出这个决定。如果你是新人，你可以同时调查两者。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-01T00:10:52.323

谈到前 90% 的开发，WebForms 无疑是赢家。问题在于最后 10%，而 MVC 的优势在哪里。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-05T05:27:12.017

很奇怪为什么这么多人认为在 Web Froms 中无法获得干净的 HTML、使用 jquery（和 jquery ajax）、编写 css（？）。您必须始终从工具栏中拖放控件，而实际上您可以像在 MVC 中那样编写它。

如果您想编写好的代码，Webforms 页面生命周期、视图状态、数据绑定、更新面板也需要时间来学习。似乎大多数人并没有为此花时间，这就是为什么他们说 WebForms “不太好”。

虽然我是成熟的 Web Froms 开发人员，但我正在尝试学习 MVC（只是为了好玩），它足以编写复杂的网站。但正如我现在看到的，MVC 的主要问题是你必须写很多代码，真的很多！！！

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-11-10T01:01:49.350

这取决于你如何发展。

如果您是将控件拖到设计器表面的人，那么可能很难与 MVC 的快速开发水平相匹配。

另一方面，如果您将大部分时间都花在源代码视图中，您可能会发现 MVC 让您这样做更有效率。

把 AJAX 带入画面，如果你是一个依赖 UpdatePanel 的人，MVC 对你来说可能是难以形容的悲惨。

（这并没有开始解决哪种类型的开发更“正确”的主观问题。但我不认为这是这个问题的重点。）

# iphone - 提交申请时，我需要向 Apple AppStore 提交什么？

> ID：274717
> 
> 赞同：2
> 
> 时间：2008-11-08T13:27:01.593
> 
> 标签：iphone, app-store

有谁能告诉我提交申请时需要向苹果应用商店提交哪些文件？

例如，是否需要提交 Resource 文件、Digital Developer 证书文件等？

请帮助我了解此过程，或向我展示我可以了解更多信息的网络资源。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-08T13:37:56.860

[Apple 在“ iPhone Developer Program Portal 用户指南](http://adcdownload.apple.com/iphone/iphone_developer_program_user_guide/iphone_developer_program_user_guide__standard_program_v2.1.pdf)”中对此进行了很好的记录——请参阅从第 28 页开始的分发部分。

您发送给他们的唯一文件是您的应用程序的屏幕截图、一个大版本的图标和您的应用程序的压缩副本。资源文件、证书等都包含在您的应用程序的副本中或用于构建/签署您的应用程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-08T13:39:14.220

如果您浏览提交网络表单，它会要求您提供各种信息，但基本上是应用程序二进制文件、高 rez 图标和一些屏幕截图。您无需提交开发证书，Apple 在您生成它们时就有他们需要的位，并且您的应用程序已经作为构建过程的一部分进行了适当的签名。

Apple 已发布[pdf 格式](http://adcdownload.apple.com/iphone/iphone_developer_program_user_guide/iphone_developer_program_user_guide__standard_program_v2.1.pdf)的文档以及WWDC 讨论应用商店分发的[视频，其中详细介绍了所需内容。](https://developer.apple.com/videos/app-store-and-distribution/)我认为所有拥有付费 iPhone 开发者帐户的人都可以访问它。

# java - JavaSound 使用流写入音频文件

> ID：274718
> 
> 赞同：2
> 
> 时间：2008-11-08T13:29:39.153
> 
> 标签：java, audio, javasound

我正在尝试使用 JavaSound API 创建音频过滤器来读取和写入音频文件。目前我的代码结构如下：

```
 ByteArrayOutputStream b_out = new ByteArrayOutputStream();

        // Read a frame from the file.
        while (audioInputStream.read(audioBytes) != -1) {   
            //Do stuff here....
            b_out.write(outputvalue);
        }   

        // Hook output stream to output file
        ByteArrayInputStream b_in   = new ByteArrayInputStream(b_out.toByteArray());
        AudioInputStream     ais    = new AudioInputStream(b_in, format, length);
        AudioSystem.write(ais, inFileFormat.getType(), outputFile); 
```

这会将输入文件作为流读取，对其进行处理并将其写入字节数组输出流，但它会等到整个文件处理完毕后再写入磁盘。理想情况下，我希望它在处理每个样本时将其写入磁盘。我已经尝试了几种流结构的组合，但找不到一种方法，因为 AudioSystem.write() 需要输入流。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-26T21:01:25.497

kasperjj 的回答是正确的。您可能正在使用 WAV 文件。查看[此](http://ccrma.stanford.edu/CCRMA/Courses/422/projects/WaveFormat/) 波形文件的布局。请注意，整个 WAV 文件的大小在其标头中进行编码。

我不知道这是否适用于您的情况，但要按照您的描述处理 WAV 样本，您可以使用“常规”非音频 Java 输出流。例如，您可以使用 FileOutputStream 将它们写入临时文件，处理后您可以将临时文件转换为有效的 WAV 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T15:07:40.670

某些音频格式需要在其标头中描述流长度（或块数）的元数据，因此无法在整个数据集出现之前开始写入数据。为了让 Java 声音 API 使用相同的 API 处理所有格式，我怀疑他们必须故意施加此限制。

然而，有许多音频格式可以轻松流式传输。他们中的许多人都有针对 java 的开放库实现，所以如果你愿意添加一个外部库，它应该不难完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-28T10:04:25.120

如果您重新实现 AudioSystem.write 方法，则可以解决该问题。它不适用于流和 WAVE 格式。您应该从 AudioInputStream 读取数据，将其缓存在字节数组中，处理数组并记录到波形文件。我建议您检查示例中的类：[如何将音频录制到字节数组](http://privateblog.by/kak-zapisat-zvuk-na-java-v-byte-massiv)

# ajax - iframe 内容取决于引用页面

> ID：274725
> 
> 赞同：2
> 
> 时间：2008-11-08T13:34:43.637
> 
> 标签：ajax, iframe

有没有办法根据引用页面改变 iframe 的初始内容？

例如，当直接在地址栏中键入第 1 页的 URL 时，“第 1 页”有一个显示“初始内容 1”的 iframe。如果单击“第 2 页”链接到“第 1 页”的链接，则“第 1 页”上的 iframe 内容将作为“初始内容 2”开始。

我希望这是有道理的。

* * *

非常感谢 splattne。

我刚刚尝试过你的想法，但我无法做到。我的页面现在在正文中有以下内容：

```
if (document.referrer != 'page2.html') {
   document.getElementById('prdfrm2').src = 'contenta.html';
}   
if (document.referrer != 'page3.html') {
   document.getElementById('prdfrm2').src = 'contentb.html';
}   
if (document.referrer != 'page4.html') {
   document.getElementById('prdfrm2').src = 'contentc.html';
}
else {
   document.getElementById('prdfrm2').src = 'contentx.html';
} 
```

看来，但是我访问父页面（直接，从第 2,3 或 4 页上的链接）加载相同的内容，内容来自`contentc`- 你能想到为什么吗？

* * *

感谢大家的帮助，但我仍然遇到问题。如果这可以在“服务器端”完成，那就太好了，但我对此的经验很少。有谁知道如何在 PHP 中做到这一点？

如果可能的话，我想根据输入到地址栏中的 URL 来改变 iframe 内容。例如我一直在使用脚本：

```
function addLoadEvent(func) {
    var oldonload = window.onload;
    if (typeof window.onload != 'function') {
        window.onload = func;
    } else {
        window.onload = function() {
            if (oldonload) {
                oldonload();
            }
            func();
        }
    }
}

function gup( name ) {
   name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
   var regexS = "[\\?&]"+name+"=([^&#]*)";
   var regex = new RegExp( regexS );
   var results = regex.exec( window.location.href );
   if( results == null )
      return "";
   else
      return results[1];
}

addLoadEvent(function() {
       var targetURL = gup("iframe");
      document.all.myIframe.src=targetURL;
}) 
```

我可以在地址栏中输入`http://mysite.com/page11.html?&iframe=page12.html`，以便第 11 页的 iframe 包含第 12 页。

问题是这个脚本适用于 Safari 和 IE，但不适用于 FF :(

正如我所说，任何在 PHP 中做这件事的技巧都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T13:41:27.193

**您可以使用document.referrer** HTML DOM 属性在 Javascript 中以这种方式解决它：

```
if (document.referrer != 'page2.html') {
   document.getElementById('iFrameId').src = 'content1.html';
}
else {
   document.getElementById('iFrameId').src = 'content2.html';
} 
```

这是[有关引用者属性的一些文档](http://www.w3schools.com/jsref/prop_doc_referrer.asp)。

您也可以在服务器端进行。只需告诉我们您使用的是什么环境（ASP.NET、PHP、...）。

# release - 提前发布/经常发布商业软件？

> ID：274733
> 
> 赞同：8
> 
> 时间：2008-11-08T13:45:35.050
> 
> 标签：release, release-management

有没有人有关于提前发布/经常发布商业软件的经验/例子？它有效吗？

我在考虑 VMware，他们在每个主要版本之间都有很多修订版本。而且安装体验很糟糕，有时它们会破坏现有的虚拟机，有时客户操作系统中的 VMware Tools 会出现故障/无法安装。这太可怕了。

我也在考虑 ClickOnce 部署，因为当您更新软件时，使用 ClickOnce，所有客户端都会自动收到发布通知，并且只需单击一下，它们就会更新到新版本。如果您的软件有错误，那么它们也会自动“升级”以获取这些错误。

您是否有将提前发布/经常发布原则应用于商业软件的经验\示例\建议？

我想把它应用到一个。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T14:11:59.817

肯尼是对的：这取决于。

我们致力于企业软件，客户可以在其中运行 3 个月以上的内部项目以升级到新版本。在那种环境下，频繁的发布是**行不通**的。客户将使用旧版本多年，我们必须继续支持他们，因此活跃的版本越多，支持工作就越多。

在另一个极端，我正在运行 Google Chrome 并阅读了有关 beta 更新的信息。我去看看如何获​​取它，发现Chrome已经更新了自己。如果有任何通知我错过了，那对我来说很好。

**主要问题是新版本的破坏性有多大**。例如，如果 MS 每 3 个月发布新版本的 Visual Studio，其中包含新的 .NET 版本、C 运行时等，那么我们将花费大部分时间来处理升级，这并不好。但是，如果他们想发布新版本的 Windows 媒体播放器和一些适合我的新小部件 - 只需让下载/安装过程尽可能无缝。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T13:53:08.717

我认为这始终取决于您的市场或客户群。在某些环境和公司中，更改/升级软件总是很痛苦，甚至更痛苦。快速发布周期可能具有破坏性。这些中断通常也会延伸到您的内部运营，这取决于营销/管理层对功能蔓延的管理程度。

因此，经典的“视情况而定”答案再次响起。

如果您真的在为产品增加价值，那么客户尤其是新客户会想要它。最好的情况是消除升级更改的痛苦，因为它的工作原理相同，但明显更好。伟大的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T14:30:40.653

*注意窗帘后面的人。*：
Release Early-Release 通常实践希望您做的事情是尽早快速地失败，而不是在项目结束时为时已晚。它使您有更多机会向最终客户展示您正在构建的内容，获得有价值的反馈并以更低的成本进行调整。“客户”角色的人必须能够轻松获得最新版本；玩它并尽可能定期地以建设性的反馈做出回应。

如果您正在构建一些关键的东西，例如监控或控制发电厂的东西，您可能需要小心这种做法。您不希望人们拿着手电筒作为您新版本的反馈。在这种情况下，定期部署到测试平台，观察 X 天（根据您的信心水平）然后上线是有意义的！您可以让您的客户访问此测试平台，以发挥和建立他的信心表。
如果它是一个非关键应用程序，并且您拥有良好的发布历史记录，请执行 ClickOnce 之类的操作。但也要确保它同样容易为客户回滚。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T14:11:16.667

如果您打算这样做，请确保当人们购买您的产品时，他们将在一年或其他一段时间内免费升级到新版本，这样他们就不会觉得自己在购买新产品时被骗了版本在他们购买副本后 2 个月发布。此外，请确保您支持旧版本，以便那些不想升级，只想修复错误的人可以这样做，而不会冒着用新版本的软件破坏他们当前安装的风险。我个人认为这将是更多的工作，但您最终会得到更好的产品，并且如果他们愿意，您将允许使用您的软件的人们更快地利用新功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T14:52:57.940

我们运行一个 SaaS 应用程序，因此原则上它可以随时更新。

另一方面，在实践中，它每年只发布几个主要版本（通常每隔几周发布一次较小的补丁版本）。

原因是发布会给操作人员造成干扰；有时需要删除部分应用程序。对于非面向客户的更改，实际*进行发布*而不是进行工程设计需要做很多工作。

因此，虽然 StackOverflow 似乎每隔几天就会更新一次，但我们不会这样做。一天之内可能会修复几个错误，但它们会在随后的版本中得到修复，该版本以“大爆炸”的形式发布。或者其他的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T14:03:36.090

这取决于你的资源。如果你是微软，你可以提前发布一个与 Sista 押韵的漏洞百出的 POS，并依靠你的营销能力让人们忘记他们早期的产品体验。

如果您希望获得良好的口碑，发布早期版本不是一个好主意（除非您计划在最终发布之前更改名称或其他内容）。

# asp.net - 什么基准测试可以测试我的 ASP.NET、SQL Server、IIS 产品的硬件速率？

> ID：274742
> 
> 赞同：2
> 
> 时间：2008-11-08T13:57:42.980
> 
> 标签：asp.net, sql-server, iis, configuration, windows-server-2003

什么基准测试可以测试我的 ASP.NET、SQL Server、IIS 产品的硬件速率？

我有两台服务器，一台运行我的代码比另一台快得多，我相信它们的配置接近等效，因此我想对两者进行基准测试。

我**不**希望这个问题成为关于硬件的问题。

这个问题是问我如何测试我的软件的硬件速率有多好。

换句话说，3D 基准测试并不能准确评估我的系统是否适合 ASP.NET/SQL Server 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-09T01:49:40.203

我想说我为这个问题找到的唯一最佳解决方案是[Visual Studio Team Test Edition](http://msdn.microsoft.com/en-us/vsts2008/test/default.aspx)。您可以使用您喜欢的任何 .NET 语言编写压力测试，并且可以学习和发现。您从中获得的指标非常有用。

有一个 90 天的试用期，你也许可以逃脱看看我在说什么。我在以前的公司使用它有过很好的体验，我们刚刚在我现在的公司直接购买了它，而另一位以前从未使用过它的开发人员在几个小时内启动并运行了压力测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T15:21:06.837

澄清后，我认为您正在寻找**压力测试应用程序**：

您可以在这两个盒子上托管您的应用程序，然后使用另一个盒子通过压力测试应用程序向它大量发送请求。

然后您可以查看统计信息，例如每秒点击次数。每秒响应次数等。

我自己以前从未使用过，但[谷歌知道一些](http://www.google.co.th/search?rlz=1C1GGLS_enTH291&sourceid=chrome&ie=UTF-8&q=asp.net+stress+test)。

* * *

~~你什么意思？你能澄清一下吗？~~

PCMark 对硬件而非软件进行基准测试。

您在寻找 Profiler 吗？

建立 Resharper 和 Teamcity 的公司，[有一家](http://www.jetbrains.com/profiler/)。

~~它是一种软件基准。~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T14:08:18.807

我也听说过关于 VS 测试版的好消息。然而，对于 web 应用程序的测试，Jmeter 是一个很棒的免费工具，而且运行起来更快。

[http://jmeter.apache.org/](http://jmeter.apache.org/)

# c# - 使用 ListView 和 GroupBoxes 作为“选项”窗口的最佳方式是什么？

> ID：274745
> 
> 赞同：1
> 
> 时间：2008-11-08T14:00:54.910
> 
> 标签：c#, user-interface

使用 ListView 和一组 GroupBoxes 作为选项窗口的最佳方法是什么？

例如，Listview 将包含 General、Sounds、Shortcuts 等项目，并且将有三个 groupbox 定义这些相同的内容。

每次选择列表视图中的项目时，浏览它们的最佳编程方式是什么？

隐藏所有组框，然后根据所选列表视图的索引显示组框？或者有没有人有更好的主意来处理这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T14:11:20.193

我可能误解了您的问题，但也许 TreeView 更适合您的问题？这将允许您拥有顶级类别节点（如 General、Sounds 等），然后是每个节点下的项目列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T15:17:36.657

如果选项中没有太多类别，您可以考虑使用 TabControl。这样所有隐藏/显示机制都将由它处理。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-08T14:54:54.957

我不知道是否有更好的方法，但过去你描述的就是我采取的一般方法。

# c - 如何使弱链接与 GCC 一起工作？

> ID：274753
> 
> 赞同：28
> 
> 时间：2008-11-08T14:09:49.103
> 
> 标签：c, gcc, linker, weak

似乎有 3 种方法可以告诉 GCC 对符号进行弱链接：

*   `__attribute__((weak_import))`
*   `__attribute__((weak))`
*   `#pragma weak symbol_name`

这些都不适合我：

```
#pragma weak asdf
extern void asdf(void) __attribute__((weak_import, weak));
...
{
    if(asdf != NULL) asdf();
} 
```

我总是收到这样的链接错误：

```
未定义的符号：
  “_asdf”，引用自：
      _asdf$non_lazy_ptr 在 ccFA05kN.o
ld：未找到符号
collect2: ld 返回 1 个退出状态
```

我在 OS X 10.5.5 上使用 GCC 4.0.1。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-09-20T08:34:27.077

我只是调查了一下，并认为其他一些人可能对我的发现感兴趣。

与weak_import 的弱链接实际上只适用于动态库。您可以让它与静态链接一起工作（通过指定 -undefined dynamic_lookup 如上所述）但这不是一个热门的想法。这意味着在运行之前不会检测到未定义的符号。这是我个人在生产代码中会避免的事情。

这是一个 Mac OS X 终端会话，展示了如何使其工作：

这里是 fc

```
int f(int n)
{
    return n * 7;
} 
```

这是whatnof.c

```
#include <stdio.h>
#include <stdlib.h>

extern int f (int) __attribute__((weak_import));

int main() {
    if(f == NULL)
        printf("what, no f?\n");
    else
        printf("f(8) is %d\n", f(8));
    exit(0);
} 
```

从 fc 创建一个动态库：

```
$ cc -dynamiclib -o f.dylib f.c 
```

针对动态库编译和链接，列出动态库。

```
$ cc -o whatnof whatnof.c f.dylib
$ otool -L whatnof
whatnof:
       f.dylib (compatibility version 0.0.0, current version 0.0.0)
       /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 125.2.0) 
```

运行 whatnof 看看会发生什么：

```
$ whatnof
f(8) is 56 
```

现在将 f.dylib 替换为空库（无符号）：

```
$ mv f.dylib f.dylib.real
$ touch null.c
$ cc -dynamiclib -o f.dylib null.c 
```

运行同样的 whatnof 看看会发生什么：

```
$ whatnof
what, no f? 
```

weak_import 的基本思想（或“用例”）是它允许您链接一组动态（共享）库，然后针对相同库的早期版本运行相同的代码。您可以对照 NULL 检查函数，以查看它们是否在当前运行代码的特定动态库中受支持。这似乎是 Xcode 支持的基本开发模型的一部分。我希望这个例子有用；它有助于让我对 Xcode 设计的这一部分放心。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-08T14:27:19.123

添加`-Wl,-flat_namespace,-undefined,dynamic_lookup`到用于执行最终链接的 gcc 编译器行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-02-08T23:09:31.017

**最小的可运行 Linux 示例**

主程序

```
#include <stdio.h>

int my_weak_var __attribute__((weak)) = 1;

int main(void) {
    printf("%d\n", my_weak_var);
} 
```

不是main.c

```
int my_weak_var = 2; 
```

编译并运行这两个对象：

```
gcc -c -std=c99 -Wall -Wextra -pedantic -o main.o main.c
gcc -c -std=c99 -Wall -Wextra -pedantic -o notmain.o notmain.c
gcc -std=c99 -Wall -Wextra -pedantic -o main.out main.o notmain.o
./main.out 
```

输出：

```
2 
```

编译和运行没有`notmain.o`：

```
gcc -std=c99 -Wall -Wextra -pedantic -o main.out main.o
./main.out 
```

输出：

```
1 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/46db754b0f327ac03ba8d28b1c9fe019b964e987/gcc/weak).

所以我们看到，如果给定 on `notmain.o`，那么非弱符号按预期优先。

我们可以通过以下方式分析[ELF 目标文件](https://stackoverflow.com/questions/26294034/how-to-make-an-executable-elf-file-in-linux-using-a-hex-editor/30648229#30648229)符号：

```
nm main.o notmain.o 
```

这使：

```
main.o:
                 U _GLOBAL_OFFSET_TABLE_
0000000000000000 T main
0000000000000000 V my_weak_var
                 U printf

notmain.o:
0000000000000000 D my_weak_var 
```

接着：

```
man nm 
```

包含：

> 符号类型。至少使用以下类型；其他的也取决于目标文件格式。如果是小写，符号通常是本地的；如果是大写，则符号是全局的（外部的）。然而，对于特殊的全局符号（“u”、“v”和“w”）显示了一些小写符号。
> 
> "D"
> "d" 符号在初始化数据段中。
> 
> "V"
> "v" 符号是弱对象。当弱定义符号与正常定义符号链接时，使用正常定义符号不会出错。当链接一个弱未定义符号且该符号未定义时，该弱符号的值变为零且没有错误。在某些系统上，大写表示已指定默认值。

但是，如果处理`.a`静态库，您可能必须`-Wl,--whole-archive`按照以下说明使用：[如何使 gcc 在静态库中链接强符号以覆盖弱符号？](https://stackoverflow.com/questions/13089166/how-to-make-gcc-link-strong-symbol-in-static-library-to-overwrite-weak-symbol)

弱符号也可以未定义，这在 Binutils 中会导致“平台特定行为”，请参阅：[GCC behavior for unresolved weak functions](https://stackoverflow.com/questions/31203402/gcc-behavior-for-unresolved-weak-functions/54602008#54602008)

在 Ubuntu 18.10、GCC 8.2.0 上测试。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-08T15:32:51.150

您需要将 MACOSX_DEPLOYMENT_TARGET 变量设置为 10.2 或更高版本。请参阅[Apple 的文档](http://developer.apple.com/documentation/MacOSX/Conceptual/BPFrameworks/Concepts/WeakLinking.html)及其关于弱链接的[技术说明。](http://developer.apple.com/technotes/tn2002/tn2064.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T15:05:39.473

从 gcc 文档手册：

**虚弱的**

> weak 属性导致声明作为弱符号而不是全局符号发出。这主要用于定义可以在用户代码中覆盖的库函数，尽管它也可以与非函数声明一起使用。ELF 目标支持弱符号，使用 GNU 汇编器和链接器时也支持 a.out 目标。

这意味着一个对象被合法地覆盖一个弱符号（在另一个对象/库中定义）而不会在链接时出错。不清楚的是您是否将库与*弱*符号链接。似乎您都没有定义符号并且库没有正确链接。

# c# - 您是对私有字段进行分组还是将它们与他们的财产放在一起？

> ID：274755
> 
> 赞同：5
> 
> 时间：2008-11-08T14:10:32.503
> 
> 标签：c#, layout, coding-style

我已经在这个布局的各种项目中看到（并使用过），一组字段后跟一组属性：

```
private int MyIntField;
private string MyStringField;

public int MyInt { 
    get { return MyIntField; }
    set { MyIntField = value; }
}    
public string MyString { 
    get { return MyStringField; }
    set { MyStringField = value; }
} 
```

而且我还遇到了这种布局，其属性旁边有字段：

```
private int MyIntField;
public int MyInt { 
    get { return MyIntField; }
    set { MyIntField = value; }
}    

private string MyStringField;
public string MyString { 
    get { return MyStringField; }
    set { MyStringField = value; }
} 
```

有理由认为一个比另一个更好吗？我认为大多数编码标准都推荐选项 #1，但有时将字段放在对其进行操作的属性旁边会很方便。

*注意：我假设不能使用自动实现的属性的非平凡属性。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T14:12:33.153

我认为这是团队觉得舒服的任何东西。确定项目/公司/语言的标准并坚持下去。我更喜欢私有变量，方法/接口，私有成员......我想你明白了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-08T14:13:47.987

我将他们分组在班级的顶部。

事实上，唯一超过我的私有属性的就是类的所有常量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T14:42:30.987

我有点喜欢将字段分组在顶部，将属性分组在其他地方。这也是[Microsoft StyleCop](http://blogs.msdn.com/sourceanalysis/ "Microsoft StyleCop 官方博客")所推荐的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T14:14:37.393

我会采用后一种方法，因为它是一种约定，可以帮助我一目了然地了解私有成员是否具有公共 getter/setter。不过，这两种方式都不是什么大不了的事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T14:19:14.437

重申上面 Kenny 所说的话，这实际上与您组织的编码标准有关。尽管每个人似乎都有自己的看法，但很难客观地对一种风格进行分类。

我通常更喜欢通过访问修饰符来分组数据和方法，因此在这种情况下更喜欢选项#1。这是为了强调界面，而不是设计。也就是说，我将来可以透明地更改 MyInt 修饰符的实现（也许我真的不需要存储支持变量）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T15:47:48.890

作为旁注，汽车属性在哪里适合？

[C# 3.0 自动属性 ​​- 有用与否？](https://stackoverflow.com/questions/9304/c-30-auto-properties-useful-or-not)

# asp.net - ASP.NET：web.config 在哪里/如何缓存？

> ID：274762
> 
> 赞同：7
> 
> 时间：2008-11-08T14:18:08.947
> 
> 标签：asp.net, caching, web-config

我在 Microsoft 文档的某处读到 ASP.NET 的**web.config 的内容是缓存**的。如果这是真的，它**在哪里**缓存 - 在**内存或磁盘上**？

还有一个后续问题：如果我必须密集访问 web.config，是否需要考虑性能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-08T15:56:37.687

它缓存在内存中，缓存在磁盘上没有任何意义，它已经在磁盘上。

首先，在 ASP.NET 中，您要确保通过 HttpContext 对象的`GetSection`方法访问配置部分（这使用由 ASP.NET 管理的缓存副本）。

访问配置值的性能是Section对象（GetSection返回的对象）内部实现的一个函数。A`ConfigurationSection`可以简单地充当 DOM 节点的包装器，它可以在每次请求属性时读取该节点。另外，它可以在内部缓存该值并监视更改。

我的建议是让您的代码保持简单，只需通过访问您需要的值，而不是尝试在其他地方保存它们的副本，但是如果您要获取多个，请务必在请求期间`GetSection`保持对返回的对象的引用`GetSection`从中获得价值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-28T22:31:09.700

在 ASP.NET 中，**<appSettings>**部分**在第一次访问后**缓存到内存中：

*   http://msdn.microsoft.com/en-us/library/aa478432.aspx
*   http://weblogs.asp.net/stevewellens/web-config-is-cached

如果 web.config 文件有更新，ASP.NET 会重新启动应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T14:55:42.660

我认为 web.config 缓存在内存中（在 System.Web.Configuration 的对象实例中）。更改 .config 文件时会重新加载这些文件（从而重新加载您的 Web 应用程序）。

击中这些对象不太可能给您带来性能瓶颈。但是，如果您必须进行解析等，您可能希望保留已解析的对象。

[额外]我的好习惯（至少我认为）是在您的 global.asax.cs 文件中为您的 appsettings 创建静态属性。您可以在 application_start 方法中实例化这些属性，并在整个 Web 应用程序中使用它们。这可以防止您在整个代码中使用硬编码字符串（配置键）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T14:56:16.280

它被缓存在内存中。对于经常访问并且已经采用可以将其转换为易于存储的数据结构的格式的内容，在磁盘上缓存没有多大意义。我的建议是自由访问它，因为它与您想出的任何存储它的方案一样快，而且可能更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-12T06:54:18.007

我完全不同意 web.config 值被缓存。它不断被 IIS 访问。

我的 web.config 中有大约 30 个 AppSettings 键。

例如

```
<appSettings>
        <add key="ProductImageFileType" value=".jpg|.jpeg|.gif|.png" />
</appSettings> 
```

在我的 ASP.Net C# 代码中，我有

```
string ValidateType = ConfigurationManager.AppSettings["ProductImageFileType"].ToString(); 
```

请参阅下图，其中显示了每秒增加的 web.config 读取计数。

[![在此处输入图像描述](https://i.stack.imgur.com/z1d40.png)](https://i.stack.imgur.com/z1d40.png)

我的建议是在 Application_Start 期间从 ConfigurationManager.AppSettings 获取值，并将键值对存储在全局字典中。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-11-05T10:41:36.513

我的建议是像使用任何其他变量一样使用它，原因很简单，数据被缓存。如果您在 global.asax 中创建静态变量，您将强迫自己编写更多代码。无论您的计划如何，很有可能在开发阶段经常在 appconfig 中添加变量。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-07-19T04:55:25.983

ASP .NET 中有两种类型的缓存。

1.  应用缓存——基于内存限制、时间限制和其他依赖的内部对象缓存

2.  页面输出缓存 - 在服务器上呈现页面缓存。它们都是基于内存的；不是磁盘。

# email - 避免合法邮件的垃圾邮件过滤器

> ID：274764
> 
> 赞同：0
> 
> 时间：2008-11-08T14:19:21.860
> 
> 标签：email, spam-prevention

**如何[确保以编程方式发送的电子邮件不会被自动标记为垃圾邮件？](https://stackoverflow.com/questions/371/how-do-you-make-sure-email-you-send-programmatically-is-not-automatically-marke)**

最初我计划从我的网站以 html 格式发送电子邮件（即 content-type: text/html;），但我今天才想到，以纯文本格式发送电子邮件不是更好吗，即 content-type: text/plain ;，所以我的邮件最终进入垃圾邮件/垃圾文件夹的机会变得更少，我认为这一定是垃圾邮件过滤器在流行的网络邮件服务（如 gmail、yahoo 和 hotmail）上使用的规则之一，你怎么看?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T14:27:13.827

根据我的经验，大多数反垃圾邮件系统将 HTML 的 Hamminess 评分略低于纯文本，但还有更重要的事情需要考虑，这些因素会影响可传递性：

*   确保您的邮件服务器具有有效的反向 DNS 配置，否则您将无法投递到许多域。
*   调查将[SPF](http://www.openspf.org/)记录添加到您的 DNS 区域文件。这很有帮助，尤其是对 GMail。
*   查看[DomainKeys](http://en.wikipedia.org/wiki/DomainKeys)，如果它在您的平台上可用。这本质上是附加到您的出站邮件的加密签名，因此它证明您是发送邮件的人。
*   检查您的邮件内容并确保您没有使用任何明显的垃圾邮件指示词（特别是在主题行中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T14:40:35.373

我认为为了安全起见，除了 Tim Howland 的建议之外，您始终可以先发送一封纯文本电子邮件，欢迎此人并要求将您的域放入他们的电子邮件安全文件中。我看到大公司经常发生这种情况。我收到一封纯文本电子邮件，上面写着“欢迎，请确保 email@bigcompany.com 在您的安全电子邮件文件中。”

我不能说您的纯文本电子邮件一开始就不会被视为垃圾邮件，但至少这是确保您的 HTML 电子邮件通过的简单的第一步。

# asp.net - Internet Explorer 7 中的登录控制会话丢失

> ID：274770
> 
> 赞同：0
> 
> 时间：2008-11-08T14:24:31.460
> 
> 标签：asp.net, internet-explorer, session, login

使用登录控件登录后，浏览器将丢失会话。这只发生在 Internet Explorer 7 中。有其他人遇到过这个问题吗？如果是这样，您知道解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T13:58:58.920

我建议下载像[ieHTTPHeaders](http://www.blunck.se/iehttpheaders/download.html)这样的工具来跟踪 IE 中的请求/响应标头，并查看 IE 在什么时候停止发送 cookie 或服务器将其清除。

您应该看到登录页面的 POST 并且服务器应该以 Set-Cookie: 响应，并且该 cookie 应该在每个后续请求中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T19:35:25.893

结果页面在处理请求的过程中引用了一个清除会话的页面。这只发生在 IE 中。

# .net - 使用 Mex 的问题

> ID：274779
> 
> 赞同：1
> 
> 时间：2008-11-08T14:33:09.493
> 
> 标签：.net, wcf

我的应用程序同时使用 NetTcpBinding 和 BasicHttpBinding，但它们中的每一个都会公开我的服务类的一个子集。我创建了如下服务。

问题是，即使我刚刚将 3 个合同添加到 Mex 绑定，当我想将服务添加到我的项目时，所有合同都会显示出来。

```
m_ServiceHost = new ServiceHost(typeof(Services), baseAddresses); 

BasicHttpBinding basicHttpBinding = new BasicHttpBinding(); 
basicHttpBinding.UseDefaultWebProxy = false; 

m_ServiceHost.AddServiceEndpoint(typeof( IMyFirstService), basicHttpBinding, "MyFirstService"); 
m_ServiceHost.AddServiceEndpoint(typeof(IMySecondService), basicHttpBinding, "MySecondService"); 
m_ServiceHost.AddServiceEndpoint(typeof(IMyThirdService), basicHttpBinding, "MyThirdService"); 

NetTcpBinding netTcpBinding = new NetTcpBinding(); 
netTcpBinding.MaxReceivedMessageSize = 2147483647; 
netTcpBinding.ReaderQuotas.MaxNameTableCharCount = 2147483647; 

m_ServiceHost.AddServiceEndpoint(typeof(IMyFirstService), netTcpBinding, "MyFirstService"); 
m_ServiceHost.AddServiceEndpoint(typeof(IMySecondService), netTcpBinding, "MySecondService"); 
m_ServiceHost.AddServiceEndpoint(typeof(IMyFourthService), netTcpBinding, "MyFourthService"); 
m_ServiceHost.AddServiceEndpoint(typeof(IMyFifthService), netTcpBinding, "MyFifthService"); 
m_ServiceHost.AddServiceEndpoint(typeof(IMySixService), netTcpBinding, "MySixService"); 

HttpTransportBindingElement httpTransport = new HttpTransportBindingElement(); 
httpTransport.MaxReceivedMessageSize = 2147483647; 
httpTransport.MaxBufferSize = 2147483647; 

TextMessageEncodingBindingElement textMessageEncoding = new TextMessageEncodingBindingElement(); 
textMessageEncoding.ReaderQuotas.MaxDepth = 2147483647; 
textMessageEncoding.ReaderQuotas.MaxStringContentLength = 2147483647; 
textMessageEncoding.ReaderQuotas.MaxArrayLength = 2147483647; 
textMessageEncoding.ReaderQuotas.MaxBytesPerRead = 2147483647; 
textMessageEncoding.ReaderQuotas.MaxNameTableCharCount = 2147483647;               

System.ServiceModel.Channels.CustomBinding mexHttpCustomBinding = new System.ServiceModel.Channels.CustomBinding(textMessageEncoding, httpTransport); 
mexHttpCustomBinding.Name = "MexHttpBindingConfig"; 
               m_ServiceHost.AddServiceEndpoint(typeof(System.ServiceModel.Description.IMetadataExchange), mexHttpCustomBinding, "mex"); 

m_ServiceHost.Open(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-25T20:03:52.077

我认为你能做到这一点的唯一方法是创建两个单独的服务主机。一种用于通过 http 公开的服务，另一种用于通过 net.tcp 绑定公开的服务。

# c# - 在 Windows 中创建 Applescript？

> ID：274782
> 
> 赞同：2
> 
> 时间：2008-11-08T14:34:19.287
> 
> 标签：c#, installation, applescript

我有一个需要将文件部署到客户端计算机硬盘的 C# Web 应用程序。（Adobe Acrobat 的 javascript 文件）

如果客户端使用的是 mac，我有一个 applescript，它将在他们的应用程序目录中搜索 acrobat，然后将 JS 文件部署到正确的位置。

问题是我目前正在 Mac 上创建 applescript，然后将其移至服务器。applescript 至少有一条消息（表示它已成功完成），并且这条消息需要以用户选择的语言显示（在 web 应用程序中指定）

那么，有什么方法可以在我的 Windows C# 服务器（使用嵌入式语言字符串）上创建 applescript，然后将其发送到客户端？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-08T14:41:40.427

我想不出一个动态生成 AppleScript 的好方法（尤其是在非 Mac OS 平台上），但你不能让 C#（ASP.NET？）服务器写入文件，并读取 AppleScript从中得到的信息？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T15:43:33.467

我最终接受了索伦的建议。我在 Mac 上编译了 applescript，将其压缩，然后将其移至我的 windows 服务器。然后我可以动态地使用 zip 库将 txt 文件添加到存档中。

applescript 中包含读取文本文件内容的代码： [Applescript application read from file](https://stackoverflow.com/questions/281108/applescript-application-read-from-file)

# iphone - 从相同的源代码生成“免费/演示”和商业应用程序的最佳方式？

> ID：274785
> 
> 赞同：3
> 
> 时间：2008-11-08T14:36:44.977
> 
> 标签：iphone, cocoa-touch, app-store

我想在 App Store 上提供我的 iPhone 应用程序的两种不同版本——一种是免费的，受通过应用程序显示的项目数量的限制，另一种是完全不受限制的。

两个应用程序的源代码将完全相同，唯一的区别是在应用程序中存储项目的 SQLite 数据库。

我了解该应用程序的两个版本都需要具有不同的包名称和不同的图标。我试图找到一种方法来避免完全复制源代码目录以便能够自定义其中的一些内容：数据库、图标、笔尖字符串等。

有没有不复制所有内容的好方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-08T15:09:05.833

只需在您的项目中创建第二个目标。一个可以是功能齐全的应用程序，其中包括完整的数据库，新的目标将是您的演示版本，带有演示数据库。我们用填字游戏来做到这一点，而且效果很好。然后，您可以将所有来源保存在一个地方，而不必担心事情会不同步。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T17:22:50.117

明智地使用条件编译。我不知道您使用的是什么语言，但在 C/C++ 条件编译中，是使用宏预处理器和 ifdefs 完成的。你会写出类似这样的代码：

```
#ifdef FULL_APP
  // unlimited size
  #define SIZE -1
#else
  #define SIZE 100
#endif 
```

当您构建程序时，您在编译器命令行上提供适当的宏定义。

```
gcc program.cc -o program.o -DFULL_APP 
```

您可以通过多种方式使用条件编译和宏预处理器来打开或关闭可执行文件中的各种功能或修改程序的其他方面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T16:41:18.330

还值得注意的是，如果用户决定升级到完整版，如果您没有适当的机制来转移现有数据，您可能会看到用户的负面反应。如果数据的内容很小并且大部分可以用文本表示，我建议实现一个 URL 方案来传递它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T14:44:41.653

创建一个新项目，然后让它引用（而不是创建本地副本）与原始项目相同的源文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T14:58:47.227

是否有某种（特定于 iPhone 的？）原因，您需要为您的应用程序的两个版本使用不同的 SQLite 数据库？

如果没有，您可以使用可交换密钥实现许可机制，使您只需更改一个文件即可编译单个代码库。在运行时，您的应用程序将检查该文件并允许减少或无限存储。额外的好处（如果 iPhone 商店支持这样的东西）将是解锁完整版本应该非常简单而不会丢失数据。

当然，如果您的客户精通技术并且恶意并且您的代码易于反编译，那么这样的解决方案可能会损害您的业务。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-10T20:40:34.943

我对此进行了探索，似乎进行“下载试用版并通过网络升级”违反了应用商店的条款。看来您确实需要商店中应用程序的两个单独版本。（参考 Ben Gottlieb 的条目）。所以一个来源，两个发行版。

# c# - 视频剪辑在结束时不释放表格

> ID：274796
> 
> 赞同：2
> 
> 时间：2008-11-08T14:51:58.737
> 
> 标签：c#, video, directx

我有以下代码播放视频剪辑，但完成后它不会释放表单，而是留下视频的最后一帧。如何在播放结束时清除它，以便我可以看到它用来播放视频的表单的原始内容？

```
_video = new Video("video.wmv");
_video.Owner = frmVideoWindow;
_video.Play(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T15:49:23.987

[Daok 为](https://stackoverflow.com/users/13913/daok)我指明了正确的方向。视频结束时的事件处理程序，然后将 Video 对象的 Owner 设置为 null。

```
_video.Ending += new System.EventHandler(this.video_stopped);

private void video_stopped(object sender, EventArgs e)
{
    _video.Owner = null;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T14:57:29.677

释放你的意思是关闭表格吗？您可能想要检查 Video 对象中的事件，该事件将在视频播放完毕时引发，您将需要使用 this.close(); 关闭表单。是你想要的吗？

# asp.net-mvc - 在安装了 beta 的盒子上运行 ASP.NET MVC preview 3 应用程序 - 安装 ASP.NET MVC Beta 后如何从 GAC 中删除 System.Web.Mvc？

> ID：274806
> 
> 赞同：1
> 
> 时间：2008-11-08T15:02:41.243
> 
> 标签：asp.net-mvc, assemblies, clr, gac

我有一个针对 MVC Preview 3（引用 MVC 程序集的本地副本）构建的应用程序，我试图在安装了 ASP.NET MVC beta 的机器上对其进行修改/测试。我对更新这个应用程序以运行 MVC 测试版并不感兴趣——我只需要做一些小改动。

RouteCollection.IgnoreRoutes （在 global.asax.cs 中）上的 MissingMethodExceptions 失败，因为在运行时，CLR 总是在 GAC 中找到 System.Web.Mvc 的 beta 版本并加载它而不是在我的站点中加载预览 3 版本的 \ bin 目录。

由于程序集具有相同的名称、版本和公钥，我相信在 web.config 中无法区分它们，所以我认为这里唯一的解决方案是从 GAC 中删除 ASP.NET MVC beta 程序集。

只有 - 我不能这样做，因为它们是由 Windows Installer 安装的，所以我无法使用 gacutil.exe /u 删除它们，当我尝试直接删除它们时，我得到“访问被拒绝”。

任何人都知道我可以如何删除这个程序集 - 或者，如果失败了，如何在 GAC 中具有 System.Web.Mvc beta 的系统上运行/托管需要 System.Web.Mvc preview 3 的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T15:11:15.937

你可以下载[ASP.NET MVC Preview 3 Source](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=13792 "ASP.NET - 发布：ASP.NET MVC Preview 3 Source")并用你自己的 SNK 编译它，或者给它一个不同的版本作为官方版本并在你的网站中引用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T15:59:10.117

我认为您最好的选择是，因为该应用程序是基于预览版构建的，所以您应该升级该应用程序以使用 beta 版本，因为您知道最终您将不得不更新它以使用生产版本。我知道这不是你想听到的，但我认为这是 CTP 版本和公开测试版的生活事实。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T16:18:09.733

Hangy 的回答似乎符合这里的要求——如果我们最终不得不在多个工作站上维护这个应用程序，这正是我们将要做的，直到我们有时间将代码迁移到 beta/live 版本。

但与此同时，我实际上所做的是破解注册表，以便我可以从 GAC 中删除 System.Web.Mvc - 完整的详细信息已发布在[我的博客上](http://dylanbeattie.blogspot.com/2008/11/working-on-aspnet-mvc-beta-and-preview.html)。现有代码现在正在运行，无需对 Preview 3 或 Beta 项目进行任何修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-18T02:47:14.150

根据[此处的此问题](https://stackoverflow.com/questions/267719/run-aspnet-mvc-preview-3-or-4-or-5-and-mvc-beta-simultaneously)和[此参考链接](http://dylanbeattie.blogspot.com/2008/11/working-on-aspnet-mvc-beta-and-preview.html)，您需要删除注册表项

```
System.Web.Mvc,version="1.0.0.0",culture="neutral",publicKeyToken="31BF3856AD364E35",processorArchitecture="MSIL" 
```

从

```
HKEY_CLASSES_ROOT\Installer\Assemblies\Global 
```

//编辑 - 哦，那是你的博客，*哈哈*。感谢您的帖子:-)

# vba - 从 Word 文档中获取标题

> ID：274814
> 
> 赞同：27
> 
> 时间：2008-11-08T15:12:15.093
> 
> 标签：vba, ms-word

如何使用 VBA 获取 word 文档中所有标题的列表？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-08T15:30:04.307

您的意思是像这样[的 createOutline](http://msdn.microsoft.com/en-us/library/bb960898.aspx)函数（实际上将所有标题从源 Word 文档复制到新的 Word 文档中）：

（我相信 asrHeadings =函数是这个程序的关键，应该允许你检索你想要的东西）`_docSource.**[GetCrossReferenceItems](http://msdn.microsoft.com/en-us/library/aa201500(office.10).aspx)**(wdRefTypeHeading)`

```
Public Sub CreateOutline()
    Dim docOutline As Word.Document
    Dim docSource As Word.Document
    Dim rng As Word.Range

    Dim astrHeadings As Variant
    Dim strText As String
    Dim intLevel As Integer
    Dim intItem As Integer

    Set docSource = ActiveDocument
    Set docOutline = Documents.Add

    ' Content returns only the main body of the document, not the headers/footer.        
    Set rng = docOutline.Content
    ' GetCrossReferenceItems(wdRefTypeHeading) returns an array with references to all headings in the document
    astrHeadings = docSource.GetCrossReferenceItems(wdRefTypeHeading)

    For intItem = LBound(astrHeadings) To UBound(astrHeadings)
        ' Get the text and the level.
        strText = Trim$(astrHeadings(intItem))
        intLevel = GetLevel(CStr(astrHeadings(intItem)))

        ' Add the text to the document.
        rng.InsertAfter strText & vbNewLine

        ' Set the style of the selected range and
        ' then collapse the range for the next entry.
        rng.Style = "Heading " & intLevel
        rng.Collapse wdCollapseEnd
    Next intItem
End Sub

Private Function GetLevel(strItem As String) As Integer
    ' Return the heading level of a header from the
    ' array returned by Word.

    ' The number of leading spaces indicates the
    ' outline level (2 spaces per level: H1 has
    ' 0 spaces, H2 has 2 spaces, H3 has 4 spaces.

    Dim strTemp As String
    Dim strOriginal As String
    Dim intDiff As Integer

    ' Get rid of all trailing spaces.
    strOriginal = RTrim$(strItem)

    ' Trim leading spaces, and then compare with
    ' the original.
    strTemp = LTrim$(strOriginal)

    ' Subtract to find the number of
    ' leading spaces in the original string.
    intDiff = Len(strOriginal) - Len(strTemp)
    GetLevel = (intDiff / 2) + 1
End Function 
```

**@kol 于 2018 年 3 月 6 日更新**

虽然`astrHeadings`是一个数组（`IsArray`返回`True`和`TypeName`返回`String()`） ，`type mismatch`但当我尝试在 VBScript（Windows 10 Pro 1709 16299.248 上的 v5.8.16384）中访问其元素时出现错误。这一定是 VBScript 特有的问题，因为如果我在 Word 的 VBA 编辑器中运行相同的代码，我就可以访问这些元素。我最终迭代了 TOC 的行，因为它甚至可以在 VBScript 中工作：

```
For Each Paragraph In Doc.TablesOfContents(1).Range.Paragraphs
  WScript.Echo Paragraph.Range.Text
Next 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-09T20:07:54.170

获取标题列表的最简单方法是遍历文档中的段落，例如：

```
 Sub ReadPara()

    Dim DocPara As Paragraph

    For Each DocPara In ActiveDocument.Paragraphs

     If Left(DocPara.Range.Style, Len("Heading")) = "Heading" Then

       Debug.Print DocPara.Range.Text

     End If

    Next

End Sub 
```

顺便说一句，我发现删除段落范围的最后一个字符是个好主意。否则，如果将字符串发送到消息框或文档，Word 会显示一个额外的控制字符。例如：

```
Left(DocPara.Range.Text, len(DocPara.Range.Text)-1) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T04:19:04.873

这个宏对我来说效果很好（Word 2010）。我稍微扩展了功能：现在它提示用户输入最低级别，并在该级别以下抑制子标题。

```
Public Sub CreateOutline()
' from http://stackoverflow.com/questions/274814/getting-the-headings-from-a-word-document
    Dim docOutline As Word.Document
    Dim docSource As Word.Document
    Dim rng As Word.Range

    Dim astrHeadings As Variant
    Dim strText As String
    Dim intLevel As Integer
    Dim intItem As Integer
    Dim minLevel As Integer

    Set docSource = ActiveDocument
    Set docOutline = Documents.Add

    minLevel = 1  'levels above this value won't be copied.
    minLevel = CInt(InputBox("This macro will generate a new document that contains only the headers from the existing document. What is the lowest level heading you want?", "2"))

    ' Content returns only the
    ' main body of the document, not
    ' the headers and footer.
    Set rng = docOutline.Content
    astrHeadings = _
     docSource.GetCrossReferenceItems(wdRefTypeHeading)

    For intItem = LBound(astrHeadings) To UBound(astrHeadings)
        ' Get the text and the level.
        strText = Trim$(astrHeadings(intItem))
        intLevel = GetLevel(CStr(astrHeadings(intItem)))

        If intLevel <= minLevel Then

            ' Add the text to the document.
            rng.InsertAfter strText & vbNewLine

            ' Set the style of the selected range and
            ' then collapse the range for the next entry.
            rng.Style = "Heading " & intLevel
            rng.Collapse wdCollapseEnd
        End If
    Next intItem
End Sub

Private Function GetLevel(strItem As String) As Integer
    ' from http://stackoverflow.com/questions/274814/getting-the-headings-from-a-word-document
    ' Return the heading level of a header from the
    ' array returned by Word.

    ' The number of leading spaces indicates the
    ' outline level (2 spaces per level: H1 has
    ' 0 spaces, H2 has 2 spaces, H3 has 4 spaces.

    Dim strTemp As String
    Dim strOriginal As String
    Dim intDiff As Integer

    ' Get rid of all trailing spaces.
    strOriginal = RTrim$(strItem)

    ' Trim leading spaces, and then compare with
    ' the original.
    strTemp = LTrim$(strOriginal)

    ' Subtract to find the number of
    ' leading spaces in the original string.
    intDiff = Len(strOriginal) - Len(strTemp)
    GetLevel = (intDiff / 2) + 1
End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-27T14:10:52.507

提取所有标题的最快方法（到 LEVEL5）。

```
Sub EXTRACT_HDNGS()
Dim WDApp As Word.Application    'WORD APP
Dim WDDoc As Word.Document       'WORD DOC

Set WDApp = Word.Application
Set WDDoc = WDApp.ActiveDocument

For Head_n = 1 To 5
Head = ("Heading " & Head_n)
WDApp.Selection.HomeKey wdStory, wdMove

    Do
       With WDApp.selection
      .MoveStart Unit:=wdLine, Count:=1    
      .Collapse Direction:=wdCollapseEnd
       End with
        With WDApp.Selection.Find
          .ClearFormatting:          .text = "":     
          .MatchWildcards = False:   .Forward = True
          .Style = WDDoc.Styles(Head)
         If .Execute = False Then GoTo Level_exit
            .ClearFormatting
        End With

       Heading_txt = RemoveSpecialChar(WDApp.Selection.Range.text, 1):              Debug.Print Heading_txt
       Heading_lvl = WDApp.Selection.Range.ListFormat.ListLevelNumber:              Debug.Print Heading_lvl
       Heading_lne = WDDoc.Range(0, WDApp.Selection.Range.End).Paragraphs.Count:    Debug.Print Heading_lne
       Heading_pge = WDApp.Selection.Information(wdActiveEndPageNumber):            Debug.Print Heading_pge

       If Wdapp.Selection.Style = "Heading 1" Then GoTo Level_exit
       Wdapp.Selection.Collapse Direction:=wdCollapseStart
   Loop
Level_exit:
Next Head_n

End Sub 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-06T10:42:05.530

在 Wikis 对 VonC 答案的评论之后，这里是对我有用的代码。它使函数更快。

```
Public Sub CopyHeadingsInNewDoc()
    Dim docOutline As Word.Document
    Dim docSource As Word.Document
    Dim rng As Word.Range

    Dim astrHeadings As Variant
    Dim strText As String
    Dim longLevel As Integer
    Dim longItem As Integer

    Set docSource = ActiveDocument
    Set docOutline = Documents.Add

    ' Content returns only the
    ' main body of the document, not
    ' the headers and footer.
    Set rng = docOutline.Content
    astrHeadings = _
     docSource.GetCrossReferenceItems(wdRefTypeHeading)

    For intItem = LBound(astrHeadings) To UBound(astrHeadings)
        ' Get the text and the level.
        strText = Trim$(astrHeadings(intItem))
        intLevel = GetLevel(CStr(astrHeadings(intItem)))

        ' Add the text to the document.
        rng.InsertAfter strText & vbNewLine

        ' Set the style of the selected range and
        ' then collapse the range for the next entry.
        rng.Style = "Heading " & intLevel
        rng.Collapse wdCollapseEnd
    Next intItem
End Sub

Private Function GetLevel(strItem As String) As Integer
    ' Return the heading level of a header from the
    ' array returned by Word.

    ' The number of leading spaces indicates the
    ' outline level (2 spaces per level: H1 has
    ' 0 spaces, H2 has 2 spaces, H3 has 4 spaces.

    Dim strTemp As String
    Dim strOriginal As String
    Dim longDiff As Integer

    ' Get rid of all trailing spaces.
    strOriginal = RTrim$(strItem)

    ' Trim leading spaces, and then compare with
    ' the original.
    strTemp = LTrim$(strOriginal)

    ' Subtract to find the number of
    ' leading spaces in the original string.
    longDiff = Len(strOriginal) - Len(strTemp)
    GetLevel = (longDiff / 2) + 1
End Function 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-13T08:23:46.953

为什么要重新发明轮子这么多次？！？

“所有标题列表”只是文档的标准 Word 索引！

这是我在向文档添加索引时录制宏得到的：

```
Sub Macro1()
    ActiveDocument.TablesOfContents.Add Range:=Selection.Range, _
        RightAlignPageNumbers:=True, _
        UseHeadingStyles:=True, _
        UpperHeadingLevel:=1, _
        LowerHeadingLevel:=5, _
        IncludePageNumbers:=True, _
        AddedStyles:="", _
        UseHyperlinks:=True, _
        HidePageNumbersInWeb:=True, _
        UseOutlineLevels:=True
End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-28T16:47:44.140

您还可以在文档中创建目录并复制它。这将 para ref 从标题中分离出来，如果您需要在另一个上下文中呈现它，这很方便。如果您不希望文档中包含 ToC，只需在 Copy n Paste 之后将其删除。JK。

# apache-flex - Flash - 从用户的网络摄像头录制

> ID：274815
> 
> 赞同：7
> 
> 时间：2008-11-08T15:14:27.630
> 
> 标签：apache-flex, flash, flv, webcam

我见过一些网站有一个 Flash 应用程序，该应用程序从用户的网络摄像头获取视频并对其进行操作。一个例子是闪存条码阅读器[http://www.renaun.com/flex2/BarcodeReader/BarcodeReader.html](http://www.renaun.com/flex2/BarcodeReader/BarcodeReader.html)。

我希望用户能够提交 10-15 秒的剪辑，我可以将这些剪辑保存到我的服务器，然后稍后通过 flash 再次播放。

您能否为此链接到一些示例项目，或者告诉我应该查看哪些手册的哪些部分？

-亚当

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-27T19:57:24.190

尝试使用[Red5 RTMP 服务器](http://osflash.org/red5)(Java) 和[Red5-Recorder](http://www.red5-recorder.com/)进行录制和播放。演示在这里：[http ://www.red5-recorder.com/demo.php](http://www.red5-recorder.com/demo.php)

（均免费）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T15:23:03.637

在 adobes 网站上有几篇带有示例代码的文章。我建议您阅读本教程，因为它将指导您完成所有必要的步骤以及示例代码：

[http://www.adobe.com/devnet/flash/articles/webcam_motion.html](http://www.adobe.com/devnet/flash/articles/webcam_motion.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T21:53:41.767

您可以在没有任何闪存服务器或 Red5 的情况下完成此操作。在网上查看一些 Flash 和动作脚本书籍，因为在论坛或谷歌上你找不到关于它的好的教程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T16:48:14.057

您需要的是[Adob​​e Flash Media Interactive Server 3](http://www.adobe.com/products/flashmediainteractive/)。只需下载它并查看“sample_guestbook”示例应用程序。

# java - 以编程方式检查 JDBC 中的打开连接

> ID：274822
> 
> 赞同：6
> 
> 时间：2008-11-08T15:24:36.707
> 
> 标签：java, oracle, jdbc

如何检查 jdbc for oracle 数据库中的打开连接？

注意：`conn.isClosed()`不能用于此。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-08T16:07:44.497

就像是：

```
Statement stmt = null;
ResultSet rs =null;
try {
   stmt = conn.createStatement();
   // oracle
   rs = stmt.executeQuery("SELECT 1 FROM Dual");
   // others
   // rs = stmt.executeQuery("SELECT 1");
   if (rs.next())
      return true; // connection is valid
}
catch (SQLException e) {
   // TODO : log the exception ...
   return false;
}
finally {
   if (stmt != null) stmt.close();
   if (rs != null) rs.close();
} 
```

请注意，如果连接来自连接池（例如在应用程序服务器中），则连接池可能具有检查连接是否有效的机制。使用 BEA，您可以在“test-on-reserve”属性中指定 SELECT。

如果您正在开发自己的池，那么您可能想看看其他人是如何做到的（例如[Proxool](http://proxool.sourceforge.net/configure.html)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-19T11:41:29.437

通常连接池也会使用 Connection.isClosed() 方法来检查连接是否仍然有效。问题是并非所有 JDBC 驱动程序都能正确处理此调用。所以我假设有一些简单的检查语句，就像 RealHowTo 说的那样。对于 Oracle，他已经提到了“SELECT 1 FROM Dual”，这对于 Oracle 数据库应该总是成功的。我认为不同的数据库有类似的查询。我记得在之前的项目中，我们还实现了一个自己的连接池，它使用了这样的验证查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T18:16:07.170

看到[这个](https://stackoverflow.com/questions/128527/is-there-any-way-to-have-the-jboss-connection-pool-reconnect-to-oracle-when-conne)帖子。

引用的解决方案类似于此处发布的解决方案（对 DUAL 进行快速查询以进行验证），但 JBoss 还使用 Oracle JDBC Connection 类中的专有 PING 方法为 Oracle 提供了一个有趣的解决方案。[请参阅此处](http://docs.huihoo.com/javadoc/jboss/4.0.2/org/jboss/resource/adapter/jdbc/vendor/OracleValidConnectionChecker.java.html)的代码。

//尼古拉斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-19T15:24:58.640

使用[pingDatabase(int timeout)](http://www.orindasoft.com/public/Oracle_JDBC_JavaDoc/javadoc901/oracle/jdbc/OracleConnection.html#pingDatabase(int)) 自 9.0.1 起在 OracleConnection 中实现

# time - 向用户显示时间和时区信息（什么，而不是如何）

> ID：274823
> 
> 赞同：8
> 
> 时间：2008-11-08T15:24:42.570
> 
> 标签：time, timezone, utc

（这是一个关于 UI 的问题，而不是实现它所需的技术）

向用户显示在不同时区发生的事件的时间的最清晰方法是什么？您的“普通”用户是否了解 UTC 和时区？

我们捕获本地时间和 UTC 偏移量并将其存储在数据库 (SQL 2008 DateTimeOffset) 中，用于不同时区发生的事件。用户也处于不同的时区。

我将在下面提出几个答案，以便对它们进行评级，但我会很感激其他建议。

编辑：我想避免在用户的时区显示时间。不同时区的用户将讨论相同的事件，如果他们位于不同时区的本地，就会产生混淆。

编辑：我想让这个问题变得通用，希望对更多人有用，但对于某些特定的上下文，这是一个用于跟踪包裹的 Web 应用程序（想想 FedEx）。包裹将跨越时区。客户支持在英国，但收件人可能在其他地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-08T17:49:36.320

尝试使用旧式新闻编辑室图形，将时钟标记为“纽约”、“伦敦”、“东京”，然后是“巴布亚新几内亚”或特定观众所在的任何位置。您可以使时钟模拟或数字或两者兼而有之。

没有人会对此感到困惑，而我认为大多数人并不真正了解 GMT+7（或其他）的含义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T15:24:54.210

像这样显示当地时间和偏移量 15:18 GMT+1

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T15:32:08.437

用时区缩写显示它

代替

```
15:18 GMT+1 
```

显示为中欧时间

```
15:18 CET 
```

人们更习惯于看到自己的时区

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T15:40:57.657

策略应该是 UI 中的时间——当向用户显示或输入时——在**用户自己的时区**中。

另一方面，在应用程序中，即在 Ruby 代码和数据库中，时间始终保持在 UTC 时区中。

然后，您的工作就是允许用户选择一个时区，然后根据需要在该时区和 UTC 时区之间来回转换。

本文[说明](http://marklunds.com/articles/one/311)了如何在 Rails 环境中执行此操作。

这意味着能够检索用户时区或将该时区存储在“用户”表中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-08T01:57:08.410

你提到包裹。物流的惯例是始终显示当地时间，这就是 UPS 等在其跟踪数据中的状态历史记录中显示的内容。

如果本地时间不是当前用户的时区，那么我会考虑用时区注释时间，例如*09:00 (Europe/Amsterdam)*。

请注意，地名比缩写更好，这可能是模棱两可的。由您决定是否告诉用户时间*在哪里*更有用，或者与他们的时区有什么*不同*。

避免该问题的一种方法是仅使用相对时间，例如*4 hours ago*。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T15:52:00.253

我认为如果没有特定的应用程序，这个问题就无法明确回答。例如，在同一时区的所有用户的 Intranet 应用程序中，您通常可以完全省略时区。对于股票市场应用程序，您可能希望将时间与市场的时区相关。对于社交网络应用程序，您可能希望将时间设置为相对于用户的时区。我认为适用的一般原则是：

1.  如果存在混淆的可能性，您应始终指定时区
2.  您应该与您的用户一起了解他们希望如何显示时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-08T15:59:21.737

正如其他人所提到的，我认为如果应用程序是特定的或本地的，那么您可以省略时区，或做出其他假设。

如果它是全局的，那么您希望一致地存储数据（始终为 UTC），然后转换为显示。此外，您可能希望让用户指定他/她的时区，并且可能还指定日期和时间格式；要么提供几个静态选项，要么赋予它们指定格式字符串的全部权力，如果它们足够先进的话。

如果您不想为用户提供选项，那么简单的 HH:MM TZ 或 HH:MM GMT+/-H 似乎就足够了？或者您甚至可以只显示服务器本地的时间，然后在脚注或常见问题解答中，说“所有时间都是 PST”或其他任何时间。

作为用户，我更喜欢最大的可配置性，但我想我是有偏见的，作为一名程序员。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-08T16:08:43.497

我喜欢 GMT+offset（假设 offset“通常”是用户的时区）。作为额外的线索，提供一个工具提示，列出该时区中的一些城市（每个半球一个），或者提供指向更详细解释时区的某个页面的超链接。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-29T07:06:15.403

您所描述的是页面查看者正在支持客户的情况。

所以我建议设计关注客户的角度。因此，默认或主要显示方法应该是客户的当地时间。如果您使用电子邮件或 IM，您应该有某种用户目录作为来源。如果你在打电话，那么来电显示可以作为时间转换的依据。

这也是该软件仅是支持产品的一部分而不是整个支持产品的一个示例。显示屏应允许轻松切换到其他时区，并且电话代表应始终接受培训，以便在提供任何基于时间的信息之前询问他们所在的时区。

它还应该有一个选项来显示到达点的当地时间。这使您能够以无缝和有效的方式与客户交谈：

```
CU: "When will it arrive?" 
CS: "Based on your phone number, I am assuming you are in EST. The ETA is 8pm". 
CU: "I am traveling in Chicago right now. Can you tell me when I should check back?"
(Phone rep taps a "CST" button on the screen, and the displays convert.) 
CS: "Sir, if the package does not arrive before 9:10pm, your local time, please call us." 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-08T18:04:32.500

这是一个非常上下文敏感的情况。我想以 postos 和 tvanfosson 的建议为基础。我认为不需要城市和国家的名称，除了帮助人们设置他们的当地时间，也许在对话框中设置时间，当他们只知道所需的当地时间时（不压倒/分散注意力的巨大挑战）对他们来说很混乱的用户）。

如果位置与时间相关联，则该位置的日期和时间通常是合适的（例如，当谈到市场收盘、事件、旅行到达和离开等时）。我赞成工具提示可用于将其转换为 (1) gmt 和 (2) 正在查看界面的用户的明显本地时间的想法。偏移量也很有用，还有涉及午夜过境点的日期。

我也同意时区应该明确表明它可能不是当地时间。此外，即使在没有时区的情况下显示本地时间，我认为工具提示仍然很重要。（特别是当携带笔记本电脑旅行的人可能会保留他们的家乡时区设置。）

对细节的额外关注：处理夏令时、夏令时等的时移，以及它们在位置之间的差异（不是每个地方都有夏令时，不是每个地方都同时进行更改）和时间点之间的差异（进入尤其是未来）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-08T18:05:44.913

最好的办法是将所有日期/时间信息存储在 UTC 中，然后显示与用户时间偏移的时间。.NET 对此提供了各种支持——大多数其他环境也为此提供了支持。早上 7 点在伦敦输入数据的人应显示为美国东部时间凌晨 1 点或凌晨 2 点。关于 UTC 最好的部分是，当您在没有夏令时的地方时，它可以避免所有带有夏令时或缺乏夏令时的麻烦事情，例如。韩国、印度与北美的新抵消。

我喜欢 24 小时制，例如美国东部夏令时间 15:30，但我相信有些人可以在 12 小时制下工作。确保将其作为一个选项。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-08T20:03:38.407

多年来，“小型”应用程序突然在全国范围内（在美国，5 或 6 个时区）或全球范围内被咬了好几次，如果可能，我**总是**将日期时间数据存储在 UTC 中。

正如许多其他帖子所指出的那样，问题就变成了显示。

如果显示日期/时间，并且它与当前用户的位置（和区域设置）相关，则以用户的本地时间显示。

如果要显示多个日期/时间并且它们与不同的位置（可能是不同的语言环境）相关，我发现**用户更喜欢以 12 小时格式查看在该位置的时区中显示的时间。**

想想如何打印机票（至少在美国）——出发和到达时间显示在出发城市和到达城市的时区。最好的路线有一个“总旅行时间”或显示的*持续时间*。

好的，所以您想为用户显示区域设置格式的数据：您如何确定区域设置？对于 Web 应用程序，虽然大多数 HTTP 标头中都存在语言环境，但您不能总是相信用户机器上的语言环境设置正确。因此，我们几乎总是要求用户设置一个配置文件，其中包含一些我们可以从中确定区域设置（邮政编码、城市/州/国家等）的数据，或者输入一些让我们知道在哪里的信息用户实际驻留（对于 Web 应用程序或“本机”应用程序）

自从通过 ip 地址进行地理定位变得广泛可用以来，我不必实现这一点，但这也不一定准确。

请注意，当我处理这些应用程序时，我的个人设置几乎总是以 24 小时格式、UTC、ISO8601 结束，这样我就*知道*向我显示什么时间，而不管用户在哪里。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2008-11-08T15:25:08.717

始终以 UTC 显示时间

注意我不同意这一点。我只是将其添加为投票选项。

# c# - 如何在 ASP.NET 中获取客户端日期和时间？

> ID：274826
> 
> 赞同：24
> 
> 时间：2008-11-08T15:25:32.523
> 
> 标签：c#, .net, asp.net, datetime, client-side

当我使用时，`DateTime.Now`我从服务器的角度获取日期和时间。有没有办法在 ASP.NET中获取*客户端日期和时间？*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-08T17:51:10.967

我喜欢使用浏览器/系统时间和时区或让他们选择时区的想法。在过去的项目中，我使用了这样的东西：

```
<script language="javascript">
function checkClientTimeZone()
{
    // Set the client time zone
    var dt = new Date();
    SetCookieCrumb("ClientDateTime", dt.toString());

    var tz = -dt.getTimezoneOffset();
    SetCookieCrumb("ClientTimeZone", tz.toString());

    // Expire in one year
    dt.setYear(dt.getYear() + 1);
    SetCookieCrumb("expires", dt.toUTCString());
}

// Attach to the document onload event
checkClientTimeZone();
</script> 
```

然后在服务器上：

```
/// <summary>
/// Returns the client (if available in cookie) or server timezone.
/// </summary>
public static int GetTimeZoneOffset(HttpRequest Request)
{
    // Default to the server time zone
    TimeZone tz = TimeZone.CurrentTimeZone;
    TimeSpan ts = tz.GetUtcOffset(DateTime.Now);
    int result = (int) ts.TotalMinutes;
    // Then check for client time zone (minutes) in a cookie
    HttpCookie cookie = Request.Cookies["ClientTimeZone"];
    if (cookie != null)
    {
        int clientTimeZone;
        if (Int32.TryParse(cookie.Value, out clientTimeZone))
            result = clientTimeZone;
    }
    return result;
} 
```

或者您可以将其作为 URL 参数传入并在 Page_Load 中处理：

```
http://host/page.aspx?tz=-360 
```

请记住使用分钟，因为并非所有时区都是整小时。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-08T16:11:07.237

我要做的是创建一个隐藏的输入字段，然后将 Javascript 例程连接到表单的 onsubmit 事件。该例程将使用客户端计算机上的时间填充隐藏字段。

通过使用 HTML 控件“HtmlInputHidden”类，隐藏字段可以与 ASP.NET 一起使用。您只需为输入控件提供 runat="server" 属性，就像任何其他服务器端控件一样。

然后，服务器可以在表单回发时读出这个时间。如果您需要在许多地方执行此操作，您甚至可以将其封装在服务器控件中。

或者，您可以使用 AJAX 执行此操作，但实现将取决于您使用的库。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-08T15:28:10.223

如果您正在维护用户配置文件，您可以要求他们告诉您他们的时区，然后进行必要的计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T15:30:03.433

另一种方法是根据用户的 IP 地址对用户进行地理定位。或者如果浏览器具有此功能，则进行地理定位（Firefox 即将推出）。获得用户位置后，您可以查找时区。

javascript 解决方案可能是一个很好且简单的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T15:35:33.423

客户端和服务器可能不完全同步，所以问题是您是否想要客户端计算机上的时间，或者您想要服务器上的时间，但针对时区差异进行了调整。Javascript 可以让您了解客户端的时间（包括时区）。您还可以将服务器上的时间与客户端的时区结合起来。

但是，您永远无法以比请求延迟更高的精度获得时间。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2012-06-27T18:18:30.687

我在带有 VB 的 ASP.Net 中使用了这种方法

```
Dim strLanguage As String = Request.UserLanguages(0)
Dim currentCulture As CultureInfo = CultureInfo.CreateSpecificCulture(strLanguage)
Dim dateformat As String = currentCulture.DateTimeFormat.ShortDatePattern 
```

这将产生查看数据的计算机的数据时间格式。

# windows - Windows 环境中的服务器/服务发现？

> ID：274831
> 
> 赞同：1
> 
> 时间：2008-11-08T15:32:03.883
> 
> 标签：windows, active-directory

[UDDI](http://en.wikipedia.org/wiki/Universal_Description_Discovery_and_Integration)用于在 Internet 上定位服务。在公司或企业环境中定位服务有什么类似的吗？例如，我可能希望我的程序能够在没有配置的情况下找到中央报告或策略服务器。这是我可以用 Active Directory 做的事情吗？还是我需要做其他事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T15:47:47.393

最好的方法是使用 DNS；Microsoft 在 Windows 中使用它自己。例如，_ldap._tcp。将为您提供域中的所有 LDAP 服务器（即所有域控制器）。如果保证只在单个主机上提供服务，则使用 A 记录。如果服务被复制，则使用 SRV 记录，显式地为客户端选择服务（实际上，_ldap._tcp 和 _kerberos._tcp 存储为 SRV 记录）。

对于选定种类的服务，还有 AD/LDAP 支持。例如，COM/RPC 服务器可以通过 rpc-server 和相关的 AD 类定位在 AD 中；API 是[RpcNS（RPC 命名服务）](http://msdn.microsoft.com/en-us/library/ms677639(VS.85).aspx)

Winsock 有一个[“注册和解析”(RnR)](http://msdn.microsoft.com/en-us/library/ms677640(VS.85).aspx) API，它使用服务实例 AD 类。

这是否有用部分取决于您是否可以制定公司政策来确定服务的定位方式。有各种各样的技术，其中许多很有用，而且有一个单一的选择（或几个替代品）比使用“最好的”技术更重要。

# java - 如何从 Java 调用 Perl？

> ID：274840
> 
> 赞同：16
> 
> 时间：2008-11-08T15:44:08.133
> 
> 标签：java, perl

我有一个希望从 Java 中使用的 Perl 模块。有没有办法使用 Windows 上的 ActiveState Perl 或 Linux 附带的通用 Perl 调用此代码？我找到了对 JPL 的引用，但它似乎不再被维护。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-08T15:52:28.227

[Inline-Java](http://search.cpan.org/~patl/Inline-Java-0.52/Java.pod)是从 Perl 调用 java 的常用库，这篇[文章提出了一个**org.perl.java**](http://www.piersharding.com/blog/archives/2004/04/calling_perl_fr.html)模块，它应该允许从 Java 调用 Perl，如所要求的。

然而，由于不同 JVM 的 JNI 实现的不可预测性，很难说 JVM 和 Perl 的哪些组合会起作用。通常，需要的是具有 MULTIPLICITY 的 Perl，并在其中编译线程。这意味着他使用自定义构建的 Perl。

否则，**[Inline::Java::Callback](http://linux.wareseeker.com/Programming/inline-java-callback-0.52.zip/326355)**允许您从 Java 调用 Perl 函数。为此，您需要创建一个`**org.perl.inline.java.InlinePerlCaller**`对象。下面是一个典型使用示例：

```
use Inline Java => <<END ;
import java.util.* ;
import org.perl.inline.java.* ;

class Pod_regexp extends InlineJavaPerlCaller {
    public Pod_regexp() throws InlineJavaException {
    }

    public boolean match(String target, String pattern)
        throws InlineJavaException {
        try {
            String m = (String)CallPerlSub("main::regexp",
            new Object [] {target, pattern}) ;

            if (m.equals("1")){
            return true ;
        }
    }
    catch (InlineJavaPerlException pe){
        // $@ is in pe.GetObject()
    }

    return false ;
    }
}
END

my $re = new Pod_regexp() ;
my $match = $re->match("Inline::Java", "^Inline") ;
print($match . "n") ; # prints 1

sub regexp {
    my $target = shift ;
    my $pattern = shift ;

    return ($target =~ /$pattern/) ;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-08T16:19:26.407

这不是 Runtime.exec() 的用途吗？

```
Runtime.getRuntime().exec("/usr/bin/perl myPerl.pl"); 
```

还是我误解了这个问题？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T23:13:56.633

我已经使用了一点 Inline::Java，发现它有点繁琐，如果我有时间的话，我可能会使用 Web 服务重新实现并以这种方式调用 perl 代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-07T13:01:18.097

Sleep 是一种脚本语言，具有在 JVM 中运行的解释器。据我了解，睡眠语言基本上是带有一些扩展的 Perl。您的代码可能能够在睡眠模式下运行。如果是，您可以实例化解释器，运行代码并检索结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-30T19:53:52.943

[Rakudo](http://rakudo.org/)允许您在 JVM 中运行 Perl6，并且有一个[Perl5 附加组件](https://github.com/rakudo-p5/v5/)允许您运行大多数旧代码，当然没有 XS。还有[JERL](https://code.google.com/p/jerl/)在 JVM 中运行当前的 microperl。这在很大程度上取决于您要做什么，但这些都值得一试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T12:00:31.077

我在 JavaWorld 上找到了 Robert Lawson 的实现，它使用 XML-RPC 从您的 Java 代码中[调用 Perl 例程：Call Perlroutines from Java](http://www.javaworld.com/javaworld/jw-10-2004/jw-1011-xmlrpc.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-26T01:43:25.720

我知道这是旧的，但我最近遇到了同样的需求。那时我发现[JPerl](http://www.javainc.com/projects/jperl/)更方便`Inline::Java::PerlInterpreter`。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-26T09:44:21.647

猜猜这真的取决于你的 perl 代码是什么，以及你想要做什么..

如果只使用 exec() 太简单，像[gearman](http://gearman.org/index.php#introduction)这样的东西可能会有所帮助

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-08T16:11:53.973

我不知道它有多稳定，或者维护得有多好，因此，另一种选择是编写一个脚本来执行您的应用程序需要的操作，然后从 Java 执行该脚本。不是最优雅的方式，但它有效。

# c++ - 如何在 C++Builder2009 中正确地将指针从 void* 向下转换为 TMemo*？

> ID：274841
> 
> 赞同：2
> 
> 时间：2008-11-08T15:45:13.263
> 
> 标签：c++, c++builder, downcast, tmemo

我在 C++Builder 2009 中编写多线程套接字聊天。
按照我需要做的，它几乎完成了，但我有一个小问题。我需要将 TMemo* 指针传递给 CreateThread WinAPI 函数，该函数将其向上转换为 void*。

我试过这样：

```
HANDLE xxx = MemoChat->Handle;
hNetThread = CreateThread(NULL, 0, NetThread, xxx, 0, &dwNetThreadId);
//... 
```

然后，在 NetThread 函数中，

```
TMemo* MyMemo((HANDLE)lpParam);
TMemo* MyMemo((TMemo*)lpParam); 
```

但它没有工作:(

问题是我如何才能真正正确地向下转换它，以便我可以在这个新线程中使用我的备忘录组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T18:50:09.053

称呼：

```
TMemo*     MemoChat   = // You defined that somewhere I assume
HANDLE     hNetThread = CreateThread(NULL, 0, NetThread, MemoChat, 0, &dwNetThreadId); 
```

这里发生的情况是，您作为第三个参数传递的任何指针都将自动转换为 void 指针（或在 WinTerms LPVOID 中）。没关系，它不会改变它，它只会丢失类型信息，因为系统对您的对象一无所知。

新的线程起点：

```
DWORD NetThread(LPVOID lpParameter)
{
    TMemo*   MemoChat   = reinterpret_cast<TMemo*>(lpParameter);
    // Do your thread stuff here.
} 
```

一旦你的线程启动方法被调用。只需将 void 指针转换回正确的类型，您应该能够再次开始使用它。

只是为了澄清其他误解。

**HANDLE 是一个**指针。
您可以将它作为参数传递给 NetThread()。

HANDLE 是指向系统控制下的指针的指针，它指向您正在使用的对象。那么为什么要使用双重间接。它允许系统移动对象（并更新其指针）而无需找到对象的所有所有者。所有者都有指向刚刚更新的指针的句柄。

这是一个老式的计算机科学概念，由于操作系统/硬件能够将主存储器交换到辅助存储器，因此在现代计算机中很少使用。但对于某些资源，它们仍然有用。如今，当需要手柄时，它们隐藏在远离用户的物体内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T15:59:39.070

请理解 HANDLE**不是**指针，而是 Win32 API 的一个概念。所以第一行将 LPVOID 转换为 HANDLE - 这是正确的，因为线程例程的参数实际上是作为句柄 (xxx) 给出的。但是，它会继续将 HANDLE 转换为 MyMemo 对象；这会将句柄中的位视为它们将形成一个地址 - 它们不是。

第二行进行完全相同的转换——它将句柄视为直接指针。

我想知道你为什么不将 MemoChat 本身传递给线程：

```
hNetThread = CreateThread(NULL, 0, NetThread, MemoChat, 0, &dwNetThreadId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T23:24:10.980

这更多是为了尝试澄清句柄与指针的关系，因为我认为马丁并不完全正确。

“指向指针的指针”确实被称为 HANDLE，它是一种常见的 CS 方法，允许操作系统在不明确知道应用程序层的情况下物理移动堆分配的内存块，应用程序层总是通过句柄访问它们。Classic 68K Mac OS 以这种方式工作。以这种方式工作的操作系统通常允许用户代码通过句柄以及直接在堆外分配内存。这种方法用于没有适当内存管理硬件的机器上。

然而，HANDLE这个词还有其他的用法，它们借用了之前用法的一些抽象，但有不同的实现。不透明指针（指向用户不知道的数据结构的指针 - PIMPL 成语）通常也称为 HANDLES。

此外，术语 HANDLE 可以简单地用于表示对对象的“引用”——可能是数组的索引。Unix 文件句柄（= 文件描述符）就是一个很好的例子。标准输入=0，标准输出=1，...

那么，以上哪些是 Windows API HANDLES？我看到了相互矛盾的报道。[这份文件](http://www.stanford.edu/class/cs193w/handouts/h04-naming.pdf)说：

> Win32 中的句柄是用于标识资源或窗口的数字。它们不是指针或指向指针的指针。将它们视为身份证号码。

# c# - 处理来自键盘楔的输入

> ID：274842
> 
> 赞同：0
> 
> 时间：2008-11-08T15:46:40.453
> 
> 标签：c#, point-of-sale

继 Mykroft 提出的问题之后

处理来自键盘“楔形”输入的最佳方式

[处理来自键盘“楔形”的输入的最佳方式](https://stackoverflow.com/questions/42437/best-way-to-handle-input-from-a-keyboard-wedge)。

我需要编写一个拦截击键的类，如果确定输入来自键盘楔（如上面的帖子中所述），则数据将被定向到 POS 类进行处理，否则必须将它们传递给以正常方式在窗口中处理。这提出了两个问题

1.  不在 WinForm 中时如何截取击键。

2.  如何将按键传递给 Windows。

感谢 JDibble

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T19:18:41.320

您需要 P/Invoke SetWindowsHookEx()。唯一可以在 .NET 应用程序中使用的钩子是 WH_KEYBOARD_LL。当您搜索这些关键字时，您应该会在示例代码上获得大量点击。

# javascript - 使用 Scriptaculous 拖放防止 JavaScript 点击事件

> ID：274843
> 
> 赞同：4
> 
> 时间：2008-11-08T15:47:28.983
> 
> 标签：javascript, events, event-handling, drag-and-drop, scriptaculous

我在页面上有一些可拖动的元素。这些相同的元素具有导航到另一个页面的单击事件。我正在尝试确定在用户拖动时防止单击事件触发的最佳方法，但如果不拖动仍允许单击事件。任何人都对实现这一目标的最佳方法有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-09T16:34:30.403

我通过使用以下内容解决了这个问题：

```
new Draggable('id', {
    onStart: function() {
        dPhoto = $('id');
        Event.stopObserving('id', 'click');
    },
    onEnd : function() {
        setTimeout("Event.observe('id', 'click', function() { location.href = 'url'; });", 500);
    },
    revert: true
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T21:14:18.920

```
var click_func;
function onDragStart(drgObj,mouseEvent){
    click_func = mouseEvent.target.onclick;

    mouseEvent.target.onclick = function(e){
        mouseEvent.target.onclick = click_func;
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T16:10:35.007

像下面这样的东西可能会起作用（并防止点击事件被触发）

```
new Draggable('tag',  
    {
        revert:function()
        {
            $('tag').onclick = function(){return false;};
            setTimeout('$(\'tag\').onclick = function(){return true;}','500');  
            return true;
        }
    }
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-20T12:32:54.800

您也可以通过其他方式执行此操作。在您的 startDrag 上，您停止观察对象。然后你再次观察点击导致 enddrag 函数重新创建第一个事件处理程序。

```
function onDragStart() {
    Event.stopObserving(this.OBJECT,'click');
    Event.observe(this.OBJECT,'click',this.onDragEnd.bindAsEventListener(this));
}

function onDragEnd() {
    Event.stopObserving(this.OBJECT,'click');
    Event.observe(this.OBJECT,'click',this.PREVIOUSFUNCTION.bindAsEventListener(this));
} 
```

这将捕获在 enddrag 之后仍然处于活动状态的剩余单击事件，以重新创建原始处理程序。我希望这可以帮助那里的人:)

# sql-server - SQL Server 是否应该与您的 IIS 安装在同一台机器上？

> ID：274846
> 
> 赞同：23
> 
> 时间：2008-11-08T15:49:22.663
> 
> 标签：sql-server, iis, windows-server-2003

我正在收听 podcast #19，Joel 和 Jeff 正在争论在与您的 IIS 安装相同的机器上运行 SQL Server。我不得不说，这听起来像是 Jeff 对 Joel 弃牌了，但话又说回来，我只是在猜测哪个是哪个。;)

各自的优缺点是什么？哪个更好？

我通常单独运行它们（Joel 的偏好），但我可以看到 Jeff 的观点，即两者之间的距离更近。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-08T15:58:34.827

出于**安全目的**，最好将 Web 和数据库机器分开，最好在两者之间设置防火墙。Web 服务器向整个世界公开。不幸的是，有些人乐于窃取或破坏这些服务器上包含的信息。

然后是**性能方面**。众所周知，SQL Server 喜欢内存。IIS 也是如此，尤其是当网站大量使用缓存和会话信息时。所以你在这里也有潜在的冲突。为 SQL Server 配备一台专用机器显然比让一台机器完成所有负载要好。

然后，分离可以**更容易地识别调整的需要**和调整单个硬件组件的能力。

总而言之，一台足够强大的机器可以同时满足实时环境中 IIS 和 SQL Server 的需求，**不一定比**为每个服务器的特定要求指定的两台机器便宜。*（Jeff Atwood 在其中一个播客中提到，升级一台机器的成本与购买第二台机器的成本相同）*。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-08T21:04:59.453

@MarkR

通过将 SQL Server 移动到另一个盒子确实增强了安全性，这与暴露的攻击面有关。

Web 服务器暴露于来自 Internet 的恶意访问。人们希望它永远不会发生，但已经存在（并且将来可能存在）可以通过穿越防火墙的格式错误的请求来利用的漏洞。

利用其中一个漏洞可能导致任意代码能够执行。

如果 Web 服务器以这种方式受到威胁，那么在该机器上运行的任何其他东西现在都容易受到攻击，并且漏洞利用软件可能会在特权上下文中运行。受感染机器的攻击面要广泛得多。

如果 SQL Server 安装在同一台机器上，任何数据库都容易受到攻击。

现在，如果 SQL Server 安装在单独的机器上，它本身只能通过其公共接口访问。数据库的附加表面仅限于该接口。因此，要破坏数据库，您现在必须首先破坏 Web 服务，然后是 SQL Server。这比将它们放在同一台机器上要困难得多。

进一步扩展原理，它也是使用存储过程的一个论据。如果 Web 服务器只能使用存储过程访问数据库服务器，那么接口和攻击面就会受到很大限制。如果 Web 服务器能够对数据库服务器执行任意 SQL，那么攻击面就会再次变得更大，并且数据的风险也会大大增加。

在数据有价值的系统中，这些风险虽然相对较小，但却非常真实，确定此类风险的业务风险是解决方案设计的一个重要方面。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-08T16:35:28.997

将它们放在同一台机器上：

*   减少它们之间的延迟 - 因此，如果您有很多简单的查询，这可以提高性能
*   使您的开发和性能测试更容易，因为您可以使用单个盒子（或 VM）来完成它

如果应用程序不需要冗余并且不需要横向扩展，那么将它们放在同一个盒子上是绝对的胜利 - 它更容易维护。

我认为安全论点没有任何意义——我认为将它们分开没有任何安全好处。Web 服务器需要对数据库有足够的访问权限才能查看和修改全部或大部分数据，因此如果它完全受到攻击，SQL 框也会受到有效攻击。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-09-27T14:52:13.380

对于非常敏感的站点，在它们之间使用防火墙的单独服务器的优势可能很有用，但它带来了许多问题。

1.  拆分 IIS 上的查询性能 - 由于需要通过网络传递数据，SQL 服务器可能运行非常缓慢，即使服务器相距 2 英尺，DNS 也可能仍然是一个因素，因此可能需要做一些工作才能让应用程序工作以及分裂。
2.  管理。这可能很明显，但它的 2 个服务器、2 个 Windows 许可证和所涉及的管理以及穿越防火墙的复杂性。

拆分服务器建议：

1.  在服务器之间安装千兆 LAN。
2.  优化查询以作为存储过程运行
3.  优化查询以仅返回最少量的数据。
4.  确保服务器间寻址使用 IP 地址或有效的 DNS 查找。
5.  为 SQL 负载提供足够的临时结果。

# asp.net-2.0 - 有没有一种简单的方法来清除 ASP.NET 表单？

> ID：274857
> 
> 赞同：11
> 
> 时间：2008-11-08T15:59:56.090
> 
> 标签：asp.net-2.0

有没有一种简单的方法可以重置 asp.net 表单中的所有文本字段——比如 html 控件的重置按钮？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-08T16:07:47.307

取决于您对重置的定义。做这样的事情的一个简单方法可能是一个带有代码隐藏的按钮：

```
Response.Redirect(Request.Url.PathAndQuery, true); 
```

或其变体。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-22T10:21:42.767

这对我有用：

```
<asp:Button ID="btnReset" runat="server" Text="Reset" 
OnClientClick="this.form.reset();return false;" /> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-15T21:59:40.093

```
<input type="reset" value="Clear" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T16:03:48.437

使用 javascript，您可以执行以下操作：

```
document.forms[0].reset(); 
```

或者

```
theForm.reset();  // at least with ASP.NET 2.0 
```

如在

```
<input type='button' id='resetButton' value='Reset' onclick='theForm.reset();return false;' //> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T16:03:01.713

此处列出了一些解决方案：

[在 ASP.Net 中清除表格](http://www.webdeveloper.com/forum/archive/index.php/t-42337.html)

> 我在 ASP.Net 中寻找相同的解决方案来清除我的点击表单，然后我登陆了这篇文章。我看了所有的评论和回复。我决定使用普通的旧输入标签并创建一个 HTML 重置按钮。它就像一个魅力，没有回发，不是 javascripts。如果有任何问题，我找不到它......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T16:50:27.780

这应该有效：

```
function resetForm() 
{ 
   var inputs = document.getElementsByTagName('input'); 
   for(var i=0;i<inputs.length;i++) 
   { 
       if(input[i].type == 'text')
          input[i].value = "";
   }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-05T14:56:13.600

在提交时清除表单中所有控件的最简单方法是：

```
form1.Controls.Clear() 
```

# c# - 将目录复制到输出目录 - 控制台应用程序 .NET

> ID：274859
> 
> 赞同：4
> 
> 时间：2008-11-08T16:01:01.920
> 
> 标签：c#, include, directory, copy

有没有办法将整个目录复制到 C#.NET 控制台应用程序中的输出目录？

我知道对于文件，您可以右键单击它们、属性并标记复制到输出目录。但我不会为 20.000 个文件这样做......

谢谢，Lieven Cardoen 又名 Johlero

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T17:29:09.137

1.  在开发过程中，使用应用程序配置来指向这些文件当前所在的位置，而不是复制它们。（在每个构建上复制那么多对象是一场噩梦。即使只复制新的/更新的文件）

2.  在准备发布版本时，您可能需要考虑使用构建脚本和 MSBuild 或 NAnt 为您执行此类操作。

3.  如果你真的确信你仍然想在每个构建上执行一个副本 - 使用 Post/pre-build 脚本（在你的项目构建配置中，指向一个执行 xcopy 的批处理文件.. 一些智能批处理脚本有时可以很有帮助）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T16:30:01.113

您确定要输出所有 20000 个文件吗？

除了手动复制粘贴操作，我看到两个选项：一个是您可以有一个构建后任务来复制所有文件，另一个是压缩 20000 个文件，将 zip 文件作为内容项添加到您的项目中，并使用“始终复制”设置和控制台应用程序解压缩它们，或者构建后步骤正在调用解压缩实用程序来执行此操作。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-11-08T16:04:04.893

您可以按 ctrl+A 突出显示所有这些，然后按 ctrl+C 复制它们，然后转到新目录并按 ctrl+V 将它们全部粘贴到新位置...

或者您可以打开命令窗口并使用复制...但第一种方法可能更容易。

# c++ - 如何计算给定日期的周数？

> ID：274861
> 
> 赞同：30
> 
> 时间：2008-11-08T16:02:59.827
> 
> 标签：c++, windows, algorithm, time

如果我有一个日期，我如何计算该日期在该年的周数？

例如，在 2008 年，1 月 1 日到 1 月 6 日是第 1 周，1 月 7 日到 13 日是第 2 周，所以如果我的日期是 2008 年 1 月 10 日，我的周数将是 2。

一个算法可以很好地帮助我入门，示例代码也会有所帮助——我正在 Windows 上使用 C++ 进行开发。

### 有关的：

> [在 MS SQL Server 2005 中获取日期的周数？](https://stackoverflow.com/questions/348880/getting-week-number-off-a-date-in-ms-sql-server-2005)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-08T18:31:03.523

请注意，虽然您对一年中*第 n*周的定义是成立的，但它也不是“标准”。

ISO 8601 定义了日期、时间和时区表示的标准。它定义了从星期一开始的星期。它还说一年的第一周是从给定年份起至少包含 4 天的那一周。因此，20xx 年 12 月 29 日、30 日和 31 日可能在 20xy 的第 1 周（其中 xy = xx + 1），而 20xy 的 1 月 1 日、2 日和 3 日都可能在 20xx 的最后一周。此外，可能有第 53 周。

[*补充*：请注意，C 标准和`strftime() 函数提供从星期日开始的星期以及从星期一开始的星期。尚不清楚 C 标准是否为基于星期日的周提供第 0 周的年份数。另见 Emerick Rogul 的回答。]

然后是有趣的测试阶段——你什么时候到达第 53 周？一个答案是 2010 年 1 月 1 日星期五，也就是 2009-W53（实际上是 2010 年 1 月 3 日星期日）。同样，2005 年 1 月 1 日星期六是 2004-W53，但 2006 年 1 月 1 日星期日是 2005-W52。

这是从以下代码中的注释中摘录的，它实际上是在 Informix SPL（存储过程语言）中，但是是可读的——尽管可能不可写——没有更多的解释。'||' operator 是 SQL 字符串连接操作，星期日是第 0 天，星期一是第 1 天，...星期六是一周的第 6 天。评论中有大量注释，包括标准中的相关文本。一行注释开始' `--`'; 多行注释可能以 ' `{`' 开始并在下一个 ' `}`' 结束。

```
-- @(#)$Id: iso8601_weekday.spl,v 1.1 2001/04/03 19:34:43 jleffler Exp $
--
-- Calculate ISO 8601 Week Number for given date
-- Defines procedure: iso8601_weekday().
-- Uses procedure: iso8601_weeknum().

{
According to a summary of the ISO 8601:1988 standard "Data Elements and
Interchange Formats -- Information Interchange -- Representation of
dates and times":

    The week notation can also be extended by a number indicating the
    day of the week.  For example the day 1996-12-31 which is the
    Tuesday (day 2) of the first week of 1997 can also be written as

        1997-W01-2 or 1997W012

    for applications like industrial planning where many things like
    shift rotations are organized per week and knowing the week number
    and the day of the week is more handy than knowing the day of the
    month.

This procedure uses iso8601_weeknum() to format the YYYY-Www part of the
date, and appends '-d' to the result, allowing for Informix's coding of
Sunday as day 0 rather than day 7 as required by ISO 8601.
}

CREATE PROCEDURE iso8601_weekday(dateval DATE DEFAULT TODAY) RETURNING CHAR(10);
    DEFINE rv CHAR(10);
    DEFINE dw CHAR(4);
    LET dw = WEEKDAY(dateval);
    IF dw = 0 THEN
            LET dw = 7;
    END IF;
    RETURN iso8601_weeknum(dateval) || '-' || dw;
END PROCEDURE;
-- @(#)$Id: iso8601_weeknum.spl,v 1.1 2001/02/27 20:36:25 jleffler Exp $
--
-- Calculate ISO 8601 Week Number for given date
-- Defines procedures: day_one_week_one() and iso8601_weeknum().

{
According to a summary of the ISO 8601:1988 standard "Data Elements and
Interchange Formats -- Information Interchange -- Representation of
dates and times":

    In commercial and industrial applications (delivery times,
    production plans, etc.), especially in Europe, it is often required
    to refer to a week of a year.  Week 01 of a year is per definition
    the first week which has the Thursday in this year, which is
    equivalent to the week which contains the fourth day of January.  In
    other words, the first week of a new year is the week which has the
    majority of its days in the new year.  Week 01 might also contain
    days from the previous year and the week before week 01 of a year is
    the last week (52 or 53) of the previous year even if it contains
    days from the new year.  A week starts with Monday (day 1) and ends
    with Sunday (day 7).  For example, the first week of the year 1997
    lasts from 1996-12-30 to 1997-01-05 and can be written in standard
    notation as

        1997-W01 or 1997W01

    The week notation can also be extended by a number indicating the
    day of the week.  For example the day 1996-12-31 which is the
    Tuesday (day 2) of the first week of 1997 can also be written as

        1997-W01-2 or 1997W012

    for applications like industrial planning where many things like
    shift rotations are organized per week and knowing the week number
    and the day of the week is more handy than knowing the day of the
    month.

Referring to the standard itself, section 3.17 defines a calendar week:

    week, calendar: A seven day period within a calendar year, starting
    on a Monday and identified by its ordinal number within the year;
    the first calendar week of the year is the one that includes the
    first Thursday of that year.  In the Gregorian calendar, this is
    equivalent to the week which includes 4 January.

Section 5.2.3 "Date identified by Calendar week and day numbers" states:

    Calendar week is represented by two numeric digits.  The first
    calendar week of a year shall be identified as 01 [...]

    Day of the week is represented by one decimal digit.  Monday
    shall be identified as day 1 of any calendar week [...]

Section 5.2.3.1 "Complete representation" states:

    When the application clearly identifies the need for a complete
    representation of a date identified by calendar week and day
    numbers, it shall be one of the alphanumeric representations as
    follows, where CCYY represents a calendar year, W is the week
    designator, ww represents the ordinal number of a calendar week
    within the year, and D represents the ordinal number within the
    calendar week.

    Basic format: CCYYWwwD
        Example: 1985W155
    Extended format: CCYY-Www-D
        Example: 1985-W15-5

Both the summary and the formal definition are intuitively clear, but it
is not obvious how to translate it into an algorithm.  However, we can
deal with the problem by exhaustively enumerating the seven options for
the day of the week on which 1st January falls (with actual year values
for concreteness):

    1st January 2001 is Monday    => Week 1 starts on 2001-01-01
    1st January 2002 is Tuesday   => Week 1 starts on 2001-12-31
    1st January 2003 is Wednesday => Week 1 starts on 2002-12-30
    1st January 2004 is Thursday  => Week 1 starts on 2003-12-29
    1st January 2010 is Friday    => Week 1 starts on 2010-01-04
    1st January 2005 is Saturday  => Week 1 starts on 2005-01-03
    1st January 2006 is Sunday    => Week 1 starts on 2006-01-02

(Cross-check: 1st January 1997 was a Wednesday; the summary notes state
that week 1 of 1997 started on 1996-12-30, which is consistent with the
table derived for dates in the first decade of the third millennium
above).

When working with the Informix DATE types, bear in mind that Informix
uses WEEKDAY values 0 = Sunday, 1 = Monday, 6 = Saturday.  When the
weekday of the first of January has the value in the LH column, you need
to add the value in the RH column to the 1st of January to obtain the
date of the first day of the first week of the year.

    Weekday         Offset to
    1st January     1st day of week 1

    0               +1
    1                0
    2               -1
    3               -2
    4               -3
    5               +3
    6               +2

This can be written as MOD(11-w,7)-3 where w is the (Informix encoding
of the) weekday of 1st January and the value 11 is used to ensure that
no negative values are presented to the MOD operator.  Hence, the
expression for the date corresponding to the 1st day (Monday) of the 1st
week of a given year, yyyy, is:

    d1w1 = MDY(1, 1, yyyy) + MOD(11 - WEEKDAY(MDY(1,1,yyyy)), 7) - 3

This expression is encapsulated in stored procedure day_one_week_one:
}

CREATE PROCEDURE day_one_week_one(yyyy INTEGER) RETURNING DATE;
    DEFINE jan1 DATE;
    LET jan1 = MDY(1, 1, yyyy);
    RETURN jan1 + MOD(11 - WEEKDAY(jan1), 7) - 3;
END PROCEDURE;

{
Given this date d1w1, we can calculate the week number of any other date
in the same year as:

    TRUNC((dateval - d1w1) / 7) + 1

The residual issues are ensuring that the wraparounds are correct.  If
the given date is earlier than the start of the first week of the year
that contains it, then the date belongs to the last week of the previous
year.  If the given date is on or after the start of the first week of
the next year, then the date belongs to the first week of the next year.

Given these observations, we can write iso8601_weeknum as shown below.
(Beware: iso8601_week_number() is too long for servers with the
18-character limit; so is day_one_of_week_one()).

Then comes the interesting testing phase -- when do you get week 53?
One answer is on Friday 1st January 2010, which is in 2009-W53 (as,
indeed, is Sunday 3rd January 2010).  Similarly, Saturday 1st January
2005 is in 2004-W53, but Sunday 1st January 2006 is in 2005-W52.
}

CREATE PROCEDURE iso8601_weeknum(dateval DATE DEFAULT TODAY) RETURNING CHAR(8);
    DEFINE rv CHAR(8);
    DEFINE yyyy CHAR(4);
    DEFINE ww CHAR(2);
    DEFINE d1w1 DATE;
    DEFINE tv DATE;
    DEFINE wn INTEGER;
    DEFINE yn INTEGER;
    -- Calculate year and week number.
    LET yn = YEAR(dateval);
    LET d1w1 = day_one_week_one(yn);
    IF dateval < d1w1 THEN
        -- Date is in early January and is in last week of prior year
        LET yn = yn - 1;
        LET d1w1 = day_one_week_one(yn);
    ELSE
        LET tv = day_one_week_one(yn + 1);
        IF dateval >= tv THEN
            -- Date is in late December and is in the first week of next year
            LET yn = yn + 1;
            LET d1w1 = tv;
        END IF;
    END IF;
    LET wn = TRUNC((dateval - d1w1) / 7) + 1;
    -- Calculation complete: yn is year number and wn is week number.
    -- Format result.
    LET yyyy = yn;
    IF wn < 10 THEN
        LET ww = '0' || wn;
    ELSE
        LET ww = wn;
    END IF
    LET rv = yyyy || '-W' || ww;
    RETURN rv;
END PROCEDURE; 
```

* * *

为了完整起见，反函数也很容易用`day_one_week_one()`上面的函数编写：

```
-- @(#)$Id: ywd_date.spl,v 1.1 2012/12/29 05:13:27 jleffler Exp $
-- @(#)Create ywd_date() and ywdstr_date() stored procedures

-- Convert a date in format year, week, day (ISO 8601) to DATE.
-- Two variants:
-- ywd_date(yyyy SMALLINT, ww SMALLINT, dd SMALLINT) RETURNING DATE;
-- ywdstr_date(ywd CHAR(10)) RETURNING DATE;

-- NB: If week 53 is supplied, there is no check that the year had week
--     53 (GIGO).
-- NB: If year yyyy is a leap year and yyyy-01-01 falls on Wed (3) or
--     Thu (4), there are 53 weeks in the year.
-- NB: If year yyyy is not a leap year and yyyy-01-01 falls on Thu (4),
--     there are 53 weeks in the year.

CREATE PROCEDURE ywd_date(yyyy SMALLINT, ww SMALLINT, dd SMALLINT) RETURNING DATE AS date;
    DEFINE d DATE;
    -- Check ranges
    IF yyyy < 1 OR yyyy > 9999 OR ww < 1 OR ww > 53 OR dd < 1 OR dd > 7 THEN
        RETURN NULL;
    END IF;
    LET d = day_one_week_one(yyyy);
    LET d = d + (ww - 1) * 7 + (dd - 1);
    RETURN d;
END PROCEDURE;

-- Input: 2012-W52-5
CREATE PROCEDURE ywdstr_date(ywd CHAR(10)) RETURNING DATE AS date;
    DEFINE yyyy SMALLINT;
    DEFINE ww   SMALLINT;
    DEFINE dd   SMALLINT;
    LET yyyy = SUBSTR(ywd,  1, 4);
    LET ww   = SUBSTR(ywd,  7, 2);
    LET dd   = SUBSTR(ywd, 10, 1);
    RETURN ywd_date(yyyy, ww, dd);
END PROCEDURE;

CREATE TEMP TABLE test_dates(d DATE);
INSERT INTO test_dates VALUES('2011-12-28');
INSERT INTO test_dates VALUES('2011-12-29');
INSERT INTO test_dates VALUES('2011-12-30');
INSERT INTO test_dates VALUES('2011-12-31');
INSERT INTO test_dates VALUES('2012-01-01');
INSERT INTO test_dates VALUES('2012-01-02');
INSERT INTO test_dates VALUES('2012-01-03');
INSERT INTO test_dates VALUES('2012-01-04');
INSERT INTO test_dates VALUES('2012-01-05');
INSERT INTO test_dates VALUES('2012-01-06');
INSERT INTO test_dates VALUES('2012-01-07');

SELECT d, iso8601_weeknum(d), iso8601_weekday(d), ywdstr_date(iso8601_weekday(d))
  FROM test_dates
 ORDER BY d; 
```

正如评论中所指出的，代码将接受第 53 周的日期，即使一年应该只接受 52 周。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-08T16:35:31.383

伪代码：

```
int julian = getDayOfYear(myDate)  // Jan 1 = 1, Jan 2 = 2, etc...
int dow = getDayOfWeek(myDate)     // Sun = 0, Mon = 1, etc...
int dowJan1 = getDayOfWeek("1/1/" + thisYear)   // find out first of year's day
// int badWeekNum = (julian / 7) + 1  // Get our week# (wrong!  Don't use this)
int weekNum = ((julian + 6) / 7)   // probably better.  CHECK THIS LINE. (See comments.)
if (dow < dowJan1)                 // adjust for being after Saturday of week #1
    ++weekNum;
return (weekNum) 
```

为了澄清，这个算法假设你像这样对你的周数进行编号：

```
S  M  T  W  R  F  S
            1  2  3    <-- week #1
4  5  6  7  8  9 10    <-- week #2
[etc.] 
```

getDayOfWeek() 和 getDayOfYear() 是大多数语言中的标准日期对象操作。如果你没有它们，你可以从某个已知日期（1970 年 1 月 1 日是一个常见的日期）开始倒计时，然后查看它是星期几。

如果您要实现自己的日期计数例程，请记住能被 100 整除的年份**不是**闰年，除非它们也能被 400 整除。所以 1900 年不是闰年，但 2000 年是闰年。如果您要在很久以前工作，则必须弄乱公历和儒略历等，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Calendar_reform)以获取大量信息。

[此链接](http://www.codeproject.com/KB/datetime/datetimedisc.aspx)更详细地讨论了 Windows/C++ 中的日期/时间函数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-08T19:14:16.710

我强烈建议使用 C 标准库的时间函数来计算周数。具体来说，该`strftime`函数具有说明符，用于以分解 ( `struct tm`) 格式打印给定日期的周数（以及许多其他值）。这是一个说明这一点的小示例程序：

```
#include <stdio.h>
#include <string.h>
#include <time.h>

int
main(void)
{
  struct tm tm;
  char timebuf[64];

  // Zero out struct tm
  memset(&tm, 0, sizeof tm);

  // November 4, 2008 11:00 pm
  tm.tm_sec = 0;
  tm.tm_min = 0;
  tm.tm_hour = 23;
  tm.tm_mday = 4;
  tm.tm_mon = 10;
  tm.tm_year = 108;
  tm.tm_isdst = -1;

  // Call mktime to recompute tm.tm_wday and tm.tm_yday
  mktime(&tm);

  if (strftime(timebuf, sizeof timebuf, "%W", &tm) != 0) {
    printf("Week number is: %s\n", timebuf);
  }

  return 0;
} 
```

该程序的输出（在 Linux 上使用 GCC 和在 Windows 上使用 Microsoft Visual Studio 2005 SP1 编译）是：

> ```
> Week number is: 44 
> ```

[您可以在此处](http://msdn.microsoft.com/en-us/library/fe06s4ak(VS.80).aspx)了解有关 strftime的更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-08T19:42:40.243

struct tm 用于表示“故障停机时间”，至少有以下字段：

```
int tm_sec 秒 [0,60]。
int tm_min 分钟 [0,59]。
int tm_hour 小时 [0,23]。
int tm_mday 日期 [1,31]。
int tm_mon 一年中的月份 [0,11]。
int tm_year 自 1900 年以来的年份。
int tm_wday 星期[0,6]（星期日=0）。
int tm_yday 一年中的某一天 [0,365]。
int tm_isdst 夏令时标志。

```

您可以使用 localtime() 函数从 time_t 创建 struct tm。

您可以使用 mktime() 函数从 struct tm 创建 time_t。

关于 struct tm 最好的部分是你可以做一些事情，比如将 24 添加到一年中的月份成员中，当你调用 mktime() 时，你会得到一个 time_t ，那就是未来 2 年（这适用于它的任何成员，所以例如，您可以将小时增加 1000，然后在未来 41 天获得 time_t)...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T09:52:21.167

抱歉，我是新来的，无法对答案本身发表评论，但是带有复选标记的答案中的伪代码并不完全正确。

> 伪代码：

```
int julian = getDayOfYear(myDate)  // Jan 1 = 1, Jan 2 = 2, etc...
int dow = getDayOfWeek(myDate)     // Sun = 0, Mon = 1, etc...
int dowJan1 = getDayOfWeek("1/1/" + thisYear)   // find out first of year's day
int weekNum = (julian / 7) + 1     // Get our week#
if (dow < dowJan1)                 // adjust for being after Saturday of week #1
    ++weekNum;
return (weekNum) 
```

您不应该寻找“一年的第一天”，而应该寻找去年的最后一天。

```
getDayOfWeek("12/31/" + thisYear-1) 
```

将是正确的，而不是

```
getDayOfWeek("1/1/" + thisYear) 
```

如果您不这样做，去年的最后一个工作日（如星期一）总是会提前一周。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T16:37:55.560

使用 gmtime 或 localtime 计算自星期日（即一周中的某天）以来的天数和自 1 月 1 日以来的天数（请注意，后者中的 Jan 1 为“0”）。

任意位决定第 1 周从一年中的哪一天开始：通常它只取决于 1 月 1 日是一周中的哪一天，当然你可以从 gmtime 的两条信息中计算出来。然后使用表查找来查找 7 种可能性，这可能比编写规则更容易。

例如，我认为 Outlook 使用的标准是第 1 周是包含星期四的第一周。因此，如果 1 月 1 日是星期日，那么第 1 周的第一天就是 1 月 1 日，即第 0 天。剩下的可能性是星期一，-1；星期二，-2；星期三，-3；星期四，-4；星期五，2；星期六，1。

注意负数：“第 1 周的星期日”实际上并不存在于 7 个案例中的 4 个，但如果我们假装它是前一年的一天，我们就会得到正确的答案。

一旦你有了它，它和你的日期之间的天数就会告诉你周数：除以 7 并加 1。

也就是说，我想在某个地方有一个 Windows API 可以为您提供与 Outlook 使用的相同的周数。我只是不知道它是什么，当然，如果您的第 1 周规则与 Outlook 的不同，那么它可能没有多大用处。

未经测试的代码：

```
int firstdays[7] = { 0, -1, -2, -3, -4, 2, 1 }; // or some other Week 1 rule
struct tm breakdown;
time_t target = time_you_care_about();
_gmtime_s(&breakdown,&target);
int dayofweek = breakdown.tm_wday;
int dayofyear = breakdown.tm_yday;

int jan1wday = (dayofweek - dayofyear) % 7;
if (jan1wday < 0) jan1wday += 7;

int week1first = firstdays[jan1wday];
if (dayofyear < week1first) return 0;
return ((dayofyear - week1first)/7) + 1; 
```

反正就是这样。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-11T21:02:51.650

我的定义是非 ISO 8601（对我的目的来说足够好并且速度很快）：

```
// week number of the year
// (Monday as the first day of the week) as a decimal number [00,53].
// All days in a new year preceding the first Monday are considered to be in week 0.
int GetWeek(const struct tm& ts)
{
    return (ts.tm_yday + 7 - (ts.tm_wday ? (ts.tm_wday - 1) : 6)) / 7;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-14T06:11:24.613

```
public int GetWeekOfYear(DateTime todayDate)
{
    int days = todayDate.DayOfYear;
    float result = days / 7;
    result=result+1;
    Response.Write(result.ToString());
    return Convert.ToInt32(result);
} 
```

只需将当前日期作为参数传递给此函数。然后你会得到当前的周数。希望它能解决你的问题。非常欢迎任何建议。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-04T21:46:30.267

`iso_week.h`从[howardhinnant.github.io/iso_week.html](http://howardhinnant.github.io/iso_week.html)使用这很容易实现：

```
#include <iostream>
#include "iso_week.h"

int main() {
    using namespace iso_week;
    using namespace std::chrono;
    // Get the current time_point and floor to convert to the sys_days:
    auto today = floor<days>(system_clock::now());
    // Convert from sys_days to iso_week::year_weeknum_weekday format
    auto yww = year_weeknum_weekday{today};
    // Print current week number of the year
    std::cout << "The current week of " << yww.year() << " is: " 
              << yww.weeknum() << std::endl;

    // Set any day
    auto any_day = 2014_y/9/28;
    // Get week of `any_day`
    std::cout << "The week of " << any_day.year() << " on `any day` was: " 
              << any_day.weeknum() << std::endl;   
} 
```

输出是：

```
The current week of 2019 is: W18
The week in 2014 on `any day` was: W09 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-03-04T16:58:58.413

```
/**********************************************************************************
Function Name: rtcCalcYearWeek
Description  : Function to calculate the working week of the year (changing on a Monday)
Arguments    : IN  iYear - The year 2000...
               IN  iMonth - The month 1..12
               IN  iDay - The day 1..31
               IN  iWeekDay - The week day 0 = Monday ... 6 = Sunday
Return Value : The year week 1..52
***********************************************************************************/
int rtcCalcYearWeek(int iYear, int iMonth, int iDay, int iWeekDay)
{
    int iLeap = 0;
    static const int ppiYearDays[2][13] =
    {
         /* Normal year */
         {0, 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334},
         /* Leap year */
         {0, 0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335}
    };
    /* Check for leap year */
    if (((iYear % 4) == 0) && (((iYear % 100) != 0) || ((iYear % 400) == 0)))
    {
        iLeap = 1;
    }
    /* Calculate the year week */
    return (((ppiYearDays[iLeap][iMonth] + iDay) - (iWeekDay + 7) % 7 + 7) / 7) + 1;
}
/***********************************************************************************
End of function  rtcCalcYearWeek
***********************************************************************************/

/**********************************************************************************
* Function Name: rtcCalcWeekDay
* Description  : Function to calculate the week day for a given date from 2000
*                to 2099.
* Arguments    : IN  iDay - The day 1..31
*                IN  iMonth - The month 1..12
*                IN  iYear - The year 2000..2099
* Return Value : The weekday 0 = Monday ... 6 = Sunday
***********************************************************************************/
int rtcCalcWeekDay(int iDay, int iMonth, int iYear)
{
    if (iMonth < 3)
    {
        iMonth += 12;
        iYear -= 1;
    }
    return (iDay + (2 * iMonth) + (6 * (iMonth + 1) / 10) + iYear 
            + (iYear / 4)- (iYear / 100) + (iYear / 400)) % 7;
}
/***********************************************************************************
End of function  rtcCalcWeekDay
***********************************************************************************/ 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-19T12:53:19.627

Boost 提供 gregorian::date::week_number() 见[http://www.boost.org/doc/libs/1_38_0/doc/html/boost/gregorian/date.html](http://www.boost.org/doc/libs/1_38_0/doc/html/boost/gregorian/date.html)和 [http://www.boost.org/ doc/libs/1_38_0/boost/date_time/gregorian/greg_date.hpp](http://www.boost.org/doc/libs/1_38_0/boost/date_time/gregorian/greg_date.hpp)。

但是我看不到一种方法来获取与周数匹配的年数（这可能与该日期的日历年不同）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-26T18:27:09.343

我的假设是，如 Olie 的回答所示，一年中的第一周最多可能包含 7 天。该代码不处理一周从星期日开始的另一天的文化，这是世界的很大一部分。

```
tm t = ... //the date on which to find week of year

int wy = -1;

struct tm t1;
t1.tm_year = t.tm_year;
t1.tm_mday = t1.tm_mon = 1; //set to 1st of January
time_t tt = mktime(&t1); //compute tm

//remove days for 1st week
int yd = t.tm_yday - (7 - t1.tm_wday);
if(yd <= 0 ) //first week is now negative
  wy = 0;
else
  wy = (int)std::ceil( (double) ( yd/7) ); //second week will be 1 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-23T10:27:04.953

```
time_t t = time(NULL);
tm* timePtr = localtime(&t);
double day_of_year=timePtr->tm_yday +1 ; // 1-365
int week_of_year =(int) ceill(day_of_year/7.0); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-03-22T09:33:30.520

这是我的解决方案，但它不在 C++ 中

```
NoOfDays = (CurrentDate - YearStartDate)+1
IF NoOfDays MOD 7 = 0 Then
    WeekNo = INT(NoOfDays/7)
ELSE
    WeekNo = INT(NoOfDays/7)+1
END 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2015-12-23T14:29:11.403

```
/**
 * @brief WeekNo
 * @param yr
 * @param mon
 * @param day
 * @param iso
 * @return
 *
 *  Given a date, return the week number
 *  Note. The first week of the year begins on the Monday
 *  following the previous Thursday
 *  Follows ISO 8601
 *
 *  Mutually equivalent definitions for week 01 are:
 *
 *  the week with the year's first Thursday in it (the ISO 8601 definition)
 *  the week with the Thursday in the period 1 – 7 January
 *  the week starting with the Monday in the period 29 December – 4 January
 *  the week starting with the Monday which is nearest in time to 1 January
 *  the week ending with the Sunday in the period 4 – 10 January
 *  the week with 4 January in it
 *  the first week with the majority (four or more) of its days in the starting year
 *    If 1 January is on a Monday, Tuesday, Wednesday or Thursday, it is in week 01.
 *    If 1 January is on a Friday, Saturday or Sunday, it is part of week 52 or 53 of the previous year.
 *    the week with the year's first working day in it (if Saturdays, Sundays, and 1 January are not working days).
 ***    strftime has a conversion of struct tm to weeknumber.  strptime fills in tm struct**
 *   Code uses strptime, strftime functions.
 */

int WeekNo( int yr,int mon, int day, int iso)
{
    struct tm tm;
    char format[32];
    //memset(tm,0,sizeof(tm));
    sprintf(format,"%d-%02d-%02d",yr,mon,day);
    strptime(format, "%Y-%m-%d", &tm);
    // structure tm is now filled in for strftime

   strftime(format, sizeof(format), iso? "%V":"%U", &tm);

    //puts(format);
    return atoi(format);
} 
```

调用为 Weekno(2015,12,23,1); //对于 ISO 周数。Weekno(2015,12,23,0) //对于非 ISO 周数

# c - `int *userMask[3][4]` 指向什么？

> ID：274865
> 
> 赞同：25
> 
> 时间：2008-11-08T16:03:41.930
> 
> 标签：c, arrays, pointers

我正在修改一些代码，遇到了一个我无法理解的声明：

```
int *userMask[3][4] = {0}; 
```

这具体指的是什么？它是一个矩阵，其中每个元素都是一个指针吗？还是它指向一个大小为 [3][4] 的矩阵？

谢谢

* * *

我想我的问题是`userMask[2][maskElement][user]`当它被声明为`int`. userMask 不是必须让它`int[]`正常工作吗？我一定没有理解这个权利...

另外，感谢您对 cdecl Robert 的建议。但是，有谁知道如何在 XP 命令提示符下使用它？我能得到的只是语法错误:(

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-08T17:02:19.380

## 简短的回答

给定 userMask 被声明为

```
int *userMask[3][4]; 
```

然后`userMask`有类型`int*[3][4]`。这是一个指向 int 的二维指针数组。外部维度的大小为 3，内部维度的大小为 4。实际上无非就是一个 3 元素一维数组，其元素类型是另一个 4 元素一维数组，其元素类型为`int*`。

## 步骤说明

所以如果你这样做

```
userMask[2][maskElement][user] 
```

然后基本上使用前两个索引从二维数组中选择特定指针：

```
int * p = userMask[2][maskElement]; 
```

然后你选择一个 int 从那个指针偏移的地方做

```
p[user] 
```

现在该代码全部在`userMask[2][maskElement][user]`.

## 有效的 C 代码

使用有效的 c 代码逐步完成此操作（如果您不了解以下所有内容，请不要担心）：

```
int * userMask[3][4] = { { 0 } };
int ** pa = userMask[2]; /* int*[4] becomes int** implicitly */
int * pi = pa[maskElement];
int i = pi[user];

assert(i == userMask[2][maskElement][user]); 
```

## 数组和指针的区别

所以我想我向你展示了一些重要的东西。上面的数组*不*包含指向数组的指针。让我们看看它们的行为有多么不同，这是许多 c 程序员没有想到的：

```
int array[5][4][3];
/* int[4][3] implicitly converts to int(*)[3] (pointer to first element) */
int (*parray)[3] = array[0]; 
int ** pint = (int**) array[0]; /* wrong!! */ 
```

现在，如果我们执行`parray[1]`and会发生什么`pint[1]`？第一个将按`sizeof(int[3])`字节（`3 * sizeof(int)`）推进数组，第二个将仅按`sizeof( int* )`字节推进。所以实际上，虽然第一个给你正确的数组`array[0][1]`，第二个会给你`( char * )array[0] + sizeof( int* )`，这是我们真的不希望它出现的地方。但是抓住错误的偏移量并不是全部。因为它不知道访问了一个数组，所以它会尝试将 at 解释`pint[1]`为`int*`. 假设您的数组已使用`0x00`. 然后它将根据地址 0x00 执行下一个索引步骤（`pint[1][0]`例如）。哦不 - 完全未定义的行为！因此，强调差异非常重要。

## 结论

这超出了您的要求，但我认为了解这些细节非常重要。特别是如果您想将二维数组传递给函数，那么这些知识非常有用。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-08T16:07:33.280

这是一个二维数组，其中每个元素都是指向 a 的指针`int`，并且所有指针都初始化为零。

在您的后续行动中，您表明该数组的使用方式如下：

```
if(userMask[2][maskElement][user] && blah)
    result = true; 
```

在这种情况下，每个元素`userMask`实际上都应该指向一个`int`s 数组。（An`int*`可以指向单个`int`或一个 s 数组`int`）。要确定这一点，请检查将值分配给 的代码`userMask`。例如，可以这样写：

```
int userArray[2] = { 10, 20 };

userMask[0][0] = userArray; // userMask[0][0] points to the
                            // first element of userArray. 
```

然后以下代码索引到`userArray`：

```
int value = userMask[0][0][1]; // sets value = userArray[1], giving 20. 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-08T16:14:56.823

```
int *userMask[3][4] = {0}; 
```

是一个二维数组，其中每个成员都是指向 int 的指针。此外，所有成员都初始化为空指针。

```
int (*userMask)[3][4]; 
```

将是指向二维整数数组的指针。C 中的括号比 * 绑定得更紧密，因此需要括号来创建指向数组的指针。

`cdecl`是一个简单的实用程序，您可以下载它来解释复杂的声明：

```
cdecl> explain int *userMask[3][4]
declare userMask as array 3 of array 4 of pointer to int 
```

它也可以做相反的事情：

```
cdecl> declare userMask as pointer to array 3 of array 4 of int
int (*userMask)[3][4] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T17:45:15.610

```
if(userMask[2][maskElement][user] && blah)
   result = true; 
```

这里的第二部分是C中没有数组；只有指针算术。根据定义，总是`p[i]`等价于`*(p+i)`

```
userMask[2][maskElement][user] 
```

相当于

```
*((userMask[2][maskElement])+user) 
```

该代码在某处将一个向量（我敢打赌它来自 malloc(3c) 或类似调用）分配给该数组中的指针；现在你的如果在说

**如果**userMask[2][maskElement] 处向量的第用户元素非零

**THEN IF** blah 非零*（由于 && 的短路评估，如果第一个合取为 0，则不会评估第二个合取）*

**然后**设置结果 = true。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-08T17:34:39.907

应用由内而外的规则。

```
int *userMask[3][4] = {0}; 
```

从声明的内柱部分开始，

```
userMask 
```

是名字

```
userMask[3] 
```

为其中 3 个分配空间（是其中的一个向量）

```
userMask[3][4] 
```

`userMask[3]`为 4分配空间

```
int * 
```

告诉我们`userMask`项目是类型指针`int`

然后`= {0}`是一个初始化器，其中所有元素都是`0`. 所以

```
int *userMask[3][4] = {0}; 
```

是一个 3x4 的 int * 数组，初始化为 0。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T16:23:24.573

我认为该语句访问用户掩码数组的第三行，然后访问该行中的第 maskElement 指针，由于这是一个 int 指针，它可以指向一个 int 数组的开头（想想字符串），我假设它正在做，并且该数组由用户子索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-08T16:27:06.033

`userMask[2]`是类型的`int*[]`，
`userMask[2][maskElement]`是类型的`int*`，类型
也是如此。`userMask[2][maskElement][user]``int`

宣言

```
int *userMask[3][4] = {0}; 
```

是简写

```
int *userMask[3][4] = {{0, 0, 0}, {0, 0, 0}, {0, 0, 0}, {0, 0, 0}}; 
```

其中每个零都被隐式转换为`(int*)0`.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-08T17:02:27.710

如果您像这样阅读它会有所帮助：

```
type variablename[array_spec]; 
```

在这种情况下： int* usermask[3][4];

所以它是一个 int* 的矩阵。

现在，由于 c 不区分指针和数组，您可以对指针使用数组索引。

```
int* i;
int the_int_behind_i = *(i+1);
int also_the_int_behind_i = i[1]; 
```

这需要 i 指向一个区域，其中几个 int 相互排列，当然，就像一个数组。

请注意，最后一个示例中使用的索引运算符 [] 看起来像第一个示例中的 array_spec，但两者完全不同。

所以：userMask[2][maskElement][user]

选择存储在 [2][maskElement] 中的用户掩码指针，并为用户*用户评估它*

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-08T16:09:10.907

它是一个矩阵，其中每个元素都是一个指针。

如果它指向大小为 [3][4] 的矩阵，则代码将是

```
int userMask[3][4]={0}; 
```

# asp.net - 移动设备 Javascript/CSS 支持。外面有什么？

> ID：274868
> 
> 赞同：11
> 
> 时间：2008-11-08T16:06:10.413
> 
> 标签：asp.net, javascript, mobile-phones

我即将开始一个面向 iPhone、Blackberries 和 Windows Mobile 浏览器的 ASP.NET 应用程序。除了 iPhone，我还没有找到很多关于这些平台支持哪些技术的信息。

因为我习惯于为桌面浏览器进行开发，所以我喜欢使用 jQuery 和高级 CSS 功能之类的东西。看起来我将无法在移动平台上使用这些东西。

我想知道是否有人知道优秀的开发人员资源，我可以在其中找到适用于移动浏览器的内容（例如用于移动设备的[quirksmode.org](http://quirksmode.org)）。

据我所知，jQuery 不适用于移动浏览器（iPhone 除外）。有谁知道以某种形式将 jQuery 移植到移动浏览器的任何尝试？我说 jQuery 是因为这是我现有网站使用的，并且我想保持一致性，但如果有其他框架提供的产品，我也会有兴趣查看它们。

**更新**
我想更新这个，让任何人知道谁可能会偶然发现这个问题。运行网站 quirksmode.org 的人最近开始创建移动设备兼容性表。你可以在这里查看它们：

[http://quirksmode.org/m/](http://quirksmode.org/m/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T16:15:50.783

Microsoft 和 RIM 都提供了他们的移动操作系统的模拟器。我强烈建议下载它们。他们可以搭载主机操作系统并使用您的以太网连接来检索 URL 并将它们显示为真实世界的对应物。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T17:49:05.713

OS4.5 及更早版本的黑莓浏览器将不支持 jQuery。它几乎不支持任何类型的动态 HTML。OS 4.6 和更高版本（在 Bold、Pearl Flip、Storm 和更新的设备上）附带了一个新的渲染引擎，它对 DOM Level 2 和 CSS 有很好的支持。它并不完美，但是很多使用 jQuery 的东西应该可以工作。请注意，jQuery 为 DOM 操作增加了很多开销，这大大降低了 javascript 代码的性能。为了在 BlackBerry 上获得最佳效果，如果可以的话，我建议直接使用 DOM 方法进行操作（例如，使用 document.getElementById('foo') 而不是 $('foo')），因为它要快得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-06T18:17:30.953

移动资源的最佳位置是：

WURFL - wurfl.sourceforge.net/

MobiForge - [http://www.mobiforge.com](http://www.mobiforge.com)

移动元素 - [http://www.mobileelements.com](http://www.mobileelements.com)

一般来说，手机对 JavaScript 的支持很差，要么手机没有 JavaScript，要么实现有错误。

如今，业内很多人都在做 iPhone 和 Blackberry 特定站点，并使用服务来检测浏览站点的手机类型并重定向到最佳站点，这样您就可以充分利用很酷的新手机，也支持旧手机。

至于在设计网站时哪些手机最受欢迎，最好的地方是 Admob 指标 - [http://www.admob.com/s/solutions/metrics](http://www.admob.com/s/solutions/metrics)

但目前的名单是

1.  苹果手机

2.  摩托罗拉 Razr

3.  诺基亚 N70

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T21:31:06.263

最后我检查了 Windows Mobile IE 是 IE5 代码库的一个分支，所以在那里工作的东西*应该*可以在移动 IE 上工作。但是我记得一些限制（希望其他人可以澄清）我的印象是该列表不受支持。

至于 iPhone，除了 flash，它应该做 Safari 在 Windows/Mac 上所做的任何事情。

黑莓设备使用他们自己的专有浏览器，你必须看看是否有人有它的详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-09T00:35:27.490

您可能对[DeviceAtlas](http://deviceatlas.com/)感兴趣，用于确定设备功能。

# php - 如何在一个网页上连接多个 MySQL 数据库？

> ID：274892
> 
> 赞同：180
> 
> 时间：2008-11-08T16:24:13.090
> 
> 标签：php, mysql

我的信息分布在几个数据库中，并希望使用 PHP 将所有信息放到一个网页上。我想知道如何在一个 PHP 网页上连接到多个数据库。

我知道如何使用以下方法连接到单个数据库：

```
$dbh = mysql_connect($hostname, $username, $password) 
        or die("Unable to connect to MySQL"); 
```

但是，我可以只使用多个“mysql_connect”命令来打开其他数据库吗？如果我确实连接了多个数据库，PHP 将如何知道我想要从哪个数据库中提取信息。

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2008-11-08T16:42:13.913

**警告：** `mysql_xx`函数自 php 5.5 起已弃用，自 php 7.0 起已删除（请参阅[http://php.net/manual/intro.mysql.php](http://php.net/manual/intro.mysql.php)），使用`mysqli_xx`函数或查看@Troelskn 的以下答案

* * *

您可以多次调用`mysql_connect()`，但如果参数相同，则需要为 ' `$new_link`'（第四个）参数传递 true，否则会重复使用相同的连接。例如：

```
$dbh1 = mysql_connect($hostname, $username, $password); 
$dbh2 = mysql_connect($hostname, $username, $password, true); 

mysql_select_db('database1', $dbh1);
mysql_select_db('database2', $dbh2); 
```

然后查询数据库 1 传递第一个链接标识符：

```
mysql_query('select * from tablename', $dbh1); 
```

对于数据库 2，通过第二个：

```
mysql_query('select * from tablename', $dbh2); 
```

如果您不传递链接标识符，则使用最后创建的连接（在这种情况下，由 表示`$dbh2`）例如：

```
mysql_query('select * from tablename'); 
```

**其他选项**

如果 MySQL 用户可以访问两个数据库并且它们位于同一主机上（即两个数据库都可以从同一连接访问），您可以：

*   保持一个连接打开并`mysql_select_db()`根据需要调用以进行交换。我不确定这是一个干净的解决方案，您最终可能会查询错误的数据库。
*   当您在查询中引用表时指定数据库名称（例如`SELECT * FROM database2.tablename`）。这可能很难实施。

另请阅读 troelskn 的答案，因为如果您能够使用 PDO 而不是较旧的扩展，这是一种更好的方法。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2008-11-08T18:21:15.803

如果您使用 PHP5（而且您应该使用 PHP4，因为 PHP4 已被弃用），您应该使用[PDO](http://docs.php.net/manual/en/book.pdo.php)，因为这正在慢慢成为新标准。PDO 的一个（非常）重要的好处是它支持绑定参数，这使得代码更加安全。

您将通过 PDO 进行连接，如下所示：

```
try {
  $db = new PDO('mysql:dbname=databasename;host=127.0.0.1', 'username', 'password');
} catch (PDOException $ex) {
  echo 'Connection failed: ' . $ex->getMessage();
} 
```

（当然要替换上面的databasename、username和password）

然后，您可以像这样查询数据库：

```
$result = $db->query("select * from tablename");
foreach ($result as $row) {
  echo $row['foo'] . "\n";
} 
```

或者，如果您有变量：

```
$stmt = $db->prepare("select * from tablename where id = :id");
$stmt->execute(array(':id' => 42));
$row = $stmt->fetch(); 
```

如果您需要一次打开多个连接，您可以简单地创建多个 PDO 实例：

```
try {
  $db1 = new PDO('mysql:dbname=databas1;host=127.0.0.1', 'username', 'password');
  $db2 = new PDO('mysql:dbname=databas2;host=127.0.0.1', 'username', 'password');
} catch (PDOException $ex) {
  echo 'Connection failed: ' . $ex->getMessage();
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-09-25T16:47:07.097

我只是让我的生活变得简单：

```
CREATE VIEW another_table AS SELECT * FROM another_database.another_table; 
```

希望对您有所帮助...干杯...

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-04-20T03:50:02.290

而不是[mysql_connect](http://php.net/mysql_connect)使用[mysqli_connect](http://php.net/mysqli_connect)。

mysqli 提供了一次连接多个数据库的功能。

```
$Db1 = new mysqli($hostname,$username,$password,$db_name1); 
// this is connection 1 for DB 1

$Db2 = new mysqli($hostname,$username,$password,$db_name2); 
// this is connection 2 for DB 2 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-21T11:19:33.340

试试下面的代码：

```
 $conn = mysql_connect("hostname","username","password");
    mysql_select_db("db1",$conn);
    mysql_select_db("db2",$conn);

    $query1 = "SELECT * FROM db1.table";
    $query2 = "SELECT * FROM db2.table"; 
```

您可以从两个数据库中获取上述查询的数据，如下所示

```
$rs = mysql_query($query1);
while($row = mysql_fetch_assoc($rs)) {
    $data1[] = $row;
}

$rs = mysql_query($query2);
while($row = mysql_fetch_assoc($rs)) {
    $data2[] = $row;
}

print_r($data1);
print_r($data2); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-08-29T09:06:31.697

```
$dbh1 = mysql_connect($hostname, $username, $password);  
$dbh2 = mysql_connect($hostname, $username, $password, true); 

mysql_select_db('database1', $dbh1); 
mysql_select_db('database2',$dbh2); 

mysql_query('select * from tablename', $dbh1);
mysql_query('select * from tablename', $dbh2); 
```

这是我使用的最明显的解决方案，但请记住，如果两个数据库的用户名/密码在同一主机上完全相同，则此解决方案将始终使用第一个连接。所以不要感到困惑，这在这种情况下不起作用。您需要做的是，为 2 个数据库创建 2 个不同的用户，它会起作用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-07-27T03:20:55.083

除非您确实需要使用多个 PDO 对象的实例，否则请考虑以下事项：

```
$con = new PDO('mysql:host=localhost', $username, $password, 
      array(PDO::ATTR_PERSISTENT => true)); 
```

注意`dbname=`构造参数中没有。

当您通过终端或其他工具连接到 MySQL 时，不需要数据库名称。您可以通过该方法使用`USE dbname`语句在数据库之间切换。`PDO::exec()`

```
$con->exec("USE someDatabase");
$con->exec("USE anotherDatabase"); 
```

当然，您可能希望将其包装在 catch try 语句中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-08-04T08:09:58.610

您也许可以使用 MySQLi 语法，这将使您能够更好地处理它。

定义数据库连接，然后每当您想查询其中一个数据库时，指定正确的连接。

例如：

```
$Db1 = new mysqli('$DB_HOST','USERNAME','PASSWORD'); // 1st database connection 
$Db2 = new mysqli('$DB_HOST','USERNAME','PASSWORD'); // 2nd database connection 
```

然后要在同一页面上查询它们，请使用以下内容：

```
$query = $Db1->query("select * from tablename")
$query2 = $Db2->query("select * from tablename")
die("$Db1->error"); 
```

以这种方式更改为 MySQLi 将对您有所帮助。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-08-15T07:28:50.910

你实际上不需要`select_db`. 您可以同时向两个数据库发送查询。首先，授予 to`DB1`从`DB2`by中进行选择`GRANT select ON DB2.* TO DB1@localhost;`。那么，`FLUSH PRIVILEGES;`。最后，您可以进行“多数据库查询”之类的操作`SELECT DB1.TABLE1.id, DB2.TABLE1.username FROM DB1,DB2`。（不要忘记您需要“root”权限才能使用授权命令）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-15T19:16:52.437

如果您使用的是 mysqli 并且有两个 db_connection 文件。就像第一个是

```
define('HOST','localhost');
define('USER','user');
define('PASS','passs');
define('**DB1**','database_name1');

$connMitra = new mysqli(HOST, USER, PASS, **DB1**); 
```

第二个是

```
 define('HOST','localhost');
    define('USER','user');
    define('PASS','passs');
    define(**'DB2**','database_name1');

    $connMitra = new mysqli(HOST, USER, PASS, **DB2**); 
```

所以只需在 mysqli 中更改参数传递的名称，如 DB1 和 DB2。如果您在 mysqli 中传递相同的参数，假设两个文件中的 DB1 则第二个数据库将不再连接。所以记住当你在 mysqli 函数中使用两个或多个连接传递不同的参数名称时

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-04-29T08:30:02.457

```
<?php
    // Sapan Mohanty
    // Skype:sapan.mohannty
    //***********************************
    $oldData = mysql_connect('localhost', 'DBUSER', 'DBPASS');
    echo mysql_error();
    $NewData = mysql_connect('localhost', 'DBUSER', 'DBPASS');
    echo mysql_error();
    mysql_select_db('OLDDBNAME', $oldData );
    mysql_select_db('NEWDBNAME', $NewData );
    $getAllTablesName    = "SELECT table_name FROM information_schema.tables WHERE table_type = 'base table'";
    $getAllTablesNameExe = mysql_query($getAllTablesName);
    //echo mysql_error();
    while ($dataTableName = mysql_fetch_object($getAllTablesNameExe)) {

        $oldDataCount       = mysql_query('select count(*) as noOfRecord from ' . $dataTableName->table_name, $oldData);
        $oldDataCountResult = mysql_fetch_object($oldDataCount);

        $newDataCount       = mysql_query('select count(*) as noOfRecord from ' . $dataTableName->table_name, $NewData);
        $newDataCountResult = mysql_fetch_object($newDataCount);

        if ( $oldDataCountResult->noOfRecord != $newDataCountResult->noOfRecord ) {
            echo "<br/><b>" . $dataTableName->table_name . "</b>";
            echo " | Old: " . $oldDataCountResult->noOfRecord;
            echo " | New: " . $newDataCountResult->noOfRecord;

            if ($oldDataCountResult->noOfRecord < $newDataCountResult->noOfRecord) {
                echo " | <font color='green'>*</font>";

            } else {
                echo " | <font color='red'>*</font>";
            }

            echo "<br/>----------------------------------------";

        }     

    }
    ?> 
```

# debugging - 监控旧dos游戏的文件访问

> ID：274894
> 
> 赞同：2
> 
> 时间：2008-11-08T16:25:37.503
> 
> 标签：debugging, dos

我有一个不寻常的问题。我在 windows xp 下的 dosbox 中运行一个旧的 DOS 游戏，我试图确定它何时何地访问它的数据文件。

我可以使用什么来记录对文件的所有读取请求？我想知道读取的每个文件的“时间”、“来自”和“大小”。

我知道我的基本 8086/8088 程序集，但仅此而已。所以如果没有可用的快捷工具，推荐一个可以帮助我走上正轨的调试工具/教程也很棒。

游戏的“根源”，如果有人能对这个游戏的内部原理有所了解，那将是一个很大的帮助:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T16:34:03.540

您可以尝试使用[FileMon for Windows](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)并查看通过 Windows 文件系统访问的 dosbox。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-10T06:23:32.023

您可以修补 DOSBOX 源代码 :) 只需让它在读取发生时写入一些调试消息。如果您将调试级别设置得足够高，无论如何都可能发生！

大多数 DOS 程序使用 DOS 中断。然而，有些使用 BIOS 中断或更糟。

无论如何，如果它有帮助，这里是我知道的文件读取 DOS 中断：

面向FCB的功能：

*   INT 21h，AH=14h（顺序读取）
*   INT 21h，AH=21h（随机读取）
*   INT 21h, AH=27h (随机块读取, à la `fread()`)

面向句柄的功能：

*   INT 21h，AH=3Fh（顺序读取）
*   INT 21h，AH=42h（寻道）

# jquery - 拥有 jquery 的干净方式包括 ASP.Net MVC

> ID：274899
> 
> 赞同：5
> 
> 时间：2008-11-08T16:28:32.583
> 
> 标签：jquery, asp.net-mvc

你们是如何处理使用 jQuery 的，包括

```
<script type="text/javascript" src="jquery.js"></script> 
```

在使用部分视图/视图控件时在 Asp.Net MVC 中？基本上，我不想让 jquery 包含在母版页中，因为我没有在所有视图中使用 jquery，但我还想要一种简单的方法让用户控件能够在右侧创建 jquery 包含位置（'head'）而不创建重复的 jquery 包含。

最好的方法是使用 ScriptManaager，但我不想在我的应用程序中依赖 ASP.Net Ajax。是否有我可以使用的“轻量级”ScriptManager 也允许新发布的 jquery 智能感知？

我创建了一个提供此功能的 WebControl，但我没有得到我非常想要的 VS2008 的智能感知支持。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-09T02:26:50.847

如果您在大部分页面中使用 JQuery，我只会将其放在母版页中。它只会被下载一次，此时它会缓存在浏览器上，并且对渲染页面的性能影响可以忽略不计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T16:33:43.603

不确定如何仅使用部分视图来执行此操作，尽管您可以使用现有技术逐页执行此操作。

您可以在 head 标记内的母版页中创建一个 ContentPlaceHolder。比在您的用户控件中只需将 jQuery 包含在您页面的 ContentPlaceHolder 内容区域中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-16T20:28:57.090

啊，试图发布这个让我发疯了，因为它被视为页面的一部分......但是

```
<script src="<%=Url.Content("~/Content/js/jquery-1.2.3.min.js") %>" type="text/javascript"></script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T16:33:24.883

你总是可以这样做：

在每个页面中创建一个轻量级的 util.js，你可以在其中放置各种常见的东西，再加上这个：

```
function loadJSInclude(scriptPath, callback)
{
    var scriptNode = document.createElement('SCRIPT');
    scriptNode.type = 'text/javascript';
    scriptNode.src = scriptPath;

    var headNode = document.getElementsByTagName('HEAD');
    if (headNode[0] != null)
        headNode[0].appendChild(scriptNode);

    if (callback != null)    
    {
        scriptNode.onreadystagechange = callback;            
        scriptNode.onload = callback;
    }
} 
```

然后，在您看来，只需放置：

```
<script type='text/javascript'>
    if(typeof(someJqueryObject) == "undefined")        
        loadJSInclude('jquery.js', doYourStuff);        
    else        
        doYourStuff();

    function doYourStuff()
    {
        // jQuery will be loaded now, so you can do your stuff here.
    }
</script> 
```

# performance-testing - 对大爆炸重写的性能测试有抵抗力吗？

> ID：274912
> 
> 赞同：6
> 
> 时间：2008-11-08T16:35:30.103
> 
> 标签：performance-testing

从字面上看，两年多来，我一直致力于“大爆炸”重写。管理层一直无情地忽视和贬低我的呼吁，即在该应用程序取代其百万美元的赚钱旗舰网络应用程序之前分配时间/资源用于性能测量、容量规划和优化。

最后，他们同意这样做（我们通过推出一个并行的 beta 服务器成功地阻止了他们大肆宣传，该服务器现在正在生产中并将成为测试的目标）。我不喜欢他们等到最后才优先考虑这一点，但迟到总比没有好。

对于以后处理此类情况，大家有什么建议呢？教育经理/客户需要进行此类测试的最佳方式是什么？

我已经向他们展示了 Microsoft 在 CodePlex 上的性能指南，并在开篇页面中附有经验丰富的专业人士的严厉警告。我还给他们看了《放开它！》这本书。以及其作者给出的关于“凌晨 3 点通话”的指导。这最终让他们不情愿地说服了他们，但事实是，这应该优先考虑到开发中，并在最终完整系统测试之前的开发过程中进行部分测量。

许多只编写过 ASP 但从未编写过 .NET 的经理和老派工程师习惯于自己编写所有代码，并且不了解在较新的 .NET 应用程序中缓存、调整和运行状况监控的所有选项。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-08T17:24:23.237

您没有意识到（许多工程师没有意识到）这是一种“销售情况”，而不是工程情况。不管客户是否在公司内部，流程基本相同。

销售就是要找出什么样的问题驱使您的客户，然后展示您的产品如何解决他们的一个或多个问题。如果他们不认为自己有性能问题，那么他们就不会——就这么简单。尽管您可能能够教育他们，让他们以您的方式看待事物，但“教育销售”在时间和金钱上是昂贵的，而且许多客户讨厌被告知“他们已经知道的事情”。听起来你必须通过用书打败他们来教育这个群体，但可能有更简单的方法来实现你的目标。

那会是什么？我不知道，但他们知道，所以问他们。询问是什么最终促使他们做出决定。可能是突然意识到你是对的，但更可能是更基本的事情，比如越来越害怕在董事会或市场上受到羞辱。他们不太可能直接这么说，但如果你真的听他们的回答，你也许能从字里行间读出。在销售中，对销售电话进行事后分析（成功与否）对于了解是什么激励了您的客户以及如何调整自己的表达想法的技能至关重要。

而且，下一次，你会知道问一些开放式的问题，比如你的客户想要实现什么，以及他/她现在和长期的问题是什么。它会一直有效吗？当然不是，但学习处理工程问题的社会方面是一项宝贵的技能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-08T16:49:06.973

让他们就他们期望系统能够支持的可靠数字达成一致（并发用户/任务/等的数量），那么确保系统能够满足要求就成为开发工作的一个明显部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T19:08:32.057

不要将此作为一个开放式的性能调整和基准测试过程来讨论，因为这会使年长的经理担心你是在钓鱼或给系统镀金。

相反，将其作为认证练习进行讨论。确定您当前的流量水平，添加安全边际，并说明您的测试旨在证明系统将经得起现实生活。

你仍然可以做性能热点工作；你只需要让尖头发的老板放心，你的所有工作都将实现有形的业务目标。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-31T13:16:20.883

说服人的方法有很多种——你提到的例子是“调用更高的权威”。然而，大多数管理人员不一定会被技术指导所说服。

对于这种情况，我使用了基于风险的方法。对于每个项目，我都会保留一份风险日志，确定项目的最大风险、它们的可能性、影响和缓解方案。通常，您可以量化这些项目——这让经理们可以做出正确的决定。

在重写开始时，您的风险日志可能有以下条目：

> 风险：系统性能未能满足用户期望
> 
> 可能性：未知
> 
> 影响：最终用户因加载时间过长而放弃网站。项目失败。
> 
> 影响成本：无论您的项目成本如何。
> 
> 缓解：每两周一次的性能测试。
> 
> 缓解成本：无论您认为会花费多少时间和金钱
> 
> 建议：运行性能测试以量化风险。

大多数经理对风险未知，但其代价是项目失败的风险会感到非常不舒服。另一方面，您并没有要求做出巨大的承诺 - 足以量化风险。

我喜欢定期与项目利益相关者一起查看风险日志——至少每月一次。我总是从“高影响/高可能性”风险开始，然后转向“高影响/未知可能性”风险。分发会议记录也是一个好主意，记录利益相关者对每个风险的决定。同样，在书面记录中看到自己的名字与忽略高影响风险的决定相关联的经理会仔细考虑该决定。

一旦你可以量化风险——通过运行一些性能测试——你就可以根据成本和性能问题的可能性做出进一步的基于风险的决策。这也是管理其他经典非功能性问题（如安全性、可访问性和可扩展性）的好方法。

通过量化问题，您可以将其转化为业务决策，而不是工程决策。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T16:46:46.913

仔细记录这个开发项目，包括部署后出现的性能问题。人们会哀叹这些问题，你可以委婉地建议他们更早地优先考虑这类问题。有些人只接受直接的第一人称证据。

# java - 从其他语言（如 Java、PHP、Perl、Python 等）调用 C/C++ 代码的最佳方法是什么？

> ID：274915
> 
> 赞同：6
> 
> 时间：2008-11-08T16:39:56.303
> 
> 标签：java, c++, c, perl

从 Java、Python、Perl、PHP 等其他语言调用 C/C++ 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-08T17:40:13.343

## 来自 Perl

[内联::C](http://search.cpan.org/perldoc?Inline::C)
[内联::CPP](http://search.cpan.org/perldoc?Inline::CPP)
[内联::Java](http://search.cpan.org/perldoc?Inline::Java)
[内联::Python](http://search.cpan.org/perldoc?Inline::Python)
[内联::Lua](http://search.cpan.org/perldoc?Inline::Lua)

摘自[Inline::C-Cookbook](http://search.cpan.org/dist/Inline/C/C-Cookbook.pod)：

```
use Inline C => <<'END_C';

  void greet() {
    printf("Hello, world\n");
  }
END_C

greet; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T16:40:59.907

使用 Swig，它允许您为调用任何 C/C++ 函数的多种语言生成代码。 [http://www.swig.org/](http://www.swig.org/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-08T16:42:20.153

这真的取决于语言......有些语言可以直接绑定到 c/c++ 库，而其他语言（如 java）需要编写显式接口。如果您正在尝试解决特定问题，我建议您提供有关您正在尝试做的事情的更多详细信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-08T16:44:36.170

这将取决于语言和你想要什么样的集成。

所有这些语言都允许您执行系统命令，因此您可以将 C 构建为可执行文件，并像命令一样调用它。在 Python 中：

```
os.system("myccode -v args etc") 
```

这种方法的缺点是您不共享任何内存状态或返回大量信息，并且您有启动进程的开销。从好的方面来说，它可以在任何地方使用，而且技术含量很低。

每种语言都有自己在同一进程中调用 C 的机制。例如，Python 具有 C API，您可以将 C 代码构建到 Python 扩展中。这允许非常紧密的集成，但在学习 C API 和仔细编写代码以不泄漏内存方面都需要做更多的工作。

Python 还提供[ctypes](http://www.python.org/doc/2.5.2/lib/module-ctypes.html)，它可以调用 C DLL。这比完整的 C 扩展要容易一些，但不能提供所有相同的集成机会。

# asp.net - 关闭 ASP.NET CSS 友好适配器

> ID：274918
> 
> 赞同：3
> 
> 时间：2008-11-08T16:41:58.610
> 
> 标签：asp.net, jquery, gridview

用于 ASP.NET 的 CSS 友好控件适配器非常适合创建易于设置样式的标记。GridView 适配器的一大好处是它可以生成 THEAD、TBODY 和 TFOOT 标签，这使您可以使用 jQuery 之类的库来做一些非常棒的事情——例如，用于客户端表格排序的[Tablesorter 。](http://tablesorter.com/docs/)

问题是它似乎是通过 CSSFriendlyAdapters.browser 文件对适配器进行全局开/关。如果我目前已经有大量的 GridViews 正在生产中并且只想将 CSS Friendly Adapters 用于新的，我该怎么办？

所以我会对两种类型的解决方案感兴趣：

1) 一种扩展或修改 GridView 的方法（可接受新标签）以输出 THEAD 和 TBODY 标签。

2) 一种有条件地应用或禁用 CSS 友好控制适配器的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-21T09:00:04.153

在做了一些研究后，我做了类似的事情

您需要对要使用的控件进行子类化（在您的情况下为gridview，在我的情况下为radiobuttonlist）

```
public class UlRadioButtonList : RadioButtonList
    {
        protected override void Render(System.Web.UI.HtmlTextWriter writer)
        {
            // Call the base RenderContents method.
            base.Render(writer);
        }
    } 
```

然后让 .browser 文件引用您的自定义子类，而不是 asp.net 控件

例如

```
<browsers>
  <browser refID="Default">
    <controlAdapters>
      <adapter controlType="FM.Web.Source.WebControls.UlRadioButtonList" adapterType="FM.Web.Source.ControlAdapters.RadioButtonListAdapter" />
    </controlAdapters>
  </browser>
</browsers> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T20:54:23.450

CSS 友好...

> 禁用适配器
> 
> 如果您将 AdapterEnabled="false" 显式添加到服务器端标记，这些示例适配器将尝试使用 ASP.NET 框架的本机呈现控件。当心：这不受支持，而且通常效果不佳。从根本上说，该框架不支持基于每个控件禁用适配器。AdapterEnabled 属性仅用于实验性使用。

[来源](http://www.asp.net/cssadapters/WhitePaper.aspx#Samples)

或者，您可以创建一个派生自 GridView 并覆盖 RenderChildren 方法的类。可能需要一些实验来弄清楚如何使这项工作。我还没有查看控件在 GridView 中是如何呈现的，以便为您提供这方面的任何想法。大概，您只需要弄清楚哪些行是页眉/页脚并在它们周围和其他行周围渲染 /。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T22:48:17.387

我找到了一种创建 THEAD 和 TBODY 标签的方法：

资料来源：[使用 jQuery 的 TableSorter 的可排序的 GridView](http://www.codeproject.com/KB/aspnet/SortableGridViewjQuery.aspx)

裸骨详细信息：

```
myGrid.UseAccessibleHeader = true;
myGrid.HeaderRow.TableSection = TableRowSection.TableHeader;
myGrid.FooterRow.TableSection = TableRowSection.TableFooter; 
```

# wcf-data-services - ADO.NET 数据服务——非 .NET 消费者

> ID：274922
> 
> 赞同：3
> 
> 时间：2008-11-08T16:42:47.423
> 
> 标签：wcf-data-services

有没有人遇到过 ADO.NET 数据服务的非 .Net 使用者的示例？我正在研究 Astoria 是什么以及如何使用它的第二天。我也想回答为什么我要使用它而不是 Web 服务？

在让我的示例运行之后，我开始采用 RESTful 方法从系统中获取数据。而且，将其插入 .net 客户端非常容易。但是，然后我想知道非 .NET 消费者将如何处理它。

任何想法（指针）绝对赞赏......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T16:51:15.393

好吧，既然 ADO.NET 数据服务将自己公开为 RESTful 服务，任何可以对 URI 进行 RESTful 调用的东西都可以正确使用该服务。我认为与其寻找与 X 技术相关的 .NET，不如查找您正在使用的技术（Python、PHP 等）来了解如何调用 RESTful 服务。一旦 ADO.NET 托管数据服务......它就可以运行并且供任何人使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-02T18:01:00.403

我们现在有[PHP](http://blogs.msdn.com/interoperability/archive/2009/08/21/a-new-bridge-for-php-developers-to-net-through-rest-php-toolkit-for-ado-net-data-services.aspx)和[JAVA](http://wiki.restlet.org/docs_2.0/13-restlet/28-restlet/287-restlet.html)客户端库来与基于 ADO.NET 数据服务的服务进行通信。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T16:07:34.190

要使用 ADO.NET 数据服务，只需要能够使用 GET、POST、PUT 和 DELETE 动词发出 HTTP 请求并设置 Accept 标头。

并非所有编程环境都提供这些，例如 Silverlight 2 和 J2ME 只能执行 GET 和 POST，*不能*执行PUT 和 DELETE。这意味着无法从 Java Micro Edition 客户端更新或删除 ADO.NET 数据服务 (1.5 CTP) 的最新版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-09T18:19:10.000

还有一个相当成熟的基于 AJAX 的数据服务客户端库。有关详细信息，请参阅 ASP.NET AJAX 控件工具包，或者直接访问 OData.org。

# asp.net - ASP.NET：虚拟目录中的外部自定义配置文件 - 如何？

> ID：274923
> 
> 赞同：3
> 
> 时间：2008-11-08T16:42:51.790
> 
> 标签：asp.net, iis, configuration, web-config, customization

我知道至少有两种方法可以利用 web.config 文件：

*   使用`configSource`.NET 2.0 中引入的属性 -[这是一个很好的博客条目](http://blog.andreloker.de/post/2008/06/Keep-your-config-clean-with-external-config-files.aspx)。
*   appSettings 标签的`file`属性，它允许您指向具有相对路径的外部文件。[MSDN 文档中有关 appSettings 元素的](http://msdn.microsoft.com/en-us/library/ms228154.aspx)描述。

现在，我的问题是这两种方法**都只适用于物理路径**。但我需要解决一个**虚拟目录**中的配置文件。

我可以使用哪种其他方法将我的配置资源放在虚拟目录中？

*注意：我想这样做，因为我的 Web 应用程序在同一台服务器上有多个实例（并且在许多服务器上）。为了保持部署简单和干净，我想为所有文件（aspx、ascx、图像、css、js 等）保留一个目录，并将 IIS 中的 Web 应用程序针对不同的客户（=域、https 等）指向这个单个目录。在每个 IIS Web 中，我都会有一个名为“custom”的虚拟目录，它指向每个 Web 的不同文件夹。*

**更新：**我想指出这个虚拟目录“custom”不适合包含继承的 web.config - web.config 仅对不包含 aspx/ascx 文件的自定义文件夹有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-04T14:57:49.790

我有同样的情况，在阅读了你的帖子后，我意识到 asp.net 出于各种安全原因不允许你这样做。

因此，我转向操作系统寻找与 Linux 软链接功能等效的功能，这反过来又将我引向了 sysinternals的[Junction 实用程序。](http://technet.microsoft.com/en-gb/sysinternals/bb896768.aspx)这可以创建一个目录，该目录实际上是该卷上的任何其他目录，asp.net 无法区分，因此很高兴加载实际上不在您网站子目录中的配置部分。为我工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T16:45:33.813

虚拟目录可以设置为应用程序，您可以在那里放置另一个 web.config。

它将继承父配置的任何更改，您可以在其中添加自定义设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-25T15:16:27.317

我想做同样的事情但它没有用，所以我决定做相反的事情，因为你知道 web.config 可以被继承，所以我将 IIS 指向包含客户端配置的文件夹（连接字符串、文件路径等）文件和网站文件我将它们与 webconfig 的其余部分放在一个虚拟目录中（它加载 dll 和其他所需的应用程序文件）所以基本上我可以使用网站文件来多个客户端和具有自己数据库连接的客户端字符串和其他特定的客户端设置。

# ghostscript - 为什么我的 CID（类型 11）字体在 Windows 上的 GS8.61 中不起作用

> ID：274942
> 
> 赞同：1
> 
> 时间：2008-11-08T17:02:03.607
> 
> 标签：ghostscript, cjk

我在澳门有一个客户使用 Windows EUDC 来定制 Big5 字形。我`Fontforge`在 Linux 上使用将 .TTE 转换为 11 型（CID 类型 2）字体，并创建了一个自定义`CMap`来将`Big5`代码点映射到字体中的正确字形。这一切都在 Windows 上的 GS8.60 和 Linux 上的 GS8.61 - GS8.63 中运行良好。在 Windows 上加载 GS8.61 中的字体时，我得到一个

> gs_cidfn.ps 中 /findfont 中的 /rangecheck 错误。

我已经尝试`EUDC.TTE`在 Ghostscript 中通过`cidfmap`没有运气`/invalidfont`在`/findfont`. 我对尝试联系 Ken Lunde 犹豫不决，因为这似乎是 Ghostscript 特有的问题。有人知道解决方法吗？有没有人开发了一个补丁，这样我就不会在这里重新发明轮子了？

编辑：`/rangecheck`错误发生在`.buildcidfont`过程中。.buildcidfont 过程没有从 8.60 更改为 8.61。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-10T17:28:45.707

这似乎在 GS8.63 中得到解决。将客户端从 8.61 升级到 8.63 可解决此问题。

# c++ - 排序谓词的链接（例如，对于 std::sort）

> ID：274951
> 
> 赞同：10
> 
> 时间：2008-11-08T17:16:17.697
> 
> 标签：c++, stl, sorting, compare, predicate

您可以将函数指针、函数对象（或 boost lambda）传递给 std::sort 以定义要排序的容器元素的严格弱排序。

但是，有时（我已经打了好几次了），您希望能够链接“原始”比较。

一个简单的例子是，如果您正在对代表联系人数据的对象集合进行排序。有时你会想要排序

```
姓氏，名字，区号
```

. 其他时间

```
名字，姓氏
```

- 还有其他时候

```
年龄、名字、区号
```

... ETC

现在，您当然可以为每种情况编写一个额外的函数对象，但这违反了 DRY 原则——尤其是在每次比较不那么微不足道的情况下。

似乎您应该能够编写比较函数的层次结构 - 低级函数进行单一的、原始的比较（例如名字<名字），然后更高级别的函数连续调用低级函数（可能与&& 利用短路评估）来生成复合函数。

这种方法的问题在于 std::sort 采用二元谓词——谓词只能返回一个布尔值。因此，如果您正在编写它们，则无法判断“false”是否表示相等或大于。您可以使较低级别的谓词返回一个具有三种状态的 int - 但是您必须将它们包装在较高级别的谓词中，然后才能单独与 std::sort 一起使用。

总而言之，这些都不是无法克服的问题。它似乎比它应该的更难 - 并且肯定会邀请帮助库实现。

因此，有没有人知道任何可以在这里提供帮助的预先存在的库（特别是如果它是 std 或 boost 库） - 对此事有任何其他想法吗？

[更新]

正如一些评论中提到的 - 我已经开始编写自己的类实现来管理它。它相当小，一般来说可能有一些问题。但在此基础上，对于任何感兴趣的人，课程都在这里：

[http://pastebin.com/f52a85e4f](http://pastebin.com/f52a85e4f)

还有一些辅助函数（为了避免需要指定模板参数）在这里：

[http://pastebin.com/fa03d66e](http://pastebin.com/fa03d66e)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-08T18:45:16.847

您可以像这样构建一个小链接系统：

```
struct Type {
  string first, last;
  int age;
};

struct CmpFirst {
  bool operator () (const Type& lhs, const Type& rhs) { return lhs.first < rhs.first; }
};

struct CmpLast {
  bool operator () (const Type& lhs, const Type& rhs) { return lhs.last < rhs.last; }
};

struct CmpAge {
  bool operator () (const Type& lhs, const Type& rhs) { return lhs.age < rhs.age; }
};

template <typename First, typename Second>
struct Chain {
  Chain(const First& f_, const Second& s_): f(f_), s(s_) {}

  bool operator () (const Type& lhs, const Type& rhs) {
    if(f(lhs, rhs))
      return true;
    if(f(rhs, lhs))
      return false;

    return s(lhs, rhs);
  }

  template <typename Next>
  Chain <Chain, Next> chain(const Next& next) const {
     return Chain <Chain, Next> (*this, next);
  }

  First f;
  Second s;
};

struct False { bool operator() (const Type& lhs, const Type& rhs) { return false; } };

template <typename Op>
Chain <False, Op> make_chain(const Op& op) { return Chain <False, Op> (False(), op); } 
```

然后使用它：

```
vector <Type> v;  // fill this baby up

sort(v.begin(), v.end(), make_chain(CmpLast()).chain(CmpFirst()).chain(CmpAge())); 
```

最后一行有点冗长，但我认为它的意图很清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T17:27:00.110

处理此问题的一种常规方法是多次排序并使用稳定排序。请注意，这`std::sort`通常是*不稳定*的。然而，有`std::stable_sort`.

也就是说，我会为返回三态（表示小于、等于、大于）的函子编写一个包装器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T18:21:49.937

`std::sort`不能保证是稳定的，因为稳定的排序通常比不稳定的排序慢……所以多次使用稳定的排序看起来像是导致性能问题的秘诀……

是的，要求一个谓词真的很可惜：我认为除了创建一个接受三态函数向量的函子之外别无他法......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-23T06:55:41.727

你可以试试这个：

用法：

```
struct Citizen {
    std::wstring iFirstName;
    std::wstring iLastName;
};

ChainComparer<Citizen> cmp;
cmp.Chain<std::less>( boost::bind( &Citizen::iLastName, _1 ) );
cmp.Chain<std::less>( boost::bind( &Citizen::iFirstName, _1 ) );

std::vector<Citizen> vec;
std::sort( vec.begin(), vec.end(), cmp ); 
```

执行：

```
template <typename T>
class ChainComparer {
public:

    typedef boost::function<bool(const T&, const T&)> TComparator;
    typedef TComparator EqualComparator;
    typedef TComparator CustomComparator;

    template <template <typename> class TComparer, typename TValueGetter>
    void Chain( const TValueGetter& getter ) {

        iComparers.push_back( std::make_pair( 
            boost::bind( getter, _1 ) == boost::bind( getter, _2 ), 
            boost::bind( TComparer<TValueGetter::result_type>(), boost::bind( getter, _1 ), boost::bind( getter, _2 ) ) 
        ) );
    }

    bool operator()( const T& lhs, const T& rhs ) {
        BOOST_FOREACH( const auto& comparer, iComparers ) {
            if( !comparer.first( lhs, rhs ) ) {
                return comparer.second( lhs, rhs );
            }
        }

        return false;
    }

private:
    std::vector<std::pair<EqualComparator, CustomComparator>> iComparers;
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-09T17:34:44.743

链接解决方案很冗长。您还可以将 boost::bind 与 std::logical_and 结合使用来构建您的排序谓词。有关更多信息，请参阅链接文章：[boost 绑定库如何改进您的 C++ 程序](http://www.informit.com/articles/article.aspx?p=412354&seqNum=4 "boost 绑定库如何改进您的 C++ 程序")

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-22T00:09:00.927

C++ 11 中的可变参数模板提供了一个更短的选项：

```
 #include <iostream>
    using namespace std;

    struct vec { int x,y,z; };

    struct CmpX {
      bool operator() (const vec& lhs, const vec& rhs) const 
      { return lhs.x < rhs.x; }
    };

    struct CmpY {
      bool operator() (const vec& lhs, const vec& rhs) const 
      { return lhs.y < rhs.y; }
    };

    struct CmpZ {
      bool operator() (const vec& lhs, const vec& rhs) const 
      { return lhs.z < rhs.z; }
    };

    template <typename T>
    bool chained(const T &, const T &) {
      return false;
    }

    template <typename CMP, typename T, typename ...P>
    bool chained(const T &t1, const T &t2, const CMP &c, P...p) {
      if (c(t1,t2)) { return true;          }
      if (c(t2,t1)) { return false;         }
      else          { return chained(t1, t2, p...); }
    }

    int main(int argc, char **argv) {
      vec x = { 1,2,3 }, y = { 2,2,3 }, z = { 1,3,3 };
      cout << chained(x,x,CmpX(),CmpY(),CmpZ()) << endl;
      return 0;
    } 
```

# c# - 使用 WCF 在 Silverlight 中共享服务接口和模型

> ID：274952
> 
> 赞同：5
> 
> 时间：2008-11-08T17:18:49.940
> 
> 标签：c#, .net, wcf, silverlight

假设我有以下接口，我想在我的服务器（常规 Web 服务）和我的客户端（silverlight 2.0 应用程序）之间共享：

```
public interface ICustomerService
{
    Customer GetCustomer(string name);
} 
```

我的 Web 服务实现了这个接口，并引用了一个定义了类型的类库`Customer`。

通常，如果您想从 WCF 客户端（例如 winforms 应用程序）使用此服务，您可以共享您的模型程序集和服务合同接口。然后，通过使用`ChannelFactory`，您可以动态创建实现您的服务接口的代理。就像是：

```
ICustomerService myService = new ChannelFactory<ICustomerService>(myBinding, myEndpoint);
Customer customer = myService.GetCustomer("romain"); 
```

我基本上想做同样的事情，但是来自 Silverlight 2.0 应用程序。银光`ChannelFactory`似乎不像另一个……

**你知道这是否可能吗？**

注意：由于 Silverlight 应用程序只能引用 Silverlight 项目，因此我有：

MyModel.dll 的两个版本，其中包含`Customer`类型：

*   我的 Web 服务项目引用了一个针对 .NET 框架 3.5 的编译
*   另一个针对 silverlight 2.0 框架的编译，由我的 silverlight 应用程序引用

MyServicesContracts.dll 的两个版本，其中包含`ICustomerService`接口：

*   我的 Web 服务项目引用了一个针对 .NET 框架 3.5 的编译
*   另一个针对 silverlight 2.0 框架的编译，由我的 silverlight 应用程序引用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T17:24:47.073

我想你会发现这个[话题](http://silverlight.net/forums/t/34368.aspx)很有趣。您可以在单独的项目之间共享代码文件或针对多个目标编译单个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-09T21:42:47.207

我可能是错的，但我认为如果您使用 DataContract 和 DataMember 属性装饰 WCF 服务返回的对象，您应该能够在 Silverlight 应用程序和 WCF 服务之间共享对象，而无需在客户端中创建类（应该处理通过代理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T15:23:32.330

很短...

您可以在 silverlight 应用程序下创建代理，为您的服务添加服务引用。当您这样做时，您将在客户端上自动生成您的代理。

您的 wcf 服务接口必须使用 DataContract 和 OperationContract 属性进行注释，并且与此服务一起使用的 POCO 类必须具有 DataContract 和 DataMember 属性。

[http://msdn.microsoft.com/en-us/library/cc197940(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc197940(VS.95).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:49:49.067

我知道现在提供解决方案为时已晚，但这也是我的问题，我找到了[Portable Class Libraries](http://msdn.microsoft.com/en-us/library/gg597391.aspx)。这是您问题的完美解决方案。

# delphi - Delphi：使用 TClientDataset 作为内存数据集

> ID：274958
> 
> 赞同：24
> 
> 时间：2008-11-08T17:23:18.150
> 
> 标签：delphi, dataset

根据[这个页面，](http://www.scalabium.com/faq/dct0150.htm)它可以`TClientDataset`用作内存数据集，完全独立于任何实际的数据库或文件。它描述了如何设置数据集的表结构以及如何在运行时将数据加载到其中。但是当我尝试按照 D2009 中的说明进行操作时，步骤 4 ( `table.Open`) 引发了异常。它说它没有指定提供者。

该页面上示例的全部要点是构建不需要提供程序的数据集。页面是否错误，是否已过时，或者我在某处遗漏了一步？如果页面错误，我需要使用什么来创建一个完全独立的内存数据集？我一直在使用`TJvMemoryData`，但如果可能的话，我想减少我的数据集添加到我的项目中的额外依赖项的数量。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-08T17:52:46.000

在运行时您可以使用`table.CreateDataset`，或者如果这是在设计图面上，您可以右键单击 CDS 并单击创建数据集。不过，您需要先为 CDS 指定列/类型，然后才能执行此操作。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-08T20:15:33.390

如果它有进一步的帮助，这里有一段代码，我在其中创建了一个用作内存表的 ClientDataset：

```
procedure TfrmPRMain.ConfigureDataset;
begin
  With cdsMain do begin
    FieldDefs.Add('bDelete', ftBoolean);
    FieldDefs.Add('sSource', ftString, 10);
    FieldDefs.Add('iSection', ftInteger);
    FieldDefs.Add('iOrder', ftInteger);
    FieldDefs.Add('sBranch', ftString, 10);
    FieldDefs.Add('sPulseCode', ftString, 10);
    FieldDefs.Add('sCode', ftString, 10);
    FieldDefs.Add('dtWorkDate', ftDate);
    FieldDefs.Add('iWorkWeek', ftInteger);
    FieldDefs.Add('sName', ftString, 50);
    CreateDataSet;
    LogChanges := False;
    Open;
  end;
end; 
```

您可以只替换您自己的数据信息即可。杰克

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-17T10:33:56.610

不要忘记在您的安装中包含 MIDAS.DLL 或简单地将 MidasLib 包含在 uses 子句中。否则使用`TClientDataSet`将在客户端机器上引发错误。也许这很明显，但我实际上忘记了一次。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-08T17:38:46.280

您可以使用`table.CreateDataSet`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-09T07:33:30.027

此页面中的代码在任何 Delphi 版本中都不起作用。对 CreateDataSet 的调用已将数据集置于活动状态（“打开”）。您应该使用 .CreateDataSet 或 .Open。不是都。

当您想从提供者（通过 ProviderName 属性）获取数据时使用 .Open，当您想自己填充数据集时使用 .CreateDataSet。

顺便说一句：有关 ClientDataSets 及其功能的深入参考，请查看[CodeGear 开发人员网络上优秀的 Cary Jensen 文章](http://gp.codegear.com/authors/edit/3030.aspx)（首先阅读最旧的文章）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-26T02:07:59.063

如果您想要一个无依赖、高质量且功能丰富（更不用说免费！）的内存数据集，我强烈推荐[kbmMemTable](http://componentsfordevelopers.com)。一切都`TClientDataset`做，然后一些。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-19T02:17:04.203

出于某种原因，这对我不起作用。我`CreateDataset`在设计时执行，但它仍然使应用程序崩溃。这对我来说仍然是未知数。一警告。不要这样做：

```
XXXClientDataSet.Close;
XXXClientDataSet.Open; 
```

因为它会报错。而不是`Open`，使用

```
xxxClientDataSet.CreateDataset; 
```

在我的应用程序中，我需要重置数据并再次加载它，这再次导致错误消息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-10-11T20:34:51.563

*下面是一些自由组件的墓地石头*

在 Delphi 5/Delphi 7 时代，有倡议将任何具有已发布属性的对象（更准确地说 - 数组或这些属性的某些集合）放入数据库。在 Torry.net 上，那些是 LINQ 之前的 CollectionDataSet 和 Object DataSet 等。但由于 DB-VCL 代码几乎没有文档记录，并且自 16 位 Delphi 1.0 以来就是意大利面条 - 这些都没有开发。

还有基于回调（基于事件）的 Snap Object Dataset，并没有那么过时。尽管它在开发人员的肩膀上留下了太多恕我直言。

TDBF.sf.net 表具有内存模式，但被提前删除。TDBF 也死了。

rxLib/JediVCL 有 MemoryDataset。尽管 rxLib 目标是从 16 位 Delphi 1 到 Delphi 5 的源代码级兼容性。这大大削弱了代码。在 JVCL 中，它有一些关注并删除了老​​化的代码，但是当需要一些比琐碎的更深入的使用时，它仍然是半生不熟的。

*还有一些免费的个人 DCU 组件，例如 SQLMemoryTable，但不适用于最近的版本。我想知道 Firebird Embedded / SQLite 是否可以用来创建内存表而不使用像 RAMdrive 这样的系统范围的黑客 :-)*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-26T02:04:16.027

我的偏好是将数据集实际管理为 XML。您可以使用设计器工具创建基本结构，然后将其保存到磁盘。这允许它在可执行文件之外进行管理，作为资源编译，或在版本控制中单独管理。

以这种方式执行此操作时，您可以使用 LoadFromFile/Stream 和 Save 变体。请记住根据您的使用情况正确使用 LogChanges 和 MergeChangeLog。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-05-02T01:48:49.720

这是 OP 在第一篇文章中提到的更正的工作代码。`TClientDataset`您从DBGrid 中显示的内存表中获得。

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, DB, DBClient, Grids, DBGrids, StdCtrls, MidasLib;

type
  TForm1 = class(TForm)
    MemTable: TClientDataSet;
    Button1: TButton;
    Button2: TButton;
    DBGrid1: TDBGrid;
    DataSource1: TDataSource;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var
  i: word;
begin
  MemTable.DisableControls;
  for i := 1 to 20000 do
  begin
    MemTable.Append;
    MemTable.FieldByName('ID').AsInteger       := i;
    MemTable.FieldByName('Status').AsString    := 'Code'+IntToStr(i);
    MemTable.FieldByName('Created').AsDateTime := Date();
    MemTable.FieldByName('Volume').AsFloat     := Random(10000);
    MemTable.Post;
  end;
  MemTable.EnableControls;
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
  MemTable.IndexFieldNames := 'Volume';
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  MemTable.FieldDefs.Add('ID',      ftInteger, 0, False);
  MemTable.FieldDefs.Add('Status',  ftString, 10, False);
  MemTable.FieldDefs.Add('Created', ftDate,    0, False);
  MemTable.FieldDefs.Add('Volume',  ftFloat,   0, False);
  MemTable.CreateDataSet;
end;

end. 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-05-16T23:24:39.473

对我来说，这是由 midas.dll 不匹配引起的。我通过将 MidasLib 添加到主程序的 uses 子句来修复它（从而静态链接库）。更多信息在这里：[http](http://codeverge.com/embarcadero.datasnap/tclientdataset-createdataset-failing-wit/1097715) ://codeverge.com/embarcadero.datasnap/tclientdataset-createdataset-failing-wit/1097715 在这里：http : [//edn.embarcadero.com/article/29297](http://edn.embarcadero.com/article/29297)

# css - Web 应用程序网格的样式

> ID：274980
> 
> 赞同：1
> 
> 时间：2008-11-08T17:40:35.713
> 
> 标签：css, grid, styles

我正在开发一个显示错误列表的小型错误跟踪系统。对于概述，我想使用网格 - 现在我只需要一个样式。

当然我不会抄袭别人的整体风格，只是想知道你喜欢哪种风格。你还有其他很棒的风格吗？

你觉得[这个网站](http://mattberseth.com/blog/2008/06/4_new_grouping_grid_skins_vist.html)上的风格怎么样。你喜欢[组件艺术网格样式](http://www.componentart.com/webui/demos/demos_control-specific/grid/design/default/WebForm1.aspx)吗？[Telerik 的款式](http://demos.telerik.com/aspnet-ajax/grid/examples/overview/defaultcs.aspx)怎么样？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T17:43:19.563

[CSS 表格库](http://icant.co.uk/csstablegallery/)是一个很好的灵感来源。

CSS Table Gallery 展示了 CSS 和数据表如何协同工作以创建可用且漂亮的结果。

# wcf - 公共反向代理背后的 WCF Webservice

> ID：274984
> 
> 赞同：9
> 
> 时间：2008-11-08T17:44:30.060
> 
> 标签：wcf, wsdl, reverse-proxy

如何从侦听公共 IP 的反向代理后面正确地提供位于专用 LAN 中的 WCF Web 服务的 WSDL？

我有一个配置为反向代理模式的 Apache 网络服务器，它侦听公共 IP 地址上的请求并从内部 IIS 主机为它们提供服务。WCF Web 服务使用 LAN 主机的 FQDN 地址生成 WSDL，当然，互联网 Web 服务客户端无法读取该地址。

是否可以在 wcf 应用程序的 web.config 或 IIS 中配置任何设置，以便自定义生成的包含主机地址的 WSDL 并改为放置公共地址？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T21:10:34.210

将以下属性添加到您的服务类：

```
<ServiceBehavior(AddressFilterMode:=AddressFilterMode.Any)> 
```

这允许服务由客户端处理，`https://...`但服务仍然可以托管在`http://.....`

[请参阅我关于如何以声明方式指定 AddressFilterMode.Any](https://stackoverflow.com/a/6878145/1366033)的回答，了解如何创建扩展以允许`AddressFilterMode.Any` 通过配置指定而不需要代码属性。

在`web.config`服务主机中，端点元素的地址属性中*必须有一个绝对 URL*，即客户端将使用的公共 URL。在同一端点元素中，将`listenUri`属性设置为服务主机正在侦听的绝对 URL。

我确定主机正在侦听的默认绝对 URI 的方法是在客户端应用程序中添加一个服务引用，该引用指向托管服务的物理服务器。客户端的 web.config 将包含服务的地址。然后我将它复制到主机 web.config 中的 listenUri 属性中。

`serviceMetaData`在您的服务行为配置中，添加具有属性的元素`httpGetEnabled=true`

所以你会有这样的东西：

```
<serviceBehaviors>
  <behavior name="myBehavior">
    <serviceMetadata httpGetEnabled="true" />
  </behavior>
</serviceBehaviors>
<!--  ... -->
<services>
  <service name="NamespaceQualifiedServiceClass" behavior="myBehavior" >
    <endpoint listenUri="http://www.servicehost.com" 
              address="https://www.sslloadbalancer.com" 
              binding="someBinding" 
              contract="IMyServiceInterface" ... />
  </service>
</services> 
```

我不确定这是否适用于消息安全或传输安全。对于这个特定的应用程序，凭据是作为 DataContract 的一部分传递的，所以我们有`basicHttpBinding`>> `security`。`mode=none`由于传输是安全的（对于 ssl 负载均衡器），因此不存在安全问题。

也可以将 listenUri 属性留空，但它必须存在。

不幸的是，WCF 中存在一个错误，其中 WSDL 中导入模式的基地址具有 listenUri 基地址而不是公共基地址（使用端点的地址属性配置的基地址）。要解决该问题，您需要创建一个 IWsdlExportExtension 实现，它将导入的模式直接引入 WSDL 文档并删除导入。

这篇关于[Inline XSD in WSDL with WCF](https://web.archive.org/web/20150315045205/http://winterdom.com/2006/10/inlinexsdinwsdlwithwcf)的文章提供了一个示例。此外，您可以让示例类继承`BehaviorExtensionElement`并完成这两个新方法：

```
Public Overrides ReadOnly Property BehaviorType() As System.Type
    Get
        Return GetType(InlineXsdInWsdlBehavior)
    End Get
End Property

Protected Overrides Function CreateBehavior() As Object
    Return New InlineXsdInWsdlBehavior()
End Function 
```

这将允许您在 .config 文件中添加扩展行为，并使用配置添加行为，而不必创建服务工厂。

在`system.servicemodel`配置元素下添加：

```
<behaviors>
  <endpointBehaviors>
    <behavior name="SSLLoadBalancerBehavior">          
      <flattenXsdImports/>
    </behavior>
  </endpointBehaviors>
</behaviors>
<extensions>
  <behaviorExtensions>
    <!--The full assembly name must be specified in the type attribute as of WCF 3.5sp1-->
    <add name="flattenXsdImports" type="Org.ServiceModel.Description.FlattenXsdImportsEndpointBehavior, Org.ServiceModel, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>        
  </behaviorExtensions>
</extensions> 
```

然后使用 behaviorConfiguration 属性在端点配置中引用新的端点行为

```
<endpoint address="" binding="basicHttpBinding" contract="WCFWsdlFlatten.IService1" behaviorConfiguration="SSLLoadBalancerBehavior"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T08:13:58.997

我遇到了类似的问题，其中之一是公共地址和服务器地址的解析。这解决了这个问题，尽管我仍然有几个身份验证问题。

**请参阅**：[如何在 WSDL 中为 IIS 托管服务更改主机名？](https://docs.microsoft.com/en-us/archive/blogs/wenlong/how-to-change-hostname-in-wsdl-for-an-iis-hosted-service)作者：董文龙

~~[档案](https://web.archive.org/web/20140516150723/http://blogs.msdn.com/b/wenlong/archive/2007/08/02/how-to-change-hostname-in-wsdl-of-an-iis-hosted-service.aspx)~~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T08:28:59.087

**请参阅**：Aaron Skonnard 的[服务站 WCF 深度寻址](https://docs.microsoft.com/en-us/archive/msdn-magazine/2007/june/service-station-wcf-addressing-in-depth)

~~[存档链接](https://web.archive.org/web/20110514060231/http://msdn.microsoft.com/en-us/magazine/cc163412.aspx)~~

# asp.net - 将 ASP.NET 从版本 1.1 升级到 2.0 - 有什么陷阱吗？

> ID：274994
> 
> 赞同：4
> 
> 时间：2008-11-08T18:00:04.677
> 
> 标签：asp.net, .net-2.0, upgrade, .net-1.1

我知道我们*确实*落后于时代，但我们即将从 .NET 1.1 升级到 .NET 2.0。

谢谢你的同情。

无论如何，有什么我们应该注意的问题吗？
在我们开始之前，您有什么一般性建议吗？

请不要发帖告诉我直接进入 3.5：我们只允许 2.0！

我们主要使用 C#。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-08T18:04:58.240

是的。您要知道的最重要的事情是使用 Web 应用程序项目，而不是网站。网站使用完全不同的编译模型，迁移几乎是一场灾难。Web 应用程序项目与 1.1 中的工作方式更加相似。

我们也遇到了从登录屏幕重定向的间歇性问题，但根据谷歌的说法，我们基本上是唯一遇到这个问题的人 - 我们已经解决了这个问题。

我们遇到的大多数其他问题都很小且易于导航，整体体验得到了净改善。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-08T18:12:12.890

这是我升级前的建议：

*   如果您习惯使用 Visual Studio 2003，则需要使用 VS2005。您必须转换旧的解决方案和项目，使其与 VS2005 兼容。确保备份您要转换的项目，以便您可以回滚甚至将其用作您可能需要对转换后的项目进行任何修改的源。
*   如果您使用 .NET 1.1 开发 Web 应用程序，请确保 IIS 中的所有虚拟目录和应用程序都配置为与 ASP.NET 2.0 一起使用。您可能还需要为您的 .NET 2.0 应用程序配置一个新的应用程序池。
*   如果您在 .NET 1.1 项目中使用任何第三方库，则可能需要确认其与 .NET 2.0 项目的兼容性。.NET 1.1 中使用的一些旧库与 2.0 不兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T18:05:29.063

一个问题是 .NET 2.0 的本土 1.1 实现（1.1 中缺少），如 RegistryHandler 等等。有时，您新移植的 2.0 代码看起来像是在正确使用 2.0 类，而实际上它是在使用自制版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T18:08:25.393

如果您要升级已部署的应用程序，部署是另一个问题。您必须将 IIS 中的 .NET 版本从 1.1 切换到 2.0。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T18:26:57.757

我记得我们不得不更改一些客户端脚本，因为为服务器控件**生成 ClientID 的方式**从 ASP.NET 1.1 更改为 2.0。

我不记得确切的情况，但以前加前缀的一些 ID`ctl0_`变成了`ctl00_...`

# linq-to-sql - Linq to SQL 和大型数据库模型

> ID：274996
> 
> 赞同：7
> 
> 时间：2008-11-08T18:04:26.463
> 
> 标签：linq-to-sql

首先，我是 Linq to Sql 新手，所以请温柔:)。

我有过去 3.5 年开发的现有 ASP.Net 应用程序。它下面有相当大的数据模型，大约 350 个表。我正在尝试用 Linq to SQL 做一些新的事情。

第一印象是 linq 设计器和 SqlMetal 是为不大于 NorthWind 示例的数据库构建的。以下是我遇到的一些问题：

1.  我有`Products`很多地方都需要的桌子（库存、发票、生产……）。如果我将表`Products`放在每个 dbml 文件中，linq 设计器将在每个文件中创建`Product`类。我不想要那个。我只想上一`Product`节课。
2.  我有关于运输的 DataContext。它需要大约 40 张桌子。这使得 dbml 文件很难管理。有没有办法创建较小的 dbml 文件，然后将它们（作为参考）包含到一些“主要”dbml 中？

目前，我真的很喜欢 Linq，但我认为它仍然严重缺乏超过 10 个表的设计工具。

我现在的解决方案是使用 Linq 设计器构建较小的模型，然后手动合并它们（添加属性和引用），因此会生成大量代码，但也会有大量手动工作。

我错过了什么大事，还是目前与 Linq to Sql 的关系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-09T10:22:40.700

好吧，我的解决方案是使用 SQLMetal 的`/code`选项在 .cs 文件而不是 DBML 文件中创建普通类，并在单独的文件中使用部分类来扩展生成的 ORM 类。

我知道这并不能解决您将数据库的各个部分拆分为不同的 ORM 程序集的问题——我只是发现没有 DBML / Designer 的头痛，在 .cs 文件中管理大量类并不算太糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-09T00:14:13.627

为什么要多个 dbml 文件？只需将它们全部合二为一。这就是它的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T23:37:55.650

你在 MSDN 上看到过这篇文章吗？

[http://msdn.microsoft.com/en-us/library/bb387007.aspx](http://msdn.microsoft.com/en-us/library/bb387007.aspx)

似乎有一个命令行工具可以在不使用 VS.net 中的可视化设计器的情况下生成对象模型。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2008-11-08T20:48:52.200

如果我是你，我会使用[Entity Framework](http://msdn.microsoft.com/en-us/library/bb399572.aspx)，因为这是 MS 推荐的 ORM，[Microsoft 会杀死 Linq to SQL](http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx)***