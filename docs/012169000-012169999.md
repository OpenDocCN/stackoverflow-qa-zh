# StackOverflow 问答 12169000-12169999

# python - 在循环中有效地使用 matplotlib 的 quiver

> ID：12169001
> 
> 赞同：4
> 
> 时间：2012-08-28T23:33:51.733
> 
> 标签：python, matplotlib

我正在使用循环在底图上生成矢量场，如下所示：

```
for i in range(365):
     barbs = m.quiver(x, y, u[i, :], v[i, :], scale = 100)
     plt.draw()
     barbs.remove() 
```

该程序在每个循环中都会占用更多的内存。有没有办法解决这个问题？比如在每个循环结束时完全删除倒钩？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T04:10:28.697

如果您只需要重置 (u,v) 组件，您可以`barb.set_UVC(newU,newV,newC)`在循环内使用。

```
barbs = m.quiver(x, y, u[0, :], v[0, :], scale = 100)
for i in range(365):
     barbs.set_UVC(u[i,:],v[i,:])
     #save the figure or something 
```

另请参阅[Python：复制底图或从图中删除数据](https://stackoverflow.com/questions/8429693/python-copy-basemap-or-remove-data-from-figure/11890898#11890898)，[逐帧可视化 3D-numpy-array](https://stackoverflow.com/questions/11563295/visualization-of-3d-numpy-array-frame-by-frame/11563414#11563414)，

如果您正在尝试创建动画，请查看`animation`matplotlib 模块，它会为您处理很多细节。

# jquery - 如何使用带有过滤器的 jQuery 的 on() 函数获取原始选择器？

> ID：12169004
> 
> 赞同：5
> 
> 时间：2012-08-28T23:34:47.117
> 
> 标签：jquery

我正在使用 jQuery 的函数在对象上的事件上`.on()`附加一些行为，比如.`click``span`

我的设置如下所示：

```
$('#container').on('click', 'span', function() {
    // do stuff
}); 
```

在这个函数里面，`this`是`span`. **我怎么得到`#container`？**

* * *

完整示例：http: [//jsfiddle.net/aymansafadi/Nk3p9/](http://jsfiddle.net/aymansafadi/Nk3p9/)

```
<div id="container">
    <span>Click Me!</span>
</div>​ 
```

--

```
$('#container').on('click', 'span', function() {

    var span = $(this),
        div  = false; // This is what I need

    console.log(span);
});​ 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T23:38:01.537

采用[`event.delegateTarget`](http://api.jquery.com/event.delegateTarget/)

```
$('#container').on('click', 'span', function(e) {

    var span = $(this),
    div  = e.delegateTarget;

    console.log(div);
}); 
```

[演示](http://jsfiddle.net/mowglisanu/Nk3p9/2/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-28T23:36:25.220

最简单的方法就是使用`span.parent()`.

# php - php orm 学说如何获取对象及其相关连接

> ID：12169012
> 
> 赞同：0
> 
> 时间：2012-08-28T23:35:40.930
> 
> 标签：php, mysql, orm, doctrine-orm

我在我的 php 项目中使用**[教义 ORM 。](http://doctrine-project.org)**
我想知道教义如何从数据库中获取对象（其表）？

*   它是否获取该对象的所有相关**连接**以及所有相关对象？
    假设**$author与****$article**有关联。是否`$author = $authorRepository->find($id)`获取文章表？

*   它是否获取该对象的**连接的连接**？

我在转储 ORM 对象时遇到了这个问题。我看到了它所有的协会标题。例如： $author 的学说转储：

```
object(stdClass)#1212 (4) {
  ["__CLASS__"]=>
    string(6) "author"
  ["ID"]=>
    int(12)
  ["num"]=>
    int(6059996)
  ["CreateTimestamp"]=>
    int(1316602238)
  ["articles"]=>
    array(3) {
      [0]=>
        string(7) "article"
      [1]=>
        string(7) "article"
      [2]=>
        string(7) "article"
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T01:57:53.663

> 我想知道教义如何从数据库中获取对象（其表）？

基本上使用[**数据映射器模式**](http://martinfowler.com/eaaCatalog/dataMapper.html)。

> 它是否获取该对象的所有相关连接以及所有相关对象？它是否获取该对象的连接的连接？

**不，它没有。**除非您使用[DQL](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html)、[查询生成器](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/query-builder.html)或[本机 SQL](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/native-sql.html)指定它。

如果您在其存储库中获得一个对象，请说`$author = $authorRepository->find($id)`：它将仅从一个表中获取（[类表继承](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/inheritance-mapping.html#class-table-inheritance)除外）

如果您随后要求`$author`对象检索其关系，例如：`$author->getBooks();`没有事先指定它（使用 DQL/SQL 连接），那么它将使用[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)，由**虚拟代理模式**实现，并将执行另一个**单独的查询来检索数据**。

# sql-server-2008 - 简单的 Pivot 示例

> ID：12169016
> 
> 赞同：2
> 
> 时间：2012-08-28T23:36:06.553
> 
> 标签：sql-server-2008, tsql, pivot-table

我需要一份所有masterid的报告，但它可能只是一个连续的。我知道这是一件简单的事情，但我无法正确理解语法。

我附加了数据如何存储在 SQL Server 中，以及我想要的输出。

数据：

![数据](../Images/623a09b95076e4deb6f71a9ec22f43dc.png)

所需输出：

![所需输出](../Images/f7e3134737b7f6dcf81389d24ff787bb.png)

```
CREATE TABLE [dbo].[Services]
    ([ServiceID] [int] IDENTITY(1,1) NOT NULL,
    [MasterID] [nvarchar](10) NOT NULL,
    [Type] [nvarchar](50) NOT NULL,
    [Status] [nvarchar](50) NOT NULL)

Insert Into Services (MasterID, Type , Status) values (123, 'Basic Phone', 'Open')
Insert Into Services (MasterID, Type , Status) values (123, 'BlackBerry', 'Open')
Insert Into Services (MasterID, Type , Status) values (123, 'Pixi', 'Closed') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T00:20:59.177

```
SELECT MasterID, 
  [Basic Phone] = MAX([Basic Phone]),
  [Pixi] = MAX([Pixi]),
  [Blackberry] = MAX([Blackberry])
FROM
(
  SELECT MasterID, [Basic Phone],[Pixi],[Blackberry]
  FROM dbo.Services AS s
  PIVOT 
  (
    MAX([Status]) FOR [Type] IN ([Basic Phone],[Blackberry],[Pixi])
  ) AS p
) AS x
GROUP BY MasterID; 
```

或者更简单地说——归功于@YS。指出我的冗余。

```
SELECT MasterID, 
  [Basic Phone],
  [Pixi],
  [Blackberry]
FROM
(
  SELECT MasterID, Status, Type FROM dbo.Services
)
AS s
PIVOT 
(
  MAX([Status]) FOR [Type] IN ([Basic Phone], [Blackberry], [Pixi])
) AS p; 
```

# windows-8 - Windows 应用认证工具包 - “未检测到任何新应用程序”，ClickOnce

> ID：12169020
> 
> 赞同：12
> 
> 时间：2012-08-28T23:36:40.750
> 
> 标签：windows-8, windows-store, wack

我有一个 Windows 桌面应用程序（WPF + c++）。

我刚刚制作了一个 ClickOnce 安装程序。我在 Windows 7 上构建它，但我想为 Windows 应用商店认证应用程序，因此我在 Windows 8 上运行 Windows 应用程序认证工具包。

安装程序工作正常，它安装我的应用程序并在 Windows 8 开始屏幕上放置一个图标。我的应用程序运行良好。然后我将其卸载以准备运行认证。

当我尝试对其进行认证时，应用程序兼容性工具包无法安装它（几个窗口快速打开和关闭，我无法阅读它们，我没有体验到通常需要我进行一些交互的安装程序对话框） .

然后套件会弹出一个对话框：

> 由于您的安装，Windows 应用认证工具包未检测到任何新应用程序。除非成功安装应用程序，否则测试无法继续）。

以前 a 有一个似乎可以与兼容性套件一起使用的 MSI 安装程序（该应用程序未能通过认证，但出于正当原因）。现在，我什至无法获得用于安装 ClickOnce 应用程序的兼容性工具包。如何认证我的桌面应用程序？

**在商店中确实可以**编辑桌面应用程序。**看到这个。[http://msdn.microsoft.com/en-us/library/windows/desktop/hh749939.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/hh749939.aspx)**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:31:04.327

ClickOnce 应用程序不符合 Windows 7 和 Windows 8 软件徽标计划的条件。

[http://social.msdn.microsoft.com/Forums/en-US/windowscompatibility/thread/f10242cb-39f1-4f5e-ac1f-e55a6c722a6b](http://social.msdn.microsoft.com/Forums/en-US/windowscompatibility/thread/f10242cb-39f1-4f5e-ac1f-e55a6c722a6b)**

# xml - 打印 XML 数组值

> ID：12169029
> 
> 赞同：3
> 
> 时间：2012-08-28T23:37:53.813
> 
> 标签：xml, perl, xml-parsing, xml-simple

我正在尝试使用 perl 和 XML::Simple 从 XML 文件中提取少量数据到 csv 文件中。

这是数据的编辑版本：

```
<?xml version="1.0" encoding="UTF-8"?>
<orders xmlns="http://www.demandware.com/xml/impex/order/2006-10-31">
    <order order-no="W100148941">
        <order-date>2011-08-22T16:15:47.000Z</order-date>
        <custom-attributes>
            <custom-attribute attribute-id="basket_notes">bnotes974211</custom-attribute>
            <custom-attribute attribute-id="omOrderID">974211</custom-attribute>
        </custom-attributes>
    </order>
</orders> 
```

使用这个脚本：

```
#!/usr/bin/perl

use XML::Simple;
use Data::Dumper;

$xml = new XML::Simple;
$data = $xml->XMLin("$ARGV[0]", ForceArray=>1);

print Dumper($data);
foreach $o (@{$data->{order}}) {
    print "$ARGV[1]", ",";
    print "$ARGV[2]", ",";
    print "$ARGV[3]", ",";
    print "$ARGV[4]", ",";
    print $o->{"order-no"}, ",";
    print $o->{"order-date"}, ",";
    foreach my $o ( @{ $data->{'custom-attribute'} } ) {
        print 'in level 1';
        foreach my $attr ( @{ $data->{'custom-attribute'} } ) {
            print 'in level 2';
            if ( $attr->{'attribute-id'} eq 'basket_notes' ) {
                print '"', $data->{'content'}, '"', ",";
            }
        }
    }
    print "\n";
} 
```

得到我这个输出：

```
,,,,W100148941,ARRAY(0x7f7f63a524c0), 
```

不使用 ForceArray 选项 XMLin 会将上面的 ARRAY(...) 替换为正确的值，但不适用于只有一个数据元素的文件，而且很明显，此代码永远不会进入自定义属性数组打印任何东西。

**我究竟做错了什么？**

**更新：**

将上面的循环代码更改为：

```
foreach $o (@{$data->{order}})
{
print "$ARGV[1]", ",";
print "$ARGV[2]", ",";
print "$ARGV[3]", ",";
print "$ARGV[4]", ",";
print $o->{"order-no"}, ",";
#print $o->{"order-date"}, ",";
print $o->{"order-date"}->[0], ",";
foreach my $o ( @{ $data->{'custom-attributes'} } ) {
    print 'in level 1';
   foreach my $attr ( @{ $o->{'custom-attribute'} } ) {
        print 'in level 2';
        if ( $attr->{'attribute-id'} eq 'omOrderID' ) {
            print '"', $data->{'content'}, '"', ",";
        }
    }
}

print "\n";
} 
```

产生这个：

,,,,W100148941,2011-08-22T16:15:47.000Z,

看起来代码只是没有进入自定义属性循环，我不知道为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:08:54.400

您的问题是“订单日期” - 由于 ForceArray - 也被迫成为 arrayref，正如您从已经存在的 Dumper 输出中看到的那样：

```
...
     'order-date' => [
                     '2011-08-22T16:15:47.000Z'
                     ], 
```

因此，您需要做以下两件事之一：

*   如果 order-date 始终是单个值，则硬编码打印第一个数组值：

    ```
    print $o->{"order-date"}->[0], ","; 
    ```

*   如果 order-date 始终是单个值，请通过传递更详细的说明来更改构造函数参数`ForceArray`。

    [XML::Simple](http://search.cpan.org/perldoc?XML%3a%3aSimple) POD 表明，除了一个简单的`ForceArray=>1`选项外，您还可以将要强制执行的有限标签列表[传递](http://search.cpan.org/~grantm/XML-Simple-2.20/lib/XML/Simple.pm#ForceArray_=%3E_%5B_names_%5D_#_in_-_important)`ForceArray => [ "custom-attributes", "custom-attribute" ]`给数组（例如）

    *   如果`order-date`可以有多个标签，只需在循环中打印它，就像您已经在下面使用其他多个标签一样：

        foreach 我的 $order_date (@{ $data->{'order-date'} }) { print "$order_date,"

* * *

此外，您的嵌套循环中有几个错误。

你的第一个循环应该是

```
foreach my $o ( @{ $data->{'custom-attributes'} } ) { # You had "attribute" 
```

第二个循环应该遍历它的子结构：

```
 foreach my $attr ( @{ $o->{'custom-attribute'} } ) { # instead of $data->... 
```

* * *

撇开这一切不谈，从我相当丰富的经验来看，将 XML 转换为平面文件 (CSV) 是个坏主意，委婉地说。请认真考虑您是否在做正确的事情。

如果没有巧妙的编码，就无法正确或轻松地映射数据；并且稍后解码那个狡猾的编码并不比简单地再次读取 XML 更容易。

*   如果您需要对其进行转换以便其他程序可以读取它，请保留 XML 或转换为 JSON

*   如果您需要将其转换为显示给人类，请使用`Data::Dumper`或其他一些漂亮的打印机

*   如果您需要将其作为 GUI 展示给人类，请开发一个好的 GUI 以匹配您的数据结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T10:14:26.747

除了来自 DVK 的回答：

我相信你需要封闭你的最外层循环

foreach $o (@{$data->{order}})

在另一个循环中，因为“订单”项目似乎包含在“订单”项目中

```
 foreach $oo (@{$data->{orders}}) {
       foreach $o (@{$oo->{order}})
       {
       ....
       }
    }  #additional closing for the additional foreach 
```

最好的祝福，

奥利维尔。

# visual-studio - Visual Studio 2010 IntelliSense：关于 F# 运算符的提示

> ID：12169031
> 
> 赞同：4
> 
> 时间：2012-08-28T23:38:02.457
> 
> 标签：visual-studio, f#, intellisense

是否可以让 Visual Studio 在操作员身上显示工具提示？

下图演示了函数的工具提示提示，但它不适用于运算符。

![函数的工具提示提示](../Images/d6040b03846232ebe74431be9d5b746b.png)

运算符通常具有简单的类型规范，例如`'T -> 'T -> 'T`，但此类提示对于自定义提示可能很有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T16:40:10.110

按照丹尼尔的建议，我发布了一个我一直在为自己使用的**解决方法。**
解决方法只是部分有用，我仍在寻找更好的想法。

```
let (!><) a = ()
let z1 = op_BangGreaterLess 5 
```

此代码是完全有效的，因为运算符表达式会生成一个具有编译器生成名称的函数。有关操作员名称的完整列表，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/dd233204.aspx)的“重载操作员名称”部分。

好消息是它`op_BangGreaterLess`支持 IntelliSense 提示，还支持 IDE 的“转到定义”( `F12`) 命令，指向原始操作符声明。
坏消息是 IntelliSense 不允许快速输入完整的操作员名称 ( `Ctrl`+ `Space`)，因此您必须手动输入整个名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T11:22:25.860

恐怕这是不可能的（即使在 Visual Studio 2012 中，我也没有得到操作员的工具提示）。

我想这可以实现，但正如你所说，运算符通常有简单的类型。当使用自定义操作符时，这些操作符应该足够简单，以至于人们可以在不查看它们的类型（或相关的 XML 文档）的情况下使用它们。否则，使用命名函数可能会更好。

也就是说，如果您使用的是 F# Interactive，那么您可以轻松地使用它来探索运算符类型：

```
> (!><);;
val it : ('a -> unit) = <fun:clo@2> 
```

如果我不能使用 F# Interactive，我通常会定义一个简单的虚拟符号来获取 IntelliSense：

```
let dummy () = (!><) 
```

请注意，我添加了`unit`参数来定义函数并避免值限制错误。

# sql-server - Union、Join 或 GroupBy

> ID：12169032
> 
> 赞同：1
> 
> 时间：2012-08-28T23:38:08.887
> 
> 标签：sql-server, sql-server-2008, tsql

我有程序从各种来源提取数据，给我 3 个非常相似的表。

```
Metric          | Tickets   |Band
______________________________________
Acknowledgement | 45        | New
Acknowledgement | 23        | Within
Acknowledgement | 16        | Near
Acknowledgement | 2         | Very Near 
```

和

```
Metric     | Tickets   |Band
___________________________________
Escalation | 10        | New
Escalation | 43        | Within
Escalation | 81        | Near
Escalation | 6         | Very Near 
```

和

```
Metric| Tickets   |Band
___________________________________
Fixed | 34        | New
Fixed | 52        | Within
Fixed | 36        | Near
Fixed | 4         | Very Near 
```

现在，我想以某种方式将它们组合在一起，得到一个像这样的表格输出

```
Metric          | New   | Within | Near | Very Near
_____________________________________________________
Acknowledgement | 45    | 23     | 16   | 2
Escalation      | 10    | 43     | 81   | 6
Fixed           | 34    | 52     | 36   | 4 
```

请问如何在 MS SQLServer 中实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T00:00:26.887

这不需要为每个表重复所有聚合和 CASE 表达式 - 只需一个简单的联合就可以了，然后您可以摆脱它。

```
SELECT Metric, [New], [Within], [Near], [Very Near] FROM 
(
            SELECT Metric, Tickets, Band FROM dbo.table_a
  UNION ALL SELECT Metric, Tickets, Band FROM dbo.table_b
  UNION ALL SELECT Metric, Tickets, Band FROM dbo.table_c
) 
AS x PIVOT 
(
  MAX(Tickets) FOR Band IN ([New],[Within],[Near],[Very Near])
) AS p; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T23:55:51.297

这是一个假的支点，应该得到你想要的。然后，您将为每个表联合此查询。

```
SELECT 
    Metric,
    MAX( CASE Band WHEN 'New' THEN Tickets ELSE '' END ) New, 
    MAX( CASE Band WHEN 'Within' THEN Tickets ELSE '' END ) Within, 
    MAX( CASE Band WHEN 'Near' THEN Tickets ELSE '' END ) Near, 
    MAX( CASE Band WHEN 'Very Near' THEN Tickets ELSE '' END ) [Very Near]
FROM 
    table
GROUP BY 
    Metric

UNION
... 
```

# java - 逐列读取 CSV 文件

> ID：12169038
> 
> 赞同：25
> 
> 时间：2012-08-28T23:40:08.200
> 
> 标签：java, csv, file-io, multiple-columns

我想从多列 csv 文件中读取特定列，并使用 Java 在其他 csv 文件中打印这些列。请问有什么帮助吗？以下是我逐行打印每个标记的代码。但我希望只打印多列 csv 中的几列。

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileWriter;
import java.util.StringTokenizer;

public class ParseCSV {

    public static void main(String[] args) {

        try
        {

            //csv file containing data
            String strFile = "C:\\Users\\rsaluja\\CMS_Evaluation\\Drupal_12_08_27.csv";

            //create BufferedReader to read csv file
            BufferedReader br = new BufferedReader( new FileReader(strFile));
            String strLine = "";
            StringTokenizer st = null;
            int lineNumber = 0, tokenNumber = 0;

            //read comma separated file line by line
            while( (strLine = br.readLine()) != null)
            {
                lineNumber++;

                //break comma separated line using ","
                st = new StringTokenizer(strLine, ",");

                while(st.hasMoreTokens())
                {
                //display csv values
                tokenNumber++;
                System.out.println("Line # " + lineNumber +
                                ", Token # " + tokenNumber
                                + ", Token : "+ st.nextToken());

                            System.out.println(cols[4]); 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-08-28T23:49:36.400

您应该使用优秀的[OpenCSV](http://opencsv.sourceforge.net/)来读取和写入 CSV 文件。为了调整您的示例以使用该库，它看起来像这样：

```
public class ParseCSV {
  public static void main(String[] args) {
    try {
      //csv file containing data
      String strFile = "C:/Users/rsaluja/CMS_Evaluation/Drupal_12_08_27.csv";
      CSVReader reader = new CSVReader(new FileReader(strFile));
      String [] nextLine;
      int lineNumber = 0;
      while ((nextLine = reader.readNext()) != null) {
        lineNumber++;
        System.out.println("Line # " + lineNumber);

        // nextLine[] is an array of values from the line
        System.out.println(nextLine[4] + "etc...");
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-03-20T08:46:36.250

在 Java中以非常**简单**和常见的方式读取 CSV 文件。您实际上**不需要**加载任何**额外的**第三方库来为您执行此操作。CSV（逗号分隔值）文件只是一个普通的纯文本文件，按列存储数据，并用分隔符（例如逗号“，”）进行分割。

为了从 CSV 文件中读取特定列，有几种方法。最简单的如下：

**无需任何第三方库即可读取 CSV 的代码**

```
BufferedReader br = new BufferedReader(new FileReader(csvFile));
while ((line = br.readLine()) != null) {
    // use comma as separator
    String[] cols = line.split(cvsSplitBy);
    System.out.println("Coulmn 4= " + cols[4] + " , Column 5=" + cols[5]);
} 
```

如果您注意到，这里并没有什么*特别之处*。它只是读取一个文本文件，然后用分隔符“，”将其吐出。

[考虑从GeoLite 免费下载数据库](http://dev.maxmind.com/geoip/legacy/geolite/)中的遗留国家 CSV 数据中提取

```
"1.0.0.0","1.0.0.255","16777216","16777471","AU","Australia"
"1.0.1.0","1.0.3.255","16777472","16778239","CN","China"
"1.0.4.0","1.0.7.255","16778240","16779263","AU","Australia"
"1.0.8.0","1.0.15.255","16779264","16781311","CN","China"
"1.0.16.0","1.0.31.255","16781312","16785407","JP","Japan"
"1.0.32.0","1.0.63.255","16785408","16793599","CN","China"
"1.0.64.0","1.0.127.255","16793600","16809983","JP","Japan"
"1.0.128.0","1.0.255.255","16809984","16842751","TH","Thailand" 
```

上面的代码将输出如下：

```
Column 4= "AU" , Column 5="Australia"
Column 4= "CN" , Column 5="China"
Column 4= "AU" , Column 5="Australia"
Column 4= "CN" , Column 5="China"
Column 4= "JP" , Column 5="Japan"
Column 4= "CN" , Column 5="China"
Column 4= "JP" , Column 5="Japan"
Column 4= "TH" , Column 5="Thailand" 
```

实际上，您可以`put`使用 a 中的列，`Map`然后简单地使用`key`.

施希尔

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-11-15T15:18:14.037

很抱歉，但这些答案都没有提供最佳解决方案。如果您使用 OpenCSV 之类的库，您将不得不编写大量代码来处理特殊情况以从特定列中提取信息。

例如，如果您的行数少于您所追求的列数，您将不得不编写大量代码来处理它。使用 OpenCSV 示例：

```
 CSVReader reader = new CSVReader(new FileReader(strFile));
  String [] nextLine;
  while ((nextLine = reader.readNext()) != null) {
       //let's say you are interested in getting columns 20, 30, and 40
       String[] outputRow = new String[3];
       if(parsedRow.length < 40){
            outputRow[2] = null;
       } else {
            outputRow[2] = parsedRow[40]
       }
       if(parsedRow.length < 30){
            outputRow[1] = null;
       } else {
            outputRow[1] = parsedRow[30]
       }
       if(parsedRow.length < 20){
            outputRow[0] = null;
       } else {
            outputRow[0] = parsedRow[20]
       }

  } 
```

对于一个简单的需求，这是很多代码。如果您试图按名称获取列的值，情况会变得更糟。您应该使用更现代的解析器，例如[uniVocity-parsers](https://github.com/uniVocity/univocity-parsers/)提供的解析器。

要可靠且轻松地获得所需的列，只需编写：

```
CsvParserSettings settings = new CsvParserSettings();
parserSettings.selectIndexes(20, 30, 40);
CsvParser parser = new CsvParser(settings);
List<String[]> allRows = parser.parseAll(new FileReader(yourFile)); 
```

披露：我是这个库的作者。它是开源和免费的（Apache V2.0 许可证）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-13T11:21:07.837

为了阅读一些特定的专栏，我做了这样的事情：

```
dpkcs.csv content:
FN,LN,EMAIL,CC
Name1,Lname1,email1@gmail.com,CC1
Nmae2,Lname2,email2r@gmail.com,CC2 
```

读取它的功能：

```
private void getEMailRecepientList() {
                List<EmailRecepientData> emailList = null;// Blank list of POJO class
                Scanner scanner = null;
                BufferedReader reader = null;
                try {
                    reader = new BufferedReader(new FileReader("dpkcs.csv"));
                    Map<String, Integer> mailHeader = new HashMap<String, Integer>();
                    // read file line by line
                    String line = null;
                    int index = 0;
                    line = reader.readLine();
                    // Get header from 1st row of csv
                    if (line != null) {
                        StringTokenizer str = new StringTokenizer(line, ",");
                        int headerCount = str.countTokens();
                        for (int i = 0; i < headerCount; i++) {
                            String headerKey = str.nextToken();
                            mailHeader.put(headerKey.toUpperCase(), new Integer(i));

                        }
                    }
                    emailList = new ArrayList<EmailRecepientData>();

                    while ((line = reader.readLine()) != null) {
                    // POJO class for getter and setters
                        EmailRecepientData email = new EmailRecepientData();
                        scanner = new Scanner(line);
                        scanner.useDelimiter(",");
                    //Use Specific key to get value what u want
                        while (scanner.hasNext()) {
                            String data = scanner.next();
                            if (index == mailHeader.get("EMAIL"))
                                email.setEmailId(data);
                            else if (index == mailHeader.get("FN"))
                                email.setFirstName(data);
                            else if (index == mailHeader.get("LN"))
                                email.setLastName(data);
                            else if (index == mailHeader.get("CC"))
                                email.setCouponCode(data);

                            index++;
                        }
                        index = 0;
                        emailList.add(email);
                    }
                    reader.close();
                } catch (Exception e) {
                    StringWriter stack = new StringWriter();
                    e.printStackTrace(new PrintWriter(stack));

                } finally {
                    scanner.close();
                }

                System.out.println("list--" + emailList);

            } 
```

POJO 类：

```
public class EmailRecepientData {
    private String emailId;
    private String firstName;
    private String lastName;
    private String couponCode;

    public String getEmailId() {
        return emailId;
    }

    public void setEmailId(String emailId) {
        this.emailId = emailId;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public String getCouponCode() {
        return couponCode;
    }

    public void setCouponCode(String couponCode) {
        this.couponCode = couponCode;
    }

    @Override
    public String toString() {
        return "Email Id=" + emailId + ", First Name=" + firstName + " ,"
                + " Last Name=" + lastName + ", Coupon Code=" + couponCode + "";
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-04T14:57:35.403

我建议使用 Apache Commons CSV [https://commons.apache.org/proper/commons-csv/](https://commons.apache.org/proper/commons-csv/)

这是一个例子：

```
 Path currentRelativePath = Paths.get("");
    String currentPath = currentRelativePath.toAbsolutePath().toString();
    String csvFile = currentPath + "/pathInYourProject/test.csv";

    Reader in;
    Iterable<CSVRecord> records = null;
    try
    {
        in = new FileReader(csvFile);
        records = CSVFormat.EXCEL.withHeader().parse(in); // header will be ignored
    }
    catch (IOException e)
    {
        e.printStackTrace();
    }

    for (CSVRecord record : records) {
        String line = "";
        for ( int i=0; i < record.size(); i++)
        {
            if ( line == "" )
                line = line.concat(record.get(i));
            else
                line = line.concat("," + record.get(i));
        }
        System.out.println("read line: " + line);
    } 
```

它会自动识别**,**和**"**但不是**;** (也许可以配置...)。

我的示例文件是：

```
col1,col2,col3
val1,"val2",val3
"val4",val5
val6;val7;"val8" 
```

输出是：

```
read line: val1,val2,val3
read line: val4,val5
read line: val6;val7;"val8" 
```

最后一行被认为是一个值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T10:21:07.113

我们可以单独使用核心 java 的东西来逐列读取 CVS 文件。这是我为我的要求编写的示例代码。我相信它会对某些人有所帮助。

```
 BufferedReader br = new BufferedReader(new FileReader(csvFile));
    String line = EMPTY;
    int lineNumber = 0;

    int productURIIndex = -1;
    int marketURIIndex = -1;
    int ingredientURIIndex = -1;
    int companyURIIndex = -1;

    // read comma separated file line by line
    while ((line = br.readLine()) != null) {
        lineNumber++;
        // use comma as line separator
        String[] splitStr = line.split(COMMA);
        int splittedStringLen = splitStr.length;

        // get the product title and uri column index by reading csv header
        // line
        if (lineNumber == 1) {
            for (int i = 0; i < splittedStringLen; i++) {
                if (splitStr[i].equals(PRODUCTURI_TITLE)) {
                    productURIIndex = i;
                    System.out.println("product_uri index:" + productURIIndex);
                }

                if (splitStr[i].equals(MARKETURI_TITLE)) {
                    marketURIIndex = i;
                    System.out.println("marketURIIndex:" + marketURIIndex);
                }

                if (splitStr[i].equals(COMPANYURI_TITLE)) {
                    companyURIIndex = i;
                    System.out.println("companyURIIndex:" + companyURIIndex);
                }

                if (splitStr[i].equals(INGREDIENTURI_TITLE)) {
                    ingredientURIIndex = i;
                    System.out.println("ingredientURIIndex:" + ingredientURIIndex);
                }
            }
        } else {
            if (splitStr != null) {
                String conditionString = EMPTY;
                // avoiding arrayindexoutboundexception when the line
                // contains only ,,,,,,,,,,,,,
                for (String s : splitStr) {
                    conditionString = s;
                }
                if (!conditionString.equals(EMPTY)) {
                    if (productURIIndex != -1) {
                        productCVSUriList.add(splitStr[productURIIndex]);
                    }
                    if (companyURIIndex != -1) {
                        companyCVSUriList.add(splitStr[companyURIIndex]);
                    }
                    if (marketURIIndex != -1) {
                        marketCVSUriList.add(splitStr[marketURIIndex]);
                    }
                    if (ingredientURIIndex != -1) {
                        ingredientCVSUriList.add(splitStr[ingredientURIIndex]);
                    }
                }
            }
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-12T06:27:14.633

查找文件夹中的所有文件并将该数据写入 ArrayList 行。

初始化

```
ArrayList<ArrayList<String>> row=new ArrayList<ArrayList<String>>();
BufferedReader br=null; 
```

用于访问行

```
for(ArrayList<String> data:row){
data.get(col no); 
}
or row.get(0).get(0) // getting first row first col 
```

从文件夹中读取所有文件并将它们连接到行的函数。

```
static void readData(){
String path="C:\\Users\\Galaxy Computers\\Desktop\\Java project\\Nasdaq\\";
File files=new File(path);
String[] list=files.list();

try {
        String sCurrentLine;
       char check;
       for(String filename:list){ 
        br = new BufferedReader(new FileReader(path+filename));
        br.readLine();//If file contains uneccessary first line.
        while ((sCurrentLine = br.readLine()) != null) {

           row.add(splitLine(sCurrentLine));
        }
        }
        }

    } catch (IOException e) {
        e.printStackTrace();
    } 
        try {
            if (br != null)br.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

   static ArrayList<String> splitLine(String line){
   String[] ar=line.split(",");
   ArrayList<String> d=new ArrayList<String>();
   for(String data:ar){
    d.add(data);
   }

   return d; 
   } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-04-30T09:32:53.760

好吧，这个怎么样！！

此代码计算 csv 文件中的行数和列数。试试这个！

```
 static int[] getRowsColsNo() {
    Scanner scanIn = null;
    int rows = 0;
    int cols = 0;
    String InputLine = "";
    try {
        scanIn = new Scanner(new BufferedReader(
                new FileReader("filename.csv")));
        scanIn.useDelimiter(",");
        while (scanIn.hasNextLine()) {
            InputLine = scanIn.nextLine();
            String[] InArray = InputLine.split(",");
            rows++;
            cols = InArray.length;
        }

    } catch (Exception e) {
        System.out.println(e);
    }
    return new int[] { rows, cols };
} 
```

# java - 如何从 Java 中的字符串/文件名中提取数字？

> ID：12169042
> 
> 赞同：0
> 
> 时间：2012-08-28T23:40:24.763
> 
> 标签：java, string, parsing, date

希望有人可以帮助我解决这个问题..或者至少为我指明正确的方向。

首先，我有一堆名称如下的文件：

```
vendor.2012-07-25
vendor.2012-07-25 2
ven_dor.2012-05-18
ven_dor.2012-05-18 2 
```

基本上是一个供应商名称（有时一个单词，有时两个带下划线）+（句点“.”）+（年）+（月）+（日）。年、月、日用 (-) 分隔。可能有多个同名文件，在日期后用 2/3/4 等表示。

我通过执行 file.getName(); 将这些作为字符串获取 其中“文件”是从 JFileChooser 中选择的文件

然后我需要根据日期绘制一些数据。我应该尝试用“。”分割初始文件名字符串吗？首先，将供应商和日期分开，然后用“-”拆分/划分剩余部分以获得年/月/日的单独值？

我在想这可能是一个正则表达式的事情，但我在那个领域很弱......所以我想出了双重分裂。有人有意见或建议吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T23:45:47.123

实际上，您可以使用[正则表达式](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)：

```
String s = "vendor.2012-07-25 2";
Pattern p = Pattern.compile("([^.]+)\\.(\\d{4})-(\\d{2})-(\\d{2}) ?(\\d?)");
Matcher m = p.matcher(s);
if (m.find()) {
  String vendorName = m.group(1);
  String year = m.group(2);
  String month = m.group(3);
  String day = m.group(4);
  String multipleFiles = m.groupCount() > 4 ? m.group(5) : "";
  System.out.printf("%s %s %s %s %s", vendorName, year, month, day, multipleFiles);
} 
```

每个用括号包裹的表达式`()`称为一个*捕获组*，它基本上告诉正则表达式引擎保存其内容，以便以后可以检索它。

总之，这是每个捕获组所做的事情：

1.  `([^.]+)`- 除了点 ( `.`) 之外的所有内容，因此我们基本上捕获了供应商名称部分；
2.  `(\\d{4})`-`\d`匹配一个数字。`\d{4}`匹配`4`数字（年份）；
3.  `(\\d{2})`- 月;
4.  `(\\d{2})`- 天;
5.  `(\\d?)`- 匹配可选的 ( `?`) 最后一位数字。

如果要将日期部分解析为`java.Util.Date`实例，可以为其使用单个捕获组，然后使用`SimpleDateFormat`：

```
Pattern p = Pattern.compile("([^.]+)\\.(\\d{4}-\\d{2}-\\d{2}) ?(\\d?)");
Matcher m = p.matcher(s);
if (m.find()) {
  String vendorName = m.group(1);
  String dateString = m.group(2);
  SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd");
  String multipleFiles = m.groupCount() > 2 ? m.group(3) : "";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T23:45:33.150

*   `String.split`在`.`（它可能需要转义）。将视为or`dotSplitString[1]`之后的部分`vendor.``ven_dor.`
*   在空格`( `spaceSplitString`) 上拆分该部分。`
`*   使用解析第一部分`DateFormat.parse(String)`得到一个`Date`*   如果（的）的第二部分`spaceSplitString`存在，请使用`Integer.parseInt(spaceSplitString[1])``

 `* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T23:47:04.950

[Java API 字符串标记器类](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html)

你可以做的是：

```
tokenizer = new StringTokenizer(file.getName(), ".");
tokenizer.nextElement(); 
```

你得到了图片，或者你也可以使用 Scanner 来解析它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T00:16:58.743

我倾向于在我的代码中大量使用 StringTokenizers。要标记上面的示例，您可以使用类似于以下内容的内容：

```
StringTokenizer tok = new StringTokenizer(filename,".-"); //在'.'上标记两者 和 '-'
字符串名称 = tok.nextToken();
int year = Integer.parseInt(tok.nextToken());
int 月 = Integer.parseInt(tok.nextToken());
int day = Integer.parseInt(tok.nextToken());
int cnt = 1; //默认一份文件
如果（tok.hasMoreTokens（））{
     cnt = Integer.parseInt(tok.nextToken());
}

```

...等等。

但是，我赞同使用上面的正则表达式解决方案，这不仅是因为它对于外行来说看起来不太容易理解。为了完整起见，仅将其包括在这里。`

# jquery - 在 jQuery 中单击时添加随机数

> ID：12169044
> 
> 赞同：0
> 
> 时间：2012-08-28T23:40:35.653
> 
> 标签：jquery, math

我了解随机数和添加数字，但我不明白如何将随机数添加到当前显示的数字中。[我在这里](http://jsfiddle.net/CsHyW/)有一个 jsFiddle ，它显示了我现在拥有的内容，但我希望该按钮在每次单击时添加另一个随机数到显示的当前数字。

编辑：我应该澄清我的 jsFiddle 很笨重，我想要一个更有效的解决方案来解决我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:52:08.360

为什么会有这样一个令人费解的例子？如果我理解正确，这应该有效：

[http://jsfiddle.net/CsHyW/10/](http://jsfiddle.net/CsHyW/10/)

```
var max = 13;
var $wrap = $('#randomnumber');
$('#getit').click(function() {
    var num = +$wrap.text();
    $wrap.text(num + Math.ceil(Math.random() * max));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T23:45:11.490

设置`randomnumber`div 时，您可以使用

```
$("#randomnumber").text(($("#randomnumber").text() * 1) + numRand); 
```

空白或最新总数`$("#randomnumber").text() * 1`将在哪里`0`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T23:47:54.047

将 Sum 值保存在全局变量中。每次生成新的随机数时添加。

Jsfiddle 示例：http: [//jsfiddle.net/CsHyW/4/](http://jsfiddle.net/CsHyW/4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T23:49:25.430

如果我正确理解了您的问题，您想要存储所有生成的数字或将它们的值添加到累积变量中。这是两者的结合，它会提醒数字数组以及累积的结果。

[解决方案](http://jsfiddle.net/CsHyW/5/)

# mysql - 如何知道何时在 mysql 中创建列？

> ID：12169045
> 
> 赞同：0
> 
> 时间：2012-08-28T23:40:56.657
> 
> 标签：mysql

有什么方法可以知道何时从元数据中在 mysql 中创建列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:57:28.057

不，除非您自己在专栏上发表评论，否则不会。参考：[http ://dev.mysql.com/doc/refman/5.0/en/columns-table.html](http://dev.mysql.com/doc/refman/5.0/en/columns-table.html)

# php - 每5句后加“ ”？

> ID：12169048
> 
> 赞同：-1
> 
> 时间：2012-08-28T23:41:42.710
> 
> 标签：php

想象一篇没有换行符的很长的文章。就像

```
sentence 1\. sentence 2\. sentence 3\. sentence 4\. sentence 5\. sentence 6\. sentence 7\. 
sentence 8\. sentence 9\. sentence 10\. sentence 11\. sentence 12\. sentence 13\. sentence 14\. 
sentence 15\. sentence 16\. sentence 17\. sentence 18\. sentence 19\. sentence 20\. sentence 
21\. sentence 22\. sentence 23\. sentence 24\. sentence 25. 
```

我想在每 5 个句子后添加换行符。或在每 5 个“。”之后

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:47:29.193

这是一个非常糟糕的方式，我认为这可以用正则表达式来完成，但无论如何。

```
<?php
$str = "a.b.c.d.e.f.g.h.i.j.";
$arr = explode(".", $str);
$new_str = "";
$j = 1;
foreach($arr as $arr_el) {
    $new_str .= $arr_el.".";
    if($j % 5 == 0) {
        $new_str .= "<br/><br/>";
    }
    $j++;
}

echo $new_str; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T23:47:43.203

```
$str="long sentence. long sentence. ";
$lines=explode('. ', $str); // Break sentence with ". "
$i=1;
    foreach($lines as $l){
    echo $lines;
    if ($i%5==0){echo "<br /><br />";}
i++;
} 
```

如果句子那么简单，可能对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T23:47:42.050

这个难题有两个部分：

1.  将输入文本分解成句子
2.  每 5 个句子插入所需的文本

我不打算解决＃1，因为通常结果是“每五个点之后”实际上并没有在实践中削减它，所以每个人都会使用他们的正则表达式，而在你知道它之前，你应该有一堆不可读的正则表达式做出明智的选择。我只想说，按周期拆分可以很简单，`explode(".", $string)`然后就这样吧。

谢天谢地，第二个问题更容易。假设这`$sentences`是一个字符串数组，其中每个字符串是一个句子（包括结束句点），您可以这样做：

```
$chunks = array_chunk($sentences, 5);
foreach($chunks as &$chunk) {
    $chunk = implode(' ', $chunk);
}
$result = implode("<br><br>", $chunks); 
```

我承认我被吸引到提供这个代码，因为它不是你每天都可以使用的[`array_chunk`](http://www.php.net/manual/en/function.array-chunk.php)。

# javascript - 无法创建主干视图的新实例

> ID：12169052
> 
> 赞同：0
> 
> 时间：2012-08-28T23:42:19.337
> 
> 标签：javascript, oop, backbone.js, multiple-instances, backbone-views

我有一个“主”视图，如果你愿意的话，一个布局，它通过该`loadView`方法加载其他视图。我的问题是这些视图类执行一些`initialize`只能执行一次的初始化逻辑（in ）（与模板有关）。但是，如果我多次尝试实例化这些类，则会收到在同一个实例上调用 initialize 的错误症状。

我已经尝试在控制台中通过加载类并使用创建两个新实例来分别实例化它们，`var x = new MyViewClass();`但每次第一个实例实例化而第二个实例由于模板已经初始化导致的错误而失败。

这真的不应该发生，但我无法终生看到导致问题的原因。

布局的加载代码如下。

```
loadView: function(name, bootstrap_function) {
    this.unloadView();

    var _class  = require('View/'+name),                // Let's load the view file
        pretty  = name.replace('/', ''),                // Prettify the name by removing slashes (should end up with some camelcased niceness)
        bs_name = '__bootstrap'+pretty,                 // Generate the name of the bootstrap function
        view    = new _class();                         // Pass the event aggregator in

    // If there is a bootstrap function, bootstrap
    if(typeOf(bootstrap_function) == 'function') {      // Check if one has been passed in
        bootstrap_function.call(this, view);            // Bootstrap: function(AppView, LoadedView)
    }

    this._loaded = view;                                // Store the view in _loaded

    // Now that we have a view to play with
    // we should insert it into our container object
    view.$el.appendTo(this.$container);

    // And render!
    view.render();
},

unloadView: function() {
    if(this._loaded !== null) {
        this._loaded.remove();
        this._loaded.unbind();
        this._loaded = null;
    }
} 
```

**编辑**

有错误的模板代码是这样的：

```
processTemplates: function() {
    if(this.templates === undefined) return this;

    console.log(this.templates);

    if(Object.getLength(this.templates) > 0) {
        Object.each(this.templates, function(template, name) {
            this.templates[name] = _.template(template);
        }, this);
    }

    return this;
}, 
```

`console.log(this.templates)`输出显示，在第一次初始化时，它`this.templates`应该包含字符串，但在第二次初始化时，它显示模板函数（只有在`processTemplates()`调用之后才会出现这种情况。

我想知道它是否与我的类的定义方式有关，例如：

```
define(
    ['backbone', 'View/Kords', 'text!Template/Pages/Landing.html', 'Collection/TenantTypes'],
    function(Backbone, KordsView, landing_html, TenantTypesCollection) {
        var LandingView = KordsView.extend({
            tagName: 'div',
            className: 'tiled-light',

            templates: {
                'main': landing_html
            }, 
```

`landing_html`在类中是这样定义的，但是会不会有引用问题？`_.template`应该不会影响`landing_html`范围内的值吧？

**编辑#2**

这与对landing_html 的引用无关。我尝试将 templates.main 设置为类定义中的字符串，但我仍然像以前一样遇到错误。

# iphone - 可访问性在 KIF 中检测为未启用

> ID：12169053
> 
> 赞同：0
> 
> 时间：2012-08-28T23:42:21.770
> 
> 标签：iphone, ios, ipad, ios-simulator, kif

我在 iOS 模拟器中打开了可访问性并尝试运行我的 KIF 测试，但我经常收到以下错误：

```
** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'The accessibility inspector must be enabled in order to run KIF tests. It can be turned on in the Settings app of the simulator by going to General -> Accessibility.' 
```

我已经在 plist 中仔细检查了它是否通过以下方式启用：

```
/usr/libexec/PlistBuddy -c "Print :AXInspectorEnabled"  ~/Library/Application\ Support/iPhone\ Simulator/5.0/Library/Preferences/com.apple.Accessibility.plist 
```

它表明它是。

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T22:00:20.073

我可以通过在 applicationDidBecomeActive 中运行测试来解决这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T00:09:29.060

测试可访问性检查器的代码对我来说也失败了。我分叉了 KIF 存储库并在此处修复：[https ://github.com/mflint/KIF/tree/fix-accessibility-inspector-detection](https://github.com/mflint/KIF/tree/fix-accessibility-inspector-detection)

在此处请求请求：[https ://github.com/square/KIF/pull/152](https://github.com/square/KIF/pull/152)

# python - 通过值或引用传递实现堆排序的递归

> ID：12169055
> 
> 赞同：1
> 
> 时间：2012-08-28T23:43:04.577
> 
> 标签：python, algorithm, recursion

我正在尝试使用[Intro to Algorithms](https://rads.stackoverflow.com/amzn/click/com/0262033844)一书中的伪代码来实现堆排序。以下是我所拥有的：

```
def parent(i):
    return i/2

def left(i):
    return 2*i

def right(i):
    return 2*i+1

def max_heapify(seq, i, n):
    l = left(i)
    r = right(i)

    if l <= n and seq[n] > seq[i]:
        largest = l
    else:
        largest = i
    if r <= n and seq[r] > seq[largest]:
        largest = r

    if largest != i:
        seq[i], seq[largest] = seq[largest], seq[i]
        max_heapify(seq, largest, n)

def heap_length(seq):
    return len(seq) - 1

def build_heap(seq):
    n = heap_length(seq)
    for i in range(n/2,0,-1):
        max_heapify(seq, i, n)

def sort(seq):
    build_heap(seq)
    heap_size = heap_length(seq)
    for i in range(heap_size,1,-1):
        seq[1], seq[i] = seq[i], seq[1]
        heap_size = heap_size - 1
        max_heapify(seq, 1, heap_size)

    return seq 
```

我在理解 Python 中的值传递或引用传递时遇到问题。我查看了以下[问题](https://stackoverflow.com/questions/986006/python-how-do-i-pass-a-variable-by-reference)，似乎我正在按值传递列表。我的问题是如何通过引用或值返回正确排序的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:47:33.640

如果要按值传递，则数组始终按引用传递，请使用切片

`my_func(my_array[:])`#发送副本

`my_func(my_array) #array is modified inside and changes are reflected in original`

# c++ - C++ 文件 I/O 制表符分隔数据

> ID：12169057
> 
> 赞同：-1
> 
> 时间：2012-08-28T23:43:36.433
> 
> 标签：c++, file-io

我有一个带有如下数字的文本文件： num1 TAB num2 TAB.... num22 newline 。. .

我想阅读 num1 检查它是否等于 3，如果是，则将整行复制到一个新文件中。最快的方法是什么？该文件相当大80Mb +。此外，num 1 是重复的，即它以 0.001 的步长从 0 变为 3。所以我只需要阅读每一个这么多的步骤。我不确定如何告诉计算机先验跳过 x 行？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:02:21.693

伪代码可以如下所示：

```
while (not eof) {
    fgets(...);
    find TAB symbol or end of line
    get string between two marks 
    cleain it from spaces and other unnecessary symbols
    float fval = atof(...);
    if (fval == 3) {
        write the string into new file
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:23:04.840

鉴于您已经说过运行时性能不是主要问题，那么以下内容清晰简洁：

```
#include <string>
#include <fstream>

void foo(std::string const& in_fn, std::string const& out_fn)
{
    std::ifstream is(in_fn);
    std::ofstream os(out_fn);

    std::string line;
    while (std::getline(is, line))
        if (line.size() && std::stoi(line) == 3)
            os << line << '\n';
} 
```

（假定支持 C++11；为简洁起见省略了错误处理。）

# android - 从按钮制作一个类似微调器的下拉框？

> ID：12169060
> 
> 赞同：2
> 
> 时间：2012-08-28T23:44:40.317
> 
> 标签：android, menu, popup, android-spinner

我试图弄清楚如何创建在 Google Now 中使用的这种样式，“设置”如何看起来是一个 Spinner 下拉框，但不使用典型的`Spinner`设计： ![漂亮的设计啊！](../Images/537d8dc5fcedda8b275202fff9a14082.png)

关于如何模仿这个的任何想法/建议？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:04:19.773

这称为弹出菜单。例如，它在 apidemos 中实现。

有没有看 ApiDemos->Views->popup menu 的例子。这可能是合适的。附上截图供您参考。弹出菜单自 API 11 起可用。参考。 [http://developer.android.com/reference/android/widget/PopupMenu.html](http://developer.android.com/reference/android/widget/PopupMenu.html)

或者

这也可能有用

[http://i.stack.imgur.com/AiAOg.png](https://i.stack.imgur.com/AiAOg.png)

您可以从以下网址获取图书馆：[https ://github.com/JakeWharton/ActionBarSherlock](https://github.com/JakeWharton/ActionBarSherlock)

或者

如果您想与菜单项一起显示图标，那么我建议您访问此帖子，请参阅此解决方案[stackoverflow.com/a/11765787/1143977](https://stackoverflow.com/a/11765787/1143977)

![弹出菜单](../Images/386c2f43cb8594b39d72d54fbaac89af.png)

# regex - 如何替换“XXX” | {"Foo", "Bar"} 到 "YYY" | {"Foo"} 在目录中的所有文件中递归？

> ID：12169061
> 
> 赞同：0
> 
> 时间：2012-08-28T23:44:53.097
> 
> 标签：regex, sed, grep, substitution

如何在目录中递归替换`"XXX" | {"Foo", "Bar"}`所有`"YYY" | {"Foo"}`文件？

我想使用`sed`，但这里的特殊字符很棘手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:44:03.327

`find`使用and的一种方法`xargs`：

```
find . -type f -print0 | xargs -0 sed -i -r 's/"XXX" \| \{"Foo", "Bar"\}/"YYY" \| \{"Foo"\}/g' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T07:00:43.613

这可能对您有用（GNU sed）：

```
find . -type f -print0 | 
xargs -0 sed -i '/"XXX"\s*|\s*{\s*\("[^"]*"\)\s*,\s*"[^"]*"\s*}/s//"YYY" | {\1}/g' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T05:38:36.890

使用 perl：

```
> find . -type f|xargs perl -p -e 's/"XXX" \| {"Foo", "Bar"}/"YYY" \| {"Foo"}/g 
```

# ios - 有没有更有效的方法来比较 C 中的字节数组

> ID：12169063
> 
> 赞同：1
> 
> 时间：2012-08-28T23:44:56.543
> 
> 标签：ios, c

我试图通过查看前四个字节来检测给定文件是否是 ZIP 文件。这是在 iOS 应用程序中，因此文件句柄由 Cocoa 框架处理，但实际的字节比较内容是 C 语言，我真的不知道。

```
 unsigned char aBuffer[4];
    NSFileHandle *fileHandle = [NSFileHandle fileHandleForReadingAtPath:filePath];
    NSData *data = [fileHandle readDataOfLength:4];
    [data getBytes:aBuffer];
    if (aBuffer[0] == 0x50 && aBuffer[1] == 0x4b && aBuffer[2] == 0x03 && aBuffer[3] == 0x04) {
        archiveType = ARCHIVE_TYPE_ZIP;
    } 
```

它有效，但让我觉得笨拙。有没有更好的方法来比较这 4 个字节？（是的，我知道它需要更多的错误检查。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T23:48:51.287

你应该使用[`memcmp`](http://www.cplusplus.com/reference/clibrary/cstring/memcmp/). 就像`strcmp`，但为了记忆。

```
if (memcmp([data bytes],"PK\3\4",4) == 0) {
    // success
} 
```

也就是说，由于您使用的是 Objective-C，因此您应该寻找比 C 更高级别的实现。我建议使用您期望的数据构建一个 NSData，然后使用`[data isEqual: expectedData]`.

```
NSData *expectedHeader = [NSData dataWithBytes: "PK\3\4" length: 4];
if ([expectedHeader isEqual: data]) {
    // success
} 
```

您也可以`isEqualToData:`改用 if `isEqual:`。我更喜欢短标识符，但`isEqualToData:`效率更高，并且在暴露于不匹配的类型时会抛出异常。

您现在非常接近您的**意图**，而不是实际的机制。

@jsd 澄清说他在寻找程序员的效率，而不是运行时的效率。但是对于将来阅读本文的任何人：忘记运行时效率。您多久检查一次 zip 标头？相反，担心代码有多简单以及它可能出错的方式有多少。并且总是在合适的时候支持更高级别的抽象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T23:54:02.793

您总是可以输入`aBuffer`a `union`，因此您只需进行一次比较即可检查：

```
union {
  unsigned char asBytes[4];
  uint32_t asInt;
} aBuffer;
...
[data getBytes:aBuffer.asBytes];
if (aBuffer.asInt == 0x504b0304) { ... } // or 0x04034b50, depending on endianness 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T23:56:41.763

我真的没有想到任何更有效的方法。

编译器可能会很好地为您优化它。

而且由于它只是一个不在循环或任何东西中的语句，我不确定是否有理由尝试手动优化它。

您可以做的一件事是进行无符号长比较，如

```
unsigned char fileCheck [4] = {0x50, 0x4b, 0x03, 0x04};
unsigned char aBuffer[4];

NSFileHandle *fileHandle = [NSFileHandle fileHandleForReadingAtPath:filePath];
NSData *data = [fileHandle readDataOfLength:4];
[data getBytes:aBuffer];

if (*(unsigned long *)aBuffer == *(unsigned long *)fileCheck) {
    // it is a file
    archiveType = ARCHIVE_TYPE_ZIP;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T23:50:58.120

这很笨拙，但不太可能是低效的。

另一种方法是使用 C 的[`memcmp`](http://linux.die.net/man/3/memcmp)函数。例如：

```
if(!memcmp(aBuffer, "PK\003\004", 4))
{
    archiveType = ARCHIVE_TYPE_ZIP;
} 
```

您可能还希望削减额外的缓冲区：

```
NSFileHandle *fileHandle = [NSFileHandle fileHandleForReadingAtPath:filePath];
NSData *data = [fileHandle readDataOfLength:4];
if ([data length] >= 4 && !memcmp([data bytes], "PK\003\004", 4))     
{
    archiveType = ARCHIVE_TYPE_ZIP;
} 
```

C（以及因此，Objective-C）保证从左到右评估 if 语句并在可能的情况下提前退出，因此首先检查长度将明确避免`memcmp`超出范围。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-28T23:59:21.597

您是否尝试过以下操作？

```
if (*((unsigned int *) aBuffer) == 'PK\3\4') {
    archiveType = ARCHIVE_TYPE_ZIP;
} 
```

这应该适用于数据类型大小一致的 iOS 设备，例如 iPad 和 iPhone。

那些反对我的人一定不熟悉多字符文字。

# matlab - 如何让 Matlab 与另一个功能集成？

> ID：12169071
> 
> 赞同：1
> 
> 时间：2012-08-28T23:45:55.917
> 
> 标签：matlab, integration

假设我想找到从 a 到 b 的 stieltjes 积分 f(x) dg(x) 的值。换句话说，将 f(x) 与 g(x) 积分。我知道变量和函数值，我正在寻找数值结果。

Matlab中是否有执行此操作的标准函数？我一直在通过矩形方法手动计算它，任何 Matlab 函数会更快和/或更准确吗？

我对 Matlab 没有太多经验，在文档中找不到解决方案。任何帮助，将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T02:24:30.327

没有函数支持这一点，但如果你有任何一个函数的派生，你可以使用 quad（或 quad 家族的其他成员）。如果你有 g(x) 的导数，那么

积分(a,b) f(x) dg(x) = 积分(a,b) f(x) g'(x) dx [[如果 g'(x) 有界]]

如果你有 f(x) 的导数，你可以使用部分积分来获得

积分(a,b) f(x) g'(x) dx = f(b)g(b) - f(a)g(a) - 积分(a,b) f'(x) g(x) dx

# r - 从网上下载

> ID：12169074
> 
> 赞同：0
> 
> 时间：2012-08-28T23:46:43.357
> 
> 标签：r

最好不要在R中使用“for循环，while循环”，我想用两种方法从网上下载一个url：

1.使用for循环

```
url1="http://stat.ethz.ch/R-manual/R-devel/library/base/html/connections.html"
url2="http://en.wikipedia.org/wiki/Xz"
url=c(url1,url2)
dw=c("test1","test2")
for (i in 1:2){download.file(url[i],destfile=dw[i])} 
```

如何将“for loop”方法更改为“apply”方法？

2.使用 RCurl

```
require(RCurl)
urls = c("http://stat.ethz.ch/R-manual/R-devel/library/base/html/connections.html", "http://en.wikipedia.org/wiki/Xz")
txt = getURIAsynchronous(urls) 
```

网址包含数千个网址怎么样？如果 url 包含 10000 个网址，则没有足够的内存或磁盘空间...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:01:56.963

您可以使用`mapply`

```
urls <- rep('http://stackoverflow.com/questions/12169074/download-from-web',2) 
destfiles <- paste0('test',1:2,'.html')

mapply(download.file, url = urls, destfile = destfiles) 
```

类似的方法应该适用`RCurl`，尽管由于防火墙/代理限制，我无法对此进行测试

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:05:45.433

关于您的 for 循环问题，您可以使用以下内容：

```
sapply(seq_along(url), function(n) download.file(url[n], dw[n]) 
```

这与您的 for 循环非常相似。或者@mnel 有一个很好的解决方案`mapply`。但是，在这种情况下，不赞成使用 for 循环。事实上，在 R 中有许多编写 for 循环的方法并不慢。R Inferno 对此有很好的部分。

最短的答案是，只要输出是预先分配的而不是在循环期间增长，R 中的 for 循环就可以了。

至于您的`RCurl`问题，如果您遇到内存错误，您有两个选择。1.获取更多内存。或者 2\. 分块下载数据并将其写入磁盘，然后再下载更多。

# java - 制作一个android游戏，不知道如何处理这个

> ID：12169076
> 
> 赞同：0
> 
> 时间：2012-08-28T23:46:56.133
> 
> 标签：java, android

我正在用 Android/Java 设计一个游戏，到目前为止一切都很顺利。游戏从一副 52 张牌中随机显示一张牌，用户必须确定下一张牌是更高还是更低。我把我的 switch 和 case 放在我的主课上，我不确定如何重新运行 switch 和 case 语句来随机抽取另一张卡片。

下面是我的课程，我知道我不需要这么多，但我改变了很多代码，因为我的原始代码试图让它工作。我知道问题不在于我的应用程序，而是因为我在 android 方面缺乏经验……查看代码并告诉我您的想法。由于这是一个相当广泛的问题，并且可能有多个答案，因此我会投票给所有给我相关答案的人，无论我是否使用该解决方案。

谢谢，

-史蒂夫

我的主要游戏课程：

```
public class Game extends SwarmActivity {

int cardNum;

Deck d = new Deck();
int x = d.shuffle();
String y = String.valueOf(x);

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.game);
    Swarm.init(this, 1388, "1e02a1ecfa9483b7b62e7b32c7e055f3");
    TextView t = (TextView) findViewById(R.id.score);
    ImageView display = (ImageView) findViewById(R.id.display);

    switch (x) {

    case 0:
        display.setImageResource(R.drawable.c_one);
        cardNum = 1;
        break;
    case 1:
        display.setImageResource(R.drawable.c_two);
        cardNum = 2;
        break;
    case 2:
        display.setImageResource(R.drawable.c_three);
        cardNum = 3;
        break;
    case 3:
        display.setImageResource(R.drawable.c_four);
        cardNum = 4;
        break;
    case 4:
        display.setImageResource(R.drawable.c_five);
        cardNum = 5;
        break;
    ---------- (5-49) ----------
    case 50:
        display.setImageResource(R.drawable.c_fiftyone);
        cardNum = 51;
        break;
    case 51:
        display.setImageResource(R.drawable.c_fiftytwo);
        cardNum = 52;
        break;

    }

    ImageView higher = (ImageView) findViewById(R.id.btn_higher);
    ImageView lower = (ImageView) findViewById(R.id.btn_lower);

    higher.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {

        }
    });

    lower.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {

        }
    });
} 
```

}

甲板课：（最初这是在我的游戏课上）

```
public class Deck {

public int shuffle() {

    Shuffle s = new Shuffle();
    int[] shuffDeck = s.getShuffle();
    int i = 0;
    int x = shuffDeck[i];
    String y = String.valueOf(x);

    return x;

} 
```

}

Shuffle Class：（原来这是在我的游戏课上）

```
public class Shuffle {
public static int[] getShuffle() {
    int[] cards = new int[52];
    ArrayList<Integer> cards_objs = new ArrayList<Integer>();

    for (int i = 0; i < cards.length; i++) {
        cards_objs.add(i);
    }

    Collections.shuffle(cards_objs);

    for (int i = 0; i < cards.length; i++) {
        cards[i] = cards_objs.get(i);

    }

    return cards;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:16:52.510

如果您想替换那个大开关盒，请尝试将您的可绘制对象命名为 card_00.png、card_01.png ... card_51.png。这样，您可以使用反射 API（或其他东西）更轻松地访问您的可绘制 ID，如下所示：

```
int [] cards = new int [52];

Field  [] fields = R.drawable.class.getDeclaredFields();

String [] names = new String[52];

for(int i=0; i<fields.length; i++)
    if(fields[i].getName().contains("card_"))
        names[i] = fields[i].getName();

Arrays.sort(names);

try
{
    for(int i=0; i<names.length; i++)
        cards[i] = R.drawable.class.getField(names[i]).getInt(null);
}
catch(Exception ex){} 
```

如果一切顺利，那么现在你有一个包含所有卡片可绘制 ID 的数组。现在你的生活简单了 90%。要设置随机卡，只需使用：

```
//create a Random object, and an integer 
//indicating the current card as a member of your class:
Random random = new Random();
int actual = 0;

//then for random card selection:
actual = random.nextInt(52);
display.setImageResource(cards[actual]);

//for getting a higher card:
actual = actual<51 ? actual+1 : actual;
display.setImageResource(cards[actual]);

//for getting a lower card:
actual = actual>0 ? actual-1 : actual;
display.setImageResource(cards[actual]); 
```

# php - PHP 和 AJAX 安全性

> ID：12169086
> 
> 赞同：0
> 
> 时间：2012-08-28T23:47:46.873
> 
> 标签：php, html, ajax

过去，当我用 jQuery 编写 HTML 时，为了访问特定的 PHP 页面，我总是这样做：

```
user.php?Action=1&User=Adrian..... 
```

这将返回纯文本 JSON，jQuery 将其转换为 javascript 对象。不过，我对这种方法有一些疑问。

1.  这安全吗？JSON 以纯文本形式传回。它应该通过 HTTPS 使用吗？
2.  防止直接访问 PHP 的最佳方法是什么？只是检查活动会话？
3.  这整个方法可以吗？

干杯，阿德里安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T23:55:17.113

对于数字 2，这取决于您在做什么。

如果您正在使用“user.php”文件对数据库进行任何更改，您可能希望使用 POST 而不是 GET（这会隐藏 URL 栏中的参数，并且如果您的页面被抓取/刮）。

要使用 POST，请在您的 user.php 文件中将实例替换`$_GET`为`$_POST`.

在您的 jQuery Ajax 调用中，确保参数“type”设置为“POST”

`type: "POST",`

GET 请求应该只用于从您的数据模型（DB，等等）获取和显示数据的任何事情。POST 请求用于进行任何更新、添加（更严格的是 PUT）或删除（DELETE）。

如果您只希望该特定用户访问 user.php 脚本，那么您需要检查用户的会话并确保它与尝试访问特定用户参数的用户匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T23:49:50.680

1）这取决于您要转移的内容。如果您通过 HTTPS 传输信用卡数据，那肯定是。如果您正在传输不太敏感的数据，也许不会。

2 和 3) 确保检查 SQL 注入的输入，就像检查任何 $_GET 变量一样。你真的应该像平常对待 $_GET 数据一样对待它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T23:55:02.427

每当我允许 JSON/crud 访问时，我总是在`user.php`基于会话的访问控制规则（基于角色或基于组的权限）之后保护为其提供服务的 PHP 页面（）。然后，我将允许用户/组/角色访问的表/字段列入白名单。复杂程度取决于所服务数据的性质。

# c++ - 将 C++ 中的“extern C”与 ctypes 的向量一起使用

> ID：12169091
> 
> 赞同：0
> 
> 时间：2012-08-28T23:47:55.527
> 
> 标签：c++, stl, ctypes, extern

我的目标是使用 ctypes 从 Python 中调用我单独创建的 C++ 库，其中我通过指针将 numpy 向量传递给 C++ 例程。因此 Python 将分配内存并仅传递地址，然后 C++ 例程将访问数据并执行其计算并返回结果。

由于我是 ctypes 的新手，现在我正在逐步构建一个工作玩具示例。我开始编写 C++ 代码并创建 Python 包装器代码将使用的 C 外部接口。我什至还没有开始编写 Python 包装器代码，但已经在这方面有了一些经验。

这是我的示例，其中包括一个构造函数和一个简单的总函数。

```
// foo.cpp //
#include <iostream>
#include <string>
#include <vector>
using namespace std;

class Data {
public:
  Data(vector<double>*);
  void PrintTotal(void);
private:
  vector<double>* myContents;
};
Data::Data(vector<double>* input) {
  std::cout << "Entered constructor in C++" << std::endl;
  myContents = input;
}
void Data::PrintTotal(void) {
  double total = 0;
  for (int i=0; i<myContents->size(); i++){
    total += (*myContents)[i];
  }
  std::cout << "Hello, my total is " << total << std::endl;
}

extern "C" {
  Data* Data_new(double (**input)) {return new Data(input);}
  void Print_Total(Data* pData) {pData->PrintTotal();}
} 
```

请特别注意，我使用的是 STL 中的向量类，这可能是下面描述的问题的一部分。这个想法是类`Data`持有指向数据的指针并且不复制数据。

当我尝试使用命令编译它时

```
g++ -c -fPIC foo.cpp -o foo.o 
```

在我们的 Linux 机器上，我收到以下错误：

```
foo.cpp: In function âData* Data_new(double**)â:
foo.cpp:26: error: no matching function for call to âData::Data(double**&)â
foo.cpp:13: note: candidates are: Data::Data(std::vector<double, std::allocator<double> >*)
foo.cpp:6: note:                 Data::Data(const Data&) 
```

这对我来说似乎很清楚：它是说我在倒数第三行 (#26) 中调用 Data 构造函数的方式`foo.cpp`与我在代码的 C++ 部分中编写的构造函数不一致。在 C++ 代码和 C extern 代码中，我想说输入是指向双精度向量/数组的指针。我在第 36 行尝试了其他选项，但仍然无法编译。

如何在 C++ 部分中仍然使用`vector`类（在编写真正的算法时会发现它很有用）的同时编写 extern C 部分？我是否遇到了麻烦，因为`vector`它是 STL 的一部分，它不适用于 extern C？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:29:13.040

首先，让我们回答你的问题。您应该更改您的构造函数，使其采用与 Data_new 相同的参数，并将输入转换为 std::vector。但是，您首先需要关注几个概念问题：

*   数组和向量是不等价的：如果你的输入指向一个数组，但你想使用一个向量，你需要将数组中的所有元素复制到向量中（或者让向量构造函数来做你）。您需要进行复制，因为所有 STL 容器都保存了放入其中的元素的副本。

*   您可以使用两个迭代器构造向量，其中：

    `myContents(data, data + numberOfElements);`

    但这引出了第二个概念点——代码签名中没有任何内容可以告诉您输入数组有多大。

*   在 Data 中，你持有一个指向向量的指针，但你永远不会释放它。这是内存泄漏。话虽如此，您可能应该只保留一个向量，而不是指向向量的指针。

# python - Python：我有一个双键列表，这是最有效的检索存储对象

> ID：12169092
> 
> 赞同：2
> 
> 时间：2012-08-28T23:48:06.933
> 
> 标签：python

我正在使用两个包含复杂关系的分层数据集（我没有使用 SQL）并且它们不共享它们的主查找键。我们使用这个过程来保持两个数据集同步。

每个数据集当前存储为字典，数据集的键作为字典的键。确定复杂关系后，我将另一个数据集的键作为属性存储在另一个中。这就需要创建一些看起来很奇怪的辅助函数来遵循一些父子关系。

我想知道是否有一种更有效或更快速的方法来解决这种疯狂，因为我目前必须将两个数据集都传递给需要解析关系的处理函数。

例子：

```
leftdataset = {'10000': { 'key': '10000', 'fkey':'asdf', 'parent':'10001'},
               '10001': { 'key': '10001', 'fkey':'qwer', 'parent':''},}
rightdataset= {'asdf': { 'key': 'asdf', 'fkey':'10000', 'parent':'qwer'},
               'qwer': { 'key': 'qwer', 'fkey':'10001', 'parent':''}, 
```

为了找到父母的`fkey`我需要：

```
fkey = dataset[dataset['10000']['parent']]['fkey'] 
```

我正在玩弄呈现密钥对元组的想法，然后在其中寻找我需要的密钥，例如：

```
keys = [('10000', 'asdf'), ('10001', 'qwer')]

def find_key(key, keyset):
  for keypair in keys:
    if key in keypair:
      k1, k2 = keypair
      if k1 == key:
        return k2
      else:
        return k1 
```

但这听起来比我现在所做的效率还要低。我只是走错路了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T00:03:29.177

根据 Mark Ransom 的评论，也许您可​​以组织这样的课程：

```
class Storage(object):

    def __init__(self):

        self._leftdataset = {
            '10000': { 'key': '10000', 'fkey':'asdf', 'parent':'10001'},
            '10001': { 'key': '10001', 'fkey':'qwer', 'parent':''}
        }

        self._rightdataset= {
            'asdf': { 'key': 'asdf', 'fkey':'10000', 'parent':'qwer'},
            'qwer': { 'key': 'qwer', 'fkey':'10001', 'parent':''}
        }

    def get(self, key):
        d1 = self._leftdataset
        d2 = self._rightdataset

        if key in d1:
            left = d1[key]
            right = d2[left['fkey']]
        else:
            right = d2[key]
            left = d1[right['fkey']]

        return left, right 
```

并使用单一查找方法：

```
s = Storage()

s.get('10000')
# ({'fkey': 'asdf', 'key': '10000', 'parent': '10001'},
#  {'fkey': '10000', 'key': 'asdf', 'parent': 'qwer'})

s.get('qwer')
# ({'fkey': 'qwer', 'key': '10001', 'parent': ''},
#  {'fkey': '10001', 'key': 'qwer', 'parent': ''}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:28:10.220

这种用法对你有吸引力吗？

轻松查找和使用单个条目：

```
>>> left("10000")
Entry({'parent': '10001', 'key': '10000', 'fkey': 'asdf'})
>>> left("10000")['key']
'10000'
>>> left("10000")['parent']
'10001' 
```

轻松查找父母：

```
>>> left("10000").parent()
Entry({'parent': '', 'key': '10001', 'fkey': 'qwer'})
>>> left("10000").parent().parent()
>>> left("10001")
Entry({'parent': '', 'key': '10001', 'fkey': 'qwer'})
>>> left("10001") is left("10000").parent()
True 
```

轻松查找相关条目：

```
>>> left("10001").related()
Entry({'parent': '', 'key': 'qwer', 'fkey': '10001'})
>>> right("qwer")
Entry({'parent': '', 'key': 'qwer', 'fkey': '10001'})
>>> right(left("10001").related()['key'])
Entry({'parent': '', 'key': 'qwer', 'fkey': '10001'})
>>> right("qwer") is left("10001").related()
True 
```

特别是您的问题中的示例：父母的外键：

```
>>> left("10000").parent()['fkey']
'qwer' 
```

如果是这样，那么这里是代码！课程：

```
class Entry(object):
    def __init__(self, dataset, d):
        self.dataset = dataset
        self.d = d

    def parent(self):
        return self.dataset.parent_of(self)
    def related(self):
        if not self.dataset.related_dataset:
            raise ValueError("no related dataset specified")
        return self.dataset.related_dataset(self['fkey'])

    def __getitem__(self, k):
        return self.d.__getitem__(k)

    def __repr__(self):
        return "Entry(%s)" % repr(self.d)
    def __str__(self):
        return str(self.d)

class Dataset(object):
    def __init__(self, data):
        self.data = dict((k, Entry(self, v)) for (k,v) in data.items())
        self.related_dataset = None

    def set_related_dataset(self, dataset):
        self.related_dataset = dataset

    def entry(self, key):
        if isinstance(key, Entry): return key
        return self.data[key]
    def __call__(self, key):
        return self.entry(key)

    def parent_of(self, entry):
        entry = self.entry(entry)

        if not entry['parent']:
            return None
        return self.data[entry['parent']] 
```

以及您提供的数据的用途：

```
leftdata = {'10000': { 'key': '10000', 'fkey':'asdf', 'parent':'10001'},
               '10001': { 'key': '10001', 'fkey':'qwer', 'parent':''},}
rightdata = {'asdf': { 'key': 'asdf', 'fkey':'10000', 'parent':'qwer'},
               'qwer': { 'key': 'qwer', 'fkey':'10001', 'parent':''}}

left = Dataset(leftdata)
right = Dataset(rightdata)
left.set_related_dataset(right)
right.set_related_dataset(left) 
```

说明：将每个 dict 值包装在一个已定义的`Entry`类中，`__getitem__`以使其可用作 dict（或多或少）。有一个`Dataset`将主键映射到这些`Entry`s 的类。提供`Entry`对该数据集的访问并提供方便的方法`.parent()`和`.related()`. 为了`.related()`工作，设置“相关”的数据集应该与哪个数据集相关`set_related_dataset`联。

现在您甚至可以只传递`Entry`s 并且您将能够访问相关条目而无需传递两个数据集。

# haskell - 我可以依靠 Template Haskell 扩展（使用 -ddump-splices）来始终生成有效代码吗？

> ID：12169093
> 
> 赞同：4
> 
> 时间：2012-08-28T23:48:14.577
> 
> 标签：haskell, syntax, template-haskell

我编写了一个小实用程序来扩展 Haskell 模块中的所有 TH 拼接，这样即使 TH 不可用，我也可以使用 haskell 模块。为此，我`-ddump-splices`在编译模块并捕获生成的代码时将选项传递给 GHC，然后将模块中的 TH 声明替换为捕获的代码。

但是，看起来 -ddump-splices 并不总是生成可编译的代码。具体来说，它似乎使用大括号进行布局，但没有在正确的位置添加分号！

这是我的测试文件中的一个示例-

```
case dispatch_a3Tg pieces0_a3Tf of {
    Just f_a3U6
      -> f_a3U6
           master0_a3T9
           sub0_a3Ta
           toMaster0_a3Tb
           app4040_a3Tc
           handler4050_a3Td
           method0_a3Te
    Nothing -> app4040_a3Tc } 
```

在这里，它生成了左大括号和右大括号，但没有在两种情况下生成所需的分号。这会在编译时导致以下错误 -

```
GHCi, version 7.4.1: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
[1 of 1] Compiling Main             ( Test.hs, interpreted )

Test.hs:51:17: parse error on input `->'
Failed, modules loaded: none.
Prelude> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:09:46.647

不，拼接转储通常是无效代码，需要大量时间才能将它们减少到不仅可以编译而且人类可以理解的内容。[在调查TYB](http://hackage.haskell.org/package/TYB)的各个方面时，这是一个令人沮丧的根源。

# objective-c - 可可代码中的内存泄漏

> ID：12169097
> 
> 赞同：0
> 
> 时间：2012-08-28T23:49:06.027
> 
> 标签：objective-c, xcode, cocoa

我一直试图分析为什么 Xcode 分析器 (v4.2) 抱怨我的 Objective-c 代码泄漏内存。我正在创建一个 NSOperation 1）如果目录不存在，则递归创建一个目录，2）将文件从一个目录复制到另一个目录。

NSOperation 初始化为：

```
- (id)initWithFullPathSource:(NSString *) mysource andFullPathCopy:(NSString *) mycopy     andNewDirectory:(NSString *) mydir withMode:(NSString *) mymode withLR:(NSString *) LR
{

     self = [super init];
     if (self) {

        [self setFullPathSource:mysource];
        [self setFullPathCopy:mycopy];
        [self setNewDirectory:mydir];
        [self setMode:mymode];
        [self setMyLR:LR];
    }

    return self;
} 
```

附件是 Xcode 分析器如何查看我的代码的屏幕截图。谁能帮我理解为什么在这种情况下我会泄漏内存？我在主程序结束时发布了“createComponents”和“removeComponents”，所以我认为我很清楚。

希望有人可以阐明我的问题。谢谢！干杯，特隆德

![在此处输入图像描述](../Images/41a9099c3da05b41756086f65e9004df.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T23:55:15.193

请注意，在目标 c 命名规则下，以单词开头`new`或`copy`假定返回调用者拥有的对象的方法。如果调用`[self newDirectory]`返回一个自动释放的对象，请尝试重命名它，使其不以 new 开头。

这里有一个很好的答案解释更多：[语义问题：属性的合成吸气剂遵循 Cocoa 命名约定以返回“拥有”对象](https://stackoverflow.com/questions/6327448/semantic-issue-propertys-synthesized-getter-follows-cocoa-naming-convention-fo)

一个建议是更改属性上的 getter 的名称，如下所示：

```
@property (strong, nonatomic, getter=theNewDirectory) NSString *newDirectory; 
```

或称其为：`directoryToBeCreated`

# spring - JPA Spring MVC 配置

> ID：12169102
> 
> 赞同：1
> 
> 时间：2012-08-28T23:49:31.377
> 
> 标签：spring, jpa, spring-mvc, persistence.xml

我正在尝试使用 JPA 和 Spring 连接到 MySQL db。我是春天的新手。

我已将此添加到我的配置文件中，其中定义了所有 bean：

```
<jee:jndi-lookup id="myEmf" jndi-name="hello-world"/>

<bean id="myEmf" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
   <property name="dataSource" ref="myEmf"/>
   <property name="loadTimeWeaver">
   <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver"/>
</property>
</bean> 
```

这也是我的persistence.xml，我的持久性单元名称是“hello-world”。

```
<persistence-unit name="hello-world" transaction-type="RESOURCE_LOCAL"> 
```

org.hibernate.ejb.HibernatePersistence

当我尝试实例化对象时，它会抛出错误。

谢谢，萨拉。

更新，错误：

> 2012/08/28 23-25-56,993:8a4cd57fec4d0:ERR:ERROR [解析 XML 时出错：XML InputStream(1) 应为伪属性名称。] 2012-08-28 23:25:56,994 错误 [org.apache. catalina.core.ContainerBase.[Catalina].[localhost].[/sara].[jsp]:704]：servlet jsp 的 Servlet.service() 抛出异常 javax.persistence.PersistenceException：无法在 org.hibernate 配置 EntityManagerFactory .ejb.Ejb3Configuration.configure(Ejb3Configuration.java:265) 在 org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:125) 在 javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:52) 在 javax.persistence。 com.paypal.sara.sara.web.sample.mvc.Main.getPoints(Main.java:21) 上 sun.reflect.NativeMethodAccessorImpl 上的 Persistence.createEntityManagerFactory(Persistence.java:34)。invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) at java.lang.reflect.Method.invoke(Method.java: 599）在 org.apache.commons.el.ArraySuffix.evaluate(ArraySuffix.java:314) 在 org.apache.commons.el.ComplexValue.evaluate(ComplexValue.java:145) 在 org.apache.commons.el.E​​xpressionEvaluatorImpl .evaluate(ExpressionEvaluatorImpl.java:263) 在 org.apache.commons.el.E​​xpressionEvaluatorImpl.evaluate(ExpressionEvaluatorImpl.java:190)599）在 org.apache.commons.el.ArraySuffix.evaluate(ArraySuffix.java:314) 在 org.apache.commons.el.ComplexValue.evaluate(ComplexValue.java:145) 在 org.apache.commons.el.E​​xpressionEvaluatorImpl .evaluate(ExpressionEvaluatorImpl.java:263) 在 org.apache.commons.el.E​​xpressionEvaluatorImpl.evaluate(ExpressionEvaluatorImpl.java:190)599）在 org.apache.commons.el.ArraySuffix.evaluate(ArraySuffix.java:314) 在 org.apache.commons.el.ComplexValue.evaluate(ComplexValue.java:145) 在 org.apache.commons.el.E​​xpressionEvaluatorImpl .evaluate(ExpressionEvaluatorImpl.java:263) 在 org.apache.commons.el.E​​xpressionEvaluatorImpl.evaluate(ExpressionEvaluatorImpl.java:190)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T06:50:00.693

我发现了问题所在！这么简单的一个，但花了我的时间。

相反，我`<?xml version="1.0" encoding="UTF-8">`应该有`<?xml version="1.0" encoding="UTF-8"?>`。

谢谢你的时间。

# string - 301 重定向 url 与 .htaccess 的特定字符串

> ID：12169104
> 
> 赞同：0
> 
> 时间：2012-08-28T23:49:40.707
> 
> 标签：string, .htaccess, redirect

我是这种编码的新手。我已经到处寻找方法来做到这一点，但我还没有想出一个可行的解决方案。我什至不确定我是否正在寻找正确的东西。我一直在看 query_string，但我很难过。

基本上，我想 301 将诸如[http://domain.com/page12345.html](http://domain.com/page12345.html)之类的 URL 重定向到[http://domain.com/page23456.html](http://domain.com/page23456.html)其中“page12345”可以读取任何数字和任何数字。该格式的所有页面都将重定向到一个设置页面。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T23:58:59.827

此规则应重定向与 /page*.html 匹配的任何请求，其中 * 是数字字符的任意组合

```
RewriteEngine On
RewriteRule ^/page([0-9]+)\.html http://domain.com/page23456.html [R=301,L] 
```

# html - 基于列表的下拉菜单在 IE 中不起作用

> ID：12169105
> 
> 赞同：0
> 
> 时间：2012-08-28T23:49:48.787
> 
> 标签：html, css, wordpress, internet-explorer, web

我正在这个网站上工作： http: [//cecraig.hhdev.hothousemarketing.com](http://cecraig.hhdev.hothousemarketing.com)

下拉菜单在 IE 中无法正常工作（我在 IE9 和 IE8 中测试过）。子菜单 (ul) 仅在将鼠标悬停在父文本上时出现，一旦鼠标移到文本之外，它就会消失。我在其他网站上对下拉菜单使用了相同的方法，它在 IE 中运行良好，不知道为什么它在这里不起作用。我知道 IE 对 :hover 在“a”以外的元素上的支持有限，但据我所知，这仅限于 IE7。

这是我用于菜单的 CSS，您可以调出源代码以查看菜单的 HTML（由 wp_nav_menu() WordPress 函数输出）：

```
#mainNav ul {
margin: 0;
padding: 0;
list-style-type: none;
}
#mainNav > ul {
margin-left: 234px;
height: 38px;
}
#mainNav > ul > li {
position: relative;
float: left;
}
#mainNav ul li a {
font-size: 11pt;
color: #fff;
text-decoration: none;
}
#mainNav > ul > li > a {
display: block;
height: 18px;
padding: 10px 12px;
}
#mainNav ul li a:hover {
color: #efefef;
}
#mainNav ul li.current-menu-item > a, #mainNav > ul > li.current-page-parent > a {
font-weight: bold;
}
#mainNav ul ul {
background-color: #e1a100;
display: none;
margin: 0;
position: absolute;
top: 38px;
left: 0;
width: 200px;
padding: 0 8px 8px 8px;
z-index: 99999;
}
#mainNav ul li:hover > ul {
display: block;
}
#mainNav ul ul li + li {
margin-top: 5px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T23:58:26.127

要解决问题，`:hover`您应该在`<a>`元素上使用它。因为 IE 支持`:hover`only on`<a>`标签，但不支持 on`li,div,span,dd,etc...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T23:55:33.240

尝试添加：

```
.menu-item:hover{ display: block; } 
```

IE 在复杂的悬停选择器上表现不佳。

# java - 带有颜色选择器编辑器的 JavaFX 表格视图

> ID：12169116
> 
> 赞同：6
> 
> 时间：2012-08-28T23:51:43.887
> 
> 标签：java, javafx-2

我有一个 TableView，它使用 ColorPicker 来（显示/编辑）单元格中的颜色。该表在所需字段中显示颜色选择器，但编辑不起作用。

```
TableColumn<SeriesPreferences, Color> c2 = new TableColumn<SeriesPreferences, Color>("Color");
c2.setCellValueFactory(new PropertyValueFactory<SeriesPreferences, Color>("color"));
c2.setCellFactory(new Callback<TableColumn<SeriesPreferences, Color>,
                                TableCell<SeriesPreferences, Color>>()
    {
        @Override
        public TableCell<SeriesPreferences, Color> 
        call(final TableColumn<SeriesPreferences, Color> param)
        {
            TableCell<SeriesPreferences, Color> cell = 
                new TableCell<SeriesPreferences, Color>()
                    {
                        @Override
                        public void updateItem(Color c, boolean empty)
                        {
                            if(c != null)
                            {
                                final ColorPicker cp = new ColorPicker();
                                cp.setValue(c);
                                setGraphic(cp);
                                cp.setOnAction(new EventHandler<javafx.event.ActionEvent>()
                                    {
                                        public void 
                                        handle(javafx.event.ActionEvent t)
                                        {
                                            getTableView().edit(getTableRow().getIndex(), param);
                                            commitEdit(cp.getValue());
                                        }
                                    });
                            }
                        }
                    };
            return cell;
        }
    });

c2.setOnEditCommit(new EventHandler<CellEditEvent<SeriesPreferences, Color>>()
    {
        @Override
        public void handle(CellEditEvent<SeriesPreferences, Color> t)
        {
            ((SeriesPreferences) t.getTableView().getItems().get(t.getTablePosition().
                                                    getRow())).setColor(t.getNewValue());
        }
    }); 
```

当我更改颜色选择器中的颜色时，没有调用编辑事件处理程序，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-27T11:20:25.900

如果 JavaFX POJO（或 JavaFX Bean）的属性正确绑定到表，则无需直接访问 JavaFX POJO（或 JavaFX Bean），也无需调用除 commitEdit 之外的任何内容。

Max Beikirch 的回答具有误导性，因为当表格不处于编辑模式时，它会导致颜色选择器（以及颜色）消失。将表格置于编辑模式是一种解决方法，但这是一种糟糕的解决方法。因此，请在单击按钮时显示颜色选择器弹出窗口之前执行此操作：

使用这样的颜色选择器编写您的单元格：

```
public class ColorTableCell<T> extends TableCell<T, Color> {    
    private final ColorPicker colorPicker;

    public ColorTableCell(TableColumn<T, Color> column) {
        this.colorPicker = new ColorPicker();
        this.colorPicker.editableProperty().bind(column.editableProperty());
        this.colorPicker.disableProperty().bind(column.editableProperty().not());
        this.colorPicker.setOnShowing(event -> {
            final TableView<T> tableView = getTableView();
            tableView.getSelectionModel().select(getTableRow().getIndex());
            tableView.edit(tableView.getSelectionModel().getSelectedIndex(), column);       
        });
        this.colorPicker.valueProperty().addListener((observable, oldValue, newValue) -> {
            if(isEditing()) {
                commitEdit(newValue);
            }
        });     
        setContentDisplay(ContentDisplay.GRAPHIC_ONLY);
    }

    @Override
    protected void updateItem(Color item, boolean empty) {
        super.updateItem(item, empty);  

        setText(null);  
        if(empty) {     
            setGraphic(null);
        } else {        
            this.colorPicker.setValue(item);
            this.setGraphic(this.colorPicker);
        } 
    }
} 
```

如果您使用的是 Java 7，请将 lambdas 替换为匿名内部类，但它应该也可以工作。完整的博客文章在[这里](http://info.michael-simons.eu/2014/10/27/custom-editor-components-in-javafx-tablecells/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-10T17:58:44.713

我对 CheckBoxTableCell 和 DatePickerTableCell 和 ColorPickerTableCells 有同样的问题 :-(

我是这样处理的：在控件的事件上，我取回“ **((Inputs)getTableView().getItems().get(getTableRow().getIndex()** ”使用的 POJO 对象，并且我更新类似是否在 OnEditCommit 方法中完成...

所以对我来说它看起来像这样（更新颜色）：

```
 ((Inputs) getTableView().getItems().get(
                    getTableRow().getIndex())
                    ).setColor(cp.getValue()); 
```

这是 ColorPickerCell 的示例：

```
public class ColorPickerTableCell<Inputs> extends TableCell<Inputs, Color>{
private ColorPicker cp;

public ColorPickerTableCell(){        
    cp = new ColorPicker(); 
    cp.setOnAction(new EventHandler<ActionEvent>() {
        @Override
        public void handle(ActionEvent event) {
            commitEdit(cp.getValue());
            updateItem(cp.getValue(), isEmpty());
            ((Inputs) getTableView().getItems().get(
                    getTableRow().getIndex())
                    ).setColor(cp.getValue());
        }            
    });                
    setGraphic(cp);
    setContentDisplay(ContentDisplay.GRAPHIC_ONLY);
    setEditable(true);        
}     
@Override
protected void updateItem(Color item, boolean empty) {
    super.updateItem(item, empty);
    cp.setVisible(!empty);
    this.setItem(item);
    cp.setValue(item);
}
} 
```

使用这个简单的 JavaFX 的 POJO：

```
 public ObjectProperty<Color> color = new SimpleObjectProperty<Color>();

    this.color = new SimpleObjectProperty(color);

    public ObjectProperty<Color> colorProperty() {
    return color;
 }

public void setColor(Color color2) {
    color.set(color2);
} 
```

我不知道这是否是实现这一目标的好方法，但它对我有用......请注意，JavaFX 的 POJO 只能在“ActionEvent”请求（组合框、日期选择器、颜色选择器等）中访问。

问候，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-08T13:09:05.560

好吧，我对这个话题进行了一些调查，因为我遇到了同样的问题。恐怕JavaFX 是无法使用的。

我看了一下其他人是如何实现他们的单元的，关键是它们都使用了可以用字符串表示的东西。现在，这就是 Java 的一贯方式：以 Java 的方式去做，或者在雨中独自一人。JavaFX 的文档目前非常糟糕，所以我不得不尝试直到它起作用。

所以：要触发-event ，`editCommit`你必须调用`setContentDisplay(ContentDisplay. TEXT_ONLY)`. `updateItem()`如果想将数据显示为字符串，那效果很好，但在这种情况下完全失败，颜色选择器只是完成这项工作。

或者，也可以手动触发事件。但是你如何获得桌面位置？我不知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-08T17:23:03.027

就像迈克尔西蒙斯在对 OP 的评论中所说的那样。您需要处于**编辑模式**。创建您自己的自定义单元格时，您可以通过`startEdit();`从 TableCell 内部调用来手动触发编辑模式。

例如使用您的控件的 focusProperty：

```
 cp.focusedProperty().addListener((observable, oldValue, newValue) -> {
        if (newValue) {
            startEdit();
        }
    }); 
```

# javascript - HTML 输入框未触发事件

> ID：12169119
> 
> 赞同：0
> 
> 时间：2012-08-28T23:52:34.710
> 
> 标签：javascript, jquery, input, jquery-events

我有以下 Javascript：

```
功能选择（ID，EVT）{
        var e = (typeof evt != 'undefined') ? evt：事件；
        e.cancelBubble =真；
        警报（'错误'）；
        var $toggler = $("#building"+id);     

        if(!$toggler.is(':checked')){
            $toggler.attr('checked', true);
            $("#row"+id).removeClass("selectRow");
            $("#row"+id).addClass("selectRow");            
        }
    }

```

我有以下`<HTML>`块

```
<td>
   <select onchange="select(2, event);" name="prefferedAgent396" class="input-small">
       <option value="0">Choose...</option>
       <option value="1" selected=""> Senthil </option>                                    
       <option value="3"> Sunmeet </option>                                    
       <option value="4"> Doesnot Speak English </option>                                    
       <option value="5"> Marcus Fava </option>                                    
   </select> 
</td>
<td>
   <input type="text" onchange="select(2, event);" class="input-mini" id="initial396" name="initial396" value="">
</td> 
```

现在的问题是`onchange`事件触发了`select(2, event)`控件`select`而不是`input`控件。当我尝试一个`alert`我称之为工作的盒子时，`select()`它不仅仅是调用`select()`. 我已经尝试过`onKeyUp`，但它给出了一种奇怪的行为，即在我键入时替换文本。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:09:10.440

这*很*奇怪。如果您将函数从 重命名`select`为 ，例如`select_`，它将*起作用*。但由于您已经在使用 jQuery，您可以使用以下内容而不是使用内联`change`处理程序：

```
$("#prefferedAgent396,#initial396").change(function (e) {
   select(2, e);
}); 
```

这是一个**[演示](http://jsfiddle.net/vzcwq/)**。

# android - Android - 无法正确显示 unicode 字符

> ID：12169120
> 
> 赞同：1
> 
> 时间：2012-08-28T23:52:37.807
> 
> 标签：android, html, unicode, fonts, android-webview

我正在尝试加载本地 html 文件：

```
 WebView webView = (WebView)findViewById(R.id.webView1);
    webView.getSettings().setDefaultTextEncodingName("utf-8");
    webView.setWebChromeClient(new WebChromeClient());
    webView.loadUrl("file:///android_asset/www/index.html"); 
```

index.html 包含以下内容：

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    </head >
    <body>
        რაღაც ტექსტი
    </body>
</html> 
```

但它不起作用。任何人都可以帮忙吗？PS该文本是格鲁吉亚语

编辑：我已经尝试使用我发现的几乎所有可能的方法加载该文本 - loadDataWithBaseURL 和 loadData 方法也不起作用。

已关闭：问题是：该版本的 Android 无法识别格鲁吉亚字符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T11:03:40.747

您可以使用 UNICODE 字符的 HTML 代码以`WebView`.

只需将字符替换为各自的 html 代码即可。

有关格鲁吉亚字符的 Html 代码，请参阅[此处](http://www.unicodemap.org/range/29/Georgian/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T09:47:31.597

您可以使用这种方法；

```
String start = "<html><head><meta http-equiv='Content-Type' content='text/html' charset='UTF-8' /></head><body>";
String end = "</body></html>";

webView.loadData(start + YOURCONTENT + end,"text/html; charset=UTF-8", null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T01:23:06.493

确保您的文件实际编码为 UTF-8。
检查您的编辑器是否将其保存为 UTF-8。这可能是问题所在。

# css - 两列 CSS 布局，菜单侧列与主要内容高度相同？

> ID：12169123
> 
> 赞同：0
> 
> 时间：2012-08-28T23:53:12.480
> 
> 标签：css, layout, xhtml, two-columns

嘿做了一些挖掘和谷歌搜索建议一些作弊以获得相同高度的两列。只是有点紧张，因为需要在不违反任何规则的情况下这样做。有没有一种方法可以使列彼此具有相同的高度，即主体和菜单列是相同的，无论其中有多少内容。

使用 XHTML strict1.0。

谢谢

达米安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T14:41:14.140

添加一些固定高度约。屏幕高度和溢出：为父 div 隐藏。为主 div 和侧边栏添加溢出：auto 和 height:100%。因此，当内容增长时，布局不会中断。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>

<style type="text/css">
body                    {   font-family:Arial, Helvetica, sans-serif; font-size:12px; line-height:18px;  }
.clear                  {   clear:both; }
.container              {   background:#eee; display:inline-block; height:300px; overflow:hidden; padding:10px; width:800px;  } 
.container p,           {   color:#003;  }
.main                   {   background:#fff; float: right; height:100%; overflow:auto; padding:0 15px; text-align:justify; width:470px;  }
.main h1                {   color:#930;  }
.sidebar                {   background:#000; float:left; height:100%; overflow:auto; width:280px;    } 
.sidebar ul li a        {   color:#fff; text-decoration:none;    }
</style>

</head>

<body>

<div class="container">
        <div class="sidebar">
            <ul>
                <li><a href="#">Link -1</a></li>
                <li><a href="#">Link -2</a></li>
                <li><a href="#">Link -3</a></li>
            </ul>
        </div>

        <div class="main">
            <h1> Lipsum dot com </h1>
            <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. </p>

            <p>Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.</p>

            <p>It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.</p>

            <p>It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>

        </div>
        <br class="clear" />
</div>

</body>
</html> 
```

我对页面的 CSS 做了一些更改，根据以下评论，您可以查看

```
<style type="text/css">
body                    {   font-family:Arial, Helvetica, sans-serif; font-size:12px; line-height:18px;  }
.clear                  {   clear:both; }
.container              {   background:#eee; display:block; overflow: hidden; position: relative; padding:10px !important; width:800px;  } 
.container p,           {   color:#003;  }
.main                   {   background:#fff; float: right; height:100%; overflow:auto; padding:0 15px; text-align:justify; width:470px;  }
.main h1                {   color:#930;  }
.sidebar                {   background:#000; float:left; height: 100%; left:10px;  position: absolute; width:280px; } 
.sidebar ul li a        {   color:#fff; text-decoration:none;    }
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:27:35.187

小提琴：http: [//jsfiddle.net/uYknh/](http://jsfiddle.net/uYknh/)

```
<div id="cols">
    <div class="col col1">
        asd<br/>asd<br/>asd<br/>asd<br/>asd<br/>asd<br/>
    </div>
    <div class="col col2">
        asd<br/>asd<br/>
    </div>
</div> 
```

* * *

```
.cols{display:table-row;width:100%;}
.col{display:table-cell;width:230px;background-color:#eee;border:1px solid #555;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T08:55:22.630

**HTML**

```
<div id="main_body" class="custom_width"></div>
<div id="menu_column" class="custom_width"></div> 
```

**CSS**

```
.custom_width {
    max-width: 400px;
} 
```

相应地调整宽度。

# c - 你如何以可重入的方式初始化CriticalSection？

> ID：12169127
> 
> 赞同：2
> 
> 时间：2012-08-28T23:53:36.850
> 
> 标签：c, windows, multithreading

我正在修改一个完全可重入的库以添加 Windows 支持。问题是初始化函数。初始化函数被包裹起来，`MUTEX_LOCK(&ssl_lock);`以`MUTEX_UNLOCK(&ssl_lock);`保证一切都只初始化一次。

问题是我`EnterCriticalSection`之前不能打电话`InitializeCriticalSection`，`InitializeCriticalSection`也不能重入。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:07:23.000

根据您需要支持的 Windows 版本，您可以使用“Init Once”API：

*   [一次性初始化 MSDN 文档](http://msdn.microsoft.com/en-us/library/aa363808)
*   [使用 InitOnce 函数的模式](http://blogs.msdn.com/b/oldnewthing/archive/2011/04/08/10151258.aspx)

如果您需要支持 WinXP/Win Server 2003 或更早版本，您可能需要依赖内核可以确保只创建一次的 Mutex 对象。在打开/创建互斥锁时，您需要实现一些逻辑，以确保所有执行线程最终都有一个有效的句柄（即，一个尝试打开的循环，然后尝试创建直到打开或创建成功）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T23:56:08.017

您可以在 DllMain() DLL_PROCESS_ATTACH 处理程序中对其进行初始化。

# python - 如何将python代码导入django中的views.py文件

> ID：12169133
> 
> 赞同：5
> 
> 时间：2012-08-28T23:54:28.273
> 
> 标签：python, django, import

我是 django 的新手，我正在尝试将来自表单提交的响应链接到我在另一个文件中编写的几个 python 方法，这些方法将使用用户输入作为参数。我想知道如何导入这些方法并打印它们的结果。

我的 python 文件被命名`Crunch.py`并位于`views.py`我尝试过的同一目录中：`from Crunch import *` 但它不起作用。我想知道我是否需要将文件移动到其他地方，或者我需要写什么来从 Crunch 导入所有方法。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-29T00:14:22.573

尝试以下

```
from <app name>.Crunch import * 
```

# actionscript-3 - 找不到解决方案：将 void 类型的值隐式强制转换为不相关的类型 Function

> ID：12169134
> 
> 赞同：0
> 
> 时间：2012-08-28T23:54:29.240
> 
> 标签：actionscript-3, flash, apache-flex, air, flex3

我已经搜索了网络，但我找不到我的问题的答案。我正在构建一个读取 txt 文件并将它们显示在空中应用程序中的空中应用程序，但出于一个奇怪的原因，我在同一行出现了 2 个错误。

错误：

-1067：将 void 类型的值隐式强制转换为不相关的类型 Function。

-1067：将 Class 类型的值隐式强制转换为不相关的类型 flash.events:Event。

编码：

```
 public function init():void {
                stage.displayState =   StageDisplayState.FULL_SCREEN_INTERACTIVE;

            }

            public function txtReeks1_creationCompleteHandler():void {
                    var url:String = "Files/Reeks1.txt";
                    var loadit:URLLoader = new URLLoader();
                    loadit.addEventListener(Event.COMPLETE, completeHandler(Event));
                    loadit.load(new URLRequest(url));
            }

             public function completeHandler(event:Event):void {
                txtReeks1.text =  event.target.data;    
                stripLinesFromTextArea(txtReeks1);
            }   

             public function stripLinesFromTextArea(textArea:TextArea):void { 
                var txt:String = textArea.text; 
                var re:RegExp = /\n+/g; 
                txt = txt.replace(re,""); 
                textArea.text = txt; 
            } 
        ]]>
    </fx:Script>
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <mx:TabNavigator x="0" y="0" width="100%" height="100%">
        <mx:Canvas id="Reeks1" width="100%" height="100%" label="Reeks1">
            <mx:TextArea id="txtReeks1" x="0" y="0" width="100%" height="100%"
                         creationComplete="txtReeks1_creationCompleteHandler()"
                         fontFamily="Lucida Console" fontSize="20"/>
        </mx:Canvas>
        <mx:Canvas id="Reeks2" width="100%" height="100%" label="Reeks2">
        </mx:Canvas>
        <mx:Canvas id="Reeks3" width="100%" height="100%" label="Reeks3">
        </mx:Canvas>
    </mx:TabNavigator>
</mx:WindowedApplication> 
```

我希望有人可以帮助我，因为我在过去 2 天里正在寻找答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:00:56.327

```
loadit.addEventListener(Event.COMPLETE, completeHandler(Event)); 
```

这就是问题。您正在调用处理程序并将`Event`类传递给它。添加侦听器时，您只需引用该函数，而不是调用它：

```
loadit.addEventListener(Event.COMPLETE, completeHandler); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T00:01:06.003

问题出在`txtReeks1_creationCompleteHandler()`下面一行的方法中：

```
loadit.addEventListener(Event.COMPLETE, completeHandler(Event)); 
```

第二个参数应该是对函数的引用，而不是函数本身的执行——它返回 void。所以它应该如下所示：

```
loadit.addEventListener(Event.COMPLETE, completeHandler); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T00:01:32.080

您的错误在线：

```
loadit.addEventListener(Event.COMPLETE, completeHandler(Event)); 
```

您不应将函数的结果传递给事件处理程序，而应将函数本身传递给：

```
loadit.addEventListener(Event.COMPLETE, completeHandlerEvent); 
```

# mysql - Rails：指定生产环境特定的迁移

> ID：12169136
> 
> 赞同：1
> 
> 时间：2012-08-28T23:54:59.330
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, postgresql, heroku

> **可能重复：**
> [数据库特定的迁移代码](https://stackoverflow.com/questions/6178303/database-specific-migration-code)

所以我在本地运行 MySQL，因为它是我安装的，对我来说很有意义。

但是 Heroku 使用 Postgre，并且它没有相同的字段类型。

即我在本地使用 longblob，它在我的生产环境中变成了 bytea。我在本地使用 tinytext，它变成了文本

如何在我的迁移中指定不同的环境，这样我就不必为了推送到 Heroku 而编辑我的迁移？（我想让它们在我的本地机器上保持语法正确）

还有其他建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:50:48.020

我知道想要在本地运行您习惯的东西，因为它更容易。另外，IMO 过去在本地设置 Postgres 一直很痛苦。但是，在与生产服务器相同的数据库上运行开发确实很重要。如果您是 Mac 用户，现在有一个很好的解决方案，由 Heroku postgres 团队提供给您：

[http://postgresapp.com/](http://postgresapp.com)

使用它，你不必担心这个。否则，请按照[Mu 发布的答案](https://stackoverflow.com/questions/6178303/database-specific-migration-code)，这会让你做邪恶的两个数据库的事情:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:03:06.000

我只是在这里猜测，但你为什么不创建两个不同的迁移文件，一个用于开发，另一个用于生产，并使用如下内容：

```
rake db:migrate VERSION=00000000000001 RAILS_ENV=production

rake db:migrate VERSION=00000000000002 RAILS_ENV=development 
```

# constructor - 有人可以解释一下吗！这是某种结构构造函数吗？（链接列表）

> ID：12169142
> 
> 赞同：0
> 
> 时间：2012-08-28T23:55:30.193
> 
> 标签：constructor, struct, linked-list

所以我们一直在我的 CS 课上学习链表，我很好地理解了这个概念。但是，在查看示例程序时，我的教授分配的代码与我们在课堂上显示的不同。

这是示例中的代码：

```
 struct itemType
        {
            string store_name, item_name;
            int item_number, quantity; 
            float price;
        } ;

        struct node
        {
             itemType item;
             node *next;    //  
             **node (itemType it, node* n=NULL)
             {
                 item=it;
                 next=n;
             }**
         }; 
```

我不明白他为什么在节点结构中调用节点并让它接受两个参数（代码中包含在“**”中的部分）。它看起来像一个构造函数或其他东西。我用谷歌搜索或阅读过的链表上的每个示例都没有那一点代码！

但是，你们能给我的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:02:12.707

该示例是 C++ 代码。C ++中的类是结构概念的扩展，实际上，类和结构之间的唯一区别在于，结构中的所有成员默认情况下都是公共的，而类中默认情况下它们是私有的。这是由于 C++ 的历史起源是“C With Classes”——只需将 struct 替换为 class，添加“public:”，它看起来就不那么陌生了：

```
 struct itemType
    {
        string store_name, item_name;
        int item_number, quantity; 
        float price;
    } ;

    class node
    {
    public:
         itemType item;
         node *next; 
         node (itemType it, node* n=NULL) // Constructor
         {
             item=it;
             next=n;
         }
     }; 
```

# ios - UITextField 选中时清除，但如果没有输入也恢复数据

> ID：12169145
> 
> 赞同：3
> 
> 时间：2012-08-28T23:55:49.273
> 
> 标签：ios, uitextfield

我有一个带有 UITextFields 的表，我想这样做，以便在选择文本字段时清除当前信息（以允许新输入），但是如果用户决定（在选择后）他们不想更改它，我希望他们能够单击其他地方，并且之前的数据重新出现在文本字段中。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T01:17:10.260

一个很好且用户友好的好方法是使用该`placeholder`属性。将您的 viewController 设置为文本字段的委托（如 Andeh 所述），然后添加以下代码：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    textField.placeholder = textField.text;
    textField.text = @"";
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    if (textField.text.length == 0) {
        textField.text = textField.placeholder;
    }
    textField.placeholder = @"";
} 
```

你完成了。如果`UITextField`页面上有多个 s 并且您不希望所有这些行为都具有这种行为，则可以在上述方法中添加检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T03:12:07.037

首先，我认为您在这里有两组行为。

1.  开始编辑时，文本字段必须清除该值。这存在：`-clearsOnBeginEditing`.
2.  如果文本为空，则文本字段必须恢复以前的文本。子类化似乎是更好的解决方案。

这是一个可能的示例类：

```
// MyRestoringTextField.h
@interface MyRestoringTextField : UITextField
@end

// MyTextField.m
@interface MyRestoringTextField ()
@property (strong, nonatomic) NSString *previousText;
@end

@implementation MyRestoringTextField
- (BOOL)becomeFirstResponder
{
    BOOL result = [super becomeFirstResponder];
    self.previousText = self.text;
    return result;
}
- (BOOL)resignFirstResponder
{
    BOOL result = [super resignFirstResponder];
    if (self.text.length == 0)
        self.text = self.previousText;
    return result;
}
@end 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T23:59:48.633

在`textFieldDidBeginEditing`委托方法中，在清除 UITextField 之前将当前值保存到持久变量。然后在`didFinishEditing`委托方法中，如果用户输入的新长度为 0，则将文本设置回存储的值！

[UITextField 代表文档](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html#//apple_ref/occ/intf/UITextFieldDelegate)供参考。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-18T09:01:05.950

如果您无法输入，要清除然后恢复文本字段，请使用以下委托：

```
-(void)textFieldDidBeginEditing:(UITextField *)textField
{
   [[NSUserDefaults standardUserDefaults] setObject:textField.text forKey:kTextFieldIdentifier];
    textField.text = @"";
}

-(BOOL)textFieldShouldEndEditing:(UITextField *)textField
{
    if ([textField.text isEqualToString:@""])
        textField.text  = [[NSUserDefaults standardUserDefaults]
                    stringForKey:kTextFieldIdentifier];
    return YES;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-14T06:09:44.840

截至`iOS 8.1`，`textFieldDidBeginEditing`已经收到了一个明确的文本。你应该使用

```
-(BOOL) textFieldShouldBeginEditing:(UITextField *)textField 
```

初始化占位符字段。

# django - 'module' 对象在访问 /admin 时没有属性 'PeriodicTask'

> ID：12169153
> 
> 赞同：0
> 
> 时间：2012-08-28T23:56:30.850
> 
> 标签：django, django-celery

我已经安装了 djcelery，它似乎安装正确：

```
In [1]: from djcelery import models

In [2]: models.PeriodicTask
Out[2]: djcelery.models.PeriodicTask 
```

但是，当我访问管理站点时，我收到此错误，这似乎暗示 djcelery 存在问题。我怀疑这与我的设置有关。错误的详细信息如下。有人看过这个或有什么想法吗？

```
AttributeError at /admin/
'module' object has no attribute 'PeriodicTask'
Request Method: GET
Django Version: 1.4
Exception Type: AttributeError
Exception Value:    
'module' object has no attribute 'PeriodicTask'
Exception Location: /System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/importlib/__init__.py in import_module, line 37
Python Version: 2.7.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T15:02:59.303

事实证明，由于我的一个应用程序中的旧 tasks.pyc（其中 tasks.py 已被删除），我收到了这个错误。Djcelery 自动尝试在所有已安装的应用程序中加载 tasks.py 文件，而这个显然错误地引用了 PeriodicTask。

# eclipse - Eclipse 中没有 Java 控制台输出；与 PyDev 一起使用

> ID：12169154
> 
> 赞同：3
> 
> 时间：2012-08-28T23:56:34.913
> 
> 标签：eclipse, pydev

我在一个工作区中有一个 Java 和一个 PyDev 项目。当我运行 PyDev 项目时（使用 Run > Run As > Python Run 的主脚本或使用 Python 单元测试的相关单元测试），控制台输出看起来不错。但是，当我切换到 Java 项目时，打开主类，确保光标焦点在主类中，然后使用 Run > Run as > [my run config] 运行它，控制台中没有输出，stdout或标准错误。我已经尝试过运行/调试 > 控制台 > 固定宽度控制台选中和未选中，类似地限制控制台输出。“分配控制台”已签入 [我的运行配置]。

我尝试将输出重定向到运行配置中的文件，但运行后日志文件为空；因此，我怀疑 stdout/stderr 被困在某个地方。我怀疑是 PyDev 导致了这个问题，因为当我运行 Java 项目时，这个异常可靠地在错误日志中显示了大约 6 次：

```
Launch shortcut 'org.python.pydev.debug.ui.launchShortcut.python.unittest' enablement expression caused exception. Shortcut was removed.

stacktrace:
org.eclipse.core.runtime.CoreException: No property tester contributes a property org.python.pydev.debug.ui.python_type to type class org.eclipse.ui.part.FileEditorInput
    at org.eclipse.core.internal.expressions.TypeExtensionManager.getProperty(TypeExtensionManager.java:123)
    at org.eclipse.core.internal.expressions.TestExpression.evaluate(TestExpression.java:96)
    at org.eclipse.core.internal.expressions.CompositeExpression.evaluateOr(CompositeExpression.java:68)
    at org.eclipse.core.internal.expressions.OrExpression.evaluate(OrExpression.java:21)
    at org.eclipse.core.internal.expressions.CompositeExpression.evaluateAnd(CompositeExpression.java:53)
    at org.eclipse.core.internal.expressions.AndExpression.evaluate(AndExpression.java:29)
    (... and so on) 
```

此外，从只有 Java 项目的不同工作区中的 Java 程序打印也可以正常工作。

我尝试卸载 PyDev 并重新启动 Eclipse，但我仍然遇到同样的问题。重新安装 PyDev 后我仍然有这些错误。

有没有人遇到过这个问题，或者知道解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T17:29:50.530

Well, I feel like an idiot; turns out, I had redirected stdout/err to a log file that I had long since forgotten about, and stuck somewhere difficult to find.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T18:48:19.237

我遇到了同样的问题，所以我做了一些研究。似乎有一个旧问题（2006-2008），但通过在启动配置中添加一个选项来分配控制台来解决它。这可从 Run -> Debug Configurations 菜单选项的 Common 选项卡中获得。也许这在 PyDev 安装后只是未选中？

如果这是一个新错误，建议有两种可能的解决方法：

*   设置使用远程调试而不是本地调试的调试启动配置。
*   对 System.out 使用缓冲写入器。

以下是供参考的线程：Eclipse 错误 - [https://bugs.eclipse.org/bugs/show_bug.cgi?id=122429](https://bugs.eclipse.org/bugs/show_bug.cgi?id=122429) 解决方法线程 - [Eclipse IDE 中的 java.io.Console 支持](https://stackoverflow.com/questions/104254/java-io-console-support-in-eclipse-ide#105403)

# apache - Apache重写问题

> ID：12169159
> 
> 赞同：0
> 
> 时间：2012-08-28T23:57:06.933
> 
> 标签：apache, mod-rewrite

我在 .htaccess 中有以下几行：

```
RewriteRule ^/?movielist/([0-9]+)\-([0-9]+)\.html$ modules.php?module=movies&do=main&pg=$1&ipp=$2 [L]
RewriteRule ^/?movielist/(genre|year|stars)/([a-zA-Z0-0%20]+)$ modules.php?module=movies&do=main&sort=$1&$1=$2 [L]
RewriteRule ^/?movielist/(genre|year|stars)/([a-zA-Z0-0%20]+)/([0-9]+)\-([0-9]+)\.html$ modules.php?pg=1&ipp=20&module=movies&do=main&sort=$1&$1=$2 [L] 
```

例如，如果我将 url 指向 /movielist/Drama，则脚本有效。问题在于分页。如果我指向 /movielist/Drama/1-20.html 我得到 404 错误。任何想法为什么？

如果我指向未重写的 URL，它就可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:16:00.417

你的规则有一些问题。最后一条规则的目标（与分页匹配的规则）不使用这些数字中的任何一个：

```
modules.php?pg=1&ipp=20&module=movies&do=main&sort=$1&$1=$2 [L] 
```

所以从不使用`$3`和`$4`反向引用，它应该是：

```
modules.php?pg=$3&ipp=$4&module=movies&do=main&sort=$1&$1=$2 [L] 
```

除此之外，当我将这些规则放在 vanilla apache 安装中的空白 htaccess 中时，我没有得到 404。`/movielist/genre/Drama/1-12.html`被重写为`/modules.php?pg=1&ipp=20&module=movies&do=main&sort=genre&genre=Drama`，除了`1`and`12`永远不会被使用。

# java - 使用视图名称映射 url

> ID：12169160
> 
> 赞同：0
> 
> 时间：2012-08-28T23:57:12.773
> 
> 标签：java, spring, spring-mvc, tiles

我正在使用瓷砖 + Spring MVC。当我有一个名为 的视图时`A`，我可以直接访问它，而无需使用 url 进行任何映射`/A`。我的问题是我调用了一些视图，`A/B/C`但我无法使用`/A/B/C`. 我真的不想为此制作控制器。我有哪些选择？

顺便说一句：我不确定谁负责将 Url 映射到视图名称。知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:37:22.880

我想你正在寻找[`<mvc:resources>`](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/mvc.html#mvc-static-resources).

关于映射 URL 到视图
1\. Dispatcher servlet 接收请求
2\. 它要求处理程序映射找到相应的控制器。
3\. 然后将请求转发给相应的控制器。
4.控制器返回模型（即数据）和逻辑视图名称。
5.视图解析器帮助调度器servlet从逻辑视图名称中找出实际视图。

![在此处输入图像描述](../Images/8352bffc301a29e86efcfd0767f8e1e5.png)
[**资源**](http://www.dzone.com/tutorials/java/spring/spring-mvc-tutorial-1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T08:19:13.780

You can create simple controllers in your mvc namespace config declaratively with the view-controller element like:

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    ...
    <mvc:view-controller path="/A/B/C" view-name="A/B/C" />
    ...
</beans> 
```

If you have lots of views that follow this pattern, you could think about implementing your own ViewResolver that maps whole paths to view names. Have a look at UrlBasedViewResolver for inspiration.

# heroku - 在 heroku 上主持 sencha touch 2

> ID：12169165
> 
> 赞同：2
> 
> 时间：2012-08-28T23:58:20.560
> 
> 标签：heroku, sencha-touch-2, host

是否可以在 Heroku 上托管 sencha touch 2 wep 应用程序？

我知道，Heroku 在库列表中没有 Sencha，但也许我可以使用 Node.js 或其他东西来推送应用程序。

如果您知道如何执行此操作的解决方案或示例/说明，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T14:49:10.133

是的，这绝对是可能的，我已经尝试了两种选择，都对我有用。

1.  您可以使用 Node.js，然后您只需[编写一个 Web 服务器](https://github.com/odi86/kort/blob/34cc2e6446ffe6de68c6ee5b57aae16991b3319e/server.js)来提供您的静态内容。
2.  可能最简单的解决方案是创建一个`index.php`文件并让 heroku 将您的应用程序检测为 PHP。这为您提供了一个 Apache Web 服务器，您可以将其用于您的 Sencha Touch 应用程序。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T16:05:47.533

我也找到了一个解决方案，对我来说效果很好：

1.  创建了一个基于 NodeJs 的 express 项目

2.  使用路由器指向 sencha 文件

3.  在 heroku 上部署为 node.js [https://devcenter.heroku.com/articles/nodejs](https://devcenter.heroku.com/articles/nodejs)

4.  除了 Heroku 托管甚至获得了 NodeJs 的优势，几乎将 JS 作为服务器端和客户端语言。

# c# - 文本框验证表达式属性字母数字

> ID：12169168
> 
> 赞同：0
> 
> 时间：2012-08-28T23:58:41.523
> 
> 标签：c#, asp.net, visual-studio-2010, validation, textbox

我正在使用一个简单的`RegularExpressionValidator`. 文本框的长度必须为 14 位（正好 14 位）。所以，我使用`ValidationExpression="\d{14}"></asp:RegularExpressionValidator>`但那个实例只允许数字，我也需要字母（要清楚，没有特殊字符或点，分号，只有数字和字母）。

有什么比 更适合`"\d{14}"`？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:20:00.597

\d 仅替换数字字符。尝试使用 \w 替换字母和数字。

所以你的表达应该是：

```
<asp ValidationExpression="\w{14}"></asp:RegularExpressionValidator> 
```

# python - 用熊猫查找两列或多列的最大值

> ID：12169170
> 
> 赞同：139
> 
> 时间：2012-08-28T23:58:47.137
> 
> 标签：python, dataframe, pandas

我有一个带有列的数据框`A`，`B`。我需要`C`为每条记录/行创建一个列：

`C = max(A, B)`.

我该怎么做呢？

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2012-08-29T00:27:33.543

您可以像这样获得最大值：

```
>>> import pandas as pd
>>> df = pd.DataFrame({"A": [1,2,3], "B": [-2, 8, 1]})
>>> df
   A  B
0  1 -2
1  2  8
2  3  1
>>> df[["A", "B"]]
   A  B
0  1 -2
1  2  8
2  3  1
>>> df[["A", "B"]].max(axis=1)
0    1
1    8
2    3 
```

所以：

```
>>> df["C"] = df[["A", "B"]].max(axis=1)
>>> df
   A  B  C
0  1 -2  1
1  2  8  8
2  3  1  3 
```

如果您知道“A”和“B”是唯一的列，您甚至可以逃脱

```
>>> df["C"] = df.max(axis=1) 
```

`.apply(max, axis=1)`我猜你也可以使用。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2019-01-22T00:25:40.053

@DSM 的答案在几乎任何正常情况下都很好。但是如果你是那种想要比表面更深入一点的程序员，你可能有兴趣知道在底层[**`.to_numpy()`**](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.values.html)（或`.values`<0.24）数组上调用 numpy 函数比直接调用要快一些调用在 DataFrame/Series 对象上定义的（cythonized）函数。

例如，您可以[**`ndarray.max()`**](https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.ndarray.max.html#numpy-ndarray-max)沿第一个轴使用。

```
# Data borrowed from @DSM's post.
df = pd.DataFrame({"A": [1,2,3], "B": [-2, 8, 1]})
df
   A  B
0  1 -2
1  2  8
2  3  1

df['C'] = df[['A', 'B']].values.max(1)
# Or, assuming "A" and "B" are the only columns, 
# df['C'] = df.values.max(1) 
df

   A  B  C
0  1 -2  1
1  2  8  8
2  3  1  3 
```

如果您的数据有`NaN`s，您将需要[**`numpy.nanmax`**](https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.nanmax.html)：

```
df['C'] = np.nanmax(df.values, axis=1)
df

   A  B  C
0  1 -2  1
1  2  8  8
2  3  1  3 
```

* * *

您也可以使用`numpy.maximum.reduce`. [**`numpy.maximum`**](https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.maximum.html)是一个[ufunc（通用函数）](https://docs.scipy.org/doc/numpy-1.15.1/reference/ufuncs.html)，[每个 ufunc 都有一个`reduce`](https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.ufunc.reduce.html#numpy-ufunc-reduce)：

```
df['C'] = np.maximum.reduce(df['A', 'B']].values, axis=1)
# df['C'] = np.maximum.reduce(df[['A', 'B']], axis=1)
# df['C'] = np.maximum.reduce(df, axis=1)
df

   A  B  C
0  1 -2  1
1  2  8  8
2  3  1  3 
```

* * *

[![在此处输入图像描述](../Images/fd90622839e3faf942560a35e3dc4300.png)](https://i.stack.imgur.com/2TEJO.png)

`np.maximum.reduce`并且`np.max`看起来或多或少相同（对于大多数正常大小的 DataFrames）——并且恰好比`DataFrame.max`. 我想这种差异大致保持不变，并且是由于内部开销（索引对齐、处理 NaN 等）。

该图是使用[perfplot](https://github.com/nschloe/perfplot)生成的。基准代码，供参考：

```
import pandas as pd
import perfplot

np.random.seed(0)
df_ = pd.DataFrame(np.random.randn(5, 1000))

perfplot.show(
    setup=lambda n: pd.concat([df_] * n, ignore_index=True),
    kernels=[
        lambda df: df.assign(new=df.max(axis=1)),
        lambda df: df.assign(new=df.values.max(1)),
        lambda df: df.assign(new=np.nanmax(df.values, axis=1)),
        lambda df: df.assign(new=np.maximum.reduce(df.values, axis=1)),
    ],
    labels=['df.max', 'np.max', 'np.maximum.reduce', 'np.nanmax'],
    n_range=[2**k for k in range(0, 15)],
    xlabel='N (* len(df))',
    logx=True,
    logy=True) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-09T16:39:06.027

在多个列中找到最大值将是：

```
df[['A','B']].max(axis=1).max(axis=0) 
```

例子：

```
df = 

                         A      B
timestamp                                
2019-11-20 07:00:16  14.037880  15.217879
2019-11-20 07:01:03  14.515359  15.878632
2019-11-20 07:01:33  15.056502  16.309152
2019-11-20 07:02:03  15.533981  16.740607
2019-11-20 07:02:34  17.221073  17.195145

print(df[['A','B']].max(axis=1).max(axis=0))
17.221073 
```

# php - crypt 函数使用相同的盐、密码和河豚返回不同的结果

> ID：12169176
> 
> 赞同：1
> 
> 时间：2012-08-28T23:59:56.550
> 
> 标签：php, mysql, login, blowfish, crypt

我已经开始着手制作登录系统并使用 crypt 函数对密码进行编码。我的问题是，当我使用用户名和密码注册用户时，一切正常，并将用户名密码和盐保存到数据库中。这是注册代码：

注意：目前这只是一个测试注册页面

```
$username=$_POST["username"];
$password=$_POST["password"];

$salt = substr(md5(microtime()),rand(0,26),15);
$hashedPass = crypt($password,'$2y$10$' . $salt);

$sql="INSERT INTO `users`(`id`, `username`, `password`, `salt`, `Perm_level`) VALUES (NULL,'$username','$hashedPass','$salt','test')";
$result=mysql_query($sql); 
```

它加密它正确所以一个真实的例子是密码测试出来： $2y$10$d395985a2ca993f$$$$$$.k8lxPkUCenMKsOJ6V8tdO6Pl/Gl1/OW

它的盐是：
d395985a2ca993f

当我登录时，虽然我将盐从数据库中拉出并尝试以相同的方式重新加密，但我得到了不同的加密密码......盐是正确的，密码的第一部分也是如此，所以这部分“$2y$10$d395985a2ca993f$$$$$$$。”

下面是用于登录的代码：

```
$sql="SELECT * FROM `users` WHERE username='$user'";
$result=mysql_query($sql);

while($rows=mysql_fetch_array($result)){
$salt=$rows['salt'];
}

$hashedPass = crypt($password,'$2y$10$' . $salt);

$sql="SELECT * FROM `users`WHERE username='$user' AND `password` = '$hashedPass'";
$result=mysql_query($sql);

    if($result) {
        if(mysql_num_rows($result) == 1) {
            echo "Successful Login";

        }
    } 
```

对于登录页面，盐是正确的，但这是经过哈希处理后的密码：$2y$10$d395985a2ca993f$$$$$$.ccy3PKl.TsG26FWJBFXKmpQ3wtk4AqC

第一部分到句号是正确的，只是后半部分不同

我曾尝试将盐设置为手动盐，例如 abc 或 123，仅用于登录和注册页面的测试，但我仍然遇到相同的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:14:34.677

当您将值放入数据库时​​，请确保对它们进行转义。

```
$escapeUserName= mysql_real_escape_string($username);
$escapeHashedPass= mysql_real_escape_string($hashedPass);
$escapeSalt= mysql_real_escape_string($salt);

$sql="INSERT INTO `users`(`id`, `username`, `password`, `salt`, `Perm_level`)
      VALUES (NULL,'$escapeUserName','$escapeHashedPass','$escapeSalt','test')"; 
```

否则可能无法正确插入特殊字符，您将遇到遇到的问题。

* * *

请注意，这些 mysql 函数已被弃用，您应该改用 mysqli 或 PDO。如果您这样做了，并且使用了参数化查询，那么这将永远不会发生，因为它们会为您处理转义。这本质上使它们更加安全。在习惯旧功能之前，您应该考虑使用新功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T04:21:57.523

从您的代码中，我看到您使用河豚哈希。

使用河豚散列时，您的盐需要进行 base64 编码，之后您必须将“+”替换为点。

你的盐应该是 22 个字符长。

此外，最佳做法是使用 PHP 哈希包，例如[http://www.openwall.com/phpass/](http://www.openwall.com/phpass/)

很少有人可以编写正确的散列函数。它需要非常先进和专业的知识。

# php - PHP验证码系统

> ID：12169178
> 
> 赞同：0
> 
> 时间：2012-08-29T00:00:19.873
> 
> 标签：php

好的，所以我正在尝试制作自己的验证码系统。我有两个页面，表单页面和表单操作。这是我的代码：

```
<html>
<head>
<title>Captcha</title>
<center>
<form method="POST" action="captcha.php">
<label>Entered Text:  </label><input type="text" name="captcha">
<input type="submit" name="submit" value="Submit Captcha!">
</form>
</center>
</head>
</html>
<?php
$firstdigit = rand(1, 9);
$seconddigit = rand(27, 105);
$lastdigit = rand(1050, 9515);
$middle = rand(1000, 20000);
$captcha = "<b><center><font face=\"Arial\">AX-$firstdigit-X-$seconddigit-K3I$middle-AN3Z-$lastdigit</font></center></b>";
echo "$captcha";
?> 
```

然后是下一个：

```
<?php
$captcha2 = $_POST['captcha']; //This is the input field
$submit = $_POST['submit'];  //This is Submit
if ($submit) {
  if ($captcha2) {
    echo "Everything is good."; //Echo'd if everything is good
   } else {
  echo "Please fill in all fields."; //Echo'd if $captcha isn't filled out
   }
 } else {
echo "Direct access not allowed.  Please click submit.";   //Echo'd if  submit is not pressed, and they access this directly.
}
?> 
```

如何从其他表单中获取 $captcha 变量并将其放到 captcha.php 页面上？我认为 $captcha 有很多变量放在一个中，那么如何

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:02:11.490

使用会话： http: [//php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php)

创建会话时生成一个随机字符串并将其存储在`$_SESSION`. 使用该值绘制验证码并进行检查。

# java - 使用 Mockito 和 PowerMockito 模拟类对象

> ID：12169183
> 
> 赞同：9
> 
> 时间：2012-08-29T00:00:57.670
> 
> 标签：java, junit, mockito, powermock

是否可以使用 Mockito 和/或 PowerMockito 模拟类对象？

就像是：

```
Class<Runnable> mockRunnableClass = mock(Class<Runnable>.class); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T10:13:25.710

如果您不能重构代码，为什么不使用代理没有很多选项，正如@jherics 提到的那样，java 系统类由引导类加载器加载，而 powermock 无法重新定义它们的字节码。

然而，Powermock 现在带有一个代理，它将允许系统类模拟。[在这里](http://code.google.com/p/powermock/wiki/PowerMockAgent)查看完整的解释。

主要思想是修改您的 java 命令并添加：

```
-javaagent: path/to/powermock-module-javaagent-1.4.12.jar 
```

该代理所做的基本工作是取消类的最终确定，以允许将来在特定测试中进行模拟，这就是为什么您需要使用特定类型与代理进行通信的原因，例如使用 JUnit ：

```
@Rule PowerMockRule rule = new PowerMockRule(); // found in the junit4 rule agent jar 
```

也支持 TestNG。只需查看[wiki 页面](http://code.google.com/p/powermock/wiki/PowerMockAgent)以获取更多信息。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T15:53:27.807

模拟类的替代方法可能是使用工厂。我知道您担心重构，但这可以在不更改类的公共 API 的情况下完成。您没有提供太多代码来理解您尝试测试的类，但这里有一个在不更改 API 的情况下进行重构的示例。这是一个微不足道的课程，但它可能会给你一个想法。

```
public class Instantiator {

  public Runnable getNewInstance(Class<Runnable> runnableClass) throws Exception {
    return runnableClass.newInstance();
  }
} 
```

当然，测试这个微不足道的类最简单的方法是使用真正的 Runnable 类，但是如果你试图模拟这个类，你会遇到你遇到的问题。所以，你可以重构它：

```
public class PassThruFactory {
  public Object newInstance(Class<?> clazz) throws Exception {
    return clazz.newInstance();
  }
}

public class Instantiator {
  private PassThruFactory factory = new PassThruFactory();

  public Runnable getNewInstance(Class<Runnable> runnableClass) throws Exception {
    return (Runnable)factory.newInstance(runnableClass);
  }
} 
```

现在 Instantiator 使用相同的公共 API 完成了它之前所做的（非常简单的）事情，并且不需要该类的任何客户端自己进行任何特殊的注入。但是，如果您想模拟工厂类并注入它，那很容易做到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T07:46:31.793

首先，如评论中所述，您需要执行以下操作：

```
Class<Runnable> mockRunnableaClass = (Class<Runnable>)mock(Class.class); 
```

但由于 PowerMock 的限制，这不会以通常的方式工作。您不能简单地从 java.lang、java.net、java.io 或其他系统类中模拟类，因为它们是由 Java 的引导类加载器加载的，并且不能由 PowerMock 的类加载器操作字节码。（请参阅[PowerMock 常见问题解答](https://github.com/powermock/powermock/wiki/FAQ)#4。）从 PowerMock 1.2.5 开始，您可以解决此问题。如果您要测试的课程是这样的：

```
public class ClassToTest {
  private Class<Runnable> runnableClass;

  public void setRunnableClass(Class<Runnable> runnableClass) {
    this.runnableClass = runnableClass;
  }

  public Runnable foo() {
    return runnableClass.newInstance();
  }
} 
```

然后你会这样做：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest({ ClassToTest.class }) // Prepare the calling class for test
public class SystemClassUserTest {

  @Test
  public void testFoo() throws Exception {
    Class<Runnable> mockClass = (Class<Runnable>) mock(Class.class);
    Runnable mockRunnable = mock(Runnable.class);

    ClassToTest objectUT = new ClassToTest();
    objectUT.setRunnableClass(mockClass);

    when(mockClass.newInstance()).thenReturn(mockRunnable);
    assertThat(objectUT.foo(), is(sameInstance(mockRunnable);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-02T11:17:41.610

这个怎么样。创建一个在类 PCService 中有一个对象（MS）的 get 方法，然后模拟它。

```
public class PCService implements PCServiceIf {
    public MSIf getMS() {
        return ms;
    }

    private MSIf ms = new MS();
    public boolean isMovieAccessibleToMyLevel(String myLevel, String movieId)  {
        return  getMS().getPCL(movieId);
    }
}

@Test
public void testIsMovieAccessibleToMyLevelMock()  {
    msMock = mock(MS.class);
    spy  = spy(new PCService());

    doReturn(msMock).when(spy).getMS();
    when(msMock.getPCL(movieId)).thenReturn(value);
    when(spy.getMS().getPCL(movieId)).thenReturn(value);
    assertTrue(spy.isMovieAccessibleToMyLevel("PG", movieId) == true);
} 
```

# python - 使用 2 个列表

> ID：12169185
> 
> 赞同：0
> 
> 时间：2012-08-29T00:01:09.497
> 
> 标签：python

我有两个列表：一个只包含数字，而另一个包含字符串。例如：

```
listA = [ 3, 4, 5, 7]

listB = ["Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637]", "Z2 O95409 V595 **p.His4Leu** Dase - Hophaly type 5 (HPE5) [609637]", "Z2 O95409 V595 **p.His5Leu** Dase - Hophaly type 5 (HPE5) [609637]", "Z2 O95409 V595 **p.His7Leu** Dase - Hophaly type 5 (HPE5) [609637]" ] 
```

我想匹配 listA 中的数字和 listB 中的粗体字。最终，当我使用 listA 的数量时，我想打印整个 listB 字符串。例如，如果我在 listA 中使用数字 3，我还想打印出来：`Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637]`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:08:09.407

像字典一样？使用`zip`：

```
listAtoB = dict(zip(listA, listB))

listAtoB[3] # Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:09:54.827

像这样的东西？

```
listA = [ 3, 4, 5, 7]
ListB = ["Z2 O95409 V595 p.His3Leu Dase - Hophaly type 5 (HPE5) [609637]", "Z2 O95409 V595 p.His4Leu Dase - Hophaly type 5 (HPE5) [609637]", "Z2 O95409 V595 p.His5Leu Dase - Hophaly type 5 (HPE5) [609637]", "Z2 O95409 V595 p.His7Leu Dase - Hophaly type 5 (HPE5) [609637]"]
for x in listA:
    for y in ListB:
        if y[y.index("p.His")+5]==str(x): #if x in "p.HisxLeu"
            print x,y 
```

或使用`filter()`：

```
for x in listA:
    for y in filter(lambda z:z[z.index("p.His")+5]==str(x),ListB):
        print x,y 
```

**输出：**

```
3 Z2 O95409 V595 p.His3Leu Dase - Hophaly type 5 (HPE5) [609637]
4 Z2 O95409 V595 p.His4Leu Dase - Hophaly type 5 (HPE5) [609637]
5 Z2 O95409 V595 p.His5Leu Dase - Hophaly type 5 (HPE5) [609637]
7 Z2 O95409 V595 p.His7Leu Dase - Hophaly type 5 (HPE5) [609637] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T00:30:53.900

创建将 listA 中的项目映射到 ListB 中的项目的字典很容易。如果您使用的是 Python >= 2.7，则可以使用字典理解（如果没有，请参阅其他`dict`用于实现相同目的的答案）：

```
listA = [ 3, 4, 5, 7]
ListB = ['Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637]', 'Z2 O95409 V595 **p.His4Leu** Dase - Hophaly type 5 (HPE5) [609637]', 'Z2 O95409 V595 **p.His5Leu** Dase - Hophaly type 5 (HPE5) [609637]', 'Z2 O95409 V595 **p.His7Leu** Dase - Hophaly type 5 (HPE5) [609637]' ]

d = { a:b for a, b in zip(listA, ListB) }
from pprint import pprint
pprint(d)
{3: 'Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637]',
 4: 'Z2 O95409 V595 **p.His4Leu** Dase - Hophaly type 5 (HPE5) [609637]',
 5: 'Z2 O95409 V595 **p.His5Leu** Dase - Hophaly type 5 (HPE5) [609637]',
 7: 'Z2 O95409 V595 **p.His7Leu** Dase - Hophaly type 5 (HPE5) [609637]'} 
```

但是，考虑到您的要求，我建议使用字典词典来查找蛋白质名称及其完整描述。

```
d = { a: {'protein': b.split('**')[1], 'description': b} for a, b in zip(listA, ListB) }
pprint(d)
{3: {'description': 'Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637]',
     'protein': 'p.His3Leu'},
 4: {'description': 'Z2 O95409 V595 **p.His4Leu** Dase - Hophaly type 5 (HPE5) [609637]',
     'protein': 'p.His4Leu'},
 5: {'description': 'Z2 O95409 V595 **p.His5Leu** Dase - Hophaly type 5 (HPE5) [609637]',
     'protein': 'p.His5Leu'},
 7: {'description': 'Z2 O95409 V595 **p.His7Leu** Dase - Hophaly type 5 (HPE5) [609637]',
     'protein': 'p.His7Leu'}} 
```

现在您可以执行如下查找：

```
>>> print d[3]['protein']
p.His3Leu
>>> print d[3]['description']
Z2 O95409 V595 **p.His3Leu** Dase - Hophaly type 5 (HPE5) [609637] 
```

# css - 表中行的灯箱或模式样式效果

> ID：12169187
> 
> 赞同：0
> 
> 时间：2012-08-29T00:01:45.660
> 
> 标签：css, html

我有一个显示一些信息的表（使用 datatables.js 呈现）。

当用户单击行中的按钮时，我会打开（添加新的 tr）到表中。

然后我在新行中显示一些字段，包括确认/取消按钮。

我想要做的是让我可以将用户输入保留在行上并禁用给定父 div 的所有内容，不包括新行。

我只能想到使用 z-index，使 tr 成为高 z-index 并将新 div 添加到父位置：绝对，在 0,0。这是正确的方法吗？给 tr 一个高 z 指数是否正确？

使用 HTML5/CSS3 (Jquery)

谢谢

山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:36:23.387

这可以通过多种方式完成。这是一个。

[http://jsfiddle.net/Ktk9U/](http://jsfiddle.net/Ktk9U/)

# c# - 将对象强制转换为 IEnumerable 其中 T 未知

> ID：12169188
> 
> 赞同：17
> 
> 时间：2012-08-29T00:01:53.923
> 
> 标签：c#, reflection

我正在尝试使用 Reflection 并遇到以下情况。

在下面的代码中，我们假设 'obj' 的类型可以是`IEnumerable<>`or`ICollection<>`或`IList<>`。

我想将此 System.Object 强制转换为`IEnumerable<>`始终（作为`ICollection<>`并`IList<>`继承自`IEnumerable<>`），以便我想枚举集合并使用反射来编写各个项目。

这背后的动机是我只是想看看序列化器通常如何序列化数据，所以我试图模拟这种情况，希望也能理解反射。

我想过将对象转换**为非通用 IEnumerable**，但认为这会导致不必要的对象装箱，当我们说`IEnumerable<int>`...的实际实例时，我想对了吗？

```
private void WriteGenericCollection(object obj)
    {
        Type innerType = obj.GetType().GetGenericArguments()[0];

        //Example: IEnumerable<int> or IEnumerable<Customer>
        Type generatedType = typeof(IEnumerable<>).MakeGenericType(innerType);

        //how could i enumerate over the individual items?
    } 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-29T00:19:33.773

好吧，由于直到运行时您才知道项目的实际类型，因此您不需要使用通用`IEnumerable<T>`接口；只需使用非通用的，`IEnumerable`（通用的继承自它）：

```
private void WriteGenericCollection(object obj)
{
    IEnumerable enumerable = (IEnumerable)obj;
    foreach(object item in enumerable)
    {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T00:18:36.947

你的问题充满了误解。让我们把它们清理干净。

> 在下面的代码中，我们假设 'obj' 的类型可以是 `IEnumerable<>`or`ICollection<>`或`IList<>`。

如果这是真的，并且如果您知道可枚举的类型，那么编写该方法的更好方法是

```
private void WriteGenericCollection<T>(IEnumerable<T> obj)
{
    // ...
} 
```

> 我想始终将此 System.Object 向下转换为 IEnumerable<> （因为 ICollection<> 和 IList<> 无论如何都从 IEnumerable<> 继承），因此我想枚举集合并使用反射来编写各个项目。

在谈论接口时，“继承”不是一个正确的术语；它也可能给你错误的想法。最好将接口视为*契约*：在考虑实现接口时，您只能决定按照作者的意图实现它或根本不实现它。

一些接口是其他接口的超集；他们的合同说“除了合同规定的其他内容外，实施者还必须这样做*”*。但是从来没有像继承中常见的那样共享实现，因为接口没有任何共享。

“向下转型”也不是您在该方法中所做的正确术语。向下转换意味着转换为更派生的类；还有一个接口：

```
// Note: the method is still generic!
private void WriteGenericCollection<T>(object obj)
{
    var casted = (IEnumerable<T>)obj;
} 
```

> 我想过将对象向下转换为非通用 IEnumerable，但认为这会导致不必要的对象装箱，当我们说 IEnumerable 的实际实例时......我想对了吗？

*当且仅当*`IEnumerable<T>`对象是`T`值[类型](http://msdn.microsoft.com/en-us/library/s1ax56ch.aspx)（数值类型、a `bool`、an`enum`或 a `struct`）时，才会发生装箱。如果该对象`IEnumerable<T>`为某些已知对象实现，`T`那么您可以简单地将其转换为该对象。如果`T`未知，则转换为非泛型`IEnumerable`并承受可能的性能损失（无论如何都无法绕过它）。

如果您对对象*一无所知*，则只需要使用反射（当然，在这种情况下，您还需要为无法枚举的对象制定计划，否则为什么首先允许将它们传递给您的方法？）。

# html - 后边距左/右自动子 div 边距无响应

> ID：12169191
> 
> 赞同：0
> 
> 时间：2012-08-29T00:02:07.917
> 
> 标签：html, css

我最近了解到，我可以通过`margin-left:auto;margin-right:auto`. 这太棒了，我不敢相信我不知道。但是，它似乎会影响子 div，因此它们不再正常接受边距。

[http://jsfiddle.net/mLxx5/](http://jsfiddle.net/mLxx5/)

为什么它`#header_text`不会从`#CBS_content_container`. 相反，它使用窗口作为其原点来获取其边距。就像，如果我改变`#header_text{margin:150px;}`，它会疯狂地改变事情。

谢谢你的帮助; 我相信这很简单！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:06:55.400

如果你把`overflow:hidden`你的容器 div 它会让内边距更好地工作。这与汽车无关，只是利润如何运作。

在内部容器上使用填充而不是边距可能会更好。

# c++ - C++ 是否要求您从其派生类初始化基类成员？

> ID：12169194
> 
> 赞同：3
> 
> 时间：2012-08-29T00:02:20.473
> 
> 标签：c++, inheritance

```
class Base {
public:
    int a;
    Base():a(0) {}
    virtual ~Base();
}
class Derived : public Base {
public:
    int b;
    Derived():b(0) {
        Base* pBase = static_cast<Base*>(this);
        pBase->Base();
    }
    ~Derived();
} 
```

对基类构造函数的调用是必要的还是 c++ 会自动执行此操作？例如，C++ 是否要求您从任何派生类初始化基类成员？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T00:06:45.747

在调用派生类的构造函数之前，将自动调用基类的构造函数。

您可以使用初始化列表显式指定要调用的基本构造函数（如果有多个）：

```
class Base {
  public:
    int a;
    Base():a(0) {}
    Base(int a):a(a) {}
};
class Derived {
  public:
    int b;
    Derived():Base(),b(0) {}
    Derived(int a):Base(a),b(0) {}
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:05:33.733

基类构造函数被自动调用（在派生类构造函数之前）。因此，您不需要也绝对不能尝试手动调用基本构造函数。

# android - 三个按钮中只有一个起作用

> ID：12169201
> 
> 赞同：1
> 
> 时间：2012-08-29T00:03:27.357
> 
> 标签：android, android-button

嘿，我正在尝试使用不同的按钮来打开 android 项目中的不同页面，但只有一个按钮打开了一个新页面。

我是编程新手，所以我的术语可能不正确，但我正在关注一个 youtube 教程，它展示了如何创建一个按钮并使其打开一个新页面。我尝试为多个按钮执行此操作，但我认为我在主要活动中犯了错误。抱歉，如果我没有提供写信息来帮助我解决问题。

```
package test.activity.today;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle; 
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class ActivityTutorialActivity extends Activity {
/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button next = (Button) findViewById(R.id.next_button);
    next.setOnClickListener(new OnClickListener(){

        public void onClick (View v){
            Intent myIntent = new Intent(v.getContext(), NextActivity.class);
            v.getContext().startActivity(myIntent);

        }               
    });
}

public void onCreate1(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button next = (Button) findViewById(R.id.question_button);
    next.setOnClickListener(new OnClickListener(){

        public void onClick (View v){
            Intent myIntent = new Intent(v.getContext(), Question.class);
            v.getContext().startActivity(myIntent);

        }               
    });
}

public void onCreate2(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button next = (Button) findViewById(R.id.owner_cost);
    next.setOnClickListener(new OnClickListener(){

        public void onClick (View v){
            Intent myIntent = new Intent(v.getContext(), Owner.class);
            v.getContext().startActivity(myIntent);
        }
    });
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:08:24.260

你应该只有一种`onCreate()`方法..检查android[活动的生命周期](http://developer.android.com/reference/android/app/Activity.html)来理解它

```
package test.activity.today;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle; 
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class ActivityTutorialActivity extends Activity {
/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);

Button next = (Button) findViewById(R.id.next_button);
next.setOnClickListener(new OnClickListener(){

    public void onClick (View v){
        Intent myIntent = new Intent(v.getContext(), NextActivity.class);
        v.getContext().startActivity(myIntent);

    }               
});
Button question = (Button) findViewById(R.id.question_button);
question.setOnClickListener(new OnClickListener(){

    public void onClick (View v){
        Intent myIntent = new Intent(v.getContext(), Question.class);
        v.getContext().startActivity(myIntent);

    }               
});
Button ownerCost = (Button) findViewById(R.id.owner_cost);
ownerCost.setOnClickListener(new OnClickListener(){

    public void onClick (View v){
        Intent myIntent = new Intent(v.getContext(), Owner.class);
        v.getContext().startActivity(myIntent);
    }
});
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:10:28.953

您正在复制该`onCreate()`方法...此方法由 Android 本地调用，因此，您的其他方法都不会被调用（如果它们被调用，您会遇到其他问题）。要创建多个按钮，您需要在布局中添加新按钮，然后将它们添加到`onCreate()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:40:25.197

还有另一种实现 onClick 的方法。

在您的布局中，您可以指定调用 onClick 的函数

```
<ImageButton
    android:id="@+id/imageButtonNext1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentRight="true"
    android:background="@color/back_color"
    android:onClick="RegistraterCompanyOnClick"
    android:src="@drawable/ic_next" /> 
```

然后在您的活动中，您可以按其 ID 过滤哪个按钮。见下文。

```
public void RegistraterCompanyOnClick(View v){

    switch(v.getId()){
    case R.id.imageButtonNext1:
        String cname = company.getText().toString();

        if (cname.length()== 0){

            message = getString(R.string.company_required);

            ShowDialog(message);

        }
        else{
            company_name =  company.getText().toString();

            VerifyClient(company_name);
        }

        break;
    case R.id.imageButtonInfo1:
        //message = getString(R.string.registration_info);

        message = "Device ID:\n" + deviceID;

        // TODO Auto-generated method stub
        ShowDialog(message);

        break;
    case R.id.imageButtonHelp1:

        message = getString(R.string.registration_contact);

        // TODO Auto-generated method stub

        ShowDialog(message);
        break;

    case R.id.imageButtonPrevious1:
        Intent resultIntent = new Intent();

        // TODO Auto-generated method stub

        resultIntent.putExtra("company_name",               company.getText().toString());
        resultIntent.putExtra("company_id", companyID);
        resultIntent.putExtra("location_name", location_name);
        resultIntent.putExtra("location_id", locationID);

        setResult(Activity.RESULT_CANCELED, resultIntent);

        finish();
    default:
        break;
    }

} 
```

# php - 为什么我的 HTML 标签消失了？

> ID：12169208
> 
> 赞同：0
> 
> 时间：2012-08-29T00:04:56.150
> 
> 标签：php, javascript

我正在创建一个包含三个组件的网站。（我将添加 JQuery 和 CSS，但现在我只是尝试解决一些基本机制）

我的结构是：

*   表示层的 HTML 文件。
*   用于客户端处理的 JAVASCRIPT 文件
*   用于服务器端处理的 PHP 文件。

下面是我的代码：

html:

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <script type="text/javascript" src="RipListQuery.js"></script>
    <title>CD Riplist Query</title>
</head>
<body onload="getArtists()">
    <h1>CD Riplist Query</h1>
    <div id="divArtists" >

    </div>

</body>
</html> 
```

Javascript：

```
function getArtists() {
xmlhttp = new XMLHttpRequest();

xmlhttp.open("GET","dataAccess.php",false);
xmlhttp.send();

document.getElementById("divArtists").innerHTML=xmlhttp.responseText;
} 
```

php:

```
<?php

$con = mysql_connect('myServerAddress', 'ainsworthremote', 'myPassword');
if (!$con) {
    die("Could not connect: " . mysql_error());

}

$response = 
 "<table border='1' id='Artists'><thead><tr><th>Artist</th><th>Albums</th></tr></thead><tbody>";

mysql_select_db("ainsworthremote", $con);

$sql="SELECT artist, COUNT(*) AS albums FROM CD_RipList GROUP BY artist ORDER BY artist ";

$result=mysql_query($sql);

while ($row = mysql_fetch_array($result)) {
    $response = $response . "<tr>" .
    "<td>" . $row['artist'] . "</td>" .
    "<td>" . $row['albums'] . "</td>" .
    "</tr>";
}
$response = $response . "</tbody></table>";

mysql_close($con);

echo $response;

?> 
```

我没有像预期的那样得到一个充满艺术家姓名的表格，而是得到以下信息：

CD Riplist 查询

```
ArtistAlbums"; mysql_select_db("ainsworthremote", $con); $sql="SELECT artist, COUNT(*) AS albums FROM CD_RipList GROUP BY artist ORDER BY artist "; $result=mysql_query($sql); while ($row = mysql_fetch_array($result)) { $response = $response . "" . "" . $row['artist'] . "" . "" . $row['albums'] . "" . ""; } $response = $response . ""; mysql_close($con); echo $response; ?> 
```

我想知道（除了我做错了什么）是：我的标签发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:47:26.743

您的 while 语句没有意义，即使有，您也应该使用等于 '==' 运算符而不是 '='。您正在从 SQL 请求返​​回一个数组，因此您需要遍历该数组。此外，当附加到现有的 str 变量时，您可以使用“.=”运算符，例如

```
$response .= "</tbody></table>"; 
```

而你的 while 循环可能是一个 foreach 循环。

```
$query = mysql_query($sql);
$result = mysql_fetch_array($result);

foreach($result as $row){
    $response .= "<tr>" .
    "<td>" . $row['artist'] . "</td>" .
    "<td>" . $row['albums'] . "</td>" .
    "</tr>";
}

$response .= "</tbody></table>";
echo $response; 
```

看看是否有帮助。最重要的是，您可能会遇到一些引号转义问题，尽管看起来还不错。

# mysql - 存储过程计数麻烦

> ID：12169209
> 
> 赞同：1
> 
> 时间：2012-08-29T00:05:04.233
> 
> 标签：mysql, stored-procedures

我有一个表 [users]，我希望计算 Movie_ID 每次出现的次数并更新另一个名为 [total] 的表中的记录。所以对于 Movie_ID=81212 它会将值 2 发送到我的 [total] 表。

如下所示：

```
 ------------------------------------
        |  [users]                          |   [total]
    +---------+---------+              +---------+-------------+
    |Movie_ID |Player_ID|              |Movie_ID | Player_Count|  
    +---------+---------+              +---------+-------------+
    |81212    |P3912    |              | 81212   |      2      |
    +---------+---------+              +---------+-------------+
    |12821    |P4851    |              | 12821   |      1      |
    +---------+---------+              +---------+-------------+
    |81212    |P5121    |
    +---------+---------+
(movie_ID + player_ID form composite key
so Movie_ID does not need to be unique) 
```

* * *

所以我试图用一个存储过程来完成这个，这就是我到目前为止所拥有的：我不知道如何编写它循环遍历 [users] 表中每个条目的部分，以便找到每个出现的movie_id 并总结一下。

```
DELIMITER //

CREATE PROCEDURE `movie_total` (OUT movie_count int(5))
LANGUAGE SQL  
MODIFIES SQL DATA  
BEGIN

DECLARE movie_count int(5);

SELECT count(movie_id) AS movie_count FROM users 
foreach unique row in Users  ;

    IF (SELECT COUNT(*) FROM users WHERE movie_id) > 0 
    THEN
    INSERT INTO total (:movie_id, :Player_Count) VALUES (movie_id, movie_count);

 END // 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T06:57:57.747

要更新此字段，您可以使用这样的查询 -

```
UPDATE
  total t
  JOIN (SELECT Movie_ID, COUNT(*) cnt FROM users GROUP BY Movie_ID) m
    ON t.Movie_ID = m.Movie_ID
SET
  t.Player_Count = cnt 
```

但是：你真的需要一张`total`桌子吗？您始终可以使用 SELECT 查询获取此信息；并且`total`表中的信息可能已过时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:32:22.623

我认为你可以在没有循环的情况下做到这一点：

```
update total set total.Player_Count = (select COUNT(Movie_ID) from users where total.Movie_ID=users.Movie_ID group by (Movie_ID)); 
```

# asp.net - aspnetsqlmembershipprovider 有问题

> ID：12169210
> 
> 赞同：0
> 
> 时间：2012-08-29T00:05:10.130
> 
> 标签：asp.net

我在 asp.net 中开发多年，通常在我用于 cms 的同一个 sql server 数据库中设置成员资格和角色。但是，因为我只需要对当前项目中的几个管理页面进行密码保护，我想我会尝试微软在其网站模板中包含的内置帐户文件夹设置。到目前为止，这是一场噩梦。

我在本地机器上登录，但是当我上传到服务器时，我收到以下错误：

" 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。未找到服务器或无法访问服务器。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者： SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)" Microsoft 提供的连接字符串显示 instance = true。

托管服务提供商 GoDaddy 回应了我的请求以查看他们是否可以更正连接字符串，并表示 App_Data 文件夹中的 MDF 文件只能在专用服务器上运行。（我很怀疑……）

让事情变得更具挑战性的是，我可以打开 sql express (.mdf) 数据库并查看我使用注册表单设置的帐户。但是，当我尝试使用我的应用程序中的 Web 配置页面测试默认的 aspnetsqlmembershipprovider 时，我收到一条消息：

无法建立与数据库的连接。如果尚未创建 SQL Server 数据库，请退出网站管理工具，使用 aspnet_regsql 命令行实用程序创建和配置数据库，然后返回此工具设置提供程序。

我非常感谢帮助我了解正在发生的事情，如果没有解决方案，我至少可以以一种智能的方式拆除这个东西，然后在 webconfig 中设置身份验证，这需要十分钟。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T12:37:12.220

神父错了。将您的连接放在这里，然后为您查看。请记住删除连接字符串中的登录 ID 和密码。

# javascript - IIFE jquery 准备好了

> ID：12169213
> 
> 赞同：0
> 
> 时间：2012-08-29T00:05:28.757
> 
> 标签：javascript, jquery, javascript-namespaces, iife

我正在开发一个包含大量 javascript 的 Web 项目，我们开始遇到命名空间冲突，因为我们将所有内容都添加到“$.”。

我阅读了有关命名空间的内容，并在[http://addyosmani.com/blog/essential-js-namespacing/找到了这篇很棒的文章](http://addyosmani.com/blog/essential-js-namespacing/)

我尝试按照建议在 IIFE 内设置命名空间，并认为我很幸运，因为该函数已经设置为

```
(function() { ... }); 
```

所以我将其转换为：

```
(function(namespace, undefined) { ... })(window.stuff = window.stuff || {}); 
```

才发现（下班后）原来是

```
$(function() { ... } 
```

这意味着它都是在 jQuery 的 ready() 函数中调用的。

我想保留命名空间 IIFE，但不知道如何在 jQuery 的 ready() 函数中使用它。这可能吗？如果可以，怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:10:59.057

```
var namespace = (function() {
    // local variables and functions

    function readyHandler($) {
         // DOM ready code
         $("selector").method();
    }

    // exposed methods
    return {
        readyHandler: readyHandler
    };
})();

jQuery(namespace.readyHandler); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:11:10.967

嗯，不确定你是否理解了这些概念......这些函数都不像**立即调用函数表达式**，因为你没有调用函数。

```
(function() { ... } ());
                  --^-- invoke function 
```

jQuery`ready`已经创建了一个新的闭包，所以无论如何你都不需要 IIFE。

在任何情况下，当使用 jQuery 时，您可以在命名空间中使用对象命名您的插件`$`，这样您就不会污染它。

```
$.myplugin = {
  ...
} 
```

# objective-c - 悬停可可下划线 - Objective-C

> ID：12169216
> 
> 赞同：0
> 
> 时间：2012-08-29T00:05:58.053
> 
> 标签：objective-c, cocoa

我一直试图在悬停一个 NSTextField 时加下划线。我第一次尝试时发生的事情是文本带有下划线，但它位于前一个文本的顶部。再一次尝试，它变得越来越大胆。

```
-(void)mouseEntered:(NSEvent *)theEvent {
if (is_underlined)
    return;
is_underlined = YES;

//NSDictionary *attrsDictionary =   [NSDictionary dictionaryWithObject:[NSNumber numberWithInt:NSUnderlineStyleSingle] forKey:NSUnderlineStyleAttributeName];
//NSMutableAttributedString * as =  [[NSMutableAttributedString alloc] initWithString:self.event.label
                                                         //         attributes:attrsDictionary];
//[as autorelease];
NSMutableAttributedString * as = [[[self attributedStringValue] mutableCopy] autorelease];
[as beginEditing];
[as addAttribute:NSUnderlineStyleAttributeName
           value:[NSNumber numberWithInt:NSUnderlineStyleSingle]
           range:[[[self window] fieldEditor:YES forObject:self] selectedRange]];

[as endEditing];
[self setAttributedStringValue:as];
}

-(void)mouseExited:(NSEvent *)theEvent {
    if (!is_underlined)
        return;
    is_underlined = NO;
   // self.stringValue = self.event.label;
    //[self setAttributedStringValue:nil];
    NSMutableAttributedString * as = [[[self attributedStringValue] mutableCopy] autorelease];
    [as beginEditing];
    [as removeAttribute:NSUnderlineStyleAttributeName range:[[[self window] fieldEditor:YES forObject:self] selectedRange]];
   // [as addAttribute:NSUnderlineStyleAttributeName
      //         value:[NSNumber numberWithInt:0]
     //          range:[[[self window] fieldEditor:YES forObject:self] selectedRange]];

    [as endEditing];
    [self setAttributedStringValue:as];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:04:33.260

我认为我已经找到了答案——它不在于代码本身，而在于我正在构建的演示代码。作者在 drawRect 中实现了这些视图，这意味着每次绘制矩形时，都会在同一位置创建一个新的文本字段。

# string - 将 Percent-Encoded URI 字符串中的汉字转换为 UTF-8 中的汉字？

> ID：12169221
> 
> 赞同：3
> 
> 时间：2012-08-29T00:06:54.403
> 
> 标签：string, macos, utf-8, osx-snow-leopard, text-manipulation

好的，我不确定我的措辞是否正确，但我得到了以下形式的 url：

[http://zh.wikipedia.org/wiki/%E5%A4%A9%E6%96%87%E5%AD%B8](http://zh.wikipedia.org/wiki/%E5%A4%A9%E6%96%87%E5%AD%B8)

但我想把它转换成中文字符，如下所示：

[http://zh.wikipedia.org/wiki/](http://zh.wikipedia.org/wiki)天文学</p>

什么是批处理的好语言？是否有现有的函数来进行转换，或者我必须依赖字符串操作。似乎转换需要某种对查找表的调用。

我知道它们是相同的，但它们的显示方式不同。我喜欢不带 %# 的可读字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:10:56.817

在 JavaScript 中

```
alert(decodeURI("http://zh.wikipedia.org/wiki/%E5%A4%A9%E6%96%87%E5%AD%B8"))​ 
```

见[http://jsfiddle.net/rtoal/uv2Xy/](http://jsfiddle.net/rtoal/uv2Xy/)

对于其他语言，请在网上搜索“url 解码”（或 uri 解码）。

# heroku - Heroku toolbelt 命令需要应用程序名称

> ID：12169228
> 
> 赞同：45
> 
> 时间：2012-08-29T00:08:07.100
> 
> 标签：heroku, heroku-cli

从命令行登录 Heroku 时如何指定所需的应用程序？

我试图检查日志，所以当我第一次登录时，我尝试了：

```
Heroku logs 
```

这然后告诉我：

```
 !    No app specified.
 !    Run this command from an app folder or specify which app to use with --app <app name> 
```

然后我尝试了：

```
heroku --app my-appname 
```

但我得到：

```
`--app` is not a heroku command. 
```

我已经尝试了所有组合。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-08-29T00:10:19.320

您仍然需要包含以下命令：

`heroku logs --app app-name`

您也可以使用`-a`代替`--app`：

`heroku logs -a app-name`

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2015-01-24T20:49:21.283

另一种选择是将您的 (git) 项目与 Heroku 相关联。从[heroku open - 没有指定应用程序](https://stackoverflow.com/questions/12479668/heroku-open-no-app-specified)：

```
$ cd app-dir
$ heroku git:remote -a app-name
$ heroku logs 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2016-03-23T15:32:39.730

**尝试这个：**

`heroku git:remote -a [app_name]`

这应该允许您调用命令，而无需指定您希望在哪个应用程序上调用它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-27T03:17:14.450

您可以尝试`--app app-name`在句子后添加。

例子：`$ heroku domains:add your-domain --app app-name`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-19T12:16:11.650

Heroku CLI 通过扫描当前工作副本的 git 远程自动检测应用程序名称。

如果您不在应用的本地 git clone 中，则需要指定应用名称：

```
heroku logs --app app-name 
```

或者

```
heroku logs -a app-name 
```

或通过指定远程名称：

```
heroku logs --remote production 
```

您可以参考 Heroku 文档的这一部分：

[https://devcenter.heroku.com/articles/using-the-cli#app-commands](https://devcenter.heroku.com/articles/using-the-cli#app-commands)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-05T23:15:59.323

根据我的测试，Heroku CLI 将从当前的**Git*远程***推断应用程序。

所以要更改为“**测试**”应用程序：

```
git config heroku.remote test 
```

回到默认的“ **heroku** ”应用程序，这可能是你的生产应用程序：

```
git config heroku.remote heroku 
```

虽然不确定这是一个好主意......

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-11-09T11:49:31.937

对于未来的解决方案寻求者-

该错误说明了可能的解决方案。

> 从应用程序文件夹运行此命令

`cd`到应用程序目录根目录，然后运行所需的命令。

# asp.net - web api TaskScheduler.UnobservedTaskException

> ID：12169230
> 
> 赞同：2
> 
> 时间：2012-08-29T00:08:08.893
> 
> 标签：asp.net, .net, asp.net-web-api, task-parallel-library

我最近向生产网站发布了一个 asp.net web api。在大约每天一次的生产中，未处理的异常会导致网站进程循环：

> 发生未处理的异常，进程终止。应用程序 ID：/LM/W3SVC/2/ROOT/oasis 进程 ID：9236 异常：System.AggregateException 消息：等待任务或访问其异常属性未观察到任务的异常。结果，未观察到的异常被终结器线程重新抛出。StackTrace：在 System.Threading.Tasks.TaskExceptionHolder.Finalize() InnerException：System.Web.HttpException 消息：远程主机关闭了连接。错误代码为 0x800704CD。StackTrace：在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.Http.WebHost.HttpControllerHandler.EndProcessRequest(IAsyncResult 结果) 在 System.Web.HttpApplication.ExecuteStep(IExecutionStep 步骤，布尔值&

此异常似乎不是源自程序代码，而是源自 web api 内部。我需要防止这样的异常回收进程，因为这会破坏大量用户的会话。

我了解处理此异常的一种方法是使用：

```
TaskScheduler.UnobservedTaskException += (sender, e) =>
{
    McpsEventLog.PostException(e.Exception, "webapicontroller");
    e.SetObserved();
}; 
```

但是为了这个工作，我可以把这段代码放在哪里。Web api控制器中的某个地方？或在 global.asax 中。有人知道如何在 asp.net Web Api 休息服务中实现 UnobserveredTaskException 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T11:50:44.717

你是对的：未处理的异常在 Web 应用程序的上下文中是不可接受的。设置该处理程序的正确位置是`Application_Start`事件。

您还应该设置[UnhandledException-event](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)。但是，它不允许您吞下异常。只记录它。

最后，请参阅我关于此主题的问题：[如何在 ASP.NET 中处理未处理的线程异常？](https://stackoverflow.com/questions/11117167/how-to-treat-unhandled-thread-exceptions-in-asp-net)我没有得到可用的答案，但它仍然可能对您有所帮助。

# linux - Linux，重命名图像文件以创建文件的顺序列表

> ID：12169236
> 
> 赞同：2
> 
> 时间：2012-08-29T00:09:06.040
> 
> 标签：linux, file-rename

我发现很难以一种我可以搜索答案的方式来表达我的问题，我的问题如下......

我有一个网络摄像头，每 2 分钟拍摄一张照片并保存为编号文件，第一张照片是在 0000 小时拍摄的，名为 image001.jpg，在 0002 小时为 image002.jpg 等等。在 2359 小时，所有照片都转为 24 小时延时视频并保存为 daily_video.mov。在（第二天）0000 时，旧的 image001.jpg 被覆盖，整个过程重复，包括生成新的 daily_video.mov。使用网络摄像头进行文件命名和覆盖，以及每天运行一次 fffmpeg 来制作视频的 cron 作业，这一切都可以正常工作。

我现在要做的是通过将每 30 个文件从天图像复制到新文件夹并按顺序命名来制作一个月的延时视频。IE。第一天；image030.jpg、image060.jpg 等...重命名为 Archive001.jpg、Archive002.jpg 等...但在第 2 天；image030.jpg、image060.jpg 等... 将需要命名为 Archive025.jpg、Archive026.jpg 等...并重复到月底将文件从当天复制到按顺序增加的文件名称列表到在月底使用，可以重复该过程。

那有意义吗？！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T19:35:26.240

您可以使用如下所示的 bash 脚本。只需在 2359 小时致电即可。请记住使用我没有重命名为 Archive00X.jpg 使其可执行`chmod +x myScript` ，但是通过添加当前日期，它们将按正确的字母顺序排列。

示例输出：

```
cp files/image000.jpg >> archive/image_2012-08-29_000.jpg
cp files/image030.jpg >> archive/image_2012-08-29_030.jpg
.... 
```

*   使 pSource 和 pDest 适应您的路径（最好是绝对路径）
*   根据您的需要调整 offset 和 maxnum。如果 maxnum 太大，它会告诉您一些文件丢失，但其他文件可以正常工作。
*   如果它们打扰您，请移除回声线；）

代码：

```
#!/bin/bash

pSource="files"
pDest="archive"

offset=30
maxnum=721

curdate=`date "+%F"`

function rename_stuff()
{
 myvar=0
 while [ $myvar -lt $maxnum ]
 do
    forg=`printf image%03d.jpg ${myvar}`
    fnew=`printf image_%s_%03d.jpg ${curdate} ${myvar}`

    forg="$pSource/$forg"
    fnew="$pDest/$fnew"

    if [ -f "$forg" ]; then
     echo "cp $forg >> $fnew"
     cp "$forg" "$fnew"
    else
     echo "missing file $forg"
    fi

    myvar=$(( $myvar + $offset ))
done
}

rename_stuff 
```

# javascript - Ember.js 和分页

> ID：12169245
> 
> 赞同：4
> 
> 时间：2012-08-29T00:10:16.047
> 
> 标签：javascript, pagination, ember.js

所以问题是，我试图从 JSON 数据文件（大约 5000 个条目）中加载相当多的条目到表行中，我想知道处理分页的最佳方法是什么。

我知道 jPages 和其他插件，但由于我对 Ember.js 还很陌生，所以我想知道是否有一种 Ember 方法可以完成这项工作。我可以考虑传递条目的总数，手动循环渲染一个设定的数量，但我认为这对于我需要分页的其他区域来说不是很便携。

我应该研究路由吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T19:58:34.360

所以我转向创建一个看起来有点像这样的mixin

```
App.PaginationHelper = Em.Mixin.create({
    pageSize: 10,
    totalLines: 20,
    rangeStart: 1,
    rangeStop: function () {
        var rangeStop = get(this, 'rangeStart') + get(this, 'pageSize') - 1;
        totalLines = get(this, 'totalLines');
        if (rangeStop < totalLines) {
            return rangeStop;
        }
        return totalLines;
    }.property(),

    currentPage: function () {
        return get(this, 'rangeStop') / get(this, 'pageSize');
    }.property(),

    totalPages: function () {
        return Math.ceil(get(this, 'totalLines') / get(this, 'pageSize'));
    }.property(),
[...] 
```

依此类推，然后为它创建一个单独的视图，因为这样我可以重用它，甚至可以在单个页面上多次重用它，方法是创建一个具有唯一 id 的容器 div 来附加要附加到的视图的每个实例化.

所以我可以用新变量重复下一行，但通过保持 templateName 相同来重用模板。

```
var firstCaseOfPaginationViews = Em.View.create({
    templateName: 'pagination'
    [...]
});

firstCaseOfPaginationViews.appendTo('#transaction_pagination'); 
```

现在，mixin 现在可以简单地包含在我需要分页的任何控制器中。我希望这是在 Ember 中做事的正确方式，看起来这将是我将采用的方式，直到我稍后重构和重新访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:13:22.433

如果您研究路由，您可以做类似的事情（只是一个概念，不确定这是否是正确的方法）

```
App = Ember.Application.create({
        Router : Ember.Router.extend({
            root : Ember.Route.extend({
                pages : Ember.Route.extend({
                    route : '/page/:pageNo',
                    deserialize : function (router, params) {
                    var pageNumber = params.pageNo;
                    var contentToBeShown = //slice the relevant- 
                    //part from your content according to pageNo
                    <active>Controller.connectOutlet({
                        name: 'controllername',
                        outletName: 'outletshowingpages',
                        context: //theslicedarray
                        });
                    }
                    //add serialize also
                })
            })
        })
    });
App.initialize(); 
```

更多路由在这里：[https ://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/router.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/router.js)

# javascript - 如何更改与 Backbone 集合中的模型关联的几个元素的 css 属性？

> ID：12169247
> 
> 赞同：1
> 
> 时间：2012-08-29T00:10:24.280
> 
> 标签：javascript, backbone.js, coffeescript, underscore.js

会做类似的事情

```
m.set('background-color', 'green') for m in @model.collection.where(selected: true) 
```

然后也许以某种方式呈现属性？

这样的事情可能吗？

```
m.$el.css('opacity', 1) for m in @model.collection.where(selected: true) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:18:15.683

理想情况下，您应该定义一个视图并将其绑定到模型中的更改事件，以便每当模型上的属性更新时，您的视图都会相应更新，例如：

```
var myView = Backbone.View.extend({

  initialize : function() {
    myModel.bind('change', render);
  },

  render: function() {

    $("#myElement").css('opacity', myModel.isSelect ? 1 : 0)

  }

}); 
```

# c# - 性能计数器 - 似乎无法获得正确的 NextValue

> ID：12169255
> 
> 赞同：1
> 
> 时间：2012-08-29T00:11:11.227
> 
> 标签：c#, winforms, perfmon

我有一个 Windows 服务，其中有一些性能计数器。我有另一个应用程序，它监视服务正在做什么，包括性能计数器，以便在一个地方找到所有东西并可用。但是，我似乎遇到了 RateOfCountsPerSecond32 类型的性能计数器之一的问题。如果我查看 Perfmon 上的计数器，一切似乎都很好，这个特定的计数器给出了一个合理的值，但在我的监控应用程序中，计数器总是提供 0 作为它的 NextValue。

下面是我用来从给定类别中检索计数器的代码：

```
 PerformanceCounterCategory pcc = new PerformanceCounterCategory(comboBox1.SelectedItem.ToString());

        string stats = string.Empty;

        foreach (var counter in pcc.GetCounters())
        {
            stats += string.Format("{0}:\t {1} : {2}\r\n\r\n", counter.CounterName, counter.NextValue(), counter.RawValue );
        }

        lblTps.Text = stats; 
```

这似乎只是这种特殊类型的计数器的问题。

其他人能注意到这有什么问题吗？（除此之外我应该使用 StringBuilder）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:39:20.663

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.performancecounter.nextvalue.aspx)：

> 如果计数器的计算值取决于两次计数器读取，则第一次读取操作返回 0.0。

创建此类计数器后，您必须调用**NextValue()两次，因为它需要在计算第一个值之前缓冲一个样本。****对NextValue()**的后续调用将按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T15:09:12.200

这是我发现通过代码返回费率的费率计数器。无论 button2_click 中的睡眠时间如何，它都会显示一个值 4，这对于“循环”代码中的 250 毫秒延迟来说是正确的。诀窍似乎是在两个样本之间比较当前和以前的原始值。

```
 private void button2_Click(object sender, EventArgs e)
    {
        Task.Run(() => loop());

        using (PerformanceCounter pc = new PerformanceCounter("TestCounters", "RateTest", true))
        {
            CounterSample a = pc.NextSample();
            while (true)
            {               
                Application.DoEvents();
                System.Threading.Thread.Sleep(5000);
                CounterSample b = pc.NextSample();
                Single deltaTime = Convert.ToSingle(b.CounterTimeStamp / b.CounterFrequency - a.CounterTimeStamp/a.CounterFrequency);
                Single deltaRaw = Convert.ToSingle(b.RawValue - a.RawValue);
                label1.Text = (deltaRaw / deltaTime).ToString();
                b = a;
            }
        }
    }

    private void loop()
    {
        while (true)
        {
            using (PerformanceCounter pc = new PerformanceCounter("TestCounters", "RateTest", false))
            {
                pc.Increment();
            }
            System.Threading.Thread.Sleep(250);
        }
    } 
```

# mysql - 使用 SUM、WHERE、GROUP_BY 的 MySQL 子查询

> ID：12169256
> 
> 赞同：6
> 
> 时间：2012-08-29T00:11:32.807
> 
> 标签：mysql, group-by, subquery, sum, where

我是初学者（不是 DBA）。我的数据的简单版本 ==> 我希望的结果：

```
|球|颜色|计数| |球 |总蓝|总红|
-------------------- ----------------------------
|b1 |红色 | 2 | ====> |b1 | 5 | 2 |  
|b1 |蓝色 | 3 | |b2 | 3 | 1 |  
|b1 |蓝色 | 2 |           
|b2 |红色 | 1 |             
|b2 |蓝色 | 3 |     
```

我想将每个球（b1、b2 等）制成表格。然后是每个球的每种颜色的总实例。每个球的每种颜色都有多个条目（在我的真实世界数据中）。但在这里我只显示蓝色#1-balls 的多个条目。

我可以很容易地做到这一点：

```
SELECT ball, 
SUM(count) AS 'Total Blue'
FROM t1
WHERE color = 'blue'
GROUP BY ball 
```

要获得第一个（好的）结果：

```
|球 |总蓝|
 -----------------
|b1 | 5 |  
|b2 | 3 |
```

为了更进一步，我想我需要一个子查询。但我无法让子查询以与常规查询相同的方式处理。

以下是迄今为止我得到的最接近的结果（简单尝试）：

```
SELECT ball, 
SUM(count) AS 'Total Blue',
(SELECT SUM(count) FROM t1 WHERE color = 'red') AS 'Total Red'
FROM t1 
WHERE color = 'blue'
GROUP BY ball 
```

我明白了：

```
|球 |总蓝| 总红|
 --------------------------
|b1 | 5 | 3 |
|b2 | 3 | 3 |
```

Total Red 显示所有红球的总数，无论球数如何。

这个更复杂的子查询（红色）产生完全相同的结果：

```
(SELECT SUM(cc) FROM 
(SELECT DISTINCT count AS cc FROM t1  WHERE color = 'red') AS dd )
AS 'Total Red' 
```

我已将 GROUP BY 添加到此子查询中，但没有增加效果。这是我所能得到的最接近的。许多其他尝试已经给出了各种各样的结果。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-29T00:14:56.563

尝试结合 SUM 和 IF：

```
 SELECT
    ball, 
    SUM(IF(color = 'blue', count, 0)) AS 'Total Blue'
    SUM(IF(color = 'red', count, 0)) AS 'Total Red'
 FROM t1
 GROUP BY ball 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T01:11:07.297

我只想提供以下内容，因为 CASE 是标准 SQL 而 IF 不是：

```
select ball,
       sum(case when color = 'blue' then `count` else 0 end) as TotalBlue,
       sum(case when color = 'red' then `count` else 0 end) as TotalRed
from t
group by ball
order by 1 
```

此外，将“count”作为列名是一个坏主意，因为它是 SQL 保留字。

# c# - 在c#中使用线程接收数据包

> ID：12169257
> 
> 赞同：1
> 
> 时间：2012-08-29T00:11:38.453
> 
> 标签：c#, java, multithreading, unity3d

我正在关注一个 Java 示例，该示例使用 Completion Service 向通过调用接收数据包的 3rd 方应用程序提交查询：

```
completionService.submit(new FetchData()); 
```

然后它调用：

```
Future<Data> future  = completionService.take();
Data data = future.get(timeout, TimeUnit.MILLISECONDS); 
```

它等待提交的任务之一完成并返回数据。这两个调用在一个`while(true)`循环中。

我正在用 c# 开发一个应用程序，我想知道这是否是等待数据包的正确方法，以及我如何在 c# 中做到这一点。

我已经尝试过了，但我不确定我是否做得对：

```
new Thread(delegate() {
  Dictionary<ManualResetEvent, FetchData> dataDict = new Dictionary<ManualResetEvent, FetchData>();

  ManualResetEvent[] doneEvents;
  ManualResetEvent doneEvent;
  FetchData fetch;
  int index;

  while(true) {             
    // Create new fetch
    doneEvent = new ManualResetEvent(false);
    fetch = new FetchData(this, doneEvent);

    // event -> fetch association
    dataDict.Add(doneEvent, fetch);

    ThreadPool.QueueUserWorkItem(fetch.DoWork);

    doneEvents = new ManualResetEvent[dataDict.Count];
    dataDict.Keys.CopyTo(doneEvents, 0);

    // wait for any of them to finish
    index = WaitHandle.WaitAny(doneEvents, receiveThreadTimeout);

    // did we timeout?
    if (index == WaitHandle.WaitTimeout) {
      continue;
    }

    // grab done event
    doneEvent = doneEvents[index];
    // grab fetch
    fetch = dataDict[doneEvent];

    // remove from dict
    dataDict.Remove(doneEvent);

    // process data
    processData(fetch.GetData());               
  }

}).Start(); 
```

编辑：最后一点，我在使用 Mono 2.6 且仅限于 .NET 2.0 的 Unity 中使用它

编辑2：我改变了一些代码。我意识到 ThreadPool 有它自己的最大限制，如果没有剩余线程，它会将任务排队，所以我从我的代码中删除了该逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T01:16:29.823

事实证明，我只需要一个线程来监听数据包，因此我不必像上面的示例那样使用线程池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T21:02:53.833

您真的需要在 Unity3D 应用程序中使用多线程吗？我问这个是因为 Unity“不是”多线程的：有一种方法可以处理线程，但你最好依靠*协程*来做到这一点。请参阅[此文档](http://docs.unity3d.com/Documentation/ScriptReference/index.Coroutines_26_Yield.html)以了解有关协程的更多信息。

注意：如果您使用 Unity 3.5，它使用支持 .NET 4.0 几乎所有内容的 Mono 2.6.5。我不知道这个`Task`类，但它肯定涵盖了 .NET 3.0。

# python - 我应该在 Python 中为 Tkinter 使用 Entry 的 .get() 或其文本变量吗？

> ID：12169258
> 
> 赞同：3
> 
> 时间：2012-08-29T00:11:38.580
> 
> 标签：python, tkinter

代码类似于：

```
myVar = StringVar()
myEntry = Entry(master, textvariable=myVar) 
```

所以当我需要从中检索输入时`myEntry`，我应该使用

```
myText = myVar.get() 
```

或者

```
myText = myEntry.get() 
```

有没有更好的办法 ？（为什么？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T02:17:20.470

除非您在 StringVars 上进行跟踪，否则我会说坚持使用该`get`方法并且不要创建 StringVars。使用该`get`方法消除了复杂性——需要维护的对象减少了，占用内存空间的对象也减少了（乘以您在应用程序中使用 StringVars 的次数）。

当然，这是一个难以察觉的开销，但在所有条件相同的情况下，不太复杂的解决方案通常是最好的。为什么要添加一个变量，让您可以在没有该变量的情况下执行您已经可以执行的操作？

# python - 通过无线网络使用 Bottle.py

> ID：12169261
> 
> 赞同：0
> 
> 时间：2012-08-29T00:12:07.077
> 
> 标签：python, ctypes, wireless, host, bottle

我想`bottle.py`通过无线网络使用。不幸的是，我不知道如何进行设置。我想通过无线网络执行的代码（从另一台计算机执行）是：

```
import ctypes
from bottle import get, post, request, run

@get('/control')
def message():
    return '''<form method='POST' action='/control'>
        <input name='message'   type='text'/>
        <input type='submit'/>
        </form>'''

@post('/control')
def send():
    Message  =request.forms.get('message')
    MessageBox = ctypes.windll.user32.MessageBoxA
    MessageBox(None,Message,'MESSAGE', 0)

run(host=127.0.0.1, port=8090) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:11:58.530

并回答问题 - 你确定你只想绑定它@ 127？我的意思是 - 127.0... 是 localhost... 尝试 0.0.0.0 或 IP

# php - Magento。安装脚本不会运行，更不用说创建客户属性了

> ID：12169263
> 
> 赞同：2
> 
> 时间：2012-08-29T00:12:09.060
> 
> 标签：php, magento, entity-attribute-value, installscript

一直在这个问题上敲了8个小时...

我需要（或者更确切地说，我的公司确实是 B2B）在客户注册时请求额外的属性。当然，Magento 本身并没有这样做，所以我们被迫沿着极其**复杂**的构建路径来实现它。我买了一个模块来做这件事，但发现代码很乱（更不用说根本不工作）。

任何。我想我会自己动手。

所以我找到了一个看似清晰且切中要害的[教程](http://www.echotrue.com/articles/adding-customer-attributes-and-displaying-them-in-the-magento-admin)。所以我，花几分钟把它放在一起。没事了。

进一步的 google-fu 将我带到[这里](https://stackoverflow.com/questions/5961290/adding-attributes-to-customer-entity/5962237#5962237)和[这里](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-6-magento-setup-resources)以获得额外的热智慧酱。

**这是我所拥有的**（运行 Magento Professional v1.11 ）：

文件结构：

```
 WACI
    - Customer
    -- etc
    --- config.xml
    -- Model
    --- Resource
    ---- Eav
    ----- Mysql4
    ------ Setup.php
    -- sql
    --- customer_setup
    ---- mysql4-install-0.1.0.php 
```

**等/模块/WACI_All.xml**

```
<config>
    <modules>
        <WACI_Customer>
            <active>true</active>
            <codePool>local</codePool>
        </WACI_Customer>
    </modules>
</config> 
```

**配置文件**

```
<config>

    <modules>
        <WACI_Customer>
            <version>0.1.0</version>
        </WACI_Customer>
    </modules>

    <global>

        <fieldsets>
            <customer_account>
                <title><create>1</create><update>1</update></title>
                <phone><create>1</create><update>1</update></phone>
                <agency><create>1</create><update>1</update></agency>
                <fed_id><create>1</create><update>1</update></fed_id>
                <ubi><create>1</create><update>1</update></ubi>
            </customer_account>
        </fieldsets>

        <!--<models>
            <customer>
                <class>WACI_Customer_Model</class>
            </customer>
        </models> -->

        <resources>
            <customer_setup>
                <setup>
                    <module>WACI_Customer</module>
                    <class>WACI_Customer_Model_Resource_Eav_Mysql4_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </customer_setup>
            <customer_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </customer_write>
            <customer_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </customer_read>
        </resources>

    </global>
</config> 
```

**安装程序.php**

```
<?php

    class WACI_Customer_Model_Resource_Eav_Mysql4_Setup extends Mage_Eav_Model_Entity_Setup
    {
        public function getDefaultEntities()
        {
            return array(
                    'customer' => array(
                        'entity_model'          => 'customer/customer',
                        'table'                 => 'customer/entity',
                        'increment_model'       => 'eav/entity_increment_numeric',
                        'increment_per_store'   => false,
                        'attribute_model'       => 'customer/attribute', 
                        'attributes' => array(
                            'title' => array(
                                'type'          => 'varchar',
                                'input'         => 'text',
                                'label'         => 'Title / Position',
                                'visible'       => true,
                                'required'      => false,
                                'position'      => 63,
                            ),
                            'phone' => array(
                                'type'          => 'varchar',
                                'input'         => 'text',
                                'label'         => 'Telephone',
                                'visible'       => true,
                                'required'      => true,
                                'position'      => 64,
                            ),
                            'agency' => array(
                                'type'          => 'varchar',
                                'input'         => 'text',
                                'label'         => 'Agency / Organization',
                                'visible'       => true,
                                'required'      => false,
                                'position'      => 65,
                            ),
                            'fed_id' => array(
                                'type'          => 'varchar',
                                'input'         => 'text',
                                'label'         => 'Fed ID',
                                'visible'       => true,
                                'required'      => false,
                                'position'      => 66,
                            ),
                            'ubi' => array(
                                'type'          => 'varchar',
                                'input'         => 'text',
                                'label'         => 'UBI',
                                'visible'       => true,
                                'required'      => false,
                                'position'      => 67,
                            ),
                        ),
                    ),
                );
        }
    }

    ?> 
```

**mysql4-install-0.1.0.php**

```
<?php

Mage::log('Installing WACI_Customer');

// die ( echo 'Running This Upgrade: '.get_class($this)."\n <br /> \n";   );

$installer = $this;
$installer->installEntities();

$eavConfig          = Mage::getSingleton(‘eav/config’);
$attribute_title    = $eavConfig->getAttribute(‘customer’, 'title');
$attribute_phone    = $eavConfig->getAttribute(‘customer’, 'phone');
$attribute_agency   = $eavConfig->getAttribute(‘customer’, 'agency');
$attribute_fedid    = $eavConfig->getAttribute(‘customer’, 'fed_id');
$attribute_ubi      = $eavConfig->getAttribute(‘customer’, 'ubi');

// put into customer_form_attribute table so field will show in admin.
$attribute_title->setData(‘used_in_forms’, array(‘adminhtml_customer’));
$attribute_phone->setData(‘used_in_forms’, array(‘adminhtml_customer’));
$attribute_agency->setData(‘used_in_forms’, array(‘adminhtml_customer’));
$attribute_fedid->setData(‘used_in_forms’, array(‘adminhtml_customer’));
$attribute_ubi->setData(‘used_in_forms’, array(‘adminhtml_customer’));

?> 
```

假设我理解正确，我已经准备好了一切......但是什么都没有，什么都没有，甚至什么都没有。

尤其：

*   如果我删除安装类，我会收到一个致命错误，所以我认为一切都准备好了。
*   该模块显示在 admin/system/configuration/advanced/（已启用）中；它被写入`core_config_data`
*   我删除了所有代码，只使用了空容器（带有调试内容）——安装脚本永远不会运行；它永远不会被写入`core_resource`

问题，然后是两个部分：

**1\. 是什么阻止了我的安装脚本运行？**
**2\. 创建新客户属性的逻辑是否合理？**

假设是 - 我认为将它放到注册页面/客户帐户/管理员帐户应该相当简单......

......现在要去喝啤酒了。

干杯。

## 更新

* * *

正如@AlexeiYerofeyev 所想，`customer`名称本身就是问题所在。更改为 CustomerAttr，脚本立即运行。

然后该模块按预期运行，但@benmarks 的解决方案似乎更干净，所以我重写以匹配：

**配置.xml** 0.1.0

```
 <global>
        <resources>
            <customerattr_setup>
                <setup>
                    <module>WACI_CustomerAttr</module>
                    <class>Mage_Customer_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </customerattr_setup>
        </resources>
        <fieldsets>
            <customer_account>
                <title><create>1</create><update>1</update></title>
                <phone><create>1</create><update>1</update></phone>
                <agency><create>1</create><update>1</update></agency>
                <fed_id><create>1</create><update>1</update></fed_id>
                <ubi><create>1</create><update>1</update></ubi>
            </customer_account>
        </fieldsets>
    </global>
</config> 
```

**安装程序.php**

```
<?php

    Mage::log('Installing WACI_CustomerAttr');

    echo 'Running Upgrade: '.get_class($this)."\n <br /> \n"; 

    //die ( 'its running' );

    $installer = $this;
    /* @var $installer Mage_Customer_Model_Entity_Setup */

    $installer->startSetup();

    $installer->addAttribute('customer','agency',
                array(
                    'type'          => 'varchar',
                    'label'         => 'Agency / Organization',
                    'input'         => 'text',
                    'required'      => false,
                    'visible'       => true,
                    'position'      => 62,
                )
            );

    $installer->addAttribute('customer','title',
                array(
                    'type'          => 'varchar',
                    'label'         => 'Title / Position',
                    'input'         => 'text',
                    'required'      => false,
                    'visible'       => true,
                    'position'      => 63,
                )
            );

    $installer->addAttribute('customer','phone',
                array(
                    'type'          => 'varchar',
                    'label'         => 'Telephone',
                    'input'         => 'text',
                    'required'      => false,
                    'visible'       => true,
                    'position'      => 64,
                )
            );

    $installer->addAttribute('customer','fed_id',
                array(
                    'type'          => 'varchar',
                    'label'         => 'Fed ID',
                    'input'         => 'text',
                    'required'      => false,
                    'visible'       => true,
                    'position'      => 65,
                )
            );

    $installer->addAttribute('customer','ubi',
                array(
                    'type'          => 'varchar',
                    'label'         => 'UBI',
                    'input'         => 'text',
                    'required'      => false,
                    'visible'       => true,
                    'position'      => 66,
                )
            );

    $attrs = array('agency','title','phone','fed_id','ubi');

    foreach ($attrs as $item) {
        $attr = Mage::getSingleton('eav/config')->getAttribute('customer', $item);
        $attr->setIsUsedInForms(array('adminhtml_customer','customer_account_edit','customer_account_create'))->save();
    }

    $installer->endSetup();

    ?> 
```

模块（和版本）成功写入`core_resource`，并且属性成功添加到`eav_attribute`。

我可以打电话给现场

**主题/模板/客户/表单/edit.phtml**

```
<div class="input-box">
    <label for="agency"><?php echo $this->__('Agency / Organization') ?><span class="required">*</span></label><br />
    <input type="text" name="agency" id="agency" value="<?php echo $this->htmlEscape($this->getCustomer()->getAgency()) ?>" title="<?php echo $this->__('Agency') ?>" class="required-entry input-text" />
</div> 
```

但是，不幸的是，该值没有被写入`customer_entity_varchar`（最终，我的初始脚本也是如此。

**所以，我在表中得到了属性，但它还没有被添加到客户实体中。**

似乎一旦我开始工作，我应该能够在任何需要的地方随意读取和写入该值。

关于我现在如何进行的任何想法？

### 最终更新

* * *

好的，解决了这个问题：

```
$attr->setData('used_in_forms', array('adminhtml_customer','customer_account_edit','customer_account_create'))->save(); 
```

代替

```
$attr->setIsUsedInForms(array('adminhtml_customer','customer_account_edit','customer_account_create'))->save(); 
```

对于任何可能需要信息的人...

原来数组没有`customer_form_attribute`使用先前的代码在表中更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T08:33:20.873

您的安装脚本可能由于其设置资源名称 (customer_setup) 而无法运行。由于核心扩展 Mage_Customer 具有相同的安装资源名称，并且它已经安装在 core_resource 表中，版本为 1.6.2.0 或类似的版本，因此您的版本为 0.1.0 的安装脚本可能被认为太旧而被忽略。因此，您可以尝试将资源重命名为独特的名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:51:49.660

除非我错过了什么：

在您的安装脚本中，要安装这些属性，您应该只使用`customer/setup`该类`Mage_Customer_Model_Resource_Setup`并调用`addAttribute()`您的每个属性配置，（不幸的是）跟进表单设置逻辑。

```
<?php

$installer = Mage::getResourceModel('customer/setup', 'default_setup');
/* @var $installer Mage_Customer_Model_Resource_Setup */

$installer->startSetup();

$installer->addAttribute(
    'customer',
    'title',
    array(
        'type'          => 'varchar',
        'input'         => 'text',
        'label'         => 'Title / Position',
        'visible'       => true,
        'required'      => false,
        'position'      => 63,
    )
);

/**
  the same for others, then individually or in loop:
 */
$attr = Mage::getSingleton('eav/config')->getAttribute('customer_address', 'title');
$attr->setIsUsedInForms(array('adminhtml_customer'))->save();

//NB: that save() call is fairly important ;-)

$installer->endSetup(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T10:09:50.667

如果您不时不提高版本号，我不知道 Magento 是否真正正确地运行设置脚本。

考虑将您的模块弹出一个版本并使用升级脚本。在更新脚本中放一个简单的 Mage::log ，你会看到它是否真的被调用了。

该版本位于 app/etc/module/blah_Blah.xml 和 etc/config.xml 中，并且 core_Config 中的条目说明了它认为的内容。

也许只是在原始安装程序中设置表，然后在升级脚本中插入数据。

Alan 的文章提供了有关升级脚本的所有内容：http: [//www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-6-magento-setup-resources](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-6-magento-setup-resources)

# windows-phone-7 - 仅在纵向模式下显示 AdControl

> ID：12169264
> 
> 赞同：0
> 
> 时间：2012-08-29T00:12:15.983
> 
> 标签：windows-phone-7, ads

当手机处于横向模式时，我的应用程序中没有足够的屏幕空间来显示 AdControl。我在我的`OnOrientationChanged`事件处理程序中使用以下（简化）代码在进入横向模式时从网格的第 1 行删除 AdControl，并在进入纵向模式时将其添加回来：

```
if (this.Orientation == PageOrientation.LandscapeLeft || 
    this.Orientation == PageOrientation.LandscapeRight) {
    LayoutRoot.Children.Remove(myAdControl);
    LayoutRoot.RowDefinitions.RemoveAt(1);// remove row to make space
} else {
    LayoutRoot.RowDefinitions.Add(adRow);// previously constructed 80 px high RowDefinition
    LayoutRoot.Children.Add(myAdControl);
    Grid.SetRow(myAdControl, 1);
} 
```

这似乎在我的测试中有效，但我在 AdControl 类的[文档](http://msdn.microsoft.com/en-us/library/advertising-mobile-windows-phone-adcontrol-silverlight-class%28v=msads.20%29)中看到“一旦设置，不应更改 AdControl 的父级”。我在这里所做的会破坏 AdControl 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-28T07:51:26.930

[这是一个新的解决方案](http://www.visuallylocated.com/post/2013/10/28/Keeping-ads-in-the-same-location-when-the-phone-orientation-changes-to-landscape.aspx)，当手机方向更改为横向时，允许广告控件保持静止。它使用了一个新控件，即使在旋转时（横向时向左或向右），广告控件也能保持在“底部”。

10 秒的概述是创建一个网格布局并将 AdControl 移动到适用于方向的行/列组合。[该博客](http://www.visuallylocated.com/post/2013/10/28/Keeping-ads-in-the-same-location-when-the-phone-orientation-changes-to-landscape.aspx)包含所有详细信息。

# macos - 使用 mdfind 搜索文件的 Bash Shell 脚本

> ID：12169265
> 
> 赞同：3
> 
> 时间：2012-08-29T00:12:53.960
> 
> 标签：macos, bash, spotlight, ln

我有一个包含大约 350 张图像的文件夹（它们是扫描的食谱）。为了更容易找到它们，我用 bash shell 脚本编写了一个搜索程序。我在 Mac OS X 10.8 Mountain Lion 上有 bash 版本 3.2。

我的程序的基本思想：

1.  向用户询问搜索词（使用 osascript）。
2.  使用 mdfind 在文件（名称）中搜索搜索词。
3.  将匹配的文件发送到 ln（通过 xargs）。
4.  在“结果”目录中创建匹配文件的硬链接。此目录包含在同一图像文件夹中（此目录在程序开始时被清理）。

目录的样子：

```
+Recipes
  -files
  -files
  -files
  +.search
     -search (shell script)
     +results
        -links
        -links 
```

这是我的代码：

```
#!/bin/bash
#
# Search program for recipes.
# version 2

# Clean out results folder
rm -rf ~/Google\ Drive/Recipes/.search/results/*

# Display the search dialog
query=$(osascript <<-EOF
        set front_app to (path to frontmost application as Unicode text)
        tell application front_app to get text returned of (display dialog "Search     for:" default answer "" with title "Recipe Search")
EOF)

# If query is empty (nothing was typed), exit
if [ "$query" = "" ]
then
    exit
fi

echo "Searching for \"$query\"."

# Search for query and (hard) link. The output from 'ln -v' is stored in results
# 'ln' complains if you search for the same thing twice... mdfind database lagging?
results=$(mdfind -0 -onlyin ~/Google\ Drive/Recipes/ "$query" | xargs -0 -J % ln -fv % ~/Google\ Drive/Recipes/.search/results)

if [ "$results" ]
then
    # Results were found, open the folder
    open ~/Google\ Drive/Recipes/.search/results/
else
    # No results found, display a dialog
    osascript <<-EOF
        beep
        set front_app to (path to frontmost application as Unicode text)
        tell application front_app to display dialog "No results found for \"" & "$query" & "\"." buttons "Close" default button 1 with icon 0
    EOF
fi 
```

它工作得很好——第一次。如果你搜索相同的东西两次，它就会中断。

**解释：**假设我搜索“鸡”。34 个文件匹配，并在结果目录中建立硬链接。

现在，我再次运行程序，并搜索相同的东西——“鸡”。目录被清空（按`rm`）。但是现在，查找/链接停止工作——只有 6 或 7 个食谱将被链接。似乎正在发生的事情是`mdfind`在搜索目录中找到结果，*在它们被删除之后*，然后`ln`无法建立链接。但它没有找到主要文件......我明白了

```
ln: ~/Google Drive/Recipes/.search/results/recipe.jpg: no such file or directory 
```

我查看了[用于创建符号链接的 mdfind 未按预期工作](https://stackoverflow.com/questions/1930437/mdfind-used-for-creating-symlinks-not-working-as-expected)；他们有类似的问题（但没有帮助）。

感谢您的*帮助*...这一直困扰着我很长时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T04:40:35.323

您可以使用 重新索引目录或文件`mdimport`。

```
$ touch aa
$ mdfind -onlyin . -name aa
/Users/lauri/Desktop/aa
$ rm aa
$ mdimport .
$ mdfind -onlyin . -name aa
$ 
```

Spotlight 不会索引以句点开头的目录，因此您可以重命名该`.search`目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T03:08:49.690

Spotlight 命令使用文件内容的缓存索引。我不知道有什么方法可以强迫`mdfind`不这样做。蛮力方法是`mdutil -E`在删除文件后清除缓存，但您可能不想这样做。

# c++ - OpenGL3显示错误的纹理

> ID：12169266
> 
> 赞同：2
> 
> 时间：2012-08-29T00:13:31.340
> 
> 标签：c++, opengl, sfml, opengl-3

我正在尝试向我的程序添加第二个 sampler2DRect 纹理。我为第二个纹理使用单独的着色器文件，否则我使用与显示第一个纹理相同的代码。但是，当我尝试显示第二个纹理时，它显示的是第一个，我似乎无法弄清楚为什么。我可能做错了一个 API 调用，或者可能遗漏了一些重要的东西，但我没有尝试解决这个问题。

没有报告 GL 错误，并且 gDEBugger 没有显示任何可疑内容。

我想问题可能出在我的代码中的其他地方，但这是我用来尝试绘制第二个纹理的部分（这几乎与用于绘制第一个纹理的代码相同）：

```
Test_World_Pause_Menu::Test_World_Pause_Menu(int resolution_width, int resolution_height)
    : _shaders("shaders/pause_menu.vert", "shaders/pause_menu.frag"),
      _vao_id( new GLuint[1] ),
      _mvp_id( new GLint[1] ),
      _pm_tex_id( new GLuint[1] ),
      _mvp( glm::ortho(0.0f, (GLfloat)resolution_width, 0.0f, (GLfloat)resolution_height, -1.0f, 1.0f) ),
      _pm_vertices_buffer( new GLuint[1] ),
      _pm_vertices( new GLfloat[12] ),
      _pm_colors_buffer( new GLuint[1] ),
      _pm_colors( new GLfloat[16] ),
      _pm_tex_coords_buffer( new GLuint[1] ),
      _pm_tex_coords( new GLfloat[8] ),
      _pm_normals_buffer( new GLuint[1] ),
      _pm_normals( new GLfloat[12] )
{
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);  // set alpha blending mode

    // begin pause menu initialization
    _pm_image.loadFromFile("resources/levels/test_00/pause_menu/pause_menu.png");
    _pm_image.flipVertically();

    unsigned int pm_location_x = 0;
    unsigned int pm_location_y = _pm_image.getSize().y;
    unsigned int pm_width = _pm_image.getSize().x;
    unsigned int pm_height = _pm_image.getSize().y;

    _pm_vertices[0] = pm_location_x; _pm_vertices[1] = pm_location_y; _pm_vertices[2] = 0.0f;
    _pm_vertices[3] = pm_location_x; _pm_vertices[4] = pm_location_y - pm_height; _pm_vertices[5] = 0.0f;
    _pm_vertices[6] = pm_location_x + pm_width; _pm_vertices[7] = pm_location_y - pm_height; _pm_vertices[8] = 0.0f;
    _pm_vertices[9] = pm_location_x + pm_width; _pm_vertices[10] = pm_location_y; _pm_vertices[11] = 0.0f;

    _pm_colors[0] = 1.0f; _pm_colors[1] = 1.0f; _pm_colors[2] = 1.0f; _pm_colors[3] = 0.0f;
    _pm_colors[4] = 1.0f; _pm_colors[5] = 1.0f; _pm_colors[6] = 1.0f; _pm_colors[7] = 0.0f;
    _pm_colors[8] = 1.0f; _pm_colors[9] = 1.0f; _pm_colors[10] = 1.0f; _pm_colors[11] = 0.0f;
    _pm_colors[12] = 1.0f; _pm_colors[13] = 1.0f; _pm_colors[14] = 1.0f; _pm_colors[15] = 0.0f;

    _pm_tex_coords[0] = 0.0f; _pm_tex_coords[1] = pm_height;
    _pm_tex_coords[2] = 0.0f; _pm_tex_coords[3] = 0.0f;
    _pm_tex_coords[4] = pm_width; _pm_tex_coords[5] = 0.0f;
    _pm_tex_coords[6] = pm_width; _pm_tex_coords[7] = pm_height;

    _pm_normals[0] = 0.0f; _pm_normals[1] = 0.0f; _pm_normals[2] = 0.0f;
    _pm_normals[3] = 0.0f; _pm_normals[4] = 0.0f; _pm_normals[5] = 0.0f;
    _pm_normals[6] = 0.0f; _pm_normals[7] = 0.0f; _pm_normals[8] = 0.0f;
    _pm_normals[9] = 0.0f; _pm_normals[10] = 0.0f; _pm_normals[11] = 0.0f;

    glGenVertexArrays(1, &_vao_id[0]); // generate VAO
    glBindVertexArray(_vao_id[0]);     // bind VAO

    // vertices
    glEnableVertexAttribArray((GLuint)0);
    glGenBuffers(1, &_pm_vertices_buffer[0]);
    glBindBuffer(GL_ARRAY_BUFFER, _pm_vertices_buffer[0]);
    glBufferData(GL_ARRAY_BUFFER, 12 * sizeof(GLfloat), _pm_vertices.get(), GL_STATIC_DRAW);
    glVertexAttribPointer((GLuint)0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glEnableVertexAttribArray(0);

    // normals (inexplicably needed even though it won't be used in the shaders)
    glEnableVertexAttribArray((GLuint)1);
    glGenBuffers(1, &_pm_normals_buffer[0]);
    glBindBuffer(GL_ARRAY_BUFFER, _pm_normals_buffer[0]);
    glBufferData(GL_ARRAY_BUFFER, 12 * sizeof(GLfloat), _pm_normals.get(), GL_STATIC_DRAW);
    glVertexAttribPointer((GLuint)1, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glEnableVertexAttribArray(0);

    // texture
    glEnableVertexAttribArray((GLuint)2);
    glGenBuffers(1, &_pm_tex_coords_buffer[0]);
    glBindBuffer(GL_ARRAY_BUFFER, _pm_tex_coords_buffer[0]);
    glBufferData(GL_ARRAY_BUFFER, 8 * sizeof(GLfloat), _pm_tex_coords.get(), GL_STATIC_DRAW);
    glVertexAttribPointer((GLuint)2, 2, GL_FLOAT, GL_FALSE, 0, 0);
    glBindBuffer(GL_ARRAY_BUFFER, 0);

    glGenTextures(1, &_pm_tex_id[0]);
    glBindTexture(GL_TEXTURE_RECTANGLE, _pm_tex_id[0]);

    glTexParameteri(GL_TEXTURE_RECTANGLE, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
    glTexParameteri(GL_TEXTURE_RECTANGLE, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
    glTexParameteri(GL_TEXTURE_RECTANGLE, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
    glTexParameteri(GL_TEXTURE_RECTANGLE, GL_TEXTURE_MAG_FILTER, GL_NEAREST);

    glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
    glTexImage2D(GL_TEXTURE_RECTANGLE, 0, GL_RGBA, pm_width, pm_height,
            0, GL_RGBA, GL_UNSIGNED_BYTE, _pm_image.getPixelsPtr());

    glEnableVertexAttribArray(0);

    // colors
    glEnableVertexAttribArray((GLuint)3);
    glGenBuffers(1, &_pm_colors_buffer[0]);
    glBindBuffer(GL_ARRAY_BUFFER, _pm_colors_buffer[0]);
    glBufferData(GL_ARRAY_BUFFER, 16 * sizeof(GLfloat), _pm_colors.get(), GL_STATIC_DRAW);
    glVertexAttribPointer((GLuint)3, 4, GL_FLOAT, GL_FALSE, 0, 0);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glEnableVertexAttribArray(0);

    // unbind buffers
    glBindVertexArray(0);

    _mvp_id[0] = glGetUniformLocation(_shaders.id(), "mvpMatrix");
    _pm_tex_id[0] = glGetUniformLocation(_shaders.id(), "pauseMenuTex");
// end pause menu initialization
}

void Test_World_Pause_Menu::display()
{
    glEnable(GL_BLEND);
    glDisable(GL_DEPTH_TEST);

    _shaders.bind();

        glUniformMatrix4fv(_mvp_id[0], 1, GL_FALSE, &_mvp[0][0]);

// begin pause menu rendering
        glUniform1i(_pm_tex_id[0], 0);

        glActiveTexture(GL_TEXTURE0);
        glBindTexture(GL_TEXTURE_2D, _pm_tex_id[0]);

        glBindVertexArray(_vao_id[0]);     // bind the VAO

        // draw the contents of the bound VAO
        glDrawArrays(GL_TRIANGLE_FAN, 0, 4);

        glBindVertexArray(0); // unbind the VAO
// end pause menu rendering

    _shaders.unbind();

    glDisable(GL_BLEND);
    glEnable(GL_DEPTH_TEST);

    return;
} 
```

这是我为此使用的着色器：

顶点着色器

```
#version 150

in vec4 in_Position;
in vec3 in_Normal;
in vec2 in_UV;
in vec4 in_Color;

uniform mat4 mvpMatrix;

smooth out vec3 vVaryingNormal;
smooth out vec2 vVaryingTexCoord;
smooth out vec4 vVaryingColor;

void main(void) 
{
    vVaryingNormal = in_Normal;
    vVaryingTexCoord = in_UV;
    vVaryingColor = in_Color;

    gl_Position = mvpMatrix * in_Position;
} 
```

片段着色器

```
#version 150

smooth in vec3 vVaryingNormal;
smooth in vec2 vVaryingTexCoord;
smooth in vec4 vVaryingColor;

uniform sampler2DRect pauseMenuTex;

out vec4 out_Color;

void main(void)
{ 
    out_Color.a = vVaryingColor.a;
    out_Color += texture(pauseMenuTex, vVaryingTexCoord);
} 
```

我的猜测是我没有正确关闭此处某处的某些纹理状态，但就像我说的那样，我没有尝试解决问题。如有必要，我可以发布程序其他部分的代码。

**编辑：**在这个 C++ 代码以及第一个纹理的代码中，API 的使用肯定有一些错误，因为当我删除第一个纹理的初始化和渲染函数时，第二个显示得很好。有人可以帮我查明我不正确的 OpenGL 用法（它可能在构造函数中）。

**另一个编辑：**经过进一步调查，我发现首先运行两个对象的构造函数中的任何一个都是在两个显示例程中显示纹理的那个。

**第三次编辑：**可能相关的内容：在构造函数中调用 glTexImage2D() 后，使用 glBindTexture(GL_TEXTURE_RECTANGLE, 0) 取消绑定第一个纹理，导致它在两个显示例程中的任何一个中都不显示。对我来说，这似乎是一个问题，并且可能与我的其他问题有关。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T11:48:29.627

你的问题就在这里：

```
glGenTextures(1, &_pm_tex_id[0]);
...
_pm_tex_id[0] = glGetUniformLocation(_shaders.id(), "pauseMenuTex"); 
```

第一条语句创建一个纹理对象并将其存储到`_pm_tex_id[0]`. 下一条语句用*统一的位置**覆盖*纹理对象。因此，您*丢失*了纹理对象。这与调用获取指针，然后再覆盖该指针没有什么不同；你不能把它拿回来。**`new`**

 **您的代码在[修改后的解决方案](https://stackoverflow.com/a/12170425/734069)中“工作”的原因是因为您*将*其绑定到上下文（在不同的插槽中）。您绑定它以用数据填充它，但您永远不会取消绑定它。因此，上下文仍然具有您丢失的纹理对象。

您需要将纹理名称和采样器统一位置*分开*存储。您应该使用比“id”更好的命名约定；统一位置不应具有与 OpenGL 对象名称相同的命名约定。这样，您就不会混淆它们。我建议制服使用“unif”而不是“id”。

* * *

其他没有错的东西，只是不一定有用。

您经常致电：

```
glEnableVertexAttribArray(0); 
```

没原因。您不能使属性 0比第一次启用时*更启用；）*

您还分配了很多 1 项的数组。这*真的是*不必要的。如果您只想要一个 VAO，只需创建一个`GLuint`变量。当您需要生成它时，只需获取它的地址即可。

另外，停止分配这么多的内存周期。如果您需要一个数组，请使用 a `std::vector`（您可以以与当前完全相同的方式获取指向该数组的指针：）`&vec[0]`。这样，您就不必记得删除内存了；当对象被销毁时，C++ 会为你做这件事。您已经在使用 C++，因此您不妨实际使用该语言。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:44:17.887

我看到一个绑定到 GL_TEXTURE_RECTANGLE，然后绑定到 GL_TEXTURE_2D。这些应该是一样的吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T04:04:38.390

首先，我没有足够的声誉来发表评论，我不想编辑你的问题，因为我要说的话，如果这不起作用，请提前道歉。

您的解决方案（或解决方法）为每个纹理提供了自己的纹理槽，除非您想将多个纹理传递给同一个着色器，否则这不是必需的，因此肯定会发生冲突。

您可以`glUniform1i(_pm_tex_id[0], x);`从渲染过程中删除并将其放入构造函数中，因为它只需在（重新）创建着色器程序后设置一次。

在蒂姆发现不同的绑定调用之后，你改变了这个吗？形成 OpenGL 文档：

> 一旦创建，命名纹理可以根据需要经常重新绑定到其相同的**原始目标**。

我肯定会改变它们，所以它们都是相同的（我会选择 GL_TEXTURE_2D）。

您是否在其他地方进行与纹理相关的任何其他 GL_* 调用？因为这闻起来像是在绘制第一个对象后仍然存在的陈旧参数。希望这有点帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T03:16:37.203

我解决了这个问题，虽然我不确定为什么我的解决方案有效或它在做什么，但这里是：

对于第一个纹理，我在 glGenTextures() 的调用上方添加了 glActiveTexture(GL_TEXTURE0)。

对于第二个纹理，我在调用 glGenTextures() 和 display() 函数时都使用了 glActiveTexture(GL_TEXTURE1)，并且我使用了 glUniform1i(_pm_tex_id[0], 1) 而不是 glUniform1i(_pm_tex_id[0], 0 ）。

谁能告诉我为什么会这样，如果这样做会限制 sampler2DRect 纹理的数量？我很确定可以激活的 GL_TEXTUREn 数量非常有限。**

# python - 需要创建一个django相册

> ID：12169267
> 
> 赞同：-3
> 
> 时间：2012-08-29T00:13:32.940
> 
> 标签：python, django, django-models

我正在做一个需要用户上传照片和创建相册的项目（如 facebook 相册），其中一个用户可以在一个相册中上传多张照片，可以上传多个相册。经过如此搜索，我发现 django imagestore 应用程序足够方便。但不幸的是，我没有找到任何 imagestore 的示例矿石教程。我是 django 的新手。需要一些关于这个应用程序的示例教程。你能建议更好的方法来创建一个相册吗？

这是我创建相册的方法-

```
def img_file_upload_path(instance, filename):
    """ creates unique-Path & filename for upload """
    ext = filename.split('.')[-1]
    filename = "%s%s.%s" % ('img', instance.pk, ext)

    return os.path.join(
        'images','eventpic','original',                                                      
        instance.event_id.channel_id.publisher.user.username, 
        instance.event_id.channel_id.channel_title, 
        instance.event_id.event_title, 
        filename
    )   

def formatted_img_file_upload_path(instance, filename):
    """ creates unique-Path & filename for upload """
    ext = filename.split('.')[-1]
    filename = "%s%s.%s" % ('img', instance.pk, ext)

    return os.path.join(
        'images','eventpic','formatted', 
        instance.event_id.channel_id.publisher.user.username, 
        instance.event_id.channel_id.channel_title, 
        instance.event_id.event_title,
        filename
    )    

def thumb_img_file_upload_path(instance, filename):
    """ creates unique-Path & filename for upload """
    ext = filename.split('.')[-1]
    filename = "%s%s.%s" % ('img', instance.pk, ext)

    return os.path.join(
        'images','eventpic','thumb', 
        instance.event_id.channel_id.publisher.user.username, 
        instance.event_id.channel_id.channel_title, 
        instance.event_id.event_title,
        filename
    )    

class Album(models.Model):
    album_id = models.AutoField(primary_key=True)
    event_id = models.ForeignKey(event_archive,db_column='event_id')
    name = models.CharField(max_length=128)
    summary = models.TextField()
    date_created = models.DateTimeField(auto_now_add=True)
    date_modified = models.DateTimeField(auto_now=True)

class Photo(models.Model):  
    image_id            = models.AutoField(primary_key=True)
    album               = models.ForeignKey(Album,db_column='album_id')
    title               = models.CharField(max_length=255)
    summary             = models.TextField(blank=True, null=True)
    date_created        = models.DateTimeField(auto_now_add=True)
    date_modified       = models.DateTimeField(auto_now=True)
    is_cover_photo      = models.BooleanField()
    original_image      = models.ImageField(upload_to=img_file_upload_path) 

    def save(self):
        if self.is_cover_photo:
            other_cover_photo = Photo.objects.filter(album=self.album).filter(is_cover_photo = True)
            for photo in other_cover_photo:
                photo.is_cover_photo = False
                photo.save()
        filename = self.img_file_upload_path()
        if not filename == '':
            img = Image.open(filename)
            if img.mode not in ("L", "RGB"):
                img = img.convert("RGB")

            img.resize((img.size[0], img.size[1] / 2),Image.ANTIALIAS)
            img.save(self.formatted_img_file_upload_path(),quality=90)
            img.thumbnail((150,150), Image.ANTIALIAS)
            img.save(self.thumb_img_file_upload_path(),quality=90)
        super(Photo, self).save()

    def delete(self):
        filename = self.img_file_upload_path()
        try:
            os.remove(self.formatted_img_file_upload_path())
            os.remove(self.thumb_img_file_upload_path())
        except:
            pass
        super(Photo, self).delete()

    def get_cover_photo(self):
        if self.photo_set.filter(is_cover_photo=True).count() > 0:
            return self.photo_set.filter(is_cover_photo=True)[0]
        elif self.photo_set.all().count() > 0:
            return self.photo_set.all()[0]
        else:
            return None 
```

我无法修复的错误是

```
 filename = self.img_file_upload_path() 
```

需要帮助解决错误。您认为创建像相册这样的 facebook 的方法可以吗？或者我应该使用 imagestore 应用程序吗？在这里我想提一下，我想在上传时保存格式化的图像和拇指图像。需要您的专家审查和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T00:42:11.657

即使没有看到回溯，我也很确定您的错误正在发生，因为您正在尝试调用模型上不存在的方法`Photo`：

```
def img_file_upload_path(instance, filename):
def formatted_img_file_upload_path(instance, filename):
def thumb_img_file_upload_path(instance, filename): 
```

这些只是您定义的函数，并分配为`upload_to`用于确定新保存的图像文件的路径上传路径的句柄。他们不住在你的班级。为了让您能够手动调用它们，您必须执行以下操作：

```
filename = img_file_upload_path(self, 'original_name.jpg') 
```

假设`original_image`设置正确，它可能是这样的：

```
if self.original_image.name:
    filename = img_file_upload_path(self, self.original_image.name) 
```

# ruby - 将 YAML 中的数据加载到数组中

> ID：12169271
> 
> 赞同：0
> 
> 时间：2012-08-29T00:13:40.557
> 
> 标签：ruby, yaml

我有这样的数据集：

```
5.3.12.0
5.3.12.1
5.3.12.2
5.3.12.3 
5.3.12.4 
```

如何在 YAML 文件中构造它，然后将其作为简单数组加载到 Ruby 中？

我希望将上面的数据作为数组加载，例如：

```
fileset_levels = ["5.3.12.0", "5.3.12.1", "5.3.12.2", "5.3.12.3", "5.3.12.4"] 
```

我将要加载多组这些数组，因此我希望将文件称为：

```
vuln1.yml
vuln2.yml 
```

并将它们全部加载为我可以在我的 Ruby 脚本中使用的数组。

我试过了：

```
vuln1_array = yaml::load("vuln1.yml") 
```

但它不会创建数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T01:45:23.237

学习如何使用序列化程序做任何事情的一个好方法是尝试编写一段代码来演示往返：

```
require 'yaml'

puts %w[
  5.3.12.0
  5.3.12.1
  5.3.12.2
  5.3.12.3 
  5.3.12.4
].to_yaml 
```

哪个输出：

```
---
- 5.3.12.0
- 5.3.12.1
- 5.3.12.2
- 5.3.12.3
- 5.3.12.4 
```

创建往返行程如下所示：

```
require 'pp'
require 'yaml'

pp YAML.load(
  %w[
    5.3.12.0
    5.3.12.1
    5.3.12.2
    5.3.12.3 
    5.3.12.4
  ].to_yaml
) 
```

现在输出：

```
=> ["5.3.12.0", "5.3.12.1", "5.3.12.2", "5.3.12.3", "5.3.12.4"] 
```

这个过程的好处是你可以看到它应该是什么样子，并学习如何解析它。

我使用类似的过程来生成用于配置文件的复杂 YAML 文档。虽然我们可以从头开始创建它们，但使用简单的 Ruby 数组和散列更容易，然后让 YAML 在生成输出时对其进行排序。我将输出重定向到一个文件并将其用作起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:34:59.583

你称它为 yaml 文件，但这只是一个基本文件。Yaml 就像一个哈希结构，你有一个匹配一个值的键。这里只是一个值列表。

你能做的是

```
>> file = File.read('vuln1.yml')
=> "5.3.12.0\n5.3.12.1\n5.3.12.2\n5.3.12.3 \n5.3.12.4\n"
>> file.split("\n")
=> ["5.3.12.0", "5.3.12.1", "5.3.12.2", "5.3.12.3 ", "5.3.12.4"] 
```

# powerbuilder - 在 Citrix 中为 PowerBuilder 12 应用程序创建配置文件时出现问题

> ID：12169272
> 
> 赞同：1
> 
> 时间：2012-08-29T00:13:41.720
> 
> 标签：powerbuilder, citrix

我们有一个 PowerBuilder 12.1 应用程序，我们一直在 Windows 2008 R2 64 位服务器上运行。我们正试图让这个应用程序在我们新的 XenApp Citrix 环境中运行。如果在启动 PB 应用程序时用户的配置文件不存在，则开始创建配置文件 - 它正在创建各种目录和子目录。不知道为什么。但是，在配置文件完成之前，它会爆炸并中止执行。如果用户在没有配置文件的情况下首先运行写字板 - 将正确创建配置文件。创建配置文件后，可以毫无问题地启动 PB 应用程序。我们在主程序第二行的 PB 应用程序中放置了一个弹出对话框，当没有配置文件并且执行中止时，该弹出窗口永远不会被调用。与写字板一样，一旦创建了配置文件，就会启动 PB 应用程序，

有没有人看到这样的行为？我不确定是什么原因造成的，并且无法访问 Citrix 服务器，它由我们的技术服务组管理。他们说问题一定是 PB 应用程序。我不确定。任何关于我们如何解决这个问题的想法都将不胜感激。PB 应用程序应该能够在 Citrix 中运行，对吧？我不知道在这种环境中 PB 应用程序的启动过程是什么，但我认为执行将在主程序中开始。这个对吗？

提前致谢，Bill44077

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-20T01:33:51.737

如果您由于权限而无法在 Citrix 上保留用户配置文件，则此方法效果很好，您可以将其用于基于 Web 的应用程序或 n 层应用程序（在服务器端）。

**将数据库表添加**到您的系统以模拟 PB 配置文件功能。

**新表：**

```
// citrix_user_profile (new table pseudo-code)
// 
// id = identity, not null
// userid = type of userid in your DB, not null
// filename = char, not null
// section = char, not null
// key = char, not null
// value = char null 
```

**1.**创建新的自定义非可视用户对象：n_user_profile

**2.**添加实例变量类似于：

```
protected:

// todo: write a setter and getter
boolean ib_use_windows_profile = false

constant int FAIL = -1
constant int SUCCESS = 1 
```

**3.**添加函数定义类似于：

```
int = of_setprofilestring(string as_filename, string as_section, string as_key, string as_value) 
```

编码如下：

```
// If windows profile use PB standard function,
// otherwise use citrix user profile logic

If this.ib_use_windows_profile Then

    Return SetProfileString(as_filename, as_section, as_key, as_value)

Else

    // Pseudo-Code
    //
    // Does an entry exist in the database for this user, filename, section, key?
    // Yes: Update the table with the new value
    // No: Insert entry to the table with values

    Return this.SUCCESS  // success or fail

End If 
```

**4.**添加类似的功能：

```
string = of_profilestring(string as_filename, string as_section, string as_key, string as_default) 
```

编码如下：

```
// If windows profile use PB standard function,
// otherwise use citrix user profile logic
// if you don't have access to user info then
// add it to the argument list.

If this.ib_use_windows_profile Then

    Return ProfileString(as_filename, as_section, as_key, as_default)

Else

    // Pseudo-Code
    //
    // Does an entry exist in the database for this user, filename, section, key?
    // Yes: Return the 'value' from DB
    // No: Return the default value passed via parameter

    Return as_default // or value from database

End If 
```

**5.**使用新的非可视化，调用你的setter来设置windows配置文件实例变量，然后使用你的新函数代替PB标准配置文件函数。

# java - gwt 客户端和 gwt 服务器的 java 公共库

> ID：12169274
> 
> 赞同：1
> 
> 时间：2012-08-29T00:14:08.280
> 
> 标签：java, gwt

我想知道是否有办法在 gwt 客户端和 gwt 服务器之间使用通用 java lib（外部 jar）如果

*   lib 只包含可序列化的对象？
*   该库不包含 *.gwt.xml 文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T11:48:19.863

我不这么认为。外部库必须包含 *.gwt.xml 文件，以指定 GWT 编译器必须编译哪些包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T14:41:48.110

我很难让这个工作。将 non-gwt-project 添加到 Eclipse 中的类路径并在客户端代码中引用这些对象不会在 Eclipse 中引发错误，但 GWT 在编译时不喜欢它。我能够在服务器端代码中从 GET 项目外部引用一个对象并对其进行编译，但在运行时失败。我希望做同样的事情，如果您确实遇到了解决方案，请告诉我。谢谢！

# php - 使用 php 和 xpath 在 html 标记后获取文本

> ID：12169275
> 
> 赞同：3
> 
> 时间：2012-08-29T00:14:12.520
> 
> 标签：php, html, xpath

我从网页的卷曲废料中获得以下 html：

```
<div id="box">
<br>
Your word(s):
<br>
<br>
functionally
<br>
<br>
<br> 
```

我想要第三个之后的内容`<br>`：`/html/body/div[2]/div/br[3]`-那是**功能**

```
@$itemCell = $xpath->query( "/html/body/div[2]/div/br[3]" );
$word = $itemCell->item( 0 );
return $word->nodeValue; 
```

这不会返回任何东西。如果我备份到 just`/div`我当然会得到**box**的全部内容。我如何提取第二个之后的单词`<br>`。我的话总是在第三个之后`<br>`。

看起来很简单，但它逃脱了我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:34:43.960

尝试类似这样的查询

```
$textNodes = $xpath->query('//div[@id="box"]/br[3]/following-sibling::text()[1]'); 
```

在这里工作演示 - [http://codepad.viper-7.com/00oeZh](http://codepad.viper-7.com/00oeZh)

这里的关键是`following-sibling` [Axes](http://www.w3.org/TR/xpath/#axes)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-01T14:16:35.733

```
<dl>
        <dt>info</dt>
        <dd>
            <a>a1</a>b2
            <a>a2</a>
        </dd>
    </dl> 
```

获取标签后的 b2。xpath 如下所示。//dl/dd/a[1]/following-sibling::text()

# java - 这种方法有什么问题？(2)

> ID：12169276
> 
> 赞同：-2
> 
> 时间：2012-08-29T00:14:19.247
> 
> 标签：java, for-loop

不太确定我哪里出错了。`total`我需要对系列的前 16个元素求和：1、3、9、27、81 `Geometric1`....

该`total`方法打印一个值 7174454.0 但我应该得到 21523360。

```
public class Geometric1 implements Seq{

private double b;
public static double result = 0.0;

public Geometric1(double b) {
    this.b = b;
}

public double valAtIndex(int i) {
    // TODO Auto-generated method stub
    return Math.pow(b, i);
}

public static double total() {

    Seq s = new Geometric(3.0);

    for (int i = 0; i < 15; i++) {
        result += s.valAtIndex(i);
    }

    return result;
}

public static void main(String[] args) {

    System.out.println(total());}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:44:21.363

你很近。你只需要调整你的循环运行 16 次。

将结果初始化为`0`（您已多次编辑帖子），并按如下方式更改循环：

```
for (int i = 0; i <= 15; i++) {
    result += s.valAtIndex(i);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:44:22.453

它应该是 i <= 15，而不是 < 15。这将解决您的问题。:)

7174454.0 明显小于 21523360。

# google-maps - KML/Fusion Tables - 线始终为红色

> ID：12169278
> 
> 赞同：0
> 
> 时间：2012-08-29T00:14:30.153
> 
> 标签：google-maps, kml, google-fusion-tables

我一直在玩 Fusion Tables/Google Maps 的东西来创建不同地方之间的一些飞行路径，但我不知道如何正确设置线条的样式。

这是我导入的示例 KML：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
<Document>
  <name>LineStyle.kml</name>
  <open>1</open>
  <Style id="linestyleExample">
    <LineStyle>
      <color>00FF00</color>
      <width>4</width>
      <gx:labelVisibility>1</gx:labelVisibility>
    </LineStyle>
  </Style>
  <Placemark>
    <name>LineStyle Example</name>
    <styleUrl>#linestyleExample</styleUrl>
    <LineString>
      <extrude>1</extrude>
      <tessellate>1</tessellate>
     <coordinates>-0.47364383,51.824664,0.0 -122.364152,37.824322,0.0</coordinates>
    </LineString>
  </Placemark>
</Document>
</kml> 
```

它正确地绘制了线条，但无论我在 LineStyle 部分中输入什么值，它始终是红色的。

有人知道如何获得不同的颜色吗？我已经尝试了我能想到的一切，但我被困住了！

在此先感谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:49:23.743

您可以使用用户界面在 FusionTables 中设置它们（折线、多边形和标记）的[样式（在 Visualize:Map 中，单击配置样式）](http://support.google.com/fusiontables/bin/answer.py?hl=en&answer=185991)。如果您将样式信息放在一列中，这是最简单的（除非您希望它们都相同）

您还可以在（单个）FusionTablesLayer 上的 Google Maps API v3 中动态配置多达 5 种样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:20:44.090

Fusion Tables 不导入样式信息，您必须使用 Fusion Tables 界面重新设置样式

# tsql - 是否可以重构此语句以删除子查询？

> ID：12169279
> 
> 赞同：0
> 
> 时间：2012-08-29T00:14:42.877
> 
> 标签：tsql, sql-server-2005

我正在尝试从一列中获取数据`MyTable.SSN`，并将其复制到同一张表中的另一列`MyTable.SSNWithDashes`，只是格式不同。如果`MyTable.SSN`不完全是 9 位数字，我根本不在乎处理它。

我试过这个：

```
IF( SELECT LEN( [SSN] ) FROM [MyTable] ) = 9
UPDATE [MyTable] SET [SSNWithDashes] = LEFT( [SSN], 3 ) + '-' + SUBSTRING( [SSN], 4, 2 ) + '-' + RIGHT( [SSN], 4 ) 
ELSE
UPDATE [MyTable] SET [SSNWithDashes] = NULL 
```

虽然这有效，但它会引发错误：

`Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.`

虽然我确实理解警告的意思，但我不确定如何以不同的方式解决这个问题。

我如何重构它以删除该警告（并且可能阅读更清晰）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:26:52.593

```
UPDATE dbo.[MyTable] 
  SET [SSNWithDashes] = CASE
  WHEN LEN(SSN) = 9 THEN 
    LEFT([SSN],3) + '-' + SUBSTRING([SSN],4,2) + '-' + RIGHT([SSN],4) 
  ELSE NULL
END; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:31:21.120

假设你`SSNWithDashes`已经是`NULL`那么

```
UPDATE dbo.[MyTable] 
  SET [SSNWithDashes]  = LEFT([SSN],3) + '-' + SUBSTRING([SSN],4,2) + '-' + RIGHT([SSN],4) 
WHERE LEN(SSN) = 9 
```

每隔一行保留`NULL`

# google-api - 如何调用 Google API

> ID：12169281
> 
> 赞同：4
> 
> 时间：2012-08-29T00:14:46.407
> 
> 标签：google-api, google-docs-api, google-drive-api

我在 Google 上阅读了以下两页：1）[https://developers.google.com/google-apps/documents-list/#getting_a_list_of_documents_and_files](https://developers.google.com/google-apps/documents-list/#getting_a_list_of_documents_and_files) 和 2）[https://developers.google.com/accounts/docs/OAuth2WebServer](https://developers.google.com/accounts/docs/OAuth2WebServer)

我可以在后续的 Google API 调用中使用 access_token (OAuth2)（我想调用 Google Docs Listing 或 Google Drive）。

我想使用 curl 或类似的东西，只是形成我的 https URL。- 因此，在第一个文档中声明形成如下 URL：https：//docs.google.com/feeds/default/private/full - 在第二个文档中，示例声明使用类似 https：//www .googleapis.com/oauth2/v1/userinfo?access_token=xxxxx（将访问令牌添加到调用中）

几个问题 - 我是打电话给 googleapis.com 还是 docs.google.com？- 我可以打电话给 https://docs.google.com/feeds/default/private/full?access_token=xxxxx 只需将访问令牌添加到通话中吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-13T22:03:55.990

您第一次使用 Google API 需要付出一些努力，但随后它变得简单而优雅：

1.  **手动准备**（*一次性操作*）：登录 Google，创建项目，启用相关 API，创建新客户 ID。
2.  **获取 OAuth 代码、刷新令牌和访问令牌**（*一次性操作*）。
3.  **进行 API 调用**（*重复的任意操作*）。

这是整个过程的详细说明-[进行Google API调用的步骤](http://www.milevis.com/Tips/Details/52)。还可以在此处查看基于 Google Calendar API 的实用示例，其中包含单个 HTML 文件中的完整演示代码 -[轻松紧凑地访问我的 Google 日历](http://www.milevis.com/Tips/Details/55)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T06:54:09.450

Hie you can go through the Google Docs Sample Available [Here](http://code.google.com/p/google-api-java-client/source/browse/?repo=samples&r=43b27a71a63db8a8c481a6f3e95ffa9533e01865)

it's a command line smaple but this same thing you can implement in android. it works for me. you will find "docs-cmdline-sample" in repo. that will help you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T04:11:13.653

最快的入门方法可能是 Google Drive API 的快速入门指南，它展示了如何设置您的环境并编写一个完整的命令行应用程序以将文件上传到 Drive：

[https://developers.google.com/drive/quickstart](https://developers.google.com/drive/quickstart)

# ruby - 如何将新的 rvm 安装与现有的 ruby 版本相关联？

> ID：12169283
> 
> 赞同：5
> 
> 时间：2012-08-29T00:14:50.790
> 
> 标签：ruby, rvm

我遇到了 RVM 的问题，所以我卸载并重新安装了它。

事实是我实际上尝试了 rbenv，但这对我来说并没有成功，所以我试图让 rvm 重新启动并运行 - 无需安装重复版本的 Ruby。

我至少安装了 1 个现有版本的 Ruby：

```
ruby --version
ruby 1.8.7 (2011-12-28 patchlevel 357) [universal-darwin11.0] 
```

但是当我这样做时，`rvm list`我会得到一个空白列表：

```
bash-3.2$ rvm list

rvm rubies

# Default ruby not set. Try 'rvm alias create default <ruby>'.

# => - current
# =* - current && default
#  * - default 
```

所以我的问题有两个部分：

*   如何在我的系统上查看所有版本的 Ruby（假设 rvm 没有显示任何内容）？
*   如何将新的 RVM 安装与现有的 Ruby 版本相关联？

还是我最好删除所有现有版本的 Ruby 并重新安装所有内容？不过，这似乎是一种痛苦。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-29T00:49:12.033

您可以使用以下方法将现有的 ruby​​ 添加到 rvm：

```
rvm mount /path/to/ruby 
```

或者：

```
rvm automount 
```

但要小心，因为系统中安装的 ruby​​ 可能具有 gem 的硬编码路径 - 所以 gemset 无法使用它。

还有一种添加二进制红宝石（已经编译）的新方法，用于您的平台运行的可用构建列表：

```
rvm list remote 
```

您可以使用以下命令安装这些红宝石：

```
rvm mount -r 1.9.3 
```

This might be default way of installing ruby to avoid compilation in next stable release of RVM - but it will work only for ruby 1.9.3+.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T00:39:10.080

您*不想*将 RVM 与现有的 Ruby 相关联，您只想安装一个新的 Ruby。

您也不想删除系统 Ruby；OS X 依赖于它。

在 rvm 下安装一个新的 1.8.7，这样您就可以将*自己的*gemset 与之关联。让 OS X 管理默认系统 Ruby，您只需忽略它并使用您自己的，由 rvm 单独管理。

（如果你决定走 rvm 路线。）

# javascript - 使用 JavaScript 记录输入

> ID：12169285
> 
> 赞同：0
> 
> 时间：2012-08-29T00:15:05.903
> 
> 标签：javascript, ruby

我有一个输入字段，我想在每次按键超过三个字符后将输入写入记录器。该应用程序是 Rails 和 JavaScript。解决这个问题的最佳方法是什么？

我考虑在 keyup 上发生的输入字段上放置一个事件侦听器，获取该字段的值并对其进行处理。如果可能的话，我想使用 Ruby Logger，即`Logger.new`

例子

输入“猫”

和 javascript 捕获输入并将其记录到 log/keys.log

输入一个额外的 's'

和 javascript 捕获该输入并将其记录到 log/keys.log 以及

# linux - 如何使用 XFS 设置有保证的 io？

> ID：12169286
> 
> 赞同：1
> 
> 时间：2012-08-29T00:15:30.647
> 
> 标签：linux, filesystems, xfs

根据维基百科，XFS 能够保证 IO 的速率。如何在 Linux（更具体地说是 Centos 5.5）下设置它？还是只适用于 IRIX？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:29:18.180

[引用](http://oss.sgi.com/archives/xfs/2012-07/msg00432.html)戴夫·钦纳的话：

```
 Linux doesn't support GRIO. It's an Irix only thing, and that
    required special hardware support for bandwidth reservation, special
    frame schedulers in the IO path, etc. 
```

# jakarta-ee - JAXB annox 并出现错误 java.lang.NoSuchMethodError: com.sun.codemodel.JAnnotatable.annotations()Ljava/util/Collection

> ID：12169287
> 
> 赞同：0
> 
> 时间：2012-08-29T00:15:33.350
> 
> 标签：jakarta-ee, jaxb, jaxb2, jaxb2-basics, annox

您好我正在使用带有 ant xjc 的 JAXB annox 并收到以下错误
C:_Dev\build\abcSupplierDomain.xml:479: java.lang.NoSuchMethodError:

```
com.sun.codemodel.JAnnotatable.annotations()Ljava/util/Collection;
        at org.jvnet.jaxb2`enter code here`_commons.plugin.annotate.Annotator.annotate(Annotator.java:62)
        at org.jvnet.jaxb2_commons.plugin.annotate.AnnotatePlugin.annotate 
```

有人能告诉我这个错误的原因是什么吗？我已经下载了所有用于执行此操作的 JAXB 2.* jar，因为 jaxb2-basics-annotate-0.6.4 支持 org.jvnet.jaxb2_commons.xjc.XJC2Task。

下面是我的 xjb 文件和 build.xml

构建.xml

```
<xjc schema="serviceDescription/atlantis/v2/com.abc.e3.ss.lodging.lodginginterface.messages.availsummary.v2.xsd" 
            destdir="${src.gen.dir}" extension="true" removeoldoutput="true"
            binding="build/annoxBindings.xjb">
          <arg value="-Xannotate" />
          <arg value="-episode" />
          <arg value="${src.gen.dir}/LodgingInterface-AvailSummary_v2.episode" />
          <produces dir="${src.gen.dir}/com/abc/e3/ss/lodging/lodginginterface/messages/availsummary/defn/v2" includes="**/*.java" />
             <binding dir="${src.gen.dir}">
                            <include name="BaseTypes.episode"/>
                            <include name="TimeTypes.episode"/>
                            <include name="PlaceTypes.episode"/>
                            <include name="PersonTypes.episode"/>
                            <include name="FinanceTypes.episode"/>
                            <include name="MessageTypes.episode"/>
                            <include name="ErrorTypes.episode"/>
                            <include name="LodgingInterface-CommonTypes_3.episode"/>
                            <include name="LodgingInterface-AvailSummaryTypes_v2.episode"/>
                        </binding>
        </xjc> 
```

我的 xjb 文件

```
<?xml version="1.0" encoding="UTF-8"?> 
<jaxb:bindings
  xmlns:jaxb="http://java.sun.com/xml/ns/jaxb"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:annox="http://annox.dev.java.net"
  xsi:schemaLocation="http://java.sun.com/xml/ns/jaxb http://java.sun.com/xml/ns/jaxb/bindingschema_2_0.xsd"
  jaxb:version="2.1"
  jaxb:extensionBindingPrefixes="annox">

  <jaxb:bindings schemaLocation="file:/C:/SubversionProjects/sharedComponents/abcSupplierDomain_Dev/serviceDescription/atlantis/v2/com.expedia.e3.ss.lodging.lodginginterface.messages.availsummary.v2.xsd">
    <jaxb:bindings node="//xs:complexType[@name='AvailSummaryRequestType']">
      <annox:annotate>
        <annox:annotate
           annox:class="javax.xml.bind.annotation.XmlRootElement"
           name="AvailSummaryRequest" />
    </annox:annotate>
    </jaxb:bindings>
  </jaxb:bindings>

</jaxb:bindings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T08:45:11.160

jaxb2-basics-annotate 0.6.4 需要 JAXB 2.2.x，看起来您使用的是旧版本的 JAXB 2。

# r - ggplot2 - 无法在循环内使用 scale_fill_manual 应用颜色

> ID：12169289
> 
> 赞同：5
> 
> 时间：2012-08-29T00:16:13.843
> 
> 标签：r, loops, ggplot2

我正在运行一个循环，以在我的数据集的每个子设置中获取地图并相应地应用给定的调色板（和相应的图例）。

人们倾向于不喜欢使用 for() 循环并最大限度地利用他们的方法。我不知道使用此特定数据集对流程进行矢量化的最佳方法。

在这种特殊情况下，我正在处理一个相对较大的数据集（分布物种地图集），该数据集特别复杂，因为使用了不同的方法，并且必须为每个物种传递不同的选项，考虑到特定的季节、不同的观察集等。物种可能在一个季节出现而错过另一个季节（它们可能是繁殖者、居民或移民）。应为所有情况（季节）创建地图，缺席时为空。可能会提供和使用其他数据（除了来自现场工作的数据）。Map Legend 必须适应所有变化，除了以自定义离散比例呈现感兴趣的变量（丰度）。

通过运行循环，我觉得（以我有限的专业知识）我可以更轻松地保留和控制几个需要的对象，同时进入我创建的通量以产生感兴趣的部分并最终创建一组物种分布图。

> **我的问题**是我将每个生成的 ggplot 存储在 list() 对象中。每个季节的每个物种都将存储在一个列表中。我面临的问题与**在****循环**中使用时 的**scale_fill_manual**有关。

 ****这种行为很奇怪，因为我完成了地图，但颜色仅应用于最后一个 ggplot 输出。尽管如此，所有值仍然在图例中正确识别。

举例说明：

## 套餐

```
if (!require(ggplot2)) install.packages("ggplot2",
    repos = "http://cran.r-project.org"); library(ggplot2)
if (!require(grid)) install.packages("grid",
    repos = "http://cran.r-project.org"); library(grid)
if (!require(RColorBrewer)) install.packages("RColorBrewer",
    repos = "http://cran.r-project.org"); library(RColorBrewer)
if (!require(reshape)) install.packages("reshape",
    repos = "http://cran.r-project.org"); library(reshape) 
```

# 先举个简单的例子

```
#Create a list of colors to be used with scale_manual
palette.l <- list()
palette.l[[1]] <- c('red', 'blue', 'green')
palette.l[[2]] <- c('pink', 'blue', 'yellow')
# Store each ggplot in a list object
plot.l <- list()
#Loop it
for(i in 1:2){
  plot.l[[i]] <- qplot(mpg, wt, data = mtcars, colour = factor(cyl)) +
    scale_colour_manual(values = palette.l[[i]])
} 
```

> 在我的会话中，plot.l[ [1](https://docs.google.com/open?id=0BxSZDr4eTnb9R09iSndzZjBMS28) ] 将使用来自 palette.l[ [2](https://i.stack.imgur.com/ymZOc.png) ] 的颜色进行绘制。

# 我的特殊情况

## 功能

### 排列地块

```
ArrangeGraph <- function(..., nrow=NULL, ncol=NULL, as.table=FALSE) {
  dots <- list(...)
  n <- length(dots)
  if(is.null(nrow) & is.null(ncol)) { nrow = floor(n/2) ; ncol = ceiling(n/nrow)}
  if(is.null(nrow)) { nrow = ceiling(n/ncol)}
  if(is.null(ncol)) { ncol = ceiling(n/nrow)}
  ## NOTE see n2mfrow in grDevices for possible alternative
  grid.newpage()
  pushViewport(viewport(layout=grid.layout(nrow,ncol)))
  ii.p <- 1
  for(ii.row in seq(1, nrow)) {
    ii.table.row <- ii.row
    if(as.table) {ii.table.row <- nrow - ii.table.row + 1}
    for(ii.col in seq(1, ncol)) {
      ii.table <- ii.p
      if(ii.p > n) break
      print(dots[[ii.table]], vp=VPortLayout(ii.table.row, ii.col))
      ii.p <- ii.p + 1
    }
  }
} 
```

### 视口

```
VPortLayout <- function(x, y) viewport(layout.pos.row=x, layout.pos.col=y) 
```

## 物种数据集

```
bd.aves.1 <- structure(list(quad = c("K113", "K114", "K114", "K114", "K114",...
due to limited body character number limit, please download entire code from
https://docs.google.com/open?id=0BxSZDr4eTnb9R09iSndzZjBMS28 
```

### 物种清单

```
list.esp.1 <- c("Sylv mela", "Saxi rube","Ocea leuc")#
# download from the above link 
```

### 一些分类和其他数据

```
txcon.1 <- structure(list(id = c(156L, 359L, 387L), grupo = c("Aves", "Aves",# 
# download from the above link 
```

### 四季

```
kSeason.1 <- c("Inverno", "Primavera", "Outono") 
```

## 示例网格

```
grid500.df.1 <- structure(list(id = c("K113", "K113", "K113", "K113", "K113",#... 
# download from the above link 
```

## 其他映射元素

### 海岸线

```
coastline.df.1 <- structure(list(long = c(182554.963670234, 180518, 178865.39,#...
# download from the above link 
```

### 标签位置调整

```
kFacx1 <- c(9000, -13000, -10000, -12000) 
```

## R代码

```
for(i in listsp.1) { # LOOP 1 - Species
  # Set up objects 
  sist.i <- list() # Sistematic observations
  nsist.i <- list() # Non-Sistematic observations
  breaks.nind.1 <- list() # Breaks on abundances
  ## Grid and merged dataframe
  spij.1 <- list() # Stores a dataframe for sp i at season j
  ## Palette build
  classes.1 <- list()
  cllevels.1 <- list()
  palette.nind.1 <- list() # Color palette
  ## Maps
  grid500ij.1 <- list() # Grid for species i at season j
  map.dist.ij.1 <- NULL
  for(j in 1:length(kSeason.1)) { # LOOP 2 - Seasons
    # j assume each season: Inverno, Primavera, Outono
    # Sistematic occurences ===================================================
    sist.i.tmp <- nrow(subset(bd.aves.1, esp == i & cod_tipo %in% sistematica &
      periodo == kSeason.1[j]))
    if (sist.i.tmp!= 0) { # There is sistematic entries, Then:
      sist.i[[j]]<- ddply(subset(bd.aves.1,
                                 esp == i & cod_tipo %in% sistematica & 
                                   periodo == kSeason.1[j]),
                          .(periodo, quad), summarise, nind = sum(n_ind),
                          codnid = max(cod_nidi))
    } else { # No Sistematic entries, Then: 
      sist.i[[j]] <- data.frame('quad' = NA, 'periodo' = NA, 'nind' = NA, 
                                'codnid' = NA, stringsAsFactors = F)
    }
    # Additional Entries (RS1) e other non-sistematic entries  (biblio) =======
    nsist.tmp.i = nrow(subset(bd.aves.1, esp == i & !cod_tipo %in% sistematica &
      periodo == kSeason.1[j]))
    if (nsist.tmp.i != 0) { # RS1 and biblio entries, Then:
      nsist.i[[j]] <- subset(bd.aves.1,
                             esp == i & !cod_tipo %in% sistematica &
                               periodo == kSeason.1[j] & 
                               !quad %in% if (nrow(sist.i[[j]]) != 0) {
                                            subset(sist.i[[j]],
                                                   select = quad)$quad
                                          } else NA,
                             select = c(quad, periodo, cod_tipo, cod_nidi)
                             )
      names(nsist.i[[j]])[4] <- 'codnid'
    } else { # No RS1 and biblio entries, Then:      
        nsist.i[[j]] = data.frame('quad' = NA, 'periodo' = NA, 'cod_tipo' = NA,
                                'codnid' = NA, stringsAsFactors = F)
      }
    # Quantile breaks =========================================================
    if (!is.na(sist.i[[j]]$nind[1])) {
      breaks.nind.1[[j]] <- c(0,
                            unique(
                              ceiling(
                                quantile(unique(
                                  subset(sist.i[[j]], is.na(nind) == F)$nind), 
                                         q = seq(0, 1, by = 0.25)))))
    } else {
        breaks.nind.1[[j]] <- 0
      }
    # =========================================================================
    # Build Species dataframe and merge to grid
    # =========================================================================
    if (!is.na(sist.i[[j]]$nind[1])) { # There are Sistematic entries, Then:
      spij.1[[j]] <- merge(unique(subset(grid500df.1, select = id)),
                         sist.i[[j]],
                         by.x = 'id', by.y = 'quad', all.x = T)
      # Adjust abundances when equals to NA ===================================
      spij.1[[j]]$nind[is.na(spij.1[[j]]$nind) == T] <- 0
      # Break abundances to create discrete variable ==========================
      spij.1[[j]]$cln <- if (length(breaks.nind.1[[j]]) > 2) {
        cut(spij.1[[j]]$nind, breaks = breaks.nind.1[[j]], 
            include.lowest = T, right = F)
        } else {
            cut2(spij.1[[j]]$nind, g = 2)
          }
      # Variable Abundance ====================================================
      classes.1[[j]] = nlevels(spij.1[[j]]$cln)
      cllevels.1[[j]] = levels(spij.1[[j]]$cln)
      # Color Palette for abundances - isolated Zero class (color #FFFFFF) ====
      if (length(breaks.nind.1[[j]]) > 2) {
        palette.nind.1[[paste(kSeason.1[j])]] = c("#FFFFFF", brewer.pal(length(
          cllevels.1[[j]]) - 1, "YlOrRd"))
      } else {
          palette.nind.1[[paste(kSeason.1[j])]] = c(
            "#FFFFFF",  brewer.pal(3, "YlOrRd"))[1:classes.1[[j]]]
        }
        names(palette.nind.1[[paste(kSeason.1[j])]])[1 : length(
          palette.nind.1[[paste(kSeason.1[j])]])] <- cllevels.1[[j]]
      # Add RS1 and bilbio values to palette ==================================
      palette.nind.1[[paste(kSeason.1[j])]][length(
        palette.nind.1[[paste(kSeason.1[j])]]) + 1] <- '#CCC5AF'
      names(palette.nind.1[[paste(kSeason.1[j])]])[length(
        palette.nind.1[[paste(kSeason.1[j])]])] <- 'Suplementar'
      palette.nind.1[[paste(kSeason.1[j])]][length(
        palette.nind.1[[paste(kSeason.1[j])]]) + 1] <- '#ADCCD7'
      names(palette.nind.1[[paste(kSeason.1[j])]])[length(
        palette.nind.1[[paste(kSeason.1[j])]])] <- 'Bibliografia'
      # Merge species i dataframe to grid map =================================
      grid500ij.1[[j]] <- subset(grid500df.1, select = c(id, long, lat, order))
      grid500ij.1[[j]]$cln = merge(grid500ij.1[[j]],
                                 spij.1[[j]],
                                 by.x = 'id', by.y = 'id', all.x = T)$cln
      # Adjust factor levels of cln variable - Non-Sistematic data ============
      levels(grid500ij.1[[j]]$cln) <- c(levels(grid500ij.1[[j]]$cln), 'Suplementar',
                                      'Bibliografia')
      if (!is.na(nsist.i[[j]]$quad[1])) {
        grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(
          nsist.i[[j]], cod_tipo == 'RS1', select = quad)$quad] <- 'Suplementar'
        grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(
          nsist.i[[j]], cod_tipo == 'biblio', select = quad)$quad] <- 'Bibliografia'
      }
    } else { # No Sistematic entries, Then:
        if (!is.na(nsist.i[[j]]$quad[1])) { # RS1 or Biblio entries, Then:
          grid500ij.1[[j]] <- grid500df
          grid500ij.1[[j]]$cln <- '0'
          grid500ij.1[[j]]$cln <- factor(grid500ij.1[[j]]$cln)
          levels(grid500ij.1[[j]]$cln) <- c(levels(grid500ij.1[[j]]$cln),
                                          'Suplementar', 'Bibliografia')
          grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(
            nsist.i[[j]], cod_tipo == 'RS1', 
            select = quad)$quad] <- 'Suplementar'
          grid500ij.1[[j]]$cln[grid500ij.1[[j]]$id %in% subset(
            nsist.i[[j]],cod_tipo == 'biblio', 
            select = quad)$quad] <- 'Bibliografia'
        } else { # No entries, Then:
            grid500ij.1[[j]] <- grid500df
            grid500ij.1[[j]]$cln <- '0' 
            grid500ij.1[[j]]$cln <- factor(grid500ij.1[[j]]$cln)
            levels(grid500ij.1[[j]]$cln) <- c(levels(grid500ij.1[[j]]$cln),
                                            'Suplementar', 'Bibliografia')      
          }
      } # End of Species dataframe build
    # Distribution Map for  species i at season j =============================    
    if (!is.na(sist.i[[j]]$nind[1])) { # There is sistematic entries, Then:
      map.dist.ij.1[[paste(kSeason.1[j])]] <- ggplot(grid500ij.1[[j]],
                                                  aes(x = long, y = lat)) +
        geom_polygon(aes(group = id, fill = cln), colour = 'grey80') +
        coord_equal() +
        scale_x_continuous(limits = c(100000, 180000)) +
        scale_y_continuous(limits = c(-4000, 50000)) +
        scale_fill_manual(
          name = paste("LEGEND",
                       '\nSeason: ', kSeason.1[j],
                       '\n% of Occupied Cells : ',
                         sprintf("%.1f%%", (length(unique(
                           grid500ij.1[[j]]$id[grid500ij.1[[j]]$cln != levels(
                           grid500ij.1[[j]]$cln)[1]]))/12)*100), # percent 
                        sep = ""
                       ),
          # Set Limits
          limits = names(palette.nind.1[[j]])[2:length(names(palette.nind.1[[j]]))],
          values = palette.nind.1[[j]][2:length(names(palette.nind.1[[j]]))],
          drop = F) +
          opts(
            panel.background = theme_rect(),
            panel.grid.major = theme_blank(),
            panel.grid.minor = theme_blank(),
            axis.ticks = theme_blank(),
            title = txcon.1$especie[txcon.1$esp == i],
            plot.title = theme_text(size = 10, face = 'italic'),
            axis.text.x = theme_blank(),
            axis.text.y = theme_blank(),
            axis.title.x = theme_blank(),
            axis.title.y = theme_blank(),
            legend.title = theme_text(hjust = 0,size = 10.5),
            legend.text = theme_text(hjust = -0.2, size = 10.5)
          ) +
          # Shoreline
          geom_path(inherit.aes = F, aes(x = long, y = lat),
                    data = coastline.df.1, colour = "#997744") +
          # Add localities
          geom_point(inherit.aes = F, aes(x = x, y = y),  colour = 'grey20',
                     data = localidades, size = 2) +
          # Add labels
          geom_text(inherit.aes = F, aes(x = x, y = y, label = c('Burgau',
                                                                 'Sagres')),
                    colour = "black",
                    data = data.frame(x = c(142817 + kFacx1[1], 127337 + kFacx1[4]),
                                      y = c(11886, 3962), size = 3))
    } else { # NO sistematic entries,then:
        map.dist.ij.1[[paste(kSeason.1[j])]] <- ggplot(grid500ij.1[[j]],
                                                    aes(x = long, y = lat)) +
          geom_polygon(aes.inherit = F, aes(group = id, fill = cln),
                       colour = 'grey80') +
          #scale_color_manual(values = kCorLimiteGrid) +
          coord_equal() +
          scale_x_continuous(limits = c(100000, 40000)) +
          scale_y_continuous(limits = c(-4000, 180000)) +
          scale_fill_manual(
            name = paste('LEGENDA',
                         '\nSeason: ', kSeason.1[j],
                         '\n% of Occupied Cells :',
                         sprintf("%.1f%%", (length(unique(
                           grid500ij.1[[j]]$id[grid500ij.1[[j]]$cln != levels(
                           grid500ij.1[[j]]$cln)[1]]))/12 * 100)), # percent 
                         sep = ''),
            limits = names(kPaletaNsis)[2:length(names(kPaletaNsis))],
            values = kPaletaNsis[2:length(names(kPaletaNsis))],
            drop = F) +
            opts(
              panel.background = theme_rect(),
              panel.grid.major = theme_blank(),
              panel.grid.minor = theme_blank(),
              title = txcon.1$especie[txcon.1$esp == i],
              plot.title = theme_text(size = 10, face = 'italic'),
              axis.ticks = theme_blank(),
              axis.text.x = theme_blank(),
              axis.text.y = theme_blank(),
              axis.title.x = theme_blank(),
              axis.title.y = theme_blank(),
              legend.title = theme_text(hjust = 0,size = 10.5),
              legend.text = theme_text(hjust = -0.2, size = 10.5)
            ) +
            # Add Shoreline
            geom_path(inherit.aes = F, data = coastline.df.1,
                      aes(x = long, y = lat),
                      colour = "#997744") +
            # Add Localities
            geom_point(inherit.aes = F, aes(x = x, y = y),
                       colour = 'grey20',
                       data = localidades, size = 2) +
            # Add labels
            geom_text(inherit.aes = F, aes(x = x, y = y,
                                           label = c('Burgau', 'Sagres')),
                      colour = "black",
                      data = data.frame(x = c(142817 + kFacx1[1],
                                              127337 + kFacx1[4],),
                                        y = c(11886, 3962)),
                      size = 3)
      } # End of Distribution map building for esp i and j seasons
  } # Fim do LOOP 2: j Estacoes
  # Print Maps
  png(file = paste('panel_species',i,'.png', sep = ''), res = 96, 
      width = 800, height = 800)
  ArrangeGraph(map.dist.ij.1[[paste(kSeason.1[3])]],
               map.dist.ij.1[[paste(kSeason.1[2])]],
               map.dist.ij.1[[paste(kSeason.1[1])]],
               ncol = 2, nrow = 2)
  dev.off()
  graphics.off()
} # End of LOOP 1 
```

map.dist.ij.1[[paste(kSeason.1[3])]] 是唯一一个将调色板应用于多边形的，但每个 j 地图的图例项都得到了很好的定义。

## 使用 R 代码输出

![在此处输入图像描述](../Images/acab6a8a5e81f6a0b9c2e82f9e261a28.png)

> 如我们所见， Legends 是 OK 但**不是 coloured**。

希望不要遗漏任何东西。很抱歉丢失了一些葡萄牙语术语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T19:59:09.157

老实说，对于您的特定问题，我并没有过多地查看您的代码 - 有点太多了！ - 但是对于您的演示示例，添加`print(plot.l[[i]])`您的循环。

```
#Create a list of colors to be used with scale_manual
palette.l <- list()
palette.l[[1]] <- c('red', 'blue', 'green')
palette.l[[2]] <- c('pink', 'blue', 'yellow')

# Store each ggplot in a list object
plot.l <- list()

# Loop it
for(i in 1:2) {
  plot.l[[i]] <- qplot(mpg, wt, data = mtcars, colour = factor(cyl)) +
    scale_colour_manual(values = palette.l[[i]])
  print(plot.l[[i]]) ### Added to your loop
} 
```

* * *

但是，在您的最小示例的情况下，这也有效（无需先创建一个空列表来存储您的图），我认为它至少*看起来*更干净。我不确定是否可以调整类似的东西以适应您的更大场景。

```
#Create a list of colors to be used with scale_manual
palette.l <- list(c('red', 'blue', 'green'),
                  c('pink', 'blue', 'yellow'))

p <- qplot(mpg, wt, data = mtcars, colour = factor(cyl))

# Use lapply and "force" to get your plots in a list    
plot.l <- lapply(palette.l, 
                 function(x) { 
                   force(x)
                   p + scale_color_manual(values = x) 
                 }) 
```****

# c++ - 康威人生游戏的gtkmm实现中的段错误

> ID：12169290
> 
> 赞同：1
> 
> 时间：2012-08-29T00:16:24.997
> 
> 标签：c++, segmentation-fault, gtkmm, conways-game-of-life

正如问题中提到的，我在我正在研究的 gtkmm 中实施康威的生命游戏时有一个段错误。

可以在这里找到：[https](https://github.com/sakekasi/game-of-life)
://github.com/sakekasi/game-of-life错误的回溯可以在这里找到：[https ://gist.github.com/3505525](https://gist.github.com/3505525)

当我在 cells_get 或 create_updated 网格中插入打印语句时，它会开始打印，不会产生段错误，并且会一直持续下去而不做任何事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:23:48.400

`create_updated_grid`正在访问网格边缘的单元格。它正在调用类似`cells_get(i+1,j)`.

您需要将越界签入更改`cells_get`为`>=`，而不是`>`。

# php - “wkhtmltopdf 二进制文件未找到或不可执行”尽管 CentOS 服务器上的路径正确

> ID：12169296
> 
> 赞同：2
> 
> 时间：2012-08-29T00:17:26.277
> 
> 标签：php, cakephp, centos, wkhtmltopdf

我正在使用 CakePHP 构建一个 Web 应用程序，并使用 CakePdf 插件以及使用 wkhtmltopdf 二进制文件将 PDF 打印功能集成到其中。

我已经在我的本地机器上进行了广泛的测试，并且代码可以正常工作并按预期打印 PDF。但是，当我将应用程序上传到我的生产 Web 服务器时，我收到以下消息：

> 警告 (2): is_executable() [http://php.net/function.is-executable]: open_basedir 限制生效。文件（/usr/bin/wkhtmltopdf）不在允许的路径内：（/var/www/clients/client1/web1/web:/var/www/clients/client1/web1/tmp:/var/www /gravex.co.uk/web:/srv/www/gravex.co.uk/web:/usr/share/php5:/tmp:/usr/share/phpmyadmin:/etc/phpmyadmin:/var/lib/phpmyadmin ) [APP/Plugin/CakePdf/Pdf/Engine/WkHtmlToPdfEngine.php，第 82 行]
> 
> wkhtmltopdf 二进制文件未找到或不可执行：/usr/bin/wkhtmltopdf
> 
> 错误：发生内部错误。堆栈跟踪
> 
> ```
> APP/Plugin/CakePdf/Pdf/Engine/WkHtmlToPdfEngine.php line 29 → WkHtmlToPdfEngine->_getCommand()
> APP/Plugin/CakePdf/Pdf/CakePdf.php line 234 → WkHtmlToPdfEngine->output()
> APP/Plugin/CakePdf/View/PdfView.php line 101 → CakePdf->output(string)
> CORE/Cake/Controller/Controller.php line 957 → PdfView->render(null, null)
> CORE/Cake/Routing/Dispatcher.php line 193 → Controller->render()
> CORE/Cake/Routing/Dispatcher.php line 161 → Dispatcher->_invoke(UsersController, CakeRequest, CakeResponse)
> APP/webroot/index.php line 96 → Dispatcher->dispatch(CakeRequest, CakeResponse) 
> ```

我检查了 CakePdf 插件用于加载 wkhtmltopdf 的文件，该路径`/usr/bin/wkhtmltopdf`与我的本地计算机上的一样。我已经检查过 wkhtmltopdf 是否位于同一个地方并且它是。在安装 wkhtmltopdf 时，我只是简单地提取了二进制文件并将其放在本地和生产机器上的上述位置。

我能做些什么来解决这个问题？

**更新**
按照 stix 的建议，我添加了 open_basedir 的路径，但我仍然收到此错误。然后我尝试`wkhtmltopdf`在终端中运行，我收到错误“找不到命令”。结果证明二进制文件已损坏。所以我已经上传了一个新版本的二进制文件，并使用`./wkhtmltopdf`二进制文件。但是，如果我没有把它放在它`./`之前，我仍然会收到错误消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:25:25.473

确保 wkhtmlto* 文件设置为可执行。鉴于如果将文件定位在您的文档根目录中（而不是 OS bin 实用程序的一部分）它可以工作，Stix 正在做一些事情。

您的设置没有影响的可能原因`open_basedir`是，它可能被限制在 PHP 文件中更改它，而是在您的 php.ini 中设置：

```
open_basedir=/usr/bin/ 
```

见[http://www.php.net/manual/en/ini.core.php#ini.open-basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:40:28.313

我没有使用 cakephp，但请查看此消息：

```
open_basedir restriction in effect 
```

我认为它测试是否存在 wkhtmltopdf 二进制文件，并且因为 open_basedir 不允许它，所以它失败并给你“wkhtmltopdf 二进制文件未找到或不可执行：/usr/bin/wkhtmltopdf”错误。尝试更改 open_basedir 以允许脚本访问 /usr/bin/wkhtmltopdf

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-18T05:54:43.203

如果您的路径正确，那么您需要从[https://wkhtmltopdf.org/](https://wkhtmltopdf.org/)下载最新版本并替换它。

# r - 为包含正数和负数的值范围绘制条形图

> ID：12169298
> 
> 赞同：3
> 
> 时间：2012-08-29T00:17:29.653
> 
> 标签：r

我希望为 -0.5 到 0.5 之间的值绘制条形图，并使用下面键入的代码：

```
barplot(c(-0.08,0.02,-0.06,-0.07,-0.07,0.46), names.arg=c('a','b','c','d','e','f'),ylim=c(-0.5,0.5), col="dodgerblue4", xpd = FALSE,axes=TRUE,cex.names=1,
axis.lty=1, ylab="",space=2,las = 2,tck=-0.02,cex.axis=0.6,mgp=c(1, .3, 0))

box() 
```

但是，我还想添加一些水平运行的基线，`y=0.0`以避免条松散地悬挂在盒子内。我可以在 barplot 函数中执行此操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:20:03.217

您正在寻找

```
abline(h=0) 
```

# php - 为什么我会收到所有这些错误？

> ID：12169312
> 
> 赞同：0
> 
> 时间：2012-08-29T00:19:47.710
> 
> 标签：php, mysql, easyphp

抱歉，如果这看起来很愚蠢但很简单，但我似乎无法弄清楚为什么会出现这些错误：

警告：mysql_result() 期望参数 1 是资源，在第 25 行 C:\Program Files (x86)\EasyPHP-5.3.9\www\Image Upload\func\user.func.php 中给出的布尔值

注意：未定义索引：第 37 行 C:\Program Files (x86)\EasyPHP-5.3.9\www\Image Upload\register.php 中的 user_id

这是每个文件的代码

用户.func.php：

```
function user_exists($email){
$email = mysql_real_escape_string($email);
$query = mysql_query("SELECT COUNT(`user_id`) FROM `users` WHERE `email` = `$email`");
return (mysql_result($query, 0) == 1) ? true : false;
} 
```

这是register.php：

```
if (isset($_POST['register_email'], $_POST['register_name'], $_POST['register_password'])){
$register_email = $_POST['register_email'];
$register_name = $_POST['register_name'];
$register_password = $_POST['register_password'];

$errors = array();

if(empty($register_email) || empty($register_name) || empty($register_password)){
    $errors[] = 'All fields must be filled out';
} 
else{
        if(filter_var($register_email, FILTER_VALIDATE_EMAIL) === false){
            $errors[] = 'Email address not valid';
        }
        if(strlen($register_email) > 255 || strlen($register_name) > 35 || strlen($register_password) > 35){
            $errors[] = 'One or more fields contains too many characters';
        }
        if(user_exists($register_email) === true){
            $errors[] = 'That email has already been registered to another user';
        }
    }

if(!empty($errors)){
    foreach ($errors as $error){
        echo $error, '<br />';
    }
} else {
    $register = user_register($register_email, $register_name, $register_password);
    $SESSION['user_id'] = $register;
    echo $_SESSION['user_id'];
}

} 
```

谢谢你的帮助！-TechGuy24

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:22:14.243

查询失败..应该是`email = '$email'`（而不是用反引号包围第二封电子邮件）。

另请查阅准备好的陈述和 PDO。

`mysql_query``FALSE`失败时将返回（布尔值），成功时将返回您正在寻找的“资源”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:22:36.740

You're using backticks "`" on a value, so your query is failing, use single quotes `'`

```
$query = mysql_query("SELECT COUNT(`user_id`) FROM `users` WHERE `email` = '$email'"); 
```

# ruby-on-rails - ActiveRecord 是否有报告嵌套属性模型已被破坏的方法？

> ID：12169316
> 
> 赞同：0
> 
> 时间：2012-08-29T00:20:02.633
> 
> 标签：ruby-on-rails, nested-attributes

我正在使用该`previous_changes`方法来确定对我的 ActiveRecord 模型的更改以通过 JSON 传回，并且想知道是否有类似的东西告诉我嵌套属性已被破坏。

例如，如果`Parent has_many Children`我`Parent accepts_nested_attributes_for :children, allow_destroy: true`希望能够执行以下操作。

```
> p = Parent.last
> p.children.length
=> 3
> p.update_attributes {"name"=>"Daddy","children_attributes"=>{"0"=>{"__destroy"=>"1","id"=>"12"}}}
=> true
>p.previous_changes
=> {"name"=>["", "Daddy"], "updated_at"=>[Mon, 27 Aug 2012 22:34:34 EST +10:00, Wed, 29 Aug 2012 10:13:33 EST +10:00]}
>p.destroyed_attributes #Not a real method!!!
=> {"children_attributes"=>{"0"=>{"id"=>"12"}}} 
```

这是我想要的最后一个命令。我可以制定自己的解决方案来获取这些信息，但我希望 Rails 中已经有一些东西可以为我做到这一点。

编辑：

似乎没有内置的方法可以做到这一点，但我确实想出了一个解决方案。在我的父模型中，我定义了一个 before_save 和 after_save 回调。在 before_save 中，我保存了一个包含所有子 ID 的数组。在 after_save 中，我减去了一个包含所有子 ID 的数组。数组中剩余的任何 id 都已被删除！我将数组存储在使用 attr_accessor 定义的父模型的实例变量中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:40:08.053

添加对详细模型（子）的`:after_destroy followup_tasks`回调

```
def followup_tasks
  #do other stuff
end 
```

# javascript - 带有表单的 Javascript innerHTML

> ID：12169317
> 
> 赞同：1
> 
> 时间：2012-08-29T00:20:20.023
> 
> 标签：javascript, html, innerhtml

我正在尝试在页面之间移动，但是当我尝试转到下一页时，它无法按预期工作。当我第一次单击它时，结果是 01 而不是 1，第二次它变成 011 而不是 2。我做错了什么？

**HTML**：

```
<p id='page'>0</p>
<div id='pics'>
    <a href='<?=URL;?>index.php?p=gallery&image=<?=$pic['album_pic_id'];?>'>
        <img class='<?php if($pic['album_pic_id'] == $image) 
            { echo "selected_pic"; } ?>' width='90px' height='60px'
            src='<?=URL;?>images/albums/<?=$pic['album_pic_photo'];?>' />
     </a>
     <a onclick='getElementById("page").value = getElementById("page").value+1;'>
         Pievienot
     </a>
 </div> 
```

**Javascript**：

```
window.onload = function() {
    var page = 0;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:25:02.737

使用`innerHTML`并将其内容解析为整数`parseInt`：

```
<a onclick='getElementById("page").innerHTML = parseInt(getElementById("page").innerHTML) + 1;'>Pievienot</a> 
```

`value`仅适用于`form`诸如`input`.

# debugging - 如何浏览到通过 coffeescript 标签编译的 javascript？

> ID：12169319
> 
> 赞同：0
> 
> 时间：2012-08-29T00:20:38.020
> 
> 标签：debugging, coffeescript

对于开发，我使用 coffee-script.js 和 coffeescript 标签在浏览器中动态编译我的咖啡脚本。这很好用，除了我无法从浏览器导航到已编译的 javascript（这是 Chrome 和 Firefox/Firebug）。如果我显式地添加一个`debugger`调用，或者将浏览器设置为异常时的断点，它会将我放入已编译的 javascript 中就好了，但这似乎是获得它的唯一方法。

我目前的技术是添加

```
setTimeout () -> throw "debug me!" 
```

所以代码会抛出一个异常（在超时处理程序中，所以它不会跳出任何共享执行堆栈），我可以选择是否断点。

如果我断点，它会将我放到一个名为的源选项卡中`(program)`：

![Chrome 调试窗口](../Images/3a326028a224b1746a2805642fc3dd8d.png)

但这不是`(program)`左侧面板列表中的任何条目，如果我关闭此选项卡，我将无法返回它。

有没有其他方法可以得到这个编译的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T14:46:52.143

您可以在代码中插入`debugger`，它会在大多数浏览器中被解释为断点。

我使用 js2coffee.org 从 coffeescript 中快速预览我的 js（只需将其粘贴到咖啡到 js 面板中）

# regex - 匹配“/”或字符串结尾的正向前瞻

> ID：12169327
> 
> 赞同：10
> 
> 时间：2012-08-29T00:21:49.957
> 
> 标签：regex, regex-lookarounds

我正在尝试进行积极的前瞻来匹配给定 URL 中的对象 ID，而不管该对象 ID 在 URL 中的位置。这个想法是匹配直到一个 '/' 或字符串的结尾。以下是一些示例字符串（粗体是我要匹配的 ID）：

*   /objects/ **obj_asd-1234-special**
*   /objects/ **obj_xyz-15434** /成员
*   /objects/ **obj_aasdfaeastd-15d44** /other/asdf

使用这个： objects/obj_(.+?)(?=/) 匹配后两者，因为它们都有一个斜杠。我读到前瞻支持正则表达式作为匹配字符，所以我尝试了这个 objects/obj_(.+?)(?=(/|$)) 无济于事。有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T11:56:53.567

尝试这个：

```
/objects/(.*?)(/|$) 
```

`/objects/`它只是在斜线或 eof之间进行非贪婪匹配

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-01-31T12:38:08.100

此正则表达式匹配 EOF 或某个字符（即 /）。

```
(?<=\/objects\/obj_)(.+?)(?=\/|$) 
```

这是一个[演示](https://regexr.com/47fur)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T00:27:35.603

您不需要使用积极的前瞻：

```
/objects/([^/]+).* 
```

然后，第一组将保存您的 id 值。

这是 Python 中的一个示例：

```
>>> import re
>>> p = re.compile('/objects/([^/]+).*')

>>> p.match("/objects/obj_asd-1234-special").group(1)
'obj_asd-1234-special'
>>> p.match("/objects/obj_xyz-15434/members").group(1)
'obj_xyz-15434'
>>> p.match("/objects/obj_aasdfaeastd-15d44/other/asdf").group(1)
'obj_aasdfaeastd-15d44' 
```

# android - Android OnActivityResult setVisibility

> ID：12169333
> 
> 赞同：0
> 
> 时间：2012-08-29T00:23:02.860
> 
> 标签：android, visibility

我在同一个活动中有两个按钮。每个按钮都会调用识别器意图来进行一些语音识别。如果说出正确的话，如果让麦克风图标 Image1 和 Image2 变得不可见或消失，我试图完成什么。

```
public class Cooking  extends Activity implements OnClickListener{

    ListView lv;
    static final int check = 1;
    static final int checka = 2;

    int counter_score;
     int counter_score_b;
    TextView txView;
    MediaPlayer ourSong;
    ImageView display,image1,image2;

@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        counter_score=0;
        counter_score_b=0;
        setContentView(R.layout.cooking);
        ImageView image1 = (ImageView) findViewById(R.id.image_1_wrong);
        ImageView image2 = (ImageView) findViewById(R.id.image_2_wrong);        
        initialize();

}

private void initialize() {
    // TODO Auto-generated method stub
    lv = (ListView)findViewById(R.id.lvVoiceReturn);
    txView = (TextView)findViewById(R.id.counter);

    ImageView image1 = (ImageView) findViewById(R.id.image_1_wrong);
    ImageView image2 = (ImageView) findViewById(R.id.image_2_wrong);

    image1.setOnClickListener(this);
    image2.setOnClickListener(this);

    ActionBar actionBar = getActionBar();
     actionBar.setDisplayHomeAsUpEnabled(false);

}

    @Override
    public void onClick(View v) {
        if(v.getId() == R.id.IVimage_1_wrong){
        Intent a = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
        a.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
        a.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 1);
        a.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speak");
        startActivityForResult(a, checka);
    }else if(v.getId() == R.id.IVimage_2_wrong){
        Intent b = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
        b.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
        b.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 1);
        b.putExtra(RecognizerIntent.EXTRA_PROMPT, "Speak.");
        startActivityForResult(b, checkb);
    }
}

 @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        if (requestCode == checka && resultCode == RESULT_OK){
            ArrayList<String> results = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
            lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, results));
            if(results.contains("cooking")|| results.contains("yes really") || results.contains("disease")){

                counter_score ++;
                    ///////I though this would make ImageView Image1 not be visible  
                image1.setVisibility(View.GONE);}
                ourSong = MediaPlayer.create(Cooking.this, R.raw.rightsound2);
                ourSong.start();
                AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
                dialogBuilder.setTitle("Good");dialogBuilder.setMessage("Correct");
                dialogBuilder.setIcon(R.drawable.ic_mark);
                dialogBuilder.show();
                Thread timer = new Thread(){
                    public void run(){
                        try{
                         sleep(2500);
                        }catch (InterruptedException e){
                            e.printStackTrace();
                        } finally {

                        }
                    }
                };
                timer.start();

            }else{

                lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, results));
                counter_score +=0;

                counter_score_z +=0;
                ourSong = MediaPlayer.create(Cooking.this, R.raw.wrongsound);
                ourSong.start();
                AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
                dialogBuilder.setTitle("Oops");
                dialogBuilder.setMessage("Error msg");
                dialogBuilder.setIcon(R.drawable.ic_wrong);
                dialogBuilder.setButton("Continue", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {

                        Intent openMovilTeacherApp = new Intent(Cooking.this, LetterEx.class);
                        startActivity(openMovilTeacherApp);
                        finish();
                    }
                });
                dialogBuilder.setButton2("Try again", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        // TODO Auto-generated method stub
                        dialog.dismiss();
                    }
                });
                dialogBuilder.show();
                Thread timer = new Thread(){
                    public void run(){
                        try{
                         sleep(4000);
                        }catch (InterruptedException e){
                            e.printStackTrace();
                        } finally {

                        }
                    }
                };
                timer.start();
            }

        }
        //////Delivering MAIL/////
        if (requestCode == checkb && resultCode == RESULT_OK){
            ArrayList<String> results = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS);
            lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, results));
            if(results.contains("delivering mail")|| results.contains("no not really") || results.contains("disease")){

                counter_score ++ ;
                 ///////// the next line was supposed to make the image2 no be visible, or gone
                image2.setVisibility(View.GONE);}
                counter_score_z +=1;
                ourSong = MediaPlayer.create(Cooking.this, R.raw.rightsound2);
                ourSong.start();
                AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
                dialogBuilder.setTitle("Good");dialogBuilder.setMessage("Correct");
                dialogBuilder.setIcon(R.drawable.ic_mark);
                dialogBuilder.show();
                Thread timer = new Thread(){
                    public void run(){
                        try{
                         sleep(2500);
                        }catch (InterruptedException e){
                            e.printStackTrace();
                        } finally {
                            Intent nextAct2 = new Intent(Cooking.this, LetterEx.class);
                            startActivity(nextAct2);
                            finish();

                        }
                    }
                };
                timer.start();

            }else{

                lv.setAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, results));
                counter_score +=0;
                txView.setId(0);
                counter_score_z +=0;
                ourSong = MediaPlayer.create(Cooking.this, R.raw.wrongsound);
                ourSong.start();
                AlertDialog dialogBuilder = new AlertDialog.Builder(this).create();
                dialogBuilder.setTitle("Oops,");
                dialogBuilder.setMessage("Error Msg");
                dialogBuilder.setIcon(R.drawable.ic_wrong);
                dialogBuilder.setButton("Continuar", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {

                        Intent openMovilTeacherApp = new Intent(Cooking.this, LetterEx.class);
                        startActivity(openMovilTeacherApp);
                        finish();
                    }
                });
                dialogBuilder.setButton2("Try again", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        // TODO Auto-generated method stub
                        dialog.dismiss();
                    }
                });
                dialogBuilder.show();
                Thread timer = new Thread(){
                    public void run(){
                        try{
                         sleep(4000);
                        }catch (InterruptedException e){
                            e.printStackTrace();
                        } finally {

                        }
                    }
                };
                timer.start();
            }

        }

        super.onActivityResult(requestCode, resultCode, data);

    }

} 
```

我的烹饪.xml

```
<ImageView android:src="@drawable/small_right_blue_mic"
        android:id="@+id/image_1_wrong" 
       android:layout_width="68dp"
        android:layout_height="68dp"
        android:layout_marginLeft="-150dp"
        android:layout_marginTop="15dp"
        android:visibility="invisible"/>

     <ImageView android:src="@drawable/small_right_blue_mic"
        android:id="@+id/image_2_wrong" 
       android:layout_width="52dp"
        android:layout_height="59dp"
        android:layout_marginLeft="-0dp"
        android:layout_marginTop="25dp"
        android:visibility="visible"/> 
```

错误日志

```
08-29 17:15:54.600: E/AndroidRuntime(1953): FATAL EXCEPTION: main
08-29 17:15:54.600: E/AndroidRuntime(1953): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=222, result=-1, data=Intent { (has extras) }} to activity {com.testapp.app/com.testapp.app.Cooking}: java.lang.NullPointerException 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:08:42.330

您的问题是您在本地定义了 image1 和 image2 。改成这样。而且您只需要使用一次 findviewbyid() 。够了

```
public class Cooking  extends Activity implements OnClickListener{

    ListView lv;
    static final int check = 1;
    static final int checka = 2;

    int counter_score;
     int counter_score_b;
    TextView txView;
    MediaPlayer ourSong;
    ImageView display,image1,image2;

@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        counter_score=0;
        counter_score_b=0;
        setContentView(R.layout.cooking);
        image1 = (ImageView) findViewById(R.id.image_1_wrong);
        image2 = (ImageView) findViewById(R.id.image_2_wrong);        
        initialize();

}

private void initialize() {
    // TODO Auto-generated method stub
    lv = (ListView)findViewById(R.id.lvVoiceReturn);
    txView = (TextView)findViewById(R.id.counter);

    image1.setOnClickListener(this);
    image2.setOnClickListener(this);

    ActionBar actionBar = getActionBar();
     actionBar.setDisplayHomeAsUpEnabled(false);

} 
```

# ruby-on-rails - 从 Rails 向 Unity3d WWW.error 提供有意义的错误消息

> ID：12169343
> 
> 赞同：1
> 
> 时间：2012-08-29T00:24:34.697
> 
> 标签：ruby-on-rails, unity3d

我正在学习如何从 Unity3d 将数据发布到 Web 服务器，作为为我的游戏创建排行榜的第一步。现在，我在 Unity 中有一个非常简单的脚本，可以将名称和分数发布到我的服务器。PostScoreURL 映射到 Rails 中的创建操作（当作为 POST 发送时）。它非常简单，但在基本层面上工作。

Unity 有一个 WWW 类，我用它来 POST 到服务器。此类具有错误属性，但始终显示为 500 Internal Server Error；如果成功创建用户或由于验证问题未创建用户，则会出现此错误。我想添加到我的 Rails 应用程序中，以便我可以将更有意义的错误消息发送回 Unity，以便用户知道发生了什么。例如，如果他们尝试创建一个已经存在的用户，则应该通知他们需要使用不同的名称。

这是我的代码： Unity 脚本：

```
string PostScoreURL = "http://localhost:3000/users";
string name = "Melanie";
int score = 8732;
WWW www;
bool requestSent = false;

void OnGUI()
{
    if (GUI.Button(new Rect(0, 0, 100, 100),"Post Score"))
    {
        WWWForm form = new WWWForm();
        form.AddField("user[name]", name);
        form.AddField("user[score]", score);

        www = new WWW(PostScoreURL,form);
        requestSent = true;
    }

    if(requestSent && www.isDone)
    {
        print (www.error);
        requestSent = false;
    }
} 
```

从 Rails 应用程序：user.rb：

```
class User < ActiveRecord::Base
    attr_accessible :name, :score
    validates_presence_of :name, :score
    validates_uniqueness_of :name
end 
```

这是我的创建操作：

```
def create
    @user = User.new(params[:user])
    @user.save
end 
```

我想将相关的错误消息发送回 Unity。例如：缺少用户名、缺少分数、使用的用户名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T15:12:36.773

您不应将*业务规则错误*视为*连接错误*，也就是说，这些错误应在服务器端处理，向客户端返回带有您定义的内部错误代码的“成功”响应。

我不知道 RoR，它可能让您在响应中定义错误代码，但在我的情况下（不使用 RoR），我们创建了一个带有错误代码的响应类，该错误代码被序列化并返回给客户端。之后，WWW 类调用一个解析器来验证错误代码。此外，WWW 会监视 WWW.error 上的连接错误。

# java - 防止倾斜调用 onCreate，以及运行活动的时间测量。

> ID：12169344
> 
> 赞同：1
> 
> 时间：2012-08-29T00:24:41.877
> 
> 标签：java, android, android-orientation

您好，提前感谢您的时间和关注。我实际上有 2 个问题，我不太确定构建一个 android 应用程序。我相信非常基本的东西：

1) 我的应用程序完全处于水平模式，例如 AngryBirds。当它启动时，用户发现他应该那样握住手机，如果他还没有的话。这是在清单中为所有活动设置的并且工作正常。但是有没有办法防止物理设备倾斜再次调用 onCreate ？我可以覆盖它的方法还是什么？我问的原因是因为我有一些 ButtonViews，在您单击它们后，更改它们的图片。我正在使用 onRetainNonConfigurationInstance() 来保存这些 ImageButtons 的数组，我什至使用 ImageButton setTag() 和 getTag() 方法标记更改的那些，因此当由于设备倾斜而调用 onCreate 时，它​​会从 getLastNonConfigurationInstance 获取保存的数组() ，但我一直在努力让它工作很长一段时间，我只是可以' 做对了。设备倾斜后（我实际上使用的是模拟器，所以它是 Ctrl+F11 但我相信它也会发生在设备上）所有的 ImageButtons 都会丢失他们的图片。长话短说 - 有没有更好的方法来做到这一点您可以推荐或阻止倾斜做任何可能或更好的事情？

2) 了解用户在屏幕上停留了多少秒的最佳方法是什么？我尝试使用通过 SystemClock.currentThreadTimeMillis() 获得的两个 long，如下所示：获取 onCreate 的开始时间，以及我调用的方法的结束时间，以便在我 startActivity 之前移动到第二个意图。但我认为因为它们是从不同的线程调用的，所以终点 - 起点是不正确的。什么方法可以确保 SystemClock.currentThreadTimeMillis() 的两个方法都是从同一个线程调用的，即我正在停止观看的活动的主线程？有没有更好的方法来解决这个问题？

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T00:33:31.120

1.  您正在做正确的处理方向变化。请参考此链接[http://developer.android.com/guide/topics/resources/runtime-changes.html](http://developer.android.com/guide/topics/resources/runtime-changes.html)。这将帮助您使其正常工作。

2.  好的方法是计算 onResume 和 onPause 之间的时间。如果您要恢复活动，则不会一直调用 OnCreate。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T00:30:51.270

1）您可以尝试将属性添加`android:configChanges="orientation"`到清单文件中的活动中。当我的动态操作栏标签在屏幕旋转时弄乱时，它对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T00:33:26.713

1.  您需要在 android manifest 中为每个活动指定方向，然后它不会调用 onCreate。`android:screenOrientation`看看[http://developer.android.com/guide/topics/manifest/activity-element.html](http://developer.android.com/guide/topics/manifest/activity-element.html)
2.  用户从 onResume 开始查看并与您的活动进行交互，并在 onPause 结束。其他时候，它不能保证用户实际看到并可以点击活动中的某些内容。System.getCurrentMillis() 已经足够好了。

# java - JLabel 对齐问题

> ID：12169346
> 
> 赞同：1
> 
> 时间：2012-08-29T00:25:06.990
> 
> 标签：java, swing, alignment, jlabel

所以，我有一个问题。我有一个`JPanel`（BoxLayout，Y_AXIS）。在其中，我有`JLabel`和`JTextArea`。`JTextArea`当我用文本填充它时自由扩展，`JPanel`用它扩展。

`JLabel`扩展到。只要文本与顶部垂直对齐就可以了。但是该命令由于某种原因不起作用（`setVerticalTextPosition`, `setVerticalAlignment`, `setAlignmentX`）。我认为第一个实际上是 Java 中的一个错误。

由于那不起作用，我尝试粘`JLabel`在顶部边框上。我还将所有三个设置`setXXSize`为 sam 值以保持大小`JLabel`不变​​。

但它只是不会粘住，取决于布局它要么捕捉到中心，要么只是填充整个`JPanel`.

现在，我不在乎如何，但我只需要几个在占用空间中顶部对齐的字母`JLabel`（我什至可以使用另一个 JTextComponent，如果它会有所不同的话）。有没有办法做到这一点？

我会为你提供代码，但这几乎就是我上面写的，而且由于它`JPanel`是更复杂的 GUI 的一部分，我真的必须给你整个代码......（我会的，如果它将需要。）

```
package core;

import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Component;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.awt.event.WindowEvent;
import java.awt.event.WindowListener;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Locale;
import java.util.Properties;
import java.util.ResourceBundle;

import javax.swing.BorderFactory;
import javax.swing.Box;
import javax.swing.BoxLayout;
import javax.swing.ButtonGroup;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;
import javax.swing.JRadioButton;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.KeyStroke;
import javax.swing.border.Border;
import javax.swing.text.AbstractDocument;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.DocumentFilter;

@SuppressWarnings("serial")
class DefaultFont extends Font
{
    public DefaultFont()
    {
        super("Arial", PLAIN, 20);
    }
}

@SuppressWarnings("serial")
class Page extends JPanel
{
    public JPanel largePage;
    public int content;

    public Page(JPanel panel, int index)
    {
        largePage = new JPanel();
        largePage.setLayout(new BoxLayout(largePage, BoxLayout.Y_AXIS));
        largePage.setMaximumSize(new Dimension(794, 1123));
        largePage.setPreferredSize(new Dimension(794, 1123));
        largePage.setAlignmentX(Component.CENTER_ALIGNMENT);
        largePage.setBackground(Color.WHITE);
        largePage.add(new Box.Filler(new Dimension(0, 96), new Dimension(0, 96), new Dimension(0, 96)));

        setMaximumSize(new Dimension(556, 931));
        setBackground(Color.LIGHT_GRAY);
        setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));
        add(new Box.Filler(new Dimension(556, 0), new Dimension(556, 931), new Dimension(556, 931)));

        largePage.add(this);
        largePage.add(new Box.Filler(new Dimension(0, 96), new Dimension(0, 96), new Dimension(0, 96)));

        panel.add(largePage, index);
        panel.add(new Box.Filler(new Dimension(0, 40), new Dimension(0, 40), new Dimension(0, 40)));

        content = 0;

        Main.pages.add(this);
    }
}

@SuppressWarnings("serial")
class Heading extends JTextArea
{
    public boolean type;
    public AbstractDocument doc;
    public ArrayList<JPanel/*Question*/> questions;
    public ArrayList<JPanel/*List*/> list;  

    public Heading(boolean segment, Page page)
    {
        type = segment;

        setBackground(Color.RED);
        setFont(new Font("Arial", Font.BOLD, 20));

        Border in = BorderFactory.createDashedBorder(Color.BLACK);
        Border out = BorderFactory.createMatteBorder(0, 0, 10, 0, Color.WHITE);

        setBorder(BorderFactory.createCompoundBorder(out, in));
        setLineWrap(true);
        setWrapStyleWord(true);

        setText("Heading 1 Heading 1 Heading 1 Heading 1");

        doc = (AbstractDocument)this.getDocument();
        doc.setDocumentFilter(new DocumentFilter()
        {
            public void insertString(FilterBypass fb, int offs,String str, AttributeSet a) throws BadLocationException 
            {
                if ((fb.getDocument().getLength() + str.length()) <= 150)
                {
                    ;
                    fb.insertString(offs, str.replaceAll("\n", " "), a);
                }
                else
                {
                    int spaceLeft = 150 - fb.getDocument().getLength();
                    if (spaceLeft <= 0)
                        return;

                    fb.insertString(offs, str.substring(0,spaceLeft).replaceAll("\n", " "), a);
                }
            }

            public void replace(FilterBypass fb, int offs, int length, String str, AttributeSet a) throws BadLocationException 
            {
                if (str.equals("\n"))
                { 
                    str = "";
                }
                if ((fb.getDocument().getLength() + str.length() - length) <= 150)
                {
                    fb.replace(offs, length, str.replaceAll("\n", " "), a);
                }
                else
                {
                    int spaceLeft = 150 - fb.getDocument().getLength() + length;
                    if (spaceLeft <= 0)
                        return;

                    fb.replace(offs, length, str.substring(0,spaceLeft).replaceAll("\n", " "), a);
                }
            }
        });

        page.add(this, 0);
        page.content++;

        if (type)
        {
            questions = new ArrayList<JPanel>();
        }
        else
        {
            list = new ArrayList<JPanel>();
        }
    }
}

@SuppressWarnings("serial")
class Question extends JPanel
{
    public JPanel questionArea, numberArea, answerArea;
    public JLabel number;
    public JTextArea question;

    public Question(Page page, int pageNum, int index)
    {
        setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));

        questionArea = new JPanel();
        questionArea.setLayout(new BoxLayout(questionArea, BoxLayout.X_AXIS));

        numberArea = new JPanel();
        numberArea.setLayout(new BoxLayout(numberArea, BoxLayout.Y_AXIS));
        numberArea.setBackground(Color.YELLOW);

        number = new JLabel(pageNum+".", JLabel.RIGHT);
        number.setMinimumSize(new Dimension(100, 20));
        number.setPreferredSize(new Dimension(100, 20));
        number.setMaximumSize(new Dimension(100, 20));
        //number.setAlignmentX(TOP_ALIGNMENT);
        number.setFont(new Font("Arial", Font.PLAIN, 18));
        number.setBackground(Color.BLUE);

        numberArea.add(number);

        //numberArea.add(new Box.Filler(new Dimension(40, 0), new Dimension(40, 30), new Dimension(40, 300)), BorderLayout.CENTER);

        questionArea.add(numberArea);

        question = new JTextArea();
        question.setFont(new Font("Arial", Font.PLAIN, 18));
        question.setLineWrap(true);
        question.setWrapStyleWord(true);
        question.setBackground(Color.GREEN);

        question.setText("dafd afdfd fasdfsdaah fg dfgd");

        questionArea.add(question);

        add(questionArea);
        page.add(this, index);
    }
}

public class Main
{

    public static Properties config;
    public static Locale currentLocale;
    public static ResourceBundle lang;

    public static JFrame mWindow;

    public static JMenuBar menu;
    public static JMenu menuFile, menuEdit;
    public static JMenuItem itmNew, itmClose, itmLoad, itmSave, itmSaveAs, itmExit, itmCut, itmCopy, itmPaste, itmProperties; 

    public static JDialog newDoc;
    public static JLabel newDocText1, newDocText2;
    public static JRadioButton questions, list;
    public static ButtonGroup newDocButtons;
    public static JButton newDocOk;
    public static Boolean firstSegment;

    public static JPanel workspace;
    public static JScrollPane scroll;
    public static ArrayList<Page> pages;

    public static void newDocumentForm()
    {
        //new document dialog
        mWindow.setEnabled(false);

        newDoc = new JDialog(mWindow, "newDoc");
        newDoc.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        newDoc.addWindowListener(new WindowListener ()
        {
            public void windowActivated(WindowEvent arg0) {}
            public void windowClosing(WindowEvent arg0)
            {
                mWindow.toFront();

                newDocText1 = null;
                newDocText2 = null;
                questions = null;
                list = null;
                newDocButtons = null;
                newDocOk = null;
                newDoc.dispose();

                mWindow.setEnabled(true);               
            }

            public void windowClosed(WindowEvent arg0) {}
            public void windowDeactivated(WindowEvent arg0) {}
            public void windowDeiconified(WindowEvent arg0) {}
            public void windowIconified(WindowEvent arg0) {}
            public void windowOpened(WindowEvent arg0) {}   
        });

        newDoc.setSize(400, 200);
        newDoc.setLocationRelativeTo(null);
        newDoc.setResizable(false);
        newDoc.setLayout(null);
        newDoc.setVisible(true);

        newDocText1 = new JLabel("newDocText1");
        newDocText1.setBounds(5, 0, 400, 20);

        newDocText2 = new JLabel("newDocText2");
        newDocText2.setBounds(5, 20, 400, 20);

        newDoc.add(newDocText1);
        newDoc.add(newDocText2);

        firstSegment = true;

        questions = new JRadioButton("questions");
        questions.setSelected(true);
        questions.setFocusPainted(false);
        questions.setBounds(10, 60, 400, 20);
        questions.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent arg0)
            {
                firstSegment = true;
            }
        });

        list = new JRadioButton("list");
        list.setFocusPainted(false);
        list.setBounds(10, 80, 400, 20);
        list.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent arg0)
            {
                firstSegment = false;
            }
        });

        newDoc.add(questions);
        newDoc.add(list);

        newDocButtons = new ButtonGroup();
        newDocButtons.add(questions);
        newDocButtons.add(list);

        newDocOk = new JButton("ok");
        newDocOk.addKeyListener(new KeyListener()
        {
            public void keyPressed(KeyEvent e)
            {
                if (e.getKeyCode() == KeyEvent.VK_ENTER)
                {
                    newDocOk.doClick();
                }
            }

            public void keyReleased(KeyEvent e) {}
            public void keyTyped(KeyEvent e) {}
        });

        newDocOk.setFocusPainted(false);
        newDocOk.setBounds(160, 120, 80, 40);
        newDocOk.setMnemonic(KeyEvent.VK_ACCEPT);
        newDocOk.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent arg0)
            {
                createNewDocument();
            }
        });

        newDoc.add(newDocOk);
        newDocOk.requestFocus();
    }

    public static void createNewDocument()
    {
        //dispose of new document dialog
        mWindow.toFront();

        newDocText1 = null;
        newDocText2 = null;
        questions = null;
        list = null;
        newDocButtons = null;
        newDocOk = null;
        newDoc.dispose();

        mWindow.setEnabled(true);

        //create document display               
        workspace = new JPanel();
        workspace.setLayout(new BoxLayout(workspace, BoxLayout.PAGE_AXIS));
        workspace.add(new Box.Filler(new Dimension(0, 40), new Dimension(0, 40), new Dimension(0, 40)));
        workspace.setBackground(Color.BLACK);

        scroll = new JScrollPane(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS, JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
        scroll.getVerticalScrollBar().setUnitIncrement(20);
        scroll.setViewportView(workspace);

        pages = new ArrayList<Page>();

        @SuppressWarnings("unused")
        Page p = new Page(workspace, 1);

        Heading g = new Heading(true, p);

        Question q = new Question(p, 1, 1);

        mWindow.add(scroll, BorderLayout.CENTER);
        mWindow.repaint();
        mWindow.validate();

    }

    public static void main(String[] args) throws FileNotFoundException, IOException
    {   

        //create main window
        mWindow = new JFrame("title");
        mWindow.setSize(1000, 800);
        mWindow.setMinimumSize(new Dimension(1000, 800));
        mWindow.setLocationRelativeTo(null);
        mWindow.setLayout(new BorderLayout());
        mWindow.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        mWindow.setVisible(true);

        //create menu bar
        menu = new JMenuBar();

        menuFile = new JMenu("file");
        menuEdit = new JMenu("edit");

        itmNew = new JMenuItem("new");
        itmNew.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_N, ActionEvent.CTRL_MASK));
        itmNew.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent e)
            {
                newDocumentForm();
            }
        });

        itmClose = new JMenuItem("close");
        itmClose.setActionCommand("Close");
        itmClose.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_W, ActionEvent.CTRL_MASK));

        itmLoad = new JMenuItem("load");
        itmLoad.setActionCommand("Load");
        itmLoad.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_L, ActionEvent.CTRL_MASK));

        itmSave = new JMenuItem("save");
        itmSave.setActionCommand("Save");
        itmSave.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_S, ActionEvent.CTRL_MASK));

        itmSaveAs = new JMenuItem("saveAs");
        itmSaveAs.setActionCommand("SaveAs");
        itmExit = new JMenuItem("exit");
        itmExit.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent e)
            {
                //Add confirmation window!
                System.exit(0);
            }
        });

        itmCut = new JMenuItem("cut");
        itmCut.setActionCommand("Cut");
        itmCut.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_X, ActionEvent.CTRL_MASK));

        itmCopy = new JMenuItem("copy");
        itmCopy.setActionCommand("Copy");
        itmCopy.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C, ActionEvent.CTRL_MASK));

        itmPaste = new JMenuItem("paste");
        itmPaste.setActionCommand("Paste");
        itmPaste.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_V, ActionEvent.CTRL_MASK));

        itmProperties = new JMenuItem("properties");
        itmProperties.setActionCommand("properties");
        itmProperties.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_P, ActionEvent.CTRL_MASK));

        menuFile.add(itmNew);
        menuFile.add(itmClose);
        menuFile.addSeparator();
        menuFile.add(itmLoad);
        menuFile.addSeparator();
        menuFile.add(itmSave);
        menuFile.add(itmSaveAs);
        menuFile.addSeparator();
        menuFile.add(itmExit);

        menuEdit.add(itmCut);
        menuEdit.add(itmCopy);
        menuEdit.add(itmPaste);
        menuEdit.addSeparator();
        menuEdit.add(itmProperties);

        menu.add(menuFile);
        menu.add(menuEdit);

        //create actionListener for menus

        mWindow.add(menu, BorderLayout.NORTH);

        mWindow.repaint();
        mWindow.validate();
    }
} 
```

这是我能做的最好的，请参阅问题类。要绘制 GUI，运行它，按 ctrl+n，然后输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T00:59:35.460

据我了解，您想要实现这一目标：

![在此处输入图像描述](../Images/26f0efc22d947fc3448fb23a590bfd82.png)

如果这是真的，那么您所要做的就是：

```
numberArea.setLayout(new BorderLayout()); 
```

和

```
numberArea.add(number,BorderLayout.NORTH); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:02:57.233

正如 brano88 建议的那样，更改布局管理器...

```
public Question(Page page, int pageNum, int index) {
    setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));

    questionArea = new JPanel();
    questionArea.setLayout(new GridBagLayout());

    numberArea = new JPanel();
    numberArea.setLayout(new BoxLayout(numberArea, BoxLayout.Y_AXIS));
    numberArea.setBackground(Color.YELLOW);

    number = new JLabel(pageNum + ".", JLabel.RIGHT);
    number.setMinimumSize(new Dimension(100, 20));
    number.setPreferredSize(new Dimension(100, 20));
    number.setMaximumSize(new Dimension(100, 20));
    //number.setAlignmentX(TOP_ALIGNMENT);
    number.setFont(new Font("Arial", Font.PLAIN, 18));
    number.setBackground(Color.BLUE);

    numberArea.add(number);

    //numberArea.add(new Box.Filler(new Dimension(40, 0), new Dimension(40, 30), new Dimension(40, 300)), BorderLayout.CENTER);

    GridBagConstraints gbc = new GridBagConstraints();
    gbc.gridx = 0;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.VERTICAL;
    gbc.anchor = GridBagConstraints.NORTH;
    questionArea.add(numberArea, gbc);

    question = new JTextArea();
    question.setFont(new Font("Arial", Font.PLAIN, 18));
    question.setLineWrap(true);
    question.setWrapStyleWord(true);
    question.setBackground(Color.GREEN);

    question.setText("dafd afdfd fasdfsdaah fg dfgd");

    gbc.gridx = 1;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.BOTH;
    gbc.weightx = 1;
    gbc.weighty = 1;
    gbc.anchor = GridBagConstraints.NORTH;
    questionArea.add(question, gbc);

    add(questionArea);
    page.add(this, index);
} 
```

# windows - 无论锁定状态如何，都写入锁定文件

> ID：12169349
> 
> 赞同：3
> 
> 时间：2012-08-29T00:25:45.790
> 
> 标签：windows, batch-file, cmd

无论打开什么程序/进程，有没有办法写入锁定的文件？

设想：

*   作为服务运行的商业产品会锁定日志文件。
*   服务不能停止，因为它会影响客户。
*   想在文件末尾注入一行作为标记。

出现错误：该进程无法访问该文件，因为它正被另一个进程使用。

有没有办法在锁定的文件上附加一行？

另外，害怕打破锁定状态，因为它可能会导致商业程序崩溃。

本来想批处理文件，直到发现日志文件被锁定。会做 powershell 或任何可以解决这个问题的语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:39:52.843

**不**，lock(ed)文件的整体思路是，拥有锁的进程不必担心其他进程修改文件，因此锁的拥有者不必一直查询文件系统，可以做到它的运营效率更高。
并查看“David Schwartz”和“Ken White”的早期评论

# web-services - 返回 Pojo WebService JaxWS。重命名 节点

> ID：12169350
> 
> 赞同：3
> 
> 时间：2012-08-29T00:26:06.240
> 
> 标签：web-services, jaxb, jax-ws, pojo

我认为这应该很容易，但我真的无法让它发挥作用。

我正在从 WebMethod 返回一个 Pojo：

```
@WebMethod
public SubCategoria getSubCategorias() throws JAXBException {

    SubCategoria a = subCategoriaEJB.getAllSubCategorias().get(1);

    return a;
} 
```

我只是返回第一个，尝试。

我使用soapUI 来测试我的Ws。

回应是：

```
 <S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
       <S:Body>
          <ns2:getSubCategoriasResponse xmlns:ns2="http://webService/">
             <return>
                <categoria>
                   <descripcion>Categoria Unica</descripcion>
                   <idCategoria>1</idCategoria>
                </categoria>
                <descripcion>asd123213</descripcion>
                <idSubCategoria>2</idSubCategoria>
             </return>
          </ns2:getSubCategoriasResponse>
       </S:Body>
    </S:Envelope> 
```

我希望将该“返回”节点称为“子类别”。我不能真正使它与 XmlRootElement 注释一起使用。

这是我的 Pojo（子类别）

```
 package ejb.Entidades;

    import javax.persistence.Entity;
    import javax.persistence.Id;
    import javax.persistence.ManyToOne;
    import javax.xml.bind.annotation.XmlRootElement;

    @Entity
    @XmlRootElement(name="SubCategoria")
    public class SubCategoria {

        @Id
        private Integer idSubCategoria;

        @ManyToOne 
        private Categoria categoria;

        private String descripcion;

        public Integer getIdSubCategoria() {
            return idSubCategoria;
        }
        public void setIdSubCategoria(Integer idSubCategoria) {
            this.idSubCategoria = idSubCategoria;
        }

        public String getDescripcion() {
            return descripcion;
        }
        public void setDescripcion(String descripcion) {
            this.descripcion = descripcion;
        }
        public Categoria getCategoria() {
            return categoria;
        }
        public void setCategoria(Categoria categoria) {
            this.categoria = categoria;
        }

    } 
```

有线索的人？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T16:17:54.010

您应该使用`@WebResult`注释：

```
@WebMethod
@WebResult(name = "subCategoria")
public SubCategoria getSubCategorias() throws JAXBException {

    SubCategoria a = subCategoriaEJB.getAllSubCategorias().get(1);

    return a;
} 
```

# java - Java ImageIcon.GetImage 挂起

> ID：12169353
> 
> 赞同：0
> 
> 时间：2012-08-29T00:26:35.273
> 
> 标签：java, image, swing, awt

我在使用 ImageIcon().GetImage() 时遇到问题

奇怪的是，它有时可以工作并显示带有地图的窗口，而其他时候则不能。它也可以完美地在其他计算机上运行，​​但不能在我的计算机上运行！

我已经尝试了一切，重新安装 Java，重新安装 IntelliJ，还禁用了我的防火墙，但无济于事。我还在 C# 中编写了一个类似的程序，它运行良好，这让我相信这不是权限错误。我还在带有板载显卡的基本 Windows XP 系统上对其进行了测试，该显卡也可以完美运行。

这是我的代码：

```
public class main {

public static void main(String[] args) {
    System.out.println("Running main..");
    try
    {
        URL url = new URL("http://maps.googleapis.com/maps/api/staticmap?center=-33.80382155278416,18.567184266922002&zoom=17&size=1024x1024&maptype=hybrid&sensor=false&format=png&key=AIzaSyCVnp9iTXRSS3ZE5FjzF7uNZavazWhLko4");
        Image img=new ImageIcon(url).getImage();
        System.out.println("INFO :"+img);
        new ImageFrame(img);

    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
}

public static class ImageFrame extends JFrame{

    public ImageFrame(Image img){

        setPreferredSize(new Dimension(540, 480));
        setaImg(img);
        ImagePanel somePanel = new ImagePanel(540, 480);
        add(somePanel);
        setVisible(true);
    }

    private Image aImg;

    public Image getaImg() {
        return aImg;
    }

    public void setaImg(Image aImg) {
        this.aImg = aImg;
    }

    public class ImagePanel extends JPanel{

        public ImagePanel(int width, int height){
            setPreferredSize(new Dimension(width, height));
        }

        @Override
        public void paintComponent(Graphics g) {
            super.paintComponent(g);
            g.drawImage(getaImg(), 0, 0, null); // see javadoc for more info on the parameters
        }
    }

}

 } 
```

我已经通过调试器运行了它，它停在这一行：

```
Image img=new ImageIcon(url).getImage(); 
```

但没有错误，它只是永远挂起。

我完全不明白为什么它不能在我的系统上运行，而且只能在我的系统上运行。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T00:34:45.213

对我来说很好

![在此处输入图像描述](../Images/083f00f391d78b06e2549ff42420c3dd.png)

谷歌没有阻止你是他们吗？从记忆中，您每天大约有 10,000 个查询。

尝试使用`InputStream`( `URL.openStream()`) 手动下载 URL，看看您是否收到了除图像二进制文件之外的某种响应。

**更新**

经过调查，发现是 Java 7 和 IPv6 的问题，如此处所述[使用 Java 下载文件随机冻结](https://stackoverflow.com/questions/11650375/downloading-files-using-java-randomly-freezes)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T01:11:07.473

始终在 EDT 上启动和更新 GUI。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

* * *

```
g.drawImage(getaImg(), 0, 0, null); // see javadoc for more info on the parameters 
```

该评论是非常好的建议，因为 4 字符编辑应该可以解决问题。

```
g.drawImage(getaImg(), 0, 0, this); // Observer is good for asynchronous image load 
```

# java - 这是创建 12 个字符串对象吗？

> ID：12169355
> 
> 赞同：0
> 
> 时间：2012-08-29T00:26:59.943
> 
> 标签：java

我试图了解下面的代码是否为像“stephan”这样的字符串创建了 12 个对象

```
public String reverse(String str) {
            if ((null == str) || (str.length()  <= 1)) {
                return str;
            }
            return reverse(str.substring(1)) + str.charAt(0);
        } 
```

这递归地反转一个字符串。我明白它是如何工作的。但是我在想，在这种情况下，字符串的长度和通过连接创建的字符串对象的数量之间是否存在关系？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T00:30:39.553

是的，它会创建大量的字符串对象。

对“reverse()”的每次递归调用都会创建 2：

1.  `str.substring(1)`将创建一个新的 String 对象

2.  `reverse()`call 将为其返回值创建一个新字符串，但我们不会计算它，因为在分析该递归调用时会计算它（例如，它将是来自下一次`reverse()`调用的要点＃3 的字符串）。

3.  由于 Java 字符串[是不可变](http://javarevisited.blogspot.com/2010/10/why-string-is-immutable-in-java.html)的，通过 "" 添加一个字符`+`将创建**第二个**字符串对象。

因此，对于长度为 N 的字符串，它将创建 (N-1)*2 个对象（因为 1-char 字符串的反转不会创建新字符串）；**所以对于“stephan”的 7 个字符，它将创建 6*2=12 个字符串对象。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:16:56.270

定理：

*   当字符串是`N`字符长时，@Phoenix 的`reverse`实现将创建`(N-1)*3`新对象。

证明（通过归纳）：

*   str 为 1 个字符时，直接返回。`(1*1)*3 = 0`.
*   当 str 为 N 个字符时：
    *   一个新`String`的将由`.substring(1)`.
    *   根据归纳假设，调用`reverse(...)`将在`(N-2)*3`对象创建后返回。
    *   `StringBuilder`将创建一个新的来附加字符串和首先`char`（您可以通过反编译您的字节码来看到这一点）。
    *   一个新`String`的将由`StringBuilder.toString()`--this 创建，这是返回值。
    *   总而言之，`3 + (N-2)*3 = (N-2 + 1)*3 = (N-1)*3`创建了对象。
*   QED。

* * *

[编辑] StringBuilders：

*   StringBuilder（扩展 AbstractStringBuilder）做了自己的花哨的步法：
    *   当 an`StringBuilder`被构造时，它被初始化`char[]`为大小为 16 的 a。
    *   当您附加的内容超过其当前大小时，它会将其丢弃并创建一个新`char[]`的 size `(<old size> + <size of new data> + 1) * 2`。
*   因此，只要您的输入字符串大于 16 个字符，您的 StringBuilder 容量就基本上是您需要的 2 倍。（当输入字符串的大小更小时，你得到的`char[]`比你需要的多。）
*   考虑到`String`s 本质上是`char[]`s （用几个`int`s 来衡量），你`char[]`在每一步都有效地使用了 s 中子字符串长度的 4 倍。:(

# xslt - 如果 value 不是以下任何 XSLT

> ID：12169370
> 
> 赞同：1
> 
> 时间：2012-08-29T00:29:30.780
> 
> 标签：xslt, xpath

如果出现以下情况，我试图在 XSLT 中表示以下内容：

```
if (status != Disconnected || status != BadNumber || status != NoCallsAccepted || status != Fax) 
```

我知道这可以用`choose`表达式来完成，但我不想在模板中添加这么多的冗长......

我在适当的时候使用 AND 和 OR 尝试了以下不同的变体：

```
<xsl:if test="not(@status = 'BadNumber') AND not(@status = 'Disconnected') AND not( @status =  'NoCallsAccepted') AND not(@status = 'Fax')"> 
```

但这会导致语法错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:49:57.417

我发现我的错误......大写和。

```
<xsl:if test="@status != 'BadNumber' and @status != 'Disconnected' and @status !=  'NoCallsAccepted'and @status != 'Fax'"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T12:42:48.063

**这可以用更紧凑的形式表示为**：

```
<xsl:if test=
 "not(contains('|BadNumber|Disconnected|NoCallsAccepted|Fax|',
               concat('|', @status,'|')
               ))"> 
```

**在 XPath 2.0 (XSLT 2.0) 中，甚至可以使用更紧凑的表达式：**

```
<xsl:if test="not(@status=('BadNumber','Disconnected','NoCallsAccepted','Fax'))"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:09:25.117

如果您使用 XSLT 2.0，您可以简化：

```
<xsl:if test="not(@status=('BadNumber','Disconnected','NoCallsAccepted','Fax'))"> 
```

# tomcat - 为 Spring 集成设置 JavaMail 代理

> ID：12169371
> 
> 赞同：2
> 
> 时间：2012-08-29T00:29:32.167
> 
> 标签：tomcat, proxy, jakarta-mail, spring-integration

我创建了一个 Spring Integration 流程来以编程方式处理电子邮件。它在我的 IDE 中运行良好，但是当我将它部署到我们的 Tomcat Unix 服务器时失败。我正在运行 JDK 1.6.0.4、Tomcat 7.0.29、Grails 2.0.4、Spring Integration 2.1.3 和 JavaMail 1.4.5。我试图弄清楚如何配置代理设置以便我可以运行它。我看过 2010 年的帖子说这是不可能的，但现在看起来有 JavaMail 属性。

我确实尝试`-DsocksProxyHost=myproxy.mycompany.com`在 Tomcat 中进行设置`setenv.sh`，但我的应用程序在到达邮件部分之前就失败了，因为它无法访问内部站点（比如我们的数据库连接）

我查看了[JavaMail API - FAQ](http://www.oracle.com/technetwork/java/javamail/faq/index.html#proxy)并且我认为我设置正确，但它一直超时。

有没有人为 Spring Integration 流程成功设置了电子邮件代理？

我的 Spring Integration XML 文件中的片段：

```
<util:properties id="javaMailProperties">
    <prop key="mail.imap.socketFactory.class">javax.net.ssl.SSLSocketFactory</prop>
    <prop key="mail.imap.socketFactory.fallback">false</prop>
    <prop key="mail.store.protocol">imaps</prop>
    <prop key="mail.debug">true</prop>
    <prop key="mail.smtp.socks.host">socksproxy.mycompany.com</prop>
    <prop key="mail.smtp.socks.port">1080</prop>
    <prop key="mail.imap.socks.host">socksproxy.mycompany.com</prop>
    <prop key="mail.imap.socks.port">1080</prop>
</util:properties>

<mail:inbound-channel-adapter id="imapAdapter"
                              store-uri="imaps://myEmailAddress:myPassword@imap.gmail.com/INBOX"
                              java-mail-properties="javaMailProperties"
                              channel="receiveEmailChannel"
                              should-delete-messages="false"
                              should-mark-messages-as-read="true"
                              auto-startup="true">
    <int:poller max-messages-per-poll="1" fixed-rate="15" time-unit="SECONDS">
    </int:poller>
</mail:inbound-channel-adapter> 
```

# 解决方案

根据 Bill Shannon 的回复，我将我的更新`javaMailProperties`为下面的代码片段，一切都按预期工作。

```
<util:properties id="javaMailProperties">
    <prop key="mail.store.protocol">imaps</prop>
    <prop key="mail.imap.ssl.enable">true</prop>
    <prop key="mail.debug">true</prop>
    <prop key="mail.imaps.socks.host">socksproxy.mycompany.com</prop>
    <prop key="mail.imaps.socks.port">1080</prop>
</util:properties> 
```

我认为指出[JavaDocs](http://javamail.kenai.com/nonav/javadocs/com/sun/mail/imap/package-summary.html)中的细则很重要......

> **请注意，如果您使用“imaps”协议通过 SSL 访问 IMAP，则所有属性都将命名为“mail.imaps.*”**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T01:11:12.247

至少有两个问题...

首先，[您不需要套接字出厂设置](http://www.oracle.com/technetwork/java/javamail/faq/index.html#commonmistakes)。

其次，您正在使用`imaps`协议，但为协议设置属性`imap`。

设置`mail.store.protocol`为`imap`并设置`mail.imap.ssl.enable`为`true`，或将所有`mail.imap.*`属性更改为`mail.imaps.*`属性。

# arrays - Arduino PROGMEM 字节数组

> ID：12169374
> 
> 赞同：3
> 
> 时间：2012-08-29T00:29:41.263
> 
> 标签：arrays, arduino

考虑这个片段，用 Arduino IDE 编译：

```
PROGMEM  char charSet[]  = { 0x0, 0x8, 0x4, 0xc, 0x2, 0xA , 0x6, 0xE, 0x1, 0x9,0x5, 0xD, 0x3,0xB,0x7,0xF };
char reversed[]          = { 0x0, 0x8, 0x4, 0xc, 0x2, 0xA , 0x6, 0xE, 0x1, 0x9,0x5, 0xD, 0x3,0xB,0x7,0xF };
char ff;

for (int i=0; i < 16; i++) {
    Serial.print(" ");
    Serial.print(reversed[i], HEX);
}

Serial.println(" ");
for (int i=0; i < 16; i++) {
    Serial.print(" ");
    ff = pgm_read_byte(&charSet[i]);
    Serial.print(ff);
} 
```

我希望这两个 for 循环产生相同的输出。但输出是：

```
 0 8 4 C 2 A 6 E 1 9 5 D 3 B 7 F
  FFFFFF94 FFFFFFB0 6 FFFFFF80 FFFFFF91 FFFFFFC7 3 62 FFFFFFE3 E FFFFFF94 5E 29 FFFFFF99 23 39 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T20:07:11.457

是的，`const`缺少关键字。

使用 可能不是一个好主意，因为它在 gcc-avr 中`prog_char`被标记为*已弃用，请参阅*[avr/pgmspace.h](http://www.nongnu.org/avr-libc/user-manual/group__avr__pgmspace.html#gaa475b6b81fd8b34de45695da1da523b6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T07:50:53.323

答案就是 PROGMEM 声明。我不得不将它从函数中移出，添加`const`关键字。作为数据类型的其他更改不起作用。

完整的答案在[Arduino 论坛上](http://arduino.cc/forum/index.php/topic,120603.0.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T20:20:32.800

你有错误的数据类型。从[http://arduino.cc/en/Reference/PROGMEM](http://arduino.cc/en/Reference/PROGMEM)：

> 使用普通数据类型进行程序内存调用会产生一些神秘的错误。

你不能使用`char`——你必须使用`prog_char`

所以：

```
PROGMEM prog_char charSet[] = {0x0, 0xB} 
```

那应该行得通。

顺便说一句：你不必做`Serial.println(" ");` 你可以做`Serial.println();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T20:23:26.103

```
PROGMEM  char charSet[] = ... 
```

这不好 - 对于 PROGMEM 数据，您不能使用普通的内存类型。你应该做的是

```
PROGMEM  prog_char charSet[] = ... 
```

# ruby-on-rails - Rails rspec capybara - 用于#的未定义方法`sign_out' （无方法错误）

> ID：12169375
> 
> 赞同：0
> 
> 时间：2012-08-29T00:29:42.543
> 
> 标签：ruby-on-rails, ruby, rspec, capybara

作为请求规范的一部分，我试图注销用户：

```
sign_out @user 
```

但我得到了错误

```
undefined method `sign_out' for #<Class:0x000000099a4b20> (NoMethodError) 
```

代码：

```
require 'spec_helper'

include Warden::Test::Helpers

...

  before(:each) do
    @admin = Factory(:admin_user)
    sign_in @admin
  end

...
  context "When Admin users logout they are returned to the admin login." do
    before(:each) do
      sign_out(:user)
    end
    subject { current_path }
    it { should == new_admin_user_session_path }
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:59:56.037

AFAICT，`devise`提供了一个`sign_out`助手，但`warden`提供了一个`logout`助手。

*   [http://rdoc.info/github/plataformatec/devise/Devise/TestHelpers](http://rdoc.info/github/plataformatec/devise/Devise/TestHelpers)
*   [http://rdoc.info/github/hassox/warden/master/Warden/Test/Helpers](http://rdoc.info/github/hassox/warden/master/Warden/Test/Helpers)

只是一些快速的谷歌搜索，我不是专家。

# c++ - c++ 对 `my_map[i] = my_map.size()` 做了什么？

> ID：12169385
> 
> 赞同：2
> 
> 时间：2012-08-29T00:31:11.080
> 
> 标签：c++

```
std::map<int, int> my_map;
my_map[0] = my_map.size(); 
```

那么，将`my_map[0]`是`0`或`1`，还是未定义？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T00:46:30.660

除非您的编译器提供保证，否则这两种方式都无法保证。C++ 标准没有。

如果您需要`my_map.operator [](0)`先评估，请编写：

```
int& m0 = my_map[0]; 
m0 = my_map.size(); 
```

如果您需要`my_map.size()`先评估，请编写：

```
int s = my_map.size();
my_map[0] = s; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-29T00:35:41.890

*这里**没有**序列点*，因此未指定求值顺序（或者，在 C++11 行话中，这两个表达式是*不确定的序列*）。的值`my_map[0]`是`0`或`1`取决于实现。

*   [`my_map[0]`](http://www.cplusplus.com/reference/stl/map/operator%5b%5d/)如果先评估，将增加大小，导致`my_map.size()`评估为`1`. `my_map[0]`然后将`1`。
*   但是，如果`my_map.size()`首先评估，那么 的值`my_map[0]`将是`0`。

现在，如何使上述行为*明确*？您必须引入一个序列点，即强制一个表达式在另一个表达式之前进行排序；对于像第一个这样的行为，

```
int& val = my_map[0];
val = my_map.size(); 
```

...或者，对于第二个这样的行为，

```
int sz = my_map.size();
my_map[0] = sz; 
```

确保支持 Oo Tiib 成为第一个演示如何为表达式引入排序的人 :-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T00:34:12.230

您的

```
my_map[0] = my_map.size(); 
```

相当于

```
my_map.operator [](0) = my_map.size(); 
```

赋值运算符是`int`.

未指定首先评估内置赋值的哪一侧。因此，未指定将分配 0 还是 1。

# visual-studio-2012 - VS2012 IIS Express 选项已禁用

> ID：12169392
> 
> 赞同：7
> 
> 时间：2012-08-29T00:33:03.217
> 
> 标签：visual-studio-2012, iis-express

我刚刚安装了 VS2012 并创建了一个 MVC 项目。我右键单击项目并选择属性，我选择了 Web 选项卡。我选择了“使用本地 IIS Web 服务器”，但禁用了“使用 IIS Express”复选框。

我检查了我的`C:\Program Files (x86)\IIS Express\`文件夹，那里有 IIS Express 8。

有什么特别的原因吗？

* * *

如果我回退到使用 Visual Studio 开发服务器，我有 50% 的机会看到“服务器太忙”消息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T15:48:07.303

您所要做的就是在您的开发机器中激活 IIS：

开始 -> 控制面板 -> 启用或禁用 Windows 功能 -> Internet 服务

然后勾选万维网服务 -> 通用 HTTP 功能

并勾选万维网服务 -> 应用程序开发功能

这就是你所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-19T17:54:40.373

使用完整 IIS 有一些好处。一是它始终在运行，因此您不必启动您的 VStudio 项目来进行单元测试。另一个是您可以使用相同的管理工具创建一个实际站点并配置 IIS 镜像生产，这使得在环境中部署时更易于支持。而且，我似乎记得 IISExpress 在应用程序路由方面存在问题。另一方面，我没有看到使用完整 IIS 的问题。诚然，IISExpress 比 Cassini 好得多，但如果没有理由不使用 Full IIS，那么我继续提倡使用它。

# android - 谷歌地图视图顶部的图像按钮

> ID：12169394
> 
> 赞同：2
> 
> 时间：2012-08-29T00:33:08.740
> 
> 标签：android, google-maps, transparent, imagebutton, android-ui

我将一个`ImageButton`放在一个`MapView`. 这`ImageButton`是一个带有透明背景的保存图标。它在我的 Windows Phone 7 应用程序上看起来很棒，但在我的 Android 应用程序上，背景并不是真正透明的。如您所见，透明背景看起来像一个大正方形`Button`。

我怎样才能真正使背景透明？图片和xml粘贴在下面。谢谢，加里

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
 <TextView
    android:id="@+id/tvMAP"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Map"
    style="@style/bigtype" /> 
```

```
<com.google.android.maps.MapView
    android:id="@+id/mapview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:apiKey="mykeyhere"
    android:clickable="true" />

<ImageButton
android:id="@+id/ImageButton01"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:src="@drawable/save_white" />

</RelativeLayout> 
```

![截屏](../Images/e1b1360ff29645e0110180e50e48bbb5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:11:26.503

这里的诀窍是使背景透明。默认情况下，背景是灰色的。

代码应该是这样的，

```
<ImageButton
 android:id="@+id/ImageButton01"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:src="@drawable/save_white"
 android:background="@android:color/transparent" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:36:29.430

不使用`android:src`而是使用背景

```
<ImageButton
android:id="@+id/ImageButton01"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:background="@drawable/save_white" /> 
```

# three.js - Three.js 地形/ Javascript 地形编辑器

> ID：12169400
> 
> 赞同：-1
> 
> 时间：2012-08-29T00:33:55.317
> 
> 标签：three.js

我想我只是在这里缺少一些关键字......

我想为 Javascript 创建一个 3D 地形编辑器。

基本上保存放置的对象的地形顶点和坐标。

我可以在正确的方向上得到一点推动吗？:)

（现在地面是平的..相当无聊）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T08:34:14.743

你可以看看这个使用three.js [https://github.com/qiao/fractal-terrain-generator的地形编辑器](https://github.com/qiao/fractal-terrain-generator)

# magento - Magento 路由 - 从路径中删除默认的“索引”路由

> ID：12169402
> 
> 赞同：1
> 
> 时间：2012-08-29T00:34:03.230
> 
> 标签：magento, routes

在构建自定义 magento 模块时，我发现以下内容：

xxx/view/id/4 = 404s xxx/index/view/id4 = 路由正确

有没有办法从路线中删除初始索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:36:03.120

标准 Magento URL 匹配至少需要三个部分：

```
site.com/catalog/product/view/id/4  <--- params
           ^        ^     ^
           |        |     `----------- action
frontname--´        |
              controller path 
```

假设索引。您可以轻松地制作`ViewController`并使用`indexAction()`与您当前的`IndexController::viewAction()`. 重复模式。

还有其他几种可能性，包括重写、自定义路由器类等。

# sql - 具有 IN 和 NOT IN 条件的单个表的内部查询

> ID：12169409
> 
> 赞同：1
> 
> 时间：2012-08-29T00:34:58.660
> 
> 标签：sql, oracle, relational-division

这是对我之前[回答的问题的修改](https://stackoverflow.com/questions/12166346/inner-queries-on-a-single-table)

我在下表中有数据：

```
ROLE_ID | USER_ID
------------------
 14     | USER A
 15     | USER A
 11     | USER B
 13     | USER D
 13     | USER A
 15     | USER B
 15     | USER D
 12     | USER C
 15     | USER C 
```

我想获得只有 13 和 15 的用户 ID。所以根据上面的例子，我应该只回来`USER D`

下面的查询是在我之前的回答中提供的，这`NOT IN`部分是我添加的，但是，这并没有达到目标..

```
select user_id
  from my_table
 where role_id in (13,15) AND role_id not in (11,14)
 group by user_id.
having count(distinct role_id) = 2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:02:36.677

要*仅*获得13 和 15，请执行以下操作：

```
select user_id
from my_table
group by user_id
having max(case when role_id = 13 then 1 else 0 end) = 1 and  -- has 13
       max(case when role_id = 15 then 1 else 0 end) = 1 and  -- has 15
       max(case when role_id not in (13, 15) then 1 else 0 end) = 0 -- nothing else 
```

这将检查 13 和 15 是否在 user_id 集中。然后它检查集合中没有其他内容。

我意识到在 case 语句中使用 having 子句一开始似乎很尴尬。但是，您可以表达关于集合中事物的不同组合的大量逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:37:51.657

假设 和 的组合`user_id`是`role_id`唯一的，您可以执行类似的操作

```
select user_id
  from my_table
 where role_id in (13,15,11,14) 
 group by user_id.
having sum( case when role_id in (13,15) then 1 else 0 end) = 2
   and sum( case when role_id in (11,14) then 1 else 0 end) = 0 
```

如果 和 的组合`user_id`不是`role_id`唯一的，那么`distinct`在你的原件`count`中是必要的，事情变得更具挑战性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T09:11:11.067

将我的[答案](https://stackoverflow.com/questions/12166346/inner-queries-on-a-single-table/12166426#12166426)扩展到您的原始问题，您可以尝试

```
(SELECT user_id FROM table WHERE role_id=13
       INTERSECT
SELECT user_id FROM table WHERE role_id=15)
       MINUS
SELECT user_id FROM table WHERE role_id IN (11, 14) 
```

两者`INTERSECT`和`MINUS`都是特定于[ORACLE](http://docs.oracle.com/cd/B19306_01/server.102/b14200/queries004.htm)的，因此其他解决方案更通用，而这更具可读性且更易于修改。

无权访问 ORACLE 数据库，因此未经测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T01:53:14.497

并没有实际测试它，但这样的事情应该可以工作：

```
SELECT USER_ID
FROM MY_TABLE T1
WHERE
    ROLE_ID IN (13, 15)
    AND NOT EXISTS (
        SELECT *
        FROM MY_TABLE T2
        WHERE
            T1.USER_ID = T2.USER_ID
            AND ROLE_ID IN (11, 14)
    )
GROUP BY USER_ID
HAVING COUNT(DISTINCT ROLE_ID) = 2 
```

简而言之：忽略用户的所有行，其中任何行包含不需要的 ROLE_ID ( `NOT EXISTS`)，然后继续确保用户具有所有需要的 ROLE_ID。

注意：如果 {ROLE_ID, USER_ID} 上有键，则不需要 DISTINCT。

* * *

要获取只有 (13, 15) 且没有其他内容的用户，在事先不知道什么是“else”的情况下，只需将`ROLE_ID IN (11, 14)`内部查询中的. 替换为`ROLE_ID NOT IN (13, 15)`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T01:34:02.797

> 我想要角色 ID 为 13 和 15 的用户（仅此而已）

一种方法：

```
SELECT t13.user_id
FROM   my_table t13
JOIN   my_table t15 ON t13.user_id = t15.user_id
LEFT   JOIN my_table tx ON tx.user_id = t13.user_id AND tx.role_id NOT IN (13,15)
WHERE  t13.role_id = 13
AND    t15.role_id = 15
AND    tx.user_id IS NULL; 
```

这假设`(role_id, user_id)`是唯一的。

*这是关系划分*的一个特例。我们最近收集了很多方法来处理这个问题（对于 PostgreSQL 和 MySQL，但其中大部分是同样适用于 Oracle 的基本 SQL）：
[How to filter SQL results in a has-many-through relationship](https://stackoverflow.com/q/7364969/939860)

另一个不存在的变体：

```
SELECT t13.user_id
FROM   my_table t13
JOIN   my_table t15 ON t13.user_id = t15.user_id
WHERE  t13.role_id = 13
AND    t15.role_id = 15
AND    NOT EXISTS (
   SELECT 1
   FROM   my_table tx
   WHERE  tx.user_id = t13.user_id
   AND    tx.role_id NOT IN (13,15)
   ); 
```

# asp.net-mvc-4 - Roles.GetRolesForUser(); 在 MVC 4 中似乎不起作用

> ID：12169410
> 
> 赞同：1
> 
> 时间：2012-08-29T00:34:59.030
> 
> 标签：asp.net-mvc-4, visual-studio-2012, membership-provider, asp.net-roles

我正在尝试使用 VS2012 中提供的互联网模板创建一个新的 MVC 4 互联网站点。我能够为该站点注册用户并成功登录和注销。我可以看到 SimpleMembership 已创建 5 个表（UserProfile、webpages_Membership、webpages_OAuthMembership、webpages_Roles、webpages_UsersInRoles），并且我通过该站点创建的登录名已放入正确的位置（无论如何我都希望它们正确！）

我遇到的问题是用户的角色。首先，我似乎无法使用旧的 ASP.NET 配置页面 - 它需要永远加载，然后当它最终加载时，当您单击安全链接时会出现此错误：

> 您选择的数据存储存在问题。这可能是由无效的服务器名称或凭据或权限不足引起的。这也可能是由于未启用角色管理器功能造成的。单击下面的按钮可重定向到您可以选择新数据存储的页面。
> 
> 以下消息可能有助于诊断问题：无法连接到 SQL Server 数据库。

当您尝试进行提供程序配置时出现此错误

> 无法建立与数据库的连接。如果尚未创建 SQL Server 数据库，请退出网站管理工具，使用 aspnet_regsql 命令行实用程序创建和配置数据库，然后返回此工具设置提供程序。

我尝试运行 aspnet_regsql，它创建了旧样式的成员表，以及在我注册第一个用户时站点已经创建的新成员表。

因此，就创建角色而言，为了解决这个问题，我自己将一个角色放入数据库并将一个用户放入该角色。现在运行该站点我不能使用 Roles.GetRolesForUser() ，因为它在调试时也说“无法连接到 SQL Server 数据库”（并且 YOD 给出了一个空引用异常）。

我注意到在 web.config 中不再有以前存在的关于成员资格/角色提供者等的部分（例如，如果您制作 MVC 3 互联网应用程序）

几天来我一直在寻找答案，任何人都可以阐明我可能做错了什么吗？

这是我的 web.config（删除了连接字符串）

```
<?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <configSections>
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
    <sectionGroup name="dotNetOpenAuth" type="DotNetOpenAuth.Configuration.DotNetOpenAuthSection, DotNetOpenAuth.Core">
      <section name="messaging" type="DotNetOpenAuth.Configuration.MessagingElement, DotNetOpenAuth.Core" requirePermission="false" allowLocation="true" />
      <section name="reporting" type="DotNetOpenAuth.Configuration.ReportingElement, DotNetOpenAuth.Core" requirePermission="false" allowLocation="true" />
      <section name="oauth" type="DotNetOpenAuth.Configuration.OAuthElement, DotNetOpenAuth.OAuth" requirePermission="false" allowLocation="true" />
      <section name="openid" type="DotNetOpenAuth.Configuration.OpenIdElement, DotNetOpenAuth.OpenId" requirePermission="false" allowLocation="true" />
    </sectionGroup>
  </configSections>
  <connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=.;Initial Catalog=EnvoyBilling;Integrated Security=True;MultipleActiveResultSets=True;" providerName="System.Data.SqlClient" />
    <add name="EnvoyBillingContext" connectionString="xxx" providerName="System.Data.EntityClient" />
  </connectionStrings>
  <appSettings>
    <add key="webpages:Version" value="2.0.0.0" />
    <add key="webpages:Enabled" value="false" />
    <add key="PreserveLoginUrl" value="true" />
    <add key="ClientValidationEnabled" value="true" />
    <add key="UnobtrusiveJavaScriptEnabled" value="true" />
    <add key="enableSimpleMembership" value="true" />
  </appSettings>
  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5" />
    <authentication mode="Forms">
      <forms loginUrl="~/Account/Login" timeout="2880" />
    </authentication>
    <pages>
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
      </namespaces>
    </pages>
  </system.web>
  <system.webServer>
    <validation validateIntegratedModeConfiguration="false" />
    <handlers>
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
      <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
      <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
      <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
    </handlers>
  </system.webServer>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="DotNetOpenAuth.AspNet" publicKeyToken="2780ccd10d57b246" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="DotNetOpenAuth.Core" publicKeyToken="2780ccd10d57b246" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="EntityFramework" publicKeyToken="b77a5c561934e089" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.0.0.0" newVersion="5.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>
    <legacyHMACWarning enabled="0" />
  </runtime>
  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="v11.0" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework>
  <system.net>
    <defaultProxy enabled="true" />
    <settings>
      <!-- This setting causes .NET to check certificate revocation lists (CRL) 
                 before trusting HTTPS certificates.  But this setting tends to not 
                 be allowed in shared hosting environments. -->
      <!--<servicePointManager checkCertificateRevocationList="true"/>-->
    </settings>
  </system.net>
  <dotNetOpenAuth>
    <messaging>
      <untrustedWebRequest>
        <whitelistHosts>
          <!-- Uncomment to enable communication with localhost (should generally not activate in production!) -->
          <!--<add name="localhost" />-->
        </whitelistHosts>
      </untrustedWebRequest>
    </messaging>
    <!-- Allow DotNetOpenAuth to publish usage statistics to library authors to improve the library. -->
    <reporting enabled="true" />
    <openid>
      <relyingParty>
        <security requireSsl="false">
          <!-- Uncomment the trustedProviders tag if your relying party should only accept positive assertions from a closed set of OpenID Providers. -->
          <!--<trustedProviders rejectAssertionsFromUntrustedProviders="true">
                        <add endpoint="https://www.google.com/accounts/o8/ud" />
                    </trustedProviders>-->
        </security>
        <behaviors>
          <!-- The following OPTIONAL behavior allows RPs to use SREG only, but be compatible
                         with OPs that use Attribute Exchange (in various formats). -->
          <add type="DotNetOpenAuth.OpenId.RelyingParty.Behaviors.AXFetchAsSregTransform, DotNetOpenAuth.OpenId.RelyingParty" />
        </behaviors>
      </relyingParty>
    </openid>
  </dotNetOpenAuth>
  <uri>
    <!-- The uri section is necessary to turn on .NET 3.5 support for IDN (international domain names),
             which is necessary for OpenID urls with unicode characters in the domain/host name.
             It is also required to put the Uri class into RFC 3986 escaping mode, which OpenID and OAuth require. -->
    <idn enabled="All" />
    <iriParsing enabled="true" />
  </uri>
</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T04:42:46.807

我刚刚发现[Jon Galloway 的一篇文章](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)谈到了这个确切的情况。他昨天才发的！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T11:23:53.053

您应该在 web.config 中设置成员资格和角色提供者。

```
 <system.web>
    <roleManager enabled="true">
        <providers>
            <clear/>
            <add name="AspNetSqlRoleProvider" connectionStringName="MyAspNetDB"
                applicationName="/SampleRolesApp"
                type="System.Web.Security.SqlRoleProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        </providers>
    </roleManager>
    <membership>
        <providers>
            <clear/>
            <add name="AspNetSqlMembershipProvider"
                connectionStringName="MyAspNetDB"
                enablePasswordRetrieval="false"
                enablePasswordReset="true"
                requiresQuestionAndAnswer="true"
                applicationName="/SamplesRolesApp"
                requiresUniqueEmail="false"
                passwordFormat="Hashed"
                maxInvalidPasswordAttempts="5"
                minRequiredPasswordLength="7"
                minRequiredNonalphanumericCharacters="1"
                passwordAttemptWindow="10"
                passwordStrengthRegularExpression=""                     
                type="System.Web.Security.SqlMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        </providers>
    </membership>

  ...
  </system.web> 
```

有关更多信息，请查看此[帖子](http://odetocode.com/Articles/428.aspx)。

# android - 使用数据库中的字符串在 TextView 中添加换行符

> ID：12169414
> 
> 赞同：0
> 
> 时间：2012-08-29T00:35:49.963
> 
> 标签：android, sqlite, textview

我有一个 SQLite 数据库，其中一些值包含带有换行符的`'\n'`字符串。我希望当从数据库中提取该值，放入 a`String`并且 a`TextView`设置`setText()`为该`String`值时，换行符会起作用，但不幸的是它不起作用。除了必须解析字符串并手动分解之外，还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:39:30.990

如果你调试，你会看到字符串实际上是“\ \r\ \n”或“\ \n”，即它被转义了。所以如果你按摩那个字符串，去掉多余的\，你就会有你的解决方案。如果您正在从数据库中读取数据，则尤其如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T06:58:35.003

您的字符串在放入数据库时​​被转义。在将字符串放入 TextView 之前，您可以尝试通过调用 String s = unescape(stringFromDatabase) 来取消对字符串的转义。

* * *

> private String unescape(String description) { return description.replaceAll("\\n", "\\n"); }

附带说明一下，在将数据插入数据库时​​，请确保对来自用户或未知可变源的任何类型的数据使用 DatabaseUtils.sqlEscapeString()。这将保护您免受错误和 SQL 注入的影响。

# ruby-on-rails-3 - 如何确定用户是否允许我的应用发布到 Facebook

> ID：12169417
> 
> 赞同：1
> 
> 时间：2012-08-29T00:36:41.223
> 
> 标签：ruby-on-rails-3, facebook-graph-api, omniauth

我有一个使用omniauth 来通过facebook 启用用户注册的rails 应用程序。我的 facebook 应用程序请求用户允许代表用户在 facebook 上发帖。我的问题是，有没有办法让我确定用户在身份验证过程中是否“跳过”授予该权限（用户似乎不可能真正拒绝授予此权限......他们只能跳过它）？我在 facebook 回调返回的 request.env 中看不到任何内容。

顺便说一句，fb-graph 和授予发布权限似乎存在各种问题。例如，即使用户“跳过”授予此权限，当用户查看他的 fb 授权应用程序时，我的应用程序显示指示用户已授予此权限，即使 fb 阻止我的应用程序发布 fb 帖子也是如此。此外，用户似乎不可能随后改变他对允许我的应用发布到 fb 的想法：您甚至无法在 fb 上编辑应用程序以实际授予权限。

我错过了关于 fb-graph 的东西吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T04:02:03.870

您可以检查用户授予您的应用的权限。您所要做的就是向 /USER_ID/permissions 发出 HTTP GET 请求，其中包含此应用的用户 access_token 或应用程序 access_token。这将返回一个对象，其中包含用户授予应用程序的权限名称。

# bash - 每 16 秒计算文件中包含的平均值

> ID：12169418
> 
> 赞同：0
> 
> 时间：2012-08-29T00:36:42.723
> 
> 标签：bash, shell

我有一个大文件“values.txt”，其中有很多值。这些值可以在文件 valeur.txt 中找到，如下所示：

```
File:  "values.txt"
************************************************** *****************************************
2
14
18
20
23
.
.
.
24
****************************************************************************************** 
```

我想编写一个脚本，计算每 16 秒从文件 values.txt 读取的值的平均值

即：每16秒后我将计算我在文件values.txt中读取的值的平均值

例如：

要读取文件“value.txt”，我们需要 (16 * 4 = 64) 秒。因此，脚本执行完毕后，必须显示 4 个值。因为每 16 秒它会计算一个平均值。

我试着做事，但时间的概念（16秒）我仍然无法管理它

* * *

```
let "i=0"    
let"cum=0"

while read var   
do  
if [timer] # how I could control the period of 16 seconde ?  
then  
let "i = i +1"  
let "cum = cum + var"  
else  # 16 seconds have elapsed, so i calculate the averag   
let  "avrg_var= cum /i" 
echo "$avrg_var">> new_file.txt
fi 
done < values.txt 
```

* * *

提前感谢您的回答和建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:54:54.640

尝试这个：

```
while :
do
    let "i=0"
    let "cum=0"
    while read var
    do
        let "i = i +1"
        let "cum = cum + var"
    done < /tmp/values.txt 

    let "avrg_var= cum /i"

    echo "$avrg_var">> new_file.txt

    sleep 16
done 
```

这对计时器不起作用，只是在两次运行之间休眠 16 秒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:59:47.080

编写一个将值平均一次的脚本，然后您可以使用[watch](http://www.thegeekstuff.com/2010/05/watch-command-examples/)命令运行您的脚本，假设您在基于 *nix 的系统上。默认值为 2 秒，但您可以将其更改为您想要的任何内容，它将在终端中重复运行直到取消

# ios5 - iOS5/6 中的自动旋转？

> ID：12169419
> 
> 赞同：4
> 
> 时间：2012-08-29T00:36:47.827
> 
> 标签：ios5, ios6, autorotate

我更新到 Xcode 4.5 并且正在使用 iOS6——下次有更新时我绝对*不会犯这个错误；*对于刚接触 iOS 的人来说，这简直是一场噩梦——我刚刚注意到我正在开发的一个应用程序正在自动旋转。在更新之前我从未注意到它自动旋转，但也有可能我只是在测试时没有旋转手机，所以我不能确定。我已将以下代码添加到主 UIViewController 并且它仍在旋转：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:
(UIInterfaceOrientation)interfaceOrientation
{
    return NO;
} 
```

这是禁用自动旋转的正确方法吗？如果是这样，那么iOS6可能会发生一些变化，我必须等到完整版本才能找到答案。但是如果我弄错了，我应该改用什么代码呢？

一如既往地感谢您的帮助。

**编辑：**这是我将其更改为的代码，但它仍在旋转。我弄错了吗？

```
- (BOOL)shouldAutorotateToInterfaceOrientation:
(UIInterfaceOrientation)interfaceOrientation
{
if (interfaceOrientation == UIInterfaceOrientationPortrait)
{
    return YES;
}
else 
{
    return NO;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T00:47:14.950

那是因为从来没有成功过。您应该选择其中一种方向。

按住命令并单击 UIInterfaceOrientation，您将看到可能选项的枚举。

然后你可以测试这些来决定你的`YES`场景。

我最初可能误解了你的问题。您似乎一直在说您的应用程序允许旋转。但代码应该不允许这样做。

我以为你在说它仍在触发代码。试图找到一个是

需要考虑的一件事。是否可能有多个视图控制器可用。也许您的代码没有被击中。

几个可能的问题。

1.  你的代码甚至没有被使用。因为视图被分配为 UIViewController 而不是您的自定义视图控制器。

2.  正在使用您的代码，但该视图控制器不是被询问有关方向的那个。因此，该特定代码没有被击中。

3.  糟糕的构建会不断将错误的程序集放到设备上。

您的解决方案如下。

1.  确保您的代码是正在分配的代码。您的自定义类有直接分配。或者 xib 文件正在膨胀它。当您打开 xib 文件时，请查看 Identity Inspector。选择您的视图控制器并确保将自定义类设置为您的类类型

2.  看层次。还有哪些其他视图控制器。也许其中一个告诉应用程序它可以自动旋转到任何方向。

3.  找到您的“DerivedData”文件夹并将其完全删除。有时这对组织者有效。其他时候你需要直接从磁盘上删除。然后清理并再次构建。

另一个解决方案也可以像在项目文件中设置设置一样简单。

从文件浏览器中选择您的项目文件，您将在摘要中看到 iPad 和 iPod 设置。您可以为要禁止的方向“取消按下”按钮。以及您没有以其他方式将方向编码到的任何视图控制器。默认情况下将使用这些。

我为混乱道歉。

**更新**

我通常使用此代码来处理我的自动旋转。

它不仅将 ipad 与其他 ios 设备区分开来，而且还将请求转发到呈现的控制器上，因此显示为模态的视图可以响应它想要的方式。

当你不理解它时，方向是一种痛苦:)

```
// Detect iPad
#define IS_IPAD() ([[UIDevice currentDevice] respondsToSelector:@selector(userInterfaceIdiom)] ? \
[[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad : NO)

// Set preferred orientation for initial display
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{
    if (IS_IPAD()){
        return UIInterfaceOrientationLandscapeRight;
    }
    else {
        return UIInterfaceOrientationPortrait;
    }
}
// Return list of supported orientations.
- (NSUInteger)supportedInterfaceOrientations{
    if (self.presentedViewController != nil){
        return [self.presentedViewController supportedInterfaceOrientations];
    }
    else {
        if (IS_IPAD()){
            return UIInterfaceOrientationMaskLandscapeRight;
        }
        else {
            return UIInterfaceOrientationMaskAll;
        }
    }
}

// Determine iOS 6 Autorotation.
- (BOOL)shouldAutorotate{
    UIDeviceOrientation orientation = [UIDevice currentDevice].orientation;
    // Return yes to allow the device to load initially.
    if (orientation == UIDeviceOrientationUnknown) return YES;
    // Pass iOS 6 Request for orientation on to iOS 5 code. (backwards compatible)
    BOOL result = [self shouldAutorotateToInterfaceOrientation:orientation];
    return result;
}
// handle iOS 5 Orientation as normal
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation{
    // Return YES for supported orientations

    if (self.presentedViewController != nil){
        return [self.presentedViewController shouldAutorotate];
    }
    else {
        if (IS_IPAD()){
            return (interfaceOrientation == UIInterfaceOrientationLandscapeRight);
        }
        else {
            return (interfaceOrientation == UIInterfaceOrientationPortrait);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T19:55:10.913

iOS6 中的旋转 API 发生了变化。新的 API 显然应该选择加入，但它们似乎已为模拟器或设备上的所有调试版本启用。要注册新的 API 调用，请在您的 APP Delegates 的 didFinishLoading 方法中抛出类似的内容。

```
//Register for new API rotation calls
[[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"UIApplicationSupportedInterfaceOrientationsIsEnabled"]; 
```

轮换变化的核心是两种方法（还有第三种，但我自己还在想办法）

```
- (BOOL)shouldAutorotate
- (NSUInteger)supportedInterfaceOrientations 
```

您需要在您的 windows rootViewController 中覆盖这些方法。这意味着如果 UINavigationController 或 UITabBarController 是您的根控制器，您需要子类化（这对我来说似乎很奇怪，但 Apple 说 Jump）。

现在，如果您想要做的只是让您的应用程序保持纵向，请实施这两种方法，您就可以了。

```
- (BOOL)shouldAutorotate
{
    return NO;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait;
} 
```

请注意，苹果通过添加界面方向掩码进一步增加了混乱，即。UIInterfaceOrientationMaskPortrait != UIInterfaceOrientationPortrait。如果您返回 UIInterfaceOrientationPortrait ，则行为会有所不同。您也可以像组合方向一样组合蒙版，因此如果您想支持两个纵向方向，您可以使用。

```
- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown;
} 
```

这应该有助于强制纵向。现在，如果您想做一些事情，例如允许子控制器使用不同的方向，我不知道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T00:38:47.557

在 iOS6 和 iOS5 中处理自动旋转的一个非常简单的方法是使用supportedInterfaceOrientations 和 shouldAutorotateToInterfaceOrientation。有一些宏使它只是一行代码。UIInterfaceOrientationIsLandscape & UIInterfaceOrientationMaskLandscape。我通过 xCode 中的自动完成功能发现了 UIInterfaceOrientationMaskLandscape 和 UIInterfaceOrientationMaskPortrait。Apple 文档中没有[关于 autorotation](https://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/RespondingtoDeviceOrientationChanges/RespondingtoDeviceOrientationChanges.html)的内容。

将此代码块添加到您的根 ViewController 以强制它仅支持横向模式。

```
//iOS6 code to support orientations
- (NSUInteger)supportedInterfaceOrientations
{
     return (UIInterfaceOrientationMaskLandscape);
}

//iOS5 code to support orientations
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)orientation
{
     return (UIInterfaceOrientationIsLandscape(orientation));
} 
```

**对于 iOS6，您可以使用以下方法检测方向：**

*   UIInterfaceOrientationMaskLandscape
*   UIInterfaceOrientationMaskPortrait
*   UIInterfaceOrientationMaskLandscapeRight
*   UIInterfaceOrientationMaskLandscapeLeft
*   UIInterfaceOrientationMaskPortraitUpsideDown
*   UIInterfaceOrientationMaskAllButUpsideDown
*   UIInterfaceOrientationMaskAll

**对于 iOS5 及更低版本，您可以使用以下方法检测方向：**

*   UIInterfaceOrientationIsLandscape（宏）
*   UIInterfaceOrientationIsPortrait
*   UIInterfaceOrientationIsLandscapeRight
*   UIInterfaceOrientationIsLandscapeLeft
*   UIInterfaceOrientationIsPortraitUpsideDown

# javascript - 触发由javascript制作的复选框的更改

> ID：12169421
> 
> 赞同：3
> 
> 时间：2012-08-29T00:37:08.717
> 
> 标签：javascript, jquery, checkbox, onchange

我正在构建一个 jQuery 插件来设置复选框的样式。我隐藏了真实的，然后插入按钮，单击该按钮会切换隐藏的复选框。但是如果我通过 JavaScript 检查隐藏的复选框，假按钮当然不会改变。我考虑过使用 jQuery 进行更改，`.change()`但它也不会在通过 JavaScript 进行更改时触发更改，而不是通过实际单击复选框来触发更改。

我希望插件是通用的，并且如果有人有一个像“全选”或“取消全选”这样的按钮来使用 JavaScript，我希望我的假复选框按钮也能相应地改变。

**问题是我应该使用什么方法来代替 jQuery 的 change() 以便不仅可以查看鼠标点击所做的更改，还可以查看 javascript 例如** `$('checkbox').prop('checked', true);`

**编辑2：** 我意识到没有正确的方法来使用 JavaScript 来查看属性，除了为每个复选框每秒检查几次属性，这是非常没有吸引力的。我决定不在我的插件中包含这种低效的功能，而是将它留给用户也如果他想通过 JavaScript 操作值，则触发更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T12:42:40.390

你不能看属性。您可以设置一个每隔几毫秒查找更改的计时器，但这并不令人满意。

相反，当他们希望像您这样的插件更新时，您应该依赖所有其他代码来触发更改事件（也可能存在不更新的情况）：

```
$(':checkbox').prop('checked', true).change(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:04:53.587

您需要手动触发更改事件。

```
$('#checkbox').attr('checked', 'checked').change(); 
```

看看这个： [JsFiddle](http://jsfiddle.net/4HNAV/1/)

# jquery - jquery $(this) - 如何访问子 h2

> ID：12169423
> 
> 赞同：-1
> 
> 时间：2012-08-29T00:37:12.133
> 
> 标签：jquery, html

我有这个 HTML 结构：

```
 <span id="subMenuTitle1" class="subMenuClickAble"><h2>Inbox 1</h2></span> 
```

我想将单击事件附加到 span.subMenuClickAble 并在 h2 中附加 text() 。

我尝试了以下方法：

```
 var text = $(this).child('h2').text();

 var text = $(this h2).text(); 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T00:40:33.390

尝试这个：

```
var text = $('h2', this).text(); 
```

但是，您的 HTML 代码是无效的（除非您使用的是 HTML 5 并且仅针对支持 HTML 5 的浏览器），因此该`h2`元素甚至可能不会出现在`span`标签内。

内联元素 ( `span`) 可能不包含块元素 ( `h2`)。浏览器会尝试更正代码，通常是通过将`h2`元素移到 之外`span`，或者`span`在元素开始的地方结束`h2`元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:44:04.797

尝试：

```
$('#subMenuTitle1').click(function (event) {
    var text = $(this).children('h2').text();
    /* do stuff here */
});​ 
```

编辑：[jsfiddle](http://jsfiddle.net/dtf7g/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T00:40:34.340

使用[jquery 查找](http://api.jquery.com/find/)

```
var text = $(this).find('h2').text(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T00:39:47.437

尝试

```
$('.subMenuClickAble').click(function(){
    console.log( $(this).find('h2').text() );
}) 
```

# gif - 是否有一个技巧可以创建一个电视静态的动画 gif 以使其相对较小？

> ID：12169429
> 
> 赞同：4
> 
> 时间：2012-08-29T00:38:12.227
> 
> 标签：gif, animated-gif, lzw

提前道歉，但这并不是一个真正的Photoshop问题。相反，我试图想出一些令人信服的东西，但尽可能利用 gif 格式的压缩和特性来为动画生成尽可能小的文件。

一些限制：

*   它至少需要 20 或 30 帧。我尝试过更少（因为它们在很大程度上是不可压缩的，一般来说，15 帧的大小是 30 帧的一半）
*   尺寸需要不小于256x192左右
*   它不需要是彩色的，甚至不需要全灰度。我看过令人信服的静止图像，只有大约 16 个灰色
*   它可以有一种模式，但不是人眼就能立即看到的模式。如果有人拍了一帧，一两分钟后可以发现图案（这使它可压缩？）没关系
*   第 2 帧到第 n 帧可以使用相当多的 alpha，但是当我开始使用大的 alpha 水平条纹时，我的眼睛立刻就注意到了。所以你不会用简单的作弊来积累一堆 RLE。
*   以上所有，仍然需要在 30-33 毫秒的帧速度下看起来不错。没有变速或依赖任何比这更快的东西。

也可以接受：符合上述约束的 apng。如果你能想到的话，甚至可能是 mpeg（我不知道 DCT 是如何发挥它的魔力的）。

理想情况下，我可以在 250kbyte 范围内得到一些东西，但我会接受任何比我上周制作的 9 meg 怪物小得多的东西。

哦，还有最后一件事：显然我不希望任何人为我提供图形。我只是在寻找一些能让我最终自己到达那里的技巧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:55:44.047

这是一个非常有趣的问题。

静态（随机噪声）本质上实际上是高度不可压缩的。信息论说，真正的噪声基本上是不可压缩的，并且包含的​​模式越多，它的可压缩性就越高（达到 1 或 0 的实线完全可压缩的程度。

理想的情况是创建一个真正的噪声生成器（只是随机数），但这在您的问题的限制范围内无济于事。

我能想到的最好的事情是存储一些小的静态图块并以交错的方式显示它们，以防止任何图案吸引眼球。除此之外，将其压缩到 256 x 192 x 20 / 2 或大约 500 KB（假设 20 帧，分辨率为 256 x 192，使用 4 位色深）之外，您将不会有太多运气。

只需在 16 色模式下对动画 gif 进行编码即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T16:12:30.567

是的，您可以通过有损 GIF 压缩来实现这一点，或者更确切地说是使用专门装配的压缩器来输出嘈杂的 LZW 流。

LZW 压缩的最佳情况是输出 X 像素，然后是 X+1 像素，然后是 X+2 像素，等等。很容易产生噪声。

尝试将函数搞砸`gfc_lookup`（几乎）总是返回最长的字典项并用它压缩一系列嘈杂的帧：

[https://github.com/pornel/giflossy/blob/master/src/gifwrite.c#L270](https://github.com/pornel/giflossy/blob/master/src/gifwrite.c#L270)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-15T18:11:05.603

很老但仍然没有回答的答案（无论如何都没有检查）

1.  **所以创建 NoSignal 图像数据**

    如果不清楚如何阅读：

    *   [asm 和 C++ 中的 NoSignal](https://stackoverflow.com/a/29296619/2521214)
2.  **编码成gif**

    玩了一下，所以我使用了分辨率`320x240`，可用的最低位分辨率是`3 bit`每像素。低的不好看。仅单个全局调色板（很明显）此处 300KB 示例

    ![无信号 320x240x3](../Images/cd0eadd70834d93187bd251e6544ceac.png)

**[笔记]**

如果这仅适用于某些应用程序，则在运行时生成图像它实际上只是几行代码，请参阅项目符号**#1中的链接答案**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T20:45:24.203

平时不容易。根据定义，良好的随机性（高熵）不能很好地压缩。拥有灰度可能会有所帮助，但作用不大。

如果您想在网页上执行此操作并且您有（一些）控制权，您可以随时编写一小段 JS 来提供帮助……如果您可以做到这一点，那么您可以执行以下操作：

1.  使用高熵静态创建一个大约 1.5 倍所需大小的 gif。
2.  将剪辑设置为您想要的大小。
3.  然后你通过改变起始偏移量来随机移动它。

只要您的偏移彼此相距相当远（并且不重复模式），通常很难将其识别为运动，并且看起来确实像静止的。

大约 20 年前，我在 Amiga 上做了这个技巧，以在有限内存演示上模拟静态，它工作得非常好......它也不需要快速的低级代码，因为所有这些都是通过更改偏移量和 co-处理器 bitblit-ed 其余部分。

# android - 为什么我的 android 应用程序在我的平板电脑上安装它时没有连接到我的网络服务，尽管它在带有 froyo 的虚拟设备中运行良好？

> ID：12169431
> 
> 赞同：0
> 
> 时间：2012-08-29T00:38:59.443
> 
> 标签：android, .net, web-services, tablet, android-2.2-froyo

我开发了一个使用 ksoap-2 使用 .net Web 服务的 android 应用程序。
该应用程序在具有 android 2.2 (froyo) 的虚拟设备上很好地使用了该服务，但是当我在具有 android 2.2 (froyo) 的平板电脑上安装 apk 包时，该服务的使用并未完成。

我已经在清单文件中添加了互联网权限。
我没有任何其他想法可以让它在平板电脑上运行，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T13:28:01.790

问题是因为自 Android Gingerbread 2.3 以来，他们引入了一种使用 Web 服务的新方法，不允许您从父线程使用 WS。

# c# - 使用 C# 和 .NET 2.0 创建顺序文件夹名称？

> ID：12169439
> 
> 赞同：1
> 
> 时间：2012-08-29T00:39:32.750
> 
> 标签：c#, .net, directory

我需要创建数量增加的备份文件夹。但是如果存在编号间隙，我需要跳过它们，并使下一个文件夹名称比编号最高的文件夹高一个。例如，如果我有：

```
c:\备份\数据.1
c:\备份\数据.2
c:\备份\数据.4
c:\备份\数据.5
```

我需要下一个文件夹

```
c:\备份\数据.6
```

下面的代码有效，但感觉非常笨拙。有没有更好的方法来做到这一点并且仍然*保留在 .NET 2.0 中*？

```
 static void Main(string[] args)
    {
        string backupPath = @"C:\Backup\";
        string[] folders = Directory.GetDirectories(backupPath);
        int count = folders.Length;
        List<int> endsWith = new List<int>();

        if (count == 0)
        {
            Directory.CreateDirectory(@"C:\Backup\Data.1");
        }
        else
        {
            foreach (var item in folders)
            {
                //int lastPartOfFolderName;
                int lastDotPosition = item.LastIndexOf('.');
                try
                {
                    int lastPartOfFolderName = Convert.ToInt16(item.Substring(lastDotPosition + 1));
                    endsWith.Add(lastPartOfFolderName);
                }
                catch (Exception)
                {
                   // Just ignore any non numeric folder endings
                }
            }
        }

        endsWith.Sort();

        int nextFolderNumber = endsWith[endsWith.Count - 1];
        nextFolderNumber++;

        Directory.CreateDirectory(@"C:\Backup\Data." + nextFolderNumber.ToString());
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:56:31.957

这是一个略有不同的版本，但基本上做同样的事情。找到带有 max 后缀的文件夹，然后为下一个文件夹添加一个。

```
 static void Main(string[] args)
    {
        string backupPath = @"C:\Backup\";
        string[] folders = Directory.GetDirectories(backupPath);
        Int16 max = 0;

        foreach (var item in folders)
        {
            //int lastPartOfFolderName;
            int lastDotPosition = item.LastIndexOf('.');

            if (lastDotPosition > -1 && !item.EndsWith("."))
            {
                Int16 folderNumber;

                if (Int16.TryParse(item.Substring(lastDotPosition + 1), out folderNumber))
                {
                    if (folderNumber > max)
                    {
                        max = folderNumber;
                    }
                }
            }
        }

        max++;
        Directory.CreateDirectory(@"C:\Backup\Data." + max);
    } 
```

我只是稍微“清理”了您的代码以删除空捕获和附加列表/排序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T00:50:00.097

你是对的; 这有点笨拙。它依赖于操作系统以数字顺序提供文件夹名称，这是我一直警惕的，因为我无法控制新版本的操作系统会做什么。

您最好解析文件夹名称，获取所有数字的列表，然后明确找到最大值。

然后，当您添加 1 时，您保证您现在已经创建了新的最高值。

# xpages - 在一个自定义控件中执行多个查找的有效方式

> ID：12169441
> 
> 赞同：0
> 
> 时间：2012-08-29T00:39:50.197
> 
> 标签：xpages

我正在构建一个自定义控件来进行查找并提供数据库中几个项目的状态摘要。有 20 种不同的状态，为了确定每种状态的数量，我正在做一个 NotesDatabase.search 来计算每种状态。

当只有 2 个状态要检查时，这很好，但是企业现在希望显示所有这些状态。:)

我担心进行搜索所需的时间，并希望以最有效的方式进行搜索。

我考虑到的事情：

*   文档会定期更新，所以我真的不能让代理进行计算，而自定义控件会运行这些静态值的查找。这意味着数据是旧的。
*   结果取决于登录的用户，根据他们的登录 ID 进行计数，所以我真的不能每个人有单独的视图。

有没有人有一个干净的建议解决方案？

我即将开始测试 20 次搜索，并将使用这些结果进行更新，但预计它会非常慢。

一种

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:32:24.133

另一种选择：而不是@DBLookup，您进入视图并使用导航器端到端地运行它。这相当快，应该比 20 倍搜索快。

当然，您可以更新 QuerySave 事件中的计数并将其写入特定于用户的内存配置文件中。

因此，在您的 QuerySave 中，您会看到 ApplicationBean 中加载了哪些用户并更新了这些用户。如果用户新登录，则在数据库中搜索应用程序 bean。当会话到期（会话侦听器）时，ApplicationBean 中的条目将被清除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T03:26:43.390

*实际上，使用ONE* Ajax 调用可能会更好，而不是 20 次搜索。创建一个按您的状态分类并折叠的视图。然后进行 Ajax 调用`...statusview?ReadViewEntries&Outputformat=JSON&count=100`。这将为您提供 100 个具有 childcount 属性的状态摘要条目。

这对你有用吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T13:35:15.677

是否可以添加 20 个状态文档，并在满足某些条件时更新这些文档中的一个或多个？每次更新文档时，代理都会运行以匹配这些条件，以更新状态。

如果每天有很多更新，那效率并不高。

# c# - 按键获取字典值

> ID：12169443
> 
> 赞同：271
> 
> 时间：2012-08-29T00:39:59.370
> 
> 标签：c#, dictionary, key

如何通过函数上的键获取字典值？

我的功能代码（以及我尝试的命令不起作用）：

```
static void XML_Array(Dictionary<string, string> Data_Array)
{
    String xmlfile = Data_Array.TryGetValue("XML_File", out value);
} 
```

我的按钮代码：

```
private void button2_Click(object sender, EventArgs e)
{
    Dictionary<string, string> Data_Array = new Dictionary<string, string>();
    Data_Array.Add("XML_File", "Settings.xml");

    XML_Array(Data_Array);
} 
```

我希望`XML_Array`函数上的变量为：

```
string xmlfile = "Settings.xml": 
```

* * *

## 回答 #1

> 赞同：367
> 
> 时间：2012-08-29T00:42:22.267

就这么简单：

```
String xmlfile = Data_Array["XML_File"]; 
```

请注意，如果字典没有 equals 的键`"XML_File"`，则该代码将引发异常。如果你想先检查，你可以像这样使用 TryGetValue：

```
string xmlfile;
if (!Data_Array.TryGetValue("XML_File", out xmlfile)) {
   // the key isn't in the dictionary.
   return; // or whatever you want to do
}
// xmlfile is now equal to the value 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2016-09-29T06:42:17.527

只需使用字典上的键名即可。C# 有这个：

```
 Dictionary<string, string> dict = new Dictionary<string, string>();
 dict.Add("UserID", "test");
 string userIDFromDictionaryByKey = dict["UserID"]; 
```

如果您查看提示建议：

[![在此处输入图像描述](../Images/48c84cb8f73fead734aff7e1faf058ec.png)](https://i.stack.imgur.com/pPx9E.png)

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-08-29T00:42:43.233

这不是`TryGetValue`工作原理。它根据是否找到键返回`true`或，如果键存在则将其参数设置为相应的值。`false``out`

如果要检查密钥是否存在并在丢失时执行某些操作，则需要以下内容：

```
bool hasValue = Data_Array.TryGetValue("XML_File", out value);
if (hasValue) {
    xmlfile = value;
} else {
    // do something when the value is not there
} 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2017-10-05T09:31:47.317

```
Dictionary<String, String> d = new Dictionary<String, String>();
d.Add("1", "Mahadev");
d.Add("2", "Mahesh");
Console.WriteLine(d["1"]); // It will print Value of key '1' 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-08-29T00:42:47.710

```
static void XML_Array(Dictionary<string, string> Data_Array)
{
    String value;
    if(Data_Array.TryGetValue("XML_File", out value))
    {
        // ... Do something here with value ...
    }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-01-08T18:00:57.217

```
static String findFirstKeyByValue(Dictionary<string, string> Data_Array, String value)
{
    if (Data_Array.ContainsValue(value))
    {
        foreach (String key in Data_Array.Keys)
        {
            if (Data_Array[key].Equals(value))
                return key;
        }
    }
    return null;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-23T14:01:30.603

```
private void button2_Click(object sender, EventArgs e)
{
    Dictionary<string, string> Data_Array = new Dictionary<string, string>();
    Data_Array.Add("XML_File", "Settings.xml");

    XML_Array(Data_Array);
}

static void XML_Array(Dictionary<string, string> Data_Array)
{
    String xmlfile = Data_Array["XML_File"];
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-04-12T07:42:03.183

这是我在源代码中使用的示例。我从字典中获取**键**和**值**，从元素 0 到字典中的元素数。然后我填充了我的字符串 [] 数组，该数组在我的函数中作为参数发送，它只接受参数字符串 []

```
Dictionary<string, decimal> listKomPop = addElements();
int xpopCount = listKomPop.Count;
if (xpopCount > 0)
{
    string[] xpostoci = new string[xpopCount];
    for (int i = 0; i < xpopCount; i++)
    {
        /* here you have key and value element */
        string key = listKomPop.Keys.ElementAt(i);
        decimal value = listKomPop[key];

        xpostoci[i] = value.ToString();
    }
... 
```

此解决方案也适用于 SortedDictionary。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-04-18T00:53:23.107

我在函数中使用与 dasblinkenlight 类似的方法从包含加载到 Dictionary 中的 JSON 数组的 Cookie 中返回单个键值，如下所示：

```
 /// <summary>
    /// Gets a single key Value from a Json filled cookie with 'cookiename','key' 
    /// </summary>
    public static string GetSpecialCookieKeyVal(string _CookieName, string _key)
    {
        //CALL COOKIE VALUES INTO DICTIONARY
        Dictionary<string, string> dictCookie =
        JsonConvert.DeserializeObject<Dictionary<string, string>>
         (MyCookinator.Get(_CookieName));

        string value;
        if (dictCookie.TryGetValue( _key, out value))
        {
            return value;
        }
        else
        {
            return "0";
        }

    } 
```

其中“MyCookinator.Get()”是另一个简单的 Cookie 函数，用于获取 http cookie 的整体值。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-04-22T01:36:59.627

```
Dictionary<int,string> dict = new Dictionary<int,string>{
  {1,"item1"},
  {2,"item2"},
  {3,"item3"},
}

int key = 2 // for example
string result = dict.ContainsKey(key) ? dict[key] : null; 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2019-01-08T16:50:25.220

```
if (Data_Array["XML_File"] != "") String xmlfile = Data_Array["XML_File"]; 
```

# java - java断言无异常

> ID：12169447
> 
> 赞同：1
> 
> 时间：2012-08-29T00:40:52.217
> 
> 标签：java, assert

我们有一些 Java 代码，理想情况下我们希望以三种方式运行：

1.  `assert`失败时抛出异常
2.  打印堆栈跟踪，否则在`assert`失败时继续
3.  忽略一个`assert`

这将在三个不同的环境（分别为开发、测试、生产）中运行。我们可以使用`-ea`JVM 选项在第一个和最后一个之间切换，但是可以做第二个吗？

谢谢。

编辑：我们已经到处都有断言语句。我们更喜欢在运行时更改此选项而不更改我们的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T00:45:14.260

似乎您想为此使用单元测试而不是 Java 的内置`assert`. 看看[JUnit](http://junit.sourceforge.net/)可以为您和您的团队做些什么。

您可以设置要运行的测试，它们会通知您失败。如果您想要堆栈跟踪，您可以通过引发/捕获异常来创建自己的，然后使用`e.printStackTrace()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:07:05.647

你可以很容易地实现#2，因为`assert`抛出一个[`AssertionError`](http://docs.oracle.com/javase/7/docs/api/java/lang/AssertionError.html).

```
try {
  assert false;
} catch (final AssertionError error) {
  error.printStackTrace();
}
System.out.println("survived!"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T00:42:44.533

你不能，不使用`Assert`. `Assert`专为失败而设计，不容忽视。

# php - symfony 1.4 sformextra 自动完成排序顺序

> ID：12169448
> 
> 赞同：1
> 
> 时间：2012-08-29T00:41:10.160
> 
> 标签：php, autocomplete, symfony-1.4

我正在使用 symfony sfFormExtra 插件附带的 jquery 自动完成插件。

```
/*
* jQuery Autocomplete plugin 1.1
*
* Copyright (c) 2009 Jörn Zaefferer
*
* Dual licensed under the MIT and GPL licenses:
*   http://www.opensource.org/licenses/mit-license.php
*   http://www.gnu.org/licenses/gpl.html
*
* Revision: $Id: jquery.autocomplete.js 15 2009-08-22 10:30:27Z joern.zaefferer $
*/ 
```

它似乎确实根据键对 json 结果进行了排序，但我在代码中找不到任何关于排序选项的提及。

我希望将结果排序为从服务器返回的结果。

结果是这样构建的

```
public function doMemberSelectForSelectById($q, $limit){

    $query = $this->retrieveMemberOrganisations($this->createUnrestrictedQuery('o'))->
      andWhere("o.name like '%".$q."%'")->
      orderBy("o.name")->
      limit(intval($limit));

    $org_data = $query->execute();
    $orgs = array();
    foreach ($org_data as $org){
        $orgs[$org->getId()] = $org->getName();
    }
    return $orgs;
}

$orgs = Doctrine_Core::getTable('Organisation')->
    doMemberSelectForSelectById($request->getParameter('q'), $request->getParameter('limit'));
echo $this->renderText(json_encode($orgs));
    }
return sfView::NONE; 
```

Chrome 开发工具中的结果是（按名称排序）

```
{
    "1781": "1st Mechanical \/ 1st Maintenance",
    "1771": "Acco Building Ltd",
    "203": "Active Welding Limited",
    "443": "Aircon Commissioning & Services Ltd",
    "588": "Akon Electrical Engineering Limited",
    "625": "Alaska Interiors Ltd",
    "796": "Alutech Windows & Doors Ltd",
    "584": "Arrow International Ltd"....
} 
```

触发它的javascript在这里

```
jQuery(document).ready(function() {

    jQuery("#autocomplete_rsvpCompany1").focus(function({
         jQuery(this).val('');});
             jQuery("#autocomplete_rsvpCompany1").autocomplete(
                 'http://www.nzgbc.org.nz/index.php?option=com_nzgbc_member&uri=%2Forganisation%2FjsonListMember%2Faction',
                 jQuery.extend({}, {
                     dataType: 'json',
                     minChars: 0,
                     delay:0,
             max:700,
                     scroll: true, 
                     parse: function(data) {
                 var parsed = [];
                 for (key in data) {
                             parsed[parsed.length] = { data: [ data[key], key ], value: data[key], result: data[key] };
                 }
                 return parsed;
                 }
         }, { })
        ).result(function(event, data) {
            jQuery('#rsvpCompany1').val(data[1]);
        }); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T07:19:25.950

您应该按如下方式更改“解析”方法：

```
parse: function(data) {
  var parsed = [];
  for (key in data) {
    parsed[parsed.length] = { 
      data: [ data[key], key ], 
      value: data[key], 
      result: data[key] 
    };
  }
  parsed.sort(function (a, b){
    var aKey = a.value;
    var bKey = b.value;
    return ((aKey < bKey) ? -1 : ((aKey > bKey) ? 1 : 0));
  });
  return parsed;
} 
```

问题是“数据”数组有一个数字键，因此当您在“for”循环中循环遍历“数据”元素时，您将按数字顺序将元素添加到“解析”数组中（例如： 203、443、584、588 等），因此在将所有元素添加到“已解析”数组后，您必须按“数据 [键]”而不是“键”对其进行排序。

# ruby-on-rails-3 - 生产资产：capistrano 部署期间预编译失败

> ID：12169452
> 
> 赞同：3
> 
> 时间：2012-08-29T00:42:12.423
> 
> 标签：ruby-on-rails-3, capistrano, asset-pipeline

在部署期间，我得到以下输出：

```
[xx.xxx.xxx.xx] executing command
 ** [out :: xx.xxx.xxx.xx] ** Invoke assets:precompile (first_time)
 ** [out :: xx.xxx.xxx.xx] ** Execute assets:precompile
 ** [out :: xx.xxx.xxx.xx] 
 ** [out :: xx.xxx.xxx.xx] ** Invoke assets:precompile:all (first_time)
 ** [out :: xx.xxx.xxx.xx] ** Execute assets:precompile:all
 ** [out :: xx.xxx.xxx.xx] ** Invoke assets:precompile:primary (first_time)
 ** [out :: xx.xxx.xxx.xx] ** Invoke assets:environment (first_time)
 ** [out :: xx.xxx.xxx.xx] ** Execute assets:environment
 ** [out :: xx.xxx.xxx.xx] ** Invoke environment (first_time)
 ** [out :: xx.xxx.xxx.xx] ** Execute environment
 ** [out :: xx.xxx.xxx.xx] ** Invoke tmp:cache:clear (first_time)
 ** [out :: xx.xxx.xxx.xx] ** Execute tmp:cache:clear
 ** [out :: xx.xxx.xxx.xx] ** Execute assets:precompile:primary
 ** [out :: xx.xxx.xxx.xx] Killed 
```

`bundle -v`输出为 1.1.5

我找到的解决方案是重新启动服务器并立即部署。否则，我无法部署到生产环境，并且我不确定如何调试此问题，因为除了在部署时死机之外没有其他输出。

编辑：服务器正在运行 Ubuntu 12.04 x64

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T09:26:02.003

我今天有类似的问题，请尝试以下问题的解决方案

[https://stackoverflow.com/a/11893146](https://stackoverflow.com/a/11893146)

# c# - 如何知道我的对象在 C# 中有多少字节？

> ID：12169453
> 
> 赞同：3
> 
> 时间：2012-08-29T00:42:13.780
> 
> 标签：c#, .net, struct

我正在构建一个应用程序，我需要处理图表中的位置。这个位置有X、Y的值和北、东、南、西的方向。我认为这个位置可能是`Struct`因为它代表该图中的单个值。

我研究并思考`Structs`并发现这些规则可以使用`Struct`：

*   它在逻辑上表示单个值，类似于原始类型（整数、双精度等）。
*   它的实例大小小于 16 字节。
*   它是不可变的。
*   它不必经常装箱。

这是我未完成的示例`Struct`：

```
public struct Position
{
   public long PositionX { get; set; }

   public long PositionY { get; set; }

   public CompassPoint CompassPoint { get; set; }
}

public enum CompassPoint : byte
{
   North,
   East,
   South,
   West
} 
```

我想知道如何计算我的字节大小`Struct`以及如何知道它是否不可变？

谢谢。

**更新：**

好的。根据回复，我似乎`Struct`通过了 16 个字节，因为只有两个`long`有 16 个字节 + 1 个字节`CompassPoint`。

`Struct`但是一个额外的问题是：使用16 字节且不可变的 a 我获得了什么？看看`DateTime` `Struct`，它似乎有超过 16 个字节？任何问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T00:49:48.797

大小取决于`CompassPoint`类型。但是，每个都`long`将使用 8 个字节，因此您已经超过了建议的最大 16 个字节。虽然这不是一个硬性规则，但你可能会得到比它是一个类更差的性能，这取决于你如何使用它。

结构的确切大小由 JIT 编译器确定，但通常您可以添加成员的大小来预测大小。小数据类型会被填充，所以如果你`CompassPoint`只使用一个字节，它仍然需要 4 或 8 个字节来使结构大小达到一个均匀的边界。

该结构不是不可变的，因为您可以更改其中的属性。将 setter 设为私有，并添加一个可以创建它以使其不可变的构造函数：

```
public struct Position {

  public long PositionX { get; private set; }
  public long PositionY { get; private set; }
  public CompassPoint CompassPoint { get; private set; }

  public Position(long x, long y, CompassPoint compass) {
    PositionX = x;
    PositionY = y;
    CompassPoint = compass;
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:02:02.383

您可以使用[Marshal.SizeOf 方法](http://msdn.microsoft.com/en-us/library/y3ybkfb3%28v=vs.100%29.aspx)来获取结构的非托管大小（以字节为单位）：

```
Position pos = new Position(); // this constructor call is not necessary for structs
int sizeInBytes = Marshal.SizeOf(pos); 
```

但请注意，对象的非托管和托管大小有时会有所不同。

# cruisecontrol - 巡航控制服务错误：无法构造 net.sourceforge.cruisecontrol.BuildLoopInformation 因为它没有无参数构造函数

> ID：12169454
> 
> 赞同：7
> 
> 时间：2012-08-29T00:42:17.210
> 
> 标签：cruisecontrol

当尝试将 Cruise Control 作为服务运行时（在本例中为 Windows 7、64 位），我收到错误消息：

`com.thoughtworks.xstream.converters.ConversionException: Cannot construct net.sourceforge.cruisecontrol.BuildLoopInformation as it does not have a no-args constructor`

完整的错误信息是：

`INFO | jvm 1 | 2012/08/27 17:16:28 | 2012-08-27 17:16:28.262::WARN: /dashboard/buildloop/listener INFO | jvm 1 | 2012/08/27 17:16:28 | com.thoughtworks.xstream.converters.ConversionException: Cannot construct net.sourceforge.cruisecontrol.BuildLoopInformation as it does not have a no-args constructor INFO | jvm 1 | 2012/08/27 17:16:28 | ---- Debugging information ---- INFO | jvm 1 | 2012/08/27 17:16:28 | message : Cannot construct net.sourceforge.cruisecontrol.BuildLoopInformation as it does not have a no-args constructor INFO | jvm 1 | 2012/08/27 17:16:28 | cause-exception : com.thoughtworks.xstream.converters.reflection.ObjectAccessException INFO | jvm 1 | 2012/08/27 17:16:28 | cause-message : Cannot construct net.sourceforge.cruisecontrol.BuildLoopInformation as it does not have a no-args constructor INFO | jvm 1 | 2012/08/27 17:16:28 | class : net.sourceforge.cruisecontrol.BuildLoopInformation INFO | jvm 1 | 2012/08/27 17:16:28 | required-type : net.sourceforge.cruisecontrol.BuildLoopInformation INFO | jvm 1 | 2012/08/27 17:16:28 | path : /buildloop INFO | jvm 1 | 2012/08/27 17:16:28 | line number : 1 INFO | jvm 1 | 2012/08/27 17:16:28 | ------------------------------- INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshaller.java:63) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.core.AbstractReferenceUnmarshaller.convert(AbstractReferenceUnmarshaller.java:45) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnmarshaller.java:46) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.core.TreeUnmarshaller.start(TreeUnmarshaller.java:117) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.core.ReferenceByXPathMarshallingStrategy.unmarshal(ReferenceByXPathMarshallingStrategy.java:29) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:846) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.XStream.unmarshal(XStream.java:833) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.XStream.fromXML(XStream.java:781) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.XStream.fromXML(XStream.java:773) INFO | jvm 1 | 2012/08/27 17:16:28 | at net.sourceforge.cruisecontrol.util.BuildInformationHelper.toObject(BuildInformationHelper.java:32) INFO | jvm 1 | 2012/08/27 17:16:28 | at net.sourceforge.cruisecontrol.dashboard.web.BuildLoopController.handleRequestInternal(BuildLoopController.java:28) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:858) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:792) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:476) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:441) INFO | jvm 1 | 2012/08/27 17:16:28 | at javax.servlet.http.HttpServlet.service(HttpServlet.java:727) INFO | jvm 1 | 2012/08/27 17:16:28 | at javax.servlet.http.HttpServlet.service(HttpServlet.java:820) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:362) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:729) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.Server.handle(Server.java:324) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:843) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:647) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395) INFO | jvm 1 | 2012/08/27 17:16:28 | at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488) INFO | jvm 1 | 2012/08/27 17:16:28 | Caused by: com.thoughtworks.xstream.converters.reflection.ObjectAccessException: Cannot construct net.sourceforge.cruisecontrol.BuildLoopInformation as it does not have a no-args constructor INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.converters.reflection.PureJavaReflectionProvider.newInstance(PureJavaReflectionProvider.java:59) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.converters.reflection.AbstractReflectionConverter.instantiateNewInstance(AbstractReflectionConverter.java:257) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.converters.reflection.AbstractReflectionConverter.unmarshal(AbstractReflectionConverter.java:124) INFO | jvm 1 | 2012/08/27 17:16:28 | at com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshaller.java:56) INFO | jvm 1 | 2012/08/27 17:16:28 | ... 35 more`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T02:33:18.777

事实证明，Java 7 中的某些东西表现不佳，所以只需回滚到 Java 6。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-20T08:38:41.553

由于 Java 官方网站上没有提供 Java 6，因此获得 Java 6 可能有点困难。

我没有安装 Java 6，而是使用了这篇博客中描述的方法：[CruiseControl 2.8.4 和 JDK7](http://tyom.blogspot.com/2013/01/cruisecontrol-284-and-jdk7.html)：

> 或将 lib/ 和 ebapps/dashboard/WEB-INF/lib/ 中的 xstream-1.2.2.jar 和 xpp3_min-1.1.3.4.O.jar 文件替换为 xstream-1.4.1.jar 和 kxml2-2.3.0。分别是罐子。

有效！

# javascript - JavaScript 移除未知监听器

> ID：12169456
> 
> 赞同：1
> 
> 时间：2012-08-29T00:42:35.947
> 
> 标签：javascript, addeventlistener, event-listener

我有自己的页面，我在其中加载了分析我的 DOM 的外部第三方 JavaScript。我面临的问题如下。我安装了一些事件监听器（'keypress'、'input'、'click'），但是在我附加提到的脚本（并且她执行一些计算）之后，我的一些监听器不再工作了。准确地说，“点击”侦听器正在按预期拦截点击事件，但其他两个没有拦截任何内容。有没有办法让那个外部脚本干扰我的听众？

顺便说一句，我在安装侦听器时将 useCapture 设置为 true，如下所示：

```
document.addEventListener('input', function...., true);
... 
```

我没有任何其他代码可以提供给您。

PS 我无法使用外部代码，因为它被混淆了。PPS 再次安装处理程序没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T00:47:23.377

第三方代码有可能（尽管不太可能）在事件之前捕获事件并阻止它传播（`e.stopPropagation()`）。这将需要代码在捕获阶段将侦听器附加到父元素上的同一事件。

没有更多代码可以查看，尤其是这个第三方代码，很难找到实际问题。

# c# - 如何在 C# 中创建 Excel 文件；办公室 2007; 赢7 64位？

> ID：12169462
> 
> 赞同：0
> 
> 时间：2012-08-29T00:43:48.147
> 
> 标签：c#, excel-2007, oledbcommand, oledbexception

以前我的 C# 应用程序使用此命令创建 Excel 文件：

```
try
        {
            //SELECT INTO command                
            string cnStr = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + AccfilePath +
               ";Persist Security Info=False";

            ConnOpen(cnStr);

            using (connectionToDatabase)
            {
                //Give the Export Table (destination) a Name
                //baseTblName = dt.TableName;

                //Generate the SQL string to SELECT * INTO the NEW table in destination
                string selectcmd = "SELECT * INTO [Excel 12.0;Database=c:\\"+ExfilePath+"]." + tblName + " FROM " + tblName;

                using (OleDbCommand createCmd = new OleDbCommand(selectcmd, connectionToDatabase))
                {
                    createCmd.ExecuteNonQuery();
                }

                ConnClose();
            }

        } 
```

我已经转移到 Win 7 64 位，现在 OleDbCommand 给了我一个“创建文件失败”。我已经将用户设置为管理员，因为我认为这是一个安全问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:17:58.367

这个 Oledb 命令没有问题。我整天都在与 64 位问题作斗争，并假设确实存在。我的文件路径语法不正确；在我修复它按预期工作之后。

# asynchronous - F# 异步挂起

> ID：12169463
> 
> 赞同：5
> 
> 时间：2012-08-29T00:43:51.880
> 
> 标签：asynchronous, f#

我有一些相当简单的 F# 异步代码可以从 Wikipedia 下载一百篇随机文章（用于研究）。

出于某种原因，代码在下载过程中会在任意时间点挂起。有时是50后，有时是80后。

异步代码本身相当简单：

```
let parseWikiAsync(url:string, count:int ref) =
    async {
            use wc = new WebClientWithTimeout(Timeout = 5000)
            let! html = wc.AsyncDownloadString(Uri(url))
            let ret =
                try html |> parseDoc |> parseArticle
                with | ex -> printfn "%A" ex; None
            lock count (fun () ->
                if !count % 10 = 0 then
                    printfn "%d" !count
                count := !count + 1
            )
            return ret
    } 
```

因为我无法通过 fsi 找出问题所在，所以我制作了 WebClientWithTimeout，这是一个`System.Net.WebClient`允许我指定超时的包装器：

```
type WebClientWithTimeout() =
    inherit WebClient()
    member val Timeout = 60000 with get, set

    override x.GetWebRequest uri =
        let r = base.GetWebRequest(uri)
        r.Timeout <- x.Timeout
        r 
```

然后我使用异步组合器检索超过一百页，并清除所有返回 parseWikiAsync 调用的文章`None`（其中大部分是“消歧页”），直到我有正好 100 篇文章：

```
let en100 =
    let count = ref 0
    seq { for _ in 1..110 -> parseWikiAsync("http://en.wikipedia.org/wiki/Special:Random", count) }
    |> Async.Parallel
    |> Async.RunSynchronously
    |> Seq.choose id
    |> Seq.take 100 
```

当我编译代码并在调试器中运行它时，只有三个线程，其中只有一个正在运行实际代码——异步管道。另外两个“不可用”的位置，调用堆栈中没有任何内容。

我认为这意味着它不会卡`AsyncDownloadString`在 parseWikiAsync 的任何地方或任何地方。还有什么可能导致这种情况？

哦，另外，异步代码实际开始之前大约需要整整一分钟。之后，它以相当合理的速度运行，直到它再次无限期挂起。

这是主线程的调用堆栈：

```
>   mscorlib.dll!System.Threading.WaitHandle.InternalWaitOne(System.Runtime.InteropServices.SafeHandle waitableSafeHandle, long millisecondsTimeout, bool hasThreadAffinity, bool exitContext) + 0x22 bytes 
    mscorlib.dll!System.Threading.WaitHandle.WaitOne(int millisecondsTimeout, bool exitContext) + 0x28 bytes    
    FSharp.Core.dll!Microsoft.FSharp.Control.AsyncImpl.ResultCell<Microsoft.FSharp.Control.AsyncBuilderImpl.Result<Microsoft.FSharp.Core.FSharpOption<Program.ArticleData>[]>>.TryWaitForResultSynchronously(Microsoft.FSharp.Core.FSharpOption<int> timeout) + 0x36 bytes  
    FSharp.Core.dll!Microsoft.FSharp.Control.CancellationTokenOps.RunSynchronously<Microsoft.FSharp.Core.FSharpOption<Program.ArticleData>[]>(System.Threading.CancellationToken token, Microsoft.FSharp.Control.FSharpAsync<Microsoft.FSharp.Core.FSharpOption<Program.ArticleData>[]> computation, Microsoft.FSharp.Core.FSharpOption<int> timeout) + 0x1ba bytes 
    FSharp.Core.dll!Microsoft.FSharp.Control.FSharpAsync.RunSynchronously<Microsoft.FSharp.Core.FSharpOption<Program.ArticleData>[]>(Microsoft.FSharp.Control.FSharpAsync<Microsoft.FSharp.Core.FSharpOption<Program.ArticleData>[]> computation, Microsoft.FSharp.Core.FSharpOption<int> timeout, Microsoft.FSharp.Core.FSharpOption<System.Threading.CancellationToken> cancellationToken) + 0xb9 bytes   
    WikiSurvey.exe!<StartupCode$WikiSurvey>.$Program.main@() Line 97 + 0x55 bytes   F# 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T18:26:47.550

在这里不应该责怪维基百科，这是`Async.Parallel`内部运作方式的结果。的类型签名`Async.Parallel`是`seq<Async<'T>> -> Async<'T[]>`. *它返回一个包含序列中所有结果的单个 Async 值——因此在返回中的所有*计算之前它不会`seq<Async<'T>>`返回。

为了说明，我修改了您的代码，以便跟踪未完成请求的数量，即已发送到服务器但尚未接收/解析响应的请求。

```
open Microsoft.FSharp.Control
open Microsoft.FSharp.Control.WebExtensions
open System
open System.Net
open System.Threading

type WebClientWithTimeout() =
    inherit WebClient()

    let mutable timeout = -1
    member __.Timeout
        with get () = timeout
        and set value = timeout <- value

    override x.GetWebRequest uri =
        let r = base.GetWebRequest(uri)
        r.Timeout <- x.Timeout
        r

type ParsedDoc = ParsedDoc
type ParsedArticle = ParsedArticle

let parseDoc (str : string) = ParsedDoc
let parseArticle (doc : ParsedDoc) = Some ParsedArticle

/// A synchronized wrapper around Console.Out so we don't
/// get garbled console output.
let synchedOut =
    System.Console.Out
    |> System.IO.TextWriter.Synchronized

let parseWikiAsync(url : string, outstandingRequestCount : int ref) =
    async {
    use wc = new WebClientWithTimeout(Timeout = 5000)
    wc.Headers.Add ("User-Agent", "Friendly Bot 1.0 (FriendlyBot@friendlybot.com)")

    // Increment the outstanding request count just before we send the request.
    do
        // NOTE : The message must be created THEN passed to synchedOut.WriteLine --
        // piping it (|>) into synchedOut.WriteLine or using fprintfn causes a closure
        // to be created which somehow defeats the synchronization and garbles the output.
        let msg =
            Interlocked.Increment outstandingRequestCount
            |> sprintf "Outstanding requests: %i"
        synchedOut.WriteLine msg

    let! html = wc.AsyncDownloadString(Uri(url))
    let ret =
        try html |> parseDoc |> parseArticle
        with ex ->
            let msg = sprintf "%A" ex
            synchedOut.WriteLine msg
            None

    // Decrement the outstanding request count now that we've
    // received a reponse and parsed it.
    do
        let msg =
            Interlocked.Decrement outstandingRequestCount
            |> sprintf "Outstanding requests: %i"
        synchedOut.WriteLine msg

    return ret
    }

/// Writes a message to the console, passing a value through
/// so it can be used within a function pipeline.
let inline passThruWithMessage (msg : string) value =
    Console.WriteLine msg
    value

let en100 =
    let outstandingRequestCount = ref 0
    seq { for _ in 1..120 ->
            parseWikiAsync("http://en.wikipedia.org/wiki/Special:Random", outstandingRequestCount) }
    |> Async.Parallel
    |> Async.RunSynchronously
    |> passThruWithMessage "Finished running all of the requests."
    |> Seq.choose id
    |> Seq.take 100 
```

如果您编译并运行该代码，您将看到如下输出：

```
Outstanding requests: 4
Outstanding requests: 2
Outstanding requests: 1
Outstanding requests: 3
Outstanding requests: 5
Outstanding requests: 6
Outstanding requests: 7
Outstanding requests: 8
Outstanding requests: 9
Outstanding requests: 10
Outstanding requests: 12
Outstanding requests: 14
Outstanding requests: 15
Outstanding requests: 16
Outstanding requests: 17
Outstanding requests: 18
Outstanding requests: 13
Outstanding requests: 19
Outstanding requests: 20
Outstanding requests: 24
Outstanding requests: 22
Outstanding requests: 26
Outstanding requests: 27
Outstanding requests: 28
Outstanding requests: 29
Outstanding requests: 30
Outstanding requests: 25
Outstanding requests: 21
Outstanding requests: 23
Outstanding requests: 11
Outstanding requests: 29
Outstanding requests: 28
Outstanding requests: 27
Outstanding requests: 26
Outstanding requests: 25
Outstanding requests: 24
Outstanding requests: 23
Outstanding requests: 22
Outstanding requests: 21
Outstanding requests: 20
Outstanding requests: 19
Outstanding requests: 18
Outstanding requests: 17
Outstanding requests: 16
Outstanding requests: 15
Outstanding requests: 14
Outstanding requests: 13
Outstanding requests: 12
Outstanding requests: 11
Outstanding requests: 10
Outstanding requests: 9
Outstanding requests: 8
Outstanding requests: 7
Outstanding requests: 6
Outstanding requests: 5
Outstanding requests: 4
Outstanding requests: 3
Outstanding requests: 2
Outstanding requests: 1
Outstanding requests: 0
Finished running all of the requests. 
```

如您所见，所有请求都是在解析之前*发出*的——因此，如果您的连接速度较慢，或者您正在尝试检索大量文档，则服务器可能会断开连接，因为它可能会假设您没有检索它试图发送的响应。代码的另一个问题是您需要在 中明确指定要生成的元素数量`seq`，这会降低代码的可重用性。

更好的解决方案是在某些消费代码需要时检索和解析页面。（如果你想一想，这正是 F#`seq`的优点。）我们将首先创建一个函数，该函数接受一个 Uri 并产生一个`seq<Async<'T>>`- 即，它产生一个无限的`Async<'T>`值序列，每个值都将检索来自 Uri 的内容，对其进行解析并返回结果。

```
/// Given a Uri, creates an infinite sequence of whose elements are retrieved
/// from the Uri.
let createDocumentSeq (uri : System.Uri) =
    #if DEBUG
    let outstandingRequestCount = ref 0
    #endif

    Seq.initInfinite <| fun _ ->
        async {
        use wc = new WebClientWithTimeout(Timeout = 5000)
        wc.Headers.Add ("User-Agent", "Friendly Bot 1.0 (FriendlyBot@friendlybot.com)")

        #if DEBUG
        // Increment the outstanding request count just before we send the request.
        do
            // NOTE : The message must be created THEN passed to synchedOut.WriteLine --
            // piping it (|>) into synchedOut.WriteLine or using fprintfn causes a closure
            // to be created which somehow defeats the synchronization and garbles the output.
            let msg =
                Interlocked.Increment outstandingRequestCount
                |> sprintf "Outstanding requests: %i"
            synchedOut.WriteLine msg
        #endif

        let! html = wc.AsyncDownloadString uri
        let ret =
            try Some html
            with ex ->
                let msg = sprintf "%A" ex
                synchedOut.WriteLine msg
                None

        #if DEBUG
        // Decrement the outstanding request count now that we've
        // received a reponse and parsed it.
        do
            let msg =
                Interlocked.Decrement outstandingRequestCount
                |> sprintf "Outstanding requests: %i"
            synchedOut.WriteLine msg
        #endif

        return ret
        } 
```

现在我们使用此函数将页面作为流检索：

```
//
let en100_Streaming =
    #if DEBUG
    let documentCount = ref 0
    #endif

    Uri ("http://en.wikipedia.org/wiki/Special:Random")
    |> createDocumentSeq
    |> Seq.choose (fun asyncDoc ->
        Async.RunSynchronously asyncDoc
        |> Option.bind (parseDoc >> parseArticle))
    #if DEBUG
    |> Seq.map (fun x ->
        let msg =
            Interlocked.Increment documentCount
            |> sprintf "Parsed documents: %i"
        synchedOut.WriteLine msg
        x)
    #endif
    |> Seq.take 50
    // None of the computations actually take place until
    // this point, because Seq.toArray forces evaluation of the sequence.
    |> Seq.toArray 
```

如果您运行该代码，您会看到它一次从服务器中提取一个结果，并且不会留下未完成的请求。此外，更改要检索的结果数量非常容易——您需要做的就是更改传递给`Seq.take`.

现在，虽然流式代码工作得很好，但它不会并行执行请求，因此对于大量文档可能会很慢。这是一个很容易解决的问题，尽管解决方案可能有点不直观。与其尝试并行执行整个请求序列——这是原始代码中的问题——让我们创建一个函数，用于并行`Async.Parallel`执行**小**批量请求，然后`Seq.collect`将结果组合回一个平面序列.

```
/// Given a sequence of Async<'T>, creates a new sequence whose elements
/// are computed in batches of a specified size.
let parallelBatch batchSize (sequence : seq<Async<'T>>) =
    sequence
    |> Seq.windowed batchSize
    |> Seq.collect (fun batch ->
        batch
        |> Async.Parallel
        |> Async.RunSynchronously) 
```

要使用这个功能，我们只需要对流媒体版本的代码进行一些小的调整：

```
let en100_Batched =
    let batchSize = 10
    #if DEBUG
    let documentCount = ref 0
    #endif

    Uri ("http://en.wikipedia.org/wiki/Special:Random")
    |> createDocumentSeq
    // Execute batches in parallel
    |> parallelBatch batchSize
    |> Seq.choose (Option.bind (parseDoc >> parseArticle))
    #if DEBUG
    |> Seq.map (fun x ->
        let msg =
            Interlocked.Increment documentCount
            |> sprintf "Parsed documents: %i"
        synchedOut.WriteLine msg
        x)
    #endif
    |> Seq.take 50
    // None of the computations actually take place until
    // this point, because Seq.toArray forces evaluation of the sequence.
    |> Seq.toArray 
```

同样，更改要检索的文档数量很容易，并且可以轻松修改批量大小（再次，我建议您将其保持在合理的小范围内）。如果您愿意，您可以对“流式处理”和“批处理”代码进行一些调整，以便在运行时在它们之间切换。

最后一件事——使用我的代码，请求不应该超时，因此您可能可以摆脱`WebClientWithTimeout`该类并直接使用`WebClient`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T04:12:34.457

您的代码似乎没有做任何特别的事情，所以我假设维基百科不喜欢您的活动。看看他们的[机器人政策](http://en.wikipedia.org/wiki/Wikipedia%3aBot_policy)。再深入一点，他们似乎也有严格的[用户代理政策](http://meta.wikimedia.org/wiki/User-Agent_policy)

> 自 2010 年 2 月 15 日起，维基媒体站点要求所有请求的 HTTP 用户代理标头。这是技术人员做出的操作性决定，并在技术邮件列表中公布和讨论。[1][2] 理由是，不发送 User-Agent 字符串的客户端大多是行为不端的脚本，会导致服务器上的大量负载，而不会使项目受益。请注意，用户代理字符串的非描述性默认值（例如 Perl 的 libwww 使用的）也可能会被阻止使用 Wikimedia 网站（或部分网站，例如 api.php）。
> 
> 不发送 User-Agent 标头的用户代理（浏览器或脚本）现在可能会遇到如下错误消息：
> 
> 脚本应使用包含联系信息的用户代理字符串，否则它们可能会被 IP 阻止，恕不另行通知。

因此，根据我的发现，即使您添加了适当的用户代理，他们也可能不喜欢您正在做的事情，但您不妨试一试。

```
wc.Headers.Add ("User-Agent", "Friendly Bot 1.0 (FriendlyBot@friendlybot.com)") 
```

避免与他们的服务器建立如此多的连接也没有什么坏处。

# ruby-on-rails - 如何使用 fb_graph 邀请来自 facebook 的朋友？

> ID：12169472
> 
> 赞同：4
> 
> 时间：2012-08-29T00:44:55.803
> 
> 标签：ruby-on-rails, facebook, fb-graph

基本上，我想显示一个朋友列表（带有图片和姓名）并邀请他们加入我正在使用`fb_graph`gem 在 rails 中创建的应用程序。该链接显示了它的工作流程，基本上您将单击“邀请朋友”按钮，然后会弹出一个朋友列表，其中包含一个允许您邀请相应用户的按钮。

[http://www.quora.com/User-Acquisition/What-is-the-best-invite-a-friend-flow-for-mobile](http://www.quora.com/User-Acquisition/What-is-the-best-invite-a-friend-flow-for-mobile)

有没有办法做到这一点`fb_graph`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T08:04:01.110

你打赌。假设您有 fb_graph 的有效实现，您可以使用以下命令（来自[https://github.com/nov/fb_graph](https://github.com/nov/fb_graph)）获取朋友列表：

```
FbGraph::User.me(fb_token).friends 
```

您可以使用它为您的朋友列表生成您的 UI，然后邀请选定的朋友，就像这样（来自上一个链接的未经测试的修改，以及[https://developers.facebook.com/docs/reference/dialogs/requests/](https://developers.facebook.com/docs/reference/dialogs/requests/) ):

```
app_request = FbGraph::User.me(token).app_request!(
  :message => 'invitation message',
  :to      => friend.uid
) 
```

前面的代码也可以接受以逗号分隔的 UID 集合。

我将留给您设计和编写 UI 代码，但使用 fb_graph 是可能的，这是肯定的。如果您决定扩大范围，这两个链接应该是纯金的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T17:56:18.767

感谢您对我的宝石的关注。

[Brad Werth 的代码](https://stackoverflow.com/a/12234341/525478)适用于现有（= 已安装您的应用程序）用户，但可能不适用于新用户。

在后台发送应用程序请求以避免垃圾邮件有很多限制。该限制直接影响 fb_graph 的发送应用请求功能。

如果您正在开发 iOS 应用程序，我建议您使用 FB 官方 iOS SDK。 [https://developers.facebook.com/docs/howtos/send-requests-using-ios-sdk/](https://developers.facebook.com/docs/howtos/send-requests-using-ios-sdk/)

使用 iOS SDK（或 html5 应用程序中的 JS SDK），您的限制更少。

附言。我不熟悉 Android App 开发也不熟悉 FB 官方 Android SDK，但我认为他们的 Android SDK 中也有类似的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T15:32:23.000

这可能会有所帮助，我在我的 PHP 服务器上使用它并且它有效。

此代码可帮助您发布、发送消息以及向您的朋友发送请求。

**头标：**

```
<script type="text/javascript">
  function logResponse(response) {
    if (console && console.log) {
      console.log('The response was', response);
    }
  }

  $(function(){
    // Set up so we handle click on the buttons
    $('#postToWall').click(function() {
      FB.ui(
        {
          method : 'feed',
          link   : $(this).attr('data-url')
        },
        function (response) {
          // If response is null the user canceled the dialog
          if (response != null) {
            logResponse(response);
          }
        }
      );
    });

    $('#sendToFriends').click(function() {
      FB.ui(
        {
          method : 'send',
          link   : $(this).attr('data-url')
        },
        function (response) {
          // If response is null the user canceled the dialog
          if (response != null) {
            logResponse(response);
          }
        }
      );
    });

    $('#sendRequest').click(function() {
      FB.ui(
        {
          method  : 'apprequests',
          message : $(this).attr('data-message')
        },
        function (response) {
          // If response is null the user canceled the dialog
          if (response != null) {
            logResponse(response);
          }
        }
      );
    });
  });
</script> 
```

**身体标签：**

```
<body>
<div id="fb-root"></div>
<script type="text/javascript">
  window.fbAsyncInit = function() {
    FB.init({
      appId      : 'xxxxxxxxxxxxxxxxxxx', // App ID
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true // parse XFBML
    });

    // Listen to the auth.login which will be called when the user logs in
    // using the Login button
    FB.Event.subscribe('auth.login', function(response) {
      // We want to reload the page now so PHP can read the cookie that the
      // Javascript SDK sat. But we don't want to use
      // window.location.reload() because if this is in a canvas there was a
      // post made to this page and a reload will trigger a message to the
      // user asking if they want to send data again.
      window.location = window.location;
    });

    FB.Canvas.setAutoGrow();
  };

  // Load the SDK Asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<header class="clearfix">
  <?php if (isset($basic)) { ?>
  <p id="picture" style="background-image: url(https://graph.facebook.com/<?php echo he($user_id); ?>/picture?type=normal)"></p>

  <div>
    <h1>Welcome, <strong><?php echo he(idx($basic, 'name')); ?></strong></h1>
    <p class="tagline">
      This is your app
      <a href="<?php echo he(idx($app_info, 'link'));?>" target="_top"><?php echo he($app_name); ?></a>
    </p>

    <div id="share-app">
      <p>Share your app:</p>
      <ul>
        <li>
          <a href="#" class="facebook-button" id="postToWall" data-url="<?php echo AppInfo::getUrl(); ?>">
            <span class="plus">Post to Wall</span>
          </a>
        </li>
        <li>
          <a href="#" class="facebook-button speech-bubble" id="sendToFriends" data-url="<?php echo AppInfo::getUrl(); ?>">
            <span class="speech-bubble">Send Message</span>
          </a>
        </li>
        <li>
          <a href="#" class="facebook-button apprequests" id="sendRequest" data-message="Test this awesome app">
            <span class="apprequests">Send Requests</span>
          </a>
        </li>
      </ul>
    </div>
  </div>
  <?php } else { ?>
  <div>
    <h1>Welcome</h1>
    <div class="fb-login-button" data-scope="user_likes,user_photos"></div>
  </div>
  <?php } ?>
</header> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T06:44:45.513

当然，Facebook 提供了一个漂亮的对话框来选择您想要向其发送请求的朋友。但也有一个不错的工具，内置在 javascript 中，通过它您可以拥有相同类型的 Facebook 好友选择器对话框。

[JQuery Facebook 多朋友选择器插件](http://archives-mike.brevoort.com/2010/08/10/introducing-the-jquery-facebook-multi-friend-selector-plugin/index.html)

该插件将对 Facebook 进行 Graph API 调用并收集您的朋友列表。这个插件的优点是它会以“懒加载模式”加载所有好友列表。

# rdf - 有没有用 N3/Turtle 本体语言创建类的捷径

> ID：12169473
> 
> 赞同：5
> 
> 时间：2012-08-29T00:44:59.210
> 
> 标签：rdf, semantic-web, n3, turtle-rdf

以下是我知道在 N3 中创建类的方法：

```
:Person a rdfs:Class. 
```

以下是如何指定特定资源是该类的实例：

```
:Pat a :Person. 
```

**问题**：我想创建一个包含超过 20000 个实例（以编程方式生成）的类。为我的 20000 个实例编写整体`:Pat a :Person.`会使本体文件变得冗长。

**问题**：有没有办法让文件变小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T07:41:32.203

如果您真的使用 N3 而不是 Turtle（我对此表示怀疑），则可以使用`@is ... @of`关键字，如下所示：

```
:Person  a  rdfs:Class;
    @is a @of  :Pat, :Bob, :Chris, :Cindy, :Suzy . 
```

几乎没有任何 Turtle 工具包允许这样做。

[在public-rdf-comments@w3.org Mail Archives](http://lists.w3.org/Archives/Public/public-rdf-comments/)上还有一个关于将这个功能添加到[Turtle](http://www.w3.org/TR/2012/WD-turtle-20120710/)的长讨论线程（目前由 W3C 作为 Last Call Working Draft 发布），从[Tim Berners 的评论开始 -李](http://lists.w3.org/Archives/Public/public-rdf-comments/2012Jul/0007.html)。然后[Dave Beckett 发表评论，](http://lists.w3.org/Archives/Public/public-rdf-comments/2012Aug/0032.html)要求*不*包括该功能，然后又是一个长线程。然后，当前 RDF 工作组中 Turtle 规范的编辑[Gavin Carothers](http://lists.w3.org/Archives/Public/public-rdf-comments/2012Aug/0053.html)对这些立场进行了很好的总结。

但是，我怀疑这将成为 Turtle 最终标准化时的一个功能。

顺便说一句，当全部以编程方式生成（我猜是解析）时，拥有 20,000 条记录有什么问题？如果您需要通过网络交换如此多的数据，您可以轻松地对其进行大量压缩。或者，您可以使用[HDT](http://www.w3.org/Submission/2011/03/)之类的紧凑序列化语法，但实现很少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T11:59:00.477

您可以为完整的类 URI 定义一个自定义前缀，然后只需使用该前缀来引用该类：

```
@prefix : <http://example.com/myOntology#>.
@prefix x: <http://example.com/myOntology#MyClass>.

:Alice a x: .
:Bob a x: .
:Charlie a x: . 
```

这不完全可读，但尽可能短。

我同意安托万的观点，这种诡计毫无意义。磁盘空间很便宜，而且这些东西可以很好地压缩网络传输，并且为了在应用程序中进行处理，无论如何它都会被扩展。

# quartz.net - Quartz.net CRON 表达式总是返回一个月的最后一天？

> ID：12169475
> 
> 赞同：0
> 
> 时间：2012-08-29T00:45:10.643
> 
> 标签：quartz.net, cronexpression

我是石英新手。

我只是想找出 Quartz.net 是否可以在给定开始日期（可能是过去）、结束日期和间隔计算正确的日期出现的情况下——它可能不是 Quartz 的主要用例，但它似乎可以从我可以从 API 中发现什么。

所以给定这个片段：

var exp = new CronExpression("0 0 0 1/7 * ? *");

```
 var next = exp.GetNextValidTimeAfter(new DateTime(2012, 1, 1, 12, 30, 00).ToUniversalTime());
    while (next < DateTime.Parse("30 Oct 2012"))
    {
        next = exp.GetNextValidTimeAfter(next.Value);
        System.Diagnostics.Debug.WriteLine(next);
    } 
```

结果似乎是（截断）：

2012 年 1 月 14 日上午 11:00:00 +00:00

21/01/2012 上午 11:00:00 +00:00

28/01/2012 上午 11:00:00 +00:00

***2012 年 1 月 31 日上午 11:00:00 +00:00***

2012 年 7 月 2 日上午 11:00:00 +00:00

14/02/2012 上午 11:00:00 +00:00

21/02/2012 上午 11:00:00 +00:00

2012 年 2 月 28 日上午 11:00:00 +00:00

***2012 年 2 月 29 日上午 11:00:00 +00:00***

2012 年 7 月 3 日上午 11:00:00 +00:00

Errr... 似乎 Quartz 的 CRON 表达式总是包括一个月的最后一天，并且基本上从那里计算下一个日期？还是我对石英 / cron 的期望/理解是错误的？

这些结果似乎也使用[http://www.cronmaker.com/](http://www.cronmaker.com/)来支持...

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T23:13:38.787

我不认为你不能用 cron 表达式来实现你正在寻找的东西。

如果您下载并使用[Quartz.Net 2.x ，您可以使用一种称为](https://github.com/quartznet/quartznet)[CalendarIntervalTrigger](http://jvilalta.blogspot.co.uk/2011/01/new-in-quartznet-20the-calendar.html)的新型触发器，它可用于管理不同的间隔单位。

我已经测试了这段代码，它按您期望的方式工作：

```
DateTimeOffset startCalendar = DateBuilder.DateOf(11, 0, 0, 14, 1, 2012);

var weeklyTrigger = new CalendarIntervalTriggerImpl
{
    StartTimeUtc = startCalendar,
    RepeatIntervalUnit = IntervalUnit.Week,
    RepeatInterval = 1  // every one week;
};

IList<DateTimeOffset> fireTimes = TriggerUtils.ComputeFireTimes(weeklyTrigger, null, 10);

foreach (var item in fireTimes)
{
    Console.WriteLine(item);
}
Console.ReadLine(); 
```

结果：

> 2012 年 1 月 14 日11:00:00 +00:00
> 2012 年 1 月 21 日 11:00:00 +00 :00 2012 年 1 月 28 日
> 11:00:00 +00:00 2012 年 4 月 2 日
> 11:00 :00 +00:00
> 11/02/2012 11:00:00 +00:00
> 18/02/2012 11:00:00 +00:00
> 25/02/2012 11:00:00 +00:00
> 03/ 2012年 3 月 11:00:00 +00:00 2012
> 年 10 月 3 日 11:00:00 +00:00 2012 年 3 月 17 日 11:00:00
> +00:00

# javascript - 将属性作为字符串存储在变量中

> ID：12169480
> 
> 赞同：0
> 
> 时间：2012-08-29T00:45:48.273
> 
> 标签：javascript, jquery, class, attributes

我正在尝试使用属性的名称并将其放在选择器中，但它不起作用。我以前用身份证做过很多次。

```
var x = $('input:checked').attr('value');//this should return the value. 
```

然后我有一个同名的div：

```
$('.' + x).show(); 
```

当 x 单独使用时，它会在我使用 firebug 控制台时将其显示为字符串，但是当我将它与 show() 一起使用时，什么也没有发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T00:50:40.747

您的代码工作正常，但请验证以下内容：

1.  `input`实际上是`checked`；
2.  存在一个元素，其**`class`**是复选框`value`的。`checked`

这是您的代码的工作**[演示](http://jsfiddle.net/HwyFZ/)**。

> 然后我有一个同名的div：

你的意思是一个属性`name`等于`checkbox`值的div吗？如果是，则需要`$('[name="' + x + '"]').show()`改用。点选择器用于*类*。

# silverlight - Silverlight datagrid 使用组合框选择显示或隐藏控件

> ID：12169482
> 
> 赞同：0
> 
> 时间：2012-08-29T00:46:17.710
> 
> 标签：silverlight, datagrid

为了更短，假设我有一个带有组合框、文本框和另一个组合框的 Datagrid。我想根据第一个 Combo 选择的值显示或隐藏文本或组合框

```
 <sdk:DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition/>
                                                    </Grid.ColumnDefinitions>
                                                    <ComboBox x:Name="cboThenConstOrCol" SelectedIndex="0" SelectedItem="{Binding Source={StaticResource VM}, Path=cboElseSelectedItem, Mode=TwoWay}">
                                                        <ComboBoxItem Content="None"/>
                                                        <ComboBoxItem Content="Const" />
                                                        <ComboBoxItem Content="Col"/>
                                                    </ComboBox>
                                                    <TextBox Grid.Column="1" Text="{Binding ElseConst}" Visibility="{Binding Source={StaticResource VM}, Path= IsVisibleElseConst}" IsTabStop="{Binding Source={StaticResource VM}, Path=isElseConstTabStop}"></TextBox>
                                                    <ComboBox Grid.Column="1" ItemsSource="{Binding Source={StaticResource VM}, Path=Fields,Mode=OneWay}" Visibility="{Binding Source={StaticResource VM}, Path= IsVisibleElseCol}" DisplayMemberPath="FieldName" />
                                                </Grid>
                                            </DataTemplate>
                                        </sdk:DataGridTemplateColumn.CellTemplate> 
```

在我的 Viewmodel 中，我正在处理显示或隐藏并且工作正常，但问题是当我使文本框可见时，所有行中的所有文本框都变得可见。我想要的只是应用于组合框选定项已更改的行。我希望我很清楚，否则请让我知道添加其他信息。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:00:56.910

据我所知，您有一个可以控制一切的 ViewModel。我认为这样做会遇到问题，虽然一开始这样做似乎更容易，但绝对不是在引入任何复杂性时。我要做的是更多地拥抱 MVVM，并为每个 Rows 代表的项目创建一个 ViewModel。这允许每一行保持它自己的状态。这是一个基于您提供的示例：

修改后的 XAML（不完整）：

```
<UserControl.Resources>
    <local:VM
        x:Key="vm" />
</UserControl.Resources>
<Grid
    DataContext="{StaticResource vm}"
    x:Name="LayoutRoot"
    Background="White">
    <sdk:DataGrid
        AutoGenerateColumns="False"
        ItemsSource="{Binding Items}">
        <sdk:DataGrid.Columns>
            <sdk:DataGridTemplateColumn>
                <sdk:DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition
                                    Width="100" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <ComboBox
                                ItemsSource="{Binding Source={StaticResource vm}, Path=Options}"
                                SelectedItem="{Binding Selected, Mode=TwoWay}" />
                            <TextBox
                                Grid.Column="1"
                                Text="Else"
                                Visibility="{Binding TextVisible}" />
                        </Grid>
                    </DataTemplate>
                </sdk:DataGridTemplateColumn.CellTemplate>
            </sdk:DataGridTemplateColumn>
        </sdk:DataGrid.Columns>
    </sdk:DataGrid>
</Grid> 
```

Items 是包含“ItemViewModel”的集合。这里的主要变化是数据模板中的绑定现在映射到“ItemViewModel”的属性。例外情况是 ComboBox 的 ItemSource（其中包含您的 'None'、'Const' 和 'Col' 值），它绑定到 Main VM。

主虚拟机：

```
public class VM : INotifyPropertyChanged
{
    private readonly ObservableCollection<ItemViewModel> items = new ObservableCollection<ItemViewModel>();
    private readonly ObservableCollection<string> options = new ObservableCollection<string>();

    public ObservableCollection<ItemViewModel> Items { get { return items; } }
    public ObservableCollection<string> Options { get { return options; } }

    public VM()
    {
      options.Add("None");
      options.Add("Const");
      options.Add("Col");      

      //Create some dummy items
      for (int i = 0; i < 10; i++)
      {
        var item = new ItemViewModel();
        item.Name = i.ToString();
        item.Selected = options[0];
        items.Add(item);
      }
    }

   //INotifyPropertyChanged stuff 
```

项目虚拟机：

```
public class ItemViewModel : INotifyPropertyChanged
{
    private string selected;
    private Visibility textVisible;

    public string Selected
    {
      get { return selected; }
      set
      {
        if (!string.IsNullOrWhiteSpace(value))
        {
          switch (value.ToLower())
          {
            case "none":
              TextVisible = Visibility.Collapsed;
              break;
            case "const":
              TextVisible = Visibility.Visible;
              break;
            case "col":
              TextVisible = Visibility.Visible;
              break;
          }
       }

        selected = value;

      }
    }

    public Visibility TextVisible
    {
      get { return textVisible; }
      set
      {
        textVisible = value;
        RaisePropertyChanged("TextVisible");
      }
    }

    //INotifyPropertyChanged stuff       

} 
```

您可以在此处看到，当更改此项的选定值时，会运行一些逻辑来确定文本是否应该可见。

这有一些问题，但希望它能让你走上正确的道路。

# javascript - 有没有更好的方法可以测量从 Ajax 调用返回数据所需的总时间？

> ID：12169492
> 
> 赞同：2
> 
> 时间：2012-08-29T00:47:43.450
> 
> 标签：javascript, jquery, ajax

我正在研究这样的方法：

```
function aa() {
    var start = new Date().getTime();
    $.ajax({
        cache: false,
        url: href + params.param,
        dataType: 'html'
    })
    .done(function (responseText) {
        xx();
    })
    .fail(function (jqXHR, textStatus, errorThrown) {
        yy();
    })
    .always(function () {
        zz(start);
    });
};

function zz(start) {
    var end = new Date().getTime();
    var elapsed = end.getMilliseconds() - start.getMilliseconds();
} 
```

首先。这是衡量所需时间的有效方法吗？还有另一种方法可以做到这一点。例如，是否有某种方法可以从 Ajax 标头中读取某些内容，如果可以，我该如何读取它？

请注意，我正在寻找代码中的解决方案，以便可以在 HTML 页面上报告时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:33:53.243

这绝对是衡量发出请求和返回数据之间的时间量的有效方法。目标是测量客户端在发出请求和接收响应之间看到的时间量，因此使用客户端的时钟是理想的。（您通常希望避免涉及同步服务器和客户端时钟的时间比较；使用`Date:`HTTP 标头就可以做到这一点。）

我会做两件事来改进：

*   首先绑定`always`处理程序。由于`Deferred`回调是按照它们添加的顺序执行的，`always`首先绑定意味着我们不会因为`done`处理程序中计算量大的操作而抛出测量值。

*   无需实例`Date`化对象。静态`Date.now()`以数字形式返回当前时间（以 ms 为单位）。

您甚至可以在范围内进行经过的计算，以便您的`done`/`fail`回调可以使用它。

```
function aa() {
    var start = Date.now(), elapsed;
    $.ajax({
        cache: false,
        url: href + params.param,
        dataType: 'html'
    })
    .always(function () {
        elapsed = Date.now() - start;
    });
    .done(function (responseText) {
        xx(elapsed);
    })
    .fail(function (jqXHR, textStatus, errorThrown) {
        yy(elapsed);
    });
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:23:43.397

如果您使用的是 Ruby 或 .Net，您可以查看[MiniProfiler](https://github.com/SamSaffron/MiniProfiler)。它会做你想做的事。或者，也许你可以检查一下他在里面是怎么做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T01:06:34.180

也许运行某种监控 PC，它只是每隔一段时间重新加载页面并保留自己的日志……如果传输时间过长，则会发出警报。

在 *nix 下，您可以使用简单的脚本和 wget 和/或 curl 将其自动化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T00:51:05.817

Firebug for Firefox 会告诉你调用需要多长时间

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T00:57:28.353

我认为你的方式很干净。响应中没有内置任何内容可以告诉您请求需要多长时间，除非您自己将其放在那里。但是，如果您尝试进行某种服务器端日志记录，则不会考虑请求通过网络所花费的时间。

# windows - 无法在 Windows 上为 python 2.5 导入 argparse 1.2.1

> ID：12169493
> 
> 赞同：0
> 
> 时间：2012-08-29T00:48:31.160
> 
> 标签：windows, arguments, command-line-arguments, argparse, python-2.5

所以，我认为我已经正确安装了 setuptools 和 argparse 1.2.1。

```
C:\Python25_64bit>python ez_setup.py argparse
Searching for argparse
Best match: argparse 1.2.1
Processing argparse-1.2.1-py2.5.egg
argparse 1.2.1 is already the active version in easy-install.pth

Using c:\python25_64bit\lib\site-packages\argparse-1.2.1-py2.5.egg
Processing dependencies for argparse
Finished processing dependencies for argparse

C:\Python25_64bit>python
Python 2.5.4 (r254:67916, Dec 23 2008, 15:19:34) [MSC v.1400 64 bit (AMD64)] on
win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import argparse
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named argparse
>>> quit() 
```

但是，如您在上面看到的，我似乎无法导入它。我还尝试将 egg 直接添加到我的 Eclipse PyDev 项目中，但这也无济于事。如您所见，我的环境中没有设置任何内容。或许，这就是问题所在？

```
C:\Python25_64bit>echo %PYTHONPATH%
%PYTHONPATH%

C:\Python25_64bit>echo %PYTHONHOME%
%PYTHONHOME% 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T06:05:18.450

我希望您在安装时注意并注意`argparse`安装位置。在您的脚本中（从命令行或从您的 IDE 运行）在顶部包括：

```
import sys
for p in sys.path:
    print repr(p) 
```

查看 python 正在搜索的所有路径。使用以下方法将路径添加到 argparse：

```
sys.path.insert(0, '/your/path/to/argparse') 
```

或将安装移动到路径中的某个位置。

环境变量可以为空，也可以在元素中编译`sys.path`。

# c++ - C++11（或 Boost）system_error 策略

> ID：12169495
> 
> 赞同：6
> 
> 时间：2012-08-29T00:48:40.880
> 
> 标签：c++, c++11, boost, std-system-error

我正在开发一个系统，该系统旨在使用名为`error_code`,`error_condition`和`error_category`- 一个新的方案 std: 在 C++11 中，尽管目前我实际上正在使用 Boost 实现。我已经阅读了 Chris Kholkoff 的[系列文章](http://blog.think-async.com/2010/04/system-error-support-in-c0x-part-1.html)，现在已经三遍了，我想我大致了解了如何创建这些类。

我的问题是该系统需要处理存在于单个 DLL 中的插件，并且这些插件可能会出现错误。我最初的设计是计划一个特定于系统的错误类别，该类别将包含所有各种错误代码和一个不真正映射到`errno`值的特定错误条件的候选清单。这里的问题是，要使 DLL 能够使用这些错误代码之一，它需要访问`error_category`应用程序中的唯一实例。我现在通过`SetErrorCategory()`从每个 DLL 导出一个函数来处理这个问题，这个函数可以工作，但有点恶心。

我看到的替代解决方案是每个 DLL 都有自己的错误类别和代码，如果需要，还有自己的条件；我怀疑这更像是为这个库功能所设想的。但是，我认为这需要主应用程序的错误方案中的比较功能，该功能了解插件的错误方案，并可以检查应用程序的哪些条件与插件的错误匹配。这似乎更容易出现一堆问题，尽管我还没有尝试实现它。我猜我必须在所有实际逻辑之上从 DLL 中导出整个错误方案。

当然，另一种方法是仅使用 DLL 中的数字错误代码并将它们填充到应用程序端的错误对象中。它具有插件简单的优点，但可能会导致应用程序中的陷阱（例如，处理来自几个不同插件的对象的函数需要注意每个错误的来源）。

所以我的具体问题是：在这三个选项中，你会使用哪个，为什么？哪个明显行不通？当然，我还没有想到更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:15:35.750

我在处理这个问题时得到的解决方案是使用预定义的代码来处理问题系列和用户子代码选择以及特定类型错误的继承。通过 boost 这让我可以通过以下方式继承特定类型：

```
struct IOException : virtual std::exception, virtual boost::exception {};
struct EOFException : IOException {};
... 
```

并保留与预定义的一般错误（如 IOException）匹配的错误代码。因此，我可以为每个错误系列提供一个通用代码范围：

```
namespace exception { namespace code {
    UNKNOWN_EXCEPTION           = 0;
    IO_EXCEPTION                = 100;
    CONCURRENCY_EXCEPTION       = 200;
    ...
}} 
```

然后，如果有人想要一个新的错误类型，他们可以从已经定义的通用异常类型和伴随该错误的代码继承，并通过继承类型和次要值 (0-99) 专门化异常。这也允许 try catch 块捕获更具体的错误类型，同时让更通用的异常版本传递给其他控制块。然后，用户可以自由使用父异常代码或指定他们自己的代码，该代码在家族中（父 = 100 -> 子 = 115）。如果用户只想要一个 IOError，而不创建新的错误系列，他们可以使用默认的系列异常，没有任何麻烦。我发现这给了用户灵活性，而不需要在他们不想要的时候对异常代码进行 OCD 跟踪。

然而，这绝不是最终的解决方案，因为个人喜好导致了我在这里的设计选择。我发现有太多的错误代码会让人感到困惑，并且异常继承已经对这些信息进行了编码。实际上，在我描述的系统中，完全去除错误代码并仅依赖异常继承是很容易的，但许多人更喜欢为每个异常名称分配一个代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T22:40:46.197

我想出了另一种解决方案：创建一个仅包含我的`error_category`实现的 DLL，并从应用程序和每个插件 DLL 链接到它。这使他们可以访问全局类别对象，而无需将该对象从应用程序显式传递给 DLL。

# c# - 使用 C# 查找和替换字符串中的文本

> ID：12169496
> 
> 赞同：1
> 
> 时间：2012-08-29T00:48:54.980
> 
> 标签：c#, string, replace

任何人都知道我将如何查找和替换字符串中的文本？基本上我有两个字符串：

```
string firstS = "/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDABQODxIPDRQSERIXFhQYHzMhHxwcHz8tLyUzSkFOTUlBSEZSXHZkUldvWEZIZoxob3p9hIWET2ORm4+AmnaBhH//2wBDARYXFx8bHzwhITx/VEhUf39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f3//";

string secondS = "abcdefg2wBDABQODxIPDRQSERIXFh/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/abcdefg"; 
```

我想搜索`firstS`它是否包含任何字符序列，`secondS`然后替换它。它还需要替换为方括号中的替换字符数：

> [已替换字符数]

例如，因为`firstS`和`secondS`都包含“2wBDABQODxIPDRQSERIXFh”和“/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/f39/”，所以需要替换它们. 于是就`firstS`变成了：

```
string firstS = "/9j/4AAQSkZJRgABAQEAYABgAAD/[22]QYHzMhHxwcHz8tLyUzSkFOTUlBSEZSXHZkUldvWEZIZoxob3p9hIWET2ORm4+AmnaBhH//2wBDARYXFx8bHzwhITx/VEhUf39[61]f3//"; 
```

希望这是有道理的。我想我可以用 Regex 做到这一点，但我不喜欢它的低效率。有谁知道另一种更快的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:51:44.577

> 有谁知道另一种更快的方法？

是的，这个问题实际上有一个专有名称。它被称为[*最长公共子串*](http://en.wikipedia.org/wiki/Longest_common_substring_problem)，它有一个[相当快的解决方案](http://en.wikipedia.org/wiki/Longest_common_substring_problem#Pseudocode)。

这是[ideone 的一个实现](http://ideone.com/bx2OE)。它查找并替换十个字符或更长的所有常见子字符串。

```
// This comes straight from Wikipedia article linked above:
private static string FindLcs(string s, string t) {
    var L = new int[s.Length, t.Length];
    var z = 0;
    var ret = new StringBuilder();
    for (var i = 0 ; i != s.Length ; i++) {
        for (var j = 0 ; j != t.Length ; j++) {
            if (s[i] == t[j]) {
                if (i == 0 || j == 0) {
                    L[i,j] = 1;
                } else {
                    L[i,j] = L[i-1,j-1] + 1;
                }
                if (L[i,j] > z) {
                    z = L[i,j];
                    ret = new StringBuilder();
                }
                if (L[i,j] == z) {
                    ret.Append(s.Substring( i-z+1, z));
                }
            } else {
                L[i,j]=0;
            }
        }
    }
    return ret.ToString();
}
// With the LCS in hand, building the answer is easy
public static string CutLcs(string s, string t) {
    for (;;) {
        var lcs = FindLcs(s, t);
        if (lcs.Length < 10) break;
        s = s.Replace(lcs, string.Format("[{0}]", lcs.Length));
    }
    return s;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:22:45.490

**您需要在“最长公共子串”和“最长公共子序列”之间非常小心**

对于子字符串：[http ://en.wikipedia.org/wiki/Longest_common_substring_problem](http://en.wikipedia.org/wiki/Longest_common_substring_problem)

对于子序列：[http ://en.wikipedia.org/wiki/Longest_common_subsequence_problem](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)

**我建议您在 youtube 上也观看一些关于这两个主题的视频** [http://www.youtube.com/results?search_query=longest+common+substring&oq=longest+common+substring&gs_l=youtube.3..0.3834.10362.0。 10546.28.17.2.9.9.2.225.1425.11j3j3.17.0...0.0...1ac.lSrzx8rr1kQ](http://www.youtube.com/results?search_query=longest+common+substring&oq=longest+common+substring&gs_l=youtube.3..0.3834.10362.0.10546.28.17.2.9.9.2.225.1425.11j3j3.17.0...0.0...1ac.lSrzx8rr1kQ)

[http://www.youtube.com/results?search_query=longest+common+subsequence&oq=longest+common+s&gs_l=youtube.3.0.0l6.2968.7905.0.9132.20.14.2.4.4.0.224.2038.5j2j7.14.0... 0.0...1ac.4CYZ1x50zpc](http://www.youtube.com/results?search_query=longest+common+subsequence&oq=longest+common+s&gs_l=youtube.3.0.0l6.2968.7905.0.9132.20.14.2.4.4.0.224.2038.5j2j7.14.0...0.0...1ac.4CYZ1x50zpc)

你可以在这里找到最长公共子序列的 c# 实现：

[http://www.alexandre-gomes.com/?p=177](http://www.alexandre-gomes.com/?p=177)

[http://en.wikibooks.org/wiki/Algorithm_Implementation/Strings/Longest_common_subsequence](http://en.wikibooks.org/wiki/Algorithm_Implementation/Strings/Longest_common_subsequence)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T01:28:56.063

我有一个类似的问题，但是对于单词出现！所以，我希望这会有所帮助。我使用`SortedDictionary`了一个二叉搜索树

```
/* Application counts the number of occurrences of each word in a string
   and stores them in a generic sorted dictionary. */
using System;
using System.Text.RegularExpressions;
using System.Collections.Generic;

public class SortedDictionaryTest
{
   public static void Main( string[] args )
   {
      // create sorted dictionary
      SortedDictionary< string, int > dictionary = CollectWords();

      // display sorted dictionary content
      DisplayDictionary( dictionary );
   } 

   // create sorted dictionary 
   private static SortedDictionary< string, int > CollectWords()
   {
      // create a new sorted dictionary
      SortedDictionary< string, int > dictionary =
         new SortedDictionary< string, int >();

      Console.WriteLine( "Enter a string: " ); // prompt for user input
      string input = Console.ReadLine(); 

      // split input text into tokens
      string[] words = Regex.Split( input, @"\s+" );

      // processing input words
      foreach ( var word in words )
      {
         string wordKey = word.ToLower(); // get word in lowercase

         // if the dictionary contains the word
         if ( dictionary.ContainsKey( wordKey ) )
         {
            ++dictionary[ wordKey ];
         } 
         else
            // add new word with a count of 1 to the dictionary
            dictionary.Add( wordKey, 1 );
      } 

      return dictionary;
   } 

   // display dictionary content
   private static void DisplayDictionary< K, V >(
      SortedDictionary< K, V > dictionary )
   {
      Console.WriteLine( "\nSorted dictionary contains:\n{0,-12}{1,-12}",
         "Key:", "Value:" );

      /* generate output for each key in the sorted dictionary
        by iterating through the Keys property with a foreach statement*/
      foreach ( K key in dictionary.Keys )
         Console.WriteLine( "{0,- 12}{1,-12}", key, dictionary[ key ] );

      Console.WriteLine( "\nsize: {0}", dictionary.Count );
   } 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T03:36:26.690

这可能很慢，但是如果您愿意承担一些技术债务并且现在需要一些东西来进行原型设计，那么您可以使用 LINQ。

```
string firstS = "123abc";
string secondS = "456cdeabc123";
int minLength = 3;

var result = 
    from subStrCount in Enumerable.Range(0, firstS.Length)
    where firstS.Length - subStrCount >= 3
    let subStr = firstS.Substring(subStrCount, 3)
    where secondS.Contains(subStr)
    select secondS.Replace(subStr, "[" + subStr.Length + "]"); 
```

结果是

```
 456cdeabc[3] 
 456cde[3]123 
```

# java - Eclipse Plugin IFile 只读属性更改

> ID：12169497
> 
> 赞同：3
> 
> 时间：2012-08-29T00:49:07.417
> 
> 标签：java, eclipse-plugin

我正在开发一个以只读状态加载所有项目文件（IFile）的 Eclipse 插件。

```
 ResourceAttributes resAttr = new ResourceAttributes();
        resAttr.setReadOnly(true);
        classFile.setResourceAttributes(resAttr); 
```

现在，当用户开始在 JavaEditor 中编写内容时，会显示一个消息框：

```
File ABC.java is read-only. Do you wish to make it writable? 
```

我想捕捉用户的答案，因为有些文件不应该是只读的。

为了做到这一点，我实现了一个 IElementChangedListener，但我不知道如何获取 IFile 只读属性是否更改。

```
class SinfoniaCloudElementChangedListener implements IElementChangedListener {

@Override
public void elementChanged(ElementChangedEvent event) {
  Activator.logInfo("SinfoniaCloudElementChangedListener - elementChanged");
  try {
    handleDelta(event.getDelta());
  } catch (JavaModelException e) {
    Activator.logError("Error handling delta for ElementChangeListener. ", e);
  }
}

private void handleDelta(IJavaElementDelta delta) throws JavaModelException {
  IJavaElement element = delta.getElement();
  if (element instanceof ICompilationUnit) {
    IJavaProject project = element.getJavaProject();
    if (project.getElementName().equals(SinfoniaProject.getProjectName(true)) == false) {
      return;
    }

    ICompilationUnit cu = (ICompilationUnit) element;
    for (IType type : cu.getAllTypes()) {
      if (type != IType.CLASS_FILE)
        continue;

      switch (delta.getKind()) {
        case IJavaElementDelta.CHANGED:
            Activator.logInfo("CHANGED - Element:" + cu.getElementName());
            // ?????????????????????????????
            break;
           default:
            // do nothing
            break;
        }
    }
  }
  for (IJavaElementDelta child : delta.getAffectedChildren()) {
    handleDelta(child);
  }
 }
} 
```

谢谢你。

==

根据 Andrew 的建议，IElementChangedListener 已替换为 IResourceChangeListener，但是我仍然不知道如何确定 IResource 只读属性是否已更改。

```
class ABCResourceChangeListener implements IResourceChangeListener {

@Override
public void resourceChanged(IResourceChangeEvent event) {
       IResource res = event.getResource();
       try {
         switch (event.getType()) {
            case IResourceChangeEvent.PRE_CLOSE:
               System.out.print("Project ");
               System.out.print(res.getFullPath());
               System.out.println(" is about to close.");
               break;
            case IResourceChangeEvent.PRE_DELETE:
               System.out.print("Project ");
               System.out.print(res.getFullPath());
               System.out.println(" is about to be deleted.");
               break;
            case IResourceChangeEvent.POST_CHANGE:
               System.out.println("Resources have changed.");
        event.getDelta().accept(new DeltaPrinter());
               break;
            case IResourceChangeEvent.PRE_BUILD:
               System.out.println("Build about to run.");
               event.getDelta().accept(new DeltaPrinter());
               break;
            case IResourceChangeEvent.POST_BUILD:
               System.out.println("Build complete.");
               event.getDelta().accept(new DeltaPrinter());
               break;
         }
  } catch (CoreException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
  }
}
}

class DeltaPrinter implements IResourceDeltaVisitor {
public boolean visit(IResourceDelta delta) {
  IResource res = delta.getResource();
  switch (delta.getKind()) {
    case IResourceDelta.ADDED:
      System.out.print("Resource ");
      System.out.print(res.getFullPath());
      System.out.println(" was added.");
      break;
    case IResourceDelta.REMOVED:
      System.out.print("Resource ");
      System.out.print(res.getFullPath());
      System.out.println(" was removed.");
      break;
    case IResourceDelta.CHANGED:
      System.out.print("Resource ");
      System.out.print(res.getFullPath());
      System.out.println(" has changed.");
      int flags = delta.getFlags();
      if ((flags & IResourceDelta.CONTENT) != 0) {
        System.out.println("--> Content Change");
        // ?????????????????????????
      }
      if ((flags & IResourceDelta.REPLACED) != 0) {
        System.out.println("--> Content Replaced");
      }
      if ((flags & IResourceDelta.MARKERS) != 0) {
        System.out.println("--> Marker Change");
        IMarkerDelta[] markers = delta.getMarkerDeltas();
        // if interested in markers, check these deltas
        for (int j=0; j<markers.length;j++) {
          IMarkerDelta markerDelta = markers[j];
          if (markerDelta.isSubtypeOf(IMarker.SOURCE_ID)) {
            switch (markerDelta.getKind()) {
              case IResourceDelta.ADDED :
                System.out.println("--> Marker Delta Added " );
                break;
              case IResourceDelta.REMOVED :
                System.out.println("--> Marker Delta Removed " );
                break;
              case IResourceDelta.CHANGED:
                System.out.println("--> Marker Delta Changed ");
                break;
            }
          }
        }

      }
      break;
  }
  return true; // visit the children
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:15:52.100

`IElementChangedListener`不是你想要的。您应该使用`IResourceChangeListener`. 监听器监听`IResourceDelta`s。 `IResourceDelta`有一个调用的方法`getFlags()`应该返回你想要的。

`IWorkspace.addResourceChangeListener(IResourceChangeListener, int)`有关更多信息，请参阅 javadoc 。

# php - 发送带有附件的电子邮件的功能？

> ID：12169500
> 
> 赞同：0
> 
> 时间：2012-08-29T00:49:23.680
> 
> 标签：php

是否有允许我发送带有附件的电子邮件的 PHP 类/脚本（开源/免费）？

我想要一些简单的东西

```
mail_with_attachment($to, $subject, $_FILES["file"]); 
```

有这样的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T00:51:19.700

有：

*   [http://framework.zend.com/manual/en/zend.mail.attachments.html](http://framework.zend.com/manual/en/zend.mail.attachments.html)
*   [http://www.php.net/manual/en/function.mail.php#105661](http://www.php.net/manual/en/function.mail.php#105661)
*   [http://sourceforge.net/projects/phpmailer/](http://sourceforge.net/projects/phpmailer/)
*   [http://lwest.free.fr/doc/php/lib/index.php3?page=mail&lang=en#sec_13](http://lwest.free.fr/doc/php/lib/index.php3?page=mail&lang=en#sec_13)
*   [http://xpertmailer.sourceforge.net/documentation/](http://xpertmailer.sourceforge.net/documentation/)
*   [http://swiftmailer.org/docs/messages.html](http://swiftmailer.org/docs/messages.html)

选一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:55:06.340

这样的事情可能会完成工作：

```
<?php
function multi_attach_mail($to, $files, $sendermail){
    // email fields: to, from, subject, and so on
    $from = "Files attach <".$sendermail.">";
    $subject = date("d.M H:i")." F=".count($files);
    $message = date("Y.m.d H:i:s")."\n".count($files)." attachments";
    $headers = "From: $from";

    // boundary
    $semi_rand = md5(time());
    $mime_boundary = "==Multipart_Boundary_x{$semi_rand}x";

    // headers for attachment
    $headers .= "\nMIME-Version: 1.0\n" . "Content-Type: multipart/mixed;\n" . " boundary=\"{$mime_boundary}\"";

    // multipart boundary
    $message = "--{$mime_boundary}\n" . "Content-Type: text/plain; charset=\"iso-8859-1\"\n" .
    "Content-Transfer-Encoding: 7bit\n\n" . $message . "\n\n";

    // preparing attachments
    for($i=0;$i<count($files);$i++){
        if(is_file($files[$i])){
            $message .= "--{$mime_boundary}\n";
            $fp =    @fopen($files[$i],"rb");
        $data =    @fread($fp,filesize($files[$i]));
                    @fclose($fp);
            $data = chunk_split(base64_encode($data));
            $message .= "Content-Type: application/octet-stream; name=\"".basename($files[$i])."\"\n" .
            "Content-Description: ".basename($files[$i])."\n" .
            "Content-Disposition: attachment;\n" . " filename=\"".basename($files[$i])."\"; size=".filesize($files[$i]).";\n" .
            "Content-Transfer-Encoding: base64\n\n" . $data . "\n\n";
            }
        }
    $message .= "--{$mime_boundary}--";
    $returnpath = "-f" . $sendermail;
    $ok = @mail($to, $subject, $message, $headers, $returnpath);
    if($ok){ return $i; } else { return 0; }
    }
?> 
```

我是从[php.net 上邮件功能页面的评论部分得到的](http://www.php.net/manual/en/function.mail.php)。您可以去那里查看更多类似功能的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T00:55:39.190

我使用 SwiftMailer 库来执行此操作：[http ://swiftmailer.org/](http://swiftmailer.org/)

这是一个简单的例子：[http ://swiftmailer.org/docs/messages.html](http://swiftmailer.org/docs/messages.html)

# javascript - 在一个页面上引导多个轮播

> ID：12169501
> 
> 赞同：5
> 
> 时间：2012-08-29T00:49:26.543
> 
> 标签：javascript, html, css, twitter-bootstrap, carousel

我在由一个控件控制的一页上的 3 个轮播之后。因此，当单击下一个或上一个时，所有轮播都会立即移动。

这是一个带有 3 个轮播的示例，但它们都是分开的。

我被困住了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T03:03:09.040

这是我的例子：

[http://jsfiddle.net/D2RLR/1247/](http://jsfiddle.net/D2RLR/1247/)

控制所有轮播的代码的关键部分是：

```
<button class="btn btn-primary" data-slide="prev" href=".carousel">Prev All</button>
<button class="btn btn-primary" data-slide="next" href=".carousel">Next All</button> 
```

通过指定 .carousel 类而不是特定 ID，按钮会触发页面上所有轮播上的事件。

# r - 如何从 ecdfplot() 中提取 ecdf 值

> ID：12169502
> 
> 赞同：4
> 
> 时间：2012-08-29T00:49:36.430
> 
> 标签：r, extract, extraction, lattice, ecdf

如果我使用包的`ecdfplot()`功能，`latticeExtra`我如何获得计算的实际值，即对应于`~x|g`输入的 y 值？

我一直在看，`?ecdfplot`但没有描述。对于通常的高级功能`ecdf()`，它适用于命令`plot=FALSE`，但这不适用于`ecdfplot()`.

我想使用`ecdfplot()`而不是`ecdf()`我需要计算`ecdf()`分组变量的值的原因。我知道我也可以做到这一点，但我很相信也有一条高速公路。

这里有一个小例子

```
u <- rnorm(100,0,1)
mygroup <- c(rep("group1",50),rep("group2",50))
ecdfplot(~u, groups=mygroup) 
```

![在此处输入图像描述](../Images/de9f9bdd97236e389113c2e5f74d5891.png)

我想提取给定每个组对应的 x 值的 y 值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-02-17T22:15:38.737

如果您坚持使用基础包中的 ecdf() 函数，您可以简单地执行以下操作：

1.  使用您的数据创建 ecdf 函数：

    ```
    fun.ecdf <- ecdf(x) # x is a vector of your data 
    ```

2.  现在使用这个“ecdf 函数”来生成你提供给它的任何向量的累积概率，包括你的原始排序数据：

    ```
    my.ecdf <- fun.ecdf(sort(x)) 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T01:35:36.307

我知道您说过您不想使用`ecdf`，但在这种情况下，使用它比从返回的[格子](http://www.statmethods.net/advgraphs/trellis.html)对象中获取数据*要*容易得多。（毕竟，这就是所做的一切——它只是在幕后做的）。`ecdfplot``ecdfplot`

在您的示例中，以下将为您提供每个 ECDF 的 y 值矩阵（`x`您的整个输入在哪里`u`，尽管您可以选择不同的值）：

```
ecdfs = lapply(split(u, mygroup), ecdf)
ys = sapply(ecdfs, function(e) e(u))
# output:
#       group1 group2
#  [1,]   0.52   0.72
#  [2,]   0.68   0.78
#  [3,]   0.62   0.78
#  [4,]   0.66   0.78
#  [5,]   0.72   0.80
#  [6,]   0.86   0.94
#  [7,]   0.10   0.26
#  [8,]   0.90   0.94
# ... 
```

ETA：如果您只希望每列对应于该列中的 50 个 x 值，您可以这样做：

```
ys = sapply(split(u, mygroup), function(g) ecdf(g)(g)) 
```

（请注意，如果每个组中的值的数量不相同，这将最终成为一个列表，而不是一个带有列的矩阵）。

# clojure - 在 deftype 中使用原子时出现奇怪的错误

> ID：12169508
> 
> 赞同：2
> 
> 时间：2012-08-29T00:50:02.590
> 
> 标签：clojure

我有以下代码，定义了一个里面有一个原子的类型。

```
（定义协议 IDeck
  (vec-* [dk] "输出到持久向量")
  (count-* [dk] "甲板上的元素数量")
  (conj1-* [dk & es] "向牌组添加多个元素"))

(deftype ADeck [#^clojure.lang.Atom val]
  甲板
  (vec-* [dk] (->> (.val dk) deref (map deref) vec))

  (count-* [dk] (-> (.val dk) deref count))

  (conj1-* [dk & es]
    （尝试
      （循环[esi es]
        （让[e（第一个esi）]
          （条件
            (nil?e) dk
            ：别的
            （做
              (swap! (.val dk) #(conj % (atom e)))
              (recur (rest esi))))))
      (catch Throwable t (println t)))))

(defn new-*adeck
  ([] (ADeck. (atom [])))
  ([v] (ADeck. (atom (vec (map atom v))))))

(defn conj2-* [dk & es]
  （尝试
    （循环[esi es]
      （让[e（第一个esi）]
        （条件
          (nil?e) dk
          ：别的
          （做
            (swap! (.val dk) #(conj % (atom e)))
            (recur (rest esi))))))
    (catch Throwable t (println t))))

;; 用法
(def a (new-*adeck [1 2 3 4]))

（计数-* a）
;=> 4

(vec-* a)
;=> [1 2 3 4]

(conj1-* a 1 2) ;; deftype 案例
;=> IllegalArgumentException java.lang.IllegalArgumentException：不知道如何从：java.lang.Long 创建 ISeq

(vec-* a)
;=> [1 2 3 4]

(conj2-* a 1 2) ;; 定义案例
(vec-* a)
;=> [1 2 3 4 1 2]

```

尽管这两个 conj-* 方法完全相同，除了一个是 deftype 而另一个是普通 defn 之外，第一个给出错误而第二个成功。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T04:45:43.327

这是因为协议不支持可变数量的参数。

你可以做的是：

```
(conj1-*  [dk & es] "Adding multiple elements to the deck")) 
```

进入

```
(conj1-*  [dk es] "Adding multiple elements to the deck")) 
```

这样 es 参数将是向量并被称为：

```
(conj1-* a [1 2]) 
```

# css - Twitter-Bootstrap 2.1.0 词缀插件 - 无法正常工作

> ID：12169513
> 
> 赞同：1
> 
> 时间：2012-08-29T00:50:57.823
> 
> 标签：css, twitter-bootstrap, responsive-design

我尝试在我的一个 mvc4 项目中使用引导词缀（2.1.0）。如果在滚动 50px 后 .span9 内容向左移动，则 .span3 和 .span9 似乎无法正常工作。

我发现了这一点：[文本在向下滚动时移到页面的一侧，](https://stackoverflow.com/questions/12106168/text-moves-to-side-of-the-page-on-scroll-down)但不起作用。将浮点数添加到跨度以某种方式起作用，但不是“响应式”。我认为这必须是一个更好的解决方案。

有人让它工作吗？

这是我的代码（从引导站点复制和粘贴）。我哪里做错了？

```
<body data-spy="scroll" data-target=".bs-docs-sidebar">
<div class="container">
....
<div class="row">
  <div class="span3 bs-docs-sidebar" data-spy="affix" data-offset-top="50">
    <ul class="nav nav-list bs-docs-sidenav">
      <li><a href="#download-bootstrap"><i class="icon-chevron-right"></i> Download</a></li>
      ....
      <li><a href="#what-next"><i class="icon-chevron-right"></i> What next?</a></li>
    </ul>
  </div>
  <div class="span9">
    ....
    <section id="download-bootstrap"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T08:18:19.993

问题解决了。一旦我贴上无序列表，一切正常。不知何故，我明白我必须附加父 div，而不是列表本身。我的错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-05T07:38:28.700

解决此问题的另一种方法是设置导航跨度最小高度

```
.span3 {  
    min-height: 1px;  
} 
```

在平板电脑模式下，我还需要将导航设置为不附加：

```
@media (max-width: 767px) {
    .sidenav.affix {
        position: static; 
```

目前文档中确实没有足够的内容来解释如何使其工作。

# objective-c - 我在哪里可以设置 UINavigationControllers supportedOrientations？

> ID：12169517
> 
> 赞同：5
> 
> 时间：2012-08-29T00:51:26.680
> 
> 标签：objective-c, uinavigationcontroller, ios6

我正在使用 iOS 6.0 测试版，我的旋转不再起作用。

我在哪里可以设置 UINavigationControllers supportedOrientations？

根据这个[http://news.yahoo.com/apple-ios-6-beta-3-changes-182849903.html](http://news.yahoo.com/apple-ios-6-beta-3-changes-182849903.html) UINavigation Controller 不会咨询他们的孩子来确定他们是否应该自动旋转。

我不再使用 shouldAutorotateToInterfaceOrientation: 了，因为它已被弃用。相反，我使用的是supportedInterfaceOrientations：和shouldAutoRotate：并且它们工作正常，直到我将ViewController放入NavigationController（作为孩子）。从那时起，在 ViewController 中指定的方向不再起作用。它似乎正在使用导航控制器设置的方向（UIInterfaceOrientationMaskAllButUpsideDown）

如何设置 NavigationController 的 InterfaceOrientations 以便我的 ViewControllers 锁定为纵向？

我是否必须继承 UINavigationController 并在那里设置 InterfaceOrientations？在 iOS 6.0 中继承 UINavigationController 不是不好的做法吗？

谢谢你的帮助堆！

干杯!

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-22T01:10:14.067

如果您希望它再次咨询它的孩子，您可以向 UINavigationController 添加一个类别

```
@implementation UINavigationController (Rotation_IOS6)

-(BOOL)shouldAutorotate
{
    return [[self.viewControllers lastObject] shouldAutorotate];
}

-(NSUInteger)supportedInterfaceOrientations
{
    return [[self.viewControllers lastObject] supportedInterfaceOrientations];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return [[self.viewControllers lastObject] preferredInterfaceOrientationForPresentation];
}

@end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T05:11:35.297

子类 UINavigationController

//OnlyPortraitNavigationController.h

```
@interface OnlyPortraitNavigationController : UINavigationController 
```

//OnlyPortraitNavigationController.m

```
@implementation OnlyPortraitNavigationController

- (BOOL)shouldAutorotate {
    return NO;
}

-(UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationPortrait; //for locked only Portrait
} 
```

使用您的肖像 ViewController 呈现新的子类 navigationController

```
SomeViewController *onlyPortraitVC = [[SomeViewController alloc]init];

OnlyPortraitNavigationController *portraitNav = [[OnlyPortraitNavigationController alloc]initWithRootViewController:onlyPortraitViewController];

[self presentViewController:portraitNav animated:YES completion:NULL]; 
```

这是我的应用程序上的工作，希望它可以帮助你。

# node.js - 使用 Node.JS 和 CouchDB 的离线应用程序

> ID：12169520
> 
> 赞同：7
> 
> 时间：2012-08-29T00:51:48.493
> 
> 标签：node.js, mongodb, couchdb, offlineapps, offline-browsing

我有一个我想创建的应用程序。但我不知道该怎么做。我正在使用 node.js 并且想使用 couchdb，但是如果像 mongodb 或 riak 这样的东西会是一个更好的选择，我愿意听取他们的想法。但是，我有一个网站，比如说

酷网

上面有一个 couchdb 实例，以及一个管理商店的站点。说一个购物车。数据库包含商店的所有商品和数据。该应用程序本身有一个管理后端来管理该数据并可以更改项目。我想要做的是能够让用户与互联网断开连接，并且仍然有管理员后端工作。我意识到要使其正常工作，我需要将客户端框架与我的模型/路由/控制器/任何东西一起使用。但我不确定的是如何让网站在离线时运行。如果在本地安装 couchdb 可以在重新联机时将数据从本地同步到远程，如果管理员用户在计算机上，我可以让他们安装沙发。但这可能很混乱。

另外，如果管理员用户在平板电脑或手机上怎么办？我需要一个实际的移动应用程序和一个桌面应用程序来执行此操作吗？有什么方法可以设置它，以便最终用户无缝连接。我也希望最终用户也可以离线使用，但更大的受众是管理员。

另一个用例，店内 POS 系统。电源熄灭。但是 POS 系统可以从网络加载到平板电脑上，如果 wifi 不可用，他们仍然可以进行基于卡的销售，因为该应用程序可以离线使用。

我只是不知道该怎么做。假设我需要一个可以处理数据以及后端的客户端框架。像余烬或棱角分明的东西。还有像meteor和derby js这样的all in one stack，但那些不是完全离线的，而是为了实时的出现。虽然流星确实有迷你蒙戈所以它可能值得研究。

我希望有人可以帮助我弄清楚如何让这个设置工作，最好是在沙发上，但如果我有办法同步数据，其他 nosql 也可以工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T12:24:49.383

我不确定它是否适合你，但我已经考虑这样的应用程序很长一段时间了，并且一直在对可能的情况进行一些研究。我能想出的最佳解决方案是使用带有 couchdb 的服务器并基于客户端编写应用程序。然后对于数据存储，使用[pouchdb](http://pouchdb.com/)并定期将 pouchdb 与您的服务器端 couchdb 同步（如果应用程序在线）。我知道邮袋处于早期阶段，尚未准备好生产，但如果你愿意投入一些工作，我会说它是可行的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T01:25:15.833

如果您希望客户端在脱机和联机时运行顺畅（例如断电的 POS），那么**我建议您让应用程序主要在本地存储上工作，并通过后台发布或同步到云。**

本地存储选项可以是从轻量级（如 sqlite、sqlexpress、firebird）到无 sql 选项（如 mongo、couchdb 等）的所有内容......

但对于客户端或设备，请考虑配置的易用性和选项的重量。您还需要考虑客户端的类型——您是否有许多平台，从设备到 PC 不等？您不想要具有大量配置和运行时占用空间的东西。这在服务方面很好。

在服务方面，请考虑数据的性质以及它是否更适合交易/关系系统（银行等）或最终一致/非交易（no-sql）文档。不要忘记混合动力作为一种选择。还要考虑服务平台 - 例如，节点与 mongodb 配合得很好（从前到后的 json 对象）......

设备和服务存储选项可以不同（并且可能应该）由服务接口（soap、rest/http、套接字等）分开。

很难有一个适合所有解决方案的解决方案，但通常在设备或客户端上轻量级的东西（如 sqlite）便于安装/配置，而服务端的可扩展性（如 sqlserver/mysql 或 couchdb/mongodb）是有意义的。

一些阅读链接：

*   [http://www.mongodb.org/display/DOCS/Comparing+Mongo+DB+and+Couch+DB](http://www.mongodb.org/display/DOCS/Comparing+Mongo+DB+and+Couch+DB)
*   [http://www.sqlite.org/](http://www.sqlite.org/)
*   [http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx](http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx)

您的问题非常广泛，没有一种适合所有解决方案的尺寸。希望我提供了一些可供考虑的选项。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-29T12:05:26.840

有一个有趣的项目叫做 AppJs ( [http://appjs.com/](http://appjs.com/) )，它将 Node.JS 和 Chrominium 打包为桌面环境。它目前非常新鲜（文档很少），但它似乎很简单（您将使用与在线应用程序相同的工具）。

至于同步离线和在线环境。我怀疑您是否可以按照您设想的方式依赖 CouchDB。CouchDB 移动支持并不像某些文档所建议的那样全面。所以从这个意义上说，它与使用 SQL/Mongo/Punchcards 没有什么不同。

您可能会更幸运地基于 XML 或 JSON（或纯文本）设计合适的序列化方案，并在在线和离线安装之间传递文件。

编辑——写这篇文章后，Node Webkit—— [http](http://nwjs.io/) ://nwjs.io/——显然是 App.js 最明显的替代品。它有一个非常简单的 API 和一些很棒的特性。

# google-maps-api-3 - GTFS/NextBus/Google Maps - 运输距离

> ID：12169525
> 
> 赞同：3
> 
> 时间：2012-08-29T00:52:45.033
> 
> 标签：google-maps-api-3, gps, gtfs

我正在尝试在公交路线上行驶的距离——尤其是旧金山 MUNI，但标准[NextBus](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http%3A%2F%2Fwww.nextbus.com%2FxmlFeedDocs%2FNextBusXMLFeed.pdf&ei=wGE9UPWrIcWqigLr1YHwCw&usg=AFQjCNGCmOEwCi7sz4VOAdTWCSjoWm4r7Q)、[GTFS 和](https://developers.google.com/transit/gtfs/reference#shapes_fields)[Google Maps API](https://developers.google.com/maps/documentation/directions/)似乎是通用的。我很喜欢使用这些 API，只是不知道如何解决这个问题。

**最简单的方法 - 询问谷歌地图**（这使用网络服务，但也有 javascript API）：

[http://maps.googleapis.com/maps/api/directions/json?origin=37.7954199,-122.397&destination=37.7873299,-122.44691&sensor=false&mode=transit&departure_time=1348109609&alternatives=true](http://maps.googleapis.com/maps/api/directions/json?origin=37.7954199,-122.397&destination=37.7873299,-122.44691&sensor=false&mode=transit&departure_time=1348109609&alternatives=true)

此 JSON 包括行驶距离，但有两个问题：

1.  除非您显示地图，否则 Google 不允许您使用这些数据，我不想这样做
2.  我需要确保返回的距离适用于正确的路线/线路，因为它可以/将提供多个路由选项。这可能是可行的，但需要更多的逻辑。

**编辑：**使用`alternatives=true`（或`provideRouteAlternatives: true`使用 javascript API）最多只能返回 3 条路线，这在 SF 中通常不包括我正在寻找的路线（其他交通机构、同一条路线上的多条线路等）。所以这不是一个很好的选择。

**下一班车：**

示例路由配置：

[http://webservices.nextbus.com/service/publicXMLFeed?command=routeConfig&a=sf-muni&r=1](http://webservices.nextbus.com/service/publicXMLFeed?command=routeConfig&a=sf-muni&r=1)

给出了每个站点的坐标，但连接这些点与所走的路线不同——它会偷工减料，等等，我需要这个是准确的。实际采取的路线如下所示`<path>/<point>`，但我没有看到停靠点和路径坐标之间有任何明显的相关性。另外，NextBus 在他们的文档（靠近底部的第 10 页）中说，您不应该在`<path>`段之间连接点，它们仅用于在地图上绘制并且可以重叠。

**GTFS：**

GTFS 数据还分隔停止和“形状”坐标（如 NextBus 路径）。不幸的是，NextBus 和 GTFS（四舍五入）之间的相同站点的坐标略有不同，尽管站点 ID/标签相同。此外，数据文件以兆字节为单位，我需要将其用于移动应用程序。我想我可以将所有数据放入数据库并进行查询，但这仍然需要弄清楚如何将停靠点与形状相关联。shape.txt 文件中的“shapes_distance_traveled”列特别有前景。不过，MUNI 选择将可选的“shapes_distance_traveled”字段保留在 stop_times.txt 之外。

任何建议都将不胜感激，我知道这似乎是一项获得简单价值的史诗般的任务。也许我会扔一张地图来合法地使用距离:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T13:44:54.703

而不是使用谷歌地图，我会研究[OpenStreetMap](https://wiki.openstreetmap.org/wiki/About)的无限制许可。有多个 [路由引擎](https://wiki.openstreetmap.org/wiki/Routing)可以使用 OSM 数据。就个人而言，我会在 PostGIS 或 SQLite 中使用路由，但根据您的技能，您可能会选择另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T07:33:18.010

您显然已经完成了研究，（+1），正如您所说，最简单的方法是询问 Google。如果这对您来说是值得的，那么您可能需要考虑[**购买使用 Google Maps API 的营业执照**](http://www.google.com/enterprise/earthmaps/maps.html)，并与他们协商显示地图的要求。这是我能想到的使用 Google API的唯一*合法方式。*[**或者，您可以尝试使用来自美国人口普查局免费提供的TIGER 数据集**](http://www.census.gov/geo/www/tiger/index.html)的数据构建自己的路由引擎，但正如您所说，这似乎是一项史诗般的任务。:-)

# vb.net - Datagridview 列不在数据表中

> ID：12169526
> 
> 赞同：1
> 
> 时间：2012-08-29T00:52:59.100
> 
> 标签：vb.net, winforms, datagridview, calculated-columns

`DataGridView`是否有机会在（WinForms - vb.NET）上添加计算列（复杂计算，无法在 SQL 中计算）？

我希望像当我在 ASP.NET`RowDataBound`中控制事件时一样`GridView`，但是 asp 和 vb 的链接数据方式太不同了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:33:11.840

为此，您可以在网格中添加一个未绑定的列：

```
Dim col As New DataGridViewTextBoxColumn
col.Name = "Unbound"
DataGridView1.Columns.Add(col) 
```

并将网格置于 VirtualMode：

```
DataGridView1.VirtualMode = True 
```

然后使用 CellValueNeeded 事件的处理程序：

```
Private Sub CellValueNeeded(sender As System.Object, e As DataGridViewCellValueEventArgs) Handles DataGridView1.CellValueNeeded
    If DataGridView1.Columns(e.ColumnIndex).Name = "Unbound" Then
        e.Value = "Hi"
    End If
End Sub 
```

在上面的处理程序中，我只是将值设置为一些微不足道的值，但您可以在此处添加您喜欢的任何计算。

# xml - QName 值“{http://schemas.xmlsoap.org/soap/encoding/}Array”不解析为（n）简单类型定义

> ID：12169527
> 
> 赞同：0
> 
> 时间：2012-08-29T00:53:19.353
> 
> 标签：xml, soap, wsdl, xsd, lxml

我是一个 XML 新手，在解析模式时遇到了一些奇怪的问题。这是您可以运行的最小示例：

```
#! /usr/bin/env python
from lxml import etree
from StringIO import StringIO

XML = StringIO('''<?xml version="1.0" encoding="ISO-8859-1" ?>
<xs:schema xmlns="http://www.w3.org/2001/XMLSchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
    xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/">
    <xs:import namespace="http://schemas.xmlsoap.org/soap/encoding/" />
    <xs:complexType name="ArrayOfDocumentLink">
        <xs:complexContent>
            <xs:restriction base="soapenc:Array">
                <xs:attribute ref="soapenc:arrayType" wsdl:arrayType="tns:DocumentLink[]"/>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>
</xs:schema>''')

etree.XMLSchema(file=XML) 
```

给

```
lxml.etree.XMLSchemaParseError: complex type 'ArrayOfDocumentLink', attribute 'base': The QName value '{http://schemas.xmlsoap.org/soap/encoding/}Array' does not resolve to a(n) simple type definition., line 7 
```

我一无所知。各种邮件列表和[这个](https://stackoverflow.com/questions/9405921/import-namespace-cannot-resolve-the-name-to-an-type-definition-component)SO question 表明有一种解决方法，涉及将所有定义收集到外部文件中。但这并不能真正帮助新手了解正在发生的事情。非常感谢任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:49:17.140

您已经指出需要为命名空间[http://schemas.xmlsoap.org/soap/encoding/](http://schemas.xmlsoap.org/soap/encoding/)导入模式定义，但是您没有告诉处理器在哪里可以找到这些定义。尝试添加（到 xs:import）一个 schemaLocation 属性，该属性告诉处理器在哪里可以找到此名称空间的模式文档。

# android - Android媒体播放器内嵌视频

> ID：12169528
> 
> 赞同：1
> 
> 时间：2012-08-29T00:53:45.847
> 
> 标签：android, html, html5-video, android-mediaplayer, android-video-player

我有一个要在其中播放视频的应用程序。我想通过 iframe 中的 html5 从嵌入代码播放视频。是否可以调用 androids stock video player 来播放 iframe 嵌入代码中的视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T02:45:12.607

我通过将嵌入代码放在资产文件夹内的 html 文件中来解决此问题。效果很好。

# android - 在谷歌地图android中获取多个标记坐标

> ID：12169530
> 
> 赞同：2
> 
> 时间：2012-08-29T00:54:47.353
> 
> 标签：android, google-maps, google-maps-markers

嗨，这个伟大社区的所有成员！

这是我的第一个问题，请原谅我可能的错误。我希望从今天开始，我可以对你们中的一些人有所帮助，就像希望你们对我一样。解决这个问题：

我正在构建一个 android 应用程序，其目的是搜索最近的加油点和最近的护理维修中心。我对 android 非常陌生，感谢这里有很多关于 android 的帖子，我已经成功地达到了我已经构建地图并将其动画到我当前位置的地步，同时更新了我的位置。

现在我必须添加兴趣点的标记。由于它们至少有 10 个（我将仅出于演示目的添加它们）我认为通过 10 多次重复调用来添加它们是不明智的`itemizedOverlay.addOverlayItem()`。我的想法是将它们保存在格式的文件中，`( " latitude " , "longitude" , simple_description_title , other info )`然后以某种方式导入地理点的前两个字段和标题的第三个字段。我将在第 4 次之后使用某种类型的工具提示文本（例如 tel_number）。

你认为这是一个好方法吗？以及如何在`extends ItemizeOverlay()`.

直到此时我才发布代码，因为它无关紧要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:22:25.690

欢迎来到 SO，让我们直接进入您的问题/问题。

1.）由于您只添加 10 个兴趣点，因此如果您只为所有 10 个兴趣点调用 itemizedOverlay.addOverlayItem() 并不重要，因为诀窍是仅在使用 itemizedOverlay 添加所有叠加项后才调用 itemizedOverlay.populate() .addOverlayItem()，这样你就不会在性能上妥协。

2.) 现在，再一次，由于您只是进行演示，我建议您将所有 10 个叠加层及其各自的地理位置简单地硬编码到 Android 代码本身中。这样您就不必担心读取数据。此外，使用 txt 文件存储数据并不是性能和便利性的最佳选择。这就是数据库存在的目的。

3.）如果将来您这样做时，您确实需要使用一些动态数据来填充您的标记，那么我强烈建议您使用

*   SQLite：Android 提供的嵌入式数据库，它非常适合存储应用程序所需的少量信息，例如描述标题、其他信息、纬度、经度，但是，如果您需要某种基于连接的应用程序每隔一段时间更新一次全局可访问的数据，我建议您使用下一个选项，

*   MySQL：这是一个在线数据库，您必须使用服务器和 PHP 与之交互。使用在线数据库的优势在于，您现在可以通过读取和写入数据库来在不同用户（朋友、联系人、关注者等）之间共享信息。

# css - 在选项卡中显示网站时在 wordpress 网站上选择特定样式表

> ID：12169534
> 
> 赞同：0
> 
> 时间：2012-08-29T00:55:01.553
> 
> 标签：css, facebook, tabs

这可能是一个容易回答的问题（希望如此）。不确定这是发布问题的正确位置，因为我不知道这是 CSS 问题还是普通的 PHP 编程问题（我对 PHP 编程知之甚少），所以这里是：

我有一个 wordpress 博客，它使用三种不同的样式表，具体取决于查看博客的平台（web、ipad、iphone）。

我最近在我的 Facebook 页面上创建了一个选项卡，该选项卡在 iframe 中打开博客，但它打开的 web 样式（默认）样式表对于 Facebook 选项卡的最大宽度（810 像素）来说太宽了。但是，适应 ipad 的样式表在那里可以正常工作。当我从 Facebook 外部进入我的网站时，我仍然希望看到正常的 web 样式视图，因此不能选择将 ipad 样式表作为默认样式表。

有没有办法从 facebook 选项卡传递参数：例如[http://www.myblog.com/?style=facebook](http://www.myblog.com/?style=facebook)以便在 facebook 选项卡内显示的网站使用正确的样式表？我认为更多的人有这个问题，但我已经在互联网上搜索了几个小时，却不知道要寻找什么。有人谈到 CSS 选择器，但我不知道它们如何工作或如何在解决方案中实现它们。

这是 header.php 中处理样式表的代码：

```
<!-- Theme Styles -->
<link rel="stylesheet" href="<?php echo get_template_directory_uri(); ?>/style.css" type="text/css" media="screen" />
<?php $disable_theme_features = of_get_option( 'disable_theme_features' ); if ($disable_theme_features['4'] == '0') { ?>
<link rel="stylesheet" href="<?php echo get_template_directory_uri(); ?>/style-ipad.css" type="text/css" media="screen" />
<?php } if ($disable_theme_features['3'] == '0') { ?>
<link rel="stylesheet" href="<?php echo get_template_directory_uri(); ?>/style-iphone.css" type="text/css" media="screen" />
<?php } ?> 
```

有没有办法在不完全改造模板的情况下实现这一点？任何帮助将不胜感激！！如果这是一个菜鸟问题，再次抱歉，那是因为我是 PHP 的菜鸟。

再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:19:11.823

您可以使用 PHP if 语句。比如如果在 URL 处，那么就使用这个样式表。

# apache-zookeeper - 路径缓存在添加和删除一个时触发所有子级的事件（curator-recipe 1.0.1）

> ID：12169538
> 
> 赞同：0
> 
> 时间：2012-08-29T00:55:40.863
> 
> 标签：apache-zookeeper

我正在使用 curator-recipe 的（1.0.1，因为风暴 0.7.4）路径缓存来观看路径上的 getChildren 事件。添加或删除孩子时，它会触发所有孩子的添加/更新。

例如有/mypath/1、/mypath/2，当添加/mypath/3 时，报告所有1、2 和3 已修改。

编辑一个孩子很好。仅触发目标孩子的事件。

我尝试了 PathChildrenCacheMode.CACHE_PATHS_ONLY 以及 PathChildrenCacheMode.CACHE_DATA_AND_STAT，如果这很重要的话。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:18:25.520

仅供参考 - PathChildrenCache 自 Curator 1.0.x 以来已被重新编写，因此您可以再试一次。

免责声明：我是策展人的作者

# api - 是否可以在标题用户 twitter api 中获取用户的整个 Twitter 个人资料？

> ID：12169540
> 
> 赞同：-2
> 
> 时间：2012-08-29T00:55:54.047
> 
> 标签：api, twitter

我正在尝试使用 twitter api 从 twitter 帐户中获取顶部矩形（https://twitter.com/cnnbrk 请参阅此页面以了解我在说什么）并将它们放置在我的网站上。我希望用户也能够按关注来关注用户。有人知道这样做的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T22:34:05.057

这很容易。使用相应的 Twitter API 端点检索用户，即`GET users/show`( [https://dev.twitter.com/docs/api/1/get/users/show](https://dev.twitter.com/docs/api/1/get/users/show) )。然后，做你自己的矩形来显示 Twitter 提供的信息。

# android - 边距/填充缩小 ImageView

> ID：12169541
> 
> 赞同：2
> 
> 时间：2012-08-29T00:56:02.390
> 
> 标签：android, android-layout, margin, padding, android-relativelayout

我最近尝试定位 imageview 的 x 和 y 坐标但没有运气，似乎在 Gingerbread 中没有办法做到这一点。然后我决定尝试填充和边距，但是当我设置它们时，它会缩小我的图像视图。我设置了 250dp 的左填充，图像视图变得很小。layout_height 和 width 设置为 wrap_content。我不确定发生了什么事。有谁知道为什么设置填充/边距会缩小图像视图？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-29T01:23:50.893

您混淆了边距和填充。边距是视图之外的区域，而填充会影响边距*内*的内容。

![边距和填充示例](../Images/200aca6c5d8539613cd0ef31e23f8572.png)

如果您设置填充，那么它将影响您的可用内容区域，并且假设您设置了 ScaleType，它将缩小您的图像以适应可用空间。

现在，您说您已经尝试了边距，但边距将完全符合您的要求。

例如，如果您想从左上角`ImageView`放置，您可以执行以下操作：`10dp`

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    >
    <ImageView
        android:id="@+id/my_image_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"
        android:layout_marginTop="10dp"
        android:layout_marginLeft="10dp"
        android:src="@drawable/my_image_id"
        />
</RelativeLayout> 
```

请记住，这是`10dp`相对于`parent`边界放置的。如果您的父布局也有填充，那么这将影响您的内容放置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T00:57:54.917

如果缩小意味着图片的比例混乱，那么你应该使用

```
android:scaleType="centerInside" 
```

这将防止比率发生变化

# java - java awt中设置光标位置

> ID：12169543
> 
> 赞同：0
> 
> 时间：2012-08-29T00:56:47.933
> 
> 标签：java, cursor, mouse, awt

我一直在研究如何以编程方式设置光标的位置。做一些谷歌搜索，我发现了 Robot 类的使用。但是当我这样做时，它会调用我不想要的 MouseMotionListener 中实现的 mouseMoved 事件。还有其他方法可以设置不会调用该方法的位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:03:59.950

无论您做什么，mouseMoved 事件仍然会触发，但是您可以覆盖它，这样一旦触发它就什么也不做。

您可以覆盖正在移动鼠标的组件的侦听器，这样只有该组件会忽略该事件，而其他组件会正确触发。

```
 myComponent.addMouseMotionListener(new MouseMotionAdapter()
    {
        @Override
        public void mouseMoved(MouseEvent e)
        {
            /*Do Nothing*/
        }
    }); 
```

# boost-msm - 使用 boost::msm eUML，如果我将 attributes_ << 赋予状态机或状态，我该如何（重新）设置它们？

> ID：12169544
> 
> 赞同：0
> 
> 时间：2012-08-29T00:56:48.830
> 
> 标签：boost-msm

如果我向事件添加属性，我知道我可以像使用函数一样使用事件名称......

```
BOOST_MSM_EUML_EVENT_WITH_ATTRIBUTES(*someEvent*, *someAttributeList*)

someStateMachine.process_event(
   someEvent (
      valueOfSomeAttribute1, // sets the attribute value here
      valueOfSomeAttribute2)) 
```

并且在一个动作中我可以通过写

```
evt.get_attribute(someAttribute1);  // retrieve the attribute value 
```

现在，如果我为整台机器设置一个属性，如下所示：

```
BOOST_MSM_EUML_DECLARE_STATE_MACHINE((transition_table,
                         init_ << initState,
                         Entry_Action, 
                         Exit_Action, 
                         attributes_ << someAttribute1 << someAttribute2,
                         configure_<< someConfigurationStuff ),
                         newStateMachineType) 
```

**如何为 someAttribute1 设置值？**

对州同样的问题：

```
BOOST_MSM_EUML_STATE(
       (someEntryAction,
        someExitAction,
        attributes_ << someAttribute1,
        configure_<< someConfigurationStuff)
       ,newStateName) 
```

**如何为 someAttribute1 设置值？**

最后，

**有没有办法在创建对象后更改属性？**

例如，我想为状态机设置一个属性，并且在我的一个状态中，记住一些我可以存储在状态机中的信息。（在这种情况下，我想存储一个套接字。）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T15:13:43.170

**如何为 someAttribute1 设置值？** 你可以：

*   更改您刚刚获得的参考（get_attribute 返回参考）：++evt.get_attribute(someAttribute1)。
*   使用函子直接在表中写入属性。例如，可以执行以下操作：/++fsm_(someAttribute1)

对于各州，您也可以这样做。对于状态机，同样如此。同样，您可以在操作中使用 Fsm 模板参数，也可以使用仿函数（fsm_、event_ 等）

您可以在示例或测试中找到很好的示例（例如 test/CompositeEuml.cpp 或 test/AnonymousEuml.cpp）。

HTH，克里斯托夫

# android - Sl4A 从通知窗口中选择正在运行的应用程序

> ID：12169546
> 
> 赞同：0
> 
> 时间：2012-08-29T00:57:26.713
> 
> 标签：android, sl4a

我有一个我编写的 SL4A 程序。在我准备发布之前，我有一个问题。

由于某种原因，当应用程序运行时，如果我在应用程序之外的主屏幕，我看到它在通知区域中运行，但是当我选择它时没有任何反应。但是，如果我从应用程序区域单击我的图标，它将重新启动应用程序。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-02T19:29:14.100

好吧，您似乎可以使用以下命令看到由 SL4A "como.googlecode.android_scripting" 包启动的通知：

这更像是一个黑客。

```
dumpsys statusbar | grep "pkg=com.googlecode.android_scripting" 
```

SL4A 发起的每个通知都会有一个“id”。例如，“id=1”是 SL4A 在服务器运行时启动的通知。您单击以停止服务器的那个。

考虑到这一点，您实际上可以列出由您的包启动的每个通知并阻止，直到您的通知的 id 消失。

如果是这样，那么您的下一个通知应该有一个 2 或更高的 id。请注意，如果 SL4A 停止或崩溃，这可能会发生变化。下次您可能会收到（RPC）服务器通知的“id=2”，然后您的应用程序通知会收到“id=3”，直到您重新启动设备，因此 RPC 服务器通知会返回到“id=1” ”。知道这一点意味着您需要在循环中不断搜索新通知。

例如在 bash 中并使用 adb：

```
while read Info; do echo "$Info" | grep 'pkg=com.googlecode.android_scripting'; done < <(adb shell dumpsys statusbar) 
```

你会得到这样的东西：

1: StatusBarNotification(pkg=com.googlecode.android_scripting id=2 tag=null score=0 notn=Notification(pri=0 contentView=com.googlecode.android_scripting/0x109008f vibrate=null sound=null defaults=0x0 flags=0x62 kind= [null]) user=UserHandle{0}) # SL4A RPC 通知

7: StatusBarNotification(pkg=com.googlecode.android_scripting id=3 tag=null score=0 notn=Notification(pri=0 contentView=com.googlecode.android_scripting/0x109008f vibrate=null sound=null defaults=0x0 flags=0x10 kind= [null]) user=UserHandle{0}) # 我的通知

让我们玩这个！

跑步：

```
while read Info; do echo "$Info" | grep "pkg=com.googlecode.android_scripting" | awk '{print $3}' | cut -s -d '=' -f2 ; done < <(adb shell dumpsys statusbar) 
```

例如，将为您提供：

```
# Without Using Cut
id=2 # SL4A Notificaion
id=3 # My Notification 
```

或者：

```
# Using Cut
2 # SL4A Notification
3 # My Notification 
```

让我们开始行动吧！（一个丑陋的解决方案）

```
# Start ADB USB Serial Connection
adb devices

# Activate Wireless ADB (Needs Root) - Not Needed
# adb shell setprop service.adb.tcp.port 5555
# stop adbd
# start adbd 
```

或者：

```
# Start ADB Wireless
adb connect 192.168.1.3

NotifyCount=0 
NotifyList=()

while read Notify; do

   DumpNotify=`echo "$Notify" | grep "pkg=com.googlecode.android_scripting" | awk '{print $3}' | cut -s -d '=' -f2`

   if [ ! -z "$DumpNotify" ] ; then 
      NotifyList[$NotifyCount]="$DumpNotify"
      ((NotifyCount++))  
   fi 

done < <(adb shell dumpsys statusbar)

SL4ARPCNotification="2"
MyScriptNotification="3"

if [[ ${NotifyList[*]} != *"$MyScriptNotification"* ]] ; then 
   adb shell am start -a android.intent.action.MUSIC_PLAYER
fi 
```

这在 2 个带有 MyNotification 和 SL4ARPCNotification 变量参数的函数中应该会更好。这样，您可以从代码中的任何位置进行验证并划分工作：FunctionX 用于列出通知，FunctionY 用于比较结果。

这可以在 Pyhon 或其他解释器中轻松完成。您需要记住，总是有来自 SL4A 本身的通知。通过在 python 中使用线程，您可以连续搜索新的或旧的通知，而无需阻止程序等待更改，因此您可以继续正常运行脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T12:42:42.737

SL4A 创建的通知什么也不做；他们没有回调，只能提醒用户。不幸的是，实际上并没有任何办法解决这个问题：BeanShell、JRuby 和 Rhino 可以进行 Java API 调用（例如，添加“单击时打开我的应用程序”部分）但不能使用`Context`s（通知需要），并且您可以制作自己的 API 外观版本，但随后用户需要为 Android 安装您的特定版本的 x（例如 Python）。

否则我能想到的就是用`Intent`s 或其他东西变得棘手，并在`/src`你的应用程序中包含一个活动来显示通知，尽管这可能需要学习 Java / Android 编程，这意味着你最好遵循并编写整个本机应用程序。

抱歉，但确实没有简单的方法可以做到这一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T18:26:10.857

你说你想发布它，所以我假设你暗示从长远来看你会将它编译成一个独立的 apk？

如果是这样，您将使用/将使用哪个软件包？py4a的方法，python27，kivy？根据我在使用 python27 编译为 apk 时的经验，顶部根本没有通知窗口，但如果您使用 py4a 的方法编译它，它应该为您创建一个可行的通知项。请参阅以下链接了解更多信息：[http ://code.google.com/p/android-scripting/wiki/SharingScripts](http://code.google.com/p/android-scripting/wiki/SharingScripts)

否则 ProfSmiles 的答案是正确的，但它似乎是一个比使用 py4a 方法更复杂的解决方案。

如果您想要一种更嵌入式的方法，您也可以查看 python27 项目，尽管如前所述，它没有像 py4a 那样的默认通知设置。

Kivy 的实现看起来也很有希望，但我不熟悉它，它可能还值得进一步研究：[https ://github.com/kivy/python-for-android](https://github.com/kivy/python-for-android)

# bubble-sort - 如果不应用排序算法，我们能否知道集合是否几乎已排序？

> ID：12169551
> 
> 赞同：1
> 
> 时间：2012-08-29T00:57:44.627
> 
> 标签：bubble-sort, sorting

在关于排序算法的维基百科文章中， [http](http://en.wikipedia.org/wiki/Sorting_algorithm#Summaries_of_popular_sorting_algorithms) ://en.wikipedia.org/wiki/Sorting_algorithm#Summaries_of_popular_sorting_algorithms 在冒泡排序下它说：*冒泡排序也可以有效地用于几乎排序的任何长度的列表（即，元素并没有明显不合适）*

所以我的问题是：如果不首先使用排序算法对列表进行排序，如何知道*它是否接近排序*？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-27T19:12:53.267

你熟悉一般的排序下限吗？您可以证明，在基于比较的排序算法中，任何排序算法都必须在平均情况下进行 Ω(n log n) 比较。你证明这一点的方法是通过信息论论证。基本思想是有 n! 输入数组的可能排列，并且由于您可以了解获得哪种排列的唯一方法是进行比较，因此您必须至少进行 lg n! 比较以确定您知道输入排列的结构。

我还没有计算出这方面的数学，但我怀疑你可以提出类似的论点来表明很难了解特定数组的排序方式。从本质上讲，如果您不进行大量比较，那么您将无法区分一个大部分已排序的数组和一个实际上距离排序很远的数组。因此，我所知道的所有算法都需要花费大量时间来衡量“排序性”。

例如，数组中“排序”级别的一种度量是该数组中的[反转](https://en.wikipedia.org/wiki/Inversion_(discrete_mathematics))次数。您可以使用基于合并排序的分而治之算法在 O(n log n) 时间内计算数组中的反转次数，但使用该运行时您可以只对数组进行排序。

通常，您知道您的数组大部分已排序的方式是先验地知道它是如何生成的。例如，如果您正在查看从上午 8 点到下午 12 点收集的温度数据，则很可能数据已经大部分排序（以传感器读数质量的一些差异为模）。如果您的数据随着时间的推移查看股票价格，那么它也很可能是经过排序的，除非公司的轨迹非常不稳定。其他一些算法也对数组进行部分排序；例如，当要排序的数组的大小很小时，快速排序实现停止排序并用最终的插入排序通道跟进所有内容并不少见，因为那时每个元素都不会离其最终位置很远。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-27T21:06:00.140

我不相信存在任何关于数组的排序或随机程度的标准化度量。

您可以提出自己的衡量标准 - 比如计算无序的相邻对的数量（在评论中建议），或者计算出现在数组中较小数字之前的较大数字的数量（这比简单的单经过）。

# java - Runtime.getRuntime().exec()，如何从网站链接执行文件？

> ID：12169556
> 
> 赞同：-1
> 
> 时间：2012-08-29T00:58:21.723
> 
> 标签：java, runtime, execute, calc

到目前为止，我已经让这条线完美地工作，它在我的计算机上执行 calc.exe：

```
Runtime.getRuntime().exec("calc.exe"); 
```

但是如何从网站链接下载和执行文件？例如[http://website.com/calc.exe](http://website.com/calc.exe)

我在网上找到了这段代码，但它不起作用：

```
Runtime.getRuntime().exec("bitsadmin /transfer myjob /download /priority high http://website.com/calc.exe c:\\calc.exe &start calc.exe"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:02:51.413

您使用[URL](http://docs.oracle.com/javase/6/docs/api/java/net/URL.html)和/或[URLConnection](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html)，[下载文件](http://cookbooks.adobe.com/post_Download_a_file_from_a_URL_in_Java-17947.html)，将其保存在某处（例如，当前工作目录或临时目录），然后使用`Runtime.getRuntime().exec()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:09:51.213

使用[此答案](https://stackoverflow.com/a/2633176/16959)作为起点，您可以这样做：（这使用[HttpClient](http://hc.apache.org/httpcomponents-client-ga/index.html)）

```
public static void main(String... args) throws IOException {
    System.out.println("Connecting...");
    HttpClient client = new DefaultHttpClient();
    HttpGet get = new HttpGet("http://website.com/calc.exe");
    HttpResponse response = client.execute(get);

    InputStream input = null;
    OutputStream output = null;
    byte[] buffer = new byte[1024];

    try {
        System.out.println("Downloading file...");
        input = response.getEntity().getContent();
        output = new FileOutputStream("c:\\calc.exe");
        for (int length; (length = input.read(buffer)) > 0;) {
            output.write(buffer, 0, length);
        }
        System.out.println("File successfully downloaded!");
        Runtime.getRuntime().exec("c:\\calc.exe");

    } finally {
        if (output != null) try { output.close(); } catch (IOException logOrIgnore) {}
        if (input != null) try { input.close(); } catch (IOException logOrIgnore) {}
    }
} 
```

# javascript - 如何滑动切换伪元素？

> ID：12169557
> 
> 赞同：3
> 
> 时间：2012-08-29T00:58:27.820
> 
> 标签：javascript, jquery, html, css, pseudo-element

正如您在这个[jsfiddle](http://jsfiddle.net/SZWmd/2/)中看到的，当您单击菜单按钮时，指向该按钮的小三角形仅在动画完成后显示。我希望动画从伪元素开始，然后才进入下拉菜单元素。我怎样才能做到这一点？

解决方案不一定必须使用 javascript，CSS3 将是最受欢迎的，我不担心兼容性问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:24:52.530

你可以试试这个 - [**DEMO**](http://jsfiddle.net/SZWmd/32/)

```
.drop-menu {
    display: none;
    position: relative;
    height: 60px;
    top: -20px;
}

.drop-menu ul::before {
    content: '';
    width: 0;
    height: 0;
    position: absolute;
    top: -30px;
    left: 30px;
    border-width: 15px;
    border-color: transparent transparent red transparent;
    border-style: solid;
}

.drop-menu ul {
    background-color: red;
    position: relative;
    top: 20px;
    z-index: 999;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T01:11:31.110

见[http://jsfiddle.net/SZWmd/23/](http://jsfiddle.net/SZWmd/23/)

问题是在滑动时，元素必须有`overflow:hidden`，但是三角形也被隐藏了。

然后，您必须滑动`.drop-menu ul`而不是`.drop-menu`. 你可以很容易地做到

```
$('.drop-menu-button').click(function() {
    $('.drop-menu').toggleClass('visible');
    $('.drop-menu ul').slideToggle();
}); 
```

并使用此选择器：

```
.drop-menu.visible::before 
```

但问题是，在向上滑动的时候，三角形一开始是隐藏的。

那么，你需要

```
$('.drop-menu-button').click(function() {
    if($('.drop-menu').hasClass('visible')){
        $('.drop-menu ul').slideUp('',function(){
            $('.drop-menu').removeClass('visible');
        });
    }else{
        $('.drop-menu').addClass('visible');
        $('.drop-menu ul').slideDown();
    }
}); 
```

**编辑：**

你也可以使用

```
$('.drop-menu-button').click(function() {
    $('.drop-menu').addClass('visible');
    $('.drop-menu ul').slideToggle('',function(){
        if(!$(this).is(':visible')){
            $('.drop-menu').removeClass('visible');
        }
    });
}); 
```

在这里看到它：http: [//jsfiddle.net/SZWmd/31/](http://jsfiddle.net/SZWmd/31/)

# jquery - iPad 设备高度 JQuery

> ID：12169562
> 
> 赞同：1
> 
> 时间：2012-08-29T00:59:26.257
> 
> 标签：jquery, ipad, mobile, jquery-mobile

我正在使用 320 及更高版本的框架在 kiosk 模式下通过 iPad 构建 Web 应用程序。

我正在使用媒体查询，但目前我必须以像素为单位设置页面包装器的宽度和高度（1024 x 768，根据 iPad 的横向），以允许其他所有内容都处于相对尺寸。

有没有一种方法可以使用 JQuery 检测设置高度，而不是固定像素？宽度工作正常，但是我需要一个高度值，以便可以根据该值定位设计的其余部分。

任何帮助都是极好的。干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T01:19:10.560

[这个页面](http://responsejs.com/labs/dimensions/)是一个很好的资源，用于了解各种高度和宽度函数将输出的内容。在 iPad 上打开它，它会显示值。

您可能正在寻找`window.screen.height`.

# netbeans - Netbeans 7.2 没有启动

> ID：12169565
> 
> 赞同：12
> 
> 时间：2012-08-29T00:59:43.953
> 
> 标签：netbeans, netbeans-7.2

我最近安装了 Netbeans 7.2 beta，它运行良好。然后我在 beta 版本之上安装了 Netbeans 7.2 最终版本，在安装过程中，Netbeans 7.1 和 Netbeans 7.12 都在那里。现在，当我启动 Netbeans 时，它并没有超出“加载模块”阶段。只需启动几秒钟后，Netbeans 屏幕就会消失。然后我做了以下。

*   卸载所有 Netbeans 版本并重新安装 Netbeans 7.2
*   删除 AppData/Netbeans 文件夹
*   删除用户/.nbi 文件夹
*   搜索注册表并删除了 Netbeans 相关条目。（但只找到一个条目）
*   删除了 Program Files 文件夹中的 Netbeans 文件夹。
*   卸载并重新安装在单独的驱动器中。
*   在另一个用户帐户下卸载并重新安装。

以上都不起作用，我唯一没有尝试的是重新安装 Windows XP 操作系统。

在重新安装操作系统之前有什么选择吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-08T04:59:46.590

我遇到了同样的问题....使用 netbeans 7.2，转到 user/appdata/roaming/7.2/modules/ 并删除除 docs、ext、locale 文件夹之外的所有 jar 文件...然后再次启动 ide...基本上，当您在更新后更新 ide 时，当您启动 ide 时，问题就出现在加载模块阶段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-04-14T16:21:35.367

首先，您需要检查是否安装了正确的 JDK 版本。Netbeans 7.2 需要 JDK 1.7，而不是 1.8。
您可以检查 {Netbeans 安装路径}/etc/netbeans.conf。那里找到`netbeans_jdkhome`和它的价值。确保您安装了 JDK1.7 和此行`netbeans_jdkhome="C:\Program Files\Java\jdk1.7.0_25"`。
如果不是，请将值更改为正确的安装路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T13:58:33.707

这是 NetBeans 7.2 的一些稳定性问题

只需杀死并重新启动IDE，它应该没问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-09-28T12:46:49.220

确保在安装向导中选择了正确的 JDK 目录，如果您不确定是否可以更改它， `C:\Program Files\NetBeans {netbeans version}\etc` 您将看到一个正在 `netbeans.conf` 编辑的文件（我正在使用 Notepad++）在文件的底部，您将看到一行 `netbeans_jdkhome="C:\Program Files\Java\{jdk directory you want}"` make确保它是有效的 JDK，它是 JDK，而不是 JRE

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-09T18:43:49.837

我遇到了同样的问题，请确保您在安装过程中配置了所需的 JDK 版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-06-23T10:41:18.687

首先尝试一切无济于事，最后我不得不卸载 NetBeans 7，然后安装 NetBeans 8，它也与我的 JDK 8 对齐。这为我解决了这个问题。希望这对其他人有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-04T20:23:48.797

啊，最后这在 11.3 版上对我有用，删除这个文件夹，然后再次运行程序

```
C:\Users\Dell\AppData\Roaming\NetBeans 
```

这里我的主要用户名是戴尔，你的当然可以不同

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-15T08:46:39.540

我发现在我的 Apache Netbeans 12.4 的 Windows 安装中，'C:\Users\user\AppData\Roaming\NetBeans\12.4\config\Preferences\org\netbeans\core\windows' 中的文件 'tctracker.properties' 已填充具有空值。我通过将这个“12.4”目录移动到磁盘上的其他位置，启动 Netbeans，让它生成一个新的“tctracker.properties”文件，停止它，将损坏的文件替换为这个新生成的文件并将“12.4”目录放回原处。

# c - OS X CommonCrypto 是否为 OpenSSL EVP_* 调用提供了兼容模式（就像 OpenSSL MD5 函数一样）？

> ID：12169566
> 
> 赞同：1
> 
> 时间：2012-08-29T01:00:04.963
> 
> 标签：c, macos, openssl, commoncrypto

在 Mac OS X10.7 上编译我的一个源文件并收到这些弃用警告：

```
xxx_evp.c:135:5: 'EVP_MD_CTX_init' is deprecated
xxx_evp.c:137:9: 'EVP_DigestInit_ex' is deprecated
xxx_evp.c:177:9: 'EVP_DigestUpdate' is deprecated
xxx_evp.c:227:13: 'EVP_DigestFinal_ex' is deprecated
xxx_evp.c:235:5: 'EVP_MD_CTX_cleanup' is deprecated 
```

我有另一组 OpenSSL 弃用警告，我在其中使用 MD5 函数，`openssl/md5.h`并且能够切换到 OpenSSL 调用的 CommonCrypto 版本，如下所示：

```
#if defined(__APPLE__)
#  define COMMON_DIGEST_FOR_OPENSSL
#  include <CommonCrypto/CommonDigest.h>
#else
#  include <openssl/md5.h>
#endif 
```

但是我找不到任何关于与这些`EVP_*`调用相关的任何类型的 OpenSSL 兼容性的任何信息。对于这些 OpenSSL`EVP_*`调用，我可以做一些类似的事情来获得 OS X 10.7 上的“免费”兼容性支持吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T00:33:44.183

我查看了 CommonCrypto 头文件，`/usr/include/CommonCrypto/`唯一注意到任何 OpenSSL 兼容性的文件是`CommonDigest.h`. 如果在包含此头文件的代码之前定义`#define`符号`COMMON_DIGEST_FOR_OPENSSL`，则以下 OpenSSL 函数类将映射到它们的 CommonCrypto 等效项：

*   `MD2_xxx`,`MD4_xxx`和`MD5_xxx`
*   `SHA_xxx`, `SHA1_xxx`, `SHA224_xxx`, `SHA256_xxx`,`SHA384_xxx`和`SHA512_xxx`

OpenSSL EVP_xxx 函数似乎没有任何此类映射，至少作为 CommonCrypto 的一部分提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T14:31:11.043

如果您使用任何 MD 或 SHA 哈希，您可以通过在包含 CommonDigest.h 之前定义 COMMON_DIGEST_FOR_OPENSSL 来获得 OpenSSL 兼容性。所以这一切都取决于你的 EVP_DigestInit_ex() 函数调用的第二个参数。例如，使用 SHA1 和 6 个“EVP_...”调用的 Mac App Store 签名代码可以替换为以下代码：

```
#define COMMON_DIGEST_FOR_OPENSSL
#include <CommonCrypto/CommonDigest.h>

    unsigned char digest[CC_SHA1_DIGEST_LENGTH];
    if (CC_SHA1([input bytes], [input length], digest)) {
        NSData *newHash = [NSData dataWithBytes:digest length:CC_SHA1_DIGEST_LENGTH];
    } 
```

# android - 如何通过字符串查询 SQLite 表？

> ID：12169567
> 
> 赞同：0
> 
> 时间：2012-08-29T01:00:09.730
> 
> 标签：android, database, string, sqlite

我是 android 的菜鸟，我正在尝试查询一个 sqlite 表。我已经阅读了几个教程，并且知道如何查询表以返回一整列值，但我似乎无法弄清楚如何逐个字符串从列中查询单个值。任何帮助是极大的赞赏。这是我的代码：

我成功查询和返回整列值的代码：

```
public String getValue() {
        // TODO Auto-generated method stub
        String[] columns = new String[]{ KEY_ROWID, KEY_NAME, KEY_QUANTITY, KEY_OUNCES, KEY_VALUE };
        Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);
        String result = "";

        int iRow = c.getColumnIndex(KEY_ROWID);
        int iName = c.getColumnIndex(KEY_NAME);
        int iQuantity = c.getColumnIndex(KEY_QUANTITY);
        int iOunces = c.getColumnIndex(KEY_OUNCES);
        int iValue = c.getColumnIndex(KEY_VALUE);

        for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
            result = result + /*c.getString(iRow) + " " +*/ c.getString(iValue) + "\n";
        }           

    return result;
} 
```

我尝试按字符串查询单个值的列：

```
public String getSingleValue(String aCoin) throws SQLException{
    // TODO Auto-generated method stub
    String[] columns = new String[]{ KEY_ROWID, KEY_NAME, KEY_QUANTITY, KEY_OUNCES, KEY_VALUE};     
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_NAME + "=" + aCoin, null, null, null, null);
    String result = "";

    int iRow = c.getColumnIndex(KEY_ROWID);
    int iName = c.getColumnIndex(KEY_NAME);
    int iQuantity = c.getColumnIndex(KEY_QUANTITY);
    int iOunces = c.getColumnIndex(KEY_OUNCES);
    int iValue = c.getColumnIndex(KEY_VALUE);

    if (c != null){
        c.moveToFirst();
        result= c.getString(1);
        return result;
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:03:30.900

改变这个

```
 String[] columns = new String[]{ KEY_ROWID, KEY_NAME, KEY_QUANTITY, KEY_OUNCES, KEY_VALUE }; 
```

至

```
 String[] columns = new String[]{ KEY_NAME};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, KEY_NAME + "=" + aCoin, null, null, null, null);
    String result = "";
   if (c != null){
        c.moveToFirst();
        result= c.getString(0);
        return result;
    }
    return null; 
```

如果您只想获取名称列。

# javascript - OpenLayers：IE：SCRIPT5：访问被拒绝

> ID：12169569
> 
> 赞同：0
> 
> 时间：2012-08-29T01:00:52.760
> 
> 标签：javascript, ajax, internet-explorer, openlayers

我正在使用 OpenLayers 开发一个项目。而且我只在 IE 上收到“访问被拒绝”错误。我知道有一些（也许）更容易的问题的解决方案：

[SCRIPT5：在 IE9 上的 xmlhttprequest](https://stackoverflow.com/questions/5793831/script5-access-is-denied-in-ie9-on-xmlhttprequest)
[访问被拒绝访问 IE 上的 jQuery 脚本被拒绝访问](https://stackoverflow.com/questions/5087549/access-denied-to-jquery-script-on-ie)

但我的限制是我不能修改我正在使用的任何库。但由于这是一个常见问题，也许 OpenLayers 已经准备好一些解决方案，我只是找不到正确的语法来使用它。

```
 var sundials = new OpenLayers.Layer.Vector("KML", {
            projection: map.displayProjection,
            strategies: [new OpenLayers.Strategy.Fixed()],
            protocol: new OpenLayers.Protocol.HTTP({
                url: "london_shapes.kml",
                format: new OpenLayers.Format.KML({
                    extractStyles: true,
                    extractAttributes: true
                })
            })
        });

        map.addLayers([wms]);
        map.addLayers([sundials]);//if you comment this, the error disappears
        //so it is obvious that the script cannot load london_shapes.kml under IE. 
```

[http://jsfiddle.net/dt1510/huepP/5/](http://jsfiddle.net/dt1510/huepP/5/)

问题：有没有解决 IE 问题的 OpenLayers 标准方法？

**编辑：** 这是我的问题的一个更简单的演示：
以下网页适用于 IE 和 Firefox：[http](http://www.openlayers.org/dev/examples/kml-layer.html)
://www.openlayers.org/dev/examples/kml-layer.html 但是，如果我下载它，它只适用在 Firefox、IE7 中而不是在 IE8/IE9 中。我需要网页在客户端计算机上而不是在线时工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:12:57.340

我解决了将 jQuery 库版本 1.8.0 更改为 1.8.1

# ios - 在 iOS 3 项目上构建后黑屏

> ID：12169571
> 
> 赞同：0
> 
> 时间：2012-08-29T01:01:35.880
> 
> 标签：ios, xcode

我有这个用 Xcode 3.2.5 编写的 iPhone 的 iOS 项目，它在模拟器下运行良好。但由于某种原因，它不适用于最新版本的 Xcode。编译时出现此错误：顺便说一下，pinField 是一个文本字段。知道发生了什么吗？

2012-08-29 01:54:46.232 Proj[3545:c07] *** 由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[setValue:forUndefinedKey:]：此类不符合键 pinField 的键值编码。*** First throw call stack: (0x18a9022 0x127dcd6 0x18a8ee1 0xd3022 0x44f6b 0x44edb 0x5fd50 0x5a571a 0x18aadea 0x18147f1 0x5a426e 0x5a5eb7 0x382ce1 0x382ff8 0x38217f 0x391183 0x391c38 0x385634 0x1d9bef5 0x187d195 0x17e1ff2 0x17e08da 0x17dfd84 0x17dfc9b 0x381c65 0x383626 0x1d8a 0x1cd5)

# objective-c - 在 Storyboard 中创建 FBProfilePictureView

> ID：12169573
> 
> 赞同：1
> 
> 时间：2012-08-29T01:01:50.687
> 
> 标签：objective-c, ios, facebook-ios-sdk

我`UIView`使用情节提要编辑器在视图控制器的主视图中创建了一个内部视图，并将其类更改为`FBProfilePictureView`.

![在此处输入图像描述](../Images/e44a22471083b7f315fb855180575ccc.png)

我创建了一个插座：

```
@property (weak, nonatomic) IBOutlet FBProfilePictureView *userImage; 
```

但是，当我在代码中引用该`userImage`对象时，它会将自己报告为 UIView。

```
NSLog(@"userImage class: %@", [userImage class]); 
```

产生：

```
2012-08-28 17:52:22.196 FBTestApp[6230:707] userImage class: UIView 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T02:09:06.463

虽然我没有看到[FB docs](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/personalize/)中提到的错误，但添加：

```
[FBProfilePictureView class]; 
```

到 applicationDidFinishLaunching 成功了。大概是一些运行时魔法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:22:54.130

`[userImage class]`除了调用类方法，我不会依赖任何东西。如果您需要确保`userImage`是正确的类型，请使用`[userImage isKindOfClass:[FBProfilePictureView class]]`. 它会让您知道您是否可以将对象视为 FBProfilePictureView。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-07T09:32:33.607

解决此问题的一种更优雅的方法可能是添加 -ObjC 链接器标志，而不是执行这种“运行时魔法”的东西。[在这里您可以找到有关如何添加标志的说明！](http://docs.millennialmedia.com/iOS-SDK/iOSAddingLinkerFlag.html)

请参阅[SDK 文档](https://developers.facebook.com/docs/facebook-login/ios/v2.0)，其中说：

`Note: If you've added the -ObjC flag to your linker options, then you don't have to add this code. Adding that flag causes the linker to load all the object files in the Facebook SDK, including the FBLoginView class. If you want to know more about what the -ObjC flag does, you can check out our troubleshooting guide.`

它提到了 FBLoginView，但根据这个问题的答案，它也适用于 FBProfilePictureView：[FBProfilePictureView 对象不会显示图像](https://stackoverflow.com/questions/13364495/fbprofilepictureview-object-wont-show-image)

希望这可以帮助。

# dynamics-crm - 使用自定义案例编号在 CRM 2011 中导入案例

> ID：12169575
> 
> 赞同：1
> 
> 时间：2012-08-29T01:01:56.647
> 
> 标签：dynamics-crm, dynamics-crm-2011

我正在为客户构建一个 CRM 解决方案来替换他们的旧 Access 数据库。他们有外部文档引用的带有案例编号的案例，并希望将它们作为案例编号保留在 CRM 中。我编写了一个插件，它可以在创建新案例时自动递增并分配案例编号，并且效果很好。问题是当我尝试导入他们的旧数据时。我将他们的旧案例编号字段映射到导入向导中的案例编号字段，但导入的案例会获得一个新的案例编号，例如 PRE-12345-asdf。

工作流无法更新案例编号。

理想情况下，我希望能够使用内置案例编号，但如果我只是隐藏内置案例编号字段并为其添加自定义字段，我会失去任何功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T18:10:57.597

您可以创建一个自定义字段来跟踪您自己的案例编号（在这种情况下，我们只是将其称为“案例编号”）。

在 Case Entity 表单的 onLoad 事件中，我们放置了以下函数，该函数将 Header 区域中显示的 Case Number 以及 Page/Tab 标题更新为我们的自定义字段：

```
function UseCustomCaseNumber()
{
var caseNumber = Xrm.Page.getAttribute("new_casenumber").getValue();
document.getElementById('form_title_div').childNodes[2].innerHTML = caseNumber;
parent.document.title = "Case: " + caseNumber + " - Microsoft Dynamics CRM";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:49:24.720

无法覆盖内置案例编号。隐藏它并使用您自己的字段似乎比较常见，不会给您带来任何问题。

# python - 在Django中跨一级域登录

> ID：12169580
> 
> 赞同：0
> 
> 时间：2012-08-29T01:02:37.753
> 
> 标签：python, django

我想在我的 django 站点中启用跨域登录，但我使用的是一级/顶级域，即 mysite.fr、mysite.en、mysite.uk...

我尝试过类似 SESSION_COOKIE_DOMAIN = 'mysite.' 但它不起作用。

有什么帮助吗？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:26:08.307

您要做的是在域之间共享 cookie。可以通过在您的一个域上设置 cookie 并从另一个域检查该 cookie 或在您的域（服务器端）之间同步 cookie 来完成。

StackOverflow 上的类似问题：

*   使用[django-openid](https://stackoverflow.com/a/1581620/1431750)
*   [如何跨两个不同的域使用 cookie？](https://stackoverflow.com/questions/315132/how-do-i-use-cookies-across-two-different-domains)
*   [您最喜欢的跨域 cookie 共享方法是什么？](https://stackoverflow.com/questions/263010/whats-your-favorite-cross-domain-cookie-sharing-approach)

其他：

*   使用[OpenID](http://developmentseed.org/blog/2010/mar/02/simple-sign-openid/)作为 SSO 来管理常用登录
*   [来自此页面上的示例 #3](http://www.codeguru.com/csharp/csharp/cs_internet/article.php/c19417/Sharing-Cookies-Across-Domains.htm)
*   这是一个[有趣的演示文稿](http://www.slideshare.net/SlexAxton/breaking-the-cross-domain-barrier)，介绍了如何使用不同的工具来做到这一点。
*   [这个是](http://www.jasny.net/articles/simple-single-sign-on-for-php/)用 PHP 做的

# html - 如何检测浏览器中的目录选择功能？

> ID：12169585
> 
> 赞同：7
> 
> 时间：2012-08-29T01:03:06.750
> 
> 标签：html, file-upload, html5-filesystem

我试图找出浏览器是否能够选择文件夹，而不仅仅是多个文件。当前的 Chrome 支持这一点（例如：[http](http://html5-demos.appspot.com/static/html5storage/demos/upload_directory/index.html) ://html5-demos.appspot.com/static/html5storage/demos/upload_directory/index.html ）。

显然，它在`<input type="file" />`具有`webkitdirectory`属性时可以在 Chrome 中使用。但是我如何测试浏览器是否真的能够选择文件夹和遍历文件呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-19T22:36:55.547

也许这是您问题的解决方案：

```
function isInputDirSupported() {
    var tmpInput = document.createElement('input');
    if ('webkitdirectory' in tmpInput 
        || 'mozdirectory' in tmpInput 
        || 'odirectory' in tmpInput 
        || 'msdirectory' in tmpInput 
        || 'directory' in tmpInput) return true;

    return false;
} 
```

# asp.net-mvc - 我的系统上的那个文件在哪里？

> ID：12169590
> 
> 赞同：1
> 
> 时间：2012-08-29T01:04:21.743
> 
> 标签：asp.net-mvc, database, vwdexpress

我正在尝试学习 ASP.NET MVC 并搜索互联网进出，包括 SO。很多关于 |DataDirectory| 的问题和答案 地点和方式。

调试站点时中断：

`"The model backing the 'ASPNETDBContext' context has changed since the database was created..."`.

然后我检查了路径：`|DataDirectory|ASPNETDBContext.sdf`

```
 string path = AppDomain.CurrentDomain.GetData( "DataDirectory" ).ToString(); 
```

它指向项目的 App_Data 但那里没有文件。

数据库完全是空的，所以我只需要删除这个东西。

我需要回答的实际问题是：如何正确解决这个问题？

[**进行了跟进**：另外：**该文件在哪里！**](https://stackoverflow.com/questions/12187068/where-gets-datadirectory-defined)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T04:41:12.197

您的问题的答案在于阅读[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/archive/2010/08/03/using-ef-code-first-with-an-existing-database.aspx)

> 对于那些看到此异常的人：
> 
> “自创建数据库以来，支持‘生产’上下文的模型已更改。手动删除/更新数据库，或使用 IDatabaseInitializer 实例调用 Database.SetInitializer。”
> 
> 这是正在发生的事情以及如何处理它：
> 
> 首次创建模型时，我们运行 DatabaseInitializer 来执行诸如创建数据库（如果数据库不存在）或添加种子数据之类的操作。默认的 DatabaseInitializer 尝试将使用模型所需的数据库架构与存储在使用数据库创建的 EdmMetadata 表中的架构哈希进行比较（当 Code First 是创建数据库的人时）。现有的数据库将没有 EdmMetadata 表，因此不会有哈希……如果该表丢失，今天的实现将抛出。在我们发布最终版本之前，我们将努力改变这种行为，因为它是默认的。在此之前，现有数据库通常不需要任何数据库初始化程序，因此可以通过调用以下方法为您的上下文类型关闭它：

```
Database.SetInitializer<Production>(null); 
```

希望这将帮助您解决问题。

# azure - 将数据从 SQL Azure 迁移到 Azure Table 的最佳方法是什么

> ID：12169591
> 
> 赞同：0
> 
> 时间：2012-08-29T01:04:31.420
> 
> 标签：azure, migration, azure-sql-database, azure-storage, azure-table-storage

对于一个项目，我同时使用 SQL Azure 和 Azure 表。这里的一个要求是前 7 天，所有数据都存储在 SQL Azure 中。前 7 天后，数据将迁移到 Azure 表中。

有没有可靠的项目来实现这个目标？或者有什么想法来实现这个？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:46:39.070

我认为最好的方法是拥有一组返回超过 7 天的数据的 SQL 查询（或存储过程）。然后使用表插入代码将此数据写入一个或多个表，并根据您的查询需要使用适当的分区/行键。然后，只需构建某种类型的后台操作来执行读+写+删除。没有工具可以做到这一点（据我所知），因为一个是关系数据库，另一个是没有特定模式的 NoSQL 变体。

要优化您的写入，请查看您是否可以同时写入成批的行（这称为实体组事务）。它优化了事务数，加上组中的行将以原子方式写入。[在此处](http://msdn.microsoft.com/en-us/library/windowsazure/dd894038.aspx)查看有关实体组交易的更多信息。

您可能还需要考虑使用队列来分配工作负载。也就是说，可能每天（或每小时，无论何时）推送一个队列消息，告诉某个后台进程将数据从 SQL 传输到表存储。这样，如果在操作过程中出现问题，您可以稍后再次处理它，因为队列消息仍然存在（如果操作成功，您只会删除该消息）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:08:31.467

如果您正在寻找执行此操作的工具，请查看 Cloud Storage Studio ( [http://www.cerebrata.com/products/cloudstoragestudio](http://www.cerebrata.com/products/cloudstoragestudio) )，它具有将数据从 SQL Server 导入到 Azure 表存储的功能。我已经很久没有检查了，但我相信 ClumsyLeaf 的 TableXplorer ( [http://www.clumsyleaf.com](http://www.clumsyleaf.com) ) 也有这个功能。很久以前，我们还构建了一个开源工具来做同样的事情。你可以在这里找到它：http: [//azuredatabaseupload.codeplex.com/](http://azuredatabaseupload.codeplex.com/)。

正如大卫所提到的，您基本上可以在数据库中编写一些视图来获取超过 7 天的数据。思路很简单：获取数据，将 SQL Server 数据类型映射到 Azure 数据类型，选择合适的 PartitionKey/RowKey 值，将数据转换为实体，然后批量上传实体。

# asp.net - 如何在没有实体框架的 MVC 中使用 SimpleMembership

> ID：12169595
> 
> 赞同：17
> 
> 时间：2012-08-29T01:05:14.287
> 
> 标签：asp.net, asp.net-mvc-4, ravendb

将 SimpleMembership (ASP.NET MVC 4) 与 RavenDB（或其他数据库）一起使用而不是 SQL Server 需要哪些步骤？

我习惯于覆盖 MembershipProvider，但它如何与新的 SimpleMembership 一起使用？

我看到有一个 SimpleMembershipProvider 所以我想我应该重写它，但我不知道这些方法是否仅用于存储数据目的，或者它们是否应该包含业务/验证逻辑）......

配置呢？我知道 InitializeDatabaseConnection 方法通常负责初始化整个 shebang，但如果我不使用实体框架，我认为我不应该调用它。

不幸的是，我没有找到很多关于新的 SimpleMembership 的资源，除了两个不是很有用的链接：

[http://igambin.blogspot.ca/2012/08/simplemembershipprovider-huh.html](http://igambin.blogspot.ca/2012/08/simplemembershipprovider-huh.html)

[http://blog.osbornm.com/archive/2010/07/21/using-simplemembership-with-asp.net-webpages.aspx](http://blog.osbornm.com/archive/2010/07/21/using-simplemembership-with-asp.net-webpages.aspx)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-30T00:41:24.200

所以这是我在查看一些源代码（MVC4）后发现的。

[http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/553690ac9488#src%2fWebMatrix.WebData%2fExtendedMembershipProvider.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/553690ac9488#src%2fWebMatrix.WebData%2fExtendedMembershipProvider.cs)

SimpleMembership 是抽象类 ExtendedMembershipProvider 的实现。SimpleMembership 中的代码主要是 SQL 操作和一些对底层（在文档中称为“previous”）MembershipProvider 的调用。

我认为重写 SimpleMembership 没有任何用处（在我的情况下），因为它的实现主要与 SQL Server 相关联。相反，据我了解，我应该实现 ExtendedMembershipProvider。然后，通过在 web.config 文件中设置此实现，WebSecurity 帮助程序将绕过 SimpleMembership（默认实现）并调用我的 ExtendedMembershipProvider 实现。

我认为我不会很快这样做，因为它看起来比以前更复杂（实现更多方法）......但仍然可行。

然而，所有这一切，我有点失望，我们仍然必须使用**MembershipProvider**，恕我直言，它与我们非常喜欢 ASP 的整个依赖注入东西相去甚远（很多静态和内部的东西）。网络 MVC/WebApi。

**编辑 1**

这个问题是在 Jon Galloway 写本教程之前提出的： [http ://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net -4-5-web-forms-and-asp-net-mvc-4-templates.aspx](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)

但是我的回答仍然有效，因为这个（取自 Jon Galloway 文章）恢复了它：

> 请注意，SimpleMembership 仍然需要一些 SQL Server 风格 - 它不适用于 MySQL、NoSQL 数据库等。如果您想查看 WebMatrix.WebData.dll 中的代码，可以使用 ILSpy 等工具查看为什么 - 在某些地方执行 SQL Server 特定的 SQL 语句，尤其是在创建和初始化表时。如果您单独创建表，您似乎可以使用另一个数据库，但我还没有尝试过，目前不支持它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T08:11:35.847

这是我对 mongodb 的实现。也许它可以帮助 [https://github.com/malibeg/MongodbSimpleMembershipProvider#readme](https://github.com/malibeg/MongodbSimpleMembershipProvider#readme)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T20:29:21.153

SimpleMembership 并不是真的要与旧的 MembershipProviders 一起使用，因为它并不能满足所有与普通 MembershipProviders 相同的合同。它主要设计用于通过 WebSecurity 帮助程序使用。

此链接可能有助于了解更多信息：[网页教程](http://www.asp.net/web-pages/tutorials/security/16-adding-security-and-membership)

# ios - Regarding views and gesture recognizers

> ID：12169596
> 
> 赞同：4
> 
> 时间：2012-08-29T01:06:01.763
> 
> 标签：ios, uiview, uigesturerecognizer

So I have somewhat of a silly requirement, I am trying to put an "easter egg" type function into the app, where if you tap a certain area 3 times, a special view controller comes up with some silly pictures, etc...

I created a UIView and added a UITapGestureRecognizer to it. but when I set the background color to "clear" (to effectively hide the view) it doesn't respond to the tap.

How can I make the view "invisible" and yet still active? I want to use a UIView because I've set it to respond to multiple taps, which is why I didn't use a UIButton

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T22:26:47.870

If it *is* the case where alpha < 0.1 starts ignoring events (I never heard that either), you could drop in a 1x1pt custom view/control where the 1px showing has a color that matches its background and has an alpha > 0.1,

Then override:

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event 
```

to return `YES` for a larger area than the 1x1 pt.

# php - 带有 WAMP 的 PHP 5.4 控制台？

> ID：12169600
> 
> 赞同：-2
> 
> 时间：2012-08-29T01:06:46.617
> 
> 标签：php, windows-7

1.  如何使用 WAMP 访问新的 PHP 控制台和 PHP Web 服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:10:28.597

**[这应该可以解决问题。](http://www.dotkernel.com/php-development/how-to-upgrade-wamp-to-php-5-3-4/)**

上面链接的是关于将 WAMP 服务器升级到更新的 PHP 的快速教程。即使本教程中的 PHP 版本已过时，对于您想要的任何版本，该过程都保持不变。

干杯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:18:46.743

从页面[WampServer](http://www.wampserver.com/en/)

单击`Download php Addons`（选择您的自定义版本并下载）

# ruby-on-rails-3.2 - Ruby on Rails 并选择标签：提示值

> ID：12169605
> 
> 赞同：4
> 
> 时间：2012-08-29T01:07:55.513
> 
> 标签：ruby-on-rails-3.2

我有一个奇怪的选择标签行为。这是我的代码的一部分：

**控制器**

```
 def edit
    @user = User.find(current_user.id)
  end 
```

**查看**（部分）

```
=form_for @user
.field
  = f.label :gender
  %br
  = genders_select(f) 
```

**帮手**

```
 def genders_select(form)
    form.select :gender, [ ['Female','0'], ['Male', '1'] ], :prompt=>'select your gender'
  end 
```

`edit`动作选择没有**提示**值，它有 2 个值：女性和男性。在我选择任何值并按下按钮后，会出现“选择您的性别”，并且还会出现错误“性别不能为空白”。

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T21:04:30.133

我遇到过同样的问题。使用`:include_blank`代替`:prompt`，即

```
def genders_select(form)
  form.select :gender, [ ['Female','0'], ['Male', '1'] ], :include_blank=>'select your gender'
end 
```

请参阅[此处](https://stackoverflow.com/a/6474727/1938600)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-16T20:13:37.243

请试试这个，我认为它会工作

```
f.select(:gender, options_for_select(['male', 'female']), {:prompt => 'Select Gender'}, {:class => "form-control slct-box"}) 
```

# iphone - 使用 ARMV7 将目标设备限制为 iPhone 4

> ID：12169610
> 
> 赞同：1
> 
> 时间：2012-08-29T01:08:27.843
> 
> 标签：iphone, ios, xcode, armv7

将架构配置为 ARMV7 是否将应用程序限制为只能安装到从 3Gs/iPhone 4 开始的设备上？我还想知道是否有另一种方法可以启用设备版本限制？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:30:04.370

如果您通过 中的`armv7`条目将应用程序限制为仅支持 ARMv7 设备`UIRequiredDeviceCapabilities`，这不会停止对 iPhone 4 级别的支持，它还将支持 iPhone 3GS 和第三代 iPod touch。如果你真的想限制在 iPhone 4 和更新的设备上，你可以使用`front-facing-camera`硬件过滤器，尽管这也会放弃原来的 iPad。

可以在[iTunes Connect 开发人员指南的附录 C：设备兼容性矩阵](https://developer.apple.com/library/ios/documentation/DeviceInformation/Reference/iOSDeviceCompatibility/DeviceCompatibilityMatrix/DeviceCompatibilityMatrix.html#//apple_ref/doc/uid/TP40013599-CH17-SW1)中找到设备的完整列表以及它们支持的选项。从该矩阵中，您可以看到将针对您指定的所需硬件功能组合阻止哪些设备。

# python - 如何计算 Scipy 中稀疏矩阵列的方差？

> ID：12169611
> 
> 赞同：14
> 
> 时间：2012-08-29T01:08:33.540
> 
> 标签：python, numpy, scipy

我有一个大的`scipy.sparse.csc_matrix`，想把它标准化。即从每个元素中减去列平均值，然后除以列标准偏差 (std)i。

`scipy.sparse.csc_matrix`有`.mean()`但是有一种有效的方法来计算方差或标准差吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-29T09:31:42.037

您可以使用平均值自己计算方差，[公式](https://en.wikipedia.org/wiki/Variance#Definition)如下：

```
E[X^2] - (E[X])^2 
```

`E[X]`代表平均值。因此，要计算`E[X^2]`，您必须先平方`csc_matrix`，然后使用该`mean`函数。为了得到`(E[X])^2`你只需要平方`mean`使用正常输入获得的函数的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-27T11:28:24.057

Sicco 有更好的答案。

但是，另一种方法是将稀疏矩阵一次转换为一列密集的 numpy 数组（与一次转换整个矩阵相比，保持内存需求较低）：

```
# mat is the sparse matrix
# Get the number of columns
cols = mat.shape[1]
arr = np.empty(shape=cols)
for i in range(cols):
    arr[i] = np.var(mat[:, i].toarray()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-09T07:52:25.390

我知道的最有效的方法是使用`StandardScalar`from `scikit`：

```
from sklearn.preprocessing import StandardScaler

scalar = StandardScaler(with_mean=False)
scalar.fit(X) 
```

然后方差在属性中`var_`：

```
X_var = scalar.var_ 
```

奇怪的是，当我第一次使用`pandas`（非常慢）时，我的答案偏离了几个百分点。我不知道哪个更准确。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-08-29T12:16:33.820

有效的方法实际上是对整个矩阵进行致密化，然后以通常的方式对其进行标准化

```
X = X.toarray()
X -= X.mean()
X /= X.std() 
```

正如@Sebastian 在他的评论中指出的那样，标准化会在减法步骤中破坏稀疏结构（引入许多非零元素），因此将矩阵保持为稀疏格式是没有用的。

# objective-c - 浮点小数不精确？

> ID：12169614
> 
> 赞同：1
> 
> 时间：2012-08-29T01:08:44.130
> 
> 标签：objective-c, c, floating-point

如果 a 的大小`float`是 4 个字节，那么它不应该能够从`8,388,607`那里`-8,388,608`或附近的某个地方保存数字，因为我可能计算错了。

为什么`f`显示额外`15`的，因为`f`(0.1) 的值仍然在`8,388,607`右之间`-8,388,608`？

```
int main(int argc, const char * argv[])
{
    @autoreleasepool {
        float f = .1;
        printf("%lu", sizeof(float));
        printf("%.10f", f);
    }
    return 0;
} 
```

* * *

```
2012-08-28 20:53:38.537 prog[841:403] 4
2012-08-28 20:53:38.539 prog[841:403] 0.1000000015 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:12:17.823

这些值`-8,388,608 ... 8,388,607`使我相信您认为浮点数使用二进制补码，而事实并非如此。无论如何，您拥有的范围表示 24 位，而不是您从四个字节中获得的 32 位。

C 中的浮点数使用[IEEE754](http://en.wikipedia.org/wiki/IEEE_754-1985)表示，它基本上包含三个部分：

*   标志。
*   指数（某种比例）。
*   分数（数字的实际数字）。

您基本上可以获得一定的精度（例如 7 个十进制数字），而指数决定了您是否将这些精度用于 0.000000001234567 或 123456700000 之类的数字。

您在末尾获得这些额外数字的原因`0.1`是因为该数字无法在 IEEE754 中精确表示。请参阅[此答案](https://stackoverflow.com/questions/3448777/how-to-represent-0-1-in-floating-point-arithmetic-and-decimal/3448855#3448855)以获取解释为什么会这样的论文。

只有当可以通过在精度位数（即分数中的位数）内添加 2 的逆幂（如`1/2`、`1/16``1/65536`

因此，例如，数字 like`0.5`是可以的，因为它是`1/2`. 同样`0.8125`是可以的，因为它可以从`1/2`,`1/4`和构建`1/16`。

没有办法（至少在 23 位精度内）可以`0.1`从 2 的逆幂构建，因此它为您提供最接近的匹配。

# opengl - 创建 IBO 后 glDrawArrays 段错误

> ID：12169619
> 
> 赞同：0
> 
> 时间：2012-08-29T01:09:29.490
> 
> 标签：opengl

我有一堆元素当前从 VBO 渲染使用`glDrawArrays`没有问题。

但是，当我添加一个 IBO 时，即使没有任何使用它的渲染代码，我也会在`glDrawArrays`.

我检查了所有 glBindBuffer 调用 10 次，问题不存在。但这与IBO的规模有关。这是触发 glDrawArrays 崩溃的附加代码：

```
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, id);
glBufferData(GL_ELEMENT_ARRAY_BUFFER, size, NULL, GL_STREAM_DRAW);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0); 
```

如果`size`超过 5kb，我开始崩溃。崩溃是一致的，但取决于我正在渲染的元素。例如，在 6kb 时我不会立即崩溃，但如果我拉下另一个最初隐藏的 UI 元素，它会在渲染时崩溃。如果我将它设置在 8kb 以上，我总是会立即在第一个元素上使用`glDrawArrays`.

我的直觉是`glBufferData`，考虑到与崩溃可能性的相关性，该调用以某种方式破坏了某处的内存`size`，但我无法弄清楚我做错了什么。

我正在使用官方 nVidia 驱动程序在 x64 Linux 上运行。

编辑：这是 glDrawArrays 代码：

```
cgGLBindProgram(program);
glBindBuffer(GL_ARRAY_BUFFER, vbo);
cgGLEnableClientState(verts);
cgGLSetParameterPointer(verts, vertSize, GL_FLOAT, stride, reinterpret_cast<void*>(vertoffset);
gGLEnableClientState(texcoords);
cgGLSetParameterPointer(texcoords, tcSize, GL_FLOAT, tcstride, reinterpret_cast<void*>(tcoffset);
cgSetMatrixParameterfc(matrix, (*m)[0]);   // ortho matrix
cgGLSetParameter4f(color, f1, f2, f3, f4);
cgGLBindProgram(fragmentProgram);
cgGLSetTextureParameter(texture, tex->getID());
cgGLEnableTextureParameter(texture);
glDrawArrays(GL_QUADS, first, vertCount); 
```

使用的着色器：

```
output ortho(float2 position : POSITION, float2 texCoord : TEXCOORD0, uniform float4 color : COLOR, uniform float4x4 ortho_proj) {
    output OUT;

    OUT.position = mul(float4(position, 0, 1), ortho_proj);
    OUT.color = color;
    OUT.texCoord = texCoord;

    return OUT;
}

void textured(float4 color : COLOR, float2 texCoord : TEXCOORD0, out float4 outColor, uniform sampler2D texture) {
    outColor = tex2D(texture, texCoord) * color;
} 
```

# android - Android App，如何在没有 GUI 的情况下运行？

> ID：12169623
> 
> 赞同：0
> 
> 时间：2012-08-29T01:11:04.783
> 
> 标签：android, eclipse, android-layout, android-intent

如何在不实际打开 gui 的情况下创建一个运行方法或活动的简单应用程序？我已经有了应用程序的编码。例如，我有一个 android 上的任务管理器，您可以推送一个图标，它会终止在后台运行的应用程序，而无需打开应用程序然后手动推送终止。

我只是删除布局还是需要更多？抱歉使用了错误的术语，我还在学习。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:18:05.573

偶然遇到你的问题，我自己也在学习。但在我看来，您可能应该考虑提供服务，而不是具有布局的活动。服务可以在后台工作并与其他应用程序交互，在我看来就是你的情况。 [Android 服务 API](http://developer.android.com/reference/android/app/Service.html) http://developer.android.com/reference/android/app/Service.html

祝你好运！

# java - Android - 在 ListView 中显示所有 SQLite 数据库条目

> ID：12169629
> 
> 赞同：0
> 
> 时间：2012-08-29T01:11:40.070
> 
> 标签：java, android, database, sqlite, simplecursoradapter

我想要做的是在 ListView 中显示数据库的内容。布局包含一个我已经使用和实现的 ListView，但我似乎无法让它们一起工作（甚至光标），有人可以帮我解释一下为什么我的光标实现不起作用吗？

我有一种方法可以将数据库条目作为光标返回：

```
public Cursor getAllRecords() {
     return db.query(DATABASE_TABLE, new String[] {KEY_ROWID, KEY_TEXT}, null, null, null, null, null);
 } 
```

我有一个要插入和显示数据库条目的类：

```
Button add;
EditText tM;
ListView generalList;
DBAdapter dba = new DBAdapter(this);

 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_general);

        add = (Button) findViewById(R.id.button1);
        tM = (EditText) findViewById(R.id.editText1);
        generalList = (ListView) findViewById(R.id.generalList);

        Cursor c = dba.getAllRecords();
        c.moveToFirst();

        SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, R.id.generalList, c, new String[] {dba.KEY_TEXT}, new int[] {R.id.generalList}, 0);
            // This doesn't seem to work for me, I don't know how to fix it
            // or how to then get it working with the ListView

        generalList.setAdapter(adapter);

        add.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                insertIntoDatabase();
            }
        });
    }

 public void insertIntoDatabase() {
     dba.open();
     dba.insertRecord(textMessage.getText().toString());
     Toast.makeText(this, "Added:\n" + tM.getText().toString(), Toast.LENGTH_LONG).show();
     dba.close();
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:25:47.827

如果列表仅包含 1 `TextView`，则可以使用`android.R.layout.simple_list_item_1`而不是`R.id.generalList`.

并将其更改`new int[] {R.id.generalList}`为`new int[] {android.R.id.text1}`

像 ：

```
SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_1, c, new String[] {dba.KEY_TEXT}, new int[] {android.R.id.text1}, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:37:49.390

在接收 simplecursoraapter 的参数上，记住它接收的布局是实际项目的布局，而不是列表视图。所以从那里删除 R.id.generalList ，因为这是标识列表视图的 id 而不是完整布局。所以用包含文本视图的布局替换它。现在，在 int 数组上是 textview 的 id，它将显示您想要的文本，在字符串数组上传递从数据库读取的记录中的字段名称。按照aprian 所说的去做，并且知道您可以根据需要自定义项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T02:14:25.863

当使用带有 CursorAdapter 的 ListView 时，从该列返回的 Cursor 必须包含一个具有唯一标识每一行的名称 _id 的列。我猜您要获取的一列（dba.KEY_TEXT）未命名为“_id”。您可以在表中添加一个名为 _id 的列，或者在执行 SELECT 时让数据库将名称返回为 _id

IE

```
SELECT col_name as _id FROM my_table; 
```

或者

```
SELECT col_name _id FROM my_table; 
```

# python - 如何保证布尔值仅适用于 Django 中具有特定 ForeignKey 的一行？

> ID：12169633
> 
> 赞同：1
> 
> 时间：2012-08-29T01:12:42.760
> 
> 标签：python, database, django, foreign-keys, race-condition

想象一下这样的事情：

```
class User(models.Model):
     name = CharField(max_length=80)

class TelephoneNumber(models.Model):
     phone_number = CharField(max_length=10)
     user = ForeignKey(User)
     is_default_number = BooleanField 
```

假设我想保证每个用户只有一个默认电话号码。我们想拥有多少就拥有多少`is_default_number == False`，但每个人都`user`应该只有*一个*拥有`is_default_number == True`。

有没有办法通过 Django 在数据库级别强制执行此操作？我知道纯 Python 中的一个简单解决方案是：

```
class TelephoneNumber(models.Model):
    phone_number = CharField(max_length=10)
    user = ForeignKey(User)
    is_default_number = BooleanField

    def save(self, *args, **kwargs):
         other_defaults_same_user = TelephoneNumber.objects.filter(
              user=self.user,
              is_default_number=True
         ).exclude(
              pk=self.pk
         )

         if self.is_default_number and other_defaults_same_user.exists():
              raise ValidationError("Can't have two phone numbers as default"
                                    " for one user.")

         super(TelephoneNumber, self).save(*args, **kwargs) 
```

但这很容易受到竞争条件错误的影响，而且我不喜欢每次保存时都必须进行额外读取（不过，在某些时候可能需要额外读取）。有什么方法可以在 Django 中实现这一点吗？如果我们必须使答案依赖于数据库，我很想看看答案，但显然独立于后端的答案是最好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:55:03.823

你为什么不把 default_phone_number 作为用户模型的外键？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T04:30:19.180

使用模型字段验证 - [https://docs.djangoproject.com/en/dev/ref/models/instances/#validating-objects](https://docs.djangoproject.com/en/dev/ref/models/instances/#validating-objects)。

```
if self.is_default_number and TelephoneNumber.objects.filter(user=self.user, is_default_number=True).exclude(id=self.id).exists():
#throw ValidationError 
```

我不认为你可以避免额外的阅读。

# c++ - 为什么我只需要一个对象时会创建两个对象？

> ID：12169634
> 
> 赞同：3
> 
> 时间：2012-08-29T01:12:47.033
> 
> 标签：c++, c++11, rvalue-reference

我刚刚编译了这个简单的片段：

```
#include <iostream>
#include <string>

std::string foo()
{
    return std::string("bar");
}

int main()
{
    std::string test = foo();
    std::cout << test << std::endl;
    return 0;
} 
```

使用`-O2`优化，却发现正在创建两个 std::string 对象。当我转储二进制文件时，objdump 显示它`~basic_string`被调用了两次。

```
0000000000400900 <main>:
  400900:   53                      push   %rbx
  400901:   48 83 ec 10             sub    $0x10,%rsp
  400905:   48 89 e7                mov    %rsp,%rdi
  400908:   e8 73 01 00 00          callq  400a80 <foo()>
  40090d:   48 89 e6                mov    %rsp,%rsi
  400910:   bf 80 10 60 00          mov    $0x601080,%edi
  400915:   e8 a6 ff ff ff          callq  4008c0 <std::basic_ostream<char, std::char_traits<char> >& std::operator<< <char, std::char_traits<char>, std::allocator<char> >(std::basic_ostream<char, std::char_traits<char> >&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)@plt>
  40091a:   48 89 c7                mov    %rax,%rdi
  40091d:   e8 ae ff ff ff          callq  4008d0 <std::basic_ostream<char, std::char_traits<char> >& std::endl<char, std::char_traits<char> >(std::basic_ostream<char, std::char_traits<char> >&)@plt>
  400922:   48 89 e7                mov    %rsp,%rdi
  400925:   e8 76 ff ff ff          callq  4008a0 <std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()@plt>
  40092a:   48 83 c4 10             add    $0x10,%rsp
  40092e:   31 c0                   xor    %eax,%eax
  400930:   5b                      pop    %rbx
  400931:   c3                      retq   
  400932:   48 89 c3                mov    %rax,%rbx
  400935:   48 89 e7                mov    %rsp,%rdi
  400938:   e8 63 ff ff ff          callq  4008a0 <std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()@plt>
  40093d:   48 89 df                mov    %rbx,%rdi
  400940:   e8 ab ff ff ff          callq  4008f0 <_Unwind_Resume@plt>
  400945:   66 66 2e 0f 1f 84 00    data32 nopw %cs:0x0(%rax,%rax,1)
  40094c:   00 00 00 00 
```

因为我真的只需要一个对象，所以我考虑`foo()`使用右值引用来捕获返回的值。所以我把这行代码`std::string && test = foo();`改成 Weirdly，objdump 仍然显示调用了两个析构函数。谁能解释我为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T01:38:57.997

第一个析构函数调用之后是几条指令`retq`：

> ```
>  400925:   e8 76 ff ff ff          callq  4008a0 <std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()@plt>
>   ...
>   400931:   c3                      retq 
> ```

这是*正常*的代码流程。

从后面`mov`的 at开始`400932`是内部用于通过异常传播展开堆栈的代码，通常称为*landing pad*。

> ```
>  400932:   48 89 c3                mov    %rax,%rbx
>   400935:   48 89 e7                mov    %rsp,%rdi
>   400938:   e8 63 ff ff ff          callq  4008a0 <std::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()@plt>
>   40093d:   48 89 df                mov    %rbx,%rdi
>   400940:   e8 ab ff ff ff          callq  4008f0 <_Unwind_Resume@plt> 
> ```

[这](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gccint/RTL-passes.html)是 GCC 不得不说的：

> *   生成异常处理着陆区
>     
>     
>     
>     此过程生成处理异常处理库例程和函数内的异常处理程序之间的通信的粘合剂。异常处理库调用的函数中的入口点称为*着陆板*。此通行证的代码位于`except.c`.

正如你所看到的，控制流的路径是完全不同的，所以析构函数只会被调用一次。

`_Unwind_Resume`是 AMD64 和 Itanium C++ ABI 的一部分，用于展开调用堆栈，直到它到达能够捕获异常类型的函数。您需要进行一些挖掘才能从 Google 中找到有关它的大量信息。[这](http://www.ucw.cz/~hubicka/papers/abi/node25.html#SECTION00923300000000000000)是一个很好的资源来讨论它。

> _ **Unwind_Resume**
> 
> ```
> void _Unwind_Resume
> (struct _Unwind_Exception *exception_object); 
> ```
> 
> 恢复现有异常的传播，例如在部分展开的堆栈中执行清理代码之后。在执行清理但未恢复正常执行的着陆台末尾插入对该例程的调用。它导致展开进一步进行。
> 
> `_Unwind_Resume`不应该用来实现重投。对于展开运行时，重新抛出的 catch 代码是一个处理程序，并且之前的展开会话在进入之前终止。`_Unwind_RaiseException`重新抛出是通过使用相同的异常对象再次调用来实现的。
> 
> 这是 unwind 库中唯一预计由生成的代码直接调用的例程：它将在“着陆垫”模型中的着陆垫结束时调用。

# php - php文件下载头文件

> ID：12169636
> 
> 赞同：0
> 
> 时间：2012-08-29T01:12:50.543
> 
> 标签：php, header, download, readfile

这让我卡了很长时间，经过大量研究后，我尝试了几种方法。

这是我下载文件的当前代码：

```
<?php
  require_once ('./newpub_profile.php');
  $thetitle = $row['title'];
  $thesize = $row['size'];

 function filedownload() { 
    GLOBAL $thesize, $thetitle;
    header("Content-Type: application/msword");
    header("Content-Disposition: attachment; filename=".$thetitle);
    header("Content-Length: ".$thesize);
    header("Content-Transfer-Encoding: binary");
    readfile($realfile);
 }
?> 
```

在另一个 php 页面上，我正在填充一个查询结果表，每个结果都有一个相应的下载链接。如果我将鼠标悬停在链接上，我可以验证其下载 ID 是否正确（在 mysql db 中）。下载链接当前指向包含上述代码的 download.php。此代码允许我下载一个标题为“download.php”的文件，其中不包含任何内容。我从用户个人资料页面调用函数“filedownload()”。

这就是我显示下载链接的方式：

```
while ($row = mysqli_fetch_array($r,MYSQLI_ASSOC))
        {
            echo '<tr><td align="left">' .
            $row['title'] . '</td><td align="left">'
            . $row['genre'] . '</td><td align="left">'
            . $row['length'] . '</td><td align="left">'
            . $row['created'] . '</td><td align="left">'
            //. $row['views'] . '</td><td align="left">'
            . "<a href='download.php?id={$row['upload_id']}'>Download</a></td>" . '</td></tr>';
        } 
```

下面是调用 header 函数的页面代码。

```
 <?php if (isset($_POST['query']))
   {
   require_once (connectionToDB); //Connect to the db

    // Make the query
   $genre = $_POST['select_genre'];
   $length = $_POST['select_length'];

    $upviews = "UPDATE upload
                SET views = views + 1
                WHERE genre = '$genre' AND length = '$length'";
    $runviewupdate = mysqli_query ($dbc, $upviews);

    $q = "SELECT upload_id, title, genre, length, created
        FROM upload
        WHERE genre = '$genre' AND length = '$length'
        ORDER BY created DESC, title DESC";

    $r = mysqli_query ($dbc, $q); // Run the query

    if($r)
    {
        // If it ran okay, display the records
        echo '<table align="center"
            cellspacing="3" cellpadding="3"
            width="75%">
           <tr><td align="left"><b>Title</b></td>
           <td align="left"><b>Genre</b></td>
           <td align="left"><b>Pages</b></td>
           <td align="left"><b>Submitted</b></td>
           <td align="left"><b>Download</b></td>';

        // Fetch and print all the records:

        while ($row = mysqli_fetch_array($r,MYSQLI_ASSOC))
        {
            echo '<tr><td align="left">' .
            $row['title'] . '</td><td align="left">'
            . $row['genre'] . '</td><td align="left">'
            . $row['length'] . '</td><td align="left">'
            . $row['created'] . '</td><td align="left">'
            //. $row['views'] . '</td><td align="left">'
            . "<a href='newpub_profile.php?id={$row['upload_id']}'>Download</a></td>" . '</td></tr>';
        }
        echo '</table>'; // Close the table

        mysqli_free_result ($r); // Free up the resources
    }
    else // If it did not run okay
    {
        // Public Message:

        echo '<p class="error">Your submissions could not be retrieved.  We
            apologize for any inconvenience.</p>';

        // Debugging message:

        echo '<p>' . mysqli_error($dbc) . '<br /><br />Query: ' . $q . '</p>';

    } // End of if ($r) IF.

}

//END DOWNLOAD HANDLER ******************************************************

    mysqli_close($dbc); // Close the database connection

if(isset($_GET['id'])) {
// Get the ID
    $id = intval($_GET['id']); //var_dump($id);

    require_once ('../mysqli_connect.php'); //Connect to the db

// Fetch the file information

    if($stmt = $mysqli -> prepare("SELECT `file_type`, `size`, `title`, 'content', 'upload_id'
            FROM `upload`
            WHERE `upload_id` =?")) {

      /* Bind parameters
         s - string, b - boolean, i - int, etc */
      $stmt -> bind_param("sissi", $file_type, $size, $title, $content, $upload_id);

      /* Execute it */
      $stmt -> execute();   /*FINISH PREPARED STATEMENTS*/

      /* Bind results */
      $stmt -> bind_result($result);

      /* Fetch the value */
      $stmt -> fetch();

      //echo $user . "'s level of priviledges is " . $result;

      /* Close statement */
      //$stmt -> close();

        if($result) {
            // Make sure the result is valid
            if (mysqli_num_rows($result) > 0) {
            // Get the row
                $row = mysqli_fetch_assoc($result);
                //var_dump($row);
                //$data = $row;

                $place = './uploads/'.$_SESSION_['email'].'/';
                $thefile = $place.$row['title'];
                $realfile = $thefile;
                $thetitle = $row['title'];
                $thesize = $row['size'];

               require_once('./download.php');
               filedownload();

            }
            else {
                echo 'Error! No such ID.';
            }

            // Free the mysqli resources
            mysqli_free_result($result);
        }
        else {
            echo "Error! Query failed: <pre>{$dbc->error}</pre>";
        }
        mysqli_close($dbc);
        $stmt -> close();
            }

    }

                    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:26:48.370

您创建了一个函数`filedownload()`，但您从未调用它，因此它的主体永远不会被执行。您也永远不会定义`$realfile`要发送的文件的路径。

调用你的函数：

```
<?php
  require_once ('./newpub_profile.php');
  $thetitle = $row['title'];
  $thesize = $row['size'];

 function filedownload() { 
    GLOBAL $thesize, $thetitle;
    header("Content-Type: application/msword");
    header("Content-Disposition: attachment; filename=".$thetitle);
    header("Content-Length: ".$thesize);
    header("Content-Transfer-Encoding: binary");
    readfile($realfile);
 }

 filedownload();
?> 
```

虽然似乎没有理由首先在函数中使用它：

```
<?php
  require_once ('./newpub_profile.php');
  $thetitle = $row['title'];
  $thesize = $row['size'];

  header("Content-Type: application/msword");
  header("Content-Disposition: attachment; filename=".$thetitle);
  header("Content-Length: ".$thesize);
  header("Content-Transfer-Encoding: binary");
  readfile($realfile);
?> 
```

# jquery - Facebook 客户端永久访问令牌

> ID：12169637
> 
> 赞同：2
> 
> 时间：2012-08-29T01:13:05.017
> 
> 标签：jquery, facebook, json

我正在使用 JSON 来检索 Facebook 相册以创建画廊。

由于画廊不是公开的，所以我使用`access token`完美的作品，但它会在一段时间后过期。

我想知道是否可以获得永久访问令牌？

这就是我检索json的方式

```
https://graph.facebook.com/346138265459638/photos?access_token=AAACEdEose0cBAHjZCqytFok9nvE9ubvpQNS1RWZANIjTz3aYUnIC7bVsvOL8idm9BQRCR3y7L5XRLWtpkekqMSpoVZCOZCWpNccY6ag2K8AFHu9kBQXZC 
```

这是我从中得到的一些信息，但我无法弄清楚。

```
http://developers.facebook.com/docs/authentication/client-side/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T02:35:14.813

因此，如果您尝试为用户相册执行此操作，则不存在未过期的访问令牌之类的东西。如果您尝试对页面执行此操作，则存在未过期的令牌，但您需要先从用户那里检索一个长期存在的令牌，然后为页面请求一个...

执行所有这些操作的文档位于此处：[https ://developers.facebook.com/docs/howtos/login/extending-tokens/](https://developers.facebook.com/docs/howtos/login/extending-tokens/)

# include - 为什么 SSI 条件！= || != 不起作用？

> ID：12169639
> 
> 赞同：1
> 
> 时间：2012-08-29T01:13:11.043
> 
> 标签：include, ssi, server-side-includes

我无法使用这个条件表达式

```
<!--#if expr="$DOCUMENT_NAME!=index.html || $DOCUMENT_NAME!=links.html" --> 
```

而这个没有`!`之前`=`的作品完美

```
<!--#if expr="$DOCUMENT_NAME=index.html || $DOCUMENT_NAME=links.html" --> 
```

有什么问题？我没有收到任何错误`!=`，尽管在其他条件下不起作用`||`，但适用于单一条件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:01:03.183

这是因为`=`和`!=`几乎不是同一个运算符。请注意，根据[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan's_laws)（我也在[这篇旧帖子中解释过](https://stackoverflow.com/questions/6115801/how-do-i-test-if-a-variable-does-not-equal-either-of-two-values/6115869#6115869)），

```
a != b || c != d 
```

相当于

```
a = b && c = d 
```

这对于where**永远不会正确**。`x = a && x = b``a != b`

更改二元运算符也*需要*更改条件以使其等效。

因此，根据上述逻辑，

```
$DOCUMENT_NAME!=index.html || $DOCUMENT_NAME!=links.html 
```

相当于

```
$DOCUMENT_NAME=index.html && $DOCUMENT_NAME=links.html 
```

这*不可能*是真的，因为 $DOCUMENT_NAME 可以是 "index.html"*或*"links.html" 但*不能同时是两者*。

然而，第二个片段，

```
$DOCUMENT_NAME=index.html || $DOCUMENT_NAME=links.html 
```

“有效”，因为没有上面提到的逻辑永远不正确的谬误。*当 $DOCUMENT_NAME是*“index.html”或“links.html”时，它会是真的。

* * *

一些语言/价值观会违反上述等价性..但这是另一个话题。

# jquery - 图像精灵 - 导航栏

> ID：12169640
> 
> 赞同：0
> 
> 时间：2012-08-29T01:13:20.773
> 
> 标签：jquery, image, jquery-mobile, css-sprites

我有一个导航栏，其中的图标是使用精灵构建的。我在精灵中有蓝色和绿色图标，但是当按钮在 jquery mobile 中处于 .ui-btn-active 状态时，我无法将图标切换为绿色。有人可以帮忙吗？以下是我为达到预期结果所做的尝试。谢谢。史蒂文

```
.nav-glyphish-example .ui-btn .ui-btn-inner { padding-top: 40px !important; }
     .nav-glyphish-example .ui-icon { width: 40px!important; height: 40px!important; margin-   left: -15px !important; box-shadow: none!important; -moz-box-shadow: none!important; -webkit-box-shadow: none!important; -webkit-border-radius: 0 !important; border-radius: 0 !important; }
    #home .ui-icon{background: url(glyphish/icons/icons-gray/imagesprite.png) no-repeat center; background-position: -444px 0; width: 28px; height: 30px;}
    #home .ui-icon .ui-btn-active{background: url(glyphish/icons/icons-gray/imagesprite.png) no-repeat center; background-position: -522px 0; width: 28px; height: 30px;} 
```

这是 HTML 代码：

```
 <div class="nav-glyphish-example ui-navbar" data-role="navbar" data-iconpos="top" data-theme="g" role="navigation" >
                    <ul class="ui-grid-d">
                        <li class="ui-block-a">
                            <a id="home" href="calendartop.html" data-theme="g" data-icon="home"  data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-iconpos="top" data-inline="true"><span class="ui-btn-text">
                                Home
                            </span></a>
                        </li>
                        <li class="ui-block-b">
                            <a id="me" href="me.html" data-theme="g" data-icon="custom"  data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-iconpos="top" data-inline="true" class="ui-btn ui-btn-up-g ui-btn-inline ui-btn-icon-top" ><span class="ui-btn-text">
                                Me
                            </span></a>
                        </li>
                        <li class="ui-block-c">
                            <a id="friends" href="friendshome.html" data-theme="g" data-icon="custom" class="ui-btn-active ui-state-persist ui-btn ui-btn-up-g ui-btn-inline ui-btn-icon-top" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-iconpos="top" data-inline="true" ><span class="ui-btn-text">
                                Friends
                            </span></a>
                        </li>
                        <li class="ui-block-d">
                            <a id="companies" href="companyhome.html" data-theme="g" data-icon="custom"  data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-iconpos="top" data-inline="true" class="ui-btn ui-btn-inline ui-btn-icon-top ui-btn-up-g"><span class="ui-btn-text">
                                Companies
                            </span></a>
                        </li>
                        <li class="ui-block-e">
                            <a id="invites" href="eventhome.html" data-theme="g" data-icon="custom" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-iconpos="top" data-inline="true" class="ui-btn ui-btn-up-g ui-btn-inline ui-btn-icon-top"><span class="ui-btn-text">
                                Invites
                            </span></a>
                        </li>
                    </ul>
                </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:20:49.833

您需要将最后一个选择器更改为`#home .ui-icon.ui-btn-active`. 也就是说，假设图标的标签通常类似于`<a class="ui-icon">`并且`<a class="ui-icon ui-btn-active">`在活动时变为。

为了简化你的 CSS，第二条规则可以是

```
#home .ui-icon .ui-btn-active{
    background-position: -522px 0;
} 
```

因为其他东西保持不变。

# math - 混合基数在现实世界中的使用

> ID：12169643
> 
> 赞同：0
> 
> 时间：2012-08-29T01:14:19.777
> 
> 标签：math, radix

我正在阅读一本算法书，其中简要提到了使用[混合基数](http://en.wikipedia.org/wiki/Mixed_radix)来存储日期。stackoverflow 中只有一篇文章，我在互联网上几乎找不到关于它的其他文章（特别是将[混合基数转换为小数](https://stackoverflow.com/questions/759296/converting-a-decimal-to-a-mixed-radix-base-number)）。

混合基数是现实世界中使用的概念吗？如果是这样，现实世界使用的例子是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:46:42.197

这个概念被大量使用，特别是对于日期/时间。您还可以使用非公制测量单位，英里-码-英尺-英寸，磅-盎司等。

# iphone - 如何在同一视图中使用 2 个pickerview

> ID：12169645
> 
> 赞同：0
> 
> 时间：2012-08-29T01:14:39.233
> 
> 标签：iphone, ios, xcode

我需要在我的应用程序中创建 2 个选择器。我需要在 iphone 的同一屏幕上显示类别和产品类型，问题是，这可能吗？

谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T04:38:40.810

是的，您可以通过使用pickerview 的两个不同对象来做到这一点。给两者都添加标签并使用委托方法和标签。

# memory-management - 使用 pygame 进行 Python 2.7 内存管理

> ID：12169646
> 
> 赞同：0
> 
> 时间：2012-08-29T01:14:46.597
> 
> 标签：memory-management, graphics, python-2.7, pygame

我是 Python 的新手，用 pygame 写一些东西，而且它是位图密集型的。以下是有关它的某些（当前）事实：

1.  所有图形文件都有可能在程序实例的任何时候被重用。
2.  如果我一开始就预加载所有内容，即使没有重复，它也会占用 1GB 以上的内存。
3.  在（几乎）需要时加载图像并不难，即文件大小与内存使用量相比非常小，并且很容易预测接下来会发生什么。

有很多建议不要使用**del**，我不知道这是否适用于我的情况。我已经考虑过利用垃圾收集机制，通过实现一个资源管理器来保存对任何加载图像的唯一引用，它通过不同的图像来处理不同的图像，大致是通过删除一个引用同时重新加载另一个。

但是，我不太确定这是否真的在任何时候释放了任何内存，而且我不知道如何让 GC 真正持续地保持内存下降，因为 gc 调用似乎非常昂贵（并且默认情况下太不频繁)

所以总而言之，我想知道上面列出的方法是否值得一试，如果没有，我希望有人能教我其他方法，比如正确使用**del**，以及这是否适合 pygame。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T02:35:40.003

试试这个，看看它是否足够好。[http://www.pygame.org/wiki/LazyImageLoading?parent=CookBook](http://www.pygame.org/wiki/LazyImageLoading?parent=CookBook)

> 当您第一次引用 ImageController 实例中的项目时，它会被加载并返回。虽然保留了对图像的引用，但它在 ImageController 中仍然可用。当图像不再有任何活动引用时，它会从内存中删除，并在下次引用时重新加载。

使您的初始纹理管理器设计尽可能简单。之后，如果分析表明您需要更高的性能，则进行优化。

# asp.net-mvc - asp.net mvc 3中的客户端验证

> ID：12169647
> 
> 赞同：0
> 
> 时间：2012-08-29T01:14:59.117
> 
> 标签：asp.net-mvc

我有一个注册表单，我曾经在我的最后一个 asp.net mvc 2 项目中使用它。现在我将该注册表单复制到我的 asp.net mvc 3 中。

这些是我从上一个项目中复制的：

1.  所有 jquery 验证 + Microsoft mvc ajax 文件
2.  在源代码中包含所有文件
3.  在我看来使用 `Html.ValidationMessage`。
4.  `[Required(ErrorMessage = "*")]`在我的模型中使用

但在我看来，它仍然没有验证脚本。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:04:19.650

Microsoft mvc ajax 文件已被弃用。

改用 MVC3 提供的 jquery 验证脚本。

# regex - 在文件中找到“key”时替换“key”的“value”

> ID：12169648
> 
> 赞同：0
> 
> 时间：2012-08-29T01:15:08.127
> 
> 标签：regex, perl, replace

我在将一个文件中的某些字符串的值替换为另一个文件中的相同字符串时遇到问题。

```
test1.txt

porsche  430+turbo blue
ferrari  520+supercharged red
buggati  1001+supersport black
fiat     turbo white 
```

此 test1.txt 中的某些字符串具有自己的值，如 test2.txt 中所示

```
test2.txt
turbo=30
supercharged=50 
supersport=100 
```

每当我找到相应的字符串时，我想在 test1.txt 中替换 test2.txt 中的值。

```
output.txt
    porsche  460 blue
    ferrari  570 red
    buggati  1101 black
    fiat     30 white 
```

在 test1.txt 中查找 test2.txt 中的 Turbo，然后将值替换并求和。

我做了很多谷歌搜索，但我没有找到继续进行此操作的方法。谁能帮我提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T04:16:13.293

amon 的解决方案既漂亮又优雅。+1（我还没有足够的声望点来对他的回答发表评论）

如果您发现不需要操作员调度表的可扩展性，这里有一个相当简单的替代方案：

（2012 年 8 月 29 日编辑：合并了 amon 的调度表，用于处理 +、-、*、/、^ 运算符）

```
use strict;
use warnings;
use English qw( -no_match_vars );

setup_for_testing( );

open my $source_file, '<',  'text1.txt' || die "Couldn't open source file: $OS_ERROR";
open my $key_file,    '<',  'text2.txt' || die "Couldn't open key file: $OS_ERROR";

# Clear the output file
open my $output_file, '>',  'output.txt' || die "Couldn't open output file: $OS_ERROR";

# Now open output file for append
open $output_file,    '>>', 'output.txt' || die "Couldn't open output file: $OS_ERROR";

# Create translation map from text2.txt
my %translation_map = translation_map( $key_file );

# Process text1.txt and print to output.txt
while ( my $source_line = <$source_file> ) {
    my $transformed_line = transform( $source_line, \%translation_map );
    print $output_file $transformed_line ||
        die "Couldn't print to output file: $OS_ERROR";;
}

# Tidy up
close $source_file || die "Couldn't close source file: $OS_ERROR";
close $key_file    || die "Couldn't close key file: $OS_ERROR";
close $output_file || die "Couldn't close output file: $OS_ERROR";

###################
sub setup_for_testing {
   open my $textfile1, '>',  'text1.txt' || die "Couldn't open source file: $OS_ERROR";
   open my $textfile2, '>',  'text2.txt' || die "Couldn't open key file: $OS_ERROR";

   my $source_text =<<'END_TEXT';
porsche  430-turbo blue
ferrari  520*supercharged red
buggati  1001+supersport black
fiat     turbo white
END_TEXT

   my $key_file_text =<<'END_TEXT';
turbo=30
supercharged=50
supersport=100
END_TEXT

   print $textfile1 $source_text   || die "Couldn't print to text1.txt: $OS_ERROR";
   print $textfile2 $key_file_text || die "Couldn't print to text2.txt: $OS_ERROR";

   close $textfile1 || die "Couldn't close source file: $OS_ERROR";
   close $textfile2 || die "Couldn't close key file: $OS_ERROR";

   return; # intentional void return
}

sub translation_map {
    my $key_file = shift;

    my %translation_map;
    while ( my $key_mapping = <$key_file> ) {
        chomp $key_mapping;

        # The regex /x option allows whitespace in the regular expression for readability
        my ( $key, $value ) = split / \s* = \s* /x, $key_mapping;
        $translation_map{ $key } = $value;
    }

    return %translation_map;
}

sub transform {
    my $source_line = shift @_;
    my %value_for   = %{ shift @_ };

    my $transformed_line = $source_line;

    foreach my $key ( keys %value_for ) {
        # The regex /e option causes the rights side of a substitution to be evaluated as
        # a Perl expression.
        my $value = $value_for{ $key };
        my ( $before_expression, $lvalue, $operator, $rvalue_key, $after_expression ) =
            ( $transformed_line =~ m/ \A
                                      ( .*? )
                                      ( \d+ ) ([-+*\/^]?) ( $key )
                                      ( .* )
                                      \Z
                                    /x );

        if ( $operator  ) {
            my $rvalue = $value_for{ $rvalue_key };

            # Using the dispatch table from amon's answer
            my $value_of_expression = {
              '+' => sub {$_[0] +  $_[1]},
              '-' => sub {$_[0] -  $_[1]},
              '*' => sub {$_[0] *  $_[1]},
              '/' => sub {$_[0] /  $_[1]},
              '^' => sub {$_[0] ** $_[1]},
            }->{$operator}->($lvalue, $rvalue);

            $transformed_line =
                $before_expression . $value_of_expression . $after_expression . "\n";
        } else {
            $transformed_line =~ s/$key/$value/;
        }
    }

    return $transformed_line;
} 
```

此脚本根据您的问题规范创建测试文件 text1.txt 和 text2.txt，然后进行转换并输出到 output.txt：

```
> ls
stackoverflow-12169648_replace_value_of_key.pl

> perl stackoverflow-12169648_replace_value_of_key.pl 

> ls
output.txt                  text1.txt
stackoverflow-12169648_replace_value_of_key.pl  text2.txt

> more text1.txt 
porsche  430+turbo blue
ferrari  520+supercharged red
buggati  1001+supersport black
fiat     turbo white

> more text2.txt 
turbo=30
supercharged=50
supersport=100

> more output.txt 
porsche  460 blue
ferrari  570 red
buggati  1101 black
fiat     30 white 
```

希望这是有用的。

。大卫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:49:09.470

我将假设第一个文件（称为*A*）具有由一个或多个空白字符分隔的三列。第二列可能包含一个算术表达式，其中包含由基本（中缀）运算符分隔的十进制数字和变量。变量值固定在另一个文件中，此后称为*B*。

准备变量很简单：

```
my %variables = map {chomp; split /=/, $_, 2} do {
  open my $file, "<", $filename_B or die;
  <$file>;
}; 
```

解析其他文件更加困难。假设它被打开到文件句柄`$fileA`中，我们遍历这些行并将每一行分成三个字段：

```
while (defined(my $line = <$fileA>)) {
   chomp $line;
   my ($model, $expression, $color) = split /\s+/, $line, 3;
   my $value = parseExpression($expression);
   print "\t$model $value $color\n"; # use printf to prettyprint if needed
} 
```

然后我们将表达式值与其他数据一起打印出来，假设您要打印到 STDOUT。

我们的 sub`parseExpression`将在操作符处拆分表达式字符串。变量名将被替换。然后这些操作严格地右关联地执行。虽然这使得解析更容易，但这并不完全自然：`3*4+1`评估为`15`. 我们使用递归是因为我更喜欢它而不是迭代能够解决多个操作：

```
sub parseExpression {
  my ($string) = @_;
  my ($part, $operator, $rest) = ($string =~ /(\w+)([-+*\/^]?)(.*$)/g);
  if (not $operator) {
    # $part is the whole expression
    my $value = exists $variables{$part} ? $variables{$part} : $part;
    die if $value =~ /[a-z]/i; # The variable name was not substituted
    return $value;
  } else {
    my $rval = parseExpression($rest);
    my $lval = parseExpression($part); # you don't need this
                                       # if there are no variables on the left
    my $value = {
      '+' => sub {$_[0] +  $_[1]},
      '-' => sub {$_[0] -  $_[1]},
      '*' => sub {$_[0] *  $_[1]},
      '/' => sub {$_[0] /  $_[1]},
      '^' => sub {$_[0] ** $_[1]},
    }->{$operator}->($lval, $rval);
    return $value;
  }
} 
```

我们使用一个可爱的小调度表来为每个操作员执行适当的计算。您始终可以增强运算符正则表达式和表格以支持其他运算符。

请注意，当前的实现允许数字作为变量名。不是你可能想要的东西，但它让生活更轻松。

随机出现未定义的值可能会出现一些有趣的问题，但是这段代码应该会给你一个指向正确方向的指针。（如果您只允许第二列中的一个操作，则可以删除递归）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T10:59:09.547

这只需分两步执行替换即可。首先找到从文件`%values`派生的哈希中存在的所有关键字。`test2.txt`然后寻找由算术运算符连接的多个十进制数并评估表达式以形成替换。

查找哈希键的正则表达式是动态构建`join`的，用于连接使用正则表达式交替运算符`|`。

第二个正则表达式相当于

```
expression ::= digits, operator, digits, { operator, digits } 
```

并允许术语之间有空格

```
use strict;
use warnings;

my %values = do {
  open my $fh, '<', 'test2.txt' or die $!;
  local $/;
  <$fh> =~ /\w+/g;
};

my $regex = join '|', keys %values;

open my $fh, '<', 'test1.txt' or die $!;

while (<$fh>) {
  s/\b($regex)\b/$values{$1}/g;
  s|([0-9]+(\s*[-+*/]\s*[0-9]+)+)|$1|eeg;
  print;
} 
```

**输出**

```
porsche  460 blue
ferrari  570 red
buggati  1101 black
fiat     30 white 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T01:33:42.890

我根本不会用 perl 编码，但我想我可能只是提供一些整体提示......

首先，为了保持简单，您必须在某种程度上承诺使用有限的模式格式，否则正如评论中所建议的，这将成为语言解析器。所以你可能不得不说 test1.txt 中的一行可能包含也可能不包含`[numbers][operator][characters]`模式。

所以我可能建议将 test2.txt 解析为关联数组（哈希），这样你就有了类似的东西：

```
{
    "turbo"        =>  30,
    "supercharged" =>  50,
    "supersport"   => 100,
} 
```

然后对于 test1.txt 中的每一行，您可以对以下模式执行正则表达式匹配：
`\b((\d+)([+])(\w+))\b`

从此模式中，您可以检查`+`运算符和密钥。如果你得到它们，你可以在你的散列中查找键，并在`parsed number, operator, hash[key] => value`

如果您只想处理 a `+`，那么您可以简单地将数字转换为`int`并添加它们。否则，要支持多个运算符模式，您将不得不显式处理它们或**安全地**评估字符串。

您可以在第一个主要捕获组上进行正则表达式替换

# git-reset - 重置后Git获取最新提交-hard

> ID：12169651
> 
> 赞同：4
> 
> 时间：2012-08-29T01:15:54.757
> 
> 标签：git-reset

我之前做了一个 git reset -hard FETCH_HEAD ，但我不知道要回到我最近的提交。

```
HEAD@{0}: checkout: moving from master to adding_events
HEAD@{1}: checkout: moving from adding_events to master
HEAD@{2}: checkout: moving from master to adding_events
HEAD@{3}: checkout: moving from 3458u9qfhaushf
HEAD@{4}: commit: Testing Gemfile edit
HEAD@{5}: checkout: moving from master to fajesnfkj24b
HEAD@{6}: commit: Changed Gemfile after reset
HEAD@{7}: reset: moving to FETCH_HEAD
HEAD@{8}: commit: Added Event Show page, Upload Event Pic
HEAD@{9}: commit: Add Category Database and Event pages
HEAD@{10}: merge adding_events: Fast-forward
HEAD@{11}: checkout: moving from adding_events to master
HEAD@{12}: commit: Replaced Post with Events 
```

当我在我的主分支上执行 git status 时，这就是出现的情况

```
Your branch and 'origin/master' have diverged,
and have 1 and 5 different commits each, respectively. 
```

当我在我的目录中打开应用程序时，12 次提交“用事件替换帖子”是显示的最新文件。我想回到我上次提交的 8 个“添加了活动显示页面，上传活动图片”......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:18:43.687

你可以做：

```
git reset --hard HEAD@{8} 
```

将当前分支指针重置为该特定提交。

# ruby - 如何检查控制器响应是否有链接？

> ID：12169656
> 
> 赞同：0
> 
> 时间：2012-08-29T01:16:34.890
> 
> 标签：ruby, rspec, rspec2, rspec-rails

什么是体面的做法？最好匹配一个正则表达式。

我当前的代码是这样的：

```
describe "get #show" do
  context "signed in" do
    it "should have a link to edit profile" do
      # i sign in the user
      get :show
      response # i don't know what to do here
    end
  end
end 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:23:56.197

似乎您正在尝试进行[验收测试](http://en.wikipedia.org/wiki/Acceptance_testing)，这可能意味着您应该遵从[Capybara](https://github.com/jnicklas/capybara)。然后你可以做魔术

`page.should have_css('edit_link', text: 'Edit me')`

# css - mod RewriteRule 重定向 css 请求以缩小？

> ID：12169661
> 
> 赞同：0
> 
> 时间：2012-08-29T01:17:14.007
> 
> 标签：css, mod-rewrite, minify

我正在尝试将调用的主样式表的所有请求重定向`styles.css`到 minify 脚本，`min/g=css`以便我可以实时处理 CSS 文件并让服务器使用重定向到 minify 脚本。

基本上，这在我的html文件中......

```
<link rel="stylesheet" href="css/styles.css" type="text/css"> 
```

变成了这个

```
<link rel="stylesheet" href="min/g=css" type="text/css"> 
```

当服务器请求它时。

到目前为止，这是我的尝试，但它似乎根本不起作用。常规的 css 文件只是在服务器上加载..

```
RewriteRule ^css/styles\.css$ min/g=css 
```

同样，我也担心何时开始构建子目录页面。这个重写规则是否需要是“绝对路径”？感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T07:39:26.963

> 同样，我也担心何时开始构建子目录页面。这个重写规则是否需要是“绝对路径”？感谢大家的帮助！

在 htaccess 文件中应用规则时，重写引擎会去除 URI 的前导斜杠，但如果规则在 server/vhost 配置中，则需要前导斜杠。目标（`min/g=css`您的规则的一部分）也不需要是绝对路径，但如果有前导斜杠，apache 会将其应用于基础（通常是文档根目录）。如果没有前导斜杠，apache 会尝试猜测您是指文件路径还是 URI 路径，有时它会猜错。如果您包含一个`RewriteBase`指令，那么 apache 将始终使用它作为它的基础。

所以这里的问题真的变成了：你在哪里有这些规则？在 htaccess 文件中，您只剩下基础问题。如果它在服务器/虚拟主机配置中，您需要知道基础以及在正则表达式中添加前导斜杠：`^/css/styles\.css$`。或者您可以安全并使其成为可选：`^/?css/styles\.css$`

现在，基地。基础是附加相对路径的地方。你的css链接是这个`css/styles.css`。如果该页面是从这个 URL: 加载的`http://domain.com/some/path/mypage.html`，那么**基础**是`http://domain.com/some/path`. 相对路径的分辨率为`http://domain.com/some/path/css/styles.css`. 在此示例中，您的规则需要进入`/some/path`指向的目录，并且您需要：

```
RewriteBase /some/path/ 
```

高于你的规则。否则，您可以简单地将该基础附加到规则的正则表达式和目标：

```
RewriteRule ^/?some/path/css/style\.css$ /some/path/min/g=css [L] 
```

# java - 我将如何禁用文本框？

> ID：12169662
> 
> 赞同：1
> 
> 时间：2012-08-29T01:17:22.000
> 
> 标签：java, swing, textbox

所以我正在做一个项目，我试图从程序中禁用框架和字段，以便只有窗口在前面，这个是活动的，这是我的代码：

```
 import javax.swing.*;
 import java.awt.event.*;
 import java.awt.*;

public class password
{
  private static String password = "pass";
  public static void main(String[]args) {
    JFrame frame = new JFrame("Password");
    frame.setVisible(true);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(400,100);
    JLabel label = new JLabel("Enter password");
    JPanel panel = new JPanel();
    frame.add(panel);
    JPasswordField pass = new JPasswordField(10);
    pass.setEchoChar('*');
    pass.addActionListener(new AL());
    panel.add(label, BorderLayout.WEST);
    panel.add(pass, BorderLayout.WEST);
}
static class AL implements ActionListener
{
    public void actionPerformed(ActionEvent e) {
        JPasswordField input = (JPasswordField) e.getSource();
        char [] passy = input.getPassword();
        String p = new String(passy);
        if (p.equals(password)){
            JOptionPane.showMessageDialog(null, "Correct");
            System.out.print("Welcome to Adam's Quirky program.");

        }
        else
            JOptionPane.showMessageDialog(null, "Incorrect");
       }
    }
 } 
```

我目前用来编程的程序是 Eclipse。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:22:20.500

我会看一下模态对话框。

使用 a`JOptionPane`或自己滚动。

如果这些不适合您的需求，请尝试查看[JLayer](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html) (Java 7) 或[JXLayer](http://java.net/projects/jxlayer/) (Java 6 及更低版本)

看看[LockableUI](http://weblogs.java.net/blog/alexfromsun/archive/2008/07/jxlayer_30_lock.html)（有点过时了，但基本思路是一样的）

如果这不吸引人，您可以使用“阻挡玻璃窗格”

看一眼

*   [glassPane 没有阻止输入](https://stackoverflow.com/questions/5761472/glasspane-is-not-blocking-input)
*   [这个阻塞 GlassPane 有问题吗？](https://stackoverflow.com/questions/2413102/is-there-a-problem-with-this-blocking-glasspane)

作为一些例子

# javascript - 正则表达式从 html 格式的字符串中提取文本

> ID：12169663
> 
> 赞同：3
> 
> 时间：2012-08-29T01:17:53.427
> 
> 标签：javascript, regex

我目前收到 html 格式的响应错误。它是字符串类型。

```
"<!DOCTYPE html>\r\n
<html>
  <head>
    <title>Data already exists</title>
  </head>
</html>" 
```

我想检索里面的内容`<title>`，例如上面的“数据已经存在”。任何人都可以建议一个适当的正则表达式来捕获该文本。

请任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T01:19:59.707

首先，您可以在没有正则表达式的情况下通过创建一个虚拟元素来注入 HTML：

```
var s = "your_html_string";
var dummy = document.createElement("div");
dummy.innerHTML = s;
var title = dummy.getElementsByTagName("title")[0].innerText; 
```

[但是如果你真的坚持使用正则表达式：]

```
var s = "your_html_string";
var title = s.match(/<title>([^<]+)<\/title>/)[1]; 
```

这是一个[**演示**](http://jsfiddle.net/9eWXs/)这两种方法的演示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T01:25:41.277

在正则表达式中解析 html 标签的基础是这样的。[http://jsbin.com/oqivup/1/edit](http://jsbin.com/oqivup/1/edit)

```
var text = /<(title)>(.+)<\/\1>/.exec(html).pop(); 
```

但是对于更复杂的东西，我会考虑使用适当的解析器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T01:27:12.260

您可以使用以下方法解析它`DOMParser()`：

```
var parser=new DOMParser(),
    doc=parser.parseFromString("<!DOCTYPE html><html><head><title>Data already exists</title></head></html>","text/html");

doc.title; /* "Data already exists" */ 
```

# emacs - org-mode 使用当前颜色主题发布

> ID：12169667
> 
> 赞同：10
> 
> 时间：2012-08-29T01:18:06.077
> 
> 标签：emacs, org-mode

Org-mode 有一个很棒的功能，可以为源代码块中的文本着色。但是，它使用 emacs 主题的当前颜色。我经常使用深色 zenburn 主题，它将 Java 的某些部分置于浅色中。当我发布到 HTML 时，浅色不可读。解决方法是重新启动 emacs 并重新发布而不加载它们。

有更好的办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-07-13T09:59:15.150

默认情况下，org-mode 会根据您当前的主题导出带有内联样式信息的源代码。但是，通过设置`org-html-htmlize-output-type`而`'css`不是默认值`'inline-css`，生成的 html 将具有与所使用的面相对应的类。然后，您可以提供自己的 css 来设置面的样式。

例如，导出一个带有`org-html-htmlize-output-type`set to的片段会`'inline-css`给出以下内容：

```
<pre class="src src-sh">
<span style="color: #F0DFAF; font-weight: bold;">for</span> f<span style="color: #F0DFAF; font-weight: bold;"> in</span> *; <span style="color: #F0DFAF; font-weight: bold;">do</span>
    <span style="color: #93E0E3;">echo</span> $<span style="color: #DFAF8F;">f</span>
<span style="color: #F0DFAF; font-weight: bold;">done</span>
</pre> 
```

`org-html-htmlize-output-type`使用set to导出相同的代码段时`'css`：

```
<pre class="src src-sh">
<span class="org-keyword">for</span> f<span class="org-keyword"> in</span> *; <span class="org-keyword">do</span>
    <span class="org-builtin">echo</span> $<span class="org-variable-name">f</span>
<span class="org-keyword">done</span>
</pre> 
```

# .net - 如何使用 IIS 向 Web 公开 WCF 服务

> ID：12169668
> 
> 赞同：0
> 
> 时间：2012-08-29T01:18:27.607
> 
> 标签：.net, wcf, iis

我正在使用 WCF 服务，我想知道如何使用 IIS 将我的 WCF 服务公开到 Web。

我的操作系统是 Windows 7 Home Premium 64 位我有 IIS 7

现在我可以通过我的本地网络 (192.168...) 使用我的 Web 服务，但是如果我写下我的 ip 地址\MyApp\MyService，我就无法访问我的服务页面。我可以访问我的路由器配置页面，但不能访问我的服务。

我还尝试在 Visual Studio 中添加“服务引用”，但它无法访问该服务。

我不确定我是否提供了足够的信息，所以如果您需要更多信息，请询问我。

# php - Facebook api命令？

> ID：12169672
> 
> 赞同：-1
> 
> 时间：2012-08-29T01:19:33.190
> 
> 标签：php, facebook, api, login

目前我有

```
 $user_profile = $facebook->api('/me'); 
```

这会显示如下信息：

```
 [id] => 525252252
    [name] => random name
    [first_name] => random
    [last_name] => name
    [link] => http://www.facebook.com/random.name
    [username] => random.name 
```

什么是仅显示这些字段之一的 api 命令。例如，如果我只想输出 [name] 字段而不是所有其他字段？

我已经在互联网上搜索了一段时间，但似乎无法找到它。不知道我是否在寻找正确的东西。

有关信息，我将使用 php 回显/打印输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:46:57.250

我认为您只是在寻找，`echo $user_profile['name']`但我可能会误解这个问题 - 结果集的访问方式与 PHP 中的任何多维数组相同

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T03:55:36.290

是的。只需使用这个：

```
$user_profile = $facebook->api('/me');
echo $user_profile['name']; 
```

那应该工作..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T04:01:12.207

```
$user_profile = $facebook->api('/me?fields=name'); 
```

如果您需要的只是`name`字段 - 只请求它是有意义的。之后，您将获得`$user_profile`只有 2 个项目的数组 -`id`和`name`

# python - 从 heroku 控制台连接到 MongoHQ (heroku run python)

> ID：12169673
> 
> 赞同：1
> 
> 时间：2012-08-29T01:19:39.930
> 
> 标签：python, mongodb, heroku, mongoengine, mongohq

尝试通过 heroku 上的 python 控制台与 MongoHQ 数据库交互时出现“需要登录”错误：

```
...
File "/app/.heroku/venv/lib/python2.7/site-packages/pymongo/helpers.py", line 128, in _check_command_response
    raise OperationFailure(msg % response["errmsg"])
pymongo.errors.OperationFailure: command SON([('listDatabases', 1)]) failed: need to login 
```

### 我的适用代码

应用程序/**初始化**.py：

```
from mongoengine import connect
import settings

db = connect(settings.DB, host=settings.DB_HOST, port=settings.DB_PORT, username=settings.DB_USER, password=settings.DB_PASS) 
```

应用程序/settings.py：

```
if 'MONGOHQ_URL' in os.environ:
url = urlparse(os.environ['MONGOHQ_URL'])
DB = url.path[1:]
DB_HOST = url.hostname
DB_PORT = url.port
DB_USER = url.username
DB_PASS = url.password 
```

os.environ['MONGOHQ_URL'] 看起来像：

```
'mongodb://[username]:[password]@[host]:[port]/[db-name]' 
```

此代码在本地和从 Heroku Web 服务器都有效（连接并可以读取和写入 mongodb）。

根据文档（http://www.mongodb.org/display/DOCS/Connections），只要将用户名和密码参数传递给 Connection 或可解析，它就应该尝试“登录”连接到服务器从 URI。我想不出一种方法来查看是否正在尝试登录并默默地失败。

我尝试绕过 mongoengine 并使用 pymongo.Connection 并得到相同的结果。我尝试了使用 Connection 方法的所有几种模式。我创建了一个新的数据库用户，与 mongoHQ 为 heroku 的生产访问创建的一个不同 -> 相同。

这是一个烧瓶应用程序，但我认为没有任何应用程序代码被触及。

### 更新

我找到了解决方案，但它会引起一些头痛。我可以通过手动连接到数据库

```
conn = connect(settings.DB, host=settings.DB_HOST, port=settings.DB_PORT, username=settings.DB_USER, password=settings.DB_PASS)
db = conn[settings.DB]
db.authenticate(settings.DB_USER, settings.DB_PASS) 
```

更新#2

Mongolab 开箱即用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T13:11:33.590

请使用 URI 方法连接并通过`host`kwarg 传递信息，例如：

```
connect("testdb_uri", host='mongodb://username:password@localhost/mongoenginetest') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:02:34.333

MongoHQ 插件使用密码哈希而不是实际密码，这可能是错误。

`MONGOHQ_URL`您应该使用以下命令将环境变量更改为真实密码：

`heroku config:set MONGOHQ_URL=mongodb://...`

设置后，您可以重新启动应用程序 ( `heroku apps`)，以便获取更改。如果您在失败的应用程序的目录中，`config:set`配置 var 将重新启动应用程序。

# boost - 提升库序列化不起作用

> ID：12169677
> 
> 赞同：0
> 
> 时间：2012-08-29T01:20:04.997
> 
> 标签：boost

我使用 macports 下载和安装 boost lib 没有任何问题。

我尝试从他们的网站运行代码并得到以下小说：

c++ -c -o Main.o Main.cpp

正在编译...

```
g++  -o VectorSjov Main.o utunity/math/vector/Vec2d.cpp
Undefined symbols for architecture x86_64:
  "boost::serialization::void_upcast(boost::serialization::extended_type_info const&, boost::serialization::extended_type_info const&, void const*)", referenced from:
      bus_stop* boost::archive::detail::load_pointer_type<boost::archive::text_iarchive>::pointer_tweak<bus_stop>(boost::serialization::extended_type_info const&, void const*, bus_stop const&)in Main.o
      bus_route* boost::archive::detail::load_pointer_type<boost::archive::text_iarchive>::pointer_tweak<bus_route>(boost::serialization::extended_type_info const&, void const*, bus_route const&)in Main.o
  "boost::serialization::typeid_system::extended_type_info_typeid_0::type_register(std::type_info const&)", referenced from:
      boost::serialization::extended_type_info_typeid<std::list<bus_stop*, std::allocator<bus_stop*> > >::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_destination>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<gps_position>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_corner>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_route>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_schedule::trip_info>::extended_type_info_typeid()in Main.o
      ...
  "boost::serialization::typeid_system::extended_type_info_typeid_0::type_unregister()", referenced from:
      boost::serialization::extended_type_info_typeid<std::list<bus_stop*, std::allocator<bus_stop*> > >::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_destination>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<gps_position>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_corner>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_route>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_schedule::trip_info>::~extended_type_info_typeid()in Main.o
      ...
  "boost::serialization::typeid_system::extended_type_info_typeid_0::extended_type_info_typeid_0(char const*)", referenced from:
      boost::serialization::extended_type_info_typeid<std::list<bus_stop*, std::allocator<bus_stop*> > >::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_destination>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<gps_position>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_corner>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_route>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_schedule::trip_info>::extended_type_info_typeid()in Main.o
      ...
  "boost::serialization::typeid_system::extended_type_info_typeid_0::~extended_type_info_typeid_0()", referenced from:
      boost::serialization::extended_type_info_typeid<std::list<bus_stop*, std::allocator<bus_stop*> > >::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<std::list<bus_stop*, std::allocator<bus_stop*> > >::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_destination>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop_destination>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<gps_position>::~extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<gps_position>::extended_type_info_typeid()in Main.o
      boost::serialization::extended_type_info_typeid<bus_stop>::~extended_type_info_typeid()in Main.o
      ...
  "boost::serialization::void_downcast(boost::serialization::extended_type_info const&, boost::serialization::extended_type_info const&, void const*)", referenced from:
      void boost::archive::detail::save_pointer_type<boost::archive::text_oarchive>::polymorphic::save<bus_stop>(boost::archive::text_oarchive&, bus_stop&)in Main.o
  "boost::archive::archive_exception::archive_exception(boost::archive::archive_exception::exception_code, char const*, char const*)", referenced from:
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<unsigned int>(unsigned int&)in Main.o
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<boost::serialization::collection_size_type>(boost::serialization::collection_size_type&)in Main.o
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<float>(float&)in Main.o
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<int>(int&)in Main.o
      void boost::archive::detail::save_pointer_type<boost::archive::text_oarchive>::polymorphic::save<bus_stop>(boost::archive::text_oarchive&, bus_stop&)in Main.o
      void boost::archive::basic_text_oprimitive<std::basic_ostream<char, std::char_traits<char> > >::save<unsigned int>(unsigned int const&)in Main.o
      void boost::archive::basic_text_oprimitive<std::basic_ostream<char, std::char_traits<char> > >::save<boost::serialization::collection_size_type>(boost::serialization::collection_size_type const&)in Main.o
      ...
  "boost::archive::archive_exception::~archive_exception()", referenced from:
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<unsigned int>(unsigned int&)in Main.o
      void boost::serialization::throw_exception<boost::archive::archive_exception>(boost::archive::archive_exception const&)in Main.o
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<boost::serialization::collection_size_type>(boost::serialization::collection_size_type&)in Main.o
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<float>(float&)in Main.o
      void boost::archive::basic_text_iprimitive<std::basic_istream<char, std::char_traits<char> > >::load<int>(int&)in Main.o
      void boost::archive::detail::save_pointer_type<boost::archive::text_oarchive>::polymorphic::save<bus_stop>(boost::archive::text_oarchive&, bus_stop&)in Main.o
      void boost::archive::basic_text_oprimitive<std::basic_ostream<char, std::char_traits<char> > >::save<unsigned int>(unsigned int const&)in Main.o
      ...
  "boost::archive::text_iarchive_impl<boost::archive::text_iarchive>::load_override(boost::archive::class_name_type&, int)", referenced from:
      boost::archive::text_iarchive& boost::archive::detail::interface_iarchive<boost::archive::text_iarchive>::operator>><boost::archive::class_name_type>(boost::archive::class_name_type&)in Main.o
  "boost::archive::text_iarchive_impl<boost::archive::text_iarchive>::load(std::basic_string<char, std::char_traits<char>, std::allocator<char> >&)", referenced from:
      void boost::archive::load_access::load_primitive<boost::archive::text_iarchive, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >(boost::archive::text_iarchive&, std::basic_string<char, std::char_traits<char>, std::allocator<char> >&)in Main.o
  "boost::archive::text_iarchive_impl<boost::archive::text_iarchive>::text_iarchive_impl(std::basic_istream<char, std::char_traits<char> >&, unsigned int)", referenced from:
      boost::archive::text_iarchive::text_iarchive(std::basic_istream<char, std::char_traits<char> >&, unsigned int)in Main.o
  "boost::archive::text_oarchive_impl<boost::archive::text_oarchive>::save(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)", referenced from:
      void boost::archive::save_access::save_primitive<boost::archive::text_oarchive, std::basic_string<char, std::char_traits<char>, std::allocator<char> > >(boost::archive::text_oarchive&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)in Main.o
  ....

bus_stop_corner>in Main.o
      typeinfo for boost::archive::detail::oserializer<boost::archive::text_oarchive, bus_route>in Main.o
      typeinfo for boost::archive::detail::oserializer<boost::archive::text_oarchive, bus_schedule::trip_info>in Main.o
      ...
  "typeinfo for boost::archive::detail::basic_pointer_iserializer", referenced from:
      typeinfo for boost::archive::detail::pointer_iserializer<boost::archive::text_iarchive, bus_route>in Main.o
      typeinfo for boost::archive::detail::pointer_iserializer<boost::archive::text_iarchive, bus_stop_destination>in Main.o
      typeinfo for boost::archive::detail::pointer_iserializer<boost::archive::text_iarchive, bus_stop_corner>in Main.o
  "typeinfo for boost::archive::detail::basic_pointer_oserializer", referenced from:
      typeinfo for boost::archive::detail::pointer_oserializer<boost::archive::text_oarchive, bus_route>in Main.o
      typeinfo for boost::archive::detail::pointer_oserializer<boost::archive::text_oarchive, bus_stop_destination>in Main.o
      typeinfo for boost::archive::detail::pointer_oserializer<boost::archive::text_oarchive, bus_stop_corner>in Main.o
  "vtable for boost::archive::archive_exception", referenced from:
      boost::archive::archive_exception::archive_exception(boost::archive::archive_exception const&)in Main.o
  NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status
make: *** [VectorSjov] Error 1
[Finished in 3.1s with exit code 2] 
```

严重地？:D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T19:54:26.423

不要忘记链接以增强序列化，它不是仅标题库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T07:31:39.060

```
> Undefined symbols for architecture x86_64 
```

尝试使用不同的选项进行编译：-m32 或 -m64

# android - 基于微调器 OnItemSelectedListener 在 MainActivity 上启用按钮

> ID：12169678
> 
> 赞同：0
> 
> 时间：2012-08-29T01:20:12.497
> 
> 标签：android, android-spinner

我对 android 开发非常陌生，这基本上是我的第一个应用程序。

我按照 developer.android.com 上的指南和互联网上的其他资源来使用微调器。

在我的主要活动中，我有一个微调器和一个按钮，我想做的是根据微调器所选项目启用（setClickable）按钮。

```
public class MainMenu extends Activity {    

private Spinner spinner1;   

@Override
public void onCreate(Bundle savedInstanceState) {       
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_menu);              

    //Add items to spinner 1 dynamically
    addItemsOnSpinner1();    
    addListenertoSpinner();        
}          

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main_menu, menu);
    return true;
}

public void addItemsOnSpinner1(){
    spinner1 = (Spinner) findViewById(R.id.spinner1);
    List<String> list = new ArrayList<String>();
    list.add("Test 1");
    list.add("Test 2");
    list.add("Add new");
    ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item,list);
    dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_item);
    spinner1.setAdapter(dataAdapter);       
}

public void addListenertoSpinner(){
    spinner1 = (Spinner) findViewById(R.id.spinner1);
    spinner1.setOnItemSelectedListener(new CustomOnItemSelectedListener());    
}           

} 
```

我已经成功创建了一个 OnItemSelectedListener 类，我可以从中显示微调器选定的项目文本：

```
public class CustomOnItemSelectedListener extends Activity implements OnItemSelectedListener {

public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
    // TODO Auto-generated method stub              
    if(parent.getItemAtPosition(pos).toString()== "Add new"){
        Toast.makeText(parent.getContext(), 
                "OnItemSelectedListener : " + parent.getItemAtPosition(pos).toString(),
                Toast.LENGTH_SHORT).show();         
    }

}

public void onNothingSelected(AdapterView<?> arg0) {
    // TODO Auto-generated method stub

}
} 
```

我的问题是：

如何设置 Button.setClickable？我尝试做类似的事情：

```
if(parent.getItemAtPosition(pos).toString()== "Add new"){
        Button b1 = (Button)findViewById(R.id.button1);
        b1.setClickable(true);                                  
    } 
```

但应用程序崩溃...

提前干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:16:50.387

你不应该仅仅为了一个听众而从活动中扩展。尝试这个

```
public void addListenertoSpinner(){
    spinner1 = (Spinner) findViewById(R.id.spinner1);
    spinner1.setOnItemSelectedListener(new OnItemSelectedListener() {
        public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {
            if(parent.getItemAtPosition(pos).toString()== "Add new"){
                Button b1 = (Button)findViewById(R.id.button1);
                b1.setClickable(true);                                  
            }

        }

        public void onNothingSelected(AdapterView<?> arg0) {

        }
    });    
} 
```

这将创建一个匿名类（在 CURRENT 活动的概念内），可以安全地使用`findViewById()`.

# objective-c - 处理删除多个数组中的对象的最佳方法是什么？

> ID：12169684
> 
> 赞同：2
> 
> 时间：2012-08-29T01:20:54.120
> 
> 标签：objective-c

我有一个类可以生成一堆随机类型的对象并将它们（以及对它们的引用）存储在一个数组中。在执行此操作时，它还将对它们的引用存储在特定于其类型的数组中。

稍后，每个特定类型的数组都被迭代，其中的对象的 x 位置递减。在该循环中，如果它们在屏幕上，它们将被添加到另一个可见对象数组中。一旦它们离开屏幕，它们就会从该可见对象阵列中移除。

我的游戏规则是：对象只有在可见时才能被销毁。因此，当尝试销毁对象时，它会搜索可见对象数组并尝试定位该对象，如果找到则将其删除。

问题是，一旦从“可见数组”中删除了对象，“类型特定”数组将继续循环，所有这些对象的 x 位置都会递减——即使一个对象可能不再出现在屏幕上.

我想知道删除对对象的所有引用的最佳方法是什么？我犹豫要不要遍历所有数组并在它们上调用“removeObjectIdenticalTo”......我最初的解决方案是向我的对象“销毁”添加一个 BOOL 属性，如果它在屏幕上被销毁，则将其设置为 YES，并且然后让我的 x 递减循环跳过已被破坏的对象......但我开始想知道这是否不是内存管理的最佳方法，因为该对象的停留时间超过了它需要的时间......

应该如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:26:15.643

如果您从将所有对象存储在字典中开始，这可能会起作用。之后，向对象（正在传递的）添加一个属性，该属性包含一个与它所在数组的字典键相同的 NSString。

那么你所要做的就是：

```
NSMutable *array = [dicionary objectForKey:object.dictionaryKeyString];
//then remove the object from *array 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:28:20.237

> 我犹豫要不要遍历所有数组并在它们上调用“removeObjectIdenticalTo”

为什么？是因为你认为这是低效的吗？你怎么知道的？

然而，为了真正的效率，假设对象都是不同的对象，使用 NSSet，而不是 NSArray。保证对特定对象的访问是有效的。

# android - 如何在 ListView 页脚中垂直居中内容？

> ID：12169690
> 
> 赞同：0
> 
> 时间：2012-08-29T01:22:05.480
> 
> 标签：android, android-layout

我已经在下面发布了确切的布局。我想在页脚内垂直居中显示图像和文本。我已经申请：

```
 android:gravity="center_vertical|center" 
```

对于包含这些元素的 LinearLayout 和内部的 TextView，但整行图像和文本看起来离​​页脚顶部太远了。我希望它垂直居中，但它始终位于页脚的前 30%。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

<TextView
    android:id="@+id/someMessageMessage"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
     android:visibility="gone"        
     android:layout_margin="10dip"/>

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:gravity="center_vertical|center"
    android:paddingBottom="2dip"
    android:paddingTop="16dip" >

    <ImageView
        android:id="@+id/myImg"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="16dip"
        android:paddingTop="3dip"
        android:src="@drawable/picimg" >
    </ImageView>

    <TextView
        android:id="@+id/myMessage"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="10dip"
        android:layout_marginRight="10dip"
        android:gravity="center_vertical|center"
        android:text="This message appears way to close to the top of the footer. It should be along with the image in the center:"
        android:textStyle="bold"/>
</LinearLayout>

<Button
    android:id="@+id/myButton"
    style="@style/mybuttonstyle"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_margin="10dip"
    android:text="@string/lbl_send"
    android:visibility="gone" />
 </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:09:23.803

图片有多大？我认为问题出在你的第二个`LinearLayout`。您将高度设置为“wrap_content”，这意味着它只会与最大的孩子一样大。如果图像和文本的高度大致相同，那么似乎任何东西都不会居中。你可以通过强制高度足够大来测试这个理论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:29:14.323

看到您的布局后，您似乎没有将 android:paddingTop 提供给您的 TextView。这就是为什么它出现在顶部。此外，如果适合您的布局，您还可以从 ImageView 中删除 android:paddingTop 。希望有帮助。

# php - 如果有问号，如何检查第一部分

> ID：12169691
> 
> 赞同：0
> 
> 时间：2012-08-29T01:22:17.570
> 
> 标签：php, cakephp-2.0

我有这样的数据库值

```
123456789
826438758
?emailaddress1@test.com
?emailaddress2@test2.com 
```

我正在动态获取值，但我需要能够找出是否存在？在价值。如果值中有问号，我想将它们重定向到其他地方

我认为我们可以用正则表达式做到这一点，但不知道如何

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T01:23:57.073

```
if (strpos($string, '?') === 0) {
  //redirect
  header("Location: http://www.example.com");
} 
```

[http://php.net/manual/en/function.strpos.php](http://php.net/manual/en/function.strpos.php)

很重要，`===`因为它会`false`在没有问号时返回，并且`false == 0`是真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:33:10.503

我只是使用字符串索引

```
if ($string[0] === '?') {
  echo 'header("Location: http://www.example.com");';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T01:24:04.013

```
<?

if (preg_match('#^\?#', $str)) {
    header('Location: http://google.com');
} 
```

# c - 是否可以将指针和数组作为函数参数传递？

> ID：12169709
> 
> 赞同：0
> 
> 时间：2012-08-29T01:25:10.950
> 
> 标签：c, arrays, function, pointers, parameters

我在运行时创建了两个整数数组（大小取决于程序输入）。在某些时候，我需要用另一个做一些计算的内容来更新一个数组的内容。

首先，我考虑将这些数组作为参数传递给函数，因为我没有找到在 C 中返回函数的方法（不认为这是可能的）。在意识到这是一个坏主意后，因为参数在被复制到堆栈时无法真正修改，所以我改用数组指针。

虽然该函数仍然是空的，但这是我拥有的代码：

第一次拍摄（代码编译，没有错误）：

```
// Elements is just to be able to iterate through their contents (same for both):
void do_stuff(int first[], int second[], int elements) {}

// Call to the function:
do_stuff(first, second, elements); 
```

第二次，尝试转换为能够修改数组的指针：

```
void do_stuff(int *first[], int *second[], int elements) {}

// Call to the function:
do_stuff(&first, &second, elements); 
```

这段代码导致了一些正当的编译时错误，因为显然我认为指向数组的指针是指针数组。

第三次，我认为这是正确的语法：

```
void do_stuff(int (*first)[], int (*second)[], int elements) {}

// Call to the function:
do_stuff(&first, &second, elements); 
```

当尝试访问数组的元素（例如`*first[0]`）时，此代码仍然会产生编译时错误：

```
error: invalid use of array with unspecified bounds 
```

所以我的问题是关于使用数组指针作为函数参数的可能性，这可能吗？如果是这样，怎么可能做到？

无论如何，如果您在执行涉及第二个内容的计算后想到更新第一个数组的更好方法，请对此发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:27:42.357

数组衰减为指向为数组分配的数据的指针。数组在传递给函数时不会复制到堆栈中。因此，您不需要将指针传递给数组。所以，下面应该可以正常工作。

> ```
> // Elements is just to be able to iterate through their contents (same for both):
> void do_stuff(int first[], int second[], int elements) {}
> 
> // Call to the function:
> do_stuff(first, second, elements); 
> ```

您第二次尝试时出错的原因是因为`int *first[]`（以及其他喜欢它的人）实际上是*指向 int 的指针数组*类型。

你的*第三个*错误的原因是因为`*first[N]`is 实际上`*(first[N])`，这不能轻易完成。数组访问实际上是指针算术的门面，`*(first + sizeof first[0] * N)`; 但是，这里的元素类型不完整——需要指定数组的大小，否则`sizeof first[0]`未知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:28:35.400

你的第一次尝试是正确的。在 C 中将数组作为参数传递时，实际上传递的是指向第一个元素的指针，而不是数组的副本。所以你可以写

```
void do_stuff(int first[], int second[], int elements) {} 
```

像你一样，或者

```
void do_stuff(int *first, int *second, int elements) {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T01:31:08.567

在 C 中，数组会自动衰减为指向数据的指针，因此，您只需传递数组及其长度即可获得所需的结果。

我的建议是这样的：

```
void dostuff(int *first, int firstlen, int *second, int secondlen, int elements) 
```

函数调用应该是：

```
 do_stuff(first, firstlen, second, secondlen, elements); 
```

我不是很清楚你的问题，为什么你需要`elements`. 但是，您必须传递数组长度，因为数组在传递给函数时会自动衰减为指针，但是，在被调用的函数中，无法确定它们的大小。

# macos - mac bash上文件的格式化修改日期/时间？

> ID：12169710
> 
> 赞同：19
> 
> 时间：2012-08-29T01:25:12.467
> 
> 标签：macos, bash, datetime, bsd, last-modified

在我在 mac（雪豹）上的 bash 脚本中，我有一个路径和文件名，我需要获取该文件的修改日期/时间。我发现我可以这样做：
`stat -f "%m" $MYFILE`

但是，这会返回我假设的纪元日期/时间。我需要格式化的日期/时间：`YYYYMMDDThhmmss`. 我发现`date`了显然依赖于 GNU 的各种选项（如 ），而我的 Mac 上没有这些选项。

在mac（BSD？）bash上以用户指定的格式修改文件日期/时间的标准方法是什么。或者至少是一个日期/时间格式化函数，我可以将`stat`上面的调用结果传递给它。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-29T02:54:23.740

它实际上非常简单，但与 GNU 的不同`date`之处在于它远非显而易见：

```
date -r $TIMESTAMP +%Y%m%dT%H%M%S 
```

要`stat`进行格式化：

```
stat -f "%Sm" -t "%Y%m%dT%H%M%S" FILE 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-03-29T06:17:20.620

```
# how-to list all the files and dir in a dir sorted by their
# modified time in the different shells 
# usually mac os / Unix / FreeBSD stat 
stat -f "%Sm %N" -t "%Y-%m-%d %H:%M:%S" ~/opt/comp/proj/*|sort 

# STDOUT output:
# 2018-03-27 15:41:13 ~/opt/comp/proj/foo
# 2018-03-28 14:04:11 ~/opt/comp/proj/bar

# GNU Utils ( usually on Linux ) stat 
# STDOUT output:
stat -c "%y %n" ~/opt/comp/proj/*|sort

# 2018-03-29 09:15:18.297435000 +0300 ~/opt/comp/proj/bar
# 2018-03-29 09:15:18.297435000 +0300 ~/opt/comp/proj/foo 
```

# jquery - 将按钮的单击事件绑定到 Droppable 的拖放功能

> ID：12169714
> 
> 赞同：2
> 
> 时间：2012-08-29T01:25:36.003
> 
> 标签：jquery, jquery-ui, button, click, jquery-ui-droppable

我在每个列表项中有一个带有超链接的列表。此列表不可排序，但可以拖放到 ID 为 #droppable 的 div 上。现在，如果我拖放任何列表项，则 droppable 中提供的功能将完美执行。到目前为止，一切都很好。我不想拖动列表项，而是想单击它来执行相同的可拖放功能，这样我就可以传递列表项的项，如果需要，还可以传递超链接 ID。但这不起作用。

这是我迄今为止尝试过的完整代码：（我有 jQuery 和 jQuery UI）

```
<ul id="my_list">
<li id="li1"><a href="#" id="a1">Link</a></li>
<li id="li2"><a href="#" id="a2">Link</a></li>
<li id="li3"><a href="#" id="a3">Link</a></li>
</ul>

<div id="droppable"></div>

$("#my_list li, #my_list li a").bind( "click", function(event, ui) {

        Drop(event, ui); //Doesnt work

        return false;
});

//I also tried the following, but doesnt work
$("#my_list li, #my_list li a").on( "click", function(event, ui) {

        Drop(event, ui); //Doesnt work

        return false;
});

$("#droppable").droppable({

        drop: function(event, ui) {

            Drop(event, ui);
        }       
}); 

function Drop(event, ui) {

    var draggableId = ui.draggable.attr("id");
    var droppableId = $(this).attr("id");
    alert(draggableId + draggableId); //This alert fires correctly when the droppable is dropped but not if the hyperlink in #my_list is clicked.

}; 
```

# javascript - <<在javascript中做了什么

> ID：12169717
> 
> 赞同：1
> 
> 时间：2012-08-29T01:25:48.520
> 
> 标签：javascript

> **可能重复：**
> [绝对初学者的位移指南？](https://stackoverflow.com/questions/141525/absolute-beginners-guide-to-bit-shifting)
> [什么是 JavaScript >>> 运算符以及如何使用它？](https://stackoverflow.com/questions/1822350/what-is-the-javascript-operator-and-how-do-you-use-it)

`<<`我在阅读一些代码时遇到了。

```
1<<1 //2
2<<1 //4
3<<1 //6
3<<2 //12 
```

*   这个叫什么？*   这是做什么的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:28:15.743

取自[这个答案](https://stackoverflow.com/a/141873/15055)：

* * *

## 左移 (<<)

整数作为一系列位存储在内存中。例如，存储为 32 位的数字 6`int`将是：

```
00000000 00000000 00000000 00000110 
```

将此位模式向左移动一个位置 ( `6 << 1`) 将产生数字 12：

```
00000000 00000000 00000000 00001100 
```

如您所见，数字向左移动了一个位置，而右边的最后一个数字用零填充。您可能还注意到，左移相当于乘以 2 的幂。所以`6 << 1`等价于`6 * 2`，并且`6 << 3`等价于`6 * 8`。一个好的优化编译器会尽可能用移位代替乘法。

### 非循环变速

请注意，这些*不是*循环班次。将此值向左移动一个位置 ( `3,758,096,384 << 1`)：

```
11100000 00000000 00000000 00000000 
```

结果为 3,221,225,472：

```
11000000 00000000 00000000 00000000 
```

“结束”移动的数字丢失了。它不会环绕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:27:23.087

这是[按位左移运算符](https://developer.mozilla.org/en-US/docs/Core_JavaScript_1.5_Reference/Operators/Bitwise_Operators?redirect=no)。

`a << b`会将位移`b`到 的二进制表示的左侧`a`。

# c# - 使用 Linq 展平/合并列表

> ID：12169718
> 
> 赞同：2
> 
> 时间：2012-08-29T01:25:59.007
> 
> 标签：c#, linq, linq-to-xml

假设我有一个 XML 文件：

```
<locations>
    <country name="Australia">
        <city>Brisbane</city>
        <city>Melbourne</city>
        <city>Sydney</city>
    </country>
    <country name="England">
        <city>Bristol</city>
        <city>London</city>
    </country>
    <country name="America">
        <city>New York</city>
        <city>Washington</city>
    </country>
</locations> 
```

**我希望它变平（这应该是最终结果）：**

```
Australia
Brisbane
Melbourne
Sydney
England
Bristol
London
America
New York
Washington 
```

我试过这个：

```
var query = XDocument.Load(@"test.xml").Descendants("country")
    .Select(s => new
    {
        Country = (string)s.Attribute("name"),
        Cities = s.Elements("city")
            .Select (x => new { City = (string)x })
    }); 
```

但这会返回一个嵌套列表`query`。像这样：

```
{ Australia, Cities { Brisbane, Melbourne, Sydney }},
{ England, Cities { Bristol, London }},
{ America, Cities { New York, Washington }} 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T01:50:11.507

[SelectMany](http://msdn.microsoft.com/en-us/library/bb534336.aspx)应该在这里解决问题。

```
var result = 
    XDocument.Load(@"test.xml")
    .Descendants("country")
    .SelectMany(e => 
        (new [] { (string)e.Attribute("name")})
        .Concat(
            e.Elements("city")
            .Select(c => c.Value)
        )
    )
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T02:02:05.550

这是一种使用查询语法的方法：

```
var query = from country in XDocument.Load(@"test.xml").Descendants("country")
            let countryName = new [] {(string)country.Attribute("name")}
            let cities = country.Elements("city").Select(x => (string)x)
            from place in countryName.Concat(cities)
            select place; 
```

# php - Code igniter 购物车加入并从多个表中选择

> ID：12169720
> 
> 赞同：0
> 
> 时间：2012-08-29T01:26:07.027
> 
> 标签：php, database, codeigniter, shopping-cart, multiple-tables

我正在学习代码点火器，目前正在尝试创建一个可在多个表上工作的购物车。我可以使它使用 1 个表工作，但是当我尝试 JOIN 方法时，它总是给出“产品不存在”。

我正在使用的模型是：

```
class Cart_model extends CI_Model {
function tvs(){
    $query = $this->db->get('tvs');
    return $query->result_array();
}
function computers(){
    $query = $this->db->get('computers');
    return $query->result_array();
}       
function laptops(){
    $query = $this->db->get('laptops');
    return $query->result_array();
}
function validate_update_cart(){
    $total = $this->cart->total_items();
    $item = $this->input->post('rowid');
    $qty = $this->input->post('qty');
    for($i=0;$i < count($item);$i++) 
    {
        $data = array(
           'rowid' => $item[$i],
           'qty'   => $qty[$i]
        );        
        $this->cart->update($data);
    }
}
function validate_add_cart_item(){
    $id = $this->input->post('product_id'); // Assign posted product_id to $id
    $qty = $this->input->post('quantity'); // Assign posted quantity to $cty
    $this->db->select('*');
    $this->db->from('tvs');
    $this->db->join('computers', 'computer.id = tv.id and computer.name = tv.name and   computer.price = tv.price');
    $this->db->join('laptops', 'laptops.id = tv.id and laptops.name = tv.name and laptops.price = tv.price');
    $this->db->where('tvs.id', $id);
    $query = $this->db->get();
    return $query->result();
}
foreach($this->cart->contents() as $item) {
if($item['id'] == $id) {
$data = array(
'rowid' => $item['rowid'],
'qty' => $item['qty'] + $qty
);
$this->cart->update($data);
return TRUE;
}
}
$row = $query->row();
$data = array(
'id' => $id,
'qty' => $qty,
'price' => $row->price,
'name' => $row->name
);
this->cart->insert($data);
return TRUE;
{
}else{
return FALSE;
}
}
} 
```

这是物品清单：

```
<ul class="products">    
<?php foreach($TV as $p): ?>  
    <li>  
        <h1>
<a href="<?php echo current_url();?>/
<?php echo $p['link']; ?>" />
<?php echo $p['name']; ?>
</a>
</h1>
<img src="<?php echo base_url(); ?>assets/image/products/<?php echo $p['image']; ?>" alt="<?php echo $p['name']; ?>" /> 
<h3>
<?php echo $p['description']; ?>
</h3>
<small>&pound;<?php echo $p['price']; ?></small>  
<?php echo form_open('/testcart/home/add_cart_item'); ?>  
<fieldset>  
                <label>Quantity</label>  
                <?php echo form_input('quantity', '1', 'maxlength="2"'); ?>  
                <?php echo form_hidden('product_id', $p['id']); ?>  
                <?php echo form_submit('add', 'Add to Cart'); ?>  
            </fieldset>  
        <?php echo form_close(); ?>   
    </li>  
    <?php endforeach;?>  
</ul>` 
```

控制器：

```
function add_cart_item(){    
if($this->cart_model->validate_add_cart_item() == TRUE){    
        if($this->input->post('ajax') != '1'){    
            redirect('');    
        }else{    
            echo 'true';     
        }
    }
} 
```

javascript

```
$(document).ready(function() {  
var link = baseurl;

$("ul.products form").submit(function() {
    // Get the product ID and the quantity 
    var id = $(this).find('input[name=product_id]').val();
    var qty = $(this).find('input[name=quantity]').val();

     $.post(link + "home/add_cart_item", { product_id: id, quantity: qty, ajax: '1' },
        function(data){

        if(data == 'true'){

            $.get(link + "home/show_cart", function(cart){
                $("#cart_content").html(cart);
            });

        }else{
            alert("Product does not exist");
        }   

     }); 

    return false;
});

$(".empty").live("click", function(){
    $.get(link + "home/empty_cart", function(){
        $.get(link + "home/show_cart", function(cart){
            $("#cart_content").html(cart);
        });
    });

    return false;
}); 
```

});

我不太确定哪里出了问题，因为我对这一切都比较陌生，无论是 Javascript 还是 PHP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:18:33.483

这是您的无错误方法。您从表电视中选择并在连接中使用电视时犯了错误

```
function validate_add_cart_item()
{
    $id = $this->input->post('product_id'); // Assign posted product_id to $id
    $qty = $this->input->post('quantity'); // Assign posted quantity to $cty

    $this->db->select('*');
    $this->db->from('tvs as tv');
    $this->db->join('computers', 'computer.id = tv.id and computer.name = tv.name and   computer.price = tv.price');
    $this->db->join('laptops', 'laptops.id = tv.id and laptops.name = tv.name and laptops.price = tv.price');
    $this->db->where('tv.id', $id);
    $query = $this->db->get();
    return $query->result();
} 
```

# c - 插入哈希表

> ID：12169724
> 
> 赞同：0
> 
> 时间：2012-08-29T01:26:47.960
> 
> 标签：c, hashtable

我正在尝试将单词插入哈希表。当我运行代码时，它应该给我一个每个单词出现频率的列表，但它什么也没给我。

我确定这与我的打印功能或我的插入功能有关，可能更多的是我的插入功能。我知道这不是 mylib.h，但我只是不确定我哪里出错了。

它不会在我的表中插入任何内容或打印它。我不确定发生了什么。

哈希表.c：

```
#include <stdio.h>
    #include <stdlib.h>
    #include <string.h>
    #include "htable.h"

    struct htablerec {
       char **key;
       int *frequencies;
       int num_keys;
       int capacity;
    };

    void *emalloc(size_t s) {
       void *result = malloc(s);
       if (NULL == result) {
          fprintf(stderr, "Memory allocation failed!\n");
          exit(EXIT_FAILURE);
       }
       return result;
    }

    htable htable_new(int capacity) {
       int i;
       htable h = emalloc(sizeof * h);
       h->capacity = capacity;
       h->num_keys = 0;
       h->frequencies = emalloc(h->capacity * sizeof h->frequencies[0]);
       h->key = emalloc(h->capacity * sizeof h->key[0]);
       for (i = 0; i < h->capacity; i++) {
          h->frequencies[i] = 0;
          h->key[i] = NULL;
       }
       return h;
    }

    void htable_free(htable h) {
       free(h->frequencies);
       free(h->key);
       free(h);
    }

    static unsigned int htable_word_to_int(char *word) {
       unsigned int result = 0;
       while (*word != '\0') {
          result = (*word++ + 31 * result);
       }
       return result;
    }

    int htable_insert(htable h, char *str) {
       int i;
       /*convert string to integer*/
       unsigned int index = htable_word_to_int(str);
       /*calculate index to insert into hash table*/
       int remainder = index%h->capacity;
       /*once calculated position in the hash table, 3 possibilities occur*/
       /*no string in this positon, copy string to that position, increment number of keys, return 1*/
       if (h->key[remainder] == NULL) {
          h->frequencies[remainder] = 1;
          h->num_keys++;
          return 1;
       }
       /*the exact same string is at the position, increment frequency at that position, return frequency*/
       if (strcmp(str, h->key[remainder]) == 0) {
          h->frequencies[remainder]++;
          return h->frequencies[remainder];
       }/*a string is at that position, but it isnt the rightone, keep moving along the array
       until you find either an open space or the string you are looking for*/
       if (h->key[remainder] != NULL && strcmp(str, h->key[remainder]) != 0) {
       /*you may need to wrap back around to the beginning of the table, so each time you add
       to the position you should also mod by the table capacity.*/
          for (i = 0; i <= h->capacity; i++) {
             if (h->key[remainder] != NULL && h->capacity ==  i) {
                i = 0;
                }
                /*no string in this positon, copy string to that position, increment number of keys*/
                if (h->key[remainder] == NULL) {
                h->frequencies[remainder] = 1;
                h->num_keys++;
             }
             /*if you find the string you were looking for, increment the frequecny at the position
             and return the frequency*/
             if (strcmp(str, h->key[remainder]) == 0) {
                h->frequencies[remainder]++;
                return h->frequencies[remainder];
             }
          }   
       }
       /*if you have kept looking for an open space but there isnt one, the hash table must be full so return 0*/
       return 0;
    }

    void htable_print(htable h, FILE *stream) {
       int i;
       for(i = 0; i < h->capacity; i++) {
          if(h->key[i] != NULL) {
             fprintf(stream, "%d%s\n", h->frequencies[i], h->key[i]);
          }
       }
    } 
```

htable.h：

```
#ifndef HTABLE_H_
#define HTABLE_H_

#include <stdio.h>

typedef struct htablerec *htable;

extern void htable_free(htable h);
extern int htable_insert(htable h, char *str);
extern htable htable_new(int capacity);
extern void htable_print(htable h, FILE *stream);
extern int htable_search(htable h, char *str);

#endif 
```

mylib.c：

```
#include <stdio.h>
#include <stdlib.h>
#include "mylib.h"
#include "htable.h"

int main(void) {
   htable h = htable_new(18143);
   char word[256];

   while (getword(word, sizeof word, stdin) !=EOF) {
      htable_insert(h, word);
   }

   htable_print(h, stdout);
   htable_free(h);

   return EXIT_SUCCESS;
} 
```

mylib.h：

```
#include <assert.h>
#include <ctype.h>
#include <stdio.h>

int getword(char *s, int limit, FILE *stream) {
   int c;
   char *w = s;
   assert(limit > 0 && s != NULL && stream != NULL);

   /*skip to the start fo the word */
   while (!isalnum(c = getc(stream)) && EOF != c)
      ;
   if(EOF == c) {
      return EOF;
   } else if (--limit > 0) { /*reduce limit by 1 to allow for the \0 */
      *w++ = tolower(c);
   }

   while(--limit > 0) {
      if(isalnum(c = getc(stream))) {
         *w++ = tolower(c);
      } else if ('\'' == c) {
         limit++;
      } else {
            break;
         }
      }
      *w = '\0';
      return w - s;
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:21:48.700

你从来没有设置`h->key[remainder]`任何东西`htable_insert`，所以当你打电话时`h->key[i]`仍然`NULL`适用。`i``htable_print`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:57:08.790

> ```
> /*no string in this positon, copy string to that position, increment number of keys, return 1*/
> if (h->key[remainder] == NULL) {
>    h->frequencies[remainder] = 1;
>    h->num_keys++;
>    return 1;
> }
> ...
> /*no string in this positon, copy string to that position, increment number of keys*/
> if (h->key[remainder] == NULL) {
>     h->frequencies[remainder] = 1;
>     h->num_keys++;
> } 
> ```

你永远不会复制字符串。尝试类似...

```
char *key = emalloc(strlen(str) + 1);
strcpy(str, key);
h->key[remainder] = key; 
```

# knockout.js - Knockout-Kendo 级联下拉列表

> ID：12169725
> 
> 赞同：0
> 
> 时间：2012-08-29T01:26:58.077
> 
> 标签：knockout.js, kendo-ui

我已经通过 Knockout-Kendo.js 库修改了 Shopping cart Knockout 示例 ( [http://knockoutjs.com/examples/cartEditor.html ) 以使用 KendoUI DropDownLists。](http://knockoutjs.com/examples/cartEditor.html)

如这个 jsfiddle 所示，这没有按预期工作（第二个 DropDownList 未填充，并显示为标准输入）。[http://jsfiddle.net/L3F2Y/4/](http://jsfiddle.net/L3F2Y/4/)

在我的机器上运行它时，会引发以下 javascript 错误：

> Microsoft JScript 运行时错误：无法解析绑定。消息：ReferenceError：“产品”未定义；绑定值：kendoDropDownList: { dataTextField: 'name', data: products, value: $parent.product }

我认为这是由于 Knockout-Kendo 自定义绑定处理集合的方式而发生的，但是任何进一步理解/解决此问题的尝试均未成功。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:35:04.330

Kendo DropDownList 未设置为本地跟踪所选对象。它想用原语填充值。所以，它最终只会`.toString()`对一个对象做 a 。

您需要分别跟踪类别名称和产品名称，并创建计算的 observables 以保留相关对象的副本。

这是一个示例：http: [//jsfiddle.net/rniemeyer/e3cTT/](http://jsfiddle.net/rniemeyer/e3cTT/)

# ruby-on-rails - Rails - 使用关联定义 cancan 能力

> ID：12169728
> 
> 赞同：1
> 
> 时间：2012-08-29T01:27:19.457
> 
> 标签：ruby-on-rails, cancan

在 cancan 能力类中定义能力时...

这是：

```
 can :manage, Area, :location => { :company => { :manager => { :user_id => user.id } } } 
```

与此相同：

```
 can :manage, Area do |area|
      area.location.company.manager.user_id == user.id
 end 
```

我只是想更好地理解在不使用障碍的情况下定义能力。一种方式比另一种更好（也许更快）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T02:45:38.820

两者应该是相同的，但是如果其他人正在阅读您的代码，则第二种方式会更加清晰。我肯定会推荐使用第二种方式。如果困扰你的是占用多行，你可以写：

```
can( :manage, Area ) {|area| area.location.company.manager.user_id == user.id } 
```

这可能比任何其他选项都更干净（当与一堆其他规则堆叠时）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-20T01:49:07.487

正如这里所说：

[https://github.com/ryanb/cancan/wiki/Defining-Abilities-with-Blocks#fetching-records](https://github.com/ryanb/cancan/wiki/Defining-Abilities-with-Blocks#fetching-records)

使用块的最大优点是它accessible_by 仍然可以工作。如果您使用块并且还想使用accessible_by，则需要手动添加SQL where 子句，这不是很干，如果可能的话IMO 应避免使用。

# android - 如何检查特定来电显示是否在联系人列表中？

> ID：12169737
> 
> 赞同：0
> 
> 时间：2012-08-29T01:28:29.207
> 
> 标签：android, contacts

我试图找出来电显示是否在联系人列表中。所以我为此使用的代码：

```
 ContentResolver resolver = this.service.getContentResolver();
    String number = PhoneLookup.NUMBER;
    String[] projections = { number };
    String selectionClause = number + " = ?";
    String[] selectionClauseArgs = { callerId };
    Cursor people = resolver.query(
            ContactsContract.Contacts.CONTENT_URI, projections,
            selectionClause, selectionClauseArgs, null);
    return people.getCount() > 0 ? true : false; 
```

我将过滤功能提供给`ContentResolver`自身，而不是获取所有内容，遍历它们并一一检查。

但是由于某种原因，我收到以下错误（有很多代码，但它们工作得很好，因为它们只是订阅电话事件以便在有人打电话时接收来电显示！”）

```
08-28 19:20:05.903: E/AndroidRuntime(737): java.lang.IllegalArgumentException: Invalid column number 
```

我不知道什么是无效的。我使用的是`PhoneLookup.NUMBER`不变的右列名称。之前在这里问过一个类似的问题：[How to read contacts on Android 2.0](https://stackoverflow.com/questions/1721279/how-to-read-contacts-on-android-2-0) which I follow。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T11:21:01.180

此表中没有电话号码。您应该从另一个地方查询它。这是快速划痕（我相信有更好的方法）：

```
boolean hasPhoneNumber = (people.getInt(people.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER)) > 0);
        if (hasPhoneNumber) {
            String id = people.getString(people.getColumnIndex(ContactsContract.Contacts._ID));
            String num = getNumber(id);
        }

public String getNumber(String id) {
    String number = null;
    String name = null;
    Cursor pCur = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null,
            ContactsContract.CommonDataKinds.Phone.CONTACT_ID + " = ?", new String[] { id }, null);
    if (pCur.moveToFirst()) {
        number = pCur.getString(pCur.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
        name = pCur.getString(pCur.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
    }
    pCur.close();
    return number;
} 
```

# c# - TextBox.Text = floatValue.ToString 与分隔符混淆

> ID：12169740
> 
> 赞同：0
> 
> 时间：2012-08-29T01:29:02.460
> 
> 标签：c#, cultureinfo

当通过方法将浮点值分配给 textBox.Text 时`floatVal.ToString()`，它会使本地文化分隔符成为`,`我如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:36:38.830

`.ToString(CultureInfo.InvariantCulture)`至少在我的情况下，使用解决了这个问题。

# arrays - Excel - 从未知数量的具有不同工作表名称的 CSV 中读取 2 个值到数组中

> ID：12169741
> 
> 赞同：0
> 
> 时间：2012-08-29T01:29:03.100
> 
> 标签：arrays, excel, vbscript

我是另一个脚本新手。我进行了很多搜索，但无法找到适合我的问题的解决方案。

*   我有一个包含不同数量 CSV 的文件夹，每个 CSV 在相同的单元格（A2 和 B2）中包含 1 个工作表和 2 个值。
*   工作表名称不相同。

从逻辑上讲，我需要创建一个脚本，该脚本会转到此文件夹中的每个 CSV，获取 2 个值并将它们放入名为 MonthlyAvg 的 XLS 中的单个工作表中，分为 2 列

即第一个范围进入主文档中的 A2 和 B2，第二个 A2 和 B2 进入主文档中的 A3 和 B3。我的想法是这应该在一个数组中处理。唉，这就是我被困的地方，因为我无法将我在创建数组时发现的逻辑逻辑地放入我迄今为止所收集的内容中。任何帮助或指导将不胜感激。

```
strPath = "D:\MacWP\MacWork\Thermometers\TOT\MonthlyAvg\"      
Set objExcel = CreateObject("Excel.Application") 
objExcel.Visible = True 
objExcel.DisplayAlerts = False 

Set objFso = CreateObject("Scripting.FileSystemObject") 
Set objFolder = objFso.GetFolder (strPath) 

 For Each objFile In objFolder.Files      
    If objFso.GetExtensionName (objFile.Path) = "csv" Then 
        Set objWorkbook = objExcel.Workbooks.Open(objFile.Path)
        'Find the first worksheet name
        FirstSheetName = objExcel.Activeworkbook.Worksheets(1).Name         

        'Set the first worksheet name
        Set objSheet = objWorkbook.Sheets (FirstSheetname)

        'Display the value in B2 of the first worksheet     
        MsgBox objSheet.Range("B2").Value
        'Display the value in A2 of the first worksheet
        MsgBox objSheet.Range ("A2").Value          

        objWorkbook.Close False 'Save changes 
    End If      
Next 
objExcel.Quit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:22:08.387

如果我理解，您的文件搜索已经完成，您唯一的问题是如何将部分值存储在主 excel 文件中，对吗？

为此，您可以使用带有“索引”的 For 循环。

```
Dim i As Integer, j As Integer, n As Integer   
Dim filesOpen As Long

With Application.FileSearch

    .LookIn = "C:\Examples"

    .FileType = msoFileTypeExcelWorkbooks

      'There are wb's

      If .Execute > 0 Then

        For n = 1 To .FoundFiles.Count

          Workbooks.Open (.FoundFiles(i))

        Next n

filesOpen = n

end With

For i = 2 To filesOpen

'i = 2 'fila
j = 1 'columna    

'column A2        
Application.Workbooks("MasterFile").Worksheets("nameOfYourMasterSheet").Cells(i, j).Value = Application.Workbooks("Book1.cvs").Worksheets("nameOfYourSheet").Cells(2, j).Value

'column B2
Application.Workbooks("MasterFile").Worksheets("nameOfYourMasterSheet").Cells(i, j+1).Value = Application.Workbooks("Book1.cvs").Worksheets("nameOfYourSheet").Cells(2, j+1).Value

next i 
```

因此，最后一个 for 循环是为您的主文件提供值。在没有更多工作簿之前，“i”索引是唯一递增的。

您不必使用数组，只需注意“i”值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T03:04:06.167

您可以使用下面的[vbs](/questions/tagged/vbs "显示标记为“vbs”的问题")将所有值直接写入`csv`文件。`output.csv`下面的代码在下面创建一个文件`strPath`

```
Dim objExcel
Dim objFSO
Dim objTF
Dim objWB

strpath = "c:\temp"

Set objExcel = CreateObject("Excel.Application")
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFolder = objFSO.GetFolder(strpath)
Set objTF = objFSO.CreateTextFile(strpath & "\output.csv", True, False)
objExcel.DisplayAlerts = False

For Each objFile In objFolder.Files
If objFSO.GetExtensionName(objFile.Path) = "csv" Then
Set objWB = objExcel.Workbooks.Open(objFile.Path)
objTF.WriteLine objWB.Sheets(1).Range("B2") & "," & objWB.Sheets(1).Range("A2")
objWB.Close False 'Save changes
End If
Next

objTF.Close
With objExcel
.DisplayAlerts = True
.Quit
End With 
```

# php - 从 mysql_query 转换为准备好的语句 (mysqli/PDO)？必要的？

> ID：12169742
> 
> 赞同：2
> 
> 时间：2012-08-29T01:29:07.380
> 
> 标签：php, mysql, pdo, mysqli, sql-injection

过去几周我一直在学习 PHP 和 MySQL，而我现在才听说准备好的语句和 PDO/mysqli。我做了一些阅读，人们说这样的话：

```
$getFromDatabase = mysql_query("SELECT * FROM table WHERE userid='$id'");
while($row = mysql_fetch_assoc($getFromDatabase)){
    stuff();
} 
```

......不会再工作了。我在我的代码中经常使用类似的东西。我也在阅读很多关于准备好的语句如何更好地防止注入的内容。我已经彻底了解它是如何变得更好的，但是它是否更好，值得从 mysql_real_escape_string() 切换？是否需要切换到Mysqli或PDO？在什么情况下 mysql_real_escape_string() 可以在准备好的语句无法绕过的情况下被绕过？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T01:35:14.717

这是必要`mysql_query`的，因为在软件方面，它是一个古老的人工制品。它是 MySQL 数据库接口的[T 型模型，如果不](http://en.wikipedia.org/wiki/Ford_Model_T)*完全*按照您应该使用的方式使用，那么笨重、不可靠并且非常危险。如果您不是非常小心，您会犯错误，如果有人在您的站点上使用[自动 SQL 注入错误检测工具，即使是很小的错误也不会被忽视。](http://sqlmap.org/)

基本上你是靠借来的时间生活`mysql_query`。

如果您使用`mysqli`或 PDO 并且非常注意使用占位符，则 SQL 注入错误的风险非常低。可能需要大约半个小时才能弄清楚如何将您的旧代码转换为这些新方法，确实没有陡峭的学习曲线，并且这些知识将为您将来节省很多麻烦。`mysqli`如果您使用基本占位符，转换现有代码通常不是什么大问题。我敢打赌，您在修补时甚至会发现一些严重的错误。

就好处而言，您无需拨打任何`mysql_real_escape_string`电话，只需使用`bind_param`，您就不必担心错过某个变量的转义。从长远来看，实际上工作量要少得多。

此外，使用`?`或命名的占位符`:id`使您的查询更易于阅读、调试和维护。此外，您可以重复使用相同的语句并将不同的值绑定到它，最终使您的应用程序更快。

可以编写安全代码，`mysql_query`但你为什么要这样做？该接口被列为已弃用，这是将其从 PHP 中完全删除的初步阶段。如果您想要一个面向未来的应用程序，最好使用受支持的接口之一。

# c++ - boost::lexical_cast 没有运行时库

> ID：12169743
> 
> 赞同：0
> 
> 时间：2012-08-29T01:29:09.473
> 
> 标签：c++, boost, lexical-cast, microsoft-runtime-library

我的情况是我想使用 boost::lexical_cast，但不能使用 C/C++ 运行时库，因此不能使用 lexical_cast。我不太了解 Boost，但我见过以下块的使用：

```
#ifdef BOOST_NO_STRINGSTREAM
#include <strstream> 
#else  
#include <sstream>  
#endif 
```

并且想知道是否可以使用#define 以使Boost 不依赖于所述库。

如果 Boost 文档中有特定位置解释了可能的预处理器选项，那也将不胜感激，因为我似乎无法在网上找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T04:02:52.813

[Boost.Config](http://www.boost.org/doc/libs/1_51_0/libs/config/doc/html/index.html)用于为特殊情况配置 Boost 。

`Boost.Lexical_Cast`至少取决于`<string>`,`<istream>`和`<ostream>`来自标准库。可能更多。我认为您不能通过简单地重新配置某些东西来删除此类依赖项。

# c++ - 引用初始化无效：指针和值之间的区别？

> ID：12169746
> 
> 赞同：1
> 
> 时间：2012-08-29T01:29:45.093
> 
> 标签：c++, pointers, reference, constants

考虑以下代码：

```
#include <iostream>
#include <vector>

template<typename Type> class MyClass
{
    public:
        MyClass(Type* ptr) : _ptr{ptr}, _val{*ptr} {;}
        inline Type*& getptr() {return _ptr;}
        inline Type*& getptrc() const {return _ptr;}
        inline Type& getval() {return _val;}
        inline Type& getvalc() const {return _val;}
    protected:
        Type* _ptr;
        Type _val;
};

int main()
{
    std::vector<double> v = {0, 1, 2};
    MyClass<const double> x(&v[0]);
    x.getval();
    x.getvalc(); // <- OK
    x.getptr();
    x.getptrc(); // <- ERROR : "invalid initialization of reference of type 'const double*&' from expression of type 'const double* const'"
    return 0;
} 
```

GCC 为 getptrc 函数产生错误`invalid initialization of reference of type 'const double*&' from expression of type 'const double* const'`。但是函数 getvalc 编译得很好。我不明白 getvalc 和 getptrc 之间的区别是错误的根源。

错误的原因是什么，为什么我不能为返回指针引用的函数放置一个 const ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T02:04:40.827

`const double*&`是对指向 a 的指针的引用`const double`。

`const double* const`是一个指向 a 的**const**指针`const double`。

这意味着您必须*返回一个常量指针*。

```
inline Type* const & getptrc() const {return _ptr;} 
```

`const`on 方法意味着您不会修改数据成员。要完成该合同，您必须返回一个常量指针，否则您可以修改数据成员`_ptr`。但是，在您使用 的另一种情况下`getvalc`，您已经通过返回 a 来履行该合同`const double`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:07:58.097

在`MyClass<const double>`，名称`Type`指的是`const double`。`getvalc()`所以返回 a的成员函数`Type&`很好：它返回 a `const double&`，并且`_val`不能通过该引用进行修改。

`Type*&`对于;还有另一层间接性。虽然`Type`is `const double`，但指向它的指针是可修改的；这就是编译器抱怨的原因：`_ptr`在 const 成员函数中是 const ，但该函数试图将其作为可修改的指针返回。

# java - 在类中不可用的函数中添加到数组中的元素，丢失其值

> ID：12169747
> 
> 赞同：0
> 
> 时间：2012-08-29T01:29:55.533
> 
> 标签：java

我的程序应该模拟一个购物车。其中一个功能是从文本文档中读取商品数据，并将价格、商品 ID 和商品名称等数据存储在数组中。一旦我尝试从下面的“myClass”类访问数组内容，函数中添加的数组内容似乎消失了。我想知道是否有人可以帮助我弄清楚使用 idArray 的正确方法是什么，它在函数中添加了元素，在 myClass 中，如下所示？

注意：我在未按预期打印的数组的区域中添加了注释。

我提前感谢任何帮助。

```
 public class MyClass extends JFrame{

            public String[] idArray = new String[10];
            public String[] recordArray = new String[10];
            public String[] priceArray = new String[10];

            public void openFile(){
                try{
                    x = new Scanner(new File("inventory.txt"));
                    x.useDelimiter(",|" + System.getProperty("line.separator")); 
                }
                catch(Exception e){
                    System.out.println("Could not find file");
                }
            }
            public void readFile(){
                int i=0;
                while(x.hasNext()){
                    idArray[i] = x.next();
                    recordArray[i] = x.next();
                    priceArray[i] = x.next();
                    i++;
                }
            }
            public MyClass(){

                /** Code to create GUI Here    **/

                //Process Item
                button1.addActionListener(new ActionListener(){
                   public void actionPerformed(ActionEvent e){
                      String y = item1.getText();
                      int numItems = Integer.parseInt(y);
                      MyClass obj = new MyClass();
                      obj.openFile();

                      //**ARRAY PRINTS OUT NULL AND DOES NOT PRINT OUT THE VALUES AQUIRED IN THE FUNCTION ABOVE**//
                      for(int i=0; i < numItems; i++){
                          for(int g=0; g < idArray.length; g++){
                                System.out.println(obj.idArray[g]);   
                          }
                       }
                   }
                });
         }      
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:38:15.243

那是因为您从未真正调用过`readFile`，因此从未设置过值。我假设您打算`readFile`从`openFile`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:42:00.513

除非我遗漏了某些东西，否则您似乎正在打开文件但忘记读取文件....因此为空。尝试这个：

```
 obj.openFile();
   obj.readFile(); 
```

# arrays - Highcharts - 为数组中的标志传递数据。它没有被渲染

> ID：12169752
> 
> 赞同：0
> 
> 时间：2012-08-29T01:30:52.537
> 
> 标签：arrays, highcharts, flags

我正在尝试在 Highchart 的烛台图表中渲染 3 个标志（用标志进行实验），但标志 {x: Date.UTC(2012, 7, 6),title: 'On series'} 没有被渲染。为什么？

```
$(function() {
    $.getJSON('http://www.highcharts.com/samples/data/jsonp.php?filename=aapl-ohlcv.json&callback=?', function(data) {

        // split the data set into ohlc and volume
        var ohlc = [],
            volume = [],
            dataLength = data.length,
            arrflag =[
            {x: Date.UTC(2012, 7, 17),title: 'On series'},
            {x: Date.UTC(2012, 7, 9),title: 'On series'}
            ];

        arrflag.push([
           {x: Date.UTC(2012, 7, 6),title: 'On series'}
        ]);

        for (i = 0; i < dataLength; i++) {
            ohlc.push([
                data[i][0], // the date
                data[i][1], // open
                data[i][2], // high
                data[i][3], // low
                data[i][4] // close
            ]);

            volume.push([
                data[i][0], // the date
                data[i][5] // the volume
            ])
        }

        // set the allowed units for data grouping
        var groupingUnits = [[
            'week',                         // unit name
            [1]                             // allowed multiples
        ], [
            'month',
            [1, 2, 3, 4, 6]
        ]];

        // create the chart
        chart = new Highcharts.StockChart({
            chart: {
                renderTo: 'container',
                alignTicks: false
            },

            rangeSelector: {
                selected: 0
            },

            title: {
                text: 'AAPL Historical'
            },

            yAxis: [{
                title: {
                    text: 'OHLC'
                },
                height: 200,
                lineWidth: 2
            }, {
                title: {
                    text: 'Volume'
                },
                top: 300,
                height: 100,
                offset: 0,
                lineWidth: 2
            }],

            series: [{
                type: 'candlestick',
                name: 'AAPL',
                id: 'AAPLX',
                data: ohlc,
                dataGrouping: {
                    units: groupingUnits
                }
            }, {
                type: 'column',
                name: 'Volume',
                data: volume,
                yAxis: 1,
                dataGrouping: {
                    units: groupingUnits
                }
            },{
                type: 'flags',
                name: 'Flags on series',
                data: arrflag,
                onSeries: 'AAPLX',
                shape: 'squarepin'
            }]
        });
    });
});​ 
```

[现场演示](http://jsfiddle.net/rTC5B/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:59:27.317

您`array`的标志具有以下值：

```
arrflag =[
    {x: Date.UTC(2012, 7, 17),title: 'On series'},
    {x: Date.UTC(2012, 7, 9),title: 'On series'}
]; 
```

当您推送另一个时`flag`，您将其添加到另一个数组中，这不是预期的。所以结果会是。

```
arrflag =[
    {x: Date.UTC(2012, 7, 17),title: 'On series'},
    {x: Date.UTC(2012, 7, 9),title: 'On series'},
    [{x: Date.UTC(2012, 7, 6),title: 'On series'}]
]; 
```

从以下代码中删除`[`和。`]`

```
arrflag.push([
    {x: Date.UTC(2012, 7, 6),title: 'On series'}
]); 
```

# c# - iTextSharp 错误地报告文本位置

> ID：12169756
> 
> 赞同：1
> 
> 时间：2012-08-29T01:31:53.807
> 
> 标签：c#, itextsharp

我正在使用 iTextSharp 从 PDF 文件中提取文本。我已经创建了一个实现 ITextExtractionStrategy 的类并实现了 RenderText()、GetResultantText() 等方法。我也研究了 iTextSharp 本身提供的 LocationTextExtractionStrategy 类。

我面临的问题是，对于特定的 PDF 文档，RenderText() 方法错误地报告了一些文本块的水平位置。这发生在页面上总共 700 多个文本块中的大约 15-20 个块中。我正在使用以下简单代码来获取 RenderText() 中的文本位置：

```
Vector curBaselineStart = renderInfo.GetBaseline().GetStartPoint();
LineSegment segment = renderInfo.GetBaseline();
TextChunk location = new TextChunk(renderInfo.GetText(), segment.GetStartPoint(), segment.GetEndPoint(), renderInfo.GetSingleSpaceWidth());
chunks.Add(location); 
```

收集所有文本块后，我尝试使用 Graphics 类和以下简单循环将它们绘制在位图上：

```
for (int k = 0; k < chunks.Count; k++)
{
    var ch = chunks[k];
    g.DrawString(ch.text, fnt, Brushes.Black, ch.startLocation[Vector.I1], bmp.Height - ch.startLocation[Vector.I2], StringFormat.GenericTypographic);
} 
```

问题仅发生在这几个文本块的 X（水平）维度上。它们看起来比实际位置稍微靠左。想知道我的代码是否有问题。

舒贾特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T08:02:19.913

终于想通了。在 PDF 中，计算实际文本位置比简单地获取基线坐标更复杂。您还需要结合字符和单词间距、水平和垂直缩放以及其他一些因素。我与 iText 人员进行了一些通信，他们现在在 TextRenderInfo 类中合并了一个新方法，该方法通过处理所有上述因素来提供实际的逐个字符位置。

# iphone - 如何始终在应用程序的前端和顶部设置自定义 UIToolBar？

> ID：12169757
> 
> 赞同：0
> 
> 时间：2012-08-29T01:31:57.867
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我已经坚持了一段时间了。我试图将自定义工具栏始终放在我的 iPad 应用程序的前面（在其他视图的前面），但是我不确定如何告诉 UIApplicationDelegate 将其建立为父视图。

我尝试使用导航控制器，但我需要它始终卡在顶部，并且在更改视图时我无法摆脱过渡动画。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T11:54:58.953

您必须在主窗口中设置该自定义工具栏或以编程方式将该工具栏添加为窗口中的子视图，然后在您的所有子视图控制器中设置视图大小，例如，如果您的工具栏的高度为 50px，那么您的 X 位置所有子视图必须以 50px 开头。

这种方法对我有用，希望它也能帮助你。

# bash - 如果我可能没有收到所有 4 个八位字节作为输入，使用 Bash 如何将 IP 地址分成 4 个八位字节变量？

> ID：12169759
> 
> 赞同：0
> 
> 时间：2012-08-29T01:31:58.867
> 
> 标签：bash, ip

我正在编写一个将在 bash 中运行的脚本。

该程序的预期输入将类似于以下 4 种情况之一：

> 运行 192.168.1.1 [其他参数]
> 
> 运行 168.1.1 [其他参数]
> 
> 运行 1.1 [其他参数]
> 
> 运行 1 [其他参数]

鉴于这些情况中的任何一种，我都希望拥有以下数组。

IP[0]=192

IP[1]=168

IP[2]=1

IP[3]=1

始终需要第 4 个八位字节。如果其他没有提供，它们将默认为 192.168.1.x。

我看到了关于分离八位字节的这个页面，但我不确定如何解释我需要处理的 4 种不同的输入情况。[这里。](https://stackoverflow.com/questions/10417908/split-an-ip-address-into-octets-then-do-some-math-on-each-of-the-octets)

任何有关如何改进或实施此功能的帮助或建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T04:32:22.743

首先，将 IP 地址拆分为 4 个部分，但只有在“填充”后才能保证 4 个字段：

```
input=168.1.1
IFS=. read -a o <<< "...$input" 
```

然后，构建修补后的输出，使用默认值参数扩展来修补从填充中分配了空字符串的字段。

```
declare -a ip=( ${o[-4]:-192}
                ${o[-3]:-168}
                ${o[-2]:-1}
                ${o[-1]:-1} ) 
```

最后，您可以将其缝合在一起：

```
output=$( IFS=.; echo "${ip[*]}" ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:07:53.010

这应该有效。它使用蛮力来查找 IP 的长度，并使用 $IFS 变量将其分隔到数组中：

```
#! /bin/bash
function full_ip () {
    if [[ $1 = *.*.*.* ]] ; then
        echo $1
    elif [[ $1 = *.*.* ]] ; then
        echo 192.$1
    elif [[ $1 = *.* ]] ; then
        echo 192.168.$1
    else
        echo 192.168.1.$1
    fi

}

for ip in 192.168.1.1 168.1.1 1.1 1 ; do
    f=$(full_ip $ip)
    echo -n $f$'\t'
    IFS=. IP=($f) IFS=$' \t\n'
    echo ${IP[0]} ${IP[1]} ${IP[2]} ${IP[3]}
done 
```

# oop - 类的孩子和类的实例之间的区别？

> ID：12169760
> 
> 赞同：2
> 
> 时间：2012-08-29T01:32:17.583
> 
> 标签：oop, class

类的子类和类的实例有什么区别？两者似乎都从他们的“父母”那里继承了代码。一个类的实例是执行代码，与一个类的子类只是为了创建额外的实例而存在的区别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T01:52:53.603

一个类只不过是一个定义、一个模板、一个模式。该类的一个实例是该定义的一个副本，该定义已分配了用于保存其数据的内存空间。这就像说蛋糕是蛋糕食谱的一个实例。

一个类的子类字面意思是——父类形成一个基本定义，然后子类扩展或增强它。它是父级的变体，就像巧克力蛋糕是基本蛋糕食谱的变体（或扩展）一样。

请注意，对 OO 概念的这个非常简单的解释隐藏了这些东西是如何在机器级别实际实现的。一个类可以包含方法（操作）——这些方法只保留一个副本，实例化类的新实例不会生成方法的新副本。相反，内存空间被分配给新实例，并且指针将用于指向应该为每个方法实现的实际代码。但是，每个实例都有自己的数据（属性）副本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:35:45.870

以 php 为例：

```
class A {
  //...
}

class B extends A {
  //...
}
$a = new A(); 
```

我们说`B`是 的孩子`A`，`$a`是 的实例`A`。

# css - 让文本移到新列

> ID：12169762
> 
> 赞同：0
> 
> 时间：2012-08-29T01:32:38.803
> 
> 标签：css

我正在尝试获取页脚区域位置和时间中的文本，以便为每个办公室创建两列。我尝试使用高度设置将其浮动到左侧，但它没有创建两列。有人可以告诉我我做错了什么吗？

你可以在这里找到网站...

[http://jsfiddle.net/ggJvM/](http://jsfiddle.net/ggJvM/)

** Fiddle 可能会失败 **

我希望在自己的专栏中同时拥有办公室和时间。

这是我遇到问题的脚本和 css 的一个区域。

```
<div id="footer"><div class="content">
        <ul class="left">
            <li class="Footerbullets"><a href="default.php">HOME</a></li>
            <li class="Footerbullets"><a href="practiceareas.php">PRACTICE AREAS</a></li>
            <li class="Footerbullets"><a href="attorneyprofiles.php">ATTORNEY PROFILES</a></li>
            <li class="Footerbullets"><a href="blog.php">BLOG</a></li>
            <li class="Footerbullets"><a href="locations.php">LOCATIONS &amp; HOURS</a></li>
            <li class="Footerbullets"><a href="contactus.php">CONTACT US</a></li>
        </ul>
        <ul class="center">
            <li class="Footerbullets">CURRENT NEWS</li>
            <li>&nbsp;</li>
        </ul>
        <ul class="right">
            <li class="Footerbullets">LOCATION &amp; HOURS</li>
            <li style="padding:3px 0 3px 25px;">Atlantic County Office:</strong><br>
    210 New Road, Suite 12<br>
    Linwood Greene<br>
    Linwood, New Jersey 08221<br>
    Phone: (609) 601-8677<br>
    Fax: (609) 601-8577<br><br>

    <strong>Office Hours:</strong><br>
    Monday - Friday: 08:30 AM-5:00 PM<br>
    Saturday: 10:00 AM-12:30 PM<br>
    Other hours by appointment<br />
     <br />
    <strong>Camden County Office:</strong><br>
    1939 Route 70 East, Suite 100<br>
    Cherry Hill, New Jersey 08003<br>
    Phone:(856) 874-0555<br>
    Fax: (856) 874-9683<br><br>

    <strong>Office Hours:</strong><br>
    Monday - Friday: 08:30 AM-5:00 PM<br>
          Saturday: 10:00 AM-12:30 PM<br>
         Other hours by appointment</li>
        </ul>
     </div></div> 
```

**这是该区域的 CSS 的一部分**

```
#footer .content {
border-bottom: 1px #fff dotted;
border-top: 1px #fff dotted;
width: 960px;
height: 135px;
position: relative;
margin-right: auto;
margin-left: auto;
padding-top: 10px;
padding-bottom: 10px;
color:#FFF;
}
#footer ul{
float: left;
width: 319px;
height: 135px;
border-right: 1px #fff dotted;
color:#FFF;
 }
#footer ul:last-child {
border-right: none;
}

#footer {
background: #4D1516;
margin-top: -200px;
z-index: 1;
position:relative;
padding-top: 220px;
padding-bottom: 100px;
color:#FFF;
font-weight:bolder;
}

div#footer ul li a{
color : #115EAC;
background-color : transparent;
text-decoration : none;
color:#FFF;
}
 div#footer ul li a:hover{
text-decoration : underline;
}
.Footerbullets{
padding:3px 0 3px 25px;
background-image:url(http://www.gdisinc.com/barker/images/menubar/footer_bullet.jpg);
background-repeat:no-repeat;
}
.Footerbullets a:link {
   color:#FFF;
 }
div#footer ul li.Footerbullets a:hover {
    color:#FF0;
 }

 /* Footer column sizes. */
#footer ul.left {
width: 20%;
 }

 #footer ul.center {
width: 40%;
 }

 #footer ul.right {
float: left;
width: 37%;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:24:24.590

你想要这个：http: [//jsfiddle.net/ggJvM/1/](http://jsfiddle.net/ggJvM/1/)？

CSS：

```
.locationHours{
    overflow:hidden;
}
.locationHours>div{
    float:left;
    width:50%;
}
#footer .content,#footer ul{
    height:auto;
    overflow:hidden;
} 
```

HTML：

```
<li class="locationHours">
    <div>
        <strong>Atlantic County Office:</strong><br>
        210 New Road, Suite 12<br>
        Linwood Greene<br>
        Linwood, New Jersey 08221<br>
        Phone: (609) 601-8677<br>
        Fax: (609) 601-8577<br><br>

        <strong>Office Hours:</strong><br>
        Monday - Friday: 08:30 AM-5:00 PM<br>
        Saturday: 10:00 AM-12:30 PM<br>
        Other hours by appointment<br />
    </div>
    <div>
        <strong>Camden County Office:</strong><br>
        1939 Route 70 East, Suite 100<br>
        Cherry Hill, New Jersey 08003<br>
        Phone:(856) 874-0555<br>
        Fax: (856) 874-9683<br><br>

        <strong>Office Hours:</strong><br>
        Monday - Friday: 08:30 AM-5:00 PM<br>
        Saturday: 10:00 AM-12:30 PM<br>
                    Other hours by appointment
    </div>
</li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:23:29.490

您在一个列表项中拥有两个办公室。通过关闭 LI 并打开一个新的来将它们分开。

```
...
Other hours by appointment
</li><li>
<strong>Camden County Office:</strong>
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:24:48.563

不要**使用**财产`float`。它在特殊的罕见情况下搞砸了网站。
您可以使用 html**表格**结构或将它们放在一些*带有*. 看到[这个jsfiddle](http://jsfiddle.net/dariushvb2010/UQwaM/1/)`display:inline-blok`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-29T01:52:36.627

我看不到小提琴...该网站可能已关闭。但是猜测一下，您是否也指定了宽度？您需要一个宽度，否则 ul 将占据整个区域。

# java - 行业标准布局管理器

> ID：12169763
> 
> 赞同：0
> 
> 时间：2012-08-29T01:32:41.050
> 
> 标签：java, layout

各位大侠，我能根据你作为Java程序员的经验问你什么是常用的布局管理器，也许在你的办公室我需要知道，以便我自己准备和研究布局，有这么多布局，现在我只是完成 gridbaglayout，我现在将进入 spring 布局。什么是最好的布局，并告诉布局的优点和缺点。对不起，我是 Java 的初学者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:38:23.313

这是一个相当主观的问题。

就个人而言，我喜欢`GridBagLayout`，但我也使用`VerticalLayout`SwingX

在我的脑海中，[MigLayout](http://www.miglayout.com/)得到了很多积极的反馈，我相信[JGoodies](http://www.jgoodies.com/freeware/libraries/forms/)会不时被提及。

问题是，在你真正知道自己想要做什么之前，你不会知道最适合这项工作的工具

# flash - Mediaelement.js Flash 回退不起作用

> ID：12169767
> 
> 赞同：5
> 
> 时间：2012-08-29T01:32:55.117
> 
> 标签：flash, mediaelement.js

我正在使用 Mediaelement.js 在页面上包含视频。

它可以在[http://badlands777.com/test/找到](http://badlands777.com/test/)

我可以让视频在 Chrome 和 Safari 中完美运行。但是，Firefox 的 Flash 后备功能似乎没有启动。

具体来说，当我右键单击 Flash 播放器时，它会显示“未加载电影”。我检查了播放器和视频文件的路径，它们都是正确的。

这是我正在使用的代码：

```
<object style="border: solid 1px #fff;" width="320" height="240" type="application/x-shockwave-flash" data="http://badlands777.com/js/flashmediaelement.swf">
    <param name="movie" value="http://badlands777.com/js/flashmediaelement.swf" />
    <param name="flashvars" value="controls=false&amp;file=http://badlands777.com/wp-content/uploads/2012/08/flamesintro_v02.mp4" />
    <!-- Image as a last resort -->
    <img src="myvideo.jpg" width="320" height="240" title="No video playback capabilities" />
</object> 
```

```
<script>
MediaElement('player1', {success: function(me) {    
    me.play();
}});
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T21:19:32.660

通过使用以下代码设法使其工作：

HTML：

```
<video id="player1" width="100%" height="100%" controls="controls">
    <!-- MP4 for Safari, IE9, iPhone, iPad, Android, and Windows Phone 7 -->
    <source type="video/mp4" src="PATH_TO_VIDEO.mp4" />
    <object width="1024" height="576" type="application/x-shockwave-flash" data="PATH_TO_flashmediaelement.swf">
       <param name="movie" value="PATH_TO_flashmediaelement.swf">
       <param name="flashvars" value="controls=true&amp;file=PATH_TO_VIDEO.mp4">
    </object>
</video> 
```

JS：

```
 jQuery(document).ready(function(){        

        // THE MOST HATED PIECE OF CODE IN THE WORLD.
        jQuery('video').mediaelementplayer({
            success: function(player, node) {

            // STARTS THE VIDEO IF IT'S FLASH VIDEO FALLBACK.
            jQuery('.mejs-overlay-button').trigger('click');

            // STARTS THE VIDEO IF IT'S HTML5 COMPATIBLE.
            player.play();
            }
        });

        // FADES IN TITLES.
        jQuery(".enter_logo").delay(2200).animate({opacity:1},2000);
        jQuery(".enter_button").delay(6000).animate({opacity:0.4},2000);

    }); 
```

# cognos - cognos viewer 与 cognos query studio 和 report studio 的使用

> ID：12169773
> 
> 赞同：0
> 
> 时间：2012-08-29T01:33:44.310
> 
> 标签：cognos

在 cognos 中，我们使用框架管理器设计一个模型，然后我们可以使用该模型在 Query Studio/Report Studio 中构建报表。但是，还有另一个名为 cognos viewer 的报表查看实用程序。当一切都可以在查询工作室或报表工作室中完成时，为什么我们需要 cognos 查看器？是因为 cognos sdk 使用 cognos 查看器来呈现报告还是其他原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T21:33:39.153

Cognos 查看器只是您查看报告输出时显示的页面。例如 ：

*   单击 Cognos Connection 中的报告，它会运行（您会看到沙漏），然后在完成后，您会在 Cognos 查看器中看到输出
*   从 Report Studio 运行报告，它会运行（显示沙漏），然后当它完成时，您会在 Cognos 查看器中看到 hte 输出

# perl - 通过telnet在远程windows机器上执行win32ole脚本

> ID：12169776
> 
> 赞同：0
> 
> 时间：2012-08-29T01:34:02.997
> 
> 标签：perl, telnet, win32ole

我正在尝试在远程 Windows 机器上创建一个 word 文档。我正在尝试远程登录到远程 Windows 机器并运行一个 perl 脚本，该脚本通过 Win32::OLE 创建 word 文档。但这似乎不起作用。这可能吗？因为我的脚本已将 {visible} 设置为 1，但该 telnet 会话是否可以访问 word 应用程序的实例？至少我试过没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-20T03:23:54.117

Telnet 可能不是完成此任务的最佳工具，我不确定它具有什么样的权限。我建议使用[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)，它允许在 Windows 服务器上执行远程命令。如果它在本地工作，它将使用 PsExec 工作。

例如：

```
PsExec.exe \\remotecomputer -u userName -p Password Perl C:\path\to\file\file.pl 
```

您可以使用 -s 标志作为系统帐户运行，使用 -i 标志在桌面上交互式运行它。如果没有 -i 标志，它将在控制台会话中运行。

# winapi - 本地挂钩不起作用

> ID：12169777
> 
> 赞同：1
> 
> 时间：2012-08-29T01:34:09.333
> 
> 标签：winapi, hook, setwindowshookex, findwindow

我有一个应用程序并希望监视*MSWord*按键（本地挂钩），但我不知道如何找到要使用的 pid！下面的代码在全局钩子 ( `pid`= `0`) 和 ( `pid`= `GetCurrentThreadId`) 下效果很好。但不适用于`GetWindowThreadProcessId`：

```
 HWND hWindow = FindWindowEx(NULL,NULL,String("Notepad").w_str(),NULL);
if (!hWindow) {
   ShowMessage("hWindow fail");
   return;
}

unsigned long pid;
GetWindowThreadProcessId(hWindow ,&pid);

//pid = GetCurrentThreadId();
if (!hWindow) {
   ShowMessage("pid fail");
   return;
}

String s = "HookDLL.dll";
DllHandle=LoadLibrary(s.w_str());
HOOKFCT_2 InstHook=reinterpret_cast<HOOKFCT_2> (GetProcAddress(DllHandle,"InstallHook"));

if(!InstHook(pid, (void *)(callIt) ))
{
    Label1->Caption="Unable to install mouse hook!";
}
else Label1->Caption="Mouse hook installed!"; 
```

我会非常非常感谢任何关于这个问题的...

注意：

1.  我希望只对*MSWord*有一个钩子。

2.  上面的代码有效，仅在尝试挂钩另一个应用程序时失败（即：不使用`pid`=`0`或`pid`= `GetCurrentThreadId`），导致 = *"无法安装鼠标挂钩！"* .

3.  我已经尝试过`FindWindow`,,,, `FindWindowEx`; 由于这不起作用，我相信问题是。`GetForegroundWindow``GetActiveWindow``GetWindowThreadProcessId`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T12:37:41.110

`SetWindowsHookEx`需要*线程 ID*，而不是进程 ID。改为传递线程 ID：

```
DWORD threadID = GetWindowThreadProcessId(hWindow, 0);

if(!InstHook(threadID, (void *)(callIt) )) {...} 
```

# ruby-on-rails - 在 Rails 中将单词大写的最佳做法是什么？

> ID：12169785
> 
> 赞同：11
> 
> 时间：2012-08-29T01:35:28.210
> 
> 标签：ruby-on-rails, ruby, internationalization

我正在使用 Rails 中的语言，我想知道将单词大写时的最佳做法是什么。

en.yml:

```
hello: "hello" 
```

应用程序.html.erb：

```
<%= link_to t(:hello).capitalize, hello_path %> (with capitalization)
<%= link_to t(:hello), hello_path %> (without capitalization) 
```

或者

en.yml:

```
Hello: "Hello"
hello: "hello" 
```

应用程序.html.erb：

```
<%= link_to t(:Hello), hello_path %> (with capitalization)
<%= link_to t(:hello), hello_path %> (without capitalization) 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-29T01:53:16.190

第二个有更好的机会是正确的。何时大写以及何时不大写取决于语言环境，因此如果`t(:hello).capitalize`不查看周围的上下文，您将无法知道是否会产生正确的结果。比这两种方法更好的方法是在符号中包含上下文，如下所示：

```
t(:hello_button) 
```

然后在你的英文 YAML 中：

```
hello_button: "Hello" 
```

这样，翻译就可以使用适合所讨论语言的任何一种情况。此外，有时英语会使用同一个词来表示两件事，而其他语言会使用不同的词：将*橙色*视为颜色，将*橙色*视为水果；因此上下文在您的翻译中的重要性。

此外，`capitalize`仅适用于 ASCII 字符，除非您将`mb_chars`其混入其中：

```
> 'µ'.capitalize
=> "µ" 
> 'µ'.mb_chars.capitalize.to_s
=> "Μ" 
```

`µ`您可能不会在单词开头遇到领先但简单的重音很常见：

```
> 'éclair'.capitalize
=> "éclair" 
> 'éclair'.mb_chars.capitalize.to_s
=> "Éclair" 
```

通过假设所有语言的行为都像英语，这只是触及了您将面临的困难的表面。等到你必须开始处理[复数规则](http://docs.translatehouse.org/projects/localization-guide/en/latest/l10n/pluralforms.html?id=l10n/pluralforms)。

L10N 中的基本规则是将面向用户的字符串视为不透明的数据块，您可以从某种数据库中提取这些数据并显示给用户，而无需在两者之间进行任何操作。是的，这会使您的代码更加复杂，但正确性很重要。

* * *

当我在这里时，尝试翻译单个单词往往会产生难以理解的混乱，如果你翻译整个句子，你会得到更好的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T01:38:05.047

首先。不要仅以大写作为区别来复制您的数据，这只会使其更难维护。

# layout - SWT：GridLayout 列跨度

> ID：12169790
> 
> 赞同：1
> 
> 时间：2012-08-29T01:36:03.853
> 
> 标签：layout, swt, html, composite, grid-layout

我已经使用 SWT 几年了，但我似乎无法弄清楚这一点：

我需要将 VIEW 分成 2 个“区域”：左和右所以我使用带有 GridLayout 的 Composite 和 2 列来做到这一点。

在 RIGHT 复合内，我有固定数量的列（在另一个 GridLayout 复合内创建），但**在 LEFT 复合内，我需要创建跨越复合限制的动态列数......**

有没有办法做到这一点？

我在左合成中尝试了 RowLayout，但是这两个不匹配：-\

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T05:06:52.553

因为不清楚你的意思是什么

1.  **跨越复合限制的列**
2.  我在左合成中尝试了 RowLayout，**但是这两个不匹配**

因此，我假设您想要为您的左侧合成动态更改网格布局。请参阅下面的代码，特别是`button.addSelectionListener()`.

```
import java.util.Random;

import org.eclipse.swt.SWT;
import org.eclipse.swt.events.SelectionAdapter;
import org.eclipse.swt.events.SelectionEvent;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Composite;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Label;
import org.eclipse.swt.widgets.Shell;

public class DynamicComposite 
{
    public static void main(String[] args) {
        new DynamicComposite().start();
    }

    private Composite compositeLeft;
    private Composite compositeRight;
    private Random rand;

    public void start()
    {
        rand = new Random(System.currentTimeMillis()); 

        Display display = new Display();
        Shell shell = new Shell(display);
        shell.setLayout(new GridLayout(2, true));
        shell.setText("Dynamic Columns");

        createRightComposite(shell);
        createLeftComposite(shell);
        createButtonComposite(shell);

        shell.open();
        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
        display.dispose();
    }

    private void createButtonComposite(Shell shell) 
    {
        Label l = new Label(shell, SWT.SEPARATOR|SWT.HORIZONTAL);
        GridData gridData = new GridData(SWT.FILL, SWT.FILL, true, false);
        gridData.horizontalSpan = 2;
        l.setLayoutData(gridData);

        Button button = new Button(shell, SWT.PUSH);
        gridData = new GridData(SWT.CENTER, SWT.CENTER, true, false);
        gridData.horizontalSpan = 2;
        button.setLayoutData(gridData);
        button.setText("Change Columns !!");

        button.addSelectionListener(new SelectionAdapter() {
            public void widgetSelected(SelectionEvent e) {
                if(compositeLeft == null || compositeLeft.isDisposed())
                    return;

                GridLayout layout = (GridLayout)compositeLeft.getLayout();
                int col = rand.nextInt(7);
                if(col == 0)
                    col = 1;
                layout.numColumns = col;
                //compositeLeft.setLayout(layout);
                compositeLeft.layout(); // You need to re-layout your composite
            }
        });
    }

    private void createRightComposite(Shell shell) 
    {
        compositeLeft = new Composite(shell, SWT.NONE);
        GridLayout gridLayout = new GridLayout(3, true);
        gridLayout.marginWidth = 0;
        gridLayout.marginHeight = 0;
        gridLayout.marginLeft = 0;
        gridLayout.marginRight= 0;
        gridLayout.marginTop = 0;
        gridLayout.marginBottom = 0;
        gridLayout.horizontalSpacing = 0;

        gridLayout.verticalSpacing = 0;
        gridLayout.horizontalSpacing = 0;
        compositeLeft.setLayout(gridLayout);
        GridData gridData = new GridData(SWT.FILL, SWT.FILL, true, true);
        compositeLeft.setLayoutData(gridData);

        int counter = 17;
        for(int i=0; i<counter; i++)
        {
            Button button = new Button(compositeLeft, SWT.PUSH);
            button.setText("Button " + (i+1));
            GridData bData = new GridData(SWT.FILL, SWT.FILL, true, false);
            button.setLayoutData(bData);
        }
    }

    private void createLeftComposite(Shell shell) 
    {
        compositeRight = new Composite(shell, SWT.NONE);
        GridLayout gridLayout = new GridLayout(3, true);
        gridLayout.marginWidth = 0;
        gridLayout.marginHeight = 0;
        gridLayout.marginLeft = 0;
        gridLayout.marginRight= 0;
        gridLayout.marginTop = 0;
        gridLayout.marginBottom = 0;
        gridLayout.horizontalSpacing = 0;
        compositeRight.setLayout(gridLayout);

        GridData gridData = new GridData(SWT.FILL, SWT.FILL, true, true);
        compositeRight.setLayoutData(gridData);

        int counter = 7;
        for(int i=0; i<counter; i++)
        {
            Button button = new Button(compositeRight, SWT.PUSH);
            button.setText("Button " + (i+1));
            GridData bData = new GridData(SWT.FILL, SWT.FILL, true, false);
            button.setLayoutData(bData);
        }
    }
} 
```

# c++ - 使用 Visual Studio 构建 32 位和 64 位的提升

> ID：12169791
> 
> 赞同：3
> 
> 时间：2012-08-29T01:36:05.167
> 
> 标签：c++, visual-studio, boost, 32bit-64bit

我已将 boost 配置为使用版本化布局构建 32 位和 64 位库。

但是它在文件名布局中没有包含地址模型，因此 32 位和 64 位库具有相同的文件名，因此不能共享 lib 目录。

同时拥有 32 位和 64 位 boost 库的推荐方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:50:37.623

我解决这个问题的方法是在 b2 命令行上指定 --libdir 并让它指向不同的目录。我将其命名为“libx64”并使布局看起来像这样：

包括 -> 在它下面有 boost，标准 boost 布局库 -> 标准 boost lib 目录，将其用于 32 位库 libx64 -> 仅 64 位库

# android - 访问从 Android 设备的 SD 卡安装的证书

> ID：12169793
> 
> 赞同：0
> 
> 时间：2012-08-29T01:36:22.390
> 
> 标签：android, security, pki, android-2.3-gingerbread, android-keystore

我尝试使用 Java 在 Android 上访问 PKI 安全服务。证书通过***设置->位置和安全->***从 SD 卡安装安装在设备上。

似乎在 ICS 上，证书在***/system/etc/security/cacerts***下共享，而在 GingerBread 上它们位于密钥库中：***/system/etc/security/cacerts.bks***。

在 ICS 上，我发现[KeyChain](http://developer.android.com/reference/android/security/KeyChain.html)可以读取所有已安装的证书，所以我的问题是：

有没有办法访问从**OS < 级别 14**上的 SD 卡安装的证书？

或者

如果有统一的方式来访问从**OS >= 8 级上的 SD 卡安装的证书？**

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:30:06.237

没有办法访问这些，因为只有系统用户有权访问。但是，它们对第三方应用程序并不是很有用，因为只有 WiFi 和 VPN 守护程序可以使用它们。如果您想要自己的密钥库，您可以为您的应用程序创建一个并设置 HttpClient/URLConnection 以使用它。

这里有更多细节：

[http://nelenkov.blogspot.com/2011/12/using-custom-certificate-trust-store-on.html](http://nelenkov.blogspot.com/2011/12/using-custom-certificate-trust-store-on.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-03T13:50:57.430

无法访问这些，因为只有系统用户有权访问。但是，它们对第三方应用程序并不是很有用，因为只有 Wifi 和 VPN 守护程序可以使用它们。如果想要您自己的密钥库，您可以为您的应用创建一个并设置 HttpClient/UTL 连接以使用它。

# php - 如何将一个表中的所有数据解析到另一个页面？

> ID：12169796
> 
> 赞同：0
> 
> 时间：2012-08-29T01:36:37.897
> 
> 标签：php, mysql, forms, post

我已经打印了从数据库中获取的表格，如下所示 ![在此处输入图像描述](../Images/0685bc103cbf71d863d39165eb26b596.png) 还有我的代码

```
print "<form id='form1' name='form1' method='post' action='http://localhost/live/index.php?m=sync&a=update'>";
while($db_field = mysql_fetch_assoc($result))
{
    print "<table border=1 width=100%>";
    print "<tr><td width=5%><input name='taskid' type='text' value=".$db_field['task_id']." readonly=readonly></td>";
    /*print "<td width=10%>".$db_field['task_name']."</td>";*/
    print "<td width=5%><input name='percent' type='text' value=".$db_field['task_percent_complete']." readonly=readonly></td>";
    print "</table>";
}
print "<input name='Sync' type='submit' value='Sync' id='Sync' />";
print "</form>";
mysql_close($db_handle); /*.$db_handle */ /*<---to check the resource link and id*/
}
else{
    print"Failed" ;//.$db_handle; 
```

所以我想知道如何将数据库中的所有数据解析到另一个页面，就像我要发送的操作一样，因为现在当我单击下面的同步按钮时，我只能解析 1 个表中的 1 个数据是我的解析代码另一个页面 下图是解析代码 ![在此处输入图像描述](../Images/3c3b08f2c1ed482ed74695944434a67c.png)

我不知道如何在新页面中显示所有数据...是否需要使用循环？我是新手，非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T01:55:33.960

### 根据以下评论进行编辑：

对于初学者，在第一个代码中，将`print "<table border=1 width=100%>";`and`print "</table>";`部分移到`while`循环之外，因为该表作为两个单独的表生成了两次。

当前代码发生的情况是第二对字段`taskid`并`percent`覆盖第一个字段，因为名称相同，因此您只能在屏幕截图中看到[第二对值](http://img705.imageshack.us/img705/378/capturesta.png)。您需要**将输入字段名称设为数组：`[]`在名称中**放置方括号，以便`taskid`和`percent`自动成为`$_POST`. 这就是 HTML 源代码在表单中的样子：

```
<input name='taskid[]' type='text' ...>
<input name='percent[]' type='text' ...> 
```

*（或者像`taskid_0`,`percent_0`和`taskid_1`,一样手动给它们下标`percent_1`；但是你必须决定何时停止循环或使用可变变量。）*

之后，在您正在处理的目标页面中`$_POST["taskid"]`，它将是一个数组，您可以访问它作为`$_POST["taskid"][0]`,`$_POST["percent"][0]`和`$_POST["taskid"][1]`, `$_POST["percent"][1]`。因此，在更新数据库并生成第二个 html 时循环遍历：

```
print_r($_POST["taskid"]);  // verify that this is an array
print_r($_POST["percent"]); // also an array
$i=0;
foreach ($_POST["taskid"] as $t) {
    // not using $t, that's just for looping convenience
    // do sql insert/update here, i'm just showing how you'd loop the array
    print "<td><input type='text' name='".$_POST["taskid"][$i]."' readonly=readonly></td>";
    print "<td><input type='text' name='".$_POST["percent"][$i]."' readonly=readonly></td>";
    $i++;
} 
```

希望有帮助。

一些提示： 1\. 不要把你的代码的图像，只是粘贴代码。2\. 生成的 HTML 复制粘贴（浏览器 -> 查看源代码）比页面图像更有用。

* * *

*版本 1：*
**1.**如果我理解正确，您想**在一个页面上显示表单**，当用户单击`Sync`( `sumbit`) 时，您希望它**转到另一个处理表单的页面**？

使用[元素](http://www.w3schools.com/tags/att_form_target.asp)（链接）的[`target`属性。`<form>`](http://www.w3schools.com/tags/att_form_target.asp)像：

```
<form action="form_action.php" method="post"> 
```

或者，
**2.**如果您想先**处理表单（同一页面）并将用户发送到另一个页面**：

*   发送[HTTP 302 重定向 + Location 标头](http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx)。

*   您还可以使用以下方法在处理页面后[在 HTML 中设置重定向：](http://en.wikipedia.org/wiki/URL_redirection#Refresh_Meta_tag_and_HTTP_refresh_header)

    ```
    <meta http-equiv="Refresh" content="0; url=http://www.example.com/" /> 
    ```

# ruby-on-rails - 将 Gem 转换为 Ruby 中的插件

> ID：12169798
> 
> 赞同：2
> 
> 时间：2012-08-29T01:37:17.410
> 
> 标签：ruby-on-rails, ruby, rubygems

我目前在我的开发机器上安装了一个 gem。现在我想在生产中使用这个 gem，但由于服务器的一些问题我无法安装它。有没有办法可以将此 gem 转换为插件，以便将其传输到服务器？

如果没有，有没有办法将此宝石从我的机器传输到服务器？

顺便说一句，我使用的是旧版本的 Ruby on Rails (2.1)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:31:22.720

好吧，如果插件与 Rails 2.1 兼容，您应该能够将插件移动到您的`/vendor`目录，它应该可以从那里工作。正如评论中提到的，供应商目录将被删除，并且这种风格的插件将在 Rails 4 中被删除，但对于 Rails 2.1，这无关紧要。

要获取文件，请继续`rubygems.org`查找项目主页。您可能可以在 Github 上找到您感兴趣的插件的源代码（包括与 Rails 2.x 兼容的版本），然后将其克隆到您的供应商目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T14:37:05.467

只需将 gem 的单个源代码文件复制到项目的 lib 目录中即可。[https://github.com/ambethia/smtp-tls/blob/master/lib/smtp-tls.rb](https://github.com/ambethia/smtp-tls/blob/master/lib/smtp-tls.rb)

# matlab - 填充矩阵中的区域

> ID：12169806
> 
> 赞同：0
> 
> 时间：2012-08-29T01:38:39.503
> 
> 标签：matlab, image-processing, graphics

![在此处输入图像描述](../Images/0a8e3dd99d39ab96880c6485e6a10c43.png)

正如您在此图中看到的那样，我有 3 条“线”，它们之间的值为零（或 NaN）不是线性的。

我想通过对“线”部分中的所有值进行平均来创建一个具有单个值的 3 个填充区域的图片，并将它们填充到下面的零区域。

平均不是问题，使用填充或补丁命令也不是问题，我的问题是如何通过它的形状来识别这里不是线性或同质的数据，并有效地创建三片数据，因为矩阵中的真实值必须保留。

将不胜感激任何想法！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:44:11.060

从这样的颜色图中很难分辨，但看起来列的不均匀性要严重得多。如果是这种情况，那么您最好将每列的值与相邻的两个值进行比较并创建一个偏差索引。

试一试——我会用`inhomoge`俚语来形容你不均匀的形象

```
predictedInhomoge=(inhomoge(1:end-2)+inhomoge(3:end))/2;
biasImage=(predictedInhomoge-inhomoge(2:end-1))./(inhomoge(2:end-1)+predictedInhomoge);
image(255*biasImage/max(biasImage(:))); 
```

如果您的蓝色数据实际上是零，而不仅仅是小值，那么上面的 biasImage 将有很多毫无意义的`Inf`值。如果是这种情况，只需将分母从 biasImage 方程中删除，使其不再归一化。

```
biasImage=(predictedInhomoge-inhomoge(2:end-1)); 
```

如果 biasImage 看起来像最高值反映了您的不均匀性，那么您在做生意，只需选择一个阈值并重新计算高于它的值。如果没有，那么我会考虑尝试贝叶斯。

可能不需要说，但任何 NaN 都很容易找到和删除。

# java - 从java调用php web服务

> ID：12169808
> 
> 赞同：0
> 
> 时间：2012-08-29T01:38:58.923
> 
> 标签：java, php, web-services, wsdl

我有下面的 php webservice 代码，我想做什么，这样我就可以在 java 中调用这个 web 服务。我需要先生成wsdl吗？然后用 wsdl 生成 java web 服务存根？我怎么能在java中调用它。以及我需要使用什么工具。谢谢你。

```
<?php include_once("../../lib/config.php"); ?>
<?php
if(!extension_loaded("soap")){
  dl("php_soap.dll");
}

ini_set("soap.wsdl_cache_enabled","0");
$server = new SoapServer("membersearch.wsdl");

function doMyMemberSearch($membernumber){

    $sqlMemberInfo = mysql_query("SELECT * FROM Member_Info WHERE Member_Number = '".$membernumber."'");
    $rowMemberInfo = mysql_fetch_array($sqlMemberInfo);

  $arr[] = array(
           "anniversary" => $rowMemberInfo['Anniversary'],
           "club"  => $rowMemberInfo['Club'],
           "level"=> $rowMemberInfo['Level'],
           "delivery"=> $rowMemberInfo['Delivery'],
           "firstname"=> $rowMemberInfo['First_Name'],
           "lastname"=> $rowMemberInfo['Last_Name'],
           "birthday"=> $rowMemberInfo['Birthday'],
           "spousefirst"=> $rowMemberInfo['Spouse_First'],
           "spouselast"=> $rowMemberInfo['Spouse_Last'],
           "spousebirthday"=> $rowMemberInfo['Spouse_Birthday'],
           "signuploc"=> $rowMemberInfo['Signup_Loc'],
           "status"=> $rowMemberInfo['Status']

         );
             if (isset($rowMemberInfo['Anniversary'])) {
                 return $arr;
             }else {
                 throw new SoapFault("Server","Unknown Member Number '$membernumber'.");
         }
}

$server->AddFunction("doMyMemberSearch");
$server->handle();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T19:53:41.477

WSDL 与实现语言无关。所以不管它是用 PHP、C#、Java 还是任何其他语言编写的。您需要获取服务的 .wsdl 文件。通常，您可以通过将浏览器指向服务 URL 并添加查询字符串“?WSDL”来获得它。

例子：

```
http://www.example.com/theWebService?WSDL 
```

一旦有了这些，您就可以使用 Apache CXF、Apache Axis2、Spring WS 或任何其他 Web 服务框架来生成 Java 客户端存根代码。

# php - 仅显示表中的 5

> ID：12169810
> 
> 赞同：0
> 
> 时间：2012-08-29T01:39:56.610
> 
> 标签：php, limit

我正在尝试让它在您可以看到朋友最新活动的地方，但一次只能显示 5 个。在这 5 个人中，如果你拥有的时间比任何其他朋友都多，那么你可以不止一次拥有一个人。就像它会说“朋友升级技能名称日期”，然后显示五个最近的。我的代码是这样的：

```
function recentActivityF($user){
include "mysql.ws";
$query = mysql_query("SELECT u.* FROM friends uf inner join users u on uf.friend = u.username WHERE uf.user = '$user' ORDER BY u.username") or die(mysql_error());
while($row = mysql_fetch_array($query)){
    $friends = $row['username'];    
            //$query2 = mysql_query("SELECT * FROM recentactivity WHERE user LIKE '".$friends."' ORDER BY time DESC LIMIT 1") or die(mysql_error());
        $query2 = mysql_query("SELECT u.* FROM recentactivity uf inner join friends u on uf.user = u.friend WHERE uf.user LIKE '".$friends."' ORDER BY uf.time DESC LIMIT 1") or die(mysql_error());
            $query3 = mysql_query("SELECT * FROM skills WHERE playerName LIKE '".$friends."' LIMIT 1") or die(mysql_error());
        while($row3 = mysql_fetch_array($query3)){
         while($row2 = mysql_fetch_array($query2)){
        $date = $row2['time'];
        $skillRow = $row2['skill']+1;
        $skill = findType($skillRow)."xp";
        $skillName = findType($skillRow);
                echo'Friend: '.$friends.' Levelled Up '.$skillName.' Date: '.$date.'';
              }
            }
         }
       } 
```

结果应该是：

```
1.)Friend: mark Levelled Up Attack date: 28-Aug-2012 09:48
2.)Friend: matt Levelled Up Strength date: 28-Aug-2012 09:47
3.)Friend: kevin Levelled Up Attack date: 28-Aug-2012 09:46
4.)Friend: mark Levelled Up Strength date: 28-Aug-2012 09:45
5.)Friend: april Levelled Up Magic date: 28-Aug-2012 09:44 
```

我的结果是：

```
1.)Friend: mark Levelled Up Attack date: 28-Aug-2012 09:48
2.)Friend: mark Levelled Up Strength date: 28-Aug-2012 09:45
3.)Friend: matt Levelled Up Strength date: 28-Aug-2012 09:47
4.)Friend: kevin Levelled Up Attack date: 28-Aug-2012 09:46
5.)Friend: april Levelled Up Magic date: 28-Aug-2012 09:44
6.)Friend: april Levelled Up Strength date: 28-Aug-2012 09:45 
```

SQL：

```
 CREATE TABLE `friends` (
  `user` varchar(32) NOT NULL,
  `friend` varchar(32) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `friends` (`user`, `friend`) VALUES
('Cls Prod', 'pro skiller'),
('Cls Prod', 'polo303'),
('Cls Prod', 'pjtips123'),
('Cls Prod', 'tommy0581'),
('Cls Prod', 'sageofmali');

CREATE TABLE `users` (
  `username` varchar(255) NOT NULL DEFAULT '',
  `password` varchar(255) DEFAULT NULL,
  `rights` varchar(255) DEFAULT NULL,
  `online` tinyint(1) NOT NULL,
  `friends` text,
  `donator` double DEFAULT NULL,
  `time` bigint(20) NOT NULL,
  PRIMARY KEY (`username`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `users` (`username`, `password`, `rights`, `online`, `friends`, `donator`, `time`) VALUES
('Cls Prod', 'password', '0', 0, NULL, NULL, 0);

CREATE TABLE `recentactivity` (
  `user` varchar(255) NOT NULL,
  `skill` int(11) NOT NULL,
  `time` varchar(255) NOT NULL,
  `killed` varchar(255) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `recentactivity` (`user`, `skill`, `time`, `killed`) VALUES
('Cls Prod', 2, '27-Aug-2012 16:06:40', ''); 
```

所以评论的 $query2 显示每个朋友的 1 个，但会显示超过 5 个，我想将其限制为仅显示 5 个最近的朋友活动。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:58:18.033

我注意到您正在自己进行技能到技能名称的翻译，所以这应该足够了：

```
SELECT f.user AS username, a.time, a.skill
FROM
  friends f
  JOIN recentactivity a ON(a.user = f.user)
WHERE
 f.friend = $username
GROUP BY a.user -- only one event per friend
ORDER BY a.time DESC
LIMIT 5 
```

在此处查看演示：[http ://sqlfiddle.com/#!2/66f53/6](http://sqlfiddle.com/#!2/66f53/6)

* * *

编辑：这就是您需要做的所有事情：

```
function recentActivityF($user){
  include "mysql.ws";
  $query = <<<EOD
SELECT f.user AS username, a.time, a.skill
FROM
  friends f
  JOIN recentactivity a ON(a.user = f.user)
WHERE
 f.friend = $user
GROUP BY a.user -- only one event per friend
ORDER BY a.time DESC
LIMIT 5
EOD;

  mysql_query($query);
  while($row = mysql_fetch_array($query)) {
    $friend_name = $row['username'];
    $date = $row['time'];
    $skillRow = $row['skill']+1;
    $skillName = findType($skillRow);
    echo'Friend: '.$friend_name.' Levelled Up '.$skillName.' Date: '.$date.'';
  } 
```

PS Standard Stack-Overflow 免责声明：不推荐使用 mysql 扩展，请使用 PDO 或 mysqli。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:41:43.037

## 使用[sql 限制](http://dev.mysql.com/doc/refman/5.0/en/select.html#id820542)。

基本用法是这样的：

```
SELECT * FROM table LIMIT 5 
```

如果要返回记录 6-10：

```
SELECT * FROM table LIMIT 5,5 
```

给我一点时间来看看你的代码，举一个很好的例子。在您的代码中需要使用它的地方并不明显。

* * *

稍微浏览一下您的代码后，您似乎不需要第一个查询。你应该能够做到：

```
SELECT u.*
FROM recentactivity uf
INNER JOIN friends u ON uf.user = u.friend
WHERE u.user = $user
ORDER BY uf.time DESC
LIMIT 5 
```

您可能需要选择更多字段来获取所需的所有信息，但这应该会为您`recentactivity`提供给定用户的所有记录，按最新排序并限制在前 5 名。

# repository - RHEL：/etc/yum.repos.d/ 的默认存储库是什么

> ID：12169811
> 
> 赞同：0
> 
> 时间：2012-08-29T01:40:23.213
> 
> 标签：repository, yum, rhel

我面前有一个全新的 RHEL6 安装。由于某种原因，/etc/yum.repos.d/ 中没有 repo 文件

使用什么默认存储库以便我可以安装软件包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:43:59.327

要下载软件、更新和安全勘误表，您的系统应该注册到 RHN。
有关更多信息，请查看以下页面：

*   [如何访问 RHN Classic 以下载软件、更新和安全勘误表？](https://access.redhat.com/knowledge/node/5023)
*   [红帽网络 (RHN) 常见问题](https://access.redhat.com/knowledge/node/15979)
*   [什么是 Yum，我该如何使用它？](https://access.redhat.com/knowledge/node/9934)

# java - 许多循环的循环策略

> ID：12169815
> 
> 赞同：-6
> 
> 时间：2012-08-29T01:41:13.053
> 
> 标签：java, loops

使用循环策略对于循环策略消化来说太多了 3200 万？请在明天 4 点截止之前通知我。谢谢您的帮助。我知道语法，但概念的斗争。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T01:54:58.010

3200 万条记录几乎是任何东西，但是如果您从数据库接收信息，也许有一种方法可以将其分解为并行块。您可以设计一种策略来执行一系列查询并组合结果。看一下 Java Future 类，它可以让你组成一个工作单元，然后创建一个包含这些单元的列表以并行执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T01:55:03.227

一个从 Java 循环进行 3200 万次数据库查询/更新/插入/删除的程序不是一个好主意……如果您想快速有效地完成工作。

但是，事实仍然是，它完全取决于您在循环中所做的事情......以及其他事情，例如您是否在单个事务中执行此操作。

根据您要执行的操作，有多种技术可以更有效地执行任务；例如批处理、批量插入、智能查询等。但如果没有一些细节，我们无法为您提供建议。

# php - 在 PHP 中，如何检测到输入变量因超出 max_input_vars 而被截断？

> ID：12169818
> 
> 赞同：4
> 
> 时间：2012-08-29T01:41:57.743
> 
> 标签：php, apache, security

我知道 an`E_WARNING`是由 PHP 生成的

> [PHP 警告：未知：输入变量超过 1000](https://stackoverflow.com/q/9673895/367456)

但是如何在我的脚本中检测到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-29T01:55:54.827

“足够接近”的方法是检查`if( count($_POST, COUNT_RECURSIVE) == ini_get("max_input_vars"))`

如果 POST 变量的数量恰好在限制范围内，这将导致误报，但考虑到默认限制为 1000，这不太可能成为问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-31T13:26:29.510

`count($_POST, COUNT_RECURSIVE)`不准确，因为它计算了数组树中的所有节点，而 input_vars 只是终端节点。例如，`$_POST['a']['b'] = 'c'`有 1 个 input_var 但使用`COUNT_RECURSIVE`将返回 3。

`php://input`不能与`enctype="multipart/form-data"`. [http://php.net/manual/en/wrappers.php.php](http://php.net/manual/en/wrappers.php.php)

由于此问题仅在 PHP >= 5.3.9 时出现，我们可以使用匿名函数。以下递归计算数组中的终端。

```
function count_terminals($a) {
  return is_array($a)
           ? array_reduce($a, function($carry, $item) {return $carry + count_terminals($item);}, 0)
           : 1;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-24T06:13:07.163

对我有用的是这个。首先，我把它放在我的脚本/处理程序/前端控制器的顶部。这是错误将被保存的地方（或者 $e0 将为空，这没关系）。

```
$e0 = error_get_last(); 
```

然后我运行了一堆其他的处理，引导我的应用程序，注册插件，建立会话，检查数据库状态——很多事情——不管超过这个条件我都可以完成。然后我检查这个 $e0 状态。如果它不为空，我们有一个错误，所以我退出（假设 App 是一个大类，里面有很多你的魔法）

```
if (null != $e0) {
    ob_end_clean(); // Purge the outputted Warning
    App::bail($e0); // Spew the warning in a friendly way
} 
```

为您自己的状态调整和调整错误处理程序。

注册错误处理程序不会捕获此条件，因为它在您的错误处理程序注册之前就存在。

检查输入变量计数是否等于最大值是不可靠的。

上面的 $e0 将是一个数组，type => 8，line => 0; 该消息将明确提及 input_vars，因此您可以通过正则表达式匹配来创建一个非常狭窄的条件并确保对特定情况的肯定识别。

另请注意，根据 PHP 规范，这是警告而不是错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-30T19:54:10.960

```
function checkMaxInputVars()
{
    $max_input_vars = ini_get('max_input_vars');
    # Value of the configuration option as a string, or an empty string for null values, or FALSE if the configuration option doesn't exist
    if($max_input_vars == FALSE)
        return FALSE;

    $php_input = substr_count(file_get_contents('php://input'), '&');
    $post = count($_POST, COUNT_RECURSIVE);

    echo $php_input, $post, $max_input_vars;

    return $php_input > $post;
}

echo checkMaxInputVars() ? 'POST has been truncated.': 'POST is not truncated.'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-06T11:16:08.090

[`error_get_last()`](http://php.net/manual/en/function.error-get-last.php)在你的脚本中尽快调用（在你有机会导致错误之前，因为它们会掩盖这个错误。）在我的测试中，如果适用，max_input_vars 警告将会出现。

这是我的 max_input_vars 设置为 100 的测试脚本：

```
<?php
if (($error = error_get_last()) !== null) {
    echo 'got error:';
    var_dump($error);
    return;
}
unset($error);

if (isset($_POST['0'])) {
    echo 'Got ',count($_POST),' vars';
    return;
}
?>
<form method="post">
<?php
for ($i = 0; $i < 200; $i++) {
    echo '<input name="',$i,'" value="foo" type="hidden">';
}
?>
<input type="submit">
</form> 
```

达到 var 限制时的输出：

```
got error:
array
  'type' => int 2
  'message' => string 'Unknown: Input variables exceeded 100\. To increase the limit change max_input_vars in php.ini.' (length=94)
  'file' => string 'Unknown' (length=7)
  'line' => int 0 
```

使用 PHP 5.3.10 和 Apache 2.2.22 在 Ubuntu 上测试。

我会犹豫是否明确检查此错误字符串、稳定性（他们可以更改它）和一般的 PHP 良好实践。我更喜欢将所有 PHP 错误转换为异常，就像[这样](http://us3.php.net/manual/en/function.set-error-handler.php#112881)（单独的子类可能有点过头了，但我喜欢这个例子，因为它允许`@`错误抑制。）它会有点不同，`error_get_last()`但应该很容易适应。

我不知道是否还有其他可能被此方法捕获的执行前错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-27T15:52:50.280

类似的东西怎么样：

```
$num_vars = count( explode( '###', http_build_query($array, '', '###') ) ); 
```

你可以对`$_POST`, `$_GET`, `$_COOKIE`,*不管*重复。

仍然不能被认为是 100% 准确，但我想它非常接近它。

# php - 比较多维数组的差异

> ID：12169821
> 
> 赞同：0
> 
> 时间：2012-08-29T01:42:17.783
> 
> 标签：php, mysql, arrays, multidimensional-array, comparison

我有一个相当丑陋的查询，然后使用 php 对查询的结果进行后处理，将每一行变成它自己的多维数组。

我想重构查询，但需要确保我不会以任何方式更改它返回的内容。

所以我想做的是复制原始查询并调用它，存储结果。然后使用我的新查询再次运行该函数。

循环遍历两个结果数组并比较它们是否存在任何差异（键、值、缺失条目、类型差异等）。

最简单的方法是什么？

基本上我知道如何调用这两个查询等，

我想我真正的问题是，最后，一旦我得到了两个结果数组，我该如何检查和比较它们。

我最想得到的是一个并排的“print_r”类型输出，带有一条红线或类似的横穿突出任何差异。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T02:20:03.900

首先，您可以像这样使用[array_uintersect_assoc()](http://php.net/manual/en/function.array-uintersect-assoc.php)。

```
// First get intersecting values
$intersect = array_uintersect_assoc($expected, $results, "checkStructure");
print_r($intersect);

//Then print results that are in intersecting set (e.g. structure of $expected, value  of $results
print_r(array_uintersect_assoc($results, $intersect, "checkStructure"));

function checkStructure($x, $y) {
   if (!is_array($x) && !is_array($y)) {
      return 0;
   }
   if (is_array($x) && is_array($y)) {
       if (count($x) == count($y)) {
           foreach ($x as $key => $value) {
               if(array_key_exists($key,$y)) {
                   $x = checkStructure($value, $y[$key]);
                   if ($x != 0) return -1;
               } else {
                   return -1;
               }
           }
       }
   } else {
       return -1;
   }
   return 0;
} 
```

如果仍然没有，请借助[array_diff()](http://php.net/manual/en/function.array-diff.php) 和[array_diff_assoc()](http://www.php.net/manual/en/function.array-diff-assoc.php)。或尝试以下代码。

```
function multidimensional_array_diff($a1,$a2) 
{ 
   $r = array(); 
   foreach ($a2 as $key => $second) 
   { 
      foreach ($a1 as $key => $first) 
      { 
         if (isset($a2[$key])) 
         { 
            foreach ($first as $first_value) 
            { 
               foreach ($second as $second_value) 
               { 
                   if ($first_value == $second_value) 
                   { 
                      $true = true; 
                      break;    
                   }    
               } 
               if (!isset($true)) 
               { 
                   $r[$key][] = $first_value; 
               } 
               unset($true); 
            } 
         } 
         else 
         { 
            $r[$key] = $first; 
         } 
      } 
   } 
   return $r; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T01:44:34.483

你为什么不做一个`VIEW`把丑陋的查询变成你可以`SELECT`反对的东西呢？您所说的是制作物化视图，这是 MySQL 无法像其他数据库平台那样处理的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:17:22.607

为什么不将每个查询的结果写入文本文件，然后将两个文本文件与`diff`命令进行比较？

# javascript - Backbone.js - id vs idAttribute vs cid

> ID：12169822
> 
> 赞同：47
> 
> 时间：2012-08-29T01:42:29.190
> 
> 标签：javascript, jquery, ajax, backbone.js, underscore.js

我已经研究 Backbone.js 几个星期了，我觉得使用带有模型、路由器和集合的视图很舒服。

我还有一些很大的差距：

1.  `id`, `cid`, 和之间有什么联系`idAttribute`？它们如何相互影响？

2.  新模型究竟何时获得其 ID？服务器负责分配吗？我是否需要将其添加到`defaults`模型中（可能作为函数）？也许该`addNewModel`功能应该这样做？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-08-29T02:08:16.450

> `id`, `cid`, 和之间有什么联系`idAttribute`？它们如何相互影响？

[cid](http://backbonejs.org/#Model-cid)和[id](http://backbonejs.org/#Model-id)都应该是模型的唯一 id，并且可以用于[从](http://backbonejs.org/#Collection-get)集合中[检索](http://backbonejs.org/#Collection-getByCid)模型。

两者之间的区别在于`cid`由backbone.js 客户端分配，如果您没有实际的ID，则很有用，因为模型尚未保存到服务器，或者您甚至没有保存它到一个数据库（也许你正在使用[localStorage](http://documentcloud.github.com/backbone/docs/backbone-localstorage.html)）。该`id`属性应该是来自您的服务器的模型的 id（这就是您的数据库中的 id）。`idAttribute`告诉骨干网应该使用来自您的服务器的哪个“字段”来更新`id`属性，默认情况下，它设置为“id”，但正如[文档](http://backbonejs.org/#Model-idAttribute)中所说，如果您的服务器使用其他东西，您可以将其设置为那个（给出的示例将其设置为“_id”。

> 新模型究竟何时获得其 ID？服务器负责分配吗？我是否需要将其添加到`defaults`模型中（可能作为函数）？也许该`addNewModel`功能应该这样做？

他们应该在保存到[服务器](http://backbonejs.org/#Sync)`idattribute`时获得新的 id，除非您需要对流程进行更多控制，否则您不需要手动设置它（基于）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-29T02:09:44.810

id - 可以在创建模型时手动设置的 id，或者在模型保存在服务器上时填充的 id（请参阅底部的“idAttribute”以查看连接）。这是从服务器加载或更新模型时发送到服务器的 id，例如，对于模型 Person，如果 id 为 123，则将进行此调用，“/person/123”

cid - 唯一 id 设置我的骨干模型供内部使用

idAttribute - 这决定了当模型保存在服务器上时哪个属性将充当唯一 id（默认为“id”），例如，模型在服务器上的唯一键可能由“personId”定义，所以当调用 fetch 时model 会将服务器响应从“personId”映射到主干模型中的 id。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-14T02:54:07.740

`id`是服务器型号 ID，`cid`是客户端 ID。

*   服务器模型：如 Rails 模型
*   客户模型：骨干模型

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-10T11:52:12.180

模型上的属性是根据模型的属性散列中`id`的集合自动分配的。`id`理想情况下，这是您从您正在查询的资源的 REST API 收到的 ID。另一方面，`cid`是临时分配给每个模型的 ID，在确定对象的实际 ID 之前很有用。例如，推送到尚未持久化的集合的模型可以使用 来处理`cid`，直到将其保存在数据库中并为其生成实际 ID。

# ruby-on-rails - mediawiki-gateway gem 上的奇怪无限循环

> ID：12169823
> 
> 赞同：1
> 
> 时间：2012-08-29T01:42:42.020
> 
> 标签：ruby-on-rails, ruby, gem, wikipedia-api, mediawiki-api

代码被困在 REXML 行上的无限循环中。我已经调试过了，奇怪的是，那行代码一次又一次地运行，永远。没有任何意义。

此方法来自 mediawiki-gateway gem [https://github.com/jpatokal/mediawiki-gateway](https://github.com/jpatokal/mediawiki-gateway)

```
# Get a list of pages with matching content in given namespaces
#
# [key] Search key
# [namespaces] Array of namespace names to search (defaults to main only)
# [limit] Maximum number of hits to ask for (defaults to 500; note that Wikimedia Foundation wikis allow only 50 for normal users)
#
# Returns array of page titles (empty if no matches)
def search(key, namespaces=nil, limit=@options[:limit])
  titles = []
  offset = nil
  in_progress = true

  form_data = { 'action' => 'query',
    'list' => 'search',
    'srwhat' => 'text',
    'srsearch' => key,
    'srlimit' => limit
  }
  if namespaces
    namespaces = [ namespaces ] unless namespaces.kind_of? Array
    form_data['srnamespace'] = namespaces.map! do |ns| namespaces_by_prefix[ns] end.join('|')
  end
  begin
    form_data['sroffset'] = offset if offset
    res, offset = make_api_request(form_data, '//query-continue/search/@sroffset')
    titles += REXML::XPath.match(res, "//p").map { |x| x.attributes["title"] }
  end while offset
  titles
end 
```

重现步骤如下

打开一个irb和代码

```
require 'media_wiki'

options = {
      :limit => 50
}
@mw = MediaWiki::Gateway.new('http://en.wikipedia.org/w/api.php', options)
@mw.search('Strange Loop') 
```

不幸的是，它永远不会结束。

# android - 如何指定 AudioRecorder 对象的输入源？

> ID：12169824
> 
> 赞同：3
> 
> 时间：2012-08-29T01:42:43.303
> 
> 标签：android, android-ndk, opensl

我正在`AudioRecord`使用 OpenSL 将音频捕获循环从 Java（使用类）移植到本机库。

原因是在分析之后，捕获循环在我们的测试手机中消耗的 CPU 在 OpenSL 中减少了大约 2%。这是一个意义重大的收获！

Java AudioRecord 类的构造函数接收一个`source`可以配置为多个值的参数（`MIC, CAMCORDER, VOICE_DOWNLINK`等）

到目前为止，我还没有找到 OpenSL 中源参数的等价物（如果存在）。

有人知道是否有办法为 AudioRecorder 对象指定此 Source 参数吗？

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T22:59:49.497

查看 和 中定义的函数和`SLES/OpenSLES_Android.h`常量`SLES/OpenSLES_AndroidConfiguration.h`。当您从 OpenSLES 获取录制对象时，使用`GetInterface()`获取`SL_IID_ANDROIDCONFIGURATION`. 从那里您可以使用返回的指针上的`SetConfiguration()`键调用。`SL_ANDROID_KEY_RECORDING_PRESET``SLAndroidConfigurationItf`

# java - Android：具有双值的字符串格式

> ID：12169826
> 
> 赞同：22
> 
> 时间：2012-08-29T01:43:09.757
> 
> 标签：java, android, string-formatting

我需要使用 Formater 创建一个字符串来显示一些双浮点值。我不清楚如何编码。这是我所拥有的：

```
Double dWeightInKg = 100;
Double dWeightInLbs = 220:
String headerText = String.format("%.0f kg / %.0f lbs",Double.toString(dWeightInKg) , Double.toString(dWeightInLbs)); 
```

我正在寻找以下输出：

```
100 kg / 220 lbs 
```

我的 String.format 行出现运行时异常 - badArgumentType(formater)。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-29T01:46:42.320

%.0f 是浮点数的格式字符串，小数点为 0。

您传递给 String.format 的值是 String、String，当它需要是 Double、Double 时。

您不需要将双精度数转换为字符串。

```
String headerText = String.format("%.0f kg / %.0f lbs", dWeightInKg, dWeightInLbs); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-29T01:46:21.480

这应该工作，

```
DecimalFormat df = new DecimalFormat("#.##");
private String convertToFormat(double value){

    return df.format(value);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T01:47:27.700

您不需要 Double.ToString() 因为您的格式化程序已经在期待一个数字。试试这个：

```
String headerText = String.format("%.0f kg / %.0f lbs", dWeightInKg , dWeightInLbs); 
```

# android - 检查 Db 列数据

> ID：12169831
> 
> 赞同：1
> 
> 时间：2012-08-29T01:44:15.380
> 
> 标签：android, sqlite, if-statement, constructor, onclick

我希望用于将数据插入数据库的 Onclick 方法首先检查数据是否存在。如果有数据，则会出现一条 toast 消息。我怎么能做到这一点。我的 OnClick 如下。我只是为了验证有用户名和密码。如果有，用户会收到一个祝酒词。

```
 @Override
public void onClick (View v) {

    rUsername = rName.getText().toString();
    rPasscode = rCode.getText().toString();

    RegDetails regDetails = new RegDetails();
    regDetails.setrName(bundleRegName);
    regDetails.setpCode(bundleRegCode);
    if(v.getId()==R.id.rtn_button){
        finish();

    }else if(v.getId()==R.id.reg_button){
        insertCredentials(regDetails);
    }
}
    private void insertCredentials(RegDetails regDetails){

        LoginDB androidOpenDBHelper = new LoginDB(this);
        SQLiteDatabase sqliteDB = androidOpenDBHelper.getWritableDatabase();

        ContentValues contentValues = new ContentValues();
        contentValues.put(LoginDB.COLUMN_NAME_USERNAME, rUsername);
        contentValues.put(LoginDB.COLUMN_NAME_PASSWORD, rPasscode);

        long affectedColumnid = sqliteDB.insert(LoginDB.TABLE_NAME_CREDENTIALS, null, contentValues);

        Toast.makeText(getApplicationContext(), "Credentials Saved! Please login" + affectedColumnid, Toast.LENGTH_SHORT).show();
        sqliteDB.close();
        finish();
    }   

  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:51:41.443

sqliteDB.insert 在成功时返回 long 值，在错误时返回 -1。long 值表示 db 中新插入的行的行号。您可以检查此返回值并相应地显示 toast。

请看这里的详细解释，[http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insert(java.lang.String, java.lang.String, android.content.ContentValues)](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insert%28java.lang.String,%20java.lang.String,%20android.content.ContentValues%29)

总之，修改你的代码是这样的，

```
private void insertCredentials(RegDetails regDetails){

    LoginDB androidOpenDBHelper = new LoginDB(this);
    SQLiteDatabase sqliteDB = androidOpenDBHelper.getWritableDatabase();

    ContentValues contentValues = new ContentValues();
    contentValues.put(LoginDB.COLUMN_NAME_USERNAME, rUsername);
    contentValues.put(LoginDB.COLUMN_NAME_PASSWORD, rPasscode);

    long affectedColumnid = sqliteDB.insert(LoginDB.TABLE_NAME_CREDENTIALS, null, contentValues);
    if(affectedColumnid != -1){
    Toast.makeText(getApplicationContext(), "Credentials Saved! Please login" + affectedColumnid, Toast.LENGTH_SHORT).show();
     }else{
     // Display error dialog or smthg
     }
    sqliteDB.close();
    finish();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:01:23.840

阅读您的数据库。如果 cursor.getCount() >0 那意味着数据存在。

```
Cursor cursor = getDbEntries();
if( cursor.getCount() > 0 ){
   // data exists
}
else{
  // data doesnt exist
} 
```

# nosql - NoSql 键/值数据库用于什么

> ID：12169834
> 
> 赞同：8
> 
> 时间：2012-08-29T01:44:42.493
> 
> 标签：nosql, key-value-store

我现在在网上听到了很多关于 nosql 键/值数据库的信息。你能举个例子说明一个是做什么用的。什么样的真实世界数据最适合这类数据库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T02:00:13.353

我认为“[你到底在用 NoSQL 做什么](http://highscalability.com/blog/2010/12/6/what-the-heck-are-you-actually-using-nosql-for.html)”对于 NoSQL 数据库的实际使用案例来说是一本极好的读物。让我在这里引用其中的一些：

*   管理大量非事务性数据流：Apache 日志、应用程序日志、MySQL 日志、点击流等。

*   同步在线和离线数据。这是 CouchDB 所针对的利基市场。在所有负载下的快速响应时间。

*   当复杂连接的查询负载对于 RDBMS 来说太大时，避免重连接。

*   低延迟至关重要的软实时系统。游戏就是一个例子。

*   需要支持各种不同的写入、读取、查询和一致性模式的应用程序。有些系统针对 50% 读取、50% 写入、95% 写入或 95% 读取进行了优化。

*   只读应用程序需要极快的速度和弹性、简单的查询，并且可以容忍稍微陈旧的数据。

*   需要中等性能、读/写访问、简单查询、完全权威数据的应用程序。

*   具有复杂查询要求的只读应用程序。

*   负载平衡以适应数据和使用集中并帮助保持微处理器忙碌。

*   实时插入、更新和查询。

*   分层数据，如线程讨论和部件爆炸。

*   动态表创建。

*   两层应用程序，其中低延迟数据通过快速 NoSQL 接口提供，但数据本身可以由高延迟 Hadoop 应用程序或其他低优先级应用程序计算和更新。

*   顺序数据读取。需要选择正确的底层数据存储模型。B 树可能不是顺序读取的最佳模型。

*   将可能需要更好性能/可扩展性的部分服务切割到自己的系统上。例如，用户登录可能需要高性能，并且此功能可以使用专用服务来实现这些目标。

*   缓存。用于网站和其他应用程序的高性能缓存层。示例是大型强子对撞机使用的数据聚合系统的缓存。

*   表决。

*   实时页面查看计数器。

*   用户注册、个人资料和会话数据。

*   文件、目录管理和内容管理系统。这些都是通过存储复杂文档的能力来促进的，它具有一个整体而不是组织为关系表。类似的逻辑适用于库存、购物车和其他结构化数据类型。

*   归档。存储仍然可以在线访问的大量连续数据流。

*   具有灵活模式的面向文档的数据库，可以处理模式随时间的变化。

*   分析。使用 MapReduce、Hive 或 Pig 执行支持高写入负载的分析查询和横向扩展系统。

# mysql - 创建一个学生ID以字母开头的表 - mysql

> ID：12169838
> 
> 赞同：0
> 
> 时间：2012-08-29T01:45:34.737
> 
> 标签：mysql, primary-key, composite-key

我需要为 ID 以 M 或 I 开头的学生创建一个表格，然后是 7 位数字。我考虑过创建一个表，其中一个字段选择字母 M 或 I，第二个字段是 7 位数字。然后我会用它们来创建一个复合主键。但我认为这不是我要找的。我想要一栏作为学生证。

这是我到目前为止所拥有的：

```
 create table student(    
       student_id_first ENUM('M', 'I')  
       , student_id_digits  char(8) not null    unique  
       , first_name varchar(50)
       , last_name   varchar(50)    
       , Primary Key(student_id_first, student_id_digits)   
    )   ; 
```

想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:51:13.660

您不应该将数据验证放在数据库层中。您还创建了一个复合键，它增加了额外的、不必要的开销。如果在某些时候您需要调整或放松规则，则需要重新定义数据库模式。

这在检索数据并且必须组装实际的学生标识符时也引入了毫无意义的复杂性。除非您有充分的理由将它们分开，否则请将它们放在一起。

只需使用一列并强制执行应用程序中的内容。即使是一个非常基本的 ORM 也会让您能够做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:45:19.023

您最简单的方法是定义一个字段`id char(8)`并使其成为主键。

打开的问题（您的老师可能会问的问题）是“如果某些流氓软件客户端插入不符合您的 id 值业务规则的 id，例如 'K1234567'、'DEADBEEF' 或 'I123'，会发生什么情况？”

你可以给老师的这个问题的潜在有效答案是：

1.  如果我们在生产中，我们会测试软件客户端以防止这种情况发生。
2.  我们可以运行一个日常的生产清除过程来清除带有错误 ID 号的行。
3.  你到底想要什么？这是两个学分课程的一周作业！我已经给了你一个和大多数工资系统一样好的模式！

说真的，从您最初的问题来看，您的老师并没有坚持让您设计一个执行此特定业务规则的 dbms 模式。但只有你知道是不是这样。

# python - 在 Python 中连接字符串的首选方法是哪种？

> ID：12169839
> 
> 赞同：414
> 
> 时间：2012-08-29T01:46:02.510
> 
> 标签：python, python-3.x, string, concatenation

由于 Python`string`无法更改，我想知道如何更有效地连接字符串？

我可以这样写：

```
s += stringfromelsewhere 
```

或像这样：

```
s = []

s.append(somestring)

# later

s = ''.join(s) 
```

在写这个问题时，我发现了一篇关于这个话题的好文章。

[http://www.skymind.com/~ocrow/python_string/](http://www.skymind.com/%7Eocrow/python_string/)

但它在 Python 2.x. 中，所以问题是在 Python 3 中是否发生了一些变化？

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2012-08-29T05:24:50.297

将字符串附加到字符串变量的*最佳*`+`方法是使用or `+=`。这是因为它可读且快速。它们也一样快，您选择哪一种是口味问题，后者是最常见的。以下是该`timeit`模块的时间安排：

```
a = a + b:
0.11338996887207031
a += b:
0.11040496826171875 
```

但是，那些建议使用列表并附加到它们然后加入这些列表的人这样做是因为与扩展字符串相比，将字符串附加到列表可能非常快。在某些情况下，这可能是真的。例如，这里是一百万个单字符字符串的追加，首先追加到字符串，然后追加到列表：

```
a += b:
0.10780501365661621
a.append(b):
0.1123361587524414 
```

好的，事实证明即使结果字符串是一百万个字符长，追加仍然更快。

现在让我们尝试将一千个字符的长字符串附加十万次：

```
a += b:
0.41823482513427734
a.append(b):
0.010656118392944336 
```

因此，结束字符串的长度约为 100MB。那很慢，附加到列表要快得多。那个时间不包括决赛`a.join()`。那么这需要多长时间？

```
a.join(a):
0.43739795684814453 
```

哎呀。事实证明，即使在这种情况下，追加/加入也更慢。

那么这个推荐是从哪里来的呢？蟒蛇2？

```
a += b:
0.165287017822
a.append(b):
0.0132720470428
a.join(a):
0.114929914474 
```

好吧，如果您使用极长的字符串（通常不是，那么在内存中会有 100MB 的字符串，追加/连接会*稍微快一些吗？）*

但真正的关键是 Python 2.3。我什至不会告诉你时间，因为它太慢了，它还没有完成。这些测试突然需要*几分钟*。除了追加/连接，它和后来的 Python 一样快。

是的。在石器时代，Python 中的字符串连接非常缓慢。但是在 2.4 上它不再是（或者至少是 Python 2.4.7），所以使用 append/join 的建议在 2008 年已经过时了，当时 Python 2.3 停止更新，你应该停止使用它。:-)

*（更新：事实证明，当我在 Python 2.3 上更仔细地进行测试时，使用`+`并且`+=`对于两个字符串也更快。使用的建议`''.join()`一定是一个误解）*

但是，这是 CPython。其他实现可能有其他问题。这只是过早优化是万恶之源的另一个原因。除非您首先测量它，否则不要使用所谓的“更快”的技术。

**因此，进行字符串连接的“最佳”版本是使用 + 或 +=**。如果这对你来说很慢，这不太可能，然后做其他事情。

那么为什么我在我的代码中使用大量的附加/连接呢？因为有时它实际上更清楚。特别是当你应该连接在一起的任何东西都应该用空格、逗号或换行符分隔时。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-08-29T01:48:41.507

如果您要连接很多值，那么两者都不是。附加列表是昂贵的。您可以为此使用 StringIO。特别是如果您要通过大量操作来构建它。

```
from cStringIO import StringIO
# python3:  from io import StringIO

buf = StringIO()

buf.write('foo')
buf.write('foo')
buf.write('foo')

buf.getvalue()
# 'foofoofoo' 
```

如果您已经从其他操作返回给您一个完整的列表，那么只需使用`''.join(aList)`

来自python FAQ：[将许多字符串连接在一起的最有效方法是什么？](http://docs.python.org/py3k/faq/programming.html#what-is-the-most-efficient-way-to-concatenate-many-strings-together)

> str 和 bytes 对象是不可变的，因此将许多字符串连接在一起是低效的，因为每个连接都会创建一个新对象。在一般情况下，总运行时间成本是总字符串长度的二次方。
> 
> 要积累许多 str 对象，推荐的习惯用法是将它们放入一个列表并在最后调用 str.join() ：
> 
> ```
> chunks = []
> for s in my_strings:
>     chunks.append(s)
> result = ''.join(chunks) 
> ```
> 
> （另一个相当有效的习惯用法是使用 io.StringIO）
> 
> 要累积许多字节对象，建议的习惯用法是使用就地连接（+= 运算符）扩展 bytearray 对象：
> 
> ```
> result = bytearray()
> for b in my_bytes_objects:
>     result += b 
> ```

* * *

*编辑：我很傻，将结果向后粘贴，使它看起来像附加到列表比 cStringIO 更快。我还添加了对 bytearray/str concat 的测试，以及使用更大字符串的更大列表的第二轮测试。（蟒蛇2.7.3）*

**用于大型字符串列表的 ipython 测试示例**

```
try:
    from cStringIO import StringIO
except:
    from io import StringIO

source = ['foo']*1000

%%timeit buf = StringIO()
for i in source:
    buf.write(i)
final = buf.getvalue()
# 1000 loops, best of 3: 1.27 ms per loop

%%timeit out = []
for i in source:
    out.append(i)
final = ''.join(out)
# 1000 loops, best of 3: 9.89 ms per loop

%%timeit out = bytearray()
for i in source:
    out += i
# 10000 loops, best of 3: 98.5 µs per loop

%%timeit out = ""
for i in source:
    out += i
# 10000 loops, best of 3: 161 µs per loop

## Repeat the tests with a larger list, containing
## strings that are bigger than the small string caching 
## done by the Python
source = ['foo']*1000

# cStringIO
# 10 loops, best of 3: 19.2 ms per loop

# list append and join
# 100 loops, best of 3: 144 ms per loop

# bytearray() +=
# 100 loops, best of 3: 3.8 ms per loop

# str() +=
# 100 loops, best of 3: 5.11 ms per loop 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2018-05-22T18:45:08.327

在 Python >= 3.6 中，新的[f-string](https://docs.python.org/3.6/reference/lexical_analysis.html#f-strings)是连接字符串的有效方法。

```
>>> name = 'some_name'
>>> number = 123
>>>
>>> f'Name is {name} and the number is {number}.'
'Name is some_name and the number is 123.' 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-07-15T13:40:38.347

就稳定性和交叉实现而言，使用“+”就地字符串连接是最差的连接方法，因为它不支持所有值。[PEP8 标准](https://www.python.org/dev/peps/pep-0008/#programming-recommendations)不鼓励这种做法，并鼓励使用 format()、join() 和 append() 以供长期使用。

正如链接的“编程建议”部分所引用的：

> 例如，对于 a += b 或 a = a + b 形式的语句，不要依赖 CPython 对就地字符串连接的有效实现。即使在 CPython 中，这种优化也很脆弱（它只适用于某些类型），并且在不使用引用计数的实现中根本不存在。在库的性能敏感部分，应该使用 ''.join() 形式。这将确保连接在各种实现中以线性时间发生。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-07-15T08:20:06.270

你写这个函数

```
def str_join(*args):
    return ''.join(map(str, args)) 
```

然后你可以简单地打电话到你想要的任何地方

```
str_join('Pine')  # Returns : Pine
str_join('Pine', 'apple')  # Returns : Pineapple
str_join('Pine', 'apple', 3)  # Returns : Pineapple3 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-08-29T01:48:02.503

推荐的方法仍然是使用 append 和 join。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-08-06T17:21:02.110

如果您要连接的字符串是文字，请使用[字符串文字连接](https://docs.python.org/2.0/ref/string-catenation.html)

```
re.compile(
        "[A-Za-z_]"       # letter or underscore
        "[A-Za-z0-9_]*"   # letter, digit or underscore
    ) 
```

如果您想对字符串的一部分（如上）进行评论，或者如果您想使用[原始字符串](https://stackoverflow.com/questions/2081640/what-exactly-do-u-and-r-string-flags-do-in-python-and-what-are-raw-string-l)或三引号作为文字的一部分但不是全部，这很有用。

由于这发生在语法层，它使用零连接运算符。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2018-09-28T18:37:07.290

正如@jdi 提到的那样，Python 文档建议使用`str.join`or`io.StringIO`进行字符串连接。并表示开发人员应该期望`+=`循环中的二次时间，即使自 Python 2.4 以来有优化。正如[这个](https://stackoverflow.com/a/34008199/2072035)答案所说：

> 如果 Python 检测到左侧参数没有其他引用，它会调用`realloc`以尝试通过调整字符串大小来避免复制。这不是你应该依赖的东西，因为它是一个实现细节，而且如果`realloc`最终需要频繁移动字符串，性能无论如何都会降低到 O(n^2)。

我将展示一个天真地依赖`+=`这种优化的真实代码示例，但它并不适用。下面的代码将可迭代的短字符串转换为更大的块以在批量 API 中使用。

```
def test_concat_chunk(seq, split_by):
    result = ['']
    for item in seq:
        if len(result[-1]) + len(item) > split_by: 
            result.append('')
        result[-1] += item
    return result 
```

由于二次时间复杂度，此代码可以运行数小时。以下是建议数据结构的替代方案：

```
import io

def test_stringio_chunk(seq, split_by):
    def chunk():
        buf = io.StringIO()
        size = 0
        for item in seq:
            if size + len(item) <= split_by:
                size += buf.write(item)
            else:
                yield buf.getvalue()
                buf = io.StringIO()
                size = buf.write(item)
        if size:
            yield buf.getvalue()

    return list(chunk())

def test_join_chunk(seq, split_by):
    def chunk():
        buf = []
        size = 0
        for item in seq:
            if size + len(item) <= split_by:
                buf.append(item)
                size += len(item)
            else:
                yield ''.join(buf)                
                buf.clear()
                buf.append(item)
                size = len(item)
        if size:
            yield ''.join(buf)

    return list(chunk()) 
```

还有一个微基准：

```
import timeit
import random
import string
import matplotlib.pyplot as plt

line = ''.join(random.choices(
    string.ascii_uppercase + string.digits, k=512)) + '\n'
x = []
y_concat = []
y_stringio = []
y_join = []
n = 5
for i in range(1, 11):
    x.append(i)
    seq = [line] * (20 * 2 ** 20 // len(line))
    chunk_size = i * 2 ** 20
    y_concat.append(
        timeit.timeit(lambda: test_concat_chunk(seq, chunk_size), number=n) / n)
    y_stringio.append(
        timeit.timeit(lambda: test_stringio_chunk(seq, chunk_size), number=n) / n)
    y_join.append(
        timeit.timeit(lambda: test_join_chunk(seq, chunk_size), number=n) / n)
plt.plot(x, y_concat)
plt.plot(x, y_stringio)
plt.plot(x, y_join)
plt.legend(['concat', 'stringio', 'join'], loc='upper left')
plt.show() 
```

[![微基准](../Images/c9235c612ef4cf2a28d4a8f2e001b47c.png)](https://i.stack.imgur.com/xK7QD.png)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-06-24T11:07:50.140

你可以用不同的方式来做。

```
str1 = "Hello"
str2 = "World"
str_list = ['Hello', 'World']
str_dict = {'str1': 'Hello', 'str2': 'World'}

# Concatenating With the + Operator
print(str1 + ' ' + str2)  # Hello World

# String Formatting with the % Operator
print("%s %s" % (str1, str2))  # Hello World

# String Formatting with the { } Operators with str.format()
print("{}{}".format(str1, str2))  # Hello World
print("{0}{1}".format(str1, str2))  # Hello World
print("{str1} {str2}".format(str1=str_dict['str1'], str2=str_dict['str2']))  # Hello World
print("{str1} {str2}".format(**str_dict))  # Hello World

# Going From a List to a String in Python With .join()
print(' '.join(str_list))  # Hello World

# Python f'strings --> 3.6 onwards
print(f"{str1} {str2}")  # Hello World 
```

我通过以下文章创建了这个小总结。

*   [Python 3 的 f-Strings：改进的字符串格式化语法（指南）](https://realpython.com/python-f-strings/)（还包括速度测试）
*   [格式化的字符串文字](https://docs.python.org/3.6/reference/lexical_analysis.html#f-strings)
*   [字符串连接和格式化](https://www.pythonforbeginners.com/concatenation/string-concatenation-and-formatting-in-python)
*   [在 Python 中拆分、连接和连接字符串](https://realpython.com/python-string-split-concatenate-join/)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-08-29T01:57:35.450

虽然有些过时，但[Code Like a Pythonista: Idiomatic Python](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html)建议`join()`在`+` [本节](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#building-strings-from-substrings)中结束。与[PythonSpeedPerformanceTips](http://wiki.python.org/moin/PythonSpeed/PerformanceTips/)在其关于[字符串连接](http://wiki.python.org/moin/PythonSpeed/PerformanceTips/#String_Concatenation)的部分中一样，具有以下免责声明：

> 本节的准确性对于 Python 的更高版本存在争议。在 CPython 2.5 中，字符串连接相当快，尽管这可能不适用于其他 Python 实现。有关讨论，请参阅 ConcatenationTestCode。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-04-29T03:33:35.333

我的用例略有不同。我必须构建一个查询，其中超过 20 个字段是动态的。我遵循了这种使用格式方法的方法

```
query = "insert into {0}({1},{2},{3}) values({4}, {5}, {6})"
query.format('users','name','age','dna','suzan',1010,'nda') 
```

这对我来说相对简单，而不是使用 + 或其他方式

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-06-24T07:46:20.663

你也可以使用这个（更有效）。（[https://softwareengineering.stackexchange.com/questions/304445/why-is-s-better-than-for-concatenation](https://softwareengineering.stackexchange.com/questions/304445/why-is-s-better-than-for-concatenation)）

```
s += "%s" %(stringfromelsewhere) 
```

# android - 子字符串删除正斜杠？

> ID：12169840
> 
> 赞同：0
> 
> 时间：2012-08-29T01:46:04.440
> 
> 标签：android, string, substring

```
text = Daily 10 am - 5 pm.\\nClosed Thanksgiving and Christmas.

private String activateNewlines( String text ) {
        String temp = text;
        if ( text.contains( "\\n") ) {
            while ( temp.contains( "\\n" ) ) {
                int index = temp.indexOf( "\\n" );
                temp = temp.substring( 0, index ) + temp.substring( index + 1 );
            }
            return temp;
        }

        return text;
    } 
```

我试图摆脱特殊字符的额外斜杠，但由于某种原因，子字符串最终删除了正斜杠。子字符串不喜欢字符串开头的斜线吗？最后的字符串最终变成

```
Daily 10 am - 5 pm.nClosed Thanksgiving and Christmas. 
```

我需要的是

```
Daily 10 am - 5 pm.\nClosed Thanksgiving and Christmas. 
```

编辑：什么最终为我工作：

```
 String temp = text;
    if ( text.contains( "\\n") ) {
        temp = temp.replaceAll( "\\\\n", "\\\n" );
        int x = 5;
        return temp;
    }

    return text; 
```

这实际上允许 TextView 识别换行符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:01:36.737

我有点困惑，但这里是。所以，`"\n"`是一条新线。`"\\n"`是一个反斜杠和一个 n, `\n`。您可以使用 replaceAll 来摆脱它：`string.replaceAll("\n", "")`。这是我感到困惑的地方，我不确定你到底想要什么。如果您想保留新行，那么您必须从您获取它的任何地方正确获取它（例如，您应该获取一个`\n`字符而不是转义版本。）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T02:12:27.400

我认为你应该简单地这样做，

```
string.replaceAll("\\n", "\n") 
```

详细代码，

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    String text = "Daily 10 am - 5 pm.\\nClosed Thanksgiving and Christmas.";
    Log.d("TEMP", "*********************************" + activateNewlines(text));

}

private String activateNewlines( String text ) {
    String temp = text;

    return temp.replaceAll("\\n", "\n");
} 
```

Logcat 输出是，

```
 08-28 19:16:00.944: D/TEMP(9739): *********************************Daily 10 am - 5 pm.\nClosed Thanksgiving and Christmas. 
```

# sql - Oracle - 创建一个临时结果集以在查询中使用

> ID：12169842
> 
> 赞同：20
> 
> 时间：2012-08-29T01:46:11.543
> 
> 标签：sql, oracle

如何在不创建表和插入数据的情况下创建用于 SQL 的临时结果集？

示例：我有一个列表，例如 10 个代码。我想把这个放到一个查询中，然后查询数据库，看看这个临时列表中哪些代码不存在于表中。

如果它已经在一张桌子上，我可以这样做：

```
SELECT
  ITEM_CODE
FROM
  TEMP_ITEMS
MINUS
SELECT
   ITEM_CODE
FROM
   M_ITEMS 
```

他们是一种不使用 PL/SQL 和纯 SQL 在查询之前创建临时行集的方法吗？请不要回答类似：

```
SELECT 1 FROM DUAL
UNION ALL
SELECT 2 FROM DUAL 
```

我正在考虑可以在 IN 语句中提供我的代码的东西，并将其转换为行以供以后的查询中使用。

编辑：所以每个人都知道我在这里的目标，基本上我有时会得到一个产品代码列表，我需要找到列表中的哪些没有在我们的系统中设置。我想要一种快速的方法将其放入 SQL 语句中，以便我可以查看哪些不在系统中（而不是导入数据等）。我通常把这些放到excel中，然后做一个公式，比如：

```
="'"&A1&"'," 
```

这样我就可以创建逗号分隔的列表。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-08-29T01:58:15.880

如果您使用的是 oracle 11g，您可以这样做

```
with t as 
(
 select (column_value).getnumberval() Codes from xmltable('1,2,3,4,5')
)
SELECT * FROM t
WHERE NOT EXISTS (SELECT 1 FROM M_ITEMS M WHERE codes = M.ITEM_CODE); 
```

或者

```
with t as 
(
 select (column_value).getstringval() Codes from xmltable('"A","B","C"')
)
SELECT * FROM t
WHERE NOT EXISTS (SELECT 1 FROM M_ITEMS M WHERE codes = M.ITEM_CODE); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-29T01:48:38.603

我会去：

```
with t as (
    select 1 as val from dual union all
    select 2 as val from dual
)
select . . . 
```

然后在随后的查询块中使用“t”或任何你称之为的东西。

我不确定使用 select 方法的反对意见是什么。. . 只需在 Excel 的列中弹出您想要的值，并通过复制公式为每个值生成代码。然后将结果粘贴回您的查询界面。

如果要使用临时表，可以使用 values 子句。或者，如果您只需要 IN 功能，您可以使用字符串函数。将值放在逗号分隔的列表中，并检查它是否与特定值匹配：

```
where ','||<list>||',' like '%,'||col||',%' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-01T14:07:46.713

这个很有趣，因为它不是一个联合并且适合单个选择。您必须输入带有分隔符的字符串 ('a/b/c/def') 两次：

```
SELECT regexp_substr('a/b/c/def', '[^/]+', 1, ROWNUM) var,
regexp_substr('2/432/sd/fsd', '[^/]+', 1, ROWNUM) var2
FROM dual
CONNECT BY LEVEL <= length(regexp_replace('a/b/c/def', '[^/]', '')) + 1;

var var2
=== ====
a   2
b   432
c   sd
def fsd 
```

注意：学分转到：[https ://stackoverflow.com/a/1381495/463056](https://stackoverflow.com/a/1381495/463056)

所以使用 with 子句会给出类似的结果：

```
with tempo as (
SELECT regexp_substr('a/b/c/def', '[^/]+', 1, ROWNUM) var,
regexp_substr('2/432/sd/fsd', '[^/]+', 1, ROWNUM) var2
FROM dual
CONNECT BY LEVEL <= length(regexp_replace('a/b/c/def', '[^/]', '')) + 1
)
select ... 
```

或者您可以在 from 子句中使用它：

```
select ...
from (
SELECT regexp_substr('a/b/c/def', '[^/]+', 1, ROWNUM) var,
regexp_substr('2/432/sd/fsd', '[^/]+', 1, ROWNUM) var2
FROM dual
CONNECT BY LEVEL <= length(regexp_replace('a/b/c/def', '[^/]', '')) + 1
) tempo 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-29T01:59:23.683

我倾向于两种方法：

**1\. 全局临时表**

虽然你说不想建表，但要看你*为什么*不想建表。如果您选择创建全局临时表，则这些行仅对插入它们的会话可见，因此就像拥有一个私有内存表，但为您提供了真实表的所有好处 - 即能够查询和加入给它。

**2.流水线功能**

您可以创建一个函数，该函数以可以使用`TABLE()`运算符查询的形式返回结果。更多信息在这里：[http ://www.oracle-base.com/articles/misc/pipelined-table-functions.php](http://www.oracle-base.com/articles/misc/pipelined-table-functions.php)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-29T02:23:39.083

它看起来有点做作。但是，假设您使用的是 10g 或更高版本，您可以使用正则表达式将字符串解析为单独的行。例如

```
SQL> ed
Wrote file afiedt.buf

  1   SELECT REGEXP_SUBSTR('a,b,c,def,g', '[^ |,]+', 1, LEVEL) parsed_str
  2     FROM dual
  3* CONNECT BY LEVEL <= REGEXP_COUNT('a,b,c,def,g', '[^ |,]+')
SQL> /

PARSED_STR
--------------------------------------------
a
b
c
def
g 
```

就个人而言，我会发现生成集合的流水线表函数或 PL/SQL 块更容易理解，但如果您必须在 SQL 中执行此操作，则可以。

根据您的编辑，如果您获得的产品代码列表已经在某种文件中，使用外部表将文件公开为表或使用 SQL*Loader 加载似乎更有意义将数据放入您可以查询的表（临时或永久）中。`IN`除了这些选项中的任何一个，如果您真的想首先在 Excel 中操作列表，那么在 Excel 中生成一个列表并将其复制并粘贴到您的查询中会更有意义。在 Excel 中生成以逗号分隔的代码列表只是为了将该列表解析为 SQL 中的组成元素，这似乎步骤太多。

# java - 如何使用java从字符串中删除一个字符

> ID：12169847
> 
> 赞同：1
> 
> 时间：2012-08-29T01:46:41.820
> 
> 标签：java, string, substring

我正在尝试从Java中的字符串中一次删除字符这就是我写的

```
String word = "evelina";
char[] wordCharArr = word.toCharArray();

//Deleting one

for(int i = 0; i< wordCharArr.length; i++)
{
    String answer = word.subString(i);
    if(list.lookup(answer))
        perm.add(answer);
} 
```

这是做什么的：

```
evelina
velina
elina
lina
ina
na
a 
```

但我需要它来做到这一点

```
evelina
velina
eelina
evlina
eveina
evelna
evelia
evelin 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T01:49:22.617

在每次迭代中，您需要跳过该`i-th`字符：

```
for (int i = 0; i < wordCharArr.length; i++) {
  String answer = word.substring(0, i) + word.substring(i + 1);
  if (list.lookup(answer)) {
    perm.add(answer);
  }
} 
```

# java - Eclipse 的 Sphinx4 Beta API 问题

> ID：12169851
> 
> 赞同：0
> 
> 时间：2012-08-29T01:47:10.563
> 
> 标签：java, eclipse, api, beta, cmusphinx

我正在尝试使用 Sphinx 4.0 设置一个简单的 helloworld 演示（这显然是一个测试版？）我下载了源并将其作为源添加到 Eclipse，但问题是，它不能识别很多类。我一直在寻找，据我所知，它想要的课程不存在！例如，该行：

```
import javax.speech.Central; 
```

引发编译器错误，说明无法解析导入。这是我在尝试做 Sphinx4 之前应该下载的更大 API 的一部分吗？它没有说明任何其他 API，但我对这种可能性持开放态度。

如果您愿意，我可以发布所有无法解决的导入列表，我会的，但这意味着查看所有代码，这有点痛苦。我有一种预感，我需要下载 JSAPI，但我不知道哪种实现对 Sphinx4 有好处。

Sphinx4 下载链接：

[http://sourceforge.net/projects/cmusphinx/files/sphinx4/1.0%20beta6/](http://sourceforge.net/projects/cmusphinx/files/sphinx4/1.0%20beta6/)

[http://cmusphinx.sourceforge.net/](http://cmusphinx.sourceforge.net/)

编辑：此外，我发现有几行我认为可能意味着我需要下载 JUnit？同样，我不完全确定如何设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:06:48.340

这个网站的伟大之处在于，在完成任何修订之前输入一个问题并紧张地分析它的简单行为（因为，毕竟，有人会读这个！） 95% 的时间我会在 5 分钟内回答我自己的问题发布它。

无论如何，解决方案很简单，我下载了 junit4-10.jar 和 jsapi.jar 并将它们添加到我的 Java 构建路径中。然后，我遇到了更多错误，我说要从源代码构建（我在这里用 sphinx4 做的），我刚刚下载了已经构建的库，它工作得很好。得到了我想要的 HelloWorld！

# ios - 设置效果 AudioUnit

> ID：12169855
> 
> 赞同：3
> 
> 时间：2012-08-29T01:47:59.130
> 
> 标签：ios, audio, filter, core-audio, audiounit

我正在尝试编写一个 iOS 应用程序，该应用程序从麦克风捕获声音，将其通过高通滤波器，并对处理后的声音进行一些计算。基于 Stefan Popp 的 MicInput（[http://www.stefanpopp.de/2011/capture-iphone-microphone/](http://www.stefanpopp.de/2011/capture-iphone-microphone/)），我试图在I/O 音频单元的输入和输出。设置好 AU 后，`kAudioUnitErr_InvalidElement`当我调用`AudioUnitRender(fxAudioUnit, ...)`I/O AU 的渲染回调时，它给了我一个 10877 错误 ()。

**AudioProcessingWithAudioUnitAPI.h**

```
//
//  AudioProcessingWithAudioUnitAPI.h
//

#import <Foundation/Foundation.h>
#import <AudioToolbox/AudioToolbox.h>
#import <AVFoundation/AVAudioSession.h>

@interface AudioProcessingWithAudioUnitAPI : NSObject

@property (readonly) AudioBuffer                        audioBuffer;
@property (readonly) AudioComponentInstance             audioUnit;
@property (readonly) AudioComponentInstance             fxAudioUnit;

...

@end 
```

**AudioProcessingWithAudioUnitAPI.m**

```
//
//  AudioProcessingWithAudioUnitAPI.m
//

#import "AudioProcessingWithAudioUnitAPI.h"

@implementation AudioProcessingWithAudioUnitAPI

@synthesize isPlaying = _isPlaying;
@synthesize outputLevelDisplay = _outputLevelDisplay;
@synthesize audioBuffer = _audioBuffer;
@synthesize audioUnit = _audioUnit;
@synthesize fxAudioUnit = _fxAudioUnit;

...

#pragma mark Recording callback

static OSStatus recordingCallback(void *inRefCon, 
                              AudioUnitRenderActionFlags *ioActionFlags, 
                              const AudioTimeStamp *inTimeStamp, 
                              UInt32 inBusNumber, 
                              UInt32 inNumberFrames, 
                              AudioBufferList *ioData) {

    // the data gets rendered here
    AudioBuffer buffer;

    // a variable where we check the status
    OSStatus status;

    /**
     This is the reference to the object who owns the callback.
     */
    AudioProcessingWithAudioUnitAPI *audioProcessor = (__bridge AudioProcessingWithAudioUnitAPI*) inRefCon;

    /**
     on this point we define the number of channels, which is mono
     for the iphone. the number of frames is usally 512 or 1024.
     */
    buffer.mDataByteSize = inNumberFrames * 2; // sample size
    buffer.mNumberChannels = 1; // one channel
    buffer.mData = malloc( inNumberFrames * 2 ); // buffer size

    // we put our buffer into a bufferlist array for rendering
    AudioBufferList bufferList;
    bufferList.mNumberBuffers = 1;
    bufferList.mBuffers[0] = buffer; 
```

在下一次`AudioUnitRender`调用中会引发 10887 错误：

```
 status = AudioUnitRender([audioProcessor fxAudioUnit], ioActionFlags, inTimeStamp, inBusNumber, inNumberFrames, &bufferList);
[audioProcessor hasError:status:__FILE__:__LINE__]; 
```

...

```
// process the bufferlist in the audio processor
    [audioProcessor processBuffer:&bufferList];

    //do some further processing

    // clean up the buffer
    free(bufferList.mBuffers[0].mData);

    return noErr;
}

#pragma mark FX AudioUnit render callback
//This just asks for samples to the microphone (I/O AU render)
static OSStatus fxAudioUnitRenderCallback(void *inRefCon, 
                                      AudioUnitRenderActionFlags *ioActionFlags, 
                                      const AudioTimeStamp *inTimeStamp, 
                                      UInt32 inBusNumber, 
                                      UInt32 inNumberFrames, 
                                      AudioBufferList *ioData)
{
    OSStatus retorno;

    AudioProcessingWithAudioUnitAPI* audioProcessor = (__bridge AudioProcessingWithAudioUnitAPI*)inRefCon;

    retorno = AudioUnitRender([audioProcessor audioUnit],
                          ioActionFlags,
                          inTimeStamp,
                          inBusNumber,
                          inNumberFrames,
                          ioData);
    [audioProcessor hasError:retorno:__FILE__:__LINE__];

    return retorno;
}

#pragma mark Playback callback

static OSStatus playbackCallback(void *inRefCon, 
                             AudioUnitRenderActionFlags *ioActionFlags, 
                             const AudioTimeStamp *inTimeStamp, 
                             UInt32 inBusNumber, 
                             UInt32 inNumberFrames, 
                             AudioBufferList *ioData) {    

    /**
     This is the reference to the object who owns the callback.
     */
    AudioProcessingWithAudioUnitAPI *audioProcessor = (__bridge AudioProcessingWithAudioUnitAPI*) inRefCon;

    // iterate over incoming stream and copy to output stream
    for (int i=0; i < ioData->mNumberBuffers; i++) { 
        AudioBuffer buffer = ioData->mBuffers[i];

        // find minimum size
        UInt32 size = min(buffer.mDataByteSize, [audioProcessor audioBuffer].mDataByteSize);

        // copy buffer to audio buffer which gets played after function return
        memcpy(buffer.mData, [audioProcessor audioBuffer].mData, size);

        // set data size
        buffer.mDataByteSize = size; 
    }
    return noErr;
}

#pragma mark - objective-c class methods
-(AudioProcessingWithAudioUnitAPI*)init
{
    self = [super init];
    if (self) {
        self.isPlaying = NO;
        [self initializeAudio];
    }
    return self;
}

-(void)initializeAudio
{    
    OSStatus status;

    // We define the audio component
    AudioComponentDescription desc;
    desc.componentType = kAudioUnitType_Output; // we want to ouput
    desc.componentSubType = kAudioUnitSubType_RemoteIO; // we want in and ouput
    desc.componentFlags = 0; // must be zero
    desc.componentFlagsMask = 0; // must be zero
    desc.componentManufacturer = kAudioUnitManufacturer_Apple; // select provider

    // find the AU component by description
    AudioComponent component = AudioComponentFindNext(NULL, &desc);

    // create audio unit by component
    status = AudioComponentInstanceNew(component, &_audioUnit);

    [self hasError:status:__FILE__:__LINE__];

    // and now for the fx AudioUnit
        desc.componentType = kAudioUnitType_Effect;
    desc.componentSubType = kAudioUnitSubType_HighPassFilter;

    // find the AU component by description
    component = AudioComponentFindNext(NULL, &desc);

    // create audio unit by component
    status = AudioComponentInstanceNew(component, &_fxAudioUnit);

    [self hasError:status:__FILE__:__LINE__];

    // define that we want record io on the input bus
    AudioUnitElement inputElement = 1;
    AudioUnitElement outputElement = 0;

    UInt32 flag = 1;
    status = AudioUnitSetProperty(self.audioUnit, 
                              kAudioOutputUnitProperty_EnableIO, // use io
                              kAudioUnitScope_Input, // scope to input
                              inputElement, // select input bus (1)
                              &flag, // set flag
                              sizeof(flag));
    [self hasError:status:__FILE__:__LINE__];

    UInt32 anotherFlag = 0;
    // disable output (I don't want to hear back from the device)
    status = AudioUnitSetProperty(self.audioUnit, 
                              kAudioOutputUnitProperty_EnableIO, // use io
                              kAudioUnitScope_Output, // scope to output
                              outputElement, // select output bus (0)
                              &anotherFlag, // set flag
                              sizeof(flag));
    [self hasError:status:__FILE__:__LINE__];

    /* 
     We need to specify our format on which we want to work.
     We use Linear PCM cause its uncompressed and we work on raw data.
     for more informations check.

     We want 16 bits, 2 bytes per packet/frames at 44khz 
     */
    AudioStreamBasicDescription audioFormat;
    audioFormat.mSampleRate         = SAMPLE_RATE;
    audioFormat.mFormatID           = kAudioFormatLinearPCM;
    audioFormat.mFormatFlags        = kAudioFormatFlagIsPacked | kAudioFormatFlagIsSignedInteger;
    audioFormat.mFramesPerPacket    = 1;
    audioFormat.mChannelsPerFrame   = 1;
    audioFormat.mBitsPerChannel     = 16; //65536
    audioFormat.mBytesPerPacket     = 2;
    audioFormat.mBytesPerFrame      = 2;

    // set the format on the output stream
    status = AudioUnitSetProperty(self.audioUnit, 
                              kAudioUnitProperty_StreamFormat, 
                              kAudioUnitScope_Output, 
                              inputElement, 
                              &audioFormat, 
                              sizeof(audioFormat));

    [self hasError:status:__FILE__:__LINE__];

    // set the format on the input stream
    status = AudioUnitSetProperty(self.audioUnit, 
                              kAudioUnitProperty_StreamFormat, 
                              kAudioUnitScope_Input, 
                              outputElement, 
                              &audioFormat, 
                              sizeof(audioFormat));
    [self hasError:status:__FILE__:__LINE__];

    /**
     We need to define a callback structure which holds
     a pointer to the recordingCallback and a reference to
     the audio processor object
     */
    AURenderCallbackStruct callbackStruct;

    // set recording callback
    callbackStruct.inputProc = recordingCallback; // recordingCallback pointer
    callbackStruct.inputProcRefCon = (__bridge void*)self;

    // set input callback to recording callback on the input bus
    status = AudioUnitSetProperty(self.audioUnit, 
                              kAudioOutputUnitProperty_SetInputCallback, 
                              kAudioUnitScope_Global, 
                              inputElement, 
                              &callbackStruct, 
                              sizeof(callbackStruct));

    [self hasError:status:__FILE__:__LINE__];

    /*
     We do the same on the output stream to hear what is coming
     from the input stream
     */
    callbackStruct.inputProc = playbackCallback;
    callbackStruct.inputProcRefCon = (__bridge void*)self;

    // set playbackCallback as callback on our renderer for the output bus
    status = AudioUnitSetProperty(self.audioUnit, 
                              kAudioUnitProperty_SetRenderCallback, 
                              kAudioUnitScope_Global, 
                              outputElement,
                              &callbackStruct,
                              sizeof(callbackStruct));
    [self hasError:status:__FILE__:__LINE__];

    callbackStruct.inputProc = fxAudioUnitRenderCallback;
    callbackStruct.inputProcRefCon = (__bridge void*)self;

    // set input callback to input AU
    status = AudioUnitSetProperty(self.fxAudioUnit, 
                              kAudioUnitProperty_SetRenderCallback, 
                              kAudioUnitScope_Global, 
                              0, 
                              &callbackStruct, 
                              sizeof(callbackStruct));

    [self hasError:status:__FILE__:__LINE__];

    // reset flag to 0
    flag = 0;

    /*
     we need to tell the audio unit to allocate the render buffer,
     that we can directly write into it.
     */
    status = AudioUnitSetProperty(self.audioUnit, 
                                  kAudioUnitProperty_ShouldAllocateBuffer,
                              kAudioUnitScope_Output, 
                              inputElement,
                              &flag, 
                              sizeof(flag));

    status = AudioUnitSetProperty(self.fxAudioUnit, 
                              kAudioUnitProperty_ShouldAllocateBuffer,
                              kAudioUnitScope_Output, 
                              0,
                              &flag, 
                              sizeof(flag));

    /*
     we set the number of channels to mono and allocate our block size to
     1024 bytes.
     */
    _audioBuffer.mNumberChannels = 1;
    _audioBuffer.mDataByteSize = 512 * 2;
    _audioBuffer.mData = malloc( 512 * 2 );

    // Initialize the Audio Unit and cross fingers =)
    status = AudioUnitInitialize(self.fxAudioUnit);
    [self hasError:status:__FILE__:__LINE__];

    status = AudioUnitInitialize(self.audioUnit);
    [self hasError:status:__FILE__:__LINE__];

    NSLog(@"Started");

}

//For now, this just copies the buffer to self.audioBuffer
-(void)processBuffer: (AudioBufferList*) audioBufferList
{
    AudioBuffer sourceBuffer = audioBufferList->mBuffers[0];

    // we check here if the input data byte size has changed
    if (_audioBuffer.mDataByteSize != sourceBuffer.mDataByteSize) {
        // clear old buffer
        free(self.audioBuffer.mData);

        // assing new byte size and allocate them on mData
        _audioBuffer.mDataByteSize = sourceBuffer.mDataByteSize;
        _audioBuffer.mData = malloc(sourceBuffer.mDataByteSize);
}

// copy incoming audio data to the audio buffer
memcpy(self.audioBuffer.mData, audioBufferList->mBuffers[0].mData, audioBufferList->mBuffers[0].mDataByteSize);
}

#pragma mark - Error handling

-(void)hasError:(int)statusCode:(char*)file:(int)line 
{
    if (statusCode) {
        printf("Error Code responded %d in file %s on line %d\n", statusCode, file, line);
        exit(-1);
    }
}

@end 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:32:23.363

这类问题经常出现，所以我曾经写过一篇[关于这个主题的小教程](http://teragonaudio.com/article/How-to-do-realtime-recording-with-effect-processing-on-iOS.html)。但是，本指南确实是解决问题的具体方法，我现在觉得更优雅的方法是使用[Novocaine 框架](https://github.com/alexbw/novocaine)，它消除了 iOS 上设置 AudioUnit 时的很多麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-14T06:57:05.327

我找到了一个演示代码，可能有用 4 U；

演示网址：[https ://github.com/JNYJdev/AudioUnit](https://github.com/JNYJdev/AudioUnit)

或者

博客：[http ://atastypixel.com/blog/using-remoteio-audio-unit/](http://atastypixel.com/blog/using-remoteio-audio-unit/)

```
static OSStatus recordingCallback(void *inRefCon, 
                              AudioUnitRenderActionFlags *ioActionFlags, 
                              const AudioTimeStamp *inTimeStamp, 
                              UInt32 inBusNumber, 
                              UInt32 inNumberFrames, 
                              AudioBufferList *ioData) {

// Because of the way our audio format (setup below) is chosen:
// we only need 1 buffer, since it is mono
// Samples are 16 bits = 2 bytes.
// 1 frame includes only 1 sample

AudioBuffer buffer;

buffer.mNumberChannels = 1;
buffer.mDataByteSize = inNumberFrames * 2;
buffer.mData = malloc( inNumberFrames * 2 );

// Put buffer in a AudioBufferList
AudioBufferList bufferList;
bufferList.mNumberBuffers = 1;
bufferList.mBuffers[0] = buffer;

// Then:
// Obtain recorded samples

OSStatus status;

status = AudioUnitRender([iosAudio audioUnit], 
                         ioActionFlags, 
                         inTimeStamp, 
                         inBusNumber, 
                         inNumberFrames, 
                         &bufferList);
checkStatus(status);

// Now, we have the samples we just read sitting in buffers in bufferList
// Process the new data
[iosAudio processAudio:&bufferList];

// release the malloc'ed data in the buffer we created earlier
free(bufferList.mBuffers[0].mData);

return noErr; 
```

}

# ios - iOS App 从本地通知启动时崩溃

> ID：12169858
> 
> 赞同：0
> 
> 时间：2012-08-29T01:48:39.697
> 
> 标签：ios, local, uilocalnotification

我为我的应用设置了每日提醒本地通知。当应用程序在后台时效果很好。但是，当应用程序关闭/未运行时，当用户在通知中点击 LAUNCH 时，应用程序会启动主屏幕，然后返回主屏幕。

我在这里尝试了许多代码解决方案，其中大部分涉及以下内容：

```
- (BOOL)application:(UIApplication *)application 
  didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    UILocalNotification *notification = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
    if (notification) {
        // handle your notification here.
    }
} 
```

但无论我把它放在哪里，应用程序都会启动，但现在变成黑色。
这是我的代码，谁能帮我弄清楚在这里做什么？请不要，我正在使用 Dreamweaver/phonegap 来构建应用程序。

```
//
//  assignmentAppDelegate.m
//  assignment
//
//  Created by Noel Chenier on 23 December, 2011.
//  Copyright  2011\. All rights reserved.
//

#import "assignmentAppDelegate.h"
#import "PhoneGapViewController.h"

@implementation assignmentAppDelegate

- (id) init
{   
    /** If you need to do any extra app-specific initialization, you can do it here
     *  -jm
     **/
    return [super init];
}

/**
 * This is main kick off after the app inits, the views and Settings are setup here.
 */

- (void)applicationDidFinishLaunchingWithOptions:(UIApplication *)application
{   
{ 
     UILocalNotification *localNotification = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
}

    [[UIApplication sharedApplication]
     registerForRemoteNotificationTypes:
     UIRemoteNotificationTypeBadge  |
     UIRemoteNotificationTypeAlert   |
     UIRemoteNotificationTypeSound];

    NSUserDefaults *defaults =[NSUserDefaults standardUserDefaults];
    NSDictionary *appDefaults =[NSDictionary dictionaryWithObject:@"NO" forKey:@"enableNotifications"];
    [defaults registerDefaults:appDefaults];
    [defaults synchronize];   
    [ super applicationDidFinishLaunching:application ];
}
 - (void)application:(UIApplication *)app didReceiveLocalNotification:(UILocalNotification *)notif {
}

-(id) getCommandInstance:(NSString*)className
{
    /** You can catch your own commands here, if you wanted to extend the gap: protocol, or add your
     *  own app specific protocol to it. -jm
     **/
if ([[NSUserDefaults standardUserDefaults] boolForKey:@"enableNotifications"]) { 
    [[UIApplication sharedApplication] cancelAllLocalNotifications];
    [UIApplication sharedApplication].applicationIconBadgeNumber = 0;
    NSCalendar *calender = [NSCalendar autoupdatingCurrentCalendar];
    NSDate *currentDate = [NSDate date];

    NSDateComponents *dateComponents = [calender components:(NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit)
                                                   fromDate:currentDate];

    NSDateComponents *temp = [[NSDateComponents alloc]init];

    [temp setYear:[dateComponents year]];
    [temp setMonth:[dateComponents month]];
    [temp setDay:[dateComponents day]];
    [temp setHour: 9];
    [temp setMinute:00];

    NSDate *fireTime = [calender dateFromComponents:temp];
    [temp release];

    // set up the notifier 
    UILocalNotification *localNotification = [[UILocalNotification alloc]init];
    localNotification.fireDate = fireTime;
    localNotification.timeZone = [NSTimeZone defaultTimeZone];

    localNotification.alertBody = @"Don't Forget Your 365 Day Photo Challenge!";
    localNotification.alertAction = @"LAUNCH";

    localNotification.soundName = UILocalNotificationDefaultSoundName;

    localNotification.repeatInterval = NSMinuteCalendarUnit;
    localNotification.applicationIconBadgeNumber = 0;
    [[UIApplication sharedApplication]scheduleLocalNotification:localNotification];
    [localNotification release];
}
else {[[UIApplication sharedApplication] cancelAllLocalNotifications];}
    return [super getCommandInstance:className];
}

/**
 Called when the webview finishes loading.  This stops the activity view and closes the imageview
 */
- (void)webViewDidFinishLoad:(UIWebView *)theWebView 
{
    return [ super webViewDidFinishLoad:theWebView ];
}

- (void)webViewDidStartLoad:(UIWebView *)theWebView 
{
    return [ super webViewDidStartLoad:theWebView ];
}

/**
 * Fail Loading With Error
 * Error - If the webpage failed to load display an error with the reson.
 */
- (void)webView:(UIWebView *)theWebView didFailLoadWithError:(NSError *)error 
{
    return [ super webView:theWebView didFailLoadWithError:error ];
}

/**
 * Start Loading Request
 * This is where most of the magic happens... We take the request(s) and process the response.
 * From here we can re direct links and other protocalls to different internal methods.
 */
- (BOOL)webView:(UIWebView *)theWebView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    return [ super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType ];
}

- (BOOL) execute:(InvokedUrlCommand*)command
{
    return [ super execute:command];
}

- (void)dealloc
{
    [ super dealloc ];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:16:25.470

对于本地通知，您需要在中添加以下内容：

```
- (void)applicationDidFinishLaunchingWithOptions:(UIApplication *)application
{ 
     UILocalNotification *localNotification = [launchOptions objectForKey:UIApplicationLaunchOptionsLocalNotificationKey];
}

- (void)application:(UIApplication *)app didReceiveLocalNotification:(UILocalNotification *)notif {
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-02T12:10:45.670

事实证明...

我不确定它为什么会崩溃，但是如果其他人遇到此问题，则通知将在您为 relase 构建时启动应用程序....它在构建/运行时似乎不起作用调试或其他状态。

因此，当您运行时，运行 RELEASE，它应该可以正常工作！

# javascript - 拖放事件仅对动态添加的 div 有效

> ID：12169860
> 
> 赞同：1
> 
> 时间：2012-08-29T01:48:50.843
> 
> 标签：javascript, jquery, jquery-events, jquery-ui-selectable

我正在使用此处找到的拖放库：http: [//threedubmedia.com/code/event/drop/](http://threedubmedia.com/code/event/drop/) 但对于动态添加的元素，我似乎无法让它工作不止一次。

我制作了一个 jsfiddle 来演示这个问题。

[http://jsfiddle.net/Rn9gQ/](http://jsfiddle.net/Rn9gQ/)

这里可以点击按钮添加新的div，也可以通过鼠标拖动选择其中一些，但是鼠标拖动完成后就不能再选择了。即使您第一次没有选择。

现在确定我哪里出错了，任何帮助将不胜感激:)

*编辑：在下面添加代码

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<script src="http://threedubmedia.com/inc/js/jquery-1.7.2.js"></script>
<script src="http://threedubmedia.com/inc/js/jquery.event.drag-2.2.js"></script>
<script src="http://threedubmedia.com/inc/js/jquery.event.drag.live-2.2.js"></script>
<script src="http://threedubmedia.com/inc/js/jquery.event.drop-2.2.js"></script>
<script src="http://threedubmedia.com/inc/js/jquery.event.drop.live-2.2.js"></script>
<title>Testpage</title>
</head>
<body>
<script type="text/javascript">
jQuery(function($){
    $('#foo').click(function(){
        $('#main').append($('<div class="drop">foo</div>'))
    });
    $( document )
        .drag("start",function( ev, dd ){
            return $('<div class="selection" />')
                .css('opacity', .65 )
                .appendTo( document.body );
        })
        .drag(function( ev, dd ){
            $( dd.proxy ).css({
                    top: Math.min( ev.pageY, dd.startY ),
                left: Math.min( ev.pageX, dd.startX ),
                height: Math.abs( ev.pageY - dd.startY ),
                width: Math.abs( ev.pageX - dd.startX )
            });
        })
        .drag("end",function( ev, dd ){
            $( dd.proxy ).remove();
        })

        .on("dropstart", ".drop", function(){
            $(this).addClass("active");
        })
        .on("drop", ".drop", function(){
            $(this).toggleClass("dropped");
        })
        .on("dropend", ".drop", function(){
            $(this).removeClass("active");
        });
    $.drop({ multi: true });

});
</script>

<h1>Live adding of selectable elements</h1>
<p>Click and drag to select any number of dashed boxes.</p>

<input type="button" id="foo" value="Add a box"/>
<div id="main"></div>

<style type="text/css">
.selection {
    position: absolute;
    border: 1px solid #89B;
    background: #BCE;
    background-color: #BEC;
    border-color: #8B9;
    }
.drop {
    float: left;
    border: 1px dashed #888;
    background: #EEE;
    text-align: center;
    padding: 20px;
    margin: 0 10px 10px 0;
    }
.dropped {
    background-color: #EBC;
    border-color: #B89;
    }   
.active {  
    background-color: #CEB;
    border-color: #9B8;
    }
</style></body>
</html> 
```

# ruby-on-rails - Rails ActiveRecord 和 PostgreSQL 分区

> ID：12169865
> 
> 赞同：1
> 
> 时间：2012-08-29T01:49:01.933
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, partitioning

我有一个大型 Web 应用程序，它每天将数百万行写入 PostgreSQL 中的分区表（这意味着每天的数据都有一个新表）。

我们正在使用[PostgreSQL 的表继承和分区](http://www.postgresql.org/docs/current/static/ddl-partitioning.html)来加快速度：

由于我们的数据库中有一年的数据，我们无法有效地使用插入触发器将内容路由到正确的表（函数的长度变得非常非常长）。

长话短说，我们需要 ActiveRecord 来知道哪个表`insert`和`update`数据。但是，不要更改用于选择和其他数据库任务的表。

显然，为模型定义表名很简单，但是是否可以仅针对特定操作覆盖表名？

这里有更多细节：

### 数据库：

*   **表：** dashboard.impressions（id、主机、数据、created_on 等）
*   **表：** data.impressions_20120801（继承自dashboard.impressions，约束created_on等于表日期）

`Impression.create :host=>"localhost", :data=>"{...}", created_on=>DateTime.now`应该写入`data.impressions_20120801`表，`Impression.where(:host=>"localhost")`应该在哪里搜索`dashboard.impressions`表，因为它包含*所有*数据。

编辑：我正在运行 PostgreSQL 9.1 和 Rails 3.2.6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:08:04.897

我不做 Rails，所以我无法在 ActiveRecord 方面提供帮助，但如果你不能让 ActiveRecord 做你想做的事，我可以提供一个纯 Pg 后备解决方案。它会花费您一点点插入性能，因此教 ActiveRecord 将插入到正确的位置会更好。

就我个人而言，我只是`INSERT`通过 gem 直接执行 s`pg`并完全绕过 ActiveRecord。如果您不能这样做，或者 ActiveRecord 进行了缓存，这意味着您不应该这样做，请尝试这种备用分区触发器实现。

不要在触发函数中明确列出每个分区，而是考虑`EXECUTE ... USING`插入，并使用您的命名方案生成分区名称。像未经测试的东西：

```
CREATE OR REPLACE FUNCTION partition_trigger() RETURNS trigger AS $$
DECLARE
    target_partition text;
BEGIN
    IF tg_op = 'INSERT' THEN
        target_partition = ( ... work out the partition name ... )
        EXECUTE 'INSERT INTO '||quote_ident(target_partition)||' (col1,col2) VALUES ($1, $2)'
            USING (NEW.col1, NEW.col2);
    END IF;
    RETURN NULL;
END;
$$ LANGUAGE 'plpgsql'; 
```

# python - 使用 Sympy 在 Python 中进行符号集成

> ID：12169867
> 
> 赞同：5
> 
> 时间：2012-08-29T01:49:08.353
> 
> 标签：python, math, symbols, sympy

我想使用 sympy 库将 exp(-(x^2 + y^2)) 集成到 python 中。我可以找到 exp(-(x^2)) 的积分

```
>>> B1 = sympy.exp(-alpha1 * (r1_x**2))
>>> p = integrate(B1,r1_x)
>>> p
pi**(1/2)*erf(alpha1**(1/2)*r1_x)/(2*alpha1**(1/2)) 
```

但是当我想尝试集成 exp(-(x^2 + y^2))

```
>>> B1 = sympy.exp(-alpha1 * (r1_x**2 + r1_y**2))
>>> p = integrate(B1,r1_x)
>>> p
Integral(exp(-alpha1*(r1_x**2 + r1_y**2)), r1_x) 
```

没有输出，python不能取积分！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T01:29:30.110

（我是 SymPy 的首席开发人员）

DSM 是正确的，您可以通过调用 expand 来使其工作，并且没有通用的方法可以做到这一点（因为通常，积分没有封闭形式）。

我只是想指出，如果 SymPy 不能进行具有封闭形式的积分，我们认为这是一个错误，您应该随时在[http://code.google.com/p/sympy/issues](http://code.google.com/p/sympy/issues)报告它.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T02:03:36.970

`sympy`并不总是能识别每一种形式，所以有时你必须给它一点帮助：

```
>>> import sympy
>>> alpha1, r1_x, r1_y = sympy.var("alpha1 r1_x r1_y")
>>> B1 = sympy.exp(-alpha1 * (r1_x**2 + r1_y**2))
>>> B1.integrate(r1_x)
Integral(exp(-alpha1*(r1_x**2 + r1_y**2)), r1_x)
>>> B1.expand(alpha1)
exp(-alpha1*r1_x**2)*exp(-alpha1*r1_y**2)
>>> B1.expand(alpha1).integrate(r1_x)
sqrt(pi)*exp(-alpha1*r1_y**2)*erf(sqrt(alpha1)*r1_x)/(2*sqrt(alpha1)) 
```

# qt - 限制 QFileDialog 中的目录遍历

> ID：12169878
> 
> 赞同：4
> 
> 时间：2012-08-29T01:50:14.627
> 
> 标签：qt

我正在使用 QFileDialog 来选择一个目录。我遇到了无法解决的问题。我花了很多时间在谷歌上搜索这个，但我想出了 zilch。

我指定了起始目录（比如 /home/dhoti/downloads），并且我想禁用该目录上方的导航。例如，不应允许用户访问 /home/dhoti 或 /tmp 等。我该如何实现？

这是我的代码：

```
QFileDialog dlg(this, "Select Firmware Version");
dlg.setDirectory("/home/dhoti/downloads");
dlg.setFileMode(QFileDialog::DirectoryOnly);
dlg.setOption(QFileDialog::ReadOnly, true);
dlg.setOption(QFileDialog::HideNameFilterDetails, true);
dlg.setViewMode(QFileDialog::List);
dlg.setAcceptMode(QFileDialog::AcceptOpen);
dlg.exec();
qDebug() << "selected files: " << dlg.selectedFiles(); 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T08:14:03.277

您可以检测当前目录何时更改，如果超出限制，请将目录设置回限制目录。

您可以通过非阻塞执行对话框并将`QFileDialog::directoryEntered(const QString& directory)`信号连接到您自己的插槽来执行此操作，您可以在其中进行检查。如果检查失败，请将当前目录设置为限制目录`QFileDialog::setDirectory(const QString& directory)`。

**免责声明**我没有尝试过，但如果它不起作用，我会感到惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T22:10:06.757

尝试以下操作：

> 文件对话框.h

```
#ifndef FILEDIALOG_H
#define FILEDIALOG_H

class QEvent;

#include <QFileDialog>
#include <QString>

class FileDialog : public QFileDialog
{
    Q_OBJECT
public:
    explicit FileDialog(QWidget *parent = 0);
public:
    bool eventFilter(QObject *o, QEvent *e);
    void setTopDir(const QString &path);
    QString topDir() const;
private:
    bool pathFits(const QString &path) const;
private slots:
    void checkHistory();
    void checkGoToParent();
    void checkLineEdit(const QString &text);
private:
    QString mtopDir;
};

#endif // FILEDIALOG_H 
```

> 文件对话框.cpp

```
#include "filedialog.h"

#include <QString>
#include <QStringList>
#include <QFileDialog>
#include <QList>
#include <QToolButton>
#include <QDir>
#include <QLineEdit>
#include <QDialogButtonBox>
#include <QEvent>
#include <QKeyEvent>
#include <QAbstractButton>
#include <QCompleter>
#include <QAbstractItemView>
#include <QFileInfo>

FileDialog::FileDialog(QWidget *parent) :
    QFileDialog(parent)
{
    connect(this, SIGNAL(directoryEntered(QString)), this, SLOT(checkHistory()));
    connect(this, SIGNAL(directoryEntered(QString)), this, SLOT(checkGoToParent()));
    connect(findChild<QToolButton *>("backButton"), SIGNAL(clicked()), this, SLOT(checkGoToParent()));
    connect(findChild<QToolButton *>("forwardButton"), SIGNAL(clicked()), this, SLOT(checkGoToParent()));
    connect(findChild<QLineEdit *>("fileNameEdit"), SIGNAL(textChanged(QString)), this, SLOT(checkLineEdit(QString)));
    findChild<QLineEdit *>("fileNameEdit")->installEventFilter(this);
    findChild<QWidget *>("listView")->installEventFilter(this);
    findChild<QWidget *>("treeView")->installEventFilter(this);
    findChild<QLineEdit *>("fileNameEdit")->completer()->popup()->installEventFilter(this);
    setOption(DontUseNativeDialog, true);
}

bool FileDialog::eventFilter(QObject *o, QEvent *e)
{
    if (e->type() != QEvent::KeyPress)
        return false;
    int key = static_cast<QKeyEvent *>(e)->key();
    if (o->objectName() == "listView" || o->objectName() == "treeView")
    {
        return (Qt::Key_Backspace == key && !pathFits(directory().absolutePath()));
    }
    else
    {
        if (Qt::Key_Return != key && Qt::Key_Enter != key)
            return false;
        QString text = findChild<QLineEdit *>("fileNameEdit")->text();
        QString path = QDir::cleanPath(directory().absolutePath() + (text.startsWith("/") ? "" : "/") + text);
        bool a = QDir(text).isAbsolute();
        return !((!a && pathFits(path)) || (a && pathFits(text)));
    }
}

void FileDialog::setTopDir(const QString &path)
{
    if (path == mtopDir)
        return;
    mtopDir = (!path.isEmpty() && QFileInfo(path).isDir()) ? path : QString();
    if (!pathFits(path))
    {
        setDirectory(mtopDir);
        checkHistory();
        checkLineEdit(findChild<QLineEdit *>("fileNameEdit")->text());
    }
    else
    {
        QLineEdit *ledt = findChild<QLineEdit *>("fileNameEdit");
        ledt->setText(ledt->text());
    }
    findChild<QWidget *>("lookInCombo")->setEnabled(mtopDir.isEmpty());
    findChild<QWidget *>("sidebar")->setEnabled(mtopDir.isEmpty());
    checkGoToParent();
}

QString FileDialog::topDir() const
{
    return mtopDir;
}

bool FileDialog::pathFits(const QString &path) const
{
    return mtopDir.isEmpty() || (path.startsWith(mtopDir) && path.length() > mtopDir.length());
}

void FileDialog::checkHistory()
{
    QStringList list = history();
    for (int i = list.size() - 1; i >= 0; --i)
        if (!pathFits(list.at(i)))
            list.removeAt(i);
    setHistory(list);
}

void FileDialog::checkGoToParent()
{
    findChild<QToolButton *>("toParentButton")->setEnabled(pathFits(directory().absolutePath()));
}

void FileDialog::checkLineEdit(const QString &text)
{
    QAbstractButton *btn = findChild<QDialogButtonBox *>("buttonBox")->buttons().first();
    QString path = QDir::cleanPath(directory().absolutePath() + (text.startsWith("/") ? "" : "/") + text);
    bool a = QDir(text).isAbsolute();
    btn->setEnabled(btn->isEnabled() && ((!a && pathFits(path)) || (a && pathFits(text))));
} 
```

这段代码可能看起来很神奇，它并不完美，但它确实有效。我在 Qt 源代码中搜索了 QFileDialog 子对象名称并使用了

> 找孩子（）

方法来访问它们。您只需要使用

> 设置顶部目录（）

方法来指定一个不允许用户进入的目录。

这是使用此类的示例项目：[https ://docs.google.com/file/d/0B3P3dwuDIZ1-Q19FbkFMY2puUE0/edit?usp=sharing](https://docs.google.com/file/d/0B3P3dwuDIZ1-Q19FbkFMY2puUE0/edit?usp=sharing)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-23T07:46:59.767

您可以使用@ololoepepe 的解决方案。并使用以下命令清除顶部组合框中不需要的条目：

```
connect(findChild<QComboBox *>("lookInCombo"), static_cast<void (QComboBox::*)(int)>(&QComboBox::currentIndexChanged), this, &FileDialog::checkComboBox);

void FileDialog::checkComboBox(int index) {
    int i;
    QComboBox *cb = findChild<QComboBox *>("lookInCombo");

    if (index == 0 && cb->model()->rowCount() > 1) {
        for (i = 0; i < cb->model()->rowCount(); ++i) {
            if (!pathFits(cb->model()->index(i, 0).data().toString() + "/")) {
                cb->model()->removeRow(i);
                --i;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-15T11:20:22.503

这是最简单的解决方案，使用限制目录遍历所需的最少步骤。

**想法：**当目录可能被更改时，使用公共信号`directoryEntered(const QString &)`来`QFileDialog`获取通知，在你的一个类中为它实现插槽，并在那里放置一个逻辑来确保该目录是你需要的目录。

```
QFileDialog dialog(this);
    connect(&dialog, SIGNAL(directoryEntered(const QString &)), this, SLOT(onFileDialogDirectoryChanged(const QString &))); 
```

# java - 计算一周的单位价值

> ID：12169881
> 
> 赞同：0
> 
> 时间：2012-08-29T01:50:28.923
> 
> 标签：java, algorithm, datetime, methods

我正在编写一个 Java 程序，它会自动生成一定数量的“单位”供用户执行（实际目的在这个问题中并不重要）。

我正在努力寻找一种好方法来确定下周要为用户提供多少这些“单位”。

计算意图：

*   给出特定周的“单位”
*   根据一周中的实际日期（周一至周五）计算一周的单位
*   占当月所有单位（例如，如果是该月的最后一周，则给出整周所有可能的单位）
*   如果估计，应该高估（由于程序的性质，低估会更糟。）
*   单位不能是小数（因此转换为 int）

我有的变量：

*   当月要做的“单位”数量

我尝试以几种不同的方式做到这一点，到目前为止，我最好的方法是：

```
 public static int getRemainingUnitsThisWeek() {
    return (int) Math.round(((double) getUnitsThisMonth() / (((30 - (double) DateTime.now().getDayOfMonth()+1) / 7) < 1 ? 1 :
            ((30 - (double) DateTime.now().getDayOfMonth()+1) / 7))) / (double)DateTime.now().getDayOfWeek());
 } 
```

我最终遇到的问题（具体来说，我仍然不满意它是如何做到的）是在每月最后一周给出的“单位”中仍然除以星期几（这反过来每天给你一个低得多的数字——即使用户需要在月底之前收到所有的“单位”）。

您可能有任何问题，尽管问！

PS。我在 DateTime.now() 函数中使用的库是[joda-time](http://joda-time.sourceforge.net/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T04:20:55.153

你的描述很混乱，所以我不确定我能不能直接回答。相反，我将回答一个不同的问题，这可能会有所帮助：

> 我有一堆单元要做，这个月剩下的时间要做。我今天应该做多少？

我不了解 Joda，但使用标准`Date`API，您可以使用[此答案](https://stackoverflow.com/questions/3083781/start-and-end-date-of-a-current-month)来获取`Date`表示月底的 a，类似的技术来获取`Date`表示今天结束的 a，并`new Date()`获取当前时间。然后减去他们`getTime()`的 s。然后，您现在可以分配您的单位，因为您知道一天结束和月末的毫秒数。

```
units_today = total_units_to_do * milliseconds_to_end_of_today /
  milliseconds_to_end_of_month; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T04:22:16.990

我不懂java，所以我不会尝试写代码，但我建议你从计算`daysLeftInMonth`和开始`daysLeftInWeek`。一旦你让它们完美地工作，你有两个简单的情况：一个月将在一周之前结束，或者它不会。

在第一种情况下，算法的其余部分是微不足道的。第二步，计算每天应该有多少单位（四舍五入），然后乘以一周中剩余的天数。

# android - 空引用异常

> ID：12169885
> 
> 赞同：-1
> 
> 时间：2012-08-29T01:50:58.877
> 
> 标签：android, unity3d

我得到了这个代码

```
if (Input.GetMouseButton(0)){
var ray = Camera.main.ScreenPointToRay(Input.mousePosition);
        ......
   }` 
```

它适用于我创建的其他项目，但是当我尝试用我的新项目实现它时，它返回一个 nullReferenceException。

```
NullReferenceException
UnityEngine.Camera.ScreenPointToRay (Vector3 position) (at C:/BuildAgent/work/300357e52574df36/Runtime/ExportGenerated/Editor/UnityEngineCamera.cs:276)
Ball.Update () (at Assets/Scripts/Ball.js:51)` 
```

指向这部分的错误 var ray = Camera.main ..... 我尝试在场景中添加灯光，但仍然无法正常工作。请告诉我解决方案是什么。顺便说一句，整个代码旨在移动或拖动对象/球。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T06:24:29.977

[Camera.main](http://docs.unity3d.com/Documentation/ScriptReference/Camera-main.html)返回场景中第一个*启用*的具有“MainCamera”标签的相机。如果`Camera.main`是`null`，您可能删除了一个摄像头并忘记将标签添加到新摄像头，或者所有带有该标签的摄像头都被禁用。

# c# - 如何使用数据表填充列表视图？

> ID：12169892
> 
> 赞同：1
> 
> 时间：2012-08-29T01:51:42.770
> 
> 标签：c#, asp.net, .net, listview

我已经有了数据表。我只需要在列表视图中填写它。问题是我遇到了这个错误：

“System.Web.UI.WebControls.ListView”不包含“DisplayMember”的定义，并且找不到接受“System.Web.UI.WebControls.ListView”类型的第一个参数的扩展方法“DisplayMember”（你是缺少 using 指令或程序集引用？）

我认为列表视图有一个“DisplayMember”属性？顺便说一下，这是 ASP .NET 4.0。

```
namespace Eagle_Replication_Manager
{
    public partial class wfrmMain : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            //on page load, I want to get a database table and populate this list view: 
            lvItems.DataSource = GetSourceDBs();

            //This does not work, error here:
            lvItems.DisplayMember = "Description";
        }

        private DataTable GetSourceDBs()
        {
            using (SqlConnection conn = new SqlConnection(AppVars.connectionString))
            {
                using (SqlCommand cmd = new SqlCommand("SELECT [Description] FROM [Warehouse].[dbo].[Items]", conn))
                {
                    conn.Open();

                    cmd.ExecuteNonQuery();

                    using (SqlDataAdapter da = new SqlDataAdapter(cmd))
                    {
                        using (DataTable dt = new DataTable())
                        {
                            da.Fill(dt);
                            return dt;
                        }
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:58:32.120

这应该有效：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        lvItems.DataSource = GetSourceDBs();
        lvItems.DataBind();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T05:55:57.890

Public void getdataToList(object sender, System.EventArgs e) { SqlConnection conn = new SqlConnection(" << put your connection string >>");

```
 try {
   lvItems.Columns.Clear() ;
   lvItems.Items.Clear();

   conn.Open();
   txtSql.Text ="select * from Employee";

   SqlCommand cmd = conn.CreateCommand();
   cmd.CommandText = txtSql.Text;

   SqlDataReader dr = cmd.ExecuteReader();

   for (int i = 0; i< dr.FieldCount; i++) {
     ColumnHeader ch = new ColumnHeader();
     ch.Text=dr.GetName(i);
     lvItems.Columns.Add(ch);
   }

   ListViewItem itmX; 

   while (dr.Read()) {
     itmX=new ListViewItem(); 
     itmX.Text= dr.GetValue(0).ToString();

     for (int i=1 ; i< dr.FieldCount; i++) {
        itmX.SubItems.Add(dr.GetValue(i).ToString());
     }
     lvwResult.Items.Add(itmX);
   }
   dr.Close();
} catch ( System.Data.SqlClient.SqlException  ex) {
   Console.WriteLine("There was an error in executing the SQL." +
           "\nError Message:" + ex.Message, "SQL");
} finally {
   conn.Close();
} 
```

# java - Java 公历

> ID：12169893
> 
> 赞同：3
> 
> 时间：2012-08-29T01:51:48.360
> 
> 标签：java, timezone

我试图了解 GregorianCalendar 作为经验丰富的 Delphi (pascal) 开发人员学习 java。根据文档，1970 年 1 月 1 日 0:00:00 是计算从这一点开始经过的时间（以秒为单位）的参考。所以，在实验中，我设置了一个新变量

```
GregorianCalendar cal2 = new GregorianCalendar(1970, 0, 1, 0, 0, 0); //January=0, Day=1, Hour=0, Min=0, Sec=0 
```

然后我读了时间

```
cal2.getTimeInMillis() 
```

根据定义，这应该等于零。然而我得到了 18,000,000 毫秒。这是5个小时。我在想这与时区有关吗？任何建议，我在东区。

如果是这样，我该如何解释？我真的很想理解，所以我可以计算两次之间的秒数差异。不明白这一点，我不能继续！谢谢！道格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:17:47.537

```
package so;

import java.util.Calendar;
import java.util.GregorianCalendar;
import java.util.TimeZone;

public class BeginningOfTime {

  public static void main (final String[] args) {

    final Calendar localTZ = new GregorianCalendar (1970, 0, 1, 0, 0, 0);
    dump (localTZ);

    final Calendar utcTZ = new GregorianCalendar ();
    utcTZ.clear ();
    utcTZ.setTimeZone (TimeZone.getTimeZone ("UTC"));
    dump (utcTZ);
  }

  private static final void dump (final Calendar c) {

    System.out.printf ("%s: %d (offset %d)%n",
                       c.getTimeZone ().getDisplayName (),
                       c.getTimeInMillis (),
                       c.get (Calendar.ZONE_OFFSET));
  }
} 
```

产生这个：

```
Eastern Standard Time: 18000000 (offset -18000000)
Coordinated Universal Time: 0 (offset 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:42:10.410

我知道这不能直接回答您的问题，但`GregorianCalendar`可能不是这里最好的方法。我建议您使用[Joda Time 之](http://joda-time.sourceforge.net/index.html)类的库，因为您正在专门寻找诸如[Duration](http://joda-time.sourceforge.net/key_duration.html)和[Period](http://joda-time.sourceforge.net/key_period.html)之类的概念。还可以看看[ThreeTen的](http://sourceforge.net/apps/mediawiki/threeten/index.php?title=ThreeTen)[JSR 310](http://jcp.org/en/jsr/detail?id=310)的 RI ，它计划用于[Java 8](http://www.jcp.org/en/jsr/detail?id=337)。

这是一个以秒为单位计算经过时间的**JodaTime解决方案。**

```
 DateTime start = new DateTime(2012, 3, 25, 0, 0, 0, 0);
  DateTime end = new DateTime(2012, 3, 26, 0, 0, 0, 0); 
  int seconds = Seconds.secondsBetween(start, end).getSeconds(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:04:20.403

我敢打赌它是东部时区。最大的问题是：你必须考虑它吗？您要在同一时区计算/记录时间吗？该类有很多功能，但它变得非常臃肿，但非常方便。

GregorianCalendar 类确实包含时区功能，还可以做一些事情，比如给你 DST 偏移量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-06T03:03:53.237

# javascript - 如何垂直淡出文字，类似于亚马逊的产品描述

> ID：12169895
> 
> 赞同：5
> 
> 时间：2012-08-29T01:52:29.133
> 
> 标签：javascript, css

我试图将一段文本从第一行的黑色淡化为最后一行的浅灰色。我注意到亚马逊通过他们的产品描述来做到这一点。我尝试查看 CSS 代码，但在那里看不到任何东西，我怀疑它是用 javascript 实现的。

我的问题是：我将如何在我自己的文本块上模拟类似的垂直渐变效果？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T12:30:36.133

[这是由http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)生成的完全跨浏览器的解决方案：

演示：[http ://dabblet.com/gist/3511782](http://dabblet.com/gist/3511782)

CSS：

```
#container {
    width: 400px; /*width of text box*/
    height: 200px; /*height of text box*/
    border: 2px solid black; /*it needs some kind of border to look good*/
    overflow: hidden; /*necessary to cut off text without scrollbars. alternatively you can use overflow: auto; or overflow: scroll; to show a scrollbar, but you'll have to tweak the #fader box*/
    position: relative; /*positioning so that #fader can be relative to this*/
}
#fader {
    height: 100px; /*from where it starts to fade to where it ends*/
    position: absolute; /*so it can overlap the #container*/
    width: 400px; /*has to be the same as #container*/
    margin-top: 25%; /*position it right at the bottom of the #container*/
    /* IE9 SVG, needs conditional override of 'filter' to 'none' */
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIwIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNmZmZmZmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
    background: -moz-linear-gradient(top,  rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0)), color-stop(100%,rgba(255,255,255,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* IE10+ */
    background: linear-gradient(to bottom,  rgba(255,255,255,0) 0%,rgba(255,255,255,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00ffffff', endColorstr='#ffffff',GradientType=0 ); /* IE6-8 */
} 
```

HTML：

```
<div id="container"><div id="fader">&nbsp;</div>
Text goes here
</div> 
```

对于 IE9 支持，您需要在`head`:

```
<!--[if gte IE 9]>
  <style type="text/css">
    .gradient {
       filter: none;
    }
  </style>
<![endif]--> 
```

如果您想知道，亚马逊的做法非常相似： http: [//pastebin.com/jkq3nbDJ](http://pastebin.com/jkq3nbDJ)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-29T02:06:17.193

所以你拥有的是一个绝对定位的 div（`.fade-out`在我下面的例子中）淡化效果的高度，带有垂直淡入淡出的背景 png 或 css3 渐变。

HTML

```
<div class="description">
    <p>Text Here</p>
    <div class="fade-out"></div>
</div> 
```

CSS

```
.description { 
    position: relative;
    width: 100%;
}
.fade-out {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 2;
    height: 30px;
    background: ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T01:55:05.627

有不同的方法可以做到这一点。例如，具有渐变背景的绝对定位的 div 或作为渐变的 png。

# security - JRE 1.7 漏洞

> ID：12169902
> 
> 赞同：5
> 
> 时间：2012-08-29T01:53:41.333
> 
> 标签：security, java, java-7

今天，我们的企业架构师提到最近在 JRE 1.7 中发现了一个漏洞。我发现一篇文章[JRE 1.7 漏洞建议禁用 Java](http://www.theregister.co.uk/2012/08/27/disable_java_to_block_exploit/)。

我在工作中运行 JDK 1.5 和 1.6（像许多组织一样，我们不是最新的技术），所以没有问题。

在家里，我正在使用 Java SE 7u6 进行开发。我正在玩 Grails，Spring Security，试图继续学习。

我已经在我的家庭开发机器上的所有浏览器中禁用了 Java 插件。但是，有谁知道我的家用开发机器是否由于安装了 JDK 7 仍然容易受到攻击？我确实在 US-CERT 上找到了这篇声明漏洞通知的文章：[Oracle Java JRE 1.7 Expression.execute() failed to restrict access to privileged code](http://www.kb.cert.org/vuls/id/636312)。

听起来只要浏览器不能运行小程序，我应该没问题（它不应该禁用 Java 插件）。但是，Java Web Start/JNLP 呢？可以调用吗？这是我唯一能想到的，除了小程序，可能会引起关注。

只是想知道我是否需要努力卸载我的 Java SE 7 并退回到 JDK6。

其他人在得知 JRE 1.7 的这个安全问题后做了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T02:02:40.887

最新漏洞的详细信息尚未公开。但是，我的理解是它只影响 Java 浏览器插件。建议的缓解措施是禁用 Java 浏览器插件。没有提到非插件 Java，所以我认为可以安全地假设您的开发机器仅仅因为安装了 Java 7 而不会受到攻击。

> 但是，Java Web Start/JNLP 呢？可以调用吗？

我不这么认为。我认为可以安全地假设发现问题的人会想到潜在的攻击媒介。（但简单的常识表明，您一开始就不想启动随机 JNLP 程序......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T10:46:47.873

我理解这就像您必须访问恶意网站才能被感染一样。所以不，仅仅因为在浏览器中安装了 Java 7，您就不会面临风险。

一些有用的链接：

*   解释漏洞的 US-CERT 链接：

[http://www.kb.cert.org/vuls/id/636312](http://www.kb.cert.org/vuls/id/636312)

*   Oracle 链接到他们的安全警报（不仅是 Java，还包括 Java）：

[http://www.oracle.com/technetwork/topics/security/alerts-086861.html](http://www.oracle.com/technetwork/topics/security/alerts-086861.html)

在撰写本文时（2012 年 8 月 30 日），我看不到 Oracle 尚未为此发出警报。我真的不知道他们是否只在创建补丁后才发出此类警报。根据 US-CERT 网站，甲骨文于 2012 年 8 月 29 日正式收到警报，但他们可能已经知道这一点，因为有关该漏洞的博客报道是在 29 日前几天开始的。

您可以在 Oracle 网站上看到，下一个计划中的“Java SE 重要补丁更新”是在 2012 年 10 月 16 日。他们肯定不会等到那个时候，而是尽快为这个漏洞发布一个带外补丁。（他们以前这样做过）

# codeblocks - code::blocks 不保存工作区项目结构

> ID：12169903
> 
> 赞同：18
> 
> 时间：2012-08-29T01:54:07.297
> 
> 标签：codeblocks

我已经开始使用 C::B 并发现烦人的问题：我通常在工作区中有许多打开的项目，每当我关闭 C::B 时，下一次启动时，我会丢失“项目”选项卡中的所有项目。所以每次我必须从`File->Recent Projects`菜单中恢复它们。有更好的方法吗？我试过了`File->Save Workspace`，`View->Perspectives->Save current`没有任何帮助！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-07T23:45:09.890

转到设置 -> 环境设置 -> 常规设置并将“应用程序启动时”设置更改为“打开默认工作区”，然后按确定。

当您关闭 code::blocks 时，它会要求保存对工作区的更改，请按是。现在，当您启动 code::blocks 时，它应该仍然打开所有项目。

# r - (R, Blotter) 使用 chart.Posn() API 时如何更改图表上交易标记的颜色？

> ID：12169904
> 
> 赞同：3
> 
> 时间：2012-08-29T01:54:10.437
> 
> 标签：r, quantmod, blotter

上下文：我有一个 csv 文件中的交易（交易）列表。我喜欢将这些交易导入 R，然后在图表上绘制交易，这样我就可以直观地看到进场和离场。我终于找到了导入部分（来自吸墨纸演示中的 amzn_test.R），但在更改图表上绘制的交易标记的颜色时遇到了困难。

我注意到chart.Posn.R (package:blotter) 源代码中交易标记的颜色目前是固定的。（文件名：chart.Posn.R，代码网址：[https](https://r-forge.r-project.org/scm/viewvc.php/pkg/blotter/R/chart.Posn.R?view=markup&root=blotter) ://r-forge.r-project.org/scm/viewvc.php/pkg/blotter/R/chart.Posn.R?view=markup&root=blotter ）

```
if(!is.null(nrow(Buys)) && nrow(Buys) >=1 ) (add_TA(Buys,pch=2,type='p',col='green', on=1));
    if(!is.null(nrow(Sells)) && nrow(Sells) >= 1) (add_TA(Sells,pch=6,type='p',col='red', on=1)); 
```

问题：有什么办法可以覆盖这些颜色？如果我不能，有什么办法可以将背景图表主题更改为黑色，以便更好地看到交易标记？我尝试了各种方法来设置chartTheme，但遇到了错误。

要重现错误，请执行以下吸墨纸 amzn_test 演示代码片段，然后执行自定义代码。

演示代码：

```
require(blotter)

# Remove portfolio and account data if run previously
try(rm("portfolio.amzn_port","account.amzn_acct",pos=.blotter))

# load the example data
data("amzn")
currency("USD")
stock("amzn",currency="USD",multiplier=1)
# Initialize the Portfolio
initPortf("amzn_port",symbols="amzn",initDate="2010-01-14")
initAcct("amzn_acct",portfolios="amzn_port",initDate="2010-01-14", initEq=10000)
# look at the transactions data
amzn.trades
# Add the transactions to the portfolio
blotter:::addTxns("amzn_port","amzn",TxnData=amzn.trades,verbose=TRUE)

# update the portfolio stats
updatePortf("amzn_port",Dates="2010-01-14")

# update the account P&L
updateAcct("amzn_acct",Dates="2010-01-14")

# and look at it
chart.Posn("amzn_port","amzn",Dates="2010-01-14") 
```

自定义代码：

```
> black_theme = chartTheme("black")
> chart.Posn("amzn_port","amzn",Dates="2010-01-14", theme=chartTheme("black"))
Error in if (theme$lylab) { : argument is of length zero
> 
```

如果有人能指导我如何解决这个问题，我将不胜感激。

问候，

# android - 缩放和平移 ImageView Android

> ID：12169905
> 
> 赞同：13
> 
> 时间：2012-08-29T01:54:17.737
> 
> 标签：android, imageview, zooming, pinch, pan

我为 ImageView 创建了一个缩放和平移类。

我正在尝试创建的功能。- 它平移单指触摸和移动 - 它缩放和平移两指触摸和移动

在大多数情况下，这非常有效。当我执行以下操作时，它有一个小错误： - 我用一根手指平移（状态：没问题） - 我放下第二根手指，缩放并平移（状态：没问题） - 我松开我的第二根手指（状态：画面有点跳跃）

希望有人能帮我解决这个问题。

我认为它必须与在“case MotionEvent.ACTION_POINTER_UP”中重置 mLastTouchX 和 mLastTouchY 有关

任何帮助将不胜感激！

```
import android.content.Context;
import android.graphics.Canvas;
import android.util.AttributeSet;
import android.util.Log;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.widget.ImageView;

public class MyImageView extends ImageView {

    private static final int INVALID_POINTER_ID = -1;

    private float mPosX;
    private float mPosY;

    private float mLastTouchX;
    private float mLastTouchY;
    private float mLastGestureX;
    private float mLastGestureY;
    private int mActivePointerId = INVALID_POINTER_ID;

    private ScaleGestureDetector mScaleDetector;
    private float mScaleFactor = 1.f;

    public MyImageView(Context context, AttributeSet attrs) {
        this(context, attrs, 0);
        mScaleDetector = new ScaleGestureDetector(getContext(), new ScaleListener());
    }

    public MyImageView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        // Let the ScaleGestureDetector inspect all events.
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                if (!mScaleDetector.isInProgress()) {
                    final float x = ev.getX();
                    final float y = ev.getY();

                    mLastTouchX = x;
                    mLastTouchY = y;
                    mActivePointerId = ev.getPointerId(0);
                }
                break;
            }
            case MotionEvent.ACTION_POINTER_1_DOWN: {
                if (mScaleDetector.isInProgress()) {
                    final float gx = mScaleDetector.getFocusX();
                    final float gy = mScaleDetector.getFocusY();
                    mLastGestureX = gx;
                    mLastGestureY = gy;
                }
                break;
            }
            case MotionEvent.ACTION_MOVE: {

                // Only move if the ScaleGestureDetector isn't processing a gesture.
                if (!mScaleDetector.isInProgress()) {
                    final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                    final float x = ev.getX(pointerIndex);
                    final float y = ev.getY(pointerIndex);

                    final float dx = x - mLastTouchX;
                    final float dy = y - mLastTouchY;

                    mPosX += dx;
                    mPosY += dy;

                    invalidate();

                    mLastTouchX = x;
                    mLastTouchY = y;
                }
                else{
                    final float gx = mScaleDetector.getFocusX();
                    final float gy = mScaleDetector.getFocusY();

                    final float gdx = gx - mLastGestureX;
                    final float gdy = gy - mLastGestureY;

                    mPosX += gdx;
                    mPosY += gdy;

                    invalidate();

                    mLastGestureX = gx;
                    mLastGestureY = gy;
                }

                break;
            }
            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }
            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }
            case MotionEvent.ACTION_POINTER_UP: {
                final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) 
                        >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = ev.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    Log.d("DEBUG", "mActivePointerId");
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = ev.getX(newPointerIndex);
                    mLastTouchY = ev.getY(newPointerIndex);
                    mActivePointerId = ev.getPointerId(newPointerIndex);
                }

                break;
            }
        }

        return true;
    }

    @Override
    public void onDraw(Canvas canvas) {

        canvas.save();

        canvas.translate(mPosX, mPosY);

        if (mScaleDetector.isInProgress()) {
            canvas.scale(mScaleFactor, mScaleFactor, mScaleDetector.getFocusX(), mScaleDetector.getFocusY());
        }
        else{
            canvas.scale(mScaleFactor, mScaleFactor);
        }
        super.onDraw(canvas);
        canvas.restore();
    }

    private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();

            // Don't let the object get too small or too large.
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 10.0f));

            invalidate();
            return true;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-29T18:24:07.490

似乎“onDraw”方法的“else”语句中的 canvas.scale() 需要 mLastGestureX 和 mLastGestureY 来停止跳跃。在“MotionEvent.ACTION_POINTER_UP”案例中返回单指平移时，我还会刷新 mLastTouchX 和 mLastTouchY

这是最终的，可能不适合每个人，因为它不限制平移过去的图像边界，但这应该很容易完成，关于这个话题有很多讨论。

```
import android.content.Context;
import android.graphics.Canvas;
import android.util.AttributeSet;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.widget.ImageView;

public class MyImageView extends ImageView {

    private static final int INVALID_POINTER_ID = -1;

    private float mPosX;
    private float mPosY;

    private float mLastTouchX;
    private float mLastTouchY;
    private float mLastGestureX;
    private float mLastGestureY;
    private int mActivePointerId = INVALID_POINTER_ID;

    private ScaleGestureDetector mScaleDetector;
    private float mScaleFactor = 1.f;

    public MyImageView(Context context, AttributeSet attrs) {
        this(context, attrs, 0);
        mScaleDetector = new ScaleGestureDetector(getContext(), new ScaleListener());
    }

    public MyImageView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        mScaleDetector = new ScaleGestureDetector(context, new ScaleListener());
    }

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        // Let the ScaleGestureDetector inspect all events.
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
            case MotionEvent.ACTION_DOWN: {
                if (!mScaleDetector.isInProgress()) {
                    final float x = ev.getX();
                    final float y = ev.getY();

                    mLastTouchX = x;
                    mLastTouchY = y;
                    mActivePointerId = ev.getPointerId(0);
                }
                break;
            }
            case MotionEvent.ACTION_POINTER_1_DOWN: {
                if (mScaleDetector.isInProgress()) {
                    final float gx = mScaleDetector.getFocusX();
                    final float gy = mScaleDetector.getFocusY();
                    mLastGestureX = gx;
                    mLastGestureY = gy;
                }
                break;
            }
            case MotionEvent.ACTION_MOVE: {

                // Only move if the ScaleGestureDetector isn't processing a gesture.
                if (!mScaleDetector.isInProgress()) {
                    final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                    final float x = ev.getX(pointerIndex);
                    final float y = ev.getY(pointerIndex);

                    final float dx = x - mLastTouchX;
                    final float dy = y - mLastTouchY;

                    mPosX += dx;
                    mPosY += dy;

                    invalidate();

                    mLastTouchX = x;
                    mLastTouchY = y;
                }
                else{
                    final float gx = mScaleDetector.getFocusX();
                    final float gy = mScaleDetector.getFocusY();

                    final float gdx = gx - mLastGestureX;
                    final float gdy = gy - mLastGestureY;

                    mPosX += gdx;
                    mPosY += gdy;

                    invalidate();

                    mLastGestureX = gx;
                    mLastGestureY = gy;
                }

                break;
            }
            case MotionEvent.ACTION_UP: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }
            case MotionEvent.ACTION_CANCEL: {
                mActivePointerId = INVALID_POINTER_ID;
                break;
            }
            case MotionEvent.ACTION_POINTER_UP: {

                final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) 
                        >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
                final int pointerId = ev.getPointerId(pointerIndex);
                if (pointerId == mActivePointerId) {
                    // This was our active pointer going up. Choose a new
                    // active pointer and adjust accordingly.
                    final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                    mLastTouchX = ev.getX(newPointerIndex);
                    mLastTouchY = ev.getY(newPointerIndex);
                    mActivePointerId = ev.getPointerId(newPointerIndex);
                }
                else{
                    final int tempPointerIndex = ev.findPointerIndex(mActivePointerId);
                    mLastTouchX = ev.getX(tempPointerIndex);
                    mLastTouchY = ev.getY(tempPointerIndex);
                }

                break;
            }
        }

        return true;
    }

    @Override
    public void onDraw(Canvas canvas) {

        canvas.save();

        canvas.translate(mPosX, mPosY);

        if (mScaleDetector.isInProgress()) {
            canvas.scale(mScaleFactor, mScaleFactor, mScaleDetector.getFocusX(), mScaleDetector.getFocusY());
        }
        else{
            canvas.scale(mScaleFactor, mScaleFactor, mLastGestureX, mLastGestureY);
        }
        super.onDraw(canvas);
        canvas.restore();
    }

    private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();

            // Don't let the object get too small or too large.
            mScaleFactor = Math.max(0.1f, Math.min(mScaleFactor, 10.0f));

            invalidate();
            return true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-23T14:14:40.503

一个多星期以来，我一直在玩弄这个问题的解决方案，这给我带来了很多问题。不过，我已经大大缩小了这个问题的范围。你上面的解决方案对我不起作用，但我下面的解决方案很接近。问题在于，只要第二根手指被按下或抬起，它就会跳跃。我发现发生这种情况是因为 mPosX 和 mPosY 并不总是真正的变量*应该*代表什么。这就是我的意思：

当调用 ACTION_MOVE 并且代码进入“else”语句（处理缩放事件）时，mPosX 和 mPosY 仅根据**焦点**的变化而变化，*而不是***缩放**的变化。这意味着用两根手指平移有效，用两根手指缩放有效，但 mPosX 和 mPosY 并没有随着缩放的变化而适当改变。

我一直在尝试使用缩放中的差异变化（mScaleDetector.getScaleFactor（））和焦点的差异变化来找出解决此问题的方法，但我似乎无法很好地通过逻辑来找到有效的东西.

另一种解决方案是将所有缩放操作移到 OnTouchListener 中，并完全摆脱 ScaleListener。这意味着更多的数学运算，但这绝对是一个解决方案。

这是onDraw：

```
 @Override
    public void onDraw(Canvas c) {
        c.save();

        if (mScaleDetector.isInProgress()) {
            c.scale(mScaleFactor, mScaleFactor, mLastGestureX - mPosX,
                    mLastGestureY - mPosY);
        } else {
            c.scale(mScaleFactor, mScaleFactor, mLastGestureX, mLastGestureY);
        }

        c.translate(mPosX / mScaleFactor, mPosY / mScaleFactor);

        // drawing instruction here

        c.restore();
    } 
```

以下是代码对手指按压的反应：

```
 @Override
    public boolean onTouchEvent(MotionEvent ev) {
        mScaleDetector.onTouchEvent(ev);

        final int action = ev.getAction();
        switch (action & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN: {
            if (!mScaleDetector.isInProgress()) {
                final float x = ev.getX();
                final float y = ev.getY();

                mLastTouchX = x;
                mLastTouchY = y;

                mActivePointerId = ev.getPointerId(0);
            }
            break;
        }

        case MotionEvent.ACTION_POINTER_DOWN: {
            if (!mScaleDetector.isInProgress()) {
                final float gx = mScaleDetector.getFocusX();
                final float gy = mScaleDetector.getFocusY();

                mLastGestureX = gx;
                mLastGestureY = gy; 
            }
            break;
        }

        case MotionEvent.ACTION_MOVE: {
            if (!mScaleDetector.isInProgress()) {
                Log.i("hi", "SD not in progress");
                final int pointerIndex = ev.findPointerIndex(mActivePointerId);
                final float x = ev.getX(pointerIndex);
                final float y = ev.getY(pointerIndex);

                final float dx = x - mLastTouchX;
                final float dy = y - mLastTouchY;

                mPosX += dx;
                mPosY += dy;

                invalidate();

                mLastTouchX = x;
                mLastTouchY = y;
            } else {
                Log.i("hi", "SD in progress");
                final float gx = mScaleDetector.getFocusX();
                final float gy = mScaleDetector.getFocusY();

                final float gdx = gx - mLastGestureX;
                final float gdy = gy - mLastGestureY;

                mPosX += gdx;
                mPosY += gdy;

                // SOMETHING NEEDS TO HAPPEN RIGHT HERE.

                invalidate();

                mLastGestureX = gx;
                mLastGestureY = gy;
            }

            break;
        }

        case MotionEvent.ACTION_POINTER_UP: {

            final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
            final int pointerId = ev.getPointerId(pointerIndex);
            if (pointerId == mActivePointerId) {
                // This was our active pointer going up. Choose a new
                // active pointer and adjust accordingly.
                final int newPointerIndex = pointerIndex == 0 ? 1 : 0;

                mLastTouchX = ev.getX(newPointerIndex);
                mLastTouchY = ev.getY(newPointerIndex);

                mActivePointerId = ev.getPointerId(newPointerIndex);
            } else {
                final int tempPointerIndex = ev.findPointerIndex(mActivePointerId);

                mLastTouchX = ev.getX(tempPointerIndex);
                mLastTouchY = ev.getY(tempPointerIndex);
            }

            break;
        }
        }

        return true;
    } 
```

虽然它大多不相关，但这里是 ScaleListener：

```
 private class ScaleListener extends ScaleGestureDetector.SimpleOnScaleGestureListener {
        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            mScaleFactor *= detector.getScaleFactor();

            invalidate();
            return true;
        }
    } 
```

同样，这段代码不能完美运行，但非常接近。我已经解释了上面的确切问题，但仍然无法正常工作。我不知道这是否会在您的通知中弹出，汉克，但希望有人会看到并帮助我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-15T19:27:43.130

汉克的解决方案对我有用。我添加了重置功能，以便后续图像可以正常显示。

```
public void ResetView() {
        mScaleFactor = 1.f;
        mPosX = 0.f;
        mPosY = 0.f;
    } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-06-26T22:11:54.500

W/o 查看代码我假设您在有 2 个手指时基于 2 个手指进行位置计算。在这种情况下，你总会得到一个跳跃。

# php - PHP 联系表未验证或发送

> ID：12169912
> 
> 赞同：1
> 
> 时间：2012-08-29T01:55:37.663
> 
> 标签：php, html, email-validation, contact-form

好的...所以我从几个不同的网站和前任的组合中获取了这个 PHP 联系表。我已经与它搏斗了几个小时，但无法弄清楚。

**平心而论，知道 PHP 根本不是我的强项**，（我是一名客户端程序员）。这是下面的代码，如果可以，请帮助。谢谢！

**以下是我看到的一些错误消息：**

最新：*解析错误：语法错误，第 11 行 /home/[...] 中的意外 T_IF*

之前，这是错误消息，但我相信我修复了“空白字段”部分：

*您似乎留下了一个空白字段。*

*请务必填写您的全名、电子邮件地址、主题和详细信息。单击返回箭头返回到联系表。*

*来自：...列表：；收件人地址的语法非法*

*回复：...列表：；收件人地址的语法非法*

*X-Mailer：...列表：；收件人地址的语法非法*

*感谢您，[姓名]，与我们联系！*

**这是HTML**

```
<form action="contactus.php" method="post" class="create">
     <fieldset>
    <legend align="center">Please fill out details below and click "Submit"</legend>
    <div>
     <label for="fullname" class="fixedwidth">Full Name</label>
     <input type="text" name="fullname" id="fullname" class="input2"/>
    </div><br/>
    <div>
     <label for="email" class="fixedwidth">Email</label>
     <input type="text" name="email" id="email" class="input2"/>
    </div><br/>
      <div>
     <label for="subject" class="fixedwidth">Subject</label>
     <input type="text" name="subject" id="subject" class="input2"/>
    </div><br/>
    <div>
    <label for="details" class="fixedwidth">Body</label>
     <textarea id="details" name="details" cols="62" rows="20"></textarea>
    </div>
    <div class="buttonarea">
        <input type="submit" name="submit" id="submit" value="Submit"/>
    </div>

    </fieldset>
   </form> 
```

**...这是contactus.php 文件：**

```
<?php

 $fullname = $_POST['fullname'];
 $subject = $_POST['subject'];
 $details = $_POST['details'];
 $email = $_POST['email'];

//*** Function to check email address */
 function checkemail($email) { 
  $regex = '/^[_a-z0-9-]+(\.[_a-z0-9-]+)@[a-z0-9-]+(\.[a-z0-9-]+)(\.[a-z]{2,3})$/'
   if (eregi($regex ,$email))
   { 
    return true; 
   } 
    else
   { 
    return false; 
   } 
 }

//*** Check to see if the email address is valid */
 else if (checkemail($email) == false) { 
  echo "<br/><br/><p><center>It appears that you have entered an invalid email address.<br/> Please check your email again.</p>";
 }

//*** Mail Processing */
 if ($_POST['submit']) {
 //Check for blank fields
  if ($fullname !== "" && $email !== "" && $subject !== "" && $details !== "") {
   echo "<br/><br/><p><center>It appears that you left a blank field.<br/> 
   Please make sure you fill in your full name, email address, subject, and details.<br/>
   Click the back arrow to return to the contact form.</p>";
  }

//*** Send Mail**/
 $to = 'sgraffito22@gmail.com';
 $fullname = $_POST['fullname'];
 $subject = $_POST['subject'];
 $details = $_POST['details'];

 $headers = 'From: '.$email."\r\n".
 'Reply-To: '.$email."\r\n" .
 'X-Mailer: PHP/' . phpversion();

 mail($to, $fullname, $subject, $details, $headers);
 echo "<br><br><p><center>Thank you, $fullname, for contacting us!</p><br><br>";

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T03:03:54.313

您`;`在末尾缺少 a

```
$regex = '/^[_a-z0-9-]+(\.[_a-z0-9-]+)@[a-z0-9-]+(\.[a-z0-9-]+)(\.[a-z]{2,3})$/' 
```

您的`From`, `Reply-to`, 和`X-Mailer`语法错误可能是由在`'`和`"`in之间切换引起的`$headers`

```
$headers = 'From: '.$email."\r\n".
  'Reply-To: '.$email."\r\n" .
   'X-Mailer: PHP/' . phpversion(); 
```

尝试更改为 -

```
$headers  = "From: ".$email."\r\n";
$headers .= "Reply-To: ".$email."\r\n";
$headers .= "X-Mailer: PHP/" . phpversion(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T06:32:41.207

由于 Sean 给出了正则表达式解决方案，

这是我以前使用的项目正则表达式，

```
$regex= "/^[\.a-z0-9_\-]+[@][a-z0-9_\-]+([.][a-z0-9_\-]+)+[a-z]{1,4}$/i"; 
```

这是 PHP 邮件的另一种替代方案，您需要下载 phpmailer 插件才能使此邮件正常工作。

```
<?php
// mail config start 

$emailAddress = 'youremailhere';
$replyAdress ='yourreceipientemailhere';
$replyName = 'yourreceipientname';
$msgSubject= 'yoursubjecthere';

// mail config end 

// Include the class,
require "phpmailer/class.phpmailer.php";

//Type your message here:
$msg = 'blablayourmessagehere';

//The mailing process begins!!
$mail = new PHPMailer();
$mail->IsMail();

$mail->AddReplyTo($replyAdress, $replyName);
$mail->AddAddress($emailAddress);
$mail->SetFrom($replyAdress, $replyName);
$mail->Subject = "New: ".$replyName." have sent a ".$msgSubject." message";

$mail->MsgHTML($msg);

$mail->Send();

?> 
```

# android - 为什么 Android 平板电脑在 UNC 路径 file:/// 上显示“网页不可用”

> ID：12169916
> 
> 赞同：0
> 
> 时间：2012-08-29T01:56:31.493
> 
> 标签：android, browser, unc

在一个简单的网络上，我在 192.168.1.251 上有机器，在那里我将一个目录共享为“音频”。在网络中的另一台机器上，我在浏览器地址栏中键入“file:///192.168.1.251/audio”，我得到一个目录列表（预期结果）。但是，如果我打开我的 Android 平板电脑并输入相同的内容，它会显示“网页不可用”。Android 设备在我的网络上（我可以访问外部网页，但没有蜂窝连接……唯一的互联网连接是通过我的家庭网络）。

编辑 8/29：我添加了 Astro 文件管理器和 SMB 模块，现在我可以复制文件了。但老实说，不能只从 Windows 盒子流式传输似乎很疯狂。我想我会在 Window box 上架起一个小型网络服务器！哎呀！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T03:04:53.537

使用`http://192.168.1.251/audio`而不是`file:///192.168.1.251/audio`
不要忘记添加互联网权限
`<uses-permission android:name="android.permission.INTERNET"/>`

# c++ - IntStack 的 C++ 递归打印函数

> ID：12169917
> 
> 赞同：0
> 
> 时间：2012-08-29T01:56:53.690
> 
> 标签：c++, recursion

我的任务是创建一个打印函数，该函数使用递归来打印单链表（堆栈）的数据。到目前为止，这是我的代码：

IntStack.h

```
#include <iostream>

struct NodeType
{
    int data;
    NodeType *next;
};

class IntStack
{
private:
    NodeType root;
    int count;
public:
    IntStack(void);
    ~IntStack(void);

    void push(int);
    int pop(void);
    bool isEmpty(void);
    void print(NodeType&);
    int getSize() const;
    NodeType* getRoot();
}; 
```

集成堆栈.cpp

```
#include "IntStack.h"

IntStack::IntStack()
{
    count = 0;
}

IntStack::~IntStack()
{

}

void IntStack::push(int num)
{
    NodeType newNode;
    newNode.data = num;

    newNode.next = &root;
    root = newNode;

    ++count;
}

int IntStack::pop(void)
{
    // get root data
    // set root equal to root.next
    int num = root.data;
    root = *root.next;
    --count;
    return num;
}

bool IntStack::isEmpty(void)
{
    return (count == 0);
}

void print(NodeType *node)
{
    if (node->next != NULL) {
        std::cout << node->data << " " << std::endl;
        print(node->next);
    }
}

NodeType* IntStack::getRoot()
{
    return &root;
}

int IntStack::getSize() const
{
    return count;
} 
```

主文件

```
#include <iostream>
#include "IntStack.h"

int main()
{
    IntStack stack;
    stack.push(7);
    stack.push(10);
    stack.push(13);
    stack.push(43);
    stack.push(23);
    stack.push(5);
    stack.push(32);
    stack.push(8);

    std::cout << stack.getSize() << " item(s) in the stack." << std::endl;
    std::cout << "Pop item off stack: " << stack.pop() << std::endl;
    std::cout << stack.getSize() << " item(s) in the stack." << std::endl;

    stack.print(stack.getRoot());

    return 0;
} 
```

我在 main.cpp 中的 stack.print(stack.getRoot()) 函数上收到错误：

> main.cpp:28:17：对“NodeType”类型的非 const 左值引用无法绑定到“NodeType *”类型的临时对象

显然，我没有发送指向函数的指针，但我尝试了各种方法来发送根节点，但没有成功。非常感谢有关我应该如何进行的任何信息。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:29:23.437

首先，您应该在堆上而不是在堆栈上分配节点。简而言之，要让堆分配而不是堆栈分配，您必须使用“new”关键字。

```
// node1 is stack allocated
NodeType node1;

// node2 is heap allocated
NodeType *node2 = new NodeType; 
```

原因是，当函数返回时，分配给堆栈的任何内容都会过期（被删除）。在您的情况下，您需要将节点保留在函数末尾之外。

所以在构造函数中更改`NodeType root;`并将`NodeType *root;`root 设置为 NULL 。

您将不得不更改您的推送功能，以使您的程序现在可以工作。

```
void IntStack::push(int num)
{
    NodeType *newNode = new NodeType; // heap allocated now
    newNode->data = num; // use appropriate dereferencing operator "->"

    newNode->next = root; // root is now a pointer

    root = newNode;

    ++count;
} 
```

要删除一个节点，你会做相反的事情

```
int IntStack::pop(void)
{
    int num = root->data;

    NodeType *tmp = root; // don't lose the pointer
    root = root->next;
    delete tmp; // heap allocated memory must be freed if it is allocated

    --count;

    return num;
} 
```

~~向 NodeType 添加构造函数以将变量设置为 NULL 旁边也是一个好主意，因为~~在递归打印节点时，您必须知道何时到达最后一个节点，这将由“next " 指针为 NULL。

**编辑：** 我在上面划掉了一条线。由于您将 root 初始化为 NULL，并且`next`始终设置为 root 的值，`NodeType`因此不需要构造函数。但是，您的 print 函数中的条件应该是`if (node != NULL)`而不是`if (node->next != NULL)`. 考虑您有 0 或 1 个节点的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:00:59.640

您`void print(NodeType&);`在头文件中写入，而不是像在 .cpp 文件中那样使用指针版本。将更改`&`为 a `*`，它将起作用。

（顺便说一句，真的很奇怪的模式）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:05:14.813

您的原型与您的功能使用不匹配。

```
void print(NodeType&) 
```

在您的实现文件中，您具有以下内容

```
void print(NodeType *node) 
```

我相信您想要使用 NodeType* 之一，因此请在您的头文件中更改它以反映这一点。

我看到的另一行让我感到困惑的是 print 函数中的 print 行。

```
std::cout << node->data << " " << std::endl; 
```

为什么每次打印后都要打印一个换行符？我建议将其更改为删除`endl`打印。

# python - 从 python 启动服务作为子进程

> ID：12169919
> 
> 赞同：1
> 
> 时间：2012-08-29T01:57:03.117
> 
> 标签：python, debugging, windows-services, fuzzing

如果我从 python 启动服务（net start abc），我怎样才能使它作为 python 下的子进程而不是系统进程启动。

更多信息：

1.  我正在使用 python 的 net start 启动一个网络服务器。

2.  我还使用从 web 服务器请求流的命令从 python 打开浏览器。

3.  Python 执行 net start 命令，但服务作为系统进程启动。

4.  是否有一个开关可以用来在 python 下作为子进程启动服务，因为我有一个附加到 python 的调试器，我想调试该服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:15:32.690

将已建立的服务作为 Python 的子进程启动是不可能的。Windows 服务由[Windows 服务控制管理器](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685150%28v=vs.85%29.aspx)启动和控制，关联的进程将是“services.exe”进程的子进程。

也许，如果您的服务的底层可执行文件允许，您可以直接从 Python 调用该可执行文件，而不是使用“net start”。但是当然，它不会作为服务运行......

# objective-c - UITableView 在 rowselect 上多次设置 parentView 属性

> ID：12169924
> 
> 赞同：0
> 
> 时间：2012-08-29T01:57:43.653
> 
> 标签：objective-c, ios, cocoa-touch, user-interface

在我目前正在开发的单视图 iOS 应用程序中，我有一个视图控制器，旨在管理音频流的播放，以及一系列用于播放控制、滚动等的 UI 元素......为了清晰度，我们称之为`AudioStreamerViewController`。

此视图中的“曲目选择”按钮连接到显示模式的操作，目的是允许用户选择曲目并在被调用`TrackSelectionTableViewController`时返回播放视图。 当此行选择方法触发时，目标是向委托回调方法发送消息，然后尝试执行。 `tableView:didSelectRowAtIndexPath:`
`AudioStreamerViewController``self.currentTrack = trackObjPassedToCallback`

问题是`AudioStreamerViewController`调用它的`currentTrack`setter 似乎无限次（比如“我必须停止模拟器，否则我会用完内存”的次数），我似乎无法弄清楚为什么。 [我截取](http://www.screencast.com/t/IfGL1Av9S)了调用堆栈的屏幕截图。它设置了一个断点，所以它只在图像中显示了七个调用，但相信我，它会继续运行 =)

我通过使用以下原型制作 ' 代表来连接两个`AudioStreamerViewController`ViewController `TrackSelectionTableViewController`：

```
// in TrackSelectionTableViewController.h

@interface TrackSelectionTableViewController : UITableViewController {
    NSMutableArray *tracks;    
}
@property (nonatomic, assign) id<TrackSelectionTableViewControllerDelegate> delegate;

@protocol 
// in TrackSelectionTableViewController.m
@synthesize delegate;
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
  {
      Track *trackSelected = [tracks objectAtIndex:[indexPath row]];
      [self.delegate userDidSelectTrackFromTableView:trackSelected ];
      [self dismissModalViewControllerAnimated:YES];
  } 
```

`AudioStreamerViewController`的原型和委托回调如下所示：

```
// in AudioStreamerViewController.h
@interface AudioStreamerViewController : UIViewController <SCDJTrackSelectionViewControllerDelegate> {
    Track *currentTrack;
}
@property (nonatomic) Track *currentTrack;

-(void)userDidSelectTrackFromTableView:(id)trackObj;

// in AudioStreamerViewController.m
@synthesize currentTrack;
-(void)userDidSelectTrackFromTableView:(id)trackObj
{
    self.currentTrack = (Track *)trackObj;
    // other handling code...
} 
```

我尝试了多种方法，并且每种方法都产生相同的最终结果。任何人都可以确定为什么会发生这种情况的任何迹象吗？此外，是否有更有吸引力/更稳定的方法来实现这个想法？如果是这样，有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:35:51.063

答案在您的堆栈跟踪中。`-setCurrentTrack:`正在打电话`-setCurrentTrack:`。你的代码是干什么用的`-setCurrentTrack:`？

# iphone - 滚动 Accordion UITableView 时的 EXC_BAD_ACCESS

> ID：12169932
> 
> 赞同：0
> 
> 时间：2012-08-29T01:59:09.160
> 
> 标签：iphone, objective-c, uitableview

尝试向下滚动 UITableView 时遇到问题。该单元格是原型自定义单元格。我正在尝试使用 Accordion 方式扩展一个单元格。这是我实现手风琴的链接。我刚刚添加了一个自定义单元格。

[http://www.cocoanetics.com/2011/03/expandingcollapsing-tableview-sections/](http://www.cocoanetics.com/2011/03/expandingcollapsing-tableview-sections/)

非常感谢。

这是我的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

CustomCell *cell = (CustomCell *)[tableView dequeueReusableCellWithIdentifier:@"Celda"];

if ([self tableView:tableView canCollapseSection:indexPath.section])
{       
    if (!indexPath.row)
    {
        cell.name.text = [category objectAtIndex:indexPath.section]; 
    }
    else
    {
        cell.name.text = [(Local *)[filteredArray objectAtIndex:indexPath.row] nombreLocal];
    }
}
else
{
    cell.name.text = [category objectAtIndex:indexPath.section];

}   
return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

if ([self tableView:tableView canCollapseSection:indexPath.section])
{
    if (!indexPath.row)
    {
       [tableView deselectRowAtIndexPath:indexPath animated:NO];

        NSInteger section = indexPath.section;
        BOOL currentlyExpanded = [expandedSections containsIndex:section];
        NSInteger rows;

        NSMutableArray *tmpArray = [NSMutableArray array];

        if (currentlyExpanded)
        {
            rows = [self tableView:tableView numberOfRowsInSection:section];
            [expandedSections removeIndex:section];

        }
        else
        {
            [expandedSections addIndex:section];
            rows = [self tableView:tableView numberOfRowsInSection:section];
        }

        for (int i=1; i<rows; i++)
        {
            NSIndexPath *tmpIndexPath = [NSIndexPath indexPathForRow:i inSection:section];
            [tmpArray addObject:tmpIndexPath];
        }

        if (currentlyExpanded)
        {
            [tableView deleteRowsAtIndexPaths:tmpArray withRowAnimation:UITableViewRowAnimationNone];
        }
        else
        {
            [tableView insertRowsAtIndexPaths:tmpArray 
                              withRowAnimation:UITableViewRowAnimationNone]; 
        }
       }
      }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:03:52.540

HelmiB 我把我的代码放在这里：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if ([self tableView:tableView canCollapseSection:section])
    {
        if ([expandedSections containsIndex:section])
        {
        return [filteredArray count]; 
        }      
        return 1;
    }
return 1;
} 
```

# compiler-construction - 源变压器如何工作？

> ID：12169940
> 
> 赞同：1
> 
> 时间：2012-08-29T02:00:02.530
> 
> 标签：compiler-construction, programming-languages, llvm, haxe, hiphop

我一直在考虑像[HipHop](http://developers.facebook.com/blog/post/2010/02/02/hiphop-for-php--move-fast/)和[Haxe](http://haxe.org/doc/intro)这样的源转换器。从他们各自的网站上，我看到这些工具将源语言转换为目标语言，然后使用目标语言的编译器生成最终的可执行文件。我感到困惑的部分是这些工具如何处理源语言是内存管理语言（PHP，Haxe lang）而目标语言是非内存管理语言（C / C++）的情况。我知道[Mono](http://www.mono-project.com/Main_Page)在编译时添加了一个 VM 来处理这个问题。HipHop 和 Haxe 等工具有什么作用？我在哪里可以找到与该主题相关的编程语言/编译器文献中的文章？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T08:38:16.390

Haxe 需要垃圾收集，它不仅仅是一个转换器，它还添加了目标语言所需的一切。C++ Target fe 将 Reflection、Garbage Collection 和其他种类的兼容性类添加到 C++ Runtime。这使您可以在所有平台上使用许多功能。

您可以在[此处](http://code.google.com/p/hxcpp/)查看运行时文件。

最好尝试一下并查看生成的 c++ 代码。

# modx - 从 MODX MIGX 丢失的项目

> ID：12169955
> 
> 赞同：0
> 
> 时间：2012-08-29T02:02:01.780
> 
> 标签：modx, modx-revolution

我有一个使用 MIGX/getImageList 显示的图像列表和相应的文本数据。

这工作正常，直到我的列表包含第 13 项。此时，它将选择一个列表项，而不显示它。未显示的项不是列表中的最后一项，所有 13 项都显示在后端。

不显示的item可以通过改变list的顺序来改变，但是缺失item的index并不总是一样的。在重新订购和保存完成之前，相同的项目仍然丢失 - 即每次我重新加载时它都不会随机隐藏不同的项目。

我没有看到模板中提到任何限制。我也没有看到对 12 或 13 的引用。项目中的文本数据和图像是干净的，并且已经为 12 个项目工作了将近 8 个月。

这是一些代码：

tpl

```
 <div class="management_box">
  <div class="management_img">
    <img  src="[[+image:phpthumbof=`w=100&z=1`]]" alt="[[+pagetitle]]" />
  </div>
    <div class="management_content">
      <h2>[[+name]]</h2>
      <h3>[[+position]]</h3>
      [[+descr]]
      <a href="#[[+name:stripString=` `]]" class="show_more">Show more</a>
    </div>
    <div id="[[+name:stripString=` `]]" class="fulldescr">
    <img  src="[[+image:phpthumbof=`w=100&z=1`]]" alt="[[+pagetitle]]" />
    <h2>[[+name]]</h2>
    <h3>[[+position]]</h3>
    [[+fulldescr]]
    </div>
    <div class="clear"></div>
</div> 
```

模板

```
<div id="content">   
        [[!getImageList? 
        &tvname=`management` 
        &docid=`[[*id]]` 
        &tpl=`management_tpl` 
        &limit=`0`
    ]]
        <div class="clear"></div>
    </div><!-- #content --> 
```

我被交给了这个网站来维护，所以我没有建立它。如果我对 ModX 不完全熟悉，请原谅我！

-克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T07:23:01.173

对于将来偶然发现这篇文章的任何人 - 我的 MIGX 插件已经过时并且有一些缺陷。插件的更新修复了一切。

# .htaccess - htaccess url重定向/重写特定url并删除查询字符串（不保留）

> ID：12169958
> 
> 赞同：0
> 
> 时间：2012-08-29T02:02:15.627
> 
> 标签：.htaccess, mod-rewrite, redirect

当前网址：[http ://www.domain.com/billing/signup.php?a=1&b=2](http://www.domain.com/billing/signup.php?a=1&b=2)

我需要什么：http: [//billing.domain.com/register.php](http://billing.domain.com/register.php)

我不太擅长 htaccess 语法，所以我想在这里寻求帮助。我不再需要查询字符串，因为旧 url 已经过期，我只需要 301 重定向到新 URL 并删除查询字符串。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T03:02:21.903

在`www.domain.com`域的文档根目录中的 htaccess 文件中，您可以执行以下两项操作之一。

使用 mod_rewrite：

```
RewriteEngine On
RewriteRule ^signup\.php$ http://billing.domain.com/register.php? [R=301,L] 
```

或使用 mod_alias：

```
RedirectMatch ^/signup.php http://billing.domain.com/register.php? 
```

这完全忽略了查询字符串的实际含义。它只匹配 URI，`/signup.php`并重定向到目标。请注意，`?`末尾的 确保不会附加现有的查询字符串。

# ssh - scp 从第一台计算机到第二台计算机发送一些东西到第三台计算机

> ID：12169960
> 
> 赞同：1
> 
> 时间：2012-08-29T02:02:48.500
> 
> 标签：ssh, scp

我有一个在超级计算机 (CentOS) 上使用的 bash 脚本。这台计算机的设置使得有一个可以访问互联网的节点（称为“ **connectedNode** ”）——并且通过该节点，可以访问所有其他节点（称为“ **workNodes ”）。**大部分工作是在通过**connectedNode** ssh-ing到**workNode**之后完成的。

我有一个 bash 脚本，它本质上是一个衬里：

```
#!/bin/bash
# scpdropbox
scp $1 myusername@desktop:/Users/myusername/Dropbox/Inbox 
```

这允许我运行如下命令：

```
scpdropbox file.name 
```

并且因为我已经在所有节点和我的外部计算机（**桌面**）之间设置了 ssh-keys，所以我希望这个文件结束，它工作得很好。当然，这只有在我从**connectedNode**运行它时才有效，否则，这个命令会失败，因为**workNodes**没有连接到互联网。

如何修改此脚本，以便我可以从**workNode运行此命令，并让它通过****connectedNode**发送正确的文件和诸如此类的东西并发送到**桌面**？

到目前为止我尝试过的事情（注释掉）：

```
PWD=$(pwd)

# ssh myusername@connectedNode <<'ENDSSH'
# ssh -t myusername@connectedNode <<'ENDSSH'
ssh -t -t myusername@connectedNode <<'ENDSSH'
#commands to run on remote host
# scp \$PWD/\$1 myusername@desktop:/Users/myusername/Dropbox/Inbox
# scp '$PWD'/'$1' myusername@desktop:/Users/myusername/Dropbox/Inbox
scp $PWD/$1 myusername@desktop:/Users/myusername/Dropbox/Inbox
ENDSSH 
```

他们不工作。我收到如下错误：

```
Pseudo-terminal will not be allocated because stdin is not a terminal.
/home/dir/myusername: not a regular file
tcgetattr: Inappropriate ioctl for device 
```

取决于我尝试过的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T05:08:13.427

在您的每个工作节点上，将以下内容添加到您的`~/.ssh/config`文件中：

```
host desktop
   ProxyCommand ssh -xaqW%h:22 myusername@connectedNode 
```

现在，当工作节点尝试 ssh 到桌面时，它将首先连接到`myusername@connectedNode`，然后继续 SSH 到桌面（`%h`）端口 22。

我使用它来允许我的工作站在没有 Internet 或默认路由的情况下通过网络上的另一台机器连接到外部主机，该机器在另一个网络接口上具有网络访问权限。奇迹般有效。

请注意，如果您使用的`ssh`是不支持该`-W`选项的非常旧的，您也可以使用：

```
host desktop
   ProxyCommand ssh -x -a -q myusername@connectedNode nc %h 22 
```

# iphone - iOS - UINavigationBar - 平面样式按钮

> ID：12169963
> 
> 赞同：3
> 
> 时间：2012-08-29T02:03:32.120
> 
> 标签：iphone, objective-c, ios

我想知道如何在 UINavigationBar 中实现类似 Skype 的按钮，它会给人一种扁平的感觉，但像下面屏幕截图中的“编辑”和“列表”按钮一样巧妙地浮雕。

我应该创建图像，还是有任何简单的方法可以在代码或库中做到这一点？

![Skype 按钮](../Images/1a7ed39947315a28dfc316bbdd883609.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T02:08:38.347

您需要为正常状态和突出显示的选定状态创建两个图像。然后用这两个图像创建 UIButton 并将这个 UIButton 添加到 UIBarButtonItem 作为 customView。然后你可以将你的 UIBarButtonItem 添加到导航栏。就这样。

# java - For-each 没有正确迭代

> ID：12169965
> 
> 赞同：1
> 
> 时间：2012-08-29T02:03:41.213
> 
> 标签：java, foreach

我得到了这个 for-each 循环，它没有正确迭代我的对象“CharacterMove”的 ArrayList。我知道它不是空的，因为我在迭代之前尝试打印 size()

这是我拥有的每个人

```
for (CharacterMove move : charinfo.getMoves()) { 
```

数组列表

```
private List<CharacterMove> moveset = new ArrayList<>(); 
```

任何人？

编辑：这是完整的方法

```
public static void writeDataFromChara(CharacterInfo charinfo, String fileTarget, boolean popupFail) {
    try {
        File file = new File(fileTarget);
        PrintStream ps = new PrintStream(file);

        ps.print("<INFO>");
        ps.println();

        System.out.println("Size: " + charinfo.getMoves().size());

        //Write the information
        for (Entry<String, String> entry : charinfo.tree.getAllDatas().entrySet()) {
            ps.print(entry.getKey() + ":" + entry.getValue());
            ps.println();
        }

        //Write the moves, frames and hitboxes
        for (CharacterMove move : charinfo.getMoves()) {
            System.out.println("Z"); //Never called just like everything else
            ps.print(move.name + ":");
            ps.println();
            for (Pair<CharacterMoveFrame,Integer> frame : move.frames) {
                ps.print("frame:"); //Indicate that this is part of a new frame
                for (Entry<String, Collider> collider : frame.left.hitboxes.entrySet()) {
                    ps.print(collider.getValue().x + ",");
                    ps.println();
                    ps.print(collider.getValue().y + ",");
                    ps.println();
                    ps.print(collider.getValue().w + ",");
                    ps.println();
                    ps.print(collider.getValue().h);
                    ps.println();
                }
            }
        }
        ps.close();
    } catch (IOException e0) {
        if (popupFail) {
            JOptionPane.showMessageDialog(new JPanel(), "An error happened while writing the data", "Error", 1);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T04:30:50.087

检查这一行；

```
 System.out.println("Size: " + charinfo.getMoves().size()); 
```

如果大小为“0”，则您的第一个 for-each 循环不起作用。

# matlab - 在Matlab中生成一个范围内的随机整数并排除特定整数的最佳方法是什么？

> ID：12169967
> 
> 赞同：0
> 
> 时间：2012-08-29T02:04:00.090
> 
> 标签：matlab, random

我目前有以下功能，但是有没有更有效的方法来生成一个范围内的随机整数并在 Matlab 中排除特定整数？

```
function aNew = random(a)
aMin = a-100;
aMax = a+100;
aNew = a;
while aNew == a
    aNew = randi([aMin, aMax]);
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T05:28:03.150

为什么不做这样的事情：

```
function aNew = random(a, sz)

    if nargin == 1, sz = [1 1]; end

    aMin = a-100;
    aMax = a+100;

    aNew = randi([aMin aMax-1], sz);

    aNew(aNew == a) = aMax;

end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T04:29:42.770

您当前的方法进行拒绝抽样。你为什么不这样做：假设你要从中抽取样本的整数范围是`[a, c]`，而你要排除的数字是`b`。然后`[a, c-1]`对每个大于或等于 的样本进行采样，并将`b`其递增 1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T02:20:47.217

您可以使用该函数`randsample`从指定分布中抽取样本。

像这样的东西应该可以正常工作

```
sampleRange = [1, 100];  % sample from 1 to 100
noSample = 50; % lets exclude 50
pop2Sample = [range(1):noSample-1, noSample+1:range(2)]; %create the population

sample = randsample(pop2Sample,1); %draw a single sample 
```

**更新**

如果您想从总体中排除多个值，您可以使用该`setdiff`函数。

```
pop2Sample = 1:100;  % sample from 1 to 100
noSample = 0:10:100 % lets exclude any all multiples of ten
pop2Sample = setdiff(pop2Sample, noSample);

sample = randsample(pop2Sample,1); %draw a single sample 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T21:24:13.340

按照@slayton 的解决方案，为了对样本进行统一抽样`N`，有放回，您可以在值总体内随机索引，有放回：

```
N = 10; % samples
aMin = -100; % lower
aMax = +100; % upper
a = 0; % excluded int 

valPop = [aMin:a-1, a+1:aMax]; % value population
samples = valPop(randi([1, N-1], 1, N)); % with resampling 
```

# java - Android得到奇怪的盒子符号

> ID：12169972
> 
> 赞同：0
> 
> 时间：2012-08-29T02:04:41.337
> 
> 标签：java, android, string

我正在从数据库中获取大量信息。为了确保各种符号有效，我正在使用下面的字符串进行测试。

```
awdasdasdada
sa 
asdasd                     
asdasdasd!Q&amp;#^@)#^@)#_@*#&amp;@&amp;#
(!@&amp;#*(@T$#&amp;^$#
^*%$#^$^#@*&amp;^* 
```

我将此字符串设置为我的 TextView 的文本之一并得到以下结果。 ![在此处输入图像描述](../Images/4e0167172652ba940efb69c1b3432146.png)

框符号不会显示在字符串中，但会显示出来。任何人都知道这些奇怪的符号是什么以及如何摆脱它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T02:11:01.823

您在哪个版本的 Android 上进行测试？如果它是 2.1，那么它可能是你`\n\r`从数据库中获取的。出于某种原因，2.1 显示`\r`为这些框。`\r`如果要在使用 2.1 时保留新行，则必须从字符串中删除所有s。

# git - 从 git-gui 调用外部 difftool？

> ID：12169973
> 
> 赞同：6
> 
> 时间：2012-08-29T02:04:49.903
> 
> 标签：git, git-gui, difftool

我已经配置了 p4merge，因此如果我从命令行执行“git difftool ...”，那么外部 diff 工具会正确打开。

我想从“git gui”而不是命令行打开外部 difftool。这可能吗？

似乎 git-gui 允许添加一个工具。但我不清楚如何让它工作。任何指针？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-10-30T06:05:39.467

如果您已经`git difftool`设置，您可以为其添加一个项目：

[![git-gui 工具->添加对话框 difftool 设置](../Images/095c760b0be0368c5ecc1e8e1a223bbd.png)](https://i.stack.imgur.com/DXuX6.png)

添加工具对话转录：

```
Tool Details box:
    Name: difftool
    Command: git difftool $FILENAME

Show a dialog before running: unchecked
    Ask the user to select a revision (sets $REVISION): unchecked
    Ask the user for additional arguments (sets $ARGS): unchecked

Don't show the command output window: checked
Run only if a diff is selected ($FILENAME not empty): checked
  Add globally: checked 
```

虽然不是超级有用，因为似乎没有办法为其分配热键或双击操作。

如果它[问你烦人的问题](https://stackoverflow.com/questions/7897517/why-does-git-difftool-not-open-the-tool-directly)，可能需要`-y`在命令中添加一个。`difftool`

# api - 使用 Shopify API 更新库存数量

> ID：12169975
> 
> 赞同：6
> 
> 时间：2012-08-29T02:05:18.177
> 
> 标签：api, shopify

我正在尝试使用 Shopify API 更新产品。以下是更新产品标题、重量和库存的示例 XML 请求：

```
<?xml version="1.0" encoding="UTF-8"?>
<product>
  <id type="integer">100159400</id>
  <title>150 Watt Mini Stereo Power Amplifier</title>
  <variants type="array">
    <variant>
      <id type="integer">233139732</id>
      <grams type="integer">700</grams>
      <inventory-quantity type="integer">222</inventory-quantity>
    </variant>
  </variants>
</product> 
```

在 PUT /admin/products/100159400.xml 之后我得到了 200-OK。标题和重量（克）更新得很好，但库存数量没有更新。这对于所有其他调用都是一致的：我可以更新除库存数量之外的每个字段。想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-29T02:55:45.380

该产品没有打开库存跟踪。在您的管理员中，您应该会看到库存水平显示为无穷大。

要更改此设置并开始跟踪库存，您需要将`inventory_management`变体上的字段设置为`shopify`。以下 XML 应该可以解决问题：

```
<?xml version="1.0" encoding="UTF-8"?>
<product>
  <id type="integer">100159400</id>
  <title>150 Watt Mini Stereo Power Amplifier</title>
  <variants type="array">
    <variant>
      <id type="integer">233139732</id>
      <grams type="integer">700</grams>
      <inventory-management>shopify</inventory-management>
      <inventory-quantity type="integer">222</inventory-quantity>
    </variant>
  </variants>
</product> 
```

# php - PHP cUrl 0 内容长度，没有错误

> ID：12169979
> 
> 赞同：2
> 
> 时间：2012-08-29T02:05:56.533
> 
> 标签：php, curl

我有这个 cUrl 请求有时有效，然后停止工作。我正在回显标题和任何错误，http 显示 200 ok 并且没有错误，但内容长度为 0。

```
$userAgent = 'Googlebot/2.1 (http://www.googlebot.com/bot.html)';
$cslbnum = "881126";
$target_url =      "https://www2.somewebsite.aspx?LicNum=" .   $cslbnum;
$ch = curl_init();
curl_setopt($ch, CURLOPT_USERAGENT, $userAgent);
curl_setopt($ch, CURLOPT_REFERER,  "https://www2.somesite.aspx");
curl_setopt($ch, CURLOPT_URL,$target_url);
curl_setopt($ch, CURLOPT_FAILONERROR, true);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0);
curl_setopt($ch, CURLOPT_AUTOREFERER, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);
curl_setopt($ch, CURLOPT_TIMEOUT, 100);
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
if(curl_exec($ch) === false)
{
echo 'Curl error: ' . curl_error($ch);
}
else
{
echo 'Operation completed without any errors';
}
$html = curl_exec($ch);
$html = @mb_convert_encoding($html, 'HTML-ENTITIES', 'utf-8');
curl_close( $ch );

echo $html; 
```

有什么想法可能导致这种情况吗？我发誓今天早上我醒来它工作，下班回家，什么都没有。直接测试网站，工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:11:52.430

这是您代码的最后一点 - 您调用`curl_exec`了两次。

```
// ...
$html = curl_exec($ch);
if($html === false)
{
echo 'Curl error: ' . curl_error($ch);
}
else
{
echo 'Operation completed without any errors';
}
$html = @mb_convert_encoding($html, 'HTML-ENTITIES', 'utf-8');
curl_close( $ch );
echo $html; 
```

另外，考虑避免`@`.

# php - PDO/MySQL rowCount 未按预期返回

> ID：12169981
> 
> 赞同：6
> 
> 时间：2012-08-29T02:06:19.560
> 
> 标签：php, mysql, pdo, rowcount

回答后编辑：我认为这是我自己的代码中的一个错误——我不知道它是什么，但我继续修复它。请参阅下面的答案。

我正在使用 MySQL/PHP 执行一系列 INSERT ... ON DUPLICATE KEY UPDATE 语句。我读过的文档表明这将返回的行数：

```
-1 : an error
0 : update, no changes to row made (i.e. all values duplicated)
1 : row inserted
2 : update performed on row with duplicate key 
```

但是，我只看到 0 的结果，而我应该看到 2 （因为我正在查看代码更新各种数据库值。）这是代码：

```
$stmt = $db->prepare('INSERT INTO sometable (`id`, `name`, `email`) VALUES (?, ?, ?) ON DUPLICATE KEY UPDATE `name` = ?, `email` = ? ;');

$stmt->execute( array ( $id, $name, $email, $name, $email ) );

$rc = $stmt->rowCount();
echo $rc; 
```

$rc 总是出现 0 进行更新（即使值确实发生了更改）或 1 （如预期的那样成功插入。）

我错过了什么？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T02:33:20.407

尝试使用MySQL函数，如果返回正确的结果，问题将是`PDO:rowCount()`

```
$stmt = $db->prepare('INSERT INTO table (`id`, `name`, `email`) VALUES (?, ?, ?) ON DUPLICATE KEY UPDATE `name` = ?, `email` = ? ;');

$stmt->execute( array ( $id, $name, $email, $name, $email ) );

$rc = $db->query("SELECT ROW_COUNT()")->fetchColumn();
echo $rc; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T16:19:48.377

我认为`rowCount()`是为了返回`SELECT`语句中返回的行数。

从手册

> PDO::exec — 执行一条 SQL 语句并返回受影响的行数

尝试[`exec()`](http://www.php.net/manual/en/pdo.exec.php)改用。

# objective-c - 分段控制和图像数组

> ID：12169982
> 
> 赞同：0
> 
> 时间：2012-08-29T02:06:22.010
> 
> 标签：objective-c, ios, uiimageview, uisegmentedcontrol

我想使用段控件来更改 uimage 视图中的图像，我将图像存储在一个数组中。

在考虑记忆时，最好的解决方法是什么？基本上我想要在段视图中的前进按钮和后退按钮，并为此更改屏幕上的图像，根据单击的按钮在数组中循环。

我在想也许在段控制++中有按钮；或者 - ; 一个int，并为此改变图像显示的内容。

请对最有效的方法有什么想法或想法吗？有人知道这是否以前做过或有任何类似的链接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T02:48:25.010

这并没有像您写的那样回答您的问题，但它扩展了@borrrden 在评论中所说的内容。使用`UIButtons`.

你可以在你的方法中做这样的事情，`forward`假设`countUp`是`int`：

```
if (array.count - 1 > countUp){ 
  countUp += 1; 
  [array objectAtIndex:countUp];
} else {
    countUp = 0;
    [array objectAtIndex:countUp];
} 
```

然后只需将其反转为`back`按钮。

# ruby-on-rails-3 - rails 3 actionmailer 在开发中工作，但不在 heroku 上

> ID：12169984
> 
> 赞同：1
> 
> 时间：2012-08-29T02:06:47.127
> 
> 标签：ruby-on-rails-3, heroku, actionmailer, dev-to-production

我有一个用于 actionmailer 的外部 smtp 服务器。我在开发和生产配置中都有完全相同的 action_mailer 配置。它在开发中完美运行，但是当我在 heroku 上运行它时，我没有收到任何错误，它显示“向 me@gmail.com 发送邮件”，但测试帐户从未收到电子邮件（甚至检查过垃圾邮件文件夹）。

这大致是我的配置所说的：

```
config.action_mailer.raise_delivery_errors = true
config.action_mailer.delivery_method = :smtp
config.action_mailer.perform_deliveries = true
config.action_mailer.smtp_settings = {
 :address => "mail.server.com",
 :port => 25,
 :domain => "server.com",
 :user_name => "no-reply@server.com",
 :password => "password",
 :authentication       => :login,
 :enable_starttls_auto => true
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:44:27.790

我使用 godaddy 进行 smtp 传送。首先这是我的特定设置：

```
:address => 'smtpout.secureserver.net',
:port => 3535,
:domain => 'www.neeis.com',
:authentication => :plain,
:user_name => 'user@neeis.com',
:password => 'password' 
```

但！如果问题仅在电子邮件来自 gmail.com 时出现，那么 godaddy 会阻止它，可能与垃圾邮件有关。所以这就是我解决这个问题的方法，在我的邮件中我有这样的东西：

```
 begin
      EmployeeMailer.emailtoemp(@message).deliver
    rescue
      EmployeeMailer.emailtoempforce(@message).deliver
    end 
```

因此，如果第一次尝试使用 from = 'somebody@gmail.com' 发送电子邮件失败，我会尝试使用 from = 'webmaster@mysite.com' 发送它，并将发件人地址嵌入到正文中电子邮件。这不是一个完美的解决方案，这些是从我的网络用户发送给我的员工的电子邮件。很多时候，员工不会注意到发件人地址，只需单击回复，他们就会给我发电子邮件，网站管理员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T23:37:11.423

查看[https://devcenter.heroku.com/articles/smtp](https://devcenter.heroku.com/articles/smtp)

尝试删除

```
:enable_starttls_auto => true 
```

从您的 smtp 配置块

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T02:08:44.217

如果您使用 deyaled_jobs 发送电子邮件，您可能需要在您的应用程序中添加工作人员测功机。即使您不是，也值得一试，看看它是否能解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-19T21:35:51.310

首先尝试使用端口 587 而不是 25。

如果这不起作用，则可以使用[Heroku Sendgrid 插件](https://devcenter.heroku.com/articles/sendgrid)进行快速修复。如果您每天发送的电子邮件少于 200 封，则它是免费的。

# eclipse - 在 RCP 应用程序中配置工作区

> ID：12169986
> 
> 赞同：1
> 
> 时间：2012-08-29T02:06:58.297
> 
> 标签：eclipse, eclipse-rcp

我正在开发一个 RCP 项目来构建一个建模器。现在我想为我的应用程序配置工作区，我找到了这篇[文章](http://hexapixel.com/2009/01/12/rcp-workspaces)并按照它进行操作。但是当我打电话

```
ResourcesPlugin.getWorkspace().getRoot() 
```

它返回给我的只是一个“/”。

在进行上述调用之前，我已将我的产品配置为使用以下参数运行：

```
-os ${target.os} -arch ${target.arch} -nl ${target.nl} -consoleLog -data @noDefault 
```

并在 Application.java 的 start 方法中设置一个工作区，例如：

```
Location instanceLoc = Platform.getInstanceLocation();
instanceLoc.set(new URL("file", null, "d:\\temp"), false); 
```

我知道我错过了一些东西，但我无法弄清楚。请帮帮我。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T13:23:21.320

改为使用`ResourcesPlugin.getWorkspace().getRoot().getLocation()`。

一般来说：Workspace API 是文件系统的抽象，因此它不知道存储文件的底层系统的细节，最高元素是工作空间根。

# ruby - 即使在捆绑后也找不到宝石

> ID：12169988
> 
> 赞同：0
> 
> 时间：2012-08-29T02:07:32.447
> 
> 标签：ruby, sinatra, rvm, bundler

我在我的 Gemfile 中指定了 gem，从 Github 存储库安装：

```
gem 'surveygizmo', :git => 'git://github.com/ample/surveygizmo.git' 
```

当我进行捆绑更新时，包含在列表中，我看到：

```
Using surveygizmo (0.0.1) from git://github.com/ample/surveygizmo.git (at master) 
```

但是当尝试启动我的 sinatra 应用程序（使用“ruby go.rb”）时，它说它找不到surveygizmo：

```
/Users/jeff/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- surveygizmo (LoadError) 
```

**...但我不明白为什么。**根据我所看到的一切，它正在安装。但后来它说不是。知道为什么>

我整天都在拉稻草，完全迷失了方向。我在错误中看到“1.9.1”，但 RVM 指向 1.9.3。“RVM 列表”显示如下：

```
$ rvm list

rvm rubies

   ruby-1.8.7-p357 [ i686 ]
   ruby-1.9.2-p290 [ x86_64 ]
=> ruby-1.9.3-p0 [ x86_64 ] 
```

[编辑]：当我这样做时它没有显示`gem list`

```
$ gem list
*** LOCAL GEMS ***
activesupport (3.2.8)
addressable (2.3.2)
bundler (1.1.5 ruby)
...(others)....
rake (0.9.2)
shotgun (0.9)
simple_oauth (0.1.9)
sinatra (1.3.3)
thin (1.4.1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:14:05.987

您需要为命令添加前缀：

```
bundle exec ruby go.rb 
```

这将确保加载捆绑器并且所有**Bundler** gem 都可用，尤其是`:git`gem。

# php - 在 PHP 中读取文件的最快方法是什么？

> ID：12169998
> 
> 赞同：1
> 
> 时间：2012-08-29T02:08:37.900
> 
> 标签：php, file, file-io, fopen, fgets

在 PHP 中读取文件的最快方法是什么？具体来说，我正在读取一个 url，我正在使用 fgets 读取一个文件，该 url 的大小约为 1MB，读取 5 个 url 最多需要 20 秒。我只得到一行字符串，它位于文件的末尾。我实际上使用 fseek 将指针移动到 url 的末尾，但它只适用于文件（而不是 url）。有什么绝妙的主意吗？

这是我的示例代码

```
$fp=fopen("http://url.com", "r");
if(is_bool($fp)){
    exit;
}
while(!feof($fp)) {
    $data = fgets($fp);
    if($data=="this is what i've wanted")
    {
        // codes...
    }
}
fclose($fp); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:23:47.947

在这种情况下，您不能*只是跳过所有内容。网络传输的工作方式是您定义内容长度并且必须在您想要的部分之前阅读所有内容。

简而言之，你不能跳过它。只需阅读它，抓住你需要的东西并继续生活。

**注意：如果资源支持部分内容和范围请求，则可以。不见得。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:53:35.647

您可以使用支持恢复下载的 cUrl 来仅检索文件的最后一部分：

```
function retrieve_tail($remoteFile, $localFile = null, $bytes = 1000) {
  $ch = curl_init();
  curl_setopt($ch, CURLOPT_URL, $url);
  curl_setopt($ch, CURLOPT_RANGE, intval($bytes)."-");
  $fp = fopen($localFile, "w+");
  curl_setopt($ch, CURLOPT_FILE, $fp);
  $result = curl_exec($ch);
  curl_close($ch);
  fclose($fp);
  return $result;
} 
```

然后调用：

```
 $result = retrieve_tail("http://url.com", "local_copy.txt", 20000);
  print_r($result); 
```

您将在您指定的本地文件上拥有您想要的东西。此外，您可以设置

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
```

直接获取内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T02:26:49.393

使用 CURL 获取远程 url：

```
function curlRequest($url)
{

    $curl = curl_init();
    curl_setopt($curl,  CURLOPT_URL,                $url);
    curl_setopt($curl,  CURLOPT_RETURNTRANSFER,     true);
    curl_setopt($curl,  CURLOPT_FOLLOWLOCATION,     true);
    curl_setopt($curl,  CURLOPT_BINARYTRANSFER,     true);
    curl_setopt($curl,  CURLOPT_ENCODING,           true);
    curl_setopt($curl,  CURLOPT_HEADER,             false);

    $a = new stdclass;
    $a->body            = curl_exec         ($curl);
    $a->status          = curl_getinfo      ($curl,     CURLINFO_HTTP_CODE);
    $a->effectiveURL    = curl_getinfo      ($curl,     CURLINFO_EFFECTIVE_URL);

    curl_close ($curl);

    return $a;
} 
```