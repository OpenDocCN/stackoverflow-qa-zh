# StackOverflow 问答 000458000-000458999

# sql-server-2005 - 无法删除 SQLServer2005 数据或日志文件

> ID：458004
> 
> 赞同：1
> 
> 时间：2009-01-19T15:37:48.087
> 
> 标签：sql-server-2005, locking, mdf, ldf

我试图恢复备份，但我不断收到操作系统错误 32 - 因为正在使用而无法删除。

无法弄清楚是什么锁定了数据和日志文件 - 所以我重新启动了机器，停止了服务，但仍然没有运气。

然后我删除了数据库，但数据和日志文件仍然存在。

再次重新启动 - 试图删除它们，但看起来没有什么可做的，Windows 不允许我这样做。

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T15:53:35.560

使用 Process Explorer，这是一个 Microsoft 工具，它会告诉您当前哪个进程锁定了文件，它会告诉您在删除文件之前需要停止/关闭什么。

这是一个关于找出谁锁定了文件的教程：

[http://windowsxp.mvps.org/processlock.htm](http://windowsxp.mvps.org/processlock.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T22:12:39.693

防病毒软件是一种捕获 DBA 的软件——MDF/LDF 文件非常大，我见过 AV 软件锁定文件来扫描它们的情况，但由于文件大小，它需要很长时间。您可以尝试停止您的防病毒服务。

另一个是备份程序 - 如果您使用基于文件的备份（如 Backup Exec 或 NetBackup），他们可能正在尝试运行文件备份。检查任何备份软件服务，停止这些服务，然后尝试删除文件。

您可能还安装了多个 SQL Server 实例，这可能属于另一个实例，而不是您正在使用的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-12T19:25:36.810

我遇到了类似的错误，在分离数据库后我无法删除数据文件和日志文件。

我收到错误消息，说需要“管理员权限”。

这是通过更改文件的权限来解决的。转到运行提示符-> 键入“windows explorer”-> 以管理员身份运行并访问该文件。

Right click the filename and select "Properties'.Go to "Security Tab" and add your domain account with full permissions.

Now, you would be able to delete the file.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T15:39:16.977

您应该能够分离（而不是删除）数据库，然后移动或删除数据文件。

[微软知识库。](http://support.microsoft.com/kb/224071)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T15:57:50.667

您删除了 SSMS 中的数据库，但文件仍然存在？（如果您“删除”条目，则不需要再分离”您可能选中了“保留数据文件”复选框

但我想重新启动应该允许您删除实际的 .mdf 和 .ldf 文件如果没有，请尝试启动到安全模式并删除实际文件然后

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-13T11:03:11.833

我遇到了“系统正在使用”错误的另一个原因。就我而言，从所有实例分离并重新启动后，我无法删除文件。这不是安全权限问题。任何程序也没有使用它，因为进程浏览器没有显示任何使用它的进程。在我的情况下，原因是**Visual Studio TFS 对 mdf 的不正确检查**。如果您签出文件然后松动与 TFS 服务器的连接，您将无法使用“系统正在使用”删除或重命名文件。即使没有VS启动。文件可以在安全模式下删除。而且，更重要的是 - 如果您让 TFS 重新联机并执行正确的**CheckIn** ，文件可以正确解锁。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-14T08:38:32.733

我遇到了与此类似的错误，但这是权限问题，而不是其他任何问题。数据库是在不同的用户下创建的，普通管理员帐户根本没有 LDF/MDF 文件的权限。

其他症状是管理员无法创建同名数据库，并且第三方应用程序无法执行数据导入（因为它删除并重新创建了数据库）

# ruby-on-rails - Acts_as_ferret 使用单一索引

> ID：458005
> 
> 赞同：1
> 
> 时间：2009-01-19T15:38:03.627
> 
> 标签：ruby-on-rails, full-text-search

我已经开始使用acts_as_ferret 将文本搜索添加到应用程序。在我的示例应用程序（另一个博客！）中，我在文章中定义和索引如下：

```
acts_as_ferret :fields => [:title, :body] 
```

我想要一个在单个字段上搜索的选项，例如让我获取标题包含“rails”的所有文章，而不是标题或正文包含“rails”的所有文章。

如何将搜索限制在索引中的单个字段？

干杯，

亚当

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T19:01:53.777

您可以在 find_by_contents() 调用中指定要搜索的字段，例如“title:rails”应该将搜索限制在该字段。

取自[http://www.railsenvy.com/2007/2/19/acts-as-ferret-tutorial](http://www.railsenvy.com/2007/2/19/acts-as-ferret-tutorial)在“附加查询字符串”标题下

# c# - 如何使用 WinAPI/C# 获取监视器/显示设备名称

> ID：458011
> 
> 赞同：3
> 
> 时间：2009-01-19T15:39:11.017
> 
> 标签：c#, winapi

我正在使用 C#/WPF 开发一个应用程序，并希望获取所有连接的显示监视器的列表。我使用了 Screen 类并成功获得了列表，但现在列表中的每个监视器名称为 ".\Display1\XXXXXXXX" 等。这是不可读的。但是，我的 Nividia 控制面板将它们列为专有名称。那么任何人都可以告诉我如何获取这些名称或一些 api 参考。

注意：=我已经尝试过返回名称的 EnumDisplayDevices 但它们应该是不同的？所以它使事情更加混乱？

我尝试了 WMI，它允许我访问更多信息，但是，名称仍然是“默认监视器 1”“默认监视器 2”，而没有关于制造商的信息，现在我想我们可以通过使用正常蜜蜂

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T16:25:17.523

在 WMI 中查询 Win32_DesktopMonitor。 [登录](http://msdn.microsoft.com/en-us/library/aa394122(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T15:44:02.710

查看 WMI（Windows 管理规范）。这不是一个简单的库，但它可以告诉你很多关于你的系统的东西。

# image - 如何在 Java ME 中创建透明图像

> ID：458027
> 
> 赞同：1
> 
> 时间：2009-01-19T15:43:31.023
> 
> 标签：image, java-me, transparent

如何在 Java ME 中创建可编辑但透明的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-16T08:48:40.360

如果您想以编程方式创建透明图像，那么以下是代码片段。

```
int width = 50, height = 50;
Image  image = Image.createImage(width,height); 

int[] rgbArr = new int[width * height];

image.getRGB(rgbArr, 0, width, 0, 0, width, height);

for (int i = 0; i < rgbArr.length; i++) {

   if(rgbArr[i] == 0xFFFFFFFF){

       rgbArr[i] = 0x00000000;

   }

}

Image transImage = Image.createRGBImage(rgbArr, width, height, true); 
```

现在您可以在 transImage 上获取图形对象并绘制您想要的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T07:12:51.740

使用 GIF 或 PNG - 两者都支持透明像素。

# c++ - 如何在 Outlook 2003/2007 的导航窗格（外观栏）中添加新按钮？

> ID：458032
> 
> 赞同：0
> 
> 时间：2009-01-19T15:44:22.020
> 
> 标签：c++, windows, com, plugins, outlook

我们大多数人都熟悉 Outlook 2003 左侧的“手风琴式”导航栏。它有日历、任务、邮件等按钮，单击其中一个按钮会打开一个浏览器窗格，其中包含该部分中的常用文件夹。

使用 C++ 或 Delphi，我想编写一个插件，在导航窗格中添加一个新部分。有谁知道从哪里开始？

我发现一些使用谷歌的帖子说，“这是不可能的，但如果你得到加载项快递，那么它是可能的”（例如[http://social.msdn.microsoft.com/Forums/en-US/vsto/ thread/a3517364-b1af-4583-966a-61717afa1028/](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/a3517364-b1af-4583-966a-61717afa1028/)），在我看来这是可能的，并非不可能 :) 我在哪里看？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-01-28T00:15:18.577

该网站为您提供信息：

[http://www.outlookcode.com/article.aspx?ID=36](http://www.outlookcode.com/article.aspx?ID=36)

好看。

# c# - 在 C# 中创建简单的嵌入式 http 和 https 应用程序

> ID：458036
> 
> 赞同：8
> 
> 时间：2009-01-19T15:45:48.243
> 
> 标签：c#, http, webserver

有一个简单的[http 服务器 API](http://blogs.oracle.com/michaelmcm/entry/http_server_api_in_java)，可以让你快速做一些[简单的事情](http://www.java2s.com/Code/Java/JDK-6/LightweightHTTPServer.htm)，而不需要任何额外的依赖/安装。

***在没有 IIS***的 .NET 中是否有类似的 API/库？

例如，我是一个正在运行的小窗口服务，我想添加一个简单的愚蠢的 Web 界面来允许本地/远程控制/监控。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T15:48:57.550

[`HttpListener`](http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx)我相信，即使没有 IIS，也可以连接到 HTTP.SYS。

不过，您需要将权限添加到服务帐户 -`netsh`在 vi​​sta 上，`httpcfg`在 xp 上（“如何”在[这里](https://stackoverflow.com/questions/169904)介绍）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-05T14:57:04.043

除了前面提到的我在生产应用程序中使用的[codeplex 上的 webserver 项目之外，另一个简单的 HTTP 服务器 API 选项是](http://www.codeplex.com/webserver)[Kayak](http://kayakhttp.com/)。Kayak 似乎处于早期开发阶段。它还没有达到 1.0。

更新：我注意到我与 Kayak 的原始链接最近断开了。Kayak 的主网站已移至[http://kayakhttp.com/](http://kayakhttp.com/)，但代码托管在 Google 代码上：[http](http://code.google.com/p/kayak/) ://code.google.com/p/kayak/ 。

更新 2：显然，Kayak 源代码再次移动，这次是 GitHub：[https](https://github.com/kayak/kayak/) ://github.com/kayak/kayak/ 。

更新 3：网络服务器正在“迁移”到网络库，也在 GitHub：[https ://github.com/jgauffin/griffin.networking](https://github.com/jgauffin/griffin.networking)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T15:48:22.980

一个快速的谷歌给了我很多这样的例子，比如[用 C# 创建你自己的网络服务器](http://www.codeguru.com/csharp/.net/net_general/article.php/c4603)。

请注意，这是一篇非常古老的文章，现在可能有更简洁的方法可以做到这一点。

[编辑：这里](http://www.codeplex.com/webserver)的另一个很好的例子。

# api - 你知道 NTSC 解码器 API 吗？

> ID：458037
> 
> 赞同：2
> 
> 时间：2009-01-19T15:45:56.870
> 
> 标签：api, video-processing

我正在寻找一种 API，可用于解码模拟信号的数字样本，根据 http://en.wikipedia.org/wiki/NTSC">NTSC 标准编码。我愿意同时考虑免费和商业选项。如果必须，我会自己滚动代码，但我想这段代码在过去几十年中已经编写了数十或数百次，所以我希望那里有一些我可以适应的东西.

你知道这样的API吗？

更新：似乎这段代码不一定像我希望的那样被多次编写。显然，解决的问题是通过特定设备直接处理模拟输入。我正在寻找的是一种算法，它将模拟信号的直接数字样本（具有足够的分辨率以获取标准中指定的更改）作为输入并返回视频图片，类似于 http://www. physicsforums.com/archive/index.php/t-47403.html">这个人想要并且不得不建立自己。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T04:31:49.803

我知道 GNU Radio 存在一些用于此任务的代码，但我不知道它是否曾经通过黑白接收：。

*   [http://www.nabble.com/NTSC-Receiver-td9123494.html](http://www.nabble.com/NTSC-Receiver-td9123494.html)
*   [http://www.mail-archive.com/discuss-gnuradio@gnu.org/msg01265.html](http://www.mail-archive.com/discuss-gnuradio@gnu.org/msg01265.html)

还有一个更完整的 GNU Radio [ATSC 收发器](http://www.gnuradio.org/trac/browser/gnuradio/trunk/gr-atsc)，虽然不是您想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-07T11:25:52.543

多年后......[这家伙](http://codeandlife.com/2012/10/09/composite-video-decoding-theory-and-practice/)在软件中构建了一个解码器。提供源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T03:50:43.960

将 NTSC 解码为具有同步信号的单独的 R、G、B 分量已经在硬件中完成了很长时间，它既便宜又容易。没有任何人愿意在软件中尝试它。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-20T03:02:18.533

您需要的是 Microsoft DirectShow API。检查此链接以获取 API 和帮助：http: [//msdn.microsoft.com/en-us/library/ms783323.aspx](http://msdn.microsoft.com/en-us/library/ms783323.aspx)

我不确定，但 Silverlight 也可能具有您正在寻找的功能。

# build-automation - 投票：在虚拟机中构建服务器？

> ID：458038
> 
> 赞同：8
> 
> 时间：2009-01-19T15:46:01.050
> 
> 标签：build-automation, virtual-machine, build-server

在虚拟机中拥有构建服务器会更好吗？在 VM 中拥有构建服务器的好处是否超过成本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-19T22:09:27.110

以下是在虚拟环境中运行构建服务器的一些优势：

**在多个构建服务器上共享一个快速的盒子**——假设你有六个构建服务器。将一台速度非常快（4-cpu、64-128gb 内存、非常快的硬盘驱动器等）的机器放在一起，并在其上运行管理程序。现在，所有构建服务器都可以访问这个更快的硬件，如果他们正在构建而其他构建服务器没有。建立一个构建计划，您应该能够进行更快的构建。如果您必须使用物理盒子，您可能无法在每台单独的构建服务器上负担那种质量级别的硬件——但是当它被共享时，这更容易证明是合理的。

**机器出现故障时无需停机**- 您的生产构建不会在出现硬件问题时崩溃停止，您只需在另一台虚拟化主机上启动构建服务器即可。（这仅在您使用共享存储时才有效。）

**轻松的硬件升级**- 当需要新的构建服务器时，您不必重新安装任何讨厌的操作系统。只需将来宾操作系统移至新的物理主机，您就可以开始比赛了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T22:15:45.150

构建服务器是需要以非常一致的方式构建的东西。您需要有一个有据可查且完全可复制的配方来制作您的构建服务器。

但是，构建服务器并不是对性能至关重要……或者至少，它们对生产系统的性能并不重要，因此您可以在 VM 中拥有一个。

如果您需要独立于硬件和软件的兼容性，那么使用虚拟机实际上是一个好主意。您首选的硬件供应商可能会停止在他们的新机器上支持您的构建服务器所需的操作系统版本，然后您的旧构建服务器的保修可能会到期。这使您可能无法在该操作系统中进行构建。

然后，您将面临在 ebay 上拖网进行第二手更换，购买供应商的过时套件库存，或者进行一些不可靠的不受支持的软件黑客攻击。（注意：这几乎发生在我们身上，我们做了一些）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T15:56:22.030

与往常一样，这取决于...

假设您有其他 VM 在同一台服务器上运行，并且这些其他 VM 可以处理由正在运行的构建导致的偶尔减速，那么我会说是的。但是，如果您要在单个主机上托管单个构建服务器 VM，或者如果其他 VM 会受到偶尔运行的构建的负面影响，那么不会。

我可以告诉你，在我工作的地方，我们已经切换到在 VMWare 上托管我们的大部分构建服务器。由于我们每周运行多次构建，包含 5 条以上的产品线，因此我们将它们全部托管在一台快速机器上是有意义的。我们还将大部分测试机器托管在同一台服务器上，这使我们能够充分利用机器，并且由于没有生产服务器在其上运行，因此在构建期间发生的减速不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T15:58:25.410

我没有看到任何好处，除非您的虚拟机位于某个虚拟服务器上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-28T09:44:17.887

将 VM 用于构建服务器的优缺点与将 VM 用于任何其他服务的优缺点相同。

这个问题同样适用于将 VM 用于邮件服务器/wiki 服务器等。

（我只是将其发布为评论，但还没有代表）

# ruby-on-rails - Rails 授权错误

> ID：458044
> 
> 赞同：-2
> 
> 时间：2009-01-19T15:48:02.217
> 
> 标签：ruby-on-rails, plugins, authorization

我目前正在尝试将[rails-authorization](http://code.google.com/p/rails-authorization-plugin/)插件集成到 rails 应用程序中。我已经完成了安装和设置步骤，但每次我尝试使用

```
permit "role" 
```

或者

```
permit? "role" 
```

函数，我收到一个错误，提示'const missing，User#RolesUser'，它在插件中似乎没有任何用处（它使用角色模型和 RolesUsers 表）。有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T19:33:19.127

最终发现这似乎是在rails 2.2.2中使用这个插件的一个错误。还发现更改所有引用

```
:roles_users 
```

到

```
:role_users 
```

在插件库文件（特别是 object_roles_table.rb 文件）中，生成了迁移，并且在生成的角色模型中，插件可以正常工作。

# java - JPA / Hibernate / PG的映射问题

> ID：458048
> 
> 赞同：4
> 
> 时间：2009-01-19T15:48:46.583
> 
> 标签：java, hibernate, exception, jpa

我有两个实体，Entity1 和 Entity2，是一对多的关系。在 Entity1 上，我有一个包含条目的地图。

我用来在地图上保留一个带有一些 Entity2 的新 Entity1 的代码是这样的：

```
 Entity1 e1 = new Entity1();  
   Entity2 e2 = null;  
   e1.setE2s(new HashMap<String, Entity2>());
   for (String key : someKeySet()){
      e2 = new Entity2();
      e2.setCode(key);                      
      e2.setSwhon(true);        
      e2.setE1(e1);
      e1.getE2s(key, e2);       
      em.persist(e1.getE2s().get(key));         

    }       
    em.persist(e1);
    em.flush(); 
```

这是实体的摘录：

```
@Entity
@Table(name = "wm_Entities1")  
public class Entity1 implements Serializable {  
   private static final long serialVersionUID = 6592708276573465599L;  
   private Map<String, Entity2> e2s;
   private Long id;  
   @Id  
   @GeneratedValue(strategy=GenerationType.TABLE)  
   public long getId() {  
    return id;  
   }  
   public void setId(long id) {  
    this.id = id;  
   }  
   public void setE2s(Map<String, Entity2> e2s){    
    this.e2s = e2s;
   }       
   @OneToMany(mappedBy = "e1", fetch = FetchType.EAGER)  
   public Map<String, Entity2> getE2s() {  
    return e2s;  
   }  
} 
```

* * *

```
@Entity
@Table(name = "wm_Entities2")
public class Entity2 implements Serializable {  
    private static final long serialVersionUID = -6131765066573346790L; 
    private long id;
    private Entity1 e1;
    @Id
    @GeneratedValue(strategy=GenerationType.TABLE)
    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }
    @ManyToOne()
    @JoinColumn(name="e1_id")
    public Entity1 getE1() {
        return this.e1;
    }
    public void setE1(Entity1 e1) {
        this.e1 = e1;
    }
} 
```

* * *

这似乎工作正常，因为它在 pg 数据库上插入两个实体，但问题是它没有在数据库上创建 - 保存 e2 的 MapKey（理论上 JPA​​ 生成这个密钥），所以当我得到 e1 回来时，我尝试从中获取 e2s 地图，我有一个：

> javax.ejb.EJBException：org.hibernate.HibernateException：集合的空索引列：

我怎样才能得到这个 MapKey 保存？

注意：我正在使用带有 JPA/Hibernate 的 JavaEE，在 JBoss 4.2 上运行，带有 PGSQL DB。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T11:42:26.317

There are some oddities in your code... But it seems that you should add a @MapKey annotation in Entity1:

```
(snippet)
@OneToMany(mappedBy = "e1", fetch = FetchType.EAGER)
@MapKey(name="iCantFigureTheRightPropertyName")
public Map<String, Entity2> getE2s() {  
    return e2s;  
} 
```

# sql-server-2005 - 是否可以在没有 DCOM 权限的情况下从 SQL Server 2005 中的 MSDB 数据库中删除 SSIS 包？

> ID：458052
> 
> 赞同：4
> 
> 时间：2009-01-19T15:50:04.100
> 
> 标签：sql-server-2005, ssis

不幸的是，我们没有必要的 DCOM 访问此[MSDN](http://msdn.microsoft.com/en-us/library/aa337083.aspx)文章中提到的 SQL Server，但我们确实拥有 SQL Server 实例的完整管理员权限。

因此，我们可以成功地将包部署到服务器并使用 SQL Server 代理运行它，但我不知道如何从服务器中删除包。

我唯一能想到的就是从 MSDB 数据库中的 dbo.sysdtspackages90 表中删除该行，但这对我来说似乎有点极端（如果不是非常危险的话！）。

问题在于我们的服务器管理被外包了，我们必须努力争取获得所需的访问权限 - 是否值得（可能 1 到 2 个月）昂贵的战斗，或者我可以通过其他方式获得我们需要的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T09:56:14.423

我认为还有一个存储`sp_dts_deletepackage`过程，如果您觉得删除该行不安全，您可以调用它。首先调用`sp_dts_getfolder`获取文件夹 ID，然后将此 ID 传递给`sp_dts_deletepackage`.

另一种方法是配置本地 SSIS 服务，使其有一个用于此远程 SQL 服务器存储的文件夹（查看 MSDN 以了解 SSIS 服务配置编辑）。然后，当您连接到本地 SSIS 服务时，您将看到这些远程包，并且可以使用 UI 删除。然后该服务将连接到 SQL 并为您调用这些存储的过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-25T07:48:24.050

对于任何人的信息。

检查 sp_dts_deletepackage 实际做了什么（右键单击 - 修改）表明，除了一些检查（安全）之外，它最终会做：

```
DELETE FROM sysdtspackages90
WHERE
  [name] = @name AND
  [folderid] = @folderid AND
  [packageformat] = 0 
```

在任何其他表中没有删除或更新

# asp.net-mvc - jQuery + MVC 用户控件

> ID：458055
> 
> 赞同：0
> 
> 时间：2009-01-19T15:50:52.960
> 
> 标签：asp.net-mvc, forms, jquery, user-controls

我要做的是将参数传递给用户控件视图，该视图将更新 div 标记并基于那里隐藏的用户控件呈现新数据。我知道如何使用 Ajax.Form() 辅助方法更新 div 标记，但传递参数和更新部分控件超出了我的范围。我从来没有使用过 jQuery 并查看了一些关于如何在 mvc 中实现它的教程，但是我遇到了太多死胡同，需要一些帮助来找出解决方案。我目前拥有的是这个，需要扩展它来更新用户控件视图。

ASPX 文件

```
<form id="formParams">
    <input name="textSearch1" type="text" />
    <input name="textSearch2" type="text" />
    <input name="btnTest" type="submit" onclick="$get('recordsForm').onsubmit()" value="Click Me" />
</form>
<% using (Ajax.Form(
            "Records",
            "Search",
            null,
            new AjaxOptions
            {
                UpdateTargetId = "records",
                OnSuccess = @"function(sender, args){}",
                HttpMethod = "GET"
            },
            new { @id = "recordsForm" }))
        {
        } 
    %>
    <div id="records">
        <img src="<%= Url.Content("~/Content/Images/load.gif") %>" alt="loading..." />
    </div> 
```

ACSX 文件

```
<%= ViewData["searchText1"].ToString()%> is the search you entered. 
```

控制器 CS 文件

```
public ActionResult Records(string searchText1, string searchText2)
        {

            ViewData["searchText2"] = searchText2 + " Stop sucking at jQuery Ayo";
            ViewData["searchText1"] = searchText1;

            return View("Records");

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T16:27:46.990

我想通了..哇，我所要做的就是将元素合并到 ajax 表单中，而不是将它放在一个单独的表单之外。

# c - 需要：可包裹计数器，其中 < 和 > 做“正确的事情”

> ID：458060
> 
> 赞同：4
> 
> 时间：2009-01-19T15:51:28.543
> 
> 标签：c, count, overflow

我需要将代码发送到一个允许溢出的计数器，并且 < > 在某个定义的时间间隔内继续从后面的值中区分早期值。

为了澄清，一种可能的实现是：

考虑两个这样的计数器`cur`和`dut`（被测设备），考虑两个函数：

```
bool isEarlier(cur, dut)    // Is dut earlier than cur?
bool isLater(cur, dut) 
```

`cur`并且`dut`是 16 位，`cur`刚刚溢出，它的当前值是，让我们说`5`。根据 的值`dut`，函数将返回

*   0 到 16384: isEarlier -> `(cur < dut)`, isLater ->`(cur > dut)`
*   16384 到 32768：isEarlier -> false，isLater -> true
*   32768 到 49152：无效，日志错误
*   49152 到 65536：isEarlier -> true，isLater -> false

我可以自己写代码，没问题。我只是懒惰。事实上，我知道 PostgreSQL 中有类似的东西（事务 ids wrap），我只是找不到实际执行它的函数。我很确定 Linux 内核中有类似的东西，可能是一个宏。但是无论是 Google 代码搜索还是 grep over /usr/include/linux 都无法打开它。任何想法它在哪里？

明确了 cur 和 dut 的作用。“无效”是有保障的。随着 cur 和 dut 之间的差异变大，函数最终会报错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T17:41:06.437

我认为您正在谈论正确处理数字圈的环绕。实际上，这很容易。

这并没有完全按照您所说的进行（不确定为什么您有那个“异常”间隔），但是：

```
typedef unsigned short uint16_t;
typedef signed short int16_t;
// abstract out 16-bit types in case "short" doesn't correspond to 16bits

bool isEarlier(uint16_t a, uint16_t b)
{
   int16_t diff = a-b;
   return diff < 0;
}
bool isLater(uint16_t a, uint16_t b)
{
   int16_t diff = a-b;
   return diff > 0;
} 
```

**编辑**：这在 diff=-32768 处有一个“分支点”，因此如果 a=5 和 b=32772，则 diff=-32767 小于 0，因此 5 比 32772“早”。如果 a=5 和b=32774, diff=-32769=32767 大于 0，因此 5 比 32774“晚”。这定义了（a）最简单的数学意义上的“早”和“晚”，以及（b）因为环绕计数器可以解释为具有多个解决方案 mod 65536，它选择相对于数字圈彼此“最接近”的 a 和 b 的解决方案。

如果 a 和 b 相差 32768，那么它们之间的距离相等，并且使用简单的数学来选择最简单的方法……这“违反”了“较早”和“较晚”的反对称性质，即 isLater(5,32773)是真的，isLater(32773,5) 也是真的。但是你怎么知道是“5”表示计数为5，还是“5”表示计数为65541？（就像 abs(-32768) == -32768 给出了一个奇怪的荒谬答案）如果你想保持反对称，例如 isLater(b,a) == isEarlier(a,b)，那么你总是可以这样做：

```
bool isLater(uint16_t a, uint16_t b)
{
   int16_t diff = b-a;
   return diff < 0;
} 
```

如果您希望将分支点偏向一个方向以在 -32768+K 处发生，请改用它：

```
bool isEarlier(uint16_t a, uint16_t b)
{
   int16_t diff = a-b-K;
   return diff < -K;
}
bool isLater(uint16_t a, uint16_t b)
{
   int16_t diff = b-a-K;
   return diff < -K;
} 
```

这不再使用最接近的；例如，如果 K=12768 和 a=5，那么对于 b=6,7,8,9,... 20005，isEarlier(a,b) 和 isLater(b,a) 将为真，并且对于b=20006, 20007, ... 65534, 65535, 0, 1, 2, 3, 4, 5 isEarlier(a,b) 和 isLater(b,a) 将为假。

您可以选择特定的间隔，这与我使用环绕数字的基本原理不同。这里定义的函数不能满足你所​​说的需求，但我发现这些间隔的选择有点奇怪。也许您可以解释一下您是如何确定它们的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T16:14:55.487

首先计算差异，然后检查它落入哪个窗口。

由于它是如此简单，并且过去/未来/错误窗口的大小各不相同，因此您必须自己做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:46:28.370

好的，记录一下。这是我的解决方案，这就是我的意思：

```
#include <stdint.h>

void increase_cyclic_counter (uint16_t *cnt)
{
#ifdef CYCLIC_COUNTER_EXPLICIT_WRAP
    if (*cnt < 2^16-1)
        *cnt++;
    else
        *cnt = 0;
#else
    *cnt++;
#endif
}

#define SAME 1
#define LATER 0
#define EARLIER 2
#define FORBIDDEN -1

/* dut (device under test) is tested against cur
 * returns:
 *    EARLIER (LATER) if dut happened earlier (later) in the sequence than cur
 *    SAME            if dut == cur
 *    FORBIDDEN       if dut and cur are that far away in the cyclic sequence
 *                    that no unambigious jugement is possible
 *
 * The basic idea is the same as with two-character year codes, where 
 * '97' stands for 1997 and '11' stands for 2011\. '50' is regarded as 
 * too ambigous and therefore rejected.
 *
 * The implementation splits the short integer range 0-65535 into 4 parts:
 *   0-16383, 16384-32767, 32768-49151, 49152-65536
 * With cur and dut in the same range, normal arithmetics apply, else the 
 * ranges are compared to each other.
 */

int test_cyclic_counter (uint16_t cur, uint16_t dut)
{
    switch (((int)(cur>>14)) - ((int)(dut>>14)))
    {
        case 0:  // same range
            if (dut < cur) 
                return EARLIER;
            else if (dut == cur)
                return SAME;
            else 
                return LATER;

        case 1:
        case -3:
            return EARLIER;

        case 3:
        case -1:        
            return LATER;

        default: 
            return FORBIDDEN;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T15:56:28.970

在我看来你刚刚写了它:)。为什么不将您的帖子翻译成一些 C 代码？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T16:04:23.243

请记住，您无法在 C 中使用“>”和“<”来执行您想要的操作。它们仅适用于数字，并且没有运算符重载。同样的事情也适用于你的例外；C 没有例外。

您可以编写一些以这种方式处理无符号整数类型的访问函数，这并不难。（在 C 语言中，有符号整数类型的溢出是未定义的，尽管在大多数现代系统中它会环绕。）这不会那么困难。

# macos - OSX 上的间接链接问题

> ID：458073
> 
> 赞同：1
> 
> 时间：2009-01-19T15:55:54.353
> 
> 标签：macos, linker

我在间接链接方面遇到了一些麻烦。这是一个小例子，显示出了什么问题：

```
$ make
g++ -fPIC -Wall   -c -o main.o main.cpp
g++ -fPIC -Wall   -c -o a.o a.cpp
g++ -fPIC -Wall   -c -o b.o b.cpp
g++ -fPic -Wall -r -dynamiclib b.o -o libb.dylib
g++ -fPic -Wall -r -dynamiclib a.o -o liba.dylib -L. -lb
LD_LIBRARY_PATH=. g++ main.o -o runme -L. -la -O
/usr/libexec/gcc/powerpc-apple-darwin8/4.0.1/ld: Undefined symbols:
fooB()
collect2: ld returned 1 exit status
make: *** [runme] Error 1 
```

生成文件

```
all: runme

CXXFLAGS=-fPIC -Wall

runme: main.o liba.dylib libb.dylib
        LD_LIBRARY_PATH=. g++ main.o -o runme -L. -la -O

libb.dylib: b.o
        g++ -fPic -Wall -r -dynamiclib b.o -o libb.dylib

liba.dylib: a.o libb.dylib
        g++ -fPic -Wall -r -dynamiclib a.o -o liba.dylib -L. -lb

clean:
        rm -f *.o *.dylib runme 
```

啊

```
#ifndef A_H_INCLUDED
#define A_H_INCLUDED

// liba depends on libb
#include "b.h"

// call through to fooB, implemented in the header.
inline int fooA()
{
        return fooB();
}

// call through to barB, implemented in the library.
int barA();

#endif // A_H_INCLUDED 
```

a.cpp

```
#include "a.h"

int barA()
{
        return barB();
} 
```

bh

```
#ifndef B_H_INCLUDED
#define B_H_INCLUDED

int fooB();

int barB();

#endif // B_H_INCLUDED 
```

b.cpp

```
#include "b.h"

int fooB()
{
        return 42;
}

int barB()
{
        return 314;
} 
```

主文件

```
#include <iostream>

#include "a.h"

int main()
{
        std::cout << barA() << "\n";
        std::cout << fooA() << "\n";
        return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T16:14:23.553

从[ld 手册页](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man1/ld.1.html)：

> 链接两级命名空间时，ld 不查看间接 dylib，除非由直接 dylib 重新导出。另一方面，当链接平面命名空间时，ld 会加载所有间接 dylib 并使用它们来解析引用。

我不是 OS X 开发人员，但听起来您需要从 liba 重新导出 fooB() 或指定 -flat_namespace。

# sql-server - 这个 ssis 数据流转换是否正确？

> ID：458087
> 
> 赞同：0
> 
> 时间：2009-01-19T15:59:09.933
> 
> 标签：sql-server, ssis

我正在尝试将子字符串 trackingCode 提取到分隔符 ~~ 的位置。例如：

> www.test.com~~34235645463544563554

我希望返回：

> www.test.com

我在用：

`SUBSTRING(trackingCode,1,FINDSTRING(trackingCode,"~~",1) - 1)`

但它不起作用，我收到一个错误：

**错误：从文件导入时出现 0xC0049067，派生列 [1562]：评估函数时出错。**

有任何想法吗？如果我用数字替换 FINDSTRING ，那么它就可以工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T03:35:41.447

您的数据可能不符合您的预期。

信任但要验证。

除了您知道（通过直接测试）将始终符合预期的数据的琐碎转换之外，我会避免派生列转换。在派生列 xforms 中以单行格式难以阅读这些公式，并且您几乎无法控制和尝试不同的解析选项以及很少的故障/恢复模式。

我会为此推荐一个脚本任务。您可以将不符合的行路由到不同的路径，并使用数据查看器查看它们的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-17T20:17:35.360

这应该有效：

`SUBSTRING([trackingCode],1,(FINDSTRING([trackingCode],"\~~",1) - 1))`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T16:03:35.057

你确定每一行都有一个尾随数字吗？如果没有，这样的事情可能会有所帮助：

```
SUBSTRING(trackingCode+"~~",1,FINDSTRING(trackingCode,"~~",1) - 1) 
```

# c# - 业务逻辑层和数据访问层：循环依赖

> ID：458098
> 
> 赞同：24
> 
> 时间：2009-01-19T16:02:49.427
> 
> 标签：c#, design-patterns, architecture

我有一点架构问题。在我的项目中，我有一个业务逻辑层 (BLL)，其中包含我所有的业务规则、模型和接口的 OO API。每个对象都有像 getById 这样的静态方法，它们返回所述对象的实例。每个对象还具有保存和删除等方法。这是非常简单的 OO 代码。

现在我有一个数据访问层 (DAL)，包含在一个单独的命名空间中，对于每个 BLL 对象，我都有一个执行 getById 和保存命令的 DataClass 或“Repository”。所以在某种程度上，BLL save 和 getById 方法是围绕 DataClass 方法的一个薄层。

```
public static NewsItem GetByID(int id)
{
       return DataFactory.GetNewsItemRepository().GetNewsItemById(id);
} 
```

为了让 DataClasses 返回 BLL 对象，它们需要知道 BLL。所以现在我们有：

GUI ---> BLL <---->DAL

DataFactory 只返回实现接口的对象，因此我可以隐藏“OracleNewsItemRepository”等实现细节。

但是现在，自从我开始面向对象编程以来一直困扰着我的事情。在我目前的解决方案中，BLL 和 DAL 都需要相互了解。这是一个循环依赖，最好的做法是避免循环依赖。此外，我只想公开接口（和我的 DataFactory）而不是我的类。这可以通过将 DAL 层放置在单独的程序集中来完成。这是有道理的。但是，Visual Studio 不允许两个程序集相互引用。关于这个的另一个问题：[C# internal access modifiers](https://stackoverflow.com/questions/457044/c-internal-access-modifiers)

不知何故，我认为我的整个数据访问模式都错了。感觉就像我正在将 ActiveRecord 模式与 DataMappers 等其他东西复杂化。我在 Martin Fowler 的站点上花费了很多时间，但是这些模式的描述非常通用，并且由一个非常抽象的 UML 图来说明。

他们没有解决我的问题。可能我有点鸡肋，没有“完美的数据访问模式”这样的东西。而我现在所做的似乎并没有大错特错。但我现在做事的方式，似乎不对……</p>

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T16:12:42.433

我认为您的数据访问模式很好。你没有做的是将你的 BLL 耦合到 OracleDAL。您正在耦合到 DAL 接口。一定的耦合是绝对需要的，否则你永远无法完成任何事情。

我假设您的 DataFactory 和 INewsItemRepository 类存在于您的 DAL 层之外。以下是我的解决方案如何组织的示例。我不使用 ActiveRecord，所以这可能不适合你。

```
核心（项目）
  领域
    商业实体
  数据
    存储库接口
    **您的数据工厂**

甲骨文数据（项目）
  数据
    Oracle 信息库实施

SqlData（项目）
  数据
    Sql 存储库实现

用户界面（项目）

```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-19T16:18:31.017

在我看来：

数据访问层 (DAL) 应使用以下操作对 POCO（普通旧 CLR 对象）进行操作：`SaveNewsItem ( NewsItemDAO newsItemDAO )`. POCO 是您的 DAO（数据访问对象）。

业务层应该包含将数据访问对象 (DAO) 转换为丰富的业务对象的逻辑，这可能只是 DAO 加上一些操作以及任何修饰/丰富。

DAL 应该对业务逻辑层一无所知。理论上，它应该能够从任何客户端调用。例如，如果您想将 DAL 从应用程序中分离出来，并将其部署为通过 WCF 公开自身的单独服务，该怎么办？

如前所述，DAL 操作，例如 SaveNewsItem 应该由 BO 通过接口访问，可能通过依赖注入/IoC。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-19T17:34:20.973

您可以使用接口/依赖注入来解决您的问题。

您的业​​务层 (BL) 包含（可能不止一个）DAL 需要实现的数据访问 (DA) 接口。DAL 项目具有对 BL 的项目引用，因此它们可以输出业务对象 (BO) 并实现 DA 接口。

您的 BO 可以调用 DataFactory，它可以通过依赖注入或反射来实例化 DA 对象。

我已经在我们工作中的许多应用程序（基于 Web 和智能客户端）中使用了这种模式，并且它工作得很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T18:33:31.167

IceHeat，@Craig Wilson 的示例最有意义，它*可能*源自这篇文章： http: [//www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx](http://www.codeproject.com/KB/architecture/NHibernateBestPractices.aspx)。

这是值得一读的 WELL，它解决了您在此处面临的问题的领域驱动开发。我会把它推荐给任何人，即使你不给猴子关于 NHibernate 的一篇很棒的文章。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-25T23:56:15.610

它现在有点老了，但也许你应该考虑将 pocos/interfaces 放在另一个程序集中。

> ```
> Project.Data references Project.Entities
> Project.BL references Project.Entities and Project.Data
> Project.UI references Project.Entities and Project.BL 
> ```

这里没有循环引用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T17:50:49.363

为了清楚起见，我喜欢将业务模型和业务逻辑视为两个独立的层。您的业​​务模型是您的 POCO（普通旧 CLR 对象）。您的业​​务逻辑层将负责使用您的业务模型和可以通过多种方式连接的 DAL 接口（Spring、Castle 或您自己的本地 IoC 容器）执行验证、事务等。

使用业务模型在 DAL 中实现零依赖的一个好方法是使用已经构建的对象关系映射框架 (ORM)，例如 NHibernate（我最喜欢的 ORM 框架的无耻插件）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T19:11:12.587

我会从你 BLL（域模型）中删除任何 Get() 和 Save() 方法。这就是我要做的

GUI 将要求 Repository 通过 id 获取域对象。一旦 GUI 拥有域对象，您就可以导航它以访问其他对象。这样，域层不需要了解任何关于存储库的信息。

在存储库中，您可以返回延迟加载或完全加载对象对象图的域对象..这取决于您的需要..

这是关于同一主题的一篇很好的文章……[重构对象](http://steve.emxsoftware.com/Domain+Driven+Design/DDD+Reconstituting+objects+from+multiple+Repositories)

阅读 Deyan Petrov 关于如何使用动态代理的评论

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T18:31:52.730

DAL 必须是抽象的，因此它必须只包含与后端数据库交互的普通 ADO.NET 对象，例如连接 DataAdapter、DataReader 等。有了它，您可以在 Biz 层中引用 DAL，当涉及到您的实体时，您可以通过一点抽象来解决所有问题，例如，如果您有客户类，您可以创建一个抽象客户类来实现与 DAL 交互的基本操作，如保存、更新和检索数据，以及在另一个继承抽象类的类中覆盖基类方法实现以满足您的 Biz 验证等。

# perl - 如何在 Perl 中比较日期？

> ID：458107
> 
> 赞同：10
> 
> 时间：2009-01-19T16:04:08.813
> 
> 标签：perl, date

我有两个日期（使用[str2time](http://search.cpan.org/~gbarr/TimeDate-1.16/lib/Date/Parse.pm)解析）。我如何判断一个是在另一个之后？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-19T16:09:42.533

str2time 返回一个“unix 时间”，即 1970 年 1 月 1 日之后的秒数。所以你有两个整数，你可以像比较任何其他整数一样比较它们。

# language-agnostic - 将常数置于条件下的最佳位置在哪里？

> ID：458109
> 
> 赞同：0
> 
> 时间：2009-01-19T16:04:10.297
> 
> 标签：language-agnostic

将常数置于条件中的最佳位置在哪里？左侧还是右侧？

我个人在右侧使用：

```
if($value > 23)
{
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T16:07:24.410

很多人会说 LHS，因为它可以防止你做一些微妙和破坏性的事情，比如`if (foo = KBAR)`（注意缺少'=='），但我总是觉得这不利于可读性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T16:06:16.440

右侧。左侧是 C/C++ 中的传统，因为人们有时会忘记并使用“=”而不是“==”，并且在这种情况下将 const 放在左侧会导致编译错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T16:10:14.310

依靠：

如果 (23 <= i 并且 i <= 40)

但我更喜欢右边，它读起来更自然

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T16:07:59.417

把条件放在右边，因为那是“自然”的地方，如果你不小心使用`=`了`==`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T16:09:05.030

真的有关系吗？如果您保持约定，它可能会对您有所帮助*，*但无论是将常量保持在一侧，还是始终使用 <、<= 运算符并避免使用 >、>=; 这真的取决于你。

[正如ocdecio 的帖子](https://stackoverflow.com/questions/458109/where-is-the-best-place-to-put-the-constant-on-a-condition#458115)中所指出的，这对编译器/解释器肯定无关紧要，当您不小心写“设置为”（=）而不是“是否等于”（==）时，现代编译器应该给出明确的警告。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T16:17:40.533

一如既往，答案是“视情况而定”。在大多数情况下，将其放在右侧会更自然，就像在 OP 的示例中一样。在其他情况下，特别是检查某事物是否在某个范围内的复合语句（参见[Peter Miehle](https://stackoverflow.com/questions/458109/where-is-the-best-place-to-put-the-constant-on-a-condition#458138)'s example), it can go either way. I think you should use whichever makes the statement clearer to any future programmers who happen across your code. If there is no clear difference in readability, I recommend defaulting to putting it on the right, since that is what most people expect (principle of least surprise). As many have mentioned already, any decent compiler nowadays will warn you if you attempt to perform an assignment inside an if statement (you can usually silence this warning by putting an extra set of parentheses around the assignment). Also, it has been mentioned that some JIT or interpreted languages might make it hard to find this problem without the constant-on-the-left trick, but IIRC, many of them will also emit a warning in this case, so if you run them with warnings treated as errors, it will help you catch that problem.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T16:07:29.463

我更喜欢左侧，因为它可以防止像这样的意外分配：

```
// when using = instead of == this can result in accidental assignment
if ($value == null) {}

// $value cannot be accidentally assigned this way 
if (null === $value) {} 
```

**注意：**通过阅读我在使用编译语言时理解的其他答案，这可能会给您带来麻烦。我仍然更喜欢使用它，因为我的主要语言是 PHP。对于编译语言，请参考其他人已经给出的答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T16:16:41.613

始终使用 <（和 <=），从不使用 >（或 >=），并避免使用无法区分赋值和相等的语言。

规则的第一部分意味着您的条件中的数字按通常的顺序出现，左边最小，右边最大。*当您的条件包含多个术语（例如*3<x && x<=14）时，这是一个很大的帮助

规则的第二部分意味着让编译器对编译器擅长的事情大发雷霆（例如发现你输入了多少 ===== 符号）。

而且我做出这些断言是有力而肯定的，因为我知道这只是我的观点，没有正确或错误的答案。

问候

# java - 刷新 JTable 的 setCellEditor

> ID：458114
> 
> 赞同：0
> 
> 时间：2009-01-19T16:05:25.443
> 
> 标签：java, swing, jtable

我正在寻找上一个问题的答案， [并且](https://stackoverflow.com/questions/457463/putting-jcombobox-into-jtable)有一个巧妙的想法来克服`JTable`. 我需要编辑器逐行不同，而`JTable`每列只能处理一个编辑器。

所以我的想法是每次都使用 a`MouseListener`检查行和列`JTable`并设置新的编辑器。

但是，第二次调用`setCellEditor()`没有任何效果。编辑器仍然是第一个设置的。那么如何让“setCellEditor”为同一列再次工作？

这是`MouseListener`.

```
public void mouseClicked(MouseEvent e) {
    int cols = resultTable.columnAtPoint(new Point(e.getX(), e.getY()));
    int rows = resultTable.rowAtPoint(new Point(e.getX(), e.getY()));
    StorageObject item = (StorageObject) resultTable.getModel().getValueAt(rows, cols);
    TableColumn col = resultTable.getColumnModel().getColumn(cols);
    col.setCellEditor(new MyComboBoxEditor(item.list));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T16:34:12.187

我不确定您的代码为什么不起作用（自从我完成 Swing 以来已经有一段时间了），但是您为什么不直接覆盖

```
public TableCellEditor getCellEditor(int row, int column) 
```

在您的 JTable 上？维护您要为每一行使用的组合框的映射，并在您的覆盖方法中返回正确的组合框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T16:32:33.750

我的理论是，当所有注册到 Table/TableCell 的鼠标侦听器都被调用时，默认情况下安装到 API 类的那些将在您的鼠标侦听器之前被首先调用。这意味着导致获取编辑器的事件将在您将其设置为其他事件之前发生。有点像竞态条件，只是它实际上是在 API 源代码中的某个地方定义的......这是我的幼稚理论，我已经可以看到其中的一些漏洞，等等我的解决方案：

覆盖[JTable.getCellEditor(int row, int col)](http://java.sun.com/javase/6/docs/api/javax/swing/JTable.html#getCellEditor(int,%20int))。这使您可以为任何单元格返回所需的任何编辑器。

# css - Z-Index IE 错误修复？

> ID：458118
> 
> 赞同：7
> 
> 时间：2009-01-19T16:06:50.120
> 
> 标签：css, internet-explorer, z-index

有谁知道 ie z-index 错误的有效修复？我遇到了一些解决方案，但有兴趣看看这里是否有人知道更好的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T16:19:23.557

如果您的意思是[IE6 不尊重选择控件上的 z-index 的问题](http://blogs.msdn.com/ie/archive/2006/01/17/514076.aspx)，那么可以。

还有一些其他的。我认为最好的方法是通知用户 IE6 已被替换，他们最好使用 IE7、FF 或其他最近的浏览器版本，或者将他们引导到 MS 文章中解释问题及其行动方案。

您可能没有这种奢侈，在这种情况下，您应该尝试使用 select free 或其他一些出现在 google 搜索结果中的选项。这很糟糕，但你必须尝试其中一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T16:17:08.930

根据您要执行的操作，可能并不容易解决。这是对您的一些选项的[很好的讨论](http://mahzeh.org/?p=19)，包括不容易处理的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T03:11:21.310

如果你的问题是关于[IE 6 选择元素 z-index 的问题](http://blogs.msdn.com/ie/archive/2006/01/17/514076.aspx)，而你恰好使用 jQuery 进行开发，那么你可以试试方便的[jQuery bgiframe 插件](http://docs.jquery.com/Plugins/bgiframe)来解决它。:p

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-29T21:02:01.260

我使用了Honesty 推荐的[jQuery bgiframe 插件](http://docs.jquery.com/Plugins/bgiframe)，并添加了一个条件注释以防止它为其他浏览器加载。

[这篇文章](http://jetlogs.org/2008/05/09/jquery-fix-ie-select-box-z-index-bug/)有更多关于实现它的有用信息。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-01-18T18:42:46.290

确保您的浏览器未处于兼容模式！我在工作，IE 自动将我的浏览器设置为“以兼容模式显示 Intranet 站点”。我使用以下元标题来覆盖这个荒谬的设置：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" /> 
```

# c - 如何将 Win32 lParam 转换为 C 结构？

> ID：458121
> 
> 赞同：1
> 
> 时间：2009-01-19T16:07:35.517
> 
> 标签：c, winapi

假设我有一些 windows 方法和一个结构：

```
struct SomeStruct{
int foo;
int bar;
int baz;
int bat;
}

SomeMethod(int a,int wParam, int lParam)
{
   SomeStruct s;

   // get lParam into SomeStruct
} 
```

如何将 lParam 放入 SomeStruct 变量中？我在想我需要这样的东西（但请随时指出我的无知）：

```
SomeMethod(int a, int wParam, int lParam)
{
  SomeStruct *s; //declare struct variable
  s = lParam;    //assign integer value as pointer to struct
  printf("the value of s.foo is %d", s.foo);  //print result
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T16:12:32.090

是的，假设 lParam 'really' 包含一个指向结构的指针，那么你可以通过'casting' 得到它：

```
 SomeStruct* s; //declare pointer-to-struct variable
  s = (SomeStruct*) lParam;    //assign integer value as pointer to struct
  printf("the value of s->foo is %d", s->foo);  //print result 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-14T17:25:24.880

lParam 和 wParam 通常分别是 WPARAM 和 LPARAM 类型的变量的名称。WPARAM 和 LPARAM 类型的变量用于在 SendMessage、PostMessage、WindowProc、DefWindowProc - MS Windows API 以及消息处理程序（经常但不恰当地称为事件处理程序）中声明参数。历史上，在 16 位版本的 windows 中，WPARAM 被定义为 WORD（16 位）值，而 LPARAM 被定义为 LONG；这解释了名字。这两个参数都用作无类型 cookie，它们在消息中携带一些信息，无论是值还是包含由消息处理程序处理的更多信息的实体的地址。在 16 位世界中，WPARAM 用于携带近地址，LPARAM 用于携带远地址。WPARAM 和 LPARAM 是现在定义为 32 位值的类型。在 WinDef.h 的 SDK（软件开发工具包）中。WPARAM 在早期版本的 SDK 中定义为 UINT，现在定义为 UINT_PTR。LPARAM 在早期版本的 SDK 中定义为 LONG，现在定义为 LONG_PTR

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T20:46:27.357

将整数转换为指针时要小心。在 x64 架构上，`int`仍然是 32 位整数，但指针是 64 位的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T13:01:47.323

请使用正确的类型，否则您的代码*将*在 Win64 上失败。

```
SomeMethod(int a, WPARAM wParam, LPARAM lParam)
{
  SomeStruct *s = (SomeStruct *) lParam;
  printf("the value of s.foo is %d", s.foo);  //print result
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-19T16:26:21.377

抱歉，尝试将整数转换为指针是一个巨大的错误。要使用未定义的类型指针，只需使用*void 指针*。代替：

```
 struct SomeStruct {
    int foo;
    int bar;
    int baz;
    int bat;
}

SomeMethod(int a, int wParam, int lParam)
{
    SomeStruct *s; //declare struct variable
    s = lParam;    //assign integer value as pointer to struct
    printf("the value of s.foo is %d", s.foo);  //print result
} 
```

您可能会使用：

```
 struct SomeStruct {
    int foo;
    int bar;
    int baz;
    int bat;
}

SomeMethod(int a, int wParam, void *lParam)
{
    struct SomeStruct *s; //declare struct variable
    s = (struct SomeStruct *)lParam; //assign integer value as pointer to struct
    printf("the value of s.foo is %d", s->foo); //print result
} 
```

指向结构的具体指针也可以工作：

```
 SomeMethod(int a, int wParam, struct SomeStruct *lParam)
{
    printf("the value of s.foo is %d", lParam->foo);  //print result
} 
```

尝试阅读一些关于 C 的技巧，例如[C-FAQ](http://c-faq.com/)。

# hyperlink - 使用 XPath：在单元格 3 行中查找链接

> ID：458126
> 
> 赞同：1
> 
> 时间：2009-01-19T16:08:16.077
> 
> 标签：hyperlink, cell, xpath

我在一个表中有多行，其中一个是我想自动单击的链接。对于我的起点，我有最后一个实例，即一行包含文本“测试问题？”：

编号：1416

编辑/批准忽略电子邮件名称：提交者姓名

打开 N/A 位置：提交者位置

会员：没有

问题文本：测试问题？响应 1 文本：

响应 2 文本：

编号：1417

编辑/批准忽略电子邮件名称：提交者姓名

打开 N/A 位置：提交者位置

会员：没有

问题文本：测试问题？响应 1 文本：

响应 2 文本：

因此， //tr[td='Test Question?'][last()] 会类似于“问题文本：测试问题？”

无论如何，三排之后有一排有一堆链接。我想要第一个单元格中链接的 xpath。

现在我尝试使用 position()，但是像 //tr[position()=(//tr[td='Test Question?'][last()][position()])-3] 这样的东西只是'这样做的正确方法，我找不到任何好的例子。

谢谢

戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T16:16:55.233

至少可以说，这将是一个非常粗糙的 xpath，但是您正在查看[**轴**](http://www.w3schools.com/xpath/xpath_axes.asp)，`ancestor::tr`然后是前同级。隧道向上`<tr>`，然后穿过三个（我认为你需要在`position()`这里参考），然后以正常方式从那里向下到达你的目标。

* * *

编辑：比我想象的要容易，前面的兄弟倒数。

```
./ancestor::tr/preceding-sibling::tr[3]/td[1]/a 
```

# database - 你如何实现截断的 sha1 数据库键？

> ID：458132
> 
> 赞同：3
> 
> 时间：2009-01-19T16:09:37.820
> 
> 标签：database

我正在开发一个将实现服务 API 的多租户应用程序。出于安全原因和数据迁移/复制问题，我不想公开默认的自动增量密钥，因此我正在寻找替代密钥。GUID/UUID 是一个显而易见的选择，但它们使 URL 有点长，在阅读有关它们的文章时，我看到 Google 使用“截断 SHA1”作为它们的 URL ID。

这是如何运作的？我的理解是您散列部分/所有对象内容以得出密钥。我的对象会随着时间而改变，因此散列整个对象将不起作用，因为密钥需要随着时间的推移保持不变。我可以实现 UUID 并散列它们吗？将 SHA1 用于密钥（例如最大记录、冲突等）有哪些限制/问题？

我一直在搜索 Google，但没有找到正确的搜索查询。

/* 编辑：关于环境的更多信息 */
目前我们是一家使用 Spring/Hibernate 和 MySQL 的 Java 商店。我们正在将核心开发切换到 Grails，这将是实现这一想法的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:32:17.647

前段时间我想到了一个类似的问题，最终[在 URL 中实现了 Blowfish](http://alicebobandmallory.com/articles/2007/11/15/blowfish-in-the-url)。它不是超级安全，但提供的 URL 比 SHA256 短得多，而且它完全无冲突。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T15:24:46.833

这实际上是一个非常可靠的想法，尽管它可能会使键查找有点困难（除非您对键进行散列并将其保持在表中，我想）。你只需要散列你使用的每个键，但如果你是自动递增的，那没问题。您甚至不需要 GUID - 您甚至可以只散列密钥，因为它是一种单向操作并且不能轻易反转。您甚至可以在散列之前“加盐”您的密钥，这会使密钥变得不可预测，从而使其几乎牢不可破。

有一个关于冲突的问题，但是使用 SHA1，你的哈希是 160 位，或者有 1.46 × 10^48 个唯一值，这应该足以支持这么多唯一键的一部分，而不必担心冲突。如果你有足够多的密钥，你仍然担心碰撞，你可以升级到 SHA256 甚至 SHA512 之类的东西，这应该足够长以避免任何合理的碰撞问题。

如果您需要一些哈希代码，请发布您正在使用的语言，我可以找到一些，但如果您知道自己在寻找什么，网上有很多可用的。

# c# - 将 XAML 导入 WPF RichTextBox

> ID：458141
> 
> 赞同：3
> 
> 时间：2009-01-19T16:10:26.243
> 
> 标签：c#, wpf, xaml, silverlight, richtextbox

我有一个在 WPF Web 服务中动态构建的 WPF RichTextBox。此 Web 服务接受从第三方 silverlight RichTextBox 控件的内容中提取的 xaml 字符串。

```
<Paragraph TextAlignment=\"Left\"><Run FontFamily=\"Comic Sans MS\" FontSize=\"16\" Foreground=\"#FF0000FF\" FontWeight=\"Bold\" >This text is blue and bold.</Run></Paragraph> 
```

如何将此 xaml 插入到我的 WPF RichTextBox 中？我有点理解 FlowDocument 和 Paragraph and Run 的概念，所以我可以使用下面的代码用文本填充 WPF RichTextBox，

```
 FlowDocument flowDocument = new FlowDocument();
        Paragraph par = new Paragraph();
        par.FontSize = 16;
        par.FontWeight = FontWeights.Bold;
        par.Inlines.Add(new Run("Paragraph text"));
        flowDocument.Blocks.Add(par);
        rtb.Document = flowDocument; 
```

但是我真的不想自己解析 xaml 来构建一个段落，因为它会变得非常复杂。有没有办法让控件知道如何解析传入的 xaml？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T13:41:07.370

您可以使用 XamlReader 读取您的 Xaml 字符串并将其转换为控件：

```
string templateString = "<Paragraph xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"  TextAlignment=\"Left\"><Run FontFamily=\"Comic Sans MS\" FontSize=\"16\" Foreground=\"#FF0000FF\" FontWeight=\"Bold\" >This text is blue and bold.</Run></Paragraph>";
StringReader stringReader = new StringReader(templateString);
XmlReader xmlReader = XmlReader.Create(stringReader);
Paragraph template = (Paragraph)XamlReader.Load(xmlReader); 
```

只需确保在模板中包含以下标签：

```
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
```

高温高压

# domain-driven-design - 存储库模式：如何延迟加载？或者，我应该拆分这个聚合吗？

> ID：458146
> 
> 赞同：42
> 
> 时间：2009-01-19T16:10:57.787
> 
> 标签：domain-driven-design, repository-pattern, lazy-loading, aggregate, ddd-repositories

我有一个具有编辑器和项目概念的域模型。

一个Editor拥有多个Projects，一个Project不仅有一个Editor owner，还有多个Editor members。因此，一个编辑器也有许多“加入”的项目。

我正在采用 DDD 方法对此进行建模并使用存储库模式进行持久化。但是，我对模式的理解还不够好，无法确定我应该如何做到这一点。

我正在假设 Editor 和 Project 可能在同一个聚合中，根是 Editor。因此，我可以获得一个编辑器，然后枚举其项目，并可以从那里枚举项目的成员编辑器。

但是，如果我只被允许从我的存储库中检索编辑器，这是否意味着当我获得拥有它们的编辑器时，我必须从存储库中加载所有项目？如果我想延迟加载成员编辑器，项目是否也需要对存储库的引用？

或者，如果我拆分聚合并拥有一个编辑器存储库和一个项目存储库，我应该如何处理两者之间的事务，例如将新项目添加到编辑器时？例如：

```
Editor e = new Editor("Editor Name");
editorRepository.Add(e);

Project p = e.CreateProject("Project Name");
projectRepository.Add(p);    // These two lines
editorRepository.Save(e);    // should be atomic 
```

我是否误解了存储库模式的意图？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-14T04:40:20.537

> 我是否误解了存储库模式的意图？

我会说“是的”，但要知道我和我共事过的每个人都出于同样的原因问过同样的事情…… *“你不是在思考 4 维，马蒂”。*

让我们稍微简化一下，并首先坚持使用构造函数而不是 Create 方法：

```
Editor e = new Editor("Editor Name");
e = editorRepository.Add(e);

Project p = new Project("Project Name", e);
p = projectRepository.Add(p); 
```

在下面，您的项目存储库始终`p.EditorId`在创建项目数据时将有效所有者 ( ) 存储到项目数据中，无论您重新填充编辑器的项目，它都会在那里。这就是为什么将所有必需的属性放入构造函数是一种很好的做法。如果您不想传递整个对象，只需`e.Id`意志即可。

> 如果我想延迟加载成员编辑器，项目是否也需要对存储库的引用？

现在，关于如何按需重新填充编辑器的项目，您有几个选择，具体取决于您的目标。直接存储库说你想要：

```
IEnumerable<Project> list = projectRepository.GetAllProjects()
                                .Where(x => x.editorId == e.Id); 
```

但是放在哪里呢？不是在 Project 或 Editor 中，你是对的，否则他们将不得不访问存储库，这是不好的。上面的代码片段是松耦合的，但不能单独重用。您刚刚达到了存储库模式的极限。

接下来是您的应用程序的适配器层，具有存储库的共享源`StaticServiceWrapper`（流利地使用所有必要的存储库。我没有在生产系统中完全这样做过，但给你看一个简洁的例子：

```
public static class Aggregators
{
    // one to one, easy
    public static Editor GetOwner(this Project p)
    {
        return StaticServiceWrapper.editorRep.GetEditorById(p.editorId);
    }

    // one to many, medium
    public static IEnumerable<Project> GetProjects(this Editor e) 
    { 
        return StaticServiceWrapper.projectRep.GetAllProjects()
                .Where(x => x.editorId == e.Id);
    }

    // many to many, harder
    public static IEnumerable<Editor> GetMembers(this Project p)
    {
        var list = StaticServiceWrapper.projectMemberMap.GetAllMemberMaps()
                        .Where(x => x.projectId == p.projectId);

        foreach ( var item in list )
            yield return StaticServiceWrapper.editorRep.GetEditorById(item.editorId);
    }
} 
```

基本上，一旦您的 GetAll、GetById、Add、Update、Remove Object Repository 完成后，您就必须不理会关联，然后将对象/层层次结构向上移动到有趣的部分，例如适配器和缓存以及业务逻辑（*“哦，我的！”*）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-23T04:55:44.373

将职责拆分为 EditorOwner 和 EditorMember 怎么样？

在不知道您的域的情况下，我想他们会有不同的职责 - 例如，EditorOwner 可能非常丰富（并且可能是聚合根），但项目可能只需要了解其成员的有限数量，所以EditorMember 对象可能很轻。

这些域对象也可能与用户相关，但那将是在另一个上下文中。

这对事情有帮助，还是只是让它变得更复杂？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T02:45:29.643

这取决于您的应用程序的需求。如果为给定的编辑器加载所有项目是一个大问题，那么尝试像[虚拟代理](http://en.wikipedia.org/wiki/Lazy_loading#Virtual_proxy)这样的延迟加载模式。

关于延迟加载项目的成员编辑器，如果您使用虚拟代理，我看不到使用 EditorRepository 注入代理的问题，因为我不认为代理是域的一部分。

如果您拆分聚合，您可以研究[工作单元](http://martinfowler.com/eaaCatalog/unitOfWork.html)模式作为解决原子性的一种解决方案。不过，这个问题并不是 DDD 独有的，我相信还有其他针对事务行为的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T13:01:07.957

在这里，您有 2 种不同的关系，一种是所有权关系，一种是成员关系。

所有权关系是简单的一对多（每个项目一个所有者）。成员关系是多对多的（许多编辑按项目，许多项目按编辑）。

您可以在 Project 类上提供 Owner 属性，并在 ProjectRepository 上提供方法来获取特定编辑器拥有的所有项目。

对于多关系，在 Project 类上提供一个 Members 属性，在 ProjectRepository 上提供一个方法来获取包含指定 Editor 作为成员的所有项目。

编辑器和项目似乎也是实体，我可能会拆分聚合，但也许这些术语在您的上下文中具有特定含义，使其成为聚合的子实体。

# javascript - 显示带单引号的文本字段

> ID：458169
> 
> 赞同：0
> 
> 时间：2009-01-19T16:19:24.087
> 
> 标签：javascript, jquery

我正在开发一个应用程序，该应用程序需要一个文本字段来淡入 AJAX 加载的值。（我用 jQuery 做这一切），这是代码：

```
$("div#p"+eId+"_content").html("<input class='editPost' type='text' value='"
                               + oldCont
                               + "' id='p"
                               + eId 
                               + "_editBox' />"); 
```

不幸的是，`oldCont`可以包含单引号，这意味着文本框将只包含`oldPost`直到该单引号。我怎么能`oldCont`在没有这个问题的情况下显示，但仍然保留那个单引号（没有 \ 转义它）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T16:24:18.167

```
$("div#p"+eId+"_content")
  .append( $("<input type='text' id='p"+eId+"_editBox' />")
           .addClass('editPost').val(oldCont)); 
```

...我认为那些括号排成一行..... :-)

基本上，在 jquery 对象上使用 val 函数，它会为您处理转义。同样，您可以将 addClass、attr 等函数用于 html 对象的其他部分

# c# - C# 线程真的可以缓存一个值并忽略其他线程上对该值的更改吗？

> ID：458173
> 
> 赞同：27
> 
> 时间：2009-01-19T16:20:43.493
> 
> 标签：c#, multithreading

这个问题与*竞争*条件、原子性或为什么要在代码中使用锁无关。我已经知道这些了。

更新：我的问题不是“是否存在易失性内存的怪异”（我知道确实存在），我的问题是“.NET 运行时是否抽象了它，所以你永远不会看到它”。

请参阅[http://www.yoda.arachsys.com/csharp/threads/volatility.shtml](http://www.yoda.arachsys.com/csharp/threads/volatility.shtml) 以及[字符串属性本身是线程安全的吗？](https://stackoverflow.com/questions/434890/is-a-string-property-itself-threadsafe)

（它们实际上是同一篇文章，因为一个引用另一个。）一个线程设置一个布尔值，另一个线程循环永远读取该布尔值——那些文章声称读取线程可能缓存旧值而从不读取新值，所以因此您需要一个锁（或使用 volatile 关键字）。他们声称以下代码可能会永远循环。现在我同意锁定变量是一种很好的做法，但我不敢相信 .NET 运行时真的会像文章声称的那样忽略内存值的变化。我理解他们关于易失性内存与非易失性内存的讨论，我同意他们在*非托管方面有一个有效的观点*代码，但我无法相信 .NET 运行时不会正确地将其抽象出来，以便以下代码可以满足您的期望。这篇文章甚至承认代码“几乎可以肯定”会起作用（尽管不能保证），所以我打电话给 BS。任何人都可以验证以下代码是否始终有效吗？有没有人能够得到一个失败的案例（也许你不能总是重现它）？

```
class BackgroundTaskDemo
{
    private bool stopping = false;

    static void Main()
    {
        BackgroundTaskDemo demo = new BackgroundTaskDemo();
        new Thread(demo.DoWork).Start();
        Thread.Sleep(5000);
        demo.stopping = true;
    }

    static void DoWork()
    {
         while (!stopping)
         {
               // Do something here
         }
    }
} 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-19T16:25:49.893

关键是：它可能会起作用，但不能**保证**符合规范。人们通常追求的是出于正确原因工作的代码，而不是通过编译器、运行时和 JIT 的侥幸组合来工作，这*可能会*在框架版本、物理 CPU、平台以及 x86 与 x86 之类的东西之间发生变化x64。

理解内存模型是一个非常非常复杂的领域，我并不自称是专家；但是该领域真正**的**专家向我保证，您所看到的行为是无法保证的。

您可以发布任意数量的工作示例，但不幸的是，除了“它通常有效”之外，这并不能证明太多。它当然不能证明它可以**保证**工作。只需一个反例即可反驳，但发现它是问题所在......

~~不，我手头没有。~~

* * *

更新可重复的反例：

```
using System.Threading;
using System;
static class BackgroundTaskDemo
{
    // make this volatile to fix it
    private static bool stopping = false;

    static void Main()
    {
        new Thread(DoWork).Start();
        Thread.Sleep(5000);
        stopping = true;

        Console.WriteLine("Main exit");
        Console.ReadLine();
    }

    static void DoWork()
    {
        int i = 0;
        while (!stopping)
        {
            i++;
        }

        Console.WriteLine("DoWork exit " + i);
    }
} 
```

输出：

```
Main exit 
```

但仍在运行，CPU 满载；请注意，此时`stopping`已设置为`true`。这`ReadLine`是为了使该过程不会终止。优化似乎取决于循环内代码的大小（因此`i++`）。它显然只在“发布”模式下工作。添加`volatile`，一切正常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T17:42:23.827

此示例包含作为注释的本机 x86 代码，以演示控制变量 ('stopLooping') 已缓存。

将 'stopLooping' 更改为 volatile 以“修复”它。

这是使用 Visual Studio 2008 作为发布版本构建的，无需调试即可运行。

```
 using System;

 using System.Threading;

/* A simple console application which demonstrates the need for 
 the volatile keyword and shows the native x86 (JITed) code.*/

static class LoopForeverIfWeLoopOnce
{

    private static bool stopLooping = false;

    static void Main()
    {
        new Thread(Loop).Start();
        Thread.Sleep(1000);
        stopLooping = true;
        Console.Write("Main() is waiting for Enter to be pressed...");
        Console.ReadLine();
        Console.WriteLine("Main() is returning.");
    }

    static void Loop()
    {
        /*
         * Stack frame setup (Native x86 code):
         *  00000000  push        ebp  
         *  00000001  mov         ebp,esp 
         *  00000003  push        edi  
         *  00000004  push        esi  
         */

        int i = 0;
        /*
         * Initialize 'i' to zero ('i' is in register edi)
         *  00000005  xor         edi,edi 
         */

        while (!stopLooping)
            /*
             * Load 'stopLooping' into eax, test and skip loop if != 0
             *  00000007  movzx       eax,byte ptr ds:[001E2FE0h] 
             *  0000000e  test        eax,eax 
             *  00000010  jne         00000017 
             */
        {
            i++;
            /*
             * Increment 'i'
             *  00000012  inc         edi  
             */

            /*
             * Test the cached value of 'stopped' still in
             * register eax and do it again if it's still
             * zero (false), which it is if we get here:
             *  00000013  test        eax,eax 
             *  00000015  je          00000012 
             */
        }

        Console.WriteLine("i={0}", i);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T16:29:04.473

FWIW：

*   我从 MS C++ 编译器（非托管代码）**中**看到了这种编译器优化。
*   我不知道它是否发生在 C#
*   调试时不会发生（调试时会自动禁用编译器优化）
*   即使该优化现在没有发生，您也可以打赌他们永远不会在 JIT 编译器的未来版本中引入该优化。

# sql - SQL Server 中的伪随机可重复排序（不是 NEWID() 和 RAND()）

> ID：458175
> 
> 赞同：14
> 
> 时间：2009-01-19T16:20:58.733
> 
> 标签：sql, sql-server, tsql, random, paging

我想以可重复的方式对结果进行随机排序，以用于分页等目的。因为这个 NEWID() 太随机了，无法重新获得相同的结果。按 Rand（种子）排序将是理想的，因为使用相同的种子会产生相同的随机收集。不幸的是，Rand() 状态每行都会重置，有人有解决方案吗？

```
declare @seed as int;
set @seed = 1000;

create table temp (
id int,
date datetime)

insert into temp (id, date) values (1,'20090119')
insert into temp (id, date) values (2,'20090118')
insert into temp (id, date) values (3,'20090117')
insert into temp (id, date) values (4,'20090116')
insert into temp (id, date) values (5,'20090115')
insert into temp (id, date) values (6,'20090114')

-- re-seeds for every item
select *, RAND(), RAND(id+@seed) as r from temp order by r
--1 2009-01-19 00:00:00.000 0.277720118060575   0.732224964471124
--2 2009-01-18 00:00:00.000 0.277720118060575   0.732243597442382
--3 2009-01-17 00:00:00.000 0.277720118060575   0.73226223041364
--4 2009-01-16 00:00:00.000 0.277720118060575   0.732280863384898
--5 2009-01-15 00:00:00.000 0.277720118060575   0.732299496356156
--6 2009-01-14 00:00:00.000 0.277720118060575   0.732318129327415
-- Note how the last column is +=~0.00002

drop table temp

-- interestingly this works:
select RAND(@seed), RAND()
--0.732206331499865 0.306382810665955 
```

请注意，我尝试了 Rand(ID) 但结果只是排序。显然兰德(n) < 兰德(n+1)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-19T16:42:15.227

建立在 gkrogers 哈希建议的基础上，这很有效。对性能有什么想法吗？

```
declare @seed as int;
set @seed = 10;

create table temp (
id int,
date datetime)

insert into temp (id, date) values (1,'20090119')
insert into temp (id, date) values (2,'20090118')
insert into temp (id, date) values (3,'20090117')
insert into temp (id, date) values (4,'20090116')
insert into temp (id, date) values (5,'20090115')
insert into temp (id, date) values (6,'20090114')

-- re-seeds for every item
select *, HASHBYTES('md5',cast(id+@seed as varchar)) r
from temp order by r
--1 2009-01-19 00:00:00.000 0x6512BD43D9CAA6E02C990B0A82652DCA
--5 2009-01-15 00:00:00.000 0x9BF31C7FF062936A96D3C8BD1F8F2FF3
--4 2009-01-16 00:00:00.000 0xAAB3238922BCC25A6F606EB525FFDC56
--2 2009-01-18 00:00:00.000 0xC20AD4D76FE97759AA27A0C99BFF6710
--3 2009-01-17 00:00:00.000 0xC51CE410C124A10E0DB5E4B97FC2AF39
--6 2009-01-14 00:00:00.000 0xC74D97B01EAE257E44AA9D5BADE97BAF

drop table temp 
```

编辑：注意，@seed 在查询中使用的声明可以用参数替换，如果使用动态 SQL，则可以用常量 int 替换。（不需要以 TSQL 方式声明 @int）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T16:28:55.503

您可以使用每一行的值来重新评估 rand 函数：

```
Select *, Rand(@seed + id) as r from temp order by r 
```

添加 ID 可确保为每一行重新播种 rand。但是对于种子的值，您将始终返回相同的行序列（前提是表没有更改）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T18:45:54.963

创建散列可能比创建种子随机数更耗时。

要获得 RAND([seed]) 输出的更多变化，您需要使 [seed] 也有显着变化。可能比如...

```
SELECT
    *,
    RAND(id * 9999)    AS [r]
FROM
   temp
ORDER BY
   r 
```

使用常量可确保您要求的可复制性。但是如果您希望您的表足够大，请注意 (id * 9999) 导致溢出的结果......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T15:36:19.427

```
SELECT *, checksum(id) AS r FROM table ORDER BY r 
```

这种作品。虽然 checksum() 的输出在我看来并不是那么随机。[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms189788.aspx)指出：

> [...]，我们不建议使用 CHECKSUM 来检测值是否已更改，除非您的应用程序可以容忍偶尔丢失更改。考虑改用 HashBytes。当指定 MD5 哈希算法时，HashBytes 对两个不同的输入返回相同结果的概率远低于 CHECKSUM。

但可能会更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T16:45:39.557

在做了一些阅读之后，这是一种公认​​的方法。

```
Select Rand(@seed) -- now rand is seeded

Select *, 0 * id + Rand() as r from temp order by r 
```

在表达式中有 id 会导致它在每一行都被重新评估。但是将它乘以 0 确保它不会影响 rand 的结果。

多么可怕的做事方式！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-24T23:17:02.083

```
create table temp (
id int,
date datetime)

insert into temp (id, date) values (1,'20090119')
insert into temp (id, date) values (2,'20090118')
insert into temp (id, date) values (3,'20090117')
insert into temp (id, date) values (4,'20090116')
insert into temp (id, date) values (5,'20090115')
insert into temp (id, date) values (6,'20090114')

-- re-seeds for every item
select *, NEWID() r
from temp order by r

drop table temp 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-23T20:28:59.247

这在过去对我来说效果很好，它可以应用于任何表（只需在 ORDER BY 子句上加上螺栓）：

```
SELECT *
FROM MY_TABLE
ORDER BY  
  (SELECT ABS(CAST(NEWID() AS BINARY(6)) % 1000) + 1); 
```

# watin - 我可以用 WatiN 阅读 JavaScript 警告框吗？

> ID：458177
> 
> 赞同：11
> 
> 时间：2009-01-19T16:21:14.973
> 
> 标签：watin

我想使用 WatiN 来验证 JavaScript 警报框中的错误消息。这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T16:39:59.523

请参阅[Trev 的博客](http://tmichealson.blogspot.com/2007/01/handling-alerts-in-watin.html)和[此处](http://tmichealson.blogspot.com/2007/03/use-once-dialog.html)。

```
using(IE ie = new IE("http://hostname/pagename.htm"))
{
    AlertDialogHandler alertDialogHandler = new AlertDialogHandler();
    using (new UseDialogOnce(ie.DialogWatcher, alertDialogHandler ))
    {
        /*************************************
        * -- alert -- *
        * *
        * must use the "NoWait" to allow *
        * the code to goto the next line *
        * *
        *************************************/

        alertDialogHandler.WaitUntilExists();
        alertDialogHandler.OKButton.Click();
        ie.WaitForComplete();
    }
} 
```

# svn - SVN 是否压缩二进制内容？

> ID：458182
> 
> 赞同：8
> 
> 时间：2009-01-19T16:23:07.700
> 
> 标签：svn, compression

我想知道SVN是否真的在提交期间压缩了服务器上的二进制内容？我知道二进制存储 diffgrams 用于比较和版本控制，但想知道提交的新文件是否会在服务器上占用与客户端 PC 上相同的卷？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T16:29:07.360

我相信是这样。

从这里：http: [//svn.apache.org/repos/asf/subversion/trunk/INSTALL](http://svn.apache.org/repos/asf/subversion/trunk/INSTALL)

> ```
>  * libz  (REQUIRED for client and server) 
> ```

```
 Subversion uses zlib for compressing binary differences.
     These diff streams are used everywhere -- over the network,
     in the repository, and in the client's working copy. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T16:31:26.967

是的，Subversion 会压缩新文件以及更改。（服务器不关心文件是文本还是二进制文件。）

但是请注意：如果您添加的文件已经被压缩（例如 zip 存档、mp3 文件、JPEG、GIF），subversion 将无法使其更小。

# sharepoint - 由于 Resources.en-US.resx 文件，Sharepoint Web 部件停止工作

> ID：458202
> 
> 赞同：0
> 
> 时间：2009-01-19T16:27:54.257
> 
> 标签：sharepoint, web-parts, resx

我一直在开发一个 Sharepoint Web 部件，它在部署时运行良好。Web 部件已使用 WSP Builder 开发、打包，然后通过 stsadm 进行部署。Web 部件已部署到开发盒数十甚至一百次，没有任何问题。现在，Web 部件抛出一个错误，破坏了它所在的页面：

> 你调用的对象是空的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.NullReferenceException：对象引用未设置为对象的实例。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [NullReferenceException: 对象引用未设置为对象的实例。]
> NYCIRB.DMS.WebParts.SearchUpload.SearchUpload.HandleException(Exception ex) +62
> NYCIRB.DMS.WebParts.SearchUpload.SearchUpload.OnLoad(EventArgs e) +214
> System .Web.UI.Control.LoadRecursive() +50 System.Web.UI.Control.LoadRecursive() +141 System.Web.UI.Control.LoadRecursive() +141 System.Web.UI.Control.LoadRecursive() + 141 System.Web.UI.Control.LoadRecursive() +141 System.Web.UI.Control.LoadRecursive() +141 System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint） +627

查看我的 Sharepoint 日志时，我发现这些错误反复出现，这与尝试加载 Web 部件的时间相对应：

> 01/19/2009 10:53:14.43 w3wp.exe (0x05E0)
> 0x00FC Windows SharePoint Services
> 一般
> 72kg 高（#2：无法打开“Resources.en-US.resx”：没有这样的文件或文件夹。）01/19/ 2009 10:53:14.43 w3wp.exe (0x05E0)
> 0x00FC Windows SharePoint Services
> 常规
> 8e26 中 无法打开 Fea367b94a9-4a15-42ba-b4a2-32420363e018 密钥文件资源的语言资源。2009 年 1 月 19 日 10:53:17.55 w3wp.exe (0x05E0)
> 0x00FC Windows SharePoint Services
> 常规
> 8e25 中 无法使用密钥“XomlUrl”查找字符串，密钥文件核心。2009 年 1 月 19 日 10:53:17.55 w3wp.exe (0x05E0)
> 0x00FC Windows SharePoint Services
> 
> 找不到用于路径为“C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\Template\Features\Fields\fieldswss.xml”的文件的令牌“XomlUrl”的 常规8l3c 中本地化资源。
> 2009 年 1 月 19 日 10:53:17.55 w3wp.exe (0x05E0)
> 0x00FC Windows SharePoint Services
> 常规
> 8e25 中 无法使用密钥“RulesUrl”，密钥文件核心查找字符串。2009 年 1 月 19 日 10:53:17.55 w3wp.exe (0x05E0)
> 0x00FC Windows SharePoint Services
> 常规
> 8l3c 找不到令牌“RulesUrl”的中等本地化资源，用于路径为“C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\Template\Features\Fields\fieldswss.xml”的文件。

我已经通过解决方案管理手动撤回了 web 部件，通过 stsadm 撤回了，检查了资源文件是否存在，找不到。我几乎不知道为什么会发生这种情况或如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T13:34:39.083

尝试确保所有资源文件都包含所有行。在经典 aspx 中，如果您有 resources.resx 和 resources.en-us.resx 并且第二个不包含某些条目，框架会自动查找默认文件并提供默认翻译。可悲的是，它在 MOSS 中不能这样工作。

# python - 有没有办法分离 matplotlib 图以便计算可以继续？

> ID：458209
> 
> 赞同：283
> 
> 时间：2009-01-19T16:30:57.980
> 
> 标签：python, matplotlib, plot

在 Python 解释器中执行这些指令后，您会看到一个带有绘图的窗口：

```
from matplotlib.pyplot import *
plot([1,2,3])
show()
# other code 
```

不幸的是，我不知道如何`show()`在程序进行进一步计算时继续以交互方式探索创建的图形。

有可能吗？有时计算很长，如果在检查中间结果的过程中继续进行会有所帮助。

* * *

## 回答 #1

> 赞同：243
> 
> 时间：2009-01-19T16:52:17.983

使用`matplotlib`不会阻塞的调用：

使用`draw()`：

```
from matplotlib.pyplot import plot, draw, show
plot([1,2,3])
draw()
print('continue computation')

# at the end call show to ensure window won't close.
show() 
```

使用交互模式：

```
from matplotlib.pyplot import plot, ion, show
ion() # enables interactive mode
plot([1,2,3]) # result shows immediatelly (implicit draw())

print('continue computation')

# at the end call show to ensure window won't close.
show() 
```

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2012-11-13T13:40:54.717

使用关键字 'block' 覆盖阻止行为，例如

```
from matplotlib.pyplot import show, plot

plot(1)  
show(block=False)

# your code 
```

继续您的代码。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-01-19T16:40:24.983

如果它支持以**非阻塞**方式使用，最好始终检查您正在使用的库。

但是，如果您想要一个更通用的解决方案，或者没有其他方法，您可以使用[`multprocessing`](http://docs.python.org/library/multiprocessing.html)python 中包含的模块在单独的进程中运行任何阻塞的东西。计算将继续：

```
from multiprocessing import Process
from matplotlib.pyplot import plot, show

def plot_graph(*args):
    for data in args:
        plot(data)
    show()

p = Process(target=plot_graph, args=([1, 2, 3],))
p.start()

print 'yay'
print 'computation continues...'
print 'that rocks.'

print 'Now lets wait for the graph be closed to continue...:'
p.join() 
```

这具有启动新进程的开销，并且有时在复杂场景中更难调试，所以我更喜欢其他解决方案（使用`matplotlib`'s 的[非阻塞 API 调用](https://stackoverflow.com/questions/458209/is-there-a-way-to-detach-matplotlib-plots-so-that-the-computation-can-continue#458295)）

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2013-01-18T11:53:33.170

尝试

```
import matplotlib.pyplot as plt
plt.plot([1,2,3])
plt.show(block=False)
# other code
# [...]

# Put
plt.show()
# at the very end of your script to make sure Python doesn't bail out
# before you finished examining. 
```

[`show()`文档](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show)说：

> 在非交互模式下，显示所有图形并阻塞，直到图形关闭；在交互模式下，除非在从非交互模式更改为交互模式之前创建图形（不推荐），否则它不起作用。在这种情况下，它会显示数字但不会阻塞。
> 
> 单个实验性关键字参数 block 可以设置为 True 或 False 以覆盖上述阻止行为。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2017-03-08T14:37:09.667

**重要提示**：只是为了说清楚。我假设命令在`.py`脚本中，并且使用例如`python script.py`从控制台调用脚本。

一个对我有用的简单方法是：

1.  在 show 中使用 block = False ：**plt.show(block = False)**
2.  在 .py 脚本**的末尾**使用**另一个**show() 。

 *** * *

**文件示例** `script.py`：

```
plt.imshow(*something*)                                                               
plt.colorbar()                                                                             
plt.xlabel("true ")                                                                   
plt.ylabel("predicted ")                                                              
plt.title(" the matrix")  

# Add block = False                                           
plt.show(block = False)

################################
# OTHER CALCULATIONS AND CODE HERE ! ! !
################################

# the next command is the last line of my script
plt.show() 
```

* * *

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-19T17:00:04.630

您可能想在`matplotlib`的文档中阅读此文档，标题为：

[在 python shell 中使用 matplotlib](http://matplotlib.sourceforge.net/users/shell.html#using-matplotlib-in-a-python-shell)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-21T14:05:30.923

就我而言，我希望在计算它们时弹出几个窗口。供参考，方法如下：

```
from matplotlib.pyplot import draw, figure, show
f1, f2 = figure(), figure()
af1 = f1.add_subplot(111)
af2 = f2.add_subplot(111)
af1.plot([1,2,3])
af2.plot([6,5,4])
draw() 
print 'continuing computation'
show() 
```

PS。matplotlib 的 OO 界面非常有用[的指南](https://github.com/ericliang/matplotlib/blob/master/branches/unit_support/htdocs/leftwich_tut.txt)。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-11-10T21:55:48.713

好吧，我在弄清楚非阻塞命令时遇到了很大的麻烦......但最后，我设法重新编写了“ [Cookbook/Matplotlib/Animations - Animating selected plot elements](http://www.scipy.org/Cookbook/Matplotlib/Animations#head-3d51654b8306b1585664e7fe060a60fc76e5aa08) ”示例，因此它适用于线程（*并在线程之间传递数据）通过全局变量，或通过多`Pipe`*进程）在 Ubuntu 10.04 上的 Python 2.6.5 上。

该脚本可以在这里找到：[Animating_selected_plot_elements-thread.py](http://sdaaubckp.svn.sourceforge.net/viewvc/sdaaubckp/single-scripts/Animating_selected_plot_elements-thread.py?revision=101&content-type=text%2Fplain) - 否则粘贴在下面（*注释较少*）以供参考：

```
import sys
import gtk, gobject
import matplotlib
matplotlib.use('GTKAgg')
import pylab as p
import numpy as nx 
import time

import threading 

ax = p.subplot(111)
canvas = ax.figure.canvas

# for profiling
tstart = time.time()

# create the initial line
x = nx.arange(0,2*nx.pi,0.01)
line, = ax.plot(x, nx.sin(x), animated=True)

# save the clean slate background -- everything but the animated line
# is drawn and saved in the pixel buffer background
background = canvas.copy_from_bbox(ax.bbox)

# just a plain global var to pass data (from main, to plot update thread)
global mypass

# http://docs.python.org/library/multiprocessing.html#pipes-and-queues
from multiprocessing import Pipe
global pipe1main, pipe1upd
pipe1main, pipe1upd = Pipe()

# the kind of processing we might want to do in a main() function,
# will now be done in a "main thread" - so it can run in
# parallel with gobject.idle_add(update_line)
def threadMainTest():
    global mypass
    global runthread
    global pipe1main

    print "tt"

    interncount = 1

    while runthread: 
        mypass += 1
        if mypass > 100: # start "speeding up" animation, only after 100 counts have passed
            interncount *= 1.03
        pipe1main.send(interncount)
        time.sleep(0.01)
    return

# main plot / GUI update
def update_line(*args):
    global mypass
    global t0
    global runthread
    global pipe1upd

    if not runthread:
        return False 

    if pipe1upd.poll(): # check first if there is anything to receive
        myinterncount = pipe1upd.recv()

    update_line.cnt = mypass

    # restore the clean slate background
    canvas.restore_region(background)
    # update the data
    line.set_ydata(nx.sin(x+(update_line.cnt+myinterncount)/10.0))
    # just draw the animated artist
    ax.draw_artist(line)
    # just redraw the axes rectangle
    canvas.blit(ax.bbox)

    if update_line.cnt>=500:
        # print the timing info and quit
        print 'FPS:' , update_line.cnt/(time.time()-tstart)

        runthread=0
        t0.join(1)   
        print "exiting"
        sys.exit(0)

    return True

global runthread

update_line.cnt = 0
mypass = 0

runthread=1

gobject.idle_add(update_line)

global t0
t0 = threading.Thread(target=threadMainTest)
t0.start() 

# start the graphics update thread
p.show()

print "out" # will never print - show() blocks indefinitely! 
```

希望这对某人有帮助，
干杯！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-12-18T18:21:54.910

在许多情况下，**将图像保存**为硬盘上的 .png 文件会更方便。原因如下：

**好处：**

*   您可以在此过程中随时打开、查看和关闭它。当您的应用程序运行很长时间时，这特别方便。
*   什么都不会弹出，您也不会被迫打开窗户。当您处理许多图形时，这特别方便。
*   您的图像可供以后参考，并且在关闭图形窗口时不会丢失。

**退税：**

*   我唯一能想到的是，您必须自己去查找文件夹并打开图像。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-01-18T11:11:44.670

如果您在控制台中工作，即`IPython`您可以`plt.show(block=False)`按照其他答案中的说明使用。但如果你很懒，你可以输入：

```
plt.show(0) 
```

这将是相同的。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-11-09T14:16:16.620

我还必须添加`plt.pause(0.001)`到我的代码中才能真正使它在 for 循环中工作（否则它只会显示第一个和最后一个图）：

```
import matplotlib.pyplot as plt

plt.scatter([0], [1])
plt.draw()
plt.show(block=False)

for i in range(10):
    plt.scatter([i], [i+1])
    plt.draw()
    plt.pause(0.001) 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-03-17T05:06:56.213

在我的系统上 show() 不会阻塞，尽管我希望脚本在继续之前等待用户与图形交互（并使用“pick_event”回调收集数据）。

为了在绘图窗口关闭之前阻止执行，我使用了以下内容：

```
fig = plt.figure()
ax = fig.add_subplot(1,1,1)
ax.plot(x,y)

# set processing to continue when window closed
def onclose(event):
    fig.canvas.stop_event_loop()
fig.canvas.mpl_connect('close_event', onclose)

fig.show() # this call does not block on my system
fig.canvas.start_event_loop_default() # block here until window closed

# continue with further processing, perhaps using result from callbacks 
```

但是请注意，canvas.start_event_loop_default() 产生了以下警告：

```
C:\Python26\lib\site-packages\matplotlib\backend_bases.py:2051: DeprecationWarning: Using default event loop until function specific to this GUI is implemented
  warnings.warn(str,DeprecationWarning) 
```

尽管脚本仍在运行。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-11-04T12:14:28.230

我还希望我的绘图显示运行其余代码（然后继续显示），即使出现错误（我有时使用绘图进行调试）。我编写了这个小技巧，以便该`with`语句中的任何情节都如此。

这可能有点太不标准了，不建议用于生产代码。这段代码中可能有很多隐藏的“陷阱”。

```
from contextlib import contextmanager

@contextmanager
def keep_plots_open(keep_show_open_on_exit=True, even_when_error=True):
    '''
    To continue excecuting code when plt.show() is called
    and keep the plot on displaying before this contex manager exits
    (even if an error caused the exit).
    '''
    import matplotlib.pyplot
    show_original = matplotlib.pyplot.show
    def show_replacement(*args, **kwargs):
        kwargs['block'] = False
        show_original(*args, **kwargs)
    matplotlib.pyplot.show = show_replacement

    pylab_exists = True
    try:
        import pylab
    except ImportError: 
        pylab_exists = False
    if pylab_exists:
        pylab.show = show_replacement

    try:
        yield
    except Exception, err:
        if keep_show_open_on_exit and even_when_error:
            print "*********************************************"
            print "Error early edition while waiting for show():" 
            print "*********************************************"
            import traceback
            print traceback.format_exc()
            show_original()
            print "*********************************************"
            raise
    finally:
        matplotlib.pyplot.show = show_original
        if pylab_exists:
            pylab.show = show_original
    if keep_show_open_on_exit:
        show_original()

# ***********************
# Running example
# ***********************
import pylab as pl
import time
if __name__ == '__main__':
    with keep_plots_open():
        pl.figure('a')
        pl.plot([1,2,3], [4,5,6])     
        pl.plot([3,2,1], [4,5,6])
        pl.show()

        pl.figure('b')
        pl.plot([1,2,3], [4,5,6])
        pl.show()

        time.sleep(1)
        print '...'
        time.sleep(1)
        print '...'
        time.sleep(1)
        print '...'
        this_will_surely_cause_an_error 
```

如果/当我实施适当的“保持绘图打开（即使发生错误）并允许显示新绘图”时，如果没有用户干预告诉它，我希望脚本正确退出（用于批量执行目的）。

我可能会使用类似超时问题“脚本结束！\n如果您希望绘图输出暂停（您有 5 秒），请按 p：”来自[https://stackoverflow.com/questions/26704840/corner -cases-for-my-wait-for-user-input-interruption-implementation](https://stackoverflow.com/questions/26704840/corner-cases-for-my-wait-for-user-input-interruption-implementation)。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-02-21T06:27:52.817

```
plt.figure(1)
plt.imshow(your_first_image)

plt.figure(2)
plt.imshow(your_second_image)

plt.show(block=False) # That's important 

raw_input("Press ENTER to exist") # Useful when you run your Python script from the terminal and you want to hold the running to see your figures until you press Enter 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-07-11T05:43:29.553

OP询问有关分离`matplotlib`情节的问题。大多数答案都假设从 python 解释器中执行命令。这里介绍的用例是我偏好在运行 a 的终端（例如 bash）中测试代码，`file.py`并且您希望绘图出现但 python 脚本完成并返回命令提示符。

这个独立文件用于`multiprocessing`启动一个单独的过程来绘制数据`matplotlib`。主线程使用本文`os._exit(1)`中提到的[方法](https://stackoverflow.com/questions/24694763/how-to-let-the-child-process-live-when-parent-process-exited)退出。`os._exit()`强制 main 退出，但让子`matplotlib`进程保持活动状态并做出响应，直到绘图窗口关闭。这完全是一个单独的过程。

这种方法有点像 Matlab 开发会话，带有带有响应式命令提示符的图形窗口。使用这种方法，您将失去与图形窗口进程的所有联系，但是，这对于开发和调试来说是可以的。只需关闭窗口并继续测试。

`multiprocessing`专为仅 python 的代码执行而设计，这使得它可能比`subprocess`. `multiprocessing`是跨平台的，所以这应该在 Windows 或 Mac 中运行良好，几乎不需要调整。无需检查底层操作系统。这是在 linux、Ubuntu 18.04LTS 上测试的。

```
#!/usr/bin/python3

import time
import multiprocessing
import os

def plot_graph(data):
    from matplotlib.pyplot import plot, draw, show
    print("entered plot_graph()")
    plot(data)
    show() # this will block and remain a viable process as long as the figure window is open
    print("exiting plot_graph() process")

if __name__ == "__main__":
    print("starting __main__")
    multiprocessing.Process(target=plot_graph, args=([1, 2, 3],)).start()
    time.sleep(5)
    print("exiting main")
    os._exit(0) # this exits immediately with no cleanup or buffer flushing 
```

运行`file.py`会打开一个图形窗口，然后`__main__`退出，但`multiprocessing`+`matplotlib`图形窗口仍然响应缩放、平移和其他按钮，因为它是一个独立的过程。

在 bash 命令提示符下检查进程：

`ps ax|grep -v grep |grep file.py`

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-12-27T06:17:15.197

在我看来，这个线程中的答案提供的方法并不适用于每个系统以及动画等更复杂的情况。我建议在以下线程中查看 MiKTeX 的答案，其中找到了一个可靠的方法： [如何等到 matplotlib 动画结束？](https://stackoverflow.com/questions/34432353/how-to-wait-until-matplotlib-animation-ends/34475657#34475657)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-11-23T17:31:01.270

这是我找到的最简单的解决方案（线程阻塞代码）

```
plt.show(block=False) # this avoids blocking your thread

plt.pause(1) # comment this if you do not want a time delay

# do more stuff

plt.show(block=True) # this prevents the window from closing on you 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-09-16T15:11:08.363

如果你想打开多个图形，同时保持它们全部打开，这段代码对我有用：

```
show(block=False)
draw() 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-01-10T22:01:59.140

虽然没有直接回答 OP 的请求，但我发布了这个解决方法，因为它可能会在这种情况下对某人有所帮助：

*   我用pyinstaller创建了一个.exe，因为我无法在需要生成绘图的地方安装python，所以我需要python脚本来生成绘图，将其保存为.png，关闭它并继续下一个，实现为几个绘图循环或使用函数。

为此我使用：

```
import matplotlib.pyplot as plt
#code generating the plot in a loop or function
#saving the plot
plt.savefig(var+'_plot.png',bbox_inches='tight', dpi=250) 
#you can allways reopen the plot using
os.system(var+'_plot.png') # unfortunately .png allows no interaction.
#the following avoids plot blocking the execution while in non-interactive mode
plt.show(block=False) 
#and the following closes the plot while next iteration will generate new instance.
plt.close() 
```

其中“var”标识循环中的绘图，因此它不会被覆盖。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-11-27T18:27:33.323

我发现最好的解决方案是让程序不会等待您关闭图形并将所有图放在一起以便您可以并排检查它们是在最后显示所有图。
但是这样你就不能在程序运行时检查绘图。

```
# stuff

numFig = 1

plt.figure(numFig)
numFig += 1
plt.plot(x1, y1)

# other stuff

plt.figure(numFig)
numFig += 1
plt.plot(x2, y2)

# more stuff

plt.show() 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2019-08-18T02:25:26.597

`plt.show(block=False)`在脚本调用结束时使用, 和`plt.show()`。

这将确保脚本完成后不会关闭窗口。

# apache - apache 在查看 .htaccess 之前解析 url

> ID：458214
> 
> 赞同：0
> 
> 时间：2009-01-19T16:33:02.390
> 
> 标签：apache, .htaccess, mod-rewrite, apache2

我有以下形式的重写规则：

```
RewriteRule ^foo/([a-zA-Z0-9]+)$ foo.php?arg=$1 [qsa,nc] 
```

它需要表单的 url`/foo/bar`并将它们更改为`/foo.php?arg=bar`

它在本地正常工作，它在我的旧主机上工作，但我搬到了一个新主机（运行 ubuntu），它的行为不同。

在新主机上，apache 注意到有一个 foo.php 并直接调用它。换句话说，表单的 url`/foo/bar`被视为`/foo.php`. 如果我重命名`foo.php`并将`foo_junk.php`重写规则更改为

```
RewriteRule ^foo/([a-zA-Z0-9]+)$ foo_junk.php?arg=$1 [qsa,nc] 
```

然后一切正常。所以这并不是我没有启用覆盖或者我没有安装 mod_rewrite 或任何东西。重写工作，它们只是在解析 url 过程中的不同点完成，而不是在本地完成。

有这个配置选项吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T16:37:27.563

尝试禁用[`MultiViews`](http://httpd.apache.org/docs/2.2/content-negotiation.html#multiviews)：

```
Options -MultiViews 
```

# asp.net - IE/ASP.NET 能否读取用户的 LAN ID

> ID：458218
> 
> 赞同：0
> 
> 时间：2009-01-19T16:33:21.313
> 
> 标签：asp.net, lan

我们正在进行呼叫中心系统的分析阶段。为了解决一个潜在的棘手的身份验证问题，我们可能需要读取代理的 LAN ID 并将其用作系统中的用户 ID。

是否可以从 ASP.NET 甚至 Javascript 中读取 LAN ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T17:02:48.167

如果您打开网站的集成 Windows 身份验证（并关闭匿名访问），则用户在访问网站时将通过其域帐户进行身份验证。您可以使用在代码中检索他们的用户名

```
Page.User.Identity.Name 
```

我在过去的几个 Intranet 应用程序中成功地做到了这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T16:39:22.037

我不确定 LAN ID 到底是什么。我只是假设您的意思是MAC地址？

如果是这样，我不相信如果没有 ActiveX 控件或在客户端安装某些东西，就不可能通过 ASP.NET 获得它。

当然，MAC 地址可以更改（新网卡等）并被欺骗，因此在您的情况下可能会或可能不会出现问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T16:41:46.087

您可以从请求中获取呼叫者的局域网 IP。[http://msdn.microsoft.com/en-us/library/system.web.httprequest.userhostaddress.aspx](http://msdn.microsoft.com/en-us/library/system.web.httprequest.userhostaddress.aspx)

# .net - 如何使用反射在.net 中的静态超类函数中获取子类 Type 对象？

> ID：458225
> 
> 赞同：1
> 
> 时间：2009-01-19T16:35:22.870
> 
> 标签：.net, generics, reflection, inheritance, repository

好的，所以我正在尝试为数据访问对象创建一个不错的超类，它可以生成一个 tsql 查询来搜索所有子类的公共字符串属性。我想使用反射来获取子类的类型，然后遍历对象上的所有公共字符串属性，因为这些属性名称与数据库列名称相同。然后我可以使用这些属性名称来生成一个 tsql 查询。

[警告：嘿，我宁愿使用 nhibernate，但我无法说服这些人使用它]

[我也可以用泛型解决这个问题，但我认为他们觉得泛型很可怕，因为他们是 VB.net 人，（对不起，如果我伤害了你的感受 VB.net 窥视 ;()]

好的，所以基础对象是这样的：

```
public abstract class RepositoryBase
{
   public static IList<RepositoryBase> Search()
   {
        //get all public properties of the inheriting subclass
        // I already have the rest of the search code
   }
} 
```

这甚至是可能的还是可取的？

当我输入这个时，我就像“搞砸了，我会用泛型来做”。

谢谢阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T17:26:18.510

当您“通过”派生类调用静态方法时，编译器会解析该方法，因此 IL 实际上包含基类。例如：

```
public class Base
{
    static void Foo() {}
}

public class Derived : Base {}

class Test
{
    static void Main()
    {
        Derived.Foo();
    }
} 
```

Main 中的调用实际上最终会在 IL 中编译为 Base.Foo() （至少在从 C# 编译时）。因此，您无法在执行时说出原始调用是什么。

这听起来确实像泛型是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T16:51:11.917

我认为大多数存储库模式使用接口而不是像这样的抽象类......

```
 public class SqlRepository : IRepository {

        DB _db;

        public SqlRepository(DB dataContext) {
            //override the current context
            //with the one passed in
            _db = dataContext;

        } 

        public IQueryable<RepositoryBase> Search() {

           ... 
```

我认为我从未见过这样写的模式。我想这是可能的，但我认为你无法完成你认为你想要完成的事情。看看... [http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/19a968ce-7d8b-4cf9-b0f0-292464f1e708/](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/19a968ce-7d8b-4cf9-b0f0-292464f1e708/)

有什么理由不能使用接口吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T16:52:34.990

好吧，假设您仍然想要一个答案：不。在静态方法中，您不在对象的上下文中。你不知道是谁给你打电话（没有构造 a `StackTrace`），即使你打电话了，你也不知道调用者是应该枚举其属性的对象。

如果它是一个实例方法，你可以调用`GetType()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-03T03:35:03.487

我只是按照您的建议工作（VB）。此代码有效（从西班牙语翻译，因此它可能包含拼写错误）：例如，它可以这样使用：

```
Public Sub Main()
   'the SELEC method used below this line is written once and called from every table/class'
   Dim CustList As List(Of CUSTOMER) = CUSTOMER.SELEC("Name = 'Peter'", "Name DESC")
   Dim myOrders As List(Of ORDER) = CustList(0).Orders
   CustList(0).Name = "John"
End Sub

Public Interface ITables 'used solely to unify all the table types'
    '    ReadOnly Property PrimaryKey() As String is better to shadow it from SuperClass TableType'
End Interface

Public Class TableType(Of T As ITables)'this T is what you are looking for'
    Public PrimaryKey As String
    Public Shared Function SELEC(Optional ByVal sWhere As String = "", Optional ByVal sOrderBy As String = "") As List(Of T)
        'shared/static method to fill and return a typed List with the DB rows'
        'can be called using for example Type.SELEC()'
        Dim oConn As New OdbcConnection(My.Settings.ConnectionString)
        Dim oComm As OdbcCommand = oConn.CreateCommand
        oComm.CommandText = "SELECT * FROM " & GetType(T).Name
        If sWhere.Length > 0 Then oComm.CommandText &= " WHERE " & sWhere
        If sOrderBy.Length > 0 Then oComm.CommandText &= " ORDER BY " & sOrderBy
        Dim oListRet As New List(Of T)
        oConn.Open()
        Dim oDR As OdbcDataReader = oComm.ExecuteReader
        Dim oneRow As T
        Do While oDR.Read
            oneRow = Activator.CreateInstance(GetType(T))
            For i = 0 To oDR.FieldCount - 1
                Dim value = oDR.Item(i)
                If TypeOf value Is DBNull Then value = Activator.CreateInstance(oDR.GetFieldType(i)) ' default value'
                oneRow.GetType.GetProperty(oDR.GetName(i)).SetValue(oneRow, value, Nothing)
            Next
            oListRet.Add(oneRow)
        Loop
        oDR.Close()
        oConn.Close()
        oConn.Dispose()
        Return oListRet
    End Function

    Public Function UPDATE(Optional ByVal sWhere As String = "") As Integer
        'not shared but one for all tables'
        'working on this, almost finished'
    End Function
    Shared Function fnPropAttribute(ByVal oProp As PropertyInfo, ByVal sAttrName As String) As String
        'working on this. Returns for example the value of the attribute 'Category' of a field'
        Dim attributes As AttributeCollection = TypeDescriptor.GetProperties(oProp.DeclaringType)(oProp.Name).Attributes
        Dim myAttribute As CategoryAttribute = CType(attributes(GetType(need to know wth to put here)), CategoryAttribute)
        Return myAttribute.Category
    End Function
End Class 'TableType'

Public Class Tables
    Public Class CUSTOMER
        Inherits TableType(Of CUSTOMER)
        Implements ITables
        Public Shadows Const PrimaryKey As String = "idCust"

        'this returns the List(Of Orders) with my idCust'
        Public ReadOnly Property ORDERs() As List(Of ORDER)
            Get
                Return ORDER.SELEC("idCust = " & Me.idCust)
            End Get
        End Property

        Dim _idCust As Integer

        'this Attributes will be used in UPDATE, INSERT, etc'
        'Category 'Columns' is to distingish between DB fields and other possible properties'
        'Description is the ODBCType of the field'
        <Category("Columns"), Description("CHAR")> _
        Public Property idCust() As Integer
            Get
                Return _idCust
            End Get
            Set(ByVal value As Integer)
                _idCust = value
            End Set
        End Property

        Dim _Name As String
        <Category("Columns"), Description("CHAR")> _
        Public Property Name() As String
            Get
                Return _Name
            End Get
            Set(ByVal value As String)
                _Name = value
            End Set
        End Property
        'etc...'
    End Class 'Customer'
    Public Class ORDER
        Inherits TableType(Of ORDER)
        Implements ITables
        Public Shadows Const PrimaryKey As String = "idOrder"

        Dim _idOrder As Integer
        <Category("Columns"), Description("CHAR")> _
        Public Property idOrder() As Integer
            Get
                Return _idOrder
            End Get
            Set(ByVal value As Integer)
                _idOrder = value
            End Set
        End Property

        Dim _idCust As Integer
        <Category("Columns"), Description("CHAR")> _
        Public Property idCust() As Integer
            Get
                Return _idCust
            End Get
            Set(ByVal value As Integer)
                _idCust = value
            End Set
        End Property

        Dim _Artic As String
        <Category("Columns"), Description("CHAR")> _
        Public Property Artic() As String
            Get
                Return _Artic
            End Get
            Set(ByVal value As String)
                _Artic = value
            End Set
        End Property
        'etc...'
    End Class 'Order'
End Class 'Tables' 
```

# .net - “控制数组”的 VB.NET 问题

> ID：458226
> 
> 赞同：0
> 
> 时间：2009-01-19T16:35:34.290
> 
> 标签：.net, vb.net, arrays

我有一个 VB.NET 应用程序并使用一些第三方（闭源）ActiveX 控件。其中一个控件代表一个“相机”（通过多个接口连接），我尝试编写一个示例，如何在一个应用程序中使用多个相机。为此，我将多个“相机”对象动态分配为一个数组，该数组按预期工作，如下所示：

```
Const NUM_CAMERAS = 2
Private MyCameras(NUM_CAMERAS ) As xxx.MCamera 
```

但是需要分配相机对象，`WithEvents`因为它们会在拍摄新图像时引发事件。我发现 WithEvents 变量不能作为数组输入，这是一个很常见的问题，所以我还找到了一些解决方法：[http ://www.dreamincode.net/code/snippet885.htm](http://www.dreamincode.net/code/snippet885.htm) [http://www.xtremevbtalk.com/存档/index.php/t-223970.html](http://www.xtremevbtalk.com/archive/index.php/t-223970.html)

这已经很有帮助了，我将其应用到我的概念中。所以我有一个 MyCameras 数组和一个 MyCamera 都“没有事件”，首先分配一个新的 MyCamera 对象，添加一个事件处理程序，然后将其放入数组中。不幸的是，我在调用时遇到错误

```
AddHandler Camera.ProcessModifiedImage, AddressOf MyHook 
```

通常“MyHook”被声明为

```
Private Sub MyHook (ByVal sender As Object, ByVal ModifiedBuffer As xxx.ProcessModifiedImageEvent) Handles Camera.ProcessModifiedImage 
```

就像在“按钮示例”中一样，我刚刚删除了“Handles Camera.ProcessModifiedImage”，但我收到一个错误，即“MyHook”与 Delegate 的签名不同

```
Delegate Sub ICameraEvents_ProcessModifiedImageEventHandler(ImageIndex as Integer) 
```

有谁知道如何解决这个问题以及改变什么？如有必要，我可以在明天发布更多代码和详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T16:46:30.087

“MyHook”事件处理程序需要与委托具有相同的签名（即以相同的顺序接受相同的参数类型）。由于所需的委托接受一个名为 ImageIndex 的整数参数，您可以将 MyHook 事件处理程序声明为：

```
 Private Sub MyHook(ImageIndex as Integer)

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T19:17:21.687

跟进 Waves 帖子的评论，您可以使用 lambda 表达式优雅地处理缺少的“sender”参数：

```
 Public Sub New()
    InitializeComponent()
    For camera As Integer = 1 To 4
      Dim cam As Camera = DirectCast(Me.Controls("Camera" + camera.ToString), Camera)
      AddHandler cam.ProcessModifiedImage, Function(index As Integer) ProcessImage(cam, index)
    Next
  End Sub

  Private Function ProcessImage(ByVal cam As Camera, ByVal ImageIndex As Integer) As Integer
    ' Your code here
    '...
    Return 0
  End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T16:47:17.713

错误告诉你你需要什么——你的事件处理程序的签名必须与他们指定的委托相匹配（一个带有一个 ImageIndex 参数的子例程）

所以你要

```
Private Sub MyHook(ImageIndex as Integer) 
```

您可能已经看到所有事件处理程序的格式都是 sub myhook(sender as object, e as XXEventArgs)

这是 microsoft 用于其 .NET 事件的约定，但不是必需的。您的第三方工具显然不遵循该约定。当它告诉您委托签名必须是什么样子时，只需按照该消息进行操作即可。

# design-patterns - 没有名称的质量 (QWAN) 示例？

> ID：458242
> 
> 赞同：4
> 
> 时间：2009-01-19T16:39:39.023
> 
> 标签：design-patterns

没有名字的品质 (QWAN) 是克里斯托弗·亚历山大 (Christopher Alexander) 对有吸引力的特征的术语，它不是“美丽”或“舒适”或“活力”或任何其他术语。但是我们可以在建筑物中识别出来。

对于受 Alexander 模式语言思维影响最大的人来说，我们可能认为我们也可以在软件中看到它：无论是面向最终用户，还是以软件架构或设计良好的 API 的形式。

那么您最喜欢的 QWAN 示例是什么？为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T17:08:19.683

短暂聊天。在这么少的结构中，您需要编程语言中的这么多东西

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:07:33.350

如果我们谈论的是设计，那么以最小的变化来调整、扩展或重新定义原始行为的能力将是我觉得很有吸引力的东西。然而，有些人会声称这个质量属性有一个名字：可维护性。

尽管如此，从软件架构的纯粹抽象角度来看，我想说的是，能够在您的脑海中轻松调用具体架构和预期领域/目的之间的同构，是一种无名的品质。

# html - 减少生成的 HTML 大小的工具

> ID：458249
> 
> 赞同：0
> 
> 时间：2009-01-19T16:40:39.070
> 
> 标签：html, scripting, google-docs, mshtml

我正在使用谷歌文档，我们使用的一些模板是使用 MS-Office 创建的。
生成的 HTML 又胖又丑，而且 google 上每个文档 500KB 的限制使得一些清理工作是强制性的。我能够找到多余的“样式”属性并将它们移动到某个 CSS 类，并将最多余的类名称重命名为较短的名称，这使我节省了大约 50% 的原始大小。
您是否知道一些现有的工具/脚本/lib 可以为我完成这项痛苦的工作，或者至少帮助我编写这个神奇的工具？

提前致谢 ！

编辑：我尝试了 tidy、demronizer 和“手动重写”：
- 输入：140Kb
- Tidy'ed： 110Kb
- Demoronized：135Kb

所以我最喜欢的答案是“重写它！”

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T16:49:08.897

MS-Office 制作蹩脚的 HTML，期间。您最好花时间从原始文本中重建 HTML，而不是试图穿过那个雷区。

我制作了一些宏，它们在 Word 上执行一些搜索/替换功能，以执行基本的操作，例如`<p>`在段落周围包装标签之类的东西，然后从头开始重新标记整个内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T16:45:04.800

您可以尝试[tidy](http://tidy.sf.net)它会清理很多东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T00:53:32.677

在不评论它的名字的情况下，我可以提到[demoronizer](http://www.fourmilab.ch/webtools/demoroniser/)，作者将其描述为：

> ...一个可从该站点下载的 Perl 程序，它纠正了由 Microsoft 应用程序生成或编辑的 HTML 中的许多错误和不兼容性。

YMMV。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-08T18:48:51.647

我现在最喜欢的实用程序之一实际上是 Windows Live Writer - 它可以很好地从 Word doc 文件中清除垃圾。有些人可能不同意，但我经常使用它！

# c# - 单元测试、重构、IO

> ID：458253
> 
> 赞同：2
> 
> 时间：2009-01-19T16:42:10.687
> 
> 标签：c#, unit-testing, refactoring

您在具有 2 个参数的类上有一个方法，其中一个是文件路径，另一个是无关紧要的。

```
InterestingResult result = foo.Bar(irrelevant, filePathInfo); 
```

本着快速快速单元测试的精神，您发现自己正在考虑重构此方法以提取文件路径以删除此测试的 IO 要求……很可能将其放入另一个方法中，这样现在您可以调用

```
string dataInFile = foo.GetDataInFile(filePathInfo);
InterestingResult result = foo.Bar(irrelevant, dataInFile); 
```

你疯了吗？...或者这是一件好事？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T16:44:38.187

使用 Stream 作为参数怎么样？这样，您可以在单元测试中传递[MemoryStream](http://msdn.microsoft.com/de-de/library/system.io.memorystream(VS.80).aspx) ，在生产代码中传递[FileStream 。](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T16:46:02.507

作为一般规则，我会避免仅出于测试目的更改接口。界面应该反映用户的需求，而不是开发人员或测试人员的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T16:46:11.927

取决于你问谁。有人会说设计用于测试。我不会仅仅为了适应测试而改变我的设计。

但在这种情况下，我*会*更改我的设计，使 Foo 方法采用 Stream 而不是文件路径。这样它就更灵活了，你的单元测试可以只通过一个虚拟流。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T16:49:23.187

我可能会设计接口，而不是采用文件路径，而是传入一个 IStream （或类似的）指针。这样，您可以使用 Mock 库进行测试，以传入满足该方法的模拟 IStream，并提供更强大的测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T16:59:32.277

最简单的事情。

*   对于您的测试，请提供您知道预期输出的（只读）[黄金文件](http://xtest.netbeans.org/NbJUnit/JUnit_logging.html)。（将其存储在测试/资源中）。如果速度足够快，则无需更改生产代码。
*   如果测试文件系统的速度非常慢（超过半秒），抽象出文件系统访问（使用 Mock/Fake）（类似于您问题中的第二个片段）。

随着您感染更多 n 更多的测试，您会产生一种蜘蛛感知的事物，从而难以进行相应的测试和设计。所以坚持下去...

# c# - 将类型库导入为 C# 代码的工具

> ID：458258
> 
> 赞同：2
> 
> 时间：2009-01-19T16:43:33.073
> 
> 标签：c#, com-interop, tlbimp

是否有将 COM 类型库导入/转换为 C# 代码而不是生成程序集的工具？TLBIMP 工具和 TypeLibaryConverter 类只生成程序集。

通过在生成的 Interop 程序集上运行 Reflector 并复制粘贴反汇编的源代码，我已经成功地翻录了 C#`ComImport`定义，但这通常需要在编译之前进行大量手动修补。

期望的目标是一个没有附属互操作 DLL 的单个 EXE，所以答案可能是使用 ILMerge 将互操作 DLL 有效地嵌入到 EXE 中。

我确信过去我会遇到这样的工具 - 但也许它梦想过它:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T19:48:07.083

我不太确定它对您是否有用，但托管版本的 Tlbimp.exe 的源代码已在[CodePlex](http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=17579)上发布。VS2010 一定能解决你的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T17:10:06.717

今天这对您没有帮助，但是下一版本的 C# 中有一个功能。根据您阅读的演示文稿，它被称为 NoPia 或类型嵌入。此功能本质上会将 PIA 程序集链接到您从中引用它的任何项目。最终结果是一个不需要部署互操作/PIA DLL 的单个 EXE。

Misha 关于这个主题的帖子：http: [//blogs.msdn.com/mshneer/archive/2008/10/28/type-embedding-support-in-c.aspx](http://blogs.msdn.com/mshneer/archive/2008/10/28/type-embedding-support-in-c.aspx)

但短期内，您可能必须使用 ILMerge 或反射器 + 复制代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T10:24:09.463

正如我最初怀疑的那样，最好的解决方案是使用[ILMerge](http://www.microsoft.com/downloads/details.aspx?FamilyID=22914587-b4ad-4eae-87cf-b14ae6a939b0)。我不能对要嵌入的 COM API 的某些部分有所选择，但它工作得很好。

这是我正在使用的构建后事件命令行，它应该很容易重用：

```
set MERGEFILES=Interop.Foo.dll Interop.Bar.dll

if "$(ConfigurationName)" == "Release" (
   ren "$(TargetFileName)" "_$(TargetFileName)"
   "$(ProgramFiles)\Microsoft\ILMerge\ILMerge.exe" /out:"$(TargetFileName)" "_$(TargetFileName)" %MERGEFILES%

   del "_$(TargetFileName)"
   del %MERGEFILES%
) 
```

# vb.net - 如何创建一个按钮来检查更新并安装它们？

> ID：458261
> 
> 赞同：2
> 
> 时间：2009-01-19T16:44:14.723
> 
> 标签：vb.net, visual-studio-2005, clickonce

我可以让程序在启动时轻松查找更新，然后安装它们。

我想要一个用户可以单击的按钮来检查/安装更新。这可能吗，如果可以，怎么办？

编辑：对不起，不是 ASP.NET；仅限 VB.NET

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T15:08:42.123

此[msdn 页面](http://msdn.microsoft.com/en-us/library/1zyc39fb(VS.80).aspx)概述了 ClickOnce 更新的不同选项。它解释了如何在应用程序启动之前、应用程序启动之后或以编程方式检查更新。

我的猜测是，您可能希望将自动检查之一（在应用程序启动之前或之后）与您的程序检查（在您的按钮单击上）结合起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T16:49:24.480

这并不难。大概更新/安装代码在它自己的例程中。在按钮的单击事件代码中，只需调用启动代码使用的更新/安装例程即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T16:51:33.867

向按钮添加事件。[在这种情况下，您可以使用WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)之类的东西从您的服务器检索更新的安装包。然后验证其签名以确保代码确实是您的并将其安装在本地计算机上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T16:51:55.863

我注意到您问题上的 asp.net 标签。您是在谈论桌面应用程序还是来自客户安装的 Web 应用程序的管理页面？

如果它是桌面应用程序，只需查看 ClickOnce 部署。它内置了该功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T17:19:28.273

要么我没有了解全局，要么是因为我在 asp.net 环境中工作......

无论如何，我做了一些你要求我们的产品（网络应用程序）的事情，这绝不是一项简单的任务。

以下是我的做法： 1 - 构建后台应用程序以发布新产品版本。

2 - 构建一个接收给定产品和版本的 web 服务，检查是否有可用的更新，如果有，将其发送给客户端。

3 - 在客户端收到更新后，安装它。

我想在 Windows 应用程序上更新过程会更容易，我唯一的建议是在执行此操作时要非常小心。始终制作应用程序的安全副本，以便如果出现任何问题，您可以回滚到以前的版本。

# c# - 你能有 2 个 url 指向 asp:Menu 控件中的同一页面吗？

> ID：458287
> 
> 赞同：12
> 
> 时间：2009-01-19T16:49:56.303
> 
> 标签：c#, asp.net, aspmenu

[我有一个 asp:Menu，它包含一个指向http://www.example.com/one.aspx](http://www.example.com/one.aspx)的顶级菜单项。当您将鼠标悬停在顶级菜单项上时，它会显示一个下拉菜单，其中一个选项是指向[http://www.example.com/one.aspx](http://www.example.com/one.aspx)的 One 。显然，我不能这样做，所以我一直在放一个？在第二个网址的末尾来解决这个问题。我很好奇是否有可能有两个 url 指向 asp:Menu 中的同一位置？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-19T17:02:49.803

我遇到了同样的问题，并使用了您的解决方案的细微变化：我在 URL 中添加了锚点，例如：

*   [http://www.example.com/one.aspx#1](http://www.example.com/one.aspx#1)
*   [http://www.example.com/one.aspx#2](http://www.example.com/one.aspx#2)

顺便说一句：我使用的是站点地图文件，当您将具有相同 URL 的节点添加到该文件时，错误/异常非常明显：

> 找到具有相同 URL '/WebSite1/MyPage.aspx' 的多个节点。XmlSiteMapProvider 要求站点地图节点具有唯一的 URL。

所以我想真的不可能拥有相同的 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T17:07:22.447

我不相信。

Menu 控件使用每个项目的 NavigateUrl 属性作为正确突出和展开菜单的标识符 - 如果您有两个具有相同 URL 的节点，控件如何知道要突出显示哪一个？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-18T12:48:07.390

我在上面的评论中发现我的解决方案仅适用于 Firefox，这是一种改进的解决方案，即使您单击与当前链接相同但带有井号标签的链接，也可以使页面刷新：

```
$(document).ready(function () { // refresh page when clicking menu item with current address $('#<%=aspMenu.ClientID%> a').click(function () {
   var currentUrl = location.pathname;
                var clickedUrl = $(this).attr('href');
                if (currentUrl.indexOf('#') != -1 || clickedUrl.indexOf('#') != -1){
                    if (currentUrl.indexOf('#') != -1)
                        currentUrl = currentUrl.substring(0, currentUrl.indexOf('#'));
                    if (clickedUrl.indexOf('#') != -1)
                        clickedUrl = clickedUrl.substring(0, clickedUrl.indexOf('#'));
                    if (currentUrl == clickedUrl)
                        location.reload();
 }); }); 
```

甚至更好：从文档准备好的hrefs中删除带有数字的锚点：

```
 $(document).ready(function () {
        $('#<%=aspMenu.ClientID%> a').each(function () {
            var re = /#\d/
            var url = $(this).attr('href');
            $(this).attr('href', url.replace(re, ""));
        });
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T22:01:38.520

您可以附加一个更改的查询字符串变量，例如

```
<siteMapNode url="~/UnderConstruction.aspx?x=1" title="Customer"  description="Customer" />
<siteMapNode url="~/UnderConstruction.aspx?x=2" title="User"  description="User" />
<siteMapNode url="~/UnderConstruction.aspx?x=3" title="Area"  description="Area" />
<siteMapNode url="~/UnderConstruction.aspx?x=4" title="Well"  description="Well" />
<siteMapNode url="~/UnderConstruction.aspx?x=5" title="Build Report"  description="Build" /> 
```

# asp.net-mvc - ASP.NET MVC QueryString 默认覆盖提供的值？

> ID：458288
> 
> 赞同：26
> 
> 时间：2009-01-19T16:49:57.317
> 
> 标签：asp.net-mvc, routing, query-string

使用 ASP.NET MVC Preview 5（尽管在 Beta 版中也尝试过），路由中的查询字符串默认值似乎覆盖了在查询字符串中传递的值。一个repro是写一个这样的控制器：

```
public class TestController : Controller
{
    public ActionResult Foo(int x)
    {
        Trace.WriteLine(x);
        Trace.WriteLine(this.HttpContext.Request.QueryString["x"]);
        return new EmptyResult();
    }
} 
```

路由映射如下：

```
routes.MapRoute(
    "test",
    "Test/Foo",
    new { controller = "Test", action = "Foo", x = 1 }); 
```

然后使用这个相对 URI 调用它：

```
/Test/Foo?x=5 
```

我看到的跟踪输出是：

```
1
5 
```

所以换句话说，为路由设置的默认值总是传递给方法，不管它是否实际在查询字符串中提供。请注意，如果查询字符串的默认值被删除，即路由映射如下：

```
routes.MapRoute(
    "test",
    "Test/Foo",
    new { controller = "Test", action = "Foo" }); 
```

然后控制器按预期运行，并将值作为参数值传入，给出跟踪输出：

```
5
5 
```

这在我看来像一个错误，但我会发现像这样的错误仍然存​​在于 ASP.NET MVC 框架的 beta 版本中，这让我感到非常惊讶，因为具有默认值的查询字符串并不完全是一个深奥或边缘情况的功能，所以几乎可以肯定是我的错。任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-19T18:36:09.193

使用 QueryStrings 查看 ASP.NET MVC 的最佳方法是将它们视为路由不知道的值。正如您所发现的，QueryString 不是 RouteData 的一部分，因此，您应该将作为查询字符串传递的内容与路由值分开。

如果从 QueryString 传递的值为 null，则解决它们的一种方法是在操作中自己创建默认值。

在您的示例中，路由知道 x，因此您的 url 应该看起来像这样：

```
/Test/Foo or /Test/Foo/5 
```

路线应该是这样的：

```
routes.MapRoute("test", "Test/Foo/{x}", new {controller = "Test", action = "Foo", x = 1}); 
```

获得您正在寻找的行为。

如果你想传递一个 QueryString 值，比如页码，那么你可以这样做：

```
/Test/Foo/5?page=1 
```

你的动作应该像这样改变：

```
public ActionResult Foo(int x, int? page)
{
    Trace.WriteLine(x);
    Trace.WriteLine(page.HasValue ? page.Value : 1);
    return new EmptyResult();
} 
```

现在测试：

> ```
> Url:  /Test/Foo
> Trace:
> 1
> 1
> 
> Url:  /Test/Foo/5
> Trace:
> 5
> 1
> 
> Url:  /Test/Foo/5?page=2
> Trace:
> 5
> 2
> 
> Url:  /Test/Foo?page=2
> Trace:
> 1
> 2 
> ```

希望这有助于澄清一些事情。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-19T17:34:49.910

我的一位同事发现[了一个链接，该链接表明这是设计](http://www.coderjournal.com/2008/08/parameter-attribute-default-value-mvc-action-method/)使然，并且该文章的作者似乎向[MVC 团队提出了一个问题，](http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2054)称这是对早期版本的更改。他们的回复如下（对于“页面”，您可以阅读“x”以使其与上述问题相关）：

> 这是设计使然。路由本身不关心查询字符串值；它只关注来自 RouteData 的值。相反，您应该从 Defaults 字典中删除“page”条目，并在操作方法本身或过滤器中设置“page”的默认值（如果尚未设置）。
> 
> 我们希望将来有一种更简单的方法来将参数标记为显式来自 RouteData、查询字符串或表单。在实施之前，上述解决方案应该可以工作。如果没有，请告诉我们！

所以看起来这种行为是“正确的”，但它[与最小惊讶原则](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)是如此正交，以至于我仍然不能完全相信它。

* * *

编辑#1：请注意，帖子详细说明了如何提供默认值的方法，但是这不再有效，因为`ActionMethod`他用来访问的属性`MethodInfo`已在最新版本的 ASP.NET MVC 中删除。我目前正在研究替代方案，完成后会发布。

* * *

编辑#2：我已经更新了链接帖子中的想法，以便与 ASP.NET MVC 的 Preview 5 版本一起使用，我相信它也应该与 Beta 版本一起使用，尽管我不能保证，因为我们没有移动到那个版本呢。它是如此简单，我刚刚将它内联发布在这里。

首先是默认属性（我们不能使用现有的 .NET `DefaultValueAttribute`，因为它需要继承自`CustomModelBinderAttribute`）：

```
[AttributeUsage(AttributeTargets.Parameter)]
public sealed class DefaultAttribute : CustomModelBinderAttribute
{
    private readonly object value;

    public DefaultAttribute(object value)
    {
        this.value = value;
    }

    public DefaultAttribute(string value, Type conversionType)
    {
        this.value = Convert.ChangeType(value, conversionType);
    }

    public override IModelBinder GetBinder()
    {
        return new DefaultValueModelBinder(this.value);
    }
} 
```

自定义活页夹：

```
public sealed class DefaultValueModelBinder : IModelBinder
{
    private readonly object value;

    public DefaultValueModelBinder(object value)
    {
        this.value = value;
    }

    public ModelBinderResult BindModel(ModelBindingContext bindingContext)
    {
        var request = bindingContext.HttpContext.Request;
        var queryValue = request .QueryString[bindingContext.ModelName];
        return string.IsNullOrEmpty(queryValue) 
            ? new ModelBinderResult(this.value) 
            : new DefaultModelBinder().BindModel(bindingContext);
    }
} 
```

然后您可以简单地将其应用于查询字符串中的方法参数，例如

```
public ActionResult Foo([Default(1)] int x)
{
    // implementation
} 
```

奇迹般有效！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-01T10:06:29.773

我认为查询字符串参数不覆盖默认值的原因是阻止人们破解 url。

有人可以使用一个 url，其查询字符串包括控制器、操作或您不希望它们更改的其他默认值。

我通过执行@Dale-Ragan 的建议并在操作方法中处理它来解决这个问题。为我工作。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-19T17:27:00.707

我认为 MVC 中路由的重点是摆脱查询字符串。像这样：

```
routes.MapRoute(
    "test",
    "Test/Foo/{x}",
    new { controller = "Test", action = "Foo", x = 1 }); 
```

# sql-server - 如何在 Firefox 中为 SQL Server Reporting Services 报表查看器控件显示报表图标

> ID：458289
> 
> 赞同：2
> 
> 时间：2009-01-19T16:50:28.813
> 
> 标签：sql-server, firefox, reporting-services

似乎由于 ActiveX，Firefox 无法在 SQL Server 报告服务的报告查看器控件上显示打印图标/按钮。有没有人想办法解决这个问题或让它工作？

如果不可能，是否有人知道添加标准按钮以触发报表查看器控件上的打印行为的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:42:55.023

正如您所说，打印功能是 ActiveX，因此它在 Firefox 中不起作用。

您可以使用 javascript 按钮在“msrs-buttonHeaderBackground”div 中放置一个按钮。

我发现使用 firebug firefox 扩展的 div - 很棒。

您可能会找到要隐藏的其他 div 并将它们放在打印样式表中，这样它们在打印时就不会出现。

[http://www.456bereastreet.com/archive/200709/how_to_create_an_unobtrusive_print_this_page_link_with_javascript/](http://www.456bereastreet.com/archive/200709/how_to_create_an_unobtrusive_print_this_page_link_with_javascript/)

我同意作者的观点，即可以简单地按下 ctrl-p 来获得类似的结果，而不是添加按钮——但打印样式仍然会对此有所帮助。

你知道吗……我刚刚意识到一件事。您将无法打印超过一页的页面！哎哟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-29T19:44:59.410

我知道这是一个非常古老的问题，但我们遇到了这个并选择了以下解决方案。

我们为 FireFox 下载了一个[IE Tab 扩展](https://addons.mozilla.org/en-US/firefox/addon/ie-tab-2-ff-36/)（还有几个），然后将该扩展配置为默认使用 IE 呈现报表服务器 URL。

您可以轻松地创建一个操作方法网页、pdf，或者甚至创建一个虚拟报告，向您的最终用户显示如何执行此操作的说明，然后一切就绪。

所以现在每次访问报表服务器网站时，它都会在 IE 中呈现，因此会显示打印按钮。每台 Windows 机器都已经有 IE，所以没有兼容性问题，除非你不使用 Windows。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-20T18:14:40.017

我最好的建议是从 Firefox 中将其导出为 PDF，然后从您的 PDF 查看器中打印出来。以我的经验，无论如何这是打印报告的更好方法。

希望有帮助！

# c# - 使用 LINQ 编辑复合键值

> ID：458291
> 
> 赞同：2
> 
> 时间：2009-01-19T16:51:12.573
> 
> 标签：c#, .net, sql-server, linq

我有一个使用三列作为复合键的表。

这些列值之一用作有序相关记录的序列跟踪器。当我插入一条新记录时，我必须增加新记录之后的相关记录的序列号。

我可以直接在 SQL Server Management Studio 中执行此操作，但是当我在 LINQ 中尝试执行此操作时，我收到以下错误：

```
“TableName”类型的对象的成员“Sequence”的值已更改。
不能更改定义对象身份的成员。
考虑添加一个具有新身份的新对象，然后删除现有对象。

```

任何人都可以提出解决此限制的方法吗？

（添加一条新记录（如错误消息所示）并不是一个真正的选择，因为具有复合键的表与另一个表有关系。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T17:57:11.520

在我的书中，更改主键是一种“代码味道”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T11:58:42.367

我们实施的修复如下

*   删除了使用复合键的关系
*   添加自动增量 ID 字段，将其设置为主键
*   为我们之前用作我们的三个字段添加了唯一约束
*   使用以前我们的主键的三个字段重新创建关系

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-25T20:40:35.173

我通过使用 SQL 存储过程来更新一个主键并从 LINQ 调用它来解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T18:12:05.750

我认为编译器是对的。这样做的唯一方法是创建新记录并删除旧记录。

> （添加一条新记录（如错误消息所示）并不是一个真正的选择，因为具有复合键的表与另一个表有关系。）

我认为这没有问题。只需复制*实体*的所有字段，设置新*序列*`EntitySet`，并通过将旧引用分配给新引用来设置任何关系。我试过了，它更新正确。

除此之外，你不能只创建一个具有自动增量的新 ID 列吗？我同意@ocdecio。我认为更改主键是糟糕的设计......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T20:40:10.257

我不知道 LINQ，但是如果您在 SQL Server 上为 FK 关系定义了级联更新，这会起作用吗？

请注意，我认为使用复合键是一个坏主意，而改变一个是一个更糟糕的主意。主键不应该改变。如果主键更改，太多的事情可能会被破坏。当主键更改并且它现在不是唯一的时，您会怎么做？如果你这样做，你将需要一种方法来处理它，因为它会发生。

# php - 使用 Zend 框架处理输入（Post、get 等）

> ID：458299
> 
> 赞同：23
> 
> 时间：2009-01-19T16:53:57.060
> 
> 标签：php, zend-framework, post, input, get

我在 zend 代码上重构 php，所有代码都充满了`$_GET["this"]`and `$_POST["that"]`。我一直使用更多的 phpish`$this->_request->getPost('this')`和`$this->_request->getQuery('that')`（这个与 getquery 而不是 getGet 不太合乎逻辑）。

所以我想知道我的方法是否更安全/更好/更容易维护。我在 Zend Framework 文档中读到，您必须验证自己的输入，因为请求对象不会这样做。

这给我留下了两个问题：

*   这两个哪个最好？（或者如果有另一种更好的方法）
*   使用这种方法验证 php 输入的最佳实践是什么？

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-19T16:59:25.443

我通常使用 $this->_request->getParams(); 检索帖子或 URL 参数。然后我使用[Zend_Filter_Input](http://framework.zend.com/manual/en/zend.filter.input.html)进行验证和过滤。getParams() 不进行验证。

使用 Zend_Filter_Input 您可以使用 Zend Validators 进行应用程序级别的验证（或者您也可以编写自己的）。例如，您可以确保“月”字段是一个数字：

```
$data = $this->_request->getParams();

$validators = array(
    'month'   => 'Digits',
);

$input = new Zend_Filter_Input($filters, $validators, $data); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-21T18:58:43.547

扩展布赖恩的答案。

正如您所指出的，您还可以签出`$this->_request->getPost()`和`$this->_request->getQuery()`. 如果你概括一下`getParams()`，这有点像使用`$_REQUEST`超全局，我认为这在安全性方面是不可接受的。

除了 Zend_Filter，您还可以使用简单的 PHP 来转换所需的内容。

例如：

```
$id = (int) $this->_request->getQuery('id'); 
```

对于其他值，它会变得更加复杂，因此请确保在您的数据库查询（[Zend_Db](http://framework.zend.com/manual/en/zend.db.html)，请参阅引用标识符）和用于转义内容`$db->quoteIdentifier()`的视图中引用。`$this->escape($var);`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-19T16:59:28.720

您不能为获取/发布数据编写一刀切的验证函数。在某些情况下，您需要一个字段为整数，而在其他情况下，您需要一个日期。这就是 zend 框架中没有输入验证的原因。

您必须在需要的地方编写验证代码。您当然可以编写一些辅助方法，但您不能指望 getPost() 自己为您验证某些东西......

它甚至不是 getPost/getQuery 验证任何东西的地方，它的工作是为您提供您不想要的数据，从那里发生的事情不应该是它的关注点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T22:19:06.490

```
$dataGet  = $this->getRequest()->getParam('id',null);
$valid = new Zend_Validate_Digits();

if( isset($dataGet) && $valid->isValid($dataGet) ){
 // do some...
} else{
  // not set
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-24T04:22:06.640

> 我一直使用更多的 phpish`$this->_request->getPost('this')`和`$this->_request->getQuery('that')`（这个与 getquery 而不是 getGet 不太合乎逻辑）。
> 
> 这两个哪个最好？（或者如果有另一种更好的方法）

只是对选择的快速解释`getQuery()`。措辞的选择来自它是什么类型的数据，而不是它是如何到达那里的。GET 和 POST 只是请求方法，携带各种信息，包括在 POST 请求的情况下称为“发布数据”的部分。GET请求没有这样的块，它携带的任何可变数据都是url查询字符串的一部分（？后面的部分）。

因此，虽然`getPost()`从 POST 请求的发布数据部分`getQuery()`获取数据，但从 GET 或 POST 请求（以及其他 HTTP 请求方法）的查询字符串中检索数据。

（请注意，GET 请求不应用于任何可能产生副作用的事情，例如更改数据库行）

因此，在回答您的第一个问题时，请使用`getPost()`and`getQuery()`方法，这样，您可以确定数据源在哪里（如果您不关心，`getParams()`也可以使用，但可能包含其他数据）。

> 使用这种方法验证 php 输入的最佳实践是什么？

验证输入的最佳位置是您*首次*使用它的位置。也就是说，当您从 、 或 中拉取`getParams()`它`getPost()`时`getQuery()`。这样，您的数据在您需要的地方始终是正确的，并且如果您将其传递出去，您就知道它是安全的。请记住，如果您将它传递给另一个控制器（或控制器操作），您可能应该在那里再次检查它，以确保安全。如何执行此操作取决于您的应用程序，但仍需要检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T16:00:48.923

与主题没有直接关系，但为了确保您在输入中得到一个数字，也可以使用 $var+0 （但是如果 $var 是一个浮点数，它仍然是一个浮点数）您可以在大多数情况下使用 $id = $ this->_request->getQuery('id') **+0** ;

# asp.net - ICallBackEventHandler 不使用表单值更新控件

> ID：458300
> 
> 赞同：2
> 
> 时间：2009-01-19T16:53:58.730
> 
> 标签：asp.net, icallbackeventhandler

我想使用 ICallBackEventHandler 但是当我使用它回调服务器时，我发现我的表单控件对象没有最新的表单值。有没有办法用表单数据强制填充值？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-02T16:05:33.907

看看[http://msdn.microsoft.com/en-us/magazine/cc163863.aspx](http://msdn.microsoft.com/en-us/magazine/cc163863.aspx)。

简而言之，您必须清除变量“__theFormPostData”，并在“CallbackEventReference”脚本之前调用“WebForm_InitCallback()”。这将使用用户输入值更新表单值。像这样的东西：

```
// from the above link
string js = String.Format("javascript:{0};{1};{2}; return false;", 
    "__theFormPostData = ''",
    "WebForm_InitCallback()",
    Page.GetCallbackEventReference(this, args, "CallbackValidator_UpdateUI", "null")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-14T16:22:10.027

您显然仍然没有同样的问题，但您需要做的是在 JavaScript 回调代码之前调用 WebForm_InitCallback() 。这将使页面刷新 Request.Form 对象中的 POST 值。

当您现在执行回发时，回调期间修改的值将可用。不用说，它们将在回调期间可用。

ETC

```
function SomeCode()
{
    __theFormPostCollection.length = 0;
    __theFormPostData = "";
    WebForm_InitCallback();

    ExecuteMyCallbackMethod("yaday", "yadya");
} 
```

# ios - 如何以编程方式确定我的应用程序是否在 iphone 模拟器中运行？

> ID：458304
> 
> 赞同：285
> 
> 时间：2009-01-19T16:55:32.907
> 
> 标签：ios, objective-c, swift, xcode, ios-simulator

正如问题所述，我主要想知道我的代码是否在模拟器中运行，但也有兴趣了解正在运行或正在模拟的特定 iphone 版本。

编辑：我在问题名称中添加了“以编程方式”这个词。我的问题的重点是能够根据正在运行的版本/模拟器动态包含/排除代码，所以我真的在寻找可以为我提供此信息的预处理器指令之类的东西。

* * *

## 回答 #1

> 赞同：364
> 
> 时间：2009-01-19T17:17:02.990

已经问过了，但标题完全不同。

[为 iPhone 编译时 Xcode 设置了什么#defines](https://stackoverflow.com/questions/146986/what-defines-are-setup-by-xcode-when-compiling-for-iphone)

我将从那里重复我的答案：

它位于“有条件地编译源代码”下的 SDK 文档中

相关定义为TARGET_OS_SIMULATOR，定义在iOS框架内的/usr/include/TargetConditionals.h中。在工具链的早期版本中，您必须编写：

```
#include "TargetConditionals.h" 
```

但这在当前（Xcode 6/iOS8）工具链上不再需要。

因此，例如，如果你想检查你是否在设备上运行，你应该这样做

```
#if TARGET_OS_SIMULATOR
    // Simulator-specific code
#else
    // Device-specific code
#endif 
```

取决于哪个适合您的用例。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-01-19T17:10:38.010

# 更新代码：

据称这是正式的工作。

```
#if TARGET_IPHONE_SIMULATOR
NSString *hello = @"Hello, iPhone simulator!";
#elif TARGET_OS_IPHONE
NSString *hello = @"Hello, device!";
#else
NSString *hello = @"Hello, unknown target!";
#endif 
```

* * *

# 原始帖子*（已弃用）*

此代码将告诉您是否在模拟器中运行。

```
#ifdef __i386__
NSLog(@"Running in the simulator");
#else
NSLog(@"Running on a device");
#endif 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2010-08-18T10:35:50.257

不是预处理器指令，但这是我遇到这个问题时所寻找的；

```
NSString *model = [[UIDevice currentDevice] model];
if ([model isEqualToString:@"iPhone Simulator"]) {
    //device is simulator
} 
```

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2011-03-07T07:05:41.863

最好的方法是：

```
#if TARGET_IPHONE_SIMULATOR 
```

并不是

```
#ifdef TARGET_IPHONE_SIMULATOR 
```

因为它总是定义：0或1

* * *

## 回答 #5

> 赞同：50
> 
> 时间：2018-03-12T13:50:51.950

现在有更好的方法！

从 Xcode 9.3 beta 4 开始，您可以使用它`#if targetEnvironment(simulator)`来检查。

```
#if targetEnvironment(simulator)
//Your simulator code
#endif 
```

**更新**
Xcode 10 和 iOS 12 SDK 也支持这一点。

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2016-02-25T04:48:57.257

**在 Swift 的情况下，我们可以实现以下**

我们可以创建允许您创建结构化数据的结构

```
struct Platform {
    static var isSimulator: Bool {
        #if targetEnvironment(simulator)
            // We're on the simulator
            return true
        #else
            // We're on a device
             return false
        #endif
    }
} 
```

然后，如果我们想检测是否正在为 Swift 中的设备或模拟器构建应用程序，那么 .

```
if Platform.isSimulator {
    // Do one thing
} else {
    // Do the other
} 
```

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2018-07-18T19:06:11.443

为`Swift 5`和工作`Xcode 12`

使用此代码：

```
#if targetEnvironment(simulator)
   // Simulator
#else
   // Device
#endif 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2014-06-17T02:57:18.733

所有这些答案都很好，但是它以某种方式使像我这样的新手感到困惑，因为它没有阐明编译检查和运行时检查。预处理器在编译时间之前，但我们应该让它更清楚

这篇博客文章显示了[如何检测 iPhone 模拟器？](http://ios.biomsoft.com/2011/09/20/how-to-detect-the-iphone-simulator/)清楚地

**运行**

首先，让我们简短地讨论一下。UIDevice 已经为您提供了有关设备的信息

```
[[UIDevice currentDevice] model] 
```

将根据应用程序的运行位置返回“iPhone Simulator”或“iPhone”。

**编译时间**

但是，您想要的是使用编译时定义。为什么？因为您严格编译您的应用程序以在模拟器内或设备上运行。Apple 定义了一个名为 `TARGET_IPHONE_SIMULATOR`. 那么让我们看一下代码：

```
#if TARGET_IPHONE_SIMULATOR

NSLog(@"Running in Simulator - no app store or giro");

#endif 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-05-21T07:10:39.530

前面的答案有点过时了。我发现您需要做的就是查询`TARGET_IPHONE_SIMULATOR`宏（**无需包含任何其他头文件**[假设您正在为 iOS 编码]）。

我尝试`TARGET_OS_IPHONE`过，但在实际设备和模拟器上运行时它返回相同的值 (1)，这就是我建议`TARGET_IPHONE_SIMULATOR`改用的原因。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-06-16T14:10:55.910

迅速：

```
#if (arch(i386) || arch(x86_64))
...            
#endif 
```

从[检测是否正在为 Swift 中的设备或模拟器构建应用程序](https://stackoverflow.com/questions/24869481/detect-if-app-is-being-built-for-device-or-simulator-in-swift)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2018-11-25T13:29:03.363

**对于 Swift 4.2 / xCode 10**

我在 UIDevice 上创建了一个扩展，所以我可以很容易地询问模拟器是否正在运行。

```
// UIDevice+CheckSimulator.swift

import UIKit

extension UIDevice {

    /// Checks if the current device that runs the app is xCode's simulator
    static func isSimulator() -> Bool {        
        #if targetEnvironment(simulator)
            return true
        #else
            return false
        #endif
    }
} 
```

例如，在我的**AppDelegate**中，我使用此方法来决定是否需要注册远程通知，这对于模拟器来说是不可能的。

```
// CHECK FOR REAL DEVICE / OR SIMULATOR
if UIDevice.isSimulator() == false {

    // REGISTER FOR SILENT REMOTE NOTIFICATION
    application.registerForRemoteNotifications()
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2017-07-26T13:59:51.397

[有没有人考虑过这里](https://github.com/EddyVerbruggen/nativescript-secure-storage/blob/70aa5e88691c073312e334c9963c444c3f4d86d5/secure-storage.ios.ts#L12-L24)提供的答案？

我想objective-c等价物是

```
+ (BOOL)isSimulator {
    NSOperatingSystemVersion ios9 = {9, 0, 0};
    NSProcessInfo *processInfo = [NSProcessInfo processInfo];
    if ([processInfo isOperatingSystemAtLeastVersion:ios9]) {
        NSDictionary<NSString *, NSString *> *environment = [processInfo environment];
        NSString *simulator = [environment objectForKey:@"SIMULATOR_DEVICE_NAME"];
        return simulator != nil;
    } else {
        UIDevice *currentDevice = [UIDevice currentDevice];
        return ([currentDevice.model rangeOfString:@"Simulator"].location != NSNotFound);
    }
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-06-16T17:48:25.330

我有同样的问题，两者`TARGET_IPHONE_SIMULATOR`都`TARGET_OS_IPHONE`被定义，并且设置为 1。当然，Pete 的解决方案有效，但如果你碰巧建立在英特尔以外的东西上（不太可能，但谁知道），这里有一些安全的东西只要 iphone 硬件没有改变（所以您的代码将始终适用于当前的 iphone）：

```
#if defined __arm__ || defined __thumb__
#undef TARGET_IPHONE_SIMULATOR
#define TARGET_OS_IPHONE
#else
#define TARGET_IPHONE_SIMULATOR 1
#undef TARGET_OS_IPHONE
#endif 
```

把它放在方便的地方，然后假装`TARGET_*`常量定义正确。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-06-12T18:51:44.657

包括所有类型的“模拟器”

```
NSString *model = [[UIDevice currentDevice] model];
if([model rangeOfString:@"Simulator" options:NSCaseInsensitiveSearch].location !=NSNotFound)
{
    // we are running in a simulator
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-06-11T08:33:29.893

使用 Swift 4.2 (Xcode 10)，我们可以做到这一点

```
#if targetEnvironment(simulator)
  //simulator code
#else 
  #warning("Not compiling for simulator")
#endif 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-12-23T12:30:56.777

我的回答基于@Daniel Magnusson 的回答和@Nuthatch 和@n.Drake 的评论。我写它是为了为在 iOS9 及更高版本上工作的 swift 用户节省一些时间。

这对我有用：

```
if UIDevice.currentDevice().name.hasSuffix("Simulator"){
    //Code executing on Simulator
} else{
    //Code executing on Device
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-02-28T13:39:48.843

/// 如果是模拟器而不是设备，则返回 true

```
public static var isSimulator: Bool {
    #if (arch(i386) || arch(x86_64)) && os(iOS)
        return true
    #else
        return false
    #endif
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-07-11T22:43:52.933

Apple 添加了对检查应用程序是否针对模拟器的支持，其中包括：

```
#if targetEnvironment(simulator)
let DEVICE_IS_SIMULATOR = true
#else
let DEVICE_IS_SIMULATOR = false
#endif 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-09-17T13:33:26.323

**如果没有任何效果，试试这个**

```
public struct Platform {

    public static var isSimulator: Bool {
        return TARGET_OS_SIMULATOR != 0 // Use this line in Xcode 7 or newer
    }

} 
```

* * *

## 回答 #20

> 赞同：-4
> 
> 时间：2016-05-11T06:40:11.530

这对我最有效

```
NSString *name = [[UIDevice currentDevice] name];

if ([name isEqualToString:@"iPhone Simulator"]) {

} 
```

* * *

## 回答 #21

> 赞同：-5
> 
> 时间：2013-09-09T14:45:49.160

在我看来，答案（上面提出并在下面重复）：

```
NSString *model = [[UIDevice currentDevice] model];
if ([model isEqualToString:@"iPhone Simulator"]) {
    //device is simulator
} 
```

是最好的答案，因为它显然是在运行时执行而不是作为编译指令。

# c# - 存储和处理图像和视频的最佳做法是什么？

> ID：458307
> 
> 赞同：1
> 
> 时间：2009-01-19T16:56:55.573
> 
> 标签：c#, wpf, video-capture

我的应用程序（用 WPF/C# 编写）将监视实时视频源，并且需要存储小的视频片段和图像静止图像。我对使用用户定义的“临时”目录犹豫不决，因为这可能会允许用户修改或删除这些文件，从而导致我的应用程序出现重大问题。或者，我试图将这些项目存储在内存中（图像的 BitmapSource 对象），但找不到视频的等效对象。我应该字节项目符号并使用临时目录并简单地使用图像的 URI 还是他们更好的方法？先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T16:59:26.113

也许你想看看.NET 提供的[独立存储](http://msdn.microsoft.com/en-us/library/3ak841sy.aspx)

那应该做我认为的工作..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T16:59:43.773

您不能使用 appdata 存储而不是用户选择的存储吗？

```
System.Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T17:06:13.183

我们做什么.. 理想情况下，我们将图像存储在安全的远程服务器（如 dvr）上。当这是不可能的。加密日志.. 用于存储（保存和加载）图像以防止任何篡改。

——迈克尔

# scripting - IronPython宿主程序的方法访问拦截

> ID：458310
> 
> 赞同：2
> 
> 时间：2009-01-19T16:57:26.773
> 
> 标签：scripting, ironpython

问候，

我看到的大多数关于为对象构建代理的信息都假设在某处存在一个类型，它定义了要代理的成员。我的问题是：我不能有任何这样的类型。

为了使问题更简单，我有一个将字符串映射到对象的字典。我也有 getter 和 setter 来处理这本字典。

我的目标是在 IronPython 内部提供对这些 getter 和 setter 的透明访问，就好像它们是类的真实属性一样。例如，python 脚本中的以下代码：

```
x.result = x.input * x.percentage; 
```

...实际上会以宿主语言表示类似的东西：

```
x.SetProperty("result", x.GetProperty("input") * x.GetProperty("percentage")); 
```

此外，这里的“x”由主机程序给出。有任何想法吗？请记住，我负担不起创建类型化存根......理想情况下，如果我能以某种方式拦截对脚本语言中特定对象的属性/方法的每次调用，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T22:31:45.070

[这篇文章](http://blogs.msdn.com/srivatsn/archive/2008/04/12/turning-your-net-object-models-dynamic-for-ironpython.aspx)可能有用。

# python - 如何在 Windows 中安装没有 easy_install 的 .egg 文件？

> ID：458311
> 
> 赞同：17
> 
> 时间：2009-01-19T16:58:10.233
> 
> 标签：python, easy-install, egg

我有 Python 2.6，我想安装 easy _ install 模块。问题是python 2.6的easy_install唯一可用的安装包是.egg文件！我该怎么办？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-19T17:05:36.960

你可以试试[这个脚本](http://peak.telecommunity.com/dist/ez_setup.py)。

```
#!python
"""Bootstrap setuptools installation

If you want to use setuptools in your package's setup.py, just include this
file in the same directory with it, and add this to the top of your setup.py::

    from ez_setup import use_setuptools
    use_setuptools()

If you want to require a specific version of setuptools, set a download
mirror, or use an alternate download directory, you can do so by supplying
the appropriate options to ``use_setuptools()``.

This file can also be run as a script to install or upgrade setuptools.
"""
import sys
DEFAULT_VERSION = "0.6c11"
DEFAULT_URL     = "http://pypi.python.org/packages/%s/s/setuptools/" % sys.version[:3]

md5_data = {
    'setuptools-0.6b1-py2.3.egg': '8822caf901250d848b996b7f25c6e6ca',
    'setuptools-0.6b1-py2.4.egg': 'b79a8a403e4502fbb85ee3f1941735cb',
    'setuptools-0.6b2-py2.3.egg': '5657759d8a6d8fc44070a9d07272d99b',
    'setuptools-0.6b2-py2.4.egg': '4996a8d169d2be661fa32a6e52e4f82a',
    'setuptools-0.6b3-py2.3.egg': 'bb31c0fc7399a63579975cad9f5a0618',
    'setuptools-0.6b3-py2.4.egg': '38a8c6b3d6ecd22247f179f7da669fac',
    'setuptools-0.6b4-py2.3.egg': '62045a24ed4e1ebc77fe039aa4e6f7e5',
    'setuptools-0.6b4-py2.4.egg': '4cb2a185d228dacffb2d17f103b3b1c4',
    'setuptools-0.6c1-py2.3.egg': 'b3f2b5539d65cb7f74ad79127f1a908c',
    'setuptools-0.6c1-py2.4.egg': 'b45adeda0667d2d2ffe14009364f2a4b',
    'setuptools-0.6c10-py2.3.egg': 'ce1e2ab5d3a0256456d9fc13800a7090',
    'setuptools-0.6c10-py2.4.egg': '57d6d9d6e9b80772c59a53a8433a5dd4',
    'setuptools-0.6c10-py2.5.egg': 'de46ac8b1c97c895572e5e8596aeb8c7',
    'setuptools-0.6c10-py2.6.egg': '58ea40aef06da02ce641495523a0b7f5',
    'setuptools-0.6c11-py2.3.egg': '2baeac6e13d414a9d28e7ba5b5a596de',
    'setuptools-0.6c11-py2.4.egg': 'bd639f9b0eac4c42497034dec2ec0c2b',
    'setuptools-0.6c11-py2.5.egg': '64c94f3bf7a72a13ec83e0b24f2749b2',
    'setuptools-0.6c11-py2.6.egg': 'bfa92100bd772d5a213eedd356d64086',
    'setuptools-0.6c2-py2.3.egg': 'f0064bf6aa2b7d0f3ba0b43f20817c27',
    'setuptools-0.6c2-py2.4.egg': '616192eec35f47e8ea16cd6a122b7277',
    'setuptools-0.6c3-py2.3.egg': 'f181fa125dfe85a259c9cd6f1d7b78fa',
    'setuptools-0.6c3-py2.4.egg': 'e0ed74682c998bfb73bf803a50e7b71e',
    'setuptools-0.6c3-py2.5.egg': 'abef16fdd61955514841c7c6bd98965e',
    'setuptools-0.6c4-py2.3.egg': 'b0b9131acab32022bfac7f44c5d7971f',
    'setuptools-0.6c4-py2.4.egg': '2a1f9656d4fbf3c97bf946c0a124e6e2',
    'setuptools-0.6c4-py2.5.egg': '8f5a052e32cdb9c72bcf4b5526f28afc',
    'setuptools-0.6c5-py2.3.egg': 'ee9fd80965da04f2f3e6b3576e9d8167',
    'setuptools-0.6c5-py2.4.egg': 'afe2adf1c01701ee841761f5bcd8aa64',
    'setuptools-0.6c5-py2.5.egg': 'a8d3f61494ccaa8714dfed37bccd3d5d',
    'setuptools-0.6c6-py2.3.egg': '35686b78116a668847237b69d549ec20',
    'setuptools-0.6c6-py2.4.egg': '3c56af57be3225019260a644430065ab',
    'setuptools-0.6c6-py2.5.egg': 'b2f8a7520709a5b34f80946de5f02f53',
    'setuptools-0.6c7-py2.3.egg': '209fdf9adc3a615e5115b725658e13e2',
    'setuptools-0.6c7-py2.4.egg': '5a8f954807d46a0fb67cf1f26c55a82e',
    'setuptools-0.6c7-py2.5.egg': '45d2ad28f9750e7434111fde831e8372',
    'setuptools-0.6c8-py2.3.egg': '50759d29b349db8cfd807ba8303f1902',
    'setuptools-0.6c8-py2.4.egg': 'cba38d74f7d483c06e9daa6070cce6de',
    'setuptools-0.6c8-py2.5.egg': '1721747ee329dc150590a58b3e1ac95b',
    'setuptools-0.6c9-py2.3.egg': 'a83c4020414807b496e4cfbe08507c03',
    'setuptools-0.6c9-py2.4.egg': '260a2be2e5388d66bdaee06abec6342a',
    'setuptools-0.6c9-py2.5.egg': 'fe67c3e5a17b12c0e7c541b7ea43a8e6',
    'setuptools-0.6c9-py2.6.egg': 'ca37b1ff16fa2ede6e19383e7b59245a',
}

import sys, os
try: from hashlib import md5
except ImportError: from md5 import md5

def _validate_md5(egg_name, data):
    if egg_name in md5_data:
        digest = md5(data).hexdigest()
        if digest != md5_data[egg_name]:
            print >>sys.stderr, (
                "md5 validation of %s failed!  (Possible download problem?)"
                % egg_name
            )
            sys.exit(2)
    return data

def use_setuptools(
    version=DEFAULT_VERSION, download_base=DEFAULT_URL, to_dir=os.curdir,
    download_delay=15
):
    """Automatically find/download setuptools and make it available on sys.path

    `version` should be a valid setuptools version number that is available
    as an egg for download under the `download_base` URL (which should end with
    a '/').  `to_dir` is the directory where setuptools will be downloaded, if
    it is not already available.  If `download_delay` is specified, it should
    be the number of seconds that will be paused before initiating a download,
    should one be required.  If an older version of setuptools is installed,
    this routine will print a message to ``sys.stderr`` and raise SystemExit in
    an attempt to abort the calling script.
    """
    was_imported = 'pkg_resources' in sys.modules or 'setuptools' in sys.modules
    def do_download():
        egg = download_setuptools(version, download_base, to_dir, download_delay)
        sys.path.insert(0, egg)
        import setuptools; setuptools.bootstrap_install_from = egg
    try:
        import pkg_resources
    except ImportError:
        return do_download()       
    try:
        pkg_resources.require("setuptools>="+version); return
    except pkg_resources.VersionConflict, e:
        if was_imported:
            print >>sys.stderr, (
            "The required version of setuptools (>=%s) is not available, and\n"
            "can't be installed while this script is running. Please install\n"
            " a more recent version first, using 'easy_install -U setuptools'."
            "\n\n(Currently using %r)"
            ) % (version, e.args[0])
            sys.exit(2)
    except pkg_resources.DistributionNotFound:
        pass

    del pkg_resources, sys.modules['pkg_resources']    # reload ok
    return do_download()

def download_setuptools(
    version=DEFAULT_VERSION, download_base=DEFAULT_URL, to_dir=os.curdir,
    delay = 15
):
    """Download setuptools from a specified location and return its filename

    `version` should be a valid setuptools version number that is available
    as an egg for download under the `download_base` URL (which should end
    with a '/'). `to_dir` is the directory where the egg will be downloaded.
    `delay` is the number of seconds to pause before an actual download attempt.
    """
    import urllib2, shutil
    egg_name = "setuptools-%s-py%s.egg" % (version,sys.version[:3])
    url = download_base + egg_name
    saveto = os.path.join(to_dir, egg_name)
    src = dst = None
    if not os.path.exists(saveto):  # Avoid repeated downloads
        try:
            from distutils import log
            if delay:
                log.warn("""
---------------------------------------------------------------------------
This script requires setuptools version %s to run (even to display
help).  I will attempt to download it for you (from
%s), but
you may need to enable firewall access for this script first.
I will start the download in %d seconds.

(Note: if this machine does not have network access, please obtain the file

   %s

and place it in this directory before rerunning this script.)
---------------------------------------------------------------------------""",
                    version, download_base, delay, url
                ); from time import sleep; sleep(delay)
            log.warn("Downloading %s", url)
            src = urllib2.urlopen(url)
            # Read/write all in one block, so we don't create a corrupt file
            # if the download is interrupted.
            data = _validate_md5(egg_name, src.read())
            dst = open(saveto,"wb"); dst.write(data)
        finally:
            if src: src.close()
            if dst: dst.close()
    return os.path.realpath(saveto)

def main(argv, version=DEFAULT_VERSION):
    """Install or upgrade setuptools and EasyInstall"""
    try:
        import setuptools
    except ImportError:
        egg = None
        try:
            egg = download_setuptools(version, delay=0)
            sys.path.insert(0,egg)
            from setuptools.command.easy_install import main
            return main(list(argv)+[egg])   # we're done here
        finally:
            if egg and os.path.exists(egg):
                os.unlink(egg)
    else:
        if setuptools.__version__ == '0.0.1':
            print >>sys.stderr, (
            "You have an obsolete version of setuptools installed.  Please\n"
            "remove it from your system entirely before rerunning this script."
            )
            sys.exit(2)

    req = "setuptools>="+version
    import pkg_resources
    try:
        pkg_resources.require(req)
    except pkg_resources.VersionConflict:
        try:
            from setuptools.command.easy_install import main
        except ImportError:
            from easy_install import main
        main(list(argv)+[download_setuptools(delay=0)])
        sys.exit(0) # try to force an exit
    else:
        if argv:
            from setuptools.command.easy_install import main
            main(argv)
        else:
            print "Setuptools version",version,"or greater has been installed."
            print '(Run "ez_setup.py -U setuptools" to reinstall or upgrade.)'

def update_md5(filenames):
    """Update our built-in md5 registry"""

    import re

    for name in filenames:
        base = os.path.basename(name)
        f = open(name,'rb')
        md5_data[base] = md5(f.read()).hexdigest()
        f.close()

    data = ["    %r: %r,\n" % it for it in md5_data.items()]
    data.sort()
    repl = "".join(data)

    import inspect
    srcfile = inspect.getsourcefile(sys.modules[__name__])
    f = open(srcfile, 'rb'); src = f.read(); f.close()

    match = re.search("\nmd5_data = {\n([^}]+)}", src)
    if not match:
        print >>sys.stderr, "Internal error!"
        sys.exit(2)

    src = src[:match.start(1)] + repl + src[match.end(1):]
    f = open(srcfile,'w')
    f.write(src)
    f.close()

if __name__=='__main__':
    if len(sys.argv)>2 and sys.argv[1]=='--md5update':
        update_md5(sys.argv[2:])
    else:
        main(sys.argv[1:]) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-10T03:43:06.217

sh setuptools-0.6c9-py2.5.egg

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T17:06:09.377

也许您需要引导设置工具，如下所示：

[http://www.ibm.com/developerworks/library/l-cppeak3.html](http://www.ibm.com/developerworks/library/l-cppeak3.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-03T20:01:06.863

MS Windows 安装程序 (.exe) [http://pypi.python.org/pypi/setuptools#files](http://pypi.python.org/pypi/setuptools#files)

# c# - 检查日期是否在跨度重复之间的最有效方法是什么？

> ID：458322
> 
> 赞同：0
> 
> 时间：2009-01-19T17:00:06.190
> 
> 标签：c#, algorithm, date

使用 c# date 类检查日期是否介于重复的时间跨度之间的最有效方法是什么。

例如，您的跨度为 01/01/2009 1:00:00 am 到 01/06/2009 5:00pm，每*x*年、月或周等重复一次。

我想检查变量日期是否`x`介于任何重复之间

我读了[Martin Fowler 关于时间表达的论文，](http://martinfowler.com/apsupp/recurring.pdf)但他所有的例子都是单日事件，而不是可以跨越多天的事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T17:09:43.753

以下条件必须为真：

`(time - begin) mod period < (end - begin)`,

前提是`period > (begin - end)`

所有变量都应以相同的单位表示（例如，秒或您需要的任何精度）

# php - Zend_Db_Table 关系和 Zend_Paginator

> ID：458325
> 
> 赞同：3
> 
> 时间：2009-01-19T17:01:35.440
> 
> 标签：php, zend-framework, orm, zend-paginator

有没有办法在选择上应用分页器限制，我将其发送到 findDependentRowset 函数？例如：

```
$select = $row->select();
$select->order('item_name');    
$row->findDependentRowset($table, null, $select) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T01:09:10.880

您只需为传递给 findDependentRowset 的选择添加限制。它看起来像这样：

```
$select = $row->select()->limit($itemCountPerPage,$offset);
$select->order('item_name');    
$row->findDependentRowset($table, null, $select); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T10:17:32.713

这看起来不错，但分页器不会有关于所有行数的信息。我找到了覆盖 Zend_Paginator_Adapter_DbSelect 并设置函数的解决方案

```
public function getItems($offset, $itemCountPerPage)
{
   $this->_select->limit($itemCountPerPage, $offset);
   return $this->_select;
} 
```

这将返回带有应用限制的选择，我可以使用 Paginator 的全部功能

# visual-studio-2008 - 安装VS 2008后项目门户轰炸？

> ID：458327
> 
> 赞同：1
> 
> 时间：2009-01-19T17:02:27.370
> 
> 标签：visual-studio-2008, sharepoint, tfs

我有一个正在工作的、新安装的 Windows Server、Team Foundation Server、SQL Server 等，它们和谐地工作，一切都很好。然后——我在服务器上安装了 VS2008 Team Suite，这样我就可以将它用作自动构建/测试的构建代理。在那之后，项目门户被炸毁了......

此页面遇到严重错误。如果此问题仍然存在，请联系您的系统管理员。

我确定这与在 web.config 中编写一些新条目或其他内容有关，我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T18:01:43.290

您是否也安装了 Team Suite 的 SP1？我想知道它是否可能与也与 Team Suite 一起安装的 .NET 3.5 SP1 有关。

我认为这是 WSS 3.0 安装而不是 WSS 2.0？

# c# - 检测 SQL 集群

> ID：458328
> 
> 赞同：2
> 
> 时间：2009-01-19T17:02:28.150
> 
> 标签：c#, sql-server, wmi

我正在尝试编写一些代码来确定 SQL 服务器列表是否已启动。我尝试过 WMI、SQLDMO、SqlDataSourceEnumerator 和 Ping 每台服务器的 1433 端口，都取得了不同程度的成功（见下面的结果）。

使用 SQLDMO 和 SqlDataSourceEnumerator，我在 6 个中找到了 3 个，必须说 3 个缺失的 SQL 服务器中有 2 个形成了一个集群。

ping 端口 1433 找到 6 个中的 4 个，缺少的 2 个是组成 SQL 集群的 2 个服务器。

WMI 被证明是最不成功的，因为它只找到了 6 台服务器中的 1 台。

这是我用来原型化服务器发现的代码：

```
private void buildServerMap(bool useLibCOM)
    {
        sqlServersMap = new Dictionary<string, string>();

        if (useLibCOM)
        {
            //get all available SQL Servers     
            SQLDMO.Application sqlApp = new SQLDMO.ApplicationClass();
            SQLDMO.NameList sqlServers = sqlApp.ListAvailableSQLServers();

            ArrayList servs = new ArrayList();
            for (int i = 0; i < sqlServers.Count; i++)
            {
                object srv = sqlServers.Item(i + 1);

                if (srv != null)
                {
                    sqlServersMap.Add(srv.ToString(), srv.ToString());
                }
            }
        }
        else
        {
            System.Data.Sql.SqlDataSourceEnumerator enumSQL = System.Data.Sql.SqlDataSourceEnumerator.Instance;

            System.Data.DataTable table = enumSQL.GetDataSources();

            foreach (System.Data.DataRow row in table.Rows)
            {

                foreach (System.Data.DataColumn col in table.Columns)
                {
                    sqlServersMap.Add((string)row[col], (string)row[col]);
                }
            }
        }
    }

    private bool pingSqlServer(string server)
    {
        bool success = false;

        TcpClient client = new TcpClient();

       try 
        {           
            client.Connect(server, 1433);

            success = true;
        }
        catch (Exception)
        {

            //throw;
        }

        return success;
    }

    public StringBuilder buildWmiServerList(string path, string sqlServer, string sqlServerServiceName, StringBuilder sb, out bool reportNeeded)
    {
        reportNeeded = false;

        try
        {
            ManagementScope ms = new ManagementScope(path);

            ms.Connect();

            ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_Service WHERE Started = TRUE AND DisplayName='" + sqlServerServiceName + "'");
            searcher.Scope = ms;

            if (searcher != null && searcher.Get() != null)
            {
                foreach (ManagementObject service in searcher.Get())
                {
                    sb.Append(sqlServer + " SQL Server service - RUNNING\n");
                }
            }
        }
        catch (Exception e)
        {
            sb.Append(sqlServer + " SQL Server service - UNVERIFIABLE\n");
            reportNeeded = true;
        }

        return sb;
    } 
```

**关于如何解析/检测形成 SQL 集群的 SQL 服务器的任何想法？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T18:15:27.503

我不知道无论如何都已弃用的 DMO，但在 SMO 中您可以执行 Server.IsClustered。

您可能还想看看这个： [http ://www.sqldbtips.com/showarticle.asp?ID=45](http://www.sqldbatips.com/showarticle.asp?ID=45)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:39:11.817

为什么不试试[SQL ping](http://www.sqlsecurity.com/Tools/FreeTools/tabid/65/Default.aspx)呢？这里有源代码，所以你可以看到他们是如何做到的。

无论如何，一些想法：

您是在尝试物理服务器、集群名称还是虚拟服务器名称，例如 phys1、phys2、vclus、vserv1、vserv2（假设为主动/主动）？

您是否使用客户端的 tcp 或命名管道？你试过 tcp:vserv1 吗？例如，如果禁用然后启用，命名管道在集群 IIRC 上可能会很有趣。使用的协议列在 SQL 日志中，以及使用的 tcp 端口（命名实例 = 随机）

您可以在客户端上创建系统 DSN 吗？从中可以算出 HKLM\SW\Microsoft\MSSQLServer 下使用的是什么端口和协议

# .net - 来自 ADO.NET 或经典 ADO 的长时间运行的存储过程

> ID：458333
> 
> 赞同：1
> 
> 时间：2009-01-19T17:03:31.503
> 
> 标签：.net, sql-server, tsql, ado.net, ado

假设 Stored Proc 需要 10 分钟才能运行并且不返回任何数据。

在 SQL Server 中调用存储过程并让您的代码不等待结果的正确方法是什么？有没有办法从 T-SQL 或连接处理它？在 ADO.NET 和经典 ActiveX ADO 中工作的东西？

我想到的唯一方法是：
1）在您的 T-SQL 中创建一个作业
2）将您的基于 T-SQL 的代码加载到作业的第一步中
3）确保您的代码的最后一行删除了作业
4）执行作业（我很确定这不会让你等待回应）我知道这非常糟糕和骇人听闻......但是

是否还有其他一些我没有想到的 T-SQL，您可以将存储过程包装起来说“我知道没有响应......所以我选择不等待。”？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T17:11:05.887

是的你可以

1.  使用 SqlCommand.BeginExecuteNonQuery() 异步调用它
2.  或者在委托上异步调用它（将使用线程池中的线程），
3.  或在单独的线程上（自己创建）
4.  在经典 ADO 中，使用 Connection 的 Open 方法中的 Option 参数：

    oConnection.Open( , , , adAsyncConnect)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T17:06:59.437

对于.Net，请尝试`.BeginExecuteNonQuery()`您的`SqlCommand`对象的方法。不过，不确定这在 ActiveX ADO 中是​​如何工作的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T17:12:22.297

我会调查重写任何花费这么长时间的 SP，除非它正在进行更改或插入大量记录。如果您的 sp 从用户界面花费超过 30 秒，我说您很有可能出现性能问题。有问题的 proc 是否有游标？如果你是这样的话，你可以通过适当的性能调整将它降低到毫秒。我会在做一个解决方法之前考虑性能调整，以使用户界面在没有 proc 完成的情况下继续运行。

你说它不返回任何记录，但是如果它失败了用户需要知道什么？如果他们继续做其他事情，他们会认为它已经成功完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T17:06:57.660

在单独的线程中运行它，然后让线程死掉。

# python - 有没有比 HTML 更好的布局语言用于打印？

> ID：458340
> 
> 赞同：15
> 
> 时间：2009-01-19T17:05:38.690
> 
> 标签：python, qt, layout, printing, gpl

我正在使用 Python 和 Qt 4.4，我必须打印一些页面。最初我以为我会使用带有 CSS 的 HTML 来生成这些页面。但是 HTML 有一些限制。

现在的问题是：有什么东西比 HTML 更好，但同样（或几乎）易于使用？此外，它应该与 GPL 兼容。

**编辑：**

*kdgregory & Mark G：*最明显的限制是我不能指定打印机边距。还有一个问题：如何添加页码？

*Jeremy French：*我必须打印的一件事是某人订购的所有产品的清单，该清单可以分布在几页上。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-19T21:59:41.810

8 年来，我一直在与 Python 的打印（或 PDF）输出作斗争，到目前为止，我遇到了以下方法（按个人喜好排序）：

*   通过[pyJasper](https://github.com/hudora/pyJasper)（由我编写）或[JasperServer](http://blogs.23.nu/c0re/2008/07/antville-18473/)使用[JasperReports](http://www.jaspersoft.com/JasperSoft_JasperReports.html?utm_source=google&utm_medium=cpc&utm_content=JasperReports&utm_campaign=JasperReportsSearchjasperreports)。您可以使用所见即所得的设计工具[iReport](http://www.jaspersoft.com/JasperSoft_iReport.html)来定义您的布局。您的 Python 代码将通过 HTTP 联系基于 Java 的 Jasper 引擎并使其呈现 PDF（pyJasper 处理）。我们每天使用几千页。
*   使用纯文本输出。你不能再快了。我们每天使用它几百页。
*   使用 XSLT-FO。您还必须调用基于 Java 的渲染引擎，例如 FOB。可能会导致性能问题，但可以通过长时间运行 Java 服务器进程来缓解 - 与 Jasper 相同的方法。我们每天使用它几百页，但编写 XSLT-FO 文档让我头疼。不用于新代码。
*   生成[LaTeX](http://www.latex-project.org/)源代码并使用 Latex 软件包渲染为 PDF。让 LaTeX 看起来像**你**喜欢的样子是相当困难的。但只要您使用提供的 LaTeX 样式，就可以了。在我的商店没有用于生产。
*   [使用ReportLab 工具包](http://www.reportlab.org/rl_toolkit.html)生成 PDF 。水平有点低。更底层：[FPDF](http://pypi.python.org/pypi/pyFPDF/)。我们每天使用 FPDF-Ruby 几百页。花了很多时间才得到我们想要的布局。
*   直接生成Postscript。奇怪，但在速度和控制方面你几乎无法获得更多。我们用它来生成每天有几十万 Jpeg 的联系表。需要摆弄，但很有趣。
*   使用[troff](http://www.troff.org/) /groff 生成 Postscript/PDF。非常低级别的但很适合做简单的、高容量的事情。因此从未在生产中使用过它。

对于订单、发票等，我强烈推荐 JasperReports。使用可视化编辑器定义布局的能力可以节省大量时间。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-19T17:07:50.747

有乳胶。不确定这是否属于“像 html 一样易于使用”的类别，但这并不难。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-19T17:08:00.403

打印是指*打印机*吗？如果是这样，请检查[ReportLab](http://www.reportlab.org/)的 PDF 工具。

```
from reportlab.pdfgen import canvas
from reportlab.lib.units import cm
c = canvas.Canvas("hello.pdf")
c.drawString(9*cm, 22*cm, "Hello World!")
c.showPage()
c.save() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T17:26:14.717

您可能会考虑[Sphinx](http://sphinx.pocoo.org/)，这是一个将 reStructuredText 文件转换为各种输出格式（包括 HTML 和 LaTeX）的包，用于可打印的 PDF。它在 BSD 下获得许可，现在是官方 Python 文档工具。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-07T10:36:21.353

你看过[http://www.w3.org/TR/css3-page/](http://www.w3.org/TR/css3-page/)吗？印刷媒体是高度可定制的。在我的新项目中，我将用这个替换 PDF 生成器。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-19T17:18:15.747

XSL 格式化对象（[可扩展样式表语言系列 (XSL) 的](http://www.w3.org/Style/XSL/)一部分），如果您需要*完全*控制打印文档。

然后，您需要一个格式化对象处理器，如[FOP](http://xmlgraphics.apache.org/fop/)或[Antenna house](http://www.antennahouse.com/)，将 XSL-FO 文档转换为 PDF 或 PostScript。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T17:18:00.850

仅使用[Qt 的本机打印](http://doc.trolltech.com/4.3/printing.html)有什么问题？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-19T20:58:24.853

或者，如果您使用的是 Mac，您可以查看[Python 的石英绑定](http://developer.apple.com/DOCUMENTATION/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_python/chapter_17_section_1.html)，但它显然不是 GPL。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-10-31T09:00:42.320

我开始喜欢[asciidoc](http://www.methods.co.nz/asciidoc/)。基本上你会产生纯文本。[这可以通过使用像Django 模板](https://docs.djangoproject.com/en/dev/ref/templates/api/)或[Jinja2](http://jinja.pocoo.org/)这样的模板系统来增强很多。这在原则上很像 mdorseif 描述的 XSLT-FO 事物（您使用工具链来生成 docbook，然后生成任何您喜欢的东西），但并没有那么令人头疼。已经有一个很好的工具链包装器可以让大多数事情变得简单。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-12-30T18:37:18.240

**JasperReports**已经提到过，但是我们在没有服务器或 servlet（即，不需要 JasperServer 或 pyJasper）的 Python-Qt 应用程序中使用它。

所以基本上，您安装[Jasper Reports Library](http://community.jaspersoft.com/project/jasperreports-library)而不是服务器/servlet 。然后，您需要创建一个小的 Java 程序，该程序使用 Jasper 报告库从序列化输入（例如 XML）生成 PDF 报告。如果你进行网络搜索，应该有很多这样的例子，你只需要写一次。然后将这个 Java 程序连同所有必需的库一起编译成一个 JAR 文件。

此时您可以安装[JasperSoft Studio](http://community.jaspersoft.com/project/jaspersoft-studio)并创建 Jasper 报告模板。然后在 Python 中，您可以使用[JPype](http://jpype.sourceforge.net/)（或任何其他 Python-to-Java 库）来启动 JVM，加载您的 JAR 文件，调用您的 Java 函数，将您的序列化数据传递给它，并指定您想要的报告模板。

所有这些都不是微不足道的，但它非常简单。我们喜欢这个解决方案，因为它在 Qt Designer/Creator 中提供了一个拖放式表单编辑器、一个拖放式 JasperReports 报表设计器，以及直接从 Python 中收集的数据生成 PDF 报表的能力。所有这些都使用了支持良好的工具和库，因此该解决方案在可预见的未来不太可能分崩离析。

# c# - 在 MVC 中处理来自共享控件的事件

> ID：458348
> 
> 赞同：3
> 
> 时间：2009-01-19T17:06:55.910
> 
> 标签：c#, model-view-controller, events

在我正在开发的一个应用程序中，我实现了一个 MVC 模式来使用不同的视图来显示 UI 的各个部分。在整个 UI 中有一个输入框，用户可以在其中给出命令或查询。这个想法是这个输入框生成一些基本事件，如“ValidEntry”、“InvalidEntry”和“EmptyEntry”。每个控制器部件都应响应这些事件。我不希望订阅 ValidEntry 事件的每个控制器都响应，只响应处于活动状态的控制器。

我可以向每个事件处理程序添加一个“if”来检查“this.IsActive”是否为真，并在每次视图切换时更新它。或者为所有不同的控制器添加不同的事件。关于这个问题有更好的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T17:29:52.603

假设一次只有 1 个控制器处于活动状态，那么拥有某种具有 SetActiveController 方法的控制器管理器类怎么样。管理器将订阅 UI 事件并在当前活动的控制器上调用适当的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:30:38.593

不确定不同的“视图”是否全部可见并且焦点发生变化，或者它们是否在它们不活动时被隐藏但让你的“一个控制器来控制它们”跟踪可见性或焦点并订阅/取消订阅给定事件的子控制器可能是我实现它的方式。使用接口/抽象类，您应该能够通用地做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T07:31:26.650

对于像 ValidEntry 这样您只希望单个控制器响应的事件，最简单的方法是将其“降级”为委托，并在收到焦点时将其分配给活动控制器的处理程序。

当然，当这个简单的要求变得复杂时，跟踪可见性和订阅的经理肯定会提供更好的结构。但现在它是一个矫枉过正:)

# asp.net - 错误填写 ASP MVC 表单字段

> ID：458356
> 
> 赞同：0
> 
> 时间：2009-01-19T17:08:48.467
> 
> 标签：asp.net, asp.net-mvc

我有一个 ASP MVC 表单，它更新一个业务对象，然后它的动作转到另一个页面。

这两个页面都有一个 id 为“描述”的文本区域，当它转到另一个页面时，由于未知原因，它会填写在表单提交之前输入的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T17:11:10.613

您使用哪种方法来更新您的对象？您是否尝试在 ID 中添加对象类型名称？

比如，Product.Description 而不仅仅是描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:27:22.703

不知道您到底在做什么，我会说 ViewData 的模型上有一个“描述”属性。ASP.NET MVC 将尝试将您的表单值与来自 ViewData 的值（包括模型）进行匹配。您可以按照 Chad 所说的重命名控件或直接引用对象。例如 Product.Description

有了更多细节，有人可能会提供更多帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-10T09:23:58.400

在没有看到您的控制器操作的情况下，这有点猜测工作，但它如何转到另一个页面？

如果在 post 控制器中您返回不同的视图（或返回另一个返回视图的操作等），则可能是 ModelState 正在使用先前表单提交中的尝试值，这是预期的行为（这是验证系统和模型绑定开始工作）。如果您要将它们发送到不同的表单，请使用 RedirectResult 到您的下一个操作，并在需要时使用 TempData 来处理您在转换时需要保留的任何状态。

如果可能的话，我还建议使用强类型帮助器，例如 Html.TextAreaFor(x=>x.Description)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-19T17:12:56.023

```
<p><label>Description</label><br /><br /><%=Html.TextArea("Description", new { style = "width:470px;" })%></p> 
```

为了澄清起见，我将从“编辑项目”页面转到“添加问题”页面

# c# - 如何列出所有加载的程序集？

> ID：458362
> 
> 赞同：108
> 
> 时间：2009-01-19T17:10:51.537
> 
> 标签：c#, .net, assemblies

在 .Net 中，我想枚举所有 AppDomain 上的所有加载程序集。为我的程序的 AppDomain 做这件事很容易`AppDomain.CurrentDomain.GetAssemblies()`。我是否需要以某种方式访问​​每个 AppDomain？或者已经有一个工具可以做到这一点？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-01-19T17:17:39.570

**使用 Visual Studio**

1.  将调试器附加到进程（例如，从调试开始或“调试”>“附加到进程”）
2.  调试时，显示 Modules 窗口（Debug > Windows > Modules）

这提供了有关每个程序集、应用程序域的详细信息，并有一些加载符号的选项（即包含调试信息的 pdb 文件）。

[![在此处输入图像描述](https://i.stack.imgur.com/vEhgX.png)](https://i.stack.imgur.com/vEhgX.png)

**使用进程资源管理器**

如果您想要一个外部工具，您可以使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)（免费软件，由 Microsoft 发布）

单击一个进程，它将显示一个包含所有使用的程序集的列表。该工具非常好，因为它显示了其他信息，例如文件句柄等。

**以编程方式**

检查[这个](https://stackoverflow.com/questions/383686/how-do-you-loop-through-currenlty-loaded-assemblies)解释如何做的问题。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2011-11-29T00:03:27.787

这就是我最终的结果。它是所有属性和方法的列表，我列出了每个方法的所有参数。我没有成功获得所有的价值观。

```
foreach(System.Reflection.AssemblyName an in System.Reflection.Assembly.GetExecutingAssembly().GetReferencedAssemblies()){                      
            System.Reflection.Assembly asm = System.Reflection.Assembly.Load(an.ToString());
            foreach(Type type in asm.GetTypes()){   
                //PROPERTIES
                foreach (System.Reflection.PropertyInfo property in type.GetProperties()){
                    if (property.CanRead){
                        Response.Write("<br>" + an.ToString() + "." + type.ToString() + "." + property.Name);       
                    }
                }
                //METHODS
                var methods = type.GetMethods();
                foreach (System.Reflection.MethodInfo method in methods){               
                    Response.Write("<br><b>" + an.ToString() + "."  + type.ToString() + "." + method.Name  + "</b>");   
                    foreach (System.Reflection.ParameterInfo param in method.GetParameters())
                    {
                        Response.Write("<br><i>Param=" + param.Name.ToString());
                        Response.Write("<br>  Type=" + param.ParameterType.ToString());
                        Response.Write("<br>  Position=" + param.Position.ToString());
                        Response.Write("<br>  Optional=" + param.IsOptional.ToString() + "</i>");
                    }
                }
            }
        } 
```

# c# - 使用 c# 确定文件是否存在并解析 UNC 路径

> ID：458363
> 
> 赞同：29
> 
> 时间：2009-01-19T17:10:54.407
> 
> 标签：c#, filesystems

我正在尝试编写一个函数来确定文件是否存在。这两种方法被证明返回不一致的结果（与返回误报的 isFileFound() 相比，fileExists() 似乎提供了准确的结果 - 我在尝试创建实例时会出现异常）。

```
protected bool isFileFound(string path, string fileName)
    {
        System.IO.FileInfo fi = null;

        bool found = false;
        try
        {
            fi = new System.IO.FileInfo(path + fileName);
            found = true;
        }
        catch (Exception e)
        {
            baselogger.Fatal(e.Message + " " + e.StackTrace + " \n" + path + fileName);
        }

        return found;
    }

    protected bool fileExists(string path, string pattern)
    {
        bool success = false;

        try
        {
            success = File.Exists(path + pattern);
        }
        catch (Exception e)
        {
            baselogger.Warn(e.Message + " " + e.StackTrace + " " + e.Source);
        }

        return success;
    } 
```

似乎都无法解析以下语法的 UNC 路径：***\\abcserver\c$\xyzfolder\foo.bar***

任何想法为什么这些方法的 unc 路径失败将不胜感激。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-19T17:13:37.333

您可以为不存在的文件创建 FileInfo。但是您可以检查 FileInfo.Exists 属性以确定文件是否存在，例如：

```
FileInfo fi = new FileInfo(somePath);
bool exists = fi.Exists; 
```

**更新**：在一个简短的测试中，这也适用于 UNC 路径，例如：

```
FileInfo fi = new FileInfo(@"\\server\share\file.txt");
bool exists = fi.Exists; 
```

您确定该帐户（您的应用程序在其下运行）有权访问共享。我认为（默认情况下）需要管理权限才能访问共享“c$”。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-19T17:14:24.320

请参阅此问题：
[如何轻松检查 .NET 中文件的访问是否被拒绝？](https://stackoverflow.com/questions/265953/c-how-can-you-easily-check-if-access-is-denied-for-a-file)

该问题的简短版本是您没有，因为文件系统是易失性的。只需尝试打开文件并在失败时捕获异常。

您的`isFileFound`方法不起作用的原因是`FileInfo`您使用的结构也可用于创建文件。您可以为不存在的文件创建一个包含所需信息的 FileInfo 对象，调用它的`.Create()`方法，然后一次性设置所需的所有属性。

我怀疑 UNC 路径失败的原因是 1）从运行您的应用程序的用户访问管理共享的权限问题，*或*2）该`$`符号正在抛出该方法，或者因为输入不正确或由于错误底层 .Exists() 实现。

**更新：**

当我发布这个建议时，我几乎总是收到关于异常性能的抱怨。让我们谈谈那个。是的，处理异常很昂贵：*非常*昂贵。您可以在编程中做一些较慢的事情。但你知道那几样东西是什么吗？磁盘和网络 I/O。下面的链接演示了磁盘 I/O 和网络 I/O 的成本：

> [https://gist.github.com/jboner/2841832](https://gist.github.com/jboner/2841832)

```
延迟比较数字
--------------------------
L1 缓存参考 0.5 ns
分支错误预测 5 ns
L2 缓存参考 7 ns 14x L1 缓存
互斥锁/解锁 25 ns
主存参考 100 ns 20x L2 高速缓存，200x L1 高速缓存
使用 Zippy 3,000 ns 压缩 1K 字节
通过 1 Gbps 网络发送 1K 字节 10,000 ns 0.01 ms
从 SSD 随机读取 4K* 150,000 ns 0.15 ms
从内存中顺序读取 1 MB 250,000 ns 0.25 ms
同一数据中心内的往返 500,000 ns 0.5 ms
从 SSD 顺序读取 1 MB* 1,000,000 ns 1 ms 4X 内存
磁盘寻道 10,000,000 ns 10 ms 20x 数据中心往返
从磁盘顺序读取 1 MB 20,000,000 ns 20 ms 80x 内存，20X SSD
发送数据包 CA->Netherlands->CA 150,000,000 ns 150 ms
```

如果您不喜欢以纳秒为单位思考，那么这里有另一个链接，它将一个 CPU 周期标准化为 1 秒并从那里扩展：

> [http://blog.codinghorror.com/the-infinite-space-between-words/](http://blog.codinghorror.com/the-infinite-space-between-words/)

```
1 个 CPU 周期 0.3 ns 1 s
一级缓存访问 0.9 ns 3 s
二级缓存访问 2.8 ns 9 s
3 级缓存访问 12.9 ns 43 s
主存储器访问 120 ns 6 分钟
固态磁盘 I/O 50-150 μs 2-6 天
旋转磁盘 I/O 1-10 毫秒 1-12 个月
互联网：SF 到 NYC 40 毫秒 4 年
互联网：SF 到英国 81 毫秒 8 年
互联网：SF 到 AUS 183 ms 19 年
操作系统虚拟。重启 4 s 423 年
SCSI 命令超时 30 秒 3000 年
硬件虚拟。重启 40 秒 4000 年
物理系统重启 5 m 32 千年
```

即使是最好的例外情况，在等待磁盘的第一个响应时，您至少可以访问内存 480 次，这是假设 SSD 速度非常快的情况。我们中的许多人仍然需要旋转硬盘驱动器，情况变得非常糟糕。

而这只是故事的开始。当您使用时，*每次*尝试都会`.Exists()`产生*额外*的成本（这是一个额外的成本：当您打开文件时，您必须再次执行相同的工作） 。无论文件是否存在，您都需要支付此费用，因为磁盘仍然需要在其文件表中查找它。使用异常方法，您只需支付在失败情况下展开调用堆栈的额外成本。

 *换句话说，是的：例外的代价非常高昂。但与磁盘检查相比，它仍然更快：而且差距不大。值得庆幸的是，这不太可能推动您的应用程序的总体性能......但我仍然想为这个特定任务提出“异常缓慢”的论点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T17:40:13.160

这可能是也可能不是这种情况，但您是否会为您的一种情况错误地加入您的路径文件名。

这：

成功 = File.Exists(路径 + 模式);

与：

成功 = File.Exists(Path.Join(path,pattern));

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T17:41:10.693

这可以帮助您：
[http://www.codeplex.com/FileDirectoryPath](http://www.codeplex.com/FileDirectoryPath)
它是**NDepend.Helpers.FilePathDirectory**，它有一个“路径有效性检查 API”，其中可能有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T18:17:57.470

所以我和

```
bool success = File.Exists(path + Filename); 
```

选项，而不是使用 FileInfo 路由。

感谢所有的建议！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-03T05:44:48.843

**编辑：**嗯，我刚刚意识到 file.exists 工作正常。这绝对是首选方法。如果应该在不同的域帐户下访问共享，下面的代码将为您提供让 Windows 提示用户进行身份验证的选项。有一天可能会帮助某人，所以我将代码留在这里。

如果您需要使用不同的凭据访问 UNC 路径或管理员共享： [MSDN](http://msdn.microsoft.com/en-us/library/aa385413%28VS.85%29.aspx)

要引导使用 WNetAddConnection2，请使用以下代码：

```
using System;
using System.Runtime.InteropServices;

namespace Win32Api
{
    public enum ResourceScope
    {
        RESOURCE_CONNECTED = 1,
        RESOURCE_GLOBALNET,
        RESOURCE_REMEMBERED,
        RESOURCE_RECENT,
        RESOURCE_CONTEXT
    };

    public enum ResourceType
    {
        RESOURCETYPE_ANY,
        RESOURCETYPE_DISK,
        RESOURCETYPE_PRINT,
        RESOURCETYPE_RESERVED = 8
    };

    [Flags]
    public enum ResourceUsage
    {
        RESOURCEUSAGE_CONNECTABLE = 0x00000001,
        RESOURCEUSAGE_CONTAINER = 0x00000002,
        RESOURCEUSAGE_NOLOCALDEVICE = 0x00000004,
        RESOURCEUSAGE_SIBLING = 0x00000008,
        RESOURCEUSAGE_ATTACHED = 0x00000010,
        RESOURCEUSAGE_ALL = (RESOURCEUSAGE_CONNECTABLE |
                             RESOURCEUSAGE_CONTAINER | RESOURCEUSAGE_ATTACHED),
    };

    public enum ResourceDisplayType
    {
        RESOURCEDISPLAYTYPE_GENERIC,
        RESOURCEDISPLAYTYPE_DOMAIN,
        RESOURCEDISPLAYTYPE_SERVER,
        RESOURCEDISPLAYTYPE_SHARE,
        RESOURCEDISPLAYTYPE_FILE,
        RESOURCEDISPLAYTYPE_GROUP,
        RESOURCEDISPLAYTYPE_NETWORK,
        RESOURCEDISPLAYTYPE_ROOT,
        RESOURCEDISPLAYTYPE_SHAREADMIN,
        RESOURCEDISPLAYTYPE_DIRECTORY,
        RESOURCEDISPLAYTYPE_TREE,
        RESOURCEDISPLAYTYPE_NDSCONTAINER
    };

    [StructLayout(LayoutKind.Sequential)]
    public class NetResource
    {
        public ResourceScope Scope;
        public ResourceType Type;
        public ResourceDisplayType DisplayType;
        public ResourceUsage Usage;
        public string LocalName;
        public string RemoteName;
        public string Comment;
        public string Provider;
    };

    [Flags]
    public enum AddConnectionOptions
    {
        CONNECT_UPDATE_PROFILE = 0x00000001,
        CONNECT_UPDATE_RECENT = 0x00000002,
        CONNECT_TEMPORARY = 0x00000004,
        CONNECT_INTERACTIVE = 0x00000008,
        CONNECT_PROMPT = 0x00000010,
        CONNECT_NEED_DRIVE = 0x00000020,
        CONNECT_REFCOUNT = 0x00000040,
        CONNECT_REDIRECT = 0x00000080,
        CONNECT_LOCALDRIVE = 0x00000100,
        CONNECT_CURRENT_MEDIA = 0x00000200,
        CONNECT_DEFERRED = 0x00000400,
        CONNECT_RESERVED = unchecked((int)0xFF000000),
        CONNECT_COMMANDLINE = 0x00000800,
        CONNECT_CMD_SAVECRED = 0x00001000,
        CONNECT_CRED_RESET = 0x00002000
    }

    public static class NativeMethods
    {
        [DllImport("mpr.dll", EntryPoint = "WNetAddConnection2")]
        public static extern int WNetAddConnection2(
            NetResource netResource, string password,
            string username, AddConnectionOptions options);

        [DllImport("mpr.dll")]
        public static extern int WNetCancelConnection2(string name, int flags,
        bool force);

    }
} 
```

# sql - 使用单一且快速的 SQL 查询获取数据

> ID：458364
> 
> 赞同：1
> 
> 时间：2009-01-19T17:11:01.487
> 
> 标签：sql, performance

我有以下数据：

```
ExamEntry   Student_ID     Grade
  11           1             80
  12           2             70
  13           3             20
  14           3             68
  15           4             75 
```

我想找到所有通过考试的学生。在这种情况下，如果一个学生参加的考试很少，我需要找到最后一个结果。

所以，在这种情况下，我会让所有学生都通过。

我可以通过一个快速查询找到它吗？我这样做：

1.  通过从 Student_ID 的数据组中选择 max(ExamEntry) 来查找条目列表

2.  查找结果：

从 ( ) 中的 ExamEntry 数据中选择 ExamEntry。

但这非常慢 - 我收到大约 1000 个条目，而这 2 步过程需要 10 秒。

有没有更好的办法？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T17:19:16.493

如果您的查询非常慢，表中有 1000 条记录，则说明有问题。对于现代数据库系统，包含 1000 个条目的表被认为非常小。
很可能，您没有为您的表提供（主）键？

假设如果至少有一个成绩高于所需的最低分数，则学生将通过，适当的查询将是：

```
SELECT 
  Student_ID
, MAX(Grade) AS maxGrade
FROM table_name
GROUP BY Student_ID
HAVING maxGrade > MINIMUM_GRADE_NEEDED 
```

如果您确实需要最新成绩高于最低成绩：

```
SELECT 
  Student_ID
, Grade
FROM table_name
WHERE ExamEntry IN ( 
    SELECT 
      MAX(ExamEntry) 
    FROM table_name 
    GROUP BY Student_ID
)
HAVING Grade > MINIMUM_GRADE_NEEDED 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:18:17.557

```
SELECT student_id, MAX(ExamEntry)
FROM data
WHERE Grade > :threshold
GROUP BY student_id 
```

像这样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T17:21:36.537

我会假设您有一个学生表和测试表，并且您向我们展示的表是 test_result 表...（如果您没有类似的结构，您应该重新访问您的架构）

```
select s.id, s.name, t.name, max(r.score)
from student s
left outer join test_result r on r.student_id = s.id
left outer join test t on r.test_id = t.id
group by s.id, s.name, t.name 
```

所有带有 id 的字段都应该被索引。

如果您的域中真的只有一个测试（类型）......那么查询将是

```
select s.id, s.name, max(r.score)
from student s
left outer join test_result r on r.student_id = s.id
group by s.id, s.name 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T17:44:52.230

如前所述，索引是加快查询速度的强大工具。然而，索引的顺序是非常重要的。

按 (ExamEntry) 然后 (Student_ID) 然后 (Grade) 顺序排列的索引对于查找学生通过的考试几乎没有用处。

如果您只想找到通过了哪些考试，则相反顺序的索引将非常适合。这将使查询引擎能够快速识别已通过考试的行，并对其进行处理。

在 MS SQL Server 中，这可以通过......

```
CREATE INDEX [IX_results] ON [dbo].[results] 
(
    [Grade],
    [Student_ID],
    [ExamEntry]
)
ON [PRIMARY] 
```

（我建议阅读有关索引的更多信息，以了解还有哪些其他选项，例如 ClusterdIndexes 等）

使用该索引，以下查询将能够很快忽略“失败”的考试，而只显示曾经通过考试的学生......

（这假设如果您超过 60 岁，即使您随后再次参加考试并获得 27 分，您也会被视为及格。）

```
SELECT
    Student_ID
FROM
    [results]
WHERE
    Grade >= 60
GROUP BY
    Student_ID 
```

如果您确实需要最新的值，那么您需要将索引的顺序更改回类似...

```
CREATE INDEX [IX_results] ON [dbo].[results] 
(
    [Student_ID],
    [ExamEntry],
    [Grade]
)
ON [PRIMARY] 
```

这是因为我们感兴趣的第一件事是任何给定学生的最新 ExamEntry。可以使用以下查询来实现...

```
SELECT
   *
FROM
   [results]
WHERE
   [results].ExamEntry = (
                          SELECT
                              MAX([student_results].ExamEntry)
                          FROM
                              [results] AS [student_results]
                          WHERE
                              [student_results].Student_ID = [results].student_id
                         )
   AND [results].Grade > 60 
```

像这样的子查询可能看起来很慢，特别是因为它似乎是为 [results] 中的每一行执行的。

但是，情况并非如此...
- 主查询和子查询都引用同一个表
- 查询引擎扫描索引以查找每个唯一的 Student_ID
- 针对该 Student_ID 执行子查询
- 查询引擎已经在索引的那部分
- 所以不需要新的索引查找

编辑：

有人评论说，在 1000 条记录中，索引是不相关的。需要注意的是，问题说明有 1000 条记录返回，而不是表包含 1000 条记录。对于一个基本查询，只要声明的时间，我敢打赌表中有超过 1000 条记录。也许这可以澄清？

编辑：

我刚刚调查了 3 个查询，每个查询有 999 条记录（333 名学生每人 3 个考试结果）

方法 1： WHERE a.ExamEntry = (SELECT MAX(b.ExamEntry) FROM results [a] WHERE a.Student_ID = b.student_id)

方法 2：WHERE a.ExamEntry IN (SELECT MAX(ExamEntry) FROM resuls GROUP BY Student_ID)

方法 3：使用 INNER JOIN 代替 IN 子句

发现以下时间：

```
Method    QueryCost(No Index)   QueryCost(WithIndex)
   1               23%                    9%
   2               38%                   46%
   3               38%                   46% 
```

因此，无论索引如何，查询 1 都更快，但索引也肯定使方法 1 更快。

这样做的原因是索引允许查找，否则您需要扫描。线性定律和平方定律的区别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T06:50:34.403

我使用了这里给出的提示，在这里我发现查询比我的第一个查询快了近 3 个订单（0.03 秒而不是 10 秒）：

```
SELECT ExamEntry, Student_ID, Grade from data,
       ( SELECT max(ExamEntry) as ExId GROUP BY Student_ID) as newdata
WHERE `data`.`ExamEntry`=`newdata`.`ExId` AND Grade > 60; 
```

谢谢大家！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T23:15:55.713

感谢您的回答！

我认为 Dems 可能最接近我的需要，但我会详细说明这个问题。

1.  只有最新的成绩才算。如果学生第一次通过，再次参加但不及格，他就完全失败了。他/她本可以参加 3 或 4 次考试，但仍然只有最后一次重要。
2.  我使用 MySQL 服务器。我在 Linux 和 Windows 安装中遇到的问题。
3.  我的数据集现在大约有 2K 个条目，并且以每次新考试约 1K 的速度增长。
4.  特定考试的查询还返回 ~ 1K 条目，当 ~ 1K 是参加的学生人数（从结果中通过 SELECT DISTINCT STUDENT_ID 接收；）时，几乎所有学生都通过了，有些则失败了。

5.  我在我的代码中执行以下查询：SELECT ExamEntry, Student_ID from Exams WHERE ExamEntry in (SELECT MAX(ExamEntry) from Exams GROUP BY Student_ID)。由于子查询返回大约 1K 条目，因此主查询似乎循环扫描它们，使所有查询运行很长时间并且服务器负载为 50%（在 Windows 上为 100%）。

6.  我*觉得*有更好的方法:-)，只是还找不到。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-25T07:31:31.310

```
select examentry,student_id,grade 
from data 
where examentry in 
  (select max(examentry) 
   from data 
   where grade > 60 
   group by student_id) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-28T13:44:53.170

不要使用

```
where grade > 60 
```

但

```
where grade between 60 and 100 
```

那应该更快

# .net - 好的.Net Remoting 教程/指南

> ID：458378
> 
> 赞同：6
> 
> 时间：2009-01-19T17:14:21.357
> 
> 标签：.net, remoting

有没有人有任何链接到一个好的、简洁的、教程或.Net远程处理指南？将感激不尽！

谢谢（对不起，简短的帖子！）

编辑：我现在知道： http: [//www.codeproject.com/KB/XML/remotingsimpleeng.aspx](http://www.codeproject.com/KB/XML/remotingsimpleeng.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T17:16:50.087

没有什么比 Ingo Rammer 关于 Apress 的 .NET Remoting 的书更好的了 [http://www.amazon.com/Advanced-NET-Remoting-Ingo-Rammer/dp/1590590252](https://rads.stackoverflow.com/amzn/click/com/1590590252)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T17:54:30.637

除非您有一些需要 .NET Remoting 的特定要求，否则您可能应该看看[Windows Comminication Foundation (WCF)](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)。WCF 提供了 .NET 远程处理（以及更多）的功能，据我所知，WCF 现在是推荐使用的技术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-12T09:39:28.367

这是我在 .NET Remoting 文章中的书签：http: [//delicious.com/dreikanter/remoting](http://delicious.com/dreikanter/remoting)。最详细的手册是“.NET 中的远程架构”。其他的则包含该技术的不同使用示例。

# arrays - 跨数组搜索和匹配元素

> ID：458381
> 
> 赞同：0
> 
> 时间：2009-01-19T17:15:18.423
> 
> 标签：arrays, compare, scripting-language

我有两张桌子。

在一个表中有两列，一列有 ID，另一列是大约 300-500 字长的文档摘要。大约有 500 行。

另一个表只有一列和 >18000 行。该列的每个单元格都包含一个不同的首字母缩写词，例如 NGF、EPO、TPO 等。

我对一个脚本感兴趣，该脚本将扫描表 1 的每个摘要并识别其中存在的一个或多个首字母缩略词，这些首字母缩略词也存在于表 2 中。

最后，程序将创建一个单独的表，其中第一列包含表 1 的第一列的内容（即 ID）以及在与该 ID 关联的文档中找到的首字母缩略词。

有 Python、Perl 或任何其他脚本语言专业知识的人可以提供帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T17:59:28.643

在我看来，您正在尝试将首字母缩略词出现在摘要中的两个表连接起来。即（伪SQL）：

```
SELECT acronym.id, document.id
FROM acronym, document
WHERE acronym.value IN explode(documents.abstract) 
```

给定所需的语义，您可以使用最直接的方法：

```
acronyms = ['ABC', ...]
documents = [(0, "Document zeros discusses the value of ABC in the context of..."), ...]

joins = []

for id, abstract in documents:
    for word in abstract.split():
        try:
            index = acronyms.index(word)
            joins.append((id, index))
        except ValueError:
            pass # word not an acronym 
```

这是一个简单的实现；然而，它有 n 立方运行时间，因为 acronyms.index 执行线性搜索（我们最大的数组，不少于）。我们可以通过首先构建首字母缩写词的哈希索引来改进算法：

```
acronyms = ['ABC', ...]
documents = [(0, "Document zeros discusses the value of ABC in the context of..."), ...]

index = dict((acronym, idx) for idx, acronym in enumberate(acronyms))    
joins = []

for id, abstract in documents:
    for word in abstract.split():
        try
            joins.append((id, index[word]))
        except KeyError:
            pass # word not an acronym 
```

当然，您可能要考虑使用实际的数据库。这样您就不必手动实现连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T19:22:47.463

非常感谢您的快速回复。我假设伪 SQL 解决方案适用于 MYSQL 等。但是它在 Microsoft ACCESS 中不起作用。

第二个和第三个是我假设的 Python。我可以提供首字母缩写词和文档作为输入文件吗？巴布鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T19:45:04.500

它在 Access 中不起作用，因为表的访问方式不同（例如 acronym.[id]）

# java - CPLEX 错误 1001：内存不足

> ID：458382
> 
> 赞同：1
> 
> 时间：2009-01-19T17:15:20.183
> 
> 标签：java, linux

我试图用 CPLEX 解决 LP。当我构建模型时，它会引发异常“CPLEX 错误 1001：内存不足”。请注意，我在建模时遇到此错误，而不是在优化时。优化期间内存不足的情况有谷歌搜索结果。

非常感谢您的帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T06:30:36.087

这里几乎没有可用的信息......小型 LP 是否会出现问题？你要建立多大的 LP？你看过这个[ILOG 论坛帖子](http://forums.ilog.com/optimization/index.php?action=printpage;topic=556.0)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T09:43:25.510

非常感谢您的回复。问题暂时解决了。

我在具有 8G 内存（免费 3G）的服务器上运行优化器，模型很大。我们一直在将最小堆大小 ( `java -Xms1G`) 设置为 1G 的情况下启动 JRE。我相信这会导致 JRE 在服务器内存中保留大量空间；没有为 CPLEX 进程留下空间。

在使用不同的 CPLEX 参数进行多次试验和错误实验（都失败了！）之后，我们尝试启动优化器`java -Xms512M -Xmx750M`并且它工作了！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-21T23:03:59.267

调用您创建的对象的结束方法，例如 csvreader、iterator、cplex、环境。这将释放内存并解决此问题。

# html - 环绕图像（或任何元素）的文本

> ID：458384
> 
> 赞同：3
> 
> 时间：2009-01-19T17:15:59.280
> 
> 标签：html, css, word-wrap

CSS有没有办法在元素的两侧包装文本*（*例如图像）。我正在尝试将图像定位在段落的中间，并希望文本流过它。请参阅图像以获取示例。 ![http://i42.tinypic.com/14mvp69.jpg](https://i.stack.imgur.com/GKVrR.jpg)

定位元素通常会将其从文档流中移除；所以这是行不通的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T17:30:17.457

我不这么认为，不。并非没有使用多个文本列。

我只是拼凑了一种可能的解决方案。您可以在[http://www.sampsonresume.com/labs/img-in-middle/访问它](http://www.sampsonresume.com/labs/img-in-middle/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:46:11.213

我看到的唯一与此类似的内容是 A List Apart 文章：[Cross-Column Pull-Out Part 2：Custom Silhouettes](http://www.alistapart.com/articles/crosscolumn2)。您仍然需要多个文本列，甚至 ALA 将其列为“实验性”。不过，这可能值得一试。

[这里的例子](http://www.alistapart.com/d/crosscolumn2/example0.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T17:35:10.457

并非没有一些非常棘手/乏味的文本解析。但是，如果你让他们每行两次在图像上来回跳跃，任何试图阅读该文本的人都会讨厌你，所以这可能是一件好事。

# php - 以纯文本形式生成 XML 结果，希望在 PHP 中循环遍历它们

> ID：458386
> 
> 赞同：1
> 
> 时间：2009-01-19T17:16:51.210
> 
> 标签：php, xml

所以我正在使用一个以 XML 格式返回结果的 API。我们只是说为了争论，我返回以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<Properties>
    <Property>
        <Name>Joes Crab Shack</Name>
        <Address>111 Shack Street</Address>
    </Property>
    <Property>
        <Name>Johns Shoe Store</Name>
        <Address>123 Shoe Avenue</Address>
    </Property>
</Properties> 
```

现在我正在使用 PHP，并将结果放入一个变量中。所以本质上会发生这种情况：

```
$xml_results = '<?xml version="1.0" encoding="UTF-8"?><Properties><Property><Name>Joes Crab Shack</Name><Address>111 Shack Street</Address></Property><Property><Name>Johns Shoe Store</Name><Address>123 Shoe Avenue</Address></Property></Properties>'; 
```

现在如何将其视为 XML 文档，例如循环遍历它并打印出所有属性名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T17:47:05.223

这样的事情应该可以完成工作。

```
$request_xml = '<?xml version="1.0" encoding="UTF-8"?>
<Properties>
    <Property>
        <Name>Joes Crab Shack</Name>
        <Address>111 Shack Street</Address>
    </Property>
    <Property>
        <Name>Johns Shoe Store</Name>
        <Address>123 Shoe Avenue</Address>
    </Property>
</Properties>';

$xml = simplexml_load_string($request_xml);

$i = 0;
while ($xml->Property[$i])
{   
    echo $xml->Property[$i]->Name;
    echo $xml->Property[$i]->Address;

    $i++;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T17:21:16.100

反序列化为 xml 树，尝试[SimpleXML](http://www.php.net/simplexml)。这样，您可以以更方便的方式访问该数据并获取特定的 xml 元素。

# c# - 如果被绑定的实例未在 Silverlight 2 中实现 INotifyPropertyChanged，您如何使用双向绑定？

> ID：458399
> 
> 赞同：1
> 
> 时间：2009-01-19T17:20:54.620
> 
> 标签：c#, wcf, data-binding, silverlight-2.0

我正在尝试在 Silverlight 2 中编写一个相当简单的用户控件，它允许用户搜索现有地址、可选地更新所选地址并添加新地址。

为此，我整理了一个简单的 WCF 服务，允许进行简单的查询，我目前正在将其连接到一个文本框、列表框组合（很快将被 Silverlight 工具包中的 AutoCompleteBox 替换）。

我的问题更多的是理解，我的服务的返回类型是 IList<Address> 类型并且 Address 没有实现 INotifyPropertyChanged 并且它似乎不适合从服务返回的对象（也可能被其他客户端调用）加入 SL2 特定功能。促进双向绑定以编辑现有地址的最佳方法是什么。

基本思想如下：

1.  用户在文本框中输入信息
2.  调用服务以检索匹配地址 IList<Address>，该地址在我的服务的 Reference.cs 中作为 ObservableCollection<Address> 返回
3.  返回值设置为列表框的 ItemSource
4.  用户选择正确的地址并表示需要更新
5.  绑定到包含多个文本框的控件容器的地址实例

本质上，我希望绑定文本框中的任何更改都自动反映在 Address 实例中，但是没有 INotifyPropertyChanged 这将如何工作？我是否必须在我的 SL2 应用程序中创建另一个类来有效地覆盖我的服务数据对象的属性实现？

那里的任何人都可以为我指出正确的方向，因为这对我来说没有意义......

干杯，

史蒂夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T17:36:36.430

您如何生成 WCF 代理？我在 VS2008 的一个 SL2 项目中使用了“添加服务引用...”，并且我生成的代理确实实现`INotifyPropertyChanged`了（即使服务器端类型没有实现）。

对于常规 WCF（不是 SL2），`svcutil`有一个`/enableDataBinding`开关可以完成所有这些操作。如果您使用的是 IDE，可能会有一个复选框。

因为这些代理是从元数据生成的，它们完全独立于服务器端代码，所以 SL2 版本实现`INotifyPropertyChanged`.

# css - 位置的文本阴影：静态

> ID：458413
> 
> 赞同：0
> 
> 时间：2009-01-19T17:24:17.890
> 
> 标签：css, shadow

有没有什么方法可以通过一些不错的跨浏览器支持来为 Position static 做文本阴影？

CSS3 text-shadow 最终是我所追求的，但当然只有主流浏览器中的 Safari/Opera/（尚未发布的 FF3.1）支持它。

我见过的所有 javascript/css 技术都会强制文本进入位置：绝对，这不适用于我的中间段落阴影。

有没有我没见过的，或者还有其他我应该探索的选择吗？强制在查看器上下载字体？啊。:(

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T17:36:32.467

简而言之，不，坚持优雅降级的前提——至少对于段落文本。如果浏览器本身不能处理它，那么它就不会得到样式，并会​​以默认方式显示。您必须向您的客户或该网站的任何人解释它不会影响人们是否可以阅读文本并吸收该网站的信息 - 它纯粹是装饰性的。

IMO 这是您可以没有的东西之一：http: [//forabeautifulweb.com/blog/about/five_css_design_browser_differences_i_can_live_with/](http://forabeautifulweb.com/blog/about/five_css_design_browser_differences_i_can_live_with/)

如果您仍然必须这样做，请考虑在段落中使用图像替换：[http ://www.mezzoblue.com/tests/revised-image-replacement/](http://www.mezzoblue.com/tests/revised-image-replacement/)

# linux - Apache w/mod_rails 分段错误

> ID：458418
> 
> 赞同：0
> 
> 时间：2009-01-19T17:26:50.833
> 
> 标签：linux, apache2, redmine, mod-rails, centos5

我在 Apache 2 上使用 mod_rails (passenger) 2.0.3 和 Enterprise Ruby 1.8.6 运行 Redmine。当我尝试登录时，每隔一段时间我就会收到来自 Apache 的段错误。有人知道我如何调试这个问题吗？我在 Apache 的 error.log 中看到了类似的内容：

[Mon Jan 19 17:09:48 2009] [notice] child pid 8714 exit signal Segmentation fault (11)

之后我可以让应用程序工作的唯一方法是重新启动整个系统（仅重新启动 Apache 没有帮助）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:49:59.570

第一步是：

1.  找出核心文件留在系统上的位置（必要时启用核心转储）。

2.  `file(1)`在生成的核心文件上运行。这可能会说“...由 httpd 生成”，但也需要检查一下。

3.  启动`gdb`(2) 中的可执行文件名称和 (1) 中的核心文件，然后开始挖掘。命令`where`（或`bt`）是一个很好的起点：这将在进程转储核心时为您提供堆栈跟踪。

听起来你没有大量的 C 编码经验，祝你好运！追查这种错误可能是一条真正的狗。您可以尝试在此处发布 (3) 中的堆栈跟踪，但在等待答案时不要屏住呼吸。充其量，失败的函数名称可能是提供给 Google 的一个很好的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-06T15:07:28.503

我遇到了与段错误（11）类似的问题。[在 ServerFault 上](https://serverfault.com/questions/351651/modrails-for-apache2-setup-failing-to-load)找到以下问题，该问题提供了升级作为解决方案。

正在运行旧版本的 Ubuntu 并遇到了段错误问题。A`do-release-upgrade`将我的系统带到了 Ubuntu 11.10，问题神奇地消失了。

# networking - 您从协作编辑器的使用中得到什么好处吗？

> ID：458435
> 
> 赞同：1
> 
> 时间：2009-01-19T17:33:15.297
> 
> 标签：networking, editor, collaboration

今天我正在为 Mac OS X 寻找一个免费的协作代码编辑器，我并不真正需要它，但我发现这个想法非常迷人。所以我想知道你对此的看法：现实世界中是否有人在使用协作代码编辑器并从中获得一些好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T22:37:01.330

通过聊天/VoIP 讨论代码时，我们在 Internet 上使用它。伴随着一些东西：

答：“如果我们将其更改为整数，则函数会变得更简单”（编辑）

B：“很好，但我们也必须在这里改变它”（编辑）

一种： ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T00:09:55.043

如果你是结对编程，它非常有用。该方法可以讨论，每个人都有想法时可以开车。我不能说我有幸在工作中使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:34:55.330

我发现在工作时与我的妻子一起整理打包/待办事项/等清单时非常有用。我们使用谷歌文档，虽然不是很实时，但绝对比整天来回发送电子邮件要好。

# python - 使用python将文件夹添加到zip文件

> ID：458436
> 
> 赞同：55
> 
> 时间：2009-01-19T17:33:17.840
> 
> 标签：python, file, zip, directory, zipfile

我想创建一个 zip 文件。将一个文件夹添加到 zip 文件中，然后将一堆文件添加到该文件夹​​中。

所以我想最终得到一个 zip 文件，其中包含一个包含文件的文件夹。

我不知道在 zip 文件中包含文件夹或其他东西是否是不好的做法，但谷歌没有给我任何关于这个主题的信息。

我从这个开始：

```
def addFolderToZip(myZipFile,folder):
    folder = folder.encode('ascii') #convert path to ascii for ZipFile Method
    for file in glob.glob(folder+"/*"):
            if os.path.isfile(file):
                print file
                myZipFile.write(file, os.path.basename(file), zipfile.ZIP_DEFLATED)
            elif os.path.isdir(file):
                addFolderToZip(myZipFile,file)

def createZipFile(filename,files,folders):
    curTime=strftime("__%Y_%m_%d", time.localtime())
    filename=filename+curTime;
    print filename
    zipFilename=utils.getFileName("files", filename+".zip")
    myZipFile = zipfile.ZipFile( zipFilename, "w" ) # Open the zip file for writing 
    for file in files:
        file = file.encode('ascii') #convert path to ascii for ZipFile Method
        if os.path.isfile(file):
            (filepath, filename) = os.path.split(file)
            myZipFile.write( file, filename, zipfile.ZIP_DEFLATED )

    for folder in  folders:   
        addFolderToZip(myZipFile,folder)  
    myZipFile.close()
    return (1,zipFilename)

(success,filename)=createZipFile(planName,files,folders); 
```

取自： http: [//mail.python.org/pipermail/python-list/2006-August/396166.html](http://mail.python.org/pipermail/python-list/2006-August/396166.html)

它摆脱了所有文件夹并将目标文件夹（及其子文件夹）中的所有文件放入单个 zip 文件中。我无法让它添加整个文件夹。

如果我将路径输入到 myZipFile.write 中的文件夹，我会得到

> IOError：[Errno 13] 权限被拒绝：'..\packed\bin'

非常欢迎任何帮助。

相关问题：[如何使用 python（2.5 版）压缩文件夹的内容？](https://stackoverflow.com/questions/296499/how-do-i-zip-the-contents-of-a-folder-using-python-version-2-5)

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2011-06-28T19:05:19.627

你也可以使用shutil

```
import shutil

zip_name = 'path\to\zip_file'
directory_name = 'path\to\directory'

# Create 'path\to\zip_file.zip'
shutil.make_archive(zip_name, 'zip', directory_name) 
```

这会将整个文件夹放入 zip 中。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-01-19T22:21:46.883

好的，在我理解了你想要什么之后，它就像使用 的第二个参数一样简单`zipfile.write`，你可以使用任何你想要的东西：

```
import zipfile
myZipFile = zipfile.ZipFile("zip.zip", "w" )
myZipFile.write("test.py", "dir\\test.py", zipfile.ZIP_DEFLATED ) 
```

创建一个 zipfile，`test.py`将其提取到一个名为`dir`

编辑：我曾经不得不在 zip 文件中创建一个空目录：这是可能的。在上面的代码只是从 zipfile 中删除文件 test.py 之后，文件消失了，但空目录仍然存在。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-19T21:34:13.453

zip 文件没有目录结构，它只有一堆路径名及其内容。这些路径名应该相对于一个虚构的根文件夹（ZIP 文件本身）。“../”前缀在 zip 文件中没有定义的含义。

假设您有一个文件，`a`并且希望将其存储在 zip 文件内的“文件夹”中。将文件存储在 zipfile 中时，您所要做的就是在文件名前加上文件夹名称：

```
zipi= zipfile.ZipInfo()
zipi.filename= "folder/a" # this is what you want
zipi.date_time= time.localtime(os.path.getmtime("a"))[:6]
zipi.compress_type= zipfile.ZIP_DEFLATED
filedata= open("a", "rb").read()

zipfile1.writestr(zipi, filedata) # zipfile1 is a zipfile.ZipFile instance 
```

我不知道任何允许在 ZIP 文件中包含*空*文件夹的 ZIP 实现。我可以想到一种解决方法（在 zip“文件夹”中存储一个*虚拟*文件名，在提取时应该忽略它），但不能跨实现移植。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-22T07:03:11.440

```
import zipfile
import os

class ZipUtilities:

    def toZip(self, file, filename):
        zip_file = zipfile.ZipFile(filename, 'w')
        if os.path.isfile(file):
                    zip_file.write(file)
            else:
                    self.addFolderToZip(zip_file, file)
        zip_file.close()

    def addFolderToZip(self, zip_file, folder): 
        for file in os.listdir(folder):
            full_path = os.path.join(folder, file)
            if os.path.isfile(full_path):
                print 'File added: ' + str(full_path)
                zip_file.write(full_path)
            elif os.path.isdir(full_path):
                print 'Entering folder: ' + str(full_path)
                self.addFolderToZip(zip_file, full_path)

def main():
    utilities = ZipUtilities()
    filename = 'TEMP.zip'
    directory = 'TEMP'
    utilities.toZip(directory, filename)

main() 
```

我在跑：

```
python tozip.py 
```

这是日志：

```
havok@fireshield:~$ python tozip.py

File added: TEMP/NARF (7ª copia)
Entering folder: TEMP/TEMP2
File added: TEMP/TEMP2/NERF (otra copia)
File added: TEMP/TEMP2/NERF (copia)
File added: TEMP/TEMP2/NARF
File added: TEMP/TEMP2/NARF (copia)
File added: TEMP/TEMP2/NARF (otra copia)
Entering folder: TEMP/TEMP2/TEMP3
File added: TEMP/TEMP2/TEMP3/DOCUMENTO DEL FINAL
File added: TEMP/TEMP2/TEMP3/DOCUMENTO DEL FINAL (copia)
File added: TEMP/TEMP2/NERF
File added: TEMP/NARF (copia) (otra copia)
File added: TEMP/NARF (copia) (copia)
File added: TEMP/NARF (6ª copia)
File added: TEMP/NERF (copia) (otra copia)
File added: TEMP/NERF (4ª copia)
File added: TEMP/NERF (otra copia)
File added: TEMP/NERF (3ª copia)
File added: TEMP/NERF (6ª copia)
File added: TEMP/NERF (copia)
File added: TEMP/NERF (5ª copia)
File added: TEMP/NARF (8ª copia)
File added: TEMP/NARF (3ª copia)
File added: TEMP/NARF (5ª copia)
File added: TEMP/NERF (copia) (3ª copia)
File added: TEMP/NARF
File added: TEMP/NERF (copia) (copia)
File added: TEMP/NERF (8ª copia)
File added: TEMP/NERF (7ª copia)
File added: TEMP/NARF (copia)
File added: TEMP/NARF (otra copia)
File added: TEMP/NARF (4ª copia)
File added: TEMP/NERF
File added: TEMP/NARF (copia) (3ª copia) 
```

如您所见，它可以工作，存档也可以。这是一个递归函数，可以压缩整个文件夹。唯一的问题是它不会创建一个空文件夹。

干杯。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-27T03:53:45.827

下面是一些用于将整个目录压缩到 zipfile 的代码。

这似乎可以在 Windows 和 linux 上创建 zip 文件。输出文件似乎可以在 Windows（内置压缩文件夹功能、WinZip 和 7-Zip）和 linux 上正确提取。但是，zip 文件中的空目录似乎是一个棘手的问题。下面的解决方案似乎有效，但 linux 上“zipinfo”的输出令人担忧。此外，未为 zip 存档中的空目录正确设置目录权限。这似乎需要一些更深入的研究。

我从[这个速度评论线程](http://www.velocityreviews.com/forums/t318840-add-empty-directory-using-zipfile.html)和[这个 python 邮件列表线程](http://mail.python.org/pipermail/python-list/2006-January/535240.html)中得到了一些信息。

请注意，此功能旨在将文件放入没有父目录或只有一个父目录的 zip 存档中，因此它将修剪文件系统路径中的任何前导目录，而不是将它们包含在 zip 存档路径中。当您只想获取一个目录并将其制作成可以在不同位置提取的 zip 文件时，通常会出现这种情况。

关键字参数：

dirPath -- 要归档的目录的字符串路径。这是唯一需要的参数。它可以是绝对的或相对的，但只有一个或零个前导目录将包含在 zip 存档中。

zipFilePath -- 输出 zip 文件的字符串路径。这可以是绝对路径或相对路径。如果 zip 文件已经存在，它将被更新。如果没有，它将被创建。如果您想从头开始替换它，请在调用此函数之前将其删除。（默认计算为 dirPath + ".zip"）

includeDirInZip -- 布尔值，指示是否应将顶级目录包含在存档中或省略。（默认为真）

（请注意，StackOverflow 似乎无法使用三引号字符串漂亮地打印我的 python，所以我只是将我的文档字符串转换为此处的帖子文本）

```
#!/usr/bin/python
import os
import zipfile

def zipdir(dirPath=None, zipFilePath=None, includeDirInZip=True):

    if not zipFilePath:
        zipFilePath = dirPath + ".zip"
    if not os.path.isdir(dirPath):
        raise OSError("dirPath argument must point to a directory. "
            "'%s' does not." % dirPath)
    parentDir, dirToZip = os.path.split(dirPath)
    #Little nested function to prepare the proper archive path
    def trimPath(path):
        archivePath = path.replace(parentDir, "", 1)
        if parentDir:
            archivePath = archivePath.replace(os.path.sep, "", 1)
        if not includeDirInZip:
            archivePath = archivePath.replace(dirToZip + os.path.sep, "", 1)
        return os.path.normcase(archivePath)

    outFile = zipfile.ZipFile(zipFilePath, "w",
        compression=zipfile.ZIP_DEFLATED)
    for (archiveDirPath, dirNames, fileNames) in os.walk(dirPath):
        for fileName in fileNames:
            filePath = os.path.join(archiveDirPath, fileName)
            outFile.write(filePath, trimPath(filePath))
        #Make sure we get empty directories as well
        if not fileNames and not dirNames:
            zipInfo = zipfile.ZipInfo(trimPath(archiveDirPath) + "/")
            #some web sites suggest doing
            #zipInfo.external_attr = 16
            #or
            #zipInfo.external_attr = 48
            #Here to allow for inserting an empty directory.  Still TBD/TODO.
            outFile.writestr(zipInfo, "")
    outFile.close() 
```

这是一些示例用法。请注意，如果您的 dirPath 参数有多个前导目录，则默认情况下仅包含最后一个。传递 includeDirInZip=False 以省略所有前导目录。

```
zipdir("foo") #Just give it a dir and get a .zip file
zipdir("foo", "foo2.zip") #Get a .zip file with a specific file name
zipdir("foo", "foo3nodir.zip", False) #Omit the top level directory
zipdir("../test1/foo", "foo4nopardirs.zip") 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-10-09T17:04:44.070

这是我用来压缩文件夹的功能：

```
import os
import os.path
import zipfile

def zip_dir(dirpath, zippath):
    fzip = zipfile.ZipFile(zippath, 'w', zipfile.ZIP_DEFLATED)
    basedir = os.path.dirname(dirpath) + '/' 
    for root, dirs, files in os.walk(dirpath):
        if os.path.basename(root)[0] == '.':
            continue #skip hidden directories        
        dirname = root.replace(basedir, '')
        for f in files:
            if f[-1] == '~' or (f[0] == '.' and f != '.htaccess'):
                #skip backup files and all hidden files except .htaccess
                continue
            fzip.write(root + '/' + f, dirname + '/' + f)
    fzip.close() 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-18T04:41:39.503

如果您查看使用 Info-ZIP 创建的 zip 文件，您会看到确实列出了目录：

```
$ zip foo.zip -r foo
  adding: foo/ (stored 0%)
  adding: foo/foo.jpg (deflated 84%)
$ less foo.zip
  Archive:  foo.zip
 Length   Method    Size  Cmpr    Date    Time   CRC-32   Name
--------  ------  ------- ---- ---------- ----- --------  ----
       0  Stored        0   0% 2013-08-18 14:32 00000000  foo/
  476320  Defl:N    77941  84% 2013-08-18 14:31 55a52268  foo/foo.jpg
--------          -------  ---                            -------
  476320            77941  84%                            2 files 
```

请注意，目录条目的长度为零并且未压缩。似乎您可以通过按名称编写目录来使用 Python 实现相同的目的，但强制它不使用压缩。

```
if os.path.isdir(name):
    zf.write(name, arcname=arcname, compress_type=zipfile.ZIP_STORED)
else:
    zf.write(name, arcname=arcname, compress_type=zipfile.ZIP_DEFLATED) 
```

确保`arcname`以`/`.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-09-28T12:47:35.117

对我来说最简单的方法是使用[zipfile CLI](https://docs.python.org/3/library/zipfile.html#command-line-interface)（命令行界面）。zipfile CLI 可以将文件或文件夹作为参数，并将它们递归地添加到存档中。

因此，如果您有以下文件层次结构：

```
- file1.txt
- folder1 
   - file2.txt
   - file3.txt 
```

并且您希望将所有内容归档到“result.zip”中，您只需编写：

```
python -m zipfile -c result.zip file1.txt folder 
```

如果你想在 python 代码中使用它并使用导入的 zipfile 模块，你可以通过以下方式调用它的 main 函数：

```
import zipfile
zipfile.main(['-c', 'result.zip', 'file1.md', 'folder']) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-19T17:47:34.503

添加一些导入后，您的代码对我来说运行良好，您如何调用脚本，也许您可​​以告诉我们“..\packed\bin”目录的文件夹结构。

我使用以下参数调用了您的代码：

```
planName='test.zip'
files=['z.py',]
folders=['c:\\temp']
(success,filename)=createZipFile(planName,files,folders) 
```

`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-19T22:26:04.097

这是我运行的编辑代码。它基于上面的代码，取自邮件列表。我添加了导入并制作了一个主要例程。我还消除了对输出文件名的摆弄，以使代码更短。

```
#!/usr/bin/env python

import os, zipfile, glob, sys

def addFolderToZip(myZipFile,folder):
    folder = folder.encode('ascii') #convert path to ascii for ZipFile Method
    for file in glob.glob(folder+"/*"):
            if os.path.isfile(file):
                print file
                myZipFile.write(file, os.path.basename(file), zipfile.ZIP_DEFLATED)
            elif os.path.isdir(file):
                addFolderToZip(myZipFile,file)

def createZipFile(filename,files,folders):
    myZipFile = zipfile.ZipFile( filename, "w" ) # Open the zip file for writing 
    for file in files:
        file = file.encode('ascii') #convert path to ascii for ZipFile Method
        if os.path.isfile(file):
            (filepath, filename) = os.path.split(file)
            myZipFile.write( file, filename, zipfile.ZIP_DEFLATED )

    for folder in  folders:   
        addFolderToZip(myZipFile,folder)  
    myZipFile.close()
    return (1,filename)

if __name__=="__main__":
    #put everything in sys.argv[1] in out.zip, skip files
    print createZipFile("out.zip", [], sys.argv[1]) 
```

在工作中，在我的 Windows 机器上，这段代码运行良好，但没有在 zipfile 中创建任何“文件夹”。至少我记得是这样的。现在在家里，在我的 Linux 机器上，创建的 zip 文件似乎很糟糕：

```
$ unzip -l out.zip 
Archive:  out.zip
  End-of-central-directory signature not found.  Either this file is not
  a zipfile, or it constitutes one disk of a multi-part archive.  In the
  latter case the central directory and zipfile comment will be found on
  the last disk(s) of this archive.
unzip:  cannot find zipfile directory in one of out.zip or
        out.zip.zip, and cannot find out.zip.ZIP, period. 
```

我不知道我是否不小心破坏了代码，我认为它是一样的。跨平台问题？无论哪种方式，它都与我原来的问题无关；获取 zip 文件中的文件夹。只是想发布我实际运行的代码，而不是我基于代码的代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-12-15T10:17:30.763

非常感谢您提供这个有用的功能！我发现它非常有用，因为我也在寻求帮助。但是，也许稍微改变一下它会很有用

```
basedir = os.path.dirname(dirpath) + '/' 
```

将会

```
basedir = os.path.dirname(dirpath + '/') 
```

因为发现如果我想压缩位于 'C:\folder\path\notWanted\to\zip\Example' 的文件夹 'Example'，

我进入了 Windows：

```
dirpath = 'C:\folder\path\notWanted\to\zip\Example'
basedir = 'C:\folder\path\notWanted\to\zip\Example/'
dirname = 'C:\folder\path\notWanted\to\zip\Example\Example\Subfolder_etc' 
```

但我想你的代码应该给

```
dirpath = 'C:\folder\path\notWanted\to\zip\Example'
basedir = 'C:\folder\path\notWanted\to\zip\Example\'
dirname = '\Subfolder_etc' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-17T19:32:24.997

```
import os
import zipfile

zf = zipfile.ZipFile("file.zip", "w")
for file in os.listdir(os.curdir):
    if not file.endswith('.zip') and os.path.isfile(os.curdir+'/'+file):
        print file
        zf.write(file)
    elif os.path.isdir(os.curdir+'/'+file):
        print f
        for f in os.listdir(os.curdir+'/'+file):
            zf.write(file+'\\'+f)
zf.close() 
```

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2009-03-24T08:06:09.293

当你想创建一个空文件夹时，你可以这样做：

```
 storage = api.Storage.open("empty_folder.zip","w")
    res = storage.open_resource("hannu//","w")
    storage.close() 
```

文件夹在 wineextractor 中没有显示，但是当你提取它时它会显示出来。

# user-interface - 强制用户交互的验证码？

> ID：458443
> 
> 赞同：1
> 
> 时间：2009-01-19T17:36:09.783
> 
> 标签：user-interface, captcha

我目前正在开发一个程序，其中有许多“用户应该阅读它，但他会像一只愚蠢的猴子一样点击确定”对话框......所以我正在考虑添加类似验证码的东西以避免点击 -想都没想...

我的想法是：

*   随机更换按钮
*   随机将按钮放置在表单上的某个位置
*   用户必须在他应该阅读的文本中点击一个随机颜色的单词
*   添加验证码
*   添加包含用户消息的验证码

有没有人遇到过这种情况。你会建议做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T17:52:49.640

好吧，你问了我的意见，这是我的，但我不认为这是你想听到的......

用户喜欢他们可以依赖的程序。他们不喜欢事情发生变化，也不喜欢做额外的工作。

随机更改按钮和随机放置按钮在表单上的某个位置只会让他们按下错误的按钮或对您的应用程序感到恼火，因为正如您所说，他们不会阅读文本，如果您考虑一下，我们也不会. 举个例子，想想确定/取消对话框，你总是希望确定按钮在左边，而且大多数时候我按下它而不阅读它。它会发生在您的用户身上。

*   用户必须在他应该阅读的文本中点击一个随机颜色的单词
*   添加验证码
*   添加包含用户消息的验证码

使用这 3 个选项，您将为您的应用程序添加额外的工作，您的用户会因此而诅咒您。想想你每天必须做 10 次的事情，比如说检查你的代码以确保源代码安全。如果您的老板告诉您，从现在开始您必须为您尝试签入的每个文件填写验证码，您会有什么感受？

我认为让使用我们软件的人们的生活更轻松是我们的工作。如果他们必须阅读某种文本而他们不想阅读，那么你绝对没有办法让他们这样做。

你不能让人们正常工作，你所能做的就是为他们提供最好的工具，并希望他们足够专业来完成他们的工作。

所以基本上我想说的是，尽你所能减轻他们的工作。如果这真的比您（或负责人）重要，应该与他们交谈并解释为什么这很重要。

你会对人们如何致力于他们理解的事情感到惊讶。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T17:40:44.703

我建议你不要；而且，除非您知道得更清楚，否则您会模仿受人尊敬的知名且经过良好测试的 UI，例如 <*大型在线零售商*> 或 <*在线银行网站*>。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T17:41:06.717

重新设计您的应用程序，使其不使用消息框。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T15:58:54.113

与用户玩游戏以让他们阅读消息是注定要失败的。用户将把精神资源集中在完成你的游戏上，而不是理解信息。如果您有移动按钮、重新标记、寻宝游戏、验证码或延迟等内容，您的用户可能*不太可能真正理解消息的重要部分。*他们将专注于游戏的说明，而不是真正的问题。错误可能会增加。

用户拒绝阅读消息框是由于用户希望快速完成工作而不是花时间阅读内容，这也是由于消息框在众多应用程序中被过度使用和误用。在消息框中包含愚蠢的游戏只会让用户更加反感，使问题更加复杂。

以下是您可以执行的操作：

规则 1\. 不要使用消息框。它们只应在特殊情况下出现。一个应用程序不应该有“很多”消息框。每次用户使用应用程序时都不需要阅读大量文档。如果您的应用程序的*正常*使用导致消息框，那么您的 UI 是错误的。寻找另一种方式。

*   代替验证消息，在主窗口中清楚地显示发生了什么，并提供一个清晰的方法来撤消它。

*   使用自动更正、图片/屏蔽字段以及禁用而不是错误消息。

*   使用良好的默认值和自动化来避免消息。例如，与其显示一条错误消息说用户由于未连接到服务器而无法上传，而是简单地自动重新连接。

*   沿选项中断命令。而不是询问用户是否要粘贴格式的消息框，而是在菜单中提供两个不同的命令。

*   不要让信息消息自发地弹出告诉用户一切正常（例如，“已保存首选项！”）

*   不要有弹出窗口提供有用的提示或文档。如果您无法使您的 UI 自我记录，请提供教程或气球帮助。

*   不要有唠叨的“升级我”消息。

*   考虑在主窗口中而不是在单独的消息框中提供消息文本（例如，“页面可能看起来不正确，因为 ActiveX 出于安全考虑已关闭。”）。网络冲浪的弹出窗口使用户自动忽略弹出的任何无关内容。

规则 2\. 如果您*必须*使用消息：

*   使文本尽可能简短，以了解关键信息。更多的文字不等于更有帮助。使用“与 [path] 中的 [filemask] 不匹配”。不要使用“非致命错误 307：搜索操作已中止。[Appname] 无法完成对您提供的正则表达式的字符串搜索，因为您提供的文件掩码，即 [filemask]，不会在您指定的目录（即 [path]）中产生任何匹配的文件。请检查您的文件掩码或路径选择，然后在“要搜索的文件”对话框中再次重新输入它或它们。单击此消息框下方的“确定”按钮以返回“要搜索的文件”对话框。当您到达那里取消搜索字符串时，单击“要搜索的文件”对话框上的“取消”按钮。” 如果有些用户需要比简短消息更多的解释，

*   在消息中使用简单的语言，不要使用行话。这包括诸如“对话”、“数据库”和“碳粉”之类的“无辜”词。不要获取原始异常文本并将其抛出错误消息。不要包含任何错误号或转储；记录这些。清除您的应用程序中开发人员留下的任何调试消息框。最好简单地让应用程序在发生致命错误时消失，而不是发布一条充满行话的消息*然后*应用程序消失。

*   用操作的作用标记消息框的按钮，而不是“确定”。至少，用户必须专注于激活按钮才能关闭消息框。如果该按钮被标记为“删除”或“安装”，它应该让他们暂停。您永远不必在消息文本中解释每个按钮的作用。顺便说一句，这种标签是大多数平台上的 GUI 标准。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T20:07:32.473

我的建议，接受它或重新设计您的对话框/界面。不要**在**对话中添加随机性或以其他方式将用户视为白痴，即使您可能认为大多数是:-)。

我最近刚读到 Joel 的一篇关于软件的文章，[为那些生活有更好的事情的人设计](http://www.joelonsoftware.com/uibook/chapters/fog0000000062.html)。它表明大多数人不会阅读**任何内容**并讨论解决该问题的方法，或者至少不会使情况变得更糟。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T17:38:09.203

您可以尝试在启用提交按钮之前等待“假定阅读时间”的计时器。您甚至可以根据字数计算假定的阅读时间。

我认为强迫用户阅读您的文本的微妙方法（例如移动按钮或要求他们阅读验证码）会使他们感觉像愚蠢的猴子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T17:37:55.427

您可以根据用户应该阅读的内容使用选择题。

# html - 为 HTML 表格实现“类似 Excel 的列大小”的最佳方法是什么？

> ID：458450
> 
> 赞同：2
> 
> 时间：2009-01-19T17:37:58.190
> 
> 标签：html, html-table, asp.net-2.0, column-width, column-sizing

我想允许用户使用与 Excel 中相同的方法来调整 HTML 表中的列大小。拖动列和大小之间的空间。

去年我对此进行了一些研究，发现了一些小技巧。大多数都非常糟糕，我没有发现任何真正好的东西。现在，看起来我需要实现这个功能，并且想把它做好，所以在我重新开始之前，我只是想问问其他人是否做过这个，以及他们是如何做到的。

我相信我看过一个 FogBugz 演示视频，他们在其中实现了这一点。所以我知道它可以做得很好。

顺便说一句，我不想​​使用任何开源框架，因为我的客户将来可能会出售这个应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T17:50:49.740

我过去自己构建了一个 html 网格，并且这样做了我最好的建议是：使用别人的。

我过去看过这个 jquery 网格控件，但从来没有尝试过： [http ://www.trirand.com/blog/](http://www.trirand.com/blog/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T21:29:23.917

extjs 框架提供了您需要的功能。我无法判断（我不是律师）他们的许可证是否适合您的客户。但是，您似乎可以从他们那里购买许可证，这样您就不必将客户代码发布为开源代码。这可能就足够了。

我建议您在调查许可证的同时使用 extjs 开发您的应用程序。如果许可适合您的客户，那么您就完成了，并且您可以通过使用稳定且高质量的平台来赢得胜利。如果您不能使许可为您的客户工作，那么您必须移植到其他东西，但至少您已经有了一个高质量的第一个原型可以使用，因此生产产品的工作量会更少。同时你有一个很好的原型，同时改进了界面

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T20:29:49.417

Google Docs 电子表格应用程序可以满足您的需求。这可能值得一看，但他们的代码非常密集。

# javascript - 好的 javascript 参考

> ID：458453
> 
> 赞同：6
> 
> 时间：2009-01-19T17:39:09.420
> 
> 标签：javascript

什么是好的 javascript（书籍或网站），它不仅专注于语法，而且很好地解释了 javascript 在幕后的工作原理？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T17:46:07.597

[Mozilla 开发者中心](https://developer.mozilla.org/en/JavaScript)的JavaScript 资源非常好。他们有[JavaScript 指南](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide)和[参考](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference)。

该指南并不是那么好，但是参考很棒。如果我正在寻找某些东西，我只需使用带有“mdc”（或在模棱两可的情况下为“mdc javascript”）+关键字作为搜索词的 google。

* * *

阅读 ECMA-262 的 3 1/2 页长的第 4.2 和 4.3 节也可能是一个好主意。另外，请考虑阅读第 10 章。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T17:43:05.027

[犀牛书](http://oreilly.com/catalog/9780596101992/?CMP=AFC-ak_book&ATT=JavaScript%3A+The+Definitive+Guide)是您办公桌上的一本好书。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-19T19:30:27.620

如果您不想要一本以解释 JavaScript 语法开头的书，那么：

*   在[YUI 剧院](http://developer.yahoo.com/yui/theater/)观看**Douglas Crockford 的视频讲座**：

    *   [JavaScript 编程语言](http://video.yahoo.com/video/play?vid=111593)，
    *   [高级 JavaScript](http://video.yahoo.com/video/play?vid=111585) ,
    *   [不方便的 API：DOM 理论](http://video.yahoo.com/video/play?vid=111582)。
*   阅读John Resig（jQuery 库的作者）的**[Pro JavaScript Techniques](http://jspro.org/)**。

    *   本书已经假设您非常熟悉 JavaScript 语法，并深入探讨了您在使用 JavaScript 时面临的真正困难和重要的问题。它教你在像 jQuery 这样的 JavaScript 库的底层发生了什么，以及你将如何去实现你自己的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T17:42:04.810

[Eloquent Javascript](http://eloquentjavascript.net/)是一个非常棒的资源，它还包括一个用于测试 javascript 的浏览器内环境。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T17:54:43.037

按优先顺序，

1.  弗拉纳根的权威指南（“犀牛书”，我在上面赞成），然后是
2.  道格拉斯·克罗克福德（Douglas Crockford）撰写或搜索的任何内容。
3.  W3 的东西非常适合他们自己尝试的沙箱。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T17:58:24.637

其他人提出了一些很好的建议（[The Rhino Books](http://oreilly.com/catalog/9780596101992/?CMP=AFC-ak_book&ATT=JavaScript%3A+The+Definitive+Guide)、[Mozilla Developer Center和](https://developer.mozilla.org/en/JavaScript)[W3 Schools](http://www.w3schools.com/JS/default.asp)等参考资料）。一旦你很好地掌握了这门语言，我**强烈**推荐[Douglas Crockford](http://www.crockford.com/)的[JavaScript: The Good Parts](http://oreilly.com/catalog/9780596517748/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T17:42:34.590

我一直发现[w3 学校](http://www.w3schools.com/)网站不仅适用于 javascript，而且适用于 css 和许多其他与 web 相关的网站。将快速语法参考与示例代码和教程完美结合，在需要时提供更多深度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T17:49:49.833

很久以前，我使用[WebMonkey](http://www.webmonkey.com/tutorial/JavaScript_Tutorial_-_Lesson_1)来教育我一些。现在我通常只是在谷歌上搜索细节——其中大部分只是找到我无论如何找到的记忆语法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T14:40:53.987

Crockford 在解释 JS 方面做得很好。查看他网站上的文章和他的新书：

*   [http://www.crockford.com/javascript/](http://www.crockford.com/javascript/)
*   [JavaScript：好的部分](https://rads.stackoverflow.com/amzn/click/com/0596517742)

# c# - XmlDocument 删除编码字符

> ID：458460
> 
> 赞同：1
> 
> 时间：2009-01-19T17:41:45.357
> 
> 标签：c#, xml, encoding

我的 C# 应用程序使用以下代码加载 XML 文档：

```
XmlDocument doc = new XmlDocument();
doc.Load(path); 
```

其中一些文档包含编码字符，例如：

```
<xsl:text>&#10;</xsl:text> 
```

我注意到，当这些文档被加载时，`&#10;`会被丢弃。

我的问题：我怎样才能保存`<xsl:text>&#10;</xsl:text>`？

仅供参考 - 用于这些文档的 XML 声明：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T17:44:58.317

你确定角色被删除了？字符 10 只是一个换行符 - 它不会完全显示在您的调试器窗口中。它也可以被视为空白。您是否尝试过使用 xmldocument 上的空白设置？

* * *

如果您需要保留编码，您只有两个选择：CDATA 部分或作为纯文本而不是 Xml 读取。我怀疑您对进入系统的文档的控制权绝对为 0，因此消除了 CDATA 选项。

纯文本而不是 Xml 也可能令人反感，但它就是你所剩下的。如果您需要进行验证或其他处理，您可以首先加载并验证 xml，然后使用简单文件流作为单独的步骤连接您的文件。再说一遍：不理想，但仅此而已。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:47:40.307

`&#10;`是换行符 - 即空格。XML 解析器会将它作为换行符加载，然后忽略它最初被编码的事实。编码只是将数据序列化为文本格式的一部分——它不是数据本身的一部分。

现在，XML 有时会忽略空格，有时则不会，具体取决于上下文、API 等。正如 Joel 所说，您可能会发现它根本没有丢失 - 或者您可能会发现将它与允许您保留空格的 API 一起使用可以修复问题。不过，当您输出数据时，看到它变成未编码的换行符，*我*一点也不感到惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T17:48:04.987

也许将数据保存在 ![CDATA] 中会更好？

[http://www.w3schools.com/XML/xml_cdata.asp](http://www.w3schools.com/XML/xml_cdata.asp)

# regex - 在巨型文本上查找和替换 url 的最佳方法是什么？

> ID：458464
> 
> 赞同：0
> 
> 时间：2009-01-19T17:43:00.847
> 
> 标签：regex

我有我博客帖子的大量备份。所有帖子都有图像，如：

“ [http://www.mysite.com/nonono-nonono.jpg](http://www.mysite.com/nonono-nonono.jpg) ”

或者

“ [http://www.mysite.com/nonono-nonono.gif](http://www.mysite.com/nonono-nonono.gif) ”

甚至

“ [http://www.mysite.com/nonono.jpg](http://www.mysite.com/nonono.jpg) ”

但是我在同一域上还有其他 URL 链接，例如“ [http://www.mysite.com/category/post.html](http://www.mysite.com/category/post.html) ”，我只想替换图像的 url（幸运的是所有图像都位于网站）。

我需要学习 RegExp 来做到这一点吗？是否有任何强大的工具可以查找和替换这样的文本？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T18:28:28.867

我在 EditPad Pro 上使用 RegExp。我也会为初学者找到一个很好的教程。感谢@CalvinR​​ 的提示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T18:29:04.327

可以使用正则表达式，但我可能会使用[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/documentation.html)编写 Python 脚本：

```
# fix_imgs.py
import sys
from BeautifulSoup import BeautifulSoup
for filename in sys.argv[1:]:
  contents = open(filename).read()
  soup = BeautifulSoup(contents)

  # replacing each img tag
  for img in soup.findAll('img'):
    img.src = img.src.replace("http://www.mysite.com", "http://www.example.com")

  new_contents = str(soup)
  output_filename = "replaced." + filename
  open(output_filename, "w").write(new_contents) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T18:01:38.377

正则表达式当然是一种方法，而且可能是最灵活的。但是，如果您的所有图片网址都以“ [http://www.mysite.com/](http://www.mysite.com/) ”开头并以“.jpg”结尾，那么您可以使用字符串操作函数。例如，如果您有一个名为 s 的字符串变量，您想对其进行测试：

```
const string mysite = "http://www.mysite.com/";
const string jpg = ".jpg";
string newString = string.Empty;
if (s.BeginsWith(mysite))
{
    if (s.EndsWith(jpg))
    {
        string textToReplace = s.SubString(mysite.Length, s.Length - mysite.Length - jpg.Length);
        newString = s.Replace(textToReplace, "whatever you want to replace it with.");
    }
} 
```

这是一种相当蛮力的方法，但它会起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T17:52:01.890

正则表达式将是你最好的选择......也许是这样的（基于[strfriend](http://strfriend.com/)的那个）？

```
^((ht|f)tp(s?)\:\/\/|~/|/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((/?\w+/)+|/?)(\w+\.(jpg|gif|png))? 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T18:08:38.377

`new_image_name_here`用 ' ' 在图像 url 中替换所有文件名：

```
$ perl -pe's~(http://.*?/)[^/]+?\.(jpg|gif)\b~$1new_image_name_here.$2~g' huge_file.html > output.html 
```

`netloc`用 ' ' 中的 'www.othersite.org'替换一部分`http://<netloc>/<image_path>`：

```
$ perl -pe's~(?<=http://)[^/]+(?=/(?:[^/]+/)*[^/]+?\.(?:jpg|gif)\b)~www.othersite.org~g' huge_file.html > output.html 
```

这些正则表达式很简单，因此很容易被愚弄。为您的输入数据使用更具体的正则表达式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T18:20:10.367

老实说，我认为无论如何你都应该学习正则表达式，这是一个很好的工具，尤其是在这种情况下。它们是一个非常强大的字符串操作工具，Perl 也是一种很好的学习语言，同时它使使用 Reg Exps 变得轻而易举。

# javascript - 展开折叠 html 字段 Firefox

> ID：458466
> 
> 赞同：0
> 
> 时间：2009-01-19T17:43:39.003
> 
> 标签：javascript, html, firefox

如何在 Firefox 中展开/折叠 html 字段？我从网上合并了一些 JavaScript 示例，但它们只在 IE 中工作。（我仅限于 HTML 和 JS）

建议表示赞赏。

谢谢。

是的，我想显示/隐藏 div 等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T17:56:49.977

如果您的输入字段具有 ID 属性，您可以根据需要使用 CSS 对其进行样式设置。我建议使用像 jQuery 这样的库，但我也提供了一个没有的示例：

```
 // hiding without jQuery
  document.getElementById('myInput').style.display = 'none'
  // showing without jQuery
  document.getElementById('myInput').style.display = 'block'

  // hiding with jQuery
  $('#myInput').hide()
  // showing with jQuery
  $('#myInput').show() 
```

jQuery：http: [//jquery.com](http://jquery.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T17:56:24.547

您可能想要做的是将元素的 css 属性[显示](http://www.w3schools.com/css/pr_class_display.asp)更改为“无”以隐藏元素并将其更改回“块”或“内联”以再次显示它。它可以用javascript来完成。

如果你想要一个花哨的动画，你可以使用某种[javascript 库](http://en.wikipedia.org/wiki/List_of_JavaScript_libraries#JavaScript)，它提供不同的[效果](http://docs.jquery.com/Effects/)（你可能想查看[toggle](http://docs.jquery.com/Effects/toggle)）或组件（例如[Accordion](http://docs.jquery.com/UI/Accordion)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T17:55:32.537

恐怕我不完全理解你的问题。

首先，'html 字段'是什么意思？您的意思是在表单字段中（文本框、单选控件等？）。如果是这样，您的意思是如何动态调整它们的大小？（“展开/折叠”对我来说是模棱两可的）。

如果您的意思是要显示/隐藏 div 等，那么使用 css 和 javascript 会容易得多。请参阅[此示例](http://www.randomsnippets.com/2008/02/12/how-to-hide-and-show-your-div/)。

# delphi - 如何找出通过打开具有自定义文件扩展名的文件触发的文件的路径？

> ID：458467
> 
> 赞同：7
> 
> 时间：2009-01-19T17:43:42.327
> 
> 标签：delphi, file-extension, file-association, message-passing

如何获取用于打开程序的文件的位置？

示例：如果我创建一个新的扩展名“.xyz”，并告诉 Windows 我想用 myapplication 打开文件类型 .xyz，那么它会启动我的应用程序。太好了，但是我的应用程序如何获得用于启动它的文件的文件路径的句柄？

另外，有没有办法让我的应用程序的一个版本只运行并打开新文件以调用我的应用程序中的方法？例如，如果您使用 torrent 并打开 5 个 .torrent 文件，它们都只会传递给一个应用程序。

附带问题：所有文件扩展名都是 3 个字母长吗？是否有公开使用的列表？如果我创建一个文件扩展名，我不想使用一个已经使用过的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-19T21:03:50.987

创建文件关联时，您指定了 Explorer 应该运行的命令行来激活您的程序。shell 也将文档文件的名称放在命令行上，因此在您的程序中，**检查命令行参数**。你如何做到这一点取决于你的语言和开发环境。在 Delphi 中，使用[`ParamCount`](http://delphibasics.co.uk/RTL.asp?Name=ParamCount)和[`ParamStr`](http://delphibasics.co.uk/RTL.asp?Name=ParamStr)函数。

创建文件关联时，您可以在命令行上准确指定文档文件名的位置。在命令行的某处使用`%1`，shell 将用文件名替换它。由于 Windows 文件名经常包含空格，因此您应该在文件名周围加上引号，因此文件关联中的命令行如下所示：

```
ArthurApp.exe "%1"

```

通过该关联，双击另一个文档文件将启动程序的另一个实例。如果您希望在已运行实例的另一个窗口中打开文档，则可以编写代码使程序在启动时查找已运行实例。如果它找到一个，那么它可以与那个实例通信，告诉它要打开什么文件。您可以通过多种方式实现这种通信，包括邮槽、套接字、命名管道、内存映射文件和 DDE。

shell 的文件关联机制已经有一种通过 DDE 进行通信的方式，因此您的程序的第二个实例根本不会启动。相反，shell 将与已经运行的实例开始一个 DDE 对话，并以这种方式告诉它新的文件名。但是，现在 DDE 似乎已失宠，因此请先查看其他一些选项。

对于您的附带问题，不，扩展名并不总是三个字符长。环顾四周，这应该很明显：C 代码放在*.c*文件中，Adobe Illustrator 图形放在*.ai*文件中，新的 Microsoft Word 文档放在*.docx*文件中。

但要小心。如果您要求 **.doc*，结果也将包括*.docx*文件。这是因为`FindFirstFile`同时匹配短文件名和长文件名，并且具有长文件扩展名的长文件名在其短文件名版本中具有三个字符的扩展名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T00:25:56.320

Rob 很好地回答了您的问题。

至于最后一部分，是否有文件扩展名的公共列表 - 不是这样，但有 shell.windows.com，Web 服务资源管理器用来定位未知文件扩展名的处理程序。您可以组成一个扩展，然后查询 shell.windows.com 以查看它是否已注册。例如，要检查扩展程序`.blah`是否已被任何人在 shell.windows.com 上注册，只需在任何浏览器中打开此 URL：

[http://shell.windows.com/fileassoc/0409/xml/redir.asp?ext=blah](http://shell.windows.com/fileassoc/0409/xml/redir.asp?ext=blah)

当然，`blah`用您的扩展名替换尾随。

您可以在[KB929149](http://support.microsoft.com/kb/929149)和 Raymond Chen 的文章[Shell.windows.com 在哪里获取有关文件扩展名的信息以及如何参与该操作？](http://blogs.msdn.com/oldnewthing/archive/2009/01/13/9311703.asp).

# c# - 有没有办法加快 GetAccessControl 和 GetOwner

> ID：458469
> 
> 赞同：0
> 
> 时间：2009-01-19T17:44:20.687
> 
> 标签：c#, performance

我正在浏览很多文件，并且在每个文件上我都需要获取所有者 sid 和所有者 ntaccount。我通过使用 GetAccessControl() 和 GetOwner() 来做到这一点，它们效果很好，一件事是例外。这是令人难以置信的慢，据我所知，它正在使用共享资源，这意味着我无法通过使用更多线程来提高性能。现在，当运行网络共享上的文件时，我每秒可以处理 100 到 200 个文件。这是尽可能快，还是有办法在这一点上提高性能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T17:51:20.080

我对此表示怀疑，因为 GetAccessControl 在后台调用 CodeAccessSecurity.Check()，这是一个静态调用。一个明显的建议是从机器本身而不是通过网络共享运行它，但我不确定你是否能够做到这一点。

# c++ - 将向量复制到 STL 中的列表的最佳方法？

> ID：458476
> 
> 赞同：44
> 
> 时间：2009-01-19T17:46:51.680
> 
> 标签：c++, stl

使用迭代器迭代向量并复制到列表是最佳的复制方法。有什么建议吗？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-01-19T17:49:22.720

为什么要迭代而不使用标准复制算法？

```
std::copy( vector.begin(), vector.end(), std::back_inserter( list ) ); 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-01-19T18:51:16.420

如果您正在创建一个新列表，您可以利用一个带有开始和结束迭代器的构造函数：

```
std::list<SomeType> myList(v.begin(), v.end()); 
```

如果您有要附加到的现有列表，Kasprzol 的答案是完美的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-08-16T03:57:15.150

```
list.assign(vector.begin(), vector.end()); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-24T04:25:23.480

我喜欢这个关于构建新列表的建议。

```
std::list<SomeType> myList(v.begin(), v.end()); 
```

但是当附加到现有列表时，以下可能是小型数据集的最佳选择。所谓“最优”，我的意思是最容易记住如何做和最容易理解。（这些是主观陈述，我相信这取决于你的大脑是如何连接的。）

```
for ( unsigned i=0; i<v.size(); i++ ) myList.push_back(v[i]); 
```

在许多情况下，对向量使用迭代器可能过于迂腐。简单的索引通常可以正常工作。

另一个线程处理迭代器与索引（[此处](https://stackoverflow.com/questions/131241/why-use-iterators-instead-of-array-indices)）。在那个线程中，所采用的答案基本上首选迭代器，因为它们更通用。但如果向量是最常用的容器类型，我认为专门化这种简单的算法是合理的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T17:49:33.330

您可以尝试使用`<algorithm>`标题中更棘手的东西，例如`for_each`或`copy`......但在我看来，它们将构成相同的东西。

# algorithm - Shor 算法可以用于密钥加密吗？

> ID：458481
> 
> 赞同：0
> 
> 时间：2009-01-19T17:47:43.800
> 
> 标签：algorithm, encryption

[Shor 的算法](http://en.wikipedia.org/wiki/Shor%27s_algorithm)可以用于加密，更具体地说是 WEP 加密吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T18:23:30.063

很难理解你在这里的意思。Shor 算法是一种量子算法[，旨在对整数进行](http://www.scottaaronson.com/blog/?p=208)分解。通过对[主要思想](http://en.wikipedia.org/wiki/Quantum_Fourier_transform)的一些调整，您可以使其[打破其他加密系统](http://arxiv.org/abs/quant-ph/0301141)；但是，您打算如何构建加密系统？另一方面，[Quantum-crypto](http://en.wikipedia.org/wiki/Quantum_cryptography)比量子计算有更坚实的基础（即，我们实际上可能会在我们的有生之年看到量子密码系统）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T19:07:44.887

WEP 基于 RC4，它是一种流密码。正如 David 所指出的，Shor 的算法将整数分解。一些加密方法涉及将非常大的数字分解为非常大的素数，但流密码不属于该类。所以 Shor 的算法在攻击 WEP 网络时无济于事。

# authentication - REST 和身份验证变体

> ID：458482
> 
> 赞同：70
> 
> 时间：2009-01-19T17:47:55.237
> 
> 标签：authentication, rest

我目前正在为.net 开发一个 REST 库，我想听听一些关于我拥有的开放点的意见：REST 和身份验证。

这是与库一起使用的 RESTful 接口的示例：

```
[RestRoot("/user")]
public interface IUserInterface
{
  [RestPut("/")]
  void Add(User user);

  [RestGet("/")]
  int[] List();

  [RestGet("/get/{id}")]
  User Get(int id);

  [RestDelete("/delete/{id}")]
  void Delete(int id);
} 
```

然后服务器代码只实现接口，客户端可以通过工厂获得相同的接口。或者，如果客户端不使用该库，则标准 HTTP 请求也可以使用。

我知道有使用 HTTP Basic Auth 或向需要经过身份验证的用户的请求发送令牌的主要方法。

第一种方法（HTTP Basic Auth）存在以下问题（部分特定于 Web 浏览器）：

*   每次请求都会传输密码——即使使用 SSL，这也有某种“不好的感觉”。
*   由于密码是通过请求标头传输的，本地攻击者很容易查看传输的标头以获取密码。
*   密码在浏览器内存中可用。
*   没有使用户“会话”过期的标准方法。
*   使用浏览器登录会中断页面​​的外观。

第二种方法的问题更侧重于实现和库的使用：

*   每个需要身份验证的请求 URI 都必须有一个令牌参数，这只是非常重复。
*   如果每个方法实现都需要检查令牌是否有效，则需要编写更多代码。
*   界面将变得不那么具体，例如`[RestGet("/get/{id}")]`与`[RestGet("/get/{id}/{token}")]`.
*   将令牌放在哪里：在 URI 的末尾？根之后？别的地方？

* * *

我的想法是将令牌作为参数传递给 URL，例如`http:/server/user/get/1234?token=token_id`.

另一种可能性是将参数作为 HTTP 标头发送，但我猜这会使普通 HTTP 客户端的使用变得复杂。

令牌将作为自定义 HTTP 标头（“X-Session-Id”）在每个请求中传递回客户端。

这可以从接口中完全抽象出来，任何需要身份验证的实现都可以只询问令牌（如果给定）属于哪个用户。

您认为这会过多地违反 REST 还是您有更好的想法？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-01-21T20:21:38.903

我倾向于认为身份验证详细信息属于标头，而不是 URI。如果您依赖放置在 URI 上的令牌，那么您的应用程序中的每个 URI 都需要进行编码以包含该令牌。它还会对缓存产生负面影响。具有不断变化的令牌的资源将不再能够被缓存。资源相关信息属于 URI，而不是应用程序相关数据，例如凭据。

看来您必须将 Web 浏览器作为客户端？如果是这样，您可以使用[HTTP Digest 访问身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication "HTTP 摘要访问认证")或向客户端颁发他们自己的 SSL 证书来唯一地识别和验证它们。另外，我认为会话 cookie 不一定是坏事。特别是在必须处理浏览器时。只要您隔离 cookie 处理代码并使应用程序的其余部分不依赖它，您就可以了。关键只是在会话中存储用户的身份，没有别的。不要滥用服务器端会话状态。

如果您的目标客户不是浏览器，那么您可以采取多种方法。我很幸运地使用了 Amazon 的[S3 身份验证](http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/index.html?RESTAuthentication.html "亚马逊 S3 身份验证")机制。

当然，这都是非常主观的。纯度和严格遵循 REST 有时可能是不切实际的。只要您最小化和隔离此类行为，您的应用程序的核心仍然可以是 RESTful。我强烈推荐[RESTful Web 服务](http://oreilly.com/catalog/9780596529260/ "RESTful Web 服务")作为 REST 信息和方法的重要来源。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-21T18:27:01.880

我同意workmad3，如果需要维护会话生命周期，您应该创建一个会话资源。使用用户凭据（基本身份验证或正文内容中的凭据）在该资源上发布将返回唯一的会话 ID。在 /session/{id} 上删除将注销用户。

如果要控制会话到期时间。当创建新会话（在会话资源上发布）时，服务器将在响应上设置一个 cookie（使用标准的 set-cookie 标头）。cookie 将包含到期时间。cookie 字符串应该在服务器上加密，因此只有服务器可以打开该 cookie。对服务器的每个后续请求都将在 cookie 标头中发送会话 cookie。（如果您的客户端是浏览器，它将自动为您完成）。服务器需要为每个请求“更新”cookie，即创建具有新到期时间的新cookie（延长会话超时）。当用户对会话资源调用 delete 时，请记住清除 cookie。

如果您希望您的应用程序更加安全，您可以将客户端 IP 存储在 cookie 本身中，因此当请求到达时，服务器可以验证它是从“原始”客户端发送的。但请记住，当涉及代理时，此解决方案可能会出现问题，因为服务器可能会“看到”所有请求来自同一个客户端。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T18:05:38.087

我见过的其余身份验证将会话视为用于创建、销毁等的 REST 资源，然后来回传递会话 ID。我见过的人倾向于为此使用会话 cookie，因为这是真正保护它的唯一方法。如果您在 URL 中传递会话 ID，则无法真正验证它来自正确的客户端。

但是，身份验证是 REST 的一个棘手问题，因为它需要将某种形式的状态保留在 URL 之外，这违反了 REST 原则，即 URL 是表示状态所需的全部内容。

# c# - Unity InjectionConstructor 属性是什么？

> ID：458483
> 
> 赞同：16
> 
> 时间：2009-01-19T17:48:03.050
> 
> 标签：c#, .net, unity-container

什么是 Unity InjectionConstructor 属性以及它是如何工作的？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-19T18:35:32.410

基本上，这告诉 Unity 使用属性指定的构造函数。请[阅读这篇文章](https://web.archive.org/web/20101121101709/http://codebetter.com/blogs/david.hayden/archive/2008/10/27/specifying-injection-constructor-using-unity-fluent-interface-for-loose-coupling-and-poco.aspx)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-08T16:29:43.803

此属性用于指示当容器尝试构建类型时选择哪个构造函数。

```
myclass {

 [InjectionConstructor]
 public myclass(interface1:XYZ, .....){}
} 
```

它以更具声明性的方式执行类似于 InjectionConstructor（而不是属性）的操作。但它缺少一些功能，例如使用命名接口 ex：

```
new InjectionConstructor(new ResolvedParameter<IMyInterface>("implementation # 1")); 
```

# file - 来自远程文件的图标

> ID：458485
> 
> 赞同：0
> 
> 时间：2009-01-19T17:48:33.957
> 
> 标签：file, icons

我已经开始编写一个 FTP 客户端应用程序（为了好玩）。我正在尝试用图标表示远程托管的文件。例如，假设我正在浏览 FTP 服务器 (/) 的根文件夹，并希望显示带有来自该客户端操作系统的图标关联的 Backup.zip 文件。在某些系统上，这可能是 Windows 压缩图标，而在其他操作系统上，这可能是 WinZip 或 WinRAR 图标。

我让客户端使用 SHGetFileInfo() 函数浏览本地文件。这适用于本地文件，但是，此功能需要物理文件才能检索关联的图标。因此，这不适用于远程托管的文件。我发现了一些给定文件扩展名的加载图标示例，这确实是问题所在......将图标与远程文件关联的最佳策略是什么？

1.  每次去注册表并查找图标关联的扩展
2.  使用每个扩展名创建 1 字节文件，并对远程文件使用 SHGetFileInfo() 函数（使用本地 1 字节文件作为远程文件的关联）
3.  其他策略？？？

创建 FTP 客户端的专业软件公司会做什么？

感谢您的时间。

-杰西·豪尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T17:55:47.887

我建议您不要每次都去注册表：如果需要就去，但是如果您已经使用过给定的文件类型，那么请记住/缓存该结果（在您的程序中）并重用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T18:27:27.870

使用上一个 Stack Overflow 问题中关于相同想法的过程，并使用注册表而不是实际文件。

[如何获取 Windows 资源管理器显示的文件类型图标？](https://stackoverflow.com/questions/108005/how-can-i-get-the-filetype-icon-that-windows-explorer-shows#108015)

# java - 如何使用 Java 制作非常大的布尔数组？

> ID：458489
> 
> 赞同：9
> 
> 时间：2009-01-19T17:49:30.443
> 
> 标签：java, boolean

当我尝试使用 Java 制作一个非常大的布尔数组时，例如：

```
 boolean[] isPrime1 = new boolean[600851475144]; 
```

我可能会丢失精度错误？

是不是太大了？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-19T17:57:43.500

要存储 6000*亿位，您需要 75* *GB*的绝对最小地址空间！祝你好运！

更糟糕的是，Java 规范没有指定`boolean`数组将为每个元素使用一位内存——它可以（[并且在某些情况下确实](http://eblog.chrononsystems.com/hidden-evils-of-javas-byte-array-byte)）使用更多。

无论如何，我从[Project Euler #3](https://projecteuler.net/problem=3)中认出了这个数字。如果它需要那么多内存，那你就错了……

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T17:53:18.237

考虑使用[BitSet](http://java.sun.com/j2se/1.4.2/docs/api/java/util/BitSet.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T18:22:24.120

由于您试图以错误的方式解决欧拉问题＃3，因此这里有一个提示：您应该找到一个数字的所有**素**数，而不是低于某个限制的所有素**数。**

顺便说一句：这个特殊的欧拉问题可以使用非常少量的 RAM 来解决。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T17:52:41.060

数组索引是 int，而不是 long，因此您的“数组”太大而无法放入数组中。 ~~java Collection 类之一可能更适合。~~没关系 - Collection.size() 也返回一个 int，所以 Collection 也不能存储超过`Integer.MAX_VALUE`项目。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T17:56:46.433

嗯......那将是大约 70GB 的布尔值。不会工作。没门。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T17:57:34.327

您可以使用封装在一个类中的 long 数组，该类将处理数组上的所有操作。类似于您自己的 BitSet 实现。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-19T17:58:58.303

问题是您使用的是 long 值与数组大小的 int 值。Java 不支持比 int 的最大值更长的数组长度。Java 将您的长度视为 long，因为您指定的大小超过了 int 的最大值但适合 long。因此，它必须将长度转换回 int 以创建数组。从 long -> int 的转换正在产生您看到的警告

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-19T18:00:05.303

为什么不将值存储在文件中，然后寻找文件中的位置并提取正确的值。就像其他人所说的那样，这是 70GB 的数据。在大多数情况下，您甚至无法将其保存在内存中。如果要将其存储到文件中，您甚至可以在使用位运算符存储和检索数据时查看各个位以节省存储空间。

此外，由于素数的数量随着数字的大小而减少，最好将素数本身按顺序存储在文件中，然后对该数字进行二进制搜索以查看它是否是素数之一.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-19T18:07:15.150

你在数组中有什么值？对于这么大的数字，我猜这将是一个稀疏数组，所以最好使用 Map/List 并分配空间并存储一个 1 值的值。或者如果您的大多数值都是 1，则为 0 值。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-05T12:45:13.163

Apache ActiveMQ 有一个名为 BitArrayBin 的数据结构。这用于查明消息是否重复。消息 ID 是生产者 ID 和序列 ID 的组合。每个生产者都有一个 BitArrayBin 来跟踪其序列 ID。一旦找到给定生产者的 BitArrayBin，它就会将序列 ID 设置为 BitArrayBin 的长值。

```
 oldValue = bitArrayBin.setBit(sequenceId, true)
 if (oldVlaue) {
   "message is duplicated"
 } 
```

该方法返回旧值。

如果 y 是长索引，则它用于导出 bin 索引和其中的偏移量。

```
y = bin index * 64 + offset 
```

BitArrayBin 只不过是许多 bin 的持有者，可以在其构建过程中定义大小。每个 bin 包含一个 long 变量来存储位，因此它可以存储多达 64 个布尔值。

位掩码用于设置位，然后获取它的值。

这个类没有太多的文档。你需要通过它的源代码来了解它的内部结构。

![在此处输入图像描述](https://i.stack.imgur.com/r8u0n.png)

# sql-server - 如何在 SQL 中搜索“Property Bag”表？

> ID：458504
> 
> 赞同：1
> 
> 时间：2009-01-19T17:53:03.150
> 
> 标签：sql-server, stored-procedures, union, intersection, entity-attribute-value

我有一个基本的“property bag”表，用于存储有关我的主表“Card”的属性。所以当我想开始做一些高级的卡片搜索时，我可以这样做：

```
SELECT dbo.Card.Id, dbo.Card.Name
  FROM dbo.Card
         INNER JOIN dbo.CardProperty ON dbo.CardProperty.IdCrd = dbo.Card.Id
 WHERE dbo.CardProperty.IdPrp = 3 AND dbo.CardProperty.Value = 'Fiend'
INTERSECT
  SELECT dbo.Card.Id, dbo.Card.Name
  FROM dbo.Card
         INNER JOIN dbo.CardProperty ON dbo.CardProperty.IdCrd = dbo.Card.Id
 WHERE (dbo.CardProperty.IdPrp = 10 AND (dbo.CardProperty.Value = 'Wind' OR dbo.CardProperty.Value = 'Fire')) 
```

我需要做的是将这个想法提取到某种存储过程中，以便理想情况下我可以传入属性/值组合列表并获取搜索结果。

最初这将是一个“严格”搜索，这意味着结果必须匹配查询中的所有元素，但我还希望有一个“松散”查询，以便它匹配查询中的任何结果。

我似乎无法完全理解这一点。我之前的版本是生成一些大量的 SQL 查询来执行，其中包含很多 AND/OR 子句，但我希望这次能做一些更优雅的事情。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T18:08:17.223

在我看来，您在这里有一个[EAV](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)模型。如果您使用的是 sql server 2005 及更高版本，我建议您为此使用 XML 数据类型：

[http://weblogs.sqlteam.com/mladenp/archive/2006/10/14/14032.aspx](http://weblogs.sqlteam.com/mladenp/archive/2006/10/14/14032.aspx)

使用内置的 xml 查询功能使搜索和工作变得更加容易。

如果你不能改变你的模型，那么看看这个：

[http://weblogs.sqlteam.com/davidm/articles/12117.aspx](http://weblogs.sqlteam.com/davidm/articles/12117.aspx)

# java - 如何使用单独的 jar 覆盖类？

> ID：458518
> 
> 赞同：7
> 
> 时间：2009-01-19T17:57:07.870
> 
> 标签：java, class, jar, overriding, aspectj

客户需要预览我们产品的新功能。他们要求将该功能以 jar 文件（如补丁）的形式发送给他们。将新类包含在所述 jar 文件中没有问题。但是，修改了现有类，这是集成新功能所必需的。他们只想添加这个新的 jar 文件，而不必更新我们产品的核心类。所以，问题是：是否可以使用单独的 jar 覆盖已经存在的类？如果是这样，怎么做？

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T18:00:21.903

如果您将新 jar 放在类路径中的位置比原始 jar 更早，它就有*可能起作用。*值得一试，尽管它仍然听起来像是灾难的秘诀——或者至少，如果两个类都以某种方式被加载，那么很难调试问题。

编辑：我本来打算早点写这篇文章，但在火车旅行结束时被打断了......

我会回到客户那里并解释说，虽然他们的要求是可能的，但它可能会导致意想不到的问题。更新 jar 文件是一种更安全的修复方法，风险也更小。“意外问题”和“风险”这两个短语可能会给客户敲响警钟，所以希望他们能让你做正确的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T18:55:22.837

是也不是，这取决于您的环境。

例如，如果您使用 OSGi 并控制您的版本，则只需安装一个带有更高版本的导出包的新包（假设您的版本范围足够宽松）。

如果您使用没有花哨的自定义类加载的普通旧 Java，那么您最好早点将它放在您的类路径中（正如其他人已经提到的那样）。

如果您确实有自定义类加载，您需要确保您的“修补”类需要的所有类，以及整个传递依赖外壳，都可以从加载修补版本的类加载器中看到，这可能意味着您需要运送整个应用程序，最坏的情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T05:28:40.330

所有规定将更新的类放在类路径中替换的类之前的所有答案都是正确的，***前提***是原始 JAR 没有密封或签名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T18:45:18.070

是的，可以通过将它放在类路径中比原始 jar 更早的位置来实现。然而，依赖类路径的顺序并不总能带来幸福。我不确定它是否记录在 Java 语言规范中；如果不是，那么对于不同的 JVM 甚至同一 JVM 的不同版本都会中断。

相反，请考虑引用一个现实的时间框架，将新功能集成到当前的代码库中。这可能不是您正在寻找的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-18T00:37:00.800

对于这种特定情况，可能超出了您的需要，但通常，如果您只想调整或扩充现有类，您也可以将 AspectJ 与[load-time weaving](http://www.eclipse.org/aspectj/doc/next/devguide/ltw.html)一起使用。

# ruby - ruby 是否有“标准”读/写锁实现？

> ID：458522
> 
> 赞同：3
> 
> 时间：2009-01-19T17:57:50.410
> 
> 标签：ruby, multithreading, concurrency, locking

有谁知道读/写锁的现有 ruby​​ 实现 - [http://en.wikipedia.org/wiki/Readers-writer_lock](http://en.wikipedia.org/wiki/Readers-writer_lock)？

最好这将在一个流行的库或其他一些已经被足够多的人使用的实现中，在这一点上它是相当安全的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T18:26:04.940

据我所知，没有一个标准的，但它们并不难写。失败了，[这家伙](http://blog.jonahb.com/?p=10)已经写了一个。看起来不错，他提供了测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-23T14:13:54.757

Jonas 博客中的链接现已损坏，但我已经构建并测试了另一个实现，欢迎任何想要使用它的人：

[https://github.com/alexdowad/showcase/blob/master/ruby-threads/read_write_lock.rb](https://github.com/alexdowad/showcase/blob/master/ruby-threads/read_write_lock.rb)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-16T12:13:42.867

在[`concurrent-ruby`](https://github.com/ruby-concurrency/concurrent-ruby)gem 中，您可以找到[`Concurrent::ReadWriteLock`](https://ruby-concurrency.github.io/concurrent-ruby/Concurrent/ReadWriteLock.html)和[`Concurrent::ReentrantReadWriteLock`](http://ruby-concurrency.github.io/concurrent-ruby/Concurrent/ReentrantReadWriteLock.html)。

```
lock = Concurrent::ReadWriteLock.new
lock.with_read_lock  { data.retrieve }
lock.with_write_lock { data.modify! } 
```

# c++ - 迭代向量和调用函数

> ID：458525
> 
> 赞同：4
> 
> 时间：2009-01-19T17:58:30.283
> 
> 标签：c++, stl, foreach, iteration

我有一个类，它具有另一个类对象的向量作为成员。在这个类的许多函数中，我必须对向量中的所有对象执行相同的操作：

```
class Small
{
  public:
    void foo(); 
    void bar(int x);
    // and many more functions
};

class Big
{
  public:
    void foo()
    {
        for (size_t i = 0; i <  VectorOfSmalls.size(); i++)
            VectorOfSmalls[i]->foo();
    }
    void bar(int x)
    {
        for (size_t i = 0; i <  VectorOfSmalls.size(); i++)
            VectorOfSmalls[i]->bar(x);
    }
    // and many more functions
  private:
    vector<Small*> VectorOfSmalls;
}; 
```

我想简化代码，并找到一种不重复每个函数中的向量的方法。

我考虑过创建一个函数，它接收指向函数的指针，并在向量的每个成员上调用指向的函数。但我不确定在 C++ 中使用指向函数的指针是个好主意。

我也一直在考虑 functors 和[functionoids](http://www.parashift.com/c++-faq-lite/pointers-to-members.html#faq-33.10)，但它会迫使我为每个函数创建一个类，这听起来有点矫枉过正。

另一种可能的解决方案是创建一个接收字符串的函数，并根据字符串调用命令：

```
void Big::call_command(const string & command)
{
    for (size_t i = 0; i <  VectorOfSmalls.size(); i++)
    {
       if (command == "foo")
           VectorOfSmalls[i]->foo();
       else if (command == "bar")
           VectorOfSmalls[i]->bar();
    }
}
void Big::foo()
{
    call_command("foo");
} 
```

但它可能运行缓慢（不需要创建字符串而不仅仅是函数调用），并且如果函数具有不同的签名也会产生问题。

那么你会推荐什么？我应该让一切都和现在一样吗？

编辑：我只能使用 STL 而不能使用 boost（旧编译器）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-19T18:25:03.943

好吧，您可以重写 for 循环以使用迭代器和更多的 STL，如下所示：

```
void foo() {
    std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::mem_fun(&Small::foo));
}

void bar() {
    std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::mem_fun(&Small::bar));
} 
```

除此之外，您可以使用一些宏来避免重新输入很多内容，但我不是这样的超级粉丝。就个人而言，我喜欢多个函数，而不是接受命令字符串的单个函数。因为它为您提供了更多关于如何做出决定的多功能性。

如果您确实使用带参数的单个函数来决定要执行的操作，我将使用这样的枚举和开关，它比字符串和级联 if 更有效。此外，在您的示例中，您有 if 来决定在循环内执行哪个操作。在循环外检查并拥有循环的冗余副本会更有效，因为每次调用只需要决定一次“哪个命令”。（注意：如果命令在编译时已知，则可以将命令设为模板参数，听起来好像是这样）。

```
class Big {
public:
    enum Command {
        DO_FOO,
        DO_BAR
    };

void doit(Command cmd) {
    switch(cmd) {
    case DO_FOO:
        std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::mem_fun(&Small::foo));
        break;
    case DO_BAR:
        std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::mem_fun(&Small::bar));
        break;
    }
}; 
```

此外，正如您所提到的，替换 &Small::whatever，什么是成员函数指针并将其作为参数传递是相当简单的。您甚至可以将其设为模板。

```
class Big {
public:
    template<void (Small::*fn)()>
    void doit() {
        std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::mem_fun(fn));
    }
}; 
```

然后你可以这样做：

```
Big b;
b.doit<&Small::foo>();
b.doit<&Small::bar>(); 
```

关于 this 和常规参数方法的好处是，如果您更改 small 以获得更多例程，则不需要更改 Big！我认为这是首选方法。

如果您希望能够处理单个参数，您还需要添加一个 bind2nd，这是一个完整的示例：

```
#include <algorithm>
#include <functional>
#include <iostream>
#include <vector>

class Small {
public:
    void foo() { std::cout << "foo" << std::endl; }
    void bar(int x) { std::cout << "bar" << std::endl; }
};

class Big {
public:
    template<void (Small::*fn)()>
    void doit() {
        std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::mem_fun(fn));
    }

    template<class T, void (Small::*fn)(T)>
    void doit(T x) {
        std::for_each(VectorOfSmalls.begin(), VectorOfSmalls.end(), std::bind2nd(std::mem_fun(fn), x));
    }
public:
    std::vector<Small *> VectorOfSmalls;
};

int main() {
    Big b;
    b.VectorOfSmalls.push_back(new Small);
    b.VectorOfSmalls.push_back(new Small);

    b.doit<&Small::foo>();
    b.doit<int, &Small::bar>(5);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T18:03:19.637

如果您使用的是 std 库，则应该查看[for_each](http://www.sgi.com/tech/stl/for_each.html)。

你提到在 C++ 中使用函数指针可能不是一个好主意，但是——让你担心的是速度——在担心之前，你必须看看这是否是你所在的性能瓶颈区域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T18:28:37.947

尝试[boost::function](http://www.boost.org/doc/libs/1_37_0/doc/html/function.html)和[boost::bind](http://www.boost.org/doc/libs/1_37_0/libs/bind/bind.html)：

```
void Big::call_command(const boost::function<void (Small*)>& f)
{
    for (size_t i = 0; i <  VectorOfSmalls.size(); i++)
    {
        f(VectorOfSmalls[i]);
    }
}

int main()
{
    Big b;
    b.call_command(boost::bind(&Small::foo, _1));
    b.call_command(boost::bind(&Small::bar, _1, 5));
} 
```

# c# - 在 Java 中使用需要自定义 SOAP 标头的 .NET Web 服务

> ID：458537
> 
> 赞同：1
> 
> 时间：2009-01-19T18:03:16.033
> 
> 标签：c#, java, web-services, soap

所以我需要使用一个使用自定义 SoapHeader 的 Web 服务，如下所述。使用 Java 通过此标头传递正确值的最简单方法是什么。我正在使用 Netbeans。

```
<?xml version="1.0" encoding="utf-8"?\>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Header>
    <CustomSoapHeader xmlns="http://snip">
      <UserName>"string"</UserName>
      <Password>"string"</Password>
    </CustomSoapHeader>
  </soap:Header>
  <soap:Body>
    <SomeWebMethod xmlns="http://snip" />
  </soap:Body>
</soap:Envelope> 
```

编辑：在 Stack Overflow 上显示 XML 的最佳方式是什么？

添加 Web 服务是在 .NET 中实现的并且我无法更改服务器端代码可能会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T18:23:41.420

以下是基本步骤，假设您在客户端执行此操作：

*   在你的服务接口上安装一个 HandlerResolver (service.setHandlerResolver())
*   覆盖 HandlerResolver.getHandlerChain() 以插入您自己的 SOAPHandler 实现
*   实施 SOAPHandler.handleMessage() 以在 SOAP 标头发出之前对其进行修改

您可以通过请求上下文将参数传递给您的处理程序：

```
Map<String, Object> context = ((BindingProvider) port).getRequestContext();
context.put("userName', "foo");
... 
```

在 handleMessage() 中，您可以像这样获得标题：

```
public boolean handleMessage(SOAPMessageContext context) {
    ...

    SOAPMessage msg = context.getMessage();
    msg.getSoapHeader();
    ...

} 
```

希望有帮助。我猜还有一种方法可以用注释来做这些事情。

# visual-studio - Perforce 与 Visual Studio 的集成，无需将项目文件签入到 perforce

> ID：458541
> 
> 赞同：5
> 
> 时间：2009-01-19T18:04:38.837
> 
> 标签：visual-studio, version-control, perforce

我正在研究一个大型源代码库（大约 15K 文件），分解为大约 25 个项目。我想将源代码保留在 perforce 中（并为此评估 perforce），但由于设置的复杂性，我无法将 Visual Studio 项目保留在源代码控制中，我理论上知道这个问题的答案是签入项目，但这是不可行的（我们最终会签入多个 VS 版本的项目，以及每个版本的多个变体，而是自动生成，并且此设置运行良好）。

有没有办法让 VS 在不将项目添加到 perforce 的情况下检查文件以进行编辑，以避免用户不得不去 perforce 客户端并手动检查每个文件以进行编辑？或者（甚至更好）有没有办法让 VS 识别项目中的文件受源代码控制，而不必将项目也添加到源代码控制？

我知道我们也可以采取策略让每个用户提前检查他们可能想要编辑的所有文件，然后在提交更改之前恢复未修改的文件，采用这种方法是否会降低性能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T20:02:21.673

在您的情况下，我建议不要将 Visual Studio 集成用于 Perforce。

您可以将 Perforce 命令添加到工具菜单，或尝试 Google 的 Nifty Perforce：

> [http://code.google.com/p/niftyplugins/](http://code.google.com/p/niftyplugins/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T20:32:55.683

一种选择是使用 Perforce，就好像您与服务器断开连接并稍后协调您的更改，而不是在执行之前告诉 Perforce 您所做的一切。（这大致相当于 CVS 或 Subversion 中的工作流程。）您将同步您的工作副本，开始开发，然后让 Perforce 弄清楚您在它不观看时做了什么。

Perforce 有一个很好的文档描述了这个过程：[Working Disconnected From The Perforce Server](http://kb.perforce.com/UserTasks/WorkingDisconnected)

文档没有提到的一件事是`allwrite`clientspec 属性，它将工作目录中的所有文件标记为可写，而不是仅将您签出的文件标记为可写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T14:25:24.583

For the sake of completeness: There is a new tool for your wish called [P4VS](http://www.perforce.com/product/components/visual-studio-plug-in). I like it better that [P4SCC](http://www.perforce.com/product/components/microsoft-msscc-plug-in) which never worked for me as I wanted.

# sql - SET NOCOUNT 的最佳地点在哪里？

> ID：458548
> 
> 赞同：3
> 
> 时间：2009-01-19T18:05:45.107
> 
> 标签：sql, sql-server, tsql

对于在专用 SQL Server 上运行的大型数据库（数千个存储过程），最好将其包含`SET NOCOUNT ON`在每个存储过程的顶部，还是在服务器级别设置该选项（属性 -> 连接 ->“无计数”复选框）？听起来 DRY 原则（“不要重复自己”）适用，并且该选项应该设置在一个地方。如果 SQL Server 还托管其他数据库，那将反对在服务器级别设置它，因为其他应用程序可能依赖它。最好的地方在哪里`SET NOCOUNT`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T18:20:14.343

将其设置为服务器的默认值（出于历史原因，它将是默认值）。我从一开始就为所有服务器执行此操作。有没有想过为什么它是 SET NOCOUNT ON 而不是 SET COUNT OFF？这是因为早在 Sybase 时代，唯一的 UI 就是 CLI。当查询可能没有结果时显示计数是很自然的，因此没有指示它已完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T18:07:47.130

由于它是专用服务器，因此我将其设置在服务器级别以避免将其添加到每个存储过程中。唯一会出现的问题是，如果您想要一个没有无计数的存储过程。

# c# - 如何在 C++ 应用程序和没有文件的 C# 应用程序之间共享数据？

> ID：458549
> 
> 赞同：3
> 
> 时间：2009-01-19T18:05:53.780
> 
> 标签：c#, c++

我有一个 C++ 应用程序，其中包含需要与 C# 应用程序共享的数据。我目前正在通过文件传输数据，但是随着数据的速度和数量成为问题，我想找到一种通过内存共享数据的方法。

我充其量是初学者到中级程序员，到目前为止，我听说过两种方法可以帮助我做到这一点：套接字编程和内存映射文件

所以我的问题是，这是最好的方法吗？（是的，速度是一个因素）

非常感谢任何可以帮助我研究和理解您建议的方法的信息或信息链接。

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T18:09:18.297

您可以使用[命名管道](http://www.codeproject.com/KB/threads/dotnetnamedpipespart1.aspx)进行进程间通信。不过，我还没有在 c++ 领域使用过它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T18:09:22.463

插座，海事组织。它是标准的、快速的（如果您在同一台机器上运行则更是如此）并且非常灵活。内存映射文件我不确定 C# 是否支持它，但我可能是错的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T18:11:59.663

这是一个相当困难的问题，主要是因为没有正确的答案。您绝对可以使用套接字或内存映射文件在两个进程之间进行通信。其他替代方法是 COM 或简单地将 Windows 消息从一个进程发送到另一个进程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T18:09:19.250

[.NET - COM 互操作性](http://www.google.com/search?hl=en&q=.NET+-+COM+interoperability&aq=f&oq=)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T18:22:29.457

嗯。我会建议一种不同的方法。我相信您会发现在托管 C++ 中创建一个（或多个）对象要容易得多。您可以将所有内容保留在您的项目原生 C++ 中，除了这个文件/类，您将使用 /clr 进行编译。

/clr 类将能够与 .net 进行微不足道的互操作，因为它是 .net。然后，您可以向对象添加常规的 C++ 方法，以便在您认为合适的时候将数据输入和输出。通常我会建议跨边界复制数据，这样你就不需要用固定或任何东西来搞砸了。

这需要一点时间来适应，但这种方法非常灵活。

这里有一些比我能说得更好的东西：http: [//blogs.microsoft.co.il/blogs/sasha/archive/2008/02/16/net-to-c-bridge.aspx](http://blogs.microsoft.co.il/blogs/sasha/archive/2008/02/16/net-to-c-bridge.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T18:12:53.063

我可能会建议谷歌搜索进程间通信来做到这一点。每个操作系统都有不同的方法，但您基本上需要从另一个应用程序发出信号（使用信号编码数据和数据类型）。

使用套接字是一个很好的方法，但如果机器的环回地址是 kaput（在玩 ip 东西时很容易通过错误配置完成），那么您的应用程序将无法通信。更严重的是，如果环回地址被破坏并指向攻击者机器，那么您的应用程序会突然将数据发送到恶意源，尽管这对您来说可能是也可能不是问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T18:13:43.000

内存映射文件在 C# 中本机不可用，但您可能可以使用 P/Invoke 执行某些操作。

# python - 将版本嵌入 Python 包的标准方法？

> ID：458550
> 
> 赞同：326
> 
> 时间：2009-01-19T18:05:54.170
> 
> 标签：python, string, package

是否有一种标准方法可以将版本字符串与 Python 包相关联，以便我可以执行以下操作？

```
import foo
print(foo.version) 
```

我想有一些方法可以在没有任何额外硬编码的情况下检索该数据，因为`setup.py`已经指定了次要/主要字符串。我发现的替代解决方案是`import __version__`在我的`foo/__init__.py`，然后`__version__.py`由`setup.py`.

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-01-19T21:13:57.973

不是直接回答您的问题，但您应该考虑将其命名为`__version__`，而不是`version`.

这几乎是一个准标准。标准库中的很多模块都用到了，[很多](http://www.google.com/codesearch?as_q=__version__&btnG=Search+Code&hl=en&as_lang=python&as_license_restrict=i&as_license=&as_package=&as_filename=&as_case=)第三方模块`__version__`也用到了这个，所以是准标准的。

通常，`__version__`是一个字符串，但有时它也是一个浮点数或元组。

编辑：正如 S.Lott 所述（谢谢！），[PEP 8](https://www.python.org/dev/peps/pep-0008/#module-level-dunder-names)明确表示：

> ## 模块级 Dunder 名称
> 
> 模块级别的“dunders”（即带有两个前导和两个下划线的名称），例如，，，等`__all__`应该放在模块文档字符串之后，但在任何导入语句之前，除了来自导入。`__author__``__version__``__future__`

您还应该确保版本号符合[PEP 440](http://www.python.org/dev/peps/pep-0440/)中描述的格式（[PEP 386](http://www.python.org/dev/peps/pep-0386/)是本标准的先前版本）。

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2011-08-15T22:04:35.577

我使用单个`_version.py`文件作为“曾经规范的地方”来存储版本信息：

1.  它提供了一个`__version__`属性。

2.  它提供标准的元数据版本。因此，它将被`pkg_resources`解析包元数据的其他工具（EGG-INFO 和/或 PKG-INFO，PEP 0345）检测到。

3.  在构建你的包时它不会导入你的包（或其他任何东西），这在某些情况下可能会导致问题。（有关这可能导致的问题，请参阅下面的评论。）

4.  版本号写下来的地方只有一个，所以版本号变化的时候也只有一个地方可以改，版本不一致的几率也比较小。

它是这样工作的：存储版本号的“一个规范位置”是一个 .py 文件，名为“_version.py”，它位于 Python 包中，例如`myniftyapp/_version.py`. 这个文件是一个 Python 模块，但是你的 setup.py 没有导入它！（这会破坏功能 3。）相反，您的 setup.py 知道该文件的内容非常简单，例如：

```
__version__ = "3.6.5" 
```

所以你的 setup.py 打开文件并解析它，代码如下：

```
import re
VERSIONFILE="myniftyapp/_version.py"
verstrline = open(VERSIONFILE, "rt").read()
VSRE = r"^__version__ = ['\"]([^'\"]*)['\"]"
mo = re.search(VSRE, verstrline, re.M)
if mo:
    verstr = mo.group(1)
else:
    raise RuntimeError("Unable to find version string in %s." % (VERSIONFILE,)) 
```

然后您的 setup.py 将该字符串作为“版本”参数的值传递给`setup()`，从而满足功能 2。

为了满足功能 1，您可以让您的包（在运行时，而不是在设置时！）导入 _version 文件，`myniftyapp/__init__.py`如下所示：

```
from _version import __version__ 
```

这是我多年来一直使用[的这种技术的一个例子。](https://github.com/tahoe-lafs/zfec/blob/42dededf9d0ddbb165cdfccbd5acdf6e0600cb4b/setup.py#L91)

该示例中的代码稍微复杂一些，但我在此注释中编写的简化示例应该是一个完整的实现。

这是[导入版本的示例代码](https://tahoe-lafs.org/trac/zfec/browser/trunk/zfec/zfec/__init__.py?rev=363)。

如果您发现这种方法有任何问题，请告诉我。

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2013-04-18T13:50:57.040

## 重写 2017-05

在编写 Python 代码和管理各种包 13 年多之后，我得出的结论是 DIY 可能不是最好的方法。

我开始使用这个`pbr`包来处理我的包中的版本控制。如果您使用 git 作为您的 SCM，这将像魔术一样适合您的工作流程，节省您数周的工作（您会惊讶于问题的复杂程度）。

截至今天，[pbr 每月有 1200 万次下载](https://pypistats.org/packages/pbr)，达到这个水平并不包括任何肮脏的伎俩。这只是一件事——以一种非常简单的方式解决常见的包装问题。

`pbr`可以承担更多的包维护负担，并且不限于版本控制，但它不会强迫您采用它的所有好处。

因此，为了让您了解在一次提交中采用 pbr 的情况，请查看[将包装切换到 pbr](https://github.com/pycontribs/tendo/commit/2e9cadbc2a69a63108c33d5c39e4a3c3ea429e10)

您可能会观察到版本根本没有存储在存储库中。PBR 确实从 Git 分支和标签中检测到它。

无需担心当您没有 git 存储库时会发生什么，因为 pbr 会在您打包或安装应用程序时“编译”并缓存版本，因此对 git 没有运行时依赖。

## 旧解决方案

这是迄今为止我见过的最好的解决方案，它也解释了原因：

内部`yourpackage/version.py`：

```
# Store the version here so:
# 1) we don't load dependencies by storing it in __init__.py
# 2) we can import it in setup.py for the same reason
# 3) we can import it into your module module
__version__ = '0.12' 
```

内部`yourpackage/__init__.py`：

```
from .version import __version__ 
```

内部`setup.py`：

```
exec(open('yourpackage/version.py').read())
setup(
    ...
    version=__version__,
    ... 
```

如果您知道另一种似乎更好的方法，请告诉我。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2013-04-11T15:16:03.027

根据延迟的[PEP 396（模块版本号）](https://www.python.org/dev/peps/pep-0396/)，有一个建议的方法来做到这一点。它以基本原理描述了模块要遵循的（当然是可选的）标准。这是一个片段：

> 3) 当模块（或包）包含版本号时，该版本应该在`__version__`属性中可用。
> 
> 4) 对于存在于命名空间包中的模块，模块应该包含该`__version__`属性。命名空间包本身不应该包含它自己的`__version__`属性。
> 
> 5)`__version__`属性的值应该是一个字符串。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2009-07-15T14:29:04.647

尽管这可能为时已晚，但有一个比先前答案更简单的替代方案：

```
__version_info__ = ('1', '2', '3')
__version__ = '.'.join(__version_info__) 
```

（使用 . 将版本号的自动递增部分转换为字符串相当简单`str()`。）

当然，据我所见，人们在使用 时倾向于使用前面提到的版本`__version_info__`，因此将其存储为整数元组；但是，我不太明白这样做的意义，因为我怀疑在某些情况下您会出于好奇或自动递增之外的任何目的对部分版本号执行数学运算，例如加法和减法（即使那样，`int()`并且`str()`可以相当容易地使用）。（另一方面，其他人的代码可能期望数字元组而不是字符串元组，从而失败。）

当然，这是我自己的观点，我很乐意听取其他人关于使用数字元组的意见。

* * *

正如shezi提醒我的那样，数字字符串的（词法）比较不一定与直接数字比较具有相同的结果；为此需要前导零。所以最后，将`__version_info__`（或任何它被称为的）存储为整数值的元组将允许更有效的版本比较。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2017-08-13T02:02:44.057

这里的许多解决方案都忽略了`git`版本标签，这仍然意味着您必须在多个地方跟踪版本（不好）。我的目标是：

*   `git`从repo中的标记派生所有 python 版本引用
*   使用无需输入的单个命令自动执行`git tag`/`push`和步骤。`setup.py upload`

## 这个怎么运作：

1.  通过`make release`命令，可以找到 git repo 中的最后一个标记版本并递增。标签被推回到`origin`.

2.  将`Makefile`版本存储在`src/_version.py`将被读取`setup.py`并包含在发行版中的位置。**不要检查`_version.py`源代码控制！**

3.  `setup.py`命令从 中读取新版本字符串`package.__version__`。

## 细节：

### 生成文件

```
# remove optional 'v' and trailing hash "v1.0-N-HASH" -> "v1.0-N"
git_describe_ver = $(shell git describe --tags | sed -E -e 's/^v//' -e 's/(.*)-.*/\1/')
git_tag_ver      = $(shell git describe --abbrev=0)
next_patch_ver = $(shell python versionbump.py --patch $(call git_tag_ver))
next_minor_ver = $(shell python versionbump.py --minor $(call git_tag_ver))
next_major_ver = $(shell python versionbump.py --major $(call git_tag_ver))

.PHONY: ${MODULE}/_version.py
${MODULE}/_version.py:
    echo '__version__ = "$(call git_describe_ver)"' > $@

.PHONY: release
release: test lint mypy
    git tag -a $(call next_patch_ver)
    $(MAKE) ${MODULE}/_version.py
    python setup.py check sdist upload # (legacy "upload" method)
    # twine upload dist/*  (preferred method)
    git push origin master --tags 
```

`release`目标总是增加第 3 个版本的数字，但您可以使用or`next_minor_ver`来`next_major_ver`增加其他数字。这些命令依赖于`versionbump.py`检查到 repo 根目录的脚本

### 版本凹凸.py

```
"""An auto-increment tool for version strings."""

import sys
import unittest

import click
from click.testing import CliRunner  # type: ignore

__version__ = '0.1'

MIN_DIGITS = 2
MAX_DIGITS = 3

@click.command()
@click.argument('version')
@click.option('--major', 'bump_idx', flag_value=0, help='Increment major number.')
@click.option('--minor', 'bump_idx', flag_value=1, help='Increment minor number.')
@click.option('--patch', 'bump_idx', flag_value=2, default=True, help='Increment patch number.')
def cli(version: str, bump_idx: int) -> None:
    """Bumps a MAJOR.MINOR.PATCH version string at the specified index location or 'patch' digit. An
    optional 'v' prefix is allowed and will be included in the output if found."""
    prefix = version[0] if version[0].isalpha() else ''
    digits = version.lower().lstrip('v').split('.')

    if len(digits) > MAX_DIGITS:
        click.secho('ERROR: Too many digits', fg='red', err=True)
        sys.exit(1)

    digits = (digits + ['0'] * MAX_DIGITS)[:MAX_DIGITS]  # Extend total digits to max.
    digits[bump_idx] = str(int(digits[bump_idx]) + 1)  # Increment the desired digit.

    # Zero rightmost digits after bump position.
    for i in range(bump_idx + 1, MAX_DIGITS):
        digits[i] = '0'
    digits = digits[:max(MIN_DIGITS, bump_idx + 1)]  # Trim rightmost digits.
    click.echo(prefix + '.'.join(digits), nl=False)

if __name__ == '__main__':
    cli()  # pylint: disable=no-value-for-parameter 
```

这完成了如何处理和增加版本号的繁重工作`git`。

### __init__.py

文件被`my_module/_version.py`导入到`my_module/__init__.py`. 将您希望与模块一起分发的任何静态安装配置放在这里。

```
from ._version import __version__
__author__ = ''
__email__ = '' 
```

### 安装程序.py

最后一步是从`my_module`模块中读取版本信息。

```
from setuptools import setup, find_packages

pkg_vars  = {}

with open("{MODULE}/_version.py") as fp:
    exec(fp.read(), pkg_vars)

setup(
    version=pkg_vars['__version__'],
    ...
    ...
) 
```

当然，要使所有这些工作，您必须在您的存储库中至少有一个版本标签才能启动。

```
git tag -a v0.0.1 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2014-01-25T21:15:36.397

我在包目录中使用 JSON 文件。这符合 Zooko 的要求。

内部`pkg_dir/pkg_info.json`：

```
{"version": "0.1.0"} 
```

内部`setup.py`：

```
from distutils.core import setup
import json

with open('pkg_dir/pkg_info.json') as fp:
    _info = json.load(fp)

setup(
    version=_info['version'],
    ...
    ) 
```

内部`pkg_dir/__init__.py`：

```
import json
from os.path import dirname

with open(dirname(__file__) + '/pkg_info.json') as fp:
    _info = json.load(fp)

__version__ = _info['version'] 
```

我还将其他信息放入 中`pkg_info.json`，例如作者。我喜欢使用 JSON，因为我可以自动管理元数据。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-05-22T17:03:10.787

*自从第一次提出这个问题以来*，已经完成了大量针对统一版本控制和支持约定的工作。[Python Packaging User Guide中](https://packaging.python.org/guides/single-sourcing-package-version/)**详细介绍**了可口的选项。另外值得注意的是，[Python 中的版本号方案相对严格，每个 PEP 440](https://www.python.org/dev/peps/pep-0440/)，因此如果您的包将发布到[Cheese Shop](https://wiki.python.org/moin/CheeseShop) ，那么保持一切正常至关重要。

以下是版本控制选项的简短细分：

1.  读取`setup.py`( [setuptools](https://pypi.org/project/setuptools/) ) 中的文件并获取版本。
2.  使用外部构建工具（同时更新`__init__.py`源代码控制），例如[bump2version](https://pypi.org/project/bump2version/)、[changes](https://pypi.org/project/changes/)或[zest.releaser](https://pypi.org/project/zest.releaser/)。
3.  将值设置为`__version__`特定模块中的全局变量。
4.  将值放在一个简单的 VERSION 文本文件中，供 setup.py 和代码读取。
5.  通过`setup.py`发布设置值，并使用[importlib.metadata](https://pypi.org/project/importlib.metadata/)在运行时获取它。（警告，有 pre-3.8 和 post-3.8 版本。）
6.  将值设置为`__version__`in`sample/__init__.py`并导入 sample in `setup.py`。
7.  使用[setuptools_scm](https://pypi.org/project/setuptools-scm/)从源代码控制中提取版本控制，使其成为规范参考，而不是代码。

**请注意**，（7）可能是[最现代的方法](https://semver.org/#spec-item-10)（构建元数据独立于代码，由自动化发布）。另请**注意**，如果 setup 用于包发布，则简单`python3 setup.py --version`将直接报告版本。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-01-21T19:44:24.813

另外值得注意的是，它也是`__version__`一个半标准。在 python 中，`__version_info__`这是一个元组，在简单的情况下，您可以执行以下操作：

```
__version__ = '1.2.3'
__version_info__ = tuple([ int(num) for num in __version__.split('.')]) 
```

...并且您可以`__version__`从文件或其他任何内容中获取字符串。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-19T18:49:58.027

似乎没有将版本字符串嵌入 python 包的标准方法。我见过的大多数软件包都使用您的解决方案的一些变体，即 eitner

1.  嵌入版本`setup.py`并`setup.py`生成一个`version.py`仅包含版本信息的模块（例如），由您的包导入，或者

2.  反过来：将版本信息放在包本身中，然后导入*以*设置版本 `setup.py`

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-10-11T17:32:47.197

我还看到了另一种风格：

```
>>> django.VERSION
(1, 1, 0, 'final', 0) 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2016-10-26T12:59:55.950

[箭头](https://github.com/crsmithdev/arrow/)以一种有趣的方式处理它。

**现在（从[2e5031b 开始](https://github.com/crsmithdev/arrow/commit/2e5031b473bcf10b99b9d7ff8a7e72499c412c07#diff-2eeaed663bd0d25b7e608891384b7298)）**

在`arrow/__init__.py`：

```
__version__ = 'x.y.z' 
```

在`setup.py`：

```
from arrow import __version__

setup(
    name='arrow',
    version=__version__,
    # [...]
) 
```

**前**

在`arrow/__init__.py`：

```
__version__ = 'x.y.z'
VERSION = __version__ 
```

在`setup.py`：

```
def grep(attrname):
    pattern = r"{0}\W*=\W*'([^']+)'".format(attrname)
    strval, = re.findall(pattern, file_text)
    return strval

file_text = read(fpath('arrow/__init__.py'))

setup(
    name='arrow',
    version=grep('__version__'),
    # [...]
) 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2019-10-24T21:41:09.487

# 使用`setuptools`和`pbr`

管理版本没有标准方法，但管理包的标准方法是`setuptools`.

我发现管理版本的最佳解决方案是`setuptools`与`pbr`扩展一起使用。这是我现在管理版本的标准方式。

为简单的项目设置完整打包的项目可能有点过头了，但是如果您需要管理版本，您可能处于正确的级别来设置所有内容。这样做还可以让你的包在[PyPi](https://pypi.org/)上发布，这样每个人都可以下载并使用 Pip。

PBR 将大多数元数据从`setup.py`工具中移出并放入一个`setup.cfg`文件中，该文件随后用作大多数元数据的来源，其中可能包括版本。这允许在需要时使用类似的方式将元数据打包到可执行文件中`pyinstaller`（如果需要，您可能[需要此信息](https://stackoverflow.com/a/58568168/6501141)），并将元数据与其他包管理/设置脚本分开。您可以直接手动更新版本字符串`setup.cfg`，它会`*.egg-info`在构建包发布时被拉入文件夹。然后，您的脚本可以使用各种方法从元数据访问版本（这些过程在下面的部分中进行了概述）。

将 Git 用于 VCS/SCM 时，此设置会更好，因为它会从 Git 中提取大量元数据，这样您的存储库就可以成为某些元数据的主要真实来源，包括版本、作者、更改日志、等等。对于版本，它将根据 repo 中的 git 标签为当前提交创建一个版本字符串。

*   [PyPA - 使用 SetupTools 打包 Python 包 - 教程](https://packaging.python.org/tutorials/packaging-projects/)
*   [PBR 最新构建使用文档](https://docs.openstack.org/pbr/latest/user/using.html)- 如何设置 8 行`setup.py`和`setup.cfg`带有元数据的文件。

由于 PBR 将直接从您的 git 存储库中提取版本、作者、更改日志和其他信息，因此`setup.cfg`可以忽略其中的一些元数据并在为您的包创建分发时自动生成（使用`setup.py`）

* * *

## 实时获取当前版本

`setuptools`将使用以下方法实时获取最新信息`setup.py`：

```
python setup.py --version 
```

这将`setup.cfg`根据所做的最新提交和存储库中存在的标签从文件或 git 存储库中提取最新版本。但是，此命令不会更新发行版中的版本。

* * *

## 更新版本元数据

`setup.py`当您使用（`py setup.py sdist`例如，例如）创建分发时，所有当前信息将被提取并存储在分发中。这实质上是运行`setup.py --version`命令，然后将该版本信息存储到`package.egg-info`存储分发元数据的一组文件中的文件夹中。

> ## 更新版本元数据过程的注意事项：
> 
> 如果您不使用 pbr 从 git 中提取版本数据，那么只需使用新版本信息直接更新您的 setup.cfg（很简单，但请确保这是发布过程的标准部分）。
> 
> 如果您使用的是 git，并且不需要创建源代码或二进制分发版（使用命令`python setup.py sdist`或其中一个`python setup.py bdist_xxx`命令），将 git repo 信息更新到`<mypackage>.egg-info`元数据文件夹的最简单方法就是运行`python setup.py install`命令。这将运行与从 git 存储库中提取元数据相关的所有 PBR 功能，并更新您的本地`.egg-info`文件夹，为您定义的任何入口点安装脚本可执行文件，以及您在运行此命令时可以从输出中看到的其他功能。
> 
> 请注意，该`.egg-info`文件夹通常不会存储在标准 Python`.gitignore`文件（例如来自[Gitignore.IO](https://gitignore.io)）中的 git repo 中，因为它可以从您的源代码生成。如果它被排除在外，请确保您有一个标准的“发布流程”来在发布之前在本地更新元数据，并且您上传到 PyPi.org 或以其他方式分发的任何包都必须包含此数据以具有正确的版本。如果您希望 Git 存储库包含此信息，您可以排除特定文件被忽略（即添加`!*.egg-info/PKG_INFO`到`.gitignore`）

* * *

## 从脚本访问版本

您可以从包本身的 Python 脚本中的当前构建访问元数据。例如，对于版本，到目前为止我发现有几种方法可以做到这一点：

```
## This one is a new built-in as of Python 3.8.0 should become the standard
from importlib.metadata import version

v0 = version("mypackage")
print('v0 {}'.format(v0))

## I don't like this one because the version method is hidden
import pkg_resources  # part of setuptools

v1 = pkg_resources.require("mypackage")[0].version
print('v1 {}'.format(v1))

# Probably best for pre v3.8.0 - the output without .version is just a longer string with
# both the package name, a space, and the version string
import pkg_resources  # part of setuptools

v2 = pkg_resources.get_distribution('mypackage').version
print('v2 {}'.format(v2))

## This one seems to be slower, and with pyinstaller makes the exe a lot bigger
from pbr.version import VersionInfo

v3 = VersionInfo('mypackage').release_string()
print('v3 {}'.format(v3)) 
```

您可以将其中之一直接放在您的`__init__.py`for 包中以提取版本信息，如下所示，类似于其他一些答案：

```
__all__ = (
    '__version__',
    'my_package_name'
)

import pkg_resources  # part of setuptools

__version__ = pkg_resources.get_distribution("mypackage").version 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-03-31T14:04:03.587

经过几个小时试图找到最简单可靠的解决方案，以下是部分：

在包“/mypackage”的文件夹内创建一个 version.py 文件：

```
# Store the version here so:
# 1) we don't load dependencies by storing it in __init__.py
# 2) we can import it in setup.py for the same reason
# 3) we can import it into your module module
__version__ = '1.2.7' 
```

在 setup.py 中：

```
exec(open('mypackage/version.py').read())
setup(
    name='mypackage',
    version=__version__, 
```

在主文件夹**init** .py 中：

```
from .version import __version__ 
```

该`exec()`函数在任何导入之外运行脚本，因为 setup.py 在导入模块之前运行。您仍然只需要在一个地方管理一个文件中的版本号，但不幸的是它不在 setup.py 中。（这是缺点，但没有导入错误是优点）

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-01-19T17:20:01.423

# 带有bump2版本的pbr

此解决方案源自[本文](https://copyninja.info/blog/override-version-pbr.html)

用例 - 通过 PyInstaller 分发的 python GUI 包。需要显示版本信息。

这是项目的结构`packagex`

```
packagex
├── packagex
│   ├── __init__.py
│   ├── main.py
│   └── _version.py
├── packagex.spec
├── LICENSE
├── README.md
├── .bumpversion.cfg
├── requirements.txt
├── setup.cfg
└── setup.py 
```

`setup.py`在哪里

```
# setup.py
import os

import setuptools

about = {}
with open("packagex/_version.py") as f:
    exec(f.read(), about)

os.environ["PBR_VERSION"] = about["__version__"]

setuptools.setup(
    setup_requires=["pbr"],
    pbr=True,
    version=about["__version__"],
) 
```

`packagex/_version.py`只包含

```
__version__ = "0.0.1" 
```

和`packagex/__init__.py`

```
from ._version import __version__ 
```

并且对于`.bumpversion.cfg`

```
[bumpversion]
current_version = 0.0.1
commit = False
tag = False
parse = (?P<major>\d+)\.(?P<minor>\d+)\.(?P<patch>\d+)(\-(?P<release>[a-z]+)(?P<build>\d+))?
serialize = 
    {major}.{minor}.{patch}-{release}{build}
    {major}.{minor}.{patch}

[bumpversion:part:release]
optional_value = prod
first_value = dev
values = 
    dev
    prod

[bumpversion:file:packagex/_version.py] 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-03-12T13:46:54.897

1.  `_version.txt`在同一文件夹中创建一个名为 by的文件，`__init__.py`并将版本写为一行：

```
0.8.2 
```

2.  `_version.txt`从以下文件中读取此信息`__init__.py`：

```
 import os 
    def get_version():
        with open(os.path.join(os.path.abspath(os.path.dirname(__file__)), "_version.txt")) as f:
            return f.read().strip() 
    __version__ = get_version() 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-11-24T09:22:36.403

我更喜欢从安装环境中读取软件包版本。这是我的`src/foo/_version.py`：

```
from pkg_resources import get_distribution                                        

__version__ = get_distribution('osbc').version 
```

确保`foo`始终已安装，这就是为什么`src/`需要一个层来防止`foo`在未安装的情况下导入。

在 中`setup.py`，我使用[setuptools-scm](https://pypi.org/project/setuptools-scm/)自动生成版本。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-21T20:10:27.657

[我在这里](https://smarie.github.io/python-getversion/#package-versioning-best-practices)描述了一个标准和现代的方式，依靠`setuptools_scm`。在过去的几年里，这种模式已经成功地应用于数十个已发布的包，所以我可以热情地推荐它。

请注意，您不需要`getversion`包来实现此模式。恰好`getversion`文档包含此提示。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2018-02-07T13:17:02.187

1.  仅使用`version.py`文件中带有`__version__ = <VERSION>`参数的文件。在`setup.py`文件中导入`__version__`参数并将其值放入`setup.py`文件中，如下所示： `version=__version__`
2.  另一种方法是只使用一个`setup.py`文件`version=<CURRENT_VERSION>`- CURRENT_VERSION 是硬编码的。

由于我们不想每次创建新标签（准备发布新的包版本）时都手动更改文件中的版本，所以我们可以使用以下..

我强烈推荐[bumpversion](https://pypi.python.org/pypi/bumpversion)包。多年来我一直在使用它来提升版本。

如果您还没有文件，请先添加`version=<VERSION>`到您的文件中。`setup.py`

每次更新版本时都应该使用这样的简短脚本：

```
bumpversion (patch|minor|major) - choose only one option
git push
git push --tags 
```

然后为每个 repo 添加一个文件，称为`.bumpversion.cfg`：：

```
[bumpversion]
current_version = <CURRENT_TAG>
commit = True
tag = True
tag_name = {new_version}
[bumpversion:file:<RELATIVE_PATH_TO_SETUP_FILE>] 
```

**笔记：**

*   您可以像其他帖子中建议的那样使用文件`__version__`下的参数，`version.py`并像这样更新bumpversion文件： `[bumpversion:file:<RELATIVE_PATH_TO_VERSION_FILE>]`
*   你**必须** `git commit`或`git reset`你的 repo 中的所有东西，否则你会得到一个脏 repo 错误。
*   确保你的虚拟环境包含了bumpversion的包，没有它就无法工作。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2009-01-19T18:42:23.910

对于它的价值，如果你使用 NumPy distutils，`numpy.distutils.misc_util.Configuration`有一个[`make_svn_version_py()`](http://docs.scipy.org/doc/numpy/reference/distutils.html#numpy.distutils.misc_util.Configuration.make_svn_version_py)方法可以将修订号嵌入到`package.__svn_version__`变量中`version`。

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2017-06-02T10:11:23.350

如果您使用 CVS（或 RCS）并想要一个快速的解决方案，您可以使用：

```
__version__ = "$Revision: 1.1 $"[11:-2]
__version_info__ = tuple([int(s) for s in __version__.split(".")]) 
```

（当然，修订号将由 CVS 代替您。）

这为您提供了一个易于打印的版本和一个版本信息，您可以使用它来检查您正在导入的模块是否至少具有预期的版本：

```
import my_module
assert my_module.__version_info__ >= (1, 1) 
```

# visual-studio-2008 - Visual Studio 2008 可以参考 1.0 程序集吗？

> ID：458551
> 
> 赞同：1
> 
> 时间：2009-01-19T18:06:23.763
> 
> 标签：visual-studio-2008, pia, .net-1.0

我有一个似乎针对.NET 1.0 框架的旧程序集（Office XP PIA）。该程序集已注册并在 GAC（以及 Win32 注册表）中可见，但当我选择“添加引用”时它不会出现在 Visual Studio 2008 中。

Visual Studio 是否支持引用旧程序集？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T18:15:09.550

是的，我相信是的。但是，您必须手动浏览程序集。

以下链接，[PIA 部署和安装期间的常见陷阱](http://blogs.msdn.com/vsto/archive/2008/05/20/common-pitfalls-during-pia-deployment-and-installation.aspx)，可能会提供您正在寻找的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T22:16:10.343

引用旧程序集将起作用。但是不支持相反的方式。

关于这个主题的一篇有趣的文章：[当 2.0 应用调用 1.1 程序集时会发生什么](http://dotnet.org.za/ahmeds/archive/2006/02/08/49984.aspx)

不要忘记检查.NET 1.0/1.1 和 .NET 2.0 之间的任何[重大更改](http://msdn.microsoft.com/netframework/programming/breakingchanges/runtime/clr.aspx)

# php - 带有 HTML 的 PHP 会话

> ID：458556
> 
> 赞同：6
> 
> 时间：2009-01-19T18:07:29.657
> 
> 标签：php, html, session

我有一个使用 PHP 和 HTML 页面的网站，我想创建一个会话来存储登录页面中的用户名。但是登录页面是php，下一页是html。

这是一个问题还是我可以在 html 页面中添加一个 php 的小语句说

```
 <?PHP session_start();
$_session['loginid']=$_post['username'];
?> 
```

还是我做错了？

这是我第一次使用会话，它们让我有点困惑。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T18:28:10.070

如果您有权访问 apache 配置或简单的 .htaccess 文件，则可以告诉 Apache 处理 .html 文件中的 php 代码。您可以通过在站点的文档根目录（可能是 public_html/）上创建一个**.htaccess**文件（记住 .（点）作为该文件名中的第一个字符）并将其放入其中：

```
# Add this to public_html/.htaccess file
AddHandler application/x-httpd-php .html
AddHandler application/x-httpd-php .htm 
```

您应该能够重新加载 html 页面，并且您的 PHP 代码（来自 Michael Matthews 的回答）将运行良好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T18:19:29.523

您正在尝试与 text/html 类型的页面共享 PHP 会话变量。正如您所建议的，您必须将 HTML 页面设置为 PHP 页面才能正常工作，并在某处添加一小段 PHP 以显示用户名。

将您的 HTML 页面更改为 PHP。在页面顶部添加如下内容：

```
<?php
  session_start(); // must be before any output
  $username = $_SESSION['username']; // or whatever you called it
  // check that $username is valid here (safe to display)
?>
html here
Hello <?= $username ?>! 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T18:10:55.423

由于会话由 PHP 处理，因此需要 PHP 来维护状态。您至少`session_start()`需要使用存储在`$_SESSION`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T18:16:07.207

如果不使用服务器的配置文件，就不能将 php 放入 .html 文件中。您应该只将 php 放入 .php 文件中。

如果您有很多 .html 文件，您可以简单地将它们重命名为 .php 文件。把纯html放到`something.php`. 因此，您应该确保所有文件都以 .php 结尾，然后您可以将任何您想要的会话逻辑放入其中。

# c - 当套接字关闭时，UDP套接字上的选择不会结束 - 我做错了什么？

> ID：458558
> 
> 赞同：8
> 
> 时间：2009-01-19T18:07:55.710
> 
> 标签：c, unix, sockets, network-programming

我正在使用 Linux 系统（带有 2.6.20 内核的 Ubuntu 7.04 服务器）。

我有一个程序，它有一个线程（thread1）等待选择一个 UDP 套接字变得可读。我正在使用 select（我的套接字作为单个 readfd 和单个 exceptfd），而不是只调用 recvfrom，因为我想要超时。

从另一个线程，我关闭并关闭了套接字。如果我在 thread1 在 recvfrom 中阻塞时执行此操作，则 recvfrom 将立即终止。如果我在线程 1 在超时的选择中阻塞时执行此操作，则选择不会立即终止，但最终会正确超时。

谁能告诉我为什么一旦套接字关闭，选择就不会退出？那不是例外吗？我可以看到它在哪里不可读（显然），但它已关闭，这似乎是例外。

这是套接字的打开（所有错误处理都被删除以保持简单）：

```
m_sockfd = socket(PF_INET, SOCK_DGRAM, 0);
struct sockaddr_in si_me;
memset((char *) &si_me, 0, sizeof(si_me));
si_me.sin_family = AF_INET;
si_me.sin_port = htons(port);
si_me.sin_addr.s_addr = htonl(INADDR_ANY);
if (bind(m_sockfd, (struct sockaddr *)(&si_me), sizeof(si_me)) < 0)
{
// deal with error
} 
```

这是 thread1 执行的 select 语句：

```
struct timeval to;
to.tv_sec = timeout_ms/1000;// just the seconds portion
to.tv_usec = (timeout_ms%1000)*1000;// just the milliseconds 
                                    // converted to microseconds

// watch our one fd for readability or
// exceptions.
fd_set  readfds, exceptfds;
FD_ZERO(&readfds);
FD_SET(m_sockfd, &readfds);
FD_ZERO(&exceptfds);
FD_SET(m_sockfd, &exceptfds);

int nsel = select(m_sockfd+1, &readfds, NULL, &exceptfds, &to); 
```

更新：显然（如下所述），关闭套接字不是例外情况（从选择的角度来看）。我想我需要知道的是：为什么？而且，这是故意的吗？

我真的很想了解这种选择行为背后的想法，因为它似乎与我的期望背道而驰。因此，我显然需要调整我对 TCP 堆栈如何工作的想法。请给我解释一下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T18:25:18.437

UDP 是一种无连接协议。由于没有连接，所以没有一个可以断开，所以消费者不知道生产者永远不会再发送。

您可以让生产者发送“流结束”消息，并让消费者在收到它时终止。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T19:54:10.570

也许您应该使用其他东西来唤醒选择。也许是管道或类似的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-27T10:15:06.920

您能否不向线程发送信号（例如 USR2），从而导致 select() 返回 EINTR？然后在信号处理程序中设置一个标志告诉它不要重新启动 select()？

这将消除等待多个文件描述符的需要，并且似乎比使用管道杀死它要干净得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T10:34:04.313

我认为最明显的解决方案是关闭不被视为例外情况。我认为问题的根源在于，您并没有真正接受`select`. 你到底为什么要在另一个线程中摆弄套接字，这听起来像是灾难的秘诀。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T19:46:37.433

我想说不同之处在于 recvfrom 正在积极尝试从单个套接字读取消息，其中 select 正在等待消息到达，可能在多个句柄上，而不一定是套接字句柄。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-24T18:51:56.400

您的代码从根本上被破坏了。这个错误的变化很常见，并且在过去导致了严重的错误，具有巨大的安全隐患。这就是你所缺少的：

当您关闭套接字时，您根本无法知道另一个线程是否被阻塞`select`或即将阻塞`select`。例如，考虑以下情况：

1.  线程去 call `select`，但没有被安排。
2.  你关闭套接字。
3.  在线程中，您的代码不知道（可能是平台内部内存管理或日志记录内部结构的一部分）库打开一个套接字并获得与您关闭的套接字相同的标识符。
4.  线程现在进入`select`，但它`select`在库打开的套接字上。
5.  灾难降临。

当另一个线程正在或可能正在使用它时，您不得尝试释放资源。

# .net - unicode 实现：很多字体，还是一种大字体？

> ID：458566
> 
> 赞同：3
> 
> 时间：2009-01-19T18:09:12.197
> 
> 标签：.net, unicode, fonts, selection

我正在将应用程序国际化为多种不同的语言，并且必须支持以下语言：

1.  英语
2.  西班牙语
3.  德语
4.  法语
5.  俄语
6.  普通话
7.  泰国

我们还可能会添加对以下内容的支持：

1.  印地语
2.  葡萄牙语
3.  工作人员会说任何其他语言并且可以轻松翻译

我应该为每种语言安装不同的字体，还是应该使用 Arial Unicode MS 的大量字体安装？如果我做后者，将字体添加到安装程序中是否有任何法律影响？

这个问题在 .NET 3.5 中，但我认为一般问题与（编程）语言无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T18:30:43.027

Arial Unicode MS 不可再发行，它与 Microsoft Office 一起安装：Lucida Sans Unicode 随 Windows 一起提供，并且具有您列表中大多数语言的字符（但我相信不是中文）。

[http://alanwood.net/unicode/fonts.html](http://alanwood.net/unicode/fonts.html)是查看哪些字体包含哪些字符的好资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T18:40:28.343

当您限制自己使用 Windows 和 Internet Explorer 附带的字体时，这不太可能成为真正的问题。用户将安装一个能够以她的本地语言呈现字形的字体版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T21:39:46.423

[GNU Unifont](http://en.wikipedia.org/wiki/GNU_Unifont)是唯一一种涵盖所有（或几乎所有，63,000+）字符的字体。不幸的是，它是位图，因此渲染非常难看。

如果您需要 TrueType 字体，最好使用[WenQuanYi Zen Hei](https://en.wikipedia.org/wiki/WenQuanYi#Zen_Hei)或[Arial Unicode MS 。](http://en.wikipedia.org/wiki/Arial_Unicode_MS)
它们的覆盖范围大致相同（约 35,000 个字符），但 WenQuanYi Zen Hei 是开源的 (GPL) 而 Arial Unicode MS 是专有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T19:11:51.877

我们决定走以下路线：

对于基于拉丁文的字符集，我们将使用[基于 Gentium 的字体](http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&item_id=Gentium)。这些字体包含在[Open Font License](http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=OFL)中，这意味着我们必须在软件中包含版权声明并在 UI 中确认。

当我们转到亚洲语言时，我们可能会向 WenQuanYi Zen Hei 的创建者发送电子邮件（在他的网站上，他声明他可以商业使用，但需要付费），或者[Code2000](http://www.code2000.net/)的创建者。顺便说一句，对于印地语字体，Code2000 看起来非常好，但对于 Latin-1 字体来说就不是很好（有点太宽了，非常印刷而不是基于屏幕）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T14:39:42.847

许多 Windows API 将为知名字体进行字体链接。例如，如果您选择 Tahoma 并尝试使用任何高级函数进行绘制，我相信它会自动进行字体链接。我怀疑几乎所有的 .NET 接口都算作高级函数。

Raymond Chen 展示了如何滚动您[自己的字体链接](http://blogs.msdn.com/oldnewthing/archive/2004/07/16/185261.aspx)。

Michael Kaplan 还做了[一系列关于字体链接](http://www.siao2.com/2005/03/20/399322.aspx)的文章。

# interop - 在 Word 中为 Range 对象（不是 Selection 对象）插入样式分隔符

> ID：458581
> 
> 赞同：0
> 
> 时间：2009-01-19T18:14:52.403
> 
> 标签：interop, automation, ms-word

我们目前正在做一些 Word 自动化，并希望能够将样式分隔符插入到 Range 对象中。我们已经找到了如何使用 Selection 对象 ( `InsertStyleSeparator`) 来做到这一点，但似乎无法弄清楚如何使用 Range 对象来做到这一点。有谁知道如何使它工作？

到目前为止我找到的相关链接：

*   [选择中的样式分隔符](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.selection.insertstyleseparator(VS.80).aspx)
*   [范围成员（不包括上述方法）](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range_members(VS.80).aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T18:24:11.263

VBA 文档说它`InsertStyleSeparator`是对象的成员`Selection`。

这意味着你需要一个`Selection`对象。幸运的是，您可以这样做：

```
SomeRangeObject.Select
Selection.InsertStyleSeparator 
```

# xml - 如何使用 XPath 选择最后 N 个元素？

> ID：458596
> 
> 赞同：13
> 
> 时间：2009-01-19T18:21:02.360
> 
> 标签：xml, xslt, xpath

我支持一个网站，它生成内容 XML，然后使用 XSLT 将其翻译成网页。我被要求创建一个新的样式表，它将“存档”页面的输出转换为 Atom 以进行联合。我遇到的问题是存档页面包含相当多的项目——142 个并且还在增加——并且提要永远不会超过 30 个项目。

目前，存档页面的输出如下所示：

```
<archive>
    <year>
        <month>
            <day>
            <day>
            ...
        </month>

        ...
    </year>

    ...
</archive> 
```

和标签由 HTML 转换使用，但与 Atom 提要完全无关`year`。`month`我曾希望将`position()`函数与后代轴一起使用（`//day[position()>last()-30]`），但这会选择*每个月*的最后 30 天，这根本不是我需要的。:-)

有没有办法用 XSLT 或 XPath 做到这一点？不得不修改 XML 生成器来添加，比如说，`feed="true"`最近 30 天的一个属性似乎是一个非常讨厌的组合。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T18:39:02.700

position()/last() 返回当前上下文中的位置/最后一个位置，因此当导航器定位在一个 <month> 时，position() 将返回该月内的 <day>，last() 将返回 last<day > 在那个月内，但我想你知道这一点。

因此，您可以做的是将数组中的所有 <day> 展平并放入一个变量，然后再像以前一样进行选择。

```
<xsl:variable name="days" select="//day"/>
<xsl:apply-templates select="$days[position()>last()-30]" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T17:50:34.230

今天浏览[XSLT 规范](http://www.w3.org/TR/xpath#path-abbrev)，我发现了一个注释，它解释了为什么`//`会这样：

> `//`是 的缩写`/descendant-or-self::node()/`。例如，`//para`is 的缩写`/descendant-or-self::node()/child::para`，因此将选择`para`文档中的任何元素（即使`para`是文档元素的元素也会被选中，`//para`因为文档元素节点是根节点的子节点）；`div//para`是缩写`div/descendant-or-self::node()/child::para`，因此将选择`para`div 孩子的所有后代。
> 
> **注意：**位置路径与位置路径`//para[1]`的含义不同`/descendant::para[1]`。后者选择第一个后代`para`元素；前者选择作为其父母`para`的第一个孩子的所有后代元素。`para`

换句话说，当使用 时`//`，`position()`是沿轴计算的`child`，而不是沿轴计算的`descendant-or-self`。指定`descendant`or`descendant-or-self`允许您按预期获取第一个/最后*n 个*节点：

```
<xsl:apply-templates select="descendant::day[position()>last()-30]"/> 
```

# sql-server - TSQL“喜欢”或正则表达式？

> ID：458597
> 
> 赞同：3
> 
> 时间：2009-01-19T18:21:54.183
> 
> 标签：sql-server, tsql

我在一个表中有一堆（750K）记录，我必须看到它们在另一个表中。第二个表有数百万条记录，数据是这样的：

源表
`9999-A1B-1234X`，中间部分可能超过三位数

目标表
`DescriptionPhrase9999-A1B-1234X(9 pages)` - 是的，括号和单词在字段中。

目前我正在运行一个加载源记录的 .net 应用程序，然后运行并搜索类似（使用 tsql 函数）以确定是否有任何记录。如果是，则源表更新为正数。如果没有，则单独留下记录。

该应用程序每小时处理大约 1000 条记录。当我在 sql server 上作为游标存储过程执行此操作时，我几乎得到了相同的速度。

如果正则表达式或任何其他方法可以使它更快，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T18:32:20.887

怎么样在数据库中做这一切，而不是把记录拉到你的 .Net 应用程序中：

```
UPDATE source_table s SET some_field = true WHERE EXISTS
(
     SELECT target_join_field FROM target_table t 
     WHERE t.target_join_field LIKE '%' + s.source_join_field + '%'
) 
```

这会将查询总数从 750k 更新查询减少到 1 次更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T18:31:22.620

首先，如果可能的话，我会重新设计。最好添加一个包含正确值并能够加入的列。如果你还需要长的。您可以使用触发器在插入时将数据提取到列中。

如果您有可以匹配的数据，那么您既不需要不能使用索引的 '%somestuff%' ，也不需要游标，这两者都是性能杀手。如果您设计得当，这应该是基于集合的任务。如果设计不好并且无法更改为好的设计，我看不出使用 t-SQl 获得良好性能的好方法，我会尝试正则表达式路线。不知道有多少不同的 prharses 以及每个的结构，我不能说正则表达式路线是否容易甚至可能。但是没有重新设计（我强烈建议你这样做），我看不到另一种可能性。

顺便说一句，如果您正在处理这么大的表，我会下定决心不再编写另一个游标。它们对性能非常不利，尤其是当您开始使用这种大小的记录时。学会在集合中思考，而不是通过记录处理来记录。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T21:52:54.867

使用单个更新（mbeckish 的回答）需要注意的一件事是事务日志（如果查询被取消，则启用回滚）将是巨大的。这将大大减慢您的查询速度。因此，最好以 1,000 行或类似的块的形式处理它们。

此外，条件 (b.field like '%' + a.field + '%') 将需要检查 b (百万) 中的每条记录以检查 a (750,000) 中的每条记录。这相当于超过 7500 亿次字符串比较。不是很好。

直觉“索引的东西”在这里也无济于事。索引使事物井井有条，因此第一个字符决定了索引中的位置，而不是您感兴趣的位置。

**第一个想法**

出于这个原因，我实际上会考虑创建另一个表，并将长/凌乱的值解析成更好的东西。一个例子就是从最后一个“（”开始删除任何文本。（假设所有值都遵循该模式）这会将查询条件简化为（b.field like '%' + a.field）

尽管如此，索引在这里也无济于事，因为重要的字符在最后。因此，奇怪的是，以相反的顺序存储两个表的字符可能是值得的。然后临时表上的索引将被使用。

花这么多时间似乎很浪费，但在这种情况下，一点点好处就会产生很大的回报。（例如，需要几个小时才能将比较从 7500 亿减少到 3750 亿。如果您可以使用索引，则可以将其减少一千倍，这要归功于索引是树搜索，而不仅仅是有序表......）

**第二个想法**

假设您确实将目标表复制到临时表中，您可能会从以 1000 个块为单位处理它们中受益，方法是从目标表中删除匹配的记录。（这只有在您从目标表中删除有意义的数量时才值得。这样，在检查了所有 750,000 条记录之后，目标表现在 [例如] 是它开始时大小的一半。）

编辑：
**修改后的第二个想法**

1.  将整个目标表放入临时表中。

2.  尽可能对值进行预处理，以使字符串比较更快，甚至可以使用索引。

3.  一次循环遍历源表中的每条记录。在循环中使用以下逻辑...

    DELETE 目标 WHERE 字段 LIKE '%' + @source_field + '%' IF (@@row_count = 0) [不匹配]​​ ELSE [匹配]

连续删除使每个循环的查询速度更快，并且您只对数据使用一个查询（而不是一个查找匹配项，第二个删除匹配项）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T18:44:06.120

尝试这个 -

```
update SourceTable  
set ContainsBit = 1  
from SourceTable t1      
  join (select TargetField from dbo.TargetTable t2) t2   
    on charindex(t1.SourceField, t2.TargetField) > 0 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T18:26:31.570

第一件事是确保您在搜索表上有该列的索引。其次是在左侧*不带 % 符号的 LIKE。*检查执行计划以查看您是否没有对每一行进行表扫描。

正如 le dorfier 正确指出的那样，如果您使用的是 UDF，那么希望渺茫。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T18:32:50.357

给猫剥皮的方法有很多——我认为首先要知道这是一次性操作，还是需要定期完成的常规任务。

不知道你问题的所有细节，如果是我，这是一次性的（或不经常的操作，听起来像是），我可能会从两个表中提取相关字段，包括源表中的主键并将它们作为文本文件导出到本地计算机。文件大小可能会比数据库中的完整表小得多。

我会使用用“C”/C++ 或另一种具有原始处理能力的“轻量级”语言编写的例程在快速机器上本地运行它，并写出一个“匹配”的主键表，我会然后加载回 sql server 并将其用作更新查询的基础（即更新源表，其中 id in select id from temp table）。

您可能会花费几个小时来编写例程，但它的运行时间只是您在 sql 中看到的时间的一小部分。

根据您的 sql 声音，您可能正在尝试对数百万条记录表进行 750,000 次表扫描。

告诉我们更多关于这个问题的信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T19:12:26.593

圣烟，多么棒的反应！

系统在断开网络，所以我不能复制粘贴，但这是重新输入

当前UDF：

```
Create function CountInTrim 
(@caseno varchar255)
 returns int
as 
Begin
declare @reccount int
select @reccount = count(recId) from targettable where title like '%' + @caseNo +'%'
return @reccount
end 
```

基本上，如果有记录计数，则存在匹配，.net 应用程序会更新记录。基于游标的存储过程具有相同的逻辑。

此外，这是一个一次性过程，确定遗留记录/案例管理系统中的哪些条目成功迁移到新系统中，所以我无法重新设计任何东西。当然，这两种系统的开发人员都已经没有了，虽然我有一些 sql 经验，但我绝不是专家。

我从旧系统必须制作源表的疯狂方式中解析案例编号，这是与新系统唯一的共同点，即案例编号格式。我可以尝试解析新系统中的案例编号，然后针对这两组运行匹配，但可能会使用一组数据，例如：

```
DescriptionPhrase1999-A1C-12345(5 pages)
Phrase/Two2000-A1C2F-5432S(27 Pages)
DescPhraseThree2002-B2B-2345R(8 pages) 
```

解析变得有点复杂，所以我想我会保持简单。

我将尝试单个更新语句，然后在需要时回退到 clr 中的正则表达式。

我会更新结果。而且，由于我已经处理了一半以上的记录，这应该会有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-21T10:38:00.863

从上面尝试 Dan R 的更新查询：

```
update SourceTable  
set ContainsBit = 1  
from SourceTable t1      
 join (select TargetField 
       from dbo.TargetTable t2) t2   
 on charindex(t1.SourceField, t2.TargetField) > 0 
```

或者，如果及时性很重要并且这是 sql 2005 或更高版本，那么这将是使用带有正则表达式的 SQL CLR 代码的计算列的经典用途 - 不需要独立的应用程序。

# visual-studio - 为什么 vwd.webinfo 总是从源代码管理中自动签出？

> ID：458602
> 
> 赞同：10
> 
> 时间：2009-01-19T18:23:11.343
> 
> 标签：visual-studio, tfs, visual-studio-2008, web-site-project, vcs-checkout

我们有一个 2008 解决方案，其中有一个文件系统网站作为解决方案的一部分。此解决方案受 Team Foundation Server 的源代码控制。每次解决方案关闭时，它要么检查一个名为 vwd.webinfo 的文件，要么尝试检查并抱怨其他人已经检查了它。

从源代码管理中删除文件并不能解决问题，因为由于某种原因它会自动重新添加。

为什么会发生这种情况，我们可以做些什么来消除这个唠叨？

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-11-04T10:17:26.850

1.  打开“源代码控制资源管理器”
2.  在正确的路径中找到 vwd.webinfo
3.  点击“删除”
4.  办理入住手续来解决这个问题

该文件仍将位于您的文件系统和解决方案中，但不受源代码控制。您不会看到“加号”或“v”或“锁定”按钮

![http://i.stack.imgur.com/jAVee.png](https://i.stack.imgur.com/jAVee.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-19T18:59:25.077

转到属性页，选择左侧的构建，然后取消选中“构建网站作为解决方案的一部分”然后您可以删除该文件，它不会自动创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T12:51:37.343

您应该能够手动删除此文件并且不会再次出现。该文件包含一些信息，这些信息过去在早期版本中位于项目的其他位置，但显然不是必需的。在从源代码管理和磁盘上删除文件之前关闭您的解决方案。

# web-services - 使用 VS2008 编写的 Web 服务

> ID：458605
> 
> 赞同：2
> 
> 时间：2009-01-19T18:23:50.607
> 
> 标签：web-services

我在 Visual Studio 2008 中使用 C# 编写了一个 Web 服务（我也在 VS 2005 中编写了它）。我可以编写一个测试窗口窗体应用程序来使用该服务没问题。

我遇到的问题是从 C#/VS2003 （或 php 这是我真正的问题）中使用它。它只是给了我错误：

**“无法将类型 'TestIntel.WebIntel.GetSitesResponseGetSitesResult' 隐式转换为 'System.Data.DataTable”**

Web 方法确实返回了一个 DataTable；正如我所说，如果消费者是在 VS2005/2008 中构建的，这可以正常工作。是什么赋予了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T19:13:14.987

为了使用 DataTable，调用点（php 和 .net 1.1）需要知道如何将其反序列化为可用对象。

这意味着他们必须有一个可以反序列化数据的类似对象。

显然，PHP 做不到。.net 1.1 错误的原因是 DataTable 对象在 1.1 和 2.0 之间发生了相当大的变化。事实上，微软表示 .Net 1.1 数据表对象是 BY DESIGN 不应该通过 Web 服务进行序列化。( [ [http://support.microsoft.com/kb/306134][1]](http://support.microsoft.com/kb/306134][1]) )

如果您正在寻找一种真正的跨语言方式来执行此操作，那么您需要将您的响应序列化为标准 XML 对象。任何语言都可以正确解析。这需要更多的工作，但会产生可用的服务。

# .net - 在 .Net 中阅读和编辑 HTML

> ID：458606
> 
> 赞同：1
> 
> 时间：2009-01-19T18:23:56.037
> 
> 标签：.net, html, dom

除了 System.Windows.Forms.HtmlDocument 之外，是否有用于读取和操作 html 的 .Net 类。

如果没有，是否有任何开源库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-07T14:57:13.900

似乎在 .Net 应用程序中解析 Html 的最佳选择是使用codeplex 上的[Html Agility Pack库。](http://www.codeplex.com/htmlagilitypack)这提供了对 HTML 的完整 DOM 访问，并且使用起来非常简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T18:29:56.867

如果它符合 XHTML，我会做这样的事情：

```
System.Xml.XmlDocument xDoc = new System.Xml.XmlDocument();
xDoc.LoadXml(html); 
```

并以这种方式编辑它。如果需要一些清理（XHtml 转换），您可以使用[HtmlTidy](http://tidy.sourceforge.net/)或[Ntidy](http://sourceforge.net/projects/ntidy/)。此外，您可以使用下面[的 HTMLTidy 包装器](http://www.codeproject.com/KB/cs/ZetaHtmlTidy.aspx)示例：

```
string input = "<p>broken html<br <img src=test></div>";
HtmlTidy tidy = new HtmlTidy()
string output = tidy.CleanHtml(input, HtmlTidyOptions.ConvertToXhtml);
XmlDocument doc = new XmlDocument();
doc.LoadXml(output); 
```

[**StackOverFlow 参考**](https://stackoverflow.com/questions/232004/how-can-i-manipulate-the-dom-from-a-string-of-html-in-c)

上面的 EDIT 将转换为 XHtml

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T18:47:06.847

您可以使用 MSHTML 库。但是，它是 COM/ActiveX，但如果您使用的是 Visual Studio，它将自动为您创建一个托管包装器。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-19T18:55:21.853

您始终可以使用 LiteralControl：

```
PlaceHolder.Controls.Add(new LiteralControl("<div>some html</div>")); 
```

# svn - 如何明确告诉 SVN 将文件视为文本，而不是二进制文件

> ID：458609
> 
> 赞同：44
> 
> 时间：2009-01-19T18:24:23.510
> 
> 标签：svn, file, text, encoding, binary

我有许多文件在没有正确设置它们的 Mime 类型的情况下签入 SVN。SVN 最初将它们分类为二进制。

我已经通过 propset 在 SVN 中将他们的 Mime 类型设置为“text/plain; charset=UTF-8”，并且我确保所有文件都是 UTF-8 签名的。当我执行 'svn blame filename' 时，svn 说该文件是二进制文件并且没有给我明确的责备类型输出。

关于如何说服 SVN 这些是真正的文本文件的任何建议？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-19T19:09:44.260

将 svn:mime-type 属性设置为 "text/plain" 有助于：

```
svn propset svn:mime-type text/plain build.xml
svn commit build.xml 
```

此外，您可以强制 Subversion 在指责时将文件视为文本：

```
svn blame file/to/blame --force 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-30T00:58:09.083

我遇到了同样的问题：我签入了许多 utf8 文件（Linux 的本机编码），其中一些被错误地提取为二进制文件并显示“（bin）”。我没有深入研究错误是如何发生的，但检查了那里有什么......

```
$ svn propget svn:mime-type * 
```

...注意到正确签入的文本文件根本没有 svn:mime 属性，只是从文本文件错误地错误标记的二进制文件中删除了 svn:mime-type 属性。

```
$ svn propdel svn:mime-type [mislabeled-text-file...]
$ svn ci -m "zap binary mime-types" [mislabeled-text-file...] 
```

这似乎没有任何不良影响。警告用户：我不知道 Windows 在这种情况下会如何表现，尽管这很容易测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-28T20:23:34.713

将文件添加到存储库后，您可能还需要在 REPOSITORY 上设置类型。在 propset 命令中使用存储库的 URL 而不是工作副本的路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-24T13:24:31.440

看起来像 mime 类型的操作并不能说服 svn 将文件视为文本。但是如果在第一次提交之前设置了正确的 mime 类型，那么 svn 会正确处理文件。例如，svn 将 eclipse .project 和 .classpath 添加为 application/xml 并将它们视为 bin。但是，如果在第一次提交之前将其更改为 text/xml，它们将被视为文本。

# activex - 如何从 activeX 中获取代理定义

> ID：458610
> 
> 赞同：1
> 
> 时间：2009-01-19T18:24:27.237
> 
> 标签：activex, webproxy

好的，所以这是场景：

我有一个使用 HttpWebRequest 类上传文件的 activeX。我的问题是我必须指定网络凭据才能让 activeX 在代理服务器后面正常工作。

这是代码：

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(m_url);
req.Proxy = new WebProxy("http://myProxyServer:8080");
req.Proxy.Credentials = new NetworkCredential("user", "password", "domain"); 
```

如何在没有（或最少）用户界面的情况下从 iExplorer 获取这些信息？

谢谢你 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T10:46:38.973

我设法做到了；）

```
 private static WebProxy QueryIEProxySettings(string strFileURL)
            {
                HttpWebRequest WebReqt = (HttpWebRequest)HttpWebRequest.Create(strFileURL);

                WebProxy WP = new WebProxy(WebReqt.Proxy.GetProxy(new Uri(strFileURL)));
                WP.Credentials = CredentialCache.DefaultCredentials;

                return WP;
            } 
```

# django - X-Requested-With/HTTP_X_REQUESTED_WITH 奇怪的问题

> ID：458617
> 
> 赞同：3
> 
> 时间：2009-01-19T18:27:56.933
> 
> 标签：django, cherokee

我正在构建一个 Django 站点并尝试使用该`request.is_ajax()`功能......但**它只在*本地***工作，它让我发疯！

我正处于我刚刚转储标题的地步。这里（在 django 测试服务器上）有，`HTTP_X_REQUESTED_WITH`但在生产服务器（cherokee+scgi）上，我得到的只是`X-Requested-With`.

我已经使用 firebug 来窥探*发送*的标头，并且它是`X-Requested-With`（在网站的两个版本上）。我非常*非常*困惑。任何人都可以解释正在发生的事情以及我如何在不失去理智的情况下解决它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T09:39:19.260

wrt/ X-Requested-With => HTTP_X_REQUESTED_WITH 的东西，它符合 CGI 规范。由于 FastCGI、SCGI 和 WSGI 都基于 CGI 规范，Django 开发人员选择坚持这个约定（FWIW，ModPythonRequest 类为了一致性做了同样的重写）。

因此，您的问题似乎是 cherokee/scgi 链中的某些内容没有正确重写标题。您使用的是哪个 scgi 实现？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T20:03:19.237

我目前正在使用一点点 MiddleWare 来解决这个问题，它本质上是在寻找“错误”的标头，如果存在，则附加一个具有相同值的新标头：

```
if 'X-Requested-With' in request.META:
    request.META['HTTP_X_REQUESTED_WITH'] = request.META['X-Requested-With'] 
```

但我真的希望我知道这些标头应该发生什么，因为`X-Requested-With`总是发送......我不明白为什么应该翻译成`HTTP_X_REQUESTED_WITH`以及为什么不翻译。

编辑：原因似乎在实际的 Web 服务器中很深。

```
case 'X':
    if (header_equals ("X-Forwarded-For", header_x_forwarded_for, begin, header_len)) {
        ret = add_known_header (hdr, header_x_forwarded_for, val_offs, val_len);
    } else if (header_equals ("X-Forwarded-Host", header_x_forwarded_host, begin, header_len)) {
        ret = add_known_header (hdr, header_x_forwarded_host, val_offs, val_len);
    } else
        goto unknown;
    break; 
```

我已经提交了一个错误来添加我的标头，但是所有 X-* 标头都应该转换为 HTTP_X_* 标头吗？

# iphone - 我的 iphone 应用程序如何检测自己的版本号？

> ID：458632
> 
> 赞同：255
> 
> 时间：2009-01-19T18:32:22.120
> 
> 标签：iphone, ios, version

我正在编写一个 iPhone 应用程序。它已经发布了，但我想添加一个显示其版本号的功能。

我宁愿不必对我发布的每个版本手动执行此操作...

Objective-C 中有没有办法找出我的应用程序的版本？

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2009-01-19T19:00:33.997

[正如我在这里所描述的](https://stackoverflow.com/questions/372218/insert-subversion-revision-number-in-xcode#414792)，我使用一个脚本来用我当前的 Subversion 修订号重写一个头文件。该修订号存储在 kRevisionNumber 常量中。然后，我可以使用类似于以下内容的方式访问版本和修订号：

```
[NSString stringWithFormat:@"Version %@ (%@)", [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"], kRevisionNumber] 
```

这将创建一个格式为“Version 1.0 (51)”的字符串。

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2012-08-15T04:13:36.880

基于 Brad Larson 的回答，如果您在 info plist 中存储了主要和次要版本信息（就像我在特定项目中所做的那样），这对我来说效果很好：

```
- (NSString *)appNameAndVersionNumberDisplayString {
    NSDictionary *infoDictionary = [[NSBundle mainBundle] infoDictionary];
    NSString *appDisplayName = [infoDictionary objectForKey:@"CFBundleDisplayName"];
    NSString *majorVersion = [infoDictionary objectForKey:@"CFBundleShortVersionString"];
    NSString *minorVersion = [infoDictionary objectForKey:@"CFBundleVersion"];

    return [NSString stringWithFormat:@"%@, Version %@ (%@)", 
                appDisplayName, majorVersion, minorVersion];
} 
```

现在手动更新次要版本可能会很痛苦，因此使用源存储库修订号技巧是理想的。如果您没有将其绑定（因为我没有），那么上面的代码片段可能很有用。它还会提取应用程序的显示名称。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2015-03-19T12:42:50.190

两者分别的 Swift 版本：

*斯威夫特 3*

```
let versionNumber = Bundle.main.object(forInfoDictionaryKey: "CFBundleShortVersionString") as! String
let buildNumber = Bundle.main.object(forInfoDictionaryKey: "CFBundleVersion") as! String 
```

* * *

*斯威夫特 2*

```
let versionNumber = NSBundle.mainBundle().objectForInfoDictionaryKey("CFBundleShortVersionString") as! String
let buildNumber = NSBundle.mainBundle().objectForInfoDictionaryKey("CFBundleVersion") as! String 
```

它包含在此回购中，请查看：

[https://github.com/goktugyil/EZSwiftExtensions](https://github.com/goktugyil/EZSwiftExtensions)

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2013-11-02T20:01:42.223

这就是我在我的应用程序中所做的

```
NSString *appVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"]; 
```

希望这个简单的答案可以帮助某人...

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2009-01-19T18:46:55.727

您可以`CFBundleShortVersionString`在 plist.info 中指定字符串并使用[提供的 API](http://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFBundles/AccessingaBundlesContents/AccessingaBundlesContents.html#//apple_ref/doc/uid/10000123i-CH104-123785)以编程方式读取该字符串。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2015-01-23T09:01:46.660

有两件事-构建版本和应用程序版本。

1.  获取应用版本：

    ```
    NSString *appVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleShortVersionString"]; 
    ```

2.  获取构建版本：

    ```
    NSString *buildVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleVersion"]; 
    ```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2014-07-23T18:15:02.673

```
// Syncs with App Store and Xcode Project Settings Input
NSString *appVersion = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleShortVersionString"]; 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2013-09-07T02:58:06.490

获取*XYZ*格式的版本字符串的简洁方法是：

```
[NSBundle mainBundle].infoDictionary[@"CFBundleVersion"] 
```

或者，仅针对*XY：*

```
[NSBundle mainBundle].infoDictionary[@"CFBundleShortVersionString"] 
```

这两个片段都返回您将分配给标签对象的文本属性的字符串，例如

```
myLabel.text = [NSBundle mainBundle].infoDictionary[@"CFBundleVersion"]; 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-05-15T09:58:30.530

您可以尝试将字典用作：-

```
NSDictionary *infoDictionary = [[NSBundle mainBundle]infoDictionary];

NSString *buildVersion = infoDictionary[(NSString*)kCFBundleVersionKey];
NSString *bundleName = infoDictionary[(NSString *)kCFBundleNameKey] 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-12-16T03:58:36.237

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-22T05:05:34.463

读取应用程序的 info.plist 文件并获取键 CFBundleShortVersionString 的值。阅读 info.plist 会给你一个 NSDictionary 对象

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-07-31T12:31:45.470

您可以使用 infoDictionary 从您的应用程序的 info.plist 获取版本详细信息。此代码适用于 swift 3。只需调用此方法并在任何首选 UI 元素中显示版本。

```
Swift-3  

func getVersion() -> String {
    let dictionary = Bundle.main.infoDictionary!
    let version = dictionary["CFBundleShortVersionString"] as! String
    let build = dictionary["CFBundleVersion"] as! String
    return "v\(version).\(build)"
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-12-21T09:35:48.727

如果您需要同时使用**version****和*build* num ，这里有一个使用****Swift 3**的捷径：

```
let appVersion = Bundle.main.infoDictionary!["CFBundleShortVersionString"]!
let buildNum = Bundle.main.infoDictionary!["CFBundleVersion"]!
let versionInfo = "\(appVersion) (build \(buildNum))"
// versionInfo is now something like "2.3.0 (build 17)" 
```

在or行`as! String`的末尾添加一个以仅获取该部分作为对象。如果您正在寻找完整的.`appVersion``buildNum``String``versionInfo`

我希望这有帮助！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-04-10T10:42:46.737

```
func getAppVersion() -> String {
    let dictionary = Bundle.main.infoDictionary!
    let versionValue = dictionary["CFBundleShortVersionString"] ?? "0"
    let buildValue = dictionary["CFBundleVersion"] ?? "0"
    return "\(versionValue) (build \(buildValue))"
} 
```

基于@rajat chauhan 的回答，无需强制转换为`String`.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-19T18:46:09.940

使用修订控制系统处理这是一件好事。这样，当您从用户那里收到错误报告时，您可以检查该代码的修订版并（希望）重现运行与用户完全相同的代码的错误。

这个想法是，每次构建时，您将运行一个脚本，该脚本获取代码的当前修订号并更新项目中的文件（通常使用某种形式的令牌替换）。然后，您可以编写一个错误处理例程，该例程始终在错误输出中包含修订号，或者您可以将其显示在“关于”页面上。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-10-24T18:15:56.617

你可以试试这个方法：

```
NSString *version = [[[NSBundle mainBundle] infoDictionary] objectForKey:@"CFBundleShortVersionString"]; 
```

# silverlight - 为什么这个简单的数据绑定场景不起作用？（组合框相关）

> ID：458636
> 
> 赞同：1
> 
> 时间：2009-01-19T18:34:08.857
> 
> 标签：silverlight, data-binding, combobox, selecteditem, itemssource

我已经在这个问题上挠了一段时间了，现在我很难过。

问题场景更容易解释为代码，因此希望它不言自明。首先，我在 XAML 中有一个带有以下内容的 silverlight 应用程序...

```
<UserControl x:Class="SilverlightApplication2.Page"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
Width="400" Height="300">

<UserControl.Resources>
    <DataTemplate x:Key="icTemplate">
        <ComboBox ItemsSource="{Binding StringsChild}" SelectedItem="{Binding SelectedItem}"/>
    </DataTemplate>
</UserControl.Resources>

<Grid x:Name="LayoutRoot" Background="White">
    <Grid.RowDefinitions>
        <RowDefinition/>
        <RowDefinition/>
    </Grid.RowDefinitions>
    <ItemsControl x:Name="ic" ItemTemplate="{StaticResource icTemplate}">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Vertical"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl>

    <Button Click="Save" Grid.Row="1" Content="GO"/>
</Grid> 
```

我的代码隐藏看起来像这样......（全部写在一个类文件中，以便您可以轻松地将其复制到您自己的项目中并编译）

```
namespace SilverlightApplication2
{
    public partial class Page : UserControl
    {
        public ObservableCollection<SomeClass> StringsParent { get; set; } 

        public Page()
        {   
            InitializeComponent();
            StringsParent = new ObservableCollection<SomeClass>();
            ic.ItemsSource = StringsParent;
        }

        private void Save(object sender, RoutedEventArgs e)
        {
            SomeClass c = new SomeClass();
            c.StringsChild.Add("First");
            c.StringsChild.Add("Second");
            c.StringsChild.SetSelectedItem("Second");
            StringsParent.Add(c);
        }
    }

    public class SomeClass
    {
        public SelectableObservablecollection<string> StringsChild { get; set; }

        public SomeClass()
        {
            StringsChild = new SelectableObservablecollection<string>();
        }    
    }

    public class SelectableObservablecollection<T> : ObservableCollection<T>
    {
        public SelectableObservablecollection()
            : base()
        {

        }

        public void SetSelectedItem<Q>(Q selectedItem)
        {
            foreach (T item in this)
            {
                if (item.Equals(selectedItem))
                {
                    SelectedItem = item;
                    return;
                }
            }
        }

        private T _selectedItem;
        public T SelectedItem
        {
            get
            {
                return _selectedItem;
            }
            set
            {
                _selectedItem = value;
                OnPropertyChanged(new PropertyChangedEventArgs("SelectedItem"));
            }
        }
    }
} 
```

所以让我解释一下......我开始编写一个通用的方法来创建一个具有**SelectedItem**属性的 ObservableCollection，这样当我将集合绑定到 ComboBox 时，我可以将 ComboBox 的**SelectedItem**属性绑定到它。

但是，由于某种原因，当 ComboBox 通过 ItemTemplate 有效嵌套时，它似乎不起作用。我实际上有一个列表列表，这个场景非常简单，以至于我不知道出了什么问题。

当您运行代码时，您会看到模板化的 ComboBox 确实选择了正确的项目，但它从未设置为 SelectedItem 尽管绑定。

我知道这很啰嗦，但是……有什么想法吗？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T19:19:17.407

调试器输出实际上为您提供了问题的提示：

System.Windows.Data 错误：BindingExpression 路径错误：在“ExpressionElements.SomeClass” “ExpressionElements.SomeClass”（HashCode=49044892）**上找不到“SelectedItem”属性。**BindingExpression: Path='SelectedItem' DataItem='ExpressionElements.SomeClass' (HashCode=49044892); 目标元素是'System.Windows.Controls.ComboBox'（名称=''）；目标属性是'SelectedItem'（类型'System.Object'）..

因为模板的 Data 上下文是 SomeClass 类的一个实例，所以您只需将 SelectedItem 绑定从 SelectedItem 更改为**StringsChild.SelectedItem**：

```
<DataTemplate x:Key="icTemplate">
    <ComboBox ItemsSource="{Binding StringsChild}" 
     SelectedItem="{Binding StringsChild.SelectedItem}"/>
</DataTemplate> 
```

# vbscript - VBScript 中的重载构造函数

> ID：458644
> 
> 赞同：15
> 
> 时间：2009-01-19T18:37:22.373
> 
> 标签：vbscript, class

我找到了一种在 VBScript 中扩展类的方法，但是有什么方法可以传入参数或重载构造函数吗？我目前正在使用 Init 函数来初始化属性，但希望能够在创建对象时执行此操作。
这是我的示例类：

```
Class Test
    Private strText

    Public Property Get Text
        Text = strText
    End Property

    Public Property Let Text(strIn)
        strText = strIn
    End Property

    Private Sub Class_Initialize()  
        Init
    End Sub  

    Private Sub Class_Terminate()   

    End Sub 

    Private Function Init
        strText = "Start Text"
    End Function    
End Class 
```

我创造了它

```
Set objTest = New Test 
```

但想做这样的事情

```
Set objTest = New Test(strInitText) 
```

这是可能的，还是必须在两个 setps 中创建和初始化对象？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-15T12:25:51.547

只是稍微改变一下svinto的方法......

```
Class Test
  Private m_s
  Public Default Function Init(s)
    m_s = s
    Set Init = Me
  End Function
  Public Function Hello()
    Hello = m_s
  End Function
End Class

Dim o : Set o = (New Test)("hello world") 
```

我是怎么做的。可悲的是没有超载。

[编辑]虽然如果你真的想要你可以做这样的事情......

```
Class Test
    Private m_s
    Private m_i

    Public Default Function Init(parameters)
         Select Case UBound(parameters)
             Case 0
                Set Init = InitOneParam(parameters(0))
             Case 1
                Set Init = InitTwoParam(parameters(0), parameters(1))
             Else Case
                Set Init = Me
         End Select
    End Function

    Private Function InitOneParam(parameter1)
        If TypeName(parameter1) = "String" Then
            m_s = parameter1
        Else
            m_i = parameter1
        End If
        Set InitOneParam = Me
    End Function

    Private Function InitTwoParam(parameter1, parameter2)
        m_s = parameter1
        m_i = parameter2
        Set InitTwoParam = Me
    End Function
End Class 
```

这给了构造函数...

```
Test()
Test(string)
Test(integer)
Test(string, integer) 
```

你可以称之为：

```
Dim o : Set o = (New Test)(Array())
Dim o : Set o = (New Test)(Array("Hello World"))
Dim o : Set o = (New Test)(Array(1024))
Dim o : Set o = (New Test)(Array("Hello World", 1024)) 
```

不过有点痛。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T18:57:09.573

您可以通过让 Init 函数返回对象本身来解决它...

```
Class Test
  Private m_s
  Public Function Init(s)
    m_s = s
    Set Init = Me
  End Function
  Public Function Hello()
    Hello = m_s
  End Function
End Class

Dim o
Set o = (New Test).Init("hello world")
Echo o.Hello 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T18:39:42.730

您必须分两步完成。VB 脚本不支持重载，因此您不能使用新参数修改默认构造函数。Vb6 也是如此

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-12T02:34:17.577

有点骇人听闻，当然，但是当我在调用中需要可变参数时，我的一个参数作为数组传入，即

```
Rem printf done poorly
sub printf(fmt, args)
  dim fp, vap:
  dim outs:
  dim fini:
      fini = 0:
      vap = 0:
  while (not fini)
    fp = index(fmt,"%"):
    if (not(isNull(fp))) then
        ' do something with %f, %s
        select case(fp)
        case 'c':
          outs = outs & charparse(args(vap)):
        case 's':
          outs = outs & args(vap):
        ' and so on.  Quite incomplete but you get the idea.
        end select
        vap = vap + 1
    end if
  wend
end sub

printf("%s %d\n",array("Hello World", 42)): 
```

# apache-flex - 需要从 1 月 1 日到 12 月 31 日的一系列日期

> ID：458645
> 
> 赞同：0
> 
> 时间：2009-01-19T18:37:55.183
> 
> 标签：apache-flex, actionscript-3

如何在 ActionScript 3 中创建从 2008 年 1 月 1 日到 2008 年 12 月 31 日的日期数组，每天一个？

如果它适用于任何日期范围，那将是理想的......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T20:08:01.273

这个怎么样 ：

```
function getDateArray(start:Date, end:Date):Array
{
    var result:Array = new Array();
    var iter:Date = new Date(start); //you could remove or standardise time info here
    while (iter <= end)
    {
        result.push(new Date(iter));
        iter.setDate(iter.getDate() + 1);
    }
    return result;
}
```

让 AS3 Date 类处理每月天数、闰年等的实际问题。

可能有更好的方法来做任何需要你有一系列日期的事情，但我确信我以前出于正当理由使用过类似的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T20:31:53.017

只是想知道为什么你需要一个日期数组。并不是说这可能没有充分的理由，但这似乎有点奇怪。如果你有一个开始和结束日期，那么很可能有更好的方法来做你想做的任何事情。还有更多信息吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T14:46:56.647

我需要 2 个日期之间的天数数组，因为我的应用程序有一个带有 2 个拇指的自定义 hSlider，它允许用户更改他们希望将数据绑定到的日期范围。（想想谷歌金融）......

我的解决方案：

```
var startDate:Date = Application.application._model.minDate;
        var endDate:Date = Application.application._model.maxDate;

        var timespan:Number = endDate.getTime() - startDate.getTime();
        var aDay:Number = 86400000;
        var days:Number = timespan / aDay;
        dateData.length = 0;
        var i:int = 0;
        dateData.push(new Date(startDate));
        dateData.push(new Date(endDate));

        for(i = 0; i < days; i++){
            var newDate:Date = new Date(startDate.getTime() + i * aDay);
            dateData.push(newDate);
        }

        slider.setThumbValueAt(0, Number(dateData[0]));
        slider.setThumbValueAt(1, Number(dateData[i])); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:38:58.540

显然这可能不适合您的应用程序，但为了论证，如果我想要一个控制给定范围内的日期值的 hSlider，我会将滑块设置为返回 0 到 1 之间的值并将其用作两个日期之间的毫秒百分比。这方面的一个例子是：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical">
<mx:Script>
    <![CDATA[
        import mx.events.SliderEvent;

        private static var START_DATE : Date = new Date(2009,0);
        private static var END_DATE : Date = new Date(2010,0);

        [Bindable]
        protected var currentDate : Date;

        protected function dateSliderChangeHandler(event : SliderEvent) : void
        {
            var differenceInMilli : Number = END_DATE.time - START_DATE.time;
            var percantageMilli : Number = differenceInMilli * event.value;
            var currentDateInMilli : Number = START_DATE.time + percantageMilli;

            currentDate = new Date(currentDateInMilli);
        }

    ]]>
</mx:Script>

<mx:HSlider id="dateSlider" 
    width="200" 
    minimum="0"
    maximum="1"
    change="dateSliderChangeHandler(event)" />
<mx:Label text="{currentDate}" /> 
```

这样我就不必创建所有日期的数组。显然，如果您只需要日期具有一定的准确性，那么您将需要一些额外的逻辑来向上或向下舍入日期。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T19:30:41.097

没什么特别的：只使用两个 for 循环，内部循环检查月份索引（“三十天有九月、四月、六月和十一月”）并考虑闰年（我相信今年是其中之一），记住 ActionScript 的Date 对象在天数内不使用从零开始的索引（尽管它在数月内使用）：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" initialize="app_init()">
    <mx:Script>
        <![CDATA[

            private function app_init():void
            {
                var dates:Array = new Array();

                for (var month:int = 0; month < 12; month++)
                {
                    for (var day:int = 1; day <= 31; day++)
                    {
                        var date:Date = new Date(2008, month, day);

                        // 30 days has September (8), April (3), June (5) and November (10)...  
                        if ((month == 8 || month == 3 || month == 5 || month == 10) && day == 31)
                        {
                            break;
                        }
                        // Leap year                        
                        else if (month == 1 && day > 29)
                        {
                            break;
                        }

                        dates.push(date);
                    }
                }

                for each (var d:Date in dates)
                {
                    trace(d);
                }
            }

        ]]>
    </mx:Script>
</mx:Application> 
```

有道理？（如果有更优雅的方式，我不知道。）

# svn - Subversion：磁盘上的 unix 权限，用于安全的 apache 访问

> ID：458647
> 
> 赞同：0
> 
> 时间：2009-01-19T18:38:25.773
> 
> 标签：svn, security, apache, unix

我将 Subversion 存储库从 Windows 机器移到了 UNIX 机器上。在这两种环境中，我都通过 Apache 处理了身份验证。

在移动后的 UNIX 框中，我可以签出源，但在提交任何内容时收到以下错误：

```
svn: Can't open file '/home/brianly/svn/test/db/txn-current-lock': Permission denied 
```

这似乎是一个 UNIX 权限问题，下面的命令解决了这个问题：

```
chmod -R 777 /home/brianly/svn/test 
```

现在，我已将其开放为可供所有用户写入（对吗？）。这样做有安全问题吗？我应该将所有者更改为 apache 用户（守护进程）吗？设置文件系统权限的最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T18:42:57.760

您应该做的是将目录所有者更改为 apache 进程用户，例如

```
chown -R apache /home/brianly/svn/test 
```

您需要以`chown`root 身份运行（直接或通过`sudo`）。

您可以查看用户与谁在一起（如果是 linux）：

```
ps -fadeww|grep httpd 
```

并且不要忘记将其更改回 755 或 700 或其他。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T19:05:16.763

如果唯一的访问是通过 HTTP，那么您可以限制对运行 Web 服务器的用户的访问。现在使用 777，这不仅是对本地用户的安全风险，而且还会丢失权限，因为您刚刚制作了不应该的可执行文件......请参阅 orip 的其余答案。

# jquery - 上“向下箭头”的 CSS元素？是否可以对下拉选择元素上的向下箭头进行样式化？即 (<select><option>--></option></select>) 我怀疑答案是否定的，因为 IE 处理该特定元素的方式。如果没有办法，有没有人知道使用 javaScript 的“假”下拉框会模仿这种行为但让我能够自定义？也许您可以使用 jQuery 选择框替换。这是一个 jQuery 插件。下拉菜单是平台级元素，您不能对其应用 CSS。您可以使

> ID：458657
> 
> 赞同：36
> 
> 时间：2009-01-19T18:41:10.293
> 
> 标签：jquery, html, css

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2011-12-02T19:20:47.080

这里有一个很酷的 CSS-only 解决方案来样式下拉列表：http: [//bavotasan.com/2011/style-select-box-using-only-css/](http://bavotasan.com/2011/style-select-box-using-only-css/)

基本上，将选择包装在容器 div 中，将选择设置为比具有透明背景的容器宽 18px，将溢出：隐藏到容器中（以切断浏览器生成的箭头），并添加带有风格化的背景图像箭头到容器。

在 IE7（或 6）中不起作用，但说真的，我说如果你使用的是 IE7，你应该得到一个不那么漂亮的下拉体验。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-19T18:43:20.787

也许您可以使用[jQuery 选择框替换](http://code.google.com/p/select-box/)。这是一个 jQuery 插件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-19T18:44:53.217

不，向下箭头是浏览器元素。它在每个浏览器中都内置[并且不同]。但是，您可以使用 javascript 将选择框替换为自定义下拉框。

Jan Hancic 提到了一个 jQuery 插件来做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T18:44:35.153

下拉菜单是平台级元素，您不能对其应用 CSS。

您可以使用 CSS 在其上叠加图像，并在下方元素中调用 click 事件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-19T18:54:49.953

您不能使用 CSS 很好地设置组合样式。

FogBugz 的人使用 JavaScript 制作了一个非常好的自定义组合，所以这是可能的，只是需要做很多工作才能让它正确。

最好坚持使用版本 1 的标准版本，然后在你的应用程序发布后看看是否值得更新它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T18:44:47.650

我不知道它是否可以用 CSS 设置样式（可能不在 IE 中），但请不要使用 javascript 使用“假”下拉框，因为这些东西的可用性通常很糟糕。除其他外，通常不存在键盘导航。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-07T11:43:56.780

您可以仅使用 CSS 和向下箭头作为绝对定位的图像来实现这一点，并带有“pointer-events: none;” 请参阅下面的示例：

```
<select>
  <option value="1">1 Person</option>
  <option value="2">2 People</option>
</select>
<img class="passthrough" src="downarrow.png" />

.passthrough {
    pointer-events: none;
    position: absolute;
    right: 0;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-05-19T08:58:41.313

这会将输入、选择等更改为旧式灰色，不确定您是否可以在此之后进行操作：输入`<head>`：

```
<meta http-equiv="MSThemeCompatible" content="NO"> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-19T18:46:10.110

您需要使用隐藏的 div 和隐藏的输入元素创建自己的下拉菜单，以记录“选择”了哪个选项。我的猜测是他发布的@Jan Hancic 的链接可能就是你要找的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-02-14T12:57:54.887

尝试这个

```
 <div style='position:relative;left:0px;top:0px;
        onMouseOver=document.getElementById('visible').style.visibility='visible' 
        id='hidden'>10
   <select style='position:absolute;left:0px;top:0px;cursor:pointer;visibility:hidden;'
        onMouseOut=document.getElementById('visible').style.visibility='hidden'
        onChange='this.form.submit()' 
        id='visible' multiple size='3'>";
   <option selected value=10>10</option>
   <option value=20>20</option>
   <option value=50>50</option>
   </select>
   </div> 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-10-07T17:10:14.437

[http://jsfiddle.net/u3cybk2q/2/](http://jsfiddle.net/u3cybk2q/2/)检查 windows、iOS 和 Android（iexplorer 补丁）

```
.styled-select select {
   background: transparent;
   width: 240px;
   padding: 5px;
   font-size: 16px;
   line-height: 1;
   border: 0;
   border-radius: 0;
   height: 34px;
   -webkit-appearance: none;
}
.styled-select {
   width: 240px;
   height: 34px;
   overflow: visible;
   background: url(http://nightly.enyojs.com/latest/lib/moonstone/dist/moonstone/images/caret-black-small-down-icon.png) no-repeat right #FFF;
   border: 1px solid #ccc;
}
.styled-select select::-ms-expand {
    display: none; /*patch iexplorer*/
}
```

```
 <div class="styled-select">
       <select>
          <option>Here is the first option</option>
          <option>The second option</option>
       </select>
    </div>
```

# asp.net - 您如何将 C# Web 应用程序部署和管理给与您的基础项目有一些细微差别的客户？

> ID：458659
> 
> 赞同：5
> 
> 时间：2009-01-19T18:42:27.140
> 
> 标签：asp.net, deployment, web-applications

我有一个在本地运行的半大型 Web 应用程序，我需要将它部署在另一个位置。第二个位置需要对项目进行一些细微的修改（尤其是外观）。您如何管理这些差异以及如何将网站和更新分发给这样的客户？

编辑：现在我们的 Web 应用程序在内部运行，我们使用 Cruise Control .NET 和 MSBuild 和 WDP 构建。什么是部署给客户的好选择？我们不会为他们更新他们的站点，因此需要一个易于部署和更新的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T18:47:13.603

分支你的代码。

希望您的代码是源代码控制的（如果没有，现在开始！），您应该从基础分支到“客户 X”分支，并在该分支中进行轻微的外观修改。然后为该客户构建和部署该分支。

此外，如果更改足够小，您可以尝试使更改可配置。这样您就可以在任何地方部署相同的站点，并且只需更改配置以匹配客户的需求。差异越复杂，使它们可配置的难度就越大。

查看评论后：很高兴注意到配置是实用的，但只有在更改的数量很小的情况下，否则您将使用配置逻辑污染您的代码。（感谢评论者）

所以：很多变化--> 分支（更易于维护），很少的小变化--> 可配置（更实用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T18:52:10.207

我们必须一直这样做。我们尝试概括并使版本之间的差异可配置。自定义的最常见原因是：

*   额外的数据库字段：我们实现了一种将这些项目存储在数据库中的动态方式
*   UI 布局：我们有特殊的文件夹，用于放置按需加载的图像和 css 文件
*   不同的强制输入字段：我们将定义存储在配置中并以编程方式激活它们
*   特别报告：我们将模板文件放在自定义文件夹中以便选择而不是标准模板

某些更改需要编写新模块。我们将它们编码在一个自定义库中，该库将在主应用程序中动态加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T18:50:11.227

我们通常通过数据驱动来产生这些差异。客户的不同只是设置不同；将来的任何其他用户也可以稍后重用相同的“自定义”选项。

创建“一次性”不会扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T18:46:30.733

正是因为这个原因，自定义补丁是一件痛苦的事情。我们通常只是在我们的源代码控制系统中分支，并在使用脚本更新后手动应用更改。由于额外的开销，我们尽可能不鼓励自定义补丁。

# delphi - 找不到 Delphi 2007 WSDL 导入器

> ID：458661
> 
> 赞同：5
> 
> 时间：2009-01-19T18:42:34.690
> 
> 标签：delphi, delphi-2007

我可能遗漏了一些东西，但我在任何地方都找不到 Delphi 2007 WSDL Importer。我已经查看了应该在的 New -> Other -> Web Services 以及所有其他部分（以防万一），但它不存在。WSDL 导入器是否仅随 IDE 的某些版本而不随其他版本提供？它被隐藏在某个地方了吗？什么时候有人会写出真正可用的 Delphi 手册？！;)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T18:53:29.347

您**应该首先**创建一个新的 VCL 项目，然后转到

文件 | 新 | 其他 | 德尔福项目 | 网络服务 | WSDL 导入器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T18:52:06.480

我认为这取决于您使用的 Delphi 版本，我认为 Web 服务部分仅适用于企业版本..

[您可以在此处](http://cc.codegear.com/Item/24535)查找 CodeGear 站点上的 WSDL 导入器

# sql-server - 如何删除保存在 SQL Server 上的 SSIS 包？

> ID：458666
> 
> 赞同：9
> 
> 时间：2009-01-19T18:44:11.363
> 
> 标签：sql-server, sql-server-2005, ssis

我在 SQL Server 2005 的维护计划下保存了一个 SSIS 包。虽然我可以选择 SSIS 包，但我不确定如何删除它们。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T18:50:10.540

听起来您正试图从数据库引擎 --> 管理 --> 维护计划中删除包。尝试连接到“集成服务”而不是数据库引擎，然后在 Running Packages 或 Stored Packages 下查找要删除的包。

从那里你应该能够右键单击并删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-03-30T03:10:00.437

如果您正在寻找一种脚本方法来从 SQL Server 中删除包，您可以执行以下操作：

以下代码将从名为“MYSQLSERVER01”的服务器中删除部署为“\Maintenance Plans\DatabaseBackup-Full-All”的包

```
DTUTIL /SQL "\Maintenance Plans\DatabaseBackup-Full-All" /DELETE /SourceServer MYSQLSERVER01 >> rollback.log 
```

以下代码会将位于文件系统当前目录中的名为“DatabaseBackup-Full-All.dtsx”的包部署到名为“MYSQLSERVER01”的服务器上，名为“\Maintenance Plans\DatabaseBackup-Full-All”

```
DTUTIL /FILE "DatabaseBackup-Full-All.dtsx" /COPY SQL;"\Maintenance Plans\DatabaseBackup-Full-All" /QUIET /DestServer MYSQLSERVER01 >> release.log 
```

这些代码示例从命令行运行。我还包含了 >> release.log 和 >> rollback.log，以便您可以将执行日志保存到文件中。

不要忘记 cd 进入任何包含您的 Package File 的目录以按原样运行脚本，或者更新上面的代码以获得您的包的完整（本地或 unc）文件路径。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-13T15:53:17.700

根据您使用的 SQL Server 版本，有一个包含包的系统表。在我的 2005 版本中，该表称为 msdb.dbo.sysdtspackages90。您还可以查找诸如 msdb.dbo.sysdtspackages 或 msdb.dbo.sysssispackages 之类的表。要删除一个包，只需从该表中删除它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-29T23:40:24.977

John DaCosta 的解决方案对我有用。我编写了以下查询来输出删除命令并将结果粘贴到命令 shell 窗口中：

```
SELECT CONCAT('DTUTIL /SQL "\', f.foldername, '\', name, '" /DELETE /SourceServer MyServerName')
FROM msdb.dbo.sysssispackages s
JOIN msdb.dbo.sysssispackagefolders f
    on s.folderid = f.folderid
WHERE ownersid <> 0x01 
```

# c# - 传递一个 Windows 服务参数让它起作用

> ID：458674
> 
> 赞同：2
> 
> 时间：2009-01-19T18:46:07.083
> 
> 标签：c#, .net, parameters, service

我想把我拥有的程序变成服务，这样我就可以在不记录的情况下使用它。基本上它的作用是使用 SSH 将指定的文件夹备份到指定的位置。但是我遇到的问题是我不知道如何告诉它这些项目。我只知道如何启动、停止和运行只有一个带参数的整数的自定义命令。

我怎样才能做到这一点？

**Windows 服务，而不是 Web 服务**

**编辑**：它备份的文件夹不会保持一致，并且会在每次运行时更新

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T19:19:54.910

您可以使用 ServiceController 类实例化您的服务并传递命令行参数。

```
using (ServiceController serviceController = new ServiceController(serviceName))
{
   string[] args = new string[1];
   args[0] = "arg1";
   serviceController.Start(args);
} 
```

当 Windows 启动服务时，“arg1”将在 main() 中作为常规命令行参数使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-31T01:29:33.113

我看到您（或某人）对 Sebastian Sedlak 的回答投了反对票，因为他提到在 Windows 服务中托管 WCF 服务。你的回复是

`It's in nice bold lettering in the question. Not a Web Service, therefor WCF is out of the question`

我想你误解了他的意思。他不是在谈论**Web 服务**。他正在谈论*在*您的**Windows 服务中托管****WCF** 服务。

 ***这与同一件事相去甚远。*您可以在*任何 Windows（窗体/控制台/服务）应用程序中托管 WCF 服务。这样做的目的是，*应用程序*可以通过其内部 WCF 服务进行通信，就像您可以与 Web 服务进行通信一样*（*您也可以*在*IIS 中托管 WCF 服务，顺便说一句，这*将使*它们“Web 服务”，在您所指的意义上）。

在 Windows 服务中，这意味着您可以向它发送任何命令，还可以从它获取您想要的任何信息 - 在它运行时。

事实上，我现在正在做一个项目，这是一个 Windows 服务，我需要能够在运行时联系它并将命令传递给它 - 并从中获取信息。例如，我希望能够告诉它在哪里存储某些东西，记录什么，让它重置/重新启动 - 并轮询它以获取状态消息。我通过在 Windows 服务中托管 WCF 服务来做到这一点。该 WCF 服务公开了一组方法，在我的例子中包括接收命令和返回状态信息。因此，当**Windows 服务**运行时，我可以通过其内置的**WCF 服务**联系它（甚至远程）并告诉它要做什么。

这是一个非常容易实现的事情，并且在 Windows 服务的情况下，可以为您提供比通过基本标准命令更丰富的服务接口。

**但是**，您指定希望 Windows 服务在每次*启动时*都接收其文件夹设置，这使得这种被动设置不太理想（因为在您将正确的文件夹传递给它之前它无法执行任何操作）。

解决这个问题的一种方法（使用托管的 WCF 服务）是让 Windows 服务一直运行*（*即自动启动）。它的默认状态是空闲的。然后，您可以向它发出“开始处理”命令，为其提供要处理的正确文件夹（通过调用相应的 WCF 服务方法）。类似地，WCF 服务将公开为您提供应用程序状态（当前文件夹、进度、忙碌/空闲等）的方法。处理完成后，它将返回空闲状态，等待为其提供下一组文件夹。

这样做会使远程控制变得非常容易——你甚至可以为它制作一个在线管理面板，可以从任何地方访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-30T17:05:31.267

问题在于，虽然传入参数并不困难，但当机器重新启动并且 Windows 尝试重新启动服务时，这些参数不存在。它们仅在有人从命令行启动服务时才存在。

例如。我有一个托管 WCF 服务的 Windows 服务。我希望用户能够为 WCF 服务指定一个非默认端口号来监听。他们通过像这样启动 Windows 服务来做到这一点...... MyService -port:xxxxx

哪个工作正常，直到服务器重新启动，然后 Windows 重新启动 MyService（但没有参数）并且 wcf 服务默认为原始端口 #

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T18:50:03.020

是否可以使用配置文件来指定这些项目？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T18:51:16.700

将服务的启动参数存储在注册表中：然后，当注册表启动时，它应该从注册表中读取其启动参数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T18:51:39.040

任何服务都能够在启动时接收命令行参数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T18:53:12.703

Windows 服务与任何其他服务一样具有可执行文件。我相信您可以编写它来接受命令行参数并在 Windows 服务配置中指定这些参数。您也可以让它读取配置文件。如果您使用的是 .NET，则框架中有配置文件类。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-19T19:26:49.763

为什么不在 Windows 服务中托管一个 WCF 服务来获得这样的“管理”功能呢？（远程也可以）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-10-01T01:51:32.153

回复：配置文件。

当然可以使用配置文件。并且可以在服务运行时更改文件。

如果配置文件实际上发生了变化，这将是一个很好的解决方案。我所有的服务都使用一个 XML 配置文件，封装在一个类中以便于重用。

包装器可以选择使用 fileMonitor 监视 XML 文件的更改，可选择自动刷新配置文件的内容，最后向服务类引发事件。然后，该服务可以根据需要选择“重置”自身以将新值合并到 XML 配置文件中。

将配置放入注册表有几个问题：

*   安全性（即：安装程序被授予访问权限），取决于使用的树
*   该服务将不知道更改
*   可移植性 - 尽管安装应该设置注册表设置很小

XML 文件易于复制、编辑、共享、查看和理解的地方。加入一些好的 COMMENT 块和详细的 XSD 文件，它也成为好的文档的来源。

查看 XPath 以便在 XML 文件中轻松导航和提取值。

0.02 美元 ... 大卫 ...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-30T17:11:36.143

关于 app.config 文件 - 我很确定您的服务会在我以这种方式编写所有 Windows 服务时读取和使用这些文件；）所以只需将 app.config 中所需的所有内容放在“应用程序”下（不是用户）并在“InstallUtil”服务所在的文件夹中编辑“yourname.exe.config”。

# java - 如何找出 MySQL 查询在 Java 中返回的行数？

> ID：458682
> 
> 赞同：1
> 
> 时间：2009-01-19T18:48:56.627
> 
> 标签：java, mysql, jdbc

如何找出 MySQL 查询在 Java 中返回的行数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T18:55:02.340

从[jdbc 常见问题解答](http://java.sun.com/products/jdbc/faq.html#18)：

> .18\. JDBC API 中有一个方法 getColumnCount。是否有类似的方法来查找结果集中的行数？
> 
> 不，但很容易找到行数。如果您使用的是可滚动结果集 rs，您可以调用方法 rs.last 和 rs.getRow 来找出 rs 有多少行。如果结果不可滚动，您可以通过迭代结果集来计算行数，或者通过在 SELECT 子句中提交带有 COUNT 列的查询来获取行数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T18:55:41.993

我不认为你可以，除非可能通过调用`ResultSet.last()`然后`ResultSet.getRow()`- 但我不知道这是否真的有效。我总是一次只处理每一行，然后计算它们。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-19T18:55:55.177

如果您使用 CachedRowSet，您可以知道您的语句返回了多少行，然后双向迭代，向前和向后，缺点是必须将完整的行集放在内存中，而不是动态获取。[这里有更多信息](http://java.sun.com/developer/Books/JDBCTutorial/chapter5.html)。

# java - 如何使用 JSP EL 动态访问请求参数？

> ID：458697
> 
> 赞同：15
> 
> 时间：2009-01-19T18:52:53.780
> 
> 标签：java, jsp, jstl, el

我正在遍历一个项目列表，我想根据项目的索引获取一个请求参数。我可以使用如下所示的 scriptlet 轻松完成，但我想使用表达式语言。

```
<c:forEach var="item" items="${list}" varStatus="count">

   <!-- This would work -->
   <%=request.getParameter("item_" + count.index)%>

   <!-- I'd like to make this work -->
   ${param.?????}

</c:forEach> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-19T18:54:55.880

```
<c:set var="index" value="item_${count.index}" />
${param[index]} 
```

不幸的是， + 不适用于普通 Java 中的字符串，所以

```
${param["index_" + count.index]} 
```

不工作;-(

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T19:01:14.683

[J2EE 1.4 文档的表达式语言文档](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPIntro7.html#wp71043)部分中有一个隐式对象列表。您正在寻找*param*。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T19:46:55.463

您只需要使用“方括号”表示法。通过使用 JSTL <c:set> 标记，您可以生成正确的参数名称：

```
<c:forEach var="item" items="${list}" varStatus="count">
  <c:set var="paramName">item_${count.index}</c:set>
  ${param[paramName]}
</c:forEach> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-03-23T09:31:21.287

简短的回答：

```
${param.item_[count.index]} 
```

# c# - 如何在不使用 AppDomains 的情况下实现 .net 插件？

> ID：458699
> 
> 赞同：5
> 
> 时间：2009-01-19T18:53:14.510
> 
> 标签：c#, .net, iis, assemblies, appdomain

问题陈述：实现一个允许相关程序集被覆盖的插件系统（避免文件锁定）。在 .Net 中，可能不会卸载特定程序集，只能卸载整个 AppDomain。

我发布这个是因为当我试图解决这个问题时，每个解决方案都提到了使用多个 AppDomain。多个 AppDomain 很难正确实现，即使是在项目开始时进行架构设计时也是如此。

此外，AppDomains 对我不起作用，因为我需要跨域传输类型作为 Speech Server worfklow 的 InvokeWorkflow 活动的设置。不幸的是，跨域发送类型会导致程序集被注入本地 AppDomain。

此外，这与 IIS 有关。IIS 有一个 Shadow Copy 设置，允许在加载到内存时覆盖正在执行的程序集。问题是（至少在 XP 下，没有在生产 2003 服务器上测试）当您以编程方式加载程序集时，卷影副本不起作用（因为您正在加载 DLL，而不是 IIS）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T18:54:12.777

1.  检查程序集是否已经加载（以避免由于一遍又一遍地加载相同的程序集而导致内存泄漏）。
2.  如果未加载，则将程序集读入字节数组。这将防止锁定文件。
3.  将字节数组作为参数提供给 Assembly.Load

以下代码假定您知道程序集的 FullName。

```
Assembly assembly = null;

foreach(Assembly loadedAssembly in AppDomain.CurrentDomain.GetAssemblies())
    if (loadedAssembly.FullName == "foobar, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null")
        assembly = loadedAssembly;

if(assembly == null)
{
    byte[] studybin = System.IO.File.ReadAllBytes(@"C:\pathToAssembly\foobar.dll");
    assembly = Assembly.Load(studybin);                
} 
```

请注意，如果您尝试在目录中查找特定程序集，则可以运行“System.Reflection.AssemblyName.GetAssemblyName(path);” 查看 FullName 是否与您要查找的内容匹配。'GetAssemblyName(path)' 不会将程序集注入您当前的 AppDomain。

另请注意，此解决方案不适用于必须很少重新启动且程序集会频繁更改的应用程序。每次加载程序集时，应用程序的内存占用都会增加。没有卸载程序集的方法，因此减少内存使用的唯一选择是重新启动应用程序。但是，与使用多个应用程序域的大量性能、内存和代码复杂性开销相比，这种限制通常更可取。`Type`如果您希望使用s ，此限制也是不可避免的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-20T15:39:08.790

如果你想隔离你的插件，你必须...

1.  创建一个扩展 MarshallByRefObject 的类型，它将与您的插件交互（我们称之为 FOOMASTER）
2.  创建一个新的 appdomain（我们称之为 addinLand）
3.  调用 addinLand.CreateInstanceAndUnwrap 在 addinLand 中创建 FOOMASTER 的实例，并获取当前应用域中的代理
4.  告诉 FOOMASTER 加载您的插件

现在您的插件已加载到 addinLand 中，您可以通过您的 FOOMASTER 代理从您的主应用程序域与它们进行交互。当您的插件崩溃时，它们不会关闭您的应用程序。

这是一个有趣且略显混乱的过程。我最初认为这个想法是加载您的插件，然后将它们作为透明代理带入当前应用程序域，但最好的设计是将插件作为与您创建的更复杂类型交互的简单对象（FOOMASTER），扩展MarshallByRefObject，加载在 addinLand 应用程序域中，以及您与之交互的透明代理。

CLR Via C# 的第 21 章和第 22 章对理解该过程非常有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-20T15:53:23.020

如果您对构建具有插件架构的系统的严肃方法感兴趣，您可能需要查看 MAF（托管插件框架），它现在是 .NET 框架的一部分，即 System.AddIn 命名空间。

它将帮助您管理插件隔离和版本控制，甚至与合同的向后兼容性。

虽然这里有一些学习曲线，所以这可能不是您正在寻找的。

[http://msdn.microsoft.com/en-us/library/bb384200.aspx](http://msdn.microsoft.com/en-us/library/bb384200.aspx)

# javascript - 查找特定 DOM 元素的加载时间

> ID：458708
> 
> 赞同：0
> 
> 时间：2009-01-19T18:55:10.780
> 
> 标签：javascript

我正在开发一个 JavaScript 实用程序，它告诉用户嵌入到网页中的 3rd 方链接的数量。我希望能够像 FireBug 一样提供有关加载时间（以及可能的有效负载大小）的指标，但我不知道是否可以使用原始 JS 获得这些信息。

该工具的消费者是不会运行 Firefox 或了解 firebug 等的商务人士。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T19:01:01.890

使用 jQuery，您可以挂钩所有图像的加载事件，然后记录 $(document).ready 和当前时间之间的时间差。这会给你一些基准来工作。

例如，下面应该记录每张图片加载所花费的毫秒数（从 dom 准备好的那一刻起）：

```
$(function() {
  var startTime = new Date().getTime();

  $("img").load(function() {
    var currentTime = new Date().getTime();
    console.log(this.src + " " + (currentTime-startTime));
  });
}); 
```

# ruby-on-rails - 奇怪的自动完成 + 密码记住行为

> ID：458715
> 
> 赞同：-1
> 
> 时间：2009-01-19T18:56:24.427
> 
> 标签：ruby-on-rails, firefox, autocomplete, google-chrome

我很难弄清楚 Firefox 和 Chrome 如何确定密码的字段以及它们如何在其他表单上自动完成它们。

对于我的登录表单，我有这个：

```
<p>
    <label for="login_email">Email:</label><br />
    <input id="login_email" name="login[email]" size="30" type="text">
</p>

<p>
    <label for="login_password">Password:</label><br />
    <input id="login_password" name="login[password]" size="30" type="password">
    <input id="login_password_hash" name="login[password_hash]" type="hidden">
</p>

<p>
    <input id="login_submit" value="LOGIN" type="submit">
</p> 
```

该`login_password_hash`字段用于在使用 Javascript 发送之前在客户端对密码进行哈希处理，禁用 Javascript 不会改变结果。

为了创建一个新用户，我有这个表格：

```
<p>
    <label for="user_email">Email:</label>
    <input id="user_email" name="user[email]" size="30" type="text">
</p>
<p>
    <label for="user_first_name">First Name:</label>
    <input id="user_first_name" name="user[first_name]" size="30" type="text">

</p>
<p>
    <label for="user_last_name">Last Name:</label>
    <input id="user_last_name" name="user[last_name]" size="30" type="text">
</p>
<p>
    <label for="user_password">Password:</label>
    <input id="user_password" name="user[password]" size="30" type="password">
    <input id="user_password_hash" name="user[password_hash]" type="hidden">
</p>

<p><input id="user_submit" value="Create User" type="submit"></p> 
```

现在从登录表单保存密码并访问新用户表单后，保存的电子邮件将放在密码字段之前的最后一个字段中，并将密码放在密码字段中。

这会在 Firefox 和 Chrome 上发生，但不会在 Internet Explorer 上发生。关于为什么 Firefox 和 Chrome 会有这种行为的任何想法？这两种形式没有任何共同之处，名称和ID都不同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T19:34:54.210

如果您想禁用输入的自动完成功能，请尝试使用 autocomplete 属性，例如：

```
<input type="text" name="email" autocomplete="off" /> 
```

但是，这不能保证在所有浏览器中都有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T19:00:09.567

好吧，所有浏览器都会选择最明显的字段名称：

*   名
*   姓
*   用户名
*   密码

还有那些明显的替代品（空格下划线，可能还有一些速记，例如“用户”和“通过”）。这将取决于浏览器本身以及它的版本以及支持哪些疯狂的替代品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T20:04:21.967

似乎更改 name 和 id 属性对 Firefox 和 Chrome 中的密码管理器没有影响，他们看到的只是一个 password_field 和它上面的字段，这对他们来说已经足够好了。

所以我只是在创建新用户时将密码字段设置为文本字段。

# apache-flex - Flex/Actionscript：动态访问静态变量

> ID：458719
> 
> 赞同：2
> 
> 时间：2009-01-19T18:59:06.560
> 
> 标签：apache-flex, actionscript-3

假设我有一个类 Foo：

```
public class Foo
{

   public static var bar:String = "test";

} 
```

如何在运行时使用字符串“Foo”或/和以及 Foo 的实例和字符串“bar”来引用 bar？

IE

```
var x:Object = new Foo();
...
x["bar"] 
```

...不起作用，IntelliJ 中的调试模式得到了我的希望，因为 bar 被列为属性。

更新：

请注意，在“行动点”，我对 foo 在编译时一无所知。我需要通过字符串“Foo”和“bar”来解析 Foo.bar。

换句话说，由于 flex 没有 eval，我如何才能完成与 eval("Foo.bar") 相同的操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T19:06:10.290

它是一个静态变量，因此您将无法使用 foo 的*实例*访问它；它是静态访问的，使用 ClassName.variableName 表示法，如下所示：

跟踪（Foo.bar）；

// 产生：“测试”

同样，因为您已将 Foo 和 bar 都声明为 public，您应该能够从应用程序的任何位置以这种方式访问​​ Foo.bar。

* * *

**更新**：啊，我明白你在问什么。您可以使用 flash.utils.Summary.getDefinitionByName()：

```
// Either this way
trace(getDefinitionByName("Foo").bar);

// Or this
trace(getDefinitionByName("Foo")["bar"]); 
```

...后者感谢杰里米的回答，这对我来说是新的。:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T19:30:50.193

“bar”是一个静态变量，所以你需要通过类而不是类的实例来访问它。

```
trace(Foo.bar); // "test" 
```

如果通过动态访问变量，您的意思是使用字符串名称访问它，那么您也希望通过类来执行此操作。

```
trace(Foo["bar"]); // "test" 
```

# c++ - A的缺点 引入所有标准头文件的文件？

> ID：458721
> 
> 赞同：2
> 
> 时间：2009-01-19T19:00:21.673
> 
> 标签：c++, include

我发现长序列的标准包括烦人：

```
#include <vector>
#include <string>
#include <sstream>
#include <iostream> 
```

考虑到这些头文件很少更改，是否有理由不制作“std.h”文件#包括所有std头文件并在任何地方使用它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-19T19:03:51.090

包含不必要的头文件会增加编译时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T19:09:19.580

您可能希望将这些添加到项目的标准预编译头文件中：如果您的项目具有标准的预编译头文件，并且您的文件不应该在其他可能具有不同标准头文件的项目中可重用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T20:15:17.233

我讨厌为此创建一个新答案，但我基本上想把 Brian Ensink 和 ChrisW 的答案放在一起：

首先，正如布赖恩所提到的，你的编译时间会飞涨，因为每次编译时都会包含大量文件。幸运的是，它看起来像是标准包含，所以它们不应该经常改变，但它仍然很糟糕。

您可以通过构建一个预编译的头文件来缓解这种情况，该头文件只会在您进行完全重建、烘烤 PCH 文件或更改其中包含的内容时重新编译 - 但这就是为什么 PCH 文件通常只有系统范围的包含或东西不会经常改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T20:07:12.757

如果您实际上并未使用它，则不应包含它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T20:08:22.083

它会降低您的代码可读性（奇怪的是:)）。通过将它们全部包含在一个头文件中，您无法再仅通过查看文件顶部来判断哪些翻译单元包括 iostream（因此执行 IO）、fstream（以及执行文件访问）等。

我建议使用允许折叠包含语句的 IDE，如 eclipse，并让它自动折叠包含。这会将它们从您的视图中删除，同时仍使依赖关系清晰。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-19T19:45:14.593

这也会增加你的目标文件的大小，这在现在可能没什么大不了的。

*根据评论编辑二进制文件实际上不会更大*

# sql - 如何确定 SQL Server 中索引的大小？

> ID：458725
> 
> 赞同：5
> 
> 时间：2009-01-19T19:00:43.967
> 
> 标签：sql, sql-server, indexing

我在一个 SQL Server 表（兼容模式 80 和 90）中有一个索引——我们称之为它`IX_MY_INDEX`——我想确定它的大小。我该怎么做呢？

**更新：** Alllain Lalonde 下面的第二个解决方案仅在兼容模式设置为 90 时有效；但是，我正在处理的特定数据库处于兼容模式 80。有没有人有兼容模式 80 的解决方案？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T19:08:10.223

您可以像这样确定表（和其他事物）上所有索引的大小：

```
EXEC sp_spaceused TableName; 
```

对于完整的细分，您可以：

```
SELECT * 
FROM sys.dm_db_index_physical_stats(db_id(), object_id('TableName'), null, null, 'DETAILED'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-12-04T22:47:31.647

改编自[如何查找数据库上所有索引的大小](https://blog.sqlauthority.com/2016/11/13/find-size-indexes-database-interview-question-week-097/)的帖子，您可以使用：

```
SELECT OBJECT_SCHEMA_NAME(i.OBJECT_ID) AS SchemaName,
       OBJECT_NAME(i.OBJECT_ID) AS TableName,
       i.[name] AS IndexName,
       i.index_id AS IndexID,
       8 * SUM(a.used_pages) AS [Indexsize(KB)]
FROM sys.indexes i
JOIN sys.partitions p ON p.OBJECT_ID = i.OBJECT_ID AND p.index_id = i.index_id
JOIN sys.allocation_units a ON a.container_id = p.partition_id
GROUP BY i.OBJECT_ID, i.index_id, i.[name]
ORDER BY OBJECT_NAME(i.OBJECT_ID), i.index_id 
```

它使用下表：

*   [`sys.indexes`](https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-indexes-transact-sql)
*   [`sys.partitions`](https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-partitions-transact-sql)
*   [`sys.allocation_units`](https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-allocation-units-transact-sql)

# assembly - 装配分离过多的迹象是什么？

> ID：458739
> 
> 赞同：3
> 
> 时间：2009-01-19T19:04:16.783
> 
> 标签：assembly

虽然您通常不希望将一个整体组件用于一个小项目之外的任何东西，但有可能将事物分离得太多。

装配分离过多的迹象/气味是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T19:06:52.893

一个标志/气味是程序集中的所有内容是否都是公共的：相反，理想情况下，可能会有一个小的公共外观包装/隐藏更大的内部实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T19:07:22.220

第一个（显而易见的）是：在具有大量项目的解决方案中，程序集中只有少数（例如 3-4 个）类（只有接口的程序集可能是一个例外）。

另一个：如果项目中间层的某个程序集必须导入大量其他程序集才能完成其工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T19:33:20.360

循环依赖是一个死的赠品;-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T19:36:36.217

朝另一个方向推进，如果在同一个程序集中有一大堆不相关的东西，您的程序集分离可能*太少。*

向我建议的一种我发现有用的方法是将功能子系统保留在离散的组件中。这些子系统中的一些可能很大，而另一些可能相当小。

# c# - C# 替代模型制造商代码资源管理器

> ID：458742
> 
> 赞同：0
> 
> 时间：2009-01-19T19:05:31.710
> 
> 标签：c#, visual-studio

我已经从 delphi 更改为 c#/visual studio，我看到[模型制造商代码浏览器](http://www.modelmakertools.com/code-explorer-vs/screenshots.html#overview)（我最喜欢的工具之一）可用于 Visual Studio ......问题是否有更好的选择？

我玩过 resharper，它有一些很好的重构/代码突出显示功能......但我真正喜欢代码浏览器的一件事是你可以轻松地查看类和函数的方式。只是让生活变得如此轻松。Visual Studios 课程资源管理器有点帮助，但您始终必须导航到课程，而不是显示您当前正在查看的单元的课程。那么有什么视觉工作室工具可以很好地做到这一点吗？还是我应该坚持使用模型制造商代码浏览器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T19:54:13.017

根据您拥有的 Visual Studio 的 SKU（即：不是 Express），内置的*代码定义窗口*可能很有用。这是一个只读代码窗口，它向您显示光标所在的任何元素的声明。

我最近才发现代码定义窗口并发现它非常有用 - 我看到的[原始博客条目](http://www.chrisbrandsma.com/2007/03/visual-studionet-tool-i-didnt-know.html)是 Chris Brandsma 的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:40:29.833

我在 Visual Studio 中经常使用两组增强功能（我自己是一个 Delphi 转换器）：

*   [VisualStudio 2008 的 PowerCommands v1.1](http://www.visualstudiogallery.com/ExtensionDetails.aspx?ExtensionID=df3f0c30-3d37-4e06-9ef8-3bff3508be31)添加了许多有趣且有用的花里胡哨，主要是在解决方案资源管理器中

*   Visual Studio 2008[源代码大纲 PowerToy](http://www.codeplex.com/SourceCodeOutliner/)

两者都是免费的，表现良好，并且是不可缺少的恕我直言:-)

# java - Java 系统范围的键盘快捷键

> ID：458756
> 
> 赞同：26
> 
> 时间：2009-01-19T19:08:21.923
> 
> 标签：java, keyboard, system, shortcut

是否有任何方法或库来获得系统范围的（全局）键盘快捷键以在 Java 应用程序中执行操作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-11-16T01:00:27.063

我是 JIntellitype 的作者，我可以告诉你一个事实，这必须在 DLL 中本地完成，并像 JIntellitype 一样从 Java JNI 调用。这是一个操作系统级别的钩子，在 JDK 中没有实现，因此必须使用 JIntellitype 和 jxGrabKey 等库。据我所知，还没有人为 OSX 写过。

JIntellitype 在 Github 上是开源的，所以如果你想了解它是如何工作的，只需查看[源](https://github.com/melloware/jintellitype)代码

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-19T19:15:21.660

没有，但在 Windows 中你可以使用这个：

[智能型](https://github.com/melloware/jintellitype)

不幸的是，对于 Linux 和 OSX，我一无所知，这可能就是为什么它没有随 java 开箱即用的原因。

如果您找到其他平台，请在此处发布 :)

只是为了好奇，你在做什么？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-10-26T15:48:13.820

我刚刚找到[https://github.com/kwhat/jnativehook](https://github.com/kwhat/jnativehook)

好像是跨平台的。

这是他们监听按键的示例代码：

```
import org.jnativehook.GlobalScreen;
import org.jnativehook.NativeHookException;
import org.jnativehook.keyboard.NativeKeyEvent;
import org.jnativehook.keyboard.NativeKeyListener;

public class GlobalKeyListenerExample implements NativeKeyListener {
    public void nativeKeyPressed(NativeKeyEvent e) {
        System.out.println("Key Pressed: " + NativeKeyEvent.getKeyText(e.getKeyCode()));

        if (e.getKeyCode() == NativeKeyEvent.VC_ESCAPE) {
            GlobalScreen.unregisterNativeHook();
        }
    }

    public void nativeKeyReleased(NativeKeyEvent e) {
        System.out.println("Key Released: " + NativeKeyEvent.getKeyText(e.getKeyCode()));
    }

    public void nativeKeyTyped(NativeKeyEvent e) {
        System.out.println("Key Typed: " + e.getKeyText(e.getKeyCode()));
    }

    public static void main(String[] args) {
        try {
            GlobalScreen.registerNativeHook();
        }
        catch (NativeHookException ex) {
            System.err.println("There was a problem registering the native hook.");
            System.err.println(ex.getMessage());

            System.exit(1);
        }

        GlobalScreen.addNativeKeyListener(new GlobalKeyListenerExample());
    }
} 
```

检查修饰符是基于位掩码（我们都应该知道但总是忘记的东西：-P）：

```
 boolean isAltPressed = (e.getModifiers() & NativeKeyEvent.ALT_MASK) != 0;
    boolean isShiftPressed = (e.getModifiers() & NativeKeyEvent.SHIFT_MASK) != 0; 
```

这可以与 KeyCode 结合使用：

```
if (e.getKeyCode() == NativeKeyEvent.VK_2 && isShiftPressed && isAltPressed){...} 
```

[这是从这里](http://www.programcreek.com/java-api-examples/index.php?api=org.jnativehook.keyboard.NativeKeyEvent)修改的示例

您还应该修改默认日志记录行为，否则它将向控制台发送垃圾邮件：

```
// Get the logger for "org.jnativehook" and set the level to warning.
Logger logger = Logger.getLogger(GlobalScreen.class.getPackage().getName());
logger.setLevel(Level.WARNING);

// Don't forget to disable the parent handlers.
logger.setUseParentHandlers(false); 
```

代码示例来自[这里](https://github.com/kwhat/jnativehook/wiki/ConsoleOutput)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T19:14:36.573

更新：我不知道您是否可以从 JVM 外部挂钩事件。我认为 Swing/AWT 组件必须有焦点才能工作。

您需要在 Java AWT 事件队列中挂接，以绝对确保您可以获得全局（jvm 范围）按键。

采用

```
EventQueue ev = Toolkit.getSystemEventQueue();
// MyCustomEventQueue extends EventQueue and processes keyboard events in the dispatch
ev.push(new MyCustomEventQueue());

class MyEventQueue extends EventQueue
{
    protected void dispatchEvent(AWTEvent event)
    {
       // all AWTEvents can be indentified by type, KeyEvent, MouseEvent, etc
       // look for KeyEvents and match against you hotkeys / callbacks
    }
} 
```

我认为可能还有其他方法可以使用动作图来完成全局按键操作。我实际上已经使用了上述方法

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-05T09:07:45.230

对于 Windows，您需要一个键盘挂钩 dll。您可以从 java 初始化您的 dll，这将导致它注册侦听器。你会得到你需要的。检查 msdn 是否有 dll 挂钩或键盘挂钩。其中之一应该设置你。

对于 linux，我认为这应该更容易，但我自己从未做过。

[http://ubuntuforums.org/showthread.php?t=864566](http://ubuntuforums.org/showthread.php?t=864566)

Google 的“linux 监听全局按键”（无引号）的第一个结果出现了一些我认为可以帮助您适应 X11 环境的东西

OSX 可能只能使用接近此的解决方案。但最后，您可能需要为每个平台提供一个 dll，除非 JNA 可以毫无问题地做到这一点，否则最坏的情况已经过去。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-13T17:59:47.340

JDIC（Java 桌面集成）可以帮助
**[https://jdic.dev.java.net/](https://jdic.dev.java.net/)**

对我来说似乎有点无人维护。我不知道。
如果有人知道更多，请报告！
我对这个功能也很感兴趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-07-14T16:09:04.930

您现在可以使用 JNA - 请参阅[https://github.com/tulskiy/jkeymaster](https://github.com/tulskiy/jkeymaster)

我已经在 Windows 10 笔记本电脑上轻松完成了这项工作——我没有在其他平台上亲自测试过——显然它也适用于 MacOS 和“基于 X11 的系统（理论上，只在一些 Linux 发行版和 PCBSD 上测试过）” .

设置起来应该不难——你需要 slf4j 让它运行。

您不需要构建 jar。

例如，此代码有效地禁用了“f”键并记录了您按下它的事实。

```
import com.tulskiy.keymaster.common.Provider;
import com.tulskiy.keymaster.common.HotKeyListener;
import com.tulskiy.keymaster.common.HotKey;
import javax.swing.*;

// ...          

Provider provider = Provider.getCurrentProvider(false); 
    provider.register(KeyStroke.getKeyStroke("F"), new HotKeyListener() {
            public void onHotKey(HotKey hotKey) {
                System.out.println(hotKey);
            }
        }); 
```

我希望这可以帮助别人

# apache - IIS7 中的通配符子域。是否有可能使它们像在 Apache 中一样？

> ID：458757
> 
> 赞同：30
> 
> 时间：2009-01-19T19:08:29.893
> 
> 标签：apache, iis-7, subdomain, wildcard

这是否可以配置 IIS7 以实现与 Apache 有关通配符域的相同功能？我对基于 URL 中使用的子域用户在 ASP.NET Web 应用程序中路由用户感兴趣。

这里描述了类似的东西：

[http://steinsoft.net/index.php?site=programming/articles/apachewildcarddomain](http://steinsoft.net/index.php?site=programming/articles/apachewildcarddomain)

谢谢

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-14T00:39:03.890

答案是否定的，IIS7（仍然）不支持通配符主机名（请参阅[this](http://dirk.net/2008/05/28/wildcard-host-header-binding-and-subdomains-with-iis7/)）。如果您想在一个网站上服务多个域，目前唯一的解决方法，正如 notandy 建议的那样，是使用专用 IP 并使用支持通配符的 DNS 来实现。

### 2013 更新

为了完整起见，IIS8 还没有这个特性。

### 2016 更新

最后，Windows 2016 中的 IIS 10 支持通配符子域。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-06T00:13:29.690

> IIS 是否支持通配符主机头？我可以捕获 *.mydomain.com 并将其重定向到一个网站吗？

答案是是/否。是的，因为您可以将 *.mydomain.com 重定向到一个网站。不，因为神奇在于 DNS 而不是 IIS。

操作方法如下：
在 IIS MMC 中，配置一个没有主机标头的网站，然后为该站点分配一个 IP 地址。（如果您在框中有一个 IP 地址，则可以跳过此步骤）。有了这个，网站将绑定到特定的 IP 并监听所有发送到 IP 的 HTTP 请求，你就完成了:)

下一步是确保您的名称解析适用于通配符查询并使用正确的 IP 地址进行回复。如果您使用 Microsoft DNS 服务，它将不允许您创建 '*' A 记录（假设您已经在 DNS MMC 中创建了域区域），您需要执行以下操作：

1.  导航`%windir%\system32\dns\`
2.  找到区域文件。例如
    mydomain.com.dns，用记事本打开
3.  添加条目。例如
    `* A IP.IP.IP.IP`
4.  保存区域数据文件
5.  在 DNS MMC 中重新加载区域数据。

请注意，通过这样做，所有 * 都会响应您之前配置的 IP。例如 abc.mydomain.com、www.mydomain.com、K2k.mydomain.com 等。

要验证它是否正常工作，请尝试 ping 实用程序`ping (insert anything here).mydomain.com` ，您应该会收到来自 IP.IP.IP.IP 的回复

然后尝试浏览 http://（在此处插入任何内容）.mydomain.com/，您应该获得与配置相同的网页。

[来源](http://web.archive.org/web/20120301164607/http://msmvps.com/blogs/bernard/archive/2005/03/22/39218.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-23T14:19:34.390

您不能在 Microsoft 的 DNS 中创建通配符 (*) A 记录，但*可以*创建通配符`CNAME`。如果您要做的只是将所有子域定向到特定 IP，这将起作用。例如，如果您有 的 A 记录`www.mydomain.com`，您可以添加 的`CNAME`记录`*.mydomain.com`并将其指向`www.mydomain.com`。请求标头中的主机名仍将是子域，因此您的 Web 应用程序应该能够根据需要捕获并处理它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-14T18:57:09.840

如果您使用 Web 平台安装程序 ( [http://www.microsoft.com/web/downloads/platform.aspx](http://www.microsoft.com/web/downloads/platform.aspx) ) 并安装“URL 重写”模块，则可以使用 IIS。如果您添加“*.example.com”之类的“A”记录，这将允许将所有子域发送到您的 IIS 服务器。在 IIS 服务器中，您只需将 URL 重写规则添加到默认网站即可执行您想做的任何事情，例如重定向到另一个 URL。当用户输入“xyz.example.com”时，您可以重定向到“example.com”，并将所有未知子域指向根域。步骤是：

1.  安装 Web 平台安装程序：http: [//www.microsoft.com/web/downloads/platform.aspx](http://www.microsoft.com/web/downloads/platform.aspx)

    运行它，搜索“URL Rewrite”，然后安装它。

2.  转到默认网站，然后打开“URL 重写”。

3.  单击最右侧的“添加规则”。

4.  命名规则并设置以下内容：

    请求的 URL：匹配模式

    使用：正则表达式

    图案： （。*）

    逻辑分组：匹配所有

5.  添加新条件（单击“添加..”按钮），并设置：

    条件输入：{CACHE_URL}

    检查输入字符串是否：匹配模式

    模式（根据需要修改）：(http|https)://(.*?)\.rootdomain\.tld

    单击[确定]。

6.  现在向下滚动到操作并设置：

    操作类型：重定向

    重定向 URL（根据需要修改）：{C:1}://rootdomain.tld{R:0}

当您单击正则表达式模式条目旁边的“测试模式”按钮时，“{C:#}”和“{R:#}”来自测试窗口。您可以匹配服务器值的一部分并在以后重用它。

此外，您可能需要查看有关在 URL 中传递 HTTP/HTTPS 的提示（上面第 6 步中的“{C:1}”）：[http ://weblogs.asp.net/owscott/url-rewrite-协议-http-https-in-the-action](http://weblogs.asp.net/owscott/url-rewrite-protocol-http-https-in-the-action)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-22T23:06:29.087

更新 2：链接断开，升级到 IIS 10，它现在支持通配符。

更新：这工作了一段时间，一段时间后，我被多个请求轰炸了。我不会推荐这种方法。

确保您的 DNS 记录设置正确（*->@ 的 CNAME 记录），它将完美运行。使用多个域进行测试。

链接已损坏，以前是 [http://pzxc.com/apache-style-wildcard-hostname-rewrite-rules-in-iis](http://pzxc.com/apache-style-wildcard-hostname-rewrite-rules-in-iis)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-18T00:39:53.917

对于无法升级到 IIS 10+ 的用户，通过反向代理启用通配符主机名支持并不是很困难。

HTTP 示例如下，而其他设置只是几个步骤。

1.  创建一个绑定到 *:80 且没有主机名的包罗万象的站点。
2.  创建绑定到 *:8091 且没有主机名的第一个站点。
3.  创建绑定到 *:8092 且没有主机名的第二个站点。
4.  测试两个站点并继续前进。
5.  安装 ARR 和 URL 重写模块。
6.  在包罗万象的站点上创建重写规则以将请求发送到两个站点，

    ```
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="site1" stopProcessing="true">
                    <match url=".*" />
                    <conditions>
                        <add input="{HTTP_HOST}" pattern="^(.*).site1.com$" />
                    </conditions>
                    <action type="Rewrite" url="http://localhost:8091/{R:0}" />
                </rule>
                <rule name="site2" stopProcessing="true">
                    <match url=".*" />
                    <conditions>
                        <add input="{HTTP_HOST}" pattern="^(.*).site2.com$" />
                    </conditions>
                    <action type="Rewrite" url="http://localhost:8092/{R:0}" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer> 
    ```

> 请注意，在服务器级别，ARR 代理模式必须打开，

```
 <system.webServer>
        <proxy enabled="true" />
    </system.webServer> 
```

> IIS 10 通配符主机名更简单，性能也更好，因为 ARR 有它的开销（但一般来说可以忽略不计）。

# svn - 如何使用 AnkhSVN 2.x 更改存储库 url

> ID：458791
> 
> 赞同：4
> 
> 时间：2009-01-19T19:18:53.943
> 
> 标签：svn, ankhsvn

我在 VS 2008 上使用 Ankh v2.0.5250.202 连接到我的 Subersion 服务器（VisualSVN 服务器 1.6.3）

我的存储库的当前 url 是[https://svnserver:8443/svn/foo/foo/trunk/](https://svnserver:8443/svn/foo/foo/trunk/)我想切换到[https://svnserver:6002/svn/foo/foo/trunk/](https://svnserver:6002/svn/foo/foo/trunk/)

我正在使用“切换到”工具在“待更改”窗口中的 url 栏右侧选择一个新的 URL。

不幸的是，当我选择新的 url 时，我收到一条错误消息，指出 **“ [https://svnserver:8443/svn/foo/foo/trunk ”与“](https://svnserver:8443/svn/foo/foo/trunk) [https://svnserver:6002/svn/foo](https://svnserver:6002/svn/foo) ”不是同一个存储库'**

我试过输入' [https://svnserver:6002/svn/foo](https://svnserver:6002/svn/foo) ', ' [https://svnserver:6002/svn/foo/foo](https://svnserver:6002/svn/foo/foo) ', ' [https://svnserver:6002/svn/foo/foo /trunk](https://svnserver:6002/svn/foo/foo/trunk) '，但我总是遇到同样的错误。

有解决办法吗？还是我可以手动编辑的配置文件？（我没有找到这样的配置文件）

注意：在服务器端，我只是更改了服务器端口，而没有触及其他任何东西。我可以使用存储库浏览器浏览存储库，所以我认为问题出在客户端。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T22:32:23.413

在 AnkhSVN 的日常构建中（以及自 2009 年 3 月起的稳定版本），Switch 命令将为您处理这种情况。

AnkhSVN 将检测到存储库根不匹配，然后它会询问您是否要重新定位。

有关每日构建，请参见[http://ankhsvn.net/daily/](http://ankhsvn.net/daily/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T20:32:28.663

“switch”命令是错误的使用命令！

您必须使用“重新定位”命令。不确定AnkhSVN是否有这个。

对于 svn 客户端，您必须使用

```
svn switch --relocate FROM TO [PATH...] 
```

（是的，它是“开关”命令，但仅在 UI 方面 - 在内部，重定位使用与开关完全不同的 API）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-12T19:22:12.493

我在使用 AnkhSVN 和 subversion 时遇到了很多麻烦。

我有一个非常简单的想法，可以将解决方案切换到另一个存储库。这看起来很奇怪，但它确实有效。

首先，您必须从当前项目中导出模板。现在使用您自己的模板创建新解决方案，然后将新解决方案添加到新的颠覆目录并从 MyDocuments 中删除您的模板。就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T19:27:50.260

啊啊啊，好痛 很长一段时间我都遇到了类似的问题，但我仍然对如何让它发挥作用感到有些不安。我的回答可能不适用（我希望它有所帮助）。

尝试清除隐藏在项目目录中的 SVN 文件夹...看看[这个问题](https://stackoverflow.com/questions/224430/xcopy-asp-net-deployment-of-a-subversion-managed-project)。如果您不知道如何清除隐藏的 SVN 文件夹，最后一个答案有一个很好的方法（警告，它需要调整注册表）。

完成此操作后，您应该能够更改存储库。不幸的是，我找不到任何要手动编辑的配置文件。

# c++ - 友元模板函数（在非模板类中），C++

> ID：458795
> 
> 赞同：4
> 
> 时间：2009-01-19T19:19:38.890
> 
> 标签：c++, function, templates, friend

如果我有一个非模板（即“普通”）类并希望有一个模板友元函数，我该如何编写它而不导致编译器错误？这是一个示例来说明我正在尝试做的事情：

```
template <class T>
void bar(T* ptr);

class MyClass  // note that this isn't a template class
{
private:
    void foo();

    template <class T>
    friend void bar(T*);  // ERROR: compiler gives me all kinds of grief
};

template <class T>
void bar(T* ptr)
{
    if (ptr)
    {
        MyClass obj;

        obj.foo();
    }
} 
```

我正在使用 Visual Studio 2005，我得到的具体错误是[error C2063](http://msdn.microsoft.com/en-us/library/w7h7cw3t(VS.80).aspx)，指出“bar”不是函数。这里需要做些什么不同的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T19:46:36.120

您确定您发布的内容会导致错误吗？以下（使用 Visual Studio 2005）对我来说很好：

```
#include <iostream>
template <class T>
void bar(T* ptr);

class MyClass  // note that this isn't a template class
{
private:
    void foo();

    template <class T>
    friend void bar(T*);  // ERROR: compiler gives me all kinds of grief
};

void MyClass::foo()
{
    std::cout << "fooed!" << std::endl;
}

template <class T>
void bar(T* ptr)
{
    if (ptr)
    {
        MyClass obj;

        obj.foo();
    }
}

int _tmain(int argc, _TCHAR* argv[])
{

    int someObj = 1;
    bar(&someObj);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T19:37:27.107

这更像是一种解决方法而不是修复，但是您是否尝试将专业列为朋友？

# air - Adobe Air - 值得大肆宣传？

> ID：458797
> 
> 赞同：4
> 
> 时间：2009-01-19T19:19:49.637
> 
> 标签：air

最近有很多关于 Adob​​e Air 的兴趣和炒作。它值得这样做吗？在这个领域，Adobe 是否有任何有价值的竞争对手？我使用的唯一 Adob​​e Air 应用程序是 TweetDeck .. 虽然我不喜欢它，但这可能更像是一个 UI 设计/可用性问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T20:04:46.380

**一个代码库，多个平台。**

Flex/Air 正在兑现 Java 在 10 到 15 年前的承诺。

许多公司使用 Java 制作了自己的 Java 运行时，并且平台之间的事情变得不兼容。微软已经回复了他们的 WPF/Silverlight，它是有能力的，但在很多方面它没有 Flash 10 多年的富媒体历史。

What is remarkable about Air / Flex is that it truly provides the same experience on multiple platforms in a way very little has. The penetration of the Flash Player is as ubiquitous as the web browser. No need to install a 40 mb .net runtime, or a java download, or approve this or that. It just works. The recent open sourcing of flex/flash standards has been inviting as well.

I think Air could prove to be a breakthrough technology. Adobe can quietly and capably provide a complete desktop experience (ala www.buzzword.com) in the browser without the AJAX battle that google docs had to go through.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T19:48:25.570

I've been programming with Flex, and it feels a bit like Java to me... you can run anywhere, and do fairly serious work, as long as you don't mind running on a virtual machine that doesn't tightly integrate with the native capabilities of your platform.

It does do a fantastic job of making the developer's tools somewhat familiar to those who do web work... using CSS to control the look of your app; only this CSS really does what you tell it to without having to deal with browser issues (IE6, I'm looking at you.)

You can integrate with Flash assets in a beautiful way, and programmatically do just about anything that you see a flash widget do... transitions, special effects, etc are all at your disposal.

您可以使用容器的布局来安排您的小部件，并避免 Flash 使用所有可能使用的最小字体的感觉，这样它就不必滚动（或者出于任何原因，Flash 人们喜欢小字体。）

我认识的大多数使用过 Flex / Air 的开发人员都认为这真是太棒了。我认为 Actionscript3 要提供与 Python 相媲美的容器等基本要素还有很长的路要走。或者与您的本地操作系统和设备驱动程序集成的能力......

但真正奏效的是，Adobe 对浏览器的渗透非常好，而 Flex 是程序员编写 Flash 应用程序的好方法，而且这些应用程序也可以在桌面上运行是一个巨大的优势。由于 Adob​​e 充分涵盖了所有基础，因此它们将继续成为软件开发的一个不错的决定。（只要您不必与操作系统紧密集成，或在 iPod Touch 上运行等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T19:23:34.917

同样，在 Microsoft World 中，Windows Presentation Foundation (WPF) 受到了很多炒作，并且开始越来越多地渗透到现实世界的项目中。

至于围绕“Air”的炒作是否合理，我认为你必须自己看看它并做出自己的判断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T19:24:01.330

我觉得它不值得大肆宣传。我想我有点偏见，我并不真正关心 Adob​​e 产品（我觉得它们臃肿、缓慢，而且很丑）。但这只是我 - 每个人都有自己的:-)

在我看来，Silverlight 是一个很大的竞争对手，我更喜欢它（尽管它有一些我认为微软不应该在 2.0 中发布的错误）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T19:27:45.893

我实际上不这么认为......我相信目前可能的用户只是对它的工作原理和它有什么好处感到困惑。但这可能会改变。越来越多的开发人员会为 AIR 编写应用程序，并且用户可能会接受它。

我很高兴看到 Silverlight 有竞争对手，因为一如既往：竞争对企业有利。

一些有用的信息： [http ://www.webglossary.co.uk/article-what-is-adobe-air.asp](http://www.webglossary.co.uk/article-what-is-adobe-air.asp)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T19:35:48.997

我也没有对我使用过的大多数 Air 应用程序印象深刻。[Balsamiq Mockups](http://www.balsamiq.com/products/mockups)是一个明显的例外。使用它是一种很好的体验，我正在重新审视 Air。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T19:43:01.667

作为一名使用许多标准技术（Win32、MFC、Java、.NET 等）开发桌面应用程序并使用“AJAX”技术（HTML、CSS、JavaScript 等）开发 Web 应用程序的程序员，我无法想象为什么会有人想通过使用 Web 技术来构建桌面应用程序来折磨自己。Web 技术堆栈是在具有一组特定目标（例如，Web 浏览器、可移植性、瘦客户端、无需安装等）的异常受限的环境中发展的。这是一个无法理解的混乱，缺乏全面的深谋远虑或设计。对于非工程师来说，这甚至都不是“容易”的。那么 --- 为什么选择空气？

# sql - Linq to SQL 没有错过重点吗？ORM-mappers（SubSonic 等）不是次优解决方案吗？

> ID：458802
> 
> 赞同：68
> 
> 时间：2009-01-19T19:23:34.607
> 
> 标签：sql, linq-to-sql, linq-to-entities

我希望社区了解我对 Linq to Sql 和其他 ORM 映射器的一些想法。

我喜欢 Linq to Sql 以及用您的本地开发语言表达数据访问逻辑（或一般的 CRUD 操作）的想法，而不是必须处理 C# 和 SQL 之间的“阻抗不匹配”。例如，要为业务层返回与 ObjectDataSource 兼容的 Event 实例列表，我们使用：

```
return db.Events.Select(c => new EventData() { EventID = c.EventID, Title = c.Title }) 
```

如果我要使用旧的 SQL-to-C# 结构来实现它，我必须创建一个 Command 类，添加 EventID 参数（使用字符串来描述“@EventID”参数），将 SQL 查询字符串添加到命令类，执行命令，然后使用 (cast-type)nwReader["FieldName"] 提取每个返回的字段值并将其分配给我的 EventData 类的新创建实例的成员 (yuck)。

所以，*这*就是人们喜欢 Linq/SubSonic/等的原因。并且我同意。

然而，从更大的角度来看，我看到了许多错误的事情。我的感觉是微软也看到了一些错误，这就是为什么他们正在[杀死 Linq to SQL](http://codebetter.com/blogs/david.hayden/archive/2008/10/31/linq-to-sql-is-dead-read-between-the-lines.aspx)并试图将人们转移到 Linq to Entities。只是，我认为微软正在*加倍下注。*

那么，有什么问题呢？

问题是有些[架构宇航员](http://www.joelonsoftware.com/articles/fog0000000018.html)，尤其是在微软，他们看到 Linq to Sql 并意识到它不是一个真正的数据管理工具：仍然有很多事情你不能轻松地在 C# 中轻松完成，他们的目标是*修复它.* [您可以在 Linq to Entities 背后的雄心壮志、关于 Linq革命性](http://blogs.msdn.com/adioltean/archive/2005/09/13/465471.aspx)的 博客文章甚至是[LinqPad 挑战](http://www.linqpad.net/Challenge.aspx)中看到这一点。

问题*在于*它假设 SQL 是问题所在。也就是说，为了减少轻微的不适（SQL 和 C# 之间的阻抗不匹配），微软提出了相当于太空服（完全隔离），而创可贴（Linq to SQL 或类似的东西）就可以了。

据我所知，开发人员非常聪明，能够掌握关系模型，然后在他们的开发工作中智能地应用它。事实上，我会更进一步地说，Linq to SQL、SubSonic 等*已经太复杂*了：学习曲线与掌握 SQL 本身并没有太大区别。由于在可预见的未来，开发人员*必须*掌握 SQL 和关系模型，我们现在面临学习*两种*查询/CRUD 语言。更糟糕的是，Linq 通常很难测试（你没有查询窗口），将我们从我们正在做的实际工作中移除了一层（它生成 SQL），并且对 SQL 结构（充其量）非常笨拙的支持，例如日期处理（例如 DateDiff）、“Having”甚至“Group By”。

什么是替代方案？就个人而言，我不需要像 Linq to Entities 这样的数据访问模型。我更喜欢简单地在 Visual Studio 中弹出一个窗口，输入并验证我的 SQL，然后按一个按钮生成或补充一个 C# 类来封装调用。既然您已经了解 SQL，您是否更愿意只输入如下内容：

```
Select EventID, Title From Events Where Location=@Location 
```

并最终得到一个 EventData 类，A) 包含 EventID 和 Title 字段作为属性，B) 有一个工厂方法，该方法将“Location”字符串作为参数并生成 List<EventData>? 您必须仔细考虑对象模型（上面的示例显然没有处理该问题），但在消除阻抗不匹配的同时仍然使用 SQL 的基本方法对我很有吸引力。

问题是：我错了吗？微软是否应该重写 SQL 基础架构，以便您不必再学习 SQL/关系数据管理？ *他们能*以这种方式重写 SQL 基础架构吗？还是您认为在 SQL 之上的一个非常薄的层来消除设置参数和访问数据字段的痛苦就足够了？

**更新**我想将两个链接推广到顶部，因为我认为它们抓住了我所追求的重要方面。首先，CodeMonkey 指出了一篇题为[“计算机科学的越南”的文章。](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx) 开始需要一段时间，但读起来非常有趣。其次，AnSGri 指出了 Joel Spolsky 最杰出的作品之一：[泄漏抽象法则](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)。它不完全是主题，但它很接近并且是一本很好的读物。

更新 2：我已经给 ocdecio 提供了“答案”，尽管这里有很多很好的答案，而“正确”答案的选择纯粹是主观的。在这种情况下，他的回答与我认为在当前技术状态下真正的最佳实践相一致。然而，这是一个我完全期望发展的领域，所以事情很可能会发生变化。我要感谢所有做出贡献的人，我投票给了我认为给出了深思熟虑的答案的每个人。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-19T19:37:20.647

让我先说我是一个彻头彻尾的数据库专家。

***作为一个粗略的概括***：开发人员不知道 SQL。开发人员并不真正*想*了解 SQL。他们可以写，他们可以设计表格，但这让他们感到恶心。当必要的查询不仅仅是一个简单的连接时，他们往往会做一些愚蠢的事情。不是因为开发人员很愚蠢——因为他们不会被打扰。他们*喜欢*生活在一个只需要处理一个概念空间的世界里；从对象到表再返回是上下文切换，他们不喜欢为此付出代价。

这并不意味着它们是坏的或错误的。这意味着有改进的机会。如果您的客户（在这种情况下，是使用您的框架的开发人员）不喜欢 SQL 和表 - 给他们一个抽象层，让他们无需处理底层混乱即可摆脱困境。

垃圾收集/自动内存管理大受欢迎的逻辑相同。是的，开发人员可以处理它；是的，没有它，他们可以编写更好优化的代码；但不必处理它会让他们更快乐，更有效率。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-01-19T19:28:31.787

我认为 ORM 的流行是由开发数据层的开发人员在一个又一个应用程序中一遍又一遍地编写相同的 CRUD 代码而产生的。ORM 只是另一种工具/技术，它可以让开发人员花费更少的时间一遍又一遍地编写相同的 SQL 语句，而是专注于应用程序的逻辑（希望如此）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-01-19T19:35:45.143

至少 6 年来，我一直在使用自己的 ORM，它基于一个非常简单的概念：投影。每个表都被投影到一个类中，并根据类定义动态生成 SQL。它仍然需要我了解 SQL，但它可以处理 90% 的简单 CRUD，而且我不必管理连接等 - 它适用于主要的数据库供应商。

我对我所拥有的感到满意，并且没有发现任何值得放弃的东西。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-19T22:23:58.283

恕我直言，OR/M 不仅仅是关于“抽象 SQL”或隐藏 SQL，或启用多 DBMS 支持。

它使您能够将更多精力放在您的问题域上，因为您不必花费更少的时间编写无聊的 CRUD SQL 查询。另一方面，如果您使用了良好的 OR/M，则此 OR/M 应该使您能够编写 SQL 查询（如果这似乎是必要的）。

如果使用得当，OR/M 可以成为一个强大的工具；它可以处理延迟加载、多态查询/关联......
不要误会我的意思；纯 SQL 没有任何问题，但是，如果您必须小心地将（经过深思熟虑和规范化的）关系模型转换为富有表现力的 OO/域模型，那么我认为您正在花费大量时间进行管道工程。

使用 OR/M 也不意味着您（作为开发人员）不应该了解 SQL。相反是真实的恕我直言。
了解 SQL 并知道如何编写高效的 SQL 查询，这将使您能够正确使用 OR/M。

我还必须承认，我在写这篇文章时考虑到了 NHibernate。这是我正在使用 atm 的 OR/M，我还没有使用 Linq to SQL 或 Linq to entity。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-19T21:18:40.990

Linq 的设计和 linq to entity 框架当然可以用作 orm 工具，但主要的想法是它将用作查询任何数据源的通用 api，而不仅仅是 RDBMS 的。

我记得读过 linq，虽然显然设计时考虑了 SQL，但它旨在成为任何数据存储的查询语言。您可以为 SQL 编写 linq 查询，但理论上您也可以编写针对 ldap、文件系统、交换、Web 服务、无限期的 linq 查询。您不能将 SQL 用于这些程序。

您还需要为几乎每个数据存储学习不同的 API。Linq 为每个人提供了创建数据访问 API 的共同目标。

这个愿景是否有效还有待观察，但这就是想法。我认为随着我们希望系统越来越多地互操作，我们可能会发现 l2e 有一些非常好的用途。

如果我能再次找到它们，我会添加一些参考。

[http://laribee.com/blog/2007/03/17/linq-to-entities-vs-nhibernate/](http://laribee.com/blog/2007/03/17/linq-to-entities-vs-nhibernate/)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-01-19T19:37:53.953

我同意 100%。这在很大程度上是因为程序编码技能和 SQL 编码技能非常不同。而这一事实并未得到广泛承认。因此，在实现这一目标之前，程序员会寻找使他们的技能从一个领域转移到另一个领域的方法。

它不起作用。

您只需要学习如何相移：学习如何根据您正在处理的领域以不同的方式思考您的代码。

有没有其他人注意到查询从 SQL 映射到 LINQ 时变得多么复杂和冗长？就像，在所有在线示例中？

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-01-19T19:54:53.107

你应该停止担心，学会爱上 ORM。诸如此类的抽象将帮助我们集中我们的技能并在该领域取得进步。

仍然有足够的空间来利用您获得的功能技能并将它们应用到应用程序层。这实际上是 LINQ to SQL 优于其他 ORM 的优势之一。

我只能同意其他许多评论。节省的时间，您可以专注于改进您的领域模型并制作更好的应用程序。而且，一旦您确定了瓶颈，就可以使用它来创建优化的 SQL。

可能不会立即明显的是，ORM 带有许多非常好的特性。有助于避免反复加载项目的身份映射，延迟加载可帮助您以更少的管道表达域，工作单元可帮助您跟踪更改并优化数据库写入。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-01-20T05:14:41.510

正如 Dmitriy[指出的那样](https://stackoverflow.com/questions/458802/doesnt-linq-to-sql-miss-the-point-arent-orm-mappers-subsonic-etc-sub-opti#458860)，开发人员不了解 SQL。更准确地说，大多数人*知道*SQL，但不*理解*它，绝对不喜欢它，所以他们倾向于寻找灵丹妙药，创造对 Linq 之类的东西的需求，以制造他们不知道的错觉（嗯，抽象）不要使用与他们心爱的课程不同的任何东西。

这是非常糟糕的，因为[泄漏抽象定律](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)总是成立的。

一些 ORM 解决方案确实很好（例如 JPA/Hibernate），并不是因为使用它们您不必担心 SQL。事实上，要有效地使用 JPA，您通常需要对 DB 有非常深入的了解，尤其是查询能力。好处是它们*让机器完成无聊的工作*，以至于它从头开始自动生成整个数据库。

我认为，Linq to SQL 并不能解决真正的问题。这是一种其他的演示，仅此而已。这可能很好，尽管它使已经很复杂的语言过于复杂。另一方面，Linq to Objects 是一个非常有趣的概念，因为它是一种 sql 查询集合。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-19T19:51:52.223

历史的角度。

当科德等人。人。最初是在研究关系数据库的理论和实现，一个完全独立的问题是“我们如何查询这些东西”？提出了许多策略和语法，具有各种优点和缺点。其中一个候选者是 SQL（显然是其最早的形式）。另一个是 QBE（按示例查询）。我相信另一个叫“quel”；还有其他几个。SQL 当然没有成为主导，因为它被认为优于所有其他方法。不幸的是，其他人几乎消失了，我们所有人都很贫穷（因为它们可以同时用于相同的数据。）

如果微软有一个很好的故事，他们正在复兴其中一种其他语言，或者发明了一个有价值的补充，那么我认为我们最好听听。但到目前为止，我所看到的只是另一个“统治他们所有人的戒指”。

SQL 背后有大量的思考和严谨，以及大量经过时间证明的耐用性。微软有一定的历史，相信他们公认的顶级开发组织可以超越我们其他人，包括我们集体的机构记忆。它似乎并不经常以这种方式工作。只要我们绑定到关系数据存储，我们就应该三思而后行，超集抽象范式使我们远离裸机，并承诺提供相同或更好的性能。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-19T21:07:11.557

作为我自己的一个 ORM 项目的作者，我不得不承认我对这样一个问题的回答可能有点偏颇。在阅读问题之前，我已经对答案产生了一些自己的想法，所以我已经有点锚定了。

我会说，我开发 ORM 的原因不是因为 SQL 和命令式编程之间的“阻抗不匹配”，而仅仅是为了与数据库平台无关。必须编写更多代码来管理持久性的前一个问题是一个小障碍，如果您只与一个数据库供应商合作，则很容易解决。成为数据库平台不可知论是一个更具挑战性的问题，假设您像我一样计划向其他人出售软件（并且不仅仅是在内部使用它），那么 imo 对您的业务盈利能力的影响要大得多。

几年前，当我开始使用我的 ORM 工具时，这个概念在我喜欢的语言中是不切实际的，与我交谈的大多数人都不明白我为什么要这样做，社区中一些受人尊敬的声音与书面文章一样多在贸易杂志上说我已经做过的不仅不可能而且不受欢迎。给出了一些相同的原因——它太复杂了，它受到限制并且增加了开销。今天，同一个社区至少拥有三种流行的数据库抽象工具（尽管关于 ORM 一词的定义存在一些争论）。我之所以提到这一点，是因为当我开始研究这些工具时，最初的反对意见比现在要重要得多。近年来，硬件和软件的基础技术发生了变化，从长远来看，这些工具更加实用。我的倾向是尝试从长远角度看待软件，并致力于解决可能还不太实用但很快就会变得实用的解决方案。因此，鉴于我不会将 LINQ to Entities 视为某些问题的良好解决方案。

我也倾向于选择更多而不是更少。因此，虽然我可能支持开发 LINQ to Entities 背后的想法，但我不太倾向于仅仅因为 LINQ to Entities 已经可用而支持终止 LINQ to SQL。对象非常适合做对象所做的事情，这是毫无疑问的......在我（再次有偏见）看来，问题出现在人们将任何给定的工具或软件范例视为“灵丹妙药”并坚持一切一定是这样。众所周知，关系数据库非常擅长处理某些其他任务，报告就是一个很好的例子。所以在我看来，坚持一切都必须是实体是一种自取其辱的做法，因为这样你就强迫自己使用效率低下的工具来完成这项工作。因此，特别是在报告方面，[抽象反转](http://en.wikipedia.org/wiki/Abstraction_inversion)反模式。

所以我想我的答案的概要是这样的：如果您的问题是钉子，请使用锤子 - 如果您的问题是螺丝刀，请使用螺丝刀。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-01-25T02:28:25.277

Dmitry 关于开发人员不喜欢 SQL 的说法可能有很多道理，但解决方案不仅仅是 ORM。解决方案是聘请开发 DBA 作为开发团队的一部分。在我的公司中，我的 .net 开发团队有一位出色的 Oracle DBA，他完全不从事任何生产 dba 工作。他在我们团队中的角色是数据建模、物理数据库设计、创建存储过程、数据分析等。他是我们的数据库端如此干净和执行的原因。我们所有的数据库访问都是通过存储过程。

什么是开发 DBA？ [http://www.simple-talk.com/sql/database-administration/what-use-is-a-development-dba/](http://www.simple-talk.com/sql/database-administration/what-use-is-a-development-dba/)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-01-19T20:55:02.863

我同时进行数据库和分布式应用程序编程（Web 和编译），并且觉得花时间开发基于存储过程的数据访问层是值得的。就个人而言，我更喜欢在开发过程的早期进行数据建模并确定所需的过程......似乎有助于发现设计/接口逻辑/结构问题。

我不是内联数据库编程的忠实粉丝（无论 sql 代码是手工生成的还是机器生成的）。我相信数据库是一个应用程序的基础，花时间手动编写存储过程是值得的。

也就是说，我对 OODBMS 概念很感兴趣，并希望有一天我能在生产环境中进行一些工作。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-25T01:57:26.273

如果您希望数据库在扩展时执行，则必须根据数据库关系模型最佳实践对其进行设计和规范化。

如果您让对象模型和 ORM 决定您的数据模型，那么您最终会得到一个没有规范化和/或包含来自对象模型的工件的糟糕数据模型。

1 table = 1 class 是个坏主意。

首先，永远不会有代表多对多或多对一链接表的类。这些对应于对象模型中的子集合——链接本身不是对象。

如果你把你的数据库当作表来简单地把你的对象保存在行中（一种常见的方法）并让应用程序直接访问表，你就放弃了定义数据库可以用来保护的数据库服务接口层的所有好处它的周长。

ORM 有它们的位置，但是如果您使用它们来简单地保存对象模型中设计的对象，那么您的数据库将不是关系数据库，并且它不能用作 ETL、报告、重构等

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-01-19T19:31:12.920

我不喜欢任何当前的解决方案——但我更喜欢更多的选择而不是更少的选择；-)

我很久以前在一个项目中使用了一个 OODBMS，这是最接近正确的（不幸的是，该产品有一些令人发指的错误和糟糕的技术支持） - 对象持久性在很大程度上是*不可见*的，在幕后处理（通过预处理器代码生成器）和控制通过非常简单的 Update、Delete 和 Find 方法和简单的容器。

我很想再次看到这一点（也许某些对象实体模型已经做得很好），使用 OCL（对象约束语言）作为本机多对象查询语言

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-01-19T19:36:45.703

我认为这些事情背后的逻辑是，与系统其他部分的开销相比，在框架层构建和运行 SQL 语句的开销是微不足道的（例如，HTTP 请求往返时间要长几个数量级）。

优点 - 快速开发，适合语言而不是转义字符串的查询等，通常超过缺点。如果性能是一个问题，那么您可以稍后进行优化。

我不认为“不需要知道 SQL”是一个因素。任何体面的开发人员都需要在其开发的某个阶段了解 SQL。数据库抽象层的想法是消除为数据库查询生成样板代码的工作。

事实上，在我们的 Java 系统中，我创建了一个代码生成器实用程序，它采用带注释的类并生成一个完整的 CRUD API，并处理您随着时间的推移而获得的所有那些古怪的东西。创建模型并对其进行注释比费力地编写 DAO 容易得多。扩展这样的工具，您最终会得到 LINQ 或 Hibernate 或无数其他 ORM DB 解决方案。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-01-19T19:37:41.287

这里还有[一个](https://stackoverflow.com/questions/18655/why-do-we-need-entity-objects)关于 ORM 的问题。查看更多关于阻抗不匹配是否与所有这些一样重要的讨论。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-01-19T19:37:44.343

我认为他们需要的真正解决方案更像是 SQL 文字。VB.Net 9.0 支持[XML Literals](http://msdn.microsoft.com/en-us/library/bb384563.aspx)，它允许您在代码中直接编写 XML，并确保它经过验证并符合 DTD。一个类似的好功能是 SQL 文字，它允许您在 .Net 代码中编写内联 SQL 代码，并通过 IDE 对其进行验证。需要某种插件架构来根据数据库验证信息，但这可以很容易地为流行的数据库引擎编写。这将为他们试图解决的问题提供我认为真正的解决方案，而无需求助于次优解决方案。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-01-20T00:29:00.463

Codemonkey 提出了一个很好的观点：存储过程提供了一定程度的抽象，可以实现更复杂的 ORM 模型的一些承诺。乍一看这并不直观，但我可以直接从我自己的代码中想到一个示例。我有一个“签到”存储过程，它涉及近十几个表（此 ID 属于谁？他们有会员资格吗？有任何消息吗？他们是否为此签到获得积分？等等）。

在 C# 中对此进行建模 - 无论数据模型多么复杂 - 都不是一个好主意，因为它需要多次“通过网络”检查数据和更新各种表。虽然您确实可以在 Linq 或其他 ORMS 中处理存储过程，*但我所需要*的只是一个允许我使用标准 C# 参数调用存储过程的包装类。事实上，这对我来说是如此迫切，以至于我用 T-SQL 编写了一个代码生成器来创建这样的包装器。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-01-19T20:11:07.507

我不得不同意，ORM 工具的爆发很大程度上源于编写 SQL、处理必须使用的任何 DB 驱动程序、在 DB 之间进行内部抽象（Oracle 与 SQL Server，与代码可重用性的任何东西）以及转换数据类型的烦恼.

理想的解决方案？绝对不是！但是，我认为这是更好地将应用程序与数据存储合并的过程中的一次迭代。毕竟，在大多数情况下，拥有一个没有使用任何语言编写的访问应用程序的数据库实际上是没有用的。（您真的会安装 oracle，并期望所有员工都直接在 SQLPlus 中工作吗？）

因此，我认为数据存储和应用程序只是以应用程序开发人员可以更轻松地与数据存储交互的方式一起移动。

特别是对于 .NET，我更愿意看到而不是 Linq 的是一种内置方式，用于将类定义映射到底层数据源到底层数据存储，并让所有管道正常工作。

换句话说，我可以说“Employee.Name = 'rally25rs';” 并且对象的属性会发生变化，并且在此之下它将持续到数据存储本身。完全放弃 SQL，而不是像现在的 Linq to SQL 那样采用 1/2 的方式。

当然，这样的解决方案会带来性能、事务处理等方面的问题。

也许编程语言和关系数据库的整个概念需要重新思考和重新调整？在它们的核心，它们是完全独立和脱节的实体。也许是时候放弃“关系 sql 感知数据库”并构建下一个东西了，执行一行代码将直接对数据库进行操作。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-19T19:43:29.370

linq 没有问题，但是对于那些使用它并忽略“幕后”发生的事情的人

我仍然更喜欢用 SQL 来弄脏自己的手。至少我会确切地知道发生了什么。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-19T22:04:06.607

Ted Neward 就他对这个主题的看法写了一篇很棒的文章 - ORM 是计算机科学的“越南”......

[http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx)

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-05-05T10:24:21.653

大多数人都忽略了一个要点：在大多数情况下，在 LINQ 中查询比在 SQL 中查询的**效率要高得多。**我[写了一篇](http://www.linqpad.net/WhyLINQBeatsSQL.aspx)关于为什么会这样的文章。

当我设置 LINQPad 挑战时，我并不是在开玩笑：我几乎所有的临时查询都是在 LINQ 中进行的，因为大多数查询在 LINQ 中比在 SQL 中编写得更快、更可靠。我还使用 LINQ to SQL 设计并处理了大型业务应用程序，并看到了生产力的重大提升。这不是“架构宇航员”的东西 - LINQ to SQL 是**[驱动这个站点](https://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/)**的一种高效且实用的技术。

LINQ 的最大障碍是无法正确学习它。我已经看到很多 LINQ 查询是 SQL 查询的可怕**音译**来支持这一点。如果您仅使用 SQL 知识编写 LINQ 查询，则最终结果只能与 SQL 相同或更差。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2010-02-02T07:02:37.457

我刚刚发现了这个问题。我想它现在已经差不多玩完了，但无论如何我都会投入两分钱......

我只想为不明显的事情编写代码。

CRUD 代码很明显。我不想写它。因此，ORM 是一个好主意。

这并不意味着 ORM 没有问题，但问题在于执行，而不是意图。随着 ORM 的成熟，问题将会减少，并且已经可用于简单场景的生产力提升最终也将扩展到复杂场景。

LINQ 也是一个好主意。其他人已经提到了许多优点，但我所要做的就是想想我第一次尝试在 LINQ 中进行枢轴操作时，我事先并不知道列数。或者我第一次意识到我不必`DataView`每次想要排序或过滤某些东西时都创建一个新的。LINQ 使我能够在 C# 中对数据做任何我想做的事情，而不必弄清楚如何在 SQL 和 C# 之间划分工作。

所以，是的，ORM、LINQ 和其他新兴技术是次优的解决方案，但它们不会错过重点，也不会永远是次优的。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-05-25T22:10:41.680

我想写这个作为对@SquareCog 的回复[在这里](https://stackoverflow.com/questions/458802/doesnt-linq-to-sql-miss-the-point-arent-orm-mappers-subsonic-etc-sub-optim/458860#458860)回复，但它告诉我我还剩下 -1836 个字符。如果我做错了，那么这里的菜鸟很抱歉。

* * *

18世纪休闲的绅士习惯于学习科学。那时，整个科学还不是一个相当聪明的人无法理解的大学科。我的意思是一个博学的人可以理解整个时代的科学思想。

随着时间的推移，已经发现了数百个新的科学领域，并且每一个都研究到了如今很少有人能够理解一个完整的科学领域的全部内容。

编程也是如此。

如今，编程语言领域已经足够大并且发展得足够快，以至于开发人员可以合理地期望了解他自己的全部专业语言。对于一个熟练的编码人员来说，也应该了解整个数据库领域，包括数据库设计、本机 SQL 的细微差别以及它如何在不同数据库上运行以及这些数据库的管理，可能要求有点高。

我认为这里的一些响应者正在掩饰开发大型高性能企业级数据库的一些复杂性，知道“少数 SQL 语句”肯定不会解决问题。这就是为什么大多数大型软件公司都有专门的数据库开发团队。正如 Stroustrup 所说，“分而治之”是有效处理开发和管理大型软件项目所固有的复杂性的唯一方法。

开发人员不喜欢使用 SQL 并不是因为他们懒惰或者因为这让他们感到“恶心”。他们不喜欢使用 SQL，因为他们很聪明。他们比任何人都清楚，只有精通 SQL 的人才会提供最高质量的数据库功能，而将他们置于“万事通”开发人员的位置是一种次优的开发策略。

# xcode - 强制静态链接链接到 Xcode 目标的库？

> ID：458805
> 
> 赞同：12
> 
> 时间：2009-01-19T19:24:30.143
> 
> 标签：xcode, gcc, linker

我的 Xcode 目标链接到 hdf5 库（使用 Link Binary with Libraries 构建阶段）。libhdf5 是使用 MacPorts 安装的，因此 /opt/local/lib 包含库的动态 (.dylib) 和静态 (.a) 版本。

构建的文本输出显示，正如预期的那样，`-lhdf5`在构建的链接步骤中有 a。然而，gcc 似乎采用了动态链接库而不是静态链接库。有没有办法强制 gcc（通过编译器开关或通过 Xcode）与 libhdf5.a 静态链接？

我找到的唯一解决方案是将 libhdf5.a 复制到项目（或其他）目录并链接到该副本，从而避免在同一位置拥有动态和静态版本。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-11-08T09:53:59.860

有这个完全相同的问题，尽管这是一个旧帖子，但我想我会分享我必须做些什么来完成这项工作。

通常你只是向链接器提供开关“-static”，但是，对于 Xcode，这会导致包括 crt 在内的所有库都被静态链接。我得到了错误：

```
can't locate file for: -lcrt0.o 
```

当我尝试这个时。

对我有用的是替换：

```
-lmylib 
```

和

/path/to/libmylib.a

注意： -l 被删除。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-01T19:39:44.677

回应您对 Eduard Wirch 回答的评论：如果您将 -lhdf5 替换为 -l/full/path/to/libhdf5.a，您也可以仅控制这个库的静态链接

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-28T20:05:22.813

我的 Xcode 4.5 案例：

当我将静态 C 库（使用 GNU Autotools 编译的第 3 方库）拖放到项目的框架（`Project Navigator > Frameworks`）时，链接器似乎认为这是一个动态库并添加了`-L -l`标志：

```
-L/path/to/libfoodir -lfoo 
```

链接失败，因为没有`/path/to/libfoodir/libfoo.dylib`. 可以从以下位置看到链接器命令：

```
Log Navigator > select a Build log > select a Link line and expand it 
```

当我将完整路径 ( `/path/to/libfoodir/libfoo.a`) 添加到链接器设置时，链接成功：

```
Targets > Build Settings (all) > Other linker flags 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T17:30:54.647

使用“-static”开关进行链接： [GCC 链接选项](http://www.redhat.com/docs/manuals/enterprise/RHEL-3-Manual/gcc/link-options.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-24T10:02:30.047

在 XCode 11.3.1 下，针对 MacOS

试图将绝对库路径添加到`Other linker flags`. 但这不起作用。所以我将所需的 *.a 文件（ln -s 也可以工作）复制到项目目录，它就像一个魅力。

# .net - 我们应该在 UnitTest 程序集上使用 FxCop 吗？

> ID：458806
> 
> 赞同：5
> 
> 时间：2009-01-19T19:24:35.120
> 
> 标签：.net, unit-testing, fxcop

我们在所有项目中都使用 FxCop。对于我们的单元测试，我不确定它是否值得。我们最终得到了许多抑制：

```
[SuppressMessage("Microsoft.Performance", "CA1822:MarkMembersAsStatic", Justification = SuppressJustifications.CA1822MethodIsUsedExternallyAsNonStatic)]
[SuppressMessage("Microsoft.Usage", "CA1806:DoNotIgnoreMethodResults", MessageId = "Cantaloupe.Seed.Security.RijndaelEncryption", Justification = SuppressJustifications.CA1806MethodIsCalledForExceptionThrowingTest)] 
```

人们对 FxCop on Unit test code 有什么看法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T19:48:50.500

当我教授我们的单元测试/TDD 课程时，我通常会告诉人们按照与编写探测器生产代码时相同的原则编写测试代码。但是，我承认某些 FxCop 规则可能会产生过多的噪音。

您不能为测试代码使用合适的 FxCop 规则子集吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T19:26:35.083

不值得努力；FxCop 用于生产编码标准，而不是内部测试代码

（但是，不时给它一个贯穿和一次检查并没有什么坏处，以防它告诉你一些有用的东西......）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T19:48:31.297

是的，但您不必对此感到疯狂。你的测试是你的维护编码员最好的朋友。如果您的测试不容易阅读，您的维护编码员将会遇到困难。我认为这有助于鼓励更好的习惯，单元测试代码没有允许马虎的许可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T19:29:48.993

如果您有时间，请继续。让警察查看您的所有代码并不是一个坏主意。

# .net - 我可以使用 Microsoft Parallel Extensions to .NET Framework 3.5（2008 年 6 月社区技术预览版）开发生产代码吗？

> ID：458816
> 
> 赞同：4
> 
> 时间：2009-01-19T19:27:58.513
> 
> 标签：.net, parallel-extensions

是否有反对使用此 CTP 的建议？不稳定吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T19:37:03.783

从下载页面：

> 注意：此 CTP 仅用于测试目的。特性和功能可能会在最终发布之前发生变化，Microsoft 可能会选择不提供最终版本。

此外，在 EULA.rtf 中：

> 2.  学期。本协议有效期至 2009 年 1 月 1 日，或软件的商业版本，以先到者为准。

所以实际上它已经**过期**了，你没有使用它的许可。即使它没有：

> *   您可以在您的场所安装和使用该软件的任意数量的副本，以设计、开发和测试您的程序以与该软件一起使用。
> *   除非 Microsoft 根据另一协议允许您这样做，否则您不得在实时操作环境中测试该软件。

所以不，你不能在不违反许可证的情况下在生产环境中使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T19:36:30.260

我想说，这取决于你想用它做什么，以及你什么时候发货或交付。

您现在当然可以接受并针对它进行开发。但请注意，API 可能会在现在和最终版本之间发生变化；这意味着如果要“升级”到最终版本，则必须更改代码。此外，显然它可能存在错误，因为它是 CTP。

在我看来，如果您正在编写航天飞机导航系统，则不应使用它。另一方面，如果您正在做一个非关键任务的内部项目，那么使用它可能很好。

你应该决定你是否能承担风险——对抗它给你的新可能性。

编辑：正如 Marc Gravell 所指出的，EULA 说你不能在生产中使用它。所以简短的回答是否定的，你不能将它用于生产软件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T19:44:10.947

我现在在生产中使用它，效果很好。**但是您必须非常彻底地测试所有内容**，并且每个人都知道测试多线程代码非常复杂。

我遇到了文档的“已知问题”部分中提到的死锁问题。不好笑。在这些情况下，我不得不放弃扩展，一切都恢复正常。

# java - Java Swing：库、工具、布局管理器

> ID：458817
> 
> 赞同：16
> 
> 时间：2009-01-19T19:28:10.183
> 
> 标签：java, swing, devtools

您的 Java Swing 工具集中有哪些库/工具？

*   许尔
*   布局管理器
*   打包者/安装者
*   图书
*   ETC.....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T23:26:39.263

这是我使用的：

*   **“框架”**：[Swing 应用程序框架](http://appframework.dev.java.net)，做的不多，但做得很好（如果你使用它，你可能想看看我去年做的[一个演示文稿）](http://jfpoilpret.blogspot.com/2008/11/my-presentation-on-jsr-296-at-jazoon-08.html)
*   **JTables**：处理表格通常很痛苦（大量样板代码......）；我通常使用[GlazedLists](http://publicobject.com/glazedlists/)，它大大简化了工作（并带来了许多改进）
*   **[EventBus](https://eventbus.dev.java.net/)**：在另一个答案中提到了这一点
*   **LayoutManager** : [DesignGridLayout](https://designgridlayout.dev.java.net) （无耻插件，这是我的开源项目之一）
*   **外观和感觉**：在您不想使用系统外观的某些情况下，[Substance非常好](https://substance.dev.java.net/)
*   **对接库**：如果您的应用程序需要对接，您会发现[MyDoggy](http://mydoggy.sourceforge.net) 很有用（并且它有一个编写良好的 API）。它的一个问题是与某些第三方外观和感觉（如 Substance）的不良集成

上面所有这些库都是开源的。

除此之外，我还有自己的一组实用程序类，其中包括帮助将 GUI 与依赖注入库集成：我有一组用于[HiveMind](http://hivemind.apache.org/)容器的实用程序（供了解它并仍在使用它的少数开发人员使用) 和另一个 - 正在准备中，即将开源 - 用于[Guice](http://code.google.com/p/google-guice/)。

我没有读过关于 Swing 开发的具体书籍，但我已经使用 Swing 大约 10 年了（但不是持续使用）。因此，我对书籍没有建议（不幸的是，因为我承认这是 Swing 的一个弱点）。

“肮脏的富客户”一书仅在以下情况下才有用：

1.  你很了解 Swing
2.  你想构建“花哨”的 GUI

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T23:02:05.600

[Spring Rich Client](http://www.springsource.org/spring-rcp)和[JGoodies](http://www.jgoodies.com/)是我团队 GUI 应用程序的基础；用于连接服务器的 Spring 远程处理和用于部署的 Java Web Start。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T20:03:14.650

我几乎只将 GridBagLayout 用于生产代码，除非 GUI 非常简单以至于我可以使用 BorderLayout。我有时会查看其他 LayoutManager，但从未真正发现需要更改，因为 GridBagLayout 几乎可以完成我需要的任何事情。

我用于我自己的东西的安装程序是[izPack](http://izpack.org/)并且到目前为止对我有用。

自从我现在真正阅读任何 Swing 书籍以来已经有很长时间了。显然，来自 O'Reilly 的 Java Swing 是事实上的圣经 :) 谈到设计书籍时，我确实有很多建议，但这可能是题外话？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T22:55:02.293

带有[GUI 所见即所得编辑器的](http://www.netbeans.org/features/java/swing.html)[Netbeans](http://www.netbeans.org/)。它使创建 Java 6 Swing 表单变得非常容易。我将表单子类化以添加功能以确保持续的工具支持。

我还将[SwingX](https://swingx.dev.java.net/)用于日期选择器和可折叠面板等小部件。

此外，JRE 中始终有[SwingWorker](http://en.wikipedia.org/wiki/SwingWorker)用于运行更新 UI 的后台作业。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T20:06:37.373

两个有用的 Swing 相关库：

1.  [Swing 应用程序框架](https://appframework.dev.java.net/)是一个轻量级框架，可简化中小型 Java 桌面应用程序的创建和维护。该框架由一个 Java 类库组成，该类库支持以下内容的构造：

    *   记住会话之间的状态。
    *   更轻松地管理操作，包括作为后台任务运行和指定阻塞行为。
    *   增强的资源管理，包括 bean 属性的资源注入。

    [这](https://appframework.dev.java.net/intro/index.html)是一篇关于它的文章。它已与 Netbeans 6.0 及更高版本集成。

2.  [EventBus](https://eventbus.dev.java.net/)是一个面向 Swing 的发布者-订阅者框架，我发现它对于更新 GUI 非常有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T19:55:12.640

不是一个真正的工具，但我一直致力于在 JavaDocs for Swing（和其他几个 API）中注释重要的东西。太多的方法包含“如果你想刷新就不要调用这个，而是调用 X”这样的惊喜。我使用我为博士学位构建的工具来访问此类信息（它突出显示源代码中对具有此类内容的方法的调用）。

恕我直言，swing 的 JavaDocs 很难使用，因为它们结合了适用于使用对象的人的信息和对现有类进行子类化的人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T22:44:30.677

对于书籍，请查看[Swing Programming Books](https://stackoverflow.com/questions/452009)的答案。

# ruby-on-rails - 在 Rails 中使用框架（或 iframe）的最佳实践是什么？

> ID：458819
> 
> 赞同：0
> 
> 时间：2009-01-19T19:28:15.127
> 
> 标签：ruby-on-rails, iframe, haml

我正在构建一个 Ruby on Rails 应用程序，人们在其中点击地址。当他们点击时，我想在框架中显示地址的小型谷歌地图。我想使用框架/iframe，所以当他们向下滚动查看更多地址时，小地图也不会滚动。

我很难找到这方面的例子或讨论。我正在考虑用原始`<FRAMESET>`标签修改布局，但这似乎有点野蛮。在 Rails 应用程序中使用框架或 iframe 的最佳方式是什么？

顺便说一句，如果重要的话，我们正在使用 Haml 作为我们的模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T19:32:31.967

你可以试试 Greybox jQuery 插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T19:34:15.020

您可以使用 CSS ( ) 将 an 锚定`iframe`到页面的一侧（或底部或其他`position: fixed`）。如果您这样做，请务必考虑重叠问题。这很容易解决，留有余量`body`。

# java - IntelliJ 可以从 log4j 输出创建指向源代码的超链接吗？

> ID：458820
> 
> 赞同：10
> 
> 时间：2009-01-19T19:28:18.060
> 
> 标签：java, eclipse, log4j, intellij-idea

在 IntelliJ 控制台中，堆栈跟踪自动包含将您带到相关源文件的超链接。链接以格式 (Log4jLoggerTest.java:25) 出现在每一行的末尾。我可以将 log4j 配置为以类似格式输出文本。

```
log4j.appender.Console.layout.ConversionPattern=%d{ABSOLUTE} (%F:%L) - %m%n 
```

在 Eclipse 中，控制台自动将这样的文本转换为链接。在 IntelliJ 中，堆栈跟踪是链接，但我自己的相同形式的输出保持未链接。有没有办法让 IntelliJ 做同样的事情？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-18T12:06:17.567

是的，你可以，试试这个模式：

```
<param name="ConversionPattern" value="%-5p - [%-80m] - at %c.%M(%F:%L)%n"/>

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-13T08:24:33.530

IntelliJ IDEA 有一个插件可以在您的控制台中获取可点击的链接，称为[Awesome Console](https://plugins.jetbrains.com/plugin/7677)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-10T16:12:05.640

仅供参考，在 logback 和 Intellij 13 中，这对我有用：

```
<pattern>%d{dd-MM-yyyy} %d{HH:mm:ss} %p %m - at %C.%M\(%F:%L\)%n</pattern> 
```

注意：我需要“at”，还需要转义括号。大写的“C”也是 logback 中的完全限定类名。

使用此配置，我得到如下输出：

```
10-06-2014 10:10:58 INFO Bean 'mbeanServer' of type [class com.sun.jmx.mbeanserver.JmxMBeanServer] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying) - at org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker.postProcessAfterInitialization(AbstractApplicationContext.java:1374) 
```

括号中的最后一部分在 Intellij 中显示为链接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T20:58:40.453

我不认为有办法。但我想我很久以前就将其作为功能请求提交了。也许你也应该这样做。Jetbrains 确实听取了客户的意见。但是在他们实施这样的事情之前可能需要很长时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-25T02:02:02.390

这对我有用：

```
log4j.appender.console.layout.ConversionPattern=[%d{MM-dd HH:mm:ss}]%5p %l %m%n 
```

# php - 子表达式（正则表达式）的无限匹配只返回一个匹配项

> ID：458822
> 
> 赞同：1
> 
> 时间：2009-01-19T19:28:50.507
> 
> 标签：php, regex

我有一个像这样的正则表达式（非常简化）：

```
^(ab)*$ 
```

我与此相匹配：

```
abababababababab 
```

当我运行它时`preg_match`：

```
preg_match('/$(ab)*$/', 'abababababababab', $matches);
print_r($matches); 
```

我明白了：

```
Array
(
    [0] => abababababababab
    [1] => ab
) 
```

我期望这个：

```
Array
(
    [0] => abababababababab
    [1] => ab
    [2] => ab
    [3] => ab
    [4] => ab
    [5] => ab
    [6] => ab
    [7] => ab
    [8] => ab
} 
```

我怎样才能得到我所期望的？

（请注意，子表达式可能更复杂，例如`([aA][bB])`，并且我希望匹配的表达式按主题中的顺序排列。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T19:32:05.947

通过`preg_match_all`这样使用来做到这一点：

```
preg_match_all('/(ab)/', 'abababababababab', $matches);
print_r($matches); 
```

请记住，`preg_match`它只提供第一个匹配并且`preg_match_all`具有相同的功能，但返回所有。另请注意，现在正则表达式已更改。如果您使用星号，它可能会在第一次匹配时消耗整个字符串。但是，您可以尝试`(ab)*?`使其变得不贪婪。

# newline - vim 注释换行符意外行为

> ID：458839
> 
> 赞同：2
> 
> 时间：2009-01-19T19:32:33.513
> 
> 标签：newline, vim

在使用 vim 时，当我用 // 开始注释时，在我输入一个空格后，它会立即开始一个新的注释行。

例如，如果我输入以下内容：

```
//hello world my name is stefan 
```

我会得到：

```
//hello
//world
//my
//name
//is
//stefan 
```

这种行为也体现在 python 代码中，如果我以 print 开始一行，每个空格都被解释为换行符

```
print "Hello world my name is Stefan" 
```

是

```
print
"hello
world
my
name
is
stefan" 
```

这是预期的行为还是我的设置搞砸了？以下是我的.vimrc：

```
" An example for a vimrc file.
"
" Maintainer:   Bram Moolenaar <email address>
" Last change:  2006 Nov 16
"
" To use it, copy it to
"     for Unix and OS/2:  ~/.vimrc
"         for Amiga:  s:.vimrc
"  for MS-DOS and Win32:  $VIM\_vimrc
"       for OpenVMS:  sys$login:.vimrc

" When started as "evim", evim.vim will already have done these settings.
if v:progname =~? "evim"
  finish
endif

" TagList plugin settings
nmap <f12> :TlistToggle<end>

" Use Vim settings, rather then Vi settings (much better!).
" This must be first, because it changes other options as a side effect.
set nocompatible

" allow backspacing over everything in insert mode
set backspace=indent,eol,start

set nobackup        " do not keep a backup file, use versions instead
set history=50      " keep 50 lines of command line history
set ruler       " show the cursor position all the time
set showcmd     " display incomplete commands
set incsearch       " do incremental searching

" For Win32 GUI: remove 't' flag from 'guioptions': no tearoff menu entries
" let &guioptions = substitute(&guioptions, "t", "", "g")

" Don't use Ex mode, use Q for formatting
map Q gq

" In many terminal emulators the mouse works just fine, thus enable it.
" set mouse=a

" Switch syntax highlighting on, when the terminal has colors
" Also switch on highlighting the last used search pattern.
if &t_Co > 2 || has("gui_running")
  syntax on
  set hlsearch
endif

" Only do this part when compiled with support for autocommands.
if has("autocmd")

  " Enable file type detection.
  " Use the default filetype settings, so that mail gets 'tw' set to 72,
  " 'cindent' is on in C files, etc.
  " Also load indent files, to automatically do language-dependent indenting.
  filetype plugin indent on

  " Put these in an autocmd group, so that we can delete them easily.
  augroup vimrcEx
  au!

  " For all text files set 'textwidth' to 78 characters.
  autocmd FileType text setlocal textwidth=78

  " When editing a file, always jump to the last known cursor position.
  " Don't do it when the position is invalid or when inside an event handler
  " (happens when dropping a file on gvim).
  autocmd BufReadPost *
    \ if line("'\"") > 0 && line("'\"") <= line("$") |
    \   exe "normal! g`\"" |
    \ endif

  augroup END

else

  set autoindent        " always set autoindenting on

endif " has("autocmd")

set   backupdir=./.backup,.,/tmp
set   directory=.,./.backup,/tmp

map <F1> :NERDTree <CR>
map <F2> :q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>:q!<CR>
map <F5> :AV<CR>
map <F6> :AS<CR>
map <F7> :IHV<CR>
map <F8> :IHS<CR> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T19:40:22.623

我的猜测是你混合了“tw”（又名 textwidth）和旧的 vi 命令来设置文本边距“wm”。"tw" 设置页面的实际宽度（即 tw=77 表示您希望每行 77 个字母），但 "wm" 设置离屏幕边缘多远，因此在 80 列屏幕上 "wm= 3" 将具有与 "tw=77" 相同的效果。因此，如果您的 tw 设置为非常小的值，它会尝试在每个单词之后换行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T19:41:44.773

我无法在您的 vimrc 中发现它，但您的 tw 似乎设置为较低的值（0 除外），例如 5 左右。尝试设置 tw=0，看看会发生什么。

**编辑：**
正如 Paul 指出的那样，您可能混淆了 tw （textwidth）和 ts （tabstop），通常设置为 4 或 2。

# c# - 如何让子类指定名称和描述等详细信息

> ID：458846
> 
> 赞同：0
> 
> 时间：2009-01-19T19:33:57.783
> 
> 标签：c#, oop

我有一个名为 ICommand 的接口，各种类都从该接口继承。这些类都使用 Run() 方法做各种不同的事情，但它们都需要有一个 Name 属性和一个 Description 属性来指定它们的作用。

问题是，我应该如何让每个子类指定这些属性（名称和描述）。目前，我已经在 ICommand 中为这两个属性添加了一个属性，并且我让每个子类都实现了这些属性，并且`return "Blah Blah Blah"`在其中只有一个语句。这是最好的方法吗？还是应该以其他方式完成？

抱歉，如果这似乎是一个愚蠢的问题 - 我只是从这个 OOP 设计的东西开始，我想检查一下我做得对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T19:38:00.990

我认为，在界面中定义一个只读属性是最好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T19:41:38.393

我写了一些类似的东西（插件），其中每个类都有不同的名称和描述，并最终按照 Sebastian 所说的方式实现，具有 ReadOnly 属性

```
interface ICommand {
string Name { get; }
string Description { get; }
...

classSpecific : ICommand {
public string Name { get { return "Specific"; }}
public string Description { get { return "Specific description"; }}
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T19:38:25.433

这通常是我采取的方法。我发现要求子类覆盖虚拟属性或方法以返回描述性标识符是相当容易和快速的。我想你可以使用反射做类似的事情，但你肯定会受到性能影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T19:40:38.970

据说类实现了一个接口，而不是从它继承，因为接口没有实现（因此没有什么可继承的）。您当然可以做您正在做的事情，如果 Name 和 Description 属性对您的所有类型都是唯一的，那么您最终会得到多个实现。如果我理解正确的话，这没什么错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T19:45:16.857

你走在正确的道路上。您所描述的类似于[策略模式](http://www.dofactory.com/Patterns/PatternStrategy.aspx)，其中您有几个实现接口的类（实际接口或抽象类）然后有自己的方法实现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T19:47:41.453

如果每个实现类的 Name 和 Description 属性都不同，那么无论如何，做你正在做的事情。强制每个类实现这些属性（通过您的接口）并让它们提供详细信息。但是，如果许多类的名称和描述可以相同（尽管名称和描述可能不会发生），那么您的另一种选择将是一个抽象类，其中 Run() 是一个抽象方法，而名称和描述是虚拟属性。

# excel - PowerShell 中的 Excel 自动化问题

> ID：458852
> 
> 赞同：2
> 
> 时间：2009-01-19T19:35:37.843
> 
> 标签：excel, powershell

我正在尝试自动刷新我的 Excel 报告中的数据。这里的脚本：

```
$ExcelApp = new-object -ComObject Excel.Application
$ExcelApp.Visible = $false
$ExcelApp.DisplayAlerts = $false

$Workbook = $ExcelApp.Workbooks.Open("RefreshTest.xlsx", 3, $false, 5, $null, $null, $true)
$Workbook.RefreshAll()
$Workbook.Save()

$ExcelApp.Quit() 
```

该脚本很好，但是当我尝试直接运行它时，它会显示以下错误：

```
Method invocation failed because [System.__ComObject] doesn't contain a method named 'Save'.
At line:7 char:15
+ $Workbook.Save <<<< ()
    + CategoryInfo          : InvalidOperation: (Save:String) [], RuntimeException
    + FullyQualifiedErrorId : MethodNotFound 
```

奇怪的是，如果我只运行脚本的顶部（在 Save 方法之前），然后调用 Save 方法，它工作正常。

你可以帮帮我吗？它针对 PowerShell V1 和 PowerShell V2（随 Win7 Beta 安装的位）进行了测试。

最好的问候， 拉法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T13:46:57.407

您的逻辑似乎很好，这对我有用（XP SP2 和 PowerShell v2）。

就在你调用 Save() 之前，只是为了好玩，添加这一行以查看打印的内容：

```
$Workbook|Get-Member *Save* 
```

我尝试使用空白文件。你的文件可能大吗？我想知道你是否有一个大文件，也许需要添加一个“Start-Sleep -sec 5”也许......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-01T16:17:22.557

正如所写的那样，这个脚本也适用于我。

我同意 Marco 的观点，这似乎是一个竞争条件错误。错误消息很奇怪，但是当您在脚本的加载/刷新和保存部分之间进行人为暂停时它会起作用，这表明加载/刷新时间过长会导致您的问题。

尝试 Marco 建议的“Start-Sleep”功能/cmdlet，看看是否可行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-26T23:50:41.023

我同意这似乎是一个竞争条件。我使用的一个成语利用了`!$null`计算结果为`$true`,

```
# create an object that may take some time to populate
$MyWorkBook = $ap.Workbooks.Add()

# wait for the methods of MyWorkBook to be populated
while(!$MyWorkBook.activate){start-sleep -milliseconds 10}

# call the method we waited for
$MyWorkBook.activate() 
```

# wix - 如何更好地利用 MSI 文件

> ID：458857
> 
> 赞同：15
> 
> 时间：2009-01-19T19:36:39.573
> 
> 标签：wix, windows-installer, installation, msitransform

您可能知道，[msiexec](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367988%28v=vs.85%29.aspx)是一个命令行应用程序，可用于安装 MSI 文件。您可能知道，您可以在静默或不可见模式下运行它。

如果安装程序要求用户回答有关要安装哪些部件的特定问题，是否可以通过某种方式在 msiexec 命令行中添加一系列选项来执行此操作？

我认为必须有某种方式来设置 MSI 文件的默认设置才能实现这一点。MSI 文件是如何制作的？它们是通过 Microsoft 的工具开发的吗？它们可以打开和编辑吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-28T21:50:17.070

> **MSI 文件专门设计用于支持静默安装作为内置功能 - 您始终可以跳过 GUI。**但是，一些 MSI 文件存在设计缺陷，导致在静默模式下安装不完整——这是一个严重的设计错误。此处描述了此问题：
> 
> *   ：[从控制面板卸载不同于从 .msi 中删除](https://stackoverflow.com/questions/29677483/uninstall-from-control-panel-is-different-from-remove-from-msi/29679464#29679464)（***静默与交互式安装***- 技术性和实用性）
>     
>     
> *   [在现实世界中看到的常见 MSI 问题的一般描述中也有一个部分](https://stackoverflow.com/questions/45840086/how-do-i-avoid-common-design-flaws-in-my-wix-msi-deployment-solution/45840087#45840087)（***Common MSI Problems*** - 一般问题和[反模式](https://stackoverflow.com/questions/458857/how-to-make-better-use-of-msi-files/1055861#1055861)）

* * *

> ***简短版本***：[如何从电子生成器参数化 msi 文件](https://stackoverflow.com/questions/55460379/how-to-parameterize-msi-file-from-electron-builder/55479296#55479296) - 使用公共属性和转换来自定义 MSI 包的安装。

* * *

*   [这是我如何处理糟糕或困难的部署包的升级模型](https://stackoverflow.com/a/54769767/129130)
*   [Itninja.com 软件打包技巧库](https://www.itninja.com/software-library)
*   [将 .msi 转换为 .exe 的最佳工具包是什么？](https://stackoverflow.com/questions/58231405/what-is-the-best-tool-kit-to-transfrom-msi-into-exe/58232330#58232330)

* * *

# 配置 MSI 安装

在静默安装 MSI 时，您需要做的是从 msiexec.exe 命令行或通过对原始 MSI 文件应用所谓的转换来配置设置。这两个选项都在下面的单独部分中进行了描述。

如果 MSI 文件设计良好，您将能够从 msiexec.exe 命令行**或**使用转换文件修改原始 MSI 设置公共属性（它们总是大写）。这些操作如下所述。公共属性最容易在 MSI 文件的“[属性表](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370908(v=vs.85).aspx)”中找到。[使用您选择的 MSI 工具打开 *.msi 文件](https://stackoverflow.com/questions/1544292/what-installation-product-to-use-installshield-wix-wise-advanced-installer/1546941#1546941)并导航到属性表。还有一些**免费的 MSI 工具**可用于生成转换和查看（和编辑）MSI 文件：[如何比较两个（或更多）MSI 文件的内容？](https://stackoverflow.com/questions/48482545/how-can-i-compare-the-content-of-two-or-more-msi-files/48482546#48482546)（指向底部的链接）。

精心设计的 MSI 设置可通过这些公共属性进行完全配置。设计不良的 MSI 文件不是。设计不佳的 MSI 文件最好使用转换文件进行调整（这可以对整个 MSI 文件进行重大更改以在安装时应用）。设置公共属性只能更改公共属性可配置的任何内容 - 正如设置创建者所设计的那样。**转换几乎可以改变整个 MSI 文件中的任何内容**。

*通常，所有公司的静默部署都是使用转换来完成的，以“将 MSI 文件打造成符合公司标准的形状”。*它是一种非常有效的企业部署工具，被广泛使用。

* * *

几个安全保存的链接：

*   [运行 .msi 安装程序后能否确定生成的命令行？](https://stackoverflow.com/questions/50455640/can-the-resulting-command-line-be-determined-after-running-an-msi-installer/50455886#50455886)
*   [如何在 linux 服务器上构建 MSI 包？](https://stackoverflow.com/questions/54304773/how-to-build-msi-package-on-a-linux-server/54332468#54332468)
*   [Microsoft Installer 命令行字符串参数不起作用？](https://stackoverflow.com/questions/53434089/microsoft-installer-command-line-string-parameter-not-working/53436779#53436779)
*   [在安装过程中更改程序名称和快捷方式标题](https://stackoverflow.com/questions/23206184/change-program-name-and-shortcut-title-during-installation/23207049#23207049)

* * *

# 微星“特色”

MSI 通常是违反直觉的，并且在引擎盖下有些复杂。但是，过度简化的 MSI 文件包含一个或多个“**功能**”——正如您所说，这些功能共同构成了“**应用程序的部分”。**反过来，功能由“**组件**”组成——它们是整个软件的基本安装单元——但这是一个非常技术性的细节——这个答案是关于 MSI 的用户公开位——功能。

> ***屏幕截图***：[真正的 MSI 包中的功能是什么样的（屏幕截图）](https://superuser.com/questions/783963/automatically-select-features-for-silent-msi-install/785825#785825)。

您通常可以通过交互式运行安装程序找到这些功能的列表，然后导航到自定义安装对话框（并非总是存在）。此处显示的功能是应用程序的“**用户可配置**”部分，可以选择排除或包含（有些是强制性的）。您还可以通过使用上述功能强大的工具打开 MSI 来找到这些功能（您还可以在下面的第 2 节中查看链接）。

典型功能有：**Core** or **Program**、**Dictionaries**、**Samples**、**Plug-Ins**、**Spell Checker**、**SDK** & **Developer Tools**（用于开发工具）等...有些功能是强制性的（必须安装）——上面的例子是**Core**和**Program**，其他是可选的，应用程序启动不需要（如上面的开发工具功能）。可以使应用程序“按需”安装功能 - 例如，当用户启动拼写检查时，拼写检查器。

**根据我的经验，大多数用户都希望安装整个应用程序。**如果 Windows Installer 意外弹出并开始安装拼写检查器组件，许多用户会非常恼火。坦白说非常好理解。然而，只有少数用户感兴趣的**很少使用的模块化组件**可以制成**可选组件**——特别是如果系统管理员可能不希望在他们的网络上使用该功能。**开发人员工具**当然就是这种情况——普通用户**不**应该使用这些工具。他们往往是人们需要在脚上射击自己的所有绳索。

* * *

*如上所述，自定义 MSI 安装通常有两种方法*：(1)**使用 msiexec.exe 自定义命令行**，或使用 (2)**转换文件**。

* * *

# **1：msiexec.exe 命令行**：

控制安装过程中安装哪些功能的最简单、轻量级的方法是使用`msiexec.exe`命令行指定您的功能选择。有一整套用于功能配置的属性。但是，在大多数情况下，指定以下内容就足够了`ADDLOCAL`：

```
msiexec.exe /i myinstaller.msi ADDLOCAL="Program,Dictionaries" /qn 
```

上面的命令行指定应该在本地安装功能“**程序**”和“**字典”（****功能名称区分大小写！**）。这通常就足够了，但您也可以使用 REMOVE 属性以类似的方式指定要删除的任何功能。一个特殊的开关`ADDLOCAL=ALL`将在本地磁盘上安装 MSI 中的所有功能（前提是 MSI 中没有额外的逻辑来覆盖它）。[MSDN 上的 ADDLOCAL 属性](http://msdn.microsoft.com/en-us/library/aa367536(VS.85).aspx)。

由公共属性定义的一个非常常见的事情是应用程序**的许可证密钥**。以下命令行指定安装功能“**程序**”和“**字典**”并应用序列号“1234-1234”：

```
msiexec.exe /i myinstaller.msi ADDLOCAL="Program,Dictionaries" SERIALKEY="1234-1234" /qn 
```

正如上面的描述所暗示的，**每个设置的可定制属性列表总是不同的**。您可以找到 MSI 文件的属性表中列出的大多数属性，但也有可能设置了一些属性表中未定义的属性。在大多数情况下，这与仅从设置 GUI 设置的属性有关（在大多数情况下表示设置设计错误）。所有属性都应在正确编写的包的属性表中定义。

*在供应商的下载页面上查找文档，并向他们寻求与静默安装或大规模部署相关的任何文档的支持*。做起来很快，如果有标准答案模板，答案也会很快。**控制其部署的公司将始终能够提供此服务**。在我看来，理想的方式是描述不同部署设置的单页 PDF。坦率地说，如果他们不能提供这些，就给他们一些热量；-)。

* * *

# **2：变换**：

**MSI 文件本质上是包装在 COM 结构化存储文件**（文件中的文件系统）中的 SQL 数据库。转换文件是通过[Orca](http://msdn.microsoft.com/en-us/library/aa370557(VS.85).aspx)（SDK 链接）、[Installshield 或~~明智的~~、高级安装程序等...](https://stackoverflow.com/questions/1544292/what-installation-product-to-use-installshield-wix-wise-advanced-installer/1546941#1546941)（链接到不同工具的描述）。这些转换可以自定义或覆盖 MSI 中的几乎所有设置或数据库字段 - 包括安装了哪些“应用程序部分”（功能）。创建转换后，您可以在 msiexec.exe 命令行中将其应用程序指定给 MSI：

```
msiexec.exe /i myinstaller.msi TRANSFORMS="mytransform.mst" /qn 
```

然后，Windows Installer 将在安装开始前合并 MSI 和转换。这是希望完全控制如何安装 MSI的**大型组织所使用的方法。**[MSDN 上的 TRANSFORMS 属性](http://msdn.microsoft.com/en-us/library/aa372085(VS.85).aspx)。

如上所述，这是允许修改 MSI 中的**所有设置的选项。**可以对设计不良的 MSI 文件进行大量修复，以实现可靠的部署。这是由“应用程序打包者”完成的。他们的工作是调整所有设置以符合公司标准。他们可能是最有知识的 MSI 专家之一——他们在 MSI 文件中看到了很多奇怪的东西。

许多工具可用于创建转换，以下是在比较 MSI 文件的技术背景下对此类工具的描述。直接跳到底部的免费工具列表：[如何比较两个（或多个）MSI 文件的内容？](https://stackoverflow.com/questions/48482545/how-can-i-compare-the-content-of-two-or-more-msi-files/48482546#48482546)

* * *

# 反模式与 Windows Installer 的企业优势：

**Windows Installer 有许多设计怪癖**，可能**对开发人员来说特别烦人**。诚然，有些问题接近于**反模式**。

## 潜在的反模式

*   困难的多实例安装
    *   相对常见的要求，特别是对于服务安装
*   违反直觉的**[文件覆盖规则](https://msdn.microsoft.com/en-us/library/windows/desktop/aa368599(v=vs.85).aspx)**（[赛门铁克](https://support.symantec.com/en_US/article.HOWTO3568.html)）
    *   奇怪的规则，尤其是对于非版本控制的文件
    *   强制覆盖所有文件的疯狂功能（[REINSTALLMODE](http://helpnet.flexerasoftware.com/isxhelp21/helplibrary/UnderstandingFileOverwriteRules.htm) = amus）
        *   可以在系统范围内降级共享文件
        *   可能会导致版本不一致，因为可以在新软件包之后安装旧软件包并且仅降级某些共享文件
        *   可以降级或清除非版本文件（和注册表设置）中的设置
        *   由于尝试不必要地替换相同版本的正在使用的文件，可能会导致请求的重新启动次数显着增加。
        *   还有几个非常具体的问题。总有一天我会把它们都写出来
*   升级后意外**重置**注册表中的 用户数据
    *   这是**非常有问题**的。如果你体验到这不是你，那是技术
    *   经常出现在服务凭证登录和序列号中
    *   避免这个问题的一些技巧
        *   避免从您的设置中写入任何 HKCU 注册表项，而是从您的应用程序中写入它们。您的设置现在将永远不会干扰它们 - 它根本不知道这些值。
        *   将注册表数据放在自己的功能中（应防止出现自我修复问题）
        *   通过具有空组件 GUID 的组件安装注册表数据（在修复或自我修复期间将永远不会被重写）
        *   如果 key-path 存在，则将组件标志设置为从不覆盖。
        *   改为使用自定义操作将 HKLM 数据（例如许可证密钥）写入注册表（这有其他问题，但可以让您完全控制何时写入数据 - 在什么安装模式下）
        *   确保您保持稳定的注册表项路径。设置一个标志值 KeyPath = 1 并且永远不要更改它 - 至关重要的是 - 也不要更改组件 GUID
        *   永远不要将 REINSTALLMODE 设置为“amus”——当然不会在属性表中对该值进行硬编码。
        *   还有更多的技巧和经验法则，如果我能从脑海中记住它们就好了:-)。
*   **复杂的升级机制**
    *   小升级有很多限制和限制
    *   重大升级还有其他挑战（重置注册表数据、安装后丢失文件、安装后对 COM 文件进行自我修复等......）
*   **乏善可陈的 GUI 功能**
    *   不是火箭科学，但有些复杂
    *   缺乏事件和功能来实现适当平滑的 GUI
*   令人震惊的**复杂修补**
    *   极难有效使用
    *   不建议使用，除非作为“修补程序” - 即更新几个文件或修复已安装设置的卸载序列中的特定 MSI 文件错误。
    *   一些补丁评论：
        *   [Windows Installer 在顺序场景中卸载补丁时出现“错误 1308。找不到源文件”](https://stackoverflow.com/questions/23439074/windows-installer-error-1308-source-file-not-found-when-uninstalling-patch-in/23450821#23450821)
        *   [MSP 与 MSI 封装。哪个用于补丁？](https://stackoverflow.com/questions/12159487/msp-vs-msi-packaging-which-to-use-for-patches/12187180#12187180)
*   **自定义操作的极其复杂的实现**
    *   复杂测序
    *   复杂的条件反射
    *   复杂的模拟/部分运行并提升权限
    *   整体**极易出错**。
*   **每个用户设置**的实施**乏善可陈** ***   概念上可疑（文件夹重定向、不可预测性、无法在现实世界中进行设置同时支持每用户和每机器安装）
    *   升级、卸载和打补丁很复杂。允许为不同的用户和每台机器多次安装产品
    *   我不得不承认——在主观上——我认为当前每用户设置的实现是一个完整的部署反模式。**我从不使用它并且坚持不使用，除非被迫使用**。** 
***   **意外的自我修复**
    *   1）[自我修复 - 解释](https://stackoverflow.com/questions/5501028/how-can-i-determine-what-causes-repeated-windows-installer-self-repair/6066263#6066263)。
    *   2）[自我修复 - 寻找现实世界的解决方案](https://stackoverflow.com/questions/45716108/what-do-i-do-when-launching-an-application-triggers-repeating-endless-windows-i/45716110#45716110)。
    *   3)[自我修复 - 如何在您自己的包装中避免它](https://stackoverflow.com/questions/45828724/how-do-i-avoid-triggering-msi-self-repair-with-my-wix-msi-package/45828725#45828725)。*   缺少写入 XML 文件的**内置功能***   **IIS 安装**的不良功能 ***   部分问题是未版本化文件的文件覆盖规则（可能出现不可预测的结果）。
    *   老实说，IIS 可能需要一种全新的部署技术——一种以完全可预测的方式定义对非版本化文件的处理的方法——具有明智的、真实的选项。也许自动备份强制替换的非版本控制文件，强制执行必须是正确版本的一致文本文件组（“程序集”）等等......
    *   还有其他几个与 IIS 和虚拟文件夹和站点的复杂配置有关的问题** ***   对自定义操作草率启用**“检查退出代码**”可能会导致无法升级或卸载的软件包（无需认真调整）
    *   重大升级可能会失败并触发一些无关紧要的回滚
    *   小升级可用于修复卸载顺序或故障调节*   还有几个……
    *   事实上，我对现实世界的 MSI 包本身（错误使用该技术）中**常见的反模式进行了广泛总结：****[如何避免我的 WiX / MSI 部署解决方案中的常见设计缺陷？](https://stackoverflow.com/questions/45840086/how-do-i-avoid-common-design-flaws-in-my-wix-msi-deployment-solution/45840087#45840087)**
    *   我可以忍受所有的内容，但格式不是很好——这是一个混乱的大脑转储，但有时这似乎是完成工作的唯一方法。把它当作它是什么。
    *   过度使用自定义操作是另一个 MSI 问题。这背后有一个复杂的核心，但总体而言，问题是人们没有使用 MSI 中功能齐全的预先存在的解决方案，也没有通过 WiX 等扩展（或 Installshield 或 Advanced Installer 等商业工具）。这是一个摘要：**[为什么限制在我的 WiX / MSI 设置中使用自定义操作是个好主意？](https://stackoverflow.com/questions/46179778/why-is-it-a-good-idea-to-limit-the-use-of-custom-actions-in-my-wix-msi-setups/46179779#46179779)******

 ******实现自定义操作（自定义安装逻辑）的高复杂性**问题可能被认为是不可避免的，并且编写自定义操作的行为一旦需要就应该是强大且有能力的 - 因此很复杂。如果技术本身提供了通常用于部署的内容，则很少需要自定义操作。换句话说，您应该使用内置的 MSI 功能而不是自定义操作（如果可用），或者 WiX 或第三方部署软件扩展（如果可用）。

**WiX 框架**（开源）和类似的**商业工具**（Installshield、Advanced Installer 等）已经实现了扩展 Windows Installer 的功能，以处理缺少的功能，例如缺少 XML 文件的升级机制、共享创建和管理、创建用户和组、高级 IIS 配置、COM+ 安装、更改 ACL 权限、设置防火墙规则、持久化安装属性等......**应该越来越少需要实现自己的自定义操作**。如果可以的话，总是使用已经被成千上万的其他用户测试过的功能（甚至数百万的用户——这些扩展是由最好的部署专家编写的——你认为你自己可以做得更好吗？）。

## Windows Installer 的企业利益（非常重要）

使用 Windows Installer 需要特定的心态。然而，它提供了许多以前的安装技术几乎完全缺乏的**关键企业利益。**推荐阅读[**使用 MSI 文件的企业利益。**](https://serverfault.com/questions/11670/the-corporate-benefits-of-using-msi-files/274609#274609)特别是对于那些认为 Windows Installer 麻烦多于其价值的人。

简单总结一下链接的文章，**MSI 相对于以前的部署技术的核心企业优势是**（在我看来）：

*   可靠的**静音运行**（带有标准化、完全可抑制的 GUI）
*   **隐式可用**的卸载（旧部署技术的噩梦）
*   **详细**的日志记录（可能会有所帮助，尽管确实很冗长）
*   **可靠**的远程管理（实际上是整体收益 - 所有其他列出的收益的综合效果）
*   **提升**的安装权限（没有混乱的临时管理员权限）
*   标准化的**命令行**（一个非常有益的功能 - 不再追逐隐藏的命令行选项）
*   安装程序的**半透明性质**（开放格式，编译后的 CA 除外，它是黑盒）
*   **回滚**支持（计算机状态管理、防止部分部署、失败和回滚更改）
*   **管理员安装**（企业重新打包必不可少，以标准方式提取所有文件）
*   **标准包定制方法（转换）**（基本上允许对企业部署进行完全定制）

这只是为了挑选最重要的那些（经过多年的企业部署）。***老实说，这些功能在世界上产生了巨大的影响（对于企业部署），并且确实使 MSI 尽管存在所有缺陷，但仍然非常好用***。

## Windows 安装程序的暮年

随着 Windows Installer 进入暮年，我们只能希望未来的部署技术能够保留这些巨大的企业部署优势，并以有利于所有人，尤其是开发人员的方式处理上述反模式。

**部署是开发的关键部分**。*未能为潜在最终用户成功安装出色的软件可能是整个软件开发中最昂贵的错误。*如果用户从来没有看到你的软件完全正常运行，你怎么能成功？

必须更好地处理（降低）Windows Installer 的复杂性，并且必须在接下来的任何范例中正确保留其关键优势。

相当不错：[Windows Installer 的总结](http://en.wikipedia.org/wiki/Windows_Installer)。

## 云平台

说了这么多；随着计算普遍转向云平台，部署世界可能会以不可预测的方式发生相当大的变化。然而，正如那句名言所说：事物变化越多，它们就越保持不变。部署需要处理未来几十年将在公司中使用的所有遗留技术。这里有一篇关于为什么部署似乎变得更复杂而不是更复杂的文章——尽管有所有的营销：**[程序安装的好处和真正目的是什么？](https://stackoverflow.com/questions/22733889/what-is-the-benefit-and-real-purpose-of-program-installation/22737069#22737069)**.

看看部署的未来会是什么——在未来的几年里，这将是一件很有趣的事情。或许我们会看到家用电脑的简化部署，而企业部署会变得比以往更加复杂？在未来，大多数部署可能是数据库部署任务，而不是文件和文件夹部署任务。到目前为止，服务器部署可能非常复杂，包括数据库脚本、用户和组创建、共享设置和 ACL 权限、性能计数器、防火墙规则更新、AD 查询和更新、COM+ 和消息队列配置、服务安装等...... -整个九码。

* * *

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-20T00:23:52.067

将带有 MSI 的用户界面视为*可选*。这意味着不需要任何答案*，*因为开发人员有合理的默认设置，这样事情就不会中断。

我们以 MSI 格式向企业客户分发我们的软件，我还向他们提供有关 Orca 基础知识的文档（**orca.msi**与[Windows Installer SDK](http://www.microsoft.com/DownLoads/details.aspx?familyid=6A35AC14-2626-4846-BB51-DDCE49D6FFB6&displaylang=en)一起分发）以及如何自定义我们在`Property`表中列出的某些字段以进行安装。例如序列号、注册详细信息和其他一些设置。

为了回答关于**msiexec 命令行选项**的原始问题，只需运行`MSIEXEC /?`以在命令行上设置属性，您将使用类似

```
MSIEXEC /I test.msi SOMEPROPERTY="Some value" PROP2="something else" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T21:39:15.533

**如何配置静默 MSI 设置**

可以通过设置安装程序使用的属性在命令行上配置 MSI 安装。有预定义的 Windows Installer 属性，例如 ALLUSERS 属性。此属性定义安装是在当前用户的上下文中还是在机器的上下文中完成。

例如，可以从安装日志中获取有关可用属性的信息，该安装日志可以使用 msiexec 的 /l 选项创建

```
msiexec /I mysetup.msi /l*vx log.txt 
```

**如何创建 MSI 文件**

有很多方法可以创建 MSI 文件。MSI 文件基本上是一个由各种表组成的数据库，其中包含所有必要的设置信息和安装对话框。

[Microsoft 提供了一个名为Orca](http://support.microsoft.com/kb/255905)的简单工具，它使您能够编辑现有的 MSI 文件，并允许您找出可以设置哪些属性来配置安装。从理论上讲，也可以使用此工具创建新的 MSI 文件，但这是一种非常麻烦的方法。

如果您正在寻找免费的开源解决方案，我建议您查看SourceForge 或 Nullsoft 上提供的[WiX 工具集。](http://wix.sourceforge.net/)所有设置信息都通过 XML 文件完成，然后将其转换为 MSI 安装程序。WiX 是稳定的（尽管仍被标记为 beta）并且可以在生产中使用。实际上它将集成到即将发布的 Visual Studio 2010 版本中。

当然，也有可用的商业解决方案，InstallShield 是市场领导者（也是价格领导者），而 Visual Studio 可能是最广泛使用的工具。

# x86 - 开发新的指令集

> ID：458869
> 
> 赞同：4
> 
> 时间：2009-01-19T19:39:25.870
> 
> 标签：x86, sse, avx

英特尔将发布一个名为[AVX](http://software.intel.com/sites/avx/ "AVX")的新指令集，其中包括将 SSE 扩展到 256 位操作。即，4 个双精度元素或 8 个单精度元素。

考虑到目前还没有支持它的硬件，如何为 AVX 开发代码？更一般地说，开发人员如何为不存在的硬件编写代码，例如，如果他们希望在支持 CPU 发布时准备好软件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T19:44:13.270

也许我错过了有关您的问题的一些信息，但似乎答案在您链接的网站上。使用英特尔编译器访问新的内在函数，这样您就可以生成代码并使用仿真器对其进行测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T19:43:57.233

[http://www.google.com/search?hl=en&q=intel+avx+emulator](http://www.google.com/search?hl=en&q=intel+avx+emulator)很容易找到[http://software.intel.com/en-us/articles/intel-software-development-emulator/ 。](http://software.intel.com/en-us/articles/intel-software-development-emulator/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T19:46:48.287

联系英特尔并询问他们是否有可用的模拟器？不是硬件级模拟器，而是指令集模拟器。事实上，英特尔有一个模拟器可用。

或者你可以自己写一个——对某些人来说可能是一个有趣的项目！

# language-agnostic - 在表单成功页面上显示消息

> ID：458875
> 
> 赞同：2
> 
> 时间：2009-01-19T19:41:30.483
> 
> 标签：language-agnostic

假设您有页面 A，它是 Web 应用程序的“主页”页面。假设有一个包含表单的第二页 B。成功处理表单后，用户将被引导回页面 A。如果您需要为上一个操作（成功的表单提交）显示成功消息，获取该消息进行显示的最佳方式是什么？

我把它缩小到这个：

1.  将消息密钥传递给页面 A。然后页面 A 将使用该密钥从某处获取消息。

2.  将消息传递到页面 A。但是，这似乎为 XSS 打开了站点，但又没有。

3.  在处理表单时，在重定向到页面 A 之前将消息存储在会话范围内。然后页面 A 可以从会话中检索和删除消息并将其显示在屏幕上。

我错过了什么吗？完成此任务的首选方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T20:06:42.583

我永远不会使用会话来完成这样的任务。这是不负责任的，会破坏逻辑的流动。相反，您可以有一个预先确定的错误列表，并通过查询参数传递错误代码。如果您确实需要每次发送新的自定义数据，我建议您最好通过 GET 或 POST 发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:13:15.303

出于同样的原因，在这里完全同意 d03boy。当您的用户开始打开多个窗口时，在会话中存储特定于某个视图的数据会严重中断。

就个人而言，我总是使用您在此处描述的方法 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T19:49:36.300

我通常使用方法3。如果页面要在重定向后显示消息，它会设置一个会话变量。然后代码，即在我的基类中（为每个页面请求执行），检查是否有要显示的消息，显示它并清空消息会话变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T20:51:13.570

我同意 d03boy 和 pilif 的观点：方法 3 不能很好地使用会话，并且在有多个窗口的情况下会搞砸，正如你所说，方法 2 会打开 XSS。

将不同的消息存储在文件或数据库中，并将密钥传递给脚本。如果您需要自定义消息，请通过发布请求传递数据（并对其进行验证以防止 XSS）并使用模式替换消息中的值。

# java - 我怎样才能让这个程序也打印列表中的第一个条目？

> ID：458879
> 
> 赞同：1
> 
> 时间：2009-01-19T19:42:08.937
> 
> 标签：java, sql, database

我无法显示查询中返回多个答案的第一个条目。例如，结果集为 5 的搜索将返回第二个到第五个，而错过第一个条目。如果我搜索具有一个条目作为输出的内容，它不会返回任何内容，只会挂起，因为它是数据库中的第一个也是唯一一个条目。当我调试它并搜索我知道在数据库中只有一个条目的东西时，它转到第 12 行，然后是第 15 行，然后是第 25 行。如何修改循环以包含要打印的第一个条目？

代码：

```
try {
    ResultSet rs;
    String comparex = jTextField2.getText().trim().toUpperCase();// puts the textfield into a string object
    rs = stmt.executeQuery(
        "SELECT * FROM BASTIMP where DETAILS like '%"+comparex+"%'"
    ); //paradox equivalent '..comparex..'
    String amount;
    String date;
    String attached = "";

    if (rs.next()) // **Line 12**
    {

    }else {
        DisplayAreaX.setText("ENTER VALID VENDOR");
    }  
    while (rs.next()) { // **Line 15**
        String details = rs.getString("DETAILS"); //get results from DETAILS
        date = rs.getString ("DATE PAID");        //CORRECT?
        amount = rs.getString ("AMOUNT BANK");
        attached = attached + details +":"+ '\n'+ "Date " +date+ " / "+
            "Amount £"+ amount+ '\n'; // - ADDS MULTIPLE ENTRIES ON OUTPUT OF jList!
        DisplayAreaX.setText(attached);
        System.out.println(details+":"+ '\n'+ "Date "+date+ " / "+
            "Amount £"+ amount+ '\n');
    }
} catch (SQLException e) {
    System.out.println("SQL Exception: " + e.toString());
} catch (ClassNotFoundException cE) {
    System.out.println("Class Not Found Exception: " + cE.toString());
} // **Line 25** 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T19:50:17.593

在访问结果之前，您调用 rs.next() 两次。我想说有两个选择，首先用 do...while 循环替换 while，或者删除 if/else 语句并在计数器中跟踪结果，最后检查计数器是否为 0 和然后显示消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T20:01:59.363

为什么不将逻辑更改为：

```
int recordCount = 0;

while (rs.next()) 
{
  recordCount ++;
  String details = rs.getString("DETAILS"); //get results from DETAILS
  date = rs.getString ("DATE PAID");        //CORRECT?
  amount = rs.getString ("AMOUNT BANK");
  attached = attached + details +":"+ '\n'+ "Date " +date+ " / "+  "Amount £"+ amount+ '\n'; // - ADDS MULTIPLE ENTRIES ON OUTPUT OF jList!
  DisplayAreaX.setText(attached);
  System.out.println(details+":"+ '\n'+ "Date "+date+ " / "+  "Amount £"+ amount+ '\n');
}

if (recordCount == 0) 
{
   DisplayAreaX.setText("ENTER VALID VENDOR");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T16:20:29.017

只需使用[do-while](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/while.html)语句代替 while :-)

# javascript - 在 jQuery 中选择第 n 个 div（及以后）

> ID：458897
> 
> 赞同：2
> 
> 时间：2009-01-19T19:47:35.073
> 
> 标签：javascript, jquery, traversal

假设我有一个`div`包含无限数量的 child `div`。有没有一种简单的方法让 jQuery 选择第*n*个`div`和`div`之后的每一个，以便我可以更改它们（在这种情况下，调用`remove()`old `div`s）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-19T19:53:08.337

你可以使用[":gt()"](http://docs.jquery.com/Selectors/gt#index)选择器：

```
 // div's 10 and higher
 $('div:gt(9)').show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T19:51:33.473

从我的脑海中输入这个和 jQuery API 文档（阅读：这未经测试），但我要做的第一件事是

```
$('#container div').slice(-n).remove(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T19:55:26.180

或者，如果您需要先对所有 div 进行操作：

```
$('div').css('color', 'red').filter(':gt(5)').remove(); 
```

# installation - Windows 安装程序的免费软件：NSIS 与 WiX？

> ID：458900
> 
> 赞同：70
> 
> 时间：2009-01-19T19:47:41.623
> 
> 标签：installation, wix, windows-installer, nsis

我需要选择一个软件包来安装软件。NSIS 和 WiX 似乎很有希望。你会推荐哪一个而不是另一个，为什么？

如果您认为它比这两个更好，请随时提供其他东西。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-01-19T19:58:08.797

如果您想在**今天**以最少的开销完成安装程序，请使用 NSIS。简单的脚本语言，良好的文档，速度快。

如果您想构建 MSI 文件，与 Windows Installer 事务系统集成，并有大量时间致力于学习 Windows Installer 使用的声明式模型，那么请查看 WiX。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-01-19T20:07:21.757

另外，也许给[Inno Setup](http://www.innosetup.com/isinfo.php)一个机会。当然，您可能会觉得它有点奇怪，因为它迫使您在 Pascal 中编写自定义代码，但话又说回来，几乎没有任何东西可以迫使您实际编写自定义代码 - Inno Setup 真的非常强大。

Inno Setup 还生成[EXE](http://en.wikipedia.org/wiki/EXE)安装程序 - 如果您希望您的应用程序可以在企业环境中轻松部署，您可能不得不走 WiX 路线，但就个人而言，作为一个用户，我遇到了相当多与 MSI 相关的问题，我个人更喜欢 MSI 缓慢而可怕地死去（嗯 - 实际上，此时快速死去是有利的 - 但它很可能很可怕），所以继续做 EXE 文件的事情。

所以。

*   **NSIS**：要求您学习一门新语言。创建 EXE 安装程序。
*   **WiX**：声明式设置创建，虽然有点低级。它当然需要一些基本的 MSI 知识，我发现通过普遍缺乏简单的教程很难获得这些知识。
*   **Inno Setup**：允许您使用简单的、主要基于 .INI 文件的语法创建功能强大的 EXE 安装程序，但如果您需要自定义编码，它会迫使您学习 Pascal。

作为一名资深的[Delphi](http://en.wikipedia.org/wiki/Embarcadero_Delphi)编码员，我总是使用 Inno Setup，尽管这可能非常有偏见（我从 1996 年左右开始就是 Inno Setup 的粉丝）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-19T21:28:55.650

这几乎是 * [What is the best selection for building Windows installers](https://stackoverflow.com/questions/3767)的副本，所以我建议您查看那里的很多很多答案（那里也有一些关于商业替代方案的讨论）。

您需要问自己的问题是：我是否需要与 SMS/ [Active Directory](http://en.wikipedia.org/wiki/Active_Directory)部署的企业部署方案兼容？如果答案是肯定的，那么[请学习 MSI 基础知识](https://stackoverflow.com/questions/286715/recommended-resources-for-learning-about-windows-installer)。

如果您想发布一个真正只是为了好玩或不需要在企业环境中获得支持的应用程序，并且您不想花大量时间来加快速度，那么学习 NSIS。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-19T19:57:43.430

NSIS 会给你一个 exe，WiX 会给你一个 MSI。

我使用 NSIS 将几个 MSI 安装程序打包到一个 exe 中，并进行了一些额外的检查，我无法弄清楚如何使用 VS.NET 安装项目。

INNO Setup 是您可能想要查看的另一个安装程序。它比 WiX 更接近 NSIS，但它使安装程序看起来更像标准安装程序而不是 NSIS 安装程序。

我没有使用 WiX，因为我不喜欢用于构建安装程序的 XML 定义语言，而且我不知道它是否支持打包其他依赖的 MSI

在这三个中，我最喜欢 NSIS，因为它有最好的文档。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-19T20:04:36.333

我在工作中使用 NSIS（我把它带进来并转换了我们旧的 InstalShield 东西），我确实喜欢它。

我不能说其他选项，但是 NSIS 对于更复杂的安装程序流程可能会很棘手，而脚本语言对于更详细的事情来说有点原始（更像是汇编程序而不是高级语言）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-19T20:03:29.423

就我个人而言，我只尝试过 WiX。它有一个稍微陡峭的学习曲线（除非你设法为它找到一个漂亮的图形 UI），但最终应该得到回报，因为它使用 Windows Installer 格式（MSI）而不是像（我相信）NSIS 那样的自定义 EXE . WiX/MSI 的声明式方法现在普遍受到青睐，被认为更可靠。但是，如果您只是想要一个快速简单的解决方案，NSIS 可能是一个选择，因为它应该有许多示例和良好的支持基础（尽管我个人只会使用 Visual Studio 安装包来完成类似的事情）。[这篇博](http://discuss.joelonsoftware.com/default.asp?design.4.619909.14)文似乎很好地讨论了这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-08T17:56:34.363

我用过 NSIS。我不能真正评论其他人，但是我认为有很多评论有助于做出客观的决定（如果你还没有的话）。HMNSIS 软件非常适合为简单的应用程序创建简单的安装程序。它有一个内置向导，是 NSIS 的好小 IDE。

我也同意它是一个文档齐全的免费软件。但是，就像我说的那样，由于我不需要其他任何东西（因为我喜欢 NSIS），我无法比较。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T21:12:58.687

你应该看看[InstallJammer](http://www.installjammer.com/)。它不仅是免费的，而且是跨平台的并且非常易于使用。最常见的操作根本不需要任何脚本，但在底层使用强大的脚本语言，您可以让安装做任何您想做的事情。

如果您只需要一个基本的安装程序来安装您的应用程序，那么您可以在第一次启动后的几分钟内构建它。如果你想要更强大的东西，功能和文档都很棒。

# excel - Excel：如何根据其他列中的文本值在列中创建一个数字？

> ID：458902
> 
> 赞同：2
> 
> 时间：2009-01-19T19:47:43.903
> 
> 标签：excel

我有一个包含重复值的文本列，例如：

```
 |    A    | 
---|---------|
 1 | emails  |
 2 |  foo    |
 3 |  foo    |
 4 |  bar    |
 5 |  bar    |
 6 |  stuff  |
 7 |  stuff  |
 8 |  stuff  | 
```

我想做的是有另一列带有数字，以便每个数字与第一列中的值匹配，例如：

```
 |    A    |    B    | 
---|---------|---------|
 1 | emails  | number  |
 2 |  foo    |    1    |
 3 |  foo    |    1    |
 4 |  bar    |    2    |
 5 |  bar    |    2    |
 6 |  stuff  |    3    |
 7 |  stuff  |    3    |
 8 |  stuff  |    3    | 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T20:20:45.630

首先，在单元格 B2 中放置一个数字 1，然后在 B3 中放置以下公式并填写：

```
=IF(A3=A2,B1,B1+1) 
```

这假设您的“电子邮件”列中的字符串已经排序（即：重复项都彼此相邻）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T20:23:52.487

假设重复的值总是相邻的（没有“foo, bar, foo”），你可以使用这个：

```
 A B
1 X 0
2 a 1
3 a 1
4 b 2
5 b 2
6 c 3
7 d 4
8 d 4
9 d 4 
```

B2为“=IF(A2=A1,B1,B1+1)”，然后向下填充到B9

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T20:24:35.013

取决于您所说的价值-

如果您的意思是“重复组”，那么像这样的宏可能会起作用 -

```
 Sub Check()
    Dim start As Integer
    start = 1
    For Row = 2 To 12
        Cells.Item(Row, 2) = start
        If Cells.Item(Row, 1) <> Cells.Item(Row + 1, 1) Then
            start = start + 1
        End If
    Next
End Sub 
```

如果您的意思是“取 A 列中每个值末尾的数字”，那么这可能有效 -

```
 Sub Check()
    Dim i As Integer
    Dim value As String
    Dim number As String
    Dim c As String
    For Row = 2 To 12
        number = ""
        value = Cells.Item(Row, 1)
        For i = 1 To Len(value)
            c = Mid(value, i, 1)
            If IsNumeric(c) Then
                number = number & c
            End If
        Next
        Cells.Item(Row, 2) = number
    Next
End Sub 
```

**编辑**- 根据 OP 的评论，我猜它们的意思是“重复组”，但我会将两个代码示例都留在这里。

**编辑**- 将代码复制并粘贴到 Excel Visual Basic 编辑器中，然后单击播放。将常量 2​​ 和 12 替换为开始行和结束行的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T20:11:35.790

有多种方法可以做到这一点，具体取决于数据表的确切性质。

如果您的文本列中的重复值受到限制，例如小于 10，那么您可以硬编码一些嵌套的 if 语句。

```
If(A1="mail1", 1, If(A1="mail2", 2, If(... etc. 
```

我不建议这样做，因为它有点笨拙，您最多只能有 7（？）个嵌套 IF 语句，并且如果您想将另一个工作表中的代码用于不同的值，则不是很可重用。

如果您知道文本词干始终具有相同的长度，例如在您的示例中，“mail”始终是前缀并且长度为 4 个字符，那么您可以使用以下公式：

```
RIGHT(A1,LEN(A2)-4) 'The "4" denotes the length of the string "mail" 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T20:21:00.090

您已经编辑了问题以从 A 中的文本中取出数字，因此**MID**和**RIGHT**不再起作用，您可能需要的功能是**LOOKUP()**。基本上，您需要设置另一个表，其中仅包含 A 的唯一值以及它们应该映射到的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T20:38:17.793

如果我正确理解了您的问题，则数据可能已排序，并且需要按 A 列中的不同值进行编号，因此“foo”为 1，“bar”为 2，依此类推，以获取 A 列中的唯一值。

我会使用 VBA 和字典来构建列表：

```
Public Sub UpdateMapValues()
    Dim MappedValues As New Scripting.Dictionary
    Dim oSheet As Worksheet
    Dim Name As String
    Dim Index As Long
    Dim Number As Long
    Dim LastNumber As Long
    Set oSheet = ActiveSheet
    LastNumber = 0
    For Index = 2 To oSheet.UsedRange.Rows.Count
        Name = oSheet.Cells(Index, 1).Text
        If Not MappedValues.Exists(Name) Then
            LastNumber = LastNumber + 1
            Number = LastNumber
            Call MappedValues.Add(Name, Number)
        Else
            Number = MappedValues(Name)
        End If
        oSheet.Cells(Index, 2).Value = CStr(Number)
    Next Index
End Sub 
```

这将更新 B 列中的数字。您还可以将单元格引用（例如“A2”或“A5”）放在 B 列中，您可以将其用于其他 Excel 函数。

为了使用 Scripting.Dictionary，只需在 Tools\References 中添加一个引用并选择 Microsoft Scripting Runtime。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-12T15:48:33.677

您是否尝试为每个文本列项目自动分配一个数字，并在每次重复时在另一列中引用该数字？例如，给定以下文本项，您是否想要这样的输出：

富 1 酒吧 2 酒吧 2 富 1 东西 3 东西 3

如果是这样，有一个简单的非 vba 解决方案：

在单元格 b2 中输入值 1。将公式 =IFERROR(VLOOKUP(A3,A$2:B2,2,FALSE),MAX(B$2:B2)+1) 放入单元格 b3 中。将单元格 b3 中的公式复制到数据列表的底部。

对于此解决方案，我假设列标题位于第 1 行。

# c# - 如何获取外键引用的表

> ID：458913
> 
> 赞同：6
> 
> 时间：2009-01-19T19:49:35.490
> 
> 标签：c#, sql-server, smo

我有一个小问题我还没有找到答案：我如何在 c# 中使用 Microsoft.SqlServer.Smo 获取外键列所指的表？

```
foreach (Column column in currentTable.Columns) {
        if (column.IsForeignKey) {
                 //GET TABLE FOREIGN KEY REFERS TO
          }
   } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T19:55:51.593

您应该从表本身开始，并枚举它的所有外键。示例代码：

```
foreach (ForeignKey key in currentTable.ForeignKeys)
{
    foreach (ForeignKeyColumn column in key.Columns)
    {
        Console.WriteLine("Column: {0} is a foreign key to Table: {1}",column.Name,key.ReferencedTable);
    }
} 
```

编辑：小变化。在第二个foreach循环中使用foreach（key.Columns中的ForeignKeyColumn列）（我之前有foreach（key.Columns中的列），这是错误的。我的错误。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-20T17:59:03.080

使用 SMO dll

[http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.table.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.table.aspx)

# vim - 在vim中搜索单词？

> ID：458915
> 
> 赞同：177
> 
> 时间：2009-01-19T19:49:57.237
> 
> 标签：vim

我可以在 vim 中搜索单词`/word`。我怎样才能只搜索`word`，不包括搜索`word1`和`word2`？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2009-01-19T19:51:19.230

像这样：

```
/\<word\> 
```

`\<`表示词的开头，也`\>`表示词的结尾，

添加@Roe 的评论：
VIM 为此提供了一个快捷方式。如果屏幕上已有*单词*并且想要查找它的其他实例，您可以将光标放在单词上并按下`'*'`以在文件中向前搜索或`'#'`向后搜索。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2015-12-14T10:01:19.470

1.  vim 文件名
2.  按 /
3.  输入您要搜索的单词
4.  按回车

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2016-08-11T07:11:37.827

如果您在 Ubuntu 中工作，请按照以下步骤操作：

1.  按`/`并输入单词进行搜索
2.  要向前搜索，请按“SHIFT”键和 `*`键
3.  要向后搜索，请按“SHIFT”键和`#`键

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2018-01-05T11:36:32.327

对于基本搜索：

*   /pattern - 向前搜索模式
*   ?pattern - 向后搜索
*   n - 重复前向搜索
*   N - 向后重复

您可能要设置的一些变量：

*   :set ignorecase - 不区分大小写
*   :set smartcase - 使用任何大写字母的用例
*   :set incsearch - 将匹配显示为搜索

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-22T19:10:27.727

基本搜索（一旦您在 中打开文件`vim`）使用`vim`：

-点击`ESC`你的电脑键盘

-点击键盘上的正斜杠符号`/`

- 键入您要搜索的单词或符号；例如，要搜索术语“rbmq”类型`/rbmq`

-打`Enter`

- 按**n**向前搜索（向文件末尾移动），按**N**向后搜索（向文件开头移动）

# css - 想让 CSS 文本换行在 IE7 中工作

> ID：458922
> 
> 赞同：0
> 
> 时间：2009-01-19T19:51:42.677
> 
> 标签：css, internet-explorer, css-float

以下代码在 FF3 中表现出色，但在 IE7 中不起作用。有谁知道如何解决它？

```
<div style="padding-top:3px;padding-bottom:5px;width:650px;background:blue">
    <div style="height:50px;float:left;display:inline;width:500px;background:gray">http://www.brainsolis.com/2008/10/twitter-tools-for-comunity-and-love-for-...</div>
    <div style="width:100%;text-align:right;float-right;background:yellow">saaal is saaa twittertool ds ds dsdfsdsdfsdfsdfsdfsdfsd sdf dsf sdf sdf sdf sd ssssssssssssssssssssssssssssssssssssssssssssssssssss</div>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T19:56:06.443

您不需要*浮动*元素，同时*display:inline*。此外，您不需要为 DIV 元素设置*width:100%*。它们自然会占用所有可用的水平空间。

以下 CSS 应该可以实现您所尝试的。

```
div.container {

}
  div.floated {
    width:50px;
    float:left;
  }
  div.textbody {
    /* styles */
  }
  br.clear {
    clear:both;
    height:0;
    line-height:0;
  }

<div class="container">
  <div class="floated">
    <p>This is floated</p>
  </div>
  <div class="textbody">
    <p>...text body...</p>
  </div>
  <br class="clear" />
</div> 
```

有关 CSS 的更多信息，请查看[w3schools](http://www.w3schools.com/Css/default.asp)或[在 SampsonVideos 观看 CSS 视频](http://www.sampsonvideos.com/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-13T21:12:06.493

我没有检查你的样本，但这为我解决了 IE 包装问题：

```
div
{
  word-wrap: break-word;  /* for IE, force it to wrap text and keep it inside the div */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-08T03:12:20.230

css word-wrap 指令对我有用

在 ie6、7、8 和 chrome 中尝试过（像往常一样，即使没有它，Firefox 也会正确包装我的文本）

似乎是 IE 发明，但也兼容 css3 ( [http://www.css3.com/css-word-wrap/](http://www.css3.com/css-word-wrap/) )

# zend-framework - Zend_Loader 找不到我的文件？

> ID：458927
> 
> 赞同：0
> 
> 时间：2009-01-19T19:52:44.390
> 
> 标签：zend-framework, zend-loader

我正在关注Zend Forms 上的[本教程。](http://akrabat.com/2008/02/21/simple-zend_form-example/)我逐字复制它，我得到了这个错误

> 致命错误：在第 10 行的 /Quickstart/application/controllers/IndexController.php 中找不到类“forms_ContactForm”

这让我相信它没有加载到类中，所以我将它添加到我的 IndexController.php 文件中

```
Zend_Loader::loadClass('forms_ContactForm'); 
```

这是我收到的主要错误，我相信这是因为它找不到我的 form_ContactForm.php 文件，我不确定为什么。

这是我的文件夹层次结构：
快速入门
   应用程序
      控制器
      表单
      布局
      视
   图库
   公共
[链接到完整错误文本](http://www.levijackson.net/Quickstart/public/)

任何帮助将不胜感激，
列维

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T20:02:33.200

您的包含路径设置为：

> . （相对于当前目录）
> /usr/lib/php
> /usr/local/lib/php
> ../library'

由于您的“表单”文件夹不直接位于上述任何包含路径下，因此包含命令将不起作用。

要解决此问题，请将 /application/ 目录添加到包含路径并重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:45:31.087

正如 Shane 所说，您应该在包含路径中包含“应用程序”文件夹。这应该在您的“index.php”引导文件中完成：

```
set_include_path(
    '/paht/to/application' 
    . PATH_SEPARATOR . get_include_path()
); 
```

此外，您可以通过将其添加到引导文件中来告诉 Zend Framework 自动加载所有类：

```
Zend_Loader::registerAutoload(); 
```

这将使您不必手动加载您使用的每个类。

# keyboard - 我可以将键盘快捷键分配给 Microsoft Intellitype 键盘吗？

> ID：458930
> 
> 赞同：1
> 
> 时间：2009-01-19T19:53:45.777
> 
> 标签：keyboard, keyboard-shortcuts

任何人都知道我是否可以为 Microsoft 键盘收藏键 1-5 分配一个键盘快捷键，例如`Ctrl`+ `F4`（用于关闭 IE/Firefix 等中的当前选项卡）。

我安装了 Microsoft 键盘软件，我只能浏览到我想运行的应用程序，并且似乎看不到可以分配快捷方式的其他任何地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T13:51:38.737

麻烦的是它需要按下 2 次按钮 - 只是在寻找一个按钮按下可能使用用户定义的按钮 1 到 5 来快速关闭选项卡/窗口等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:24:22.317

解锁小键盘顶部的功能按钮，然后使用 F6/关闭键；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T23:35:50.713

有一种方法！我以前做过！现在我不知道我是怎么做到的。由于默认播放暂停不起作用，我将所有媒体键配置为 Control-alt-home 和类似的东西以与 Winamp 匹配。但我不知道我是怎么做到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-04T20:36:55.337

我在这里找到了一些东西：

[http://musingsfromtheunderground.blogspot.com/2010/02/using-microsoft-natural-ergonomic.html](http://musingsfromtheunderground.blogspot.com/2010/02/using-microsoft-natural-ergonomic.html)

它使用 Autohotkey 完全放弃了 Intellitype 软件。Autohotkey 可以发送任何类型的按键，例如，

```
Send ^{F4} 
```

将发送 Ctrl+F4。任何其他组合键都取决于您的想象，更不用说您可以使用 Autohotkey 编写几乎任何您想要的脚本并将这些功能分配给最喜欢的键。

# c# - 扩展一个 TypeConverter

> ID：458935
> 
> 赞同：3
> 
> 时间：2009-01-19T19:54:43.653
> 
> 标签：c#, .net, typeconverter

DateTimeConverter 类提供 DateTime 和字符串之间的转换。我还想支持 DateTime 和 double 之间的转换。

根据 MSDN，我可以扩展 DateTimeConverter 类来执行此操作 - 请参阅[MSDN DateTimeConverter](http://msdn.microsoft.com/en-us/library/system.componentmodel.datetimeconverter.aspx)

我创建了一个继承自 DateTimeConverter 并为 CanConvertTo、CanConvertFrom 等提供适当覆盖的类。

当调用以下代码时，如何确保框架使用我的 DateTime 转换器 (DateTimeConverterEx) 而不是 BCL (DateTimeConverter) 中提供的转换器？

```
 DateTime dt = DateTime.Now;
    // This line returns a DateTimeConverter which I don't want. 
    // Would like to get a DateTimeConverterEx.
    TypeConverter tc = TypeDescriptor.GetConverter(dt);
    double dbl = (double)tc.ConvertTo(dt, typeof(double)); 
```

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T19:56:57.627

您需要分配转换器。在逐个属性的基础上，您可以使用：

```
[TypeConverter(typeof(DateTimeConverterEx))]
public DateTime Foo {get {...} set {...}} 
```

这将适用于表单的使用：

```
var prop = TypeDescriptor.GetProperties(obj)["Foo"];
var converter = prop.Converter;
// as before, using "converter" 
```

这适用于最常见的绑定场景。

（**编辑**）

为**任何** `DateTime`设置转换器：

```
TypeDescriptor.AddAttributes(typeof(DateTime),
    new TypeConverterAttribute(typeof(DateTimeConverterEx))); 
```

现在您的示例代码应该可以工作了。

# python - wxPython 在应该抛出异常时不会抛出异常，而是给出原始错误消息

> ID：458943
> 
> 赞同：4
> 
> 时间：2009-01-19T19:56:09.690
> 
> 标签：python, exception, wxpython

我正在为我用 python 编写的应用程序编写菜单，使用 wxPython 库作为用户界面，并且我正在尝试将图标添加到某些菜单项。因为我试图对此认真负责，所以我试图限制如果引用的图像文件之一不存在所造成的损害，最简单的方法（在我看来）是使用异常。

问题是，当我链接到一个不存在的文件时，不会引发异常。相反，我收到一个可怕的消息框，说明：

`Can't load image from <path>: Image does not exist.`

这条消息正是我试图阻止的类型，但即使使用最广泛的异常捕获语句也没有任何作用。

这是一个精简版，从我所写的内容中获取似乎相关的内容：

```
NewProject = wx.MenuItem(File, -1, "&New Project\tCtrl+N", "Create a new project")
try:
    # raises an error message but not an exception
    NewProject.SetBitmap(wx.Image( <path>  ), wx.BITMAP_TYPE_PNG).ConvertToBitmap())
except Exception:
    pass 
```

所以这些是我的问题：我做错了什么？当有其他方法解决它时（尽管在我的脑海中似乎不是那么简单），我是否朝着错误的方向接近这个问题，过于强调异常？这是 wxPython 库中的错误吗，因为我很确定它应该抛出异常，即使它不是最好的解决方法？

ps 谷歌搜索可以做的最好的事情是建议我使用 wxPython 附带的模块将所有图像转换为 python 代码`img2py`，但我更愿意将图像保留为图像格式以用于我正在做的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T20:13:41.197

这是一个已知问题。[Robin Dunn](http://alldunn.com/robin/)回答了几次：只需创建您的 Logging 方法，例如：

```
dummy_log=wx.LogNull() 
```

当变量`dummy_log`超出范围时，将再次启用正常日志记录。

# xml - 两个大列表的高效映射

> ID：458954
> 
> 赞同：3
> 
> 时间：2009-01-19T19:58:25.190
> 
> 标签：xml, xslt, xpath, xquery

我的任务是编写一些 XSLT 2.0 来将一个 XML 文档转换为另一个 XML 文档。我对 XSLT 比较陌生，但在我做这件事的日子里我学到了很多东西。在此期间，我不得不映射简单的值，即 002 -> TH 等。这对于少于 10 个值的小列表来说很好，我使用了 xsl:choose。但是，我需要将 300 多个值从一个列表映射到另一个列表，反之亦然。每个列表都有一个值和文本描述。这两个列表值并不总是直接映射，因此我可能必须比较文本描述并在必要时使用默认值。

我有两个解决这个问题的方法：

1.  使用 xsl:choose: 如果任何一个列表发生更改，我认为这可能会很慢并且可能难以更新。

2.  拥有一个 XML 文档与每个列表项之间的关系。我会使用 XPath 表达式来检索关联的值：这是我的首选解决方案，因为我相信它更易于维护且更易于更新。虽然我不确定它是否有效。

我应该使用什么解决方案，我的建议之一，还是有更好的方法来映射这些值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T14:48:02.960

这是一个**XSLT 2.0 解决方案**。

# 源 XML 文件：

```
<input>
  <data>001</data>
  <data>002</data>
  <data>005</data>
</input> 
```

# “映射”xml文件：

```
<map>
  <default>?-?-?</default>
    <input value="001">RZ</input>
    <input value="002">TH</input>
    <input value="003">SC</input>
</map> 
```

# XSLT 转换：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>

  <xsl:param name="pmapFile" 
       select="'C:/temp/deleteMap.xml'" />

  <xsl:variable name="vMap" 
       select="document($pmapFile)" />

  <xsl:variable name="vDefault" 
       select="$vMap/*/default/text()" />

  <xsl:key name="kInputByVal" match="input" 
   use="@value" />

  <xsl:template match="/*">
    <output>
      <xsl:apply-templates/>
    </output>
  </xsl:template>

  <xsl:template match="data">
    <data>
        <xsl:sequence select= 
         "(key('kInputByVal', ., $vMap)[1]/text(),
           $vDefault
           )[1]
         "/>
    </data> 
  </xsl:template>
</xsl:stylesheet> 
```

# 输出：

```
<output>
  <data>RZ</data>
  <data>TH</data>
  <data>?-?-?</data>
</output> 
```

**请注意以下几点**：

1.  **使用该[`document()`](http://www.w3.org/TR/xslt20/#function-document)函数**访问“映射”xml 文档，该文档存储在单独的 XML 文件中。

2.  **使用[`<xsl:key/>`](http://www.w3.org/TR/xslt20/#element-key)和 XSLT 2.0[`key()`](http://www.w3.org/TR/xslt20/#function-key)函数**来确定和访问每个对应的输出值。第三个参数指定必须访问和索引的 xml 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T00:43:35.427

这是一种方法来做你想做的事，使用一个`<xsl:key>`，否则遵循你的方法二。

示例输入文件 (data.xml)：

```
<?xml version="1.0" encoding="utf-8"?>
<input>
  <data>001</data>
  <data>002</data>
  <data>005</data>
</input> 
```

示例地图文件 (map.xml)：

```
<?xml version="1.0" encoding="utf-8"?>
<map default="??">
  <entry key="001">RZ</entry>
  <entry key="002">TH</entry>
  <entry key="003">SC</entry>
</map> 
```

示例 XSL 样式表，解释如下：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" 
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" encoding="utf-8" indent="yes"/>

  <xsl:param name="map-file" select="string('map.xml')" />
  <xsl:variable name="map-doc" select="document($map-file)" />
  <xsl:variable name="default-value" select="$map-doc/map/@default" />
  <xsl:key name="map" match="/map/entry" use="@key" />

  <xsl:template match="/input">
    <output>
      <xsl:apply-templates select="data" />
    </output>
  </xsl:template>

  <xsl:template match="data">
    <xsl:variable name="raw-value" select="." />
    <xsl:variable name="mapped-value">
      <xsl:for-each select="$map-doc">
        <xsl:value-of select="key('map', $raw-value)" />
      </xsl:for-each>
    </xsl:variable>
    <data>
      <xsl:choose>
        <xsl:when test="$mapped-value = ''">
          <xsl:value-of select="$default-value" />
        </xsl:when>
        <xsl:otherwise>
          <xsl:value-of select="$mapped-value" />
        </xsl:otherwise>
      </xsl:choose>
    </data>
  </xsl:template>
</xsl:stylesheet> 
```

这是做什么的：

*   用于`document()`打开`map.xml`，将生成的节点集保存到变量中
*   保存默认值以供进一步参考
*   准备一个`<xsl:key>`针对“地图”节点集的工作
*   `<xsl:for-each>`不作为循环使用，而是作为在调用`key()`函数之前切换执行上下文的一种方式 - 否则`key()`将针对“数据”文档起作用并且不返回任何内容
*   找到函数对应的节点`key()`，保存到变量中
*   检查输出上的变量值 - 如果它为空，则使用默认值
*   重复（通过`<xsl:apply-templates>`）

这个巧妙`<xsl:for-each>`技巧的功劳归功于[Jeni Tennison](http://www.oxygenxml.com/archives/xsl-list/200101/msg00217.html)，他在 XSL 邮件列表中描述了该技术。请务必阅读主题。

针对 data.xml 运行样式表的输出：

```
<?xml version="1.0" encoding="utf-8"?>
<output>
  <data>RZ</data>
  <data>TH</data>
  <data>??</data>
</output> 
```

所有这些都是 XSLT 1.0。我确信存在一个更好/更优雅的版本，它利用了 XSLT 2.0 提供的优势，但不幸的是，我对 XSLT 2.0 并不太熟悉。也许其他人发布了更好的解决方案。

* * *

## 编辑

通过 Dimitre Novatchev 在评论中的提示，我能够创建一个相当短且更可取的样式表：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" 
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" encoding="utf-8" indent="yes"/>

  <xsl:param name="map-file" select="string('map.xml')" />
  <xsl:variable name="map-doc" select="document($map-file)" />
  <xsl:variable name="default" select="$map-doc/map/default[1]" />
  <xsl:key name="map" match="/map/entry" use="@key" />

  <xsl:template match="/input">
    <output>
      <xsl:apply-templates select="data" />
    </output>
  </xsl:template>

  <xsl:template match="data">
    <xsl:variable name="raw-value" select="." />
    <data>
      <xsl:for-each select="$map-doc">
        <xsl:value-of select="(key('map', $raw-value)|$default)[1]" />
      </xsl:for-each>
    </data>
  </xsl:template>
</xsl:stylesheet> 
```

但是，这需要一个稍微不同的映射文件才能在 XSLT 1.0 中工作：

```
<?xml version="1.0" encoding="utf-8"?>
<map>
  <entry key="001">RZ</entry>
  <entry key="002">TH</entry>
  <entry key="003">SC</entry>
  <!-- default entry must be last in document -->
  <default>??</default>
</map> 
```

# cruisecontrol.net - 为 CruiseControl.NET 1.4.2 配置电子邮件发布者时检测到未使用的节点

> ID：458958
> 
> 赞同：1
> 
> 时间：2009-01-19T20:01:49.273
> 
> 标签：cruisecontrol.net, email-publisher

我正在尝试将我的 CruiseControl.NET 服务器配置为向源代码贡献者发送电子邮件；但是，我似乎无法正确配置电子邮件发布者。我从 CruiseControl.NET 收到以下错误。

> 异常：检测到未使用的节点：<subjectSettings><subject buildResult="Success" value="构建成功！有一个cookie！"/></subjectSettings>

这是我的配置。真实的电子邮件地址已被更改以保护无辜者。

```
<publishers>
    <xmllogger />

    <email from="abs@companyx.com" mailhost="email.companyx.com" includeDetails="true" >
        <users>
            <user name="john@companyx.com" group="buildMasters" address="john@companyx.com"/>
            <user name="jane@companyx.com" group="buildMasters" address="jane@companyx.com"/>
            <user name="joe@companyx.com" group="developers" address="joe@companyx.com"/>
            <user name="jill@companyx.com" group="developers" address="jill@companyx.com"/>
            <user name="jerry@companyx.com" group="developers" address="jerry@companyx.com"/>
        </users>
        <groups>
            <group name="buildMasters" notification="always"/>
            <group name="developers" notification="change"/>
        </groups>
        <modifierNotificationTypes>
            <NotificationType>Failed</NotificationType>
            <NotificationType>Fixed</NotificationType>
            <NotificationType>Success</NotificationType>
        </modifierNotificationTypes>
        <subjectSettings>
                <subject buildResult="Success" value="Build Successful! Have a cookie!" />
        </subjectSettings>
    </email>

</publishers> 
```

如何正确配置电子邮件发布者以避免此错误？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-02-19T21:59:11.897

我在运行 1.4.4 版时遇到了这个问题，并收到与此类似的发布者错误：

> 未使用节点检测到通知 =“总是”

我正在使用[Email Publisher](http://ccnet.sourceforge.net/CCNET/Email%20Publisher.html)文档，但无法找出问题所在。原来文档中有错误；在组块下`notification`已更改为`notifications`. 组块现在应为：

```
<groups>
    <group name="buildMasters" notifications="always"/>
    <group name="developers" notifications="change"/>
</groups> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T18:46:46.740

您是从头开始构建 CruiseControl 吗？因为看起来该功能仅在几周前才被检查，如果您使用的是其中一个版本，则该功能不存在。

# linq-to-sql - 在运行时确定的 Linq to SQL 查询

> ID：458962
> 
> 赞同：2
> 
> 时间：2009-01-19T20:02:21.313
> 
> 标签：linq-to-sql

查询条件的数量由用户在运行时的选择决定，即

```
var results= from r in db.Table 
             where condition A && condition B && ... condition XX... 
```

处理此问题的最佳方法是构建字符串变量并附加到它，还是有其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T20:13:25.567

尝试使用扩展方法。您可以使用这些来根据变量的值自定义查询。否则，您可以查看VS2008 示例中的[Dynamic Linq](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。

```
 var query = db.Table;
 if (lookForX)
 {
     query = query.Where( t => t.fieldX == X  );
 }
 if (lookForY)
     query = query.Where( t => t.fieldY == Y );
 } 
```

# visual-studio - Visual Studio 2005 停止添加代码隐藏文件

> ID：458970
> 
> 赞同：1
> 
> 时间：2009-01-19T20:03:20.127
> 
> 标签：visual-studio, visual-studio-2005, code-behind

今天早上，当我尝试向我的项目中添加一个新的 ASPX 页面时，Visual Studio 决定我不再需要任何与之关联的 .CS 文件。尝试添加 Web 控件会产生相同的结果：没有 .cs 的 .ascx 文件。到目前为止，我有两个问题：

1.  考虑到周末没有对系统进行任何更改，这可能是什么原因？
2.  现在重新安装VS是唯一的选择吗？

我在 Windows XP SP3 上运行 Visual Studio 2005 SP1。

谢谢！

编辑：谢谢大家。复选框在某些时候没有被选中，我根本没有看到它。我将在星期一责怪这个...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T20:09:46.043

有一个您可能不小心取消选中的复选框：将代码放在单独的文件中[（来源：][[msdn.com](http://blogs.msdn.com/blogfiles/mikeormond/WindowsLiveWriter/NewWebItemTemplatesinVisualStudioOrcasBe_CC5B/image%5B9%5D.png)][）]
[![对话](https://i.stack.imgur.com/ILKs6.png)](https://i.stack.imgur.com/ILKs6.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:05:57.470

这可以被 ASP.NET MVC 人认为是一个特性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T20:08:00.257

通常，有一个复选框询问您是否要将代码放在单独的文件中。这个框是否在某个时候被取消选中（所以它现在是默认的）？很容易养成点击这些常见对话框的习惯，而不会注意到它可能已经改变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T20:08:03.173

我问一个明显的问题并不是要粗鲁，但是您是否确保在创建页面时选中了“将代码放在单独的文件中”复选框？

# bash - 为命令格式化 bash 变量

> ID：458972
> 
> 赞同：5
> 
> 时间：2009-01-19T20:03:49.050
> 
> 标签：bash, shell

在我的 bash shell 中，我想使用不同编号的参数调用程序 n 次，该参数必须采用固定格式，例如“%02i”

一种方法是：

```
for ((i=23; i<42;i++)); do 
    sh ../myprogram `printf "%02i\n" $i`
done 
```

有没有办法改进`printf..`零件？我相信这可能是更多文件的性能瓶颈，并且使该行的可读性低于内置函数（尤其是在压缩为单行时）。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-19T20:16:28.820

在 Bash 中，`printf`由 shell 提供（参见[bash(1) 手册页](http://linux.die.net/man/1/bash)，搜索“printf”），因此您甚至没有执行单独命令的（最小）开销`fork()`——`exec()`除非您从在反引号内。Bash 的内置 printf 允许您将输出分配给带有参数的给定变量`-v`；您的脚本片段可以重写为：

```
for ((i=23; i<42;i++)); do 
    printf -v ii "%02i\n" $i
    sh ../myprogram $ii
done 
```

我不确定我是否认为它比原版更具可读性。

脚本片段中资源最密集的部分是调用其他 shell 脚本；除非有进一步的证据表明，否则我不会担心调用 printf 的开销。

*编辑以添加反引号和直接执行之间的区别*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T20:24:58.320

您的号码已经有 2 位小数。那你为什么需要使用 printf 呢？如果我没记错的话（这里没有用于测试的外壳），当与这些标志一起使用时，它只会将数字填充到小数点后 2 位。就个人而言，我喜欢 xargs：

```
seq 23 42 | xargs -n1 sh ../myprogram 
```

您可以使用`-w`参数 for `seq`，必要时用零填充数字，因此它们具有相同的宽度。

事实证明`seq`是 linux 特定的。感谢 Dave 在评论中找出答案（他的[回答](https://stackoverflow.com/questions/458972/format-bash-variable-for-command#459070)）。直接使用`printf`，无需循环：

```
printf '%02i\n' {23..42} | xargs -n1 sh ../myprogram 
```

我喜欢使用`xargs`，因为它可以轻松地并行运行您的命令，达到一定的限制，一次可以传递多个数字并允许其他灵活的选项。像 Dave 一样，我建议您删除`sh`它，并将其放入您的 shell 脚本中，作为第一行：

```
#!/bin/sh
..... 
```

然后只需执行你的东西

```
printf '%02i\n' {23..42} | xargs -n1 ../myprogram 
```

这更通用，并且允许您的脚本也被`exec`C 库调用调用（至少在 Linux 中是这样）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T20:37:47.093

仅供参考：完全不同的解决方案：

```
jot -w "%02i" - 23 42 | xargs -n 1 ../myprogram 
```

这具有调用[jot](http://www.freebsd.org/cgi/man.cgi?query=jot&apropos=0&sektion=0&manpath=FreeBSD+7.1-RELEASE&format=html "jot(1) 手册页")的性能缺点（自 4.2BSD 以来的标准，因此所有 BSD 衍生产品都有它，但快速浏览一下，我看到的 Linux 发行版似乎缺少这个基本的美妙工具）。 **编辑**：Linux（至少 Red Hat）似乎在一个名为[seq](http://www.freebsd.org/cgi/man.cgi?query=seq&apropos=0&sektion=0&manpath=Red+Hat+Linux%2Fi386+9&format=html "seq(1) 手册页")的命令中具有 jot 功能的子集（感谢 litb 对此信息的[回答](https://stackoverflow.com/questions/458972/format-bash-variable-for-command#459041)）。

这也有在非 bash shell 中工作的好处（与某些人的想法不同，活跃使用的 shell 不止一个，并且与 shell 无关的解决方案通常是个好主意）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T20:20:21.870

怎么样

```
for i in {23..42} ; do
    sh ../myprogram $i
done 
```

23 到 42 之间的数字总是采用 %02i 格式。

如果您绝对必须格式化，那么

```
for i in {23..42} ; do
    printf "%02i\n" | xargs -n1 sh ../myprogram $i
done 
```

用生成 xargs 的开销代替生成反引号的子shell 的开销。我不知道哪个更有效。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-07-18T21:40:35.883

尝试：

```
seq -w 23 41 
```

这将自动填充前导 0 到所需的大小

或者：

```
seq -f "%02g" 1 29 
```

这将格式化为精确的 2 位数字。

所以完整的命令将是：

```
for i in `seq -f "%02g" 23 41`; do 
    sh ../myprogram $i
done 
```**********