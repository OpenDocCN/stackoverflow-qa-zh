# StackOverflow 问答 000402000-000402999

# registry - 我的卸载过程如何正确处理还原注册表项？

> ID：402017
> 
> 赞同：0
> 
> 时间：2008-12-31T01:16:39.597
> 
> 标签：registry, uninstallation

有时需要在应用程序安装期间修改 Windows 注册表设置。我最近对卸载时不恢复这些设置的应用程序感到沮丧。当我对此进行更多思考时，我突然想到可能没有一种好的（或有效的）方法来保存和恢复注册表设置。以以下事件序列为例：

1.  应用程序 A 拥有文件扩展名的打开操作`.abc`。
2.  应用程序 B 已安装，并劫持文件扩展名的 Open 操作`.abc`。
3.  应用程序 A 已卸载。
4.  应用程序 B 已卸载。

在第 3 步，如果应用程序 A 足够聪明，它将检测到它不再拥有 Open 操作，因此将跳过任何恢复它的尝试。

在第 4 步，应用程序 B 是否可以采取任何有效的操作？

*   什么都不做会使 Open 操作指向已删除的可执行文件。
*   恢复指向应用程序 A 的指针同样是一个已删除的可执行文件。
*   不允许询问用户，因为这通常被认为超出了典型用户的技术技能。如果您不同意，请在步骤 1 和 2 中替换您认为超出用户回答范围的不同注册表更改。
*   删除该动作同样需要用户稍后做出不知情的决定，或者使某些功能对用户不可用。

这只是我可以设想的许多糟糕情况之一，其中没有明显的唯一“正确”解决方案。我的下一个项目将需要在安装期间更改注册表，我想知道卸载的最佳或推荐做法。不幸的是，我被当前商业软件包中不良的卸载实践所困扰，所以我知道这里没有关于最佳实践的共识，要么做很多工作才能做到这一点，要么就是注册表中的设计缺陷， 或两者。

这对我来说是一个非常现实的编程问题。我将其标记为主观，因为我不确定是否有任何一刀切的***正确***答案。请随意不同意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T01:21:39.027

如果您正在编写应用程序 B，那么我会说首先不要劫持 .abc 扩展名的 Open 操作。在安装过程中，询问用户是否要将 .abc 文件与您的程序相关联。在卸载期间，检查您的程序是否仍然关联。如果是这样，请取消关联文件扩展名，否则不要理会它。

如果在您卸载 B 后还有另一个应用程序仍希望与 .abc 文件关联，那么很难 - 让用户修复它。毕竟，他同意将 .abc 文件与您的应用程序关联，然后卸载您的应用程序。

# performance - 什么是 SQL Like 运算符的合适替代品以提高性能？

> ID：402022
> 
> 赞同：6
> 
> 时间：2008-12-31T01:18:38.703
> 
> 标签：performance, windows-mobile, sql-server-ce, memory-management, sql-like

我正在开发一个在 Windows Mobile 6 上运行的应用程序，该应用程序需要能够从项目表中检索所有项目，这些项目表中包含项目描述字段中的给定字符串（由最终用户提供）。问题是表中有大约 170,000 个项目。由于我需要在描述中的任何位置返回包含字符串的所有项目，因此我不得不使用 LIKE %string%，这消除了使用索引的任何机会。数据和表结构最初基于 Progress 数据库，该数据库在任何单词索引字段上都有一个精彩的 contains 运算符。我们的移动应用程序并非如此，因为它使用 SQL Server Compact 3.5。

基本上，我的 DAL 运行查询并检索 SqlCeDataReader，然后使用 ItemFactory 创建仅包含匹配项的 List 对象。这显然让我们将域/业务对象与数据访问层分开。

很好，花花公子，除了当我搜索描述中包含“高尔夫”之类的所有项目时检索项目所需的 8m 和 42s。显然，这不是最终用户可接受的时间范围。

我的第一次尝试是使用 SELECT * FROM Item" （在一个主要索引字段上使用 order by 子句）从数据库中检索所有项目。此时，我在运行 SqlCeDataReader 时运行了 IndexOf 检查并有ItemFactory 仅在项目包含请求的描述文本时才将项目添加到 List 对象。这将速度提高到 1m 46s。不是太破旧，但仍然太慢。

然后我尝试了另一种显示承诺的方法......几乎......当应用程序启动时，我尝试创建一个包含数据库中所有项目对象的列表（运行查询并填充整个列表大约需要 2 分钟，但是至少在应用程序初始化时只有一次......仍然......呃）。列表完成后，我可以轻松地在该列表上运行查询，执行以下操作（我希望我的语法是正确的......我现在不在工作，我的电脑上没有 Visual Studio 我我坐在）：

```
List<Item> specificItems = 
    AllItems.FindAll(i => i.Description.IndexOf(searchString, StringComparison.OrdinalIgnoreCase) >= 0); 
```

这种方法将其降低到 21 秒。非常好（尽管在宏伟的计划中仍然很慢）。但是，问题是如果我从数据库中加载所有项目，内存使用量太大了。在初始加载期间，我实际上不得不切断最后 20,000 个项目（因此 21 秒的时间范围可能更像是 25 秒），因为抛出了 OutOfMemoryException。根据模拟器上的内存管理器，我仍然有大约 20 MB 的可用 RAM，但我听说一个进程只能有 32 MB 或与之关联的 RAM（不确定 WM 6 是否如此，但它似乎所以）。

为了确保这不是因为我使用 List 对象来保存所有项目（我在其构造函数中使用所需的容量对其进行实例化以避免动态调整大小），我还读过它可能会导致额外的内存使用隐式调用 EnsureCapacity，我尝试使用 Item[] 数组（提前调整大小）。这仍然存在内存问题，并且大小差异可以忽略不计。

好吧，足够的漫无边际。我知道我可能不得不限制数据读取器从数据库返回的记录（通过对不同类型字段的一些索引搜索），然后可能会在较小的项目子集上使用 indexOf 以获得最大性能（因此一起跳过 Like 运算符）。这将导致最终用户必须输入的不仅仅是描述搜索（也许是项目层次结构信息来限制要搜索的项目类型）。

有任何想法吗？我会以错误的方式解决这个问题吗？

感谢收听（抱歉这篇文章很长，我有点想大声）。

哦，我应该添加（只是总结）我正在使用的内容：

*   视窗手机 6
*   Sql Server 精简版 3.5
*   C# 3.5

更新：虽然下面提到的布隆过滤器方法看起来很有趣，但我无法满足一个要求（我没有在上面真正指定）。我无法真正匹配包含在其他单词中的单词（例如“club”不会返回“clubs”）。因此，我被迫完全使用不同的方法（Kent Fredric ......感谢您指出这一点）。我已将 Kent 的答案标记为正确的答案，因为他的方法是满足最多要求的方法（Mitch，你的问题与 Jaunder 建议的 Bloom 过滤器类似）。但是，我也采取了与他不同的方法（目前......）。

我所做的是将所有项目对象拉入内存，只有项目编号和描述（这使其保持在内存限制之下，但是它仍然会导致比我喜欢的更长的初始化......多线程并在幕后加载该信息我猜在应用程序运行时可以解决这个问题）。为了执行我自己编写的包含例程的搜索。该例程是用非托管 c# 代码编写的，该代码使用两个指针和几个循环来运行描述和所需的匹配文本。如果它在描述的任何地方找到匹配项，它会将项目编号添加到数组中。搜索完所有项目后，新的查询将返回数据库并仅获取匹配的项目编号（由于整数字段上的索引，这非常快）。然后这些项目将在包含所有信息的列表中创建（不仅仅是项目编号和描述）。整个操作大约需要 5 - 10 秒（取决于描述），这对于现在来说已经足够了。

我仍然会考虑进一步优化这个（可能能够跟踪搜索词有多少个字符......如果项目描述中剩余的字符少于所需的文本，则循环可以直接继续到下一个项目） .

仍然欢迎任何建议。现在，我已将肯特的回答标记为我的问题的“最正确”。

感谢 Dolch 帮助我编写 contains 例程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T01:27:07.377

如何预处理（一次）项目表（并且需要处理添加到其中的每个新条目），以创建一个单词出现表

```
CREATE TABLE WordItemOccurance
(
    [Word] varchar(50) not null,

    ItemId int not null
        constraint FK_Items references ItemTable(ID)
) 
```

遍历所有项目，分解成单独的单词，并在找到条目时将条目添加到出现表中。

在 [Word] 上创建聚集索引并在 ItemId 上加入 Item 表应该很快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T01:44:39.650

我投票支持[Mitch Wheat 的](https://stackoverflow.com/questions/402022/what-is-a-suitable-replacement-for-the-sql-like-operator-to-increase-performance#402033)答案，但我也将测试一些技巧以验证其有效性。

我对有一个充满 [char],[int] 的表的最大担心是你可能仍然会发现自己执行大量毫无意义的字符串比较，特别是如果你在这个新表上使用 %word% 。（重复但不匹配我们的搜索条目）。

我可能会选择体验

```
Words
-----
chars  | word_id 

WordsToEntry
------------
word_id | entry_id 
```

看看数据库开销是否值得缓解这个可能的问题（我无法测试，抱歉）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T02:23:12.163

您可以尝试使用布隆过滤器。

1.  [维基百科](http://en.wikipedia.org/wiki/Bloom_filter)
2.  [使用布隆过滤器](http://tinyurl.com/7g8fa8)

# macos - MacBook Air 是否适合偶尔的开发工作？（Ruby、Objective C、Cocoa）

> ID：402026
> 
> 赞同：15
> 
> 时间：2008-12-31T01:22:11.753
> 
> 标签：macos

**MacBook Air 是否有足够的马力用于偶尔使用 Ruby 进行开发？目标C？可可？**

这样做还有其他主要限制吗？

笔记：

*   我把它连接到一个大显示器上。
*   我希望使用标准的主流 Mac IDE。
*   我知道 MacBook 或 Pro 会更合适，但它们根本不那么酷。
*   这台机器主要用于网页等，非常像家用电器。
*   你猜对了——我是一个无知的 Windows 开发者 :)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-31T13:56:03.043

你是个好伙伴：Wil Shipley（[Delicious Monster](http://www.delicious-monster.com/)和其他著名 Mac 软件的创建者）使用他的 MacBook Air 进行开发（[引用](http://www.wilshipley.com/blog/2008/02/macbook-air-rambling-first-impressions.html)）。他的第一代 SSD 比他之前使用的 MacBook Pro 更快。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T01:57:56.410

MacBook Air 有一个令人讨厌的习惯：虽然它有一个双核 CPU，但一旦机器过热，它就会关闭其中一个。一旦您使用 XCode，就会经常发生这种情况。这使您有效地以单 CPU 机器结束。

XCode 是一个资源匮乏的野兽，经常扫描您的源代码以了解其代码完成意识等。两个内核可以让您有效地以两倍的速度构建。（一个技巧是使用一个隐藏设置来告诉 Xcode 为编译启动多少进程 - 默认设置为内核数，但这不会导致 CPU 充分利用。但是当将其设置为更高的值时，例如，在双核 Mac 上为 3，它将更好地利用 CPU。要达到此设置，请安装“Secrets”预窗格。）

我会推荐一台全尺寸的 MacBook，甚至是 Pro 版。或者看看可以运行 OS X 的更轻的 PC 笔记本电脑。我自己还没有尝试过，但阅读了一些报告，称某些 PC 可以配置为开箱即用安装 OS X，并让 OS X 更新本身没有问题。

注意：不过，我正在使用 Xcode 构建更大的项目，其中完整的重建可能需要一分钟或更长时间。YMMV。

**2011 年 4 月更新：** 我写的是关于最初的 MacBook Air。新型号（2010 年推出）在这方面可能会更好，但我不确定。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T01:37:29.587

仅当您打算在星巴克使用它进行编码时。

我在开玩笑。大多数类型的开发不需要那么大的马力。几乎任何消费级别，甚至预算级别的笔记本电脑都应该足以用于 Ruby 和 Objective C 开发，尤其是“偶尔开发”。空气属于这一类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-08T22:04:18.650

是的。我全职使用我的 Air，而不仅仅是偶尔的开发工作。我确实怀念拥有更大的屏幕，但老实说，并没有那么多。我使用 TextMate 和 XCode 在 Rails 中编码。

我爱爱爱的空气是多么轻盈。我可以在沙发上使用它几个小时而不会出现问题或连接电源。这很了不起。

至于作为一个无知的Windows开发者，这也是我的背景。我不仅发现过渡几乎没有痛苦，而且我还发现我现在明白为什么 Mac 人说“它只是工作”。并不是说它只是有效，而是有无数的小东西让人感觉非常好，以至于整体体验非常愉快。

我（修改后的）唯一的愿望：我拥有性感的新 11 英寸 Air，而不是第一代的对比。尽管如此，还是很开心。

ETA：我现在有了性感的新 11 英寸 Air，它非常适合开发，尽管它几乎需要在全屏模式下工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T01:30:04.517

是的。虽然我不使用，但我认识一些 Ruby 开发人员会使用。

还...

“我知道 MacBook 或 Pro 会更合适，但它们根本就没有那么酷。”

天啊...大声笑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T02:40:36.840

Apple 通常使用很少的 RAM 设置其机器。即使对于 Mac Pro 也是如此（即使我有四个 Xeon，我的也只有区区 1GB）。Mac OS X Leopard 也很饿。

因此，如果您打算使用 Eclipse 之类的密集型 IDE，我建议您避免使用空气。

此外，这可能看起来很傻，但大多数 IDE 使用白色背景。实际上，您可以通过将大部分屏幕设置为黑色并使用较浅颜色的字体来节省大量电池电量。您可以在通用访问面板中切换这种否定。如果您在远离空调的情况下使用空气进行开发，这可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T02:20:14.680

确保您使用 nvidia 芯片组获得最新版本，因为它比上一代更能驱动外部显示器。

此外，新的一体式 Macbook 在外观和感觉上与空气非常相似，而且价格更便宜，规格更高。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T06:48:15.310

以我的经验，你可以塞进 Mac 的内存越多，它就会越好。我使用了 Mac Mini =) 一段时间，它的 RAM 严重受限。内存升级后工作正常。

至于黑色背景，看看[Nocturne](http://nocturne.en.softonic.com/mac)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-02T01:44:01.443

Control-alt-cmd-8 将为您提供“更黑”的屏幕以节省电池:)

我有一个 17" MBP，它有 4GB Ram。当我在做 perl/LAMP/Cocoa 时很好。现在我在 VM 中做了很多 C#/.Net，我主要迁移到 Mac Pro . 笔记本电脑上的 4GB 还不够。

我认为如果 Shipley 可以在他的 MBAir 上编写 Cocoa 代码，那么您也可以。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-11-12T00:02:20.690

我刚刚购买了一个新型号的 13" Air、2.1 Gz、4Gb、256 Gb SSD。它干净地构建了我当前的 Java 项目，用时不到我以前的一体式 MacBook 的一半，它有更快的 CPU，但普通的旧 rust 磁盘.

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-12T15:53:21.217

你有互联网吗？

如果是这样，任何带有 ssh 的 nix 系统都可以让您链接到更专用的开发环境。我曾经在 Fedora 上使用过这个糟糕的上网本，在登录时它会使用 sshfs 从工作中挂载我与开发相关的目录，我可以直接潜入……充分利用 8 个内核和 32Gb 的 RAM。一切都来自我卑微的渴望。

# iphone - OpenGL ES 可滚动列表框裁剪问题

> ID：402031
> 
> 赞同：4
> 
> 时间：2008-12-31T01:26:07.737
> 
> 标签：iphone, listbox, opengl-es, listboxitems

我正在尝试在 OpenGl ES（用于 iPhone/iTouch）中创建一个通用列表框，并且在裁剪 ListBoxItems 时遇到了一些难题。每个 ListBoxItem 对象都知道如何绘制自己。我正在制作的 ListBox 只会一个接一个地绘制。但是如果项目的数量大于 ListBox 怎么办？我需要能够上下滚动（不是问题）ListBoxItems。这将是一个平滑滚动，因此有时 ListBoxItem 将有一半（或更多或更少）可见，而另一部分将被隐藏，因为它位于 ListBox 区域“外部”。当我制作我的 ListBox 小部件时，如何让这个剪辑正常工作？

感谢您提供的任何帮助或链接，

〜埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T01:31:49.240

如果您需要裁剪渲染，请使用 glScissor！

```
 void glScissor( GLint x,
          GLint y,
          GLsizei width,
          GLsizei height ) 
```

# iis-7 - SubText 和 IIS 7 的集成管道模式

> ID：402034
> 
> 赞同：0
> 
> 时间：2008-12-31T01:27:52.227
> 
> 标签：iis-7, integrated-pipeline-mode, subtext

开箱即用，SubText 无法在 IIS7 的集成管道模式下运行。不幸的是，它超出了“迁移” web.config 以匹配所需格式的范围。例如，将 httpModules 和 httpHandlers 移动到 . 事实证明，在集成模式下运行时，Application_Start 处的 Request 不可用，这也会导致 SubText 失败。

如果我们不向现有的、由 GoDaddy 托管的 ASP.NET 网站添加博客功能，我们将有两个选择：更新 SubText 代码库以不使用请求上下文（加上修复任何其他表面）或简单地运行 SubText在经典模式下。

不幸的是，我们当前的 GoDaddy 帐户受到限制，因为我们只能使用一个应用程序池。由于主站点配置为集成管道模式，因此我们无法在不影响（阅读：破坏）主站点的情况下自由更改 IIS 模式。

没有切换到更灵活的主机，目前的计划是将主站点修改为以经典模式运行。这是一个简单的站点，将 web.config 恢复为经典模式格式应该没什么大不了的。或者，我正在考虑更新 SubText 代码库以不使用 Application_Start 处的请求上下文。我还没有听说有人在集成模式下运行 SubText，这可能是一个很好的解决问题——假设必要的更新已经结束。

假设还有大约 8 个小时分配给这项工作，最好的方法是什么？我错过了任何其他选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-15T06:27:59.303

不幸的是，在部署 Subtext 2.1.2 时，我没有要测试的 IIS 7 安装。在即将发布的 Subtext 2.5 中，我们可以很好地使用 IIS 7 集成模式。不幸的是，2.5 还没有出来。

如果您对前沿技术满意，您可以从我们的后备箱尝试最新版本。它非常稳固，我们几乎完成了。如果您要升级现有博客，则可能具有挑战性。如果您要安装一个新的，这可能是一个很好的尝试。

[http://build.subtextproject.com/builds/archive/SubText-2.5.0.228.zip](http://build.subtextproject.com/builds/archive/SubText-2.5.0.228.zip)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T20:17:51.077

作为后续，我们快速注释掉了引用请求上下文的 Application_Start 代码。这个实验导致了更多的例外。我们现在正在对主站点进行修改以在经典模式下运行。

# java - 在跳到 JavaEE 之前我应该 做更多的 JavaSE 吗？

> ID：402056
> 
> 赞同：6
> 
> 时间：2008-12-31T01:41:21.437
> 
> 标签：java, jakarta-ee

我几乎读完了“Head First Java”一书。我研究这个的原因是我希望有一天能找到一份使用 JavaEE 开发的工作。现在我在想，我应该继续学习 EE（继续学习 Head First Servlets 和 JSP）还是应该花更多时间在 SE 上？这会有帮助吗？我会继续直接说我想在最快但最优化的时间内学习 EE（一种平衡的方式）。有什么建议吗？

提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T02:03:34.323

对我来说，使用 JavaEE 很好，因为你已经做了足够的 SE。当然，在编程论坛上闲逛会不时教会你一些仍然对你隐藏的东西。相信我会有很多。无论如何，我对你的建议很少，这将帮助你走上这条路。

*   最好对 Java Collection API 有一个很好的命令
*   另一个重要的是要了解Java Threading Mechanism 和相关的类
*   《Effective Java》是任何 Java 开发人员的必读之书。所以去读吧
*   在充分练习纯 Servlet 和 JSP 之前不要跳入任何框架
*   了解主要的设计模式是必须的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T01:50:13.930

知识从来都不是坏事，所以推荐更多的 SE。

但是现在用 EE 弄湿你的脚并没有错。从 servlet、JSP 和 JDBC 开始。你可以用这些做很多有用的事情，称之为EE是公平的。

如果您确实编写 JSP，只需确保以正确的方式进行 - 使用 JSTL，即 JSP 标准标记库。没有脚本代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T05:03:19.593

优秀的开发人员总是可以轻松掌握 API。糟糕的开发人员很容易滥用 API。因此，首先要成为一名优秀的开发人员。

我总是不喜欢“转向 J2EE”这个术语，因为 J2EE 只是松散相关技术的集合。

有人可以构建构建 servlet 和 JSP，但对 EJB 一无所知，反之亦然。有人可以使用 Hibernate 进行持久性或使用 JMS 发送消息，而无需考虑 J2EE（例如我的情况）。

API 来来去去，但最重要的是成为核心 Java 的可靠开发人员。如果您愿意，请阅读足够多的教程以了解主要概念，甚至可以在业余时间玩一下。了解线程、数据库等重要概念。

例如，在使用 hibernate 之前了解 JDBC。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T04:52:30.287

我同意这个建议，因为从学习核心 Java 进入 J2EE 是可以的。也就是说，我会不断磨练你的核心 Java 技能。

当我在我的团队中寻找我想要的 J2EE 开发人员时，我会寻找知道如何通过最大限度地利用 JDK 来编写简单的可维护代码的人。您应该对集合 API 了如指掌。您绝对应该练习有效 Java 中给出的建议。最终，您将不得不了解线程的一些微妙之处（第 1 步：保持对象不可变；第 2 步：参见第 1 步）。

顺便说一句，如果您在纽约地区，请发表评论，也许我们可以离线联系。

澄清：每个有趣的 Java 应用程序都需要业务逻辑和使用普通的旧 Java 对象 (POJO)。简单地说，这包括 J2EE 应用程序，无论是 Web 应用程序、供 Web 应用程序使用的框架，甚至是 J2EE 应用程序服务器本身。一旦 Java 开发人员开发了一个“玩具”应用程序服务器，这通常是一种大开眼界的体验。在那之后，J2EE 变得容易多了。

在我看来，真正的 J2EE “绝地大师”知道如何将应用服务器拆分为基本的核心 Java 组件。例如，EJB 是通过添加使用 RMI 网络协议以及事务管理器进行远程过程调用的能力来包装业务 POJO 的代理。如果您了解 RPC、RMI 和事务，那么您了解 EJB 的机会就会迅速增加。

或者用 Joel Spolsky 的话说，J2EE 是一个建立在 J2SE 网络 API 之上的泄漏抽象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T05:49:45.147

您已准备好使用 JavaEE。

当您使用它时，您将使用 JavaSE for JavaEE 是 JavaSE + 新库。

对我来说，学习新技术的最好（几乎唯一）方法实际上就是在研究它。我试图阅读和了解 JSP（早在 2000 年）或任何新框架，但我只是觉得无聊。

在我真正得到一些可以应用它的项目之前，我从来没有得到过 Hibernate 或 EJB。

我已经阅读了很多 spring 并且可能我可以通过面试，但是由于我从未在项目中使用过它，所以我不认为我自己知道它（尽管我知道它是如何工作的，配置文件甚至新的变化）。

所以我的建议是，如果你能负担得起，不管薪水不好，都找一份工作，任何 JSP 项目都尽快动手。学习将比任何书籍、训练营、课程或任何你能得到的东西都要好得多。

可能这只对我有用。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T09:05:51.693

我在没有足够的基本 Java 知识的情况下开始研究 JavaEE，我非常后悔！

JavaEE 不仅仅是一组额外的 API，它包含来自 EAI、SOA 和 DB 的许多概念。试图掌握这些概念、学习 API 并仍然了解基础 - Java，是一个真正的挑战。

JavaEE 听起来确实令人兴奋，但如果您想要生成干净、易于测试和正确的代码，我的建议是：从 Java SE 开始。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-31T02:01:50.363

当我们开始 J2EE 时，除了 SE 之外，我们没有人编写过任何代码。我会去的。

# vb6 - 当 Printer.Print 到“仅通用文本”打印机时，线条会被修剪

> ID：402062
> 
> 赞同：0
> 
> 时间：2008-12-31T01:45:45.357
> 
> 标签：vb6, text, printing

我正在维护一个打印 ZPL-II 的旧 vb6 应用程序。

我只是发现如果我通过“ **Printer.Print** ”将长行打印到打印机有一个错误，这些行将被修剪为仅前 89 个字节/行。**当我在 DOS 中使用打印**或**复制**到 LPT时，它可以完美运行并保持线条不变。

这种行为从何而来？我该如何解决它或解决方法？我想支持所有打印机，包括 LPT、USB 和网络打印机。

PS。我通过打印到文件而不是 LPT 来仔细检查发送到打印机的实际字节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-31T15:48:28.120

您需要使用 Printer.TextWidth 函数并将其与 Printer.ScaleWidth 属性进行比较，以便在 Visual Basic 6 中处理此问题。它不像 DOS 函数那样为您自动换行。

您将确保打印机设置的字体与打印机的字体正确匹配。这可能需要使用驱动程序附带的“打印机”字体之一。否则尝试使用固定空格字体 Courier New。否则，文本宽度值不会正确报告宽度。

另一种方法是使用 Len 字符串函数来计算字符数并在超过 89 个字符时自行处理截断。

类似的东西

```
 Do Until LineToPrint = ""
    TempD = Len(LineToPrint)
    If TempD > 89 Then
      Print Mid$(LineToPrint,1, 89)
      LineToPrint = Right$(LineToPrint,TempD-89)
    Else
      Print LineToPrint
      LineToPrint = ""
    End If
  Loop 
```

如果你喜欢递归函数，你可以这样写

```
Private Sub PrintLine(ByVal LineToPrint As String, ByVal Width As Integer)
    TempD = Len(LineToPrint)
    If TempD > Width Then
      Printer.Print Mid$(LineToPrint, 1, Width)
      LineToPrint = Right$(LineToPrint, TempD - Width)
      PrintLine LineToPrint, Width
    Else
      Printer.Print LineToPrint
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-09T08:52:37.123

我正在努力不使用 Printer.Print。但是使用 FileSystemObject 将文本文件打印到网络打印机的 UNC 路径。

它像奶油一样工作，但必须映射打印机。甚至是本地打印机。

# internet-explorer - Internet Explorer http 引用问题

> ID：402065
> 
> 赞同：6
> 
> 时间：2008-12-31T01:48:56.613
> 
> 标签：internet-explorer, http

看来我遇到了 Internet Explorer 7 的问题。我有一个 html 页面，其中包含指向另一台服务器上的文件的链接。我要链接的服务器检查请求的引用者，如果引用者有效，它允许访问资源。它在 Firefox 2 和 3 中运行良好（因为我的 html 页面所在的服务器是一个有效的引用者）但在 Internet Explorer 中它不起作用，另一台服务器拒绝我的资源（生成 http 403 错误）。我正在做一些搜索并偶然发现了这个[http://support.microsoft.com/kb/178066](http://support.microsoft.com/kb/178066)我已经尝试了 https 和 http 中的 html 页面以及我连接的服务器的相同内容但我什么也没得到 Internet Explorer . 我该怎么做才能解决这个问题？

谢谢你

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-31T02:17:52.657

您如何“获取”相关文件？

**如果您使用 JAVASCRIPT 访问文件，IE 将失败。**

IE 从一开始就有一个重大错误。

```
e.g. document.location.href = 'myNewPage.html'; //FAILS to pass referer in IE 
```

[Web Bug Track 上的错误 #421](http://webbugtrack.blogspot.com/2008/11/bug-421-ie-fails-to-pass-http-referer.html)

***也不会在 IE8 中修复！*** **:-(**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T02:08:01.507

无论如何，您可能想要使用不同的机制。推荐人很容易被欺骗。检查推荐人确实不是一个好的安全解决方案，如果它们会让你像这样头疼，也许你想找到另一种方法。

例如，生成第一个页面的服务器可以将授权令牌添加到第二个服务器的 URL，第二个服务器可以检查令牌是否有效。这样，所有细节都在您的控制之下，您所指望的唯一浏览器行为是将完整的 URL 发送到第二个服务器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-24T09:51:32.340

[我在http://dracoblue.net/dev/referer-with-documentlocation-is-broken-in-internet-explorer/145/](http://dracoblue.net/dev/referer-with-documentlocation-is-broken-in-internet-explorer/145/)找到了这个解决方案，但我自己没试过

```
function goto(url)
{
    var referLink = document.createElement('a');
    referLink.href = url;
    document.body.appendChild(referLink);
    referLink.click();
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T09:31:10.090

我已经解决了，将此代码包含在您项目的所有页面中

```
session_start();
if($_SERVER['SERVER_PORT'] == 443 )
    $http = 'https://';
else
    $http = 'http://';

$adress = $http.$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'];  

$_SESSION['referer'] = $_SESSION['current_page'];
$_SESSION['current_page'] = $adress;
$_SERVER['HTTP_REFERER'] = $_SESSION['referer']; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T13:41:21.017

我没有使用 IE7，所以我无法检查这个.. 但我想这应该没有问题：

```
<script type="text/javascript">
      document.location= "www.your-server.com/your_page.html?referrer=" + document.location.href;
</script> 
```

与第二台服务器相比，您可以检查referrer 参数的值，而不是依赖浏览器是否发送referrer。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-12-31T01:54:24.140

禁用防火墙和防病毒/或防间谍软件检查，看看是否有帮助。我知道这可能听起来很荒谬，但我亲眼目睹了许多在采纳此建议后问题奇迹般地消失的例子。

他们有时对什么是“安全”有过分热心的想法，并在进展中破坏浏览器行为。（如果您有 AVG 并且电子邮件有问题（pop3），请关闭 AVG 并观看电子邮件神奇地恢复工作状态）

# sql - 这个加入提示危险吗？

> ID：402077
> 
> 赞同：2
> 
> 时间：2008-12-31T01:56:35.930
> 
> 标签：sql, join, sql-server-2000, join-hints

一位同事要求我查看一些表的索引，因为他的查询运行时间很长。一个多小时。

```
select count(1)
from databaseA.dbo.table1
inner join databaseA.dbo.table2 on (table1.key = table2.key)
inner join databaseB.dbo.table3 on (table1.key = table3.key) 
```

注意不同的数据库。这是从 DatabaseB 运行的

表 1 和表 2 的记录超过 200 万条。Table3 有十几条记录。

我查看了查询计划，优化器决定对表 1 和表 2 进行嵌套循环索引搜索，表 3 作为驱动表！

我的第一个假设是 Tables1 和 2 上的统计信息严重混乱，但在更新统计信息之前，我尝试添加一个连接提示：

```
select count(1)
from databaseA.dbo.table1
inner HASH join databaseA.dbo.table2 on (table1.key = table2.key)
inner join databaseB.dbo.table3 on (table1.key = table3.key) 
```

结果在 15 秒内返回。

由于时间紧迫，我将结果反馈给了他，但我担心这可能会导致以后出现问题。

我应该重新审视统计问题并以这种方式解决问题吗？错误的查询计划可能是因为连接来自单独的数据库吗？

任何人都可以根据您的经验给我一些想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T01:59:24.503

我会首先怀疑统计数据。

毫无疑问，您应该知道，在 99% 的情况下应该避免加入提示，并且只有在您有证据证明它们是绝对需要时才使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T02:21:30.620

检查统计信息，并首先在表上建立索引。索引提示可能会导致问题。如果表中的数据发生更改，优化器将无法选择更有效的计划，因为您已强制它始终使用散列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T03:17:30.507

嵌套循环不是最合适的吗？取表 3 中的 12 条记录，匹配​​表 1 中的 12 条记录，匹配​​表 2 中的 12 条记录。

否则，您的哈希连接也会强制执行排序——这意味着您将从表 1 和表 2 中对 100 万条记录进行哈希处理，然后连接到表 3 中的 12 条记录。

我会查看这两个计划的统计信息 - 我怀疑循环连接实际上更有效，但被阻止或您的哈希连接正在利用缓存数据。

但是 - 是的 - 一般来说，加入提示是最后的手段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T15:01:20.640

涉及链接服务器的运行缓慢的查询可能与排序规则有关。有关一些背景信息，请参见此处：http: [//blogs.msdn.com/psssql/archive/2008/02/14/how-it-works-linked-servers-and-collat](http://blogs.msdn.com/psssql/archive/2008/02/14/how-it-works-linked-servers-and-collation-compatibility.aspx) ​​ion-compatibility.aspx 哈希连接提示强制排序，这样就解释了性能增益。

以下是设置选项的方法：

```
EXEC master.dbo.sp_serveroption 
    @server=N'databaseA', 
    @optname=N'collation compatible', 
    @optvalue=N'true'

EXEC master.dbo.sp_serveroption 
    @server=N'databaseA', 
    @optname=N'use remote collation', 
    @optvalue=N'false' 
```

-Edoode

# latex - 你可以在 LaTeX 中迭代吗？

> ID：402086
> 
> 赞同：6
> 
> 时间：2008-12-31T02:01:59.380
> 
> 标签：latex

我是 LaTeX 的新手，我必须说我真的很挣扎。我发现 \newcommand 命令有点像常规编程语言中的函数/方法。你可以给它论据和一切。

不过我想知道，我可以以某种方式在 LaTeX 中进行迭代吗？基本上，我想做的是创建一个包含 N+1 列的表，其中第一行只包含一个空白单元格，然后在其他列中包含数字 1、2、...、N。我只想将 N 作为这个“函数”（新命令）的参数。

这是一个可能看起来像我正在寻找的东西的示例（尽管显然这不起作用）：

```
\newcommand{\mytable}[2]{  
\begin{tabular}{l|*{#1}{c|}} % 表，第一个参数+1 列  
  for(int i = 1; i <= #1; i++) "& i" % 'output' 不同列中的数字  
  \\\hline  
  字母 & #2 % 第二个参数应该包含行的实际内容  
  \\\hline  
\end{表格}  
}
```

调用它：

```
\mytable{3}{a & b & c}
```

输出应该是：

```
        | 1 | 2 | 3 |
--------+---+---+---+
字母 | 一个 | 乙 | c |
--------+---+---+---+
```

有谁知道这样的事情是否可能？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T03:03:51.720

只需将以下内容放入一个新命令并确保使用 package `ifthen`。

```
\begin{tabular}{l|*{10}{c|}}
\newcounter{count}
\whiledo{\value{count}<10}{
\ifthenelse{\value{count}=0}{}{\the\value{count}}
\ifthenelse{\value{count}<9}{&}{\\}
\stepcounter{count}
}
letters&a&b&c&d&e&f&g&h&i\\
\end{tabular} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T02:07:24.410

谷歌阿姨说[是](http://mathematics.nsetzer.com/latex/latex_for_loop.html)的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-31T02:11:44.027

您可以使用`\loop`or`\repeat`标记。或者[`multido`](https://ctan.org/pkg/multido)包裹。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T02:08:13.317

当然有可能。你也可以复发。eplain 中有迭代宏，请参见，例如，[here](http://tex.loria.fr/texlive-htmldoc/eplain/eplain_6.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T04:18:00.643

另一种可能性（如果你像我一样懒惰）是[perltex](http://www.ctan.org/tex-archive/macros/latex/contrib/perltex/ "perltex")

# language-agnostic - 我可以从哪里开始设计网站

> ID：402089
> 
> 赞同：2
> 
> 时间：2008-12-31T02:04:54.337
> 
> 标签：language-agnostic

我想设计一个网站，但我不知道从哪里开始。

有初学者指南吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T02:21:31.837

您希望提供多少奉献精神？如果您只想设计一个快速而肮脏的网站，那么在线提供大量的开源 Web 模板，它们具有干净和基本的 HTML/XHTML 设计策略，您可以对其进行修改和提供内容。

比如[这个](http://www.oswd.org "OSWD")[那个](http://www.opendesigns.org/ "开放式设计")。_

或者，如果您想从头开始设计自己的网站并拥有该领域的完整技术知识（正确的方法）。拿起一两本关于 HTML/XHTML/XML 的书，以及关于内容管理系统、php 等的文档。

你很快就会发现，一开始你的发展是渐进的，充其量是缓慢的。如果您付出足够的努力，您会发现您可以自信地快速设计网站，从而最好地阐明您的内容。

你应该熟悉[这个](http://www.w3.org "w3")和[这个](http://www.w3schools.com "w3schools")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T02:07:05.907

[从头开始](http://www.webdesignfromscratch.com/)尝试这个网页设计

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T02:32:01.957

我理解网站是指某种网络应用程序。通过设计，您的意思不仅是页面设计，还有网络应用程序的设计。首先，您必须了解 Web 应用程序的结构。主要组成部分是：

*   **数据库**用于长期存储用户和应用程序数据。数据库提供查询功能 (SQL)、一个安装上的备份和另一个安装上的恢复、数据条目更改时的触发器以及数据表必须满足的约束。
*   **Web Server**也称为 Http Server 托管 Web 应用程序。
*   **Web 浏览器**，例如 Internet Explorer 或 Firefox。

当用户在 Web 浏览器中键入 URL 时，Web 服务器会将 URL 转发到相应的 Web 应用程序。Web 应用程序执行所需的任务（可能涉及读取或写入数据库）并通过 www 向用户返回一个新的 html 页面。

Web 应用程序的一些组件是：

*   **数据库访问对象**是封装与数据库表交互的对象的表示。
*   **业务逻辑**是应用程序的主要逻辑。例如，这里我们使用 Lucene 库来实现搜索功能。
*   **Action Handler**处理从用户接收到的 http 请求，例如当她键入 URL 或单击“提交”按钮时。这些是 Http GET 和 POST 请求。Action Handler 使用业务逻辑来驱动操作。
*   **Web 浏览器上的数据视图** 是使用一些模板库（通常为 Web 浏览器生成 javascript 用户界面代码）构建的。对于交互性，可以使用 Ajax 技术。

几乎所有的 Web 应用程序都将 Web 应用程序的模型、视图和控制器分开。视图处理显示，模型处理数据，控制器处理控制/功能。请参阅[http://www.uidesign.net/Articles/Papers/UsingMVCPatterninWebInter.html](http://www.uidesign.net/Articles/Papers/UsingMVCPatterninWebInter.html)。

有几个框架实现了 MVC。最容易上手的是[Ruby on Rails](http://guides.rubyonrails.org/getting_started_with_rails.html)和[Django （在其上也编写了一个名为](http://www.djangobook.com/en/1.0/chapter01/)[Pinax](http://pinaxproject.com/)的开源社交网络）。Java 中也有更全面的框架和库（对于单个 Web 应用程序，您可能需要加入其中的几个库），例如 spring、webwork、tapestry、lucene（用于搜索）、sitemesh（用于页面装饰）。许多 java web 应用程序运行在 tomcat web 服务器和 mysql 数据库上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T02:50:15.447

我从[http://w3schools.com](http://w3schools.com)开始。确保您使用的是[Firefox](http://www.mozilla.com/en-US/firefox/)和[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)插件。亲自动手，然后熟悉网页设计社区。

我的办公桌上有Andy Budd 的[*CSS Mastery*](https://rads.stackoverflow.com/amzn/click/com/1590596145)，它是一本很好的、可读的、简短的、但深入的 CSS 指南。

[*不要让我思考*](https://rads.stackoverflow.com/amzn/click/com/0321344758)也成为我网页设计的口头禅。

总的来说，在你变得好之前，你会产生很多废话——就像我一样。如果你有人监督你在做什么，那将是最好的帮助。不过，从长远来看，个人动力最重要，所以坚持下去并不断学习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T02:10:35.103

Liz Castro[也有一本好书](http://www.elizabethcastro.com/htmlvqj/)。

# asp.net - ASP.NET 的最简单/最佳隐藏/显示客户端隐藏/显示

> ID：402094
> 
> 赞同：3
> 
> 时间：2008-12-31T02:08:10.447
> 
> 标签：asp.net

我在页面上有一个 DropDownList 和一个 TextBox。当用户在 DropDownList 中选择“其他”选项时，我想在其右侧显示一个 TextBox。我不想使用传统的 PostBack 技术。我希望这种交互是客户端的。

我知道我可以获得对 DOM 元素的引用并将其样式设置为“display:none”或“display:”。我正在寻找的是内置在 ASP.NET 框架中的东西，用于处理这样的事情。我的意思是，在 jQuery 中，这就像`$('controlID').hide`. 有没有可以做到这一点的控制扩展器？jQuery 是 ASP.NET 框架的一部分吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T02:14:32.490

jQuery[将与 VisualStudio/ASP.NET MVC 一起分发](http://www.hanselman.com/blog/jQuerytoshipwithASPNETMVCandVisualStudio.aspx)，尽管我不会将其称为框架的一部分。我认为您可以随意使用它并相信它会得到支持。

请注意，Microsoft 已经表示他们将使用 jQuery 的主要开发线，因此代码本身与您可以从 jQuery.com 下载的代码没有任何不同，可能除了内置的 Intellisense 之外。

**编辑**：要设置您的功能，请从 jquery.com 下载代码。将它放在您的脚本文件夹中，或者您存储 javascript 内容的任何地方。将它的脚本引用添加到您的页面。使用 jquery 将 onchange 处理程序添加到下拉列表中，当下拉列表的值为 other 时显示文本框，否则隐藏它。下面的示例假定这`other`不是默认选择。如果您在 MasterPages 或 UserControls 中使用 runat="server" 控件，则需要调整 javascript 函数中的名称以考虑 ASP.NET 所做的名称修改。给它们唯一的 CSS 类并使用“.class”表示法而不是“#id”表示法引用它们可能更简单。

```
<script type="text/javascript" src="...pathtoscript../jquery.1.2.6.js"></script>
<script type="text/javascript">
   $(document).ready( function() {
       $("#DropDownListID").bind('change', function() {
           if (this.options[this.selectedIndex].value == 'other')
           {
               $("#TextBoxID").show();
           }
           else
           {
               $("#TextBoxID").hide();
           }
       });
   });
</script>

  ...

 <select id="DropDownList">
     <option value='first'>First</option>
      ...
     <option value='other'>Other</option>
 </select>
 <input type='text' id='TextBox' style='display: none;' /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T09:39:48.147

您还可以使用 asp.net 客户端框架（通过脚本管理器）来获取对元素的引用。但是你仍然必须使用正常的 DOM 操作。

```
$get('<%= myDropDown.ClientID %>').style.display = 'none'; 
```

只要确保您引用了脚本管理器即可。

对于如此简单的事情，我认为不值得参考 jquery，但也许你有更大的计划；-)

# sql - 带有大型数据集的 SQL 插入

> ID：402119
> 
> 赞同：3
> 
> 时间：2008-12-31T02:21:17.097
> 
> 标签：sql, database, oracle

当运行像“插入表”这样的查询时，我们如何处理提交大小？即来自 anotherTable 的所有记录是否都插入到单个事务中，或者有没有办法设置提交大小？

~~非常感谢~Sri~~ ~~PS：我是第一次来这里，这个网站看起来很不错！~~

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T02:22:55.283

在好的数据库中，这是一个原子语句，所以不，没有办法限制插入的记录数——这是一件好事！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-02T15:08:01.483

在原始发布者希望避免回滚空间问题的情况下，答案非常简单。回滚段的大小应该适应事务的大小，而不是相反。当你的事务完成时你提交。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T19:32:06.047

我已经用各种语言（主要是 Java）编写了代码来执行您所描述的批量插入。每次我这样做时，主要是通过解析一些输入文件或类似的东西，我基本上只是准备一个数据子集以从总量中插入（通常是 4000 个左右的批次）并将该数据提供给我们的 DAO 层. 所以它是以编程方式完成的。我们从未注意到这样做会对性能造成任何实际影响，并且我们正在处理几百万条记录。如果您要插入大型数据集，则无论您如何操作，该操作都将“花费一些时间”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-02T16:29:41.957

David Aldridge 是对的，当您希望 INSERT 整体成功或失败时，根据最大事务调整回滚段的大小。

一些替代方案：

如果您不关心能够回滚它（这就是该段的用途），您可以 ALTER TABLE 并添加**NOLOGGING**子句。但这不是一个明智的举动，除非您正在加载一个报表，在该报表中删除所有旧行并加载新行，或者其他一些特殊情况。

如果您可以接受某些行被插入而其他行由于某种原因而失败，那么使用*INSERT INTO* **LOG ERRORS INTO**语法添加对处理失败的支持。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T02:25:45.887

除非您明确编码，否则您无法处理提交大小。例如，您可以使用 where 循环，并编写一种方法来限制您选择的数据量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-01T22:14:31.243

“我想这样做是为了避免回滚段空间不足。此外，我希望看到结果定期填充到目标表中。”

第一个只是正确调整撤消表空间大小的问题。由于撤消是对现有行的删除，因此不需要很多空间。相反，删除通常需要更多空间，因为它必须拥有整个已删除行的副本才能重新插入以撤消它。

第二个，看看 v$sql 中的 v$session_longops 和/或 rows_processed

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T02:38:04.643

如果您需要限制数据集，请将该限制构建到查询中。

例如，用 Microsoft SQL Server 的说法，您可以使用“ `TOP` *`N`*”来确保查询只返回有限数量的行。

```
INSERT INTO thisTable
  SELECT TOP 100 * FROM anotherTable; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T02:45:29.060

我想这样做的原因是避免回滚段空间不足。此外，我希望看到结果定期填充到目标表中。

我不想使用 where 循环，因为它可能会增加性能开销。不是吗？

~斯里兰卡

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-31T19:40:47.513

没错，您可能希望批量运行大型插入。附加的链接显示了在 SQL Server 中执行此操作的方法，如果您使用不同的后端，您将执行类似的操作，但确切的语法可能不同。这是可以接受循环的情况。

[http://www.tek-tips.com/faqs.cfm?fid=3141](http://www.tek-tips.com/faqs.cfm?fid=3141)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-12T20:31:27.057

```
INSERT INTO TableInserted
SELECT *
FROM (
   SELECT  *,
          ROW_NUMBER() OVER (ORDER BY ID) AS RowNumber
   FROM TableSelected
) X
WHERE RowNumber BETWEEN 101 AND 200 
```

您可以很容易地将上面的内容包装到一个 while 循环中，用变量替换 101 和 200。这比一次做 1 条记录要好。

我不知道Oracle 哪些版本支持窗口函数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-08-17T15:57:05.053

这是一个扩展注释，用于证明将索引设置为 NOLOGGING 将*无助*于减少 INSERT 的 UNDO 或 REDO。

该手册暗示 NOLOGGING 索引可以通过减少 UNDO 和 REDO 来帮助改进 DML。由于 NOLOGGING 有助于表 DML，因此它也有助于 INDEX 更改似乎是合乎逻辑的。但是这个测试用例表明，将索引更改为 NOLOGGING 对 INSERT 语句没有影响。

```
drop table table_no_index;
drop table table_w_log_index;
drop table table_w_nolog_index;

--#0: Before
select name, value from v$mystat natural join v$statname where display_name in ('undo change vector size', 'redo size') order by 1;

--#1: NOLOGGING table with no index.  This is the best case scenario.
create table table_no_index(a number) nologging;
insert /*+ append */ into table_no_index select level from dual connect by level <= 100000;
commit;
select name, value from v$mystat natural join v$statname where display_name in ('undo change vector size', 'redo size') order by 1;

--#2: NOLOGGING table with LOGGING index.  This should generate REDO and UNDO.
create table table_w_log_index(a number) nologging;
create index table_w_log_index_idx on table_w_log_index(a);
insert /*+ append */ into table_w_log_index select level from dual connect by level <= 100000;
commit;
select name, value from v$mystat natural join v$statname where display_name in ('undo change vector size', 'redo size') order by 1;

--#3: NOLOGGING table with NOLOGGING index.  Does this generate as much REDO and UNDO as previous step?
create table table_w_nolog_index(a number) nologging;
create index table_w_nolog_index_idx on table_w_nolog_index(a) nologging;
insert /*+ append */ into table_w_nolog_index select level from dual connect by level <= 100000;
commit;
select name, value from v$mystat natural join v$statname where display_name in ('undo change vector size', 'redo size') order by 1; 
```

以下是统计查询的结果。这些数字是会话累积的。测试用例 #2 和 #3 在 UNDO 和 REDO 中的增加相同。

```
--#0: BEFORE: Very little redo or undo since session just started.
redo size      35,436
undo change vector size    10,120

--#1: NOLOGGING table, no index: Very little redo or undo.
redo size      88,460
undo change vector size    21,772

--#2: NOLOGGING table, LOGGING index: Large amount of redo and undo.
redo size   6,895,100
undo change vector size 3,180,920

--#3: NOLOGGING table, NOLOGGING index: Large amount of redo and undo.
redo size   13,736,036
undo change vector size 6,354,032 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-12T20:18:38.143

您可能只想使索引 NOLOGGING。这样表数据是可恢复的，但如果表恢复，则需要重建索引。索引维护可以创建很多撤消。

# javascript - 从 javascript 访问 Excel 工作簿

> ID：402123
> 
> 赞同：2
> 
> 时间：2008-12-31T02:22:04.223
> 
> 标签：javascript, excel

有没有办法使用 javascript 访问 Excel 工作表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T11:58:14.933

您可以使用 php 将 excel 转换为 csv 或 json，并使用 YUI Datatable 或 ExtJS 数据网格将其显示在数据表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T02:53:44.113

我想做类似的事情（在网页中显示 Excel 数据而不需要 Web 服务器）。在查看了选项后，我决定将数据导出为 XML 并使用 Javascript 进行处理。请参阅[w3schools 上](http://www.w3schools.com/XML/xml_examples.asp)的此页面（查找“使用 JavaScript 解析 XML”部分。事实证明，这比使用 ActiveX 组件直接访问 Excel 电子表格要容易得多。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-31T02:49:13.670

不。

为什么Excel工作表中的数据？我不知道您的应用程序，但无论您尝试做什么，我可能会建议将数据放入某个数据库表中。然后，您的网站可以使用 ASP 或 PHP 或您选择的语言从数据库中提取，而您现在使用 Excel 所做的任何事情都可以使用 Access 完成。

# svn - 回滚或恢复整个 svn 存储库到旧版本

> ID：402159
> 
> 赞同：76
> 
> 时间：2008-12-31T02:36:47.720
> 
> 标签：svn, revert

我搞砸了我的 SVN 存储库，现在需要将整个存储库从修订版 28 恢复到 24，并且不想处理差异或冲突。有没有一种快速简单的方法来做到这一点？我已经能够使用合并命令恢复单个文件 - 但在这种情况下，它希望将所有文件从修订版 28 添加回存储库，而我真正想做的只是删除它们。

我在 linux 机器（bash）上使用命令行。

谢谢

**编辑**

感谢所有的帮助！我通过以下方式修复了它：

```
svnadmin create /svnroot/<repo>.fixed
svnadmin dump -r 1:24 /svnroot/<repo> --incremental > dump.svn
svnadmin load /svnroot/<repo>.fixed < dump.svn 
```

然后将旧的 repo 放在备份位置并将 repo.fixed 移动到 repo。

再次感谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-31T03:23:58.450

查看 svnadmin 转储/加载。它会为您的文件的每个版本创建一个文本文件。可以删除高于/低于某个点的所有内容并重新导入。

参见例如[在其他地方迁移存储库数据](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-31T03:00:47.297

“反向”合并可能是您需要的。请参阅svn book 的[“撤消更改”](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo)部分。

例如 svn merge -r 28:24 [svn 的路径]

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-10-26T22:14:39.783

如果您可以访问 SVN 服务器，您只需编辑`path/db/current`，将您想要恢复到的旧修订号（此处：24）放在那里，然后从`path/db/revs/0/`. 至少今天这对我有用，因为我不小心删除了存储库中的一个目录。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-12-31T19:41:58.697

如果您确实需要擦除文件曾经存在的“证据”，则需要执行上述 svndump/svnload 操作。

在“正常”情况下，您犯了错误，您需要使用反向合并。这确保在 r24 之后撤消更改也可以恢复、区分等。

下面的命令应该可以撤消您的更改（您需要提交合并的结果以反映存储库中的合并）

```
svn merge -r 28:24 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-08-30T11:37:43.903

如果您没有使用管理员权限，那么您将无法删除任何旧版本，但是您仍然可以使用一个非常简单的“svn copy”命令将它们隐藏得非常好（nickf 和 JesperE 已经提到了这一点，但以一种相当神秘的方式）

> svn 删除协议：//svnserver/some/resource
> svn 复制协议：//svnserver/some/resource@24 协议：//svnserver/some/resource

就是这样，修订版 25 到 28 已经完全从 svn log 中消失了。这根本不是 hack，它是一个安全且（几乎……）记录在案的功能。

如果“resource”是一个目录，那么你必须从最后一个 URL 中去掉它：

> svn 复制协议：//svnserver/some/directory@24 协议：//svnserver/some/

（否则你会在里面复制它）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-20T02:03:02.277

对于任何使用 TortoiseSVN 的人来说，解决方案很简单：

*   查看更改日志
*   右键单击要回滚到的修订...
*   ...选择“恢复到此版本”
*   提交您的更改

此方法保留版本历史记录（即您恢复的所有修订）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-31T02:41:01.563

您可以对特定修订进行新的签出。[http://svnbook.red-bean.com/en/1.1/re04.html](http://svnbook.red-bean.com/en/1.1/re04.html)

```
svn co path/to/my/repo -r 24 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-31T04:13:29.927

如果您的应用程序的文件夹结构没有更改，请检出旧版本并将最新版本中的 .svn 文件夹替换为检出的旧版本。现在您可以提交“旧”版本。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-31T03:40:36.187

如果您真的想从存储库中完全删除文件，您需要对文件执行 svndump，过滤掉您不想要的 revs 和/或文件路径，创建一个新的 repo，然后 svnload 过滤后的转储到新的存储库。在执行任何操作之前，您需要仔细阅读[关于存储库维护的 SVN 书籍部分](http://svnbook.red-bean.com/en/1.1/ch05s03.html)，并确保在确定新存储库具有您想要的东西之前不要删除现有存储库。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-02T05:36:14.930

你能不能`svn del`是最顶层的目录，然后`svn copy`是它们：

```
svn copy svnurl@version svnurl 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-31T03:09:54.830

我不想这么说，但这是我发现自己使用我的 svn 存储库备份的情况。

您可以将某个版本的文件复制到存储库中的新目录吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-31T03:26:16.590

这是我将如何开始做的。残酷，是的，但它唯一可以保证完全忽略冲突*并*保持修订历史完整的方法。

```
 cd /scratchdir 
  svn co -r good svn://repository
  cd /hosed_project
  svn up -r HEAD
  cat >> /tmp/cp.sh 
  ORIG=$1
  TARG=$( echo $ORIG | sed 's/\/scratchdir\///' ); 
  cp $ORIG /hosed_project/$TARG;
  ^D
  chmod u+x /tmp/cp.sh
  find /scratchdir -not -wholename "*/.svn*" -exec /tmp/cp.sh {} \; 
```

请注意，这不是 IMO 的“正常”方式，正常方式是从旧版本创建一个分支，然后将该分支合并回头部。（至少，以前*是*这样工作的）

**编辑：**以上代码未经测试，请勿逐字运行

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-31T04:02:27.797

我不完全确定这项工作是否有效，因为我还没有在现场制作中使用它，但我刚刚尝试了一个测试存储库（我复制了我的一个生产存储库）并且它*似乎*有效。

当您在存储库中时，请使用以下命令：

```
svn update -r 24 trunk 
```

其中**24**是修订号，**trunk**是您要更新（或在本例中恢复）到所述修订号的文件/文件夹。

在我的测试中，更新和（重新）添加了几个文件，并且在提交后我没有收到任何警告。然后我用一些虚拟文本修改了一个文件并尝试了另一个提交，并且只说文件弹出在修改列表中。所以它似乎工作得很好！

再说一次，我以前没有在现场制作中使用过这个，所以如果我错了，请指教。我很想知道这是否也是要走的路，因为我可以看到自己在（不久的）将来需要这个。

-戴夫

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-10-21T13:52:02.763

```
Example:
    Rev 100 all is working great        
    Rev 101 somebody really corrupted the dir structure and / or merged in bad changes, etc.
    Rev 102 You delete /trunk
    Rev 103 You copy /trunk@100 to HEAD
        You now have a /trunk that reflects only Rev 100 and 103\. Not 101 or 102.

svn del svn://[RepoName]/trunk -m "removing issue in HEAD"
svn copy svn://[RepoName]/trunk@100 svn://[RepoName]/trunk -m "Copy of correct revision of trunk to HEAD" 
```

# java - 使用大型 wsdl，我们可以修剪它吗？

> ID：402160
> 
> 赞同：6
> 
> 时间：2008-12-31T02:36:59.310
> 
> 标签：java, web-services, wsdl, jax-ws

我的 web 服务提供商给了我一个大的 WSDL 文件，但我们将只使用其中的几个函数。

我相信大型 WSDL 会对应用程序性能产生负面影响。

我们在客户端应用程序中使用 web 服务，**启动时间**和**内存使用**都是问题。大型 WSDL 意味着 jax-ws 将花费更长的时间来进行绑定，并且会为存根类占用更多内存。

我们是否可以将 WSDL 文件修整为轻量级版本？有没有为此目的的工具？

我认为我的网络服务提供商不会为我们生成另一个 WSDL。我们可能必须**在构建脚本中自动完成**。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-01T08:41:45.003

简而言之，你的答案是“没有工具，但你可以 DIY”。

我希望有简单的工具可以做到这一点，因为我的 WSDL 包含太多未使用的函数和数据结构模式。

如果我可以自动化它，WSDL -> 修剪 WSDL -> 生成客户端存根类。不会生成任何未使用的东西，不会误用，不需要维护，我们不会触及生成的代码，我可以真正专注于正在使用的代码。更小的 JAR，更短的 XML 解析时间。如果 WSDL 得到更新，我只需重建客户端存根类并运行单元测试。

我试图远离人类的召唤。这需要时间，很容易出错，并且每次对原始 WSDL 的每一个小改动都必须重做。

我不熟悉 WSDL 模式。我在想它可以通过 XSLT 完成吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T09:18:51.417

WSDL 的大小对性能的影响为零……除非您为每个请求下载和/或解析它。如果你在做后者，不要。它只需要在服务更改时进行处理，并且服务应该始终兼容地更改，并继续支持旧消息（至少在某些重叠时间段内）。

您应该考虑将 WSDL 处理为程序更改，并像处理任何版本一样进行处理，包括版本控制和测试等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-03T15:08:09.277

问题不在于 WSDL 本身的大小。重要的是生成代码的大小。例如，如果您使用 Axis2 从大型 WSDL 生成代码，您最终会为每个 WSDL 操作以及它们的返回类型的类创建一个请求/响应类。稍后您会得到一个巨大的存根类，这可能会影响性能，因为它会导入您不需要的 Web 服务操作所需的类。

没有简单的工具可以做到这一点。我通常使用记事本++来做到这一点，是的，你在做的时候总是会出错。

另一个常见的错误是选择同时生成 Sync 和 Async 风格的方法，而大多数时候（至少在我的情况下），您只会使用 Sync 风格的方法。这也可以显着增加存根的大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T03:08:22.850

我没有使用您所说的工具，但是您可以成功执行 Web 服务方法，而无需代码接触 WSDL 文件。

这似乎是进行快速测试的好时机。从 WSDL 文件中删除所有内容，除了执行您计划使用的一种更简单的方法所需的内容。请改为引用该 WSDL 副本。如果成功了，你就知道下一步该做什么了！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T04:19:43.877

无需修剪 WSDL。如果您打算走这条路，只需删除存根类中不需要的任何内容。只需确保在进行时对其进行测试，以确保一切正常。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T05:17:37.893

您可以手动删除与您不需要的方法相对应的 <wsdl:operation> 元素，看看这是否足够。您应该能够在不触及文件其余部分的情况下删除这些元素。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-31T08:13:37.027

如果您在编译时生成客户端存根类（例如通过 AXIS wsdl2java），则 WSDL的物理**大小应该无关紧要**。如果您正在下载 WSDL 并为每个请求解析它，那么下载时间可能会使解析时间相形见绌。如果下载时间成为问题，请考虑在本地缓存文件。如果解析时间成为问题，您可能需要考虑修剪文件或缓存已解析的对象。缓存或修剪文件时要小心，因为当您的提供者发布新的 WSDL 时，您需要集成任何更改。考虑在每次重新启动服务时或每隔一段时间更新缓存/修剪的 WSDL。

# testing - 黑盒测试还是白盒测试应该成为测试人员的重点？

> ID：402161
> 
> 赞同：59
> 
> 时间：2008-12-31T02:37:22.773
> 
> 标签：testing, qa, black-box, white-box

你会说哪种类型的测试应该是重点（对于测试人员/质量保证人员），为什么？

来自维基百科的一组快速定义：

**黑盒测试**

*   以测试对象的外部视角推导出测试用例。这些测试可以是功能性的或非功能性的，尽管通常是功能性的。测试设计人员选择有效和无效输入并确定正确的输出。不知道测试对象的内部结构。

**白盒测试**

*   使用系统的内部视角来设计基于内部结构的测试用例。它需要编程技能来识别通过软件的所有路径。测试人员选择测试用例输入以通过代码练习路径并确定适当的输出。在电气硬件测试中，电路中的每个节点都可能被探测和测量；一个例子是在线测试（ICT）。

只是为了澄清一点，我意识到两者都很重要，但是通常它们在开发和质量检查之间是分开的。

内部知识对测试人员/QA 是否重要？我听说过使用这些知识进行测试可以让他们更好地测试问题的论点，但我也听说过这种知识会分散功能需求并促进“测试代码”而不是预期解决方案的论点。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-12-31T04:02:57.157

*   黑盒测试应该是测试人员/QA 的重点。
*   白盒测试应该是开发人员的重点（即单元测试）。
*   回答这个问题的其他人似乎已经将该问题解释为*哪个更重要，白盒测试或黑盒测试*。我也相信它们都很重要，但您可能想查看这篇[IEEE 文章](https://pdfs.semanticscholar.org/7eee/629b22cd3db63296cac13a0c37cb0a7235f6.pdf)，该文章声称白盒测试更重要。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-31T02:45:56.860

白盒测试等于软件单元测试。开发人员或开发级别测试人员（例如另一位开发人员）在将其集成到系统中之前，确保他编写的代码根据详细级别要求正常工作。

黑盒测试等于集成测试。测试人员确保系统按照功能级别的要求工作。

在我看来，这两种测试方法**同样重要。**

彻底的单元测试将在开发阶段发现缺陷，而不是在软件集成到系统之后。系统级黑盒测试将确保所有软件模块在集成在一起时正常运行。开发阶段的单元测试不会发现这些缺陷，因为模块通常是相互独立开发的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-06-23T16:09:58.997

**黑盒子**

1 关注系统的功能 关注系统的结构（程序）

2 使用的技术是：

· 等价划分

· 边值分析

· 错误猜测

· 比赛条件

· 因果图

· 语法测试

· 状态转换测试

· 图矩阵

测试人员可以是非技术人员

有助于识别功能规范中的模糊性和矛盾性

**白盒**

使用的技术有：

· 基础路径测试

· 流图符号

· 控制结构测试

1.  条件测试

2.  数据流测试

· 循环测试

1.  简单循环

2.  嵌套循环

3.  级联循环

4.  非结构化循环

    测试人员应该是技术人员

    有助于识别逻辑和编码问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-11-03T19:00:01.200

QA 应该专注于**黑盒测试**。QA 的主要目标是测试系统做了什么（功能是否满足要求？），而不是它是如何做到的。

无论如何，QA 应该很难进行白盒测试，因为大多数 QA 人员都不是技术人员，因此他们通常通过 UI（如用户）测试功能。

更进一步，我认为**开发**人员也应该专注于**黑盒测试**。我不同意单元测试和白盒测试之间的广泛关联，但这可能只是一个词汇/规模的问题。在单元测试的规模上，被测*系统*是一个具有契约（通过其签名）的类/方法，重要的是测试它做什么，而不是如何测试。此外，白盒测试意味着您知道该方法将如何履行其合同，这对我来说似乎与 TDD 不兼容。

恕我直言，如果您的 SUT 非常复杂以至于您需要进行白盒测试，那么通常是重构的时候了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T06:54:08.027

上面已经说明了“两者”，并且是显而易见的答案......但是IMO，白盒测试远远超出了开发人员单元测试（尽管我认为它可能取决于您在白色和黑色之间划线的位置）。例如，代码覆盖率分析是一种常见的白盒方法——即运行一些场景或测试，并检查结果以寻找测试中的漏洞。即使单元测试有 100% 的 cc，在常见用户场景中测量 cc 也可以揭示可能需要更多测试的代码。

白盒测试有帮助的另一个地方是检查数据类型、常量和其他信息以查找边界、特殊值等。例如，如果应用程序有一个接受数字输入的输入，那么只有 bb 的方法可能要求测试人员“猜测”哪些值对测试有好处，而 wb 方法可能会揭示 1-256 之间的所有值都以一种方式处理，而较大的值则以另一种方式处理......也许数字 42 有另一个代码路径.

因此，要回答最初的问题 - bb 和 wb 对于良好的测试都是必不可少的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T03:48:16.530

根据我的经验，大多数开发人员自然会转向白盒测试。由于我们需要确保底层算法是“正确的”，因此我们倾向于更多地关注内部。但是，正如已经指出的那样，白盒测试和黑盒测试都很重要。

因此，我更喜欢让测试人员更多地关注黑盒测试，以掩盖大多数开发人员并没有真正做到这一点的事实，而且经常不是很擅长它。

这并不是说测试人员应该对系统如何工作一无所知，只是我希望他们更多地关注问题域以及实际用户如何与系统交互，而不是函数 SomeMethod(int x)如果 x 等于 5，将正确抛出异常。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T02:53:22.757

这是一扇敞开的大门，但最终两者都同样重要。

更糟糕的是？

1.  软件做它需要做的，但内部有问题？

2.  如果您查看源代码应该可以运行的软件，但不是吗？

我的回答：两者都不是完全可以接受的，但不能证明软件是 100% 没有错误的。所以你将不得不做出一些取舍。选项二更能直接引起客户的注意，因此您很快就会遇到问题。从长远来看，选项一将是有问题的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-27T10:56:17.663

黑盒测试：黑盒测试只是观察，不需要内部知识或软件产品的结构。只需输入有效和无效的数据并期待正确的结果。这里测试人员找到了缺陷，但无法找到缺陷的位置。在所有测试级别都进行了黑盒测试。

黑盒测试技术有： 1\. 等价划分 2\. 边界值分析 3\. 决策表 4\. 状态转移图 4\. 用例图

白盒测试：白盒测试需要了解软件产品的内部逻辑和结构。在这里，我们将检查循环、条件和分支。在这里，我们不仅可以找到缺陷，还可以找到缺陷的位置。

白盒测试技术： 1\. 语句覆盖率 2\. 决策覆盖率 3\. 分支覆盖率 4\. 路径覆盖率。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-03-19T07:15:21.693

*   通常测试人员无法进行白盒测试。因此，测试人员唯一可行的答案是强调黑盒方法。

*   但是，对于面向方面的编程和按契约设计的方法，当测试目标作为契约被编程到目标代码中时（从程序的静态视图中看），和/或当测试时态逻辑被编程到代码作为横切（测试逻辑的动态视图），白盒测试不仅成为可能，而且成为测试人员的首选。话虽如此，这将需要专业知识，测试人员不仅需要成为优秀的测试人员，还需要成为优秀的程序员，或者不仅仅是优秀的程序员。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-09-29T12:16:47.877

黑盒测试是一种软件测试方法，其中被测试项目的内部结构/设计/实现不为测试人员所知。白盒测试是一种软件测试方法，其中测试项目的内部结构/设计/实现是测试人员已知的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T03:31:53.863

什么是“内部知识”？是否知道使用某某算法来解决问题是否符合条件，或者测试人员是否必须查看每一行代码才能使其“内部”？

我认为在任何测试用例中，所使用的规范都应该给出预期的结果，而不是由测试人员决定如何解释规范来确定，因为这可能会导致每个人都认为自己是正确的并且将问题归咎于对方的问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-07T14:38:04.817

*   *黑盒测试：是系统级别的测试，检查系统的功能，以确保系统执行其设计的所有功能，主要是为了发现在用户点发现的缺陷。最好聘请专业的测试人员来黑箱你的系统，因为开发人员通常会以他编写的代码很好并且满足客户的功能要求的角度进行测试，因此他可能会错过很多东西（我不无意冒犯任何人）
*   Whitebox 是在 SDLC 中完成的第一个测试。这是为了发现诸如运行时错误和编译错误之类的错误。它可以由测试人员或开发人员自己完成，但我认为编写代码的人测试它总是更好.他比其他人更了解他们。*

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-07-30T11:58:55.843

这是我的 5 美分：

作为一名开发人员，我主要为方法（在一个类中）编写白盒测试，这很简单，因为我不希望我的测试仅仅因为我改变了代码的内部工作而中断。

如果我的方法行为发生变化（例如返回与以前不同的结果），我只想让我的测试中断。

在过去 20 年的开发中，我只是厌倦了重复工作，因为我的单元测试与代码紧密相关，我需要同时维护应用程序代码和测试代码。

我认为制作解耦代码（在编写测试代码时也是如此）是一种非常好的做法。

另外 5 美分：我几乎从不使用模拟框架，因为当我发现它必须模拟某些东西时，我更喜欢解耦我的代码 - 是的，在许多情况下这是很有可能的（特别是如果你不使用遗留代码）： - )

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-06T23:07:30.127

*黑盒测试：如果源代码不可用，则测试数据基于软件的功能，而不考虑它是如何实现的。-strong text 黑盒测试的例子有：边界值测试和等价划分。

*白盒测试：如果被测系统的源代码可用，则测试数据基于此源代码的结构。- 白盒测试的例子有：路径测试和数据流测试。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-04-25T18:14:32.940

简单...黑盒测试也称为集成测试或烟幕测试。这主要应用于依赖事件驱动架构的分布式环境中。您基于另一个服务测试一个服务以查看所有可能的场景。在这里，您无法完全预测所有可能的输出，因为 SOA/Enterprise 应用程序的每个组件都旨在自主运行。这可以称为高级测试

尽管

白盒测试是指单元测试。可以有效预测所有预期情景和产出。即输入和预期输出。这可以称为低级测试

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-07-24T17:17:45.747

我只部分同意这个问题的最高评价答案。你会说哪种类型的测试应该是重点（对于测试人员/质量保证人员），为什么？

1.  我同意：“黑盒测试应该是测试人员/QA 的重点。”
2.  我同意白盒测试应该是开发人员的重点，但我不同意白盒测试只是单元测试。

我同意[这里](http://softwaretestingfundamentals.com/white-box-testing/)的定义，即白盒测试方法适用于以下级别的软件测试：

*   单元测试：用于测试单元内的路径
*   集成测试：用于测试单元之间的路径
*   系统测试：用于测试子系统之间的路径

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-03-09T05:40:09.830

*   黑盒测试你看不到被测系统的内部运作。
*   白盒测试您可以全面了解被测系统。 [这里](https://learntestautomation.com/black-box-testing/)有几张图片展示了这一点。

测试人员需要专注于测试金字塔。您将需要了解单元测试、集成测试和端到端测试。这些中的每一个都可以通过黑盒和白盒测试来执行。从小处着手，逐步学习不同的类型以及何时使用它们。请记住，您不能总是测试所有内容。

# inversion-of-control - 控制容器的反转

> ID：402171
> 
> 赞同：2
> 
> 时间：2008-12-31T02:40:40.833
> 
> 标签：inversion-of-control

IOC 容器应该包含哪些最重要的功能？[您可以在15 行代码](http://ayende.com/Blog/archive/2007/10/20/Building-an-IoC-container-in-15-lines-of-code.aspx)中轻松创建容器，但它应该包括哪些内容才能在项目中“有用”呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T03:32:51.040

按重要性降序排列：

1.  至少允许 setter 和 constructor 注入，
2.  将配置与代码分开，
3.  允许不同样式的配置（XML 或注释），

这些将需要超过 15 行代码，但这些对我来说似乎很关键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T03:34:28.947

这是一个相当广泛的话题，并且有很多主观性，但我会尝试从非常务实的角度来回答。鉴于我从事的项目，以及我在 IoC 方面的经验，我会说至少有三个大人物需要寻找有用性。

1.  **配置**- 您使用的任何 IoC 都需要有一些中央位置，以便您配置该容器的行为。无论是配置文件还是可以在某个地方封装在全局类中的一组漂亮的 API 调用，如果容器不容易配置，那将是一件令人头疼的事情。
2.  **生命周期管理**——你真的想要一个能够允许不同对象生命周期的容器。您可能希望某个对象始终获得一个新的 IPersonCreator，但您只希望在任何给定时间存在一个 IPersonService。
3.  **自动依赖注入**- 好的，所以依赖注入是 IoC 建立在其之上的概念，但您不想自己管理它。这里的想法是，如果您第一次请求 IPersonCreator，它应该自动解决它的所有依赖项以及它们的依赖项等等。

总体而言，您需要什么取决于项目，但有几个容器可以很好地满足您的需求。

# iphone - 通过代码将图像添加到目标文件夹

> ID：402176
> 
> 赞同：2
> 
> 时间：2008-12-31T02:42:31.513
> 
> 标签：iphone, xcode

我想通过使用代码将图像添加到 iphone 应用程序 Targets-Copy Bundle Resource 文件夹，可以制作吗？任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T04:13:17.230

您想将图像添加到您构建的应用程序中，以便它们在运行时可用吗？在这种情况下，只需将它们拖到您的项目树中，并确保在“添加”对话框中选中了您的目标。如果它们已经在您的项目中，但当前不在 Copy Bundle Resources 中，您可以将它们从文件树中拖到那里。

# lisp - 阵列升级

> ID：402186
> 
> 赞同：2
> 
> 时间：2008-12-31T02:50:51.840
> 
> 标签：lisp, common-lisp

如果我正确理解 Common Lisp 标准的[第 15.1.2.1 节](http://www.lispworks.com/documentation/HyperSpec/Body/15_aba.htm)`(upgraded-array-element-type '(unsigned-byte 8))`，那么to be`'(unsigned-byte 16)`甚至`t`. 因此，我的问题是关于实现的实际行为。

今天是否有任何正在使用`'(unsigned-byte 8)`或`'(unsigned-byte 16)`升级的实现？换句话说，以下是错误的：

```
(and (subtypep (upgraded-array-element-type '(unsigned-byte 8)) '(unsigned-byte 8))
     (subtypep (upgraded-array-element-type '(unsigned-byte 16)) '(unsigned-byte 16)) 
```

（该表达式适用于 SBCL、CLISP、Allegro CL、Clozure CL 和 LispWorks。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T04:12:20.630

ECL 可能不支持`'(unsigned-byte 16)`

# sql - 异步选择 db2

> ID：402187
> 
> 赞同：2
> 
> 时间：2008-12-31T02:51:27.720
> 
> 标签：sql, asynchronous, db2

db2 是否支持异步 SQL 操作？即，如果我在有 20M 行的表上执行 select stmt，我希望返回 5M 行。当我通过 JDBC 运行此查询时，我希望在 db 执行查询并在后端线程中异步填充 ResultSet 时立即返回控件。

我知道一些数据库，比如 SQL Server 支持，DB2 支持吗？

~斯里兰卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T15:14:44.303

这本身不是一个 DB2 问题。它是通过使用 Java 的线程在 Java 中完成的。创建一个包装方法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T21:22:44.137

您没有使用 Java 或 JDBC 标记问题，所以我不知道您是否只对这些感兴趣。但是使用 ODBC，它绝对可以工作并且根本不需要线程。实际上 SQLExecute 函数默认是异步的，并且会立即返回。您必须自己轮询它以查看返回值何时更改以通知您执行已完成。如果/Java 以不同的方式做这件事，我感到很惊讶。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-05T19:07:45.887

JDBC是同步接口 [http://mikemainguy.blogspot.de/2015/05/the-myth-of-asynchronous-jdbc.html](http://mikemainguy.blogspot.de/2015/05/the-myth-of-asynchronous-jdbc.html)

# css - 在 CSS 中分层图像 - 可以将 2 个图像放在同一个元素中吗？

> ID：402200
> 
> 赞同：16
> 
> 时间：2008-12-31T03:02:32.177
> 
> 标签：css, image, layout, z-index

假设我在 CSS 中为网页设置背景图像，如下所示：

```
body    {
font-size: 62.5%; /* Resets 1em to 10px */
font-family: Verdana, Arial, Sans-Serif;
background-color: #9D5922;
color: #000;
margin-left: auto;
margin-right: auto;
margin: 0;
padding: 0; 
background: url(images/desk.gif) repeat bottom left;
} 
```

有没有办法在 body 元素本身内的desk.gif 顶部分层第二个图像，或者是创建一个单独的类并使用z 轴的唯一方法？

抱歉，这是一个简单的问题，但我一直在努力解决这个问题，虽然我无法让它发挥作用，但我也没有在网上的任何地方找到明确的想法......所以，是有办法，或者这只是一个不能做的事？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-04T21:27:46.457

分层背景是[CSS3 工作草案](http://www.w3.org/TR/css3-background/#layering)的一部分，但据我所知，对它们的支持仅限于基于 WebKit/KHTML 的浏览器，例如 Safari、Chrome、Konqueror 和 OmniWeb。

使用您的示例代码，这看起来像：

```
body    {
    font-size: 62.5%; /* Resets 1em to 10px */
    font-family: Verdana, Arial, Sans-Serif;
    background-color: #9D5922;
    color: #000;
    margin-left: auto;
    margin-right: auto;
    margin: 0;
    padding: 0; 
    background: url("images/top.gif") left bottom repeat,
                url("images/desk.gif") left bottom repeat;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-08T03:54:32.603

我已经在一个重复的问题中发布了解决方案，但是对于可能需要此信息的任何人，我也会将其发布在这里。

据我所知，不可能将其放在同一层，但可以将多个图像放在单独的 div 中，并且已由流行的可用性测试网站[Silverback](http://silverbackapp.com/)实现（查看背景以看看它是如何分层的）。如果您查看源代码，您会发现背景是由几张图像组成的，它们相互叠加。

这是一篇演示如何在[维生素](http://www.thinkvitamin.com/features/design/how-to-recreate-silverbacks-parallax)上找到效果的文章。可以在[A List Apart](http://www.alistapart.com/articles/onionskin/)上找到用于包裹这些“洋葱皮”层的类似概念。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T03:16:44.770

简而言之，这是不可能的。您可以这样做，但您需要向页面添加第二个 HTML 对象以使其工作。例如，在您的身体正下方放置一个 div 块，并将第二个背景分配给该对象。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-15T01:50:15.277

如今，这可以在所有“现代”浏览器（不是< IE9，afaik）中完成。我可以确认它适用于 Firefox、Opera、Chrome。没有理由不这样做，只要你有一个适合旧浏览器/IE 的后备解决方案。

对于语法，您可以选择

```
  背景：url（..）重复-x左上角，
             url(..) 重复-x 左下角；

```

和

```
  背景图像：url（..），url（..）；
  背景位置：左上，左下；
  背景重复：重复-x；

```

您不需要换行符，但逗号很重要。

* * *

注意力！以下将创建两个背景，即使您只指定了一个图像 url：

```
  背景图片：网址（..）；
  背景位置：顶部，底部；

```

* * *

当然，还有使用嵌套容器的替代方法，但这会使您的 html 膨胀。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T03:12:38.007

唯一的方法是使用另一个容器。每个元素只能包含一个背景图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T03:34:50.537

使用绝对定位和 z-index 来获取顶部的第二个元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T04:17:39.107

不要忘记您可以将样式应用于 HTML 元素：

```
html {
background: url(images/whatever.gif);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-25T07:00:51.507

[链接文本](http://techknack.net/css-trick-two-background-images/)

上面提到的链接最能描述你的目标......

# c# - 如何以编程方式在 XPathExpression 实例中使用 XPath 函数？

> ID：402211
> 
> 赞同：10
> 
> 时间：2008-12-31T03:12:24.480
> 
> 标签：c#, xml, xpath, namespaces

我当前的程序需要以编程方式创建一个 XPathExpression 实例以应用于 XmlDocument。xpath 需要使用一些 XPath 函数，例如“ends-with”。但是，我找不到在 XPath 中使用“ends-with”的方法。一世

它抛出如下异常

> 未处理的异常：System.Xml.XPath.XPathException：需要命名空间管理器或 XsltC ontext。此查询具有前缀、变量或用户定义的函数。
> 在 MS.Internal.Xml.XPath.CompiledXpathExpr.get_QueryTree() 在 System.Xml.XPath.XPathNavigator.Evaluate(XPathExpression expr, XPathNodeIt erator context)
> 在 System.Xml.XPath.XPathNavigator.Evaluate(XPathExpression expr)

代码是这样的：

```
 XmlDocument xdoc = new XmlDocument();
    xdoc.LoadXml(@"<?xml version=""1.0"" encoding=""utf-8"" ?>
                        <myXml xmlns=""http://MyNamespace"" xmlns:fn=""http://www.w3.org/2005/xpath-functions""> 
                        <data>Hello World</data>
                    </myXml>");
    XPathNavigator navigator = xdoc.CreateNavigator();

    XPathExpression xpr;
    xpr = XPathExpression.Compile("fn:ends-with(/myXml/data, 'World')");

    object result = navigator.Evaluate(xpr);
    Console.WriteLine(result); 
```

我尝试在编译表达式时更改代码以插入 XmlNamespaceManager，如下所示

```
 XmlDocument xdoc = new XmlDocument();
    xdoc.LoadXml(@"<?xml version=""1.0"" encoding=""utf-8"" ?>
                        <myXml xmlns=""http://MyNamespace"" xmlns:fn=""http://www.w3.org/2005/xpath-functions""> 
                        <data>Hello World</data>
                    </myXml>");
    XPathNavigator navigator = xdoc.CreateNavigator();
    XmlNamespaceManager nsmgr = new XmlNamespaceManager(xdoc.NameTable);
    nsmgr.AddNamespace("fn", "http://www.w3.org/2005/xpath-functions");

    XPathExpression xpr;
    xpr = XPathExpression.Compile("fn:ends-with(/myXml/data, 'World')", nsmgr);

    object result = navigator.Evaluate(xpr);
    Console.WriteLine(result); 
```

XPathExpression.Compile 调用失败：

> 未处理的异常：System.Xml.XPath.XPathException：由于未知函数，此查询需要 XsltContext。在 MS.Internal.Xml.XPath.FunctionQuery.SetXsltContext(XsltContext context) 在 MS.Internal.Xml 的 MS.Internal.Xml.XPath.CompiledXpathExpr.UndefinedXsltContext.ResolveFuncti on(String prefix, String name, XPathResultType[] ArgTypes)。 XPath.CompiledXpathExpr.SetContext(XmlNamespaceManager nsManager) 在 System.Xml.XPath.XPathExpression.Compile(String xpath, IXmlNamespaceResolver nsResolver)

有人知道在 XPathExpression.Compile 中使用现成的 XPath 函数的技巧吗？谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-31T05:24:40.987

**该函数** **不是为****[XPath 1.0](http://www.w3.org/TR/xpath)****定义的，而只是为****[XPath 2.0](http://www.w3.org/TR/xpath20/)****和****[XQuery](http://www.w3.org/TR/xquery/)****定义的。**[**`ends-with()`**](http://www.w3.org/TR/xpath-functions/#func-ends-with)

您正在使用 .NET。. **NET 目前还没有实现** [**XPath 2.0**](http://www.w3.org/TR/xpath20/)、[**XSLT 2.0**](http://www.w3.org/TR/xslt20/)或[**XQuery**](http://www.w3.org/TR/xquery/)。

可以轻松构造一个 XPath 1.0 表达式，对其求值产生与函数相同的结果**`ends-with()`**：

**`$str2 = substring($str1, string-length($str1)- string-length($str2) +1)`**

产生与以下相同的布尔结果（`true()`或`false()`）：

**`ends-with($str1, $str2)`**

在您的具体情况下，您只需要用正确的表达式替换**`$str1`**and **`$str2`**。因此，它们是**`/myXml/data`**和**`'World'`**。

**因此，要使用的 XPath 1.0 表达式相当于 XPath 2.0`ends-with(/myXml/data, 'World')`表达式**：

```
'World' = 
   substring(/myXml/data,
             string-length(/myXml/data) - string-length('World') +1
             ) 
```

# php - PHP 只读属性？

> ID：402215
> 
> 赞同：61
> 
> 时间：2008-12-31T03:16:49.497
> 
> 标签：php, programming-languages

在使用 PHP 的 DOM 类（DOMNode、DOMEElement 等）时，我注意到它们拥有真正的只读属性。例如，我可以读取 DOMNode 的 $nodeName 属性，但无法写入（如果我这样做，PHP 会引发致命错误）。

如何在 PHP 中创建自己的只读属性？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-12-31T03:26:10.413

你可以这样做：

```
class Example {
    private $__readOnly = 'hello world';
    function __get($name) {
        if($name === 'readOnly')
            return $this->__readOnly;
        user_error("Invalid property: " . __CLASS__ . "->$name");
    }
    function __set($name, $value) {
        user_error("Can't set property: " . __CLASS__ . "->$name");
    }
} 
```

仅在您真正需要时才使用它 - 它比正常的属性访问要慢。对于 PHP，最好采用只使用 setter 方法从外部更改属性的策略。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2021-07-14T10:30:32.727

## 自 PHP 8.1 起，实现了本机只读属性

[文档](https://www.php.net/manual/en/language.oop5.properties.php#language.oop5.properties.readonly-properties)

您只能在属性声明期间初始化只读属性一次。

```
class Test {
    public readonly string $prop;

    public function __construct(string $prop) {
        $this->prop = $prop;
    }
} 
```

--

```
class Test {
    public function __construct(
        public readonly string $prop,
    ) {}
} 
```

尝试修改只读属性将导致以下错误：

```
Error: Cannot modify readonly property Test::$prop 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-12-04T16:55:54.397

但是仅使用 __get() 公开的私有属性对于枚举对象成员的函数是不可见的——例如 json_encode()。

我经常使用 json_encode() 将 PHP 对象传递给 Javascript，因为这似乎是传递具有大量从数据库填充的数据的复杂结构的好方法。我必须在这些对象中使​​用公共属性，以便将这些数据填充到使用它的 Javascript 中，但这意味着这些属性必须是公共的（因此冒着另一个程序员不在同一波长上的风险（或者可能我自己在一个糟糕的夜晚之后）可能会直接修改它们）。如果我将它们设为私有并使用 __get() 和 __set()，则 json_encode() 看不到它们。

有一个“只读”可访问性关键字不是很好吗？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-08-04T22:41:33.657

我看到您已经得到了答案，但对于仍在寻找的人：

只需将所有“只读”变量声明为私有或受保护，并使用魔术方法 __get() 如下所示：

```
/**
 * This is used to fetch readonly variables, you can not read the registry
 * instance reference through here.
 * 
 * @param string $var
 * @return bool|string|array
 */
public function __get($var)
{
    return ($var != "instance" && isset($this->$var)) ? $this->$var : false;
} 
```

如您所见，我还保护了 $this->instance 变量，因为此方法将允许用户读取所有声明的变量。要阻止多个变量，请使用带有 in_array() 的数组。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-01-20T08:02:06.667

这是一种从外部渲染类的所有属性 read_only 的方法，继承的类具有写访问权限；-)。

```
class Test {
    protected $foo;
    protected $bar;

    public function __construct($foo, $bar) {
        $this->foo = $foo;
        $this->bar = $bar;
    }

/**
 * All property accessible from outside but readonly
 * if property does not exist return null
 *
 * @param string $name
 *
 * @return mixed|null
 */
    public function __get ($name) {
        return $this->$name ?? null;
    }

/**
 * __set trap, property not writeable
 *
 * @param string $name
 * @param mixed $value
 *
 * @return mixed
 */
    function __set ($name, $value) {
        return $value;
    }
} 
```

在php7中测试

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-09T09:40:34.047

对于那些寻找公开私有/受保护属性以进行序列化的方法的人，如果您选择使用 getter 方法将它们设为只读，这里有一种方法（@Matt: 以 json 为例）：

```
interface json_serialize {
    public function json_encode( $asJson = true );
    public function json_decode( $value );
}

class test implements json_serialize {
    public $obj = null;
    protected $num = 123;
    protected $string = 'string';
    protected $vars = array( 'array', 'array' );
    // getter
    public function __get( $name ) {
        return( $this->$name );
    }
    // json_decode
    public function json_encode( $asJson = true ) {
        $result = array();
        foreach( $this as $key => $value )
            if( is_object( $value ) ) {
                if( $value instanceof json_serialize )
                    $result[$key] = $value->json_encode( false );
                else
                    trigger_error( 'Object not encoded: ' . get_class( $this ).'::'.$key, E_USER_WARNING );
            } else
                $result[$key] = $value;
        return( $asJson ? json_encode( $result ) : $result );
    }
    // json_encode
    public function json_decode( $value ) {
        $json = json_decode( $value, true );
        foreach( $json as $key => $value ) {
            // recursively loop through each variable reset them
        }
    }
}
$test = new test();
$test->obj = new test();
echo $test->string;
echo $test->json_encode(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-26T08:31:45.353

```
Class PropertyExample {

        private $m_value;

        public function Value() {
            $args = func_get_args();
            return $this->getSet($this->m_value, $args);
        }

        protected function _getSet(&$property, $args){
            switch (sizeOf($args)){
                case 0:
                    return $property;
                case 1:
                    $property = $args[0];
                    break;  
                default:
                    $backtrace = debug_backtrace();
                    throw new Exception($backtrace[2]['function'] . ' accepts either 0 or 1 parameters');
            }
        }

} 
```

这就是我处理获取/设置我的属性的方式，如果你想让 Value() 只读......那么你只需让它执行以下操作：

```
 return $this->m_value; 
```

现在的函数 Value() 要么获取要么设置。

# python - 如何在 Django 模型上存储字典？

> ID：402217
> 
> 赞同：64
> 
> 时间：2008-12-31T03:18:15.983
> 
> 标签：python, django, django-models, orm, persistence

我需要在 Django 模型中存储一些数据。这些数据并不等于模型的所有实例。

起初我考虑对模型进行子类化，但我试图保持应用程序的灵活性。如果我使用子类，每次我需要一种新的对象时，我都需要创建一个完整的类，这不好。我也会得到很多子类，只是为了存储一对额外的字段。

我真的觉得字典是最好的方法，但是 Django 文档中没有关于在 Django 模型中存储字典的内容（或者我找不到它）。

有什么线索吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-31T08:19:28.807

如果它真的像您要查找的任意数据那样是字典，您可能可以使用两级设置，其中一个模型是容器，另一个模型是键值对。您将创建容器的一个实例，创建每个键值实例，并将键值实例集与容器实例相关联。就像是：

```
class Dicty(models.Model):
    name      = models.CharField(max_length=50)

class KeyVal(models.Model):
    container = models.ForeignKey(Dicty, db_index=True)
    key       = models.CharField(max_length=240, db_index=True)
    value     = models.CharField(max_length=240, db_index=True) 
```

它并不漂亮，但它可以让您使用数据库访问/搜索字典的内部结构，而 pickle/serialize 解决方案则不会。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-31T03:39:18.747

如果您不需要通过任何这些额外数据进行查询，则可以将其存储为*序列化字典*。用于`repr`将字典转为字符串，并将`eval`字符串转回字典。注意 eval 字典中没有用户数据，或者使用`safe_eval`实现。

例如，在您的`create`和`update`方法中`views`，您可以添加：

```
if isinstance(request.data, dict) == False:
    req_data = request.data.dict().copy()
else:
    req_data = request.data.copy()

dict_key = 'request_parameter_that_has_a_dict_inside'
if dict_key in req_data.keys() and isinstance(req_data[dict_key], dict):
    req_data[dict_key] = repr(req_data[dict_key]) 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-07-31T12:50:28.747

可以在这里找到另一个干净快速的解决方案：[https ://github.com/bradjasper/django-jsonfield](https://github.com/bradjasper/django-jsonfield)

为方便起见，我复制了简单的说明。

**安装**

```
pip install jsonfield 
```

**用法**

```
from django.db import models
from jsonfield import JSONField

class MyModel(models.Model):
    json = JSONField() 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-09-19T10:10:04.323

我通过 google 的第 4 个结果来到这篇文章“django store object”

有点晚了，但[django-picklefield](http://pypi.python.org/pypi/django-picklefield)对我来说是个不错的解决方案。

来自文档的示例：

要使用，只需在模型中定义一个字段：

```
>>> from picklefield.fields import PickledObjectField
>>> class SomeObject(models.Model):
>>>     args = PickledObjectField() 
```

并将您喜欢的任何内容（只要它是可腌制的）分配给该字段：

```
>>> obj = SomeObject()
>>> obj.args = ['fancy', {'objects': 'inside'}]
>>> obj.save() 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-31T07:44:46.600

正如 Ned 回答的那样，如果您使用字典方法，您将无法查询“某些数据”。

如果您仍然需要存储字典，那么到目前为止，最好的方法是 Marty Alchin 的新书**Pro Django**中记录的 PickleField 类。此方法仅在需要时使用 Python 类属性来腌制/取消腌制存储在模型字段中的 Python 对象。

这种方法的基础是使用 django 的[`contibute_to_class`](http://code.djangoproject.com/browser/django/trunk/django/db/models/fields/__init__.py)方法动态地向模型添加一个新字段，并使用 getattr/setattr 进行按需序列化。

我能找到的为数不多的在线示例之一是[JSONField](http://svn.navi.cx/misc/trunk/djblets/djblets/util/fields.py)的定义。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-31T07:09:29.697

我不确定您要解决的问题的性质，但它听起来与[Google App Engine 的 BigTable Expando](http://code.google.com/appengine/docs/datastore/expandoclass.html)非常相似。

Expandos 允许您在运行时在数据库支持的对象实例上指定和存储其他字段。引用文档：

```
import datetime
from google.appengine.ext import db

class Song(db.Expando):
  title = db.StringProperty()

crazy = Song(title='Crazy like a diamond',
             author='Lucy Sky',
             publish_date='yesterday',
             rating=5.0)

crazy.last_minute_note=db.Text('Get a train to the station.') 
```

Google App Engine 目前支持 Python 和 Django 框架。如果这是表达模型的最佳方式，可能值得研究。

传统的关系数据库模型没有这种列添加灵活性。如果您的数据类型足够简单，您可以打破传统的 RDBMS 理念，并按照[@Ned Batchelder](https://stackoverflow.com/questions/402217/how-to-store-a-dictionary-on-a-django-model#402248)的建议通过序列化将值转换为单个列；但是，如果您*必须*使用 RDBMS，Django 模型继承可能是要走的路。值得注意的是，它将为每个派生级别创建[一对一的外键关系。](http://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.OneToOneField)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-08-02T08:56:20.180

这个问题很老，但我遇到了同样的问题，到此结束，选择的答案无法再解决我的问题。

如果您想在 Django 或 REST Api 中存储字典，或者用作前端的对象，或者因为您的数据不一定具有相同的结构，我使用的解决方案可以帮助您。

在您的 API 中保存数据时，使用[json.dump()](https://docs.python.org/2/library/json.html)方法能够以正确的 json 格式存储它，如本[问题](https://stackoverflow.com/questions/14661051/convert-python-dictionary-to-json-array)所述。

如果您使用此结构，您的数据将已经采用适当的 json 格式，以便在您的 ajax（或其他）调用中使用[JSON.parse()](https://www.w3schools.com/js/js_json_parse.asp)在前端调用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-05-05T04:55:55.337

我使用文本字段和`json.loads()`/`json.dumps()`

```
models.py

import json
from django.db import models

class Item(models.Model):
    data = models.TextField(blank=True, null=True, default='{}')

    def save(self, *args, **kwargs):
        ## load the current string and
        ## convert string to python dictionary
        data_dict = json.loads(self.data)

        ## do something with the dictionary
        for something in somethings:
            data_dict[something] = some_function(something)

        ## if it is empty, save it back to a '{}' string,
        ## if it is not empty, convert the dictionary back to a json string
        if not data_dict:
            self.data = '{}'
        else:
            self.data = json.dumps(data_dict)

        super(Item, self).save(*args, **kwargs) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-04T12:28:20.570

“不等于模型的所有实例”对我来说听起来很适合“无模式数据库”。[CouchDB](http://couchdb.apache.org/)是这种方法的典型代表，您可能会考虑这一点。

在一个项目中，我将几个在 Django ORM 上表现不佳的表移到了 CouchDB，我对此感到非常满意。我使用[couchdb-python](http://code.google.com/p/couchdb-python/)没有任何 Django 特定的 CouchDB 模块。可以在[此处](http://blogs.23.nu/c0re/2008/12/building-a-track-and-trace-application-with-couchdb/)找到数据模型的描述。从 Django 中的 5 个“模型”到 Django 中的 3 个“模型”和一个 CouchDB“数据库”实际上稍微减少了我的应用程序中的总代码行数。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-13T16:50:37.157

Django-Geo 包含一个“DictionaryField”，您可能会觉得有帮助：

[http://code.google.com/p/django-geo/source/browse/trunk/fields.py?r=13#49](http://code.google.com/p/django-geo/source/browse/trunk/fields.py?r=13#49)

通常，如果您不需要跨数据查询，请使用非规范化方法来避免额外查询。用户设置就是一个很好的例子！

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-13T18:05:44.727

我同意您需要避免将其他结构化数据填充到单个列中。但是如果你必须这样做，Django 有一个内置的[XMLField](http://docs.djangoproject.com/en/dev/ref/models/fields/#xmlfield)。

Django 片段中还有[JSONField](http://www.djangosnippets.org/snippets/377/)。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-31T05:54:12.143

仔细想想，找出每个数据集的共同点……然后定义你的模型。它可能需要或不需要使用子类。不应该避免表示共性的外键，而是在有意义时鼓励它们。

将随机数据填充到 SQL 表中并不聪明，除非它是真正的非关系数据。如果是这种情况，请定义您的问题，我们或许可以提供帮助。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-08-30T19:36:59.490

如果您使用 Postgres，则可以使用 hstore 字段：[https](https://docs.djangoproject.com/en/1.10/ref/contrib/postgres/fields/#hstorefield) ://docs.djangoproject.com/en/1.10/ref/contrib/postgres/fields/#hstorefield 。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-12-08T19:59:42.310

我知道这是一个老问题，但今天（2021 年）最干净的选择是使用原生 JSONfield（自 django 3.1 起）

文档：[https ://docs.djangoproject.com/en/3.2/ref/models/fields/#django.db.models.JSONField](https://docs.djangoproject.com/en/3.2/ref/models/fields/#django.db.models.JSONField)

您只需在类模型中创建一个名为 jsonfield 的模型字段，然后瞧

# imap - 有人找到下载谷歌聊天记录的方法吗？

> ID：402219
> 
> 赞同：4
> 
> 时间：2008-12-31T03:19:57.307
> 
> 标签：imap, chatbot, google-data

我希望能够获取我所有的 Google 聊天日志，以便我可以使用它们来训练聊天机器人类型的东西。

我知道 Google 施加的限制，因此不能简单地通过 IMAP 下载聊天。我正在寻找解决方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-10-15T16:42:05.120

自 2011 年 9 月起，谷歌取消了对下载聊天的限制。Google**[现在允许](http://dataliberation.blogspot.com/2011/09/gmail-liberates-recorded-chat-logs-via.html)**使用 IMAP 导出聊天日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-06T05:08:43.393

我最近不得不做同样的事情并编写了一个快速的 ruby​​ 脚本。[http://9seats.com/2011/04/archiving-gmail-chat-logs-with-ruby/](http://9seats.com/2011/04/archiving-gmail-chat-logs-with-ruby/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T03:30:46.393

除非它们附加到电子邮件对话中，否则无法下载聊天日志 - 也许您可以转发保存在“聊天”文件夹中的所有日志，然后通过 IMAP 或 POP 下载对话？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-01T15:44:46.340

如果您想编写一个程序来执行此操作，您**可以**使用greasemonkey 脚本和本地PHP 服务器。
当您访问它们时，greasemonkey 脚本会获取聊天记录，解析它们，然后将它们发送到本地 PHP 服务器，然后该服务器可以将其转储到 TXT、SQL 等。
如果您需要帮助，请与我联系，我可能对此感兴趣，尽管接下来的几个月我将休假 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T03:56:37.573

浏览一下[Google Talk API](http://code.google.com/apis/talk/talk_developers_home.html)。这也可能有帮助，也可能没有帮助：[GMailAPI](http://www.johnvey.com/features/gmailapi/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-30T03:04:39.310

如果您知道如何下载电子邮件。你可以做同样的聊天。因为聊天只不过是一封带有聊天标签的电子邮件。如果您看到聊天，它们实际上是从与您聊天的人发送给您的。

# c# - 在一个 aspx 文件中声明一个字符串类型变量为全局变量，最好用 null 或 string.empty 初始化

> ID：402231
> 
> 赞同：1
> 
> 时间：2008-12-31T03:28:17.303
> 
> 标签：c#

哪个最适合一个 aspx 页面中的字符串类型全局变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T10:47:14.187

好吧，没有必要初始化一个字段`null`——它会自动初始化。并且over just并没有太大的*好处*，我发现它更具可读性（因为编译器会自动将内部字符串用于源代码中的任何文字）。`string.Empty``""`

所以就个人而言，我会使用：

```
string foo = ""; 
```

要不就：

```
string foo; // defaults to null 
```

我养成了使用`string.IsNullOrEmpty`大多数测试的习惯，这消除了两者之间的大部分差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T03:47:44.380

我个人使用 String.Empty，但对我来说选择是掷硬币。

我发现使用`String.IsNullOrEmpty()`来测试我的字符串意味着它们如何初始化并不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T04:01:11.420

这可能取决于如何使用变量。如果您不需要检查空字符串，请将其初始化为 string.Empty 以避免执行空检查。

顺便说一句，在 ASPX 页面中放置一个全局变量可能不是存储数据的最佳选择。具有管理字符串的特定目的的单独类可能是一个更好的地方。此外，将变量设为私有并提供公共属性或访问它的方法会更安全 - 这样您始终可以确保该值有效。

# java - 有人在实际应用程序中使用 short 和 byte 原始类型吗？

> ID：402247
> 
> 赞同：11
> 
> 时间：2008-12-31T03:38:33.837
> 
> 标签：java, types, primitive

自 2004 年以来，我一直在使用 Java 进行编程，主要是企业和 Web 应用程序。但我从来没有使用过*short*或*byte*，除了一个玩具程序只是为了了解这些类型是如何工作的。即使在 100 次的*for 循环*中，我们通常也会使用*int*。而且我不记得我是否遇到过任何使用*byte*或*short*的代码，除了一些公共 API 和框架。

是的，我知道，在内存节省实际上很重要的情况下，您可以使用*短*字节或*字节来节省大型数组中的内存。*有人愿意练习吗？或者它只是书中的东西。

**[已编辑]**

使用*字节*数组进行网络编程和套接字通信是一种很常见的用法。谢谢，达伦，指出这一点。现在*短*呢？瑞安，举了一个很好的例子。谢谢，瑞恩。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-31T03:57:18.790

我经常使用字节。通常采用字节数组或 ByteBuffer 的形式，用于二进制数据的网络通信。

我很少使用 float 或 double，而且我认为我从未使用过 short。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T03:42:08.023

请记住，Java 也用于内存更有限的移动设备。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T03:49:43.407

我在 C/C++ 代码中使用了很多“字节”来实现图像压缩等功能（即在黑白位图的每个*字节*上运行压缩算法）和处理二进制网络消息（通过解释消息中的*字节*） ）。

但是，我几乎从未使用过“float”或“double”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-31T05:08:10.830

我看到它们的主要用途是在处理具有未知结构甚至没有真实结构的数据时。网络编程是前者的一个例子（发送数据的人都知道它的含义，但你可能不知道），像 256 色（或灰度）图像的图像压缩是后者的一个例子。

我突然想到 grep 作为另一种用途，任何类型的文件副本也是如此。（当然，操作系统会这样做——但有时这还不够好。）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T05:51:18.700

Java 语言本身使得使用`byte`or`short`类型变得异常困难。每当您对 a `byte`or`short`值执行任何操作时，Java 都会将其提升为`int`first，并且操作的结果作为`int`. 此外，它们已签名，并且没有未签名的等价物，这是另一个常见的挫折来源。

所以你最终会使用`byte`很多，因为它仍然是所有网络事物的基本构建块，但这种`short`类型可能不存在。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T06:05:24.147

直到今天我还没有注意到我很少使用它们。

我已经将字节用于网络相关的东西，但大多数时候它们是用于我自己的工具/学习的。在工作项目中，这些事情由框架（例如 JSP）处理

短的？几乎从不。

长的？两者都不。

我首选的整数文字总是 int、for 循环、计数器等。

当数据来自另一个地方（例如数据库）时，我使用正确的类型，但对于文字，我总是使用 int。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-31T14:53:54.533

我在很多不同的地方使用字节，主要涉及低级数据处理。不幸的是，Java 语言的设计者对字节进行了签名。我想不出任何使用负字节值的情况。拥有 0-255 范围会更有帮助。

我认为我从未在任何适当的代码中使用过短裤。我也从不使用浮点数（如果我需要浮点值，我总是使用双精度）。

我同意[汤姆](https://stackoverflow.com/questions/402247/anyone-using-short-and-byte-primitive-types-in-real-apps#403043)。理想情况下，在高级语言中，我们不应该关心底层的机器表示。我们应该能够定义自己的范围或使用任意精度的数字。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-18T14:23:32.077

当我们为手机等电子设备编程时，我们使用字节和短。在这种情况下，我们应该注意内存管理。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-31T14:16:09.103

看看 int 的语义可能更有趣。这些任意限制和静默截断是您想要的吗？对于真正想要任意大小的整数的应用程序级代码，只是 Java 无法合理地表达这些。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-31T04:47:15.477

我在进行模型检查时保存状态时使用了字节。在该应用程序中，节省的空间值得额外的工作。否则我从不使用它们。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T05:16:50.377

我发现我在进行一些低级图像处理时使用了字节变量。.Net GDI+ 绘制程序真的很慢，所以我自己动手。

不过，大多数时候，我坚持使用有符号整数，除非考虑到问题的限制，我不得不使用更大的整数。我所做的任何类型的物理建模通常都需要浮点数或双精度数，即使我不需要精度。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-31T08:31:29.237

[Apache POI](http://poi.apache.org/)使用`short`了很多次。可能是因为 Excel 的行/列数限制。

几个月前，他们改为`int`更换

[createCell（短列索引）](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFRow.html#createCell(short))

和

[createCell(int 列)](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFRow.html#createCell(int))。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-05-18T08:57:25.363

在内存数据网格上，它可能很有用。像 Gemfire 这样的数据网格的概念是拥有一个巨大的分布式地图。当您没有足够的内存时，您可以使用 LRU 策略溢出到磁盘，但您的地图所有条目的键都保留在内存中（至少使用 Gemfire）。

因此，使您的密钥占用空间小非常重要，尤其是在您处理非常大的数据集时。对于条目值，如果可以的话，最好使用内存占用少的适当类型......

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-04-13T06:59:03.567

我在与自定义 USB 或串行微控制器通信的 Java 应用程序中使用了短裤和字节，以接收包装在 2 个字节中的 10 位值作为短裤。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-05-22T04:08:50.167

`byte`s 和`short`s 广泛用于 Java Card 开发。看看我[对 Java 字节原始类型是否有任何实际用途的回答？](https://stackoverflow.com/questions/6892444/are-there-any-real-life-uses-for-the-java-byte-primitive-type/9884633#9884633).

# javascript - 带有 iFrame 的后退按钮

> ID：402250
> 
> 赞同：2
> 
> 时间：2008-12-31T03:40:06.890
> 
> 标签：javascript, iframe, button, history, back

我正在使用 iframe 来显示具有链接的内容。当用户在 iFrame 中单击并点击“返回”时，它会返回 iFrame。这种行为是可以的。但是，一旦他们回到 iFrame 的第一页并再次点击“返回”，整个窗口就会返回到前一页。这是不希望的。

为了防止这种行为，我在 iFrame 中放置了一个假的“返回”按钮。（在大多数情况下，这是糟糕的 UI，在这种情况下，它运行良好）。我希望这个假的后退按钮只有在前一页是 iFrame 的页面时才返回 - 而不是整个页面。 **当他们点击 iFrame 中的假后退按钮时，它应该只将该 iFrame 向后移动，而不是其他任何东西。** 有没有办法做到这一点？iFrame 是否有自己的历史记录对象？

可能有好处的东西：可以假设 iFrame 和主窗口的域是不同的。因此，如果可以读取“全局”历史对象，我可以通过检查域是否是我的来检查上一页是否是我的。如果域名不是我的，假的后退按钮将被隐藏或不做任何事情。

非常感谢帮助，节日快乐！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T01:25:41.587

```
document.location.href = document.referrer; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T03:56:30.477

您应该能够使用 javascript 历史对象将用户推回；但是当 iframe-clicking 用完并且主页要返回时，您将无法停止它。而且您无法阻止它，因为大多数浏览器都故意将其锁定得很好，以防止人们恶意弄乱它。

*   您可以编写自己的历史跟踪代码并让后退按钮从该堆栈中弹出项目，当堆栈为空时停止...
*   如果您正在使用一些复杂的链接嵌套——也许是一些基于 javascript 的树形菜单？这样iframe永远不会刷新页面吗？

没有一个例子，我不得不说你的设计看起来像糟糕的用户界面......当我回击时，我不想改变导航；我想回到我刚刚打开的任何页面。

# c++ - std::wstring VS std::string

> ID：402283
> 
> 赞同：848
> 
> 时间：2008-12-31T04:08:14.133
> 
> 标签：c++, string, unicode, c++-faq, wstring

我无法理解 和 之间的`std::string`区别`std::wstring`。我知道`wstring`支持宽字符，例如 Unicode 字符。我有以下问题：

1.  我应该什么时候使用`std::wstring`over `std::string`？
2.  可以`std::string`容纳整个 ASCII 字符集，包括特殊字符吗？
3.  `std::wstring`所有流行的 C++ 编译器都支持吗？
4.  究竟什么是“*宽字符*”？

* * *

## 回答 #1

> 赞同：1095
> 
> 时间：2008-12-31T12:47:29.907

## `string`? `wstring`?

`std::string`是在 a和a 上[`basic_string`](//en.cppreference.com/w/cpp/string/basic_string)模板化的。`char``std::wstring`[`wchar_t`](//en.wikipedia.org/wiki/Wide_character#C/C++)

## `char`对比`wchar_t`

`char`应该包含一个字符，通常是一个 8 位字符。 `wchar_t`应该包含一个宽字符，然后，事情变得棘手：在 Linux 上，a`wchar_t`是 4 个字节，而在 Windows 上，它是 2 个字节。

## 那么[Unicode](//en.wikipedia.org/wiki/Unicode)呢？

问题是既不`char`也不`wchar_t`直接与 unicode 相关联。

### 在 Linux 上？

让我们以 Linux 操作系统为例：我的 Ubuntu 系统已经支持 unicode。当我使用 char 字符串时，它本身是用[UTF-8](//en.wikipedia.org/wiki/UTF-8)编码的（即 Unicode 字符字符串）。以下代码：

```
#include <cstring>
#include <iostream>

int main()
{
    const char text[] = "olé";

    std::cout << "sizeof(char)    : " << sizeof(char) << "\n";
    std::cout << "text            : " << text << "\n";
    std::cout << "sizeof(text)    : " << sizeof(text) << "\n";
    std::cout << "strlen(text)    : " << strlen(text) << "\n";

    std::cout << "text(ordinals)  :";

    for(size_t i = 0, iMax = strlen(text); i < iMax; ++i)
    {
        unsigned char c = static_cast<unsigned_char>(text[i]);
        std::cout << " " << static_cast<unsigned int>(c);
    }

    std::cout << "\n\n";

    // - - -

    const wchar_t wtext[] = L"olé" ;

    std::cout << "sizeof(wchar_t) : " << sizeof(wchar_t) << "\n";
    //std::cout << "wtext           : " << wtext << "\n"; <- error
    std::cout << "wtext           : UNABLE TO CONVERT NATIVELY." << "\n";
    std::wcout << L"wtext           : " << wtext << "\n";

    std::cout << "sizeof(wtext)   : " << sizeof(wtext) << "\n";
    std::cout << "wcslen(wtext)   : " << wcslen(wtext) << "\n";

    std::cout << "wtext(ordinals) :";

    for(size_t i = 0, iMax = wcslen(wtext); i < iMax; ++i)
    {
        unsigned short wc = static_cast<unsigned short>(wtext[i]);
        std::cout << " " << static_cast<unsigned int>(wc);
    }

    std::cout << "\n\n";
} 
```

输出以下文本：

```
sizeof(char)    : 1
text            : olé
sizeof(text)    : 5
strlen(text)    : 4
text(ordinals)  : 111 108 195 169

sizeof(wchar_t) : 4
wtext           : UNABLE TO CONVERT NATIVELY.
wtext           : ol�
sizeof(wtext)   : 16
wcslen(wtext)   : 3
wtext(ordinals) : 111 108 233 
```

您会看到其中的“olé”文本`char`实际上是由四个字符构成的：110、108、195 和 169（不包括尾随的零）。（我会让你学习`wchar_t`代码作为练习）

因此，`char`在 Linux 上使用 a 时，您通常应该在不知不觉中使用 Unicode。并且与`std::string`一起使用`char`，因此`std::string`已经准备好使用 unicode。

请注意`std::string`，与 C 字符串 API 一样，将认为“olé”字符串有 4 个字符，而不是 3 个。因此，在截断/播放 unicode 字符时应小心谨慎，因为 UTF-8 中禁止某些字符组合。

### 在 Windows 上？

在 Windows 上，这有点不同。在 Unicode 出现之前，Win32 必须支持许多使用`char`和处理世界各地产生的不同[字符集](//en.wikipedia.org/wiki/Character_encoding)/[代码页的应用程序。](//en.wikipedia.org/wiki/Code_page)

所以他们的解决方案是一个有趣的解决方案：如果应用程序使用`char`，则使用机器上的本地字符集/代码页对 char 字符串进行编码/打印/显示在 GUI 标签上，很长一段时间内它*不可能*是 UTF-8。例如，“olé”在法语本地化的 Windows 中将是“olé”，但在西里尔语本地化的 Windows 上会有所不同（如果您使用[Windows-1251](//en.wikipedia.org/wiki/Windows-1251) ，则为“olé” ）。因此，“历史应用程序”通常仍会以同样的方式工作。

对于基于 Unicode 的应用程序，Windows 使用`wchar_t`2 字节宽，并以[UTF-16](//en.wikipedia.org/wiki/UTF-16)编码，这是 Unicode 编码在 2 字节字符上（或者至少是 UCS-2，它只是缺少代理对和因此 BMP 之外的字符 (>= 64K))。

使用的应用程序`char`被称为“多字节”（因为每个字形由一个或多个`char`s 组成），而使用的应用程序`wchar_t`被称为“widechar”（因为每个字形由一个或两个组成`wchar_t`。有关更多信息，请参阅[MultiByteToWideChar](https://msdn.microsoft.com/en-us/library/dd319072.aspx)和[WideCharToMultiByte](https://msdn.microsoft.com/en-us/library/dd374130.aspx) Win32 转换 API。

因此，如果您在 Windows 上工作，您**非常想**使用`wchar_t`（除非您使用隐藏它的框架，例如[GTK](//en.wikipedia.org/wiki/GTK)或[QT](//en.wikipedia.org/wiki/Qt_(software)) ...）。事实是，在幕后，Windows 使用字符串，因此即使是历史应用程序也会在使用类似 API 时转换`wchar_t`其`char`字符串（低级 API 函数在 Win32 GUI 上设置标签）。`wchar_t``SetWindowText()`

### 内存问题？

UTF-32 是每个字符 4 个字节，所以没有什么要添加的，只要 UTF-8 文本和 UTF-16 文本总是比 UTF-32 文本使用更少或相同数量的内存（通常更少）。

如果存在内存问题，那么您应该知道，与大多数西方语言相比，UTF-8 文本比相同的 UTF-16 文本使用更少的内存。

尽管如此，对于其他语言（中文、日文等），UTF-8 使用的内存将相同，或者略大于 UTF-16。

总而言之，UTF-16 将主要使用 2 个字节，有时每个字符使用 4 个字节（除非您正在处理某种深奥的语言字形（克林贡语？精灵语？），而 UTF-8 将花费 1 到 4 个字节。

有关更多信息，请参阅[https://en.wikipedia.org/wiki/UTF-8#Compared_to_UTF-16](https://en.wikipedia.org/wiki/UTF-8#Compared_to_UTF-16)。

## 结论

1.  ***我什么时候应该在 std::string 上使用 std::wstring？***

    在 Linux 上？几乎从不 （§）。在 Windows 上？几乎总是 （§）。在跨平台代码上？取决于你的工具包...

    (§) ：除非您使用工具包/框架另有说明

2.  ***可以`std::string`容纳包括特殊字符在内的所有 ASCII 字符集吗？***

    注意： A`std::string`适合保存“二进制”缓冲区，而 a`std::wstring`则不是！

    在 Linux 上？是的。在 Windows 上？只有特殊字符可用于 Windows 用户的当前语言环境。

    **编辑（在[Johann Gerell](/users/6345/johann-gerell)发表评论后）：** a`std::string`足以处理所有`char`基于 - 的字符串（每个字符串`char`都是从 0 到 255 的数字）。但：

    1.  ASCII 应该从 0 到 127。更高`char`的 s 不是 ASCII。
    2.  从 0 到 127的 a`char`将被正确保存
    3.  a`char`从 128 到 255 的含义取决于您的编码（unicode、非 unicode 等），但只要它们以 UTF-8 编码，它将能够保存所有 Unicode 字形。
3.  ***`std::wstring`几乎所有流行的 C++ 编译器都支持？***

    大多数情况下，移植到 Windows 的基于 GCC 的编译器除外。它适用于我的 g++ 4.3.2（在 Linux 下），自 Visual C++ 6 起我在 Win32 上使用 Unicode API。

4.  ***什么是宽字符？***

    在 C/C++ 上，它是一种`wchar_t`比简单`char`字符类型更大的字符类型。它应该用于放置索引（如 Unicode 字形）大于 255（或 127，具体取决于...）的字符。

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2009-12-29T16:14:55.650

我建议避免`std::wstring`在 Windows 或其他地方使用，除非接口需要，或者在任何靠近 Windows API 调用和各自的编码转换作为语法糖的地方。

我的观点总结在[http://utf8everywhere.org](http://utf8everywhere.org)中，我是其中的合著者。

除非您的应用程序是以 API 调用为中心的，例如主要是 UI 应用程序，否则建议将 Unicode 字符串存储在 std::string 中并以 UTF-8 编码，在 API 调用附近执行转换。文章中概述的好处超过了转换的明显烦恼，尤其是在复杂的应用程序中。对于多平台和库开发来说更是如此。

现在，回答您的问题：

1.  几个薄弱的理由。它的存在是出于历史原因，宽字符被认为是支持 Unicode 的正确方式。它现在用于连接更喜欢 UTF-16 字符串的 API。我只在此类 API 调用附近使用它们。
2.  这与 std::string 无关。它可以保存您放入其中的任何编码。唯一的问题是**你**如何对待它的内容。我的建议是 UTF-8，因此它能够正确保存所有 Unicode 字符。这是 Linux 上的常见做法，但我认为 Windows 程序也应该这样做。
3.  不。
4.  宽字符是一个令人困惑的名称。在 Unicode 的早期，人们相信一个字符可以用两个字节编码，因此得名。今天，它代表“任何两个字节长的字符部分”。UTF-16 被视为此类字节对（又名宽字符）的序列。UTF-16 中的字符采用一对或两对。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2011-11-07T06:07:09.977

所以，现在在座的每一位读者都应该对事实、情况有一个清醒的认识。如果没有，那么**您必须阅读 paercebal 非常全面的答案**[顺便说一句：谢谢！]。

我的实用结论非常简单：所有 C++（和 STL）“字符编码”的东西都被严重破坏和无用。归咎于微软与否，无论如何这都无济于事。

我的解决方案，经过深入调查，非常沮丧和随之而来的经验如下：

1.  接受，你必须自己负责编码和转换的东西（你会发现其中大部分都是微不足道的）

2.  对任何 UTF-8 编码的字符串使用 std::string (只是一个`typedef std::string UTF8String`)

3.  接受这样的 UTF8String 对象只是一个愚蠢但便宜的容器。永远不要直接访问和/或操作其中的字符（不要搜索、替换等）。你可以，但你真的真的真的不想浪费时间为多字节字符串编写文本操作算法！即使其他人已经做过这种愚蠢的事情，也不要那样做！随它去！（嗯，在某些情况下它是有意义的......只需使用 ICU 库）。

4.  对 UCS-2 编码的字符串使用 std::wstring ( `typedef std::wstring UCS2String`) - 这是一种妥协，也是对 WIN32 API 引入的混乱的让步）。UCS-2 对我们大多数人来说已经足够了（稍后会详细介绍……）。

5.  只要需要逐个字符的访问（读取、操作等），就使用 UCS2String 实例。任何基于字符的处理都应该以非多字节表示形式完成。它简单、快速、容易。

6.  添加两个实用函数来在 UTF-8 和 UCS-2 之间来回转换：

    ```
    UCS2String ConvertToUCS2( const UTF8String &str );
    UTF8String ConvertToUTF8( const UCS2String &str ); 
    ```

转换很简单，谷歌应该在这里提供帮助......

而已。在内存宝贵的地方和所有 UTF-8 I/O 使用 UTF8String。在必须解析和/或操作字符串的任何地方使用 UCS2String。您可以随时在这两种表示之间进行转换。

**替代方案和改进**

*   从 & 到单字节字符编码（例如 ISO-8859-1）的转换可以在普通翻译表的帮助下实现，例如`const wchar_t tt_iso88951[256] = {0,1,2,...};`从 UCS2 到 & 的转换的适当代码。

*   如果 UCS-2 不够用，则切换到 UCS-4 ( `typedef std::basic_string<uint32_t> UCS2String`)

**ICU 或其他 unicode 库？**

[对于高级的东西。](http://en.wikipedia.org/wiki/International_Components_for_Unicode)

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2008-12-31T11:48:20.757

1.  当您想在字符串中存储宽字符时。`wide`取决于实施。如果我没记错的话，Visual C++ 默认为 16 位，而 GCC 默认取决于目标。这里是 32 位长。请注意 wchar_t（宽字符类型）与 unicode 无关。它只是保证它可以存储实现支持的语言环境支持的最大字符集的所有成员，并且至少与 char 一样长。您也可以*将*unicode 字符串很好地存储到`std::string`使用`utf-8`编码中。但它不会理解 unicode 代码点的含义。所以`str.size()`不会为您提供字符串中的逻辑字符数量，而只会提供存储在该字符串/wstring 中的 char 或 wchar_t 元素的数量。出于这个原因，gtk/glib C++ 包装人员开发了一个[`Glib::ustring`](http://www.gtkmm.org/docs/glibmm-2.4/docs/reference/html/classGlib_1_1ustring.html)可以处理 utf-8 的类。

    *如果*您的 wchar_t 长度为 32 位，那么您可以`utf-32`用作 unicode 编码，并且您可以使用固定（utf-32 是固定长度）编码来存储*和处理 unicode 字符串。*这意味着您的 wstring`s.size()`函数将*返回*适量的 wchar_t 元素*和*逻辑字符。

2.  是的，char 总是至少 8 位长，这意味着它可以存储所有 ASCII 值。
3.  是的，所有主要编译器都支持它。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-31T04:33:23.913

我经常使用 std::string 来保存 utf-8 字符，完全没有任何问题。我衷心建议在与使用 utf-8 作为本机字符串类型的 API 交互时这样做。

例如，我在将代码与 Tcl 解释器连接时使用 utf-8。

主要的警告是 std::string 的长度，不再是字符串中的字符数。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-10-29T09:56:25.017

一个好问题！我认为**数据编码**（有时还涉及**字符集**）是一种**内存表达**机制，以便将数据保存到文件或通过网络传输数据，所以我回答这个问题：

**1\. 我应该什么时候使用 std::wstring 而不是 std::string？**

如果编程平台或 API 函数是单字节的，并且我们想要处理或解析一些 Unicode 数据，例如从 Windows'.REG 文件或网络 2 字节流中读取，我们应该声明 std::wstring 变量以方便处理它们。eg: wstring ws=L"中国a"(6 octets memory: 0x4E2D 0x56FD 0x0061)，我们可以使用ws[0]获取字符'中'和ws[1]获取字符'国'和ws[2]获取字符'a'等。

**2\. std::string 可以保存整个 ASCII 字符集，包括特殊字符吗？**

是的。但请注意：美国 ASCII，表示每个 0x00~0xFF 八位位组代表一个字符，包括可打印文本，例如“123abc&*_&”，您说的是特殊字符，大多打印为 '.' 避免混淆编辑器或终端。而其他一些国家扩展了他们自己的“ASCII”字符集，例如中文，使用 2 个八位字节来代表一个字符。

**3.所有流行的C++编译器都支持std::wstring吗？**

也许，或者大部分。我用过：VC++6 和 GCC 3.3，是的

**4\. 究竟什么是“宽字”？**

宽字符主要表示使用 2 个八位字节或 4 个八位字节来保存所有国家/地区的字符。2 octet UCS2 是一个有代表性的样本，再比如英文'a'，它的内存是2 octet of 0x0061(vs in ASCII 'a's memory 是1 octet 0x61)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-12-31T04:16:01.123

1.  当您想要存储“宽”（Unicode）字符时。
2.  是：其中 255 个（不包括 0 个）。
3.  是的。
4.  这是一篇介绍性文章：[http ://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-08-17T13:17:23.187

这里有一些非常好的答案，但我认为我可以添加一些关于 Windows/Visual Studio 的内容。这是基于我对 VS2015 的经验。`std::string`在 Linux 上，基本上答案是到处使用 UTF-8 编码。在 Windows/VS 上，它变得更加复杂。这就是为什么。Windows 期望使用`char`s 存储的字符串使用语言环境代码页进行编码。这几乎总是 ASCII 字符集后跟 128 个其他特殊字符，具体取决于您所在的位置。让我声明一下，这不仅在使用 Windows API 时，还有其他三个主要地方这些字符串与标准 C++ 交互。这些是字符串文字，输出到`std::cout`using`<<`并将文件名传递给`std::fstream`.

我将在这里表明我是一名程序员，而不是语言专家。我很欣赏 USC2 和 UTF-16 不一样，但出于我的目的，它们足够接近可以互换，我在这里使用它们。我实际上不确定使用哪个 Windows，但我通常也不需要知道。我已经在这个答案中声明了 UCS2，如果我因对此事的无知而让任何人感到不安，我很抱歉，如果我有问题，我很乐意改变它。

## 字符串文字

如果您输入的字符串文字只包含可以由您的代码页表示的字符，那么 VS 将它们存储在您的文件中，每个字符编码 1 个字节，基于您的代码页。请注意，如果您更改代码页或将源代码提供给使用不同代码页的其他开发人员，那么我认为（但尚未测试）该角色最终会有所不同。如果您使用不同的代码页在计算机上运行代码，那么我不确定字符是否也会改变。

如果您输入的任何字符串文字不能由您的代码页表示，那么 VS 会要求您将文件保存为 Unicode。然后该文件将被编码为 UTF-8。这意味着所有非 ASCII 字符（包括代码页上的字符）都将由 2 个或更多字节表示。这意味着如果您将您的来源提供给其他人，来源将看起来相同。但是，在将源代码传递给编译器之前，VS 会将 UTF-8 编码文本转换为代码页编码文本，并且代码页中缺少的任何字符都将替换为`?`.

保证在 VS 中正确表示 Unicode 字符串文字的唯一方法是在字符串文字之前加上`L`使其成为宽字符串文字。在这种情况下，VS 会将文件中的 UTF-8 编码文本转换为 UCS2。然后，您需要将此字符串文字传递给`std::wstring`构造函数，或者您需要将其转换为 utf-8 并将其放入`std::string`. 或者，如果您愿意，可以使用 Windows API 函数对其进行编码，使用代码页将其放入 a 中`std::string`，但您可能还没有使用宽字符串文字。

## 标准::cout

当使用您输出到控制台时，`<<`您只能使用`std::string`，而不是`std::wstring`，并且必须使用您的语言环境代码页对文本进行编码。如果你有，`std::wstring`那么你必须使用其中一个 Windows API 函数来转换它，并且代码页上没有的任何字符都被替换为`?`（也许你可以更改字符，我不记得了）。

## std::fstream 文件名

Windows 操作系统使用 UCS2/UTF-16 作为其文件名，因此无论您的代码页如何，您都可以拥有任何 Unicode 字符的文件。但这意味着要访问或创建包含不在您的代码页上的字符的文件，您必须使用`std::wstring`. 没有其他办法。这是 Microsoft 特定的扩展，`std::fstream`因此可能无法在其他系统上编译。如果您使用 std::string 那么您只能使用在您的代码页上仅包含字符的文件名。

## 您的选择

如果您只是在 Linux 上工作，那么您可能还没有走到这一步。只需`std::string`在任何地方使用 UTF-8。

如果您只是在 Windows 上工作，请在`std::wstring`任何地方使用 UCS2。一些纯粹主义者可能会说使用 UTF8，然后在需要时进行转换，但为什么还要麻烦。

如果您是跨平台的，那么坦率地说，这是一团糟。如果您尝试在 Windows 上的任何地方使用 UTF-8，那么您需要非常小心您的字符串文字并输出到控制台。您可以在那里轻松损坏您的字符串。如果您`std::wstring`在 Linux 上的任何地方都使用，那么您可能无法访问`std::fstream`. 所以我个人认为这是一个更好的选择。许多人会不同意，但我并不孤单 - 例如 wxWidgets 采用的路径。

另一种选择可能是在 Linux 和 Windows 上使用 typedef `unicodestring`，`std::string`并`std::wstring`有一个名为 UNI() 的宏，它在 Windows 上以 L 为前缀，而在 Linux 上则没有，然后是代码

```
#include <fstream>
#include <string>
#include <iostream>
#include <Windows.h>

#ifdef _WIN32
typedef std::wstring unicodestring;
#define UNI(text) L ## text
std::string formatForConsole(const unicodestring &str)
{
    std::string result;
    //Call WideCharToMultiByte to do the conversion
    return result;
}
#else
typedef std::string unicodestring;
#define UNI(text) text
std::string formatForConsole(const unicodestring &str)
{
    return str;
}
#endif

int main()
{

    unicodestring fileName(UNI("fileName"));
    std::ofstream fout;
    fout.open(fileName);
    std::cout << formatForConsole(fileName) << std::endl;
    return 0;
} 
```

我认为在任何一个平台上都可以。

## 答案

所以回答你的问题

1）如果您正在为 Windows 编程，那么一直，如果跨平台，那么可能一直，除非您想处理 Windows 上可能的损坏问题或编写一些特定于平台`#ifdefs`的代码来解决差异，如果只是使用Linux 然后永远不会。

2）是的。此外，在 Linux 上，您也可以将它用于所有 Unicode。在 Windows 上，如果您选择使用 UTF-8 手动编码，则只能将其用于所有 unicode。但是 Windows API 和标准 C++ 类将期望`std::string`使用语言环境代码页进行编码。这包括所有 ASCII 加上另外 128 个字符，这些字符会根据您的计算机设置使用的代码页而变化。

3）我相信是这样，但如果不是，那么它只是一个'std :: basic_string'的简单typedef，使用`wchar_t`而不是`char`

4)宽字符是大于1字节标准类型的字符`char`类型。在 Windows 上是 2 个字节，在 Linux 上是 4 个字节。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-09-11T09:28:00.243

不满足于仅 256 个不同字符的应用程序可以选择使用宽字符（超过 8 位）或可变长度编码（C++ 术语中的多字节编码），例如 UTF-8。宽字符通常比可变长度编码需要更多空间，但处理速度更快。处理大量文本的多语言应用程序在处理文本时通常使用宽字符，但在将其存储到磁盘时将其转换为 UTF-8。

`string`a和 a之间的唯一区别`wstring`是它们存储的字符的数据类型。字符串存储`char`s，其大小保证至少为 8 位，因此您可以使用字符串来处理例如 ASCII、ISO-8859-15 或 UTF-8 文本。该标准没有说明字符集或编码。

实际上，每个编译器都使用一个字符集，其前 128 个字符对应于 ASCII。使用 UTF-8 编码的编译器也是如此。在 UTF-8 或其他一些可变长度编码中使用字符串时要注意的重要一点是，索引和长度以字节而不是字符为单位测量。

wstring 的数据类型是`wchar_t`，其大小在标准中没有定义，只是它必须至少与 char 一样大，通常为 16 位或 32 位。wstring 可用于处理实现中定义的宽字符编码中的文本。因为标准中没有定义编码，所以字符串和wstrings之间的转换并不简单。也不能假设 wstrings 具有固定长度的编码。

如果您不需要多语言支持，您可能只使用常规字符串就可以了。另一方面，如果您正在编写图形应用程序，通常情况下 API 只支持宽字符。那么您可能希望在处理文本时使用相同的宽字符。请记住，UTF-16 是一种可变长度编码，这意味着您不能假设`length()`返回字符数。如果 API 使用固定长度编码，例如 UCS-2，则处理变得容易。宽字符和 UTF-8 之间的转换很难以可移植的方式进行，但话又说回来，您的用户界面 API 可能支持这种转换。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-31T04:16:48.593

1.  当您想使用 Unicode 字符串而不仅仅是 ascii 时，有助于国际化
2.  是的，但它不适合0
3.  不知道任何不知道的
4.  宽字符是编译器特定的处理 unicode 字符的固定长度表示的方式，对于 MSVC，它是 2 字节字符，对于 gcc，我理解它是 4 字节。和[http://www.joelonsoftware.com/articles/Unicode.html的 +1](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-12-31T04:24:41.853

1) 正如 Greg 所说，wstring 有助于国际化，即您将以英语以外的语言发布您的产品

4）检查这个宽字符 **[http://en.wikipedia.org/wiki/Wide_character](http://en.wikipedia.org/wiki/Wide_character)**

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2009-06-10T23:26:56.517

什么时候不应该使用宽字符？

当您在 1990 年之前编写代码时。

显然，我是在翻转，但实际上，现在是 21 世纪。127 个字符早就不够用了。是的，您可以使用 UTF8，但为什么还要麻烦呢？

# asp.net - ASP.NET 资源参考最佳实践

> ID：402299
> 
> 赞同：2
> 
> 时间：2008-12-31T04:23:48.207
> 
> 标签：asp.net

我对 ASP.NET 比较陌生，想知道是否有人可以阐明何时应该使用相对引用（例如 ../images/banner_tinga.jpg）与波浪号（例如 ~/images/banner_tinga.jpg）。根据情况，您可以使用其中任何一种来实现相同的目标。每种机制的优缺点是什么？相对引用的一个论点似乎是 Visual Studio 的设计时不喜欢波浪号引用的资源。每当我引用一个 css 文件时，它为什么表明它找不到。

问候， javacavaj

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T07:48:20.930

波浪号仅适用于具有 runat="server" 属性的控件，不适用于标准 HTML 控件。所以真的没有万能的选择。如果您希望将波浪号与 HTML 控件一起使用，则必须将它们标记为 runat="server"，如下所示

```
<img src="~/images/myimage.png" runat="server"> 
```

但这似乎不是一个好的做法，因为它将被添加到视图状态中。但是，你也可以这样做

```
<img src="~/images/myimage.png" runat="server" EnableViewState="False"> 
```

因此，选择变得真正普遍。

现在回答你原来的问题：

我认为最好使用“~”波浪号，因为它为您提供了一个参考点——您网站的根目录。如果您更改网页的文件夹并将其带到不同的级别（层次结构中的更高或更低），相对路径方案“../”将失败

希望这有帮助。

要访问您的 CSS 文件，请执行以下操作

```
<link href="<%= VirtualPathUtility.ToAbsolute("~/css/style.css/") %>" type="text/css"> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T07:49:00.053

嗯......我完全不同意@StevenMcD。波浪号始终引用您正在开发的 Web 应用程序的根，而相对路径表示法基于您在 Web 应用程序中的当前位置。我认为从长远来看，如果您重新组织或重组网页的文件位置，波浪符号将使您更容易重构，因为您始终知道基本路径 (~) 指的是Web应用程序。如果使用“../”表示法，您无法确定这一点。

另一个注意事项...波浪号 (~) 符号在 ASP.NET 中使用用户控件和母版页时非常方便。当您将用户控件放到 Web 表单上时，该 Web 表单可以嵌套在应用程序文件结构的任何部分中。根本不保证相对路径在该场景中有效。通过使用波浪符号，所有路径都可以用代码编写并且可以工作，因为它们基于 Web 应用程序的根。希望这可以帮助。

顺便说一句，在 ASP.NET 中不建议以任何方式使用 ~。

更新：正如 Cyril 所提到的， ~ 仅在使用 ASP.NET 控件时对您可用。纯 HTML 元素无法使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T07:36:22.670

就我个人而言，我现在只使用相对引用并避免使用波浪号。这可能会导致进一步的问题。虽然我无法显示任何与之相关的参考资料，但我记得在某处听到/读到波浪号参考已被弃用

# java - struts2: s:checkbox 与 s:checkbox 不在同一行

> ID：402302
> 
> 赞同：5
> 
> 时间：2008-12-31T04:27:48.947
> 
> 标签：java, struts2, rendering

这是 .jsp 代码：

```
<table>
        <s:iterator value="allAgents">
            <tr>
                <td><s:property value="firstName" /></td>
                <td><s:property value="middleName" /></td>
                <td><s:property value="lastName" /></td>
                <td><s:checkbox name="ss"/></td>
            </tr>
        </s:iterator>
</table> 
```

渲染时，复选框将占据“名称”下方的一整行，居中。这是应该是单行的生成的html：

```
<tr>
    <td>first</td>
    <td>middle</td>
    <td>last</td>
    <td>
<tr>
    <td valign="top" align="right"></td>
    <td valign="top" align="left"><input type="checkbox" name="ss"
        value="true" id="agent_ss" /> <input type="hidden"
        name="__checkbox_ss" value="true" /></td>
</tr>

</td>
</tr> 
```

是我还是struts？TIA。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T10:30:29.347

添加属性 theme="simple" 喜欢

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-02T06:30:52.880

Struts2 将 s:checkbox 本身呈现为表格单元格。原因是 struts2 使用模板系统进行标记呈现。默认是（在 struts-default.properties 中定义）

### 标准 UI 主题

struts.ui.theme=xhtml

struts.ui.templateDir=模板

struts.ui.templateSuffix=ftl

你需要做这个改变——struts.ui.theme:simple

可以通过添加来完成

常量名=“struts.ui.theme”值=“简单”/>标签

在“struts.xml”中。这就足够了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-31T06:31:50.773

您需要查看用于表单标签呈现的主题。Struts2 使用模板系统（在 struts.properties 中定义）。看起来您默认使用的是 xhtml 模板，该模板旨在输出一个两列表。您可以在应用程序中默认为简单或在标签级别（或介于两者之间的五个其他层次结构）覆盖它。

这里有更多信息：[http ://struts.apache.org/2.0.14/docs/themes-and-templates.html](http://struts.apache.org/2.0.14/docs/themes-and-templates.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-02T21:28:44.587

定义复选框时，使用“theme = simple”属性，如下所示：

“简单”主题会将您的复选框与您的其他字段放在同一行。干杯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T14:48:08.073

问题在于默认的struts 主题`s:checkbox`是一个表格单元格本身。（Struts 2 将其呈现为表格单元格）

在您的 jsp 中，您`<td>`再次将其包含在标签中（这不是必需的）

尝试删除`<td>`复选框标签周围的标签。

# ruby-on-rails - ActiveRecord has_n 关联

> ID：402307
> 
> 赞同：2
> 
> 时间：2008-12-31T04:32:25.303
> 
> 标签：ruby-on-rails, activerecord, associations

我想知道对一个对象与另一个类的 n 个对象相关联的关系进行建模的最佳方法是什么。我想将 has_one 关系扩展到 n 的特定值。

例如，TopFiveMoviesList 将属于用户并且恰好有五部电影。我会想象底层的 sql 表会有类似 movie_id_1、movie_id_2、...movi​​e_id_5 的字段。

我知道我可以做一个 has_many 关系并限制模型级别的孩子数量，但我宁愿没有中间表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T22:03:31.843

我认为通过连接模型来实现这个模型将是你最好的选择。它允许`List`模型担心 List 逻辑和`Movie`模型担心 Movie 逻辑。您可以创建一个`Nomination`（名称不是最好的，但您知道我的意思）模型来处理电影和列表之间的关系，当限制为 5 时，您可以限制您撤回的提名数量。

有几个原因我认为这种方法更好。

首先，假设您希望能够以两种方式（`movie.lists`和`list.movies`）遍历关系，那么 5 列方法将变得更加混乱。

While it'd be so much better for ActiveRecord to support `has n` relationships, it doesn't, and so you'll be fighting the framework on that one. Also, the `has n` relationship seems a bit brittle to me in this situation. I haven't seen that kind of implementation pulled off in ActiveRecord, though I'd be really interested in seeing it happen. :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T15:22:47.923

我假设您的意思是“实施”而不是“模型”？在 UML 中建模非常简单，例如，您有一个由 5 个电影实体组成的 Person 实体。

但是当你说has_one，去has_5时，困难就来了。如果它是一个简单的标量值，has_one 可能是父实体上的一个属性。Has_5 可能是通过 UML 中的“由”关系相互关联的 2 个实体。

要回答的主要问题可能是，“你能保证它永远是‘前五名’吗？” 如果是，请使用列对其进行建模，如您所述。如果不是，则使用另一个实体对其进行建模。

另一个问题可能是，“重构有多容易？” 如果它很简单，见鬼，从 5 列开始，如果它发生变化，重构为单独的实体。

像往常一样，“最佳”取决于业务和技术环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T23:36:27.567

我的第一直觉是使用连接表，但如果这不是可取的，`User.movie[1-5]_id`列将符合要求。（我认为`movie1_id`更适合 Rails 约定比`movie_id_1`。）

由于您标记了此 Rails 和 ActiveRecord，我将在我的答案中添加一些完全未经测试且可能有些错误的模型代码。:)

```
class User < ActiveRecord::Base
  TOP_N_MOVIES = 5
  (1..TOP_N_MOVIES).each { |n|  belongs_to "movie#{n}".to_sym, :class_name => Movie }
end 
```

您可以将该行包装在宏样式方法中，但除非这是您的应用程序的常见模式，否则这样做可能只会使您的代码更难阅读，而几乎没有 DRY 好处。

您可能还想添加验证以确保用户列表中没有重复的电影。

将您的电影类关联回您的用户是类似的。

```
class Movie < ActiveRecord::Base

  (1..User::TOP_N_MOVIES).each do |n| 
    has_many "users_list_as_top_#{n}".to_sym, :class_name => User, :foreign_key => "movie#{n}_id"
  end

  def users_list_as_top_anything
    ary = []
    (1..User::TOP_N_MOVIES).each {|n| ary += self.send("users_list_as_top_#{n}") }
    return ary
  end

end 
```

（当然，`users_list_as_top_anything`写成显式 SQL 可能会更好。我今天很懒。）

# c# - Visual Studio 2008 无法识别 Lambda 表达式语法

> ID：402313
> 
> 赞同：1
> 
> 时间：2008-12-31T04:38:53.573
> 
> 标签：c#, asp.net, visual-studio-2008, .net-3.5, lambda

我最近使用内置的转换工具将 Web 应用程序项目（以及一些依赖项目）从 .net 2.0 升级到了 .net 3.5。一切都运行良好，例如使用 MS AJAX 3.5 与 2.0 中的外部 MS AJAX 库。

当我尝试使用新的 Lambda 表达式语法时，出现了我的问题。编译器不会将 Lambda 表达式识别为有效语法。解决方案中所有项目的目标框架版本设置为 3.5。我还能够在同一解决方案中的库项目中成功使用 Lambda 表达式。

这是给我错误的代码。没什么特别的。

```
ObjectFactory.Initialize(x => 
        {
            x.ForRequestedType<IUnitIdSequencingService>().TheDefaultIsConcreteType<UnitIdSequencingService>();
            x.ForRequestedType<IGadgetDAO>().TheDefault.Is.OfConcreteType<GadgetDAO>().WithCtorArg("instance").EqualToAppSetting("OSHAInspectionManager");

        }); 
```

我得到的具体错误是：

```
Error   102 Invalid expression term '>' D:\projects\bohlco\pmr\PMR\Web\App_Code\Bootstrapper.cs 13  41  D:\...\Web\ 
```

任何帮助将不胜感激。我一直在搜索谷歌，运气不佳

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T10:24:14.937

如果任何页面正在由 ASP.NET 编译（即您没有预编译 WAP），那么您需要确保 ASP.NET 知道 C# 3.0 (.NET 3.5) 编译器。确保以下内容位于`web.config`：

```
<system.codedom>
   <compilers>
      <compiler language="c#;cs;csharp"
            extension=".cs"
            warningLevel="4"
            type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=
         <providerOption name="CompilerVersion" value="v3.5"/>
         <providerOption name="WarnAsError" value="false"/>
      </compiler>
   </compliers>
</system.codedom> 
```

此外，如果您在 IIS 中托管，请确保将正确的文件夹设置为应用程序，并且它使用的是 ASP.NET v2.blah（不是 v1.1.blah）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T04:47:42.667

我对 VS 2008 转换工具没有太多经验，但我知道其他项目转换工具也有“问题”。我建议您将“损坏”项目的 .csproj 文件与正在运行的项目进行比较。也许转换实用程序破坏了您项目中的某些内容。您也可以尝试创建一个新项目并复制所有源文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T04:57:23.210

您需要跳过现有项目重新引用的几个箍，TBH 我发现创建一个新项目并将我现有的源文件添加到新项目中更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T06:12:31.670

我猜测您将 lambda 传递给的方法的参数是否接受委托作为参数？

如果这是真的，那么您需要将 lambda 转换为特定类型的委托。这有点令人困惑，但您需要知道的是，无法始终正确推断出 lambda，因此您需要对其进行强制转换或更改方法签名以接受特定类型的委托。

试试这个：

```
ObjectFactory.Initialize((Action<T>)(x => // where T is the typeof x
{
    // ...
})); 
```

您也可以尝试为 Initialize 进行一些重载以接受特定类型的委托（例如操作）。

如果您的方法确实接受特定类型的委托类型，那么您可以忽略此答案:)

# c++ - 当提供 windows .dmp 或 .minidmp 时，您如何识别（并访问）要使用的模块/调试符号

> ID：402314
> 
> 赞同：1
> 
> 时间：2008-12-31T04:39:42.497
> 
> 标签：c++, module, symbols, dump, minidump

从[读取 Windows *.dmp 文件开始](https://stackoverflow.com/questions/158534/reading-a-windows-dmp-file)

收到来自随机客户的转储文件，运行调试会话以查看崩溃，您经常会发现它位于 MS 或其他第三方库中。下一个问题是您可能不了解 PC 设置，以至于无法确保您拥有实际可用的模块。

例如，我目前正试图为 ntdll.dll (5.01.2600.5512) 加载符号。在 MSVC 2005 中，模块列表窗口中的路径列在完整路径文件名之前显示 *，并且拒绝加载我为 XP/SP1/SP1a/SP2/SP3 下载的符号。

我有符号服务器设置，可以从 Internet 下载并存储在本地缓存中，这对于我的 PC 上的模块似乎运行良好。使用与方法等效的 GUI

```
设置 _NT_SYMBOL_PATH=srv*d:\SymbolCache*\\server1\Third-Party-PDB;srv*d:\SymbolCache*\\server2\Windows\Symbols*http://msdl.microsoft.com/download/symbols

```

也许我有错误的符号，但由于没有下载新符号，我下一步该去哪里？我是否必须联系客户并询问他们安装了哪些 SP 以及任何其他补丁？我是否必须安装那台机器，然后使用 dmp 文件运行调试器以获取我需要的符号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T17:39:13.170

如果您使用的是 WinDbg（[Windows 调试工具](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)包的一部分），那么很容易让它自动从 Microsoft 为您提取正确的符号。使用“.symfix”（或“.symfix+”，以简单地附加到现有符号搜索路径）命令配置符号路径。

完成此操作并在 WinDbg 中加载故障转储后，键入“.reload /f”以使 WinDbg 重新加载符号。它将使用转储文件本身中的信息从 Microsoft 的公共符号服务器中提取正确的符号，而不管您的机器上有什么 DLL。

如果由于某种原因在您完成此操作后符号未正确加载，请在 WinDbg 的命令窗口中输入“！sym noise”并再次重新加载符号。当 WinDbg 尝试加载它们时，您将看到它输出它在搜索/加载过程中遇到的任何错误。这些错误消息将帮助您进一步诊断出了什么问题以及未加载正确符号的原因。

[这篇文章](https://stackoverflow.com/questions/389103/debugging-tools-for-windows-symbol-proxy-doesnt-proxy#390243)包含的信息也可能有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T23:55:15.240

如果您在`Set _NT_SYMBOL_PATH = srv...`命令提示符中键入“”，则需要考虑两件事：

*   `cmd.exe`的`set`命令不会忽略空格，因此它定义了一个名为“ `_NT_SYMBOL_PATH`”的变量，而不是“ `_NT_SYMBOL_PATH`”。
*   您必须将调试器作为该命令提示符的子项启动。`setx`但是，如果您使用控制面板设置持久性环境变量，或者如果您使用命令（在 Windows Vista 或 Windows 资源工具包之一中），则不必执行此操作。

如果您以其他方式设置符号路径，则不适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T16:26:30.650

尝试按照[此 kb 文章](http://support.microsoft.com/kb/311503)中的说明进行操作，并确保您的符号路径配置正确，WinDbg 可以访问它，并且 ntdll 符号（例如）实际上已下载到您的符号缓存中。本文还提供了有关如何通过 SymChk 工具手动下载和验证缓存中的符号的说明。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T17:15:24.153

你用什么来调试小型转储？即，WinDBG 还是 Visual Studio？minidump 是如何生成的？

minidump 中应该有足够的信息来正确解析系统 dll 符号。您使用的是符号的本地下载还是[http://msdl.microsoft.com/](http://msdl.microsoft.com/)？

更新：您应该能够将公共 microsoft 符号存储添加到 Tools->Options->Debugging->Symbols->Symbol file (.pdb) 位置，然后通过右键单击 Modules 窗口中的模块手动加载符号并在没有自动完成的情况下加载它们。

VS 2005 也可能（很可能）不考虑`_NT_SYMBOL_PATH`解析小型转储符号。

# java - 在软件中学习算法和保存数据

> ID：402316
> 
> 赞同：1
> 
> 时间：2008-12-31T04:40:46.847
> 
> 标签：java, c++, algorithm

我来自网络开发背景，我想知道如何在 Java/C++ 中制作学习算法。与其说是算法部分，不如说是让程序“记住”它从前一天学到的东西。我会想像保存文件这样的事情，但我怀疑它们可能是一种更简单的方法。抱歉，如果这个问题过于愚蠢。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T04:45:24.497

我认为这将取决于问题域。您可能希望将学到的“事实”或“关系”存储在数据库中，以便可以轻松搜索它们。如果您正在训练神经网络，那么您可能只是将网络状态转储到文件中。总的来说，我认为一旦你有了一种学习机制，适当的存储表示就会相对明显。

也许如果你可以充实你想要实施什么样的学习的计划，人们可以提供更多关于实施应该是什么样子的指导，包括状态存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T04:48:12.713

不傻，但可能有点畸形。

当您的程序“学习”某些东西时，您要做的是更新某些数据结构的状态。如果要保留该状态，则需要将数据结构*持久*保存到某个外部存储。这意味着将数据结构转换为一些外部形式，您可以在不丢失的情况下重新读取。

Java 通过[Serializable](http://www.acm.org/crossroads/xrds4-2/serial.html)接口提供了一种直接的方式来实现这一点；您通过 ObjectStream发送[Serializable对象来](http://en.wikipedia.org/wiki/Serialization)[序列化数据；](http://java.sun.com/javase/6/docs/platform/serialization/spec/protocol.html)相同的 ObjectStream 稍后将重新加载它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T04:45:38.630

如果您想访问和保存大量数据，那么数据库可能会很好用。这将允许您构建数据并以更简单的方式进行查找。我对这个主题不太精通，但我认为在记忆和回忆事物方面，数据库将大大优于文件系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T04:47:52.027

Java 中的一个健壮/灵活的解决方案（C++ 也是，但我不知道如何）将使用数据库。Java 1.6 带有 Apache derby 数据库，可以嵌入到您的应用程序中。使用 JPA (Java Persistence API) 可以轻松地与您可以找到驱动程序的任何数据库进行交互。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T05:06:30.460

您应该研究[神经网络软件开发](http://en.wikipedia.org/wiki/Neural_network#Neural_network_software)。[下面是](http://leenissen.dk/fann/)一组适用于不同语言的优秀神经网络库。我不确定这是否是简单的方法，但一旦完成将非常方便。

# java - 是否可以在java中动态“添加”到类路径？

> ID：402330
> 
> 赞同：23
> 
> 时间：2008-12-31T04:51:41.270
> 
> 标签：java, classpath, urlclassloader

```
java -classpath ../classes;../jar;. parserTester 
```

如何以编程方式获取上述命令中的功能？像，是否可以运行为：

```
java parserTester 
```

并得到相同的结果？我尝试使用 URLClassLoader 但它修改了类路径并且没有添加到它。

谢谢！

* * *

感谢米尔豪斯的回复。但这就是我想要做的.. 怎么可能首先将 jar 放入类路径？我也尝试使用自定义类加载器:(

那行得通..但很抱歉我只需要运行它：java parserTester 我想知道这样的事情是否可能？？？

它必须如此，因为我在一个单独的文件夹中有 parserTester.java 和 .class。我需要保留文件结构。parserTester 在单独的 jar 文件夹中使用 jar。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-31T08:55:51.697

您可以使用 java.net.URLClassLoader 使用您希望的任何程序定义的 URL 列表加载类：

> 公共类 URLClassLoader 扩展 SecureClassLoader
> 
> 此类加载器用于从引用 JAR 文件和目录的 URL 的搜索路径加载类和资源。假设任何以“/”结尾的 URL 都指向一个目录。否则，假定 URL 引用将根据需要打开的 JAR 文件。
> 
> 创建 URLClassLoader 实例的线程的 AccessControlContext 将在随后加载类和资源时使用。
> 
> 默认情况下，加载的类仅被授予访问在创建 URLClassLoader 时指定的 URL 的权限。
> 
> 自：1.2

一点花哨的步法可以扩展它以支持使用通配符路径名来获取 JAR 的整个目录（这段代码有一些实用方法的引用，但它们的实现在上下文中应该是显而易见的）：

```
/**
 * Add classPath to this loader's classpath.
 * <p>
 * The classpath may contain elements that include a generic file base name.  A generic basename
 * is a filename without the extension that may begin and/or end with an asterisk.  Use of the
 * asterisk denotes a partial match. Any files with an extension of ".jar" whose base name match
 * the specified basename will be added to this class loaders classpath.  The case of the filename is ignored.
 * For example "/somedir/*abc" means all files in somedir that end with "abc.jar", "/somedir/abc*"
 * means all files that start with "abc" and end with ".jar", and "/somedir/*abc*" means all files
 * that contain "abc" and end with ".jar".
 *
 */
public void addClassPath(String cp) {
    String                              seps=File.pathSeparator;                // separators

    if(!File.pathSeparator.equals(";")) { seps+=";"; }                          // want to accept both system separator and ';'
    for(StringTokenizer st=new StringTokenizer(cp,seps,false); st.hasMoreTokens(); ) {
        String pe=st.nextToken();
        File   fe;
        String bn=null;

        if(pe.length()==0) { continue; }

        fe=new File(pe);
        if(fe.getName().indexOf('*')!=-1) {
            bn=fe.getName();
            fe=fe.getParentFile();
            }

        if(!fe.isAbsolute() && pe.charAt(0)!='/' && pe.charAt(0)!='\\') { fe=new File(rootPath,fe.getPath()); }
        try { fe=fe.getCanonicalFile(); }
        catch(IOException thr) {
            log.diagln("Skipping non-existent classpath element '"+fe+"' ("+thr+").");
            continue;
            }
        if(!GenUtil.isBlank(bn)) {
            fe=new File(fe,bn);
            }
        if(classPathElements.contains(fe.getPath())) {
            log.diagln("Skipping duplicate classpath element '"+fe+"'.");
            continue;
            }
        else {
            classPathElements.add(fe.getPath());
            }

        if(!GenUtil.isBlank(bn)) {
            addJars(fe.getParentFile(),bn);
            }
        else if(!fe.exists()) {                                                 // s/never be due getCanonicalFile() above
            log.diagln("Could not find classpath element '"+fe+"'");
            }
        else if(fe.isDirectory()) {
            addURL(createUrl(fe));
            }
        else if(fe.getName().toLowerCase().endsWith(".zip") || fe.getName().toLowerCase().endsWith(".jar")) {
            addURL(createUrl(fe));
            }
        else {
            log.diagln("ClassPath element '"+fe+"' is not an existing directory and is not a file ending with '.zip' or '.jar'");
            }
        }
    log.diagln("Class loader is using classpath: \""+classPath+"\".");
    }

/**
 * Adds a set of JAR files using a generic base name to this loader's classpath.  See @link:addClassPath(String) for
 * details of the generic base name.
 */
public void addJars(File dir, String nam) {
    String[]                            jars;                                   // matching jar files

    if(nam.endsWith(".jar")) { nam=nam.substring(0,(nam.length()-4)); }

    if(!dir.exists()) {
        log.diagln("Could not find directory for Class Path element '"+dir+File.separator+nam+".jar'");
        return;
        }
    if(!dir.canRead()) {
        log.error("Could not read directory for Class Path element '"+dir+File.separator+nam+".jar'");
        return;
        }

    FileSelector fs=new FileSelector(true).add("BaseName","EG",nam,true).add("Name","EW",".jar",true);
    if((jars=dir.list(fs))==null) {
        log.error("Error accessing directory for Class Path element '"+dir+File.separator+nam+".jar'");
        }
    else if(jars.length==0) {
        log.diagln("No JAR files match specification '"+new File(dir,nam)+".jar'");
        }
    else {
        log.diagln("Adding files matching specification '"+dir+File.separator+nam+".jar'");
        Arrays.sort(jars,String.CASE_INSENSITIVE_ORDER);
        for(int xa=0; xa<jars.length; xa++) { addURL(createUrl(new File(dir,jars[xa]))); }
        }
    }

private URL createUrl(File fe) {
    try {
        URL url=fe.toURI().toURL();
        log.diagln("Added URL: '"+url.toString()+"'");
        if(classPath.length()>0) { classPath+=File.pathSeparator; }
        this.classPath+=fe.getPath();
        return url;
        }
    catch(MalformedURLException thr) {
        log.diagln("Classpath element '"+fe+"' could not be used to create a valid file system URL");
        return null;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T06:32:17.197

我必须同意其他两张海报，听起来你让测试课变得过于复杂。将 .java 和 .class 文件放在单独的文件夹中，而在第三个文件夹中依赖于 jar 文件，而无需以编程方式更改类路径，这并不罕见。如果您这样做是因为您不想每次都在命令行上键入类路径，我建议您使用 shell 脚本或批处理文件。更好的是，一个 IDE。我真正遇到的问题是，您为什么要尝试在代码中管理类路径？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T07:21:34.680

您可以编写批处理文件或 shell 脚本文件来导出类路径并运行 java 程序。在 Windows 中，

set classpath=%classpath%;../classes;../jars/* java ParserTester

在 Unix 中，导出 classpath=%classpath%:../classes:../jars/* java ParserTester

如果您将文件名命名为 parser.bat 或 parser.sh，您可以通过在相应操作系统中调用 parser 来运行它。

从 java 1.6 开始，您可以通过说 /* 将目录中的所有 jar 包含到类路径中

如果您尝试动态生成 java 文件，请编译并添加到类路径中，请事先在类路径中设置生成类文件的目录。它应该加载类。如果你正在修改已经生成的java类，基本上是修改后重新编译，如果你想加载新的类，你需要使用你的自定义类加载器来避免类的缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T04:56:05.643

您可以实现自己的[类加载器](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassLoader.html)，但该类/jar 必须在类路径中才能执行。

尝试

```
java -cp *.jar:. myClass 
```

或者

```
export CLASSPATH=./lib/tool.jar:.
java myClass 
```

或者

```
java -jar file.jar 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-27T13:43:28.530

我认为您想要的是“执行包装器”或特定于平台的“启动器”...通常此组件用于检测您的操作系统和体系结构以及依赖项，然后在启动应用程序之前进行调整。这是一种老式的设计模式（80 年代或更早），但今天仍然被大量使用。这个想法是您的程序可以与系统和环境无关，启动器将做好准备并告诉软件它需要知道的一切。许多现代开源程序使用 Shell 脚本和批处理文件等来执行此操作……例如 Apache Tomcat。您可以轻松地在 java 中制作包装器，并让它使用命令行 exec 启动软件（确保在 *NIX 中的 exec 命令末尾添加“&”，以便您的包装器可以退出，只留下您的软件运行。 . . 还可以让您在不终止进程的情况下关闭 shell 窗口）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-31T06:17:37.463

我理解对了吗？！你有它的唯一原因是你想在不指定类路径的情况下启动你的类并在运行时加载它？...

> java parserTester

代替

> java -classpath ../classes;../jar;. 解析器测试器

可能我没有得到你的理由。但是，如果“这就是”您想要的，您可以执行以下操作（尽管对我来说没有多大意义）

*   开课
*   从 main 方法 lauch 另一个类以编程方式在那里设置类路径。
*   历史的终结。

类似于以下“java -pseudo code”

```
public static void main( String [] args ) {
    String classpath = "classes;../jar";
    Runtime.getRuntime().execute("java + classpath + " parserTester ");
} 
```

如果我做对了，请告诉我。如果您想做其他事情，我很乐意提供帮助。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2011-03-31T15:53:35.747

优秀的好帖子，就我而言，我这样做是为了很好地工作（注意：特定于 Windows）：

```
set classpath=%classpath%;../lib/*
java -cp %classpath% com.test.MyClass 
```

# nhibernate - NHibernate 和 Spring.NET 的结合在企业级应用中真的很有帮助！

> ID：402334
> 
> 赞同：3
> 
> 时间：2008-12-31T04:53:02.500
> 
> 标签：nhibernate, spring.net

在项目中使用过 Spring.NET 和 NHibernate 的软件开发人员有何看法？在我工作的公司的几个项目中，我们非常广泛地使用了这些第三方工具，并且我们获得了巨大的生产力。需要注意的是，对于初级 .Net 开发人员来说，掌握这个概念有点困难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T18:59:19.957

Imo、Spring.Net 和 NHibernate 齐头并进：如果您掌握了学习曲线，当 Spring 用于 NHibernate 的（几乎透明的）[事务处理](http://www.springframework.net/doc-latest/reference/html/orm.html#orm-hibernate)、依赖注入以及 Db:Provider 处理时，您会非常高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T06:53:11.883

NHibernate（或类似的 ORM）对于“未开发”开发非常有帮助，其中可以正确设计域对象模型，然后可以生成数据库模式和 NHibernate 映射以匹配模型。另一方面，NHibernate 可能很难应用于遗留或规范化程度不高的数据库。尽管它支持处理一些不寻常的数据结构，但这些技术的学习曲线要​​高得多。

关于 Spring.Net，我不能说太多，除了 2007 年，我们的团队试图将它实施到一个现有的、复杂的解决方案中来处理数据库事务和实体验证，但经过一周的工作后我们放弃了这个想法。我们的常驻 Spring/Java 专家得出结论，Spring.Net 是 Spring 之后的几个版本，还不够成熟，无法处理我们项目中的用例。免责声明：不确定 Spring.Net 的版本，所以最近情况可能有所改善。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T16:32:55.047

使用 spring.net/nHibernate 有很多好处。

对于数据访问，您可以通过延迟加载、数据库独立编程、轻松保存加载更新、删除实体来充分利用 nHibernate ORM。无需编写任何查询即可。这就是为什么在设计数据库和开发之后，如果在任何开发状态下需要进行任何更改，都非常容易更改。

依赖注入（DI）有助于分离 UI 和业务逻辑。这就是为什么您可以随时更改图形用户界面而不会破坏任何业务逻辑的原因。同样，如果您需要对业务逻辑进行任何更改，则只需要构建业务层。它也是可配置的。

面向方面编程 (AOP) 是 Spring.Net 的另一个特性。它有助于记录应用程序，动态方法拦截允许对方法调用进行更多控制。它使授权应用程序变得容易。声明式事务管理是管理事务的一个很好的特性。您不需要为启动停止数据库连接编写代码。只需在配置文件中写入您要维护事务的方法即可。因此，在大型项目中，它将节省大量时间，并为您提供更多的事务管理灵活性。

Spring webservice 很容易从客户端编写和使用。无需添加任何自定义属性，无需 WSDL。您可以拦截每个方法调用，您可以添加诸如日志记录建议、身份验证/授权建议等建议。

总体而言，它节省了大约 33% 的开发时间，使应用程序更易于维护，高度可配置。

# css - 使用#IEroot 进行针对ie 的样式设置？

> ID：402337
> 
> 赞同：3
> 
> 时间：2008-12-31T05:01:53.870
> 
> 标签：css, internet-explorer

有没有人能够成功使用 IE CSS hack #IEroot？[我从这篇文章](http://www.positioniseverything.net/articles/cc-plus.html)中偶然发现了它，但它似乎对我不起作用。

我正在尝试修复/破解内联样式错误以生成 li 内联块

```
#featured li {
    margin:0px;
    padding:0px;
    width:317px;
    height:310px;
    display:inline-block;
    border-left:1px #bdbdbd solid;
}
#IEroot #featured li {
    display:inline;
} 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T12:48:58.547

**它确实可以工作**，正如所描述的那样，即使在 IE8 中也是如此，并且实际上是一个非常聪明的 CSS hack，可以解决 IE 特定的错误。

您**必须**先将 DOCTYPE 行换成 REAL DOCTYPE。

这是链接中的代码，经过调整以成为工作示例。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<style>
/* all browsers make border red */
#IE { border : 2px solid red; }
/* all browsers see this, but only IE thinks #IEroot exists as an element and makes border blue */
#IEroot #IE { border-color : blue; }
</style>
</head>
<body>
<!--[if IE]>
<div id="IEroot">
<![endif]-->
<p id="IE">This browser is IE. (red in all, blue in IE)</p>
<p id="notIE">This browser is not IE.</p>
<!--[if IE]>
</div>
<![endif]-->
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-31T05:26:43.087

我正在使用 IE8 的测试版，您所指的页面上的示例不起作用。现场演示似乎也没有计入 IE8。

这些类型的黑客很聪明，但我建议你远离它。

每当您遇到浏览器之间的差异时，总会有替代方法来做同样的事情，使其适用于所有浏览器。

我用 CSS 制作的网站多得数不清，而且我从不求助于特定于浏览器的代码，尤其是那些利用特定版本浏览器中的错误的代码。他们今天解决了一个小问题，但明天给你带来两倍的头痛，并且是一个需要维护的婊子。

如果您坚持使用这样的 hack，请务必添加如下评论：

```
/* >>>>>>> BUTT-UGLY BROWSER HACK! FIX ME!!!!! <<<<<<<< */
#IEroot #featured li {
    display:inline;
} 
```

:-)

# cocoa-touch - 在 UITextField 中获取对齐文本

> ID：402339
> 
> 赞同：5
> 
> 时间：2008-12-31T05:03:51.887
> 
> 标签：cocoa-touch

如何使用 UTTextField 获得合理的文本。它确实有一个 textAlignment 属性。但是 UITextAlignment 常量只有左对齐、右对齐和居中对齐。

我正在寻找的是文字处理应用程序中常见的对齐文本，其文本与左右边缘齐平。这是一个只读文本字段。

我在几个 iPhone 应用程序中见过它。所以看来我错过了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T10:44:44.537

这可能有点矫枉过正，但一种方法似乎是使用 WebView 并使用 CSS 设置文本样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T09:58:52.757

UILabel 和 UITextField 不支持全对齐文本。如果您希望它用于 UITextField，则必须创建 UITextField 的子类并覆盖`drawTextInRect:`，将文本拆分为单词并使用`sizeWithFont:`它来确定如何将它们沿每行隔开。

我无法想象有什么值得麻烦的。

# javascript - 如何检测给定 IP 是否在 Javascript 中的给定子网中？

> ID：402341
> 
> 赞同：3
> 
> 时间：2008-12-31T05:06:01.913
> 
> 标签：javascript, networking, tcp, ip

我想用 Javascript 编写一个函数，如下所示：

```
in_subnet(ip, network, slash) {
    ...
}

in_subnet('1.2.3.4', '1.2.0.0', 16) # True, since it's in 1.2.0.0/16
in_subnet('1.2.3.4', '1.2.0.0', 24) # False, since it's not in 1.2.0.0/24 
```

我应该从头开始编写它，还是有一些我可以使用的好库？或者整个功能是否已经编写并在公共领域？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T05:29:05.267

伪代码，以dustin的回答为基础：

```
addr_one = ip_addr_to_integer(ip);
addr_two = ip_addr_to_integer(network);
mask = ((1 << (32-slash)) - 1) ^ 0xFFFFFFFF;
return (((addr_one ^ addr_two) & mask) == 0); 
```

如果您知道 IP 地址字符串是有效的，您可能可以使用 string.split('.') 来获取四个八位字节并轻松地将它们转换为整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T05:17:40.390

继续学习吧。:)

诀窍是将 '1.2.3.4' 解析为单个整数（ (1 << 24 | 2 << 16 | 3 << 8 | 4) == 16909060），然后将 '1.2.0.0' 解析为整数 (16908288 ) 然后将掩码作为来自 msb 的 1 位的数量作为整数（16 位 == 4294901760），然后将掩码按位应用到原始地址（（16909060 和 4294901760）== 16908288），如果掩码地址==网络地址，那么它在网络中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-18T21:02:32.023

```
addr_one = ip_addr_to_integer(ip >> (32 - slash));
addr_two = ip_addr_to_integer(network >> (32 - slash));
return (addr_one == addr_two); 
```

位运算符停止使用 32 位。

# cocoa-touch - 在导航栏中添加第一个和最后一个按钮

> ID：402345
> 
> 赞同：0
> 
> 时间：2008-12-31T05:10:50.653
> 
> 标签：cocoa-touch

这就是我想要实现的目标：

主页（表视图）>（单击行）> 移至第二个视图（表视图）>（单击行）> 移至第三个视图（表视图）-导航栏中的“保存”或“完成”按钮应将用户带到主页（表视图）。

示例代码将非常有帮助。

谢谢

* * *

穆斯塔法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T05:38:55.217

请阅读 Apple 的人机界面指南。此行为被特别指出为不应该做的一个例子。

允许用户一次前进和后退一个屏幕。不应该有类似面包屑的控制。

# javascript - 使用 javascript 或其他方式在不同的域上设置 cookie

> ID：402348
> 
> 赞同：22
> 
> 时间：2008-12-31T05:13:36.890
> 
> 标签：javascript, dns, cookies

无法在网上找到任何特别针对这种情况的信息，所以我开始...我需要在浏览“second.com”时设置/获取存储在“first.com”中的 cookie，我可以完全访问“first.com” .com”，但我在“second.com”上只有 javascript 访问权限（可以根据需要操作 DOM）。

我的第一种方法是在 second.com（带有 js）上创建一个 iframe，它加载了一个像“first.com/doAjax?setCookie=xxx”这样的页面，并且执行了一个 ajax 调用来说“first.com/setCookie?cookieData=xxx” " 这将使用我们传递的数据在 "first.com" 上设置 cookie。

这对于从 second.com 在 first.com 上设置 cookie 非常有效 - 为了获取 cookie，我基本上遵循相同的过程，创建了加载“first.com/doAjax?getCookie”的 iframe，并且会执行 ajax 调用说“first.com/getCookie”，它将读取 first.com 上的 cookie 信息并将其作为 JSON 对象返回。

问题是我无法将该 JSON cookie 对象带回“second.com”，因此我可以阅读它，也许我可以在使用“window.top”完成 Ajax 调用时将其带回，但存在时间问题因为它与加载 iframe 的时间无关。我希望我很清楚，想知道是否有更简单的解决方案，而不是这种疯狂的 iframe->ajax 废话，似乎这甚至不适用于在 SAFARI 中获取 cookie。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T05:20:53.753

您可以使用回调将脚本元素注入文档的 HEAD，该回调将您需要的 cookie 传递给任何需要它的函数。

就像是：

```
 <script type="text/javascript">
   var newfile=document.createElement('script');
   newfile.setAttribute("type","text/javascript");
   newfile.setAttribute("src", 'http://first.com/doAjax?getCookie&callback=passCookie');
   document.getElementsByTagName("head")[0].appendChild(newfile);
 </script> 
```

页面 first.com/doAjax?getCookie 可以这样做：

```
 passCookie({'name':'mycookie', 'value':'myvalue'}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T08:39:43.727

将此 PHP 文件放入 first.com：

```
//readcookie.php    
echo $_COOKIE['cookiename']; 
```

在 second.com 上，您可以使用此 javascript 来获取值：

```
function readCookieCallback()
{
   if ((this.readyState == 4) && (this.status == 200))
   {
     alert("the value of the cookie is: "+this.responseText);
   } 
   else if ((this.readyState == 4) && (this.status != 200))
   {
     //error...
   }
}

function buttonClickOrAnything()
{
  var refreshObject = new XMLHttpRequest();
  if (!refreshObject)
  {
    //IE6 or older
    try
    {
      refreshObject = new ActiveXObject("Msxml2.XMLHTTP");
    }
    catch (e)
    {
      try
      {
        refreshObject = new ActiveXObject("Microsoft.XMLHTTP");
      }
      catch (e)
      {
        return;
      }
    }
  }
  refreshObject.onreadystatechange = readCookieCallback;
  refreshObject.open("GET", "http://www.first.com/readcookie.php");
  refreshObject.send();
} 
```

问候，罗伯特

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-04T09:03:13.310

对于设置 cookie，您可以按如下方式更改我的脚本：

新的 PHP 脚本：

```
//writecookie.php
setcookie($_GET['c'], $_GET['v']); 
```

和 JavaScript：

```
function buttonClickOrAnything()
{
  var refreshObject = new XMLHttpRequest();
  if (!refreshObject)
  {
    //IE6 or older
    try
    {
      refreshObject = new ActiveXObject("Msxml2.XMLHTTP");
    }
    catch (e)
    {
      try
      {
        refreshObject = new ActiveXObject("Microsoft.XMLHTTP");
      }
      catch (e)
      {
        return;
      }
    }
  }
  refreshObject.open("GET", "http://www.first.com/writecookie.php?c=cookiename&v=cookievalue");
  refreshObject.send();
} 
```

这应该适用于所有浏览器。

# c# - 使用 Visual C# 连接到远程 MySQL 数据库

> ID：402355
> 
> 赞同：3
> 
> 时间：2008-12-31T05:21:01.587
> 
> 标签：c#, .net, mysql

我正在尝试使用 Visual C# 2008 Express Edition 连接到远程 MySQL 数据库。有没有办法使用编辑器进行连接，还是我必须手动编写连接代码？该编辑器有一个清晰且易于遵循的向导，用于连接到 Microsoft SQL Server 和 Access 数据库，但我没有看到添加远程 MySQL 数据源的简单方法。我尝试搜索帮助，但找不到任何有用的东西。

有人用编辑器做过吗？或者可以为我指出一个有用的方向？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-31T10:55:08.230

您必须手动编写连接代码才能使用 Visual C# 2008 Express Edition 连接到远程 MySQL 数据库。

VS 2008 Express（以及 VS 2005 Express）不允许您通过数据源对话框使用 MySQL .Net Provider。非 Express 版本允许您执行相同操作。

要在 VS Express 中使用 MySQL，您必须包含对 MySQL DLL 的引用。如果您已安装 MySQL .Net Provider，则 DLL 将位于 C:\Program Files\MySQL\MySQL Connector Net xxx)。或者将 DLL 复制到项目的 Bin 文件夹中。包含 DLL 后，您可以创建 ConnectionString 以连接到远程 MySQL 数据库。

MySQL .Net Provider 可以在[这里找到](http://dev.mysql.com/downloads/connector/net/5.2.html)

[在这里的线程 396593](https://stackoverflow.com/questions/396593/mysql-net-provider-5-2-does-not-show-up-in-data-source-dialog-of-vs-2008-express)中提出了类似的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T12:43:41.410

**编辑：**我在发布之前没有检查 Rishi Agarwal 的答案。我认为他的回答对特快版有更多的见解

我不确定这个和速成版，但你应该试试[MySQL Connector/Net](http://dev.mysql.com/downloads/connector/net/5.2.html)。它适用于我的 VS2008 Pro。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T11:07:20.683

“express”（甚至只是“csc”）的好处在于，即使它没有设计器来帮助处理某些事情（比如设置到大多数有用数据库的连接字符串），核心框架也不受限制. 因此，您可能必须自己输入连接字符串并添加对 MySQL/.NET 提供程序的引用，但它应该在运行时工作，即使在调试中也是如此。

这是非常好的;-p

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T00:21:15.377

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data.MySqlClient;
namespace ConsoleApplication1
{
    class Program

    {

        static void Main(string[] args)
        {
            Console.WriteLine("Welcome ...!");
            String conString = "SERVER = localhost; DATABASE = l2emu; User ID = root; PASSWORD = password;";

        MySqlConnection  connection = new MySqlConnection(conString);

            String command = "SELECT * FROM characters";
          MySqlCommand  cmd = new MySqlCommand(command,connection);
MySqlDataReader reader;
try
{
    connection.Open();
    cmd.ExecuteNonQuery();
    reader = cmd.ExecuteReader();
    cmd.CommandType = System.Data.CommandType.Text;
    while (reader.Read() != false)
    {

        Console.WriteLine(reader["char_name"]);
        Console.WriteLine(reader["level"]);

    }

    Console.ReadLine();

}
catch (MySqlException MySqlError)
{
    Console.WriteLine(MySqlError.Message);
}

        }
    }
} 
```

这是示例，但您必须下载[mysql 连接器](http://www.mysql.com/downloads/connector/net/)，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-09T09:52:17.567

现在你可以使用实体到 mysql [http://www.codeproject.com/Tips/426790/Using-MySQL-with-Entity-Framework](http://www.codeproject.com/Tips/426790/Using-MySQL-with-Entity-Framework)

# windows-vista - Vista上的锁定串行端口

> ID：402356
> 
> 赞同：2
> 
> 时间：2008-12-31T05:22:04.140
> 
> 标签：windows-vista, serial-port, bluetooth

我正在开发一个与串行端口对话的应用程序，在我的开发机器上，我正在运行 Vista，并且该串行端口是蓝牙连接。有时，串行端口会陷入我的应用程序无法再连接到它的状态。在 .net 中，我收到一条 IOException，其中显示一条消息“未找到元素”。

我尝试重新启动应用程序，连接其他应用程序（如 HyperTerm 之类的通信客户端），但没有任何帮助。我找不到任何更具体的错误消息，并且没有任何内容记录到机器的事件日志中。设备管理器告诉我端口“工作正常”。

有没有办法找出哪个进程和/或 .dll 拥有串行端口，和/或强制关闭端口？

如果有什么不同的话，我的 App 是用 C# 编写的，但是在结构上，使用“using”语句打开和关闭端口并不方便。

谢谢，安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T10:06:48.187

据我所知，您无法关闭没有句柄的串行端口。我对蓝牙串行端口的体验是，它们最终会在连接时映射到不同的 COM 端口号，有时在断开连接时会留下虚假的 COM 端口。例如，我目前没有连接蓝牙设备，但是如果我进入设备管理器，我看到总共有 11 个 COM 端口被列为*蓝牙串行端口* 每个端口上的属性都显示设备工作且可用，我可以尽管我偶尔会出现故障，但通常会打开这些端口。*我的解决方法是通过属性/高级/COM端口号*强制连接设备的COM端口号*. 我不确定问题是否与驱动程序相关（在这种情况下为 IVT corp）或 Windows 管理蓝牙串行端口的方式有问题。*

 *抱歉，我无法提供更多帮助。

# python - 如何卸载使用 distutils 安装的 python 包？

> ID：402359
> 
> 赞同：95
> 
> 时间：2008-12-31T05:26:14.913
> 
> 标签：python

你可以简单地从你的 python 安装中删除目录，还是有任何你必须删除的挥之不去的文件？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-12-31T07:00:04.803

它根据您传递给的选项以及系统/包中的[distutils 配置文件](http://docs.python.org/install/index.html#inst-config-files)`install`的内容而有所不同。我不相信在以这些方式指定的目录之外修改任何文件。

值得注意[的是， distutils 目前没有卸载命令](http://bugs.python.org/issue4673)。

同样值得注意的是，删除一个包/鸡蛋可能会导致依赖问题——诸如[`easy_install`](http://peak.telecommunity.com/DevCenter/EasyInstall)试图缓解此类问题的实用程序。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-31T17:31:17.273

您需要删除的安装的三件事是：

1.  包/模块
2.  脚本
3.  数据文件

现在在我的 linux 系统上，这些存在于：

1.  /usr/lib/python2.5/site-packages
2.  /usr/bin
3.  /usr/共享

但在 Windows 系统上，它们更有可能完全位于 Python 分发目录中。我不知道 OSX，除了它更喜欢遵循 ​​linux 模式。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-12-12T07:27:00.357

另一个基于时间戳的黑客：

1.  创建锚点：`touch /tmp/ts`
2.  重新安装要删除的包：`python setup.py install --prefix=<PREFIX>`
3.  删除比锚文件更新的文件：`find <PREFIX> -cnewer /tmp/ts | xargs rm -r`

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-01T20:06:35.417

是的，简单地删除 distutils 安装的任何东西是安全的。这适用于已安装的文件夹或 .egg 文件。自然，任何依赖于该代码的东西都将不再起作用。

如果您想让它再次工作，只需重新安装即可。

顺便说一句，如果您使用 distutils 还可以考虑使用多版本功能。它允许您安装任何单个软件包的多个版本。这意味着如果您只想安装较新版本的软件包，则无需删除旧版本的软件包。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-07-31T21:24:50.107

在 ubuntu 12.04 中，我发现默认情况下您需要查看的唯一位置是

```
/usr/local/lib/python2.7/ 
```

如果有的话，只需删除相关的文件夹和文件！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-31T17:24:59.440

如果这是出于测试和/或开发目的，[setuptools](http://peak.telecommunity.com/DevCenter/setuptools)有一个[开发](http://peak.telecommunity.com/DevCenter/setuptools#develop-deploy-the-project-source-in-development-mode)命令，每次您进行更改时都会更新（因此您不必每次进行更改时都卸载并重新安装）。您也可以使用此命令卸载软件包。

如果您确实使用它，那么您声明为*脚本*的任何内容都将作为延迟文件留下。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-04-27T07:03:50.353

**`install --record`+`xargs rm`**

```
sudo python setup.py install --record files.txt
xargs sudo rm -rf < files.txt 
```

删除所有文件，但留下空目录。

那并不理想，应该足以避免包冲突。

然后，如果您愿意，可以通过阅读手动完成工作`files.txt`，或者更勇敢地自动删除空目录。

一个安全的助手将是：

```
python-setup-uninstall() (
  sudo rm -f files.txt
  sudo python setup.py install --record files.txt && \
  xargs rm -rf < files.txt
  sudo rm -f files.txt
) 
```

在 Python 2.7.6、Ubuntu 14.04 中测试。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-05-27T13:05:57.043

对于 Windows 中的 Python：

```
python -m pip uninstall "package_keyword"
uninstall **** (y/n)? 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-12-24T03:50:18.807

对于 Windows 7，

**控制面板 --> 程序 --> 卸载**

， 然后

选择要删除的 python 包。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-30T00:12:08.063

我刚刚卸载了一个 python 包，尽管我*不确定*我做得是否完美，但我相当有信心。

我首先获取*所有*与 python 相关的文件的列表，按日期排序，假设我的包中的所有文件都或多或少具有相同的时间戳，并且没有其他文件会有。

幸运的是，我在下面安装了 python `/opt/Python-2.6.1`；如果我一直在使用我的 Linux 发行版附带的 Python，我将不得不搜索所有的 . `/usr`，这将花费很长时间。

然后我只是检查了该列表，并欣慰地注意到我想要核对的所有内容都包含一个目录 .`/opt/Python-2.6.1/lib/python2.6/site-packages/module-name/`和一个文件`/opt/Python-2.6.1/lib/python2.6/site-packages/module-x.x.x_blah-py2.6.egg-info`.

所以我只是删除了那些。

这是我获得按日期排序的文件列表的方法：

`find "$@" -printf '%T@ ' -ls | sort -n | cut -d\ -f 2-`

（顺便说一句，我认为那必须是 GNU 的“查找”；您在 OS X 上获得的风味并不知道“-printf '%T@'”）

我*一直*在使用它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-06-25T19:53:34.580

在 Mac OSX 上，手动删除***pathToPython/site-packages/***下的这两个目录将起作用：

*   {包裹名字}
*   {packageName}-{版本}-信息

例如，要删除***pyasn1***，这是一个 distutils 安装的项目：

*   rm -rf lib/python2.7/site-packages/pyasn1
*   rm -rf lib/python2.7/site-packages/pyasn1-0.1.9-py2.7.egg-info

要找出您的站点包在哪里：

```
python -m site 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-05-12T11:10:41.947

`ERROR: flake8 3.7.9 has requirement pycodestyle<2.6.0,>=2.5.0, but you'll have pycodestyle 2.3.1 which is incompatible. ERROR: nuscenes-devkit 1.0.8 has requirement motmetrics<=1.1.3, but you'll have motmetrics 1.2.0 which is incompatible. Installing collected packages: descartes, future, torch, cachetools, torchvision, flake8-import-order, xmltodict, entrypoints, flake8, motmetrics, nuscenes-devkit Attempting uninstall: torch Found existing installation: torch 1.0.0 Uninstalling torch-1.0.0: Successfully uninstalled torch-1.0.0 Attempting uninstall: torchvision Found existing installation: torchvision 0.2.1 Uninstalling torchvision-0.2.1: Successfully uninstalled torchvision-0.2.1 Attempting uninstall: entrypoints Found existing installation: entrypoints 0.2.3 ERROR: Cannot uninstall 'entrypoints'. It is a distutils installed project and thus we cannot accurately determine which files belong to it which would lead to only a partial uninstall.`

然后我输入：

`conda uninstall entrypoints pip install --upgrade pycodestyle pip install nuscenes-devkit`

完毕！

# python - 帮助--Python中的函数指针

> ID：402364
> 
> 赞同：3
> 
> 时间：2008-12-31T05:34:38.827
> 
> 标签：python, function, pointers

我对程序的想法：

我有一本字典：

```
options = { 'string' : select_fun(function pointer),
'float' : select_fun(function pointer),
'double' : select_fun(function pointer)
} 
```

任何类型的单个函数`select_fun(function pointer)`都会被调用。在里面`select_fun(function pointer)`，我将有浮点、双精度等的差异函数。

根据函数指针，将调用指定的函数。

我不知道我的编程知识是好是坏，我仍然需要帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-31T05:41:07.490

您能否更具体地说明您要做什么？你不需要做任何特别的事情来获取 Python 中的函数指针——你可以像普通对象一样传递函数：

```
def plus_1(x):
    return x + 1

def minus_1(x):
    return x - 1

func_map = {'+' : plus_1, '-' : minus_1}

func_map['+'](3)  # returns plus_1(3) ==> 4
func_map['-'](3)  # returns minus_1(3) ==> 2 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-31T05:51:29.917

您可以使用[`type()`内置函数](http://diveintopython.net/power_of_introspection/built_in_functions.html#d0e8510)来检测函数的类型。

比如说，如果你想检查某个名称是否包含字符串数据，你可以这样做：

```
if type(this_is_string) == type('some random string'):
    # this_is_string is indeed a string 
```

所以在你的情况下，你可以这样做：

```
options = { 'some string'     : string_function,
            (float)(123.456)  : float_function,
            (int)(123)        : int_function
          }

def call_option(arg):

    # loop through the dictionary
    for (k, v) in options.iteritems():

        # if found matching type...
        if type(k) == type(arg):

            # call the matching function
            func = option[k]
            func(arg) 
```

然后你可以像这样使用它：

```
call_option('123')       # string_function gets called
call_option(123.456)     # float_function gets called
call_option(123)         # int_function gets called 
```

我附近没有 python 解释器，我也没有太多用 Python 编程，所以可能会有一些错误，但你应该明白这一点。

* * *

**编辑：**根据@Adam 的建议，您可以直接检查内置类型常量，因此更好的方法是：

```
from types import *

options = { types.StringType  : string_function,
            types.FloatType   : float_function,
            types.IntType     : int_function,
            types.LongType    : long_function
          }

def call_option(arg):
    for (k, v) in options.iteritems():

        # check if arg is of type k
        if type(arg) == k:

            # call the matching function
            func  = options[k]
            func(arg) 
```

而且由于键本身与 type() 函数的值相当，因此您可以这样做：

```
def call_option(arg):
    func = options[type(arg)]
    func(arg) 
```

哪个更优雅:-) 保存一些错误检查。

* * *

**编辑：**对于 ctypes 支持，经过一番摆弄，我发现 ctypes.[type_name_here] 实际上是作为类实现的。所以这个方法仍然有效，你只需要使用 ctypes.c_xxx 类型的类。

```
options = { ctypes.c_long     : c_long_processor,
            ctypes.c_ulong    : c_unsigned_long_processor,
            types.StringType  : python_string_procssor
          }

call_option = lambda x: options[type(x)](x) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T07:46:22.463

看你的例子，在我看来是一些 C 程序，直接翻译成 Python。

出于这个原因，我认为可能存在一些设计问题，因为通常，在 Python 中，您不关心对象的类型，而只关心您可以发送给它的消息。

当然，这种方法有很多例外，但在这种情况下，我仍然会尝试封装一些多态性；例如。

```
class StringSomething(object):
  data = None
  def data_function(self):
     string_function_pointer(self.data)

class FloatSomething(object):
  data = None
  def data_function(self):
     float_function_pointer(self.data) 
```

等等

同样，所有这些都假设您正在从程序语言翻译成 python；如果不是这样，请放弃我的答案:-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-31T06:08:04.313

函数是 Python 中的第一类对象，因此您可以将它们作为参数传递给其他函数，就像使用任何其他对象（例如字符串或整数）一样。

Python 中没有单精度浮点类型。Python`float`对应于 C 的`double`.

```
def process(anobject):
    if isinstance(anobject, basestring):
       # anobject is a string
       fun = process_string
    elif isinstance(anobject, (float, int, long, complex)):
       # anobject is a number
       fun = process_number
    else:
       raise TypeError("expected string or number but received: '%s'" % (
           type(anobject),))
    return fun(anobject) 
```

有[`functools.singledispatch`](https://docs.python.org/3/library/functools.html#functools.singledispatch)允许创建一个通用函数：

```
from functools import singledispatch
from numbers import Number

@singledispatch
def process(anobject): # default implementation
    raise TypeError("'%s' type is not supported" % type(anobject))

@process.register(str)
def _(anobject):
   # handle strings here
   return process_string(anobject)

process.register(Number)(process_number) # use existing function for numbers 
```

在 Python 2 上，类似的功能可用作`pkgutil.simplegeneric()`.

下面是一些使用泛型函数的代码示例：

*   [从 JSON 文件中删除空格和换行符](https://stackoverflow.com/q/17098553/4279)
*   [使 my_average(a, b) 与定义了 f_add 和 d_div 的任何 a 和 b 一起工作。以及内置](https://stackoverflow.com/q/23550870/4279)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-31T06:03:51.233

也许您想`select_fun()`每次都调用相同的参数，但参数不同。如果这就是你的意思，你需要一个不同的字典：

```
>>> options = {'string' : str, 'float' : float, 'double' : float }
>>> options
{'double': <type 'float'>, 'float': <type 'float'>, 'string': <type 'str'>}
>>> def call_option(val, func):
...     return func(val)
... 
>>> call_option('555',options['float'])
555.0
>>> 
```

# sql-server - 外键

> ID：402375
> 
> 赞同：1
> 
> 时间：2008-12-31T05:47:18.443
> 
> 标签：sql-server

有人可以请让我知道删除外键引用的表的最佳方法。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T07:17:42.223

预期目标是孤立这些记录并且不再使用外键吗？如果是这样的话，前面提到的关于禁用键的方法很好，否则你可能想要删除引用你想首先删除的表的记录（或者更新指向更合适的记录，或者 NULL 如果这有意义的话案子）。我似乎是从与其他人不同的方向来的，你确定外键是没有意义的，如果是这样，为什么不直接删除它？在某些时候，有人想要约束这种行为，在禁用约束之前，我确保我了解它们的目的并有充分的理由绕过这些保护措施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T14:38:27.030

不要在不考虑对外键表的影响的情况下删除具有外键约束的表。让我用一个例子来解释一下简单地删除外键然后删除表的影响。

考虑两个表——parts 和 orderdetails。有一个外键约束表示一个部件必须存在才能放入 orderdetails 表中。orderdetail 表中存储的是部件表中部件的 id，而不是部件名称或描述。假设您删除了外键，然后删除了部件表。现在 orderdetail 表中的所有数据完全没有用，因为您无法知道订购的零件是什么。这将包括尚未发货的订单和客户可能会打电话询问的订单。此外，您现在无法重新创建该数据，除非恢复备份（希望您有备份）。

进一步假设您要删除表并重新创建它以对表进行更改。然后重新加载信息并重新打开外键。在这种情况下，您可能应该使用 alter table 而不是 drop 和 recreate，但如果不这样做，您最终可能会得到与原来不同的 id 编号，因此现在订单将引用错误的 id。这可以安全地完成，但是您必须非常小心地进行操作，并且对后果进行很多思考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T05:50:30.637

删除外键约束，一旦没有人被强制识别，就删除表。如果第二个表中的列（未被删除的列）没有在其他地方使用，那么您可能应该在删除约束后删除整个列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T06:04:41.793

您需要先删除约束，然后才能删除它引用的表。SQL Server 使用以下语法：

```
ALTER TABLE <table_name> DROP FOREIGN KEY <foreignkey_name> 
```

请记住，约束存在于**引用**您要删除的表的表上，因此您应该更改该表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T07:23:39.170

通过使用 On Delete Cascade

# bash - 使用 getopts 处理长短命令行选项

> ID：402377
> 
> 赞同：463
> 
> 时间：2008-12-31T05:49:05.397
> 
> 标签：bash, command-line-arguments, getopt, getopts

我希望使用我的 shell 脚本调用长短形式的命令行选项。

我知道`getopts`可以使用，但就像在 Perl 中一样，我无法使用 shell 做同样的事情。

关于如何做到这一点的任何想法，以便我可以使用以下选项：

```
./shell.sh --copyfile abc.pl /tmp/
./shell.sh -c abc.pl /tmp/ 
```

在上面，这两个命令对我的 shell 意味着同样的事情，但是使用`getopts`，我无法实现这些？

* * *

## 回答 #1

> 赞同：357
> 
> 时间：2011-10-30T23:01:28.977

`getopt`而且`getopts`是不同的野兽，人们似乎对他们的所作所为有点误解。 `getopts`是一个内置命令，`bash`用于在循环中处理命令行选项并将找到的每个选项和值依次分配给内置变量，以便您可以进一步处理它们。 `getopt`但是，它是一个外部实用程序，它实际上并不像bash 、Perl模块或 Python /模块那样*为您处理选项。*所做的只是规范化传入的选项——即将它们转换为更标准的形式，以便 shell 脚本更容易处理它们。例如，应用程序可能会转换以下内容：`getopts``Getopt``optparse``argparse``getopt``getopt`

```
myscript -ab infile.txt -ooutfile.txt 
```

进入这个：

```
myscript -a -b -o outfile.txt infile.txt 
```

您必须自己进行实际处理。`getopt`如果您对指定选项的方式进行各种限制，则根本不必使用：

*   每个参数只放一个选项；
*   所有选项都在任何位置参数之前（即非选项参数）；
*   对于具有值的选项（例如`-o`上面），该值必须作为单独的参数（在空格之后）。

为什么使用`getopt`而不是`getopts`？基本原因是只有 GNU`getopt`为您提供对长名称命令行选项的支持。¹（GNU`getopt`是 Linux 上的默认设置。Mac OS X 和 FreeBSD 带有一个基本且不太有用`getopt`的 GNU 版本，但可以安装；见下文。）

例如，这是一个使用 GNU 的示例`getopt`，来自我的一个名为 的脚本`javawrap`：

```
# NOTE: This requires GNU getopt.  On Mac OS X and FreeBSD, you have to install this
# separately; see below.
TEMP=$(getopt -o vdm: --long verbose,debug,memory:,debugfile:,minheap:,maxheap: \
              -n 'javawrap' -- "$@")

if [ $? != 0 ] ; then echo "Terminating..." >&2 ; exit 1 ; fi

# Note the quotes around '$TEMP': they are essential!
eval set -- "$TEMP"

VERBOSE=false
DEBUG=false
MEMORY=
DEBUGFILE=
JAVA_MISC_OPT=
while true; do
  case "$1" in
    -v | --verbose ) VERBOSE=true; shift ;;
    -d | --debug ) DEBUG=true; shift ;;
    -m | --memory ) MEMORY="$2"; shift 2 ;;
    --debugfile ) DEBUGFILE="$2"; shift 2 ;;
    --minheap )
      JAVA_MISC_OPT="$JAVA_MISC_OPT -XX:MinHeapFreeRatio=$2"; shift 2 ;;
    --maxheap )
      JAVA_MISC_OPT="$JAVA_MISC_OPT -XX:MaxHeapFreeRatio=$2"; shift 2 ;;
    -- ) shift; break ;;
    * ) break ;;
  esac
done 
```

这使您可以指定类似`--verbose -dm4096 --minh=20 --maxhe 40 --debugfi="/Users/John Johnson/debug.txt"`或类似的选项。调用 to 的效果`getopt`是规范化选项，`--verbose -d -m 4096 --minheap 20 --maxheap 40 --debugfile "/Users/John Johnson/debug.txt"`以便您可以更轻松地处理它们。引用`"$1"`and`"$2"`很重要，因为它可以确保正确处理带有空格的参数。

如果您删除前 9 行（从该`eval set`行开始的所有内容），代码*仍然可以工作*！但是，您的代码在接受什么样的选项时会更加挑剔：特别是，您必须以上述“规范”形式指定所有选项。但是，通过使用`getopt`，您可以对单字母选项进行分组，使用更短的非歧义形式的长选项，使用`--file foo.txt`or`--file=foo.txt`样式，使用`-m 4096`or`-m4096`样式，以任意顺序混合选项和非选项等。 `getopt`如果发现无法识别或模棱两可的选项，也会输出错误消息。

*注意*：实际上有两个*完全不同*的版本`getopt`，basic`getopt`和 GNU `getopt`，具有不同的功能和不同的调用约定。² Basic`getopt`非常糟糕：它不仅不能处理长选项，甚至不能处理参数或空参数中的嵌入空格，而`getopts`它确实做到了这一点。上面的代码在 basic 中不起作用`getopt`。GNU`getopt`默认安装在 Linux 上，但在 Mac OS X 和 FreeBSD 上需要单独安装。在 Mac OS X 上，安装 MacPorts ( [http://www.macports.org](http://www.macports.org) ) 然后`sudo port install getopt`安装 GNU `getopt`(通常安装到`/opt/local/bin`)，并确保它`/opt/local/bin`在你的 shell 路径中`/usr/bin`. 在 FreeBSD 上，安装`misc/getopt`.

为您自己的程序修改示例代码的快速指南：在前几行中，除了调用`getopt`. 您应该在之后更改程序名称，在之后`-n`指定短选项`-o`，在之后指定长选项`--long`。在取值的选项后面加一个冒号。

最后，如果您看到的代码只是`set`代替`eval set`，它是为 BSD 编写的`getopt`。您应该将其更改为使用该`eval set`样式，该样式适用于 . 的两个版本`getopt`，而普通版`set`不适用于 GNU `getopt`。

¹实际上，`getopts`in`ksh93`支持长名称的选项，但是这个 shell 不像`bash`. 在`zsh`中，用于`zparseopts`获取此功能。

²从技术上讲，“GNU `getopt`”是用词不当；这个版本实际上是为 Linux 而不是 GNU 项目编写的。但是，它遵循所有 GNU 约定，并且`getopt`通常使用术语“GNU”（例如在 FreeBSD 上）。

* * *

## 回答 #2

> 赞同：332
> 
> 时间：2008-12-31T06:27:41.217

可以考虑三种实现方式：

*   bash 内置`getopts`。这不支持带有双破折号前缀的长选项名称。它仅支持单字符选项。

*   独立命令的 BSD UNIX 实现`getopt`（这是 MacOS 使用的）。这也不支持长选项。

*   独立的 GNU 实现`getopt`。GNU [`getopt(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/getopt.3.html)（由 Linux 上的命令行[`getopt(1)`](https://linux.die.net/man/1/getopt)使用）支持解析长选项。

* * *

其他一些答案显示了使用 bash 内置`getopts`模拟长选项的解决方案。该解决方案实际上是一个简短的选项，其字符为“-”。所以你得到“--”作为标志。然后后面的任何内容都变为 OPTARG，然后您使用嵌套的`case`.

这很聪明，但有一些警告：

*   `getopts`无法强制执行 opt 规范。如果用户提供了一个无效的选项，它就不能返回错误。在解析 OPTARG 时，您必须自己进行错误检查。
*   OPTARG 用于长选项名称，当您的长选项本身有参数时，这会使使用变得复杂。您最终不得不自己编写代码作为附加案例。

因此，虽然可以编写更多代码来解决对长选项缺乏支持的问题，但这需要更多的工作，并且部分违背了使用 getopt 解析器来简化代码的目的。

* * *

## 回答 #3

> 赞同：230
> 
> 时间：2011-10-06T21:29:39.997

Bash 内置的 getopts 函数可用于解析长选项，方法是在 optspec 中放置一个破折号，后跟一个冒号：

```
#!/usr/bin/env bash 
optspec=":hv-:"
while getopts "$optspec" optchar; do
    case "${optchar}" in
        -)
            case "${OPTARG}" in
                loglevel)
                    val="${!OPTIND}"; OPTIND=$(( $OPTIND + 1 ))
                    echo "Parsing option: '--${OPTARG}', value: '${val}'" >&2;
                    ;;
                loglevel=*)
                    val=${OPTARG#*=}
                    opt=${OPTARG%=$val}
                    echo "Parsing option: '--${opt}', value: '${val}'" >&2
                    ;;
                *)
                    if [ "$OPTERR" = 1 ] && [ "${optspec:0:1}" != ":" ]; then
                        echo "Unknown option --${OPTARG}" >&2
                    fi
                    ;;
            esac;;
        h)
            echo "usage: $0 [-v] [--loglevel[=]<value>]" >&2
            exit 2
            ;;
        v)
            echo "Parsing option: '-${optchar}'" >&2
            ;;
        *)
            if [ "$OPTERR" != 1 ] || [ "${optspec:0:1}" = ":" ]; then
                echo "Non-option argument: '-${OPTARG}'" >&2
            fi
            ;;
    esac
done 
```

复制到[当前工作目录](https://en.wikipedia.org/wiki/Working_directory)`getopts_test.sh`中的可执行文件 name= 后，可以产生如下输出

```
$ ./getopts_test.sh
$ ./getopts_test.sh -f
Non-option argument: '-f'
$ ./getopts_test.sh -h
usage: code/getopts_test.sh [-v] [--loglevel[=]<value>]
$ ./getopts_test.sh --help
$ ./getopts_test.sh -v
Parsing option: '-v'
$ ./getopts_test.sh --very-bad
$ ./getopts_test.sh --loglevel
Parsing option: '--loglevel', value: ''
$ ./getopts_test.sh --loglevel 11
Parsing option: '--loglevel', value: '11'
$ ./getopts_test.sh --loglevel=11
Parsing option: '--loglevel', value: '11' 
```

显然 getopts 既不`OPTERR`对长选项执行检查也不执行选项参数解析。上面的脚本片段显示了如何手动完成。基本原理也适用于 Debian Almquist shell（“dash”）。注意特殊情况：

```
getopts -- "-:"  ## without the option terminator "-- " bash complains about "-:"
getopts "-:"     ## this works in the Debian Almquist shell ("dash") 
```

请注意，正如来自[http://mywiki.wooledge.org/BashFAQ](http://mywiki.wooledge.org/BashFAQ)的 GreyCat指出的那样，这个技巧利用了允许选项参数的 shell 的非标准行为（即“-f 文件名”中的文件名）连接到选项（如“-ffilename”中）。[POSIX](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/getopts.html)标准规定它们之间必须有一个空格，在“--longoption”的情况下，它将终止选项解析并将所有 longoptions 转换为非选项参数。

* * *

## 回答 #4

> 赞同：148
> 
> 时间：2008-12-31T06:28:57.283

内置`getopts`命令仍然是 AFAIK，仅限于单字符选项。

有（或曾经有）一个外部程序`getopt`可以重新组织一组选项，以便更容易解析。您也可以调整该设计以处理长选项。示例用法：

```
aflag=no
bflag=no
flist=""
set -- $(getopt abf: "$@")
while [ $# -gt 0 ]
do
    case "$1" in
    (-a) aflag=yes;;
    (-b) bflag=yes;;
    (-f) flist="$flist $2"; shift;;
    (--) shift; break;;
    (-*) echo "$0: error - unrecognized option $1" 1>&2; exit 1;;
    (*)  break;;
    esac
    shift
done

# Process remaining non-option arguments
... 
```

您可以对命令使用类似的方案`getoptlong`。

请注意，外部`getopt`程序的根本弱点是难以处理带有空格的参数，并且难以准确地保留这些空格。这就是为什么内置`getopts`是优越的，尽管受限于它只处理单字母选项。

* * *

## 回答 #5

> 赞同：95
> 
> 时间：2015-02-11T23:02:33.723

长选项可以被标准`getopts`内置解析为`-`“选项”的“参数”</p>

**这是可移植的原生 POSIX shell——不需要外部程序或 bashism。**

本指南将长选项实现为选项的参数`-`，因此`--alpha`被视为`getopts`with `-`argument`alpha`并被`--bravo=foo`视为`-`with argument `bravo=foo`。真正的论点可以通过一个简单的替换来获得：`${OPTARG#*=}`.

在此示例中，`-b`and `-c`（及其长格式`--bravo`和`--charlie`）具有强制性参数。长选项的参数出现在等号之后，例如`--bravo=foo`（长选项的空格分隔符很难实现，见下文）。

因为这使用了[`getopts`builtin](https://pubs.opengroup.org/onlinepubs/9699919799/utilities/getopts.html "（POSIX 不要求它是内置的，但大多数（全部？）现代 shell 将它作为一个实现）")，所以这个解决方案支持像这样的用法`cmd --bravo=foo -ac FILE`（它结合了选项`-a`并将`-c`长选项与标准选项交错），而这里的大多数其他答案要么挣扎要么失败。

```
die() { echo "$*" >&2; exit 2; }  # complain to STDERR and exit with error
needs_arg() { if [ -z "$OPTARG" ]; then die "No arg for --$OPT option"; fi; }

while getopts ab:c:-: OPT; do
  # support long options: https://stackoverflow.com/a/28466267/519360
  if [ "$OPT" = "-" ]; then   # long option: reformulate OPT and OPTARG
    OPT="${OPTARG%%=*}"       # extract long option name
    OPTARG="${OPTARG#$OPT}"   # extract long option argument (may be empty)
    OPTARG="${OPTARG#=}"      # if long option argument, remove assigning `=`
  fi
  case "$OPT" in
    a | alpha )    alpha=true ;;
    b | bravo )    needs_arg; bravo="$OPTARG" ;;
    c | charlie )  needs_arg; charlie="$OPTARG" ;;
    ??* )          die "Illegal option --$OPT" ;;  # bad long option
    ? )            exit 2 ;;  # bad short option (error reported via getopts)
  esac
done
shift $((OPTIND-1)) # remove parsed options and args from $@ list 
```

选项是DASH（`-`）时，它是一个很长的选项。`getopts`会将实际的 long 选项解析为`$OPTARG`，例如`--bravo=foo`最初设置`OPT='-'`和`OPTARG='bravo=foo'`。该`if`节设置为第一个等号之前的`$OPT`内容（在我们的示例中），然后从开头删除它（在此步骤中产生，如果没有，则为空字符串）。最后，我们去掉参数的前导。此时，是短选项（一个字符）或长选项（2+ 个字符）。`$OPTARG``bravo``$OPTARG``=foo``=``=``$OPT`

然后`case`匹配短选项或长选项。对于短选项，`getopts`会自动抱怨选项和缺少参数，因此我们必须使用该函数手动复制这些选项，该函数在为空`needs_arg`时会致命地退出。`$OPTARG`该`??*`条件将匹配任何剩余的长选项（`?`匹配单个字符并`*`匹配零个或多个，因此`??*`匹配 2+ 个字符），允许我们在退出之前发出“非法选项”错误。

* * *

*小错误：*如果有人给出了一个无效的单字符长选项（而且它也不是一个短选项），这将退出并出现错误但没有消息。这是因为此实现假定它是一个简短的选项。您可以在 the 之前的长选项节中使用一个额外的变量来跟踪它，`case`然后在最终情况下对其进行测试，但我认为这太过分了。

*大写变量名：*通常，建议保留全大写变量以供系统使用。我保持`$OPT`全大写以使其与 一致`$OPTARG`，但这确实违反了该约定。我认为它适合，因为这是系统应该做的事情，而且应该是安全的；我还没有听说过使用这个变量名的任何标准。

*抱怨长选项的意外参数：*模仿`needs_arg`翻转测试来抱怨不期望的参数：

```
no_arg() { if [ -n "$OPTARG" ]; then die "No arg allowed for --$OPT option"; fi; } 
```

*要接受带有空格分隔参数的长选项：*`eval "ARG_B=\"\$$OPTIND\""`您可以使用（或使用 bash 的[间接扩展](https://unix.stackexchange.com/a/41293/87770), ）拉入下一个参数，`ARG_B="${!OPTIND}"`然后按照[此答案](https://stackoverflow.com/revisions/28466267/11)`$OPTIND`的旧版本中的说明递增，但它不可靠；假设参数超出其范围并且某些实现不适合手动操作.`getopts``$OPTIND`

* * *

## 回答 #6

> 赞同：79
> 
> 时间：2011-03-08T08:59:50.083

这是一个实际使用带有长选项的 getopt 的示例：

```
aflag=no
bflag=no
cargument=none

# options may be followed by one colon to indicate they have a required argument
if ! options=$(getopt -o abc: -l along,blong,clong: -- "$@")
then
    # something went wrong, getopt will put out an error message for us
    exit 1
fi

set -- $options

while [ $# -gt 0 ]
do
    case $1 in
    -a|--along) aflag="yes" ;;
    -b|--blong) bflag="yes" ;;
    # for options with required arguments, an additional shift is required
    -c|--clong) cargument="$2" ; shift;;
    (--) shift; break;;
    (-*) echo "$0: error - unrecognized option $1" 1>&2; exit 1;;
    (*) break;;
    esac
    shift
done 
```

* * *

## 回答 #7

> 赞同：38
> 
> 时间：2012-09-21T03:47:16.650

# `getopts`与短/长选项和参数一起使用

* * *

## 适用于所有组合，例如：

*   foob​​ar -f --bar
*   foob​​ar --foo -b
*   foob​​ar -bf --bar --foobar
*   foob​​ar -fbFBAshorty --bar -FB --arguments=longhorn
*   foob​​ar -fA "文字矮" -B --arguments="文字长角"
*   bash foobar -F --barfoo
*   sh foobar -B --foobar - ...
*   bash ./foobar -F --bar

* * *

## 此示例的一些声明

```
Options=$@
Optnum=$#
sfoo='no '
sbar='no '
sfoobar='no '
sbarfoo='no '
sarguments='no '
sARG=empty
lfoo='no '
lbar='no '
lfoobar='no '
lbarfoo='no '
larguments='no '
lARG=empty 
```

## Usage 函数的外观

```
function _usage() 
{
  ###### U S A G E : Help and ERROR ######
  cat <<EOF
   foobar $Options
  $*
          Usage: foobar <[options]>
          Options:
                  -b   --bar            Set bar to yes    ($foo)
                  -f   --foo            Set foo to yes    ($bart)
                  -h   --help           Show this message
                  -A   --arguments=...  Set arguments to yes ($arguments) AND get ARGUMENT ($ARG)
                  -B   --barfoo         Set barfoo to yes ($barfoo)
                  -F   --foobar         Set foobar to yes ($foobar)
EOF
}

[ $# = 0 ] && _usage "  >>>>>>>> no options given " 
```

## `getops`带有长/短标志以及长参数

```
while getopts ':bfh-A:BF' OPTION ; do
  case "$OPTION" in
    b  ) sbar=yes                       ;;
    f  ) sfoo=yes                       ;;
    h  ) _usage                         ;;   
    A  ) sarguments=yes;sARG="$OPTARG"  ;;
    B  ) sbarfoo=yes                    ;;
    F  ) sfoobar=yes                    ;;
    -  ) [ $OPTIND -ge 1 ] && optind=$(expr $OPTIND - 1 ) || optind=$OPTIND
         eval OPTION="\$$optind"
         OPTARG=$(echo $OPTION | cut -d'=' -f2)
         OPTION=$(echo $OPTION | cut -d'=' -f1)
         case $OPTION in
             --foo       ) lfoo=yes                       ;;
             --bar       ) lbar=yes                       ;;
             --foobar    ) lfoobar=yes                    ;;
             --barfoo    ) lbarfoo=yes                    ;;
             --help      ) _usage                         ;;
             --arguments ) larguments=yes;lARG="$OPTARG"  ;; 
             * )  _usage " Long: >>>>>>>> invalid options (long) " ;;
         esac
       OPTIND=1
       shift
      ;;
    ? )  _usage "Short: >>>>>>>> invalid options (short) "  ;;
  esac
done 
```

## 输出

```
##################################################################
echo "----------------------------------------------------------"
echo "RESULT short-foo      : $sfoo                                    long-foo      : $lfoo"
echo "RESULT short-bar      : $sbar                                    long-bar      : $lbar"
echo "RESULT short-foobar   : $sfoobar                                 long-foobar   : $lfoobar"
echo "RESULT short-barfoo   : $sbarfoo                                 long-barfoo   : $lbarfoo"
echo "RESULT short-arguments: $sarguments  with Argument = \"$sARG\"   long-arguments: $larguments and $lARG" 
```

* * *

# 将以上内容组合成一个有凝聚力的脚本

```
#!/bin/bash
# foobar: getopts with short and long options AND arguments

function _cleanup ()
{
  unset -f _usage _cleanup ; return 0
}

## Clear out nested functions on exit
trap _cleanup INT EXIT RETURN

###### some declarations for this example ######
Options=$@
Optnum=$#
sfoo='no '
sbar='no '
sfoobar='no '
sbarfoo='no '
sarguments='no '
sARG=empty
lfoo='no '
lbar='no '
lfoobar='no '
lbarfoo='no '
larguments='no '
lARG=empty

function _usage() 
{
  ###### U S A G E : Help and ERROR ######
  cat <<EOF
   foobar $Options
   $*
          Usage: foobar <[options]>
          Options:
                  -b   --bar            Set bar to yes    ($foo)
                    -f   --foo            Set foo to yes    ($bart)
                      -h   --help           Show this message
                  -A   --arguments=...  Set arguments to yes ($arguments) AND get ARGUMENT ($ARG)
                  -B   --barfoo         Set barfoo to yes ($barfoo)
                  -F   --foobar         Set foobar to yes ($foobar)
EOF
}

[ $# = 0 ] && _usage "  >>>>>>>> no options given "

##################################################################    
#######  "getopts" with: short options  AND  long options  #######
#######            AND  short/long arguments               #######
while getopts ':bfh-A:BF' OPTION ; do
  case "$OPTION" in
    b  ) sbar=yes                       ;;
    f  ) sfoo=yes                       ;;
    h  ) _usage                         ;;   
    A  ) sarguments=yes;sARG="$OPTARG"  ;;
    B  ) sbarfoo=yes                    ;;
    F  ) sfoobar=yes                    ;;
    -  ) [ $OPTIND -ge 1 ] && optind=$(expr $OPTIND - 1 ) || optind=$OPTIND
         eval OPTION="\$$optind"
         OPTARG=$(echo $OPTION | cut -d'=' -f2)
         OPTION=$(echo $OPTION | cut -d'=' -f1)
         case $OPTION in
             --foo       ) lfoo=yes                       ;;
             --bar       ) lbar=yes                       ;;
             --foobar    ) lfoobar=yes                    ;;
             --barfoo    ) lbarfoo=yes                    ;;
             --help      ) _usage                         ;;
               --arguments ) larguments=yes;lARG="$OPTARG"  ;; 
             * )  _usage " Long: >>>>>>>> invalid options (long) " ;;
         esac
       OPTIND=1
       shift
      ;;
    ? )  _usage "Short: >>>>>>>> invalid options (short) "  ;;
  esac
done 
```

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2009-05-15T08:02:03.523

看看**[shFlags](https://github.com/kward/shflags)**，它是一个可移植的 shell 库（意思是：在 Linux、Solaris 等上的 sh、bash、dash、ksh、zsh）。

它使添加新标志就像在脚本中添加一行一样简单，并且它提供了自动生成的使用功能。

这是一个简单的`Hello, world!`使用**shFlag**：

```
#!/bin/sh

# source shflags from current directory
. ./shflags

# define a 'name' command-line string flag
DEFINE_string 'name' 'world' 'name to say hello to' 'n'

# parse the command-line
FLAGS "$@" || exit 1
eval set -- "${FLAGS_ARGV}"

# say hello
echo "Hello, ${FLAGS_name}!" 
```

对于具有支持长选项的增强 getopt 的操作系统（例如 Linux），您可以执行以下操作：

```
$ ./hello_world.sh --name Kate
Hello, Kate! 
```

对于其余部分，您必须使用 short 选项：

```
$ ./hello_world.sh -n Kate
Hello, Kate! 
```

添加新标志就像添加新标志一样简单`DEFINE_ call`。

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2011-03-10T04:30:16.007

其他方式...

```
# translate long options to short
for arg
do
    delim=""
    case "$arg" in
       --help) args="${args}-h ";;
       --verbose) args="${args}-v ";;
       --config) args="${args}-c ";;
       # pass through anything else
       *) [[ "${arg:0:1}" == "-" ]] || delim="\""
           args="${args}${delim}${arg}${delim} ";;
    esac
done
# reset the translated args
eval set -- $args
# now we can process with getopt
while getopts ":hvc:" opt; do
    case $opt in
        h)  usage ;;
        v)  VERBOSE=true ;;
        c)  source $OPTARG ;;
        \?) usage ;;
        :)
        echo "option -$OPTARG requires an argument"
        usage
        ;;
    esac
done 
```

* * *

## 回答 #10

> 赞同：20
> 
> 时间：2011-08-04T18:44:27.570

我是这样解决的：

```
# A string with command options
options=$@

# An array with all the arguments
arguments=($options)

# Loop index
index=0

for argument in $options
  do
    # Incrementing index
    index=`expr $index + 1`

    # The conditions
    case $argument in
      -a) echo "key $argument value ${arguments[index]}" ;;
      -abc) echo "key $argument value ${arguments[index]}" ;;
    esac
  done

exit; 
```

我是傻还是怎么的？`getopt`并且`getopts`如此混乱。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2012-03-27T23:55:53.417

如果你不想要`getopt`依赖，你可以这样做：

```
while test $# -gt 0
do
  case $1 in

  # Normal option processing
    -h | --help)
      # usage and help
      ;;
    -v | --version)
      # version info
      ;;
  # ...

  # Special cases
    --)
      break
      ;;
    --*)
      # error unknown (long) option $1
      ;;
    -?)
      # error unknown (short) option $1
      ;;

  # FUN STUFF HERE:
  # Split apart combined short options
    -*)
      split=$1
      shift
      set -- $(echo "$split" | cut -c 2- | sed 's/./-& /g') "$@"
      continue
      ;;

  # Done with options
    *)
      break
      ;;
  esac

  # for testing purposes:
  echo "$1"

  shift
done 
```

当然，你不能用一个破折号来使用长样式选项。如果您想添加缩短的版本（例如 --verbos 而不是 --verbose），那么您需要手动添加它们。

但是，如果您希望获得`getopts`功能和长选项，这是一种简单的方法。

我还将这个片段放在了[gist](https://gist.github.com/2221367)中。

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2008-12-31T06:28:55.707

内置`getopts`无法做到这一点。有一个外部的*getopt* (1) 程序可以做到这一点，但你只能在 Linux 上从*util-linux*包中获得它。它带有一个示例脚本*getopt-parse.bash*。

还有一个[`getopts_long`](http://stchaz.free.fr/getopts_long)写成shell的函数。

* * *

## 回答 #13

> 赞同：9
> 
> 时间：2010-04-09T14:31:40.120

```
#!/bin/bash
while getopts "abc:d:" flag
do
  case $flag in
    a) echo "[getopts:$OPTIND]==> -$flag";;
    b) echo "[getopts:$OPTIND]==> -$flag";;
    c) echo "[getopts:$OPTIND]==> -$flag $OPTARG";;
    d) echo "[getopts:$OPTIND]==> -$flag $OPTARG";;
  esac
done

shift $((OPTIND-1))
echo "[otheropts]==> $@"

exit 
```

.

```
#!/bin/bash
until [ -z "$1" ]; do
  case $1 in
    "--dlong")
      shift
      if [ "${1:1:0}" != "-" ]
      then
        echo "==> dlong $1"
        shift
      fi;;
    *) echo "==> other $1"; shift;;
  esac
done
exit 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2011-01-07T21:34:26.947

在`ksh93`,`getopts`确实支持长名称...

```
while getopts "f(file):s(server):" flag
do
    echo "$flag" $OPTIND $OPTARG
done 
```

或者我发现的教程是这样说的。试试看。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2016-05-07T10:27:57.877

发明另一个版本的轮子……

这个函数是 GNU getopt 的（希望是）与 POSIX 兼容的普通 bourne shell 替代品。它支持可以接受强制/可选/无参数的短/长选项，并且指定选项的方式几乎与 GNU getopt 相同，因此转换很简单。

当然，这仍然是要放入脚本的相当大的代码块，但它大约是众所周知的 getopt_long shell 函数的一半，并且在您只想替换现有的 GNU getopt 使用的情况下可能更可取。

这是相当新的代码，所以 YMMV（如果出于任何原因这实际上与 POSIX 不兼容，请务必告诉我——可移植性从一开始就是目的，但我没有有用的 POSIX 测试环境）。

代码和示例用法如下：

```
#!/bin/sh
# posix_getopt shell function
# Author: Phil S.
# Version: 1.0
# Created: 2016-07-05
# URL: http://stackoverflow.com/a/37087374/324105

# POSIX-compatible argument quoting and parameter save/restore
# http://www.etalabs.net/sh_tricks.html
# Usage:
# parameters=$(save "$@") # save the original parameters.
# eval "set -- ${parameters}" # restore the saved parameters.
save () {
    local param
    for param; do
        printf %s\\n "$param" \
            | sed "s/'/'\\\\''/g;1s/^/'/;\$s/\$/' \\\\/"
    done
    printf %s\\n " "
}

# Exit with status $1 after displaying error message $2.
exiterr () {
    printf %s\\n "$2" >&2
    exit $1
}

# POSIX-compatible command line option parsing.
# This function supports long options and optional arguments, and is
# a (largely-compatible) drop-in replacement for GNU getopt.
#
# Instead of:
# opts=$(getopt -o "$shortopts" -l "$longopts" -- "$@")
# eval set -- ${opts}
#
# We instead use:
# opts=$(posix_getopt "$shortopts" "$longopts" "$@")
# eval "set -- ${opts}"
posix_getopt () { # args: "$shortopts" "$longopts" "$@"
    local shortopts longopts \
          arg argtype getopt nonopt opt optchar optword suffix

    shortopts="$1"
    longopts="$2"
    shift 2

    getopt=
    nonopt=
    while [ $# -gt 0 ]; do
        opt=
        arg=
        argtype=
        case "$1" in
            # '--' means don't parse the remaining options
            ( -- ) {
                getopt="${getopt}$(save "$@")"
                shift $#
                break
            };;
            # process short option
            ( -[!-]* ) {         # -x[foo]
                suffix=${1#-?}   # foo
                opt=${1%$suffix} # -x
                optchar=${opt#-} # x
                case "${shortopts}" in
                    ( *${optchar}::* ) { # optional argument
                        argtype=optional
                        arg="${suffix}"
                        shift
                    };;
                    ( *${optchar}:* ) { # required argument
                        argtype=required
                        if [ -n "${suffix}" ]; then
                            arg="${suffix}"
                            shift
                        else
                            case "$2" in
                                ( -* ) exiterr 1 "$1 requires an argument";;
                                ( ?* ) arg="$2"; shift 2;;
                                (  * ) exiterr 1 "$1 requires an argument";;
                            esac
                        fi
                    };;
                    ( *${optchar}* ) { # no argument
                        argtype=none
                        arg=
                        shift
                        # Handle multiple no-argument parameters combined as
                        # -xyz instead of -x -y -z. If we have just shifted
                        # parameter -xyz, we now replace it with -yz (which
                        # will be processed in the next iteration).
                        if [ -n "${suffix}" ]; then
                            eval "set -- $(save "-${suffix}")$(save "$@")"
                        fi
                    };;
                    ( * ) exiterr 1 "Unknown option $1";;
                esac
            };;
            # process long option
            ( --?* ) {            # --xarg[=foo]
                suffix=${1#*=}    # foo (unless there was no =)
                if [ "${suffix}" = "$1" ]; then
                    suffix=
                fi
                opt=${1%=$suffix} # --xarg
                optword=${opt#--} # xarg
                case ",${longopts}," in
                    ( *,${optword}::,* ) { # optional argument
                        argtype=optional
                        arg="${suffix}"
                        shift
                    };;
                    ( *,${optword}:,* ) { # required argument
                        argtype=required
                        if [ -n "${suffix}" ]; then
                            arg="${suffix}"
                            shift
                        else
                            case "$2" in
                                ( -* ) exiterr 1 \
                                       "--${optword} requires an argument";;
                                ( ?* ) arg="$2"; shift 2;;
                                (  * ) exiterr 1 \
                                       "--${optword} requires an argument";;
                            esac
                        fi
                    };;
                    ( *,${optword},* ) { # no argument
                        if [ -n "${suffix}" ]; then
                            exiterr 1 "--${optword} does not take an argument"
                        fi
                        argtype=none
                        arg=
                        shift
                    };;
                    ( * ) exiterr 1 "Unknown option $1";;
                esac
            };;
            # any other parameters starting with -
            ( -* ) exiterr 1 "Unknown option $1";;
            # remember non-option parameters
            ( * ) nonopt="${nonopt}$(save "$1")"; shift;;
        esac

        if [ -n "${opt}" ]; then
            getopt="${getopt}$(save "$opt")"
            case "${argtype}" in
                ( optional|required ) {
                    getopt="${getopt}$(save "$arg")"
                };;
            esac
        fi
    done

    # Generate function output, suitable for:
    # eval "set -- $(posix_getopt ...)"
    printf %s "${getopt}"
    if [ -n "${nonopt}" ]; then
        printf %s "$(save "--")${nonopt}"
    fi
} 
```

示例用法：

```
# Process command line options
shortopts="hvd:c::s::L:D"
longopts="help,version,directory:,client::,server::,load:,delete"
#opts=$(getopt -o "$shortopts" -l "$longopts" -n "$(basename $0)" -- "$@")
opts=$(posix_getopt "$shortopts" "$longopts" "$@")
if [ $? -eq 0 ]; then
    #eval set -- ${opts}
    eval "set -- ${opts}"
    while [ $# -gt 0 ]; do
        case "$1" in
            ( --                ) shift; break;;
            ( -h|--help         ) help=1; shift; break;;
            ( -v|--version      ) version_help=1; shift; break;;
            ( -d|--directory    ) dir=$2; shift 2;;
            ( -c|--client       ) useclient=1; client=$2; shift 2;;
            ( -s|--server       ) startserver=1; server_name=$2; shift 2;;
            ( -L|--load         ) load=$2; shift 2;;
            ( -D|--delete       ) delete=1; shift;;
        esac
    done
else
    shorthelp=1 # getopt returned (and reported) an error.
fi 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2017-10-17T15:00:43.660

我只是不时编写 shell 脚本并且没有实践，因此感谢任何反馈。

使用@Arvid Requate 提出的策略，我们注意到一些用户错误。忘记包含值的用户会意外地将下一个选项的名称视为值：

```
./getopts_test.sh --loglevel= --toc=TRUE 
```

将导致“loglevel”的值被视为“--toc=TRUE”。这是可以避免的。

[我从http://mwiki.wooledge.org/BashFAQ/035](http://mwiki.wooledge.org/BashFAQ/035)关于手动解析的讨论中调整了一些关于检查 CLI 用户错误的想法 。我在处理“-”和“--”参数时插入了错误检查。

然后我开始摆弄语法，所以这里的任何错误都是我的错，而不是原作者。

我的方法可以帮助喜欢在有或没有等号的情况下输入 long 的用户。也就是说，它对“--loglevel 9”的响应应该与“--loglevel = 9”相同。在 --/space 方法中，无法确定用户是否忘记了参数，因此需要进行一些猜测。

1.  如果用户具有长/等号格式 (--opt=)，则 = 后的空格会触发错误，因为未提供参数。
2.  如果用户有长/空格参数（--opt），如果没有参数（命令结束）或参数以破折号开头，则此脚本会导致失败）

如果您从这个开始，“--opt=value”和“--opt value”格式之间存在一个有趣的区别。使用等号，命令行参数被视为“opt=value”，处理字符串解析的工作是在“=”处分隔。相反，使用“--opt value”，参数的名称是“opt”，我们面临着获取命令行中提供的下一个值的挑战。这就是@Arvid Requate 使用间接引用 ${!OPTIND} 的地方。我仍然不明白，好吧，BashFAQ 中的评论似乎警告这种风格（[http://mywiki.wooledge.org/BashFAQ/006](http://mywiki.wooledge.org/BashFAQ/006)）。顺便说一句，我不认为之前发帖者关于 OPTIND=$(( $OPTIND + 1 )) 重要性的评论是正确的。我的意思是，

在此脚本的最新版本中，标志 -v 表示 VERBOSE 打印输出。

将其保存在一个名为“cli-5.sh”的文件中，使其可执行，并且其中任何一个都可以正常工作，或者以所需的方式失败

```
./cli-5.sh  -v --loglevel=44 --toc  TRUE
./cli-5.sh  -v --loglevel=44 --toc=TRUE
./cli-5.sh --loglevel 7
./cli-5.sh --loglevel=8
./cli-5.sh -l9

./cli-5.sh  --toc FALSE --loglevel=77
./cli-5.sh  --toc=FALSE --loglevel=77

./cli-5.sh   -l99 -t yyy
./cli-5.sh   -l 99 -t yyy 
```

这是对用户 intpu 进行错误检查的示例输出

```
$ ./cli-5.sh  --toc --loglevel=77
ERROR: toc value must not have dash at beginning
$ ./cli-5.sh  --toc= --loglevel=77
ERROR: value for toc undefined 
```

您应该考虑打开 -v，因为它会打印出 OPTIND 和 OPTARG 的内部信息

```
#/usr/bin/env bash

## Paul Johnson
## 20171016
##

## Combines ideas from
## https://stackoverflow.com/questions/402377/using-getopts-in-bash-shell-script-to-get-long-and-short-command-line-options
## by @Arvid Requate, and http://mwiki.wooledge.org/BashFAQ/035

# What I don't understand yet: 
# In @Arvid REquate's answer, we have 
# val="${!OPTIND}"; OPTIND=$(( $OPTIND + 1 ))
# this works, but I don't understand it!

die() {
    printf '%s\n' "$1" >&2
    exit 1
}

printparse(){
    if [ ${VERBOSE} -gt 0 ]; then
        printf 'Parse: %s%s%s\n' "$1" "$2" "$3" >&2;
    fi
}

showme(){
    if [ ${VERBOSE} -gt 0 ]; then
        printf 'VERBOSE: %s\n' "$1" >&2;
    fi
}

VERBOSE=0
loglevel=0
toc="TRUE"

optspec=":vhl:t:-:"
while getopts "$optspec" OPTCHAR; do

    showme "OPTARG:  ${OPTARG[*]}"
    showme "OPTIND:  ${OPTIND[*]}"
    case "${OPTCHAR}" in
        -)
            case "${OPTARG}" in
                loglevel) #argument has no equal sign
                    opt=${OPTARG}
                    val="${!OPTIND}"
                    ## check value. If negative, assume user forgot value
                    showme "OPTIND is {$OPTIND} {!OPTIND} has value \"${!OPTIND}\""
                    if [[ "$val" == -* ]]; then
                        die "ERROR: $opt value must not have dash at beginning"
                    fi
                    ## OPTIND=$(( $OPTIND + 1 )) # CAUTION! no effect?
                    printparse "--${OPTARG}" "  " "${val}"
                    loglevel="${val}"
                    shift
                    ;;
                loglevel=*) #argument has equal sign
                    opt=${OPTARG%=*}
                    val=${OPTARG#*=}
                    if [ "${OPTARG#*=}" ]; then
                        printparse "--${opt}" "=" "${val}"
                        loglevel="${val}"
                        ## shift CAUTION don't shift this, fails othewise
                    else
                        die "ERROR: $opt value must be supplied"
                    fi
                    ;;
                toc) #argument has no equal sign
                    opt=${OPTARG}
                    val="${!OPTIND}"
                    ## check value. If negative, assume user forgot value
                    showme "OPTIND is {$OPTIND} {!OPTIND} has value \"${!OPTIND}\""
                    if [[ "$val" == -* ]]; then
                        die "ERROR: $opt value must not have dash at beginning"
                    fi
                    ## OPTIND=$(( $OPTIND + 1 )) #??
                    printparse "--${opt}" " " "${val}"
                    toc="${val}"
                    shift
                    ;;
                toc=*) #argument has equal sign
                    opt=${OPTARG%=*}
                    val=${OPTARG#*=}
                    if [ "${OPTARG#*=}" ]; then
                        toc=${val}
                        printparse "--$opt" " -> " "$toc"
                        ##shift ## NO! dont shift this
                    else
                        die "ERROR: value for $opt undefined"
                    fi
                    ;;

                help)
                    echo "usage: $0 [-v] [--loglevel[=]<value>] [--toc[=]<TRUE,FALSE>]" >&2
                    exit 2
                    ;;
                *)
                    if [ "$OPTERR" = 1 ] && [ "${optspec:0:1}" != ":" ]; then
                        echo "Unknown option --${OPTARG}" >&2
                    fi
                    ;;
            esac;;
        h|-\?|--help)
            ## must rewrite this for all of the arguments
            echo "usage: $0 [-v] [--loglevel[=]<value>] [--toc[=]<TRUE,FALSE>]" >&2
            exit 2
            ;;
        l)
            loglevel=${OPTARG}
            printparse "-l" " "  "${loglevel}"
            ;;
        t)
            toc=${OPTARG}
            ;;
        v)
            VERBOSE=1
            ;;

        *)
            if [ "$OPTERR" != 1 ] || [ "${optspec:0:1}" = ":" ]; then
                echo "Non-option argument: '-${OPTARG}'" >&2
            fi
            ;;
    esac
done

echo "
After Parsing values
"
echo "loglevel  $loglevel" 
echo "toc  $toc" 
```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2019-01-13T17:51:08.020

接受的答案很好地指出了 bash built-in 的所有缺点`getopts`。答案以：

> 因此，虽然可以编写更多代码来解决对长选项缺乏支持的问题，但这需要更多的工作，并且部分违背了使用 getopt 解析器来简化代码的目的。

尽管我原则上同意该声明，但我觉得我们在各种脚本中实现此功能的次数证明了为创建“标准化”、经过良好测试的解决方案付出一些努力是合理的。

因此，我通过在纯 bash 中`getopts`实现“升级”了内置的[`getopts_long`](https://github.com/UrsaDK/getopts_long/blob/master/lib/getopts_long.bash)bash，没有外部依赖项。该功能的使用与内置 100% 兼容`getopts`。

通过在脚本中包含`getopts_long`（[托管在 GitHub 上](https://github.com/UrsaDK/getopts_long)），原始问题的答案可以简单地实现为：

```
source "${PATH_TO}/getopts_long.bash"

while getopts_long ':c: copyfile:' OPTKEY; do
    case ${OPTKEY} in
        'c'|'copyfile')
            echo 'file supplied -- ${OPTARG}'
            ;;
        '?')
            echo "INVALID OPTION -- ${OPTARG}" >&2
            exit 1
            ;;
        ':')
            echo "MISSING ARGUMENT for option -- ${OPTARG}" >&2
            exit 1
            ;;
        *)
            echo "Misconfigured OPTSPEC or uncaught option -- ${OPTKEY}" >&2
            exit 1
            ;;
    esac
done

shift $(( OPTIND - 1 ))
[[ "${1}" == "--" ]] && shift 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2012-06-12T16:06:18.550

我还没有足够的代表来评论或投票支持他的解决方案，但[sme 的回答](https://stackoverflow.com/a/5230306/874188)对我来说非常有效。我遇到的唯一问题是参数最终用单引号括起来（所以我把它们去掉了）。

我还添加了一些示例用法和帮助文本。我将在此处包含我的稍微扩展的版本：

```
#!/bin/bash

# getopt example
# from: https://stackoverflow.com/questions/402377/using-getopts-in-bash-shell-script-to-get-long-and-short-command-line-options
HELP_TEXT=\
"   USAGE:\n
    Accepts - and -- flags, can specify options that require a value, and can be in any order. A double-hyphen (--) will stop processing options.\n\n

    Accepts the following forms:\n\n

    getopt-example.sh -a -b -c value-for-c some-arg\n
    getopt-example.sh -c value-for-c -a -b some-arg\n
    getopt-example.sh -abc some-arg\n
    getopt-example.sh --along --blong --clong value-for-c -a -b -c some-arg\n
    getopt-example.sh some-arg --clong value-for-c\n
    getopt-example.sh
"

aflag=false
bflag=false
cargument=""

# options may be followed by one colon to indicate they have a required argument
if ! options=$(getopt -o abc:h\? -l along,blong,help,clong: -- "$@")
then
    # something went wrong, getopt will put out an error message for us
    exit 1
fi

set -- $options

while [ $# -gt 0 ]
do
    case $1 in
    -a|--along) aflag=true ;;
    -b|--blong) bflag=true ;;
    # for options with required arguments, an additional shift is required
    -c|--clong) cargument="$2" ; shift;;
    -h|--help|-\?) echo -e $HELP_TEXT; exit;;
    (--) shift; break;;
    (-*) echo "$0: error - unrecognized option $1" 1>&2; exit 1;;
    (*) break;;
    esac
    shift
done

# to remove the single quotes around arguments, pipe the output into:
# | sed -e "s/^'\\|'$//g"  (just leading/trailing) or | sed -e "s/'//g"  (all)

echo aflag=${aflag}
echo bflag=${bflag}
echo cargument=${cargument}

while [ $# -gt 0 ]
do
    echo arg=$1
    shift

    if [[ $aflag == true ]]; then
        echo a is true
    fi

done 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2014-05-01T19:25:55.803

在这里，您可以找到一些在 bash 中进行复杂选项解析的不同方法：http: [//mywiki.wooledge.org/ComplexOptionParsing](http://mywiki.wooledge.org/ComplexOptionParsing)

我确实创建了以下一个，我认为这是一个很好的，因为它是最少的代码，并且长短选项都有效。使用这种方法，长选项也可以有多个参数。

```
#!/bin/bash
# Uses bash extensions.  Not portable as written.

declare -A longoptspec
longoptspec=( [loglevel]=1 ) #use associative array to declare how many arguments a long option expects, in this case we declare that loglevel expects/has one argument, long options that aren't listed i n this way will have zero arguments by default
optspec=":h-:"
while getopts "$optspec" opt; do
while true; do
    case "${opt}" in
        -) #OPTARG is name-of-long-option or name-of-long-option=value
            if [[ "${OPTARG}" =~ .*=.* ]] #with this --key=value format only one argument is possible
            then
                opt=${OPTARG/=*/}
                OPTARG=${OPTARG#*=}
                ((OPTIND--))    
            else #with this --key value1 value2 format multiple arguments are possible
                opt="$OPTARG"
                OPTARG=(${@:OPTIND:$((longoptspec[$opt]))})
            fi
            ((OPTIND+=longoptspec[$opt]))
            continue #now that opt/OPTARG are set we can process them as if getopts would've given us long options
            ;;
        loglevel)
          loglevel=$OPTARG
            ;;
        h|help)
            echo "usage: $0 [--loglevel[=]<value>]" >&2
            exit 2
            ;;
    esac
break; done
done

# End of file 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-03-11T10:59:42.927

我已经在这个主题上工作了很长时间......并制作了我自己的库，您需要在主脚本中获取该库。有关示例，请参见[libopt4shell](http://liealgebra.free.fr/libopt4shell)和[cd2mpc](http://liealgebra.free.fr/cd2mpc)。希望能帮助到你 ！

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-07-15T14:45:20.410

改进的解决方案：

```
# translate long options to short
# Note: This enable long options but disable "--?*" in $OPTARG, or disable long options after  "--" in option fields.
for ((i=1;$#;i++)) ; do
    case "$1" in
        --)
            # [ ${args[$((i-1))]} == ... ] || EndOpt=1 ;;& # DIRTY: we still can handle some execptions...
            EndOpt=1 ;;&
        --version) ((EndOpt)) && args[$i]="$1"  || args[$i]="-V";;
        # default case : short option use the first char of the long option:
        --?*) ((EndOpt)) && args[$i]="$1"  || args[$i]="-${1:2:1}";;
        # pass through anything else:
        *) args[$i]="$1" ;;
    esac
    shift
done
# reset the translated args
set -- "${args[@]}"

function usage {
echo "Usage: $0 [options] files" >&2
    exit $1
}

# now we can process with getopt
while getopts ":hvVc:" opt; do
    case $opt in
        h)  usage ;;
        v)  VERBOSE=true ;;
        V)  echo $Version ; exit ;;
        c)  source $OPTARG ;;
        \?) echo "unrecognized option: -$opt" ; usage -1 ;;
        :)
        echo "option -$OPTARG requires an argument"
        usage -1
        ;;
    esac
done

shift $((OPTIND-1))
[[ "$1" == "--" ]] && shift 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2012-06-26T14:40:19.573

也许使用 ksh 更简单，仅用于 getopts 部分，如果需要长命令行选项，因为在那里可以更容易地完成。

```
# Working Getopts Long => KSH

#! /bin/ksh
# Getopts Long
USAGE="s(showconfig)"
USAGE+="c:(createdb)"
USAGE+="l:(createlistener)"
USAGE+="g:(generatescripts)"
USAGE+="r:(removedb)"
USAGE+="x:(removelistener)"
USAGE+="t:(createtemplate)"
USAGE+="h(help)"

while getopts "$USAGE" optchar ; do
    case $optchar in
    s)  echo "Displaying Configuration" ;;
        c)  echo "Creating Database $OPTARG" ;;
    l)  echo "Creating Listener LISTENER_$OPTARG" ;;
    g)  echo "Generating Scripts for Database $OPTARG" ;;
    r)  echo "Removing Database $OPTARG" ;;
    x)  echo "Removing Listener LISTENER_$OPTARG" ;;
    t)  echo "Creating Database Template" ;;
    h)  echo "Help" ;;
    esac
done 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2015-07-02T17:37:28.387

我想要一些没有外部依赖的东西，具有严格的 bash 支持 (-u)，我需要它甚至可以在较旧的 bash 版本上工作。这处理各种类型的参数：

*   短布尔 (-h)
*   短选项（-i "image.jpg"）
*   长布尔 (--help)
*   等于选项（--file="filename.ext"）
*   空间选项（--file "filename.ext"）
*   连接布尔 (-hvm)

只需在脚本顶部插入以下内容：

```
# Check if a list of params contains a specific param
# usage: if _param_variant "h|?|help p|path f|file long-thing t|test-thing" "file" ; then ...
# the global variable $key is updated to the long notation (last entry in the pipe delineated list, if applicable)
_param_variant() {
  for param in $1 ; do
    local variants=${param//\|/ }
    for variant in $variants ; do
      if [[ "$variant" = "$2" ]] ; then
        # Update the key to match the long version
        local arr=(${param//\|/ })
        let last=${#arr[@]}-1
        key="${arr[$last]}"
        return 0
      fi
    done
  done
  return 1
}

# Get input parameters in short or long notation, with no dependencies beyond bash
# usage:
#     # First, set your defaults
#     param_help=false
#     param_path="."
#     param_file=false
#     param_image=false
#     param_image_lossy=true
#     # Define allowed parameters
#     allowed_params="h|?|help p|path f|file i|image image-lossy"
#     # Get parameters from the arguments provided
#     _get_params $*
#
# Parameters will be converted into safe variable names like:
#     param_help,
#     param_path,
#     param_file,
#     param_image,
#     param_image_lossy
#
# Parameters without a value like "-h" or "--help" will be treated as
# boolean, and will be set as param_help=true
#
# Parameters can accept values in the various typical ways:
#     -i "path/goes/here"
#     --image "path/goes/here"
#     --image="path/goes/here"
#     --image=path/goes/here
# These would all result in effectively the same thing:
#     param_image="path/goes/here"
#
# Concatinated short parameters (boolean) are also supported
#     -vhm is the same as -v -h -m
_get_params(){

  local param_pair
  local key
  local value
  local shift_count

  while : ; do
    # Ensure we have a valid param. Allows this to work even in -u mode.
    if [[ $# == 0 || -z $1 ]] ; then
      break
    fi

    # Split the argument if it contains "="
    param_pair=(${1//=/ })
    # Remove preceeding dashes
    key="${param_pair[0]#--}"

    # Check for concatinated boolean short parameters.
    local nodash="${key#-}"
    local breakout=false
    if [[ "$nodash" != "$key" && ${#nodash} -gt 1 ]]; then
      # Extrapolate multiple boolean keys in single dash notation. ie. "-vmh" should translate to: "-v -m -h"
      local short_param_count=${#nodash}
      let new_arg_count=$#+$short_param_count-1
      local new_args=""
      # $str_pos is the current position in the short param string $nodash
      for (( str_pos=0; str_pos<new_arg_count; str_pos++ )); do
        # The first character becomes the current key
        if [ $str_pos -eq 0 ] ; then
          key="${nodash:$str_pos:1}"
          breakout=true
        fi
        # $arg_pos is the current position in the constructed arguments list
        let arg_pos=$str_pos+1
        if [ $arg_pos -gt $short_param_count ] ; then
          # handle other arguments
          let orignal_arg_number=$arg_pos-$short_param_count+1
          local new_arg="${!orignal_arg_number}"
        else
          # break out our one argument into new ones
          local new_arg="-${nodash:$str_pos:1}"
        fi
        new_args="$new_args \"$new_arg\""
      done
      # remove the preceding space and set the new arguments
      eval set -- "${new_args# }"
    fi
    if ! $breakout ; then
      key="$nodash"
    fi

    # By default we expect to shift one argument at a time
    shift_count=1
    if [ "${#param_pair[@]}" -gt "1" ] ; then
      # This is a param with equals notation
      value="${param_pair[1]}"
    else
      # This is either a boolean param and there is no value,
      # or the value is the next command line argument
      # Assume the value is a boolean true, unless the next argument is found to be a value.
      value=true
      if [[ $# -gt 1 && -n "$2" ]]; then
        local nodash="${2#-}"
        if [ "$nodash" = "$2" ]; then
          # The next argument has NO preceding dash so it is a value
          value="$2"
          shift_count=2
        fi
      fi
    fi

    # Check that the param being passed is one of the allowed params
    if _param_variant "$allowed_params" "$key" ; then
      # --key-name will now become param_key_name
      eval param_${key//-/_}="$value"
    else
      printf 'WARNING: Unknown option (ignored): %s\n' "$1" >&2
    fi
    shift $shift_count
  done
} 
```

并像这样使用它：

```
# Assign defaults for parameters
param_help=false
param_path=$(pwd)
param_file=false
param_image=true
param_image_lossy=true
param_image_lossy_quality=85

# Define the params we will allow
allowed_params="h|?|help p|path f|file i|image image-lossy image-lossy-quality"

# Get the params from arguments provided
_get_params $* 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-04-02T09:55:18.480

如果只是这就是您要调用脚本的方式

```
myscript.sh --input1 "ABC" --input2 "PQR" --input2 "XYZ" 
```

那么你可以按照这个最简单的方法在 getopt 和 --longoptions 的帮助下实现它

试试这个，希望有用

```
# Read command line options
ARGUMENT_LIST=(
    "input1"
    "input2"
    "input3"
)

# read arguments
opts=$(getopt \
    --longoptions "$(printf "%s:," "${ARGUMENT_LIST[@]}")" \
    --name "$(basename "$0")" \
    --options "" \
    -- "$@"
)

echo $opts

eval set --$opts

while true; do
    case "$1" in
    --input1)  
        shift
        empId=$1
        ;;
    --input2)  
        shift
        fromDate=$1
        ;;
    --input3)  
        shift
        toDate=$1
        ;;
      --)
        shift
        break
        ;;
    esac
    shift
done 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2012-02-01T14:13:09.287

getopts“可以用来”解析长选项，只要你不希望它们有参数......

方法如下：

```
$ cat > longopt
while getopts 'e:-:' OPT; do
  case $OPT in
    e) echo echo: $OPTARG;;
    -) #long option
       case $OPTARG in
         long-option) echo long option;;
         *) echo long option: $OPTARG;;
       esac;;
  esac
done

$ bash longopt -e asd --long-option --long1 --long2 -e test
echo: asd
long option
long option: long1
long option: long2
echo: test 
```

如果您尝试使用 OPTIND 获取 long 选项的参数，getopts 会将其视为第一个非可选位置参数，并将停止解析任何其他参数。在这种情况下，您最好使用简单的 case 语句手动处理它。

这将“始终”有效：

```
$ cat >longopt2
while (($#)); do
    OPT=$1
    shift
    case $OPT in
        --*) case ${OPT:2} in
            long1) echo long1 option;;
            complex) echo comples with argument $1; shift;;
        esac;;

        -*) case ${OPT:1} in
            a) echo short option a;;
            b) echo short option b with parameter $1; shift;;
        esac;;
    esac
done

$ bash longopt2 --complex abc -a --long -b test
comples with argument abc
short option a
short option b with parameter test 
```

尽管它不如 getopts 灵活，并且您必须在案例实例中自己执行大部分错误检查代码......

但这是一种选择。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2012-07-06T15:20:56.453

如果您的所有长选项都具有唯一且匹配的第一个字符作为短选项，例如

```
./slamm --chaos 23 --plenty test -quiet 
```

是相同的

```
./slamm -c 23 -p test -q 
```

您可以在getopts 重写 $args*之前使用它：*

```
# change long options to short options

for arg; do 
    [[ "${arg:0:1}" == "-" ]] && delim="" || delim="\""
    if [ "${arg:0:2}" == "--" ]; 
       then args="${args} -${arg:2:1}" 
       else args="${args} ${delim}${arg}${delim}"
    fi
done

# reset the incoming args
eval set -- $args

# proceed as usual
while getopts ":b:la:h" OPTION; do
    ..... 
```

感谢 mtvee 的启发 ;-)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2013-03-16T10:02:31.577

为了保持跨平台兼容，并避免依赖外部可执行文件，我从另一种语言移植了一些代码。

我觉得它很容易使用，这里有一个例子：

```
ArgParser::addArg "[h]elp"    false    "This list"
ArgParser::addArg "[q]uiet"   false    "Supress output"
ArgParser::addArg "[s]leep"   1        "Seconds to sleep"
ArgParser::addArg "v"         1        "Verbose mode"

ArgParser::parse "$@"

ArgParser::isset help && ArgParser::showArgs

ArgParser::isset "quiet" \
   && echo "Quiet!" \
   || echo "Noisy!"

local __sleep
ArgParser::tryAndGetArg sleep into __sleep \
   && echo "Sleep for $__sleep seconds" \
   || echo "No value passed for sleep"

# This way is often more convienient, but is a little slower
echo "Sleep set to: $( ArgParser::getArg sleep )" 
```

所需的 BASH 比它可能的要长一点，但我想避免依赖 BASH 4 的关联数组。您也可以直接从[http://nt4.com/bash/argparser.inc.sh下载](http://nt4.com/bash/argparser.inc.sh)

```
#!/usr/bin/env bash

# Updates to this script may be found at
# http://nt4.com/bash/argparser.inc.sh

# Example of runtime usage:
# mnc.sh --nc -q Caprica.S0*mkv *.avi *.mp3 --more-options here --host centos8.host.com

# Example of use in script (see bottom)
# Just include this file in yours, or use
# source argparser.inc.sh

unset EXPLODED
declare -a EXPLODED
function explode 
{
    local c=$# 
    (( c < 2 )) && 
    {
        echo function "$0" is missing parameters 
        return 1
    }

    local delimiter="$1"
    local string="$2"
    local limit=${3-99}

    local tmp_delim=$'\x07'
    local delin=${string//$delimiter/$tmp_delim}
    local oldifs="$IFS"

    IFS="$tmp_delim"
    EXPLODED=($delin)
    IFS="$oldifs"
}

# See: http://fvue.nl/wiki/Bash:_Passing_variables_by_reference
# Usage: local "$1" && upvar $1 "value(s)"
upvar() {
    if unset -v "$1"; then           # Unset & validate varname
        if (( $# == 2 )); then
            eval $1=\"\$2\"          # Return single value
        else
            eval $1=\(\"\${@:2}\"\)  # Return array
        fi
    fi
}

function decho
{
    :
}

function ArgParser::check
{
    __args=${#__argparser__arglist[@]}
    for (( i=0; i<__args; i++ ))
    do
        matched=0
        explode "|" "${__argparser__arglist[$i]}"
        if [ "${#1}" -eq 1 ]
        then
            if [ "${1}" == "${EXPLODED[0]}" ]
            then
                decho "Matched $1 with ${EXPLODED[0]}"
                matched=1

                break
            fi
        else
            if [ "${1}" == "${EXPLODED[1]}" ]
            then
                decho "Matched $1 with ${EXPLODED[1]}"
                matched=1

                break
            fi
        fi
    done
    (( matched == 0 )) && return 2
    # decho "Key $key has default argument of ${EXPLODED[3]}"
    if [ "${EXPLODED[3]}" == "false" ]
    then
        return 0
    else
        return 1
    fi
}

function ArgParser::set
{
    key=$3
    value="${1:-true}"
    declare -g __argpassed__$key="$value"
}

function ArgParser::parse
{

    unset __argparser__argv
    __argparser__argv=()
    # echo parsing: "$@"

    while [ -n "$1" ]
    do
        # echo "Processing $1"
        if [ "${1:0:2}" == '--' ]
        then
            key=${1:2}
            value=$2
        elif [ "${1:0:1}" == '-' ]
        then
            key=${1:1}               # Strip off leading -
            value=$2
        else
            decho "Not argument or option: '$1'" >& 2
            __argparser__argv+=( "$1" )
            shift
            continue
        fi
        # parameter=${tmp%%=*}     # Extract name.
        # value=${tmp##*=}         # Extract value.
        decho "Key: '$key', value: '$value'"
        # eval $parameter=$value
        ArgParser::check $key
        el=$?
        # echo "Check returned $el for $key"
        [ $el -eq  2 ] && decho "No match for option '$1'" >&2 # && __argparser__argv+=( "$1" )
        [ $el -eq  0 ] && decho "Matched option '${EXPLODED[2]}' with no arguments"        >&2 && ArgParser::set true "${EXPLODED[@]}"
        [ $el -eq  1 ] && decho "Matched option '${EXPLODED[2]}' with an argument of '$2'"   >&2 && ArgParser::set "$2" "${EXPLODED[@]}" && shift
        shift
    done
}

function ArgParser::isset
{
    declare -p "__argpassed__$1" > /dev/null 2>&1 && return 0
    return 1
}

function ArgParser::getArg
{
    # This one would be a bit silly, since we can only return non-integer arguments ineffeciently
    varname="__argpassed__$1"
    echo "${!varname}"
}

##
# usage: tryAndGetArg <argname> into <varname>
# returns: 0 on success, 1 on failure
function ArgParser::tryAndGetArg
{
    local __varname="__argpassed__$1"
    local __value="${!__varname}"
    test -z "$__value" && return 1
    local "$3" && upvar $3 "$__value"
    return 0
}

function ArgParser::__construct
{
    unset __argparser__arglist
    # declare -a __argparser__arglist
}

##
# @brief add command line argument
# @param 1 short and/or long, eg: [s]hort
# @param 2 default value
# @param 3 description
##
function ArgParser::addArg
{
    # check for short arg within long arg
    if [[ "$1" =~ \[(.)\] ]]
    then
        short=${BASH_REMATCH[1]}
        long=${1/\[$short\]/$short}
    else
        long=$1
    fi
    if [ "${#long}" -eq 1 ]
    then
        short=$long
        long=''
    fi
    decho short: "$short"
    decho long: "$long"
    __argparser__arglist+=("$short|$long|$1|$2|$3")
}

## 
# @brief show available command line arguments
##
function ArgParser::showArgs
{
    # declare -p | grep argparser
    printf "Usage: %s [OPTION...]\n\n" "$( basename "${BASH_SOURCE[0]}" )"
    printf "Defaults for the options are specified in brackets.\n\n";

    __args=${#__argparser__arglist[@]}
    for (( i=0; i<__args; i++ ))
    do
        local shortname=
        local fullname=
        local default=
        local description=
        local comma=

        explode "|" "${__argparser__arglist[$i]}"

        shortname="${EXPLODED[0]:+-${EXPLODED[0]}}" # String Substitution Guide: 
        fullname="${EXPLODED[1]:+--${EXPLODED[1]}}" # http://tldp.org/LDP/abs/html/parameter-substitution.html
        test -n "$shortname" \
            && test -n "$fullname" \
            && comma=","

        default="${EXPLODED[3]}"
        case $default in
            false )
                default=
                ;;
            "" )
                default=
                ;;
            * )
                default="[$default]"
        esac

        description="${EXPLODED[4]}"

        printf "  %2s%1s %-19s %s %s\n" "$shortname" "$comma" "$fullname" "$description" "$default"
    done
}

function ArgParser::test
{
    # Arguments with a default of 'false' do not take paramaters (note: default
    # values are not applied in this release)

    ArgParser::addArg "[h]elp"      false       "This list"
    ArgParser::addArg "[q]uiet" false       "Supress output"
    ArgParser::addArg "[s]leep" 1           "Seconds to sleep"
    ArgParser::addArg "v"           1           "Verbose mode"

    ArgParser::parse "$@"

    ArgParser::isset help && ArgParser::showArgs

    ArgParser::isset "quiet" \
        && echo "Quiet!" \
        || echo "Noisy!"

    local __sleep
    ArgParser::tryAndGetArg sleep into __sleep \
        && echo "Sleep for $__sleep seconds" \
        || echo "No value passed for sleep"

    # This way is often more convienient, but is a little slower
    echo "Sleep set to: $( ArgParser::getArg sleep )"

    echo "Remaining command line: ${__argparser__argv[@]}"

}

if [ "$( basename "$0" )" == "argparser.inc.sh" ]
then
    ArgParser::test "$@"
fi 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-04-08T22:50:14.907

**内置`getopts`**仅解析短选项（ksh93 除外），但您仍然可以添加几行脚本以使 getopts 处理长选项。

[这是在http://www.uxora.com/unix/shell-script/22-handle-long-options-with-getopts](http://www.uxora.com/unix/shell-script/22-handle-long-options-with-getopts)中找到的部分代码

```
 #== set short options ==#
SCRIPT_OPTS=':fbF:B:-:h'
  #== set long options associated with short one ==#
typeset -A ARRAY_OPTS
ARRAY_OPTS=(
    [foo]=f
    [bar]=b
    [foobar]=F
    [barfoo]=B
    [help]=h
    [man]=h
)

  #== parse options ==#
while getopts ${SCRIPT_OPTS} OPTION ; do
    #== translate long options to short ==#
    if [[ "x$OPTION" == "x-" ]]; then
        LONG_OPTION=$OPTARG
        LONG_OPTARG=$(echo $LONG_OPTION | grep "=" | cut -d'=' -f2)
        LONG_OPTIND=-1
        [[ "x$LONG_OPTARG" = "x" ]] && LONG_OPTIND=$OPTIND || LONG_OPTION=$(echo $OPTARG | cut -d'=' -f1)
        [[ $LONG_OPTIND -ne -1 ]] && eval LONG_OPTARG="\$$LONG_OPTIND"
        OPTION=${ARRAY_OPTS[$LONG_OPTION]}
        [[ "x$OPTION" = "x" ]] &&  OPTION="?" OPTARG="-$LONG_OPTION"

        if [[ $( echo "${SCRIPT_OPTS}" | grep -c "${OPTION}:" ) -eq 1 ]]; then
            if [[ "x${LONG_OPTARG}" = "x" ]] || [[ "${LONG_OPTARG}" = -* ]]; then 
                OPTION=":" OPTARG="-$LONG_OPTION"
            else
                OPTARG="$LONG_OPTARG";
                if [[ $LONG_OPTIND -ne -1 ]]; then
                    [[ $OPTIND -le $Optnum ]] && OPTIND=$(( $OPTIND+1 ))
                    shift $OPTIND
                    OPTIND=1
                fi
            fi
        fi
    fi

    #== options follow by another option instead of argument ==#
    if [[ "x${OPTION}" != "x:" ]] && [[ "x${OPTION}" != "x?" ]] && [[ "${OPTARG}" = -* ]]; then 
        OPTARG="$OPTION" OPTION=":"
    fi

    #== manage options ==#
    case "$OPTION" in
        f  ) foo=1 bar=0                    ;;
        b  ) foo=0 bar=1                    ;;
        B  ) barfoo=${OPTARG}               ;;
        F  ) foobar=1 && foobar_name=${OPTARG} ;;
        h ) usagefull && exit 0 ;;
        : ) echo "${SCRIPT_NAME}: -$OPTARG: option requires an argument" >&2 && usage >&2 && exit 99 ;;
        ? ) echo "${SCRIPT_NAME}: -$OPTARG: unknown option" >&2 && usage >&2 && exit 99 ;;
    esac
done
shift $((${OPTIND} - 1)) 
```

这是一个测试：

```
# Short options test
$ ./foobar_any_getopts.sh -bF "Hello world" -B 6 file1 file2
foo=0 bar=1
barfoo=6
foobar=1 foobar_name=Hello world
files=file1 file2

# Long and short options test
$ ./foobar_any_getopts.sh --bar -F Hello --barfoo 6 file1 file2
foo=0 bar=1
barfoo=6
foobar=1 foobar_name=Hello
files=file1 file2 
```

否则**在最近的 Korn Shell** ksh93 中，`getopts`可以自然地解析长选项，甚至显示类似的手册页。（见[http://www.uxora.com/unix/shell-script/20-getopts-with-man-page-and-long-options](http://www.uxora.com/unix/shell-script/20-getopts-with-man-page-and-long-options)）

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-05-18T15:00:20.423

内置 OS X (BSD) getopt 不支持长选项，但 GNU 版本支持：`brew install gnu-getopt`. 然后，类似于：`cp /usr/local/Cellar/gnu-getopt/1.1.6/bin/getopt /usr/local/bin/gnu-getopt`。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-02-11T15:26:14.210

一个简单的 DIY，只获取长名称的 args：

采用：

```
$ ./test-args.sh --a1 a1 --a2 "a 2" --a3 --a4= --a5=a5 --a6="a 6"
a1 = "a1"
a2 = "a 2"
a3 = "TRUE"
a4 = ""
a5 = "a5"
a6 = "a 6"
a7 = "" 
```

脚本：

```
#!/bin/bash

function main() {
    ARGS=`getArgs "$@"`

    a1=`echo "$ARGS" | getNamedArg a1`
    a2=`echo "$ARGS" | getNamedArg a2`
    a3=`echo "$ARGS" | getNamedArg a3`
    a4=`echo "$ARGS" | getNamedArg a4`
    a5=`echo "$ARGS" | getNamedArg a5`
    a6=`echo "$ARGS" | getNamedArg a6`
    a7=`echo "$ARGS" | getNamedArg a7`

    echo "a1 = \"$a1\""
    echo "a2 = \"$a2\""
    echo "a3 = \"$a3\""
    echo "a4 = \"$a4\""
    echo "a5 = \"$a5\""
    echo "a6 = \"$a6\""
    echo "a7 = \"$a7\""

    exit 0
}

function getArgs() {
    for arg in "$@"; do
        echo "$arg"
    done
}

function getNamedArg() {
    ARG_NAME=$1

    sed --regexp-extended --quiet --expression="
        s/^--$ARG_NAME=(.*)\$/\1/p  # Get arguments in format '--arg=value': [s]ubstitute '--arg=value' by 'value', and [p]rint
        /^--$ARG_NAME\$/ {          # Get arguments in format '--arg value' ou '--arg'
            n                       # - [n]ext, because in this format, if value exists, it will be the next argument
            /^--/! p                # - If next doesn't starts with '--', it is the value of the actual argument
            /^--/ {                 # - If next do starts with '--', it is the next argument and the actual argument is a boolean one
                # Then just repla[c]ed by TRUE
                c TRUE
            }
        }
    "
}

main "$@" 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2015-05-19T13:18:26.990

嗯。

对纯 bash 选项不太满意。为什么不使用 perl 来获得你想要的东西。直接解析 $* 数组，并自动命名您的选项。

简单的帮助脚本：

```
#!/usr/bin/perl
use Getopt::Long;

my $optstring = shift;

my @opts = split(m#,#, $optstring);

my %opt;
GetOptions(\%opt, @opts);

print "set -- " . join(' ', map("'$_'", @ARGV)) . ";";
my $xx;

my $key;
foreach $key (keys(%opt))
{
    print "export $key='$opt{$key}'; ";
} 
```

然后你可以在你的脚本中使用一个衬里，例如：

```
#!/bin/bash

eval `getopts.pl reuse:s,long_opt:s,hello $*`;

echo "HELLO: $hello"
echo "LONG_OPT: $long_opt"
echo "REUSE: $reuse"

echo $* 
```

/tmp/script.sh 你好--重用我--long_optwhat_you_want_except_spaces--hello 1 2 3

你好：1 LONG_OPT：whatever_you_want_except 空格重用：我

1 2 3

这里唯一需要注意的是空间不起作用。但它避免了 bash 相当复杂的循环语法，使用长参数，将它们自动命名为变量并自动调整 $* 的大小，因此 99% 的时间都可以工作。

# iphone - Automated testing for iPhone

> ID：402389
> 
> 赞同：72
> 
> 时间：2008-12-31T05:59:55.033
> 
> 标签：iphone, testing, ios-simulator, automated-tests, ios-ui-automation

I know this one is going to be a long-shot, but I thought I'd try. Does anyone know of any automated test *anything* for the iPhone simulator? I'd love it if there was something like Selenium but for the iPhone simulator. I don't need anything fancy like assertions, just something that can fake out taps on a screen so I can stop abusing my trackpad. :)

Is there a way to send taps or keyevents (like on android over adb) to iOS devices?

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-04-09T15:08:08.100

iPhone OS 4.0 (just announced) includes a "UIAutomation Instrument" for test automation.

**Automated testing**
Automate the testing of your application by scripting touch events using the new UIAutomation Instrument.

From: [http://developer.apple.com/technologies/iphone/whats-new.html#tools](http://developer.apple.com/technologies/iphone/whats-new.html#tools)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-31T06:56:37.617

Here's an article about [automated user interface testing for the iPhone](https://cocoawithlove.com/2008/11/automated-user-interface-testing-on.html) that you may find helpful. It's a little kludgy but it probably gets the job done for certain tasks. Note that I haven't yet tried it myself.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-03-02T23:02:26.400

Gorilla Logic has just open sourced a true record/playback functional testing tool for the iPhone. It's called FoneMonkey and it's freely available at [http://www.gorillalogic.com/fonemonkey](http://www.gorillalogic.com/fonemonkey).

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-07-06T10:21:35.357

How to use UIAutomation to create iPhone UI tests:

[http://answers.oreilly.com/topic/1646-how-to-use-uiautomation-to-create-iphone-ui-tests/](http://answers.oreilly.com/topic/1646-how-to-use-uiautomation-to-create-iphone-ui-tests/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T14:51:56.597

See also

*   [Test Driven Design for iPhone Native apps](https://stackoverflow.com/questions/195820/test-driven-design-for-iphone-native-apps)
*   [Do OCUnit and OCMock work on the iPhone SDK?](https://stackoverflow.com/questions/159280/do-ocunit-and-ocmock-work-on-the-iphone-sdk)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-09-30T22:50:04.290

Try this:

[http://code.google.com/p/uispec/](http://code.google.com/p/uispec/)

UISpec is a Behavior Driven Development framework for the iPhone that provides a full automated testing solution that drives the actual iPhone UI. It is modeled after the very popular RSpec for Ruby

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-07-15T20:28:18.480

Square just released their testing framework

[http://corner.squareup.com/2011/07/ios-integration-testing.html](http://corner.squareup.com/2011/07/ios-integration-testing.html)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-03-20T16:18:42.587

Telerik just released an automated testing tool for iOS - [http://www.telerik.com/automated-testing-tools/ios-testing/ios-application-testing.aspx](http://www.telerik.com/automated-testing-tools/ios-testing/ios-application-testing.aspx)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-04-06T19:51:44.317

Good luck with trying to automate iOS platform with JS. By the time QA gets proficient with JS, well you wouldn't have to be QA anymore. There is plenty of us out there that are familiar with Selenium which in turns means you know Java to some extent. I have found a way to automate iOS using complete open source with Java Libraries.

I put up a video on it: [http://www.vimeo.com/21999946](http://www.vimeo.com/21999946)

I will will be putting up more in depth video shortly.

And since its Java it works perfectly with Junit, ANT, Maven in any CI environment.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-07-24T22:14:01.103

Check out UISpec [http://code.google.com/p/uispec/](http://code.google.com/p/uispec/)

It's BDD testing framework that lets you "drive" the iphone simulator.

Best,

Brian

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-02T04:54:23.343

See also [http://www.froglogic.com/pg?id=NewsEvents&category=111](http://www.froglogic.com/pg?id=NewsEvents&category=111)

Regards, Reginald

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-07-29T09:39:51.020

Pick whichever Automation Tool you want from this page: [http://www.mobileappstesting.com/category/mobile-application-testing/mobile-application-testing-and-automation-tools/](http://www.mobileappstesting.com/category/mobile-application-testing/mobile-application-testing-and-automation-tools/)

Eggplant :- [http://www.testplant.com/products/eggplant/](http://www.testplant.com/products/eggplant/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-01-09T13:37:07.993

I blogged about KIF (Keep It Functional), this is the testframework from the company square and it is really good! I use it to test our iPhone app.

More information and an example how to setup the framework

[http://dnlkntt.wordpress.com/2011/12/02/iphone-test-automation-using-kif-keep-it-functional/](http://dnlkntt.wordpress.com/2011/12/02/iphone-test-automation-using-kif-keep-it-functional/)

Have Fun!

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-05-31T11:53:34.373

There's also Keynote products. They have:

Test Center Enterprise Interactive (App platform, any device with website / app. Internal / external facing apps and websites, manual testing.)

Test Center Enterprise Automation (App platform, any device with website / app. WITH scripting.)

Test Center Developer (App platform, any device with website / app, manual, no scripting.)

Unknown costs involved, you have to call them. But the feature set is very impressive. They have multiple real devices for each handset and you just select which one you use. If they are in use you can book them etc. I think this is the ultimate option for testing any mobile app.

# string - 显示在haskell中重复的单词列表

> ID：402391
> 
> 赞同：4
> 
> 时间：2008-12-31T06:01:05.373
> 
> 标签：string, parsing, haskell

我需要能够编写一个函数来显示字符串中的重复单词并按出现的顺序返回字符串列表并忽略非字母

例如在拥抱提示

```
repetitions :: String -> [String]

repetitions > "My bag is is action packed packed."
output> ["is","packed"]
repetitions > "My name  name name is Sean ."
output> ["name","name"]
repetitions > "Ade is into into technical drawing drawing ."
output> ["into","drawing"] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-31T06:26:45.493

要将字符串拆分为单词，请使用`words`函数（在 Prelude 中）。要消除非单词字符，`filter`使用`Data.Char.isAlphaNum`. 将列表与其尾部压缩在一起以获得相邻的对`(x, y)`。折叠列表，创建一个包含所有`x`where `x`==的新列表`y`。

有点像：

```
repetitions s = map fst . filter (uncurry (==)) . zip l $ tail l
  where l = map (filter isAlphaNum) (words s) 
```

我不确定这是否有效，但它应该给你一个粗略的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T06:46:06.593

我是这种语言的新手，所以我的解决方案在 Haskell 资深人士眼中可能有点丑陋，但无论如何：

```
let repetitions x = concat (map tail (filter (\x -> (length x) > 1) (List.group (words (filter (\c -> (c >= 'a' && c <= 'z') || (c>='A' && c <= 'Z') ||  c==' ') x))))) 
```

这部分将从字符串*s*中删除所有非字母和非空格：

```
filter (\c -> (c >= 'a' && c <= 'z') || (c>='A' && c <= 'Z') ||  c==' ') s 
```

这会将字符串*s*拆分为单词并将相同的单词分组到返回列表的列表中：

```
List.group (words s) 
```

当这部分将删除所有少于两个元素的列表时：

```
filter (\x -> (length x) > 1) s 
```

之后，我们会将所有列表连接到一个列表中，但从中删除一个元素

```
concat (map tail s) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-13T14:08:21.823

这可能是不雅的，但它在概念上非常简单。我假设它正在寻找像示例这样的连续重复单词。

```
-- a wrapper that allows you to give the input as a String
repititions :: String -> [String]
repititions s = repititionsLogic (words s)
-- dose the real work 
repititionsLogic :: [String] -> [String]
repititionsLogic [] = []
repititionsLogic [a] = []
repititionsLogic (a:as) 
    | ((==) a (head as)) = a : repititionsLogic as
    | otherwise = repititionsLogic as 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-02T20:31:56.910

基于亚历山大·普罗科菲耶夫的回答：

`repetitions x = concat (map tail (filter (\x -> (length x) > 1) (List.group (word (filter (\c -> (c >= 'a' && c <= 'z') || (c>='A' && c <= 'Z') || c==' ') x)))))`

删除不必要的括号：

`repetitions x = concat (map tail (filter (\x -> length x > 1) (List.group (word (filter (\c -> c >= 'a' && c <= 'z' || c>='A' && c <= 'Z' || c==' ') x)))))`

使用 $ 删除更多括号（如果结束括号位于表达式的末尾，则每个 $ 可以替换一个左括号）：

`repetitions x = concat $ map tail $ filter (\x -> length x > 1) $ List.group $ word $ filter (\c -> c >= 'a' && c <= 'z' || c>='A' && c <= 'Z' || c==' ') x`

用 Data.Char 中的函数替换字符范围，合并 concat 和 map：

`repetitions x = concatMap tail $ filter (\x -> length x > 1) $ List.group $ word $ filter (\c -> isAlpha c || isSeparator c) x`

使用无点样式的部分和柯里化来简化`(\x -> length x > 1) to ((>1) . length)`. 这与从右到左管道中的`length`(>1) （部分应用的运算符或*section ）结合。*

`repetitions x = concatMap tail $ filter ((>1) . length) $ List.group $ word $ filter (\c -> isAlpha c || isSeparator c) x`

消除显式 "x" 变量以使整体表达式无点：

`repetitions = concatMap tail . filter ((>1) . length) . List.group . word . filter (\c -> isAlpha c || isSeparator c)`

现在整个函数，从右到左读取，是一个管道，它只过滤字母或分隔符，将其拆分为单词，将其分成组，过滤具有超过 1 个元素的组，然后将剩余的组减少到第一个每个元素。

# javascript - 初学者帮助 - 此代码属于哪里？

> ID：402403
> 
> 赞同：5
> 
> 时间：2008-12-31T06:19:24.680
> 
> 标签：javascript, firefox, xpcom

我正在尝试开发一个 Firefox 扩展，它将额外的 HTTP 标头字段插入到传出的 HTTP 请求中（以与我同时开发的 apache 扩展接口）。

虽然我了解扩展的各个组件并了解 Web 上提供的基本教程，但我发现从“Hello World”教程扩展到开发完整的扩展很困难。

我想要适应我的目的的示例代码显示在[设置 HTTP 请求标头](https://developer.mozilla.org/En/Setting_HTTP_request_headers)的底部。

我想知道，这个代码应该放在扩展层次结构中的什么位置，以及如何调用/构造/激活这样的代码，它会在扩展初始化时自动运行吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T12:26:38.030

对于基本扩展，您可以将代码放在扩展的 chrome/content 目录中。您可以使用[覆盖](https://developer.mozilla.org/en/XUL_Overlays)将此内容挂接到 Firefox 中。虽然覆盖通常是 xul 内容（按钮等），但它们可以是任何东西。包括一个脚本标签，它会加载你的 Javascript 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T02:19:17.777

该代码是一个 XPCOM 组件并进入一个`components/<some name>.js`文件。

如果你想深入了解 XPCOM 组件，你应该阅读它，但是是的，.js 文件`components`是在启动时加载的。此类文件包含注册代码（从`var myModule = {`该示例中的行开始），它告诉 Firefox 文件中定义的组件是否可根据请求使用，或者是否应该自动实例化。

在该示例中，您可以看到组件已注册以收到应用程序启动的通知：

```
catMgr.addCategoryEntry("app-startup", this.myName, this.myProgID, true, true); 
```

并且在处理应用程序启动通知时，它会为 http-on-modify-request 通知注册自己：

```
os.addObserver(this, "http-on-modify-request", false); 
```

# java - JNI 的用处

> ID：402408
> 
> 赞同：8
> 
> 时间：2008-12-31T06:26:10.673
> 
> 标签：java, interop, java-native-interface

我已经做了几年Java 开发人员，听说你可以用JNI 做一些非常有用和强大的事情。我不知道我是否只是不需要使用它，或者它是否与我不太相关；但我根本不用碰它。

我想知道 Java 这方面的用处是什么。例子会很棒。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-31T06:51:45.350

这是非常有用的。我可以看到使用 JNI 的两个主要原因（可能还有更多）。

1.  表现。如果您有一段代码，其中 Java 运行时出于某种原因无法降低其性能。您可以在本机代码中实现该函数并从 Java 中调用它。*如果您确实*需要，这允许您手动调整实现。这可能是最不常见的原因，Java 通常表现得很好。

2.  访问操作系统特定的 API。这是一个大人物。我有一个案例，我需要用 Java 做一些事情，但也需要访问 Java 根本无法提供的东西。就我而言，它是 UNIX 域套接字。由于（正如您可以从名称中看出的那样）它们是 UNIX 特定的，因此没有标准的 Java 方法来使用它们。因此，我在 C 中创建了一个类，该类在它们周围充当包装器，并使用 JNI 访问它。中提琴，问题解决了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T08:45:26.307

我为 iSeries 编写了一个扩展的 JNI 层来访问 DB2、用户队列、数据队列和一些其他 OS/400 细节。如果没有 JNI，我们在 iSeries 上的大部分系统都是不可能的。所以，是的，JNI 有它的位置，当你需要它时，你*真的*需要它。

它相对困难（仅次于纯 Java），但功能强大且不可怕。

此外，每当我查看一些 JNI 代码时，我也会考虑使用[JNA](https://github.com/twall/jna/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T06:52:25.410

我能想到一些用途：

1.  与没有 Java 对应物的现有低级 (C/C++) API 集成
2.  与未通过可用 Java API 公开的系统方面集成（直接硬件访问等）

有人可能会说它对于创建高度优化的代码部分很有用，但是使用现代 JVM，您会变得非常快，使用 JNI 的复杂性可能会超过您可能看到的任何性能优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T08:46:20.407

绑定到 FFMPeg 用于（该死的几乎任何）视频/音频格式的 C 解码有一些用途。

还有 JNA，这让您感觉像是在使用库本身。从将所有内容传递给 Java 开发人员来管理的角度来看，这“更容易”，而从某种意义上说，这更“容易”，因为您必须弄清楚结构映射并做很多繁重的工作才能让所有指针等通过正确。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T08:52:19.427

我们需要围绕在 Suse Linux 上运行的传统 C 应用程序包装新 UI。JNI 是完成这项工作的完美工具。

总的来说，我认为 JNI 与 Java 的“一次编写，随处运行”的概念相矛盾。但是，在某些用例中 JNI 可能很有用。

# actionscript-3 - flexunit addAsync 链接

> ID：402415
> 
> 赞同：2
> 
> 时间：2008-12-31T06:32:04.453
> 
> 标签：actionscript-3, flexunit

[出于某种原因，当我尝试这样做时，本文](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showDetails&postId=6882&productId=2&loc=en_US)中描述的 flexunit 测试中的 addAsync 链接完全无法工作。

```
public function testWhatever():void {
    var cont:EventDispatcher = new EventDispatcher();
    cont.addEventListener("continue", addAsync(verifyFirst, 1000));
    cont.dispatchEvent(new Event("continue"));
}

private function verifyFirst(e:Event):void {
    var cont:EventDispatcher = new EventDispatcher();
    cont.addEventListener("continue", addAsync(verifySecond, 1000));
    cont.dispatchEvent(new Event("continue"));
}

private function verifySecond(e:Event):void {
    assertTrue(true);
} 
```

如果我运行这个测试，verifyFirst 会被调用，但 verifySecond 不会。我假设这是 flexunit 中的一个错误......有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-01T17:57:40.323

我做了更多的研究，发现这确实是 flexunit 中的一个错误，它看起来会在下一个版本中[修复。](https://bugs.adobe.com/jira/browse/FXU-19)我发现的解决方法是改为使用`Application.application.callLater`来调度第二个事件。

```
private function verifyFirst(e:Event):void {
    var cont:EventDispatcher = new EventDispatcher();
    cont.addEventListener("continue", addAsync(verifySecond, 1000));
    Application.application.callLater(cont.dispatchEvent,
       [new Event("continue")]);
} 
```

这个问题的灵感来自于在 Flash 的事件队列中的所有内容都被处理后检查对象状态的尝试。我发现了一种更简单的方法来完成此操作而不会弄乱`EventDispatcher`s。

当您希望处理事件队列时，请在测试的第一部分结束时进行以下调用。

`Application.application.callLater(addAsync(phaseTwo, 1000, [`*参数...*`]), [null]);`

`phaseTwo`具有以下签名的功能。

`private function phaseTwo(e:Event, args:Array):void`

`e`将传递一个`null`对象。这是与 兼容所必需的`addAsync`。

# ruby - 使用 Shoes 并通过 https 下载会产生 ssl 错误

> ID：402427
> 
> 赞同：1
> 
> 时间：2008-12-31T06:47:00.367
> 
> 标签：ruby, https, shoes

在鞋子应用程序中，我试图从一些内部网站下载东西。我收到这个错误

```
Error in /tmp/selfgz14214/ruby/lib/net/protocol.rb line 66
undefined method 'closed?' for #<OpenSSL::SSL::SSLSocket:0xb6af94f0> 
```

我收到此代码的上述错误。如果从鞋子中使用，则会出现上述错误。

```
require 'net/http'
require 'net/https'
require 'rexml/document'

class Blogs
  attr_reader :Connection

  def initialize
    @Connection = Net::HTTP::new("someInternalWebSite", 443)
    @Connection.use_ssl = true
  end

  def get_blogs
    doc = REXML::Document.new @Connection.get('/weblogs/feed/entries/atom').body
    blogs = Array.new
    # ----- some crap to parse the blogs
    return blogs
  end

end 
```

请注意，此问题仅在从鞋内跑步时发生。

同样在鞋子中使用内置的下载方法，它不会返回，甚至不会引发启动事件。以下是该代码

```
download "https://internalWebsite/weblogs/feed/entries/atom",
:start => lambda {
  alert "hello"
},
:progress => lambda {
  alert "progress"
},
:finish => lambda {
  alert "finish"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-31T10:46:46.403

我没有使用过（或者确实听说过）鞋子，但是当我在 Ruby 中通过 HTTPS 访问内容时遇到问题时，通常是证书设置不正确。

我在这方面的经验是几年前的事了，但可能值得做一些实验来检查你是否真的可以用该代码建立常规的 SSL 连接。我希望您至少需要告诉它在哪里可以找到客户端证书，或者它根本不需要客户端证书。

我还记得我需要使用 http-access2 而不是常规的 http 库。

正如我所说，我确信自从我尝试这样做以来事情已经发生了变化，但是我发现的与 ssl 连接有关的大多数问题都与证书有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T08:09:39.627

当前版本中，Shoes 不支持 HTTPS。

# c++ - C++ 返回和插入二维数组对象

> ID：402432
> 
> 赞同：2
> 
> 时间：2008-12-31T06:52:29.793
> 
> 标签：c++, arrays, syntax, 2d

我试图从一个较小的二维数组对象返回一个数组数据成员，并试图将数组插入到一个更大的二维数组对象中。但是在尝试这个时，我遇到了两个问题。

第一个问题是我想返回二维数组的名称，但我不知道如何正确地返回二维数组名称。

这就是我的二维数组数据成员的样子

```
私人的：
intpieceArray[4][4];
// 2D 较小的数组

```

我想将此数组返回到一个函数中，但这会导致编译器错误：

```
int Piece::returnPiece()
{
    返回片数组；//无效
    // 返回二维数组名
}

```

我厌倦了使用这种返回类型并且它起作用了：

```
int Piece::returnPiece()
{
    返回片数组[4][4]；
}

```

但我不确定这是否是我想要的，因为我想返回数组及其所有内容。

另一个问题是 InsertArray() 函数，我将 returnPiece() 函数放在 InsertArray() 的参数中。

InsertArray() 的问题是参数，下面是它的代码：

```
void Grid::InsertArray( int arr[4][4] ) //编译器接受，但不起作用
{
    for(int i = 0; i < x_ROWS ; ++i)
    {
         for (int j = 0; j < y_COLUMNS ; ++j)
         {
             平方[i][j] = arr[i][j];
         }
    }
}

```

问题是它不接受我的 returnPiece()，如果我删除“[4][4]”，我的编译器不接受。

大多数这些都是语法错误，但我该如何解决这些问题呢？

1.  在 returnPiece() 中返回整个pieceArray
2.  InsertArray() 中参数的正确语法
3.  InsertArray() 的参数接受 returnPiece()

这三个是我需要帮助的主要问题，并且在我尝试使用指针指针方法时遇到了同样的问题。有谁知道如何解决这三个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T07:12:36.727

在传递数组时，您必须决定是否要制作数组的副本，或者是否只想返回指向数组的指针。对于返回数组，您不能（轻松）返回副本 - 您只能返回指针（或 C++ 中的引用）。例如：

```
// Piece::returnPiece is a function taking no arguments and returning a pointer to a
// 4x4 array of integers
int (*Piece::returnPiece(void))[4][4]
{
    // return pointer to the array
    return &pieceArray;
} 
```

要使用它，请像这样调用它：

```
int (*arrayPtr)[4][4] = myPiece->returnPiece();
int cell = (*arrayPtr)[i][j];  // cell now stores the contents of the (i,j)th element 
```

请注意类型声明和使用它之间的相似性——括号、取消引用运算符`*`和方括号位于相同的位置。

你的声明`Grid::InsertArray`是正确的 - 它有一个参数，它是一个 4x4 整数数组。这是按值调用：无论何时调用它，都会复制 4x4 数组，因此您所做的任何修改都不会反映在传入的数组中。如果您想使用按引用调用，您可以将指针传递给数组：

```
// InsertArray takes one argument which is a pointer to a 4x4 array of integers
void Grid::InsertArray(int (*arr)[4][4])
{
     for(int i = 0; i < x_ROWS; i++)
     {
         for(int j = 0; j < y_COLUMNS ; j++)
             squares[i][j] = (*arr)[i][j];
     }
} 
```

这些带有指向多维数组的指针的类型声明很快就会变得非常混乱。我建议`typedef`像这样为它制作一个：

```
// Declare IntArray4x4Ptr to be a pointer to a 4x4 array of ints
typedef int (*IntArray4x4Ptr)[4][4]; 
```

然后你可以声明你的函数更具可读性：

```
IntArray4x4Ptr Piece::returnPiece(void) { ... }
void Grid::InsertArray(IntArray4x4Ptr arr) { ... } 
```

您还可以使用[cdecl](http://gd.tuwien.ac.at/linuxcommand.org/man_pages/cdecl1.html)程序来帮助破译复杂的 C/C++ 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T06:58:26.537

似乎您需要阅读更多关于 C++ 中的指针以及按引用传递与按值传递的信息。

您的 returnPiece 方法被定义为返回单个单元格的值。给定索引（例如，[4][4]），您将返回该单元格内容的副本，因此您将无法更改它，或者更准确地说，更改它会更改副本。

我相信有人会给你正确的语法，但我真的建议学习这些东西，否则你可能会使用你得到的代码不正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T07:07:01.217

这是我的做法：

```
类数组 {
  上市：

    大批（） {
      对于 (int i = 0; i < 4; ++i)
      {
         对于 (int j = 0; j < 4; ++j)
         {
            (*这个)(i, j) = 0;
         }
      }
    }

    int &operator()(int i, int j)
    {
      返回片数组[i][j]；
    }

  私人的：
    intpieceArray[4][4];
};

```

然后，您可以执行以下操作：

```
  数组 x; // 创建 4x4 数组
  x(1, 2) = 3; // 修改元素

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-01T06:01:04.373

在*Piece::pieceArray*中，*Adam Rosenfield 的* **arrayPtr**的问题可能会从您的下方发生变化。（按引用复制与按值复制。）

 *按值复制效率低下。但是，如果您真的想这样做，那就作弊：

```
struct FOO { int  piece [4][4]; };

FOO Piece::returnPiece()
{
  FOO f;
  memcpy( f.piece, pieceArray, sizeof(pieceArray) );
  return f;
}

void Grid::InsertArray( const FOO & theFoo )
{
  // use theFoo.piece[i][j]
} 
```

当然，更好、更面向对象的解决方案是让*returnPiece()*创建并返回一个*Piece*或*Array*对象。（正如*胡安*建议的那样……）

# memcached - 用于停止密钥过期的 Memcached 设置

> ID：402438
> 
> 赞同：3
> 
> 时间：2008-12-31T06:55:51.893
> 
> 标签：memcached

我想知道 Memcached 是否有任何方法可以停止其 LRU 键集合，以便我可以找到分配给 memcached 的给定内存在什么时候已满。

我不希望 memcached 在空间不足时刷新旧键。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T06:59:26.723

使用 -M 开关，当内存耗尽时 memcached 将返回错误而不是删除项目。

例子：

```
memcached -d -m 1000 -M 
```

这运行 memcached 守护进程，最大内存为 1000 MB。消耗完 1000 MB 时会返回错误。

# text - 关于“自动文本摘要器（基于语言）”

> ID：402440
> 
> 赞同：2
> 
> 时间：2008-12-31T06:56:57.430
> 
> 标签：text, nlp, linguistics, summarization

我将“自动文本摘要（语言方法）”作为我最后一年的项目。我已经收集了足够多的研究论文并浏览了它们。我仍然不太清楚“如何去做”的事情。基本上我找到了“AUTOMATIC TEXT SummariZER (statistical based)”，发现它比我的项目要容易得多。我的项目指南告诉我不要选择这个（基于统计的）并选择基于语言的。

任何曾经从事过甚至听说过此类项目的人都会知道，总结任何文档仅意味着对每个句子进行评分（通过某种涉及某些特定算法的方法），然后选择得分超过阈值分数的句子。现在这个项目最困难的部分是选择合适的算法进行评分，然后再实施。

我有中等的编程技能，并且想用 JAVA 编写代码（因为在那里我会得到很多 API，从而减少开销）。现在我想知道对于我的项目，我应该使用什么方法和算法。还有如何实现它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-08-27T13:17:54.053

[使用词法链进行文本摘要（微软研究院）](http://research.microsoft.com/en-us/um/people/cyl/download/papers/lexical-chains.pdf)

不同算法的分析：[DasMartins.2007](http://www.ark.cs.cmu.edu/LS2/images/9/90/DasMartins.2007.pdf)

文档中最重要的部分：

> • Nenkova (2005) 分析说，没有任何系统可以超过具有统计学意义的基线。
> • 惊人的结果！

**请注意，语言**方法有两个不同的细微差别：

*   语言评分系统（这里都清楚）
*   语言生成（重写句子以构建摘要）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-02T23:07:56.997

自动总结是一个相当复杂的领域——首先尝试获得你的 Java 技能，以及你对使用机器学习的统计 NLP 的理解。然后，您可以通过构建一些实质性的东西来工作。评估您的解决方案并确保您已经具体定义了您的测量变量以及您如何进行评估。否则，你的项目注定要失败。对于最后一年的本科生来说，这通常被认为是一个高风险的项目，因为他们往往无法正确掌握原则，然后以一种不正确的方式实施，然后他们的评估措施都没有明确定义，没有反思自己的工作清楚。我的建议是专注于一个领域而不是多个领域的摘要，因为您可以拥有单文档和多文档摘要。你的项目越多样化，你获得好成绩的可能性就越小。保持重点和深入。评估其他人的工作，然后评估您决定采取的过程和结果。

阅读材料： -Jurafsky 关于 NLP 的书，后面有关于总结和 QA 的部分。- inderjeet mani 在文本摘要方面的进步非常好

了解术语权重、基于质心的摘要、对数似然比、连贯关系、句子简化、最大边际相关性、冗余以及重点摘要实际上是什么。

您可以使用有监督或无监督方法以及混合方法进行尝试。语言是一种更安全的选择，这就是为什么建议您采用这种方法的原因。尝试在语言上进行尝试，然后建立统计数据以混合您的解决方案。将其作为练习来学习算法的理论和实际意义，并建立在您的知识基础上。因为毫无疑问，您必须向评审团解释和捍卫您的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T07:14:24.210

如果你真的读过那些研究论文和研究书籍，你可能知道什么是已知的。现在由您在 Java 应用程序中实现这些研究论文和研究书籍的知识。或者你可以通过一些创新/发明来扩展人类知识。如果你确实扩展了人类知识，你就成为了一名真正的科学家。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T07:59:57.350

请在以下两个主要方面使您的问题更具体：

1.  项目定义：你的项目的目标是什么？输入单元是单个文档吗？文件清单？你打算让你的程序使用机器学习吗？输出是什么？你将如何衡量成功？
2.  你的背景知识：你打算使用语言而不是统计方法。你有解析自然语言的背景吗？在语义表示中？我认为其中一些问题很棘手。我问他们是因为我在学习过程中花了太多时间试图回答类似的问题。一旦你把这些整理好，我也许能给你一些指示。[Mani 的“自动摘要”](https://rads.stackoverflow.com/amzn/click/com/1588110605)看起来是一个好的开始，至少是介绍性章节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-25T16:01:44.470

几年前，作为欧盟 FASiL 项目的一部分，谢菲尔德大学在[自动电子邮件摘要方面做了一些工作。](http://portal.acm.org/citation.cfm?id=1220498)

# javascript - 使用 javascript 使用向上和向下箭头键访问 Div 内容

> ID：402448
> 
> 赞同：1
> 
> 时间：2008-12-31T07:05:23.387
> 
> 标签：javascript, html, keyboard

我有一个包含 4 个子 Div 标签的 Div 标签

```
 <Div id="Parent">
     <div id="childOne">ChildOne </div>
     <div id="childOne">ChildTwo </div>
     <div id="childOne">ChildThree </div>
     <div id="childOne">ChildFour </div>
  </Div> 

```

现在我想通过 Javascript 使用向上和向下箭头键访问这些子 div 上面的 div 是在单击 TextBox 时显示的。我希望用户可以选择任何子 div，并且它的选定值出现在 TextBox 中。我通过将 onClick 事件附加到每个 childDiv 来实现最终结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T10:09:00.957

这是一个帮助您入门的免费图书馆解决方案。

您可能希望添加在文本框获得或失去焦点时隐藏和显示 div 的事件。也许 [esc] 应该清除选择？（我没有在ie中测试过）

```
<style>div.active{ background: red }</style>

<input type="text" id="tb">

<div id="Parent">
     <div id="childOne">ChildOne </div>
     <div id="childOne">ChildTwo </div>
     <div id="childOne">ChildThree </div>
     <div id="childOne">ChildFour </div>
</div>
<script type="text/javascript">

function autocomplete( textBoxId, containerDivId ) {
    var ac = this;
    this.textbox     = document.getElementById(textBoxId);
    this.div         = document.getElementById(containerDivId);
    this.list        = this.div.getElementsByTagName('div');
    this.pointer     = null;

    this.textbox.onkeydown = function( e ) {
        e = e || window.event;
        switch( e.keyCode ) {
            case 38: //up
                ac.selectDiv(-1);
                break;
            case 40: //down
                ac.selectDiv(1);
                break;
        }
    }

    this.selectDiv = function( inc ) {
        if( this.pointer !== null && this.pointer+inc >= 0 && this.pointer+inc < this.list.length ) {
            this.list[this.pointer].className = '';
            this.pointer += inc;
            this.list[this.pointer].className = 'active';
            this.textbox.value = this.list[this.pointer].innerHTML;
        }
        if( this.pointer === null ) {
            this.pointer = 0;
            this.list[this.pointer].className = 'active';
            this.textbox.value = this.list[this.pointer].innerHTML;
        }
    }
} 

new autocomplete( 'tb', 'Parent' );
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T07:16:58.573

您是否在寻找所谓的[自动完成](http://www.javascript-examples.com/autocomplete-demo/)或建议？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T07:37:30.857

您肯定在寻找“自动建议/自动完成”如果您想在纯 javascript 中完全实现，这是相当耗时的，但是是的，您可以使用 strager 中的示例开始。

我建议改用[JQuery](http://jquery.com/)。JQuery 有一个非常好的[自动完成插件](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)，您可以使用它。几天前我刚刚在我的一个项目中实施，它似乎工作正常。

在制作软件时必须记住一句重要的谚语——“不要试图重新发明轮子”。

如果其他程序员已经这样做了，并且他们很乐意分享，使用它，并感谢他们。

干杯!

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-31T07:08:59.370

你是什​​么意思“用箭头键访问它们”？每个 div 中都有文本......它们不包含任何交互元素，因此键盘在这里没有相关性。也许您需要详细说明您的问题？

# delphi - CBuilder/Delphi 的 HTML 编辑器

> ID：402455
> 
> 赞同：5
> 
> 时间：2008-12-31T07:12:27.430
> 
> 标签：delphi, components, c++builder

我需要为 C++Builder 5 找到基本的 WYSIWYG HTML 编辑器组件，让用户创建一些我将粘贴到现有 HTML 页面模板中的简单文本。只是对创建链接、添加图像、使用标题/粗体/斜体的简单支持。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T07:40:43.817

您可以将 TWebBrowser 拖放到表单上并在其上启用设计模式，如下所示：

```
// Delphi code..
(WebBrowser1.Document as IHTMLDocument2).designMode := 'on'; 
```

执行上述行后，页面将是可编辑的。您可以键入额外的文本、删除等。如果您想将选择设置为粗体或插入图像，您将不得不添加一些按钮来对其进行编程。很酷的事情是，您可以从 Delphi（或您的情况下的 C++ 构建器）执行此操作，也可以在页面上添加 javascript 进行编辑。

页面的内容可以从

```
(WebBrowser.Document as IHTMLDocument2).body.innerHTML; 
```

请记住 (WebBrowser.Document as IHTMLDocument2) 可能为零。

* * *

无论如何，我可以想象周围有一些组件可以为您完成所有工作，这可能是比重新发明轮子更好的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T13:19:01.510

我会推荐[TRichView](http://trichview.com/)，因为它具有世界级的支持和深厚的功能集。虽然它不是真正的“HTML”编辑器，但它确实支持导出到 HTML 的能力，甚至在必要时生成适当的 CSS 样式。我用它来处理我们主要产品的电子邮件部分，效果很好。在内部，存储要么是 RTF（扩展以更好地支持图像），要么是专有格式。有很多简单的编辑器示例可以轻松满足您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-17T20:49:48.493

在 C++ Builder 中，它会是这样的：

（wb 是一个 TCppWebBrowser）

```
//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop
#include "mshtml.h"

#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "SHDocVw_OCX"
#pragma resource "*.dfm"
TForm1 *Form1;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm1::btnNavigateAndEditClick(TObject *Sender)
{
        wb->Navigate((WideString)"www.google.com");
        while (wb->Busy)
                Application->ProcessMessages();

        if (wb->Document)
        {
                IHTMLDocument2 *html;
                wb->Document->QueryInterface<IHTMLDocument2>(&html);
                html->put_designMode(L"On");
                html->Release();
        }
}
//---------------------------------------------------------------------------
void __fastcall TForm1::btnInsertImageClick(TObject *Sender)
{
    if (wb->Document)
    {
          IHTMLDocument2 *html;
          wb->Document->QueryInterface<IHTMLDocument2>(&html);
          VARIANT var;
          VARIANT_BOOL receive;
          html->execCommand(L"InsertImage",true,var, &receive);
          html->Release();
    }
}
//---------------------------------------------------------------------------
void __fastcall TForm1::btnGetHtmlClick(TObject *Sender)
{
        if (wb->Document)
        {
                IHTMLDocument2 *html;
                wb->Document->QueryInterface<IHTMLDocument2>(&html);
                IHTMLElement *pElement;
                html->get_body(&pElement);
                pElement->get_parentElement(&pElement);
                wchar_t *tmp;
                pElement->get_outerHTML(&tmp);
                Memo1->Lines->Text = tmp;
                pElement->Release();
                html->Release();
        }
}
//--------------------------------------------------------------------------- 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T13:50:18.497

[http://www.bsalsa.com/](http://www.bsalsa.com/)

提供一组免费的`EmbeddedWebBrowser`组件，其中包含一个编辑设计器组件，您可以将其链接到`EmbeddedBrowser`窗口以控制设计模式，并将编辑控件保存到文件、插入链接、图像等...

似乎运作良好！

# java - 我在哪里可以找到 Java JMF 教程

> ID：402459
> 
> 赞同：3
> 
> 时间：2008-12-31T07:15:08.283
> 
> 标签：java, video, webcam, jmf

我想了解从网络摄像头播放视频的基本课程

我也想玩视频缓冲区像素

我在哪里可以找到可以帮助我实现这一目标的 Java JMF 教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-11T18:36:37.117

在第一次尝试该框架时，我非常喜欢[使用 JMF](http://www.javaworld.com/jw-04-2001/jw-0406-jmf1.html) 2 部分（[此处为第二部分）系列的 Program 多媒体。](http://www.javaworld.com/javaworld/jw-05-2001/jw-0504-jmf2.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T07:24:41.960

[JMF API](https://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/apidocs/)

[http://www.deitel.com/articles/java_tutorials/20060422/PlayingVideowithJMF/](http://www.deitel.com/articles/java_tutorials/20060422/PlayingVideowithJMF/)

# iphone - 可以从另一个 iPhone 应用程序自动生成一个 iPhone 应用程序吗？

> ID：402470
> 
> 赞同：0
> 
> 时间：2008-12-31T07:30:41.200
> 
> 标签：iphone, cocoa-touch, code-generation

如题; 有什么功能可以实现这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T21:42:53.583

官方，没有。官方应用程序必须在 OS X 机器上编译和签名。

在实践中，有点 - 如果你不介意越狱。对于越狱手机，可以在 iPhone 上运行 gcc 和签名工具。因此，在越狱手机上，您可以拥有一个生成新应用程序的应用程序。不过，Apple 不会让你在 App Store 中销售这样的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T08:15:03.810

我会看一下引用 SDK 的[链接：](http://jerakeen.org/notes/2008/11/iphone-local-web-applications/)

> 3.3.2\. [..] 除了由 Apple 发布的 API 和内置解释器解释和运行的代码外，不得在应用程序中下载和使用任何解释代码。

和

> 3.3.3 未经 Apple 事先书面批准，应用程序不得通过 App Store 以外的分发机制提供、解锁或启用其他特性或功能。

在这两个限制之间，我认为动态创建任何类型的应用程序几乎是不可能的（文章中提到的纯 JavaScript/HTML 应用程序概念可能除外）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T12:40:25.910

理论上可能，实际上没有。如果您想在 App Store 中出售它，请使用双编号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-01T14:50:48.347

如果您的 iPhone 已越狱，请从 Cydia 安装“CallMe”。这正是您想要的：它会生成带有联系人图标的小型应用程序，如果您启动其中一个小型应用程序，它将启动电话应用程序并拨打联系人的电话号码。

# ruby-on-rails - Django，Rails 路由...点？

> ID：402474
> 
> 赞同：6
> 
> 时间：2008-12-31T07:34:35.513
> 
> 标签：ruby-on-rails, django, routing, url-mapping

我是网络开发（和大学）的学生，所以如果这听起来很幼稚和冒犯，我很抱歉，我当然不是那个意思。我的经验是使用 PHP 和一个即将到来的小型项目（一个美化的轮班日历），我希望学习一个更高级别的框架来减轻代码负担。到目前为止，我研究了 CakePHP Symfony Django 和 Rails。

使用 PHP，URL 非常简单地映射到文件，并且“正常工作”。服务器速度很快，而且很直观。但是对于所有这些框架，通过使 URL 映射到不同的函数并将参数路由到不同文件中的不同变量来“美化” URL。

我正在阅读的“The Rails Way”一书承认这很慢，并且是大型项目中大多数性能问题的原因。我的问题是“为什么首先要有它？”？url-maps-to-a-file 范例（或 mod_rewrite 到单个文件）中是否存在需要正则表达式和复杂路由方案的特定点？我是否因为不使用它们而错过了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T07:49:30.600

*   URL 应该易于记忆和表达。并且用户应该知道当她看到该 URL 时会发生什么。将 URL 直接映射到文件并不总是允许这样做的。
*   您可能希望对显示的相同或至少相似的信息使用不同的 URL。如果您的服务器强制您使用 1 url <-> 1 文件映射，则需要创建其他文件，其所有功能都是重定向到其他文件。`mod_rewrite`或者你使用比Rails 的 url 映射更容易的东西。
*   在我的一个应用程序中，我使用看起来像`http://www.example.com/`*username的 URL*`/`*一些额外的东西*`/`。这也可以用 . `mod_rewrite`，但至少对我来说，在 django 项目中配置 url 比在我运行应用程序的每个 apache 实例中更容易。

只是我的2美分...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-02T12:52:44.283

其中大部分已经被覆盖，但还没有人提到 SEO。谷歌非常重视 URL 本身，如果该 URL 是 widgets.com/browse.php?17，那么这对 SEO 不是很友好。如果您的 URL 是 widgets.com/products/buttons/ 这将对您的按钮页面排名产生积极影响

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-02T12:33:37.970

将应用程序代码存储在 Web 服务器的文档树中是一个安全问题。

*   错误配置可能会意外向访问者泄露源代码
*   通过安全漏洞注入的文件可以立即被 HTTP 请求执行
*   备份文件（例如由文本编辑器创建）可能会显示代码或在配置错误的情况下可执行
*   管理员未能删除的旧文件可能会显示意外功能
*   必须明确拒绝对库文件的请求
*   URL 揭示了实现细节（使用了哪种语言/框架）

请注意，只要其他事情没有出错，以上所有内容都不是问题（其中一些错误即使单独出现也会很严重）。但是总有一些事情出错，并且有额外的防线是好的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-01T03:08:54.643

Django URL 也是非常可定制的。使用像 Code Igniter（我不确定 Rails）这样的 PHP 框架，你会被迫进入 /class/method/extra/ URL 结构。虽然这可能对小型项目和应用程序有好处，但一旦您尝试使其更大/更具动态性，您就会遇到问题并且必须重写一些框架代码来处理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T07:53:22.497

此外，路由器类似于`mod_rewrite`，但更灵活。它们不是正则表达式绑定的，因此对于不同类型的路由有更多选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T10:42:34.103

取决于你的应用程序有多大。我们有一个相当大的应用程序（50 多个模型），它不会给我们带来任何问题。当它发生时，我们会担心它。

# accessibility - 实用主义和可访问性

> ID：402478
> 
> 赞同：7
> 
> 时间：2008-12-31T07:37:41.043
> 
> 标签：accessibility

可访问性在什么时候变得不实用？那个阴暗的灰色区域是由什么决定的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T07:51:37.350

我的猜测是，随着立法机构的追赶，我们离法律规定的无障碍要求不远了，就像实体建筑、工作场所等必须遵守无障碍要求一样。这样的立法往往会消除疑虑。

由于可访问性通常意味着向尽可能多的人提供服务，因此没有一个网站是普遍可访问的，即使没有涵盖所有语言的优点。坚持使用几种主要语言或国家是很常见的，尽管为扩展而设计是件好事（亚马逊就是这样做的）。

至于残疾，有时取决于站点及其提供的服务。

我个人认为，随着人口老龄化，解决使用辅助设备的低视力客户是有意义的，因此基于文本且闪存/脚本较少的网站很有意义。话虽如此，使用小型移动设备的用户也有类似的需求，因此您可以捕捉两只鸟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T16:40:42.417

这取决于您的软件。使文字处理器易于访问比使最新的第一人称射击游戏易于访问更为必要。作为一个盲人计算机用户，如果 Microsoft Office 无法正常工作，我会很生气，但我不在乎我是否无法在 Quake III 中导航菜单。它还取决于您的客户：如果您向政府销售产品，那么将强制要求可访问性（至少在美国是这样）。但是，大多数非政府公司并不强制要求可访问性，因此您可以根据良心、时间限制和预算强制实施的可访问性来摆脱困境。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-10T09:49:56.830

还有另一种反实用主义正在发生：

公司争先恐后地遵守法律条文（例如 508），并将他们能找到的任何容易获得的成果放在一起，只是为了安全起见，但实际上并未应用任何资源来实施可访问性作为**设计**解决方案。

使用 tabindex 和 aria 属性（甚至可能没有必要）为您的 html 增添色彩可以很容易地使您的网站比什么都不做更容易访问，或者更不可用。

这种事情（这并不罕见）在我看来确实是反实用主义的。

# asp.net - ASP.NET：向用户显示后台进程状态

> ID：402481
> 
> 赞同：1
> 
> 时间：2008-12-31T07:39:45.610
> 
> 标签：asp.net

我有一个网页，它将从用户那里输入一个 excel/CSV 文件并从中读取数据并导入到 DB。在插入每条记录时。我只想显示有关插入到用户的记录的详细信息。（例如：A 的客户详细信息正在添加...）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T07:56:22.270

试试这个... 将输出设置为无缓冲 (Response.BufferOutput)，并在您的页面中包含一些 javascript，以根据您认为合适的方式更新 UI。例如，它可能会使用完成百分比或您正在处理的记录的详细信息来更新 SPAN。然后在您的服务器代码中，输出从 Render 覆盖调用 Javascript 函数的 <script> 标记。确保在适当的时间调用 Flush()，并在基本代码渲染后刷新... JS 函数调用应在适当的时间发送并在客户端执行，从而导致更新页面。

例如... 您的 HTML 页面可能如下所示：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication1._Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title></title>
    <script type="text/javascript">
        function UpdateScreen(t) {
            document.getElementById('output').innerHTML = t;
        }
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <div id='output'></div>
    </div>
    </form>
</body>
</html>
<script type="text/javascript">
    UpdateScreen('hello');
</script> 
```

您的代码隐藏将如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Threading;

namespace WebApplication1
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected override void Render(HtmlTextWriter writer)
        {
            Response.BufferOutput = false;

            base.Render(writer);
            Response.Flush();

            for (int i = 0; i < 10; i++)
            {
                Thread.Sleep(1000);
                Response.Write(string.Format("<script type='text/javascript'>UpdateScreen('{0}');</script>", i * 10));
                Response.Flush();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-06T11:36:03.480

我知道这是一个老问题，它的所有者可能很久以前就已经转移了。反正：

建议的解决方案不适用于 ASP.NET MVC。如果你问我，你不问，我会说这不是解决问题的最干净的方法：

*   [这是一个 jQuery 的](https://stackoverflow.com/questions/71590/how-to-display-the-progress-of-a-server-script-in-jquery)，
*   [这是一个 IFrame](http://encosia.com/2007/10/03/easy-incremental-status-updates-for-long-requests/)。

# python - 使用 Python unittest 缓存 setUp() 的结果

> ID：402483
> 
> 赞同：10
> 
> 时间：2008-12-31T07:43:31.610
> 
> 标签：python, unit-testing

我目前有一个 unittest.TestCase 看起来像..

```
class test_appletrailer(unittest.TestCase):
    def setup(self):
        self.all_trailers = Trailers(res = "720", verbose = True)

    def test_has_trailers(self):
        self.failUnless(len(self.all_trailers) > 1)

    # ..more tests.. 
```

这工作正常，但`Trailers()`调用大约需要 2 秒才能运行。鉴于`setUp()`在每个测试运行之前调用它，测试现在需要将近 10 秒来运行（只有 3 个测试函数）

`self.all_trailers`在测试之间缓存变量的正确方法是什么？

删除 setUp 功能，并做..

```
class test_appletrailer(unittest.TestCase):
    all_trailers = Trailers(res = "720", verbose = True) 
```

..有效，但随后它声称“在 0.000 秒内运行 3 次测试”这是不正确的。我能想到的唯一另一种方法是拥有一个 cache_trailers 全局变量（它可以正常工作，但相当可怕）：

```
cache_trailers = None
class test_appletrailer(unittest.TestCase):
    def setUp(self):
        global cache_trailers
        if cache_trailers is None:
            cache_trailers = self.all_trailers = all_trailers = Trailers(res = "720", verbose = True)
        else:
            self.all_trailers = cache_trailers 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-31T07:48:46.467

使用只初始化一次的类成员怎么样？

```
class test_appletrailer(unittest.TestCase):

    all_trailers = None

    def setup(self):
        # Only initialize all_trailers once.
        if self.all_trailers is None:
            self.__class__.all_trailers = Trailers(res = "720", verbose = True) 
```

引用的查找将转到[MRO](http://www.python.org/download/releases/2.3/mro/)`self.all_trailers`中的下一步-- ，该步骤将被初始化。`self.__class__.all_trailers`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T17:25:38.300

建议的解决方案的替代方案是使用功能更强大的测试运行器，例如[Nose](https://nose.readthedocs.io/en/latest/)。使用 Nose，您可以拥有模块级设置功能，这些功能将为测试模块运行一次。由于它与 unittest 完全兼容，因此您无需更改任何代码。

从鼻子手册：

> 鼻子在包、模块、类和测试用例级别支持固定装置，**因此** **可以** **尽可能不频繁**地进行昂贵的初始化。

夹具[在此处详细描述](https://pythontesting.net/framework/nose/nose-fixture-reference/)。当然，除了满足您的用例之外，我还强烈推荐它作为通用测试工具。没有它，我的任何项目都不会离开家。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-04-04T14:16:46.567

如果您使用 Python >= 2.7，则可以使用[`setUpClass`](http://docs.python.org/library/unittest.html#unittest.TestCase.setUpClass)在整个单元测试中只调用一次的方法。

```
import unittest

from trailers import Trailers

class AppleTrailerTestCase(unittest.TestCase):
    @classmethod
    def setUpClass(cls):
        # only initialize all_trailers once
        cls.all_trailers = Trailers(res='720', verbose=True)

    @classmethod
    def tearDownClass(cls):
        # drop the reference explicitly to let the Trailers object be garbage
        # collected
        cls.all_trailers = None

    def test_one(self):
        # ...

    def test_two(self):
        # ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T07:49:55.560

拖车类在做什么？
如果它保持某种状态，那么您**必须**在每次执行单元测试时重置它。

为了解决你的问题，我会使用一个模拟对象——只是模拟 Trailers 的接口，提供一组伪造的数据。

* * *

**更新**：由于 Trailers 仅读取 XML 数据，我会选择像 cdleary 提出的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-02T11:47:56.710

值得一提的是，在 2010 年，Zope/Plone 世界中使用的测试运行程序作为一个单独的模块发布，不出所料地称为[zope.testrunner](http://pypi.python.org/pypi/zope.testrunner)。它支持以“层”的形式缓存设置。看看这个。

# .net - IBM.Data.DB2

> ID：402484
> 
> 赞同：2
> 
> 时间：2008-12-31T07:43:42.703
> 
> 标签：.net, db2

我使用 IBM.Data.DB2 提供程序在 .net c# 中制作了一个小型桌面应用程序，连接到 z/OS 上的 IMB DB2。当我在一台机器上部署这个应用程序时，我遇到了 IBM DB Connect 运行时的问题，然后我发现我必须安装 DB2 Run-Time Client Lite，我就这样做了。现在，当我运行应用程序时，出现错误“错误 [42968][IBM] SQL8002N 连接处理失败；找不到有效的产品许可证。SQLSTATE=42968”

注意：我可以使用 HIS 库连接相同的数据库。

问候 Verybiztalker

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T11:36:18.847

您将无法使用任何*lite*版本访问 z/OS DB2 远程入口点。使用 IBM JDBC 驱动程序，您需要企业版来连接到 z/OS，这几乎可以肯定与使用 C# 相同 - 这是为了保护大型机免受各种客户端的影响，这些客户端没有'企业之神'。

如果您没有有效的许可证，客户端甚至不会尝试连接到大型机。您收到的错误代码和状态与我描述的情况完全匹配。

IBM 非常密切地保护（或者更准确地说，允许他们的客户保护）他们的大型机 DB2 访问。我怀疑这与确保只有企业支持的应用程序才能尝试连接有关。没有正确许可文件的 JDBC 客户端甚至不会让他们的请求出现在大型机 TCP 端口上，它们在客户端被阻止 - 大型机通常对大多数桌面/服务器应用程序来说是关键业务梦想成为:-)。

使用 IBM JDBC 驱动程序，一个单一的 type-4 驱动程序用于访问*所有*DB2 平台（LUW、iSeries、System z 等），但您实际上必须在特定平台的 CLASSPATH 中安装许可证文件，否则您将得到一个例外。

该许可证文件的格式为“db2jcc_cisuz.jar”，其中 cisuz 指定允许访问哪些平台（cu 是最常见的，但它不提供对 iSeries 或 System z 的访问权限）。

您通常必须从 IBM 购买 DB2 Connect 才能获得这些文件，我怀疑 .NET 框架也会出现类似情况。您可能会发现 DB2 Connect 产品具有 .NET 客户端驱动程序以及 JDBC（我没有查看）。寻找该产品的“企业”版，因为标准版不太可能拥有 System z 许可证。

# automation - 如何使用 autoit 识别拖动选择

> ID：402486
> 
> 赞同：0
> 
> 时间：2008-12-31T07:44:38.427
> 
> 标签：automation, autoit

我正在用 autoit 编写一个自动化脚本：[http](http://www.autoitscript.com/autoit3/index.shtml) ://www.autoitscript.com/autoit3/index.shtml 。在此过程中，我需要截取用户选择区域的屏幕截图。

如何使用 Autoit 3 识别鼠标拖动选择操作？我基本上需要一些方法来获取所选矩形的坐标......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-02T06:13:33.553

Autoit 论坛的 rasim 非常友好地用一个工作示例回答了我的这个问题：[http ://www.autoitscript.com/forum/index.php?showtopic=86894&st=0&gopid=623824&#entry623824](http://www.autoitscript.com/forum/index.php?showtopic=86894&st=0&gopid=623824&#entry623824)

```
#include <WinAPI.au3>
#include <WindowsConstants.au3>
#include <Misc.au3>
#include <ScreenCapture.au3>

Global Const $WM_LBUTTONDOWN = 0x0201
Global $hDLL = DllOpen("User32.dll")

Global $Drag = False
Global $aCoord_Start
Global $aCoord_End
Global $iLeft, $iTop, $iRight, $iBottom
Global $sCapture = False

HotKeySet("{Esc}", "_Exit")

Global $pStub_MouseProc = DllCallbackRegister ("_Mouse_Handler", "int", "int;ptr;ptr")

Global $hHookMouse = _WinAPI_SetWindowsHookEx($WH_MOUSE_LL, DllCallbackGetPtr($pStub_MouseProc), _WinAPI_GetModuleHandle(0), 0)

While 1
    If $sCapture Then
        $sCapture = False
        _ScreenCapture_Capture(@ScriptDir & "\Capture.jpg", $iLeft, $iTop, $iRight, $iBottom)
    EndIf
    Sleep(100)
WEnd

Func _Mouse_Handler($nCode, $wParam, $lParam)
    If $nCode < 0 Then Return _WinAPI_CallNextHookEx($hHookMouse, $nCode, $wParam, $lParam)

    Switch $wParam
        Case $WM_LBUTTONDOWN
            $aCoord_Start = MouseGetPos()
        Case $WM_MOUSEMOVE
            If _IsPressed("01", $hDLL) Then $Drag = True
        Case $WM_LBUTTONUP
            $aCoord_End = MouseGetPos()

            If $Drag = True Then
                $Drag = False

                If $aCoord_Start[0] < $aCoord_End[0] Then
                    $iLeft = $aCoord_Start[0]
                    $iRight = $aCoord_End[0]
                Else
                    $iLeft = $aCoord_End[0]
                    $iRight = $aCoord_Start[0]
                EndIf

                If $aCoord_Start[1] < $aCoord_End[1] Then
                    $iTop = $aCoord_Start[1]
                    $iBottom = $aCoord_End[1]
                Else
                    $iTop = $aCoord_End[1]
                    $iBottom = $aCoord_Start[1]
                EndIf

                $sCapture = True
                Return 0
            EndIf
    EndSwitch

    Return _WinAPI_CallNextHookEx($hHookMouse, $nCode, $wParam, $lParam)
EndFunc

Func _Exit()
    DllCallbackFree($pStub_MouseProc)
    _WinAPI_UnhookWindowsHookEx($hHookMouse)
    DllClose($hDLL)

    Exit
EndFunc 
```

# jquery - 使用 Ajax 在 jQuery 中返回数据不起作用

> ID：402503
> 
> 赞同：0
> 
> 时间：2008-12-31T07:58:07.103
> 
> 标签：jquery, ajax, return, extract

我用 Ajax 和 jQuery 开发了代码。我收到了来自 my.php 的响应，我尝试提取响应的值。这里的代码（HTML）：

### 我的.php

```
?php
    echo '<div id="title">My Title </div>';
    echo '<div id="message"> My message </div>';
?> 
```

我尝试提取标题和消息，所以我的代码如下。

```
 <head>
        <script type="text/javascript" src="js/jquery-1.2.6.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                alert("OK");

                $.ajax({
                    type:"POST",
                    url: "my.php",
                    cache:false ,
                    success: function(data){
                        $("#response").html(data);
                        var $response = $(data);
                        var oneval = $response.find('#title').text();
                        var subval = $response.find('#message').text();
                        alert(oneval);
                    }
                });
            });
        </script>
    </head>

    <body>
        <div id="response">
        </div>
    </body>
</html> 
```

...

问题是当我试图提醒时，它不起作用。这个逻辑有什么问题？我应该使用另一个函数来提取标题和消息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T10:44:48.407

好的，去[http://jsbin.com/udige/](http://jsbin.com/udige/)你可以看到它工作。

关键是使用`.filter`，而不是 .find，因为这两个 div 是响应中的根元素。我的错。

基本上做到以下几点：

```
success: function(data){
    $("#response").html(data);
    var $response = $(data);
    var oneval = $response.filter('#title').text();
    var subval = $response.filter('#message').text();
    alert(oneval);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T08:55:39.250

如果响应在您编写时返回，那么我给您的代码将起作用。

您确实需要学习如何使用调试器 ( [Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29) ) 并将断点放入您的代码中，以便您可以使用控制台来测试选择器并查看变量的值等。此外，您真的应该已经回复了原始问题和答案我给出了而不是提出一个全新的问题，特别是因为您甚至没有交叉引用您的原始问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-31T08:02:34.193

尝试改用这个：

```
var oneval = $("#response #title").text();
var subval = $("#response #message").text(); 
```

# python - 如何确定 Python 变量的类型？

> ID：402504
> 
> 赞同：1966
> 
> 时间：2008-12-31T07:58:57.680
> 
> 标签：python, types, unsigned, signed, 16-bit

如何查看变量的类型是无符号 32 位、有符号 16 位等？

我如何查看它？

* * *

## 回答 #1

> 赞同：1817
> 
> 时间：2008-12-31T10:43:07.240

使用[`type()`](https://docs.python.org/library/functions.html#type)内置函数：

```
>>> i = 123
>>> type(i)
<type 'int'>
>>> type(i) is int
True
>>> i = 123.456
>>> type(i)
<type 'float'>
>>> type(i) is float
True 
```

要检查变量是否属于给定类型，请使用[`isinstance`](https://docs.python.org/library/functions.html#isinstance)：

```
>>> i = 123
>>> isinstance(i, int)
True
>>> isinstance(i, (float, str, set, dict))
False 
```

请注意，Python 的类型与 C/C++ 不同，这似乎是您的问题。

* * *

## 回答 #2

> 赞同：505
> 
> 时间：2008-12-31T08:02:04.660

您可能正在寻找*内置函数*。[`type()`](https://docs.python.org/3/library/functions.html#type)

 *请参阅下面的示例，但 Python 中没有像 Java 那样的“无符号”类型。

正整数：

```
>>> v = 10
>>> type(v)
<type 'int'> 
```

*大*正整数：

```
>>> v = 100000000000000
>>> type(v)
<type 'long'> 
```

负整数：

```
>>> v = -10
>>> type(v)
<type 'int'> 
```

字面字符序列：

```
>>> v = 'hi'
>>> type(v)
<type 'str'> 
```

浮点整数：

```
>>> v = 3.14159
>>> type(v)
<type 'float'> 
```

* * *

## 回答 #3

> 赞同：201
> 
> 时间：2015-10-01T11:02:32.097

就是这么简单。你这样做。

```
print(type(variable_name)) 
```

* * *

## 回答 #4

> 赞同：143
> 
> 时间：2016-10-07T16:02:24.543

> # 如何确定 Python 中的变量类型？

因此，如果您有一个变量，例如：

```
one = 1 
```

你想知道它的类型吗？

在 Python 中做任何事情都有正确的方法和错误的方法。这是正确的方法：

## 利用`type`

```
>>> type(one)
<type 'int'> 
```

您可以使用该`__name__`属性来获取对象的名称。（这是您需要使用`__dunder__`名称来获取的少数特殊属性之一 -`inspect`模块中甚至没有它的方法。）

```
>>> type(one).__name__
'int' 
```

## 不要使用`__class__`

**在 Python 中，以下划线开头的名称在语义上不是公共 API 的一部分，用户最好避免使用它们。**（除非绝对必要。）

既然`type`给了我们对象的类，我们应该避免直接得到它。：

```
>>> one.__class__ 
```

这通常是人们在方法中访问对象类型时的第一个想法——他们已经在寻找属性，所以类型看起来很奇怪。例如：

```
class Foo(object):
    def foo(self):
        self.__class__ 
```

不。相反，做类型（自我）：

```
class Foo(object):
    def foo(self):
        type(self) 
```

## 整数和浮点数的实现细节

> 如何查看变量的类型是无符号 32 位、有符号 16 位等？

在 Python 中，这些细节是实现细节。所以，一般来说，我们在 Python 中通常不会担心这个问题。不过，为了满足你的好奇心...

在 Python 2 中，int 通常是一个有符号整数，等于实现的[字](https://en.wikipedia.org/wiki/Word_(computer_architecture))宽（受系统限制）。它通常在 C 中实现为[long](https://docs.python.org/2/library/stdtypes.html#numeric-types-int-float-long-complex)。当整数变得比这更大时，我们通常将它们转换为 Python 长整数（精度不受限制，不要与 C 长整数混淆）。

例如，在 32 位 Python 2 中，我们可以推断 int 是有符号的 32 位整数：

```
>>> import sys

>>> format(sys.maxint, '032b')
'01111111111111111111111111111111'
>>> format(-sys.maxint - 1, '032b') # minimum value, see docs.
'-10000000000000000000000000000000' 
```

在 Python 3 中，旧的 int 消失了，我们只使用 (Python's) long as int，它具有[无限的精度。](https://docs.python.org/3/library/stdtypes.html#numeric-types-int-float-complex)

我们还可以获得一些关于 Python 浮点数的信息，这些浮点数通常在 C中实现为[双精度数：](https://docs.python.org/2/library/stdtypes.html#numeric-types-int-float-long-complex)

```
>>> sys.float_info
sys.floatinfo(max=1.7976931348623157e+308, max_exp=1024, max_10_exp=308, 
min=2.2250738585072014e-308, min_exp=-1021, min_10_exp=-307, dig=15, 
mant_dig=53, epsilon=2.2204460492503131e-16, radix=2, rounds=1) 
```

## 结论

不要使用`__class__`语义上非公开的 API 来获取变量的类型。改为使用`type`。

并且不用太担心 Python 的实现细节。我不必自己处理这方面的问题。你可能也不会，如果你真的这样做，你应该知道足够多，不要寻找这个答案来做什么。

* * *

## 回答 #5

> 赞同：73
> 
> 时间：2008-12-31T08:02:11.493

```
print type(variable_name) 
```

在处理此类问题时，我也强烈推荐使用[IPython交互式解释器。](http://ipython.scipy.org/)它允许您键入`variable_name?`并将返回有关对象的完整信息列表，包括类型和类型的文档字符串。

例如

```
In [9]: var = 123

In [10]: var?
Type:       int
Base Class: <type 'int'>
String Form:    123
Namespace:  Interactive
Docstring:
    int(x[, base]) -> integer 
```

如果可能，将字符串或数字转换为整数。浮点参数将被截断为零（这不包括浮点数的字符串表示形式！）转换字符串时，请使用可选的基数。转换非字符串时提供基数是错误的。如果参数超出整数范围，则会返回一个 long 对象。

* * *

## 回答 #6

> 赞同：57
> 
> 时间：2019-03-09T10:30:20.423

```
a = "cool"
type(a)

//result 'str'
<class 'str'>
or 
do 
`dir(a)` 
to see the list of inbuilt methods you can have on the variable. 
```

* * *

## 回答 #7

> 赞同：41
> 
> 时间：2015-03-18T02:48:04.200

另一种使用方法`__class__`：

```
>>> a = [1, 2, 3, 4]
>>> a.__class__
<type 'list'>
>>> b = {'key1': 'val1'}
>>> b.__class__
<type 'dict'>
>>> c = 12
>>> c.__class__
<type 'int'> 
```

* * *

## 回答 #8

> 赞同：39
> 
> 时间：2017-01-12T01:08:12.507

Python中的简单类型检查示例：

```
assert type(variable_name) == int

assert type(variable_name) == bool

assert type(variable_name) == list 
```

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2013-08-14T06:39:32.000

这可能无关紧要。但是您可以使用[此处](https://stackoverflow.com/questions/2225038/python-determine-the-type-of-an-object "Object type in python")`isinstance(object, type)`提到的检查对象的类型。

* * *

## 回答 #10

> 赞同：25
> 
> 时间：2008-12-31T08:08:06.693

这个问题有点模棱两可——我不确定你所说的“视图”是什么意思。如果您尝试*查询*本机 Python 对象的类型，[@atzz](https://stackoverflow.com/questions/402504/how-to-determine-the-variable-type-in-python#402516)的答案将引导您朝着正确的方向前进。

但是，如果您尝试*生成*具有原始 C 类型语义的 Python 对象（例如`uint32_t`, `int16_t`），请使用该[`struct`](http://docs.python.org/library/struct.html#struct.calcsize)模块。因此，您可以确定给定 C 类型原语中的位数：

```
>>> struct.calcsize('c') # char
1
>>> struct.calcsize('h') # short
2
>>> struct.calcsize('i') # int
4
>>> struct.calcsize('l') # long
4 
```

这也体现在`array`模块中，它可以制作这些低级类型的数组：

```
>>> array.array('c').itemsize # char
1 
```

支持的最大整数（Python 2's `int`）由[sys.maxint](http://docs.python.org/library/sys.html#sys.maxsize)给出。

```
>>> import sys, math
>>> math.ceil(math.log(sys.maxint, 2)) + 1 # Signedness
32.0 
```

还有[sys.getsizeof ，它返回](http://docs.python.org/library/sys.html#sys.getsizeof)*Python*对象在剩余内存中的实际大小：

```
>>> a = 5
>>> sys.getsizeof(a) # Residual memory.
12 
```

对于浮点数据和精度数据，请使用[sys.float_info](http://docs.python.org/library/sys.html#sys.float_info)：

```
>>> sys.float_info
sys.floatinfo(max=1.7976931348623157e+308, max_exp=1024, max_10_exp=308, min=2.2250738585072014e-308, min_exp=-1021, min_10_exp=-307, dig=15, mant_dig=53, epsilon=2.2204460492503131e-16, radix=2, rounds=1) 
```

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2008-12-31T08:10:54.817

你的意思是在[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)中还是使用[ctypes](http://docs.python.org/library/ctypes.html)？

在第一种情况下，您根本不能——因为 Python 没有带符号/无符号的 16/32 位整数。

在第二种情况下，您可以使用`type()`：

```
>>> import ctypes
>>> a = ctypes.c_uint() # unsigned int
>>> type(a)
<class 'ctypes.c_ulong'> 
```

有关 ctypes 及其类型的更多参考，请参阅[官方文档](http://docs.python.org/library/ctypes.html)。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2008-12-31T08:12:34.593

Python没有你描述的那种类型。有两种类型用于表示整数值：`int`，对应于平台在 C 中的 int 类型，以及`long`，它是任意精度整数（即它根据需要增长并且没有上限）。`int`如果表达式`long`产生的结果不能存储在`int`.

* * *

## 回答 #13

> 赞同：15
> 
> 时间：2017-04-09T09:39:06.283

简单，适用于 python 3.4 及以上版本

```
print (type(variable_name)) 
```

Python 2.7 及以上

```
print type(variable_name) 
```

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2008-12-31T14:36:51.540

这真的取决于你的意思是什么级别。在 Python 2.x 中，由于历史原因，有两种整数类型，`int`（约束为`sys.maxint`）和（无限精度）。`long`在 Python 代码中，这应该没什么区别，因为当数字太大时，解释器会自动转换为 long。如果您想了解底层解释器中使用的实际数据类型，那取决于实现。（CPython 位于 Objects/intobject.c 和 Objects/longobject.c。）要了解系统类型，请查看使用 struct 模块的 cdleary 答案。

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2017-09-28T06:58:49.377

对于 python2.x，使用

```
print type(variable_name) 
```

对于 python3.x，使用

```
print(type(variable_name)) 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2021-09-06T05:08:51.163

您应该使用该`type()`功能。像这样：

```
my_variable = 5

print(type(my_variable)) # Would print out <class 'int'> 
```

此函数将查看任何变量的类型，无论是列表还是类。查看此网站了解更多信息：[https ://www.w3schools.com/python/ref_func_type.asp](https://www.w3schools.com/python/ref_func_type.asp)

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-11-27T15:24:44.287

没有 32bit 和 64bit 和 16bit，python 很简单，你不用担心。查看如何检查类型：

```
integer = 1
print(type(integer))  # Result: <class 'int'>, and if it's a string then class will be str and so on.

# Checking the type
float_class = 1.3
print(isinstance(float_class, float))  # True 
```

但如果你真的需要，你可以使用具有无符号整数等类型的[Ctypes库。](https://docs.python.org/3/library/ctypes.html)

[Ctypes 类型文档](https://docs.python.org/3/library/ctypes.html#fundamental-data-types)

你可以像这样使用它：

```
from ctypes import *
uint = c_uint(1)  # Unsigned integer
print(uint)  # Output: c_uint(1)

# To actually get the value, you have to call .value
print(uint.value)

# Change value
uint.value = 2
print(uint.value)  # 2 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2022-03-01T18:56:22.830

Python 是一种动态类型语言。最初创建为字符串的变量可以稍后重新分配给整数或浮点数。口译员不会抱怨：

```
name = "AnyValue"
# Dynamically typed language lets you do this:
name = 21
name = None
name = Exception() 
```

要检查变量的类型，可以使用[type()](https://docs.python.org/3/library/functions.html#type)或[isinstance()](https://docs.python.org/3/library/functions.html#isinstance)内置函数。让我们看看他们的行动：

Python3 示例：

```
variable = "hello_world"
print(type(variable) is str) # True
print(isinstance(variable, str)) # True 
```

`performances`让我们比较一下python3中的两种方法

```
python3 -m timeit -s "variable = 'hello_world'" "type(variable) is int"
5000000 loops, best of 5: 54.5 nsec per loop

python3 -m timeit -s "variable = 'hello_world'" "isinstance(variable, str)"
10000000 loops, best of 5: 39.2 nsec per loop 
```

类型大约慢 40% (54.5/39.2 = 1.390)。

我们可以`type(variable) == str`改用。它会起作用，但这是一个坏主意：

*   `==`当您要检查变量的值时应该使用。我们将使用它来查看变量的值是否等于“hello_world”。但是当我们要检查变量是否为字符串时，is 运算符更为合适。有关何时使用其中一种的更详细说明，请查看[本文](https://switowski.com/blog/checking-for-true-or-false#is-checks-the-identity--checks-the-value)。
*   `==`较慢：`python3 -m timeit -s "variable = 'hello_world'" "type(variable) == str" 5000000 loops, best of 5: 64.4 nsec per loop`

# isinstance 和 type 的区别

速度并不是这两个功能之间的唯一区别。它们的工作方式实际上有一个重要区别：

*   type 只返回对象的类型（它的类）。我们可以使用它来检查变量是否为 str 类型。
*   `isinstance`检查给定对象（第一个参数）是否为：
    *   指定为第二个参数的类的实例。例如，变量是 str 类的实例吗？
    *   或指定为第二个参数的类的子类的实例。换句话说 - 变量是 str 的子类的实例吗？

在实践中意味着什么？假设我们想要一个自定义类，它充当一个列表，但有一些额外的方法。所以我们可以子类化列表类型并在里面添加自定义函数：

```
class MyAwesomeList(list):
    # Add additional functions here
    pass 
```

但是现在如果我们将这个新类与列表进行比较，type 和 isinstance 返回不同的结果！

```
my_list = MyAwesomeList()
print(type(my_list) is list) # False
print(isinstance(my_list, list)) # True 
```

我们得到不同的结果，因为 isinstance 检查`my_list`是列表的实例（不是）还是列表的子类（因为`MyAwesomeList`是列表的子类）。如果您忘记了这种差异，它可能会导致您的代码中出现一些细微的错误。

# 结论

`isinstance`通常是比较类型的首选方法。它不仅更快，而且还考虑了继承，这通常是所需的行为。在 Python 中，您通常想要检查给定对象的行为是否像字符串或列表，不一定是字符串。因此，您可以使用 isinstance，而不是检查字符串及其所有自定义子类。

另一方面，当您想明确检查给定变量是否属于特定类型（而不是其子类）时，请使用`type`. 并且当你使用它时，像这样使用它：`type(var) is some_type`而不是这样：`type(var) == some_type`。

* * *

## 回答 #19

> 赞同：-35
> 
> 时间：2019-02-19T17:21:37.807

只是不要这样做。询问某事的类型本身就是错误的。而是使用多态性。查找或在必要时自行定义对任何可能的输入类型执行所需操作的方法，然后直接调用它而不询问任何内容。如果您需要使用内置类型或第三方库定义的类型，您始终可以从它们继承并使用您自己的派生类。或者您可以将它们包装在您自己的类中。这是解决此类问题的面向对象的方法。

如果您坚持检查确切的类型并在`if`这里和那里放置一些脏 s，您可以使用`__class__`属性或`type`函数来做到这一点，但很快您会发现自己`if`每两到三个提交就用额外的情况更新所有这些 s。以 OO 方式进行操作可以防止这种情况发生，并且只允许您为新类型的输入定义一个新类。

# java - 为什么还可以使用空白构造函数？

> ID：402514
> 
> 赞同：8
> 
> 时间：2008-12-31T08:10:03.677
> 
> 标签：java, coding-style, constructor

我最近在阅读一些 Java 并且遇到了一些新的东西（成语？）：在程序中，具有多个构造函数的类也总是包含一个空白构造函数。例如：

```
public class Genotype {
  private boolean bits[];
  private int rating;
  private int length;
  private Random random;

  public Genotype() {              //  <= THIS is the bandit, this one right here
    random = new Random();
  }

  /* creates a Random genetoype */
  public Genotype(int length, Random r) {
    random = r;
    this.length = length;
    bits = new boolean[length];

    for(int i=0;i<length;i++) {
        bits[i] =random.nextBoolean();
    }
  }

  /* copy constructor */
  public Genotype(Genotype g,Random r) {
    random = r;
    bits = new boolean[g.length];
    rating = g.rating;
    length = g.length;

    for(int i=0;i<length;i++) {
        bits[i] = g.bits[i];
    }

  }
} 
```

第一个构造函数似乎不是“真正的”构造函数，似乎在每种情况下都会使用其他构造函数中的一个。那么为什么要定义这个构造函数呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T08:19:33.580

我不确定您正在阅读的代码是否高质量（我过去曾查看过一些生物信息学代码，遗憾的是它通常不是由专业开发人员编写的）。例如，第三个构造函数不是复制构造函数，通常这段代码存在问题，所以我不会“读太多”。

第一个构造函数是默认构造函数。它只初始化最低限度，并让用户使用 getter 和 setter 设置其余部分。其他构造函数通常是“便利构造函数”，可以帮助创建具有较少调用的对象。但是，这通常会导致构造函数之间的不一致。事实上，最近的研究表明，带有随后调用 setter 的默认构造函数更可取。

在某些情况下，默认构造函数也很重要。例如，某些框架，如 digester（用于直接从 XML 创建对象）使用默认构造函数。JavaBeans 通常使用默认构造函数等。

此外，一些类继承自其他类。当父对象的初始化“足够好”时，您可能会看到默认构造函数。

在这种特定情况下，如果未定义该构造函数，则必须提前了解所有细节。这并不总是可取的。

最后，一些 IDE 会自动生成默认构造函数，可能编写该类的人都害怕消除它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-31T08:39:26.660

对象是可[序列化](http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html)的吗？

> 为了允许序列化不可序列化类的子类型，子类型可以负责保存和恢复超类型的公共、受保护和（如果可访问）包字段的状态。仅当它扩展的类具有可访问的无参数构造函数来初始化类的状态时，子类型才可以承担此责任。如果不是这种情况，则声明类 Serializable 是错误的。将在运行时检测到错误。
> 
> 在反序列化期间，不可序列化类的字段将使用类的公共或受保护的无参数构造函数进行初始化。可序列化的子类必须可以访问无参数构造函数。可序列化子类的字段将从流中恢复

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-31T08:20:27.010

是的，我同意“空白”构造函数不应该总是存在（根据我的经验，初学者经常犯这个错误），尽管在某些情况下空白构造函数就足够了。**但是，如果空白构造函数违反了所有成员在构造后正确实例化**的不变量，则不应使用空白构造函数。如果构造函数比较复杂，最好将构造分成几个protected/private方法。然后根据需要使用**静态**方法或另一个**工厂**类调用受保护的方法进行构造。

我上面写的是理想的场景。但是，像 spring 之类的框架将构造函数逻辑从代码中移除并放入一些 xml 配置文件中。您可能有 getter 和 setter 函数，但可能会从界面中避免使用，[如此处所述](http://sbtourist.blogspot.com/2006/07/avoid-your-getters-and-setters-part-1.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T08:29:15.357

默认构造函数不是强制性的。

如果类中没有定义构造函数，则将自动创建默认（空）构造函数。如果您提供了任何参数化构造函数，则不会自动创建默认构造函数，最好自己创建它。在运行时使用依赖注入和动态代理创建的框架通常需要默认构造函数。因此，这取决于您编写的类的用例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T10:47:37.447

默认构造函数不是功能视图的好习惯。如果对象对方法具有全局可见性，则使用默认构造函数：例如，您希望在 try/catch 中记录对象的实际状态，您可以编写代码

```
MyObejct myObject=null
try{...
}catch(Exception e){
    log.error(myObject);//maybe print null. information?
} 
```

还是你更喜欢

```
MyObejct myObject=new Object();
try{...
}catch(Exception e){
log.error(myObject);//sure print  myobject.toString, never null. More information
} 
```

?

另一种方法是创建一个 EMPTY 对象没有很多逻辑，但是在我看来，实例化一个 NULL 对象是有害的。你可以阅读[这篇文章](http://www.basilv.com/psd/blog/2008/how-to-handle-null-values-in-code)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T10:55:35.903

那不是复制构造函数。基本上，在使用某些框架时，您需要空的构造函数。应该总是有一个空的构造函数，当然，公共的或私有的，但至少它允许你控制类是如何被实例化（或不被实例化）的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T13:51:10.557

我通常编写一个完全初始化对象的构造函数；如果还有其他人，他们都用适当的默认值调用 this(...) 。

对象应在创建时 100% 初始化并准备好使用。

一些框架，例如 Hibernate，需要一个无参数的构造函数。它们与最佳实践相冲突的方式有时让我感到不安。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-23T16:30:04.400

拥有一个默认且空（空白）的构​​造函数会阻止您拥有任何最终字段。这会导致很多可变性，而这些可变性通常是不需要的。

构建器模式允许您混合这两种样式并允许更灵活的初始化，同时通过在工厂后面隐藏一个多参数构造函数来保持不变性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-07T01:26:40.493

对于某些 POJO 类或简单类，当您有时想对使用它们的类进行单元测试时，默认构造函数很有用。您不需要模拟它们，您可以使用默认构造函数新建一个对象并测试值集并从中获取或将它们作为参数传递。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-08T04:07:41.047

您想为扩展此类的类创建一个空白构造函数，并且由于它已经扩展了该类......孩子现在有 super 引用它上面的类，它是父类。如果孩子没有指定 super(stuff)... 里面的东西来引用其他构造函数来使用它，现在将尝试引用空构造函数。

我不确定会出现什么错误我现在正在编写我的第一个父对象关系并且正在这里查找东西哈欢呼。

我想我应该添加一个不是空的构造函数的那一刻，你失去了默认的空构造函数，所以现在扩展类中默认的 super() 将没有指向的东西。当然，如果您创建扩展类来处理 super 通过指定哪些摆脱默认 super() 那么您会回避这一点，但是如果有人想使用您的类并从它扩展而没有意识到没有'当您可以创建一个空集时，它不是一个空集。

这是我的第一篇文章，但想从我的理解中有所收获。

# c#-3.0 - 有没有比 Double.TryParse 更好的方法来测试 C# 中的整数？

> ID：402517
> 
> 赞同：1
> 
> 时间：2008-12-31T08:13:24.577
> 
> 标签：c#-3.0, methods

Double.TryParse 返回一个值，我不需要一个值。我需要能够判断一个字符串是否是数字并且只返回一个布尔值。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-31T08:52:16.213

我会考虑您需要确定的*确切内容。*“是数字”比起初听起来更模糊。考虑以下字符串，以及是否要将它们视为数字：

*   “南”
*   “楠”
*   “无穷”
*   “0.0000000000000000000000000000000000000000000000000001”
*   “1e5”
*   “1e500”
*   “1,000”
*   “+1”

使用`Double.TryParse`（使用 en-GB 文化 - 不要忘记文化问题！）会给你 True，False，True，True（尽管它不可​​表示），True，False。没错，没错。

如果您想知道以后调用 to 是否`Double.TryParse`会成功，在此处调用它将是最准确的解决方案。如果您使用其他标准，则正则表达式可能更合适。您可能使用的标准示例：

*   可以是 + 或 -，但只能在第一个字符中
*   任何字符都可以有一个句点。您可能希望在末尾避免一个 - 应该是“1”。有效吗？
*   除上述以外，所有字符都必须是数字

除了上面的第四个和最后一个示例之外，这将不允许所有示例。

编辑：我现在注意到问题的标题包括“整数”。这几乎将规范检查减少到：

*   你想允许前导零（例如-00012）吗？
*   范围是多少？
*   你只需要小数（而不是十六进制等）吗？
*   你需要接受千位分隔符吗？
*   您对前导/尾随空格的政策是什么？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T08:20:50.287

好吧，您*可以*使用正则表达式，但为什么不直接丢弃 Double.TryParse 中的值并继续前进呢？我认为尝试复制此代码不值得。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T08:18:51.320

一种方法是添加引用`Microsoft.VisualBasic`然后使用`Information.IsNumeric().`

```
using Microsoft.VisualBasic;

...

if (Information.IsNumeric("1233434.0"))
{
    Console.WriteLine("Yes");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T09:40:36.273

我刚刚启动了 Visual Studio Express（2005 年和 2008 年）。Intellisense 表示 Double.TryParse() 的返回值是布尔值。以下内容在有限的测试下对我有用......

```
double res; // you must be under very resource-constrained 
            // conditions if you can't just declare a double
            // and forget about it

if (Double.TryParse(textBox1.Text, out res)) {
    label1.Text = "it's a number";
} else {
    label1.Text = "not a number";
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T08:20:57.667

正则表达式怎么样？

```
string s = "13.2";
bool bIsDecimal = Regex.IsMatch("^-?\d+(\.\d+)?$"); 
```

应该测试它是否是十进制值。它不会告诉您它是否是有效的小数，例如，该数字是否适合小数范围。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T15:04:53.880

试试这个数字：

```
public static bool IsNumeric(object Expression) 
```

{

```
 bool isNum;

  double retNum;

  isNum = Double.TryParse(Convert.ToString(Expression), System.Globalization.NumberStyles.Any,System.Globalization.NumberFormatInfo.InvariantInfo, out retNum );

  return isNum; 
```

}

# javascript - 适用于 Visual Studio 2005 的 JavaScript 工具

> ID：402521
> 
> 赞同：2
> 
> 时间：2008-12-31T08:16:48.890
> 
> 标签：javascript, visual-studio-2005

我需要查找是否有针对 Visual Studio 2005 和 JavaScript 的任何工具。我对可以通过面向 JavaScript 的开发提高 VS2005 中完成的工作质量的插件感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T08:36:42.843

我认为你很难找到任何特定于 VS2005 的东西，因为它是一个开发环境，而 JS 是一种客户端技术。但是，您可能需要考虑一些想法：

1.  [jQuery](http://www.jquery.com) . 最近推出的[用于 jQuery 的 Intellisense](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)（尽管我认为它仅适用于 VS2008）有助于提高工作质量，因为您不必花太多时间来回查看文档，尽管我会说这是无论如何，真正熟悉它的最佳方法。还有其他几个不错的 JS 库，但是（a）我认为这不是您问题的重点，并且（b）jQuery 是 VS 中唯一一个我知道的“半官方”支持的库.
2.  [脚本#](http://www.nikhilk.net/ScriptSharpIntro.aspx)。虽然我没用过，但它看起来很有趣……基本上你用 C# 编程，它在运行时被翻译成 JS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T10:33:20.673

如果您负担得起，我建议您升级到**Visual Studio 2008**。您无需转换即可打开 .NET 2.0 应用程序。它带有[更好的 Javascript **Intellisense**](http://weblogs.asp.net/scottgu/archive/2007/06/21/vs-2008-javascript-intellisense.aspx)。

[![替代文字](https://i.stack.imgur.com/0Ic74.jpg)](https://i.stack.imgur.com/0Ic74.jpg)
[（来源：[scottgu.com](http://www.scottgu.com/blogposts/vs2008javascript/step1.jpg)）]

VS 2008 中的其他 JavaScript 功能之一是对 JavaScript[**调试**](http://weblogs.asp.net/scottgu/archive/2007/07/19/vs-2008-javascript-debugging.aspx)[的极大改进支持](http://weblogs.asp.net/scottgu/archive/2007/07/19/vs-2008-javascript-debugging.aspx)**。**

 **这些功能在免费的 Visual Web Developer 2008 速成版和 Visual Studio 中都启用了，并且使使用 JavaScript 和构建 AJAX 应用程序变得更加容易。

如果您在应用程序中使用**jQuery ，那么您可以**[在 VS 2008 中安装 jQuery Intellisense](http://weblogs.asp.net/scottgu/archive/2008/11/21/jquery-intellisense-in-vs-2008.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T08:44:10.943

好吧，如果你想要一些可以帮助你在 Visual Studio 中编写更好的 Javascript 的东西，那么你可以试试[JSLint](http://www.codeproject.com/KB/macros/JSLintVS.aspx)。它是一个插件，可以验证您的 Javascript 代码、发现错误并帮助您调试它。

当心，JSLint 会伤害感情。

# svn - SVN DIFF 命令是否有元数据排除过滤器？

> ID：402522
> 
> 赞同：27
> 
> 时间：2008-12-31T08:17:51.773
> 
> 标签：svn, version-control, properties, diff, metadata

我使用 SVN 作为源代码控制系统，我想知道如何比较目录同时忽略任何元数据差异。有没有办法告诉`svn diff`只比较实际内容并忽略任何元数据？

我的意思是像 SVN 属性等不影响文件内容的元数据。假设文件 X 在分支 B 中与主干 T 相比具有附加属性。不幸的是，即使文件 X 的实际内容相同，它也会显示在“svn diff T B”中。

我寻找这样的东西：

```
svn diff https://example.org/tags/v1 https://example.org/tags/v2 -x -ignore-metadata --summarize 
```

**更新：**我通过直接在文件系统上进行比较而不是使用 SVN 工具部分解决了这个问题。请参阅下面我自己的答案...

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-10-03T21:35:02.293

您可以通过 'filterdiff --clean' 传递 svn diff 输出以删除任何无关的行，包括属性更改。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-05T08:29:36.633

如果您使用该`--summarize`选项，则属性更改将在第二列而不是第一列中指示。

IE，

```
M  URL  -- indicates content change
 M URL  -- property change
MM URL  -- content and property change 
```

grep 更容易一些。如果你想要一个完整的差异，我想你可以有一个两阶段的过程 - 首先使用汇总来查找内容更改的文件，然后对它们进行差异。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-24T14:42:18.983

在搜索 svn 帮助文档时发现了这个

```
svn diff --patch-compatible 
```

和跑步一样

```
svn diff --show-copies-as-adds --ignore-properties 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-19T15:56:46.660

JosephWatkins 的好建议。

这是 grep-junior-users 的命令：

```
svn diff A B --summarize | grep '^. ' 
```

grep 查找空格作为该行的第二个字符。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-02T17:09:46.043

似乎没有办法使用 svn 内置工具来完成这项工作。我是如何解决的：导出两棵树并使用您最喜欢的 diff 工具在文件系统上直接对它们进行比较。这是完成这项工作的唯一方法：/

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-05-24T18:09:38.690

使用[`svn diff --ignore-properties`](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.html#svn.ref.svn.sw.ignore_properties). 这是 Subversion 的内置方法，只对内容进行区分。它忽略对项目属性的任何更改。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-10-05T14:21:09.383

这是一个完成所有这些的命令。假设您要查找当前目录中版本 54833 和 57215 之间所有文件的所有（非属性）差异。这个命令应该这样做：

```
svn diff -r 54833:57215 --summarize | egrep -v '^ |^D|^A' | awk '{ print $2 }' | xargs svn diff -r 54833:57215 
```

注意：它只区分修改过的文件 - 不添加或删除文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-04T02:30:36.477

在网上找不到之后，我编写了一个脚本来执行此操作。

该脚本根据在脚本顶部输入的正则表达式数组删除数据。目前，它被设置为过滤掉属性更改，但它可以删除与一系列正则表达式匹配的任何更改。

`svn diff`设置脚本后，只需将输出通过管道传输到脚本。我将过滤器放在脚本中而不是参数中，因为我总是运行相同的过滤器。

我将它作为 GPLv2 发布。

[clean_svn_diff.bash](http://www.scottgrizzard.com/2009/script-that-filters-svn-diff-output-removing-entires-based-on-metadata-or-file-names/)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-31T08:36:45.137

我不确定，但是一个简单的 'svn diff | grep -iv "stuff to ignore"' 将是一种解决方法。

* * *

## 回答 #10

> 赞同：-6
> 
> 时间：2008-12-31T08:59:24.983

您可以在您希望 svn diff 忽略的文件和目录上设置[svn:ignore属性。](http://svnbook.red-bean.com/en/1.1/ch07s02.html)

# c# - 奇怪的位移行为

> ID：402536
> 
> 赞同：-1
> 
> 时间：2008-12-31T08:27:16.030
> 
> 标签：c#, c, bitwise-operators

我正在将一些 ANSI C++ 代码移植到 C# 的过程中......现在这让我很生气。

两项测试都有`value = 6844268`.

测试代码：

```
value >> 12
value & 0x00000FFF 
```

C++ 返回 18273 和 29497，而 C# 返回 1670 和 3948。我已经尝试了 C# 中所有可能的类型组合（int、uint、long、ulong、Int64...），但不行:(

C++ 中的原始值是无符号整数。有人有想法么？

编辑：啊，我搞砸了我的调试。正在查看数组 [值] 而不是值。我的错。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T08:32:56.363

检查你的 C++ 定义是否有被覆盖的`>>`操作符代码？

C# 正在计算正确的值，您是否绝对 100% 确定您的值与您所说的一样？

只是通过议案：

```
6844268 = 11010000110111101101100
>> 12   =             11010000110.111101101100
result  =             11010000110
result  = 2 + 4 + 128 + 512 + 1024 = 1670

  18273       =   100011101100001
6844268 >> 12 =       11010000110
                        ^^^^  ^^^ <-- mismatches 
```

他们没有排队，一定有一些你没有在你的代码中看到的细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T08:31:56.053

我不知道 C++ 在做什么，但在我的计算器上 C# 值是正确的；这可能是符号扩展问题吗（C++ 值为负数，并且移位拖着最高 1 位？？）

此外，鉴于 0xFFF 为 4095，& 操作无法返回大于该值的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T09:00:02.907

对我来说似乎是正确的......

```
sock@thebrain:~$ g++ test.cc
sock@thebrain:~$ ./a.out
6844268 1670 1670
6844268 1670 1670

sock@thebrain:~$ cat test.cc
#include <iostream>
#include <stdio.h>
using namespace std;
int main()
{
unsigned int value = 6844268;
printf("%u %u %u\n", value, value >> 12, (value >> 12)&0xFFF);
cout << value << " ";
cout << (value>>12) << " ";
value = (value>>12)&0xFFF;
cout << value << endl;
return 0;
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T08:39:19.890

没有覆盖的 >> 运算符。这是相关的 C++ 代码片段：

```
[Function signature: const unsigned char *src, int len, char *dst]
unsigned short *sdst = (unsigned short*) dst;
unsigned short *slt = (unsigned short*) lookup_ext;

while (len >= 3) {
    unsigned int value = *src++ << 16;
    value |= *src++ << 8;
    value |= *src++;

    cout << value << endl;
    *sdst++ = slt[value >> 12];
    *sdst++ = slt[value & 0x00000FFF];

    cout << sizeof(unsigned short) << endl << slt[value >> 12] << endl << slt[value & 0x00000FFF] << endl;
    len -= 3;
} 
```

cout 用于狼栅栏调试。

输出：

```
6844268 | cout << value
2 | sizeof(unsigned short)
18273 | slt... Ohhhh sneaky. I mis-pasted that, nevermind - it's an slt issue [Output's the same now]
29497 
```

# javascript - JavaScript 中原型继承的约定

> ID：402538
> 
> 赞同：7
> 
> 时间：2008-12-31T08:28:39.477
> 
> 标签：javascript, inheritance, constructor, prototype

我看到很多这样的代码：

```
function Base() {}
function Sub() {}
Sub.prototype = new Base(); 
```

但是，如果您这样做：

```
s = new Sub();
print(s.constructor == Sub); 
```

这是错误的。这似乎让我感到困惑，因为 s 的构造函数确实是 Sub。这样做是传统的/更好的吗？

```
function Base() {}
function Sub() {}
Sub.prototype = new Base();
Sub.prototype.constructor = Sub; 
```

还是真的不重要？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T12:47:51.683

'constructor' 并没有像它看起来那样做。除了它的非标准性之外，这也是避免使用它的一个很好的理由——坚持使用 instanceof 和原型。

从技术上讲：“构造函数”不是“s”实例的属性，它是“子”原型对象的属性。当您在 Mozilla 中创建“Sub”函数时，您会得到一个新创建的默认 Sub.prototype 对象，它有一个“构造函数”，出于礼貌，它指向 Sub 函数。

但是，您随后用新的 Base() 替换该原型。带有返回 Sub 的链接的原始默认原型丢失；相反，Sub.prototype 是 Base 的一个实例，没有任何覆盖的“构造函数”属性。所以：

```
new Sub().constructor===
Sub.prototype.constructor===
new Base().constructor===
Base.prototype.constructor===
Base 
```

...一直到您没有更改其原型的最基本对象。

> 这样做是传统的/更好的吗？

在处理 JavaScript 对象/类时，没有一个约定；每个库的元类系统的行为都略有不同。我还没有看到手动将“构造函数”写入每个派生类，但如果您真的想要真正的构造函数可用，它似乎是一个很好的解决方案；它还将使代码与不给您“构造函数”的浏览器/引擎兼容。

不过，我会考虑给它一个不同的名称，以避免与现有的和行为不同的“构造函数”属性混淆。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T11:18:34.140

如果要测试对象是否完全是 Sub 的实例，请使用`instanceof`运算符：-

```
print(s instanceof Sub); 
```

如果您想知道一个对象是 Sub 的实例还是 Sub 子类的实例，请使用以下`isPrototypeOf`方法：-

```
print(Sub.prototype.isPrototypeOf(s)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-29T15:06:28.720

是的，

```
Sub.prototype.constructor = Sub; 
```

让我们使用 instanceof 但有更好的解决方案。看这里：，[GitHub上](http://github.com/roblevintennis/Testing-and-Debugging-JavaScript/)的TDD JS Inheritance，找到*寄生组合继承*模式。该代码是 TDD 的，因此您应该能够非常快速地了解它，然后只需更改名称即可开始。这基本上是 YAHOO.lang.extend 使用的（来源：yahoo 员工和作者 Nicholas Zakas 的 Professional JavaScript for Web Developer's，第 2 版，第 181 页）。顺便说一句好书（不以任何方式附属！）

为什么？因为您正在使用的经典模式具有静态引用变量（如果您在基础对象中创建 var arr = [1,2]，则所有实例都将具有读/写功能并且将“共享状态”的“arr”！如果您使用构造函数窃取你可以解决这个问题。看我的例子。

# java - 2D游戏中可自定义的玩家头像

> ID：402541
> 
> 赞同：3
> 
> 时间：2008-12-31T08:29:36.073
> 
> 标签：java, 3d, 2d

我怎样才能在我的游戏中拥有这样的功能，玩家可以通过它改变他们的发型、外观、衣服风格等，所以每当他们穿不同的衣服时，他们的头像就会随之更新。

我是不是该：

*   让我的设计师创建所有可能的盔甲、发型和面孔组合作为精灵（这可能需要大量工作）。

*   当玩家在介绍游戏时选择他们应该看起来的样子时，我的代码会自动创建这个精灵，以及所有可能的头饰/盔甲与该精灵的组合。然后每次他们选择一些不同的盔甲时，都会加载该盔甲/外观组合的精灵。

*   是否可以将角色的 sprite 分成组件，例如脸、衬衫、牛仔裤、鞋子，并具有每个组件的像素尺寸。然后，每当玩家更换他的头盔时，例如，我们使用像素尺寸将头盔图像放置在其面部图像通常的位置。（我正在使用 Java 构建这个游戏）

*   这在 2D 中是不可能的，我应该为此使用 3D 吗？

*   还有什么方法吗？

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T08:57:51.117

要考虑的一个主要因素是动画。如果角色有带肩垫的盔甲，那么这些肩垫可能需要随着他的躯干移动。同样，如果他穿着靴子，则必须遵循与隐藏赤脚相同的循环。

本质上，您的设计师需要的是一张[Sprite Sheet](http://sdb.drshnaps.com/sheets/Capcom/MegaMan/Customs/FireMan32bit.gif)，它可以让您的艺术家看到您的基本角色的所有可能的动画帧。然后，您让他们根据这些表创建自定义发型、靴子、盔甲等。是的，它的工作量很大，但在大多数情况下，元素将需要最少的重绘；靴子是我能看到的唯一一件真正需要大量工作才能重新创建的东西，因为它们会在多个动画帧中切换。对你的精灵无情，尽量减少所需的数量。

在你积累了一个元素库之后，你就可以开始作弊了。回收相同的发型并在 Photoshop 中或直接在游戏中使用角色创建器中的滑块调整其颜色。

最后一步，为了确保游戏中的良好性能，将所有不同元素的 sprite 表展平为单个 sprite 表，然后将其拆分并存储在 sprite 缓冲区中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T08:45:14.763

3D 将不是必需的，但 3D 世界中常见的画家算法可能会为您节省一些工作：

画家算法的工作原理是首先绘制最远的对象，然后用更靠近相机的对象进行过度绘制。在您的情况下，它可以归结为为您的精灵生成缓冲区，将其绘制到缓冲区上，找到下一个相关的精灵部分（即盔甲或其他东西），绘制它，找到下一个相关的精灵部分（即一个特殊的盔甲上的标志）等等。当没有更多的依赖部分时，您将完整生成的精灵绘制到用户看到的显示器上。

组合的部分应该有一个 alpha 通道（RGBA 而不是 RGB），以便您只组合将 alpha 值设置为您选择的值的部分。如果您出于某种原因无法做到这一点，请坚持使用一种您将视为透明的 RGB 组合。

使用 3D 可能会使您更轻松地组合部件，您甚至不必使用屏幕外缓冲区或编写像素组合代码。另一方面，如果您还不了解 3D，您需要学习一点 3D。:-)

**编辑以回答评论：**

组合部分的工作方式有点像这样（在 C++ 中，Java 将非常相似 - 请注意，我没有通过编译器运行下面的代码）：

```
// 
// @param dependant_textures is a vector of textures where 
// texture n+1 depends on texture n. 
// @param combimed_tex is the output of all textures combined
void Sprite::combineTextures (vector<Texture> const& dependant_textures, 
                              Texture& combined_tex) {
   vector< Texture >::iterator iter = dependant_textures.begin();
   combined_tex = *iter;

   if (dependant_textures.size() > 1)
     for (iter++; iter != dependant_textures.end(); iter++) {
        Texture& current_tex = *iter;

        // Go through each pixel, painting:
        for (unsigned char pixel_index = 0; 
             pixel_index < current_tex.numPixels(); pixel_index++) {
           // Assuming that Texture had a method to export the raw pixel data
           // as an array of chars - to illustrate, check Alpha value:
           int const BYTESPERPIXEL = 4; // RGBA
           if (!current_tex.getRawData()[pixel_index * BYTESPERPIXEL + 3]) 
              for (int copied_bytes = 0; copied_bytes < 3; copied_bytes++)
              {
                int index = pixel_index * BYTESPERPIXEL + copied_bytes;
                combined_tex.getRawData()[index] = 
                   current_tex.getRawData()[index];
              }               
        }
     }
} 
```

要回答您对 3D 解决方案的问题，您只需绘制具有各自纹理（将具有 Alpha 通道）的矩形相互重叠。您可以将系统设置为以正交模式显示（对于 OpenGL：）`gluOrtho2D()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T08:48:20.513

我会选择[程序生成](http://en.wikipedia.org/wiki/Procedural_generation)解决方案（#2）。只要生成的精灵数量没有限制，这样生成时间就会太长。也许在获取每个项目时进行生成，以降低负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T10:33:31.220

由于在评论中还要求我提供 3D 方式，所以这里有一些，这是我很久以前写的一些代码的摘录。它是 OpenGL 和 C++。

每个精灵都会被要求绘制自己。使用适配器模式，我将组合精灵 - 即会有两个或多个精灵具有（0,0）相对位置，一个精灵具有所有这些“子”精灵的真实位置。

```
void Sprite::display (void) const
{
  glBindTexture(GL_TEXTURE_2D, tex_id_);
  Display::drawTranspRect(model_->getPosition().x + draw_dimensions_[0] / 2.0f,
      model_->getPosition().y + draw_dimensions_[1] / 2.0f,
      draw_dimensions_[0] / 2.0f, draw_dimensions_[1] / 2.0f);
}

void Display::drawTranspRect (float x, float y, float x_len, float y_len)
{   
  glPushMatrix();

  glEnable(GL_BLEND);   
  glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

  glColor4f(1.0, 1.0, 1.0, 1.0);

  glBegin(GL_QUADS);        
    glTexCoord2f(0.0f, 0.0f); glVertex3f(x - x_len, y - y_len, Z);
    glTexCoord2f(1.0f, 0.0f); glVertex3f(x + x_len, y - y_len, Z);
    glTexCoord2f(1.0f, 1.0f); glVertex3f(x + x_len, y + y_len, Z);
    glTexCoord2f(0.0f, 1.0f); glVertex3f(x - x_len, y + y_len, Z);
  glEnd();

  glDisable(GL_BLEND);  
  glPopMatrix();
} 
```

`tex_id_`是一个整数值，用于标识用于 OpenGL 的纹理。纹理管理器的相关部分是这些。纹理管理器实际上通过检查读取的颜色是否为纯白色（RGB of (ff,ff,ff)）来模拟 alpha 通道 - loadFile 代码在每像素 24 位的 BMP 文件上运行：

```
TextureManager::texture_id 
TextureManager::createNewTexture (Texture const& tex) {
    texture_id id;
    glGenTextures(1, &id);
    glBindTexture(GL_TEXTURE_2D, id);

    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);    
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);   
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);       
    glTexImage2D(GL_TEXTURE_2D, 0, 4, tex.width_, tex.height_, 0, 
        GL_BGRA_EXT, GL_UNSIGNED_BYTE, tex.texture_);

    return id;
}

void TextureManager::loadImage (FILE* f, Texture& dest) const {
  fseek(f, 18, SEEK_SET);
  signed int compression_method;
  unsigned int const HEADER_SIZE = 54;

  fread(&dest.width_, sizeof(unsigned int), 1, f);
  fread(&dest.height_, sizeof(unsigned int), 1, f);
  fseek(f, 28, SEEK_SET);
  fread(&dest.bpp_, sizeof (unsigned short), 1, f);
  fseek(f, 30, SEEK_SET);
  fread(&compression_method, sizeof(unsigned int), 1, f);

  // We add 4 channels, because we will manually set an alpha channel
  // for the color white.
  dest.size_ = dest.width_ * dest.height_ * dest.bpp_/8 * 4;
  dest.texture_ = new unsigned char[dest.size_];
  unsigned char* buffer = new unsigned char[3 * dest.size_ / 4];    

  // Slurp in whole file and replace all white colors with green
  // values and an alpha value of 0:
  fseek(f, HEADER_SIZE, SEEK_SET);      
  fread (buffer, sizeof(unsigned char), 3 * dest.size_ / 4, f); 
  for (unsigned int count = 0; count < dest.width_ * dest.height_; count++) {       
    dest.texture_[0+count*4] = buffer[0+count*3];
    dest.texture_[1+count*4] = buffer[1+count*3];
    dest.texture_[2+count*4] = buffer[2+count*3];
    dest.texture_[3+count*4] = 0xff;

    if (dest.texture_[0+count*4] == 0xff &&
        dest.texture_[1+count*4] == 0xff &&
        dest.texture_[2+count*4] == 0xff) {
      dest.texture_[0+count*4] = 0x00;
      dest.texture_[1+count*4] = 0xff;
      dest.texture_[2+count*4] = 0x00;
      dest.texture_[3+count*4] = 0x00;
      dest.uses_alpha_ = true;
    }                   
  }
  delete[] buffer;          
} 
```

这实际上是我在业余时间偶尔开发的一个小型 Jump'nRun。顺便说一句，它也使用了 gluOrtho2D() 模式。如果您离开意味着与您联系，如果您愿意，我会将来源发送给您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T16:00:23.930

较早的 2d 游戏，如暗黑破坏神和 Ultima Online 使用精灵合成技术来做到这一点。您可以从那些较旧的 2d 等距游戏中搜索艺术，看看他们是如何做到的。

# cocoa-touch - 在 Cocoa Touch 中解析二进制文件的最简单方法是什么？

> ID：402555
> 
> 赞同：1
> 
> 时间：2008-12-31T08:45:16.570
> 
> 标签：cocoa-touch, parsing

假设我有一个包含 32 位 int 值的二进制文件（用 Java 生成）。我目前正在使用以下 Objective-C 代码来解析它：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"foo" ofType:@"dat"];
NSFileHandle *file = [NSFileHandle fileHandleForReadingAtPath:path];

unsigned long intValue;
memcpy(&intValue, [[file readDataOfLength:4] bytes], 4);
intValue = NSSwapBigLongToHost(intValue);

[file closeFile]; 
```

我的第一个问题是问这是否是在 iPhone 上做事的常见方式，因为我没有找到任何接近 Java 的 DataInputStream 的东西。

我的第二个问题与带有 memcpy 的代码行有关。我不明白为什么以下部分（更优雅，更少“低级”）不起作用：

```
[[file readDataOfLength:4] getbytes:&intValue]; 
```

我在构建时收到警告：

```
'NSData' may not respond to '-getbytes:' 
```

在执行时，我得到：

```
'NSInvalidArgumentException', reason: '*** -[NSConcreteData getbytes:]: unrecognized selector sent to instance 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T09:01:24.947

对于最后一个问题，使用 getBytes（大写 B）。

# linux - 在 Linux IA-32 汇编器（gas）上创建子字符串

> ID：402579
> 
> 赞同：1
> 
> 时间：2008-12-31T09:00:34.433
> 
> 标签：linux, assembly, x86, gnu-assembler

我想从我的原始（字符串）中创建一个包含 3 个 asciz 字符的子字符串（迷你字符串）。这东西在运行时没有打印，所以我不知道我到底在做什么。为什么不打印？我是否正确创建了迷你字符串？

```
.section .data

thestring: .asciz "111010101"

ministring: .asciz ""

formatd:    .asciz "%d"
formats:    .asciz "%s"
formatc:    .asciz "%c"

.section .text

.globl _start

_start:

xorl %ecx, %ecx

ciclo:movb thestring(%ecx,1), %al
movzbl %al, %eax
movl %eax, ministring(%ecx,1)
incl %ecx
cmpl $3, %ecx
jl ciclo

movl thestring, %eax
pushl %eax
pushl $formats
call printf
addl $4, %esp

movl $1, %eax
movl $0, %ebx
int $0x80 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T09:18:06.647

您没有保留足够的内存空间来包含您正在创建的以空字符结尾的迷你字符串......因此，当您写入此内存时，您将覆盖 formatd 和 formats 的值（因此您最终会通过除了 "%s" 到 printf)。

而不是您定义的 ministring 内存位置，请尝试使用以下内容：

```
ministring: .asciz "   " 
```

* * *

此外，而不是这个：

```
movl %eax, ministring(%ecx,1) 
```

我不明白你为什么不使用它：

```
movb %al, ministring(%ecx,1) 
```

* * *

另外，如果你想打印迷你字符串，那么不要这样：

```
movl thestring, %eax 
```

做这个：

```
movl ministring, %eax 
```

* * *

也代替这个：

```
addl $4, %esp 
```

为什么不这样：

```
addl $8, %esp 
```

* * *

另外我建议您使用调试器：

*   单步执行代码
*   单步执行时观察寄存器和内存中包含的值
*   知道任何分段错误的位置

# .net - mscorlib.dll 和 System.dll

> ID：402582
> 
> 赞同：55
> 
> 时间：2008-12-31T09:03:21.590
> 
> 标签：.net, assemblies

为什么 MS 最初决定维护这两个独立的核心库？也许他们考虑到了一些可伸缩性问题，但现在我从未见过任何类型的应用程序不需要两者。有人有这方面的内幕消息吗？这并不重要，但多年来一直在我脑海中。

PS。[我知道这两个库中有什么，我知道区别 - 我是Reflector](http://www.red-gate.com/products/reflector/)的忠实粉丝:) 只是想知道两者的分离有什么实际用途。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-01-01T00:03:42.333

我在 CLR/BCL 团队工作，刚刚回复了您的电子邮件。这里粘贴在下面：

> Jared 对 Stack Overflow 的回答是正确的。由于他提到的原因，mscorlib.dll 与 CLR 紧密绑定。请注意，mscorlib.dll 本身不包含任何本机代码（正如 Scott 建议的那样），但有很多地方需要直接调用 CLR。因此，CLR 和 mscorlib 必须一起进行版本控制。
> 
> 另一方面，System.dll 没有与 CLR 紧密绑定（它不需要对运行时进行任何调用）。我们认为 System.dll 位于比 mscorlib.dll 更高的层。将这些程序集放在两个单独的层中可以提供更大的灵活性，从而更容易将 System.dll 与 CLR/mscorlib.dll 版本分开（如果我们想这样做的话）。理论上，我们可以在不更新 CLR/mscorlib 版本的情况下对 System.dll 进行更改和添加功能。这种分离还使得管理这些不同层中组件之间的依赖关系规则变得更加容易。
> 
> 正如 Scott 提到的，mscorlib 中似乎有很多“可选”的东西。这主要是出于历史原因，因为有些东西是其他东西需要的。例如，System.IO.IsolatedStorage 需要在 mscorlib 中没有技术原因，但在我们真正考虑此类版本控制/分层问题之前，它恰好是在 1.0 中添加的。此外，列表位于 mscorlib 中，因为 mscorlib 中的其他代码需要基本列表集合。
> 
> 从长远来看，我们希望尽可能减少 mscorlib 中“可选”内容的数量。要么从 mscorlib 中推出东西，要么创建一个新的、更核心的程序集，该程序集只包含使托管代码工作所需的最少必要类型（例如 System.Object、System.Int32 等）。这将使我们能够灵活地将新的创新添加到“可选”内容中，并使创建不同的 .NET Framework SKU（例如 .NET Client Profile、Silverlight 等）变得更加容易，而无需修改运行时。

我希望这有帮助！

谢谢，贾斯汀

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-12-31T10:36:01.513

~~Mscorlib 确实包含本机代码和托管代码。~~

除其他外，它还包含 System.Object 实现，它必须始终存在才能使一切正常工作。

它的区别是 CLR 需要在每个托管进程中加载​​的唯一程序集。

最初，很多“可选”的东西（技术上不需要运行应用程序的东西）被放入 mscorlib，因为它们很可能被每个人使用。这包括像 HashTable 和 List 这样的东西。

这提高了性能。如果每个人都想使用某些东西，那么将它放在每个人都必须加载的程序集中是有意义的。这样您就不必浪费时间去绑定一大堆不同的程序集了。

system.dll 中的内容基本上是所有不“值得”包含在 mscorlib 中的东西。

然而，这种趋势正在开始逆转。CLR 正在努力减小 mscorlib 的大小。例如，为 Silverlight 删除了很多东西（以减少下载大小）。

我认为他们可能会为 V4（及更高版本）做更多此类事情，但我不确定细节。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-12-31T14:45:48.997

扩展斯科特的答案。

任何给定版本的 CLR 都与特定版本的 mscorlib.dll 高度相关。它在很多方面都是一个*特殊的 DLL。*CLR 运行时要求某些类型/方法可用，并实现实际代码库中定义的许多方法。通过在 CLR 版本和 mscorlib 版本之间建立牢不可破的链接，可以降低管理这种关系的复杂性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-31T10:29:32.070

仔细查看任何项目的 References 节点。您永远不会找到那里列出的 mscorlib.dll。它很特别，任何编译器都需要它，因为它包含使语言语法工作所需的类型。System.Array、System.Int32、System.String、System.Exception 等。

您可以编写一个不依赖于 System.dll 的程序（尽管这会很困难），但您不能编写一个不依赖于 mscorlib.dll 的程序

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T14:27:09.313

提到的本机/托管的东西听起来很合理，但我仍然不完全相信。无论如何，MS 似乎将 mscorlib.dll 视为*系统*所需的核心库，而 System.dll 包含*程序员*的核心功能——这听起来也不错。

我刚刚将同样的问题通过电子邮件发送给 BCL 团队。如果*有人*可以回答...当（如果？）我收到答案时，我会在此处发布。感谢您到目前为止的答案！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T10:18:18.007

这只是一个猜测，但 mscorlib.dll 可能还有一些对 CLR 运行时很重要的 C 代码以及 .NET 程序集或一些混合模式代码。System.dll 可能都是托管的。

# c++ - 使用 Eclipse 调试 C++ 库

> ID：402598
> 
> 赞同：0
> 
> 时间：2008-12-31T09:21:39.680
> 
> 标签：c++, linux, debugging

我正在 Linux 中开发项目，其中涉及 1）C++ 中的静态库 2）使用静态库的 C++/QT 开发的 GUI。

现在 lib 和 gui 都是使用 makefile 从命令提示符构建的。

我正在尝试调试两者，就像我按下一个按钮时一样，调用应该从 GUI 转到 lib。

是否可以在带有 Eclipse 的 Linux 中这样做？我可以使用 Visual Studio 在 Windows 中轻松地遵循相同的调试过程并将 lib 附加到 GUI，但我找不到任何使用 eclipse 的好方法。

我尝试过许多 IDE/调试器，例如 Anjuta Code Blocks。DDD,Kdbg 但没有一个工作正常。

我不确定我是错的还是调试起来很复杂？

有人可以建议一种正确的调试方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T09:39:50.847

调试静态库应该没有任何问题，因为它的相关部分将内置到您正在调试的二进制文件中。如果您遇到问题，那么需要检查的一些事项是库和二进制文件都是使用调试信息构建的（通常是`-g`linux 上编译器的选项），并且您的调试器可以访问库的源代码。

你能更具体地说明调试是如何不起作用的吗？听起来“进入”库函数并没有像您期望的那样工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-02T08:18:28.060

好吧，我想通了.. 我目前正在使用 Kdevelop.. 使用 Kdevelp 我们可以创建 QT 项目以及 c++(lib) 项目。并且还有附加过程的选项。所以我可以通过附加 GUI 来单步执行 lib 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T09:51:42.570

我在 eclipse 中创建了新项目并添加了现有的源文件夹。然后它会自动添加所有源文件。项目有自己的自定义 makefile 。现在，当我尝试调试项目时，它会显示调试窗口，其中我选择了 C/C++ 附加到本地应用程序，因为我想将库附加到 GUI。

它要求我在调试窗口中输入项目名称。

在带有 Visual Studio 的 Windows 中，它提供了可以附加的进程列表，但是我应该在这里创建项目吗？

这个我不明白。。

# asp.net-mvc - 在链接文本中创建带有 HTML 元素的 ActionLink

> ID：402605
> 
> 赞同：34
> 
> 时间：2008-12-31T09:34:48.890
> 
> 标签：asp.net-mvc, actionlink

在 ASP.NET MVC 视图中，我想包含以下表单的链接：

```
<a href="blah">Link text <span>with further descriptive text</span></a> 
```

尝试将`<span>`元素包含在`linkText`调用字段中`Html.ActionLink()`最终会被编码（正如预期的那样）。

有没有推荐的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-31T11:28:37.100

您可以使用 Url.Action 为您构建链接：

```
<a href="<% =Url.Action("Action", "Controller")%>">link text <span>with further blablah</span></a> 
```

或使用 Html.BuildUrlFromExpression：

```
<a href="<% =Html.BuildUrlFromExpression<Controller>(c => c.Action()) %>">text <span>text</span></a> 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-09-17T15:21:47.437

如果你喜欢使用 Razor，这应该可以：

```
<a href="@Url.Action("Action", "Controller")">link text <span>with further blablah</span></a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T08:54:46.273

另一种选择是按照正常情况使用 HTML.ActionLink 或 Ajax.ActionLink（取决于您的上下文）将您的操作链接呈现到 MvcHtmlString，然后编写一个类来获取呈现的 MvcHtmlString 并将您的 html 链接文本直接破解到已经渲染了 MvcHtmlString，并返回另一个 MvcHtmlString。

所以这是执行此操作的类：[请注意插入/替换代码非常简单，您可能需要加强它以处理更多嵌套的 html]

```
namespace Bonk.Framework
{
    public class CustomHTML
    {
        static public MvcHtmlString AddLinkText(MvcHtmlString htmlString, string linkText)
        {
            string raw = htmlString.ToString();

            string left = raw.Substring(0, raw.IndexOf(">") + 1);
            string right = raw.Substring(raw.LastIndexOf("<"));

            string composed = left + linkText + right;

            return new MvcHtmlString(composed);
        }
    }
} 
```

然后你会像这样在视图中使用它：

```
@Bonk.Framework.CustomHTML.AddLinkText(Ajax.ActionLink("text to be replaced", "DeleteNotificationCorporateRecipient"), @"Link text <span>with further descriptive text</span>") 
```

这种方法的优点是不必重现/理解标签渲染过程。

# linux - 如何在登录后将 SSH 用户限制为一组预定义的命令？

> ID：402615
> 
> 赞同：96
> 
> 时间：2008-12-31T09:41:00.437
> 
> 标签：linux, shell, ssh

这是一个安全的想法。我们的员工可以访问 linux 服务器上的一些命令，但不是全部。例如，它们应有可能访问日志文件 ( `less logfile`) 或启动不同的命令 ( `shutdown.sh`/ `run.sh`)。

背景资料：

所有员工使用相同的用户名访问服务器：我们的产品以“普通”用户权限运行，无需“安装”。只需在您的用户目录中解压缩并运行它。我们管理“安装”我们的应用程序的几台服务器。在每台机器上都有一个用户`johndoe`。我们的员工有时需要通过命令行访问应用程序以访问和检查日志文件或手动重新启动应用程序。只有某些人拥有完整的命令行访问权限。

我们在服务器上使用 ppk 身份验证。

如果employee1 只能访问日志文件而employee2 也可以执行X 等操作，那就太好了……

**解决方案：** 作为解决方案，我将使用已*接受*答案中所述的`command`选项。我将制作我自己的小 shell 脚本，它是唯一可以为*某些*员工执行的文件。该脚本将提供几个可以执行的命令，但没有其他命令。我将在 from 中使用以下参数，如此[处](http://www.linuxjournal.com/article/8257)所述：**`authorized_keys`**

 **```
command="/bin/myscript.sh",no-port-forwarding,no-X11-forwarding,no-agent-forwarding,no-pty
ssh-dss AAAAB3....o9M9qz4xqGCqGXoJw= user@host 
```

这对我们来说已经足够安全了。谢谢，社区！

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-12-31T10:06:00.747

您还可以将密钥限制为允许的命令（在 authorized_keys 文件中）。

即用户不会通过 ssh 登录，然后有一组受限制的命令，而是只允许通过 ssh 执行这些命令（例如“ssh somehost bin/showlogfile”）

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-10-20T23:57:56.360

`ssh`遵循`rsh`传统，使用密码文件中的用户 shell 程序来执行命令。

这意味着我们可以在不涉及`ssh`任何配置的情况下解决这个问题。

如果您不希望用户能够拥有 shell 访问权限，那么只需将该用户的 shell 替换为脚本即可。如果您查看，`/etc/passwd`您会看到有一个字段为每个用户分配一个 shell 命令解释器。该脚本用作交互式登录`ssh user@host` 和命令的 shell `ssh user@host command arg ...`。

这是一个例子。我创建了一个用户`foo`，其外壳是一个脚本。该脚本打印消息`my arguments are:`后跟它的参数（每个在单独的行和尖括号中）并终止。在日志中，没有参数。这是发生的事情：

```
webserver:~# ssh foo@localhost
foo@localhost's password:
Linux webserver [ snip ]
[ snip ]
my arguments are:
Connection to localhost closed. 
```

如果用户尝试运行命令，它看起来像这样：

```
webserver:~# ssh foo@localhost cat /etc/passwd
foo@localhost's password:
my arguments are:
<-c>
<cat /etc/passwd> 
```

我们的“shell”接收一个`-c`样式调用，将整个命令作为一个参数，就像`/bin/sh`接收它的方式一样。

如您所见，我们现在可以做的是进一步开发脚本，以便它在使用`-c`参数调用它时识别大小写，然后解析字符串（例如通过模式匹配）。那些允许的字符串可以通过递归调用传递给真实的shell `/bin/bash -c <string>`。拒绝案例可以打印错误消息并终止（包括`-c`丢失时的案例）。

你必须小心你如何写这个。我建议只写正面匹配，只允许非常具体的事情，而不允许其他一切。

*注意：*如果您是，您仍然可以通过在命令`root`中覆盖 shell 来登录此帐户，如下所示。（选择的替代外壳。）非根不能这样做。`su``su -s /bin/bash foo`

这是一个示例脚本：将用户限制为仅`ssh`用于`git`访问`/git`.

```
#!/bin/sh

if [ $# -ne 2 ] || [ "$1" != "-c" ] ; then
  printf "interactive login not permitted\n"
  exit 1
fi

set -- $2

if [ $# != 2 ] ; then
  printf "wrong number of arguments\n"
  exit 1
fi

case "$1" in
  ( git-upload-pack | git-receive-pack )
    ;; # continue execution
  ( * )
    printf "command not allowed\n"
    exit 1
    ;;
esac

# Canonicalize the path name: we don't want escape out of
# git via ../ path components.

gitpath=$(readlink -f "$2")  # GNU Coreutils specific

case "$gitpath" in
  ( /git/* )
     ;; # continue execution
  ( * )
    printf "access denied outside of /git\n"
    exit 1
    ;;
esac

if ! [ -e "$gitpath" ] ; then
   printf "that git repo doesn't exist\n"
   exit 1
fi

"$1" "$gitpath" 
```

当然，我们相信这些 Git 程序没有漏洞或逃生口，不会让用户访问系统`git-upload-pack`。`git-receive-pack`

这是这种限制方案所固有的。用户经过身份验证可以在某个安全域中执行代码，并且我们正在限制将该域限制为子域。例如，如果您允许用户`vim`在特定文件上运行命令来编辑它，则用户只需获得一个带有`:!sh[Enter]`.

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-31T10:02:13.437

您要查找的内容称为[Restricted Shell](http://google.com/search?q=restricted+shell+linux)。Bash 提供了这样一种模式，其中用户只能执行其主目录中存在的命令（并且他们不能移动到其他目录），这对您来说可能已经足够了。

我发现[这个线程](http://www.derkeiler.com/Mailing-Lists/securityfocus/focus-linux/2002-02/0044.html)非常具有说明性，如果有点过时的话。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-05-04T22:31:17.023

为什么不编写自己的登录外壳？为此使用 Bash 非常简单，但您可以使用任何语言。

# Bash 中的示例

使用您喜欢的编辑器创建文件`/root/rbash.sh`（可以是任何名称或路径，但应该是`chown root:root`and `chmod 700`）：

```
#!/bin/bash

commands=("man" "pwd" "ls" "whoami")
timestamp(){ date +'%Y-%m-%s %H:%M:%S'; }
log(){ echo -e "$(timestamp)\t$1\t$(whoami)\t$2" > /var/log/rbash.log; }
trycmd()
{
    # Provide an option to exit the shell
    if [[ "$ln" == "exit" ]] || [[ "$ln" == "q" ]]
    then
        exit

    # You can do exact string matching for some alias:
    elif [[ "$ln" == "help" ]]
    then
        echo "Type exit or q to quit."
        echo "Commands you can use:"
        echo "  help"
        echo "  echo"
        echo "${commands[@]}" | tr ' ' '\n' | awk '{print "  " $0}'

    # You can use custom regular expression matching:
    elif [[ "$ln" =~ ^echo\ .*$ ]]
    then
        ln="${ln:5}"
        echo "$ln" # Beware, these double quotes are important to prevent malicious injection

        # For example, optionally you can log this command
        log COMMAND "echo $ln"

    # Or you could even check an array of commands:
    else
        ok=false
        for cmd in "${commands[@]}"
        do
            if [[ "$cmd" == "$ln" ]]
            then
                ok=true
            fi
        done
        if $ok
        then
            $ln
        else
            log DENIED "$cmd"
        fi
    fi
}

# Optionally show a friendly welcome-message with instructions since it is a custom shell
echo "$(timestamp) Welcome, $(whoami). Type 'help' for information."

# Optionally log the login
log LOGIN "$@"

# Optionally log the logout
trap "trap=\"\";log LOGOUT;exit" EXIT

# Optionally check for '-c custom_command' arguments passed directly to shell
# Then you can also use ssh user@host custom_command, which will execute /root/rbash.sh
if [[ "$1" == "-c" ]]
then
    shift
    trycmd "$@"
else
    while echo -n "> " && read ln
    do
        trycmd "$ln"
    done
fi 
```

您所要做的就是将此可执行文件设置为您的登录 shell。例如，编辑您的`/etc/passwd`文件，并将该用户的当前登录 shell 替换`/bin/bash`为`/root/rbash.sh`.

这只是一个简单的示例，但您可以根据需要将其设置为高级，想法就在那里。请注意不要通过更改您自己的唯一用户的登录 shell 来锁定自己。并且总是测试奇怪的符号和命令，看看它是否真的安全。

您可以使用以下方法对其进行测试：`su -s /root/rbash.sh`.

**注意**，确保匹配整个命令，并小心使用通配符！最好排除 Bash 符号，例如`;`, `&`, `&&`, `||`, `$`, 和反引号以确保。

根据您给予用户的自由度，没有比这更安全的了。我发现通常我只需要创建一个只能访问几个相关命令的用户，在这种情况下，这确实是更好的解决方案。但是，您是否希望给予更多自由，监狱和权限可能更合适。错误很容易犯，只有在为时已晚时才注意到。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T21:57:24.880

你应该获得 `rssh'，受限的 shell

您可以遵循上面提到的限制指南，它们都是不言自明的，并且易于遵循。了解术语 `chroot jail'，以及如何有效地实现 sshd/终端配置等。

由于您的大多数用户通过 sshd 访问您的终端，因此您可能还应该查看 sshd_conifg（SSH 守护程序配置文件）以通过 SSH 应用某些限制。不过要小心。正确理解您尝试实现的内容，因为不正确配置的后果可能相当可怕。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-10-03T07:18:22.557

[GNU Rush](https://www.gnu.org.ua/software/rush/manual/rush.html)可能是完成此任务的最灵活和最安全的方式：

> GNU Rush 是一个受限用户 Shell，专为提供对其资源的有限远程访问的站点而设计，例如 svn 或 git 存储库、scp 等。使用复杂的配置文件，GNU Rush 让您可以完全控制用户执行的命令行，以及系统资源的使用，例如虚拟内存、CPU 时间等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-31T21:02:50.373

你可能想看看建立一个[监狱](http://en.wikipedia.org/wiki/FreeBSD_jail)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T22:23:01.727

另一种看待这个问题的方法是使用 POSIX ACL，它需要你的文件系统支持，但是你可以在 linux 中对所有命令进行细粒度调整，就像你在 Windows 上拥有相同的控制一样（只是没有更好的 UI ）。[关联](http://www.cs.unc.edu/cgi-bin/howto?howto=linux-file-acls)

要研究的另一件事是[PolicyKit](http://www.oreillynet.com/onlamp/blog/2007/11/policykit_looser_limitations_t.html)。

你必须做大量的谷歌搜索才能让一切正常工作，因为这绝对不是目前 Linux 的强项。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-24T03:42:28.033

[披露：我写了下面描述的 sshdo]

如果您希望登录是交互式的，那么设置受限 shell 可能是正确的答案。但是，如果您想要允许一组实际的命令（仅此而已），并且可以通过 ssh 单独执行这些命令（例如 ssh user@host cmd arg blah blah），则可以使用通用命令白名单控制ssh 可能是您需要的。当命令在客户端以某种方式编写脚本并且不需要用户实际输入 ssh 命令时，这很有用。

有一个名为 sshdo 的程序可以做到这一点。它控制哪些命令可以通过传入的 ssh 连接执行。可在以下位置下载：

[http://raf.org/sshdo/](http://raf.org/sshdo/)（在此处阅读手册页） [https://github.com/raforg/sshdo/](https://github.com/raforg/sshdo/)

它有一个训练模式来允许所有尝试的命令，以及一个 --learn 选项来生成永久允许学习命令所需的配置。然后可以关闭训练模式，并且不会执行任何其他命令。

它还有一个 --unlearn 选项来停止允许不再使用的命令，以便在需求随时间变化时保持严格的最低权限。

它对它允许的内容非常挑剔。它不允许带有任何参数的命令。只能允许完整的 shell 命令。

但它确实支持简单的模式来表示类似的命令，这些命令仅在命令行上出现的数字（例如序列号或日期/时间戳）中有所不同。

它就像 ssh 命令的防火墙或白名单控制。

它支持不同的用户使用不同的命令。

# c# - 将字符转换为无符号短片：幕后发生了什么？

> ID：402616
> 
> 赞同：1
> 
> 时间：2008-12-31T09:41:09.843
> 
> 标签：c#, c, casting

给定这个字段：

```
char lookup_ext[8192] = {0}; // Gets filled later 
```

而这个声明：

```
unsigned short *slt = (unsigned short*) lookup_ext; 
```

幕后会发生什么？

lookup_ext[1669] 返回 67 = 0100 0011 (C)，lookup_ext[1670] 返回 78 = 0100 1110 (N)，lookup_ext[1671] 返回 68 = 0100 0100 (D)；然而 slt[1670] 返回 18273 = 0100 0111 0110 0001。

我正在尝试将它移植到 C#，所以除了一个简单的方法之外，我还想知道这里到底发生了什么。自从我经常使用 C++ 以来已经有一段时间了。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T09:48:22.280

您显示的语句不会将 char 转换为 unsigned short ，而是将指向char 的*指针转换为指向 unsigned short 的**指针*。这意味着指向数据的通常算术转换不会发生，并且当通过`slt`变量访问时，底层的 char 数据将被解释为无符号短路。

请注意，`sizeof(unsigned short)`不太可能是一个，因此`slt[1670]`不一定对应于`lookup_ext[1670]`. 更有可能 - 如果，比如说，`sizeof(unsigned short)`是两个 - 对应于`lookup_ext[3340]`和`lookup_ext[3341]`。

你知道为什么原始代码使用这个别名吗？如果没有必要，可能值得尝试使 C++ 代码更清晰，并在移植之前验证行为是否未更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T09:47:49.690

如果我理解正确，类型转换会将大小为 8192 的 char 数组转换为大小为该大小一半的短 int 数组，即 4096。

所以我不明白你在你的问题中比较什么。slt[1670] 应该对应lookup_ext[1670*2] 和lookup_ext[1670*2+1]。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T10:00:36.357

嗯，这个说法

```
char lookup_ext[8192] = {0}; // Gets filled later 
```

根据定义发生的位置，在本地或非本地创建一个数组。像这样初始化它，使用聚合初始化器会将其所有元素初始化为零（第一个显式地初始化，其余的隐式地初始化）。因此我想知道为什么你的程序输出非零值。除非填充发生在读取之前，否则这是有道理的。

```
unsigned short *slt = (unsigned short*) lookup_ext; 
```

当您从该指针的目标读取时，这会将构成数组的字节解释为无符号短对象。严格来说，以上是未定义的行为，因为您无法确定数组是否适合对齐，并且您会从未指向原始指向类型的类型的指针（unsigned char <-> unsigned short）中读取。在 C++ 中，从其他 pod 中读取值的唯一可移植方法（普通的旧数据。这也是 C 中可能的所有结构和简单类型（例如 short），广义上讲）是使用这样的库函数：`memcpy`或`memmove`。

因此，如果您阅读`*slt`上面的内容，您将解释`sizeof(*slt)`数组的第一个字节，并尝试将其读取为 unsigned short（称为`type pun`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T09:49:42.103

当您执行“unsigned short *slt = (unsigned short* )lookup_ext;”时，没有。从lookup_ext给定的位置拾取相当于(unsigned short)大小的字节，并存储在slt指向的位置。由于 unsigned short 将是 2 个字节，lookup_ext 的前两个字节将存储在 slt 给定的位置。

# ado.net - 在没有 DataAdapters 的 ADO.NET 中进行批处理

> ID：402630
> 
> 赞同：3
> 
> 时间：2008-12-31T09:56:12.903
> 
> 标签：ado.net, batching

是否可以在 ADO.NET 中实现多个存储过程调用的批处理（执行更新/删除）而不使用 DataAdapters？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T11:18:12.550

您可以尝试使用 System.Data.SqlClient.SqlCommandSet。它实际上是内部的，但[Ayende 制作了一个包装器将其公开](http://ayende.com/Blog/archive/2006/09/13/OpeningUpQueryBatching.aspx)。

代码当前托管在[sourceforge](http://rhino-tools.svn.sourceforge.net/viewvc/rhino-tools/trunk/rhino-commons/Rhino.Commons/ToPublic/SqlCommandSet.cs?view=markup)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T09:59:45.377

你的 SQL 文本可以包含多个命令。如果返回多个结果集，则可以使用 DataReader 并使用 NextResult 函数。我经常做的是将要作为嵌入式资源执行的 SQL 存储，然后加载该文本。如果它包含参数，则像往常一样设置参数。

例如，我有一个文件：

```
UPDATE dbo.QuotePricedLineItem
SET fkQuoteVendorLineSet = NULL
FROM dbo.QuotePricedLineItem qpli
INNER JOIN dbo.QuoteLineItem qli ON qpli.Id = qli.Id
WHERE qli.fkQuote = @quoteId AND qpli.fkQuoteVendorLineSet = @ciscoConfigId

DELETE CiscoQuoteLineItem
FROM CiscoQuoteLineItem cqli
INNER JOIN QuoteLineItem qli ON cqli.Id = qli.Id
WHERE qli.fkQuote = @quoteId AND cqli.fkCiscoQuoteVendorLineSet = @ciscoConfigId 
```

我这样执行：

```
using (SqlConnection conn = DbUtils.CreateConnection() as SqlConnection)
{
    conn.Open();

    SqlCommand cmd = conn.CreateCommand();
    cmd.CommandText = MvcApplication.GetResource("SQL.DemoteCiscoQuoteLineItems.sql");
    cmd.Parameters.AddWithValue("@quoteId", q.Id);
    cmd.Parameters.AddWithValue("@ciscoConfigId", configSetId);
    cmd.ExecuteNonQuery();
} 
```

请注意， MvcApplication.GetResource 不是内置函数 - 这是您必须编写的函数......这是我的：

```
public static string GetResource(string p)
{
    Stream s = Assembly.GetExecutingAssembly().GetManifestResourceStream("CortexQuoting.Res." + p);
    if (s == null) return null;

    StreamReader sw = new StreamReader(s);
    string ss = sw.ReadToEnd();
    sw.Close();
    return ss;
} 
```

# svn - SVN、TeamCity 虚拟化/硬件要求

> ID：402633
> 
> 赞同：5
> 
> 时间：2008-12-31T09:57:15.740
> 
> 标签：svn, hardware, teamcity, build-environment

我正在尝试将一个新环境的要求放在一起，该环境由运行 Sql Server 的 TeamCity、几个构建代理（目前）和一个 SVN 存储库组成。

有 6 名开发人员，目前将有 5 个活跃的解决方案参与 CI 流程，显然会随着时间的推移而增长。目前没有一个解决方案需要超过 10 分钟的时间来构建，因此它们在复杂性和位置方面并不是很大。

构建项目本身需要一个 sql server 实例，以便可以运行自动化测试 - 我假设它们应该与 TeamCity sql 实例分开。

任何人都可以建议适合运行这些的硬件配置。磁盘 i/o 是否会比实际的 CPU 能力更重要。

我可以在单个多 CPU、RAID 和虚拟化上运行所有这些吗？

我们应该使用 windows 2008 和 hyper-v 运行吗？

我总是让其他人处理服务器要求和构建，但现在我必须弄脏自己的脚。

欢迎任何建议

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T11:23:59.667

一个数据点：

我们的 TeamCity 环境位于（如果我没记错的话）三台 8 核服务器上，每台服务器都有 32Gb 的 RAM，运行 Windows 2008 和 HyperV。我们的 SVN 存储库位于不同的服务器上（出于历史原因）。我认为现在一切都在 SAN 上，以提高可靠性（如果其中一台主机出现故障，我们可以轻松地将虚拟机移动到另一台主机）。

我们有 10 个构建代理，都在虚拟机中运行。其中 4 个用于直接构建；其中 6 个用于构建和运行系统测试（这涉及在测试中协调其他 VM）。我们之所以选择这个，是因为我们的一些系统测试需要 11 个小时才能运行，而且我们不想耽误构建队列。我们分阶段发布——理想情况下，项目在通过自动化单元和系统测试之前不会发布给测试部门。

我们有大约十几个开发人员一次积极地从事 3 或 4 个项目。我们还使用 TeamCity 构建修补程序和维护版本。

在您的方案中，我会在您有预算的最大机器上选择 Windows 2008 和 HyperV。磁盘 I/O 比 CPU 能力更重要，但使用更多内核，您可以更轻松地扩展到更多 VM。分配给每个 VM 的大量 RAM 避免了交换，并有助于缓存，这意味着更少的磁盘 I/O。在某个时候，您可能会考虑拥有两个或更多的盒子以进行故障转移，因为有时购买两个具有 32Gb RAM 的盒子比购买单个盒子的 64Gb 选项更便宜。

使用 VM 的优点之一是您可以对它们进行快照并定期恢复它们。每个项目可能都应该有自己的 SQL Server 实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-05T09:00:27.887

您应该查看我们文档中的 How to 部分： http: [//confluence.jetbrains.net/display/TCD65/How+To](http://confluence.jetbrains.net/display/TCD65/How+To) ... 在那里您将找到“估计 TeamCity 的硬件要求”主题。可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T10:56:01.543

上一篇文章中的链接已损坏以下是正确的链接。 [http://confluence.jetbrains.com/display/TCD65/How+To...#HowTo...-hardwarerequirements](http://confluence.jetbrains.com/display/TCD65/How+To...#HowTo...-hardwarerequirements)

# c# - c# - 针对 Compact Net Framework 3.5 编译时出错 - 方法 'GetString' 没有重载需要 '1' 参数

> ID：402648
> 
> 赞同：2
> 
> 时间：2008-12-31T10:06:58.717
> 
> 标签：c#, windows-mobile, compact-framework, mime

我实际上对同一个问题有两个问题，但我认为最好将它们分开，因为我认为它们不相关。

背景：我正在用 VB.NET 编写一个 Windows Mobile 软件，其中的任务需要连接到邮件服务器以发送和检索电子邮件。因此，我还需要一个 Mime 解析器（用于解码和编码）电子邮件以获取附件。[首先我想，我会写一个小“hack”来处理这个问题（使用普通的字符串解析），但后来我在 CodeProject](http://www.codeproject.com/KB/cs/MIME_De_Encode_in_C_.aspx?fid=209566&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=1202157)看到了一个用 C# 编写的项目我认为我会在我的解决方案中实施。我对 C# 了解不多，所以我只是从这些类中创建了一个类库，并在我的 VB.NET 项目中使用它。当我在普通 Windows 计算机上针对 Net Framework 时，这个库工作得非常好，但是当我要针对 Compact Net Framework 制作相同的库时，我遇到了麻烦。这是很自然的，因为 Compact Net Framework 有更多的限制，但我实际上并没有得到那么多错误——尽管在代码的不同地方重复了，但只有两个错误。

其中一个错误是在这个问题的主题中引用的，即“方法'GetString'没有重载需要'1'参数”。如上所述，我对 C# 了解不多，所以我将在线错误的类转换为 VB-NET，但我仍然不太了解。这是给出上述错误的函数：

```
public virtual string DecodeToString(string s)
{
  byte[] b = DecodeToBytes(s);
  if(m_charset != null)
  {
    //ERROR ON THIS LINE
    return System.Text.Encoding.GetEncoding(m_charset).GetString(b);
  }
  else
  {
    m_charset = System.Text.Encoding.Default.BodyName;
    //ERROR ON THIS LINE
    return System.Text.Encoding.Default.GetString(b);
  }
} 
```

如果这个类需要完整的源代码，那么我可以在这个线程的另一条消息中发布它，或者你可以通过在上面提到的网站上下载代码并查看名为 MimeCode 的类来找到它。 CS。

谁能帮帮我？我可以以某种方式重写上面的函数来克服这个问题吗？

我提前感谢您的帮助。

向你们所有人致以诚挚的问候和新年快乐。

Rgds, moster67

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T10:13:08.657

CF .NET 要求您使用签名：Encoding.GetString Method (array[], Int32 index, Int32 count) 所以尝试使用：

```
...GetString(b, 0, b.Length); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T10:18:29.580

如果您在 MSDN 上查找 Encoding 类，您将找到有关紧凑框架中方法可用性的信息。

[http://msdn.microsoft.com/en-us/library/system.text.encoding.default.aspx](http://msdn.microsoft.com/en-us/library/system.text.encoding.default.aspx)

在您的情况下，.NET Compact Framework 3.5、2.0、1.0 支持 System.Text.Encoding.Default 属性，因此您应该做好准备。

但事情就是这样。MS 有时会从类实现中删除一些方法，或者准确地说是重载。

查看文档 [http://msdn.microsoft.com/en-us/library/system.text.encoding.getstring.aspx](http://msdn.microsoft.com/en-us/library/system.text.encoding.getstring.aspx)您可以通过查看图标（左侧的小图像）来判断，而 .NET Compact框架支持编码类，一些重载被删除。

当您将 byte[] 数组传递给 GetString 方法时，它找不到该重载，因此您必须添加一个 int 偏移量和 int 计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T10:14:45.550

紧凑的框架可能不支持只需要一个字节数组的重载。尝试使用字节数组、起始索引和计数的重载，并将其设为 0 作为起始索引，并将 b.Length 作为长度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T15:28:43.823

感谢 Michael、John 和 Rune 回答我的问题。通过使用您的建议，我解决了问题并设法编译/构建了针对 CF.NET 3.5 的库。还要感谢 ctacke 编辑我的问题并使其更具可读性。

顺便说一句，正如我在第一篇文章中提到的那样，我遇到了另一个问题，我打算在另一个线程中询问，并且不允许我为 CF.NET 构建库，即以下行：

```
m_charset = System.Text.Encoding.Default.BodyName; 
```

在这种情况下，问题在于 CF.NET 无法识别“BodyName”。我找不到任何替代方法或解决方法来获取使用的字符集（BodyName 检索此信息），所以最后我只是为其分配了一个固定值（iso-8859-1）。这意味着不幸的是，该库不会处理所有不同的字符集，但至少代码不会中断并且我能够编译它。无论如何，对我来说这就足够了，因为我的应用程序不关心文本消息——它使用电子邮件来发送和获取附件（类似于 Gmail 驱动器，但使用我自己的提供商）。

再一次感谢你。

亲切的问候， moster67

# json - 如何在 ActiveMQ 中通过 Stomp/JSON 使用 JMS 消息转换

> ID：402651
> 
> 赞同：6
> 
> 时间：2008-12-31T10:08:09.180
> 
> 标签：json, activemq, stomp

我正在将 JSON 格式的消息发送到 ActiveMQ 服务器。我正在尝试使用 JMS 转换将 JSON 编码对象转换为真正的 Java 对象，希望能够在内部数据上使用选择器。

[这](http://activemq.apache.org/stomp.html#Stomp-Messagetransformations)是 Stomp 和消息转换文档的链接。 [这](https://issues.apache.org/activemq/browse/AMQ-1567?focusedCommentId=41192#action_41192)是一个关于补丁讨论的链接，其中有人展示了一个合法 JSON 对象的示例

我发送的 JSON 对象的格式（漂亮的印刷品）与此类似：

```
{
   “味精”：{
      “标志1”：“值1”，
      “标志 2”：“值 2”
   }
}

```

消息到达消息队列，但转换错误属性设置为“msg：msg”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T11:52:06.257

转换 jms-map-json 或 jms-object-json 接受的唯一格式是简单的 Map 格式，在 JSON 中是：

```
{“地图” ：
  {“入口” ：
    [
      { "string1": [ "key1", "value1" ] },
      { "string2": [ "key2", "value2" ] }
    ]
  }
}

```

这与讨论论坛中显示的格式相同。此格式表示 java 中的名称/值对映射对象。

选择器仅可用于属性和标题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T12:16:13.153

只要 XStream 可以处理它，您就可以对 jms-object-json 转换使用任何 JSON 表示法。您可以查看一些示例的测试用例。在那里，我们使用 SamplePojo 类：

[https://svn.apache.org/repos/asf/activemq/trunk/activemq-stomp/src/test/java/org/apache/activemq/transport/stomp/SamplePojo.java](https://svn.apache.org/repos/asf/activemq/trunk/activemq-stomp/src/test/java/org/apache/activemq/transport/stomp/SamplePojo.java)

已正确注释，因此可以用以下 JSON 表示

{“pojo”：{“名称”：“德扬”，“城市”：“贝尔格莱德”}}

您可以尝试对您的课程使用相同的方法。

希望这会有所帮助，德扬

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-14T13:32:55.997

值得一提的是，ActiveMQ 版本必须至少为 5.8，因为使用 5.6 版本时，我在转换不起作用时遇到了问题。

# cocoa-touch - UITextField 或 UITextView 出现键盘时调整界面

> ID：402658
> 
> 赞同：6
> 
> 时间：2008-12-31T10:10:02.860
> 
> 标签：cocoa-touch

我有一个表格，每个单元格都包含一个标签和一个文本字段。问题是当我去编辑最后一行时，键盘隐藏了表格的下部，我看不到正在输入的内容。如何将我的界面移动到键盘上方，以便查看正在输入的内容？

谢谢，穆斯塔法

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T15:07:47.797

您需要为`UIKeyboardDidShowNotification`和`UIKeyboardWillHideNotification`事件注册您的 viewController。当你得到这些时，你应该调整你的桌子的界限；键盘的高度为 170 像素，因此只需适当地缩小或扩大您的表格边界，它应该会正确地适应键盘。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-25T13:08:32.857

这个问题很复杂，具体取决于您的 UI 场景。在这里，我将讨论 UITextField 或 UITextview 驻留在 UITableViewCell 中的场景。

1.  您需要使用 NSNotificationCenter 来检测 UIKeyboardDidShowNotification 事件。请参阅[http://iosdevelopertips.com/user-interface/adjust-textfield-hidden-by-keyboard.html](http://iosdevelopertips.com/user-interface/adjust-textfield-hidden-by-keyboard.html)。您需要缩小 UITableView 的帧大小，使其仅占据键盘未覆盖的屏幕区域。

    2.  如果您点击一个 UITableViewCell，操作系统会自动将单元格定位在 UITableView 的查看区域内。但是当你点击 UITextView 或 UITableViewCell 时它不会发生，即使它驻留在 UITableViewCell 中。

你需要打电话

```
[myTableView selectRowAtIndexPath:self.indexPath animated:YES scrollPosition:UITableViewScrollPositionBottom];` 
```

以编程方式“点击”单元格。

如果你实现了这两个点，你会在键盘正上方看到 UITextView/Field 的位置。请记住，UITableView/Field 所在的 UITableViewCell 不能高于“未覆盖”区域。如果您不是这种情况，则可以使用不同的方法，但我不会在这里讨论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T10:48:50.910

看看这个问题：[A UITableView list of editable text fields](https://stackoverflow.com/questions/387163/a-uitableview-list-of-editable-text-fields)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T10:14:35.737

只要确保您在其下方有足够的滚动空间即可。因为据我所知，iPhone 会在键盘出现时自动调整并显示焦点文本框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T08:29:16.010

删除/评论修改矩形高度的行似乎可以解决问题。谢谢。

修改代码：

```
# define kOFFSET_FOR_KEYBOARD 150.0     // keyboard is 150 pixels height

// Animate the entire view up or down, to prevent the keyboard from covering the author field.
- (void)setViewMovedUp:(BOOL)movedUp
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

// Make changes to the view's frame inside the animation block. They will be animated instead
// of taking place immediately.
CGRect rect = self.view.frame;
CGRect textViewRect = self.textViewBeingEdited.frame;
CGRect headerViewRect = self.headerView.frame;

if (movedUp) {
    // If moving up, not only decrease the origin but increase the height so the view 
    // covers the entire screen behind the keyboard.
    rect.origin.y -= kOFFSET_FOR_KEYBOARD;
    // rect.size.height += kOFFSET_FOR_KEYBOARD;
} else {
    // If moving down, not only increase the origin but decrease the height.
    rect.origin.y += kOFFSET_FOR_KEYBOARD;
    // rect.size.height -= kOFFSET_FOR_KEYBOARD;
}

self.view.frame = rect;
[UIView commitAnimations]; 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-31T13:00:56.297

```
 [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(keyboardWasShown:)
                                                     name:UIKeyboardDidShowNotification
                                                   object:nil];
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(keyboardWasHidden:)
                                                     name:UIKeyboardDidHideNotification
                                                   object:nil];
        keyboardVisible = NO;

- (void)keyboardWasShown:(NSNotification *)aNotification {
    if ( keyboardVisible )
        return;

    if( activeTextField != MoneyCollected)
    {
        NSDictionary *info = [aNotification userInfo];
        NSValue *aValue = [info objectForKey:UIKeyboardBoundsUserInfoKey];
        CGSize keyboardSize = [aValue CGRectValue].size;

        NSTimeInterval animationDuration = 0.300000011920929;
        CGRect frame = self.view.frame;
        frame.origin.y -= keyboardSize.height-300;
        frame.size.height += keyboardSize.height-50;
        [UIView beginAnimations:@"ResizeForKeyboard" context:nil];
        [UIView setAnimationDuration:animationDuration];
        self.view.frame = frame;
        [UIView commitAnimations];

        viewMoved = YES;
    }

    keyboardVisible = YES;
}

- (void)keyboardWasHidden:(NSNotification *)aNotification {
    if ( viewMoved ) 
    {
        NSDictionary *info = [aNotification userInfo];
        NSValue *aValue = [info objectForKey:UIKeyboardBoundsUserInfoKey];
        CGSize keyboardSize = [aValue CGRectValue].size;

        NSTimeInterval animationDuration = 0.300000011920929;
        CGRect frame = self.view.frame;
        frame.origin.y += keyboardSize.height-300;
        frame.size.height -= keyboardSize.height-50;
        [UIView beginAnimations:@"ResizeForKeyboard" context:nil];
        [UIView setAnimationDuration:animationDuration];
        self.view.frame = frame;
        [UIView commitAnimations];

        viewMoved = NO;
    }

    keyboardVisible = NO;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-08T05:41:34.620

```
tabelview.contentInset =  UIEdgeInsetsMake(0, 0, 210, 0);
[tableview scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:your_indexnumber inSection:Your_section]
                 atScrollPosition:UITableViewScrollPositionMiddle animated:NO]; 
```

试试这个我的编码这对你有帮助

# c - 在C中随机化一个字符串

> ID：402674
> 
> 赞同：6
> 
> 时间：2008-12-31T10:21:27.250
> 
> 标签：c, algorithm, random

我正在尝试在 C 中生成 80 个字符的固定字符串的随机排列。令我沮丧的是，我正在使用的系统缺少 strfry()。我生成这个字符串的随机排列的最佳方法是什么？因为这将循环大约。100,000 次，性能是个问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-31T10:23:47.590

[只需使用Google Code](http://www.google.com/codesearch/p?hl=en#WbTnQ5DcqbM/glibc-2.1.3/string/strfry.c&q=strfry)找到的开源 GLIBC 实现即可。

```
char *
strfry (char *string)
{
  static int init;
  static struct random_data rdata;
  size_t len, i;

  if (!init)
    {
      static int state[8] = { 1, 2, 3, 4, 5, 6, 7, 8 };
      rdata.state = NULL;
      __initstate_r (time ((time_t *) NULL), state, 8, &rdata);
      init = 1;
    }

  len = strlen (string);
  for (i = 0; i < len; ++i)
    {
      int32_t j;
      char c;

      __random_r (&rdata, &j);
      j %= len;

      c = string[i];
      string[i] = string[j];
      string[j] = c;
    }

  return string;
} 
```

您可能希望将 GLIBC 特定数据类型更改为更通用的类型。

这段代码使用了[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)，它实际上很容易自己实现，而且非常高效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-02T16:49:00.763

创建一个 80 行的数组，将一个字符和一个随机数放入数组的每一行，然后根据随机数对数组进行排序。

从排序数组重建字符串。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-01T03:26:27.790

void gcry_randomize (unsigned char *buffer, size_t length, enum gcry_random_level level)

使用 level 定义的随机质量用长度随机字节填充缓冲区。

[http://www.g10code.com/p-libgcrypt.html](http://www.g10code.com/p-libgcrypt.html)

# embedded - FPGA 开发项目的好网站/博客

> ID：402677
> 
> 赞同：5
> 
> 时间：2008-12-31T10:24:10.320
> 
> 标签：embedded, vhdl, fpga, firmware

我正在寻找有关 FPGA 开发的有趣在线资源 - 网站、博客等。我所追求的是有趣的（希望不会太贵）项目的例子，人们可以尝试并从中学习。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T11:28:01.267

你试过[fpga4fun.com](http://www.fpga4fun.com/)或[fpga-forum.com](http://www.fpga-forum.com/wbb/)吗？

mikrocontroller.net （虽然是德语）[也有一个](http://www.mikrocontroller.net/articles/Linksammlung#Programmierbare_Logik_.28CPLD.2FFPGA.2FGAL.29)[linklist](http://www.mikrocontroller.net/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T10:45:27.577

[John Kent 的网站](http://members.optushome.com.au/jekent/FPGA.htm)是一个很好的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-24T07:00:51.933

试试 opencores.org - 它托管开源项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T16:03:10.540

很棒的网站，有有趣的项目和文章

[http://www.fpga4fun.com/](http://www.fpga4fun.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-19T05:48:05.157

我编制了一份 FPGA 在线资源列表。检查链接

[fpga-blog.tumblr.com/links](http://fpga-blog.tumblr.com/links/)

# php - 使用 cURL 和 PHP 为相同的键和文件上传混合多个值

> ID：402679
> 
> 赞同：13
> 
> 时间：2008-12-31T10:26:12.170
> 
> 标签：php, curl

我在 PHP 的 cURL 绑定中遇到了限制。似乎没有简单的方法可以为 postfields 的相同键发送相同的多个值。我遇到的大多数解决方法都涉及通过手动 tag=foo&tag=bar&tag=baz) 创建 URL 编码的帖子字段，而不是使用 CURLOPT_POSTFIELDS 的关联数组版本。

需要支持似乎是一件很常见的事情，所以我觉得我一定错过了一些东西。这真的是为同一个键处理多个值的唯一方法吗？

虽然这种解决方法可能被认为是可行的（如果不是很烦人的话），但我的主要问题是我需要能够为同一个键执行多个值并且还支持文件上传。据我所知，文件上传或多或少需要使用 CURLOPT_POSTFIELDS 的关联 arravy 版本。所以我觉得我被困住了。

我已经在 cURL PHP 邮件列表上更详细地[发布](http://curl.haxx.se/mail/curlphp-2008-12/0009.html)了这个问题，希望有人对此有一些想法。

非常感谢有关我可以在哪里查找更多信息的建议或提示！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-01T05:07:31.690

我最终编写了自己的函数来使用 multipart/form-data 构建自定义 CURLOPT_POSTFIELDS 字符串。多么痛苦。

```
function curl_setopt_custom_postfields($ch, $postfields, $headers = null) {
    // $postfields is an assoc array.
    // Creates a boundary.
    // Reads each postfields, detects which are @files, and which values are arrays
    // and dumps them into a new array (not an assoc array) so each key can exist
    // multiple times.
    // Sets content-length, content-type and sets CURLOPT_POSTFIELDS with the
    // generated body.
} 
```

我能够像这样使用这种方法：

```
curl_setopt_custom_postfields($ch, array(
    'file' => '@/path/to/file',
    'tag' => array('a', 'b', 'c'),
)); 
```

我不确定 CURLOPT_HTTPHEADER 堆栈，因此由于此方法调用它，因此我确定该函数将允许用户在需要时指定附加标头。

我[在这篇博](http://not-invented-here.com/2009/01/01/multiple-values-for-the-same-key-and-file-uploads-using-curl-and-php-solution/)文中有完整的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T11:03:43.610

如果您使用`tag[]`而不是`tag`名称，[PHP 将为您生成一个数组](http://www.php.net/manual/en/faq.html.php#faq.html.arrays)，换句话说，而不是

```
tag=foo&tag=bar&tag=baz 
```

你需要

```
tag[]=foo&tag[]=bar&tag[]=baz 
```

请注意，当 urlencoded 传输时，这应该变成

```
tag%5B%5D=foo&tag%5B%5D=bar&tag%5B%5D=baz 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-09-27T03:26:14.463

1.  为[PHP 错误 #51634](https://bugs.php.net/bug.php?id=51634)投票。
2.  试试@BeauSimensen 的答案。
3.  [Guzzle](http://docs.guzzlephp.org/en/stable/request-options.html#multipart)可以做到这一点。请参阅下面的示例。

```
$client = new \GuzzleHttp\Client();
$client->request('POST', $url, [
  'multipart' => [
    [ 'name' => 'foo', 'contents' => 'bar' ],
    [ 'name' => 'foo', 'contents' => 'baz' ],
  ]
]); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-05T21:03:47.323

我让它工作使用：

```
curl_setopt($ch, CURLOPT_POSTFIELDS,array('tag[0]'=>'val0','tag[1]'=>'val1')); 
```

然后`$_POST`导致：`$_POST['tag'][0] = 'val0'`和`$_POST['tag'][1] = 'val1'`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-10T00:14:48.380

我遇到了同样的问题。但我能够以这种方式解决它。

```
for($cnt = 0; $cnt < count($siteRows); $cnt++)
{
    $curlParams['site_ids['.$cnt.']'] = $siteRows[$cnt]->site_id; 
} 
```

也适用于文件：

```
for($cnt = 0; $cnt < count($imageRows); $cnt++)
{
    $curlParams['product_images['.$cnt.']'] = '@'.$imageRows[$cnt]->full_path;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T11:49:41.147

我认为一个键（或同一个键）中多个值的既定标准是将其与分隔符连接起来，例如在表单元素中选择多个选项列表。我相信这个分隔符是制表符 ( `\t`) 或管道符号 ( `|`)。

`[]`如果键名以(like )结尾`tag[]`，PHP 会自动将值转换为数组以方便您使用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-31T21:36:42.270

lImbus 和保罗，感谢您的意见。

如果我可以控制我发布到的表单，我可能会找到解决此问题的替代解决方案。但是，我对表单没有任何控制权。而且我几乎可以肯定，阅读这篇文章的软件不是 PHP 并且不遵守 tag[] 标准。

即使这样做了，cURL 似乎也不遵守 tag[] 语法。基本上，我尝试了以下方法，但都没有奏效......

```
curl_setopt($ch, CURLOPT_POSTFIELDS, array('file' => '@/pathtofile', 'tag[]' => array('a', 'b', 'c'));

curl_setopt($ch, CURLOPT_POSTFIELDS, array('file' => '@/pathtofile', 'tag' => array('a', 'b', 'c')); 
```

再说一次，我不认为传递标签 [] 无论如何都会起作用，因为我要发布的表单实际上是在寻找“标签”而不是“标签 []”。

我真的开始觉得 cURL PHP 绑定真的不支持这个。这对我来说似乎很令人惊讶。它似乎可以做任何其他事情，但它无法做这样简单的事情？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-25T17:18:38.610

***不要使用 GUZZLE***：

```
# at your command line start php interactive
user@group:~:php -a
php > $arr=array('var' => array(1,2,3,4)); 
php > echo http_build_query($arr);
var%5B0%5D=1&var%5B1%5D=2&var%5B2%5D=3&var%5B3%5D=4
php > echo urldecode(http_build_query($arr));
var[0]=1&var[1]=2&var[2]=3&var[3]=4 
```

因此，您需要[http_build_query](https://www.php.net/http_build_query)在其中传递键值的哈希数组；您的（数组）变量作为键输入，其值为数组而不是标量值，如`'var' => array(1,2,3,4)`. 现在，`http_build_query`可以格式化`curl`命令的帖子字段：

```
$fields = array('key1' => 'value1', 'var' => array(1,2,3,4));
$curlPost = \http_build_query($fields);
curl_setopt($ch, CURLOPT_POSTFIELDS, $curlPost); 
```

那是 3 行代码！Guzzle 中有多少 1000 行代码？(*)

到目前为止，我曾经`curl`：

*   成功管理 Google OAuth 协议

*   与[mailgun等 API 连接](https://documentation.mailgun.com/en/latest/user_manual.html)

*   处理贝宝[智能按钮](https://developer.paypal.com/docs/checkout/)

那是用大约 100 行替换了数百万行！

(*)：*结果`http_build_query`可以根据您的需要进一步格式化。*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-28T07:30:56.417

我遇到了同样的问题，我必须将一个必须是数组的参数从 PHP 服务器发送到另一个不使用 '[]' 来混合具有相同键的值和文件的服务器。在 Laravel 8 中，我可以使用[Http 客户端](https://laravel.com/docs/8.x/http-client)实现这个目标（当然 Http 客户端使用 guzzle）。这是我的代码示例。

```
Illuminate\Support\Facades\Http::attach('file', $fileContents, 'file-name')
->post('https://destination' , [['name' => 'tag', 'content' => 'foo'], ['name' => 'tag', 'content' => 'bar']]) 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-10-04T02:45:07.890

我在网上找到了这个答案，想在它消失之前把它贴在这里：

[http://yeehuichan.wordpress.com/2011/08/07/sending-multiple-values-with-the-same-namekey-in-curl-post/](http://yeehuichan.wordpress.com/2011/08/07/sending-multiple-values-with-the-same-namekey-in-curl-post/)

```
function curl_setopt_custom_postfields($ch, $postfields, $headers = null) {
    $algos = hash_algos();
    $hashAlgo = null;
    foreach ( array('sha1', 'md5') as $preferred ) {
        if ( in_array($preferred, $algos) ) {
            $hashAlgo = $preferred;
            break;
        }
    }
    if ( $hashAlgo === null ) { list($hashAlgo) = $algos; }
    $boundary =
        '----------------------------' .
        substr(hash($hashAlgo, 'cURL-php-multiple-value-same-key-support' . microtime()), 0, 12);

    $body = array();
    $crlf = "\r\n";
    $fields = array();
    foreach ( $postfields as $key => $value ) {
        if ( is_array($value) ) {
            foreach ( $value as $v ) {
                $fields[] = array($key, $v);
            }
        } else {
            $fields[] = array($key, $value);
        }
    }
    foreach ( $fields as $field ) {
        list($key, $value) = $field;
        if ( strpos($value, '@') === 0 ) {
            preg_match('/^@(.*?)$/', $value, $matches);
            list($dummy, $filename) = $matches;
            $body[] = '--' . $boundary;
            $body[] = 'Content-Disposition: form-data; name="' . $key . '"; filename="' . basename($filename) . '"';
            $body[] = 'Content-Type: application/octet-stream';
            $body[] = '';
            $body[] = file_get_contents($filename);
        } else {
            $body[] = '--' . $boundary;
            $body[] = 'Content-Disposition: form-data; name="' . $key . '"';
            $body[] = '';
            $body[] = $value;
        }
    }
    $body[] = '--' . $boundary . '--';
    $body[] = '';
    $contentType = 'multipart/form-data; boundary=' . $boundary;
    $content = join($crlf, $body);
    $contentLength = strlen($content);

    curl_setopt($ch, CURLOPT_HTTPHEADER, array(
        'Content-Length: ' . $contentLength,
        'Expect: 100-continue',
        'Content-Type: ' . $contentType,
    ));

    curl_setopt($ch, CURLOPT_POSTFIELDS, $content);

} 
```

并使用它：

```
curl_setopt_custom_postfields($ch, array(
    'file' => '@a.csv',
    'name' => array('James', 'Peter', 'Richard'),
)); 
```

# java - 如何从 jar 中获取 jar URL：包含“！”的 URL 以及 jar 中的特定文件？

> ID：402683
> 
> 赞同：19
> 
> 时间：2008-12-31T10:30:38.467
> 
> 标签：java, file, url, path, jar

我在运行时得到一个 jar 文件 url：

```
jar:file:///C:/proj/parser/jar/parser.jar!/test.xml 
```

如何将其转换为有效路径：

```
C:/proj/parser/jar/parser.jar. 
```

我已经尝试使用`File(URI)`, `getPath()`,`getFile()`徒劳无功。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-31T11:22:04.290

如果 MS-Windows 没有被前导斜杠冒犯，这可能会做到：

```
 final URL jarUrl =
        new URL("jar:file:/C:/proj/parser/jar/parser.jar!/test.xml");
    final JarURLConnection connection =
        (JarURLConnection) jarUrl.openConnection();
    final URL url = connection.getJarFileURL();

    System.out.println(url.getFile()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T11:09:06.423

不确定是否有任何确切的方法可以满足您的需求，但这应该会让您接近：

```
import static org.junit.Assert.assertEquals;

import java.net.URL;

import org.junit.Test;

public class UrlTest {

    @Test
    public void testUrl() throws Exception {
        URL jarUrl = new URL("jar:file:/C:/proj/parser/jar/parser.jar!/test.xml");
        assertEquals("jar", jarUrl.getProtocol());
        assertEquals("file:/C:/proj/parser/jar/parser.jar!/test.xml", jarUrl.getFile());
        URL fileUrl = new URL(jarUrl.getFile());
        assertEquals("file", fileUrl.getProtocol());
        assertEquals("/C:/proj/parser/jar/parser.jar!/test.xml", fileUrl.getFile());
        String[] parts = fileUrl.getFile().split("!");
        assertEquals("/C:/proj/parser/jar/parser.jar", parts[0]);
    }
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-21T15:14:04.087

此解决方案将处理路径中的空格。

```
String url = "jar:file:/C:/dir%20with%20spaces/myjar.jar!/resource";
String fileUrl = url.substring(4, url.indexOf('!'));
File file = new File(new URL(fileUrl).toURI());
String fileSystemPath = file.getPath(); 
```

或以 URL 对象开头：

```
...
String fileUrl = url.getPath().substring(0, url.indexOf('!'));
... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T11:35:14.967

有些人可能会认为这有点“hacky”，但它会在那种情况下完成这项工作，我相信它会比在其他建议中创建所有这些对象更好。

```
String jarUrl = "jar:file:/C:/proj/parser/jar/parser.jar!/test.xml";

jarUrl = jarUrl.substring(jarUrl.indexOf('/')+1, jarUrl.indexOf('!')); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-08T07:00:18.440

我只需要这样做。

```
 URL url = clazz.getResource(clazz.getSimpleName() + ".class");
        String proto = url.getProtocol();
        boolean isJar = proto.equals("jar"); // see if it's in a jar file URL

        if(isJar)
        {
            url = new URL(url.getPath()); // this nicely strips off the leading jar: 
            proto = url.getProtocol();
        }

        if(proto.equals("file"))
        {
             if(isJar) 
                // you can truncate it at the last '!' here
        } 
        else if(proto == "http") {
            ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-21T07:36:30.120

```
 //This code will work on both Windows and Linux
  public String path()
  {
  URL url1 = getClass().getResource("");
  String urs=url1.toString();
  urs=urs.substring(9);
  String truepath[]=urs.split("parser.jar!");
  truepath[0]=truepath[0]+"parser.jar";
  truepath[0]=truepath[0].replaceAll("%20"," ");
  return truepath[0];
  } 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-09-14T03:41:31.207

你可以这样做。这行得通

```
 ClassLoader loader = this.getClass().getClassLoader();
    URL url = loader.getResource("resource name");
    String[] filePath = null;
    String protocol = url.getProtocol();
    if(protocol.equals("jar")){
        url = new URL(url.getPath());
        protocol = url.getProtocol();
    }
    if(protocol.equals("file")){
        String[] pathArray = url.getPath().split("!");
        filePath = pathArray[0].split("/",2);
    }
    return filePath[1]; 
```

# joomla - 自动从网站复制新文章

> ID：402685
> 
> 赞同：2
> 
> 时间：2008-12-31T10:33:06.977
> 
> 标签：joomla

我正在建立一个网站，其中一个部分将显示来自不同网站的公告。（通知是公开的，没有侵犯版权）我需要做的是在目标站点上有新通知时自动更新我的站点。我使用 Joomla 作为我的 CMS。有任何想法吗？

更新 - 不幸的是没有 RSS 提要 :(

谢谢和问候， 南德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T11:31:20.027

有一些工具可以抓取站点并将其转换为 RSS（但是，您必须做一些工作来指定如何为新站点进行转换）。例如参见[http://rssscraper.rubyforge.org/](http://rssscraper.rubyforge.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T10:37:19.543

如果其他站点为他们的通知提供 RSS 提要，最简单的方法是使用 Joomla 的 RSS 插件来呈现它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T11:13:56.630

由于您的目标还没有 RSS 提要——您可以用 PHP 编写一个（IIRC Joomla 是用它编写的，所以我假设支持）。您只需要连接到远程网站，并解析 HTML（正则表达式是您的朋友）以生成提要数据；我倾向于将此输出作为 RSS，然后进入您的 Joomla 站点。

解析 HTML 的缺点包括对他们的网站布局添加了极大的依赖——这可以通过“给”他们生成 RSS 供他们托管的 php 来缓解，因为这会为他们的网站增加价值，以及转移所有权对他们的维护。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T12:04:30.320

您可以使用[yahoo 管道](http://pipes.yahoo.com/)和/或[yahoo 查询语言](http://developer.yahoo.com/yql/)(yql)将网站转换为 rss 或 xml

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-31T13:07:02.940

需要注意的是，“公共”并不意味着无版权，除非明确置于**公共领域**。有很多东西是公开的，同时保留了它们的自动版权。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T23:32:11.463

如果您可以查看您尝试从中提取信息的网站的 HTML 代码，并且他们的新闻文章实体具有逻辑命名系统，您应该能够使用 fopen 命令，例如。

```
<?php
$handle = fopen("http://www.example.com/", "r");
?> 
```

如果文章代码的布局如下所示，则使用它从文章代码中提取的信息：

```
<div class="post" id="post-16283">
    <div class="postheader">
        <h1 id="article-title">Test Article Code</h1>
    </div>
    <div class="postcontent">
        This is the article text
    </div>
    <div class="postfooter">
        Copyright Information
    </div>
</div> 
```

然后，您可以使用以下 php 代码显示文章的所有标题：

```
if (preg_match_all("#<div class="postheader"(.*?)</div>#s", $handle, $matches, PREG_PATTERN_ORDER) > 0) {
    foreach ($matches[0] as $match) {
        echo $match;
    }
} 
```

这只是如何从网页中提取信息的基本指标。它可以被开发，因此您可以从网页上逐条提取信息，然后甚至以您自己的方式对其进行格式化。

希望有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T11:50:22.687

我同意 frankodwyer 和 Rowland 的回答，但要考虑的一件事是让网站所有者（如果它仍在积极开发，我假设如果有新消息）**添加一个 RSS 提要**。这不是最难做的事情。

# .net - 跨平台桌面 GUI 的首选开发平台？

> ID：402688
> 
> 赞同：3
> 
> 时间：2008-12-31T10:35:15.570
> 
> 标签：.net, user-interface, mono, gtk

[我的这个相关问题](https://stackoverflow.com/questions/61559/is-c-with-net-mono-or-java-the-better-choice-for-cross-platform-development)的答案使我为我的大多数后端服务（它是一个多组件系统）选择了 Java。现在，我不确定这对于跨平台桌面 GUI 应用程序是否也是一个不错的选择。我记得使用的 Java 桌面应用程序具有我不喜欢的非本地外观，但我不确定这是否取决于 GUI 工具包而不是语言的选择。

我的大部分 GUI 都是基于 Web 的，而桌面版的用户（管理员、开发人员和测试人员）相对较少，所以我只能留出一小部分时间预算来做这些。不过，我想要原生外观并避免一堆依赖项。

从我想使用的 GUI 工具包开始，然后选择支持它的语言可能是最合适的。我知道的跨平台的有：

*   GTK
*   qt
*   AIR（当它出现在 Linux 上时）

因此，例如，我可能会将 GTK# 与 .Net/Mono 一起使用。我将面临什么样的依赖问题？您是否建议将实际的 GUI 与应用程序的其余部分分开并在 Linux 上使用 GTK，以及在 Windows 上使用原生的东西，例如 Windows Forms，从而避免必须在 Windows 上安装 GTK？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T11:02:40.443

SWT 是您的答案。我参与了一个使用 SWT 的项目，无论你扔什么它看起来都很棒。如果您使用 Java，那么您可能使用过最好的 SWT 示例：Eclipse。它适用于 GTK、WinForms、Cocoa、Qt 甚至 Tk。哦！一旦掌握了所有基础知识，这将非常容易。此外，大部分组件已准备就绪。另一件事，GT​​K 和 C# 并不是你想象的那样独立于平台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T10:56:19.303

Bruce Eckel 是 Fl​​ex 作为 Java 和 python 服务的跨平台用户界面的重要赞助商。他在 Artima 上写了很多关于它的文章：

*   [混合 Java](http://www.artima.com/weblogs/viewpost.jsp?thread=193593)
*   [在您的应用程序上放置一个 Flex UI](http://www.artima.com/weblogs/viewpost.jsp?thread=208528)
*   [Python、Twisted 和 Flex 的并发性](http://www.artima.com/weblogs/viewpost.jsp?thread=230001)

# security - 安全测试类型

> ID：402705
> 
> 赞同：3
> 
> 时间：2008-12-31T10:43:16.693
> 
> 标签：security, testing

有哪些不同类型的安全测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-05-12T07:11:01.870

**[我们有一个相当完整的列表，在此处](https://security.stackexchange.com/questions/1621/nessus-vs-third-party-scans/1623#1623)**和**[此处](https://security.stackexchange.com/q/2837/485)**的 Security Stack Exchange 上进行了讨论。

**发现**

此阶段的目的是识别范围内的系统和正在使用的服务。它并非旨在发现漏洞，但版本检测可能会突出显示已弃用的软件/固件版本，从而指示潜在的漏洞。

**漏洞扫描**

在发现阶段之后，它通过使用自动化工具将条件与已知漏洞匹配来查找已知的安全问题。报告的风险级别由工具自动设置，无需测试供应商手动验证或解释。这可以通过基于凭据的扫描来补充，该扫描通过使用提供的凭据对服务（例如本地 Windows 帐户）进行身份验证来消除一些常见的误报。

**漏洞评估**

这使用发现和漏洞扫描来识别安全漏洞并将发现结果放入被测环境的上下文中。一个例子是从报告中删除常见的误报，并确定应该应用于每个报告结果的风险级别，以提高业务理解和背景。

**安全评估**

在漏洞评估的基础上添加手动验证以确认暴露，但不包括利用漏洞获得进一步访问权限。验证可以采用授权访问系统的形式，以确认系统设置，并涉及检查日志、系统响应、错误消息、代码等。安全评估旨在获得对被测系统的广泛覆盖，而不是深度特定漏洞可能导致的暴露。

**渗透测试**

渗透测试模拟恶意方的攻击。建立在之前的阶段，并涉及利用发现的漏洞来获得进一步的访问权限。使用这种方法将有助于了解攻击者获取机密信息、影响数据完整性或服务可用性以及相应影响的能力。每项测试都使用一致且完整的方法进行处理，使测试人员能够利用他们解决问题的能力、一系列工具的输出以及他们自己的网络和系统知识来发现可能/无法识别的漏洞自动化工具。与着眼于更广泛覆盖范围的安全评估方法相比，这种方法着眼于攻击的深度。

**安全审计**

由审计/风险功能驱动，以查看特定的控制或合规问题。这种类型的参与具有范围狭窄的特点，可以利用前面讨论的任何方法（漏洞评估、安全评估、渗透测试）。

**安全审查**

验证行业或内部安全标准已应用于系统组件或产品。这通常通过差距分析并利用构建/代码审查或通过审查设计文档和架构图来完成。此活动不使用任何早期方法（漏洞评估、安全评估、渗透测试、安全审计）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T12:44:42.487

*   风险评估 - 创建威胁模型并定义将要测试的内容。
*   安全审计——使用威胁模型来探测系统设计。
*   漏洞扫描 - 使用软件探测系统实施。
*   渗透测试——试图从外部或内部侵入系统。
*   操作测试——在系统投入生产后进行上述部分或全部测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-02T14:52:38.830

*   漏洞扫描 - 通常是针对已知漏洞签名扫描一个或多个系统的自动化程序。

*   安全扫描 - 这是一个漏洞扫描加上对发现的手动验证，以帮助消除误报/误报。渗透测试 - 测试人员将尝试获得访问权限并证明对系统所有者的访问权限。

*   风险评估 - 涉及对员工访谈的安全分析，其中包含发现风险的商业和行业理由。

*   安全审计——通常是对软件代码和/或操作系统的深入审计。这通常是对代码进行非常彻底的逐行检查。

*   道德黑客 - 这与渗透测试非常相似，但通常是针对多个系统进行的许多测试，以发现尽可能多的攻击向量。

*   态势评估和安全测试——这结合了安全扫描、道德黑客攻击和风险评估，以显示组织的整体安全态势。

这些安全测试类型中的每一种都可以通过不同的方法进一步细分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-22T11:07:18.970

渗透可以有不同的类型，大致分类如下：

*   Web 参数篡改：用户操纵客户端和服务器之间交换的参数，并修改应用程序数据，例如用户凭据、权限、产品价格或数量等，以谋取利益。

*   数据库篡改：破坏支持系统和存储对业务或应用程序运行至关重要的数据的数据库

*   Cookie 窃取：利用有效的计算机会话来获得未经授权的访问

*   跨站点脚本：攻击者在客户端代码中注入恶意脚本以重定向网站链接。

*   跨站请求伪造：也称为一键式攻击或会话骑行，未经授权

*   特权升级：侵入老年人的身份证并滥用特权。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-25T06:09:32.830

让我们通过讨论您可能执行的不同类型的安全测试将安全测试分解为其组成部分。

**静态代码分析** 静态代码分析可能是我想到的第一种安全测试，也是最古老的形式。静态代码分析涉及审查源代码以识别可能导致应用程序（或应用程序有权访问的资源）中的安全漏洞的问题。使用此类分析可能会寻找的典型漏洞示例是可能导致缓冲区溢出或注入攻击的编码缺陷。

可以手动执行一些静态代码分析，这意味着开发人员手动通读代码以查找安全漏洞。但是，考虑到许多源代码文件的大小，大规模地这样做通常是不切实际的；另外，人类很容易忽视缺陷。这就是为什么使用自动分析工具扫描您的源代码很重要的原因。

**渗透测试** 渗透测试涉及模拟对应用程序或基础设施的攻击，以识别弱点。例如，您可以使用类似 nmap 的工具尝试从不受信任的主机连接到网络上的所有端点，并查看是否有任何端点接受连接；如果他们这样做，您可能想让他们停止接受来自任意主机的连接。

有些人可能会争辩说，渗透测试应该细分为子类别，因为渗透测试有不同类型。有些专注于网络，有些专注于应用程序，有些专注于身份验证网关，有些专注于数据库，等等。

**合规性测试** 合规性测试（有时称为一致性测试）用于评估配置、架构或流程是否符合组织的预定义策略。合规性测试并不严格限于安全领域；例如，您可以想象使用合规性测试来帮助维护应用程序性能或响应时间的标准。

但是，在安全性方面，合规性测试是确保给定应用程序的配置或部署体系结构符合组织设定的最低标准的重要资源。合规性测试通常通过将实际配置与被认为安全的配置进行比较来进行。当测试发现不一致时，管理员知道可能存在安全问题或其他问题。

**负载测试** 负载测试是指测量应用程序或基础设施在高需求下如何执行的测试。负载测试通常不被认为是一种安全测试。它更常用于帮助优化应用程序性能和可用性。

但是，安全管理员可能也希望关注负载测试结果是有原因的。原因是分布式拒绝服务或 DDoS 攻击，其目的是通过流量或其他请求使应用程序或其主机基础设施不堪重负来破坏应用程序的可用性。

**源分析测试** 随着开源软件在过去十年中的普及，源分析测试的重要性也随之增加。这种类型的测试可帮助开发人员和安全管理员确定给定源代码的来源。

如果您的一些源代码来自第三方项目或存储库——这在当今很常见，因为开发人员可以轻松地将上游开源代码整合到他们的应用程序中——安全管理员需要确保任何该代码中的已知漏洞已得到解决，并且该代码符合内部安全标准。

# wpf - WPF - 如何为网格的鼠标悬停编写触发器？

> ID：402736
> 
> 赞同：19
> 
> 时间：2008-12-31T11:00:00.370
> 
> 标签：wpf, triggers

我看到 Button 对象有一个 IsMouseOVer 属性。

但是如何为没有 IsMouseOver 的网格或其他元素的鼠标悬停创建效果？

谢谢马尔科姆

编辑：我想通了。我使用了错误的方法来设置触发器。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2011-03-22T17:18:20.113

我意识到我正在回复一个死线程，但是因为我遇到了它，并且由于线程没有被回答，所以我要回答它。

[WPF 网格](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.aspx)有一个“ IsMouseOver”属性。

我认为问这个问题是因为“IsMouseOver”属性仅在鼠标位于网格本身内的“可命中测试”控件（即按钮或组合框）上时才会更改。

因此，“IsMouseOver”属性可能看起来不起作用（特别是如果您在触发器中使用它来设置 Grid 的 Visible 属性）。

例如：

```
<Grid>
  <Grid.ColumnDefinitions>
    <ColumnDefinition Width="25" />
    <ColumnDefinition />
  </Grid.ColumnDefinitions>

  <Button Grid.Column="1">A Button</Button>

  <Grid.Style>
    <Style TargetType="{x:Type Grid}">
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="False">
          <Setter Property="Opacity" Value="0.5"></Setter>
        </Trigger>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Opacity" Value="1"></Setter>
        </Trigger>
      </Style.Triggers>
    </Style>
  </Grid.Style>
</Grid> 
```

上面的网格和它的内容将以半透明的方式显示。如果将鼠标悬停在第一列（不包含任何内容）上，您会注意到不透明度*不会设置为完全；*但是，如果您将鼠标悬停在第二列中的按钮上，则不透明度*将设置为完全。*这是因为第一列没有任何内容，不能进行命中测试。而第二列中的按钮是可命中测试的，因此会触发事件。

如果您希望 Grid 的 IsMouseOver 属性检测鼠标何时位于 Grid 本身上方的任何位置，您只需将 Grid 的 Background 属性设置为非 Null 的值（例如将其设置为透明）。设置 Background 属性将使 Grid “hit-testable”。

以下代码将解决该问题：

```
<Grid Background="Transparent">
  <Grid.ColumnDefinitions>
    <ColumnDefinition Width="25" />
    <ColumnDefinition />
  </Grid.ColumnDefinitions>

  <Button Grid.Column="1">A Button</Button>

  <Grid.Style>
    <Style TargetType="{x:Type Grid}">
      <Style.Triggers>
        <Trigger Property="IsMouseOver" Value="False">
          <Setter Property="Opacity" Value="0"></Setter>
        </Trigger>
        <Trigger Property="IsMouseOver" Value="True">
          <Setter Property="Opacity" Value="1"></Setter>
        </Trigger>
      </Style.Triggers>
    </Style>
  </Grid.Style>
</Grid> 
```

-弗林尼

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-01-03T18:48:24.840

也可以这样使用`MouseEnter`/`MouseLeave`事件：

```
<Grid Name="grid">
    <Grid.Triggers>
        <EventTrigger RoutedEvent="MouseEnter">
            <BeginStoryboard>
                <Storyboard>
                    <ThicknessAnimation Storyboard.TargetProperty="Margin" From="0,0,-300,0" To="0,0,0,0" DecelerationRatio=".9" Duration="0:0:1" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="MouseLeave">
            <BeginStoryboard>
                <Storyboard>
                    <ThicknessAnimation Storyboard.TargetProperty="Margin" From="0,0,0,0" To="0,0,-300,0" AccelerationRatio=".9" Duration="0:0:1" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Grid.Triggers>
</Grid> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-18T20:51:56.297

那将是 WPF 对象上的“MouseEnter”和“MouseLeave”操作。

# delphi - Delphi 代码格式化程序

> ID：402737
> 
> 赞同：26
> 
> 时间：2008-12-31T11:02:05.827
> 
> 标签：delphi, code-formatting, delphi-2006

有没有重新格式化 Delphi 代码的实用程序？

编辑

我正在使用德尔福 2006

**一些反馈**

感谢所有回答这个问题的人

我一直在使用 JCF 代码格式化程序 - 它运行良好，并且我的代码已格式化为[Object Pascal Style Guide](http://edn.embarcadero.com/article/10280)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-31T11:14:27.300

你可以试试“[绝地代码格式](http://jedicodeformat.sourceforge.net/)”。在此处查看更多信息：http: [//jedicodeformat.sourceforge.net/](http://jedicodeformat.sourceforge.net/)

DelForExp 的格式化引擎已集成到 GExperts 的代码库中。[GExperts](http://www.gexperts.org)的实验版本，包括“代码格式化程序”：
[http ://blog.dummzeuch.de/experimental-gexperts-version/](http://www.dummzeuch.de/delphi/gexperts/english.html)

DelForExp 的单独信息/下载在[这里](http://codeverge.com/embarcadero.delphi.non-tech/delforex.zip/1080963)。

问候。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-31T12:22:40.207

一段时间以来，我一直在发布实验性 GExperts 版本，其中包括以前称为 DelForEx 的代码格式化程序，并进行了一些改进和修复。最新版本从 2020-10-23 开始，支持以下 Delphi 版本：

*   德尔福 6 到 7
*   德尔福 2005 至 2010
*   德尔福 XE
*   德尔福 XE2 到 XE8
*   德尔福 10 到 10.4
*   Delphi 11（危险，Alpha 版本现在 2021-10-24）

但是请注意，我只在 Delphi 2007 中使用它，所以其他版本可能有未知的错误。此外，并非所有后来的 Delphi 版本的语言改进都会起作用，例如嵌套类型、泛型和匿名方法。

有关详细信息，请参阅[gexperts.dummzeuch.de](https://gexperts.dummzeuch.de/)。

顺便说一句：任何改进格式化程序的帮助，特别是添加新的语言结构将不胜感激。源代码可以从我主页链接的 subversion 存储库中下载。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T11:14:45.910

我发现了这个：[JEDI 代码格式](http://jedicodeformat.sourceforge.net/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-07T12:15:35.100

lextudio -CodeGear RAD Studio 2007 的代码美化器集合 6

[http://code.google.com/p/lextudio/](http://code.google.com/p/lextudio/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-31T11:18:28.430

是的，

我一直使用 TWM 的实验版 os GExperts，它支持这个功能。

在 Delphi 2006 和 2007 中，它运行良好（虽然不知道旧版本）。

当前版本正在增加对Delphi 2009的支持，但我不知道它在哪个阶段，你可以在这里找到更多关于它的信息：

[http://www.dummzeuch.de/delphi/gexperts/english.html](http://www.dummzeuch.de/delphi/gexperts/english.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-24T12:20:58.650

顺便说一句：自[Delphi 2010](http://docwiki.embarcadero.com/RADStudio/en/What%27s_New_in_Delphi_and_C++Builder_2010#Code_Editor_Changes)以来就有一个集成的[源代码格式化](http://docwiki.embarcadero.com/RADStudio/en/Formatting_Source_Code)程序。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-08-26T12:18:12.823

Free Pascal 还有一个 codeformatter，ptop，但它只实现了更基本的方言（比如 D4-D6 级别）。

Lazarus 最近更改为使用 Jedi 代码格式化程序 afaik。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-31T12:19:39.493

GExperts 的 TWM 版本运行良好，并且很好地集成到了 IDE 中。它使您能够编写和修改您的代码，而不必过多担心精确的格式，然后只需点击分配的热键，它就会立即重新格式化。我一直发现设置起来很容易以匹配我喜欢的样式，并且不像 JEDI 代码格式那样复杂，这对我来说看起来有点过头了。

Delphi 2009 版本现在可以从上面发布的链接中获得，尽管它基于 GExperts 的 beta 版本。不过，它在下面仍然是大致相同的格式化程序，并且不知道一些较新的 Delphi 增强功能的语法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-06-02T10:49:40.297

我刚刚做了一个基于JCF的在线pascal代码美化器。你可以试试[https://pak.lebah.web.id/jcf](https://pak.lebah.web.id/jcf)

HTH。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-07T07:51:19.747

OPEdit II 是免费的，而且效果很好。它是一个全文编辑器，具有代码重构和代码浏览功能。有一个文本格式化程序，它使用内部代码解析器，因此处理条件定义就像一个真正的 Delphi 编译器。见[http://www.codefactor2.com](http://www.codefactor2.com)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-15T19:55:56.847

有一个程序[PascalFormat](http://www.rosseeld.be/DRO/PIC/PascalFormat.htm) [![在此处输入图像描述](https://i.stack.imgur.com/WX98k.png)](https://i.stack.imgur.com/WX98k.png)

# regex - 如何从 Perl 的文件中读取自定义模式？

> ID：402763
> 
> 赞同：3
> 
> 时间：2008-12-31T11:16:23.553
> 
> 标签：regex, perl, logging

提前祝大家新年快乐。

我有一个错误日志文件，其中包含模式参数、结果和 stderr 中的内容（stderr 可以在多行中）。

```
$cat error_log

<parameter>:test_tot_count
<result>:1
<stderr>:Expected "test_tot_count=2" and the actual value is 3
test_tot_count = 3
<parameter>:test_one_count
<result>:0
<stderr>:Expected "test_one_count=2" and the actual value is 0
test_one_count = 0
<parameter>:test_two_count
<result>:4
<stderr>:Expected "test_two_count=2" and the actual value is 4
test_two_count = 4
... 
```

我需要在 Perl 中编写一个函数来将每个参数、结果和 stderr 存储在数组或哈希表中。

这是我们自己内部定义的结构。我这样写了 Perl 函数。有没有更好的方法使用正则表达式本身来做到这一点？

```
my $err_msg = "";
while (<ERR_LOG>)
{
    if (/<parameter>:/)
    {
        s/<parameter>://;
        push @parameter, $_;
    }
    elsif (/<result>:/)
    {
        s/<result>://;
        push @result, $_;
    }
    elsif (/<stderr>:/)
    {
        if (length($err_msg) > 0)
        {
            push @stderr, $err_msg;
        }
        s/<stderr>://;
        $err_msg = $_;
    }
    else
    {
        $err_msg .= $_;
    }
 } 
 if (length($err_msg) > 0)
 {
    push @stderr, $err_msg;
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T13:18:58.703

如果你使用的是 Perl 5.10，你可以做一些与你现在非常相似的事情，但是通过使用给定的/当结构，你可以使用更好的布局：

```
use 5.010;

while (<ERR_LOG>) {
    chomp;
    given ($_) {
        when ( m{^<parameter>: (.*)}x )  { push @parameter, $1     }
        when ( m{^<result>:    (.*)}x )  { push @result,    $1     }
        when ( m{^<stderr>:    (.*)}x )  { push @stderr,    $1     }
        default                          { $stderr[-1]   .= "\n$_" }
    }
} 
```

值得注意的是，对于这里的默认情况，我没有保留单独的 $err_msg 变量，而是在`@stderr`看到标签时直接推进，如果看到续行则`stderr`附加到数组的最后一项。`@stderr`当我看到续行时，我会添加一个换行符，因为我假设您希望保留它们。

尽管上面的代码看起来很优雅，但我并不是*很*喜欢保留三个单独的数组，因为如果事情不同步，它可能会让你头疼，而且如果你想在未来添加更多字段，你'最终会出现很多你需要跟踪的变量。我建议将每条记录存储在哈希中，然后保留一组记录：

```
use 5.010;

my @records;

my $prev_key;

while (<ERR_LOG>) {
    chomp;
    given ($_) {
        when ( m{^<parameter>  }x ) { push(@records, {}); continue;          }
        when ( m{^<(\w+)>: (.*)}x ) { $records[-1]{$1} = $2; $prev_key = $1; }
        default                     { $records[-1]{$prev_key} .= "\n$_";     }
    }
} 
```

在这里，当我们看到一个字段时，我们将一条新记录推送到数组中，每当我们看到键/值对时向我们的哈希添加一个条目，如果我们看到续行，则附加到我们添加的最后一个字段。的最终结果`@records`如下所示：

```
(
    {
        parameter => 'test_one_count',
        result    => 0,
        stderr    => qq{Expected "test_one_count=2" and the actual value is 0\ntest_one_count=0},
    },
    {
        parameter => 'test_two_count',
        result    => 4,
        stderr    => qq{Expected "test_two_count=2" and the actual value is 4\ntest_two_count=4},
    }
) 
```

现在您可以只传递一个包含所有记录的数据结构，并且您可以在将来添加更多字段（甚至是多行字段）并且它们将被正确处理。

如果您没有使用 Perl 5.10，那么这可能是升级的好借口。如果没有，您可以将 given/when 结构转换为更传统的 if/elsif/else 结构，但它们在转换中失去了很多美感。

*保罗*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T12:39:43.027

重构跳出来的主要内容是匹配、剥离和存储中的重复。像这样（未经测试）的代码更简洁：

```
my( $err_msg , %data );

while (<ERR_LOG>) {
  if(( my $key ) = $_ =~ s/^<(parameter|result|stderr)>:// ) {
    if( $key eq 'stderr' ) {
      push @{ $data{$key} } , $err_msg if $err_msg;
      $err_msg = $_;
    }
    else { push @{ $data{$key} } , $_ }
  }
  else { $err_msg .= $_ }
}

# grab the last err_msg out of the hopper
push @{ $data{stderr} } , $err_msg; 
```

...但从现在起六个月后可能更难理解... 8^)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T11:35:52.250

看起来不错。=) 一个改进可能是将这些标签锚定在行的开头：

```
if (/^<parameter>:/) 
```

它会使脚本更加健壮。

如果您抓住标签之后的内容并仅使用该部分，您还可以避免剥离标签：

```
if (/^<parameter>:(.*)/s)
{
  push @parameter, $1;
} 
```

# wpf - 在 WPF 中播放 QuickTime 视频

> ID：402772
> 
> 赞同：1
> 
> 时间：2008-12-31T11:22:42.510
> 
> 标签：wpf, video, quicktime

是否可以在 WPF 中播放 QuickTime 视频？如果是的话，谁能给我提供资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T11:33:47.683

Quicktime 在 Windows 上是一件棘手的事情。除了 C++ 之外，几乎不存在任何语言的 API。这是来自 Apple 开发者网站的一些文档；[用于 Windows 的 Quicktime 开发](http://developer.apple.com/documentation/QuickTime/RM/QTforWindows/QTforWindows/C-Chapter/chapter_1000_section_1.html#//apple_ref/doc/uid/TP40000940-BuildingQuickTimeCapabilityIntoaWindowsApplication-SW1)。但我怀疑这对您的 WPF 开发有用。

另一种选择是使用[Quicktime ActiveX 控件/COM 对象](http://developer.apple.com/quicktime/activexcontrol.html)。它本质上是一个控制最少的内置播放器。

# .net - 调试在 Dev Studio 之外构建的 .NET 程序集

> ID：402773
> 
> 赞同：3
> 
> 时间：2008-12-31T11:22:58.110
> 
> 标签：.net, visual-studio, visual-studio-2005

我有一个 .NET 项目，它引用了在解决方案之外构建的另一个程序集。

我拥有其他程序集的所有源代码 - 但我只能将其添加为“.DLL”引用，而不是将实际项目添加为依赖项。

问题是当我进入外部代码时，调试器会“跳过”它。

如何为外部 .NET 程序集启用“源代码”调试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T11:29:49.297

如果您有 dll 并想单步执行二进制文件，则需要 dll 的 pdb 文件。[本文](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)
关于调试.Net源码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-08T09:28:53.600

在 VS2010 中，还可以调试原始 .NET 框架源代码。要调试框架中的错误，请查看以下站点以获取更多信息： [Visual Studio 2010：调试 .NET 框架程序集](http://www.lazerwire.com/2011/11/vs2010-debug-net-assemblies.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T11:28:14.120

在工具/选项/调试/常规中，有一个名为“仅启用我的代码（仅限托管）”的选项。把它关掉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-31T11:27:40.487

如果您可以在另一个 Visual Studio 中打开源代码，则一旦您启动了应用程序，您就可以将 VS 附加到该其他进程。十，您可以在该源代码中设置断点并从那里进行调试。

# svn - 在公司中使用 Git？

> ID：402780
> 
> 赞同：14
> 
> 时间：2008-12-31T11:28:02.360
> 
> 标签：svn, git, version-control

在我的工作场所，我们有一个大型 Subversion 存储库，其中包含大约 100 个项目。一些项目通过 svn:externals 相互使用。通常所有人都拥有对所有内容的读/写访问权限，但有时外部人员和实习生对某些自定义文件夹只有有限的读/写访问权限，因此他们无法获得我们的皇冠上的珠宝。

你将如何在 git 中构建它？每个项目都有自己的存储库？如何重用代码？你能以某种方式实现访问权限吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-31T11:58:16.917

**结构：**是的，每个存储库 1 个项目。Git 是为它设计的以这种方式工作，并且做得非常好。

**重用代码：**使用[git 子模块](http://git-scm.com/docs/git-submodule)（非常类似于 svn:externals，只有更好）

**访问权限：**是的，访问控制通常是围绕 ssh 和公钥构建的。如果您想自己托管，请尝试[gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)，但我实际上强烈推荐托管解决方案，例如[GitHub](http://github.com)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T22:58:24.397

**如果**您不需要限制读取访问权限，我会使用单个 git 存储库。

**结构：**文件系统层次结构

**重用代码：**通过构建系统

**访问权限：**写访问是补丁合并。它可以由脚本控制，或者最好由设计人员控制。如果您有 3 个项目，每个项目都有一个项目经理，负责合并主分支中的代码。请记住，这就是 linux 的工作方式，而 git 尤其适合这种情况。

**为什么使用单个 repo ？**

主要原因是代码分歧。假设您有 3 个项目和一些共享库。Team A 需要适配 libXY 的接口并提交代码，有两种情况：

1.  子模块：如果更改破坏了他们的代码，团队 B 和 C 将不得不更新他们的子模块并向团队 A 报告。他们也可以自己更新代码，但是团队 A 也可能有一些代码损坏。

2.  One-big-repo：团队 A 更改代码，直到所有测试都通过。更改在上游合并，每个人都很高兴。

在场景一中运行所有测试也是可能的，但是，这就像你有一个 repo 一样，因为你必须检查所有代码。

这是我的观点。也许您在回购中有一些大资产，您不希望每个人都签出，因为它们需要 2GB。也许您的代码库太大以至于过热无关紧要。

但我相信，除非您是 Google、IBM，否则您为管理多个 repos 所付出的开销将会太大，并且会让您失去可以花在更有效率的事情上的时间。

干杯，津巴布韦

# java - java中的Typeahead /增量搜索

> ID：402785
> 
> 赞同：4
> 
> 时间：2008-12-31T11:30:38.920
> 
> 标签：java, search, data-structures

我们有一个搜索结果映射列表，例如一个简单的 url 映射可能看起来像

“stackoverflow”->“www.stackoverflow.com”“乔尔”->“www.joelonsoftware.com”

所以搜索确切的短语工作正常。

现在我们正在寻找增量搜索/预先输入，例如“stackover”也会返回“www.stackoverflow.com”。我们当然可以相应地填充我们的地图，例如将每个可能的字符串放入地图中，从给定最小大小的所有变体开始

-> 地图键：

stack -> stackoverflow ... stackoverf -> stackoverflow stackoverfl -> stackoverflow stackoverflo -> stackoverflow stackoverflow -> stackoverflow

然而，这意味着需要更高的内存占用（我猜）。

有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-31T11:41:54.297

**最简单的解决方案：在列表中搜索**

您也可以即时搜索，例如：

```
List<String> urls = Arrays.asList("this", "is", "a", "test");

// search for "is"
List<String> reduced = new ArrayList<String>();
String searchWord = "is";
for (String s : urls) {
    if (s.contains(searchWord)) {
         reduced.add(s);
    }
}

// when the user types more, search again using the already reduced list. 
```

第一个搜索将是最慢的，但是您可以使用已经减少的列表，这应该会快很多。

**更复杂：使用[Trie](http://en.wikipedia.org/wiki/Trie)**

如果性能是一个问题，并且您只允许与字符串开头匹配的搜索（例如，“stack”用于“stackoverflow”，但不能将“overflow”作为搜索词），您应该考虑将数据表示为[Trie](http://en.wikipedia.org/wiki/Trie)。这为您提供 O(c) 搜索性能，其中 c 是字符数。所以搜索性能与搜索词的数量无关，非常棒。

**高级解决方案：使用[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)**

[后缀树](http://en.wikipedia.org/wiki/Suffix_tree)或多或少是一种高级的 Trie，在这里您还可以搜索 O(c) 中的任何子字符串，就像 Trie 一样。我会说这是最先进的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T15:09:10.760

谢谢，特里是个好建议。我首先认为这是一个错字，你的意思是树:)

这是一个示例 java 实现：

[http://www.koders.com/java/fid0F06E53F2CFCC6E591C38752F355A7178F92FFE5.aspx](http://www.koders.com/java/fid0F06E53F2CFCC6E591C38752F355A7178F92FFE5.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-31T15:34:00.320

这可能有点矫枉过正，但我​​会检查 Lucene 来解决这个问题。

# awk - 在 awk 中组合字段

> ID：402792
> 
> 赞同：1
> 
> 时间：2008-12-31T11:34:57.367
> 
> 标签：awk

在awk中组合字段是否容易？具体来说，我有这样的行：

```
1,2,some text
3,4,some text, but it has commas in it, annoyingly 
```

我想将这两个数字提取为前两个字段，但随后我希望所有文本（逗号和全部）成为第三个字段。有没有办法做到这一点？

我的基本 awk 调用是这样的：

```
awk -F\, '{print $1"|"$2"|"$3}' file.txt 
```

这适用于第一行，但在第二行文本中的逗号处停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T12:06:30.050

也许：

```
awk '{for (i=0;i<2;i++) sub(",", "|", $0); print}' file.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T11:56:47.870

你可以使用 sed 来做到这一点。

```
cat file.txt | sed 's/\(.?*\),\(.?*\),/\1|\2|/' 
```

# outlook - 将 Outlook 2007 电子邮件移至 GMail 的最简单方法是什么？

> ID：402800
> 
> 赞同：0
> 
> 时间：2008-12-31T11:38:04.133
> 
> 标签：outlook, gmail

我决定完全摆脱旧的 POP3 电子邮件帐户，转而使用 GMail。

我在 Outlook 2007 .pst 文件中有很多存档邮件。

我知道我可以从 Outlook 转发它们，但是我会在 GMail 中仅将它们作为一封带有大量附件的电子邮件接收？

我怎样才能将这些移动到我的 GMail 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T11:48:32.363

我认为最简单的方法是将您的 Gmail 帐户添加到 Outlook 并在 Outlook 中移动邮件。没有任何经验，但谷歌提供了很多有用的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T16:01:23.040

I successfully moved several thousand massages from Outlook to GMail by connecting to my GMail account via IMAP and just moving them into the right folder.

I happened to export all my messages into Thunderbird first because of an article that suggested doing that then using the [Google GMail Loader](http://www.marklyon.org/gmail). But when I realized that the article predated GMail's implementation of IMAP I just configured an IMAP account in Thunderbird and did some drag-n-dropping. I'm pretty sure Outlook supports IMAP accounts so you could skip that intermediate step.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T12:59:37.540

Erick -> 我尝试了 GMail Loader 但没有任何运气。

PEZ -> 如果我转发邮件，它们将作为邮件附加到转发的邮件，这样我将无法看到邮件的主题。

我想我会尝试将我的 GMail 帐户添加到 Outlook 并尝试在 Outlook 中移动所有内容。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-31T11:51:45.353

miies 的回答看起来很有希望。如果失败，也许您可​​以在 Outlook 中制定过滤规则来转发邮件并将其应用到您的邮件文件夹。

# ruby - OS X 上的 Camellia Ruby 计算机视觉库

> ID：402810
> 
> 赞同：3
> 
> 时间：2008-12-31T11:43:51.530
> 
> 标签：ruby, image-processing, computer-vision

有没有人幸运地将[Camellia](http://camellia.sourceforge.net/)计算机视觉库安装在 OS X 上？我一直在用头撞墙试图让它安装。我[只能在](http://po-ru.com/diary/camellia-and-ruby-on-mac-os-x/)网上找到一个参考资料，而且有点过时了。我已经按照 T 的说明进行操作，但没有运气。

我希望您在 SO 上的一位才华横溢的人可以帮助一个花花公子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T20:59:07.253

你的问题到底是什么？有任何错误信息吗？您是在尝试编译库还是在尝试构建 gem？

Camellia 库的源代码是用 C 编写的。如果你想在你的 OS X 机器上编译这个库，你需要一个 C[编译器](http://en.wikipedia.org/wiki/Compiler)（比如[GCC](http://en.wikipedia.org/wiki/GNU_Compiler_Collection)）。在 OS X 上安装一个最简单的方法是安装[Apple 的 XCode](http://developer.apple.com/TOOLS/xcode/)，因为 GCC 是该软件包的一部分。**`which gcc`**您可以通过在[终端](http://www.osxterminal.com/)窗口中输入命令来检查您是否安装了 GCC 。如果此命令返回 gcc 应用程序的路径（如**`/usr/bin/gcc`**），则您已经安装了 GCC。如果该命令没有返回任何内容，您应该安装 GCC（或 XCode，如前所述）。

之后，只需按照您提到的网站上的步骤操作即可。

如果这不能回答您的问题，请编辑您的请求并更具体地说明问题和您想要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T01:43:12.950

我通过以下步骤让它在 Leopard 上运行（已经设置了 Ruby 等 - 如果您还没有，请从 OS X 安装 DVD 安装 XCode）：

1.  下载了 Unix/Linux 发行版 (CamelliaLib-2.7.0.tar.gz)
2.  打开了压缩包
3.  `cd CamelliaLib-2.7.0/`
4.  `./configure`
5.  `sudo make`
6.  `sudo make install`

很酷，所以安装了 Camellia。接下来是 Ruby 部分。

首先，我寻找宝石`gem search -r camellia`：

```
*** REMOTE GEMS ***

camellia (2.7.0)
camellia-rb (1.2) 
```

很好，所以只需要一个简单的`gem install`.

```
$ sudo gem install camellia
ERROR:  could not find gem camellia locally or in a repository 
```

诡异的。无论如何，我安装了另一个gem：

```
$ sudo gem install camellia-rb 
```

果然（`require 'rubygems'`除非你有像我这样的不同设置，否则你需要先使用）：

```
$ irb
irb(main):001:0> require 'camellia'
=> true 
```

希望这能让你开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-12T00:21:14.023

*   下载 CamelliaLib-2.7.0.tar.gz
*   tar xf CamelliaLib-2.7.0.tar.gz
*   cd CamelliaLib-2.7.0
*   。/配置
*   制作
*   须藤使安装
*   光盘..

*   从 ruby​​forge 下载 camellia-2.7.0-x86-linux.gem

*   mkdir 山茶花宝石
*   cd茶花宝石
*   焦油 xvf ../camellia-2.7.0-x86-linux.gem
*   tar zxvf data.tar.gz
*   光盘分机

*   按照描述修改 extconf.rb

```
CONFIG['LDSHARED'] = "g++ -shared -lCamellia"
 至
 CONFIG['LDSHARED'] = "g++ -lCamellia -bundle -flat_namespace -undefined suppress"

```

*   红宝石 extconf.rb
*   如果你有 ruby​​ 的默认豹安装，修改 Makefile 中的 topdir 为

```
topdir = /usr/lib/ruby/1.8/universal-darwin9.0

```

*   从 DLDFLAGS 中删除“-Wl,-export-dynamic”，从 LIBPATH 中删除“-Wl,-R'$(libdir)'”
*   确保 arch、sitearch 和 ruby​​ 是正确的
*   从 LIBS 中删除 -lcrypt

```
拱=通用-darwin9.0
sitearch = 通用-darwin9.0
红宝石 = /usr/bin/ruby

```

*   确保在 Makefile 中进行了 LDSHARED 更改

```
LDSHARED = g++ -lCamellia -bundle -flat_namespace -undefined 抑制

```

*   .so 到 .bundle 用于 DLLIB

```
DLLIB = $(TARGET).bundle

```

*   制作
*   sudo cp camellia.bundle /usr/lib/ruby/site_ruby/1.8/universal-darwin9.0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-26T02:09:59.980

不好 ！！！

```
sudo gem install camellia-rb 
```

不是山茶花图形宝石，它是密码宝石，所以仍然没有好的解决方案

问题是让山茶花图形宝石进入 os X leopard 工作，还有其他人吗？

# html - 如果屏幕上有足够的空间，将桌子并排放置

> ID：402817
> 
> 赞同：0
> 
> 时间：2008-12-31T11:51:07.303
> 
> 标签：html, css, html-table

我有两个 HTML 表格，它们最好并排放置在屏幕上。宽屏显示器可以解决这个问题，但是在大多数老式显示器上桌子太宽而不能并排。因此，只有在分辨率足够高的情况下，我才想使用 css（或者甚至只是 HTML，如果可能的话）将表格并排放置。

这通常会自动处理图像，但是有没有办法为表格做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-31T11:51:59.660

是的，将 CSS 样式 float:left 应用于表格元素

这是关于浮动的优秀入门：http: [//css.maxdesign.com.au/floatutorial/](http://css.maxdesign.com.au/floatutorial/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T11:57:02.737

我的建议是浮动表格（请记住指定表格宽度 - 选择一个在非宽屏显示器上已满的表格）。

```
table {
    width: 500px; /* important */
    float: left;
} 
```

但是，这也可能有效（未经测试）：

```
table {
    display: inline;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T12:10:58.280

试试这个（你可以改变窗口的大小）：

```
<html>
<body bgcolor="red">
<p>
    <table bgcolor="green" style="float: right;">
    <tr>
        <td>sssssssssssssssssssssssssssssssssssssssssss</td>
    </tr>
    </table>

    <table bgcolor="blue" style="float: left;">
    <tr>
        <td>eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</td>
    </tr>
    </table>
</p>
</body>
</html> 
```

-->

# c++ - 自动生成函数存根

> ID：402824
> 
> 赞同：3
> 
> 时间：2008-12-31T11:54:28.280
> 
> 标签：c++, visual-studio, stub

是否有任何 Visual Studio 附加组件（或 windows/unix 独立程序）在 cpp 文件中为头文件中定义的函数（包括类成员函数）创建存根实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T12:36:58.133

我以前也有同样的问题，现在我正在使用[Visual Assist X](http://www.wholetomato.com/)的试用版。提到的任务可以通过右键单击方法名称 -> 重构 -> 创建实现，然后重构 -> 将实现移动到 CPP 文件来完成。

我不是 Visual Assist X 的附属机构或什么，但这确实大大提高了我使用 Visual C++ 的编码速度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T15:42:16.027

[重构！对于 C++](http://www.devexpress.com/Products/Visual_Studio_Add-in/RefactorCPP/)，可与 Dev Studio 2005 和 2008 一起使用。免费版本“种类”让您这样做；如果你在你的头文件中输入你的存根方法（通过输入类似`void Foo(int bar){}`代替的东西`void Foo(int bar);`）你可以然后“将方法移动到源文件”。

完整版有更多功能，但我不熟悉它们的用法。

# c++ - 在一次处理大量数据时避免在窗口中出现“（不响应）”标签

> ID：402832
> 
> 赞同：13
> 
> 时间：2008-12-31T11:57:15.887
> 
> 标签：c++, windows, mfc

我偶尔需要处理来自网络外的一个包的大量数据，这需要足够长的时间，以至于当用户尝试与应用程序窗口交互时，会将“（未响应）”字符串添加到窗口标题中。我知道这是因为处理是在处理消息的调用中完成的（在堆栈的某个位置），因此阻塞了消息泵。我也知道处理这个问题的理想方法是在一个单独的线程中异步处理数据，以便泵可以继续运行，但是这是一个大型桌面应用程序，它从头到脚都是单线程的，可以安全地关闭这个处理在我们的时间范围内是不可行的。

因此，考虑到这一点，有没有一种方法可以通过在我开始之前告诉 Windows 我的应用程序即将忙碌，至少避免“无响应”绰号（大多数用户将其读作“已崩溃”）工作？我相信在响应关闭请求时有一些类似的东西，可以继续要求窗口更多时间以避免它宣称您没有“及时关闭”

我应该添加这是一个 C++ MFC 应用程序。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-31T12:10:12.413

我不认为 Windows API 可以在这里为您提供帮助。

或者，如何显示一个带有进度条的对话框并使其在单独的线程中运行？

对话框上的“此操作可能需要半小时”之类的文字也可能是合适的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-31T12:20:38.167

好的，首先我赞成 Frederick 的帖子，因为不管你喜不喜欢，第二个线程可能是最好的方法。

但是，如果您真的不想走这条路，您可以在应用程序内部循环中手动抽取消息队列。像这样的东西；

```
int Refresh()
{
    MSG       msg;
    if (PeekMessage (&msg, NULL, 0, 0,PM_NOREMOVE))
        if ((msg.message == WM_QUIT) 
          ||(msg.message == WM_CLOSE) 
          ||(msg.message == WM_DESTROY) 
          ||(msg.message == WM_NCDESTROY)
          ||(msg.message == WM_HSCROLL)
          ||(msg.message == WM_VSCROLL)
          ) 
          return(1); 
    if (PeekMessage (&msg, NULL, 0, 0,PM_REMOVE))
    {
        TranslateMessage (&msg);
        DispatchMessage (&msg);
    }
    return(0);
} 
```

这实际上是我在重写类似于单独线程的东西之前使用的一段代码。基本上我会查看队列，过滤掉不需要的消息，然后发布其余消息。它在一定程度上有效，但偶尔会引起一些令人讨厌的副作用，因此重写。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-31T22:27:37.380

您实际上不必对来自 PeekMessage 的消息执行任何操作。只需调用 PeekMessage，您甚至不必从队列中删除任何内容或对其进行处理。只要每隔5秒左右调用一次，就会导致windows认为进程还在响应。

另一种想法是让一个单独的进程/线程出现在通知托盘中，并通知用户该进程正忙于等待内部操作完成。您将在更高版本的 Visual Studio、SQL Server Management Studio 等中看到这些。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-07-23T21:59:18.053

Win32 在`user32.dll`.

[`DisableProcessWindowsGhosting()`](https://msdn.microsoft.com/en-us/library/ms648415(v=vs.85).aspx)

> 禁用调用 GUI 进程的窗口重影功能。Window ghosting 是 Windows 管理器的一项功能，可让用户最小化、移动或关闭没有响应的应用程序的主窗口。

除了上述记录的行为之外，我还在此处（在 C# 应用程序中）验证了此 Win32 调用还可以防止*Not Responding*标签根据需要出现在窗口上。

我通过 C# 对类似问题的回答找到了这个：[https](https://stackoverflow.com/a/15380821/29152) ://stackoverflow.com/a/15380821/29152 。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-31T15:12:43.497

如果你分叉一个线程，你很可能担心发生其他一些用户操作，这可能取决于长时间运行的操作的结果（是的，并发）。因此，扩展 Fredrick 所说的内容，如果您确实分拆了一个新线程并设置了一个进度条，您可以将焦点锁定在进度条上，以阻止用户与应用程序的其余部分进行交互。这应该足以实现一个非常简单的第二个线程，而不必真正担心并发性，因为您实际上是通过禁用用户交互来锁定应用程序的其余部分。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-31T12:18:53.317

您需要以某种方式将处理与消息处理交错。如果线程是不可能的，您可能需要考虑将处理分成多个阶段。一种方法是在您第一次收到数据包时进行一些处理，然后向应用程序发布一条消息，说“在此处继续处理”。当应用程序收到“在这里继续处理”消息时，它会做更多的处理，或者发送另一个“在这里继续处理”消息，或者结束。

不过，有几个考虑因素：

1.  您需要确保每次向自己发布消息并遵循消息循环时应用程序的状态是一致的，因为同时可能会发生其他消息处理。这可以通过例如仅在最终处理阶段改变状态来完成。
2.  当您仍在处理第一个数据包时，另一个数据包可能会到达。如果更改处理顺序对应用程序不利，您可以通过例如在发生这种情况时发布“提醒我稍后处理此数据包”消息来处理此问题。

我不知道这在您的应用程序设计中是否可行，但这将是解决问题的一种方法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-14T20:58:05.127

如果您不愿意生成工作线程，但可以将长时间运行的任务分解为更小的部分，则可以在 MFC 的[`CWinApp::OnIdle`](https://msdn.microsoft.com/en-us/library/3e077sxt.aspx). 只要没有等待 Windows 消息，就会从消息泵循环中调用此函数。只要您在每次`OnIdle`通话中所做的工作足够短，您的应用程序就会保持响应。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-30T16:23:37.243

假设它一直在处理数据而不是接收数据（并且您很认真地避免使用线程 - 这很好 IMOHO），您可以：

1.  在您当前正在处理消息的函数中，创建一个显示“请稍候”消息的模式对话框（或将其隐藏，小，等等）。将您正在处理的数据复制（或发送指针等）到该对话框的成员变量。
2.  在模态对话框中向您自己发布一条用户定义的消息以处理数据。
3.  在对话框的消息处理程序中，处理一个“单元”工作。跟踪下一个“工作单元”是什么。再次发布相同的消息。
4.  重复此消息后“循环”，直到完成。关闭您的对话框。

模态对话框的性质将使您的应用程序保持“响应式”，最小程度地中断或更改应用程序以前的工作方式。重入可能是模态循环的一个问题，特别是如果其中任何一个都与 WM_PAINT 消息有关。（有人曾经断言过内画代码吗？好时光，好时光……）

如果您愿意，该对话框甚至可以有一个取消按钮。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-02T02:24:25.900

克服应用程序无响应的一种方法是，您需要告诉应用程序处理来自 Windows 的消息。当你在你的循环中，你可以打电话

```
Application->ProcessMessages(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-28T07:43:11.160

我遇到了**完全相同的**问题。由于我不认为其他答案具有吸引力/直截了当，我决定发布此内容。

简短描述和一些上下文：我正在将数据从网格保存到数据库中，这个过程可能需要一段时间。所以我将保存方法更改为异步方法并遇到了同样的问题。

然后我想出了一个简单的解决方案：

```
//__ENABLE OR DISABLE MAIN DIALOG
void CMFCApplication1Dlg::enableMainDlg(bool enable)
{ 
    this->EnableWindow(enable);
} 
```

启动异步方法时，我禁用了主对话框。这可以防止用户与主对话框进行交互（比如启动另一个保存过程，如果我不检查保存过程是否已经运行，可能会导致数千条 SQL 错误消息......）

保存过程完成后，我重新启用主对话框。像魅力一样工作，我希望这会有所帮助

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-05T19:05:32.343

我在使用 cpprest (Casablanca) api 等待来自 web 服务的响应的 win32 应用程序中遇到了类似的问题。我的解决方案是创建一个事件和线程，它只等待 cpprest api，然后在收到信号后释放线程：

```
DWORD WINAPI WaitForCasablanca(LPVOID n)
{

// Get the handler to the event for which we need to wait in 
//    this thread.
 HANDLE hEvent = OpenEvent(EVENT_ALL_ACCESS, false, "MyEvent");
if (!hEvent) { return -1; }
// Loop through and wait for an event to occur

    // Wait for the Event
    WaitForSingleObject(hEvent, INFINITE);
    //    No need to Reset the event as its become non signaled as soon as
    //    some thread catches the event.

CloseHandle(hEvent);

return 0;}

BOOL WINAPI DlgProc(HWND hDlg, UINT message, WPARAM,wParam, LPARAM lParam) ...
  HANDLE     hEvent = CreateEvent(NULL, false, false,        "MyEvent");//create an event that will wait for casablanca ro authenticate
if (!hEvent) return -1;
            //    Create a Thread Which will wait for the events to occur
  DWORD Id;
  HANDLE hThrd = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)WaitForCasablanca, 0, 0, &Id);
            if (!hThrd) { CloseHandle(hEvent); return -1; }
   makeCasablancaRequest(...);
 SetEvent(hEvent); //casablanca has finished signal the event to terminate

    WaitForSingleObject(hThrd, INFINITE); //wait for thread to die

            CloseHandle(hThrd);
            CloseHandle(hEvent);
            ...} 
```

这让我摆脱了“程序没有响应”的消息。我认为问题在于获取数据的代码也在线程中运行——只有主程序不知道这一点——就系统而言，主程序处于空闲状态。您需要一个事件和一个等待事件的线程来告诉系统程序正在等待数据。我从本教程中获得了代码：[如何使用 WIN32 事件内核对象](https://www.codeproject.com/Articles/8211/How-to-use-WIN32-Event-Kernel-Object)

# java - Java：是否有可以让我输入、存储和评估数学公式的工具？

> ID：402833
> 
> 赞同：2
> 
> 时间：2008-12-31T11:57:44.017
> 
> 标签：java, math, formulas

即使是非常基本的东西也可以。就像输入和评估像 x+1 这样的东西，其中 x 是我要指定的变量。

我正在考虑为每个公式编写自己的字符串，使用正则表达式来解析它们等等，但是让我们假设我的目标是尽可能地懒惰，并且如果有另一种选择（尤其是正式的） )，我宁愿先尝试使用它。

有什么东西可以做这样的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T16:17:23.600

我知道以下库：

*   [Symja Parser](https://github.com/axkr/symja_android_library)（GPL 许可）支持类似 Mathematica 的语法

*   [Jep - Java 数学表达式解析器](http://www.singularsys.com/jep/)（商业 - GNU 公共许可证下的旧版本？）

*   [JFormula](http://www.japisoft.com/formula/)（商业）

*   [MathEval - 数学表达式评估器](http://softwaremonkey.org/code/MathEval/index.html)（公共领域和非常小的足迹）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-31T11:59:24.543

您可以考虑使用Java 6 中的[脚本](http://java.sun.com/javase/6/docs/technotes/guides/scripting/)。参考 JDK 带有一个 JavaScript 实现，您也可以插入其他语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T13:31:28.880

几年前我成功地使用了[JEP](http://www.singularsys.com/jep/)，它似乎仍在积极开发中。我相信他们在那些日子里有一个更宽松的许可证，但它可能比自己编码便宜（取决于你的确切需求和技能）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T15:33:27.247

我已经为我自己构建了一个 java 库来作为 Lex/YACC 的学习示例。它被合并到一个更大的项目中，似乎运行良好。如果我要重新开始更大的项目，我会遵循上面的建议并使用 Java 脚本引擎。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-02T00:34:09.387

您可以尝试[LibFormula](http://sourceforge.net/project/showfiles.php?group_id=51669&package_id=277201)，这是一个基于 OpenDocument 的 OpenFormula 标准的公式计算库。

OpenFormula 是为电子表格应用程序编写的，并使用接近 Excel 公式的语法。更多信息可以在[Pentaho-Wiki中找到](http://wiki.pentaho.com/display/Reporting/Formula+Expressions)

样本：

```
=[x]+1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-25T18:12:39.727

您可以查看我在[Apache License 2.0](http://www.apache.org/licenses/LICENSE-2.0.html)下发布的**[exp4j](http://projects.congrace.de/exp4j/index.html)**。它实现了 dijkstra 的调车场算法，并且适用于多变量函数，如`f(x,foo)=log(foo^(x^-1))`

*   [演示小程序](http://projects.congrace.de/exp4j-demo/demo.html)
*   [下载](http://objecthunter.congrace.de/tinybo/blog/articles/86)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-15T00:48:32.660

有些人可能对名为[formula4j](http://www.formula4j.com/)的新工具感兴趣。

它是商业的，所以它并不适合所有人。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-31T12:00:19.127

也许[MathML](http://www.w3.org/Math/)？

> MathML 是一种低级规范，用于将数学描述为机器对机器通信的基础，它为在网页中包含数学表达式提供了急需的基础。在发布科学和技术工作流程以及必须通过软件处理数学的任何地方，它也很重要。例如，新版本改进了数学的可访问性，以及从右到左书写的语言公式。基本标记保持不变，因为社区有七年的经验。

# django - Django 如何提供媒体文件？

> ID：402841
> 
> 赞同：13
> 
> 时间：2008-12-31T12:00:51.340
> 
> 标签：django, file, static

我已经建立了一个使用图像的[Django应用程序。](http://en.wikipedia.org/wiki/Django_%28web_framework%29)我想我已经正确设置了媒体设置 MEDIA_ROOT 和 MEDIA_URL。但是图像不显示。你知道可能是什么问题吗？

让我们考虑这个例子：

图像文件位于**/home/www/media/app/photos**下，我们正在尝试请求[http://example.com/photos/123.jpg](http://example.com/photos/123.jpg)

我应该使用这些设置吗？

```
MEDIA\_ROOT = /home/www/media

MEDIA_URL = http://example.com/app 
```

**更新：**忘了提到我正在使用内置的开发服务器。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-31T21:51:00.277

**仅用于开发**

您可以通过在`urls.py`文件中执行此操作来设置静态媒体服务器以与他们的开发服务器一起使用。我附上了显示我如何使用它的代码（以及强制调试条件。）

```
from django.conf import settings
from django.conf.urls.defaults import *      

# Uncomment the next two lines to enable the admin:
from django.contrib import admin
admin.autodiscover()

urlpatterns = patterns('', 
    (r'^$', 'views.index'),            

    # Accounts
    (r'^accounts/login/$', 'views.user_login'),
    (r'^accounts/logout/$', 'views.user_logout'),

    # Contrib Modules
    (r'^admin/(.*)', admin.site.root),
)

if settings.DEBUG :
    urlpatterns += patterns('',
        (r'^media/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT, 'show_indexes': True}),
    ) 
```

我将 my`MEDIA_ROOT`放在 html/media 的子目录中并链接到它`settings.py`

```
MEDIA_ROOT = os.path.join(os.path.dirname(__file__), 'html/media/').replace('\\','/') 
```

[开发完成后，项目被部署到 Web 服务器，然后Apache](http://en.wikipedia.org/wiki/Apache_HTTP_Server)使用指令提供静态媒体文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-31T12:13:01.817

**开发人员自己不鼓励**从 Django 提供静态内容（如果我没记错的话，它只在调试模式下有效）。相反，您应该使用专用的 Web 服务器。

无论如何，如果您确实需要这样做，请阅读有关[如何提供静态文件](http://docs.djangoproject.com/en/dev/howto/static-files/)的文档。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-04-02T07:36:52.773

这是使用 ImageField 显示图像文件的正确方法。假设我们有一张用户个人资料图片：

模型.py：

```
UserProfile:
    profilePic= models.ImageField( upload_to='PATH_TO_UPLOAD', blank=True, null=True) 
```

设置.py：

```
MEDIA_ROOT = 'FULL_PATH_OF_MEDIA'
MEDIA_URL = 'URL_OF_MEDIA' 
```

网址.py：

```
urlpatterns = [
.
.
.
]+ static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT) 
```

PATH_TO_UPLOAD 是用户上传数据的路径。这是 FULL_PATH_OF_MEDIA 的子目录，这意味着上传的文件将有

```
FULL_PATH_OF_MEDIA/PATH_TO_UPLOAD 
```

完整路径。现在可以通过此 url 访问此内容：

```
SITE_NAME/URL_OF_MEDIA/PATH_TO_UPLOAD 
```

我还建议在[static_files 与 media_files上阅读此内容](https://stackoverflow.com/questions/7456817/django-when-should-i-use-media-root-or-static-root)

[文档](https://docs.djangoproject.com/en/1.11/ref/models/fields/#django.db.models.FileField.upload_to)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-02-12T21:28:56.373

您可以将这些行添加到您的 urls.py

```
from django.urls import re_path
from django.views.static import serve

urlpatterns = [
    ...
    re_path(r'^media/(?P<path>.*)$', serve,{'document_root': settings.MEDIA_ROOT}), 
    ] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T17:52:08.840

我怀疑您正在获取 Django 404 页面。尝试直接访问您的一张图像，看看是否发生这种情况。

如果是这样，您需要将 Web 服务器配置为*不*将媒体层次结构中的请求发送到 Django，而是直接为它们提供服务。这是我的 Apache conf 文件中的一个片段。第一部分告诉 Apache 将所有内容发送给 Django。第二部分有“SetHandler None”，它表示“以正常方式处理 /media 下的内容”。

有关所有令人兴奋的细节，请参阅[http://docs.djangoproject.com/en/dev/howto/deployment/modpython/](http://docs.djangoproject.com/en/dev/howto/deployment/modpython/)。

PrinceOfPinot.com（AKA pop）的部分 httpd.conf 文件：

```
<Location "/">
    SetHandler python-program
    PythonAutoReload Off
    PythonDebug Off
    PythonPath "['/var/www/production/pop', '/usr/local/lib/python2.5/site-packages/django'] + sys.path"
    SetEnv DJANGO_SETTINGS_MODULE settings
    PythonHandler django.core.handlers.modpython
</Location>

<Location "/media">
    SetHandler None
    AddOutputFilterByType DEFLATE text/html text/css application/x-javascript
</Location> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-11-12T16:44:19.107

我知道最初的问题是与开发服务器有关，但对于其他正在寻找生产环境答案的人来说：

[https://docs.djangoproject.com/en/1.8/howto/static-files/deployment/](https://docs.djangoproject.com/en/1.8/howto/static-files/deployment/)提供了有关如何让 django 在生产环境中提供文件的指南。从指南的语气来看，它似乎暗示最好有一个单独的 Web 服务器来处理文件或将 mod_wsgi 与 Apache 一起使用

# asp.net - ASCX 控制 ASP.NET - 找不到可见方法

> ID：402846
> 
> 赞同：1
> 
> 时间：2008-12-31T12:04:39.680
> 
> 标签：asp.net, html, vb.net, methods

在特定页面中，我有一个包含表格的 ascx 控件。

现在我想将此控件设置为可见/不可见，但智能感知未检测到可见方法。

唯一的方法是 1)Equals 和 2) ReferenceEquals

主页

```
<VPM:VotingPolls Runat="server"></VPM:VotingPolls> 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T12:21:30.223

谢谢 已经解决了

问题是没有设置id。

```
<VPM:VotingPolls ID="VPS" Runat="server"></VPM:VotingPolls> 
```

然后

```
VPS.Visible=True/False 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T12:22:14.043

确保您的标记格式正确，并且页面上的 ascx 控件有适当的标题行。99% 的情况下，如果智能感知不起作用，则意味着代码和/或标记有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T12:09:46.410

有时智能感知不显示可用属性。但是可见属性将可用。所以只需键入 visible='true/false'。那应该行得通。

# ruby - 学习 Ruby：推荐阅读的博客？

> ID：402847
> 
> 赞同：7
> 
> 时间：2008-12-31T12:04:58.167
> 
> 标签：ruby, blogs

我即将开始学习 Ruby，并且想要一些阅读材料来帮助我学习它。

我正在寻找您在 Ruby 上的**前 5 个**博客、新闻和任何（活跃的）公告板（我可以很好地处理新闻组，但我更喜欢在 BB 中阅读）。

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-31T12:12:55.670

阅读博客不是学习编程语言的方法。*在您学习了该语言的基础知识之后*，它可能会很有用，此时您可以：

1.  真正理解并利用您在博客上阅读的内容
2.  有必要的基础，从坏东西中剔除好东西

我会推荐一本好书来帮助您入门，最近发布[的 The Ruby Programming Language](https://rads.stackoverflow.com/amzn/click/com/0596516177)可能是目前最好的一本书。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-31T12:22:50.953

@Robert 我同意你远离提要。最好是看书，获得一些深入的知识......

然而，这里有一些可能会有所帮助（使用 Rails 和 Ruby）：

[http://www.buildingwebapps.com/podcasts](http://www.buildingwebapps.com/podcasts) (Rails)

[http://www.peepcode.com](http://www.peepcode.com) (Rails)

[http://www.learningrails.com](http://www.learningrails.com)（导轨）

[http://www.railsenvy.com](http://www.railsenvy.com)（导轨）

[http://www.bofh.org.uk/articles/category/ruby](http://www.bofh.org.uk/articles/category/ruby)（特定于 RUBY）

[http://www.pragprog.com](http://www.pragprog.com)（红宝石）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T12:10:22.477

我假设您已经知道[为什么是凄美的指南](http://poignantguide.net/ruby/)，但以防万一，这是一个很好的起点。那和[镐的书](http://www.pragprog.com/titles/ruby/programming-ruby)。

我知道你要求博客等，但这两个是非常重要的阅读。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T14:45:48.590

[红宝石流](http://www.rubyflow.com)

[红宝石里面](http://www.rubyinside.com)

这两个应该让你开始。听取其他人的建议并拿起一些书，然后开始破解。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T12:11:05.330

为什么的博客。古怪但出色：

[http://hackety.org/](http://hackety.org/)

[http://redhanded.hobix.com/](http://redhanded.hobix.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-31T12:11:30.663

你可以从这里的基础开始：[http](http://www.ruby-lang.org/en/documentation/) : //www.ruby-lang.org/en/documentation/ 然后在 www.rubyflow.com 上你会发现每天都有几个关于 Ruby 的教程和新闻的链接。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T13:31:41.220

不是博客，而是（另一本）书。您可以在线免费阅读[Programming Ruby](http://www.ruby-doc.org/docs/ProgrammingRuby/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-31T13:44:16.687

为什么令人心酸的指南很棒，免费的在线 Programming Ruby 也很棒。

它们就是我现在正在阅读的内容。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-31T14:19:24.073

很难错过...

[http://delicious.com/popular/ruby](http://delicious.com/popular/ruby)

[http://delicious.com/popular/rails](http://delicious.com/popular/rails)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-31T14:47:42.720

如果你想对社区有一个好的感觉（这是 ruby​​ 最棒的地方），请查看以下内容：

*   John Nunemaker 的[Rails 技巧](http://railstips.org/)（非常[好的](http://www.rubyinside.com/top-ruby-blogger-of-2008-john-nunemaker-1410.html)博客）
*   尼克博士的[博客](http://drnicwilliams.com/)
*   Josh Susser 的[has_many :through](http://blog.hasmanythrough.com/)
*   Jamis Buck 是[{ buckblogs :here}](http://weblog.jamisbuck.org/)
*   大卫·海涅迈尔·汉森 (David Heinemeier Hansson) 的[大声思考](http://www.loudthinking.com/)

DHH 的博客并没有真正提供太多的技术站点，但我觉得如果你想了解社区，阅读它真的很不错。太多人在写作时提到它，而且他的帖子往往很有趣（对我来说）。

无聊时，我喜欢看看[Ruby Flow](http://www.rubyflow.com/)和[Ruby Inside](http://www.rubyinside.com)，这是发现新博客的好地方。

# wpf - WPF 窗口实时预览

> ID：402872
> 
> 赞同：1
> 
> 时间：2008-12-31T12:21:12.453
> 
> 标签：wpf, preview

我在 WPF 中有一个显示一些媒体内容的窗口。此内容包含 WPF 动画、视频、图像等。我需要为此窗口创建实时预览。我可以使用 WPF 创建它吗？

看下图，我的要求是在 Window1 的预览区显示 Window2 的预览。

[替代文字 http://www.dailycoding.com/FileSharing/WPF_Preview.png](http://www.dailycoding.com/FileSharing/WPF_Preview.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-31T12:42:14.597

是的你可以。
看看`System.Windows.Media.VisualBrush`（见[http://msdn.microsoft.com/en-us/library/system.windows.media.visualbrush.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.visualbrush.aspx)）。

# user-interface - 真的需要重置按钮吗？

> ID：402881
> 
> 赞同：22
> 
> 时间：2008-12-31T12:25:34.177
> 
> 标签：user-interface, usability

在网络***联系表***上，真的需要重置按钮吗？真的有人用吗？如果我不把它放在页面中，是否存在可用性失败？

10倍！

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-12-31T12:33:10.887

好吧，删除您的客户刚刚花时间编写的文本区域非常有用，因为他们按下了错误的按钮 - 在他们因为会话到期而丢失它之前，必须重新输入 -

不，我真的不认为它有用。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2008-12-31T13:34:47.937

它实际上有时对从公共终端访问的网络表单很有用——一个很好的例子是公共图书馆卡片目录的搜索表单。

想象一下，如果搜索表单有很多字段（作者、年份、关键字、主题、出版商、收藏、标题、系列等等）。这使您可以进行非常具体的搜索（所有名为 John 的作者于 1987 年出版的书籍），但是一旦您找到了结果，您（或其他用户）可能想要使用一组非常不同的术语进行新的搜索（所有书籍关于 Random House 发布的鱼。重置按钮在这里会有很大帮助，因为否则您可能会发现自己手动清除大量字段。

（根据实现细节，如果用户不希望下一个用户看到他们正在搜索的内容，重置按钮也可能很有用。同样，这在涉及隐私的图书馆环境中很有用。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T12:27:43.220

老实说，在一般情况下我不这么认为，但是您应该与您的用户交谈或以其他方式检查他们如何使用您的系统来确定。

一般经验法则：如果您不确定这是一项要求并且您无法知道，请不要包含它。您始终可以在以后的迭代中包含它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-31T12:38:28.223

在任何衡量使用/有用比的竞赛中，重置按钮必须是安全的赢家，因为它无处不在且完全无用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T12:46:43.293

我认为它 a) 对 99% 的用户完全没用；b) 在典型的 LOB 应用程序中需要做太多的工作。业务分析师通常会添加对重置按钮的要求，而不会考虑**为什么**需要此功能。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T13:02:10.233

将其添加到网络表单并在用户单击它时将其记录下来。如果需要，它将为您的特定页面提供信息。我们无法猜测人们是否想要它。只需使用用户需要或不需要的简单分析工具。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T12:33:28.903

我认为在大多数网页中没有必要。如果您正在输入信息并且输入错误，那么您将需要检查每个错误的文本框并重新输入。重置按钮至少是在其顶部单击一个额外的按钮。

如果您不想输入信息，只需不单击提交按钮即可。

我唯一看到重置按钮有用的情况是，如果您有一个多页工作流程，并且需要能够从头开始。即便如此，我还是建议重新设计工作流程。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-31T14:37:22.540

在我看来，重置按钮在大多数表单上完全没用。我的意思是想一想......你能想象有一段时间你想要完全删除你输入的**所有信息吗？**不见得。大多数用户倾向于对特定字段而不是整个表单进行编辑。

如果您必须有像重置按钮这样的次要操作，最好该按钮小一点并且颜色稍有不同。让用户知道“这个按钮是不同的”并应用菲特定律使其更难点击。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-31T17:30:29.430

绝对不需要。事实上，如果你的表格很长并且底部有一个 RESET 按钮，那么使用它是一个坏主意，因为如果他们发现他们不小心点击了“RESET”并且他们的数据被删除了，你可能会让一些人非常生气。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-31T17:36:15.190

必需的。确保在某些表单上交换重置和提交按钮的位置。更好的是，编写代码以随机交换他们的位置一次。

说真的，我从来没有用过。当我从我还是学生时正在处理的学校注册网站上的表格中删除它时，没有人说什么。所以我说别说了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T12:28:05.640

不仅在联系表格上。我也无法在任何类型的 HTML 表单中找到重置按钮的好处，恕我直言。但我倾向于在每次创建表单时都使用它:)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-31T12:49:25.410

我能想到的唯一原因是在预览和确认场景中，用户可能会在点击大错误发送按钮之前修改他们的部分条目，并实际上认为第一次更有意义

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-31T12:56:11.090

我通常会省略重置按钮，因为我从未见过有人使用它。

我经常将可用空间用于取消按钮，它将用户返回到他最初来自的位置（链接到表单的页面）。对我来说更有意义。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-01T09:47:52.513

如果我说它**有用**怎么办？但不是所有形式。

我有时将它与 CRUD 应用程序中的“更新”部分一起使用。

比如说，我在一个问题上点击了一个*编辑*链接......并进行了一些编辑并重新阅读它......但后来我认为这不是一个好的编辑......我必须重新加载页面或返回最后一页并再次点击编辑链接以获取原始文本。

然而，如果那里有一个重置按钮，那就很容易了。

而且总是有 CTRL+Z.. 那为什么不呢？

有一些很好的用途，但不要像大多数古代 HTML 书籍教你的那样愚蠢地拍它。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-01T15:04:13.310

它对于在不使用 Javascript 的情况下清除单选按钮很有用。

在下面的表格中，可以选择零或一个单选按钮：

```
 Select any one option for any Item(s):     
        Option 'A'    Option 'B'    Option 'C'
Item 1     o              o            o 
Item 2     o              o            o     
Item 3     o              o            o 
Item 4     o              o            o 
```

如果用户改变主意或不小心点击了他不想要的项目按钮，重置按钮将清除整个表单，这似乎是在不使用 Javascript 的情况下摆脱选择的唯一方法。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-31T13:11:53.087

我想这取决于表格有多大以及您实际想要这样做的机会有多大。TBH，我多年来一直在开发网站，但从未真正在表单中添加一个。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-31T14:31:07.357

它在重复您以前的信息的表单上很有用。我在管理界面中遇到过用户想要他们上次输入的内容的案例，因此他们不必记住。但是，在他们想要重置表单的情况下，他们只需按下“清除”（或重置）按钮。

在一次性表单上，重置按钮会很愚蠢。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-31T16:17:19.077

仅当有默认信息时才应使用重置按钮。一个例子就是[这种形式](http://kalsey.com/tools/buttonmaker/)。如果我对大多数值进行了更改但又想将其恢复到原始状态怎么办？我想我可以重新加载页面，只要它不重新发送我的 POST。或者我可以点击一个简单的重置按钮。该按钮从未用于清除用户输入的所有信息，而是用于重置预设数据。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-01T09:35:01.977

我建议如果用户或企业主抱怨缺席，可用性失败就会出现。

绝对不需要作为“标准”功能，通常是一个非常糟糕的主意，除了上面给出的功能似乎增加价值的特殊情况。然而，上面提供的大多数案例可以用不同的（我建议更好）的方式来处理，而不是使用通常很糟糕的重置按钮。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-11T17:00:50.540

## 重置仅用于 HTTP 状态 204

表单的目的地可以发送`204 No Content`响应，这会导致浏览器保持当前页面不变。

在这种情况下，重置按钮是将表单重置为原始状态的最可靠方法（页面重新加载可以重新发送表单）。

但是，无论如何我都无法为它提出现实的用例。

# ruby - 在 Ubuntu 上，Shoes 需要 Ruby1.8 还是 Ruby1.9？

> ID：402905
> 
> 赞同：1
> 
> 时间：2008-12-31T12:41:06.347
> 
> 标签：ruby, shoes

我只在我的机器上安装了 Ruby1.9。我尝试使用 Shoes 编写的程序存在某种问题。我想知道这是否是版本问题。

我正在尝试通过 ssl 做一些事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T13:10:09.983

Shoes 自带嵌入在您下载的脚本中的自己的 Ruby 版本。据我所知，它是完全独立的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T13:20:56.810

我不知道什么是“鞋子”，但我发现了这个： [https ://launchpad.net/ubuntu/+source/shoes](https://launchpad.net/ubuntu/+source/shoes)

根据“鞋子（0.r396-5）”依赖于“rubygems1.8”

# asp.net-mvc - asp.net mvc + activerecord 保存对象图

> ID：402909
> 
> 赞同：0
> 
> 时间：2008-12-31T12:42:16.343
> 
> 标签：asp.net-mvc, activerecord, castle-activerecord, crud

我正在使用 asp.net mvc 并且正在尝试创建一个新员工，在我的表单中我使用 Html.DropDown(...) 来显示可供选择的部门列表。

理想情况下，我希望 MVC 仅确定选择了哪个部门（Id 属性是下拉列表中的值），获取它并将其设置在传入的 Employee 对象中。相反，我得到一个空值，我必须使用 Request.Form[...] 自己获取部门。

我在这里看到了一个例子：http: [//blog.rodj.org/archive/2008/03/31/activerecord-the-asp.net-mvc-framework.aspx](http://blog.rodj.org/archive/2008/03/31/activerecord-the-asp.net-mvc-framework.aspx)但这似乎不适用于asp.net mvc测试版

这是具有经过充分验证的 ORM 的基本 CRUD ......真的需要这么难吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T04:34:02.320

ASP.NET MVC 不知道如何将 DepartmentId 表单值转换为 Department.Load(DepartmentId) 调用。为此，您需要为您的模型实现一个活页夹。

```
[ActiveRecord("Employees")]
[ModelBinder(EmployeeBinder]
public class Employee : ActiveRecordBase<Employee>
{
    [PrimaryKey]
    public int EmployeeId
    {
        get;
        set;
    }

    [BelongsTo(NotNull = true)]
    public Department Department
    {
        get;
        set;
    }

    // ...
} 
```

EmployeeBinder 负责将路由/表单数据转换为对象。

```
public class EmployeeBinder : IModelBinder
{
    #region IModelBinder Members

    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        // ...

        if (controllerContext.HttpContext.Request.Form.AllKeys.Contains("DepartmentId"))
        {
            // The Department Id was passed, call find
            employee.Department = Department.Find(Convert.ToInt32(controllerContext.HttpContext.Request.Form["DepartmentId"]));
        }
        // ...
    }

    #endregion
} 
```

有了这个，只要一个 Employee 被用作一个动作的参数，活页夹就会被调用。

```
public ActionResult Create(Employee employee)
    {
        // Do stuff with your bound and loaded employee object!
    } 
```

有关详细信息，请参阅[此博客文章](http://weblogs.asp.net/melvynharbour/archive/2008/08/29/how-to-use-the-asp-net-mvc-modelbinder.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T13:54:31.967

几周前，我[将 ARFetch 移植到了 ASP.NET MVC](http://bugsquash.blogspot.com/2009/02/arfetch-for-aspnet-mvc.html) ……也许这对你有帮助。

# cocoa-touch - NSURLConnection 在 3G 上下载质量较差的 JPEG

> ID：402911
> 
> 赞同：2
> 
> 时间：2008-12-31T12:43:58.757
> 
> 标签：cocoa-touch

我正在从服务器下载 JPEG 图像，并使用 NSURLConnection 将其分配给我的 iPhone 应用程序中的图像对象。

当我使用 Wifi 连接时，一切正常，但一旦我切换到 3G，下载的 JPEG 的质量就会大大降低。

有没有其他人经历过这个？

有谁知道强制 iPhone 下载完整质量的 JPEG 的方法？

提前致谢！缺口。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-31T13:07:53.407

如果是 3G 提供商即时压缩数据，我认为您无能为力。通过 3G 使用 Safari 下载图像 -> 如果图像看起来很糟糕（我希望它会），那么它是压缩它的提供商。

要解决此问题，请在服务器上压缩图像并在应用程序中解压缩 -> 这应该绕过 3G 端的压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-09T16:57:42.097

一个简单的技巧是使用 https 而不是 http - 这似乎适用于 O2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T12:07:30.653

我知道这个问题已经很老了，但如果这对任何人都有用......

```
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:theURL];
// Add headers to avoid mobile network operator image compression
[request setValue:@"no-cache" forHTTPHeaderField:@"Pragma"];
[request setValue:@"no-cache" forHTTPHeaderField:@"Cache-Control"]; 
```

应该停止压缩图像。

移动运营商会压缩图像以节省带宽，但他们倾向于尊重这些标头字段，并允许您请求未压缩的图像。

# nhibernate - Hibernate 内部连接映射 - 字符串 where id

> ID：402917
> 
> 赞同：1
> 
> 时间：2008-12-31T12:46:46.647
> 
> 标签：nhibernate, hibernate

我想在 NHibernate 中映射以下 sql。我是否需要制作一个单独的实体对象，即 RoomTypeVO 映射到 tb_tags 来执行此操作？非常感谢任何帮助。

SELECT dbo.tb_rooms.id, dbo.tb_rooms.name, dbo.tb_tags.name AS 'roomType' FROM dbo.tb_rooms INNER JOIN dbo.tb_tags ON (dbo.tb_rooms.typeID = dbo.tb_tags.id)

```
<id name="id" column="id">

  <generator class="native" />

</id>

<property name="name" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T16:45:58.300

如果您直接进行 sql 查询，则不必这样做。如果要使用 HQL，则必须使用实体。

但是，您总是可以直接进行 sql 查询。

如果您有一个映射实体，那么您可能只需执行以下操作：

```
FROM RoomType 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T06:53:18.357

当您提到“FROM”时，您是否在考虑这样的事情？

```
<property name="totalPrice"
formula="( SELECT SUM (li.quantity*p.price) FROM LineItem li, Product p
            WHERE li.productId = p.productId
            AND li.customerId = customerId
            AND li.orderNumber = orderNumber )"/> 
```

# visual-c++ - Unable to create temporary files while compiling

> ID：402923
> 
> 赞同：1
> 
> 时间：2008-12-31T12:52:47.617
> 
> 标签：visual-c++, visual-studio-2005, visual-c++-6, compiler-construction

I find increasingly now when I am building a large project, I get the following error.

> fatal error C1083: Cannot open compiler intermediate file: 'C:\Temp\SYS\a03132ex': Permission denied

It occurs in Visual Studio 2003 and VC6, and I have investigated the potential MSDN reasons and drawn a blank. There is plenty of space on the hard disk, and not that many other programs open that I should be running out of handles. Any ideas, or is it time to re-install windows again. I'm running XP SP3 by the way, and have two large NTFS hard disks with very many files.

Edit: the name of the temp file changes, and I have cleared out the entire c:\temp folder.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T12:54:54.010

我似乎从记忆深处的某个地方记得，删除由 Visual Studio 为项目创建的临时文件可以解决这个问题（直到它再次弹出）。

临时文件与您的项目同名。（如果没有帮助，您的主目录中可能还有一些与 VC/VS 相关的内容。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T13:01:08.147

如果这没有帮助，请检查您的 TMP 环境设置是否不以分号结尾。它也应该是完全合格的路径，而不是相对的。

编辑：我在[互联网](http://www.bokebb.com/dev/english/1961/posts/196158987.shtml)上找到了一个关于它的主题，据说如果您尝试包含目录而不是文件，您可能会触发同样的错误。

我假设您已经验证了这一点，但实际的 C:\Temp\SYS 文件夹是否具有正确的权限（即允许所有用户在其中读/写文件）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T13:12:49.637

`c:\temp`您还可以检查与和相关的权限`c:\temp\sys`（如果 sys 确实存在于编译会话之外）

```
cacls c:\temp 
```

此外，（如此处所[建议](http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/7f4fb0d7-419e-400c-93cf-292c5bc8b322/)），尝试在高级选项下设置编译器标志 -Bd 并检查编译器中的参数。也许您打算指定一个路径并最终编译一个不存在的文件？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-08T15:46:04.050

保持您的临时文件位置简单，例如，当我将项目从笔记本电脑复制到办公室 PC 时，VS2003 项目没有编译。“tmp”系统变量指向 %USERPROFILE%/TEMP。Visual Studio 2003 给出了一些“致命错误 C1083：无法打开编译器中间文件：”错误

我在 C 盘上新建了一个临时文件夹，并将系统变量 TMP 更改为“C:/TEMP”。重新编译程序，瞧，没有错误！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-26T09:08:16.503

不要单击编译器中的**Rebuild**按钮，仅单击**Build**按钮 - 这解决了我的问题

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-17T13:28:16.700

我有完全相同的问题。在构建项目时禁用防病毒软件解决了这个问题。一个可能的永久解决方案是将 VS 的临时目录设置在其他地方，并告诉防病毒软件排除该目录。

# security - 错误与漏洞？

> ID：402936
> 
> 赞同：16
> 
> 时间：2008-12-31T13:07:03.767
> 
> 标签：security

软件错误和软件漏洞之间有什么区别（如果有）？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-12-31T13:11:59.717

错误是指系统没有按照设计的方式运行。

漏洞是滥用系统的一种方式（最常见的是与安全相关的方式）——无论是由于设计错误还是实现错误。换句话说，即使该设计的实现是完美的，某些东西也可能由于有缺陷的设计而存在漏洞。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-31T13:15:08.897

**漏洞**是**bug**的一个子集。

错误是产品中的*任何*缺陷。

漏洞是表现为恶意使用产品的机会的错误。漏洞通常不是那么明显，但需要独创性才能被利用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T13:10:36.613

两者有时会重叠，但我会说“错误”是一个错误，而“漏洞”顾名思义是一个弱点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T13:09:28.427

从编程的角度来看，我相信错误和漏洞之间没有区别。它们都是软件中的错误。

但是，从安全角度来看，漏洞是一类可以被恶意人员以某种方式操纵的错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T13:19:53.273

错误是您的系统未能满足要求。

漏洞是错误的一个子集——当您的系统可能被强制进入不满足要求的故障模式时，通常是通过以意想不到的方式使用您的系统（或您的系统所依赖的东西）。

通常，漏洞可能会导致无法满足以下一个或多个方面的要求：

*   保密
*   正直
*   可用性

或者你可以结合最后两个：

*   保密
*   可靠性（= 完整性 + 可用性）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T13:12:58.387

在我看来，漏洞是使某人能够对您的软件执行恶意或有害操作的错误子集。

错误只是无法正常工作的代码（您如何正确定义取决于意见）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T14:04:09.440

[维基百科](http://en.wikipedia.org/wiki/Vulnerability_%28computing%29)：

> 在计算机安全中，漏洞一词适用于系统中的弱点，它允许攻击者破坏该系统的完整性

例如，家用电脑容易受到洪水和手榴弹等物理威胁的影响，但它们不被视为“错误”。在企业环境中，如果系统关闭的风险足够大，例如空中交通支持或核反应堆管理，这些威胁会得到更严肃的处理。

[业务连续性计划](http://en.wikipedia.org/wiki/Business_continuity_planning)/[灾难恢复](http://en.wikipedia.org/wiki/Disaster_recovery)和[高可用性](http://en.wikipedia.org/wiki/High_availability)通常通过冗余硬件和将服务器分布到远程位置来处理物理威胁和故障。

[软件缺陷](http://en.wikipedia.org/wiki/Software_bugs)（或“错误”）的分类可能是主观的，因为它取决于软件设计的意图和需求。如果被滥用，给定受众群体的一个特征可能会被解释为对另一个群体的脆弱性。例如，[stackoverflow.com 现在向那些拥有 10k reps 的人公开自我封闭的问题](https://stackoverflow.com/questions/401140/stackoverflow-how-do-you-feel-about-others-seeing-posts-youve-deleted)。有人可能会说这是一个漏洞，因为它违反了普通用户的普遍期望（就像我说的，这是一个主观的调用）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-31T15:35:06.183

错误是软件未能满足要求。我认为这些是理想的需求，所以说需求分析中存在错误是有道理的，尽管这更值得商榷。

A vulnerability is a feature, intended or otherwise, that can be exploited maliciously. It is not necessarily a bug, provided that it was deliberate.

To change subjects, it is a vulnerability that my home wireless has a guessable WPA password, but that was a conscious choice, to facilitate use by my guests. That's an example of requirements leading to a vulnerability. If I'd entered a weak password because I didn't know better, that would have been a bug as well as a vulnerability.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-31T16:44:47.167

If you use Bugzilla, anything you need to do something with is a bug ;)

# ruby-on-rails - 有人开发了带有 Flex UI 和 Rails 后端的应用程序吗？

> ID：402955
> 
> 赞同：0
> 
> 时间：2008-12-31T13:20:02.803
> 
> 标签：ruby-on-rails, apache-flex, web-applications, flexbuilder

我正在研究使用 Rails 后端为 Flex 上的客户做一些工作的可能性。

这不是火箭科学，但我想知道是否有人对这两种令人敬畏的技术有一些经验？

提前致谢....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T14:42:00.737

Peter Armstrong 写了一本名为[Flexible Rails](http://www.flexiblerails.com/)的优秀书籍，并且还创建了一个名为[Ruboss](http://ruboss.com/framework/)的 Flex/Rails 框架。我建议您查看这两个资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T21:55:10.453

我已经使用 Flex 和 Rails 开发了一些应用程序。最简单的方法就是使用 as3corelib ( [http://code.google.com/p/as3corelib/](http://code.google.com/p/as3corelib/) ) 并使用标准 JSON 对象。您可以使用 AMF 序列化程序，但它们都不是生产就绪的（它们是用 ruby​​ 而不是 C 编写的）。

您需要确保的最重要的事情是，如果您从 Flex 创建资源，您需要从 flex 发送真实性密钥。我通过编写一个助手将其输出到视图来做到这一点：

```
<script language="Javascript">
    function getAuthKey() { return "<%= form_authenticity_token %>"; }
</script> 
```

然后使用 ExternalInterface 在 Flex 内部调用它。

```
ExternalInterface.call('getAuthKey') 
```

# windows-mobile - 有哪些技术可以解决 Windows Mobile 设备上非常间歇性的访问冲突？

> ID：402957
> 
> 赞同：3
> 
> 时间：2008-12-31T13:28:55.640
> 
> 标签：windows-mobile, compact-framework, access-violation

我有一个大型 Compact Frameworks V2.0 应用程序，在大多数情况下运行良好。在某些设备上大约每天一次，用户会收到一个本机错误 0xC0000005，该错误未被标准托管的 Try/Catch 块捕获。

我的应用程序以固定的时间间隔通过 ASMX 调用与服务器同步。该问题似乎发生在同步期间。除了同步时发生的 ASMX 调用外，还有相当多的业务逻辑，但其中 98% 是托管代码。我已经查看了我所有的 P/Invokes 和应用程序原生 C++ 库，此时我大约 95% 确定这不是问题所在。

由于这只发生在某些设备上并且很少发生（每天少于一次），因此很难隔离。我已经分析了我的代码，它看起来好像发生在应用程序中的随机位置，所以我怀疑某些东西正在破坏内存。

任何有关如何进一步解决此问题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T14:51:38.517

0xC0000005 是访问冲突，因此某些东西正试图读取或写入它无权访问的地址。这些往往很难找到，经验是最好的工具之一（好吧，Platform Builder 的调试器也很有帮助，但这是一个完全独立的调试途径，需要你可能没有或已经有的经验试过了）。我发现日志记录往往不如减法编码有用 - 尽可能使用模拟托管调用删除 P/invoke 调用。

托管应用程序中的访问冲突通常由于以下原因之一发生：

*   您 P/Invoke 将句柄传递给托管对象的本机 API，并且本机 API 使用该句柄。如果在本机 API 运行时获得集合和压缩，则托管对象可能会移动并且指针变得无效。
*   您 P/Invoke 的缓冲区太小或小于您传入的大小，并且 API 超出了读取或写入
*   传递给 P/Invoke 调用的指针（IntPtr 等）无效（-1 或 0），并且本机在使用前未对其进行检查
*   您 P/Invoke 本机调用并且本机代码耗尽内存（通常是虚拟的）并且不检查失败的分配和读取/写入无效地址
*   您使用未初始化的 GCHandle 或以某种方式指向已完成并收集的对象（因此它不是指向对象，而是指向对象曾经所在的地址）
*   您的应用使用句柄来处理因睡眠/唤醒而无效的内容。这更深奥，但肯定会发生。例如，如果您在存储卡上运行应用程序，则整个应用程序不会加载到 RAM 中。使用中的部分被按需调入执行。这一切都很好。现在，如果您关闭设备电源，驱动程序将全部关闭。当您重新启动电源时，许多设备只需重新安装存储设备即可。当您的应用程序需要在更多程序中请求页面时，它不再是它原来的位置并且它死了。安装存储上的数据库可能会发生类似的行为。如果您有数据库的打开句柄，则在睡眠/唤醒周期后，连接句柄可能不再有效。

You'll note the trend here that almost all of these are P/Invokes and that's no accident. It's quite difficult to get managed code to do this on its own.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T19:09:06.390

My native C++ exception handling was not including async exception, and thus was not catching access violation exceptions.

This may/may not be helpful for my problem, but might be helpful for others.

Using the /EHa switch as documented in this link will allow for catching these types of exceptions:

[http://msdn.microsoft.com/en-us/library/1deeycx5.aspx](http://msdn.microsoft.com/en-us/library/1deeycx5.aspx)

# svn - 从 Subversion 日志生成更改报告的工具

> ID：402964
> 
> 赞同：20
> 
> 时间：2008-12-31T13:34:04.070
> 
> 标签：svn

是否有从 Subversion 日志生成更改报告的好工具。

我们有很大的团队，每天都有很多提交。我正在寻找一些工具来显示所有文件的更改。我们正在使用 Subversion，所以我正在寻找一些可以读取 Subversion 日志的工具。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-31T17:18:54.320

svn2cl generates nice html pages from an svn log [http://ch.tudelft.nl/~arthur/svn2cl/](http://ch.tudelft.nl/~arthur/svn2cl/)

To create a html page instead of the default text output, run

```
svn log --xml -v > log.xml
xsltproc.exe --nowrite --nomkdir --nonet -o changelog.html svn2html.xsl log.xml 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-31T14:07:33.613

svnmonitor 的替代方案是[CommitMonitor](http://stefanstools.sourceforge.net/CommitMonitor.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-31T14:36:25.957

我每晚使用[SVNStat](http://sourceforge.net/projects/svnstat)生成这类报告。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T13:43:49.307

一个词：trac。trac.edgewall.org

# c# - 是什么让 Java 编译器如此之快？

> ID：402969
> 
> 赞同：12
> 
> 时间：2008-12-31T13:39:26.133
> 
> 标签：c#, java, .net, c++, compiler-construction

我想知道是什么让主要的 Java 编译器（sun 的 javac）在编译时如此之快？

..以及来自 Microsoft 的 C# .NET 编译器。

我正在将它们与 C++ 编译器（例如 G++）进行比较，所以也许我的问题应该是，是什么让 C++ 编译器如此缓慢:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-31T14:04:15.350

这个问题在这个问题中得到了很好的回答：[为什么 C++ 编译需要这么长时间？](https://stackoverflow.com/questions/318398/why-does-c-compilation-take-so-long#318440)（正如 jalf 在评论部分指出的那样）

基本上它是 C++ 缺少的模块概念，以及编译器所做的积极优化。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-31T13:56:23.637

我认为最困难的部分不是需要编译头文件（除非它们真的很大，但在这种情况下你可以使用预编译的头文件）。最糟糕的部分始终是 C++ 的语法对上下文过于敏感。尽管我喜欢 C++，但我为任何不得不编写 C++ 解析器的人感到抱歉。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-31T14:12:50.403

有几件事使 C++ 编译器比 Java/C# 的编译器慢。语法要复杂得多，通用编程支持在 C++ 中要强大得多，但同时编译成本更高。包含文件的工作方式与导入模块不同。

**包含头文件**

首先，每当你在 C++ 中包含一个文件时，文件的内容（通常是 .h）都会被注入到当前编译单元中（包含保护避免两次重新注入相同的头文件），这是传递的。也就是说，如果你包含header ah，那又包含bh，你的编译单元将包含ah中的所有代码和bh中的所有代码

Java（或 C#，我将讨论 Java，但它们在这方面是相似的）没有包含文件，它们依赖于所用类编译的二进制文件。这意味着每当你编译使用b.java中定义的对象B的a.java时，它只是检查二进制b.class，它不需要更深入地检查B的依赖关系，所以它可以更早地切断过程（只有一级检查）。

同时，包含文件只包含语言定义，处理需要时间。当 Java/C# 编译器读取二进制文件时，它具有相同的信息，但已由生成它的编译步骤处理。

所以最后，在 C/C++ 中包含更多文件，同时处理这些包含比处理二进制模块更昂贵。

**模板**

模板以自己的方式很特别。它们可以被预编译，但通常不是（有很多原因）。这意味着在所有使用 std::vector 的编译单元中，使用的整个向量方法集（未使用的模板方法不会被编译）被处理并由编译器生成二进制代码。在稍后的步骤中，在链接期间，相同方法的冗余定义将被删除，但在编译期间必须对其进行处理。

Java 中对泛型的支持在许多方面受到更多限制。最后，例如，只有一个 Vector 类二进制文件，每当编译器在 java 中看到 Vector 时，它所做的就是在委托给真正的 Vector 实现（存储普通对象）之前生成类型检查代码，这不是通用的。编译器确实提供类型保证，但不会为每种类型编译 Vector。

在 C# 中，它再次不同。C# 对泛型的支持比 Java 更复杂，最终泛型类与普通类不同，但无论如何它们只编译一次，因为二进制格式包含所有必需的信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-31T14:17:05.730

因为它们做的事情完全不同，C++ 编译器生成优化的本机代码，而 C#、VB .Net 和 Java 编译器生成中间语言，而不是当您第一次执行应用程序时将其转换为本机代码，这就是为什么您在应用程序中加载缓慢的原因首次执行应用程序时的 Java 等。

当您执行应用程序时，C++ 编译器必须对 JITed 语言进行优化的地方进行全面优化。

有人会争辩说，如果你想正确的话，你必须测量 C++ 编译时间 = Java 编译时间 + 首次加载应用程序时的 JIT 时间，但我认为这不是正确和公平的，因为你是在比较原生语言到 JITed，或者橙子到苹果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-31T13:50:18.750

C++ 编译器必须重复编译所有头文件，而且头文件很多，所以这是减慢它的一件事。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-31T14:01:16.027

编译时比较耗时的任务之一是代码优化。

Javac 在编译时对代码做的优化很少。相反，在运行应用程序时由 JVM 进行优化。

编译时需要优化 AC/C++，因为编译的机器代码的优化很难。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-31T14:03:46.287

您在最后一句话中说对了：编译速度快的不是 java 或 C#，而是 C++ 由于其复杂的语法和功能，最重要的是[模板，因此编译速度非常慢](http://yosefk.com/c++fqa/templates.html#fqa-35.10)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-31T14:07:06.157

如果你认为 javac 很快，试试 Jikes....（参见[http://jikes.sourceforge.net/](http://jikes.sourceforge.net/)）它是一个用 C++ 编写的 Java 编译器。不幸的是，他们没有跟上最新的 Java 编译器规范，但如果您想快速查看，就是这样。

托尼

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-31T14:01:07.353

我认为部分原因是语言的复杂性。C++ 具有难以置信的可变性，能够覆盖几乎任何运算符或语法（例如覆盖 () 运算符）。这意味着编译器必须做*更多*的工作才能确定实际运行哪些操作，即使对于简单的事情也是如此。Java 和 C# 没有这个问题，因为语法是固定的，而且它们通常更易于解析。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-31T14:36:55.333

比较像 java 这样的字节码语言和像 C++ 这样的本地编译语言有点困难。更好的比较是 Delphi 与 C++，其中 Delphi 的编译速度要快得多。由于这与优化或字节码无关，因此一定是由于语言语法的差异以及包含与模块/单元的相对性能。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-23T07:01:01.187

Java编译器快吗？

Java 到类的转换应该非常快，因为它只是一个带有一些语法检查的美化 zip，所以如果与进行优化和目标代码生成的真正编译器相比，从 Java 到类的“转换”是微不足道的。

与相当小的程序“hello world”进行比较并与 GCC (C/C++/Ada) 进行比较，发现 javac 慢了 30 倍，并且在运行时变得更糟？

# visual-studio - Visual Studio 升级建议 2008 / 2010

> ID：402978
> 
> 赞同：6
> 
> 时间：2008-12-31T13:45:47.557
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2010

目前正在考虑为我们从 vs 2005 (winforms) 迁移到 vs 2008 (wpf) 提出论点。我的主要观点是新的 UI 设计功能。

我有点担心我们会投入大量工作来升级所有东西，只是为了在 2010 年到来时我们必须做同样的事情？因此，这导致还考虑跳过 2008 年并在 2010 年发布后立即采用。

有人遇到过类似情况吗？

也欢迎任何支持和反对的论点。

干杯。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-31T13:57:44.397

我个人认为进入 2008 年将是相当安全的，因为 2010 年只是在它之上的扩展和对 WPF 的 Visual Studio 设计时支持的增强。因此，过渡不应该那么复杂。更像是 2005-2008 年 Win Forms 或 ASP.NET 项目的升级，这是小菜一碟。

我发现最好尽早升级，这样您就不会“陷入”现有框架/系统的困境。如果您继续在最终将要替换的东西上进行构建，则越来越难以证明管理层采取行动的合理性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-31T13:58:20.667

我遇到了同样的情况，并选择了 MSDN 订阅路线，在那里我得到了所有新的开发工具。我有一台备用机器，用于编译器的“下一个版本”，用于迁移测试，因此我至少知道必须做出决定时会发生什么。这对我来说效果很好，我想如果你有一个像样的虚拟化设置会更好。

新的编译器版本并没有破坏我的构建，但确实伤害了我的许多自动化测试和附加生产力工具。基本上。您需要某种回归测试来确定迁移到新版本可能造成的损害。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-31T13:58:46.487

你的问题对我来说没有多大意义。您是否在问是否应该将现有应用程序从 Winforms 迁移到 WPF？或者您只是想开始制作新的 WPF 应用程序，但仍然使用现有的 Winform 项目？

无论哪种方式，从 Visual Studio 2005 迁移到 2008 都非常简单。现有的 Winform 项目需要几秒钟的转换，对我来说从未失败（过去几个月转换了数十个解决方案和 100 个项目）。

但是，这与 Winforms 和 WPF 无关。

如果您想开始构建 WPF 应用程序，没有理由等待 VS 2010。V​​S 2008 对这两种应用程序类型都提供了出色的支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-31T14:20:18.597

我同意那些建议现在采用 VS 2008 的人。不过要考虑的一件事是 WPF 具有相当高的学习曲线。我对 WPF 和 Silverlight 的接触有限，我发现它们是 WinForms 模型的完全“思想转变”。祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T14:25:25.403

如果我在你的鞋子里，我现在会跳起来。通过让您习惯许多您已经必须习惯的新功能，它将最大限度地减少 2010 年跳线的影响。此外，在 2010 年推出之前，您将享受数月的更好性能和功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-02T06:30:24.893

Winforms 与 WPF 是天壤之别。与从 2005 年迁移到 2008 年相比，这是一个更大的变化。我不会将其作为升级到 2008 年的驱动理由。我也不知道您的项目范围以及 WPF 是否真的是您的最佳选择产品。或者，如果表达式混合是让这些 UI 运行所需的全部工具。

我不会专注于 WPF 推销，而是专注于您可以立即获得的真正好处。在 2008 中，您具有多目标，因此您可以构建您在 2005 中构建的所有应用程序，并让它们以 2.0 框架为目标。根据我的经验，我发现 2008 更快，重构改进是一个很好的补充。2008 年还有许多其他新改进，您可以开箱即用，并且可以从第一天开始使用。

根据 2010 的首席架构师 Rico 的说法，您将在 2010 中获得更丰富的多目标，这将允许您更早地采用 2010，而不是强迫您从一开始就使用 CLR 版本 4。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-02T06:22:07.983

目前我已经养成了尽快升级到最新版本的习惯。尽管对于应用程序开发人员来说，它有自己的陷阱，例如。.Net Framework 3.5 在大多数计算机上都找不到，如果我提供 20 MB 的引导安装程序，它会坚持使用活动的 Internet 连接来下载所需的文件。完整的安装程序是 198 MB，虽然我不喜欢它，但我必须将它与软件一起提供。

对于 Web 开发人员来说，虽然问题更容易解决，但您只需要担心使其在服务器上工作，并且事情会自动为用户工作。因此，如果您正在制作 Web 解决方案，我认为迁移更容易。

如果您正在制作应用程序软件，我认为您应该权衡迁移提供的优势以及它将对您的部署方案所做的更改。我不知道有多少人会同意这一点，但我相信应用程序开发人员应该落后一个升级。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-02T06:36:29.093

这里有一个潜在的流程问题，我认为不应该被忽视：

*何时是升级开发工具和生产环境的合适时机？*

一方面，您可以跳过 2008 年，但这会导致何时采用 2010 年的问题：在首次发布、首次服务包发布或其他里程碑时？如果您在 2005 年使用 2.0 框架而其他人转向其他框架，这可能会导致创建更多遗留代码。即使您切换到 2008，它仍然可以针对 2.0 框架，因此 .Net 框架的升级可能会单独发生，有些人可能会喜欢。这个阵营的另一个关键点是谁做研究来评估版本之间的差异，看看哪些值得转变。

另一方面，你可以建议有一个连续的策略，准备每 3 年左右升级一次，因为过去十年的 Visual Studio 版本到目前为止大约是 2002 年、2003 年、2005 年和 2008 年。在我看来，这似乎是更好的方法，因为更多的是不断的进化，而不是完全被锁定。在这种情况下，可能会使用新功能，因为与第一种情况相比，新工具来得很快2-3年。

当然，正如我所说，我的旧工作机器有 Visual Studio 2003、2005 和 2008，所以我有点在后一个阵营中，这对我来说很有意义。我记得 10 年前我的工作机器有 NT 4.0、Pentium II 333 MHz 处理器、64 MB RAM 和一个 4 GB 硬盘驱动器，它必须是 2 个分区，因为它不会让一个分区那么大。现在我的工作机器只有 4 GB 的 RAM、一个 2.66 GHz 双核处理器和一个 160 GB 硬盘驱动器。再过 10 年，我能拥有一台拥有数百 GB RAM 的机器吗？虽然这看起来很荒谬，但如果我与少数其他开发人员共享一台机器，那么在我们所有人之间分配大量内存可能是有意义的。

# mysql - 如何在SQL中找到指定记录之后的下一条记录？

> ID：402980
> 
> 赞同：21
> 
> 时间：2008-12-31T13:46:19.880
> 
> 标签：mysql

我想使用单个 SQL 查询（在 MySQL 中）来查找我指定的记录之后的记录。

即，如果表有：

```
id, fruit
--  -----
1   apples
2   pears
3   oranges 
```

我希望能够进行如下查询：

```
SELECT * FROM table where previous_record has id=1 order by id; 
```

（显然这不是真正的 SQL 语法，我只是使用伪 SQL 来说明我想要实现的目标）

这将返回：

```
2, pears 
```

我目前的解决方案是获取所有记录，并在 PHP 中查看它们，但这比我想要的要慢。有更快的方法吗？

我会对返回两行的东西感到满意——即具有指定值的那一行和下一行。

编辑：对不起，我的问题措辞不当。不幸的是，我对“下一个”的定义不是基于 ID，而是基于水果名称的字母顺序。因此，我上面的示例是错误的，应该返回橙子，因为它按字母顺序排在苹果之后。有没有办法对字符串而不是 id 进行比较？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-31T13:49:18.987

在问题的编辑和下面的简化之后，我们可以将其更改为

```
SELECT id FROM table WHERE fruit > 'apples' ORDER BY fruit LIMIT 1 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T13:54:54.700

```
SELECT * FROM table WHERE id > 1 ORDER BY id LIMIT 1 
```

更简单

更新：

```
SELECT * FROM table  WHERE fruit > 'apples' ORDER BY fruit LIMIT 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-31T13:51:09.137

我不熟悉 MySQL 语法，但是使用 SQL Server 你可以用“top”做一些事情，例如：

```
SELECT TOP 1 * FROM table WHERE id > 1 ORDER BY id; 
```

这假设 id 字段是唯一的。如果它不是唯一的（例如，外键），您可以执行类似的操作，然后针对同一个表连接回来。

由于我不使用 MySQL，因此我不确定语法，但可以想象它是相似的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T14:25:53.280

如此简单，不需要体操

```
Select * from Table
where id = 
    (Select Max(id) from Table
     where id < @Id) 
```

或者，基于字符串@fruitName = 'apples', or 'oranges' 等...

```
Select * from Table
where id = 
    (Select Max(id) from Table
     where id < (Select id from Table
                 Where fruit = @fruitName)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T13:54:54.590

除非您指定排序顺序，否则我不相信 SQL 中可以使用“上一个”或“下一个”的概念。默认情况下，RDBMS 不保证您的特定顺序。如果您可以按某列排序为升序或降序，那是另一回事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T14:02:51.033

我不知道 MySQL SQL 但我仍在尝试

```
select n.id 
from   fruit n
,      fruit p
where  n.id = p.id + 1; 
```

编辑：

```
select n.id, n.fruitname 
from   fruits n
,      fruits p
where  n.id = p.id + 1; 
```

编辑二：

Jason Lepack 曾说过，当有差距时，这是行不通的，这是真的，我应该更好地阅读这个问题。

我应该使用分析对水果名称的结果进行排序

```
select id
,      fruitname
,      lead(id) over (order by fruitname)  id_next
,      lead(fruitname) over (order by fruitname) fruitname_next
from   fruits; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T14:17:09.117

这应该有效。字符串“apples”需要作为参数。

用字符串填充该参数，此查询将按字母顺序返回该项目*之后的第一个水果的整个记录​​。*

与 LIMIT 1 方法不同，这应该与平台无关。

```
--STEP THREE: Get the full record w/the ID we found in step 2
select *
from 
  fruits fr
 ,(   
  --STEP TWO: Get the ID # of the name we found in step 1
  select
    min(vendor_id) min_id
  from 
    fruits fr1
   ,(
    --STEP ONE: Get the next name after "apples"    
    select min(name) next_name
    from fruits frx
    where frx.name > 'apples'
    ) minval
  where fr1.name = minval.next_name
  ) x
where fr.vendor_id = x.min_id; 
```

相当于 Oracle 中的 LIMIT 1 方法（仅供参考）是这样的：

```
select *
from
  (
  select *
  from fruits frx
  where frx.name > 'apples'
  order by name
  )
where rownum = 1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-13T23:00:40.823

如果您正在使用`MS SQL Server 2008`（不确定是否适用于以前的版本）...

如果您尝试查找下一条记录并且您没有唯一 ID 以适用的方式引用，请尝试使用`ROW_NUMBER().`查看[此链接](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

根据您的`T-SQL`技能水平，您可以根据排序顺序创建行号。然后，您可以找到的不仅仅是上一条和下一条记录。在视图或子查询中使用它来查找相对于当前记录的行号的另一条记录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-22T01:05:02.160

```
SELECT cur.id as id, nxt.id as nextId, prev.id as prevId FROM video as cur
  LEFT JOIN video as nxt ON nxt.id > cur.id
  LEFT JOIN video as prev ON prev.id < cur.id
WHERE cur.id = 12
ORDER BY prev.id DESC, nxt.id ASC
LIMIT 1 
```

如果您想要包含上一个和下一个项目的项目，此查询可以让您做到这一点。

这也让你在数据上有差距！

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2008-12-31T13:54:09.537

这个怎么样：

```
Select * from table where id = 1 + 1 
```

# oop - OOP 中的主要概念

> ID：402984
> 
> 赞同：27
> 
> 时间：2008-12-31T13:48:00.783
> 
> 标签：oop, language-agnostic

我曾经在一次采访中被问到“OOP 的 3 个主要概念是什么？”。我回答说，在我看来有4个如下：

*   遗产
*   封装
*   抽象
*   多态性

我是对的吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-12-31T14:24:53.080

面向对象的语言有 3 个要求：

*   只支持封装（对象）的语言不是面向对象的，但它是模块化的
*   只支持封装（对象）和消息传递（多态）的语言不是面向对象的，而是基于对象*的*
*   一种支持封装（对象）、消息传递（多态性）和继承（抽象）的语言，*是*面向对象的

注意：*抽象*是一个更笼统的概念；封装等都是抽象的*一种*，就像子程序是一种抽象一样。见[抽象](http://en.wikipedia.org/wiki/Abstraction_%28computer_science%29)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-31T13:53:09.243

我想说抽象不仅仅是一个 OOP 概念，因为您可以在很大程度上抽象许多非 OOP 语言。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-03-22T17:51:53.927

四大支柱是你正确的状态

*   封装。
*   抽象
*   遗产
*   多态性

封装处理包含数据，仅此而已。

抽象处理数据抽象，即所有这些数据是否真正相关。想想一家银行，它包含姓名、年龄、地址、眼睛颜色、最喜欢的领带等信息。眼睛颜色和最喜欢的领带真的与银行的要求相关吗？不，这是抽象。

继承处理泛化。可以应用于不止一件事的信息。如果某物从某物继承，则可以说它是该物的更具体类型。例如，动物。Dog 是 Animal 的一种，所以 Dog 继承自 Animal。Jack Russell 是 Dog 的一种，所以 Jack Russell 继承自 Dog。

多态性处理具有多种形式的事物（poly - morph）。编程中的两种，

*   后期装订，
*   您将某些东西称为通用类型，因此编译器不知道在编译时要绑定什么。认为方法覆盖。

*   早期绑定

*   您使用不同的签名重新定义方法，即 `int add(int a, int b) vs double add(double a, double b)`

这些本质上是面向对象的基本原则。这些之间有很多重叠，因此清楚地理解这些含义是非常重要的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-31T14:07:21.663

OOP 的问题是没有人费心给出一个*适当的*、简洁的、一致同意的定义。特别是，我想指出，您提到的所有方面都可以在不使用面向对象的情况下付诸实施！

执行此操作的两个类型系统是 Haskell 类型系统，根据共识，它通常不被认为是面向对象的，以及具有模板子类化的 C++ 模板。然而，可能有人认为模板子类化模拟了 OOP。

由于模板子类化不是一种广为人知的机制，让我举一个来自[SeqAn 库](http://www.seqan.de/)的例子，它是在哪里发明的。

```
String<Char> cstr = "This is a test";
String<Dna, Packed<> > dstr = "GATTACA";

cout << "length(" << cstr << ") = " << length(cstr) << endl;
cout << "length(" << dstr << ") = " << length(dstr) << endl; 
```

在这里，`String<Char>`和*继承*了“<em>抽象类” 。它们*封装*了字符串的概念，使用完全不同的方法。它们共享*多态*方法，两种具体类型的实现方式不同。`String<Dna, Packed<> >`*`String<>` **`length`***

 **** * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T13:52:23.643

他们就是我认识的四骑士。也许他们错误地将继承和多态混为一谈。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-31T13:51:58.293

大多数人会认为这是正确的，我的猜测是如果他们要求三个，那就是继承、封装和多态。

我个人认为这三个概念是真正的“肉”，如果你会支持 OOP 的定义的话。大多数人认为抽象是理所当然的，并将其与其他人混为一谈，因为它实际上可以被视为其他三个中任何一个的一部分。

当我谈论 OOP 时，虽然我总是提到 4。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-31T13:53:44.420

是的，这些是标准的四个。

有些人将抽象和封装结合起来。我不确定为什么......它们不是完全正交的，但也许有足够的重叠？继承和多态性之间肯定有重叠，但在我看来，很难将它们结合起来。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-31T13:53:42.800

可能最后三个是他们正在寻找的 - 可以认为继承更多地是一种帮助实现其他更高层次目标的机制。

无论如何都没有真正正确的答案，特别是如果仅限于“前 3 名”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-31T13:56:08.957

这是正确的。

但是，如果您必须只提供一个抽象，它必须是，因为，一种或另一种方式，其余的三个只是抽象*的行动*。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-31T14:24:11.567

OOP 中的 3 个主要概念：

*   后期装订
*   概念重用（无论如何都不确定：重用概念；避免重新实现即使是最简单的概念）
*   抽象

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T14:38:00.197

这个问题的正确答案是：“请澄清你所说的面向对象编程是什么**意思。”** 糟糕，这很能说明问题，因为被问到的真正问题是：“当我说 OOP 时，我的意思是什么？”

没有正确答案。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-05-04T12:54:26.210

面向对象

抽象（忽略或隐藏无关紧要的细节） - 主题非常笼统且不基于真实情况的情况。

封装 - 在类内部保持属性和方法私有，因此无法从类外部访问它们。

！API - 本质上是所有非私有、未封装的方法。

继承 - 使某个类的所有属性和方法对子类可用。

Polymorphism-gr：“许多形状” - 子类可以覆盖它从父类继承的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-31T14:15:52.613

这篇 [article][1] 提到了优秀代码的三大支柱。我发现这是一篇很好的文章，它认为封装是面向对象设计的“第一原则”。

“第一”原则是基本的、基本的原则，其他一切都源于此。作者以黄金法则为例。教孩子文明行为的所有细节是很困难的，但如果你能让他们理解（更重要的是，实践）以你希望被对待的方式对待他人的黄金法则，那么他们更有可能“得到”我们每天都要遵守的所有法律和道德标准。

因此，如果开发人员将封装理解为面向对象开发的“第一原则”，那么所有其他原则都会在适当的时候遵循。

我不公正作者的内容，但我肯定会鼓励人们阅读它。

出于某种原因，我没有显示超链接，所以这里是 URL：http://www.netobjectives.com/files/Encapsulation_First_Principle_Object_Oriented_Design.pdf

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-31T14:36:40.933

这可能是面试的一个技巧问题，但这些天在计算机科学课程中，他们教授面向对象编程的 4 个支柱。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-29T05:18:28.533

人们普遍认为这些是主要原则，但它们与创建 OO 的原因几乎没有关系。

指导原则之一是直接操纵隐喻。那就是在程序中创建一个对象，该对象代表用户心智模型中的对象。创建 OO 的大部分动机是基于心理学而不是数学/计算机科学，因为现在人们通常认为是这种情况。

如果对此存有疑问，请查看 Trygve Renskauge 的一些作品。MVC 和 DCI 之父或 James Coplien 成就了作家和演讲者。

所以我想说你可能给他们的答案接近他们所期望的答案是否正确取决于你的立场。

# c++ - 在 C++ 中传递函数指针

> ID：402992
> 
> 赞同：5
> 
> 时间：2008-12-31T13:52:25.827
> 
> 标签：c++, windows, multithreading, function, pointers

我想做这个简单的代码工作。

```
#include <iostream>
#include <windows.h>

    void printSome (int i)
    {
        std::cout << i << std::endl;
    }

    void spawnThread (void (*threadName)(int i))
    {
        CreateThread 
            (
                0,      // default security attributes
                0,          // use default stack size 
                (LPTHREAD_START_ROUTINE)threadName,  // thread function name
                (LPVOID)i,          // argument to thread function 
                0,          // use default creation flags 
                0       // returns the thread identifier 
            );  
    }

    int main ()
    {
        spawnThread(printSome(155));
    } 
```

我在windows上，使用vs。任何帮助都会得到很大的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-31T14:13:18.780

CreateThread 需要 2 个参数：指向要作为线程执行的函数的指针，以及将提供给线程的 DWORD 参数。您的 spawnThread() 函数只有 1 个参数（threadName）；你*认为*它有 2 个 args 因为“i”，但这确实是“threadName”类型定义的一部分。（您也可以省略“i”；也就是说，您不需要将参数命名为“threadName”。）

无论如何，鉴于您需要 2 个参数，请重新定义 spawnThread：

```
 void spawnThread(void (*threadEntryPoint)(int), int argument)
   {
      CreateThread(0,0,
                   (LPTHREAD_START_ROUTINE)threadEntryPoint,
                   (LPVOID)argument,
                   0,0);
   } 
```

请注意，我没有将 int 参数*命名*为 threadEntryPoint；告诉编译器该函数必须有一个 int 参数就足够了。

并称之为：

```
 spawnThread(printSome, 155); 
```

无论如何，又快又脏，这会做你想要的。

hth。

赖利。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-31T14:55:47.370

就个人而言，我不会考虑像您尝试像 C++ 那样传递函数指针。那是用 C++ 编写 C

相反，我会将那个东西包装在一个类中。最大的优势是您可以重写该类以拥有您想要的任意数量的成员，而不必每次都执行油腻的转换技巧来获取您的参数。

代码有点啰嗦，所以我把它推到最后。但它让你做的是这样的事情：

```
 class print_some : public basic_thread {
    private:
       int i;
    public:     
       print_some (int i) : i(i) {};
       action_callback () {
          std::cout << i << std::endl;
       }
    }
    int main () {
       print_some printer (155);
    } 
```

以下是我们其中一个类的一些摘录示例代码：

```
class basic_thread : 
{
public:
   basic_thread();
protected:
   unsigned long m_ThreadId;

   virtual void action_callback () {};

   // Internal routine used to bridge between OS callback format and 
   // action_callback. *Must* be static for the OS.
   static unsigned long __stdcall self_calling_callback (void *parameter);
} 
```

...在 .cpp 中：

```
unsigned long __stdcall basic_thread::self_calling_callback (void *parameter) {
   if (parameter) {
      basic_thread * thread = reinterpret_cast<basic_thread *>(parameter);
      thread->action_callback();
   }
   return 0; // The value returned only matters if someone starts calling GetExitCodeThread
             // to retrieve it.
}

basic_thread::basic_thread () {
   // Start thread.
   m_Handle = CreateThread(NULL,
                           0,
                           self_calling_callback,
                           (PVOID)this,
                           0,
                           &m_ThreadId );
   if( !IsHandleValid() )
      throw StartException("CreateThread() failed", GetLastError());

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-31T14:14:06.173

不能在函数指针中传递参数信息；它必须单独通过。这正是 CreateThread 函数提供一个 void* 参数的原因，该参数可以指向您想要的任何内容。

此外，对于 C++ 应用程序，您应该[使用 _beginthread 而不是 CreateThread 。](https://stackoverflow.com/questions/331536/windows-threading-beginthread-vs-beginthreadex-vs-createthread-c)

最后，您的程序很可能在线程运行之前终止。因此，您必须进入无限循环或使用 API 调用来等待线程完成。

以下是使用[WaitForSingleObject](http://msdn.microsoft.com/en-us/library/ms687032.aspx)阻塞直到线程完成的工作版本。

```
#include <iostream>
#include <process.h>
#include <windows.h>

void
printSome(int i)
{
    std::cout << i << std::endl;
}

HANDLE
spawnThread(void (*threadName)(int), int i)
{
    return (HANDLE) _beginthread((void (*)(void*)) threadName, 0, (LPVOID) i);      
}

int
main(int argc, char *argv[])
{
    HANDLE threadHandle;

    threadHandle = spawnThread(printSome, 155);
    WaitForSingleObject(threadHandle, INFINITE);

    return 0;
} 
```

* * *

这是处理同样情况的更 C++/面向对象的方式：

```
#include <iostream>
#include <process.h>
#include <windows.h>

class Thread {
    static void proxy(void *arg) { (*(reinterpret_cast<Thread *> (arg)))(); }
    HANDLE thread_;

public:
    virtual ~Thread() {}
    virtual void operator()() = 0;  
    void start() { thread_ = (HANDLE) _beginthread(Thread::proxy, 0, this);}    
    void waitForExit() { WaitForSingleObject(thread_, INFINITE); }
};

class Printer : public Thread {
    int i_;

public:
    Printer(int i) : i_(i) {}
    void operator()() { std::cout << i_ << std::endl; }
};

int
main(int argc, char *argv[])
{
    Printer p(155);

    p.start();
    p.waitForExit();

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-31T15:07:09.157

正如这里许多人已经提到的，您不能在一个参数中传递函数指针和应该调用它的参数。

你的线

```
 spawnThread(printSome(155)); 
```

“应该”（在 DWIM 世界中）表示“使用参数 155 在单独的线程上调用 printSome”。然而，这不是 C++ 理解它的方式。C++ 看到“将在 155 上调用的 printSome 的结果作为参数传递给 spawnThread”。换句话说，步骤顺序是：

*   以 155 作为参数调用 prinotSome。将其存储在临时内存中。
*   使用临时内存的内容作为参数调用 spawnThread。

为了做到你真正的意思，你必须幽默 C++ 并将参数与函数分开。如何做到这一点已经在其他答案中解释过。它的短处是：

callOnOtherThreadWithArgument（函数，整数）；

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-31T13:55:58.253

你可以在这里阅读你是如何做到的：http: [//www.newty.de/fpt/fpt.html](http://www.newty.de/fpt/fpt.html)

> 2.6 如何将函数指针作为参数传递？
> 
> 您可以将函数指针作为函数的调用参数传递。例如，如果要将指针传递给回调函数，则需要此参数。以下代码显示了如何将指针传递给返回 int 并采用 float 和两个 char 的函数：

```
//------------------------------------------------------------------------------------
// 2.6 How to Pass a Function Pointer

// <pt2Func> is a pointer to a function which returns an int and takes a float and two char
void PassPtr(int (*pt2Func)(float, char, char))
{
   int result = (*pt2Func)(12, 'a', 'b');     // call using function pointer
   cout << result << endl;
}

// execute example code - 'DoIt' is a suitable function like defined above in 2.1-4
void Pass_A_Function_Pointer()
{
   cout << endl << "Executing 'Pass_A_Function_Pointer'" << endl;
   PassPtr(&DoIt);
} 
```

# asp.net - 将 JSON 对象反序列化为 List 不使用 asmx 服务

> ID：402996
> 
> 赞同：19
> 
> 时间：2008-12-31T13:53:42.610
> 
> 标签：asp.net, json, asp.net-ajax, serialization

我在反序列化我的 JSON 字符串时遇到问题。我有一个`person`具有公共属性的类型，用于 int 类型的序列号、名字和姓氏。我想以 JSON 格式传递这些对象的数组并将它们反序列化为列表，以便我可以在服务器上循环它们，但是 ASP.NET 表示不支持将它们反序列化为数组。我已经验证了我正在生成的 JSON，它是有效的。ASP.NET 在反序列化之前需要拥有的 JSON 有什么特别之处吗？有趣的是，如果我将 list<person> 对象序列化为 JSON，它看起来与我正在生成的 JSON 完全一样。我一定遗漏了一些东西......为了澄清，我正在使用 ASP.NET Ajax 库进行反序列化。这是我从网络服务中得到的：

> {“消息”：“类型 \u0027System.Collections.Generic.IDictionary`2[[System.String，mscorlib，版本=2.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089]，[System.Object，mscorlib，版本=2.0 .0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]]\u0027 不支持数组的反序列化。"

实际上不幸的是，这似乎与反序列化没有任何关系，您似乎无法将 JSON 对象数组传递给 asmx Web 服务。我对么？如果你不能这样做，是否可以将 JSON 对象的集合传递给 Web 服务并使用 ASP.NET 和 C# 在服务器上处理它们？

### 更新：

好的，这是我的代码。这是人员类：

```
public class person
{
    public person()
    {
        //
        // TODO: Add constructor logic here
        //
    }

    public int seq
    {
        get;
        set;
     }

    public string firstName
    {
        get;
        set;
     }
     public string lastName
     {
        get;
        set;
     }

} 
```

这是我的 JSON 字符串：

```
[{"seq":1,"firstName":"Chris","lastName":"Westbrook"},
{"seq":2,"firstName":"sayyl","lastName":"westbrook"}] 
```

这是我正在使用的代码

```
 [WebMethod]
    public void updatePeople(string json)
    {
        IList<person> people = 
         new JavaScriptSerializer().Deserialize<IList<person>>(json);

        //do stuff...
    } 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-02T17:31:14.377

我想到了。我没有将我的 JSON 包装在像 ASP.NET Ajax 需要的对象中。对于此问题的未来查看者，所有 JSON 对象在发送到 Web 服务之前必须用主对象包装。最简单的方法是在 JavaScript 中创建对象并使用 json2.js 之类的东西对其进行字符串化。此外，如果使用 asmx Web 服务，对象必须具有 __type 属性才能正确序列化。这方面的一个例子可能是：

```
var person=new object;
person.firstName="chris";
person.lastName="Westbrook";
person.seq=-1;
var data=new object;
data.p=person;
JSON.stringify(data); 
```

这将创建一个名为的对象，该对象`p`将包装一个人对象。然后可以将其链接到`p`Web 服务中的参数。类型列表的`person`制作方式类似，接受使用人员数组而不是单个对象。我希望这可以帮助别人。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-31T16:27:13.003

您能否显示您尝试反序列化的 JSON 字符串以及您使用[Deserialize](http://www.asp.net/Ajax/documentation/live/mref/M_System_Web_Script_Serialization_JavaScriptSerializer_Deserialize%60%601_1_72eac341.aspx)方法的方式？以下工作正常：

```
using System;
using System.Collections.Generic;
using System.Web.Script.Serialization;

namespace Test
{
    class Program
    {
        class Person 
        {
            public int SequenceNumber { get; set; }
            public string FirstName { get; set; }
            public string LastName { get; set; }
        }

        public static void Main() 
        {
            string json = "[{\"SequenceNumber\":1,\"FirstName\":\"FN1\",\"LastName\":\"LN1\"},{\"SequenceNumber\":2,\"FirstName\":\"FN2\",\"LastName\":\"LN2\"}]";
            IList<Person> persons = new JavaScriptSerializer()
                .Deserialize<IList<Person>>(json);
            Console.WriteLine(persons.Count);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-13T08:12:17.447

或者更简单，当您使用 $.ajax(...) 时

```
data:"{\"key\":"+JSON.stringify(json_array)+"}", 
```

然后在代码的另一边，让你的函数使用参数“对象键”

```
[WebMethod]
public static return_type myfunction(object key){...} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-06T22:13:35.180

服务器端

```
[WebMethod]
public void updatePeople(object json) 
```

客户端

```
var person = "[{"seq":1,"firstName":"Chris","lastName":"Westbrook"}
,{"seq":2,"firstName":"sayyl","lastName":"westbrook"}]";

var str = "{'json':'" + JSON.stringify(person) + "'}"; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-24T10:44:08.630

我认为问题是你必须反序列化什么类型。您正在尝试反序列化类型

> 列表

但你应该尝试反序列化

> 列表

由于无法实例化接口，这可能是根本问题。**********