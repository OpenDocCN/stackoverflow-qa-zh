# StackOverflow 问答 11017000-11017999

# wcf - Ria 服务：简单的 >>object<< 属性/字段未出现在客户端

> ID：11017002
> 
> 赞同：0
> 
> 时间：2012-06-13T14:25:57.907
> 
> 标签：wcf, silverlight, poco, ria

我正在使用 Ria 服务，我的 POCO 对象具有**简单的对象属性/字段**。但它们并没有出现在客户端。请帮忙，我的 POCO：

```
[EnableClientAccess]
[DataContract]
public class DataRow
{
   [DataMember]
   [Key]
   public int RowId { get; set; }
   [DataMember] public >>>object[]<<< FieldValue { get; set; };
   public DataRow()
   {

   }
} 
```

我尝试了使用 getter/setter 的字段而不是属性`>>>object<<< FieldValue { get; set; } (NOT ARRAY), IEnumerable<object>`...相同的结果。 **使用 WCF 我可以做到**。例如。我的 wcf 服务中有这份合同（对于 sharepoint）

```
[DataContract]
public class SPFieldValueStub
{
    //[DataMember]
    //public virtual int ListItemIndex { get; set; }
    [DataMember]
    public virtual object Raw { get; set; }
    [DataMember]
    public virtual object Formatted { get; set; }
    [DataMember]
    public virtual IEnumerable<SPFieldValueStub> References { get; set; }
    [DataMember]
    public virtual IEnumerable<object> Properties { get; set; }
    [DataMember]
    public virtual SPFieldStub Field { get; set; }
}
[DataContract]
public class SPListItemStub
{
    [DataMember]
    public virtual IEnumerable<SPFieldValueStub> Values { get; set; }

} 
```

在服务实现中，我可以从共享点列表中读取数据填充我的 POCO 并返回给客户端。之后，我可以通过生成的代理方法在客户端检索 POCO，并将对象解包（拆箱）为真实类型（适用于我的 String/Uri/DateTime）。我需要通过 RIA 这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:27:15.070

因为[`Object`](http://msdn.microsoft.com/en-us/library/system.object.aspx)不包含任何字段。

# hadoop - 如何确保 RegexSerDe 可用于我的 Hadoop 节点？

> ID：11017012
> 
> 赞同：1
> 
> 时间：2012-06-13T14:26:33.540
> 
> 标签：hadoop, hive, classnotfoundexception, elastic-map-reduce

我正在尝试解决使用 Hive 分析 Web 日志的问题，并且我已经看到了很多示例，但我似乎找不到任何遇到此特定问题的人。

这就是我所在的位置：我已经设置了一个 AWS ElasticMapReduce 集群，我可以登录，然后我启动了 Hive。我确保`add jar hive-contrib-0.8.1.jar`，它说它已加载。我创建了一个名为 的表`event_log_raw`，其中包含一些字符串列和一个正则表达式。 `load data inpath '/user/hadoop/tmp overwrite into table event_log_raw`，我要去参加比赛了。`select * from event_log_raw`工作（我认为在本地，因为我没有得到地图 % 和减少 % 输出），我从我的样本数据中得到了 10 条记录，正确解析，一切都很好。 `select count(*) from event_log_raw`也可以，这次创建了一个 mapreduce 作业。

我想将我的`request_url`字段转换为地图，所以我运行：

```
select elr.view_time as event_time, elr.ip as ip, 
str_to_map(split(elr.request_url," ")[1],"&","=") as params 
from event_log_raw elr 
```

Mapreduce 启动，等待，等待......失败。

```
FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask
MapReduce Jobs Launched: 
Job 0: Map: 1   HDFS Read: 0 HDFS Write: 0 FAIL 
```

我从任务跟踪器中检查系统日志并查看，除其他外，

```
java.lang.RuntimeException: Error in configuring object
at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:93)
at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:64)
at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:117)
<snip>
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.lang.ClassNotFoundException: org.apache.hadoop.hive.contrib.serde2.RegexSerDe
at org.apache.hadoop.hive.ql.exec.MapOperator.setChildren(MapOperator.java:406)
at org.apache.hadoop.hive.ql.exec.ExecMapper.configure(ExecMapper.java:90)
... 22 more
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.hive.contrib.serde2.RegexSerDe 
```

我已经用谷歌搜索过这个，但我想我的 google-fu 达不到标准。我发现的一切都表明人们遇到了这个问题并通过运行`add jar`命令来解决它。我试过了，我试过把它添加到我的`hive-site.xml`，我试过把它放在本地，试着把罐子放在一个 s3 桶里。尝试添加引导步骤以在引导阶段添加它（灾难）。

谁能帮我弄清楚a.）为什么我的任务节点找不到RegexSerDe，以及b.）如何使它工作？也欢迎链接，如果它们可能揭示的不仅仅是运行`add jar`。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:09:16.633

解决这个问题的最简单方法是将所有这些 jars 添加到所有任务跟踪器上的 hadoop 的 lib 目录中，我们用一堆东西来做到这一点：

```
scp library.jar task-tracker-1:~/<HADOOP_HOME>/lib/ 
```

或在引导脚本中使用 EMR：

```
s3cmd get s3://path/to/lib.jar /home/hadoop/lib/ 
```

当我们使用 EMR 时，我们只有一个充满 jar 的 s3 目录，我们将同步到 hadoop lib 目录：

```
s3cmd sync s3://static/jars/ /home/hadoop/jars
cp jars/*.jar lib/ 
```

如果你使用 oozie，你也可以将 jars 放在 oozie.share.lib 目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-27T06:36:55.313

我将 serde jar 文件复制到

```
hadoop/lib 
```

目录并且还重新启动了hadoop（甚至服务器）以真正工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-12-10T12:54:01.210

我想您需要的只是将此 jar 文件添加到`HIVE_AUX_JARS_PATH`变量中，例如

如果你`hive-contrib-0.8.1.jar`在`/usr/hive/lib` 然后运行

`export HIVE_AUX_JARS_PATH=/usr/hive/lib/hive-contrib-0.8.1.jar:$HIVE_AUX_JARS_PATH`

或者如果`HIVE_AUX_JARS_PATH`不存在，就运行

`export HIVE_AUX_JARS_PATH=/usr/hive/lib/hive-contrib-0.8.1.jar`.

之后开始 hive 会话，您将看到一切正常。

如果您需要此变量，请将其永久保存到`.profile`文件中或`.bash_profile`基于您的操作系统

# wpf - 在 Window.Resources 中的 DataTemplate 中绑定到拥有窗口的视图模型中的属性

> ID：11017014
> 
> 赞同：3
> 
> 时间：2012-06-13T14:26:34.967
> 
> 标签：wpf, datatemplate

我的 Window 的 Resources 部分中有一个 DataTemplate，它创建一个带有 ContextMenu 的 TextBlock。我希望能够设置 ContextMenu 中的 MenuItem 在我的 Window 视图模型中是否可见。我尝试通过设置访问窗口的DataContext `ElementName`，也尝试设置`RelativeSource`，但是这两种方法都导致绑定错误。我不确定我还能尝试什么。

我创建了一个小例子来展示我正在尝试做的事情：

XAML：

```
<Window x:Class="DataTemplateTest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">

<Window.Resources>
    <ResourceDictionary>
        <DataTemplate x:Key="TestDataTemplate">
            <TextBlock Text="{Binding}">
                <TextBlock.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Test" Visibility="{Binding Path=DataContext.MenuItemVisible, ElementName=Root}"/>
                    </ContextMenu>
                </TextBlock.ContextMenu>
            </TextBlock>
        </DataTemplate>
    </ResourceDictionary>
</Window.Resources>

<ScrollViewer x:Name="Root">
    <ItemsControl ItemsSource="{Binding Path=Items}" ItemTemplate="{StaticResource TestDataTemplate}" />
</ScrollViewer> 
```

后面的代码：

```
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows;

namespace DataTemplateTest
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        protected readonly MainWindowViewModel vm;

        public MainWindow()
        {
            InitializeComponent();
            vm = new MainWindowViewModel();
            DataContext = vm;
        }
    }

    public class MainWindowViewModel : INotifyPropertyChanged
    {
        private Visibility menuItemVisible = Visibility.Hidden;
        public Visibility MenuItemVisible { get { return menuItemVisible; } set { menuItemVisible = value; NotifyPropertyChanged("MenuItemVisible"); } }

        public List<string> Items { get; set; }

        public MainWindowViewModel()
        {
            Items = new List<string>() { "Alpha", "Beta", "Gamma" };
        }

        public event PropertyChangedEventHandler PropertyChanged;

        private void NotifyPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

我得到的错误是

> System.Windows.Data 错误：4：找不到与引用“ElementName = Root”绑定的源。BindingExpression:Path=DataContext.MenuItemVisible; 数据项=空；目标元素是'MenuItem'（名称=''）；目标属性是“可见性”（类型“可见性”）

当我在绑定中设置 RelativeSource 而不是 ElementName 时：

```
RelativeSource={RelativeSource Mode=FindAncestor, 
                AncestorType={x:Type ScrollViewer}} 
```

我收到以下错误：

> System.Windows.Data 错误：4：找不到与引用'RelativeSource FindAncestor，AncestorType ='System.Windows.Controls.ScrollViewer'，AncestorLevel ='1''的绑定源。BindingExpression:Path=DataContext.MenuItemVisible; 数据项=空；目标元素是'MenuItem'（名称=''）；目标属性是“可见性”（类型“可见性”）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:54:44.163

我在[这里](https://stackoverflow.com/a/7604685/1042182)找到了答案：

所以我需要做的就是访问窗口的 DataContext ：

```
Source={x:Reference Name=Root} 
```

[在此](http://blogs.msdn.com/b/nickkramer/archive/2006/08/18/705116.aspx)可以找到 ElementName 在这种情况下不起作用的解释。具体来说：

> 可能我们没有继承上下文链接的最简单示例是跨 > 随机属性元素：
> 
> ```
> <Button>
>   <Button.ContextMenu>
>     <ContextMenu/>
>   </Button.ContextMenu>
> </Button> 
> ```
> 
> ContextMenu 既不是 Button 的视觉或逻辑子级，也不是上面列出的继承上下文案例之一（ContextMenu 不是 Freezable）。

# jquery - 我如何判断窗口是否在 jQuery 集中？

> ID：11017019
> 
> 赞同：3
> 
> 时间：2012-06-13T14:26:49.140
> 
> 标签：jquery, window, filtering

我希望我的 jQuery 插件在`$(window)`选择时表现不同。`window`如果在集合中，我该如何检查？到目前为止我的尝试：

```
>>> $(window) == $(window)
false
>>> $(window).is(window)
false
>>> $(window).filter(window).length
0 
```

（顺便说一下，这些都可以正常工作`document`。）当然，我总是可以检查`this[0]`，但是`$('a').add(window)`这种方法不能满足某些极端情况。

我也可以通过函数过滤：

```
>>> $(window).filter(function() { return this === window; }).length
1 
```

但我希望有更多的“jQuery-ish”或通用方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:39:19.947

您可以使用[index()](http://api.jquery.com/index/)并将其传递给`window`对象。`-1`如果`window`对象不是集合的一部分，或者它在集合中的从零开始的索引，它将返回：

```
>>> $(window).index(window) >= 0
true

>>> $("a").add(window).index(window) >= 0
true

>>> $("a").index(window) >= 0
false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:41:45.830

AFAIK，只有`$(window).parent()`&`$(document).parent()`返回一个空数组。也许你可以使用类似的东西

```
var test = window
  //undefined
$(test).parent().length == 0 && !$(test).is(document)
  //true
test = document
  //#document
$(test).parent().length == 0 && !$(test).is(document)
  //false 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:44:40.197

`.is($(window))`作品：

```
 $(window).is($(window))​    //true
$('a').add(window).is($(window))   //true 
```

# zend-framework - PHPUnit 和 Zend_Session - 测试 setExpirationSeconds

> ID：11017021
> 
> 赞同：0
> 
> 时间：2012-06-13T14:26:53.297
> 
> 标签：zend-framework, phpunit, zend-session

我有一个 preDispatch 插件，它将 setExpirationSeconds 设置为我的 application.ini 中的设置。

我正在尝试为此编写一个 PHPUnit 测试。有没有办法让我将过期秒数与我的 application.ini 设置进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T16:31:13.167

您可以访问 Zend Session 使用的 Session 变量，以检查是否将正确的时间传递给对象。

```
$_SESSION['__ZF']['Default']['ENT']; 
```

# c# - 项目符号后 Excel CSV 导出中出现的奇怪符号

> ID：11017023
> 
> 赞同：0
> 
> 时间：2012-06-13T14:26:59.560
> 
> 标签：c#, asp.net, excel, excel-2010

我已经编写了一种将 CSV 格式的数据导出到 Excel 的方法。大多数人的 Excel 文档看起来不错，但是某些 Excel 文档在其中一列中的项目符号之后的方框符号中有一个问号。数据与人们正在查看的数据完全相同。这是我可以在代码中修复的问题，还是需要在 Excel 中更改设置以在项目符号后不显示这些奇怪的符号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:32:32.600

这通常意味着存在用户系统上的默认字体无法解释的符号。由于 CSV 是原始文本，您的 2 个选择是：

1.  找到导致它的符号并将其替换为更友好（通用）的符号
2.  鼓励用户使用具有更大字符集（Arial/Verdana/等）的特定字体。

# javascript - 用于桌面的类似 jsPerf 的应用程序

> ID：11017028
> 
> 赞同：3
> 
> 时间：2012-06-13T14:27:06.387
> 
> 标签：javascript, performance

是否有类似于 jsPerf 的离线桌面应用程序？

我的工作性质不允许我将数据上传到像 jsPerf 这样的网站。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:33:53.630

“非常相似”是相当模糊的。您需要类似的用户界面，还是只需要功能？

但在功能上，jsperf 所基于的[Benchmark.js可以通过 node 运行。](http://benchmarkjs.com/)我不知道他们为使 jsperf 脱离 Benchmark 所做的所有工作，但这可能是一个值得关注的地方。

事实证明，您可以[在本地运行 jsperf](https://github.com/mathiasbynens/jsperf.com/blob/master/README.md)。

# webkit - Contenteditable div，复制/粘贴 html 给出空格 SAF/Chrome

> ID：11017030
> 
> 赞同：2
> 
> 时间：2012-06-13T14:27:10.683
> 
> 标签：webkit, contenteditable

我得到了一个内容可编辑的 div，其中包含一些文本，例如。“test abc”，当我通过双击选择“test”时，然后复制它。之后，我在“b”和“c”之间移动光标，然后粘贴我的复制值。

在 Safari/Chrome 中，我的结果是：
“test ab test c”

它应该是这样的：
“test abtestc”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T13:48:33.003

似乎 webkit 更喜欢将您的可编辑内容包含**在**标签中。我尝试使用 div 和 ap 并开始按预期运行

[见 jsfiddle](http://jsfiddle.net/bvFNL/1/)

# sql - 如何在 Access VBA 中使用 SQL SELECT 语句

> ID：11017036
> 
> 赞同：16
> 
> 时间：2012-06-13T14:27:19.750
> 
> 标签：sql, ms-access, vba

我有一个组合框，我想将其值与 SQL WHERE 子句一起使用。如何根据组合框值在 VBA 中**运行SELECT 语句？**

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-13T14:41:30.010

如果您希望使用绑定的列值，您可以简单地参考组合：

```
sSQL = "SELECT * FROM MyTable WHERE ID = " & Me.MyCombo 
```

也可以参考列属性：

```
sSQL = "SELECT * FROM MyTable WHERE AText = '" & Me.MyCombo.Column(1) & "'"

Dim rs As DAO.Recordset     
Set rs = CurrentDB.OpenRecordset(sSQL)

strText = rs!AText
strText = rs.Fields(1) 
```

在文本框中：

```
= DlookUp("AText","MyTable","ID=" & MyCombo) 
```

*已编辑

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-16T10:31:08.910

Access 2007 可能会丢失 CurrentDb：请参阅[http://support.microsoft.com/kb/167173](http://support.microsoft.com/kb/167173)，因此如果示例中出现***“对象无效或不再设置”***，请使用：

```
Dim db as Database
Dim rs As DAO.Recordset
Set db = CurrentDB
Set rs = db.OpenRecordset("SELECT * FROM myTable") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-07T13:36:54.377

这是在 VBA 中使用 SQL`SELECT`语句的另一种方法：

```
 sSQL = "SELECT Variable FROM GroupTable WHERE VariableCode = '" & Me.comboBox & "'" 
 Set rs = CurrentDb.OpenRecordset(sSQL)
 On Error GoTo resultsetError 
 dbValue = rs!Variable
 MsgBox dbValue, vbOKOnly, "RS VALUE"
resultsetError:
 MsgBox "Error Retrieving value from database",VbOkOnly,"Database Error" 
```

# .net - EntLibContrib 和 OdpNet

> ID：11017040
> 
> 赞同：0
> 
> 时间：2012-06-13T14:27:26.900
> 
> 标签：.net, enterprise-library, odp.net, sys-refcursor

我正在尝试将一个从 oracle 过程返回的 ref 游标返回到我的 .Net 应用程序，但我不断收到有关错误数量参数的错误。

oracle 过程具有以下参数：

```
PROCEDURE sp_user_list(pv_username     IN VARCHAR2
                        ,pn_result      OUT NUMBER
                        ,pv_error       OUT VARCHAR2
                        ,pref_user_list OUT SYS_REFCURSOR); 
```

我的数据访问代码是：

```
public int GetUserID(string sUserName)
        {
            int iUserID = 0;

            Database db = DatabaseFactory.CreateDatabase();

            string sql = "pk_quality.sp_user_list";
            DbCommand cmd = db.GetStoredProcCommand(sql);

            db.AddInParameter(cmd, "pv_username", DbType.String, sUserName);
            db.AddOutParameter(cmd, "pn_result", DbType.Int32, 2);
            db.AddOutParameter(cmd, "pv_error", DbType.String, 500);

            using (IDataReader dataReader = db.ExecuteReader(cmd))
            {
                while (dataReader.Read())
                {
                    iUserID = int.Parse(dataReader["user_id"].ToString());
                }
            }

            return iUserID;
        } 
```

似乎没有任何 ref cursor dbtype 允许我添加一个 out 参数来处理 ref 游标。难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T18:01:04.747

您还必须将 refcursor 输出参数添加到命令对象。

```
cmd.Parameters.Add(
     new OracleParameter("pref_user_list", 
                         OracleDbType.RefCursor, 
                         ParameterDirection.Output)); 
```

这适用于 ODP.NET 数据提供程序。DbType 枚举没有对应的 refcursor 类型。但是，将 Oracle 引用添加到数据访问类可能看起来违反了 DAAB 原则。

# asp.net - Asp 将查询放入数组并通过它而不刷新页面

> ID：11017041
> 
> 赞同：1
> 
> 时间：2012-06-13T14:27:28.040
> 
> 标签：asp.net, sql, database, vb.net, informix

我将如何在 asp 中运行查询并将其存储在数组中。然后用数组遍历每条记录，而不必每次都刷新页面。

例如

```
Sub loaddata()
    Dim conn As New IfxConnection(connectionstring)

    Dim results() As String
    Dim i As Integer = 0

    conn.ConnectionString = connectionstring
    Try
        conn.Open()
        MsgBox("Made connection!")

    Catch ex As Exception
        MsgBox(ex.Message)
    End Try
    Dim cmd As New IfxCommand("Select name from table", conn)
    Dim reader As IfxDataReader = cmd.ExecuteReader(CommandBehavior.CloseConnection)
    While reader.Read()
        results(i) = reader("name")
        i += 1

    End While
    reader.Close()
    conn.Close()
End Sub 
```

结果存储在 results(i) 中

假设我有一个按钮，每次我希望它转到结果数组中的下一项时都会显示下一步。我不希望页面刷新。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:39:56.780

您需要考虑如何设置页面。有很多方法可以做到这一点。

如果您在页面加载时获得所有记录，则可以将它们分配给各自的控件。为了让它出现，如果它们在许多页面上，您可以使用 MultiView 控件。

**标记**

```
<asp:MultiView ID="MultiView1" runat="server" ActiveViewIndex="0">
   <asp:View ID="View1" runat="server"> 
      <asp:Label ID="lblRecordOne" runat="server" />
   </asp:View>
   <asp:View ID="View2" runat="server"> 
      <asp:Label ID="lblRecordTwo" runat="server" />
   </asp:View>         
</asp:MultiView>
<asp:Button ID="btNext" runat="server">Next</asp:Button> 
```

**代码隐藏**

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
     'Call your method that loads the data to results
     Dim results() As String = loaddata()
     'Set the data
     lblRecordOne.Text = results(0)
     lblRecordTwo.Text = results(1)
End Sub

Protected Sub btNext_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btNext.Click

 'There is a much better way to go about this, but for this 
 'demos sake here is the basic idea
 MultiView1.SetActiveView(View2)

End Sub 
```

您要记住的是，每个 View 控件在 MultiView 内都有一个索引。因此，您需要一种方法来跟踪活动视图是什么。当用户单击下一个按钮时，您将视图前进一个。

**就 MVC 应用程序而言**

**控制器**

```
public class HomeController 
{
   // /Home/GetRecord/{id}
   public ViewResult GetRecord(int? id)
   {
        int modelID;
        if (id == null) { modelID = 0; }
        ViewBag.CurrentID = modelID;
        // This will send the value to the view
        // I would refactor loaddata to only return one record at a time
        // based on an id or an index
        return View(loaddata(modelID));
   }
} 
```

**看法**

```
<label>@Model.Result</label>
@Html.ActionLink("GetRecord", "Home", new { id = ViewBag.CurrentID + 1 }) 
```

每次您单击 ActionLink 时，它都会通过一个记录集前进。

如果第一条记录是Hello，第二条记录是World：

/Home/GetRecord/0 - 你好

/Home/GetRecord/1 - 世界

抱歉，我将其切换到 C#，我更喜欢徒手编写 C# 而不是 VB。VB中的代码非常相似。如果你需要一个转换器去[http://converter.telerik.com/](http://converter.telerik.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:30:04.560

您应该使用 RegisterClientScript 在控件或变量中呈现结果，并通过 javascript 控制导航

# java - 保存和更新的类的包名

> ID：11017046
> 
> 赞同：0
> 
> 时间：2012-06-13T14:27:48.243
> 
> 标签：java

我有各种类执行 GUI 元素的保存和更新操作，它保存已添加/删除的元素及其新位置。

什么是合适的包名？

我考虑过 com.myappname.contentsave 但它“感觉”不正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:29:11.790

怎么样

```
com.myappname.persist 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:31:18.443

一般来说，类名和包名不应该是口头的。com.myapp.gui.manager 可能没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:32:30.090

你总是可以命名一个包

```
com.something.guiupdate 
```

# asp.net - 在缓存中保存控件（ASP 面板和子项）状态

> ID：11017047
> 
> 赞同：1
> 
> 时间：2012-06-13T14:27:51.400
> 
> 标签：asp.net, caching, viewstate

我正在寻找一种简单且可扩展的方式来为用户缓存过滤器设置。我最初的想法是覆盖包含我的过滤器控件的面板的保存/加载 ViewState 进程并在那里保存/加载控件状态。我还没有找到一种方法来做到这一点。

这是否可能在不改变整个控件、页面或站点的状态过程的情况下实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:30:23.877

这似乎是一个有趣的案例，所以我尝试了一个解决方案来完成这个功能。我想出了下面的代码，这应该是一个好的开始。它仅适用于控件的“DefaultProperty”，但通过添加对特定控件类型的检查，您可以缓存和设置您喜欢的任何属性。

此外，它仅在第一次加载页面时使用缓存值设置控件。不确定您是否希望控件的值在回发之间更改以反映另一个用户/会话是否进行了更改。

```
using System.Collections.Generic;
using System.ComponentModel;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public class CachedStatePanel : Panel
{
    private static Dictionary<string, object> CachedFilters
    {
        get
        {
            if (HttpContext.Current.Cache["CachedFilters"] == null)
            {
                HttpContext.Current.Cache["CachedFilters"] = new Dictionary<string, object>();
            }
            return (Dictionary<string, object>)HttpContext.Current.Cache["CachedFilters"];
        }
    }

    protected override void CreateChildControls()
    {
        base.CreateChildControls();

        if (!Page.IsPostBack)
        {
            foreach (Control child in Controls)
            {
                SetFromCacheRecursive(child);
            }
        }
    }

    protected override object SaveViewState()
    {
        var state = base.SaveViewState();

        if (Page.IsPostBack)
        {
            foreach (Control child in Controls)
            {
                LoadCachedStateRecursive(child);
            }
        }

        return state;
    }

    private static void LoadCachedStateRecursive(Control current)
    {
        if ((current == null) || (current.ID == null)) return;

        var attribs = current.GetType().GetCustomAttributes(typeof(DefaultPropertyAttribute), true);
        if ((attribs != null) && (attribs.Length > 0))
        {
            var propName = ((DefaultPropertyAttribute)attribs[0]).Name;
            var prop = current.GetType().GetProperty(propName);

            if (prop != null)
            {
                CachedFilters[current.ID] = prop.GetValue(current, null);
            }
        }

        if (current.HasControls())
        {
            foreach (Control child in current.Controls)
            {
                LoadCachedStateRecursive(child);
            }
        }
    }

    private static void SetFromCacheRecursive(Control current)
    {
        if ((current == null) || (current.ID == null) || (!CachedFilters.ContainsKey(current.ID))) return;

        var attribs = current.GetType().GetCustomAttributes(typeof(DefaultPropertyAttribute), true);
        if ((attribs != null) && (attribs.Length > 0))
        {
            var propName = ((DefaultPropertyAttribute)attribs[0]).Name;
            var prop = current.GetType().GetProperty(propName);

            if (prop != null)
            {
                prop.SetValue(current, CachedFilters[current.ID], null);
            }
        }

        if (current.HasControls())
        {
            foreach (Control child in current.Controls)
            {
                SetFromCacheRecursive(child);
            }
        }
    }
} 
```

# php - PHP数组成一个字符串

> ID：11017050
> 
> 赞同：2
> 
> 时间：2012-06-13T14:27:52.283
> 
> 标签：php, mysql, sql

我有一个由 mysql_query 填充的数组。我想将这个数组中的值放入一个连续的字符串中，例如：

```
$array = array(1, 2, 3, 4, 5);

INSERT INTO 'new_slovmas'.'$tabulka'('$array[0]', '$array[1]', '$array[3]') 
       VALUES ('$r_1', '$r_2', '$r_3')"; 
```

一张表中的意义超过 50 列我不想手动填充它，而是通过 WHILE 或 FOR。所以我正在考虑将值放入一个字符串中，如下所示：

```
$array = array("'1',", "'2',", "'3',", "'4',", "'5',"); 
```

所以现在我有了这个：

```
echo $array[2]; => '3', 
```

通过循环，我不会在一个变量中实现多个条目。

```
$str = $array[0], $array[1] ... $array[xy];

INSERT INTO 'new_slovmas'.'$tabulka'('$str') 
       VALUES ('$r_1', '$r_2', '$r_3')"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:29:06.500

采用[`implode()`](http://us.php.net/manual/en/function.implode.php)

```
$string = implode(',', array(1, 2, 3, 4, 5));  // $string = 1,2,3,4,5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T14:29:28.787

PHP 的 implode 函数会将数组解压成字符串，以便在 Javascript 中使用。试试这个：

```
$str = implode(',',$array); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:30:09.763

采用：

```
join(",", $array); 
```

此外，请务必在将值插入数据库之前对其进行转义。如果您的某个值包含单引号 (') 或更糟糕的内容（如有效 SQL），您可以这样做，这会使您的查询崩溃。您可以为此使用 mysql_real_escape_string(...) 或 mysqli_real_escape_string(...)

# java - 奇怪的 JAVA 布尔求值问题

> ID：11017052
> 
> 赞同：0
> 
> 时间：2012-06-13T14:27:56.887
> 
> 标签：java

嗨，我有以下代码：

```
 boolean result = someexpression();

            if(!result)
            {
            System.out.println("False..."); 
            }
            if (result); 
            {
                System.out.println("True");
            } 
```

它同时打印（假和真）我也尝试过使用类似的东西

```
 if(result==true) 
```

但这似乎不起作用。无论变量的值是什么，它都只是进入条件。？？我正在使用eclipse，这只发生在特定部分。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T14:28:34.897

```
if (result); 
```

删除`;`此行末尾的 。

对于`;`，它的意思是“如果`result`是`true`，那么什么都不做”。包含下一条语句的块不是 the 的一部分，`if`并且将始终被执行。它与此完全相同：

```
if (result)   // if result is true
    ;         // then do nothing

System.out.println("True");  // is always executed 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-13T14:28:39.770

在 if 语句的末尾有一个流氓分号。

```
if (result); 
```

这使您的代码评估为

```
if (result) {

}
{
    System.out.println("True");
} 
```

其中第二对`{}`表示始终执行的代码块，因为它不再是 if 控制块的一部分。所以去掉那个分号（我认为这不是你要放在那里的）！

# java - Guava、Files.readLines() 和空白

> ID：11017055
> 
> 赞同：4
> 
> 时间：2012-06-13T14:28:01.887
> 
> 标签：java, string, file-io, guava

我有以下代码使用 Guava 的 Files.readLines() 方法：

```
List<String> strings = Lists.newArrayList();
final File file = new File(filePath);
if (file.isFile()) {
  try {
    strings= Files.readLines(file, Charsets.UTF_8);
  }
  catch (IOException ioe) {}
}
else {
  // File does not exist
} 
```

一旦我有了我的字符串列表，我想测试一下我正在查看的当前字符串是否在文件中。

```
String myString = "foo";
if (strings.contains(myString)) {
  // Do something
} 
```

但是，我想让代码容忍原始文件包含前导或尾随空格（即`" foo "`）。

实现这一目标的最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T14:52:46.973

我能想到的 tskuzzy 方法的唯一替代方法如下：

```
List<String> trimmedLines = Files.readLines(file, Charsets.UTF_8,
  new LineProcessor<List<String>>() {
    List<String> result = Lists.newArrayList();

    public boolean processLine(String line) {
      result.add(line.trim());
    }
    public List<String> getResult() {return result;}
  }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T14:54:00.383

您不必遍历整个文件（如果您只想知道行是否在文件中），请使用[`Files.readLines(File file, Charset charset, LineProcessor<T> callback)`](http://docs.guava-libraries.googlecode.com/git-history/v12.0/javadoc/com/google/common/io/Files.html#readLines%28java.io.File,%20java.nio.charset.Charset,%20com.google.common.io.LineProcessor%29)

```
public final class Test {

  /**
   * @param args
   * @throws IOException
   */
  public static void main(final String[] args) throws IOException {
    test1("test");
  }

  static void test1(final String lineToTest) throws IOException {

    final Boolean contains = Files.readLines(new File("test.txt"), Charsets.UTF_8, new LineProcessor<Boolean>() {
      Boolean containsGivenLine = false;

      @Override
      public Boolean getResult() {
        return containsGivenLine;
      }

      @Override
      public boolean processLine(final String line) throws IOException {
        if (line.trim().equals(lineToTest)) {
          containsGivenLine = true;
          return false;
        } else {
          return true;
        }
      }
    });

    System.out.println("contains '" + lineToTest + "'? " + contains);
  } 
```

给定文件：

```
 test  
me   
   if  
 you want! 
```

它输出真。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T14:32:01.920

使用`trim()`删除前导和尾随空格的方法。

```
boolean contains = false;

for(String s : strings) {
    if(s.trim().equals(myString)) {
        contains = true;
        break;
    }
}

if(contains) {
    // do something
} 
```

如果您还想要不区分大小写，那么您也可以使用`toLowerCase()`.

# android - 在 Android 中实现类似控件布局的 Play-cards（附上原型图）

> ID：11017056
> 
> 赞同：1
> 
> 时间：2012-06-13T14:28:08.110
> 
> 标签：android, android-layout

我正在开发基于纸牌的棋盘游戏，以下是我应该在游戏中实现的原型。

![原型](../Images/173f0ef295fceff3bd143faf754f233d.png)

如您所见，堆叠了 13 张卡片，现在**每张卡片都是可点击的，并且会响应点击事件**。这个想法是，将有 13 个空容器以上述方式排列，当发牌时，这些容器将显示玩家收到的牌。所以它必须是动态的。限制是**我没有使用任何游戏引擎**，一切都基于标准的 Android 小部件。

所以问题是，我可以完全按照原型图像实现上述布局吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:01:46.700

> 所以问题是，我可以完全按照原型图像实现上述布局吗？

是的。

如何做到这一点是你自己想办法。但这里有一些提示：

*   最好以编程方式而不是在 XML 文件中创建视图层次结构，以最大程度地兼容不同的屏幕尺寸
*   看看[`FrameLayout`](http://developer.android.com/reference/android/widget/FrameLayout.html)和[`RelativeLayout`](http://developer.android.com/reference/android/widget/RelativeLayout.html)
*   边距可以取负值

# php - 我如何使用给定用户名的 cURL 循环浏览 twitter api 结果

> ID：11017069
> 
> 赞同：0
> 
> 时间：2012-06-13T14:28:33.837
> 
> 标签：php, curl, twitter, simplexml

我试图通过`SimpleXMLElement`对象的结果循环遍历给定用户的 Twitter 时间线。出于某种原因，下面的代码只显示了一个结果。

1.  我在这里做错了什么？

2.  如何在 xml/rest 结果的“描述”标签中搜索文本字符串。前任。我试图找到所有包含字符串“我喜欢编码”的推文。

```
<?php
// create a new cURL resource
$ch = curl_init();

curl_setopt_array(
    $ch,
    array(
        CURLOPT_URL => "http://api.twitter.com/1/statuses/user_timeline.rss?  screen_name=twitterusername",
        CURLOPT_RETURNTRANSFER => true
    )
); 

$response = curl_exec($ch);
curl_close($ch);

$xml = new SimpleXMLElement($response);

foreach($xml as $x){
echo '<h2>' . $x->title . '</h2>';
echo '<a href="'.$x->link .'">Link</a>';
echo '<br><em>' .$x->description .'<em>';
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:30:30.873

我认为这里有两个错误。

首先，您要请求 RSS，您需要请求 XML

```
https://api.twitter.com/1/statuses/user_timeline.xml?screen_name=edent 
```

其次，您想将 XML 作为字符串加载，如下所示

```
$tweets = simplexml_load_string($response); 
```

然后像这样遍历它们

```
foreach ($tweets as $status) {
    echo $status->text;
    //etc
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:40:25.563

我不熟悉 SimpleXMLElement，但您确定它会将数组值返回到 $xml 吗？据我所见，阅读文档似乎只返回一个元素。

# sql - SQL比较2列数据并显示匹配

> ID：11017073
> 
> 赞同：2
> 
> 时间：2012-06-13T14:28:48.930
> 
> 标签：sql, sql-server-2008, compare

我无法识别数据库中的条目。

我需要它来告诉我何时`CallRef`和`PersonRef`相同并且在表格中出现不止一次。我不想查看它们的数量，我需要查看它们是哪些调用引用。

下面突出显示的示例：

```
CallRef PersonRef   Leader
222359  5894    0
222360  3212    0
222361  8743    0
222362  5894    1
222362  5894    0
222364  3983    0
222365  9863    0
*222365 5894    1*
*222365 5894    1*
222368  5894    0 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:31:58.390

以下 SQL 查询应使用 GROUP BY 和 HAVING COUNT 结构选择您想要的条目：

```
SELECT CallRef FROM table
GROUP BY CallRef, PersonRef
HAVING COUNT(*) > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:38:07.780

与其他答案 (+1) 类似，相同的构造和返回但在输出中包含 PersonRef，因为您可以有重复的 callrefs，但不能有 CallRef/PersonRef 组合。您希望能够区分加星标（222365 9863 和加星标的骗子 222365 5894）之上的记录，如果需要，这将做到这一点。

```
SELECT  CallRef,PersonRef 
FROM UrTable
GROUP BY CallRef,PersonRef 
HAVING COUNT(*) > 1 
```

# jquery - 使用幻灯片效果重定向到另一个页面

> ID：11017074
> 
> 赞同：0
> 
> 时间：2012-06-13T14:28:51.260
> 
> 标签：jquery, html, jquery-mobile

我在 jquery-mobile 中有一个功能，我想在延迟后单击图像重定向到另一个页面。到目前为止，我已经到达这里-

```
setTimeout(function(){
    window.location.href = "myPage.html";
},1000); 
```

它工作正常，但我希望页面应该使用 jQuery 移动的幻灯片效果重定向。有人知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:00:41.350

我得到了答案伙计们..!!

我将 window.location.href = "myPage.html" 替换为

```
$.mobile.changePage("myPage.html",{transition:"slide"}); 
```

这是将页面重定向到具有幻灯片效果的目标页面！[在这里](http://jquerymobile.com/test/docs/api/methods.html)查看

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:33:52.967

无法使用窗口位置重新加载重定向页面。当您尝试更改窗口位置重新加载时，它将刷新页面。

所以你可以尝试类似的东西

*   在`iframe`

*   或者，使用 ajax 方法加载内容

*   或者，使用您之前加载的内容制作滑动效果

为了通过 ajax 加载，可以使用任何一种方法，例如**[`.load()`](http://api.jquery.com/load)**或**[`.ajax()`](http://api.jquery.com/category/ajax)**

例如：

您可以使用`.load()`如下：

```
$('#target_container').load('YOUR_URL', function() {
   // do something
}); 
```

或者可以使用`.ajax()`如下：

```
$.ajax({
  url: 'YOUR_URL'.
  dataType: 'html',
  success: function(response) {
    $('#target_container').html(response);
  }
}); 
```

阅读有关上述方法的更多信息并使用您喜欢的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:33:17.390

而不是设置 window.location.href ，你为什么不试试这个，

```
 $('#maindiv').load('mypage.html', function() {
       alert('Load was performed.');
      //  here slide the content and render the maindiv
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T14:29:56.580

像您在示例代码中所做的那样重定向页面将使页面刷新，因此无法产生效果。如果你想实现类似幻灯片页面的东西，你可能想看看在一个 iframe 中滑动，该 iframe 包含你想要重定向到的页面（并且可能在效果完成后进行完整的位置刷新）。

# php - 对象上的 PHP array_filter

> ID：11017076
> 
> 赞同：6
> 
> 时间：2012-06-13T14:28:52.057
> 
> 标签：php, object, array-filter

我正在尝试`array_filter`在对象数组上使用，并使用 foo 类的公共方法作为回调。我不知道该怎么做。

我得到了这个结果：`Fatal error: Using $this when not in object context`我猜是因为它以静态方式调用 bar 方法，但是如何正确地将对象传递给 array_filter 回调方法？

```
function foobar_filter($obj) {
    return $obj->bar();
}

class foo {
    private $value;
    public function __construct($value) {
        $this->value = $value;
    }
    public function bar() {
        // checking if $this is set to avoid "using this when not in object yadayada"-message
        if ($this) return ($this->value > 10);
        else return false;
    }
}

$arr = array(new foo(12), new foo(42), new foo(4));
var_dump($arr);

// Here is the workaround that makes it work, but I'd like to use the objects' method directly. This is the result that I am expecting to get from $arr3 as well
$arr2 = array_filter($arr, "foobar_filter");
var_dump($arr2);

// I would like this to work, somehow...
$arr3 = array_filter($arr, array(foo, "bar"));
var_dump($arr3); 
```

所以我期望的结果是一个数组，其中包含两个`foo`值为 12 和 42 的类对象。

供您参考，我使用的是 PHP 5.2.6，但如果可以使用任何 PHP 版本，我会很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:31:49.420

您可以像这样在 array_filter 方法中使用 Closure (>= PHP 5.3)

```
$arrX = array_filter($arr, function($element) {
    return $element->bar();
});
var_dump($arrX) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-06T21:53:10.130

我认为您可以像这样静态地调用它：

```
class foo {
    private $value;
    public function __construct($value) {
       $this->value = $value;
    }
    public static function bar($a) {        
        if ($a) return ($a->value > 10);
        else return false;
    }
}

$arr = array(new foo(12), new foo(42), new foo(4));

$arr3 = array_filter($arr, array('foo', "bar"));
var_dump($arr3); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:37:34.240

问题是`bar`方法不是静态的，需要在每个对象上调用。你的`foobar_filter`方法是要走的路。没有其他办法，因为您需要调用`bar`每个*对象*（因此每次`array_filter`调用不同的函数），您不能静态调用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-05T22:22:30.637

如果您使用的是 PHP 7.1+，您可以通过以下方式实现您的目标：

```
$arr3 = Arr::filterObjects($arr, 'bar'); 
```

使用[这个](https://github.com/minwork/array)具有有用数组函数的类库。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-01-17T10:16:31.357

其实你可以这样做

```
array_filter($arr, [$this, 'bar']) 
```

# forms - Drupal 7 表单 API：文件上传

> ID：11017089
> 
> 赞同：3
> 
> 时间：2012-06-13T14:29:30.357
> 
> 标签：forms, file, drupal, file-upload, drupal-7

我一直在关注 Drupal 文档中的表单示例 10： [http ://api.drupal.org/api/examples/form_example!form_example.module/group/form_example/7](http://api.drupal.org/api/examples/form_example!form_example.module/group/form_example/7)

这是我的表单的定义：

```
function portal_upload_form($form, $form_state) {

    $form['file'] = array(
        '#type' => 'file',
        '#title' => t('Choose a file'),
    );

    $form['document_submit_button'] = array(

      '#type' => 'submit', 
      '#value' => t('upload'), 
    );

    return $form;
} 
```

和 form_submit 钩子：

```
function portal_upload_form_submit($form, &$form_state) {

    $file = $form_state['values']['file'];
        // ... 
```

尽管设置了具有 777 权限的输入文件，$file 仍为“空”。我错过了一些东西，我自己找不到什么......

谢谢！J。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:08:13.863

不回答为什么表单不提供文件/url/...的问题，但它解决了整个上传问题：

```
function portal_upload_form_submit($form, &$form_state) {

    $file = $form_state['values']['file'];

    $validators = array();
    $file = file_save_upload('file', $validators, 'public://'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T14:02:07.907

这里还有一些其他需要考虑的事情：

1.  file_save_upload() 只会验证默认的内容类型列表： jpg jpeg gif png txt doc xls pdf ppt pps odt ods odp

2.  请务必以关联数组格式命名您的第一个项目，即`'#name' => 'files[img_1]',`

[file_save_upload() 文档](http://api.drupal.org/api/drupal/includes!file.inc/function/file_save_upload/7)，有关我的第二点的信息，请参阅第一条评论。

# xml - 关于 XML 签名的合法引用和转换顺序

> ID：11017093
> 
> 赞同：1
> 
> 时间：2012-06-13T14:29:46.113
> 
> 标签：xml, digital-signature, xml-signature

我对XML签名的引用和转换感到很困惑

在进行同文档引用时，是否有任何合法的 URI 期望“”和“#objectid”？

和

在签署封装签名时，在取消引用之后，应该先应用 C14N 还是封装变换？（虽然看起来没什么区别）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T00:27:02.147

对于同文档引用，合法的 URI 也由[XPointer 框架](http://www.w3.org/TR/2003/REC-xptr-framework-20030325/)定义，因此可能存在您提到的典型 URI 之外的其他 URI。

“包络”变换是一种变换，它的输入是一个节点集，它也产生一个节点集。输入节点集是通过取消引用 URI 属性隐式给出的，结果将是另一个节点集，其中包含转换的签名元素被删除。

为了能够计算计算签名值所需的消息摘要，必须首先将节点集转换为“八位字节流”。这就是 C14N 所做的。您可以应用明确声明的 C14N 转换，或者，如果未指定，则应用隐式 C14N 1.0 转换（请参阅[XML 签名语法和处理版本 1.1](http://www.w3.org/TR/xmldsig-core1/#sec-DigestMethod)）：

> 如果 URI 取消引用和 Transforms 应用的结果是 XPath 节点集（或应用程序实现的足够功能替换），则必须按照第 4.4.3.2 节参考处理模型中所述进行转换。

和

> 如果数据对象是节点集并且下一个转换需要八位字节，则签名应用程序必须尝试使用​​规范 XML [XML-C14N] 将节点集转换为八位字节流。

以与文档中出现的顺序相同的顺序应用变换也很重要，如果以任意顺序应用它们很可能会产生错误的结果。

# c++ - emacs - 如果函数包含在命名空间中（C++），“转到函数的开头”不起作用

> ID：11017094
> 
> 赞同：5
> 
> 时间：2012-06-13T14:29:49.427
> 
> 标签：c++, emacs, namespaces

在 emacs 中，我使用 CMa 和 CMe 去 C++ 代码中函数的开始/结束。但是，如果函数包含在命名空间中（它只是跳转到命名空间外壳的开头或结尾），则此功能将不再起作用。有没有人对此有很好的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T14:30:53.990

这是一个已知的错误。它已在[三天前发布](http://lists.gnu.org/archive/html/info-gnu-emacs/2012-06/msg00000.html)的 Emacs 24.1 中修复。得到它。不幸的是，该修复从未被向后移植，而且这种情况不太可能很快发生。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:48:08.560

获得修复该问题的 Emacs 24.1 是最好的课程。如果您卡在旧版本的 Emacs 上，一个常见的解决方法是使用预处理器宏。

```
#define NAMESPACE_BEGIN(X) namespace X {
#define NAMESPACE_END      }

NAMESPACE_BEGIN(tools)

class Foo {
    //...
};

NAMESPACE_END 
```

这样做的一些从业者还有其他原因。我个人喜欢它如何阻止默认的 Emacs 设置缩进命名空间的代码。

# actionscript-3 - S3E空中行动脚本项目的签名生成错误

> ID：11017095
> 
> 赞同：1
> 
> 时间：2012-06-13T14:29:50.900
> 
> 标签：actionscript-3, apache-flex, amazon-s3

基于 Amazone s3 文档[http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingRESTAPImpUpload.html](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingRESTAPImpUpload.html) 尝试创建分段上传并且evertythinks 正常工作，直到最后一个过程“完成分段上传”。

在将完成的部分 xml 发布到 amazon s3 以组合上传的部分时，它会给出错误“我们计算的请求签名与您提供的签名不匹配。检查您的 AWS 秘密访问密钥和签名方法”。

```
public function getAuthenticationString(verb:String, dateString:String, resource:String, contentType:String = null, hash:String = null):String  {

        var toSign:String = verb + "\n";
        toSign += (hash != null) ? hash + "\n" : "\n";
        toSign += (contentType != null) ? contentType + "\n" : "\n";
        toSign += dateString + "\n" + resource;
        var toSignBytes:ByteArray = new ByteArray();
        toSignBytes.writeUTFBytes(toSign);          
        var hmacBytes:ByteArray = hmac.compute(secretAccessKeyBytes,toSignBytes);
        return Base64.encodeByteArray(hmacBytes);
    } 
```

该错误仅在尝试将最后一部分发送到 s3 时显示

# ios - iOS CTFramesetterCreateWithAttributedString 大小不正确

> ID：11017100
> 
> 赞同：0
> 
> 时间：2012-06-13T14:30:04.373
> 
> 标签：ios, ipad, core-graphics, core-text

我正在构建一个应用程序，它需要几个不同的文本文件并将它们串在一起，然后用它们构建一个 pdf。我需要添加文件的文本添加单独的时间，这样我就可以在每个文件的文本中添加超链接。我已经取得了一些进展，并且几乎可以准确地显示它，但是 CTFramesetterCreateWithAttributedString 的大小似乎不正确。

例如，三个文件中的第一个显示太多，换句话说，在文本结束后会有一个空白页出现。第二个文本文件显示得很好，但第三个从一开始就丢失了一大块。我不相信它与文件本身有任何关系，因为如果我颠倒文件的呈现顺序，我会遇到同样的问题。第一个文件（无论是哪个文件）最后都有一个空白页，第三个文件的第一页左右丢失了。有谁知道是什么导致了这种现象？

```
- (void)savePDFFile:(NSString *)file_Name
{ 
 NSString *homeDir = NSHomeDirectory();
 NSString *saveDirectory = [NSString stringWithFormat: @"%@/%@", homeDir, @"Documents/"]; 

 NSArray *fileAr = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:saveDirectory error:nil];
 NSMutableArray *textArray = [[NSMutableArray alloc] init];
 NSInteger currentPage = 0;
 NSInteger currentFile = 0;

 for (NSString *string in fileAr) {
    if([string hasSuffix:@"txt"]){
        NSString *file = [NSString stringWithFormat: @"%@/%@", saveDirectory, string];
        NSString *text =[NSString stringWithContentsOfFile:file encoding:NSUTF8StringEncoding error:nil];
        completeString = [NSString stringWithFormat:@"%@%@", completeString, text];
    }
 }

        NSString* pdfFileName = file_Name;

        // Create the PDF context using the default page size of 612 x 792.
        UIGraphicsBeginPDFContextToFile(pdfFileName, CGRectZero, nil);

        CFRange currentRange = CFRangeMake(0, 0);
        for (NSString *string in textArray){
        BOOL done = NO;
            NSString *thisText = [textArray objectAtIndex:currentFile];
            CFAttributedStringRef currentText = CFAttributedStringCreate(NULL, (CFStringRef)thisText, NULL);                                
            CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)currentText);
            currentPage = currentPage;
        do {
            // Mark the beginning of a new page.
            UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0, 612, 792), nil);

            // Draw a page number at the bottom of each page
            currentPage++;
            [self drawPageNumber:currentPage];

            // Render the current page and update the current range to
            // point to the beginning of the next page.
            currentRange = [self renderPage:currentPage withTextRange:currentRange andFramesetter:framesetter];
            // If we're at the end of the text, exit the loop.
            if (currentRange.location == CFAttributedStringGetLength((CFAttributedStringRef)currentText))
                done = YES;

        } while (!done);
            currentFile ++;
            CFRelease(framesetter);
            CFRelease(currentText);
        }

        // Close the PDF context and write the contents out.
        UIGraphicsEndPDFContext();

}

// Use Core Text to draw the text in a frame on the page.
- (CFRange)renderPage:(NSInteger)pageNum withTextRange:(CFRange)currentRange
   andFramesetter:(CTFramesetterRef)framesetter
  {
 // Get the graphics context.
CGContextRef    currentContext = UIGraphicsGetCurrentContext();

// Put the text matrix into a known state. This ensures
// that no old scaling factors are left in place.
CGContextSetTextMatrix(currentContext, CGAffineTransformIdentity);

// Create a path object to enclose the text. Use 72 point
// margins all around the text.
CGRect    frameRect = CGRectMake(72, 72, 500, 648);
CGMutablePathRef framePath = CGPathCreateMutable();
CGPathAddRect(framePath, NULL, frameRect);

// Get the frame that will do the rendering.
// The currentRange variable specifies only the starting point. The framesetter
// lays out as much text as will fit into the frame.
CTFrameRef frameRef = CTFramesetterCreateFrame(framesetter, currentRange, framePath, NULL);
CGPathRelease(framePath);

// Core Text draws from the bottom-left corner up, so flip
// the current transform prior to drawing.
CGContextTranslateCTM(currentContext, 0, 792);
CGContextScaleCTM(currentContext, 1.0, -1.0);

// Draw the frame.
CTFrameDraw(frameRef, currentContext);

// Update the current range based on what was drawn.
currentRange = CTFrameGetVisibleStringRange(frameRef);
currentRange.location += currentRange.length;
currentRange.length = 0;
//    CFRelease(frameRef);

return currentRange;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:25:32.633

我已经想通了。

我放置了“currentPage = currentPage;” 在我的代码中只是为了在设置框架设置后有一个位置放置断点，以便我可以观看它。还没有完全掌握调试器。显然，这并没有引起问题，但是如果我用“currentRange.location = 0;”替换那行代码，则在每次循环后重置范围。问题解决了。奇怪的是，最初是重置 currentRange 导致了问题。

无论如何，通过我上面列出的更改，以及[这个](https://stackoverflow.com/questions/3374591/ctframesettersuggestframesizewithconstraints-sometimes-returns-incorrect-size)问题的第二个答案（减去最后四行），问题就解决了！

# android - 水平放置两个imageView

> ID：11017102
> 
> 赞同：1
> 
> 时间：2012-06-13T14:30:06.330
> 
> 标签：android, android-layout

我想水平放置两个 ImageView，但我无法正确定位。

```
 <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" 

        >

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent" android:scaleType="fitXY">

            <ImageView
                android:id="@+id/imageView3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:src="@drawable/some_image" />

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:layout_alignBottom="@+id/imageView3"

                android:src="@drawable/some_image_ontop" />

        </RelativeLayout> 

        <RelativeLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content" android:scaleType="fitXY" >

            <ImageView
                android:id="@+id/imageView4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:src="@drawable/some_other_image" />

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:layout_alignBottom="@+id/imageView4"
                android:src="@drawable/some_other_image_ontop" />

        </RelativeLayout>
    </LinearLayout> 
```

如您所见，除了水平放置它们之外，我还试图将两个图像堆叠在一起。有人知道我把两张图片放在一起做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:34:44.023

为了使其更简单，请将您的 ImageViews 包含在`LinearLayout`其中并将其属性设置为`android:orientation="horizontal"`

例如：

```
...
         <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="horizontal">

            <ImageView
                android:id="@+id/imageView3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:src="@drawable/some_image" />

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"

                android:src="@drawable/some_image_ontop" />

        </LinearLayout>
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:49:58.100

我最终能够弄清楚。RelativeLayouts 被设置为“匹配父级”，这迫使它们占据水平行中的所有空间，从而区分另一张图片。

```
 >

        <RelativeLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:scaleType="fitXY" >

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:id="@+id/imageView3"
                android:src="@drawable/espresso_menu_1" />

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:layout_alignBottom="@+id/imageView3"

                android:src="@drawable/black_list_2" />

        </RelativeLayout>

        <RelativeLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content" android:scaleType="fitXY" >

            <ImageView
                android:id="@+id/imageView4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:src="@drawable/globe_1" />

            <ImageView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:scaleType="fitXY"
                android:layout_alignBottom="@+id/imageView4"
                android:src="@drawable/black_list_2" />

        </RelativeLayout>
    </LinearLayout> 
```

# android - 安卓应用耗电量

> ID：11017106
> 
> 赞同：0
> 
> 时间：2012-06-13T14:30:12.913
> 
> 标签：android

我想到了一个简单的警报应用程序，用于每小时警报/提醒。我打算用它来提醒自己在工作中从电脑中休息一下。基本上是一个在后台运行的警报，也许还有一个小部件来提供下一个警报的倒计时。

我可以很容易地找到并下载这样的应用程序，但本练习的目的是学习如何制作自己的应用程序。

我正在寻求有关如何设计此应用程序的建议，以使其保持电池友好。我在应用程序设计方面的经验非常低，因此任何建议都会受到重视。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:31:33.163

您是否已经阅读了android 开发人员[关于优化电池寿命的文章？](http://developer.android.com/training/monitoring-device-state/index.html)这些提供了可以帮助您保持低电池消耗的基本信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T14:46:35.113

为了获得最佳的电池寿命，请使用 AlarmManager 类以这样一种方式将未来的事件排入队列，从而不会阻止手机在此期间休眠 - 如果您尝试使用普通计时器进行此操作，则必须持有唤醒锁。

然后，您可以制作一个显示剩余时间的小部件，仅当手机已经唤醒时。

如果您愿意，您可以在 UI 中的某处放置一个复选框以启用屏幕唤醒锁，以便用户可以连续看到倒计时，并发出有关电池寿命影响的警告。

# c++ - 需要帮助解决链接器错误 LNK2001 Visual Studio 2010

> ID：11017108
> 
> 赞同：0
> 
> 时间：2012-06-13T14:30:17.897
> 
> 标签：c++, visual-studio-2010, visual-studio-2008, dll

我遇到了一个讨厌的链接器错误的问题，希望能找到解决方法的提示。

我理解错误的方式是，链接器无法在“BFStream”类中找到名为“read”的函数的实现。该代码包括 BFStream 类的标头。有一个导入库 QRFound.lib，它接收从 QRFound.dll 导出的函数。dll 和 lib 都在文件系统的 lib 目录中。lib 目录在项目属性中的两个位置提供：VC++ Directories->Library Directories 和 Linker->Additional Library Directories。QRFound.lib 在 Linker->Input->Additional Dependencies 中指定，并且在列表的第一位。

我知道 QRFound.dll 包含 BFStream::read 的实现，因为我使用依赖项walker 来查看它。但是 C++ 装饰与链接器错误略有不同，这让我很怀疑：`?read@BFStream@@QAE_NPADH@Z`

链接器错误是：

```
1>     Creating library C:\MyProj\Debug\MyDisplay.lib and object C:\MyProj\Debug\MyDisplay.exp
1>MyCmdReceiver.obj : error LNK2001: unresolved external symbol "public: bool __thiscall BFStream::read(char *,__int64)" (?read@BFStream@@QAE_NPAD_J@Z) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:03:07.057

在您的符号上运行 undname.exe 实用程序会产生：

```
Undecoration of :- "?read@BFStream@@QAE_NPADH@Z"
is :- "public: bool __thiscall BFStream::read(char *,int)" 
```

所以，是的，显然最后一个参数不匹配，`__int64`不匹配`int`。您没有发布该方法的实际声明，因此我无法正确猜测这种不匹配是如何发生的。我怀疑这是某种宏观汤问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:45:45.407

我怀疑您正在调用使用不同编译器构建的 DLL。

如果您有 DLL 的源代码，请使用您当前的编译器构建它：名称修改将保持一致，您应该能够解决问题。

如果您没有 DLL 的源代码，请查看它是否具有 COM 接口。

# android - 用字母填充gridview

> ID：11017112
> 
> 赞同：-1
> 
> 时间：2012-06-13T14:30:27.890
> 
> 标签：android, gridview

我是初学者。我正在制作一个教育应用程序，当有人触摸它们时会读出字母名称。

为此，我想用字母填充网格视图。你能告诉我怎么做吗？使用哪个适配器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:35:00.837

我会使用[ArrayAdapter](http://developer.android.com/reference/android/widget/ArrayAdapter.html)并用 String 或 Character 填充它来表示每个字母。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:35:14.957

您可以只使用 ArrayAdapter 并将字母表添加到 List 或 String[] 中。

可以在此处找到[如何使用 GridView](http://developer.android.com/resources/tutorials/views/hello-gridview.html)的示例。

# session - 使用 wsadmin 列出活动会话

> ID：11017114
> 
> 赞同：2
> 
> 时间：2012-06-13T14:30:32.273
> 
> 标签：session, websphere, wsadmin

我正在尝试使用 wsadmin 编写一个脚本，该脚本将检索活动会话的总量。我环顾了整个网络，并没有发现任何真正有用的东西。有没有办法使用 wsadmin 工具来做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:48:36.750

请参阅内存会话计数中的 Websphere - [http://websphereadmin-janglestrategies.blogspot.com/2010/02/websphere-in-memory-session-count.html](http://websphereadmin-janglestrategies.blogspot.com/2010/02/websphere-in-memory-session-count.html)

### 从那篇博文

```
servers = AdminTask.listServers( '[-serverType APPLICATION_SERVER]').splitlines() 
```

对于服务器中的服务器：

```
# Now just get the app server name - not the whole jython config id
newserver = server.split('(')

# get the session manager mbean
ps = AdminControl.queryNames ('WebSphere:type=SessionManager,process=' + newserver[0] + ',*')

# now get the stats for the mbean
AdminControl.getAttribute(ps, 'stats') 
```

希望你会得到一些像这样的输出：

> ['', 'Stats name=My_WAR_FILE_NAME, type=servletSessionsModule', '{', 'name=SessionObjectSize, ID=18, description=会话级别的会话对象的平均大小，仅包括缓存中的可序列化属性。, unit=BYTE, type=AverageStatistic, avg=1762.5, min=1713, max=1812, total=200925, count=114, sumSq=4.0370855625E10, type=TimeStatistic, avg=1762.5, min=1713, max=1812, total =200925，计数=114，sumSq=4.0370855625E10'，'}']

# java - 将html添加到java中的电子邮件的xml属性文件

> ID：11017123
> 
> 赞同：2
> 
> 时间：2012-06-13T14:30:48.420
> 
> 标签：java, spring

我想发送 html 电子邮件。我正在使用 spring 框架 Mailsender 类发送电子邮件，并且有一个 email_en.xml 文件，其中包含类似的内容

> ```
>  <?xml version="1.0" encoding="UTF-8"?>
>    <!DOCTYPE properties [ 
> <!ELEMENT properties ( comment?, entry* ) >
> <!ATTLIST properties version CDATA #FIXED "1.0">
> <!ELEMENT comment (#PCDATA) >
> <!ELEMENT entry (#PCDATA) >
> <!ATTLIST entry key CDATA #REQUIRED>
>   ]>
>   <properties>
>  <entry key="subject">
>  email
> </entry>
>  <entry key="to">
>    test@test.com
>   </entry>
>   <entry key="name">
>        Garry
>     </entry>
>     <entry key="body">
>    Dear User,
>   <![CDATA[
>     Dear User,
>     <b>This is your email for reference</b> 
> ```

```
 ]]>
    </entry>
    </properties> 
```

那么我可以将html标签添加到我尝试过的这个文件中，但它不起作用。我还添加了 [CDATA[ ]] 标签，但它仍然无法正常工作。

任何人都可以给我一些想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T11:03:51.683

您很可能只使用[MailSender](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mail/MailSender.html)并发送简单的电子邮件。为了处理 HTML 内容，您应该使用[JavaMailSender](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mail/javamail/JavaMailSender.html)，它为您提供发送[MimeMessage](http://docs.oracle.com/javaee/1.4/api/javax/mail/internet/MimeMessage.html?is-external=true)的可能性。

这个[Spring 电子邮件教程](http://static.springsource.org/spring/docs/2.0.5/reference/mail.html)描述了差异，以及如何正确准备电子邮件（它适用于 2.xx 版本，但应该适用于 3.xx）。

如果您使用 MimeMessageHelper，请不要忘记在调用方法时将[HTML 标志设置为 true。](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mail/javamail/MimeMessageHelper.html#setText%28java.lang.String,%20boolean%29)`#setText`

PS 看来您正在使用自定义实用程序来解析 XML 消息并将它们转换为消息 bean。检查您的代码并确保调用了适当的设置器，因为您的 XML 消息中的属性与[MailMessage](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/mail/MailMessage.html)中的属性名称不匹配。

# javascript - Firefox 中的 Ext.Ajax.request

> ID：11017124
> 
> 赞同：0
> 
> 时间：2012-06-13T14:30:48.833
> 
> 标签：javascript, ajax

我想在Firefox中执行以下代码

```
Ext.Ajax.request({
url: "http://localhost:1979/geoserver/j_spring_security_check?",
method: "POST",
scriptTag: true,
params: {
    username: username,
    password: password
},
success: function () {
    alert("ok");
} 
```

});

由于某种原因，这段代码永远不会在 firefox 或 chrome 中执行（在 ie 中工作正常）

提前致谢

# php - 循环通过关联数组的数组

> ID：11017125
> 
> 赞同：1
> 
> 时间：2012-06-13T14:30:50.963
> 
> 标签：php, codeigniter

我有这个（我只显示三个记录，还有很多很多）

```
Array
(
[0] => Array
    (
        [name] => Johnson, John
        [telephonenumber] => 555.555.555
        [department] => Department A
    )

[1] => Array
    (
        [name] => Johnson, Bill
        [telephonenumber] => 555.555.4444
        [department] => Department B
    )

[2] => Array
    (
        [name] => Johnson, Carry
        [telephonenumber] => 555.555.3333
        [department] => Department C
    )
) 
```

A、B等部门会有多个成员，我需要遍历这些数据，只吐出A部门的成员。我试过：

```
if ($phoneList['department'] == 'Falmouth') {
    echo $phoneList['name'] . '<br>';
    echo $phoneList['telephonenumber'] . '<br>';
    echo $phoneList['department'] . '<br><br>';
} 
```

但是我收到错误是因为我认为`$phoneList['department']`不存在（不应该`$phoneList[0]['department']`）？

无论哪种方式，这都无济于事......我如何搜索所有 90 个数组并只打印出具有 A 部门状态的数组？

$phoneList 是传递给我的视图的变量**（使用 codeigniter、ldap 和 php）**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:34:55.753

你可以使用`foreach`：

```
foreach($phoneList as $item)
{
  if($item['department'] == 'Falmouth')
  {
    echo $phoneList['name'] . '<br>';
    echo $phoneList['telephonenumber'] . '<br>';
    echo $phoneList['department'] . '<br><br>';
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:35:04.520

我很确定乔希是对的，你应该使用类似的东西：

```
foreach( $phoneList as $item) {
    if( $item['department'] == 'Falmouth') {
        echo $item['name'] . '<br>';
        echo $item['telephonenumber'] . '<br>';
        echo $item['department'] . '<br><br>';
    }
} 
```

你甚至可以通过调用来替换 foreach 循环的内部[`implode()`](http://php.net/implode)：

```
foreach( $phoneList as $item) {
    if( $item['department'] == 'Falmouth') {
        echo implode( '<br>', $item) . '<br><br>';
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:34:56.407

```
try
foreach($phoneList as $key => $data)
{

    if($data['department'] == 'DepartmentA')
    {
        ...
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T14:43:35.800

```
$testNeedle = 'DepartmentS';
foreach( array_filter( $phonelist,
                       function($arrayEntry) use ($testNeedle) {
                           return $arrayEntry['department'] === $testNeedle;
                       }
         ) as $phoneEntry) {
    var_dump($phoneEntry);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T14:52:01.703

对于这些类型的问题，也可以使用“array_walk”。您应该将以下书面函数称为 -

```
array_walk($phoneList, 'print_department'); 
```

功能是：

```
function print_department($phonelist){

    // Printing the items
    if($phonelist['department'] == 'Falmouth'){
        echo $phonelist['name']. '<br>';
        echo $phonelist['telephonenumber']. '<br>';
        echo $phonelist['department']. '<br>';
    }
} 
```

# xml - 使用 Groovy HTTPBuilder 发布 XML 数据

> ID：11017126
> 
> 赞同：3
> 
> 时间：2012-06-13T14:30:54.067
> 
> 标签：xml, groovy, httpbuilder

我正在尝试使用 HTTPBuilder 类将 XML 数据发布到 URL。目前我有：

```
def http = new HTTPBuilder('http://m4m:aghae7eihuph@m4m.fetchapp.com/api/orders/create')
http.request(POST, XML) {
body = {
        element1 {
            subelement 'value'
            subsubelement {
                key 'value2'
            }
        }
    }           

    response.success = { /* handle success*/ }
    response.failure = { resp, xml -> /* handle failure */ }
} 
```

经过检查，我发现请求确实以 XML 作为正文。不过，我有 3 个问题。第一个是，它省略了经典的 xml 行：

```
<?xml version="1.0" encoding="UTF-8"?> 
```

它必须位于正文的顶部，其次内容类型也未设置为：

```
application/xml 
```

最后，对于 XML 中的一些元素，我需要设置属性，例如：

```
<element1 type="something">...</element1> 
```

但我不知道如何以上述格式执行此操作。有谁知道怎么做？或者也许是另一种方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:30:31.847

1.  [`mkp.xmlDeclaration()`](http://groovy.codehaus.org/api/groovy/xml/MarkupBuilderHelper.html#xmlDeclaration%28java.util.Map%29)在标记开头添加 XML 声明行。
2.  [`ContentType.XML`](http://groovy.codehaus.org/modules/http-builder/apidocs/groovyx/net/http/ContentType.html#XML)作为第二个参数传递给 request 将`Content-Type`标头设置为`application/xml`. 我不明白为什么这对你不起作用，但你可以尝试使用一个字符串`application/xml`代替。
3.  要在元素上设置属性，请在标记构建器中使用以下语法：`element1(type: 'something') { ... }`

这是一个例子：

```
@Grab(group='org.codehaus.groovy.modules.http-builder', module='http-builder', version='0.5.2')
import groovyx.net.http.*

new HTTPBuilder('http://localhost:8080/').request(Method.POST, ContentType.XML) {
    body = { 
        mkp.xmlDeclaration()
        element(attr: 'value') {
            foo { 
                bar()
            } 
        }
    }
} 
```

生成的 HTTP 请求如下所示：

```
POST / HTTP/1.1
Accept: application/xml, text/xml, application/xhtml+xml, application/atom+xml
Content-Length: 71
Content-Type: application/xml
Host: localhost:8080
Connection: Keep-Alive
Accept-Encoding: gzip,deflate

<?xml version='1.0'?>
<element attr='value'><foo><bar/></foo></element> 
```

# java - 您可以使用 testng 工厂创建多个测试吗？

> ID：11017128
> 
> 赞同：1
> 
> 时间：2012-06-13T14:30:56.767
> 
> 标签：java, testng

使用 testng 工厂可以轻松创建一个由具有不同测试方法的不同测试类组成的测试。

我现在要做的是使用相同的测试类创建多个测试以并行运行。

如果我在没有工厂的情况下这样做，它看起来像这样：

```
<test name="testcombo1">
    <classes>
        <class name="test1" />
        <class name="test2" />
        <class name="test3" />
    </classes>
</test>

<test name="testcombo2">
    <classes>
        <class name="test1" />
        <class name="test2" />
        <class name="test3" />
    </classes>
</test>

<test name="testcombo3">
    <classes>
        <class name="test1" />
        <class name="test2" />
        <class name="test3" />
    </classes>
</test> 
```

当然不止3个测试，每个测试组合都有不同的参数。这些测试组合应并行运行，而不是类或方法。这可以使用 testng 工厂吗？如果没有，我愿意接受建议。如果我的问题不清楚，请提问。

**编辑**

使用 XML 套件创建的套件：

```
<suite thread-count="15" name="TmpSuite" parallel="tests">
  <!-- List of parameters for grid -->
  <listeners>
  <!-- some listeners -->
  </listeners>
  <test name="Accept2">
    <parameter name="number" value="2"/>
    <classes>
      <class name="com.Factory"/>
    </classes>
  </test> <!-- Accept2 -->
  <test name="Accept3">
    <parameter name="number" value="3"/>
    <classes>
     <class name="com.Factory"/>
    </classes>
  </test> <!-- Accept3 -->
  <test name="Accept4">
    <parameter name="number" value="4"/>
    <classes>
      <class name="com.Factory"/>
    </classes>
  </test> <!-- Accept4 -->
</suite> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T05:07:36.497

你为什么不生成你自己的 testng.xml 呢？您甚至可以在内存中执行此操作，查找 Javadoc fox XmlSuite。

# google-analytics - Google Analytics：如何在报告中分隔域？

> ID：11017130
> 
> 赞同：2
> 
> 时间：2012-06-13T14:31:04.403
> 
> 标签：google-analytics

我在多个网站上有一个代码。我想看看用户目前在哪些网站上。

目前我已经这样做了，但在报告中我只看到所有域的“**直接流量”**

可能吗？

```
var cb=function(){
    var pageTracker = _gat._getTracker('UA-XXXXXXXX-XX');
    pageTracker._setDomainName(document.domain);
    pageTracker._setAllowLinker(true); // To track traffic across domains
    pageTracker._trackPageview();
}

if(!window._gat) {                    
    $.getScript(('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js',cb);
}
else {
    cb();
} 
```

也许可以通过自定义变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T15:13:25.373

您包含的代码应该允许您在报告中分隔域。做这件事有很多种方法：

1.  为每个域添加新的配置文件（除了您的主要配置文件，其中包括两者）。您可以在配置文件下的管理选项卡中执行此操作。自定义过滤器将使用包含过滤器类型和“主机名”的过滤器字段，您可以在其中指定每个域。
2.  使用“主机名”字段将您的报告直接划分为不同的域。这在某些标准报告中作为次要维度条件起作用，但最简单的方法是在自定义报告中添加“主机名”作为维度或过滤条件。
3.  通过指定您要创建维度为“主机名”的包含段，为每个域创建单独的高级段。

上面的最后两个选项允许您在报告中并排比较两个域。

# jquery - jqgrid filterToolbar在提交后停止工作

> ID：11017131
> 
> 赞同：0
> 
> 时间：2012-06-13T14:31:05.190
> 
> 标签：jquery, jqgrid

加载 jqgrid 时，我的 jqgrid filterToolbar 工作正常。
最初在 jqgrid 完成后，我可以很好地使用本地 filterToolbar 进行任何搜索。主要的 jqgrid 选项是：

```
$("#list").jqGrid({
...
      strong texturl:'/myapp/crud',
      datatype: 'json',
      mtype: 'POST',
      loadonce: true,
...
});
$("#list").jqGrid('filterToolbar',{stringResult: true,searchOnEnter : true, defaultSearch:"cn"}); 
```

但有时我想从服务器重新加载或刷新数据。
所以，我用js函数来做这个：

```
function refreshJq(){
$('#list').jqGrid('setGridParam',{datatype:'json'}).trigger('reloadGrid');
} 
```

调用 refreshJq 函数，jqgrid 重新加载正常。
我也可以毫无问题地对列进行排序。
但是，filterToolbar 在提交/重新加载网格后停止工作。
我无法在本地使用 filterToolbar 进行搜索。
任何想法！？

此致！

# ios - CALayer 蒙版 - 结合两层

> ID：11017138
> 
> 赞同：2
> 
> 时间：2012-06-13T14:31:26.813
> 
> 标签：ios, xcode, uiview, core-animation, calayer

在我的应用程序中，我有一个视图，我希望它在左侧和右侧有一个小的透明渐变。我可以很容易地创建左或右渐变，但我不知道如何组合它们：

```
CAGradientLayer *rightLayer = [CAGradientLayer layer];
rightLayer.frame = self.bounds;
rightLayer.colors = [NSArray arrayWithObjects:(id)[UIColor whiteColor].CGColor, (id)[UIColor clearColor].CGColor, nil];
rightLayer.startPoint = CGPointMake(0.8f, 1.0f);
rightLayer.endPoint = CGPointMake(1.0f, 1.0f);

CAGradientLayer *leftLayer = [CAGradientLayer layer];
leftLayer.frame = self.bounds;
leftLayer.colors = [NSArray arrayWithObjects:(id)[UIColor clearColor].CGColor,(id)[UIColor whiteColor].CGColor, nil];
leftLayer.startPoint = CGPointMake(0.0f, 1.0f);
leftLayer.endPoint = CGPointMake(0.2f, 1.0f);

self.layer.mask = leftLayer; 
```

如您所见，问题是我必须只为蒙版分配 1 层，并且我希望它有 2 层。如何合并 leftLayer 和 rightLayer？或者我如何将这两个图层都添加到掩码中？

非常感谢您的回答！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:34:36.780

您将必须创建*一个*渐变层，其渐变从透明到白色再到透明，并设置`locations`三个点。因此，您必须`endPoint`通过将其设置为 1 来将其设置为视图的另一侧（覆盖整个宽度）。

您需要将点包装在 NSValue 对象中以将它们添加到位置数组中，如下所示：`[NSValue valueWithCGPoint:myCGPoint];`

~~由于位置定义在 0 和 1 之间。您必须根据要遮罩的图层的宽度来计算值。像这样的东西：~~

 ~~```
0.2/width         // left edge
(width-0.2)/width // right edge 
```~~  ~~您已经在 0 到 1 的范围内设置了起点和终点，因此只需使用相同的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-10T13:18:32.913

诀窍是使用其他人提到的“位置”。下面的代码在顶部和底部做了一个“淡出”渐变——如果你想让滚动文本在两端淡出屏幕，这很有用。下面的位置停止应读取为 0.0 => 0.1 从清晰淡入白色，然后 0.9 => 1.0 再次从白色淡入淡出。

```
CAGradientLayer *gradient = [CAGradientLayer layer];
gradient.frame = self.bounds;
gradient.colors = @[(id)[[UIColor clearColor] CGColor], (id)[[UIColor whiteColor] CGColor], (id)[[UIColor whiteColor] CGColor], (id)[[UIColor clearColor] CGColor]];
gradient.startPoint = CGPointMake(0.5, 0.0);
gradient.endPoint = CGPointMake(0.5, 1.0);
gradient.locations = @[@0.0, @0.1, @0.9, @1.0];

[self.layer setMask:gradient]; 
```

请记住包含`#import <QuartzCore/QuartzCore.h>`在您的文件中。~~

# javascript - Javascript setinterval 和 clearinterval

> ID：11017139
> 
> 赞同：1
> 
> 时间：2012-06-13T14:31:27.437
> 
> 标签：javascript, image, html, setinterval, clearinterval

我正在尝试使图像看起来像是在倒塌。所以我制作了一个 div 并将图像放入其中。使用 setinterval 和 clearinterval 我试图让图像停在 div 的边界，但我不知道该怎么做。这是代码：

```
var x = 200;
var y = -155;
var inc = 5;

var myVar;

var fall = function() {
myVar = setInterval(function(){moveDown();},30);
};
var stopFall = function() {
clearInterval(myVar);
};
var moveDown = function() {
y += inc;

document.getElementById('img1').style.top = y + 'px';
}; 
```

我希望`setinterval`自动停止，`y = 155`但我不知道如何。我尝试过 if、while 和 for 语句，但它们似乎不起作用。我制作了一个可以运行的按钮，`stopFall();`它可以工作，但我希望它在不点击任何按钮的情况下自动停止。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:34:07.467

更改您的`moveDown()`函数以检查当前状态，`y`并在必要时调用`stopFall()`.

```
var moveDown = function() {
  y += inc;

  if ( y >= 155 ) { stopFall(); }

  document.getElementById('img1').style.top = y + 'px';
}; 
```

作为替代方案，您可以`clearInterval()`像这样直接使用

```
var moveDown = function() {
  y += inc;

  if ( y >= 155 ) { 
    clearInterval(myVar);
  }

  document.getElementById('img1').style.top = y + 'px';
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:37:53.223

```
 var x = 200;
 var y = -155;
 var inc = 5;

 var myVar;

 var fall = function() {
       myVar = setInterval(function(){
         if(y >= 155) clearInterval(myVar);
         moveDown();
       },
       30);
 };

 var moveDown = function() {
     y += inc;

     document.getElementById('img1').style.top = y + 'px';
 }; 
```

# c - 将值写入 C 中 .csv 文件中的新行

> ID：11017143
> 
> 赞同：0
> 
> 时间：2012-06-13T14:31:38.333
> 
> 标签：c, csv

对于这个我想不通的看似相对简单的任务，我深表歉意。我似乎无法找到一种方法来使用 C 语言将数据写入 .csv 文件中的新行。我将 3 个变量保存到 .csv 文件中，目前它们将始终替换 A1:C1。这是我的打印命令：

```
fs = fopen("C:\\Documents and Settings\\ajkaas\\Desktop\\110c.csv", "w");
if(fs == NULL){
    printf("Couldn't open file\n");
    return;
}
fprintf(fs, "%u,%11.8f,%11.8f\n", message63->rcvrBitErrorCount,
(double)message63->rcvrTotalBitErrorCount / (double)(message63->rcvrBlockIndex * message63->rcvrBitsPerBlock),
(double)message63->rcvrBlockErrorCount / (double)(message63->rcvrBlockIndex));
fclose(fs); 
```

我知道这看起来很乱，我也为此道歉。我正在查看一些文档，但似乎找不到答案。每次运行此代码所在的 for 循环时，我的 A1:C1 行都会被替换，但我希望它在每次循环再次运行时下拉一行。这有任何意义吗？如果您需要任何额外的东西，请告诉我，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:34:03.147

您需要以附加模式打开文件。将第二个参数从“w”更改为“a”。

# javascript - ASP.net 表单获取 JS 错误

> ID：11017144
> 
> 赞同：3
> 
> 时间：2012-06-13T14:31:40.307
> 
> 标签：javascript, asp.net

我有一个 ASP.NET 表单（C#），但是我单击了这个应该执行 JS 方法的按钮，我收到错误“Microsoft JScript 运行时错误：'document.getElementById(...)' is null or not an object”

这很奇怪，因为它应该可以工作：

```
 <asp:LinkButton ID="btnDriverPopulate" runat="server" Text="" Height="55px" Width="172px" CssClass="btnMTO" 
                    OnClientClick="readLicense()" ToolTip="Check Driver" /> 
```

文本框代码在这里

```
 <asp:TextBox ID="DriverLast" runat="server" Width="180px" Text='<%# Eval("Last") %>' ToolTip="Enter driver last name"></asp:TextBox>
                                    <cc:TextBoxValidator ID="valDriverLast" runat="server" AllowBlank="false" Display="dynamic" ControlToValidate="DriverLast" ValidationGroup="ValGrpDriver"
                                        CorrectFormat="Please enter in alphanumeric characters only." FieldName="Last Name" RegString="^[a-zA-Z0-9\s.,\-']+$" /> 
```

JS 函数 readLicense 应该将文本框的值设置为“hi”

```
document.getElementById("DriverLast").value = "hi"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:36:16.767

在标记中是否有 ID 为 DriverLast 的输入？ASP.NET 可能会将此控件的 ID 更改为它的容器 ID，即：**_ctl** _DriverLast。因此，您可以使用该`ClientId`属性。

尝试：

```
document.getElementById(<%=DriverLast.ClientId %>.value = "Hi"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:34:24.910

呈现的客户端 ID 不一定与服务器控件 ID 相同。您可以使用该[`ClientIDMode`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)属性来更改此行为。

```
document.getElementById("<%= DriverLast.ClientID %>").value = "hi"; 
```

# android - 需要基本消息示例，从 AsyncTask 到 UI 线程，不使用服务

> ID：11017145
> 
> 赞同：-1
> 
> 时间：2012-06-13T14:31:48.047
> 
> 标签：android

我正在寻找简单的示例代码，用于在 AsyncTask 中设置消息并在 UI 线程的 Handler 中处理它。

我看到的示例在服务中处理此问题，而我的应用程序当前未使用任何服务。可以在没有服务的情况下使用消息吗？

示例代码将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:46:44.173

```
public static final int MSG = 1;
private final Handler handler = new Handler(){
    @Override
    public void handleMessage(Message msg) {

        switch( msg.what ){
            case MSG:{

            }break;
        }
    }
}; 

@Override
public void onCreate(Bundle icicle) {
     super.onCreate(icicle);

     new YourAST(handler).execute();
}

public class YourAST extends AsyncTask<String, Void, Integer> {

    Handler mHandler = null;

    public YourAST(Handler handler){
         this.mHandler = handler;
    } 

    @Override
    protected Integer doInBackground(String... arg) {

        // send message to UIthread
        if(mHandler!=null)
        mHandler.sendEmptyMessage(YourClass.MSG);

        return null;
    }

} 
```

# php - .htaccess mod_rewrite 与语言选择器

> ID：11017146
> 
> 赞同：0
> 
> 时间：2012-06-13T14:31:49.060
> 
> 标签：php, apache, .htaccess, mod-rewrite

是否可以重写网址，例如：

```
http://www.domain.com/?language=en
http://www.domain.com/contact?language=en 
```

至：

```
http://www.domain.com/en/
http://www.domain.com/en/contact 
```

到目前为止我所拥有的：

```
RewriteEngine on
RewriteRule ^([^/]+)/([^/]+)/?$ index.php?language=$1 [QSA,L]

http://www.domain.com/en/ <- Gives a server not found error
http://www.domain.com/en/contact <- Goes to the main root (/index.php) and give the en variable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:53:51.140

尝试这个：

```
<IfModule mod_rewrite.c>

  Options +FollowSymLinks
  RewriteEngine On
  RewriteBase /

  RewriteRule ^(en|fr)(/(.*))$ $2/index.php?language=$1 [L]

</IfModule> 
```

笔记：

我`fr`在那里添加，以便您可以看到多种语言的示例。此外，这将是对 index.php 脚本的内部重定向。

编辑：

修改为现在允许在 URI 的语言部分之后添加内容。现在应该如何工作。

这是正则表达式的一个很好的参考：

[http://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)

# logback - 条件功能在 Logback 中是如何工作的？

> ID：11017148
> 
> 赞同：4
> 
> 时间：2012-06-13T14:31:52.820
> 
> 标签：logback, janino

我使用这个 logback 配置文件：

```
<configuration>
  <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <pattern>%d{HH:mm:ss.SSS} [%-10.-10thread] %-5level %-30logger{1} - %msg%n</pattern>
    </encoder>
  </appender>

<if condition='isDefined("fileout-dir")'><then>
  <appender name="SIFT" class="ch.qos.logback.classic.sift.SiftingAppender">
     <discriminator  class="edu.kit.sdq.storagebenchmarkharness.logging.SBHThreadDiscriminator"/>
    <sift>
      <appender name="FILE-${thread}" class="ch.qos.logback.core.FileAppender">
        <file>${fileout-dir:-}${thread}.log</file>
        <append>true</append>
        <layout class="ch.qos.logback.classic.PatternLayout">
          <pattern>%d{HH:mm:ss.SSS} %-5level %-30logger{1} - %msg%n</pattern>
        </layout>
      </appender>
    </sift>
  </appender>
  <root>
    <appender-ref>SIFT</appender-ref>
  </root>
 </then> </if>

  <root level="debug">
    <appender-ref ref="STDOUT" />
  </root>
</configuration> 
```

运行我的应用程序时，我收到以下错误：

```
org.codehaus.commons.compiler.CompileException: Line 1, Column 45: A method named "isDefined" is not declared in any enclosing class nor any supertype, nor through a static import
    at org.codehaus.commons.compiler.CompileException: Line 1, Column 45: A method named "isDefined" is not declared in any enclosing class nor any supertype, nor through a static import
    at  at org.codehaus.janino.UnitCompiler.compileError(UnitCompiler.java:9014)
    at  at org.codehaus.janino.UnitCompiler.findIMethod(UnitCompiler.java:6549)
    at  at org.codehaus.janino.UnitCompiler.compileGet2(UnitCompiler.java:3429)
    at  at org.codehaus.janino.UnitCompiler.access$6300(UnitCompiler.java:104)
    at  at org.codehaus.janino.UnitCompiler$11.visitMethodInvocation(UnitCompiler.java:2869)
    at  at org.codehaus.janino.Java$MethodInvocation.accept(Java.java:2831)
    at  at org.codehaus.janino.UnitCompiler.compileGet(UnitCompiler.java:2890)
    at  at org.codehaus.janino.UnitCompiler.compileGetValue(UnitCompiler.java:3897)
    at  at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:1637)
    at  at org.codehaus.janino.UnitCompiler.access$1700(UnitCompiler.java:104)
    at  at org.codehaus.janino.UnitCompiler$5.visitReturnStatement(UnitCompiler.java:877)
    at  at org.codehaus.janino.Java$ReturnStatement.accept(Java.java:1803)
    at  at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:888)
    at  at org.codehaus.janino.UnitCompiler.compileStatements(UnitCompiler.java:914)
    at  at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:1999)
    at  at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:789)
    at  at org.codehaus.janino.UnitCompiler.compileDeclaredMethods(UnitCompiler.java:770)
    at  at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:464)
    at  at org.codehaus.janino.UnitCompiler.compile2(UnitCompiler.java:357)
    at  at org.codehaus.janino.UnitCompiler$3.visitPackageMemberClassDeclaration(UnitCompiler.java:312)
    at  at org.codehaus.janino.Java$PackageMemberClassDeclaration.accept(Java.java:770)
    at  at org.codehaus.janino.UnitCompiler.compile(UnitCompiler.java:319)
    at  at org.codehaus.janino.UnitCompiler.compileUnit(UnitCompiler.java:288)
    at  at org.codehaus.janino.SimpleCompiler.compileToClassLoader(SimpleCompiler.java:393)
    at  at org.codehaus.janino.ClassBodyEvaluator.compileToClass(ClassBodyEvaluator.java:311)
    at  at org.codehaus.janino.ClassBodyEvaluator.cook(ClassBodyEvaluator.java:224)
    at  at org.codehaus.janino.SimpleCompiler.cook(SimpleCompiler.java:194)
    at  at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:80)
    at  at org.codehaus.commons.compiler.Cookable.cook(Cookable.java:72)
    at  at ch.qos.logback.core.joran.conditional.PropertyEvalScriptBuilder.build(PropertyEvalScriptBuilder.java:34)
    at  at ch.qos.logback.core.joran.conditional.IfAction.begin(IfAction.java:43)
    at  at ch.qos.logback.core.joran.spi.Interpreter.callBeginAction(Interpreter.java:273)
    at  at ch.qos.logback.core.joran.spi.Interpreter.startElement(Interpreter.java:145)
    at  at ch.qos.logback.core.joran.spi.Interpreter.startElement(Interpreter.java:127)
    at  at ch.qos.logback.core.joran.spi.EventPlayer.play(EventPlayer.java:40)
    at  at ch.qos.logback.core.joran.spi.Interpreter.play(Interpreter.java:332)
    at  at ch.qos.logback.core.joran.GenericConfigurator.doConfigure(GenericConfigurator.java:126)
    at  at ch.qos.logback.core.joran.GenericConfigurator.doConfigure(GenericConfigurator.java:93)
    at  at ch.qos.logback.core.joran.GenericConfigurator.doConfigure(GenericConfigurator.java:52)
    at  at ch.qos.logback.classic.util.ContextInitializer.configureByResource(ContextInitializer.java:60)
    at  at ch.qos.logback.classic.util.ContextInitializer.autoConfig(ContextInitializer.java:121)
    at  at org.slf4j.impl.StaticLoggerBinder.init(StaticLoggerBinder.java:85)
    at  at org.slf4j.impl.StaticLoggerBinder.<clinit>(StaticLoggerBinder.java:55)
    at  at org.slf4j.LoggerFactory.bind(LoggerFactory.java:121)
    at  at org.slf4j.LoggerFactory.performInitialization(LoggerFactory.java:111)
    at  at org.slf4j.LoggerFactory.getILoggerFactory(LoggerFactory.java:268)
    at  at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:241)
    at  at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:254)
    at  at edu.kit.sdq.storagebenchmarkharness.Logger.getLogger(Logger.java:44)
    at  at edu.kit.sdq.storagebenchmarkharness.BenchmarkController.<clinit>(BenchmarkController.java:66) 
```

为什么方法`isDefined`未知？[logback 文档](http://logback.qos.ch/manual/configuration.html#conditional)声明它应该存在，并且至少有[一个堆栈溢出](https://stackoverflow.com/questions/10819791/different-logfile-for-integration-testing)线程似乎在使用它。

我在我的类路径中包含了最新版本的 janino，因为它是评估表达式所必需的。如您在错误消息中所见，janino 编译器已加载。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-09T19:15:21.093

确保您使用的是最新版本的 logback。此外，在 logback 中使用条件[需要 Janino 库](http://logback.qos.ch/setup.html#janino)。

将此添加到您的 pom.xml 文件以获取依赖项：

```
 <!-- The org.codehaus.janino:commons-compiler:2.6.1 dependency -->
    <!-- will be automatically pulled in by Maven's transitivity rules -->
    <dependency>
        <groupId>org.codehaus.janino</groupId>
        <artifactId>janino</artifactId>
        <version>2.6.1</version>
    </dependency> 
```

# xtext - 如何在 Xtext 中使用 EOF

> ID：11017152
> 
> 赞同：2
> 
> 时间：2012-06-13T14:31:59.433
> 
> 标签：xtext

我正在尝试使 Xtext 语法将文件的结尾识别为有效语句，但到目前为止我所做的一切都不起作用。

尝试直接使用 EOF 将在编辑器中向我显示“在输入 'EOF' 时没有可行的替代方案”消息：

```
Object :
    typ=('char'| 'any' | 'number' | 'space' | 'symbol') ( ' ' | ';' | EOF )
; 
```

所以我尝试引入一个链接到EOF的终端：

```
terminal ETX: EOF;
...
Object :
    typ=('char'| 'any' | 'number' | 'space' | 'symbol') ( ' ' | ';' | ETX )
; 
```

xtext 可以通过这种方式编译，但会在
“语言编辑器窗口”（将 xtext 作为 eclipse 应用程序运行时打开的窗口）中给出与上述相同
的错误。当我没有在后面键入空格或分号时会发生错误最后一个元素（字符）：

```
symbol number char(!) 
```

当我将所有三个允许的元素放入终端时，也会发生同样的事情：

```
terminal END: ( ' ' | ';' | EOF);
...
Object :
    typ=('char'| 'any' | 'number' | 'space' | 'symbol') END
; 
```

该语法用于描述一种正则表达式语言，
它将用于解析已定义格式的字符串。例如：（
我将用下划线替换空格以使这一点更清楚）

```
char_symbol_number_
char_symbol_number; 
```

被代码更正接受（不显示错误）。

然而

```
char_symbol_number 
```

将在第二个 Eclipse 编辑器窗口中给我上述错误。
（对于我定义的语言，具有代码完成等功能。）

为了指出这一点，我想要完成的是纯粹的外观调整，
这样我就可以保留最后一个语句，而无需添加空格或分号。

所以问题是：如何让 Xtext 将 EOF（无）识别为有效的结束语句？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:55:01.477

我只能从语法片段中猜测你的最终语法应该是什么样子，但不会

```
Object: typ=('char'|'any') ';'? ; 
```

为你工作？

# cloud - 将 Google Apps 用作域控制器

> ID：11017154
> 
> 赞同：2
> 
> 时间：2012-06-13T14:32:07.257
> 
> 标签：cloud, google-apps, domaincontroller

是否可以将谷歌应用程序用作域控制器。具体来说，我想消除我们对本地 Windows DC 的本地依赖。我想让它让用户坐在他们的工作站上，当他们登录时，他们会根据谷歌应用程序用户目录进行身份验证。我还没有弄清楚如何拼凑打印机/等共享，但该组织目前正在使用谷歌应用程序来处理电子邮件、联系人和日历......并将盒子作为文件服务器。我们的目标是将我们转移到 100% 的云，然后写一个关于整个事件的案例研究。

# php - 我可以使用什么替代 HTTP_HOST？

> ID：11017157
> 
> 赞同：4
> 
> 时间：2012-06-13T14:32:12.087
> 
> 标签：php, apache, security, host

我必须显示当前服务器主机（在 PHP 中，但这不是很重要）。我不知道我在哪个主机上。我怎么能在没有安全问题的情况下做到这一点？如果我使用`$_SERVER['HTTP_HOST']`，它来自客户端，所以我不能相信这个信息（我认为它可以被重写）。

PS：我读过这篇文章：[HTTP_HOST 的可靠性如何？](https://stackoverflow.com/questions/4096151/how-reliable-is-http-host)但我没有找到任何回应（也许我没有正确搜索......）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:36:45.360

用于`$_SERVER['SERVER_NAME']`此目的，来自文档：

> 当前脚本在其下执行的服务器主机的名称。如果脚本在虚拟主机上运行，​​这将是为该虚拟主机定义的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T16:44:47.017

如果您不打算将其用于安全或身份验证目的，那么`$_SERVER['HTTP_HOST']`应该没问题。您的脚本儿童访问者可能有不正确的值，但您的常规用户将使用行为良好的浏览器。

只要您像对待任何其他用户输入一样对待它，您就不会遇到任何安全问题。清理它，不要构建文件名或基于它执行命令，在显示它之前对其进行转义，等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T16:31:58.097

你甚至可以给

```
php_uname('n'); 
```

甚至可能

```
`hostname -f` 
```

（注意这里的反引号）一试。

# jquery - Sitefinity 3.7 > 5 迁移。jQuery 不再工作

> ID：11017160
> 
> 赞同：1
> 
> 时间：2012-06-13T14:32:18.857
> 
> 标签：jquery, jquery-plugins, sitefinity, sitefinity-5

整个下午，

我目前正在将 .NET 网站从 Sitefinity 3.7 迁移到 Sitefinity 5.0 中的 .NET Web 应用程序。

迁移很顺利，除非 api 存在差异，但现在我发现我以前工作的所有 jQuery 都刚刚打包。

更具体地说，当我尝试运行我的网站时，我得到很多“.hoverIntent 不是函数”，这适用于很多函数！

以前，我有一个母版页，其中包含以下内容：

```
<script src='<%#ResolveUrl("~/App_Master/Scripts/jquery-1.4.2.min.js")%>' type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/jquery.anythingslider.js")%>' type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/jquery.easing.1.2.js")%>' type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/jquery.hoverIntent.minified.js")%>'
    type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/jquery.uniform.js")%>' type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/equalcolumns.js")%>' type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/publicMegaMenu.js")%>' type="text/javascript"></script>
<script src='<%#ResolveUrl("~/App_Master/Scripts/script.js")%>' type="text/javascript"></script> 
```

这些库似乎加载得很好，但显然，有些东西是一个失误，因为它似乎抛出了一个摇摆不定，而以前，它像梦一样工作。

有什么想法吗？

啤酒在我的正确答案:)

编辑：对，这与母版页上的 SiteSearch 有关。

当我注释掉时，一切似乎都正常

```
<%--  <asp:ContentPlaceHolder ID="SiteSearch" runat="server" />--%> 
```

如果仍然存在，它会引发精神错乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T13:19:33.260

登录后，Sitefinity 会加载一个 jQuery 版本，并根据您何时/何地/如何引入您自己的引用，您可能会导致一些冲突。

从页面中删除 jQuery 引用并使用类似下面的内容应该会有所帮助。

```
<%@ Register Assembly="Telerik.Sitefinity" Namespace="Telerik.Sitefinity.Web.UI" TagPrefix="sf" %>
<sf:ResourceLinks ID="resourcesLinks" runat="server">
    <sf:ResourceFile JavaScript Library="JQuery" />
</sf:ResourceLinks> 
```

[这里有更多](http://www.sitefinity.com/blogs/gabesumner/posts/11-09-01/how_to_use_jquery_and_other_javascript_libraries_in_sitefinity.aspx)关于在 Sitefinity 中使用 JavaScript 库的信息。

# javascript - 使用 HTML 和 Javascript 在 MetroApps 中创建 GroupItem

> ID：11017161
> 
> 赞同：1
> 
> 时间：2012-06-13T14:32:21.347
> 
> 标签：javascript, html, windows-8, microsoft-metro, visual-studio-2012

我正在使用 Windows 8 和 Visual Studio 2012 RC 进行 Metro 应用程序开发。

在这里，我正在`GridApplication`使用模板来创建 3 个列表视图（*groupedItems*），这 3 个列表视图将需要显示来自我的服务的不同信息。实际上在默认网格应用程序中，他们为所有列表视图提供了公共项目，但**在这里我不想显示第二个列表视图的图像**，当我在 javascript 文件中删除背景图像变量时，它显示为空图像符号（参见屏幕截图）

下面我试图给出我的应用场景。

谁能帮我得到我的输出？

谢谢你。 ![截屏](../Images/697d77f15b64f07c5a24807a4ca3ac26.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T00:38:10.663

您需要在 HTML 中修改模板

```
<div class="itemtemplate" data-win-control="WinJS.Binding.Template">
    <img class="item-image" src="#" data-win-bind="src: backgroundImage; alt: title" />
    <div class="item-overlay">
        <h4 class="item-title" data-win-bind="textContent: title"></h4>
        <h6 class="item-subtitle win-type-ellipsis" data-win-bind="textContent: subtitle"></h6>
    </div>
</div>

<div class="itemtemplatenoimage" data-win-control="WinJS.Binding.Template">
<div class="item-overlay">
        <h4 class="item-title" data-win-bind="textContent: title"></h4>
        <h6 class="item-subtitle win-type-ellipsis" data-win-bind="textContent: subtitle"></h6>
    </div>
</div> 
```

然后在您指定项目模板的任何地方，为每个指定一个不同的

```
firstListView.itemTemplate = element.querySelector(".itemtemplate");
secondListView.itemTemplate = element.querySelector(".itemtemplatenoimage"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T07:32:16.670

您可以在 Javascript 中动态创建项目，并通过检查项目“组”属性`ListView`将不同的 CSS 应用于每个项目。`ListView`

```
function listViewItemTemplate(item) {
    // data has has information about each item
    var data = item.data._value;

    var itemElement = document.createElement('div');
    itemElement.id = 'testElement';

    if (data.group === "group1") {
        itemElement.class = "cssForGroup1"; 
        var image = document.createElement('image');
        image.src = "you_file_path";
        image.css = "imageCssForGroup1";
        itemElement.append(image);
    } else if (data.group === "group2") {
        itemElement.class = "cssForGroup2";
    }
    ...
    else {
        ...
    }

    return {element: itemElement}
}

...
// Then you can assign the template to your listview
youListViewControl.itemTemplate = listViewItemTemplate; 
```

# php - 在网页上执行操作并将结果存储在 php 中

> ID：11017167
> 
> 赞同：0
> 
> 时间：2012-06-13T14:32:47.280
> 
> 标签：php, browser, curl, httprequest

cURL 可以请求一个 URL 并存储所请求的页面......但我想知道...... PHP 是否可以在网页上实际执行操作（如填写并提交表单）并存储有关所请求页面的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:40:57.653

一个简单的登录示例将涉及说用户名和密码。

```
$ch = curl_init();

$data = array('username' => 'xyz', 'password' => 'abc');

curl_setopt($ch, CURLOPT_URL, 'http://website.com/login.php');
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_COOKIEFILE, 'cookies.txt');
curl_setopt($ch, CURLOPT_COOKIEJAR, 'close_cookies.txt');

curl_exec($ch);
curl_close($ch); 
```

两条 cookie 行旨在将 cookie 存储在您的服务器上，以便随时读取它们。在该`curl_exec($ch)`行之后，您仍然登录到网站，并且可以创建更多 POST 或 GET 请求，而无需重新登录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:39:41.383

您可以使用 cURL 执行 POST、HEAD、PUT、DELETE 以及您可以想象的任何其他 HTTP 操作。这模拟了大多数在线表单的提交。当您使用 cURL 的功能来使用 cookie 文件并伪造用户代理时，您可以伪造浏览器。

查看有关CURLOPT_POST、CURLOPT_PUT、CURLOPT_COOKIEFILE、CURLOPT_POSTFIELDS 和 CURLOPT_USERAGENT 部分[的文档](http://www.php.net/manual/en/function.curl-setopt.php)`curl_setopt`

您还可以通过以下方式查看有关请求页面的信息`curl_getinfo($handle)`

# jquery - 选择属性中不包含字符串的元素

> ID：11017170
> 
> 赞同：16
> 
> 时间：2012-06-13T14:33:03.537
> 
> 标签：jquery, jquery-selectors

假设我有一些

```
<TR style = "background-color : red ;"> 
```

还有一些

```
<TR> 
```

（需要注意的是冒号和分号旁边的空格是故意的，因为我正在处理的页面是这样写的）

现在，这个：

```
$('.detailtable tr:not([style~="darkgray"])') 
```

完美运行。但[这里](http://api.jquery.com/attribute-not-equal-selector/)说：

> [name!="value"] 无法利用本机 DOM querySelectorAll() 方法提供的性能提升。为了在现代浏览器中获得更好的性能，请改用 $("your-pure-css-selector").not('[name="value"]')

所以我想知道：我的表达方式是最好的还是类似的：

```
$('.detailtable tr').not('[style~="darkgray"]') // this doesn't work! 
```

表现更好？写最后一个表达式的正确方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-13T14:50:49.533

如果你真的想“选择**属性中不包含字符串的**元素”，你应该使用`*=`而不是`~=`，像这样：

```
$('.detailtable tr').not('[style*="darkgray"]'); 
```

这是[小提琴](http://jsfiddle.net/sSGs7/)。

* * *

不，使用`.not`可能不会更快。`querySelectorAll`应该能够按原样解析该选择器。

看到这个[小提琴](http://jsfiddle.net/sSGs7/1/)。

* * *

**编辑：**如果您非常关心 IE8，那么使用该`.not`方法而不是`:not`选择器会给您带来小的性能提升。原因很简单：IE8 确实支持属性选择器，但不支持否定选择器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:49:08.620

[我建议你看看这个。](http://24ways.org/2011/your-jquery-now-with-less-suck)

有趣的是，伪选择器（如 ":not"）实际上比在初始选择器旁边使用函数要慢。事实上......他们显然“慢了一倍”。

我引用：

1.  `$("#id p");`
2.  `$("#id").find("p");`

> 得知第二种方法的速度是第一种方法的两倍以上，您会感到惊讶吗？了解哪些选择器优于其他选择器（以及为什么）是确保您的代码运行良好并且不会让等待事情发生的用户感到沮丧的关键构建块。

我会和`.not`我的朋友一起去！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:55:18.043

根据[W3C 建议](http://www.w3.org/TR/css3-selectors/#selectors)，您当前使用的内容即使与`document.querySelectorAll()`.

也许您可以测试它是否按预期工作。

# android - 使用 LongClick 手柄放大缩小 ImageView

> ID：11017172
> 
> 赞同：0
> 
> 时间：2012-06-13T14:33:05.900
> 
> 标签：android, android-imageview

我有 ImageView 女巫，我们可以放大和缩小。我想处理该 ImageView 上的 LongClick 事件。我怎样才能做到这一点。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:06:41.040

```
ImageView imageView = (ImageView) findViewById(R.id.ImageView);
    imageView.setOnLongClickListener(new OnLongClickListener() {

        @Override
        public boolean onLongClick(View v) {
            Toast.makeText(getBaseContext(), "image long clicked", Toast.LENGTH_LONG).show();
            zoomOut()/zoomIn();
            return true;
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:24:41.367

您可以看到处理图像视图的 Nuno Goncalves 的 onLongClick 的方式。要放大、缩小图像视图，可以看这个链接：[Android imageView Zoom-in and Zoom-Out](https://stackoverflow.com/questions/6650398/android-imageview-zoom-in-and-zoom-out)来了解。

希望清楚。

# sql - 从 Oracle SQL 中的用户定义类型中选择所有值

> ID：11017175
> 
> 赞同：1
> 
> 时间：2012-06-13T14:33:10.807
> 
> 标签：sql, oracle, oracle11g, user-defined-types

我的代码中有一个用户定义的类型，`phrase_context_typ`. 我调用一个`function`, `phrase_context`，它返回一个`phrase_context_typ`.

用户定义类型定义如下：

```
CREATE OR REPLACE type phrase_context_typ AS OBJECT (
    context   VARCHAR2(13),
    parent_id NUMBER(10) 
) 
```

我有一个`VIEW`包含`CONTEXT`和`PARENT_ID`列。我想根据实例`VIEW`中存在的值从中进行选择。`phrase_context_typ`

我可以通过以下方式做到这一点：

```
select distinct(col)
    from my_view v
    where v.parent_id = PHRASE_CONTEXT(?, ?, ?, ?, ?).parent_id 
          and
          v.context = PHRASE_CONTEXT(?, ?, ?, ?, ?).context 
```

这可行，但是否可以**只调用**一次`phrase_context` `function`? 我只想调用`function`一次，不仅是为了优雅，还因为在`select`调用*n*次`function`时会影响效率。

 *我想我要问的是，如果可以在 Oracle SQL 中实现以下功能，即有效地将用户定义的类型实例扁平化为一行：

```
select PHRASE_CONTEXT(?, ?, ?, ?, ?).* from dual; 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:06:00.130

这个子查询分解将做到这一点：

```
with data as (select phrase_context (?, ?, ?, ?, ?) obj from dual)
select distinct(col)
    from my_view v, data d
    where v.parent_id = d.obj.parent_id
          and 
          v.context = d.obj.context 
```*

# c# - 将现有数据集添加到报告 .rdlc

> ID：11017176
> 
> 赞同：5
> 
> 时间：2012-06-13T14:33:10.823
> 
> 标签：c#, crystal-reports, dataset, rdlc

我有一份报告。我需要创建另一个，类似于我拥有的那个。所以我通过复制第一个报告创建了第二个报告。然后我为新报告创建了一个新的数据集。我还通过复制原始数据集（来自第一个报告）并更改名称来创建它。现在，当我想在新报表中添加新数据集时，它不会出现在“新数据集..”的数据集选项中

![在此处输入图像描述](../Images/f648bf2fc4ceaf22a422ede4b2e79ed8.png)

我错过了什么？为什么我看不到我创建的 DataSet？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T17:12:10.607

最后我解决了这个问题。问题是，当我复制DataSet时，我更改了新的名称，但在后面的代码中，名称并没有改变。所以，我用 XML Editor 打开 DataSet，编辑 Name，保存，重新编译，它就出现了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:06:55.313

您可以尝试使用 xml 编辑器打开 rdlc 文件，然后手动将数据源复制到新的文件中。我不确定为什么它不会出现在您的下拉列表中，我通常不将该界面用于 rdlcs

# windows - 在 windows powershell 上使用 svn 缺少参数 -m

> ID：11017177
> 
> 赞同：3
> 
> 时间：2012-06-13T14:33:11.453
> 
> 标签：windows, svn, powershell, command-line

我正在尝试在 Windows PowerShell 上运行它：

```
svn ci -m "" directory_name 
```

但它返回：

> svn: E205005: 日志信息是一个路径名（是 -F 的意图吗？）；使用“--force-log”覆盖

我试图 cd 那个目录并在没有 directory_name 参数的情况下提交，它返回：

```
svn ci -m "" 
```

> svn.exe：缺少参数：m

我认为 powershell 可能不理解 -args 但很少（对我而言）这是有效的：

```
svn -h 
```

难道我做错了什么？所有这一切都在 cmd 完美运行：/

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T15:04:07.337

您可以使用

```
svn ci -m '""' directory_name 
```

或者

```
svn ci -m `"`" directory_name 
```

PowerShell 传递给本机程序的参数有时有点奇怪，这是另一个令人沮丧的边缘情况。

# ajax - Grails - 远程字段和 & 符号

> ID：11017182
> 
> 赞同：0
> 
> 时间：2012-06-13T14:33:24.777
> 
> 标签：ajax, grails

当我尝试在 grails 中使用 remoteField ajax 标记时，我注意到了一些事情。当我输入与号 (&) 时，在获取参数值时，我的控制器无法识别该值。

示例：我将输入 Cat & Dog 我看到的内容：Cat

我怎样才能避免这种情况？这是一个已知的错误？我在网上找不到任何关于此的内容。

**编辑**

我很确定这是由于 url 编码和参数造成的，因为 & 符号通常是参数分隔符。只是不知道如何解决这个问题。

```
<g:remoteField action="getName" update="testDiv" paramName="search" name="nameSearchResults" value="" /> 
```

控制器：

```
def getName() {
    println "Search result = " + params.search
    //When typing "Cat & Dog" I get:
    //Search result = C
    //Search result = Ca
    //Search result = Cat
    //Search result = Cat 
    //Search result = Cat
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:37:06.397

您是否尝试过对您的文本进行 URL 编码`remoteField`？

我建议`before`使用 JavaScript 添加一个属性来对输入进行 URL 编码：

```
<g:remoteField action="getName" update="testDiv" paramName="search" name="nameSearchResults" value="" before="encodeURIComponent(this.value); return true;" /> 
```

然后，您必须在控制器中对其进行解码。

# objective-c - 如何从工具栏的选择器方法访问 TableView

> ID：11017189
> 
> 赞同：0
> 
> 时间：2012-06-13T14:33:50.823
> 
> 标签：objective-c, ios, uitableview, selector

我希望那里的人可以帮助我了解我要去哪里错了

我有一个 TableViewController，为了保存 tableview 的内容，我更改了 -(void)viewDidLoad 代码以添加一个保存按钮...

```
- (void)viewDidLoad
{
  [super viewDidLoad];

  self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] 
                                           initWithBarButtonSystemItem:UIBarButtonSystemItemSave 
                                           target:self 
                                           action:@selector(insertCustomData)
                                           ]; 
```

但是，在我的`insertCustomData`函数中，我需要像在控制器代码中的其他地方一样访问 tableview。我需要访问我的表格视图，以便在保存到数据库之前验证单元格值。我可以看到如何从工具栏定义中传递对 tableview 的引用（如果应该这样做的话）

我什至不确定我是否应该在这个阶段访问 tableview 单元格的值（我正在尝试构建单元格数据的 NSObject 以传递给我编写的数据控制器中的验证函数，以验证并保存到 SQLite 数据库中）

抱歉，如果这看起来微不足道，但现在我坚持这一点，任何帮助将不胜感激

谢谢

[更新]

我将 tableView 用于数据输入屏幕，因此最初没有要显示的数据。tableView 在 tableview 控制器的范围内，但由于我需要这样做，我在运行时使用自定义单元格定义创建单元格（在 .xib 文件中，具有关联的 .h 和 .m 文件） . 自定义单元格定义只是一个 UILabel 和一个 UITextField（用于数据输入）

这些字段具有占位符以指示需要输入的内容，否则为空。我确实考虑过是否仍需要将 tableView 基于数组或字典对象来捕获用户输入

我写这个的类有定义`@interface ViewController : UIViewController<UITableViewDelegate, UITableViewDataSource>`，因为它是从 UITableViewController 初始模板（或任何它调用的）创建的

我觉得我应该更早地捕获数据并且只从选择器中调用 save 方法？

我是否只需要使用 nil NSStrings 创建一个 NSArray 并将其分配给 tableView 中的每个 UITextField/Cell ？如果我这样做，文本条目会进入这个 NSArray 吗？

**[已解决 - 答案如下]**

我需要的是将标准 .h 文件修改为此

```
@interface CustomViewController : UITableViewController  <UITextFieldDelegate> {
  IBOutlet UITableView *MyTableView;
}

@property(nonatomic, retain) IBOutlet UITableView *MyTableView; 
```

然后在界面生成器中，我能够将 tableview 链接到我的新声明。这是最重要的一步，因为这样可以确保我能够修改动态构建单元格的主要代码而不是通用 tableView 以引用它，如下所示

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
  static NSString *CellIdentifier = @"EditableCustomCell";
  EditableCustomCell *cell = [[self MyTableView] dequeueReusableCellWithIdentifier:CellIdentifier]; 
```

我还在`synthesize MyTableView`顶部添加了一个

这使得`MyTableView`我需要编写的任何新方法都可以访问它，从而使从 leftBarButtonItem 选择器访问它变得`insertCustomData`轻而易举

非常感谢**Kimpoy**在这方面的帮助！

（注意：具有讽刺意味的是，在完成此操作后，查看我发布的上一个问题，我应该从我之前关于 segues 和 tableviews 的问题中学到[如何在 segue 期间从视图控制器引用 tableView](https://stackoverflow.com/q/7931116/1018394)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T19:00:49.570

在 AddViewController.h 文件中：

```
@interface AddViewController : UIViewController <UITableViewDelegate, UITableViewDataSource, UITextFieldDelegate> {
    UITableView             *tableViewInfo;
    UITextField             *txtFieldUsed;
}

@property (nonatomic, retain) IBOutlet UITableView *tableViewInfo;
@end 
```

在 AddViewController.m 文件中：

```
@implementation AddViewController

@synthesize tableViewInfo; // Synthesize your tableViewInfo property

// Called to get the text values from the textfields in the table view cells/rows
- (NSDictionary *)getValueForTextField:(UITableView *)tableView {
    NSMutableDictionary *mutDictCredential = [[[NSMutableDictionary alloc] init] autorelease];
    for (int row = 0; row < 2; row++) {
        NSIndexPath *idxCell = [NSIndexPath indexPathForRow:row inSection:0];
        UITableViewCell *cell = [tableView cellForRowAtIndexPath:idxCell];
        for (UITextField *textField in cell.contentView.subviews) {
            if ([textField isKindOfClass:[UITextField class]] && row == textField.tag) {
                NSString *strText = textField.text;
                if (!strText) {
                strText = @"";
                }
                if (row == 0) {
                [mutDictCredential setObject:strText forKey:@"CoffeeName"];
                }
                else if (row == 1) {
                [mutDictCredential setObject:strText forKey:@"Price"];
                }
            }
        }
    }
    return mutDictCredential;
}

#pragma mark -
#pragma mark Tableview datasource

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return 2;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *CellIdentifier = @"CellIdentifier";
    UITableViewCell *cell = [[self tableViewInfo] dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil){
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];

        CGRect rect = [cell frame];
        // Create editable textfield within cell or row
        UITextField *txtField = [[UITextField alloc] initWithFrame:CGRectMake(rect.origin.x + 10, rect.origin.y, rect.size.width - 40, rect.size.height)];
        [txtField setAutocorrectionType:UITextAutocorrectionTypeNo];
        [txtField setAutocapitalizationType:UITextAutocapitalizationTypeNone];
        [txtField setTextAlignment:UITextAlignmentLeft];
        [txtField setContentVerticalAlignment:UIControlContentVerticalAlignmentCenter];
        [txtField setTag:indexPath.row];
        [txtField setDelegate:self];

        // Set cells texts
        switch ([txtField tag]) {
          case 0:
            [txtField setPlaceholder:@"Coffee Name"];
            [txtField setKeyboardType:UIKeyboardTypeDefault];
            [txtField setReturnKeyType:UIReturnKeyNext];
            break;
          case 1:
            [txtField setPlaceholder:@"Price"];
            [txtField setKeyboardType:UIKeyboardTypeDecimalPad];
            break;
          default:
            break;
        }
        [[cell contentView] addSubview:txtField];
        [cell setSelectionStyle:UITableViewCellSelectionStyleNone];
        [txtField release];
     }
    return cell;
}

#pragma mark -
#pragma mark Tableview delegate

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    return 20.0;
}

// This can be your insertCustomData
- (void) save_Clicked:(id)sender {
    // Get data from table
    [self getValueForTextField:[self tableViewInfo]];

    NSMutableDictionary *tempMutDictInfo = [[NSMutableDictionary alloc] initWithDictionary:[self getValueForTextField:[self tableViewInfo]]];

    NSString *paramName = [tempMutDictInfo valueForKey:@"CoffeeName"];
    NSString *paramMessage = [tempMutDictInfo valueForKey:@"Price"];
    [tempMutDictInfo release];

    NSMutableDictionary *mutDictInfo = [[NSMutableDictionary alloc] init];
    [mutDictInfo setObject:paramName == nil ? @"" : paramName forKey:@"CoffeeName"];
    [mutDictInfo setObject:paramMessage == nil ? @"" : paramMessage forKey:@"Price"];

    // Database
    SQLAppDelegate *appDelegate = (SQLAppDelegate *)[[UIApplication sharedApplication] delegate];

    //Create a Coffee Object.
    Coffee *coffeeObj = [[Coffee alloc] initWithPrimaryKey:0];
    coffeeObj.coffeeName = [mutDictInfo valueForKey:@"CoffeeName"];
    NSDecimalNumber *temp = [[NSDecimalNumber alloc] initWithString:[mutDictInfo valueForKey:@"Price"]];

    [mutDictInfo release];

    coffeeObj.price = temp;
    [temp release];
    coffeeObj.isDirty = NO;
    coffeeObj.isDetailViewHydrated = YES;

    //Add the object
    [appDelegate addCoffee:coffeeObj];

    //Dismiss the controller.
    [self.navigationController dismissModalViewControllerAnimated:YES];
}

- (void)dealloc {
    [tableViewInfo release];
    [super dealloc];
}

@end 
```

您可以将此作为参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:43:25.827

我会为我的视图控制器分配 2 个附加属性。1 用于我的表格视图，1 用于我的数据源。

# ios - 线程阻塞目标 C

> ID：11017190
> 
> 赞同：2
> 
> 时间：2012-06-13T14:33:52.943
> 
> 标签：ios, objective-c, c, multithreading, multitasking

我刚刚阅读了[这个答案](https://stackoverflow.com/q/11016247/916299)（答案已被删除），我确信我已经看到应用程序在挂起后崩溃，所以我读到的内容是有道理的。

> 如果你阻塞主线程太久，操作系统会杀死你的应用程序。

* * *

**但是**我写了一些测试，发现它们都没有导致应用程序在每个等待大约 2-5 分钟后崩溃。断点确认我正在**主线程**上运行。

*   有人可以确认或反驳我读到的内容，还是我刚刚选择了很多非阻塞的选项？

*   如果我选择了非阻塞选项，有人可以解释为什么这些是非阻塞的吗？

* * *

```
while (true) { /*Nothing*/ } 
```

* * *

```
while (true) { NSLog(@"nothing"); } 
```

* * *

```
for(;;); 
```

* * *

```
sleep(100000000); 
```

* * *

```
while(true) { sleep(1); } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:50:59.830

`UIApplicationDelegate`如果在某些方法（如`application:didFinishLaunchingWithOptions:`或）上花费太长时间，iOS 只会杀死您的应用程序`applicationDidEnterBackground:`。您通常有 5 秒的时间返回，尽管这对于您的应用程序的调试版本不是强制的。

在这些方法之外阻塞主线程不会导致您的应用程序终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:46:49.480

您所指的答案不正确，崩溃是因为他的内存不足，而不是因为他阻塞了主线程。我相信你给出的例子都没有阻塞线程。真正阻塞线程的方法是使用递归，或者从主线程调用dispatch_sync，主队列作为参数。这会造成死锁，但我认为您的应用程序不会因此而终止（尽管我可能是错的）。

那么为什么这些是非阻塞的呢？取决于您如何定义阻塞。除了第 4 行之外，您提供的所有示例都只会阻止您的代码进入下一行，这完全可以。`sleep(10000000)`甚至比这更弱，因为它会在给定的秒数后正确返回，那为什么会造成任何麻烦呢？

# c# - 持久化实例化的 XmlSerializer

> ID：11017193
> 
> 赞同：0
> 
> 时间：2012-06-13T14:33:58.077
> 
> 标签：c#, .net, xml-serialization, persistence

我有一个相当大的应用程序，它将大约 100 个不同的类序列化为 XML。由于在运行时创建 XML 序列化程序需要一些时间，因此我在加载应用程序时为最重要的类执行此操作。对于其他人，在需要时。

为了提高性能，我正在考虑以某种方式坚持创建的序列化程序。

当我在谷歌上搜索这个问题时，我找到了一种使用 Microsoft 工具“sgen.exe”的方法。它允许您创建一个程序集，据我所知，它将所有序列化程序保存到指定程序集中的类型。

在尝试为我的程序集执行此操作时，我认识到所有程序集（以及它使用的所有程序集）都需要签名。在我继续创建大量签名文件并开始为所有项目执行此操作之前，我只想确保我没有遗漏任何东西。

所以最后这是我的问题：如果我想在应用程序运行之前让我的 XML 序列化程序可用，那么这是要走的路吗？

我想将它们存储在 dll 中是“唯一的方法”，但它们的创建方式对我来说似乎非常复杂。我不能只是以某种方式二进制序列化让我们说我需要的所有类型的序列化器（列表）的列表，在启动时加载它们，最后告诉框架使用它们吗？

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:33:20.890

创建序列化程序确实很慢。这应该不足为奇：毕竟创建序列化程序意味着在运行时反映您的类型并生成 (IL) 代码。使用 sgen 是可行的方法：它做同样的事情，但在构建时执行，将该代码存储在磁盘上的程序集中，因此不必在运行时生成它。

您不能使用二进制序列化来序列化序列化程序的代码（可用于*数据*，而不是用于代码）。好吧，事实上，代码当然可以存储在磁盘上，在程序集中，而这正是 sgen 将为您做的事情。

对包含可序列化类型的程序集进行签名是个好主意，但这并不意味着您的*所有*程序集都需要签名。只需将可序列化类型放在一个单独的 dll 中，然后只签名那个。

# java - 删除嵌入的字符串

> ID：11017197
> 
> 赞同：0
> 
> 时间：2012-06-13T14:34:06.133
> 
> 标签：java, string

我正在寻找最有效的 Java 方法，它可以让我“删除嵌入的字符串”。例如，如果我有字符串`"Bob said \"Hello world!\"."`，并且我在其上调用方法，结果应该是：`"Bob said ."`。帮助将不胜感激！

请注意，我希望这种方法是**通用**的，这样如果 Bob 说除了“hello world”之外的其他内容，它仍然可以工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T14:40:03.393

你可以试试

```
String string = "Bob said \"Hello world!\".";
string = string.replaceAll("\"[^\"]+\"", ""); 
```

如果您只想删除第一个引用的文本，请使用 replaceFirst。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:40:23.787

只需使用正则表达式：

```
String newString = string.replaceAll("\"[^\"]*\"",""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:43:36.293

使用正则表达式来完成此操作。

```
 private String removeSubStrings(String s) {
        return s.replaceAll("\"[^\"]*\"", "");
    } 
```

调用 removeSubStrings("Bob said \"Hello world!\".") 将产生`Bob said .`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T14:41:37.793

假设字符串中有偶数个`\"`s，您可以使用如下内容：

```
private String deleteEmbedded(String input) {
    String[] split = input.split("\"");
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < split.length; i+=2) {
        sb.append(split[i]);
    }
    return sb.toString();
} 
```

# c++ - 使用数字序列有效地初始化 std::set

> ID：11017200
> 
> 赞同：20
> 
> 时间：2012-06-13T14:34:16.757
> 
> 标签：c++, stl, initialization, stdset

一个明显的（天真的？）方法是：

```
std::set<int> s;
for (int i = 0; i < SIZE; ++i) {
    s.insert(i);
} 
```

这是合理的可读性，但据我了解，这不是最佳的，因为它涉及重复搜索插入位置并且没有利用输入序列已经排序的事实。

是否有一种更优雅/更有效（或事实上）的方式来初始化一个`std::set`数字序列？

或者，更一般地说，如何有效地将有序的条目列表插入到集合中？

* * *

### 更新：

查看文档，我刚刚注意到接受迭代器以指示插入位置的构造函数：

```
iterator insert ( iterator position, const value_type& x ); 
```

这意味着这将更有效：

```
std::set<int> s;
std::set<int>::iterator it = s.begin();
for (int i = 0; i < SIZE; ++i) {
    it = s.insert(it, i);
} 
```

这看起来很合理，但我仍然愿意接受更多建议。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-13T15:25:29.347

用作提示的正确迭代器在 C++03 和 C++11 之间发生了变化。使用 C++03，您想使用前一项的位置（正如您和大多数回复所显示的那样）。

*在 C++11 中，您希望在要插入的项之后*立即使用迭代器。当您按顺序插入时，这会使事情变得更简单：您总是使用`your_container.end()`：

```
std::set<int> s;
for (int i = 0; i < SIZE; ++i) 
    s.insert(s.end(), i); 
```

当然，您可以使用算法（例如，`std::iota`）或迭代器（例如，`boost::counting_iterator`@pmr 已经提到的）来生成您的值，但就插入本身而言，对于您想要`.end()`用作提示的当前实现，而不是之前插入返回的迭代器。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-13T14:42:06.810

最漂亮的应该是：

```
#include <set>
#include <boost/iterator/counting_iterator.hpp>

int main()
{
  const int SIZE = 100;
  std::set<int> s(boost::counting_iterator<int>(0), 
                  boost::counting_iterator<int>(SIZE));

  return 0;
} 
```

如果您的目标是原始效率，则使用提示插入版本可能会有所帮助：

```
const int SIZE = 100;
std::set<int> s;
auto hint = s.begin();
for(int i = 0; i < SIZE; ++i)
  hint = s.insert(hint, i); 
```

能够`hint`与计数器一起声明会很好并且给我们一个干净的范围，但这需要`struct`我觉得有点令人困惑的hackery。

```
std::set<int> s;
for(struct {int i; std::set<int>::iterator hint;} 
      st = {0, s.begin()};
    st.i < SIZE; ++(st.i))
  st.hint = s.insert(st.hint, st.i); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-13T14:52:09.797

```
#include <algorithm>
#include <set>
#include <iterator>

int main()
{
    std::set<int> s;
    int i = 0;
    std::generate_n(std::inserter(s, s.begin()), 10, [&i](){ return i++; });
} 
```

这（我认为）相当于你的第二个版本，但恕我直言看起来好多了。

C++03 版本将是：

```
struct inc {
    static int i;
    explicit inc(int i_) { i = i_; }
    int operator()() { return i++; }
};

int inc::i = 0;

int main()
{
    std::set<int> s;
    std::generate_n(std::inserter(s, s.end()), SIZE, inc(0));
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-13T14:44:46.597

好吧，您可以使用可以提供位置作为提示元素可能插入的位置的`insert()`版本。`set<>`

```
iterator insert ( iterator position, const value_type& x ); 
```

`x`复杂性：这个版本通常是对数的，但如果在位置指向的元素之后插入，则摊销常数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-07-25T19:36:12.153

这可以在一行代码中完成。lambda 捕获可以将变量初始化`i`为`0`，可变说明符允许`i`在 lambda 函数内更新：

```
generate_n( inserter( s, s.begin() ), SIZE, [ i=0 ]() mutable { return i++; }); 
```

# character-encoding - Windows 7 中的错误字符集

> ID：11017203
> 
> 赞同：0
> 
> 时间：2012-06-13T14:34:28.550
> 
> 标签：character-encoding, decoding

我有一个大问题。我将 ffmpeg.exe 中的 raport 保存到 *.log 文件。

在脚本中，我将字符串从 utf8 解码为 windows1250（我来自波兰，我们有像“ą”或“ó”这样的字母）。

此解码在我的 Windows XP 中完美运行，但在我的朋友计算机中没有显示“±” - 显示“？”。他有 Windows 7。

你知道如何让它在所有 Windows 上运行吗？我真的需要代码才能在所有 Windows 机器上工作。

多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:38:37.573

使用[ked 编辑器](http://www.dobreprogramy.pl/kED,Program,Windows,11810.html)。

如果您使用它打开文件，请按 F4，然后您可以选择您想要的编码类型。只有在文件中是特殊字符时，它才会记住您的编码。否则没有必要保留和记住编码，并且将再次成为默认值

# database - 数据迁移工具和模式迁移工具

> ID：11017204
> 
> 赞同：2
> 
> 时间：2012-06-13T14:34:29.917
> 
> 标签：database, database-design, data-migration, database-migration

目前我们正在使用 Yii 框架进行 Web 开发。然而，一些开发人员建议使用 python。现在我们有大约 90 个表，并且将为我们的客户支持多个数据库系统，例如 mysql、sqlite、postgresql 等。我们希望 sql 文件（模式、索引、视图或其他）独立于数据库系统。所以请推荐一个不错的模式迁移工具，以及在这种情况下最适合的数据迁移工具是什么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T10:21:52.273

我的类似问题有很多答案[你能推荐一个不绑定到特定框架或 ORM 的数据库模式迁移工具吗？](https://stackoverflow.com/q/3923280/445073)鉴于您尚未确定您的 python web 框架，也许您还应该寻找一个不绑定到任何特定框架的迁移工具？这使您可以自由地独立更改框架和迁移工具。

我从来没有机会尝试我的问题答案中给出的任何建议，但我首先要调查的两个候选人是：

*   [sqlalchemy-迁移](http://code.google.com/p/sqlalchemy-migrate/)
*   [悠悠球迁移](http://pypi.python.org/pypi/yoyo-migrations/4.1.0)

# android - 手机的主动内存 - android

> ID：11017205
> 
> 赞同：0
> 
> 时间：2012-06-13T14:34:34.320
> 
> 标签：android, memory, ram

大家好，希望你们都做得很好，伙计们，我有一个问题，如果我们使用**adb shell cat /proc/meminfo**来获取 RAM 大小，我们如何获得 android 设备的活动、非活动和有线内存使用情况我得到一个大字符串这里有活动和非活动记忆是相同的代码

```
 ProcessBuilder cmd;

    StringBuffer strMemory = new StringBuffer();
    // final ActivityManager activityManager =(ActivityManager)
    // context.getSystemService(Context.ACTIVITY_SERVICE);

    ActivityManager actvityManager = (ActivityManager) this
            .getSystemService(ACTIVITY_SERVICE);
    ActivityManager.MemoryInfo mInfo = new ActivityManager.MemoryInfo();
    actvityManager.getMemoryInfo(mInfo);

    strMemory.append("Available Memory : ");
    strMemory.append(mInfo.availMem / 1048576L);
    strMemory.append("\n");
    strMemory.append("\n");

    String result = strMemory.toString();

    try {
        String[] args = { "/system/bin/cat", "/proc/meminfo" };
        cmd = new ProcessBuilder(args);

        Process process = cmd.start();
        InputStream in = process.getInputStream();
        byte[] re = new byte[1024];
        while (in.read(re) != -1) {
            // System.out.println("itthhe   ====  ---   >>>>    "+new
            // String(re));
            String str = new String(re);
            // int a = Integer.parseInt(str);
            System.out.println("oiiidd str 11111111111 --->>>   " +     str);
            // Long aa = Long.parseLong(str)/1048576L;
            String st = "Active";
            System.out.println("oii0--->>>>   "+st.substring(0,2));
            int l1 = st.length();

            if (l1 > 3) { l1 = 4; }

            System.out.println("oiiidd str  --->>>   " + str);
            if (str.startsWith(st.substring(0,l1))) 
            {
                System.out.println(str+"      -------------------printed dude ");
             // do something..
            }

            result = result + new String(re);
        }
        in.close();
    } catch (IOException ex) {
        ex.printStackTrace();
    }
    return result; 
```

现在从这里我得到大字符串

```
MemTotal:         256556 kB
MemFree:           93576 kB
Buffers:            1036 kB
Cached:            70064 kB
SwapCached:            0 kB
Active:            97496 kB
Inactive:          48828 kB
Active(anon):      79884 kB
Inactive(anon):        0 kB
Active(file):      17612 kB
Inactive(file):    48828 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:         75244 kB
Mapped:            36340 kB
Slab:               4528 kB
SReclaimable:       1448 kB
SUnreclaim:         3080 kB
PageTables:         6864 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:      128276 kB
Committed_AS:    1084956 kB
VmallocTotal:     712704 kB
VmallocUsed:       22596 kB
VmallocChunk:     684036 kB 
```

现在我如何解析活动和非活动数据，

有没有其他方法可以找到，或者这是找到这些数据的唯一方法`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:10:53.943

尝试查看 SDK 中的 DDMS

[http://developer.android.com/resources/articles/track-mem.html](http://developer.android.com/resources/articles/track-mem.html)

# jquery - 如何使用 Extjs 和 jQuery 拖放？

> ID：11017207
> 
> 赞同：0
> 
> 时间：2012-06-13T14:34:39.330
> 
> 标签：jquery, extjs, fullcalendar, extjs4.1

我有带有`gridviewdragdrop`插件和 jquery UI `Droppable`div 的 extjs 网格。

也许有人尝试在这两者之间编写某种代理？

我正在尝试`fullcalendar`通过从 Extjs 网格面板拖动将事件添加到（jquery 插件）。

谷歌没有那么有帮助。现在我正在尝试查看 jquery droppable 插件的源代码，也许我会找到一种方法来触发 drop 事件或其他东西，但这不太可能。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:24:04.647

您需要在 1 个库/框架下进行拖放操作。听上去，您正在使用 ExtJS 来拖动项目 - 并使用 jQuery 来设置放置空间。尝试使用 jQuery 来执行拖动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T20:05:24.047

因为您正在尝试将事件添加到日历中，所以您可以尝试[Ext.ensbile Calendar pro](http://ext.ensible.com/)。它们建立在 ExtJS 之上，并拥有不错的文档和示例。但是，您必须为商业用途付费。

我之前曾将它用于调度用例，并且比尝试与 jQuery 集成要容易得多

抱歉 - 这不是答案，但我的声誉不允许我对这个问题发表评论:(

# nservicebus - NServiceBus.Distributor 和 Master 节点有什么区别

> ID：11017211
> 
> 赞同：1
> 
> 时间：2012-06-13T14:34:46.593
> 
> 标签：nservicebus

我正在使用 NService 总线 3.0，我应该使用 Master 配置文件还是 NServiceBus.Distributor 进行负载平衡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T21:55:41.213

Master 配置文件本质上结合了 NServiceBus 2.6 Distributor 的职责以及作为工作节点本身，至少在负载分配方面。

Master 节点还根据其他配置执行其他操作，例如充当超时管理器、网关等。

另一方面，分发者配置文件仅将端点变成分发者。实际上，它就像一个 NServiceBus 2.6 分发器。它分发消息，但不参与自己的处理。

当您将一堆分发服务器放在故障转移集群上（阅读：昂贵）并且您不希望将这些昂贵的资源浪费在处理消息上时，分发服务器非常有用，因为您有更便宜的服务器来处理它。

有关详细信息，请参阅NServiceBus 文档中[有关配置文件的更多信息，特别是标题“功能相关配置文件”](http://docs.particular.net/nservicebus/hosting/nservicebus-host/profiles)

**编辑**

关于不在故障转移集群中运行 Worker 节点，似乎在 V3 中的设置并没有完全按照应有的方式设置，即（从概念上）在集群的主节点中运行分发器和超时管理器（没有工人），然后只将工人作为卫星运行。[有关更多信息，请参阅NServiceBus 讨论组中的](http://tech.groups.yahoo.com/group/nservicebus/message/17758)此线程以及[对此问题的此答案](https://stackoverflow.com/questions/14718083/what-is-the-correct-way-to-use-the-timeout-manager-with-the-distributor-in-nserv#answer-14723205)的评论。

# jasper-reports - 如何在 JasperServer 中嵌入字体“Courier New”

> ID：11017223
> 
> 赞同：0
> 
> 时间：2012-06-13T14:35:03.987
> 
> 标签：jasper-reports, jasperserver

我在报告中遇到问题，我在 ireport 中安装了 Courier New 字体，但是通过添加到报告服务器 JasperReport 没有与创建的字体一起出现。我无法安装扩展字体。我的环境是窗户。帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-03-25T10:09:29.397

这可能是迟到的答案，但由于我花了很多时间来寻找解决方案，我想分享它。要将字体添加到 JasperServer 以便在 PDF 导出中使用它们，需要执行以下步骤：

1.  在**webapps\jasperserver-pro\WEB-INF\lib**文件夹中找到**jasperreports-fonts-5.0.0.jar**文件（我使用的是 jasper server 5.5.0）
2.  下载所需的 TTF 字体（所有常规、**粗体**、*斜体*和***粗斜体***）
3.  在存档管理器中打开 jar (jasperreports-fonts-5.0.0.jar) 并转到 * *net\sf\jasperreports\fonts**文件夹
4.  使用您不想添加的字体创建文件夹（在我的情况下，这是**arial**）
5.  将下载的 TTF 放入此文件夹（在我的情况下，它们是 arial.ttf、arialbd.ttf、ariali.ttf 和 arialbi.ttf）
6.  通过添加以下节点来调整 Jar 中的 fonts.xml：

> ```
> <fontFamily name="Arial">
>   <normal>net/sf/jasperreports/fonts/arial/arial.ttf</normal>
>   <bold>net/sf/jasperreports/fonts/arial/arialbd.ttf</bold>
>   <italic>net/sf/jasperreports/fonts/arial/ariali.ttf</italic>
>   <boldItalic>net/sf/jasperreports/fonts/arial/arialbi.ttf</boldItalic>
>   <pdfEncoding>Identity-H</pdfEncoding>
>   <pdfEmbedded>true</pdfEmbedded>
>   <exportFonts>
>       <export key="net.sf.jasperreports.html">Arial, Helvetica, sans-serif</export>
>       <export key="net.sf.jasperreports.xhtml">Arial, Helvetica, sans-serif</export>
>   </exportFonts>
> </fontFamily> 
> ```

你完成了。现在您在包括 PDF 在内的所有导出中都有正确的 Arial 字体。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T10:07:00.953

您可能需要在 jasperserver 中安装字体。

[http://mdahlman.wordpress.com/2009/05/13/fonts-in-jasperserver/](http://mdahlman.wordpress.com/2009/05/13/fonts-in-jasperserver/)

# sql - 序列每 4 个 id 递增，而不是像我设置的那样每 1 递增一次。甲骨文

> ID：11017226
> 
> 赞同：2
> 
> 时间：2012-06-13T14:35:10.277
> 
> 标签：sql, oracle

我是 SQL 和 Oracle 的新手，所以为了练习，我创建了一个虚拟表来跟踪我的打字学习课程（因为我从来没有学过打字，所以我现在正在弥补它），并使用这个设置一个序列在 Oracle 中查询：

```
CREATE SEQUENCE seq_keyboard_learning
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10 
```

我的意图是让我的 id 列增加，但每次我添加一个新值时它都会从 1 跳到 5，等等。为了完整起见，以下是我在设置此表时使用的一些查询。

```
CREATE TABLE keyboard_learning
(
emplid NUMBER CONSTRAINT emplid_pk PRIMARY KEY
,WPM NUMBER
,date_completed DATE
)

CREATE SEQUENCE seq_keyboard_learning
MINVALUE 1
START WITH 1
INCREMENT BY 1
CACHE 10

INSERT INTO keyboard_learning (emplid,wpm,date_completed)
VALUES (seq_keyboard_learning.nextval,15,'12-JUN-2012')

UPDATE keyboard_learning 
SET emplid = 1
WHERE emplid = 4

ALTER TABLE keyboard_learning
ADD attempt VARCHAR2(45)

INSERT INTO keyboard_learning
VALUES (seq_keyboard_learning.nextval,26,'6-JUN-2012','ASDFJKL:',2) 
```

而不是每 4 个术语增加一次，我该如何调整？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T01:29:13.240

确保你有一个没有间隙的序列基本上是不可能的。请记住，从序列中获取是原子操作，因此如果您插入记录并遇到错误，序列仍将递增。请参见下面的示例。

拥有缓存也可能导致您“丢失”序列。如果我在缓存中指定值 10，数据库将从序列中缓存 10。如果只插入 2 行并关闭数据库，则丢弃其他 8 行。注意：由 Alex Poole 编辑并更正。

我希望这有助于理解序列的一些行为。

```
create table test
(id     number,
my_date date);

select seq.currval from dual;

insert into test
(id, my_date)
values (seq.nextval, 'foo'); -- will throw an exception

select seq.currval from dual; 
```

结果是：

```
table TEST created. 
CURRVAL
-------
      1 

Error starting at line 31 in command: insert into test (id, my_date) values (seq.nextval, 'foo') Error report: SQL Error: ORA-01858: a non-numeric character was found where a numeric was expected
01858\. 00000 -  "a non-numeric character was found where a numeric was expected"
*Cause:    The input data to be converted using a date format model was
           incorrect.  The input data did not contain a number where a number was
           required by the format model.
*Action:   Fix the input data or the date format model to make sure the
           elements match in number and type.  Then retry the operation. 
CURRVAL
-------
      2 
```

# asp.net - AsyncFileUpload - 附加的文件无效

> ID：11017233
> 
> 赞同：1
> 
> 时间：2012-06-13T14:35:32.163
> 
> 标签：asp.net, asyncfileupload

当我使用 asyncfileupload 控件上传图像时出现错误。

我收到错误“附加的文件无效”。

在我的本地机器上这工作正常，但它在我的实时服务器上不起作用。

我尝试了将 ClientIDMode="AutoID" 放在控件上但没有运气的修复程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T05:02:30.410

检查您是否对服务器和客户端上的文件拥有权限。还要检查您为读取和写入文件设置的路径字符串

# .net - .net 中集中式 DB 应用程序的设计/架构建议

> ID：11017234
> 
> 赞同：0
> 
> 时间：2012-06-13T14:35:34.830
> 
> 标签：.net, sql, entity-framework, c#-4.0

我是一名初级 .NET 程序员。我必须开发一个应用程序，在本地环境中为少数用户（大约 8 个）处理销售、客户和供应商（还有很多事情）。应该使用集中式数据库创建整个内容以供本地使用。我的架构从上到下都是这样的：

1.Windows窗体上的UI。

2.处理用户请求的控制器

3.Bussines 对象是实体框架生成的对象

4.SQL数据库。

显然我已经知道这不是架构的最佳方法，但我希望它尽可能简单。我已经做了很多研究，但是问题的数量似乎越来越多，所以我一直在寻找针对这个特定问题的一些指导，这样我就可以在获得我觉得很舒服的推荐架构后专注于研究。很抱歉提出这个问题，我只是对选项感到不知所措。

Tnx 帮助新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T17:36:27.943

正如您所说，生成了实体框架对象，您可能希望在控制器和实体对象之间具有一个或多个模型级别。一个特定的视图通常具有来自多个实体的数据。如果您没有控制器可以访问的其他级别的模型，通常会发生业务逻辑迁移到控制器。

换句话说，控制器将创建模型，模型将知道如何与实体交互。

请注意，我假设您使用的是 MVC 模式，因为您在 #2 中引用了控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T16:23:14.817

您所描述的似乎是初级开发人员级别的好方法。

有许多因素会影响适合项目的架构。与一次性应用程序相比，时间、进度、金钱、简单性或复杂性、可维护性和未来开发扩展。由于数据模型或与某些未知系统的集成，未来的版本是否可能需要大规模重写？

在第一次迭代之后，没有任何应用程序是完美的。随着技术技能和知识的增长，任何优秀的开发人员都会在项目完成后找到无数种改进项目的方法。

话虽如此，数据库和实体框架方面的东西非常好。EF 将使您快速专注于功能而不是基础设施。您可能已经将 EF 与其他对象模型套件或基于传统存储过程的方法进行了权衡。

UI 可能由客户或业务需求决定。这里唯一的另一个重大决定可能是 Intranet Web 应用程序，因此您不必担心在用户计算机上安装软件。

控制器/类库/业务层很有意义，因此您不必直接在您的 winforms 代码中编写针对 EF 的查询。这使您可以更轻松地删除 UI 并将其替换为其他内容。

在不知道确切情况的情况下，您概述的任何内容都不会引发任何危险信号。继续采用这种方法，看看它是如何进行的。完成后，请考虑架构的哪些方面难以处理、冗余或其他麻烦。

# gwt - 在 GWT UIBinder 下命名事件处理程序

> ID：11017235
> 
> 赞同：0
> 
> 时间：2012-06-13T14:35:36.017
> 
> 标签：gwt, uibinder

在 GWT UIBinder 下命名事件处理程序是否有特殊限制？

界面模板：

```
<g:Button ui:field="myButton" /> 
```

以下是我见过的一些有效变体，用于命名（'/' 符号分隔不同方法名称）的`click`事件处理程序，`button`

```
@UiHandler("myButton")
public void onClick / onClickButton / handleClick(ClickEvent e) {} 
```

在我看来，事件处理程序可以随意命名。它由`annotation`和`event parameter`而非来标识`method name`，即“myButton”和“ClickEvent”，而不是上面示例中的“onClick/onClickButton/handleClick”。

我错过了什么吗？

**@编辑**

当然，如果两个处理程序恰好属于相同类型的`event parameter`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:49:30.190

方法的名称没有限制。但是它不能是私有的。它适用的小部件由注释的值确定，处理的事件类型由方法的参数确定。这篇文章对这个主题有一个很好的答案：[@UiHandler 的文档](https://stackoverflow.com/a/3441082/405492)

# .net - 单击一次失败，出现奇怪的 404 ，未知子类型

> ID：11017236
> 
> 赞同：0
> 
> 时间：2012-06-13T14:35:37.177
> 
> 标签：.net, iis-7.5, clickonce

尝试运行后单击（Wpf 应用程序、.NET4、IIS 7.5）。在解决了前十几个问题之后，我现在似乎陷入了困境。Clickonce 失败并显示 404，说明“未知子类型”错误。我已经将所有必需的文件类型添加到 IIS mimetypes，所以这不是问题（.application、.manifest、.deploy、.msp、.msu）。更重要的是，当我使用“使用 .deploy”选项创建清单时，所有文件实际上都具有 .deploy 扩展名。

奇怪的是，错误消息指出：无法下载“http://myserver/1.0.0.0/mysubdir/my.diverse.namespaces.xyz”

在 IE 中输入 URL“http://myserver/1.0.0.0/mysubdir/my.diverse.namespaces.xyz”确实会产生 404，但在 URL 末尾添加“.deploy”可以很好地下载文件。我检查了清单文件，它列出了所有带有 .deploy 扩展名的文件。这没有任何意义。为什么应用程序尝试使用错误的文件名进行访问？或者这是一个不同的问题？

任何帮助将不胜感激。

编辑：再次创建清单后，清单中列出的文件没有“.deploy”扩展名。.xml 文件现在下载失败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T07:53:37.823

您需要定义的 MIME 类型在[这里](http://robindotnet.wordpress.com/2010/06/12/mime-types-for-clickonce-deployment/)——您错过了 XAML。

当然，将 .deploy 添加到 URL 是可行的——除了 (IIRC) 两个清单（yourapp.exe.manifest 和 yourapp.application）之外，文件都应该以 .deploy 结尾。我们曾经遇到过这个问题，它会无缘无故地停在一个特定的文件上。我不记得到底是什么问题。我会检查我的笔记并报告。同时，您有代理服务器吗？IE中有代理设置吗？

# css - H3 在 IE7 中自动为 100% 宽度

> ID：11017237
> 
> 赞同：1
> 
> 时间：2012-06-13T14:35:37.797
> 
> 标签：css, internet-explorer-7

嗨，我创建了一个`h3`居中并使用 a`background-image`和`padding`. 它在所有浏览器中看起来都很好（即它`h3`是其中文本的宽度，加上填充），除了 IE7，它`h3`似乎默认为 100% 宽度。我不想设置静态宽度，因为我需要它根据文本调整大小。有任何想法吗？这是网站：

*   [http://www.firecrestmoto.co.uk/index.php](http://www.firecrestmoto.co.uk/index.php)（这是“我们的最新到货”文本）

```
h3.bannerh3 {
    font-family: "alternate-gothic-no-1-d",sans-serif;
    font-style: normal;
    font-weight: 400;
    color: #fff;
    text-transform: uppercase;
    font-size: 64px;
    height: 78px;
    display: inline-block;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 10px;
    position: relative;
    text-shadow: 0px 0px 10px #000000;
    filter: dropshadow(color=#000000, offx=0, offy=0);
    background: url('../../../../img/h2top3.png') repeat-x top, url('../../../../img/h2bottom3.png')  repeat-x bottom;
    -pie-background: url('/img/h2top3.png') repeat-x top, url('/img/h2bottom3.png')  repeat-x bottom; /*PIE*/
    behavior: url(js/pie/PIE.htc);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:40:12.683

不能`inline-block`在 IE7 中使用。请尝试以下操作：

```
display: inline-block;
zoom: 1;
*display: inline; 
```

第二个`display`属性将由 IE7 解释，并将元素设置为`inline`. 不幸的是，这将阻止您在 IE7 中拥有您想要的样式，因为`inline`它们`inline-block`并不完全相同。

如果需要进一步的样式，条件注释可能更合适：

```
<!--[if lte IE 7]>
    <style type="text/css">
        h3.bannerh3 {
          display: inline;
          /* Additional styles here */
        }
    </style>
<![endif]--> 
```

# javascript - 最大高度/最大宽度在 Firefox 中不起作用，即

> ID：11017240
> 
> 赞同：1
> 
> 时间：2012-06-13T14:35:41.337
> 
> 标签：javascript, firefox, gallery, css

我试图为我的网站创建一个画廊，所以我使用 max-height/width 来调整照片的大小，它在 firefox 和 ie 中不起作用。我也试过溢出：隐藏，并没有修复它。[您可以在我的网站（ http://guyzyl.org/highlights.html](http://guyzyl.org/highlights.html)）上查看问题（在 firefox 和 ie 中），单击任何照片即可查看问题。提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T14:38:56.153

问题是您为这些属性分配了错误的值。例如，您将宽度设置为“100%”。该百分比是指容器元素的宽度，其宽度是整个窗口的宽度。这张照片在左边被那个巨大的箭头所抵消，因此从屏幕上溢出到右边。

您应该只使用 Firebug 来处理属性值以提出适当的东西。您也应该考虑使用百分比来调整箭头控件的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:41:50.927

```
vertical-align: top; 
```

在您的图像上似乎有所帮助，但是您应该接受@Pointy 的建议，因为他说的是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:42:25.783

用百分比设置高度是有问题的。尝试在那里使用像素，并注意图像在设置宽度和高度时的行为与其他块元素不同。

我会使用带像素的最大高度并使用百分比设置最大宽度..

# mobile - 如何在 Liferay Portal 的移动设备页面上隐藏 portlet？

> ID：11017246
> 
> 赞同：1
> 
> 时间：2012-06-13T14:36:24.597
> 
> 标签：mobile, themes, liferay

我正在使用移动设备规则为不同的移动设备设置操作。我设置了两个操作：1\. 将布局更改为一列，2\. 将主题更改为显示块菜单和 WebContent 显示列的移动主题。

我需要从移动版本中隐藏桌面版本上的 portlet：即。相关资产 portlet，从移动设备查看页面时的广告 portlet。我需要以最简单的方式完成此任务。portlet 配置设置是否可以更改以指示它们是否使用移动设备显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T10:07:34.453

在 Liferay 支持的帮助下找到了我的问题的解决方案。隐藏 portlet 的两种可能方式：

1.  向移动设备规则插件添加自定义操作。
2.  扩展 Liferay 的呈现逻辑：读取 http 属性并确定浏览器是否是移动的，并隐藏您需要的 portlet。例如，对 render_portlet.jsp 使用挂钩并使用以下内容进行自定义：

    if (BrowserSnifferUtil.isMobile(request)) { if("1_WAR_webformportlet_INSTANCE_qlQYswM4fJFO".equals(portletId)) { //example supportsMobile = false; } }

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:28:40.473

一种可能性是在移动主题中隐藏您的“相关资产portlet”。此解决方案的缺点是您传输不可见的标记。

其他解决方案是为移动设备创建一个页面，该页面不包含“相关资产 portlet”。然后，如果用户从移动设备访问原始页面，则创建重定向用户的移动规则。

# java - 优化 GC 运行时间

> ID：11017249
> 
> 赞同：2
> 
> 时间：2012-06-13T14:36:40.077
> 
> 标签：java, optimization, garbage-collection

我正在比较我们一个项目的两个分支的性能，一个比另一个慢得多。我注意到一个的 GC 运行计数更高（见下图）。

![运行](../Images/c1daa95776d94456fc64fbdb3a0a1e6c.png)

更有趣的是，运行时间要高很多倍，远远超过额外运行所能解释的。什么可以解释运行次数增加 40%（ish），运行时间增加了 6 倍？更大的物体？对象太多？还有哪些旋钮可以在这里调整，有什么效果？（一些好的链接可以作为答案）

![时间](../Images/84474c153e731a3f7a6201f257eac57e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T00:56:16.800

以下是一些基本指南，可帮助您分析应用程序的两个分支/版本的性能和 GC 行为：

1.  **评估**两个应用程序的 GC 行为：
    *   收集 GC 日志并计算**Live Data Set**大小、**分配率**、**提升率**和**总 GC**时间。这应该允许您凭经验比较两个应用程序的 GC 行为。
    *   您应该比较应用程序之间的这些 GC 统计信息，您是否看到两个应用程序之间的任何峰值/差异。
    *   请参阅此处了解如何收集这些数据：[是否有针对 GC 问题的食谱指南？](https://stackoverflow.com/q/6871213/772000)
2.  **收集**类**直方图**
    *   如果你会在步骤 1 中确认确实存在主要的 GC 差异，请尝试收集 Class Histograms 以查看哪些类占用了堆。**比较两个应用程序之间的直方图**，看看类类型、实例数量是否有任何差异。这应该可以帮助您确定罪魁祸首。
    *   在 FullGC 之前/之后收集直方图： `-XX:+PrintClassHistogramBeforeFullGC -XX:+PrintClassHistogramAfterFullGC`
    *   而且，您可以`jmap -histo $pid`在运行期间随时收集快照。特别是如果您看到可疑的响应时间/CPU 峰值等。
3.  **使用Java**分析工具分析内存
    *   收集两个应用程序的配置文件并进行比较，
    *   我会推荐**jProfiler**。

**性能比较的基本准则**：为了有效地比较性能，您需要能够为应用程序的两个版本**生成相同的工作负载，运行一些预热时间，然后****在稳定**阶段收集数据。

# c# - 如何通过使用c#.net传递参数来为动态线程设置计时器

> ID：11017251
> 
> 赞同：0
> 
> 时间：2012-06-13T14:36:44.657
> 
> 标签：c#, multithreading, timer

嗨，我正在使用一个窗口服务应用程序，它具有动态线程生成的逻辑，它将用于创建一个基于单独线程的从 xml 文件中为每个单独的属性 id 获取数据，现在我担心的是我想在其中运行这些每个线程不同的时间间隔，一个线程每5分钟触发一次，另一个线程用于每天模式触发，最后一个线程应该按月触发，你能帮我看看我在想什么，当我启动一个窗口服务，所有要启动的线程，这些生成的线程即使暂时工作完成也不应该死掉，我们需要根据上面我说的为这些线程设置一个计时器，我们如何执行这个好心的建议...

下面我粘贴了相同的动态线程逻辑代码：

我想知道如何为每个不同的线程设置计时器

```
static void Main(string[] args)
{
    var currentDir = Directory.GetCurrentDirectory();
    var xDoc = XDocument.Load(string.Format(Path.Combine(currentDir, "Hosts.xml")));
    var threads = new List<Thread>();

    foreach (XElement host in xDoc.Descendants("Host"))
    {
        var hostID = (int)host.Attribute("id");
        var extension = (string)host.Element("Extension");
        var folderPath = (string)host.Element("FolderPath");
        var thread = new Thread(DoWork)
        {
            Name = string.Format("samplethread{0}", hostID)
        };

        thread.Start(new FileInfo
        {
            HostId = hostID,
            Extension = extension,
            FolderPath = folderPath
        });

        threads.Add(thread);
    }

   // Carry on with your other work, then wait for worker threads
   threads.ForEach(t => t.Join());
}

static void DoWork(object threadState)
{
    var fileInfo = threadState as FileInfo;

    if (fileInfo != null)
    {
         // Do stuff here
    }        
}

class FileInfo
{
    public int HostId { get; set; }
    public string Extension { get; set; }
    public string FolderPath { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:44:59.703

您的线程将运行然后再次停止。已停止的线程无法再次启动。您需要某种类型的循环来保持线程运行。

这是对您的代码的修改，我在其中编写了一个类来围绕您的 DoWork 函数包装这样的循环：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Xml.Linq;
using System.Threading;

namespace App
{
    class FileInfo
    {
        public int HostId { get; set; }
        public string Extension { get; set; }
        public string FolderPath { get; set; }
    }

    class ThreadSet
    {
        public ThreadStart action;
        public FileInfo file;
        public string name;
        public Boolean shouldrun = true;
        public Thread thread;

        public ThreadSet(XElement host, Action<Object> threadaction)
        {
            int hostID = (int)host.Attribute("id");
            name = string.Format("samplethread{0}", hostID);
            file = new FileInfo
                {
                    HostId = hostID,
                    Extension = (string)host.Element("Extension"),
                    FolderPath = (string)host.Element("FolderPath")
                };
            action = () =>
            {
                while (shouldrun)
                {
                    threadaction(file);
                }
            };
            thread = new Thread(action);
            thread.Name = name;
        }

        public void Start()
        {
            thread.Start();
        }

        public void Join()
        {
            shouldrun = false;
            thread.Join(5000);
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            var currentDir = Directory.GetCurrentDirectory();
            var xDoc = XDocument.Load(string.Format(Path.Combine(currentDir, "Hosts.xml")));
            var threads = new List<ThreadSet>();

            foreach (XElement host in xDoc.Descendants("Host"))
            {
                ThreadSet set = new ThreadSet(host, DoWork);
                set.Start();
                threads.Add(set);
            }
            //Carry on with your other work, then wait for worker threads
            threads.ForEach(t => t.Join());
        }

        static void DoWork(object threadState)
        {
            var fileInfo = threadState as FileInfo;
            if (fileInfo != null)
            {
                //Do stuff here
            }
        }
    }
} 
```

# algorithm - 算法 - 如何有效地确保每个数组中的元素是不同的？

> ID：11017254
> 
> 赞同：2
> 
> 时间：2012-06-13T14:37:05.143
> 
> 标签：algorithm, data-structures

我不知道如何写这个问题的标题。现有标题可能不准确。

这是问题所在：

我有`m`组（数组），比如 4 个组。每个组包含一些数字。我们希望每组给出一个数字，并且总共产生的 4 个数字（每个来自一组）是不同的。

现在给定这 4 组，我如何确保它们符合我们的愿望？

* * *

例如，

答：0、2、3

乙：0、2

C: 2, 3

D: 1

以上4组可以满足我们的愿望。D给1，C给3，B给2，A给0。

* * *

但如果

A2

乙：2

C: 2, 3

D: 1

不好。我们不能让每个组给出一个不同的数字。

* * *

我的想法是最愚蠢的方法，我只是对所有组中的所有元素进行回溯，以获取元素的每种组合，并查看来自一个组合的那些元素是否不同。

有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:45:17.137

您可以将此建模为网络流问题，然后在该问题域（其中许多是多项式时间）中使用快速算法，例如[Edmunds-Karp](http://en.wikipedia.org/wiki/Edmonds%E2%80%93Karp_algorithm)或[push-relabel](http://en.wikipedia.org/wiki/Push-relabel_maximum_flow_algorithm)。

创建源节点和汇节点。然后为每个“组”和每个不同的元素创建节点。将每个组节点连接到源，将每个元素节点连接到接收器。如果组作为元素，最后将组节点与元素节点连接起来。所有流量都应为 1。

最好用一个例子来说明这一点。我将使用您给出的第一个示例：

```
A: 0, 2, 3
B: 0, 2
C: 2, 3
D: 1 
```

会变成如下流网络：

```
 A   0
  /     \
 /       \
S--B   1--T
 \       /|
  \     / |
   C   2 /
        /
       3 
```

我无法绘制中间流。但是想象一下，A 流向 0、2、3，B 流向 0、2，C 流向 2、3，D 流向 1。所有流向都是单位容量。

所以首先在这个图中找到最大流量。组和元素之间的流将为您提供所需的二分匹配。

如果没有可能的匹配，则最大流量将小于组数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:44:53.927

你想要的被称为[http://en.wikipedia.org/wiki/Bipartite_graph](http://en.wikipedia.org/wiki/Bipartite_graph)并且你有一个适用于它的[http://en.wikipedia.org/wiki/Maximum_flow_problem#Maximum_cardinality_bipartite_matching](http://en.wikipedia.org/wiki/Maximum_flow_problem#Maximum_cardinality_bipartite_matching)。您可以在以下名称下找到算法：Maximum cardinality bipartite matching or maximum flow on a bipartite graph。这是很好的解释[http://en.wikipedia.org/wiki/Maximum_matching](http://en.wikipedia.org/wiki/Maximum_matching)和[http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=maxFlow](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=maxFlow) , [http://community.topcoder.com/tc ?module=Static&d1=tutorials&d2=maxFlow2](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=maxFlow2) 希望有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:49:18.483

*   一种想法是寻找所有组独有的元素，并将它们用于它们所属的组；这会将列表缩小到仅具有共同元素的组。

*   另一个想法是从元素最少的组开始（理想情况下是一个），将它们设置为其中一个值并迭代增加大小（您可以在删除已使用的元素后考虑大小）。

# javascript - 如何遍历 jsRender 模板中的 JSON 数组？

> ID：11017255
> 
> 赞同：4
> 
> 时间：2012-06-13T14:37:05.743
> 
> 标签：javascript, jsrender

我有这个 HTML 和 jsRender 模板：

```
<div id="output"></div>

<script id="template" type="text/x-jsrender">
<ul>
    {{for}}
    <li>{{:name}} likes to wear {{:shirtColor}} shirts</li>
    {{/for}}        
</ul>
</script>​ 
```

我有这样的javascript（jQuery）：

```
var data = [{
    name: 'Dan Wahlin',
    shirtColor: 'white'},
{
    name: 'John Papa',
    shirtColor: 'black'},
{
    name: 'Scott Guthrie',
    shirtColor: 'red'}
]
;

$('#output').html($('#template').render(data));​ 
```

有些人可能会看到，这是 John Papa 的一个例子。也就是说，我稍微修改了一下。但它不能正常工作。原因是 jsRender 期望 Json 中有一个根对象，如 Johns 示例中 {{for}} 是 {{for people}} 并且数据对象如下所示：

```
var data = { people: [{
    name: 'Dan Wahlin',
    shirtColor: 'white'},
{
    name: 'John Papa',
    shirtColor: 'black'},
{
    name: 'Scott Guthrie',
    shirtColor: 'red'}
]
}
; 
```

在我的 ASP.NET MVC 控制器中，返回的 Json 不带有根对象。我怎样才能使它工作？更改 Json 格式（我该怎么做？）？还是我在我的 jsRender 代码中做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T14:36:15.580

I had the same problem. The following should do the trick for you:

```
<script id="template" type="text/x-jsrender">
    <ul>
        {{for #data}}
            <li>{{>name}} likes to wear {{>shirtColor}} shirts</li>
        {{/for}}
    </ul>
</script> 
```

This allows you to loop over the array passed into the render method instead of the individual item as in Jesus's answer.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T18:08:10.970

将模板更改为：

```
<ul id="output"></ul>
<script id="template" type="text/x-jsrender">
    <li>{{:name}} likes to wear {{:shirtColor}} shirts</li>
</script>​ 
```

必须工作。因为当你渲染一个带有数组对象的模板时，他渲染了 n 次同一个模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T11:17:38.607

将 {{for}} 更改为 {{for people}}

# iphone - xcode ios：将核心数据包含到旧项目后崩溃

> ID：11017256
> 
> 赞同：0
> 
> 时间：2012-06-13T14:37:06.157
> 
> 标签：iphone, ios, xcode, ipad, core-data

我有一个正在修改的工作项目，

它在尝试使用 coredata 后崩溃，

项目之前没有coredata，所以加了，

就像以前的基础 sdk [number??] 一样，`applicationDocumentsDirectory`返回一个 NSString，而不是 URL，

我已经把它改成工作了？？但在尝试使用 coredata 时崩溃，

```
#import "QRGenAppDelegate.h"

//#import "QRGenViewController.h"

#import "MainViewController.h"

@implementation QRGenAppDelegate

//@synthesize window; //viewController

@synthesize window = _window;
@synthesize navigationController = _navigationController;
@synthesize managedObjectModel = __managedObjectModel;
@synthesize managedObjectContext = __managedObjectContext;
@synthesize persistentStoreCoordinator = __persistentStoreCoordinator;

- (void)dealloc
{
    [__managedObjectModel release];
    [__managedObjectContext release];
    [__persistentStoreCoordinator release];
    [_window release];
    [_navigationController release];

    //[viewController release];
    [super dealloc];
}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
    // Override point for customization after application launch.

    MainViewController *menuVC= [[[MainViewController alloc]init]autorelease];

    self.navigationController = [[UINavigationController alloc]initWithRootViewController:menuVC];

    //self.window.rootViewController = menuVC;

    self.navigationController.navigationBar.hidden = YES;

    [self.window addSubview:self.navigationController.view];

    self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];

    return YES;
}

//CD

//Explicitly write Core Data accessors
- (NSManagedObjectContext *) managedObjectContext {
    if (__managedObjectContext != nil) {
        return __managedObjectContext;
    }
    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        __managedObjectContext = [[NSManagedObjectContext alloc] init];
        [__managedObjectContext setPersistentStoreCoordinator: coordinator];
    }

    return __managedObjectContext;
}

- (NSManagedObjectModel *)managedObjectModel {
    if (__managedObjectModel != nil) {
        return __managedObjectModel;
    }
    __managedObjectModel = [[NSManagedObjectModel mergedModelFromBundles:nil] retain];

    return __managedObjectModel;
}

- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    if (__persistentStoreCoordinator != nil) {
        return __persistentStoreCoordinator;
    }

    //mi solucto!!

    //NSURL *storeURL= [NSURL URLWithString:[[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"ClientOcci.sqlite"]];
    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"db.sqlite" ofType:nil];

    NSURL *storeURL = [NSURL URLWithString:filePath];

   // NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"ClientOcci.sqlite"];
    //NSURL *storeURL = [[self applicationDocumentsDirectory]    URLByAppendingPathComponent:@"ChildCare_v02.sqlite"]; //actual SDK style for blank db

    NSError *error = nil;
    __persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if (![__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error]) {

        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }    

    return __persistentStoreCoordinator;
}

#pragma mark - Application's Documents directory

// Returns the URL to the application's Documents directory.
+ (NSString*)applicationDocumentsDirectory {

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    return documentsDirectory;
}
//CD 

- (void)applicationWillResignActive:(UIApplication *)application
{
}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
}

- (void)applicationDidBecomeActive:(UIApplication *)application
{
}

- (void)applicationWillTerminate:(UIApplication *)application
{
}

@end 
```

它崩溃了：

```
__managedObjectModel = [[NSManagedObjectModel mergedModelFromBundles:nil] retain];

EXC_BAD_ACCESS 
```

所以我如何在项目设置中尝试制作基本 SDK 5.1 但仍然崩溃，

为什么我的项目不喜欢 URL 作为返回方法？如何解决？如果我将其更改为较新的 SDK 会以其他方法制动吗？

编辑>>我已经尝试过@ierror的建议，

添加到我的rootVC：

```
if (managedObjectContext == nil) { 
        managedObjectContext = [(QRGenAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext]; 
        NSLog(@"After managedObjectContext: %@",  managedObjectContext);} 
```

但是现在在appDelegate中崩溃了，

在

```
- (NSManagedObjectModel *)managedObjectModel {
    if (__managedObjectModel != nil) {
        return __managedObjectModel;
    }
    __managedObjectModel = [[NSManagedObjectModel mergedModelFromBundles:nil] retain]; // crashes here!!!

    return __managedObjectModel;
} 
```

该怎么办？

多谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:46:50.230

参考这个关于堆栈溢出的问题

[核心数据错误 iPhone](https://stackoverflow.com/questions/8963815/core-data-error-iphone/8967935#8967935)

它将解决您的问题

# asp.net - 使用 ADFS 和 WIF 存储基于角色的权限

> ID：11017258
> 
> 赞同：1
> 
> 时间：2012-06-13T14:37:07.013
> 
> 标签：asp.net, permissions, wif, adfs, xacml

我正在开发一个项目，该项目使用 Active Directory 获取用户信息，ADFS 用于身份验证和 SSO，以及几个使用 ASP.NET MVC 构建的自定义应用程序。

授权模型是声明和基于角色的；也就是说，用户的角色可以通过 ADFS 颁发的令牌（使用 WIF）作为对相关应用程序的声明进行访问。

每个角色都有针对应用程序的各种资源的已定义权限列表（即角色管理员对资源 X 具有 WRITE 权限）。我们的基本授权模型与一些硬编码的权限配合得很好。

我的问题是：存储各种角色的实际权限的最佳方式/位置是什么？这可以在 ADFS 中完成还是需要单独的存储（我猜是后者）？权限遵循与 XACML (user/role:resource:action) 相同的广泛模式，并且 XACML 解决方案可能很容易合并，但 XACML (XACML.NET) 的最流行的 .NET 实现似乎使用 XML 作为唯一的不可行的存储机制（我们有很多资源来存储权限 - 可能有数千个）。

人们为此使用什么？最明显的解决方案似乎是将三元组存储在 SQL Server 中，但考虑到所有现成的身份验证解决方案（尤其是使用 ADFS 和 WIF），实际实现授权和权限的信息如此之少（明显）似乎很奇怪。我在网上找到的所有示例都没有解释权限级别的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T01:31:56.033

ADFS 通常是共享基础架构组件。将应用程序特定知识（如应用程序特定权限）迁移到其中的问题在于，随着时间的推移，可能会成为管理瓶颈。问问自己：随着时间的推移，谁将管理这些权限？您是否必须提交表格以供某人批准？这很可能是个问题。它会起作用，但会很麻烦。

一般来说，ADFS 应该提供每个人都可以从中受益的跨应用程序属性（例如，所有基于 AD 的属性、公司范围的属性、人力资源相关信息都是很好的例子）。

当然，您可以让 ADFS 从以分布式方式管理的数据库中提取数据。

在某些情况下，人们会部署特定于应用程序的 STS（通常称为“RP-STS”），将令牌转换为应用程序（或应用程序组）期望的东西。例如，SharePoint 就是这样做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T18:02:54.263

最简单的方法是将权限存储在 SQL Server 中，然后使用 ADFS 中的自定义[SQL Server 属性存储](http://msdn.microsoft.com/en-us/library/ee895358.aspx)来检索值。

[您可以使用声明规则](http://technet.microsoft.com/en-us/library/dd807118%28WS.10%29.aspx)执行一些逻辑，但在 ADFS 本​​身中确实没有存储此类任何内容的好地方。

# android - 使用 Intent.ACTION_SEND_MULTIPLE android 发送带有多个附件的邮件的 Uri 问题

> ID：11017259
> 
> 赞同：0
> 
> 时间：2012-06-13T14:37:09.123
> 
> 标签：android, email, email-attachments

我正在尝试通过 android 中的默认邮件客户端发送邮件。此邮件可能有多个附件（最多 4 个图像和一个音频）。

在这里，用户可以使用相机拍照或选择现有图像。所以，我使用带有动作“Intent.ACTION_SEND_MULTIPLE”的 Intent，并将 Uris 的 Arraylist 作为 ParcelableArrayListExtra 传递给附加文件的意图。

在这里的其他线程中，我发现建议使用 file://something Uri 但如果我这样做，则没有附加文件。但是，如果我使用 content://something Uri，那么文件会很好地附加。但我有一个严重的问题。当我从 galary 中选择图像时，图像会正确附加，但如果我用相机拍照，则会返回 content://somehitng uri 并正确添加到 ParcelableArrayList 但没有附加刚刚拍摄的图像，但 galary 图像是附上就好了。

这是我的代码...

```
package com.ayon.camera;

import java.util.ArrayList;

import android.app.Activity;
import android.content.ContentValues;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

public class CameraActivity extends Activity {
    /** Called when the activity is first created. */
    Button add1, add2, mail;
    ImageView image1, image2;
    Uri uri1 , uri2 ;
    ArrayList<Uri> list ;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        add1 = (Button) findViewById(R.id.add1);
        add2 = (Button) findViewById(R.id.add2);
        mail = (Button) findViewById(R.id.mail);
        image1 = (ImageView) findViewById(R.id.image1);
        image2 = (ImageView) findViewById(R.id.image2);

        list = new ArrayList<Uri>();

        add1.setOnClickListener(new OnClickListener() {

            public void onClick(View arg0) {
                String fileName = "temp.jpg";
                ContentValues values = new ContentValues();
                values.put(MediaStore.Images.Media.TITLE,
                        fileName);
                uri1 = getContentResolver()
                        .insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                                values);

                Intent intent = new Intent(
                        MediaStore.ACTION_IMAGE_CAPTURE);
                intent.putExtra(MediaStore.EXTRA_OUTPUT,
                        uri1);
                startActivityForResult(intent, 100);
            }
        });

        add2.setOnClickListener(new OnClickListener() {

            public void onClick(View arg0) {
                String fileName = "temp.jpg";
                ContentValues values = new ContentValues();
                values.put(MediaStore.Images.Media.TITLE,
                        fileName);
                uri2 = getContentResolver()
                        .insert(MediaStore.Images.Media.EXTERNAL_CONTENT_URI,
                                values);

                Intent intent = new Intent(
                        MediaStore.ACTION_IMAGE_CAPTURE);
                intent.putExtra(MediaStore.EXTRA_OUTPUT,
                        uri2);
                startActivityForResult(intent, 101);
            }
        });

        mail.setOnClickListener(new OnClickListener() {

            public void onClick(View arg0) {
                Intent intent = new Intent(Intent.ACTION_SEND_MULTIPLE);
                intent.setType("text/plain");
                intent.putExtra(Intent.EXTRA_EMAIL, new String []{"ashiq.ayon@gmail.com"});
                intent.putExtra(Intent.EXTRA_SUBJECT, "Test Mail");
                //intent.putExtra(Intent.EXTRA_STREAM, uri1);
                intent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, list);
                startActivity(Intent.createChooser(intent, "Sending Mail"));
            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        // TODO Auto-generated method stub
        super.onActivityResult(requestCode, resultCode, data);

        if(requestCode == 100 && resultCode == RESULT_OK){
            System.out.println("Uri 1 = " + uri1);
            list.add(uri1);
            image1.setImageURI(uri1);
        }

        if(requestCode == 101 && resultCode == RESULT_OK){
            System.out.println("Uri 2 = " + uri2);
            list.add(uri2);
            image2.setImageURI(uri2);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T17:03:26.970

尝试这个：

发送意图时：

```
File scrapFile = new File(path, "path/to/file");
intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(scrapFile)); 
```

在 onActivityResult 中：

```
File file = new File("path/to/file");
Uri uri = Uri.fromFile(file); 
```

# jquery-mobile - Datepicker jquery mobile更改当天的颜色

> ID：11017265
> 
> 赞同：0
> 
> 时间：2012-06-13T14:37:36.827
> 
> 标签：jquery-mobile, datepicker, jquery-ui-datepicker

可以通过jquery mobile 的datepicker 改变当天的颜色吗？

我有三个这样的日期：

1.  **2012/06/01**
2.  **2012/06/05**
3.  **2012/06/18**

我希望这些日期在日期选择器中可见（例如红色），并且当单击其中一个日期时执行了一个动作！

可能吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:32:48.733

不确定您使用的是什么日期选择器，但日期框：

*   [http://dev.jtsage.com/jQM-DateBox/](http://dev.jtsage.com/jQM-DateBox/)

提供主题：

*   [http://dev.jtsage.com/jQM-DateBox/theme/](http://dev.jtsage.com/jQM-DateBox/theme/)

您可以制作两个主题并在两者之间切换以获得您想要的效果

# java - java列表创建方法的区别

> ID：11017272
> 
> 赞同：3
> 
> 时间：2012-06-13T14:37:53.113
> 
> 标签：java

像这样定义数组列表有什么区别：

```
List list = new LinkedList(); 
```

像这样？

```
LinkedList list = new LinkedList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:44:36.173

第一个声明一个 List，并使用 List 接口的新 LinkedList 具体实现对其进行初始化。其余的代码不关心具体的实现。唯一重要的是它是一个列表。如果您稍后意识到 ArrayList 更有效，则只需更改初始化即可。

第二个声明一个 LinkedList，并用一个新的 LinkedList 对其进行初始化。其余代码知道它是一个 LinkedList，并且可以使用 LinkedList 中不在 List 中的方法。如果您稍后意识到 ArrayList 更有效，您可能必须更改其余代码。

通常应该首选第一个：尽可能使用最通用的类​​型，并将代码用于接口而不是实现。

此外，您永远不应使用原始类型，而应始终使用泛型类型：

```
List<String> list = new LinkedList<String>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:45:29.740

正如其他答案所建议的那样， List 是接口，而 LinkedList 是实际的实现类型。例如，如果您后来决定要使用 ArrayList，则可以键入：

```
List list = new ArrayList(); 
```

因为 ArrayList 声明了接口 List。缺点是，如果您想稍后调用不属于 List 接口一部分的 ArrayList/LinkedList/（具有不在列表中的方法的其他类名）的任何方法（这可能不会成为问题），您必须检查它是否真的是 ArrayList 等，并将其转换为这些类型。像这样：

```
ArrayList arrayList = (ArrayList) list; 
```

*只有在检查它确实是一个 ArrayList 之后，否则你会抛出一个异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:39:21.647

一种是使用变量类型的[接口](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)。另一个使用[具体的类](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/LinkedList.html)类型。

一般来说，对变量类型使用接口类型会更好，因为它们更容易移植，并且产生的[耦合](http://en.wikipedia.org/wiki/Coupling_%28computer_programming%29)更小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T14:43:31.457

这称为接口编码。它有一定的好处。根据您的问题，我认为您是这种语言的新手。

根据java world，以下是一些好处

> 设计：可以快速指定对象的方法并将其发布给所有受影响的开发人员开发：Java 编译器保证接口的所有方法都以正确的签名实现，并且接口的所有更改对其他开发人员立即可见集成：由于其完善的接口，能够将类或子系统快速连接在一起 测试：接口有助于隔离错误，因为它们将可能的逻辑错误的范围限制在给定的方法子集中

这是开始阅读[http://www.javaworld.com/jw-08-1999/jw-08-interfaces.html的好地方](http://www.javaworld.com/jw-08-1999/jw-08-interfaces.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T14:40:14.587

两者都有效。区别在于它`List`是一个接口，`LinkedList`是一个实现。使用接口被认为是一种更好的做法，因为您可以在以后轻松切换实现。

# sql-server - 从 VS 2010 DB 项目转换后的 SSDT 项目结构

> ID：11017275
> 
> 赞同：3
> 
> 时间：2012-06-13T14:38:14.613
> 
> 标签：sql-server, visual-studio-2010, sql-server-data-tools

在将 VS 2010 DB 项目转换为 SSDT（SQL Server Data Tools）项目
（以及与数据库和 SSDT 项目之间的一些比较）后，我收到以下文件夹结构：

*   项目
    *   数据生成计划
    *   **德博**
        *   **表**
        *   **意见**
    *   架构比较
    *   模式对象
        *   数据库级对象
            *   ...
        *   模式
            *   **德博**
                *   可编程性
                *   服务经纪人
                *   同义词
                *   **表**
                *   **意见**
    *   脚本
        *   部署后
        *   预部署
    *   安全

如果似乎有些表格和视图在下面`Project\Schema Objects\Schemas\dbo`，有些在下面`Project\dbo`。

实际问题：

1.  为什么有两个不同的文件夹？
    *（我怀疑导入与此有关。）*

2.  我可以将文件合并到一个文件夹下吗？如果可以，是哪个？

3.  如果没有，我向哪个文件夹添加新文件？

4.  如果我在导入过程中选择了创建备份，那么备份信息保存在哪里？- 我希望能够删除它。

编辑：

另一个不一致 - 下的文件`Project\dbo\Tables`包含键和约束，而下的文件`Project\Schema Objects\Schemas\dbo\Tables`被拆分（单独的表，单独的约束等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T18:06:09.207

当我从 DB Pro 2005 升级到 DB Pro 2008 时，我也遇到了同样的事情。我还没有转换为 SSDT 格式，但在前一种情况下，我只是将文件合并回旧文件夹中。

但是，在某些情况下，如果项目足够简单或数据库项目相对较新，我只是重新制作项目。（如果我重新创建/重新导入，那么我将丢失源代码管理中文件的历史记录。）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T16:50:12.910

似乎导入的文件（来自 VS 2010 dbproj）在下面，`Project\Schema Objects\Schemas\dbo\Tables`而之后添加的所有内容都在`Project\dbo\Tables`.

新定义不会拆分为不同的文件和文件夹（表、索引、键......），这使得文件系统路径不那么深，并且更容易读取有关特定表的所有信息（特别是如果键/索引/约束被删除然后与旧版本的表文件进行比较）。

将表格`Project\dbo\Tables`移动到主文件中并将附属文件的内容移动到主文件中似乎可行（您必须在文件中的命令之间添加“GO”）。

另一种选择是从 sqlproj 创建一个数据库（通过将数据库与项目进行比较），删除旧文件，然后通过将项目与数据库进行比较以新格式重新创建它们。

# cocoa - 如何制作自定义视图（NSView）的缩略图视图？

> ID：11017279
> 
> 赞同：1
> 
> 时间：2012-06-13T14:38:32.223
> 
> 标签：cocoa

如何使缩略图视图（不是图像）形成自定义视图（NSView）？

如果自定义 NSView 的内容发生更改，则缩略图视图将被更改。

它看起来像 ibook 作者。

谢谢大家。

[https://plus.google.com/u/0/photos/114755931805273493604/albums/5753531972174581009](https://plus.google.com/u/0/photos/114755931805273493604/albums/5753531972174581009)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T19:43:30.173

**我建议你下次再做一些谷歌搜索，告诉我们你尝试了什么**，但无论如何我都会回答：

您可能希望使用`NSView`'s`-(void)cacheDisplayInRect:toBitmapImageRep:`创建`NSImage`包含缩略图的内容。以下是我在我的应用程序中使用的内容：

```
- (NSImage *)snapshotForRect:(NSRect)destinationRect {
    NSView *view = ... // view you want thumbnail of
    NSBitmapImageRep *imageRep = [view bitmapImageRepForCachingDisplayInRect:destinationRect];
    [view cacheDisplayInRect:destinationRect toBitmapImageRep:imageRep];
    NSImage *renderedImage = [[NSImage alloc] initWithSize:[imageRep
                                                            size]];
    [renderedImage addRepresentation:imageRep];
    return [renderedImage autorelease];
} 
```

或者使用各种可用的其他方法。

[如何拍摄 NSView 的“截图”？](https://stackoverflow.com/questions/3251261/how-do-i-take-a-screenshot-of-an-nsview)

[谷歌](http://www.google.com/search?hl=en&output=search&sclient=psy-ab&q=NSView+NSImage&btnK=)

# c# - ASP.Net C# - 忽略表单上的手机键盘输入按钮

> ID：11017280
> 
> 赞同：0
> 
> 时间：2012-06-13T14:38:35.430
> 
> 标签：c#, asp.net, mobile

我正在做现有 ASP.Net 网站的移动版本，只是重新布局以使其对移动设备友好，而不是制作网络应用程序或任何东西。我有一个文本框，人们可以在其中输入一些可选文本，但是如果您在屏幕键盘上按 Enter，它会触发一个我不想发生的按钮。

我尝试使用默认按钮设置面板，但它不适用于我正在尝试的 Android 手机：

```
<asp:Panel id="wrapper" runat="server" DefaultButton="decoy">
...
    <asp:Button ID="addtobasket" runat="server" oncommand="a2b_Command" Text="Add to basket" class="addtobasket uppercase" />
    <asp:Button ID="decoy" runat="server" Visible="false" />
...
</asp:Panel> 
```

这是我不得不隐藏诱饵按钮的事实吗？如果它没有隐藏，当您单击回车键时它仍然会触发回发，那么有没有一种简单的方法来防止这种情况？我只需要关闭键盘。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:40:55.937

如果您在移动浏览器上，请禁用/不一起设置默认按钮？

# java - 为音频文件创建 PNG 波形的 Java 程序

> ID：11017283
> 
> 赞同：5
> 
> 时间：2012-06-13T14:38:42.527
> 
> 标签：java, image, png, wav, javasound

如何使用 Java 将 Wav 文件转换为 PNG 波形图像文件？

```
java MyProgram.class [path to wav file] [path where to write png file] 
```

预期成绩：

指定路径中保存的png是传入的wav文件的波形。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-13T14:38:43.497

下面是一个 java 类，它将做这件事。我在这里对某些参数进行了硬编码，例如图像的宽度、图像的高度、图像的背景颜色等等。如果你想把它们拉出来，你可以。

```
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.font.FontRenderContext;
import java.awt.font.LineBreakMeasurer;
import java.awt.font.TextAttribute;
import java.awt.font.TextLayout;
import java.awt.geom.Line2D;
import java.awt.image.BufferedImage;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;
import java.text.AttributedCharacterIterator;
import java.text.AttributedString;
import java.util.Vector;

import javax.imageio.ImageIO;
import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.DataLine;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.TargetDataLine;
import javax.sound.sampled.UnsupportedAudioFileException;

public class AudioWaveformCreator {
    AudioInputStream audioInputStream;
    Vector<Line2D.Double> lines = new Vector<Line2D.Double>();
    String errStr;
    Capture capture = new Capture();
    double duration, seconds;
    File file;
    String fileName;
    SamplingGraph samplingGraph;
    String waveformFilename;
    Color imageBackgroundColor = new Color(20,20,20);

    public AudioWaveformCreator(String fileName, String waveformFilename) throws UnsupportedAudioFileException, IOException {
        file = new File(fileName);
        this.waveformFilename = waveformFilename;
    }

    public void createAudioInputStream() throws Exception {
        if (file != null && file.isFile()) {
            try {
                errStr = null;
                audioInputStream = AudioSystem.getAudioInputStream(file);
                fileName = file.getName();
                long milliseconds = (long)((audioInputStream.getFrameLength() * 1000) / audioInputStream.getFormat().getFrameRate());
                duration = milliseconds / 1000.0;
                samplingGraph = new SamplingGraph();
                samplingGraph.createWaveForm(null);                
            } catch (Exception ex) { 
                reportStatus(ex.toString());
                throw ex;
            }
        } else {
            reportStatus("Audio file required.");
        }
    }
    /**
     * Render a WaveForm.
     */
    class SamplingGraph implements Runnable {

        private Thread thread;
        private Font font10 = new Font("serif", Font.PLAIN, 10);
        private Font font12 = new Font("serif", Font.PLAIN, 12);
        Color jfcBlue = new Color(000, 000, 255);
        Color pink = new Color(255, 175, 175);

        public SamplingGraph() {
        }

        public void createWaveForm(byte[] audioBytes) {

            lines.removeAllElements();  // clear the old vector

            AudioFormat format = audioInputStream.getFormat();
            if (audioBytes == null) {
                try {
                    audioBytes = new byte[
                        (int) (audioInputStream.getFrameLength() 
                        * format.getFrameSize())];
                    audioInputStream.read(audioBytes);
                } catch (Exception ex) { 
                    reportStatus(ex.getMessage());
                    return; 
                }
            }
            int w = 500;
            int h = 200;
            int[] audioData = null;
            if (format.getSampleSizeInBits() == 16) {
                 int nlengthInSamples = audioBytes.length / 2;
                 audioData = new int[nlengthInSamples];
                 if (format.isBigEndian()) {
                    for (int i = 0; i < nlengthInSamples; i++) {
                         /* First byte is MSB (high order) */
                         int MSB = (int) audioBytes[2*i];
                         /* Second byte is LSB (low order) */
                         int LSB = (int) audioBytes[2*i+1];
                         audioData[i] = MSB << 8 | (255 & LSB);
                     }
                 } else {
                     for (int i = 0; i < nlengthInSamples; i++) {
                         /* First byte is LSB (low order) */
                         int LSB = (int) audioBytes[2*i];
                         /* Second byte is MSB (high order) */
                         int MSB = (int) audioBytes[2*i+1];
                         audioData[i] = MSB << 8 | (255 & LSB);
                     }
                 }
             } else if (format.getSampleSizeInBits() == 8) {
                 int nlengthInSamples = audioBytes.length;
                 audioData = new int[nlengthInSamples];
                 if (format.getEncoding().toString().startsWith("PCM_SIGN")) {
                     for (int i = 0; i < audioBytes.length; i++) {
                         audioData[i] = audioBytes[i];
                     }
                 } else {
                     for (int i = 0; i < audioBytes.length; i++) {
                         audioData[i] = audioBytes[i] - 128;
                     }
                 }
            }

            int frames_per_pixel = audioBytes.length / format.getFrameSize()/w;
            byte my_byte = 0;
            double y_last = 0;
            int numChannels = format.getChannels();
            for (double x = 0; x < w && audioData != null; x++) {
                int idx = (int) (frames_per_pixel * numChannels * x);
                if (format.getSampleSizeInBits() == 8) {
                     my_byte = (byte) audioData[idx];
                } else {
                     my_byte = (byte) (128 * audioData[idx] / 32768 );
                }
                double y_new = (double) (h * (128 - my_byte) / 256);
                lines.add(new Line2D.Double(x, y_last, x, y_new));
                y_last = y_new;
            }
            saveToFile(waveformFilename);
        }

        public void saveToFile(String filename) {            
            int w = 500;
            int h = 200;
            int INFOPAD = 15;

            BufferedImage bufferedImage = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
            Graphics2D g2 = bufferedImage.createGraphics();

            createSampleOnGraphicsContext(w, h, INFOPAD, g2);            
            g2.dispose();
            // Write generated image to a file
            try {
                // Save as PNG
                File file = new File(filename);
                ImageIO.write(bufferedImage, "png", file);
            } catch (IOException e) {
            }
        }

        private void createSampleOnGraphicsContext(int w, int h, int INFOPAD, Graphics2D g2) {            
            g2.setBackground(imageBackgroundColor);
            g2.clearRect(0, 0, w, h);
            g2.setColor(Color.white);
            g2.fillRect(0, h-INFOPAD, w, INFOPAD);

            if (errStr != null) {
                g2.setColor(jfcBlue);
                g2.setFont(new Font("serif", Font.BOLD, 18));
                g2.drawString("ERROR", 5, 20);
                AttributedString as = new AttributedString(errStr);
                as.addAttribute(TextAttribute.FONT, font12, 0, errStr.length());
                AttributedCharacterIterator aci = as.getIterator();
                FontRenderContext frc = g2.getFontRenderContext();
                LineBreakMeasurer lbm = new LineBreakMeasurer(aci, frc);
                float x = 5, y = 25;
                lbm.setPosition(0);
                while (lbm.getPosition() < errStr.length()) {
                    TextLayout tl = lbm.nextLayout(w-x-5);
                    if (!tl.isLeftToRight()) {
                        x = w - tl.getAdvance();
                    }
                    tl.draw(g2, x, y += tl.getAscent());
                    y += tl.getDescent() + tl.getLeading();
                }
            } else if (capture.thread != null) {
                g2.setColor(Color.black);
                g2.setFont(font12);
                //g2.drawString("Length: " + String.valueOf(seconds), 3, h-4);
            } else {
                g2.setColor(Color.black);
                g2.setFont(font12);
                //g2.drawString("File: " + fileName + "  Length: " + String.valueOf(duration) + "  Position: " + String.valueOf(seconds), 3, h-4);

                if (audioInputStream != null) {
                    // .. render sampling graph ..
                    g2.setColor(jfcBlue);
                    for (int i = 1; i < lines.size(); i++) {
                        g2.draw((Line2D) lines.get(i));
                    }

                    // .. draw current position ..
                    if (seconds != 0) {
                        double loc = seconds/duration*w;
                        g2.setColor(pink);
                        g2.setStroke(new BasicStroke(3));
                        g2.draw(new Line2D.Double(loc, 0, loc, h-INFOPAD-2));
                    }
                }
            }
        }

        public void start() {
            thread = new Thread(this);
            thread.setName("SamplingGraph");
            thread.start();
            seconds = 0;
        }

        public void stop() {
            if (thread != null) {
                thread.interrupt();
            }
            thread = null;
        }

        public void run() {
            seconds = 0;
            while (thread != null) {
                if ( (capture.line != null) && (capture.line.isActive()) ) {
                    long milliseconds = (long)(capture.line.getMicrosecondPosition() / 1000);
                    seconds =  milliseconds / 1000.0;
                }
                try { thread.sleep(100); } catch (Exception e) { break; }                              
                while ((capture.line != null && !capture.line.isActive())) 
                {
                    try { thread.sleep(10); } catch (Exception e) { break; }
                }
            }
            seconds = 0;
        }
    } // End class SamplingGraph

    /** 
     * Reads data from the input channel and writes to the output stream
     */
    class Capture implements Runnable {

        TargetDataLine line;
        Thread thread;

        public void start() {
            errStr = null;
            thread = new Thread(this);
            thread.setName("Capture");
            thread.start();
        }

        public void stop() {
            thread = null;
        }

        private void shutDown(String message) {
            if ((errStr = message) != null && thread != null) {
                thread = null;
                samplingGraph.stop();                
                System.err.println(errStr);
            }
        }

        public void run() {

            duration = 0;
            audioInputStream = null;

            // define the required attributes for our line, 
            // and make sure a compatible line is supported.

            AudioFormat format = audioInputStream.getFormat();
            DataLine.Info info = new DataLine.Info(TargetDataLine.class, 
                format);

            if (!AudioSystem.isLineSupported(info)) {
                shutDown("Line matching " + info + " not supported.");
                return;
            }

            // get and open the target data line for capture.

            try {
                line = (TargetDataLine) AudioSystem.getLine(info);
                line.open(format, line.getBufferSize());
            } catch (LineUnavailableException ex) { 
                shutDown("Unable to open the line: " + ex);
                return;
            } catch (SecurityException ex) { 
                shutDown(ex.toString());
                JavaSound.showInfoDialog();
                return;
            } catch (Exception ex) { 
                shutDown(ex.toString());
                return;
            }

            // play back the captured audio data
            ByteArrayOutputStream out = new ByteArrayOutputStream();
            int frameSizeInBytes = format.getFrameSize();
            int bufferLengthInFrames = line.getBufferSize() / 8;
            int bufferLengthInBytes = bufferLengthInFrames * frameSizeInBytes;
            byte[] data = new byte[bufferLengthInBytes];
            int numBytesRead;

            line.start();

            while (thread != null) {
                if((numBytesRead = line.read(data, 0, bufferLengthInBytes)) == -1) {
                    break;
                }
                out.write(data, 0, numBytesRead);
            }

            // we reached the end of the stream.  stop and close the line.
            line.stop();
            line.close();
            line = null;

            // stop and close the output stream
            try {
                out.flush();
                out.close();
            } catch (IOException ex) {
                ex.printStackTrace();
            }

            // load bytes into the audio input stream for playback

            byte audioBytes[] = out.toByteArray();
            ByteArrayInputStream bais = new ByteArrayInputStream(audioBytes);
            audioInputStream = new AudioInputStream(bais, format, audioBytes.length / frameSizeInBytes);

            long milliseconds = (long)((audioInputStream.getFrameLength() * 1000) / format.getFrameRate());
            duration = milliseconds / 1000.0;

            try {
                audioInputStream.reset();
            } catch (Exception ex) { 
                ex.printStackTrace(); 
                return;
            }

            samplingGraph.createWaveForm(audioBytes);
        }
    } // End class Capture    

    public static void main(String [] args) throws Exception {
        if (args.length != 2) {
            printUsage();
            System.exit(1);
        }                
        AudioWaveformCreator awc = new AudioWaveformCreator(args[0], args[1]);
        awc.createAudioInputStream();
    }

    private void reportStatus(String msg) {
        if ((errStr = msg) != null) {
            System.out.println(errStr);            
        }
    }

    private static void printUsage() {
        System.out.println("AudioWaveformCreator usage: java AudioWaveformCreator.class [path to audio file for generating the image] [path to save waveform image to]");
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T22:31:17.597

![演示。](../Images/8abc0e65e8560f00d5624b1da3d8a15c.png)

SO 的白色 BG 遮住了它，但图像底部有一条“白色带”，蓝色迹线落入其中。用于跟踪的示例是[http://pscode.org/media/leftright.wav](http://pscode.org/media/leftright.wav)，它是从下面的 SSCCE 热链接的。

## 代码变体

```
package test.t100.t001;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.font.FontRenderContext;
import java.awt.font.LineBreakMeasurer;
import java.awt.font.TextAttribute;
import java.awt.font.TextLayout;
import java.awt.geom.Line2D;
import java.awt.image.BufferedImage;
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.text.AttributedCharacterIterator;
import java.text.AttributedString;
import java.util.Vector;

import javax.imageio.ImageIO;
import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioInputStream;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.DataLine;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.TargetDataLine;
import javax.sound.sampled.UnsupportedAudioFileException;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JOptionPane;

public class AudioWaveformCreator {
    AudioInputStream audioInputStream;
    Vector<Line2D.Double> lines = new Vector<Line2D.Double>();
    String errStr;
    Capture capture = new Capture();
    double duration, seconds;
    //File file;
    String fileName = "out.png";
    SamplingGraph samplingGraph;
    String waveformFilename;
    Color imageBackgroundColor = new Color(20,20,20);

    public AudioWaveformCreator(URL url, String waveformFilename) throws Exception {
        if (url != null) {
            try {
                errStr = null;
                audioInputStream = AudioSystem.getAudioInputStream(url);
                long milliseconds = (long)((audioInputStream.getFrameLength() * 1000) / audioInputStream.getFormat().getFrameRate());
                duration = milliseconds / 1000.0;
                samplingGraph = new SamplingGraph();
                samplingGraph.createWaveForm(null);                
            } catch (Exception ex) { 
                reportStatus(ex.toString());
                throw ex;
            }
        } else {
            reportStatus("Audio file required.");
        }
    }
    /**
     * Render a WaveForm.
     */
    class SamplingGraph implements Runnable {

        private Thread thread;
        private Font font10 = new Font("serif", Font.PLAIN, 10);
        private Font font12 = new Font("serif", Font.PLAIN, 12);
        Color jfcBlue = new Color(000, 000, 255);
        Color pink = new Color(255, 175, 175);

        public SamplingGraph() {
        }

        public void createWaveForm(byte[] audioBytes) {

            lines.removeAllElements();  // clear the old vector

            AudioFormat format = audioInputStream.getFormat();
            if (audioBytes == null) {
                try {
                    audioBytes = new byte[
                        (int) (audioInputStream.getFrameLength() 
                        * format.getFrameSize())];
                    audioInputStream.read(audioBytes);
                } catch (Exception ex) { 
                    reportStatus(ex.getMessage());
                    return; 
                }
            }
            int w = 500;
            int h = 200;
            int[] audioData = null;
            if (format.getSampleSizeInBits() == 16) {
                 int nlengthInSamples = audioBytes.length / 2;
                 audioData = new int[nlengthInSamples];
                 if (format.isBigEndian()) {
                    for (int i = 0; i < nlengthInSamples; i++) {
                         /* First byte is MSB (high order) */
                         int MSB = (int) audioBytes[2*i];
                         /* Second byte is LSB (low order) */
                         int LSB = (int) audioBytes[2*i+1];
                         audioData[i] = MSB << 8 | (255 & LSB);
                     }
                 } else {
                     for (int i = 0; i < nlengthInSamples; i++) {
                         /* First byte is LSB (low order) */
                         int LSB = (int) audioBytes[2*i];
                         /* Second byte is MSB (high order) */
                         int MSB = (int) audioBytes[2*i+1];
                         audioData[i] = MSB << 8 | (255 & LSB);
                     }
                 }
             } else if (format.getSampleSizeInBits() == 8) {
                 int nlengthInSamples = audioBytes.length;
                 audioData = new int[nlengthInSamples];
                 if (format.getEncoding().toString().startsWith("PCM_SIGN")) {
                     for (int i = 0; i < audioBytes.length; i++) {
                         audioData[i] = audioBytes[i];
                     }
                 } else {
                     for (int i = 0; i < audioBytes.length; i++) {
                         audioData[i] = audioBytes[i] - 128;
                     }
                 }
            }

            int frames_per_pixel = audioBytes.length / format.getFrameSize()/w;
            byte my_byte = 0;
            double y_last = 0;
            int numChannels = format.getChannels();
            for (double x = 0; x < w && audioData != null; x++) {
                int idx = (int) (frames_per_pixel * numChannels * x);
                if (format.getSampleSizeInBits() == 8) {
                     my_byte = (byte) audioData[idx];
                } else {
                     my_byte = (byte) (128 * audioData[idx] / 32768 );
                }
                double y_new = (double) (h * (128 - my_byte) / 256);
                lines.add(new Line2D.Double(x, y_last, x, y_new));
                y_last = y_new;
            }
            saveToFile();
        }

        public void saveToFile() {            
            int w = 500;
            int h = 200;
            int INFOPAD = 15;

            BufferedImage bufferedImage = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB);
            Graphics2D g2 = bufferedImage.createGraphics();

            createSampleOnGraphicsContext(w, h, INFOPAD, g2);            
            g2.dispose();
            // Write generated image to a file
            try {
                // Save as PNG
                File file = new File(fileName);
                System.out.println(file.getAbsolutePath());
                ImageIO.write(bufferedImage, "png", file);
                JOptionPane.showMessageDialog(null, 
                        new JLabel(new ImageIcon(fileName)));
            } catch (IOException e) {
            }
        }

        private void createSampleOnGraphicsContext(int w, int h, int INFOPAD, Graphics2D g2) {            
            g2.setBackground(imageBackgroundColor);
            g2.clearRect(0, 0, w, h);
            g2.setColor(Color.white);
            g2.fillRect(0, h-INFOPAD, w, INFOPAD);

            if (errStr != null) {
                g2.setColor(jfcBlue);
                g2.setFont(new Font("serif", Font.BOLD, 18));
                g2.drawString("ERROR", 5, 20);
                AttributedString as = new AttributedString(errStr);
                as.addAttribute(TextAttribute.FONT, font12, 0, errStr.length());
                AttributedCharacterIterator aci = as.getIterator();
                FontRenderContext frc = g2.getFontRenderContext();
                LineBreakMeasurer lbm = new LineBreakMeasurer(aci, frc);
                float x = 5, y = 25;
                lbm.setPosition(0);
                while (lbm.getPosition() < errStr.length()) {
                    TextLayout tl = lbm.nextLayout(w-x-5);
                    if (!tl.isLeftToRight()) {
                        x = w - tl.getAdvance();
                    }
                    tl.draw(g2, x, y += tl.getAscent());
                    y += tl.getDescent() + tl.getLeading();
                }
            } else if (capture.thread != null) {
                g2.setColor(Color.black);
                g2.setFont(font12);
                //g2.drawString("Length: " + String.valueOf(seconds), 3, h-4);
            } else {
                g2.setColor(Color.black);
                g2.setFont(font12);
                //g2.drawString("File: " + fileName + "  Length: " + String.valueOf(duration) + "  Position: " + String.valueOf(seconds), 3, h-4);

                if (audioInputStream != null) {
                    // .. render sampling graph ..
                    g2.setColor(jfcBlue);
                    for (int i = 1; i < lines.size(); i++) {
                        g2.draw((Line2D) lines.get(i));
                    }

                    // .. draw current position ..
                    if (seconds != 0) {
                        double loc = seconds/duration*w;
                        g2.setColor(pink);
                        g2.setStroke(new BasicStroke(3));
                        g2.draw(new Line2D.Double(loc, 0, loc, h-INFOPAD-2));
                    }
                }
            }
        }

        public void start() {
            thread = new Thread(this);
            thread.setName("SamplingGraph");
            thread.start();
            seconds = 0;
        }

        public void stop() {
            if (thread != null) {
                thread.interrupt();
            }
            thread = null;
        }

        public void run() {
            seconds = 0;
            while (thread != null) {
                if ( (capture.line != null) && (capture.line.isActive()) ) {
                    long milliseconds = (long)(capture.line.getMicrosecondPosition() / 1000);
                    seconds =  milliseconds / 1000.0;
                }
                try { thread.sleep(100); } catch (Exception e) { break; }                              
                while ((capture.line != null && !capture.line.isActive())) 
                {
                    try { thread.sleep(10); } catch (Exception e) { break; }
                }
            }
            seconds = 0;
        }
    } // End class SamplingGraph

    /** 
     * Reads data from the input channel and writes to the output stream
     */
    class Capture implements Runnable {

        TargetDataLine line;
        Thread thread;

        public void start() {
            errStr = null;
            thread = new Thread(this);
            thread.setName("Capture");
            thread.start();
        }

        public void stop() {
            thread = null;
        }

        private void shutDown(String message) {
            if ((errStr = message) != null && thread != null) {
                thread = null;
                samplingGraph.stop();                
                System.err.println(errStr);
            }
        }

        public void run() {

            duration = 0;
            audioInputStream = null;

            // define the required attributes for our line, 
            // and make sure a compatible line is supported.

            AudioFormat format = audioInputStream.getFormat();
            DataLine.Info info = new DataLine.Info(TargetDataLine.class, 
                format);

            if (!AudioSystem.isLineSupported(info)) {
                shutDown("Line matching " + info + " not supported.");
                return;
            }

            // get and open the target data line for capture.

            try {
                line = (TargetDataLine) AudioSystem.getLine(info);
                line.open(format, line.getBufferSize());
            } catch (LineUnavailableException ex) { 
                shutDown("Unable to open the line: " + ex);
                return;
            } catch (SecurityException ex) { 
                shutDown(ex.toString());
                //JavaSound.showInfoDialog();
                return;
            } catch (Exception ex) { 
                shutDown(ex.toString());
                return;
            }

            // play back the captured audio data
            ByteArrayOutputStream out = new ByteArrayOutputStream();
            int frameSizeInBytes = format.getFrameSize();
            int bufferLengthInFrames = line.getBufferSize() / 8;
            int bufferLengthInBytes = bufferLengthInFrames * frameSizeInBytes;
            byte[] data = new byte[bufferLengthInBytes];
            int numBytesRead;

            line.start();

            while (thread != null) {
                if((numBytesRead = line.read(data, 0, bufferLengthInBytes)) == -1) {
                    break;
                }
                out.write(data, 0, numBytesRead);
            }

            // we reached the end of the stream.  stop and close the line.
            line.stop();
            line.close();
            line = null;

            // stop and close the output stream
            try {
                out.flush();
                out.close();
            } catch (IOException ex) {
                ex.printStackTrace();
            }

            // load bytes into the audio input stream for playback

            byte audioBytes[] = out.toByteArray();
            ByteArrayInputStream bais = new ByteArrayInputStream(audioBytes);
            audioInputStream = new AudioInputStream(bais, format, audioBytes.length / frameSizeInBytes);

            long milliseconds = (long)((audioInputStream.getFrameLength() * 1000) / format.getFrameRate());
            duration = milliseconds / 1000.0;

            try {
                audioInputStream.reset();
            } catch (Exception ex) { 
                ex.printStackTrace(); 
                return;
            }

            samplingGraph.createWaveForm(audioBytes);
        }
    } // End class Capture    

    public static void main(String [] args) throws Exception {
        //if (args.length != 2) {
          //  printUsage();
            //System.exit(1);
        //}
        URL url = new URL("http://pscode.org/media/leftright.wav");
        AudioWaveformCreator awc = new AudioWaveformCreator(url, "out.png");
    }

    private void reportStatus(String msg) {
        if ((errStr = msg) != null) {
            System.out.println(errStr);            
        }
    }

    private static void printUsage() {
        System.out.println("AudioWaveformCreator usage: java AudioWaveformCreator.class [path to audio file for generating the image] [path to save waveform image to]");
    }
} 
```

# php - 如何在 Zend Frameowrk 中创建模块特定的路由器？

> ID：11017286
> 
> 赞同：1
> 
> 时间：2012-06-13T14:38:52.943
> 
> 标签：php, zend-framework, configuration

我的 Zend Framework application.ini 中有以下路由器：

```
resources.router.routes.route_id.route = "/artists/:uid"
resources.router.routes.route_id.defaults.module = "admin"
resources.router.routes.route_id.defaults.controller = "showrooms"
resources.router.routes.route_id.defaults.action = "edit" 
```

它工作并将“/艺术家/：uid”路由到正确的位置。

此应用程序是模块化的，上述路由适用于每个模块。

**您如何使路由仅适用于一个模块？**

我有以下模块：

管理员：admin.site.com

公司：corp.site.com

其他：other.site.com

**如果用户点击Corp**模块，我只希望应用上述路由。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:35:43.047

您想要的是将子域路由到 corp 模块

为此，您必须告诉 zend route 使用主机名路由

```
routes.corp.type = "Zend_Controller_Router_Route_Hostname"
routes.corp.route = "corp.:domain.:tld" 
```

这样，所有顶级域上的所有域上的子域公司都将被路由。如果您只想为 site.com 制作它

```
routes.corp.route = "corp.site.com" 
```

现在您路由了子域，您可以通过将其添加到默认值来设置它以将其发送到模块

```
routes.corp.defaults.module = "corp" 
```

让它像“正常”一样路由，通过这样做将它连接到默认路由

```
routes.corp.chains.index.type = "Zend_Controller_Router_Route"
routes.corp.chains.index.route = ":controller/:action/*"
routes.corp.chains.index.defaults.controller = "index"
routes.corp.chains.index.defaults.action = "index" 
```

这样 corp.site.com/news/view/id/1 将转到 corp 模块中的 newsController

# c# - 如何知道 Array FileInfo[] 是否包含文件

> ID：11017290
> 
> 赞同：5
> 
> 时间：2012-06-13T14:39:02.373
> 
> 标签：c#, linq, ienumerable, fileinfo

我有以下代码，我在“if 语句”中收到一个错误，指出 FileInfo 不包含定义“包含”

哪个是查找文件是否在目录中的最佳解决方案？

谢谢

```
string filePath = @"C:\Users\";
DirectoryInfo folderRoot = new DirectoryInfo(filePath);
FileInfo[] fileList = folderRoot.GetFiles();

IEnumerable<FileInfo> result = from file in fileList where file.Name == "test.txt" select file;
if (fileList.Contains(result))
{
      //dosomething
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-13T14:42:16.797

删除`fileList.Contains(result)`并使用：

```
if (result.Any())
{

} 
```

`.Any()`是一个 LINQ 关键字，用于确定 result 中是否有任何项目。有点像做一个`.Count() > 0`，除了[更快](http://blog.donnfelker.com/2009/06/22/linq-any-vs-count/)。使用`.Any()`，只要找到一个元素，就不再枚举序列，结果是`True`。

实际上，您可以从底部删除最后五行代码`from file in...`，将其替换为：

```
if (fileList.Any(x => x.Name == "test.txt"))
{

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T14:44:59.357

你可以检查结果的计数

```
 if (result.Count() > 0)
 {
    //dosomething
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T02:51:12.350

How about this, code below will give you a list of files (fullname as a string); the reason why return as a list is because your sub directories may have the same file name as 'test.txt'.

```
var list = Directory.EnumerateFiles(@"c:\temp\", "test.txt",
           SearchOption.AllDirectories); 
```

if you are very sure 'test.txt' file will only in one of the directory, you can use:

```
string fullname = Directory.EnumerateFiles(@"c:\temp\", "test.txt",
                  SearchOption.AllDirectories).FirstOrDefault();
if (fullname != null) { ..... } 
```

# css - 具有前一个 div 绝对定位的粘性 CSS 页脚

> ID：11017293
> 
> 赞同：0
> 
> 时间：2012-06-13T14:39:14.477
> 
> 标签：css, positioning, html, css-position, sticky-footer

我正在尝试将页脚放置在浏览器窗口的底部。内容 div 具有绝对定位，因为其内容的高度不同。我已经研究了几种不同的方法，但由于某种原因，大多数都破坏了#content div，而页脚将自身定位在页眉和内容 div 之间。有没有人有任何想法？

这是我的html

```
<div id="header"></div>
  <div id="content">                                                                        
      @RenderBody()                                  
  </div>                              
 <div id="footer"></div> 
```

这是我的 CSS

```
#header {
height:115px;
position: relative;
color: #000;
padding-top: 10px;
border-bottom:1px solid #fff;
-moz-box-shadow: 0 0 10px 10px #ccc;
-webkit-box-shadow: 0 0 10px 10px #ccc;
box-shadow: 0 0 10px 10px #ccc;
}

#content {   
width:900px;
height:100%;
margin-top:40px;
margin-left:-450px;
left:50%;
position:absolute;    
}

#footer {
width:auto;
height:100px;
background:#d21f27;
margin-top:5px;
clear:both;
bottom:0;      
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:53:57.493

就像 Fidrizers 说的，应该不需要绝对定位`#content`。
但出于某些原因，例如特殊的界面设计，它可能很有用。

要创建一个*粘性页脚，* *ryan fait*的解决方法是我所知道的最简单和最稳定的方法：
[http ://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

您可以将其应用于您的布局并`#content`使用`top: 125px; right: 0; bottom: 100px; left: 0`.

**重要**：现在的问题是，内容可能会消失，具体取决于视口的宽度和高度。我真的不建议这样做，但它可能会解决您的问题。

**演示**：http: [//jsfiddle.net/ubJAf/2/](http://jsfiddle.net/ubJAf/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:45:47.437

不需要绝对位置来改变高度。

查看答案[http://jsfiddle.net/XpKJG/](http://jsfiddle.net/XpKJG/)

[阅读何时使用绝对，何时不使用](https://stackoverflow.com/q/2275084/1085285)

# jquery - 如何使此功能在 onclick 事件上工作

> ID：11017298
> 
> 赞同：0
> 
> 时间：2012-06-13T14:39:30.227
> 
> 标签：jquery, jqmodal

我有这个 Javascript：

```
<script language="javascript" type="text/javascript">
$().ready(function() {
$('#ex2').jqm({ajax: 'view.php?id=<?=$objResult["id"];?>', trigger: 'a.ex2trigger'});
});
</script> 
```

这需要这个 HTML：

```
<a href="#" class="ex2trigger">
View
<div class="jqmWindow" id="ex2">
Please wait... <img src="inc/busy.gif" alt="loading" />
</div> 
```

我将如何整合它以使其适用于桌面`<tr onclick>`事件？因此，当您单击一行时，它会显示相应的 view.php?id=

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:43:19.850

您可以将事件处理程序附加到监视行点击的表。然后，您将获取该行的索引并将其传递给您的函数。

```
$("table").on('click','tr',function(){
     $('#ex2').jqm({ajax:'view.php?id='+$(this).index(),trigger:'a.ex2trigger'});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:19:48.710

假设您正在 AJAX 加载表格，您应该使用 jQuery 的[实时](http://api.jquery.com/live/)API。

```
$("table tr").live('click', function(){
   $('#ex2').jqm({ajax:'view.php?id='+$(this).index(),trigger:'a.ex2trigger'});
});` 
```

# asp.net - asp：登录“记住我”比整整 50 年快到期

> ID：11017302
> 
> 赞同：1
> 
> 时间：2012-06-13T14:39:38.950
> 
> 标签：asp.net, cookies, login, remember-me

ASP.net`<asp:Login>`控件能够显示**下次记住我**复选框。如果选中，[`Login.RememberMeSet Property`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.remembermeset.aspx)则设置此项。

**来自 MSDN：**

> 当**RememberMeSet**属性为**true**时，发送到用户计算机的身份验证 cookie 设置为 50 年后过期，使其成为用户下次访问网站时将使用的持久性 cookie。由于身份验证 cookie 将存在于用户的计算机上，因此用户将被视为已通过身份验证，无需再次登录网站。

除了 cookie 似乎在 30 分钟后过期，而不是 50 年：

![在此处输入图像描述](../Images/6ac8a03cd5e3c6b5d2440e03a2b87338.png)

（除非这是*会话*cookie，而不是*持久性*cookie。我不知道如何区分）

我如何才能`asp:Login`真正**“**记住*我*”50 年？

> **注意**：我知道 ASP.net 中有一个错误，您必须给 cookie 一个后缀名，在`web.config`：
> 
> ```
> <authentication mode="Forms">
>   <forms loginUrl="~/Account/Login.aspx" name=".ASPXFORMSAUTH" />
> </authentication> 
> ```
> 
> 如果不`name`添加，`asp:Login`控件将无法~~工作。~~完全记住用户；甚至30分钟。

# java - 捕获 Java 错误

> ID：11017304
> 
> 赞同：27
> 
> 时间：2012-06-13T14:39:40.430
> 
> 标签：java, error-handling

我听说抓捕`java.lang.Error`被认为是不好的做法。我目前正在加载一个不保证在 PATH 上的 .dll，并且希望切换到用户配置的位置，以防它不在。

```
try {
    System.loadLibrary("HelloWorld");
} catch(UnsatisfiedLinkError ule){
    System.load("C:/libraries/HelloWorld.dll");
} 
```

有没有更好的方法来做到这一点？还是在`UnsatisfiedLinkError`这里可以接受？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-13T16:01:08.207

除了就如何在技术上克服问题提供建议之外，我想花点时间解释一下为什么它首先被认为是“不好的做法”。

让我们从澄清`Error`类是什么开始。

* * *

在 java 中，会抛出错误和异常（它们是主要类型）。使用`throw`关键字完成上述操作之一。每个扩展基本的类`java.lang.Throwable`都可以被抛出。

有两个类继承自基本`Throwable`类：`Exception`和`Error`. 他们的文档中解释了这两者之间的区别：

> *Error*是*Throwable*的子类，**表示合理的应用程序不应尝试捕获的严重问题。大多数此类错误是异常情况。**[...]

[来源](http://docs.oracle.com/javase/6/docs/api/java/lang/Error.html)

> 类*Exception*及其子类是*Throwable*的一种形式， 它**指示合理的应用程序*可能想要* 捕获的条件。**

[来源](http://docs.oracle.com/javase/6/docs/api/java/lang/Exception.html)

* * *

如上所述，错误和异常是分开的，因为它们的来源不同。`Error`通常表示*应用程序无法从中恢复的*问题。因此，他们不应该被抓住。

对于 a 也是如此`RuntimeException`，但它用于指示高级层（例如方法）的问题。而`Error`表示低级问题（例如运行时）。

* * *

因此，既然您了解您**只能捕获可以从中恢复的异常和错误，那么**您的问题的答案应该很清楚了。

是的，捕获 是完全合理的`UnsatisfiedLinkError`，因为您的应用程序可以从中恢复。

* * *

[我在我的博客上的一篇文章](http://codeisland.org/2012/catching-practice/)中介绍了上述内容（更详细并带有示例）和一些扩展信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-18T09:36:19.747

您应该只在非常特定的情况下捕获错误。如果您已经探索了所有其他可能性，则只有捕获和错误。我完全同意 Lukas Knuth 所说的一切。但我还有一个小补充。如果您要捕获任何类型的错误，请确保从尽可能窄的范围内捕获错误。此外，如果可能，请确保您捕获错误的方法声明为最终方法。原因是捕获错误通常会导致一些非常不稳定的程序。考虑到您在稍后扩展为调用其他方法的方法上捕获了错误，所有这些底层方法现在也将被覆盖的捕获（无意中）捕获到错误。

如果您需要捕获错误，请以狭窄、受控的方式进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:58:54.080

loadLibrary 调用 findLibrary() 这会很有帮助，但它受到保护，最好的办法是编写自己的扩展 ClassLoader 的类。类加载器有一个名为 findLibrary() 的受保护方法，它将返回库的路径，如果不存在则返回 null。这样你就可以只检查 null 而不是捕获错误。我不确定这是否真的“更好”，但它会消除您对 try catch 的需要；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T16:12:06.423

如果您是防御性编码并且可以从问题中恢复，那么它不是 Java `Error`。如果这样的问题不太可能，那么创建一个子类`Exception`并抛出并捕获它。如果可能出现这样的问题，那么它甚至不应该抛出`Exception`; 但是，应该是常规代码流的一部分。

```
try {
  if (config.hasCustomDLL()) {
    System.load(config.getCustomDLL());
  } else {
    System.loadLibrary(Config.DEFAULT_DLL);
  }
} catch (UnstatisfiedLinkError e) {
  System.out.println("Error loading DLL: " + e);
} 
```

`Errors`意味着非常糟糕的故障，而不是可恢复的“故障”，如果有合适的解决方法，它们甚至都不是故障。不要使设计用于处理故障的系统过载，这相当于以多种方式配置系统的能力。

# jsp - 如何缩短jsp中的长URL？

> ID：11017312
> 
> 赞同：0
> 
> 时间：2012-06-13T14:40:11.903
> 
> 标签：jsp, spring-mvc

我将 URL 的最大条目大小从 100 增加到 300，但现在显示时，它们会在屏幕上运行。如果这些 URL 不能放在页面上，我该如何缩短它们以三个点结尾。

```
 <c:forEach items="${targets}" var="target">
        <tr>
            <th></th>
            <td class="data">
                <c:if test="${not empty target.valueString}">
                    <a href="<c:out value="${target.valueString}"/>" target="_blank"><c:out value="${target.valueString}"/></a>
                    <spring:message code="entry.confirmDelTarget" var="confirmDelete" />
                    <a href="#" onClick="if(confirm('${confirmDelete}')) document.entryForm.actionBtn.value='delTarget';document.entryForm.targetId.value='${target.id}';document.entryForm.submit();">
                        <img src="/theme/images/gfx/ico_delete2.gif"/>
                    </a>
                </c:if>
            </td>
        </tr>
    </c:forEach> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:37:25.947

和

```
<c:out value="${target.valueStringTruncated}"/> 
```

和

```
public String getValueStringTruncated() {
    if (valueString.length() > 100) {
        return valueString.substring(0, 97) + "...";
    }
} 
```

或者您可以将此代码提取到 JSP 标记或 EL 函数中：

```
<c:out value="${myFn:truncate(target.valueString)}"/> 
```

# ruby-on-rails - Rails：在其他模型的显示操作中创建新帖子

> ID：11017320
> 
> 赞同：3
> 
> 时间：2012-06-13T14:40:25.657
> 
> 标签：ruby-on-rails, ruby-on-rails-3

有几个位置，人们可以写关于这些位置的帖子。所以到目前为止我所做的是我创建了一个表 locations`(rails generate scaffold locations name:string)`和一个表 posts `(rails generate scaffold posts title:string text:string author:string image:string location_id:integer)`。所以 Table`posts`有一个表的外键`locations`。因此可以在表格的显示操作中查看帖子。

/locations/1 的视图（显示位置模型的操作）和 /posts/new 的视图：

![查看 /locations/1（显示位置模型的操作）](../Images/cc525cece78f0483c8bf94ec0efbfa8c.png)![在此处输入图像描述](../Images/650861e4c607625e5b9673c46ecec2e6.png)

我想要的是访问一个特定位置的人可以创建一个帖子，而无需填写 id 框，如下所示。它应该自动知道这篇文章属于当前 id 的位置。我必须在控制器中更改什么以及在 html.erb 文件中必须做什么才能使其正常工作？我已经尝试过了……但它检索到一个 noMethod 错误。

```
 def newpost
    @post = current_location.posts.build 

    respond_to do |format|
      format.html 
      format.json { render json: @locations }
    end
  end 
```

* * *

所以我听从了 Charles 和 Zajn 的指示。

```
class PostsController < ApplicationController
(...)
  def new
    #@post = Post.new
    @post = @location.posts.build

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @post }
    end
  end
(...)
end 
```

在`config/routes.rb`

```
resources :locations do
  resources :posts
end 
```

偏后

```
<%= form_for @post do |f| %>
  <%= f.label :title, 'Title' %>
  <%= f.text_field :title %>

  <%= f.label :title, 'Text' %>
  <%= f.text_field :text%>

  <%= f.label :title, 'Author' %>
  <%= f.text_field :author %>

  <%= f.hidden_field :location_id %>
  <%= f.submit "Submit" %>
<% end %> 
```

并且似乎仍然存在错误：

```
NoMethodError in PostsController#new 
```

细节：

```
undefined method `posts' for nil:NilClass
app/controllers/posts_controller.rb:28:in `new'

Request
Parameters:
{"location_id"=>"1"}

Response
Headers:
None 
```

* * *

**第二次尝试：**现在我编辑了`PostsController`

```
 def new
    #@post = Post.new
    @location = Location.find(params[:location_id]) # You can move this to a before_filter, if you prefer
    @post = @location.posts.build

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @post }
    end
  end 
```

并且控制器中似乎没有错误了。现在`NoMethodError`在`html.erb`-files中有一些：

`undefined method 'posts_path' for #<#<Class:0x2404384>:0x204ed98>`

```
1: <%= form_for @post do |f| %>
2:     <%= f.label :title, 'Title' %>
3:     <%= f.text_field :title %>
4: 

app/views/posts/_form.html.erb:1:in `_app_views_posts__form_html_erb___1061496502_7409780'
app/views/posts/new.html.erb:3:in `_app_views_posts_new_html_erb__238125222_5750540'
app/controllers/posts_controller.rb:31:in `new' 
```

我的`_form.html.erb`：

```
<%= form_for @post do |f| %>
    <%= f.label :title, 'Title' %>
    <%= f.text_field :title %>

    <%= f.label :title, 'Text' %>
    <%= f.text_field :text%>

    <%= f.label :title, 'Author' %>
    <%= f.text_field :author %>

    <%= f.hidden_field :location_id, :value => @location.id %>
    <%= f.submit "Submit" %>
<% end %> 
```

我的`new.html.erb`

```
<h1>New post</h1>

<%= render 'form' %>

<%= link_to 'Back', posts_path %> 
```

I already tried to simply delete the last code `<%= link_to 'Back', posts_path %>`and it still retrieves the error, even I saved everything, shut down the server and reopened it. But I think the problem is not the posts_path. Because if I change the `<%= form_for @post do |f| %>`in the html.erb file into `<%= form_for @location.post do |f| %>`, it retrieves a `NoMethodError for 'post'`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T19:30:32.270

It sounds like you want posts to be a [nested resource](http://guides.rubyonrails.org/routing.html#nested-resources) under locations.

If that's what you're trying to do, then in `config/routes.rb`, you should have:

```
resources :locations do
  resources :posts
end 
```

为 id = 1 的位置创建新帖子的 url 是`/locations/1/posts/new`，您的`new`操作`PostsController`应如下所示：

```
def new
  @location = Location.find(params[:location_id]) # You can move this to a before_filter, if you prefer
  @post = @location.posts.build

  respond_to do |format|
    format.html
    format.json { render json: @post }
  end
end 
```

您的`app/views/posts/_form.html.erb`部分应如下所示：

```
<%= form_for [@location, @post] do |f| %>
  <%= f.label :title, 'Title' %>
  <%= f.text_field :title %>

  <%= f.label :title, 'Text' %>
  <%= f.text_field :text%>

  <%= f.label :title, 'Author' %>
  <%= f.text_field :author %>

  <%= f.hidden_field :location_id %>
  <%= f.submit "Submit" %>
<% end %> 
```

请注意，对于嵌套资源，您在视图中使用的路由助手是不同的。例如，要获取`index`属于给定位置的帖子的操作路径，您可以使用 `location_posts_path(@location)`，而不是`posts_path`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T15:04:00.287

You could simply add a hidden field that contains the id of the location to the form where you are creating the post.

So, something like this:

```
<%= form_for @post do |f| %>
    <%= f.label :title, 'Title' %>
    <%= f.text_field :title %>

    <%= f.label :title, 'Text' %>
    <%= f.text_field :text%>

    <%= f.label :title, 'Author' %>
    <%= f.text_field :author %>

    <%= f.hidden_field :location_id, :value => @location.id %>
    <%= f.submit "Submit" %>
<% end %> 
```

Where `@location` is an instance variable containing the current location that you're viewing.

# .net - Visual Studio：在团队中同步工作，并将只读库项目添加到 VS 解决方案中

> ID：11017323
> 
> 赞同：0
> 
> 时间：2012-06-13T14:40:42.927
> 
> 标签：.net, visual-studio, dll, tortoisesvn

我用 C# 编写了一个 DLL 库，其中包含一个用于通信和操作我们产品的 API。我希望我们团队中的 QA 人员使用它在 .NET 环境中构建测试工具。与封装原则相反（有人可能会建议...），我希望 QA 人员能够看到 DLL 中 API 方法的实际实现（例如，当他们单击“转到定义”时） Visual Studio），而不仅仅是从元数据中查看声明/注释。

我不希望他们能够更改实际的 DLL，也不希望他们每次构建新项目时都构建 DLL，所以我不能简单地将库项目添加到他们的 VS 解决方案中。

我想到的一种理论方法是将库项目作为只读方式添加到他们的每个 VS 解决方案中（如果可能的话？），并指示他们永远不要构建它（只构建他们自己的新项目）甚至锁定它从建筑（如果可能的话？）。问题是，理想情况下，我希望他们能够以某种方式按下一个按钮，将其 VS 解决方案中的库项目更新为版本控制系统（我正在使用 Tortoise SVN）的最新版本，以及更新的（内置）DLL 文件（将 DLL 文件更新到他们的解决方案文件夹很容易，甚至可以在一个简单的批处理文件中完成，但我不确定如何自己更新项目文件......）。

当然，我希望在某种模板中包含以上所有内容，以便开发新的 QA 工具的准备工作变得快速而简单。

我发现这个问题很难表述（我希望我足够清楚），但我确信这是在团队中工作时很常见的问题（我不习惯）。谁能帮我理解处理这个问题的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:02:04.073

这似乎是[源服务器](http://brockreeve.com/post/2009/10/23/Symbol-Server-Setup.aspx)的工作。显然（尽管我自己没有个人经验）这些工具已经可以用来对抗颠覆。这似乎比让他们都保留源文件的工作副本（甚至是只读副本）更好。

补充说明：上面的链接描述了作者使用 perforce 实现的源服务器，而不是 subversion，但是您应该能够找到其他链接（比如[这个](http://sander.rijken.info/post/2962017715/sourceserver-indexing-and-subversion)，也许更好的链接）特别讨论 subversion。

# jquery - javascript - 在动态生成布局中使用 jQuery UI 布局

> ID：11017324
> 
> 赞同：0
> 
> 时间：2012-06-13T14:40:44.597
> 
> 标签：jquery, ajax, dynamic, user-interface, jquery-ui-layout

我使用 jQuery UI Layout 插件来实现我的页面布局（拆分器）。

但是当动态加载布局（AJAX 视图加载）时我失败了。

布局插件可以用于动态加载布局页面吗？

我的情况：

1.  从服务器通过 AJAX 加载页面，页面匹配 UI 布局规则。
2.  使用UI布局插件初始化布局，但无法使用。

谢谢。

# node.js - node.js 缓慢地提供内容，但随后随机返回快速

> ID：11017326
> 
> 赞同：0
> 
> 时间：2012-06-13T14:40:49.383
> 
> 标签：node.js

情况很简单。我正在测试一个简单的 node.js 服务器，但我的浏览器说接收内容需要大约 200 毫秒（考虑到我的服务器是本地的，这太长了）。编码：

```
var http = require('http');

http.createServer(function(request, response) {

    console.log('>> '+request.url);

    response.writeHead(200, {'Content-Type': 'text/plain'});
    response.write('just no! because no!');
    response.end();

}).listen(80);

console.log('server running at port 80'); 
```

我使用命令在 ubuntu 中运行它`sudo node test.js`。

如您所见，响应非常小。但是，有时当我更改响应时，它会随机选择返回快速并花费约 9 毫秒左右。我在 chrome 的检查元素和 firefox 的 firebug 中进行了测试。我根本找不到模式，也找不到解释。发生了什么事，伙计们？谢谢 （：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-27T08:18:45.983

理想情况下只是尝试避免控制台日志语句。无论如何，我相信虚拟化在这里可能是一个问题，我一直在生产中使用 Node 并且从未见过这样的问题。您可能希望使用一些与性能相关的工具来测试您的代码，以防无法与您的管理员取得联系。

# perl - 在 Perl 中创建 glibc 2.7 样式的 Sha-512 加密哈希

> ID：11017330
> 
> 赞同：6
> 
> 时间：2012-06-13T14:41:02.350
> 
> 标签：perl, cryptography, passwords, salt, password-encryption

所以，我有一个网站，可以从数据库中读取/验证（和写入）密码哈希，并且我有一些东西可以为此制作 SHA-512 风格的密码哈希，看起来像：

```
$6$GloHensinmyampOc$AxvlkxxXk36oDOyu8phBzbCfLn8hyWgoYNEuqNS.3dHf4JJrwlYCqha/g6pA7HJ1WwsADjWU4Qz8MfSWM2w6F. 
```

该网站是基于 java 的，所以我为它写了一个 SHA-512 哈希。麻烦的是，有一堆运行的 perl cron 作业**还**需要偶尔验证数据库的密码哈希，并且由于这些作业在 Solaris 机器上运行，它的 crypt 不支持 $6$ 格式。

所以，当我这样做时：

```
printf("crypt => '%s'\n",crypt("Hello",'$1$CygnieHyitJoconf$')); 
```

我理智地回过神来：

```
crypt => '$1$CygnieHy$n9MlDleP0qmGCfpbnVYy11' 
```

然而，如果我这样做

```
printf("crypt => '%s'\n",crypt("Hello",'$6$CygnieHyitJoconf$')); 
```

我得到一个无益的

```
crypt => '' 
```

有没有办法在不使用 glibc 的机器上获取 Perl 中的 SHA-512 密码哈希？（这就是我在主要进行搜索时被告知的内容（“使用地穴”）。

我真的不想在 perl 中重新实现 SHA-512 密码哈希。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T18:14:32.957

实际上，我想我刚刚找到了自己的答案：[Crypt::Passwd::XS](http://search.cpan.org/perldoc?Crypt%3A%3APasswd%3A%3AXS)

Crypt::Passwd::XS - 通用 crypt() 算法的完整 XS 实现

它有 unix_md5、apache_md5、unix_des、unix_sha256 和 unix_sha512 .. 我想它没有做河豚有点不幸。但是，尽管如此，它解决了我的问题！无论如何感谢@hobbs！

```
use strict;
use Crypt::Passwd::XS;

{
        printf("crypt => %s\n",Crypt::Passwd::XS::crypt("Hello",'$6$CygnieHyitJoconf$'));
} 
```

现在返回

```
crypt => $6$CygnieHyitJoconf$vkGJm.nLrFhyWHhNTvOh9fH/k7y6k.8ed.N7TqwT93hPMPfAOUsrRiO3MmQB5xTm1XDCVlW2zwyzU48epp8pY/ 
```

正如预期的那样！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T15:10:26.787

不幸的是没有。`crypt`将是您的系统 libc `crypt`，它负责选择算法并将前缀字符串映射到算法。如果您想访问系统中没有的算法，`crypt`那么您需要使用它们的重新实现，对于 libc 的情况，我不知道有任何重新实现。glibc 的“SHA-512”密码哈希不仅仅是 SHA-512；这是我所知道的 glibc 之外不存在的自定义算法。如果您仍有机会，您可能希望更改为 bcrypt 或 PBKDF-SHA-2 之类的算法，该算法在不同语言中具有多种实现。

# jquery - 显示/隐藏 div 与滑动左\右动画

> ID：11017332
> 
> 赞同：7
> 
> 时间：2012-06-13T14:41:11.353
> 
> 标签：jquery, jquery-ui

我在这里试过这个：http: [//jsfiddle.net/92HXT/1/](http://jsfiddle.net/92HXT/1/)但它不起作用。仅当我使用`show("slow")`/时才有效`hide("slow")`。

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-13T14:51:55.953

虽然不是最清晰的动画，但我通过找到父级并隐藏所有兄弟级，让它按照我认为你想要的方式运行。我还不确定为什么这会将元素滑到左侧，而直接调用`.siblings()`似乎没有。

[看到这里](http://jsfiddle.net/92HXT/10/)。

正如其他人所提到的，使用类来识别一组项目是正确的方法，而不是通过 ID。

**更新**：

虽然我仍然不确定为什么siblings() 找不到您通过ID 找到的div 的兄弟姐妹，但我怀疑它与显示/隐藏甚至可能使用滑动动画的过程有关. 这是我建议的 jQuery/jQueryUI：

```
$('a.view-list-item').click(function () {
    var divname= this.name;
    $("#"+divname).show("slide", { direction: "left" }, 1000);
    $("#"+divname).parent().siblings(":visible").hide("slide", { direction: "left" }, 1000);
}); 
```

这是[更新的版本](http://jsfiddle.net/92HXT/13/)。

**更新**：

@jesus.tesh 对解决方案的[出色更新](http://jsfiddle.net/92HXT/15/)

**更新**：

@erwinjulius 对解决方案的行为[更新。](http://jsfiddle.net/erwinjulius/CgM3x/)我更改了 DIV 的定位，使其表现更好，允许用户快速单击链接而不会破坏动画。添加白色背景和左填充只是为了更好的效果呈现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-04T12:04:02.753

但是，此代码有效，元素中的名称标签已过时 W3C 标准。

我尝试使用 ID 不起作用，然后我将名称标签更改为标题，这也有效，并且您符合 W3C 标准！

因此，像这样将“名称”更改为“标题”，它的功能很棒，请参见此处：[http ://design65grafischontwerp.nl/#portfolio](http://design65grafischontwerp.nl/#portfolio)

```
<script type="text/javascript">
    $(document).ready(function() {
        $('a').click(function() {
            var divtitle = this.title;
            $("#" + divtitle).show("slow").siblings().hide(1000);
        });
    });
</script> 
```

# android - ExpandableListActivity 获取文本

> ID：11017335
> 
> 赞同：0
> 
> 时间：2012-06-13T14:41:27.623
> 
> 标签：android

我`ExpandableListActivity`在`Text`每个项目中都有。如何获取点击列表项的文本？

这是我的做法：

```
 groupData = application.getFirstLayer();
        String groupFrom[] = new String[] {"groupName"};
        int groupTo[] = new int[] {android.R.id.text1};

        childData = application.getSecondLayer();
        String childFrom[] = new String[] {"levelTwoCat"};
        int childTo[] = new int[] {android.R.id.text1};

        adapter = new SimpleExpandableListAdapter(
            this,
            groupData,
            android.R.layout.simple_expandable_list_item_1,
            groupFrom,
            groupTo,
            childData,
            android.R.layout.simple_list_item_1,
            childFrom,
            childTo);

public boolean onChildClick(android.widget.ExpandableListView parent,
            View v, int groupPosition, int childPosition, long id) {} 
```

我必须写什么`onChildClick`才能看到当前项目的文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:13:38.173

最简单的方法是直接从您单击的视图中获取它。您尚未显示行 XML，因此以下代码将假设您有一个带有 TextView 的 LinearLayout 作为您的行。

```
public boolean onChildClick(android.widget.ExpandableListView parent, 
        View v, int groupPosition, int childPosition, long id) {

            TextView exptv = (TextView)v.findViewById(R.id.yourtextview); //  Get the textview holding the text
            String yourText = exptv.getText().toString();  // Get the text from the view and put it in a string
            // use string as you need to
} 
```

如果 Layout*只是*一个 textview，你可以直接进入，`String yourText = v.getText().toString();`因为传入的 View v 将是你需要的 TextView。

**编辑**

正如 Jason Robinson 在他的评论中指出的那样，您正在使用`android.R.layout.simple_list_item_1`您的子布局，因为这只是一个 TextView，它简化了您需要的代码：

```
public boolean onChildClick(android.widget.ExpandableListView parent, 
        View v, int groupPosition, int childPosition, long id) {

            String yourText = v.getText().toString();  // Get the text from the view and put it in a string
            // use string as you need to
} 
```

# visual-studio - MSBuild：在一项任务中合并来自不同来源的信息

> ID：11017338
> 
> 赞同：2
> 
> 时间：2012-06-13T14:41:32.660
> 
> 标签：visual-studio, visual-studio-2008, msbuild

我想运行`<AL></AL>`MSBuild 的任务来创建发布者策略。为此，在我的`csproj`文件中，我创建了一个配置文件名列表：

```
<Target Name="AfterBuild">
   <ItemGroup>
     <ConfigFiles Include="$(TargetDir)\*.config" />
   </ItemGroup>
   <AL 
      LinkResources="%(ConfigFiles.Identity)" 
      Platform="x86" 
      KeyFile="$(ProjectDir)\KeyFile.snk" 
      OutputAssembly="$(TargetDir)\%(ConfigFiles.Filename).dll" 
      Version="@(PolicyVersion)" 
   />
</Target> 
```

如果我只需要一个版本号，这可以很好地工作`"@(PolicyVersion"`。但是如果每个配置文件需要不同的版本号怎么办？我可以从配置文件中的 XML 属性中检索版本号，但我不知道如何做到这一点，因此在批量构建期间它可用于相应的正确项目。

我还尝试了以下方法：配置文件名为`Policy.2.2xx.Mylib.config`. 这些是以编程方式创建的。此外，我创建了一个`Policy.2.2xx.Mylib.ver`甚至`MyLib.ver`包含版本信息的文件（每个文件都相同`Mylib`，但其他库可能不同），我可以使用

```
<ReadLinesFromFile File="$(TargetDir)\MyLib.ver">
  <Output TaskParameter="Lines" ItemName="PolicyVersion" />
</ReadLinesFromFile> 
```

但是我现在如何设法将`MyLib`（或`Policy.2.2xx.Mylib`）的版本信息与任务中的相应配置文件相关联`<AL>`？我尝试在阅读中使用`"%(ConfigFies.identity).ver"`as `ItemName`- 我希望我可以像`"$("%(ConfigFiles.identity).ver")"`在`AL`taks 中一样访问此信息，因此引用相同的 msbatch 循环，但这不起作用，因为点在项目名称中是非法的。

这可能就像从另外两个项目组中创建一个新项目组一样简单，但是到目前为止，我对这个 MS Build 怪物的经验还不够，无法完成这项工作。任何帮助将不胜感激。

（请注意，我使用的是 VS 2008）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T04:46:01.897

我不完全明白你需要什么。我认为您想从配置文件的名称中提取版本号并将其传递给任务的`Version`属性`AL`。

创建一个目标来包装对 的调用`AL`。通过对`ConfigFiles`项目组进行批处理来调用新目标。在您的目标中，使用字符串方法提取版本号：

```
<Target Name="AfterBuild">
    <ItemGroup>
        <ConfigFiles Include="$(TargetDir)\*.config" />
    </ItemGroup>

    <MSBuild Projects="$(MSBuildThisFileFullPath)"
             Properties="LinkResource=%(ConfigFiles.Filename)%(Extension)"
             Targets="_AL" />
</Target>

<Target Name="_AL">
    <Error Condition="'$(LinkResource)' == ''" Text="Missing LinkResource property." />
    <PropertyGroup>
        <_OutputFilename>$(LinkResource.Replace('.config', '')).dll</_OutputFilename>
        <_VersionNumber>$(_OutputFilename.Replace('Policy.',''))</_VersionNumber>
    </PropertyGroup>

    <AL 
        LinkResources="$(LinkResource)" 
        Platform="x86" 
        KeyFile="$(ProjectDir)\KeyFile.snk" 
        OutputAssembly="$(TargetDir)\$(_OutputFilename)" 
        Version="$(_VersionNumber)" />
</Target> 
```

# c# - 具有多个定义的接口 C#

> ID：11017339
> 
> 赞同：1
> 
> 时间：2012-06-13T14:41:34.940
> 
> 标签：c#, inheritance, interface, enums

我有几个基本的消息枚举，我将它们放入一个界面来控制它们。但是，当我这样做时，我需要支持旧消息，同时仍添加新消息。最好的方法是什么？

这是`Msg`接口的总体思路：

```
public interface Msg
{
    /// <summary>
    /// Gets the ID of the message
    /// </summary>
    Legacy_Msgs MessageId { get; }
    //New_Msgs MessageId { get; }    // How implement use this?

    /// <summary>
    /// Converts the message to a byte array representation
    /// </summary>
    byte[] MsgBytes { get; }
} 
```

但是我的问题是，为`New_Msgs`, 继承`Msg`和覆盖 的新接口是否`MessageId`更有意义，或者从效率的角度来看，为枚举提供一个全新`NewMsg`的接口是否更有意义。 我意识到这两种解决方案都可以工作，但我想知道作为另一个正在研究这种解决方案的开发人员，什么更有意义？`New_Msg`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:46:40.243

接口不能覆盖，但您可以通过接口将新项目添加到合同中。

如果行为将在实现之间发生变化，使得它们不向后兼容，那么您应该创建一个与旧接口/实现无关的全新接口/实现，因为有人可以创建新接口/实现的实例，并将其传递给期待旧的消费者。

单个实现可以实现这两个接口以尽可能保持兼容性。如果接口的成员有重叠，那么您可以使用显式接口实现将两个接口一起维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:51:56.857

如果其他人正在使用此界面（我认为任何一种解决方案都应该没问题），我建议使用“过时”标签来提醒其他开发人员有关更新的信息。

[http://msdn.microsoft.com/en-us/library/22kk2b44(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/22kk2b44(v=vs.80).aspx)

```
public interface INewMsgId : IMsgId
{
}

[System.Obsolete("use interface INewMsgId ")]
public interface ILegacyMsgId : IMsgId
{
{ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T14:48:17.407

这种结构可能会给你更多的灵活性，同时让你的`IMsg`合同对消费者来说是一致的。

```
// the following three MsgId contracts don't have to be contracts at all (the actual types can be specified in generic IMsg directly), but if one ID type is wildly different in nature than the other, an interface such as this might make sense.

public interface IMsgId
{
 // ?
}

public interface INewMsgId : IMsgId
{
}

public interface ILegacyMsgId : IMsgId
{
}

public interface IMsg<out TId>
   where TId : IMsgId
{
   TId MessageId { get; }

   byte[] MsgBytes { get; }
}

// if it is sensible, you can use the following interfaces to create definitive new and legacy message contracts

public interface INewMsg : IMsg<INewMsgId>
{
}

public interface ILegacyMsg : IMsg<ILegacyMsgId>
{
} 
```

这是一个实现示例：

```
public class LegacyMsgId : ILegacyMsgId
{
    public LegacyMsgId(int id)
    {
      Id = id;
    }

    public int Id { get; private set; }

    public override string ToString()
    {
        return "Legacy Message #" + Id;
    }
}

public class NewMsgId : INewMsgId
{
    public NewMsgId(int id)
    {
        Id = id;
    }

    public int Id { get; private set; }

    public override string ToString()
    {
        return "New Message #" + Id;
    }
}

public class NewMsg : INewMsg
{
    public NewMsg(int id)
    {
        MessageId = new NewMsgId(id);
    }

    public NewMsgId MessageId { get; private set; }

    INewMsgId IMsg<INewMsgId>.MessageId { get { return MessageId; } }

    public byte[] MsgBytes { get; private set; }
}

public class LegacyMsg : ILegacyMsg
{
    public LegacyMsg(int id)
    {
        MessageId = new LegacyMsgId(id);
    }

    public LegacyMsgId MessageId { get; private set; }

    ILegacyMsgId IMsg<ILegacyMsgId>.MessageId { get { return MessageId; } }

    public byte[] MsgBytes { get; private set; }
} 
```

和用法：

```
var messages = new List<IMsg<IMsgId>>();
messages.Add(new NewMsg(20));
messages.Add(new LegacyMsg(11));

foreach(var message in messages)
{
    Console.WriteLine(message.MessageId);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T14:50:20.907

> 但是我的问题是，为 New_Msgs 提供一个新接口是否更有意义，它继承了 Msg 并覆盖了 MessageId

您不能有与`override`s 的接口，但是您可以使用`new`，但这意味着两者具有相同的签名，这里不是这种情况。

如果您要定义新功能，它与以前的接口不向后兼容，那么我会建议类似`interface Msg2`which 不相关（即不继承）到`interface Msg`. 由于一个类可以实现多个接口，那么您的实际实现可以处理两个接口实现，同时保持定义分开，从而允许任何未来的代码选择是否处理遗留实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T15:07:28.210

您可以通过多种方式处理此问题：

1.  您可以重构代码以[用子类替换类型代码](http://sourcemaking.com/refactoring/replace-type-code-with-subclasses)。枚举基本上是具有一点类型安全性的普通常量，不适合 OOP 和版本控制。在 C# 中，它们不能扩展：

    ```
    public interface IMsg
    {
        // let `MessageType` be a class
        MessageType Type { get; }
        byte[] Data { get; }
    } 
    ```

2.  或者，您可以使用普通的 int ID，并将特定 MessageID 背后的实际含义与包含数据的简单对象分开。

    ```
    // let Msg be a dumb data object
    public interface IMsg
    {
        int Id { get; }
        byte[] Data { get; }
    }

    // and then keep their types weakly-typed
    private readonly Dictionary<int, String> MessageNames;

    // and you can also provide various type-based functionality
    // during runtime
    private readonly Dictionary<int, IParser> Parsers; 
    ```

`I`附带说明一下，在所有接口名称前加上大写字母是 .NET 命名约定。

# linux - 计算条件跳转

> ID：11017342
> 
> 赞同：1
> 
> 时间：2012-06-13T14:41:39.183
> 
> 标签：linux, assembly, branch, conditional, perf

我有一个菜鸟问题。我对 Linux 完全陌生。

我想计算程序采用的条件跳转的数量（即程序采用的 if()s、while()s 等的数量）。

有人告诉我我可以用 perf 做到这一点，我读了一遍，但我完全迷失了。

谁能告诉我该怎么做？例如，我有一个 C++ 程序，类似于：

```
...some code...
if(a=5)
  x=3;
else
  x=5;
...some code... 
```

并假设这段代码被编译成一个名为 tmp.txt 的文件。

我尝试发出以下内容：

```
perf stat ./tmp 
```

但是每次我得到的分支数量都不一样。

难道我做错了什么？

编辑：我应该提到我假设我没有可用的源代码。所以我在看二进制文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T18:54:21.103

每次运行程序时分支的数量都会发生变化，这是合乎逻辑的，因为在`main`函数之前执行的代码每次可能会做不同的事情。（例如：`perf stat true`每次都会报告不同数量的分支）。

有趣的`perf stat`是分支未命中的数量，这对程序执行速度有负面影响（除非您长时间运行具有 100% 分支未命中的程序，否则您不会看到它，所以它不是一个*真正*的重要的负面影响）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-19T14:18:17.957

好的，我找到了解决方案，但忘记在这里发布。计数分支应始终对应于程序中的分支数（if()s、whiles()s...）。事实证明，我可以通过使用硬件事件编号+Umask（参考：英特尔软件工程师手册）作为条件分支指令作为 perf stat 的参数来做到这一点！

# asp.net - ASP.Net 通过单击按钮在网站中动态创建页面

> ID：11017343
> 
> 赞同：1
> 
> 时间：2012-06-13T14:41:40.337
> 
> 标签：asp.net, dynamic-pages

我正在考虑为网站创建一个按钮，该按钮使用 CMS 控件动态创建支持页面...空白页面，因此不需要我们创建 12 个或更多然后部署，这样我就有了一个解决方案基本上会复制一个支持页面并将其重命名并将其放置在 SitePages 文件夹中...因此最终结果将是以这种方式创建的后续页面将共享相同的代码隐藏文件...这消除了构建和在每个页面创建时编译。这适用于我的本地机器和暂存...因为代码库没有预编译...但是在生产中，代码是预编译的，因此该解决方案基本上不起作用...

any1 对如何进行有任何想法吗？

问候，高塔姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T05:54:52.507

动态添加控件到页面：[www.asp.net/web-forms/videos/aspnet-ajax/how-to-dynamically-add-controls-to-a-web-page](http://www.asp.net/web-forms/videos/aspnet-ajax/how-to-dynamically-add-controls-to-a-web-page)

动态构建 asp.net 页面：[www.codeproject.com/Articles/25573/Building-ASP-NET-Web-Pages-Dynamically-in-the-Code](http://www.codeproject.com/Articles/25573/Building-ASP-NET-Web-Pages-Dynamically-in-the-Code)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:48:32.657

实现这一点的一种方法是，您的 aspx 页面未指定**Inherits**属性。对于仅支持 aspx 的页面，您可以在配置文件中定义基本页面类型，如下所示

```
<pages  pageBaseType="typename, assembly">
</pages> 
```

其中类型名称是您的代码类型/类，程序集是包含该类型的已编译程序集。因此，所有缺少 Inherits 元素的页面都应从配置类继承。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:49:31.097

当你预编译你的页面将引用一个 dll 而不是 cs。

```
<%@ page title="About Us" language="C#" masterpagefile="~/Site.master" autoeventwireup="true" inherits="About, App_Web_ad0b3bhg" %> 
```

在上面的例子中 App_Web_ad0b3bhg 是 dll。当您创建新文件时，您需要处理它。提供您的代码片段，以帮助我们更正它以适应这一点。

# mysql - 选择 MINs 和 MAXs 并比较它们

> ID：11017346
> 
> 赞同：0
> 
> 时间：2012-06-13T14:41:47.280
> 
> 标签：mysql

我有一个包含 id、sellprice、buyprice 和 date 列的表

```
id  sellprice   buyprice    date
1   15      17      2012-6-10 10:21:09
2   18      20      2012-6-10 10:23:34
3   22      24      2012-6-10 10:24:21
4   19      21      2012-6-10 10:25:23
5   17      20      2012-6-10 10:29:34
6   16      19      2012-6-10 10:31:43
7   15      17      2012-6-10 10:34:51
8   16      21      2012-6-10 10:36:13
9   21      23      2012-6-10 10:39:21 
```

我想选择 MIN buyprice 和 MAX sellprice；如果最高卖价在最低买价之后，那么我想比较一下我赚了多少钱——比如我从**17**买了，然后我卖了**22**。正如您在表中看到的，最小值和最大值可能会出现多次。如何查询以获得我想要的结果。

我正在尝试的查询有问题。如果我在 WHERE 子句中使用日期来限制，我会收到“子查询返回超过 1 行”警告并且什么也没有发生

```
$minmax_query="SELECT 
MAX(sellprice) AS maxprice,
(SELECT id FROM $table WHERE sellprice = max(t2.sellprice)   ) as maxId,

MIN(buyprice) AS minprice,
(SELECT id FROM $table   WHERE buyprice = min(t2.buyprice)    ) as minId
FROM $table   t2 WHERE DATE(date) = '2012-06-10' 
```

# python - Python和numpy中两个变量循环的列表理解

> ID：11017347
> 
> 赞同：2
> 
> 时间：2012-06-13T14:41:48.013
> 
> 标签：python, list, numpy

我必须使用matplotlib中的contourf从函数返回的值x，y创建一个二维numpy数组，到目前为止我使用的是类似“C”的结构，它在Python中似乎效率很低*：*

```
 dim_x = np.linspace(self.min_x, self.max_x, self.step)
    dim_y = np.linspace(self.min_y, self.max_y, self.step)
    X, Y = np.meshgrid(dim_x, dim_y)

    len_x = len(dim_x)
    len_y = len(dim_y)

    a = np.zeros([len_x, len_y], dtype=complex)

    for i, y in enumerate(dim_y):
        for j, x in enumerate(dim_x):
            a[i][j] = aux_functions.final_potential(complex(x, y), element_list)

cs = plt.contourf(X, Y, (a.real), 100) 
```

如何以更 Pythonic 的方式完成此操作？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:01:05.967

如果您可以重写`final_potential`为矢量化函数，那将是理想的。一个简单的，也许是太明显的例子：

```
>>> dim_x = np.linspace(0, 2, 5)
>>> dim_y = np.linspace(0, 2, 5)
>>> X * Y
array([[ 0\.  ,  0\.  ,  0\.  ,  0\.  ,  0\.  ],
       [ 0\.  ,  0.25,  0.5 ,  0.75,  1\.  ],
       [ 0\.  ,  0.5 ,  1\.  ,  1.5 ,  2\.  ],
       [ 0\.  ,  0.75,  1.5 ,  2.25,  3\.  ],
       [ 0\.  ,  1\.  ,  2\.  ,  3\.  ,  4\.  ]]) 
```

但如果你*真的不能*这样做，你也可以`vectorize`：

```
>>> np.vectorize(lambda x, y: x * y + 2)(X, Y)
array([[ 2\.  ,  2\.  ,  2\.  ,  2\.  ,  2\.  ],
       [ 2\.  ,  2.25,  2.5 ,  2.75,  3\.  ],
       [ 2\.  ,  2.5 ,  3\.  ,  3.5 ,  4\.  ],
       [ 2\.  ,  2.75,  3.5 ,  4.25,  5\.  ],
       [ 2\.  ,  3\.  ,  4\.  ,  5\.  ,  6\.  ]]) 
```

在您的情况下，它可能看起来像这样：

```
def wrapper(x, y): 
    return aux_functions.final_potential(complex(x, y), element_list)

a = np.vectorize(wrapper)(X, Y) 
```

这可能会比嵌套`for`循环快一点，尽管 python 函数调用的开销会抵消很多 numpy 的效率。在我过去所做的测试中，使用`vectorize`提供了适度的 5 倍加速。（这与纯 numpy 操作的 100 倍或 1000 倍加速相比，如`X * Y`示例中所示。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:50:01.203

我不知道这是否会提高你的性能，但是有[numpy.fromfunction](http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromfunction.html)可以用来构造你的数组`a`。如果没有一个很好的自包含示例，那么要确定时间来查看性能的差异会有点棘手。例如，运行需要多长时间`aux_functions.final_potential`？如果该功能很昂贵，那么您优化它周围的循环多少都没有关系。

另外，我想这`a[i,j]`比 更有效`a[i][j]`，但我还没有测试过。

# ruby-on-rails - 通过标头的令牌进行 rails-api 身份验证

> ID：11017348
> 
> 赞同：17
> 
> 时间：2012-06-13T14:41:49.637
> 
> 标签：ruby-on-rails, authentication, rails-api

我想使用**rails-api** gem special 来创建仅限 API 的应用程序。[为了提供身份验证机制，我想使用Railscasts #352](http://railscasts.com/episodes/352-securing-an-api)中描述的内置**authenticate_or_request_with_http_token**方法，但这里缺少此方法。

有人有使用**rails-api** gem 的经验吗？

PS我可以看到[这种方法](https://github.com/rails-api/rails-api/issues/29)，但这是否可以投入生产？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-02T19:27:48.327

我正在使用 rails-api 开发服务。我们还没有部署，但已经接近那个时间，并且在测试中没有任何问题。您需要包含您想要使用的任何非必要模块，因为 rails-api 已被向下修剪。我在 ApplicationController 中使用 authenticate_or_request_with_http_token ，如下所示：

```
include ActionController::HttpAuthentication::Token::ControllerMethods

def authenticate
  authenticate_or_request_with_http_token do |token, options|
    apiKey = ApiKey.where(auth_token: token).first
    @current_user = apiKey.user if apiKey
  end
end 
```

如果你只想要令牌，有一个方便的方法 token_and_options：

```
include ActionController::HttpAuthentication::Token

def current_user
  api_key = ApiKey.where(auth_token: token_and_options(request)).first
  User.find(api_key.user_id) if api_key
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T15:37:53.950

从[自述文件](https://github.com/spastorino/rails-api)：

> 基本、摘要和令牌身份验证：Rails 提供了对三种 HTTP 身份验证的开箱即用支持。

所以，是的，这是生产就绪的（毕竟它仍然是 Rails）。您链接到的示例是要走的路（诀窍是只包含您需要的 Action Pack）。

# delphi - 不考虑配置区域设置

> ID：11017354
> 
> 赞同：3
> 
> 时间：2012-06-13T14:42:09.590
> 
> 标签：delphi, localization, delphi-7

我的软件依赖于 Windows 语言环境配置才能正常工作。

我的客户一直都设置了 pt-br 区域设置，并且这样可以正常工作。

在一个用户的窗口中，pt-br 语言环境设置正确，但不知何故，我的软件获取了所有 us 配置。（. 作为小数分隔符，$ 作为货币符号等等）。

我有什么办法可以在我的软件中强制全局设置语言环境吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T10:30:30.130

遇到同样的问题，我找到了你的帖子。

我还发现了这个对我有帮助的线程（http://social.technet.microsoft.com/Forums/en-US/w7itprogeneral/thread/b4f90f07-206c-494b-8d14-ee17bfa689e0）。

这是方法：

> 如果您从控制面板（地球图标）/intl.cpl 中打开“区域和语言选项”，然后重新选择您的语言环境，它可能会解决问题。
> 
> 1) 打开区域和语言选项
> 
> 2）在“格式”下选择其他任何内容。（例如：英语（美国））。
> 
> 3) 按“申请”
> 
> 4) 在“格式”下选择您想要的语言环境（例如：英语（英国））。
> 
> 5) 按确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:08:06.937

由于您有 delphi-7，您可以执行以下操作：

> Application.UpdateFormatSettings := false;

这可以防止系统使用 Windows 默认值更新您的应用程序。

然后在应用程序启动时定义：

```
DecimalSeparator := '.'; // Or whatever preference you have
CurrencyString := '$'; // Or something else
... 
etc 
```

在 Delphi 2006 及更高版本中，此方法已被弃用，`TFormatSettings`首选使用 。如果部分应用程序在执行期间需要更改格式设置，它还可以处理重入问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T18:39:47.183

在 Windows 7 下，非 Unicode 应用程序（如 Delphi 7）的区域设置未在控制面板的主选项卡中设置。

您必须转到“管理”选项卡，然后选择“更改系统区域设置”。

![在此处输入图像描述](../Images/951259fa7ddf8736900abd19a723e388.png)

见[这篇文章](http://www.coscom.co.jp/japanesefont/nonunicode_win7.html)。

# java - 加载纹理后 TextRenderer 绘制不正确

> ID：11017361
> 
> 赞同：0
> 
> 时间：2012-06-13T14:42:36.083
> 
> 标签：java, opengl, jogl

我使用TextRenderer（com.jogamp.opengl.util.awt.TextRenderer）将文本绘制到屏幕上，但是在我加载一些纹理（否则可以正常工作）之后，文本不再是文本，而是其中一个纹理的一小部分我已经加载了。

我像这样加载纹理......

```
 gl2.glBindTexture(GL.GL_TEXTURE_2D, unit);
    gl2.glPixelStorei(GL.GL_UNPACK_ALIGNMENT, 1);
    gl2.glTexParameteri(GL.GL_TEXTURE_2D, GL.GL_TEXTURE_WRAP_S, GL2.GL_CLAMP);
    gl2.glTexParameteri(GL.GL_TEXTURE_2D, GL.GL_TEXTURE_WRAP_T, GL2.GL_CLAMP);
    gl2.glTexParameteri(GL.GL_TEXTURE_2D, GL.GL_TEXTURE_MAG_FILTER, GL.GL_LINEAR);
    gl2.glTexParameteri(GL.GL_TEXTURE_2D, GL.GL_TEXTURE_MIN_FILTER, GL.GL_LINEAR);
    gl2.glTexEnvf(GL2.GL_TEXTURE_ENV, GL2.GL_TEXTURE_ENV_MODE, GL.GL_REPLACE);
    gl2.glTexImage2D (GL.GL_TEXTURE_2D, 0, GL.GL_RGBA, getWidth(), getHeight(), 
            0, GL.GL_RGBA, GL.GL_UNSIGNED_BYTE, pixMap.getData());
    gl2.glEnable(GL.GL_TEXTURE_2D);
    pixMap.dispose();
    pixMap = null; 
```

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T05:59:47.510

我对班塔尔的评论的评论。往上看！

我没有使用 glGenTextures，因为我想控制纹理的参考编号，以为我知道自己在做什么，哈哈。是的，当然，字体正在将纹理加载到 GPU 中，然后我覆盖它，感谢您向我指出这一点。

# ruby-on-rails - Rails number_field 忽略haml视图中的要求

> ID：11017362
> 
> 赞同：1
> 
> 时间：2012-06-13T14:42:38.703
> 
> 标签：ruby-on-rails, validation, input, haml

我认为我有以下代码

```
.fields
   = f.label :minimum_mpg
   %br
   = f.number_field :mpg_min, :in => 0..100, :type => 'float' , :precision => 2 
```

我想将输入限制在 0 到 100 之间，但是当我输入负数时，它们会被接受。我认为这与将类型更改为浮动有关。输入需要能够接受浮点数。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:57:35.593

您的`:type => 'float'`行覆盖了`type="number"`生成的 HTML 标记的默认部分，有效地将其转换回标准文本字段而不是数字字段。

如果你需要接受两位小数，你可以这样做。但是，单击字段上的向上/向下箭头一次只会增加 0.01。

```
= f.number_field :mpg_min, :in => 0..100, :step => 0.01 
```

# python - 内部类方法应该返回值还是只修改实例变量？

> ID：11017364
> 
> 赞同：33
> 
> 时间：2012-06-13T14:42:43.253
> 
> 标签：python, oop, instance-variables

我正在创建一个查询构建器类，该类将有助于从 URL 参数构建对 mongodb 的查询。除了使用基本的语言结构和使用 django 的内置模型之外，我从来没有做过太多的面向对象编程，也没有设计过供我以外的人使用的类。

所以我有这`QueryBuilder`门课

```
class QueryHelper():
    """
    Help abstract out the problem of querying over vastly
    different dataschemas.
    """

    def __init__(self, collection_name, field_name, params_dict):
        self.query_dict = {}
        self.params_dict = params_dict
        db = connection.get_db()
        self.collection = db[collection_name]

    def _build_query(self):
        # check params dict and build a mongo query
        pass 
```

现在，`_build_query`我将检查`params_dict`并填充`query_dict`，以便将其传递给 mongo 的`find()`函数。在这样做时，我只是想知道是否有绝对正确的方法来确定是否`_build_query`应该返回字典或是否应该只修改`self.query_dict`. 由于它是一种内部方法，我认为只需修改`self.query_dict`. 有没有正确的方法（pythonic）方法来解决这个问题？这只是愚蠢而不是重要的设计决定吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-13T14:49:10.627

修改是非常好的，`self.query_dict`因为面向对象编程的整个想法是方法可以修改对象的状态。只要方法完成后对象处于一致状态，就可以了。这是一种内部方法这一事实`_build_query`并不重要。您可以选择在创建对象时调用`_build_query`after in`__init__`来构造查询。

该决定主要用于测试目的。出于测试目的，可以方便地单独测试每个方法，而不必测试整个对象的状态。但这不适用于这种情况，因为我们谈论的是内部方法，因此您独自决定何时调用该方法，而不是其他对象或其他代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-13T14:57:29.417

返回一个值是更可取的，因为它允许您将所有属性修改保留在一个位置 ( `__init__`)。此外，这使得以后扩展代码更容易；假设你想`_build_query`在子类中覆盖，那么覆盖方法可以只返回一个值，而不需要知道要设置哪个属性。这是一个例子：

```
class QueryHelper(object):
    def __init__(self, param, text):
        self._param = param
        self._query = self._build_query(text)

    def _build_query(self, text):
        return text + " and ham!"

class RefinedQueryHelper(QueryHelper):
    def _build_query(self, text):
        # no need to know how the query object is going to be used
        q = super(RefinedQueryHelper, self)._build_query()
        return q.replace("ham", "spam") 
```

与“二传手版本”相比：

```
class QueryHelper(object):
    def __init__(self, param, text):
        self._param = param
        self._build_query(text)

    def _build_query(self, text):
        self._query = text + " and ham!"

class RefinedQueryHelper(QueryHelper):
    def _build_query(self, text):
        # what if we want to store the query in __query instead?
        # then we need to modify two classes...
        super(RefinedQueryHelper, self)._build_query()
        self._query = self._query.replace("ham", "spam") 
```

如果您确实选择设置属性，则可能需要调用该方法`_set_query`以清楚起见。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-13T15:00:38.407

如果您返回任何东西，我建议`self`。从实例方法返回`self`对于方法链接来说很方便，因为每个返回值都允许在同一个对象上调用另一个方法：

```
foo.add_thing(x).add_thing(y).set_goal(42).execute() 
```

这有时被称为“流利的”API。

`int`然而，虽然 Python 允许对诸如and之类的不可变类型进行方法链接`str`，但它并没有为诸如`list`and之类的可变容器的方法提供它——根据`set`设计——因此为你自己的可变类型这样做可以说不是“Pythonic”。尽管如此，许多 Python 库确实具有“流畅”的 API。

缺点是这样的 API 会使调试变得更加困难。由于您执行整个语句或不执行任何语句，因此您无法轻松地在语句的中间点看到对象。当然，我通常发现`print`完全可以调试 Python 代码，所以我只需`print`在任何我感兴趣的返回值的方法中抛出一个！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-13T15:06:42.670

虽然对象的方法直接修改其状态是很常见的，但有时将对象作为自己的“客户端”并通过（通常）私有访问方法间接访问自己可能是有利的。在 Python 中，您可以使用内置的[`property()`](https://docs.python.org/3/library/functions.html#property)类/函数轻松完成此操作。

这样做提供了更好的[封装](https://en.wikipedia.org/wiki/Encapsulation_(computer_programming))和随之而来的好处（主要是实现细节的隔离）。然而，这样做可能是不切实际的，因为它需要太多额外的代码并且通常速度较慢，这可能会对性能产生不可接受的负面影响——因此必须经常根据这个理想进行权衡。

# ios - xCode 4.3 如何以编程方式访问界面生成器调色板颜色？

> ID：11017366
> 
> 赞同：7
> 
> 时间：2012-06-13T14:42:46.047
> 
> 标签：ios, interface-builder, xcode4.3, uicolor, color-palette

我正在界面构建器中构建界面，并看到有多种调色板可用于选择字体和背景颜色：

```
background color>other>color widget 3rd tab > Palette 
```

其中一些有奇怪的名字，如“冰”、“天空”等。

从我的代码中我可以访问

```
[UIColor blueColor];
[UIColor cyanColor]; 
```

**有没有办法让我从我的代码中按名称访问这些额外的颜色？** 例如，

```
//Is there a method call that does something like this?
[Color colorNamed:@"Ice" inPalette:@"Apple"]; 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T15:03:21.010

您需要从蜡笔颜色中获取所需颜色的 RGB 值。您可以通过这种方式访问​​它们，“Sky”将是：`[UIColor colorWithRed:(102.0/255.0) green:(204.0/255.0) blue:(255.0/255.0) alpha:1.0];`

或添加`UIColor`类别以添加您需要的所有颜色：`[UIColor skyColor];`

补充`UIColor+Colors.h`：

```
@interface UIColor (Colors)
+(UIColor *)skyColor;
@end 
```

补充`UIColor+Colors.m`：

```
@implementation UIColor (Colors)
+(UIColor *)skyColor
{
  static UIColor *color = nil;
  if (!color)
    color = [[UIColor alloc] initWithRed:(102.0/255.0) green:(204.0/255.0) blue:(255.0/255.0) alpha:1.0];
  return color;
}
@end 
```

# java - 在java中添加非常小的值

> ID：11017367
> 
> 赞同：1
> 
> 时间：2012-06-13T14:42:47.113
> 
> 标签：java

我目前正在使用 java 中的一个程序，该程序需要将一个小的常量值（例如 0.00000000001）添加到一个双变量，例如。地点。但是，当我运行代码时，对其进行调试，然后到达我将 0.00000000001 添加到位置的位置，并在添加后在调试模式下检查位置的值。该位置似乎没有添加 0.00000000001。例如，位置在添加之前等于 438.0，在添加之后等于 438.0。这是简单代码的示例

位置 += 0.00000000001

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T14:45:34.903

由于存储方式的原因，许多双精度值在 Java 中并不完全精确。精确精度仅适用于某些值。这是因为 Java 只能将十进制值存储为许多 2^n (s) 的组合。

例如：`1/4`可以存储为`2^-2`，但`1/3`将存储为`2^-2 + 2^-3+ 2^-4 +2^-5...`，因此`1/3`是一个不完全精确的值的示例

如果您想要一个精确的值，请使用`BigDecimal`该类：

[http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-13T14:45:45.080

您需要使用[BigDecimal](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html)以获得更好的精度。

例子：

```
BigDecimal test = new BigDecimal(438.0);
test = test.add(new BigDecimal(0.0000000000001));
System.out.println(test); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-13T14:45:58.943

使用 BigDecimal 类。它具有任意精度，并且能够处理微小的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-13T14:46:05.387

如果您超过`double`添加非常小的值的精度，则不会执行任何操作。

```
for (double d = 438; d < 1e7; d *= 10) {
    double location = d;
    location += 0.00000000001;
    System.out.println(location);
} 
```

印刷

```
438.00000000001
4380.00000000001
43800.00000000001
438000.0
4380000.0 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-13T14:47:36.873

您可能遇到了舍入错误或下溢。我会尝试使用[BigDecimal](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html)来获得任意精度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-13T14:53:34.727

你应该阅读[http://firstclassthoughts.co.uk/java/traps/java_double_traps.html](http://firstclassthoughts.co.uk/java/traps/java_double_traps.html)

这涉及到 java 如何存储和处理双精度和浮点数，以及在使用和比较它们时它们的含义。

这基本上是一个“你看到的不是你得到的”的例子

如果你决定使用大十进制，这有它自己的陷阱案例

[http://firstclassthoughts.co.uk/java/traps/big_decimal_traps.html](http://firstclassthoughts.co.uk/java/traps/big_decimal_traps.html)

这真的归结为您要添加 0.00000000001 做什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-13T16:26:28.750

还有一件事要添加到另一个答案中。问题不在于值太小。更大的价值=更大的不公平。看一个例子：

```
 float x = 20000000.0f;
 for (int i = 0; i < 10000000; i++) {
     x += 1;
 }
 System.out.println(x); // prints 20000000.0f, not 30000000.0f! 
```

因此，如果您在循环中使用浮点数，您将永远无法退出此循环

# git - Git 流程：谁能解释一下签入/签出流程？

> ID：11017372
> 
> 赞同：0
> 
> 时间：2012-06-13T14:43:02.817
> 
> 标签：git, git-extensions

我已经使用 tortoise SVN 几年了，但现在开始使用 Git。谁能解释一下在 Git 中执行以下操作的过程是什么：

获取最新信息，签到

我已成功克隆存储库，进行更改，提交然后推送更改。Git 说一切正常，但我看不到远程服务器上的更改。

我的设置是：

带有 Git 存储库的远程服务器和连接到 Git 以获取解决方案的本地副本以处理的开发机器。

另外，当我在本地机器上查看历史记录时，一切都很好！它显示了所有历史记录，当我去服务器时，没有显示更改！

如果我做得不对，请告诉我！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:02:17.653

使用[git pull](http://git-scm.com/docs/git-pull)将来自上游的更改合并到本地分支，并使用[git push](http://git-scm.com/docs/git-push)将本地更改推送到远程存储库。

Pro Git的[使用遥控器](http://git-scm.com/book/en/Git-Basics-Working-with-Remotes)章节有更多示例。

# django - 公共 POST URL 的安全最佳实践

> ID：11017377
> 
> 赞同：1
> 
> 时间：2012-06-13T14:43:20.557
> 
> 标签：django, json, security

我正在使用 Django 编写一个简单的博客，并且包含一个 Python CLI 脚本，它允许我通过将条目作为 JSON 发送到`blog.com/post`. 现在我显然不希望任何人能够在我的博客上发布条目，所以我需要采取一些安全措施。

似乎作为 URL 参数传递的密码是一个很好的起点——我将发送一个 POST 到`blog.com/post?key=foobar`. 只是为了安全起见，我应该将它存储在服务器上加盐和散列。这就是所有必要的吗？我还计划在准备好后将代码放到 Github 上；这会影响我做出的任何安全决定吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:48:32.803

Tbh 我不会费心重新发明轮子，看看 django-tastypie，它实现了一些实现 REST 调用的好方法。它附带 django 和 api 密钥身份验证（以及更多），并允许您添加自定义身份验证行为

# java - 在 JSP 中显示上传的图像

> ID：11017378
> 
> 赞同：1
> 
> 时间：2012-06-13T14:43:23.380
> 
> 标签：java, jsp, tomcat, file-upload, image-uploading

我正在编写一个简单的网络应用程序，允许用户在网站上发布广告。他们还可以上传图片——我将它们保存在 webapp 目录之外。这是我的问题 - 在 JSP 页面中显示这些图像的最简单方法是什么？该应用程序部署在 Tomcat 上。

我将非常感谢任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:51:58.520

如果无法通过 HTTP 访问存储图像的路径，我建议编写一个简单的 servlet。

这是 BalusC 博客中的一个很好[的](https://stackoverflow.com/users/157882/balusc)例子[。](http://balusc.blogspot.co.uk/2007/04/imageservlet.html#ImageServletServingFromAbsolutePath)

# python - pyPdf 忽略 PDF 文件中的换行符

> ID：11017379
> 
> 赞同：8
> 
> 时间：2012-06-13T14:43:24.257
> 
> 标签：python, string, pdf, unicode, pypdf

我正在尝试将 PDF 的每一页提取为字符串：

```
import pyPdf

pages = []
pdf = pyPdf.PdfFileReader(file('g-reg-101.pdf', 'rb'))
for i in range(0, pdf.getNumPages()):
    this_page = pdf.getPage(i).extractText() + "\n"
    this_page = " ".join(this_page.replace(u"\xa0", " ").strip().split())
    pages.append(this_page.encode("ascii", "xmlcharrefreplace"))
for page in pages:
    print '*' * 80
    print page 
```

但是这个脚本忽略了换行符，给我留下了乱七八糟的字符串，比如`information concerning an individual which, because of name, identifyingnumber, mark or description`（即，这应该`identifying number`是 ，而不是`identifyingumber`）。

这是我尝试解析的 PDF 类型[的示例。](http://www.mass.gov/eohhs/docs/dta/g-reg-101.pdf)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-19T18:55:26.653

我对 PDF 编码了解不多，但我认为您可以通过修改`pdf.py`. 在该`PageObject.extractText`方法中，您会看到发生了什么：

```
def extractText(self):
    [...]
    for operands,operator in content.operations:
        if operator == "Tj":
            _text = operands[0]
            if isinstance(_text, TextStringObject):
                text += _text
        elif operator == "T*":
            text += "\n"
        elif operator == "'":
            text += "\n"
            _text = operands[0]
            if isinstance(_text, TextStringObject):
                text += operands[0]
        elif operator == '"':
            _text = operands[2]
            if isinstance(_text, TextStringObject):
                text += "\n"
                text += _text
        elif operator == "TJ":
            for i in operands[0]:
                if isinstance(i, TextStringObject):
                    text += i 
```

如果运算符是`Tj`或`TJ`（在您的示例 PDF 中为 Tj），则仅附加文本并且不添加换行符。现在您不一定*要*添加换行符，至少如果我正在阅读 PDF 参考正确：`Tj/TJ`只是单个和多个显示字符串运算符，并且某种分隔符的存在不是强制性的。

无论如何，如果您将此代码修改为类似

```
def extractText(self, Tj_sep="", TJ_sep=""): 
```

[...]

```
 if operator == "Tj":
            _text = operands[0]
            if isinstance(_text, TextStringObject):
                text += Tj_sep
                text += _text 
```

[...]

```
 elif operator == "TJ":
            for i in operands[0]:
                if isinstance(i, TextStringObject):
                    text += TJ_sep
                    text += i 
```

那么默认行为应该是相同的：

```
In [1]: pdf.getPage(1).extractText()[1120:1250]
Out[1]: u'ing an individual which, because of name, identifyingnumber, mark or description can be readily associated with a particular indiv' 
```

但是您可以在需要时更改它：

```
In [2]: pdf.getPage(1).extractText(Tj_sep=" ")[1120:1250]
Out[2]: u'ta" means any information concerning an individual which, because of name, identifying number, mark or description can be readily ' 
```

或者

```
In [3]: pdf.getPage(1).extractText(Tj_sep="\n")[1120:1250]
Out[3]: u'ta" means any information concerning an individual which, because of name, identifying\nnumber, mark or description can be readily ' 
```

或者，您可以通过就地修改操作数本身来简单地添加分隔符，但这可能会破坏其他内容（例如`get_original_bytes`让我紧张的方法）。

最后，`pdf.py`如果您不想编辑自己，则不必编辑：您可以简单地将这个方法拉出到一个函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T14:27:18.293

pyPdf 并不是真正为这种文本提取而设计的，请尝试使用[pdfminer](http://www.unixuser.org/~euske/python/pdfminer/index.html)（如果您不介意创建另一个进程，请使用 pdftotext 或类似的东西）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-21T07:46:16.720

扩展 DSM 的答案。以下是如何通过扩展几个类来实现它

```
import PyPDF2
import pandas as pd
from PyPDF2.generic import TextStringObject
from PyPDF2.pdf import ContentStream, IndirectObject, NameObject
from PyPDF2.utils import b_, u_

class PageObject2(PyPDF2.pdf.PageObject):
    def extractText(self, Tj_sep="", TJ_sep=""):
        """
        Locate all text drawing commands, in the order they are provided in the
        content stream, and extract the text.  This works well for some PDF
        files, but poorly for others, depending on the generator used.  This will
        be refined in the future.  Do not rely on the order of text coming out of
        this function, as it will change if this function is made more
        sophisticated.

        :return: a unicode string object.
        """
        text = u_("")
        content = self["/Contents"].getObject()
        if not isinstance(content, ContentStream):
            content = ContentStream(content, self.pdf)
        # Note: we check all strings are TextStringObjects.  ByteStringObjects
        # are strings where the byte->string encoding was unknown, so adding
        # them to the text here would be gibberish.
        for operands, operator in content.operations:
            if operator == b_("Tj"):
                _text = operands[0]
                if isinstance(_text, TextStringObject):
                    text += Tj_sep
                    text += _text
            elif operator == b_("T*"):
                text += "\n"
            elif operator == b_("'"):
                text += "\n"
                _text = operands[0]
                if isinstance(_text, TextStringObject):
                    text += operands[0]
            elif operator == b_('"'):
                _text = operands[2]
                if isinstance(_text, TextStringObject):
                    text += "\n"
                    text += _text
            elif operator == b_("TJ"):
                for i in operands[0]:
                    if isinstance(i, TextStringObject):
                        text += TJ_sep
                        text += i
                text += "\n"
        return text

class PdfFileReader2(PyPDF2.PdfFileReader):
    def _flatten(self, pages=None, inherit=None, indirectRef=None):
        inheritablePageAttributes = (
            NameObject("/Resources"), NameObject(
                "/MediaBox"),
            NameObject("/CropBox"), NameObject("/Rotate")
        )
        if inherit == None:
            inherit = dict()
        if pages == None:
            self.flattenedPages = []
            catalog = self.trailer["/Root"].getObject()
            pages = catalog["/Pages"].getObject()

        t = "/Pages"
        if "/Type" in pages:
            t = pages["/Type"]

        if t == "/Pages":
            for attr in inheritablePageAttributes:
                if attr in pages:
                    inherit[attr] = pages[attr]
            for page in pages["/Kids"]:
                addt = {}
                if isinstance(page, IndirectObject):
                    addt["indirectRef"] = page
                self._flatten(page.getObject(), inherit, **addt)
        elif t == "/Page":
            for attr, value in list(inherit.items()):
                # if the page has it's own value, it does not inherit the
                # parent's value:
                if attr not in pages:
                    pages[attr] = value
            pageObj = PageObject2(self, indirectRef)
            pageObj.update(pages)
            self.flattenedPages.append(pageObj)

# creating an object
file = open('travelers.pdf', 'rb')

# creating a pdf reader object
fileReader = PdfFileReader2(file)

# print the number of pages in pdf file
no_of_pages = fileReader.numPages

pageObj = fileReader.getPage(page_no)
page = pageObj.extractText(Tj_sep='\n') 
```

# .net - 如何在 MVC4 的 APIController 中使用我自己的依赖解析器

> ID：11017382
> 
> 赞同：4
> 
> 时间：2012-06-13T14:43:32.563
> 
> 标签：.net, dependency-injection, asp.net-mvc-4, .net-4.5

回到 MVC3，我有一个自定义`ControllerFactory`，它将使用我自己的容器（由我的业务逻辑抽象）来实例化控制器并传递他们需要的服务。

我正在尝试使用新的`ApiController`.

我有一个静态/共享方法`Core.DependencyResolverFactory.Resolver`，它返回一个`IDependencyResolver`. 这又具有许多方法`Resolve(...)`和`ResolveAll(...)`重载。

那么...我如何在 MVC4 中实现相同的功能？

`Microsoft.Practices.ServiceLocation.IServiceLocator`我尝试设置自己的 ServiceLocator，但在任何框架程序集中都找不到接口。

我不太担心被绑定到底层容器，因为它已经被 BL 抽象了，所以实际上我只需要一种快速而肮脏的方法来将我的类注入 MVC 的 DI。

有人可以指点我一个好的教程吗？

我现在所拥有的......

```
Sub Application_Start()
    ...Snip...

    'Suggested in the link on jrummel's answer...
    GlobalConfiguration.Configuration.DependencyResolver = New WebResolver
    'It fails due to DependencyResolver not being defined

    'I do have a 
    GlobalConfiguration.Configuration.ServiceResolver = New WebResolver
    'but it's read-only and it is of type System.Web.Http.Services.DependencyResolver not IDependencyResolver

End Sub

Private Class WebResolver
    Implements IDependencyResolver

    Private Resolver As Common.Interfaces.IDependencyResolver = Core.DependencyResolverFactory.QuickResolver

    Public Function GetService(serviceType As Type) As Object Implements IDependencyResolver.GetService
        Return Resolver.Resolve(serviceType)
    End Function

    Public Function GetServices(serviceType As Type) As IEnumerable(Of Object) Implements IDependencyResolver.GetServices
        Return Resolver.ResolveAll(serviceType)
    End Function
End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:49:23.513

ASP.NET Web API beta 自带`IDependencyResolver`，独立于 MVC。

asp.net上有一个教程：[使用Web API Dependency Resolver](http://www.asp.net/web-api/overview/extensibility/using-the-web-api-dependency-resolver)

您可以[从 NuGet 获取 ServiceLocator](http://nuget.org/packages/CommonServiceLocator)。

# jquery - 使用 jQuery UI 对话框获得的输入文本数据在第二个对话框打开后不更新其值

> ID：11017383
> 
> 赞同：2
> 
> 时间：2012-06-13T14:43:35.063
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

我声明了一个按钮：

```
<button id="create" type="button">add div</button> 
```

并且我想在每次使用 jQuery UI 对话框单击按钮时向文档正文添加一个新的 div 元素，如下所示：

```
var form = $("<div>", {id:"form"});

    form.append(
        $("<input>")
            .attr({
                "type" : "text",
                "id" : "user-input"
            })
    )
    .dialog({
        width: 600,
        buttons: {
            "Ok": function() {
                var new_div = $("<div>").html($("#user-input").val()).addClass("destiny_div");
                new_div.appendTo($("body"));
                $(this).dialog("close");
            }}
    }); 
```

我第一次单击该按钮时它工作正常，但第二次，我写入输入文本框中的文本没有更新为新值，而是采用第一个放置的值。

例如，如果我第一次输入“hello”并单击“ok”按钮，则会在正文中添加一个新的 div，其中包含文本“hello”，但是当我第二次输入时，现在输入“goodbye”，将添加一个新的 div，但其中包含文本“hello”，而不是“goodbye”。

这是我的代码：http: [//jsfiddle.net/vWQ9T/](http://jsfiddle.net/vWQ9T/)

关于它为什么会这样工作的任何想法？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:58:39.827

每次插入 div 时都会附加您的对话框。因此，您第二次单击该按钮时，它仍然会从第`#user-input`一个对话框中取出第一个。因此，您必须在使用 close-Parameter 关闭对话框后删除表单：

```
close: function () {
    form.remove()
} 
```

看看你的更新 jsfiddle：http: [//jsfiddle.net/vWQ9T/1/](http://jsfiddle.net/vWQ9T/1/)

# ruby-on-rails - 在 Rails 中使用 YAJL 拉取流式 API

> ID：11017387
> 
> 赞同：2
> 
> 时间：2012-06-13T14:43:44.003
> 
> 标签：ruby-on-rails, ruby, api, yajl

我正在尝试让 YAJL 在我的应用程序中工作 - 一直在通过 Twitter API 和 Digg API 对其进行测试，但我似乎无法让它工作。

我不确定我哪里出错了。使用此代码进入 Twitter 流 API：（已删除用户名/密码）

```
max_allowed_errors = 1200
consecutive_errors = 0
while consecutive_errors < max_allowed_errors do
  url = URI.parse("https://[username]:[password]!@stream.twitter.com/1/statuses/sample.json")
  begin
    Yajl::HttpStream.get(url) do |status|
      consecutive_errors = 0
     # puts status.inspect
    end
  rescue Yajl::HttpStream::InvalidContentType
    consecutive_errors += 1
  end
  sleep(0.25*consecutive_errors)
end 
```

我收到一个错误：

```
Yajl::HttpStream::HttpError in DashboardsController#streamit

Code 200 expected got 0 
```

错误指的是这一行：

```
Yajl::HttpStream.get(url) do |status| 
```

我想避免使用特定于 API 的 gem，这样我就可以重用代码并在未来利用其他 API（即 TweetStream）。

在此先感谢您的帮助！如果您有任何问题，或者我是否可以澄清这一点，请告诉我。

哦！我会注意，如果您有建议，我愿意接受其他宝石来管理流媒体。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T16:07:58.777

我认为问题在于当您进行 HTTPS 调用时，它需要协商 SSL。如果您查看源代码，您会看到：

```
 socket = opts.delete(:socket) || TCPSocket.new(uri.host, uri.port)
    request = "#{method} #{uri.path}#{uri.query ? "?"+uri.query : nil} HTTP/1.1\r\n" 
```

来源在这里：[https ://github.com/brianmario/yajl-ruby/blob/master/lib/yajl/http_stream.rb](https://github.com/brianmario/yajl-ruby/blob/master/lib/yajl/http_stream.rb)

似乎它所做的只是打开一个普通的 TCP 套接字。

对于 ssl ，它可能应该使用[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/SSL/SSLSocket.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/SSL/SSLSocket.html)

# vim - 合成在 Vim 中工作，但不在 gVim 中

> ID：11017388
> 
> 赞同：1
> 
> 时间：2012-06-13T14:43:51.520
> 
> 标签：vim, syntax-checking, syntastic

我在 Debian（测试）上安装了 Vim（7.3），我最近改用 gVim 而不是命令行 Vim（用于拼写错误单词的颜色方案和下卷曲）。

现在我编写了一些 Haskell 代码并错过了漂亮的 Syntastic 错误。当我输入`:SyntasticCheck`任何内容时，如果我激活该`ErrorsToggle`功能以获取 QuickFix 窗口 - 我会收到一条消息：

```
Error detected while processing function ErrorsToggle:

E776: No location list 
```

我知道没有可以打开快速修复窗口的列表，但我不知道为什么没有，因为我之前调用过`SyntasticCheck`，它应该创建了一个位置列表。

如果我在命令行 Vim 中打开同一个文件 - 一切都很好。我安装的插件[.vimrc](https://github.com/epsilonhalbe/dotfiles/blob/master/vim)[和](https://github.com/epsilonhalbe/dotfiles/blob/master/_vimrc).gvimrc[可以](https://github.com/epsilonhalbe/dotfiles/blob/master/_gvimrc)在 github.com 找到。

## 编辑：

如果我从命令行调用，gVim 正在使用 syntastic，`gvim myfile.hs`但是如果我通过 ex 命令导航到文件然后打开文件，它就不起作用。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-15T09:35:09.127

我认为你应该安装`ghc-mod`：

```
cabal install ghc-mod 
```

我有一个类似的问题，并解决了它。似乎 Syntastic 使用它： [https](https://github.com/scrooloose/syntastic/blob/master/syntax_checkers/haskell.vim) ://github.com/scrooloose/syntastic/blob/master/syntax_checkers/haskell.vim （第 18 行）

# macos - 如何将 eps 文件复制到剪贴板/粘贴板？

> ID：11017389
> 
> 赞同：0
> 
> 时间：2012-06-13T14:43:53.407
> 
> 标签：macos, cocoa, macos-carbon, eps, pasteboard

我的程序创建 adobe ai 或 (eps) 文件，我想将其复制到粘贴板。我在 adobe illustrator 中复制了示例 ai 对象，并通过“粘贴板检查器”检查粘贴板：

![在此处输入图像描述](../Images/ef7a02112f17e1ca46a388b5946b4d71.png)

我的代码在下面，但没有复制到粘贴板：

```
void copyEPS(CFDataRef data)
{
    OSStatus err = noErr;
    PasteboardRef theClipboard;

    err = PasteboardCreate(kPasteboardClipboard, &theClipboard);
    // err is 0
    err = PasteboardClear(theClipboard);
    // err is 0
    PasteboardSynchronize(theClipboard);

    err = PasteboardPutItemFlavor(theClipboard, (PasteboardItemID)1,
        CFSTR("AICB"), data, 0);
    // err is 0
    CFRelease(data);
} 
```

我该怎么做？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T01:40:32.290

的类型字符串是 UTI，因此在这种情况下`PasteboardPutItemFlavor()`可能应该设置为。`CFSTR("com.adobe.encapsulated-postscript")`Cocoa API 也可以与类似的输入一起使用。

# objective-c - iOS App 使用 Windows Azure 服务管理 API 的可行性？

> ID：11017390
> 
> 赞同：1
> 
> 时间：2012-06-13T14:43:55.363
> 
> 标签：objective-c, ios, ssl, azure, https

我一直在努力设置一个利用服务管理 API 的 iOS (Objective-C) 应用程序。我已经成功地让存储 API 调用正常工作，但从我所读到的内容来看，两个 Azure API 之间的一大区别似乎是身份验证问题。作为参考，我最想做的是设置一个简单的 API 调用来列出应用程序中的托管服务帐户（最终适用于公共部署）。

根据 API Azure 文档，服务管理 API 需要上传管理证书 (.cer)，然后客户端才能使用该证书对请求进行身份验证。我的预感是，这将阻止像我想要创建的应用程序以任何方式可行，因为具有包含已下载应用程序的设备的公共用户将不具有该证书或以编程方式将其附加到目标 c 中的能力代码。

我的预感是否正确？这是一个不应该追求的荒谬想法吗？我认为要使这成为可能，用户将需要以某种方式将其设备的证书文件上传到 Azure，然后以某种方式让应用程序使用此证书进行身份验证。即使有可能，我什至不知道从哪里开始。:(

任何有用的信息将不胜感激。我在 iOS 方面有很多经验，但特别是在这种类型的身份验证/证书方面，不幸的是我的经验很少。

提前致谢！！-文森特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T18:08:36.950

实际上，我有一个应用程序可以完全满足您的要求。 [CloudTools for Windows Azure](https://www.cloudanalyzer.net/mobile/cloudtools)是一个 iOS 应用程序，它使用 Azure 管理服务 API 来执行 Azure 管理。它在 iTunes 上已经存在一年多了。

你的问题有点笼统，但我可以告诉你，证书问题是迄今为止设计/开发应用程序的最大问题。您不能将证书存储在钥匙串中，因为钥匙串的工作方式如下：a）您请求需要证书的远程 URL；b）该网址告诉您它需要证书，并且 c）钥匙串提供了适当的证书。这是一个多请求过程。这*不适*用于 Azure，因为 Azure 服务管理 API 期望初始调用*包含*证书。

I require the users to add their certificate through iTunes File Sharing ([steps here](https://www.cloudanalyzer.net/mobile/addcertificate)). Of course, they have to upload the public key portion to Azure. Then, I provide the certificate and private key with each request. I use the HTTP library [ASIHttpRequest](http://allseeing-i.com/ASIHTTPRequest/), although I believe that the latest (iOS 5.x) Apple libraries have similar functionality.

I'd be happy to provide any further details if you have any follow-up questions.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T16:51:21.887

对于 Windows Azure，如果您使用的是服务管理 API，那么您确实需要基于证书的身份验证来在请求连接的计算机和 Windows Azure 管理门户之间创建 SSL 隧道。我不确定您的 iOS 应用程序分布范围有多广。

我的第一个想法是为什么要从 iOS 应用程序部署 Windows Azure 应用程序，你要在 iOS 设备中构建应用程序并进行部署吗？Windows Azure 应用程序部署主要在客户端机器上完成，因此，iOS 上的 Azure 应用程序管理是个好主意，但是从 iOS 部署应用程序不知道为什么。可能是你在这里做大事。在这两种情况下，你真的需要 iOS 设备上的服务管理证书。如果是企业应用，可以让用户安装 Service Management 证书，iOS 设备使用 Service Mgmt API 会更容易。

因此，如果您想从客户端 iOS 应用程序使用服务管理 API，我认为最好的解决方案是将 WCF 服务托管在 Windows Azure 中，该服务被配置为直接连接到您的 Windows Azure 门户。从您的 iOS 应用程序中，您只需调用您的 WCF 服务。这是从任何客户端应用程序（WP7、iOS、Android）访问服务管理 API（通过 WCF 服务）的非常流行的方法，并且客户端代码非常轻量。另一方面，您可能需要付费才能在 Windows Azure 上托管 WCF 服务。

# ms-access - 将文本框绑定到字段

> ID：11017394
> 
> 赞同：0
> 
> 时间：2012-06-13T14:44:02.443
> 
> 标签：ms-access, vba, ms-access-2003

我在 MS 访问中有一个表格。我以这种形式创建了一些文本框。我在特定文本框（TOTAL）的控制源属性中输入了一个函数。这基本上总结了用户输入的数字并将其显示在文本框中。

问题是文本框未绑定。我想使用 vba 代码将文本框绑定到表中的字段。我可以通过将表字段名称放在控件源属性中来绑定文本框，但它被 SUM() 函数占用。

我不知道如何在这里进行。我已经尝试在网上搜索了几天，但未能收集到合理的解决方案。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:46:38.980

您需要删除 sum 函数并将其放入表单的合适事件或另一个控件的事件中，然后绑定文本框。

作为一般规则，您不应该存储计算值，这违反了规范化规则。

# ssh - 使用密钥远程 ssh 到机器 - 如何避免输入密码

> ID：11017399
> 
> 赞同：1
> 
> 时间：2012-06-13T14:44:25.487
> 
> 标签：ssh, ssh-keys

我有两台机器 - 分别称为 A 和 B - 设置了 ssh 密钥对。密钥有一个密码，但它被存储了，所以如果我从机器 AI 登录到机器 B，则不必输入任何内容。

但是，如果我从第三台机器 ssh 到机器 A，然后尝试从 A 到 B，则每次都需要我的密码。有没有办法避免这种情况？

我尝试了一些天真的方法，比如将我的 ssh 密钥复制到第三台机器的 .ssh 目录，但这不起作用。

谢谢你的帮助。

# mongodb - 查找结合子文档和文档条件的条件

> ID：11017400
> 
> 赞同：0
> 
> 时间：2012-06-13T14:44:28.813
> 
> 标签：mongodb

我有一个子文档“数据”，它是较大文档的一部分。当我将子文档条件与另一个条件结合起来时，我总是得到一个空结果。每个条件本身返回相同的 2 个文档。

我究竟做错了什么？

```
{ $and : [{ "data" : { "$elemMatch" : { "oid" : "1.3.6.1.4.1.111.3.5.11.5.32.1.15", 
                                        "value" : "1" }} }, 
          {"_id":{$in: [601, 1423]}}]} 
```

# file-descriptor - 增加文件描述符数的 ulimit

> ID：11017402
> 
> 赞同：4
> 
> 时间：2012-06-13T14:44:33.890
> 
> 标签：file-descriptor, ulimit

作为`normaluser`：

```
$ ulimit -n 4096
-bash: ulimit: open files: cannot modify limit: Operation not permitted 
```

作为根，它可以根据需要工作 - 但它不会影响`normaluser`.

如何摆脱这个第 22 条陷阱？我需要坚持下去。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T14:54:36.810

您可能想查看 /etc/security/limits.conf

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-25T09:46:55.283

在运行任何应用程序之前以普通用户身份更改文件描述符限制。

我使用这个小型实用程序[fdlimit](https://github.com/syrajendra/fdlimit) ，它会在执行任何程序之前使用“ [setrlimit()](http://linux.die.net/man/2/setrlimit) ”系统调用来增加文件描述符限制。

我这样用

```
$ sudo ./fdlimit <fdlimit> <program_to_run> 
```

# ruby-on-rails - elasticsearch nGram/edgengram 部分匹配？

> ID：11017407
> 
> 赞同：1
> 
> 时间：2012-06-13T14:44:51.723
> 
> 标签：ruby-on-rails, ruby-on-rails-3, lucene, elasticsearch, tire

我正在尝试使**部分搜索**工作，搜索

*“sw” “swe” “swed* ”

应该匹配*“瑞典”*

我环顾四周，就是无法让它工作

[导轨代码](https://gist.github.com/2924440)

我正在使用 来自 Tire repo 的[这段代码](https://gist.github.com/2924468)作为模板代码。

整个单词仍然匹配！

我已经重新索引并尝试使用 edgengram 过滤器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T19:53:48.493

使用[edgengram 标记过滤器](http://www.elasticsearch.org/guide/reference/index-modules/analysis/edgengram-tokenfilter/)。这会让你得到你正在寻找的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-03T01:54:49.550

我不是 Ruby 开发人员，但发现这篇文章很有用： http: [//dev.af83.com/2012/01/19/autocomplete-with-tire.html](http://dev.af83.com/2012/01/19/autocomplete-with-tire.html)

就像它说的：

```
Most databases handle that feature with a filter (with LIKE keyword in SQL, regular expression search with mongoDB). The strategy is simple: iterate on all results and keep only words which match the filter. This is brutal and hurts the hard drive. Elastic Search can do it too, with the prefix query.

With a small index, it plays well. For large indexes it will be more slow and painful. 
```

* * *

你说：

```
whole words still match! 
```

你期望什么？“Sweden”不应该匹配“Sweden”而只匹配“Swe”、“Swed”或Swede”吗？因为您对该字段的查询也被分析了

# c - 全局 IPv6 地址无法在 Solaris 上绑定

> ID：11017408
> 
> 赞同：0
> 
> 时间：2012-06-13T14:44:52.307
> 
> 标签：c, ipv6

我正在尝试为 Solaris 上的 IPv6 服务器提供示例代码。当我提供链接本地地址时，它工作正常。但是当我给出全局地址时，它无法绑定。请告诉我，我们可以在 Solaris 上使用全局 IPv6 地址吗？

这是我的代码....

```
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>

/* the port users will be connecting to */

#define MYPORT 9000

/* how many pending connections queue will hold */

#define BACKLOG 10

int main(int argc, char *argv[ ])

{

/* listen on sock_fd, new connection on new_fd */
int sockfd, new_fd;

/* my address information */struct sockaddr_in6 their_addr;
socklen_t sin_size;

//struct sigaction sa;
int yes = 1;

if ((sockfd = socket(AF_INET6, SOCK_STREAM, 0)) == -1) 
{
    perror("Server-socket() error lol!");
    return 0;//exit(1);
}
else
printf("Server-socket() sockfd is OK...\n");

if (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int)) == -1)
{
    perror("Server-setsockopt() error lol!");
    return 0;//exit(1);
}else
    printf("Server-setsockopt is OK...\n");

/* host byte order */
my_addr.sin6_family = AF_INET6;

/* short, network byte order */
my_addr.sin6_port = htons(MYPORT);

/* automatically fill with my IP */
 inet_pton(AF_INET6,"2345:1111:aaaa::500",&my_addr.sin6_addr);
//inet_pton(AF_INET6,"fe80::203:baff:fe50:cbe5",&my_addr.sin6_addr);
my_addr.sin6_scope_id=5;

/* zero the rest of the struct */

if(bind(sockfd, (struct sockaddr *)&my_addr, sizeof(my_addr)) == -1)
    perror("Server-bind() error");
    return 0;//exit(1);
}
else
    printf("Server-bind() is OK...\n");

if(listen(sockfd, BACKLOG) == -1)
{
    perror("Server-listen() error");
    return 0;//exit(1);
}
printf("Server-listen() is OK...Listening...\n");

sin_size = sizeof(struct sockaddr_in6);

if((new_fd = accept(sockfd, (struct sockaddr *)&their_addr, &sin_size)) == -1)
{
    perror("Server-accept() error");
    //continue;
}
else
    printf("Server-accept() is OK...\n");

printf("Server-new socket, new_fd is OK...\n");
printf("Server: Got connection from \n");

/* this is the child process */

/* child doesn’t need the listener */
char buf[1024];
int numbytes=0;
if((numbytes = recv(new_fd, buf, 1024, 0)) == -1)
{
    perror("recv()");
    return 1;//exit(1);
}
else
    printf("Client-The recv() is OK...\n");

buf[numbytes] = '\0';printf("Client-Received: %s", buf);
if(send(new_fd, "This is a test string from server!\n", 37, 0) == -1)
        perror("Server-send() error lol!");

/* parent doesn’t need this*/
close(new_fd);
printf("Server-new socket, new_fd closed successfully...\n");
return 0;
} 
```

谢谢 ....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:06:50.727

2345:1111:aaaa::500 是网络掩码，IP 是 fe80::203:baff:fe50:cbe5

我认为您将需要范围 id (2) 才能 bind() 才能工作，因为它是 Link-Local IPv6 地址。

*   马勒斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:49:16.587

是否`2345:1111:aaaa::500`在您的任何接口上配置？在绑定到该地址之前，这是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:52:15.227

我不确定在 Solaris 上，但在 Windows 7 上，它需要管理员权限才能将套接字绑定到全局或多播地址。

您可以使用提升的权限运行测试吗？

-杰西

# java - 在 JUnit4 中测试对象的句柄

> ID：11017412
> 
> 赞同：0
> 
> 时间：2012-06-13T14:45:04.423
> 
> 标签：java, servlets, junit4, test-runner, data-hiding

在我的特定测试用例中，我需要覆盖测试用例的依赖项以注入更多依赖项，例如 servlet 请求和响应。

不可能模拟这些，因为我的 API 需要一个实际的 servlet 容器来编译和运行 JSP。

如何使用 JUnit 4 获取测试实例的句柄？

我已经尝试过覆盖`createTest()`（`BlockJUnit4Runner`有效），但是相同的行为不能扩展到`Parameterized`测试，因为此类测试使用的运行器是内部的并且在层次结构中不可见。

# php - 如何在 PHP 中正确实现 Web 服务？

> ID：11017413
> 
> 赞同：0
> 
> 时间：2012-06-13T14:45:06.520
> 
> 标签：php, web-services

目前在我的基于 PHP 的应用程序中，我使用一个文件，例如**services.php**并通过 AJAX 调用它以返回适当的数据。

为了调用某个方法，我在 GET 中发送一个参数。例如**services.php?action=read_article**。从这一点开始，它将触发一个巨大的 switch 语句，直到找到合适的情况并返回我正在寻找的数据。

从技术上讲，一切正常，但我不禁觉得这不是*正确*的方法。

有没有更好的方法在 PHP 中实现 Web 服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:47:51.323

[这](http://www.gen-x-design.com/archives/create-a-rest-api-with-php/)是一个关于如何使用 PHP 创建 RESTful api 的非常好的教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:49:43.037

动作开关很好，如果你使用 OOP，你可以让它调用各种方法来保持它的小，比如..

```
switch ($_GET['action']) {
    case "blah":
        return $this->doBlah();
        break;
    case "foo":
        return $this->doFoo();
        break;
    default:
        return $this->doError();
} 
```

或者，您可以做其他框架所做的事情，并将 URL 映射到类似的方法中。

```
/services/read/ 
```

映射到类“服务”和方法“读取”看看 Codeigniter 是如何做到这一点的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:52:54.367

使用 amfphp 之类的东西，它集成到许多语言和应用程序中，您可以编写自己的服务类来根据您的需要处理几乎任何输入/输出。我为 iphone、android 和 pc 重复使用相同的服务。链接：[http ://www.silexlabs.org/amfphp/](http://www.silexlabs.org/amfphp/)

# r - data.frame：通过将函数应用于行组来创建列

> ID：11017420
> 
> 赞同：4
> 
> 时间：2012-06-13T14:45:20.333
> 
> 标签：r, dataframe, sapply

我有一个数据框，其中包含多次运行实验的结果，每个实验都用作日志，并带有自己的升序计数器。我想向数据框中添加另一列，该列对于下面示例中`iteration`的每个不同值具有最大值：`experiment.num`

```
df <- data.frame(
     iteration = rep(1:5,5), 
     experiment.num = c(rep(1,5),rep(2,5),rep(3,5),rep(4,5),rep(5,5)), 
     some.val=42,
     another.val=12
) 
```

在这个例子中，额外的列看起来像这样（因为所有子集都具有相同的最大值`iteration`）：

```
df$max <- rep(5,25) 
```

我目前使用的天真的解决方案是：

```
df$max <- sapply(df$experiment.num,function(exp.num) max(df$iteration[df$experiment.num == exp.num])) 
```

我也曾经`sapply(unique(df$experiment.num), function(n) c(n,max(df$iteration[df$experiment.num==n])))`构建另一个框架，然后我可以将其与原始框架合并，但这两种方法似乎都比必要的复杂。

该`experiment.num`列是一个因素，所以我认为我可以利用它来避免对所有行迭代地做这个幼稚的子集。

*有没有更好的方法来获取 a 子集的最大值列`data.frame`？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T14:50:36.250

使用 plyr：

```
ddply(df, .(experiment.num), transform, max = max(iteration)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T04:21:09.787

`ave`在基础 R 中使用：

```
df$i_max <- with(df, ave(iteration, experiment.num, FUN=max)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T15:25:16.107

这是base R中的一种方法：

```
within(df[order(df$experiment.num), ], 
       max <- rep(tapply(iteration, experiment.num, max), 
                  rle(experiment.num)$lengths)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-08T00:19:31.340

我认为您可以使用`data.table`：

```
install.packages("data.table")
library("data.table")
dt <- data.table(df) #make your data frame into a data table)
dt[, pgIndexBY := .BY, by = list(experiment.num)] #this will add a new column to your data table called pgIndexBY 
```

# asp.net - 代码目标问题

> ID：11017423
> 
> 赞同：0
> 
> 时间：2012-06-13T14:45:33.180
> 
> 标签：asp.net, html

我有一个位于[http://www.mockcourt.org.uk/mcc/default.aspx](http://www.mockcourt.org.uk/mcc/default.aspx)的网站，当我这样做时它工作得很好。指向它的地址。

但是，mcc 文件夹是一个安全文件夹，为了使其安全，地址是[https://secure17.prositehosting.co.uk/mcc/default.aspx](https://secure17.prositehosting.co.uk/mcc/default.aspx)但是当我指向它时它不起作用。

问题是我在 default.aspx 中使用的一行代码，那就是

`</asp:DropDownList><asp:AccessDataSource ID="School_DS" runat="server" DataFile="~/App_Data/MockCourt_db.mdb"`

我相信这`</asp:DropDownList><asp:AccessDataSource ID="School_DS" runat="server" DataFile="~/App_Data/MockCourt_db.mdb"`是说数据库在这个位置，但现在我已经搬到了secure17.prositehosting.co.uk而不是www.mockcourt.org.uk，这不再有效。

有谁知道我应该将代码更改为什么，因此它指向[http://www.mockcourt.org.uk/App_Data/MockCourt.db](http://www.mockcourt.org.uk/App_Data/MockCourt.db)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:50:12.873

使用数据文件的绝对 URL？

```
</asp:DropDownList><asp:AccessDataSource ID="School_DS" runat="server" DataFile="http://www.mockcourt.org.uk/App_Data/MockCourt.mdb" 
```

# c++ - 如何设置 ZERO-MQ 架构来处理不同速度的工作人员

> ID：11017424
> 
> 赞同：1
> 
> 时间：2012-06-13T14:45:34.113
> 
> 标签：c++, networking, zeromq

[作为一个小型上下文提供者：我是网络和零MQ 的新手，但我确实花了很多时间在指南和示例上]

我有以下挑战（用 C++ 完成，但与问题无关）。我有一个生成任务的单一来源。我有多个引擎需要处理这些任务，然后发回结果。

**第一次尝试：** 我创建了一个带有 ZMQ_PUSH 套接字的客户端。引擎有一个 ZMQ_PULL 套接字。为了将答案返回给客户端，我创建了相反的操作：工作人员上的 ZMQ_PUSH 和客户端上的 ZMQ_PULL。它开箱即用。只是发现一段时间后客户端内存不足，因为我推送的请求超出了工作人员的处理能力。我需要一些背压。

**第二次尝试：** 我在客户端添加了一个计数器，仅在不超过 1000 个任务“正在进行”时才负责推送。内存不足的问题得到了解决，因为我从来没有超过 1000 个“正在进行”的任务。但是……有些工人比其他工人慢。由于 PUSH/PULL 使用公平排队，因此该慢速工作人员的工作量不断增加......直到最慢的工作人员将所有 1000 个请求排队，而其他人则被饿死。我没有有效地使用我的员工。

现在，我可以使用什么架构来解决“不同速度的工人”的问题？“计算进行中任务的数量”方法是平衡推送请求数量的好方法吗？或者有没有办法可以将任务推送给工作人员，并在预定义的点上推送块？我可以用 HWM 做到这一点吗？

我确信这个问题具有如此普遍的性质，我应该能够轻松处理这个问题。谁能指出我正确的方向？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T13:47:38.763

我们使用了Paranoid Pirate Protocol [http://rfc.zeromq.org/spec:6](http://rfc.zeromq.org/spec:6)，

但是在许多非常小的工作中，通信开销可能很高，基于信用的流控制模式可能更有效。[http://unprotocols.org/blog:15](http://unprotocols.org/blog:15)

在这两种情况下，请求者都需要直接将工作分配给单个工人。这当然是抽象出来的，并且根据用例，可以作为同步调用提供，当所有任务都被处理后返回。

# r - 在 R 中分析 SVM (e1071)

> ID：11017429
> 
> 赞同：5
> 
> 时间：2012-06-13T14:45:43.390
> 
> 标签：r, statistics, machine-learning, bioinformatics, svm

我是 R 和 SVM 的新手，我正在尝试`svm`从`e1071`包中分析功能。但是，我找不到任何大型数据集可以让我获得不同输入数据大小的良好结果分析范围。有谁知道怎么锻炼`svm`？我应该使用哪个数据集？任何特定的参数`svm`使它更努力地工作？

我复制了一些我用来测试性能的命令。也许在这里得到我正在尝试的东西是最有用和更容易的：

```
#loading libraries
library(class)
library(e1071)
#I've been using golubEsets (more examples availables)
library(golubEsets)

#get the data: matrix 7129x38
data(Golub_Train)
n <- exprs(Golub_Train)

#duplicate rows(to make the dataset larger)
n<-rbind(n,n)

#take training samples as a vector
samplelabels <- as.vector(Golub_Train@phenoData@data$ALL.AML)

#calculate svm and profile it
Rprof('svm.out')
svmmodel1 <- svm(x=t(n), y=samplelabels, type='C', kernel="radial", cross=10)
Rprof(NULL) 
```

我不断增加重复行和列的数据集，但我达到了内存的限制，而不是让`svm`工作更加努力......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-14T20:37:15.273

就“工作 SVM”而言 - 使 SVM 工作“更努力”的是一个更复杂的模型，它不容易分离、更高的维度和更大、更密集的数据集。

**SVM 性能会因以下原因而降低：**

*   数据集大小增加（数据点数量）
*   稀疏性降低（更少的零）
*   维度增加（属性数量）
*   使用非线性内核（内核参数可以使内核评估更复杂）

**改变参数**

是否可以更改参数以使 SVM 花费更长的时间。当然，这些参数会影响您将获得的解决方案的质量，并且可能没有任何使用意义。

使用 C-SVM，不同的 C 将导致不同的运行时。（nu-SVM 中类似的参数是 nu）如果数据集是合理可分离的，则使 C 更小将导致运行时间更长，因为 SVM 将允许更多的训练点成为支持向量。如果数据集不是很可分离，使 C 更大会导致更长的运行时间，因为您实际上是在告诉 SVM 您想要一个与数据紧密匹配的窄边距解决方案，并且当数据不容易计算时将花费更长的时间来计算分离。

在进行参数搜索时，您经常会发现有些参数会增加计算时间，而准确性却没有明显提高。

其他参数是内核参数，如果您改变它们以增加计算内核的复杂性，那么 SVM 运行时间自然会增加。线性核很简单，速度最快；非线性内核当然需要更长的时间。一些参数可能不会增加内核的计算复杂度，但会强制建立一个更复杂的模型，这可能需要 SVM 更长的时间才能找到最优解。

**要使用的数据集：**

[**UCI 机器学习存储库**](http://archive.ics.uci.edu/ml/)是数据集的重要来源。

MNIST[**手写识别数据集**](http://yann.lecun.com/exdb/mnist/)是一个很好用的数据集——您可以随机选择数据子集来创建越来越大的数据集。请记住，链接中的数据包含所有数字，SVM 当然是二进制的，因此您必须将数据减少到两位数或执行某种多类 SVM。

您可以轻松**生成数据集**也是。要生成线性数据集，请随机选择超平面的法线向量，然后生成数据点并确定它落在超平面的哪一侧来标记它。添加一些随机性以允许在超平面一定距离内的点有时被不同地标记。通过增加类之间的重叠来增加复杂性。或者生成一些正态分布点的集群，标记为 1 或 -1，以便分布在边缘重叠。经典的非线性示例是棋盘格。生成点并以棋盘模式标记它们。为了使其更难扩大正方形的数量，增加维度并增加数据点的数量。当然，您将不得不为此使用非线性内核。

# mongodb - 为什么重新编译后第一次访问数据库时会出现套接字超时？

> ID：11017434
> 
> 赞同：3
> 
> 时间：2012-06-13T14:45:59.530
> 
> 标签：mongodb, playframework-2.0, mongodb-java

我正在使用 playframework 2.0，每次重新编译后，我的应用程序第一次尝试访问数据库时都会出现套接字超时。我直接使用 Mongo 驱动程序。这是一个典型的堆栈跟踪：

```
play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[Network: can't call something : ds031907.mongolab.com/107.21.99.26:31907/heroku_app4620908]]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:82)     [play_2.9.1.jar:2.0]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:63) [play_2.9.1.jar:2.0]
at akka.actor.Actor$class.apply(Actor.scala:290) [akka-actor.jar:2.0]
at play.core.ActionInvoker.apply(Invoker.scala:61) [play_2.9.1.jar:2.0]
at akka.actor.ActorCell.invoke(ActorCell.scala:617) [akka-actor.jar:2.0]
at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:179) [akka-actor.jar:2.0]
Caused by: com.mongodb.MongoException$Network: can't call something : ds031907.mongolab.com/107.21.99.26:31907/heroku_app4620908
at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:227) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DBApiLayer$MyCollection.__find(DBApiLayer.java:305) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DBCollection.findOne(DBCollection.java:647) ~[mongo-java-driver-2.7.3.jar:na]
at com.mongodb.DBCollection.findOne(DBCollection.java:626) ~[mongo-java-driver-2.7.3.jar:na]
at models.daos.ModuleDAO.findPublishedModuleById(ModuleDAO.java:445) ~[classes/:na]
at controllers.LearnController.viewModule(LearnController.java:31) ~[classes/:2.0]
Caused by: java.net.SocketException: Operation timed out
at java.net.SocketInputStream.socketRead0(Native Method) ~[na:1.6.0_31]
at java.net.SocketInputStream.read(SocketInputStream.java:129) ~[na:1.6.0_31]
at java.io.BufferedInputStream.fill(BufferedInputStream.java:218) ~[na:1.6.0_31]
at java.io.BufferedInputStream.read1(BufferedInputStream.java:258) ~[na:1.6.0_31]
at java.io.BufferedInputStream.read(BufferedInputStream.java:317) ~[na:1.6.0_31]
at org.bson.io.Bits.readFully(Bits.java:35) ~[mongo-java-driver-2.7.3.jar:na] 
```

这是我的初始化代码：

```
public static DB getDB(){
    ensureMongo();
    DB db = mongo.getDB(MOJULO_DB);
    if(!db.isAuthenticated()){
        db.authenticate(MONGO_USERNAME, MONGO_PASSWORD);
        if(db.isAuthenticated())
            System.out.println("authentication success on db:" +  db.getName());
        else
            System.out.println("db authentication failure");
    }
    return db;
}
private static synchronized void ensureMongo(){
    if(mongo == null){
        try{
            MongoURI mongoURI = new MongoURI(MONGO_URI);
            mongo = new Mongo(mongoURI);
            DB db = mongo.getDB(MOJULO_DB);
            db.command("ping");
        }catch(UnknownHostException ex){
            mongo = null;
            System.out.println("failed to connect to mongo");
            ex.printStackTrace();
        }
    }
}
public static void disconnect(){
    System.out.println("disconnecting from mongo");
    if(mongo != null){
        mongo.close();
        mongo = null;
    }
} 
```

我使用`getDB`类外部的方法来获取数据库。该方法旨在创建不存在的 mongo 单例。我总是得到验证成功 println，但是在第一次访问数据库时，我得到了套接字超时异常。

在我的 Global 类中，当应用程序关闭时，我关闭了与数据库的连接。

```
@Override
public void onStop(Application app) {
    System.out.println("stop");
    Logger.info("Application shutdown...");
    DBManager.disconnect();
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T13:56:20.443

我不是 MongoDB 专家，但可以看到与其他数据库连接的相似之处。你的连接是如何配置的？当您第一次尝试使用数据库连接（查找方法）时，它看起来（对我来说）可能正在尝试加载所有映射/数据库和表定义/其他所有内容。在您的 ensureMongo() 方法中运行一个简单的数据库查询可能会更好，以允许系统重新初始化它需要的所有内容（您可能必须在此方法上设置更长的超时时间）。

# java - Cassandra 1.1.1 未能删除列族

> ID：11017435
> 
> 赞同：4
> 
> 时间：2012-06-13T14:46:00.193
> 
> 标签：java, cassandra

```
csuser@lovelyserver01:~$ cqlsh --cql3 lovelyserver01
Connected to Lovely Cluster at lovelyserver01:9160.
[cqlsh 2.2.0 | Cassandra 1.1.1 | CQL spec 3.0.0 | Thrift protocol 19.32.0]
Use HELP for help.
cqlsh> CREATE KEYSPACE bigdata WITH strategy_class = 'SimpleStrategy' AND strategy_options:replication_factor=3;
cqlsh> USE bigdata;
cqlsh:bigdata> CREATE COLUMNFAMILY results (client_id int, hierarchy_id int, units int, measures int, PRIMARY KEY (client_id, hierarchy_id)); 
```

插入几行，从 5 到 5000 行 - 没什么疯狂的。然后我意识到我需要调整列族布局并重新插入所有数据，所以我：

```
cqlsh:bigdata> DROP COLUMNFAMILY results; 
```

这没有任何作用，没有错误，列族仍然存在，我仍然可以从该列族中选择数据。我又做了几次，然后它似乎起作用了。

然后，当我尝试重新创建列族时，每次我得到“TSocket 读取 0 字节”并且 cqlsh 会话变得无用。如果我删除所有节点上的 cassandra 数据目录，那么我可以重新创建密钥空间并重新启动。自然，这使得发展相当缓慢。

我已经在由 5 台旧笔记本电脑和 10 个 AWS EC2 实例组成的集群上进行了尝试。

每个节点的初始令牌是前一个节点的两倍。每个节点的种子被设置为第一个节点。Commitlog 在同一设备上。我将主机名用于listen_address 和rpc_address。

有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T15:50:16.230

组合：

*   更新到 cassandra 1.1.2（从 1.1.1）
*   在所有节点上安装 NTP
*   将文件系统升级到 ext4（从 ext3）

已解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T14:29:37.677

似乎编辑该文件“log4j-server.properties”并没有解决问题。

我必须删除所有机器上的数据才能重新创建列族。这非常烦人。

# android - 我/饲料不张贴到脸书墙

> ID：11017439
> 
> 赞同：1
> 
> 时间：2012-06-13T14:46:07.853
> 
> 标签：android, facebook, facebook-graph-api

我的 facebook 墙贴和签到一直工作到上周……现在他们已经停止工作了。这真的很奇怪......我不确定是什么原因造成的。

我可以很好地登录facebook。事实证明，因为我可以收到我的 Facebook 个人资料图片。

在类扩展活动的顶部，我指定了这些字段：

```
private static final String APP_ID = "286529654765268";
private static final String[] PERMISSIONS = {"publish_stream", "publish_actions", "publish_checkins", "create_event"};
private static final String TOKEN = "access_token";
private static final String EXPIRES = "expires_in";
private static final String KEY = "facebook-credentials";
private Facebook facebook = new Facebook(APP_ID); 
```

我在课堂上使用 facebook 对象。

这是我发布消息的方式：

```
 defaultMessage = edittext.getText().toString();
            String response = null;
            try{
                SharedPreferences sharedPreferences = getApplicationContext().getSharedPreferences("settings", 0);
            String imageUrl = "www.somesite.com/somejpg.jpg";
             Bundle params = new Bundle();
             params.putString(Facebook.TOKEN, facebook.getAccessToken());
             params.putString("caption", defaultMessage);
             params.putString("description", "a description");
             params.putString("picture", imageUrl);
             params.putString("name", "A Name");

//
             response = facebook.request("me/feed", params, "POST");
             facebook.request("me/feed", params, "POST");
            } catch(Exception e){
                e.getStackTrace();
            }
             if(response != "false" || response != null){
                 Toast.makeText(getApplicationContext(), "Status Updated Successfully!", Toast.LENGTH_LONG).show();
                 Log.e("facebook response", response);
             } 
```

我授权 onCreate。这是我做的地方：

```
public void facebookAuthorize(){
    facebook.authorize(this, PERMISSIONS, Facebook.FORCE_DIALOG_AUTH, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {

            String me = null;
            String id = null;

            try {
                me = facebook.request("me");
            } catch (MalformedURLException e2) {
                // TODO Auto-generated catch block
                e2.printStackTrace();
            } catch (IOException e2) {
                // TODO Auto-generated catch block
                e2.printStackTrace();
            }

            JSONObject json_id = null;
            try {
                json_id = new JSONObject(me);
            } catch (org.json.JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            try {
                id = json_id.getString("id");
            } catch (org.json.JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

            Log.e("Id", id);

            URL img_value = null;
             try {
                img_value = new URL("http://graph.facebook.com/"+id+"/picture?type=large");
            } catch (MalformedURLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
             Bitmap mIcon1 = null;
            try {
                mIcon1 = BitmapFactory.decodeStream(img_value.openConnection().getInputStream());
            } catch (IOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
            if(mIcon1 != null){
             badge.setImageBitmap(mIcon1);
            }

            Toast.makeText(getApplicationContext(), "Successfully logged in!", Toast.LENGTH_LONG).show();

        }

        @Override
        public void onFacebookError(FacebookError error) {}

        @Override
        public void onCancel() {}

        @Override
        public void onError(com.facebook.android.DialogError e) {
            // TODO Auto-generated method stub

        }
    });

    if(restore(facebook, getApplicationContext())){
    //authorize the user. 
    facebook.authorize(this, PERMISSIONS, Facebook.FORCE_DIALOG_AUTH, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {
            Toast.makeText(getApplicationContext(), "Successfully Logged In to facebook!", Toast.LENGTH_LONG).show();
        }

        @Override
        public void onCancel() {}

        @Override
        public void onFacebookError(com.facebook.android.FacebookError e) {
            e.printStackTrace();
                        if(facebook.isSessionValid()){
                Toast.makeText(getApplicationContext(), "Successfully Logged in to Facebook!", Toast.LENGTH_LONG).show();
                // download the users avatar

                        }
            else{
                Log.e("FACEBOOK FAIL", "Facebook has epicly failed with an error in onCreate in Social Sharing or you are logged in already");
            }
        }

        @Override
        public void onError(com.facebook.android.DialogError e) {
            // TODO Auto-generated method stub

        }
    });
    } else { save(facebook, getApplicationContext()); }

} 
```

我没有收到错误。它似乎有效，但没有出现在我的墙上。

我也收到了带有帖子 ID 的 Facebook 回复...该应用程序未被阻止在我的个人资料上发布。

我不知所措，试图找出问题所在。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:50:33.927

> 我也收到带有帖子 ID 的 Facebook 回复...

如果您尝试通过该 ID 查找您的帖子，您会得到什么响应？

如果您可以通过这种方式查看您的帖子，那么它就不会*显示*在您的墙上（出于隐藏/删除以前的帖子、负面应用反馈等原因……）

# android - 两个片段由另一个片段持有 - findViewById 返回 null

> ID：11017443
> 
> 赞同：0
> 
> 时间：2012-06-13T14:46:12.220
> 
> 标签：android, nullpointerexception, android-fragments, findviewbyid

我的第一个 Android 应用程序需要帮助。我有一个活动，顶部有一个操作栏和导航选项卡。由于这些导航选项卡，我不得不将我的活动转换为片段。

所以其中一个活动（现在是一个片段）包含两个片段，一个在左侧的 ListFragment 和一个在右侧的 DetailFragment，以便用户能够从列表中选择一个项目并直接查看右侧的详细信息。

但是现在Activity已经变成了Fragment，是Fragment拥有List-和DetailFragment。这工作正常，直到我想更改 DetailsFragment。

首先，这里是保存另外两个的 Fragment 的代码：

```
public class BlackboardFragment extends Fragment {

    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        return inflater.inflate(R.layout.fragment_layout, container, false);
    }

} 
```

这是 fragment_layout.xml 文件（保存在 layout-land 中）：

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment
        android:id="@+id/interfaces"
        android:layout_width="0px"
        android:layout_height="match_parent"
        android:layout_marginRight="20dp"
        android:layout_weight="0.60"
        class="org.fawkesrobotics.app.InterfaceFragment" />

    <FrameLayout
        android:id="@+id/viewer"
        android:layout_width="0px"
        android:layout_height="match_parent"
        android:layout_weight="1" />

</LinearLayout> 
```

因此，ListFragment 被命名为 InterfaceFragment，代码如下：

```
public class InterfaceFragment extends ListFragment {

    boolean mDualPane;

//      some other code

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setHasOptionsMenu(true);

        create_list();

        View viewerFrame = getActivity().findViewById(R.id.viewer);
        mDualPane = viewerFrame != null
                && viewerFrame.getVisibility() == View.VISIBLE;

        if (savedInstanceState != null) {
            mCurCheckPosition = savedInstanceState.getInt("curChoice", 0);
        }
    }

//      some other code
} 
```

这是，它不起作用的地方。Fragment 实际上显示了列表（它是在 create_list() 中创建的，其中设置了 ListAdapter 和其他所有内容），但我的问题是，viewerFrame 为空。我在上面的xml文件中声明了id查看器，所以我不明白他为什么找不到id。它是“属于” BlackBoardFragment 还是属于我的整体活动？因为在 BlackboardFragment 中，我也尝试使用 getActivity().findViewById 并且它有效。为什么 InterfaceFragment 找不到它？

我还测试了，如果他真的在 layout-land 中使用了 fragment_layout.xml 并且他确实使用了。所以他应该知道 id 查看器，但显然不知道。

如果您需要更多代码或 DetailsFragment 中的代码，我可以发布它。

预先感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:02:34.677

`Fragment`Android SDK 不支持嵌套。也就是说，您的 Android 应用程序中不能有“片段中的片段”。对不起。

## 编辑：

Nested`Fragment`现在是官方 Android 4.2 SDK 的一部分！耶！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:51:25.963

使用 FragmentManager 获取 Fragment……

```
ExampleFragment fragment = (ExampleFragment)  getActivity().getFragmentManager().findFragmentById(R.id.example_fragment); 
```

# php - HTML5 游戏 <-> 服务器

> ID：11017445
> 
> 赞同：1
> 
> 时间：2012-06-13T14:46:15.817
> 
> 标签：php, javascript, sockets, client

我有：

1.  PHP 套接字服务器

2.  用于处理与服务器和数据库通信的 PHP 页面

3.  客户端 .php 页面，它使用 javascript/canvas 来显示游戏并与之交互。

我想要的是用户使用 PHP 页面进行连接和身份验证，这将启动与服务器的套接字连接。根据来自该套接字的信息，可能会触发一些聊天信息和事件以将数据加载到客户端 php 页面中。

处理这个问题的正确方法是什么。在我之前使用 ajax 的所有情况下，用户触发事件，而不是服务器和 javascript 等待 php 页面的响应。

来自 php 套接字的哪段 php 代码可以让我向画布元素发送消息？

这是一个示例，因为上面可能不是很有启发性：

IE：PHP 读取其套接字连接`{"name":"msg","from":"user1","time":12345,"msg","hello world"}`

此时 PHP 做了什么？** 所以...

客户有一个 div`"id='Incoming'"`

我想启动以下 javascript：

```
function handleMessage(msgObj) {
  var cText = document.getElementById("Incoming").innerHTML;
  cText += "(" + msgObj.time + ")" + msgObj.from + " says: " + msgObj.msg +"<br/>";
  document.getElementById("Incoming").innerHTML = cText;
} 
```

我想我想弄清楚客户端的网页应该如何与 php 套接字对话......

这可能吗，还是我需要在 Flash、Java 等中创建客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:24:26.873

当您有数据要发送时（例如，用户提交一个按钮），您通常通过事件处理程序将内容从客户端发送到服务器。当 websocket 从服务器（socket.onmessage）接收数据时，它也会触发事件。简单的。

```
ws.onmessage=function (evt) { handleMessage(evt.data); }; 
```

（或者只是更改您的 handleMessage 函数体以使用 msgObj.data 作为文本值）

> 来自 php 套接字的哪段 php 代码可以让我向画布元素发送消息？

您使用的是什么 websocket 实现？它们都有不同的 API（注意 websocket 与网络套接字不同）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:49:54.363

你应该使用彗星：
[http](http://en.wikipedia.org/wiki/Comet_(programming) ://en.wikipedia.org/wiki/Comet_(programming )

AJAX 更好，而且是异步的

[http://www.ape-project.org/](http://www.ape-project.org/)
[http://www.stream-hub.com/](http://www.stream-hub.com/)
...

[http://cometdaily.com/maturity.html](http://cometdaily.com/maturity.html)

或使用 HTML5 WebSockets

# json - JSON.net 在属性名称中有@？

> ID：11017448
> 
> 赞同：5
> 
> 时间：2012-06-13T14:46:21.190
> 
> 标签：json, json.net

我正在使用 JSON.NET，我想从 XML 转换为 JSON。

我正在使用 JsonConvert.SerializeXNode(node) 并且我注意到我的 json 对象在其名称前具有带有 @ 的属性：

例如：如果我有：

```
<channel id="999" name="XXX" sid="8294" type="Digital TV" /> 
```

JSON对象是：

```
{ "@id": "999", @name="XXX" etc 
```

为什么我在 JSON 中插入了“@”，有没有办法可以避免插入“@”字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T05:17:04.427

我认为这就是 json.net 关于@ 符号的工作方式。您始终可以在 json 字符串上运行正则表达式并替换它们。[这里](https://stackoverflow.com/questions/7278577/json-net-and-replacing-sign-in-xml-to-json-converstion)有一个例子

# c# - C#循环遍历列表 > 填充数据表

> ID：11017461
> 
> 赞同：4
> 
> 时间：2012-06-13T14:46:55.870
> 
> 标签：c#, list, loops, dictionary, datatable

我需要遍历字典列表

```
List<Dictionary<string,string>> 
```

填充数据表。列表中的每个字典都有一个键，它需要是列名，以及一个值，它是该列中的内容。该列表包含 225 个字典（表中的 225 行）。

```
List<Dictionary<string, string>> myList = 
       JsonConvert.DeserializeObject<List<Dictionary<string, string>>>(jsonRep);
DataTable dt = new DataTable();

    //loop through list, loop through dictionaries, add keys as columns, 
    //values as rows. 
```

到目前为止，我一直在尝试..

```
//get max columns
int columns = myList[0].Count; <--gives me 13
//add columns
for (int i = 0; i < columns; i++)
   dt.Columns.Add(string myList[i].Keys);  <--somehow get to the key in dict to add as column names         
//add rows
foreach (var x in myList)
{
     dt.Rows.Add(x); <--not working
}
jsonReprValue = dt; <--save new DataTable to var jsonReprValue 
```

我该如何正确地做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T14:52:03.613

你有两个问题。一种是添加列，另一种是添加行。

**添加列**

假设您的列表中有项目，并且列表中的所有字典都具有相同的键，那么您只需要从其中一个字典中添加列：

```
foreach(string column in myList[0].Keys)
{
    dt.Columns.Add(column);
} 
```

**添加行**

改变这个：

```
foreach (var x in myList)
{
    dt.Rows.Add(x); <--not working
} 
```

对此：

```
foreach(Dictionary<string, string> dictionary in myList)
{
    DataRow dataRow = dt.NewRow();

    foreach(string column in dictionary.Keys)
    {
        dataRow[column] = dictionary[column];
    }

    dt.Rows.Add(dataRow);
} 
```

请参阅[DataTable.NewRow](https://docs.microsoft.com/en-us/dotnet/api/system.data.datatable.newrow)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:32:26.783

查看DataTable类关于如何使用数据表的示例[。](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)但这里是一个使用 Linq 的例子

```
List<Dictionary<string, string>> myList = new List<Dictionary<string, string>>()
                                                       { new Dictionary<string,string>() { { "ABC", "This" },
                                                                                           { "DEF", "is" },
                                                                                           { "GHI", "radio" },
                                                                                           { "JKL", "clash" } } };

DataTable dt = new DataTable();

// Add columns first
dt.Columns.AddRange( myList.First ()
                           .Select (kvp => new DataColumn() { ColumnName = kvp.Key, DataType = System.Type.GetType("System.String")} )
                           .AsEnumerable()
                           .ToArray()
                           );

// Now add the rows
myList.SelectMany (Dict => Dict.Select (kvp => new {
                                                    Row = dt.NewRow(),
                                                    Kvp = kvp
                                                    }))
      .ToList()
      .ForEach( rowItem => {
                              rowItem.Row[rowItem.Kvp.Key] = rowItem.Kvp.Value;
                              dt.Rows.Add( rowItem.Row );
                           }
             );
dt.Dump(); 
```

结果（转储是特定于 LinqPad 而不是 .Net）： ![在此处输入图像描述](../Images/35c7546c8d3807c90aab9590230b2b8c.png)

# java - 如何在 Java 中加密字符串与在 ColdFusion 中加密的字符串完全相同？

> ID：11017462
> 
> 赞同：4
> 
> 时间：2012-06-13T14:46:56.433
> 
> 标签：java, coldfusion, encryption-symmetric

我有在 ColdFusion 中加密的数据，我需要能够使用 Java 解密和加密到相同的确切值。我希望有人可以帮助我解决这个问题。除了实际的 PasswordKey 之外，我将指定 ColdFusion 中使用的所有内容，出于安全目的，我必须对其保密。PasswordKey 的长度为 23 个字符。它使用大小写字母、数字以及 + 和 = 符号。我知道这是很多问题，但任何帮助将不胜感激。

我尝试使用我在[网上](http://www.digizol.com/2009/10/java-encrypt-decrypt-jce-salt.html)找到的 Java 加密示例，并将下面的行替换为我们的 CF 应用程序中使用的 23 个字符：

```
private static final byte[] keyValue = new byte[] {'T', 'h', 'i', 's', 'I', 's', 'A', 'S', 'e', 'c', 'r', 'e', 't', 'K', 'e', 'y' };` 
```

但我得到了错误：

```
java.security.InvalidKeyException: Invalid AES key length: 23 bytes 
```

CF 代码为：

```
Application.PasswordKey = "***********************";
Application.Algorithm = "AES";
Application.Encoding = "hex";

<cffunction name="encryptValue" access="public" returntype="string">
        <cfargument name="strEncryptThis" required="yes">

        <cfreturn Encrypt(TRIM(strEncryptThis), Application.PasswordKey, Application.Algorithm, Application.Encoding)>
</cffunction>

<cffunction name="decryptValue" access="public" returntype="string">
    <cfargument name="strDecryptThis" required="yes">

    <cfreturn Decrypt(TRIM(strDecryptThis), Application.PasswordKey, Application.Algorithm, Application.Encoding)>
</cffunction> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T14:57:33.863

您的密钥很可能是 Base64 编码的密钥（23 个字符应解码为大约 16 个字节，这是 AES 的 128 位密钥的正确长度）。

因此，在您的 java 代码中，首先通过 Base64 解码器运行您的密钥字符串，以获得 AES 算法的适当长度（16 个字节）的字节 []。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:58:21.253

128 但 AES 加密支持 16 字节的密钥密钥大小。
16 * 8 = 128 位，即使在示例中，密钥也是 16 字节。

听起来你的密钥在 Base64 中，所以使用 Base64.decode(key or key.getBytes()) 来获取字节数组，检查它的 16 个字节，否则通过填充使其成为 16 个字节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T17:04:18.253

感谢大家的帮助。我想发布我的最终解决方案供其他人使用。我包括我的整个加密包代码减去特定的密码密钥（再次为了安全起见）。此代码创建与问题中列出的 CF 代码相同的十六进制字符串，并将其解密回正确的英文文本字符串。

我在 stackoverflow 上的其他问题中找到了`bytesToHex`and `hexStringToByteArray`函数，所以我也分别感谢用户 mayWeCouldStealAVan 和 Dave L.。我想我会研究其他 base 64 编码器/解码器，以防来自 sun 的编码器/解码器不可用，但这肯定适用于现在。再次感谢。

```
package encryptionpackage;

import java.security.*;
import java.security.spec.InvalidKeySpecException;
import javax.crypto.Cipher; 
import javax.crypto.spec.SecretKeySpec;
import sun.misc.*;

public class encryption 
{
    // Note: The full CF default is "AES/ECB/PKCS5Padding"
    private static final String ALGORITHM = "AES";
    // The 24 character key from my CF app (base64 encoded)
    // typically generated with:  generateSecretKey("AES") 
    private static final String passKey = "***********************"; 

     public static String encrypt(String valueToEnc) throws Exception 
     {
        Key key = generateKey();
        Cipher c = Cipher.getInstance(ALGORITHM);
        c.init(Cipher.ENCRYPT_MODE, key);
        byte[] encValue = c.doFinal(valueToEnc.getBytes());
        String encryptedValue = bytesToHex(encValue);
        return encryptedValue;
    }

    public static String decrypt(String encryptedValue) throws Exception 
    {
        Key key = generateKey();
        Cipher c = Cipher.getInstance(ALGORITHM);
        c.init(Cipher.DECRYPT_MODE, key);
        byte[] decordedValue = hexStringToByteArray(encryptedValue);
        byte[] decValue = c.doFinal(decordedValue);
        String decryptedValue = new String(decValue);
        return decryptedValue;
    }

    private static Key generateKey() throws Exception 
    {
          byte[] keyValue;
          keyValue = new BASE64Decoder().decodeBuffer(passKey);
        Key key = new SecretKeySpec(keyValue, ALGORITHM);

        return key;
    }

    public static String bytesToHex(byte[] bytes) 
    { 
        final char[] hexArray = {'0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F'}; 
        char[] hexChars = new char[bytes.length * 2]; 
        int v; 
        for ( int j = 0; j < bytes.length; j++ ) 
        { 
            v = bytes[j] & 0xFF; 
            hexChars[j * 2] = hexArray[v >>> 4]; 
            hexChars[j * 2 + 1] = hexArray[v & 0x0F]; 
        } 
        return new String(hexChars); 
    } 

    public static byte[] hexStringToByteArray(String s) 
    { 
        int len = s.length(); 
        byte[] data = new byte[len / 2]; 
        for (int i = 0; i < len; i += 2) 
        { 
            data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4) 
                                 + Character.digit(s.charAt(i+1), 16)); 
        } 
        return data; 
    } 

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T14:54:12.120

AES 加密仅支持 128 位、192 位或 256 位的密钥大小。

[http://en.wikipedia.org/wiki/Advanced_Encryption_Standard](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)

您不能只取任何字节数组并将其用作 AES 密钥。在您在上面看到的示例代码中，该示例巧妙地使用了 16 个字符，对应于 128 位密钥。

这是因为 1 个字符或者更确切地说 1 个字节对应 8 位。

一个 16 值的字节数组将对应于`16 * 8 = 128 bits`

23 个字符 = `23 * 8 = 184 bits`，因此它是无效的密钥大小。

您需要 16 个字符、24 个字符或 32 个字符。

话虽如此，仅使用字符进行 AES 加密是非常不安全的。请务必使用适当且安全的随机密钥进行加密。

要生成安全且随机的 AES 密钥：

```
SecureRandom random = new SecureRandom();
byte [] secret = new byte[16];
random.nextBytes(secret); 
```

[http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html](http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html)

# wpf - WPF根据子控件位置计算父边距

> ID：11017465
> 
> 赞同：0
> 
> 时间：2012-06-13T14:47:04.887
> 
> 标签：wpf, rulers

我有以下 XAML。我必须`CanvasRuler`根据子控件（`LabelEditFrame`）左位置设置边距。我怎么做。

```
 <wpfcommon:CanvasNavigationBar>
        <DockPanel>
            <wpfcommon:CanvasRuler />     <!-- Horizontal -->
            </wpfcommon:CanvasRuler  />   <!-- Vertical -->
            <border>
                <StackPanel>
                    <wpfcommon:LabelEditFrame>
                    </ wpfcommon:LabelEditFrame>
                </StackPanel>
            </border>
        </DockPanel>
    </wpfcommon:CanvasNavigationBar> 
```

现在我有这个

![在此处输入图像描述](../Images/d4ad83be23f61af7232539cdffd565ff.png)

我想要这个（*我可以通过设置硬编码值来做到这一点，但我需要动态设置它，所以如果子控件的位置发生变化，它会自动改变标尺位置*）。

![在此处输入图像描述](../Images/9c72cf8f61043ce26692fdd7df52f16d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:15:34.860

我建议你把所有这些东西放到 Grid 中，让它为你计算任何东西：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="SomeFixedHeightToGetTopMargin"/>
        <RowDefinition/>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition  Width="SomeFixedWithToGetLeftMargin"/>
        <ColumnDefinition/>
    </Grid.ColumnDefinitions>

    <wpfcommon:CanvasRuler Grid.Column="1"/>
    <wpfcommon:CanvasRuler Grid.Row="1"/>
    <Border Grid.Row="1" Grid.Column="1">
        <StackPanel>
            <wpfcommon:LabelEditFrame/>
        </StackPanel>
    </Border>
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:18:55.683

根据我的经验，如果这是在画布上并且是画布上的孩子，您可以使用

```
Canvas.SetLeft 
```

和

```
Canvas.SetTop 
```

方法。

因此，对于标尺，您可以设置：

```
VerticalAlignment="Top", HorizontalAlignment="Left 
```

然后，当 LabelEditFrame 移动时（无论您使用哪个事件来触发它），您都可以使用以下方式调整两个标尺：

```
Canvas.SetLeft(HorizontalCanvasRuler, LabelEditFrame.Margin.Left);
Canvas.SetTop(VerticalCanvasRuler, LabelEditFrame.Margin.Top); 
```

我还没有尝试过，但我以前曾经调整过这样的控件，所以它应该可以工作:)

# python - 烧瓶返回存储在数据库中的图像

> ID：11017466
> 
> 赞同：90
> 
> 时间：2012-06-13T14:47:09.303
> 
> 标签：python, binary, flask

我的图像存储在 MongoDB 中，我想将它们返回给客户端，代码如下：

```
@app.route("/images/<int:pid>.jpg")
def getImage(pid):
    # get image binary from MongoDB, which is bson.Binary type
    return image_binary 
```

但是，似乎我不能直接在 Flask 中返回二进制文件？到目前为止我的想法：

1.  返回`base64`图像二进制文件的。问题是 IE<8 不支持这个。
2.  创建一个临时文件，然后用`send_file`.

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-06-13T15:05:04.677

使用数据创建响应对象，然后设置内容类型标头。`attachment`如果您希望浏览器保存文件而不是显示文件，请将内容处置标头设置为。

```
@app.route('/images/<int:pid>.jpg')
def get_image(pid):
    image_binary = read_image(pid)
    response = make_response(image_binary)
    response.headers.set('Content-Type', 'image/jpeg')
    response.headers.set(
        'Content-Disposition', 'attachment', filename='%s.jpg' % pid)
    return response 
```

相关：[werkzeug.Headers](http://werkzeug.pocoo.org/docs/#werkzeug.Headers)和[flask.Response](http://flask.pocoo.org/docs/api/#response-objects)

您可以将类似文件的 oject 和标头参数传递给以`send_file`使其设置完整的响应。用于`io.BytesIO`二进制数据：

```
return send_file(
    io.BytesIO(image_binary),
    mimetype='image/jpeg',
    as_attachment=True,
    attachment_filename='%s.jpg' % pid) 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2014-08-06T01:10:09.360

只是想确认 dav1d 的第二个建议是正确的 - 我测试了这个（其中 obj.logo 是一个 mongoengine ImageField），对我来说很好：

```
import io

from flask import current_app as app
from flask import send_file

from myproject import Obj

@app.route('/logo.png')
def logo():
    """Serves the logo image."""

    obj = Obj.objects.get(title='Logo')

    return send_file(io.BytesIO(obj.logo.read()),
                     attachment_filename='logo.png',
                     mimetype='image/png') 
```

比手动创建响应对象并设置其标头更容易。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2018-10-27T21:49:20.790

假设我有存储的图像路径。下面的代码有助于通过发送图像。

```
from flask import send_file
@app.route('/get_image')
def get_image():
    filename = 'uploads\\123.jpg'
    return send_file(filename, mimetype='image/jpg') 
```

uploads 是我的文件夹名称，其中存在我的 123.jpg 图像。

[PS：上传文件夹应该在你的脚本文件的当前目录中]

希望能帮助到你。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-01-13T04:52:45.317

以下对我有用（对于`Python 3.7.3`）：

```
import io
import base64
# import flask
from PIL import Image

def get_encoded_img(image_path):
    img = Image.open(image_path, mode='r')
    img_byte_arr = io.BytesIO()
    img.save(img_byte_arr, format='PNG')
    my_encoded_img = base64.encodebytes(img_byte_arr.getvalue()).decode('ascii')
    return my_encoded_img

...
# your api code
...
img_path = 'assets/test.png'
img = get_encoded_img(img_path)
# prepare the response: data
response_data = {"key1": value1, "key2": value2, "image": img}
# return flask.jsonify(response_data ) 
```

# javascript - 重构下拉和文本字段的验证

> ID：11017468
> 
> 赞同：0
> 
> 时间：2012-06-13T14:47:27.013
> 
> 标签：javascript, jquery, jquery-ui, validation

我需要根据下拉列表验证文本字段。我这里有两个场景 1\. 当用户更改下拉列表中的值，然后在文本字段中输入文本 2\. 用户在文本字段中输入文本，然后更改下拉列表。

我已经为两个似乎工作正常的案例编写了代码。但我不确定我是否一切都正确。我可以重构我的代码还是我的代码很好。

此外，我需要将文本字段验证为字母数字字符和下划线，这似乎不起作用。

请原谅我的无知，因为我是 jquery 的新手。我在这里发布了我的代码：http: [//jsfiddle.net/qbrJv/](http://jsfiddle.net/qbrJv/)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-13T15:49:39.847

您可以使用[Jquery 验证](http://docs.jquery.com/Plugins/Validation)。这个插件已经为客户端验证实现了很多有用的功能。

所以使用这个插件你需要做的就是：

1.  实现您自己的验证器，它将使用下拉列表的值来验证文本框中的值
2.  将此验证器附加到文本框

字母数字和下划线的验证也可以像单独的验证器一样实现并附加到输入。

作为一个好处，您可以在您的应用程序中重用此类验证器。

# c - 将 C 代码转换为 MIPS（数组）

> ID：11017469
> 
> 赞同：4
> 
> 时间：2012-06-13T14:47:30.180
> 
> 标签：c, assembly, mips

```
for (i = 0; i < 64; i++) {
A[i] = B[i] + C[i];
} 
```

上述 C 代码的 MIPS 指令为：

```
add $t4, $zero, $zero   # I1 i is initialized to 0, $t4 = 0
Loop: 
add $t5, $t4, $t1       # I2 temp reg $t5 = address of b[i]
lw $t6, 0($t5)          # I3 temp reg $t6 = b[i]
add $t5, $t4, $t2       # I4 temp reg $t5 = address of c[i]
lw $t7, 0($t5)          # I5 temp reg $t7 = c[i]
add $t6, $t6, $t7       # I6 temp reg $t6 = b[i] + c[i]
add $t5, $t4, $t0       # I7 temp reg $t5 = address of a[i]
sw $t6, 0($t5)          # I8 a[i] = b[i] + c[i]
addi $t4, $t4, 4         # I9 i = i + 1
slti $t5, $t4, 256       # I10 $t5 = 1 if $t4 < 256, i.e. i < 64
bne $t5, $zero, Loop    # I11 go to Loop if $t4 < 256 
```

对于I8，不能用 `sw`指令代替`addi`指令吗？IE`addi $t5, $t6, 0`

它不会完成复制`$t6`into的地址的相同任务`$t5`吗？我想知道区别以及何时使用它们中的任何一个。关于`lw`指令也可以这样说。

另外，也许是一个相关的问题，MIPS 如何处理指针？

编辑：更改了 addi $t6, $t5, 0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:55:16.670

MIPS 中的`sw`指令将第一个参数（$t6 中的值）存储到第二个参数（$t5 中的值）中偏移常量值 (0) 的地址。

您实际上并没有尝试将 $t5 地址存储到寄存器中，而是将 $t6 中的值存储到由 $t5 的值表示的内存位置中。

如果你愿意，你可以认为 in 的值`$t5`类似于 C 指针。换句话说，MIPS 不会以不同的方式处理指针和值——重要的是你在哪里使用这些值。如果您使用寄存器的值作为`lw`or的第二个参数`sw`，那么您实际上是将该寄存器用作指针。如果您使用寄存器的值作为 or 的第一个参数，`lw`或者`sw`在大多数其他地方，您将直接对该值进行操作。（当然，就像在 C 指针算术中一样，您可以操作一个地址，以便将一条数据存储在内存中的其他位置。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T14:54:19.097

> 对于I8，sw指令不能用add指令代替吗？将$t5 的地址复制到$t0 中，它不会实现相同的任务吗？我想知道区别以及何时使用它们中的任何一个。

我认为您对 store 单词的实际作用感到困惑。在 I8 中，$t6 中寄存器的值被存储到 $t5 的零位置。加法将用其他两个寄存器值的总和覆盖存储在目标寄存器中的任何数据。

> 另外，也许是一个相关的问题，MIPS 如何处理指针？

“指针”只是存储在寄存器中的内存地址（与值相反）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-13T14:54:33.837

`lw`并`sw`读/写内存。`addi`和其他算术运算对寄存器进行操作。

寄存器就像 CPU 用来存储数据的小桶。如果我没记错我的 MIPS 架构，它们可以用 5 位左右来寻址。

内存就像浩瀚的数据海洋，需要超过 16 位才能寻址。因此，您实际上必须将地址存储在寄存器中。

指针只是内存地址（32 位架构上的 32 位）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-13T15:04:24.843

> 对于I8，sw指令不能用addi指令代替吗？即addi $t6, $t5, 0

不会。`sw`指令将结果存储到内存中。`add`只是操纵寄存器。并`lw`从记忆中得到一个词。这是唯一这样做的 MIPS 指令。（其他处理器可能并且确实具有`add`该存取存储器的版本，但没有 MIPS。）

使用汇编语言工作时，有必要调整您的思维。寄存器和内存是分开的。在高级语言中，寄存器（几乎）完全隐藏。在汇编中，寄存器是程序员必须管理的独立资源。而且它们是稀缺资源。HLL 编译器会为您执行此操作，但通过汇编编程，您已经完成了这项工作。

> MIPS 如何处理指针？

在 MIPS 中，指针只是恰好是内存地址的整数（在寄存器或内存中）。将它们与数据值区分开来的唯一方法是通过您的大脑。“指针”是高级语言设计者为减轻程序员的负担而发明的。如果您仔细观察，您会发现它`$t5`实际上包含一个指针。它是一个内存地址，被`lw`用作`sw`加载或存储的地址。

# mysql - 最佳实践：sql 视图真的值得吗？

> ID：11017473
> 
> 赞同：5
> 
> 时间：2012-06-13T14:47:45.777
> 
> 标签：mysql, sql, sql-server

我正在使用存储在数据库中的数据构建一个新的 Web 应用程序。与许多 Web 应用程序一样，我需要从复杂的 sql 查询中公开数据（使用多个表中的条件进行查询）。我想知道在数据库中将我的查询构建为 sql 视图而不是在应用程序中构建它是否是一个好主意？我的意思是这样做有什么好处？数据库性能？我会写更长的代码吗？调试时间更长？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T14:56:45.330

这不能真正客观地回答，因为它取决于具体情况。

使用**视图、函数、触发器**和**存储过程**，您可以将应用程序的部分逻辑移动到数据库层。

这有几个**好处**：

*   性能——您可能会避免数据往返，并且使用所有 DBMS 功能可以更有效地处理某些处理。
*   一致性——使用 DBMS 功能可以更轻松地表达某些数据处理。

但也有一定**的缺点**：

*   可移植性——您越依赖 DBMS 的特定功能，应用程序的可移植性就越差。
*   可维护性——逻辑分散在两种不同的技术中，这意味着维护需要更多的技能，并且本地推理更难。

如果您坚持[SQL92 标准](http://en.wikipedia.org/wiki/SQL-92)，这是一个很好的折衷方案。

我的 2 美分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:56:46.140

我认为您的问题对于您要实现的目标有点令人困惑（获得有关 SQL 视图或如何构建应用程序的知识）。

我相信所有数据库逻辑都应该存储在数据库层，最好是存储在存储过程中，而不是应用程序逻辑中。然后应用程序逻辑应该连接到数据库并从这些过程/函数中检索数据，然后在您的应用程序中公开这些数据。

将其存储在数据库层的好处之一是通过 SQL Server 来利用执行计划（您可能无法通过应用程序逻辑直接访问它）。另一个优点是您可以分离应用程序，即如果需要更改数据库，您不必直接修改应用程序。

对于 Views 的直接观点，使用它们的优点包括：

*   将用户限制为表中的特定行。例如，允许员工在劳动力跟踪表中仅查看记录其工作的行。

*   将用户限制在特定列。例如，允许不在工资单中工作的员工查看员工表中的姓名、办公室、工作电话和部门列，但不允许他们查看任何包含工资信息或个人信息的列。

*   连接来自多个表的列，使它们看起来像一个表。

[http://msdn.microsoft.com/en-us/library/aa214068(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa214068(v=sql.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:56:20.263

我已经看到视图被大量用于做两件事：

1.  简化查询，如果您有一个具有多个连接和连接和连接的 HUGE 选择，您可以创建一个具有相同性能但查询将只有几行的视图。
2.  出于安全原因，如果您有一个表包含一些不应被所有开发人员访问的信息，您可以创建视图并授予查看视图而不是主表的权限，即 IE: `table 1: Name, Last_name, User_ID, credit_card, social_security`。您创建一个视图表。`table view: name, last_name, user_id`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T14:51:40.603

您可能会遇到性能问题和可以针对视图运行的类型查询的限制。

限制您可以对视图执行的操作。

*   [http://dev.mysql.com/doc/refman/5.6/en/view-restrictions.html](http://dev.mysql.com/doc/refman/5.6/en/view-restrictions.html)
*   看起来最大的问题是您无法在视图上创建索引。如果您的最终结果表很大，这可能会对性能造成很大影响
*   这也是一个讨论意见的好论坛： http: [//forums.mysql.com/read.php?100,22967,22967#msg-22967](http://forums.mysql.com/read.php?100,22967,22967#msg-22967)

根据我的经验，一个索引良好的表，使用正确的引擎，并经过适当的调整（例如设置适当的 key_buffer 值）可以比视图执行得更好。

或者，您可以创建一个触发器，根据其他表的结果更新一个表。[http://dev.mysql.com/doc/refman/5.6/en/triggers.html](http://dev.mysql.com/doc/refman/5.6/en/triggers.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T14:51:48.847

SQL 视图有很多用途。尝试先阅读它们，然后问一个更具体的问题：

*   [http://odetocode.com/code/299.aspx](http://odetocode.com/code/299.aspx)
*   [http://msdn.microsoft.com/en-us/library/ms187956.aspx](http://msdn.microsoft.com/en-us/library/ms187956.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-13T15:08:28.793

您所说的技术称为[*非规范化*](http://en.wikipedia.org/wiki/Denormalization)。Flickr 的软件工程师 Cal Henderson 公开支持这项技术。

从理论上讲`JOIN`，操作是最昂贵的操作之一，因此反*规范化*是一个很好的做法，因为您正在使用 m 和从视图中选择的*m*和*n 个查询转换**n 个*查询，其中*m* `JOIN`为 1个查询。 *`JOIN`*

 **也就是说，最好的方法是自己测试它。因为对 Flickr 可能非常好的东西可能对您的应用程序没有那么好。

此外，从一个 RBDMS 到另一个，视图的性能可能会有很大差异。例如，根据 RBDMS 视图可以在原始表更改时更新，可以有索引等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-13T14:50:33.870

我个人更喜欢视图，特别是对于报告/应用程序，好像数据中存在任何问题，您只需更新单个视图，而不是重新构建应用程序或手动编辑查询。**

# php - PHP 文件上传停止

> ID：11017474
> 
> 赞同：3
> 
> 时间：2012-06-13T14:47:50.807
> 
> 标签：php, image, memory, upload

对于一个客户，我构建了一个简单的脚本，可以上传多个文件（图像），调整它们的大小，将它们存储在一个临时文件夹中，然后再将它们移动到它们的目的地。

调整大小是使用 PHP 的 GD 完成的，因为 Imagick 不可用。

这些图像每张大约 2/4 MB，客户一次上传大约 30 张图像。我使用了 HTML5 的 multiple="" 属性，一切正常。

在测试中一切正常，因为我使用了 Windows 标准壁纸图像。

我找不到问题的根源。当上传超过 1 张图片时，脚本调试失败告诉我它确实上传了第二张图片但不会调整大小。

我检查了图像的内存使用情况，每个图像大约**105724352 字节**。

我的 PHP ini 设置：

```
max_execution_time = 300     
max_input_time = 600    
memory_limit = 200M 
```

所以你在第二张图片中看到内存达到了极限，使我的脚本停止了。那是对的吗？

如果是这样，升级内存限制有多明智？

提前致谢！

**编辑：**

现在看来 GD 函数`imagecreatefromjpeg`无法处理分辨率大于 3500 像素宽的文件，我的文件大于 5000 像素宽。

有没有人有这方面的工作？在这一点上，我想知道如果客户端需要这么多内存来存储这些图像，将客户端放在共享主机上是否明智。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:01:54.673

> 所以你在第二张图片中看到内存达到了极限，使我的脚本停止了。那是对的吗？

检查（**nix 系统）下的 Apache 错误日志`/var/log/apache2/error.log`，看看它是否真的是问题所在。

> 如果是这样，升级内存限制有多明智？

您不应在一个脚本中处理多个图像操作。为每一个进行ajax查询，在单独的实例中处理它们。

# python - 如何将文档列表异步添加到 Appengine 搜索 API 索引？

> ID：11017476
> 
> 赞同：0
> 
> 时间：2012-06-13T14:47:55.650
> 
> 标签：python, google-app-engine, google-search-api

我正在试验 Appengine (python) [SearchAPI](https://developers.google.com/appengine/docs/python/search/indexclass)。我已经创建了一个文档列表，并且正在将此文档列表正确地添加到 Search API 索引中。它工作得很好，但我的代码必须等待这种情况发生（同步）。

我的业务逻辑将允许这种异步发生，我想知道是否有人对我如何同步添加它有一些建议（类似于 put_async 等其他一些 appengine python 技巧）。

代码：

```
try:        
    search.Index(name=free_text_index).add(documents)
except search.Error:
    logging.exception("Add to Free Text Index " + free_text_index + " failed") 
```

寻找允许这样的事情的东西（或对具有相同效果的东西的建议）。

我正在寻找类似 put_async 命令的东西。

```
myobject.put_async() 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:41:43.343

Python 搜索 API 当前不支持异步调用。我建议您使用任务队列来异步添加文档。

# vim - 键绑定以打开新选项卡并打开 FuzzyFinder

> ID：11017477
> 
> 赞同：1
> 
> 时间：2012-06-13T14:48:00.213
> 
> 标签：vim

我已经安装了 FuzzyFinder。因为你现在可能要打开 FuzzyFinder 文件搜索器，我必须写`:FufFile`.

现在我想创建一个键绑定，打开一个新选项卡并打开 FuzzyFinde 文件搜索器。这是我尝试的：

```
map tn :tabnew :FufFile pattern:<enter> 
```

但它不起作用，它只是说`"E172: Only one file name allowed"`。

任何想法？

哈维尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:05:35.020

您可以定义一个运行两个命令的键盘映射：

```
:map tn :tabnew \| FufFile pattern:<CR> 
```

# android - 有没有办法在 Android 原生 API 中合成图像或使用 HTML5

> ID：11017478
> 
> 赞同：1
> 
> 时间：2012-06-13T14:48:02.443
> 
> 标签：android, html

我想构建一个具有以下功能的移动应用程序：

让用户选择一张图片，然后我们根据该图片生成一张图片。

*   生成的图片有一些指定字体的指定文本。
*   还有一张图片，可能是PNG文件，用作前景。
*   将生成的图片输出到用户设备。

有没有办法在 Android API 或 HTML5 中合成图像？

* * *

我更喜欢使用一些Javascript的方式来做到这一点，所以我可以轻松地构建应用程序跨平台，但我不知道JS是否可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:12:17.953

为此，您可以使用 HTML5 画布[https://developer.mozilla.org/en/Drawing_Graphics_with_Canvas](https://developer.mozilla.org/en/Drawing_Graphics_with_Canvas)

如果您想使用 Android API 对此进行编码，您可以使用 Canvas：http: [//developer.android.com/reference/android/graphics/Canvas.html](http://developer.android.com/reference/android/graphics/Canvas.html)

顺便说一句，有一个很好的指南“有效地显示位图” [http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

# maven - 在 Intellij IDEA 中更改 settings.xml 的文件类型

> ID：11017489
> 
> 赞同：0
> 
> 时间：2012-06-13T14:48:30.120
> 
> 标签：maven, intellij-idea, file-type

我正在 IDEA 中处理 python 项目，并且有一个名为“settings.xml”的 xml 文件

IDEA 将此文件识别为 maven 配置文件并应用特定的验证规则，我的文件标记为红色错误下划线

如何将此文件标记为非 Maven 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:04:02.410

您可以在 Maven 插件设置中忽略此文件。

> 文件 -> 设置 -> Maven -> 忽略的文件

![行家设置](../Images/848ec6d6682db38daeef54c1d5bddbc6.png)

# algorithm - 在坐标 2D 平面中从点 1 移动到点 2 的方式数

> ID：11017500
> 
> 赞同：0
> 
> 时间：2012-06-13T14:49:09.870
> 
> 标签：algorithm, optimization, recursion, coordinate-systems

我遇到了一个问题，它被要求找出在 2D 坐标平面中从点 1 到达点 2 的独特方式的数量。

注意：这可以假设而不失一般性`x1 < x2`和`y1 < y2`。

此外，运动被限制在以下方式中。一个人只能向右或向上移动。表示有效的移动是 from`(xa, ya)`到`(xb, yb)`if`xa < xb`和`ya < yb`。

在数学上，这可以通过 找到`( [(x2-x1)+(y2-y1)]! ) / [(x2-x1)!] * [(y2-y1)!]`。我也想过代码。

我有一些方法，我用动态编程进行编码，我的方法需要`O([max(x2,y2)]^2)`时间`Theta( x2 * y2 )`，我可以用上三角矩阵或下三角矩阵来管理。

你能想到其他一些运行时间少于这个的方法吗？我正在考虑一个递归解决方案，其中最小运行时间是`O(max(x2,y2))`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:56:12.493

一个简单有效的解决方案是数学解决方案。

让`x2-x1 = n`和`y2-y1 = m`。
您需要准确`n`地向右走，然后`m`向上走，剩下的就是确定它们的顺序。

这可以建模为`n+m`具有恰好`n`元素设置为 1 的元素的二进制向量的数量。
因此，可能性的总数是`chose(n,n+m) = (n+m)! / (n! * m!)`，这正是你得到的。

鉴于数学答案已被证明并且计算速度更快 - 我认为没有理由使用具有这些限制的不同解决方案。

如果您渴望在这里使用递归，那么[二项式系数的递归公式](http://en.wikipedia.org/wiki/Binomial_coefficient#Recursive_formula)可能很适合这里。

**编辑：** 您可能正在寻找[乘法公式](http://en.wikipedia.org/wiki/Binomial_coefficient#Multiplicative_formula)来计算它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T18:41:00.867

要计算答案，您可以使用以下公式：

`(n+m)!/(n!m!)=(n+1)*(n+2)/2*(n+3)/3*…*(n+m)/m`

所以伪代码是：

```
let foo(n,m) =
  ans=1;
  for i = 1 to m do
    ans = ans*(n+i)/i;
  done;
  ans 
```

乘法和除法的顺序很重要，如果修改它，即使结果不是很大，也可能会溢出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-11T18:56:01.250

我终于设法写了这篇文章来详细描述这个问题并完成了答案。这是相同的链接。[http://techieme.in/dynamic-programming-distinct-paths-between-two-points/](http://techieme.in/dynamic-programming-distinct-paths-between-two-points/)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2021-05-31T17:29:22.977

试试这个公式：

```
ans = (x2-x1) * (y2-y1) + 1; 
```

# java - 动态谷歌地图/纬度经度vars/php/java/var/basic

> ID：11017502
> 
> 赞同：1
> 
> 时间：2012-06-13T14:49:15.750
> 
> 标签：java, php, api, google-maps, latitude-longitude

问题：

* * *

你好，

我想通过 IP 地址在我的网站中嵌入动态谷歌地图。我使用 IPlocation 工具获得了纬度/经度数据。我还无法将 IPlocation 中的纬度/日志数据连接到谷歌地图 Java 代码。我不确定如何在加载地图功能中格式化/定义/放置纬度和经度。以下是我尝试过但尚未奏效的事情：

*   我试过，进入javascript代码，
*   我还尝试手动输入 $latitude 和 $longitude 的值。
*   我尝试直接将 'ip2location_latitude()' 和 'ip2location_longitude()' 放入 java 代码中。

最终我需要获取基于 IP 的位置历史记录并将位置数据记录到数据库中。

## 提前致谢

这是我的代码的摘要：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> <!-- Google map API v3 -->

<?php
$latitude = 'ip2location_latitude()'; //------------ IP latitude
$longitude = 'ip2location_longitude()'; //------------ IP latitude ip2location_longitude() 
?>

<!-- Start loading canvas google map -->

<script type="text/javascript">
function loadmap () { 
var latlng = new google.maps.LatLng($latitude,$longitude);
var option = {
zoom: 8,
center: latlng,
mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(document.getElementById("map_canvas"), option);
createMarker(latitude,logitude, 'lol');
downloadUrl("airport.xml", function(data) {
var xml = xmlParse(data);
var markers = xml.documentElement.getElementsByTagName("marker");
document.getElementById("test").innerHTML = markers.length;
for (var i = 0; i < markers.length; i++) {
var info = markers[i].getAttribute("info");
var lat = parseFloat(markers[i].getAttribute("lat"));
var lon = parseFloat(markers[i].getAttribute("lng"));

createMarker(lat, lon, info);
bindInfoWindow(marker, map, infoWindow, html);
}
});
}
function createMarker(lat, lon, info){
var myLatlng = new google.maps.LatLng($latitude,$longitude);
var marker = new google.maps.Marker({
position: myLatlng,
map: map,
title:"My location",
icon: "http://google-maps-icons.googlecode.com/files/airport.png"
});
}
</script>
<!-- End Geting map via latitude and longitude-->

<!-- Start calling load map function to load the map -->
<body onload="loadmap ()">
<div id="map_canvas" style="width:400px; height:300px"></div>
<div id="test" style="width:50%; height:50%"></div>
<!-- End calling load map function to load the map --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-14T10:03:15.293

您忘记使用 echo/print 来打印 PHP 变量的值。

在 createMarker 中，您应该参考提供的参数 (lat,lon) 而不是 $latitude/$longitude

固定版本：

```
<body onload="loadmap ()">
<script  src="http://maps.google.com/maps/api/js?sensor=false">
   </script>
<script src="http://www.iplocationtools.com/iplocationtools.js?key=YOURKEY">
   </script>
<?php
$latitude = 'ip2location_latitude()'; //------------ IP latitude
$longitude = 'ip2location_longitude()'; //------------ IP latitude ip2location_longitude() 
?>
<script type="text/javascript">
function loadmap () { 
  var latlng = new google.maps.LatLng(<?php echo $latitude;?>,<?php echo $longitude;?>);
  var option = {
                zoom: 8,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
               };
  map = new google.maps.Map(document.getElementById("map_canvas"), option);
  createMarker(<?php echo $latitude;?>,<?php echo $longitude;?>, 'lol');

}
function createMarker(lat, lon, info){
var myLatlng = new google.maps.LatLng(lat,lon);
var marker = new google.maps.Marker({
position: myLatlng,
map: map,
title:"My location",
icon: "http://google-maps-icons.googlecode.com/files/airport.png"
});
}
</script>
<div id="map_canvas" style="width:400px; height:300px"></div>
<div id="test" style="width:50%; height:50%"></div>
</body> 
```

但是，这项服务不是很准确，对我来说，它显示的位置距离我当前的位置 400 公里。我建议使用浏览器实现的地理位置。

# sharepoint-2010 - 仅在共享点中以编程方式获取域名

> ID：11017506
> 
> 赞同：1
> 
> 时间：2012-06-13T14:49:19.940
> 
> 标签：sharepoint-2010

谁能告诉我如何仅在sharepoint中获取**域名？**我想将一个用户添加到一个组中，我必须在那里指定域名。我不想硬编码它。

“域\sp_user1”

任何帮助将不胜感激。

# javascript - 将 onClick 事件添加到 document.createElement("th")

> ID：11017509
> 
> 赞同：62
> 
> 时间：2012-06-13T14:49:24.073
> 
> 标签：javascript, html-table

我通过使用动态地将列添加到表中`document.createElement("th")`

```
var newTH = document.createElement('th'); 
```

有没有办法为此设置一个`onClick`属性，以便用户可以通过单击标题来删除该列？任何帮助都会很棒。如果这不可能，是否可以放入一些东西

```
newTH.innerHTML 
```

让它工作？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-06-13T14:58:18.057

```
var newTH = document.createElement('th');
newTH.innerHTML = 'Hello, World!';
newTH.onclick = function () {
    this.parentElement.removeChild(this);
};

var table = document.getElementById('content');
table.appendChild(newTH); 
```

工作示例：http: [//jsfiddle.net/23tBM/](http://jsfiddle.net/23tBM/)

您也可以使用 隐藏`this.style.display = 'none'`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-13T14:50:52.147

```
var newTH = document.createElement('th');
newTH.onclick = function() {
      //Your code here
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-02-22T17:01:38.913

```
var newTH = document.createElement('th');
newTH.setAttribute("onclick", "removeColumn(#)");
newTH.setAttribute("id", "#");

function removeColumn(#){
// remove column #
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-13T14:52:48.527

```
var newTH = document.createElement('th');
newTH.addEventListener( 'click', function(){
  // delete the column here
} ); 
```

# sql - 比较来自 2 个不同表的 2 列并更新一列

> ID：11017510
> 
> 赞同：2
> 
> 时间：2012-06-13T14:49:24.643
> 
> 标签：sql, sql-server

我想比较表 a 和表 b 中的列

如果可以在表 b 中找到表 a 中的 a 值，那么我想用“是”更新表 a 中的另一列，如果找不到，我想说“不”。这是我到目前为止所拥有的：

```
UPDATE a 
set
[CCA Match Org] = CASE WHEN b.[serial] = a.[CSI] THEN 'yes' ELSE 'no' END 
```

我目前的错误说：

> 列前缀“b”与查询中使用的表名或别名不匹配。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T14:53:32.613

假设连接开启`b.[serial] = a.[CSI]`：

```
UPDATE a
SET [CCA Match Org] = CASE WHEN b.[serial] IS NOT NULL 
  THEN 'yes' ELSE 'no' END
FROM a LEFT OUTER JOIN b
ON b.[serial] = a.[CSI]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:56:07.610

这是一个简单的示例，不确定它是否适用于您的情况，因为您没有向我们提供有关表结构的更多信息。

```
UPDATE a SET col='Yes' WHERE a.id IN (SELECT a.id FROM a JOIN b ON a.CSI = b.serial) 
```

# c++ - 在哪里可以找到有关 C++ [[deprecated]] 属性的信息

> ID：11017512
> 
> 赞同：6
> 
> 时间：2012-06-13T14:49:30.027
> 
> 标签：c++, c++11, c++14

我收到了一个描述C++11 中属性的[链接。](http://docwiki.embarcadero.com/RADStudio/en/Deprecated)`[[deprecated]]`这听起来很方便，我想了解更多关于它的信息——哪些编译器支持它，完整的文档等等。

我花了 20 分钟左右的时间在谷歌上搜索，但*除了链接的网站外，我在**任何地方都*找不到关于此的信息。部分原因是与 C++11 相关的“已弃用”一词的其他用法以及搜索引擎无法识别`[[`. 我也没有在与各种 SO 答案相关的标准草案中找到这一点。我无法访问完整的付费标准。

**有人有关于这个`[[deprecated]]`属性的更多信息吗？**

*PS：如果你很好奇，我会用它作为[https://stackoverflow.com/a/295229/599884的更好替代品](https://stackoverflow.com/a/295229/599884)*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-01-17T16:12:48.033

该`[[deprecated]]`属性已进入 C++14 草案（参见[2013 年 10 月草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3797.pdf)的第 7.6.5 [dcl.attr.deprecated] 节）。

> *属性标记* `deprecated`可用于标记仍允许使用但出于某种原因不鼓励使用的名称和实体。

例如，`foo`不推荐使用以下函数：

```
[[deprecated]]
void foo(int); 
```

可以提供一条消息来描述名称或实体被弃用的原因：

```
[[deprecated("Replaced by bar, which has an improved interface")]]
void foo(int); 
```

消息必须是字符串文字。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-13T14:51:31.250

首先，里面的东西`[[]]`不是关键字；它们是属性。

`[[deprecated]]`其次， C++11 标准没有定义属性。您所指的链接要么错误，要么指的是实现此属性的特定编译器（也许是 C++Builder？）。

属性（通常）是特定于编译器的。像`#pragma`s 一样，编译器应该忽略它们不支持的任何属性。

# database - 保护（或跟踪抄袭）公开可用的 Web 内容（数据库/列表/地址）

> ID：11017516
> 
> 赞同：0
> 
> 时间：2012-06-13T14:49:32.327
> 
> 标签：database, text, protection, watermark

我们已经建立了一个非常全面的全国零售商数据库，具有特定的标准。花了一年多的电话采访等，才把名单放在一起。当然，该列表不会在我们的网站上公开提供以作为平面文件下载……那太愚蠢了。

但是所有内容都可以通过谷歌地图在网站上搜索到。所以理论上，通过足够的邮政编码搜索，最终有人可以获取所有零售商数据。当然，我们不希望这样，因为我们的整个模型是进行编译该数据库所需的研究和采访，并将其提供给最终用户以供在我们的网站上使用。

因此，我们得出的结论是，实际上没有任何方法可以保护数据不被集体获取，而是一个潜在的竞争网站。但是有没有办法给数据加水印？由于在我们的数据库中预先计算了纬度/经度，我们不需要地址 100% 正确。例如，我们正在考虑将“1776 3rd St”替换为“1776 Third Street”，或者将标准字符替换为 unicode 替换。这样，如果我们恰好在竞争网站上找到这些数据，我们就会知道这是抄袭。不利的一面是，如果用户试图将修改后的地址剪切并粘贴到他们自己的谷歌地图实例中——在某些情况下，修改会使其变得困难。

其他具有有价值的公开分发内容的网站如何应对这一挑战？有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:01:58.010

如果您问我，这是“公开分发”与“不公开分发”的问题。如果你真的想分发它，你应该承认有人可以接收数据。

对于某些类型的数据（如照片、电影等媒体），您可以对数据加水印或以其他方式篡改数据，使其变得可追踪，但如果您的内容与您的内容相似，这将变得很难，甚至更难防御：如果您使用 "第三条街”，别人也用，你觉得可以告他们吗？我对此表示高度怀疑。

我能想到的唯一步骤是

*   使获取所有信息变得更加困难。将其隐藏在脚本和其他东西后面而不是将其放在谷歌地图上，确保它尽可能地让机器人获取信息，限制向一个用户显示的结果数量等。这很可能意味着你的服务对最终用户的吸引力较小，这是一种权衡

*   与上述相反：使用相同的技术为普通用户隐藏一些数据，而不是向他们显示。这将是假数据，普通人不应该看到。如果这些零售商出现在您的竞争对手面前，您就已经抓住了他们。这当然不是万无一失的，因为他们可以检查结果的有效性并删除您的虚假内容，具有奇怪系统的用户总是有可能获得虚假数据，这会使您提供的内容不那么正确，最后如果您的竞争对手' 刮板看起来太像真实用户，它不会获取数据。

*   提供两步信息：在第一步中，您可以获得“关于”信息，任何人都可以找到。在第 2 步中，在您确认这是用户想要的（可能是登录名，可能只是请求限制等）之后，您可以提供一切。因此，如果用户搜索容易到达的零售商，首先说明您在哪个区域有一些，并在地图上“大致”显示，如果他们选择了某些东西，请在有限的环境中向他们显示真正的信息是什么.

# facebook - 检查 Facebook 应用程序是否在 iframe 选项卡中

> ID：11017517
> 
> 赞同：0
> 
> 时间：2012-06-13T14:49:35.267
> 
> 标签：facebook, api, iframe

当有人进入应用程序 ( ) 时，我需要我的应用程序重定向到带有`iframe`选项卡 ( ) 的站点`https://www.facebook.com/pages/namepage...idapp``https://apps.facebook.com/idapp`

如何检查应用程序是否在`iframe`选项卡中打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:12:28.557

[通过页面标签应用程序加载应用程序时， signed_request](https://developers.facebook.com/docs/authentication/signed_request/)中的 a`page`参数将存在，否则将不存在。使用它来确定应用程序应该呈现为画布应用程序还是页面选项卡应用程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:54:52.410

在您的应用设置中设置画布页面 URL，当该 URL 被称为“重定向”用户时，通过 JavaScript，`top.location.href = "//facebook.com/yourpageid/…"`

# ms-access - 通过远程应用程序打开客户端应用程序

> ID：11017520
> 
> 赞同：1
> 
> 时间：2012-06-13T14:49:44.220
> 
> 标签：ms-access, outlook, rdp

我已经对此进行了大量搜索，但我很难找到答案。

目前我有一个访问程序，它位于远程 Windows 2008 服务器上，用户可以通过远程应用程序登录它。在我的程序的本地版本中，用户可以点击按钮并通过 Outlook 发送电子邮件，但显然如果您远程访问它，它会尝试远程打开 Outlook。

那么问题来了：是否有任何功能可以让我在使用远程应用程序时在本地打开 Outlook？

我读过有关可编写脚本的虚拟频道的信息，但我希望有人确认这是否可能（或者称我为白痴，甚至考虑这个想法）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:35:18.873

拆分数据库。然后，您的客户端将在本地打开 Outlook。

如果您不知道如何拆分数据库以及有什么好处，这里有一些信息可能会有所帮助：http: [//office.microsoft.com/en-us/access-help/split-an-access-database- HA010342026.aspx](http://office.microsoft.com/en-us/access-help/split-an-access-database-HA010342026.aspx)

# oracle - 如何增加oracle中的标识符？

> ID：11017522
> 
> 赞同：1
> 
> 时间：2012-06-13T14:49:45.593
> 
> 标签：oracle, oracle11g, identifier

我安装了 Oracle 11gR1，但我通常会遇到错误消息

> 标识符太长

是增加标识符的解决方案吗？30 个字符对于我的表格和 sp 命名标准来说太短了

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-13T14:53:39.213

30 个字符的限制不是您可以调整的。它是内置于 Oracle 中的。您需要调整命名约定。还有另一个线程讨论[为什么 Oracle 标识符限制为 30 个字符](https://stackoverflow.com/questions/1378133/why-are-oracle-table-column-index-names-limited-to-30-characters)。

# perl - 在perl中将值从一个哈希复制到另一个哈希

> ID：11017523
> 
> 赞同：17
> 
> 时间：2012-06-13T14:49:46.727
> 
> 标签：perl, hash

我有两个哈希值，一个大一个小。所有较小哈希的键都显示在较大的哈希中，但值不同。我想将值从较大的哈希复制到较小的哈希。

例如：

```
# I have two hashes like so
%big_hash = (A => '1', B => '2', C => '3', D => '4', E => '5');
%small_hash = (A => '0', B => '0', C => '0');
# I want small_hash to get the values of big_hash like this
%small_hash = (A => '1', B => '2', C => '3'); 
```

一个明显的答案是遍历小散列的键，并像这样复制值

```
foreach $key (keys %small_hash) { $small_hash{$key} = $big_hash{$key}; } 
```

有没有更短的方法来做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-13T15:00:38.983

```
@small_hash{ keys %small_hash } = @big_hash{ keys %small_hash }; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-13T15:03:34.567

这是您可以做到的一种方法：

```
%small = map { $_, $big{$_} } keys %small; 
```

尽管如此，这与 for 循环非常相似。

```
$small{$_} = $big{$_} for keys %small; 
```

* * *

[`map`](http://ideone.com/1PjLI) **为需要的人[**提供证明：**](http://ideone.com/1PjLI)**

 **```
my %big = (A => '1', B => '2', C => '3', D => '4', E => '5');
my %small = (A => '0', B => '0', C => '0');

%small = map { $_, $big{$_} } keys %small;

print join ', ', %small; 
```

输出：

```
A, 1, C, 3, B, 2 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-13T14:56:52.263

```
use strict;
my %source = ( a =>  1, b => 2, c => 3 );
my %target = ( a => -1, x => 7, y => 9 );

# Use a hash slice for the copy operation.
# Note this will clobber existing values.
# Which is probably what you intend here.
@target{ keys %source } = values %source;

for ( sort keys %target ) {
  print $_, "\t", $target{ $_ }, "\n";
} 
```**

# php - UPS API 错误：发货请求文件无效

> ID：11017525
> 
> 赞同：0
> 
> 时间：2012-06-13T14:49:52.360
> 
> 标签：php, soap, ups

我正在尝试为官方 UPS SDK 附带的 UPS Freight Shipping API 运行 PHP 测试。我终于用正确的用户名、密码和 API 密钥连接到 SOAP 服务，但现在我遇到了一个我不知道如何解决的错误。从服务器返回的错误是

> 无效的发货请求文件

来自服务器的完整响应如下所示：

```
SoapFault Object
(
[message:protected] => An exception has been raised as a result of client data.
[string:private] => 
[code:protected] => 0
[file:protected] => /my_home_dir/UPS_API/test.php
[line:protected] => 224
[trace:private] => Array
    (
        [0] => Array
            (
                [file] => /my_home_dir/UPS_API/test.php
                [line] => 224
                [function] => __soapCall
                [class] => SoapClient
                [type] => ->
                [args] => Array
                    (
                        [0] => ProcessFreightRate
                        [1] => Array
                            (
                                [0] => Array
                                    (
                                        [Request] => Array
                                            (
                                                [RequestOption] => RateChecking Option
                                            )

                                        [ShipFrom] => Array
                                            (
                                                [Name] => Good Incorporation
                                                [Address] => Array
                                                    (
                                                        [AddressLine] => 2010 WARSAW ROAD
                                                        [City] => Roswell
                                                        [StateProvinceCode] => GA
                                                        [PostalCode] => 30076
                                                        [CountryCode] => US
                                                    )

                                            )

                                        [ShipTo] => Array
                                            (
                                                [Name] => Sony Company Incorporation
                                                [Address] => Array
                                                    (
                                                        [AddressLine] => 2311 YORK ROAD
                                                        [City] => TIMONIUM
                                                        [StateProvinceCode] => MD
                                                        [PostalCode] => 21093
                                                        [CountryCode] => US
                                                    )

                                            )

                                        [PaymentInformation] => Array
                                            (
                                                [Payer] => Array
                                                    (
                                                        [Name] => Payer inc
                                                        [Address] => Array
                                                            (
                                                                [AddressLine] => 435 SOUTH STREET
                                                                [City] => RIS TOWNSHIP
                                                                [StateProvinceCode] => NJ
                                                                [PostalCode] => 07960
                                                                [CountryCode] => US
                                                            )

                                                    )

                                                [ShipmentBillingOption] => Array
                                                    (
                                                        [Code] => 10
                                                        [Description] => PREPAID
                                                    )

                                            )

                                        [Service] => Array
                                            (
                                                [Code] => 308
                                                [Description] => UPS Freight LTL
                                            )

                                        [HandlingUnitOne] => Array
                                            (
                                                [Quantity] => 20
                                                [Type] => Array
                                                    (
                                                        [Code] => PLT
                                                        [Description] => PALLET
                                                    )

                                            )

                                        [Commodity] => Array
                                            (
                                                [CommodityID] => 
                                                [Description] => No Description
                                                [Weight] => Array
                                                    (
                                                        [UnitOfMeasurement] => Array
                                                            (
                                                                [Code] => LBS
                                                                [Description] => Pounds
                                                            )

                                                        [Value] => 750
                                                    )

                                                [Dimensions] => Array
                                                    (
                                                        [UnitOfMeasurement] => Array
                                                            (
                                                                [Code] => IN
                                                                [Description] => Inches
                                                            )

                                                        [Length] => 23
                                                        [Width] => 17
                                                        [Height] => 45
                                                    )

                                                [NumberOfPieces] => 45
                                                [PackagingType] => Array
                                                    (
                                                        [Code] => BAG
                                                        [Description] => BAG
                                                    )

                                                [DangerousGoodsIndicator] => 
                                                [CommodityValue] => Array
                                                    (
                                                        [CurrencyCode] => USD
                                                        [MonetaryValue] => 5670
                                                    )

                                                [FreightClass] => 60
                                                [NMFCCommodityCode] => 
                                            )

                                        [ShipmentServiceOptions] => Array
                                            (
                                                [PickupOptions] => Array
                                                    (
                                                        [HolidayPickupIndicator] => 
                                                        [InsidePickupIndicator] => 
                                                        [ResidentialPickupIndicator] => 
                                                        [WeekendPickupIndicator] => 
                                                        [LiftGateRequiredIndicator] => 
                                                    )

                                                [OverSeasLeg] => Array
                                                    (
                                                        [Dimensions] => Array
                                                            (
                                                                [Volume] => 20
                                                                [UnitOfMeasurement] => Array
                                                                    (
                                                                        [Code] => CF
                                                                        [Description] => String
                                                                    )

                                                            )

                                                        [Value] => Array
                                                            (
                                                                [Cube] => Array
                                                                    (
                                                                        [CurrencyCode] => USD
                                                                        [MonetaryValue] => 5670
                                                                    )

                                                            )

                                                        [COD] => Array
                                                            (
                                                                [CODValue] => Array
                                                                    (
                                                                        [CurrencyCode] => USD
                                                                        [MonetaryValue] => 363
                                                                    )

                                                                [CODPaymentMethod] => Array
                                                                    (
                                                                        [Code] => M
                                                                        [Description] => For Company Check
                                                                    )

                                                                [CODBillingOption] => Array
                                                                    (
                                                                        [Code] => 01
                                                                        [Description] => Prepaid
                                                                    )

                                                                [RemitTo] => Array
                                                                    (
                                                                        [Name] => RemitToSomebody
                                                                        [Address] => Array
                                                                            (
                                                                                [AddressLine] => 640 WINTERS AVE
                                                                                [City] => PARAMUS
                                                                                [StateProvinceCode] => NJ
                                                                                [PostalCode] => 07652
                                                                                [CountryCode] => US
                                                                            )

                                                                        [AttentionName] => C J Parker
                                                                    )

                                                            )

                                                        [DangerousGoods] => Array
                                                            (
                                                                [Name] => Very Safe
                                                                [Phone] => Array
                                                                    (
                                                                        [Number] => 453563321
                                                                        [Extension] => 1111
                                                                    )

                                                                [TransportationMode] => Array
                                                                    (
                                                                        [Code] => CARGO
                                                                        [Description] => Cargo Mode
                                                                    )

                                                            )

                                                        [SortingAndSegregating] => Array
                                                            (
                                                                [Quantity] => 23452
                                                            )

                                                        [CustomsValue] => Array
                                                            (
                                                                [CurrencyCode] => USD
                                                                [MonetaryValue] => 23457923
                                                            )

                                                        [HandlingCharge] => Array
                                                            (
                                                                [Amount] => Array
                                                                    (
                                                                        [CurrencyCode] => USD
                                                                        [MonetaryValue] => 450
                                                                    )

                                                            )

                                                    )

                                            )

                                    )

                            )

                    )

            )

    )

[faultstring] => An exception has been raised as a result of client data.
[faultcode] => Client
[faultcodens] => http://schemas.xmlsoap.org/soap/envelope/
[detail] => stdClass Object
    (
        [Errors] => stdClass Object
            (
                [ErrorDetail] => stdClass Object
                    (
                        [Severity] => Hard
                        [PrimaryErrorCode] => stdClass Object
                            (
                                [Code] => 9121000
                                [Description] => Invalid Ship Request Document
                            )

                    )

            )

    )

) 
```

可以在此处找到我用来发出请求的代码（出于安全考虑，已删除凭据）： http: [//pastebin.com/Yw7sPQdg](http://pastebin.com/Yw7sPQdg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:08:55.830

原来我指向了错误的终点。运费的端点 URL 应为：[https ://wwwcie.ups.com/webservices/FreightRate](https://wwwcie.ups.com/webservices/FreightRate)

# asp.net - 会话超时到期时重定向页面

> ID：11017527
> 
> 赞同：3
> 
> 时间：2012-06-13T14:49:54.037
> 
> 标签：asp.net, web-applications

当会话在回发期间过期时，我想将用户重定向到主页。当表单超时发生时，用户将被定向到登录页面。

会话超时 = 20，表单超时 = 2880

我在 Global.asax 中尝试了以下代码，但不起作用并导致 Application_Error（“响应在此上下文中不可用。”）。

```
Sub Session_End(ByVal sender As Object, ByVal e As EventArgs)
    ' Fires when the session ends
    Response.Redirect("~/HomePage.aspx")
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:01:05.053

Session_End 不是由浏览器发起的（因为理论上浏览器的任何响应都应该将 Session 再延长 20 分钟），因此 Response 对象的概念没有意义。

我能看到的唯一选择是拥有某种利用该`window.setTimeout`功能的客户端脚本（javascript）......类似于（未经测试）......

```
<body onload="window.setTimeout(function(){document.location.href='/Home.aspx';},72000000);"> 
```

**更新**

再次阅读请求后，要求有点模棱两可。如果要求网页在 20 分钟后自动重定向（无需用户干预），那么我的回答就是解决这个问题。

但是，我认为如果用户在 20 分钟后*向服务器发送另一个请求，*则更有可能要求重定向到主页。在这种情况下，MajoB 的答案是一个很好的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:29:06.800

它是您的 web.config 中的一个属性

```
<forms name="WhateverYourAuthNameIs" 
       loginUrl="~/HomePage.aspx" 
       defaultUrl="~/Default.aspx" 
       protection="All" path="/" 
       cookieless="AutoDetect"/> 
```

当到期时，它们将被发送到`loginUrl`设置的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:00:54.080

如果你不能使用 `Server.Transfer`，或者`Respose.Redirect`你可以在每个页面的 page_load 事件中检查一些会话变量。如果此会话变量为空，则重定向到特定页面。您可以创建基本页面以避免代码重复。

# c# - 位图帧解码成图像

> ID：11017530
> 
> 赞同：0
> 
> 时间：2012-06-13T14:50:00.650
> 
> 标签：c#, .net, wpf, exception-handling, bitmap

最近，我决定使用 Windows Presentation Foundation 并创建一个国际象棋的变体。整个事情已经完成了（我相信），但现在已经很长时间了，因为我找不到将我的 PNG 文件设置为图像控件的方法。这是受问题影响的示例类：

```
public class Field
{
    public Image Image { get; set; }

    public Image GetImage(String keyName)
    {
        ResourceDictionary imagesDictionary = new ResourceDictionary();
        imagesDictionary.Source = new Uri("file:/[...]/ImagesDictionary.xaml");
        var var = imagesDictionary[keyName];
        Image image = (Image) imagesDictionary[keyName];
        return image;
    }

    public void RefreshImage()
    {
        if (Unit.Subclass.CompareTo("Bishop").Equals(0))
        {
            if (Unit.Player.IsWhite)
            {
                this.Image = this.GetImage("WhiteBishop");
            }
            ...
    }

} 
```

我的 ImagesDictionary.xaml 文件：

```
<ResourceDictionary>
    <ImageSource x:Key="BlackBishop">BlackBishop.png</ImageSource>
    <ImageSource x:Key="WhiteBishop">WhiteBishop.png</ImageSource>
    ...
</ResourceDictionary> 
```

问题是我不知道如何转换 GetImage 的输出

> (System.Windows.Media.Imaging.BitmapFrameDecode)

进入

> (System.Windows.Controls.Image)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:01:12.150

System.Windows.Media.Imaging.BitmapFrame 派生自 ImageSource。

你应该能够做到这一点：

```
this.Image = new Image();
this.Image.Source = this.GetImage("WhiteBishop"); 
```

或者

```
this.Image.Source = this.GetImage("WhiteBishop").Source; 
```

如果 BitmapFrameDecode 确实是从 System.Windows.Imaging.Image 派生的，而不是从 ImageSource 派生的。

-杰西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T05:44:57.817

```
Dim img As New BitmapImage

Using mem As New System.IO.MemoryStream(<InputArrayHere>)
    img.BeginInit()
    img.StreamSource = mem
    img.EndInit()
End Using

return img 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T22:40:47.397

好的，这是一个改进的 GetImageSource（名称已更改以反映其实际用途）。

```
 /// <summary>
    /// Get an ImageSource from the ResourceDictionary  referred to by the
    ///     <paramref name="uriDictionary"/>.
    /// </summary>
    /// <param name="keyName">The ResourceDictionary key of the ImageSource
    ///     to retrieve.</param>
    /// <param name="uriDictionary">The Uri to the XAML file that holds
    ///     the ResourceDictionary.</param>
    /// <returns><c>null</c> on failure, the requested <c>ImageSource</c>
    ///     on success.</returns>
    /// <remarks>If the requested resource is an <c>Image</c> instead of
    ///     an <c>ImageSource</c>,
    /// then the <c>image.Source</c> is returned.</remarks>
    public static ImageSource GetImageSource(String keyName, Uri uriDictionary)
    {
        if (String.IsNullOrEmpty(keyName))
            throw new ArgumentNullException("keyName");
        if (null == uriDictionary)
            throw new ArgumentNullException("uriDictionary");

        ResourceDictionary imagesDictionary = new ResourceDictionary();
        imagesDictionary.Source = uriDictionary;
        var var = imagesDictionary[keyName];
        Object blob = imagesDictionary[keyName];
        Debug.WriteLine(String.Format(
            "error: GetImageSource( '{0}', '{1}' )"
            + " value is: {2}",
            keyName,
            uriDictionary,
            (null == blob) ? "null" : blob.GetType().FullName));
        if (null != blob)
        {
            if (blob is ImageSource)
            {
                return blob as ImageSource;
            }
            if (blob is Image)
            {
                Image image = blob as Image;
                return image.Source;
            }
            if (blob is System.Drawing.Image)
            {
                System.Drawing.Image dImage = blob as System.Drawing.Image;
                MemoryStream mem = new MemoryStream();
                dImage.Save(mem, System.Drawing.Imaging.ImageFormat.MemoryBmp);
                mem.Position = 0;
                BitmapDecoder decode = new BmpBitmapDecoder(
                    mem,
                    BitmapCreateOptions.None,
                    BitmapCacheOption.None);
                return decode.Frames[0];
            }
            Debug.WriteLine(String.Format(
                "error: GetImageSource( '{0}', '{1}' )"
                + " can't handle type: {2}",
                keyName,
                uriDictionary,
                blob.GetType().FullName));
        }
        return null;
    } 
```

要使用它，您可以这样做：

```
String packText = String.Format("pack://application:,,,/{0};component/{1}",
    Assembly.GetEntryAssembly().FullName,
    "ImageDictionary.xaml");
Uri imageUri = new Uri(packText);
// or if you prefer:
// Uri imageUri = new Uri("file:///.../ImageDictionary.xaml");
//

ImageSource source = GetImageSource(imageKey, imageUri);

if (null != source)
{
    this.Image.Source = source;
}
else
{
    // bail ...
} 
```

该`Drawing.Image`案例将处理 BMP、PNG、JPG、GIF 等，即使我使用`BmpBitmapDecoder`. 但请注意，XAML 图像可以非常漂亮地拉伸，但`Drawing.Image`不会。

-杰西

# javascript - 如何确定何时创建 jQuery 数据表并加载数据

> ID：11017533
> 
> 赞同：18
> 
> 时间：2012-06-13T14:50:11.210
> 
> 标签：javascript, jquery, jquery-plugins, internet-explorer-8

我正在使用最新版本的`jQuery datatables`. 在数据加载并显示在数据表中之后，我可以使用回调函数吗？

我有一个我正在试验的数据表`IE8`。我有两组正在测试的数据（我一次只使用一组）。我有一个 JavaScript 数组和一组从 Ajax 调用中获得的数据。我正在使用`ASP.NET MVC 3`.

从 Ajax 调用获取数据的配置：

```
$('#banks-datatable').dataTable({
     "bProcessing": true,
     "sAjaxSource": '/Administration/Bank/List',
     "aoColumns": [
          { "sTitle": "Engine" },
          { "sTitle": "Browser" },
          { "sTitle": "Platform" },
          { "sTitle": "Version" },
          { "sTitle": "Grade" }
     ],
     "bAutoWidth": false,
     "bFilter": false,
     "bLengthChange": false,
     "iDisplayLength": 10
});

alert('test'); 
```

当以这种方式加载我的数据表时，将创建数据表（没有数据），并显示处理框并显示警报弹出窗口。此时数据表已存在，但尚未将数据加载到数据表中。只有当弹出窗口消失时（当我单击弹出窗口上的 Ok 按钮时），数据才会加载到数据表中。为什么是这样？

从 JavaScript 数组获取数据的配置：

```
var aDataSet = [
     ['Trident', 'Internet Explorer 4.0', 'Win 95+', '4', 'X'],
     ['Trident', 'Internet Explorer 5.0', 'Win 95+', '5', 'C'],
     ['Trident', 'Internet Explorer 5.5', 'Win 95+', '5.5', 'A'],
     ['Trident', 'Internet Explorer 6', 'Win 98+', '6', 'A'],
     ['Trident', 'Internet Explorer 7', 'Win XP SP2+', '7', 'A'],
     ['Trident', 'AOL browser (AOL desktop)', 'Win XP', '6', 'A'],
     ['Gecko', 'Firefox 1.0', 'Win 98+ / OSX.2+', '1.7', 'A']
];

$('#banks-datatable').dataTable({
     "aoColumns": [
          { "sTitle": "Engine" },
          { "sTitle": "Browser" },
          { "sTitle": "Platform" },
          { "sTitle": "Version" },
          { "sTitle": "Grade" }
     ],
     "bAutoWidth": false,
     "bFilter": false,
     "bLengthChange": false,
     "iDisplayLength": 10,
     "aaData": aDataSet
});

alert('test'); 
```

创建数据表并加载数据，然后仅显示弹出窗口。这与第一种情况不同。为什么会这样？

如果我采用第一种情况，有没有办法可以确定何时创建数据表并加载数据？

通过此检查，我希望它具有通用性，以便可以以我决定加载数据的任何方式使用它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-07-04T17:06:47.190

你最好使用`fnInitComplete`：

```
$(document).ready(function () {
    $('#example').dataTable({
        "fnInitComplete": function (oSettings, json) {
            alert('DataTables has finished its initialisation.');
        }
    });
}) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-13T15:34:08.633

您可以使用该[`fnDrawCallback`](http://datatables.net/usage/callbacks)功能。每次绘制表格时都会调用它。这将包括表何时加载数据、排序或过滤。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-11-25T13:50:03.533

在新版本的 jQuery DataTable 上，该方法被调用：[`initComplete()`](https://datatables.net/reference/option/initComplete)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-12-11T12:49:27.610

Datatable 提供了 InitComplete 选项。你可以使用它。可能会有所帮助

```
$('#example').DataTable({
  "initComplete": function(){
    alert('Data loaded successfully');
  }
}); 
```

链接-> [https://datatables.net/reference/option/initComplete](https://datatables.net/reference/option/initComplete)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-13T15:35:31.633

我一直都知道 javascript 是单线程的。这是一个支持这一点的帖子：

[JavaScript 是否保证是单线程的？](https://stackoverflow.com/questions/2734025/is-javascript-guaranteed-to-be-single-threaded)

在第一个场景中，您从服务器获取数据，然后使用警报框阻止线程。在第二种情况下，您预先填充数据。我相信这就是区别。

[此页面](http://datatables.net/usage/callbacks#fnServerData)显示如何在成功时调用回调：

```
 // POST data to server
 $(document).ready(function() {
   $('#example').dataTable( {
     "bProcessing": true,
     "bServerSide": true,
     "sAjaxSource": "xhr.php",
     "fnServerData": function ( sSource, aoData, fnCallback ) {
       $.ajax( {
         "dataType": 'json',
         "type": "POST",
         "url": sSource,
         "data": aoData,
         "success": fnCallback
       } );
     }
   } );
 } ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-05T15:47:11.517

您还可以使用 dataSrc 作为“成功”的替代品，因为它不应该被重载：

这里有 datatables.net 的典型例子

```
var table = $('#example').DataTable( {
    "ajax": {
            "type" : "GET",
            "url" : "ajax.php",
            "dataSrc": function ( json ) {
                //Make your callback here.
                alert("Done!");
                return json.data;
                }       
            },
    "columns": [
            { "data": "name" },
            { "data": "position" },
            { "data": "office" },
            { "data": "extn" },
            { "data": "start_date" },
            { "data": "salary" }

        ]
    } ); 
```

# android - 水平滚动视图拉伸内的Android网络视图

> ID：11017540
> 
> 赞同：1
> 
> 时间：2012-06-13T14:50:24.627
> 
> 标签：android, webview, horizontal-scrolling, horizontalscrollview

我有一个带有水平滚动视图的详细视图，我在这个水平滚动视图中插入了一些 web 视图。

这是xml代码：

```
<HorizontalScrollView
        android:id="@+id/horizontal"
        android:layout_below="@+id/linearLayout2"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">

        <LinearLayout
            android:id="@+id/linear"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:orientation="horizontal"/>

</HorizontalScrollView> 
```

这是我将 Web 视图放置到此水平滚动视图的代码：

```
HorizontalScrollView scroll = (HorizontalScrollView)findViewById(R.id.horizontal);

        LinearLayout linear = (LinearLayout)findViewById(R.id.linear);

        SearchJobDetailWebView test1 = new SearchJobDetailWebView(this, middleData.get(0).getExportUrl());
        linear.addView(test1.setWebView());

        SearchJobDetailWebView test2 = new SearchJobDetailWebView(this, middleData.get(0).getExportUrl());
        linear.addView(test2.setWebView());

        SearchJobDetailWebView test3 = new SearchJobDetailWebView(this, middleData.get(0).getExportUrl());
        linear.addView(test3.setWebView()); 
```

问题是网页视图在水平滚动视图中被拉伸。（Webview 宽度是显示的一半）。怎么了 ？多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T17:30:34.437

好的，我将尝试根据我的理解回答您的问题。您有 3`webviews`和 2 在屏幕上，第 3 个不在屏幕上，但无论何时水平滚动都应该可见。好吧`WebViews`，使用水平滚动，所以如果你在滑动手指时有 3 个 webvies，它不是主要`Scrollview`的触摸，它是`webview`. 我还没有对此进行测试，但我要做的是`WebView`通过使用以下方法禁用每个中的水平滚动：

```
myWebView.setHorizontalScrollBarEnabled(false); 
```

# pdf - 尝试索引 PDF 时出现 Elasticsearch Parse Exception 错误

> ID：11017543
> 
> 赞同：15
> 
> 时间：2012-06-13T14:50:30.463
> 
> 标签：pdf, base64, elasticsearch, apache-tika, osx-server

我刚刚开始使用弹性搜索。我们的要求是我们需要索引数千个 PDF 文件，我很难让其中一个成功索引。

安装附件类型插件并得到响应：`Installed mapper-attachments`。

遵循[Attachment Type in Action 教程](http://www.elasticsearch.org/tutorials/2011/07/18/attachment-type-in-action.html)，但过程挂起，**我不知道如何解释错误消息**。还尝试了挂在同一个地方的[要点。](https://gist.github.com/1075067)

```
$ curl -X POST "localhost:9200/test/attachment/" -d json.file 
{"error":"ElasticSearchParseException[Failed to derive xcontent from (offset=0, length=9): [106, 115, 111, 110, 46, 102, 105, 108, 101]]","status":400} 
```

更多细节：

`json.file`包含一个嵌入式 Base64 PDF 文件（按照说明）。文件的第一行*看起来*是正确的（无论如何对我来说）：`{"file":"JVBERi0xLjQNJeLjz9MNCjE1OCAwIG9iaiA8`...

我不确定是否可能`json.file`是无效的，或者弹性搜索是否没有设置为正确解析 PDF？！？

**编码**- 这是我们如何将 PDF 编码为`json.file`（根据教程）：

```
coded=`cat fn6742.pdf | perl -MMIME::Base64 -ne 'print encode_base64($_)'`
json="{\"file\":\"${coded}\"}"
echo "$json" > json.file 
```

也试过：

```
coded=`openssl base64 -in fn6742.pdf 
```

日志：

```
[2012-06-07 12:32:16,742][DEBUG][action.index             ] [Bailey, Paul] [test][0], node[AHLHFKBWSsuPnTIRVhNcuw], [P], s[STARTED]: Failed to execute [index {[test][attachment][DauMB-vtTIaYGyKD4P8Y_w], source[json.file]}]
org.elasticsearch.ElasticSearchParseException: Failed to derive xcontent from (offset=0, length=9): [106, 115, 111, 110, 46, 102, 105, 108, 101]
    at org.elasticsearch.common.xcontent.XContentFactory.xContent(XContentFactory.java:147)
    at org.elasticsearch.common.xcontent.XContentHelper.createParser(XContentHelper.java:50)
    at org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:451)
    at org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:437)
    at org.elasticsearch.index.shard.service.InternalIndexShard.prepareCreate(InternalIndexShard.java:290)
    at org.elasticsearch.action.index.TransportIndexAction.shardOperationOnPrimary(TransportIndexAction.java:210)
    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:532)
    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction$1.run(TransportShardReplicationOperationAction.java:430)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680) 
```

希望有人能帮我看看我错过了什么或做错了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-13T19:46:00.667

以下错误指出了问题的根源。

```
Failed to derive xcontent from (offset=0, length=9): [106, 115, 111, 110, 46, 102, 105, 108, 101] 
```

UTF-8 代码 [106, 115, 111, ...] 表明您正在尝试索引字符串“json.file”而不是文件的内容。

要索引文件的内容，只需在文件名前添加字母“@”。

```
curl -X POST "localhost:9200/test/attachment/" -d @json.file 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T22:09:58.037

事实证明，在“无头”服务器上运行 java 应用程序之前有必要`export ES_JAVA_OPTS=-Djava.awt.headless=true`......谁会想到！？！

# visual-studio-2008 - Visual Studio 2008 继续“更新 Intellisense”，即使更改一个字符也会冻结

> ID：11017548
> 
> 赞同：3
> 
> 时间：2012-06-13T14:50:44.103
> 
> 标签：visual-studio-2008, visual-c++, intellisense, freeze

它以前*不是*这样的，但是当我卸载并重新安装 VS 2008 时似乎发生了这种情况。

现在发生的情况是，每当我在 .cpp 文件中进行*单个字符*更改时，不仅 Intellisense 会更新（我的 CPU 一直在运行），而且还会在以下情况下**冻结**IDE 约半分钟：

*   我在更新期间突出显示一个词

*   我在更新期间右键单击

*   更改构建配置

我试图删除所有非必要文件（NCB、PCH 等）但没有任何效果。
（不，我显然*没有* `#include`在其他任何地方使用 .cpp 文件。）

重要的是要指出，如果我不执行上述操作，则**不会发生冻结——CPU 仍在工作，但 IDE 有响应。**

我试图查看 VS 的线程堆栈跟踪，原因确实似乎是 feacp.dll（Intellisense？）——我通过插件管理器*禁用*了 Visual Assist X，但我在任何地方都看*不到*它（或任何其他插件）在堆栈跟踪中。

有谁知道对此有任何修复？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T21:00:51.770

您必须通过重命名或删除来禁用智能`feacp.dll`感知`C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\vcpackages`

# php - 根据下拉列表使用数据库值动态更新 div

> ID：11017549
> 
> 赞同：1
> 
> 时间：2012-06-13T14:50:45.197
> 
> 标签：php, jquery, drop-down-menu

请参阅[网站](http://comfyshoulderrest.com/guestvibe/index.php)。

我的数据库有一个表，其值为“名称”（左侧第 2 步下的事件）、“价格”、“日期”等，我想根据哪个事件在右侧的暗框中动态显示它们选择。

我目前正在使用下面的代码显示事件本身，但我不确定如何开发它以根据此选择获取数据库值。我猜是某种.get()。

```
<script type="text/javascript">

    $(document).ready(function() {
            $('#right_inside').html('<h2>' + $('#club').val() + '</h2>');
    });

    $('#club').change(function(event) {
        $('#right_inside').html('<h2>' + $('#club').val() + '</h2>');
    });

</script> 
```

这让我很困惑很长时间，所以任何帮助都会非常非常感谢！

**编辑**

感谢您的回复。这是我现在拥有的，但它不起作用。

jQuery：

```
<script type="text/javascript">

$(document).ready(function() {
        $('#right_inside').html('<h2>' + $('#club').val() + '</h2>');
});

$('#club').change(function(event) {
    $.ajax({
        type: "post",
        url: "eventinfo.php",
        data:  $(this).serialize(),
        success: function(data) {
            $('#right_inside').html('<h2>' + $('#club').val() + '</h2>Price'+data.price);
            },
        dataType: "json"
    });

});

</script> 
```

事件信息.php：

```
 <?php
// the name of the input text box is 'club'
    $night = $_POST['club'];
    $night = mysql_real_escape_string($night);

// one of the columns values included in * is 'price'
// this line was previously: $query = mysql_query("SELECT * FROM nights WHERE name = '$night'");
    $query = "SELECT * FROM nights WHERE name = '$night'";

        $result = mysql_query($query);
        $items = array();

        if($result && mysql_num_rows($result) > 0) { 
            while ($row = mysql_fetch_array($result)) { 
                $items[] = array($row[0]);
                }         
        } 

        mysql_close(); 
        // convert into JSON format and print
        echo json_encode($items);
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:55:02.650

最好的做法是使用 xmlhttp 对象来加载您的 PHP 页面，该页面会回显数据。从那个 xmlhttp 对象中，您可以将 responseText（这将是您的 PHP 页面的输出内容）分配给一个 Javascript 变量。

换句话说，您可能想要使用[AJAX](http://www.ibm.com/developerworks/web/library/wa-ajaxintro1/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T14:57:57.050

如果我理解正确，您希望通过 AJAX 调用来获取价格。所以像

```
$('#club').change(function(event) {
     $.ajax(
     {type: "post",
     url: "/path/to/price",
     data:  $(this).serialize(),
     success: function(data)
     {
      $('#right_inside').html('<h2>' + $('#club').val() + '</h2>Price'+data.price);
     },
    dataType: "json"
}); 
```

然后，由于您使用的是 PHP，因此获取所需的值并将它们加载到数组中并使用 json_encode。

### 更新

对于 PHP 尝试更改

```
 if($result && mysql_num_rows($result) > 0) { 
        while ($row = mysql_fetch_array($result)) { 
            $items[] = array($row[0]);
            }         
    } 
```

至

```
 if($result && mysql_num_rows($result) > 0) { 
        while ($row = mysql_fetch_array($result)) { 
            $items[] = array("price"=>$row['price']);
            }         
    } 
```

### 更新#2

尝试将以下内容添加到您的 PHP 文件中，靠近顶部：

```
header('Cache-Control: no-cache, must-revalidate');
header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
header('Content-type: application/json'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T15:06:51.500

这是使用客户端模板的好地方。使用 jQuery.tmpl 并为右侧制作一个模板（下面的示例）：

```
<script id="infoTemplate" type="text/html">
    <div>
        <span>${price}</span>
        <span>${information}</span>
    </div>
</script> 
```

然后，在 PHP 中创建一个方法，接收类似于 eventId 的内容并返回一个类似于以下内容的 JSON 对象：{"price":"123.34","information":"some info here"}。要加载您的模板，请执行以下操作：

```
$(document).ready(function(){
    // ... other stuff

    $.template("infoTemplate", $("#infoTemplate").html());
}); 
```

然后，在您的更改事件处理程序中，执行以下操作：

```
$('#club').change(function(event) {
    $.get('/yourNewPHPMethod', $('#club').val(), function(data){
        $('#right_inside').html($.tmpl('infoTemplate', data));
    });
}); 
```

抱歉，没有时间测试这些，但这是主要思想，应该可以帮助您为将来的任何此类工作建立良好的模式。请参阅下面的 jQuery.tmpl 文档：http: [//api.jquery.com/jquery.tmpl/](http://api.jquery.com/jquery.tmpl/)

# jquery - 查找祖父div属性

> ID：11017554
> 
> 赞同：1
> 
> 时间：2012-06-13T14:50:58.230
> 
> 标签：jquery, html

我有以下 HTML

```
<div class="myclass" value="1">
    <div>
      <div class="myclass" value="">
         <a class="popup" id="12" target="_blank" href="xxx">popup</a>
      </div>
     </div>
</div> 
```

我在弹出类上使用带有单击事件的 jQuery，并且我正在尝试使用类“myclass”获取祖父 div 的值，该类在示例中的值为“1”。我试过这个，但它返回我'未定义'

```
$('.popup').click(function(){
    alert($(this).parent('.myclass').parent('.myclass').attr('value')
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T14:53:40.413

这是一个不平衡的牙套问题。您需要关闭警报`);`或使用`closest`而不是`parent`：

```
alert($(this).closest('.myclass').closest('.myclass').attr('value')); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T14:58:49.337

我会使用`parents`而不是`parent`. `parent`只查看直接父级，并且由于您`<div>`在两个 .myclass div 之间有一个，因此选择器失败。

```
$('.popup').click(function(){
    var val = $(this).parents('.myclass').parents('.myclass').attr('value');
    alert(val);
});​ 
```

因此，在您的示例中，第二个`parent`失败是因为选择器不匹配，因为`parent`只查看直接父级。从[`parent`文档](http://api.jquery.com/parent/)中：

> .parents() 和 .parent() 方法是相似的，只是后者只在 DOM 树上向上移动一层。

您也可以将选择器简化为：

```
var val = $(this).parent().parents('.myclass').attr('value'); 
```

可以[在 jsFiddle](http://jsfiddle.net/FKX75/)上找到一个工作示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:57:03.667

那这个呢？

```
$('.popup').click(function(e){
    alert($(this).parents('.myclass').last().attr('value')
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T13:03:57.450

就我而言，此页面上的所有代码均无效。但这项工作！var 结果 = $(this).closest('.news').attr('index');

# jquery - 升级到 Cordova 1.7.0 并且 Xcode 抛出错误：NetworkStatus0 = TypeError: 'undefined' is not an object

> ID：11017560
> 
> 赞同：0
> 
> 时间：2012-06-13T14:51:18.753
> 
> 标签：jquery, cordova

似乎无法弄清楚这一点。该脚本适用于 phonegap 1.2.0 和 jquery 1.5。升级到 Cordova 1.7.0 和 Jquery 1.7.2 似乎无法消除此错误。我的 php 脚本完美地输出了 json，下面的 load-json.js 脚本拉入数据没有问题。不知道 - 非常感谢 4 个月新手的帮助。谢谢你。

```
 Index.html:

enter code here

<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />

<script src="cordova-1.7.0.js"></script>
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/load-json.js"></script>

<script>
    function onBodyLoad() {     
        document.addEventListener("deviceready",onDeviceReady,false);
    }
</script>
</head>
<body onload="onBodyLoad()">
<div id="output"></div>
</body>
</html>

Javascript:

$(document).ready(function(){
$(document).bind('deviceready', function(){
    var output = $('#output');

    $.ajax({
        url: 'http://myurl.php',
        dataType: 'jsonp',
        jsonp: 'jsoncallback',
        timeout: 5000,
        success: function(data, status){
            $.each(data, function(i,item){ 
                var blogpost = '<h1>'+item.name+'</h1>'
                + '<p>'+item.text+'<br>'
                + item.date+'</p>';

                output.append(blogpost);
            });
        },
        error: function(){
           output.text('There was an error loading the data.');
        }
    });
    });
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:02:26.123

自 v1.6.0 以来，所有插件名称都已更改。确保您按照升级步骤将 plist 替换为新的。

# visual-studio - 在另一个 repo 中共享 git 存储库中的子项目

> ID：11017578
> 
> 赞同：4
> 
> 时间：2012-06-13T14:52:08.013
> 
> 标签：visual-studio, git

我有一个 git 存储库，其中包含一个带有多个项目的 Visual Studio 解决方案。我有另一个 git 存储库（也是 VS），我想在第一个存储库中添加一个项目：

```
Repo 1:
Project_1
Project_2
Project_3

Repo 2:
Project_4
Project_5
Project_1 (Same as Project_1 above) 
```

是否可以仅与另一个 git 存储库共享 git 存储库中的一个项目？当我在第二个仓库工作时，我希望能够对属于第一个仓库的项目进行提交/拉取/推送，当我打开第一个仓库时，我希望能够获得对第一个仓库所做的更改第二个 repo 中的项目。

我看过`git submodules`但我认为这对我没有帮助，因为我不想将共享项目从第一个 git repo 提取到单独的项目中。我想保持第一个回购完好无损......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T20:11:56.673

我认为您可能对`git`存储库的结构感到困惑。我构建项目的方式是为每个项目创建一个存储库，然后将它们添加到`Repo 1`超级`Repo 2`项目中。

**以图形方式**

```
Git                  # Main git project directory
  /Projects
    /Project_1       # Each one is its own Git repository
    /Project_2
    /Project_3
    /Project_4
    /Project_5

  /Repos             # The main repositories that utilize the projects
    /Repo_1          # The super project directory
      .gitmodules    # The .gitmodules file created by 'git submodules add'
        --> submodule with url=../../Projects/Project_1  # entry in .gitmodules
        --> submodule with url=../../Projects/Project_2
        --> submodule with url=../../Projects/Project_3
    /Repo_2
      .gitmodules
        --> submodule with url=../../Projects/Project_1
        --> submodule with url=../../Projects/Project_4
        --> submodule with url=../../Projects/Project_5 
```

由于`submodule`url`Project_1`指向相同的位置，当您`git push`在其中一个`submodule`目录中时，`Repo_1`或者`Repo_2`您实际上将更改推送到同一个项目存储库。

关于在两个超级项目之间同步更改存在一些问题，因为`git`允许`submodule`两个不同超级存储库中的相同更改指向不同的修订。有关更多信息（例如如何推送、提交更改和更新`submodules`），我建议您查看：

1.  [http://speirs.org/blog/2009/5/11/understanding-git-submodules.html](http://speirs.org/blog/2009/5/11/understanding-git-submodules.html)
2.  [http://git-scm.com/book/ch6-6.html](http://git-scm.com/book/ch6-6.html)

# c# - 从中提取内容 标记 C# 正则表达式

> ID：11017583
> 
> 赞同：1
> 
> 时间：2012-06-13T14:52:29.143
> 
> 标签：c#, regex, parsing, html

我有代码`

```
string tag = "div";
string pattern = string.Format(@"\<{0}.*?\>(?<tegData>.+?)\<\/{0}\>", tag.Trim());
Regex regex = new Regex(pattern, RegexOptions.ExplicitCapture);
MatchCollection matches = regex.Matches(data); 
```

`

我需要在`<div class="in"> .... </div>`标签之间获取内容

```
 <div class="in">
        <a href="/a/show/7184569" class="mm">ВАЗ 2121</a> <span class="for">за</span>    <span class="price">2 700 $</span></span><br/><span class="year">1990 г.</span><br/><div style="margin: 3px 0 3px 0">1.6 л, бензин, КПП механика, с пробегом, белый, литые диски, тонировка, спойлер, ветровики, противотуманки, Движок после капитального ремонта!</div><div>
     <span style="display:block; padding: 4px 0 0 0;"><span class="region">Костанай</span><span class="adv-phones">, +7 (777) 4464451</span></span>

            <small class="gray air">24 просмотра</small>

            <small class="gray air">13 июня</small>
    </div>
    <div class="selectItem" title="Выбрать" id="fv_sic_7184569">
        <a href="#" class="fav-button" id="fav_7184569">&nbsp;</a>           </div>
</div> 
```

我该怎么做？我的代码不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:01:50.273

这是一个可以提取简单 div 标签的正则表达式：

```
// <div[^>]*>(.+?)</div>

string tag = "div";
string pattern = string.Format(@"<{0}[^>]*>(?<tegData>.+?)</{0}>", tag.Trim()); 
```

但是，使用 RegEx 进行 HTML 解析几乎总是不合适的，并且保证无法正常工作。这仅仅是因为 HTML 等标记语言不是常规语言。

话虽如此，您最好使用 XML 解析器来解析文档或片段，然后提取您需要的内容。事实上，使用只进解析器可能甚至比尝试使用 RegEx 更快。

您应该查看[.NET 中的 XmlReader 类](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:32:55.793

如果它不必是服务器端，您可以使用一些 JavaScript 来实现这一点。如：

```
 <script language="javascript">
     function getData(){
          var divs = document.getElementByTagName('div');
          var data;
          var x;
          for(x = 0; x < divs.length; x++)
          {
            if(divs[x].className == 'in') 
            {
                data = divs[x].innerHTML;
            }
          }
     }
 </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-14T15:35:27.447

要获取嵌套标签，请尝试使用此功能：

```
public static MatchCollection ParseTag(string str, string tagpat, string argpat, string valpat) {
    if (null == tagpat) argpat = @"\w+";
    if (null == argpat) argpat = @"[^>]*";
    if (null == valpat) valpat = @"(?><\k'tag'\b[^>]*>(?'nst')|</\k'tag'>(?'-nst')|.?)*?(?(nst)(?!))";
    return Regex.Matches(str, @"(?><(?'tag'" + tagpat + @"\b)\s*(?'arg'" + argpat + @")>)(?'val'" + valpat + @")</\k'tag'>",
        RegexOptions.IgnoreCase | RegexOptions.Singleline);
} 
```

参数是用于过滤目标标签的简单正则表达式，以下是示例：

```
ParseTag(page, "div", @"id=""content""\s+class=""mw-body""", null);
ParseTag(wikipage, "span", @"class=""bday""", @"\d{4}-\d{2}-\d{2}"); 
```

此变体处理相同类型的开始和结束标记以及嵌套标记（其他嵌套标记可以被破坏和忽略）。

另一个变体更严格地检查嵌套标签，如果其中一些标签被错误打开或关闭，则不匹配：

```
if (null == valpat) valpat = @"(?><(?'itag'\w+)\b[^>]*>(?'nst')|</\k'itag'>(?'-nst')|.?)*?(?(nst)(?!))"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-19T20:28:55.743

使用 XPath 对我来说更容易。也许你会发现它很有用。

```
textBox2.Text = "<div style=\"padding: 5px; width: 212px\"><div>more text</div></div>";
string x = "//div[contains(@style,'padding: 5px; width: 212px;')]";
XmlDocument doc = new XmlDocument();
doc.LoadXml(textBox2.Text);

XmlNodeList nodes = doc.SelectNodes(textBox1.Text);
foreach(XmlNode node in nodes)
{
    textBox3.Text = node.InnerXml;
} 
```

对我来说适用于 RegEx 的代码会找到第一个内部 div。

```
string r = @"<div style=""padding: 5px; width: 212px;";
Regex rg = new Regex(r);

var matches = rg.Matches(s);
if (matches.Count > 0)
{
foreach (Match m in matches)
{
textBox3.Text += m.Groups[1];
}
} 
```

# java - 如何在 java 中对 ANTLR 解析器进行多线程处理

> ID：11017584
> 
> 赞同：0
> 
> 时间：2012-06-13T14:52:44.040
> 
> 标签：java, multithreading, parsing, antlr, filereader

我的程序在读取文件然后用 antlr 语法解析它时被证明很慢。为了提高性能，我想多线程解析？

阅读文件：

```
 LogParser pa = new LogParser();
    LogData logrow;
    String inputLine;
    int a=0;
    try {
        //feed line by line
        FileReader fr = new FileReader(jFileChooser1.getSelectedFile());
        BufferedReader reader = new BufferedReader(fr);
        while ((inputLine = reader.readLine()) != null)
        {
            try {
                a++;
                jProgressBar.setValue(a);
                pa.parse(inputLine);  //decode the line
            } catch ... catches errors and send to logger
            } finally {

                logrow=new LogData(pa,a);
                mLogTable.addRow(logrow);//store the decoded line
            }

        } 
        reader.close();
    } catch ... catches errors and send to logger 
```

该代码解析`pa.parse(inputLine);`将输入行发送到 an`ANTLRStringStream`然后是 a 的行，然后`CharStream`再进行解析。接下来`logrow=new LogData(pa,a);`获取将存储在我的表中的解码值。

我的分析显示热点位于根据我的语法构建的词法分析器和解析器类中（即 LogGrammarLexer 和 LogGrammarParser）。希望它足够清楚......

解析：

```
LogGrammarLexer lexer = new LogGrammarLexer(inStream);
CommonTokenStream tokens = new CommonTokenStream(lexer);
decoded = new LogGrammarParser(tokens);
try {
    failurePosition="";
    decoded.logLine();
} catch (RecognitionException e) {
    failurePosition=Integer.toString(e.charPositionInLine);
} catch (Exception e) {
  failurePosition="-3";
  throw e;
} finally {
    return decoded;//TODO: see if return is necessary as decoded is now a field in class
} 
```

此外，我一直在阅读，现在知道多线程文件 I/O 是无用的......无论如何，这是我的语法在构建类中的性能，对我的文件中的每一行进行复杂的解码/解析，我需要改进.

所以我的问题是如何使它成为多线程的，

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:58:31.940

如果每个文件行是一个单独的可解析实体，那么您可以有多个线程，如下所示：

*   一个线程（很可能是主线程）从文件中读取行并将结果存储在工作队列中
*   一个线程池，每个线程将从前面提到的工作队列中提取一个文件行并解析数据
*   线程之间共享的文件行队列必须同步

如果在多核 CPU 上运行，这只会提高性能。

此外，这仅在每个文件行都是前面提到的单独的可解析实体时才有效。如果可解析实体的概念跨越多行，或者是整个文件，那么线程将无济于事。此外，如果文件中行的顺序很重要，那么多线程可能会导致问题，因为这些行可能会被乱序解析。

这是一个标准的生产者/消费者问题，这里有一些有用的链接：

*   [Java 线程池](http://docs.oracle.com/javase/tutorial/essential/concurrency/pools.html)
*   [线程池和工作队列](http://www.ibm.com/developerworks/library/j-jtp0730/)
*   [ThreadpoolExecutor 编程示例](http://programmingexamples.wikidot.com/threadpoolexecutor)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T20:44:22.030

看起来您可以简单地将输入文件分成几个，然后将它们导入并行线程。

# r - 带有 geom="path" 和 alpha 选项的 ggplot2 图例

> ID：11017588
> 
> 赞同：3
> 
> 时间：2012-06-13T14:52:57.397
> 
> 标签：r, ggplot2, alpha, legend

我从很久以前就是一个 R 用户，但我很难理解 ggplot2。在此示例中，当我将 geom="path" 选项也与 alpha 设置一起使用时，我无法获得图例。如果我设置 geom="point" 它看起来很好。

```
tmp <- data.frame(cx=rnorm(21),cy=rnorm(21),labels=c(rep("a",7),rep("b",7),rep("c",7)))

p1 <- qplot(data=tmp,cx,cy,geom="point",colour = labels, size=I(5), alpha=I(0.5)) 
```

然后点的图看起来很好，包括一个显示点的正确 alpha 设置的图例。添加 geom="path"

```
p2 <- qplot(data=tmp,cx,cy,geom="path",colour = labels, size=I(5), alpha=I(0.5)) 
```

让我得到一个图，其中线条连接并正确绘制了 alpha 设置，图例也出现但为空白 - 例如。没有阿尔法颜色。

这可能吗？

通过去掉 alpha 参数，这一切都很好，我在情节和图例中都得到了纯色。

更新：到目前为止，感谢您的评论，但我想这只是我或我的设置，因为我仍然有这个问题。我在链接中得到的一个例子......

![例子](../Images/6567f8c0b6fdca6ca2f1e5a1fd31d825.png)

[http://i.stack.imgur.com/LiEwD.jpg](https://i.stack.imgur.com/LiEwD.jpg)

为了完整性...

```
> sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: i386-pc-mingw32/i386 (32-bit)
locale:
[1] LC_COLLATE=English_United Kingdom.1252  LC_CTYPE=English_United Kingdom.1252       LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C                            LC_TIME=English_United Kingdom.1252    
attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods   base     
other attached packages:
[1] scales_0.2.1  ggplot2_0.9.1
loaded via a namespace (and not attached):
[1] colorspace_1.1-1   dichromat_1.2-4    digest_0.5.2       labeling_0.1       MASS_7.3-17        memoise_0.1       
[7] munsell_0.3        plyr_1.7.1         proto_0.3-9.2      RColorBrewer_1.0-5 reshape2_1.2.1     stringr_0.6       
[13] tools_2.15.0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T18:22:05.150

我终于能够重现你所看到的，但只是在非常特定的情况下（而且我碰巧偶然发现了它）。鉴于这种情况，我很确定在 Windows 上（或者更确切地说，使用 Windows 设备驱动程序）是必要的。

使用`tmp`, `p1`,`p2`从问题：

```
dev.new()
p1
p2 
```

这`dev.new()`很重要，因此您可以从一个新窗口开始（因为稍后会损坏某些内容）。这些命令给出了适当的绘图（不要对绘图窗口做任何事情）。现在，如果此时您“滚动”（历史 -> 上一个或下一个）或调整窗口大小，则图例框中不会绘制任何内容。在这样做之前，可以保存并获得正确的图例。之后，保存（文件->另存为...），图例框为空白。如果您使用“滚动”选项（我使用鼠标滚轮获得它，反复向下滚动，因为默认情况下我没有录制，因此上一个和下一个选项是灰色的），我（最终）得到以下在控制台上：

```
Error: VECTOR_ELT() can only be applied to a 'list', not a 'character' 
```

在我最终得到之前可以重复几次：

```
Error: REAL() can only be applied to a 'numeric', not a 'character' 
```

一种解决方法是使用`ggsave`. 由于这会创建一个新设备，因此您不必担心 windows 设备会进入某些损坏状态。

```
ggsave("tmp.jpg", p2) 
```

我认为我看到的行为是 Windows 图形设备中的错误。

# qvariant - 如何访问作为 QVariantMap 值的数组？

> ID：11017595
> 
> 赞同：2
> 
> 时间：2012-06-13T14:53:12.193
> 
> 标签：qvariant

我有一个 QVariantMap，它的键是一个字符串，值是一个数组（整数或字符串）

如何获取数组的各个元素？

map["key"] 有一个 toList() 方法。我可以将其应用于数组吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T06:57:02.497

Yes,

```
QString first_string_of_key = QVariantMap["key"].toList()[0]; 
```

but this is only for reading. Any attempt to write will not work because QVariant will return a copy of the list. Read this post: [Assigning to nested QVariantMap](https://stackoverflow.com/questions/11090846/assigning-to-nested-qvariantmap)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-01T16:09:35.273

如果我们说我们有一个`it`围绕键移动的迭代器，也许你可以试试这个：

我们可以说

```
if(it.value("key").type()==QMetaType::ByteArray)
  std::vector<std::string> vs_array_valus(QVariantMap["key"].value().toArray()); 
```

或直接使用如下：

```
if(QVariantMap["key"].value().type()==QMetaType::ByteArray)
std::vector<std::string> vs_array_valus(QVariantMap["key"].value().toArray()); 
```

希望这会有所帮助。

# java - Htop 显示具有不同 pid 的多个 java 进程

> ID：11017597
> 
> 赞同：75
> 
> 时间：2012-06-13T14:53:14.190
> 
> 标签：java, process, jvm, htop

启动一个 java 程序/JVM 后，我的 linux 机器上的 Htop 显示了许多“进程”。我确实了解 JVM 运行多个线程（用于实际程序、垃圾收集等）。

但是为什么 htop 将它们列为具有不同 pid 的多个进程。这些过程究竟是什么？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-10-19T16:51:43.283

实际上，只是 htop 默认情况下将每个线程显示为一个单独的进程。您可以将该行添加`hide_userland_threads=1`到`~/.config/htop/htoprc`文件中以仅显示一行。

请参阅[https://unix.stackexchange.com/questions/10362/why-does-htop-show-more-process-than-ps](https://unix.stackexchange.com/questions/10362/why-does-htop-show-more-process-than-ps)

# java - 显示黑色区域的地图视图

> ID：11017600
> 
> 赞同：2
> 
> 时间：2012-06-13T14:53:27.637
> 
> 标签：java, android, android-mapview

我制作了一个`MapView`带有地理点的地图正在加载黑色方块，如图所示对解决方案有什么想法吗？

![地图视图](../Images/ff355437c2f3ddabcf077e0a083a8f46.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:02:58.760

我在有这个集合时看到了类似的事情：

`gMapView.setStreetView(true);`

将其设置为 false 会删除这些区域。

# javascript - 自 2012 年 6 月 12 日以来，我网站上 1% 的请求网址中随机附加了“未定义”

> ID：11017609
> 
> 赞同：80
> 
> 时间：2012-06-13T14:53:52.790
> 
> 标签：javascript, browser

自 2012 年 6 月 12 日 11:20 TU 以来，我在 varnish/apache 日志中看到了非常奇怪的错误。

有时，当用户请求一个页面时，几秒钟后我会看到一个类似的请求，但 url 中最后一个 / 之后的所有字符串已被“undefined”替换。

示例： **[http](http://example.com/foo/bar)** ://example.com/foo/bar触发**[http://example.com/foo/undefined](http://example.com/foo/undefined)**请求。

当然这些“未定义”页面不存在，而是返回了我的 404 页面（这是具有标准布局的自定义页面，而不是经典的 apache 404）

*   任何页面都会发生这种情况（从主页到最深处）
*   使用各种浏览器（主要是 Chrome 19，还有 firefox 3.5 到 12、IE 8/9...），但只有 1% 的流量。
*   这些请求发送的标头是经典标头（并且没有 ajax 标头）。
*   对于给定的 ip，这似乎是随机发生的：有时在访问的第一页上，有时在访问期间的随机页面上，有时在访问期间的几个页面上......

当然，这看起来像是一个 javascript 问题（我使用的是 google 托管的 jquery 1.7.2），但几天以来我**的 js/html 或服务器配置完全没有任何变化**，而且我之前从未见过这种错误. 当然，在 html 中没有这样的链接。

我还注意到一些有趣的事实：

*   未定义的请求永远不会被找到作为其他页面的引用者，而是将“真实”页面用作相同 IP 的以下请求的引用者（用户可以使用 404 页面上的经典菜单）
*   我在 Google Analytics 中没有看到这些页面的任何痕迹，所以我假设没有执行任何 javascript（跟踪器存在于所有页面上，包括 404）
*   没有人就此联系过我们，即使我在网站的社交网络中提到了这个问题
*   大多数用户在那之后继续访问

所有这些事实让我认为问题是在浏览器中悄悄发生的，可能是由昨天更新的浏览器中集成的错误插件、防病毒、浏览器栏或糟糕的制造商软件触发的（但我没有发现任何已发布的插件昨天为 chrome、firefox 和 IE）。

这里有没有人注意到同样的问题，或者有更完整的解释？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-20T21:32:56.390

没有简单直接的答案。

您将不得不对此进行调试，并且由于 URL 中的“未定义”字样，它可能是 JavaScript。然而，它不一定是 AJAX，它可以是 JavaScript 创建由浏览器自动解析的任何 URL（例如，在图像标签上设置 src 属性、设置 css-image 属性等的 JavaScript）。我大部分时间都使用安装了[Firebug的](http://www.mozilla.org/en-US/firefox/new/)[Firefox](http://www.mozilla.org/en-US/firefox/new/)，所以我的方向将牢记这一点。

**Firebug 初始设置**

*如果您已经知道如何使用 Firebug，请跳过此步骤。*

在安装并重新启动 Firefox for Firebug 之后，您将不得不启用大部分 Firebug 的“面板”。要打开 Firebug，您的浏览器右上角会出现一个看起来像火虫/昆虫的小东西，或者您可以按 F12。单击 Firebug 选项卡“控制台”、“脚本”、“网络”并通过打开它们并阅读面板信息来启用它们。您可能需要刷新页面才能使它们正常工作。

**调试用户交互**

导航到打开 Firebug 且“网络”面板处于活动状态时出现问题的页面之一。在 Net 面板中会有几个选项：“Clear”、“Persist”、“All”、“Html”等。确保选择 ALL。不要在页面上做任何事情，尽量不要将鼠标悬停在上面的任何内容上。浏览请求。对无效 URL 的请求将显示为红色，并且状态可能为 404 Not Found（或类似）。

加载时看到了吗？跳到下一部分。

在初始加载时看不到它？开始使用您的页面并在此处继续。

开始单击每个功能，将鼠标悬停在所有内容上，等等。注意网络面板并注意失败的请求。您可能必须要有创意，但要继续使用您的应用程序，直到您看到浏览器发出无效请求。如果页面发出许多请求，请随意点击网络面板左上角的“清除”按钮将其清除一下。

如果您提交页面并看到失败的请求很快就消失了，但由于下一页加载而丢失了它，请通过单击“网络”面板左上角的“持久”来启用持久性。

一旦它发生了，它应该考虑你做了什么来实现它。看看你能不能让它再次发生。在弄清楚是什么用户交互导致它发生后，深入研究该代码并开始寻找发出无效请求的事物。

您可以使用“脚本”选项卡在 JavaScript 中设置断点并单步执行它们。调查通过 $(element).bind/click/focus/etc 或从老派事件属性（如 onclick=""/onfocus="" 等）完成的事件处理程序。

**如果请求在页面加载后立即发生**

这将是一个有点难以钉住。您需要转到“脚本”选项卡并开始为每个在加载时运行的脚本添加断点。您可以通过单击 JavaScript 行的左侧来执行此操作。

重新加载你的页面，你的断点应该会阻止浏览器加载页面。按脚本面板上的“继续”按钮。转到您的网络面板，看看您的请求是否已提出，继续直到找到。您可以使用它来缩小发出请求的范围，方法是慢慢添加越来越多的断点，然后步入和退出函数。

**你在你的代码中寻找什么**

类似于以下内容：

```
var url = workingUrl + someObject['someProperty'];

var url = workingUrl + someObject.someProperty; 
```

请记住， someObject 可能是 object `{}`、 array`[]`或任何内部浏览器类型。关键是将访问一个不存在的属性。

**我没有看到任何 404/红色请求**

然后，无论是什么原因，您的测试都不会触发它。尝试使用更多的东西。关键是您应该能够以某种方式使请求发生。你只是还不知道。它必须显示在网络面板中。唯一不会发生的情况是当你没有做任何触发它的事情时。

**结论**

没有超级简单的方法可以确定到底发生了什么。但是，使用我概述的方法，您至少应该能够接近。这可能是你甚至没有考虑过的事情。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-01-05T17:34:00.977

根据这篇[文章](http://productforums.google.com/d/msg/chrome/G1snYHaHSOc/p8RLCohxz2kJ)，我对“Complitly”Chrome 插件/恶意软件进行了逆向工程，发现此扩展程序正在注入“改进的自动完成”功能，该功能在每个输入文本字段为 NAME 或“搜索”、“q”和许多其他的 ID。

我还发现 enable.js 文件（complitly 文件之一）正在检查一个名为“suggestmeyes_loaded”的全局变量，以查看它是否已经加载（如 Singleton）。因此，将此变量设置为 false 会禁用插件。

要禁用恶意软件并停止“未定义”请求，请将其应用于您网站上具有搜索字段的每个页面：

```
<script type="text/javascript">
    window.suggestmeyes_loaded = true;
</script> 
```

此恶意软件还会将您的用户重定向到“searchcompletion.com”网站，有时会显示竞争对手的 ADS。所以，应该认真对待。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-20T09:23:34.753

您已正确确定这与`undefined`JavaScript 问题有关，并且如果您的站点用户没有抱怨看到错误页面，您可以检查以下内容。

> 如果 JavaScript 用于设置或更改图像位置，则有时会发生 an`undefined`进入 URI 的情况。

发生这种情况时，浏览器会很高兴地尝试加载图像（没有 AJAX 标头），但它会留下提示：它设置了一个特定的`Accept:`标头；而不是`text/html, text/xml, ...`它将使用`image/jpeg, image/png, ...`.

确认此类标题后，您已将问题范围缩小到仅图像。找到根本原因可能需要一些时间:)

**更新**

`$.fn.attr()`为了帮助调试，您可以在将某些内容分配给未定义时覆盖并调用调试器。像这样的东西：

```
​(function($, undefined) {
    var $attr = $.fn.attr;

    $.fn.attr = function(attributeName, value) {
        var v = attributeName === 'src' ? value : attributeName.src;

        if (v === 'undefined') {
            alert("Setting src to undefined");
        }

        return $attr(attributeName, value);
    }
}(jQuery)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-20T13:12:47.343

已经确定的一些事实，尤其是在这个线程中：[http ://productforums.google.com/forum/#!msg/chrome/G1snYHaHSOc/p8RLCohxz2kJ](http://productforums.google.com/forum/#!msg/chrome/G1snYHaHSOc/p8RLCohxz2kJ)

它发生在根本没有 javascript 的页面上。这证明它不是页面编程错误

用户没有意识到这个问题并继续愉快地浏览。

它发生在该人访问该页面几秒钟后。

它不会发生在每个人身上。

发生在多个浏览器（Chrome、IE、Firefox、Mobile Safari、Opera）上

发生在多个操作系统（Linux、Android、NT）上

发生在多个 Web 服务器（IIS、Nginx、Apache）上

我有一个 googlebot 跟踪链接并声称相同的引荐来源的案例。他们可能只是想变得聪明，浏览器将其传达给母舰，然后母舰设置机器人进行调查。

我相当确信它是由插件引起的。Complitly 是其中之一，但它不支持 Opera。还有很多其他的。

尽管移动浏览器不利于插件理论。

系统管理员报告说，通过在页面上添加一些 javascript 来欺骗 Complitly 认为它已经初始化，从而导致严重下降。

这是我对 nginx 的解决方案：

```
location ~ undefined/?$  {
  return 204;
} 
```

这将返回“是的，但没有内容适合您”。

如果您在 website.com/some/page 上并且（以某种方式）导航到 website.com/some/page/undefined 浏览器将显示 URL 已更改，但甚至不会重新加载页面。前一页将保持在窗口中的状态。

如果由于某种原因这是用户所经历的事情，那么他们将获得干净的 noop 体验，并且不会打扰他们正在做的任何事情。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-23T09:20:59.773

这听起来像是一种竞争条件，其中变量在使用之前没有正确初始化。根据您的评论，考虑到这不是 AJAX 问题，下面列出了几种解决方法。

**连接 Javascript 异常记录器**：这将帮助您在日志中捕获几乎所有随机 javascript 异常。大多数时候，程序错误会在这里冒泡。把它放在任何脚本之前。您需要在服务器上捕获这些并将它们打印到您的日志中以便稍后进行分析。这是你的第一道防线。这是一个例子：

```
window.onerror = function(m,f,l) {
    var e = window.encodeURIComponent;
    new Image().src = "/jslog?msg=" + e(m) + "&filename=" + e(f) + "&line=" + e(l) + "&url=" + e(window.location.href);
}; 
```

**搜索 window.location**：对于这些实例中的每一个，您应该将日志记录或检查未定义的 concats/appenders 到您的 window.location。例如：

```
function myCode(loc) {
    // window.location.href = loc; // old 
    typeof loc === 'undefined' && window.onerror(...); //new
    window.location.href = loc; //new
} 
```

或稍微清洁：

```
window.setLocation = function(url) { 
   /undefined/.test(url) ? 
         window.onerror(...) : window.location.href = url;       
}

function myCode(loc) {
    //window.location.href = loc; //old
    window.setLocation(loc); //new
} 
```

如果您有兴趣在此阶段获取堆栈跟踪，请查看：[https ://github.com/eriwen/javascript-stacktrace](https://github.com/eriwen/javascript-stacktrace)

**抓取所有未处理的未定义链接**：除了 window.location 唯一剩下的就是 DOM 链接本身。第三步是检查所有未处理的 DOM 链接是否存在无效的 URL 模式（您可以在 jQuery 完成加载后立即附加此链接，越早越好）：

```
$("body").on("click", "a[href$='undefined']", function() {
    window.onerror('Bad link: ' + $(this).html()); //alert home base
}); 
```

希望这会有所帮助。调试愉快。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-14T16:16:46.510

我想知道这是否可能是一个广告拦截器问题。当我按 IP 地址搜索日志时，似乎特定用户对 /folder/page.html 的每个请求都后跟对 /folder/undefined 的请求

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-06T06:53:37.663

我不知道这是否有帮助，但我的网站在将一个特定的 *.webp 图像文件加载到多个浏览器中后将其替换为 undefined。您的网站是否托管 webp 图片？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-05T13:59:42.650

我有一个类似的问题（但`/null`在控制台中有 404 错误）@andrew-martinez 的回答帮助我解决了。

原来我使用的是`img`带有空`src`字段的标签：

`<img src="" alt="My image" data-src="/images/my-image.jpg">`

我的想法是通过使用javascript（延迟加载）从data-src属性设置src属性来防止浏览器在页面加载时加载图像以便稍后手动加载。但是当与 iDangerous Swiper 结合使用时，该方法会导致错误。

# php - 链接回主记录的多个提交按钮

> ID：11017611
> 
> 赞同：0
> 
> 时间：2012-06-13T14:54:02.183
> 
> 标签：php, form-submit

我想知道是否有人可以帮助我。

首先，这是我以前从未解决过的问题，所以如果这对经验更丰富的开发人员来说是直截了当的，请多多包涵。

下面的代码是正确显示每个用户的“位置列表”的脚本的一部分。

```
 $i=0;
                    while ($i < $num) {
                        $lid=mysql_result($result,$i,"locationid");
                        $lname=mysql_result($result,$i,"locationname");
                        $laddress=mysql_result($result,$i,"returnedaddress");

                        include("admin/link.php");
                        include("admin/opendb.php");
                        $fquery = "SELECT COUNT(*) num FROM finds WHERE locationid = '$lid'";
                        $fcount = mysql_query($fquery) or die('error');
                        $row = mysql_fetch_assoc($fcount);
                        $findscount = $row['num'];
                        mysql_close($connect);  
                        ?>

                        <table width="603" border="0">
                      <tr>
                        <th width="156">Location</th>
                        <th width="302">Address</th>
                        <th width="131">No. Of Finds Made</th>
                      </tr>
                      <tr>
                        <td><?php echo $lname;?></td>
                        <td><?php echo $laddress;?></td>
                        <td><?php echo $findscount;?></td>
                      </tr>
                        </table>

                        <?php
                        echo'<form name="locations" method="post">';

                                    $i++;
                    }
                    if ($num == 0) {
                        echo"<tr>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                            </tr>
                            <tr>
                              <td>&nbsp;</td>
                              <td colspan='3'><div align='center'><strong>No locations have been added yet. <a href='saveaddress.php'>Click here</a> to add one.</strong></div></td>
                              <td>&nbsp;</td>
                            </tr>
                            <tr>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                              <td>&nbsp;</td>
                            </tr>";
                    }

                            echo '<input type="submit" name="submitlocation" id="submitlocation" value="View/Amend Location Details">';

                            echo '<input type="submit" name="submitfinds" id="submitaddfinds" value="Add Finds">';
                            echo '</div>'."\n";
                            if(isset($_POST["submitlocation"])) {
                                  header("updatelocation.php");

                              }
                              else if(isset($_POST["submitaddfinds"])) {
                                  header("addfinds.php");

                            }
                            ?> 
```

我要做的是为每个 Location 记录添加两个提交按钮，一个将用户带到一个名为的页面`updatelocation.php`，第二个将用户带到一个名为`addfinds.php`. 但两者都**必须**通过“locationid”字段链接到位置。所以换句话说，如果用户想要`Add Finds`在`Location 1`点击相关按钮时，他们会被带到`Add Finds`位置 1 的页面。

我已经阅读了许多教程，但我显然误解了某些地方，因为虽然我已经设法将按钮添加到记录中，但是当我单击任一按钮时，“位置列表被刷新，而不是用户正在带到相应的页面。

我只是想知道是否有人可以看看这个，让我知道我哪里出错了？

非常感谢和亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:01:57.043

您最好制作一个单独的页面（即，forrmaction.php）来处理逻辑并将用户发送到正确的页面。如果您不想这样做，您还可以为每个按钮制作一个单独的表单，只需将`action`属性设置`form`为指向 updatelocation.php 或 addfinds.php

**formaction.php**示例：

```
if (isset($_POST['type']) {
    if ($_POST['type'] == 'update')
        $url = 'updatelocation.php';
    else
        $url = 'addthis.php';

    header("Location: " . $url);
} 
```

**与 formaction.php 一起使用的带有两个按钮**的表单示例：

 **```
<form name="locations" method="POST" action="formaction.php">
     <input type="submit" name="type" value="update">
     <input type="submit" name="type" value="add">
</form> 
```

* * *

但是，对于您的问题，问题在于您没有使用正确的标题。要使用重定向，您必须在标题中使用“位置：”。例如，

```
header("Location: updatelocation.php"); 
```

小心，因为如果标头已经发送，这将不起作用。在这种情况下，您可能需要查看[输出控制](http://php.net/manual/en/book.outcontrol.php)。**

# jquery - 无法在 Jquery 中进行电子邮件验证

> ID：11017612
> 
> 赞同：1
> 
> 时间：2012-06-13T14:54:09.157
> 
> 标签：jquery, html, validation, email

嘿，伙计们，我的 jQuery 有点问题，我的所有输入验证都在工作，但我无法让我的 REGEX 代码工作来验证我的电子邮件。尝试输入“hello@mywebsite.co.uk”我的个人电子邮件和我的工作电子邮件，但它们都不起作用。

任何帮助都是高度赞赏的。

```
var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
  $('.submitbutton').click(function () {
    if ($("input.name").val() == '') {
        alert("Name is a required field");
        return false;
    }
    else if ($("input.email").val() == '') {
        alert("Email is a required field");
        return false;
    }
    else if (!regex.test("input.email")) {
        alert("This is not a valid email address");
        return false;
    }
    else if ($("textarea.message").val() == '') {
        alert("Message is a required field");
        return false;
    }
    else {
        return true;
    }
}); 
```

干杯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T14:56:27.030

在`regex.test("input.email")`中，您正在测试实际字符串`"input.email"`是否与正则表达式匹配。相反，您应该测试元素的*值*。`input.email`

所以使用：

```
regex.test($("input.email").val()) 
```

# drools - Drools Planner 中的实时规则创建

> ID：11017613
> 
> 赞同：1
> 
> 时间：2012-06-13T14:54:10.297
> 
> 标签：drools, drools-planner

我有兴趣为 Drools Planner 创建规则。我希望用户可以在启动 Drools Planner 之前在 java 应用程序中创建自己的规则。也许在用户添加他的规则之后可以生成一个 Drools-rule-file。*这可能吗，还是我必须在开发整个 Java 应用程序时创建规则文件？*

非常感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:22:27.597

是的，这是可能的。诀窍是构建您自己的`RuleBase`并将其设置在 Planner 配置中。 [请参阅手册中的“5.3.4.2.2\. RuleBase（可能由 Guvnor 定义）”部分。](http://docs.jboss.org/drools/release/5.4.0.Final/drools-planner-docs/html_single/index.html#d0e3440)

`RuleBase`根据您希望用户如何编辑他/她的规则，您可以构建多个：

*   来自 DRL 文件。这假定用户知道 DRL。请参阅 Drools 专家手册。
*   来自 DSL 文件。这允许您使用自然语言。
*   **来自 guvnor webapp**。这使您可以使用工具 Guvnor，例如引导规则编辑器、决策表电子表格……您甚至可以使用变更集。
*   来自 eclipse 中的 guvnor 或独立应用程序（正在开发和实验中）。在这个领域有一些工作，但它还很年轻。

# iphone - 可以在 Windows 中使用 CreateFile 以编程方式从 iPhone 读取图像吗？

> ID：11017615
> 
> 赞同：5
> 
> 时间：2012-06-13T14:54:14.503
> 
> 标签：iphone, windows, winapi, filesystems, createfile

当 iPhone 连接到 Win7 计算机时，可以使用资源管理器（以及我的应用程序的打开文件对话框）查看图像。但是，文件位置不包含驱动器号。

例如，sdcard、usb 驱动器等`Computer\Apple iPhone\Internal Storage\DCIM\800AAAAA\IMG_0008.JPG`不是`E:\DCIM\800AAAAA\IMG_0008.JPG`常见的...

我尝试使用 CreateFileW 从 iPhone 读取图像，但失败并显示“（错误代码：3）系统找不到指定的路径。” 我也试过用 Chrome 访问它们，但它也失败了。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:47:17.643

该文件夹实际上是所谓的“虚拟文件夹”，并且在文件系统上没有完整路径。您将需要使用从打开的对话框返回的 shell 项来获取文件的内容，而不是使用 CreateFile。

数据应该可以访问，但您应该按照[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776904%28v=vs.85%29.aspx)中的说明进行操作。我相信可能有更好的例子（因为这只是提供指导）。

**编辑**粗略的过程是从 IFileOpenDialog 获取 IShellItem，然后绑定到流，然后读取流（假设只读） - 请记住，此代码几乎没有错误处理或检查或安全性：

```
if (pitem->GetDisplayName(SIGDN_NORMALDISPLAY, &destName) == S_OK) {
    std::cout << destName << std::endl;
    CoTaskMemFree(destName);
}
IStream *pistream;
if (pitem->BindToHandler(0, BHID_Stream, IID_PPV_ARGS(&pistream)) == S_OK) {
    char input[1024];
    long to_read = 1024;
    unsigned long read;
    while (S_OK == pistream->Read(input, to_read, &read)) {
       std::cout << input << std::endl;
    }
    pistream->Release();
}
pitem->Release(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-28T22:34:18.043

大多数情况下，此类设备作为 Shell 命名空间扩展插入到 Windows 资源管理器中，而不像带有驱动器号的 USB 记忆棒。大多数普通的文件命令，如 CopyFile(..)、FindFirst() 或 GetFileInfo(..)**不能**直接在这样的 Shell 命名空间扩展中使用。只有在**`CopyHere(..)`**工作。我需要很长时间才能弄清楚如何枚举相机上的文件，现在还要在带有 vb.net 程序的 Android 设备上枚举文件，并将我的图片复制到我的 Windows PC：

```
Public Const MyComputer As Integer = &H11&

Sub EnumMyComputer()
  Dim oItem As Object
  Dim res As Integer

  For Each oItem In DirectCast(CreateObject("Shell.Application").Namespace(MyComputer).Items, System.Collections.IEnumerable)
    Debug.Print(oItem.Type.ToString)
    if oItem.Type.ToString="Tragbares Medienwiedergabegerät" then '<- check, adopt!
      res = EnumNamespaceItems(oItem, "", oItem.Name.ToString, 0)
    End If
  Next oItem
End Sub

Function EnumNamespaceItems(oItem As Object, SrcCPath As String, SrcDPath As String, folderLevel As Integer) As Integer
  Dim y As Object
  Dim tempFullFileName As String

  Debug.Print(StrDup(folderLevel, "  ") & "\" & oItem.Name.ToString & "  (" & oItem.Path.ToString & ")")
  For Each y In DirectCast(oItem.GetFolder.items, System.Collections.IEnumerable)
    'Debug.Print(StrDup(folderLevel, "  ") & SrcDPath & y.Name.ToString)
    If y.IsFolder = True Then
      Dim n1 As Integer
      n1 = EnumNamespaceItems(y, SrcCPath & y.Path.ToString & "\", SrcDPath & y.Name.ToString & "\", 1 + folderLevel)
      If n1 < 0 Then 'failure: Cancel
        EnumNamespaceItems = n1
        Exit Function
      End If
    Else 'it's a file:
      Debug.Print(StrDup(folderLevel, "  ") & " " & y.Name.ToString)
      tempFullFileName = System.IO.Path.GetTempPath() & y.Name.ToString
      ' CopyFile is not possible here if SrcCPath is like "::{…}…":
      ' My.Computer.FileSystem.CopyFile(SrcCPath & y.Name.ToString , fFile.FullName)
      Dim suc As Integer = CopyHereFileWait(y, My.Computer.FileSystem.SpecialDirectories.Temp)
      If suc >= 0 Then 'now we can do things like this:
        Dim MyFileInfo As System.IO.FileInfo = My.Computer.FileSystem.GetFileInfo(tempFullFileName)
        Dim fileDate As Date = MyFileInfo.LastWriteTime
      End If 'suc
    End If 'else y.IsFolder
  Next y
  EnumNamespaceItems = 0
End Function

Function CopyHereFileWait(sourceNamespaceObject As Object, targetFolder As String) As Integer
  Dim fsMyStream As System.IO.FileStream
  Dim n1 As Integer
  Dim taregetFullFileName As String

  n1 = Len(targetFolder)
  If Mid(targetFolder, n1, 1) = "\" Then
    targetFolder = Microsoft.VisualBasic.Left(targetFolder, n1 - 1)
  End If
  taregetFullFileName = targetFolder & "\" & sourceNamespaceObject.Name.ToString
  Dim oNsTargetFolder As Object
  oNsTargetFolder = CreateObject("Shell.Application").Namespace(CStr(targetFolder))
  oNsTargetFolder.copyHere(sourceNamespaceObject)
  'returns immediately and is doing the work in the background
  n1 = 0
  Do
    Threading.Thread.Sleep(50) 'ms
    Try
      fsMyStream = System.IO.File.Open(taregetFullFileName, IO.FileMode.Open, IO.FileAccess.ReadWrite)
      fsMyStream.Close()
      CopyHereFileWait = n1
      Exit Function
    Catch ex As Exception
      Debug.Print(ex.Message)
    End Try
    n1 = n1 + 1
  Loop While n1 < 400 'timeout 400*50ms = 20s
  CopyHereFileWait = -n1
End Function 
```

您可以添加以检查带有 y.Name.ToString="DCIM"（在 folderLevel=1 上）的文件夹和带有“.jpg”的文件。

# javascript - 在某些服务器上，许多外部资源（GA、fonts.com 字体等）出现“Uncaught SyntaxError: Unexpected token ILLEGAL”错误？

> ID：11017625
> 
> 赞同：0
> 
> 时间：2012-06-13T14:54:40.623
> 
> 标签：javascript

在我使用过的几台服务器上，我的许多（但不是全部）外部加载的资源出错并抛出（在 Chrome 中）“Uncaught SyntaxError: Unexpected token ILLEGAL”。

包括来自 googleapis CDN 的 jQuery 工作正常，但加载 fonts.com JavaScript 字体文件和加载基本的 Google Analytics 代码都出错了。

这是代码（如果有帮助，这里是一个[小提琴）：](http://jsfiddle.net/mstauffer/kZRbG/)

```
<html>
    <head>
        <title>fonttest</title>
        <script type="text/javascript" src="http://fast.fonts.com/jsapi/dd7c6b7d-1ecb-4ef4-bf65-c4759f97cbe3.js"></script>
        <script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script>
    </head>
    <body>
        <h2>This is a test of the emergency broadcast system.  This is only a test.  If this had been an actual emergency, the tones you just heard would have been followed by official news or instructions.</h2>
    </body>
</html> 
```

这些文件的标头以`text/javascript`.

最后，当我在 Web Inspector 的“资源”选项卡中查看资源时，我看到了一些非罗马字符，而不是这些文件的实际代码，这让我认为一定存在某种编码问题。我尝试将字符集设置为文档头`utf-8`和`iso-8859-1`文档头（使用`meta charset`），但都没有帮助。

![chrome错误截图](../Images/1998ddf21be1941804fae96a6ae2e1b3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T23:25:43.397

好吧，我想我已经解决了这个问题：我的主 HTML 页面（不是包含的脚本）在某些时候被编码为 UTF-16。我将其编码（不是使用`meta charset`，而是使用我的代码编辑器编辑文档本身的编码）改回默认值*Western (ISO Latin 1)*，我认为它与 iso-8859-1 相同。

我最好的猜测是，在某个时候，我将一些具有 UTF-16 编码的文件粘贴到该文件中，我的编辑器将文档的编码转换为 UTF-16，然后该站点假定它正在导入的外部资源也是 UTF-16，这导致它误解了他们。

如果有人遇到同样的问题，我会留下这个问题并回答。

# sql - 如何在字符模式结束后搜索字符串以查找数据（SQL DB2）

> ID：11017628
> 
> 赞同：1
> 
> 时间：2012-06-13T14:54:47.700
> 
> 标签：sql, db2

我需要找到在以下事件模式“5065|5373|5373”最后一次出现之后出现的下一个事件。我的问题是模式可以在字符串中出现 1 到 n 次。这是我必须搜索的一些数据的示例。

**BOLD**中的事件是我要寻找的。

5065|5373|5373|5065|5373|5373|5065|5373|5373| **5509** |5329|5321 5065|5373|5373|5065|5373|5373| **5509** |5270|5373|5373|5373|5080|5081|5013|5040|5295|5321 5065|5373|5373| **5295** |5323|5321

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T21:53:05.340

一种相当直接的方法是使用递归公用表表达式 (CTE)：

```
CREATE FUNCTION localutil.locatelastmatch(
       searchparm VARCHAR(4000), inputparm VARCHAR(4000)
)
RETURNS SMALLINT
LANGUAGE SQL
RETURN
WITH rcurs(counter, output ) AS (
    VALUES (0,0)
    UNION ALL
    SELECT counter+1, LOCATE(searchparm,inputparm,counter+1) 
       FROM rcurs
       WHERE counter < LENGTH(inputparm) AND counter < 32767
    )
SELECT MAX(output) FROM rcurs
; 
```

它可能不是找到最后一个匹配项的最便宜的方法，但它至少是它的竞争者。通过将复杂性隐藏到标量用户定义函数 (UDF) 中，您不必将 SQL 递归引入需要搜索模式的最后一个实例的每个查询中。

以下是它对您的示例字符串的作用：

```
WITH originput(val) as (VALUES
('5065|5373|5373|5065|5373|5373|5065|5373|5373|5509|5329|5321'),
('5065|5373|5373|5065|5373|5373|5509|5270|5373|5373|5373|5080|5081|5013|5040|5295|5321'),
('5065|5373|5373|5295|5323|5321')
)
SELECT LENGTH(val) AS inputlength, 
    localutil.locatelastmatch( '5065|5373|5373|', val ) AS finaloffset,
    SUBSTR(val, localutil.locatelastmatch( '5065|5373|5373|', val ) 
    + LENGTH( '5065|5373|5373|' ), 4) AS nextitem
FROM originput
;

INPUTLENGTH FINALOFFSET NEXTITEM
----------- ----------- --------
         59          31 5509
         84          16 5509
         29           1 5295 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T22:40:28.047

如果您无法创建新的存储过程或 UDF，这里有一个递归查询可以帮您完成：

```
WITH Recurs(id, index, token, source) as (
            SELECT id, LOCATE('5065|5373|5373|', M.PATH_2), '', M.PATH_2
            FROM M
            UNION ALL 
            SELECT id, LOCATE('5065|5373|5373|', source, index + 15), 
            SUBSTR(source, index + 15, 4), source
            FROM Recurs
            WHERE index > 0)
SELECT * 
FROM Recurs
WHERE index = 0 
```

这产生了预期的：

```
ID  INDEX   TOKEN  SOURCE 
3   0       5295   5065|5373|5373|5295|5323|5321     
2   0       5509   5065|5373|5373|5065|5373|5373|5509|5270|5373|5373|5373|5080|5081|5013|5040|5295|5321
1   0       5509   5065|5373|5373|5065|5373|5373|5065|5373|5373|5509|5329|5321 
```

# c# - 正确使用 asp.net webforms 生命周期

> ID：11017638
> 
> 赞同：2
> 
> 时间：2012-06-13T14:55:11.193
> 
> 标签：c#, asp.net, .net, web-parts

这确实是一个更普遍的问题，但我能想到的唯一方法是举一个具体的例子。

我们目前有一个带有`SPGridView`. 就像现在一样，在 中创建 GV 和所有绑定字段，在`CreateChildControls`中检索和绑定数据`OnPreRender`。这些列是静态的，因此可以正常工作。

```
CreateChildControls{
    // create and configure the gridview
    // create all bound fields and add them to the gridview
    // add the gridview to the page
}

OnPreRender{
    // get the data and bind it to the gridview
} 
```

现在我们需要将列更改为依赖于用户从下拉列表中所做的选择。在其中`CreateChildControls`我们无法从下拉控件中获取值，因此我们无法有条件地添加绑定字段。我的问题是，这里的最佳做法是什么？我们可以在 中创建所有可能的绑定字段`CreateChildControls`，然后只将适当的字段添加到 GV 中`OnPreRender`。我们可以将所有绑定字段的创建完全移动到`OnPreRender`. 还有很多其他的选择。

```
CreateChildControls{
    // create and configure the gridview
    // create ALL bound fields here?
    // add the gridview to the page
}

OnPreRender{
    // or maybe create only the applicable bound fields here?
    // add the appropriate fields to the gridview
    // get the data and bind it to the gridview
} 
```

从更一般的意义上说，什么真正构成了“创建”控件（的目的`CreateChildControls`）？这个问题确实延伸到任何可能具有动态内容的控件。将条目添加到下拉列表等的合适位置在哪里。有很多工作方式，但哪种方式是“正确的”？是否将选择添加到“创建”控件的下拉部分？它是否取决于选择是否是动态的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:03:50.450

`BoundField`不是控件，`Columns`gridview 中的集合是状态管理的，因此您可以在`PreRender`对控件进行数据绑定之前安全地在事件中添加列。

# iphone - 表视图中的 NSDictionary

> ID：11017639
> 
> 赞同：0
> 
> 时间：2012-06-13T14:55:14.597
> 
> 标签：iphone, objective-c, xcode, uitableview, nsdictionary

我有一个这种类型的 NSDictionary：

```
" **********" =     (
    "20110330 7Huge Sandstorm over niger",
    "20110330 8Huge Sandstorm over niger",
    "20110330 9CHuge Sandstorm over niger",
    "20110330 AHuge Sandstorm over niger",
    "20110330 B10CHuge Sandstorm over niger",
    "20110330 **CHuge Sandstorm over niger",
    ""
);
" 2012" =     (
    "20110330 Huge Sandstorm over niger",
    ""
);
" just for the test" =     (
    "20110330 AHuge Sandstorm over niger",
    "20110330 BHuge Sandstorm over niger",
    "20110330 CHuge Sandstorm over niger",
    "20110330 1Huge Sandstorm over niger",
    "20110330 2Huge Sandstorm over niger",
    "20110330 3Huge Sandstorm over niger",
    "20110330 4Huge Sandstorm over niger",
    "20110330 5CHuge Sandstorm over niger",
    "20110330 6Huge Sandstorm over niger",
    ""
); 
```

我想用“ ******* , 2012 , just for the test ”做一个 tableView 不同部分的标题。以及内容“20110330 7Huge Sandstorm over niger”、“20110330 8Huge Sandstorm over niger”、“20110330 9CHuge Sandstorm over niger......”每个部分。

请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:03:03.160

假设每个键中的子元素是 NSArrays，那么您可以只返回字典中键的数量作为节数，每个节的标题的实际键，然后为每个节中的行数返回该特定键下数组中的元素数

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return [myDictionary count];//returns the number of key/object pairs
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    NSArray *allKeys = [myDictionary allKeys];
    return [allKeys objectAtIndex:section];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSArray *allKeys = [myDictionary allKeys];
    NSString *curKey = [allKeys objectAtIndex:section];
    NSArray *curArray = [myDictionary objectForKey:curKey];

    return [curArray count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    //normal cell acquisition code

    NSArray *allKeys = [myDictionary allKeys];
    NSString *curKey = [allKeys objectAtIndex:indexPath.section];
    NSArray *curArray = [myDictionary objectForKey:curKey];
    NSString *curValue = [curArray objectAtIndex:indexPath.row];
    //Do something with the string
} 
```

# php - 父类构造函数未经许可启动

> ID：11017644
> 
> 赞同：0
> 
> 时间：2012-06-13T14:55:23.377
> 
> 标签：php, class, constructor

我有一个父子类。当我启动子类时，父构造函数被触发。我已经向我的子类添加了一个空构造函数来绕过它，但没有运气。父构造函数仍被触发，这会产生超时错误。

```
class modules {

    public function __construct() {
    global $Analytics;
    //get active modules and add to $modules
    if (is_dir(DIR_FS_CATALOG.$this->modules_folder)) {
        $dirHandle = opendir(DIR_FS_CATALOG.$this->modules_folder);
        while(false !== ($module = readdir($dirHandle))) {
            if (is_dir(DIR_FS_CATALOG.$this->modules_folder.$module) && $module != '.' && $module != '..') {

                //Find the class
                $object = glob(DIR_FS_CATALOG.$this->modules_folder.$module.'/*_module.php');

                //Include the class
                require_once($object[0]);
                //log every step
                $Analytics->abo_analytics_add_action('file', $object[0], 'include');
                //Prepare the variable
                $object = str_replace(DIR_FS_CATALOG.$this->modules_folder.$module.'/', "", $object[0]);
                $object = str_replace('.php', '', $object);
                //remove '_module'
                $class = str_replace('_module', '', $object);

                //initiate modules class if not registered yet
                if (!tep_session_is_registered($class) || !is_object($$class)) {
                    global $$class;
                    $$class = new $class;
                    //log every step
                    $Analytics->abo_analytics_add_action('class', $class, 'initiate');
                    //sort by sort order in modules by type
                    $this->modules[$$class->type][$$class->sort_order] = $class;
                    //log every step
                    $Analytics->abo_analytics_add_action('checkout', $class, 'add to modules', $$class);
                    tep_session_register($class);
                }
            }
        }
    } else {
        //abo_error_message("<span style='color:#FF0000;'>[CHECKOUT MODULES]</span>&nbsp;The specified Module Folder, " . DIR_FS_CATALOG.$this->modules_folder . " does not exist or isn't accesible." );
    }
}
...
}

class checkout extends modules {

    public function __construct() {
        echo 'test';
    }
}

$modules = new modules();
$checkout = new checkout(); 
```

我该如何解决这个问题？也很高兴知道。对象“模块”用作不同其他对象的父对象，而不仅仅是“结帐”。当我将构造函数添加到“结帐”对象时，我只会遇到错误。当我在结帐时删除构造函数时，一切正常，但我的“模块”对象再次启动。

# java - 安卓：CursorLoader、LoaderManager、SQLite

> ID：11017646
> 
> 赞同：29
> 
> 时间：2012-06-13T14:55:26.723
> 
> 标签：java, android, multithreading, android-loadermanager

尝试更新我不推荐使用某些方法的旧应用程序。我发现如果我想使用显示来自 db 的数据的 ListView，我应该使用 LoaderManager + CursorLoader。CursorLoader 与内容提供者一起工作。那么对于我的数据库中的每个表，我现在应该创建内容提供程序吗？我为什么要 ？据我所知，内容提供者用于与其他应用程序共享一些数据库信息，但我的应用程序不共享任何信息。那么我可以在没有内容提供者的情况下使用 CursorLoader 吗？？？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-13T15:11:10.727

我写了[**一篇**](http://www.androiddesignpatterns.com/2012/05/why-you-should-use-loadermanager.html)关于这个主题的博客文章。您还可以查看此[**答案**](https://stackoverflow.com/a/8900310/844882)以获取更多信息。希望它会为您解决问题。

正如 Barak 所提到的，可以通过扩展类来实现`CursorLoader`没有内容提供者。`AsyncTaskLoader<Cursor>`也就是说，大多数教程和示例代码都使用`ContentProvider`s，而且 Android 团队似乎也鼓励使用它。它也比实现自己的类要简单得多。

也就是说，如果您*真的*不想使用内容提供程序，Dianne Hackborn（Android 框架开发人员之一，在 SO 上也称为“hackbod”）建议编写自己的加载程序，使用您的数据库类而不是内容提供者。最简单的方法就是`CursorLoader`从兼容性库中获取类的源代码，并将提供者查询替换为对您自己的 db 助手类的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T14:59:51.460

是的，您可以，您可以拥有自定义数据加载器，它可以加载您定义的对象或任何对象类型或列表。

只需查看兼容性库示例和演示中的 LoaderCustomSupport.java 的 android sdk 示例。

# iphone - IOS：UIScrollView 和 OpenGL

> ID：11017649
> 
> 赞同：5
> 
> 时间：2012-06-13T14:55:41.763
> 
> 标签：iphone, ios, opengl-es, uiscrollview, glkit

所以我有一个 OpenGL(glView) 视图，它正在渲染一个我打算滚动的菜单。我试图避免重新发明 UIScrollView，所以我在 glView 顶部放置了一个滚动视图。

问题是滚动滚动视图会暂停渲染

此处讨论了一个类似的问题[Animation in OpenGL ES view freezes when UIScrollView is dragged on iPhone](https://stackoverflow.com/questions/4876488/animation-in-opengl-es-view-freezes-when-uiscrollview-is-dragged-on-iphone)

问题是我不知道什么 [displayLink addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSRunLoopCommonModes]; 指

我制作了一个新的 CADisplayLink 并尝试在没有运气的情况下执行上述操作

我尝试在 scrollViewDidScroll 中调用渲染方法

我试过打电话 [self.view setNeedsDisplay];

我还发现了一个提到调用 timerLoop？

谁能帮帮我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T14:10:00.227

所以，我找到了解决方案:)

创建一个 CADisplayLink *_displayLink；属性（你需要导入 QuartzCore）

将您的滚动视图放在顶部。

```
 #pragma mark - scrollView Delegate

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    //code for moving the object here    
}

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView
{
    [self startDisplayLinkIfNeeded];
}

- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
    if (!decelerate) {
        [self stopDisplayLink];
    }
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
    [self stopDisplayLink];
}

#pragma mark Display Link

- (void)startDisplayLinkIfNeeded
{
    if (!_displayLink) {
        // do not change the method it calls as its part of the GLKView
        _displayLink = [CADisplayLink displayLinkWithTarget:self.view selector:@selector(display)];
        [_displayLink addToRunLoop:[NSRunLoop mainRunLoop] forMode:UITrackingRunLoopMode];
    }
}

- (void)stopDisplayLink
{
    [_displayLink invalidate];
    _displayLink = nil;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-17T05:04:49.150

请参考[Apple WWDC 2012 的 session 223](https://developer.apple.com/videos/play/wwdc2012-223/)。从 21:21 开始，他们谈论将 UIScrollView 与 OpenGL 视图集成。有趣的部分从 25:53 开始。

主要源代码是由 Burf2000 编写的，但是这个视频解释了它为什么工作，UIScrollView 如何真正工作以及它如何与 OpenGL 交互。它还帮助我调试了我的代码。

# mysql - MySQL - 查询以合并表中的行与字段中的重复值

> ID：11017650
> 
> 赞同：3
> 
> 时间：2012-06-13T14:55:43.830
> 
> 标签：mysql, merge

我是数据库的新手，非常感谢您的帮助，我有一个以下格式的数据库：

```
ID     Nbr     Data1     Data2    Data3
1      1       a    
2      1                 b
3      1                          c
4      2       d    
5      2                 e
6      2                          f 
```

并且希望有一种方法可以通过 MySQL 查询提取以下格式的数据：

```
Nbr     Data1     Data2    Data3
1       a         b        c
2       d         e        f 
```

我知道将数据采用非标准化格式并不是最佳做法，但遗憾的是我无法更改源数据。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T14:59:42.693

```
Insert into newtable 
    select ID,Nbr,max(Data1),max(Data2),max(Data3) from table group by Nbr 
```

试试这个，让我知道它是否有效

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T15:08:37.997

```
SELECT Nbr, 
           Max(data1) data1, 
           Max(data2) data2, 
           Max(Data3) data3 
    FROM   table 
    GROUP  BY Nbr 
```

# java - 在 Twitter 中使用 Scribe 库进行 Oauth 和回调 url

> ID：11017651
> 
> 赞同：5
> 
> 时间：2012-06-13T14:55:52.823
> 
> 标签：java, twitter, oauth, twitter-oauth, scribe

我正在使用 scribe 在我的应用程序中实现 twitter。在用户验证我的应用程序并重定向到新 url 后，我得到了 oauth_token 和 oauth_verifier，但无法弄清楚如何从中生成 oauth_token 和 oauth_secret。请解决问题并提前感谢您！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T05:58:20.917

我已经解决了这个问题，只需在重定向页面中创建一个新的服务构建器（如示例中所示）并使用 oauth_token 和 oauth_verifier 当你被重定向到这样的新页面时你会得到

```
Token requestToken = new Token(request.getParameter("oauth_token"),request.getParameter("oauth_verifier"));
Verifier verifier = new Verifier(request.getParameter("oauth_verifier")); 
```

其余与示例相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T15:47:20.863

[请参阅 Twitter 示例。](https://github.com/fernandezpablo85/scribe-java/blob/master/src/test/java/org/scribe/examples/TwitterExample.java)

oauth 令牌和验证器应该是您请求访问令牌和访问受保护资源所需的。

# iphone - 用于浮点数的 iPhone WebApp 特定键盘

> ID：11017652
> 
> 赞同：0
> 
> 时间：2012-06-13T14:55:55.287
> 
> 标签：iphone, layout, keyboard, floating-point, iphone-web-app

我正在为我的 iPhone 开发一个小型 WebApp。

我得到了一个表单，其中包含一些文本、数字和浮点数的输入字段。到目前为止，我使用的是普通的 qerty 布局，但我知道特殊的应用程序可以将特定的键盘布局用于输入字段。

我已经知道如何获得普通的 0-9 键盘，但我需要“，”或“。” 对于浮点数。

所以我的问题是：是否可以显示 0-9 布局，包括“，”或“。”

问候:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:12:28.293

[支持的输入值](http://developer.apple.com/library/safari/#documentation/appleapplications/reference/SafariHTMLRef/Articles/InputTypes.html)

```
<input type="number" > 
```

在 iOS 5 中为我在顶行显示 0-9 和下面的标点符号。

# android - 在不获取 tesslib 和 leptonlib 的情况下构建 android tesseract-android-tools 库

> ID：11017653
> 
> 赞同：2
> 
> 时间：2012-06-13T14:55:56.950
> 
> 标签：android, ocr, tesseract

我正在开发一个 OCR Android 应用程序，但我在使用 Tesseract-ocr 库时遇到了很多问题。我已经按照 README 文件中包含的每个步骤来构建库，但我只编译了 libjpeg.so :-(

现在，我将解释我所采取的每一步，以便帮助您了解我做错了什么

我运行没有问题：

```
cd <project-directory>
mkdir external; cd external
wget http://tesseract-ocr.googlecode.com/files/tesseract-3.00.tar.gz
tar -zxvf tesseract-3.00.tar.gz
rm -f tesseract-3.00.tar.gz
wget http://leptonica.googlecode.com/files/leptonlib-1.66.tar.gz
tar -zxvf leptonlib-1.66.tar.gz
rm -f leptonlib-1.66.tar.gz 
```

运行时：

```
git clone git://android.git.kernel.org/platform/external/jpeg.git libjpeg 
```

我得到：

```
Cloning into 'libjpeg'...
fatal: unable to connect to android.git.kernel.org:
android.git.kernel.org[0: 149.20.4.77]: errno=Connection timed out 
```

为了解决它，我使用镜像并运行：

```
git clone git:https://github.com/android/platform_external_jpeg libjpeg 
```

好的，它似乎工作。我得到：

```
Cloning into 'libjpeg'...
remote: Counting objects: 324, done.
remote: Compressing objects: 100% (229/229), done.
remote: Total 324 (delta 142), reused 269 (delta 93)
Receiving objects: 100% (324/324), 756.37 KiB | 412 KiB/s, done.
Resolving deltas: 100% (142/142), done. 
```

运行时没有问题：

```
cd libjpeg
git checkout e0eadaa39b72e33f032220246c771d7302ebeaf8
cd ..
export TESSERACT_PATH=${PWD}/tesseract-3.00
export LEPTONICA_PATH=${PWD}/leptonlib-1.66
export LIBJPEG_PATH=${PWD}/libjpeg
cd .. 
```

但是，运行 ndk-build 后出现错误：

```
/cygdrive/c/Android_NDK/build/core/build-local.mk:40: build/core/init.mk: No such file or directory
/cygdrive/c/Android_NDK/build/core/build-local.mk:122: *** falta un `endif'.  Alto. 
```

在哪里 ”**falta un `endif'。奥拓。*" 表示 "**缺少 'endif'。停止。**"*

 *好的，这里我使用了 tesseract 项目中的 Android.mk 并进行了一些小改动以使其适应我的项目目录。[这里是][4]

现在我跑

```
ndk-build 
```

我只得到

**库/armeabi/libjpg.so**

我认为这是因为 Android.mk 需要添加下一行：

```
include $(call all-subdir-makefiles) $(TESSERACT_PATH)/Android.mk
include $(call all-subdir-makefiles) $(LEPTONICA_PATH)/Android.mk 
```

我这样做了，并且由于 LEPTONICA_PATH 和 TESSERACT_PATH 中没有 Android.mk 文件，因此我从 tesseract-android-tools 项目中获取它们 - 就像我之前所做的那样：

*   [tesseract 的 Android.mk][5],
*   leptonica 的 Android.mk]

然后我执行

```
C:\tesseract\jni>ndk-build
C:/Android_NDK/build/core/build-binary.mk:240: *** target pattern contains no `%'.  Stop. 
```

我被卡住了。我试图解决，所以我尝试了一些事情（其中，我在 stackoverflow 找到了一些建议），但没有一个解决了问题。

我给了你每一个细节，这样你会更容易找到我犯的错误。

（啊！我在 WinXP+Cygwin 上）

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T23:57:32.610

我实际上有同样的问题。我最终对 make 文件甚至库中的一些 C 代码进行了很多更改，但只能从中获得有限的功能。我建议改用这个 [tess-two](https://github.com/rmtheis/tess-two)库。我能够毫无问题地编译它。但是，我最终在 Ubuntu 执行此操作之前进行了切换。试一试。希望这可以帮助！*

# xml - 在 sproc 中提取 xml 值

> ID：11017654
> 
> 赞同：0
> 
> 时间：2012-06-13T14:55:57.240
> 
> 标签：xml, sql-server-2008, stored-procedures, xquery

假设我有以下 XML：

```
<root><test1>Hello</test1><test2>World</test2></root> 
```

在我的存储过程中，我声明了一个像这样的变量：

```
DECLARE @Stuff nvarchar(50) 
```

如果 XML 被传递到存储过程中

```
@MyXml 
```

解析传入的 XML 以获取 element 中保存的值的语句是什么`test1`？

我正在使用 SQL Server 2008

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:02:28.197

您必须使用[xml 类型](http://msdn.microsoft.com/en-us/library/ms187339.aspx)而不是 nvarchar 类型，但是转换很容易。然后你可以这样查询：

```
DECLARE @Stuff nvarchar(MAX) = '<root><test1>Hello</test1><test2>World</test2></root>'
DECLARE @Xml xml = @Stuff
SELECT @Xml.value('(/root/test1)[1]', 'nvarchar(50)') AS Test1 
```

有关详细信息，请参阅[有关 xml 数据类型方法的 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms190798.aspx)。

# html - CSS：是否可以在另一个字段集之前为字段集指定样式？

> ID：11017655
> 
> 赞同：2
> 
> 时间：2012-06-13T14:55:57.520
> 
> 标签：html, css

CSS：是否可以在另一个字段集之前为字段集指定样式？当我的代码中有两个字段集时，我想为它们应用特定的样式。

编辑当然不使用 class 和 id ...

这是我的代码

```
 <div id="tabs">
            <fieldset class="one">
                <legend>One</legend>
                Text
            </fieldset>
            <fieldset class="two">
                <legend>Two</legend>
                Text
            </fieldset>
        </div> 
```

这给了我这个：

![在此处输入图像描述](../Images/3e13f4afa6756c17d238f11c4ace6e18.png)

我想要这个：

![在此处输入图像描述](../Images/02637e5cbad326542aff0c64a6196da9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:00:02.587

在不使用任何类或 id 的情况下，您可以使用`first-child`第一个目标，然后使用默认样式作为第二个。

例如

```
form fieldset{ background: green; }
form fieldset:first-child{ background: red; } 
```

第一个字段集将具有红色背景，任何其他字段集将具有绿色背景。请注意，尽管这是针对同一表单中的字段集。如果它们是不同的形式，那么您可以使用相同的原则应用`form:first-child`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T15:25:20.147

使用 CSS，您可以仅将样式应用于任何元素的子元素或其兄弟元素，这就是为什么我们可以`fieldset`使用`+`相邻兄弟选择器仅在第二个元素上应用样式。在下面的演示中，我将展示如何做到这一点。

关于所有可能的**CSS2 选择器**，您可以阅读[规范](http://www.w3.org/TR/CSS2/selector.html#pattern-matching)以使自己理解：使用 css 选择器可以做什么，不能做什么

可能是我[**在 dabblet.com 上的解释演示**](http://dabblet.com/gist/2924668)可以帮助您解决问题。

**结果：**
![在此处输入图像描述](../Images/b4d527238149f4179d3fa17d80d920bf.png)

**HTML 标记：**

```
<fieldset> </fieldset>
<fieldset> </fieldset>
<fieldset> </fieldset>
<fieldset> </fieldset> 
```

**CSS 标记：**

```
/* detect only first fieldset */
fieldset:first-child {
    background-color: green;
}

/* detect all sibling fieldset element after first one */
fieldset:first-child ~ fieldset {
    background-color: gray; 
}

/* detect only first sibling fieldset element after first one */
fieldset:first-child + fieldset {
    background-color: red;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T14:57:26.327

为什么不为每个人分配一个特定的类或 ID？

```
<fieldset class="firstset"></fieldset>
<fieldset class="secondset"></fieldset> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T15:18:30.643

如果您不想使用类或 id，但仍希望它们具有不同的样式，那么为每个字段集使用内联 CSS 怎么样？

在仍然想使用 CSS 的同时避免使用类和 id 是否有特别好的理由？稍微详细一点，我们或许可以给你一个更好的答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T15:11:00.040

如果您想避免使用 ID 或类名，请选择 first-child 属性。

例如 -

```
form fieldset:first-child{
  //your css code here
} 
```

# php - 如何在 PHP 中将 PDF 1.5 版转换为 1.4 版

> ID：11017665
> 
> 赞同：11
> 
> 时间：2012-06-13T14:56:17.140
> 
> 标签：php, pdf-generation

如何在 PHP 中将 PDF 1.5 版转换为 1.4 版？谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-03-15T22:58:17.930

我也有类似的需求，发现 Ghostscript 可以修改 PDF 版本。文档在这里： http: [//ghostscript.com/doc/current/Use.htm](http://ghostscript.com/doc/current/Use.htm)

但是，我在文档中没有找到任何关于 dCompatibilityLevel 选项的具体内容。相反，我发现这篇文章展示了它的用途：[http ://rohieb.wordpress.com/2012/06/09/use-ghostscript-to-convert-pdf-files/](http://rohieb.wordpress.com/2012/06/09/use-ghostscript-to-convert-pdf-files/)

这是命令：

```
gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dNOPAUSE -dQUIET -dBATCH 
  -sOutputFile=new-pdf1.5.pdf original.pdf 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-06-21T09:47:44.970

您可以轻松地将 PDF 版本 1.5 转换为 1.4 。

您可以使用 2 种方式转换 PDF 版本。

1.  使用 ghostscript 命令行工具

> exec('gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dNOPAUSE -dBATCH -sOutputFile=new.pdf old.pdf')

2.  使用 github 提供的 PHP 库。从[这里下载](https://github.com/xthiago/pdf-version-converter)

我开发了一个 PDF 加密工具，可以加密任何版本的 pdf 文件。在将 PDF 传递给 fpdi pdf 解析器进行加密之前，我使用 ghost-script 转换 PDF 版本。它几乎完成并可以使用了。[这里](https://infoconic.com/tools/pdf-file-online-encryption/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-08-18T05:58:31.280

多年来我有同样的问题，没有重新安装任何东西，有一个在线转换器：[https ://docupub.com/pdfconvert/](https://docupub.com/pdfconvert/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-05T07:56:59.847

这是一个工作完整的脚本，不完美但简单。脚本从 c:\temp_in\ 读取所有 pdf 文件并将它们转换为 1.4 版，并保存在文件夹 c:\temp_done 中。鬼脚本的路径有一些问题，所以路径在 shell_exec 中完全声明。还通过实现“2>&1”为脚本添加了一些调试。（显然需要安装 ghost 脚本。）

```
<?php
if ($handle = opendir("c:/temp_in/")) {
while (false !== ($file = readdir($handle))) {
    if ('.' === $file) continue;
    if ('..' === $file) continue;

    $result = shell_exec('"C:\Program Files\gs\gs9.27\bin\gswin64c" -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dNOPAUSE -dBATCH -sOutputFile="c:\temp_done\\'.$file.'" "c:\temp_in\\'.$file.'" 2>&1');
    echo $result;

}
closedir($handle);
}
?> 
```

# apache2 - apache2 和 virtualHosts 的问题

> ID：11017666
> 
> 赞同：3
> 
> 时间：2012-06-13T14:56:17.983
> 
> 标签：apache2, symfony-1.4, virtualhost

我正在尝试在本地主机上设置一个虚拟主机。我正在我的 ubuntu 12.04 LTS 上安装 symfony 1.4，但我遇到了一些问题。

我安装了 apache2、php5 和 mySql。本地主机工作，所以我认为 apache 没关系。

[你可以在这里](http://www.symfony-project.org/getting-started/1_4/en/05-Web-Server-Configuration)找到 symfony 的安装和配置说明。

几天后，这些是我的配置文件：

http.conf：

```
ServerName 127.0.0.1 
```

/etc/apache2/sites-available/test:

```
# Be sure to only have this line once in your configuration
NameVirtualHost 127.0.0.1:8080

# This is the configuration for your project
Listen 127.0.0.1:8080

<VirtualHost 127.0.0.1:8080>
  DocumentRoot "/home/user/test/web"
  DirectoryIndex index.php
  <Directory "/home/user/test/web">
    AllowOverride All
    Allow from All
  </Directory>

  Alias /sf /home/user/test/lib/vendor/symfony/data/web/sf
  <Directory "/home/user/test/lib/vendor/symfony/data/web/sf">
    AllowOverride All
    Allow from All
  </Directory>
</VirtualHost> 
```

和 localhost:8080 不起作用。

更新：好的，经过几次修改，我的 httpd.conf 是一样的：

```
ServerName 127.0.0.1 
```

还有我的 /etc/apache2/sites-available/test：

```
Listen 127.0.0.1:80

<VirtualHost 127.0.0.1:80>
  DocumentRoot "/home/user/test/web"
  DirectoryIndex index.php
  <Directory "/home/user/test/web">
    AllowOverride All
    Allow from All
  </Directory>

  Alias /sf /home/user/test/lib/vendor/symfony/data/web/sf
  <Directory "/home/user/test/lib/vendor/symfony/data/web/sf">
    AllowOverride All
    Allow from All
  </Directory>
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T07:24:37.810

如果 Apache 使用端口 80，请在您的 conf 中删除此行：

```
NameVirtualHost 127.0.0.1:8080 
```

然后全部替换`8080`为`80`并尝试`http://localhost`。它应该工作。

**编辑：**

关于错误`could not bind to address 127.0.0.1:80 no listening sockets available`，您似乎有另一台服务器正在侦听端口 80。

`httpd.conf`回到 8080 端口（在 上）然后更新`ports.conf`到 set可能是一个更好的主意：

```
NameVirtualHost *:8080
Listen 8080 
```

如果您没有`ports.conf`文件，`Listen`请在主配置文件中查找并进行更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:16:37.603

验证您已将站点测试到`/etc/apache2/sites-enabled/`. 如果不这样做：

```
sudo a2ensite test 
```

此命令将启用该站点`test`。记得重启apache。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-30T09:50:39.553

错误信息。

(98)地址已在使用：make_sock：无法绑定到地址 127.0.0.1:80 没有可用的监听套接字，正在关闭 无法打开日志

它可以通过注释掉 httpd.conf 文件中的 Listen 80 行来解决。

问候拉基兰

# c# - Datagridview 没有显示任何内容，没有列标题也没有数据

> ID：11017670
> 
> 赞同：3
> 
> 时间：2012-06-13T14:56:28.187
> 
> 标签：c#, winforms, visual-studio-2010, datagridview

我已经看到了很多问题并应用了他们的结果，但没有任何反应我仍然没有在 gridview 中看到任何列标题/数据。

代码很简单，我确实在 Dataset 中获取数据，我在调试中看到它，我只是使用分配给 datagridview

```
datagridviewjobs.Datasource=tempJobsDataset; 
```

但是什么也没发生，它一直是空的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:05:13.407

不能将一个网格的Datasource设置为整个DataSet，一个DataSet可能有几十个与之关联的表，所以它不知道要绑定到哪个表。试试这个

```
datagridviewjobs.Datasource=tempJobsDataset.Tables("MyTable"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:08:24.760

如果您在分配后填写它，您必须接受表格上的更改才能更新网格视图...

这是一个带有包装类的完整初始化。

```
 private void init(DataGridView datagridview, IHave_A_DataTable x)
    {
        datagridview.DataSource = x.GetDataTable();

        datagridview.Columns[datagridview.ColumnCount - 1].AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill;

        datagridview.CurrentCell = datagridview[0, datagridview.RowCount - 1];

        x.Changed += new EventHandler((o, e) =>
        {
            IHave_A_DataTable sender = o as IHave_A_DataTable;
            sender.GetDataTable().AcceptChanges();
        });
    } 
```

此外，一个数据集存储的不仅仅是一个表，但 gridview 只能接受一个数据表。

# windows-8 - 如何在 windows 8 winRT 中绘制图形对象

> ID：11017677
> 
> 赞同：1
> 
> 时间：2012-06-13T14:56:57.683
> 
> 标签：windows-8, windows-runtime

我如何在 Windows 8 中绘制免提图形对象，如油漆罐。我用 Inkpresenter 在 windows phone 中实现了这些东西。但在 winRT 中似乎不存在此类项目。所以我决定使用 WritablebitmapEX，但不知道如何在 Windows 8 中实现它。下载站点中没有示例代码。请任何人帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T13:00:24.450

Microsoft 网站上有一个很好的快速入门页面

[http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh974457.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh974457.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T13:31:09.537

[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/282a211e-e3bf-4184-8868-40208aa596dd](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/282a211e-e3bf-4184-8868-40208aa596dd)

# sql-server - SQL Server 比较两个应该相同的查询的结果

> ID：11017678
> 
> 赞同：54
> 
> 时间：2012-06-13T14:57:01.133
> 
> 标签：sql-server, sql-server-2005

我正在稍微修改一个 sql server 2005 存储过程以提高性能，我想快速确保旧存储过程和新存储过程返回完全相同的结果（列相同，我想确保行是相同的）。

在 sql server 2005 中是否有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-06-13T15:00:00.333

您可以使用 except 构造在两个查询之间进行匹配。

```
select * from (select * from query1) as query1
except
select * from (select * from query2) as query2 
```

编辑：

然后逆向查询，找出以query2为驱动的差异：

```
select * from (select * from query2) as query2
except
select * from (select * from query1) as query1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-11-15T20:31:45.563

下面的存储过程将比较 2 个存储过程或 2 个语句的输出结果集。这里的关键是SP**不需要知道结果集的结构或模式**，因此您可以任意测试任何SP。如果输出相同，它将返回 0 行。此解决方案在 SQL Server 中使用 openrowset 命令。这是存储过程的一些示例用法

```
DECLARE @SQL_SP1 VARCHAR(MAX)
DECLARE @SQL_SP2 VARCHAR(MAX)

-- Compare results of 2 Stored Procs
SET @SQL_SP1 = 'EXEC SomeDB.dbo.[usp_GetWithTheProgram_OLD] 100, ''SomeParamX'''
SET @SQL_SP1 = 'EXEC SomeDB.dbo.[usp_GetWithTheProgram_NEW] 50, ''SomeParamX'''
EXEC utlCompareStatementResults @SQL_SP1, @SQL_SP2

-- Compare just 2 SQL Statements
SET @SQL_SP1 = 'SELECT * FROM SomeDB.dbo.Table1 WHERE CreatedOn > ''2016-05-08'''
SET @SQL_SP1 = 'SELECT * FROM SomeDB.dbo.Table1 WHERE CreatedOn > ''2016-06-11'''
EXEC utlCompareStatementResults @SQL_SP1, @SQL_SP2 
```

SP 需要以下先决条件，这对于生产环境可能并不理想，但对于本地 QA、DEV 和测试环境非常有用。它在代码中使用 openrowset。

```
EXEC sp_configure 'show advanced options', 1
EXEC sp_configure 'ad hoc distributed queries', 1
EXEC sp_serveroption @@SERVERNAME, 'DATA ACCESS', TRUE 
```

这是存储过程的代码。

```
==================================================================================
    --== SUMMARY utlCompareStatementResults
    --==    - requires sp_configure 'show advanced options', 1
    --==    - requires sp_configure 'ad hoc distributed queries', 1
    --==    - maybe requires EXEC sp_serveroption @@SERVERNAME, 'DATA ACCESS', TRUE
    --==    - requires the RecordSet Output to have Unique ColumnNames (no duplicate columns)
    --==    - requires references in straight SQL to be fully qualified [dbname].[schema].[objects] but not within an SP
    --==    - requires references SP call to be fully qualifed [dbname].[schema].[spname] but not objects with the SP
    --== OUTPUT
    --==    Differences are returned 
    --==    If there is no recordset returned, then theres no differences
    --==    However if you are comparing 2 empty recordsets, it doesn't mean anything
    --== USAGE
    --==   DECLARE @SQL_SP1 VARCHAR(MAX)
    --==   DECLARE @SQL_SP2 VARCHAR(MAX)
    --==   -- Compare just 2 SQL Statements
    --==   SET @SQL_SP1 = 'SELECT * FROM SomeDB.dbo.Table1 WHERE CreatedOn > ''2016-05-08'''
    --==   SET @SQL_SP1 = 'SELECT * FROM SomeDB.dbo.Table1 WHERE CreatedOn > ''2016-06-11'''
    --==   EXEC utlCompareStatementResults @SQL_SP1, @SQL_SP2
    --==
    --==   -- Compare results of 2 Stored Procs
    --==   SET @SQL_SP1 = 'EXEC SomeDB.dbo.[usp_GetWithTheProgram_OLD] 100, ''SomeParamX'''
    --==   SET @SQL_SP1 = 'EXEC SomeDB.dbo.[usp_GetWithTheProgram_NEW] 50, ''SomeParamX'''
    --==   EXEC utlCompareStatementResults @SQL_SP1, @SQL_SP2
    --==================================================================================
    CREATE PROCEDURE utlCompareStatementResults
       @SQL_SP1 VARCHAR(MAX),
       @SQL_SP2 VARCHAR(MAX)
    AS
    BEGIN
        DECLARE @TABLE1 VARCHAR(200)
        DECLARE @TABLE2 VARCHAR(200)
        DECLARE @SQL_OPENROWSET VARCHAR(MAX) 
        DECLARE @CONNECTION VARCHAR(100)

        SET @CONNECTION = 'server='+@@SERVERNAME+';Trusted_Connection=yes'

        SET @SQL_SP1 = REPLACE(@SQL_SP1, '''','''''')
        SET @SQL_SP2 = REPLACE(@SQL_SP2, '''','''''')

        SET @TABLE1 = '#' + SUBSTRING(CONVERT(VARCHAR(250),NEWID()), 1, 8)
        SET @TABLE2 = '#' + SUBSTRING(CONVERT(VARCHAR(250),NEWID()), 1, 8)

        SET @SQL_OPENROWSET =
        'SELECT * ' + ' ' +
        'INTO ' + @TABLE1 + ' ' +
        'FROM OPENROWSET(''SQLNCLI'', ' + '''' + @CONNECTION + '''' +
                        ',''' + @SQL_SP1 +'''); ' +
        'SELECT * ' + ' ' +
        'INTO ' + @TABLE2 + ' ' +
        'FROM OPENROWSET(''SQLNCLI'', ' + '''' + @CONNECTION + '''' +
                        ',''' + @SQL_SP2 +'''); ' +
        '(SELECT * FROM ' + @TABLE1 + ' EXCEPT SELECT * FROM ' + @TABLE2 + ') '  +
        ' UNION ALL ' +
        '(SELECT * FROM ' + @TABLE2 + ' EXCEPT SELECT * FROM ' + @TABLE1 + '); ' +
        'DROP TABLE ' + @TABLE1 + '; ' +
        'DROP TABLE ' + @TABLE2 + '; '
        PRINT @SQL_OPENROWSET
        EXEC (@SQL_OPENROWSET)
        PRINT 'DifferenceCount: ' + CONVERT(VARCHAR(100), @@ROWCOUNT)
    END 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-08-12T16:16:39.280

要完成[@jabs](https://stackoverflow.com/users/857031/jabs)的回答，您可以使用以下模板来获取两个查询之间的区别：

```
with q1 as (<INSERT_QUERY_1_HERE>)
   , q2 as (<INSERT_QUERY_2_HERE>)
select * from q1 except select * from q2
union all (
select * from q2 except select * from q1); 
```

* * *

示例 1：这将返回 0 行，因为查询是相同的

```
with q1 as (select * from my_table)
   , q2 as (select * from my_table)
select * from q1 except select * from q2
union all (
select * from q2 except select * from q1); 
```

示例 2：这将返回查询之间的不同行（其中`foo = 'bar'`）

```
with q1 as (select * from my_table)
   , q2 as (select * from my_table where foo <> 'bar')
select * from q1 except select * from q2
union all (
select * from q2 except select * from q1); 
```

示例 3：为了好玩，您可以检查示例 2 中的查询是否与查询 where 的行相同`foo = 'bar'`。

```
with q1 as (

    with q1 as (select * from my_table)
       , q2 as (select * from my_table where foo <> 'bar')
    select * from q1 except select * from q2
    union all (
    select * from q2 except select * from q1)

)
   , q2 as (select * from my_table where foo = 'bar')
select * from q1 except select * from q2
union all (
select * from q2 except select * from q1); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-13T15:06:19.307

```
create table #OldProcResults (
    <Blah>
)

create table #NewProcResults (
    <Blih>
)

insert into #OldProcResults
    exec MyOldProc

insert into #NewProcResults
    exec MyNewProc 
```

然后使用 Jabs 的答案来比较这两个表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-26T09:06:35.873

EXCEPT 是比较两个查询的关键（正如@jabs 所说）。

```
SELECT count(*), * FROM "query 1 here"
EXCEPT
SELECT count(*), * FROM "query 2 here" 
```

为每个查询添加`count(*)`以确保两者具有相同的结果。以防万一有一些重复的行被除外删除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-13T14:59:41.707

创建两个临时表，每个过程一个。运行该过程以将行插入到相应的表中。

然后从一个中选择 * 减去从另一个中选择 * 反之亦然

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-26T18:32:16.867

这里有一些更详细的方法可以帮助我在 MSSQL 上研究这个问题。@tpvasconcelos 的答案是迄今为止最正确的。

```
DECLARE @AAA TABLE(id bigint NOT NULL) 
    INSERT INTO @AAA
    VALUES (1),(2),(3),(4),(5),(6),(7)

DECLARE @bbb TABLE(id bigint NOT NULL)
    INSERT INTO @bbb
    VALUES (1),(2),(3),(4),(5),(6),(7)

Declare @diff int = (SELECT COUNT(*) FROM (SELECT * FROM @AAA EXCEPT SELECT * FROM @bbb) AS TB)

Declare @aux1 int;
set @aux1 = (select count(*) from @BBB);

Declare @aux2 int;
set @aux2 = (SELECT COUNT(*)  FROM @AAA)

Declare @aux3 int;
set @aux3 = (SELECT COUNT(*) FROM (select * from @AAA union SELECT * FROM @bbb) as tb);  -- for union to work it needs a alias

IF @diff <> 0
    begin
        PRINT 'Flow @flows_name has failed.'
    end
else
    begin
        IF @aux1 = @aux3
            begin
                PRINT 'Flow @flows_name might have SUCCEEDED!'
            end
        else
            begin
                PRINT 'Flow @flows_name has failed.'
            end
    end 
```

# javascript - 帧间通信

> ID：11017681
> 
> 赞同：0
> 
> 时间：2012-06-13T14:57:13.970
> 
> 标签：javascript, javascript-events

用例是两个不同项目加载的两个框架。例如

farme 1 由**test.dev.com**加载 frame 2 由**load.dev.com 加载**

此页面位于**test.dev.com**中。第 2 帧有一个保存按钮。第 1 帧应该知道何时单击关闭按钮。或者Frame 2能否提供对frame 1的回调函数。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:59:45.907

框架是独立的 DOM，从技术上讲，它们不能与其他框架交互。使其看起来像它们的唯一方法是使用某种 ajax 或“框架管理器”加载在所有框架都可以访问的顶层，并来回传递所需的 HTML 元素。最好让框架独立而不相互依赖。

# authentication - 如何在 TeamCity REST API 中传递用户名和密码

> ID：11017686
> 
> 赞同：9
> 
> 时间：2012-06-13T14:57:29.637
> 
> 标签：authentication, rest, teamcity

我刚刚开始尝试使用 TeamCity REST API。我已经阅读了一些关于我可以调用什么类型的命令等的文档，但是没有提到的一件事是如何将用户名和密码传递给 API。

我找不到这方面的例子；那么有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-13T15:06:03.767

像这样：

```
http://user:pass@server:port/app/rest/..... etc 
```

我在[EAP 文档网站上找到了](http://confluence.jetbrains.net/pages/viewpage.action?pageId=45252915)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-13T01:58:16.527

感谢僧伽的回答。只是多了一份补充。

请记住使用**Base64 对用户 ID 和密码进行编码。**

# php - .htaccess 适用于一个域，但不适用于另一个域。两者都在同一台服务器上

> ID：11017687
> 
> 赞同：1
> 
> 时间：2012-06-13T14:57:33.063
> 
> 标签：php, .htaccess

**现在排序。问题与服务器由于输入文本中的关键短语而将某些请求的运行列入黑名单有关。如果您遇到问题，请检查。**

我正在开发一个系统，并让它在同一台服务器上的两个不同域上运行。下面的代码适用于一个域，但是当我从“admin/index.php”对“admin/do/content.php”进行发布请求时，它在第二个域上失败了。“admin/”在两者中都是一个真实的目录，我已经检查过该文件确实存在。下面列出了我正在使用的 .htaccess 重定向代码。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)/([^/]*)$ /?type=$1&page=$2 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)$ /?type=&page=$1 [L] 
```

我已经尝试在第二个域上修复它。这是我尝试过的众多 .htaccess 文件之一。它不起作用。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/admin/
RewriteRule ^([^/]*)/([^/]*)$ /?type=$1&page=$2 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/admin/
RewriteRule ^([^/]*)$ /?type=&page=$1 [L] 
```

我注意到的真正奇怪的事情是，当我在第二个域上访问“admin/do/content.php”时刷新页面会加载它应该加载的页面，但没有发布数据。

编辑 [2012-06-16]：看起来问题可能出在我正在调用的脚本或我正在使用的数据库上。我再试一次，稍后会发布更新

编辑 [2012-06-20]：不是发布的数据量。由于我使用的字符串，服务器抛出错误 500。关键短语“从 * 更新 *”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T13:34:11.130

现在排序。问题与服务器由于输入文本中的关键短语而将某些请求的运行列入黑名单有关。如果您遇到问题，请检查。

# php - 让用户上传大文件到网站

> ID：11017695
> 
> 赞同：10
> 
> 时间：2012-06-13T14:58:14.897
> 
> 标签：php, security, upload

所以我需要一点建议。我正在建立一个仅用于学术目的的网站，仅限于少数人。本网站的唯一目的是作为文件上传的 GUI。这些文件的大小通常在 10-12GB 之间。

通过重新搜索，我发现我可以使用 php 脚本上传文件并更改 php.ini 中的最大文件上传大小（但我找不到最大文件上传大小限制）。我有几个问题。

1）我是否需要想办法保持网站和用户之间的连接打开，以避免连接超时等事情？如果是这样，在服务器端这样做就足够了吗？还是这些用户将使用的网络浏览器也存在问题（网络浏览器是否会使您的连接超时）？--- 我问这个是因为这些上传会花费大量时间。

2) 我必须考虑哪些安全问题？到目前为止，我已经发现并考虑了以下内容：

1.  限制仅从多个子网访问网站（我想要的学术界用户）

2.  将要上传到网站的文件是一种特殊格式，由唯一的标题组成）——因此会检查这些标题。

3.  使用 .htaccess 禁用 CGI 执行

4.  将所有上传移到 www 根文件夹之外

5.  可能找到防病毒检查这些文件

6.  最初，所有这些用户都将进行身份验证才能访问该网站——这是我在第一个问题中还必须考虑的问题——他们可以保持登录状态多久，我该如何控制？

该网站的安全方面对其开发至关重要，当您使用 12 GB 文件时，这是一个非常棘手的问题。

这些是我认为很难实现的一些事情，但我相信还有更多。你们认为我还应该考虑什么？另外，如果还有其他实现方法，请不要犹豫。

附加信息：

*   截至目前，这些用户使用 scp 将文件上传到此服务器
*   这些用户受到我社区的高度信任，但是，安全是这个社区的第一大座右铭——很少有东西对公众开放，而且这些服务器上存储的一些信息不能被泄露
*   将要上传到服务器的文件基本上是关于真人的机密数据——所以我必须考虑诸如数据包嗅探之类的事情

谢谢大家，我知道这很难接受，但任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-18T14:21:52.453

你不可能通过 PHP 上传一个那么大的文件。不管你投入了多少服务器资源（内存）（相信我，你需要很多！），PHP 中有一个限制会阻止你这样做。

在 php.ini 中，有一个名为“post_max_size”的变量会影响您可以发送到服务器的最大数据大小。这个变量是一个无符号的 32 位整数，这意味着你不能高于 4,294,967,295。

一个好的解决方案是使用Flash将文件分成几个小部分，然后进行文件上传。我为您找到了一个完全可以做到这一点的库：http: [//www.blog.elimak.com/2011/08/uploading-large-files-with-flash-splitting-the-bytearray-in-chunks/](http://www.blog.elimak.com/2011/08/uploading-large-files-with-flash-splitting-the-bytearray-in-chunks/)

如果您在 PHP 中遇到内存问题，只需将块变小即可。

祝你好运！

编辑：要回答您的第二个问题，您已经掌握了大部分内容。如果您担心数据可能在途中被劫持，请使用 SSL 进行传输。至于身份验证，请考虑使用 OAuth，并确保在传输不活动时撤销用户的访问令牌。添加`php_flag engine off`到您的 .htaccess 文件中以防止上传的 PHP 文件运行。并且定期运行服务器病毒扫描程序也不是一件坏事:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T19:40:20.313

不了解您的用户，我建议您坚持使用 SCP。您的所有安全问题都已通过 SCP 得到解决，并且可以广泛免费获得。

话虽如此，我知道如果你的用户不是技术人员，SCP 会很痛苦。如果我是你，我不会尝试将其完全实现为 Web 应用程序。我将有一个 Web 前端，它只会为用户生成适当的 SCP 命令，并为他们执行它。使用 Java 小程序应该很容易做到这一点，您可以通过浏览器提供粗略的进度，只需将它反馈给您的进程的 SCP 进度转换为 Java。如果你走小程序路线，你会遇到一些安全问题，因为小程序通常不能在客户端的 PC 上启动进程。要解决此问题，您需要签署小程序和/或请求更高级别的权限。同样，这可能是也可能不是一个好的解决方案，具体取决于您的用户的技术水平。

如果您坚持使用 Web 应用程序路线，请确保使用 SSL/TLS 进行传输。这可以解决您的数据包嗅探问题。还要确保没有在任何大文件上设置可执行位。如果它们需要可执行，请坚持让用户在下载时设置可执行位，而不是在存储时设置。如果必须在服务器上执行，请使用内置的文件系统权限对应用程序进行沙箱处理。如果他们必须以 root 身份在服务器上上传和执行，天堂会帮助您。如果是这样，那么安全性是不可能的:-)

有防病毒软件来检查文件是好的，但请注意检测率很糟糕。我见过文件被深度感染并被 35 个 AV 程序中的 30 个宣布为干净的情况。假设所有文件都被感染并适当地限制它们的权限。

真正的风险是有人可能会上传包含漏洞利用的代码。只要文件不可执行，就更难了。如果无法访问编译器，那就更难了。如果您将文件可以访问的方式限制为仅某些程序，那么对利用者来说就更难了。但是，您可以做的最好的事情是安装补丁来防止这种情况。更新可以确保您的安全，即使它们有时会破坏某些内容。

如果用户是值得信赖的，您可以允许他们自己设置可以读取/写入文件的权限。这样个人的敏感信息就受到控制，如果有人将权限设置为松散，就会有一些责任。

这是一个需要解决的大问题，我知道我只是触及了表面。我希望它至少有一点帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T03:11:06.647

正如您所说，有效地建立这样一个网站确实非常棘手。但是，您可能需要考虑使用 Java 或 C# 中构建的 GUI 程序作为更合适/更安全的方法。原因和优点很多。

首先，非常建议您在上传之前在客户端进行拆分。您的用户可以轻松使用为此而设计的强大实用程序，例如[FFSJ 命令行界面](http://www.jaist.ac.jp/~hoangle/filesj/#CLI)（适用于 Windows）或[JJSplit（Java 开源）](http://sourceforge.net/projects/jjsplit/)。

使用这样的程序的优点如下：

1.  更好更安全的用户认证
2.  在客户端和服务器端验证用户 IP 子网
3.  您可以选择拆分文件以便于传输
4.  您有优势同时上传多个文件部分
5.  您有能力使用用户的互联网连接最高速度
6.  您有能力确保最大限度地减少和纠正上传过程中可能发生的错误。
7.  上传后校验和校验，确保真实性和正确上传
8.  由于您的上传甚至可以加密，因此增加了更多的安全优势。

我可以继续，但你明白要点。但是，如果您不是程序员，此选项的明显缺点是财务成本和时间。

然而，一个已经具备基本拆分和上传能力的程序是[GSplit](http://www.gdgsoft.com/gsplit/)。在基于 Unix 的系统上，他们还可以在上传或使用 [HJSplit](http://www.hjsplit.org/linux/)等程序之前自行拆分文件。

## ps：

如果您必须始终坚持使用 PHP，请查看[Open Upload](http://sourceforge.net/projects/openupload/)。它类似于 RapidShare 克隆，并且已经具有 ip 限制、用户身份验证、验证码等。

我希望详尽地回答你的问题。祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T20:07:22.467

您可以使用 ajax 函数来保持会话或使用 ob 函数来控制流程。见[http://www.php.net/manual-lookup.php?pattern=ob&lang=pt_BR&scope=quickref](http://www.php.net/manual-lookup.php?pattern=ob&lang=pt_BR&scope=quickref)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T21:59:50.093

是的，您可以在没有 Flash 或 Java 的情况下使用 HTML5 来做到这一点。您可以通过 FileReader 对象创建文件的读取切片，然后通过 ajax 将原始块发送到服务器，然后您可以读取它们并在 PHP 中组装它们。好的想法是，当您将文件发布到 PHP 时，您可以在 ajax 发布请求中传递其他属性，例如开始字节和结束字节，这样您就可以跟踪上传了哪些部分，并且您可以构建某种类型如果需要，暂停/恢复逻辑。有关更多信息，请查看：

[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/) [http://www.webiny.com/blog/2012/05/07/webiny-file-upload-with-html5-and-ajax-使用-php-streams/](http://www.webiny.com/blog/2012/05/07/webiny-file-upload-with-html5-and-ajax-using-php-streams/)

我宁愿使用 HTML5 而不是 java 或 flash。您可以使用 SSL，如果您真的希望它更安全，您可以在发送之前为这些用户提供私钥来加密数据，然后您可以在服务器上解密（如果您使用 SSL，这将有点多余）。请记住，解密 12 GB 的数据文件可能相当慢。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T22:38:15.370

恕我直言，FTP 更适合这种情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T00:25:40.307

我会认真建议 FTP + 显式/隐式 SSL。这肯定会解决你的问题。

周围有一些高级 ftpd，它们支持：

1.  允许用户上传大文件（大部分是这样做的）；
2.  在普通密码认证之前拒绝用户连接；
3.  允许用户在其特定 IP 范围内登录；
4.  自定义权限，如上传/下载/删除/列表等；
5.  chroot 每个用户到他/她自己的文件夹；
6.  可恢复（这也是一个可自定义的权限）；
7.  使用 SFV 文件进行文件完整性检查；
8.  邮编完整性检查；

唯一的缺点是下载客户端并进行设置，这并不是每个人都喜欢的。

像 HTTP 一样，你需要某种浏览器来查看内容，你也需要 FTP 客户端来分别操作它。

# python - 如何在生产环境中运行 gevent

> ID：11017699
> 
> 赞同：26
> 
> 时间：2012-06-13T14:58:26.653
> 
> 标签：python, gevent, gunicorn

我在我的 Python 应用程序（基于 Django）中使用 gevent。但是，我现在想知道如何在生产中运行它。我应该使用什么服务器？在开发过程中，我使用 gevent.pywsgi，但它可以用于生产吗？我也听说过 gunicorn，但我看到了一些关于它的非常[糟糕的基准](http://nichol.as/benchmark-of-python-web-servers)。

注意：我需要 SSL。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-01T08:07:09.103

[Gunicorn](http://gunicorn.org/)确实是最好的选择。它速度快，是用纯 Python 编写的（这使得部署在[Heroku](http://www.heroku.com/)等托管服务上变得很容易），并且维护良好，并用于大量 Python Web 应用程序。

默认情况下，Gunicorn 使用同步工作程序类来处理请求，但它可以通过简单地添加`-k gevent`到 run 命令轻松配置为使用 gevent。

快速说明：您应该始终在 NGINX、Varnish 等代理后面运行 gunicorn，因为这将允许 gunicorn 处理比其他方式更多的请求，因为响应缓冲。

# actionscript-3 - 在 VBox 上设置特定的圆角半径

> ID：11017700
> 
> 赞同：0
> 
> 时间：2012-06-13T14:58:27.593
> 
> 标签：actionscript-3, apache-flex, flex3

默认情况下，如果设置`cornerRadius`在 VBox 上，所有四个角都将受到影响。如何仅将cornerRadius应用于左下角和右下角？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T17:20:22.753

扩展 VBox 组件并覆盖 updateDisplayList 方法，如下所述：-

```
override protected function updateDisplayList(unscaledWidth:Number, 
       unscaledHeight:Number):void 
{

   super.updateDisplayList(unscaledWidth, unscaledHeight);

   var cornerRadius:Number = getStyle("cornerRadius");
   var backgroundColor:int = getStyle("backgroundColor");
   var backgroundAlpha:Number = getStyle("backgroundAlpha");
   graphics.clear();

   // Background
   drawRoundRect(0, 0, unscaledWidth, unscaledHeight, 
       {tl: 0, tr: 0, bl: cornerRadius, br: cornerRadius}, 
       backgroundColor, backgroundAlpha);

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T09:00:17.040

在 flex3 中，我会使用borderskin 而不是扩展VBox。但我建议你选择 flex4（我的意见）。

==================================================== ==============================

在 flex4 中，

您必须使用皮肤类，并且 s:Rect 具有一个属性，您可以使用该属性将不同的角半径应用于所有四个角。

看看这个链接：

> [http://blog.flexexamples.com/2009/10/11/setting-a-corner-radius-on-individual-corners-on-a-rect-in-flex-4/](http://blog.flexexamples.com/2009/10/11/setting-a-corner-radius-on-individual-corners-on-a-rect-in-flex-4/)

您可以将 BorderContainer 与垂直布局一起使用。

从 VBox 开始， VGroup 也存在，但不支持蒙皮。（我的意思是没有定义 skinClass 属性）

```
<s:VGroup skinClass=""/>----not defined 
<s:BorderContainer skinClass="bcSkin"/>----defined, apply custom skin 
```

所以 BorderContainer 是 gud 1 与垂直布局。

谢谢

安库尔

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-14T09:25:47.183

试试这个： - 像这样修改上面的代码（代码由 -- user1367714 编写）

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600" xmlns:local="*">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>

    <local:stackOverflowCornerRadious x="50" y="50" width="200" height="200"/>
</s:Application> 
```

类名：-stackOverflowCornerRadious

```
package
{
    import flash.display.Sprite;

    import mx.containers.Box;
    import mx.containers.VBox;
    import mx.utils.GraphicsUtil;

    import spark.primitives.Rect;

    public class stackOverflowCornerRadious extends VBox
    {
        public function stackOverflowCornerRadious()
        {
            super();
        }

        override protected function updateDisplayList(unscaledWidth:Number, 
                                                      unscaledHeight:Number):void 
        {

            super.updateDisplayList(unscaledWidth, unscaledHeight);

            graphics.clear();
            graphics.beginFill(0x00FF00);
            GraphicsUtil.drawRoundRectComplex(graphics,0,0,unscaledWidth,unscaledHeight,0,0,10,10)
            graphics.endFill();

        }

    }
} 
```

# apache - 将 .htaccess 转换为 web.config 时追加查询字符串

> ID：11017701
> 
> 赞同：1
> 
> 时间：2012-06-13T14:58:30.780
> 
> 标签：apache, .htaccess, iis, web-config

我正在尝试将一些简单的 .htaccess 重写转换为 web.config xml；他们中的大多数都很好，但是我遇到了一个涉及查询字符串的特殊问题。

这是 .htaccess 规则：

```
RewriteRule ^table/([a-zA-Z0-9\-_]+)/delete/([^/\.]+)$ table-index.php?mode=delete&type=$1&id=$2 [QSA,L] 
```

我是这样翻译的：

```
<rule name="delete">
  <match url="^table/([a-zA-Z0-9\-_]+)/delete/([^/\.]+)$" ignoreCase="true" />
  <action type="Rewrite" url="table-index.php?mode=delete&amp;type={R:1}&amp;id={R:2}" appendQueryString="true" />
</rule> 
```

本质上，我为此做了与所有其他（工作）规则相同的事情，但这个不是打球。唯一的区别是这条规则`[QSA]`在 .htaccess 中有一条指令，我`appendQueryString="true"`为 XML 翻译了它。

该规则不会破坏 IIS，它也不起作用 - 应该显示为：

```
http://my.site/admin/table/mailing-list/delete/1?confirm=true 
```

显示为

```
http://my.site/admin/table-index.php?confirm=true 
```

这缺少很多重要信息，并导致应该发生的事情不会发生......当 URL 中没有 ?confirm=true 查询字符串时，相同的规则会正常运行。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T02:01:05.710

我又看了一遍，找到了自己的解决方案。重写规则没有错，相反，我依赖于我的一个链接 $_SERVER['REDIRECT_URL'] 中的一个 apache 服务器变量，IIS 没有提供，相反，$_SERVER['REQUEST_URI'] 为我修复了它.

这并没有产生任何错误，因为我已经预料到变量可能不会由某些服务器提供并退回到另一个服务器的事件 - 但是该代码是在我将系统更改为使用重写的 URL 工作之前编写的导致问题的部分......！

# svn - 支持 Single Checkout 的修订控制系统？

> ID：11017702
> 
> 赞同：0
> 
> 时间：2012-06-13T14:58:38.857
> 
> 标签：svn, version-control, tfs, visual-sourcesafe

我需要知道哪些版本控制系统支持“单一签出”？当我说单人结帐（或单用户结帐）时，我的意思是一次只能有一个人签出文件。

到目前为止，我知道 Visual Source Safe (VSS) 和 Team Foundation Server (TFS)。您可以将任何其他系统添加到此列表中吗？

我问的原因是，我工作的大老板对将复杂性引入他的小团队持谨慎态度，并且更愿意避免使用“合并方法论”盛行的系统。现在他们使用 VSS，但我试图说服他们远离它，因为我知道它被普遍认为是一个非常糟糕的产品，最终会破坏您的数据并丢失您的整个签入历史记录。

带有设置的 SVN`svn:needs-lock`听起来可能会起作用。（请参阅[SVN 中的单用户结帐](https://stackoverflow.com/q/4014742/16387)）有没有办法在系统范围内进行设置？

还有其他选择吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:01:55.590

查看[http://en.wikipedia.org/wiki/Comparison_of_revision_control_systems](http://en.wikipedia.org/wiki/Comparison_of_revision_control_systems)。在第一个表中，在“并发模型”下查找“合并或锁定”。有几个结果。

# javascript - JavaScript 将代码添加到已设置的事件

> ID：11017706
> 
> 赞同：0
> 
> 时间：2012-06-13T14:58:46.577
> 
> 标签：javascript, javascript-events

我尝试将新代码添加到已设置的事件中，并且不知道如何在不重新编写代码的情况下执行此操作？如您所见，我有一个**onComplete**事件，它在完成 Flash 文件后会引发 alert()。现在我还想打开一个 jQuery 对话框。我怎样才能做到这一点？

问候和感谢，
-lony

```
<html><head><title>testAddEvent</title>
    <script type="text/javascript" src="filesOthersForTesting/jquery-1.x.x.min.js"></script>
    <script type="text/javascript" src="filesFromJWPlayer/jwplayer.js"></script>
    <script type="text/javascript">
        $(function(){
            jwplayer('playerDiv-1').setup({
                flashplayer: 'filesFromJWPlayer/player.swf',
                file: 'sampleContent/bla.flv',
                provider: 'video',
                height: 300,
                width: 300,
                stretching: 'uniform',
                events: {
                    onComplete: function() {
                        alert('Complete!');
                    }
                }
            });
        });
    </script>
<body>
    <div id="playerDiv-1"></div>
</body> 
```

**更新 1：**
此代码是一个示例。alert() 是一堆行的示例。一般的问题是，我可以向已经初始化的事件（events.onComplete）添加一些东西。类似于：`events.onComplete = events.onComplete + 'new code here';`对于参数。

@Pointy：是的，jQuery 1.3.2 已经过时，切换到 x ;)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:14:29.663

```
function decorateBefore(target, decorator) {
    var fn = function () {
        decorator.apply(this, arguments);
        return target.apply(this, arguments);
    };
    // fix inheritance if it's constructor 
    // (it's not needed in your case)
    fn.prototype = target.prototype;
    return fn;
}    

someObj.onComplete = decorateBefore(someObj.onComplete, function(){
  // my code here
  // this function will accept same arguments as original, it's return value will be ignored
}) 
```

# ruby-on-rails - 对 Cucumber 上的多个功能使用相同的浏览器实例时出错

> ID：11017708
> 
> 赞同：3
> 
> 时间：2012-06-13T14:58:49.397
> 
> 标签：ruby-on-rails, cucumber, watir-webdriver, pageobjects, page-object-gem

我在为 Cucumber 驱动程序创建浏览器实例时遇到问题。如果我在“Before do”内的 env.rb 上创建对象：

```
Before do
@browser = Watir::Browser.new 'firefox'
end 
```

…工作正常，为每个功能打开一个新浏览器并在“完成后”关闭它。

这会减慢执行速度，因为新浏览器会启动并关闭每个功能。但是，如果我从“Before do”中创建@browser，以便为所有功能提供相同的浏览器会话，则会出现以下错误：

```
**Unable to pick a platform for the provided browser (RuntimeError)** 
```

...根本不启动任何测试。我正在使用页面对象 gem，ruby-on-rails ......

你能告诉我我在做什么错吗？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T16:23:54.767

我不确定你得到的错误来自哪里，但我猜这是一个范围问题。如果您仅在 env.rb 中（而不是在钩子中）声明 @browser，那么在您的步骤中 @browser 将为零。

Alister Scott 有一个很好的示例，可以设置只打开一次浏览器（[http://watir.com/2011/01/22/simple-cucumber-watir-page-object-pattern-framework/](http://watir.com/2011/01/22/simple-cucumber-watir-page-object-pattern-framework/)）。

基本上你想要以下（注意哪些变量是浏览器与@browser）：

```
browser = Watir::Browser.new 'firefox'

Before do
  @browser = browser
end

at_exit do
  browser.close
end 
```

# jquery - jQuery ajax.load 不会将 HTML 加载到 div 元素中

> ID：11017710
> 
> 赞同：0
> 
> 时间：2012-06-13T14:58:52.630
> 
> 标签：jquery

这有点奇怪。我有解决这个问题的方法，但我想知道是否有人知道它为什么不起作用。我在页面上有一个名为 的 div 元素`shippingSelect`。当我做：

```
$('#shippingSelect').load('page.asp') 
```

它不会将相应的 HTML 从加载`page.asp`到`shippingSelect`元素中。或者，如果我这样做：

```
$('#shippingSelect').load('page.asp', function(data){
    $('#shippingSelect').html(data);
}); 
```

这确实有效。那里有什么交易？谢谢大家。

这正是正在加载的内容......不是整个页面：

```
<a href='#' onclick='getShipping(); return false'>Re-Calculate shipping</a> - <select name='ups_select' id='ups_select' onchange='calculateTotal(this.value);'><option value='13.04|03' selected>UPS Ground ($13.04)</option><option value='56.56|13' >UPS Next Day Air Saver - Gtd. 1 day ($56.56)</option><option value='96.52|14' >UPS Next Day Air. Early A.M. - Gtd. 1 day ($96.52)</option><option value='61.03|01' >UPS Next Day Air. - Gtd. 1 day ($61.03)</option></select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:15:11.677

这里唯一有意义的是，根据传递给它们的内容，做什么`.load`和做什么是不同的。`.html`

您还没有包含内容，因此很难说出它为什么会中断，但我敢打赌，您正在加载的页面包括该元素以及您**永远**不想加载到 div 中`<html>`的各种其他内容。

 **您可能实际上并不想将整个页面加载到我们的 div 中，只是其中的一部分。最好在该部分上放置一个 id 并像这样加载该元素：

```
$('#shippingSelect').load('page.asp #container') 
```

[见文档](http://api.jquery.com/load/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:14:00.973

不建议将整个页面加载到 div 元素中，它有很多你并不真正需要的额外内容。

试试这个：

```
$('#shippingSelect').load('page.asp body'); 
```

要仅加载正文内容，如果运气不好，请在实际内容周围添加一个占位符，为其提供 id 并将“body”更改为“#id_here”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:03:24.630

您是刚刚错过了粘贴分号，还是错过了原来的分号？`$('#shippingSelect').load('page.asp');`**

# java - 连接两个哈希映射而不从两个映射中删除共同的整体

> ID：11017713
> 
> 赞同：2
> 
> 时间：2012-06-13T14:59:01.103
> 
> 标签：java, hashmap

我有两个哈希图，特别是两种语言的词汇说英语和德语。我想连接这两个地图以返回一个地图。我试过：

```
 hashmap.putall() 
```

但是，删除了两个地图中常见的一些条目，并仅用单个条目替换它。但我想保持两个词汇完整，只需将它们连接起来。有什么方法可以做到吗？如果没有其他方法。我更喜欢 hashmap 中的任何方法。

[编辑]

为了更清楚，让我们看两张地图

```
 at the 500    um die 500
      0   1   2     0   1   2 
```

结果成

```
 at the  500 um die 500
  0   1    2   3  4   5 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:02:23.423

然后，您必须编写自己的自定义“putAll()”方法。这样的事情会起作用：

```
HashMap<String> both = new HashMap<String>(english);

for(String key : german.keySet()) {
    if(english.containsKey(key)) {
        both.put(key, english.get(key)+german.get(key));
    }
} 
```

这个先抄英文`HashMap`。然后输入所有德语单词，如果有重复键则连接。您可能需要某种分隔符，例如`/`介于两者之间的分隔符，以便稍后提取两者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T15:01:55.093

Java 主库本身没有类似的东西，你必须使用第三方提供的东西，比如 Google Guava 的[Multimap](http://guava-libraries.googlecode.com/svn/tags/release03/javadoc/com/google/common/collect/Multimap.html)，它完全符合你的要求，或者手动构建类似的东西。

[您可以在项目的网站上](http://code.google.com/p/guava-libraries/)下载 Guava 库。使用多重映射与使用映射相同，如下所示：

```
Multimap<String,String> both = new ArrayListMultimap <String,String>();
both.putAll( german );
both.putAll( english);

for ( Entry<String,String> entry : both.entrySet() ) {
  System.out.printf( "%s -> %s%n", entry.getKey(), entry.getValue() );
} 
```

此代码将打印所有`key-value`对，包括两个地图上都存在的对。因此，如果您`me->me`两者都有`german`，`english`它们将被打印两次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T15:06:55.267

类似于@tskuzzy 的回答

```
Map<String, String> both = new HashMap<String, String>();

both.putAll(german);
both.putAll(english);
for (String e : english.keySet()) 
    if (german.containsKey(e))
        both.put(e, english.get(e) + german.get(e)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T15:08:42.067

您不能直接使用任何`Map`实现来执行此操作，因为在地图中，每个键都是唯一的。

一种可能的解决方法是使用`Map<Key, List<Value>>`, 然后手动连接地图。将 List 用于级联映射的优点是可以轻松检索每个单独的值，而无需任何额外的摆弄。

像这样的东西会起作用：

```
public Map<Key, List<Value>> concat(Map<Key, Value> first, Map<Key, Value> second){
    Map<Key, List<Value>> concat = new HashMap<Key, List<Value>>();
    putMulti(first, concat);
    putMulti(second, concat);
    return concat;
}

private void putMulti(Map<Key, Value> content, Map<Key, List<Value>> dest){
    for(Map.Entry<Key, Value> entry : content){
        List<Value> vals = dest.get(entry.getKey());
        if(vals == null){
            vals = new ArrayList<Value>();
            dest.put(entry.getKey(), vals);
        }
        vals.add(entry.getValue());
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-13T15:12:50.477

@tskuzzy 和@Peter 在这里的回答稍有即兴发挥。`StrangeHashMap`只需通过扩展来定义自己的`HashMap`.

```
public class StrangeHashMap extends HashMap<String, String> {
    @Override
    public String put(String key, String value) {
        if(this.containsKey(key)) {
            return super.put(key, super.get(key) + value);
        } else {
            return super.put(key, value);
        }
    }
} 
```

你可以这样使用它：

```
Map<String, String> map1 = new HashMap<String, String>();
map1.put("key1", "Value1");
map1.put("key2", "Value2");

Map<String, String> map2 = new HashMap<String, String>();
map2.put("key1", "Value2");
map2.put("key3", "Value3");

Map<String, String> all = new StrangeHashMap();

all.putAll(map1);
all.putAll(map2);

System.out.println(all); 
```

以上为我打印以下内容：

```
{key3=Value3, key2=Value2, key1=Value1Value2} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-13T15:41:55.043

鉴于问题中的新元素，您实际需要使用的似乎是列表。在这种情况下，您可以这样做：

```
List<String> english = ...;
List<String> german = ...;
List<String> concat = new ArrayList<String>(english.size() + german.size());
concat.addAll(english);
concat.addAll(german); 
```

你就在那里。您仍然可以使用`concat.get(n)`来检索连接列表中的第 n 个值。

# backbone.js - 使用 Twitter Bootstrap 和 Backbone.js 构建的树？

> ID：11017717
> 
> 赞同：6
> 
> 时间：2012-06-13T14:59:35.877
> 
> 标签：backbone.js, tree, twitter-bootstrap

有没有使用 Twitter Bootstrap 和 Backbone.js 构建的简单模块化树，提供通用的树控制功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-13T16:20:59.570

这是一个 Bootstrap 树小部件（来自“ [Twitter Bootstrap 中的树](https://stackoverflow.com/questions/11167628/trees-in-twitter-bootstrap/16823729#16823729)”）：

在[Vitaliy 的 CSS](https://stackoverflow.com/a/15480307/1430996)和[Mehmet 的 jQuery 的](https://stackoverflow.com/a/16664260/1430996)基础上，我将`a`标签更改为标签，并在[我的 Bootstrap 树小部件](http://jsfiddle.net/jhfrench/GpdgF/)`span`中加入了一些[Glyphicons](http://twitter.github.io/bootstrap/base-css.html#icons)和[徽章](http://twitter.github.io/bootstrap/components.html#labels-badges)。

**例子：** ![我对 Bootstrap 树小部件的看法](../Images/87f51023951537d231933850d6c4e8a9.png)

为了获得额外的荣誉，我创建了一个[GitHub 项目来托管用于将此树组件添加](https://github.com/jhfrench/bootstrap-tree)到 Bootstrap 的 jQuery 和 LESS 代码。请参阅[http://jhfrench.github.io/bootstrap-tree/docs/example.html](http://jhfrench.github.io/bootstrap-tree/docs/example.html)上的项目文档。

或者，这里是生成 CSS 的 LESS 源（可以从[jsFiddle](http://jsfiddle.net/jhfrench/GpdgF/)获取 JS ）：

```
@import "../../../external/bootstrap/less/bootstrap.less"; /* substitute your path to the bootstrap.less file */
@import "../../../external/bootstrap/less/responsive.less"; /* optional; substitute your path to the responsive.less file */

/* collapsable tree */
.tree {
    .border-radius(@baseBorderRadius);
    .box-shadow(inset 0 1px 1px rgba(0,0,0,.05));
    background-color: lighten(@grayLighter, 5%);
    border: 1px solid @grayLight;
    margin-bottom: 10px;
    max-height: 300px;
    min-height: 20px;
    overflow-y: auto;
    padding: 19px;
    a {
        display: block;
        overflow: hidden;
        text-overflow: ellipsis;
        width: 90%;
    }
    li {
        list-style-type: none;
        margin: 0px 0;
        padding: 4px 0px 0px 2px;
        position: relative;
        &::before, &::after {
            content: '';
            left: -20px;
            position: absolute;
            right: auto;
        }
        &::before {
            border-left: 1px solid @grayLight;
            bottom: 50px;
            height: 100%;
            top: 0;
            width: 1px;
        }
        &::after {
            border-top: 1px solid @grayLight;
            height: 20px;
            top: 13px;
            width: 23px;
        }
        span {
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border: 1px solid @grayLight;
            border-radius: 5px;
            display: inline-block;
            line-height: 14px;
            padding: 2px 4px;
            text-decoration: none;
        }
        &.parent_li > span {
            cursor: pointer;
            /*Time for some hover effects*/
            &:hover, &:hover+ul li span {
                background: @grayLighter;
                border: 1px solid @gray;
                color: #000;
            }
        }
        /*Remove connectors after last child*/
        &:last-child::before {
            height: 30px;
        }
    }
    /*Remove connectors before root*/
    > ul > li::before, > ul > li::after {
        border: 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-17T21:17:07.200

我最近发布了我的主干.js 树小部件。在[https://bitbucket.org/dnation/bbtree/](https://bitbucket.org/dnation/bbtree/)上查看它，看看它是否满足您的需求。

# php - php将数组转换为mysql查询

> ID：11017718
> 
> 赞同：-1
> 
> 时间：2012-06-13T14:59:36.543
> 
> 标签：php, mysql, arrays

我有一个提交的表单，其中创建了一个用户并且可以分配多个角色：例如（管理员、用户等）

表单将数据作为数组发布`roles[]`。

当只能选择一个角色时，我让一个`mysqli_query()`创建用户（在用户表中）。然后第二个在 roleid 表中创建一行，使用 mysqls 将 userid 与 roleid 匹配，如果为用户分配了多个角色`LAST_INSERT_ID`，mysql 会工作吗？`LAST_INSERT_ID`

三张表如下：

```
users (name, email, password, id)
roleid (userid, roleid)
roles(id, description) 
```

我需要在 roleid 表中为用户创建表单选择的每个复选框创建一个条目。我考虑过将数组 ( `implode(',',$roles)`) 内爆，但我不确定 mysql 是否接受这种形式的值。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:12:32.363

您必须为每个角色查询一次，或者在一个查询中插入多条记录。使用 MySQLi，您甚至可以为此使用准备好的语句。

```
$user_id = mysqli_insert_id();
$query = "INSERT INTO `roleid` (userid, roleid) VALUES ";

foreach($roles as $index => $role_id) {
  $roles[$index] = "($user_id," . intval($role_id) . ")";
}

$query .= implode(', ', $roles); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:20:24.787

```
if (count($roles)) {
   $qry="INSERT INTO roleid (userid, roleid) VALUES ";
   $part="($user_insert_id, ";
   $qry . = $part . implode(")," . $part, roles) . ")";
   mysql_query($ary, $db_handle);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-13T15:09:19.377

如果您曾经将一个用户插入到`users`表中并将其保存`LAST_INSERT_ID`到一个变量中，例如，`$last_insert_id`您可以根据`$last_insert_id`需要使用它执行尽可能多的查询（虽然它没有被覆盖:-)）。

所以：

1.  插入新用户
2.  取回`$last_insert_id`
3.  为每个角色 ID 运行`insert into roleid values ($role_id, $last_insert_id)`
    或
    运行一个`insert into roleid values ($role_id_1, $last_insert_id), ($role_id_2, $last_insert_id), ($role_id_3, $last_insert_id), ...`

# python - 寻找测试功能模式

> ID：11017728
> 
> 赞同：0
> 
> 时间：2012-06-13T15:00:03.790
> 
> 标签：python, unit-testing

我为我的项目创建了一些单元测试。

我有几个班级都有自己的单元。但是很多测试用例在原理上是相似的：

1.  添点什么
2.  获取添加元素
3.  检查这个

例如：

```
Player.add_weapon("name")
Player.get_weapons()
for w in weapons:
 - check the validity bla bla

Warehouse.add_package("name")
Warehouse.get_packages()
for p in packages:
 - check the validity bla bla 
```

你看，上下文不同，但过程相同。这是我的想法：（但也许它存在一个很好的处理模式）

```
def mytestfunction(ut_instance, test_obj, add_method_as_string, getlist_method_as_string):
    add_obj = None
    get_obj_list = None    
    exec("add_obj=test_obj.%s" % add_method_as_string)        
    exec("get_obj_list=test_obj.%s" % getlist_method_as_string) 

    ut_instance.assertEqal(len(get_obj_list()), 0, msg="We need a empty test object")
    item = add_obj("lala")
    list = get_obj_list()

    #check this ..and so on ...
    ....
    pass 
```

它有效，但也许您知道更聪明的解决方案。例如控制期望或使用不同的参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:12:39.553

问题不在于测试的低效工厂方法；问题是你的底层测试范式。单元测试应该检查某些对象或方法的*行为*，而不是对象组合。

根据您发布的示例，我认为您应该检查 add 和 get 方法的边界条件，而不是关注给定数据结构中是否存在某些值。记住：行为，而不是组成。

测试在某种程度上更像是一门艺术而不是一门科学。YMMV。

# google-bigquery - 确保数据已加载

> ID：11017729
> 
> 赞同：0
> 
> 时间：2012-06-13T15:00:07.497
> 
> 标签：google-bigquery

我使用以下命令加载数据。

```
/home/bigquery/bq load --max_bad_record=30000 -F '^'  company.junelog entry.gz country:STRING,telco_name:STRING,datetime:STRING, ... 
```

碰巧当我得到非零返回码时，数据仍然被加载。如何确保命令成功与否？检查返回码似乎没有帮助。有时我再次加载相同的文件，因为我收到错误但数据已经在 bigquery 中可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:01:44.183

您可以使用加载作业的 bq show -j 并检查作业状态。如果您正在编写代码来执行加载，因此您不知道作业 id，您可以将作业 id 传递给加载操作（只要它是唯一的），这样您就会知道要检查哪个作业。

例如，您可以运行

`/home/bigquery/bq load --job_id=some_unique_job_id --max_bad_record=30000 -F '^' company.junelog entry.gz country:STRING,telco_name:STRING,datetime:STRING, ...'`

然后 `/home/bigquery/bq show --j some_unique_job_id`

请注意，如果您为每次加载创建新表（而不是追加），您可以使用写入处置 WRITE_EMPTY 来确保仅在表为空时才进行加载，从而防止两次添加相同的数据。这在 bq.py 中不直接支持，但您可以使用底层 bigquery_client.py 进行此调用，或直接使用 REST api。

# c# - 获取命名空间的所有静态成员

> ID：11017733
> 
> 赞同：3
> 
> 时间：2012-06-13T15:00:22.137
> 
> 标签：c#, reflection

我有一个带有静态成员的类。我想获取他们的类在命名空间“foo”中定义并从类“bar”继承的所有静态成员的列表

就像是`list x= typeof(this).staticmembers.where(namespace == "foo");`

尝试1：

```
 var AllowedTypes = GetType().Assembly.GetTypes()
       .Where(x => x.Namespace == "XX.XXX.XXX")
       .Where(x => x.IsAssignableFrom(typeof(UserControl)));

    var StaticMembersOfAllowedTypes = typeof(MainWindowXX).GetMembers  (System.Reflection.BindingFlags.Static ).Where(item => AllowedTypes.Contains(item)); 
```

这给了我一个成员信息列表，但我想要这些项目本身。

所以我可以将每个项目与另一个项目进行比较。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:05:18.853

我认为这会成功。可能有错别字，我无法测试

```
var list x = GetType().Assembly.GetTypes()
                    .Where(x => x.Namespace == "foo" && typeof(bar).IsAssignableFrom(x))
                    .SelectMany(x => x.GetMembers(BindingFlags.Static)); 
```

您可能需要添加`BindingFlags.Public`：

```
x.GetMembers(BindingFlags.Static | BindingFlags.Public) 
```

# ruby - 匹配一个 ID 然后注入新数据

> ID：11017735
> 
> 赞同：1
> 
> 时间：2012-06-13T15:00:26.060
> 
> 标签：ruby

我想我在Ruby中让自己非常困惑......

我有一个数组：

```
array1 = [["4b411f2bf964a52082c125e3", "The Three Pigeons", 51.236318, -0.57055], ["4b444648f964a52049f325e3", "The Royal Oak", 51.23555937678702, -0.5702378403809515], ["4b92c695f964a520aa1a34e3", "Slug And Lettuce", 51.237156, -0.571021], ["4b490136f964a520a56126e3", "The Robin Hood", 51.23603403568268, -0.568686], ["4b425f85f964a52092d225e3", "The Guildford Tup", 51.237734, -0.5703823], ["4b48f87ff964a520096026e3", "The Keep", 51.234704, -0.572574], ["4b426369f964a520e3d225e3", "The Five & Lime", 51.236908, -0.573695], ["4b56243af964a5204f0228e3", "The Albany", 51.23687122552597, -0.5666781994529876], ["4b426047f964a520a4d225e3", "The Kings Head", 51.234176, -0.573656], ["4b4261e4f964a520c6d225e3", "The Live and Let Live", 51.238477, -0.573306], ["4b425ec9f964a52086d225e3", "The Star Inn - Shepherd Neame", 51.23501026190194, -0.5749610066413879], ["4cb995490180721e03e09461", "Prince Albert", 51.242471, -0.572899], ["4e02726dc65b8061424b59f1", "Bar Mambo", 51.236896, -0.577263], ["4b7451e5f964a520fad42de3", "The Rodboro Buildings (Wetherspoon)", 51.236624141592365, -0.5775332450866699], ["4b6de739f964a520769a2ce3", "The White House", 51.23463575311113, -0.5773776769638062], ["4bb504a30ef1c9b6dbc2f412", "The Britannia - Shepherd Neame", 51.233105063438416, -0.5760687589645386], ["4b4447f8f964a5206cf325e3", "The George Abbot", 51.235186599066246, -0.5779409408569336], ["4b894378f964a520e72632e3", "The Boatman", 51.23155028087051, -0.572927], ["4bb475f449bdc9b65bcb0c10", "The Keystone", 51.23437208365849, -0.5779758095741272], ["4ba55291f964a5209afa38e3", "Rogues Bar", 51.23763173808256, -0.5610001087188721], ["4b40ce65f964a5205ebb25e3", "The Drummond", 51.24133950313797, -0.5758380889892578], ["4b48c8a8f964a520cb5626e3", "The Stok", 51.24272843225208, -0.5718989403261525], ["4c4f275651c2c9288af1859f", "The Parkway", 51.248229, -0.569356], ["4b48a60ff964a5208c5126e3", "The King's Head", 51.24666037427897, -0.5728936419289142], ["4b9a86c4f964a520f2bd35e3", "Ye Olde Ship Inn", 51.225673503520696, -0.5796146392822266], ["4c582015a7d976b0130cddee", "Wates House", 51.2420380341127, -0.5908584594726562], ["4b484917f964a520184b26e3", "The Rowbarge", 51.25055105804697, -0.5729025186239382], ["4bd86cb6e914a593c92f53fa", "The Wooden Bridge", 51.248547, -0.58514], ["4bd8b0442e6f0f4754240808", "The Seahorse", 51.218605041503906, -0.569018], ["4bb61c6bef159c74ff6b75f7", "The Astolat Public House", 51.23704061748392, -0.5893993377685547], ["4c978b274f16b71312c2ce3f", "The Queen Victoria", 51.21475338935852, -0.567119], ["4bb0eb08f964a520006a3ce3", "Anchor & Horseshoes", 51.254823, -0.548787], ["4c126e3c82a3c9b60ab0f9f8", "The Garage Tavern", 51.261162, -0.586647], ["4bed4208bac3c9b692fcfde9", "The Cricketers", 51.254246288978116, -0.6047425123927289], ["4b92cb0bf964a520501c34e3", "Horse & Groom", 51.24614672635736, -0.5279016494750977], ["4e8b7820be7b1b0656b1f927", "Apple Tree Pub", 51.2460676, -0.61427766], ["4dc58ce152b1e8f9f7d7378b", "Royal Oak", 51.248792, -0.626987], ["4c1a1c70838020a137aae661", "Withies Inn", 51.21199, -0.621551], ["4baded59f964a52031733be3", "The Jolly Farmer", 51.194106, -0.558244], ["4e21b6f052b1f82ffba120b5", "Compton Royal British Legion", 51.21349872454546, -0.6290990092597657], ["4b646071f964a52052ae2ae3", "The Jolly Farmer", 51.27866916930163, -0.5856227874755859], ["4d987f7961a3a1cd32aace42", "White Hart", 51.25011, -0.636736], ["4c8ccb34509e3704d9533655", "The Harrow Inn", 51.213387, -0.6316709518432617], ["4b71bb30f964a5200b592de3", "Bull's Head", 51.253260091783105, -0.5042177438735962], ["4f63b0b5e4b087553c2ae4fa", "The freeholders", 51.194189, -0.603889], ["4bc762a32f94d13aebd2117f", "The Cricketers", 51.194975, -0.608211], ["4be6c014bcef2d7f476805e5", "Worplesdon Place (Beef Eater Grill)", 51.27501810816803, -0.6078529357910156], ["4dbd63785da3ff58ec6192b1", "Scratchers", 51.19211, -0.60234], ["4e687a6bb3ad5d9197518ed6", "Three Lions - Shepherd Neame", 51.19198564344851, -0.6023865938186646], ["4c714ddcb5a5236acb995252", "The White heart Pub", 51.200254, -0.603593]] 
```

我将这些结果传递给对它们进行评分的 API。我得到的结果是一个包含大量哈希的数组。键是array1中的ID，值是分数

```
array2 = [{"4bed4208bac3c9b692fcfde9"=>743.0}, {"4e21b6f052b1f82ffba120b5"=>789.0}, {"4b646071f964a52052ae2ae3"=>921.0}, {"4bb504a30ef1c9b6dbc2f412"=>99.0}, {"4b426369f964a520e3d225e3"=>80.0}, {"4c4f275651c2c9288af1859f"=>254.0}, {"4b92cb0bf964a520501c34e3"=>468.0}, {"4b425f85f964a52092d225e3"=>27.0}, {"4bd86cb6e914a593c92f53fa"=>512.0}, {"4e687a6bb3ad5d9197518ed6"=>622.0}, {"4b4447f8f964a5206cf325e3"=>73.0}, {"4b425ec9f964a52086d225e3"=>26.0}, {"4b484917f964a520184b26e3"=>328.0}, {"4b426047f964a520a4d225e3"=>37.0}, {"4c978b274f16b71312c2ce3f"=>253.0}, {"4b6de739f964a520769a2ce3"=>81.0}, {"4b48c8a8f964a520cb5626e3"=>167.0}, {"4bb475f449bdc9b65bcb0c10"=>80.0}, {"4c126e3c82a3c9b60ab0f9f8"=>739.0}, {"4bd8b0442e6f0f4754240808"=>210.0}, {"4bb61c6bef159c74ff6b75f7"=>231.0}, {"4b56243af964a5204f0228e3"=>56.0}, {"4b411f2bf964a52082c125e3"=>0.0}, {"4b48a60ff964a5208c5126e3"=>211.0}, {"4baded59f964a52031733be3"=>514.0}, {"4b40ce65f964a5205ebb25e3"=>124.0}, {"4b444648f964a52049f325e3"=>81.0}, {"4bb0eb08f964a520006a3ce3"=>376.0}, {"4f63b0b5e4b087553c2ae4fa"=>586.0}, {"4b9a86c4f964a520f2bd35e3"=>192.0}, {"4cb995490180721e03e09461"=>125.0}, {"4dc58ce152b1e8f9f7d7378b"=>955.0}, {"4b92c695f964a520aa1a34e3"=>20.0}, {"4c582015a7d976b0130cddee"=>484.0}, {"4c8ccb34509e3704d9533655"=>743.0}, {"4b48f87ff964a520096026e3"=>48.0}, {"4c1a1c70838020a137aae661"=>640.0}, {"4b894378f964a520e72632e3"=>55.0}, {"4e8b7820be7b1b0656b1f927"=>666.0}, {"4e02726dc65b8061424b59f1"=>78.0}, {"4b4261e4f964a520c6d225e3"=>57.0}, {"4ba55291f964a5209afa38e3"=>77.0}, {"4c714ddcb5a5236acb995252"=>473.0}, {"4b7451e5f964a520fad42de3"=>80.0}, {"4b490136f964a520a56126e3"=>71.0}, {"4d987f7961a3a1cd32aace42"=>1008.0}, {"4dbd63785da3ff58ec6192b1"=>622.0}, {"4b71bb30f964a5200b592de3"=>640.0}, {"4be6c014bcef2d7f476805e5"=>1016.0}, {"4bc762a32f94d13aebd2117f"=>577.0}] 
```

我想最终得到一个新数组，其中包含数组 2 到数组 1 中匹配键的值，例如

```
["4c714ddcb5a5236acb995252", "The White heart Pub", 51.200254, -0.603593, 622] 
```

并非 array1 中的每个值都会得到分数，有些不会得到任何结果，因此它们根本不会在 array2 中返回。所以我需要通过 id("4c714ddcb5a5236acb995252") 匹配它们并检查它们是否存在然后匹配。array1 中数据的分数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:50:41.970

[`Array.assoc`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-assoc)这很好：

```
array2.each{|h|  array1.assoc(h.keys.first) << h.values.first}
p array1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:22:06.153

我会像这样`map`使用[Enumerable](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-map)：

```
array3 = array2.map do |item_from_array2|
  id = item_from_array2.keys[0]
  item_from_array1 = array1.find { |item| item.include?(id) }
  item_from_array1.dup << item_from_array2[id]
end 
```

在这里，我枚举了 in 中的项目，`array2`以便结果仅包含`array2`. 然后，我得到 id 并在`array1`其中搜索具有该 id 的数组。然后，将 array2 中的值添加到从 array1 中找到的项目的末尾。最后，`map`根据每个返回值创建一个数组。

作为性能考虑，您可能希望从可以按 id 索引的第一个数组创建一个哈希，因为调用`array1.find`每次迭代都会比使用`hash1[id]`每次迭代慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:38:18.837

由于这些应该是哈希，让我们将它们变成哈希：

```
h1 = array1.each_with_object({}) { |a, h| h[a.first] = a[1..-1] }
#=> {"4b411f2bf964a52082c125e3"=>["The Three Pigeons", 51.236318, -0.57055], ... }

h2 = array2.inject(:merge)
#=> {"4bed4208bac3c9b692fcfde9"=>743.0, ... } 
```

然后我们可以很容易地创建一个最终的哈希：

```
result = h2.each { |k, v| h1[k] << v }
#=> {"4b411f2bf964a52082c125e3"=>["The Three Pigeons", 51.236318, -0.57055, 0.0], ... } 
```

请注意，如果`h2`有一个`h1`还没有的键（或者，更具体地说，`h1`键的值不是数组），这将中断。

如果您*真的*希望在您提供的数组形式中使用它，您可以执行以下操作：

```
result = result.map { |k, v| v.unshift(k) }
#=> [["4b411f2bf964a52082c125e3", "The Three Pigeons", 51.236318, -0.57055, 0.0], ... ] 
```

# .net - 使用 ContentPresenter 自定义 UserControl，嵌套对象为空

> ID：11017743
> 
> 赞同：1
> 
> 时间：2012-06-13T15:00:41.590
> 
> 标签：.net, user-controls, contentpresenter, templatebinding, targetinvocationexception

我有一个自定义的 UserControl (CustomControl1)，用作 MainPage.xaml 中的数据容器。
作为 MainPage-CustomControl1 的内容，我放置了一些按钮。

我的错误/问题：
将显示按钮，但是当我尝试设置按钮属性时出现错误。
按钮对象将为空……。但为什么？
此外，当我在开发环境中单击嵌套对象时，不会从嵌套对象中引发任何事件。只有当我在 XAML 中选择嵌套对象时，我才能使用 [Object]->Properties->Events。

Silverlight 源：[带有 TemplateBinding 和错误的](http://dl.dropbox.com/u/76509861/SilverlightCustomControl%20Vers.6.zip)
[Vers.4 Vers.6](http://dl.dropbox.com/u/76509861/SilverlightCustomControl%20Vers.4.zip)

我必须改变什么？
我认为，这可能是我在 CustomControl1 中的 ContentPresenter 绑定错误。

我发现很多页面都存在这种问题......但我无法修复我的错误......

我的 CustomControl1.xaml：

```
<UserControl.Resources>
    <Style x:Key="roundBorderStyle" TargetType="Border">
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FF5F0E8E" Offset="0"/>
                    <GradientStop Color="#FFA6CEF0" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderThickness" Value="3"/>
        <Setter Property="BorderBrush" Value="#FF0F2048"/>
        <Setter Property="VerticalAlignment" Value="Stretch"/>
    </Style>
</UserControl.Resources>
<Border Width="Auto" Style="{StaticResource roundBorderStyle}">
    <Grid x:Name="LayoutRoot">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Height="Auto">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <sdk:Label x:Name="FrameCaption" Content="Caption" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Row="0" />
            <Button x:Name="OpenButton" Content="Click" Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,4,10,0" />
        </Grid>
        <ContentPresenter Grid.Row="1" x:Name="FrameContent" 
                            Content="{Binding NewContent, ElementName=userControl}"
                            Margin="4" Width="Auto" Height="Auto"/>
    </Grid>
</Border> 
```

我的 CustomControl1.xaml.cs：

```
 public UIElement NewContent
    {
        get { return (UIElement)GetValue(NewContentProperty); }
        set { SetValue(NewContentProperty, value); }
    }

    public static readonly DependencyProperty NewContentProperty =
        DependencyProperty.Register("NewContent", typeof(UIElement), typeof(CustomControl1), null);

    public string Button2Content
    {
        set
        {
            // On run time myButton2 and Button2 are null
            // Because LayoutRoot_Loaded isn't finished.
            ((Button)LayoutRoot.FindName("Button2")).Content = value;
        }
        get
        {
            return myButton2.Content.ToString();
        }
    }

    private void LayoutRoot_Loaded(object sender, RoutedEventArgs e)
    {
        //Next step would throw an error, because Button1 is null ... Why?
        //Button1.Content = "NewContent"; 
        //Maybe a problem with ContentPresenter binding in CustomControl1?

        // This works ... But a little complicated...
        myButton1 = (Button)LayoutRoot.FindName("Button1");
        myButton2 = (Button)LayoutRoot.FindName("Button2");
        myButton3 = (Button)LayoutRoot.FindName("Button3");
        //myButton1.Content = "NewContent";
    } 
```

我的 MainPage.xaml：

```
<my:CustomControl1 x:Name="LayoutRoot" Button2Content="New2Content" Loaded="LayoutRoot_Loaded">
    <StackPanel>
        <Button Content="Button 1" x:Name="Button1"/>
        <Button Content="Button 2" x:Name="Button2"/>
        <Button Content="Button 3" x:Name="Button3"/>
    </StackPanel>
</my:CustomControl1> 
```

# java - 在单元测试中找不到夹具@Before的mysql驱动程序

> ID：11017745
> 
> 赞同：0
> 
> 时间：2012-06-13T15:00:47.013
> 
> 标签：java, junit, database-connection, fixtures

伙计们。我有一个奇怪的问题。我尝试为 web-app 编写单元测试。我决定检查一些方法（查询）。这是一个工作应用程序。但是当我使用夹具@Before

```
@Before
    public void setUp() throws ConnectionException {   
        Connection connection = null;    
        ConnectionPool.init();            
        connection = ConnectionPool.getInstance().takeConnection();
} 
```

在 Class.forName(driver) 中初始化连接池时出现错误。

出现错误 ClassNotFoundException: com.mysql.jdbc.Driver

我不知道。也许有人知道原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:02:34.100

运行测试时，将 MySQL 连接器 JAR 添加到 CLASSPATH。

# c# - HTMLAgilityPack 使用 C# 解析 HTML 的问题

> ID：11017750
> 
> 赞同：3
> 
> 时间：2012-06-13T15:01:11.833
> 
> 标签：c#, xpath, html-agility-pack

我只是想了解 HTMLAgilityPack 和 XPath，我正在尝试从 NASDAQ 网站获取（HTML 链接）公司列表；

[http://www.nasdaq.com/quotes/nasdaq-100-stocks.aspx](http://www.nasdaq.com/quotes/nasdaq-100-stocks.aspx)

我目前有以下代码；

```
HtmlAgilityPack.HtmlDocument htmlDoc = new HtmlAgilityPack.HtmlDocument();

        // Create a request for the URL.        
        WebRequest request = WebRequest.Create("http://www.nasdaq.com/quotes/nasdaq-100-stocks.aspx");
        // Get the response.
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        // Get the stream containing content returned by the server.
        Stream dataStream = response.GetResponseStream();
        // Open the stream using a StreamReader for easy access.
        StreamReader reader = new StreamReader(dataStream);
        // Read the content.
        string responseFromServer = reader.ReadToEnd();
        // Read into a HTML store read for HAP
        htmlDoc.LoadHtml(responseFromServer);

        HtmlNodeCollection tl = htmlDoc.DocumentNode.SelectNodes("//*[@id='indu_table']/tbody/tr[*]/td/b/a");
        foreach (HtmlAgilityPack.HtmlNode node in tl)
        {
            Debug.Write(node.InnerText);
        }            

        // Cleanup the streams and the response.
        reader.Close();
        dataStream.Close();
        response.Close(); 
```

我使用 Chrome 的 XPath 插件来获取 XPath；

```
//*table[@id='indu_table']/tbody/tr[*]/td/b/a 
```

运行我的项目时，我收到一个关于它是无效令牌的 xpath 未处理异常。

我有点不确定它有什么问题，我试图在上面的 tr[*] 部分输入一个数字，但我仍然得到同样的错误。

我最近一个小时一直在看这个，这很简单吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T17:53:47.663

由于数据来自 javascript，您必须解析 javascript 而不是 html，因此 Agility Pack 并没有太大帮助，但它使事情变得更容易一些。以下是如何使用 Agility Pack 和[Newtonsoft JSON.Net](http://json.codeplex.com/)来解析 Javascript。

```
HtmlDocument htmlDoc = new HtmlDocument();
htmlDoc.Load(new WebClient().OpenRead("http://www.nasdaq.com/quotes/nasdaq-100-stocks.aspx"));
List<string> listStocks = new List<string>();
HtmlNode scriptNode = htmlDoc.DocumentNode.SelectSingleNode("//script[contains(text(),'var table_body =')]");
if (scriptNode != null)
{
  //Using Regex here to get just the array we're interested in...
  string stockArray = Regex.Match(scriptNode.InnerText, "table_body = (?<Array>\\[.+?\\]);").Groups["Array"].Value;
  JArray jArray = JArray.Parse(stockArray);
  foreach (JToken token in jArray.Children())
  {
    listStocks.Add("http://www.nasdaq.com/symbol/" + token.First.Value<string>().ToLower());
  }
} 
```

为了更详细地解释一下，数据来自页面上的一个大 javascript 数组`var table_body = [...`。每个股票都是数组中的一个元素，并且本身就是一个数组。

`["ATVI", "Activision Blizzard, Inc", 11.75, 0.06, 0.51, 3058125, 0.06, "N", "N"]`

因此，通过解析数组并获取第一个元素并附加修复 url，我们得到与 javascript 相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:11:21.000

为什么不直接使用`Descendants("a")`方法？它更简单，更面向对象。你只会得到一堆对象。您可以从这些对象中获取“href”属性。

示例代码：

```
htmlDoc.DocumentNode.Descendants("a").Attributes["href"].Value 
```

如果您只需要某个网页的链接列表，这种方法就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:24:56.357

如果您查看该 URL 的页面源，实际上并没有带有`id=indu_table`. 它似乎是动态生成的（即在 javascript 中）；直接从服务器加载时获得的 html 不会反映客户端脚本更改的任何内容。这可能是它不起作用的原因。

# .net - 匹配单个 CSS 属性的正则表达式

> ID：11017753
> 
> 赞同：5
> 
> 时间：2012-06-13T15:01:13.720
> 
> 标签：.net, css, regex

我目前有大量 HTML 文本，并且有几个类似于以下内容的 CSS 属性：

```
font:16px/normal Consolas;
font:16px/normal Arial;
font:12px/normal Courier; 
```

它还与其他几个 CSS 属性和其他相关的 HTML 值和标签捆绑在一起。

我一直在尝试编写一个只会抓取这些“字体样式”的正则表达式，所以如果我有以下两段：

```
<p style='font:16px/normal Arial; font-weight: x; color: y;'>Stack</p>
<span style='color: z; font:16px/normal Courier;'>Overflow</span>
<br />
<div style='font-family: Segoe UI; font-size: xx-large;'>Really large</div> 
```

它只会匹配`font:`以分号开头和结尾的属性`;`。

我玩过使用[RegexHero](http://regexhero.net/tester/)，我得到的最接近的是：

```
\b(?:font[\s*\\]*:[\s*\\]*?(\b.*\b);) 
```

结果如下：

```
font:bold;                   //Match
font:12pt/normal Arial;      //Match
font:16px/normal Consolas;   //Match
font:12pt/normal Arial;      //Match
property: value;             //Not a Match
property: value value value; //Not a Match 
```

但是当我尝试放入一大块 HTML 时，事情似乎变得混乱，并且选择了大块而不是在先前指定的范围内。

我很乐意提供任何其他信息和测试数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:13:03.463

**尝试这个**

```
\b((?:font:[^;]*?)(?:;|')) 
```

**解释**

```
\b             # Assert position at a word boundary
(              # Match the regular expression below and capture its match into backreference number 1
   (?:            # Match the regular expression below
      font:          # Match the characters “font:” literally
      [^;]           # Match any character that is NOT a “;”
         *?             # Between zero and unlimited times, as few times as possible, expanding as needed (lazy)
   )
   (?:            # Match the regular expression below
                     # Match either the regular expression below (attempting the next alternative only if this one fails)
         ;              # Match the character “;” literally
      |              # Or match regular expression number 2 below (the entire group fails if this one fails to match)
         &apos;              # Match the character “&amp;apos;” literally
   )
) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T15:10:13.433

你已经离开了`.*`贪婪，这意味着它会吃又吃，只会停在最后一个可用的分号处。添加一个问号，即使`.*?`其不贪婪。

**更新：**

```
 \b(?:font\s*?:\s*([^;>]*?)(?=[;">}])) 
```

我已经在[http://rubular.com/r/yRcED2n6wu测试](http://rubular.com/r/yRcED2n6wu)*了此页面上的每个示例*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T15:11:02.660

试试这个正则表达式：

```
(?:font:[^;]*); 
```

它与`font:16px/normal Arial;`您`font:16px/normal Courier;`上面的代码段相匹配。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-13T16:02:58.750

我建议：

```
\bfont\s*:\s*([^;}"'<>]+)(?<=\S) 
```

这也适用于其他答案失败的情况。例如：

```
.foo { font: sans-serif 80% }
... style="font: sans-serif 80%" ... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T15:11:00.117

我不太确定你在问什么，但我认为这个问题可以通过用 CSS 替换你的样式标签来解决。可以通过将以下内容放在 HTML 的 Head 标记中来解决该问题。

```
<style type="text/css">

h1 {

    font-family: Arial;
    font-size: 15;
    font-style:oblique;

}

h2 {
    font-family: Courier;
    font-size: 16;
    font-style:oblique;
 }
 h3 {
    font-family: Segoe UI;
    font-size: xx-large;
    font-style:oblique;
 }

</style> 
```

现在，要使表达式（或您自己）设置其中一种字体样式，您所要做的就是用这样的标签将其包围：

```
<h1> Cool Text!  </h1> 
```

祝你好运！

# objective-c - 使用单例类实现 iAd

> ID：11017759
> 
> 赞同：1
> 
> 时间：2012-06-13T15:01:33.303
> 
> 标签：objective-c, ios4, iad

我是 iPhone 开发的新手。我的目标是为 iAd 实现一个单例类，以便我在多个视图控制器上共享 iAd 的单个实例？

对实施方面的任何帮助将不胜感激？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T17:40:19.000

在您的 AppDelegate.h

```
@property (assign) YouiAdClass*iADObject    
+ (AppDelegate*) sharedApplication;
+ (YouriAdClass*)sharedAd 
```

在你的 AppDelegate.m

```
@synthesize iADObject

+ (AppDelegate*) sharedApplication
{
    return [[UIApplication sharedApplication] delegate];
}

+(YouriAdClass*)sharedAd
{
    if(iAdObject==nil){
          iADObject=[YouriAdClass new]
   }
   return iADObject;
} 
```

现在，当您想在任何地方获取您的对象时，只需调用

```
YouriADClass*iadObject=[[AppDelegate sharedApplication] sharedAd]; 
```

而且您将始终获得相同的指针。记得在头文件中导入 AppDelegate 和 YouriADClass。

# r - 模拟条件自连接以在 data.frame 中估算 NA

> ID：11017765
> 
> 赞同：1
> 
> 时间：2012-06-13T15:01:50.570
> 
> 标签：r

我有一个看起来像这样的数据框：

```
d <- data.frame(Vessel = c("Hondo", "Whamo", "Hondo", "Delta", "Whamo", "Hondo"),
            PAX = c(250, 252, 249, 353, 252, 250),
            crew = c(35, 63, 36, NA, NA, NA)) 
```

我想使用条件自连接之类的东西来估算 NA，如果框架中有另一行具有相同的 Vessel，它会根据相应的行更新船员值（如果有多个相应的行，它可以对船员值，选择最大/最小……这无关紧要，因为船员值不会发生巨大变化……如果没有相应的记录，它会按轮次（0.25 * PAX）更新船员。我有一种感觉ddply将是去这里的方式，我很抱歉无法自己解决这个问题......我无法解决这个问题。我希望最终的 data.frame 看起来像这样：

```
VESSEL     PAX     crew
Hondo      250       35
Whamo      252       63
Hondo      249       36
Delta      353       88
Whamo      254       63
Hondo      250       35 
```

注意：PAX 和 CREW 值可能会有所不同（CREW 变化很小），因此最后一个“Hondo”CREW 值可能是 35、36 或接近的值（但它应该基于查找而不是计算）。

提前致谢，--JT

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T23:33:35.463

这是使用基础 R 的解决方案：

```
transform(merge(d, aggregate(crew ~ ., d, mean), by=1:2, all.x=T, sort=F), 
          crew=ifelse(!is.na(crew.x), crew.x,
                      ifelse(!is.na(crew.y), crew.y, round(0.25 * PAX)))) 
```

请注意，平均值用于获取每个 Vesell/PAX 对的唯一值。这可能很容易`head(x, 1)`或其他。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T16:33:40.333

感谢 Joran 对我措辞不佳的问题的回答，我有一个解决方案，虽然是一个丑陋的解决方案......

```
library(plyr)
d <- data.frame(Vessel = c("Hondo", "Whamo", "Hondo", "Delta", "Whamo", "Hondo"),
            PAX = c(250, 252, 249, 353, 252, 250),
            crew = c(35, 63, 36, NA, NA, NA))
crewlookup <- ddply(subset(d, !is.na(d$crew)), .(Vessel),
                function(x) {
                  x[sample(nrow(x),size=1),]
                })
d2 <- join(d, crewlookup, by="Vessel")
colnames(d2)<-c("Vessel","PAX","crew","PAXl","crewl")
d2$crew <- ifelse(is.na(d2$crew),d2$crewl,d2$crew)
d2 <- within(d2, crew[is.na(crew)] <- round(.25 * PAX[is.na(crew)]) )
d <- subset(d2, select = c("Vessel", "PAX", "crew")) 
```

任何更优雅的东西都会受到赞赏。

# php - PHP XML 获取错误

> ID：11017769
> 
> 赞同：1
> 
> 时间：2012-06-13T15:01:56.470
> 
> 标签：php, xml, file, debugging, get

我编写了一个 PHP 应用程序（有效），并将其移至不同的目录。因此它需要从它上面的目录中获取一个文件，但该文件必须保持隐藏状态，即：

*   根
*   --配置
*   ---users.xml（权限 600）
*   --lib
*   ----loginUtil.php

我尝试了两种不同的获取文件的方法：

```
 $xml = file_get_contents("../config/users.xml");

 Which returns the following Error:

   [13-Jun-2012 08:54:04] PHP Warning:  file_get_contents(../config/users.xml) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: No such file or directory in public_html/test/lib/loginUtil.php on line 18 
```

和

```
 $xml = simplexml_load_file("../config/users.xml");

  which returns

    [13-Jun-2012 08:56:17] PHP Warning:  simplexml_load_file() [<a href='function.simplexml-load-file'>function.simplexml-load-file</a>]: I/O warning : failed to load external entity 
```

我已经尝试使用完整的 URL，这很有效，但是我必须公开 users.xml 文件（因为 PHP 正在执行 URL 请求）。

我可以做些什么来解决这个问题？（谢谢你的帮助）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:38:24.887

尝试设置完整路径而不是相对路径

```
$path = '/var/full/path_dir/file.xml';

if(!is_file($path)){

  // if this is the is output then you need to check permissions 
  // double check the file exists also.
  // check the web service can read the file
  echo "FILE NOT FOUND FOR $path";
}
else{
  $xml = file_get_contents($path);
  echo $xml;
} 
```

# android - Android SQLite 数据库被锁定

> ID：11017777
> 
> 赞同：4
> 
> 时间：2012-06-13T15:02:33.003
> 
> 标签：android, sqlite

我有一个运行多个线程的绑定服务，这些线程可以读取和写入 SQLite 数据库。我创建了我的数据库助手的一个实例，并在我的服务的 onCreate 中获得了与数据库的连接，该连接应该在主线程上执行。由于它是一项绑定服务，因此内存中应该只有一个服务实例。但是，当服务尝试打开数据库或其中一个线程尝试执行语句时，我仍然偶尔会遇到异常。

服务代码：

```
@Override
    public void onCreate() {
        super.onCreate();

        MyDatabaseHelper helper = new MyDatabaseHelper(this);
        database = helper.getWritableDatabase();
} 
```

例外：

```
java.lang.RuntimeException: Unable to create service uk.co.example.service.MyService: 
   android.database.sqlite.SQLiteException: unable to open database file
at android.app.ActivityThread.handleCreateService(ActivityThread.java:1959)
at android.app.ActivityThread.access$2500(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:989)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:123)
at android.app.ActivityThread.main(ActivityThread.java:3691)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
at dalvik.system.NativeStart.main(Native Method)
Caused by: android.database.sqlite.SQLiteException: unable to open database file
at android.database.sqlite.SQLiteDatabase.dbopen(Native Method)
at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1960)
at android.database.sqlite.SQLiteDatabase.openDatabase(SQLiteDatabase.java:887)
at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:965)
at android.database.sqlite.SQLiteDatabase.openOrCreateDatabase(SQLiteDatabase.java:958)
at android.app.ContextImpl.openOrCreateDatabase(ContextImpl.java:585)
at android.content.ContextWrapper.openOrCreateDatabase(ContextWrapper.java:203)
at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:118)
at uk.co.example.service.MyService.onCreate(MyService.java:69)
at android.app.ActivityThread.handleCreateService(ActivityThread.java:1949)
... 10 more

android.database.sqlite.SQLiteException: error code 5: database is locked
at android.database.sqlite.SQLiteStatement.native_execute(Native Method)
at android.database.sqlite.SQLiteStatement.execute(SQLiteStatement.java:61)
at uk.co.example.a.a.a.a(MyTable.java:147)
at uk.co.example.service.b.a.m.run(MySaveTask.java:84)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019) 
```

有什么想法可能导致这种情况吗？

谢谢

大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T14:30:47.047

Sqlite 现在支持一种名为 Writing-Ahead Logging 的新日志模式，适用于对 sqlite 的并发访问。你可能想看看[http://www.sqlite.org/wal.html](http://www.sqlite.org/wal.html)。

# derby - 比较 Derby 中的时间戳和日期

> ID：11017780
> 
> 赞同：2
> 
> 时间：2012-06-13T15:02:36.160
> 
> 标签：derby

我需要比较 SELECT 查询中的日期和时间戳。通常，大多数其他 DB 平台（MySQL、MSSQL、Oracle 等）都支持此功能，但在 Derby 中会引发此错误：

> 原因：java.sql.SQLSyntaxErrorException：不支持“DATE”和“TIMESTAMP”之间的比较。类型必须具有可比性。字符串类型也必须有匹配的排序规则。如果排序规则不匹配，一个可能的解决方案是将操作数强制转换为默认排序规则（例如 SELECT tablename FROM sys.systables WHERE CAST(tablename AS VARCHAR(128)) = 'T1')

我不想使用 CAST，因为我无法更改 SQL 查询。这是来自 Derby 的错误，会在某个时候得到修复吗？我目前正在使用 Derby 10.8.2.2。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T09:27:18.860

如果您从 Java 程序连接，您可以使用各种 getxxx() 方法获取时间戳的特定部分（这些实际上是从 Java.util.date 继承的）

请参阅文档[http://docs.oracle.com/javase/7/docs/api/java/util/Date.html](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)

并检查 getDate(), getDay() getHour().... 方法

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-14T01:17:15.843

Perhaps you can define a VIEW on one of the tables, and include the CAST in the VIEW. That way, you don't have to change the actual query; it will go against the view, and thus include the cast in that way.

# javascript - 如何在绑定事件期间排除元素

> ID：11017784
> 
> 赞同：1
> 
> 时间：2012-06-13T15:02:44.940
> 
> 标签：javascript, jquery, dhtml

当迭代如下所示的表单元素集合时，是否可以忽略一个元素？我注意到在某种情况下，表单会生成一个唯一的文本字段，这会导致问题。我正在使用 jquery 1.3.2

[http://jsfiddle.net/ewWaF/](http://jsfiddle.net/ewWaF/)

如果您删除 newfield1 和 newfield2 它可以从上面的链接中使用。

非常感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:05:27.917

您可以将`:not()`选择器添加到您的选择中：

```
$('.PassengerWrapper input[type=text]:not(selector), .PassengerWrapper select') 
```

或者之后过滤掉：

```
$('.PassengerWrapper input[type=text], .PassengerWrapper select')
    .not("selector") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:08:19.663

如果要保留选择并将绑定应用于子集，则应在绑定链之前尝试 jQuery 的[过滤器](http://api.jquery.com/filter/)api。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:11:26.403

由于这些字段是 display:none 您可以使用 .not() 和 :hidden 选择器进行过滤

```
$('.PassengerWrapper input[type=text], .PassengerWrapper select').not(":hidden") 
```

这是您的小提琴的更新

[http://jsfiddle.net/ewWaF/2/](http://jsfiddle.net/ewWaF/2/)

# javascript - 如何从标签标签中获取名称？

> ID：11017787
> 
> 赞同：-1
> 
> 时间：2012-06-13T15:02:55.593
> 
> 标签：javascript, jquery, html

我有一个示例代码：

```
<ul>
   <li>
      <input type="checkbox" value="" name="" id="" class="chk"> Test    
         <ul>
            <li>
              <input type="checkbox" value="1" name="modem_id[]" id="input_1" class="chk1"><label>Test 1</label>
           </li>
           <li>
              <input type="checkbox" value="2" name="modem_id[]" id="input_2" class="chk1" checked="checked"><label>Test 2</label>
          </li>
       </ul>
   </li>
</ul> 
```

和jQuery

```
jQuery('.chk').click(function(){
   if (jQuery(this).is(':checked')) {
      jQuery(this).parent().find('input:checkbox').attr('checked', true);
         var val_id = [];
         var val_name = [];
         jQuery('input:checkbox[id^=input_]:checked').each(function(i){
            val_id[i] = jQuery(this).val();
            val_name[i] = jQuery(this).parent().val();
            alert(val_id, val_name);
         });
      }
}); 
```

我得到了 val_id，但 val_name 是错误的，如何从中获取名称

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:10:33.270

如果您试图在输入复选框旁边的标签标签内获取文本，请尝试更改：`val_name[i] = jQuery(this).parent().val();`

对此

```
val_name[i] = jQuery(this).parent().find('label').html(); 
```

不知道这是否是你想要做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:07:14.297

jQuery(this).attr("name");

应该得到当前复选框的名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:08:24.823

尝试：

```
jQuery('.chk').click(function(){
   if (jQuery(this).is(':checked')) {
      jQuery(this).parent().find('input:checkbox').attr('checked', true);
         var val_id = [];
         var val_name = [];
         jQuery('input:checkbox[id^=input_]:checked').each(function(i){
            val_id[i] = jQuery(this).val();
            val_name[i] = jQuery(this).attr("name");// i change this line
            console.log(val_id, val_name);// alert() will not show array, see console
         });
      }
});​ 
```

**演示**：http: [//jsfiddle.net/2SNQb/](http://jsfiddle.net/2SNQb/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T15:22:01.160

```
var val = [];
var name = [];
jQuery('input:checkbox[id^=input_modem_]:checked').each(function(i){
    val[i] = jQuery(this).val();
        name[i] = jQuery(this).parent().find('label').html();
});
for(var k=0; k<val.length; k++) {
    // working this alert
    alert(val[k]); // alert(name[k])    
} 
```

# c# - WPF 网格验证

> ID：11017788
> 
> 赞同：1
> 
> 时间：2012-06-13T15:02:57.617
> 
> 标签：c#, wpf

我有可编辑的网格，它绑定在`GridRow`（自定义类，描述的网格行）的集合上。 `GridRow`有属性`Parameter` `(int)`，应该由用户编辑。如此简单的验证工作正常：我无法在此字段中插入“文本”或其他内容。但我需要在整个网格上进行验证。在网格上的列`Parameter`中只能有一个符号'1'，两个'2'，三个'3'，两个'5'。因此，例如，如果我已经插入网格值“1,2,3”并尝试插入“1”，应用程序应该向我显示验证消息。我尝试用 来做到这一点`IDataErrorInfo`，但我无法进入整张桌子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:06:40.580

也许您会对我的一篇关于[在 MVVM 中验证业务规则](http://rachel53461.wordpress.com/2012/01/22/validating-business-rules-in-mvvm/)的博客文章感兴趣？

它允许您从 ViewModel 附加模型验证代码，并且应该让您完成您想要做的事情。

```
public class GridViewModel
{
    // Kept this generic to reduce code here, but it
    // should be a full property with PropertyChange notification
    public ObservableCollection<GridRowModel> GridRows{ get; set; }

    public UsersViewModel()
    {
        GridRows = GetGridRows();

        // Add the validation delegate to the UserModels
        foreach(var row in GridRows)
            user.AddValidationErrorDelegate(ValidateGridRow);
    }

    // User Validation Delegate to verify UserName is unique
    private string ValidateGridRow(object sender, string propertyName)
    {
        if (propertyName == "Parameter")
        {
            var row = (GridRow)sender;
            var existingCount = GridRows.Count(p => 
                p.Parameter == row.Parameter && p != row);

            switch(row.Parameter)
            {
                case 1:
                    if (existingCount >= 0)
                        return string.Format("{0}s are already taken", row.Parameter);
                case 2: case 5:
                    if (existingCount >= 1)
                        return string.Format("{0}s are already taken", row.Parameter);
                case 3:
                    if (existingCount >= 2)
                        return string.Format("{0}s are already taken", row.Parameter);
             }
        }
        return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T06:44:19.723

我解决了订阅“CellVaildate”事件的问题。

# asp.net - 按周分组，每周的每一天都有列

> ID：11017794
> 
> 赞同：0
> 
> 时间：2012-06-13T15:03:17.200
> 
> 标签：asp.net, crystal-reports, crosstab

我正在尝试为我的 asp.net 应用程序创建一个报告，该报告将显示每个项目的数量以及每周每天订购的单位。星期几是列。

更具体地说：我有两个表，一个是 Orders 表，其中包含订单 ID、客户名称、日期等...第二个表是 OrderItems，该表具有订单 ID 作为外键、订单项目 ID、项目名称、单位（exp: each, box, case）、数量和价格。

当用户在我的 asp 页面上为报告选择一个日期范围时，例如从 2012 年 3 月 2 日到 2012 年 4 月 2 日，报告将按周对订单项进行分组，如下所示：

```
**week (1) starting from sunday of such date to saturday of such date**

item | unit | Sun | Mon  | Tues | Wedn | Thur | Fri | Sat | Total Price for week

item1 | bag |  3  |   0  | 12   | 8    |  45  | 1   | 4   | $1234
item4 | box |  2  |   4  |  5   | 0    |   5  | 2   | 6   | $1234

**week (2) starting from sunday of such date to saturday of such date**

item | unit | Sun | Mon  | Tues | Wedn | Thur | Fri | Sat | Total Price for week

item1 | bag |  3  |   0  | 12   | 8    |  45  | 1   | 4   | $1234
item4 | box |  2  |   4  |  5   | 0    |   5  | 2   | 6   | $2354

**week (2) starting from sunday of such date to saturday of such date**

item | unit | Sun | Mon  | Tues | Wedn | Thur | Fri | Sat | Total Price for week

item1 | bag |  3  |   0  | 12   | 8    |  45  | 1   | 4   | $1234
item4 | box |  2  |   4  |  5   | 0    |   5  | 2   | 6   | $2354 
```

我希望我能有一些东西来表明我已经开始了，但是水晶不是我的强项，我什至不知道从哪里开始解决这个问题。我确实知道如何传递参数和我自己在将其传递给报告之前预先过滤的数据表。例如，按日期范围和客户或订单 ID 过滤项目。

任何帮助将非常感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T23:13:01.033

为一周中的每一天创建一个总计订单的公式。

即周日数量：

```
if dayOfWeek(dateField) = 'Sun'
then order.quantity
else 0 
```

将每天的公式添加到报告的详细信息部分，然后针对每个组级别进行汇总。要按周分组，只需按日期字段分组，然后将分组选项设置为按周。抑制细节，你会得到你正在寻找的东西。

*   我不记得 dayOfWeek 函数的确切名称，但它是这样的。

# android - 使用库更新应用程序后小部件消失

> ID：11017798
> 
> 赞同：4
> 
> 时间：2012-06-13T15:03:23.537
> 
> 标签：android, android-widget

我有 2 个版本的应用程序，免费和付费，但一直在单独维护代码。我终于将代码移动到两者都引用的库中，以便更轻松地维护代码。

我发现更改`AppwidgetProvider`导致启动器删除任何现有小部件，因此我将这些类移出库以保持提供者相同，因此用户不必重新创建他们的小部件。启动器不再删除小部件，而是在更新后根本不会出现。

如果我`AppWidgetManager.getAppWidgetIds`像往常一样调用组件名称，appwidgetid 仍然存在。appwidgetprovider 和服务仍然被调用来更新小部件，并且`/data/system/appwidgets.xml`仍然显示小部件，但启动器从不显示它。

并不是说它是不可见的，因为长按小部件位置会调出壁纸选择器。我可以很好地创建新的小部件，但我不想让用户重新创建他们的小部件来让他们感到沮丧。日志不显示启动器或`AppwidgetService`.

任何想法为什么小部件在更新后停止渲染？它在某种程度上与将大部分代码移动到单独的库中有关。谢谢！

编辑：我正在模拟器上进行测试，API 级别 15，股票启动器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:13:40.103

好的，我找到了解决方案，但我对此感到恶心......

在阅读了清单中声明的​​类如何永远不会更改后，我将清单中的每个类创建为应用程序中的一个类，扩展库中的相应类。然后，我必须使用 forName 更改每个 Intent 以包含正确的类。因此，这种情况的一个示例是：

应用程序包：com.sample.package

活动：我的活动

库：com.sample.package.core

活动：我的活动

应用程序中有一个 MyActivity，库中有一个 MyActivity。应用程序中的 MyActivity 只是扩展了 com.sample.package.core.MyActivity。

那么，任何发生...

```
new Intent(context, MyActivity.class) 
```

...在图书馆必须成为...

```
new Intent(context, Class.forName(context.getPackageName() + "." + MyActivity.class.getSimpleName()); 
```

如果有办法通过清单做到这一点，请告诉我！

# sql-server - sql azure 初学者 - 一个简单的插入语句出现错误

> ID：11017800
> 
> 赞同：2
> 
> 时间：2012-06-13T15:03:26.067
> 
> 标签：sql-server, azure-sql-database

我正在尝试将一行数据插入到 SQL Azure 中的表中——

这是插入语句——

```
INSERT INTO cloud_storage_credentials (cloud_provider,api_key, api_secret)
VALUES("Rackspace", "<random_value>", "<random_value>"); 
```

但是我收到以下错误-

```
Msg 207, Level 16, State 1, Line 2
Invalid column name 'Rackspace'.
Msg 207, Level 16, State 1, Line 2
Invalid column name '<random_value>'.
Msg 207, Level 16, State 1, Line 2
Invalid column name '<random_value>'. 
```

我在这里做错了什么？我按照 SQL Server 教程编写了上述查询......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:06:13.000

将`"`（双引号）更改为`'`（勾号/单引号）

```
INSERT INTO cloud_storage_credentials (cloud_provider,api_key, api_secret)
VALUES('Rackspace', '<random_value>', '<random_value>'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:07:03.393

`"`用s改变你的`'`s。事实上，它认为您插入的值是列的名称。

# rest - 如何使用具有连接池和基本身份验证的 REST 客户端？

> ID：11017801
> 
> 赞同：2
> 
> 时间：2012-06-13T15:03:26.733
> 
> 标签：rest, client, jersey, connection-pooling, basic-authentication

我目前有：

*   作为单独的应用程序运行的 REST API (Jersey)
*   作为 REST API 客户端的 GUI 应用程序 (JSF)

我想知道从 GUI 应用程序与 REST API 对话的最佳方式是什么。REST API 是无状态的，但 GUI 应用程序是有状态的，并且必须通过每个 REST 请求传递身份验证信息（**基本身份验证**）。因为我们必须同时支持数百个用户，所以我们想配置我们的 Jersey 客户端以进行**连接池**。

我们可以通过使用 Apache 的 HTTP 客户端配置 Jersey 客户端来处理连接池。可以使用 HTTPBasicAuthFilter 来处理身份验证，它会自动为每个请求发送相同的凭据。

**但是，我不确定最好为整个 GUI 应用程序配置 1 个客户端，还是为每个会话创建一个新客户端。**

**对于应用程序的 1 个客户端**，连接池是有意义的，但是我必须找到一种方法来为每个请求设置正确的身份验证信息。HTTPBasicAuthFilter 假定凭据永远不会更改，我们的应用程序并非如此。

如果我**为每个会话创建一个带有新 HTTPBasicAuthFilter 的客户端**，那么身份验证是微不足道的，但我没有从连接池中获得任何好处，因为每个客户端都有自己的池。

我怀疑我是第一个遇到这个问题的人，所以我很好奇其他人是如何解决这个问题的。

亲切的问候，

格伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:47:31.917

您可以在 WebResource 级别附加客户端过滤器。因此，您可以拥有将 HTTPBasicAuthFilter 附加到的单个共享客户端和每个会话的 WebResource 对象。

# entity-framework-4 - 如何首先在实体框架代码中将具有 2 个主键的纯连接表建模到另一个具有 3 个主键的纯连接表

> ID：11017810
> 
> 赞同：2
> 
> 时间：2012-06-13T15:03:40.777
> 
> 标签：entity-framework-4, entity-framework-4.1, ef-code-first, code-first, entity-relationship

如何使用代码首先对具有三个主键的另一个纯连接表的纯连接进行建模？

示例代码：

```
public class ItemA
{
    public int ItemAId { get; set; }
    public string Name { get; set; }
    public ICollection<ItemB> ItemBs { get; set; }
}

public class ItemB
{
    public int ItemBId { get; set; }
    public string Name { get; set; }
    public ICollection<ItemA> ItemAs { get; set; }
    public ICollection<ItemC> ItemCs { get; set; }
}

public class ItemC
{
    public int ItemCId { get; set; }
    public String Name { get; set; }
    public ICollection<ItemB> ItemBs { get; set; }
}

public class TestDbContext : DbContext
{
    public DbSet<ItemA> ItemA { get; set; }
    public DbSet<ItemB> ItemB { get; set; }
    public DbSet<ItemC> ItemC { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    }

} 
```

EF 为 ( and ) 创建了一个连接表，为 ( `ItemC`and `ItemB`) 创建了另一个连接表`ItemB`，`ItemA`我想连接（创建关系）到另一个连接表，该连接表具有类似 ( `ItemA`, `ItemB`, `ItemC`) 的内容，即链接`ItemA`,`ItemB`和`ItemC`在一起。

如何使用三个主键（、、、）创建与另一个表的关系/`ItemA`映射`Itemb`连接`ItemC`？

另外，这个表真的是一个需要自己的类以便 Entity Framework 可以创建第三个表的实体吗？（我想避免为只有主键的东西创建类，例如，创建一个名为的类`ItemAItemBItemC`，它只有主键。）

# javascript - 模型绑定器未拾取表单编码的 Javascript int[]

> ID：11017811
> 
> 赞同：3
> 
> 时间：2012-06-13T15:03:45.713
> 
> 标签：javascript, jquery, asp.net-mvc, asp.net-mvc-4

昨晚我试图整理自 MVC2 以来我一直在工作的东西。

给定以下课程：

```
public class RouteSaveViewModel
{
    public string Title { get; set; }
    public string Comments { get; set; }
    public string DepartureDate { get; set; }
    public string ArrivalDate { get; set; }
    public List<int> LocationIds { get; set; }
} 
```

...以及以下操作：

```
 [HttpPost]
    public ViewResult SaveRoute(RouteSaveViewModel route)
    {
        // yada yada
        return SomethingShiny();
    } 
```

我想使用 $.ajax 或 $.post 传递数据。该表单是从用户那里收集数据并提交的多步骤。我用来构建位置 ID 的代码是这样的：

```
 var routeStopIds = [];
        $(".route-stop").each(function(){
            routeStopIds.push($(this).attr('data-id'));
        }); 
```

我已经通过浏览器内的开发工具和提琴手验证了我期望的 id 在这个数组中。最后，为了提交数据，我正在绘制对象，就像我在以前的 MVC 构建中所做的那样：

```
 $.ajax({
            type: 'post',
            url: postUrl,
            data: {
                Title: $("#route-title").val(),
                Comments: $("#route-description").val(),
                DepartureDate: depDate,
                ArrivalDate: arrDate,
                LocationIds: routeStopIds                    
            },
            dataType: 'JSON'
        }); 
```

我看到的是*所有*数据 - 除了`LocationIds`参数之外的所有数据都已填充。我还尝试仅将数组提交给仅接受 a并且似乎也不起作用`routeStopIds`的修改后的数组。无论哪种方式，都为空，尽管请求的表单参数中有一个表单编码值。`SaveRoute``List<int>``LocationIds`

```
{LocationIds%5b%5d=44&LocationIds%5b%5d=4&LocationIds%5b%5d=2} 
```

...然而 HttpValueCollection 只是`LocationIds[]`一个空数组。

那么，我是否遗漏了一些明显的东西？也许不那么明显？如何让模型绑定获取数组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:03:46.090

还记得我说过我从 MVC2 开始就让它工作的那部分吗？是的，就是在这里： [高级模型绑定](http://theycallmemrjames.blogspot.ca/2010/05/aspnet-mvc-and-jquery-part-4-advanced.html) 在那篇文章中我明确提到了以下内容：

> 注意：为了使数组的结果与 ASP.NET MVC（如 MVC 2.0）中的绑定机制兼容，我们需要使用 $.ajax() 中的“传统”设置。

修改 ajax 调用以包含此设置是解决方法。一切都像雨和柔软的羊毛小猫一样。或者手套什么的。

```
 $.ajax({
            type: 'post',
            url: postUrl,
            traditional: true, // <----- here be kittens
            data: {

                Title: $("#route-title").val(),
                Comments: $("#route-description").val(),
                DepartureDate: depDate,
                ArrivalDate: arrDate,
                LocationIds: routeStopIds 
            },
            dataType: 'JSON'
        }); 
```

# sql-server-2008 - 动态 sql 中的 GUID

> ID：11017817
> 
> 赞同：1
> 
> 时间：2012-06-13T15:03:53.157
> 
> 标签：sql-server-2008, tsql

我正在尝试在动态 SQL 中使用 uniqueidentifier 类型的列。

我有一个表 X，列 ID 类型为 guid。

如果我做：

```
declare @primarykeyvalue varchar(50)  
set @primarykeyvalue = '648D2DD7-0EB1-4E29-A996-69456753C460'  

select * from X where ID = @primarykeyvalue 
```

这可行，但如果我尝试在动态 SQL 中执行相同的操作，例如：

```
DECLARE @sql NVARCHAR(1000)   
SET @sql = 'select * from X where ID = ' + @primarykeyvalue  
EXECUTE(@sql) 
```

这会导致语法错误，因为“D2DD7”附近的语法不正确。

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:08:05.953

将您的代码更改为：

```
DECLARE @sql NVARCHAR(1000)   
SET @sql = 'select * from X where ID = ''' + @primarykeyvalue + ''''  
EXECUTE(@sql) 
```

也许你应该考虑使用`sp_executesql`：

```
DECLARE @sql NVARCHAR(1000)   
SET @sql = 'select * from X where ID = @key'  

EXECUTE sp_executesql @sql, N'@key nvarchar(50)', @key = @primarykeyvalue 
```

这使您能够在查询中使用参数并摆脱令人讨厌的双引号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T15:07:33.907

您需要在 GUID 值周围加上额外的引号：

```
DECLARE @sql NVARCHAR(1000)   
SET @sql = 'select * from X where ID = ''' + @primarykeyvalue + ''''

EXECUTE(@sql) 
```

# java - 在 Java 中，如何在新的 JTab 切换到之前捕获事件？

> ID：11017825
> 
> 赞同：2
> 
> 时间：2012-06-13T15:04:17.267
> 
> 标签：java, swing, focus, jtabbedpane

在切换到新选项卡之前如何捕获事件？在每个选项卡中，我都有 JTable，我对它的数据做了一些事情（删除、添加、更新）。我想在切换到新标签之前进行数据验证（保存或取消更改）。我使用 Java 1.5。

```
class ViewPanel extends JPanel 
  {

    private void Components() {
    setPreferredSize(new Dimension(700, 400));

    tabbedPane.addTab("DC", ANSFER.getIcon(),new DcTabPanel(this), "DC");
    tabbedPane.addTab("PC", THUMB4.getIcon(),new PcTabPanel(this), "PC");

    tabbedPane.addChangeListener(this);
    add(tabbedPane);
     }

     public void stateChanged(ChangeEvent e) {

     }

   } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:14:40.850

[JTabbedPane](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTabbedPane.html)由[SingleSelectionModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/SingleSelectionModel.html)支持。如果您扩展[DefaultSingleSelectionModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/DefaultSingleSelectionModel.html)，您可以覆盖 setSelectedIndex 方法并实现您的逻辑。

```
// in new selection model:
public void setSelectedIndex(int index) {
    // do pre-switch things here
    super.setSelectedIndex(index);
}

// in ViewPanel, on tabbedPane create:
tabbedPane.setModel(newSelectionModel); 
```

您不能简单地使用 ChangeListener 的原因是因为它会触发*change*。通过扩展选择模型，您可以在选项卡更改*之前触发。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T15:27:19.680

您可以通过扩展 JTabbedPane 和 override 来防止选项卡切换`setSelectedIndex(int)`。这是一个说明这一点的小例子。它只是防止在非连续选项卡之间切换：

```
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTabbedPane;
import javax.swing.SwingUtilities;

public class Test2 {
    private static class BlockingTabbedPane extends JTabbedPane {

        public static interface TabSwitchAllower {
            public boolean allowTabSwitch(int from, int to);
        }

        private TabSwitchAllower allower;

        public BlockingTabbedPane(TabSwitchAllower allower) {
            super();
            this.allower = allower;
        }

        @Override
        public void setSelectedIndex(int index) {
            if (allower == null || allower.allowTabSwitch(getSelectedIndex(), index)) {
                super.setSelectedIndex(index);
            }
        }

    }

    protected static void initUI() {
        final JFrame frame = new JFrame("test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        BlockingTabbedPane.TabSwitchAllower allower = new BlockingTabbedPane.TabSwitchAllower() {

            @Override
            public boolean allowTabSwitch(int from, int to) {
                if (Math.abs(from - to) == 1) {
                    return true;
                } else {
                    JOptionPane.showMessageDialog(frame, "You can only switch between contiguous tabs");
                }
                return false;
            }
        };
        JTabbedPane tabbedPane = new BlockingTabbedPane(allower);
        for (int i = 0; i < 10; i++) {
            tabbedPane.addTab("Tab-" + i, new JLabel("Hello tab " + i));
        }
        frame.add(tabbedPane);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                initUI();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T15:27:42.777

[选项卡上的 java actionlistener](https://stackoverflow.com/questions/4443559/java-actionlistener-on-a-tab)

[如何编写更改侦听器（Oracle 文档）](http://docs.oracle.com/javase/tutorial/uiswing/events/changelistener.html)

[JTabbedPane API（Oracle 文档）](http://docs.oracle.com/javase/1.5.0/docs/api/javax/swing/JTabbedPane.html)

这两个链接应该可以帮助您。我还没有真正使用过 tabbedPanes，但我假设`getSelectedComponent()`它将返回当前选定的选项卡。因此，您可以处理`currentTab`将在实例化期间设置的。然后你可以有这样的东西。

```
class TabListener implements ChangeListener {
    public void stateChanged(ChangeEvent e) {

        // Replace JSlider with whatever your tab's data type is
        JSlider source = (JSlider)e.getSource();

        // Use the 'currentTab' handle to do what you want.

        currentTab = getSelectedComponent();
        // I'm assuming that the 'selected component' by the time this stuff
        // runs is going to be the new selected tab.
    }
} 
```

我对我的回答*不太*有信心，但我当然希望这能为您指明正确的方向！如果您需要任何澄清或任何事情，请说！如果我碰巧发现任何我认为可能有用的东西，我一定会编辑我的答案！

# java - 如何使此语句返回正确数量的实体

> ID：11017827
> 
> 赞同：1
> 
> 时间：2012-06-13T15:04:24.077
> 
> 标签：java, hibernate

因为我是 Hibernate 和 DB 设计的新手，所以我使用了一些剩余的代码。我有以下声明：

```
totalItems = ((Number) criteria.setProjection(Projections.rowCount()).
                    uniqueResult()).intValue();
criteria.setProjection(null);
criteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
criteria.addOrder(Order.desc("id")); 
```

它适用于几乎所有实体，除了具有多对多关系的特定实体。就我而言，它`Nominations<-->Nominee<-->Employee`在数据库中。在我的 bean 中，提名有一个员工列表来映射关系。

基本上`totalItems`是返回提名人数而不是提名人数。例如，有 2 名被提名人的提名计为 2，而不是 1。

我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:10:42.187

好的，我想通了。我改变了这个

```
totalItems = ((Number) criteria.setProjection(Projections.rowCount()).
                uniqueResult()).intValue(); 
```

有了这个

```
totalItems = ((Number) criteria.setProjection(Projections.countDistinct("id")).
                uniqueResult()).intValue(); 
```

基本上它现在计数不同。

# ruby-on-rails-3.1 - Rails 3 STI 负载派生的部分

> ID：11017829
> 
> 赞同：4
> 
> 时间：2012-06-13T15:04:33.023
> 
> 标签：ruby-on-rails-3.1, single-table-inheritance

好的，所以我想做的是在父类中有一个模板，在默认模板中加载一个部分。那个部分虽然应该特定于派生类。

```
def class DataItem < ActiveRecord::Base
  def value
    # do something fancy here
  end
end

def class FooDataItem < DataItem
  def value
    "foo"
  end
end

def class BarDataItem < DataItem
  def value
    "bar"
  end
end 
```

然后，我们有以下视图结构：

*   app/views/data_item/index.html.erb
*   应用程序/视图/data_item/_col_info.html.erb
*   app/views/foo_data_item/_col_info.html.erb
*   应用程序/视图/bar_data_item/_col_info.html.erb

在 index.html.erb 我们有这样的东西：

```
<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <% @dataItems.each do |item| %>
    <tr>
      <td><%= render :partial, item + "/col_info", :locals => { :item => item } %>
      <td><%= item.value %>
    </tr>
    <% end %>
  </tbody>
</table> 
```

所以，我知道我可以只为 item 对象加载一个部分，但我是一个不只是对象的部分，而是一个子部分。

一种选择是在views/data_item/_col_info.html.erb 中创建一个只有一个if/else 块的单个部分，然后加载一个单独的部分，但我希望有一种更简洁的方法来使用STI。

另请注意，我不能使用 item.type 作为生成路径的一种方式，因为我在视图目录结构中有下划线（类型将是 foodataitem，但我需要 foo_data_item）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:59:31.413

我意识到你不能单独使用类的名称来生成路径，但你可以这样做：

```
item.class.name.underscore 
```

那会更方便，然后必须`template_path`为每个类添加一个方法。[underscore 方法](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-underscore)来自 ActiveRecord，它将您的驼峰类名称转换为正确的格式。

# c# - 以编程方式获取 nUnit 选择的类别

> ID：11017830
> 
> 赞同：6
> 
> 时间：2012-06-13T15:04:34.530
> 
> 标签：c#, nunit

有没有办法在执行测试时以编程方式获取选定的测试类别？TestContext.Properties["_SELECTCATEGORIES"] 行中的某些内容

基本上我有从数据库加载测试数据的测试用例，因为我有很多测试项目需要很长时间才能加载。如果未选择类别，我试图找到一种让 testCaseSources 不返回任何内容的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:39:44.667

**更新**

似乎没有任何直接的方法可以在*NUnit 框架*本身的 NUnit 测试程序集中识别或加载所选类别。

使用反射，您也许可以扫描用or`Categories`装饰的类中的属性。通过将这些类别与您要加载的类别相匹配，您可以在加载之前过滤掉要加载的测试。`TestAttribute``TestFixtureAttribute`

然后是`TestContext.Test.Properties`密钥`_CATEGORIES`（在 NUnit 2.5.7 及更高版本中可用）：

```
[Test]
[Category("Hello")]
public void TestCategory()
{
  Assert.IsTrue(((ArrayList)TestContext.CurrentContext.Test.Properties["_CATEGORIES"]).Contains("Hello"));
} 
```

`TestContext`可以在[此处](https://github.com/nunit/docs/wiki/TestContext)找到有关该课程的更多内容。当然，用这种方法解决问题需要您预先加载整个测试程序集并循环所有测试用例，这在您的场景中显然是不可取的。

# ios - 关闭 UIWebView 后保持会话

> ID：11017831
> 
> 赞同：1
> 
> 时间：2012-06-13T15:04:35.983
> 
> 标签：ios, uiwebview, asihttprequest, hybrid

我有一个具有登录页面的应用程序驻留在应用程序服务器上。所以我打开一个 UIWebView 来处理登录。之后我想切换到 UIView 并使用 ASIHttp 库进行 API 调用（其他可能也可以接受）。问题是; 在我登录服务器后保留会话对象以进行身份​​验证，因此当我关闭 UIWebView 并切换到 UIView 并进行 API 调用时，它会失败。我相信，不知何故，我需要在 API 调用中维护会话对象（登录后设置）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T18:55:06.583

以下是我遵循的步骤：

*   `NSHTTPCookieStorage`使用类提取 UIWebView 中的 cookie 。
*   `ASIHTTPRequest` `setRequestCookies:`使用后续调用的方法将其发回

# linux - Linux内核模块内存访问权限

> ID：11017832
> 
> 赞同：0
> 
> 时间：2012-06-13T15:04:36.950
> 
> 标签：linux, permissions, driver, kernel-module

我有一个我的应用程序正在使用的驱动程序。该驱动程序用于 PCIe 设备，由内核对象 .ko 文件和 API 库组成。安装 .ko 后，它会为硬件创建一个 /dev/mydevice 文件。

我能够以 root 身份运行应用程序，但不能以低用户身份运行。我为我的用户将 /dev/mydevice 的权限设置为 rwx，这允许我打开设备，但是当我调用 API 函数来分配 IO 缓冲区时。api 返回一个 NULL 指针。

内核模块驱动程序的安全权限是如何确定的？当我将 .ko 文件加载到内核中以声明这些权限时，我需要做些什么。

谢谢。

# c# - List.clear 内存问题

> ID：11017833
> 
> 赞同：4
> 
> 时间：2012-06-13T15:04:38.123
> 
> 标签：c#, list, memory, memory-management

我有一个程序可以处理一堆包含许多列的 csv 文件，以便用户可以拉出特定的列并将它们写入另一个更小的 csv 文件，并且只包含他们需要的内容。由于最多可以有 800 万行，因此我使用列表创建了一个队列系统，它将片段（一次 50000 行）添加到列表缓冲区，以便编写者可以写入该片段，然后用于`listbuffer[i].clear();`删除它，这样我使用的内存要少得多，并且还将缓冲区限制为仅包含 10 个项目，从而使总内存使用量保持在我需要的最低水平。

我的问题是，`listbuffer[i].clear();`直到整个程序完成并且我重新初始化了缓冲区，以便下次使用时它是空白的，它才会释放它以前使用的内存。

**listbuffer 是一个`List<List<List<string>>>`

只是让这更有意义......

listbuffer[行块][行#][列#]

有没有办法告诉列表释放`list[i]`正在使用的内存？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T15:24:44.643

是的， using`List<T>.Clear()`清除对列表中所有对象的引用并将`Count`属性设置为**0**。它不会*释放*对存储对象引用的底层数组的引用。您可以在清除后将容量属性设置为 0 以释放对该数组的引用。

如果您确实有 OOM 问题，那么这样做并不能完全解决问题，它会产生*更多的*地址空间碎片问题。检查[此答案](https://stackoverflow.com/questions/2247773/is-it-worthwhile-to-initialize-the-collection-size-of-a-listt-if-its-size-rea/2248188#2248188)以获取有关如何避免在大对象堆中创建过多垃圾的提示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-16T21:45:30.553

也许为时已晚，但我写了这个扩展来从大列表中清除内存。

它对我有用，我希望它有所帮助。

**延期：**

```
public static void LiberarLista<T>(this List<T> lista)
{
     lista.Clear();            
     int identificador = GC.GetGeneration(lista);
     GC.Collect(identificador, GCCollectionMode.Forced);
} 
```

**例子：**

```
List<YourObject> hugeList= LetsRockBigData();

// Your code logic here 
// Finish... Let's clear the huge list 

hugeList.LiberarLista(); 
```

我很抱歉我不是英语专家。只有一个来自巴西的 DotNerd，这就是所有人……

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2019-10-25T14:27:01.847

您必须清除列表，然后调用 GC 将其从内存中删除。用广泛的方法如下：

```
public static void ClearMemory<T>(this List<T> lista)
    {
        int identificador = GC.GetGeneration(lista);
        lista.Clear();
        GC.Collect(identificador, GCCollectionMode.Forced);
    } 
```

# iphone - UITableViewCell 中的 UILabel 直到单元格位于屏幕顶部才绘制

> ID：11017834
> 
> 赞同：0
> 
> 时间：2012-06-13T15:04:41.120
> 
> 标签：iphone, objective-c, ios, ios5

我对 UITableViewCell 中的 UILabel 有奇怪的问题。直到我拉下屏幕以使 UITableViewCell 位于顶部时它才会出现。这是该问题的视频。

[http://youtu.be/apTJd1Y4RZk](http://youtu.be/apTJd1Y4RZk)

这是创建单元格时的代码。

```
 TVC_Location_View_Text *cell = (TVC_Location_View_Text *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {

        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"TVC_Location_View_Text" owner:nil options: nil];

        for(id currentObject in topLevelObjects) {
            if([currentObject isKindOfClass:[UITableViewCell class]]) {
                cell = ((TVC_Location_View_Text *) currentObject);
                break;
            }

        }

    }

    UIFont *cellFont = [UIFont fontWithName:@"Helvetica" size:15.0];
    CGSize constraintSize = CGSizeMake(300.0f, MAXFLOAT);
    CGSize labelSize = [self.sLocationText sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];
    CGRect rect = CGRectMake(10, 10,  labelSize.width, labelSize.height);

    UILabel* labelText = [[UILabel alloc] initWithFrame:rect];
    [labelText setFont:cellFont];
    [labelText setLineBreakMode:UILineBreakModeWordWrap];
    [labelText setNumberOfLines:0];
    [labelText setBackgroundColor:[UIColor clearColor]];
    [labelText setTextColor:appDelegate.colorDarkText];

    [cell addSubview:labelText];

    [labelText setText:self.sLocationText];

    return cell; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:14:07.737

UILabel 的创建应该在单元格本身的创建中这是一个问题，我不知道它是否会解决您的错误，但它仍然是一个错误，请将您的代码更改为

```
TVC_Location_View_Text *cell = (TVC_Location_View_Text *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
UILabel* labelText;
if (cell == nil) {

    NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"TVC_Location_View_Text" owner:nil options: nil];

    for(id currentObject in topLevelObjects) {
        if([currentObject isKindOfClass:[UITableViewCell class]]) {
            cell = ((TVC_Location_View_Text *) currentObject);
            break;
        }

    }

    labelText = [[UILabel alloc] initWithFrame:rect];
    [labelText setFont:cellFont];
    [labelText setLineBreakMode:UILineBreakModeWordWrap];
    [labelText setNumberOfLines:0];
    [labelText setBackgroundColor:[UIColor clearColor]];
    [labelText setTextColor:appDelegate.colorDarkText];
    labelText.tag = 111;
    [cell addSubview:labelText];
}

labelText = (UILabel*)[cell viewWithTag:111];

UIFont *cellFont = [UIFont fontWithName:@"Helvetica" size:15.0];
CGSize constraintSize = CGSizeMake(300.0f, MAXFLOAT);
CGSize labelSize = [self.sLocationText sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];
CGRect rect = CGRectMake(10, 10,  labelSize.width, labelSize.height);

[labelText setText:self.sLocationText];

return cell; 
```

试试这个代码，看看它是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:54:14.777

```
You should use -[UITableViewDelegate willDisplayCell:forRowAtIndexPath:] delegate method.

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
TVC_Location_View_Text *cell = (TVC_Location_View_Text *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
UILabel* labelText;
    if (cell == nil) 
    {

        NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"TVC_Location_View_Text" owner:nil options: nil];

        for(id currentObject in topLevelObjects)
        {
                if([currentObject isKindOfClass:[UITableViewCell class]])
            {
                  cell = ((TVC_Location_View_Text *) currentObject);
                   break;
                }

        }

     labelText = [[UILabel alloc] initWithFrame:rect];
     [labelText setFont:cellFont];
     [labelText setLineBreakMode:UILineBreakModeWordWrap];
     [labelText setNumberOfLines:0];
     [labelText setBackgroundColor:[UIColor clearColor]];
     [labelText setTextColor:appDelegate.colorDarkText];
     labelText.tag = 111;
     [cell addSubview:labelText];
    }
    return cell;
}

- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    UILabel* labelText = (UILabel*)[cell viewWithTag:111];

    UIFont *cellFont = [UIFont fontWithName:@"Helvetica" size:15.0];
    CGSize constraintSize = CGSizeMake(300.0f, MAXFLOAT);
    CGSize labelSize = [self.sLocationText sizeWithFont:cellFont constrainedToSize:constraintSize lineBreakMode:UILineBreakModeWordWrap];
    CGRect rect = CGRectMake(10, 10,  labelSize.width, labelSize.height);

    [labelText setText:self.sLocationText];
} 
```

# java-me - J2ME推送注册表启动权限

> ID：11017835
> 
> 赞同：2
> 
> 时间：2012-06-13T15:04:48.147
> 
> 标签：java-me, permissions, push, midp, autostart

我制作了一个使用 Push Registry 的应用程序。当我尝试应用程序时，由于权限，它无法正常工作。然后我发现如果我签署申请，我就可以`always allow`选择。

但是，当我在 Samsung Omnia2 i8910 上签名后尝试应用程序时，我单击始终允许，然后出现一个警报，说它将更改为仅适用于本次会话。有人知道这是为什么吗？或者我该如何解决这个问题？

注意：我使用 Java 验证的 R&D 签名，当我尝试在诺基亚 5800 上加载时，由于证书错误而无法加载。我不知道我做错了什么。我可以加载到三星。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T08:35:21.467

经过一番研究，我找到了一篇关于这个问题的文章。由于 j2me 安全策略，会出现此问题。J2ME 不允许设置总是允许自动启动权限和网络访问。而这不能通过签署申请来完成。文章说权限是互斥的。

“此外，应用程序自动调用的一揽子设置和网络访问的一揽子设置是互斥的。此约束是为了防止 MIDlet 套件自动调用自身，然后在用户不知情的情况下访问收费网络。如果用户尝试当另一个功能组已经处于“Blanket”模式时，将应用程序自动调用或网络功能组设置为“Blanket”，必须提示用户两个功能组中的哪一个应被授予“Blanket”，哪个功能组应被授予“会话”。

参考：http: [//jcp.org/aboutJava/communityprocess/maintenance/jsr118/MIDP_2.0.1_MR_addendum.pdf](http://jcp.org/aboutJava/communityprocess/maintenance/jsr118/MIDP_2.0.1_MR_addendum.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T18:17:08.690

> 注意：我使用 Java 验证的 R&D 签名，当我尝试在诺基亚 5800 上加载时，由于证书错误而无法加载。我不知道我做错了什么。我可以加载到三星。

R&D 签名的 midlet 应该在具有回滚日期的设备上运行，因为 R&D 证书是从签名之日起过去 7 天内提供的。例如：签约日期为19.08.2012，工作时间为12.08.2012至18.08.2012

# mysql - 选择有限制的平均值

> ID：11017836
> 
> 赞同：0
> 
> 时间：2012-06-13T15:05:00.050
> 
> 标签：mysql, average

我有几个 SQL 语句可以计算存储过程中的平均值：

```
SELECT AVG(x) INTO _5dayaverage FROM (SELECT x FROM my_data ORDER BY create_date DESC LIMIT 5) AS temptable;
SELECT AVG(x) INTO _10dayaverage FROM (SELECT x FROM my_data ORDER BY create_date DESC LIMIT 10) AS temptable; 
```

是否可以以我只执行一次 SELECT 而不是使用派生表的方式编写这些？由于我需要计算 5、10、20、28、30、35 和 50 天的平均值，是否可以在单个查询中完成所有这些操作，而不是一遍又一遍地执行 SELECT？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:10:05.313

您可以使用`ROW_NUMBER()`公用表表达式。假设您使用的是 SQL Server 2005+

```
WITH Numbered AS (
SELECT ROW_NUMBER() OVER(ORDER BY create_date DESC) AS RowNum,
   X
FROM my_data)

SELECT AVG(CASE WHEN RowNum <= 5 THEN X ELSE NULL END) AS _5_Day_Avg,
   AVG(CASE WHEN RowNum <= 10 THEN X ELSE NULL END) AS _10_Day_Avg
FROM Numbered 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-13T15:36:35.473

您需要使用递增变量来获取 MySQL 中的行号：

```
SELECT  AVG(CASE WHEN RowNumber <= 5 THEN X END) AS Avg_5,
        AVG(CASE WHEN RowNumber <= 10 THEN X END) AS Avg_10,
        AVG(CASE WHEN RowNumber <= 15 THEN X END) AS Avg_15,
        AVG(CASE WHEN RowNumber <= 20 THEN X END) AS Avg_20,
        AVG(CASE WHEN RowNumber <= 25 THEN X END) AS Avg_25,
        AVG(CASE WHEN RowNumber <= 30 THEN X END) AS Avg_30,
        AVG(CASE WHEN RowNumber <= 35 THEN X END) AS Avg_35
FROM    (   SELECT  @i:= @i + 1 AS RowNumber, x
            FROM    My_Data,
                    (SELECT @i:=0) AS i
            ORDER BY Create_Date DESC
        ) AS Data 
```

[http://sqlfiddle.com/#!2/7a250/1](http://sqlfiddle.com/#!2/7a250/1)

# git - Git新分支然后回滚到以前的版本

> ID：11017838
> 
> 赞同：2
> 
> 时间：2012-06-13T15:05:03.530
> 
> 标签：git

我有几个不同的分支，包括我的主分支。我想从 master 创建一个新分支，如果我错了，我认为可以这样做纠正我。

```
git branch masterDup
git checkout masterDup 
```

然后我想将 masterDup 分支回滚到旧版本。这可以在不影响主分支或任何其他分支的情况下完成吗？所以只有 masterDup 会被回滚。如果是这样，我将如何仅为这个新创建的分支使用提交 ID 回滚。

我的日志历史记录中有提交 ID。提交 6f041c1e37bb97aab35678d35c8923fabe33c8d2c

我正在为我的 git 命令使用终端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:07:30.517

当然，你签出一个新的分支

```
git checkout -b masterDup 
```

然后您将其重置为早期版本

```
git reset --hard HEAD~x 
```

其中 x 是 x 版本（如果您愿意，也可以使用散列）

编辑了这个答案，见评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:07:54.457

新分店结帐后

```
git reset --hard 6f041c1e37bb97aab35678d35c8923fabe33c8d2c 
```

# php - mysql更新语法中的columname可以是变量吗？

> ID：11017840
> 
> 赞同：0
> 
> 时间：2012-06-13T15:05:11.547
> 
> 标签：php, mysql, syntax

我想更新表中的任何列值。如果我回显 $q 它会获取变量，但它不会更新并且不会回显 mysql 错误。那么我该怎么做呢？

```
 function up($name, $value, $id){     

 $q='UPDATE Table SET '.$name.'='.$value.' WHERE ID="'.$id.'"';
     $r=mysql_query($q, $conn);
     if(!$r){
     echo('Could not update data: ' . mysql_error());
   } else{ echo "Updated data successfully\n"; } 
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:06:36.357

该变量`$q`在发送到 MySQL 之前被解释，因此您可以让列名和其他所有内容在运行时保持动态。该字符串的最终值是 MySQL 将看到的。

如果您的行没有更新并且您没有收到错误，那么您的查询在某种程度上是不正确的。确保 WHERE 子句中的所有条件都是正确的。查看您的行是否受到影响的更好方法是使用[`mysql_affected_rows()`](http://us.php.net/manual/en/function.mysql-affected-rows.php).

```
else{ echo "Updated data successfully\n"; } 
```

应该

```
else if(mysql_affected_rows() !== 0){ echo "Updated data successfully\n"; } 
```

仅供参考，您应该考虑从 mysql_* 函数迁移，因为[它们很快就会消失。](https://chat.stackoverflow.com/transcript/message/3656047#3656047)

# html - 全屏插件

> ID：11017846
> 
> 赞同：1
> 
> 时间：2012-06-13T15:05:31.567
> 
> 标签：html, object, firebreath, browser-plugin

我正试图围绕如何说服浏览器让我访问浏览器点击中的所有可用房地产。我知道我用 html 对象标签加载了我的插件。在那个标签中，我会给出我的插件窗口的宽度和高度。

所以我的问题是：为整个浏览器选项卡重新创建插件窗口的常用程序是什么？我并不是真的在寻找完整的全屏访问，但也很高兴知道。

我使用 Firebreath 作为我的插件框架。

谢谢，克里斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T17:16:40.387

虽然可能有在页内执行该操作的[解决方法](http://webdesignerwall.com/tutorials/css-elastic-videos)（我自己不确定），但您可能正在寻找[整页插件](https://developer.mozilla.org/en/Gecko_Plugin_API_Reference/Plug-in_Basics#Plug-in_display_modes)。

进入全屏模式（例如 Flash 和游戏引擎插件）是您必须自己实现的，并且您有必要访问本地 API 来执行此操作。

# c - OpenMP：锁定对单个数组元素的访问？

> ID：11017851
> 
> 赞同：5
> 
> 时间：2012-06-13T15:05:38.990
> 
> 标签：c, openmp

我对 OpenMP 还很陌生，所以这可能有一个简单的答案，但我一直没能找到它。

假设我有以下 C 代码并希望使用 OpenMP 将其并行化。A 是一个对象数组，其中一些 double 值小于 1 buckets 是一个链表数组，并且 append 将一个指向对象的指针添加到链表的末尾。

```
#pragma omp for 
for (i = 0; i < n; ++i) {
    x = (int) (A[i].val * NUM_BUCKETS);
    append(&A[i], buckets[x]);
} 
```

问题是多个线程可能试图一次将项目附加到给定的存储桶。我可以使附加语句变得至关重要。但是，在我的应用程序中，我可能会有大约 1000 个桶，因此大部分时间线程将在不同的桶上运行。

有没有办法对存储桶的各个元素强制执行锁定？或者其他一些处理方式？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-14T00:26:07.013

好吧，OpenMP 不能自动为您做这件事，但它可以让您创建自己的锁定变量，您可以使用这些变量来限制对数组元素的访问；例如，每个数组元素可以有一个锁：

```
#include <stdio.h>
#include <omp.h>

int main(int argc, char **argv)
{
    const int NITEMS=20;
    int array[NITEMS];
    omp_lock_t lock[NITEMS];

    for (int i=0; i<NITEMS; i++)
        omp_init_lock(&(lock[i]));

#pragma omp parallel for shared(array, lock) default(none)
     for (int i=0; i<NITEMS; i++) {
        int tid = omp_get_thread_num();
        int item = (i * 7) % NITEMS;

        omp_set_lock(&(lock[item]));
        array[item] = tid;    // only one thread in here at a time; others block at set_lock()
        omp_unset_lock(&(lock[item]));
    }

    for (int i=0; i<NITEMS; i++)
        printf("%3d ", array[i]);
    printf("\n");

    for (int i=0; i<NITEMS; i++)
        omp_destroy_lock(&(lock[i]));

    return 0;
} 
```

或者，如果该粒度级别超出您的需要，您可以阻塞数组的区域等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T17:52:16.417

OpenMP 不提供细粒度锁定。您可以准备新的列表元素，例如通过将其`next`指针设置为`NULL`并使用`atomic`来保护列表尾指针的更新。这与当前的 OpenMP 实现一样好。

当然，由于 OpenMP 使用底层操作系统线程原语，您可以使用后者提供的任何锁定，例如，`pthreads`为每个存储桶使用一组互斥锁。缺点是它创建了不可移植的应用程序，但如果效率更重要，您可能愿意牺牲可移植性。

# asp.net - VB.net 数据库连接上的空引用

> ID：11017856
> 
> 赞同：0
> 
> 时间：2012-06-13T15:05:49.993
> 
> 标签：asp.net, sql-server, vb.net

我知道我在这里是个白痴，我就是搞不定。但我正在尝试从 vb.net 数据库中取回一些数据。它因对象引用未设置为对象错误的实例而崩溃。在代码运行之前，它说在设置变量之前正在使用该变量，但我不知道如何。代码：

```
 Private taNotifications As dsDataTableAdapters.NotificationsTableAdapter = New dsDataTableAdapters.NotificationsTableAdapter 

   Dim notification As dsData.NotificationsDataTable = taNotifications.GetDataByClientID(userrow.UserID)

                If notification.Rows.Count > 0 Then

                    Dim notificationrow As dsData.NotificationsRow
                    Dim forwardURL As String = notificationrow.ForwardLocation

                End If 
```

它倒在`Dim forwardURL As String = notificationrow.ForwardLocation`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:07:57.437

问题是您从未在 if 语句中实例化 notificationRow。你已经声明了它，但它不属于任何东西。在对该对象执行任何操作之前，您需要进行分配或循环遍历您的行：

```
Dim notificationrow As dsData.NotificationsRow ' this is not instantiated
Dim forwardURL As String = notificationrow.ForwardLocation 
```

在这种情况下，您真正​​想要的是：

```
For Each notificationRow As dsData.NotificationRow In notification

    Dim forwardURL As String = notificationRow.ForwardLocation        
    ' Do Something

Next 
```

如果您只有一行并且您知道您只有 1 或 0 行，那么您可以通过执行以下操作来使用您的 if 语句：

```
If notification.Rows.Count > 0 Then

    Dim notificationrow As dsData.NotificationsRow = _
        CType(notification.Rows(0), dsData.NotificationsRow)

    Dim forwardURL As String = notificationrow.ForwardLocation

End If 
```

编辑：在上面的代码中，我最初只有`notification.Rows(0)`. 这将产生一个 DataRow 对象，但它不会是强类型的。您需要执行`CType`我添加的操作才能使用自定义属性`ForwardLocation`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:08:04.483

你从来没有设置`notificationrow`任何东西。你的意思是这样设置吗？

```
Dim notificationrow As dsData.NotificationsRow = CType(notification.Rows(0), dsData.NotificationsRow) 
```

# php - while(list = each) 在 ajax 请求中不能为 $_GET 正常工作？

> ID：11017857
> 
> 赞同：1
> 
> 时间：2012-06-13T15:05:54.630
> 
> 标签：php, ajax, get, while-loop, each

好的，这是我从 js 文件中调用的代码：（是的，我知道它是 PHP 代码；我的网站将 js 文件作为 php 处理，带有 .htaccess，然后将适当的内容类型标头发送到浏览器以最后处理 IE content-type: application/javascript)

```
<?php
if (count($_GET)>0) {
    print_r($_GET);
    while(list($key, $value) = each($_GET)) {
        echo $key." - ".$value."\n";
        }
    } else {
    echo "alert('no get?');";
    }
?> 
```

我的问题是这样的：

它正确地从 print_r 输出数组，即：

```
 Array
    (
    [name%3A1] => 
    [call_id] => 0
    [_] => 1339598074533
    ) 
```

但是，它拒绝使用`while(list($key, $index) = each($_GET))`

任何想法为什么我不能通过`$_GET`var？也许我打错了什么？ajax 请求发送到的 url 是： http: [//preview.tinyurl.com/bnpe8fe](http://preview.tinyurl.com/bnpe8fe)

此外，似乎每次我使用 post 作为类型，而不是 get，它都没有正确发送 post 数据（它根本不发送）；有没有办法将`POST`数据与 ajax 请求一起使用到 js 文件而不是 js 文件`GET`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:08:30.570

为什么不使用`foreach`？例如

```
foreach ($_GET as $key => $value) {
    ...
} 
```

[PHP foreach](http://www.php.net/manual/en/control-structures.foreach.php)

# backbone.js - 带主干样板的下划线模板，正确的做法，或者有更好的模板方法

> ID：11017859
> 
> 赞同：3
> 
> 时间：2012-06-13T15:06:02.550
> 
> 标签：backbone.js, underscore.js

好的，我正在玩 Backbone、node.js、Underscore、Backbone Boilerplate，所以我有足够的知识。一直在疯狂地问问题，因为我仍然无法完全理解它。我目前正在尝试将[Underscore](http://underscorejs.org/)库与[Backbone Boilerplate](https://github.com/tbranyen/backbone-boilerplate)一起使用来制作一个非常简单的模板，该模板将允许我传入数据；然后当模型更新时，更改将更改模板的视图。我相信这是正确的做法，而不是在我的 JS 文件中编写 HTML 代码？如果我错了就阻止我。

Backbone Boilerplate 有`.fetch()`我理解的模板系统。然而，我相信这意味着在我的 JS 中编写 HTML。所以我想使用下划线简单地将信息从模型传递到视图到模块以再次渲染模板（或者我可以完全跳过视图？）。

我的问题是为什么这不起作用，我认为这是因为我没有将其更改为 JSON。

我的 HTML 模板：

```
<div>
    <script id="rtemp" type="text/x-underscore-template">
        <span><%= title %></span>
    </script>​
</div> 
```

和 JavaScript：

```
define([
  // Global application context.
  "app",

  // Third-party libraries.
  "backbone",
  "underscore",
  "json2"
],

function(app, Backbone) {
  var Attempt = app.module();

  Attempt.Model = Backbone.Model.extend({});
  Attempt.Collection = Backbone.Model.extend({});

  Attempt.Views.Tutorial = Backbone.View.extend ({
    template: "app/templates/attempt",
    render: function(done) {
      var tmpl = app.fetchTemplate(this.template);
      //console.info(tmpl);
      this.$el.html(tmpl({title: 'This is a title'}))
    }
  });

  return Attempt;
}); 
```

当我检查它显示的元素时，`<div>`它周围仍然有模板脚本标签，因此不会在 HTML 页面上显示。我尝试`json2`先将其转换为 JSON，但除非我做错了什么，否则这似乎不起作用。下划线是最好用的东西吗？我假设它是一个主干依赖项。或者我应该使用别的东西。我只是想避免在我的 JS 中编写 HTML。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T17:50:49.003

如果我理解正确，您最终会得到这个 HTML：

```
<div>
    <script id="rtemp" type="text/x-underscore-template">
        <span>This is a title</span>
    </script>​
</div> 
```

这是基于您正在使用的代码的正确行为，但这显然不是您想要的结果。

当`<script>`您将模板嵌入 HTML 页面时，将使用模板包装器。这样做是为了让浏览器不会尝试将您的模板解释为 HTML，并防止浏览器尝试自行呈现它。在这种情况下，您可以将模板嵌入到 HTML 页面中，如下所示：

```
<!-- Some HTML stuff... -->
<script id="rtemp" type="text/x-underscore-template">
    <span><%= title %></span>
</script>​
<!-- Some other HTML stuff... --> 
```

你会像这样使用它：

```
var t    = _.template($('#rtemp').html());
var html = t(...) 
```

该`$('#rtemp').html()`部分仅提取模板`<script>`包装器的内容，因此`_.template`只会看到`<span><%= title %></span>`，最终处理的模板将只是一个简单的`<span>`. 例如：http: [//jsfiddle.net/ambiguous/dzPzC/](http://jsfiddle.net/ambiguous/dzPzC/)

在您的情况下，您正在阅读整个`<div><script>...</script></div>`模板并将其提供给`_.template`. 结果是`tmpl({title: 'This is a title'})`仍然包含`<script>`，浏览器不知道如何处理 a`<script type="text/x-underscore-template">`所以`<span>`你感兴趣的根本不会被渲染。

您根本不需要`<script>`包装器，仅当您在某些 HTML 中嵌入原始模板时才需要包装器。您的模板只需要您的内容`<script>`：

```
<span><%= title %></span> 
```

演示：http: [//jsfiddle.net/ambiguous/QuwSX/](http://jsfiddle.net/ambiguous/QuwSX/)

您传递给模板函数的参数：

```
tmpl({ title: '...' }) 
```

没关系，编译后的模板函数只想看到一个 JavaScript 对象。人们谈论传递 JSON 并经常使用该`toJSON`方法为模板准备数据，但这是对术语的滥用；模板确实需要一个对象，而 JSON 在技术上是一个字符串。

# silverlight - 如何在 Silverlight 数据网格中使一个特定的列可编辑

> ID：11017861
> 
> 赞同：0
> 
> 时间：2012-06-13T15:06:04.893
> 
> 标签：silverlight

我正在开发 Silverlight 业务应用程序。在这里，我在 Silverlight 子窗口中填充数据网格。现在我面临的问题是我的数据网格有四列，但我只将其中一列设为可编辑，其余三列应保持只读。

我怎样才能实现它。我可以使整个数据网格可编辑，但不能编辑一个特定的列。请注意，这些列当前是自动生成的。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T19:23:51.670

如果您事先定义列的名称，这将容易得多，并且只需要 xaml 代码

```
<data:Datagrid x:Name="Grid11" AutoGenerateColumns="False" ColumnWidth="*" SelectionMode="Single" >
            <data:DataGrid.Columns>
                <data:DataGridTextColumn Header="Index" IsReadOnly="True" Binding="{Binding LocalIndex}" />
                <data:DataGridTextColumn Header="ID" IsReadOnly="True" Binding="{Binding Id}" />
                <data:DataGridTextColumn Header="Name" Binding="{Binding Name, ValidatesOnNotifyDataErrors=True, NotifyOnValidationError=True, Mode=TwoWay}"  >
            </data:DataGrid.Columns>
</data:SolacomDatagrid> 
```

在上面的示例中，名称列是可编辑的，但其他 2 列是只读的。请注意，我正在使用绑定，因此对于您背后的代码，您可能不需要更改任何内容，您只需替换绑定的属性即可。

**编辑**

```
 foreach (DataGridColumn item in DataGrid.Columns)
                {
                       //if(column name condition of column id)
                    item.IsReadOnly = true;
                } 
```

此循环应允许您将所有列设置为只读。我个人会在 DataGrid Loaded 事件中执行此事件，因为如果太早完成，您的列将不存在。

希望这可以帮助，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T19:38:59.960

如果您不想更改 XAML，可以将[Editable](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.editableattribute%28v=vs.95%29.aspx)属性添加到对象的属性中。

# python - Pyodbc 数字的默认类型

> ID：11017862
> 
> 赞同：2
> 
> 时间：2012-06-13T15:06:07.243
> 
> 标签：python, sql-server, types, pyodbc, pandas

我正在使用 pyodbc 从 SQL Server 查询数据，然后在`pandas`. 我注意到的是，一些计算出来的数字列以十进制返回。十进制，而另一些则以浮点数形式返回。这是有问题的，因为算术操作数不能对两种不同类型的结果执行。

解决它的最佳方法是什么？是否有 pydobc 设置强制十进制。十进制浮动？我应该自己进行转换吗？还有什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T12:34:23.700

[下面](https://code.google.com/p/pyodbc/wiki/DataTypes#Results)是转换表（在`Results`Python 2.x 和 3.x 的标题下）详细说明了 ODBC 和 Python 数据类型之间的转换。

@Aaron`CAST`的答案中提到的结果，或者更改数据库中的源数据类型。

有了更多细节（特定列数据类型、示例数据、数据库更改的灵活性），我们可以帮助确定哪个选项是最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:42:31.923

如果您编写了查询，我建议您只使用`CAST`它来控制数据类型。我总是在 SQL Server 中显式转换计算列

```
SELECT CAST(ColumnA/ColumnB AS FLOAT) AS 'FieldA' FROM Table 
```

# javascript - 如何使用jquery在相邻元素中添加/减去值

> ID：11017865
> 
> 赞同：2
> 
> 时间：2012-06-13T15:06:14.700
> 
> 标签：javascript, jquery, datatables, html-table

这里有点 jQuery newb，但我最近有一个项目，我希望能够减去同一系列中相邻表 td 元素之间的值。

例子：

```
 <table>
      <tr>
       <td colspan='3'>Year 2008</td>
      </tr>
      <tr>
        <td>Quarter 1</td><td>Quarter 2</td><td>Change Q1-Q2</td>
      </tr>

      <tr>
        <td>Quarter 1 Val</td><td>Quarter 2 Val</td><td>Quarter 2 - Quarter 1</td>
      </tr>
      <tr>
        <td id='y1q1'>2</td><td id='y1q2'>6</td><td id='dy1q1q2'>4</td>
      </tr>
    </table> 
```

所以想法是用 (elemid: y1q2.value - elemid: y1q1.value) 填充元素 id='d1y1q2'。

我知道这应该在 SQL 级别处理，但是数据集很大，数据库的性质不能很好地处理查询中的这些计算。

任何帮助深表感谢！jquery DataTables 插件可以处理这种事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:08:35.383

```
var sub = parseInt($('#y1q2').text(), 10) - parseInt($('#y1q1').text(), 10);
$('#dy1q1q2').text(sub); 
```

如果你是`id`动态的，那么：

```
var lastTR = $('table tr:last'),
    tdSecond = parseInt( $('td',lastTR).eq(1).text(), 10 ),
    tdFirst = parseInt( $('td', lastTR).eq(0).text(), 10 ),
    sub = tdSecond - tdFirst;

$('td:last', lastTR).text(sub); 
```

**[演示](http://jsfiddle.net/QStkd/196/)**

如果您的值也可以是 Float ，那么您可以使用`.parseFloat()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:11:18.783

这样的事情怎么样？

```
var y1q1Val = parseFloat($('#y1q1').text());
var y1q2Val = parseFloat($('#y1q2').text());
var newVal = y1q2Val - y1q1Val;

$('#dy1q1q2').text(newVal); 
```

当然，您可以根据需要将其最小化...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:11:06.420

```
var a = document.getElementById('y1q2').innerHTML;
var b = document.getElementById('y1q1').innerHTML;
document.getElementById('d1y1q2').innerHTML = a+b; 
```

假设您在这些列中只有整数

# nhibernate - 将一个 Func 委托转换为另一个以与通用存储库一起使用

> ID：11017868
> 
> 赞同：0
> 
> 时间：2012-06-13T15:06:21.143
> 
> 标签：nhibernate, lambda, repository-pattern, func

我的目标是实现这样的目标：

```
IList<People> peeps = _peopleRepository.Get<People>(x.Name == "dan");   
//signature looks like this:  IList<T> Get<T>(Func<T, bool> query) where T : IEntity; 
```

这将在内部执行此操作：

```
_sessionFactory.GetCurrentSession().QueryOver<People>(x.Name=="dan").List();
//NHibernate.IQueryOver<T,T> QueryOver<T>(System.Linq.Expressions.Expression<Func<T>> alias)
where T : class 
```

我遇到的这个问题是将我的“查询”转换为“别名”，因为类型明显不同。这是徒劳的任务吗？有没有实现我的目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:20:31.550

虽然我不使用 NHibernate，但您的类型签名似乎不同。您的 Get 方法应该接受 type 的参数`System.Linq.Expressions.Expression<Func<T, bool>>`。这样，您可以将其传递给接受相同类型参数的 QueryOver 方法。

# jpa - 实体上的多个@Id 字段/键

> ID：11017869
> 
> 赞同：0
> 
> 时间：2012-06-13T15:06:23.630
> 
> 标签：jpa, jpa-2.0

我的实体上有一个主键（整数），但我也有一个 UUID 对我进行大量搜索的那些实体。我想知道是否可以将该 UUID 也设为键，以便 Hibernate（或其他）不必每次都从数据库中获取实体，而是可以先检查其缓存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:46:14.983

我不确定休眠。但是，如果您在 2.4 版本中使用 EclipseLink，则支持对非 id 字段的缓存索引。然后使用 UUID 的任何查询都将能够获得缓存命中。

见， [http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Caching/Indexes](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Caching/Indexes)

# c# - 如何让表单模拟桌面

> ID：11017872
> 
> 赞同：-8
> 
> 时间：2012-06-13T15:06:35.940
> 
> 标签：c#

是的，这个“可能”是一个艰难的，因为我什至不知道从哪里开始。

好的，我正在开发一个程序，它可以在调试时加载 Visual Studio 解决方案并在表单中显示它们。

实际上，该程序做了更多的事情，但它的作用是严格分类的，所以我不能深入。无论如何，无论它做什么，在这种情况下都无关紧要。

这是情节：

您在 Visual Studio 中创建了一个项目，但是当您对其进行调试时，它会在您的桌面上进行。

我需要它做的是在表单中对其进行调试，有效地充当具有不同分辨率的桌面。

所以如果具体的程序例如使用Screen.PrimaryScreen.Bounds.Width - 30，作为this.left属性，它需要认为它所显示的窗体的边界，其实就是Screen.PrimaryScreen.Bounds .

我遇到了困难，试图找出如何处理这个问题。我是否应该捕获这种类型的代码然后将其隐藏以在表单中工作？是否有另一种方法，让窗口根据窗体的大小模拟不同的 PrimaryScreen 大小？

编辑：也许更简化一点。我希望 from 就像我的 Windows 桌面一样，所以我加载到程序中的任何解决方案，都可以以该形式进行调试和查看。如果您需要检查您的应用程序在手机上的外观或仅在其他分辨率下的外观，则非常方便。

重点是程序本身将是一个 IDE，而是一个在线的，其中一群人可以同时在同一个应用程序/文件上一起工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:12:09.120

人们倾向于使用虚拟机来应对这些“挑战”。这种方法的效率令人惊讶！:-)

# iphone - UISearchBar becomeFirstResponder 返回 0，但对 UISearchBar 有有效引用

> ID：11017876
> 
> 赞同：1
> 
> 时间：2012-06-13T15:06:43.893
> 
> 标签：iphone, ios, uisearchbar, first-responder

我有一个带有 UISearchBar（和 SearchDisplayController）的 UIViewController 以及一个 UITableView。当导航到这个视图控制器时，我想自动聚焦在 UISearchBar 上（调出键盘并聚焦在搜索栏中的文本字段上）。一切都说要使用

```
[searchBar becomeFirstResponder] 
```

（假设 searchBar 是 UISearchBar 的出口）

我把它放在 viewDidLoad 的末尾：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    BOOL did = [searchBar becomeFirstResponder];

    [searchBar setText:@"donkey"];
} 
```

变量`did`为 0（并且焦点不会发生），但搜索栏的文本已成功更改为`donkey`.

我究竟做错了什么？

我正在使用带有 ARC 和最新 Xcode (4.3.2) 的 iOS 5。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T17:34:46.637

得到它的工作。只需将其放在 viewDidAppear 中，而不是 viewDidLoad 或 viewWillAppear 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T15:39:09.243

将您的代码添加到 -(void)viewDidAppear;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-19T22:22:10.447

这对我有用：

```
[window makeKeyAndVisible] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-04T10:13:55.787

我们必须确保 METHOD becomeFirstResponder 在 mainThread 上执行，所以让它像：

```
[xxx performSelectorOnMainThread:@selector(becomeFirstResponder) withObject:nil waitUntilDone:NO]; 
```

# javascript - 异步加载的部分视图脚本初始化

> ID：11017878
> 
> 赞同：0
> 
> 时间：2012-06-13T15:06:54.110
> 
> 标签：javascript, jquery, ajax, asp.net-mvc, partial

在我的 ASP.NET MVC 3 站点的控制面板网页上，用户可以看到他现有的项目（它是设计师组合的站点），并且可以按一个按钮将新项目添加到库中。

在局部视图剃刀代码中引用了此特定“项目添加功能”的标记和 javascript 依赖项。

每当用户单击页面上的按钮时，我都会检索局部视图的内容并将它们放在页面底部并`.dialog`在生成的 div 上调用 jQuery UI 以显示项目编辑/添加弹出窗口。

但是我如何调用一个逻辑来初始化在这个部分视图内容中引用元素的验证和其他逻辑（例如单击处理程序）？（因此，我不能只在准备好文档时初始化所有内容）

我是否只是在链接的 js 中硬编码某些函数（例如 initProjectEditing()）并从初始化弹出窗口的代码中调用它，还是有更优雅的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:42:34.293

恕我直言，好方法是使用[Jquery 小部件](http://jqueryui.com/demos/widget/)。这个东西允许你在一个地方为你的组件定义逻辑，然后在你需要的时候重用它。

*   您可以创建“添加新项目”Jquery 小部件。

*   在此小部件中定义有关“添加新项目”的所有功能（验证、事件处理程序等）

*   直接从主视图引用“添加新项目”所需的所有 javascript，而不是像现在这样在部分视图中引用。如果您需要在不同的地方重用它，您可以使用此类引用创建特殊的局部视图。

*   在加载“添加新项目”部分视图并显示对话框后，只需使用加载的 html 初始化“添加新项目”小部件。

# asp.net - 在 Sharepoint 2010 列表中动态显示图像

> ID：11017881
> 
> 赞同：0
> 
> 时间：2012-06-13T15:06:56.047
> 
> 标签：asp.net, list, c#-4.0, sharepoint-2010, sharepoint-2007

我想在列表中动态显示图像。我在一个列表中有两列。第一列包含一些数值，其他包含笑脸图标。我的要求是，如果第一列中的数字大于 50，我希望快乐的笑脸出现在列表的第二列中，而悲伤的笑脸出现在 50 以下的数字中。目前我使用超链接列在列表中显示图像。我正在手动添加图像。

我很期待，如果可以根据第一列编号自动显示图像。类似于计算列的东西。可以说，

超链接/图片公式：

```
 column   =IF([someNumer]>50, "href = c:\Test\happySmiley.ico", "href= c:\Test\happySad.ico" ) 
```

我想知道我们是否可以做这样的事情，或者任何其他建议表示赞赏..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T22:49:25.387

您正在寻找[KPI 指标。](http://office.microsoft.com/en-us/sharepoint-server-help/demo-add-kpis-to-your-sharepoint-site-HA010254916.aspx)

您还可以在此处找到很好的概述： [如何创建 SharePoint KPI 列](http://blog.pentalogic.net/2011/05/how-to-create-a-sharepoint-kpi-column/)

并检查 SPSE 上的类似问题： [Make all KPI Status Icons in diamond shape](https://sharepoint.stackexchange.com/questions/19884/make-all-kpi-status-icons-in-diamond-shape)

# visual-studio-2010 - Visual Studio 2010 中的“组织使用”菜单 ID 是什么？

> ID：11017885
> 
> 赞同：0
> 
> 时间：2012-06-13T15:07:07.227
> 
> 标签：visual-studio-2010, vspackage, vs-extensibility

我正在使用包模板而不是加载项创建 Visual Studio 2010 扩展。

我想在右键单击 .cs 文件时出现的“组织使用”菜单组中添加一个菜单项。为此，我需要该菜单组的 guid 和 id。

```
<Button guid="myCmdSet" id="myButton" priority="0x0100" type="Button">
    <Parent guid="guidSHLMainMenu (I think?)" id="???" />
    <Icon guid="guidImages" id="bmpPic1" />
    <Strings>
      <CommandName>myCommand</CommandName>
      <ButtonText>Do Stuff</ButtonText>
    </Strings>
  </Button> 
```

我看过[这里](http://msdn.microsoft.com/en-us/library/bb165988.aspx)、[这里](http://msdn.microsoft.com/en-us/library/bb514114.aspx)和[这里](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.vsmenus.idm_vs_ctxt_codewin.aspx)。基本上都在 MSDN 周围。这些是否已发布，有人知道它们是什么吗？

编辑：我通过[这种方法](http://social.msdn.microsoft.com/Forums/en/vsx/thread/f87af77f-d431-4246-9631-de92c6533bfb)找到了相关菜单，但我仍然没有办法找到我真正想要的菜单组 GUID/ID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T22:14:01.720

我的天啊，我在这上面花了 3 个小时 :D 这是解决方案：

```
<?xml version="1.0" encoding="utf-8"?>
<CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <Extern href="stdidcmd.h"/>
  <Extern href="vsshlids.h"/>
  <Extern href="msobtnid.h"/>
  <Commands package="guidVSPackage1Pkg">
    <Buttons>      
      <Button guid="guidCSharpGrpId" id="mySuperCommand" priority="0x0200" type="Button">
        <Parent guid="guidCSharpGrpId" id="IDG_CSHARP_CTX_ORGANIZE" />
        <Icon guid="guidImages" id="bmpPic1" />
        <Strings>
          <CommandName>mySuperCommand</CommandName>
          <ButtonText>My super command</ButtonText>
        </Strings>
      </Button>
    </Buttons>
    <Bitmaps>
      <Bitmap guid="guidImages" href="Resources\Images_32bit.bmp" usedList="bmpPic1, bmpPic2, bmpPicSearch, bmpPicX, bmpPicArrows"/>
    </Bitmaps>
  </Commands>
  <Symbols>
    <!-- This is the package guid. -->
    <GuidSymbol name="guidVSPackage1Pkg" value="{F066e284-dcab-11d2-b551-00c04f68d4db}" />
    <GuidSymbol name="guidCSharpGrpId" value="{5d7e7f65-a63f-46ee-84f1-990b2cab23f9}">
      <IDSymbol name="IDG_CSHARP_CTX_ORGANIZE" value="0x3618" />
      <IDSymbol name="mySuperCommand" value="0x0100" />
    </GuidSymbol>
    <GuidSymbol name="guidImages" value="{cff24f4c-767f-48ee-aff4-6bdf8218cba0}" >
      <IDSymbol name="bmpPic1" value="1" />
      <IDSymbol name="bmpPic2" value="2" />
      <IDSymbol name="bmpPicSearch" value="3" />
      <IDSymbol name="bmpPicX" value="4" />
      <IDSymbol name="bmpPicArrows" value="5" />
    </GuidSymbol>
  </Symbols>
</CommandTable> 
```

您必须放置**guidCSharpGrpId**和**IDG_CSHARP_CTX_ORGANIZE**因为它们在“标准”ID 集中不可用。“标准”是指放在*.h 文件中的*VisualStudioIntegration\Common\Inc目录中的那些。*它们隐藏在*cslangsvcui.dll*库中。

为了获得这些 ID，我使用**了 VS Command Table PowerToy**。你可以从这里下载它：http: [//archive.msdn.microsoft.com/VSCTPowerToy](http://archive.msdn.microsoft.com/VSCTPowerToy)

检查这个也作为这个线程： [http ://social.msdn.microsoft.com/Forums/en-US/vsx/thread/697245ac-1596-4d6a-b55c-f5b01b69a583](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/697245ac-1596-4d6a-b55c-f5b01b69a583)

[如果由于某些guid](https://skydrive.live.com/#cid=6A19F3A9B7B8E017&id=6A19F3A9B7B8E017!16486)等原因，此解决方案对您不起作用

希望这可以帮助 ：）

# silverlight - http托管silverlight应用程序跨域访问https托管服务

> ID：11017886
> 
> 赞同：4
> 
> 时间：2012-06-13T15:07:13.800
> 
> 标签：silverlight, http, https, cross-domain

我正在尝试使用 Web 客户端（或 webRequest.Create，结果相同）调用休息服务。

Silverlight 应用程序正在我使用 url localhost:13451 的机器上开发

[使用https://contoso.com/Services/Service.csv](https://contoso.com/Services/Service.csv)托管休息服务

获取实体列表的方法具有如下定义的 url 结构：

[https://contoso.com/Services/Service.csv/username@password/?StartDate=10-11-2012](https://contoso.com/Services/Service.csv/username@password/?StartDate=10-11-2012)

[https://contoso.com/](https://contoso.com/)的 crossdomain.xml 文件可通过[https://contoso.com/crossdomain.xml访问](https://contoso.com/crossdomain.xml)

并包含这样的内容：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <allow-http-request-headers-from domain="*" headers="*"/>
</cross-domain-policy> 
```

因此，当我尝试发出请求时，Silverlight 会引发安全异常，但未指定问题所在。任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T09:26:02.517

当您需要将 SL 服务引用添加到服务时，请将其放在您站点的根目录中：clientaccesspolicy.xml

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="*"  http-methods="*" >
        <domain uri="http://*"/>
        <domain uri="https://*"/> 
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

和 crossdomain.xml 包含：

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

并确保它可以通过浏览器通过 http 或 https 访问！高温高压

# objective-c - iOS：在计时器检查属性是否为 nil 后，事件将属性设置为 nil

> ID：11017888
> 
> 赞同：0
> 
> 时间：2012-06-13T15:07:14.823
> 
> 标签：objective-c, ios, events, timer

我有一个计时器，如果它不是 nil，则对属性执行操作，但是在检查 nil 和执行操作之间，一个事件将属性设置为 nil。实际上有几个事件都可以将属性设置为 nil。计时器正在检查的还有其他属性在同一条船上。

解决这个问题的最优雅和可扩展的方法是什么？

1.  将属性的每次使用都包装在同步块中？
2.  在计时器开始时设置/释放锁并检查每个事件中的等待锁？
3.  还有什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:11:54.970

我不太确定您的确切情况，但您可能想考虑为属性编写一个自定义设置器，当它设置为 nil 时将取消计时器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T16:16:08.177

我选择了 Paul de Lange 的回答，因为这对我来说很有意义。我不想找到我设置属性的每个地方并将其包装在一个`@synchronized`块中。

对于需要做类似事情的其他人，这是我想出的代码：

```
@interface MyClass {
//...

//The iVar, note that the iVar has a different name than the property, see the @synthesize command
RefreshOperation *_refreshOperation;

//...
}

@property (nonatomic, retain) RefreshOperation *refreshOperation;

@implementation MyClass

//...

//The timer's callback
- (void)statusTimerEvent:(NSTimer *)aTimer
{
    //Block/wait for thread safe setters/getters
    @synchronized(self)
    {
        if (self.refreshOperation)
        {
            self.status =  [self.refreshOperation status];
            progressView.progress = self.refreshOperation.progress;
        }
    }
}

//...

//Thread safe setter for the refreshOperation property
- (void)setRefreshOperation:(RefreshOperation *)refreshOperation:(RefreshOperation *)newRefreshOperation
{
    @synchronized(self)
    {
        if (_refreshOperation != newRefreshOperation)
        {
            [_refreshOperation release];
            _refreshOperation = [newRefreshOperation retain];
        }
    }
}

//Thread safe getter for the refreshOperation property
- (RefreshOperation *)refreshOperation
{
    id result = nil;
    @synchronized(self)
    {
        result = [_refreshOperation retain];
    }
    return [result autorelease];
}

//...

- (void)dealloc
{
    //...

    self.refreshOperation = nil;

    [super dealloc];
}

//...

//Connect the property |refreshOperation| to the iVar |_refreshOperation|; having the same name for both results in warning about the local variable hiding a property    
@synthesize refreshOperation = _refreshOperation; 
```

# c++ - 整数到类（模板）的映射

> ID：11017891
> 
> 赞同：0
> 
> 时间：2012-06-13T15:07:21.173
> 
> 标签：c++, stl, map

我想编写一些使用模板将 int 映射到某些东西的类。我想到的一般是两种选择：

```
1\. unsigned int ->  double          (scalar)
2\. unsigned int ->  double[N]       (vector of length N; N is the same for each int) 
```

我写了一堂课

```
template <class T>
class int2type_storage {
  public:
    ....
  private:
    typename std::map<unsigned int,T> map_;
} 
```

对于第一种情况，用法很简单：

```
int2type_storage<double> map1; 
```

问题是，对于第二种情况，最有效的方式/对象是什么？我正在考虑做类似的事情

```
 int2type_storage< std::vector<double> > 
```

但我有一种感觉，这将是次优的。另一种选择是存储指针

```
 int2type_storage< double* > 
```

但是我有一个问题，我应该为映射类之外的 N 个元素分配内存，并注意稍后释放它。

EDIT1：谢谢你们的回答，很抱歉我不能将两个答案标记为正确。

编辑2：

我已经实现了一切，但我的链接器找不到函数：

```
undefined reference to `int2type_storage<std::tr1::array<double, 4ul> >::init(int, int)' 
```

。H：

```
template <class T>
class int2type_storage {
public:
    int2type_storage() {};
    ~int2type_storage() {};

    void init(const int number, const int index);
        ...
private:
    int cur_index_;
    typename std::map<unsigned int, T>::iterator iterator_;
    typename std::vector<std::map<unsigned int,T> > map_vector_;
    bool zero_initialized;
}; 
```

.cpp：

```
template<class T>
void int2type_storage< T >::init(const int length, const int max_index) {
    map_vector_.resize(length);
} 
```

用法：

```
int2type_storage< std::tr1::array<double, 4> > w_map_; 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T15:12:04.750

假设`N`在编译时已知，您可以使用`std::array<double,N>`：

```
int2type_storage< std::array<double, N> > 
```

我不确定`int2type_storage`包装器的原因是什么，但您也可以使用 C++11 模板 typedef：

```
template <typename T, int N>
using int2type_storage = std::map<unsigned int, std::array<T,N>>; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T15:15:36.200

如果你有 C++11，`std::array`是最好的，还有 Boost.Array。

如果你不这样做，那么你可以写这样的东西：

```
template <size_t N>
struct Doubles {
    double data[N];
}; 
```

然后直接使用`.data`来访问它，或者添加任意数量的成员函数和运算符重载。如果您添加正确的，那么最终您将拥有`std::array`.

的主要合理用途`double*`是如果您正在复制地图（或以其他方式拥有多个地图），并且您希望它们引用相同的数据。但正如您已经知道的那样，它会产生资源管理问题，因此您可以考虑`shared_array<double>`. 您也可以考虑不共享数据。

还有一种可能的特殊情况，即在 C++03 中元素被复制到容器中，而在 C++11 中，在某些情况下通过将它们移动到容器中可以提高效率。但是数组（包括`std::array`我上面的类）不能有效地移动。如果`N`很大，并且有很多复制正在进行，那么*潜在*的可以有效移动的东西可能会更好，所以你可以再次考虑`std::vector`.

# objective-c - 如何检查移动 UIImageView 的当前坐标？

> ID：11017899
> 
> 赞同：0
> 
> 时间：2012-06-13T15:07:38.583
> 
> 标签：objective-c, xcode, uiimageview, core-animation, coordinates

我有一个 UIImageView 正在进行简单的翻译动画，我试图通过 imageview.frame.origin.x 属性获取视图的坐标。但是，它给了我动画后图像视图的坐标。有没有办法获取当前坐标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:28:39.287

是的，您需要检查 presenationLayer 的坐标。您可以在[我关于点击移动层的博客文章](http://ronnqvist.tumblr.com/post/21228285860/hit-testing-animating-layers)中阅读有关它的详细说明。

# javascript - 如何减少用于部署的 Google 闭包库的大小？

> ID：11017901
> 
> 赞同：2
> 
> 时间：2012-06-13T15:07:42.503
> 
> 标签：javascript, google-closure

谷歌闭包库很大，我怎样才能减少它的大小以将它部署到我的项目中？它包含大量 JavaScript 文件和一大堆资源，总共 14mb，如果知道我可以做些什么来优化它，我会很高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:10:36.840

我不认为该库（按原样）旨在用于生产。使用[**闭包编译器**](https://developers.google.com/closure/compiler/)。

另请参阅[Google Closure 文档](https://developers.google.com/closure/library/docs/closurebuilder)中的*使用 ClosureBuilder 和 Closure Compiler 收缩代码*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-14T04:45:33.697

它不是一个独立的库。它旨在用于部分。但是，对于简单的黑客攻击，您可以使用[http://www.programmingclosure.com/closure-lite/](http://www.programmingclosure.com/closure-lite/)

# parsing - 使用新行在 Scala Play20 中使用 BodyParser 解析文件

> ID：11017913
> 
> 赞同：6
> 
> 时间：2012-06-13T15:08:09.720
> 
> 标签：parsing, scala, buffer, playframework-2.0

请原谅这个问题，但我有一个 Web 应用程序，我想将一个可能很大的文件发送到服务器并让它解析格式。我正在使用 Play20 框架，而且我是 Scala 的新手。

例如，如果我有一个 csv，我想用“，”分割每一行，并最终为`List[List[String]]`每个字段创建一个。

目前，我认为最好的方法是使用 BodyParser（但我可能是错的）。我的代码看起来像：

```
Iteratee.fold[String, List[List[String]]]() {
  (result, chunk) =>
    result = chunk.splitByNewLine.splitByDelimiter // Psuedocode
} 
```

我的第一个问题是，我该如何处理像下面这样一个块在一行中间被分割的情况：

```
Chunk 1:
1,2,3,4\n
5,6

Chunk 2:
7,8\n
9,10,11,12\n 
```

我的第二个问题是，编写我自己的 BodyParser 是解决这个问题的正确方法吗？有没有更好的方法来解析这个文件？我主要关心的是我想让文件非常大，这样我就可以在某个时候刷新缓冲区，而不是将整个文件保存在内存中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-15T23:16:18.920

如果您的 csv 不包含转义的换行符，那么在不将整个文件放入内存的情况下进行渐进式解析非常容易。iteratee 库内部带有一个方法搜索[`play.api.libs.iteratee.Parsing`](http://www.playframework.org/documentation/api/2.0.1/scala/index.html#play.api.libs.iteratee.Parsing$)：

```
def search (needle: Array[Byte]): Enumeratee[Array[Byte], MatchInfo[Array[Byte]]] 
```

这会将您的流划分为`Matched[Array[Byte]]`和`Unmatched[Array[Byte]]`

然后，您可以将第一个带有标头的迭代器和另一个将折叠到匹配结果中的迭代器组合起来。这应该类似于以下代码：

```
// break at each match and concat unmatches and drop the last received element (the match)
val concatLine: Iteratee[Parsing.MatchInfo[Array[Byte]],String] = 
  ( Enumeratee.breakE[Parsing.MatchInfo[Array[Byte]]](_.isMatch) ><>
    Enumeratee.collect{ case Parsing.Unmatched(bytes) => new String(bytes)} &>>
    Iteratee.consume() ).flatMap(r => Iteratee.head.map(_ => r))

// group chunks using the above iteratee and do simple csv parsing
val csvParser: Iteratee[Array[Byte], List[List[String]]] =
  Parsing.search("\n".getBytes) ><>
  Enumeratee.grouped( concatLine ) ><>
  Enumeratee.map(_.split(',').toList) &>>
  Iteratee.head.flatMap( header => Iteratee.getChunks.map(header.toList ++ _) )

// an example of a chunked simple csv file
val chunkedCsv: Enumerator[Array[Byte]] = Enumerator("""a,b,c
""","1,2,3","""
4,5,6
7,8,""","""9
""") &> Enumeratee.map(_.getBytes)

// get the result
val csvPromise: Promise[List[List[String]]] = chunkedCsv |>>> csvParser

// eventually returns List(List(a, b, c),List(1, 2, 3), List(4, 5, 6), List(7, 8, 9)) 
```

当然你可以改进解析。如果你这样做，如果你与社区分享，我将不胜感激。

因此，您的 Play2 控制器将类似于：

```
val requestCsvBodyParser = BodyParser(rh => csvParser.map(Right(_)))

// progressively parse the big uploaded csv like file
def postCsv = Action(requestCsvBodyParser){ rq: Request[List[List[String]]] => 
  //do something with data
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T05:36:50.450

如果您不介意`List[List[String]]`在内存中保存两倍大小，那么您可以使用如下的正文解析器`play.api.mvc.BodyParsers.parse.tolerantText`：

```
def toCsv = Action(parse.tolerantText) { request =>
  val data = request.body
  val reader = new java.io.StringReader(data)
  // use a Java CSV parsing library like http://opencsv.sourceforge.net/
  // to transform the text into CSV data
  Ok("Done")
} 
```

请注意，如果您想减少内存消耗，我建议您使用`Array[Array[String]]`or ，`Vector[Vector[String]]`具体取决于您是要处理可变数据还是不可变数据。

如果您正在处理真正大量的数据（或丢失中等大小数据的请求）并且您的处理可以增量完成，那么您可以考虑滚动您自己的正文解析器。该正文解析器不会生成 a `List[List[String]]`，而是在行到来时对其进行解析，并将每一行折叠成增量结果。但这要复杂得多，特别是如果您的 CSV 使用双引号来支持带有逗号、换行符或双引号的字段。

# javascript - 自定义属性

> ID：11017916
> 
> 赞同：0
> 
> 时间：2012-06-13T15:08:16.103
> 
> 标签：javascript, html

我想获得自定义属性的值。例如，为此：

```
<div style="-my-data:3;" id="foo" ></div> 
```

我想写这样的东西：

```
document.getElementById("foo").style.myData; 
```

但它不起作用。我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:10:20.960

您应该改用[HTML5 的自定义`data-*`属性](http://html5doctor.com/html5-custom-data-attributes/)：

```
<div data-myDataName="3" id="foo"></div> 
```

* * *

然后，要通过 JavaScript 获取它，只需使用以下命令：

```
document.getElementById('foo').getAttribute('data-myDataName'); // '3' 
```

* * *

这是小提琴：http: [//jsfiddle.net/c55nf/](http://jsfiddle.net/c55nf/)

* * *

**PS**即使它是 HTML5 的一部分，它仍然可以在旧版浏览器中使用。它只是在 HTML5 中标准化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T15:10:41.850

使用 html 数据属性：

```
<div data-style="3" id="foo"></div> 
```

然后使用

```
document.getElementById("foo").getAttribute("data-style"); 
```

检索信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T15:12:55.123

使用[HTML 自定义数据属性](http://www.javascriptkit.com/dhtmltutors/customattributes.shtml)：

**HTML**：

```
<div data-myval="3" id="foo" ></div>​ 
```

**JavaScript**

```
alert(document.getElementById("foo").getAttribute('data-myval'));​ 
```

见[小提琴](http://jsfiddle.net/xx6K3/1)。

# svn - 如何在我的共享托管服务器中安装 svn 存储库

> ID：11017926
> 
> 赞同：1
> 
> 时间：2012-06-13T15:08:40.173
> 
> 标签：svn, hosting

我计划在共享托管环境中托管一个站点，即使在托管之后，多个开发人员也可以同时在该站点上工作，因此我正在考虑在同一服务器空间上创建颠覆存储库。

这样做是否可取，如果是这样，我如何在我的服务器空间中安装 svn 存储库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T17:25:00.350

我有点晚了，但我的回答可以帮助别人。

首先，使用 ssh 或 putty 登录服务器并尝试以下步骤

**1\. 创建存储库**

```
svnadmin create /svnrepos 
```

**2.创建SVN用户**

```
vi /svnrepos/conf/svnserve.conf 
```

在该文件中添加以下三行：

```
anon-access = none
auth-access = write
password-db = passwd 
```

创建密码文件：

```
vi /svnrepos/conf/passwd 
```

在该文件中为您的用户添加一行：

按以下格式添加用户：用户 = 密码

```
tony = mypassword 
```

**3\. 导入您的项目**

（假设您已将项目文件放在 /projects/myrailsproject 中）

```
svn import /projects/myrailsproject file:///svnrepos/myrailsproject 
```

**4.启动SVN服务器作为守护进程**

```
svnserve -d 
```

完毕！你现在应该有一个运行着一个名为 myrailsproject 的项目的 svn 服务器。

尝试从存储库中检查它：

```
svn co svn://192.168.0.2/svnrepos/myyrailsproject 
```

由于我们将 anon-access 设置为 none，因此应该提示您输入您在文件 /svnrepos/conf/passwd 中创建的用户名和密码。

***这些步骤是从[这里采取的](http://www.tonyspencer.com/2007/03/02/setup-a-subversion-server-in-4-minutes/)***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T16:21:54.873

是的，这种设置应该没问题。您将需要对共享服务器的某种 shell 访问来 svn 更新您的文件。如果您的服务器上已经有文件，您可以通过执行 svn import 到一个全新的存储库来创建一个存储库。如果存储库已经存在，请清理服务器上的文件夹并执行 svn checkout。

确保将您的 svn 服务器放在另一台机器上以实现冗余。

# javascript - 如何启用默认控件 通过javascript标记？

> ID：11017929
> 
> 赞同：3
> 
> 时间：2012-06-13T15:08:47.053
> 
> 标签：javascript, html

这就是我可以通过 html 包含音频文件的方式：

```
<audio controls>
  <source  src="audio/was_ist_ist.ogg" />
</audio> 
```

现在我只想使用 javascript 来做同样的事情。到目前为止我有这个：

```
var audioElement = new Audio("audio/was_ist_ist.ogg"); 
```

如何在此处启用默认控件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T15:19:07.267

```
var au = new Audio("http://...ogg");
au.controls = true;
document.body.appendChild(au); 
```

小提琴示例：http: [//jsfiddle.net/QKUgX/](http://jsfiddle.net/QKUgX/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T11:34:59.417

```
var audio= new Audio(url);
audio.attr('controls',true).appendTo(selector); 
```

# java - 将昂贵的资源创建放在静态块中？

> ID：11017930
> 
> 赞同：3
> 
> 时间：2012-06-13T15:08:47.263
> 
> 标签：java, jaxb

我正在使用 JAXB 2.0 版本。为此，我`JAXBContext`通过以下方式创建对象：

```
package com;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;

public class JAXBContextFactory {

    public static JAXBContext createJAXBContext() throws JAXBException {
        JAXBContext jaxbContext = JAXBContext.newInstance(Customer.class);

        return jaxbContext;
    }

} 
```

基本上由于创建 JAXBContext 非常昂贵，我想`JAXBContext` 为整个应用程序创建一次且仅一次。所以我把`JAXBContext`代码放在静态方法下，如上图所示。

现在，请求将`JAXBContextFactory.createJAXBContext();`在需要引用时调用`JAXBContex`. **现在我的问题是，在这种情况下是`JAXBContext`只创建一次还是应用程序有多个实例`JAXBContext`？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:13:02.177

每次调用此方法时，您的应用程序都会有一个 JAXBContext 实例。

如果您不希望这种情况发生，则需要执行以下操作

```
package com;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;

public class JAXBContextFactory {

    private static JAXBContext context = null;
    public static synchronized JAXBContext createJAXBContext() throws JAXBException {
        if(context == null){
            context = JAXBContext.newInstance(Customer.class);
        }
        return context;
    }

} 
```

这与您的实现之间的区别在于，在这一实现中，我们保存了在静态变量中创建的 JAXBContext 实例（保证仅存在一次）。在您的实现中，您不会将刚刚创建的实例保存在任何地方，并且只会在每次调用该方法时创建一个新实例。重要提示：不要忘记`synchronized`添加到方法声明中的关键字，因为它确保在多线程环境中调用此方法仍将按预期工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-13T15:13:19.733

您的实现将为对它的每个请求创建一个新的 JAXBContext。相反，您可以这样做：

```
public class JAXBContextFactory {
    private static JAXBContext jaxbContext;

    static {
        try {
            jaxbContext = JAXBContext.newInstance(Customer.class);
        } catch (JAXBException ignored) {
        }
    }

    public static JAXBContext createJAXBContext() {
        return jaxbContext;
    }

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-13T15:14:05.280

每次调用您的方法时，它都会清楚地创建一个新的 JAXBContext。

如果您想确保只创建一个实例，而不管您的方法被调用多少次，那么您正在寻找[Singleton Pattern](http://en.wikipedia.org/wiki/Singleton_pattern)，其实现如下所示：

```
public class JAXBContextFactory {
  private static JAXBContext INSTANCE;
  public static JAXBContext getJAXBContext() throws JAXBException {
    if (JAXBContextFactory.INSTANCE == null) {
      INSTANCE = JAXBContext.newInstance(Customer.class);
    }
    return INSTANCE;
  }
} 
```

请记住，此实例仅在每个 Java 类加载器中都是唯一的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-13T15:13:31.567

每次调用该方法时，您将拥有一个实例。使用`static`上下文只是意味着您没有任何实例`JAXBContextFactory`

也许您使用的是

```
public enum JAXBContextFactory {;

    private static JAXBContext jaxbContext = null;

    public synchronized static JAXBContext createJAXBContext() throws JAXBException {
        if (jaxbContext == null)
            jaxbContext = JAXBContext.newInstance(Customer.class);
        return jaxbContext;
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-07T19:54:12.213

在分析了其他答案和@tom-hawtin-tackline 评论后，我认为最简单的解决方案是：

```
public class JAXBContextFactory {

    private static final JAXBContext CONTEXT = createContext();

    private static JAXBContext createContext() {
        try {
            return JAXBContext.newInstance(Customer.class);
        } catch (JAXBException e) {
            throw new AssertionError(e);
        }
    }

    public static JAXBContext getContext() { return CONTEXT; }

} 
```

# iphone - 可拉伸图像

> ID：11017932
> 
> 赞同：1
> 
> 时间：2012-06-13T15:08:57.303
> 
> 标签：iphone, objective-c, uiimage, uibutton, stretching

参考：[iPhone stretchableImageWithLeftCapWidth 只制作“D”](https://stackoverflow.com/questions/2924408/iphone-stretchableimagewithleftcapwidth-only-makes-ds)

我有一个大小为 的按钮的图像`13x30`。我想拉伸图像以填充大小为 的按钮`45x30`。

这是我正在使用的代码：

```
UIImage *shareImage = [[UIImage imageNamed:@"btn_red"] stretchableImageWithLeftCapWidth:16.0f topCapHeight:0.0];
UIButton *shareButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 46.0f, 30.0f)];
etc.... 
```

我得到的图像很不正常。我得到的是真实大小的图像，后面有一些较浅的阴影，如图所示![按钮](../Images/b8ce78c8f828cd241d447f92aa785fd8.png)。

为什么会这样？我完全不明白。我有正确的可拉伸逻辑，并且我遵循了每个人在教程/帖子中所说的内容。

如果我得到一些帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:19:12.317

我认为你的左帽宽度是错误的？如果你的第一张图片只有 13 像素宽，那么左边的上限怎么可能是 16？

左帽是原始图像上保持未拉伸的宽度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:48:15.823

为了跟进保罗的回答，

您要确保留出一些空间进行拉伸，因此请使用 Photoshop 或类似工具放大并确定绝对需要哪些剩余像素。

看到这个：http: [//idevrecipes.com/2010/12/08/stretchable-images-and-buttons/](http://idevrecipes.com/2010/12/08/stretchable-images-and-buttons/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T17:18:35.360

LeftCapWidth 应为 6.5；

```
UIImage *shareImage = [[UIImage imageNamed:@"btn_red"] stretchableImageWithLeftCapWidth:6.5 topCapHeight:0.0];
UIButton *shareButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 46.0f, 30.0f)]; 
```

# r - 格式化时间跨度以显示小时、分钟、秒

> ID：11017933
> 
> 赞同：13
> 
> 时间：2012-06-13T15:08:57.910
> 
> 标签：r, time, format

我一直在尝试找到一种将输出格式化`difftime`为 HH:MM:SS.ms 的简单方法。到目前为止，我还没有遇到任何让我感到惊讶的事情。

我确实写了下面几乎可以做到的函数。限制是将数字表示为有效的单个数字。例如 2hr, 3mins, 4.5secs 变成 "2:3:4.5" 而不是 "02:03:04.5"

有人有更好的建议吗？

```
format.timediff <- function(start_time) {
    diff = as.numeric(difftime(Sys.time(), start_time, units="mins"))
    hr <- diff%/%60
    min <- floor(diff - hr * 60)
    sec <- round(diff%%1 * 60,digits=2)

    return(paste(hr,min,sec,sep=':'))
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-13T15:55:03.483

除了@GSee 的评论，您还可以使用如下函数：

```
f <- function(start_time) {
  start_time <- as.POSIXct(start_time)
  dt <- difftime(Sys.time(), start_time, units="secs")
  # Since you only want the H:M:S, we can ignore the date...
  # but you have to be careful about time-zone issues
  format(.POSIXct(dt,tz="GMT"), "%H:%M:%S")
}
f(Sys.Date()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-06T15:28:50.450

```
Merge_Charge_Point$Duration<- difftime(Merge_Charge_Point$EndConnectionDateTime, Merge_Charge_Point$StartConnectionDateTime, units="secs") 
```

这是代码。但是此代码将数据转换为秒，但结果应该是时间字符串。

# python - wxpython更改消息对话框字体？

> ID：11017935
> 
> 赞同：1
> 
> 时间：2012-06-13T15:09:03.300
> 
> 标签：python, fonts, wxpython, messagedialog

Python 2.7.3 x64 wxPython 2.8 x64

我无法更改 wxpython 消息对话框的字体。我想使用固定宽度的字体（我认为 wxFAMILY_MODERN 是）来控制输出的格式。这是我用来测试的代码......

```
def infDialog (self, msg, title):
    """ Display Info Dialog Message """
    font = wx.Font(14, wx.MODERN, wx.NORMAL, wx.NORMAL)
    style = wx.OK | wx.ICON_INFORMATION | wx.STAY_ON_TOP
    dialog = wx.MessageDialog(self, msg, title, style)
    dialog.CenterOnParent()
    dialog.SetFont(font)
    result = dialog.ShowModal()
    if result == wx.ID_OK:
        print dialog.GetFont().GetFaceName()
    dialog.Destroy()
    return
# End infDialog() 
```

但是当我单击确定时的结果总是“Arial”。有什么想法吗？也许我需要制作一个自定义对话框类？

谢谢，

-RMW混沌

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T17:47:50.777

wx.MessageDialog 是围绕操作系统/系统消息对话框的包装器。我怀疑每个操作系统只允许进行如此多的编辑或根本不允许。所以是的，如果字体很重要，使用自定义 wx.Dialog 或通用消息对话框小部件 (wx.lib.agw.genericmessagedialog) 是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-30T18:20:26.523

我浏览了整个互联网，发现没有人真正花时间回答这个问题，而只是告诉用户创建自己的对话类。实际上有一种简单的方法可以让您更改消息对话框的字体。抓取对话框的 textCtrl 对象，然后设置该对象的字体应该可以解决问题。

只需更换：

```
dialog.SetFont(font) 
```

和

```
txt_ctrl = dialog.text
txt_ctrl.SetFont(font) 
```

让我知道这是否适合您。

# c# - 从代码恢复不起作用并且没有错误

> ID：11017942
> 
> 赞同：0
> 
> 时间：2012-06-13T15:09:25.860
> 
> 标签：c#, sql-server-2008-r2, database-restore

我很难用我的 C# 脚本恢复多个数据库。它也没有提供任何错误——它什么也不做。

这是代码：

```
// Connect to SQL Server
SqlConnection conn = new SqlConnection("Data Source=SERVERNAME;" + "Integrated Security=SSPI;" + "Connection timeout=60");

StreamWriter logFile = new StreamWriter(@"F:\Backups\log.txt");

try{
    conn.Open();
}catch(Exception e){
    string errorTxt = "There was an error connecting to the server: " + e.ToString();
    logFile.WriteLine(errorTxt);
}

// Get Directory
DirectoryInfo source = new DirectoryInfo(@"F:\Backups\SERVERNAME\");

foreach(FileInfo fi in source.GetFiles()){

    // We need to get the DB name:
    string filename = fi.Name.ToString();
    int bkpIndex = filename.IndexOf("_backup");

    string sql = "USE master RESTORE DATABASE " + filename.Substring(0, bkpIndex) + " FROM DISK = '" + fi.FullName + "' WITH REPLACE";

    try{
        Console.WriteLine("Restoring {0}.", filename.Substring(0, bkpIndex));
        logFile.WriteLine("SQL: {0}", sql);
        SqlCommand cmd = new SqlCommand(sql, conn);
    }catch(Exception ex){
        logFile.WriteLine("Error restoring {0}: " + ex.ToString(), filename.Substring(0, bkpIndex));
    }

}

logFile.Close()
conn.Close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:15:23.593

您没有在任何地方执行命令...尝试 ExecuteNonQuery！

例如

```
SqlCommand cmd = new SqlCommand(sql, conn);
cmd.ExecuteNonQuery(); 
```

# r - Position = "dodge" 或 "jitter" 不适用于 geom_segments

> ID：11017945
> 
> 赞同：2
> 
> 时间：2012-06-13T15:09:32.653
> 
> 标签：r, ggplot2

很抱歉重新发布，但我有一个更好的数据工作示例可以反映我的问题。我想出了如何提供即使在丢失数据的情况下也保持一致的自定义颜色（例如，如果下面示例中的 Species 省略了 setosa，颜色应该保持一致）。但现在我无法让 geom_segments 跟随“dodge”参数。我还尝试过使用 position_jitter(width=0.25) 进行“抖动”甚至自定义抖动。

```
colours <- c("#FF0000", "#33CC33", "#CCCCCC", "#FFA500", "#000000" )
iris$Month <- rep(seq(from=as.Date("2011-01-01"), to=as.Date("2011-10-01"), by="month"), 15)
d<-aggregate(iris$Sepal.Length, by=list(iris$Month, iris$Species), sum)
d$quota<-seq(from=2000, to=60000, by=2000)
colnames(d) <- c("Month", "Species", "Sepal.Width", "Quota")
d$Sepal.Width<-d$Sepal.Width * 1000
g1 <- ggplot(data=d, aes(x=Month, y=Quota, color="Quota")) + geom_line(size=1)
g1 + geom_segment(data=d, mapping=aes(x=Month, y=0, ymax=Sepal.Width, yend=Sepal.Width, xend=Month, group=Species, color=Species, size=1), position="dodge") + scale_color_manual(values=colours) 
```

geom_segments 是重叠的，我希望它们彼此相邻。以前我只是用自己的图层一个一个地创建每个段并偏移 x 轴（月 + 5、月 + 10 等）。但是我无法以这种方式获得每条线的自定义颜色。

感谢您的任何指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T16:16:03.713

听起来你正试图用线段制作条形图......而不是使用：

```
ggplot(d, aes(x=Month, y=Sepal.Width)) + 
  geom_bar(stat='identity', position='dodge') 
```

# ember.js - 索引状态是否意味着 Ember.Router 中的初始状态？

> ID：11017953
> 
> 赞同：0
> 
> 时间：2012-06-13T15:10:04.173
> 
> 标签：ember.js

我按照 ember 应用程序结构指南[http://emberjs.com/guides/outlets/](http://emberjs.com/guides/outlets/)中给出的示例来了解它是如何工作的。在这个例子中，我们有三个主要状态：索引、帖子和帖子。运行应用程序时，我得到了我的预期：初始状态是`index`并且它直接转换为`posts`. 但是当我想看到有`showPost`动作的个别帖子时，路由器不会去 `post.index`卡住，`root.post`或者预期的路径应该是`root.post.comments`. 这是一个错误还是我错过了什么？

这里有一个相关的 jsfiddle [http://jsfiddle.net/jrabary/bX5hb/](http://jsfiddle.net/jrabary/bX5hb/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T08:49:12.020

[这里为http://emberjs.com/guides/outlets/](http://emberjs.com/guides/outlets/)路由指南提供或多或少的工作 jsfiddle 。

[http://jsfiddle.net/dq2fE/](http://jsfiddle.net/dq2fE/)

# objective-c - 如何添加两个 NSString 对象？

> ID：11017954
> 
> 赞同：-2
> 
> 时间：2012-06-13T15:10:04.400
> 
> 标签：objective-c, nsstring, variable-assignment

我对简单的 NSString 分配有疑问。我的代码如下所示：

```
NSString * info;
info=[newLocation description];   
NSString * bodyMessage =[NSString stringWithFormat:@"tralalla %@", info]; 
```

当我只是打印“信息”的值时一切正常，但在最后一行我有一个错误；/任何人都知道我该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:28:49.100

您的评论表明您在该行上有一个断点：

![断点](../Images/116016f6699727812087e5a9d3b1082d.png)

拖动左边的蓝色小箭头，直到它变成一团烟雾，然后松开。

或转到该行并按`Cmd`+`\`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:14:26.920

我不知道您的代码有什么问题，但请尝试将第三行替换为

```
NSString *bodyMessage = [@"tralalla " stringByAppendingString:info]; 
```

**编辑：**并确保你把分号放在第一行之后，正如德克所说......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-22T02:54:22.890

尝试

```
NSString * bodyMessage =[NSString stringWithFormat:@"%@%@",@"tralalla", info]; 
```

希望这可以帮助！

# json - 2个带有json的JsTrees initial_open

> ID：11017957
> 
> 赞同：1
> 
> 时间：2012-06-13T15:10:10.773
> 
> 标签：json, jstree

我的页面上有 2 个 jsTree 实例。两者都使用 json-plugin 来获取几乎相同的附加数据。在 Internet Explorer 上，我得到了奇怪的行为，其中一棵树几乎总是不会打开“initially_open”选项中提供的所有这些节点。

我确实怀疑我在这里遇到了时间问题。有谁知道我该如何解决这个问题？

# c# - 使用 Moq 部分模拟类

> ID：11017967
> 
> 赞同：12
> 
> 时间：2012-06-13T15:10:35.110
> 
> 标签：c#, .net, mocking, moq

我只想`GetValue`使用 Moq 模拟以下类的方法：

```
public class MyClass
{
    public virtual void MyMethod()
    {
        int value = GetValue();
        Console.WriteLine("ORIGINAL MyMethod: " + value);
    }

    internal virtual int GetValue()
    {
        Console.WriteLine("ORIGINAL GetValue");
        return 10;
    }
} 
```

我已经读过一点这应该如何与 Moq 一起使用。我在网上找到的解决方案是使用该`CallBase`属性，但这对我不起作用。

这是我的测试：

```
[Test]
public void TestMyClass()
{
     var my = new Mock<MyClass> { CallBase = true };
     my.Setup(mock => mock.GetValue()).Callback(() => Console.WriteLine("MOCKED GetValue")).Returns(999);
     my.Object.MyMethod();
     my.VerifyAll();
 } 
```

我希望 Moq 使用现有实现`MyMethod`并调用模拟方法，从而产生以下输出：

```
ORIGINAL MyMethod: 999
MOCKED GetValue 
```

但这就是我得到的：

```
ORIGINAL GetValue
ORIGINAL MyMethod: 10 
```

进而

```
Moq.MockVerificationException : The following setups were not matched: MyClass mock => mock.GetValue() 
```

我有一种感觉，我完全误解了一些东西。我在这里想念什么？任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T16:11:06.580

好的，我在另一个问题中找到了答案：[如何模拟类的内部方法？](https://stackoverflow.com/questions/2772621/how-to-mock-the-internal-method-of-a-class). 所以这是重复的，可以关闭。

不过，这是解决方案：只需将此行添加到`Assembly.config`您要测试的项目中：

```
[assembly: InternalsVisibleTo("DynamicProxyGenAssembly2")] // namespace in Moq 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:17:58.213

您是否尝试指定可验证：

```
my.Setup(mock => mock.GetValue()).Callback(() => Console.WriteLine("MOCKED GetValue")).Returns(999).Verifiable(); 
```

# sql-server - 我需要一个游标，如何在没有锁的情况下有效地做到这一点

> ID：11017970
> 
> 赞同：0
> 
> 时间：2012-06-13T15:10:43.860
> 
> 标签：sql-server, cursor

我有一个包含存储过程列表的表。

我正在使用游标然后循环并调用和捕获每个存储过程的结果（它们都返回 0 或 1）。

所以我有：

```
DECLARE @PROC_ID INT,
        @PROC_NAME VARCHAR(50)

SELECT *
INTO #MY_PROCS
FROM TABLE_PROCS

DECLARE MY_CURSOR CURSOR FOR
SELECT PROC_ID, PROC_NAME
FROM TABLE_PROCS

OPEN MY_CURSOR
FETCH NEXT FROM MY_CURSOR INTO @PROC_ID, @PROC_NAME

WHILE @@FETCH_STATUS = 0
BEGIN
  SELECT @PROC_RESULT = .......

  UPDATE #MY_PROCS SET PROC_RESULT = @PROC_RESULT WHERE PROC_ID = @PROC_ID
END

CLOSE MY_CURSOR
DEALLOCATE MY_CURSOR

DROP TABLE #MY_PROCS 
```

我在游标上阅读`READ ONLY`，`NO LOCK`如果可能的话，我应该尽可能地设置它。

另外，我应该使用表变量而不是临时表吗？

**是否可以使用 oa 光标来执行此操作？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:13:30.640

至少在我的所有测试中，最有效的光标将是：

```
DECLARE MY_CURSOR CURSOR 
  LOCAL STATIC READ_ONLY FORWARD_ONLY
FOR ... 
```

现在，我们不可能知道您是否可以在没有光标的情况下执行此操作。您方便地遗漏了我们可以用来告诉您的唯一信息。似乎您正在为每个调用调用一个过程，但您不能使用 SELECT 来执行此操作。然后你用结果更新一个表，但你删除了这个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T17:34:09.643

因此，您有两个表，其中一个您希望使用另一个表中的值进行更新，并且它们共享一个公共键。干得好：

```
update [m]
set proc_id = t.proc_id
from #MY_PROCS as [m]
inner join TABLE_PROCS as [t]
   on m.proc_id = t.proc_id 
```

# c# - 为什么有并发下载次数限制？

> ID：11017981
> 
> 赞同：8
> 
> 时间：2012-06-13T15:11:22.183
> 
> 标签：c#, parallel-processing, download

我正在尝试制作自己的简单网络爬虫。我想从 URL 下载具有特定扩展名的文件。我编写了以下代码：

```
 private void button1_Click(object sender, RoutedEventArgs e)
    {
        if (bw.IsBusy) return;
        bw.DoWork += new DoWorkEventHandler(bw_DoWork);
        bw.RunWorkerAsync(new string[] { URL.Text, SavePath.Text, Filter.Text });
    }
    //--------------------------------------------------------------------------------------------
    void bw_DoWork(object sender, DoWorkEventArgs e)
    {
        try
        {
            ThreadPool.SetMaxThreads(4, 4);
            string[] strs = e.Argument as string[];
            Regex reg = new Regex("<a(\\s*[^>]*?){0,1}\\s*href\\s*\\=\\s*\\\"([^>]*?)\\\"\\s*[^>]*>(.*?)</a>", RegexOptions.Compiled | RegexOptions.CultureInvariant | RegexOptions.IgnoreCase);
            int i = 0;
            string domainS = strs[0];
            string Extensions = strs[2];
            string OutDir = strs[1];
            var domain = new Uri(domainS);
            string[] Filters = Extensions.Split(new char[] { ';', ',', ' ' }, StringSplitOptions.RemoveEmptyEntries);
            string outPath = System.IO.Path.Combine(OutDir, string.Format("File_{0}.html", i));

            WebClient webClient = new WebClient();
            string str = webClient.DownloadString(domainS);
            str = str.Replace("\r\n", " ").Replace('\n', ' ');
            MatchCollection mc = reg.Matches(str);
            int NumOfThreads = mc.Count;

            Parallel.ForEach(mc.Cast<Match>(), new ParallelOptions { MaxDegreeOfParallelism = 2,  },
            mat =>
            {
                string val = mat.Groups[2].Value;
                var link = new Uri(domain, val);
                foreach (string ext in Filters)
                    if (val.EndsWith("." + ext))
                    {
                        Download((object)new object[] { OutDir, link });
                        break;
                    }
            });
            throw new Exception("Finished !");

        }
        catch (System.Exception ex)
        {
            ReportException(ex);
        }
        finally
        {

        }
    }
    //--------------------------------------------------------------------------------------------
    private static void Download(object o)
    {
        try
        {
            object[] objs = o as object[];
            Uri link = (Uri)objs[1];
            string outPath = System.IO.Path.Combine((string)objs[0], System.IO.Path.GetFileName(link.ToString()));
            if (!File.Exists(outPath))
            {
                //WebClient webClient = new WebClient();
                //webClient.DownloadFile(link, outPath);

                DownloadFile(link.ToString(), outPath);
            }
        }
        catch (System.Exception ex)
        {
            ReportException(ex);
        }
    }
    //--------------------------------------------------------------------------------------------
    private static bool DownloadFile(string url, string filePath)
    {
        try
        {
            HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url);
            request.UserAgent = "Web Crawler";
            request.Timeout = 40000;
            WebResponse response = request.GetResponse();
            Stream stream = response.GetResponseStream();
            using (FileStream fs = new FileStream(filePath, FileMode.CreateNew))
            {
                const int siz = 1000;
                byte[] bytes = new byte[siz];
                for (; ; )
                {
                    int count = stream.Read(bytes, 0, siz);
                    fs.Write(bytes, 0, count);
                    if (count == 0) break;
                }
                fs.Flush();
                fs.Close();
            }
        }
        catch (System.Exception ex)
        {
            ReportException(ex);
            return false;
        }
        finally
        {

        }
        return true;
    } 
```

问题是，虽然它适用于 2 个并行下载：

```
 new ParallelOptions { MaxDegreeOfParallelism = 2,  } 
```

...它不适用于更大程度的并行性，例如：

```
 new ParallelOptions { MaxDegreeOfParallelism = 5,  } 
```

...我得到连接超时异常。

一开始我以为是因为`WebClient`：

```
 //WebClient webClient = new WebClient();
                //webClient.DownloadFile(link, outPath); 
```

...但是当我用使用的函数替换它时，`DownloadFile`我`HttpWebRequest`仍然得到了错误。

我已经在许多网页上对其进行了测试，但没有任何改变。我还通过 chrome 的扩展程序“Download Master”确认这些 Web 服务器允许多个并行下载。有没有人知道为什么我在尝试并行下载许多文件时出现超时异常？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T15:14:46.793

您需要分配[`ServicePointManager.DefaultConnectionLimit`](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx). 到同一主机的默认**并发连接**数为 2。另请参阅有关使用 web.config[的相关 SO 帖子](https://stackoverflow.com/a/1361781/175679)[`connectionManagement`](http://msdn.microsoft.com/en-us/library/fb6y0fyc.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T15:24:15.670

据我所知，IIS 会限制进出连接的总数，但是这个数字应该在 10^3 而不是 ~5 的范围内。

是否有可能您正在测试相同的网址？我知道很多 Web 服务器会限制来自客户端的同时连接数。例如：您是否尝试下载 10 个[http://www.google.com](http://www.google.com)副本进行测试？

如果是这样，您可能想尝试使用不同站点的列表进行测试，例如：

*   [http://www.google.com](http://www.google.com)
*   [http://www.yahoo.com](http://www.yahoo.com)
*   [http://www.facebook.com](http://www.facebook.com)
*   [http://www.bing.com](http://www.bing.com)
*   [http://www.zombo.com](http://www.zombo.com)

# python - 如何使用 python cv2 api 为 undistortPoints 格式化 xy 点？

> ID：11017984
> 
> 赞同：13
> 
> 时间：2012-06-13T15:11:27.660
> 
> 标签：python, opencv

我在格式化 x,y 点列表以传递给 undistortPoints (opencv 2.4.1) 时遇到问题。

错误消息是 c++ 特定的，并抱怨点数组不是 CV_32FC2 类型。我不应该能够传入 Nx2 numpy 数组吗？

```
import cv2

camera_matrix = array(mat('1.3e+03, 0., 6.0e+02; 0., 1.3e+03, 4.8e+02; 0., 0., 1.'), dtype=float32)
dist_coeffs = array(mat('-2.4-01, 9.5e-02, -4.0e-04, 8.9e-05, 0.'), dtype=float32)

test = zeros((10,2), dtype=float32)

print test.shape, type(test)

xy_undistorted = cv2.undistortPoints(test, camera_matrix, dist_coeffs) 
```

结果是：

```
opencv/modules/imgproc/src/undistort.cpp:279: error: (-215) CV_IS_MAT(_src) && CV_IS_MAT(_dst) && (_src->rows == 1 || _src->cols == 1) && (_dst->rows == 1 || _dst->cols == 1) && _src->cols + _src->rows - 1 == _dst->rows + _dst->cols - 1 && (CV_MAT_TYPE(_src->type) == CV_32FC2 || CV_MAT_TYPE(_src->type) == CV_64FC2) && (CV_MAT_TYPE(_dst->type) == CV_32FC2 || CV_MAT_TYPE(_dst->type) == CV_64FC2) in function cvUndistortPoints 
```

在 samples/python2/video.py 中使用了 projectPoints ，它接受一个数组并对其进行整形（-1,3），从而为该函数生成一个 Nx3 数组，似乎相同的格式应该在这里工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-13T17:56:03.567

我对相机校准了解不多。但是看到您的代码和错误，我将其更改如下：

```
import cv2
import numpy as np
camera_matrix = np.array([[1.3e+03, 0., 6.0e+02], [0., 1.3e+03, 4.8e+02], [0., 0., 1.]], dtype=np.float32)
dist_coeffs = np.array([-2.4-01, 9.5e-02, -4.0e-04, 8.9e-05, 0.], dtype=np.float32)

test = np.zeros((10,1,2), dtype=np.float32)
xy_undistorted = cv2.undistortPoints(test, camera_matrix, dist_coeffs)

print xy_undistorted 
```

下面是我得到的结果，检查是否正确：

```
[[[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]

 [[ 0.0187303   0.01477836]]] 
```

**问题是什么 ：**

错误说，来源应该有`EITHER one row OR one column`. 应该是CV_32FC2或CV_64FC2，表示两个通道和浮点。所以让你的形状 src `(10,1,2) or (1,10,2)`。两种方法都有效并给出相同的结果（我自己检查过）。唯一的问题是，我不知道它是否正确，所以你自己检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-26T05:51:16.597

我已经测试了 Abid Rahman 的方法并且效果很好，但是有一些问题需要注意。

```
calib = np.reshape(calib, [3, 3])
dist = np.array(kp_mat, dtype=np.float32)
newcameramtx, _ = cv2.getOptimalNewCameraMatrix(calib, dist, (w, h), 1, (w, h))
# undistort
dst = cv2.undistortPoints(pt, calib, dist, None, newcameramtx)
dst = np.squeeze(dst) 
```

# 笔记

1.  点的形状应为 [1,N,2] 或 [N,1,2]，坐标为 [x,y]
2.  应指定新的相机矩阵。或者输出将是标准化坐标。

# asp.net-mvc-3 - 将表单添加到发布到创建操作的索引页面的正确方法是什么，包括验证？

> ID：11017989
> 
> 赞同：0
> 
> 时间：2012-06-13T15:11:51.810
> 
> 标签：asp.net-mvc-3

我的应用程序中有一个显示供应商列表的索引视图。我还想添加一个小表单以在该页面上添加新项目。创建表单将发布到创建操作。我的模型类包含一个供应商列表，以及一个名为 NewVendor 的单一供应商的属性。

```
public IEnumerable<SoftwareVendor> Vendors { get; set; }    
public SoftwareVendor NewVendor { get; set; } 
```

该类`SoftwareVendor`具有验证属性。这是一个实体框架类。

制作一个发布到 Create 操作的表单很容易：

```
@using (Html.BeginForm( "Create", "Vendor" )) {
@Html.ValidationSummary(true)
<fieldset>
    <legend>New Software Vendor</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.NewVendor.Name)
    </div>
    <div class="editor-field">
        @Html.EditorFor( model => model.NewVendor.Name )
        @Html.ValidationMessageFor( model => model.NewVendor.Name )
    </div>
    <br />
    <input type="submit" value="Create" />
</fieldset>
} 
```

这个帖子很好，客户端验证也有效。但是，默认的 Create 操作需要一个实例，`SoftwareVendor`并在表单集合中寻找一个名为“Name”的键。相反，上面的表格发布了“NewVendor.Name”。

我可以通过在`@Html.EditorFor`.

```
@Html.EditorFor( model => model.NewVendor.Name, "string", "Name" ) 
```

现在创建操作很高兴，因为正在接收“名称”值。但是，验证消息被破坏了，因为它仍在寻找一个名为“NewVendor.Name”的字段，并且似乎没有办法覆盖它。

```
<span class="field-validation-valid" data-valmsg-for="NewVendor.Name" data-valmsg-replace="true"></span> 
```

我缺少一些简单的东西来完成这项工作吗？

以下是我可以解决的问题列表：

1.  让我的 Create 操作采用我的 Index 模型的实例而不是 SoftwareVendor。不过，我仍然有一个传统的创建视图，我不想这样做。
2.  不要让我的创建操作带任何参数。相反，手动查看表单键并从“Name”或“NewVendor.Name”中提取名称，以两者为准。
3.  让 Create 操作获取*两个*模型类并检测正确填充的模型类。这很像＃2，但我正在检查非空值的属性，而不是检查表单集合。
4.  弄清楚如何制作一个模型绑定器来执行 #2 正在做的事情。这似乎过于复杂，而且我将在许多页面中遇到这个问题，所以我希望有一个更简单的方法。
5.  使用 javascript 来发布帖子而不是提交表单，这样我就可以控制我发布的确切字段名称。这行得通，但我更喜欢利用 HTML 表单，因为这就是它的用途。
6.  使用重载`EditorFor`来指定字段名称，并手动创建验证消息。
7.  为可以覆盖字段名称`HtmlHelper`的新方法编写我自己的扩展方法。`ValidationMessageFor`

在这些选项中，#2 或 #5 是我认为我会选择的选项，除非有更好的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:51:43.813

好吧，这行得通：

```
@Html.EditorFor( model => model.NewVendor.Name, "string", "Name" )
@Html.ValidationMessage( "Name" ) 
```

由于我上面代码的唯一真正问题是验证消息损坏，这似乎解决了我的问题。我仍然很好奇是否有更好的整体解决方案。