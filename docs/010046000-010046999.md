# StackOverflow 问答 10046000-10046999

# java - 静态 index.html 文件 - servlet 容器首先被击中吗？

> ID：10046003
> 
> 赞同：2
> 
> 时间：2012-04-06T16:02:44.703
> 
> 标签：java, google-app-engine, static-files

在 appengine 中，index.html 是作为静态文件还是首先涉及到 servlet 容器？例如，假设我有 blabla.com 主机，war/index.html 并且用户访问 http://blbla.com/
我不希望首先命中 servlet 容器以确定它是 welocme 的一部分-file-list 在 web.xml 中配置，只有这样 appengine 才会将其作为静态文件提供。避免服务器往返的唯一方法是让用户点击网址[http://blabla.com/index.html](http://blabla.com/index.html)吗？
根据文档[https://developers.google.com/appengine/docs/java/gettingstarted/staticfiles](https://developers.google.com/appengine/docs/java/gettingstarted/staticfiles)说：
`By default, App Engine makes all files in the WAR available as static files except JSPs and files in WEB-INF/. Any request for a URL whose path matches a static file serves the file directly to the browser—even if the path also matches a servlet or filter mapping.`
所以现在的问题：如果我在欢迎文件列表中指定了“index.html”，以下哪项是正确的用户点击[http://blabla.com](http://blabla.com)

1.  appengine 知道它必须将 index.html 直接作为静态文件提供服务，并且我的 servlet 容器不需要检查欢迎文件列表。
2.  appengine 不知道它必须从静态文件中提供 index.html 并且我的 servlet 容器被命中只是为了检查 welcome-files-list 然后允许 appengine 将其作为静态文件获取。

如果是 2：将 html 文件用作静态文件的唯一方法是让用户直接在 url 中点击它们，即[http://blabla.com/index.html](http://blabla.com/index.html)？这是非常重要的时刻，因为这意味着您的 servlet 容器可能会在每个请求时间执行额外的工作来解析欢迎文件列表，这会导致浪费 cpu，如果用户指定了 html 文件的直接路径，则可以避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:06:17.300

默认情况下，App Engine 将 WAR 中的所有文件作为静态文件提供，但 JSP 和 WEB-INF/ 中的文件除外。对路径与静态文件匹配的 URL 的任何请求都将文件直接提供给浏览器——即使该路径也与 servlet 或过滤器映射匹配。您可以使用 appengine-web.xml 文件配置 App Engine 将哪些文件视为静态文件。

但是您不能将 url“/”设置为静态文件。

请参阅[文档](https://developers.google.com/appengine/docs/java/gettingstarted/staticfiles)。

# cuda - CUDA 3D 数组分配和复制

> ID：10046007
> 
> 赞同：2
> 
> 时间：2012-04-06T16:03:20.553
> 
> 标签：cuda

**`cudaMallocPitch()`**3D数组分配和复制有什么对应的方法**`cudaMemcpy2D()`**吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:47:47.510

```
cudaMalloc3D()
cudaMalloc3DArray()
cudaMemcpy3D() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-22T06:48:45.473

您还可以通过定义as`cudaMallocPitch()`来为 3D 数据分配线性设备内存，并在内核中获得合并访问，只要您考虑到返回的音高和一些索引算法。`height``height * depth``cudaMallocPitch()`

同样，您可以使用`cudaMalloc3D()`在设备上分配逻辑 1D、2D 或 3D 内存对象并`pitchedDevPtr`在内核中使用。

# jquery - $.jquery ajax 返回的数据 (json) 显示为“未定义”

> ID：10046010
> 
> 赞同：8
> 
> 时间：2012-04-06T16:03:50.877
> 
> 标签：jquery, ajax, json

在这里，我有一个简单的 php 脚本，它以 json 格式显示数据库中的一些值。

```
$source = $_GET['source'];

$query = mysql_query("SELECT * FROM images WHERE big_thumb = '" . $source . "'");

$results = array();

while($row = mysql_fetch_array($query))
{
   $results[] = array(
      'title' => $row['title'],
      'date' => $row['upload_date'],
      'time' => $row['upload_time']
   );
}

$json = json_encode($results);

echo $json; 
```

这显示很好，这是一个输出示例：

```
[{"title":"Torus","date":"2012-04-04","time":"23:06:14"}] 
```

然后，当单击图像时，将调用此 jquery：

```
var image_src = $(this).attr("alt"); // <= This works fine

    $.ajax({
        url: 'inc/get_image_details.php',
        data: {source : image_src},
        dataType: "json",
        success: function(data)
        {
            title = data.title;
            alert(title);

            date = data.date;
            alert(date);

            time = data.time;
            alert(time);
        }
    }); 
```

但是，（标题、日期和时间）变量在警告框中显示为“未定义”。我尝试了多种实现ajax调用的方法，每次都发生同样的事情。这是我第一次尝试它，但我无法理解。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-06T16:05:47.340

您的 json 字符串具有数组格式。您需要像这样访问 json 对象属性

```
title = data[0].title;
alert(title);

date = data[0].date;
alert(date);

time = data[0].time;
alert(time); 
```

如果您控制 json 格式并且不需要数组，请使用该格式的 json 对象。

```
{"title":"Torus","date":"2012-04-04","time":"23:06:14"} 
```

在这种情况下，您可以保持代码不变。

# c# - jquery“async = true”调用.net web服务不能异步工作

> ID：10046012
> 
> 赞同：3
> 
> 时间：2012-04-06T16:04:19.307
> 
> 标签：c#, asp.net, jquery

我有一个 .NET 网络服务，我需要从 jQuery 异步访问它并根据从服务获得的结果更新网格。我的问题是，服务命中仅在第一次是异步的，随后的请求是同步的（即使在 ajax 调用中指定 async=true 之后），如下所示

```
jQuery.ajax({
            type: "POST",
            url: url,
            data: data,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: true,
            success: function(msg) {
                var result = msg.d;
                return callback(result);
            },
            error: $.callDotNetSM.onError
        }); 
```

我的 .NET 服务方法如下所示。

```
[WebMethod(EnableSession = true)]
public static string GetData()
{
} 
```

所以，请帮助我一直异步调用服务。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T16:08:53.393

正在调用您的 WebMethod 的页面需要在页面指令中具有以下内容：

```
<%@ Page Async="true" EnableSessionState="False" %> 
```

这样做的原因是 ASP.NET 每次访问 Session 时都会锁定它，使其无法异步运行。即使您不在 WebMethod 中使用 Session ，页面仍然认为它默认使用它，除非您另有说明。

**编辑：**

你的问题也可能是你有`EnableSession="true"`. 您可能只需将其设置为 false。

# android - 未为 Facebook 类型定义 Authorize、AuthorizeCallback

> ID：10046014
> 
> 赞同：0
> 
> 时间：2012-04-06T16:04:38.850
> 
> 标签：android, facebook

好吧，正如标题中所说，我在放置 SSO 代码的类上遇到两个错误：

1) “未定义 Facebook 类型的 Authorize 方法”... 2) “未定义构造函数 Facebook”...

我收到 AuthorizeCallback 的相同错误...

我不知道该怎么办......我按照“FB”创建的教程（“Android教程”）......

这是代码：

```
package my.package.namespace;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import com.facebook.android.*;
import com.facebook.android.Facebook.*;

public class Facebook extends Activity {

    Facebook fbclient = new Facebook("myappid");

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        fbclient.authorize(this, new DialogListener() {
            @Override
            public void onComplete(Bundle values) {}

            @Override
            public void onFacebookError(FacebookError error) {}

            @Override
            public void onError(DialogError e) {}

            @Override
            public void onCancel() {}
        });
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        fbclient.authorizeCallback(requestCode, resultCode, data);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-12T19:35:26.173

尝试将您的活动重命名为其他名称（“Facebook”除外）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T20:39:54.447

花花公子点击此链接[如何将 Facebook API 集成到 Android 应用程序中？](https://stackoverflow.com/questions/9924453/how-to-integrate-facebook-api-in-android-application/9924681#9924681)由我回答，这是一个有效的例子。只需下载项目并在 Eclipse 中导入并尝试运行在应用程序运行之前检查一件事是否正确添加了参考库。

# objective-c - 使用 Xcode 4 编译 libogg

> ID：10046023
> 
> 赞同：4
> 
> 时间：2012-04-06T16:05:14.103
> 
> 标签：objective-c, xcode, macos, ogg

我刚刚从[http://www.xiph.org/downloads/](http://www.xiph.org/downloads/) (http://downloads.xiph.org/releases/ogg/libogg-1.3.0.tar.gz) 下载了 libogg，我现在正在尝试编译该包中提供的 Ogg.xcodeproj 项目。当我尝试构建时，我收到以下错误：

> 运行目标 My Mac 64 位对于运行方案“Ogg”无效。
> 
> 方案“Ogg”不包含可以为运行目标 My Mac 64 位支持的 SDK 构建的可构建项目。确保您的目标都指定了此版本 Xcode 支持的 SDK。

如果我尝试构建静态库而不是框架，我会收到类似的错误：

> 运行目标 My Mac 64 位对运行方案“libogg (static)”无效。
> 
> 方案“libogg（静态）”不包含可以为运行目标 My Mac 64 位支持的 SDK 构建的可构建项目。确保您的目标都指定了此版本 Xcode 支持的 SDK。

同样，这只是第一次在 Xcode 4.3.2 中打开项目并尝试构建。我根本没有对项目文件进行任何更改。

任何人都可以指出解决方案的方向来编译它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-29T22:20:23.783

就我而言，Xcode 项目链接到旧架构上的旧 SDK（OS X 10.5 PPC，而我有 OS X 10.8 Mountain Lion x64）。

要在 Xcode 5 中解决此问题，请选择 Xcode 中的顶级项目（项目文件夹窗格中的最顶层节点，带有蓝色“A”图标），然后选择项目。**将Architectures**更改为适合您当前系统的内容，例如**Build machine 的 Native Architecture**并将**Base SDK**更改为当前安装在您的 Xcode 环境中的 SDK，例如**OS X 10.8**。

这是我的项目的屏幕截图，可帮助您找到这些设置（在突出显示的部分之后：**kisshelper** > **Kisshelper** > **Architectures**）：

![在此处输入图像描述](../Images/2a7677a456d5bfb5b59273f704ad7352.png)

# git - 从 Private Repo 下载 Git 归档 tarball 时遇到问题

> ID：10046027
> 
> 赞同：21
> 
> 时间：2012-04-06T16:05:24.770
> 
> 标签：git, github

我需要能够以特定标签下载我们的应用程序，但我无法找到一个可行的解决方案。下载基于 git tag 的 tarball 似乎很有希望，但我无法使用 Curl 让它工作。我尝试了以下方法，但我得到的只是 github 404 页面的源代码。

```
curl -sL https://github.com/$ACCOUNT/$PRIVATE_REPO/tarball/0.2.0.257m?login=$MY_USER_NAME&token=$MY_TOKEN > 0.2.0.257m.tar 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-07T09:47:47.743

对于公共回购，你有[这个要点](https://gist.github.com/758124)列出了一些例子：

```
wget --no-check-certificate https://github.com/sebastianbergmann/phpunit/tarball/3.5.5 -O ~/tmp/cake_phpunit/phpunit.tgz 
```

对于私人仓库，请尝试在 post 指令中传递您的凭证信息：

```
wget --quiet --post-data="login=${login}&token=${token}" --no-check-certificate https://github.com/$ACCOUNT/$PRIVATE_REPO/tarball/0.2.0.257m 
```

或者使用 curl 命令，如 SO 问题“ [git 等价于`svn export`或 github 解决方法](https://stackoverflow.com/a/9329607/6309)”，也在：
“[**使用 GitHub 的 API 的 curl 教程**](https://gist.github.com/2288960)”中进行了详细说明。

* * *

[OP Steven Jp](https://stackoverflow.com/users/1317806/steven-jp)报告已使`curl`命令工作：

> 最终的 curl 命令最终看起来像这样：

```
curl -sL --user "${username}:${password}" https://github.com/$account/$repo/tarball/$tag_name > tarball.tar 
```

（为了便于阅读，多行）

```
curl -sL --user "${username}:${password}" 
  https://github.com/$account/$repo/tarball/$tag_name
  > tarball.tar 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-09-11T08:36:10.510

创建[访问令牌](https://help.github.com/articles/creating-an-access-token-for-command-line-use)后，

你可以使用`wget`：

```
wget --output-document=<version>.tar.gz \
    https://api.github.com/repos/<owner>/<repo>/tarball/<version>?access_token=<OAUTH-TOKEN> 
```

或`curl`：

```
curl -L https://api.github.com/repos/<owner>/<repo>/tarball/<version>?access_token=<OAUTH-TOKEN> \
    > <version>.tar.gz 
```

更多信息可以在[GitHub 的存档链接 API 参考](https://developer.github.com/v3/repos/contents/#get-archive-link)中找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-12T15:37:55.373

在 Github.com 上登录您的私人组织，然后前往此处创建您的令牌： [https ://github.com/settings/applications#personal-access-tokens](https://github.com/settings/applications#personal-access-tokens)

尝试卷入您的私人组织时，请使用以下内容：

```
curl --header 'Authorization: token ADDACCESSTOKENHERE' \
 --header 'Accept: application/vnd.github.v3.raw' \
 --remote-name \
 --location https://api.github.com/repos/ORG/PROJECT/contents/FILE 
```

用您的信息替换 CAPS 中的内容...

# concurrency - (Mono) Mod-mono 与自定义服务器对并发请求数的限制

> ID：10046028
> 
> 赞同：0
> 
> 时间：2012-04-06T16:05:29.550
> 
> 标签：concurrency, mono, tcplistener

我读到 Mod-Mono 对并发请求的数量有限制，具体取决于：

MonoMaxActiveRequests 20

MonoMaxWaitingRequests 20

[http://www.mono-project.com/Mod_mono](http://www.mono-project.com/Mod_mono)

如果我有一个在单声道下运行的自定义 .NET 服务器（使用 tcplistener），它是否有类似的限制？如果是，我在哪里可以更改该限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:11:14.433

Mod-mono 是一个运行单声道应用程序的 apache 模块，`MonoMaxActiveRequests`并且`MonoMaxWaitingRequests`是 mod-mono 添加的 apache 指令。如果您在端口 80 上使用带有 tcp 侦听器的自定义 .NET 服务器，则不需要 apache。因为您是通过 .NET 直接执行此操作的。所以不会有 mod-mono 和指令。

> 它有类似的限制吗？

答案是**否定的**

# linux - 套接字可视化工具

> ID：10046029
> 
> 赞同：2
> 
> 时间：2012-04-06T16:05:30.173
> 
> 标签：linux, sockets, visualization

是否有任何工具可以动态地以图形方式显示绑定套接字和连接的客户端之间的迭代？在具有多个同时交互的套接字中调试问题可能是一个巨大的混乱，我认为以图形方式显示交互对于理解服务器交互中发生的事情有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-15T20:16:04.350

如果看大图对你来说已经足够了——进程层次结构和它们之间的连接（TCP 套接字、Unix 域套接字、管道）——你可以试试 ipcvis：

[https://sourceforge.net/projects/ipcvis/](https://sourceforge.net/projects/ipcvis/)

该工具记录不同状态的进程层次结构和套接字信息，然后可视化状态之间的新关系：

[http://youtu.be/8XFKwzkexQY](http://youtu.be/8XFKwzkexQY)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T18:01:08.390

我不知道图形应用程序本身。

但是，tcpdump 或（对于那些需要 GUI 的人）wireshark 非常擅长向您显示正在发送的数据包，这通常是您真正想要的。

# c++ - 通过引用递归 lambda

> ID：10046035
> 
> 赞同：1
> 
> 时间：2012-04-06T16:06:13.813
> 
> 标签：c++, lambda, c++11

这段代码正确吗？

```
std::function<int(int)> f = [&f](int n) -> int
{
    return n <= 1 ? 1 : n * f(n - 1);
};

int x = f(42); 
```

对象构造在作为对 lambda 的引用之前是否存在任何潜在问题？或者这段代码绝对正确？

按值捕获 f 会导致 msvc2010 编译器崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:25:40.827

只要您遵循对存储在 lambdas 中的堆栈变量的引用规则，这应该可以正常工作。它是定义明确的 C++11 代码。

# java - java字符串...！

> ID：10046036
> 
> 赞同：-4
> 
> 时间：2012-04-06T16:06:23.130
> 
> 标签：java, string

我目前正在使用`StringTokennizer`类通过定义的分隔符将字符串拆分为不同的标记

```
 public class App {  
        public static void main(String[] args) {  

            String str = "This is String , split by StringTokenizer, created by saral";  
            StringTokenizer st = new StringTokenizer(str);  

            System.out.println("---- Split by comma ',' ------");  
            StringTokenizer st2 = new StringTokenizer(str, ",");  

            while (st2.hasMoreElements()) {  
                System.out.println(st2.nextElement());  
            }  
        }  
    } 
```

请告诉我更多替代方法来实现这一点，如 jdk 5 支持扫描仪和 java .util，正则表达式......！请指教..！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:08:49.360

你可以使用`java.lang.String.split()`方法：

```
String str = ...;
String[] tokens = str.split(",");

for (String s: tokens)
{
    System.out.println(s);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:09:39.770

您可以只使用[String.split](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)。

```
String str = "This is String , split by StringTokenizer, created by saral";
String[] arr = str.split(","); 
```

现在，`arr`将是一个数组，其中包含`str`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:12:43.033

`StringTokenizer`出于所有实际目的已[弃用](https://stackoverflow.com/questions/6983856/why-is-stringtokenizer-deprecated)，它仅用于向后兼容。请改用该方法[`split()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split(java.lang.String))，如下所示：

```
String[] splitted = str.split(","); 
```

现在返回的`String[]`将包含令牌。

# node.js - Node.js 发送文件作为响应

> ID：10046039
> 
> 赞同：133
> 
> 时间：2012-04-06T16:06:28.803
> 
> 标签：node.js

Expressjs 框架有一个`sendfile()`方法。在不使用整个框架的情况下如何做到这一点？

我正在使用 node-native-zip 创建一个存档，我想将它发送给用户。

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2012-04-06T17:35:50.427

这是一个示例程序，它将通过从磁盘流式传输 myfile.mp3 来发送它（也就是说，它不会在发送文件之前将整个文件读入内存）。服务器侦听端口 2000。

**[更新]**正如@Aftershock 在评论中提到的那样，`util.pump`它已经消失并被 Stream 原型上的一个方法替换为`pipe`; 下面的代码反映了这一点。

```
var http = require('http'),
    fileSystem = require('fs'),
    path = require('path');

http.createServer(function(request, response) {
    var filePath = path.join(__dirname, 'myfile.mp3');
    var stat = fileSystem.statSync(filePath);

    response.writeHead(200, {
        'Content-Type': 'audio/mpeg',
        'Content-Length': stat.size
    });

    var readStream = fileSystem.createReadStream(filePath);
    // We replaced all the event handlers with a simple call to readStream.pipe()
    readStream.pipe(response);
})
.listen(2000); 
```

取自[http://elegantcode.com/2011/04/06/taking-baby-steps-with-node-js-pumping-data-between-streams/](http://elegantcode.com/2011/04/06/taking-baby-steps-with-node-js-pumping-data-between-streams/)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2016-08-10T08:26:05.033

您需要使用 Stream 在响应中发送文件（存档），更重要的是，您必须在响应标头中使用适当的 Content-type。

有一个示例函数可以做到这一点：

```
const fs = require('fs');

// Where fileName is name of the file and response is Node.js Reponse. 
responseFile = (fileName, response) => {
    const filePath = "/path/to/archive.rar"; // or any file format

    // Check if file specified by the filePath exists
    fs.exists(filePath, function (exists) {
        if (exists) {
            // Content-type is very interesting part that guarantee that
            // Web browser will handle response in an appropriate manner.
            response.writeHead(200, {
                "Content-Type": "application/octet-stream",
                "Content-Disposition": "attachment; filename=" + fileName
            });
            fs.createReadStream(filePath).pipe(response);
            return;
        }
        response.writeHead(400, { "Content-Type": "text/plain" });
        response.end("ERROR File does not exist");
    });
} 
```

> Content-Type 字段的目的是充分描述正文中包含的数据，以便接收用户代理可以选择适当的代理或机制将数据呈现给用户，或者以适当的方式处理数据。

“application/octet-stream”在 RFC 2046 中被定义为“任意二进制数据”，这种内容类型的目的是保存到磁盘 - 这是您真正需要的。

"filename=[name of file]" 指定要下载的文件名。

有关更多信息，请参阅[此 stackoverflow 主题](https://stackoverflow.com/questions/20508788/do-i-need-content-type-application-octet-stream-for-file-download)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-06-01T07:53:30.883

这对我有帮助。`/your-route`到达路线后，它将立即开始下载文件。

```
app.get("/your-route", (req, res) => {

         let filePath = path.join(__dirname, "youe-file.whatever");

         res.download(filePath);
} 
```

是`download`的也是一种表达方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-05-07T21:41:25.707

有点晚了，但快递有一个帮手，让生活更轻松。

```
app.get('/download', function(req, res){
  const file = `${__dirname}/path/to/folder/myfile.mp3`;
  res.download(file); // Set disposition and send it.
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-26T13:18:09.627

如果您需要仅使用 Node.js 本机发送 gzipped 文件：

```
const fs = require('fs') // Node.js module
const zlib = require('zlib') // Node.js module as well

let sendGzip = (filePath, response) => {
    let headers = {
        'Connection': 'close', // intention
        'Content-Encoding': 'gzip',
        // add some headers like Content-Type, Cache-Control, Last-Modified, ETag, X-Powered-By
    }

    let file = fs.readFileSync(filePath) // sync is for readability
    let gzip = zlib.gzipSync(file) // is instance of Uint8Array
    headers['Content-Length'] = gzip.length // not the file's size!!!

    response.writeHead(200, headers)

    let chunkLimit = 16 * 1024 // some clients choke on huge responses
    let chunkCount = Math.ceil(gzip.length / chunkLimit)
    for (let i = 0; i < chunkCount; i++) {
        if (chunkCount > 1) {
            let chunk = gzip.slice(i * chunkLimit, (i + 1) * chunkLimit)
            response.write(chunk)
        } else {
            response.write(gzip)
        }
    }
    response.end()
} 
```

# sql - 向连接行添加附加信息

> ID：10046041
> 
> 赞同：0
> 
> 时间：2012-04-06T16:06:43.453
> 
> 标签：sql, tsql, join

如何向连接行添加其他信息？

```
SELECT column1, column2
FROM table1
LEFT JOIN table2 
    ON column1 = col1_table2 //The row which matches with this join should have additional information e.g. "'joined' AS info 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:08:53.687

如果我理解你的问题，这应该有效：

```
SELECT 
    t1.column1, 
    t1.column2, 
    CASE WHEN t2.col1_table2 IS NOT NULL THEN 'joined' END AS info
FROM table1 t1
LEFT JOIN table2 t2 ON t1.column1 = t2.col1_table2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T16:09:31.427

尝试这个：

```
SELECT column1, 
       column2,  
       CASE WHEN col1_table2 IS NOT NULL THEN 'joined' END AS additional_field 
FROM table1
LEFT JOIN table2 ON column1 = col1_table2 
```

# python - Pip/easy_install 在 SciPy 安装中忽略 ARCHFLAGS？

> ID：10046043
> 
> 赞同：3
> 
> 时间：2012-04-06T16:06:51.580
> 
> 标签：python, gcc, architecture, scipy, pip

我正在尝试为 32 位和 64 位架构编译 SciPy，因为一些使用该库的应用程序只是一个拱门或其他拱门，遵循[一些](https://stackoverflow.com/questions/5427157/cannot-install-psycopg2-on-osx-10-6-7-with-xcode4) [SO](https://stackoverflow.com/q/5366882/218118) [questions](https://stackoverflow.com/questions/6988528/why-is-gcc-ignoring-archflags-in-snow-leopard)的建议。大约两个月前，这个命令在一个类似的版本中对我有用，但现在似乎一些编译的共享库只针对 x86_64：

`sudo ARCHFLAGS="-arch i386 -arch x86_64" pip install scipy`

我已经尝试过这个命令的几个版本，包括之前设置环境变量`sudo`，包括`-m32 -m64`在 FFlags 中，使用 OSX 命令行工具，完整的 Xcode 安装，使用 clang 而不是 OSX 附带的 LLVM，遵循[官方 SciPy 安装说明](http://www.scipy.org/Installing_SciPy/Mac_OS_X#head-9ec15aabd402675e5139a8c9c727e6a23513d56a)， easy_install 而不是 pip 甚至 ./configure'ing 单独等，但我似乎无法让它工作。奇怪的是，有些 .so 是用两种架构构建的，但有些不是：

```
dhcp-10-249-71-202:~ kastman$ file /Library/Python/2.7/site-packages/scipy/optimize/*.so
/Library/Python/2.7/site-packages/scipy/optimize/_cobyla.so:   Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/_lbfgsb.so:   Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/_minpack.so:  Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/_nnls.so:     Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/_slsqp.so:    Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/_zeros.so:    Mach-O universal binary with 2 architectures
/Library/Python/2.7/site-packages/scipy/optimize/_zeros.so (for architecture i386): Mach-O bundle i386
/Library/Python/2.7/site-packages/scipy/optimize/_zeros.so (for architecture x86_64):   Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/minpack2.so:  Mach-O 64-bit bundle x86_64
/Library/Python/2.7/site-packages/scipy/optimize/moduleTNC.so: Mach-O universal binary with 2 architectures
/Library/Python/2.7/site-packages/scipy/optimize/moduleTNC.so (for architecture i386):  Mach-O bundle i386
/Library/Python/2.7/site-packages/scipy/optimize/moduleTNC.so (for architecture x86_64):    Mach-O 64-bit bundle x86_64 
```

查看 make 日志，看起来对于似乎工作的库和不工作的库，args 都已成功传递：

```
# Minpack doesn't build fat binaries
/usr/local/bin/gfortran -Wall -Wall -undefined dynamic_lookup -bundle build/temp.macosx-10.7-intel-2.7/build/src.macosx-10.7-intel-2.7/scipy/optimize/minpack2/minpack2module.o build/temp.macosx-10.7-intel-2.7/build/src.macosx-10.7-intel-2.7/fortranobject.o build/temp.macosx-10.7-intel-2.7/scipy/optimize/minpack2/dcsrch.o build/temp.macosx-10.7-intel-2.7/scipy/optimize/minpack2/dcstep.o -L/usr/local/gfortran/lib/gcc/x86_64-apple-darwin11/4.6.2 -Lbuild/temp.macosx-10.7-intel-2.7 -lgfortran -o build/lib.macosx-10.7-intel-2.7/scipy/optimize/minpack2.so
building 'scipy.optimize._slsqp' extension
compiling C sources
C compiler: clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -fwrapv -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe

#... but moduleTNC does.
llvm-gcc-4.2 -Wl,-F. -bundle -undefined dynamic_lookup -Wl,-F. -arch i386 -arch x86_64 build/temp.macosx-10.7-intel-2.7/scipy/optimize/tnc/moduleTNC.o build/temp.macosx-10.7-intel-2.7/scipy/optimize/tnc/tnc.o -Lbuild/temp.macosx-10.7-intel-2.7 -o build/lib.macosx-10.7-intel-2.7/scipy/optimize/moduleTNC.so
building 'scipy.optimize._cobyla' extension
compiling C sources
C compiler: clang -fno-strict-aliasing -fno-common -dynamic -g -Os -pipe -fno-common -fno-strict-aliasing -fwrapv -mno-fused-madd -DENABLE_DTRACE -DMACOSX -DNDEBUG -Wall -Wstrict-prototypes -Wshorten-64-to-32 -DNDEBUG -g -fwrapv -Os -Wall -Wstrict-prototypes -DENABLE_DTRACE -arch i386 -arch x86_64 -pipe 
```

有没有可能是我使用的 gfortran 编译器不同？`brew install gfortran`根据 SciPy 文档，我使用的应该是好的。我认为重要的行将是**C 编译器：clang**行，它似乎几乎相同，包括两个 -arch。

我尝试过的最后一个最详细的构建是：

`sudo env ARCHFLAGS="-arch i386 -arch x86_64" ARCH="i386 x86_64" CC="clang" CXX="clang" FFLAGS="-ff2c -m32 -m64" pip install scipy`

有人对如何进一步诊断有建议吗？

（OSX 10.7，最近的 MacBookPro，使用来自 CLI 工具和 Xcode 的 gcc 编译）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-08T14:49:22.727

从源代码和构建中提取似乎可以正确创建胖二进制文件。我不确定这是否是一个已经修复的错误（我在 scipy 开发人员列表中没有看到任何内容）或者它是否与 pip/easy_install 有关，但这是我为使其工作所做的工作：

```
git clone https://github.com/scipy/scipy.git; cd scipy
export ARCHFLAGS='-arch i386 -arch x86_64'
python setup.py config
python setup.py build
sudo python setup.py install 
```

没有特殊的 CC 环境变量，gfortran 来自`brew install gfortran`，令人惊讶的是它看起来 gcc 是 llvm-gcc。

# java - 使用多线程递增/递减/打印（代码审查）

> ID：10046044
> 
> 赞同：0
> 
> 时间：2012-04-06T16:06:55.610
> 
> 标签：java, multithreading, concurrency, synchronized

我试图编写一个代码，其中多个线程调用共享对象上的方法来递增/递减/打印存储在其中的计数器。我还想要这些数字在 0 和 8 之间波动。即输出可能如下所示：0123234567654566677877666655 ....

有人可以看看我所做的事情，并就我是否走在正确的轨道上给我一些指示：

我的共享对象：

```
public class SyncObj{
        private int i;
        public synchronized void inc(){
                if(i<8)
                  i++;
        }
        public synchronized void dec(){
                if(i > 0)
                   i--;
        }
        public synchronized void print(){
                System.out.print(i);
        }
} 
```

为了防止打印出现饥饿并确保打印每个 inc/dec，我可以有一个名为 hasPrinted 的私有变量并重写该类，如下所示：

```
public class SyncObj{
            private int i;
            //Changed Boolean to boolean as Keith Randall pointed out
            private boolean hasPrinted = false;
            public synchronized void inc(){
                    if(i<8 && hasPrinted){
                      i++;
                      hasPrinted = false;
                    }
            }
            public synchronized void dec(){
                    if(i > 0 && hasPrinted){
                       i--;
                       hasPrinted = false;
                    }
            }
            public synchronized void print(){
                    System.out.print(i);
                    hasPrinted = true;
            }
    } 
```

有人可以查看上面的片段并查看它的陷阱和陷阱吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:12:58.900

`Boolean`-> `boolean`，没有必要使用对象而不是原始类型。

你的第一个代码很好。您的第二个代码不能解决您防止饥饿或确保打印每个 inc/dec 的要求。为什么不让 inc/dec 打印值本身？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T18:08:20.473

您应该习惯于使用队列进行打印。

```
public class SyncObj {
  private volatile int i;
  private BlockingQueue<Integer> q = new LinkedBlockingQueue<Integer>();
  public synchronized void inc() {
    if (i < 8) {
      i++;
      q.add(i);
    }
  }
  public synchronized void dec() {
    if (i > 0) {
      i--;
      q.add(i);
    }
  }
  public void print() {
    for (Integer i = q.poll(); i != null; i = q.poll()) {
      System.out.print(i);
    }
  }
  private static volatile boolean stop = false;
  public static void main(String[] args) throws InterruptedException {
    final SyncObj o = new SyncObj();

    new Thread(new Runnable() {
      @Override
      public void run() {
        while (!stop) {
          o.inc();
        }
      }
    }).start();

    new Thread(new Runnable() {
      @Override
      public void run() {
        while (!stop) {
          o.dec();
        }
      }
    }).start();

    new Thread(new Runnable() {
      @Override
      public void run() {
        while (!stop) {
          o.print();
        }
      }
    }).start();

    Thread.currentThread().sleep(1000);
    stop = true;
  }
} 
```

我的输出如下所示：

`1012345678765432101234567876543210123456787654321012345678765432101234567876543210123456787654321012345678`

# ruby-on-rails - finerycms 2.0.3，为页面指定样式表

> ID：10046047
> 
> 赞同：1
> 
> 时间：2012-04-06T16:07:19.803
> 
> 标签：ruby-on-rails, refinerycms

我想指定一个仅在我在页面上时适用的 CSS。我没有找到解决方案。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T09:18:36.550

在配置文件 pages.rb 中使 config.use_view_templates = true
的标志为true

它将为您提供为该页面选择模板的选项。
您可以在管理页面选项卡 -> 高级选项下找到它。
您还需要在 pages.rb

config.view_template_whitelist中添加模板名称

现在您可以在该页面上添加样式。
希望它可以帮助你。

# objective-c - UIViewController 中的 UIViewController

> ID：10046048
> 
> 赞同：0
> 
> 时间：2012-04-06T16:07:26.070
> 
> 标签：objective-c, ios, cocoa-touch

所以我有一个viewControllerA，我想向它添加另一个由viewControllerB管理的视图。在 viewControllerB 中只有一个 UISlider 激活了一个简单的操作。如果我不触摸这个 UISlider，它不会崩溃，一旦我使用 UISlider，它就会崩溃。我正在使用 ARC。我在用：

```
[self.view addSubView: viewControllerB.view]; 
```

将 viewControllerB 添加到 viewControllerA。我错过了什么吗？谢谢。

好的。这看起来是一个非常简单的情况。我刚刚添加了一个视图控制器和一个动作。这是github上的演示项目代码：[https ://github.com/randomor/Demo](https://github.com/randomor/Demo)

我希望它工作的原因是因为我有另一个应用程序将在现场创建一个视图控制器并将其添加到另一个视图中。而且我不想以模态方式进行，因为我不希望新的视图控制器覆盖整个屏幕。谢谢。

解决方案：所以我现在只使用最新的 ViewController 包含 API：

```
[self addChildViewController:viewControllerB]; 
```

有用！只要我添加了这一行，事件就会被传递给它自己的控制器并停止崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:26:12.243

我建议您使用以下代码

在`ViewControllerA.h`

```
 #import "ViewControllerB.h" 
```

在`ViewControllerA.m`（您要推送新控制器的位置）

```
ViewControllerB *newController = [[ViewControllerB alloc]init];
[self presentModalViewController:newController animated:YES]; 
```

在`ViewControllerB.m`你将需要

```
[self.presentingViewController dismissModalViewControllerAnimated:YES]; 
```

让它再次消失。

关于一个打开屏幕的多个控制器（Apple ViewController Programming Guide）：

> ```
> Each custom view controller object you create is responsible for managing exactly 
> one screen’s worth of content. The one-to-one correspondence between a view controller 
> and a screen is a very important consideration in the design of your application. 
> You should not use multiple custom view controllers to manage different portions 
> of the same screen. Similarly, you should not use a single custom view controller 
> object to manage multiple screens worth of content. 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:35:36.897

你应该尽量避免嵌套 UIViewControllers 的做法。虽然它在 iOS5 中得到技术支持，但出于多种原因，包括您遇到的问题类型（您有一个指向 UIViewController 的悬空指针，这就是您崩溃的原因），但这是不明智的。

[http://blog.carbonfive.com/2011/03/09/abusing-uiviewcontrollers/](http://blog.carbonfive.com/2011/03/09/abusing-uiviewcontrollers/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:17:09.693

尽管这个问题非常模糊，但我想您没有保留对视图控制器 B 的引用，因此当视图 B 尝试与其交互时，它会导致 EXC_BAD_ACCESS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:17:51.143

设置为滑块目标的对象是什么？如果它是`EXC_BAD_ADDRESS`，那么您可能不会保留目标，很可能是滑块的视图控制器。

# ios - 如何提高区域跨界精度（模拟）（地理围栏）

> ID：10046050
> 
> 赞同：2
> 
> 时间：2012-04-06T16:07:42.280
> 
> 标签：ios, geolocation, location, ios-simulator, geofencing

我正在整理一个应用程序，当用户离开家时会触发通知。所以我已经实现了半径为 25 的区域监控。我遇到的问题是在模拟时（iPhone 模拟器 5.0），我设置了一个自定义位置（家）来设置区域边界。然后在区域边界之外输入另一个自定义位置，即在街道的尽头。但是该应用程序没有注册该区域的退出。只有当我设置家庭位置和地区，然后更改为 Apple 总部时，它才会注册并发出通知。该应用程序在后台模式下切换到显着的位置变化。但是在前台或后台时它有同样的问题。我正在寻找的，比如“提醒”应用程序，是让应用程序在退出/离开区域边界（即走到街道尽头）后很快发出通知。

这是我的一些 viewcontroller.m 文件：

```
- (void)viewDidLoad {
    [super viewDidLoad];

  // Create empty array to add region events to.
  updateEvents = [[NSMutableArray alloc] initWithCapacity:0];

  // Create location manager with filters set for battery efficiency.
  locationManager = [[CLLocationManager alloc] init];
  locationManager.delegate = self;
  locationManager.distanceFilter = kCLLocationAccuracyBest; //could try KLDistanceFilterNone;
  locationManager.desiredAccuracy = kCLLocationAccuracyBest;

  // Start updating location changes.
          [locationManager startUpdatingLocation];
}

- (void)viewDidAppear:(BOOL)animated {
  // Get all regions being monitored for this application.
  NSArray *regions = [[locationManager monitoredRegions] allObjects];

  // Iterate through the regions and add annotations to the map for each of them.
          for (int i = 0; i < [regions count]; i++) {
                    CLRegion *region = [regions objectAtIndex:i];
  RegionAnnotation *annotation = [[RegionAnnotation alloc] initWithCLRegion:region];
                    [regionsMapView addAnnotation:annotation];
                    [annotation release];
          }
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error {
  NSLog(@"didFailWithError: %@", error);
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
  NSLog(@"didUpdateToLocation %@ from %@", newLocation, oldLocation);

  // Work around a bug in MapKit where user location is not initially zoomed to.
          if (oldLocation == nil) {
  // Zoom to the current user location.
                    MKCoordinateRegion userLocation = MKCoordinateRegionMakeWithDistance(newLocation.coordinate, 100.0, 100.0);
                    [regionsMapView setRegion:userLocation animated:YES];
          }
}

- (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region  {
  NSString *event = [NSString stringWithFormat:@"didEnterRegion %@ at %@", region.identifier, [NSDate date]];

          [self updateWithEvent:event];
}

- (void)locationManager:(CLLocationManager *)manager didExitRegion:(CLRegion *)region {
  NSString *event = [NSString stringWithFormat:@"didExitRegion %@ at %@", region.identifier, [NSDate date]];
          [self updateWithEvent:event];
//implement local notification:
    UIApplication *app                = [UIApplication sharedApplication];
    UILocalNotification *notification = [[UILocalNotification alloc] init];
    [[UIApplication sharedApplication] cancelAllLocalNotifications];

    if (notification == nil)
        return;
    notification.alertBody = [NSString stringWithFormat:@"Did You Lock Your House?"];
    notification.alertAction = @"Lock House";
    notification.soundName = UILocalNotificationDefaultSoundName;
    notification.applicationIconBadgeNumber = 1;
    [app presentLocalNotificationNow:notification];

    [notification release];
// ends here

//following is an alert for the case of exiting boundary whilst app is in foreground
    UIAlertView *alr=[[UIAlertView alloc] initWithTitle:@"Reminder didExitRegion" message:region.identifier delegate:nil cancelButtonTitle:nil otherButtonTitles:@"Ok",nil];

    [alr show];

    [alr release];
    //ends here
}

- (void)locationManager:(CLLocationManager *)manager monitoringDidFailForRegion:(CLRegion *)region withError:(NSError *)error {
  NSString *event = [NSString stringWithFormat:@"monitoringDidFailForRegion %@: %@", region.identifier, error];

          [self updateWithEvent:event];
}

- (IBAction)addRegion {
  if ([CLLocationManager regionMonitoringAvailable]) {
  // Create a new region based on the center of the map view.
  CLLocationCoordinate2D coord = CLLocationCoordinate2DMake(regionsMapView.centerCoordinate.latitude, regionsMapView.centerCoordinate.longitude);
  CLRegion *newRegion = [[CLRegion alloc] initCircularRegionWithCenter:coord
                                                                                                                                                                              radius:25.0
                                                                                                                                                                   identifier:[NSString stringWithFormat:@"%f, %f", regionsMapView.centerCoordinate.latitude, regionsMapView.centerCoordinate.longitude]];

  // Create an annotation to show where the region is located on the map.
                    RegionAnnotation *myRegionAnnotation = [[RegionAnnotation alloc] initWithCLRegion:newRegion];
                    myRegionAnnotation.coordinate = newRegion.center;
                    myRegionAnnotation.radius = newRegion.radius;

                    [regionsMapView addAnnotation:myRegionAnnotation];

                    [myRegionAnnotation release];

  // Start monitoring the newly created region.
                    [locationManager startMonitoringForRegion:newRegion desiredAccuracy:kCLLocationAccuracyBest];

                    [newRegion release];
          }
  else {
  NSLog(@"Region monitoring is not available.");
          }
} 
```

这项工作源自“区域”模板。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-03T17:17:59.823

iOS 模拟器对于带有退出/进入的地理围栏更新是出了名的糟糕。您可以确认这一点的一种方法是将您的应用程序上的地理围栏设置为您的当前位置。然后，从 iOS 模拟器的调试菜单中，按 location，然后按 Freeway Drive。你的设备现在将模拟在高速公路上行驶，如果你的模拟器和我的一样，它不会注册 didExitRegion 事件。

为什么？区域主要由 Apple 的隐藏算法确定，该算法使用 Wi-Fi、手机信号塔和手机上请求位置的其他应用程序。将模拟器视为不使用 Wi-Fi 或手机信号塔……区域监控几乎是不可能的。

要在区域退出后测试其余代码是否正常工作，您可以创建一个按钮或手动触发您的 locationManager:didExitRegion: 方法的东西。我还强烈建议在您的设备上编译该项目，将其插入并从 iPhone 模拟器更改为您的 iOS 设备。然后，您可以拔下设备并从手机上运行您的应用程序来测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T00:37:28.527

这大约是您将获得的最佳准确性。区域匹配仅使用蜂窝塔三角测量，因此在密集区域可能会在 50-100 米处触发，而在稀疏区域可能需要 100 米。

如果您想要更精细的细节，那么您将需要使用直接定位服务。但这会消耗电池，所以选择你的毒药。

# c# - 无法使用户帖子的删除/更新/编辑唯一

> ID：10046054
> 
> 赞同：1
> 
> 时间：2012-04-06T16:08:07.137
> 
> 标签：c#, asp.net, asp.net-mvc-3, asp.net-mvc-3-areas

大家好，我有一个小问题可能是一个很难的问题，我试图在我的审查控制器的索引段中使用以下代码来做到这一点：

```
var Info = db.tblReviews.Include(x => x.tblGame).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
return View(Info); 
```

在我申请的审查控制器的第一次创建中：

```
ViewBag.GameIDFK = new SelectList(db.tblGames, "GameID", "GameName");
return View(new tblReview { UserName = @User.Identity.Name }); 
```

我的问题是我试图让人们对游戏发表评论，因为所有发布游戏的用户都是独一无二的，并且游戏只能由他们自己的帐户查看，但是在编辑/删除/更新时我不能获取它，以便发布游戏评论的用户只能删除/更新/编辑自己的游戏，而不是其他用户。

例如，我有两个名为 sham 和 bam 的虚构用户，每个用户都可以看到他们在评论页面上发布的游戏，但是在编辑/更新和删除评论时，两个用户都删除/编辑和更新彼此的帖子。

这是我的审查控制器：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using GameTest.Models;

namespace GameTest.Controllers
{ 
    public class ReviewController : Controller
    {
        private gamezoneDBEntities db = new gamezoneDBEntities();

        //
        // GET: /Review/

        public ViewResult Index()
        {
            var Info = db.tblReviews.Include(x => x.tblGame).Where(UserInfo => UserInfo.UserName.Equals(User.Identity.Name)).ToList();
            return View(Info); 
        }

        //
        // GET: /Review/Details/5

        public ViewResult Details(int id)
        {
            tblReview tblreview = db.tblReviews.Find(id);
            return View(tblreview);
        }

        //
        // GET: /Review/Create

        public ActionResult Create()
        {
            ViewBag.GameIDFK = new SelectList(db.tblGames, "GameID", "GameName");
            return View(new tblReview { UserName = @User.Identity.Name });
        } 

        //
        // POST: /Review/Create

        [HttpPost]
        public ActionResult Create(tblReview tblreview)
        {
            if (ModelState.IsValid)
            {
                db.tblReviews.Add(tblreview);
                db.SaveChanges();
                return RedirectToAction("Index");  
            }

            ViewBag.GameIDFK = new SelectList(db.tblGames, "GameID", "GameName", tblreview.GameIDFK);
            return View(tblreview);
        }

        //
        // GET: /Review/Edit/5

        public ActionResult Edit(int id)
        {
            tblReview tblreview = db.tblReviews.Find(id);
            ViewBag.GameIDFK = new SelectList(db.tblGames, "GameID", "GameName", tblreview.GameIDFK);
            return View(tblreview);
        }

        //
        // POST: /Review/Edit/5

        [HttpPost]
        public ActionResult Edit(tblReview tblreview)
        {
            if (ModelState.IsValid)
            {
                db.Entry(tblreview).State = EntityState.Modified;
                db.SaveChanges();
                return RedirectToAction("Index");
            }
            ViewBag.GameIDFK = new SelectList(db.tblGames, "GameID", "GameName", tblreview.GameIDFK);
            return View(tblreview);
        }

        //
        // GET: /Review/Delete/5

        public ActionResult Delete(int id)
        {
            tblReview tblreview = db.tblReviews.Find(id);
            return View(tblreview);
        }

        //
        // POST: /Review/Delete/5

        [HttpPost, ActionName("Delete")]
        public ActionResult DeleteConfirmed(int id)
        {            
            tblReview tblreview = db.tblReviews.Find(id);
            db.tblReviews.Remove(tblreview);
            db.SaveChanges();
            return RedirectToAction("Index");
        }

        protected override void Dispose(bool disposing)
        {
            db.Dispose();
            base.Dispose(disposing);
        }
    }
} 
```

如果您需要更多，请告诉我谢谢

非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:04:26.467

如果无法查看您的数据结构，很难回答这个问题，但我会尽力提供帮助。

我可以在您的`Index()`操作中看到您正在获取用户名来检索游戏。因此，看起来您的评论对象存储了对创建它的用户的一些引用。

因此，在更新/删除时，只需再次检索用户名，如果与评论对象上的用户名不匹配，则不要执行该操作。

```
 public ActionResult Edit(int id)
    {
        //See if this review id was created by the current user
        if(!db.tblReviews.Any(UserInfo => UserInfo.UserName.Equals(User.Identity.Name) && UserInfo.Id == id))
        {
            //Redirect the user away from this edit page, they can't edit this one.
        }

        tblReview tblreview = db.tblReviews.Find(id);
        ViewBag.GameIDFK = new SelectList(db.tblGames, "GameID", "GameName", tblreview.GameIDFK);
        return View(tblreview);
    } 
```

# java - Java：在运行时扩展类

> ID：10046056
> 
> 赞同：13
> 
> 时间：2012-04-06T16:08:32.720
> 
> 标签：java, inheritance, runtime, instantiation

我有能力在编译时扩展一个类，但是我需要能够在运行时使用已经实例化的超类的实例来创建这个子类的实例。

这在理论上应该是可能的，因为在子类构造函数之前已经调用了超类构造函数。

我没有足够的权限访问程序来将实例化更改为我的子类，也无法中断原始实例化。

用例：有一个现有的 X 类实例数组。我的代码是在之后加载的。我需要用我加载的子类 Y 扩展 X 覆盖实例 X 之一的方法之一。父程序仅通过该数组访问对象，因此我想用我的 Y 实例替换该数组元素，但它需要表现得好像它最初被实例化到该数组中一样。我不能只包含超类实例并转发调用，并且重新实例化超类存在困难的复杂性。

我希望这更清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T16:15:51.833

重申你正在尝试做的事情..

在 JVM 中，存在一个 ClassA 的实例。您想动态修改 ClassA 的类层次结构，以便存在一个名为 ClassB 的新类，它派生自 ClassA。然后你想实例化 ClassB 的一个实例，但它的子类实现是 ClassA 的现有实例。类似于内存替换的东西。

您可能想查看[http://www.jboss.org/javassist](http://www.jboss.org/javassist)。您需要做的是替换 ClassLoader，然后确定何时加载 ClassA，然后实例化。然后，您需要构造 ClassB 并返回它。

**更新**

经过更多的研究，您仍然有可能做您想做的事。IDE 之类的 Eclipse 在调试时支持 HotSwap 方法实现。他们使用 Instrumentation API。

[http://zeroturnaround.com/blog/reloading_java_classes_401_hotswap_jrebel/](http://zeroturnaround.com/blog/reloading_java_classes_401_hotswap_jrebel/)

您可以替换方法主体，但不能添加或删除方法本身。因此，虽然您无法将类型更改为新类型，但您可以用新实现完全替换方法实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T16:17:13.160

我建议使用[cglib](https://github.com/cglib/cglib)：

> cglib 是一个强大、高性能和高质量的代码生成库，用于扩展 JAVA 类并在运行时实现接口

您可以在这里找到一些示例： [https ://github.com/cglib/cglib/wiki](https://github.com/cglib/cglib/wiki)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T16:12:57.180

你看过 Java 代理吗？

这是 Javadoc 的一个片段：

“动态代理类（以下简称代理类）是在创建类时实现运行时指定的接口列表的类”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-06T17:34:32.160

我不知道这是否是一个解决方案，但如果你有

```
public static Foo foo = new Foo(); 
```

并且您想用扩展 Foo 的 Bar 替换它，使 Bar 成为 Foo 的 Wrapper 并使用反射让 foo 指向您的 Bar 实例。

```
public class Foo extends Bar {
  private bar; 
  public Foo(Bar oldInstance) {
     this.bar = oldInstance;
  }
} 
```

和

```
// exception handling ommitted
public static void onStartup() {
   Class fooRefClass = FooRef.class;
   Field fooRef = fooRefClass.getDeclaredField("foo");

   Foo foo = (Foo)fooRef.get(null);
   Bar bar = new Bar(foo);
   fooRef.set(null, bar); 
```

}

如前所述，我不知道您的情况是否可行。

# html - 如何在 html 的表格行中对齐背景图像？

> ID：10046057
> 
> 赞同：1
> 
> 时间：2012-04-06T16:08:33.657
> 
> 标签：html, css, image

我有以下代码在表格单元格中生成背景图像。我想将该图像放在单元格的中心。

```
<tr>
  <td valign="top" width=<%=width%>>
    <div id="loading" 
       style="background-image: url(spinner.gif); height: 16px; width: 16px;">
    </div>
  </td>
</tr> 
```

我试过`align=center`了，但没有用，也没有`text-align: center`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T16:09:34.187

### 将背景图像居中

您正在寻找[`background-position`](http://msdn.microsoft.com/en-us/library/ie/ms530718(v=vs.85).aspx)房产。

您还可以将属性合并到较短的[`background`](http://msdn.microsoft.com/en-us/library/ie/ms530722%28v=vs.85%29.aspx)属性中：

```
#loading {
  background: url(spinner.gif) no-repeat center center;
} 
```

### 在单元格中居中您的元素

您的问题的另一种解读是您希望将加载动画集中在表格单元格中。如果是这种情况，我会鼓励您使用 CSS 属性[`text-align`](http://msdn.microsoft.com/en-us/library/ie/ms531162%28v=vs.85%29.aspx)和[`vertical-align`](http://msdn.microsoft.com/en-us/library/ie/ms531179%28v=vs.85%29.aspx).

```
td.loading {
  text-align: center;
  vertical-align: middle;
} 
```

使用以下 HTML

```
<td class="loading">
  <img src="loader.gif" />
</td> 
```

[您可以在http://jsbin.com/udehox/](http://jsbin.com/udehox/)在线查看工作演示

值得注意的是 your`DIV`是一个块元素，默认情况下不显示`inline`。因此，您将无法将其“居中”，因为它的左侧或右侧不允许有任何空间。

您可以通过将`display: inline`or`display: inline-block`语句附加到它来强制它显示为内联元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:11:32.930

尝试 - 背景位置：中心；那应该做你正在寻找的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:15:03.587

看起来您正试图将单元格内的 div 居中。您可以在 div 上设置边距或使用相对定位。在图像上设置背景位置无济于事。div 设置为 16x16，我打赌这是图像的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:54:26.867

试试这个，

```
 <tr>
 <td valign="top" width=<%=width%>  align="center"  >
 <div id="loading" style="background:url(spinner.gif) no-repeat center center; width:16px;  height:16px;">
</div>
 </td>
 </tr> 
```

# sql-server-2008 - SSIS 平面文件目标防止在没有数据的字段中引用文本

> ID：10046065
> 
> 赞同：0
> 
> 时间：2012-04-06T16:09:01.800
> 
> 标签：sql-server-2008, ssis, export, flat-file

我在 SSIS (2008) 中创建了一个导出的 CSV 文件，其中的文本字段需要用引号引起来。很容易。但我的要求是，如果文本字段中没有数据，也不应该有引号。但是 SSIS 会在其中添加两个双引号。因此，SSIS 提供的不是这个，而是：

"字段 1 文本","","","字段 4 文本"

我需要这个：

"字段 1 文本",,,"字段 4 文本"

我在 SSIS 包中看不到执行此操作的方法，并且不希望在创建文件后在我的应用程序中删除它们。任何人都知道这是否可以在 SSIS 中完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T15:17:48.623

所以我想我只是坚持用代码打开由 SSIS 创建的文件并在那里进行编辑。这就是我走的方向，虽然它花了一段时间才奏效。我想有时我希望 SSIS 为我做的这些事情比我应该做的要多。

另外值得注意的是，我还必须以编程方式添加页眉和页脚记录，在 SSIS 中没有看到简单的方法。

# ruby-on-rails - 如何使用 CanCan 通过 current_user 加载 @user 资源

> ID：10046068
> 
> 赞同：0
> 
> 时间：2012-04-06T16:09:07.207
> 
> 标签：ruby-on-rails, cancan

我希望我的编辑和更新操作通过将 @user 设置为 current_user 来加载它。我已经尝试过`load_and_authorize_resource through: :current_user, only: [:edit, :update]`，但收到错误“#user 的未定义方法用户”。这是可能的还是我必须手动加载和授权@user？

# c++ - 删除指向不同指针类型的复制指针会导致内存泄漏吗？

> ID：10046069
> 
> 赞同：1
> 
> 时间：2012-04-06T16:09:09.280
> 
> 标签：c++, memory, pointers, memory-leaks

我在我的应用程序中缩小了我的 AVI 视频播放器内存泄漏的范围。我有以下代码：

```
...

LPBYTE pChunk = new BYTE[lSize];
if(!pChunk)
    return false;

hr = AVIStreamReadFormat(pStream, AVIStreamStart(pStream), pChunk, &lSize);
if(hr)
{
    delete [] pChunk;
    return false;
}

m_pVideoFormats[i] = (LPBITMAPINFO)pChunk; 
```

稍后当需要删除视频时，我只是删除：

```
if(m_pVideoFormats[i])
    delete [] ((LPBYTE)m_pVideoFormats[i]); 
```

由于我如何投射这个指针，这会导致内存泄漏吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:12:50.687

不，那不会泄漏。不管你如何转换它，重要的是你删除了你分配的相同类型。你已经匹配`BYTE[]`到`BYTE[]`，所以这不是你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:26:51.537

您的代码不会泄漏内存，但您正在做一些不必要的事情。

1.  检查`nullptr`after`new`是没有意义的，因为如果分配失败`std::bad_alloc`，则会抛出而不是返回。`nullptr`
2.  同样，检查`nullptr`before`delete`是不必要的，因为`delete [] nullptr`它是完全有效的。

此外，使用智能指针而不是管理指向原始内存块的指针。

```
std::unique_ptr<BYTE[]> pChunk;

try {
  pChunk.reset( new BYTE[lSize] );
} catch( const std::bad_alloc& ) {
  return false;
}

hr = AVIStreamReadFormat(pStream, AVIStreamStart(pStream), pChunk, &lSize);
if(hr)
{
    // delete [] pChunk; // not needed - smart pointer will free memory
    return false;
}

m_pVideoFormats[i] = (LPBITMAPINFO)pChunk.release();

...

delete [] ((LPBYTE)m_pVideoFormats[i]);
m_pVideoFormats[i] = nullptr; // set to nullptr to avoid double deletion 
```

# c# - 如何将面板从第二类添加到 BaseFrame

> ID：10046074
> 
> 赞同：0
> 
> 时间：2012-04-06T16:09:36.133
> 
> 标签：c#, object, user-controls, reference, flowlayoutpanel

如何将 Windows 窗体程序的 BasePanel 更改为公共的和非静态的，以便我可以像对象一样引用它？

例如，我有一个 basePanel，它使用 Visual Studios 2010 中的设计器，上面有一个 flowLayoutPanel。我还有第二个类“TaskDetails”，其中包含一个按钮“ButtonOne”。当 ButtonOne 被按下时，它会创建一个新的 TaskDetails 表单。填写详细信息并按下创建新任务按钮后，我想创建一个新的用户控件对象，我可以将其添加到 FlowLayoutPanel。

但是，我不知道如何引用FlowLayoutPanel，不知道basePanel的对象名称。

# iphone - iOS：如何获取当前应用程序语言

> ID：10046076
> 
> 赞同：25
> 
> 时间：2012-04-06T16:09:44.670
> 
> 标签：iphone, ios, localization, locale

我正在开发的应用程序支持 3 种语言：英语、法语和德语。

如何获取当前的应用程序语言（不是设备语言）？

问题是我必须获取应用程序的当前语言才能将其与请求一起发送到服务器，并且响应应该是正确的语言。设备语言没用，因为如果用户将操作系统语言切换为意大利语，则应用程序以英语运行，我需要将英语发送到服务器。

谢谢

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2014-07-23T14:18:49.273

接受的答案是一种解决方法。

关于设备本身的语言偏好，您有

```
[NSLocale preferredLanguages] 
```

这将为您提供系统常规设置中定义的首选语言的有序数组。

Cocoa Touch 框架将在加载应用程序的本地化资源时考虑此首选语言列表，并根据您在捆绑包中提供的翻译对其进行过滤。

可以通过以下方式获得经过过滤和排序的本地化语言列表

```
[[NSBundle mainBundle] preferredLocalizations] 
```

您的服务器请求应与此数组中的第一个值匹配，否则应用程序和服务器数据之间的语言将不匹配。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-04-06T16:40:27.483

我一直在做的事情：

将字符串条目添加到 Localizable.strings 文件中。我总是使用密钥`"lang"="de";`（或`"lang"="en"`等）。

然后你可以通过添加语言在你的 NSURLRequest 中使用它`NSLocalizedString(@"lang", @"")`

使用这种方法，您可以绝对控制要发送到后端的内容。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-03-17T15:06:09.410

你可以使用 NSBundle 类的 preferredLocalizations 方法：

```
NSString *currentLocalization = [[[NSBundle mainBundle] preferredLocalizations] objectAtIndex:0]; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-01-04T10:52:53.760

从 iOS 13 开始，可以为每个应用单独设置语言。

在 WWDC19 的“使用 Xcode 11 创建出色的本地化体验”会话中，他们展示了两个用于确定应用程序用户设置的选项。

获取当前运行的应用程序语言：

```
Bundle.main.preferredLocalizations.first 
```

给定外部语言代码列表，获取最佳语言：

```
let availableLanguages = Server.requestLanguages()
Bundle.preferredLocalizations(from: availableLanguages).first 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-06T16:55:21.923

当用户更改设备语言时，应用程序语言将更改，您可以从`NSUserDefaults`（如果您愿意，我将向您展示如何）获取它，除非有更改应用程序内部语言的选项，那么您可以轻松保存当前使用的语言并在需要时将其发送到服务器。

# eclipse-rcp - 如何用ICompilationUnit判断抽象类

> ID：10046077
> 
> 赞同：0
> 
> 时间：2012-04-06T16:09:46.220
> 
> 标签：eclipse-rcp, eclipse-jdt

我正在开发 eclipse 插件，所以我找到了 api 文档并在谷歌上搜索它们，它只包含带有 ICompilationUnit 的 isClass() isInterface() 这样的方法，但我想深入挖掘抽象类，代码如

```
public boolean isAbstract(ICompilationUnit icu) {
   //TODO
} 
```

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:39:43.573

首先，您需要一个 的实例`org.eclipse.jdt.core.IType`，因为一个实例`ICompilationUnit`可以包含多种类型。`ICompilationUnit.getTypes()`将为您提供本单元中所有类型的列表。`ICompilationUnit.findPrimaryType()`将为您提供此单元的主要类型。

您的例程应如下所示：

```
public boolean isAbstract(ICompilationUnit icu) throws JavaModelException {
    final IType type = icu.findPrimaryType();
    return (type != null) 
        ? Flags.isAbstract(type.getFlags()) 
        : false;
} 
```

`Flags`在哪里`org.eclipse.jdt.core.Flags`。

# apache - httpd.conf 重写规则

> ID：10046078
> 
> 赞同：0
> 
> 时间：2012-04-06T16:09:55.600
> 
> 标签：apache, mod-rewrite, httpd.conf

我的 RewriteRules 似乎都没有工作......

我尝试了许多变体，但似乎没有一个被阅读。

```
RewriteEngine On
RewriteRule (.*) http://www.domain2.com$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:14:55.797

你有一些日志吗？如果没有，启用 RewriteLog 并使用高 RewriteLogLevel：[http ://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritelog](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html#rewritelog)

另外，不要忘记启用重写模块。

```
a2enmod rewrite 
```

并使用这样的conf：

```
<Directory /var/www/website/html>
    Options +FollowSymLinks +ExecCGI

    <IfModule mod_rewrite.c>
      RewriteEngine On
      RewriteRule (.*) http://www.domain2.com$1 [R=301,L]
    </IfModule>
</Directory> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T14:19:37.790

包裹在 VirtualHost 标记中，它可以工作。

# asp.net-mvc - 如何在不额外查询授权的情况下控制对图像文件路径的访问

> ID：10046079
> 
> 赞同：1
> 
> 时间：2012-04-06T16:09:59.927
> 
> 标签：asp.net-mvc

我有一个像 Google+ 或 Facebook 这样的图片库，我想避免未经授权的人在以其他方式联系控制器 (../GetImage/test) 时显示图片。

图像保存在文件系统和数据库中图像的路径。

当图像是公开的或与用户共享时，用户只能显示图像。我想避免对控制器的请求（../GetImage/test）进行 SQL 查询（以检查用户是否可以显示图像），因为当我想加载 500 时，我认为这不是一个好习惯图像一次。

是否有更好的做法来检查用户是否有权显示图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:41:46.490

您需要构建您的数据模型，以便您对图像的请求包含与您的授权系统的连接，这样您就无法访问您无权访问的图像，并且它发生在单个查询中。

由于我不知道您的数据模型是如何构建的，所以我只能给您一个基本示例，并且我假设您正在使用 Entity Framework 进行数据访问。

```
public string GetImage(int id) {
    using (var db = new DataEntities()) {
        return imagePath = (from i in db.Images 
                        where i.AuthorizedUsers
                        .Any(x => x.UserName == User.Current.Name)
                        && i.id == id
                        select i.ImagePath).FirstOrDefault();
    }
} 
```

当然，如果未经授权的用户拥有图像的 URL，这不会阻止未经授权的用户获取图像，因此您需要直接返回图像，而不仅仅是路径。

所以是这样的：

```
public ActionResult GetImage(string id) 
{ 
    // code from above

    var dir = Server.MapPath("imagePath"); 
    return base.File(path, "image/jpeg"); 
} 
```

# c# - 我可以反序列化为 protobuf-net 中接口的只读属性吗？

> ID：10046081
> 
> 赞同：2
> 
> 时间：2012-04-06T16:10:04.743
> 
> 标签：c#, serialization, protocol-buffers, protobuf-net

我有一个接口和一个实现，都带有 [ProtoContract]。有一个属性，在界面上是只读的。当我尝试反序列化声明为接口的属性时，Protobuf 给了我这个错误：

`System.InvalidOperationException: Cannot apply changes to property IFoo.Id`

这是我正在测试的代码：

```
 public void Main()
    {
        using (var ms = new MemoryStream())
        {
            var x = new HasFoo {TheFoo = new Foo(1)};

            Serializer.Serialize(ms, x);
            ms.Position = 0;
            var clone = Serializer.Deserialize<HasFoo>(ms);

            Assert.AreEqual(1, clone.TheFoo.Id);
        }
    }

    [ProtoContract, ProtoInclude(100, typeof(Foo))]
    public interface IFoo
    {
        [ProtoMember(1)]
        long Id { get; }
    }

    [ProtoContract]
    public class Foo : IFoo
    {
        [ProtoMember(1)]
        public long Id { get; private set; }

        public Foo() { }

        public Foo(long id)
        {
            Id = id;
        }
    }

    [ProtoContract]
    public class HasFoo
    {
        [ProtoMember(1)]
        public IFoo TheFoo { get; set; }
    } 
```

我宁愿不在接口上声明 setter，而且我希望尽可能保持`TheFoo`声明的属性`IFoo`。有什么方法可以让它起作用吗？我正在使用 protobuf-net v2。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:37:12.207

不。当绑定到接口时，它会绑定到接口，因此它不能利用绑定到具体类型时可用的任何私有设置器（等）。您可以这样做的唯一方法是宣传 Foo 的成员而不是 IFoo 进行序列化。

注意：在非接口场景中，它可以访问成员，甚至是期望的直接字段。

# javascript - 如何调整 Javascript 图像的大小？

> ID：10046085
> 
> 赞同：0
> 
> 时间：2012-04-06T16:10:18.707
> 
> 标签：javascript, image, dom

所以，我创建了一些这样的图像：

```
images = [];

images[0] = new Image();
images[0].src = "bla.jpg";

images[1] = new Image();
images[1].src = "bla1.jpg";

images[2] = new Image();
images[2].src = "bla2.jpg"; 
```

这不是实际的加载算法，但产品是相同的：我留下了一个名为“images”的数组，其中当然包含一些图像。

我正在制作一个游戏，我需要调整画布的大小，以适应玩家的屏幕大小。我知道该怎么做，但现在，我还需要调整所有图像的大小。我不知道该怎么做。

我最初的方法是这样的：

```
for (var i = 0; i < images.length; i ++)
{
    images[i].width *= ratio; // newWidth/defaultWidth
    images[i].height *= ratio;
} 
```

不过，我没有注意到变化，所以我这样做了，只是为了确定：

```
for (var i = 0; i < images.length; i ++)
{
    images[i].width = 3; //I'd probably notice if every image in the game was shrunk to this size
    images[i].height = 3;
} 
```

这更奇怪了。图像再次保持不变，但是游戏速度变慢了很多。FPS 下降到 0.5 或类似的东西。

现在，我该如何调整图像大小？

**编辑：**当然，我不希望像这样实时调整图像大小：

```
context.drawImage(image, x, y, image.w*r, image.h*r); 
```

因为根据我的经验，它大大降低了性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:21:12.070

不要设置宽度和高度属性，而是设置 css 属性：

```
var i, image;
for ( i = 0; i < images.length; i++ )
{
    image = $( images[i] );
    image.css( 'width', image.width() * ratio );
    image.css( 'height', image.height() * ratio );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:29:28.603

当您在 Javascript 中设置尺寸时，它们应该被指定为字符串。数字是行不通的。如果您需要进行计算，则将结果转换为字符串。

```
 images[i].width = (images[i].width*ratio).toString(); // newWidth/defaultWidth
 images[i].height = (images[i].height*ratio).toString(); 
```

# ruby-on-rails-3 - Rails 3.0，RVM：仍然出现“在任何源中都找不到 ... (Bundler::GemNotFound)”

> ID：10046086
> 
> 赞同：2
> 
> 时间：2012-04-06T16:10:23.520
> 
> 标签：ruby-on-rails-3, gem, rvm, passenger

我有以下（并缩短了“/.../”的完整路径）：

```
$ gem environment
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.21
  - RUBY VERSION: 1.9.2 (2012-02-14 patchlevel 318) [x86_64-linux]
  - INSTALLATION DIRECTORY: /.../.rvm/gems/ruby-1.9.2-p318@rails-3.0
  - RUBY EXECUTABLE: /.../.rvm/rubies/ruby-1.9.2-p318/bin/ruby
  - EXECUTABLE DIRECTORY: /.../.rvm/gems/ruby-1.9.2-p318@rails-3.0/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /.../.rvm/gems/ruby-1.9.2-p318@rails-3.0
     - /.../.rvm/gems/ruby-1.9.2-p318@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

如您所见，我有 @global 和 @rails-3.0 gemsets。乘客 3.0.11 安装在 @global gemset 中，我的应用程序根目录中有一个 .rmvrc 文件：

```
rvm ruby-1.9.2-p318@rails-3.0 
```

但是，通过运行`$ bundle install`并重新启动应用程序后，`$ touch tmp/restart.txt`我不断收到乘客错误屏幕，其中包含以下内容：

```
Error message: Could not find aaronh-chronic-0.3.9 in any of the sources (Bundler::GemNotFound) 
```

此 gem 安装在 @rails-3.0 gemset 中

*   [宝石文件在这里。](https://gist.github.com/2343439)
*   [`$ gem list`这里](https://gist.github.com/2320974)

如果我在 @global gemset 中安装 aaronh-chronic gem，那么它只会抱怨下一个。就像它只是检查@global gemset 而不是首先查看我的@rails-3.0 gemset。我怎样才能让它同时使用两个 gemset？[（这里是完整的回溯。）](https://gist.github.com/2321025)

**更新：**这是我的乘客 Apache 配置：

```
# In /etc/apache2/mods_available/passenger.load
LoadModule passenger_module /.../.rvm/gems/ruby-1.9.2-p318@global/gems/passenger-3.0.11/ext/apache2/mod_passenger.so

# In /etc/apache2/mods_available/passenger.conf
<IfModule mod_passenger.c>
  PassengerRoot /.../.rvm/gems/ruby-1.9.2-p318@global/gems/passenger-3.0.11
  PassengerRuby /.../.rvm/wrappers/ruby-1.9.2-p318@global/ruby
</IfModule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-01T00:20:03.503

试试 bundle update 和 gem update --system。

# tinymce - tinymce 文件浏览器多文件源

> ID：10046087
> 
> 赞同：1
> 
> 时间：2012-04-06T16:10:24.587
> 
> 标签：tinymce, file-browser

我正在对过去几年开发的网站进行一些更新。它的增长相当不稳定（我试图提前计划，但在这个网站上它发生了一些奇怪的转变）。

无论如何，该站点有一个社区博客（blog.domain.com - 以前是 domainblog.com））和具有个人区域的用户（user1.domain.com、user2.domain.com 等）。

个人区域具有用户可以使用的标准页面内容，或添加文本片段以部分自定义。现在所有者希望用户能够创建自己的内容。

一切都完成了使用文件浏览器。

我需要一个允许我执行以下操作的浏览器：

*   浏览器需要能够浏览 blog.domain.com/files 中的公共文件和 user_x.domain.com/files 中的用户文件
*   浏览器还需要能够区分两者并生成适当的图像 url。
*   当然，浏览器对用户文件的访问需要是动态的，并且只显示用户特定的文件（以及公共文件）
*   我还需要能够为图像设置文件大小

管理区域与博客或用户子域位于不同的目录中。

一般目录结构

--webdir--
    |--client --
            |--clientsite--
                |--blog (blog.domain.com)
                |--sites--
                    |--main site (domain.com)
                    |--admin (admin .domain.com )
                    |--users--
                        |--user1 (user1.domain.com)
                        |--user2 (user2.domain.com)
                        ...等。

我尝试了几种不同的浏览器并使用符号链接，但浏览器似乎无法遵循它们。即使将它们设置为使用非默认目录，我也遇到了麻烦。

你会推荐什么浏览器？我需要定制什么才能使其工作。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T16:32:09.513

好的，因为我对这个问题没有任何回应，我想我将不得不做一个工作，然后看看如何编写一个自定义文件浏览器。

# javascript - 使用 jQuery 和一些输入创建一个键/对对象

> ID：10046089
> 
> 赞同：2
> 
> 时间：2012-04-06T16:10:29.507
> 
> 标签：javascript, jquery

我的网站上有一个购物车，我需要让用户随时轻松更改他们购物车中的商品数量。

这是我到目前为止的javascript代码：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {

        var items = [];

        $(".item").each(function () {
            var productKey = $(this).find("input[type='hidden']").val();
            var productQuantity = $(this).find("input[type='text']").val();
            items.addKey(productKey, productQuantity); ?
        });

        // 1\. Grab the values of each ammount input and it's productId.

        // 2\. Send this dictionary of key pairs to a JSON action method.

        // 3\. If results are OK, reload this page.
    });
</script> 
```

我写的评论只是对我如何进行的指导。

有没有办法将键/对元素添加到排序数组？我只需要它有一个键和值。没有什么花哨。

我写了一个`addKey()`方法只是为了说明目的来展示我想要完成的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:12:50.270

```
items[productKey] = productQuantity; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:25:58.497

在 JavaScript 中，数组是对象 ( `typeof(new Array)==='object'`)，并且对象可以具有可以使用点或括号语法获取/设置的属性：

```
var a = [1,2,3];
JSON.stringify(a); // => "[1,2,3]"
a.foo = 'Foo';
a.foo; // => 'Foo'
a['foo']; // => 'Foo'
JSON.stringify(a); // => "[1,2,3]" 
```

因此，在您的情况下，您可以简单地将 productQuantity 值添加到`item`数组的 productKey 属性中，如下所示：

```
items[productKey] = productQuantity;
items[productKey]; // => productQuantity 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:17:47.607

您可以将匿名对象添加到 items 数组，例如：

```
items.push({
    key: productKey,
    quantity: productQuantity
}); 
```

然后稍后以`items[0].key`或访问它们`items[0].quantity`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:22:23.170

你也可以使用 JQuery.data 方法，这样你也可以摆脱那些隐藏的。

# c# - 将 cookie 添加到 Request.Cookies 集合

> ID：10046090
> 
> 赞同：9
> 
> 时间：2012-04-06T16:10:59.677
> 
> 标签：c#, asp.net, tdd, moq, httpcontext

我正在尝试创建一个包装类来处理 HttpContext 的内容。我正在创建一个 cookie，但无法添加到 HttpContext.Request 或 Response cookie 集合。

我正在使用起订量。我也使用以下链接中的 MvcMockHelp： [http ://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)

当我尝试在以下代码中添加到 Cookies 集合时：

```
 HttpContextBase c1 = MvcMockHelpers.FakeHttpContext();
        HttpCookie aCookie = new HttpCookie("userInfo");
        aCookie.Values["userName"] = "Tom";
        c1.Request.Cookies.Add(aCookie);    <------ Error here 
```

我在代码的第 4 行 c1.Request.Cookies.Add(aCookie); 收到以下错误

```
Object reference not set to an instance of an object. 
```

我也尝试过如下实例化上下文对象，但仍然没有运气

```
HttpContextBase c = MvcMockHelpers.FakeHttpContext
             ("~/script/directory/NAMES.ASP?city=irvine&state=ca&country=usa"); 
```

我看到 Request 中的 Cookies 集合为 NULL。我如何实例化它？

我也尝试了以下但没有运气。

```
c1.Request.Cookies["userName"].Value = "Tom"; 
```

请让我知道我做错了什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T14:16:43.913

查看 Hansleman 的代码，该`Request`属性被创建为 a `Mock`，但是，该模拟的属性没有设置，所以这就是为什么`Cookies`为 null，并且您不能设置它，因为它是一个只读属性。

你有两个选择：

1.  `Cookies`在方法中设置属性的模拟`FakeHttpContext()` ，或
2.  如果您不想这样做，假设您直接引用库，那么您可以简单地`HttpRequestBase`从`HttpContextBase`您有权访问的库中重构模拟，如下所示：

    ```
    [Test]
    public void SetCookie()
    {
      var c1 = MvcMockHelpers.FakeHttpContext();
      var aCookie = new HttpCookie("userInfo");
      aCookie.Values["userName"] = "Tom";

      var mockedRequest = Mock.Get(c1.Request);
      mockedRequest.SetupGet(r => r.Cookies).Returns(new HttpCookieCollection());
      c1.Request.Cookies.Add(aCookie);

      Debug.WriteLine(c1.Request.Cookies["userInfo"].Value);
    } 
    ```

    `Mock.Get(object)`将返回 Mock，然后您可以在其上设置 cookie 并使用它。

一般来说，您可以使用静态方法`Object`重新创建一个`Mock``Get(MockedThing.Object)`

# php - 根据复选框的文本框更新数据库

> ID：10046094
> 
> 赞同：0
> 
> 时间：2012-04-06T16:11:17.037
> 
> 标签：php, database

**嗨，我一直在研究这个 php 代码。

我想更新属于复选框的数量。但我的代码的确切问题是：如果我有例如 3 个复选框，并且当我同时输入它们的数量时，更新正确完成，如果我只更新第一个数量而没有其他 2，则更新是也正确完成，但是当我单独更新第二个或第三个时，它会占用第一个旧值的数量：“”（所以我怎样才能更改我的代码，以便我可以更新所有项目或只更新检查的项目。

这是我的代码，用于显示带有数量的复选框。

在文件 manage_items.php 中：**

```
<?php
$DB_HOST ='localhost';
$DB_USER ='root';
$DB_PASSWORD='';
$DB_DATABASE='dks';

$con= mysql_connect($DB_HOST ,$DB_USER , $DB_PASSWORD);
if(!$con){
die('Failed to connect to server :'.mysql_error());
}

$db=mysql_select_db($DB_DATABASE);
if(!$db){
die("unable to select database");
}?>

$qry="SELECT * FROM catalog";
$result= mysql_query($qry);
if($result){
while($info = mysql_fetch_array($result))
{

print "<h3><a href=\"\#\"> cat:".$info['name']."</a></h3><div>";

$qryitem="SELECT * FROM item WHERE Id=". $info['Cid'];
$resultitem=mysql_query($qryitem);
if($resultitem){

?>

<form method="post" action="manage_item_action.php">
<?php
while($info=mysql_fetch_array($resultitem))
{
?>
<input type="checkbox" name="op[]" value="<?php echo $info['Id'];?>"/><?php echo $info['name'];?>
<label> Quantity <input type="text" name="Quantity[]" value="<?php echo $info['Quantity'];?>"/></label>
<br/>

        <?php
        } 
    }

    else echo "There are no items.";

    print "</div>"; 

}
}

?>

</div>

<input type="submit" value="update" name="submit"/>
</form> 
```

这是文件 manage_item_action.php 中更新的执行

```
<?php
$DB_HOST ='localhost';
$DB_USER ='root';
$DB_PASSWORD='';
$DB_DATABASE='dks';

$con= mysql_connect($DB_HOST ,$DB_USER , $DB_PASSWORD);
if(!$con){
die('Failed to connect to server :'.mysql_error());
}

$db=mysql_select_db($DB_DATABASE);
if(!$db){
die("unable to select database");
}

$options=$_POST['op'];
$qun=$_POST['Quantity'];
$size =count($options);
for($i =0; $i<$size; $i++)
{

 //$qryop="UPDATE item SET Quantity =".$qun."WHERE Id =".$options[$i]."';"; 
$resultop=mysql_query("update item set Quantity='".$qun[i]."'where Id='".$options[$i]."'");

}
if($resultop){
header("location: manage_items.php");}
else echo "there was an error"

?> 
```

我不知道如何解决这个问题！但我认为我的主要问题是所有文本框都具有相同的名称。所以当我将它发送到另一个文件进行执行时，它只是把它作为最后一个文件。

请帮帮我：$

****更新****

****解决方案****

所以我解决了我的代码的问题，它只需要在选中复选框之前禁用文本框，因此数组没有任何空索引..只有输入的值没有任何空值:))

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:19:59.697

您需要为“数量”输入字段指定一个唯一名称或将其转换为列出的每个复选框的数组，否则在提交时接收表单将“数量”的最后一个值作为福音。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:20:13.593

那是因为在您的输入表单框中，您有：

```
Quantity <input type="text" name="Quantity" ... 
```

因此，随着每个数量的插入，转发的值都会被更新。最后插入`Quantity`框中的值将被更新。相反，将此表单输入更改为：

```
<!-- This will forward an array to php script -->
Quantity <input type="text" name="Quantity[]"... 
```

然后，在您的更新查询中，更改为：

```
$resultop=mysql_query("UPDATE item SET Quantity='" . $qun[$i] . "'where Id='".$options[$i]."'"); 
```

# iphone - 三角学 - 旋转物体以背离直线

> ID：10046097
> 
> 赞同：1
> 
> 时间：2012-04-06T16:11:28.827
> 
> 标签：iphone, ios, rotation, trigonometry

基本上我有两个二维点，它们之间有一条线。一个立方体放置在这条线的中点。我希望立方体旋转，使其从直线向上，如下图所示。

![在线显示多维数据集的说明图](../Images/801c8dd25c1104268c7d2b5c5f039187.png)

我一直在考虑如何使用 trig 来做到这一点，但我仍然没有想出任何东西。任何想法将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:40:14.883

在伪代码中：

```
angle = atan2(p2.y - p1.y, p2.x - p1.x)

cube.rotation = angle + PI/2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:39:47.357

给定两个点 (x1, y1) 和 (x2, y2)，直线的角度由下式给出

```
atan2(y2-y1, x2-x1) 
```

然后相应地旋转正方形。为此，您可以使用仿射变换 - 请参阅

```
CGAffineTransformMakeRotation
CGPointApplyAffineTransform 
```

这里：

[http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html)

# ubuntu - 在 Ubuntu 12.04 上安装和启动 MongoDB for PHP

> ID：10046101
> 
> 赞同：2
> 
> 时间：2012-04-06T16:11:35.410
> 
> 标签：ubuntu, mongodb-php, mongodb

我已经`mongo`从 PECL 安装了扩展并将其添加到我的`php.ini`文件中。扩展在我运行时加载，`phpinfo();`但在我尝试连接到 Mongo 服务器时显示此错误。

```
Fatal error: Uncaught exception 'MongoConnectionException' with message 'Transport
endpoint is not connected' in /var/www/mongo.php:2 Stack trace: #0 /var/www/mongo.php(2):
Mongo->__construct() #1 {main} thrown in /var/www/mongo.php on line 2 
```

`phpinfo();`告诉我它在默认端口的 localhost 上运行。

我还安装了`mongodb_client`Ubuntu 的软件包，当我从终端使用它时，它也无法连接到运行的默认服务器上，尽管它可以连接到*MongoLab*上的服务器。PHP 脚本也无法连接到*MongoLab*服务器。

在阅读了 SO 和其他网站上的许多问题和答案后，我猜我的计算机上的 MongoDB 服务器没有打开。所有的文章都告诉我去一些可能安装 MongoDB 的文件夹，但我没有任何文件`/var/lib`夹`/usr/lib`

请帮助我让这个 MongoDB 工作，我想继续从Steve Francia的**MongoDB 和 PHP书中学习 MongoDB。**这本书没有关于安装 MongoDB 的好教程。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:17:02.610

安装 MongoDB（不是从一个包，但它会让你开始）：

*   从 www.mongodb.org/downloads 下载 2.0.4。
*   `tar zxvf mongodb-...`
*   切换到刚刚解压的 mongodb 目录。
*   创建一个目录来保存您的数据：

    ```
    $ mkdir myData 
    ```

*   跑：

    ```
    $ bin/mongod --dbpath myData 
    ```

您应该会看到一些输出，然后是“等待端口 27017 上的连接”，然后它会“冻结”等待您开始使用它。此时您应该能够连接到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:26:38.653

我更喜欢不使用 Ubuntu 包，所以我会按照@kristina 所说的那样，从二进制文件中运行 MongoDB 非常容易……但既然您似乎更喜欢一个包，请运行……

**资质搜索 mongo**

**你应该为mongo-server**发送一个条目...安装它。

如果您没有看到它，请按照以下说明操作：[http ://www.mongodb.org/display/DOCS/Ubuntu+and+Debian+packages](http://www.mongodb.org/display/DOCS/Ubuntu+and+Debian+packages)

然后您应该能够在本地连接，这也可以帮助您开始： http: [//learnmongo.com/posts/mongodb-php-install-and-connect/](http://learnmongo.com/posts/mongodb-php-install-and-connect/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-10T18:42:00.807

这适用于我的服务器：

[http://www.mongodb.org/display/DOCS/Ubuntu+and+Debian+packages](http://www.mongodb.org/display/DOCS/Ubuntu+and+Debian+packages)

我对 /etc/mongodb.conf 文件进行了一项更改以启用 REST：

```
#enable REST
rest = true 
```

GridFS 在我连接到它时也可以工作（Node.js 除外 - 但我认为我正在使用的驱动程序存在错误）。总而言之，我没有什么可以抱怨使用以下内容的：

```
sudo apt-get install mongodb-10gen 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-07T16:43:12.400

据我所知，mongodb php 驱动程序并不关心你如何运行 mongod 服务器。唯一重要的是应该有 mongod 实例正在运行，并且您在正确的端口上连接到它。因此，请确保您连接到正确的端口。

只是为了让 mongodb 的生活更轻松一点，您可以使用 mongodb 下载部分的二进制可执行文件。Ubuntu apt-get 安装可能会给您带来一些麻烦。

对我来说，我更喜欢为我的操作系统下载准备好使用的二进制文件。然后我将其解压缩并放在 /op/ 文件夹中，以便 mongodb 可执行文件位于 /opt/mongo/bin/

在此之后，我将此文件夹添加到 $PATH 变量中，以便我可以从任何地方运行 mongodb 命令。为此，我将 PATH="$PATH:/opt/mongo/bin" 添加到主文件夹中的 .bashrc 文件中。

这种方法给了我一个简单的升级方法，我只需要复制和替换 /opt/mongo/bin 文件夹。然后重启 mongod 服务器。

# javascript - jQuery 预加载仅适用于 ie 刷新

> ID：10046103
> 
> 赞同：0
> 
> 时间：2012-04-06T16:11:45.790
> 
> 标签：javascript, jquery, internet-explorer, internet-explorer-9, preload

我有一个问题，ie9 并不总是加载预加载的图像。有时我不得不刷新页面，然后它就可以工作了。

```
$jQuery.fn.img_preloader = function(options){
    var defaults = {
        repeatedCheck: 550,
        fadeInSpeed: 1100,
        delay: 200,
        callback: ''
    };
    var options = jQuery.extend(defaults, options);
    return this.each(function(){
        var imageContainer = jQuery(this),
            images = imageContainer.find('img').css({opacity:0, visibility:'hidden'}),
            imagesToLoad = images.length;               
            imageContainer.operations = {   
                preload: function(){    
                    var stopPreloading = true;
                    images.each(function(i, event){ 
                        var image = jQuery(this);

                        if(event.complete == true){ 
                            imageContainer.operations.showImage(image);
                        }else{
                            image.bind('error load',{currentImage: image}, imageContainer.operations.showImage);
                        }

                    });
                    return this;
                },showImage: function(image){   
                    imagesToLoad --;
                    if(image.data.currentImage != undefined) { image = image.data.currentImage;}

                    if (options.delay <= 0) image.css('visibility','visible').animate({opacity:1}, options.fadeInSpeed);

                    if(imagesToLoad == 0){
                        if(options.delay > 0){
                            images.each(function(i, event){ 
                                var image = jQuery(this);
                                setTimeout(function(){  
                                    image.css('visibility','visible').animate({opacity:1}, options.fadeInSpeed);
                                },
                                options.delay*(i+1));
                            });

                            if(options.callback != ''){
                                setTimeout(options.callback, options.delay*images.length);
                            }
                        }else if(options.callback != ''){
                            (options.callback)();
                        }
                    }
                }
            };
            imageContainer.operations.preload();
        });
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T01:14:03.290

尝试评论`event.complete`验证并直接进入 showImage 事件。这不是最好的解决方案，但对我有用。

```
$jQuery.fn.img_preloader = function(options)
{
   var defaults = {
     repeatedCheck: 550,
     fadeInSpeed: 1100,
     delay: 200,
     callback: ''
   };
   var options = jQuery.extend(defaults, options);
   return this.each(function()
   {
    var imageContainer = jQuery(this),
        images = imageContainer.find('img').css({opacity:0, visibility:'hidden'}),
        imagesToLoad = images.length;               
        imageContainer.operations = {   
            preload: function(){    
                var stopPreloading = true;
                images.each(function(i, event){ 
                    var image = jQuery(this);

                    imageContainer.operations.showImage(image);
                    /*if(event.complete == true){ 
                        imageContainer.operations.showImage(image);
                    }else{
                        image.bind('error load',{currentImage: image}, imageContainer.operations.showImage);
                    }*/

                });
                return this;
            },showImage: function(image){   
                imagesToLoad --;
                if(image.data.currentImage != undefined) { image = image.data.currentImage;}

                if (options.delay <= 0) image.css('visibility','visible').animate({opacity:1}, options.fadeInSpeed);

                if(imagesToLoad == 0){
                    if(options.delay > 0){
                        images.each(function(i, event){ 
                            var image = jQuery(this);
                            setTimeout(function(){  
                                image.css('visibility','visible').animate({opacity:1}, options.fadeInSpeed);
                            },
                            options.delay*(i+1));
                        });

                        if(options.callback != ''){
                            setTimeout(options.callback, options.delay*images.length);
                        }
                    }else if(options.callback != ''){
                        (options.callback)();
                    }
                }
            }
        };
        imageContainer.operations.preload();
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T12:29:33.940

替换此 showimage 功能..

```
 showImage: function (g) {
  d--;

  if (g.data.currentImage != undefined) {
      g = g.data.currentImage;                      

  }

  if (b.delay <= 0) {
      g.css("visibility", "visible").animate({
          opacity: 1
      }, b.fadeInSpeed);

  }
  if (d != 0) {
      if (b.delay != 0) {
          e.each(function (k, j) {
              var h = a(this);
              setTimeout(function () {
                  h.css("visibility", "visible").animate({
                  opacity: 1
                  }, b.fadeInSpeed)
              }, b.delay * (k + 1))
          });
          if (b.callback != "") {
              setTimeout(b.callback, b.delay * e.length)
          }
      } else {
          if (b.callback != "") {
              b.callback()
          }
      }
  }
} 
```

# xslt - XSL。评估表达式

> ID：10046104
> 
> 赞同：0
> 
> 时间：2012-04-06T16:11:45.840
> 
> 标签：xslt, evaluate

对不起我的英语不好。

**XSL 1.0。**如何从元素或属性值计算表达式？

例如 XML：

```
<position>
  <localizedName>ref-help</localizedName>
  <reference>concat('../help/', $lang, '/index.html')</reference>
</position> 
```

我尝试使用“参考”属性中的表达式：

```
<xsl:for-each select="/content/positions/position">
        <li>
          <!--Save expression to variable...-->
          <xsl:variable name="path" select="reference"/>
          <!--Evaluate variable and set it value to 'href'-->
          <a target="frDocument" href="{$path}">
            <xsl:variable name="x" select="localizedName"/>
            <xsl:value-of select="$resources/lang:resources/lang:record[@id=$x]"/>
          </a>
        </li>
      </xsl:for-each> 
```

但我得到字符串：

> **file:///C:/sendbox/author/application/support/concat('../help/',%20%24lang,%20'/index.html')**

我该如何评价它？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:22:40.510

如果您的 XSLT 处理器实现了[EXSLT](http://www.exslt.org/)扩展，您可以引用[一个将字符串动态评估为 XPath 表达式的函数](http://www.exslt.org/dyn/functions/evaluate/index.html)：

```
<xsl:stylesheet 
  version="1.0"
  xmlns="http://www.w3.org/1999/XSL/Transform"
  xmlns:dyn="http://exslt.org/dynamic"
  extension-element-prefixes="dyn"
>
  <xsl:template match="content">
    <xsl:apply-templates select="positions/position" />
  </xsl:template>

  <xsl:template match="position">
    <li>
      <a target="frDocument" href="{dyn:evaluate(reference)}">
        <xsl:value-of select="
          $resources/lang:resources/lang:record[@id=current()/localizedName]
        "/>
      </a>
    </li>
  </xsl:template>
</xsl:stylesheet> 
```

笔记：

*   在使用它们之前无需将它们保存在变量中
*   有一个`current()`你可能错过的功能
*   使用`<xsl:apply-templates>`和`<xsl:template>`赞成`<xsl:for-each>`

# c# - 我的代码中的错误

> ID：10046108
> 
> 赞同：-3
> 
> 时间：2012-04-06T16:12:13.197
> 
> 标签：c#, security

我正在使用以下代码应用凯撒密码算法，但效果不佳

编码

```
foreach (char t in richTextBox1.Text)
        {
            char encrypted = (char)(t + 3);
            richTextBox2.Text = encrypted.ToString();
        } 
```

当纯文本是“mostafa”时，返回“d”只有这个取最后一个字符我能做什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:15:27.947

试试这个：

```
StringBuilder enrypted = new StringBuilder();
foreach (char t in richTextBox1.Text)
{
    encrypted.Append((char)(t + 3));                
}
richTextBox2.Text = encrypted.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:15:32.863

```
foreach (char t in richTextBox1.Text)
{
    char encrypted = (char)(t + 3);
    richTextBox2.Text = encrypted.ToString();
} 
```

因为您将 分配`richTextBox2.Text`给单个字符。最后一个恰好是显示的那个。您的结果不是累积的。

你可以这样做：

```
var sb = new StringBuilder();
foreach (char t in richTextBox1.Text)
{
    char encrypted = (char)(t + 3);
    sb.Append(encrypted);
}
richTextBox2.Text = sb.ToString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:15:57.653

改变

```
richTextBox2.Text = encrypted.ToString(); 
```

至

```
richTextBox2.Text += encrypted.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:26:28.223

因为我真的很喜欢 LINQ

```
char[] text = richTextBox1.Text.ToCharArray();
richTextBox2.Text = new String(text.Select(ch => (char)(ch + 3)).ToArray()); 
```

# c++ - 在 CMake 中，如何测试编译器是否为 Clang？

> ID：10046114
> 
> 赞同：181
> 
> 时间：2012-04-06T16:12:52.093
> 
> 标签：c++, c, cmake, clang

我们有一套[跨平台的 CMake 构建脚本](https://code.asterisk.org/code/browse/astscf-cmake-release/AsteriskSCF.cmake?r=HEAD)，我们支持使用[Visual C++](http://msdn.microsoft.com/en-us/vstudio/aa718325)和[GCC](http://gcc.gnu.org/)构建。

我们正在尝试[Clang](http://clang.llvm.org/)，但我不知道如何使用我们的 CMake 脚本测试编译器是否是 Clang。

我应该测试什么来查看编译器是否是 Clang？我们目前正在分别使用[`MSVC`](http://www.cmake.org/cmake/help/v2.8.8/cmake.html#variable:MSVC)和[`CMAKE_COMPILER_IS_GNU<LANG>`](http://www.cmake.org/cmake/help/v2.8.8/cmake.html#variable%3aCMAKE_COMPILER_IS_GNULANG)测试 Visual C++ 和 GCC。

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2012-04-07T15:07:58.033

一个可靠的检查是使用[`CMAKE_<LANG>_COMPILER_ID`](https://cmake.org/cmake/help/latest/variable/CMAKE_LANG_COMPILER_ID.html)变量。例如，检查 C++ 编译器：

```
if (CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
  # using Clang
elseif (CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
  # using GCC
elseif (CMAKE_CXX_COMPILER_ID STREQUAL "Intel")
  # using Intel C++
elseif (CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
  # using Visual Studio C++
endif() 
```

如果使用像[ccache](http://ccache.samba.org/)这样的编译器包装器，这些也可以正常工作。

从 CMake 3.0.0 开始`CMAKE_<LANG>_COMPILER_ID`，Apple 提供的 Clang 的值现在是`AppleClang`. 要测试 Apple 提供的 Clang 和常规 Clang，请使用以下 if 条件：

```
if (CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  # using regular Clang or AppleClang
endif() 
```

另请参阅[AppleClang 策略说明](http://www.cmake.org/cmake/help/v3.0/policy/CMP0025.html#policy:CMP0025)。

CMake [3.15](https://cmake.org/cmake/help/latest/release/3.15.html)增加了对[clang-cl](https://clang.llvm.org/docs/UsersManual.html#clang-cl)和常规 clang 前端的支持。您可以通过检查变量来确定前端变体`CMAKE_CXX_COMPILER_FRONTEND_VARIANT`：

```
if (CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
  if (CMAKE_CXX_COMPILER_FRONTEND_VARIANT STREQUAL "MSVC")
    # using clang with clang-cl front end
  elseif (CMAKE_CXX_COMPILER_FRONTEND_VARIANT STREQUAL "GNU")
    # using clang with regular front end
  endif()
endif() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-02T10:05:17.197

这是针对 cmake 新手的更详细的答案，根据 sakra 的答案进行了修改。3.1 的最低版本似乎很重要，因为它改变了 CMake 处理引用的“MSVC”字符串的方式（根据策略 CMP0054）。

```
cmake_minimum_required(VERSION 3.1)
project(MyProject CXX)

if ("${CMAKE_CXX_COMPILER_ID}" MATCHES "Clang")
  MESSAGE("Clang")
elseif ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "GNU")
  MESSAGE("GNU")
elseif ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "Intel")
  MESSAGE("Intel")
elseif ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "MSVC")
  MESSAGE("MSVC")
endif() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-16T16:53:22.273

你可以测试 Clang，它的前端是这样的：

```
if (CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
  if (CMAKE_CXX_COMPILER_FRONTEND_VARIANT STREQUAL "MSVC") # clang-cl
    # ...
  elseif (CMAKE_CXX_COMPILER_FRONTEND_VARIANT STREQUAL "GNU") # clang native
    # ...
  endif()
elseif (CMAKE_CXX_COMPILER_ID MATCHES "Clang|GNU") # both
    # ...
endif() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-21T03:17:15.407

如果您的 cmake_minimum_required VERSION 小于 3.1，那么您必须使用带引号的变量来确定编译器，如果与`STREQUAL`命令一起使用，即

```
if ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "MSVC")
  MESSAGE("MSVC")
endif() 
```

或者，如果你不喜欢引用的东西，你可以使用`MATCHES`命令：

```
if (CMAKE_CXX_COMPILER_ID MATCHES "MSVC")
  MESSAGE("MSVC")
endif() 
```

如果您指定 cmake_minimum_required VERSION >= 3.1，那么您可以愉快地使用`STREQUAL`不带引号的：

```
if (CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
  MESSAGE("MSVC")
endif() 
```

cmake 3.1 版本问题，记录在这里：[https ://cmake.org/cmake/help/latest/policy/CMP0054.html](https://cmake.org/cmake/help/latest/policy/CMP0054.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-17T11:26:28.157

为了避免任何拼写错误问题，我使用不区分大小写的比较，例如：

```
string( TOLOWER "${CMAKE_CXX_COMPILER_ID}" COMPILER_ID )
if (COMPILER_ID STREQUAL "clang")
    set(IS_CLANG_BUILD true)
else ()
    set(IS_CLANG_BUILD false)
endif () 
```

为了使正则表达式`MATCHES`不区分大小写，我[在这里](https://stackoverflow.com/questions/9655164/regex-case-sensitive)尝试了一切但没有成功（CMake 似乎不支持）。

# python - 使用python从文件中的行中提取数据

> ID：10046119
> 
> 赞同：0
> 
> 时间：2012-04-06T16:13:01.540
> 
> 标签：python

我有一个包含多行数据的文件，其中包含许多数据，例如：

> chr1:4797973-4836816 57.7862

我想创建一个新文件，其行如下：

> chr1 4797973 4836816 57.7862

chr# 因行而异。# = 1-19, X, Y 对不起，如果这太简单了... J

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:18:23.740

是的，它太基础了。您应该尝试参考文档并提出解决方案。这是一个可以满足您的目的的

```
>>> with open("in1.txt") as fin, open("out1.txt","w") as fout:
    for line in fin:
        fout.write(line.replace(":"," ").replace("-"," ")) 
```

你需要了解的事情：

1.  Python [with](http://docs.python.org/release/2.5.2/ref/with.html)语句。
2.  [open](http://docs.python.org/library/functions.html#open)语句打开文件
3.  如何读取和写入文件
4.  使用[string.replace](http://docs.python.org/release/2.5.2/lib/string-methods.html)

请注意，您也可以使用翻译而不是替换，但这会占用字符串中的两个字符。

# r - 数据框在函数内部不起作用

> ID：10046126
> 
> 赞同：0
> 
> 时间：2012-04-06T16:13:50.273
> 
> 标签：r, function, dataframe

在尝试生成`data.frame`函数内部时，发现在调用函数时，尽管在函数外部显然一切正常，但`data.frame`并没有生成。

谁能告诉我这怎么可能？

```
Species=c("a","b","c")
data=data.frame(Species)

df=data.frame(matrix(nrow=length(levels(data$Species)),ncol=43))
rm(df)
f<-function(data)
{
df=data.frame(matrix(nrow=length(levels(data$Species)),ncol=43)) 
}
f(data) 
```

在我的 Rstudio`data.frame`中调用函数时没有生成`f`！

```
> sessionInfo()
R version 2.14.1 (2011-12-22)
Platform: x86_64-pc-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=English_Australia.1252       
LC_CTYPE=English_Australia.1252                   
LC_MONETARY=English_Australia.1252
[4] LC_NUMERIC=C                       LC_TIME=English_Australia.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] plyr_1.7.1         maptools_0.8-14    lattice_0.20-0     foreign_0.8-48     
geosphere_1.2-26  
[6] rgdal_0.7-8        outliers_0.14      XML_3.9-4.1        PBSmapping_2.62.34     
dismo_0.7-14      
[11] raster_1.9-58      sp_0.9-93         

loaded via a namespace (and not attached):
[1] grid_2.14.1  tools_2.14.1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T18:56:18.543

这应该不足为奇。您没有在函数中的任何地方指定函数应该返回的内容。这可以像在 R 中显示在命令提示符下创建的对象一样完成：键入对象的名称。或者，您可以使用`return()`.

换句话说，如下修改您的函数（我已将“df”更改为“mydf”，将“data”更改为“mydata”以避免与基本 R 函数发生任何潜在冲突）：

```
f <- function(mydata)
{
  mydf = data.frame(matrix(nrow=length(levels(data$Species)), ncol=43))
  mydf
  ## Or, more explicitly
  ## return(mydf)
} 
```

您现在可以使用`f(data)`. 但是，请注意，这只会显示输出，而不是将其分配给对象。如果您希望将其分配给一个对象（例如“mydf”），您需要使用`mydf <- f(data)`.

* * *

还有另一种选择，`<<-`在您的功能中使用。

```
f <- function(mydata)
{
  mydf <<- data.frame(matrix(nrow=length(levels(data$Species)), ncol=43))
  ## uncomment the next line if you want to *display* the output too
  ## mydf
} 
```

* * *

```
> rm(mydf)
> ls(pattern = "mydf")
character(0)
> f(data) ## No ouput is displayed when you run the function
> ls(pattern = "mydf")
[1] "mydf" 
```

# android - AndroidRuntime(883)：在 android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:179)

> ID：10046131
> 
> 赞同：0
> 
> 时间：2012-04-06T16:14:28.870
> 
> 标签：android, android-contacts, android-contentprovider

我在内容提供者上尝试了这个简单的演示代码，但我得到了一个 readExceptionFromParcel 异常。

```
Uri lookupUri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_FILTER_URI, editText.getText().toString());
    Cursor idCursor = getContentResolver().query(lookupUri, null, null, null, null);

    startManagingCursor(idCursor);        

    String wherestmt = ContactsContract.Data.CONTACT_ID + " = " + idCursor + " And " + ContactsContract.Data.MIMETYPE + " = '" + ContactsContract.CommonDataKinds.Phone.CONTENT_URI + "'";        
    Cursor datacursor = getContentResolver().query(ContactsContract.Data.CONTENT_URI,null,wherestmt,null,null);

    int nameIdx = datacursor.getColumnIndexOrThrow(ContactsContract.Data.DISPLAY_NAME);
    int phoneIdx = datacursor.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.NUMBER);

    datacursor.moveToFirst();

    list = new ArrayList<String>();

    do{

        String name = datacursor.getString(nameIdx);
        String phone = datacursor.getString(phoneIdx);
        list.add(name + " " + phone);           

    }while(datacursor.moveToNext());

    ListAdapter adapter = new ArrayAdapter<String>(this, android.R.layout.simple_expandable_list_item_1,list);
    listView.setAdapter(adapter); 
```

请帮我解决这个异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T04:43:06.130

您可以[将源代码附加](http://android.opensourceror.org/2010/01/18/android-source/)到您的项目并查看 ContentproviderNative.java 您可以通过 DatabaseUtils.readExceptionFromParcel(reply) 行看到异常或使用 logcat.in 大多数情况下是因为权限。您是否将读取联系人权限添加到您的应用程序？

# java - 使用 JavaZOOM BasicPlayer 类播放某些 MP3 时出错

> ID：10046136
> 
> 赞同：2
> 
> 时间：2012-04-06T16:14:52.217
> 
> 标签：java, swing, mp3, ioexception, javasound

这是堆栈跟踪：

```
java.io.IOException: Resetting to invalid mark
    at java.io.BufferedInputStream.reset(BufferedInputStream.java:433)
    at org.tritonus.share.sampled.file.TAudioFileReader.getAudioInputStream(TAudioFileReader.java:324)
    at javazoom.spi.mpeg.sampled.file.MpegAudioFileReader.getAudioInputStream(Unknown Source)
    at javazoom.spi.mpeg.sampled.file.MpegAudioFileReader.getAudioInputStream(Unknown Source)
    at javax.sound.sampled.AudioSystem.getAudioInputStream(AudioSystem.java:1179)
    at javazoom.jlgui.basicplayer.BasicPlayer.initAudioInputStream(Unknown Source)
    at javazoom.jlgui.basicplayer.BasicPlayer.initAudioInputStream(Unknown Source)
    at javazoom.jlgui.basicplayer.BasicPlayer.open(Unknown Source)
    at BasicPlayerDemo.play(BasicPlayerDemo.java:49)
    at BasicPlayerDemo.main(BasicPlayerDemo.java:24) 
```

似乎其他人也有这个问题：

*   [点唱机：没有声音？](http://forum.subsonic.org/forum/viewtopic.php?f=2&t=7792)
*   [播放器状态更新的堆栈跟踪](http://github.com/jdellinger/JavaJukebox/issues/6)

这有什么原因吗？我正在尝试使用 JavaZoom 类制作一个简单的 Java Swing 音乐播放器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-09T18:44:56.577

[在 ( pelzkuh.de 博客](http://www.pelzkuh.de/2012/10/funkstille-aufgehoben-javazoom-mp3.html))上有一个解决这个问题的方法，它是德语的，但主要是说原因是一个过时的库 mp3spi1.9.4.jar。您必须用新的 mp3spi1.9.5.jar 替换它。pelzkuh 博客条目中提供了链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T17:47:53.437

带有答案的线索暗示了我以前曾遇到过的事情。

1.  MP3 几乎不是任何一种“标准”——基本格式有许多扩展。基于 Java 声音的应用程序。通常只会处理其中一些类型，即使情况并非如此
2.  媒体播放器通常会付出相当大的努力来播放扔给他们的“任何垃圾文件”（包括无效文件）。复制这种能力将是一项重大努力。

> 那么没有简单的解决方案吗？我应该忽略这样的 MP3 吗？

1.  不
2.  这听起来很容易（简单）。跳过它们并转到下一首曲目。如果用户在播放器选项中选择“高反馈”，则弹出一个对话框或将其添加到日志中。

> 实际上我正在为我的大学制作一个迷你项目，所以如果这个播放器不播放某些文件，它看起来并不好。

我会与标记它的人一起检查。如果他们希望您在大学项目中为“扔给它的任何文件”提供支持，他们需要把头从云中拉出来。我敢打赌，我可以制作在一个“主要播放器”上播放的文件，但会导致下一个锁定并死掉（好吧..考虑更多最近的一些视频尝试，但同样的基本原则适用）。“处理媒体”很**棘手**。

> ..学院并不期待任何东西，因为我选择自己创造这个。我不知道处理媒体很棘手。现在如果他们问，我可以告诉他们！

我建议为播放器提供完整的播放列表和由您控制的媒体（并确保与您的播放器兼容）。[您可以在我的媒体页面](http://pscode.org/media/#sound)找到 3 个基本的、可分发的 MP3 曲目。那些是：

> （可解析）JMF MP3 编解码器

..so JavaZoom 也应该能够加载它们。

# sql-server - 如何使用 PowerShell 获取 SQL Server 中表的唯一键列表？

> ID：10046140
> 
> 赞同：2
> 
> 时间：2012-04-06T16:15:13.897
> 
> 标签：sql-server, powershell

我想使用 PowerShell 获取 SQL Server 中表的以下元数据信息列表：

列名、是否为空列、是否为主键、是否为外键、数据类型和是否唯一（或属于唯一键的一部分）

目前我正在使用以下内容而没有获取唯一键的信息：

```
PS SQLSERVER:\SQL\MyComputer\DEFAULT\Databases\MyDB\Tables\dbo.MyTable\Columns> Get-ChildItem | select Name, Nullable, IsPrimaryKey, IsForeignKey, DataType 
```

我想得到类似以下的东西

```
Name         : MyID
Nullable     : False
IsPrimaryKey : True
IsForeignKey : False
DataType     : int
IsUnique     : True 
```

有任何想法吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T01:18:47.887

但是有一个 IsUnique 属性，它是索引的属性，而索引是表的属性。因此，如果您想使用 SqlProvider，您可以通过以下方式获取属于唯一索引的列，然后将属性添加到列输出：

```
PS SQLSERVER:\SQL\MyComputer\DEFAULT\Databases\MyDB\Tables\dbo.MyTable>
$UQColumns = get-item . | foreach {$_.indexes} | where {$_.IsUnique} | foreach {$_.IndexedColumns} | select -expandproperty Name
cd Columns
Get-ChildItem | select Name, Nullable, IsPrimaryKey, IsForeignKey, DataType, @{n='IsUnique';e={$UQColumns -contains $_.Name}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:33:24.443

我不确定如何使用 PowerShell，但我认为您应该查看 MSDN 上的[Catalog Views](http://msdn.microsoft.com/en-us/library/ms174365%28v=sql.105%29.aspx)部分，尤其是[Object Catalog Views](http://msdn.microsoft.com/en-us/library/ms189783%28v=sql.105%29.aspx)。为了提出一个想法，这是一个代码片段，您可以使用它来获取有关名为的表的列的信息`SomeTable`：

```
select c.*
    from sys.objects o
        inner join sys.columns c on c.object_id = o.object_id
    where o.type = 'u' and o.name = 'SomeTable'; 
```

# python - TypeError 连接到推文流——Python 3.2

> ID：10046142
> 
> 赞同：0
> 
> 时间：2012-04-06T16:15:24.547
> 
> 标签：python, twitter

抱歉，这很简单：

Python 的新手以及与 Twitter 的流 API 的 Python 接口，尝试在 Python 3.2 上使用 tweetstream 来做到这一点。

```
import tweetstream
stream = tweetstream.FilterStream(username = "myusername", password = "mypassword", track = bytes("oprah", encoding = "utf-8"))
for tweet in stream:
    print(tweet) 
```

抛出：

类型错误：序列项 0：预期的 str 实例，找到 int

我已经对'track'参数进行了编码，因为之前尝试传递字符串时抛出了，

TypeError: POST 数据应该是字节或可迭代的字节。它不能是 str。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:20:44.537

您的问题是您使用 Python3 和 Python2 包。

有关 Python3 字节的信息，请参见此处：

[http://docs.python.org/release/3.0.1/library/functions.html#bytes](http://docs.python.org/release/3.0.1/library/functions.html#bytes)

还有这个：

[http://docs.python.org/whatsnew/2.6.html#pep-3112-byte-literals](http://docs.python.org/whatsnew/2.6.html#pep-3112-byte-literals)

在 python3 中，这将发送一个字节数组。但是，`_get_post_data`函数需要一个字符串。在 python3 和 python2 中处理字符串的方式完全不同，对于那些希望移植到 Python3 的人来说，这是非常沮丧的根源。

除非这个包使它与 Python3 兼容，否则你将需要使用 Python2。您当然可以自己做，但考虑到您将使用的任何其他软件包也将仅限于使用 python2，我建议您这样做。

基本上，在 python 2.6/2.7 中，如果你这样做

```
b = bytes('a')
print type(b) 
```

你会得到类型 str

在 python 3 中，如果你这样做

```
b = bytes('a')
print(type(b)) 
```

你会得到类型“bytearray”

# c++ - 我正在寻找将游戏更新到 SDL 2.0 的步骤

> ID：10046143
> 
> 赞同：1
> 
> 时间：2012-04-06T16:15:24.767
> 
> 标签：c++, c, sdl

我正在和我的朋友一起做一个项目，我们必须更新使用 SDL 1.2 的游戏的现有版本以使用 SDL 2.0 头文件和函数。我想知道在将现有源代码更新到较新的库时我们遵循的标准程序是什么。该代码有 28 个源文件和 11 个头文件，并且还广泛使用了键盘和鼠标事件以及声音。所有源文件都使用 c++ 和 sdl。大多数源文件大约 200 行代码。我有大约 3 个月的时间来进行更改。我想知道如何以每周或 2 周为基础编写该时间段的基本日程摘要。任何人都可以为我提供正确的步骤，以便我可以制定相同的时间表吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T19:43:02.970

我不知道标准程序，但这是我的想法：

一般来说，我可以想到两种方法来将现有软件移植到另一种语言、使用另一个库或对此类进行任何更改；结构变化最小或结构变化较大。

**最小**的结构更改意味着您保持程序结构不变，并开始用其他库中的等价物替换它的每一位。例如，如果从 glut 移植到 SDL，您将用 SDL 替换 glut 窗口创建，用 SDL 替换键盘处理等，所有这些都是独立的。

这种方法更快，因为所有的变化都是小的和局部的。您也不太可能引入错误。结果可能不是那么有效，因为程序的结构最初不是为这个新库设计的。

**重大的结构变化**意味着基于新库，您重写了依赖于该库的大部分程序。例如，如果从 C++ 的 STL 切换到 C 的标准库，`string`那么用 C 中的等价物进行不断分配/释放/复制的重写是没有意义的，因为您的方法应该完全不同。

这种方法需要更多的工作，但最终会给你一个更好的质量。

* * *

回到您的特定情况，我不确定 SDL 2 与 SDL 1.2 有何不同，但我猜它并没有根本不同。因此，我相信第一种方法应该适用于您的情况。也就是说，您应该在 SDL 2 中计算出您在 SDL 1.2 中所做的等价物，并在您的代码中相应地替换它们。

# iphone - 将多个按钮链接到具有不同作业的一种方法

> ID：10046148
> 
> 赞同：0
> 
> 时间：2012-04-06T16:15:44.297
> 
> 标签：iphone, objective-c, cocoa-touch, methods

我的故事板中有一个巨大的疯狂场景，它有 36 个不同的按钮，每个按钮在点击时都有不同的含义。我真的不想创建 36 种不同的方法，所以我如何在按下 36 个按钮之一时调用的方法中引用按钮标题或按钮名称。

这可能是一个简单的问题，但我是 iOS 和 Objective C 的新手......

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T16:19:28.033

您可以创建一个方法，如下所示：

```
- (IBAction)buttonTapped:(id)sender{

  // The button that was tapped is called "sender"
  // This will log out the title of the button

  //NSLog(@"Button: %@", sender.titleLabel.text);

  //Edit: You need a cast in the above line of code:

  NSLog(@"Button: %@", ((UIButton *)sender).titleLabel.text);
} 
```

然后，您可以使用 Interface Builder 连接到所有按钮。您可以使用某种 if/else 逻辑来测试点击了哪个按钮。

您可以检查 titleLabel 属性，或者您可以`IBOutlet`为每个按钮分配一个并检查它。

例如：

```
if([sender isEqual:buttonOutlet1]){
  //If this button is attached to buttonOutlet1
  //do something
} 
```

或者，您可以简单地使用每个按钮的标签，而不用担心插座。

第三种选择是在代码中生成和布局按钮，然后将它们作为按钮数组的元素进行访问。

第四种选择是将标签添加到按钮并在您的函数中检查按钮的标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T16:22:12.247

给每个按钮一个唯一的标签值。在 IBAction 中，sender.tag 告诉您点击了哪个按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:18:50.113

您为处理按钮按下而设置的 IBAction 例程有一个`sender`参数。检查决定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:22:08.583

这很简单，但是由于您是新手，所以这里有一个答案。
（根据斯坦福 cs193p 课程，2010-2011 秋季（这就是他们对计算器应用程序所做的））制作一个接收参数的方法，即 UIButton。例如：

```
- (IBAction) someMethodThatDoesSomething:(UIButton *)sender; 
```

然后根据`sender.titleLabel.text`
我不知道是否有其他解决方案进行if语句。希望这可以帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T16:30:12.570

```
-(IBAction) buttonPress: (id) sender {
    UIButton *pressedButton = (UIButton *)sender;
    NSString *buttonTitle = [pressedButton currentTitle];
    if ([buttonTitle isEqualToString: @"SomeTitle"]) {
        //do work for that button.
    }
} 
```

您可以使用各种 NSString 方法来比较或过滤哪个按钮被按下并通过 if 或开关进行处理。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T16:23:15.287

-(IBAction)myButtonAction:(id)sender {

```
 if ([sender tag] == 0) {
        // do something here
    }
    if ([sender tag] == 1) {
        // Do some think here
   }

} 
```

// 换句话说

-(IBAction)myButtonAction:(id)sender {

```
 NSLog(@"Button Tag is : %i",[sender tag]);

    switch ([sender tag]) {
    case 0:
        // Do some think here
        break;
    case 1:
       // Do some think here
         break;
   default:
       NSLog(@"Default Message here");
        break; 
```

}

# shell - 结合多个shell命令在sqlite3中创建临时表

> ID：10046151
> 
> 赞同：0
> 
> 时间：2012-04-06T16:15:48.390
> 
> 标签：shell, sqlite, applescript

而不是创建，然后在 sqlite3 中删除一个表，我想创建一个临时表，该表在您结束会话时被销毁。是否可以组合下面的命令，以便临时表不会被分号破坏？

```
set databaseName to "test.db"
set tableName to "tempTable"
do shell script ("mkdir -p ~/Documents/Databases/ ; sqlite3 ~/Documents/Databases/" & databaseName & " \"create table if not exists " & tableName & "(First, Last);  \"")
do shell script ("sqlite3 ~/Documents/Databases/" & databaseName & " \"insert into " & tableName & " (First, Last) values('John', 'Doe'); \"") 
```

我将如何实现它的这个版本？

```
set databaseName to "test.db"
set tableName to "tempTable"
do shell script ("mkdir -p ~/Documents/Databases/ ; sqlite3 ~/Documents/Databases/" & databaseName & " \"create temp table " & tableName & "(First, Last);  \"")
do shell script ("sqlite3 ~/Documents/Databases/" & databaseName & " \"insert into " & tableName & " (First, Last) values('John', 'Doe'); \"") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:31:40.233

SQLite 本身接受分号分隔的语句。

```
do shell script ("sqlite3 ~/Documents/Databases/" & databaseName & " \" & ¬
    "create temp table " & tableName & " (First, Last); " & ¬
    "insert into " & tableName & " (First, Last) values('John', 'Doe'); " & ¬
    " -- other stuff here --" & ¬
    "select * from " & tableName & ";\"") 
```

不过，在某些时候，将它写成一个单独的脚本或可能是一个 here 文档比构建一个巨大`do shell script`的 .

# audio - mediaelement.js（wordpress 3.2.1 插件）- IE9 中的音量滑块放错了位置

> ID：10046153
> 
> 赞同：4
> 
> 时间：2012-04-06T16:15:56.700
> 
> 标签：audio, internet-explorer-9, slider, volume, mediaelement.js

音量滑块似乎被推到了音频播放器框的下方。我查看了 IE9 的开发者模式，相对偏移量为 26px，而音频播放器框中所有其他对象的相对偏移量为 0。

我将不胜感激任何帮助。谢谢你。

# jquery - 如何在jquery中使我的活动选项卡不可点击

> ID：10046155
> 
> 赞同：0
> 
> 时间：2012-04-06T16:16:25.197
> 
> 标签：jquery, tabs

我想让我的活动标签不可点击，但我不知道如何修改下面的代码：

```
function initTabs(){
jQuery('ul.tabset').each(function(){
    var _list=jQuery(this);
    var _links=_list.find('a.tab');
    _links.eq(0).addClass('active');
    _links.each(function(){
        var _link=jQuery(this);
        var _href=_link.attr('href');
        var _tab=jQuery(_href);
        if(_link.hasClass('active'))_tab.css({"opacity":1,"display":"block"});
        else _tab.css({"opacity":0,"display":"none"});
        _link.click(function(){
            _links.filter('.active').each(function(){
                jQuery(jQuery(this).removeClass('active').attr('href')).animate({"opacity":0},000,function(){
                    jQuery(this).css({"display":"none"});_link.addClass('active');
                    _tab.css({"display":"block"}).animate({"opacity":1})})
            });
            return false
        })
    })

})
} 
```

非常感谢你的帮助。

***编辑答案：***

我现在知道答案，[点击后使链接无法点击 - jquery](https://stackoverflow.com/questions/1924026/make-a-link-unclickable-once-it-has-been-clicked-jquery)

我对上面的代码进行了更改，现在它可以工作了！

```
function initTabs(){
jQuery('ul.tabset').each(function(){
    var _list=jQuery(this);
    var _links=_list.find('a.tab');
    _links.eq(0).addClass('active');
    _links.each(function(){
        var _link=jQuery(this);
        var _href=_link.attr('href');
        var _tab=jQuery(_href);
        if(_link.hasClass('active'))_tab.css({"opacity":1,"display":"block"});
        else _tab.css({"opacity":0,"display":"none"});
        _link.click(function(){
            if($(this).hasClass('active')){
                return false;
            } else {
                _links.filter('.active').each(function(){
                    jQuery(jQuery(this).removeClass('active').attr('href')).animate({"opacity":0},000,function(){
                        jQuery(this).css({"display":"none"});_link.addClass('active');
                        _tab.css({"display":"block"}).animate({"opacity":1})})
                });
            }   
            return false
        })
    })

}) 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:27:19.137

尝试将要禁用的选项卡索引传递给 tabs() 函数。

$("#tabs").tabs({disabled : [1]});

[http://jsfiddle.net/PCCrb/1/](http://jsfiddle.net/PCCrb/1/) ​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T00:17:09.173

我现在知道答案，[点击后使链接无法点击 - jquery](https://stackoverflow.com/questions/1924026/make-a-link-unclickable-once-it-has-been-clicked-jquery)

我对上面的代码进行了更改，现在它可以工作了！

```
function initTabs(){
jQuery('ul.tabset').each(function(){
    var _list=jQuery(this);
    var _links=_list.find('a.tab');
    _links.eq(0).addClass('active');
    _links.each(function(){
        var _link=jQuery(this);
        var _href=_link.attr('href');
        var _tab=jQuery(_href);
        if(_link.hasClass('active'))_tab.css({"opacity":1,"display":"block"});
        else _tab.css({"opacity":0,"display":"none"});
        _link.click(function(){
            if($(this).hasClass('active')){
                return false;
            } else {
                _links.filter('.active').each(function(){
                    jQuery(jQuery(this).removeClass('active').attr('href')).animate({"opacity":0},000,function(){
                        jQuery(this).css({"display":"none"});_link.addClass('active');
                        _tab.css({"display":"block"}).animate({"opacity":1})})
                });
            }   
            return false
        })
    })

}) 
```

}

# php - if(isset($_GET['Confirm'])) 我在这里做错了什么？

> ID：10046158
> 
> 赞同：0
> 
> 时间：2012-04-06T16:16:30.337
> 
> 标签：php

我的 Get Confirm 没有触发查询？谁能看到我做错了什么？

网址：`http://www.example.co.uk/registerinterest.php?productid=125&confirm=Confirm`

```
<div class="confirminterest">
     <form action="registerinterest.php?productid=' . $productid . '" method="post" enctype="multipart/form-data">
       <input name="confirm" type="submit" id="confirm" value="Confirm" />
     <input name="cancel" type="button" id="cancel" value="Cancel" /></form>
   </div>

 if (isset($_GET['Confirm'])) {
         $addinterest = mysql_query("INSERT INTO tm_credits_spent (fk_customer_id, fk_product_id, int_credits_spent) VALUES('$pid','$productid','$adminfee')") or die (mysql_error());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:17:43.640

当您的表单使用 POST 方法时，您正在寻找 GET 数据。由于您正在将数据插入数据库，因此 POST 是正确的，因此请替换`$_GET`为`$_POST`.

您还在寻找`Confirm`您的按钮何时命名`confirm`。PHP 是区分大小写的，所以也替换它。

```
$_POST['confirm'] 
```

* * *

您似乎也面临[SQL 注入](http://bobby-tables.com/)的风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:20:15.063

添加我自己的答案，因为其他人缺少您输入的名称是“确认”，而不是“确认”（这是它的值）。

所以你必须检查`isset()`, `$_POST['confirm']`not `$_POST['Confirm']`or `$_GET['confirm']`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:18:15.853

您的表单发送的是 POST 数据，而不是 GET。要么更改表单的方法，要么检查`$_POST['confirm']`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:18:46.137

您已将方法设置为 post。尝试使用 $_POST['Confirm'];

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T16:22:15.433

在您的`GET`字符串和表单（使用`POST`）中，该字段是`"confirm"`，而不是`"Confirm"`。注意小写`'c'`。

试试：（`if (isset($_GET['confirm'])) {`或`if (isset($_POST['confirm'])) {`）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-06T16:35:01.477

您在 html 中使用 php 变量可能是问题替换它；

```
<form action="registerinterest.php?productid=' . $productid . '" method="post" enctype="multipart/form-data"> 
```

和

```
<form action="registerinterest.php?productid=' .<?php $productid ?>. '" method="post" enctype="multipart/form-data"> 
```

是`$_POST['confirm']`的，用于条件。

# c# - 当通过 tcp 套接字接收消息时，是否有更好的方法来进行类型检查？

> ID：10046165
> 
> 赞同：1
> 
> 时间：2012-04-06T16:17:12.360
> 
> 标签：c#, types, typechecking

起初我只是在做 if 语句来检查发送的对象的类型，但如果你有一堆不同类型的消息对象，那可能会很痛苦。然后我想，我做了一个被调用的事件，然后当某种类型正在侦听该事件并且当它被调用时它会检查它时，每个函数都会做某事。

if 语句的方式

```
 //code for after message received - if you need the code for listening for the message i can give it but i don't see a need
   Type msgType = msgObj.getType();
   if(msgType == messageType1){
        //do stuff
   }
   else if(msgType == messageType2){
        //do more stuff
    }
   // and so on 
```

如您所见，如果您有很多不同类型的消息，这可能会很糟糕

事件的方式

```
 private delegate messageEvent(object message);
   public event messageEvent onMessage;

   //code after message received
   onMessage(msgObj);

   // sample function that will listen for the onMessage event
   private void onMessage(object message){
        if(message.getType() == typeForThisFunction){
              //do somthing
        }
   } 
```

正如您所看到的，这比 if 语句要容易一些，但要确保所有内容都在听，并且如果有很多不同类型的消息并同时检查它们，也会发现问题。

有没有更好的方法来做这件事更容易？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:19:33.300

有一个常用的方法，不仅更方便，而且还可以在运行时配置（而`if`/`else`或等价物`switch`只能在编译时配置）：make a `Dictionary`.

```
var dict = new Dictionary<Type, Action<object>>
           {
               { typeof(SomeMessage), m => this.Process((SomeMessage)m) },
               { typeof(OtherMessage), m => this.Process((OtherMessage)m) },
           }; 
```

字典中的值只是一个例子，你可以根据你的要求选择不同的方法。

与基于事件的方法类似的其他方法也是有效的。例如，您可以让您的业务逻辑保留如下类对象的集合：

```
 interface IMessageProcessor
 {
     bool WantsToHandle(MessageBaseClass message);
 }

 class SomeMessageProcessor : IMessageProcessor { /* ...*/ }
 class OtherMessageProcessor : IMessageProcessor { /* ...*/ } 
```

`MessageBaseClass`应该包含有关消息“类型”的信息；当然，您可以只传递`object`和过滤对象的运行时类型，但这会更慢。当消息到达时，您依次将其提供给每个`IMessageProcessor`人。

# android - 安卓 udp 端口

> ID：10046167
> 
> 赞同：1
> 
> 时间：2012-04-06T16:17:15.180
> 
> 标签：android, udp, port

我想从我的笔记本电脑向安卓设备发送一个 udp 数据包，我为此编写了一个简单的应用程序，但它不起作用，我认为我一直使用的端口（5554）是问题所在。代码：

`私人无效runUdpServer（）

```
 EditText RecieveText = (EditText) findViewById(R.id.editText1);
    EditText check = (EditText) findViewById(R.id.editText2);
    String lText;
    byte[] lMsg = new byte[MAX_UDP_DATAGRAM_LEN];
    DatagramPacket dp = new DatagramPacket(lMsg, lMsg.length);
    DatagramSocket ds = null;
    RecieveText.setText("try1");
    try { 
```

`RecieveText.setText("try2"); ds = new DatagramSocket(UDP_SERVER_PORT); // i think the problem is here
//disable timeout for testing
if (ds != null){RecieveText.setText("connected");}` 否则 {RecieveText.setText("未连接");}

```
 RecieveText.setText("try"); 
```

`ds.receive(dp); lText = new String(lMsg, 0, dp.getLength()); Log.i("UDP packet received", lText); RecieveText.setText(lText); check.setText("port opened");` `} catch (SocketException e) {`` check.setText("SocketException");` e.printStackTrace();

```
 } catch (IOException e) {

        e.printStackTrace();
        check.setText("port didn't open");

    } finally {
        if (ds != null) {
            ds.close();
            RecieveText.setText("not connected1");
        }
        else {RecieveText.setText("not connected1");}
    }
    check.setText("end");
     if (ds != null){RecieveText.setText("connected");} 
```

`else {RecieveText.setText("not connected");} } }`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-11T15:06:06.500

我不认为这是一个端口问题...打印您的错误日志以更好地了解失败......任何方式尝试这个......不检查任何错字......另外请记住，任何网络任务最好是在异步任务中......

```
 int port =1855; ///any port that you want > 1024
    DatagramSocket socket = null;
    try {
        socket = new DatagramSocket(port);
    } catch (SocketException e) {
        e.printStackTrace();
    }
    try {
        socket.setBroadcast(true);
    } catch (SocketException e) {
        e.printStackTrace();
    }

    //////send socket
    int eport = 1616;
    InetAddress eip = null;
    try {
        eip = InetAddress.getByName("192.168.1.1");  ////SERVER IP ADDRESS 
    } catch (UnknownHostException e) {
        e.printStackTrace();
    }

    DatagramSocket esocket = null;
    try {
        esocket = new DatagramSocket(eport);
    } catch (SocketException e) {
        e.printStackTrace();
    } 
```

///发送

```
 byte[] send= new byte[60*1024];
     DatagramPacket send_packet = new DatagramPacket(send, send.length);

    try {
        socket.send(send_packet);
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

//////开始接收 while(true) {

```
 byte[] message = new byte[60*1024];
        DatagramPacket recv_packet = new DatagramPacket(message, message.length);

        try {
            socket.receive(recv_packet);
        } catch (IOException e) {
            e.printStackTrace();
        }
    ///Do something whit recv_packet
} 
```

# google-chrome - 如何在谷歌浏览器中禁用 MS IME？

> ID：10046168
> 
> 赞同：3
> 
> 时间：2012-04-06T16:17:22.177
> 
> 标签：google-chrome, ime

我了解 IE 和 FF 都支持 CSS 属性来控制特定领域的 Microsoft IME，例如

```
ime-mode: 'disabled' 
```

但是，Google Chrome 似乎不支持此属性。出于好奇，我在 Google 个人资料页面中尝试使用 Chrome 更改密码进行了一些测试，结果发现 MS IME 在密码字段中被禁用。我不允许通过 IME 输入任何字符。我怎样才能实现这种功能？

谢谢你的帮助！

# mysql - mysql查询，选择distinct / max

> ID：10046176
> 
> 赞同：1
> 
> 时间：2012-04-06T16:18:10.023
> 
> 标签：mysql, sql

我需要计算表 LDS 中的所有不同值`status = 'ok' AND date >= '2012-01-01'`，如果有多个相同的 ID，则只检查具有最新日期的 ID：如果此 ID 的状态为“ok”，则计算它。

表 LDS：

```
身份证 | 状态 | 日期
1 | 好的 | 2012-01-01
2 | 坏| 2012-01-01
1 | 坏| 2012-02-02
3 | 好的 | 2012-01-01
4 | 好的 | 1999-01-01

```

结果应为“1”（ID 3）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:20:16.670

我假设由于您想计算不同的 ID，因此在重复的情况下计算哪个 ID 并不重要，因为这不会影响最终计数：

编辑：更新查询以排除任何`ID`具有后续`'bad'`状态的查询：

```
SELECT COUNT(DISTINCT lds1.ID)
FROM 
    LDS lds1
    LEFT JOIN LDS lds2
        ON lds1.ID = lds2.ID
        AND lds1.Date < lds2.Date
        AND lds2.Status = 'bad'
WHERE 
    lds1.Date > '2012-01-01'
    AND lds1.Status = 'ok'
    AND lds2.ID IS NUL 
```

# string - URL 分类的模式匹配

> ID：10046178
> 
> 赞同：3
> 
> 时间：2012-04-06T16:18:16.047
> 
> 标签：string, algorithm, pattern-matching

作为项目的一部分，我和其他一些人目前正在研究 URL 分类器。我们试图实现的实际上非常简单：我们只需查看 URL 并找到其中出现的相关关键字并相应地对页面进行分类。

例如：如果网址是：[http://cnnworld/sports/abcd](http://cnnworld/sports/abcd)，我们会将其归类为“体育”类别

为此，我们有一个具有以下格式映射的数据库：关键字 -> 类别

现在我们正在做的是，对于每个 URL，我们不断读取数据库中的所有数据项，并使用 String.find() 方法查看关键字是否出现在 URL 中。一旦找到，我们就停下来。

但是这种方法有一些问题，主要是：

(i) 我们的数据库非常大，这样的重复查询运行速度非常慢

(ii) 一个页面可能属于多个类别，我们的方法不处理此类情况。当然，确保这一点的一种简单方法是即使找到类别匹配也继续查询数据库，但这只会让事情变得更慢。

我正在考虑替代方案，并且想知道是否可以进行相反的操作-解析 url，查找其中出现的单词，然后仅在数据库中查询这些单词。

一个简单的算法将在 O( n^2 ) 中运行 - 查询数据库中出现在 url 中的所有子字符串。

我想知道是否有更好的方法来实现这一点。有任何想法吗 ？？先感谢您 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T00:52:57.137

在我们的商业分类器中，我们有一个包含 4m 关键字的数据库 :) 我们还搜索 HTML 的正文，有很多方法可以解决这个问题：

1.  使用 Aho-Corasick，我们使用了一种专门针对网页内容的改进算法，例如将：tab、空格、\r、\n 视为空格，仅视为一个，因此两个空格将被视为一个空格，并且忽略小写/大写。
2.  另一种选择是将所有关键字放在树中（例如std :: map），这样搜索会变得非常快，缺点是这会占用内存，而且很多，但如果它在服务器上，你不会觉得它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T09:07:11.807

Aho-corasick 算法最适合一次遍历搜索中间字符串。您可以形成您的关键字的树（aho-corasick 树）。最后一个节点包含一个用特定关键字映射的数字。

现在，您只需要遍历树上的 URL 字符串。当你得到一些数字（在我们的场景中作为标志），这意味着我们得到了一些映射的类别。继续在哈希图上使用该数字并找到相应的类别以供进一步使用。

我想这会对你有所帮助。转到此链接：[ivan 的 aho-corasick 的好动画](http://blog.ivank.net/aho-corasick-algorithm-in-as3.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T20:43:52.990

我认为您建议拆分 URL 以查找有用的位，然后仅查询这些项目听起来是一个不错的方法。

我将一些 Java 拼凑在一起，这可能有助于从代码方面说明我认为这会带来什么。最有价值的部分可能是正则表达式，但我希望它的一般算法也能有所帮助：

```
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.util.List;

public class CategoryParser 
{
    /** The db field that keywords should be checked against */
    private static final String DB_KEYWORD_FIELD_NAME = "keyword";

    /** The db field that categories should be pulled from */
    private static final String DB_CATEGORY_FIELD_NAME = "category";

    /** The name of the table to query */
    private static final String DB_TABLE_NAME = "KeywordCategoryMap";

    /**
     * This method takes a URL and from that text alone determines what categories that URL belongs in.
     * @param url - String URL to categorize
     * @return categories - A List&lt;String&rt; of categories the URL seemingly belongs in
     */
    public static List<String> getCategoriesFromUrl(String url) {

        // Clean the URL to remove useless bits and encoding artifacts
        String normalizedUrl = normalizeURL(url);

        // Break the url apart and get the good stuff
        String[] keywords = tokenizeURL(normalizedUrl);

        // Construct the query we can query the database with
        String query = constructKeywordCategoryQuery(keywords);

        System.out.println("Generated Query: " + query);

        // At this point, you'd need to fire this query off to your database,
        // and the results you'd get back should each be a valid category
        // for your URL. This code is not provided because it's very implementation specific,
        // and you already know how to deal with databases.

        // Returning null to make this compile, even though you'd obviously want to return the
        // actual List of Strings
        return null;
    }

    /**
     * Removes the protocol, if it exists, from the front and
     * removes any random encoding characters
     * Extend this to do other url cleaning/pre-processing
     * @param url - The String URL to normalize
     * @return normalizedUrl - The String URL that has no junk or surprises
     */
    private static String normalizeURL(String url)
    {
        // Decode URL to remove any %20 type stuff
        String normalizedUrl = url;
        try {
            // I've used a URLDecoder that's part of Java here,
            // but this functionality exists in most modern languages
            // and is universally called url decoding
            normalizedUrl = URLDecoder.decode(url, "UTF-8");
        }
        catch(UnsupportedEncodingException uee)
        {
            System.err.println("Unable to Decode URL. Decoding skipped.");
            uee.printStackTrace();
        }

        // Remove the protocol, http:// ftp:// or similar from the front
        if (normalizedUrl.contains("://"))
        {
            normalizedUrl = normalizedUrl.split(":\\/\\/")[1];
        }

        // Room here to do more pre-processing

        return normalizedUrl;
    }

    /**
     * Takes apart the url into the pieces that make at least some sense
     * This doesn't guarantee that each token is a potentially valid keyword, however
     * because that would require actually iterating over them again, which might be
     * seen as a waste.
     * @param url - Url to be tokenized
     * @return tokens - A String array of all the tokens
     */
    private static String[] tokenizeURL(String url)
    {
        // I assume that we're going to use the whole URL to find tokens in
        // If you want to just look in the GET parameters, or you want to ignore the domain
        // or you want to use the domain as a token itself, that would have to be
        // processed above the next line, and only the remaining parts split
        String[] tokens = url.split("\\b|_");

        // One could alternatively use a more complex regex to remove more invalid matches
        // but this is subject to your (?:in)?ability to actually write the regex you want

        // These next two get rid of tokens that are too short, also.

        // Destroys anything that's not alphanumeric and things that are
        // alphanumeric but only 1 character long
        //String[] tokens = url.split("(?:[\\W_]+\\w)*[\\W_]+");

        // Destroys anything that's not alphanumeric and things that are
        // alphanumeric but only 1 or 2 characters long
        //String[] tokens = url.split("(?:[\\W_]+\\w{1,2})*[\\W_]+");

        return tokens;
    }

    private static String constructKeywordCategoryQuery(String[] keywords)
    {
        // This will hold our WHERE body, keyword OR keyword2 OR keyword3
        StringBuilder whereItems = new StringBuilder();

        // Potential query, if we find anything valid
        String query = null;

        // Iterate over every found token
        for (String keyword : keywords)
        {
            // Reject invalid keywords
            if (isKeywordValid(keyword))
            {
                // If we need an OR
                if (whereItems.length() > 0)
                {
                    whereItems.append(" OR ");
                }

                // Simply append this item to the query
                // Yields something like "keyword='thisKeyword'"
                whereItems.append(DB_KEYWORD_FIELD_NAME);
                whereItems.append("='");
                whereItems.append(keyword);
                whereItems.append("'");
            }
        }

        // If a valid keyword actually made it into the query
        if (whereItems.length() > 0)
        {
            query = "SELECT DISTINCT(" + DB_CATEGORY_FIELD_NAME + ") FROM " + DB_TABLE_NAME
                    + " WHERE " + whereItems.toString() + ";";
        }

        return query;
    }

    private static boolean isKeywordValid(String keyword)
    {
        // Keywords better be at least 2 characters long
        return keyword.length() > 1
                // And they better be only composed of letters and numbers
                && keyword.matches("\\w+")
                // And they better not be *just* numbers
                // && !keyword.matches("\\d+") // If you want this
                ;
    }

    // How this would be used
    public static void main(String[] args)
    {
        List<String> soQuestionUrlClassifications = getCategoriesFromUrl("http://stackoverflow.com/questions/10046178/pattern-matching-for-url-classification");
        List<String> googleQueryURLClassifications = getCategoriesFromUrl("https://www.google.com/search?sugexp=chrome,mod=18&sourceid=chrome&ie=UTF-8&q=spring+is+a+new+service+instance+created#hl=en&sugexp=ciatsh&gs_nf=1&gs_mss=spring%20is%20a%20new%20bean%20instance%20created&tok=lnAt2g0iy8CWkY65Te75sg&pq=spring%20is%20a%20new%20bean%20instance%20created&cp=6&gs_id=1l&xhr=t&q=urlencode&pf=p&safe=off&sclient=psy-ab&oq=url+en&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=2176d1af1be1f17d&biw=1680&bih=965");
    }
} 
```

SO 链接的生成查询如下所示：

```
SELECT DISTINCT(category) FROM KeywordCategoryMap WHERE keyword='stackoverflow' OR keyword='com' OR keyword='questions' OR keyword='10046178' OR keyword='pattern' OR keyword='matching' OR keyword='for' OR keyword='url' OR keyword='classification' 
```

有很大的优化空间，但我想它比检查每个可能的关键字的字符串要快得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T17:42:56.763

如果您的类别比关键字少（很多），您可以为每个类别创建一个正则表达式，它将匹配该类别的任何关键字。然后，您将针对每个类别的正则表达式运行您的 URL。这也将解决匹配多个类别的问题。

# c# - 获取本地 IP 地址

> ID：10046180
> 
> 赞同：12
> 
> 时间：2012-04-06T16:18:27.037
> 
> 标签：c#, xamarin.android

我正在尝试使用 Mono for Android 获取我的 Android 设备的本地 IP 地址，但失败了。

我用于完整和紧凑框架的代码是这样的：

```
var iplist = (from a in Dns.GetHostAddresses(Dns.GetHostName())
              where a.AddressFamily == AddressFamily.InterNetwork
              select a).ToArray();
LocalAddress = iplist[0]; 
```

但是，在 M4A 下，它会提前下降 - Dns.GetHostName() 调用失败并显示

`System.Net.Sockets.SocketException: An address incompatible with the requested protocol was used`

M4A 下的 Dns.GetHostName 是否存在已知问题？是否有其他方法可以使用 M4A 获取本地地址？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T18:31:17.270

事实证明，这是 Mono Socket 实现内部引发的异常，与尝试确定是否支持 IPv6 的运行时有关（[来源此处](https://github.com/mono/mono/blob/master/mcs/class/System/System.Net.Sockets/Socket_2_1.cs#L781)，撰写本文时的第 810 行）。

第一次尝试在 Mono 下使用任何 Socket 时会引发异常，并且可以安全地忽略。如果您使用调试器运行“中断所有抛出的异常”，我偶尔会这样做以确保代码清洁，那么您必须专门关闭 SocketExceptions 或者只是继续超过这个中断。

# python - TypeError：格式字符串的参数不足

> ID：10046190
> 
> 赞同：2
> 
> 时间：2012-04-06T16:19:24.517
> 
> 标签：python, tornado, mysql-python

我正在尝试使用[Tornado 的数据库包装器](https://github.com/facebook/tornado/blob/master/tornado/database.py)执行查询，如下所示 -

```
p_id = db.execute_lastrowid("""INSERT INTO `gplaces`.`place` 
                                    (`gid`, `name`, `reference`, `lat`, `long`, `vicinity`) 
                                    VALUES (%s, %s, %s, %s, %s, %s)""", 
                                    (
                                        str(place['id']),
                                        str(place['name']),
                                        str(place['reference']),
                                        float(place['geometry']['location']['lat']),
                                        float(place['geometry']['location']['lng']),
                                        str(place['vicinity'])
                                    )
                                ) 
```

但总是在标题中出现错误。这是回溯 -

```
Traceback (most recent call last):
  File "insertbs.py", line 38, in <module>
    str(place['vicinity'])
  File "/home/bibhas/Works/yodl/database.py", line 145, in execute_lastrowid
    self._execute(cursor, query, parameters)
  File "/home/bibhas/Works/yodl/database.py", line 207, in _execute
    return cursor.execute(query, parameters)
  File "/usr/lib/pymodules/python2.7/MySQLdb/cursors.py", line 159, in execute
    query = query % db.literal(args)
TypeError: not enough arguments for format string 
```

不知道我做错了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T16:20:55.043

不要传递值的元组，将它们作为单独的参数传递。

从追溯：

```
query = query % db.literal(args) 
```

注意在 - 中插入了什么`args`。基本上，只需删除`()`您传入的内容，以便它们作为参数传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T16:28:24.910

给 Amber 的功劳，我只是发布一个例子：

```
 p_id = db.execute_lastrowid("""INSERT INTO `gplaces`.`place` 
                                (`gid`, `name`, `reference`, `lat`, `long`, `vicinity`) 
                                VALUES (%s, %s, %s, %s, %s, %s)""", 

                                 str(place['id']),
                                 str(place['name']),
                                 str(place['reference']),
                                 float(place['geometry']['location']['lat']),
                                 float(place['geometry']['location']['lng']),
                                 str(place['vicinity'])

                            ) 
```

所以，在你只传递一个参数之前，一个包含所有参数的元组。在这个例子中，你传递了 6 个参数，这是它所期望的。

# c# - 在 .Net 应用程序中集成实时视频流

> ID：10046193
> 
> 赞同：1
> 
> 时间：2012-04-06T16:19:44.493
> 
> 标签：c#, .net, amazon-web-services, video-streaming, html5-video

我有另一个当前的最佳实践问题。

我一直在寻找大量的选项，并想听听一些有这种情况经验的人的意见。

我的客户正在创建一个类似于 ustream 网站的网站，我们将在其中展示视频内容，并允许客户直播视频并将其分发给用户群。我想我已经弄清楚了静态视频内容，使用 Amazon CDN 交付到嵌入式 HTML5 视频播放器。但是，为用户创建端点以上传他们的视频内容然后实时分发的最佳方法是什么？

我们之前已经研究过比特重力，但随着需求的变化，我们最终不得不继续创建/销毁端点。

提前致谢。

# c# - 休息时的关系？

> ID：10046196
> 
> 赞同：4
> 
> 时间：2012-04-06T16:20:02.163
> 
> 标签：c#, wcf, web-services, rest

我想将一个人添加到社区中，但我不确定它是如何完成的？

我的数据合同如下所示：

```
[DataContract(Name = "Community")]
public class Community
{

    public Group() 
    {
        People = new List<Person>();
    }
    [DataMember(Name = "CommunityName")]
    public string CommunityName { get; set; }
    public List<Person> People { get; set; }

}
[DataContract(Name = "Person")]
public class Person
{
    [DataMember(Name = "PersonName")]
    public string PersonName { get; set; }
} 
```

在我的服务中，我可以像这样添加一个人或一个社区：

```
List<Community> Communitys = new List<Community>();
List<Person> people = new List<Person>();
public void AddCommunity(Community community)
{
     Communitys.Add(community);
}
public void AddPerson(Person person)
{
     people.Add(person); 
}

public void AddPersonToCommunity(Person person, Community community)
{
    //not sure what to do here
} 
```

但我不确定如何将一个人加入社区

```
public void AddPersonToCommunity(Person person, Community community)
{
    //community.CommunityName(Person.Add);?
} 
```

我有一个 Windows 表单，当我发布一个人或一个社区时，它是这样完成的：

```
{
    StringBuilder Community = new StringBuilder();
    Community.AppendLine("<Community>");
    Community.AppendLine("<CommunityName>" + this.textBox4.Text + "</CommunityName>");
    Community.AppendLine("</Community>"); 
```

但是您将如何（一旦完成）使用 AddPersonToCommunity 并创建一个字符串构建器以便将一个人添加到社区？

```
 {
        StringBuilder CommunityAddPerson = new StringBuilder();
        CommunityAddPerson.AppendLine("<Community&{1}>");
        CommunityAddPerson.AppendLine ......
        CommunityAddPerson.AppendLine("<CommunityName>" + this.textBox4.Text + "</CommunityName>");
        CommunityAddPerson.AppendLine("</Community>"); 
```

希望这更清楚我猜它的两个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:14:22.840

根据您所说的，我认为您的方法可能如下所示：

```
public void AddPersonToCommunity(string person, string communityName)
{
    var result = communities.Where(n => String.Equals(n.CommunityName, communityName)).FirstOrDefault();
    if (result != null)
    {
        result.Add(new Person() { Name = person });
    }
} 
```

您的 POST 数据可能如下所示：

```
<Community>
  <CommunityName>CrazyTown</CommunityName>
  <People>
     <Person>Moe Howard</Person>
  </People>
</Community> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:25:00.123

您总是可以添加一个方法来将一个人添加到社区：

```
public void AddPersonToCommunity(Person person, Community community)... 
```

或者

```
public void AddPersonToCommunity(string personName, string communityName)... 
```

# c - Unix：当读取文件描述符在调用 select() 时关闭时会发生什么

> ID：10046200
> 
> 赞同：9
> 
> 时间：2012-04-06T16:20:09.277
> 
> 标签：c, unix

假设我在包含一堆读取文件描述符的 FD_SET 上调用 select()。如果在 select() 调用期间，文件描述符之一关闭，会发生什么情况？假设发生某种错误，那么我是否有责任从集合中查找并删除已关闭的文件描述符？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:27:42.103

我不相信这是在任何地方指定的；一些系统可能会立即返回，`select`而其他系统可能会继续阻塞。请注意，这可能发生的唯一方法是在多线程进程中（否则，在`close`期间不会发生`select`；即使它发生在信号处理程序中，`select`也会被信号中断）。因此，出现这种情况可能表明您有更大的问题需要担心。如果您正在轮询的文件描述符之一可以在 期间关闭`select`，更大的问题是相同的文件描述符可能会在`close`然后可能会错误地对“属于”不同线程的新文件执行 IO。

如果您的数据对象由一组将在多线程程序中轮询的文件描述符组成`select`，您几乎肯定需要使用某种同步原语来控制对该组的访问，并且添加或删除文件描述符应该需要一个互斥的锁，并且可能`select`（或成员上的任何 IO）正在进行中。

当然在多线程程序中，最好不要使用`select`，而是让多线程中的阻塞 IO 达到预期的效果，而不需要复杂的锁定逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:24:27.173

系统`select()`调用需要三个`fd_set`参数：Send、Receive、Exception。要检查，如果读取文件描述符上发生错误，请将其包含在读取（接收）和错误（异常）集中 - 在返回时的异常集中看到它`select()`意味着，该套接字上发生了异常，给你有机会发现什么。

一般来说，有任何异常的网络套接字将不再适合发送和接收。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:26:02.007

即使您已经读取了所有发送的数据，关闭的套接字也始终被视为已准备好读取。Select 将解除阻塞，表示该套接字可用。

# jquery - 如何更早地使 jQuery 样式我的元素？

> ID：10046204
> 
> 赞同：1
> 
> 时间：2012-04-06T16:20:21.180
> 
> 标签：jquery, jquery-ui, wijmo

我的网页上有以下 HTML：

```
<input id="htmlEdit" type="checkbox"/> 
```

页面加载后，复选框将使用 wijmo 设置样式，如下所示：

```
 $(document).ready(function () {
      var store = window.localStorage;
      $('#htmlEdit').wijcheckbox(); 
```

这可行，但我有一个问题，即在页面显示和元素设置样式之间有 1-2 秒的延迟。在此延迟期间，我看到了旧样式的复选框。

有谁知道我可以做些什么来减少这种延迟？例如，我可以让 wijcheckbox() 函数更早触发吗？我尝试用#htmlEdit 替换文档，但没有奏效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:32:28.073

这里的挑战是，为了通过 javascript 访问 DOM 元素，DOM 元素必须已经被浏览器解析，并且一旦被浏览器解析，它可能已经显示在屏幕上，除非它被设置为不可见。

这里最好的答案是通过 CSS 样式控制初始外观，因为这将在项目被解析时生效，并且它的第一个显示将包含 CSS 样式。

在给定对象上运行 javascript 的最快方法是将内联 javascript 放在 HTML 源代码中的元素之后：

```
<input id="htmlEdit" type="checkbox"/>
<script type="text/javascript>
$('#htmlEdit').wijcheckbox();
</script> 
```

但是，如果您必须经常这样做，这会很快变得混乱，并且散布您的标记和 JS 通常不是一个好主意。

所以，如果你不能用 CSS 设置它的样式，那么你最好先隐藏对象，然后在 JS 设置它的样式后才显示它。

```
<input id="htmlEdit" type="checkbox" style="visibility: hidden" /> 
```

并且，在你适当地设置它的样式后，让它在你的 JS 中可见：

```
$(document).ready(function() {
    $('#htmlEdit').wijcheckbox().css("visibility", "visible");
}) 
```

注意：我`visibility: hidden`在这里使用而不是`display: none`因为您的页面将正确布局，并且当复选框变得可见时，页面不会重新布局，导致事情跳来跳去。这似乎比在没有复选框的情况下查看布局更可取，然后在复选框变得可见时看到它重新定位。如果新的复选框样式显着不同，当您添加新样式时它仍然可能会发生一些变化，但在使用可见性时不会那么显着。

* * *

如果你有一堆这样的，你可以用一个类使它自动化：

```
<input class="styledCheckbox" id="htmlEdit" type="checkbox"> 
```

CSS：

```
/* initially hidden until wij style is applied */
.styledCheckbox {visibility: hidden;} 
```

Javascript：

```
$(document).ready(function() {
    // add style to all checkboxes and make them visible
    $('.styledCheckbox').wijcheckbox().css("visibility", "visible");
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:23:26.347

您无法减少文档加载时间，但您可以尝试以下操作：

**CSS：**

```
#htmlEdit {
    display: none;
} 
```

**Javascript：**

```
$(document).ready(function() {
    var store = window.localStorage;
    $('#htmlEdit').wijcheckbox();
    $('#htmlEdit').show();
});
​ 
```

这会隐藏元素，直到它的样式正确。

# asp.net-mvc - MVC3 中的 SignalR，计时和启动/连接问题？

> ID：10046206
> 
> 赞同：3
> 
> 时间：2012-04-06T16:20:46.827
> 
> 标签：asp.net-mvc, asp.net-mvc-3, c#-4.0, signalr

我对 MVC3 和信号器有一个非常奇怪的问题。我有一个简单的集线器；

```
[HubName("test")]
public class Test: Hub
{
    public object GetStuff()
    {
        return new { dummy = "Test" };
    }
} 
```

还有一些客户端代码；

```
var connection = $.connection.test;
connection.start();
connection.getStuff(); 
```

这会引发错误；

**TypeError: Object # has no method 'start'**

如果我改为

```
var connection = $.connection("test"); 
```

我得到一个不同的错误；

**TypeError: Object # has no method 'getStuff' jquery-1.6.4.min.js:4**

**POST [http://localhost:63021/Controller/test/negotiate](http://localhost:63021/Controller/test/negotiate) 405（不允许的方法）**

注意它出于某种原因试图在控制器下进行协商？

我需要注册一些特定的路线吗？还有什么我不知道的魔法？

**更新** 所以玩了一下控制台——第一个版本实际上创建了一个我可以调用的具有 getStuff() 的对象。但是 signalr 抛出了，因为我必须先调用 start() - 这不存在！第二个创建了一个对象，它有 start()，但它没有 getStuff()..

**更新 2** 尝试做 $.connection.hub.start 代替。这似乎在控制台中有效，但在页面 onload 中无效。在进行集线器调用之前可能启动没有完成？是异步的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T20:21:11.907

启动 SignalR 连接不是即时的。`connection.GetStuff();`如果连接尚未建立，您调用可能会失败。如果您希望在建立与集线器的连接后运行此代码，则应使用回调函数。

```
var connection = $.connection.test;
$.connection.hub.start(function(){        
    // By convention all exposed hub methods start with lowercase
    connection.getStuff();
}); 
```

集线器快速入门：[https ://github.com/SignalR/SignalR/wiki/QuickStart-Hubs](https://github.com/SignalR/SignalR/wiki/QuickStart-Hubs)

深入了解 SignalR javascript 客户端：[https ://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs](https://github.com/SignalR/SignalR/wiki/SignalR-JS-Client-Hubs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-20T19:20:06.407

您必须添加集线器部分：

```
$.connection.hub.start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T03:53:49.597

尝试这个：

var connection = $.connection("@Url.Content("~/echo")");

# uipickerview - 将 UIPickerView 与键和值绑定

> ID：10046208
> 
> 赞同：2
> 
> 时间：2012-04-06T16:21:00.213
> 
> 标签：uipickerview, ipad

我正在研究 UIPickerView。我可以使用以下代码绑定并获取选定的值

```
pickerItems = [[NSArray alloc] initWithObjects:
               [[[Company alloc] initWithName:@"Alabama" value:@"AL"] autorelease],
               [[[Company alloc] initWithName:@"Alaska" value:@"AK" ] autorelease],
               [[[Company alloc] initWithName:@"Arizona" value:@"AZ"] autorelease],
               [[[Company alloc] initWithName:@"California" value:@"CA"] autorelease],
               [[[Company alloc] initWithName:@"Wyoming" value:@"WY"] autorelease], nil]; 
```

但我正在使用一个网络服务，从中获取密钥和价值。我希望他们使用带有键和值的循环进行绑定。

如果我使用下面的代码，我会收到异常'线程 1：程序接收信号：“EXC_BAD_ACCESS”'

```
NSMutableArray *restArray = [[NSMutableArray alloc] initWithCapacity:5];
for (int i = 0; i <= 5; i++) {
    NSString *key = [NSString stringWithFormat:@" Company %d ", i]; 
    NSString *val = [NSString stringWithFormat:@" Company %d ", i]; 
    Company *rest = [[Company alloc] initWithName:key value:val];
    NSLog(@"restArray=%@ (%@)", restArray, NSStringFromClass([restArray class]));
    [restArray addObject:rest];
    [rest release];
}
pickerItems = restArray;
[restArray release]; 
```

提前致谢。

# bash - 使用 bash 更改文件名

> ID：10046209
> 
> 赞同：1
> 
> 时间：2012-04-06T16:21:02.683
> 
> 标签：bash

数据结构如下，我想将“lane-7”更改为“lane-5”。我正在考虑这样的命令，但它不起作用。

```
 find PATH -name "lane-7*" | xargs -i echo mv {} `echo {}|sed 's/lane-7/lane-5/'` | sh 
```

任何想法？谢谢

```
PATH/28/lane-7-22.fq
PATH/28/lane-7-21.fq
PATH/28/lane-7-18.fq
PATH/28/lane-7-24.fq
PATH/28/lane-7-23.fq
PATH/28/lane-7-19.fq
PATH/28/27/lane-7-22.fq
PATH/28/27/lane-7-21.fq
PATH/28/27/lane-7-18.fq
PATH/28/27/lane-7-24.fq
PATH/28/27/lane-7-23.fq
PATH/28/27/lane-7-19.fq
PATH/28/27/26/lane-7-22.fq
PATH/28/27/26/lane-7-21.fq
PATH/28/27/26/lane-7-18.fq
PATH/28/27/26/lane-7-24.fq
PATH/28/27/26/lane-7-23.fq
PATH/28/27/26/lane-7-19.fq
PATH/28/27/26/25/lane-7-22.fq
PATH/28/27/26/25/lane-7-21.fq
PATH/28/27/26/25/lane-7-18.fq
PATH/28/27/26/25/lane-7-24.fq
PATH/28/27/26/25/lane-7-23.fq
PATH/28/27/26/25/lane-7-19.fq
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:28:28.530

您可以使用`while`循环和 bash 字符串替换来做到这一点：

```
find PATH -name "lane-7*" | while read -r file ; do
  echo mv $file ${file/lane-7/lane-8}
done 
```

删除`echo`看起来不错的 if。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T16:31:31.820

使用[rename](http://linux.die.net/man/1/rename)，它是为此而制作的：

```
find PATH -name "lane-7*" | xargs rename "lane-7" "lane-5" 
```

您可能使用 perl 版本的[rename](http://man.he.net/man1/rename)代替（Debian 默认安装它）。在这种情况下，只需使用 perl 表达式：

```
find PATH -name "lane-7*" | xargs rename "s/^lane-7/lane-5/" 
```

# c# - SqlConnection 和 Pool，是保持开放连接 kung-foo 还是 foo-bar？

> ID：10046214
> 
> 赞同：4
> 
> 时间：2012-04-06T16:21:31.550
> 
> 标签：c#, .net, sql

我曾以为我很聪明。但鉴于最近的发现，我不再那么确定了。在页面生命周期中，可能有任意数量的数据库交互。有的背靠背，有的散开。所以我发明了一个对象，它可以在 HttpContext.Items 字典中保持 SQL 连接的实例处于活动状态。然后每个 db 请求都使用此连接，当 http 请求结束时，我会正确处理连接。我们正在查看连接将在几百毫秒内打开，并且在一些繁重的 http 缓存中，可用连接用完并不是一个问题。

关键是要防止由于建立新连接而产生额外的往返行程。但是当我偶然发现连接池的知识时，我认为它使保留 SqlConnection 的用处完全无效。或者是吗？

场景 A 是否与场景 B 相同，性能方面？你会推荐哪个？场景 B 是否没有提供性能提升，甚至可能因为连接可能无法正确处理的某些极端情况而阻碍它？原谅示例中的伪性，我不想将它们与 barf 混淆。

**一个**

```
using (var connection = new SqlConnection(connectionString))
{
   using (var command = new SqlCommand("...", connection))
   {
      ... doing database stuff ...
   }
}

... traversing the stack ...

using (var connection = new SqlConnection(connectionString))
{
   using (var command = new SqlCommand("...", connection))
   {
      ... doing database stuff ...
   }
} 
```

**乙**

```
 var connectionKeeper = new ConnectionKeeper();

   // Add to the context items so it can be used anywhere
   Context.Items.Add("Connection", connectionKeeper);

   ... traversing the stack ...

   using (var command = new SqlCommand("...", connectionKeeper.Connection))
   {
      ... doing database stuff
   }

   ... traversing the stack ...

   using (var command = new SqlCommand("...", connectionKeeper.Connection))
   {
      ... doing database stuff
   }

   ... traversing the stack ...

   // The end of the request
   sqlKeeper.Dispose(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T16:25:04.320

使用 A 部分中的代码。请让连接池完成它的工作。`SqlConnection`不惜一切代价避免保持静电。连接池就是为此而设计的。

这是一篇 MSDN 文章供您参考。

[SQL Server 连接池 (ADO.NET)](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T16:36:46.357

除非您关闭连接池，否则在代码中这样做是没有意义的。

在这样做之前你应该认真考虑一下，这是极端情况。

连接池的发明是为了解决您试图通过这种“永久”连接解决的情况，因此它实际上会干扰内置优化并增加代码的数量、复杂性和脆弱性。

# c# - TFS 自定义构建模板 - 获取没有 Uri 的团队项目集合

> ID：10046216
> 
> 赞同：2
> 
> 时间：2012-04-06T16:21:46.570
> 
> 标签：c#, tfs

无论如何可以从`IBuildDefinition`或其他相关的“服务”获取集合 URI。

我试图避免将 URI 作为自定义参数提供给构建模板中的集合。我正在寻找一种方法来从`UITypeEditor`自定义类中（在这种情况下）以编程方式检索它。

有没有办法在不使用硬编码的情况下查询这个？在我看来，构建过程本身（定义、控制器、代理等）知道他们正在处理哪个集合，但我怎样才能找到？

更新：这是您从`UITypeEditor`. 然后您只需访问以下`TeamProjectCollection`属性`VersionControlService`：

```
public class Editor : UITypeEditor
{
    public override object EditValue(System.ComponentModel.ITypeDescriptorContext context, IServiceProvider provider, object value)
    {           
        if (provider != null)
        {
            IWindowsFormsEditorService service = (IWindowsFormsEditorService)provider.GetService(typeof(IWindowsFormsEditorService));

            if (service != null)
            {                       
                VersionControlServer vcs = provider.GetService(typeof(VersionControlServer)) as VersionControlServer;

                // Do what you need to do with it here
            }               
        }

        return value;
    }

    public override UITypeEditorEditStyle GetEditStyle(System.ComponentModel.ITypeDescriptorContext context)
    {
        return UITypeEditorEditStyle.Modal;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T19:08:43.280

在 UITypeEditor.EditValue 的覆盖内，获取 TeamProjectCollection 的相关代码行是

```
VersionControlServer vcs = provider.GetService(typeof(VersionControlServer)) as VersionControlServer; 
```

然后它在属性中

```
vcs.TeamProjectCollection 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:29:56.823

您可以从 IBuildServer 获取 TfsTeamProjectProjection 对象：

[http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.build.client.ibuildserver.teamprojectcollection.aspx](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.build.client.ibuildserver.teamprojectcollection.aspx)

然后从这个对象中获取 Uri。

# ruby-on-rails - 在 Ruby on Rails 中显示管理员用户的索引

> ID：10046237
> 
> 赞同：0
> 
> 时间：2012-04-06T16:22:52.717
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已经完成了 Michael Hartl Ruby on Rails 教程（适用于 Rails 3），我想知道您将如何在单独的页面上显示所有已分配 Admin 属性的用户，因为它在任何地方都没有提到这一点。

**users_controller.rb**

```
 class UsersController < ApplicationController
  before_filter :authenticate, :only => [:index, :edit, :update, :destroy]
  before_filter :correct_user, :only => [:edit, :update]
  before_filter :admin_user,   :only => :destroy

  def show
    @user = User.find(params[:id])
    @microposts = @user.microposts.paginate(:page => params[:page])
    @title = @user.name
  end

  def new
    @user = User.new
    @title = "Sign up"
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to University Sports!"
      redirect_to @user
    else
      @title = "Sign up"
      render 'new'
    end
  end

  def edit
    @title = "Edit user"
  end

  def update
    @user = User.find(params[:id])
    if @user.update_attributes(params[:user])
      flash[:success] = "Profile updated."
      redirect_to @user
    else
      @title = "Edit user"
      render 'edit'
    end
  end

  def index
    @users = User.paginate(:page => params[:page])
  end

  def admins
    @users = User.admins
    render "users/index"
  end

  def destroy
    User.find(params[:id]).destroy
    flash[:success] = "User destroyed."
    redirect_to users_path
  end

  def following
    @title = "Following"
    @user = User.find(params[:id])
    @users = @user.following.paginate(:page => params[:page])
    render 'show_follow'
  end

  def followers
    @title = "Followers"
    @user = User.find(params[:id])
    @users = @user.followers.paginate(:page => params[:page])
    render 'show_follow'
  end  

  private

    def authenticate
      deny_access unless signed_in?
    end

    def correct_user
      @user = User.find(params[:id])
      redirect_to(root_path) unless current_user?(@user)
    end

    def admin_user
      redirect_to(root_path) unless current_user.admin?
    end

end 
```

**路由.rb**

```
FinalProject::Application.routes.draw do
  get "club/new"

  resources :users do
    member do
      get :following, :followers
    end
  end

  resources :users do
    collection do
      get :admins
    end
  end

  resources :sessions, :only => [:new, :create, :destroy]
  resources :microposts, :only => [:create, :destroy]
  resources :relationships, :only => [:create, :destroy]
  get "sessions/new"

  match '/signup',  :to => 'users#new'
  match '/signin',  :to => 'sessions#new'
  match '/signout', :to => 'sessions#destroy'

  match '/sign_up', :to => 'pages#sign_up'

  root :to => 'pages#home'

  resources :users
  match '/signup',  :to => 'users#new'

end 
```

**用户.rb**

```
class User < ActiveRecord::Base
    attr_accessor :password
    attr_accessible :name, :email, :password, :password_confirmation

    has_many :microposts, :dependent => :destroy
    has_many :relationships, :foreign_key => "follower_id", :dependent => :destroy
    has_many :following, :through => :relationships, :source => :followed   
    has_many :reverse_relationships, :foreign_key => "followed_id", :class_name => "Relationship", :dependent => :destroy
    has_many :followers, :through => :reverse_relationships, :source => :follower

    email_regex = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i

    validates :name,    :presence   => true, :length  => { :maximum => 50 }
    validates :email,   :presence   => true, :format  => { :with => email_regex }, :uniqueness => { :case_sensitive => false }

    scope :admins, where(:admin => true)

    # Automatically create the virtual attribute 'password_confirmation'.
    validates :password, :presence  => true, :confirmation  => true, :length  => { :within => 6..40 }
        before_save :encrypt_password

  def has_password?(submitted_password)
    encrypted_password == encrypt(submitted_password)
  end

  def self.authenticate(email, submitted_password)
    user = find_by_email(email)
    return nil  if user.nil?
    return user if user.has_password?(submitted_password)
  end

  def self.authenticate_with_salt(id, cookie_salt)
    user = find_by_id(id)
    (user && user.salt == cookie_salt) ? user : nil
  end

  def following?(followed)
    relationships.find_by_followed_id(followed)
  end

  def follow!(followed)
    relationships.create!(:followed_id => followed.id)
  end

  def unfollow!(followed)
    relationships.find_by_followed_id(followed).destroy
  end

  def feed
    Micropost.from_users_followed_by(self)
  end

  private

    def encrypt_password
      self.salt = make_salt unless has_password?(password)
      self.encrypted_password = encrypt(password)
    end

    def encrypt(string)
      secure_hash("#{salt}--#{string}")
    end

    def make_salt
      secure_hash("#{Time.now.utc}--#{password}")
    end

    def secure_hash(string)
      Digest::SHA2.hexdigest(string)
    end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:32:50.850

首先，您需要在`config/routes.rb`文件中创建一个路由，该路由将路由到显示此信息的操作。像这样的东西：

```
resources :users do
  collection do
    get :admins
  end
end 
```

这将路由到 中的`admins`操作`UsersController`，因此这就是您接下来需要定义的内容。它会是这样的：

```
def admins
  @users = User.admins
  render "users/index"
end 
```

因为管理员列表不应该与用户列表有太大的不同，所以您可以将所有管理员分配给`@users`然后渲染`users/index`模板......如果它存在。我可能在这里假设太多，但这是一种方法。

现在，你的类上没有`admins`方法`User`，所以你需要定义它。一种方法是使用范围，如下所示：

```
scope :admins, where(:admin => true) 
```

这将`admins`在类上定义方法`User`，返回所有管理员用户的范围。范围很酷，你应该看看他们还能做什么。

或者，您可以定义一个类方法：

```
def self.admins
  where(:admin => true)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:33:05.830

您应该执行以下操作：

```
UsersController

def admins
   @admins=User.where(:admin => true)
end 
```

并将其添加到您的路线文件中：

```
 resources :users do
    collection do
      get :admins
    end
 end 
```

然后只需在 admins.html.erb 视图中呈现 @admins 实例变量（您将在用户视图中创建它）。

# windows - 如何在 Windows 上创建小窗口（32x32）？

> ID：10046238
> 
> 赞同：0
> 
> 时间：2012-04-06T16:23:07.623
> 
> 标签：windows, winapi, createwindow

这是创建窗口的方式。但是当我 GetClientRect 时，rcClient 比 32x32 大得多。

```
int nDefaultWidth = 32;
int nDefaultHeight = 32;

UINT32 winStyle = 0;

RECT rc;
SetRect( &rc, 0, 0, nDefaultWidth, nDefaultHeight );
AdjustWindowRect( &rc, winStyle, ( hMenu != NULL ) ? true : false );

// Create the render window
HWND hWnd = CreateWindow( L"Direct3DWindowClass", NULL, winStyle,
                          x, y, ( rc.right - rc.left ), ( rc.bottom - rc.top ), 0,
                          hMenu, hInstance, 0 );

RECT rcClient;
GetClientRect( hWnd, &rcClient ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:48:16.257

您`0`作为`dwStyle`参数传递给[`AdjustWindowRect`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632665%28v=vs.85%29.aspx). 该值等于[`WS_OVERLAPPED`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632600%28v=vs.85%29.aspx#ws_overlapped)，并`AdjustWindowRect`明确禁止您传递该特定值。

由于您想创建一个 32x32 窗口（即根本没有 chrome，纯客户区），您应该丢失`AdjustWindowRect`调用，因为它根本没有任何用途，并`WS_POPUP`作为窗口样式传递给`CreateWindow`.

# mysql - 计算组内的最小记录数

> ID：10046239
> 
> 赞同：0
> 
> 时间：2012-04-06T16:23:08.643
> 
> 标签：mysql, sql, count, aggregate

我正在为需要确定按公司、工作和日期分组的“首次扫描”次数的数据库构建报告。

扫描表可以包含对同一项目的多次扫描，但是我只想将原始扫描包含在我的 COUNT 中，它只能被识别为与特定项目匹配的最早日期的扫描。

我的第一次尝试是：

```
SELECT 
     _item_detail.job_id, 
     _item_group.group_id, 
     _scan.company_id, 
     DATE(scan_date_time) as scan_date, 
     COUNT(1)
FROM _scan
    INNER JOIN _item_detail ON _item_detail.company_id = _scan.company_id 
    AND 
    _item_detail.serial_number = _scan.serial_number
    INNER JOIN _item_group ON _item_group.group_id = _item_detail.group_id
WHERE _item_detail.job_id = '0326FCM' AND _scan.company_id = '152345' AND _item_group.group_id = 13
GROUP BY 
_item_detail.job_id, 
_item_group.group_id, 
_scan.company_id, scan_date -- first_scan_count
HAVING min(scan_date_time); 
```

不过，这给了我不正确的结果（大约 3 倍）。我假设这是因为 MIN 记录正在为每个日期重新计算，因此如果在第 1 天找到最小值，也可能在第 3 天找到并重新计算。

如何修改我的查询以获得所需的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:32:59.607

与此类似的东西应该可以工作......我不完全确定您的表格是如何布置的或数据如何将它们联系在一起，但这是一般的想法：

```
SELECT 
    _item_detail.job_id, 
    _item_group.group_id, 
    _scan.company_id, 
    DATE(scan_date_time) as scan_date, 
    COUNT(1)
FROM
    _scan s1
    INNER JOIN _item_detail 
        ON _item_detail.company_id = s1.company_id 
        AND _item_detail.serial_number = s1.serial_number
        AND _item_detail.job_id = '0326FCM'
    INNER JOIN _item_group 
        ON _item_group.group_id = _item_detail.group_id
        AND _item_group.group_id = 13
WHERE 
    s1.company_id = '152345'
    AND s1.scan_date_time = (
        SELECT MIN(s2.scan_date_time)
        FROM _scan s2
        WHERE 
            s2.company_id = s1.company_id
            AND s2.serial_number = s1.serial_number
    )
GROUP BY 
    _item_detail.job_id, 
    _item_group.group_id, 
    s1.company_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:28:56.097

我不太关注您的查询，但根据问题的描述，我会说创建一个子查询，为每个项目提供最小扫描日期，按项目分组，然后执行您的外部选择。

# database - 通过命令行运行控制器。连接数据库的问题

> ID：10046242
> 
> 赞同：1
> 
> 时间：2012-04-06T16:23:41.463
> 
> 标签：database, codeigniter, database-connection, command-line-interface

背景：使用unix，来自localhost的codeigniter。

我想通过命令行 (CLI) 运行控制器。因此，我正在关注[这个 CodeIgniter 教程](http://codeigniter.com/user_guide/general/cli.html) ，并且该示例运行良好。

**但是**，当我将它与需要连接到数据库的功能一起使用时，它会在命令行中出现以下错误。

```
Unable to connect to your database server using the provided settings.
Filename: core/Loader.php
Line Number: 347 
```

**奇怪的**是，当我通过 URL 访问相同的功能时，它可以工作。这怎么可能？

注意：我假装在命令行中介绍的功能是更新数据库（它不打印任何内容）。

**编辑：** 我越来越近了。我已将主机名从“localhost”更改为“127.0.0.1”，并且可以正常工作。为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-18T18:18:32.227

我已将主机名从“localhost”更改为“127.0.0.1”，并且可以正常工作。

[解释](https://stackoverflow.com/questions/4219970/warning-mysql-connect-2002-no-such-file-or-directory-trying-to-connect-vi)

# javascript - 在上传对话框中选择多个文件并将其保存到数组中

> ID：10046243
> 
> 赞同：1
> 
> 时间：2012-04-06T16:23:50.923
> 
> 标签：javascript, jquery, actionscript-3, flash

嗨，我正在用 django 实现一个图像应用程序。我的问题与 django 没有内在联系。我想根据用户在对话框中选择的多个文件向 dom 添加多个上传表单。我还想将选定的文件保存到 javascript 数组并使用该值填充创建的表单。我不是在寻找像 swf 上传这样的文件上传器。我只想通过一个选择填充多个表单。有人知道一个好的插件或库来实现这一点。我应该使用 FileReferenceList.browse() 创建一个 flashmovie 并将其作为 json 传递给 javascript 吗？

# php - JOIN 语句中的 CodeIgniter ActiveRecord 字段名称

> ID：10046249
> 
> 赞同：18
> 
> 时间：2012-04-06T16:25:01.103
> 
> 标签：php, codeigniter, activerecord

我正在构建一个涉及 JOIN 的查询。这是我第一次用 Active Record 做 db 的东西，我遇到了一些障碍。

我想加入一个名为`companies`该`users`表的表，这样我就可以获得用户所在的公司名称等。我已经成功完成了这样的事情：

```
function get_profile_by_username($username)
{
    $this->db->join('companies', $this->table_name.'.company_id = companies.id');
    $this->db->where('LOWER(username)=', strtolower($username));
    $query = $this->db->get($this->table_name);
    if ($query->num_rows() == 1) return $query->row();
    return NULL;
} 
```

但是，问题在于 中的字段`companies`，它们是`id`并且`name`在该对象中返回，就像简单地调用一样`name`。

通常，当我编写原始查询时，我会给表赋予别名，结果将类似于`u.company_id`, `c.name`。所以我知道`name`与用户无关，但当然是公司的名称。虽然现在不是问题，但将来可能会成为问题，但该`id`列显然不能在结果集中共存，因此会被覆盖！

我们如何才能对来自某些表的字段进行这种区分？或者有没有更好的方法来进行表连接和使用连接的查询数据集/对象？

编辑：

如果我将其作为原始查询进行，我会这样做：

```
SELECT u.id, u.username, c.name
FROM users AS u
JOIN companies AS c
ON c.id = u.company_id
WHERE u.username = 'foobar'; 
```

这很好，但如果我试图在活动记录中这样做，我认为这是非常糟糕的做法，如果它真的有效的话。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-06T17:50:37.957

如果要从表中选择某些特定列，请使用`db->select()`. 您可以为表格提供别名，添加一些条件等。发送第二个参数`FALSE`以不转义特殊字符。

```
$this->db->select('u.id, u.username, c.name', false);
$this->db->from('user as u');
$this->db->join('companies as c', 'u.company_id = c.id');
$this->db->where('LOWER(u.username)=', strtolower('foobar'));
$query = $this->db->get(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-02-05T16:29:22.557

```
$this->db->select('ut.nombre as nombreu, ut.apellido,  ru.nombre as nombrer');

$this->db->from('User_table ut');

$this->db->join('Role_usuario ru', 'ut.role_user = ru.Id');

$query = $this->db->get();` 
```

`

# algorithm - 筛优化

> ID：10046251
> 
> 赞同：7
> 
> 时间：2012-04-06T16:25:06.307
> 
> 标签：algorithm, optimization

序列是从自然数序列创建的：

```
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 
```

在**第二步**中删除**每个第二个**数字：

 **```
1 3 5 7 9 11 13 15 17 19 21 23 
```

删除**第三步中的****每个第三个**数字（来自上一个序列）：

 **```
1 3 7 9 13 15 19 21 
```

在第**4 步**中删除**每个第 4 个**数字（从上一个序列中）：

 **```
1 3 7 13 19 
```

等等......现在，我们可以说，序列的第 4 个数字将是 13。

定义和正确的解决方案在这里： http: [//oeis.org/A000960](http://oeis.org/A000960)

我的任务是找到序列的第 1000 个成员。我为此编写了一个算法，但我认为它很慢（当我用第 10.000 个成员尝试它时，大约需要 13 秒）。它的作用是：

*   我`number`的每一步都增加 2，因为我们知道没有偶数。

*   在`counters`数组中，我存储每个步骤的索引。如果第 x 步中的数字是第 x，我必须将其删除，例如第 3 步中的数字 5。我为下一步启动了一个计数器。

    ```
    ArrayList<Long> list = new ArrayList<Long>(10000);
    long[] counters = new long[1002];
    long number = -1;
    int active_counter = 3;
    boolean removed;
    counters[active_counter] = 1;
    int total_numbers = 1;

    while (total_numbers <= 1000) {
        number += 2;
        removed = false;
        for (int i = 3; i <= active_counter; i++) {
            if ((counters[i] % i) == 0) {
                removed = true;
                if (i == active_counter) {
                    active_counter++;
                    counters[active_counter] = i;
                }
                counters[i]++;
                break;
            }
            counters[i]++;
        }
        if (!removed) {
            list.add(number);
            total_numbers++;
        }
    } 
    ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T18:04:52.520

您与 OEIS 的链接为我们提供了一些快速计算的方法（公式等）

第二个的实现：

```
function Flavius(n: Integer): Integer;
var
  m, i: Integer;
begin
  m := n * n;
  for i := n - 1 downto 1 do
    m := (m - 1) - (m - 1) mod i;
  Result := m;
end; 
```

PS 算法是线性的 (O(n))，n=10000 的结果是 78537769

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:50:31.020

不，这个问题不是NP难...

我有直觉`O(n^2)`，链接证明了这一点：

```
Let F(n) = number of terms <= n. Andersson, improving results of Brun,
shows that F(n) = 2 sqrt(n/Pi) + O(n^(1/6)). Hence a(n) grows like Pi n^2 / 4. 
```

它认为`O(n^2)`不应该给 n = 10000 15s。是的，有些东西不正确:(

**编辑 ：**

我测量了访问`counters`(for `n = 10000`) 的次数以大致了解复杂性，我有

```
 F = 1305646150
 F/n^2 = 13.05... 
```

你的算法介于两者之间`O(n^2)`，`O(n^2*(logn))`所以你做对了...... :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:47:42.177

一种方法可能是保留用于筛选的数字数组，而不是被筛选的数字。基本上，如果您正在寻找序列中的第 N 个值，您可以创建一个包含 N 个计数器的数组，然后遍历自然数。对于每个数字，您循环遍历您的计数器，递增它们直到一个达到其“最大值”值，此时您将该计数器设置为零并停止递增剩余的计数器。（这表示在该计数器的步骤中删除当前数字。）如果您通过所有计数器而不删除当前数字，那么这是剩下的数字之一。

一些似乎与 OEIS 给出的序列相匹配的示例 (Java) 代码：

```
public class Test {
  public static void main(String[] args) {
    int N=10000;
    int n=0;
    long c=0;

    int[] counters = new int[N];

    outer: while(n<N) {
      c++;
      for(int i=0;i<N;i++){
        counters[i]++;
        if(counters[i]==i+2){
          counters[i]=0;
          continue outer;
        }
      }

      // c is the n'th leftover
      System.out.println(n + " " + c);
      n++;
    }
  }
} 
```

我相信这在 O(N^3) 中运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T17:27:44.617

哇，这真是一个有趣的问题。
对此感激不尽。

我刚刚为此失去了一个小时的生命。我认为这个问题将变成 NP 难题。而且我无法生成一个方程来计算第j步中的^第^(i项。)

除非有一些聪明的数学技巧可以一步生成最终解决方案，否则您的“蛮力”解决方案似乎很好。但我不认为有。

从编程的角度来看，您可以尝试将初始数组设为链表，然后取消链接您想要删除的术语。这将为您节省一些时间，因为您不会每一步都重建您的列表。******

# android - 使用邮件阅读联系人

> ID：10046255
> 
> 赞同：0
> 
> 时间：2012-04-06T16:25:21.073
> 
> 标签：android, filter, contacts

我的代码读取了我使用“Contacts.HAS_PHONE_NUMBER”作为光标的电话联系人。我的问题是，如果可以的话，我可以过滤以仅显示带有电子邮件的联系人吗？最良好的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T18:46:29.973

您可以过滤联系人，以便仅显示带有电子邮件的联系人，但联系人中没有您可以过滤的列。

相反，您必须使用 Contacts.Entity 并在 MIMETYPE = CommonDataKinds.Email.CONTENT_ITEM_TYPE 上进行过滤。

我建议您查看这些类的 javadoc。

另请注意，此查询可能会返回大量数据，因此您应该小心您的投影。

# c# - 在服务器控件中动态创建 CustomValidator

> ID：10046256
> 
> 赞同：0
> 
> 时间：2012-04-06T16:25:22.603
> 
> 标签：c#, asp.net, telerik, custom-validators, naming-containers

我有一个自定义服务器控件，它包装了一个 RadEditor（基本上是一个文本区域）。我正在尝试动态添加一个 CustomValidator ，但我在初始页面加载时不断收到此错误

> 找不到“”的“ControlToValidate”属性引用的控件 ID“RadEditor1”。

这是我在服务器控件中用于创建 CustomValidator 的代码：

```
protected override void OnInit(EventArgs e)
{
    var validator = new CustomValidator();
    validator.CssClass = "validator-error";
    validator.Display = ValidatorDisplay.Dynamic;
    validator.ControlToValidate = this.ID;
    validator.Text = "You've exceeded the maximum allowed length for this field";
    validator.ClientValidationFunction = "checkLength";

    this.Controls.Add(validator);

    base.OnInit(e);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:37:27.360

问题在于`RadEditor`实现`INamingContainer`，因此 ASP.NET 最终会在您的服务器控件的*子*控件中搜索名为`RadEditor1`. 当然，它是不成功的，因为`RadEditor1`没有名为`RadEditor1`.

我使用的技巧是选择一个特殊的 ID，比如`"."`表示父控件本身：

```
protected override Control FindControl(string id, int pathOffset)
{
    return (id == ".") ? this : base.FindControl(id, pathOffset);
} 
```

然后`"."`用作`ControlToValidate`：

```
validator.ControlToValidate = "."; 
```

# python - 当搜索路径不存在时处理 iglob 错误

> ID：10046257
> 
> 赞同：2
> 
> 时间：2012-04-06T16:25:24.107
> 
> 标签：python

我正在尝试使用 iglob 而不是 glob 来获取说 .txt 文件的列表。如果不存在 .txt 文件，glob 不会返回任何错误，但 iglob 会。

代码：

```
def iGlobLatest():
    dir_list = glob.iglob('*.txt')
    print dir_list.next() 
```

如果不存在 .txt 文件，我会得到：

回溯（最近一次通话最后）：

文件“T:\prod\offlineValidation\scripts\goofin.py”，第 98 行，在 iGlobLatest() 中

文件“T:\prod\offlineValidation\scripts\goofin.py”，第 88 行，在 iGlobLatest 中打印 dir_list.next()

停止迭代

如果我使用 try/except，我可以避免错误，但这是唯一的方法吗？检查 .txt 文件是否存在的其他建议涉及使用 glob，但由于我尝试使用 iglob 而不是 glob....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:34:45.007

由于是一个生成器，它会在所有匹配文件都用完后`iglob()`引发。`StopIteration`如果根本没有文件，它将`StopIteration`在第一次调用`next()`.

生成器旨在迭代：

```
for file in glob.iglob('*.txt'):
    # whatever 
```

这样，`StopIteration`将为您隐式捕获异常。我不知道你实际上想要做什么，但也许这就是你想要的：

```
return next(dir_list, None)   # return first item of dir_list,
                              # or None if no files match 
```

（Python 2.6 或更高版本。）

# c# - C# 语音识别错误 - 语法的语言与语音识别器的语言不匹配

> ID：10046258
> 
> 赞同：0
> 
> 时间：2012-04-06T16:25:38.733
> 
> 标签：c#, .net, exception, speech-recognition

我的语音识别有问题。它可以在“英文”窗口上正常工作。它也适用于一些“外国”窗口。但只有一些。

我得到了那个例外：语法的语言与语音识别器的语言不匹配

我将自己的单词添加到字典中。

我该如何解决？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-08-15T17:23:12.130

我在朋友的电脑上遇到了同样的问题。所以我做了这个（它只是代码的一部分，因为所有的代码都很长）：

```
...
RecognizerInfo recognizerInfo = null;

foreach (RecognizerInfo ri in SpeechRecognitionEngine.InstalledRecognizers())
{
   if ((ri.Culture.TwoLetterISOLanguageName.Equals("en")) && (recognizerInfo == null))
   {
      recognizerInfo = ri;
      break;
   }

}

SpeechRecognitionEngine SpeachRecognition = new SpeechRecognitionEngine(recognizerInfo);

GrammarBuilder gb = new GrammarBuilder(startLiserninFraze);
gb.Culture = recognizerInfo.Culture;
grammar = new Grammar(gb);
SpeachRecognition.RequestRecognizerUpdate();
SpeachRecognition.LoadGrammar(grammar);
SpeachRecognition.SpeechRecognized += SpeachRecognition_SpeechRecognized;
SpeachRecognition.SetInputToDefaultAudioDevice();
SpeachRecognition.RecognizeAsync(RecognizeMode.Multiple);
... 
```

所以这应该有效。我的朋友 PC 支持 2 个“en”或“eng”实例。不知道为什么。所以代码选择第一个。我在互联网上找到了一些代码，其中一些是我制作的。

```
 SpeachRecognition.SpeechRecognized += SpeachRecognition_SpeechRecognized; 
```

当一切都被识别时，它会制造一个事件。只需输入：

语音识别.语音识别 +=

并按 TAB 按钮（至少在 VS 2013 中）几次。然后在代码的底部，它将生成如下内容：

```
void SpeachRecognition_SpeechRecognized(object sender, SpeechRecognizedEventArgs e)
   {
       //then will be some line that you need to replace with your code
   } 
```

我希望这将有所帮助。:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-19T01:34:07.147

不确定您使用的是哪个版本的 .net，但我会尝试回答。

在您的英文 Windows 版本上，请导航到 C:\Program Files\Reference Assemblies\Microsoft\Framework[YOUR .NET VERSION]

你应该找到 System.Speech.dll，

确保将此 .dll 带到您的外国计算机上，一切都应该运行顺利。

# c++ - 如何让 A* 算法给我最短路径？（见附图）

> ID：10046260
> 
> 赞同：4
> 
> 时间：2012-04-06T16:25:42.553
> 
> 标签：c++, a-star

我使用 Justin Heyes-Jones 实现 astar 算法。我的启发式函数只是欧几里得距离。在附图中（抱歉质量不好）描述了一个特定的情况：假设我们从节点 1 到节点 2。最短的方法是通过节点 a - b - c - d - e。但是带有欧几里得启发式的逐步 Astar 将为我们提供通过以下节点的方法：a - b' - c' - d' - e 我理解为什么会发生这种情况。但是我该怎么做才能让它返回最短路径？！

[astar错误的最短路径查找](http://i.stack.imgur.com/QfL1C.jpg)

真正的路线图导入代码：

```
#include "search.h"

class ArcList;

class MapNode
{
public:

    int x, y;       // ���������� ����
    MapNode();
    MapNode(int X, int Y);
    float Get_h( const MapNode & Goal_node );
    bool GetNeighbours( AStarSearch<MapNode> *astarsearch, MapNode *parent_node );
    bool IsSamePosition( const MapNode &rhs );
    void PrintNodeInfo() const;

    bool operator == (const MapNode & other) const;

    void setArcList( ArcList * list );

private:
    ArcList * list;
};

class Arc
{
public:
    MapNode A1;
    MapNode B1;
    Arc(const MapNode & a, const MapNode & b);
};

class ArcList
{
public:

    void setArcs( const std::vector<Arc> & arcs );
    void addArc( const Arc & arc );

    size_t size() const;

    bool addNeighbours( AStarSearch<MapNode> * astarsearch, const MapNode & neighbour );

private :
    std::vector<Arc> arcs;
};

std::vector <MapNode> FindPath(const MapNode & StartNode, const MapNode & GoalNode)
{
    AStarSearch<MapNode> astarsearch;
    astarsearch.SetStartAndGoalStates( StartNode, GoalNode );

    unsigned int SearchState;
    unsigned int SearchSteps = 0;

    do
    {
        if ( SearchSteps % 100 == 0)
            std::cout << "making step " << SearchSteps << endl;

        SearchState = astarsearch.SearchStep();

        SearchSteps++;
    }
    while ( SearchState == AStarSearch<MapNode>::SEARCH_STATE_SEARCHING );

    std::vector<MapNode> S;
    if ( SearchState == AStarSearch<MapNode>::SEARCH_STATE_SUCCEEDED )
    {
        int steps = 0;

        for ( MapNode * node = astarsearch.GetSolutionStart(); node != 0; node = astarsearch.GetSolutionNext() )
        {
            S.push_back(*node);
//            node->PrintNodeInfo();
        }

        astarsearch.FreeSolutionNodes();
    }
    else if ( SearchState == AStarSearch<MapNode>::SEARCH_STATE_FAILED )
    {
        throw " SEARCH_FAILED ";
    }
    return S;
} 
```

函数 FindPath 给了我结果节点的向量。

这是 addNeighbours 方法：

```
bool ArcList::addNeighbours( AStarSearch<MapNode> * astarsearch, const MapNode & target )
{
    assert(astarsearch != 0);
    bool found = false;
    for (size_t i = 0; i < arcs.size(); i++ )
    {
        Arc arc = arcs.at(i);

        if (arc.A1 == target)
        {
            found = true;
            astarsearch->AddSuccessor( arc.B1 );
        }
        else if (arc.B1 == target )
        {
            found = true;
            astarsearch->AddSuccessor( arc.A1 );
        }
    }

    return found;
} 
```

和 get_h 方法：

```
float MapNode::Get_h( const MapNode & Goal_node )
{
    float dx = x - Goal_node.x;
    float dy = y - Goal_node.y;
    return ( dx * dx  + dy * dy );
} 
```

我知道它不是精确的距离（这里不取平方根） - 这样做是为了在评估时节省一些机器资源。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:35:56.517

当您使用 A* 图搜索时，即您只考虑对节点的第一次访问而忽略未来的访问，这实际上可能在您的启发式不一致时发生。如果启发式不一致并且您使用图形搜索（您保留已访问状态的列表，并且如果您已经遇到过状态，则不要再次扩展它），您的搜索不会给出正确的答案。

但是，当您使用具有可接受启发式的 A* 树搜索时，您应该得到正确的答案。树搜索和图搜索的区别在于，在树搜索中，每次遇到它时都会扩展状态。因此，即使一开始您的算法决定采用较长的 b', c', d' 路径，稍后它会返回到 a，再次扩展它并发现 b, c', d 路径实际上更短。

因此我的建议是，要么使用树搜索而不是图搜索，要么选择一致的启发式。

有关一致的定义，请参见例如：[Wikipedia: A* Search Algorithm](http://en.wikipedia.org/wiki/A%2a_search_algorithm)

编辑：虽然上述情况仍然正确，但这种启发式确实是一致的，我为造成的混乱道歉。

EDIT2：虽然启发式本身是可接受且一致的，但实施不是。为了性能，你决定不做平方根，这使得你的启发式算法不可接受，这就是你得到错误结果的原因。

对于未来，最好尽可能天真地首先实现您的算法。它通常有助于使它们更具可读性，并且它们不太容易出现错误。如果有错误，则更容易发现。因此，我的最终建议是不要优化，除非你需要它，或者除非其他一切运行良好。否则你可能会遇到麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T09:32:18.967

似乎在 get_h 方法中取平方根已经解决了它。事实证明我的启发式是不可接受的（至少我认为这可以解释）。特别感谢 Laky 和 ​​justinhj 的帮助！！！

# python - 如何在matplotlib中对曲线下的区域进行着色

> ID：10046262
> 
> 赞同：51
> 
> 时间：2012-04-06T16:25:52.460
> 
> 标签：python, numpy, matplotlib

我想用 matplotlib 来说明两个区域之间的定积分：x_0 和 x_1。

给定下图，我如何在 matplotlib 中从 x=-1 到 x=1 对曲线下的区域进行着色

```
import numpy as np
from matplotlib import pyplot as plt
def f(t):
    return t * t

t = np.arange(-4,4,1/40.)
plt.plot(t,f(t)) 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2015-06-01T18:30:49.557

我想出的最终答案是使用[`fill_between`](https://matplotlib.org/api/_as_gen/matplotlib.pyplot.fill_between.html).

我认为类型方法之间会有一个简单的阴影，但这正是我想要的。

```
section = np.arange(-1, 1, 1/20.)
plt.fill_between(section,f(section)) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-04-06T16:29:07.753

退房[`fill`](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.fill)。这是填充受限区域的[示例](http://scipy-cookbook.readthedocs.org/items/Matplotlib_SigmoidalFunctions.html)。

# spring - 弹簧表单支持对象问题

> ID：10046263
> 
> 赞同：0
> 
> 时间：2012-04-06T16:25:55.383
> 
> 标签：spring, controller

我正在为 Spring 在 POST 期间处理表单支持对象的方式而苦苦挣扎。正如预期的那样，在 html 表单中具有相应输入标记的 ScreenObject 属性在帖子中仍然存在。但是如果一个属性没有输入标签，就会出现两种情况：

1.  如果属性作为请求参数传入，它会在帖子中继续存在。
2.  如果属性未作为请求参数传入，则它不会在帖子中存活。

这是我的代码。

**屏幕对象**

```
private Integer hostSiteSectionId; // no input tag but survives if passed as a request param
private String name;  // input tag so survives
private String orderFactor; // input tag so survives

private Integer hostSiteId; // no input tag but survives if passed as a request param
private String hostSiteName; // no input tag and not passed as request param so does not survive 
```

**得到**

```
@RequestMapping(method=RequestMethod.GET)
public ModelAndView edit(@RequestParam(value="hostSiteId", required=false) Integer hostSiteId, @RequestParam(value="hostSiteSectionId", required=false) Integer hostSiteSectionId, Locale locale) {
    HostSiteSectionHeaderEditScreenObject screenObject=new HostSiteSectionHeaderEditScreenObject();

    initializeScreenObject(hostSiteId, hostSiteSectionId, screenObject, locale, true);

    ModelAndView modelAndView=new ModelAndView();
    modelAndView.addObject("screenObject", screenObject);
    modelAndView.setViewName(WebView.HOST_SITE_SECTION_HEADER_EDIT_PAGE.getViewName());
    return modelAndView;    
} 
```

**POST 取消**

```
@RequestMapping(method=RequestMethod.POST, params="cancel")
public String cancel(@ModelAttribute("screenObject") HostSiteSectionHeaderEditScreenObject screenObject) {
    // logic that returns redirect
} 
```

我的 initializeScreenObject() 方法只设置 screenObject 的属性。它不适用于模型。我看不出它会如何干扰，所以我没有发布它的基本代码。

在这篇文章中，它在其他文章中的工作方式相同，screenObject 具有以下内容：

1.  用户通过输入标签在表单中提供的所有输入都存在。没有任何问题。
2.  仅当 getter url 将其作为参数包含在 screenObject 中时 hostSiteId（无输入标记）才存在（例如，edit?hostSiteId=2）
3.  仅当 getter url 将其作为参数包含在 screenObject 中时 hostSiteSectionId（无输入标记）才存在（例如，edit?hostSiteSectionId=2）
4.  所有其他没有相应输入标签且未作为请求参数传入的属性为空。

为了进一步说明#4。我有一个在 initializeScreenObject() 方法中设置的 screenObject.hostSiteName 属性。使用 正确呈现视图`<td>${screenObject.getHostSiteName()}</td>`。现在我单击取消提交控件。当控制器接管提交时，该属性为空。

请解释这是否是预期的。如果预期，请解释如何去做。我想，我可以为那些需要在帖子中生存的属性添加隐藏的表单字段，但这有点小技巧。我希望有更好的答案。以及原始请求参数如何在后期操作中成为焦点..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:44:11.403

这听起来像是预期的行为。作为参数传递给 POST 处理程序方法的 HostSiteSectionHeaderEditScreenObject 实例与您在 GET 处理程序方法中放入模型中的实例不同。默认情况下，它是 Spring 创建的一个新实例。Spring 将根据 POST 请求中存在的参数将值绑定到对象的字段。因此，如果 POST 中不存在参数（例如，因为您没有在 HTML 表单中输入）该字段将不会由 Spring 设置，它将只是该字段的默认初始值.

听起来您可能想要将 initializeScreenObject() 应用于您的屏幕对象，然后再应用请求参数值？有几种方法可以解决这个问题。一种是使用@ModelAttribute 注释的控制器方法：

```
@ModelAttribute("screenObject")
public HostSiteSectionHeaderEditScreenObject initScreenObject(@RequestParam(value="hostSiteId", required=false) Integer hostSiteId, @RequestParam(value="hostSiteSectionId", required=false) Integer hostSiteSectionId, Locale locale) {
    HostSiteSectionHeaderEditScreenObject screenObject=new HostSiteSectionHeaderEditScreenObject();

    initializeScreenObject(hostSiteId, hostSiteSectionId, screenObject, locale, true);
} 
```

[http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-modelattrib-methods](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-modelattrib-methods)

如果你这样做，你的 GET 处理程序方法可以被简化为只返回一个视图名称。

# iphone - 使用 NSTimer 时提高速度

> ID：10046265
> 
> 赞同：0
> 
> 时间：2012-04-06T16:26:00.500
> 
> 标签：iphone, animation, nstimer

我创建了一个动画游戏应用程序，其中我使用 NSTimer 在特定时间间隔后移动图像。

```
timer = [NSTimer scheduledTimerWithTImerInterval:0.2 target:self selector:@selector(MoveVirus) userinfo:nil repeats:YES]; 
```

此计时器调用函数 MoveVirus，MoverVirus 移动病毒（屏幕上的图像）。

它在开始时工作正常，但运动速度会自动增加。运动速度的增加破坏了所有进一步的逻辑。

我不知道它有什么问题？

请帮助解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:43:32.387

NSTimer 不一定适用于这种用途......来自 NSTimer 上的文档：

> 定时器不是实时机制；它仅在已添加计时器的运行循环模式之一正在运行并且能够检查计时器的触发时间是否已过时触发。由于典型的运行循环管理的各种输入源，计时器的时间间隔的有效分辨率被限制在 50-100 毫秒的数量级。如果在运行循环处于未监视计时器的模式或长时间调用期间发生计时器的触发时间，则计时器不会触发，直到运行循环下一次检查计时器。因此，定时器触发的实际时间可能是计划触发时间之后的一个重要时间段。

如果要移动包含在 UIImageView 中的 UIImage，更好的方法是使用 UIView 上的类动画方法。如果使用包含延迟的动画方法，在特定时间后移动图像仍然可以获得相同的结果。方法是：

```
+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion 
```

使用这个方法，你可以指定动画的时间（动画你的 UIImages 的移动需要多长时间），在开始这个动画之前等待多长时间，一组动画选项，一个动画代码块和一个块动画完成时执行。

# eclipse - Eclipse Indigo 中的 Visual Studio 工具链插件

> ID：10046271
> 
> 赞同：2
> 
> 时间：2012-04-06T16:26:21.527
> 
> 标签：eclipse, plugins, toolchain

互联网上的几个链接（例如： [http](http://drdobbs.com/article/print?articleId=232300575&siteSectionName=) ://drdobbs.com/article/print?articleId=232300575&siteSectionName = http://www.hydrogenaudio.org/forums//lofiversion/index.php/t74268.html）指出那里是一个 Eclipse Indigo 的 VS 工具链插件，它将 Visual Studio (Express) 集成到 CDT 中。有人能指出从哪里下载吗？

感谢：D。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T18:50:57.417

Download eclipse (preferably for c++) development. THen goto help menu in eclipse and select an option to install new software (plugins). Select all sources and search for visual studio. Select plugin and install it (you don't have to worry where it comes from).

# c# - c#应用程序会在linux操作系统上运行吗

> ID：10046273
> 
> 赞同：1
> 
> 时间：2012-04-06T16:26:30.587
> 
> 标签：c#, .net, linux

我正在开发一个应用程序，它使用 IP 和端口号通过设备的 GPRS 从我的 GPS 设备接收数据（如坐标、速度等）到我的 linux OS 服务器。

我想知道 .NET 框架 4.0 应用程序会在 linux 操作系统上运行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:28:25.520

您可以使用 mono 在 linux 上运行 C# 应用程序。我相信 3.5 是受支持的最新框架。你可以在这里查看：[Mono Project](http://www.mono-project.com/Main_Page)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:44:12.217

只是添加（在可能的重复并与 4.0 相关）...
[http://www.mono-project.com/Compatibility](http://www.mono-project.com/Compatibility)

```
The easiest way to describe what Mono currently supports is: 
Everything in .NET 4.0 except WPF, EntityFramework and WF, limited WCF. 
```

# inversion-of-control - 在手动创建的对象上注入行为

> ID：10046277
> 
> 赞同：0
> 
> 时间：2012-04-06T16:27:04.400
> 
> 标签：inversion-of-control, autofac

我正在使用autofac。到目前为止，我通过构造函数注入解决了所有依赖项。

有一种情况我被卡住了：

考虑给定的客户类别：

```
public class Customer : ICustomer
{
    public string Name { get; set; }

    private int ExternId { get; set; }

    public IExternalIdProvider externalIdProvider { get; set; }

    public Customer()
    {
            this.externalIdProvider = new ConcreteIdProvider(this);
    }

    public BevorSave()
    {
        this.ExternId = externalIdProvider.GetNextId();
    }
} 
```

为了根据请求或 gui 操作创建新的客户对象。我使用新的运算符。但是 - 我想注入的 CustomerClass 中有一个 IdProvider。（作为财产）。

如果客户将由 ioC 容器解决，我将使用如下配置：

```
builder.RegisterType<ConcreteIdProvider>().As<IExternalIdProvider>();
builder.RegisterType<Customer>().As<ICustomer>()
       .OnActivated(ae =>
            {
              IExternalIdProvider idProvider = 
                ae.Context.Resolve<IExternalIdProvider>(TypedParameter.From(ae.Instance));
              ae.Instance.externalIdProvider = idProvider;
            }); 
```

我的问题是：如何在客户中注入 ExternalIdProvider 的行为？（使用自动法）

本文展示了一个示例，如何使用服务定位器完成此操作：http: [//blogs.msdn.com/b/simonince/archive/2008/06/30/dependency-injection-is-dead.aspx](http://blogs.msdn.com/b/simonince/archive/2008/06/30/dependency-injection-is-dead.aspx)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T09:25:58.157

您应该重新考虑对您的实体有行为。在您的实体中存在行为会迫使您对它们进行依赖注入，这会导致您已经注意到的尴尬情况。看看[这个相关的 SO question 和 Mark Seemann's great answer](https://stackoverflow.com/questions/4835046/why-not-use-an-ioc-container-to-resolve-dependencies-for-entities-business-objec)。

因此，不要对`Customer`类进行这些操作，而是将它们移动到[存储库](http://martinfowler.com/eaaCatalog/repository.html)类。其他要查看的模式是[工作单元](http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=84)、[命令](http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=91)和[查询](http://www.cuttingedge.it/blogs/steven/pivot/entry.php?id=92)。

# database - CouchDB 视图：在 map reduce 中可以接受多少处理？

> ID：10046285
> 
> 赞同：8
> 
> 时间：2012-04-06T16:27:57.843
> 
> 标签：database, nosql, couchdb, mapreduce

我一直在用 CouchDB 玩 Map Reduce。一些示例在 map reduce 函数中显示了一些可能很繁重的逻辑。在一种特殊情况下，他们在 map 中执行 for 循环。

在发出您选择的文档之前，map reduce 是否在每个可能的文档上运行？

如果是这样，我认为这意味着*在*map reduce 函数中运行任何类型的迭代处理至少会增加一个数量级的处理负担。

基本上它归结为以下问题：**在 map reduce 执行不合理昂贵的查询之前可以执行多少逻辑**？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-07T05:32:07.293

在 CouchDB map-reduce 中可以接受大量昂贵的处理。

CouchDB 视图（map-reduce）更像`CREATE INDEX`是`SELECT FROM`.

具体来说，CouchDB 保证 map 函数在每个文档中*只*运行一次。（嗯，实际上每个文档*更改*一次。）这就是“迭代映射减少”。

因此，假设您有 10,000 个文档，每个文档需要 1*秒*来处理（这比我见过的要高得多）。也就是说，完全构建视图需要 10,000 秒或 2.8 小时。但是，一旦视图完成，查询任何行 ( `?key=...`) 或行切片 ( `?startkey=...&endkey=...`) 与直接查询文档所花费的时间相同。文档计数的查找时间为 O(log n)。

换句话说，即使每个文档需要 1 秒来执行映射，也需要几毫秒来获取结果。（当然，视图必须先构建，因为它实际上是一个索引。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-07T05:42:03.857

查询数据库是与文档的 map/reduce 无关的活动。因此查询成本不受 map/reduce 复杂性的影响。

在 couchdb 中，您正在查询索引。这意味着它是以针对查询速度优化的格式复制您的数据。查询不像 sql 中的表扫描。它不会遍历记录。

那么如何制作这个索引呢？它是通过地图功能完成的。map 函数发出一个键和一个值。键放在索引中。您提到的一些复杂的映射函数可能会循环并发出许多键和值。Couchdb 很聪明，只在需要时运行文档，通常是在创建、更新和删除时。这就是为什么它是增量映射/减少。

如您所见，复杂的地图功能可能会影响创建、更新和删除速度。但是，couchdb 再次很聪明，因为您可以在查询索引时指定数据的陈旧程度。

# assembly - 位算术 - 将两个结果连接到一位

> ID：10046286
> 
> 赞同：0
> 
> 时间：2012-04-06T16:28:04.380
> 
> 标签：assembly, binary, bit-manipulation, mips, mars-simulator

[我正在MARS 模拟器](http://courses.missouristate.edu/KenVollmar/mars/)(Assembly)中做作业，但我被困在一个部分。

我们必须将一个 32 位字加载到寄存器中。

第 0 到 7 位代表蓝色，第 8 到 15 位代表绿色，第 16 到 23 位代表红色。其余位设置为零。

例如，黄色是 0x00ffff00。

```
 [31]       [24]|[23]         [16]|[15]         [8] | [7]         [0]
+----+-   -+----+----+- ... -+----+----+- ... -+----+----+- ... -+----+
| 0  | ... | 0  |    RED COLOR    |   GREEN COLOR   |   BLUE COLOR    |
+----+-   -+----+----+- ... -+----+----+- ... -+----+----+- ... -+----+ 
```

即内存顺序中的 BGR0 颜色格式，或本地字节序机器字中的 0RGB。

作业分为三个任务，我在做最后一个。我们有一个 64 x 64 像素的显示器（每个像素为 4*4，因此总宽度和高度为 256）。红色始终设置为 0，绿色为 4 * 行数，蓝色为 4 * 列数。假设我们在 2 行和 3 行，绿色值为 2*4，蓝色值为 3*4。因此，在此示例中，在十六进制中，12 为 0xc，8 为 0x08，应加载到寄存器中的数字为 0x00000c08。

所以我的第一个问题是如何使用位代数来连接 2 次乘法的结果？

我的第二个问题是：假设我们在最后一个像素行和列：64 * 4 和 64 * 4。结果是 256，我们不能只使用 8 位来表示这个数字，所以我可能不应该使用像素1 到 64 但 0 到 63。对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:47:56.097

所以你有 0x08 和 0x0C 并且你想要 0x0C08 ？

查找位移

在类似 C 的语言中，它会像

```
(0x0C << 8) | 0x08

(0x0C << 8) gives 0x0C00 
```

# c++ - 如何在 C++ 中读取二进制文件中的数组

> ID：10046287
> 
> 赞同：0
> 
> 时间：2012-04-06T16:28:06.690
> 
> 标签：c++, arrays, binaryfiles, ifstream

目前，我使用 ifstream 读取 C++ 中的数组，通过对值进行循环来读取和 reinterpret_cast。是否可以一次从二进制文件中加载一个无符号整数数组而不进行循环？

非常感谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:31:16.767

是的，只需传递数组第一个元素的地址，以及数组的大小（*以字节为单位）*：

```
// Allocate, for example, 47 ints
std::vector<int> numbers(47);

// Read in as many ints as 'numbers' has room for.
inFile.read(&numbers[0], numbers.size()*sizeof(numbers[0])); 
```

注意：我几乎从不使用原始数组。如果我需要一个看起来像数组的序列，我使用`std::vector`. 如果必须使用数组，则语法非常相似。

读写二进制图像的能力是不可移植的。您可能无法在另一台机器上重新读取数据，甚至无法在具有不同编译器的同一台机器上重新读取数据。但是，使用您现在使用的解决方案，您已经遇到了这个问题。

# java - 在 Java 中使用 TreeMap

> ID：10046289
> 
> 赞同：1
> 
> 时间：2012-04-06T16:28:13.497
> 
> 标签：java, sorting, collections, treemap

我在网上（和 Stackoverflow）搜索了很多，但找不到我要找的东西。也无法真正理解这个概念。

作为 Java 分配，我有一个 treeMap 在其中存储一些值。

```
static Map<String, Double> customers = new TreeMap<String, Double>(); 
```

自然地，它按其字符串值升序存储它们。但我希望它存储它的值按它的 Double 值升序。我怎样才能通过比较器实现这一点？细节将不胜感激。

同样在这个作业中，我还有另一个单独的 treeMap，它存储不同的值。再次声明如下：

```
static Map<String, Double> customers = new TreeMap<String, Double>(); 
```

它可以按字符串升序存储它的值。我像这样使用它来打印它的值，但我还需要按 Double 排序的升序打印它的值。那么如何重新排序treeMap。再次，细节将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:30:38.773

您无法重新排序`TreeMap`. 它有一个固定的迭代顺序，在`TreeMap`构造时确定。如果您想要不同的排序顺序，请使用不同的数据结构。

> 我像这样使用它来打印它的值，但我还需要按 Double 排序的升序打印它的值。

所以不用担心排序`TreeMap`。在地图中创建一个`List<Double>`值，并对它们进行排序。

```
List<Double> values = new ArrayList<Double>(customers.values());
Collections.sort(values);
System.out.println(values); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:31:46.693

制作另一张地图：

```
Map<Double, String> values = new TreeMap<Double, String>(); 
```

并始终添加到两个地图（例如通过辅助方法）。除非存在内存限制，否则您的`customers`地图将按客户`values`排序并按值表示的任何`Double`值排序。

如果您可以有重复的值，您可以创建一个客户列表（或一组，取决于要求）：

```
Map<Double, List<String>> values = new TreeMap<Double, List<String>>(); 
```

# php - 使用 grep 在目录中的所有文件中搜索字符串的实例，使用 PHP bash 脚本

> ID：10046295
> 
> 赞同：0
> 
> 时间：2012-04-06T16:28:30.840
> 
> 标签：php, linux, grep

我正在编写一个 PHP 命令行脚本，我想知道是否有任何 grep 专家可以帮助我想出一个命令来执行以下操作：

对于当前目录 ($curDir) 中以 .java 结尾的所有文件，在文件中搜索 $str 的任何实例，并返回是否找到任何实例的指示符。

我尝试从互联网上找到的各种位拼凑一个 grep 命令，但是以前没有真正使用过 grep，拼凑起来有点困难。我将不胜感激任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:36:35.877

这应该可以解决问题：

```
exec("grep '$str' *.java", $output_array); 
```

如果`-l`您希望它只输出文件名，请使用。其他 grep 选项可以在这里找到：
[http ://unixhelp.ed.ac.uk/CGI/man-cgi?grep](http://unixhelp.ed.ac.uk/CGI/man-cgi?grep)

取决于`$str`你可能需要通过什么`escapeshellarg()`：：
[http ://www.php.net/manual/en/function.escapeshellarg.php](http://www.php.net/manual/en/function.escapeshellarg.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:36:27.523

Grep 非常适合这项任务。

```
grep -rl '$str' . 
```

该命令将报告与您的字符串匹配的文件的文件名。它只会报告每个文件名一次，但这似乎是您想要的。选项“-r”表示递归遍历文件系统，选项“-l”表示只报告包含匹配项的文件。您可能还想查看选项“-H”和“-n”，因为我经常使用它们。

# java - Android 更新 17 似乎与外部 Jar 不兼容

> ID：10046298
> 
> 赞同：18
> 
> 时间：2012-04-06T16:28:53.940
> 
> 标签：java, android, macos

我只是允许我的 Mac 对其 Java 安装进行更新，现在我的一些旧 jars（如`javax.mail`和`apache.commons.httpclient`）在运行时抛出*“找不到类”*异常！

意思是，它们编译得很好，但在运行时会崩溃，异常如​​下所示：

```
E/dalvikvm(2414): Could not find class 'javax.mail.internet.InternetAddress', referenced from method com.my.project.Main.isValidEmailAddress 
```

我是否需要获取具有这些类的 jar 的更新版本？还是我需要恢复到以前的 Java 版本？

或者这是一些完全不相关的问题，我只是假设与 Java 更新有关*（很巧合，所有这些都在更新之前完美运行）*？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-04-06T17:08:34.980

> 在运行时崩溃，异常如​​下所示： `Could not find class 'javax.mail.internet.InternetAddress', referenced from method com.my.project.Main.isValidEmailAddress`

如果您在使用外部 jar 时遇到问题，那么：

1.  创建一个名为`libs`.
2.  将所有需要的外部 jar 文件复制并粘贴到该文件夹​​中。

它将自动包含在内，如本页所述：[处理 Android 项目中的依赖项](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-20T04:43:03.163

同样的事情发生在我身上，但我的文件夹被标记为“lib”而不是“libs”arg！这次更新有点粗糙...在从项目设置中删除外部 jar 并将文件夹更改为 libs 后修复

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T06:49:50.760

如果重命名`lib`to`libs`不起作用，那么试试[这个](https://stackoverflow.com/questions/9831019/updated-sdk-version-getting-classnotfoundexception-android-support-v4-view-vie)。

# android - GreenDroid 操作栏文本

> ID：10046301
> 
> 赞同：0
> 
> 时间：2012-04-06T16:28:58.143
> 
> 标签：android, greendroid

我使用greendroid在api 11下实现actionbar。

现在我的 MainView 中有一个奇怪的行为（startview 运行良好）

```
public class MainView extends GDActivity {

    private boolean ison = false;
    private FinderThread finder; 
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

     //this.getActionBar().removeViewAt(0);
    setActionBarContentView(R.layout.mainlayout);
    getActionBar().setBackgroundColor(Color.parseColor("#bf27c3"));

    setTitle("TEST");  
    setTitleColor(Color.WHITE);
    addActionBarItem(getActionBar().newActionBarItem(NormalActionBarItem.class).setDrawable(R.drawable.person)); 
```

看着：

![在此处输入图像描述](../Images/ac5a5489c51f91283a507a93f9bd56b7.png)

操作栏文本为空且没有主页按钮。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:40:07.370

您可以尝试设置标题和标题的颜色

`getActionBar().setTitle("Title")`

颜色也是一样。还尝试通过 RGB 值设置颜色。

我不能保证这会奏效，因为我的操作栏不使用 greendroid。但我知道你不使用 actionbarsherlock + greendroid，因为它们只与一个技巧兼容（有点黑客 xD）

# c# - Citrix 如何支持 SHAppBarMessage？

> ID：10046302
> 
> 赞同：1
> 
> 时间：2012-04-06T16:29:06.640
> 
> 标签：c#, .net, winapi, citrix

根据 Citrix 发布的“无缝应用程序编程指南”（下面的链接），Citrix 支持一些 SHAppBarMessage，但没有提供有关其支持的任何详细信息：

> 有限外壳功能支持的元素包括以下内容：
> 
> 1.  Shell_NotifyIcon
> 2.  SHAppBarMessage（注：此 API 目前不完全支持）
> 3.  支持通常由 Explorer 桌面创建的 shell 功能的 Windows

[http://support.citrix.com/servlet/KbServlet/download/15599-102-664576/Seamless%20Application%20Programming%20Guide.pdf](http://support.citrix.com/servlet/KbServlet/download/15599-102-664576/Seamless%20Application%20Programming%20Guide.pdf)

知道支持什么或如何使其工作吗？我只想获取**客户端**计算机上任务栏的大小（调用 GetTaskbarPos 返回 Citrix 客户端上任务栏的大小和位置，这不是我需要的）。

# java - 通过字符串类本身反转字符串

> ID：10046304
> 
> 赞同：-3
> 
> 时间：2012-04-06T16:29:11.747
> 
> 标签：java

我有一个字符串让我们说“saral”。我想反转这个字符串。如何通过字符串类本身来完成？

不通过字符串缓冲区或字符串生成器，而仅通过字符串类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:43:44.763

您可以使用递归函数，例如：

```
public static String reverse(String in) {
   int pos = in.length() - 1;
   return pos == -1 ? "" : in.substring(pos) + reverse(in.substring(0, pos));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:43:54.930

由于 Java 字符串是不可变的并且它们不提供任何方法，因此没有简单、有效的方法来做到这一点`reverse()`。但是您可以通过以相反的顺序迭代目标字符串并将字符添加到新字符串中来构建反向字符串：

```
public static String reverse(String source) {
  String target = "";
  for (int i=0; i<source.length(); i++) {
    target = source.charAt(i) + target;
  }
  return target;
} 
```

请注意，这是非常低效的，因为字符串连接（通过`+`运算符）实际上在后台创建了一个 StringBuffer，因此您分配了一堆临时对象。

# tsql - AdventureWorks SQL 冲突结果问题

> ID：10046306
> 
> 赞同：1
> 
> 时间：2012-04-06T16:29:37.563
> 
> 标签：tsql, sql-server-2008-r2, adventureworks

我正在使用 AdventureWorks 示例数据库 - 我们正在运行 SQL Server 2008R2，所以我认为这是 AdventureWorks 的版本（我具有只读访问权限）。我正在尝试获取销售经理的列表，以便我可以确定几个员工/经理关系。我得到两组三个不同名字的人，他们的职位相同，他们的 CurrentFlag 设置为 1（活动），查询略有不同。我确实注意到一个结果组具有相同的contactID 和employeeID，但我不确定这可能表明什么。

所以问题是：为什么我对这两个 queires 得到完全不同的结果？我想我会得到六个结果 - 查询匹配员工表标题。

*   SQL 查询 1：

    ```
    select 
       c.FirstName, 
       c.LastName, 
       c.ContactID, 
       e.EmployeeID, 
       e.Title, 
       c.Title, 
       e.CurrentFlag
    from Person.Contact c 
    inner join HumanResources.Employee e
       on c.ContactID = e.ContactID
    where 
       e.Title like '%Sales Manager%' 
    ```

*   SQL查询2：

    ```
    SELECT 
       e.EmployeeID, 
       (c.FirstName + ' ' + c.LastName) as 'First Name and Last Name', 
       e.Title
    FROM HumanResources.Employee e 
    INNER JOIN Person.Contact c
        ON e.EmployeeID = c.ContactID
    Where 
        e.Title LIKE '%Manager%'
        AND
        e.Title LIKE '%Sales%'
    ORDER BY e.EmployeeID; 
    ```

更新：这些是我的结果：

*   SQL 查询 1：

    ```
    -------  -------  ----  ---  ----------------------------  ----  --
    Stephen  Jiang    1011  268  North American Sales Manager  NULL  1
    Amy      Alberts  1013  284  European Sales Manager        NULL  1
    Syed     Abbas    1012  288  Pacific Sales Manager         Mr.   1 
    ```

*   SQL查询2：

    ```
    ---  ---  -----------  ----------------------------  ---  --
    268  268  Gary Drury   North American Sales Manager  Mr.  1
    284  284  John Emory   European Sales Manager        Mr.  1
    288  288  Julie Estes  Pacific Sales Manager         Ms.  1 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:35:05.787

我能看到的唯一不同是：

```
where 
   e.Title like '%Sales Manager%' 
```

还有这个：

```
Where 
 e.Title LIKE '%Manager%'
    AND
  e.Title LIKE '%Sales%' 
```

第一个查询说，给我带来`'%Sales Manager%'`你可以拥有的所有标题，例如这个输出：

```
Account Sales Manager
some Sales Manager
Sales Manager something else 
```

第二个问题说把所有有`'%Manager%`' 的标题带给我，`'%Sales%'`这样你就可以拥有：

```
Sales Account Manager
some Sales some Manager some 
Sales Manager some else thing
Manager Sales 
```

而且这个连接不能正确

```
INNER JOIN Person.Contact c
    ON e.EmployeeID = c.ContactID 
```

你不是说：

```
INNER JOIN Person.Contact c
        ON e.ContactID= c.ContactID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:35:19.997

第一个查询将匹配存在子字符串“Sales Manager”的行。但第二个也可以匹配“销售部经理”之类的行。我的意思是第二个不关心单词在 srting 中的位置。

我相信第一个查询的结果是第二个查询结果的子集。

**UPDATE** 您在 JOIN 子句中使用了不同的列，因此您得到不同的结果是正常的。

# c++ - 从 Window* 访问小部件

> ID：10046314
> 
> 赞同：2
> 
> 时间：2012-04-06T16:30:38.057
> 
> 标签：c++, widget, gtkmm

在我的代码中，我有一个 Gtkmm`Gtk::Window*`并且我想经常访问它的小部件。我该怎么做？

我的意思是看看有没有像`Builder->get_widget()`. 感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:03:41.533

并不真地。有一些方法可以找到一个小部件的孩子，但这是一个巨大的痛苦。就个人而言，如果我需要弄乱类外的任何小部件，我总是将 Gtk::Window 子类化并公开（或公开函数）。

Gtk::Bin 类，其中 get_child() 为：http: [//developer.gnome.org/gtkmm/unstable/classGtk_1_1Bin.html#a8e7fef9251afa541318bb53dcf3098db](http://developer.gnome.org/gtkmm/unstable/classGtk_1_1Bin.html#a8e7fef9251afa541318bb53dcf3098db)

# c# - 将电子邮件标签设为超链接

> ID：10046317
> 
> 赞同：2
> 
> 时间：2012-04-06T16:30:42.633
> 
> 标签：c#, asp.net, email, label

我想知道是否可以将标签设为超链接？下面是我设置的列的代码，我想让“lblEmail”可点击，以便打开电子邮件并在其中包含该电子邮件地址。这个想法是，随着各种用户登录到该站点，他们的独特信息将出现在该列中。是否像将标签控件包装在锚标记中一样简单？如果是这样，我一定错过了一些东西，因为我试过了。由于我是新手，很可能我错过了一些东西！

提前致谢！

```
<p>
<asp:Label ID="lblName" runat="server" Text=""></asp:Label>&nbsp;<br />
<asp:Label ID="lblPhoneNo" runat="server" Text=""></asp:Label>&nbsp;<br />
<asp:Label ID="lblAddress" runat="server" Text=""></asp:Label>&nbsp;<br />
<asp:Label ID="lblCity" runat="server" Text=""></asp:Label>, <asp:Label ID="lblState" runat="server" Text="Label"></asp:Label>&nbsp;<asp:Label ID="lblZipCode" runat="server" Text="Label"></asp:Label>&nbsp;<br />
<asp:Label ID="lblEmail" runat="server" Text=""></asp:Label>&nbsp;<br />
</p> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:33:22.803

为什么不直接使用超链接服务器控件？

```
<asp:Hyperlink runat="server" id="lnk1">Your Text Here</asp:Hyperlink> 
```

如果您需要其他格式，可以将其包装在其他标签中（或在超链接中插入任何合法的 HTML 标签）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T16:35:52.893

您可以使用超链接控件，而不是使用标签。用法如下：

```
<asp:HyperLink id="hyperlink1" 
              ImageUrl="images/pict.jpg"
              NavigateUrl="http://www.microsoft.com"
              Text="Microsoft Official Site"
              Target="_new"
              runat="server"/> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T16:46:34.157

与其***使用超链接之类的标签方式***，不如直接使用超链接。尝试以下操作：

```
<asp:Hyperlink runat="server" id="email" NavigateUrl="your_desired_address">
    EmailLabelContent here
</asp:Hyperlink> 
```

谢谢。

# javascript - 如何将简单的 Javascript 数组绑定到 MVC3 控制器操作方法？

> ID：10046320
> 
> 赞同：2
> 
> 时间：2012-04-06T16:31:08.670
> 
> 标签：javascript, asp.net-mvc-3, modelbinders

这是我用来创建数组并以它的方式发送它的 javascript 代码：

```
<script type="text/javascript" language="javascript">
    $(document).ready(function () {
        $("#update-cart-btn").click(function() {
            var items = [];
            $(".item").each(function () {
                var productKey = $(this).find("input[name='item.ProductId']").val();
                var productQuantity = $(this).find("input[type='text']").val();
                items[productKey] = productQuantity;
            });

            $.ajax({
                type: "POST",
                url: "@Url.Action("UpdateCart", "Cart")",
                data: items,
                success: function () {
                    alert("Successfully updated your cart!");
                }
            });
        });
    });
</script> 
```

该`items`对象是用我需要的值正确构造的。

我的对象必须在控制器的后端使用什么数据类型？

我试过了，但变量仍然为空且未绑定。

```
[Authorize]
[HttpPost]
public ActionResult UpdateCart(object[] items) // items remains null.
{

    // Some magic here.
    return RedirectToAction("Index");
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-06T16:36:11.553

如果要将 JSON 发送到服务器，则需要[JSON.stringify](http://www.json.org/js.html)数据并指定 contentType`application/json`以便与 MVC3 模型绑定器一起使用：

```
 $.ajax({
            type: "POST",
            url: "@Url.Action("UpdateCart", "Cart")",
            data: JSON.stringify(items),
            success: function () {
                alert("Successfully updated your cart!");
            },
            contentType: 'application/json'
        }); 
```

作为服务器上的数据类型，您可以使用强类型类，例如：

```
public class Product
{
    public int ProductKey { get; set; }
    public int ProductQuantity { get; set; }
}

[HttpPost]
public ActionResult UpdateCart(Product[] items)
{

    // Some magic here.
    return RedirectToAction("Index");
} 
```

但是您需要稍微调整一下`items`列表：

```
var items = [];
$(".item").each(function () {
   var productKey = $(this).find("input[name='item.ProductId']").val();
   var productQuantity = $(this).find("input[type='text']").val();
   items.push({ "ProductKey": productKey, "ProductQuantity": productQuantity });
}); 
```

基本上，JSON 对象结构应该与 C# 模型类结构匹配（属性名称也应该匹配），然后 MVC 中的模型绑定器会注意使用您发送的 JSON 数据填充您的服务器端模型。[您可以在此处](http://msdn.microsoft.com/en-us/magazine/hh781022.aspx)阅读有关模型绑定器的更多信息。

# ruby - 在我的 mac 上更新 gems - 安装了两个版本的 bundler

> ID：10046321
> 
> 赞同：2
> 
> 时间：2012-04-06T16:31:10.600
> 
> 标签：ruby, rubygems, bundler

我的本地机器上有大量的 gem，我在 RVM 之前和之后都安装了这些 gem，所以我决定将它们全部擦除并重新安装。一切似乎都很好，除了捆绑器：

```
gem list
.....
bundler (1.1.3, 1.0.22) 
```

我不知道为什么 1.0.22 还在那里，我不知道如何摆脱它！

```
$ gem cleanup
  Cleaning up installed gems...
  Attempting to uninstall bundler-1.0.22
  Unable to uninstall bundler-1.0.22:
    Gem::InstallError: gem "bundler" is not installed
  Clean Up Complete

$ gem uninstall bundler-1.0.22
  INFO:  gem "bundler-1.0.22" is not installed 
```

**更新 1** 安德鲁要求的路径信息

```
/Users/brandon/.rvm/gems/ruby-1.9.3-p125-perf@global/gems/bundler-1.0.22/ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-06T16:44:55.227

最有可能发生的是 Bundler 的两个版本安装在两个不同的 gemset 中，其中一个是从另一个继承的。`1.0.22`可能安装在`global`gemset ( `rvm use @global`) 或“root” gemset ( `rvm use <ruby_version>`) 中。进入已`1.0.22`安装的 gemset 后，您应该可以使用`gem uninstall bundler`.

# powershell - Powershell：检查今天的备份是否存在

> ID：10046322
> 
> 赞同：1
> 
> 时间：2012-04-06T16:31:12.680
> 
> 标签：powershell, powershell-2.0

我已经设置了从不同服务器上的各种 SQL 数据库（总共 18 个）到 NAS 上的一组文件夹的每日自动副本，每个文件夹都包含每日 .bak 备份（服务器 A -> C:\Backups\A\，服务器 B -> C:\Backups\B\ 等）。我需要一个 powershell 脚本来检查（每天）每个文件夹以查看复制是否成功。我希望它将所复制文件的名称及其大小以及未复制文件的目录（即当天的 .bak 应该所在的文件夹）写入日志。我有一个列出目标文件夹的数组。我已经复制了到目前为止的内容，但我不确定如何检查“如果对象的 lastwritetime = todaysdate”并记录它是否存在。抱歉，如果这令人困惑，这是我使用 Powershell 的第一周。任何见解将不胜感激。

```
foreach ($folder in $array.destination)
  {gci | sort-object lastwritetime -descending |select -first 1
If
   ($object lastwritetime.Date -eq (Get-Date).Date  #this is wrong, but generally what I want to do
        | Out-File "C:\Script\.log" | ft * -autosize)
Else
  (
  **WRITE DESTINATION OF TODAY'S MISSING .bak TO LOG***
  )
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T22:24:54.997

此脚本检查数据库并标记是否有任何备份失败。它检查完整、差异和日志备份。

```
#Backup Check Version 1.0.
#List Server Name from 
$ServerList = Get-Content "D:\PSScripts\BackupScript\ServerList.txt" 
#Output file Location : Put is IIS if you want to publish 
$OutputFile = "c:\IIS\BackupReport.htm" 
 $HTMLHDR=""
 $BODYRED =""
 $BODYGRN=""
 $now=get-date
 $FOOTER=""

$HTMLHDR += '<style type="text/css"> 
    #Header{font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;width:700;border-collapse:collapse;} 
    #Header td, #Header th {font-size:12px;border:1px solid #98bf21;padding:3px 7px 2px 7px;} 
    #Header th {font-size:10px;text-align:center;padding-top:5px;padding-bottom:4px;background-color:#A7C942;color:#fff;} 
    #Header tr.alt td {color:#000;background-color:#EAF2D3;} 
    </Style>' 

$HTMLHDR += "<HTML><HEAD><TITLE>Backup Page</TITLE></HEAD><BODY>
        <p align=Center><font size=4 face=Bodoni MT color=#003333><B>Backup Report :Location</B></font></p>
        <p align=Center><font face=Bodoni MT color=Green size=3>Last Pulled : $now IST</font></P>
        <center><Table border=1 cellpadding=0 cellspacing=0 width=900 id=Header aling ='center'> 
        <TR> 
            <TH><B>Server Name</B></TH> 
            <TH><B>Database Name</B></TH> 
            <TH><B>RecoveryModel</B></TD> 
            <TH><B>Last Full Backup Date</B></TH> 
            <TH><B>Last Differential Backup Date</B></TH> 
            <TH><B>Last Log Backup Date</B></TH> 
        </TR>"
[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.SMO') | out-null 

## Function if you need to skip or include any specific DB
function CheckDBName ($DBName){
$NameFlage ="true"
    if($DBName -like "*DBName*")    {$NameFlage ="false"}   

    return $NameFlage 
}

##Get Backup details 
ForEach ($ServerName in $ServerList) 
{ 
    if($ServerName -ne ""){
    $DT = Get-WmiObject -Class Win32_LocalTime -ComputerName $servername
    $DateTime = (Get-Date -Day $DT.Day -Month $DT.Month -Year $DT.Year -Minute $DT.Minute -Hour $DT.Hour -Second $DT.Second)

    $SQLServer = New-Object ('Microsoft.SqlServer.Management.Smo.Server') $ServerName  
    Foreach($Database in $SQLServer.Databases) 
        {
        $FLAGE="false"
        $color="Green"  
        $model=$($Database.RecoveryModel)
        $DBName=$Database.Name
        $FBKP=($DateTime-$Database.LastBackupDate).days
        $DBKP=($DateTime-$Database.LastDifferentialBackupDate).days
        $LBKP=($DateTime-$Database.LastLogBackupDate).hours
        $WDay=$DateTime.DayOfWeek
            if($(CheckDBName($Database.name)) -eq "true")   {
                            $tmp= "<tr><TD>$($Servername)</TD><TD>$($Database.Name)</TD><TD>$model</TD>"            
                if($FBKP -ge 7){
                        $color="RED"
                        $FLAGE="true"
                        }
                if($WDay -like "mon*"){
                        if($FBKP -ge 4){
                        $color="RED"
                        $FLAGE="true"
                        }}
                            $tmp+="<TD bgcolor='$color'>$($Database.LastBackupDate)</TD> "
                            $color="Green"
                if($DBKP -ge 1 -AND $FBKP -gt 1){

                    $color="RED"
                    $FLAGE="true"
                    }

                            $tmp +="<TD bgcolor='$color'>$($Database.LastDifferentialBackupDate)</TD>"
                            $color="Green"
                if($Model -like "*Full*"){
                if($LBKP -ge 2){
                    $color="RED"
                    $FLAGE="true"
                }   }
                            $tmp +="<TD bgcolor='$color'>$($Database.LastLogBackupDate)</TD> </TR>" 
                            $color="Green"

                    if($FLAGE -eq "TRUE"){$BODYRED +=$tmp}
                    else {$BODYGRN+=$tmp}
                }
        }
    }
    }
$FOOTER+= "</Table></BODY></HTML>" 
$FILE=$HTMLHDR+$BODYRED+$BODYGRN+$FOOTER
$FILE | Out-File $OutputFile

Exit

###########END######################### 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T17:52:41.540

无需格式化，如果这样做，则必须在管道传输到 Out-File 之前进行。看看这是否有助于您朝着正确的方向开始：

```
$file=dir -path c:\scripts\ | sort LastWriteTime | select -last 1

if ($file.LastWriteTime.ToShortDateString() -eq (get-date).ToShortDatesTring()) {
 #file dates match
 $file | Out-File Log.txt -append
}
else {
 #dates do not match
 Write "destination missing backup log"
} 
```

# actionscript-3 - “错误 #1009：无法访问空对象引用的属性或方法。” 在 Flash CS5 中？

> ID：10046329
> 
> 赞同：-1
> 
> 时间：2012-04-06T16:32:13.523
> 
> 标签：actionscript-3

TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 src::Game/onClick()

这是完整的错误^，但是它不会在时间线上给我错误，而是在播放 Flash 游戏时给我输出。这是代码： http: [//pastebin.com/FnjWCQJ8](http://pastebin.com/FnjWCQJ8)，错误在第 35 行或第 49 行。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:38:31.853

可能是第 31 行 - 您在 Game 构造函数中的舞台实例。您的 MovieClip 可能还没有出现在舞台上。使用 ADDED_TO_STAGE 事件侦听器，然后将侦听器添加到添加到阶段处理程序的阶段。

```
/*
 * Constructor.
 */
public function Game()
{
    addEventListener(Event.ADDED_TO_STAGE, addedToStageHandler);
}

protected function addedToStageHandler(event:Event):void
{
    removeEventListener(Event.ADDED_TO_STAGE, addedToStageHandler);

    // Listeners.
    stage.addEventListener(Event.ENTER_FRAME, _update);
    stage.addEventListener(MouseEvent.MOUSE_DOWN, _mouseAction);
    stage.addEventListener(MouseEvent.MOUSE_UP, _mouseAction);

    stage.addEventListener(MouseEvent.CLICK, onClick);

    // Helicopter.
    _helicopter = new Helicopter();
    stage.addChild(_helicopter);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:52:25.807

这是因为 blue1、blue2 和 blue3 没有在任何地方定义。

```
private function onClick(m:MouseEvent):void{
  blue1.startme = true;
  blue2.startme = true;
  blue3.startme = true;
} 
```

# sql - 尝试根据案例语句创建字段

> ID：10046332
> 
> 赞同：1
> 
> 时间：2012-04-06T16:32:26.813
> 
> 标签：sql, sql-server, sql-server-2008, join, aggregate-functions

我在下面的查询中遇到了一些问题。我正在尝试确定“类别”字段是 A、B 还是 C，然后根据类别创建一个字段。该字段将总结支付字段。但是我遇到了错误，说“关键字 As 附近的语法不正确”。我在 SQL 视图中创建它。使用 SQL Server 2008

```
SELECT r.id, r.category
CASE 
WHEN r.category = 'A' then SUM(r.payment) As A_payments 
WHEN r.category = 'B' then SUM(r.payment) As B_payments
WHEN r.category = 'C' then SUM(r.payment) As C_payments
END
FROM r_invoiceTable As r
GROUP BY r.id, r.category 
```

我有数据应该执行上述所有情况，因为我拥有的数据有 A、B 和 C

样本数据 - r_invoiceTable

```
Id --- Category ---- Payment
222      A      ----   50
444      A      ----   30
111      B      ----   90
777      C      ----   20
555      C      ----   40 
```

期望的输出 A_payments = 80, B_payments = 90, C_payments = 60

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:25:44.573

也许您正在寻找这个：

```
SELECT
  SUM(CASE WHEN category = 'A' THEN payment END) AS A_payments,
  SUM(CASE WHEN category = 'B' THEN payment END) AS B_payments,
  SUM(CASE WHEN category = 'C' THEN payment END) AS C_payments
FROM r_invoiceTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:24:47.563

```
SELECT *
FROM dbo.r_invoiceTable
PIVOT
( SUM(payment)
FOR category IN ([a],[b],[c])
) AS pivoted 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:53:17.680

可能你想要这个（按类别支付的金额）？：

```
SELECT r.category, SUM(r.payment) As Payments 
FROM r_invoiceTable As r
GROUP BY r.category 
```

输出将如下所示：

```
category     Payments
---------   ------------
    A          80
    B          90 
    C          60 
```

如果您喜欢单行中的这些数字，这是一种天真的方法：

```
SELECT 
   (SELECT SUM(r.payment) From r_invoiceTable As r Where r.category = 'A') as A_Payment,
   (SELECT SUM(r.payment) From r_invoiceTable As r Where r.category = 'B') as B_Payment,
   (SELECT SUM(r.payment) From r_invoiceTable As r Where r.category = 'C') as C_Payment 
```

# scala - 如何将Scala对象的主要方法分解为共享位置？

> ID：10046334
> 
> 赞同：3
> 
> 时间：2012-04-06T16:32:29.810
> 
> 标签：scala, refactoring, main

在几个 Scala 对象中，我定义了一个调用 runTests 的 main 方法，它是 Test 中的一个抽象方法。有没有办法将主要方法分解到一个公共位置（特征或其他解决方案），以便我仍然可以通过键入`ctrl`-在 Eclipse 中运行测试`F11`？

这是我目前拥有的，

[https://github.com/janekdb/stair-chess/blob/master/src/chess/model/BoardModelTest.scala](https://github.com/janekdb/stair-chess/blob/master/src/chess/model/BoardModelTest.scala)

```
object BoardModelTest extends Test with TestUtils {

  def main(args: Array[String]) {
    runTests
  }

  def runTests {
  ... 
```

[https://github.com/janekdb/stair-chess/blob/master/src/test/Test.scala](https://github.com/janekdb/stair-chess/blob/master/src/test/Test.scala)

```
trait Test {

  def runTests: Unit
  ... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T17:02:01.627

我在这台计算机上没有 Eclipse，所以我无法测试它是否可以与 Ctrl+F11 一起使用，但我认为你想要一个自我类型：

```
trait Main {
  self: Test => 
  def main(args: Array[String]) {
    runTests
  }
} 
```

然后，您只需在您的`Test`特征之后将其混合：

```
object BoardModelTest extends Test with TestUtils with Main {
  def runTests {}
} 
```

# python - 使用 CRUD 提交 AJAX 表单

> ID：10046335
> 
> 赞同：1
> 
> 时间：2012-04-06T16:32:35.533
> 
> 标签：python, ajax, model-view-controller, web2py

是否可以使用 ajax 验证 CRUD 表单字段而不在 web2py 中提交表单？

我浏览了 web2py 在线文档并看到了这个链接： [http](http://web2py.com/books/default/chapter/29/11#Ajax-form-submission) ://web2py.com/books/default/chapter/29/11#Ajax-form-submission 所以我们可以使用自定义 html 来完成。但我想用 CRUD 来做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T01:48:24.953

是的，您可以为 Crud 表单使用自定义 HTML，但默认情况下，Crud 会在表单中插入隐藏`_formname`和`_formkey`字段（后者用于防止 CSRF 攻击）。因为 Crud 希望这些字段与表单一起提交，所以必须通过 Crud 创建表单，并且必须将表单对象传递给视图，以便您可以包含这些字段。有关为表单创建自定义 HTML 的详细信息，请参见[此处](http://web2py.com/books/default/chapter/29/7#Custom-forms)。

注意，为了更容易通过 Ajax 提交表单，您可以考虑将表单放入 Ajax 组件中`LOAD()`（请参阅[此处](http://web2py.com/books/default/chapter/29/12#Components)）。

# android - Android - ExpandableListView 实现 Filterable

> ID：10046336
> 
> 赞同：0
> 
> 时间：2012-04-06T16:32:42.583
> 
> 标签：android, expandablelistview

我正在开发一个 android 应用程序，其中包含一个可扩展的列表视图和顶部的搜索栏。因此，如果我在编辑文本字段中输入任何内容，我希望它过滤可扩展列表。

例如：我在搜索栏中输入：“ **as ” --> 列表应该只显示如下条目：“** **as** sert”，“b **as** e”，“c **as** e”，“ **as** sembling”等。

我在互联网上搜索了几个小时，但我无法实现此功能。所以我真的希望你能帮助我（：

这是我的可扩展列表适配器：

```
package my.pack;

public class ExpandableListAdapter extends BaseExpandableListAdapter {

    @Override
    public boolean areAllItemsEnabled() {
        return true;
    }

    private Context context;
    private ArrayList<String> groups;
    private ArrayList<ArrayList<Product>> children;

    public ExpandableListAdapter(Context context, ArrayList<String> groups,
            ArrayList<ArrayList<Product>> children) {
        this.context = context;
        this.groups = groups;
        this.children = children;
    }

    public void addItem(Product product) {
        if (!groups.contains(product.getGroup())) {
            groups.add(product.getGroup());
        }
        int index = groups.indexOf(product.getGroup());
        if (children.size() < index + 1) {
            children.add(new ArrayList<Product>());
        }
        children.get(index).add(product);

    }

    public Object getChild(int groupPosition, int childPosition) {
        return children.get(groupPosition).get(childPosition);
    }

    public long getChildId(int groupPosition, int childPosition) {
        return childPosition;
    }

    // Return a child view. You can load your custom layout here.

    public View getChildView(int groupPosition, int childPosition,
            boolean isLastChild, View convertView, ViewGroup parent) {
        Product product = (Product) getChild(groupPosition, childPosition);
        if (convertView == null) {
            LayoutInflater infalInflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = infalInflater.inflate(R.layout.productinsertchild,
                    null);
        }
        TextView tv = (TextView) convertView.findViewById(R.id.tvChild);
        tv.setText("   " + product.getpName());

        return convertView;
    }

    public int getChildrenCount(int groupPosition) {
        return children.get(groupPosition).size();
    }

    public Object getGroup(int groupPosition) {
        return groups.get(groupPosition);
    }

    public int getGroupCount() {
        return groups.size();
    }

    public long getGroupId(int groupPosition) {
        return groupPosition;
    }

    // Return a group view. You can load your custom layout here.

    public View getGroupView(int groupPosition, boolean isExpanded,
            View convertView, ViewGroup parent) {
        String group = (String) getGroup(groupPosition);
        if (convertView == null) {
            LayoutInflater infalInflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            convertView = infalInflater.inflate(R.layout.productinsertgroup,
                    null);
        }
        TextView tv = (TextView) convertView.findViewById(R.id.tvGroup);
        tv.setText(group);
        return convertView;
    }

    public boolean hasStableIds() {
        return true;
    }

    public boolean isChildSelectable(int arg0, int arg1) {
        return true;
    }

} 
```

这里是我的活动：请注意 ExpandableListView 从在线 mysql 服务器获取数据。这就是我使用异步任务的原因。

```
package activities.shop;

public class ProductInsert extends BaseActivity {

    public static final String phpServerConnection = "url-to-php-file";
    public static final String phpgetGrocery = "url-to-php-file";

    static final int MY_DIALOG_ID = 0;
    protected static AppPreferences appPrefs;
    private getGroceryTask ggt = null;

    private ExpandableListAdapter adapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        ExpandableListView listView = (ExpandableListView) findViewById(R.id.listView);

        listView.setOnChildClickListener(new OnChildClickListener() {

            public boolean onChildClick(ExpandableListView arg0, View arg1,
                    int arg2, int arg3, long arg4) {
                Toast.makeText(getBaseContext(), "Child clicked",
                        Toast.LENGTH_LONG).show();
                return false;
            }
        });

        listView.setOnGroupClickListener(new OnGroupClickListener() {

            public boolean onGroupClick(ExpandableListView arg0, View arg1,
                    int arg2, long arg3) {
                return false;
            }
        });

        adapter = new ExpandableListAdapter(this, new ArrayList<String>(),
                new ArrayList<ArrayList<Product>>());

        // Set this blank adapter to the list view
        listView.setAdapter(adapter);

        ggt = new getGroceryTask(this);
        ((getGroceryTask) ggt).execute();

    }

    @Override
    public int getContentViewId() {

        return R.layout.productinsert;
    }

    @Override
    protected Dialog onCreateDialog(int id) {

        ProgressDialog progressDialog = null;

        switch (id) {
        case MY_DIALOG_ID:
            progressDialog = new ProgressDialog(this);
            progressDialog.setMessage("Aktualisieren...");

            break;
        default:
            progressDialog = null;
        }

        return progressDialog;
    }

    final static class getGroceryTask extends
            SuperAsyncTask<String, String, Void> {

        ProductInsert activity;
        InputStream is = null;
        String result = "";

        public getGroceryTask(BaseActivity activity) {

            super(activity, MY_DIALOG_ID); // change your dialog ID here...
            this.activity = (ProductInsert) activity; // and your dialog will be
                                                        // managed
                                                        // automatically!
        }

        @Override
        protected Void doInBackground(String... params) {

            appPrefs = new AppPreferences(activity);

            ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
            nameValuePairs.add(new BasicNameValuePair("uEmail", appPrefs
                    .getUserEmail()));

            try {
                HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost(phpgetGrocery);
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                HttpResponse response = httpclient.execute(httppost);
                HttpEntity entity = response.getEntity();
                is = entity.getContent();

            } catch (Exception e) {
                Log.e("log_tag", "Error in http connection " + e.toString());
            }

            // convert response to string
            try {
                BufferedReader reader = new BufferedReader(
                        new InputStreamReader(is, "UTF-8"), 8);
                StringBuilder sb = new StringBuilder();
                String line = null;
                while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                }
                is.close();
                result = sb.toString();

            } catch (Exception e) {
                Log.e("log_tag", "Error converting result " + e.toString());
            }

            return null;
        }

        private Product get(int pid, String pName, String pKat) {
            return new Product(pid, pName, pKat);
        }

        @Override
        public void onAfterExecute() {

            try {

                JSONArray jArray = new JSONArray(result);
                for (int i = 0; i < jArray.length(); i++) {

                    JSONObject json_data = jArray.getJSONObject(i);

                    activity.adapter.addItem(get(json_data.getInt("pid"),
                            json_data.getString("pName"),
                            json_data.getString("pKat")));

                }

                activity.adapter.notifyDataSetChanged();

            } catch (JSONException e) {
                Log.e("log_tag", "Error parsing datauuuuuu " + e.toString());

            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:54:49.333

您可能会考虑从 CursorTreeAdapter 而不是 BaseExpandableListAdapter 进行扩展 - 这样您就可以为您正在寻找的功能覆盖 getFilterQueryProvider （并提供您自己的[FilterQueryProvider ）。](http://developer.android.com/reference/android/widget/FilterQueryProvider.html)当然，这意味着您必须将 MySQL DB 中的结果转换为游标，但如果您这样做，过滤过程会变得容易得多。

否则，您必须在 ListAdapter 中覆盖`getFilter()`并提供您自己的[过滤器](http://developer.android.com/reference/android/widget/Filter.html)- 这并没有太大的不同 - 它有一些更复杂的情况，但您不必添加光标翻译层。

在任何情况下，将您自己的 textChangedListener 添加到过滤器编辑文本中以调用过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T18:07:38.580

可扩展列表视图的问题在于，如果您有许多与组父母相关联的孩子，则需要时间....

您可以将 AutoCompleteTextView 与可扩展列表视图的预填充项目一起使用，这样您就可以拥有流畅的搜索功能，并允许根据用户选择而不是上述功能刷新列表......您可能会影响最终用户使用上述功能的经验....但是，如果您对实现如此坚持..您可以将相同的 AutoCompleteTextView 与 onKeyDown 功能或 textvalidation 功能一起使用...

看看小部件[http://developer.android.com/reference/android/widget/AutoCompleteTextView.html](http://developer.android.com/reference/android/widget/AutoCompleteTextView.html)

# xslt - RSS 到 XHTML 使用 XSLT - 如何删除奇怪的字符？

> ID：10046348
> 
> 赞同：0
> 
> 时间：2012-04-06T16:33:35.033
> 
> 标签：xslt, xhtml, rss, href

我正在使用 XSLT 在 XHTML 中转换 RSS 文件。为了创建链接，我使用以下代码块：

```
<!-- language: lang-xml -->
<xsl:for-each select="channel/item">
   <h3><a href="{link}"><xsl:value-of select="title"/></a></h3>
   <xsl:value-of select="description"/>
</xsl:for-each> 
```

但结果带有一些不需要的字符：

```
<!-- language: lang-html -->
<h3><a href="%0A                http://site.com/page.htm%0A            "> 
```

我究竟做错了什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:49:21.227

看起来源代码中有 URLEncoded 换行符和一些空格。可以使用 normalize-space() 函数去除前导和尾随空格。其他内容可能更棘手，这取决于它的规则性以及您使用的 XSLT 版本。如果 URL 始终以“%0A”结尾，您可以执行以下操作：

```
substring-before(substring-after(link, 'http'), "%") 
```

只有当您的 URL 中永远不会包含 URLEncoded 数据（这可能不是一个安全的假设）时，这才会一直有效。如果您使用的是 XSLT 2.0，则类似于：

```
normalize-space(replace(link, '%0A', '')) 
```

可能会更好。

# sqlite - SQLite 的最佳查看器？

> ID：10046350
> 
> 赞同：3
> 
> 时间：2012-04-06T16:33:48.477
> 
> 标签：sqlite

什么是最好的 SQLite 浏览器？SQLite 有没有像 phpmyadmin 这样的工具？

我在一个 C# 项目中工作，我需要一种轻松导入/导出示例数据的方法。Sqlite2009 等大多数标准管理器似乎都无法编辑表结构。

# emacs - 如何绑定 Emacs 键以在 shell 中删除整个单词 backword？

> ID：10046352
> 
> 赞同：3
> 
> 时间：2012-04-06T16:33:52.540
> 
> 标签：emacs, elisp

我刚刚开始学习 Linux 和 Emacs。对于最常用的光标移动，在 Emacs 和 shell (bash/tcsh) 中使用相同的键绑定是令人愉快的，这样我就不必有意识地考虑必须使用哪一个。更糟糕的是，使用错误的命令并撤消错误。不过有两个例外。

一个常用的命令相当于退格，向后删除一个字符。在外壳中，它是`C-h`. 我在 Emacs 中得到了相同的行为，这要归功于 Janos 的这个提示，他可能也有同样的感觉。 [http://www.math.rutgers.edu/~komlos/emacs.htm](http://www.math.rutgers.edu/~komlos/emacs.htm)

现在我在 Emacs 中经常犯的错误是试图用 command 向后删除单词`M-C-h`，就像在 shell 中一样。

有人可以提供一个绑定，使 Emacs 用 'MCh' 向后删除单词吗？目前，此命令选择缓冲区中的整个文本，这是一个非常有用的东西（`C-a`在 Windows 中），但不像向后删除单词那样经常使用。

此外，任何替换当前绑定`M-h`（来自上面的链接）以提供帮助的绑定将不胜感激。

谢谢，

艾伦。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T20:16:27.480

下面将 CM h 绑定到 back-kill-word。你可以把它放在你的 .emacs 文件中。

```
(global-set-key (kbd "C-M-h") 'backward-kill-word) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T22:07:20.230

您可以`M-<backspace>`在终端和 emacs 中使用来向后删除单词。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-13T06:13:05.347

最好使用键转换，因此与在任何次要模式下`C-M-h`的工作方式完全相同`M-backspace`（无论是否绑定了 M-退格键`backward-kill-word`）。

```
;; bind C-h to <backspace>
(define-key key-translation-map [?\C-h] [?\C-?])
;; bind C-M-h to M-<backspace>
(define-key key-translation-map [?\C-\M-h] [?\C-\M-?]) 
```

# javascript - Javascript：验证字段（在表单上），使其只能包含字母、允许 1 个连字符和允许 1 个撇号

> ID：10046355
> 
> 赞同：0
> 
> 时间：2012-04-06T16:34:28.327
> 
> 标签：javascript, regex, function, letters, hyphen

这是我第一次真正用 javascript 编码，我已经走到了死胡同。我需要创建一个函数（遗憾的是不允许使用 RegExp），它允许我的披萨表单验证用户的输入。确保它只有字母（没有数字、没有空格、除了连字符和撇号之外没有特殊字符）。

用户可以使用一个撇号（前后各有一个字母）。并且用户可以使用一个连字符（前后各有一个字母），用户也可以同时使用撇号和连字符，只要用一个字母隔开。一旦用户点击提交按钮到 cgi，我的最终结果是显示全部大写的名称。

例子;

输入客户名称：mike 或 m'ike 或 m'i-ke

（点击提交披萨订单）

结果：MIKE 或 M'IKE 或 M'I-KE。

到目前为止，这就是我所拥有的：

```
function validatefield01(errMessages)
{

// Get the content of fieldOne

      var entry1_info   = document.pizza.field01.value;                        

// error condition  will show if character count is less than 4 or greater than 15 

      if ((entry1_info.length <4) && (entry1_info.length <15))                

// error message to be displayed

      {
        errMessages += "    <li>Minimum characters for Client Surname is 4 maximum 15\n";
errMessages += "        must use characters only, Apostrophe ( ' ) or hyphen (-) is acceptable.</li>\n";
      }

      return errMessages;

      for(var i=0; i<entry1_info.length; i++)
      {
             ch = entry1_info.length.charAt(i);
             if(ch !=' ' && ch !='.') return false;

      } 
```

更好地解释这里发生了什么。这个函数将在我的主函数中调用以弹出一个窗口，显示所有错误应该发生（在 if 语句中创建，它确实有效），在我的 else 语句中我有这个

```
else {

       field01=field01.substring(0).toUpperCase();

        return true;                    // No errors - return to browser and submit form
      }
   }                                    //  End of main function 
```

所以现在发生的事情是，如果输入小写字母，表单将不会接受它，但如果输入大写字母，表单将接受它，并将在 cgi 中显示名称。我不知道如何解决这个问题，用户可以输入小写，它应该接受，但在 cgi 中它应该改为大写，这就是为什么我有那个 .toUpperCase()...

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T10:55:40.737

```
function validatefield01(errMessages){

var entry1_info = document.f1.sDate.value

    //if character count is less than 4 or greater than 15.
if ((entry1_info.length < 4) || (entry1_info.length > 15)) {

    // error message to be displayed
    errMessages += "    <li>Minimum characters for Client Surname is 4 maximum 15\n";

    return false;

}

var word = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcedfghijklmnopqrstuvwxyz-'";

    // Check input string validation.
    for ( var i = 0; i < entry1_info.length; i++) {
        if (word.indexOf(entry1_info.charAt(i), 0) == -1) {

        // error message to be displayed.
        errMessages += "must use characters only, Apostrophe ( ' ) or hyphen (-) is acceptable.</li>\n";

        return false;
        }
    }

document.f1.sDate.value = entry1_info.substring(0).toUpperCase();
return true;

} 
```

# c - 从文件中读取 int 时使用重新分配的数组运行代码时出错

> ID：10046356
> 
> 赞同：1
> 
> 时间：2012-04-06T16:34:34.880
> 
> 标签：c

所以指针的初始容量是5，然后它会根据文件中的整数个数来调整自己的大小，之后我想打印出数组中读取的整数。但是我在运行它时遇到了这个错误。

```
ERROR:a.out: malloc.c:3574: mremap_chunk: Assertion `((size + offset) & (mp_.pagesize-1)) == 0' failed.
Aborted 
```

（之后有很多东西）

代码：

```
 #include<stdio.h>
    #include <stdlib.h>

    int main(void)
    {
    int index=0;
    int cap=5;
    int *arr = malloc(cap*sizeof(int));
    FILE *f;

    if((f=fopen("/home/alexchan/Downloads/fileOints000.txt","r"))==NULL)
    printf("You cannot open");

    int *y = arr;

    while(fscanf(f, "%d", arr++)!=EOF)
    {
    index++;
    if(index==cap)
    arr = realloc(arr, (cap +=10) * sizeof(int));
    }

    int x;
    for(x=0;x<index;x++)
    printf("%d\n",*(y++));

    return 0;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:37:44.523

您正在设置`y`指向您的数组，但在重新安装数组时忘记更新其值。

```
while(fscanf(f, "%d", arr++)!=EOF)
{
    index++;
    if(index==cap)  arr = realloc(arr, (cap +=10) * sizeof(int));
}

int *y = arr; // THIS SHOULD BE AFTER THE LOOP 
```

`realloc`在一般情况下不会原地增长数组；它返回一个完全不同的指针。`y`发生这种情况后，不能再使用旧的值。

# regex - 更改列中的值

> ID：10046357
> 
> 赞同：1
> 
> 时间：2012-04-06T16:34:40.770
> 
> 标签：regex, string, r

我在 R 中有一个列，如下所示：

```
won <- c("\001", rep("\\0",3), "\001")

 won
\001
 \\0
 \\0
 \\0
 \\0
\001 
```

有两个可能的值，\0 或 \001

我想知道最有效的方法是将这些值更改为 0（对于 \0）和 1（对于 \001）。我确定 gsub() 是一种选择，但不清楚是否可以更改两个单独的字符串值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:40:18.917

对于这种特定情况：

```
2 - nchar(won) 
```

这是另一种选择：

```
ifelse(won == "\001", 1, 0) 
```

# django - 如果 django 模型中的文件为空或空白，则保存后操作？

> ID：10046363
> 
> 赞同：0
> 
> 时间：2012-04-06T16:35:02.437
> 
> 标签：django, django-models, django-admin

这是我的代码：

```
class Invitation(models.Model):   
    #other fields here
    Code = models.CharField(max_length=128, null=True, blank=True)
    Tags = models.ManyToManyField("CategorieInvitation", null=True, blank=True)
    Tags = models.ManyToManyField("Usage", null=True, blank=True)
    Note = models.CharField(max_length=128, null=True, blank=True)
    Used = models.BooleanField(default=False, blank=True)
    SendTo = models.EmailField(null=True, blank=True)
    # a revoir
    def post_save(self, model_instance, add):
        if self.Code.__len__() == 0 :
            self.Code = generate_invitation(1)[0]
            self.save() 
```

如果 Code 为空白或 null，即使在 django-admin 界面中创建，如何将 Code 替换为 generate_invitation 的结果？

问候比西尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:13:47.670

对于您正在尝试做的事情，覆盖该`save`方法可能更容易和更有效。

```
class Invitation(models.Model):   
    #other fields here
    code = models.CharField(max_length=128, null=True, blank=True)
    tags = models.ManyToManyField("CategorieInvitation", null=True, blank=True)
    tags2 = models.ManyToManyField("Usage", null=True, blank=True)
    note = models.CharField(max_length=128, null=True, blank=True)
    used = models.BooleanField(default=False, blank=True)
    send_to = models.EmailField(null=True, blank=True)
    # a revoir

    def save(self, *args, **kwargs):
        if not self.code:
            self.code = generate_invitation(1)[0]

        super(Invitation, self).save(*args, **kwargs) 
```

顺便说一句`post_save`，不应该是模型实例方法。请参阅：[https ://docs.djangoproject.com/en/1.4/ref/signals/#signals](https://docs.djangoproject.com/en/1.4/ref/signals/#signals)

# java - jruby 添加一个java库

> ID：10046367
> 
> 赞同：1
> 
> 时间：2012-04-06T16:35:17.873
> 
> 标签：java, ruby, jruby

我正在尝试在 Jruby 文件中运行[http://www.savarese.com/software/libssrckdtree-j/ 。](http://www.savarese.com/software/libssrckdtree-j/)

我的代码看起来像这样：

```
require 'java'
require 'libssrckdtree-j-1.0.2.jar'

GenericPoint = Java::com.savarese.spatial.GenericPoint
KDTree = Java::com.savarese.spatial.KDTree
NearestNeighbors = Java::com.savarese.spatial.NearestNeighbors

tree = KDTree.new

def generate_points(tree, size)
  size.times do
    x = rand(100)
    y = rand(100)
    point = GenericPoint.new(x, y)
    tree.put(point, point.to_s)
  end
end

generate_points(tree, 20000)

nearest = NearestNeighbors.new()
point = [1,1]

nearest.get(tree, point, 1, false) 
```

但是，当我运行此代码时，我得到

```
NameError: no method 'get' for arguments (com.savarese.spatial.KDTree,org.jruby.RubyArray,org.jruby.RubyFixnum,org.jruby.RubyBoolean) on Java::ComSavareseSpatial::NearestNeighbors
  (root) at kdjava.rb:25 
```

我没有得到，因为库的文档说要使用 get，我使用 put on tree 来表示 KDtree，它起作用了。

我想要做的是使用这个库将一系列 lat lngs 构建到一个 kd 树中，然后查询另一组 lat lngs 以查看它们在 KD 树中最近的邻居。

我在 Ruby 上还可以——但我在 Java 上很烂。我正在使用 Jruby 来利用这些更快的库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:55:31.253

[NearestNeighbor#get()](http://www.savarese.com/software/libssrckdtree-j/api/com/savarese/spatial/NearestNeighbors.html#get%28com.savarese.spatial.KDTree,%20P,%20int,%20boolean%29)的api 文档表明该方法采用 KDTree、P、int、boolean 类型的四个参数，它们都是 Java 类型。

您的错误消息表明您传入了 KDTree、RubyArray、RubyFixnum、RubyBoolean。所以，KDTree 看起来不错。我相信 JRuby 会自动将 Fixnum 和 Boolean 强制转换为适当的 Java 类型。剩下的第二个参数是你在方法需要 P 的地方传递 RubyArray。

NearestNeighbors 的文档表明 P 是泛型类型，`P extends Point<Coord>`. `Point`是一个接口。`GenericPoint`实现该接口。所以不要通过`[1,1]`，尝试通过`Java::com.savarese.spatial.GenericPoint.new(1,1)`

编辑：

再进一步看，`GenericPoint`必须用`Coord`另一个泛型类型创建`Coord extends java.lang.Comparable<? super Coord>`。在 Java 中，有两种 int，原始类型`int`（快速）和“装箱”对象`java.lang.Integer`。 `Integer`实现`Comparable`接口，这是`GenericPoint`. 运行以下命令时我没有收到任何错误：

```
require 'java'
require 'libssrckdtree-j-1.0.2.jar'

GenericPoint = Java::com.savarese.spatial.GenericPoint
KDTree = Java::com.savarese.spatial.KDTree
NearestNeighbors = Java::com.savarese.spatial.NearestNeighbors

def box(i)
  java.lang.Integer.new(i)
end

tree = KDTree.new

def generate_points(tree, size)
  size.times do
    x = box(rand(100))
    y = box(rand(100))
    point = GenericPoint.new(x, y)
    tree.put(point, point.to_s)
  end
end

generate_points(tree, 20000)

nearest = NearestNeighbors.new()
point = GenericPoint.new(box(1), box(1))

nearest.get(tree, point, 1, false) 
```

关于上面的一个注释，通常在 Java 中创建一个盒装的`Integer`，一个使用[`java.lang.Integer.valueOf(int)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#valueOf%28int%29). 由于我以外的原因，这导致了使用`int`:时遇到的相同错误`NativeException: java.lang.ClassCastException: org.jruby.RubyFixnum cannot be cast to java.lang.Number`。所以我改为使用构造函数`java.lang.Integer.new`.

# java - 设备旋转时丢失“MediaPlayer”（和其他变量）

> ID：10046369
> 
> 赞同：0
> 
> 时间：2012-04-06T16:35:31.477
> 
> 标签：java, android, android-layout, mobile, android-activity

我正在为 Android 创建一个音乐播放器，它大部分都在工作。问题是当我水平转动设备时，我会丢失 Activity 中的所有变量（这是有道理的，因为它被破坏并重新创建）。

我尝试使用捆绑包来存储带有 onSaveInstanceState 和 onRestoreInstanceState 的播放器状态，但我仍然无法访问媒体播放器。有没有办法在捆绑中传递像 MediaPlayer 这样的对象？我应该改用数据库吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:16:33.423

您应该使用服务来提供“背景”音频播放功能，允许用户在活动之间切换或旋转设备而不停止播放。

查看[android_packages_apps_Music](https://github.com/CyanogenMod/android_packages_apps_Music)由 CM 在 github 上开源，它使用 MediaPlaybackService 扩展服务来执行此操作，查看 MediaPlaybackService.java

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:43:44.810

对于无法通过包传递的对象，我建议您使用简单的 SharedPreference 来存储对象。这里有一个简单的实现：

```
public class Data {
     private SharedPreferences preferences; 
     private int test; 

     public Data (Context context)
     {          
        preferences = context.getSharedPreferences("Data", 0);
        test = preferences.getInt("test", 0);
     }

     public int getTest()
     {       
             return test;
     }

     public void setTest(int input)
     {       
        this.test = input;
        SharedPreferences.Editor editor = preferences.edit();
        editor.putInt("Test", input);
        editor.commit();
     }    
} 
```

您只需在 onCreate() 中初始化变量：

> 数据 mydata = 新数据（此）；

您可以使用 set/get 和 mydata 来存储/检索您的持久数据。

编辑：它可能不适合 MediaPlayer 对象，但适用于其他经典类型（int、string、boolean ...）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:44:18.647

下面的两种方法都允许您通过旋转保持您的媒体播放器对象，但都不使用捆绑包。

*   您可以通过使用`onRetainNonConfigurationInstance()`来保存您的媒体播放器并`getLastNonConfigurationInstance()`在旋转后检索它，但这种方法不一定是最好的，因为它并不总是被调用

    -有关更多信息，请参阅此 SO 帖子[https://stackoverflow.com/a/3916068/655822](https://stackoverflow.com/a/3916068/655822)

*   或者您可以通过扩展您的应用程序类并将其存储在其中来持久化您的媒体播放器

    以下信息是从链接的 SO 答案中复制的，目的是使该答案更快阅读

    > 如果要经常使用，您可以在 Global Singleton 中传递数据。

    ```
    public class YourApplication extends Application 
    {     
         public SomeDataClass data = new SomeDataClass();
    } 
    ```

    > 然后通过以下方式在任何活动中调用它：

    ```
    YourApplication appState = ((YourApplication)this.getApplication());
    appState.data.UseAGetterOrSetterHere(); // Do whatever you need to with the data here. 
    ```

    [- 有关该https://stackoverflow.com/a/4208947/655822](https://stackoverflow.com/a/4208947/655822)的更多信息，请参阅此 SO 帖子

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T17:18:35.683

另一种方法是：

在您的 AndroidManifest.xml 中，找到您的活动条目并添加以下属性和值：

```
android:configChanges="orientation|screenSize" 
```

这将阻止您的活动在定向时被破坏和重新创建。

# javascript - 从无序列表中复制某些级别？

> ID：10046383
> 
> 赞同：1
> 
> 时间：2012-04-06T16:36:55.677
> 
> 标签：javascript, jquery, html, dom-manipulation

我是一个初学者程序员，我遇到了以下问题：如果我有一个嵌套的无序列表，我怎样才能只将元素复制到某个级别？例如，如果我想将此无序列表减少到前两个级别：

```
<ul>
  <li>A</li>
  <ul>
    <li>C<br>
    </li>
    <li>D<br>
    </li>
    <ul>
      <li>E<br>
      </li>
      <li>F<br>
      </li>
      <ul>
        <li>G<br>
        </li>
        <li>H<br>
        </li>
      </ul>
    </ul>
    <li>E<br>
    </li>
  </ul>
  <li>B</li>
</ul> 
```

到

```
<ul>
  <li>A</li>
  <ul>
    <li>C<br>
    </li>
    <li>D<br>
    </li>
    <li>E<br>
    </li>
  </ul>
  <li>B</li>
</ul> 
```

有没有简单的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:40:48.360

这应该类似于`$('ul ul ul').remove()`，但您最好将其包含在例如带有 id 或 class 的 div 中，以便您可以进行本地清除`$('div.twolvls ul ul ul').remove()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:41:07.530

简单版：

```
$('ul ul ul').remove(); 
```

[jsFiddle 演示](http://jsfiddle.net/VKr38/1/)

我还写了一个小函数，可以让你指定一个根元素和一个级别：

```
function reduce(root, selector, level) {
    var use = root;
    for (var i = 0; i <= level; i++) {
        use += ' ' + selector;
    }
    $(use).remove();
} 
```

通过调用使用：

```
//if the lists are in an element with the id 'root', see Demo
reduce('#root', 'ul', 2); 
```

​jsFiddle [演示](http://jsfiddle.net/VKr38/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:41:09.037

如果您只是删除 3 级无序列表，则可以使用`$(ul ul ul).remove()`.

# javascript - 使用 Javascript 正则表达式从函数中提取注释

> ID：10046385
> 
> 赞同：3
> 
> 时间：2012-04-06T16:37:12.090
> 
> 标签：javascript, regex

我正在通过 httprequest 加载一个 js 文件，并尝试从结果文本中解析一个特定的字符串（在本例中为注释），但在使用正则表达式时遇到了问题。

```
function SampleTest() {
    this.test1 = function() {
        /* :DOM <div id="sampleDIV">You loaded the sample div</div> */
    };
    this.test2 = function() {
        /* :DOM <div>Second Div Loaded</div> */          
    }
} 
```

在另一个脚本中，我具有以下功能：

```
var getElementFromComment = function(obj) {

    function getHTML(method) {
        var httpRequest = new XMLHttpRequest();
        httpRequest.open('GET', 'SampleTest.js', false);
        httpRequest.send();
        var response = httpRequest.responseText;

        var re = new RegExp(method); //Not sure how to implement the regex
        var result = response.match(re);
        console.log(result);
    }

    for(var method in obj) {
        getHTML(method);
    }
}

var sampleTest = new SampleTest();
getElementFromComment(sampleTest); 
```

最终结果应该是根据传入的函数名称从 SampleTest 中的该注释中提取 HTML。在我的例子中，我将遍历所有函数并一个接一个地检索每个函数的 html 字符串。我假设正确的方法是：

1.  通过 httprequest 获取 Javascript 文件 - 已经完成
2.  在 SampleTest 中找到与传递给 getHTML 的名称匹配的函数，并通过正则表达式将整个函数作为字符串返回。
3.  使用另一个正则表达式从以 /* :DOM 开始并以 */ 结尾的函数字符串中提取字符串。即使为简单起见，我只使用单行，这应该可以是多行注释。
4.  最后，用 html 字符串替换所有的垃圾，例如 * 和 :DOM。

我不能简单地在文件中搜索评论，因为该文件可能包含多个函数，每个函数都有自己的评论。为了将这一切放在上下文中，我这样做是因为我希望能够动态加载 HTML 以进行 javascript 单元测试。该函数最终将遍历单元测试对象中的所有函数，获取 HTML，加载它，运行该函数，删除 HTML，然后转到下一个函数。

**更新** 感谢接受的答案海报的所有帮助，我能够让一切正常工作。但是，我确实必须进行一些调整，例如添加对多行注释的支持以及在事后替换所有垃圾字符，以便获得纯 HTML 字符串。我的更新代码如下。

```
function getHTML(method, str) {
        var commentMatch;
        var re = new RegExp(method+'\\s*=\\s*function[^}]+\\*/'); //Not sure how to implement the regex
        var fnMatch = str.match(re);
        if(fnMatch) {
            var fnEx = new RegExp('\/\*\s*:[^\s]+\s*(.*?|\n)\*\/', 'g');
            commentMatch = fnMatch[0].match(fnEx);
            var result = commentMatch[0].replace(/(\s*:DOM\s*)|(\*\/)|(\/\*)|(\*)/gm, '');
            result = result.replace(/^\s*/gm, '');
            if(commentMatch) {
                return result;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:52:38.253

如果您要做的是从 javascript 字符串变量中的一段 javascript 代码中提取注释字符串，您可以这样做：

```
var str = "function SampleTest() { \
    this.test = function() { \
        /* :DOM <div id=\"sampleDIV\">You loaded the sample div</div> */ \
    }; \
}";

var matches = str.match(/\/\*\s*:DOM\s*(.*?)\*\//);
if (matches) {
    alert(matches[1]);
}​ 
```

在这里工作演示：http: [//jsfiddle.net/jfriend00/hWCwA/](http://jsfiddle.net/jfriend00/hWCwA/)

* * *

如果 ":DOM" 部分并不总是相同，那么您可以使用稍微不同的版本，如下所示：

```
var str = "function SampleTest() { \
    this.test = function() { \
        /* :DOM <div id=\"sampleDIV\">You loaded the sample div</div> */ \
    }; \
}";

var matches = str.match(/\/\*\s*:[^\s]+\s*(.*?)\*\//);
if (matches) {
    alert(matches[1]);
}​ 
```

在这里工作演示：http: [//jsfiddle.net/jfriend00/qpF3k/](http://jsfiddle.net/jfriend00/qpF3k/)

* * *

好的，根据您的评论，这是另一个镜头。这将在函数名称之后找到下一个注释。它将停止查看第`}`一个函数，因此如果此函数没有评论，它不应进入下一个函数。

```
function findComment(funcName, str) {
    var commentMatch;
    var re = new RegExp("this\\." + funcName + "\\s*=\\s*function[^}]+\\*/");
    var funcMatch = str.match(re);
    if (funcMatch) {
        commentMatch = funcMatch[0].match(/\/\*\s*:[^\s]+\s*(.*?)\*\//);
        if (commentMatch) {
            return(commentMatch[1]);
        }
    }
    return null;
} 
```

# java - 在序列化之前的一整分钟内将数据存储在树形图输入中

> ID：10046389
> 
> 赞同：0
> 
> 时间：2012-04-06T16:37:36.230
> 
> 标签：java, time, treemap

```
 public class StoreMessage extends Thread implements Serializable{

        private static long startNanotime=System.nanoTime();
        private static int timeToRun = 60000; // 1 minute
        private static long startTime = System.currentTimeMillis();
        private static long runUntilMillis = System.currentTimeMillis() + timeToRun;
        public static Map <Long,Message> map1=Collections.synchronizedMap(new TreeMap<Long,Message>());
        public static void store(Message message)throws Exception{
        while (true) {
                long now = System.currentTimeMillis();

                if (now >= runUntilMillis) {
                   break;
              }
                long preciseTime=TimeUnit.MILLISECONDS.toNanos(now)+(System.nanoTime()-startNanotime);
                map1.put(preciseTime, message);
            }
         }

        public static byte[] returning()throws Exception
        { 
            map1.clear();
            return Serializer.serialize(map1);
         }

   } 
```

此代码使用 in 将多个命令行参数存储到树形图并对其进行序列化。我如何修改它，使其在一分钟内存储收到的所有参数。无论是一次多个参数还是一个间隔几秒的参数？一旦一分钟结束，树形图是被清除和序列化。一旦清除，从下一分钟开始接收数据。例如。假设我的用户在晚上 9.19 开始输入他的数据，他同时输入了多条消息。他在 9.19.38 秒时输入了更多信息。然后假设他在晚上 9.20 输入了更多数据，然后停止。我的代码所做的是，它让他在晚上 9.19 输入多条消息，将其存储到树形图中，然后在一分钟后对其进行序列化，并且不允许他在 9.19.38 秒输入数据，但他能够输入数据19.20 在已清除的地图上。我正在做的是，存储他在晚上 9.19 收到的所有数据，等到 19.20..由于用户在 19.19.38 pm 输入更多消息，将它们写入同一个地图，然后在 19.20 序列化并清除它，所以我可以在 19.20 开始存储消息。我要做什么改变...？请帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:02:12.683

有几种方法可以做到这一点。首先想到的是要有某种队列。向它扔内容。当最早的消息超过一分钟时，提取值得一分钟的时间将其扔到一个线程中以序列化它传递的任何内容。它不应该真正关心有多少。

据我所知，您正试图在一个“功能”中一次做太多事情。

# ruby-on-rails - 试图让 Cucumber 与 OmniAuth 一起工作

> ID：10046392
> 
> 赞同：0
> 
> 时间：2012-04-06T16:37:46.200
> 
> 标签：ruby-on-rails, cucumber, omniauth

因为这个，我一直在拔头发。

我的黄瓜步骤点击登录 facebook。我通过以下文章嘲笑了omniauth：

[http://pivotallabs.com/users/mgehard/blog/articles/1595-testing-omniauth-based-login-via-cucumber](http://pivotallabs.com/users/mgehard/blog/articles/1595-testing-omniauth-based-login-via-cucumber)

我的 omniauth_callbacks_controller.rb 有以下代码：

```
class Users::OmniauthCallbacksController < Devise::OmniauthCallbacksController

  def my_logger
    @@my_logger = Logger.new("#{Rails.root}/log/my.log")
  end

  def facebook
    @user = User.find_for_facebook_oauth(env["omniauth.auth"], current_user)

    if @user.persisted?
      flash[:notice] = I18n.t "devise.omniauth_callbacks.success", :kind => "Facebook"
      sign_in_and_redirect @user, :event => :authentication
    else
      session["devise.facebook_data"] = env["omniauth.auth"]
      redirect_to new_user_registration_url
    end
  end
end 
```

但是，我收到以下错误：

```
When I follow "facebook_login_button"            # features/step_definitions/basic.rb:14
      undefined method `extra' for #<Hash:0x007fda6d7cd950> (NoMethodError)
      ./app/models/user.rb:13:in `find_for_facebook_oauth'
      ./app/controllers/users/omniauth_callbacks_controller.rb:8:in `facebook'
      (eval):2:in `click_link'
      ./features/step_definitions/basic.rb:15:in `/^(?:|I )follow "([^"]*)"$/'
      features/homepage.feature:30:in `When I follow "facebook_login_button"' 
```

我读过的其他文章： [Devise 1.5 + Omniauth 1.0 + Facebook: undefined method `extra`](https://stackoverflow.com/questions/8556439/devise-1-5-omniauth-1-0-facebook-undefined-method-extra) - 问题：我认为这是使用 rspec 模拟omniauth - 不确定它是否可以应用于黄瓜

[https://github.com/intridea/omniauth/issues/558](https://github.com/intridea/omniauth/issues/558) --benjamintanweihao 的帖子有效-但它破解代码以与测试不同-建议git分支也不起作用

**编辑**：我的模型/user.rb

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :lockable, :timeoutable, :confirmable and :activatable
  devise :database_authenticatable, :registerable, 
         :recoverable, :rememberable, :trackable, :validatable

  devise :omniauthable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me

  def self.find_for_facebook_oauth(access_token, signed_in_resource=nil)
           data = access_token.extra.raw_info
            if user = User.where(:email => data.email).first
                user
            else 
                User.create!(:email => data.email, :password => Devise.friendly_token[0,20]) 
            end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T09:28:19.103

这应该是这个问题：[https](https://github.com/intridea/omniauth/issues/558) ://github.com/intridea/omniauth/issues/558 这不是你的错，这是omniauth中的一个小错误。您可以在生产和开发模式下使用 access_token.extra 等方法，但为了使其在测试模式下工作，您应该将其更改为 access_token["extra"]

# xcode - 在 Xcode 构建阶段运行脚本中设置全局环境变量

> ID：10046394
> 
> 赞同：13
> 
> 时间：2012-04-06T16:37:55.240
> 
> 标签：xcode, jenkins, environment-variables, jenkins-plugins, run-script

我正在使用 Jenkins 进行持续集成构建。我有很多工作都有很多相同的配置代码。我正在将这一切都提取到一个我想在构建前后运行的通用脚本文件中。

我一直无法弄清楚如何在该脚本中设置一些环境变量，以便 Xcode 构建命令和 Jenkins 构建都可以看到它们。

有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-07T20:54:38.227

不可能完全按照你的要求去做。一个进程不能改变另一个进程的环境变量。前、后和实际的构建步骤在不同的进程中运行。

但是您可以创建一个脚本来设置公共环境变量并在所有构建之间共享该脚本。

首先会调用你的 shell 来执行脚本中的命令，然后调用 xcodebuild：

```
# Note the dot in the beginning of the next line. It is not a typo.
. set_environment.sh
xcodebuild myawesomeapp.xcodeproj 
```

脚本可能如下所示：

```
export VARIABLE1=value1
export VARIABLE2=value2 
```

您的作业将如何共享脚本取决于您的环境和用例。你可以

*   将脚本放置在 Jenkins 主机上的某个知名位置，或者
*   如果您的所有作业共享相同的存储库，则将脚本放在版本控制的源代码树中，或者
*   将脚本放在它自己的存储库中，并进行 Jenkins 构建，将脚本存档为构建工件。然后，所有其他作业将使用 Copy Artifact 插件从脚本作业的工件中获取脚本的副本。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-09-27T21:45:50.017

从[Apple 的 Technical Q&A QA1067](http://developer.apple.com/library/mac/#/legacy/mac/library/qa/qa1067/_index.html)看来，如果您创建文件`/Users/YOU/.MacOSX/environment.plist`并使用所需的环境变量填充它，那么所有进程（由用户在其主目录中使用 environment.plist 文件启动）都将获取这些环境变量。您可能需要重新启动计算机（或只是注销并重新登录），然后新启动的进程才能获取变量。
[本文](http://blog.manbolo.com/2012/04/25/xcode-4-vs-me-running-custom-scripts-after-build)还声称 Xcode 也会将这些变量传递给构建阶段脚本。我还没有测试过，但下次我重新启动我的 MacBook 时，我会告诉你它是否有效。

来自*[http://developer.apple.com/library/mac/#/legacy/mac/library/qa/qa1067/_index.html](http://developer.apple.com/library/mac/#/legacy/mac/library/qa/qa1067/_index.html)*

> **`Q: How do I set environment for all processes launched by a specific user?`**
> 
> * * *
> 
> `A: It is actually a fairly simple process to set environment variables for processes launched by a specific user.`
> 
> 每次用户登录时，loginwindow 都会搜索一个特殊的环境文件。环境文件是：~/.MacOSX/environment.plist（注意区分大小写）。其中 '~' 是我们感兴趣的用户的主目录。您必须使用终端自己创建 .MacOSX 目录（通过键入 mkdir .MacOSX）。您还必须自己创建环境文件。环境文件实际上是 XML/plist 格式（确保将 .plist 扩展名添加到文件名的末尾，否则这将不起作用）。

# django - Django 1.4 表单发布强制方法到 GET

> ID：10046397
> 
> 赞同：1
> 
> 时间：2012-04-06T16:38:17.573
> 
> 标签：django, forms, post, get

当我提交一个具有 method="POST" 的表单时，处理它的视图正在获取方法 GET，我似乎无法让它成为文件上传所必需的 POST。只是罐装我现有的（一周前工作，在升级到 1.4 之前）并尝试使用从[https://docs.djangoproject.com/en/dev/topics/http/file-uploads/上传示例的表格](https://docs.djangoproject.com/en/dev/topics/http/file-uploads/)，你能看出这里出了什么问题吗？我尝试使用 Chrome Incognito 进行新会话，结果相同。当我不包含 method="POST" 时，它使用方法 GET 提交，并且这些字段包含在电子邮件的 request.GET 字典中。但是，当我更改为 POST/post 时，它仍然是 GET 方法，并且字段不在 request.POST 或 request.GET 字典中。Django 1.4 中是否存在导致此行为的错误？有什么我想念的吗？我试图做一个简单的例子来排除所有无关的潜在变量。

***简单的测试场景：***

网址.py：

```
url(r'^upload_test/+$', 'views.presentation.UploadTest'),
url(r'^uploaded_test/+$', 'views.presentation.UploadedTest'), 
```

意见/presentation.py：

```
def Notify(subject, body):
    """
        Send an email to <to_email>, from <from_email> with the
        subject and body supplied.
    """
    send_mail(subject, body, '<from_email>', ['<to_email>'], fail_silently=False)

def UploadTest(request):
    Notify("UploadTest", "METHOD: " + str(request.method) + """

    """ + str(request))
    return render_to_response('upload.htm', context_instance=RequestContext(request))

def UploadedTest(request):
    Notify("UploadedTest", "METHOD: " + str(request.method) + """

    """ + str(request) + """

    FILES:
    """ + str(request.FILES))
    return render_to_response('upload.htm', context_instance=RequestContext(request)) 
```

upload.htm（注意方法是POST，我也尝试了小写以防万一）：

```
<form
    id="upload_file_form"
    action="/uploaded_test"
    method="POST"
    enctype="multipart/form-data"
    target="_blank"
>
    {% csrf_token %}
    <input type="text" name="extra_field" value="extra post field" />
    <input type="file" name="upload_file" id="upload_file" />
    <input type="submit" name="upload" value="Submit" />
</form> 
```

***简单测试场景的结果***

我收到的电子邮件（注意第一个是预提交的表单，第二个是发布的表单页面）：

第一封电子邮件（主题“UploadTest”）：

```
METHOD: GET

<WSGIRequest
    path:/upload_test/,
    GET:<QueryDict: {}>,
    POST:<QueryDict: {}>,
    COOKIES:{
        'csrftoken': '...',
        'sessionid': '...'},
    META:{'CSRF_COOKIE': '...',
    'DOCUMENT_ROOT': '...',
    'GATEWAY_INTERFACE': 'CGI/1.1',
    'HTTPS': '1',
    'HTTP_ACCEPT': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'HTTP_ACCEPT_ENCODING': 'gzip, deflate',
    'HTTP_ACCEPT_LANGUAGE': 'en-us,en;q=0.5',
    'HTTP_CONNECTION': 'keep-alive',
    'HTTP_COOKIE': '... csrftoken=...; CFID=16005; CFTOKEN=...; sessionid=...',
    'HTTP_HOST': '...',
    'HTTP_USER_AGENT': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:11.0) Gecko/20100101 Firefox/11.0',
    'PATH_INFO': u'/upload_test/',
    'PATH_TRANSLATED': '...site.wsgi/upload_test/',
    'QUERY_STRING': '',
    'REMOTE_ADDR': '10.1.0.100',
    'REMOTE_PORT': '56037',
    'REQUEST_METHOD': 'GET',
    'REQUEST_URI': '/upload_test/',
    'SCRIPT_FILENAME': '...site.wsgi',
    'SCRIPT_NAME': u'',
    'SERVER_ADDR': '10.1.10.12',
    'SERVER_ADMIN': '...',
    'SERVER_NAME': '...',
    'SERVER_PORT': '443',
    'SERVER_PROTOCOL': 'HTTP/1.1',
    'SERVER_SIGNATURE': '',
    'SERVER_SOFTWARE': 'Apache',
    'SSL_TLS_SNI': '...',
    'mod_wsgi.application_group': '...|',
    'mod_wsgi.callable_object': 'application',
    'mod_wsgi.handler_script': '',
    'mod_wsgi.input_chunked': '0',
    'mod_wsgi.listener_host': '',
    'mod_wsgi.listener_port': '443',
    'mod_wsgi.process_group': '',
    'mod_wsgi.request_handler': 'wsgi-script',
    'mod_wsgi.script_reloading': '1',
    'mod_wsgi.version': (3, 3),
    'wsgi.errors': <mod_wsgi.Log object at 0x1962048>,
    'wsgi.file_wrapper': <built-in method file_wrapper of mod_wsgi.Adapter object at 0xb73d2770>,
    'wsgi.input': <mod_wsgi.Input object at 0x1962020>,
    'wsgi.multiprocess': True,
    'wsgi.multithread': True,
    'wsgi.run_once': False,
    'wsgi.url_scheme': 'https',
    'wsgi.version': (1, 1)}> 
```

第二封电子邮件（主题“UploadedTest”，方法仍然是“GET”，注意 HTTP_REFERER 正确，并且 request.FILES 存在，但为空。）：

```
METHOD: GET

<WSGIRequest
    path:/uploaded_test/,
    GET:<QueryDict: {}>,
    POST:<QueryDict: {}>,
    COOKIES:{
        'csrftoken': '...',
        'sessionid': '...'
    },
    META:{'CSRF_COOKIE': '...',
    'DOCUMENT_ROOT': '...',
    'GATEWAY_INTERFACE': 'CGI/1.1',
    'HTTPS': '1',
    'HTTP_ACCEPT': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'HTTP_ACCEPT_ENCODING': 'gzip, deflate',
    'HTTP_ACCEPT_LANGUAGE': 'en-us,en;q=0.5',
    'HTTP_CONNECTION': 'keep-alive',
    'HTTP_COOKIE': 'csrftoken=...; sessionid=...',
    'HTTP_HOST': '...',
    'HTTP_REFERER': '.../upload_test/',
    'HTTP_USER_AGENT': 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:11.0) Gecko/20100101 Firefox/11.0',
    'PATH_INFO': u'/uploaded_test/',
    'PATH_TRANSLATED': '...site.wsgi/uploaded_test/',
    'QUERY_STRING': '',
    'REMOTE_ADDR': '10.1.0.100',
    'REMOTE_PORT': '56040',
    'REQUEST_METHOD': 'GET',
    'REQUEST_URI': '/uploaded_test/',
    'SCRIPT_FILENAME': '...site.wsgi',
    'SCRIPT_NAME': u'',
    'SERVER_ADDR': '10.1.10.12',
    'SERVER_ADMIN': '...',
    'SERVER_NAME': '...',
    'SERVER_PORT': '443',
    'SERVER_PROTOCOL': 'HTTP/1.1',
    'SERVER_SIGNATURE': '',
    'SERVER_SOFTWARE': 'Apache',
    'SSL_TLS_SNI': '...',
    'mod_wsgi.application_group': '...|',
    'mod_wsgi.callable_object': 'application',
    'mod_wsgi.handler_script': '',
    'mod_wsgi.input_chunked': '0',
    'mod_wsgi.listener_host': '',
    'mod_wsgi.listener_port': '443',
    'mod_wsgi.process_group': '',
    'mod_wsgi.request_handler': 'wsgi-script',
    'mod_wsgi.script_reloading': '1',
    'mod_wsgi.version': (3, 3),
    'wsgi.errors': <mod_wsgi.Log object at 0x1956b88>,
    'wsgi.file_wrapper': <built-in method file_wrapper of mod_wsgi.Adapter object at 0x21cf0f8>,
    'wsgi.input': <mod_wsgi.Input object at 0x1961048>,
    'wsgi.multiprocess': True,
    'wsgi.multithread': True,
    'wsgi.run_once': False,
    'wsgi.url_scheme': 'https',
    'wsgi.version': (1, 1)}>

    FILES:
    <MultiValueDict: {}> 
```

值得怀疑，但我的 wsgi 文件或 Apache 站点指令中可能有问题。以下是这些，以防万一：

...wsgi：

```
import os
import sys

path = '/var'
if path not in sys.path:
   sys.path.append(path)

path = '/var/www'
if path not in sys.path:
   sys.path.append(path)

path = '/var/www/site'
if path not in sys.path:
   sys.path.append(path)

os.environ['DJANGO_SETTINGS_MODULE'] = 'site.settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

启用 Apache 站点的指令：

```
<VirtualHost 10.1.10.12:80>
    ServerName ...
    RewriteEngine on
    RewriteCond %{HTTPS} !=on
    RewriteRule ^/(.*) https://%{SERVER_NAME}/$1 [R,L]
</VirtualHost>

<Directory /var/www/site>
    RewriteEngine on
    RewriteCond 1 =1
    RewriteRule ^/(.*) https://%{SERVER_NAME}
</Directory>

<VirtualHost 10.1.10.12:443>
    ServerName ...
    DocumentRoot /var/www/site
    ServerAlias ...
    ErrorLog /var/log/apache2/site-error.log
    LogLevel warn
    CustomLog /var/log/apache2/site-access.log combined
    WSGIScriptAlias / /var/www/site/site.wsgi
    SSLEngine on
    SSLCertificateFile ...
    SSLCertificateKeyFile ...

    # Media serving, must specify which files to serve and not
    # hand their urls to the django framework.
    Alias /robots.txt .../robots.txt
    Alias /favicon.ico .../favicon.ico

    Alias /templates/ .../django_templates/
    Alias /static/ .../django_static/
    Alias /images/ .../django_static/images/

    <Directory /usr/local/lib/python2.6/dist-packages/django/contrib/admin/media/>
            Order deny,allow
            Allow from all
    </Directory>

    <Directory .../django_static/>
            Order deny,allow
            Allow from all
    </Directory>

    <Directory /usr/local/lib/python2.6/dist-packages/django/contrib/admin/media/js>
            Order allow,deny
            Allow from all
    </Directory>

    <Directory .../uploads/>
            Order allow,deny
            Allow from all
    </Directory>

    XSendFile on 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:26:35.413

也许我需要阅读更多关于 urls.py 或正则表达式的信息。我不小心将表单更改为`action="uploaded_test"`不带斜线的帖子，并收到一个 404 错误报告，其中 request.method 为“POST”（什么？！@#$*&）...？？？这意味着它必须与我的发布网址有关！我有它：

```
'^uploaded_test/+$' 
```

我将其更改为：

```
'^uploaded_test$' 
```

并验证该表格已发布到`action="/uploaded_test"`并且有效！我将 urls.py 更改为：

```
'^uploaded_test/$' 
```

并将表格更改为发布到`action="/uploaded_test/"`，它也有效！我的大多数 urls 条目中都有 /+，因此我可以接受 /loc 或 /loc/ 的许多条目。我想我现在会把它们改回来。我不知道这是一个错误还是我不了解正则表达式`/+`语法的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:15:15.237

您是否在表示层中尝试过 if-else 语句？例如`if request.method == 'POST':`，然后是您的其余代码。

# java - 基于 Java Tile 的游戏性能

> ID：10046401
> 
> 赞同：2
> 
> 时间：2012-04-06T16:38:37.510
> 
> 标签：java, 2d

我目前正在用 Java 试验基于 2D 瓷砖的横向滚动游戏，主要基于 David Brackeen 的“Java 开发游戏”中的代码和示例

目前地图文件的大小为 100x100 瓦片（每个瓦片为 64x64 像素）。我已经将系统配置为仅显示玩家可见的图块。Graphics 系统由 ScreenManager 类管理，该类返回当前 BufferStrategy 的图形对象，如下所示：

ScreenManager.java

```
private GraphicsDevice device;

...

/**
 * Gets the graphics context for the display. The
 * ScreenManager uses double buffering, so applications must 
 * call update() to show any graphics drawn.
 * <p>
 * The application must dispose of the graphics object.
 */
public Graphics2D getGraphics(){
    Window window = device.getFullScreenWindow();
    if(window != null){
        BufferStrategy strategy = window.getBufferStrategy();
        return (Graphics2D)strategy.getDrawGraphics();
    }
    else{
        return null;
    }
} 
```

在此 ScreenManager 中的图形在游戏循环中传递给 TreeRenderer 的绘制方法之后。

TreeMapRenderer.java

```
/**
    Draws the specified TileMap.
*/
public void draw(Graphics2D g, TileMap map,
    int screenWidth, int screenHeight, float fr)
{
    Sprite player = map.getPlayer();
    int mapWidth = tilesToPixels(map.getWidth());
    int mapHeight = tilesToPixels(map.getHeight());

    // get the scrolling position of the map
    // based on player's position
    int offsetX = screenWidth / 2 -
        Math.round(player.getX()) - TILE_SIZE;
    offsetX = Math.min(offsetX, 0);
    offsetX = Math.max(offsetX, screenWidth - mapWidth);

    // get the y offset to draw all sprites and tiles
    int offsetY = screenHeight /2 -
            Math.round(player.getY()) - TILE_SIZE;
    offsetY = Math.min(offsetY,0);
    offsetY = Math.max(offsetY, screenHeight - mapHeight);

    // draw the visible tiles
    int firstTileY = pixelsToTiles(-offsetY);
    int lastTileY = firstTileY + pixelsToTiles(screenHeight) +1;

    int firstTileX = pixelsToTiles(-offsetX);
    int lastTileX = firstTileX +
        pixelsToTiles(screenWidth) + 1;

    //HERE IS WHERE THE SYSTEM BOGS dOWN (checking ~280 tiles per iteration)
    for (int y=firstTileY; y<lastTileY; y++) {
        for (int x=firstTileX; x <= lastTileX; x++) {
            if(map.getTile(x, y) != null){
                Image image = map.getTile(x, y).getImage();
                if (image != null) {
                    g.drawImage(image,
                        tilesToPixels(x) + offsetX,
                        tilesToPixels(y) + offsetY,
                        null);
                }
            }
        }
    }

    // draw player
    g.drawImage(player.getImage(),
       Math.round(player.getX()) + offsetX,
       Math.round(player.getY()) + offsetY,
       null); 
```

该算法正确地为 X 和 Y 轴选择正确的 FROM 和 TO 值，从 10000 到 ~285 剔除所需的瓷砖。

我的问题是，即使这样，在渲染瓷砖时，游戏也只能以 8-10 FPS 左右的速度运行。如果我关闭平铺渲染，则系统以 80 FPS 运行（无事可做时易于快速运行）

您对如何加快此过程有任何想法吗？我希望看到至少在 30 FPS 左右的东西才能让它可以玩。

最后，虽然我愿意使用 3rd 方库来做到这一点，但我想在承认失败之前自己尝试实现这个逻辑。

**编辑：**
这里要求的是关于如何调用`Image image = map.getTile(x, y).getImage();`工作的额外信息。

这里的**地图**来自下面的TileMap类

TileMap.java

```
public class TileMap {

private Tile[][] tiles;
private LinkedList sprites;
private Sprite player;
private GraphicsConfiguration gc;

/**
    Creates a new TileMap with the specified width and
    height (in number of tiles) of the map.
*/
public TileMap(GraphicsConfiguration gc, int width, int height) {
    this.gc = gc;
    tiles = new Tile[width][height];
    overlayer = new Tile[width][height];
    sprites = new LinkedList();
}

/**
    Gets the width of this TileMap (number of tiles across).
*/
public int getWidth() {
    return tiles.length;
}

/**
    Gets the height of this TileMap (number of tiles down).
*/
public int getHeight() {
    return tiles[0].length;
}

/**
    Gets the tile at the specified location. Returns null if
    no tile is at the location or if the location is out of
    bounds.
*/
public Tile getTile(int x, int y) {
    if (x < 0 || x >= getWidth() ||
        y < 0 || y >= getHeight())
    {
        return null;
    }
    else {
        return tiles[x][y];
    }
}

/**
 * Helper method to set a tile. If blocking is not defined than it is set to false.
 * 
 * @param x
 * @param y
 * @param tile
 */
public void setTile(int x, int y,Image tile){
    this.setTile(x,y,tile,false);
}

/**
    Sets the tile at the specified location.
*/
public void setTile(int x, int y, Image tile, boolean blocking) {
    if(tiles[x][y] == null){
        Tile t = new Tile(gc, tile, blocking);
        tiles[x][y] = t;
    }
    else{
        tiles[x][y].addImage(tile);
        tiles[x][y].setBlocking(blocking);
    }
}

... 
```

这里的 Tile 是以下代码的一个实例。本质上，这个类只保存可以通过添加覆盖层来更新的图像，总是使用 gc.createCompatibleImage(w, h, Transparency.TRANSLUCENT); 和一个布尔值来判断它是否会阻止玩家。传入的镜像也是这样创建的。

Tile.java

```
public class Tile {
private Image image;
private boolean blocking = false;
private GraphicsConfiguration gc;

/**
 * Creates a new Tile to be used with a TileMap
 * @param image The base image for this Tile
 * @param blocking Will this tile allow the user to walk over/through
 */
public Tile(GraphicsConfiguration gc, Image image, boolean blocking){
    this.gc = gc;
    this.image = image;
    this.blocking = blocking;
}

public Tile(GraphicsConfiguration gc, Image image){
    this.gc = gc;
    this.image = image;
    this.blocking = false;
}

/**
Creates a duplicate of this animation. The list of frames
are shared between the two Animations, but each Animation
can be animated independently.
*/
public Object clone() {

    return new Tile(gc, image, blocking);
}

/**
 * Used to add an overlay to the existing tile
 * @param image2 The image to overlay
 */
public void addImage(Image image2){
    BufferedImage base = (BufferedImage)image;
    BufferedImage overlay = (BufferedImage)image2;

    // create the new image, canvas size is the max. of both image sizes
    int w = Math.max(base.getWidth(), overlay.getWidth());
    int h = Math.max(base.getHeight(), overlay.getHeight());
    //BufferedImage combined = new BufferedImage(w, h, BufferedImage.TYPE_INT_ARGB);
    BufferedImage combined = gc.createCompatibleImage(w, h, Transparency.TRANSLUCENT);
    // paint both images, preserving the alpha channels
    Graphics g = combined.getGraphics();
    g.drawImage(image, 0, 0, null);
    g.drawImage(overlay, 0, 0, null);

    this.image = (Image)combined;
}

public boolean isBlocking(){
    return this.blocking;
}

public void setBlocking(boolean blocking){
    this.blocking = blocking;
}

public Image getImage(){
    return this.image;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-22T18:24:52.430

我会使用像素渲染引擎（谷歌它；D）

基本上你所做的，它有一个巨大的整数数组，对应于你正在绘制的图像。

基本上，每个图块都有一个表示其像素的整数数组。当您渲染该图块时，您将图块数组“复制”（比这稍微复杂一些）到大数组:)

然后，一旦您完成将所有内容渲染到主阵列，您就可以在屏幕上绘制它。

这样，你每次画东西时只处理整数而不是整张图片。这使它更快。

我使用 MrDeathJockey 的（youtube）教程学习了这一点，并将它们与 DesignsbyZephyr（也是 youtube）结合起来。虽然我不推荐使用他的技术（他只使用 4 种颜色和 8 位图形，与 deadJockey 的教程一样，您可以自定义图像的大小，甚至可以拥有多个不同分辨率的精灵表（对字体有用）

然而，我确实使用了一些偏移的东西（让屏幕移动而不是播放器）和 Zephyr 的 InputHandler :)

希望这可以帮助！-Camodude009

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T01:33:47.243

创建透明图像（非半透明），因为半透明图像需要更高的 ram 并且存储在系统内存中而不是标准的 java 堆中。创建半透明图像需要多次本机调用来访问本机系统内存。使用 BufferedImages 而不是 Image。您可以随时将 BufferedImage 转换为 Image。

# sql - Postgres 对象关系数据库似乎无法正常运行

> ID：10046402
> 
> 赞同：0
> 
> 时间：2012-04-06T16:38:55.017
> 
> 标签：sql, postgresql, object-relational-model

我已经定义了我的表：

```
create table device (
id serial primary key,
manufacturerid integer references manufacturer(id) on delete restrict,
model text,
price real,
usagepros text,
usagecons text
);

create table robot (
numaxes integer,
capacity real,
reach real,
accuracy real,
installmethodid integer references installmethod(id) on delete restrict,
mass real
) inherits (device);

create table robotComplex(
id serial primary key,
name text
);

create table robotComplexDevice(
id serial primary key,
deviceId integer references device(id) on delete restrict,
robotcomplexid integer references robotcomplex(id) on delete cascade
);

etc... 
```

运行 sql 命令时，我得到以下信息：

```
 id  | manufacturerid | model | price | usagepros | usagecons | numaxes | capacity | reach | accuracy | installmethodid | mass  
-----+----------------+-------+-------+-----------+-----------+---------+----------+-------+----------+-----------------+-------
 159 |            117 | Robot | 100.3 | OK        | NoOK      |       6 |     15.3 |  15.4 |  76.1234 |              45 | 100.1

> select * from device; 
 id  | manufacturerid | model | price | usagepros | usagecons 
-----+----------------+-------+-------+-----------+-----------
 159 |            117 | Robot | 100.3 | OK        | NoOK

> select * from robotcomplex;
 id |     name     
----+--------------
 27 | Complex

> insert into robotcomplexdevice (deviceid, robotcomplexid) values (159, 27);
ERROR:  insert or update on table "robotcomplexdevice" violates foreign key constraint        "robotcomplexdevice_deviceid_fkey"
DETAIL:  Key (deviceid)=(159) is not present in table "device". 
```

出于某种原因，即使我已经定义了“机器人”表来继承“设备”表，我也无法引用它。也许我没有正确获得对象关系数据库模型。但是，如果您不能引用这些表，那么对象关系模型的意义何在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:52:15.587

这是记录在案的行为：

[http://www.postgresql.org/docs/current/static/ddl-inherit.html#DDL-INHERIT-CAVEATS](http://www.postgresql.org/docs/current/static/ddl-inherit.html#DDL-INHERIT-CAVEATS)

# c# - 无法加载符号 Visual Studio 2010

> ID：10046404
> 
> 赞同：1
> 
> 时间：2012-04-06T16:39:33.103
> 
> 标签：c#, asp.net-mvc, visual-studio, visual-studio-2010, asp.net-mvc-3

# 解决

问题在于 Visual Studio 是如何运行网站的。我愚蠢地错误配置了我的属性；我没有`Use Local IIS Web Server`像我应该的那样设置。

* * *

我越来越害怕了

> 当前不会命中断点。没有为此文档加载任何符号。

在尝试调试我的 asp.net MVC 3 应用程序时。按照[这里](http://geekswithblogs.net/dbutscher/archive/2007/06/26/113472.aspx)的建议，我按 F5 进行调试，转到`debug -> windows -> modules`，但我网站的 dll*甚至没有出现*。我应该看到 a `Services.Web.UI.Mvc.dll`，但我没有。似乎*没有*加载内置 .net 程序集之外的任何内容。

有谁知道我可以做些什么来加载我网站的符号？

![在此处输入图像描述](../Images/28bee0cd56e8962e34bab2f4d7a1ab1e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:48:34.043

问题在于 Visual Studio 是如何运行网站的。我愚蠢地错误配置了我的属性；我没有像我应该设置的那样设置使用本地 IIS Web 服务器。

# nlp - 使用自然语言处理进行逻辑谬误检测和/或识别

> ID：10046407
> 
> 赞同：14
> 
> 时间：2012-04-06T16:39:57.383
> 
> 标签：nlp, logic, machine-learning, sentiment-analysis

是否存在用于检测文本中有缺陷的逻辑参数的软件包或方法？

我希望有一些东西适用于不是在学术环境中编写的文本（例如逻辑课）。这可能是一个延伸，但我想要一些可以识别逻辑试图在哪里使用并识别逻辑错误的东西。一个可能的用途是在社论文章中标记错误。

我不需要任何抛光的东西。我也不介意开发一些东西，所以我现在真的在寻找野外的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-07T03:09:25.217

这是一个难题，因为您必须将自然语言映射到某种逻辑表示，并处理过程中的歧义。

[Attempto Project](http://attempto.ifi.uzh.ch/site/)对您来说可能很有趣。它有几个[工具](http://attempto.ifi.uzh.ch/site/tools/)，您可以在线尝试。特别是，[RACE](http://attempto.ifi.uzh.ch/race/)可能正在做您想做的事情。它检查给定断言的一致性。但这里更大的问题是将它们转换为逻辑形式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-07T01:30:54.840

对于逻辑公理的本体，[OpenCyc](http://opencyc.org)和商业完整的 Cyc 本体可能也值得研究。CycML 用作对逻辑断言进行建模的语言，并且 Cyc 引擎能够进行逻辑推理。[OpenCyc](http://opencyc.org)的源代码可以在[OpenCyc SourceForge 项目](http://sourceforge.net/projects/opencyc/)中找到。[Cyc Wikipedia 页面](http://en.wikipedia.org/wiki/Cyc)也包含大量信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-11T04:10:09.917

是的，这是一个非常讨厌的问题。我建议您尝试专注于一个狭窄的领域。例如，如果您正在寻找癌症确定中的逻辑错误，您必须关注哪种类型的癌症以及您要解决的问题，例如：正确的治疗计划、正确的观察、正确的程序、正确的分期确定等。然后，您必须找到该特定癌症的分类或本体，例如：Medline。因此，例如，您可能必须只关注肺癌，然后只关注肺癌类型的一个子集，并且只关注表明肺癌的观察结果。然后，您将识别您的语料库、知识树、实体关系，然后担心否定检测、假设和主题检测。如果医疗保健不能让你的船浮起来，

# html - 如何使用变量将查询的 html 输出保存到文本文件？

> ID：10046409
> 
> 赞同：1
> 
> 时间：2012-04-06T16:40:10.240
> 
> 标签：html, sql, sql-server, tsql

我有一个更复杂的查询，但基本上为我创建了一个 HTML 页面。

```
DECLARE @indSubject varchar(7)
SET @indSubject = '61-0036'

--  LOTS of query stuff here that makes a page.  For simplicity 
--  just use this:

SELECT '<html><body>' + @indSubject + '</body></html>' 
```

我想做两件事：

1.  让 SQL Server 将其保存在我的机器上，名称为 @indSubject.html（例如 C:\TEMP\HTMLOUTPUT\61-0036.html）
2.  能够将不同的值传递给@indSubject（例如91-0003）。命令行式的东西？

我可以用 BCP 做到这一点吗？其他方式？

请注意，这是我所有的个人资料，并没有部署在 Web 服务器上，所以我不必太担心安全性、SQL 注入等（至少我希望我不要！）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:46:50.767

您可以使用[SQLCMD](http://msdn.microsoft.com/en-us/library/ms162773.aspx)相当轻松地完成此操作。

如果将现有查询保存为 .sql 文件，则可以使用 SQLCMD 执行此操作。

此外，SQLCMD 将允许您在 .sql 文件`${indSubject}`中指定一个变量，然后您可以从命令行提供该变量。

最后，使用`-o`开关，您可以将结果直接输出到文件中，并且可以使用以下环境设置隐藏结果集中的标头：

`:SETVAR SQLCMDHEADERS -1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T19:06:58.967

为了我的理智（和迈克尔的），这里是似乎工作的代码：

```
 :SETVAR SQLCMDHEADERS -1
    DECLARE @indSubject varchar(7)
    SET @indSubject='$(indSubject)'

    --  LOTS of query stuff here that makes a page.  For simplicity 
    --  just use this:

    SELECT '<html><body>' + @indSubject + '</body></html>' 
```

使用该命令时`sqlcmd -E -S(Local)\SQLExpress -v indSubject = "61-0022" -dmyDatabase -y 0 -iC:\temp\test4.sql -oC:\temp\out.html`，文件 out.html 如下所示：

```
 <html><body>61-0022</body></html>
    (1 rows affected) 
```

# linux - 使用 RMAIL 发送电子邮件

> ID：10046410
> 
> 赞同：0
> 
> 时间：2012-04-06T16:40:13.873
> 
> 标签：linux, unix, command-line, sendmail

我正在努力寻找提供如何在 rmail 应用程序中输入消息的清晰示例的文档。

我需要指定电子邮件的发件人、电子邮件的主题，然后在后面加上一些内容。这是一个小型的学校作业，我们在假想的工厂车间里从假想的机器中传递“状态更新”。

这是我找到的最接近的，但不是很清楚：[http ://www.s-gms.ms.edus.si/cgi-bin/man-cgi?rmail+1](http://www.s-gms.ms.edus.si/cgi-bin/man-cgi?rmail+1)

谁能给我一个例子，说明我将如何发送看起来像这样的消息？（显然不包括评论......）

> /* 头文件 */
> 
> 来自：something@something.com
> 
> 主题：机器 5 的状态更新
> 
> /* 消息内容 */
> 
> 机器编号：7
> 
> 报告状态：机器离线（状态 6）
> 
> 状态生效：2012-06-02 12:30:23

我在我的应用程序中通过软件控制的管道打开 rmail 没有问题，我只是不确定如何格式化我提供给它的数据，因为我在网上找不到任何示例。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:55:22.057

您可能对在大多数现代 Unix 上使用 /usr/bin/mail 感兴趣，而不是 rmail。

您应该阅读手册页，但一般情况下，使用“-s”标志设置邮件主题并在标准输入上输入邮件内容就足够了。无需设置 From: 行，因为系统会为您执行此操作（并且在一般情况下，系统不会让您指定任意地址以防止伪造。）

# vb.net - 在 VB.NET 中使用条件来计数

> ID：10046414
> 
> 赞同：-2
> 
> 时间：2012-04-06T16:40:28.303
> 
> 标签：vb.net

我正在 Windows 窗体 Visual Basic 中运行一个程序，我试图制作多个计数器

这是我的代码：

```
If txtAnswer.Text = nMathSum Then
        nCount = nCount + 1
        lblCorrect.Text = nCount
    ElseIf txtAnswer.Text <> nMathSum Then
        nIount = nIount + 1
        lblIncorrect.Text = nIount
    End If

    If txtAnswer.Text = nMathDiff Then
        nCount = nCount + 1
        lblCorrect.Text = nCount
    ElseIf txtAnswer.Text <> nMathDiff Then
        nIcount = nIcount + 1
        lblIncorrect.Text = nIout
    End If 
```

它假设计算我正确和错误回答的次数

总和计数器工作正常，但差值计数器有问题。当我输入正确答案时，它会转到不正确的标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:45:53.497

您在 seconf 中的`nIount`as拼写错误 也与最后一行一样。将其更正为：`nIcount``Elseif``nIout`

```
ElseIf txtAnswer.Text <> nMathDiff Then 
    nIount = nIount + 1 
    lblIncorrect.Text = nIount 
End If 
```

这是假设第一次出现 ( `nIount`) 是正确的拼写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:43:07.667

txtAnswer 不太可能同时匹配总和和差值。因此，在您的代码中，您将始终至少有一个不正确。

您是否有某种方法可以知道 txtAnswer 是否应该匹配总和或差 - 如果是，请在检查答案之前检查一下。

**编辑（解释我的意思）：**像

```
If operation = "+" Then
    If txtAnswer.Text = nMathSum Then
        nCount = nCount + 1
        lblCorrect.Text = nCount
    ElseIf txtAnswer.Text <> nMathSum Then
        nIcount = nIcount + 1       ' corrected this line to use nIcount
        lblIncorrect.Text = nIcount ' corrected this line to use nIcount
    End If
Else
    If txtAnswer.Text = nMathDiff Then
        nCount = nCount + 1
        lblCorrect.Text = nCount
    ElseIf txtAnswer.Text <> nMathDiff Then
        nIcount = nIcount + 1
        lblIncorrect.Text = nIcount ' corrected this line too
    End If
End If 
```

其中 operation 是设置为“+”或“-”的变量，具体取决于用户应该提供总和还是差值。

# php - Jquery 对话框和 Ajax 问题

> ID：10046415
> 
> 赞同：1
> 
> 时间：2012-04-06T16:40:45.250
> 
> 标签：php, jquery, ajax

大家好，首先感谢您所做的一切，这是问题：

每次点击我与 jquery 链接的提交按钮尝试发出 AJAX 请求以在模态模式下打开对话框时 jquery 不会执行，我一定做错了什么但似乎找不到它，在这里是代码：

HTML

```
<html xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<head>      
    <title>Administrador :: Estructuras M&amp;M ::</title>
    <link href="../CSS/admin.css" rel="stylesheet" type="text/css"/>
    <link href="../CSS/jquery-ui.css" rel="stylesheet" type="text/css"/>
    <script src="../js/jquery-1.7.2.js" type="text/javascript"></script>
    <script src="../js/jquery-ui.js" type="text/javascript"></script>
</head>
<body>
    <div class="container">
        <div class="login">
            <form method="post" id="ingreso" name="ingreso">
                <div><label class="etiqueta">Usuario:</label><input type="text"      maxlength="15" id="usuario" name="usuario" /></div>
                <div><label class="etiqueta">Clave:</label><input type="password" maxlength="15" id="clave" name="clave" /></div>
                <div><input type="submit" value="Aceptar" id="verificar" /></div>
            </form>
        </div>
    </div>
</body> 
```

这是我试图执行的 Jquery：

```
 $('#verificar').click(function()
        {
            var xmlhttp;

                try
                {
                    xmlhttp = new XMLHttpRequest();
                }
                catch(e)
                {
                    try
                    {
                        xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
                    }
                    catch(e)
                    {
                        try
                        {
                            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                        }
                        catch(e)
                        {
                            alert("Su navegador no soporta AJAX, por favor pruebe con otro.");
                            return false;
                        }                        
                    }
                }
                if(xmlhttp)
                {
                    var dialog = $("<div id='modal' class='cargando' title='Verificando Usuario por favor espere.'><span>Verificando la existencia del usuario por favor espere.</span></div>").appendTo('body');

                    dialog.dialog(
                    {
                        height: auto,
                        modal: true,
                        buttons: { "Ok": function() { $(this).dialog("close");} },
                        draggable: false,
                        resizable: false,
                        close: function(event, ui) 
                        {
                            dialog.remove();
                        }
                    });
                }            
        }); 
```

我真的希望让它正常工作，所以我愿意接受所有类型的建议，谢谢。

哦，在我打开模式后，我应该将 ajax 信息发送到 PHP 页面以验证用户是否存在，只是还没有完成，因为我先对其进行了测试，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:50:43.253

```
$('input.verificar') 
```

是一个选择器，它正在寻找具有“verificar”*类的输入。*你想要的是找到一个*id*为“verificar”的对象。

```
$('#verificar') 
```

# java - Maven Eclipse Tomcat ClassNotFoundException

> ID：10046421
> 
> 赞同：0
> 
> 时间：2012-04-06T16:41:04.160
> 
> 标签：java, eclipse, tomcat, servlets, maven

我使用以下 Maven 命令创建了 Web 应用测试项目：

```
mvn archetype:generate -DgroupId=com.vanilla.cache -DartifactId=TestProject -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false 
```

之后我将此项目转换为 Eclipse

```
mvn eclipse:eclipse -Dwtpversion=2.0 
```

之后，我在 Eclipse 中创建了名为 com.vanilla.test.TestServlet 的新 Servet，并且当我使用 Tomcat 7.0 运行它时。我收到以下错误。

```
SEVERE: Allocate exception for servlet Test
java.lang.ClassNotFoundException: com.vanilla.test.TestServlet
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1678)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1523)
    at org.apache.catalina.core.DefaultInstanceManager.loadClass(DefaultInstanceManager.java:525)
    at org.apache.catalina.core.DefaultInstanceManager.loadClassMaybePrivileged(DefaultInstanceManager.java:507)
    at org.apache.catalina.core.DefaultInstanceManager.newInstance(DefaultInstanceManager.java:126)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1099)
    at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:836)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:135)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:405)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:964)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:304)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679) 
```

请帮忙。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T17:42:45.810

我解决了这个问题。

项目 -> 属性 -> Java 构建路径 -> 源代码。

我添加了 /src 并重新启动了 tomcat。

# jquery - 切换和 jQuery UI 按钮

> ID：10046429
> 
> 赞同：0
> 
> 时间：2012-04-06T16:41:45.680
> 
> 标签：jquery, jquery-ui

我想让我的用户选择使用两种编辑器之一：

*   HTML 编辑器
*   MCE 编辑器

在选择编辑器并使其工作时，我可以处理这个编码。但是我在 UI 方面遇到了问题。起初我给用户一个复选框，但现在我想一个更好的方法是使用 jQuery UI 按钮并切换它以显示文本“HTML 编辑器”或“MCE 编辑器”。有没有人编写过类似的代码？我查看了按钮的文档，但我仍然不清楚如何在两种状态之间切换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:49:27.537

只需确保您`toggleButton`的 HTML 中有一个 id 的按钮。

```
var isMCE = false;

$("#toggleButton").click(function() {
    if(isMCE) {
        // change your editor back to normal here
        isMCE = false;
    } else {
        // change your editor to MCE here
        isMCE = true;
    }
}); 
```

`toggle()`，根据[这里](http://api.jquery.com/toggle/)，只是切换元素的可见性，不适合您的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T10:07:44.737

```
 $( "#controls #html" ).button({
                text: 'Edit',
                })
                .click(function() {
                     var btn = $("#controls #html");
                     btn.button('option', 'text', 'MCE');
                     if (btn[0].checked) {
                           btn.button('option', 'text', 'HTML');
                           doMCE();
                     } else { 
                           btn.button('option', 'text', 'MCE');
                           doHTML();
                     }
                });

    <div id="controls">
         <input type="checkbox" id="html" name="html"><label for="html"></label>
    </div> 
```

# android - GoogleTV 上的 MonoDroid 4.0.6+？

> ID：10046433
> 
> 赞同：1
> 
> 时间：2012-04-06T16:42:20.017
> 
> 标签：android, mono, xamarin.android, google-tv

我一直试图找出 MonoDroid 是否可以在 GoogleTV 上运行，因为它使用的是 Intel Atom x86 CPU 而不是 ARM CPU。

我遇到了:: [http://docs.xamarin.com/android/Releases/Mono_For_Android_4/Mono_For_Android_4.0.6](http://docs.xamarin.com/android/Releases/Mono_For_Android_4/Mono_For_Android_4.0.6)

发行说明引用：“它还包括 x86 对 Android 完整版 Mono（非试用版）的支持”。

此声明是否意味着 MonoDroid 现在将支持 GoogleTV？

如果是这样，我正在购买软件...

注意：如果它在模拟器中运行，这不是问题，只要 MonoDroid 可以在本机硬件上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:11:01.620

理论上应该是这样，但还没有经过测试。即将发布的版本将为试用版添加 x86 仿真器支持。或者您可以购买、试用，如果不起作用，则可以享受全额退款。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T22:18:19.990

我不相信它会。我认为 Mono 的使用需要 NDK，而 Google TV 没有。

# javascript - CUFON 不适用于超大滑块

> ID：10046434
> 
> 赞同：0
> 
> 时间：2012-04-06T16:42:20.517
> 
> 标签：javascript, jquery, html, css, cufon

我正在使用超大的 jQuery 滑块插件，它在单击 NAV 锚点时更改一个

超大 jQuery 插件:::::::::>

```
 <script type="text/javascript">
        jQuery(function($){
            $.supersized({
                // Functionality
                slide_interval      :   8000,       // Length between transitions
                transition          :   1,          // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
                transition_speed    :   1300,       // Speed of transition
                // Components                           
                slide_links         :   'blank',    // Individual links for each slide (Options: false, 'num', 'name', 'blank')
                slides              :   [           // Slideshow Images
                                                    {image : './lib/images/photos/image1.jpg'},
                                                    {image : './lib/images/photos/image2.jpg'},
                                                    {image : './lib/images/photos/image3.jpg'},
                                                    {image : './lib/images/photos/image4.jpg'}
                                            ],

                bullet: "bullet",
                bullet_active: "active",
                bullet_main: "bullet-main",
                bullet_main_active: "active",
                bullet_main_second: "bullet-main-second1",
                bullet_main_second_active: "active2"
            });
        });
    </script> 
```

bullet_main_second_active：“active2”是活动锚。

现在的问题是 CUFON 在过渡后无法正常工作.. 有一个错误......它没有停用以前的锚。将鼠标悬停在上一个锚上后，它会将颜色更改为默认值...滑块插件在默认字体系列上运行良好....它的 cufon 错误

```
<script type="text/javascript">  
    Cufon('.block-right a h1');
    Cufon.replace('#nav li a');
    Cufon.replace('#rightcaption a', {
        hover: {
            color: '#f04037'
        }
        });
        Cufon.replace('ul.tabNavigation li a', {
        hover: {
            color: '#FFF'
        }
        });
</script> 
```

CSS::::::::::::::>

```
#rightcaption {
    float:right;
    padding-top:25%;
    font-size:14px;
    color:#b5b5b5;
    margin-right:40px;}
#rightcaption a {
    background:url(../images/bullet1.png) no-repeat right 8px;
    height:8px;
    color:#b5b5b5;
    font-size:14px;
    margin:0 0 5px 0;
    padding:4px 40px 13px 13px;
    display:block;
    text-align:right;}
a.active2 {
    background:url(../images/bullet2.png) no-repeat right 8px #FFF !important;
    margin:0 20px 5px 0;
    color:#f04037;
    font-size:14px;
    padding:4px 40px 13px 13px !important;
    display:block;} 
```

img::::::::::::::::> [http://i.stack.imgur.com/lyjvw.png](http://i.stack.imgur.com/lyjvw.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:12:35.877

如果我真的理解你的问题，那么我会说 cuffon 有一个方法必须在任何元素被更改后（在任何转换之后）被使用/调用才能生效，我认为你错过了那个，所以你可以在之后调用它您的过渡已完成

```
Cufon.refresh(); //Refresh elements that are using coffon font to apply new style 
```

我认为，您必须以某种方式在每次转换后调用回调函数。这是[**关于袖口**](https://stackoverflow.com/questions/9906679/how-reload-refresh-styles-of-an-element-using-cufon-font-using-jquery/9907126#9907126)的 SO的答案，这里是[**关于超大**](https://stackoverflow.com/questions/6904154/how-do-i-use-this-api-of-supersized-jquery-plugin)的 SO 的答案（由插件的作者回答），这些可能会有所帮助。

# java - 如何通过 Java 管理 Tomcat

> ID：10046436
> 
> 赞同：1
> 
> 时间：2012-04-06T16:42:38.300
> 
> 标签：java, tomcat

我正在寻找一种通过java以编程方式管理tomcat（在本地主机上）的方法。我想启动/停止 tomcat 并部署 WAR。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:01:27.730

您可以运行嵌入在您的应用程序中的 Tomcat。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T18:57:45.020

要以编程方式管理 tomcat，您可能需要了解 JMX 和 Tomcat 的内置 MBean 功能。

本质上，您可以编写自己的基于 Java 的 JMX 客户端通过 RMI 与 MBean 通信，或者您可以利用 Manager App 中的 JMX Http 代理并使用普通的旧 http 请求来编写脚本和管理 tomcat 实例。

有关 JMX 和 Tomcat 6 的良好参考： [http ://www.datadisk.co.uk/html_docs/java_app/tomcat6/tomcat6_jmx.htm](http://www.datadisk.co.uk/html_docs/java_app/tomcat6/tomcat6_jmx.htm)

Manager App和JMX Http Proxy的一个很好的参考：http: [//tomcat.apache.org/tomcat-6.0-doc/manager-howto.html#JMX_Set_command](http://tomcat.apache.org/tomcat-6.0-doc/manager-howto.html#JMX_Set_command)

您应该能够相当轻松地部署和取消部署 WAR。

我不认为有一个现有的 MBean 可以让你关闭 tomcat，但是你自己实现一个并调用 System.exit(); 相当容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:50:59.947

通过java启动/停止tomcat的方法是在bootstrap.jar（使用类Runtime）上调用execute，示例参数：-Dcatalina.home=c:/tomcat/

看ant如何执行tomcat start stop的示例代码：

[http://ptrthomas.wordpress.com/2006/03/25/how-to-start-and-stop-tomcat-from-ant](http://ptrthomas.wordpress.com/2006/03/25/how-to-start-and-stop-tomcat-from-ant)

查看如何从 java 执行外部程序的示例代码： [http ://www.linglom.com/2007/06/06/how-to-run-command-line-or-execute-external-application-from-java/](http://www.linglom.com/2007/06/06/how-to-run-command-line-or-execute-external-application-from-java/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T17:16:28.553

您可以使用 java Runtime 类来调用 bat 文件。确保运行 java 进程的用户有权启动和停止 tomcat。

```
try{
Runtime.getRuntime().exec("c:/program files/tomcat/bin/startup.bat");
} catch(IOException e) {System.out.println("exception");} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T18:20:49.027

您可以使用[tomcat manager](http://tomcat.apache.org/tomcat-5.5-doc/manager-howto.html)，或查看其源代码以了解 manager 如何处理部署操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-13T17:13:47.277

您可以重新启动单个 Tomcat 连接器，即端口重新启动，如您的应用程序正在运行的 8843。需要这样做的一种情况是当您通过 API 获取签名证书或修改您的信任库时。

这是我在添加/删除证书后用来重新启动 tomcat 连接器的完整代码/方法。

```
 public void refreshTrustStore() throws Exception 
    {
        try 
        {   
            //following line need to be replaced based on where you get your port. It may be passed in as argument
            String httpsPort = configurationManager.getHttpsPort();
            String objectString = "*:type=Connector,port=" + httpsPort + ",*";

            final ObjectName objectNameQuery = new ObjectName(objectString); 

            for (final MBeanServer server : MBeanServerFactory.findMBeanServer(null))
            {
                if (server.queryNames(objectNameQuery, null).size() > 0)
                {
                    MBeanServer mbeanServer = server;
                    ObjectName objectName = (ObjectName) server.queryNames(objectNameQuery, null).toArray()[0];

                    mbeanServer.invoke(objectName, "stop", null, null);

                    // Polling sleep to reduce delay to safe minimum.
                    // Use currentTimeMillis() over nanoTime() to avoid issues
                    // with migrating threads across sleep() calls.
                    long start = System.currentTimeMillis();
                    // Maximum of 6 seconds, 3x time required on an idle system.
                    long max_duration = 6000L;
                    long duration = 0L;
                    do
                    {
                        try
                        {
                            Thread.sleep(100);
                        }
                        catch (InterruptedException e)
                        {
                            Thread.currentThread().interrupt();
                        } 

                        duration = (System.currentTimeMillis() - start);
                    } while (duration < max_duration &&
                    server.queryNames(objectNameQuery, null).size() > 0);

              // Use below to get more accurate metrics.
            String message = "TrustStoreManager TrustStore Stop: took " + duration + "milliseconds";
            logger.information(message);

            mbeanServer.invoke(objectName, "start", null, null);

            break;
        }
    }
} 
catch (Exception exception) 
{
    //Log and throw exception
    throw exception
} 
```

}

# java - 如何用java编写程序检查语句的SQL数据库

> ID：10046437
> 
> 赞同：-4
> 
> 时间：2012-04-06T16:42:43.390
> 
> 标签：java, sql

> **可能重复：**
> [有任何验证 SQL 语法的 Java 库吗？](https://stackoverflow.com/questions/141499/any-java-libraries-out-there-that-validate-sql-syntax)

如何用java编写程序来检查语法的SQL语句是真是假！
例如：当我在运行时编写语句时

```
SELECT * FROM Table table WHERE column =2 , 
SELECT * FROM Product AS p ORDERED BY name ASC, 
```

或任何其他 SQL 语句。如果语法与上面相同，则打印语法为真，否则打印语法为假。请帮助亲爱的程序员。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T16:47:05.803

这个问题以前有人[问过](https://stackoverflow.com/questions/141499/any-java-libraries-out-there-that-validate-sql-syntax)。简短的回答，不。SQL 变体与 SQL 数据库一样多。

# javascript - 'char' 关键字是做什么用的？

> ID：10046439
> 
> 赞同：10
> 
> 时间：2012-04-06T16:43:04.437
> 
> 标签：javascript, char, keyword

JavaScript 中使用的保留关键字是什么`char`（因为不需要类型声明），尤其是使用它的正确语法是什么（有人能给我一个适当的完整示例）吗？

因为写作 `char c;`抛出一个解释错误说`missing ; before statement`，就在`c`?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-06T16:45:28.877

JavaScript中有很多保留关键字是为“未来”使用而保留的。它们不一定有当前用途和描述。

MDN 确实在此处列出了其中一些具有这种特殊“未来使用”状态的内容：[https](https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words) ://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words （感谢[DCoder](https://stackoverflow.com/users/1233508/dcoder)），您还可以阅读该文章：

> 以下是 ECMAScript 规范保留的未来关键字。它们目前没有特殊功能，但将来可能会出现，因此它们不能用作标识符。这些关键字不能在严格或非严格模式下使用。

进一步扩展为什么它在某些地方被视为保留关键字而在某些地方却不是。ECMAScript v3 规范确实包含`char`保留关键字，但 ECMAScript v5 规范（开始成为最常见的规范）不包含它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T16:46:21.683

**更新：**

同样正如@HoLyVieR 指出并在下面的评论中显示的那样，`char`关键字保留供将来使用。[有关更多信息，请参阅此链接](http://en.wikibooks.org/wiki/JavaScript/Reserved_Words)（感谢 @djmadscribbler）。

* * *

[`char`JavaScript中没有保留关键字，你肯定把它和](https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words)[Java的](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/_keywords.html)[保留关键字`char`](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/_keywords.html)混淆了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T16:52:33.183

根据 ECMAscript 文档（[http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)第 7.6.1 节），char 根本不是保留字。

我猜如果您在某处将其视为保留字，那么它是一个特定的实现。

[http://jsfiddle.net/BCruP/](http://jsfiddle.net/BCruP/)

编辑：以上参考是 EMCAscript 5。

EMCAScript 3 ( [http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf](http://www.ecma-international.org/publications/files/ECMA-ST-ARCH/ECMA-262,%203rd%20edition,%20December%201999.pdf) ) 文档将 char 列为未来保留字，但是，EMCAScript 5 似乎已将其从列表中删除。

# mysql - 将文本从一个表插入另一个表

> ID：10046441
> 
> 赞同：2
> 
> 时间：2012-04-06T16:43:05.783
> 
> 标签：mysql, sql

我很确定我做对了，但是我的查询已经在普通笔记本电脑上的 MySQL 数据库上运行了半个小时。“tweets”表只有 100 万条记录。

我想要什么？考虑表格“AAA”（左）和“BBB”（右）

```
id_str  text    id_str  text
------------    -------------------
13              13      foo bar baz
14              14      foobar
                13      foo bar baz
                17      foobaz 
```

我想用表 B 中的文本填充表 A 的“文本”列：

```
UPDATE AAA
SET `text` = (
    SELECT `text` AS `text`
    FROM BBB
    WHERE id_str = AAA.id_str
    LIMIT 1
) 
```

所以那个表 AAA 看起来像

```
id_str  text
-------------------
13      foo bar baz
14      foobar 
```

但是，如前所述，此查询运行时间过长。我在它的语法上犯了错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:48:04.413

```
UPDATE AAA, BBB
SET AAA.`text` = BBB.text
WHERE BBB.id_str = AAA.id_str 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:55:59.763

如果我正确理解您的情况，这应该会更快：

```
UPDATE `AAA`,`BBB` SET `AAA`.`text`=`BBB`.`text`
WHERE `AAA`.`id_str`=`BBB`.`id_str` 
```

您应该只需要运行一次此查询。它可能仍然需要几分钟，但这样做（使用 JOIN）仍然可能比运行 100 万个单独的查询要快得多。

`AAA`. `id_str`和`BBB`。`id_str`两者都应该被索引并且最好是相同的数据类型，例如两者都应该是 int(11)。这允许 MySQL 以最大的效率评估它们之间的相等关系。

编辑：正如我所说，上面概述的查询可能仍需要一些时间，具体取决于您的系统配置和硬件（操作可能是磁盘绑定的，即受硬盘速度的限制）。也可能是因为 MySQL 必须更新 table 中的索引`AAA`- 你能给我们看一个`CREATE TABLE`table 语句`AAA`吗？或者，你可以试试这个：

```
CREATE TABLE `CCC` LIKE `AAA`;
INSERT INTO `CCC` SELECT `AAA`.`str_id`,`BBB`.`text` FROM `AAA` JOIN `BBB` ON `AAA`.`id` = `BBB`.`id`; 
```

但是，这不会从旧表中复制任何数据`AAA`。

# python - OPENCV_PYTHON_IMAGE2VIDEO GENERATION 错误

> ID：10046443
> 
> 赞同：0
> 
> 时间：2012-04-06T16:43:12.527
> 
> 标签：python, opencv

将图像帧转换为视频时出现以下错误-

回溯（最后一次调用）：文件“C:/Python26/video_writer”，第 25 行，在 cv.WriteFrame(writer,frames[i]) TypeError: Argument 'image' must be IplImage

///////////////////////////////////////// /////

如何获得这个iplimage？？？？

我使用了 cv.writer(writer,frames[i]) 其中 frames[] 是一个图像数组，即

帧=['c:\jay....',........'c:\jay....']

///////////////////////////////////////// /

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T21:28:38.507

从你的代码中我可以看出，

```
frames=['c:\jay....',................'c:\jay.....'] 
```

声明类似于字符串数组`strings != IplImage`，同意吗？

`IplImage`当您从磁盘加载图像时，您可以使用`cvLoadImage()`：

```
frame = cvLoadImage("some_image.jpg")
if not frame:
    print "Could not load frame from the disk" 
```

# templates - 从 HTML 创建 WP 模板

> ID：10046444
> 
> 赞同：0
> 
> 时间：2012-04-06T16:43:24.650
> 
> 标签：templates, wordpress

希望你们中的一些 WP 大师可以指出我正在努力实现的正确方向。我是 WP 新手，但在网页设计方面经验丰富。

我的一个客户希望能够编辑/管理他的网站（然后添加一个博客），但该网站是一个非博客定制设计，我正在努力将各种元素添加/转换为WP为他。我创建了一个带有页眉、页脚等的基本 WP 模板没问题，但它是我可以使用一些指针的主要内容区域。主要内容区HTML如下：

```
<div id="main">
  <nav id="showreelnav">
    <ul>
      <li><a href="#">Category1</a></li>
      <li><a href="#">Category2</a></li>
      <li><a href="#">Category3</a></li>
      <li><a href="#">Category4</a></li>
    </ul>
  </nav>
  <article id="showreels">
    <div class="reel"><img src="thumb1.png" alt="">Title1</div>
    <div class="reel"><img src="thumb2.png" alt="">Title2</div>
    <div class="reel"><img src="thumb3.png" alt="">Title3</div>
    <div class="reel"><img src="thumb4.png" alt="">Title4</div>
    <div class="reel"><img src="thumb5.png" alt="">Title5</div>
    <div class="reel"><img src="thumb6.png" alt="">Title6</div>
    <div class="reel"><img src="thumb7.png" alt="">Title7</div>
    <div class="reel"><img src="thumb8.png" alt="">Title8</div>
    <div class="reel"><img src="thumb9.png" alt="">Title9</div>
    <div class="reel"><img src="thumb10.png" alt="">Title10</div>
    <div class="reel"><img src="thumb11.png" alt="">Title11</div>
    <div class="reel"><img src="thumb12.png" alt="">Title12</div>
  </article>
</div> 
```

非常基本的东西 - 类别导航和网格。导航将在所有类别中保持静态，但如何能够添加/编辑 .reel？并非所有页面都会有 12 个拇指，有些可能会更少，但最多 12 个。

循环是这里的答案还是我可以创建一个模板来编辑或删除网格中的每个对象？或者创建一个`div.reel`可以插入的库项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:14:41.757

这里有一些可能会有所帮助的事情。

使用“类别”提要循环设置自定义页面模板，然后您可以创建单独的“卷轴”帖子，这些帖子将被汇集到页面。

自定义循环可能如下所示：

```
<?php query_posts('cat=5&order=ASC'); 
```

if (have_posts()) : 而 (have_posts()) : the_post(); ?>

```
 <?php the_content(); ?> 

<?php endwhile; ?><?php endif; ?><?php wp_reset_query(); ?> 
```

这里 cat=5 是您要路由到页面的类别的 ID 号。一旦你选择了这个作为你用于特定页面的页面模板，你可以只写在该类别下提交的帖子，它们将在这个页面上输出。

如果您有多个页面要执行此操作，您可以创建多个自定义页面模板，这些模板具有不同的类别，它们正在收集，或者可以使用自定义字段来选择您想要路由到那里的帖子的类别 ID。

“Starkers”是一个很好的空白主题，可以从那里开始和定制。

如果您需要，我很乐意进一步解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:50:17.460

在 WP 中，某些内容（如菜单）应由系统动态生成，然后进行样式设置。对于静态部分循环不生成任何内容，使用相关插件可能很有用。

# multithreading - 使用 QLabel 和 QImage 将数据和事件从 pthread 发送到 QT QApplication

> ID：10046446
> 
> 赞同：1
> 
> 时间：2012-04-06T16:43:40.843
> 
> 标签：multithreading, qt, user-interface, pthreads

问题是关于将现有的基于 pthread 的 C 应用程序与 QT GUI 接口。这似乎是一个简单的任务，但是当我搜索（在互联网上和通过试错）时，我没有找到一个可以接受的解决方案。

现在，该应用程序大量使用了预先存在的 C 库，我无权修改其代码。

基本上，预先存在的库实现了一个循环，它以周期性的方式调用一些函数（带有一些数据）。我只能定义那些函数（函数指针）。

在一个完整的应用程序中，预先存在的库循环以下列方式调用这些函数（又名“init”、“process”和“uninit”）：

```
 init(f);
 process(f);
 process(f);
 ...
 process(f);
 ...
 process(f);
 uninit(f); 
```

“f”是一种结构，允许在调用之间保存相关数据，“init”和“uninint”函数用于设置和销毁由 f 分配的数据。

现在，process() 函数进行了一些计算，最终结果是一个矩阵，我想在 QT GUI 中将其显示为图像（尽可能简单）。

然而，QT GUI 有它自己的阻塞事件循环，也就是 myApp.exec()。

因此，为了实现这一点，我在“init”函数中创建了一个新线程（pthread），它将首先用相关数据填充“f”字段，然后进入 myApp.exec() 循环。myApp 是一个简单的 QApplication，其中包含一个 QLabel，它显示从 QImage 构造的 QPixmap，我可以用计算的数据填充其“bits()”数据（使用一些与此处无关的映射）。

之后，“进程”函数进行连续计算，更新 QImage 的“位”数据（“位”指针通过 f 结构已知），然后应该强制 GUI 更新自身。

以下是一些代码片段：

```
 init(f){
 ...
 pthread_create(&(f->qt_tid),NULL,&qtimgdisplay_main_thread,f);
 ...
}

 process(f){
 ...
 do_computation();
 do_ update(f->bits);
 f->myLabel->repaint();
...
}

static void *qtimgdisplay_main_thread(void *arg){
    FStructure *f = (FStructure *)arg;

    char  arg0[] = "programName";
    char  arg1[] = "arg";
    char  arg2[] = "another arg";
    char* argv[] = { &arg0[0], &arg1[0], &arg2[0], NULL };
    int   argc   = (int)(sizeof(argv) / sizeof(argv[0])) - 1;

    f->myApp = new QApplication(argc, &argv[0]);

    //we create a image
    QImage image(f->winwidth,f->winheight,QImage::Format_RGB32);

    f->bits=image.bits(); //pointer to the underlying data image

    f->myLabel=new QLabel();
    f->myLabel->setPixmap(QPixmap::fromImage(image));
    f->myLabel->show();

    f->myApp->exec();

    return NULL;
} 
```

虽然有些工作（排除一些随机分段错误），但该解决方案的问题在于它（正确）显示：

QPixmap：在 GUI 线程之外使用像素图是不安全的

这是完全正确的，因为 QWidgets 不可重入。

因此，然后我尝试以异步方式将 Repaint() 消息发布到 myApp（我仍然必须想象如何从我的 process() 向 QLabel myLabel 发出信号），方法是在“进程”内部替换：

```
 f->myLabel->repaint(); 
```

和：

```
 f->myApp->postEvent(f->myLabel,new QPaintEvent(f->myLabel->rect())); 
```

灾难性的结果是 QT GUI 不会自行更新；更多，控制台显示：

QPainter::begin：控件绘画只能作为paintEvent的结果开始

最后，我尝试用“更聪明”的东西（我在这里找到：[http](http://www.qtforum.org/article/18253/qpaintevent-problem-in-qt4.html) ://www.qtforum.org/article/18253/qpaintevent-problem-in-qt4.html ）替换上面的同一行，即：

```
 QPaintEvent *pe = new QPaintEvent(f->myLabel->rect());
    f->myLabel->setAttribute(Qt::WA_WState_InPaintEvent, true);
    f->myApp->sendEvent(s->myLabel,f->myLabel->rect());
    f->myLabel->setAttribute(Qt::WA_WState_InPaintEvent, false); 
```

奇妙的结果是它甚至没有编译：

错误：没有匹配函数调用 'QApplication::sendEvent(QLabel*&, QRect)'</p>

我搞不清楚了。有人可以帮忙吗？

这些是我考虑过的一些可能的解决方案：

1) 使 qtimgdisplay_main_thread 成为 QThread 线程而不是 pthread 线程，尽管我不确定这是否会有所帮助；

2）尝试从我的“进程”向 f->myApp 或 f->myLabel 发出一些信号，但我不知道该怎么做，因为“进程”在非 QThread 上运行（并且没有办法访问父线程）

3）创建和销毁一个新的QApplication，所有关联的QLabel和QImage都在“进程”内，但在正常情况下这样做简直是压倒性的和白痴。

我感谢您阅读所有这些内容。如果可能，请尝试通过代码（而不是其他文档）向我提供提示。

编辑：看来，如果我使用：

```
f->myLabel->update(); 
```

代替：

```
 f->myLabel->repaint(); 
```

在我的“过程”中。

任何人都可以确认这是正确的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:54:26.097

回答我自己的问题：对于任何可能对同一主题感兴趣的人，请参阅此答案：[https ://stackoverflow.com/a/10882705/1284631 以获取](https://stackoverflow.com/users/1329652/kuba-ober)[https://stackoverflow.com/users](https://stackoverflow.com/a/10882705/1284631)提供的非常好的解决方案[/1329652/kuba-ober](https://stackoverflow.com/users/1329652/kuba-ober)（使用该`QCoreApplication::postEvent`方法）和我自己的解决方案，归结为编写和实例化一个特殊用途的 QObject 派生方法命令的信号发射类，用于与 QT 接口（即，其方法被调用的类就像任何其他 C++ 方法一样，但它们所做的唯一有用的事情是向 QT QObjects 发出信号）。

# forms - 如何在不使用 express 或 connect 的情况下使用 node.js 读取 POST 数据

> ID：10046447
> 
> 赞同：3
> 
> 时间：2012-04-06T16:43:40.943
> 
> 标签：forms, node.js, post

# 编辑

**确保不要并列请求和响应对象。如果你不这样做，事情会更容易。**

我正在尝试将具有两个输入的表单中的数据发布到特定的 url 节点响应。最初我使用 javascript xmlHTTPrequest 对象来发送它。数据已收到，但节点永远无法读取我尝试发送的 JSON 格式的对象。这是我将其转换为字符串时的样子：

```
{ output: [], 
  outputEncodings: [],
  writable: true,
  _last: false,
  chunkedEncoding: false,
  shouldKeepAlive: true,
  useChunkedEncodingByDefault: true,
  _hasBody: true,
  _trailer: '',
  finished: false,
  socket: 
   { _handle: 
      { writeQueueSize: 0,
        socket: [Circular],
        onread: [Function: onread] },
     _pendingWriteReqs: 0,
     _flags: 0,
     _connectQueueSize: 0,
     destroyed: false,
     errorEmitted: false,
     bytesRead: 8442,
     bytesWritten: 1669569,
     allowHalfOpen: true,
     writable: true,
     readable: true, 
```

这不是完整的字符串。我转而使用 ajax 发布请求，因为我认为 serializearray() 可能会创建节点可以读取的不同格式，但它是相同的。我的服务器端代码基本上只是：

```
function email(request, response)
  form = '';
  request.setEncoding("utf8");
  request.on('data', function(chunk) {
    console.log('data received');
    form += chunk.toString();
  });

  request.on('end', function() {
    console.log('done receiving post data');
  }); 
```

我的表格看起来像这样

```
 <form name="email" action="javascript:true;">
    <input type="text" name="address" value="Enter your email address" onFocus="this.value=''">
    <input class="special" type="text" name="honeypot">
    <input type="submit" value="submit">
  </form> 
```

如果我尝试使用 JSON.parse 解析，则会出现由意外导致的错误 o
如果我尝试使用 querystring 解析，它会返回一个空对象
如果我尝试类似 console.log(form.address) 的输出未定义但应该是一个我在表单中提交的值。

我的 http 服务器将路由到 /email，这是响应 /email 的函数。

我检查并知道 on 'data' 事件尚未过期，因为我的代码设置为通知我“data”事件并且我可以看到事件正在发生。在本地，这段代码工作正常，我可以读取提交的数据，但在开发服务器上它不起作用。

我知道人们会说我应该使用 connect 或 express 但假设这不是一个选项，我怎样才能让节点正确处理这些数据？提交表单的jquery或多或少是标准的。非常感谢！

## 编辑：

抱歉，我认为问题会得到解决，因为我立即注意到发布的字符串不是 JSON。这是我用来发送帖子的代码。

```
$(document).ready(function() {
  $("#email").submit(function(event) {
  event.preventDefault();
  var data = $(this).serializeArray();
  $.ajax({
    type: 'POST',
    dataType: 'json',
    url: '/email',
    data: JSON.stringify(data),
    success: function(msg) {
    $("#aviso").html(msg);
    }
    });
  });
}); 
```

这是数据变量保存的字符串：

```
[
  {
    "name": "address",
    "value": "foo@bar.com"
  },
  {
    "name": "honeypot",
    "value": "irobot"
  }
] 
```

这是根据 jsonlint 的有效 JSON。但是当它到达服务器时仍然是同样的错误。节点处理“数据”事件，在我尝试解析字符串之前一切都很好，它会导致错误未定义：1 意外 o。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:51:32.977

您发送的数据[不是有效的 JSON](http://jsonlint.com/)，它[要求所有对象键都用双引号引起来](http://json.org/)。

# python - 匹配邮件中自然文本的算法

> ID：10046451
> 
> 赞同：2
> 
> 时间：2012-04-06T16:44:00.167
> 
> 标签：python, regex, algorithm, nlp

在进一步处理之前，我需要将电子邮件中自然、连贯的文本/句子与列表、签名、问候语等分开。

例子：

> 你好汤姆，
> 
> ***上周一我们做了 bla bla、lore Lorem ipsum dolor sit amet、consectetur adipisici elit、sed eiusmod tempor incidunt ut labore et dolore magna aliqua。***
> 
> *   清单项目 2
> *   清单项目 3
> *   清单项目 3
> 
> ***Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquid x ea commodi consequat。Quis aute iure reprehenderit in voluptate velit***
> 
> 问候，K。
> 
> ---一行有趣的字符-#######
> 
> 示例公司
> 
> 伦敦邪恶街 33 号
> 
> 手机：00 234534/234345

理想情况下，该算法将仅匹配粗体部分。

是否有任何推荐的方法 - 或者是否有针对该问题的现有算法？我应该根据标点符号的数量、长度等尝试近似的正则表达式还是更多的统计数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:58:30.747

您需要经过认真的 NLP 工作才能完成所需的处理（取决于您期望的精度水平以及代码输入电子邮件数据的随机性和模糊性）。

读[这个](http://research.microsoft.com/en-us/um/people/joshuago/conference/papers-2004/135.pdf)。有关其他相关内容，请参阅参考资料部分。

[这](http://www.infonomics-society.org/IJICR/Email%20Classification%20Using%20Back%20Propagation%20Technique.pdf)处理不同的分类问题，但涉及对电子邮件文本进行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T16:53:10.583

在您发布的示例中，行长就足够了。

没有完美的算法；甚至人类也会对线条进行不同的分类。

我建议只使用行长，直到你找到一个反例，然后修改你的算法。重复直到问题解决到您满意为止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T18:05:01.693

您将需要许多启发式方法来获得解决方案的近似值，所以这里有一个：您可以安全地切断 sigdash（连字符-连字符-空格）之后的任何内容，符合标准的电子邮件用于将邮件正文与签名。

您可以使用的另一种方法是存储来自同一发件人的电子邮件副本；这应该允许您在每条消息中提取相同或相似的内容（例如称呼和签名）并检测他们的邮件客户端如何引用。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-04-06T17:25:55.830

如果您唯一的任务是找出粗体部分，请查看粗体文本在邮件数据库中的技术实现方式。例如，如果它是 html，你可以有这样的东西：

> 你好汤姆，
> 
> **上周一我们做了 bla bla、lore Lorem ipsum dolor sit amet、consectetur adipisici elit、sed eiusmod tempor incidunt ut labore et dolore magna aliqua。**
> 
> ```
> list item 2
> list item 3
> list item 3 
> ```
> 
> **Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquid x ea commodi consequat。Quis aute iure reprehenderit in voluptate velit**
> 
> 问候，K。
> 
> ---一行有趣的字符-#######

然后您可以运行以下代码：

```
import re
# save the mail above as variable MailAbove
print re.findall(r'<b>(.*?)</b>',MailAbove) 
```

结果：

> > ['上周一我们做了 bla bla，lore Lorem ipsum dolor sit amet，consectetur adipisici elit，sed eiusmod tempor incidunt ut labore et dolore magna aliqua。'，'Ut enim ad minim veniam，quis nostrud exercitation ullamco laboris nisi ut aliquid x ea商品后果。Quis aute iure reprehenderit in voluptate velit']

**编辑**：从评论中可以看出我误解了这个问题。通常，此类任务是一个多阶段的过程：您应用一些方法，然后查看结果以及遗漏或错误的内容，然后进行修复或添加新方法并查看结果。
我建议您阅读[此书](http://www.nltk.org/book)——一本出色的教程/书籍，用于解决像您这样的任务以及其他任务。

# ios - iOS - NSURLConnection - 检查 URL

> ID：10046452
> 
> 赞同：1
> 
> 时间：2012-04-06T16:44:03.827
> 
> 标签：ios, asynchronous, nsurlconnection

我将 NSURLConnection 与 sendAsynchronousRequest 方法一起使用（并以块的形式处理数据）。
使用上述方法，我正在从服务器下载视频文件并本地保存在缓存文件夹中。
如果 URL 有效，这可以正常工作。如果 URL 无效（即视频在给定的 URL 上不可用），它仍然使用我提供的文件名保存文件。NSError 是 nil 并且 NSData 对象不是 nil。如果 URL 不存在，如何检查 URL 是否有效或捕获错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:56:34.420

检查`NSURLResponse`块中的 ，如果它是一个 http 请求，它真的是一个`NSHTTPURLResponse`. 检查`statusCode`以查看 HTTP 错误。它可能是 404、302 等。

还要检查返回的数据，将其转换为字符串，看看那里是否有任何有趣的东西。有时返回的 html 中有重定向。

# javascript - jQuery attr(); 与 iframe？

> ID：10046457
> 
> 赞同：0
> 
> 时间：2012-04-06T16:44:28.953
> 
> 标签：javascript, jquery, html

我正在尝试使用 jQuery`.attr()`属性来获取 iframe*或*具有明确定义高度的 img 的高度。

**jQuery**

```
var scrollerHeight = $('.caroufredsel_wrapper > ul > li').find('img','iframe').attr('height'); 
```

**HTML**

```
<div class="caroufredsel_wrapper">
<ul>
    <li><iframe src="movie.swf" width="750" height="422"></iframe></li>
</ul>
</div> 
```

正如现在所写的那样，我将“未定义”作为一个值。关于如何解决这个问题的任何想法？

JSFiddle在这里：http: [//jsfiddle.net/LmMTL/1/](http://jsfiddle.net/LmMTL/1/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T16:51:14.490

你应该只提供一个参数给`.find()`-> 选择器`'img, iframe'`

```
var scrollerHeight = $('.caroufredsel_wrapper > ul > li').find('img, iframe').attr('height'); 
```

[http://jsfiddle.net/LmMTL/2/](http://jsfiddle.net/LmMTL/2/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T16:52:28.863

这是错误的：

```
.find('img','iframe') 
```

`find()`不接受任何额外参数。我想你的意思是：

```
.find('img, iframe') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:08:30.427

find() 方法使用 Selector 上下文，因此它将第二个参数视为备用上下文。备用上下文通常用于将选择器定向到不同的 DOM。

更改您的查找选择器以在第一个参数中使用多个元素将起作用。

高度 = $('.caroufredsel_wrapper > ul > li').find('img, iframe').attr('height');

我还建议使用第一个过滤器/方法来确保你只得到一个结果：

$('.caroufredsel_wrapper > ul > li').find('iframe, img').first().attr('height');

在这里查看我的测试要点：[https ://gist.github.com/2321394](https://gist.github.com/2321394)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:54:32.577

你总是可以给 iframe 一个 id attr。我在您的 jsFiddle 上对其进行了测试，结果为 422。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T16:56:22.093

为什么不为框架设置一个 id 并直接访问它。

```
var scrollerHeight = $('#mframe').attr('height'); 
```

[http://jsfiddle.net/LmMTL/7/](http://jsfiddle.net/LmMTL/7/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-06T18:17:56.920

这个是错的

```
 .find('img','iframe') 
```

试试这个

```
 $(document).ready(function() {

  var scrollerHeight = $('.caroufredsel_wrapper > ul > li').find('iframe').attr('height');
  alert(scrollerHeight);

 }); 
```

# .net - 使用 Oracle 的 NHibernate 多查询/期货

> ID：10046461
> 
> 赞同：6
> 
> 时间：2012-04-06T16:44:49.767
> 
> 标签：.net, oracle, nhibernate, orm, fluent-nhibernate

我正在尝试在 NHibernate 3.2 和 Oracle 11gR2 中使用期货。尽管我不确定，但这似乎不受支持。我在 NHibernate Jira 上发现[了这个问题](https://nhibernate.jira.com/browse/NH-2170)，这使得 Oracle 的未来似乎成为可能。有谁知道如何让期货与 Oracle 合作？不支持 Oracle 的具体原因是什么？

## 更新

根据此处的评论，我尝试使用 HQL 多查询。我在执行时遇到异常`_nhSession.CreateMultiQuery();`这是异常：

```
The driver NHibernate.Driver.OracleDataClientDriver does not support multiple queries. 
```

我还能尝试什么？我是否使用了错误的驱动程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T19:42:00.007

我想分享一下我是如何让 NHibernate Future 查询与 Oracle 一起工作的。您只需将以下两个类 EnhancedOracleDataClientDriver 和 EnhancedOracleResultSetsCommand 添加到您的项目中，并将 NHibernate 配置为使用 EnhancedOracleDataClientDriver 类作为数据库驱动程序。如果这种方法对其他人有效，我将不胜感激。这是上述类的源代码。

增强的 OracleDataClientDriver.cs

```
using NHibernate.Engine;

namespace NHibernate.Driver
{
    public class EnhancedOracleDataClientDriver : OracleDataClientDriver
    {
        public override bool SupportsMultipleQueries
        {
            get
            {
                return true;
            }
        }

        public override IResultSetsCommand GetResultSetsCommand(ISessionImplementor session)
        {
            return new EnhancedOracleResultSetsCommand(session);
        }
    }
} 
```

增强的 OracleResultSetsCommand.cs

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Reflection;
using NHibernate.Engine;
using NHibernate.SqlCommand;
using NHibernate.SqlTypes;
using NHibernate.Util;

namespace NHibernate.Driver
{
    public class EnhancedOracleResultSetsCommand : BasicResultSetsCommand
    {
        private const string driverAssemblyName = "Oracle.DataAccess";

        private SqlString sqlString = new SqlString();
        private int cursorCount = 0;
        private readonly PropertyInfo oracleDbType;
        private readonly object oracleDbTypeRefCursor;

        public EnhancedOracleResultSetsCommand(ISessionImplementor session)
            : base(session)
        {
            System.Type parameterType = ReflectHelper.TypeFromAssembly("Oracle.DataAccess.Client.OracleParameter", driverAssemblyName, false);
            oracleDbType = parameterType.GetProperty("OracleDbType");

            System.Type oracleDbTypeEnum = ReflectHelper.TypeFromAssembly("Oracle.DataAccess.Client.OracleDbType", driverAssemblyName, false);
            oracleDbTypeRefCursor = System.Enum.Parse(oracleDbTypeEnum, "RefCursor");
        }

        public override void Append(ISqlCommand command)
        {
            Commands.Add(command);
            sqlString = sqlString.Append("\nOPEN :cursor")
                .Append(Convert.ToString(cursorCount++))
                .Append("\nFOR\n")
                .Append(command.Query).Append("\n;\n");
        }

        public override SqlString Sql
        {
            get { return sqlString; }
        }

        public override IDataReader GetReader(int? commandTimeout)
        {
            var batcher = Session.Batcher;
            SqlType[] sqlTypes = Commands.SelectMany(c => c.ParameterTypes).ToArray();
            ForEachSqlCommand((sqlLoaderCommand, offset) => sqlLoaderCommand.ResetParametersIndexesForTheCommand(offset));

            sqlString = sqlString.Insert(0, "\nBEGIN\n").Append("\nEND;\n");

            var command = batcher.PrepareQueryCommand(CommandType.Text, sqlString, sqlTypes);
            if (commandTimeout.HasValue) {
                command.CommandTimeout = commandTimeout.Value;
            }

            BindParameters(command);

            for (int cursorIndex = 0; cursorIndex < cursorCount; cursorIndex++) {
                IDbDataParameter outCursor = command.CreateParameter();
                oracleDbType.SetValue(outCursor, oracleDbTypeRefCursor, null);
                outCursor.ParameterName = ":cursor" + Convert.ToString(cursorIndex);
                outCursor.Direction = ParameterDirection.Output;
                command.Parameters.Add(outCursor);
            }

            return new BatcherDataReaderWrapper(batcher, command);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-04T19:49:06.380

三年前，我发布了“NHibernate multi query / futures with Oracle”问题的答案，其中包含如何使未来的查询与 Oracle 一起工作的解决方案。就像在项目中添加两个派生类 EnhancedOracleDataClientDriver 和 EnhancedOracleResultSetsCommand 一样简单，并将 NHibernate 配置为使用 EnhancedOracleDataClientDriver 类作为数据库驱动程序。

我最近检查了这个问题[https://nhibernate.jira.com/browse/NH-2170](https://nhibernate.jira.com/browse/NH-2170)，发现开箱即用的 NHibernate 仍然不支持 Oracle 的期货。另外，我在 StackOverflow 上收到了 Ruben 的一个问题，我是否可以分享任何关于推导这种“增强”实现方法的资源和/或方法。此外，有些人测试了这种“增强”方法，但对 SQL Server 期货没有注意到性能提升这一事实感到失望。

所以我决定花一些时间重新审视这个问题，试图分析和优化“增强”方法。

以下是我对分析器的发现：

1.  在 Oracle.ManagedDataAccess 提供程序中，按名称实现参数绑定比位置参数绑定慢。我测试了一个包含总共 500 个命名参数的多标准，分析器向我显示，在执行命令之前，Oracle 提供程序花费了将近 1 秒来将命名参数转换为位置参数。我相信即使是具有 500 个命名参数的常规（非未来）查询也会遇到类似的性能损失。因此，一个瓶颈是“command.BindByName = true;”。
2.  将多个查询合并为一批时，应使用 SqlStringBuilder.Add(...)（而不是 SqlString.Append(...)）。这与组合字符串相同：StringBuilder 比 String 执行得更好。

因此，在仔细分析了构建 SQL 命令并将其组合成批处理的 NHibernate 源代码之后，我提出了“增强”方法的版本 #2。我希望 NHibernate 核心团队会注意到这一点，并考虑将 Oracle 期货添加到我最喜欢的 ORM 中。

顺便说一句，“增强”方法依赖于 Oracle refcursor（一个批处理中的每个查询的一个输出 refcursor），并且我们必须注意每个会话的最大游标的 Oracle 限制（Oracle XE 上的默认设置是最大 300 个游标）。

用法。将以下两个类 EnhancedOracleManagedDataClientDriver 和 EnhancedOracleManagedResultSetsCommand 添加到您的项目中，并将 NHibernate 配置为使用 EnhancedOracleManagedDataClientDriver 类作为数据库驱动程序。

增强的 OracleManagedDataClientDriver.cs

```
using System;
using System.Data;
using System.Reflection;
using NHibernate.Engine;
using NHibernate.SqlTypes;
using NHibernate.Util;

namespace NHibernate.Driver
{
    public class EnhancedOracleManagedDataClientDriver : OracleManagedDataClientDriver
    {
        private readonly PropertyInfo _oracleCommandBindByName;
        private readonly PropertyInfo _oracleDbType;
        private readonly object _oracleDbTypeRefCursor;

        public EnhancedOracleManagedDataClientDriver()
        {
            _oracleCommandBindByName = ReflectHelper.TypeFromAssembly(
                "Oracle.ManagedDataAccess.Client.OracleCommand", "Oracle.ManagedDataAccess", true).GetProperty("BindByName");
            _oracleDbType = ReflectHelper.TypeFromAssembly(
                "Oracle.ManagedDataAccess.Client.OracleParameter", "Oracle.ManagedDataAccess", true).GetProperty("OracleDbType");
            var enumType = ReflectHelper.TypeFromAssembly(
                "Oracle.ManagedDataAccess.Client.OracleDbType", "Oracle.ManagedDataAccess", true);
            _oracleDbTypeRefCursor = Enum.Parse(enumType, "RefCursor");
        }

        public override bool SupportsMultipleQueries => true;

        public override IResultSetsCommand GetResultSetsCommand(ISessionImplementor session)
        {
            return new EnhancedOracleManagedResultSetsCommand(session);
        }

        protected override void InitializeParameter(IDbDataParameter dbParam, string name, SqlType sqlType)
        {
            // this "exotic" parameter type will actually mean output refcursor
            if (sqlType.DbType == DbType.VarNumeric)
            {
                dbParam.ParameterName = FormatNameForParameter(name);
                dbParam.Direction = ParameterDirection.Output;
                _oracleDbType.SetValue(dbParam, _oracleDbTypeRefCursor, null);
            }
            else
                base.InitializeParameter(dbParam, name, sqlType);
        }

        protected override void OnBeforePrepare(IDbCommand command)
        {
            base.OnBeforePrepare(command);

            if (command.CommandText.StartsWith("\nBEGIN -- multi query\n"))
            {
                // for better performance, in multi-queries, 
                // we switch to parameter binding by position (not by name)
                this._oracleCommandBindByName.SetValue(command, false, null);
                command.CommandText = command.CommandText.Replace(":p", ":");
            }
        }
    }
} 
```

增强的 OracleManagedResultSetsCommand.cs

```
using System.Data;
using System.Linq;
using NHibernate.Engine;
using NHibernate.Impl;
using NHibernate.Loader.Custom;
using NHibernate.Loader.Custom.Sql;
using NHibernate.SqlCommand;
using NHibernate.SqlTypes;
using NHibernate.Type;

namespace NHibernate.Driver
{
    public class EnhancedOracleManagedResultSetsCommand : BasicResultSetsCommand
    {
        private readonly SqlStringBuilder _sqlStringBuilder = new SqlStringBuilder();
        private SqlString _sqlString = new SqlString();
        private QueryParameters _prefixQueryParameters;
        private CustomLoader _prefixLoader;

        public EnhancedOracleManagedResultSetsCommand(ISessionImplementor session)
            : base(session) {}

        public override SqlString Sql => _sqlString;

        public override void Append(ISqlCommand command)
        {
            if (_prefixLoader == null)
            {
                var prefixQuery = (SqlQueryImpl)((ISession)Session)
                    // this SQL query fragment will prepend every SELECT query in multiquery/multicriteria 
                    .CreateSQLQuery("\nOPEN :crsr \nFOR\n")
                    // this "exotic" parameter type will actually mean output refcursor
                    .SetParameter("crsr", 0, new DecimalType(new SqlType(DbType.VarNumeric)));

                _prefixQueryParameters = prefixQuery.GetQueryParameters();

                var querySpecification = prefixQuery.GenerateQuerySpecification(_prefixQueryParameters.NamedParameters);

                _prefixLoader = new CustomLoader(new SQLCustomQuery(querySpecification.SqlQueryReturns, querySpecification.QueryString,
                    querySpecification.QuerySpaces, Session.Factory), Session.Factory);
            }

            var prefixCommand = _prefixLoader.CreateSqlCommand(_prefixQueryParameters, Session);

            Commands.Add(prefixCommand);
            Commands.Add(command);

            _sqlStringBuilder.Add(prefixCommand.Query);
            _sqlStringBuilder.Add(command.Query).Add("\n;\n\n");
        }

        public override IDataReader GetReader(int? commandTimeout)
        {
            var batcher = Session.Batcher;
            var sqlTypes = Commands.SelectMany(c => c.ParameterTypes).ToArray();
            ForEachSqlCommand((sqlLoaderCommand, offset) => sqlLoaderCommand.ResetParametersIndexesForTheCommand(offset));

            _sqlStringBuilder.Insert(0, "\nBEGIN -- multi query\n").Add("\nEND;\n");
            _sqlString = _sqlStringBuilder.ToSqlString();

            var command = batcher.PrepareQueryCommand(CommandType.Text, _sqlString, sqlTypes);
            if (commandTimeout.HasValue)
                command.CommandTimeout = commandTimeout.Value;

            BindParameters(command);
            return new BatcherDataReaderWrapper(batcher, command);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T13:00:56.117

我无法评论上面的答案:) 所以我对上述实现的反馈在这里：对我来说很好，但性能没有提升。我的测试用例在远程 Oracle 机器上的小表上执行 100 次简单的选择，并且 ToFuture<> 与 ToList<> 的使用提供了相似的响应时间。与远程机器上的 MS SQL 相比，ToFuture<> 提供的响应时间大约是 ToList<> 的两倍。

# java - 如何在我的自定义适配器中使用数组？

> ID：10046464
> 
> 赞同：0
> 
> 时间：2012-04-06T16:44:56.503
> 
> 标签：java, android, listview, adapter

我有自定义列表视图适配器来显示两行数据。我可以将此数据设置为`String[] name = {some values};`，但无法从数组创建列表视图。以下是活动代码：

```
public class ListAction extends Activity implements OnClickListener {

    String[] data = { "Sample User Data ", "Sample User Data ",
        "Sample User Data ", "Sample User Data ", "Sample User Data ",
        "Sample User Data ", "Sample User Data ", "Sample User Data ",
        "Sample User Data ", "Sample User Data ", "Sample User Data ",
        "Sample User Data ", "Sample User Data ", "Sample User Data ",
        "Sample User Data ", "Sample User Data " };
    String[] data2 = { "Sample User Data 2", "Sample User Data 2",
            "Sample User Data 2", "Sample User Data 2", "Sample User Data 2",
            "Sample User Data 2", "Sample User Data 2", "Sample User Data 2",
            "Sample User Data 2", "Sample User Data 2", "Sample User Data 2",
            "Sample User Data 2", "Sample User Data 2", "Sample User Data 2",
            "Sample User Data 2", "Sample User Data 2" };

    ListView myList;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.list);

        myList = (ListView) findViewById(R.id.listView);
        myList.setAdapter((ListAdapter) new MyCustomAdapter());
        myList.setCacheColorHint(0);

        myList.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> a, View v, int position,
                    long id) {
                String itemname = new Integer(position).toString();

                Intent intent = new Intent();
                intent.setClass(ListAction.this, ViewClient.class);

                Bundle b = new Bundle();
                b.putString("fileName", itemname);
                intent.putExtras(b);

                startActivity(intent);
            }
        });
    }

    class MyCustomAdapter extends BaseAdapter {

        @Override
        public int getCount() {
            return data.length;
        }

        @Override
        public String getItem(int position) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public long getItemId(int position) {
            // TODO Auto-generated method stub
            return position;
        }

        @Override
        public int getItemViewType(int position) {
            // TODO Auto-generated method stub
            return position;
        }

        @Override
        public int getViewTypeCount() {
            // TODO Auto-generated method stub
            return data.length;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            LayoutInflater inflater = getLayoutInflater();
            View row;

            row = inflater.inflate(R.layout.list_item, parent, false);
            TextView textLabel = (TextView) row.findViewById(R.id.text);
            textLabel.setText(data[position]);

            TextView textLabel2 = (TextView) row.findViewById(R.id.text2);
            textLabel2.setText(data2[position]);

            return (row);
        }
    }
} 
```

我想用数组中的数据填充列表视图，例如这样： `String[] data = getResources().getStringArray(R.array.categories);`但我只在这一行得到 NullPointer。请帮忙。

* * *

日志：

```
04-06 23:35:00.110: E/AndroidRuntime(11420): FATAL EXCEPTION: main
04-06 23:35:00.110: E/AndroidRuntime(11420): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example/com.example.ListAction}: java.lang.NullPointerException
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1573)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.os.Looper.loop(Looper.java:130)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.ActivityThread.main(ActivityThread.java:3687)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at java.lang.reflect.Method.invokeNative(Native Method)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at java.lang.reflect.Method.invoke(Method.java:507)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at dalvik.system.NativeStart.main(Native Method)
04-06 23:35:00.110: E/AndroidRuntime(11420): Caused by: java.lang.NullPointerException
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.content.ContextWrapper.getResources(ContextWrapper.java:80)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at com.example.ListAction.<init>(ListAction.java:25)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at java.lang.Class.newInstanceImpl(Native Method)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at java.lang.Class.newInstance(Class.java:1409)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
04-06 23:35:00.110: E/AndroidRuntime(11420):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1565)
04-06 23:35:00.110: E/AndroidRuntime(11420):    ... 11 more 
```

第 25 行是`String[] data = getResources().getStringArray(R.array.categories);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:58:34.860

请参阅此处给出的完整示例....

[http://android-example-code.blogspot.in/p/dynamic-custoized-list-view-in-android.html](http://android-example-code.blogspot.in/p/dynamic-custoized-list-view-in-android.html)

![在此处输入图像描述](../Images/f3a00138283778f12984cde9d985934c.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:40:00.720

确保`String[] data = getResources().getStringArray(R.array.categories);`在`onCreate()`之后`super.onCreate()`。在调用其方法之前，必须先实例化上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:55:57.273

您没有将数组传递给适配器。使用构造函数传递它或使用 ArrayAdapter。试试这个教程。

[http://www.shubhayu.com/android/listview-with-arrayadapter-and-customized-items](http://www.shubhayu.com/android/listview-with-arrayadapter-and-customized-items)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T16:57:33.430

您需要将数组传递到您的自定义适配器中，否则它将不知道正确的大小和位置将不起作用

# c# - 与 BinaryFormatter 的区别

> ID：10046467
> 
> 赞同：3
> 
> 时间：2012-04-06T16:45:27.370
> 
> 标签：c#, serialization, protobuf-net

我正在尝试更改在客户端和服务器上使用共享实体的现有 WCF net.tcp 项目中的序列化程序。我很难弄清楚 protobuf-net(V2480)[这里](https://stackoverflow.com/questions/1154198/what-are-the-differences-between-the-xmlserializer-and-binaryformatter)的图表说我可以序列化私有成员，但找不到这样做的文档，没有属性可以吗？如何启用图形模式（作为参考），如此[处所述](https://stackoverflow.com/questions/7479114/reference-integrity-in-binaryformatter)

这会解决 protobuf 触发我更改的项目标志的问题吗？例如我有一堂课

```
 public enum FirstEnum
{ 
    First = 0,
    Second,
    Third
}
public enum AnotherEnum
{ 
    AE1 = 0,
    AE2,
    AE3
}
[Serializable()]
public class SomeClass
{
    public int SomeClassId { get; set; }
    public FirstEnum FEnum { get; set; }
    public AnotherEnum AEnum { get; set; }
    string thing;
    public string Thing
    {
        get{return thing;}
        set
        {
            if (string.IsNullOrEmpty(value))
                throw new ArgumentNullException("Thing");

            thing = value;
        }
    }

    private decimal firstAmount;
    public decimal FirstAmount 
    { 
        get{return firstAmount;} 
        set
        {
            if (value != firstAmount)
            {
                firstAmount = value;
                changedItems.Add("FirstAmount changed");
            }
        }
    }
    private decimal secondAmount;
    public decimal SecondAmount
    {
        get { return secondAmount; }
        set
        {
            if (value != secondAmount)
            {
                secondAmount = value;
                changedItems.Add("SecondAmount changed");
            }
        }
    }
    public decimal ThirdAmount { get { return SecondAmount - FirstAmount; } }
    public DateTime? SomeDate { get; set; }

    private List<string> changedItems = new List<string>();
    public List<string> ChangedItems
    {
        get { return changedItems; }
    }
public int PrivateSet { get; private set; }
    public SomeClass() { }

    public SomeClass(decimal first, decimal second)
    {
        FirstAmount = first;
        SecondAmount = second;
    }

    public void ClearChangedItems()
    {
        changedItems.Clear();
    } 
```

当我用 (1000 items) 反序列化它时

```
 var model = CreateModel();
 items = (List<SomeClass>)model.Deserialize(returnStream, null, typeof(List<SomeClass>)); 
```

2012-04-06 09:14:28.1222|DEBUG|ProtobufTEsts.Form1|ProtoBuf 更改项目数：1000

使用 BinaryFormatter

```
System.Runtime.Serialization.Formatters.Binary.BinaryFormatter binaryFormatter = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
items = (List<SomeClass>)binaryFormatter.Deserialize(returnStream); 
```

2012-04-06 09:14:28.1662|DEBUG|ProtobufTEsts.Form1|BinaryFormatter 更改项目数：0

有没有办法让 protobuf 表现得像 binaryFormatter 但保留 protobuf 的性能？

如何允许私有序列化，这失败了

```
 public static TypeModel CreateModel()
    {
        RuntimeTypeModel model = TypeModel.Create();
        ///var metaType = RuntimeTypeModel.Default.Add(typeof(SomeClass), false);
        model.Add(typeof(SomeClass), false)
            .Add(1, "SomeClassId")
            .Add(2, "FEnum")
            .Add(3, "AEnum")
            .Add(4, "Thing")
            .Add(5, "FirstAmount")
            .Add(6, "SecondAmount")
            .Add(7, "SomeDate")
            .Add(8, "PrivateSet");
        TypeModel compiled = model.Compile();
        return compiled;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T09:36:41.333

啊，我现在明白了这个问题；这条线是有问题的：

```
TypeModel compiled = model.Compile();
return compiled; 
```

如果您使用 Compile()，它会创建一个正式的程序集（在内存中），该程序集必须遵守程序集的通常规则，特别是：成员可访问性。这意味着它无法访问您的私人 sertter。

相反，使用：

```
model.CompileInPlace();
return model; 
```

这将执行部分编译，但继续使用 DynamicMethod。这个厚脸皮的小动物可以选择通过可访问性规则进行欺骗（很像反射可以），因此它可以继续使用私有设置器。

请注意，模型也是根据需要就地编译（在更细粒度的级别），因此对 CompileInPlace 的调用不是*严格必要*的，但有助于提前做好所有事情。

为了完整起见，还有一个额外的 Compile(string,string) 重载，可用于在磁盘上生成单独的序列化 dll，无需在运行时进行*任何*元编程即可引用和使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T16:58:53.777

是的 protobuf-net 可以序列化私有字段，并且没有属性。我不在电脑上，所以这可能需要调整：

```
var metaType = RuntimeTypeModel.Default.Add(typeof(SomeClass), false);
// for each field in a known order
metaType.Add(fieldName, someUniqueTag); 
```

在属性驱动的用法中，还有 ImplicitFields.AllFields 会根据您的意图自动配置它，但我还没有向 MetaType 添加 ImplicitFields 辅助方法。我会把它添加到我的列表中！

注意：标签（=字段）数字对 protobuf 很重要，并且在反序列化时必须可以重现相同的数字映射。

您可能要考虑的另一个选项是（反）序列化回调，它可以让您知道它当前正在序列化/反序列化（通过 before/after 方法调用）。这可能是另一种禁用间隔的副作用的方法，例如反序列化。

# ruby-on-rails - Rails、Heroku 和 UTF-8 错误中的无效字节序列

> ID：10046469
> 
> 赞同：10
> 
> 时间：2012-04-06T16:45:31.923
> 
> 标签：ruby-on-rails, utf-8, heroku, redis

我在 Redis 中有一个短信队列。假设redis中的消息是这样的：

```
"niño" 
```

（发现非标准字符）。

rails 应用程序显示消息队列。当我在本地测试（Rails 3.2.2，Ruby 1.9.3）时，一切都很好，但是在 Heroku cedar（Rails 3.2.2，我相信有 ruby​​ 1.9.2）上我得到了臭名昭著的错误：`ActionView::Template::Error (invalid byte sequence in UTF-8)`

在阅读和重读所有我能在网上找到的东西之后，我仍然不知道如何解决这个问题。

非常感谢任何帮助或指出正确的方向！

编辑：

我设法找到了解决方案。我最终使用了 Iconv：

```
string = Iconv.iconv('UTF-8', 'ISO-8859-1', message)[0] 
```

我发现的所有建议答案似乎都不适用于我的情况。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-07T21:32:04.573

On Heroku, when your app receives the message "niño" from Redis, it is actually getting the four bytes:

```
 0x6e 0x69 0xf1 0x6f 
```

which, when interpreted as [ISO-8859-1](http://en.wikipedia.org/wiki/ISO/IEC_8859-1) correspond to the characters `n`, `i`, `ñ` and `o`.

However, your Rails app assumes that these bytes should be interpreted as [UTF-8](http://en.wikipedia.org/wiki/Utf-8), and at some point it tries to decode them this way. The third byte in this sequence, 0xf1 looks like this:

```
1 1 1 1 0 0 0 1 
```

If you compare this to the [table on the Wikipedia page](http://en.wikipedia.org/wiki/Utf-8#Description), you can see this byte is the leading byte of a four byte character (it matches the pattern `11110xxx`), and as such should be followed by three more continuation bytes that all match the pattern `10xxxxxx`. It's not, instead the next byte is 0x6f (`01101111`), and so this is invalid utf-8 byte sequence and you get the error you see.

Using:

```
string = message.encode('utf-8', 'iso-8859-1') 
```

(or the `Iconv` equivalent) tells Ruby to read `message` as ISO-8859-1 encoded, and then to create the equivalent string in UTF-8 encoding, which you can then use without problems. (An alternative could be to use [`force_encoding`](http://ruby-doc.org/core-1.9.3/String.html#method-i-force_encoding) to tell Ruby the correct encoding of the string, but that will likely cause problems later when you try to mix UTF-8 and ISO-8859-1 strings).

In UTF-8, the string "niño" corresponds to the bytes:

```
0x6e 0x69 0xc3 0xb1 0x6f 
```

Note that the first, second and last bytes are the same. The `ñ` character is encoded as the two bytes `0xc3 0xb1`. If you write these out in binary and compare to the table in the Wikipedia again article you'll see they encode 0xf1, which is the ISO-8859-1 encoding of `ñ` (since the first 256 unicode codepoints match ISO-8859-1).

If you take these five bytes and treat them as being ISO-8859-1, then they correspond to the string

```
niÃ±o 
```

Looking at the [ISO-8859-1 codepage](http://en.wikipedia.org/wiki/ISO/IEC_8859-1), 0xc3 maps to `Â`, and 0xb1 maps to `±`.

So what's happening on your local machine is that your app is receiving the five bytes `0x6e 0x69 0xc3 0xb1 0x6f` from Redis, which is the UTF-8 representation of "niño". On Heroku it's receiving the four bytes `0x6e 0x69 0xf1 0x6f`, which is the ISO-8859-1 representation.

The real fix to your problem will be to make sure the strings being put into Redis are all already UTF-8 (or at least all the same encoding). I haven't used Redis, but from what I can tell from a brief Google, it doesn't concern itself with string encodings but simply gives back whatever bytes it's been given. You should look at whatever process is putting the data into Redis, and ensure that it handles the encoding properly.

# sql - 将逻辑数据模型转换为 SQL 表设计

> ID：10046470
> 
> 赞同：2
> 
> 时间：2012-04-06T16:45:48.313
> 
> 标签：sql, database, database-design

在我最近制作的 LDM 中，我有一个具有以下结构的实体：

```
Building_ID (Primary Key, Foreign Key),
Plant_ID (Foreign Key),
Build_Year (Primary Key),
Size 
```

我需要使用这种设计在 SQL 数据库中创建一个表。我遇到的问题是如何处理这里的主键？SQL表可以有多个主键吗？如果这个问题的答案是肯定的，那么应该将哪一列作为唯一索引？我应该创建一个新列作为唯一索引标识符吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:05:05.563

我知道任何关系数据库系统（SQL Server、Oracle、Firebird、IBM DB2、Sybase 等）的任何 SQL 表都只能有**一个**主键 - 毕竟，它是**主**键 - 只能有一个。

但是，一个主键可以由多个列组成（称为“复合主键”）。有一些缺点，例如：来自其他表的所有外键约束也必须指定复合 PK 中的**所有**列，因此连接表有点麻烦（因为您需要为包含在键中的所有列指定所有相等约束你的加入）。

除了主键之外，您还可以有多个**备用键**- 也可以唯一标识行的其他列。如果它们可以帮助您加快对表格的访问速度，那么这些是例如索引的绝佳候选者（但不要过度索引您的表格！少即是多）

# spring - Spring MVC 和 Hibernate - ClassNotFound DispatcherServlet

> ID：10046475
> 
> 赞同：0
> 
> 时间：2012-04-06T16:46:22.760
> 
> 标签：spring, spring-mvc, maven-3, classnotfoundexception

我正在使用 Spring 和 MVC 构建一个示例项目，当我在 Eclipse 中启动 Tomcat 6.0 时出现一些错误。在里面

*/spring-webmvc-3.1.1.RELEASE.jar*我有一个 org.springframework.web.servlet.DispatcherServlet.class

Tomcat 日志

```
 Apr 6, 2012 6:34:20 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: .:/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java
Apr 6, 2012 6:34:21 PM org.apache.coyote.http11.Http11Protocol init
INFO: Initializing Coyote HTTP/1.1 on http-8080
Apr 6, 2012 6:34:21 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 733 ms
Apr 6, 2012 6:34:21 PM org.apache.catalina.core.StandardService start
INFO: Starting service Catalina
Apr 6, 2012 6:34:21 PM org.apache.catalina.core.StandardEngine start
INFO: Starting Servlet Engine: Apache Tomcat/6.0.32
Apr 6, 2012 6:34:21 PM org.apache.catalina.startup.HostConfig deployDescriptor
INFO: Deploying configuration descriptor Market2.xml
Apr 6, 2012 6:34:21 PM org.apache.catalina.core.ApplicationContext log
INFO: Marking servlet spring as unavailable
Apr 6, 2012 6:34:21 PM org.apache.catalina.core.ApplicationContext log
SEVERE: Error loading WebappClassLoader
  context: /Market2
  delegate: false
  repositories:
    /WEB-INF/classes/
----------> Parent Classloader:
org.apache.catalina.loader.StandardClassLoader@70ba9340
 org.springframework.web.servlet.DispatcherServlet
java.lang.ClassNotFoundException: org.springframework.web.servlet.DispatcherServlet
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1095)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:993)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4420)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4733)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:675)
    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:601)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:502)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1315)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1061)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Apr 6, 2012 6:34:21 PM org.apache.catalina.core.StandardContext loadOnStartup
SEVERE: Servlet /Market2 threw load() exception
java.lang.ClassNotFoundException: org.springframework.web.servlet.DispatcherServlet
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1095)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:993)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4420)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4733)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:799)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:779)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:601)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:675)
    at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:601)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:502)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1315)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1061)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Apr 6, 2012 6:34:21 PM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Apr 6, 2012 6:34:21 PM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Apr 6, 2012 6:34:21 PM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/15  config=null
Apr 6, 2012 6:34:21 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 325 ms
Apr 6, 2012 6:35:31 PM org.apache.catalina.loader.WebappClassLoader modified
INFO:     Additional JARs have been added
Apr 6, 2012 6:35:31 PM org.apache.catalina.core.StandardContext reload
INFO: Reloading Context with name [/Market2] has started
Apr 6, 2012 6:35:32 PM org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor processChildren
SEVERE: Exception invoking periodic operation: 
java.lang.NoClassDefFoundError: org/springframework/context/EnvironmentAware
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2818)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1159)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1647)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2818)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1159)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1647)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at org.apache.catalina.loader.WebappClassLoader.findClassInternal(WebappClassLoader.java:2818)
    at org.apache.catalina.loader.WebappClassLoader.findClass(WebappClassLoader.java:1159)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1647)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1095)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:993)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4420)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4733)
    at org.apache.catalina.core.StandardContext.reload(StandardContext.java:3460)
    at org.apache.catalina.loader.WebappLoader.backgroundProcess(WebappLoader.java:426)
    at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1357)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1649)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1658)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1658)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1638)
    at java.lang.Thread.run(Thread.java:680)
Caused by: java.lang.ClassNotFoundException: org.springframework.context.EnvironmentAware
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    ... 36 more 
```

spring-servlet.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop" xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee" xmlns:lang="http://www.springframework.org/schema/lang"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd
        http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"
    xmlns="http://www.springframework.org/schema/beans">

    <context:annotation-config />

    <context:component-scan base-package="com.xxx.xxx.xxx" />

    <bean id="jspViewResolver"
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">

        <property name="viewClass"
            value="org.springframework.web.servlet.view.JstlView" />

        <property name="prefix" value="/WEB-INF/jsp/" />

        <property name="suffix" value=".jsp" />
    </bean>

    <bean id="messageSource"
        class="org.springframework.context.support.ReloadableResourceBundleMessageSource">

        <property name="basename" value="classpath:messages" />

        <property name="defaultEncoding" value="UTF-8" />
    </bean>

    <bean id="propertyConfigurer"
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
        p:location="/WEB-INF/jdbc.properties" />

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close" p:driverClassName="${jdbc.driverClassName}"
        p:password="${jdbc.password}" p:url="${jdbc.databaseurl}" p:username="${jdbc.username}" />

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate3.AnnotationSessionFactoryBean">

        <property name="dataSource" ref="dataSource" />

        <property name="configLocation">

            <value>
                classpath:hibernate.cfg.xml
            </value>
        </property>

        <property name="configurationClass">

            <value>
                org.hibernate.cfg.AnnotationConfiguration
            </value>
        </property>

        <property name="hibernateProperties">

            <props>

                <prop key="hibernate.dialect">
                    ${jdbc.dialect}
                </prop>

                <prop key="hibernate.show_sql">
                    true
                </prop>
            </props>
        </property>
    </bean>

    <tx:annotation-driven />

    <bean id="transactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">

        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

</beans> 
```

pom.xml

```
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>EnterpriseMarket</groupId>
    <artifactId>EnterpriseMarket</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>EnterpriseMarket</name>

    <properties>
        <spring.version>3.1.1.RELEASE</spring.version>
    </properties>

    <dependencies>

        <!-- JUnit testing framework -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>3.8.1</version>
            <scope>test</scope>
        </dependency>

        <!-- Spring framework -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-core</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-context</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <!-- Spring transaction dependency -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-tx</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <!-- Spring MVC dependency -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-web</artifactId>
            <version>${spring.version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <!-- Set this to the respective version -->
            <version>${spring.version}</version>
        </dependency>

        <!-- Spring AOP dependency -->
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2</version>
        </dependency>

        <!-- MySQL database driver -->
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.9</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.1.2</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>3.5.6-Final</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate.common</groupId>
            <artifactId>hibernate-commons-annotations</artifactId>
            <version>4.0.1.Final</version>
        </dependency>

        <!-- Hibernate library dependecy start -->
        <dependency>
            <groupId>dom4j</groupId>
            <artifactId>dom4j</artifactId>
            <version>1.6.1</version>
        </dependency>

        <dependency>
            <groupId>commons-logging</groupId>
            <artifactId>commons-logging</artifactId>
            <version>1.1.1</version>
        </dependency>

        <dependency>
            <groupId>commons-collections</groupId>
            <artifactId>commons-collections</artifactId>
            <version>3.2.1</version>
        </dependency>

        <dependency>
            <groupId>antlr</groupId>
            <artifactId>antlr</artifactId>
            <version>2.7.7</version>
        </dependency>
        <!-- Hibernate library dependecy end -->

    </dependencies>

</project> 
```

web.xml

```
 <?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    id="WebApp_ID"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5"
    xmlns="http://java.sun.com/xml/ns/javaee" >

    <display-name>
Enterprise Market
    </display-name>

    <welcome-file-list>

        <welcome-file>
list.html
        </welcome-file>
    </welcome-file-list>

    <servlet>

        <servlet-name>
spring
        </servlet-name>

        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>

        <load-on-startup>
1
        </load-on-startup>
    </servlet>

    <servlet-mapping>

        <servlet-name>
spring
        </servlet-name>

        <url-pattern>
/
        </url-pattern>
    </servlet-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:21:29.137

这是 Eclipse 中的“动态 Web 项目”吗？如果是这样，在 Eclipse 项目的构建路径中设置的**Web App Libraries**下是否列出了 spring 库？

您还在问题的标签集中列出了 [maven-3]，并包含了一个 pom.xml - 您是否使用 maven 来管理您的项目依赖项？如果是这样，Eclipse 是否“知道”这是一个 Maven 项目（右键单击该项目并选择配置 -> 转换为 Maven 项目），您现在应该能够向构建路径添加一个名为“Maven 依赖项”的库

我肯定也会检查一下：

*   [http://dnascimb.wordpress.com/2011/11/10/m2eclipse-automatic-tomcat-deployment-in-eclipse/](http://dnascimb.wordpress.com/2011/11/10/m2eclipse-automatic-tomcat-deployment-in-eclipse/)

# android - Android src：为什么它在某些项目中显示为文件夹而在其他项目中显示为包？

> ID：10046477
> 
> 赞同：1
> 
> 时间：2012-04-06T16:46:38.407
> 
> 标签：android, eclipse, directory, src

在我当前的 Eclipse 配置中，src 文件夹的显示方式不同！

正如您在下面的屏幕截图中看到的，com.WazaBe.BePlanes 显示为一个包，tof.cv.mpp 显示为文件夹...

我真的很想了解哪里出了问题并解决了这个问题。

非常感谢您的帮助！

![在此处输入图像描述](../Images/6c551f6fe7e4450ec11f3af31181fe1e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:54:51.307

问题可能与配置`build path`. `eclipse project`做这个：

```
select the src folder > right click it > "Build Path" > "Use as Source Folder" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:55:02.510

这是因为您在 Eclipse 的包资源管理器选项卡中。转到窗口-> 显示视图-> 导航器。我相信这是您正在寻找的标签。

# php - 从网址隐藏锚标记

> ID：10046482
> 
> 赞同：-4
> 
> 时间：2012-04-06T16:47:08.703
> 
> 标签：php, javascript, html, anchor

> **可能重复：**
> [如何从 URL 中隐藏锚标记](https://stackoverflow.com/questions/10045303/how-to-hide-anchor-tag-from-url)

我有一个包含子菜单的菜单，如果每个子菜单，我都希望 onclick 将我重定向到 php 页面的 div 上：

例如，如果我想从：

Menu Menu1 --> Submenu1 我希望我的 sbmenu1 的 onclick 将我重定向到 page1#div_name 上的一个 div 上，而 URL 上没有 dipslay：www.page1.php#div_name，我只想要 www.page1.php

```
 <ul>
        <li><a href="#">Menu1</a>
            <ul>
                <li><a href="page1.php#div_name">Submenu1</a></li>
                <li><a href="page2.php#div_name">Submenu2</a></li> 
            </ul>
        </li>
    </ul> 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:07:17.937

你不能覆盖它。并且您发现的任何覆盖它的“解决方案”都会在某个时候中断。如果您不喜欢 URL 中的哈希字符串，请在 apache 级别使用 url 重写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:03:49.447

您可以在完成加载后修改 URL

```
window.history.pushState(“object or string”, “Title”, “page.php”); 
```

有关更多信息，请查看[本](http://spoiledmilk.dk/blog/html5-changing-the-browser-url-without-refreshing-page)教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:53:09.083

您可以使用 jquery scrollto 插件。如果链接不是本地链接，您可以使用 javascript 设置 cookie，这样当新页面加载时，您可以阅读并滚动页面。

# android - 实例化视图寻呼机android中的所有项目

> ID：10046484
> 
> 赞同：14
> 
> 时间：2012-04-06T16:47:13.390
> 
> 标签：android, android-viewpager

我有一个带有视图寻呼机和三个要显示的页面的活动。当活动加载时，只有前两个页面被实例化，即 pageradapter 类中的 instantiateitem 只为位置 0 和 1 调用。有没有办法实例化所有三个页面？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-06T16:51:54.997

尝试[setOffScreenPageLimit(2)](http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOffscreenPageLimit%28int%29)。默认情况下，仅实例化左侧和右侧的一页。通过设置为 2 它应该实例化你的 3 页。

# c++ - 错误 LNK2005，已定义？

> ID：10046485
> 
> 赞同：77
> 
> 时间：2012-04-06T16:47:32.673
> 
> 标签：c++

我在 Win32 控制台应用程序中有 2 个文件，A.cpp 和 B.cpp。

两个文件都只包含以下两行代码：

```
#include "stdafx.h"
int k; 
```

编译时会产生错误

```
Error   1   error LNK2005: "int k" (?a@@3HA) already defined in A.obj 
```

我不明白发生了什么。

有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-04-06T16:50:03.753

**为什么会出现这个错误？**

您违反了**[一个定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)**，因此出现了链接错误。

**建议的解决方案：**

* * *

如果您在两个 cpp 文件中需要相同的命名变量，那么您需要使用无名命名空间（匿名命名空间）来避免错误。

```
namespace 
{
    int k;
} 
```

* * *

如果您需要在多个文件之间共享相同的变量，那么您需要使用`extern`.

**啊**

```
extern int k; 
```

**A.cpp**

```
#include "A.h"
int k = 0; 
```

**B.cpp**

```
#include "A.h"

//Use `k` anywhere in the file 
```

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2013-11-02T10:19:48.610

在项目的设置中，添加 `/FORCE:MULTIPLE`到链接器的**命令行**选项。

来自[MSDN](https://msdn.microsoft.com/en-us/library/70abkas3.aspx)：“使用 /FORCE:MULTIPLE 创建一个输出文件，无论 LINK 是否为一个符号找到多个定义。”

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-06T16:52:41.463

如果您希望两者都引用同一个变量，其中一个应该有`int k;`，另一个应该有`extern int k;`

对于这种情况，您通常将定义 ( `int k;`) 放在一个`.cpp`文件中，并将声明 ( `extern int k;`) 放在标题中，以便在您需要访问该变量的任何地方包含。

如果您希望每个`k`变量都是恰好具有相同名称的单独变量，则可以将它们标记为`static`，例如：（`static int k;`在所有文件中，或至少在一个文件中）。或者，您可以使用匿名命名空间：

```
namespace { 
   int k;
}; 
```

同样，除了最多一个文件之外的所有文件。

在 C 中，编译器通常对此并不那么挑剔。具体来说，C 有一个“暂定定义”的概念，所以如果你有`int k;`两次类似的东西（在相同或不同的源文件中），每个都将被视为一个暂定定义，它们之间不会发生冲突。但是，这可能有点令人困惑，因为您仍然不能有两个都包含初始化程序的定义——带有初始化程序的定义始终是完整定义，而不是暂定定义。换句话说，`int k = 1;`出现两次是错误的，但`int k;`在一个地方和`int k = 1;`另一个地方不会。在这种情况下， the`int k;`将被视为暂定定义，而the 将被视为`int k = 1;`定义（并且两者都引用相同的变量）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-06T16:50:30.610

假设您希望 'k' 在不同的 .cpp 文件中成为不同的值（因此声明了两次），请尝试将两个文件更改为

```
namespace {
    int k;
} 
```

这保证了名称“k”在翻译单元中唯一标识“k”。旧版本`static int k;`已弃用。

如果您希望它们指向相同的值，请将其更改为`extern int k;`.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-04-06T16:54:08.530

两个文件都将变量定义`k`为整数 ( `int`)。

结果，链接器看到两个具有相同名称的变量，如果您曾经引用`k`​​ .

要解决此问题，请将*其中一个*声明更改为：

```
extern int k; 
```

这意味着：*“k 是一个整数，在这里声明，但在外部定义（即另一个文件）。”*

现在只有一个变量`k`，可以被两个不同的文件正确引用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-06T16:52:13.760

如果你想让这些翻译单元共享这个变量，在 A.cpp 中定义`int k;`并放入`extern int k;`B.cpp。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-04-12T20:59:40.310

头文件中的存在`int k;`会导致在包含此头文件的每个翻译单元中定义符号`k`，而链接器希望它只定义一次（又名一个定义规则违规）。

虽然涉及`extern`的建议没有错，但`extern`它是一种 C 主义，不应使用。

允许在多个翻译单元中定义头文件中的变量而不导致 ODR 违规的 C++17 前解决方案将转换为模板：

```
template<typename x_Dummy = void> class
t_HeaderVariableHolder
{
    public: static int s_k;
};

template<typename x_Dummy> int t_HeaderVariableHolder<x_Dummy>::s_k{};

// Getter is necessary to decouple variable storage implementation details from access to it.
inline int & Get_K() noexcept
{
    return t_HeaderVariableHolder<>::s_k;
} 
```

使用 C++17，事情变得更加简单，因为它允许`inline`变量：

```
inline int g_k{};

// Getter is necessary to decouple variable storage implementation details from access to it.
inline int & Get_K() noexcept
{
    return g_k;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-06T16:54:46.213

链接器告诉您该变量`k`定义了多次。实际上，您在 A.cpp 中有一个定义，在 B.cpp 中有另一个定义。两个编译单元都会生成相应的目标文件，链接器使用该目标文件来创建您的程序。问题是，在您的情况下，链接器不知道`k`要使用哪个定义。在 C++ 中，同一构造（变量、类型、函数）只能有一个定义。

要解决它，你必须决定你的目标是什么

*   如果你想有两个变量，都命名`k`，你可以在两个 .cpp 文件中使用匿名命名空间，然后`k`像现在一样引用：

.

```
namespace {
  int k;
} 
```

*   您可以将其中一个`k`s 重命名为其他名称，从而避免重复定义。
*   如果您只想`k`在两个 .cpp 文件中定义并使用它，则需要在一个中声明为`extern int k;`，并在另一个中保留原样。这将告诉链接器在两种情况下都使用一个定义（未更改的版本）——`extern`意味着该变量是在另一个编译单元中定义的。

# python - 在 Celery 中，如何更新主任务的状态，直到他的所有子任务都完成？

> ID：10046486
> 
> 赞同：5
> 
> 时间：2012-04-06T16:47:35.743
> 
> 标签：python, django, celery

在 Celery 中，我正在运行一个主任务，它为从查询中获得的每个项目运行一个子任务。子任务应该并行运行。在 UI 上，我有一个进度条，显示总共完成了多少子任务。我正在更新主要任务状态以将信息提供给进度条。我的问题是主要任务在将所有子任务推送到代理后立即结束，因此我无法再更新他的状态。我希望主要任务可以等到所有子任务完成。是否可以？还有其他解决方案吗？这是我的伪代码（真实代码不使用全局 ;-)）。

```
total = 0
done = 0

@task(ignore_result=True)
def copy_media(path):
    global total, done
    copy_media.update_state(state=STARTED, meta={'total': total, 'done': done})
    documents = Document.objects.all()
    total = documents.count()
    copy_media.update_state(state=STARTED, meta={'total': total, 'done': done})
    for document in documents:
        process_doc.delay(document, path, copy_media)

@task(ignore_result=True)
def process_doc(document, path, copy_media):
    global total, done
    # Do some stuff
    done += 1
    copy_media.update_state(state=STARTED, meta={'total': total, 'done': done}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T21:30:37.510

我找到了一种使用`TaskSet`. 但我并不完全满意，因为我不能忽略子任务的结果。如果我忽略`process_doc`任务的结果`results.ready()`总是返回`False`，`results.completed_count()`总是返回 0，等等。这是代码：

```
@task(ignore_result=True)
def copy_media(path):
    copy_media.update_state(state=STARTED, meta={'total': total, 'done': done})
    documents = Document.objects.all()
    total = documents.count()
    copy_media.update_state(state=STARTED, meta={'total': total, 'done': done})
    job = TaskSet(tasks=[process_doc.subtask((document, path))
                         for document in documents])
    results = job.apply_async()
    doc_name = ''
    while not results.ready():
        done = results.completed_count()
        if done:
            last = done - 1
            for idx in xrange(last, -1, -1):
                if results[idx].ready():
                    doc_name = results[idx].result
                    break
        copy_media.update_state(state=STARTED, meta={'total': total, 'done': done, 'doc-name': doc_name})
        time.sleep(0.25)

@task()
def process_doc(document, path):
    # Do some stuff
    return document 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:37:15.647

您可以使用 memcached 支持的缓存来存储完整任务的数量。甚至`cache.inrc`在 django 缓存 API 中用于原子增量，以确保计数的并发更新不会搞砸。

此外，保持主任务运行直到所有子任务完成是个坏主意，因为你基本上会长时间阻止一个芹菜工人。如果 celery 与一个工作进程一起运行，这将导致永无止境的锁定。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-10T13:45:53.033

我不知道您正在运行哪个版本的 celery，但您可以查看[Group](http://docs.celeryproject.org/en/latest/userguide/canvas.html#groups)子任务（3.0 中的新功能）。

# spring - 更新了 Spring MVC 框架教程

> ID：10046487
> 
> 赞同：4
> 
> 时间：2012-04-06T16:47:40.840
> 
> 标签：spring, spring-mvc

是否有任何更新的教程或类似的东西 - [http://static.springsource.org/docs/Spring-MVC-step-by-step/](http://static.springsource.org/docs/Spring-MVC-step-by-step/)？

我喜欢本教程，因为它逐步介绍了一个简单的系统。但是它已经过时了，包括 Spring 站点在内的所有其他教程都没有清晰的教程。当这个主题展示构建一个包含各种元素的简单系统时，它们展示了一个主题。最新的spring框架有没有类似的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-08T07:12:43.287

一个更好的版本怎么样？

[这](http://blog.springsource.org/2010/07/22/spring-mvc-3-showcase/)是来自**Keith Donald的****SPRINGSOURCE 博客**的**SPRING MVC 3**展示。

 ****> 我整理的第一个展示是针对我们的 Web 框架 Spring MVC 3。它包括一个示例项目，以及支持的幻灯片演示和截屏视频。深入了解后，您应该对 Spring MVC 可以做什么有一个很好的了解，并感受到它的易用性。

它包含用户指南、功能的视频演示和托管在[github](https://github.com/SpringSource/spring-mvc-showcase)上的工作源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-03T18:03:41.737

有很多书籍（例如 Spring In Action）和教程可供您查阅。

一个使用 Spring Framework MVC 3.1 的在线教程。我推荐的注释是：[Spring Framework MVC 3.1 Tutorial](http://www.flacom.com/spring-framework-mvc-3-1-tutorial "Spring Framework MVC 3.1 教程 - Flacom")

该教程还不是很全面，但是在每一步中都会指导您如何制作一个有效的 Web 应用程序。完整的源代码也可供下载。

祝你学习 Spring 框架好运。****

# r - 使用 ggplot 的“annotation_raster”并达到 R 的“内存上限”

> ID：10046489
> 
> 赞同：1
> 
> 时间：2012-04-06T16:47:48.333
> 
> 标签：r, memory-management, annotations, ggplot2, raster

我正在使用 R 创建具有如下几层的房屋的平面图，从底层开始：

*   `basemap`：平面图的扫描版，我把它放在底层以帮助阅读
*   `bed`：房子有几十张床，分散在房子的不同房间里，根据住户的特点有不同的颜色
*   `piechart`：每张床上面都有一个饼图，饼图也是根据住户的其他特征创建的，有的床有饼图，有的没有。

`bed`和`piechart`是基于基于底图创建的shp文件创建的（即我使用Mapwindow创建矢量图层，将底图作为栅格图层导入并放在底部，然后一张一张地绘制床。床的shp文件然后将其导入R，计算床多边形的质心，该质心有助于定位饼图）

我`read.jpeg`以前是导入`basemap`to`imagematrix`对象，然后用新`annotation_raster`函数in`ggplot2 0.9`把`basemap`最下面的地图图层，由于`bed`图层也是基于图层创建的`basemap`，图层完美`bed`叠加在图层上。`basemap``ggplot2`

我可以毫无问题地创建地图 - 如果`basemap`足够小（`3000 x 3000`像素），现在我有一个`basemap`像素`8000+ x 3000+`（`object.size`241823624 字节），我在创建 shp 文件时没有意识到 R 内存问题，`ggplot`可以编译对象如果我`annotation_raster`禁用了，但 R 一直说我可以在尝试将 xxxMB 包含`basemap`到`ggplot`对象中时分配内存。

我认为这与 jpg 文件的压缩无关，因为即使我进一步压缩 jpg 文件，尺寸也不会改变。但是我无法调整 jpg 文件的大小，因为我的`bed`图层是根据原始 jpg 文件的尺寸创建的。

`basemap`任何人都可以在不改变 jpeg 尺寸或其他一些技巧来处理 R 的内存限制的情况下帮助缩小图像矩阵的大小吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T18:15:59.553

我修好了它。

我首先创建了一个`basemap`宽度和高度减半的新图像文件，然后`annotation_raster`我做了以下操作：

```
chart <- chart + annotation_raster(db$temp.basemap,
                                   xmin=0,
                                   xmax=basemap.xlength*2,  # I stretched the image in R
                                   ymin=0,
                                   ymax=basemap.ylength*2)  # I stretched the image in R 
```

现在地图可以在 R 的内存限制内编译，我能想到的缺点是图像质量的降低，但这是可以忍受的，就像它`8000 x 3000`最初一样。

# web-services - 什么时候应该使用 RESTful？

> ID：10046494
> 
> 赞同：0
> 
> 时间：2012-04-06T16:48:04.480
> 
> 标签：web-services, rest

我不完全知道 RESTFUL 是什么。当然，我知道这是 URL 到资源的映射。但这与 ajax 调用回显一些 JSON 的 codeigniter URL 有何不同？

我的应用程序将订阅带有状态/选项的订阅，当用户切换订阅的某些选项时，是否有任何理由我应该使用 RESTful 设置，而不仅仅是一些 ajax 调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:22:16.830

您不一定要使用“纯”REST。如果您的需求驱使您使用返回 JSON 的基于 HTTP 的服务，那就太好了。但这并不意味着您需要 REST 架构风格的其他方面。您可能不需要：

1.  一种基于资源的架构，在某种意义上它们是由 HTTP 协议定义的
2.  映射到资源的 URL 结构
3.  您可能不希望一个请求的返回结果提供一组 URL，这些 URL 指示相关请求的“去哪里”。

REST 是一种架构风格，但它也可以成为一种“宗教”。确保您所做的任何事情都是由您需要满足的要求驱动的，而不是基于“意识形态”。

# c# - 转换 IEnumerable 到 JsonArray

> ID：10046496
> 
> 赞同：2
> 
> 时间：2012-04-06T16:48:22.107
> 
> 标签：c#, linq

我正在`IEnumerable<dynamic>`使用 Rob Conery 的 Massive 框架从数据库中选择一个。该结构以平面格式 Poco C# 返回。我需要转换数据并将其输出到 Json 数组（格式显示在底部）。

我以为我可以使用 linq 进行转换（我的失败如下所示）：

```
using System.Collections.Generic;
using System.Json;
using System.Linq;
using System.ServiceModel.Web;

....
    IEnumerable<dynamic> list = _repository.All("", "", 0).ToList();

    JsonArray returnValue = from item in list
                            select new JsonObject()
                                       {
                                               Name = item.Test,
                                               Data = new dyamic(){...}...
                                       }; 
```

这是我要生成的 Json：

```
[
    {
        "id": "1",
        "title": "Data Title",
        "data": [
            {
                "column1 name": "the value",
                "column2 name": "the value",
                "column3 name": "",
                "column4 name": "the value"
            }
        ]
    },
    {
        "id": "2",
        "title": "Data Title",
        "data": [
            {
                "column1 name": "the value",
                "column2 name": "the value",
                "column3 name": "the value",
                "column4 name": "the value"
            }
        ]
    }
] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:26:04.003

这是一个使用[Json.Net的示例](http://json.codeplex.com/)

```
List<int> list = new List<int>() {1 , 2};

string json = JsonConvert.SerializeObject(
                  list.Select(x => new{
                      id = x.ToString(),
                      title = "title " + x.ToString(),
                      data = Enumerable.Range(3,2).Select(i=> new {column1=i,column2=i*i})
                    })
                  , Newtonsoft.Json.Formatting.Indented
                ); 
```

输出：

```
[
  {
    "id": "1",
    "title": "title 1",
    "data": [
      {
        "column1": 3,
        "column2": 9
      },
      {
        "column1": 4,
        "column2": 16
      }
    ]
  },
  {
    "id": "2",
    "title": "title 2",
    "data": [
      {
        "column1": 3,
        "column2": 9
      },
      {
        "column1": 4,
        "column2": 16
      }
    ]
  }
] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:43:03.360

好的，这就是我最终得到的结果，这一切看起来都很棒：

```
 [WebGet(UriTemplate = "/tools/data/get?tool={tool}&filters={filters}")]
    public JsonArray GetData(string tool, string[,] filters)
    {
        IEnumerable<dynamic> list = _repository.All("", "", 0).ToList();

        IEnumerable<JsonObject> jsonList = from item in list
                                select new JsonObject()
                                           {
                                               new KeyValuePair<string, JsonValue>("Id", item.Id),
                                               new KeyValuePair<string, JsonValue>("Name", item.Title),
                                               new KeyValuePair<string, JsonValue>("Data", new JsonObject()
                                                                                               {
                                                                                                    new KeyValuePair<string, JsonValue>("Product", item.Product),
                                                                                                    new KeyValuePair<string, JsonValue>("Suite", item.Suite),
                                                                                                    new KeyValuePair<string, JsonValue>("Package", item.Package),
                                                                                                    new KeyValuePair<string, JsonValue>("Description", item.Description)
                                                                                               })

                                           };

        JsonArray returnValue = new JsonArray(jsonList);

        return returnValue;
    } 
```

# mysql - SELECT COUNT 基于同一张表中的另一行

> ID：10046497
> 
> 赞同：2
> 
> 时间：2012-04-06T16:48:25.450
> 
> 标签：mysql, sql

如何根据 SAME TABLE 中的 ANOTHER ROW 选择一个COUNT，**这样**它就**不会****计算**重复值？

 ****我想选择 COUNT(id) 作为 TOTAL，每封电子邮件只选择一次。

**这是我的出发点：**

```
SELECT COUNT(id) AS total 
FROM entries 
WHERE tracking_code = 'test2' 
```

**我想要完成的是这样的：**

```
SELECT COUNT(id) AS total 
FROM entries 
WHERE id IN (SELECT DISTINCT email FROM entries) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T16:49:34.193

尝试这个：

```
select count(distinct email) from entries 
```****

# node.js - 将值从 sqlite3 db 复制到 node.js 中的全局数组

> ID：10046499
> 
> 赞同：1
> 
> 时间：2012-04-06T16:48:31.010
> 
> 标签：node.js, sqlite

我使用了 node_sqlite3 模块，并尝试了以下示例：

```
var sqlite = require('sqlite3').verbose();
var db = new sqlite.Database("/var/www/signals/db/app3.db");

var matrixSignals = new Array();
var i;

i = 0;
db.all('SELECT * FROM tbl_signals', function(err,rows){
    rows.forEach(function(row) {
        matrixSignals[i] = new Object();
        matrixSignals[i].signalID = row.signalID;
        matrixSignals[i].connID = row.connID;
        i++;
    });
    db.close();
    console.log('1:' + matrixSignals.length);
});
console.log('2:' + matrixSignals.length); 
```

在控制台输出 1 中，长度是正确的，但在控制台输出 2 中，长度始终为 0。我如何将 matrixSignals 设置为全局变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:22:51.217

这不起作用的原因与 Node.js 的一般操作方式有关。在node中，所有代码都是异步执行的；在您记录输出 2 时，matrixSignals 的长度仍然为 0。这是因为在您触发数据库查询后，代码会继续执行。日志输出 1 仅在数据库查询完成*后*执行，这就是它返回正确结果的原因。

出于这个原因，您的问题的简单答案是无法将 matrixSignals 设置为全局变量。如果您的所有逻辑都真正依赖于该数组中的值，那么您的逻辑应该在数据库调用的回调中 - 这样它只有在从数据库中检索到数据后才执行该代码。如果你只是想让语法更简洁，你可能会使用 node-promise (https://github.com/kriszyp/node-promise) 之类的东西，但我认为这可能比它的价值更多。

# mysql - JRuby JDBC-mysql错误

> ID：10046502
> 
> 赞同：0
> 
> 时间：2012-04-06T16:48:49.160
> 
> 标签：mysql, jdbc, jruby

我有 JRuby + Swing 应用程序并想在`jdbc/mysql`那里添加

```
require "jdbc/mysql" 
```

但是当我尝试运行它时，出现以下错误：

```
LoadError: no such file to load -- jdbc/mysql
  require at org/jruby/RubyKernel.java:1033
   (root) at olap_frontend.rb:3 
```

我的宝石清单：

```
*** LOCAL GEMS ***

activerecord-jdbc-adapter (1.2.2)
activerecord-jdbcmysql-adapter (1.2.2)
bouncy-castle-java (1.5.0146.1)
bundler (1.1.3 ruby)
jdbc-mysql (5.1.13)
jruby-launcher (1.0.12 java)
jruby-openssl (0.7.6.1)
rake (0.9.2, 0.8.7)
rubygems-bundler (0.3.0 ruby) 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T03:26:02.570

这是我的错 - 我需要先`rubygems`要求

# widget - 如何将 twitter 小部件脚本放入脚本文件

> ID：10046503
> 
> 赞同：0
> 
> 时间：2012-04-06T16:49:00.697
> 
> 标签：widget, twitter

我创建了 twitter 搜索小部件。

```
 <script>
           new TWTR.Widget({
               version: 2,
               type: 'search',
               search: 'TulaDev',
               interval: 10000,
               title: '',
               subject: '',
               width: 295,
               height: 297,
               theme: {
                   shell: {
                       background: '#ffffff',
                       color: '#ffffff'
                   },
                   tweets: {
                       background: '#ffffff',
                       color: '#444444',
                       links: '#1985b5'
                   }
               },
               features: {
                   scrollbar: false,
                   loop: true,
                   live: true,
                   behavior: 'default'
               }
           }).render().start();           
        </script> 
```

当我将它放到单独的 .js 文件中时，它不起作用。是否可以将它放在单独的文件中并在脚本必须显示小部件的地方设置 div 元素？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-08T10:01:42.700

尝试添加

`<script src="http://widgets.twimg.com/j/2/widget.js"></script>`

与您所拥有的文件一起添加到单独的文件中。

# verilog - Verilog reg 分配给另一个 reg 的一部分

> ID：10046508
> 
> 赞同：2
> 
> 时间：2012-04-06T16:49:23.447
> 
> 标签：verilog

我将 Verilog 与 modelSim 一起使用，当我尝试将 reg 变量分配给另一个 reg 变量的不同部分时出现以下错误：

```
** Error: Range width must be greater than zero.
** Error: Range width must be constant expression. 
```

这是相关代码：

```
 integer f; //zd, qd, R and Q are regs

    always @ * begin 
    f = 52 - zd; 
    R = qd[f +:0]; 
    Q = qd[63 -:f+1]; 
    end 
```

我希望 R 包括 qd（从 0 到 f），而 Q 是（其余的）qd（从 f+1 到 63）。怎么做？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:01:59.047

你试图做的在verilog 2001中是不合法的。

正如您的警告所说，`Range width must be constant expression`即您不能选择可变长度的部分。

您可以选择改变起点的固定长度部分（即选择从 开始的 8 位`f`），但其语法是这样的：

```
vector_name[starting_bit_number +: part_select_width]
vector_name[starting_bit_number -: part_select_width] 
```

在硬件中，总线的大小必须是固定大小，您不能根据寄存器的内容更改硅中的线数:)

# internet-explorer - 有没有办法监听 Internet Explorer 扩展中设置的 cookie？

> ID：10046513
> 
> 赞同：0
> 
> 时间：2012-04-06T16:49:51.747
> 
> 标签：internet-explorer, cookies

我正在尝试为 Internet Explorer 创建一个扩展，它可以在设置 cookie 时对其进行处理。

在 Firefox 和 Google Chrome 中有一种方法可以做到这一点，所以我想知道它是否也可以在 IE 中完成。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:00:39.367

请阅读[本文](http://www.nirsoft.net/utils/internet_explorer_cookies_view.html)，您将获得一个想法！

# objective-c - 我无法从目标 c 上的 URL 解析 xml

> ID：10046518
> 
> 赞同：0
> 
> 时间：2012-04-06T16:50:33.030
> 
> 标签：objective-c, nsxmlparser

我是 Objective C 的初学者，我想从 URL 解析一个 XML 文件，我找到了一些关于 NSXMLPARSER 的示例代码，我编写了这段代码，但它不起作用。

请帮我。

我的 xml 文件是：

```
<list>
<first>apple</first>
</list> 
```

...我的 ViewController.h

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <NSXMLParserDelegate>  {

}
@property (weak, nonatomic) IBOutlet UITextView *myTextField;

@end 
```

...我的 ViewController.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController @synthesize myTextField;
- (void)parseXMLFileAtURL:(NSString *)URL { 
    NSURL * xmlURL = [NSURL URLWithString:URL];
    NSXMLParser * rssparser = [[NSXMLParser alloc] initWithContentsOfURL:xmlURL];
    [rssparser setDelegate:self];
    [rssparser parse];
}

- (void)parser:(NSXMLParser *)parser 
didStartElement:(NSString *)elementName 
  namespaceURI:(NSString *)namespaceURI 
 qualifiedName:(NSString *)qName 
    attributes:(NSDictionary*)attributeDict {           

    if ([elementName isEqualToString:@"list"]) {
        // clear out our story item caches...
        myTextField.text = [attributeDict objectForKey:@"first"];
    }
}

- (void)viewDidLoad {
    NSString * path = @"http://example.com";
    [self parseXMLFileAtURL:path];
    [super viewDidLoad];    // Do any additional setup after loading the view, typically from a nib. 
}

- (void)viewDidUnload {
    [self setMyTextField:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view. 
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown); 
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T13:40:49.877

你不应该声明这是 ViewController - 这是一个非常糟糕的设计。创建一个新类（例如 XMLParser: `@interface XMLParser : NSObject <NSXMLParserDelegate>`） 现在调用初始化方法 parse。下面的示例代码：

```
-(id)init
{
    self = [super init];

    parser = [[NSXMLParser alloc] initWithContentsOfURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"guidef" ofType:@"xml"]]];

    [parser setDelegate:self];
    [parser parse];

    return self;
} 
```

现在你可以声明你的方法了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T13:56:57.460

attributeDict 仅包含属性值...

```
<first name="something" last="something" > <sec>some</sec></first> 
```

因此，当您将 elementName 作为**第一个**attributeDict 时，将具有*“name”*和*“last”*以及其他属性而不是子元素**sec**

# objective-c - 将键添加到 iPad 键盘

> ID：10046523
> 
> 赞同：2
> 
> 时间：2012-04-06T16:50:50.910
> 
> 标签：objective-c, ios, ipad, keyboard, jailbreak

我目前正在开发一个 iPad 应用程序，我的客户希望在我已经完成的键盘顶部添加功能键，就像在普通键盘中一样。问题是他想要 iPad 系统键盘上的“Fn”键，点击时会显示功能键。

不越狱可以吗？因为他给我发了一些完成的照片..但我用谷歌搜索了很多，但我找不到任何苹果的文件说“如果它干扰系统键盘或类似的东西，应用程序将被拒绝..

任何关于如何在键盘上添加 Fn 键的指示或我可以展示以说服他的东西，非常感谢..

编辑：添加解决方案，但前提是您想了解如何做到这一点..但这**不是您应该为真正的应用程序做的事情**

[按照此链接](http://www.iphonedevsdk.com/forum/iphone-sdk-tutorials/7350-adding-subviews-custimize-keyboard.html)查找 iPad 的 KEYBOARD 层注意：您需要`UIPeripheralHostView`在 iPad 上检查，UIKeyboard 适用于 iPhone。

在找到 UIPeripheralHostView 的最终 if 条件之后，为其子视图添加一个循环并检查条件`UIKeyboardAutomatic`

完成之后..您需要像iOS一样进行递归调用来执行`HitTest` CGPoint，这取决于您要在哪里添加密钥，在我的情况下，它就像右下角的CGPoint(50,290)一样。

因此，在将 CGPoint 转换为父视图的局部坐标系时，在子视图中保持循环（在找到 UIKeyboardAutomatic 后，您可以从*nil父视图开始。*

最终返回条件是您的视图是否属于类`UIKBKeyView`并且它可以响应您的 hitTest 点。你得到了你的关键视图和它的父级......现在添加你想要添加的任何东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:55:17.157

Wolfram Alpha 应用程序做了类似的事情。当显示键盘时，他们会在其正上方添加自己的视图。他们正在使用`-inputAccessoryView`. 有关更多信息，请参阅[https://developer.apple.com/library/ios/#documentation/uikit/reference/UITextView_Class/Reference/UITextView.html](https://developer.apple.com/library/ios/#documentation/uikit/reference/UITextView_Class/Reference/UITextView.html)。

您也可以将键盘完全替换为`-inputView`.

# php - 类构造函数干扰另一个类

> ID：10046528
> 
> 赞同：5
> 
> 时间：2012-04-06T16:51:05.557
> 
> 标签：php, class, function, variables, constructor

本质上，我只是创建了两个类，其中一个类（在本例中为 A 类）在另一个类（在本例中为 B 类）中运行一个函数，以从数据库中获取一些信息。

但是，当`B_runtime()`实际调用数据库时，我得到了错误`Cannot access protected property A::$db`。

我不明白的是，即使我`__construct`在两个类中都有两个，但 PDO 语句在使用 A 类的数据库连接时非常持久。

我确信这与我在 A 类中运行它的事实有关，`B_runtime()`因为如果我从 A 类之外调用它就不会发生这种情况。

我知道我可以简单地将`protected $db;`A 类中的变量更改为公共变量，但是，我真的很好奇如何解决这个问题。

```
ob_start();
include('/config.php');
ob_end_clean();

$A = new A($db);
$B = new B($db);

echo $A->A_runtime();

class A{
    protected $db;
    public function __construct($db){
       $this->db = $db;
    }
    public function A_runtime(){
        return B::B_runtime();      
    }
}

class B{
    protected $db;
    public function __construct($db){
       $this->db = $db;
    }
    public function B_runtime(){
        $preparedStatement = $this->db->prepare('SELECT * FROM z_mod_html WHERE ModuleLink = :moduleid LIMIT 1');
        $preparedStatement->execute(array(':moduleid' => '1'));
        $rows = $preparedStatement->fetchAll();
        return $rows[0]['HTML'];
    }
} 
```

很抱歉有大量代码 - 如果有人有任何想法或建议，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:58:50.143

您可以将 B 的实例传递给该方法。这样，您还可以定义方法对 B 类的依赖性。

```
$A = new A($db);
$B = new B($db);

echo $A->A_runtime($B);

class A{
    //...
    public function A_runtime($instance){
        return $instance -> B_runtime();      
    }
} 
```

你甚至可以在 PHP 5 中使用[类型提示](http://php.net/manual/en/language.oop5.typehinting.php)来表示你期望那里有一个 B 类的实例：

```
 public function A_runtime(B $instance){ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T17:09:11.477

哦。

首先，您将非静态方法作为静态方法调用。

```
B::B_runtime(); 
```

仅当 B_runtime 被声明为静态方法时才应以这种方式使用

```
static public function B_runtime(){ 
```

其次，您的班级具有通常被认为不好的外部依赖性。一个类应该只依赖给它的东西，而不是全局变量。这称为依赖倒置原则。如果一个类依赖于某些东西，你应该通过一个参数给它这个依赖，甚至更好的是，使用类型提示来确保依赖具有你期望的方法。

```
public function A_runtime(B $object_b){ 
```

为了更进一步，您还应该使用抽象或接口来进行类型提示，而不是使用具体类。这样，如果有必要，您可以将 B 换成不同版本的 B。

```
interface BInterface {
   public function B_runtime();
} 
```

然后

```
public function A_runtime(BInterface $object_b){ 
```

阅读 OO 设计的 SOLID 原则。

[http://en.wikipedia.org/wiki/SOLID_](http://en.wikipedia.org/wiki/SOLID_(object-oriented_design) (面向对象设计)

# ipad - iPad用户界面设计建议

> ID：10046529
> 
> 赞同：0
> 
> 时间：2012-04-06T16:51:08.570
> 
> 标签：ipad, user-interface, ui-design

我正在编写我的第一个原生 iPad 应用程序，我有一个一般的 UI 问题。我在用户界面设计方面很**糟糕**，我正在寻找关于我的布局使用什么的一般指导。具体来说，我有一个非常简单的主细节应用程序，它非常适合 XCode 提供的通用应用程序模板。该应用程序会跟踪设备的检查日期。我有一个主视图，人们可以在其中输入有关特定设备的信息（品牌、型号、序列号、姓名、位置、联系人、电子邮件、电话等）。主视图仅显示位置和名称。当他们单击主视图时，所有数据都显示在详细视图中。

每个设备都需要进行年度检查，并且需要填写一份标准表格。有 20 项要检查，我需要收集/显示标签（检查步骤）、状态（通过/失败/无论如何）和通用文本的注释字段。

所以我需要执行检查。我可以手动布局 20 个 uilabels、20 个 ON/OFF 开关（或 3 个位置）和 20 个 UITextView，但这听起来很笨拙。我可以将这三个项目放在自定义 UITableViewCell 中，但我也不太习惯这也是正确的 UI 方法。

您如何将现有的纸质流程（从打印的 pdf 文件开始）映射到 iPad 应用程序？你会让它看起来尽可能像旧纸吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:04:36.327

我学到的一件事是，当人们对信息的呈现方式有期望时，你应该遵守这个期望。这就是 Apple 为一般应用程序开发制定界面指南的原因。但是，在您的情况下，您的指南应该是您的用户已经期望的。如果这与 Apple 的指导方针不同，我建议您严重倾向于用户的期望。在这种情况下，他们可能会期待纸质表格的设置方式。

如果没有看到原始纸质表格，很难建议您如何将其转换为主/明细格式，同时符合纸质表格设定的期望。

但是，您可能会发现通过添加允许他们专注于单个设备的视图来增强它会有所帮助，显示您提到的三个字段以及主/详细信息排列。同时，他们应该能够恢复到他们熟悉的视图，即使只是查看状态（而不是更新状态）。

# java - 如何删除文本文件中的重复短语？

> ID：10046531
> 
> 赞同：0
> 
> 时间：2012-04-06T16:51:32.763
> 
> 标签：java, c++, regex, duplicate-removal

好的，所以我在这个文件中有大约 1000 个重复的短语，所以手动执行此操作不是一种选择。请注意，这些是短语，而不是行或单词，每个“短语”大约有 10 行长。

我试图摆脱重复的短语，但唯一使“项目”（或短语）重复的是位置语法。例如：

```
 class Item0
    {
        position[]={4347.6001,0,3214.6399};
        azimut=128.81599;
        special="NONE";
        id=1;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4347.6, 3214.64, 0]; this setDir 128.816;";
    };
    class Item1
    {
        position[]={4347.6001,0,3214.6399};
        azimut=128.81599;
        special="NONE";
        id=2;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4347.6, 3214.64, 0]; this setDir 128.816;";
    }; 
```

现在前面两个词组是重复的，但是 ID 和 ITEM# 是不同的，所以识别重复词组的唯一方法是通过 position[]={} 参数。当 2 个短语具有相同的位置时，这两个短语是重复的，无论 ID 或 ITEM#。

所以我的目标是使用某种类型的代码、脚本、程序或正则表达式来删除所有重复的短语，但不影响第一个重复的短语。因此，如果存在三个重复，则留下一个短语，但删除两个短语。我该怎么做呢？

* * *

*所需输入/输出的示例：*

## **输入：**

```
 class Item0
    {
        position[]={4347.6001,0,3214.6399};
        azimut=128.81599;
        special="NONE";
        id=1;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4347.6, 3214.64, 0]; this setDir 128.816;";
    };
        class Item1
    {
        position[]={4682.6001,0,3847.6399};
        azimut=128.81599;
        special="NONE";
        id=2;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4682.6, 3847.64, 0]; this setDir 128.816;";
    };
        class Item2
    {
        position[]={4347.6001,0,3214.6399};
        azimut=128.81599;
        special="NONE";
        id=3;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4347.6, 3214.64, 0]; this setDir 128.816;";
    }; 
```

## **输出：**

```
 class Item0
    {
        position[]={4347.6001,0,3214.6399};
        azimut=128.81599;
        special="NONE";
        id=1;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4347.6, 3214.64, 0]; this setDir 128.816;";
    };
        class Item1
    {
        position[]={4682.6001,0,3847.6399};
        azimut=128.81599;
        special="NONE";
        id=2;
        side="EMPTY";
        vehicle="Land_fortified_nest_small";
        lock="UNLOCKED";
        skill=0.2;
        init="this setPos [4682.6, 3847.64, 0]; this setDir 128.816;";
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:12:32.473

如果它是类类型，那么您可以考虑使用 SET 并添加类元素。

```
 Set<Item> itemSet  = new HashSet<Item>;
      itemSet.add(new Item()); 
```

在添加所有项目结束时，您将只保留独特的项目。

您可以将 id 排除在争用之外，并且仍然通过检查项目是否已插入来检查插入的 id。考虑到 ID 是有序的，这将起作用。为了将 id 排除在外，请使用具有相同数据成员（不包括 id）的新类。

我使用了一个不同的例子（它很容易构建）希望它有所帮助

```
 int item[] = null;
    int offset = 0;
    int counter = 0;
    ArrayList<Integer> duplicateids = new ArrayList<Integer>();
    Set<Integer> afterDups= new HashSet<Integer>();
    for (int i : item) {
        counter++;
        //you can create a new class excluding the id and initialize it here
        if(!afterDups.add(i))
            duplicateids.add(counter);
    } 
```

编辑 ：

好的，我错过了从文件中挑选的东西，所以添加了这个答案。您可以检查每一行，并且鉴于您的文件是这种形式，您不会喜欢比较`Class Item0`和`id=1;`行。休息一下，您可以逐行读取文件并将其放在字符串中。一旦一个类完成（由行的开头表示为`class`），您可以设置为文本创建另一个字符串。您将数据与凭证（`id`和`class`）分开。使用分隔符，您可以从中再次拆分字符串并重新创建文件。

```
public static void main(String args[])
{
    try{
        FileInputStream fstream = new FileInputStream("file.txt");
        DataInputStream in = new DataInputStream(fstream);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        String strLine;
        String seperator = "$$";
        //this contains the $$ seperated class data items
        String currentClassText = "";
        //this contains the $$ seperated class name the opening braces and the closing braces
        String  currentClassCredentilas= "";
        Set<String> texts = new HashSet<String>();
        ArrayList<String> credentials = new ArrayList<String>();
        while ((strLine = br.readLine()) != null)   {
            if(strLine.contains("id=") || strLine.contains("class") || strLine.contains("};"))
                currentClassCredentilas.concat(strLine + seperator);
            else
                currentClassText.concat(strLine + seperator);

            //check if the class has completed
            if(strLine.contains("};")){
                //text is not a duplicate
                if(texts.add(currentClassText)){
                    credentials.add(currentClassCredentilas + seperator);
                }
                //set everything back to empty for the next round
                currentClassCredentilas = currentClassText = "";
            }
            System.out.println (strLine);
        }
        in.close();
    }catch (Exception e){
        System.err.println("Error: " + e.getMessage());
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:34:36.290

我会生成每个短语的哈希值并将其存储到地图中。继续添加新短语，如果已经存在则忽略。哈希码和映射值始终是唯一的，因此您不会有重复项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T16:59:45.223

我最初的方法是：

1.  创建一个数组来存储唯一位置
2.  解析文件，如果位置在数组中，则跳过。否则，输出到文件并存储在数组中。
3.  循环直到EOF

这将为您提供您想要的，但不是最佳解决方案。考虑存储第一次遇到的项目的方法，以及稍后如何检查它（扫描数组可能需要一段时间）。

# sql-server - 根据可以具有值或为空的字段选择组内的行

> ID：10046546
> 
> 赞同：4
> 
> 时间：2012-04-06T16:52:44.010
> 
> 标签：sql-server, tsql, select, group-by, sql-server-2008-r2

从下表中为每个 IssID FieldID 组，我想选择包含最低 ChgGrpID 值的行，如果组中存在该字段为 NULL 的行，则仍然选择最低的非空值。如果仅存在 NULL 行，则为组选择该行。

```
create table #Projects
(ProjectID int, IssID int, PtID int, PTY varchar(10), TypeID int, TypeName varchar(20), FieldID int, FieldName varchar(20),         STRINGVALUE varchar(50), NUMBERVALUE int,ChgGrpID int,ChgGrpIssID int,ChgItemID int,ChgItemGrpID int,FIELD varchar(20),            NEWVALUE varchar(20), NEWSTRING varchar(20))
insert into #Projects values 
(10879,107930,3,'Super',22,'A',10648,'ADH',NULL,666,501040,107930,852895,501040,'ADH',NULL,'666')
,(10879,107930,3,'Super',22,'A',10571,'DLV','No',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107930,3,'Super',22,'A',10541,'CMPLX','Large',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107930,3,'Super',22,'A',10542,'EWF','Orange',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107930,3,'Super',22,'A',10654,'WKFL','UAT',NULL,501034,107930,852889,501034,'WKFL','DVP','CRV')
,(10879,107930,3,'Super',22,'A',10654,'WKFL','UAT',NULL,501037,107930,852892,501037,'WKFL','CRV','UAT')
,(10879,107930,3,'Super',22,'A',10654,'WKFL','UAT',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10648,'ADH',NULL,999,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10571,'DLV','No',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10541,'CMPLX','Large',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10542,'EWF','Orange',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10654,'WKFL','UAT',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)

select * from #Projects 
order by IssID, FieldID 
```

这是我想看到的结果：

```
insert into #Projects values 
(10879,107930,3,'Super',22,'A',10648,'ADH',NULL,666,501040,107930,852895,501040,'ADH',NULL,'666')
,(10879,107930,3,'Super',22,'A',10571,'DLV','No',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107930,3,'Super',22,'A',10541,'CMPLX','Large',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107930,3,'Super',22,'A',10542,'EWF','Orange',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107930,3,'Super',22,'A',10654,'WKFL','UAT',NULL,501034,107930,852889,501034,'WKFL','DVP','CRV')
,(10879,107971,3,'Super',103,'B',10648,'ADH',NULL,999,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10571,'DLV','No',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10541,'CMPLX','Large',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10542,'EWF','Orange',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL)
,(10879,107971,3,'Super',103,'B',10654,'WKFL','UAT',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T14:16:13.653

第一个技巧是 null 是 min 选择的最后一个值 - 它们大于 min() 的任何数字，并且小于 max() 的任何数字。这意味着您想要的行为是默认行为。

第二个技巧是你不能加入空值，所以你需要使用 isnull()。（如果 ID 可能为 -1，则必须选择不同的替换值。）

所以我们找到我们的最小值和键中的其他项目，然后将其用作子查询来选择我们想要的行：

```
Select p.* from #Projects p
join
(Select isnull(MIN(ChgGrpID),-1) as ChgGrpID, IssID, FieldID
from #Projects 
group by IssID, FieldID) X
on isnull(P.ChgGrpID,-1)=X.ChgGrpID and P.IssID=X.IssID and P.FieldID=X.FieldID 
```

# cordova - 仅加载网站的 Phonegap iPhone/Android 模板

> ID：10046547
> 
> 赞同：0
> 
> 时间：2012-04-06T16:52:52.337
> 
> 标签：cordova, mobile-application

我想创建一个基于 Web 的移动应用程序，但我的客户坚持认为它必须是本机应用程序。他们不明白，即使它是一个原生应用程序，它所需的所有功能都是基于 Web 的。

如果我创建一个基于 Web 的应用程序然后使用 phonegap 构建一个简单地加载 Web 应用程序的本机应用程序，我想我可以给他们他们想要的东西。

几个问题：

1.  有这样的通用 phonegap 模板吗？
2.  有谁知道Apple是否会对这种类型的应用程序有问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:32:15.100

1.  是的。PhoneGap 将 Web 应用程序包装到本机应用程序中。请参阅任何[PhoneGap 教程](http://wiki.phonegap.com/w/page/35501397/Tutorials)和[入门](http://phonegap.com/start)。

2.  没问题。见[这里](http://www.macstories.net/news/apple-phonegap-framework-is-ok-for-the-app-store/)。[此线程](https://groups.google.com/forum/#!searchin/phonegap/iphone%2420app%2420store%2420reject%7Csort%3adate/phonegap/K-lGBGf2Pho/nskak9I-qjoJ)中的更多上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T22:26:39.703

可能您对问题的描述仅对我来说是令人困惑的。我不明白“构建一个简单地加载网络应用程序的本机应用程序”到底是什么意思，最好理解目标。

如果它是一个以 HTML5+JS+CSS3 应用程序（具有商业价值和最终用户功能）表示的网络应用程序，那很好（就像保罗所说的那样）。一些客户要求“本地网络应用程序”，而不仅仅是打开公司网站：) Apple - 当然 - 拒绝此类“应用程序”，因此您将无法发布它。（https://developer.apple.com/appstore/resources/approval/guidelines.html）

# sql - 使用 GROUP BY 删除

> ID：10046549
> 
> 赞同：-3
> 
> 时间：2012-04-06T16:53:06.040
> 
> 标签：sql, sql-server-2008, tsql

如何更改此 SELECT 使其成为用于删除的标准？

```
SELECT COUNT(empid), empid, status, deptid from tableA 
GROUP BY empid, status, deptid HAVING status is null and deptid = 5 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T16:56:52.810

你想删除什么？

如果只是在 deptId 5 中记录具有 NULL 状态的记录，则使用

```
WHERE status is NULL and DeptID = 5 
```

不是很清楚，如果你正在寻找更多...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T16:58:12.123

我猜，用 GROUP BY 删除可能不起作用。

您可以尝试以下方法，看看它是否有效。

```
DELETE 
FROM tableA
WHERE status is null AND deptid=5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T16:58:44.040

```
DELETE FROM tableA 
WHERE status is null AND deptid = 5 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T16:59:02.500

```
Delete from tableA a, 
(SELECT COUNT(empid) as count, empid, status, deptid from tableA 
    GROUP BY empid, status, deptid HAVING status is null and deptid = 5) as b 
where a.empid = b.empid
and a.status = b.status
and a.deptid = b.deptid
and b.count > 5 
```

像这样的东西会是你正在寻找的吗？它将删除属于计数> 5的组的所有记录

否则，您实际上并没有从 group by 中删除值，并且可以使用简单的 delete；

```
Delete from tableA 
where status is null 
and deptid = 5 
```

# cakephp - CakePHP：使用媒体视图报告失败的下载

> ID：10046555
> 
> 赞同：1
> 
> 时间：2012-04-06T16:53:38.213
> 
> 标签：cakephp

我正在使用 CakePHP 的媒体视图来强制下载文件。[我的代码与食谱中提供的示例](http://book.cakephp.org/2.0/en/views/media-view.html)非常相似，为方便起见，我将其粘贴在这里：

```
<?php
class ExampleController extends AppController {
    public function download () {
        $this->viewClass = 'Media';
        // Download app/outside_webroot_dir/example.zip
        $params = array(
            'id'        => 'example.zip',
            'name'      => 'example',
            'download'  => true,
            'extension' => 'zip',
            'path'      => APP . 'outside_webroot_dir' . DS
        );
        $this->set($params);
    }
} 
```

在数据库中，我有一个字段可以跟踪文件下载的次数。我正在寻找一种方法来确保此数字尽可能准确，因此如果用户的下载被取消或超时，该数字不会增加。CakePHP 的媒体视图是否可以通过某种方式报告下载确实成功？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T17:11:07.413

检测文件何时完成下载并非易事。这可以在客户端使用 javascript 完成，但浏览器不会为此提供任何挂钩。

[这里](https://stackoverflow.com/questions/1106377/detect-when-browser-receives-file-download)有一个非常聪明的解决方案（设置一个 cookie，然后用 javascript 查找它），但它只会告诉你下载何时开始。

# node.js - FF 11 和 Chrome 18.0 上的 Socket.io？

> ID：10046556
> 
> 赞同：0
> 
> 时间：2012-04-06T16:54:05.897
> 
> 标签：node.js, websocket, socket.io

我在使用 websockets 和 socket.io 时遇到了一些问题。

在 localhost 上，socket.io 似乎工作正常，但是当我在 no.de、FF 11 和 Chrome 18.0 上推送到生产环境时，连接需要很长时间，大约 5 秒后连接丢失并且没有重新建立。它在 Safari 上运行良好。这是有和没有配置包含 websocket 的传输的。

当我在没有“websocket”的情况下配置传输时，一切都很好，连接很快而且不会丢失。所以我现在让它工作，但不是我想要的。

我对两件事感到困惑： - 我认为这些浏览器版本支持 websockets。- 我认为 socket.io 将默认为下一个最佳传输解决方案。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:27:41.670

似乎 No.de 服务器没有正确代理。我不知道细节。我在这里找到了信息：

[http://discuss.joyent.com/viewtopic.php?id=30975](http://discuss.joyent.com/viewtopic.php?id=30975)

除非您付款，否则您将无法完成工作！一如既往。:-)

# delphi - Delphi Unicode 和控制台

> ID：10046559
> 
> 赞同：2
> 
> 时间：2012-04-06T16:54:18.373
> 
> 标签：delphi

我正在编写一个与一对硬件传感器接口的 C# 应用程序。不幸的是，在设备上公开的唯一接口需要提供用 Delphi 编写的 dll。

我正在编写一个 Delphi 可执行包装器，它调用 DLL 的必要函数并通过 stout 返回传感器数据。但是，此数据的返回类型是 PWideChar（或 PChar），我无法将其转换为 ansi 以便在命令行上打印。

如果我直接将数据传递给 WriteLn，我会得到“？” 对于每个字符。如果我查看字符数组并尝试使用 Ansi 转换一次打印一个字符，则只会打印几个字符（尽管它们确实确认了数据），并且它们通常会乱序打印。（打印时暴露的索引只是跳来跳去。）我还尝试将 PWideChar 转换为整数：'I' 对应于 21321。我可能会找出所有的转换，但有些数据有很多值。

我不确定 dll 使用的是什么版本的 Delphi，但我相信它是 4。肯定在 7 之前。

任何帮助表示赞赏！

TLDR：需要将 UTF-16 PWideChar 转换为 AnsiString 进行打印。

**示例应用：**

```
program SensorReadout;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  Windows,
  SysUtils,
  dllFuncUnit in 'dllFuncUnit.pas'; //This is my dll interface.

var  state: integer;
     answer: PChar;
     I: integer;
     J: integer;
     output: string;
     ch: char;

begin
  try
    for I := 0 to 9 do
    begin
      answer:= GetDeviceChannelInfo_HSI(1, Ord('a'), I, state); //DLL Function, returns a PChar with the results.  See example in comments.

      if state = HSI_NO_ERRORCODE then
      begin
        output:= '';
        for J := 0 to length(answer) do
        begin
          ch:= answer[J]; //This copies the char. Originally had an AnsiChar convert here.
          output:= output + ch;
        end;
        WriteLn(output);
      end;

  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
  ReadLn(I);
end.` 
```

问题是 PAnsiChar 需要是源自 DLL 的函数的返回类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:01:06.050

转换`PWideChar`为`AnsiString`：

```
function WideCharToAnsiString(P: PWideChar): AnsiString;
begin
  Result := P;
end; 
```

代码从 UTF-16、以 null 结尾的 PWideChar 转换为`AnsiString`. 如果您在输出中得到问号，那么您的输入不是 UTF-16，或者它包含无法在您的 ANSI 代码页中编码的字符。

我的猜测是，实际发生的情况是您的 Delphi DLL 是使用预 Unicode Delphi 创建的，因此使用 ANSI 文本。但是现在您正试图从`PChar`具有不同含义的后 Unicode Delphi 链接到它。我确定 Rob 在您的另一个问题中向您解释了这一点。因此，您可以通过将 DLL 导入声明为 return`PAnsiChar`而不是`PChar`. 像这样：

```
function GetDeviceChannelInfo_HSI(PortNumber, Address, ChNumber: Integer;
  var State: Integer): PAnsiChar; stdcall; external DLL_FILENAME; 
```

完成此操作后，您可以按照我上面描述的类似方式分配给字符串变量。

您需要吸收的是，在旧版本的 Delphi 中，`PChar`是`PAnsiChar`. 在现代 Delphi 中，它是`PWideChar`. 这种不匹配将解释您报告的所有内容。

* * *

我确实想到将 Delphi 包装器编写到 DLL 并通过 stdout 与您的 C# 应用程序进行通信是一种非常迂回的方法。我只是直接从 C# 代码 p/invoke DLL。您似乎认为这是不可能的，但这很简单。

```
[DllImport(@"mydll.dll")]
static extern IntPtr GetDeviceChannelInfo_HSI(
    int PortNumber, 
    int Address, 
    int ChNumber,
    ref int State
); 
```

像这样调用函数：

```
IntPtr ptr = GetDeviceChannelInfo_HSI(Port, Addr, Channel, ref State); 
```

如果该函数返回一个 UTF-16 字符串（这似乎值得怀疑），那么您可以`IntPtr`像这样转换：

```
string str = Marshal.PtrToStringUni(ptr); 
```

或者，如果它实际上是一个对我来说很可能的 ANSI 字符串，那么您可以这样做：

```
string str = Marshal.PtrToStringAnsi(ptr); 
```

然后当然你会想调用你的DLL来释放返回给你的字符串指针，假设它是在堆上分配的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T18:17:39.040

改变了我对评论的看法-我会回答:)

根据该代码，如果“状态”是代码 <> HSI_NO_ERRORCODE 并且没有异常，则它将未初始化的字符串“输出”写入控制台。这可能是任何内容，包括意外显示“S”和“4”以及一系列 1 个或多个问号

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T10:15:51.493

答案类型（变量）是 PChar。使用适合字符串变量的长度函数。使用 strlen 而不是长度。

```
 for J := 0 to StrLen(answer)-1 do 
```

PChar(char *) 的可访问范围也是 0..n-1

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-25T13:22:32.363

要将 UTF-16 PWideChar 转换为 AnsiString，您可以使用简单转换：

```
var
  WStr: WideString;
  pWStr: PWideString;
  AStr: AnsiString;
begin
  WStr := 'test';
  pWStr := PWideString(WStr);
  AStr := AnsiString(WideString(pWStr));
end; 
```

# iphone - 自定义 UITableView 子类单元格？

> ID：10046561
> 
> 赞同：0
> 
> 时间：2012-04-06T16:54:26.817
> 
> 标签：iphone, objective-c, uitableview

我已经在 Interface Builder 中创建了我的自定义单元格并为其创建了一个自定义 UITableViewCell 类，但是当它加载时没有对其进行任何更改。我在自定义类中有这段代码：

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) 
    {
        // Initialization code

        //Get the wedding date and display it
        myLabel.text = @"Hello";
    }
    return self;
} 
```

myLabel 已在标题中声明，具有属性并已在界面生成器中链接，但是当我运行应用程序并查看我的表时，我没有得到我的“你好”文本。有任何想法吗？

谢谢。

编辑：

我没有使用 nib 文件，我将它放在 Storyboard 中的 UITableViewController 中。另外，这是下面的 cellForRowAtIndexPath 代码，我只是有一个填充了所需单元格标识符的数组，然后创建了所述数组：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{    
    static NSString *CellIdentifier;

    for (int cell = 0; cell <= [tableCellsArray count]; cell++) 
    {
        if ([indexPath row] == cell) 
        {
            CellIdentifier = [tableCellsArray objectAtIndex:cell];
        }
    }

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) 
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Configure the cell...

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:01:28.237

[浏览Apple 文档](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/TableViewCells/TableViewCells.html)，其中描述了自定义 UITableViewCell 。

在上面的页面中，pl。见**清单 5-5** `Loading a cell from a nib file and assigning it content`，它清楚地描述了使用 nib 文件自定义单元格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:04:40.603

你如何创建你的细胞？你是从笔尖加载它还是分配它？如果您分配它，您需要正确初始化您的实例字段（例如 myLabel）。如果你从笔尖加载电池，我担心

> *   (id) initWithCoder:(NSCoder *)aDecoder

是您要覆盖的 init 方法。

无论如何，您可以放置​​一个断点以确保您通过那里并打印 myLabel 以确保它已正确初始化。

- 编辑

如果您想使用 nib 自定义单元格视图，则无法使用 initWithStyle:reuseIdentifier: 方法初始化单元格视图。

使用 initWithStyle:reuseIdentifier: 意味着您将通过自己的实现来初始化所有视图（例如，您将分配、初始化和配置所有视图，它不会使用 xib 文件）

如果要使用 xib 文件，则需要使用 NSBundle 中的 loadNibNamed:owner:options: 方法。

通常，我见过两种实现：

> [[NSBundle mainBundle] loadNibNamed:@"" owner:self options:nil];

在此实现中，您加载您的 xib，将 UIViewController 子类作为所有者。在 xib 中，确保 File Owner 类是您的 UIViewController 子类。然后只需将单元格与您的 UIViewController 子类的属性链接并调用 loadNibNamed:owner:options: 只会分配和初始化一个新的单元格视图，该视图将在您的 UIViewController 子类的属性中可用。这是 Apple 文档建议您执行的操作。

> NSArray *nibObjects = [[NSBundle mainBundle] loadNibNamed:@"" owner:nil options:nil]; UITableViewCell myCustomCell = [nibObjects objectAtIndex:0];

在此实现中，您无需将任何所有者传递给 xib 文件并获取您想要的对象。只需确保您的 xib 文件只有一个对象，即单元格视图。我更喜欢这种方法，因为我认为拥有一个用于创建单元格的属性是“奇怪的”，但是您需要确保您的 xib 文件的内容将您的自定义单元格视图保持在 0 索引处。

无论您选择哪种方法，请记住加载 xib 将调用

> initWithCoder: 而不是 initWithStyle:reuseIdentifier:

最后，我建议您查看 Aadhira 指向 Apple 文档的链接，其中举例说明了如何将自定义 UITableCellView 与 xib 文件一起使用。

# sql - 如何合并来自不同表的范围

> ID：10046563
> 
> 赞同：5
> 
> 时间：2012-04-06T16:54:27.033
> 
> 标签：sql, sql-server, tsql

给出以下 2 个表：

```
T1
------------------
From | To  | Value
------------------
10   | 20  | XXX
20   | 30  | YYY
30   | 40  | ZZZ

T2
------------------
From | To  | Value
------------------
10   | 15  | AAA
15   | 19  | BBB
19   | 39  | CCC
39   | 40  | DDD 
```

在 SQL Server 2008 上使用 T-SQL 获得以下结果的最佳方法是什么？

From/To 范围是连续的（没有间隙），下一个*From始终与前一个**To*具有相同的值

 *```
Desired result
-------------------------------
From | To  | Value1 |  Value2
-------------------------------
10   | 15  | XXX    |  AAA
15   | 19  | XXX    |  BBB
19   | 20  | XXX    |  CCC
20   | 30  | YYY    |  CCC
30   | 39  | ZZZ    |  CCC
39   | 40  | ZZZ    |  DDD 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T18:21:59.443

首先，我声明看起来像您发布的数据的数据。如果我所做的任何假设是错误的，请纠正我。最好在问题中发布您自己的声明，以便我们都使用相同的数据。

```
DECLARE @T1 TABLE (
  [From] INT,
  [To] INT,
  [Value] CHAR(3)
);

INSERT INTO @T1 (
  [From],
  [To],
  [Value]
)
VALUES
  (10, 20, 'XXX'),
  (20, 30, 'YYY'),
  (30, 40, 'ZZZ');

DECLARE @T2 TABLE (
  [From] INT,
  [To] INT,
  [Value] CHAR(3)
);

INSERT INTO @T2 (
  [From],
  [To],
  [Value]
)
VALUES
  (10, 15, 'AAA'),
  (15, 19, 'BBB'),
  (19, 39, 'CCC'),
  (39, 40, 'DDD'); 
```

这是我的选择查询以生成您的预期结果：

```
SELECT
  CASE
    WHEN [@T1].[From] > [@T2].[From]
    THEN [@T1].[From]
    ELSE [@T2].[From]
  END AS [From],
  CASE
    WHEN [@T1].[To] < [@T2].[To]
    THEN [@T1].[To]
    ELSE [@T2].[To]
  END AS [To],
  [@T1].[Value],
  [@T2].[Value]
FROM @T1
INNER JOIN @T2 ON
  (
    [@T1].[From] <= [@T2].[From] AND
    [@T1].[To] > [@T2].[From]
  ) OR
  (
    [@T2].[From] <= [@T1].[From] AND
    [@T2].[To] > [@T1].[From]
  ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T07:45:58.670

窃取@isme 的数据设置，我写了以下内容：

```
;With EPs as (
    select [From] as EP from @T1
    union
    select [To] from @T1
    union
    select [From] from @T2
    union
    select [To] from @T2
), OrderedEndpoints as (
    select EP,ROW_NUMBER() OVER (ORDER BY EP) as rn from EPs
)
select
    oe1.EP,
    oe2.EP,
    t1.Value,
    t2.Value
from
    OrderedEndpoints oe1
        inner join
    OrderedEndpoints oe2
        on
            oe1.rn = oe2.rn - 1
        inner join
    @T1 t1
        on
            oe1.EP < t1.[To] and
            oe2.EP > t1.[From]
        inner join
    @T2 t2
        on
            oe1.EP < t2.[To] and
            oe2.EP > t2.[From] 
```

也就是说，您创建一个包含所有可能的句点结束点 ( `EPs`) 的集合，然后对它们进行“排序”并为每个端点分配一个行号 ( `OrderedEPs`)。

然后最终查询将每对“相邻”行组合在一起，并连接回原始表以查找每个表中的哪些行与所选范围重叠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T18:01:43.553

下面的查询找到最小的范围，然后再次从表中选择值：

```
SELECT ranges.from, ranges.to, T1.Value, T2.Value
FROM (SELECT all_from.from, min(all_to.to) as to
    FROM (SELECT T1.FROM
        FROM T1
        UNION 
        SELECT T2.FROM 
        FROM T2) all_from
    JOIN (SELECT T1.TO
        FROM T1
        UNION
        SELECT T2.FROM
        FROM T2) all_to ON all_from.from < all_to.to
    GROUP BY all_from.from) ranges
JOIN T1 ON ranges.from >= T1.from AND ranges.to <= T1.to
JOIN T2 ON ranges.from >= T2.from AND ranges.to <= T2.to
ORDER BY ranges.from 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T20:26:44.183

感谢您的回答，但我最终使用了 CTE，我认为它更干净。

```
DECLARE @T1 TABLE ([From] INT, [To] INT, [Value] CHAR(3));
DECLARE @T2 TABLE ([From] INT, [To] INT, [Value] CHAR(3));

INSERT INTO @T1 (  [From],  [To],  [Value]) VALUES  (10, 20, 'XXX'),  (20, 30, 'YYY'),  (30, 40, 'ZZZ');
INSERT INTO @T2 (  [From],  [To],  [Value]) VALUES  (10, 15, 'AAA'),  (15, 19, 'BBB'),  (19, 39, 'CCC'),  (39, 40, 'DDD');

;with merged1 as 
(
    select 
        t1.[From] as from1,
        t1.[to] as to1,
        t1.Value as Value1,
        t2.[From] as from2,
        t2.[to] as to2,
        t2.Value as Value2
    from @t1 t1
    inner join @T2 t2 
        on t1.[From] <  t2.[To]
        and t1.[To] >= t2.[From]

)
,merged2 as 
(
    select 
          case when from2>=from1 then from2 else from1 end as [From]
         ,case when to2<=to1 then to2 else to1 end as [To]
         ,value1
         ,value2
    from merged1
)
select * from merged2 
```*

# performance - Emacs：如何提高 ido 性能？

> ID：10046569
> 
> 赞同：1
> 
> 时间：2012-04-06T16:54:47.673
> 
> 标签：performance, emacs, ido

我发现如果 ido 完成列表包含数百个项目，那么给出完成建议会太慢。

我想以高响应速度利用ido的能力。关于如何解决问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:30:38.193

我使用 ido 来完成 Unicode 字符名称，其中有超过 30,000 个。Ido 非常慢，直到我将`ido-enable-flex-matching`这个单一操作设置为 nil，它立即变得与任何其他匹配操作一样快。也许这个策略也可以帮助你。

简而言之，我这样做了：

```
(let* ((ido-enable-flex-matching nil)
       (input (ido-completing-read prompt (ucs-names))))
  ; ...
) 
```

# php - 使用 session_write_close() 时 PHP 保存会话；

> ID：10046570
> 
> 赞同：24
> 
> 时间：2012-04-06T16:54:47.633
> 
> 标签：php, session

我有一个页面，我在这个页面的开头进行了长时间的轮询，我必须使用这个

```
session_start();
session_write_close(); 
```

因为 ：

> 为了防止并发写入，任何时候只有一个脚本可以对会话进行操作

因此，如果我不这样做并且长轮询正在运行，则用户将无法加载另一个页面。

因此，可以从此轮询页面访问会话中的数据，但在我的脚本中的某个时刻，我必须将会话保存回服务器，因为我对其进行了一些更改。

有什么办法呢？

那会很好，这将是一种做类似的事情的方法

```
session_write_open();
//do stuff
session_write_close(); 
```

但是 session_write_open() 不存在！

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-06T16:57:51.503

*在*对会话进行一些更改之前，请`session_start`再次调用。进行更改，如果您仍然不想再次退出通话`session_write_close`。您可以根据需要多次执行此操作。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-05T14:56:23.213

以前的解决方案将创建一个会话 id 和 cookie ......我不会按原样使用它：

> 每次调用 session_start() 时都会创建会话。如果要避免多个cookie，请编写更好的代码。多个 session_start() 尤其是对于同一脚本中的相同名称似乎是一个非常糟糕的主意。

见这里：[https ://bugs.php.net/bug.php?id=38104](https://bugs.php.net/bug.php?id=38104)

我现在也在寻找解决方案，但我找不到。我同意那些说这是一个“错误”的人的观点。您应该能够重新打开一个 php 会话，但正如您所说`session_write_open()`的那样不存在......

我在上面的线程中找到了解决方法。它涉及在处理请求后发送一个标头，手动指定会话 ID 的 cookie。幸运的是，我正在使用自制的前端控制器，该控制器可以正常工作，因此任何子控制器都不会自行发送数据。简而言之，它在我的情况下非常有效。要使用它，您可能只需要使用`ob_start()`and `ob_get_clean()`。这是魔术线：

```
if (SID) header('Set-Cookie: '.SID.'; path=/', true); 
```

编辑：见下面 CMCDragonkai 的回答，看起来不错！？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-18T20:11:52.237

这里的其他答案提供了很好的解决方案。正如@Jon 所提到的，诀窍是在您想要进行更改之前再次调用 session_start() 。然后，当您完成更改后，再次调用 session_write_close()。

正如@Armel Larcier 所提到的，问题在于PHP 尝试生成新的标头并且可能会生成警告（例如，如果您已经将非标头数据写入客户端）。当然，您可以简单地在 session_start() 前加上“@” (@session_start())，但有更好的方法。

@VolkerK 提供的另一个 Stack Overflow 问题揭示了最佳答案：

```
session_start(); // first session_start
...
session_write_close();
...

ini_set('session.use_only_cookies', false);
ini_set('session.use_cookies', false);
//ini_set('session.use_trans_sid', false); //May be necessary in some situations
ini_set('session.cache_limiter', null);
session_start(); // second session_start 
```

这可以防止 PHP 再次尝试发送标头。您甚至可以编写一个辅助函数来包装 ini_set() 函数，以使其更方便：

```
function session_reopen() {
    ini_set('session.use_only_cookies', false);
    ini_set('session.use_cookies', false);
    //ini_set('session.use_trans_sid', false); //May be necessary in some situations
    ini_set('session.cache_limiter', null);
    session_start(); //Reopen the (previously closed) session for writing.
} 
```

原始相关 SO 问题/答案：[https ://stackoverflow.com/a/12315542/114558](https://stackoverflow.com/a/12315542/114558)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-01-16T22:22:42.953

这里的所有答案似乎都在说以它们显然不打算使用的方式使用会话方法......即`session_start()`多次调用。

PHP 网站提供了一个示例 SessionHandlerInterface 实现，它可以像现有会话一样工作，但不会锁定文件。只需实现他们的示例界面即可解决我的锁定问题，以允许在同一会话上进行并发连接，而​​不会限制我向会话添加变量的能力。为了防止某些竞争条件，由于应用程序的会话不是完全无状态的，我确实必须设法在不关闭它的情况下保存会话中间请求，以便在更改后可以立即保存重要的更改，而不太重要的会话变​​量可以保存在请求结束时。有关用法，请参见以下示例：

```
Session::start();
echo("<pre>Vars Stored in Session Were:\n");print_r($_SESSION);echo("</pre>");

$_SESSION['one']    = 'one';
$_SESSION['two']    = 'two';
//save won't close session and subsequent request will show 'three'
Session::save(); 
$_SESSION['three']  = 'three'; 
```

如果将其替换`Session::start()`为`session_start()`和`Session::save()`，`session_write_close()`您会注意到后续请求将永远不会打印出第三个变量......它将丢失。但是，使用 SessionHandler（如下），不会丢失任何数据。

OOP 实现需要 PHP 5.4+。但是，您可以在旧版本的 PHP 中提供单独的回调方法。[请参阅文档](http://php.net/manual/en/function.session-set-save-handler.php)。

```
namespace {
    class Session implements SessionHandlerInterface {
        /** @var Session */
        private static $_instance;
        private $savePath;

        public static function start() {
            if( empty(self::$_instance) ) {
                self::$_instance = new self();
                session_set_save_handler(self::$_instance,true);
                session_start();
            }
        }
        public static function save() {
            if( empty(self::$_instance) ) {
                throw new \Exception("You cannot save a session before starting the session");
            }
            self::$_instance->write(session_id(),session_encode());
        }
        public function open($savePath, $sessionName) {
            $this->savePath = $savePath;
            if (!is_dir($this->savePath)) {
                mkdir($this->savePath, 0777);
            }

            return true;
        }
        public function close() {
            return true;
        }
        public function read($id) {
            return (string)@file_get_contents("$this->savePath/sess_$id");
        }
        public function write($id, $data) {
            return file_put_contents("$this->savePath/sess_$id", $data) === false ? false : true;
        }
        public function destroy($id) {
            $file = "$this->savePath/sess_$id";
            if (file_exists($file)) {
                unlink($file);
            }

            return true;
        }
        public function gc($maxlifetime) {
            foreach (glob("$this->savePath/sess_*") as $file) {
                if (filemtime($file) + $maxlifetime < time() && file_exists($file)) {
                    unlink($file);
                }
            }

            return true;
        }
    } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-05-15T23:23:30.303

在测试了 Armel Larcier 的工作之后。这是我对这个问题提出的解决方案：

```
 ob_start();

    session_start();
    session_write_close();

    session_start();
    session_write_close();

    session_start();
    session_write_close();

    session_start();
    session_write_close();

    if(SID){

        $headers =  array_unique(headers_list());   

        $cookie_strings = array();

        foreach($headers as $header){
            if(preg_match('/^Set-Cookie: (.+)/', $header, $matches)){
                $cookie_strings[] = $matches[1];
            }
        }

        header_remove('Set-Cookie');

        foreach($cookie_strings as $cookie){
            header('Set-Cookie: ' . $cookie, false);
        }

    }

    ob_flush(); 
```

这将保留在使用会话之前创建的所有 cookie。

顺便说一句，您可能希望将上述代码注册为 register_shutdown_function 的函数。确保在函数之前运行 ob_start()，在函数内部运行 ob_flush()。

# android - Android iptables：不能丢弃端口

> ID：10046573
> 
> 赞同：0
> 
> 时间：2012-04-06T16:54:52.667
> 
> 标签：android, iptables

我尝试`iptables -A OUTPUT -p tcp --sport 5228 -j DROP`但涉及失败消息：

`FIX ME! implement getprotobyname() bionic/libc/bionic/stubs.c:378`

我有一个根设备和busybox。奇怪的是，如果我看到 iptables 的规则列表，这个端口就在其中。我不确定它是否有效？我的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T21:19:08.483

似乎是一个已知的错误： [https ://bugzilla.mozilla.org/show_bug.cgi?id=558415](https://bugzilla.mozilla.org/show_bug.cgi?id=558415)

如果您有兴趣，它会列出解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T15:57:43.690

使用协议编号 ( `-p 6`) 而不是名称 ( `-p tcp`)：

`iptables -A OUTPUT -p 6 --sport 5228 -j DROP`

有关更多信息，请参阅此答案： [getprotobyname error iptables](https://stackoverflow.com/questions/10331699/getprotobyname-error-iptables/18385413#18385413)

# java - 如何在 JdesktopPane 的中心设置可见的 JinternalFrame？

> ID：10046581
> 
> 赞同：1
> 
> 时间：2012-04-06T16:55:17.663
> 
> 标签：java, swing, jframe, jinternalframe

实际上，我想在 JDesktopPane 的中心显示 JinternalFrame，我使用了这个方法，因为我在 Jframes 中使用它，但它没有用：

`Extraction ex=new Extraction();//Extraction is the name of the JintenalFrame jDesktopPane1.add(ex); ex.setLocationRelativeTo(this); ex.setVisible(true);`

所以我问是否有另一种方法，以便我可以在 JdesktoPane 的中心显示 JinternalFrame。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T10:08:02.720

尝试类似：

```
JDesktopPane mainPanel;
JInternalFrame jif_test = new JInternalFrame();

public void centerJIF(JInternalFrame jif) {
    Dimension desktopSize = mainPanel.getSize();
    Dimension jInternalFrameSize = jif.getSize();
    int width = (desktopSize.width - jInternalFrameSize.width) / 2;
    int height = (desktopSize.height - jInternalFrameSize.height) / 2;
    jif.setLocation(width, height);
    jif.setVisible(true);
} 
```

和

```
centerJIF(jif_test); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T19:05:41.243

A`javax.swing.JInternalFrame`缺少 中的便捷`setLocationRelativeTo(null)`实现`java.awt.Window`，但您可以使用类似的方法。只需从桌面窗格的相应中心坐标中减去内部框架的宽度和高度的一半。在调用中使用新坐标`setLocation()`。

如有必要，您还需要调整内部框架的尺寸。

# asp.net - asp.net url 生成

> ID：10046586
> 
> 赞同：0
> 
> 时间：2012-04-06T16:55:31.840
> 
> 标签：asp.net

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data.SqlClient;
using System.Configuration;
using System.Text;
using System.Web.Services;
using System.IO;

namespace T_Smade
{

    public partial class ConferenceManagement : System.Web.UI.Page
    {
        volatile int i = 0;

        protected void Page_Load(object sender, EventArgs e)
        {
            GetSessionList();
        }

        public void GetSessionList()
        {
            string secondResult = "";
            string userName = "";

            try
            {
                if (HttpContext.Current.User.Identity.IsAuthenticated)
                {
                    userName = HttpContext.Current.User.Identity.Name;
                }

                SqlConnection thisConnection = new SqlConnection(@"data Source=ZOLA-PC;AttachDbFilename=D:\2\5.Devp\my DB\ASPNETDB.MDF;Integrated Security=True");
                thisConnection.Open();

                SqlCommand secondCommand = thisConnection.CreateCommand();
                secondCommand.CommandText = "SELECT myApp_Session.session_id FROM myApp_Session, myApp_Role_in_Session where myApp_Role_in_Session.user_name='" + userName + "' and myApp_Role_in_Session.session_id=myApp_Session.session_id";
                SqlDataReader secondReader = secondCommand.ExecuteReader();

                while (secondReader.Read())
                {
                    secondResult = secondResult + secondReader["session_id"].ToString() + ";";
                }
                secondReader.Close();

                SqlCommand thisCommand = thisConnection.CreateCommand();
                thisCommand.CommandText = "SELECT * FROM myApp_Session;";
                SqlDataReader thisReader = thisCommand.ExecuteReader();

                while (thisReader.Read())
                {
                    test.Controls.Add(GetLabel(thisReader["session_id"].ToString(), thisReader["session_name"].ToString()));
                    string[] compare = secondResult.Split(';');
                    foreach (string word in compare)
                    {
                        if (word == thisReader["session_id"].ToString())
                        {
                            test.Controls.Add(GetButton(thisReader["session_id"].ToString(), "Join Session"));
                        }
                    }
                }
                thisReader.Close();
                thisConnection.Close();

            }
            catch (SqlException ex)
            {

            }
        }

        private Button GetButton(string id, string name)
        {
            Button b = new Button();
            b.Text = name;
            b.ID = "Button_" + id + i;
            b.Command += new CommandEventHandler(Button_Click);
            b.CommandArgument = id;
            i++;
            return b;
        }

        private Label GetLabel(string id, string name)
        {
            Label tb = new Label();
            tb.Text = name;
            tb.ID = id;
            return tb;
        }

        protected void Button_Click(object sender, CommandEventArgs e)
        {
            Response.Redirect("EnterSession.aspx?session=" + e.CommandArgument.ToString());
        }
    } 
```

当用户从该页面单击时，下一页将生成为

www.mypage/Entersession.aspx?session=session_id

但我宁愿拥有它

www.mypage/Entersession.aspx?session=session_name

session_id 和 session_name 都来自数据库

任何的想法？

```
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T16:58:36.450

这是你想要的？改名`CommandArgument`？这是一个非常非常容易解决的问题。

**更新**

您可以添加一个`commandArgument`参数到`GetButton()`.

```
 private Button GetButton(string id, string name, string commandArgument)
    {
        Button b = new Button();
        b.Text = name;
        b.ID = "Button_" + id + i;
        b.Command += new CommandEventHandler(Button_Click);
        b.CommandArgument = commandArgument; // this changed to commandArgument
        i++;
        return b;
    }

    GetButton(thisReader["session_id"].ToString(), "Join Session", thisReader["session_name"].ToString()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:00:13.050

只是改变

```
test.Controls.Add(GetButton(thisReader["session_id"].ToString(), "Join Session")); 
```

到

```
test.Controls.Add(GetButton(thisReader["session_name"].ToString(), "Join Session")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:03:05.047

您正在寻找的改变发生在您使用`GetButton`方法的地方

改变：

```
test.Controls.Add(GetButton(thisReader["session_id"].ToString(), "Join Session")); 
```

到：

```
test.Controls.Add(GetButton(thisReader["session_name"].ToString(), "Join Session")); 
```

您的第一个输入参数`GetButton`被映射到`CommandArgument`. 因此，通过`session_name`而不是`session_id`会成功。

# c++ - Qt：隐藏 QTabBar 中选定选项卡的边框

> ID：10046590
> 
> 赞同：6
> 
> 时间：2012-04-06T16:55:54.917
> 
> 标签：c++, qt, user-interface, tabs, qtabbar

QTabBar 有一个 1px 的边框，将选项卡与其内容分开。

```
QTabWidget::pane { border:1px solid #C4C4C3; } 
```

我希望边框在所选选项卡下消失，就像在所有浏览器和大多数使用选项卡的应用程序中一样。

但是，为 QTabBar::tab 设置样式无济于事：

```
QTabBar::tab:selected { border-bottom-color:white; } 
```

![在此处输入图像描述](../Images/84545e2e929b0ad89e17f273c6eada54.png)

那么我该如何实现呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T17:53:36.810

该线由 的顶部边框控制`QTabWidget::pane`。例如：

```
QTabWidget::pane { border: 1px solid #C4C4C3; top: -1px; } 
```

将在选项卡后面/下面移动线（以某种方式`top`单独使用似乎完全删除了边框）。

# java - JNI方法静态解析验证

> ID：10046593
> 
> 赞同：0
> 
> 时间：2012-04-06T16:55:56.370
> 
> 标签：java, android, reflection, java-native-interface

我想知道是否可以在 Android SDK 下的 Java 中验证作为本机 JNI 方法实现的 Java 类中的方法是静态解析的？下面是我正在寻找的解释。

我有一个部分实现为 JNI 类的 Java 类。如果相应的 JNI 库已创建为静态库（例如 libhelper.a），则可以静态初始化此类。或者，如果相应的 JNI 库被实现为动态库（例如 libhelper.so），则可以动态初始化它。在动态初始化的情况下，类应该有一个加载动态库的静态初始化器——libhelper.so。我正在使用这两种情况，我想为它们保留相同的源代码。为此，我想在静态初始化程序中验证相应的本机方法是否已被解析。如果是真的，我不需要加载动态库。如果为假，则意味着我必须加载动态库。

下面的示例有不正确的行，这表明了我的意图。

```
package com.sample.package;
public class MyUtilityClass 
{
    private static final String TAG = "MyUtilityClass";
    public MyUtilityClass () {
        Log.v(TAG, " MyUtilityClass constructor");     
    }
    public static native int initMyHelperClass();
    public static native int performHelpAction(String action);
    public static native int uninitMyHelperClass();

    static {
        try {
            /* Here I want to verify that the native method 
               initMyHelperClass has has been already resolved.
               In this code snippet I am just comparing it to null,
               which is not correct. It should be something different. */ 
            if (initMyHelperClass == null) {
                /* initMyHelperClass has not been resolved yet,
                   load the dynamic library - libhelper.so */            
                System.loadLibrary("helper");
            }   
        } catch (UnsatisfiedLinkError ule) {
            /*Library not found. We should throw second exception. */
            throw ule;  
        }     
    } 
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:40:13.080

您可以使用`UnsatisfiedLinkError`和一个虚拟方法来检查是否加载了给定类的本机方法：

```
private static native void checkMe();  // does nothing

static {
    try {
        checkMe();
    } catch (UnsatisfiedLinkError e) {
        System.loadLibrary("checkLibrary");
    }
} 
```

# android - 如何禁用 Android SQLite 日志文件？

> ID：10046596
> 
> 赞同：5
> 
> 时间：2012-04-06T16:56:08.067
> 
> 标签：android, sqlite, journal

我正在使用事务将多行插入表中。但是，我仍然看到在 SD 卡上创建临时 sqlite-journal 文件以及 sqlite 表。

如何禁用日志文件的创建？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T17:15:43.327

您可以选择将日志保存在内存中，这样就不会创建 -journal 文件：

```
pragma journal_mode=memory; 
```

请注意，每次打开数据库时都需要运行它。

我建议您阅读以下内容以更好地了解正在发生的事情：

[http://www.sqlite.org/pragma.html#pragma_journal_mode](http://www.sqlite.org/pragma.html#pragma_journal_mode)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T17:14:12.923

日志是运行事务时使用的内部 SQLite 文件（以确保回滚）。你不能禁用它，你也不想这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-08T03:43:10.687

请注意，该声明`PRAGMA journal_mode=OFF`或对`PRAGMA journal_mode=memory`每个交易基础有效。您需要为每笔交易设置它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-23T06:34:19.330

您可以使用以下代码删除日志文件

```
@Override
public void onOpen(SQLiteDatabase db) {         
    Cursor cc = db.rawQuery("PRAGMA journal_mode=DELETE",null);
    Log.i(TAG,"--- cursor count " + cc.getCount());     
    super.onOpen(db);        
} 
```

您需要使用光标。游标是一个接口，提供对数据库查询返回的结果集的随机读写访问。如果您使用光标，日志文件将被删除。

# c# - 在运行时更改自定义属性的参数

> ID：10046601
> 
> 赞同：12
> 
> 时间：2012-04-06T16:56:56.097
> 
> 标签：c#, reflection, runtime, custom-attributes

我需要在运行时更改属性的参数。我将我的问题简化为简单的示例。

**属性类：**

```
 [AttributeUsage(AttributeTargets.Property)]
    public class MyAttribute : Attribute
    {
        public string Name { get; set; }
    } 
```

**具有带有属性的修饰属性的简单实体：**

```
 public class MyEntity
    {
        [MyAttribute(Name="OldValue1")]
        public string Data1{ get; set; }

        [MyAttribute(Name = "OldValue2")]
        public string Data2 { get; set; }
    } 
```

我创建了 MyEntity 类的实例。我可以更改对象属性的值，但不能更改对象实体上属性的属性名称值。可能吗？

对象实体上的属性值我可以使用这部分代码进行更改：

```
 entityProp.SetValue(entity,"NewData",null); 
```

但我不如何更改对象实体上属性的属性名称的值

这不起作用：

> ```
> attProp.SetValue(attribute,"NewData",null); 
> ```

属性名称的值仍然是原始的。

这是所有测试代码。

```
 [TestMethod]
    public  void Test()
    {
        var entity = new MyEntity
                         {
                             Data1 = "OldData",
                             Data2 = "OldData"
                         };

        PropertyInfo[] entityProps = entity.GetType().GetProperties();

        foreach (var entityProp in entityProps)
        {
            var attribute = Attribute.GetCustomAttribute(entityProp, typeof (MyAttribute)) as MyAttribute;

            if (attribute != null)
            {
                //get attribute's property NAME
                PropertyInfo attProp= attribute.GetType().GetProperty("Name");

                //get entity property value
                var propertyValue = entityProp.GetValue(entity, null);

                //get attribute’s property NAME value
                var atributeNameValue = attProp.GetValue(entity, null);

                TestContext.WriteLine(string.Format("property name:{0} property value: {1} : atribute name value: {2}\n", 
                    entityProp.Name, propertyValue, atributeNameValue)); 

                //change values
                entityProp.SetValue(entity,"NewData",null);

                //how can I change value of property Name on object entity ?
                attProp.SetValue(attribute,"NewData",null);

            }

        }

        TestContext.WriteLine(string.Format("After change\n"));

        foreach (var entityProp in entityProps)
        {
            var attribute = Attribute.GetCustomAttribute(entityProp, typeof(MyAttribute)) as MyAttribute;

            if (attribute != null)
            {

                PropertyInfo attProp = attribute.GetType().GetProperty("Name");

                var propertyValue = entityProp.GetValue(entity, null);
                var atributeNameValue = attProp.GetValue(entity, null);

                TestContext.WriteLine(string.Format("property name:{0} property value: {1} : atribute name value: {2}\n",
                    entityProp.Name, propertyValue, atributeNameValue));
            }
        }
    } 
```

**已编辑：我删除了原始帖子并添加了非常简单的清晰示例。对不起**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-06T18:03:45.163

您不能在运行时更改属性。它们嵌入到程序集的元数据中。您的方法正在更改特定实例的内部状态；但是当您再次加载该属性时，您将获得一个不同的实例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-06T18:14:45.227

这在反射中是不可能的，因为（如前所述）元数据是固定的。然而，TypeDescriptor 部分是可能的，它允许在运行时添加和替换属性，并提供完整的替代模型（TypeDescriptionProvider 等）。任何使用反射的代码都不会尊重这种方法，但任何使用 TypeDescriptor 的代码（最常见的是数据绑定和其他 UI 代码）都会注意到这些变化。

注意 TypeDescriptor 仅适用于每个类型/成员的每个属性类型之一；多实例属性没有得到很好的支持。

# php - jQuery 验证插件和复选框数组

> ID：10046603
> 
> 赞同：1
> 
> 时间：2012-04-06T16:57:09.427
> 
> 标签：php, jquery, forms, validation

验证复选框数组存在以下问题。[验证被绕过，已经获取了验证插件](http://jquery.bassistance.de/validate/demo/radio-checkbox-select-demo.html)的样本，但它不起作用。

```
// valideren formulier
$('#formulier').validate({
    onkeyup: false,
    onblur: false,
    showErrors: function(errorMap, errorList) {
        if(errorList.length > 0) {
            $("#dcMessage").dcMessage({type: "error", message: errorList[0]['message']});
        }
    },
    rules: {
        gebruikersnaam: { 
            required : true,
            minlength: 4
        },
        wachtwoord: {
            required : true,
            minlength: 8
        },
        wachtwoord2: {
            required : true,
            minlength: 8,
            equalTo: "#wachtwoord"
        },
        email: {
            email: true
        },
        opdrachtgevers: {
            required: true,
            minlength: 1
        },
        groepen: {
            required: true,
            minlength: 1
        }

    },
    messages: {
        gebruikersnaam: { 
            required : "Gebruikersnaam is verplicht.",
            minlength: jQuery.format("Gebruikersnaam moet minimaal uit {0} karakters bestaan.")

        },
        wachtwoord: {
            required : "Wachtwoord is verplicht.",
            minlength: jQuery.format("Wachtwoord moet minimaal uit {0} karakters bestaan.")
        },
        wachtwoord2: {
            required : "Herhaal wachtwoord.",
            minlength: jQuery.format("Wachtwoord moet minstens uit {0} karakters bestaan."),
            equalTo: "Wachtwoord komt niet overeen."
        },
        email: {
            email: "Geen geldig e-mailadres."
        },
        opdrachtgevers: "Selecteer minimaal één opdrachtgever.",
        groepen: "Selecteer minimaal één groep."
    },
    submitHandler: function(form) {
        // submit het formulier
        form.submit();
    }
}); 
```

这是我的表单数据

```
<div>
  <div class="groeplabel">Opdrachtgevers<em>*</em></div>
  <div class="groepinput">
    <fieldset>
    <?php
    // query; + 0 om op de juiste manier te sorteren 1,2,3,4,5,6,7,8,9,10,11 (+ 0 => converteer naar nummer)
    $sql = "SELECT opdrachtgever_id, bedrijfsnaam FROM dc_opdrachtgevers WHERE prullenbak = '0' ORDER BY bedrijfsnaam ASC";

    // uitvoeren query
    $result = mysql_query($sql) OR die ("Foutmelding: ".MySQL_errno()." ".MySQL_error());

    // opdrachtgevers aanwezig
    if(mysql_num_rows($result) > 0) {
        // doorlopen opdrachtgevers
        while($row = mysql_fetch_assoc($result)) {
              echo "<div style=\"float: left;\"><input class=\"checkbox cbgroup\" type=\"checkbox\" name=\"opdrachtgevers[]\" id=\"opdrachtgevers-" . $row["opdrachtgever_id"] . "\" value=\"" . $row["opdrachtgever_id"] . "\" /><label class=\"label\" for=\"opdrachtgevers-" . $row["opdrachtgever_id"] . "\">" . $row["bedrijfsnaam"] . "</label></div>\n";
        } 
    }
    ?>
    </fieldset>
  </div>
</div>
<div class="clearb"></div>
<div style="margin-top: 10px; padding-bottom: 10px;">
  <div class="groeplabel">Groepen<em>*</em></div>
  <div class="groepinput">
    <fieldset>
      <?php
      // query; + 0 om op de juiste manier te sorteren 1,2,3,4,5,6,7,8,9,10,11 (+ 0 => converteer naar nummer)
    $sql = "SELECT groep_id, groep_type, groep_naam FROM dc_groepen WHERE prullenbak = '0' ORDER BY groep_type + 0 ASC, groep_naam ASC";

    // uitvoeren query
    $result = mysql_query($sql) OR die ("Foutmelding: ".MySQL_errno()." ".MySQL_error());

    // groepen aanwezig
    if(mysql_num_rows($result) > 0) {
        // doorlopen groepen
        while($row = mysql_fetch_assoc($result)) {
              echo "<div style=\"float: left;\"><input class=\"checkbox cbgroup\" type=\"checkbox\" name=\"groepen[]\" id=\"groepen-" . $row["groep_id"] . "\" value=\"" . $row["groep_id"] . "\" /><label class=\"label\" for=\"rechten-" . $row["groep_id"] . "\">" . ($row["groep_type"] == "DC" ? "<font color=\"#F00\">Digicarto " . $row["groep_naam"] . "</font>": $row["groep_naam"]) . "</label></div>\n";
        } 
    }
    ?>
   </fieldset>
  </div> 
```

可以找到哪里出错了，请有人帮忙。

**这是我的解决方案：**

```
submitHandler: function(form) {
        // checkboxen niet goed
        if($(".cb_opdrachtgevers:checked").length == 0) {
            // opdrachtgevers
            $("#dcMessage").dcMessage({type: "error", message: "Selecteer minimaal één opdrachtgever."});
            return false;
        } else if($(".cb_groepen:checked").length == 0) {
            // groepen
            $("#dcMessage").dcMessage({type: "error", message: "Selecteer minimaal één groep."});
            return false;
        } else {
            // submit het formulier
            form.submit();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T08:27:23.947

**这是我的解决方案：**

```
submitHandler: function(form) { 
        // checkboxen niet goed 
        if($(".cb_opdrachtgevers:checked").length == 0) { 
            // opdrachtgevers 
            $("#dcMessage").dcMessage({type: "error", message: "Selecteer minimaal één opdrachtgever."}); 
            return false; 
        } else if($(".cb_groepen:checked").length == 0) { 
            // groepen 
            $("#dcMessage").dcMessage({type: "error", message: "Selecteer minimaal één groep."}); 
            return false; 
        } else { 
            // submit het formulier 
            form.submit(); 
        } 
    } 
```

# ruby-on-rails-3 - 馈送单个 .jpg 文件真正的载波？

> ID：10046604
> 
> 赞同：0
> 
> 时间：2012-04-06T16:57:17.413
> 
> 标签：ruby-on-rails-3, image, upload, carrierwave

是否可以提供 single.jpg 真正的载波？使用 jpegcam 我生成了一个 temp.jpg 并希望将其输入到 carrierwave 中，以便将其存储在照片表中并根据 /uploaders/photo_uploader.rb 生成缩略图

有什么方法可以将单个 jpg 馈送到载波？

```
 def upload
    File.open(upload_path, 'w:ASCII-8BIT') do |f|
      f.write request.raw_post
    end
    render :text => "ok"
  end

  private

  def upload_path # is used in upload and create 
    file_name = ("webcam_1.jpg")
    File.join(::Rails.root.to_s, 'public', 'uploads', file_name)
    Photo.create(:file => File.open("#{Rails.root}/public/uploads/#{file_name}"))
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:16:37.593

如果我正确理解您的问题，您只想从文件创建照片？假设您的 Photo 类有一个 Carrierwave 正在使用的“图像”字段，那就是：

```
Photo.create(:image => File.open("#{Rails.root}/public/uploads/#{file_name}")) 
```

# ios - 重构代码后使用 self.view

> ID：10046606
> 
> 赞同：1
> 
> 时间：2012-04-06T16:57:29.520
> 
> 标签：ios, uiview, uiviewcontroller, charts, drawing

我一直在用一个很酷的图表框架 (http://www.shinobicontrols.com/shinobicharts/) 进行一些测试，到目前为止，我让他们在我的项目上工作。他们看起来很棒！

就像我在任何测试中所做的那样，我尽可能简单地实现示例，然后，当它工作时，我继续在代码组织部门进行一些改进。

在我对所拥有的东西感到满意后，我开始稍微重构代码。现在我无法在我的视图上绘制图表。我已经使用 NSLog 测试了对方法的调用，并且所有内容都按预期调用。这是处理让我在这里旋转的视图。让我解释一下我有什么（当它工作时）和我做了什么（打破它）。

工作场景：

*   ReportsViewController 1) 导入 chartLibrary.h 2) 导入 chartDatasource.h 3) 创建视图并添加`[self.view addSubview:chart];`

都在同一个地方。都好。

我为组织代码所做的工作：

1）创建了一个新类“ChartReports”（起初我认为它应该是 NSObject，但后来我无法使用视图，所以我改为 UIViewController） 2）将所有导入和绘图代码移动到这个新类。为每种类型的图表创建绘图方法。3）将“ChartReports”导入“ReportsViewController” 4）创建新对象（ChartReports 类型）并在与我之前的整个代码完全相同的位置调用“drawChartX”的新方法（在“ReportsViewController”内）

一切都向南走:(

问题是调用是正确的，方法“drawChartX”被调用，我从头到尾 NSLog 以确保代码正在执行，但屏幕上没有绘制任何内容。

我创建它并这样称呼它：

```
ChartReports *chart = [[ChartReports alloc] init];

[chart drawChartX]; 
```

当我看到我移动的代码（从“ReportsViewController”到“ChartReports”）时，我注意到它仍然到处都是“self.view”。我认为这就是绘画被破坏的地方。“self”最初指的是“ReportsViewController”，现在它的意思是“ChartReports”。

那么，毕竟：我如何告诉“ChartReports”在“ReportsViewController”.view 上绘制而不是在它自己的视图上绘制？

我尝试了变量和属性，但没有成功。我应该将视图的名称作为方法参数发送吗？

很抱歉发布这么长的解释，但我没有想法尝试。任何一般性提示都会有助于重回正确的道路。

像往常一样感谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T18:06:53.893

你的 ChartReports 对象不应该在你的 ReportsViewController 上绘制，这会破坏基本的 MVC 原则。相反，您应该组织您的代码，以便 ChartReports 对象创建并返回一个视图（即图表），然后您的 ReportsViewController 将使用`addSubview`.

通过这种方式，您仍然可以将图表的创建封装在单独的对象 (ChartReports) 中，但是您将显示图表的工作留给视图控制器，这是它的工作。

# c# - SetupDiChangeState 引发拒绝访问

> ID：10046607
> 
> 赞同：0
> 
> 时间：2012-04-06T16:57:31.017
> 
> 标签：c#, pinvoke

我的用户是管理员（我在配置面板中看到），下面的代码抛出一个 Win32Exception ，其中说`Access Denied`，我该如何更改它（Win7 32 位）？

```
static Guid VideoGuid = new Guid("4d36e968-e325-11ce-bfc1-08002be10318");

[SecurityPermission(SecurityAction.Demand, UnmanagedCode = true)]
static void Main(string[] args)
{
    SafeDeviceHandle handle = null;
    try
    {
        handle = NativeMethods.SetupDiGetClassDevs(ref VideoGuid, IntPtr.Zero, IntPtr.Zero, NativeMethods.DIGCF.PRESENT);
        var data = new NativeMethods.SP_DEVINFO_DATA().Initialize();
        var param = new NativeMethods.SP_PROPCHANGE_PARAMS().Initialize();
        param.ClassInstallHeader.InstallFunction = 0x12;
        param.StateChange = NativeMethods.DICS.ENABLE; // 0x01
        param.Scope = NativeMethods.DICS_GLOBAL.GLOBAL; // 0x01
        param.HwProfile = 0;

        RunWin32Method(() => NativeMethods.SetupDiEnumDeviceInfo(handle, 0u, out data));
        RunWin32Method(() => NativeMethods.SetupDiSetClassInstallParams(handle, ref data, ref param, (UInt32)Marshal.SizeOf(param)));
        RunWin32Method(() => NativeMethods.SetupDiChangeState(handle, ref data));
    }
    catch
    {
        var w = new Win32Exception(Marshal.GetLastWin32Error());
    }
    finally
    {
        if (handle != null && (!handle.IsInvalid))
            handle.Close();
    }
}

static void RunWin32Method(Func<bool> f)
{
    if (!f())
    {
        Debug.WriteLine(new Win32Exception(Marshal.GetLastWin32Error()).Message);
    }
} 
```

如果您想要更多代码，请询问:-)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:20:11.430

回顾评论线索，管理员组中的用户在 Vista/Server 2008 及更高版本上没有管理员权限，除非进程运行提升。 [需要清单](https://stackoverflow.com/questions/2818179/how-to-force-c-sharp-app-to-run-as-administrator-on-windows-7)才能让 Windows 显示 UAC 提升提示。

这不适用于在登录时通过 Run 注册表项或 Startup 文件夹启动的程序。Windows 拒绝显示提升提示，因为用户无法准确猜测是*哪个*程序要求提升。使用证书对程序进行代码签名可能会解决此问题，因为这允许 Windows 验证和显示程序所有者，但实际上从未尝试过。

此类程序的解决方法是将其作为服务或计划任务激活。两者都不需要清单。这种看似奇怪的背后的理论是，它已经需要提升才能安装服务或计划任务。

# php - 多语言 PHP 网站

> ID：10046610
> 
> 赞同：1
> 
> 时间：2012-04-06T16:57:49.660
> 
> 标签：php, mysql, database

我有一个 PHP 网站。现在我需要通过添加一个选项将其“转换”为多语言网站，用户可以在其中选择他们喜欢的语言。假设我想要 2 种语言作为开始，然后在需要时以一种聪明的方式添加新语言。

**数据库 VS 语言文件...**

据我所知，有两种选择。

1）我可以使用带有语言、翻译等的 MySQL 数据库表，并且每次都根据用户的首选语言从数据库中检索数据，这意味着大量的数据库请求。

2）我可以使用`define`命令使用外部语言PHP文件（比如一些将不同语言文件放入语言文件夹的电子商务框架，如fr.php eng.php等）

什么是更好的？答案必须基于以下论点及其优缺点。

1) 最佳性能

2) 灵活性

3) 更高效

4）智能方式

5）资源使用（CPU，内存等）

PS 网站的谷歌翻译工具对我来说不是一个合适的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:11:17.167

老实说，数据库解决方案非常昂贵，并不是真正需要的。您的网站可能有静态（不会改变）的语言短语。在这种情况下，您应该使用语言数组将它们存储为`$array['key'] = 'phrase'`并能够通过全局的方式检索它们。像这样的东西：

```
class Lang {

    private static $loaded;
    private static $array;

    private static function set($key, $value) {
        self::$array[$key] = $value;
    }

    public static function get($key, $default = 'empty') {
        $lang = LANG;
        $file = "lang/$lang.php";
        if (!in_array($lang, self::$array) and file_exists($file)) {
            include($file);
            self::$loaded[] = $lang;
        }
        return (isset(self::$array[$key])
            ? self::$array[$key]
            : $default;
    }

} 
```

现在您只需将语言文件存储为`lang/en.php`or `lang/it.php`... 其中包含如下内容：`self::set('MY_KEY', 'This is a phrase');` 然后将其设置`LANG`为每个请求的正确文件。我使用了一个常量`LANG`，但还有其他方法可以存储全局内容。

您可以并且可能更喜欢使用非静态类。如：

```
class Lang {

    private $lang;

    public function __construct($lang) {
        $file = "lang/{$lang}.php";
        if (file_exists($file))
            include($file);
    }

    private function set($key, $value) {
        $this->lang[$key] = $value;
    }

    public function get($key, $default = 'empty') {
        return (isset($this->lang[$key])
            ? $this->lang[$key]
            : $default;
    }

} 
```

但是你应该在每次需要的时候使用依赖注入来注入这个类。一个使用示例：

```
$lang = new Lang('en');
$lang->get('LANG_KEY'); 
```

# gwt - 对于 GWT 中的 System 类型，方法 nanoTime() 未定义

> ID：10046614
> 
> 赞同：7
> 
> 时间：2012-04-06T16:58:28.143
> 
> 标签：gwt

在 Eclipse 中编译我的 libgdx 应用程序时，我不断收到此错误：

```
 [ERROR] Errors in 'file:/C:/Users/Zorfie/Programing/Java/workspace/Libgdx/src/sim/states/BasicBox2DState.java'
      [ERROR] Line 157:  The method nanoTime() is undefined for the type System
      [ERROR] Line 159:  The method nanoTime() is undefined for the type System
      [ERROR] Line 160:  The method nanoTime() is undefined for the type System
      [ERROR] Line 161:  The method nanoTime() is undefined for the type System
   [ERROR] Errors in 'jar:file:/C:/Program%20Files/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201203300216-rel-r37/gwt-2.4.0/gwt-user.jar!/com/google/web/bindery/autobean/shared/impl/StringQuoter.java'
      [ERROR] Line 21:  The import org.json cannot be resolved
      [ERROR] Line 69:  JSONObject cannot be resolved
   [ERROR] Errors in 'jar:file:/C:/Program%20Files/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201203300216-rel-r37/gwt-2.4.0/gwt-user.jar!/com/google/web/bindery/autobean/vm/impl/JsonSplittable.java'
      [ERROR] Line 23:  The import org.json cannot be resolved
      [ERROR] Line 24:  The import org.json cannot be resolved
      [ERROR] Line 25:  The import org.json cannot be resolved
      [ERROR] Line 40:  JSONObject cannot be resolved to a type
      [ERROR] Line 47:  JSONObject cannot be resolved to a type 
```

这意味着 GWT 不支持 .nanoTime()，是这种情况还是我只是使用错误的 JRE 运行？（我检查了该项目，它说它是 1.6）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-06T17:09:46.707

GWT不`nanoTime()`支持，因为 javascript 不支持它。

GWT 中最接近的类比是`Duration.currentTimeMillis()`

# ruby - 为什么即使在 Ruby 中美元变量也没有祖先？

> ID：10046625
> 
> 赞同：0
> 
> 时间：2012-04-06T16:59:39.773
> 
> 标签：ruby, oop, object

在 Ruby 中，**一切都是对象**。我将其解释为一切都继承自`BasicObject`并有祖先。

但我发现美元变量 ( `$!`, `$1`) 没有祖先。

他们不响应`ancestor`定义在`BasicObject`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:07:32.160

Ruby 的核心中没有`ancestor`方法，我假设您的意思是`ancestors`. [`ancestors`在 中定义`Module`](http://ruby-doc.org/core-1.9.3/Module.html#method-i-ancestors)，并且可以在模块或类对象上调用，*而不是*它们的实例。

```
$1.ancestors
#=> NoMethodError: undefined method `ancestors' for nil:NilClass
#     from (irb):4
#     from /Users/amarshall/.rbenv/versions/1.9.3-p125/bin/irb:12:in `<main>'

$1.class.ancestors
#=> [NilClass, Object, Kernel, BasicObject] 
```

这不是全局变量独有的，适用于所有对象和变量类型。

重要的是要注意这`Object.methods`与以下内容不同`Object.new.methods`：

```
Object.methods.include? :ancestors       #=> true
Object.new.methods.include? :ancestors   #=> false 
```

这是因为对象的*类*有祖先，而不是对象本身（除非对象实际上是类/模块）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:07:17.890

实际上`ancestors`是在类中定义的`Module`。只有作为 Module 或 Class 实例的对象（如`BasicObject`）具有此方法。所以你不能打电话`"something".ancestors`，但你可以做`String.ancestors`or `"something".class.ancestors`。这同样适用于“美元”变量 ( `$!.class.ancestors`)。

# ms-access - 如何为 MS Access 编写区分大小写的查询？

> ID：10046627
> 
> 赞同：8
> 
> 时间：2012-04-06T16:59:51.177
> 
> 标签：ms-access, case-sensitive

我想知道区分大小写的 MS Access 选择查询。

我有两个 VitualMonitorName 值，如下所示

```
VCode VirtualMonitorName
Row 1 (1, 'VM1');
Row 2 (2, 'Vm1'); 
```

这里两个值是不同的。

如果我写

```
"SELECT VCode FROM VirtualMaster WHERE VirtualMonitorName like '" + Vm1 + "'"; 
```

它只回复 VCode = 1。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-06T18:06:29.627

您可以使用`StrComp()`with 函数`vbBinaryCompare`进行区分大小写的比较。这是立即窗口中的一个示例，以显示其`StrComp()`工作原理。有关详细信息，请参阅 Access 帮助主题。

```
? StrComp("a", "A", vbBinaryCompare)
 1 

? StrComp("a", "A",vbTextCompare)
0 
```

`StrComp()`如果前两个参数的计算结果相等，则返回 0，如果它们不相等，则返回 1 或 -1，如果任一参数为 Null，则返回 Null。

要在查询中使用该函数，请提供`vbBinaryCompare`常量的值 (0) 而不是其名称。

```
SELECT VCode
FROM VirtualMaster
WHERE StrComp(VirtualMonitorName, "Vm1", 0) = 0; 
```

如果其他应用程序使用较新的 Access 数据库引擎 ("ACE") 驱动程序，则此方法也可用于来自其他应用程序的查询。例如，下面的 C# 代码

```
string myConnectionString =
        @"Driver={Microsoft Access Driver (*.mdb, *.accdb)};" +
        @"Dbq=C:\Users\Public\Database1.accdb;";
using (OdbcConnection con = new OdbcConnection(myConnectionString))
{
    con.Open();
    using (var cmd = new OdbcCommand())
    {
        cmd.Connection = con;
        cmd.CommandText = 
                "SELECT COUNT(*) AS n FROM [VirtualMaster] " +
                "WHERE StrComp([VirtualMonitorName],?,?) = 0";
        cmd.Parameters.AddWithValue("?", "Vm1");
        cmd.Parameters.Add("?", OdbcType.Int);

        var vbCompareOptions = new Dictionary<string, int>() 
        {
            {"vbBinaryCompare", 0},
            {"vbTextCompare", 1}
        };
        string currentOption = "";

        currentOption = "vbBinaryCompare";
        cmd.Parameters[1].Value = vbCompareOptions[currentOption];
        Console.WriteLine(
                "{0} found {1} record(s)", 
                currentOption, 
                Convert.ToInt32(cmd.ExecuteScalar()));

        currentOption = "vbTextCompare";
        cmd.Parameters[1].Value = vbCompareOptions[currentOption];
        Console.WriteLine(
                "{0} found {1} record(s)",
                currentOption,
                Convert.ToInt32(cmd.ExecuteScalar()));
    }
} 
```

生产

```
vbBinaryCompare found 1 record(s)
vbTextCompare found 2 record(s) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-14T07:30:06.017

看一下这个：

[https://support.microsoft.com/kb/244693?wa=wsignin1.0](https://support.microsoft.com/kb/244693?wa=wsignin1.0)

本文介绍了四种使用 Microsoft Jet 数据库引擎实现区分大小写的 JOIN 的方法。这些方法中的每一种都有优点和缺点，在选择实现之前应该权衡一下。方法是：

*   StrComp
*   区分大小写的 IISAM 驱动程序
*   十六进制扩展
*   二进制字段

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-01T16:39:46.810

仅使用内置函数，在查询设计视图中添加一个额外的自定义列：

```
location: InStr(1,[VCode],"VM1",0) 
```

在找到“VM1”的位置时，零参数请求二进制比较（区分大小写）`[VCode]`

将该列中的条件设置为，`>0`以便仅在 vcode 匹配中具有非零位置的记录`Like "*vm*"`包含确切的 VM1 字符串 -

该`WHERE`子句如下所示：

```
WHERE (((VirtualMaster.VCode) Like "\*vm*") AND ((InStr(1,[VCode],"VM1",0))>0)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-24T06:46:49.113

在更简单的编码级别上使用。

作为 DCOUNT 操作中的条件，检查必须具有正确大小写的字段（列），并忽略空白状态/区域。

```
 '  lngcounter will count the all States 
      ' or Territories Field ( Column) with this 
      ' exact case value of 'Ohio'. ([ID] is an Autonumber ID field)

      lngCounter = DCount("[id]", Trim(Me!tboDwellingTablename), "[State/territory],'Ohio',0) = 0") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-06T00:20:14.013

这只写一个字母：

MS-访问 SQL：

```
SELECT Asc(Left([Title],1)) AS t FROM Master WHERE (((Asc(Left([Title],1)))=105)); 
```

`Title`是您要搜索的字段

`Master``Title`是字段所在的表

`105`字符的ASCII码..

在这种情况下，只有以 i 开头的 Title，而不是 I

如果要搜索小写“a”，请将 105 更改为 97

# mysql - 是否可以使用 MATCH AGAINST 计算每一行匹配多少个单词

> ID：10046628
> 
> 赞同：5
> 
> 时间：2012-04-06T17:00:05.900
> 
> 标签：mysql, full-text-search, match

是否可以直接在mysql查询中？例子：

以布尔模式搜索`+possible +know`

“我想知道这怎么可能” => 2 场比赛

“一切皆有可能” => 1 场比赛

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:39:18.787

# 更新我把原来的答案移了下来

我有一个奇怪的建议

您可能需要使用名为[myisam_ftdump的 mysql 实用程序](http://dev.mysql.com/doc/refman/5.5/en/myisam-ftdump.html)

这是我原始答案中示例的 FULLTEXT 转储

```
C:\MySQL_5.5.12\data\sandro>myisam_ftdump -vc txtdata 1
        2            0.4054651 everyhing
        2            0.4054651 impossible
        1            1.3862944 knew
        3           -0.4054651 know
        2            0.4054651 nothing
        1            1.3862944 people
        2            0.4054651 possible
        1            1.3862944 probable
        1            1.3862944 something 
```

如果您可以将其生成为文本文件，则可以让 PHP 将其解析为您要查找的单词。

# 原始答案

有或没有 BOOLEAN MODE，答案是否定的。

但是，您可以根据单词出现和整体字符串长度显示排名，如下所示：

样本数据

```
DROP DATABASE sandro;
CREATE DATABASE sandro;
use sandro
CREATE TABLE txtdata
(
    id int not null auto_increment,
    txt VARCHAR(255),
    primary key (id),
    FULLTEXT (txt)
) ENGINE=MyISAM;
INSERT INTO txtdata (txt) VALUES
('I know Nothing is possible'),
('We know nothing is impossible'),
('I knew everyhing is possible'),
('We know everyhing is possible'),
('For may people something is probable'); 
```

这是各种搜索排名的结果

```
mysql> SELECT *,MATCH(txt) AGAINST ('possible knew') as score FROM txtdata;
+----+--------------------------------------+--------------------+
| id | txt                                  | score              |
+----+--------------------------------------+--------------------+
|  1 | I know Nothing is possible           | 0.3919430673122406 |
|  2 | We know nothing is impossible        |                  0 |
|  3 | I knew everyhing is possible         |   1.73200523853302 |
|  4 | We know everyhing is impossible      |                  0 |
|  5 | For may people something is probable |                  0 |
+----+--------------------------------------+--------------------+
5 rows in set (0.00 sec)

mysql> SELECT *,MATCH(txt) AGAINST ('possible know') as score FROM txtdata;
+----+--------------------------------------+--------------------+
| id | txt                                  | score              |
+----+--------------------------------------+--------------------+
|  1 | I know Nothing is possible           | 0.3919430673122406 |
|  2 | We know nothing is impossible        |                  0 |
|  3 | I knew everyhing is possible         | 0.3919430673122406 |
|  4 | We know everyhing is impossible      |                  0 |
|  5 | For may people something is probable |                  0 |
+----+--------------------------------------+--------------------+
5 rows in set (0.00 sec)

mysql> SELECT *,MATCH(txt) AGAINST ('impossible knew') as score FROM txtdata;
+----+--------------------------------------+--------------------+
| id | txt                                  | score              |
+----+--------------------------------------+--------------------+
|  1 | I know Nothing is possible           |                  0 |
|  2 | We know nothing is impossible        | 0.3919430673122406 |
|  3 | I knew everyhing is possible         |  1.340062141418457 |
|  4 | We know everyhing is impossible      | 0.3919430673122406 |
|  5 | For may people something is probable |                  0 |
+----+--------------------------------------+--------------------+
5 rows in set (0.00 sec)

mysql> SELECT *,MATCH(txt) AGAINST ('impossible know') as score FROM txtdata;
+----+--------------------------------------+--------------------+
| id | txt                                  | score              |
+----+--------------------------------------+--------------------+
|  1 | I know Nothing is possible           |                  0 |
|  2 | We know nothing is impossible        | 0.3919430673122406 |
|  3 | I knew everyhing is possible         |                  0 |
|  4 | We know everyhing is impossible      | 0.3919430673122406 |
|  5 | For may people something is probable |                  0 |
+----+--------------------------------------+--------------------+
5 rows in set (0.00 sec)

mysql> 
```

# c# - 条件生成器方法链接 Fluent 接口

> ID：10046629
> 
> 赞同：58
> 
> 时间：2012-04-06T17:00:06.660
> 
> 标签：c#, design-patterns, builder, fluent-interface, method-chaining

我想知道使用对象中的**方法链接**在**流畅的接口**`.When`中实现条件的最佳方法是什么？****`Builder`****

 ****例如，我将如何实现以下示例中的`.WithSkill()`和方法：`.When()`

```
var level = 5;

var ninja = NinjaBuilder
    .CreateNinja()
    .Named("Ninja Boy")
    .AtLevel(level)
    .WithShurikens(10)
    .WithSkill(Skill.HideInShadows)
        .When(level > 3)
    .Build() 
```

**更新**- 可以在[此处](http://kenny-bu.blogspot.com/2012/04/conditional-builder.html)找到示例解决方案。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-04-06T17:11:29.503

我要做的是`NinjaBuilder`将操作保留为委托列表，而不是应用它们，并且仅在`.Build`调用时应用它们。这将允许您使它们有条件：

```
public class NinjaBuilder { 
    List<Action<Ninja>> builderActions = new List<Action<Ninja>>();

    public Ninja Build() {
        var ninja = new Ninja();
        builderActions.ForEach(ba => ba(ninja));
        return ninja;
    }

    public NinjaBuilder WithShurikens(int numShirukens) {
        builderActions.Add(n=>n.Shirukens = numShirukens);
        return this;
    }

    public NinjaBuilder When(Boolean condition) {
        if (!condition) // If the condition is not met, remove the last action
            builderActions.RemoveAt(builderActions.Length - 1);
        return this;
    }
} 
```

当然，这假设条件在构建器创建时是恒定的。如果你想让它成为非常量，你可以做这样的事情：

```
 public NinjaBuilder When(Func<Boolean> condition) {
        var oldAction = builderActions[builderActions.Length - 1];
        builderActions[builderActions.Length - 1] = n => { if (condition()) { oldAction(n); } }
        return this;
    } 
```

如果您想要`When`更多地检查编译器，您可以使 builderActions 受保护并执行以下操作：

```
public class ConditionalNinjaBuilder : NinjaBuilder {
    public ConditionalNinjaBuilder(NinjaBuilder wrappedBuilder) {            
        // Since someone might call .WithShirukens on the wrapping
        // builder directly, we should make sure that our actions 
        // list is the same instance as the one in our wrapped builder
        builderActions = wrappedBuilder.builderActions;
    }

    public ConditionalNinjaBuilder When(Func<Boolean> condition) {
        var oldAction = builderActions[builderActions.Length - 1];
        builderActions[builderActions.Length - 1] = n => { if (condition()) { oldAction(n); } }
        return this;
    }
} 
```

并让原始操作返回一个 ConditionalNinjaBuilder：

```
 public ConditionalNinjaBuilder WithShurikens(int numShirukens) {
        builderActions.Add(n=>n.Shirukens = numShirukens);
        return new ConditionalNinjaBuilder(this);
    } 
```

这样你只能`.When`在第一次调用另一个方法后调用。这也具有潜在允许嵌套/复合条件的额外优点/复杂性。哎呀。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-06T18:41:45.687

我有接口链接的解决方案；我的解决方案的唯一问题是，随着您想要支持的每一种新方法，它的复杂性（规模）都会增加。但是，它为用户提供了一个非常棒的 AP​​I。

让我们假设您有 3 个方法，A、B 和 C，并且您想在链中使用它们。

让我们还考虑一下，您不希望能够多次调用任何方法。

例如

```
new Builder().A().B().C(); // OK
new Builder().A().B().A(); // Not OK 
```

这可以通过一些严重的令人敬畏来完成：

```
public class Builder : A<Not_A>, B<Not_B>, C<Not_C>, Not_A, Not_B, Not_C, Not_AB, Not_BC, Not_AC, Empty
{
  Not_AB A<Not_AB>.A() { return (Not_AB)A(); }
  Not_AC A<Not_AC>.A() { return (Not_AC)A(); }
  Empty A<Empty>.A() { return (Empty)A(); }
  public Not_A A()
  {
    return (Not_A)this;
  }

  Not_AB B<Not_AB>.B() { return (Not_AB)B(); }
  Not_BC B<Not_BC>.B() { return (Not_BC)B(); }
  Empty B<Empty>.B() { return (Empty)B(); }
  public Not_B B()
  {
    return (Not_B)this;
  }

  Not_AC C<Not_AC>.C() { return (Not_AC)C(); }
  Not_BC C<Not_BC>.C() { return (Not_BC)C(); }
  Empty C<Empty>.C() { return (Empty)C(); }
  public Not_C C()
  {
    return (Not_C)this;
  }
}

public interface Empty { }

public interface A<TRemainder> { TRemainder A(); }
public interface B<TRemainder> { TRemainder B(); }
public interface C<TRemainder> { TRemainder C(); }

public interface Not_A : B<Not_AB>, C<Not_AC> { }
public interface Not_B : A<Not_AB>, C<Not_BC> { }
public interface Not_C : A<Not_AC>, B<Not_BC> { }

public interface Not_AB : C<Empty> { }
public interface Not_BC : A<Empty> { }
public interface Not_AC : B<Empty> { } 
```

然后，将其与 Chris Shain 的绝妙结合使用一堆动作！

我决定实施它。请注意，您现在不能使用此链接解决方案两次调用任何方法。我把你的`When`方法作为扩展方法。

这是调用代码：

```
 int level = 5;
  var ninja = NinjaBuilder
      .CreateNinja()
      .Named("Ninja Boy")
      .AtLevel(level)
      .WithShurikens(10)
      .WithSkill(Skill.HideInShadows)
          .When(n => n.Level > 3)
      .Build(); 
```

这是我的忍者和技能课程：

```
public class Ninja
{
  public string Name { get; set; }
  public int Level { get; set; }
  public int Shurikens { get; set; }
  public Skill Skill { get; set; }
}

public enum Skill
{
  None = 1,
  HideInShadows
} 
```

这是 NinjaBuilder 类：

```
public class NinjaBuilder : NinjaBuilder_Sans_Named
{
  public static NinjaBuilder CreateNinja() { return new NinjaBuilder(); }
  public Stack<Action<Ninja>> _buildActions;

  public NinjaBuilder()
  {
    _buildActions = new Stack<Action<Ninja>>();
  }

  public override Ninja Build()
  {
    var ninja = new Ninja();
    while (_buildActions.Count > 0)
    {
      _buildActions.Pop()(ninja);
    }

    return ninja;
  }

  public override void AddCondition(Func<Ninja, bool> condition)
  {
    if (_buildActions.Count == 0)
      return;

    var top = _buildActions.Pop();
    _buildActions.Push(n => { if (condition(n)) { top(n); } });
  }

  public override Sans_Named_NinjaBuilder Named(string name)
  {
    _buildActions.Push(n => n.Name = name);
    return this;
  }

  public override Sans_AtLevel_NinjaBuilder AtLevel(int level)
  {
    _buildActions.Push(n => n.Level = level);
    return this;
  }

  public override Sans_WithShurikens_NinjaBuilder WithShurikens(int shurikenCount)
  {
    _buildActions.Push(n => n.Shurikens = shurikenCount);
    return this;
  }

  public override Sans_WithSkill_NinjaBuilder WithSkill(Skill skillType)
  {
    _buildActions.Push(n => n.Skill = skillType);
    return this;
  }
} 
```

这段代码的其余部分只是使转换和调用工作的开销：

```
public abstract class NinjaBuilderBase :
  EmptyNinjaBuilder,
  Named_NinjaBuilder<Sans_Named_NinjaBuilder>,
  AtLevel_NinjaBuilder<Sans_AtLevel_NinjaBuilder>,
  WithShurikens_NinjaBuilder<Sans_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_WithSkill_NinjaBuilder>
{
  public abstract void AddCondition(Func<Ninja, bool> condition);
  public abstract Ninja Build();

  public abstract Sans_WithSkill_NinjaBuilder WithSkill(Skill skillType);
  public abstract Sans_WithShurikens_NinjaBuilder WithShurikens(int shurikenCount);
  public abstract Sans_AtLevel_NinjaBuilder AtLevel(int level);
  public abstract Sans_Named_NinjaBuilder Named(string name);
}

public abstract class NinjaBuilder_Sans_WithSkill : NinjaBuilderBase,
  Sans_WithSkill_NinjaBuilder
{
  Sans_Named_WithSkill_NinjaBuilder Named_NinjaBuilder<Sans_Named_WithSkill_NinjaBuilder>.Named(string name) { return (Sans_Named_WithSkill_NinjaBuilder)Named(name); }
  Sans_AtLevel_WithSkill_NinjaBuilder AtLevel_NinjaBuilder<Sans_AtLevel_WithSkill_NinjaBuilder>.AtLevel(int level) { return (Sans_AtLevel_WithSkill_NinjaBuilder)AtLevel(level); }
  Sans_WithShurikens_WithSkill_NinjaBuilder WithShurikens_NinjaBuilder<Sans_WithShurikens_WithSkill_NinjaBuilder>.WithShurikens(int shurikenCount) { return (Sans_WithShurikens_WithSkill_NinjaBuilder)WithShurikens(shurikenCount); }
}

public abstract class NinjaBuilder_Sans_WithShurikens : NinjaBuilder_Sans_WithSkill,
  Sans_WithShurikens_NinjaBuilder,
  Sans_WithShurikens_WithSkill_NinjaBuilder
{
  Sans_Named_WithShurikens_WithSkill_NinjaBuilder Named_NinjaBuilder<Sans_Named_WithShurikens_WithSkill_NinjaBuilder>.Named(string name) { return (Sans_Named_WithShurikens_WithSkill_NinjaBuilder)Named(name); }
  Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder AtLevel_NinjaBuilder<Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder>.AtLevel(int level) { return (Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder)AtLevel(level); }
  Sans_Named_WithSkill_NinjaBuilder Named_NinjaBuilder<Sans_Named_WithSkill_NinjaBuilder>.Named(string name) { return (Sans_Named_WithSkill_NinjaBuilder)Named(name); }
  Sans_AtLevel_WithShurikens_NinjaBuilder AtLevel_NinjaBuilder<Sans_AtLevel_WithShurikens_NinjaBuilder>.AtLevel(int level) { return (Sans_AtLevel_WithShurikens_NinjaBuilder)AtLevel(level); }
  Sans_WithShurikens_WithSkill_NinjaBuilder WithSkill_NinjaBuilder<Sans_WithShurikens_WithSkill_NinjaBuilder>.WithSkill(Skill skillType) { return (Sans_WithShurikens_WithSkill_NinjaBuilder)WithSkill(skillType); }
}

public abstract class NinjaBuilder_Sans_AtLevel : NinjaBuilder_Sans_WithShurikens,
  Sans_AtLevel_NinjaBuilder,
  Sans_AtLevel_WithShurikens_NinjaBuilder,
  Sans_AtLevel_WithSkill_NinjaBuilder,
  Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder
{
  EmptyNinjaBuilder Named_NinjaBuilder<EmptyNinjaBuilder>.Named(string name) { return Named(name); }
  Sans_Named_AtLevel_WithSkill_NinjaBuilder Named_NinjaBuilder<Sans_Named_AtLevel_WithSkill_NinjaBuilder>.Named(string name) { return (Sans_Named_AtLevel_WithSkill_NinjaBuilder)Named(name); }
  Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder WithShurikens_NinjaBuilder<Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder>.WithShurikens(int shurikenCount) { return (Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder)WithShurikens(shurikenCount); }
  Sans_Named_AtLevel_WithShurikens_NinjaBuilder Named_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>.Named(string name) { return (Sans_Named_AtLevel_WithShurikens_NinjaBuilder)Named(name); }
  Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder WithSkill_NinjaBuilder<Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder>.WithSkill(Skill skillType) { return (Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder)WithSkill(skillType); }
  Sans_Named_AtLevel_NinjaBuilder Named_NinjaBuilder<Sans_Named_AtLevel_NinjaBuilder>.Named(string name) { return (Sans_Named_AtLevel_NinjaBuilder)Named(name); }
  Sans_AtLevel_WithShurikens_NinjaBuilder WithShurikens_NinjaBuilder<Sans_AtLevel_WithShurikens_NinjaBuilder>.WithShurikens(int shurikenCount) { return (Sans_AtLevel_WithShurikens_NinjaBuilder)WithShurikens(shurikenCount); }
  Sans_AtLevel_WithSkill_NinjaBuilder WithSkill_NinjaBuilder<Sans_AtLevel_WithSkill_NinjaBuilder>.WithSkill(Skill skillType) { return (Sans_AtLevel_WithSkill_NinjaBuilder)WithSkill(skillType); }
}

public abstract class NinjaBuilder_Sans_Named : NinjaBuilder_Sans_AtLevel,
  Sans_Named_NinjaBuilder,
  Sans_Named_AtLevel_NinjaBuilder,
  Sans_Named_WithShurikens_NinjaBuilder,
  Sans_Named_WithSkill_NinjaBuilder,
  Sans_Named_WithShurikens_WithSkill_NinjaBuilder,
  Sans_Named_AtLevel_WithSkill_NinjaBuilder,
  Sans_Named_AtLevel_WithShurikens_NinjaBuilder
{
  EmptyNinjaBuilder WithSkill_NinjaBuilder<EmptyNinjaBuilder>.WithSkill(Skill skillType) { return (EmptyNinjaBuilder)WithSkill(skillType); }
  EmptyNinjaBuilder WithShurikens_NinjaBuilder<EmptyNinjaBuilder>.WithShurikens(int shurikenCount) { return (EmptyNinjaBuilder)WithShurikens(shurikenCount); }
  EmptyNinjaBuilder AtLevel_NinjaBuilder<EmptyNinjaBuilder>.AtLevel(int level) { return (EmptyNinjaBuilder)AtLevel(level); }
  Sans_Named_AtLevel_WithShurikens_NinjaBuilder AtLevel_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>.AtLevel(int level) { return (Sans_Named_AtLevel_WithShurikens_NinjaBuilder)AtLevel(level); }
  Sans_Named_WithShurikens_WithSkill_NinjaBuilder WithShurikens_NinjaBuilder<Sans_Named_WithShurikens_WithSkill_NinjaBuilder>.WithShurikens(int shurikenCount) { return (Sans_Named_WithShurikens_WithSkill_NinjaBuilder)WithShurikens(shurikenCount); }
  Sans_Named_WithShurikens_WithSkill_NinjaBuilder WithSkill_NinjaBuilder<Sans_Named_WithShurikens_WithSkill_NinjaBuilder>.WithSkill(Skill skillType) { return (Sans_Named_WithShurikens_WithSkill_NinjaBuilder)WithSkill(skillType); }
  Sans_Named_AtLevel_WithShurikens_NinjaBuilder WithShurikens_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>.WithShurikens(int shurikenCount) { return (Sans_Named_AtLevel_WithShurikens_NinjaBuilder)WithShurikens(shurikenCount); }
  Sans_Named_AtLevel_WithSkill_NinjaBuilder WithSkill_NinjaBuilder<Sans_Named_AtLevel_WithSkill_NinjaBuilder>.WithSkill(Skill skillType) { return (Sans_Named_AtLevel_WithSkill_NinjaBuilder)WithSkill(skillType); }
  Sans_Named_AtLevel_NinjaBuilder AtLevel_NinjaBuilder<Sans_Named_AtLevel_NinjaBuilder>.AtLevel(int level) { return (Sans_Named_AtLevel_NinjaBuilder)AtLevel(level); }
  Sans_Named_WithShurikens_NinjaBuilder WithShurikens_NinjaBuilder<Sans_Named_WithShurikens_NinjaBuilder>.WithShurikens(int shurikenCount) { return (Sans_Named_WithShurikens_NinjaBuilder)WithShurikens(shurikenCount); }
  Sans_Named_WithSkill_NinjaBuilder WithSkill_NinjaBuilder<Sans_Named_WithSkill_NinjaBuilder>.WithSkill(Skill skillType) { return (Sans_Named_WithSkill_NinjaBuilder)WithSkill(skillType); }
}

public static class NinjaBuilderExtension
{
  public static TBuilderLevel When<TBuilderLevel>(this TBuilderLevel ths, Func<Ninja, bool> condition) where TBuilderLevel : EmptyNinjaBuilder
  {
    ths.AddCondition(condition);
    return ths;
  }
}

public interface EmptyNinjaBuilder { void AddCondition(Func<Ninja, bool> condition); Ninja Build(); }

public interface Named_NinjaBuilder<TRemainder> { TRemainder Named(string name); }
public interface AtLevel_NinjaBuilder<TRemainder> { TRemainder AtLevel(int level);}
public interface WithShurikens_NinjaBuilder<TRemainder> { TRemainder WithShurikens(int shurikenCount); }
public interface WithSkill_NinjaBuilder<TRemainder> { TRemainder WithSkill(Skill skillType); }

// level one reductions
public interface Sans_Named_NinjaBuilder :
  AtLevel_NinjaBuilder<Sans_Named_AtLevel_NinjaBuilder>,
  WithShurikens_NinjaBuilder<Sans_Named_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_Named_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
public interface Sans_AtLevel_NinjaBuilder :
  Named_NinjaBuilder<Sans_Named_AtLevel_NinjaBuilder>,
  WithShurikens_NinjaBuilder<Sans_AtLevel_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_AtLevel_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
public interface Sans_WithShurikens_NinjaBuilder :
  Named_NinjaBuilder<Sans_Named_WithSkill_NinjaBuilder>,
  AtLevel_NinjaBuilder<Sans_AtLevel_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
public interface Sans_WithSkill_NinjaBuilder :
  Named_NinjaBuilder<Sans_Named_WithSkill_NinjaBuilder>,
  AtLevel_NinjaBuilder<Sans_AtLevel_WithSkill_NinjaBuilder>,
  WithShurikens_NinjaBuilder<Sans_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }

// level two reductions
// Named
public interface Sans_Named_AtLevel_NinjaBuilder :
  WithShurikens_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_Named_AtLevel_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
public interface Sans_Named_WithShurikens_NinjaBuilder :
  AtLevel_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_Named_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
public interface Sans_Named_WithSkill_NinjaBuilder :
  AtLevel_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>,
  WithShurikens_NinjaBuilder<Sans_Named_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
// AtLevel
public interface Sans_AtLevel_WithShurikens_NinjaBuilder :
  Named_NinjaBuilder<Sans_Named_AtLevel_WithShurikens_NinjaBuilder>,
  WithSkill_NinjaBuilder<Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
public interface Sans_AtLevel_WithSkill_NinjaBuilder :
  Named_NinjaBuilder<Sans_Named_AtLevel_WithSkill_NinjaBuilder>,
  WithShurikens_NinjaBuilder<Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }
// WithShurikens
public interface Sans_WithShurikens_WithSkill_NinjaBuilder :
  Named_NinjaBuilder<Sans_Named_WithShurikens_WithSkill_NinjaBuilder>,
  AtLevel_NinjaBuilder<Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder>,
  EmptyNinjaBuilder { }

// level three reductions
// Named
public interface Sans_AtLevel_WithShurikens_WithSkill_NinjaBuilder :
  Named_NinjaBuilder<EmptyNinjaBuilder>,
  EmptyNinjaBuilder { }
// AtLevel
public interface Sans_Named_WithShurikens_WithSkill_NinjaBuilder :
  AtLevel_NinjaBuilder<EmptyNinjaBuilder>,
  EmptyNinjaBuilder { }
// WithShurikens
public interface Sans_Named_AtLevel_WithSkill_NinjaBuilder :
  WithShurikens_NinjaBuilder<EmptyNinjaBuilder>,
  EmptyNinjaBuilder { }
// WithSkill
public interface Sans_Named_AtLevel_WithShurikens_NinjaBuilder :
  WithSkill_NinjaBuilder<EmptyNinjaBuilder>,
  EmptyNinjaBuilder { } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-06T17:02:27.720

`true`默认情况下，您的方法中可以有一个条件可选参数：

```
.WithSkill(Skill.HideInShadows, when: level > 3) 
```

这当然是非常具体的`WithSkill`方法：

```
public NinjaBuilder WithSkill(Skill skill, bool when = true) {
  if (!when) return this;
  // ...
} 
```

您也可以将其添加到您也希望有条件的其他方法中。

另一种选择是使用嵌套构建器的条件部分的方法：

```
public NinjaBuilder When(bool condition, Action<NinjaBuilder> then) {
  if (condition) then(this);
  return this;
} 
```

然后你可以这样写：

```
.When(level > 3, 
  then: _ => _.WithSkill(Skill.HideInShadows)) 
```

或者像这样：

```
.When(level > 3, _=>_
  .WithSkill(Skill.HideInShadows)
) 
```

这更通用，可以与构建器的任何方法一起使用。

你甚至可以添加一个可选的“else”：

```
public NinjaBuilder When(bool condition, Action<NinjaBuilder> then, Action<NinjaBuilder> otherwise = null) {
  if (condition) {
    then(this);
  }
  else if (otherwise != null) {
    otherwise(this);
  }
  return this;
} 
```

或者，作为[“混合”](http://codecrafter.blogspot.ca/2010/02/c-quasi-mixins-pattern.html)：

```
public interface MBuilder {}
public static class BuilderExtensions {
  public static TBuilder When<TBuilder>(this TBuilder self, bool condition, Action<TBuilder> then, Action<TBuilder> otherwise = null)
  where TBuilder : MBuilder
  {
    if (condition) {
      then(self);
    }
    else if (otherwise != null) {
      otherwise(self);
    }
    return self;
  }
}

public class NinjaBuilder : MBuilder ... 
```

这当然是一种将“if”语句创建为方法调用的方法。其他方法也可以工作：

```
.When(level > 3) // enter "conditional" context
  .WithSkill(Skill.HideInShadows)
.End() // exit "conditional" context 
```

在这种情况下，如果条件为假，构建器会跟踪是否应该忽略在“条件”上下文中完成的任何方法调用。`When`将进入上下文，`End`将退出它。您还可以`Otherwise()`调用来标记“else”上下文。有趣的是，您还可以涵盖其他类似这样的语句，例如循环：

```
.Do(times: 10) // add 10 shurikens
  .AddShuriken()
.End() 
```

在这种情况下，在“循环”上下文中进行的调用必须被记录并在被调用时播放所需的次数`End`。

因此，上下文是构建器可以处于的一种*状态；*他们改变了它的运作方式。您还可以嵌套上下文，使用堆栈来跟踪它们。您应该检查某些调用在某些状态下是否有效，如果不是，则可能抛出异常。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-06T17:10:24.813

您可以考虑编写 With 的重载版本，然后将 Where 作为参数：

```
var level = 5;  
var ninja = NinjaBuilder     
     .CreateNinja()
     .Named("Ninja Boy")
     .AtLevel(level)
     .WithShurikens(10)
     .WithSkill(Skill.HideInShadows, Where.Level(l => l > 3))
     .Build() 
```

当然，这是基于您将 Where 完全作为一个单独的对象编写的概念，它基本上看起来像这样：

```
public sealed static class Where
{
    public bool Defense (Func<int, bool> predicate) { return predicate(); }
    public bool Dodge (Func<int, bool> predicate) { return predicate(); }
    public bool Level (Func<int, bool> predicate) { return predicate(); }

} 
```****

# jquery - 更改html后jQuery函数无响应

> ID：10046632
> 
> 赞同：0
> 
> 时间：2012-04-06T17:00:26.283
> 
> 标签：jquery

```
$(document).ready(function () {

  $(".tab_content").hide(); //Hide all content
  $(".tab_content:first").show(); //Show first tab content

  $(".next").click(function() {
    $(".tab_content").hide(); //Hide all tab content
    $('#tab_change').html('<div class="back"></div>');  
    $("#tab2").show();  
    return false;
  });

  $(".back").click(function() {
    $(".tab_content").hide(); //Hide all tab content
    $('#tab_change').html('<div class="next"></div>');  
    $("#tab1").show();  
    return false;
  }); 
```

问题是，单击下一步时，会打开第二个选项卡。但是在`#tab_change`改变 html 之后，后退按钮是响应式的。`$(".back").click(function() {`不起作用。

HTML 已发布以供参考。

```
 <div class="dialog_content" style="width:780px">

        <div id="tab_change" class="left border_right">
            <div class="next"></div>
        </div>

    <div id="tab1" class="tab_content">
    </div>

    <div id="tab2" class="tab_content">

        <div class="right"><?php include("C:/easyphp/www/zabjournal/lib/flexpaper/php/split_document.php"); ?>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:02:53.057

您需要绑定[.on()](http://api.jquery.com/on/)函数。由于加载DOM时back div没有退出，因此需要将click事件绑定到它。改变：

```
$(".back").click(function() {
    $(".tab_content").hide(); //Hide all tab content
    $('#tab_change').html('<div class="next"></div>');  
    $("#tab1").show();  
    return false;
}); 
```

到：

```
$('body').on('click','.back', function() {
    $(".tab_content").hide(); //Hide all tab content
    $('#tab_change').html('<div class="next"></div>');  
    $("#tab1").show();  
    return false;
}); 
```

当您使用 .click() 时，您将 click 事件绑定到加载 DOM 时存在的元素。但是，您的“后退” div 尚不存在，因此您无法将任何内容绑定到它。通过使用 .on()，jQuery 监视 DOM 以查看该元素是否被创建，并且当它创建时，将单击事件附加到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:10:33.533

我认为您对简单的显示和隐藏有太多的 dom 操作。试试下面的东西，

[**演示**](http://jsfiddle.net/skram/YwEKm/)

```
$(document).ready(function () {    
  var $tab1 = $("#tab1"), $tab2 = $('#tab2');    

  $tab2.hide();
  $tab1.show(); //Show first tab

  $('#tab_change div').click (function () {
        var $this = $(this);
        if ($this.hasClass('next')) {
           $this
             .removeClass('next')
             .addClass('back');

           $tab1.hide();
           $tab2.show(); 
        } else {
           $this
             .removeClass('back')
             .addClass('next');

           $tab2.hide();
           $tab1.show();
        }
  });
 }); 
```

# css - 如何使动态大小的高度 与宽度相同

> ID：10046635
> 
> 赞同：3
> 
> 时间：2012-04-06T17:00:36.990
> 
> 标签：css

我有一个 div，其宽度是其容器宽度的百分比。我的问题是如何确保高度与宽度的像素长度相同，因为容器不是正方形（所以我不能仅仅将高度百分比设置为与宽度相同的值）。另外，我希望有一个纯 CSS 解决方案，而不必在 JavaScript 中使用`offsetWidth`、`clientWidth`或其他此类属性。

例子：

```
<div style="width:45%;background-color:blue">My Content!</div> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-13T21:34:42.273

也许是这样的：http: [//jsfiddle.net/gcvogxgL/](http://jsfiddle.net/gcvogxgL/)

```
p { background-color: red; overflow: hidden; display: inline-block;}
p:before{content: ""; display: block; float: left; margin-top: 100%; }
p:after{ clear: both; content: ""; display: block; height: 1px;
margin-top: 100%; position: absolute; top: 0; }
```

```
<p>This is short</p>
<p>This is a medium</p>
<p>This is a very long square</p>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:18:15.280

恐怕这对于纯 CSS 是不可能的。

如果你不介意，让我提供一个[jQuery](http://jquery.com/)解决方案：

```
var $elem = ​$('div');
$(window).resize(function () {
    $elem.height($elem.width());
}).resize(); 
```

即使窗口大小发生变化，这也将保持高度与宽度相同。您可以在演示中试用（尝试调整大小）：

*   [jsFiddle 演示](http://jsfiddle.net/KReCT/)
*   [jsFiddle Demo 带有自调用函数而不是调用`resize()`](http://jsfiddle.net/KReCT/1/)

我使用 jQuery 是因为它对浏览器处理元素宽度和高度的方式有很大帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:18:39.520

这对于纯 CSS 是不可能的。使用一小块 Javascript，它突然变得非常容易。

```
$("#mydiv").css("height", $("#mydiv").css("width"));​ 
```

# iphone - 设置核心数据属性会导致故障触发吗？

> ID：10046639
> 
> 赞同：0
> 
> 时间：2012-04-06T17:00:56.040
> 
> 标签：iphone, ios, core-data, fault

我阅读了下面的链接，仍然想知道：是否可以设置核心数据属性（例如，`person.name = @"Matt"`导致故障触发？

*   [iOS 核心数据编程指南中的故障和唯一性](http://j.mp/HsyqmN)
*   [iOS 核心数据编程指南中的错误行为](http://j.mp/Hsx7Eg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T11:57:19.697

绝对 - 读取或设置 Core Data 属性可能会引发故障。很容易看出 willRead 是如何导致这种情况的（必须去持久化存储来获取数据），而 willWrite 似乎也做了同样的事情（我可以​​想象它想将要写的内容与实际存在的内容进行比较，来确定该级别是否真的有任何事情要做`NSPersistentStoreController`）。

# c++ - 从 CRAN 安装 pcaPP 包时出现编译时间错误，有什么想法可能是由于？

> ID：10046641
> 
> 赞同：1
> 
> 时间：2012-04-06T17:01:22.073
> 
> 标签：c++, r, compiler-errors

我在 R 2.15.0 中运行 install.packages('mvoutliers', dependencies=TRUE) 并在包 pcaPP 中失败。有任何想法吗？

```
* installing *source* package ‘pcaPP’ ...
** package ‘pcaPP’ successfully unpacked and MD5 sums checked
** libs
g++ -I/usr/include/R/ -DNDEBUG -DR_PACKAGE_FILE -I/usr/local/include    -fpic  -march=x86-64 -mtune=generic -O2 -pipe -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2  -c L1Median_HoCr.cpp -o L1Median_HoCr.o
In file included from smat.h:28:0,
                 from L1Median.h:5,
                 from L1Median_HoCr.cpp:1:
smat.base.h: In instantiation of ‘void SVec<T>::Copy(const tc_this&) const [with T = double; SVec<T>::tc_this = SCVec<double>]’:
L1Median_HoCr.cpp:93:32:   required from here
smat.base.h:882:4: error: ‘EqualDims’ was not declared in this scope, and no declarations were found by argument-dependent lookup at the point of instantiation [-fpermissive]
smat.base.h:882:4: note: declarations in dependent base ‘CDimCont<1u>’ are not found by unqualified lookup
smat.base.h:882:4: note: use ‘this->EqualDims’ instead
make: *** [L1Median_HoCr.o] Error 1
ERROR: compilation failed for package ‘pcaPP’
* removing ‘/usr/lib/R/library/pcaPP’
ERROR: dependency ‘rgl’ is not available for package ‘compositions’
* removing ‘/usr/lib/R/library/compositions’ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T18:04:26.827

这看起来像是文件中的真正错误`smat.base.h`。

您可以尝试与`pcaPP`.

# objective-c - Objective-C NSPredicate 链接

> ID：10046643
> 
> 赞同：3
> 
> 时间：2012-04-06T17:01:28.570
> 
> 标签：objective-c, ios5, nspredicate

全部，

我正在尝试使用谓词来返回搜索结果，优先考虑以搜索字符串 VS 开头的字符串。简单地包含在其中。

例如，如果搜索字符串是“Objective-C”，我希望得到过滤后的结果，如下所示：

Objective-C 入门
Objective-C 模式
Objective-C 编程
关于 Objective-C
如何在 Objective-C 中编程

这是我尝试过的，但由于它是 OR，它显然不会优先于第一个条件。有没有办法用谓词做一种“链接”？谢谢

```
 NSPredicate *filter = [NSPredicate predicateWithFormat:@"subject BEGINSWITH [cd] %@ OR subject CONTAINS [cd]", searchText,searchText];
  NSArray *filtered = [myArray filteredArrayUsingPredicate: filter]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:13:39.207

我认为 NSPredicate 本身没有办法处理。您似乎要求的是排序结果。在从谓词中取回结果后，您可以通过对结果进行排序来做到这一点。在这种情况下，由于排序顺序不是简单的字母顺序，您应该使用 NSArray 的`-sortedArrayUsingComparator:`方法。像这样的东西（未经测试，在我的脑海中输入）。

```
NSArray *sortedStrings = [filtered sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
    NSString *string1 = (NSString *)obj1;
    NSString *string2 = (NSString *)obj2;
    NSUInteger searchStringLocation1 = [string1 rangeOfString:searchString].location;
    NSUInteger searchStringLocation2 = [string2 rangeOfString:searchString].location;
    if (searchStringLocation1 < searchStringLocation2) return NSOrderedDescending;
    if (searchStringLocation1 > searchStringLocation2) return NSOrderedAscending;
    return NSOrderedSame;
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:14:48.850

看起来您正在尝试使用谓词对数组进行排序，或者尝试仅使用谓词进行过滤和排序。谓词返回布尔值：字符串以搜索文本开头或包含搜索文本，或者不包含。谓词不会告诉您任何有关相对顺序的信息。过滤数组会删除那些您提供的谓词返回 NO 的对象，因此只有以搜索文本开头或包含搜索文本的对象才会出现在过滤后的数组中。事实上，由于任何以搜索文本开头的字符串也包含它，因此您可以将谓词简化为“包含”部分。

如果要更改过滤结果的顺序，请使用适当的比较器对过滤后的数组进行排序。

# php - 正则表达式不知道停在哪里

> ID：10046644
> 
> 赞同：1
> 
> 时间：2012-04-06T17:01:30.880
> 
> 标签：php, regex

我有一堆带有标签的文档，如下所示（粗体）：

Lorem ipsum dolor sit amet, **\ConsecTeturTitle**。Sed posuere consectetur est 在 lobortis。Lorem ipsum dolor sit amet, consectetur adipiscing elit。\textit{ **\QuamLoremTitle** }\specialnote{参见 { **\EgestasMagnaTitle** }Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor。Nullam quis risus eget urna mollis ornare vel eu leo。Cras justo odio，dapibus ac facilisis in，egestas eget quam。

我正在使用它来找到它们：

```
\\[A-Z].*Title 
```

它在第一个方面做得很好：

**\ConsecTeturTitle**

但它会选择接下来的两个，以及介于两者之间的所有内容，如下所示：

**\QuamLoremTitle}\specialnote{见 {\EgestasMagnaTitle**

我一直在寻找答案，但恐怕我对 RegEx 的了解还不够，甚至不知道要搜索的正确内容。

基本上我需要找到以“\”和大写字母开头并以“Title”结尾的每个标签；然后我需要用“\hl”替换它们

我打算用这样的PHP来做：

```
preg_replace( '\\[A-Z].*Title', '\hl', $docContents ); 
```

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:02:48.117

该正则表达式有一个问题：它包含一个额外的点。你应该使用类似这样的东西：

```
\\[A-Za-z]+Title 
```

您现有表达式的问题是`.*`匹配*任意数量的字符*并且它如此*贪婪*（即，只要它可以继续运行并且最后仍然匹配，它就永远不会停止`Title`）。所以发生的事情是它从“第一个”匹配开始匹配，然后继续吞噬字符，直到它停止在应该是最后一个匹配的“标题”后缀处。

# c++ - 模板化 pimpl 转发

> ID：10046646
> 
> 赞同：0
> 
> 时间：2012-04-06T17:01:45.170
> 
> 标签：c++, templates, pimpl-idiom

我在一种模板层次结构中有一堆相关的指标，看起来像

```
template <int level>
struct index{
    index<level - 1> w;
    int x, y;
};

template <> struct index<0> { int x, y; };

template <int level>
struct data; 
```

以及一个应该生成和缓存由它们索引的对象的类。我想对这个类使用 pimpl，我想知道是否有一种方法可以使用模板将函数调用转发到实现类。就像是

```
class Cache{
    template <int level>
    shared_ptr<data<level>> get_data(const index<level> & index);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:56:45.087

简而言之，不（如果我正确理解您的问题）。

问题是在转发器的实现点，您需要实现类的完整定义（而不仅仅是声明）。如果你想为此目的使用模板成员函数，你需要在每个使用它们的编译单元中定义它们，即通常在你声明它们的同一个头文件中。这意味着需要在声明接口类的同一标头中定义实现类（这会破坏首先对类进行 pimpling 的目的）。

（如果您的编译器支持`export`关键字，您可以单独定义模板方法，因此在这种情况下它会起作用。实际上，Comeau 是我所知道的唯一支持的编译器`export`，并且它已从 C++11 中完全删除）。

比较[如何使用模板函数避免链接器错误？](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.13)在 C++-FAQ-lite 中。

# node.js - Node.js express 框架提供静态 swf 文件

> ID：10046650
> 
> 赞同：0
> 
> 时间：2012-04-06T17:02:05.043
> 
> 标签：node.js, flash, express

我需要使用生成动态视图的快速框架来提供静态 swf，类似于：

```
 app.get('/*', function(req, res){
// serve swf here

}); 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T17:16:04.607

有什么原因你不能只声明一个静态文件夹吗？

```
app.use(express.static(__dirname + '/public')); 
```

如果您不想使用 Express 静态文件夹，那么您可以从文件系统中读取文件并直接提供它。

```
res.sendfile('path/to/my.swf'); 
```

# ruby-on-rails-3 - 在 RoR 中使用设计 - 如何只有几个页面不需要登录 - 覆盖 authenticate_user

> ID：10046651
> 
> 赞同：0
> 
> 时间：2012-04-06T17:02:09.720
> 
> 标签：ruby-on-rails-3, authentication, devise

对于我的大部分网站，我想要求登录。但是对于两个页面，我需要让用户能够在不登录的情况下提交到页面。

有没有办法覆盖

```
before_filter :authenticate_user! 
```

我把它放在应用程序控制器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:06:23.187

```
before_filter :authenticate_user!, :except => [:action_name_1, :action_name_2] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T22:10:25.307

在您想要的控制器中，添加：

```
skip_before_filter :authenticate_user!, :only => [:some_action, :another_action] 
```

[在Module ActionController::Filters::ClassMethods](http://ap.rubyonrails.org/classes/ActionController/Filters/ClassMethods.html)阅读有关过滤器的更多信息

# asp.net - 是否可以使用 ASP.Net 2.0 在 ASPX 页面中托管 WebService？

> ID：10046652
> 
> 赞同：0
> 
> 时间：2012-04-06T17:02:12.550
> 
> 标签：asp.net, vb.net, jquery, jquery-datatables

在将页面从普通回发转换为 AJAX 调用的过程中（使用 JavaScript 完全加载/控制 UI 并严格使用 ASP.Net 作为后端），我发现自己想用 AJAX 来源的数据集替换 GridView。

我目前使用[DataTables](http://datatables.net/)来美化 GridView，并且 API 中有一个选项可以使用 AJAX 远程获取表的数据。API 需要返回一个 JSON 对象，尽管我似乎可以为该`fnServerData`选项提供一个回调，这将允许我将 XML 响应转换为必需的 JSON 数据源。

“所以”，我想，“我还不如一起来`<WebMethod()>`返回数据源......”虽然我过去写过几个`<WebMethod()>`函数，但我总是添加一个新的 ASMX 文件（带有一个自定义类驱动它）或在有意义的地方扩展现有的。对于这个特定的页面，不需要让这个表的数据源可以在页面的上下文之外访问，所以我想我会尝试添加`<WebMethod()>`到 ASPX 页面的代码隐藏。

在程序员的网络上似乎有几个例子成功地完成了我一直在努力解决的问题。

我遵循了我能找到的每一个例子，但没有一个对我有用。我整理了一个非常简单的示例，希望有人可以指出我哪里出错了，或者确认 ASP.Net 2.0 根本无法以这种方式工作。

**ASP 标记：**

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="AJAXText.aspx.vb" Inherits="_AJAXText" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>

    </div>
    </form>
    <script type="text/javascript" src='<%=Helpers.ToAbsoluteURL("~/_cs/js/jquery-1.6.4.min.js") %>'></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $.ajax({
                type: "POST",
                url: window.location.href + "/Hello",
                data: {
                    "What": "World"
                },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data, textStatus, jqXHR) {
                    $('div').text(textStatus);
                },
                complete: function (jqXHR, textStatus) {
                    $('div').text(textStatus);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $('div').text(textStatus);
                }
            });
        });
    </script>
</body>
</html> 
```

**代码隐藏：**

```
Imports System.Web.Services

Partial Class _AJAXText
    Inherits System.Web.UI.Page

    <WebMethod()> _
    Public Shared Function Hello(ByVal What As String) As String
        Dim msg As String = "Hello, " & What & "!"
        Return msg
    End Function
End Class 
```

我已经尝试了对上述内容的一些小改动，并且在每种情况下 AJAX 调用都会返回以下内容：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Untitled Page</title>
    </head>
    <body>
        <form name="form1" method="post" action="AJAXText.aspx?What=World%2fHello"
        id="form1">
            <div>
                <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUJOTU4MjMyMzI1ZGQT/2jrJ+cI2ERazl2Hw7l7TI5XiA==" />
            </div>
            <div></div>
        </form>
        <script type="text/javascript" src='http://localhost:3719/Maggie/_cs/js/jquery-1.6.4.min.js'></script>
        <script type="text/javascript">
        $(document).ready(function () {
            $.ajax({
                type: "POST",
                url: window.location.href + "/Hello",
                data: {
                    "What": "World"
                },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data, textStatus, jqXHR) {
                    $('div').text(textStatus);
                },
                complete: function (jqXHR, textStatus) {
                    $('div').text(textStatus);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $('div').text(textStatus);
                }
            });
        });
        </script>
    </body>
</html> 
```

我期望返回的是：

```
<?xml version="1.0" encoding="utf-8"?>
<string>Hello, World!</string> 
```

有没有人有任何想法：

1.  我做错了什么？
2.  还是 ASP.Net 2.0 无法`<WebMethod()>`在 ASPX 页面中使用 a？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:24:32.690

看起来您的数据提供不正确。应该：

```
data: "{' + "What" + ':'" + "World" + "'}", 
```

我选择了“什么”和“世界”，因为我认为它们是来自其他地方的变量值。

因此，如果：

```
var x = "World";

.ajax(){
.....
.data: "{'What':'" + x + "'}", 
```

是正确的

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T14:15:00.117

好的，我终于找到了完整的答案（以及对@TheGeekYouNeed 的 +1 证明是解决方案的一部分）。

ASP.Net 2.0 不**支持**开箱`WebMethod()`即用的 ASPX 页面。总共有三个步骤（对我来说）来启用对`WebMethod()`ASPX 页面的支持。

1.  下载并安装[Microsoft ASP.NET 2.0 AJAX Extensions 1.0](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=883)。
2.  将以下内容添加到`<httpModules>`我`<system.web>`的`web.config`.

    `<add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>`

3.  `stringify`被传递给的 JavaScript 对象`WebMethod()`（以及 @TheGeekYouNeed 的道具）。jQuery 会自动将 JavaScript 对象转换为查询字符串的键/值对。另一方面，AJAX 扩展实际上要求将 JavaScript 对象字符串化为 JSON（不解析为 POST[ing] 或 GET[ting] 的键/值对），因为 HTTP Content-Type 标头必须设置为`application/json`. 由于 jQuery 不会转换`data`类型`string`，因此必须先将 JavaScript 对象字符串化为 JSON。然后可以将 JSON 字符串不受惩罚地传递给 AJAX 扩展。网上有很多关于字符串化的必要信息，只需搜索[Invalid JSON primitive](https://www.google.com/search?q=Invalid+JSON+primitive)即可。就个人而言，我认为最好的解释来自[Dave Ward 在 encosia.com 上](http://encosia.com/asmx-scriptservice-mistake-invalid-json-primitive/)。

**更新：**

我在生产服务器上遇到了同样的问题（在 IIS7 上运行 .Net 4.0 Framework）。为了纠正生产服务器上的问题，我必须将以下内容添加到`<configuration>`元素下的 web.config 中：

```
<system.webServer>
    <modules>
      <add name="ScriptModule" preCondition="integratedMode" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
    </modules>
    <handlers>
      <remove name="WebServiceHandlerFactory-Integrated"/>
      <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
      <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
      <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
    </handlers>
</system.webServer> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-28T10:21:02.300

工作正常。自上周以来，我一直在研究这个问题。因为我的本地有 .NET 4 但由于 Web 服务器，我的源代码必须在 .Net 2.0 中开发

我做了什么。

1.  Microsoft ASP.NET 2.0 AJAX 扩展 1.0。
2.  WEB.CONFIG 更新/附加了 [LINK][1] [1] 中给出的内容：[http ://www.asp.net/AJAX/Documentation/Live/ConfiguringASPNETAJAX.aspx](http://www.asp.net/AJAX/Documentation/Live/ConfiguringASPNETAJAX.aspx)

# eclipse - Maven + Spring + 动态 Web 模块 (Eclipse) = java.lang.ClassNotFoundException: org.springframework.web.context.ContextLoaderListener

> ID：10046654
> 
> 赞同：5
> 
> 时间：2012-04-06T17:02:14.010
> 
> 标签：eclipse, spring, maven

我的问题是，即使将“部署程序集”设置为包含 maven 依赖项，这会导致找不到我的类，我不知道还能做什么。

我只是注意到这个`ContextLoaderListener`类，因为其他类似乎包含在我的包中。

我的文件 pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.mkyong.common</groupId>
    <artifactId>SpringMVC</artifactId>
    <packaging>war</packaging>
    <version>1.0-SNAPSHOT</version>
    <name>SpringMVC Maven Webapp</name>
    <url>http://maven.apache.org</url>
    <dependencies>
        <!-- <dependency> <groupId>junit</groupId> <artifactId>junit</artifactId> 
            <version>3.8.1</version> <scope>test</scope> </dependency> -->

        <!-- Spring framework -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring</artifactId>
            <version>2.5.6</version>
        </dependency>

        <!-- Spring MVC framework -->
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>2.5.6</version>
        </dependency>

        <!-- JSTL -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.1.2</version>
        </dependency>

        <dependency>
            <groupId>taglibs</groupId>
            <artifactId>standard</artifactId>
            <version>1.1.2</version>
        </dependency>

        <!-- for compile only, your container should have this -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>

    </dependencies>

    <build>
        <finalName>SpringMVC</finalName>
        <plugins>
            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>tomcat-maven-plugin</artifactId>
                <version>1.0-beta-1</version>
                <configuration></configuration>
            </plugin>
        </plugins>
    </build>

</project> 
```

我的文件 web.xml

```
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <display-name>Spring Web MVC Application</display-name>

    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

</web-app> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-26T11:27:51.343

这个问题似乎是由于：

1.  某些库版本不匹配（即要编译的 Java 版本！= Web 应用服务器上的 Java 版本）。
2.  部署期间未包含必需的 Spring 库。
3.  用于设置项目的 Maven 原型

执行以下步骤以尝试修复此问题：

*   在 pom.xml > 如果您使用 maven-compiler-plugin，请仔细检查这是否与使用的库的版本匹配，如果不更改它（即 1.7 而不是 1.6）。

    ```
    <plugin>
     <artifactId>maven-compiler-plugin</artifactId>
     <configuration>
      <source>1.7</source>
      <target>1.7</target>
     </configuration>
    </plugin> 
    ```

*   如果您在上述步骤中更改了库版本，则必须执行以下操作：右键单击 Project > Maven > Update Project... 如果在此步骤中抛出错误，您可能会发现自己永远卡住了。我遇到了这个问题，无法解决。我最终放弃了使用原型在 Eclipse 中创建“带有 Maven 的 Spring MVC”。我相信使用原型会把事情搞砸……就我而言。

*   右键单击项目 > 属性 > Java 构建路径 > JRE 系统库 > 编辑 > 选择正确的库版本

*   右键单击项目 > 属性 > 项目构面 > 动态 Web 模块（应选中）> 面板右侧的运行时选项卡 > 选择创建的服务器（您之前必须添加过服务器）。

*   右键单击 Project > Properties > Deployment Assembly > Add > Java Build Path Entries > 选择 Spring 依赖项。这来自[加载 ContextLoaderListener 时的 ClassNotFoundException](https://stackoverflow.com/questions/6048117/classnotfoundexception-while-loading-contextloaderlistener)注意：每次在 Eclipse 中执行“Maven > 更新项目”后都必须执行此步骤

*   记得在部署之前清理你的项目：Project > Clean ... > select project > clean

*   部署您的项目并看到它不会中断......希望

就我而言，我不得不在**不**使用 maven 原型的情况下重新启动一个新项目。我使用了这些指南[http://gkokkinos.wordpress.com/2012/01/02/setting-up-a-spring-mvc-project-with-maven-in-eclipse/](http://gkokkinos.wordpress.com/2012/01/02/setting-up-a-spring-mvc-project-with-maven-in-eclipse/)。我仍然抛出了一个错误，但是通过部署程序集（如上所述）添加 Spring 依赖项可以解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-05T22:31:53.353

我有同样的问题。简单的解决方案是右键单击顶级项目-> 属性-> 部署程序集并包含“Maven 依赖项”。就我而言，这就是我的问题所在。类 DispatcherServlet 没有包含在 war 文件中，因此当我将它部署到该服务器时，Tomcat 没有找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-31T12:22:29.693

我有类似的问题，并按照这些步骤来解决它。

1.  在 Eclipse 中打开服务器选项卡。右键单击您的服务器。
2.  清理（​​Tomcat）工作目录
3.  清理（​​这与您可以在右键单击上下文中看到的工作目录清理不同）

# c++ - 没有 cpp 文件并包含排序的标头

> ID：10046655
> 
> 赞同：0
> 
> 时间：2012-04-06T17:02:14.553
> 
> 标签：c++, header, include

[在关于标题排序的问题](https://stackoverflow.com/a/614314/1079493)中，有一个高度评价的回答，并提出了以下建议：

> 良好做法：每个 .h 文件都应该有一个 .cpp，其中首先包含该 .h，然后再包含其他任何内容。这证明任何 .h 文件都可以放在首位。
> 
> 即使标头不需要实现，您也可以创建一个仅包含该 .h 文件的 .cpp 文件，而不包含其他任何内容。

就我个人而言，对于没有相应 cpp 文件的标题，我从来没有遇到过包含排序的问题。这种最佳实践可以防止哪些类型的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:12:14.550

1.  头文件应自行编译。IE。用于测试制作一个仅包含头文件的 .cpp 文件。
2.  头文件应该由预处理器保护。如果`#ifndef`等...

这两者都将确保订单无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:31:16.427

它解决的一个问题是允许对 .h 文件进行 lint（至少通过我的 lint 工具）。如果没有 .cpp 包含 .h 我的模板代码将被跳过。

# permissions - 如何自动加载 Sitecore 子布局以便尊重权限？

> ID：10046656
> 
> 赞同：1
> 
> 时间：2012-04-06T17:02:15.450
> 
> 标签：permissions, sitecore, sublayout

我用一些简单的 html 创建了一个子布局（用户控件）。仅当用户属于某个角色时，我才想显示此子布局。

如果我使用内置的 sitecore 开发人员中心添加子布局，我最终会得到类似

```
 <sc:Sublayout runat="server"
                 RenderingID="{item guid here}" 
                 Path="/layouts/sublayouts/someusercontrol.ascx" 
                 ID="Sublayout1" placeholder="content"></sc:Sublayout> 
```

拒绝那里使用的子布局的读取权限没有任何影响（我假设它正在加载，因为文件路径在那里对吗？）。如果我取出路径，无论当前用户角色如何，我都一无所获。

我不想手动检查当前用户是否在代码隐藏中担任正确的角色。我使用什么标记来获取子布局以考虑用户的权限并确定可见性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T20:24:05.893

我认为不可能根据标记中的用户角色来控制子布局的可见性。如果您将此子布局动态添加到占位符，则可以使用条件渲染（6.5 中的“个性化”按钮）来完成此操作，除非用户是特定角色的成员，否则隐藏组件。

# python - 我应该了解 Python 以识别不同源文件中的注释？

> ID：10046665
> 
> 赞同：1
> 
> 时间：2012-04-06T17:03:04.550
> 
> 标签：python, text-manipulation

我需要识别给定目录中不同类型的源文件中的注释。（例如 java、XML、JavaScript、bash）。我决定使用 Python 来做这件事（作为学习 Python 的尝试）。我的问题是

1）我应该知道关于python的什么来完成这项工作？（我有一个想法，正则表达式会很有用，但有替代品/其他模块有用吗？我可以用这些库来完成这项工作？）

2) Python 是完成此类任务的好选择吗？其他一些语言会让这更容易实现吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:26:11.010

您的问题似乎与编程语言解析更相关。我相信使用正则表达式，您将能够找到大多数语言的注释。好消息是您几乎到处都有正则表达式：Perl、Python、Ruby、AWK、Sed 等。

但是，正如另一个答案所说，你最好使用一些解析机器。而且，如果不是一个成熟的解析器，一个词法分析器。对于 Python，请查看[Pygments](http://pygments.org/)库，该库已经实现了许多语言的词法分析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:24:12.903

1）您需要了解的是解析，而不是正则表达式。此外，您将需要 os 模块和一些关于 pythons 文件处理的知识。DiveIntoPython (http://www.diveintopython.net/) 是一个好的开始。我推荐第 6 章。（也许还有 1-5 章 :)）

2) Python 是一个好的开始。另一种语言不会让它变得更容易，但会有所不同。Python allready 上手非常简单。

我建议不要将正则表达式用于您的任务，因为它就像搜索注释符号和换行一样简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-07T12:52:37.230

该`pyparsing`模块直接支持多种样式的注释。例如，

```
from pyparsing import javaStyleComment
for match in javaStyleComment.scanString(text):
    <do stuff> 
```

因此，如果您的目标只是完成工作，请考虑这一点，因为注释解析器可能比您拼凑的任何东西都更强大。如果您对自己学习做这件事更感兴趣，这可能对您的口味来说太多加工食品了。

# sql-server - 用于为事务复制创建发布的包装存储过程

> ID：10046668
> 
> 赞同：1
> 
> 时间：2012-04-06T17:03:25.007
> 
> 标签：sql-server, sql-server-2008, tsql, replication, transactional-replication

我创建了一个包装存储过程来为 SQL Server 2008 Standard Edition SP3 的事务复制创建发布。但是当我执行该过程时，我收到以下错误。“file_exists”列不是用户定义的。这个错误对我没有任何意义。这适用于开发环境，但相同的代码不适用于测试环境。据我所知，开发和测试是相同的。我还尝试显式设置选项，将它们设为 5496 (SELECT @@OPTIONS)。非常感谢任何帮助。

- 错误

```
Msg 50000, Level 16, State 1, Procedure CreatePublicationForDB, Line 161
Invalid column name 'file_exists'. 
```

-- 开始脚本

```
CREATE DATABASE TestPublication

GO
USE TestPublication

CREATE TABLE Orders(
    OrderID INT PRIMARY KEY,
    CustomerID INT,
    ProductID INT,
    UpdatedAt DATETIME,
    UpdatedBy DATETIME
)
GO
CREATE TABLE Products(
ProductID INT PRIMARY KEY,
ProductName VARCHAR(100)
)
GO
CREATE VIEW V_Order
AS
SELECT o.OrderID,o.CustomerID, p.ProductName
FROM Orders o 
JOIN Products p
    ON o.ProductID = p.ProductID

GO
CREATE SCHEMA repl
GO
CREATE TABLE repl.ReplicationTables
(
    DBName sys.sysname NOT NULL DEFAULT('TestPublication'),
    SchemaOwner sys.sysname NOT NULL DEFAULT('dbo'),
    TableName sys.sysname NOT NULL
) 
GO
INSERT INTO repl.ReplicationTables (tablename)
VALUES('Orders'),('Products'),('V_Order')
GO
USE TestPublication
GO
CREATE PROCEDURE CreatePublicationForDB( @databaseName sysname, @publicationName sysname = @databaseName,   @allow_initialize_from_backup NVARCHAR(5) = 'true')
AS
BEGIN

BEGIN TRY
SET ANSI_WARNINGS ON
SET ANSI_PADDING ON
SET ANSI_NULLS ON
SET ARITHABORT ON
SET QUOTED_IDENTIFIER ON
SET ANSI_NULL_DFLT_ON ON
SET CONCAT_NULL_YIELDS_NULL ON 
        DECLARE @sp_replicationdboption varchar(MAX) = ' USE '+@databaseName +';',
                @sp_addpulication VARCHAR(MAX) = ' USE '+@databaseName +';', 
                @sp_addpublication_snapshot VARCHAR(MAX) = ' USE '+@databaseName +';', 
                @sp_addarticle VARCHAR(MAX) = ' USE '+@databaseName +';',
                @sp_startpublication_snapshot VARCHAR(MAX) = ' USE '+@databaseName +';'

        DECLARE @allow_anonymous NVARCHAR(5) = CASE WHEN @allow_initialize_from_backup = 'false' OR @allow_initialize_from_backup IS NULL THEN 'true' ELSE 'false' END

        DECLARE @immediate_sync NVARCHAR(5) = @allow_anonymous, @publisher sysname = @@SERVERNAME
        -- set up database publication
        SET @sp_replicationdboption += '
        exec sp_replicationdboption @dbname = N'''+@databaseName+ ''', 
                                @optname = N''publish'', 
                                @value = N''true'''
        -- Publication
        SET @sp_addpulication += '
        exec sp_addpublication @publication = N'''+@publicationName+ ''', 
                            @description = N''Transactional publication of database '+@databaseName+' from Publisher '+@publisher+''', 
                            @sync_method = N''concurrent'', 
                            @retention = 0, 
                            @allow_push = N''true'', 
                            @allow_pull = N''true'', 
                            @allow_anonymous = N'''+@allow_anonymous+ ''' , 
                            @enabled_for_internet = N''false'', 
                            @snapshot_in_defaultfolder = N''true'', 
                            @compress_snapshot = N''false'', 
                            @ftp_port = 21, 
                            @ftp_login = N''anonymous'', 
                            @allow_subscription_copy = N''false'', 
                            @add_to_active_directory = N''false'', 
                            @repl_freq = N''continuous'', 
                            @status = N''active'', 
                            @independent_agent = N''true'', 
                            @immediate_sync =  N'''+@immediate_sync+ ''' , 
                            @allow_sync_tran = N''false'', 
                            @autogen_sync_procs = N''false'', 
                            @allow_queued_tran = N''false'', 
                            @allow_dts = N''false'', 
                            @replicate_ddl = 1, 
                            @allow_initialize_from_backup =  N'''+COALESCE(@allow_initialize_from_backup, 'false')+ ''' , 
                            @enabled_for_p2p = N''false'', 
                            @enabled_for_het_sub = N''false'''

        IF @allow_initialize_from_backup = 'false'
        BEGIN
            -- publication snapshot
            SET @sp_addpublication_snapshot +='
            exec sp_addpublication_snapshot @publication = N'''+@publicationName+ ''', 
                                        @frequency_type = 1, 
                                        @frequency_interval = 0, 
                                        @frequency_relative_interval = 0, 
                                        @frequency_recurrence_factor = 0, 
                                        @frequency_subday = 0, 
                                        @frequency_subday_interval = 0, 
                                        @active_start_time_of_day = 0, 
                                        @active_end_time_of_day = 235959, 
                                        @active_start_date = 0, 
                                        @active_end_date = 0, 
                                        @job_login = null, 
                                        @job_password = null, 
                                        @publisher_security_mode = 1'

            SET @sp_startpublication_snapshot+=' exec sys.sp_startpublication_snapshot @publication = N'''+@publicationName+ ''''
        END
        -- Articles
        IF OBJECT_ID('tempdb..#t') IS NULL
            BEGIN
                PRINT 'creating temp table t'
                CREATE TABLE #t (NAME sysname,objectid INT, sch_owner sysname  NULL, article sysname NOT NULL, isIndexed BIT NULL, IsSchemaBound BIT NULL, TYPE CHAR(2) NULL)
            END
        INSERT INTO #t(NAME,objectid, sch_owner,isIndexed,IsSchemaBound, TYPE,article)
        EXEC('
        USE '+@databaseName + '
        SELECT f.Name, f.object_id,f.sch, f.IsIndexed,f.IsSchemaBound, f.type,CASE WHEN ROW_NUMBER() OVER (PARTITION BY f.name ORDER BY f.sch) > 1 THEN f.name + CAST((ROW_NUMBER() OVER (PARTITION BY f.name ORDER BY f.sch) - 1) AS VARCHAR(2)) ELSE f.name END AS Article
        FROM(
        SELECT t.Name, t.object_id,t.sch, IsIndexed,IsSchemaBound, type
        FROM 
            (SELECT DBName, SchemaOwner, TableName
            FROM TestPublication.repl.ReplicationTables
            GROUP BY DBName, SchemaOwner, TableName )rt JOIN
        (SELECT o.Name, o.object_id,s.name AS sch,  objectproperty(o.object_id, ''IsIndexed'') AS IsIndexed,objectproperty(o.object_id, ''IsSchemaBound'') AS IsSchemaBound, o.type
        FROM
        sys.objects o
        JOIN sys.schemas s ON o.schema_id = s.schema_id
        WHERE o.type IN (''U'',''V'')
            AND ObjectProperty(o.object_id, ''IsMSShipped'') = 0
            AND (ObjectProperty(o.object_id, ''TableHasPrimaryKey'') = 1 OR ObjectProperty(o.object_id, ''TableHasPrimaryKey'') IS NULL)
        ) t ON rt.tablename = t.name AND rt.SchemaOwner = t.sch
        WHERE rt.DBName = '''+@databaseName + '''
        ) f'
        )
        SELECT @sp_addarticle += 
                'exec sp_addarticle 
                @publication = N''' +@databaseName +
                ''', @article = N''' +t.article+
                ''', @source_owner = N''' +t.sch_owner +
                ''', @source_object = N''' + t.NAME +
                ''', @type = N''' +
                CASE WHEN t.type = 'U' THEN 'logbased'
                     WHEN t.type = 'V' AND (IsIndexed = 1 OR IsSchemaBound = 1 )THEN 'indexed view schema only'
                     WHEN t.type = 'V' AND IsIndexed = 0 THEN 'view schema only' END

                    +''', @description = null,@creation_script = null,@pre_creation_cmd = N''drop'', 
                @schema_option = '+
                    CASE WHEN t.type = 'U' THEN '0x000000000803509F'
                     WHEN t.type = 'V' THEN '0x0000000008000001' END+
                ',@destination_table = N'''+t.Name+
                ''',@destination_owner = N'''+t.sch_owner+''''+
                CASE WHEN t.TYPE = 'U' THEN
                        ', @identityrangemanagementoption = N''manual'',@vertical_partition = N''false'',
                @ins_cmd = N''CALL sp_MSins_'+t.sch_owner+''+t.Name+
                ''', @del_cmd = N''CALL sp_MSdel_'+t.sch_owner+''+t.Name+''',
                @upd_cmd = N''SCALL sp_MSupd_'+t.sch_owner+''+t.Name+''''
                        ELSE ''
                    END
                    +';'

        FROM #t t

        PRINT 'Now running sp_replicationdboption'
        PRINT @sp_replicationdboption
        EXEC(@sp_replicationdboption)

        PRINT 'Now running sp_addpulication'
        PRINT @sp_addpulication
        EXEC(@sp_addpulication)

        IF @allow_initialize_from_backup = 'false'
        BEGIN
            PRINT 'Now running sp_addpulication_snapshot and starting snapshot'
            PRINT @sp_addpublication_snapshot
            EXEC(@sp_addpublication_snapshot)
            EXEC(@sp_startpublication_snapshot)
        END

        PRINT 'Now running sp_addarticles'
        PRINT @sp_addarticle
        EXEC(@sp_addarticle)

    -- exec sp_droppublication @publication = N'Products'   
    END TRY

    BEGIN CATCH
        IF @@trancount > 0
            ROLLBACK

            DECLARE @ERROR_SEVERITY INT, @ERROR_STATE INT, @ERROR_MESSAGE NVARCHAR(4000)
            SELECT @ERROR_SEVERITY = ERROR_SEVERITY(), @ERROR_STATE = ERROR_STATE(), @ERROR_MESSAGE = ERROR_MESSAGE()
            RAISERROR(@ERROR_MESSAGE, @ERROR_SEVERITY, @ERROR_STATE)
    END CATCH

END
GO 
```

最后执行

```
EXEC CreatePublicationForDB 'TestPublication' 
```

-- 如果您想再次运行上述内容，请删除复制。

```
exec TestPublication.dbo.sp_droppublication @publication = 'TestPublication'
exec TestPublication.dbo.sp_replicationdboption @dbname = 'TestPublication', @optname = 'publish', @value = 'false' 
```

-- 清理数据库

```
DROP DATABASE TestPublication 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-06-01T13:55:13.170

抱歉，我知道旧帖子，但我遇到了非常相似的情况并解决了它。我在其他任何地方都没有找到可行的解决方案。我包括我的经验来帮助别人。

我的情况总结是，我有一个 msbuild 进程从事务中的清单文件（具有一系列脚本名称的文本文件）运行一系列脚本。旨在创建和配置代理作业的脚本总是因相同的错误而死。（无效的列名“file_exists”）

我失败的脚本中使用的 Procs：

```
msdb.dbo.sp_add_category
msdb.dbo.sp_add_job
msdb.dbo.sp_add_jobstep
msdb.dbo.sp_update_job
msdb.dbo.sp_add_jobschedule
msdb.dbo.sp_add_jobserver 
```

注释掉对 msdb.dbo.sp_add_jobstep 的调用允许脚本完成。

我在脚本中也有 @database_name=N'$(DatabaseName)' 形式的 SQL 命令变量。如 sp_add_jobstep 文档中 [ @command= ] 'command' 下的“重要”说明中所述，这导致了一些尝试使用转义宏的错误尝试。

[https://msdn.microsoft.com/en-us/library/ms187358.aspx](https://msdn.microsoft.com/en-us/library/ms187358.aspx)

如果我将构建运行到但不包括作业创建脚本并重新开始，它会成功。

经过多次试验和错误后，我发现，即使 procs 被限定为在 [MSDB] 中，除非我实际上包含了 USE 语句，否则该过程会失败。通过使用“USE [MSDB] GO”开始脚本，然后切换回我的构建目标（即 USE [MyBuildDB] GO），我不再收到错误消息。

我的代理作业按预期创建，并且构建中的几个脚本运行没有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T04:40:47.603

如果不查看所有代码并拥有架构，很难说问题出在哪里。我建议不要创建包装器来创建出版物。创建发布脚本可以在需要时按需保存和执行 - 无需包装器。

# visual-studio-2010 - 使用 cassini 而不是 IISExpress 的 ASP.NET 配置

> ID：10046669
> 
> 赞同：0
> 
> 时间：2012-04-06T17:03:27.170
> 
> 标签：visual-studio-2010, asp.net-mvc-3

我有一个配置为使用 IISExpress 的 ASPNET MVC 应用程序。如果我转到 Project --> ASP.NET 配置，Visual Studio 似乎无论如何都会为管理配置页面启动 Casssini。有没有办法改变它以使用 IISExpress

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:05:40.693

通常，当您的解决方案中有多个网站项目时，就会发生这种情况。这里是这样吗？如果是这样，您必须将 IISExpress 设置为所有项目的服务器。

# python - Pyramid 将用户定向到不同的域

> ID：10046672
> 
> 赞同：0
> 
> 时间：2012-04-06T17:04:03.720
> 
> 标签：python, ajax, pyramid

我想将我的用户重定向到另一个域。例如：我的网站是[http://www.mysite.com/](http://www.mysite.com/)我想将它们重定向到[http://www.google.com/](http://www.google.com/)。

我希望重定向在表单提交之后进行。在金字塔网络框架中这可能吗？

或者是使用 AJAX 发布请求到服务器然后使用 javascript 重定向的最佳途径？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:38:05.213

成功提交表单后返回 HTTPFound 与您想要的位置。

```
from pyramid.httpexceptions import HTTPFound

def form_received_here(request):
    # do stuff here
    return HTTPFound('http://example.com') 
```

这将返回一个状态码 302，其`Location`标头设置为`http://example.com`.

# eclipse - Eclipse svn move/rename 对全小写文件名不起作用？

> ID：10046674
> 
> 赞同：2
> 
> 时间：2012-04-06T17:04:17.580
> 
> 标签：eclipse, svn, refactoring, move

我正在使用 Refactor -> Rename 重命名一系列 .js 文件。

它们都有效，除非我将文件重命名为全小写名称（即重命名`Calendar.js`为`calendar.js`）。我收到此错误：

```
move C:/Users/JohnDeer/workspace/MyApp/WebContent/scripts/ui/Calendar.js C:/Users/JohnDeer/workspace/MyApp/WebContent/scripts/ui/calendar.js
    Path is not a working copy directory
svn: Path 'C:\Users\JohnDeer\workspace\MyApp\WebContent\scripts\ui\calendar.js' is not a directory 
```

我检查了 ui 文件夹，里面有一个 .svn 文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:16:59.403

我认为问题在于文件名在 Windows 中不区分大小写。所以小写名称注册为原始名称，并且可能当源文件与目标相同时，后者被理解为目录。

作为一种解决方法，您可以尝试使用临时中间文件：

*   将 Calendar.js 重命名为 tmp.js
*   然后将 tmp.js 重命名为 calendar.js

另一种可能性是手动重命名[存储库中](http://subversion.apache.org/faq.html#case-change)的文件（这可以使用 Eclipse 的存储库浏览视图以及从命令行完成），然后更新项目。

# iphone - 支持 c++ 0x 的最低 iOS 版本

> ID：10046675
> 
> 赞同：9
> 
> 时间：2012-04-06T17:04:23.873
> 
> 标签：iphone, c++, ios, c++11

我有用 C++ 编写的小型游戏引擎。我正在考虑使用 c++0x 的一些特性

需要什么最低版本的ios？新标准是作为一个额外的动态库出现还是只是静态链接？

更新：

我打算使用 lambdas，新的循环和自动类型扣除

Mooing Duck：我既要制造又要奔跑。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T17:28:14.940

iOS 上的 C++11 支持几乎仅限于 Clang 编译器，该编译器已在多个版本中缓慢添加 C++11 功能。iOS 上支持 C++11 的标准库是`libc++`，并且它是动态链接的，所以需要标准库支持的新功能将具有最低 SDK 版本。直到 iOS 5，Apple 才真正放心地说编译器支持 C++11，但在此之前有一些功能可用。最终，这取决于您正在考虑的功能，而最简单的查找方法（因为我不知道任何功能清单以及它们适用于哪些 iOS 版本）只是制作一个小测试用例并尝试针对各种 iOS SDK 版本构建它。

# wpf - 重用 WPF 命令库中的命令是个坏主意吗？

> ID：10046678
> 
> 赞同：2
> 
> 时间：2012-04-06T17:04:37.113
> 
> 标签：wpf, coding-style, routed-commands, commandbinding

WPF 提供了一个预定义命令库（ApplicationCommands.Save、NavigationCommands.NextPage 等），我们可以在自己的应用程序中为其创建命令绑定。我知道可以为单个 RoutedCommand/RoutedUICommand 创建多个命令绑定，通过指定不同的执行处理程序来根据应用程序上下文获得不同的行为。

据我了解，RoutedUICommand 的目的主要是提供一个通用的语义参考。ApplicationCommands.New，引用 MSDN 文档，“表明了创建新项目的意图。” 此命令可用于命令绑定中，以在应用程序中的多个不相关表单上创建新项目。

我几乎从未见过这种重复使用。在我从事的在线代码和项目中，我通常会看到在代码隐藏或视图模型中定义的 RoutedCommand，名称类似于“NewEmailCommand”。

我看到重用命令的几个**优点：**

*   RoutedUICommands 通常定义了 Text 属性，因此不需要定义菜单项 Header。
*   当命令定义了输入手势时，不需要在每个使用它的地方都指定输入绑定。
*   当命令定义了输入手势时，菜单项中的 InputGestureText 会自动填充。
*   使用相同的命令可以提高整个应用程序的一致性——无论是用于命令的标签还是键/鼠标绑定。

想到的一些可能的**缺点：**

*   在某些情况下，命令可能不明确。例如：您可能需要在一个位置使用两个不同的“新建”命令（新建->{项目...，网站...}）。
*   取而代之或重用一个命令，人们可能想要重用一个使用静态处理程序的命令绑定。
*   ApplicationCommands.New 不是一个特别有用的命令名称；它不会告诉您有关当前命令处理程序的任何信息（例如正在创建的内容）。

我非常倾向于重用命令，但正如我所说：我根本没有在实践中看到它。

你的喜好是什么？有没有我没有听说过的公认的“最佳实践”？重用命令是否有明显的问题/其他好处？

# php - MySql - 检查空值时查询结果不正确

> ID：10046679
> 
> 赞同：1
> 
> 时间：2012-04-06T17:04:40.053
> 
> 标签：php, mysql, database, null

当我尝试选择没有电子邮件的用户记录时，我的查询没有给出正确的结果：

```
select * from users where email='' 
```

和：

```
select * from users where email=NULL 
```

两者都给出不同的结果，但都没有给出正确的结果。我怎样才能得到正确的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:05:42.630

它是 NULL 或 IS NOT NULL。

```
select * from users where email IS NULL 
```

根据用户如何“没有电子邮件”，您应该将该字段的默认值设置为 NULL 并使该字段可以为空。然后，如果在该表中执行插入新记录，则电子邮件将为 NULL 而不是空的。

或者，如果您已经遇到不匹配的表，请尝试以下操作：

```
select * from users where LENGTH(COALESCE(email,'')) = 0 
```

这将为您提供所有具有“空”值的记录`email`，将 NULL 视为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:07:34.677

空不等于空。

你需要指定`IS NULL`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:07:30.290

Mysql对待它们两者不同

`email=''`检查空白值并`email=NULL`检查空值，这就是为什么它们都给出不同结果的原因。

您应该使用`is NULL`它来检查空白和空值。

```
SELECT *  FROM users WHERE email IS NULL 
```

# ruby - 您如何将事物的哈希转换为要发送到 ruby 中的方法的参数？

> ID：10046686
> 
> 赞同：0
> 
> 时间：2012-04-06T17:05:07.580
> 
> 标签：ruby

我正在尝试调用一个带有 n 个参数的方法，并将参数作为散列传递给调用带有 n 个参数的方法的方法，但散列看起来就像另一个参数。如何取消对参数的哈希处理，以便正确调用该方法？

一些代码，因为这很难用文字来解释：

我要调用的方法： `method(p[:method]).call(p[:action], p[:params])`
`p[:method]`在这种情况下是`:post`
`p[:action]`is `:create`
`p[:params]`is`{:my_object => {my object's params}}`

所以，拆开来看，它看起来像这样：
`post(:create, {:my_object => {my object's params}})` # current
但它应该是什么样子，是这样的：
`post(:create, :my_object => {my object's params})` #desired

* * *

如何更改 `method(p[:method]).call(p[:action], p[:params])`才能获得所需的方法调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:27:03.217

实际上

```
post(:create, {:my_object => {my object's params}}) 
```

和

```
post(:create, :my_object => {my object's params}) 
```

是相同的结构。

在这两种情况下，您都会将两个属性传递给方法`post`：符号`:create`和哈希。

无论如何，如果你只有一个键，你可以做这个丑陋的把戏`params`：

```
method(p[:method]).call(p[:action], p[:params].keys.first => p[:params].values.first) 
```

# jquery - 如何从此链接获取 json 数据

> ID：10046691
> 
> 赞同：2
> 
> 时间：2012-04-06T17:05:26.130
> 
> 标签：jquery, json

[http://just4dummy.com/Haggle/index.php/api/haggle/bills/user/1/format/json](http://just4dummy.com/Haggle/index.php/api/haggle/bills/user/1/format/json)

如何从此链接控制 Firefox 中的数据。

如何从此链接获取 json 数据并在 html 标签中使用它。

请帮我。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:29:21.130

您需要使用 JSONP 才能跨域访问它。

```
$.getJSON('http://just4dummy.com/Haggle/index.php/api/haggle/bills/user/1/format/jsonp?callback=?', function(data) {
    console.log(data);
}); 
```

我将“json”更改为“jsonp”，并添加了“?callback=?” 到网址。支持 JSONP 取决于服务器，并非所有服务器都支持，这台恰好支持它。

返回的数据是一个对象数组，可以这样读取：

```
$.each(data, function(){
    console.log(this.account);
}); 
```

从这里您可以轻松地将数据添加到 HTML 表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:09:50.070

[jQuery getJSON](http://api.jquery.com/jQuery.getJSON/)

```
$.getJSON('http://just4dummy.com/Haggle/index.php/api/haggle/bills/user/1/format/json', function(data) {...}); 
```

# java - 使用动态 DNS url 时无法更新 Java Servlet

> ID：10046692
> 
> 赞同：0
> 
> 时间：2012-04-06T17:05:36.793
> 
> 标签：java, servlets, dynamic

我有一个需要更新 Java Servlet 中的一些数据的 java 类。当我在家庭网络中使用 IP 或者即使我使用我的 ISP ip（从路由器进行转发）时，它也可以正常工作。

但是现在，当我想使用实际上与我的 ISP 地址相同的动态 DNS 更新 servlet 时，它不起作用。

奇怪的是，我可以使用动态 DNS 从 servlet 获取数据。

这是我的代码：（我只是盯着 ip 和 DDNS 地址）注意：动态 DNS（在代码中：[http](http://example.zapto.org) ://example.zapto.org ）与盯着的 ip（在代码中：[http:// xx.xxx.xxx.xxx:8084](http://xx.xxx.xxx.xxx:8084)）。使用 IP 时，DDNS 不工作。

```
public class SendGsonToServlet {
public static boolean sendGson (String qrCode){

    try {
        String jsonStr = new Gson().toJson(qrCode);

//          URL servletURL = new URL("http://example.zapto.org/Android_Server/data");
            URL servletURL = new URL("http://xx.xxx.xxx.xxx:8084/Android_Server/data");
//          URL servletURL = new URL("http://192.168.1.108:8084/Android_Server/data");

        // assumes protocol is http, could be https
        HttpURLConnection conn = (HttpURLConnection)servletURL.openConnection();
        conn.setDoOutput(true);
        conn.setRequestMethod("POST");

        PrintWriter out = new PrintWriter(conn.getOutputStream());
        out.println(jsonStr);
//          out.flush();
        out.close();

        System.out.println(conn.getResponseCode());

    }catch (Exception e) {

    }

    return true;
}

} 
```

谢谢大家，节日快乐：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T01:39:41.143

如果 ping 为您提供了另一个 IP 地址，并且如果使用此 IP 地址您的测试失败，则可能是：

*   或者您无法使用您的公共 IP 在您的 LAN 中访问您的服务；
*   或者 DDNS 未通过 IP 评估；
*   或者你的 ISP 没有给你一个公共 IP，它使用 NAT 到它的私有子网。

# lisp - Lisp 中的项目可视化

> ID：10046695
> 
> 赞同：1
> 
> 时间：2012-04-06T17:05:42.647
> 
> 标签：lisp, visualization

是否有可以生成图表的工具（类似于使用 Graphviz 的 Doxygen）但采用本文描述的格式：[Lisp Looks Different](http://scg.unibe.ch/archive/papers/Dozs08aLispLooksDifferent.pdf)

**程序风格分布：**确定哪个编程风格（函数式、面向对象、命令式或宏）主导一个软件包，同时确定每个软件包的复杂程度。

![节目风格分布](../Images/0121d94cd7bece9c789e6fa5b4091470.png)

**类方法关系视图：**可视化类和方法之间的关系（在 Lisp 中，类和方法是分开的）。目标是识别系统的可能独立或松散耦合的组件。

![类方法关系视图](../Images/72ada2fc27f1e4f0837d227adcad577a.png)

**通用关注点视图：**帮助识别和定位与通用功能相关的横切关注点。 ![一般关注视图](../Images/687fe558d2ebfea3f78a4f4d18d9ed64.png)

**类类型视图：**帮助识别不同类型的类，基于它们的结构，更精确地基于属性与方法的比率。tio

![类类型视图](../Images/773d29fff438ef5a293242a975625a78.png)

颜色和形状的含义请参考文档。如果也有其他语言的等效工具，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:33:48.993

你看过[蒙德里安](http://www.moosetechnology.org/tools/mondrian)吗，这篇论文引用的是用来生成这些图表的东西？

更一般地说，你看过[穆斯](http://www.moosetechnology.org/)吗，蒙德里安只是其中的一部分？

我不确定我是否见过生成与上面完全相同的[图表](http://xray.inf.usi.ch/xray.php)[的](http://vidi.cs.ucdavis.edu/research/softvis) [工具](http://www.cc.gatech.edu/gvu/ii/softvis/ooviz/ooviz.html) [，](http://www.inf.usi.ch/phd/wettel/codecity.html)[但](http://xplrarc.massey.ac.nz/index.jsp).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T19:43:40.037

显而易见的第一步：联系论文作者并询问他们使用了哪些工具，以及他们是否有任何可以共享的代码。

# android - Android - 可绘制语言

> ID：10046696
> 
> 赞同：0
> 
> 时间：2012-04-06T17:05:48.463
> 
> 标签：android, localization, drawable

我有 5 个图像按钮，我将它们组合在一个主屏幕中，一切看起来都很棒。但是我尝试用其他语言添加图像，所以我创建了一个名为“drawable-pt”的文件夹，并将葡萄牙语的图像放在这个文件夹中（在图像中使用相同的名称）。但是，当我在葡萄牙语手机中加载应用程序时，图像被弄乱了，它们是一个在另一个之上，但使用的是葡萄牙语。如果我将手机的语言更改为英语，主屏幕看起来很棒，一切都很完美。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T18:41:09.333

两个文件夹中的图像大小相同吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-25T16:59:49.520

我想问题可能是您的一个文件夹是 drawable-hdpi 和另一个 drawable-pt。将其重命名为 drawable-pt-hdpi 或 mdpi 或您使用的任何名称。

# ruby-on-rails-3 - 当我尝试将我的应用程序推送到 Heroku 时出现 500 内部服务器错误

> ID：10046697
> 
> 赞同：1
> 
> 时间：2012-04-06T17:05:49.153
> 
> 标签：ruby-on-rails-3, heroku, twitter-bootstrap, internal-server-error

将我的应用程序推送到 Heroku 时，我遇到了这个问题：

*   500内部服务器错误
*   ActionView::Template::Error...application.css 未预编译（请参阅附加的 Heroku 日志）
*   此外，ActionController::RoutingError (没有路由匹配 [GET] "/assets/rails.png"

我正在使用 Twitter Bootstrap 2.0.1 和 Rails 3.1.1（请参阅下面的 Gemfile）

任何指导将不胜感激！

* * *

**HEROKU 原木**

```
2012-04-06T16:49:38+00:00 app[web.1]: 
2012-04-06T16:49:38+00:00 app[web.1]: Started GET "/" for 115.186.162.46 at 2012-04-06 09:49:38 -0700
2012-04-06T16:49:38+00:00 app[web.1]:   Processing by PostsController#new as HTML
2012-04-06T16:49:38+00:00 app[web.1]: Rendered posts/_form.html.erb (1.4ms)
2012-04-06T16:49:38+00:00 app[web.1]: Rendered posts/new.html.erb within layouts/application (1.8ms)
2012-04-06T16:49:38+00:00 app[web.1]: Completed 500 Internal Server Error in 3ms
2012-04-06T16:49:38+00:00 app[web.1]: 
2012-04-06T16:49:38+00:00 app[web.1]: ActionView::Template::Error (application.css isn't precompiled):
2012-04-06T16:49:38+00:00 app[web.1]:     6:     <title>Weddoo!</title>
2012-04-06T16:49:38+00:00 app[web.1]:     7:     <%= csrf_meta_tags %>
2012-04-06T16:49:38+00:00 app[web.1]:     8: 
2012-04-06T16:49:38+00:00 app[web.1]:     9:     <%= stylesheet_link_tag "application", :media => "all" %>
2012-04-06T16:49:38+00:00 app[web.1]:     10: 
2012-04-06T16:49:38+00:00 app[web.1]:     11:     <link href="images/favicon.ico" rel="shortcut icon">
2012-04-06T16:49:38+00:00 app[web.1]:     12:     <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
2012-04-06T16:49:38+00:00 app[web.1]:   app/views/layouts/application.html.erb:9:in `_app_views_layouts_application_html_erb__819333137240276330_18641900'
2012-04-06T16:49:38+00:00 app[web.1]:   app/controllers/posts_controller.rb:24:in `new'
2012-04-06T16:49:38+00:00 app[web.1]: 
2012-04-06T16:49:38+00:00 app[web.1]: 
2012-04-06T16:49:38+00:00 app[web.1]: cache: [GET /] miss
2012-04-06T16:49:38+00:00 heroku[router]: GET weddoo.heroku.com/ dyno=web.1 queue=0 wait=0ms service=11ms status=500 bytes=728
2012-04-06T16:49:38+00:00 heroku[nginx]: 115.186.162.46 - - [06/Apr/2012:16:49:38 +0000] "GET / HTTP/1.1" 500 728 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_2) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" weddoo.heroku.com
2012-04-06T16:49:39+00:00 app[web.1]: 
2012-04-06T16:49:39+00:00 app[web.1]: 
2012-04-06T16:49:39+00:00 app[web.1]: Started GET "/" for 115.186.162.46 at 2012-04-06 09:49:39 -0700
2012-04-06T16:49:39+00:00 app[web.1]:   Processing by PostsController#new as HTML
2012-04-06T16:49:39+00:00 app[web.1]: Rendered posts/new.html.erb within layouts/application (1.6ms)
2012-04-06T16:49:39+00:00 app[web.1]: Rendered posts/_form.html.erb (1.4ms)
2012-04-06T16:49:39+00:00 app[web.1]: Completed 500 Internal Server Error in 3ms
2012-04-06T16:49:39+00:00 app[web.1]: 
2012-04-06T16:49:39+00:00 app[web.1]: ActionView::Template::Error (application.css isn't precompiled):
2012-04-06T16:49:39+00:00 app[web.1]:     6:     <title>Weddoo!</title>
2012-04-06T16:49:39+00:00 app[web.1]:     9:     <%= stylesheet_link_tag "application", :media => "all" %>
2012-04-06T16:49:39+00:00 app[web.1]:     10: 
2012-04-06T16:49:39+00:00 app[web.1]:     11:     <link href="images/favicon.ico" rel="shortcut icon">
2012-04-06T16:49:39+00:00 app[web.1]:     7:     <%= csrf_meta_tags %>
2012-04-06T16:49:39+00:00 app[web.1]:     8: 
2012-04-06T16:49:39+00:00 app[web.1]:     12:     <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
2012-04-06T16:49:39+00:00 app[web.1]:   app/views/layouts/application.html.erb:9:in `_app_views_layouts_application_html_erb__819333137240276330_18641900'
2012-04-06T16:49:39+00:00 app[web.1]:   app/controllers/posts_controller.rb:24:in `new'
2012-04-06T16:49:39+00:00 app[web.1]: 
2012-04-06T16:49:39+00:00 app[web.1]: 
2012-04-06T16:49:39+00:00 app[web.1]: cache: [GET /] miss
2012-04-06T16:49:39+00:00 heroku[router]: GET weddoo.heroku.com/ dyno=web.1 queue=0 wait=0ms service=10ms status=500 bytes=728
2012-04-06T16:49:39+00:00 heroku[nginx]: 115.186.162.46 - - [06/Apr/2012:16:49:39 +0000] "GET / HTTP/1.1" 500 728 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_2) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" weddoo.heroku.com
2012-04-06T16:51:32+00:00 heroku[slugc]: Slug compilation started
2012-04-06T16:51:46+00:00 heroku[api]: Release v8 created by postkhalid@yahoo.com
2012-04-06T16:51:46+00:00 heroku[api]: Deploy db6820d by postkhalid@yahoo.com
2012-04-06T16:51:46+00:00 heroku[web.1]: State changed from up to bouncing
2012-04-06T16:51:46+00:00 heroku[web.1]: State changed from bouncing to created
2012-04-06T16:51:46+00:00 heroku[web.1]: State changed from created to starting
2012-04-06T16:51:47+00:00 heroku[slugc]: Slug compilation finished
2012-04-06T16:51:48+00:00 heroku[web.1]: Stopping process with SIGTERM
2012-04-06T16:51:48+00:00 app[web.1]: >> Stopping ...
2012-04-06T16:51:50+00:00 heroku[web.1]: Process exited with status 0
2012-04-06T16:51:51+00:00 heroku[web.1]: Starting process with command `thin -p 30481 -e production -R /home/heroku_rack/heroku.ru start`
2012-04-06T16:51:55+00:00 app[web.1]: >> Thin web server (v1.2.6 codename Crazy Delicious)
2012-04-06T16:51:55+00:00 app[web.1]: >> Maximum connections set to 1024
2012-04-06T16:51:55+00:00 app[web.1]: >> Listening on 0.0.0.0:30481, CTRL+C to stop
2012-04-06T16:51:56+00:00 heroku[web.1]: State changed from starting to up
2012-04-06T16:51:56+00:00 heroku[rake.1]: State changed from created to starting
2012-04-06T16:52:02+00:00 app[rake.1]: Awaiting client
2012-04-06T16:52:02+00:00 heroku[rake.1]: State changed from starting to up
2012-04-06T16:52:02+00:00 app[rake.1]: Starting process with command `bundle exec rake db:migrate`
2012-04-06T16:52:07+00:00 heroku[rake.1]: Process exited with status 0
2012-04-06T16:52:07+00:00 heroku[rake.1]: State changed from up to complete
2012-04-06T16:52:20+00:00 app[web.1]: 
2012-04-06T16:52:20+00:00 app[web.1]: 
2012-04-06T16:52:20+00:00 app[web.1]: Started GET "/assets/rails.png" for 115.186.162.46 at 2012-04-06 09:52:20 -0700
2012-04-06T16:52:20+00:00 heroku[router]: GET weddoo.heroku.com/assets/rails.png dyno=web.1 queue=0 wait=0ms service=80ms status=404 bytes=728
2012-04-06T16:52:20+00:00 app[web.1]: 
2012-04-06T16:52:20+00:00 app[web.1]: ActionController::RoutingError (No route matches [GET] "/assets/rails.png"):
2012-04-06T16:52:20+00:00 app[web.1]:   
2012-04-06T16:52:20+00:00 app[web.1]: 
2012-04-06T16:52:20+00:00 app[web.1]: 
2012-04-06T16:52:20+00:00 app[web.1]: cache: [GET /assets/rails.png] miss
2012-04-06T16:52:21+00:00 heroku[nginx]: 115.186.162.46 - - [06/Apr/2012:16:52:21 +0000] "GET /assets/rails.png HTTP/1.1" 404 728 "http://weddoo.heroku.com/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_2) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" weddoo.heroku.com
2012-04-06T16:52:23+00:00 app[web.1]: 
2012-04-06T16:52:23+00:00 app[web.1]: 
2012-04-06T16:52:23+00:00 app[web.1]: Started GET "/" for 115.186.162.46 at 2012-04-06 09:52:23 -0700
2012-04-06T16:52:23+00:00 app[web.1]:   Processing by PostsController#new as HTML
2012-04-06T16:52:23+00:00 app[web.1]: Rendered posts/_form.html.erb (25.6ms)
2012-04-06T16:52:23+00:00 app[web.1]: Rendered posts/new.html.erb within layouts/application (53.8ms)
2012-04-06T16:52:23+00:00 app[web.1]: ActionView::Template::Error (application.css isn't precompiled):
2012-04-06T16:52:23+00:00 app[web.1]: Completed 500 Internal Server Error in 150ms
2012-04-06T16:52:23+00:00 app[web.1]:     6:     <title>Weddoo!</title>
2012-04-06T16:52:23+00:00 app[web.1]: 
2012-04-06T16:52:23+00:00 app[web.1]:     7:     <%= csrf_meta_tags %>
2012-04-06T16:52:23+00:00 app[web.1]:     8: 
2012-04-06T16:52:23+00:00 app[web.1]:     10: 
2012-04-06T16:52:23+00:00 app[web.1]:     9:     <%= stylesheet_link_tag "application", :media => "all" %>
2012-04-06T16:52:23+00:00 app[web.1]:     11:     <link href="images/favicon.ico" rel="shortcut icon">
2012-04-06T16:52:23+00:00 heroku[router]: GET weddoo.heroku.com/ dyno=web.1 queue=0 wait=0ms service=206ms status=500 bytes=728
2012-04-06T16:52:23+00:00 app[web.1]:     12:     <link href="images/apple-touch-icon.png" rel="apple-touch-icon">
2012-04-06T16:52:23+00:00 app[web.1]:   app/views/layouts/application.html.erb:9:in `_app_views_layouts_application_html_erb___37461260917978840_28780360'
2012-04-06T16:52:23+00:00 app[web.1]:   app/controllers/posts_controller.rb:24:in `new'
2012-04-06T16:52:23+00:00 app[web.1]: 
2012-04-06T16:52:23+00:00 app[web.1]: 
2012-04-06T16:52:23+00:00 app[web.1]: cache: [GET /] miss
2012-04-06T16:52:24+00:00 heroku[nginx]: 115.186.162.46 - - [06/Apr/2012:16:52:24 +0000] "GET / HTTP/1.1" 500 728 "-" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_2) AppleWebKit/534.52.7 (KHTML, like Gecko) Version/5.1.2 Safari/534.52.7" weddoo.heroku.com 
```

* * *

**宝石文件**

```
source 'http://rubygems.org'

gem 'rails', '3.1.1'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'
gem 'pg'
gem 'json'
gem "twitter-bootstrap-rails", "~> 2.0.1.0"

# Gems used only for assets and not required
# in production environments by default.
group :assets do
gem 'sass-rails',   '~> 3.1.4'
gem 'coffee-rails', '~> 3.1.1'
gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug' 
```

**瑞克文件**

```
#!/usr/bin/env rake
# Add your own tasks in files placed in lib/tasks ending in .rake,
# for example lib/tasks/capistrano.rake, and they will automatically be available to Rake.

require File.expand_path('../config/application', __FILE__)

Mysalary::Application.load_tasks 
```

**HEROKU信息**

```
=== weddoo
Addons:        Shared Database 5MB
Database Size: 64k
Dynos:         1
Git URL:       git@heroku.com:weddoo.git
Owner:         postkhalid@yahoo.com
Repo Size:     11M
Slug Size:     11M
Stack:         bamboo-mri-1.9.2
Web URL:       http://weddoo.heroku.com/
Workers:       0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T07:55:32.360

因此，根据`heroku info`您提供的信息，我看到您在竹堆栈上，并且该堆栈不支持 Rails 3.1+。只有 cedar 堆栈支持 Rails 3.1+。您需要使用以下命令在 cedar 堆栈上创建一个新应用程序：

```
heroku create --stack cedar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-07T02:29:22.707

这是您的样式表没有被编译的结果。Heroku 将尝试运行

```
rake assets:precompile 
```

在部署您的应用程序之前。如果预编译命令失败，它将暂时静默失败。我实际上在 Heroku 上有一个未解决的问题

[https://github.com/heroku/heroku-buildpack-ruby/issues/9](https://github.com/heroku/heroku-buildpack-ruby/issues/9)

最可能的原因是 Rakefile 正在尝试加载（或访问）gem。Heroku buildpacks 尝试在访问 gemset 之前编译样式表，因此任何要求都会失败。避免这种情况的最好方法是将这些要求包装在您的 Rakefile 中特定于环境的条件中：

```
if Rails.env == 'development' || Rails.env == 'test'
  require 'somegem1'
  require 'somegem2'

  # whatever code is being used by those gems goes in this block
end 
```

# ios - 有没有人成功集成 Ember.js - Phonegap（和 jQuery Mobile）？

> ID：10046699
> 
> 赞同：7
> 
> 时间：2012-04-06T17:06:07.313
> 
> 标签：ios, cordova, ember.js

我正在努力将 Cordova(=Phonegap) 与 Ember.js 和 jQuery Mobile 集成。Ember.js + jQuery Mobile 工作正常，因为在任何桌面浏览器中加载 index.html 都会成功加载应用程序。

使用 xCode 4 和 iPhone 5.1 模拟器，它不会在车把标签中显示任何内容。这意味着 Ember.js 无法加载。

**索引.html：**

```
<html lang="en"> 
<head>

  <title></title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
  <meta charset="utf-8">

  <link rel="apple-touch-icon" href="/apple-touch-icon.png">

  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />

</head>
<body>
  <script type="text/x-handlebars" data-template-name="main">
    this text is NOT displayed

  </script>

  <div> this text IS displayed </div>

  <script src="js/vendor/jquery.min.js"></script>
  <script src="js/vendor/jquery.mobile.js"></script>
  <script src="js/vendor/ember.js"></script>
  <script src="js/app/app.js"></script>
  <script src="js/vendor/cordova-1.5.0.js"></script>
  <script type="text/javascript">

      // If you want to prevent dragging, uncomment this section
      function preventBehavior(e){ 
          e.preventDefault(); 
      };
      document.addEventListener("touchmove", preventBehavior, false);

      document.addEventListener("deviceready", onDeviceReady, false);

      /* When this function is called, Cordova has been initialized and is ready to roll */
      /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
      see http://iosdevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
      for more details -jm */
      function onDeviceReady(){
          // do your thing!
      }

  </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:58:25.040

发现了问题。XCode 报告：

```
 ERROR whitelist rejection: url='http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css' 
```

在[此](http://www.prosoxi.com/2011/10/08/xcode-phonegap-white-list-rejection/)之后，我在数组中添加`*.jquery.com`了.`ExternalHosts``Cordova.plist`

# bash - 如何设置具有 -（破折号）选项的环境变量

> ID：10046700
> 
> 赞同：0
> 
> 时间：2012-04-06T17:06:10.373
> 
> 标签：bash, environment-variables

我正在尝试在 linux 上构建一个软件，我需要在 bash shell 中设置以下环境变量。

BLAS_LIBRARIES=-L/home/someuser/GotoBLAS2/lib -lgoto2 -lgfortran -lpthread CUBLAS_LIBRARIES=-L/usr/local/cuda/4.0.17/cuda/lib64 -lcublas -lcudart -lcuda

当我在 bash shell 中执行此操作时，出现错误： bash: -lgoto2: command not found bash: -lcublas: command not found

谁能告诉我如何设置这些而不会出现这些错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:09:02.737

你只需要引用它们：

```
BLAS_LIBRARIES="-L/home/someuser/GotoBLAS2/lib -lgoto2 -lgfortran -lpthread " 
```

# iphone - 在另一个 ViewController 的视图中显示整个 ViewController

> ID：10046705
> 
> 赞同：0
> 
> 时间：2012-04-06T17:06:38.103
> 
> 标签：iphone, navigation, storyboard, tableview

我正在编写一个主视图控制器是`UIViewController`. 它在网格中有一些图标，当单击其中一个图标时，我想关闭（向下滑动）该网格。这个我已经做过了。问题是：当网格被关闭时，我希望另一个视图来自屏幕顶部。该视图位于同一个根视图控制器中。但是我想在这个视图中显示其他视图控制器的内容。例如：我希望这个视图显示一个里面`UINavigationController`有一个`UITableView`，所以用户可以在 TableViews 中导航。

我正在这样做：

```
HorariosViewController *horarios = [[HorariosViewController alloc] init];
[vuashView addSubview:horarios.view]; 
```

`HorariosViewController`是一个`UINavigationViewController`。它只向我显示了一个蓝色的 NavigationBar，并且更改`self.navigationItem.title = @"Title"`不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:19:20.573

您可以将另一个视图控制器的视图显示为子视图，但除非您编写代码来建立新连接，否则它们的出口和操作仍链接到其原始视图控制器，因此`self.whatever`不应期望影响其他视图控制器的属性。

（此外，如果 HorariosViewController 是 UINavigationController，则不应将其创建为 UIViewController。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:21:32.010

一种方法是让导航控制器已经存在，并在其顶部以模态方式显示图标网格。（您可以在没有动画的情况下以这种方式设置视图，因此用户看不到下面的导航控制器）。

然后，当网格消失的时候，它可以用动画调用它自己的dismissModalViewController。

# ruby - “开始”和“结束”是否是保留字？

> ID：10046710
> 
> 赞同：6
> 
> 时间：2012-04-06T17:07:22.907
> 
> 标签：ruby

我对 Ruby 中的保留字有点困惑。

由 Matz 合着的“The Ruby Programming Language”就是这样说的，`begin`并且`end`是该语言的保留字。它们当然在语法上用于标记块。

但是，该语言中的范围对象具有名为`begin`and的方法`end`，如

```
(1..10).end
=> 10 
```

现在，测试一下，我发现，确实，我可以在对象上定义名为“begin”和“end”的方法，但如果我尝试将变量命名为“begin”，它会失败。（这是使用它作为方法名称的示例，它确实有效...... :)

```
class Foo
  def begin
    puts "hi"
  end
end

Foo.new.begin 
```

所以，我想我在问，这样的保留字实际上是什么状态？我会想象它们不能用于方法名称（但它似乎有效），或者至少它会是一种糟糕的风格（但它实际上用于 Range 类的核心语言）。

对于何时允许使用它们以及用于什么用途，我感到非常困惑。甚至有这方面的文件吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-06T17:09:34.293

是的，它们是保留字。是的，它们可以用于方法名称。不，如果没有明确的接收者，你不能打电话给他们。无论如何，这可能不是一个好主意。

```
class Foo
  def if(foo)
    puts foo
  end
end

Foo.new.if("foo") # outputs foo, returns nil 
```

**更新：**这是 Matz（Ruby 的创建者）自己引用的“The Ruby Programming Language”：

> 在大多数语言中，这些词将被称为“保留词”，它们永远不会被允许作为标识符。Ruby 解析器很灵活，如果您在这些关键字前面加上 @、@@ 或 $ 前缀并将它们用作实例、类或全局变量名，它不会报错。此外，您可以将这些关键字用作方法名称，但需要注意的是，该方法必须始终通过对象显式调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:10:48.523

当它们以明确的方法调用形式给出时，您可以使用它们。如果您在它前面有一个句点`.begin`或在 is 后面有括号`begin()`，那么它无疑是一个方法调用。当您尝试将其用作变量`begin`时，它是模棱两可的（原则上）。

实际上，正如 Perry 所指出的那样，`begin()`这可能很棘手。我用 Ruby 1.9.3 与 irb 进行了检查，发生了以下奇怪的事情：

```
irb(main):001:0> def begin(foo)
irb(main):002:1> puts 'a'
irb(main):003:1> end
=> nil
irb(main):004:0> begin(3)
irb(main):005:1> 
irb(main):006:1* end
=> 3 
```

它没有定义，看起来像方法调用的可能只是一个返回 last-evaluate 的块`3`。但周围的线条`def begin(foo)`仍然是个谜。

# java - 在 App Engine 上录制声音的最佳方式

> ID：10046711
> 
> 赞同：2
> 
> 时间：2012-04-06T17:07:27.453
> 
> 标签：java, google-app-engine, audio

是否可以现场录制声音并将其保存到服务器？有没有人有任何资源可以解释如何实现这一目标？似乎标准的闪存不起作用。其他可能的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T18:12:33.317

您只需要录制声音并将其发布到 blobstore。appengine 中没有用于录制声音的内置工具，但 blobstore 可以保存您想要的任何二进制数据。

# javascript - 简单的嵌套 setTimeout() 只运行一次 (JavaScript)

> ID：10046731
> 
> 赞同：1
> 
> 时间：2012-04-06T17:09:26.903
> 
> 标签：javascript, nested, settimeout

出于某种原因，我的 galleryScroll() 函数只运行一次，即使该函数使用 setTimeout() 调用自身。我认为这个问题可能与范围有关，但我不确定：

[http://jsfiddle.net/CYEBC/2/](http://jsfiddle.net/CYEBC/2/)

```
$(document).ready(function() {
    var x = $('#box').offset().left;
    var y = $('#box').offset().top;
    galleryScroll();

    function galleryScroll() {
        x = x + 1;
        y = y + 1;
        $('#box').offset({
            left: x,
            top: y
        });
        setTimeout('galleryScroll()', 100);
    }
});​ 
```

的HTML：

```
<html>
<head>
</head>
<body>
    <div id="box">
    </div>
</body>
</html>​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:16:36.063

该函数`galleryScroll()`未在要评估的正确范围内定义`setTimeout()`。如果您希望它在循环中运行，请在`setInterval()`函数之后调用它。

```
$(document).ready(function() {
    var x = $('#box').offset().left;
    var y = $('#box').offset().top;
    galleryScroll();

    function galleryScroll() {
        x = x + 1;
        y = y + 1;
        $('#box').offset({
            left: x,
            top: y
        });
    }
    // Call in setInterval() outside the function definition.
    // Note also, I've changed the eval string 'gallerySroll()' to the function reference galleryScroll
    setInterval(galleryScroll, 100);
});​ 
```

[这是更新的小提琴。](http://jsfiddle.net/CYEBC/10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:20:30.283

您的问题是您如何在 setTimeout 中调用 galleryScroll() 函数。将该行更改为：

```
 setTimeout(galleryScroll, 100); 
```

结果：http: [//jsfiddle.net/CYEBC/12/](http://jsfiddle.net/CYEBC/12/)

注意：我不确定这是否是所需的行为，但是当您的代码被正确调用时会发生这种情况。

# javascript - 将 .html 添加到字符串 Javascript？

> ID：10046735
> 
> 赞同：-1
> 
> 时间：2012-04-06T17:10:08.433
> 
> 标签：javascript, string, add

我想检查一个字符串是否以“.php”扩展名结尾，如果不是，我想在末尾添加 .html。我已经尝试过各种“切片”方法，但都没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:13:54.370

您可以为此使用正则表达式

```
var string1 = "www.example.com/index";
var newString = !/\.php$/i.test(string1)? string1+".html": string1;
// newString = "www.example.com/index.html" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:15:24.637

用来 `(yourstring + '.html').replace(/\.php\.html$/, '.php')`做到这一点：

```
var str1 = 'one.php';
var str2 = 'two';
var str3 = '.php.three.php';
var str4 = '.php.hey';

console.log((str1 + '.html').replace(/\.php\.html$/, '.php')); // Prints one.php
console.log((str2 + '.html').replace(/\.php\.html$/, '.php')); // Prints two.html
console.log((str3 + '.html').replace(/\.php\.html$/, '.php')); // Prints .php.three.php
console.log((str4 + '.html').replace(/\.php\.html$/, '.php')); // Prints .php.hey.html 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:16:07.217

也许：

```
function appendHTML(string) {
    var html = string;
    if (string.lastIndexOf('.php') === (string.length - 4)) {
        html += '.html';
    }
    return html;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T17:17:07.367

使用正则表达式来解决您的问题。/.php$/ 是一个正则表达式，用于检查字符串是否以 '.php' 结尾

欲了解更多信息，请阅读：[http ://www.w3schools.com/js/js_obj_regexp.asp](http://www.w3schools.com/js/js_obj_regexp.asp)

示例代码：

```
str = "http://abc.com";
str = ( /\.php$/.test( str ) ) ? str : str + '.html'; // this is the line you want.

str === "http://abc.com.html" // returns true 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-06T17:20:00.827

好吧，`slice()`这项任务工作正常。

```
var s = "myfile.php";

if (s.slice(-4) != ".php")
    s = s.slice(0, -4) + ".html"; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-06T17:14:02.350

尝试这样的事情

```
function isPHP(str)
{
    return str.substring(str.length - 4) == ".php";
} 
```

然后你可以做

```
str = isPHP(str) ? str : str + ".html"; 
```

# eclipse - 在 Eclipse IDE 中运行 JBoss 7.1 时出现错误“服务器无法启动”

> ID：10046740
> 
> 赞同：0
> 
> 时间：2012-04-06T17:10:28.773
> 
> 标签：eclipse, jboss7.x

我在 Eclipse 3.7 (Indigo) 中通过 JBoss Tools 3.3 版安装和运行 JBoss AS 7.1.0 时遇到问题。我创建了一个新的服务器运行时环境：Window->Preferences->Server->Runtime environment JBoss AS 根目录（我的是C:\jboss-as-7.1.0.Final）选择“创建一个新的本地服务器”。

创建服务器：File->New->Other->Server->Server->JBoss Community->JBoss AS 7.x 选择我新创建的运行时配置，点击next完成。

我试图运行服务器进行测试，但 Eclipse 抛出了某种错误。这里来自“错误日志”的信息：

服务器 JBoss 7.1 运行时服务器无法启动。

**eclipse.buildId** =M20120208-0800

**java.version** =1.6.0_31

**java.vendor** = Sun Microsystems Inc.

**BootLoader 常量：** OS=win32、ARCH=x86、WS=win32、NL=ru_RU

**框架参数：** -product org.eclipse.epp.package.jee.product

**命令行参数：** -os win32 -ws win32 -arch x86 -product org.eclipse.epp.package.jee.product

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T15:33:08.393

我们在 Windows 上遇到了完全相同的问题。我们通过使用 JBoss AS 7.1.1 而不是 7.1.0 解决了这个问题。可能您还需要执行[此解决方法](https://community.jboss.org/en/tools/blog/2011/11/24/jboss-as-71-beta1-with-jboss-tools--use-web-port-poller)。但我认为这不是必需的，因为您已经使用了 3.3 版的 JBoss 工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-05T20:22:07.157

当您尝试使用 java 版本 > 1.7 启动 Jboss 时可能会发生此问题您可以尝试升级您的 java

# php - 在 MySQL 数据库中搜索全名或名字或姓氏，名字和姓氏在不同的列中

> ID：10046741
> 
> 赞同：25
> 
> 时间：2012-04-06T17:10:30.897
> 
> 标签：php, mysql

我正在使用一个现有的数据库，该数据库的名字和姓氏在数据库中分开。我需要创建一个函数，该函数将接受一个搜索输入并返回结果。说我的数据库有这样的结构......

```
nameFirst nameLast
Joe       Smith
Joe       Jones
Joe       Brown 
```

我怎么能使用 MySql 输入“Joe Smith”这样的搜索输入并得到他的行？但是，如果我在搜索字段中只输入“乔”，则全部返回？我需要用空格爆炸字符串吗？谢谢！

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-04-06T17:19:48.077

```
SELECT * 
FROM table
WHERE CONCAT( nameFirst,  ' ', nameLast ) LIKE  '%Joe%' 
```

确保清理所有用户提交的参数，例如“Joe”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-02-05T15:56:51.927

```
SELECT * FROM table WHERE CONCAT(nameFirst, ' ', nameLast) LIKE 'Joe%'; 
```

如果您确定您的搜索输入以“Joe”开头以过滤更多内容，我建议使用此选项。

以我的拙见，在很多情况下，我们不知道搜索输入是姓名还是姓氏，所以我建议使用这个：

```
SELECT * FROM table WHERE CONCAT(nameFirst,  ' ', nameLast) LIKE  'SEARCH_INPUT%' OR CONCAT(nameLast,  ' ', nameFirst) LIKE 'SEARCH_INPUT%'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-03T12:42:51.997

```
$sql = "SELECT * from add_contact  WHERE ( CONCAT(first_name, ' ',last_name)  LIKE '%$search%' OR first_name LIKE '%$search%' OR last_name LIKE '%$search%' OR company LIKE '%$search%') AND (archives='$archives') ORDER BY UNIX_TIMESTAMP(sort_date) DESC"; 
```

# ruby-on-rails - 应该如何使用decent_exposure来暴露可能不存在的相关项目？

> ID：10046744
> 
> 赞同：0
> 
> 时间：2012-04-06T17:10:40.617
> 
> 标签：ruby-on-rails

我正在使用decent_exposure gem并且遇到了一个难题。

我有一个模型 Child 是模型 Parent 的孩子，但并不总是在 Parent 的上下文中调用 - 例如 show 方法不会被嵌套。

My Child 的控制器公开了 :parent 和 :children { parent.children }，当在 Parent 的上下文中调用 index 方法时有效，但在没有父上下文的情况下调用子 show 方法时无效。

这应该如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T18:11:05.063

我通常会做类似的事情：

```
expose(:child) {params[:id] ? Child.find(params[:id]) : Child.new(params[:child]} 
```

这适用于显示、更新和编辑、删除，因为这需要 ID (/child/1)，但语句的后半部分将允许您也支持新建和创建。

# sql - 我想用 sql 做的事情甚至可能吗？

> ID：10046746
> 
> 赞同：2
> 
> 时间：2012-04-06T17:10:58.840
> 
> 标签：sql, tsql

我正在查找的表中有特定信息，此查询将显示它：

```
SELECT StringValue FROM ClientSettings
WHERE Setting like 'CompanyDomain'
OR Setting like 'CompanyActivityEmail'
OR Setting like 'CompanySupportPhone'
OR Setting like 'CompanyName' 
```

它返回以下日期：

```
StringValue
MyCompanyName
MyCompanyName@email.com
www.mycompanydomain.com
801-555-1212 
```

我现在尝试将这些设置为变量，而不必制作 4 个单独的选择语句。

这是我所拥有的，但它没有按我的意愿工作：

```
DECLARE @CompanyName VARCHAR(100)
DECLARE @CompanyDomain VARCHAR(100)
SELECT @CompanyName = StringValue, @CompanyDomain = StringValue FROM ClientSettings
WHERE Setting like 'CompanyName'
OR Setting like 'CompanyDomain'

SELECT @CompanyName
SELECT @CompanyDomain 
```

我很好奇我什至尝试的东西是否可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:18:43.210

我认为问题在于您应该只为每一行分配一个值，而不是同时覆盖其他变量。一个`CASE`声明应该让你这样做：

```
DECLARE @CompanyName VARCHAR(100)
DECLARE @CompanyDomain VARCHAR(100)

SELECT 
    @CompanyName = CASE WHEN Setting = 'CompanyName' 
        THEN StringValue ELSE @CompanyName END, 
    @CompanyDomain = CASE WHEN Setting = 'CompanyDomain' 
        THEN StringValue ELSE @CompanyDomain END
FROM ClientSettings
WHERE Setting like 'CompanyName'
OR Setting like 'CompanyDomain'

SELECT @CompanyName
SELECT @CompanyDomain 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-06T17:19:13.170

您可以使用 PIVOT 来执行此操作，但它有点 hacky，因为它需要使用聚合才能工作

```
DECLARE @CompanyName VARCHAR(100) 
DECLARE @CompanyDomain VARCHAR(100) 

SELECT @CompanyName = [CompanyName], 
       @CompanyDomain = [CompanyDomain] 
FROM   (SELECT setting, 
               stringvalue 
        FROM   clientsettings 
        WHERE  setting LIKE 'CompanyName' 
                OR setting LIKE 'CompanyDomain') AS sourcetable PIVOT ( MAX( 
       stringvalue 
       ) FOR setting IN ([CompanyName], [CompanyDomain]) ) AS pivottable

SELECT @CompanyName, 
       @CompanyDomain 
```

[工作演示](http://sqlfiddle.com/#!3/f82af/1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:17:09.830

```
SELECT setting, StringValue 
FROM ClientSettings
WHERE Setting in ('CompanyDomain'
                  ,'CompanyActivityEmail'
                  ,'CompanySupportPhone'
                  ,'CompanyName') 
```

然后循环结果并分配您的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T17:24:22.773

作为一种替代方法，您可以创建一个名为的表，例如`company_settings`，其中的单列`Setting`具有值`'CompanyDomain'`等`'CompanyActivityEmail'`。

然后你可以这样做：

```
SELECT StringValue FROM ClientSettings
WHERE Setting is in (select Setting from company_settings); 
```

或者简单地说：

```
SELECT StringValue 
FROM ClientSettings a
JOIN company_settings b
ON (a.Setting=b.Setting); 
```

# javascript - 更改动态列表项的 CSS

> ID：10046749
> 
> 赞同：0
> 
> 时间：2012-04-06T17:11:29.317
> 
> 标签：javascript, jquery, css, css-animations

**===更新===**

*如果我`the style="display: none;`从模板中删除并按照下面的建议应用以下方法，则当您单击任何其他列表项时会触发空容器。还有什么可以做的？*

我有一个在运行时使用 jQuery 和 JSON 动态创建的 ul 列表（使用内联 HTML 是一个模板）。当用户单击列表项 (#navItem) 时，我需要更改背景 CSS 样式。我已经尝试了从内联类到 .appentTo() 等我能想到的一切。我下面的内容适用于硬编码元素，但似乎没有任何东西适用于动态加载的内容。更令人困惑的是 li 标签内的元素中的类启动...？？？

任何帮助，将不胜感激。下面是我的代码片段。谢谢。

HTML：

```
<div id="navScrollContainer" class="navContentPosition">
    <ul id="navContent">
    // Display as 'None' to prevent a empty containter from showing -->
        <li id="navItem" class="ulFx" style="display: none;">//<-THIS NEEDS TO CHANGE ONCLICK!!
            <a class="navA">
            <h1 class="navH1">.</h1>
            <h2 class="navH2">.</h2>
            <p class="navP">.</p>
            <hr class="navHR" />
        </li>
    </ul>
</div>
<script type="text/javascript">
    $('#navScrollContainer').on('click', '.ulFx', function() {
        $(this).addClass("liFx");
    });
</script> 
```

这是将数据作为列表注入 DOM 的函数：

```
function loadNav(url, container, appendE) {
    $.getJSON(url, function(data) {

        $.each(data.items, function() {
            var newItem = $('#' + container).clone();
            // Now fill in the fields with the data
                    newItem.addClass('ulFx');
            newItem.find("h1").text(this.label);
            newItem.find("h2").text(this.title);
            newItem.find("p").text(this.description);
            newItem.find("a").attr("href", this.gotoURL);
            newItem.children().appendTo('#' + appendE);
        });

        $('#navHeaderTitle').text(data.listTitle);
        iniScroll('scrollNav', 'navScrollContainer');
        var target = data.targetKey;
        // transition("#" + pageName, "show");
    });
}; 
```

当用户点击一个项目时需要发生的 CSS（仅在该项目上）：

```
@-webkit-keyframes
liBG {from {
    background-color: transparent
}
50% { background-color: rgba(51,102,255,0.15); }
to {
    background-color: transparent
}
}

.liFx {
    -webkit-animation-name: liBG;
    -webkit-animation-duration: 1s;
    -webkit-animation-fill-mode: forwards;
} 
```

赋予 li 项目的类属性：

```
.navH1 {
    font-size: 18px;
    color: #FFA500;
    text-decoration: underline;
    font-weight: bold;
    margin-top: 8px;
    margin-bottom: 8px;
    margin-left: 15px;
}
.navH2 {
    font-size: 16px;
    color: #999999;
    font-weight: bold;
    margin-top: 5px;
    margin-bottom: 5px;
    margin-left: 25px;
    font-weight: bold;
}
.navP {
    color: #888;
    font-size: 14px;
    text-align: justify;
    margin-top: 5px;
    margin-bottom: 16px;
    margin-left: 25px;
    margin-right: 10px;
}
.navA {
    text-decoration: none;
}
.navHR {
    border: none;
    background-color: #336;
    height: 1px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:21:23.413

这将监视动态元素：

```
$(".liFx").live("click", function() {
  $(this).addClass("liBG");
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T17:21:56.787

没有看到你的点击处理程序，我只能推测。但是，通常当问题与动态内容相关并让它们响应刺激时，问题在于您如何附加处理程序。

如果您使用`.click()`, 或`.trigger('click')`，则处理程序将直接应用于您正在调用这些函数的元素。这意味着如果元素当前不存在，它们将不会收到处理程序。

解决这个问题的方法是将事件侦听器附加到始终存在的父元素上，然后监视从动态子元素向上传播的事件。您可以通过查看 来手动执行此操作，`event.target`但 jQuery 像往常一样让我们轻松完成此操作。

这样做的现代 jQuery 方法是使用`.on()`（[文档](http://api.jquery.com/on)）：

```
$('#someparent').on('click', '#childselector', function() {
   // my handler code
}); 
```

jQuery 然后在 上附加一个处理程序`#someparent`，当它看到针对 的单击时`#childselector`，它会触发。

如果您想将一个类应用于 的子级`#navContent`，并且`#navContent`将始终存在，请执行以下操作：

```
$('#navContent').on('click', 'li', function() {
     $(this).addClass("liFx");
}); 
```

如果`#navContent`也是动态的，只需在 DOM 树中往上走。

作为旁注，我注意到`li`的 id 为`navItem`. 这听起来很像一个类，而不是一个 ID。如果您要拥有多个`navItem`，则它们不能都具有相同的 ID。这就是类的用途：

```
<li class="navItem liFx" style="display: none;"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:22:34.837

我不确定问题出在哪里，但是您正在尝试这样做：

```
$("#navlink").on('click', function() {
     $("#yourselector").css("backgroundColor", "#ddd"); //change the color
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T21:20:25.907

我在我的函数中添加了另一个 div 和 addClass() 方法以及[上面 Jeff B 的答案](https://stackoverflow.com/a/10046867/742030)。如果类被硬编码到标签中，它就不起作用。

```
<ul id="navContent">
    <li id="navItem" style="display: none;">
        <div>//ADDED THIS TAG TO EXCEPT THE CLASS
            <a>
                <h1>.</h1>
                <h2>.</h2>
                <p>.</p>
                <hr/>
            </a>
        </div>
    </li>
</ul> 
```

在我的 js 文件中：

```
$.each(data.items, function() {
    var newItem = $('#' + container).clone();
    // Now fill in the fields with the data
    newItem.find("div").addClass("ulFx");//ADDED THIS METHOD
    newItem.find("h1").text(this.label);
    newItem.find("h2").text(this.title);
    newItem.find("p").text(this.description);
    newItem.find("a").attr("href", this.gotoURL);
    newItem.children().appendTo('#' + appendE);
}); 
```

# python - 使用 ElementTree 编写带有 utf-8 数据的 xml utf-8 文件

> ID：10046755
> 
> 赞同：13
> 
> 时间：2012-04-06T17:12:12.883
> 
> 标签：python, elementtree

我正在尝试使用 ElementTree 编写一个带有 utf-8 编码数据的 xml 文件，如下所示：

```
#!/usr/bin/python                                                                       
# -*- coding: utf-8 -*-                                                                   

import xml.etree.ElementTree as ET
import codecs

testtag = ET.Element('unicodetag')
testtag.text = u'Töreboda' #The o is really &#246; (o with two dots over). No idea why SO dont display this
expfile = codecs.open('testunicode.xml',"w","utf-8-sig")
ET.ElementTree(testtag).write(expfile,encoding="UTF-8",xml_declaration=True)
expfile.close() 
```

这会因错误而爆炸

```
Traceback (most recent call last):
  File "unicodetest.py", line 10, in <module>
    ET.ElementTree(testtag).write(expfile,encoding="UTF-8",xml_declaration=True)
  File "/usr/lib/python2.7/xml/etree/ElementTree.py", line 815, in write
    serialize(write, self._root, encoding, qnames, namespaces)    
  File "/usr/lib/python2.7/xml/etree/ElementTree.py", line 932, in _serialize_xml
    write(_escape_cdata(text, encoding))
  File "/usr/lib/python2.7/codecs.py", line 691, in write
    return self.writer.write(data)
  File "/usr/lib/python2.7/codecs.py", line 351, in write
    data, consumed = self.encode(object, self.errors)
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 1: ordinal not in range(128) 
```

使用“us-ascii”编码可以正常工作，但不要保留数据中的 unicode 字符。怎么了？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-06T20:09:16.860

`codecs.open`期望将 Unicode 字符串写入文件对象，并将处理编码为 UTF-8。ElementTree 在`write`将 Unicode 字符串发送到文件对象之前将其编码为 UTF-8 字节字符串。由于文件对象需要 Unicode 字符串，它使用默认`ascii`编解码器将字节字符串强制回 Unicode 并导致`UnicodeDecodeError`.

只需这样做：

```
#expfile = codecs.open('testunicode.xml',"w","utf-8-sig")
ET.ElementTree(testtag).write('testunicode.xml',encoding="UTF-8",xml_declaration=True)
#expfile.close() 
```

# asp.net - 时区感知 asp.net 事件网站：UTC 与本地日期时间

> ID：10046757
> 
> 赞同：0
> 
> 时间：2012-04-06T17:12:19.783
> 
> 标签：asp.net, datetime, timezone, utc

我正在一个 asp.net 网站上工作，客户端创建事件并且用户注册这些事件。在阅读了大量关于如何存储和显示日期时间的主题之后，我仍然对采取哪条路线感到困惑。

最被接受的解决方案（在搜索主题之后）是将所有内容存储在 UTC 中并减去客户端的时区偏移量以进行显示。另一种方法是将日期时间存储在事件的时区（事件的本地时间，而不是服务器），并在请求时将其按原样显示给客户端。那不是更有效率吗？我错过了什么吗？是否以这种方式考虑夏令时？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T10:26:19.653

使用事件的位置时区作为参考点，我们可以这样做来获取当前的本地时间（在 .NET 3.5 或 4.0 中）：

```
string EventTimeZoneId = "GTB Standard Time"; // for instance, this should be stored in DB as varchar[32]
DateTime EventLocalTime = TimeZoneInfo.ConvertTimeBySystemTimeZoneId(DateTime.UtcNow, EventTimeZoneId); 
```

这也考虑了夏令时。我能想到的唯一缺点是，如果客户端在创建事件时选择了错误的时区，那么所有注册都会有错误的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:16:39.010

将所有内容存储在 UTC 中是有原因的标准。

您将事件存储在当地时间的替代方案会导致不同时区的用户对事件实际发生的时间感到困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:38:31.330

如果您使用的是 c# asp.net

1.  存储在数据库中

> DateTime CurrntDate= DateTime.SpecifyKind(DateTime.Now, DateTimeKind.Unspecified); var _utc = TimeZoneInfo.ConvertTimeToUtc(CurrntDate, TimeZoneInfo.Local);

1.  从 db 获取日期并根据客户端时区进行转换并显示。

它将在您的业务逻辑中保持一致性。

# windmill - 风车里有什么特殊角色吗？我该如何覆盖？

> ID：10046760
> 
> 赞同：0
> 
> 时间：2012-04-06T17:12:36.247
> 
> 标签：windmill, testautomationfx

我正在尝试关闭一个名为 [Close] 的弹出窗口。

```
client.click(link=u'[Close]')
client.waits.forElement(link=u'[Close]', timeout=u'8000') 
```

好像要死在这里了。

```
'debug': u'Looking up id docname, failed.

>>> test_results: ERROR    Test Failure in test {'version': u'0.1', u'suite_name
': u'exampletest', 'result': False, 'starttime': u'2012-3-6T11:56:0.877Z', 'outp
ut': None, 'debug': u'Looking up id docname, failed.', u'params': {u'uuid': u'44
d8908f-8009-11e1-9665-2c27d7ea08c4', u'id': u'docname'}, 'endtime': u'2012-3-6T1
1:56:0.877Z', u'method': u'asserts.assertNode'} 
```

有没有办法在代码中包含文字括号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-10T17:31:55.093

在这种情况下，链接在括号和字母之间有一个空格。

```
[ Close ] 
```

不是

```
[Close] 
```

# java - 从面板中删除关键侦听器

> ID：10046762
> 
> 赞同：5
> 
> 时间：2012-04-06T17:13:22.457
> 
> 标签：java, swing, jpanel, keylistener

是否可以清除我戴上的监听器`JPanel`？当我调用一个方法时，我`KeyListener`在面板上放了一个，但是当我退出这个方法时，我想清除那个监听器。

这是我的方法：

```
private void stopBall(final Graphics2D g2, int posBallY, String winner) {

        move = false;
        scorePanel.showPressSpace(true);    

        setFocusable(true);
        requestFocus();

        addKeyListener(new KeyAdapter() {

            public void keyPressed(KeyEvent e){  
                if (e.getKeyCode() == KeyEvent.VK_SPACE){ 

                    setPosX(getPlayPanelWidth()/2);
                    setPosY(0);

                    move = true;
                    scorePanel.showPressSpace(false);
                    initBall(g2);
                } 

            }});

        if (winner == "player1") {
            scoreCountPlayer1++;
            scorePanel.getLab_Player1().setText("" + scoreCountPlayer1);

        } else if (winner == "comp") {
            scoreCountComputer++;
            scorePanel.getLab_Computer().setText("" + scoreCountComputer);
        }   
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:28:35.007

您对 addKeyListener(KeyListener) 的调用不合格，因此我认为您已经扩展了 JPanel。如果是这样，那么您可以调用 removeKeyListener(KeyListener)。在您当前的代码中，您的关键侦听器是匿名的。您需要稍作更改以保留该引用，如下所示：

```
// Create a variable holding the listener
KeyAdapter keyAdapter = new KeyAdapter()
{
  public void keyPressed(KeyEvent e)
  {
    if (e.getKeyCode() == KeyEvent.VK_SPACE)
    {
      setPosX(getPlayPanelWidth() / 2);
      setPosY(0);

      move = true;
      scorePanel.showPressSpace(false);
      initBall(g2);
    }

  }
};
// Register the listener with this JPanel
addKeyListener(keyAdapter);

// Time passes...

// Remove the listener from this JPanel
removeKeyListener(keyAdapter); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T18:40:20.737

或者对代码进行绝对最小调整的方式

```
addKeyListener(new KeyAdapter() {
  public void keyPressed(KeyEvent e){  
    if (e.getKeyCode() == KeyEvent.VK_SPACE){ 
      ((JPanel)e.getSource()).removeKeyListener( this );
      setPosX(getPlayPanelWidth()/2);
      setPosY(0);

      move = true;
      scorePanel.showPressSpace(false);
      initBall(g2);
    } 
  }
}); 
```

但正如评论中已经说明的那样，您应该选择键绑定而不是键监听器

# javascript - 具有用于创建用户和登录用户的验证的 Backbone.js 模型

> ID：10046763
> 
> 赞同：2
> 
> 时间：2012-04-06T17:13:34.090
> 
> 标签：javascript, backbone.js

我有一个模型`User`。该模型目前适用`Register`于“注册”新用户的视图。

用户：

```
var User = Backbone.Model.extend({
    url: '/user',
    defaults: {
        first_name: '',
        last_name: '',
        email: '',
        username: '',
        password: ''
    },
    parse: function(response){
        if(response.username) {
            this.trigger('username_check',response.username);
        }
        if(response.email) {
            this.trigger('email_check',response.email);
        }       
    },
    validate: function(attrs) {

        var email_filter    = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        var username_filter = /^([a-zA-Z0-9]){0,1}([a-zA-Z0-9])+$/;

        errors = [];

        if (attrs.first_name == '') 
            errors.push({name: 'first_name', error: 'Please enter your First Name'});

        if (attrs.last_name == '') 
            errors.push({name: 'last_name', error: 'Please enter your Last Name'});

        if (!email_filter.test(attrs.email)) 
            errors.push({name: 'email', error: 'Please enter a valid email address'});

        if (!username_filter.test(attrs.username)) 
            errors.push({name: 'username', error: 'Your username contains invalid characters.  Usernames may only contain letters and numbers.'});          

        if (attrs.username == '') 
            errors.push({name: 'username', error: 'Please provide a valid username'});

        if (attrs.username.length > 12) 
            errors.push({name: 'username', error: 'Your username must be less than 12 characters'});    

        if (attrs.username.length < 4) 
            errors.push({name: 'username', error: 'Your username must be at least 4 characters'});

        if (attrs.password == '') 
            errors.push({name: 'password', error: 'Please provide a password.'});           

        if (attrs.password.length < 5) 
            errors.push({name: 'password', error: 'Your password must be at least 5 characters in length.'});

        if(errors.length > 0) 
           return errors;
        }
}); 
```

看法：

```
 var Register = Backbone.View.extend({

        initialize: function() {

            this.user = new User;
            this.first_name             = this.$('input[name="first_name"]');
            this.last_name              = this.$('input[name="last_name"]');
            this.email                  = this.$('input[name="email"]');
            this.username               = this.$('input[name="username"]');
            this.password               = this.$('input[name="password"]');
            this.confirm_password       = this.$('input[name="confirm_password"]'); 
            this.redirect_url           = $(this.el).attr('data-redirect-url');

        },
        events: {
            'submit form' : 'onSubmit',
            'blur input[name="username"]' : 'checkUsernameExists',
            'blur input[name="email"]'    : 'checkEmailExists'
        },
        checkUsernameExists: function(e) {
            var self = this;
            if(this.username.val().length > 3) {
                this.user.fetch({data: {username : this.username.val(), check : 'true'}});
                this.user.on("username_check", function(status){
                    if(status == 'unavailable') {
                        self.processErrors([{name: 'username', error: 'This username is already taken, please try another.'}]);
                    } else {
                        $('input[name="username"]').closest('.controls').find('div.control-error').empty();
                    }
                })
            }
        },
        checkEmailExists: function(e) {
            var self = this;
            var email_filter    = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if (email_filter.test(this.email.val())) {
                this.user.fetch({data: {email : this.email.val(), check : 'true'}});
                this.user.on("email_check", function(status){
                    if(status == 'unavailable') {
                        self.processErrors([{name: 'email', error: 'This email is already used.  Please login to your account or use a different email.'}]);
                    } else {
                        $('input[name="email"]').closest('.controls').find('div.control-error').empty();
                    }
                })
            }
        },  
        onSubmit: function(e) {

            var self = this;
            e.preventDefault();

            var attrs = {
                'first_name': this.first_name.val(),
                'last_name':  this.last_name.val(),
                'email':    this.email.val(),
                'username': this.username.val(),
                'password': this.password.val()
            };

            $('div.control-error').html('');

            var user = this.user.set(attrs, {
                  error: function(model, response) {
                    self.processErrors(response);
                  }
            });

            if(user) {

                errors = [];

                if (self.confirm_password.val() == '') 
                    errors.push({name: 'confirm_password', error: 'Please confirm your password.'});

                else if (self.confirm_password.val() !== self.password.val()) 
                        errors.push({name: 'confirm_password', error: 'Your passwords do not match.  Please confirm your passwords.'});

                if(errors.length > 0) {
                    self.processErrors(errors);
                 } else {

                    user.save(this.attrs, {
                        success: function(model, response){
                        window.location.href = self.redirect_url;
                    }});
                }
            }

        },
        processErrors: function(response) {
            for (var key in response) {
                if (response.hasOwnProperty(key)) {
                    field = response[key];
                    $('input[name="'+field.name+'"]').closest('.controls').find('div.control-error').html(field.error);
                }
            }

}
}); 
```

现在我想处理登录视图。我应该使用相同的模型吗？考虑到它验证与登录视图（电子邮件/通行证）无关的方法。

是否有处理此问题的最佳实践或推荐方法？我主要使用主干进行代码分离——它不是一个全 ajax 应用程序，只有表单处理是 ajax，然后它在成功时重定向到一个新页面。这是网站的流量。

任何建议/建议对于如何处理验证和与这样的模型的各种交互、注册用户以登录用户都非常有用。

我正在考虑创建一个新模型`UserLogin`- 但不确定这是否是最好的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-07T00:05:11.593

您不需要登录模型。让视图验证表单并发出发布请求。

# java - 如何使用新的 Eclipse 字符串外部化机制更改 SWT 应用程序中的语言环境？

> ID：10046767
> 
> 赞同：0
> 
> 时间：2012-04-06T17:13:51.697
> 
> 标签：java, eclipse, internationalization, swt, string-externalization

我想让我的 SWT 应用程序多语言。因此，我正在使用新的 Eclipse 字符串外部化机制，[在此处](http://dev.eclipse.org/viewcvs/viewvc.cgi/platform-core-home/documents/3.1/message_bundles.html?view=co)进行了描述。

我为某些语言制作了不同的**messages_xx_XX.properties**，并且我正在通过**Messages.localeDependentString**寻址依赖于语言环境的字符串。

我无法理解的是，如何切换语言环境以使用其他 Messages_xx_XX.properties 而不是默认 Messages.properties？这可以在运行时执行吗？

# c - 二进制搜索中的逻辑右移防止算术溢出

> ID：10046773
> 
> 赞同：0
> 
> 时间：2012-04-06T17:14:14.137
> 
> 标签：c, algorithm, search

在二进制搜索实现中，显然：

```
mid = (low + high)/2 
```

可能导致溢出。我已经阅读了很多文档（如[this](http://googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html)），以下内容可以防止该问题：

```
mid = (low + high) >>> 1 
```

但是，我没有看到这样做的原因。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:18:13.477

C 中没有“逻辑右移”之类的东西（没有`>>>`运算符），所以您可能在谈论 Java。

这是有效的，因为`low`并且`high`假定在 0 到 2^31-1 的范围内（假设我们在`int`这里讨论）。的最大可能值`low+high`不大于`2^32-2`，因此可以用 a 表示`unsigned int`（如果 Java 中存在这样的东西）。Java中不存在这样的东西，所以我们现在已经溢出了。但是，逻辑移位运算符`>>>`将其操作数视为无符号，因此这给出了预期的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T17:21:16.493

`>>>`[是 Java ( ref](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/operators.html) )中的无符号右移运算符。因为`mid`, `low`, 和`high`是有符号整数，所以`low`和的加法`high`可能会溢出为负值。`>>>`忽略此结果的潜在负面性并将其向右移动，就好像它是一个无符号数（在 Java 中，没有无符号数）。

在 C 和 C++ 中，这相当于

```
mid = ((unsigned int)low + (unsigned int)high)) >> 1; 
```

（在您链接到的文章中明确提及）。

这最终与

```
mid = ((unsigned int)low + (unsigned int)high)) / 2; 
```

请注意，您可能不想这样做。如果要使用无符号值，则应坚持使用无符号值，并避免在有符号和无符号之间来回跳动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-06T17:22:50.887

相同的链接说明了使用 Java 的 >>> 的原因，原因是 (low+high) 可能超过 'mid' 可以容纳的最大值：

> 在 Programming Pearls Bentley 中说类似的行“将 m 设置为 l 和 u 的平均值，截断为最接近的整数”。从表面上看，这个断言可能看起来是正确的，但是对于 int 变量 low 和 high 的大值，它会失败。具体来说，如果 low 和 high 的总和大于最大正 int 值 (231 - 1)，则会失败。总和溢出为负值，除以 2 时该值保持负数。在 C 中，这会导致数组索引越界，结果不可预测。

它还说明了 C 中的等效操作：

> ……
> 
> 在 C 和 C++ 中（没有 >>> 运算符），您可以这样做：
> 
> 6: 中 = ((unsigned int)low + (unsigned int)high)) >> 1;

所以解决方案是完全阅读和理解那篇文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T17:31:19.640

`>>>`正如其他不是`C`运营商的答案中提到的那样。

但是，如果你想避免溢出`C`，你可以试试这个：

```
mid = (high - low)/2 + low; 
```

# php - 长轮询 set_time_limit() 到最大可能

> ID：10046774
> 
> 赞同：0
> 
> 时间：2012-04-06T17:14:22.367
> 
> 标签：php, long-polling

我想知道如何设置 php 页面的最大可能时间限制，

```
set_time_limit(number); 
```

我查看了 Facebook 使用**40**秒的长民意调查，为什么这个数字而不是更多？

这是最佳实践，因为浏览器将取消请求或其他什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:33:56.207

您应该考虑 Facebook 使用[HipHop](https://developers.facebook.com/blog/post/358/)作为自己开发的软件。

他们将源代码从 php 编译为 c++。这比 Apache 更强大。并且可以处理更多的连接等等。

如果您想测试它并获得更多经验，这里有一个[教程](https://github.com/facebook/hiphop-php/wiki/Building-and-installing)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:21:06.340

不，那是执行时间限制，而不是 http 连接时间限制。HTTP 1.1 使用持久连接，这意味着它不会超时，因此您的限制实际上是 Apache 而不是 PHP。

阅读 Apache 的最大客户端，看看长轮询是否会杀死你的服务器。 [http://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxclients](http://httpd.apache.org/docs/2.2/mod/mpm_common.html#maxclients)

话虽如此，如果您真的想要一个可靠的长轮询设置，我建议您研究 NodeJS 以使用非阻塞 I/0。

# php - php - 替换双引号内的内容，包括双引号

> ID：10046778
> 
> 赞同：4
> 
> 时间：2012-04-06T17:14:59.397
> 
> 标签：php, regex, replace

所以我决定尝试制作一个文本突出显示系统。目前，我只是`str_replace`用来替换一个单词（例如输入字符串`$rstr = str_replace("Console", "<c>Console</c>", $str`在哪里。 让我难过的是如何替换语音标记（“）和引号（'）中的内容。例如，如果字符串“控制台”变成了，我将如何替换为（在外部样式表中定义）？ 虽然我可以使用正则表达式，但是 1.我不知道如何编写正则表达式，2.我不知道如何将正则表达式与. `$str`

`Console.WriteLine("Words");``"Words"``<sr>"Words"</sr>``<sr>`

`str_replace`

* * *

我的解决方法：

```
function hlStr($original)
{
    $rstr = explode('"', $original);
    return $rstr[0].'<sr>"'.$rstr[1].'"</sr>'.$rstr[2];
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T17:18:30.690

根据以下评论，我认为这对您来说将是一个更好的资源：[http ://www.regular-expressions.info/](http://www.regular-expressions.info/)

为了找到“任何东西都可以在这里”，您应该使用正则表达式。这就是他们的目的。一个正则表达式可能看起来像这个问题的答案：

[如何将引号分隔的字符串与正则表达式匹配？](https://stackoverflow.com/questions/375104/how-can-i-match-a-quote-delimited-string-with-a-regex)

那么你会像这样使用函数[preg_replace()](http://php.net/manual/en/function.preg-replace.php)：

```
$return_value = preg_replace('/"[^"]+"/', 'replacement text', $str) 
```

* * *

无论如何都要把它留在这里：

只需用反斜杠转义内容：

```
$rstr = str_replace("Console", "Console.WriteLine(\"$variable\");", $str) 
```

如果您在字符串中使用变量，这将非常有用。如果只是直接替换文本，请使用单引号：

```
$rstr = str_replace("Console", 'Console.WriteLine("Words");', $str) 
```

单引号将除单引号之外的所有内容都视为一个字符。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-07T23:17:52.193

这是我的解决方案。用 ( " ) 符号分解整个字符串，然后对它们中的每一秒运行一个特定的代码。这段代码会自动对 " 项目之后的每一秒值执行它，这意味着，如果你这样做：hej " lol ; 它会改变到 : `hi <sr>" lol "</sr>`; 或者如果你这样做 : hi "with " you ; 它会变成 : `hi <sr>" with "</sr> you`; 等等。

```
function wrapInside($text,$symbol)
    {
        $string = explode($symbol, $text);
        $i = 1;
        $QS = '';
        foreach( $queryString as $V )
        {
            ( $i == 1 ) ? ( $QS .= $V ) : ( $QS .= '<sr>"'.trim($V).'"</sr>' );
            ( $i == 1 ) ? ( $i = 0 ) : ( $i = 1 );
        }
        $queryString = trim($QS);
        return $queryString;
    } 
```

# sharepoint - SharePoint Online（Office 365 云）是否支持内联代码块？SharePoint Designer 代码视图？

> ID：10046784
> 
> 赞同：1
> 
> 时间：2012-04-06T17:15:40.477
> 
> 标签：sharepoint, cloud, office365

我们能否将 .NET 代码块添加到 SharePoint 365（SharePoint 的云版本）中的页面？如果是这样，我们如何在 web.config 中允许代码块？

我们能否使用 SharePoint 设计器自定义表单并使用外部数据源创建数据视图？

我们可以有 asp.net 代码隐藏文件和类引用吗？（我怀疑不是）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-08T09:22:05.397

Office 365 不支持 .NET 代码块（服务器端脚本）。您应该完全从包含代码的控件和 Web 部件构建 ASPX 页面。SharePoint Online 的解决方案与 SharePoint 2010 的沙盒解决方案共享它们的限制[。](http://msdn.microsoft.com/en-us/library/ff798382.aspx)[解决](http://msdn.microsoft.com/en-us/library/gg615454.aspx)方案范围是*网站集*；不是 Web 应用程序，因此您无法访问 web.config。但是，您可能不需要；您只绑定到单个网站集，并且支持最常见的任务 - 添加 SafeControls，尽管 SharePoint 引擎不使用 web.config 来维护它们。[您可以查看部署 Web 部件](http://msdn.microsoft.com/en-us/library/ff798301.aspx)的示例。

 *您可以使用 Designer 自定义页面、表单和视图。外部数据源（实体类型） - BCS - 已于去年年底[添加到 SharePoint Online 。](http://msdn.microsoft.com/en-us/library/hh418045.aspx)我还没有检查支持哪些连接器类型；我认为至少是 SQL 和 WS 源。

您不能在 ASPX 页面中使用代码隐藏。没有可用的页面和用户控件的 ASP.NET 编译；这就是为什么您必须只编写编码控件和 Web 部件的页面。但是，有一个技巧可以规避这一点 -[可视 Web 部件](http://msdn.microsoft.com/en-us/hh181495)。原始可视 Web 部件无法在沙盒解决方案中使用，因为它依赖于 ASP.NET 编译。[Visual Studio 2010 SharePoint Power Tools](http://visualstudiogallery.msdn.microsoft.com/8e602a8c-6714-4549-9e95-f3700344b0d9)中提供了一个模板，该模板将预编译的代码打包到解决方案中，并且对沙盒很友好。

在将沙盒解决方案部署到 SharePoint Online 之前，您可以在本地 SharePoint 2010 上开发和测试您的沙盒解决方案。虽然我很惊讶将解决方案部署到 SharePoint Online 比部署到我的本地农场要快 :-) MSVS 使开发非常舒适。

--- 费尔达

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T05:27:08.110

This question relates to how to implement what Mr Prantl suggested.

[Where to write C# code for office365 sharepoint site](https://stackoverflow.com/questions/6570612/where-to-write-c-sharp-code-for-office365-sharepoint-site/11734026#11734026)

Hope this helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T18:06:49.100

不是 .NET 开发人员，这是我有限的知识。Office 365 是 SharePoint 的多租户实现，您应该具有以下功能：

*   将代码块作为沙盒解决方案上传
*   使用 SharePoint Designer 自定义表单和数据视图的能力

请注意，Office 365 提供 30 天试用版，可让您试驾它。如果您需要更多详细信息，请告诉我，因为在开始试用时需要注意一些注意事项。*

# ruby-on-rails - 如何查询今天创建的所有记录（午夜 UTC..Now）

> ID：10046788
> 
> 赞同：6
> 
> 时间：2012-04-06T17:15:58.433
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试创建一个 created_at 查询范围，它将捕获从午夜 UTC（db 默认）到现在创建的所有记录。在过去，我能够通过以下方式查询时间范围：

```
created_at => (24.hours.ago..Time.now) 
```

但是针对新用例调整上述内容不起作用：

```
created_at => (Date.today..Time.now) 
```

关于如何将 created_at 范围更新为今天/不是过去 24 小时内的所有记录的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-06T17:22:18.487

```
created_at => (DateTime.now.at_beginning_of_day.utc..Time.now.utc) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-19T06:15:55.050

我认为应该考虑时区。

`where(:created_at => Time.zone.now.beginning_of_day.utc..Time.zone.now.end_of_day.utc)`

而且Rails会自动将时间改为utc时间，所以下面的也可以。

`where(:created_at => Time.now.beginning_of_day..Time.now.end_of_day)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T13:10:02.353

我想，你也可以试试下面的线。

```
ModelName.all :condition => ["DATE(created_at) = DATE(?)", Time.now] 
```

或在 Rails 3 中

```
Model.where "DATE(created_at) = DATE(?)", Time.now 
```

干杯!

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-14T09:08:32.027

从 Rails5.1 开始，`Date#all_day`引入了一个新方法，它返回`a range of a day`.

代替：

```
where(created_at: Date.today.beginning_of_day..Date.today.end_of_day) 
```

一种优雅的方式是：

```
where(created_at: Date.today.all_day) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T17:21:20.397

```
Date.today.beginning_of_day.utc..Date.today.end_of_day.utc 
```

# ruby-on-rails - 如何使用带有主干的苗条模板？

> ID：10046798
> 
> 赞同：5
> 
> 时间：2012-04-06T17:16:51.847
> 
> 标签：ruby-on-rails, backbone.js, slim-lang

如何使用带有主干的苗条模板？

我在使用生态模板的 ruby​​-on-rails 应用程序骨干轨上使用 gem。但在我的项目中，我使用了超薄模板引擎，当然我只想使用一种模板类型。但是我怎样才能在主干中切换到苗条呢？

来自 codebrew 的 Gem 主干轨提供 erb 和 haml，所以我想我也可以使用 slim。但是怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-15T23:09:11.303

带有 Slim 和 CoffeeScript 的无脂肪客户端模板： [https ://github.com/jfirebaugh/skim](https://github.com/jfirebaugh/skim)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-06T21:31:11.990

我认为您混淆了客户端模板和服务器端模板之间的区别。Slim、HAML 端 ERB 是 Ruby 服务器端模板库。

Eco 是一个 node.js 服务器端模板库。模板可以通过 Eco 编译成客户端模板，但它依赖于 node.js 来编译服务器上的模板。

重要的是要了解，当您创建服务器端模板时，呈现的结果通常以 HTML 形式在浏览器中结束，模板本身永远不会在浏览器中结束。使用客户端模板，模板本身存在于浏览器中，模板通过 JavaScript（在本例中为backbone.js）呈现以在页面上生成 HTML。

# eclipse - Eclipse“运行方式”的热键

> ID：10046806
> 
> 赞同：2
> 
> 时间：2012-04-06T17:17:42.870
> 
> 标签：eclipse

有没有人计划出一种在 Eclipse 中为“运行方式”创建热键的方法（用于运行/启动类/应用程序）？

它会让生活变得更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:38:19.267

不完全是“运行方式...”，但每个常用的运行配置都有一个热键。例如，在 Windows 中：

```
Run Ant Build            Shift+Alt+X Q
Run Eclipse Application  Shift+Alt+X E
Run JUnit Plug-in Test   Shift+Alt+X P
Run JUnit Test           Shift+Alt+X T
Run Java Applet          Shift+Alt+X A
Run Java Application     Shift+Alt+X J
Run Last Launched        Ctrl+F11
Run SWT Application      Shift+Alt+X S 
```

# python - WTForms：我似乎无法动态地给 QuerySelectField 一个默认值

> ID：10046808
> 
> 赞同：2
> 
> 时间：2012-04-06T17:17:51.797
> 
> 标签：python, sqlalchemy, flask, wtforms

我有一个看起来像这样的表格：

```
class AddProductForm(Form):
    title = TextField('Title')
    type = QuerySelectField('Type',
        query_factory=lambda: ProductType.query.order_by(ProductType.sequence).all())

    def __init__(self, formdata=None, obj=None, prefix='', **kwargs):
        try:
            product_type_id = ProductType.query.filter_by(name=obj['product_type']).one().product_type_id
            kwargs.setdefault('type', product_type_id)
        except NoResultFound:
            pass

        Form.__init__(self, formdata, obj, prefix, **kwargs) 
```

如您所见，我正在尝试将其设置为在加载表单时为 product_type 提供合理的默认值。但是，虽然这种代码用于设置标题作为示例，但它不适用于 QuerySelectField '类型'。有人知道我该如何解决这个问题吗？

假设这是不可能的，有人知道我如何动态地将表单元素添加到表单中吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-03-29T13:03:21.197

要在 WTForms 的 QuerySelectField 中定义默认值，您可以直接在字段定义中进行：

```
my_field = QuerySelectField(
    label=u"My Label",
    query_factory=lambda: Model.query(...),
    get_pk=lambda item: item.id,
    get_label=lambda item: item.name,
    allow_blank=True,
    default=lambda: Model.query.filter(...).one()) 
```

然而，它并不像看起来那么简单。考虑到这一点：

*   默认值必须是*可调用的*
*   此可调用对象必须返回模型的对象实例（不是它的 pk，而是整个对象）
*   只有在没有使用*obj*或*formdata*来初始化表单实例时才会使用它（在这两种情况下，默认值都被忽略）

在您的情况下，由于您正在使用初始化时手头没有的 obj 属性来初始化默认值，因此您可以改用工厂：

```
def add_product_form_factory(default_type_name):
    class AddProductForm(Form):
        title = TextField('Title')
        type = QuerySelectField('Type',
            query_factory=lambda: ProductType.query.order_by(ProductType.sequence).all(),
            default=ProductType.query.filter_by(name=default_type_name).one()
        )
    return AddProductForm 
```

在这里，您有一个根据参数组成表单的函数（在这种情况下，您不需要默认值是可调用的）：

```
AddProductForm = add_product_form_factory(default_type_name='foo')
form = AddProductForm() 
```

附言。表单工厂的好处是您可以在运行时动态处理表单、创建字段或设置选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-08T04:46:05.217

使用如下参数：

```
QuerySelectField(allow_blank=True, blank_text=u'-- please choose --', ...) 
```

可以添加默认选择选项

# sql - 无法从 powershell 正确调用 sqlcmd

> ID：10046809
> 
> 赞同：2
> 
> 时间：2012-04-06T17:18:10.913
> 
> 标签：sql, powershell, sqlcmd

我有这个 sqlcmd 片段批量工作，但是当我转换为 powershell 时，它坏了。这就是我试图使用 powershell 调用的内容

```
Sqlcmd -S localhost\instance -d database -U username -P password -i "sqlQuery.sql" -s "," > \sqlOutput.csv -I -W -k 
```

我尝试了invoke-sqlcmd，但出现错误“术语'invoke-sqlcmd'未被识别为cmdlet、函数、脚本文件或可运行程序的名称”

关于下面的评论，我已经加载了所需的管理单元。这确实有帮助，但我现在遇到了这个错误。“Invoke-sqlcmd：无法处理参数，因为参数名称 's' 不明确。

如果我把它放在单引号中......

```
invoke-Sqlcmd '-S localhost\instance -d database -U username -P password -i "sqlQuery.sql" -s "," > \sqlOutput.csv -I -W -k' 
```

我收到错误“在建立与 sql server 的连接时发生与网络相关或特定于实例的错误。这对我来说没有意义，因为我在这里使用的相同凭据（在同一个盒子上）在从批处理调用时工作.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-07T05:21:39.123

您必须首先从 powershell 或命令提示符调用 sqlps.exe（假设您安装了 Powershell 的 SQL Server 管理单元）。

一旦你这样做，执行`get-help Invoke-Sqlcmd`以找到你的方式。

对于您的问题，它不是-S，而是-ServerInstance

```
 PS SQLSERVER:\> Invoke-Sqlcmd -ServerInstance "srvrName" -Database "master" -Username "user123" -Password "x$34fth" 
-InputFile "C:\Users\testUser\Desktop\test.sql" | Out-File "C:\Users\testUser\Desktop\out.txt" 
```

您还可以使用[MSDN](http://msdn.microsoft.com/en-us/library/cc281962%28v=sql.105%29.aspx)文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T18:22:18.817

去

*   Windows 资源管理器 
*   右击电脑
*   属性
*   高级系统设置 
*   环境变量

确保使用以下字符串设置 PSModulePath。

`C:\Program Files (x86)\Microsoft SQL Server\110\Tools\PowerShell\Modules`

# asp.net-mvc-3 - MVC3 Url.Abs 返回 Azure 的域，而不是域注册商的 CNAME 记录

> ID：10046815
> 
> 赞同：0
> 
> 时间：2012-04-06T17:18:23.340
> 
> 标签：asp.net-mvc-3, azure

我在 http://[some GUID].cloudapp.net 有一个 Windows Azure 应用程序。

我在 GoDaddy 使用 CNAME 记录将 mydomain.com 指向此应用程序。一切正常，但只有一件事。我从这个应用程序发送电子邮件并使用嵌入到该站点的链接

```
@Url.Abs(Url.Action("Action", "Controller")) 
```

Url.Abs 总是预先添加 http://[some GUID].cloudapp.net 域，而不是 mydomain.com。我还没有发现这个帮助程序的重载可以让我将我的域名从 web.config 或类似的东西中提取出来。如何告诉 MVC3 使用 mydomain.com？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T19:25:39.283

我很困惑，因为我看不出该应用程序怎么可能知道 .cloudapp.net 域。CNAME 不能以这种方式工作……该应用只会看到“mydomain.com”。

您确定您的 CNAME 设置正确，而不仅仅是转发或“屏蔽”之类的吗？

# c++ - FOO.tab.cpp 文件位于较大项目的 FOO 文件夹中。*.tab.cpp 有特殊意义吗？

> ID：10046829
> 
> 赞同：0
> 
> 时间：2012-04-06T17:19:11.103
> 
> 标签：c++

这可能很难回答。我试图了解一些代码库，并且在名为 FOO 的项目文件夹之一中有一个 main.cpp 文件以及其他 .hpp 和 .cpp 文件。这些文件名使用下划线进行描述，例如 Hi_there_file.cpp 等。

有两个文件 Foo.tab.hpp 和 Foo.tab.cpp 是 *.tab.cpp 表示某些东西还是只是尝试使文件名具有描述性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:28:32.633

原来，该文件是由 perl 脚本生成的，因此他们将 tab.cpp 放在最后。甚至可能删除这个问题。非常具体到我正在使用的东西

# asp.net - 从用户控件访问父页面上的 Radgrid 项目

> ID：10046830
> 
> 赞同：0
> 
> 时间：2012-04-06T17:19:11.210
> 
> 标签：asp.net, user-controls, telerik, radgrid

我有几个共享用户控件的页面。当用户单击用户控件上的保存按钮时，我需要能够在父页面上循环 Radgrid 的项目并获取所选项目。radgrid 有一个复选框列。我可以看到我正在从网格单元格中获取值，但由于某种原因，复选框上的选中值始终为 false，即使选中它也是如此。当从父页面本身而不是从用户控件调用时，相同的 foreach 代码可以工作。

这是一个代码片段。

```
RadGrid ProjectGrid = (RadGrid) this.Parent.FindControl("ProjectGrid");

        foreach (GridDataItem item in ProjectGrid.MasterTableView.Items)
        {
            string applicationPackageId = item.Cells[4].Text.ToString();

            CheckBox chbx = item.FindControl("ProjectGridCheckBox") as CheckBox;

            if (chbx != null && chbx.Checked)
            {
                numCheckedPackages++;
            }
        } 
```

这是我的网格。

```
<telerik:RadGrid ID="ProjectGrid" runat="server" Skin="WF" ShowHeader="true" EnableEmbeddedSkins="false" AllowSorting="false" AllowFilteringByColumn="false" AllowMultiRowSelection="true">
    <MasterTableView Width="100%" CommandItemDisplay="None" AutoGenerateColumns="false" TableLayout="Fixed">
        <RowIndicatorColumn Visible="False">
            <HeaderStyle Width="20px" />
        </RowIndicatorColumn>
        <ExpandCollapseColumn Resizable="False" Visible="False">
            <HeaderStyle Width="20px" />
        </ExpandCollapseColumn>
        <Columns>
            <telerik:GridTemplateColumn UniqueName="SelectColumn" DataField="Id" HeaderStyle-Width="5%" >  
                <ItemTemplate>  
                    <asp:CheckBox ID="ProjectGridCheckBox"   runat="server"/>  
                </ItemTemplate>
            </telerik:GridTemplateColumn>
            <telerik:GridBoundColumn DataField="Package.ProjectPackageNumberNameDisplayField" HeaderText="Project - Package" UniqueName="ProjectPackages"  HeaderStyle-Width="85%"></telerik:GridBoundColumn>
            <telerik:GridBoundColumn DataField="ApplicationPackageID" HeaderText="Id" HeaderStyle-Width="15%" UniqueName="PackageId"></telerik:GridBoundColumn>                                    
        </Columns>
    </MasterTableView>
    <ClientSettings EnableRowHoverStyle="true">
        <Selecting AllowRowSelect="True" />
    </ClientSettings>
    <HeaderStyle BackColor="#666666" Font-Names="verdana, arial" Font-Size="Small" Height="20px" />
</telerik:RadGrid> 
```

# php - preg_replace() [function.preg-replace]：分隔符不能是字母数字或反斜杠

> ID：10046835
> 
> 赞同：0
> 
> 时间：2012-04-06T17:19:42.890
> 
> 标签：php, preg-replace, expression

我想将字符串变量中的每个 "../" 和 "script/uploaded" 替换为 "" ！

我有一个这样的功能：

```
public function mypregReplace($v) 
{                          
    return preg_replace(
        array("%script/uploaded%"  , ""),
        array( "[\.\./]"  ,  ""),
        $v); 
} 
```

但它向我展示了这个错误

> preg_replace() [function.preg-replace]：分隔符不能是字母数字或反斜杠

我的图案有什么问题？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:23:05.800

您的格式错误，您不需要 preg_replace 。采用`str_replace`

```
public function mypregReplace($v) 
{                          
   return str_replace(
    array("script/uploaded"  , "../"),
    '',
    $v); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:22:45.753

你的数组错了。第一个数组应该只包含模式，第二个应该是替换值。你要：

```
public function mypregReplace($v) 
{                          
    return preg_replace(
        array("%script/uploaded%", "%\.\./%"),
        array("",  ""),
        $v); 
} 
```

可以进一步简化为：

```
public function mypregReplace($v) 
{                          
    return preg_replace(
        array('%script/uploaded%', '%\.\./%'),
        '',
        $v); 
} 
```

但是，您应该为此使用[str_replace 。](http://php.net/manual/en/function.str-replace.php)您不需要正则表达式来匹配确切的字符串：

```
public function mypregReplace($v) 
{                          
    return str_replace(array('script/uploaded', '../'), '', $v); 
} 
```

# android - 动画（移动）ImageView 以一种方式工作，但不能以另一种方式工作

> ID：10046838
> 
> 赞同：1
> 
> 时间：2012-04-06T17:19:44.720
> 
> 标签：android

我使用sdk创建了一个“添加”按钮，所以当我按下那个“添加”按钮时我希望它向左移动，当我再次按下时回到原来的位置。我遇到的问题是按钮在按下时只能向左移动，并且在我尝试再次按下后无法回到原来的位置。我的 if...else 函数有问题吗？任何帮助将不胜感激。

```
public class TestImage2 extends Activity {
/** Called when the activity is first created. */

ImageView image_plus;
ImageView image_subtract;
ImageView image_multiply;
ImageView image_div;

String op;

boolean pergi = false;
final  Animation animation = new TranslateAnimation(0,100,0,0);
final  Animation animation2 = new TranslateAnimation(100,0,0,0);

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    image_plus     = (ImageView)findViewById(R.id.test_image);     
    image_subtract = (ImageView)findViewById(R.id.test_image2);
    image_multiply = (ImageView)findViewById(R.id.test_image3);
    image_div      = (ImageView)findViewById(R.id.test_image4);

    image_plus.setOnClickListener(new OnClickListener(){

        public void onClick(View view) {

                if(pergi == false)
                {

                        animation.setDuration(1000);
                        image_plus.startAnimation(animation);
                        pergi= true;

                        animation.setFillAfter(true); 
                }
                else
                {

                        animation2.setDuration(1000);
                        image_plus.startAnimation(animation2);
                        pergi = false;
                        animation2.setFillAfter(true); 
                }
                }}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:54:40.703

我认为有什么问题

```
final  Animation animation2 = new TranslateAnimation(100,0,0,0); 
```

它应该是

```
final  Animation animation2 = new TranslateAnimation(0,-100,0,0); 
```

:)

# iphone - if/else 语句中的问题 iPhone

> ID：10046843
> 
> 赞同：1
> 
> 时间：2012-04-06T17:20:11.330
> 
> 标签：iphone, objective-c, ios

我正在使用下面的代码，但我不明白为什么它不能正常工作，我认为我的逻辑不正确。

请看一下并建议我解决方案。

```
- (IBAction)fajarButton:(id)sender {

    name = @"f";

    NSLog(@"Selected namaz is Fajar");

    [a1 setAlpha:0]; [a2 setAlpha:0]; [a3 setAlpha:0]; [a4 setAlpha:0]; [a5 setAlpha:0];

    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init]; 
    [dateFormatter setTimeZone:[NSTimeZone localTimeZone]]; 
    [dateFormatter setDateFormat:@"EEEE"]; 
    NSString *day = [dateFormatter stringFromDate:[NSDate date]]; 

    NSLog(@"day::: %@", day);

    if ([day isEqualToString:@"Monday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
    if ([day isEqualToString:@"Tuesday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
    if ([day isEqualToString:@"Wednesday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
    if ([day isEqualToString:@"Thursday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
    if ([day isEqualToString:@"Friday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
    if ([day isEqualToString:@"Saturday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
    if ([day isEqualToString:@"Sunday"]) {

        [fajarButton setUserInteractionEnabled:NO];

    }
} 
```

我在这里要做的是，比如说，如果今天是星期一并且这个按钮单击了一次，那么在星期一的这一天应该禁用它，这样用户就不会再次单击它，或者每当用户单击它时，都会出现一个警报你已经这样做了。当周二新的一天到来并启动应用程序时，新的一天又开始了，按钮将被启用，用户将能够单击它一次。

如何实现这一切....我有很多问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:22:05.287

看起来你的 friArray 是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T08:46:20.907

如果 friArray 为空，则不会调用 else，因为 for 循环不会迭代。在 for 循环之前检查空的 friArray

```
if ([friArray count] ==0) {
    //do what you do when it's empty
}
else {
    //do your for loop
} 
```

# php - 针对这种情况的 UI 设计挑战

> ID：10046846
> 
> 赞同：1
> 
> 时间：2012-04-06T17:20:37.723
> 
> 标签：php, javascript, user-interface

**截图样机：** [http ://tinypic.com/r/y2qex/5](http://tinypic.com/r/y2qex/5)

**问题：**我有一个有 53 列的表；一年中的每周一个，加上一个带有用户名的。它将有 10 到 80 行，具体取决于每个区域的用户数量。

用户需要为每周设置一个“标志”，例如年假、培训等。

我目前有一个表格，每个单元格中都有一个选择框。问题是这适用于 5 行，但是一旦我开始获得 20 多行，浏览器就不会打开页面，因为选择框太多了。

无论选择什么新选择都必须能够被查询，所以我可以将它们保存在我的数据库中。

我所追求的是一些关于如何更好地解决这个问题的通用想法（即不是特定代码）。一旦我有了一个好主意，我就会着手制定确切的编码。

到目前为止我的想法： - 使所有单元格仅成为文本，使用当前选择，然后在每个用户旁边有一个“编辑”选项，它将他们的行作为一个可以编辑的模式窗口打开 - 使所有单元格都有一个“onClick”事件，导致在点击点生成一个下拉列表

但我很想听听其他人如何处理/解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:27:13.210

您可能想看看使用日历功能，我敢肯定那里有大量的 Javascript 日历。我最近使用 DataTables 也取得了很大的成功。您可以使用 DataTables + jEditable 创建单击以编辑表表示，单击时会为您提供一个选择框，否则仅显示文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:30:38.743

如果许多选择框的选项相同，您可以考虑为所有选择框使用一个数据列表，这会更高效，我猜您每页可以有更多。不幸的是，这是一个 HTML 5 功能，因此它不会向后兼容所有浏览器。

[http://www.w3schools.com/html5/tag_datalist.asp](http://www.w3schools.com/html5/tag_datalist.asp)

除此之外，如果表格超过一定数量的列，您可以考虑对表格进行分页。或者像 tumbr 一样做，如果它们向右滚动得足够远，更多的列会通过 ajax 加载。你的想法也应该有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:44:33.957

也许您可以在页面上有一个隐藏的选择框，并在单击时将其显示在单元格上，并通过将数据属性写入单元格来处理单击结果，也许还可以同时执行 XHR？

你也可以只拥有一堆隐藏的表单元素，但这太恶心了。

在实现方面，您可以使用附加到表的单个事件处理程序来完成，每个单元格都有代表名称和星期的数据属性。

无论如何，这应该是高性能的，即使它需要额外的 20 行左右的 js。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T18:48:26.403

也许这样的事情对你有用：

```
var td=document.getElementsByTagName('td');
for(var i=0; i<td.length; i++)
{
    td[i].id='cellID_'+i; 
    td[i].onclick=function()
    {
        //make menu appear on this element id
    }
} 
```

# c# - 在 ObservableCollection 上使用 LINQ 与 GroupBy 和 Sum 聚合

> ID：10046851
> 
> 赞同：3
> 
> 时间：2012-04-06T17:21:07.097
> 
> 标签：c#, linq, group-by, sum, observablecollection

我有以下代码块可以正常工作；

```
var boughtItemsToday = (from DBControl.MoneySpent
            bought in BoughtItemDB.BoughtItems
            select bought);

BoughtItems = new ObservableCollection<DBControl.MoneySpent>(boughtItemsToday); 
```

它从我的 MoneySpent 表中返回数据，其中包括 ItemCategory、ItemAmount、ItemDateTime。

我想将其更改为按 ItemCategory 和 ItemAmount 分组，这样我就可以看到我大部分钱都花在了哪里，所以我创建了一个 GroupBy 查询，最后得到了这个；

```
var finalQuery = boughtItemsToday.AsQueryable().GroupBy(category => category.ItemCategory); 

BoughtItems = new ObservableCollection<DBControl.MoneySpent>(finalQuery); 
```

这给了我2个错误；

错误 1 ​​'System.Collections.ObjectModel.ObservableCollection.ObservableCollection(System.Collections.Generic.List)' 的最佳重载方法匹配有一些无效参数

错误 2 参数 1：无法从 'System.Linq.IQueryable>' 转换为 'System.Collections.Generic.List'

这就是我卡住的地方！如何使用 GroupBy 和 Sum 聚合函数在 1 个 LINQ 查询中获取我的类别和相关支出的列表？！

感激地收到任何帮助/建议。

标记

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:29:52.963

`.GroupBy(category => category.ItemCategory);`返回 IGrouping 对象的可枚举，其中每个 IGrouping 的键是一个不同的 ItemCategory 值，该值是 MoneySpent 对象的列表。因此，您将无法像当前所做的那样简单地将这些分组放入 ObservableCollection 中。

相反，您可能希望将每个分组结果选择到一个新的 MoneySpent 对象中：

```
var finalQuery = boughtItemsToday
    .GroupBy(category => category.ItemCategory)
    .Select(grouping => new MoneySpent { ItemCategory = grouping.Key, ItemAmount = grouping.Sum(moneySpent => moneySpent.ItemAmount);

BoughtItems = new ObservableCollection<DBControl.MoneySpent>(finalQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:25:12.600

您可以将每个组投影到具有所需属性的任何匿名（或更好地为此创建新类型）类：

```
var finalQuery = boughtItemsToday.GroupBy(category => category.ItemCategory);
                                 .Select(g => new 
                                  { 
                                     ItemCategory = g.Key, 
                                     Cost = g.Sum(x => x.ItemAmount)
                                  }); 
```

`AsQueryable()`根本不需要，因为无论如何都是`boughtItemsToday`。`IQuerable`您也可以只组合查询：

```
var finalQuery = BoughtItemDB.BoughtItems
                             .GroupBy(item => item.ItemCategory);
                             .Select(g => new 
                              { 
                                  ItemCategory = g.Key, 
                                  Cost = g.Sum(x => x.ItemAmount)
                              }); 
```

# c# - 如何在枚举中维护枚举列表

> ID：10046852
> 
> 赞同：1
> 
> 时间：2012-04-06T17:21:14.870
> 
> 标签：c#, .net, enums

> **可能重复：**
> [枚举标志属性](https://stackoverflow.com/questions/8447/enum-flags-attribute)

我在 Windows 窗体中看到，当您使用包含 Anchor 的控件时，您可以同时设置多个枚举。

我试图这样做，但我还没有完成：

```
enum Foo
{
    A,
    B,
    C
}

Foo foo = A | B;   // here just receive the last one 
```

有可能这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:23:49.113

使用[标志属性](http://msdn.microsoft.com/en-us/library/system.flagsattribute.aspx)。

标志：

```
[Flags]
enum Days2
{
    None = 0x0,
    Sunday = 0x1,
    Monday = 0x2,
    Tuesday = 0x4,
    Wednesday = 0x8,
    Thursday = 0x10,
    Friday = 0x20,
    Saturday = 0x40
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:24:53.553

是的，这是标志属性。

```
[Flags]
enum Foo 
{ 
  A = 1, 
  B = 2, 
  C = 4 
}

var foo = Foo.A | Foo.B; 
```

此处的更多信息：[[Flags] 枚举属性在 C# 中的含义是什么？](https://stackoverflow.com/questions/8447/enum-flags-attribute)

# asp.net - 父元素标签内的服务器控件渲染上的 CustomValidator

> ID：10046857
> 
> 赞同：0
> 
> 时间：2012-04-06T17:21:23.013
> 
> 标签：asp.net, telerik

我有一个`RadEditor`，我正在尝试添加一个`CustomValidator`，如下所示：

```
protected override void OnInit(EventArgs e)
{
    var validator = new CustomValidator();
    validator.CssClass = "validator-error";
    validator.Display = ValidatorDisplay.Dynamic;
    validator.ControlToValidate = ".";
    validator.Text = "You've exceeded the maximum allowed length for this field";
    validator.ClientValidationFunction = "radEditorCheckLength";

    this.Controls.Add(validator);

    base.OnInit(e);
} 
```

效果很好，但是当它呈现时，验证器实际上是*在*`RadEditor`. 如何让它出现在`RadEditor`元素之前？

![在此处输入图像描述](../Images/5f8d8636d25a7c85f1a5e2db1e4b9ce6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T18:07:40.017

这是一个彻头彻尾的黑客攻击。它有效吗？

```
protected override void Render(HtmlTextWriter writer)
{
    this.validator.RenderControl(writer);
    this.validator.Visible = false;
    base.Render(writer);
    this.validator.Visible = true;
} 
```

您需要将您的存储`CustomValidator`在一个字段中：

```
private CustomValidator validator;

protected override void OnInit(EventArgs e)
{
    this.validator = new CustomValidator();
    // ...
} 
```

（我`RadEditor`在 Reflector 中进行了反汇编，但我没有看到一种简单的修改方法`RenderChildren`来跳过渲染验证器。）

# c++ - 执行一个函数来影响不同的模板类实例

> ID：10046860
> 
> 赞同：1
> 
> 时间：2012-04-06T17:21:24.477
> 
> 标签：c++, class, templates, inheritance, polymorphism

我有一个复杂的问题，我需要帮助。

我有一个基本案例，

```
class ParamBase
{
    string paramValue;
    //...
} 
```

以及一堆具有不同模板参数的类模板。

```
template <typename T>
class Param : public ParamBase
{
   T value;
   //...
} 
```

现在，每个 Param 实例都有不同的模板参数，double、int、string...等。

为了更容易，我有一个指向它们的基类指针的向量，其中包含所有已创建的实例：

```
vector<ParamBase*> allParamsObjects; 
```

问题是：

如何运行单个函数（全局或成员或任何东西，您的选择），将所有这些不同实例的字符串 paramValue 转换为不同的模板参数，并将转换结果保存到 Param::value 中的适当类型。这必须在保存在向量 allParamsObjects 中的所有对象上运行。

因此，如果第一个 Param 的模板参数是 double，则 paramValue 必须转换为 double 并保存在 value 中；如果第二个 Param 的参数是 int，那么第二个的 paramValue 必须转换为 int 并保存在 value 中……等等。

任何帮助将不胜感激:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:24:24.020

像这样的东西？

```
class ParamBase {
    std::string paramValue;
public:
    virtual void convert() = 0;
};

template <typename T>
class Param : public ParamBase
{
    T value;
public:
    virtual void convert() {
        std::stringstream ss(paramValue);
        ss >> value;
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:26:00.057

在 中声明一个抽象方法，`Convert`在`ParamBase`每个模板派生类中实现它以将字符串转换为值，然后在循环中调用该方法。

# ruby-on-rails - MongoDB中的动态字段问题

> ID：10046864
> 
> 赞同：1
> 
> 时间：2012-04-06T17:21:53.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongoid

我在我的 Rails 应用程序中使用 mongodb。

假设我有一个如下的 mongo 模型

```
class Product
 include Mongoid::Document
   field :test, type: String
   field :link, type: String
end 
```

然后它工作正常

但是当我通过在 lib 中生成它们来动态添加这些字段时，或者例如在我的控制器中如下所示

```
params[:product][:test]="Test Value"
params[:product][:link]="Test Link" 
```

然后我得到如下错误 Mongoid Error(Screenshot attach) [Error ScreenShot](http://i.stack.imgur.com/pEisx.png)

请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:46:47.013

有一些私有方法`test`。在我的项目中：

```
> Account.new.test
NoMethodError: private method `test' called for #<Account:0x007f89e60afd30>

> Account.new.send :test
ArgumentError: wrong number of arguments (0 for 2..3) 
```

# android - Android SQLite 数据库设置错误？

> ID：10046879
> 
> 赞同：1
> 
> 时间：2012-04-06T17:22:53.530
> 
> 标签：android, database, android-logcat

我已经建立了一个 SQLite 数据库。似乎当我运行一个需要访问它的类时，应用程序崩溃了。最初有人向我指出，表创建语句是问题所在，但在解决了该错误之后，它仍然无法正常工作。数据库设置是： -

```
public class DataBaseHelper
{
    public static final String KEY_ROWID = "_id";
    public static final String KEY_CODE = "code";
    public static final String KEY_DAYS = "days";
    public static final String KEY_BMI = "bmi"; 
    public static final String KEY_ROWID2 = "id2";
    public static final String KEY_DATE = "date";
    public static final String KEY_STEPS = "steps";
    public static final String KEY_CALs = "calories";
    private static final String TAG = "DBAdapter";

    private static final String DATABASE_NAME = "workout";
    private static final String DATABASE_TABLE = "goals";
    private static final String DATATABLE = "acts";

    private static final int DATABASE_VERSION = 1;

    private static final String DATABASE_CREATE =
        "create table goals (_id integer primary key autoincrement, "
        + "code text not null, days text not null, " 
        + "bmi text not null);";
    private static final String DATABASE_CREATE2 =
        "create table acts (id2 integer primary key autoincrement, "
                + "date text not null, steps text not null, " 
                + "calories text not null);";

    private final Context context; 

    private DatabaseHelper DBHelper;
    private SQLiteDatabase db;

    public DataBaseHelper(Context ctx) 
    {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }

    private static class DatabaseHelper extends SQLiteOpenHelper 
    {
        DatabaseHelper(Context context) 
        {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }
        @Override
        public void onCreate(SQLiteDatabase db) 
        {
            db.execSQL(DATABASE_CREATE);
            db.execSQL(DATABASE_CREATE2);
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, 
        int newVersion) 
        {
            Log.w(TAG, "Upgrading database from version " + oldVersion 
                + " to "
                + newVersion + ", which will destroy all old data");
            db.execSQL("DROP TABLE IF EXISTS titles");
            onCreate(db);
        }
    }    

//---opens the database---
    public DataBaseHelper open() throws SQLException 
    {
        db = DBHelper.getWritableDatabase();
        return this;
    }

//---closes the database---    
    public void close() 
    {
        DBHelper.close();
    }

//---insert a title into the database---
    public long insertTitle(String isbn, String title, String publisher) 
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_CODE, isbn);
        initialValues.put(KEY_DAYS, title);
        initialValues.put(KEY_BMI, publisher);
        return db.insert(DATABASE_TABLE, null, initialValues);
    }
    public long insertActivity(String date, String steps, String Calories) 
    {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_DATE, date);
        initialValues.put(KEY_STEPS, steps);
        initialValues.put(KEY_CALs, Calories);
        return db.insert(DATATABLE, null, initialValues);
    }

//---deletes a particular title---
    public boolean deleteTitle(long rowId) 
    {
        return db.delete(DATABASE_TABLE, KEY_ROWID + 
            "=" + rowId, null) > 0;
    }
    public void deleteFirst()
    {
        Cursor cursor = db.query(DATABASE_TABLE, null, null, null, null, null, null); 

        if(cursor.moveToFirst()) {
            long rowId = cursor.getLong(cursor.getColumnIndex(KEY_ROWID)); 

            db.delete(DATABASE_TABLE, KEY_ROWID +  "=" + rowId, null);
        }
     }

    public boolean deleteAct(long rowId) 
    {
        return db.delete(DATATABLE, KEY_ROWID + 
            "=" + rowId, null) > 0;
    }
//---retrieves all the titles---
    public Cursor getAllTitles() 
    {
        return db.query(DATABASE_TABLE, new String[] {
            KEY_ROWID, 
            KEY_CODE,
            KEY_DAYS,
            KEY_BMI}, 
            null, 
            null, 
            null, 
            null, 
            null);
}
public Cursor getAllActs() 
{
    return db.query(DATATABLE, new String[] {
            KEY_ROWID2, 
            KEY_DATE,
            KEY_STEPS,
            KEY_CALs}, 
            null, 
            null, 
            null, 
            null, 
            null);
}

//---retrieves a particular title---
public Cursor getTitle(long rowId) throws SQLException 
{
    Cursor mCursor =
            db.query(true, DATABASE_TABLE, new String[] {
                    KEY_ROWID,
                    KEY_CODE, 
                    KEY_DAYS,
                    KEY_BMI
                    }, 
                    KEY_ROWID + "=" + rowId, 
                    null,
                    null, 
                    null, 
                    null, 
                    null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
}
public Cursor getAct(long rowId) throws SQLException 
{
    Cursor mCursor =
            db.query(true, DATATABLE, new String[] {
                    KEY_ROWID2,
                    KEY_DATE, 
                    KEY_STEPS,
                    KEY_CALs
                    }, 
                    KEY_ROWID2 + "=" + rowId, 
                    null,
                    null, 
                    null, 
                    null, 
                    null);
    if (mCursor != null) {
        mCursor.moveToFirst();
    }
    return mCursor;
}
public boolean updateAct(long rowId, String date, 
        String steps, String cals) 
        {
            ContentValues args = new ContentValues();
            args.put(KEY_DATE, date);
            args.put(KEY_STEPS, steps);
            args.put(KEY_CALs, cals);
            return db.update(DATATABLE, args, 
                             KEY_ROWID2 + "=" + rowId, null) > 0;
        }

//---updates a title---
   public boolean updateTitle(long rowId, String isbn, 
   String title, String publisher) 
   {
       ContentValues args = new ContentValues();
       args.put(KEY_CODE, isbn);
       args.put(KEY_DAYS, title);
       args.put(KEY_BMI, publisher);
       return db.update(DATABASE_TABLE, args, 
                     KEY_ROWID + "=" + rowId, null) > 0;
   } 
} 
```

日志猫是：

```
04-06 17:20:14.561: E/AndroidRuntime(24550): FATAL EXCEPTION: main
04-06 17:20:14.561: E/AndroidRuntime(24550): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.b00348312.workout/com.b00348312.workout.WorkoutProgress}: android.database.sqlite.SQLiteException: no such column: bmi: , while compiling: SELECT _id, code, days, bmi FROM goals
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2787)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2803)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.app.ActivityThread.access$2300(ActivityThread.java:135)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2136)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.os.Looper.loop(Looper.java:144)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.app.ActivityThread.main(ActivityThread.java:4937)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at java.lang.reflect.Method.invokeNative(Native Method)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at java.lang.reflect.Method.invoke(Method.java:521)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at dalvik.system.NativeStart.main(Native Method)
04-06 17:20:14.561: E/AndroidRuntime(24550): Caused by: android.database.sqlite.SQLiteException: no such column: bmi: , while compiling: SELECT _id, code, days, bmi FROM goals
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:91)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:64)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:80)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:46)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:53)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1412)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1296)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1251)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1331)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at com.b00348312.workout.DataBaseHelper.getAllTitles(DataBaseHelper.java:131)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at com.b00348312.workout.WorkoutProgress.fillData(WorkoutProgress.java:27)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at com.b00348312.workout.WorkoutProgress.onCreate(WorkoutProgress.java:22)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at   android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1069)
04-06 17:20:14.561: E/AndroidRuntime(24550):    at    android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2751)
04-06 17:20:14.561: E/AndroidRuntime(24550):    ... 11 more 
```

我的事情告诉我问题的陈述是：

```
 04-06 17:20:14.561: E/AndroidRuntime(24550): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.b00348312.workout/com.b00348312.workout.WorkoutProgress}: android.database.sqlite.SQLiteException: no such column: bmi: , while compiling: SELECT _id, code, days, bmi FROM goals 
```

但我不知道它指的是哪里，因为每次调用字段 bmi 似乎都没有问题。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:30:01.817

您正在尝试访问数据库中名为“bmi”的列，但它不存在。

您很可能在创建数据库后添加了该列，并且没有修改您的 openHelper 以正确升级您的数据库。

添加“bmi”字段，错误将得到解决。更改 Create 语句是不够的，因为数据库已经存在，因此不会运行 Create 语句。您应该覆盖“onUpgrade”以从一个数据库版本更改为另一个。

或者删除您当前的数据库并从头开始重新创建它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:33:40.023

您必须卸载然后重新安装您的应用程序，因为如果您不实施 onUpgrade，android 不会更改数据库。

或者转到设置和您的应用程序并清除您的应用程序的数据，然后运行您的应用程序。

# sql - 从数据集 SQL 创建趋势线

> ID：10046883
> 
> 赞同：6
> 
> 时间：2012-04-06T17:23:18.177
> 
> 标签：sql, visual-studio, math, linear-regression

下面的代码返回一定天数的一段时间（期间为 YYYY,WW）内已解决的工单数量和打开的工单数量。例如，如果 @NoOfDays 为 7：

> 解决了| 打开| 周 | 年份 | 时期
> 
> 56 | 30 | 13 | 2012 | 2012, 13
> 
> 237 | 222 | 14 | 2012 | 2012, 14

“已解决”和“已打开”在线 (y) 上绘制在周期 (x) 上。我想添加另一列“趋势”，它将返回一个数字，当绘制在一段时间内时，将是一条趋势线（简单线性回归）。*我**确实**想将两组值用作趋势的一个数据源。*

这是我的代码：

```
SELECT a.resolved, b.opened, a.weekClosed AS week, a.yearClosed AS year,
    CAST(a.yearClosed as varchar(5)) + ', ' + CAST(a.weekClosed as varchar(5)) AS period
FROM 
    (SELECT TOP (100) PERCENT COUNT(DISTINCT TicketNbr) AS resolved, { fn WEEK(date_closed) } AS weekClosed, { fn YEAR(date_closed) } AS yearClosed
    FROM v_rpt_Service
    WHERE (date_closed >= DateAdd(Day, DateDiff(Day, 0, GetDate()) - @NoOfDays, 0))
    GROUP BY { fn WEEK(date_closed) }, { fn YEAR(date_closed) }) AS a 
LEFT OUTER JOIN
    (SELECT TOP (100) PERCENT COUNT(DISTINCT TicketNbr) AS opened, { fn WEEK(date_entered) } AS weekEntered, { fn YEAR(date_entered) 
    } AS yearEntered
    FROM v_rpt_Service AS v_rpt_Service_1
    WHERE        (date_entered > = DateAdd(Day, DateDiff(Day, 0, GetDate()) - @NoOfDays, 0))
    GROUP BY { fn WEEK(date_entered) }, { fn YEAR(date_entered) }) AS b ON a.weekClosed = b.weekEntered AND a.yearClosed = b.yearEntered
ORDER BY year, week 
```

**编辑：**

根据serc.carleton.edu/files/mathyouneed/best_fit_line_dividing.pdf，看来我想把数据分成两半，然后计算平均值。然后我需要找到最佳拟合线，并使用斜率和 y 截距来计算返回“趋势”所需的值`y = mx + b`？

我知道这在 SQL 中是很有可能的，但是，我插入 SQL 的程序对我能做的有限制。

**红点和蓝点是我现在返回的数字（打开并解决）。为了创建紫色线，我需要为“趋势”中的每个时期返回一个值。（此图像是假设的）**

![假设图表](../Images/e95fa823420082a0fe57663bb8967aab.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T18:41:07.047

我对这个问题很感兴趣，并且我发现了解复杂查询的最佳方法是使用我自己的风格和约定重新格式化它。我将它们应用于您的解决方案，结果如下。我不知道这对你是否有任何价值......

*   有一些代码我不认为是 MS T-SQL 语法的一部分，例如`({fn xxx }`函数`WEEK(xxx)`。
*   此代码可以编译，但我无法运行它，因为我没有正确配置数据表。
*   我进行了许多编码更改，这些更改需要大量解释，我将跳过其中的大部分内容。如果您想解释任何内容，请添加评论。
*   我扔了很多空白。易读和难读的代码之间的区别往往只是旁观者的感知和感受，你可能会讨厌我的约定。
*   不确定最终结果集应该是什么（即返回哪些列）

一些进一步的说明：

*   如果该周内也没有关闭任何项目，则此查询将不会获取该周内输入的项目
*   周可能是部分的，例如，并非所有 7 天都存在（将 @Interval 调整为始终包括整周——但是奇数间隔呢？）
*   将 count(*) 值乘以 1.0 以提前将它们转换为浮点数（避免强制转换和整数数学截断）
*   允许将较早的公式替换为后来的公式中的符号（此时事情变得更加清晰易读）

所以这就是我想出的：

```
;WITH cte as (
select
   c.period
  ,resolved_half1
  ,resolved_half2
  ,opened_half1
  ,opened_half2
  ,row = row_number() over(order by c.yearClosed, c.weekClosed)
  ,y1 = ((SUM(resolved_half1) + SUM(opened_half1)) - (SUM(resolved_half2) + SUM(opened_half2))) / ((count(resolved_half1) + count(opened_half1)) / 2)
  ,y2 = ((SUM(resolved_half2) + SUM(opened_half2)) / (count(resolved_half2) + COUNT (opened_half2)))
  ,x1 = ((count(c.period)) / 4)
  ,x2 = (((count(c.period)) / 4) * 3)
 from (select
          a.yearclosed
         ,a.weekClosed
         ,a.resolved_half1
         ,b.yearEntered
         ,b.weekEntered
         ,b.opened_half1
         ,cast(a.yearClosed as varchar(5)) + ', ' + cast(a.weekClosed as varchar(5))  period 
        from (--  Number of items per week that closed within @Interval
              select
                 count(distinct TicketNbr) * 1.0  resolved_half1
                ,datepart(wk, date_closed)        weekClosed
                ,year(date_closed)                yearClosed
               from v_rpt_Service 
               where date_closed >= @FullInterval
               group by
                 datepart(wk, date_closed)
                ,year(date_closed) )  a
         left outer join (--  Number of items per week that were entered within @Interval
                          select 
                             count(distinct TicketNbr) * 1.0  opened_half1
                            ,datepart(wk, date_entered)       weekEntered
                            ,year(date_entered)               yearEntered
                           from v_rpt_Service
                           where date_entered >= @FullInterval
                           group by
                             datepart(wk, date_entered)
                            ,year(date_entered) )  b
          on a.weekClosed = b.weekEntered 
           and a.yearClosed = b.yearEntered)  c
  left outer join (select
                       d.yearclosed
                      ,d.weekClosed
                      ,d.resolved_half2
                      ,e.yearEntered
                      ,e.weekEntered
                      ,e.opened_half2
                      ,cast(yearClosed as varchar(5)) + ', ' + cast(weekClosed as varchar(5))  period 
                    from (select
                             count(distinct TicketNbr) * 1.0  resolved_half2
                            ,datepart(wk, date_closed)        weekClosed
                            ,year(date_closed)                yearClosed
                           from v_rpt_Service
                           where date_closed >= @HalfInterval
                           group by
                             datepart(wk, date_closed) 
                            ,year(date_closed) )  d 
                     left outer join (select
                                         count(distinct TicketNbr) * 1.0  opened_half2
                                        ,datepart(wk, date_entered)       weekEntered
                                        ,year(date_entered)               yearEntered
                                       from v_rpt_Service
                                       where date_entered >= @HalfInterval
                                       group by
                                           datepart(wk, date_entered) 
                                          ,year(date_entered) )  e
                      on d.weekClosed = e.weekEntered
                       and d.yearClosed = e.yearEntered )  f
   on c.period = f.period 
 group by
   c.period
  ,resolved_half1
  ,resolved_half2
  ,opened_half1
  ,opened_half2
  ,c.yearClosed
  ,c.weekClosed
)
SELECT
   row
  ,Period
  ,x1
  ,y1
  ,x2
  ,y2
  ,m = ((y1 - y2) / (x1 - x2))
  ,b = (y2 - (((y1 - y2) / (x1 - x2)) * x2))
  ,trend = ((((y1 - y2) / (x1 - x2)) * (row)) + (y2 - (((y1 - y2) / (x1 - x2)) * x2)))
 from cte
 order by row 
```

作为附录，所有子查询“c”都可以替换为以下内容，而“f”则替换为稍作修改的版本。性能的好坏取决于表大小、索引和其他不可估量的因素。

```
select
   datepart(wk, date_closed)  weekClosed
  ,year(date_closed)          yearClosed
  ,count (distinct case
                  when date_closed >= @FullInterval then TicketNbr
                  else null
                end)          resolved_half1
  ,count (distinct case
                  when date_entered >= @FullInterval then TicketNbr
                  else null
                end)          opened_half1
 from v_rpt_Service 
 where date_closed >= @FullInterval
  or date_entered >= @FullInterval
 group by
   datepart(wk, date_closed)
  ,year(date_closed) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T18:17:30.997

我想到了。我把数据分成多个派生表和子查询，本质上把数据一分为二。这些是我获取每个值的公式：

```
*(each row is a week)*
y1 = average of data first half
y2 = average of data second half
x1 = 1/4 of number of weeks
x2 = 3/4 of number of weeks
m = (y1-y2)/(x1-x2)
b = y2 - (m * x2)
trend = (m * row_number) + b 
```

这是我的（非常脏的）SQL代码：

```
SELECT  resolved_half1,resolved_half2,opened_half1,opened_half2, c.period,
((SUM (resolved_half1) OVER () + SUM(opened_half1) OVER ()) - (SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ())) / ((COUNT(resolved_half1) OVER () + COUNT(opened_half1) OVER ()) / 2) as y1, 
((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as y2,
((COUNT(c.period) OVER ()) / 4) as x1,
(((COUNT(c.period) OVER ()) / 4) * 3) as x2,
((CAST(((SUM (resolved_half1) OVER () + SUM(opened_half1) OVER ()) - (SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ())) / ((COUNT(resolved_half1) OVER () + COUNT(opened_half1) OVER ()) / 2) as float) - CAST(((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as float)) / (CAST(((COUNT(c.period) OVER ()) / 4) as float) - CAST( (((COUNT(c.period) OVER ()) / 4) * 3) as float))) as m,
(CAST(((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as float) - (((CAST(((SUM (resolved_half1) OVER () + SUM(opened_half1) OVER ()) - (SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ())) / ((COUNT(resolved_half1) OVER () + COUNT(opened_half1) OVER ()) / 2) as float) - CAST(((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as float)) / (CAST(((COUNT(c.period) OVER ()) / 4) as float) - CAST( (((COUNT(c.period) OVER ()) / 4) * 3) as float))) * (((COUNT(c.period) OVER ()) / 4) * 3))) as b,
((((CAST(((SUM (resolved_half1) OVER () + SUM(opened_half1) OVER ()) - (SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ())) / ((COUNT(resolved_half1) OVER () + COUNT(opened_half1) OVER ()) / 2) as float) - CAST(((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as float)) / (CAST(((COUNT(c.period) OVER ()) / 4) as float) - CAST( (((COUNT(c.period) OVER ()) / 4) * 3) as float))) * (ROW_NUMBER() OVER(ORDER BY c.yearClosed,c.weekClosed))) + (CAST(((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as float) - (((CAST(((SUM (resolved_half1) OVER () + SUM(opened_half1) OVER ()) - (SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ())) / ((COUNT(resolved_half1) OVER () + COUNT(opened_half1) OVER ()) / 2) as float) - CAST(((SUM(resolved_half2) OVER () + SUM(opened_half2) OVER ()) / (COUNT(resolved_half2) OVER () + COUNT (opened_half2) OVER ())) as float)) / (CAST(((COUNT(c.period) OVER ()) / 4) as float) - CAST( (((COUNT(c.period) OVER ()) / 4) * 3) as float))) * (((COUNT(c.period) OVER ()) / 4) * 3)))) as trend,
ROW_NUMBER() OVER(ORDER BY c.yearClosed,c.weekClosed) as row

FROM
    (SELECT *, CAST(yearClosed as varchar(5)) + ', ' + CAST(weekClosed as varchar(5)) AS period
     FROM  (SELECT        TOP (100) PERCENT COUNT(DISTINCT TicketNbr) AS resolved_half1, { fn WEEK(date_closed) } AS weekClosed, { fn YEAR(date_closed) } AS yearClosed
                          FROM            v_rpt_Service
      WHERE (date_closed >= DateAdd(Day, DateDiff(Day, 0, GetDate()) - (180), 0))

      GROUP BY { fn WEEK(date_closed) }, { fn YEAR(date_closed) }) AS a 
      LEFT OUTER JOIN
      (SELECT TOP (100) PERCENT COUNT(DISTINCT TicketNbr) AS opened_half1, { fn WEEK(date_entered) } AS weekEntered, { fn YEAR(date_entered) 
       FROM v_rpt_Service AS v_rpt_Service_1
       WHERE (date_entered > = DateAdd(Day, DateDiff(Day, 0, GetDate()) - (180), 0))
       GROUP BY { fn WEEK(date_entered) }, { fn YEAR(date_entered) }) AS b ON a.weekClosed = b.weekEntered AND a.yearClosed = b.yearEntered) as c 
       LEFT OUTER JOIN
       (SELECT *, CAST(yearClosed as varchar(5)) + ', ' + CAST(weekClosed as varchar(5)) AS period 
       FROM  (SELECT TOP (100) PERCENT COUNT(DISTINCT TicketNbr) AS resolved_half2, { fn WEEK(date_closed) } AS weekClosed, { fn YEAR(date_closed) } AS yearClosed
       FROM v_rpt_Service
       WHERE (date_closed >= DateAdd(Day, DateDiff(Day, 0, GetDate()) - (180 / 2), 0))
       GROUP BY { fn WEEK(date_closed) }, { fn YEAR(date_closed) }) AS d 
       LEFT OUTER JOIN
       (SELECT TOP (100) PERCENT COUNT(DISTINCT TicketNbr) AS opened_half2, { fn WEEK(date_entered) } AS weekEntered, { fn YEAR(date_entered)} AS yearEntered
       FROM v_rpt_Service AS v_rpt_Service_1
       WHERE (date_entered > = DateAdd(Day, DateDiff(Day, 0, GetDate()) - (180 / 2), 0))
       GROUP BY { fn WEEK(date_entered) }, { fn YEAR(date_entered) }) AS e ON d.weekClosed = e.weekEntered AND d.yearClosed = e.yearEntered
) as f ON c.yearClosed = f.yearClosed AND c.weekClosed = f.weekClosed AND c.weekEntered = f.weekEntered AND c.yearEntered = f.yearEntered AND c.period = f.period
GROUP BY c.period, resolved_half1,resolved_half2,opened_half1,opened_half2,c.yearClosed,c.weekClosed
ORDER BY row 
```

**此代码使用 180 天的硬编码值。我仍然需要能够使用变量来选择天数（不会出现除以 0 的错误），并且确实需要清理代码。如果有人可以为我做这两件事（我不是最擅长 SQL），那么赏金就是他们的。**

图片：

![图表](../Images/4400cfbead0c6093de4a7fdfc0544908.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-11T08:13:16.943

我相信这会解决问题 - 如果不发布一些实际的样本数据，我会看看我是否可以调整它来修复它：

```
DECLARE @noOfDays INT
SET @noofdays = 180

;WITH tickets AS
(
SELECT DISTINCT
DATENAME(YEAR,date_closed) + RIGHT('000' + CAST(DATEPART(WEEK,date_closed) AS VARCHAR(5)),3) as Period
,ticket_nbr
,1 as ticket_type --resolved
FROM v_rpt_Service
WHERE (date_closed >= DateAdd(Day, DateDiff(Day, 0, GetDate()) - @NoOfDays, 0)) 
UNION ALL
SELECT DISTINCT
DATENAME(YEAR,date_closed) + RIGHT('000' + CAST(DATEPART(WEEK,date_closed) AS VARCHAR(5)),3) as Period
,ticket_nbr
,0 as ticket_type --opened
FROM v_rpt_Service
WHERE  (date_entered > = DateAdd(Day, DateDiff(Day, 0, GetDate()) - @NoOfDays, 0)) 
)
,tickets2 AS
(
SELECT
Period
,SUM(CASE WHEN ticket_type = 0 THEN 1 ELSE 0 END) as opened
,SUM(CASE WHEN ticket_type = 1 THEN 1 ELSE 0 END) as closed
FROM tickets
GROUP BY
Period
)
,tickets3 AS
(
SELECT
Period
,row_number() OVER (ORDER BY period ASC) as row
,opened
,closed
,COUNT(period) OVER() as base
,SUM(opened) OVER () as [Sumopened]
,SUM(opened * opened) OVER () as [Sumopened^2]
,SUM(opened * closed) OVER () as [Sumopenedclosed]
,SUM(closed) OVER () as [Sumclosed]
,SUM(closed * closed) OVER () as [Sumclosed^2]
,SUM(opened * closed) OVER () * COUNT(period) OVER () AS [nSumopenedclosed]
,SUM(opened) OVER () * SUM(closed) OVER () AS [Sumopened*Sumclosed]
,SUM(opened * opened) OVER () * COUNT(period) OVER () AS [nSumopened^2]
,SUM(opened) OVER () * SUM(opened) OVER () as [Sumopened*Sumopened]
FROM tickets2
)
--Formula for linear regression is Y = A + BX
SELECT
period
,opened
,closed
,((1.0 / base) * [Sumclosed]) - 
([Sumopenedclosed] - ([Sumopened*Sumclosed] / base)) / ([Sumopened^2] - ([Sumopened*Sumopened] / base)) *((1.0 / base) * [Sumopened]) 
+ row * ([Sumopenedclosed] - ([Sumopened*Sumclosed] / base)) / ([Sumopened^2] - ([Sumopened*Sumopened] / base))  
AS trend_point
,((1.0 / base) * [Sumclosed]) - 
([Sumopenedclosed] - ([Sumopened*Sumclosed] / base)) / ([Sumopened^2] - ([Sumopened*Sumopened] / base)) *((1.0 / base) * [Sumopened]) AS A
,([Sumopenedclosed] - ([Sumopened*Sumclosed] / base)) / ([Sumopened^2] - ([Sumopened*Sumopened] / base)) as B
from tickets3 
```

# scala - 如何将 java.util.Collections.unmodifiableMap 转换为不可变的 Scala Map？

> ID：10046889
> 
> 赞同：7
> 
> 时间：2012-04-06T17:24:18.787
> 
> 标签：scala

我正在尝试将参数映射从 ServletRequest 转换为 Scala 2.9.0.1 中的 Scala Map：

```
val params = request.getParameterMap.asInstanceOf[Map[String, Array[String]]] 
```

我已经导入了 collection.JavaConversions._，并在运行时抛出了这个：

```
java.lang.ClassCastException: java.util.Collections$UnmodifiableMap cannot be cast to scala.collection.immutable.Map 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-06T17:31:54.423

直接打电话怎么样`.toMap`？

```
import collection.JavaConversions._
val x = java.util.Collections.unmodifiableMap[Int,Int](new java.util.HashMap[Int,Int]())
val y: Map[Int,Int] = x.toMap //y: Map[Int,Int] = Map() 
```

不调用`toMap`，`JavaConversions`仅允许您隐式转换为*可变*Scala 映射：

```
scala> val z: collection.mutable.Map[Int,Int] = x
z: scala.collection.mutable.Map[Int,Int] = Map() 
```

这大概是因为 Java`Map`是可变的，所以它应该只在 Scala 中表示为 a `mutable.Map`，直到您将它显式转换为`immutable.Map`.

请注意，当您只是`Map`在 Scala 中说时，您实际上是在谈论`collection.immutable.Map`因为`Predef`别名`Map`是这样的：

```
scala> Map()
res0: scala.collection.immutable.Map[Nothing,Nothing] = Map() 
```

因此，当您说 时`request.getParameterMap.asInstanceOf[Map[String, Array[String]]]`，您实际上是在要求 Scala 将 Java 隐式转换`Map`为 Scala ，因为 Java是可变的`collection.immutable.Map`，所以它不想这样做。`Map`

# php - 如何用 PHP 检查 SQL 数据库是否已经有

> ID：10046899
> 
> 赞同：0
> 
> 时间：2012-04-06T17:24:56.427
> 
> 标签：php, mysql, database

我试图找到这个问题的答案，但没有一个答案适合。

我有两个数据库，一个有 15.000.000 个条目，我想提取必要的数据并将其存储在一个包含大约 33.000 个条目的小得多的数据库中。两个数据库同时打开。或者至少他们应该是。

在打开大数据库并从中提取条目时，是否可以检查该值是否已存在于较小数据库的某个表中？我只需要一些通用的方法来检查它。

在我的代码中，我首先打开两个数据库（大的是oddsnavi_push，小的是oddsnavi_baby）：

```
$database = "oddsnavi_push";    
$db_handle = mysql_connect($server, $user_name, $password);
$db_found = mysql_select_db($database, $db_handle);
$database_baby = "oddsnavi_baby";
$db_handle_baby = mysql_connect($server, $user_name, $password);
$db_found_baby = mysql_select_db($database_baby, $db_handle_baby); 
```

然后我开始从oddsnavi_push 读取和计算数据：

```
$SQL_SELECT_ALL = "...giant query...";
$result_select_all = mysql_query( $SQL_SELECT_ALL );

while($db_field_all = mysql_fetch_assoc( $result_select_all ) ) {
$SQL_INSERT="INSERT INTO oddsnavi_baby.calc (id, one, two) VALUES ('$id', '$one', '$two')"; 
```

它一直工作到那时。它获取读取的数据（id、一、二）并将它们插入到名为 calc 的oddsnavi_baby 表中的适当列中。当oddsnavi_baby 完全为空时，它会正确执行此操作。

但是，我只需要它来更新数据库，如果一个条目（基于是否存在某个“id”）不存在。

编辑：我会改写我的问题。从查询结果（大数据库）中，我得到了每一行的字符串。例如$字符串。如何打开第二个数据库并检查oddsnavi_baby.calc 表是否在事件列中具有$string 值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T22:25:34.533

跳过检查并尝试`INSERT IGNORE`假设 Id 是唯一键。

[http://dev.mysql.com/doc/refman/5.5/en/insert.html](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:30:18.640

伙计，我记得曾经遇到过这样的问题。我认为我们实际上走的是缓慢而昂贵的路线，并编写了一个脚本来一次提取一个条目，比较它，如果它不存在则插入它。但是，我找到了这篇文章，听起来它可能对您有所帮助：

[http://www.mysqlfaqs.net/mysql-faqs/Tricky-Select-Queries/How-to-compare-data-of-two-tables-of-two-different-databases-in-MySQL](http://www.mysqlfaqs.net/mysql-faqs/Tricky-Select-Queries/How-to-compare-data-of-two-tables-of-two-different-databases-in-MySQL)

祝你好运 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:35:40.197

为什么你真的需要多个数据库？金额无所谓表就好，不需要拆分。

```
//Multiple links to different databases
$dblink1 = mysqli_connect($localhost, $user, $pass, $db1);
$dblink2 = mysqli_connect($localhost, $user, $pass, $db2);

$id = '1'; // Id to check
$query = "SELECT COUNT(*) FROM `table` WHERE id = '1' LIMIT 1";
$result = mysqli_query($dblink1, $query); //query db 1

if(mysql_num_rows($result)) {
    $query = "INSERT INTO `table` VALUES(.....)";
    $result = mysqli_query($dblink1, $query); //query db 2
} 
```

# compression - gzip 和 deflate 压缩是否提供相同的有效负载

> ID：10046914
> 
> 赞同：1
> 
> 时间：2012-04-06T17:26:39.880
> 
> 标签：compression

根据 wiki，deflate 和 gzip 中的压缩数据是相同的。唯一的区别是页眉和页脚？在 gzip 中，页脚似乎有一个校验和，而用 deflate 压缩的文件没有这样的项目。

有人可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:28:53.690

是的，[gzip = deflate + checksum + header + footer](https://stackoverflow.com/a/388633/139010)。

更多阅读，如果你在乎的话：[https](https://stackoverflow.com/search?q=gzip+vs+deflate) ://stackoverflow.com/search?q=gzip+vs+deflate 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T04:51:32.350

您尚未说明问题的上下文，但我会冒险猜测您的意思是 HTTP 内容编码。在这种情况下，“deflate”实际上是指 zlib 格式，它是一个原始的 deflate 流，带有一个 2 字节的头部和 4 字节的尾部，其中尾部是一个 Adler-32 校验和值。gzip 也是一个带有标头和尾标的原始 deflate 流，但它们不同且更大。gzip 标头至少有 10 个字节，如果有文件名和/或额外字段，则可能更多。gzip 尾部为 8 个字节，由 CRC-32 校验值和未压缩长度模 2^32 组成。

[您可以找到RFC 1951](https://www.rfc-editor.org/rfc/rfc1951)中定义的原始 deflate 压缩数据格式。您可以找到[RFC 1950中定义的 zlib 标头和尾部，以及](https://www.rfc-editor.org/rfc/rfc1950)[RFC 1952](https://www.rfc-editor.org/rfc/rfc1952)中定义的 gzip 标头和尾部。

# c - 是否可以忽略所有信号？

> ID：10046916
> 
> 赞同：13
> 
> 时间：2012-04-06T17:26:44.767
> 
> 标签：c, unix, signals

我有一个服务器应用程序，我想防止它被我可以忽略的任何信号停止。有没有办法一次忽略所有可能的信号，而不是一一设置？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-06T17:30:47.480

是的：

```
#include <signal.h>

sigset_t mask;
sigfillset(&mask);
sigprocmask(SIG_SETMASK, &mask, NULL); 
```

这不会完全*忽略*信号，而是阻止它们；这在实践中是相同的效果。

我想没有必要提及这一点`SIGKILL`，`SIGSTOP`也不能以任何方式被阻止或忽略。

有关更详细的语义，如掩码继承规则等，[请查看手册页](http://pubs.opengroup.org/onlinepubs/007908799/xsh/sigprocmask.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-08-27T12:14:37.893

阻塞信号与忽略它们不同。

当您按照 C2H5OH 的建议阻塞信号时，它会被添加到待处理的信号队列中，并在您解除阻塞后立即传递给进程。

解锁可以使用

```
#include <signal.h>

sigset_t mask;
sigemptyset(&mask);
sigprocmask(SIG_SETMASK, &mask, NULL); 
```

要回答有关如何忽略信号的问题，它必须由 Signal Handler 处理，这是一个用户定义的函数，只要将信号传递给进程就会执行

```
static void foo (int bar)
{
     /*some code here. In your case, nothing*/
} 
```

然后使用注册此功能

```
signal(SIGINT,foo);   //or whatever signal you want to ignore 
```

如果你想忽略所有信号

```
int i;
for(i = 1; i <=31 ; i++)
{
   signal(i,foo);
} 
```

此代码将获取传递给进程的所有信号并忽略它们而不是阻止它们。

注意：根据手册页，这不是推荐的方式，而是建议使用 sigaction。签出`man sigaction`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-03T14:36:08.300

基于我的解决方案`sigprocmask()`但`pthread_sigmask()`对我不起作用。这是我发现的工作：

```
#include <signal.h>
#include <unistd.h>
#include <assert.h>
int main() {
    struct sigaction act;
    act.sa_handler = SIG_IGN;
    for(int i = 1 ; i < 65 ; i++) {
        printf("i = %d\n", i);
        // 9 and 19 cannot be caught or ignored                                                                                                       
        // 32 and 33 do not exist                                                                                                                     
        if((i != SIGKILL) && (i != SIGSTOP) && (i != 32) && (i != 33)) {
            assert(sigaction(i, &act, NULL) == 0);
        }
    }
    sleep(10000);
    return 0;
} 
```

# c# - 旋转图像显示“内存不足”异常

> ID：10046917
> 
> 赞同：2
> 
> 时间：2012-04-06T17:26:56.640
> 
> 标签：c#, memory-leaks

```
 public Bitmap rotateImage()
    {

      try
      {                      
          curImgHndl.CurrentRotationHandler.Flip(RotateFlipType.Rotate90FlipNone);

      }
      catch (Exception ex)
      {

      }

    return objCurrImageHandler.CurrentBitmap;
    } 
```

当使用此功能将图像旋转数次（5 次或更多）时，它会显示错误消息“内存不足”。为了在 c#.net 4 中评估图像，我使用了 ImageFunctions.dll。反编译dll我得到了以下内容。

只给出了整个代码的一部分用于旋转

```
public class RotationHandler 
{
   private ImageHandler imageHandler;

   public void Flip(RotateFlipType rotateFlipType)
   {
      this.imageHandler.RestorePrevious();
      Bitmap bitmap = (Bitmap) this.imageHandler.CurrentBitmap.Clone();
      bitmap.RotateFlip(rotateFlipType);
      this.imageHandler.CurrentBitmap = (Bitmap) bitmap.Clone();
   }
} 
```

我该如何解决？

以下方法解决了lazyberezovsky建议的问题。

```
 public void Flip(RotateFlipType rotateFlipType)
  {
    this.imageHandler.RestorePrevious();
    this.imageHandler.CurrentBitmap.RotateFlip(rotateFlipType);
 } 
```

但是亮度方法的另一个问题。

```
 public void SetBrightness(int brightness)
    {
        Bitmap temp = (Bitmap)_currentBitmap;

            Bitmap bmap = (Bitmap)temp.Clone();
            if (brightness < -255) brightness = -255;
            if (brightness > 255) brightness = 255;
            Color c;
            for (int i = 0; i < bmap.Width; i++)
            {
                for (int j = 0; j < bmap.Height; j++)
                {
                    c = bmap.GetPixel(i, j);
                    int cR = c.R + brightness;
                    int cG = c.G + brightness;
                    int cB = c.B + brightness;

                    if (cR < 0) cR = 1;
                    if (cR > 255) cR = 255;

                    if (cG < 0) cG = 1;
                    if (cG > 255) cG = 255;

                    if (cB < 0) cB = 1;
                    if (cB > 255) cB = 255;

                    bmap.SetPixel(i, j, Color.FromArgb((byte)cR, (byte)cG, (byte)cB));
                }
            }
            _currentBitmap = (Bitmap)bmap.Clone();

    } 
```

此方法适用于某些图像，不适用于其他图像，并显示以下错误“SetPixel is not supported for images with indexed pixel formats。”

如果您可以提供有效且可行的旋转，裁剪和亮度方法，那将非常有帮助。请再次帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:40:47.607

正如克劳迪奥所说，您需要确保处理任何未使用的`Bitmaps`.

```
public void Flip(RotateFlipType rotateFlipType)
{
   this.imageHandler.RestorePrevious();
   Bitmap bitmap = (Bitmap) this.imageHandler.CurrentBitmap.Clone();
   this.imageHandler.CurrentBitmap.Dispose(); // dispose of current bitmap
   bitmap.RotateFlip(rotateFlipType);
   Bitmap clone_map = (Bitmap) bitmap.Clone();
   bitmap.Dipose(); // dispose of original cloned Bitmap
   this.imageHandler.CurrentBitmap = clone_map;
} 
```

您可能可以将其简化为：

```
public void Flip(RotateFlipType rotateFlipType)
{
   this.imageHandler.RestorePrevious();
   Bitmap bitmap = (Bitmap) this.imageHandler.CurrentBitmap.Clone();
   this.imageHandler.CurrentBitmap.Dispose(); // dispose of current bitmap
   bitmap.RotateFlip(rotateFlipType);
   this.imageHandler.CurrentBitmap = bitmap;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-06T17:44:00.010

为什么不旋转当前位图，而不是创建副本？

```
public class RotationHandler 
{
   private ImageHandler imageHandler;

   public void Flip(RotateFlipType rotateFlipType)
   {
      this.imageHandler.RestorePrevious();
      this.imageHandler.CurrentBitmap.RotateFlip(rotateFlipType);
   }
} 
```

# c++ - 这个 c++ 语句检查什么？(Box2d)

> ID：10046920
> 
> 赞同：2
> 
> 时间：2012-04-06T17:27:15.550
> 
> 标签：c++, box2d

```
if ((catA & maskB) != 0 && (catB & maskA) != 0) 
```

它在[Box2d 的手册：6.2](http://box2d.org/manual.html#_Toc258082972)中，用于检查两个对象是否应该碰撞（过滤后）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:30:15.873

它检查 catA 至少有一个与 maskB 相同的“1”位，并且 catB 至少有一个与 maskA 相同的“1”位。

例如，如果 catA 为 3（二进制 00000011）且 maskB 为 10101010），则 (catA & maskB) != 0 为真，因为 catA & maskB 为 00000010。

这称为掩码，这意味着只保留感兴趣的位。

你经常有这种结构：

```
#define READ 1
#define WRITE 2
#define READWRITE (READ|WRITE)
#define DIRECTORY 4

int i=getFileInfo("myfile");
if(i & READWRITE)puts("you can read or write in myfile"); 
if(i & DIRECTORY)puts("myfile is a directory"); 
```

顺便说一句，“i & DIRECTORY”的含义与“(i & DIRECTORY) != 0”相同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:30:10.203

该符号`&`是按位与运算符。因此，声明

```
(catA & maskB) != 0 
```

检查这两个项目中是否有任何位重叠。它查看是否先检查 A 和 B，然后检查 B 和 A。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:36:15.320

catA 是对象 A 的碰撞类别的位字段 maskA 是对象 A 可以碰撞的类别的位字段。

例如：

```
catA  = 100010000010010 // Object A is in 4 collision categories
maskA = 001010000000000 // Object A can collide with too different categories

catB  = 000010001000001 // Object B is in 3 collision categories
maskB = 100000000000000 // Object B can only collide with the category represented by the highest bit 
```

catA & maskB 表示 catA 和 maskB 中均为 1 的位，因此`1000000000000000`. 它不是 0，因为对象 B 可以与最高位的对象发生碰撞，并且对象 A 设置了该位。

catB & maskA 表示在 catB 和 maskA 中均为 1 的位，因此`0000100000000000`. 它也不为零，因为对象 A 可以与第 5 位最高位类别中的对象发生碰撞，而对象 B 属于该类别。

所以这两个物体可以碰撞。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T17:46:55.250

我知道许多 C/C++ 程序员喜欢简洁，但我发现通过将此测试移到函数中可以使这种类型的代码更具可读性（如果需要，可以内联它）。他们也可以通过将代码移动到一个命名良好的方法来摆脱注释。

```
if (FixturesCanCollide() )
{
} 
```

实际上，您可以放弃与 !=0 的比较（尽管为了清楚起见，您可能更喜欢它，但无论哪种方式，它都可能编译为相同的代码。

```
inline bool FixturesCanCollide()
{   
   return  (catA & maskB) && (catB & maskA);
} 
```

# asp.net-mvc-3 - 从区域中的控制器返回视图不起作用

> ID：10046924
> 
> 赞同：2
> 
> 时间：2012-04-06T17:27:50.807
> 
> 标签：asp.net-mvc-3, controller, asp.net-mvc-routing, asp.net-mvc-areas

在阅读了关于这个主题的几篇文章后，我还没有找到我的问题的答案。我有一个 MVC 3 应用程序并添加了一个区域。一切正常，直到我尝试从区域内的控制器返回视图。

我可以成功发布到控制器保存方法，但只需返回视图（返回 View()），我得到以下信息：

未找到“保存”视图或其主视图，或者没有视图引擎支持搜索的位置。搜索了以下位置：

```
~/Areas/Test/Views/Default1/Save.aspx
~/Areas/Test/Views/Default1/Save.ascx
~/Areas/Test/Views/Shared/Save.aspx
~/Areas/Test/Views/Shared/Save.ascx
... 
```

这似乎很基本，不知道为什么我会遇到这么多麻烦。

我使用了 Phil Haack 的 RouteDebugger (http://nuget.org/packages/routedebugger) 并且所有路由都作为设置工作......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:32:34.453

MVC 期望（按照惯例）一个视图（与您在任何一个文件夹中的操作名称同名（默认情况下，但您可以覆盖它）。您应该在任何文件夹中都有该视图。那是MVC 约定。所以将您的视图添加到该文件夹​​。您可以通过右键单击`Return View()`操作方法中的 statmenet 并选择`Add View`选项来添加它。它将自动添加一个视图。

![在此处输入图像描述](../Images/bf61cdc70c3865d87eaec341f4e6ea88.png)

或者您可以右键单击该`Areas/Test/Views/Default1`文件夹并选择添加视图并将其保存为与您的操作方法相同的名称。如果您想使用与操作名称不同的名称保存它，可以使用 View 方法，如下所示

```
return View("MyOtherViewName"); 
```

假设您在文件夹中添加了 a`MyOtherViewName.cshtml`作为您的视图`Areas/Test/Views/Default1`

# mysql - Mysql 在表中存储任意数量值的最佳方法

> ID：10046925
> 
> 赞同：5
> 
> 时间：2012-04-06T17:28:09.800
> 
> 标签：mysql, database

我想知道存储的最佳方法是什么，例如`languages`在一个`user`表中，当用户可以拥有任意多的语言时，希望不使用序列化数据，因为该字段将被密集搜索。

我在考虑限制条目的数量，例如最大 4 种语言，并且在用户表中有 lang1, lang2 ..

有没有更好的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T17:33:10.837

这称为[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)。具体来说，您需要映射[“多对多”关联](http://en.wikipedia.org/wiki/Many-to-many_%28data_model%29)

你需要 3 张桌子。

```
User(id, name)
Language (id, language_name)
User_Language(id,id_user,id_language) 
```

获取用户 id 3 的所有语言：

```
SELECT l.language_name
FROM User u
JOIN user_language ul ON (u.id=ul.id_user)
JOIN  Language l ON (l.id = ul.id_language)
WHERE u.id = 3 
```

**编辑：**

注意@silkAdmin 有两件事很重要。第一个，正如@BryceAtNetwork23 所指出的，没有必要在 User_Language 表上放置一个 id。第二个是，你应该了解[joins](http://en.wikipedia.org/wiki/Join_%28SQL%29)，特别是[MySQL Joins](http://dev.mysql.com/doc/refman/5.0/en/join.html)（因为 SQL 在不同的数据库引擎中往往会有所不同）。在你深入挖掘之后，你将能够看到在前面的查询中加入 User 表也不需要，可以简化为：

```
SELECT l.language_name
FROM user_language ul
JOIN  Language l ON (l.id = ul.id_language)
WHERE ul.user_id = 3 
```

但是我在第一个答案中添加了它，以使您更轻松。

**为什么使用语言表**

我的回答只是反映了我的做法。有很多方法可以完成所要求的。说了这么多，我自己解释一下。

让我们在极端情况下思考。第一个极端是将语言存储在用户表中，如上所述。例如，我们可以有一列并用分号分隔值。像这样的东西

```
User: (1, "John", "spanish;english;japanese") 
```

这样做的好处是您不需要任何加入。给定用户的 ID，您可以获得语言。缺点是搜索它会很痛苦。您如何让所有用户使用“西班牙语”语言？（这里的底线是你不能索引你的数据）。另一个缺点，现在有点过时了，是磁盘空间的过度使用。在数据库和规范化被发明的时候，磁盘空间非常昂贵。所以，存储这个：

```
User: (1, "John", "spanish;english;japanese") 
User: (2, "Mary", "spanish;english") 
```

那是不能容忍的事情。所以，有人过来说：“嘿，让我们使用 id，所以，我们可以把它变成”：

```
User: (1, "John", "1;2;3") 
User: (2, "Mary", "1;2")

Language (1,"spanish")
Language (2,"english") 
```

对于 10.000 个用户和几百种语言，这对磁盘使用率来说是一个巨大的改进（也许在我们这个时代，这不再是真的，我稍后会谈到）。这解决了磁盘问题，但我们仍然有搜索问题。同样，您如何让所有用户使用“西班牙语”语言？好吧，使用这种设计，您应该遍历 users 表并获取语言列，将其拆分为 ";" 并寻找 id 1。

这就是为什么我们开始使用我之前向您展示的方法。

所以，到目前为止一切顺利。很好的解释；）

**大免责声明**

正如我之前所说，有几种方法可以做到这一点。这取决于您的情况以及您想要达到的目标。如果您想根据该列进行搜索（例如，给我说英语的用户），您应该考虑我在答案顶部告诉您的设计。

现在有一种数据解决方案的“新浪潮”，称为 no-sql 数据库（它会有所不同），它们试图对数据进行非规范化。如果您担心模式的过度规范化，您应该看一下。我推荐你使用 MongoDB 和 CouchDB，因为它们更容易上手。

**关于联接**

不用担心 2 个连接的性能。如果你有性能问题，那不是为了这个。数据库引擎就是为此目的而创建的。有了良好的内存缓存和索引优化，它应该可以顺利运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:31:23.027

是的，最好的方法是使用带有列`lang_id`和的附加表`user_id`。在那里您可以存储任意数量的用户/语言关联（每行一个）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:32:13.057

创建表 user_languages

```
 user_id int,
 language_id int, 
```

有约束：

```
 PRIMARY KEY (user_id, language_id),
 FOREIGN KEY (language_id) REFERENCES language(id),
 FOREIGN KEY (user_id) REFERENCES users(id) 
```

有了这样的限制，用户可以根据需要分配尽可能多的语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T17:33:39.307

我认为实现这一点的最佳方法是拥有一个 USER 表、一个 USER_LANGUAGES 表和一个 LANGUAGES 表。通过这种方式，用户可以使用任意数量的语言。

```
USER
user_id int
user_name varchar

USER_LANGUAGES
user_id int
lang_id int

LANGUAGES
lang_id int
lang_name varchar 
```

USER 存储基于用户的字段。LANGUAGES 存储每种特定语言（英语、德语等）的数据。USER_LANGUAGES 存储了哪些用户知道哪些语言的关联。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T17:32:00.610

我认为你应该考虑有两张桌子。一个与`users`一个与`languages`。它更容易维护，也更容易对`joins`这些表进行操作。

# jquery-mobile - 如何使用 javascript 更改我的 jQuery Mobile 应用程序的主题？

> ID：10046927
> 
> 赞同：0
> 
> 时间：2012-04-06T17:28:17.857
> 
> 标签：jquery-mobile

这是我编写的一些 javascript，它试图更改我的 jQuery Mobile 应用程序标题的主题。在 jQuery mobile javascript 和 CSS 加载后，它位于我网页的 head 元素中。

```
$(function() {
    $("[data-role='header']").attr('data-theme', 'b'); 
}); 
```

为什么没有效果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T18:50:22.627

事实证明，动态更改标题的主题很容易，因为只有一个类可以更改，按钮也是如此（如果标题中有按钮）。

```
//store all the classes to remove from elements when swapping their theme
var removeClasses = 'ui-bar-a ui-bar-b ui-bar-c ui-bar-d ui-bar-e ui-btn-up-a ui-btn-up-b ui-btn-up-c ui-btn-up-d ui-btn-up-e';

//when a specific page initializes, find links in the body and add an event
//handler to the click event for them to update the header's theme
$(document).delegate('#my-page', 'pageinit', function () {
    $(this).find('a').bind('click', function (event) {

        //get the new theme letter, stored in the HREF attribute of the link
        var newTheme = $(this).attr('href');

        //change the header's class/attr to relfect the new theme letter
        $.mobile.activePage.children('.ui-header').attr('data-theme', newTheme).removeClass(removeClasses).addClass('ui-bar-' + newTheme).children('h1').text('My Header (' + newTheme + ')');

        //change the header button's classes/attr to reflect the new theme letter
        $.mobile.activePage.children('.ui-header').children('a').removeClass(removeClasses).addClass('ui-btn-up-' + newTheme);
        return false;
    });
});​ 
```

这是一个演示：http: [//jsfiddle.net/jUgLr/1/](http://jsfiddle.net/jUgLr/1/)

毕竟我想我应该确保你知道你可以`data-theme`为任何元素添加一个属性来改变它的主题：

```
<div data-role="page">
    <div data-role="header" data-theme="e">
        ...
    </div>
    <div data-role="content" data-theme="d">
        ...
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T18:56:49.287

这会起作用

```
$(document).delegate('[data-role=page]','pageinit',function(){
    $('[data-role=header]').attr('data-theme','b').removeClass().addClass('ui-header ui-bar-b');                
}); 
```

# c - _NFILE 在哪里定义

> ID：10046929
> 
> 赞同：2
> 
> 时间：2012-04-06T17:28:30.967
> 
> 标签：c

为了创建一个守护进程，我在某处读到了为了关闭所有打开的文件描述符，我们可以使用以下代码：-

```
for (fd = 0; fd < _NFILE; fd++)
  close(fd); /* close all file descriptors */ 
```

我必须将 _NFILE 定义为

```
#define _NFILE 3 
```

还是已经在某些包含文件中定义？我试图在 /usr/include 目录中对其进行 grep，但找不到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:35:07.737

`_NFILE`仅适用于原始 Unix。执行此操作的可移植方法是`sysconf(_SC_OPEN_MAX)`(POSIX)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:35:59.407

[这个 stdio.h](http://www2.hs-fulda.de/~klingebiel/c-stdlib/stdio.h.htm)说

> *   _NFILE 的值在处理器特定 ABI 中定义。价值
> *   选择是出于历史原因，而不是真正与处理器相关
> *   属性。请注意，SPARC 处理器特定 ABI 使用常见的
> *   UNIX 历史值为 20 [...]。

然后继续根据机器架构定义一些值

# javascript - 在coldfusion中使用javascript进行表单验证

> ID：10046934
> 
> 赞同：-1
> 
> 时间：2012-04-06T17:28:46.337
> 
> 标签：javascript, html, forms, coldfusion, coldfusion-9

我正在尝试验证两个字段。一个是开放时间，另一个是关闭时间。我的验证应该检查关闭时间的值是否不是“00”，我的打开时间的值也应该大于“00”。

我的问题是，我做错了什么？我知道我的功能一定有错误。

这是我到目前为止写的验证：

```
<script type="text/javascript">

function hoursFunction(formObject, formField, fieldValue)
{  
  var closeHours = document.getElementById('closeHours#CountVar#');
  var openHours = document.getElementById('openHours#CountVar#');

  if(closeHours != "00" && openHours == "00")
  {
    sfm_show_error_msg('Enter a valid opening time');
  }
} 
```

这是我的表格样本

```
<form id="hoursForm" action="physician_businessHours.cfm?docID=<cfoutput>#docid#</cfoutput>" method="post" onsubmit="hoursFunction();">
            <input type="hidden" name="postitnow" value="yes">

                    <table border="1">

                    <tr>
                        <th>Day</th><th>Open Time</th><th>Close Time</th>
                    </tr>

                    <cfloop from="1" to="7" index="CountVar">

                    <cfset dayFound= 0>
                    <tr>
                        <td><cfif CountVar eq 1>Mon<cfelseif CountVar eq 2>Tues<cfelseif CountVar eq 3>Wednes<cfelseif CountVar eq 4>Thurs<cfelseif CountVar eq 5>Fri<cfelseif CountVar eq 6>Satur<cfelseif CountVar eq 7>Sun</cfif>day</td>

                        <cfoutput>

                        <td>   
                        <select id="openHours#CountVar#" name="openHours#CountVar#">
                         <cfloop query="doctorHours">
                        <cfloop from="00" to="23" index="OpenHours">  
                        <option  value="#openHours#"<cfif TimeFormat(doctorHours.openTime,'HH') EQ OpenHours AND CountVar EQ doctorHours.day > selected="selected"</cfif>>#OpenHours#</option>
                        </cfloop>
                        </cfloop>
                        </select>
                         </td>

     <td>     
                        <select id="closeHours#CountVar#" name="closeHours#CountVar#">
                        <cfloop query="doctorHours">
                        <cfloop from="00" to="23" index="closeHours">  
                        <option value="#closeHours#"
                        <cfif TimeFormat(doctorHours.closeTime,'HH') EQ closeHours AND CountVar EQ doctorHours.day  > selected="selected"</cfif>>#closeHours#</option>
                        </cfloop>
                        </cfloop>
                        </select>
                        </td>
                         </tr>

      <input type="hidden" name="Validate" onValidate="hoursFunction" message="You must select an opening hour">

     <input type="submit" value="Update" id="Submit">
                    ' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T18:47:23.187

您需要从元素中获取值：

```
 var closeHours = document.getElementById('closeHours#CountVar#').value;
  var openHours = document.getElementById('openHours#CountVar#').value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T16:37:55.073

您的 CountVar 从 1 开始，而不是 0，因此您的 for 循环应该是相同的。另外，为了防止表单提交，如果表单未通过验证，您的 hoursFunction() 应该返回 false。此外，您的 hoursFunction() 需要 3 个参数，但您没有将任何参数传递给它 - 在这种情况下，这些参数不是必需的，因此只需将它们从函数定义中删除即可。试试下面的功能：

```
function hoursFunction() {
  for (var i = 1; i <= 7; i++) {
    var closeHours = document.getElementById('closeHours' + i).value;
    var openHours = document.getElementById('openHours' + i).value;
    if (closeHours != "00" && openHours == "00") {
      sfm_show_error_msg('Enter a valid opening time');
      return false;
    }
    return true;
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T20:46:57.210

我懂了。您需要获取正确的元素 ID：

```
for (var i = 0; i < 7; i++) {
    var closeHours = document.getElementById('closeHours' + i).value;
    var openHours = document.getElementById('openHours' + i).value;

    if (closeHours != "00" && openHours == "00") {
      sfm_show_error_msg('Enter a valid opening time');
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T15:45:01.470

这是我编写的代码，到目前为止它运行良好：

```
function hoursFunction()
{  

    var i = 0;
    var openHour;
    var closeHour;

    for(i=1;i<8;i++)
    {
     openHour = document.getElementById("openHours" + i).value;
     closeHour= document.getElementById("closeHours" + i).value;

    if(openHour > closeHour)
    {   
        document.getElementById('error').innerHTML= "Error at " + i;  
        return false; 
    }
    document.getElementById('error').innerHTML= "No Error occured";  
    return true;
    }
} 
```

我现在的问题是，当我提交表单时，表单似乎正在刷新并正在删除我的所有数据......对此有什么想法吗？

# javascript - 带有两个单选按钮的谷歌自定义搜索

> ID：10046935
> 
> 赞同：0
> 
> 时间：2012-04-06T17:28:46.577
> 
> 标签：javascript, jquery

这是我用于自定义搜索的代码，

```
<div id="cse-search-form" style="width: 100%;">Loading</div>
<script src="http://www.google.com.pk/jsapi" type="text/javascript"></script>
<script type="text/javascript"> 
google.load('search', '1', {language : 'en', style : google.loader.themes.V2_DEFAULT});
$('input[@name=sr]').change(function() {
 if ($("input[@name=sr]:checked").val() == 'kw')              
    var qval = "kw"

 else 
    var qval = "gw"

});
google.setOnLoadCallback(function() {
var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
  '009317721292264254327:ce_olwjr2z4', customSearchOptions);
customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);  
var qval = $("input[@name=sr]:checked").val();
var options = new google.search.DrawOptions();
options.setAutoComplete(true);  
options.enableSearchboxOnly("http://www.alhudapk.com/audios/search.html", qval);
customSearchControl.draw('cse-search-form', options);
}, true); 
</script>
<div style="margin-top: 10px;">
<input type="radio" name="sr" id="kw" value="kw" checked="checked"  />Audio
<input type="radio" name="sr" id="gw" value="gw" / >Web
</div>
<style type="text/css">
input.gsc-input, .gsc-input-box, .gsc-input-box-hover, .gsc-input-box-focus {
border-color: #D9D9D9;
}
input.gsc-search-button, input.gsc-search-button:hover, input.gsc-search-button:focus {
border-color: #2F5BB7;
background-color: #357AE8;
background-image: none;
filter: none;
}
.gsc-search-box {
margin-top: -5px !important; 
margin-bottom: -5px !important;
}

</style> 
```

我只需要一个简单的结果，即

如果 radio1 被选中

search.html?kw=mysearchkeyword

如果 radio2 被选中？gw=mysearchkeyword

原因是对于“kw”，我使用的是我自己的个人搜索，而对于谷歌网络搜索，我需要“gw”参数来传递 url，请帮助

我的代码在页面加载后不起作用，它只能工作一次，但在页面加载后不会更改任何值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T18:10:06.603

一些问题：

**1)**语法错误：`input[@name=sr]`必须是`input[name$=sr]`：

**2）**局部变量`qvar`没有意义

**3）** `options.enableSearchboxOnly`必须在每个单选按钮更改时调用：

试试这个：

```
 <script type="text/javascript">
            google.load('search', '1', {language : 'en', style : google.loader.themes.V2_DEFAULT});
            google.setOnLoadCallback(function() {
               var customSearchOptions = {};

               var customSearchControl = new google.search.CustomSearchControl(
                   '009317721292264254327:ce_olwjr2z4', customSearchOptions);
               customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);  

               var options = new google.search.DrawOptions();
               options.enableSearchboxOnly("http://www.alhudapk.com/audios/search.html",
                                          $("input[name$=sr]:checked").val() );
               options.setAutoComplete(true);  
               customSearchControl.draw('cse-search-form', options);

               $('input[name$=sr]').change(function() {
                   options.enableSearchboxOnly("http://www.alhudapk.com/audios/search.html",
                     $("input[name$=sr]:checked").val() );
                   customSearchControl.draw('cse-search-form', options);
              });

            }, true); 
       </script> 
```

# xcode - RootViewController 需要诉诸/重新加载数据数组 xcode 4.3

> ID：10046939
> 
> 赞同：0
> 
> 时间：2012-04-06T17:29:16.107
> 
> 标签：xcode, architecture, ios4, reload

我正在实现一个示例，在该示例中，我从数据库中读取数据，将其放入数组中，对其进行排序，然后使用 RootViewController 显示它。DB 读取和数组加载发生在 RVC 代码之前。因此，它起作用了，我在 RVC 创建的窗口中获取数据，并且那里还有一个导航控制器。

我想向导航控制器添加一个按钮或其他东西，这样当你点击它时，它会将一个值发送回 RootViewController.m 文件，然后基于该值，我想重新使用数组并在RootViewController 窗口。

我不知道该怎么做。我必须对 .xib 和 RootViewController.m 文件进行哪些更改？

拜托，我是一个困惑的人。%-0 非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:47:40.753

这是相当多的，所以我会给出一些一般性的观点，如果其中任何一个引起问题，可能更容易解决较小的细节。

在 RVC 的 viewDidLoad 方法中，您可以创建一个按钮并将其设置为控制器导航项中的右按钮或左按钮。

您可以将该按钮上的点击与控制器中的方法相关联，该方法可以在点击按钮时执行您想要的任何操作。（但实际上，按钮不会发送值，因此您可能需要对这个想法进行更多解释。）

如果您要显示数组内容，我假设 RVC 有一个表格视图，因此一旦数组（我假设是可变数组）重新排序，您可以告诉表格视图重新加载其数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:48:55.483

在回答您的第二个问题时，一旦您使用了您的数组（或者通常根据您的意愿更新您的数据），您可以强制表格视图以编程方式重新加载

```
[tableView reloadData]; 
```

其中“tableView”是指向表格视图的实例变量

# javascript - jQuery 进度条不工作

> ID：10046940
> 
> 赞同：1
> 
> 时间：2012-04-06T17:29:20.933
> 
> 标签：javascript, jquery, ajax

我是一个 jQuery 新手，我正在尝试构建一个动态的 jQuery 进度条。我需要做的是在页面上提供一系列复选框，以便当访问者选中或取消选中复选框时，它会增加或减少进度条上显示的值。此外，当访客达到最大数量（百分比）时，我需要提醒他们。任何帮助，将不胜感激。下面的代码会将点击事件绑定到进度条，但它不会正确增加或减少，而且我的最大值似乎不起作用？

这是我所拥有的：

Javascript：

```
<head>

<link type="text/css" href="css/ui-lightness/jquery-ui-1.8.18.custom.css" rel="Stylesheet" />
<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.18.custom.min.js"></script>
<script type="text/javascript">
   $(document).ready(function() {
       $("#budgetbar").progressbar({ value: 0 });
       $(".option1").click(function () {
                     $("#budgetbar").progressbar({ value: 10 });

       });
       $(".option2").click(function () {
                     $("#budgetbar").progressbar({ value: 50 });

       });
           $(".option3").click(function () {
                     $("#budgetbar").progressbar({ value: 20 });

       });
       $(".option4").click(function () {
                     $("#budgetbar").progressbar({ value: 50 });

       });

   $("#budgetbar").progressBar({ max: 100, textFormat: 'fraction', callback: function(data) { if (data.running_value == data.value) { alert("Budget limit reached!"); } }} );

});
</script>

</head> 
```

HTML：

```
<body>

<div id="budgetbar"></div>  
<div>    
    <input type="checkbox" class="option1" />Expense 1 - $100,000<br />
    <input type="checkbox" class="option2" />Expense 2 - $500,000<br />
    <input type="checkbox" class="option3" />Expense 3 - $200,000<br />
    <input type="checkbox" class="option4" />Expense 4 - $500,000<br />
* Max Expenses - $1,000,000 
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:47:20.723

如果为`input`复选框分配值，则可以大大简化代码：

```
<input type="checkbox" class="option" value="10"/> Expense 1 - $100,000<br />
<input type="checkbox" class="option" value="50"/> Expense 2 - $500,000<br />
<input type="checkbox" class="option" value="20"/> Expense 3 - $200,000<br />
<input type="checkbox" class="option" value="50"/> Expense 4 - $500,000<br /> 
```

这样，您不必以不同的方式处理每个复选框。相反，您可以为所有选项使用***单个处理程序。***这使得调试和代码维护变得更加*简单*。

其次，随着每个选项的变化，您希望将*总值*分配给`progressbar`，而不仅仅是单击选项的值。使用`change`代替`click`，因为这只会在复选框更改其状态时触发。（细微差别，我知道）。

```
// The only handler you need:
$('.option').on('change', function() {
    // The total
    var total = 0;

    // Sum the value of all checked checkboxes
    $('.option:checked').each(function() {
        total += parseInt($(this).val());
    });

    // Assign the value using the correct method:
    $("#budgetbar").progressbar("value", total );
}); 
```

此外，您`progressBar`在通话中使用来设置参数（注意大写 B）。正确的名字是`progressbar`。

示例：http: [//jsfiddle.net/DjWCz/2/](http://jsfiddle.net/DjWCz/2/)

**HTML：（**注意类名更改和值添加）

```
<input type="checkbox" class="option" value="10"/> Expense 1 - $100,000<br />
<input type="checkbox" class="option" value="50"/> Expense 2 - $500,000<br />
<input type="checkbox" class="option" value="20"/> Expense 3 - $200,000<br />
<input type="checkbox" class="option" value="50"/> Expense 4 - $500,000<br /> 
```

**脚本：**

```
<script type="text/javascript">
    $("#budgetbar").progressbar({
        value: 0,
        max: 100,
        textFormat: 'fraction',
        complete: function(event, ui) {
            alert("Budget limit reached!");
        }
    });

    $('.option').on('change', function() {
        var total = 0;

        $('.option:checked').each(function() {
            total += parseInt($(this).val());
        });

        $("#budgetbar").progressbar("value", total );
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:36:25.930

您可以使用更改 jQuery UI 进度条的值

```
$("#budgetbar").progressbar("option", "value", 25); 
```

这只会将值设置为 25（不会增加 25）。要获得您可以使用的价值

```
$("#budgetbar").progressbar("option", "value"); 
```

你可能需要检查复选框是否被选中:-)

我会这样做（未经测试）

```
var $budgetbar = $("#budgetbar"); // It's no good to repeat selections
$(".option1").click(function () {
    var thisValue = 25, // This checkbox' value
        currentValue = $budgetbar.progressbar("option", "value"),
        newValue;
    if($(this).is(':checked')) {
        newValue = currentValue + thisValue; // add
    } else {
        newValue = currentValue - thisValue; // subtract
    }
    $budgetbar.progressbar("option", "value", newValue)
}); 
```

编辑，警报（可能有更好的方法）：

```
$budgetbar.bind("progressbarchange", function(event, ui) {
    var value = $budgetbar.progressbar("option", "value");
    if (value > 100) {
        alert("You're over 100");
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:51:18.490

尝试将进度条的值存储在变量上，这样您就可以增加或减少其值以进行正确的计算。

它会是这样的：

```
previousValue = 0;
$("#budgetbar").progressbar({ 
    value: 10+previousValue
}); 
```

此外，您需要检查复选框是否被选中，而不是使用“点击”事件。尝试这样的事情

```
if($('#checkboxId').is(':checked')) 
```

或者，当然，您需要在复选框中添加一个 id。

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T18:05:50.307

给你，希望对你有帮助。

干杯。

```
<script type="text/javascript">

    $( document ).ready( function()
    {
        $( "#budgetbar" ).progressbar();
    });

    var currentProgress = 0;

    function adjustProgress( checkbox )
    {
        if ( $( checkbox ).is( ":checked" ) )
        {
            currentProgress += parseInt( $( checkbox ).val() );
        }
        else
        {
            currentProgress -= parseInt( $( checkbox ).val() );
        }

        $( "#budgetbar" ).progressbar( "option" , "value" , currentProgress )

        if ( currentProgress > 100 )
        {
            alert( "You have exceeded the maximum value of 100" );
        }
    }
</script>

<div id="budgetbar"/>

<div>
    <input type="checkbox" class="option1" value="10" onclick="adjustProgress( this )"/>Expense 1 - $100,000<br/>
    <input type="checkbox" class="option2" value="50" onclick="adjustProgress( this )"/>Expense 2 - $500,000<br/>
    <input type="checkbox" class="option3" value="20" onclick="adjustProgress( this )"/>Expense 3 - $200,000<br/>
    <input type="checkbox" class="option4" value="50" onclick="adjustProgress( this )"/>Expense 4 - $500,000<br/>
    * Max Expenses - $1,000,000 
</div> 
```

# html - 在html中，如何制作变量，如何检查变量中是否存在某些东西

> ID：10046942
> 
> 赞同：0
> 
> 时间：2012-04-06T17:29:26.067
> 
> 标签：html

我正在为我的网站创建一个注册并登录，所以用户在注册中输入他们的信息然后他们可以登录，我想存储他们的信息，以便当他们在登录中输入他们的信息时，如果他们的信息存在，他们可以进入网站。这是我的注册代码的代码：

```
<form>
Name: <input type="text" name="Name/"><br/>
Email:<input tpye="email" name="Email"/><br/>
Password:<input type="password" name="Password"/><br/>
Gender:<br/>
<input type="radio" name="Gender"/>Male<br/>
<input type="radio" name="Gender"/>Female<br/>
<input type="submit" value="Submit"/>
</form> 
```

这是我的登录代码：

```
Name:<input type="text" name="name"><br/>
Password:<input type="password" name="password"><br/>
<input type="submit" value="Submit"> 
```

我还想确保用户输入所有需要的信息，比如姓名通行证和电子邮件。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T17:41:23.133

您不能仅使用 HTML 来做到这一点。您还需要一个服务器端脚本语言，如 php、asp、jsp 和一个数据库来存储数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:33:49.380

你想把数据存储在哪里？你需要一个像 MySQL 这样的数据库。您还需要像 PHP 这样的服务器端脚本语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T17:33:00.667

您不能在 HTML 中创建变量。您可能想研究 javascript 来做一些客户端脚本和 ajax 来联系服务器。

# python - PyQt 中的 QKeyPress 事件

> ID：10046945
> 
> 赞同：5
> 
> 时间：2012-04-06T17:29:36.557
> 
> 标签：python, qt, event-handling, pyqt, piano

我的软件有问题。在我的钢琴软件中，如果我一直按键盘上的一个键，那么它会为该特定键发出多个重复的相同音调。但实际上我需要一个单一的音调，直到释放那个特定的键。我提供了检测 keyPress 事件并调用相应方法的代码的一部分。那么我应该对我的代码进行哪些更改？

```
def keyPressEvent(self, event):
    if type(event) == QtGui.QKeyEvent and event.key() == QtCore.Qt.Key_A : 
        self.Playnote('/home/hemanth/hemanth/Piano/C.mp3')
        self.ui.pushButton.animateClick(100)
    if type(event) == QtGui.QKeyEvent and event.key() == QtCore.Qt.Key_S:
        self.Playnote('/home/hemanth/hemanth/Piano/D.mp3')
        self.ui.pushButton_2.animateClick(100) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T18:52:32.527

您应该检查[`event.isAutoRepeat()`](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qkeyevent.html#isAutoRepeat)以确定事件是由键盘自动重复还是实际按键引起的。如果是自动重复，请忽略该按。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-06T19:19:11.617

由于 keyPressEvent 将始终接收 QKeyEvent，因此您根本不需要检查它的类型。您已经可以从简化此示例开始：

```
def keyPressEvent(self, event):
    key = event.key()
    if key == QtCore.Qt.Key_A : 
        self.Playnote('/home/hemanth/hemanth/Piano/C.mp3')
        self.ui.pushButton.animateClick(100)
    elif key == QtCore.Qt.Key_S:
        self.Playnote('/home/hemanth/hemanth/Piano/D.mp3')
        self.ui.pushButton_2.animateClick(100) 
```

现在，就像你说的，每次按下一个键时，这只会触发你的声音。需要几个步骤才能获得所需的全部功能。

1.  `Playnote`需要能够保持循环直到被告知停止
2.  您需要保留对该`Playnote`对象的引用以便以后停止它
3.  keyReleaseEvent 必须使用`Playnote`引用来停止它

### 1）`Playnote`需要循环

如果您将 Phonon 用于此功能`Playnote`，则可以使用[文档建议的方法](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/phonon-mediaobject.html)。这会将媒体对象的`aboutToFinish`信号连接到一个方法，该方法将使同一媒体源的另一个版本入队。

它可能看起来像这样：

```
class Playnote(QtCore.QObject):

    def __init__(self, soundFile, parent=None):
        super(Playnote, self).__init__(parent)

        self._isStopped = True

        self.mediaSource = Phonon.MediaSource(soundFile)
        self.mediaObject = Phonon.MediaObject(self)
        self.audioOutput = Phonon.AudioOutput(Phonon.MusicCategory, self)
        Phonon.createPath(self.mediaObject, self.audioOutput)
        self.mediaObject.setCurrentSource(self.mediaSource)

        self.mediaObject.aboutToFinish.connect(self.doRequeue)

    def doRequeue(self):
        if not self._isStopped:
            self.mediaObject.enqueue(self.mediaSource)

    def play(self):
        self._isStopped = True
        # other code here

    def stop(self):
        self._isStopped = False
        # other code here 
```

您正在将该信号连接到一个方法，如果播放器没有停止，该方法将重新排列相同的声音。

### 2）需要一个`Playnote`对象

当您使用 keyPressEvent 启动声音时，您必须存储对正在播放的对象的引用。也许您可以创建一个字典，并将键映射到当前播放对象？

```
# in your class
self.keysPlaying = {}

def keyPressEvent(self, event):
    key = event.key()
    if key == QtCore.Qt.Key_A :
        c_note = Playnote('/home/hemanth/hemanth/Piano/C.mp3')
        self.keysPlaying['c'] = c_note 
```

### 3) keyReleaseEvent 停止`Playnote`对象

现在您已经开始并循环播放了您的声音，您可以稍后在 keyReleaseEvent 中使用该引用来停止它：

```
def keyReleaseEvent(self, event):
    key = event.key()
    if key == QtCore.Qt.Key_A :
        note = self.keysPlaying.get('c', None)
        if note:
            note.stop()
            self.keysPlaying['c'] = None 
```

# c++ - 只是试图调用一个库的函数

> ID：10046947
> 
> 赞同：0
> 
> 时间：2012-04-06T17:29:45.883
> 
> 标签：c++, ogg-theora

我在下面有这样的代码`/root_project/main.cpp`：

```
#include "theoraplayer/TheoraVideoClip.h"

unsigned int tex_id;
TheoraVideoManager* mgr;
TheoraVideoClip* clip;
std::string window_name="glut_player";
bool started=1;
int window_w=800,window_h=600;

void draw()
{
    glBindTexture(GL_TEXTURE_2D,tex_id);

    TheoraVideoFrame* f=clip->getNextFrame();   //this gives an error!!!
    if (f)
    { 
```

并且`TheoraVideoClip.h`文件在`/root_project/include/theoraplayer/`.

里面`TheoraVideoClip.h`是这样的：

```
TheoraVideoFrame* getNextFrame(); 
```

当我尝试使用编译时，我遇到了`g++ -o app main.cpp -lGL -lglut -lGLU` 这个错误：

> main.cpp:(.text+0xac2): 未定义对 `TheoraVideoClip::getNextFrame()' 的引用

有谁知道为什么？

Ubuntu 11.10

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:32:07.843

您还需要链接到`libtheoraplayer`.

# python - 在不使用外部模块的情况下将元数据写入 python 中的 mp3 文件

> ID：10046956
> 
> 赞同：0
> 
> 时间：2012-04-06T17:30:37.940
> 
> 标签：python

目前我正在尝试在**不**使用任何外部模块（如（eyed3）的情况下）的`read and write`mp3 标签。

 **我已使用以下代码成功读取 mp3 文件的音频标签：

```
f = open(filepath,"rb")
f.seek(-128,2)
TagContent = f.read(128)
f.close()

title = TagContent[3:33] # currently only id3v1 tags 
```

现在我想编辑`artistname,title,album`mp3 文件的音频标签等。现在面临的问题是如何将数据写入到特定位置的 mp3 文件中。

```
f = open(filepath,"wb")
f.write(**what should come here**) 
```

这是否可能仅使用 python 或我必须使用`external module`将内容写入 mp3 文件。

在上面的陈述`external module`中指的是像`pymedia`或`GST-Python`（*我什至不知道这些是否是这个任务的正确模块*）这样的模块，而不是像 eyed3 这样的音频标记模块。

PS：这只是学习过程的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:40:48.547

使用 seek 选择位置并写入，从该位置写入文本。不要忘记关闭文件:)**

# mysql - 计算两个不同的列

> ID：10046959
> 
> 赞同：8
> 
> 时间：2012-04-06T17:30:43.487
> 
> 标签：mysql, sql, count

所以我的数据库中有这张表

```
Item    Cat1    Cat2
--------------------
Aaa     Red     Used
Aaa     Blu     Used
Bbb     Gre     New
Bbb     Blu     New
Ccc     Gre     New
Ddd     Blu     Used 
```

我想显示一列中有多少*项*是*红色*的，另一列中有多少项是*新*的，如下所示：

```
Item    Red     New
-------------------
Aaa     1       0
Bbb     0       2
Ccc     0       1
Ddd     0       0 
```

我知道如何在两个表格中显示它们，但不知道如何组合它们。

```
$query = mysql_query("SELECT *, count(Item) AS CountItem FROM Table WHERE Cat1 = 'Red' GROUP BY Item");
$query2 = mysql_query("SELECT *, count(Item) AS CountItem2 FROM Table WHERE Cat2 = 'New' GROUP BY Item");

while($row = mysql_fetch_array($query) AND $row2 = mysql_fetch_array($query2))
  {
  echo $row['CountItem'] . " " . $row2['CountItem2'] . " " . $row['Item'];
  echo "<br>";
  } 
```

这似乎不起作用，因为这仅显示标记为 Aaa 的*项目*，我无法理解我在这里做错了什么。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-06T17:34:35.367

这是一份工作`SUM(CASE)`：

```
SELECT 
  Item,
  SUM(CASE WHEN Cat1 = 'Red' THEN 1 ELSE 0 END) AS Red,
  SUM(CASE WHEN Cat2 = 'New' THEN 1 ELSE 0 END) AS New
FROM Table
GROUP BY Item 
```

这里的想法是，对于所有`Red`行，您分配一个 1（其他人得到一个 0），然后将这些 1 和 0 相加得到计数。`New`价值观也是一样。

您也可以通过利用 MySQL 的 0/1 布尔评估更简洁地做同样的事情：

```
SELECT 
  Item,
  SUM(Cat1 = 'Red') AS Red,
  SUM(Cat2 = 'New') AS New
FROM Table
GROUP BY Item 
```

在此示例中，`Cat1 = 'Red'`如果为真，将返回 1，然后将它们相加。`SUM(CASE)`尽管其他系统以不同的方式处理它们的布尔值，但该方法将在 MySQL 以外的 RDBMS 中更易于移植。

### 编辑：

只是为了澄清一下，在 PHP 中，您将检索这些作为`$row['Red']`和`$row['New']`. 您可以将别名更改为您需要的任何内容：`AS Red`以`AS CountItem`匹配您的原始...

```
while($row = mysql_fetch_array($query) AND $row2 = mysql_fetch_array($query2)) {
  echo $row['Red'] . " " . $row2['New'] . " " . $row['Item'];
  echo "<br>";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:36:22.213

```
SELECT
  Item, 
  SUM(CASE WHEN Cat1 = 'Red' THEN 1 ELSE 0 END)  AS Red,
  SUM(CASE WHEN Cat2 = 'New' THEN 1 ELSE 0 END)  AS New,
FROM 
  Table 
GROUP BY
  Item 
```

# mysql - 使用什么软件从 MySQL DB 生成格式化的装箱单？

> ID：10046965
> 
> 赞同：0
> 
> 时间：2012-04-06T17:31:13.463
> 
> 标签：mysql, invoice, packing

我需要从 MySQL 数据库生成格式化（特别是样式）装箱单。我们是一家与互联网公司整合的履行机构。

# python - 如何将摩根定律应用于解析字符串？（转换字符串或使用解析操作）

> ID：10046967
> 
> 赞同：1
> 
> 时间：2012-04-06T17:31:16.877
> 
> 标签：python, logic, pyparsing, demorgans-law

我正在尝试使用语义三方法评估命题逻辑公式是有效还是无效的程序。

我设法评估了一个公式是否格式正确：

```
from pyparsing import *
from string import lowercase

def fbf():

    atom = Word(lowercase, max=1) #alfabeto minusculas
    op = oneOf('^ V => <=>') #Operadores
    identOp = oneOf('( [ {')
    identCl = oneOf(') ] }')
    form = Forward() #Iniciar de manera recursiva
    #Gramatica
    form << ( (Group(Literal('~') + form)) | ( Group(identOp + form + op + form + identCl) ) | ( Group(identOp + form + identCl) ) | (atom) )

    return form

#Haciendo todo lo que se debe
entrada = raw_input("Entrada: ")
try:
    print fbf().parseString(entrada, parseAll=True)
except ParseException as error: #Manejando error
    print error.markInputline()
    print error
print 
```

现在我需要根据Monrgan定律转换否定的forumla〜（form），摩根定律的BNF是这样的：

```
~((form) V (form)) = (~(form) ^ ~(form))
~((form) ^ (form)) = (~(form) V ~(form)) 
```

[http://en.wikipedia.org/wiki/De_Morgans_laws](http://en.wikipedia.org/wiki/De_Morgans_laws)

解析必须是递归的；我正在阅读有关 Parseactions 的内容，但我真的不明白我是 python 新手并且非常不熟练。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:03:12.677

胡安·何塞——

无论您是否意识到，您都要求这些观众做很多工作。以下是有关如何在此问题上取得进展的一些建议：

*   认识到解析输入只是整个程序的第一步。您不能只编写任何通过输入的解析器，然后声明自己已为下一步做好准备。您需要预测您将如何处理已解析的输出，并尝试以这样一种方式解析数据，以便您准备好采取下一步 - 在您的情况下，您需要进行一些逻辑转换以应用德摩根定律。事实上，你可能最好向后工作 - 假设你有一个解析器，你需要你的转换代码来处理什么，表达式看起来如何，以及你将如何执行转换本身？这将自然地构建您对应用程序域的思考，并在您开始编写解析器时为您提供目标结果格式。

*   当您开始编写解析器时，请查看执行类似任务的其他 pyparsing 示例，例如 pyparsing wiki 上的 SimpleBool.py。看看他们如何解析输入以创建一组可评估对象，然后可以在应用程序域中对其进行操作（无论是评估它们、转换它们还是其他）。考虑一下您希望在解析器中创建什么样的对象，这些对象将与您在上一步中概述的转换方法一起使用。

*   花时间为您将解析的语法编写 BNF。写出一些您将解析的示例测试字符串，以帮助您预测语法问题。“~~p ^ q V r”是一个有效的字符串吗？标识符可以是多个字符，还是仅限于单个字符（单个字符在开始时更容易使用，以后可以轻松扩展）？如果可以，请保持语法简单，例如仅支持 () 进行分组，而不是任何匹配的 ()、[] 或 {} 对。

*   当您实现解析器时，首先从简单的测试用例开始，然后逐步进行。如果您发现您在早期就做出了一些更复杂的字符串不支持的假设，您可能不得不回溯一点，但这对于大多数编程项目来说是非常典型的。

*   作为实现技巧，请阅读使用 operatorPrecedence 帮助器，因为它是专门为这些类型的解析作业而设计的。看看它是如何在 SimpleBool.py 中用于创建反映输入字符串结构的对象层次结构的。然后想想对象在你的转换过程中会做什么。

祝你好运！

# delphi - 右对齐delphi stringgrid列但保持主题drawingstyle

> ID：10046969
> 
> 赞同：2
> 
> 时间：2012-04-06T17:31:22.603
> 
> 标签：delphi, delphi-2010, tstringgrid

我将 delphi 2010 用于带有 stringgrid 的项目。我希望网格的某些列是右对齐的。[我了解如何](https://stackoverflow.com/questions/4720255/ondrawcell-center-text-stringgrid-delphi)通过将 defaultdrawing 设置为 false 来做到这一点。

但是，如果可能的话，我想为网格保留运行时主题着色。有没有办法在启用 defaultdrawing 的情况下右对齐列，或者至少复制 onDrawCell 事件中的代码以模仿运行时主题着色？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-07T03:15:52.487

您可以使用插入器类并覆盖 DrawCell 方法，请查看此示例

```
type
  TStringGrid = class(Grids.TStringGrid)
   protected
    procedure DrawCell(ACol, ARow: Longint; ARect: TRect; AState: TGridDrawState); override;
  end;    

  TForm79 = class(TForm)
    StringGrid1: TStringGrid;
    procedure FormCreate(Sender: TObject);
  private
  end;

var
  Form79: TForm79;

implementation

{$R *.dfm}

{ TStringGrid }

procedure TStringGrid.DrawCell(ACol, ARow: Integer; ARect: TRect; AState: TGridDrawState);
var
  s : string;
  LDelta : integer;
begin
  if (ACol=1) and (ARow>0) then
  begin
    s     := Cells[ACol, ARow];
    LDelta := ColWidths[ACol] - Canvas.TextWidth(s);
    Canvas.TextRect(ARect, ARect.Left+LDelta, ARect.Top+2, s);
  end
  else
  Canvas.TextRect(ARect, ARect.Left+2, ARect.Top+2, Cells[ACol, ARow]);
end;

procedure TForm79.FormCreate(Sender: TObject);
begin
  StringGrid1.Cells[0,0]:='title 1';
  StringGrid1.Cells[1,0]:='title 2';
  StringGrid1.Cells[2,0]:='title 3';

  StringGrid1.Cells[0,1]:='normal text';
  StringGrid1.Cells[1,1]:='right text';
  StringGrid1.Cells[2,1]:='normal text';
end; 
```

结果

![在此处输入图像描述](../Images/57c0ae156f8f9a11db1ebbe882054dcf.png)

# javascript - MSIE 为 Ajax 请求返回状态码 1223

> ID：10046972
> 
> 赞同：17
> 
> 时间：2012-04-06T14:25:23.863
> 
> 标签：javascript, ajax, internet-explorer, xmlhttprequest

我正在使用 ajax 请求（POST 方法）提交表单，并检查响应中的 HTTP 状态代码以查看它是否成功。

它在 Firefox 上运行良好，但在 MSIE-8 上当然不行。提交实际上工作正常，我可以检查我的服务器并确认提交工作并且服务器以状态码 204 响应。同样，firefox 正确地从请求对象中给了我 204 的状态码，但 IE 给出了一个状态码1223 个。

任何想法如何在 MSIE 中获得准确的状态代码？提交表单并检查响应的代码如下。

```
 var req = new XMLHttpRequest();
    req.open("POST", "p.php?i=" + self.__isid, true);
    //Send the proper header information along with the request
    req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    req.setRequestHeader("Content-length", formdata.length);
    req.setRequestHeader("Connection", "close");

    req.onreadystatechange = function()
    {
        if(req.readyState == 4)
        {
            if(req.status == 204 || req.status == 200)
            {
                //Success. Update the feed.
                self.__postFeed.update();
                self.__form.reset();
            }
            else
            {
                //TODO: Better error handling.
                alert("Error submitting post:\n" + req.responseText);
            }
        }
    }
    req.send(formdata); 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-06T17:53:59.447

> MSXML HTTP 中的 XMLHTTPRequest 实现（至少在 Windows XP SP3+ 上的 IE 8.0 中）不能正确处理状态代码为 204（无内容）的 HTTP 响应；`status' 属性的值为 1223。

这是一个已知的错误，大多数基于 javascript 的框架都会处理这种情况，并将 IE 中的 1223 标准化为 204

所以你的问题的解决方案是这样的

```
// Normalize IE's response to HTTP 204 when Win error 1223.
status : (conn.status == 1223) ? 204 : conn.status,
// Normalize IE's statusText to "No Content" instead of "Unknown".
statusText : (conn.status == 1223) ? "No Content" : conn.statusText 
```

**参考：**

道场 - [http://trac.dojotoolkit.org/ticket/2418](http://trac.dojotoolkit.org/ticket/2418)

原型 - [https://prototype.lighthouseapp.com/projects/8886/tickets/129-ie-mangles-http-response-status-code-204-to-1223](https://prototype.lighthouseapp.com/projects/8886/tickets/129-ie-mangles-http-response-status-code-204-to-1223)

YUI - [http://developer.yahoo.com/yui/docs/connection.js.html](http://developer.yahoo.com/yui/docs/connection.js.html) (handleTransactionResponse)

jQuery - [http://bugs.jquery.com/ticket/1450](http://bugs.jquery.com/ticket/1450)

ExtJS - [http://www.sencha.com/forum/showthread.php?85908-FIXED-732-Ext-doesn-t-normalize-IE-s-crazy-HTTP-status-code-1223](http://www.sencha.com/forum/showthread.php?85908-FIXED-732-Ext-doesn-t-normalize-IE-s-crazy-HTTP-status-code-1223)

# mono - Ironpython 问题

> ID：10046983
> 
> 赞同：0
> 
> 时间：2012-04-06T17:32:30.243
> 
> 标签：mono, ironpython

我有几个问题，我希望我们所有人都能清楚地了解这一点。首先，ironpython 的最新版本具有在移动平台上运行的特点，突出显示在单声道/android 上它运行得最好，而在 IOS 和 Windows 手机等其他平台上运行得不太好。那么这是否意味着不必使用 SL4A？我可以说 monodroid 挂钩到 android 的核心功能，因此可能会在 android 上提供更强大的应用程序访问/实现/再现？

接下来，我只想确定这一点：与 python 一样，您可以使用 Ironpython 创建完整的桌面应用程序，对吗？因为无处不在（几乎）我看到 Ironpython，他们将其称为脚本工具，以及如何编写 excel 等方面的脚本，这促使我提出这样的问题。有人说使用 Ironpython 编写的应用程序的速度不是那么好，我在争论为什么那些说话的人持有这种观点，而没有人能说出任何有价值的话。

最后，随着 Novell 和 xamarin 的发展，我不明白 mono 在他们的发布计划中的位置。我有一个 mac，我安装了最新版本的 mono，当我输入 ipy 时，我看到了 mono 1.1.0 或类似的东西。有没有人知道它发生了什么。

我从学习 Ironpython 开始爱上了 python，我认为 Ironpython 的概念是纯粹的光彩，可惜微软推崇 F#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:12:17.407

首先，为了将来参考，多个问题确实应该是多个问题。:)

在适用于 Android 的 IronPython 上：它比在其他平台上工作得稍微好一些（现在根本不能工作*）*，但它仍然是非常非常早期的代码。您可以做的事情有一些限制（主要是，您不能从动态代码继承 Java 类）。这是非常实验性的。

在桌面应用程序上：您绝对可以在 IronPython 中编写完整的应用程序。有[一些示例](https://github.com/jdhardy/IronPythonSamples)显示了它是如何完成的。特别是 PyWpfSample 和 PyGtkSample。启动时间不是很长，但对于大多数 GUI 应用程序来说，实际运行时间应该没问题。

# c# - LINQ 和参考列表的问题

> ID：10046991
> 
> 赞同：4
> 
> 时间：2012-04-06T17:33:07.593
> 
> 标签：c#, linq, linq-to-sql

我有以下 LINQ 代码

```
var q = (from web in DataContext.Webs select web);
List<int?> k1 = new List<int?>() { 1, 2 };
List<int?> k2=new List<int?>() { 16, 17 };
            q = q.Where(web => DataContext.WebTechMaps.Any(t => t.WebsiteId == web.WebsiteId && k1.Contains(t.TechId)));
            System.Diagnostics.Debug.WriteLine(q.Count());
            k1 = k2;
            q = q.Where(web => DataContext.WebTechMaps.Any(t => t.WebsiteId == web.WebsiteId && k1.Contains(t.TechId)));
            System.Diagnostics.Debug.WriteLine(q.Count()); 
```

这是它生成的查询。

第一次执行计数。

```
SELECT COUNT(*) AS [value]
FROM [dbo].[Web] AS [t0]
WHERE EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [dbo].[WebTechMap] AS [t1]
    WHERE ([t1].[WebsiteId] = ([t0].[WebsiteId])) AND ([t1].[TechId] IN (@p0, @p1))
    )
-- @p0: Input Int (Size = -1; Prec = 0; Scale = 0) [1]
-- @p1: Input Int (Size = -1; Prec = 0; Scale = 0) [2] 
```

第二次执行计数功能

```
SELECT COUNT(*) AS [value]
FROM [dbo].[Web] AS [t0]
WHERE (EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [dbo].[WebTechMap] AS [t1]
    WHERE ([t1].[WebsiteId] = ([t0].[WebsiteId])) AND ([t1].[TechId] IN (@p0, @p1))
    )) AND (EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [dbo].[WebTechMap] AS [t2]
    WHERE ([t2].[WebsiteId] = ([t0].[WebsiteId])) AND ([t2].[TechId] IN (@p2, @p3))
    ))
-- @p0: Input Int (Size = -1; Prec = 0; Scale = 0) [16]
-- @p1: Input Int (Size = -1; Prec = 0; Scale = 0) [17]
-- @p2: Input Int (Size = -1; Prec = 0; Scale = 0) [16]
-- @p3: Input Int (Size = -1; Prec = 0; Scale = 0) [17] 
```

请看一下传递给查询的参数。

似乎它对两个表达式都使用了新的引用对象。

@p0 和 @p1 不知何故改变了它们的旧值。我知道问题出在 Linq 中，它使用了新的引用对象。

```
-- @p0: Input Int (Size = -1; Prec = 0; Scale = 0) [1]
-- @p1: Input Int (Size = -1; Prec = 0; Scale = 0) [2]

-- @p0: Input Int (Size = -1; Prec = 0; Scale = 0) [16]
-- @p1: Input Int (Size = -1; Prec = 0; Scale = 0) [17]
-- @p2: Input Int (Size = -1; Prec = 0; Scale = 0) [16]
-- @p3: Input Int (Size = -1; Prec = 0; Scale = 0) [17] 
```

有人可以解释如何使用相同名称的 List 对象，但使用正确的 List 保持查询

所需的输出是

```
-- @p0: Input Int (Size = -1; Prec = 0; Scale = 0) [1]
-- @p1: Input Int (Size = -1; Prec = 0; Scale = 0) [2]
-- @p2: Input Int (Size = -1; Prec = 0; Scale = 0) [16]
-- @p3: Input Int (Size = -1; Prec = 0; Scale = 0) [17] 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T17:37:25.040

您的第一个查询表达式使用`k1`. 它使用*变量* `kl`，这就是捕获的内容。当您更改 的值时`k1`，这实际上改变了查询的含义。如果您不想更改查询的含义，请不要更改捕获的变量！只需`k2`在您的第二个过滤器中使用：

```
var q = (from web in DataContext.Webs select web);
List<int?> k1 = new List<int?>() { 1, 2 };
List<int?> k2=new List<int?>() { 16, 17 };
q = q.Where(web => DataContext.WebTechMaps
                              .Any(t => t.WebsiteId == web.WebsiteId && 
                                        k1.Contains(t.TechId)));
System.Diagnostics.Debug.WriteLine(q.Count());
q = q.Where(web => DataContext.WebTechMaps
                              .Any(t => t.WebsiteId == web.WebsiteId &&
                                   k2.Contains(t.TechId)));
System.Diagnostics.Debug.WriteLine(q.Count()); 
```

# iphone - NSMutableArray 崩溃应用

> ID：10046992
> 
> 赞同：0
> 
> 时间：2012-04-06T17:33:10.830
> 
> 标签：iphone, objective-c, ios, crash, nsmutablearray

在一个类中，我`NSMutableArray`用 getter 和 setter 定义了一个：

```
@interface ArrayClass : NSObject {
    NSMutableArray *array;
}
@property (nonatomic, strong) NSMutableArray *array;

@end 
```

然后在实现文件中，我`alloc` `init`是可变数组：

```
#import "ImageUploader.h"

@implementation ArrayClass
@synthesize array;

- (id)init {
    self = [super init];
    if (self != nil) {
        NSLog(@"ArrayClass inited");
        array = [[NSMutableArray alloc] init];
    }
    return self;
}

@end 
```

然后我从另一个类初始化这个类的一个实例：

```
ArrayClass *arrayClass = [[ArrayClass alloc] init];
                [arrayClass.array addObject:image];
                NSUInteger count = [arrayClass.array count];
                NSLog(@"%@", count); 
```

但是当我尝试将对象添加到可变数组时，应用程序崩溃并且 Xcode 4.3 显示： ![在此处输入图像描述](../Images/c7dfb6ddfa890ee3ce0bb20d49b0788e.png)

删除`addObject`呼叫使应用程序运行良好。我做错了什么会导致应用程序崩溃？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T17:39:52.827

这是错误的：

```
NSUInteger count = [arrayClass.array count];
NSLog(@"%@", count); 
```

你要：

```
NSLog(@"%u", count); 
```

`%@`用于指定参数是一个对象。然而，一个 NSUInteger 是一个原始值，而不是一个对象。您`%u`用于无符号整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T17:37:21.450

尝试：

```
NSLog(@"%i", count); 
```

NSUInteger 返回一个 INT 而不是一个对象地址

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:38:58.130

```
NSLog(@"%@", count); 
```

错了，用：

```
NSLog(@"%i", count); 
```

`%@`在格式语句中期望并且必须是一个对象，`NSUInteger`在 int 中，而不是一个对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-06T17:49:37.637

您正在使用`%@`格式说明符，它仅适用于 Cocoa 对象，用于 an `NSUInteger`，它是普通`unsigned int`. 请改用 %d、%i 或 %u。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T17:40:51.383

在我看来，它在尝试打印描述时崩溃了，这是有道理的，因为您`%@`在`NSLog()`.

另外，使用可变属性几乎总是一个坏主意。如果它真的是一个属性，您可能想要使用一个不可变数组，并在您想要更改它时设置整个数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-06T17:43:55.643

同意计数的记录是错误的，但我认为其他答案错过了一个明显的点：崩溃发生在 addObject 上。这意味着 image 为零。NSLog 表示之前添加。