# StackOverflow 问答 000186000-000186999

# c++ - 当程序使用 C++ 在 Windows 中运行时，我如何监听/识别？

> ID：186004
> 
> 赞同：1
> 
> 时间：2008-10-09T05:28:33.060
> 
> 标签：c++, windows, events, listen

具体来说，我想听听程序何时运行并记录以下信息：时间戳、可执行文件、Windows 名称和用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T06:33:31.167

或者，使用 WMI 界面找出正在运行的内容并采取适当的措施。在下面的 VBScript 代码中，正在查询 WMI 子系统`Select * from Win32_Process`以更改进程优先级。找出可用的其他属性`Win32_Process`，您应该找到朝着您想要的方向前进的东西。

```
Const NORMAL_PRIORITY = 32
Const LOW_PRIORITY = 64
Const REALTIME_PRIORITY = 128
Const HIGH_PRIORITY = 256
Const BELOWNORMAL_PRIORITY = 16384
Const ABOVENORMAL_PRIORITY = 32768

Function SetPriority( sProcess, nPriority )
    Dim sComputer
    Dim oWMIService
    Dim cProcesses
    Dim oProcess
    Dim bDone

    bDone = False
    sComputer = "."
    Set oWMIService = GetObject("winmgmts:\\" & sComputer & "\root\cimv2")

    Set cProcesses = oWMIService.ExecQuery ("Select * from Win32_Process Where Name = '" & sProcess & "'")
    For Each oProcess in cProcesses
        oProcess.SetPriority( nPriority )
        bDone = True        
    Next
    SetPriority = bDone
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T09:02:20.400

这样做最淫秽的方式是谷歌桌面方式
，即让您的 DLL 加载到曾经启动的每个进程中并记录信息。
如果您更感兴趣，请安装 google 桌面并观察其 dll 加载到您的进程中。然后在注册表中查看它是否执行此操作。
请注意，这正在进入类似病毒的行为领域。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T14:11:38.730

您可以设置 WMI 永久事件订阅来监视进程创建并记录详细信息。我[这里](http://www.codeproject.com/KB/system/PermEvtSubscriptionMOF.aspx)有一些示例- 其中一个示例监视 notepad.exe 创建并将事件记录在 txt 文件中。永久事件订阅“始终”监视事件，但如果您想“在应用程序的持续时间内”监视事件，则可以使用带有 C++ 的 WMI COM API - WQL 事件查询在两种情况下都是相同的。文档在[这里](http://msdn.microsoft.com/en-us/library/aa393015(VS.85).aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T10:41:47.437

我会使用 PSAPI 函数[EnumProcesses](http://msdn.microsoft.com/en-us/library/ms682629(VS.85).aspx) () 来定期获取正在运行的进程列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T05:30:18.453

研究使用 Perfmon API（查看 MSDN 以获取参考）。

# linux - 在文件中递归查找字符串/正则表达式匹配的最佳方法是什么？(UNIX)

> ID：186015
> 
> 赞同：32
> 
> 时间：2008-10-09T05:31:27.063
> 
> 标签：linux, unix, recursion, grep

我不得不多次这样做，通常是在尝试查找在哪些文件中使用了变量或函数时。

我记得过去使用 xargs 和 grep 来做到这一点，但我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-09T05:33:55.873

```
grep -r REGEX . 
```

替换`.`为您要从中搜索的任何目录。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-08T20:41:19.630

这样做的便携式方法*是

```
find . -type f -print0 | xargs -0 grep pattern 
```

`-print0`告诉 find 使用 ASCII nuls 作为分隔符并`-0`告诉 xargs 同样的事情。如果您不使用它们，您将在名称中包含空格的文件和目录上遇到错误。

* 与 grep -r、grep -R 或 grep --recursive 相对，后者仅适用于某些机器。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-09T10:36:31.427

这是我开始使用**ack** ( [http://petdance.com/ack/](http://petdance.com/ack/) ) 代替**grep**的情况之一。从该站点，您可以获得将其安装为 Perl CPAN 组件的说明，或者您可以获得无需处理依赖关系即可安装的独立版本。

除了默认为递归搜索这一事实外，它还允许您使用 Perl 强度的正则表达式、使用正则表达式来选择要搜索的文件等。它有一个令人印象深刻的选项列表。我建议访问该网站并检查一下。我发现它非常易于使用，如果您使用它，还有一些技巧可以将它与 vi(m)、emacs 甚至 TextMate 集成。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-09T13:54:43.850

如果您正在寻找字符串匹配，请使用

```
fgrep -r pattern . 
```

这比使用 grep 更快。更多关于这里的主题：[http ://www.mkssoftware.com/docs/man1/grep.1.asp](http://www.mkssoftware.com/docs/man1/grep.1.asp)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T05:37:55.507

grep -r 如果您使用的是大多数 Linux 发行版附带的 GNU grep。

在大多数 UNIX 上，默认情况下没有安装它，所以试试这个：

寻找 。-类型 f | xargs grep 正则表达式

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-09T05:47:15.487

如果您使用 zsh shell，您可以使用

```
grep REGEX **/* 
```

或者

```
grep REGEX **/*.java 
```

如果匹配的文件太多，这可能会失去动力。

不过，规范的方法是将 find 与 exec 一起使用。

```
find . -name '*.java' -exec grep REGEX {} \; 
```

或者

```
find . -type f -exec grep REGEX {} \; 
```

'type f' 位仅表示文件类型，将匹配所有文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T13:49:42.597

我建议将答案更改为：

`grep REGEX -r .`

-r 开关不表示正则表达式。它告诉 grep 递归到提供的目录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-29T22:19:13.123

这是使用一种或多种文件类型递归查找精确表达式的好方法：

`find . \\( -name '\''*.java'\'' -o -name '\''*.xml'\'' \\) | xargs egrep` （内部单引号）

在哪里

`-name '\''*.<filetype>'\'' -o` （这里再次单引号）

is repeated in the parenthesis ( ) for how many more filetypes you want to add to your recursive search

an alias looks like this in bash

`alias fnd='find . \\( -name '\''*.java'\'' -o -name '\''*.xml'\'' \\) | xargs egrep'`

# javascript - 你如何在 JavaScript 中解释这种结构？

> ID：186024
> 
> 赞同：15
> 
> 时间：2008-10-09T05:35:49.130
> 
> 标签：javascript, design-patterns, anonymous-function

```
(function() 
 {
     //codehere
 }
)(); 
```

这种语法有什么特别之处？()() 是什么意思？意味着？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-09T05:39:12.400

创建一个匿名函数，闭包和所有，最后的 () 告诉它自己执行。

它与以下内容基本相同：

```
function name (){...}
name(); 
```

所以基本上这段代码没有什么特别之处，它只是一个创建方法并调用它而不必命名它的“快捷方式”。

这也意味着该函数是一次性的，或者是对象上的内部函数，并且在您需要闭包的特性时最有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T12:32:11.443

这是一个被调用的匿名函数。

这样做的目的是创建一个新的范围，局部变量不会从中流出。例如：

```
var test = 1;
(function() {
  var test = 2;
})();
test == 1 // true 
```

关于这种语法的一个重要注意事项是，如果您还没有这样做，您应该养成使用分号结束语句的习惯。这是因为 Javascript 允许在调用函数名和括号之间换行。

下面的代码段将导致错误：

```
var aVariable = 1
var myVariable = aVariable

(function() {/*...*/})() 
```

这是它实际在做的事情：

```
var aVariable = 1;
var myVariable = aVariable(function() {/*...*/})
myVariable(); 
```

创建新块作用域的另一种方法是使用以下语法：

```
new function() {/*...*/} 
```

不同之处在于，前一种技术不会影响关键字“this”指向的位置，而第二种会影响。

Javascript 1.8 也有一个 let 语句来完成同样的事情，但不用说，大多数浏览器都不支持它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T05:39:53.100

那是一个自我执行的匿名函数。最后的 () 实际上是调用函数。

一本解释 Javascript 中这些类型语法的一些用法的好书（我读过）是[Object Oriented Javascript](https://rads.stackoverflow.com/amzn/click/com/1847194141)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T06:44:55.963

这种用法基本上等同于 C 中的内部块。它防止在块内定义的变量*在*外部可见。*因此，这是一种使用*私有对象构建一次性类的便捷方式。只是不要忘记`return this;`如果你用它来构建一个对象。

```
var Myobject=(function(){
    var privatevalue=0;
    function privatefunction()
    {
    }
    this.publicvalue=1;
    this.publicfunction=function()
    {
        privatevalue=1; //no worries about the execution context
    }
return this;})(); //I tend to forget returning the instance
                  //if I don't write like this 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T14:02:13.473

另请参阅 Douglas Crockford 的优秀作品“JavaScript：The Good Parts”，可从 O'Reilly 获得，请点击此处：

[http://oreilly.com/catalog/9780596517748/](http://oreilly.com/catalog/9780596517748/)

... 以及 YUIblog 上的视频，在这里：

[http://yuiblog.com/blog/2007/06/08/video-crockford-goodstuff/](http://yuiblog.com/blog/2007/06/08/video-crockford-goodstuff/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T05:44:19.940

第一组括号中的内容计算为一个函数。第二组括号然后执行此功能。所以如果你有一些东西想在加载时自动运行，这就是你让它加载和执行的方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T13:47:17.220

[John Resig 在此处解释自执行匿名函数](http://books.google.co.uk/books?id=GgJN2CC_2s4C&pg=PA29&lpg=PA29&dq=John+resig+self+executing+anonymous+function&source=web&ots=7w-ceWchMH&sig=oLWUghev2PlbhBU0DXyw2i8fzM8&hl=en&sa=X&oi=book_result&resnum=1&ct=result#v=onepage&q&f=false)。

# jquery - 是否可以打印被 jQuery 的“slideUp”功能隐藏的 DIV

> ID：186035
> 
> 赞同：7
> 
> 时间：2008-10-09T05:40:21.493
> 
> 标签：jquery, css

我有一个简单的“手风琴”类型页面，其中包含 H3 标题和 DIV 内容框列表（每个 H3 后跟一个 DIV）。在此页面上，我从隐藏所有 DIV 开始。当单击 H3 时，直接在下方（之后）的 DIV 使用 jQuery 的[“slideDown”](http://jquery.com/api/#slideDown)功能显示，而所有其他 DIV 使用[“slideUp”](http://jquery.com/api/#slideUp)功能隐藏。

“slideUp”函数将以下内联样式插入指定的 DIV：

```
style="display: none;" 
```

我想知道是否有任何方法可以让我在用户打印页面时显示所有展开的 DIV（就像我在用户禁用 JavaScript 时所做的那样）。

我认为这是不可能的，因为内联样式总是优先于任何其他样式声明。

还有其他解决方案吗？

**解决方案**

[Sugendran 的解决方案](https://stackoverflow.com/questions/186035/is-it-possible-to-print-a-div-that-is-hidden-by-jquerys-slideup-function#186189)很棒，可以在我测试过的浏览器（FF2、IE7 和 IE6）中运行。我不知道有什么方法可以覆盖内联样式，我很确定这是我以前查过的东西，所以很高兴找到。我也看到[这里有关于这个的答案](https://stackoverflow.com/questions/104485/is-there-a-way-to-force-a-style-to-a-div-element-which-already-has-a-style-attr#104499)。我希望搜索在这里不那么难导航:-)。

[Lee Theobald 的解决方案](https://stackoverflow.com/questions/186035/is-it-possible-to-print-a-div-that-is-hidden-by-jquerys-slideup-function#186276)很棒，但“slideUp”功能添加了 style="display:none;" 少量。

[我的解决方案](https://stackoverflow.com/questions/186035/is-it-possible-to-print-a-div-that-is-hidden-by-jquerys-slideup-function#186036)工作正常，但是当 !important 声明有效时就过分了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T06:49:09.637

您可以在 CSS 中使用 !important 子句。这将覆盖内联样式。

因此，如果您设置打印媒体样式表 - 您可以执行类似的操作

```
div.accordian { display:block !important; } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T07:37:37.090

我个人会以不同的方式做到这一点。与其让 JQuery 添加内联样式，不如让它添加一个类呢？

```
<div class="closed">...</div> 
```

然后你可以有两个样式表：一个用于屏幕，一个用于打印：

```
<link href="screen.css" rel="stylesheet" type="text/css" media="screen,projection"/>
<link href="print.css" rel="stylesheet" type="text/css" media="print"/> 
```

在您的 screen.css 中，您将定义关闭...

```
div.closed { display: none; } 
```

但是在你的 print.css 中你不会（或者你会忽略显示：无）。这样，当打印所有 div 时，所有 div 都会被展开，但在屏幕上，它们会被关闭。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-22T15:17:16.443

将手风琴内的所有元素“显示为块”将覆盖里面的所有 div。

`#accordion > *{ display:block !important; }`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T05:40:30.697

是的。

在加载时向所有相关的 DIV 添加一个类（例如“hideme”），如下所示：

```
$('div#accordion> div').addClass('hideme'); 
```

*NB：这意味着当 JavaScript 被禁用时，手风琴会很好地降级。*

通过这种方式，您可以让常规样式表指定“hideme”类，如下所示：

```
.hideme { display: none; } 
```

虽然您的打印样式表可以像这样指定“hideme”类：

```
div.hideme { display: block; } 
```

接下来，在添加到每个 H3 的“单击”功能中，在向上滑动 DIV 后，添加“hideme”类，然后从每个向上滑动的 DIV 中删除“样式”属性。

整个 jQuery 看起来像这样：

```
<script type="text/javascript">
 //<![CDATA[
    $(function() {
        $('#accordion> div').addClass('hideme');

        $('#accordion> h3').click(function() {
          $(this).next('div:hidden').slideDown('fast').siblings('div:visible').slideUp('fast', function(){ $('#accordion> div:hidden').addClass('hideme').removeAttr('style'); });

      });
    });
 //]]>
</script> 
```

注意需要在 slideUp 函数中包含函数回调，以便在 DIV 向上滑动并且 jQuery 添加了“style=display:none;”之后发生样式和类的更改。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-02T02:02:22.583

{ 显示：块！重要；在 FF 中工作，但我在某处读到它不适用于 ie6。是否没有用于打印的 javascript 事件？我记得以前广泛寻找一个但找不到一个，这似乎很疯狂，这似乎不存在，js似乎知道浏览器内何时发生其他任何事情，但由于某种原因对打印视而不见:(

布伦特@ [mimoYmima.com](http://www.mimoymima.com/resources/081129_jquery-intro.php "学习jQuery，初学者教程")

# validation - 上传时有什么方法可以验证图像的宽度和高度吗？

> ID：186037
> 
> 赞同：0
> 
> 时间：2008-10-09T05:40:45.593
> 
> 标签：validation

上传时有什么方法可以验证图像的宽度和高度吗？使用服务器端的javascript？像jsp，aspx等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T06:00:36.757

如果你使用的是Java平台，你可以使用[ImageIO](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)来读取图像，然后使用`getHeight`and`getWidth`对[`BufferedImage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html)从读取操作返回。

我承认这是一种重量级的方法，所以我确信还有更好的方法。我只需要找到它。:-P

至于.NET，我不知道。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T05:49:47.340

我已经通过执行 Image Magick“识别”命令来做到这一点。

如果您使用的是 Unix，那就很容易了——尽管我认为它也可以在 Windows 上运行。

我怀疑你可以在客户端做到这一点。

# html - 使用绝对定位是否被认为是不好的做法？

> ID：186044
> 
> 赞同：73
> 
> 时间：2008-10-09T05:48:35.437
> 
> 标签：html, css

我正在开发一个网页，在那里我正在为类似国际象棋的游戏布置一个棋盘，以及几个棋盘。这一切都是使用 HTML 完成的（使用 jQuery 在游戏进行时进行动态更新）。在某个地方，我认为在页面中使用元素的绝对定位被认为是一种不好的做法，并且最好使用相对定位。

在与相对定位斗争了太久之后，我意识到棋盘元素的绝对定位会变得非常、容易得多……而且确实如此。

有人知道相对定位优于绝对定位的原因吗？在决定采用哪种方法时，您是否应用了任何指导方针或经验法则？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-10-09T05:56:54.813

对于您正在开发的象棋类游戏，使用绝对定位本身并没有错。正如您所说，相对定位和正常流布局使此类任务非常困难。

当然，如果您正在开发一个更标准的网站，例如提供一些公共服务的网站，绝对定位会覆盖浏览器的默认流布局，因此会降低许多用户的可访问性。在这种情况下，我会避免它。

话虽如此，绝对定位的一个鲜为人知的好处是它允许在最近的“定位”父元素*内进行局部绝对定位。*

*注意：* “定位”元素可以是以下任何一种：相对、固定、绝对或粘性。

解释：

```
<div id="parentDIV" style="position:relative">
    <div id="childDIV" style="position:absolute;left:20px;top:20px;">
          I'm absolutely positioned within parentDIV.
    </div>
</div> 
```

在这里，`childDIV`实际上位于距离左侧 20 像素和距离顶部 20 像素的位置`parentDIV`，而*不是*整个文档。这可以很好地精确控制页面上的嵌套元素，而不会牺牲整个页面流程布局。

所以回答你的问题（相对定位优于绝对）：我不相信有一个正确的答案，这取决于你需要构建什么。然而，在一般定位（绝对或相对）与默认流布局中，我的方法如上所述。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-10-09T13:45:41.387

还要记住，绝对定位不仅用于相对于浏览器窗口定位事物 - 它还用于在包含元素内准确定位事物。当我终于明白这一点时——在多年使用 CSS 之后——它真的彻底改变了我有效使用 CSS 的能力。

关键是绝对定位元素定位在第一个具有`position:relative`或的祖先元素的上下文中`position:absolute`。所以如果你有这个：

```
div.Container
{
   position:relative
   width:300px;
   height:300px;
   background:yellow;
}

div.PositionMe
{
   position:absolute;
   top:10px;
   right:10px;
   width:20px;
   height:20px;
   background:red
} 
```

和

```
<div class=Container>
...
   <div class=PositionMe>
   ...
   </div>
...
</div> 
```

... div`PositionMe`将相对于 放置`Container`，而不是相对于页面。

这为在特定情况下精确放置提供了各种可能性，而不会牺牲页面的整体灵活性和流动性。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-09T11:06:34.157

它没有回答你的问题，但是......

对于像棋盘这样的国际象棋，我认为您也可以使用桌子。
毕竟，它是您正在显示的列和行。

现在我知道很多人开始大喊“不要使用桌子”和“桌子是邪恶的”。然而，表格仍然是显示某些类型数据的有效工具，尤其是按列/行组织的数据。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T02:35:25.343

我认为问题在于绝对定位很容易被滥用。外行人比盒子模型更容易理解坐标系。此外，像 Dreamweaver 这样的程序使使用绝对定位布局页面变得非常简单（人们不知道他们在做什么）。

但是，对于典型的页面布局，默认的静态定位应该足够了，并且可以在 90% 的时间内完成工作。它非常灵活，通过保持一切正常流动，元素可以感知周围的其他元素，并在事情发生变化时采取相应的行动。这在处理动态内容时非常好（现在大多数页面都是这样）。

使用绝对定位要严格得多，并且很难编写能够很好地响应不断变化的内容的布局。他们太明确了。但是，如果您需要在页面周围自由移动元素（拖放），需要将元素叠加在一起，或者其他可以从坐标系中受益的布局技术，那么它是完美的。坦率地说，棋盘听起来是使用它的好理由。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-09T06:02:02.790

在以下条件下，在不同的浏览器中查看您的网站：

*   将您的操作系统设置切换为高 dpi/大字体/高对比度（全部更改默认浏览器字体的大小）
*   增加/减少浏览器中的默认字体大小
*   覆盖浏览器中的页面字体（通常在辅助功能选项中的某处）
*   覆盖/关闭页面样式表（当然，用户不应该期望国际象棋游戏在这种情况下正常工作:-)）

一般来说，当你有非固定大小字体的内联元素时，绝对位置是不好的。对于您的场景，它可能会起作用；然而，会有很多极端情况会发生一些时髦的事情。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-09T08:05:31.323

只要您构建 HTML 以使元素遵循在没有 CSS 的情况下呈现时有意义的逻辑顺序，就没有理由认为使用绝对定位是不好的做法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-09T08:18:38.707

没有硬性规定。不同形式的定位都擅长不同的事情。

大多数工作通常最好用静态定位完成（这是最不脆弱的选择），但有时绝对定位非常好。另一方面，相对定位是我从未使用过的东西，除了动画（在涉及 JavaScript 之前静态定位的元素上），为绝对定位建立包含块（因此元素本身根本不会移动） , 和（非常非常罕见）一个或两个像素的元素轻推。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-09T05:57:12.520

如果你可以拉出一个完全流畅的布局，相对定位是很好的，因为它在大范围的屏幕分辨率上看起来很合理。

话虽这么说，但很难找到完全流畅的布局（尤其是在尝试与旧版本的跨浏览器兼容性时）。不应该不赞成使用绝对定位，大多数凡人 Web 开发人员一直都在这样做。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-09T10:41:11.947

有些事情没有position:absolute是不可能的。其他事情通过绝对定位更容易实现（假设您想要一个右下角的按钮用于在固定/最小高度框中“阅读更多”，并且您在该框中没有足够的文本）。所以，我的建议：只使用适合您需求的...

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-04-16T00:08:59.170

在我看来，我似乎是这里唯一一个完全不同意绝对定位不是坏习惯的假设除了动画或元素等条件应该专门放在他们父母的“不寻常”地方，绝对定位打破了你的 HTML 的结构（这正是我认为 HTML 应该定义的），因为你可以很容易地获得与结构不同的视觉结果。此外，绝对的设计实现更加困难和问题，因为您需要测量每个元素并且您有很多错误的地方（与正常流程相比，对于网站骨架的结构构建来说更容易和正确）

最后，关于棋盘，我相信最难的方法是使用绝对位置！用桌子制作板会更容易和正确（毕竟这是一张桌子）......而且我个人会用一个有的`cube`课程来做`float: left`（`clear`每第九个立方体）

64个不同方格的绝对定位太疯狂了！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-09T07:58:22.993

IMO，根本不是一件坏事。我最近完成了一项符合 AA 标准并支持 FF2、IE7、IE6 的任务（是的，我知道这很痛苦）。有些布局只有绝对定位才能实现！甚至某些组件，例如需要分层的按钮（透明胶片），也只能因为绝对定位而成为可能。如果有人有更好的方法，请向我推荐。

绝对定位打破了流程，如果我们知道如何限制流程（将父母的坐标更改为相对/绝对），这很有趣。我不了解较旧的浏览器（IE6 本身就是恐龙），但我发现的一件痛苦的事情是，写入 PDF（可爱的 PDF）或使用 WINWORD 打开（告我）会产生破旧的结果。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-02-27T14:48:19.133

绝对定位是一种工具，就像任何工具一样，它可以以好的和坏的方式使用。它没有任何问题：StackOverflow 可能使用它在站点顶部的橙色栏中显示其警报。

现在，在你的情况下，这也不错。但我认为你不使用它会容易得多。

棋盘是一张桌子，表格单元格不需要位置调整。对于事件，/`onblur`将完成这项工作。为什么你甚至需要像素计算？`onfocus``cie`

所以不要被你的练习质量所强调，但也许你可以检查一下你是否真的需要绝对定位。

# asp.net - ASP.NET MVC 控制器可以返回图像吗？

> ID：186062
> 
> 赞同：472
> 
> 时间：2008-10-09T05:58:17.603
> 
> 标签：asp.net, asp.net-mvc, image, controller

我可以创建一个只返回图像资产的控制器吗？

每当请求如下 URL 时，我想通过控制器路由此逻辑：

```
www.mywebsite.com/resource/image/topbanner 
```

控制器将查找`topbanner.png`该图像并将其直接发送回客户端。

我见过这样的例子，你必须创建一个视图——我不想使用视图。我想只用控制器来完成这一切。

这可能吗？

* * *

## 回答 #1

> 赞同：548
> 
> 时间：2009-08-28T20:58:45.000

使用基本控制器文件方法。

```
public ActionResult Image(string id)
{
    var dir = Server.MapPath("/Images");
    var path = Path.Combine(dir, id + ".jpg"); //validate the path for security or use other means to generate the path.
    return base.File(path, "image/jpeg");
} 
```

请注意，这似乎相当有效。我做了一个测试，通过控制器 ( `http://localhost/MyController/Image/MyImage`) 和直接 URL ( `http://localhost/Images/MyImage.jpg`) 请求图像，结果是：

*   **MVC：**每张照片 7.6 毫秒
*   **直接：**每张照片 6.7 毫秒

注意：这是请求的平均时间。平均值是通过在本地计算机上发出数千个请求来计算的，因此总数不应包括网络延迟或带宽问题。

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2009-04-15T16:23:19.960

使用 MVC 的发布版本，这是我所做的：

```
[AcceptVerbs(HttpVerbs.Get)]
[OutputCache(CacheProfile = "CustomerImages")]
public FileResult Show(int customerId, string imageName)
{
    var path = string.Concat(ConfigData.ImagesDirectory, customerId, "\\", imageName);
    return new FileStreamResult(new FileStream(path, FileMode.Open), "image/jpeg");
} 
```

我显然在这里有一些关于路径构造的应用程序特定的东西，但是 FileStreamResult 的返回很好而且很简单。

针对您对图像的日常调用（绕过控制器），我针对此操作进行了一些性能测试，平均值之间的差异仅为 3 毫秒左右（控制器平均为 68 毫秒，非控制器为 65 毫秒）。

我已经尝试了这里的答案中提到的其他一些方法，并且对性能的影响更加显着......一些解决方案的响应是非控制器的 6 倍（其他控制器平均 340 毫秒，非控制器 65 毫秒）。

* * *

## 回答 #3

> 赞同：103
> 
> 时间：2009-09-29T21:59:17.987

稍微解释一下 Dyland 的回应：

三个类实现[FileResult](http://msdn.microsoft.com/en-us/library/system.web.mvc.fileresult.aspx)类：

```
System.Web.Mvc.FileResult
      System.Web.Mvc.FileContentResult
      System.Web.Mvc.FilePathResult
      System.Web.Mvc.FileStreamResult 
```

它们都是不言自明的：

*   对于文件存在于磁盘上的文件路径下载，请使用`FilePathResult`- 这是最简单的方法，避免您必须使用 Streams。
*   对于 byte[] 数组（类似于 Response.BinaryWrite），使用`FileContentResult`.
*   对于要下载文件的字节 [] 数组（内容处置：附件），`FileStreamResult`请以与下面类似的方式使用，但使用 a`MemoryStream`和 using `GetBuffer()`。
*   供`Streams`使用`FileStreamResult`。它被称为 FileStreamResult 但它需要 a`Stream`所以我*猜*它适用于`MemoryStream`.

以下是使用内容处置技术的示例（未测试）：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult GetFile()
    {
        // No need to dispose the stream, MVC does it for you
        string path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "App_Data", "myimage.png");
        FileStream stream = new FileStream(path, FileMode.Open);
        FileStreamResult result = new FileStreamResult(stream, "image/png");
        result.FileDownloadName = "image.png";
        return result;
    } 
```

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2011-03-28T11:06:27.377

如果您想在返回之前修改图像，这可能会有所帮助：

```
public ActionResult GetModifiedImage()
{
    Image image = Image.FromFile(Path.Combine(Server.MapPath("/Content/images"), "image.png"));

    using (Graphics g = Graphics.FromImage(image))
    {
        // do something with the Graphics (eg. write "Hello World!")
        string text = "Hello World!";

        // Create font and brush.
        Font drawFont = new Font("Arial", 10);
        SolidBrush drawBrush = new SolidBrush(Color.Black);

        // Create point for upper-left corner of drawing.
        PointF stringPoint = new PointF(0, 0);

        g.DrawString(text, drawFont, drawBrush, stringPoint);
    }

    MemoryStream ms = new MemoryStream();

    image.Save(ms, System.Drawing.Imaging.ImageFormat.Png);

    return File(ms.ToArray(), "image/png");
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-06-09T06:16:04.700

您可以创建自己的扩展程序并这样做。

```
public static class ImageResultHelper
{
    public static string Image<T>(this HtmlHelper helper, Expression<Action<T>> action, int width, int height)
            where T : Controller
    {
        return ImageResultHelper.Image<T>(helper, action, width, height, "");
    }

    public static string Image<T>(this HtmlHelper helper, Expression<Action<T>> action, int width, int height, string alt)
            where T : Controller
    {
        var expression = action.Body as MethodCallExpression;
        string actionMethodName = string.Empty;
        if (expression != null)
        {
            actionMethodName = expression.Method.Name;
        }
        string url = new UrlHelper(helper.ViewContext.RequestContext, helper.RouteCollection).Action(actionMethodName, typeof(T).Name.Remove(typeof(T).Name.IndexOf("Controller"))).ToString();         
        //string url = LinkBuilder.BuildUrlFromExpression<T>(helper.ViewContext.RequestContext, helper.RouteCollection, action);
        return string.Format("<img src=\"{0}\" width=\"{1}\" height=\"{2}\" alt=\"{3}\" />", url, width, height, alt);
    }
}

public class ImageResult : ActionResult
{
    public ImageResult() { }

    public Image Image { get; set; }
    public ImageFormat ImageFormat { get; set; }

    public override void ExecuteResult(ControllerContext context)
    {
        // verify properties 
        if (Image == null)
        {
            throw new ArgumentNullException("Image");
        }
        if (ImageFormat == null)
        {
            throw new ArgumentNullException("ImageFormat");
        }

        // output 
        context.HttpContext.Response.Clear();
        context.HttpContext.Response.ContentType = GetMimeType(ImageFormat);
        Image.Save(context.HttpContext.Response.OutputStream, ImageFormat);
    }

    private static string GetMimeType(ImageFormat imageFormat)
    {
        ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders();
        return codecs.First(codec => codec.FormatID == imageFormat.Guid).MimeType;
    }
}
public ActionResult Index()
    {
  return new ImageResult { Image = image, ImageFormat = ImageFormat.Jpeg };
    }
    <%=Html.Image<CapchaController>(c => c.Index(), 120, 30, "Current time")%> 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2011-10-31T23:47:03.073

为什么不简单地使用波浪号`~`运算符呢？

```
public FileResult TopBanner() {
  return File("~/Content/images/topbanner.png", "image/png");
} 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-09T20:22:52.803

您可以直接写入响应，但它是不可测试的。最好返回延迟执行的 ActionResult。这是我的可重复使用的 StreamResult：

```
public class StreamResult : ViewResult
{
    public Stream Stream { get; set; }
    public string ContentType { get; set; }
    public string ETag { get; set; }

    public override void ExecuteResult(ControllerContext context)
    {
        context.HttpContext.Response.ContentType = ContentType;
        if (ETag != null) context.HttpContext.Response.AddHeader("ETag", ETag);
        const int size = 4096;
        byte[] bytes = new byte[size];
        int numBytes;
        while ((numBytes = Stream.Read(bytes, 0, size)) > 0)
            context.HttpContext.Response.OutputStream.Write(bytes, 0, numBytes);
    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-09T06:28:47.603

**更新：有比我原来的答案更好的选择。这在 MVC 之外工作得很好，但最好坚持使用返回图像内容的内置方法。查看投票赞成的答案。**

你当然可以。尝试以下步骤：

1.  将图像从磁盘加载到字节数组中
2.  在您期望对图像有更多请求并且不想要磁盘 I/O 的情况下缓存图像（我的示例没有在下面缓存它）
3.  通过 Response.ContentType 更改 mime 类型
4.  Response.Binary写出图像字节数组

这是一些示例代码：

```
string pathToFile = @"C:\Documents and Settings\some_path.jpg";
byte[] imageData = File.ReadAllBytes(pathToFile);
Response.ContentType = "image/jpg";
Response.BinaryWrite(imageData); 
```

希望有帮助！

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-07-06T06:26:29.367

**解决方案 1：通过图像 URL 在视图中呈现图像**

您可以创建自己的扩展方法：

```
public static MvcHtmlString Image(this HtmlHelper helper,string imageUrl)
{
   string tag = "<img src='{0}'/>";
   tag = string.Format(tag,imageUrl);
   return MvcHtmlString.Create(tag);
} 
```

然后像这样使用它：

```
@Html.Image(@Model.ImagePath); 
```

**解决方案 2：从数据库中渲染图像**

创建一个返回图像数据的控制器方法，如下所示

```
public sealed class ImageController : Controller
{
  public ActionResult View(string id)
  {
    var image = _images.LoadImage(id); //Pull image from the database.
    if (image == null) 
      return HttpNotFound();
    return File(image.Data, image.Mime);
  }
} 
```

并在如下视图中使用它：

```
@ { Html.RenderAction("View","Image",new {id=@Model.ImageId})} 
```

要在任何 HTML 中使用从此 actionresult 呈现的图像，请使用

```
<img src="http://something.com/image/view?id={imageid}> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-04-10T02:09:18.197

这对我有用。因为我将图像存储在 SQL Server 数据库中。

```
 [HttpGet("/image/{uuid}")]
    public IActionResult GetImageFile(string uuid) {
        ActionResult actionResult = new NotFoundResult();
        var fileImage = _db.ImageFiles.Find(uuid);
        if (fileImage != null) {
            actionResult = new FileContentResult(fileImage.Data,
                fileImage.ContentType);
        }
        return actionResult;
    } 
```

在上面的代码片段`_db.ImageFiles.Find(uuid)`中是在 db（EF 上下文）中搜索图像文件记录。它返回一个 FileImage 对象，该对象只是我为模型制作的自定义类，然后将其用作 FileContentResult。

```
public class FileImage {
   public string Uuid { get; set; }
   public byte[] Data { get; set; }
   public string ContentType { get; set; }
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-10-15T10:22:28.370

下面的代码`System.Drawing.Bitmap`用于加载图像。

```
using System.Drawing;
using System.Drawing.Imaging;

public IActionResult Get()
{
    string filename = "Image/test.jpg";
    var bitmap = new Bitmap(filename);

    var ms = new System.IO.MemoryStream();
    bitmap.Save(ms, ImageFormat.Jpeg);
    ms.Position = 0;
    return new FileStreamResult(ms, "image/jpeg");
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2016-03-16T14:23:33.780

您可以使用 File 返回一个文件，如 View、Content 等

```
 public ActionResult PrintDocInfo(string Attachment)
            {
                string test = Attachment;
                if (test != string.Empty || test != "" || test != null)
                {
                    string filename = Attachment.Split('\\').Last();
                    string filepath = Attachment;
                    byte[] filedata = System.IO.File.ReadAllBytes(Attachment);
                    string contentType = MimeMapping.GetMimeMapping(Attachment);

                    System.Net.Mime.ContentDisposition cd = new System.Net.Mime.ContentDisposition
                    {
                        FileName = filename,
                        Inline = true,
                    };

                    Response.AppendHeader("Content-Disposition", cd.ToString());

                    return File(filedata, contentType);          
                }
                else { return Content("<h3> Patient Clinical Document Not Uploaded</h3>"); }

            } 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-10-09T06:27:57.900

查看内容结果。这将返回一个字符串，但可用于创建您自己的类 BinaryResult 类。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-02-18T12:58:51.327

```
if (!System.IO.File.Exists(filePath))
    return SomeHelper.EmptyImageResult(); // preventing JSON GET/POST exception
else
    return new FilePathResult(filePath, contentType); 
```

`SomeHelper.EmptyImageResult()`应该返回`FileResult`现有图像（例如，1x1 透明）。

如果您将文件存储在本地驱动器上，这是最简单的方法。如果文件是`byte[]`or `stream`- 然后按照 Dylan 的建议使用`FileContentResult`or 。`FileStreamResult`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-09T06:26:59.197

我看到两个选项：

1) 实现您自己的 IViewEngine 并将您正在使用的控制器的 ViewEngine 属性设置为您所需的“图像”方法中的 ImageViewEngine。

2）使用视图:-)。只需更改内容类型等。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-09T06:28:39.880

您可以使用 HttpContext.Response 并直接将内容写入其中（WriteFile() 可能对您有用），然后从您的操作而不是 ActionResult 返回 ContentResult。

免责声明：我没有尝试过，它基于查看可用的 API。:-)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-08-20T12:01:32.893

我也遇到过类似的需求，

因此，在我的情况下，我使用图像文件夹路径向 Controller 发出请求，作为回报，它会发回 ImageResult 对象。

以下代码片段说明了这项工作：

```
var src = string.Format("/GenericGrid.mvc/DocumentPreviewImageLink?fullpath={0}&routingId={1}&siteCode={2}", fullFilePath, metaInfo.RoutingId, da.SiteCode);

                if (enlarged)
                    result = "<a class='thumbnail' href='#thumb'>" +
                        "<img src='" + src + "' height='66px' border='0' />" +
                        "<span><img src='" + src + "' /></span>" +
                        "</a>";
                else
                    result = "<span><img src='" + src + "' height='150px' border='0' /></span>"; 
```

在来自图像路径的控制器中，我生成图像并将其返回给调用者

```
try
{
  var file = new FileInfo(fullpath);
  if (!file.Exists)
     return string.Empty;

  var image = new WebImage(fullpath);
  return new ImageResult(new MemoryStream(image.GetBytes()), "image/jpg");

}
catch(Exception ex)
{
  return "File Error : "+ex.ToString();
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-12-21T12:55:11.870

读取图像，将其转换为`byte[]`，然后返回`File()`带有内容类型的 a。

```
public ActionResult ImageResult(Image image, ImageFormat format, string contentType) {
  using (var stream = new MemoryStream())
    {
      image.Save(stream, format);
      return File(stream.ToArray(), contentType);
    }
  }
} 
```

以下是用法：

```
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using Microsoft.AspNetCore.Mvc; 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-09-17T19:43:17.883

**是的，您可以返回图片**

```
public ActionResult GetImage(string imageFileName)
{
    var path = Path.Combine(Server.MapPath("/Images"), imageFileName + ".jpg"); 
    return base.File(path, "image/jpeg");
} 
```

**（请不要忘记将此标记为答案）**

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-02-24T10:55:13.727

在 Core 3.2 下的 byte[] 中，您可以使用：

```
public ActionResult Img(int? id) {
    MemoryStream ms = new MemoryStream(GetBytes(id));
    return new FileStreamResult(ms, "image/png");
} 
```

# oop - 面向对象语言的类与代码行的良好比例是多少？

> ID：186070
> 
> 赞同：6
> 
> 时间：2008-10-09T06:01:21.543
> 
> 标签：oop, code-analysis, metrics, lines-of-code

对于面向对象的语言（比如 C++、C#、Java 等），类数与代码行数的良好比率是多少？

包括经理在内的许多人都喜欢用传统的 LOC（代码行）度量来衡量软件的复杂性，而许多顽固的面向对象的开发人员会说 LOC 毫无价值，因为它的类数才是重要的。而且我个人认为，类可能是一个更合理的复杂性度量，但是如果没有 LOC 度量，这些类的实际复杂性（其中的恶作剧者和神灵的数量）很难估计。

因此，有人知道对于一些编码良好的软件来说，什么可能是一个健康的比率？

编辑：在这种特殊情况下，我正在寻找一个比率来确定清理代码可能需要多少重构的大致估计。

编辑：有人知道一些大型 OSS 项目（如 Firefox、Apache、Webkit 等）的比率吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T06:18:56.530

LOC 或 NLOC 并不是真正衡量代码质量或健康状况的好方法。我建议使用[NDepend](http://www.ndepend.com)的静态代码分析（为您.net 窥视）来查看您的解决方案的架构如何。

我发现 LOC 仅在方法级别是很好的衡量标准。也就是说，我通常喜欢我的方法适合屏幕（不是小字体）。除了单元测试之外，其他指标，如循环复杂度和代码覆盖率（针对您的 TDDers）可以更好地了解您的代码库的健康程度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T06:15:49.797

对于这个问题，实际上并没有一个好的、确定的或令人满意的答案。但是，我会说，根据我的经验，每个类的代码行数会随着面向对象编程经验的增加而减少。

大多数没有学习过面向对象设计原则的人往往会拥有包含大量代码行的类。有很多面向对象经验的人每个类的代码行数往往会更少，但会拥有更多的类。当然，两者都会互相抱怨:-)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-04T16:09:10.553

如果您真的只是在寻找经验法则，那么我会说任何无法以可读分辨率打印在单张纸上的类可能太长，应该重构。您的目标标记可能在 100-200 行左右，但在我看来，页数因素更容易处理。

我也坚信，页数指标应该被视为衡量坏的因素而不是线性的。如果代码库中有一个十页的类，那对我来说，这比一个结构良好的小类至少差*三百万倍。*

# mysql - 左连接优于内连接？

> ID：186071
> 
> 赞同：15
> 
> 时间：2008-10-09T06:01:30.670
> 
> 标签：mysql, database, performance, join

我一直在分析我正在处理的应用程序中的一些查询，我遇到了一个查询，它检索的行数超过了必要的行数，结果集在应用程序代码中被修剪掉了。

将 LEFT JOIN 更改为 INNER JOIN 会将结果集修剪为所需的内容，并且可能还会提高性能（因为选择的行更少）。实际上，LEFT JOIN'ed 查询的性能优于 INNER JOIN'ed，只需一半的时间即可完成。

LEFT JOIN：（总共 127 行，查询耗时 0.0011 秒）

INNER JOIN：（总共 10 行，查询耗时 0.0024 秒）

（我多次运行查询，这些都是平均值）。

在两者上运行 EXPLAIN 不会显示任何解释性能差异的信息：

对于内部联接：

```
id  select_type     table   type    possible_keys   key     key_len     ref        rows     Extra
1   SIMPLE  contacts        index       NULL        name        302     NULL         235    Using where
1   SIMPLE  lists           eq_ref      PRIMARY     PRIMARY     4   contacts.list_id     1   
1   SIMPLE  lists_to_users  eq_ref      PRIMARY     PRIMARY     8   lists.id,const  1    
1   SIMPLE  tags            eq_ref      PRIMARY     PRIMARY     4   lists_to_users.tag_id   1    
1   SIMPLE  users           eq_ref      email_2     email_2     302     contacts.email 1    Using where 
```

对于左连接：

```
id  select_type     table   type    possible_keys   key     key_len     ref     rows    Extra
1   SIMPLE          contacts index      NULL        name        302     NULL    235     Using where
1   SIMPLE        lists     eq_ref      PRIMARY     PRIMARY     4   contacts.list_id    1    
1   SIMPLE    lists_to_users eq_ref     PRIMARY     PRIMARY     8   lists.id,const  1    
1   SIMPLE         tags     eq_ref      PRIMARY     PRIMARY     4   lists_to_users.tag_id   1    
1   SIMPLE        users     eq_ref      email_2     email_2     302     contacts.email  1 
```

和查询本身：

```
SELECT `contacts`.*, `lists`.`name` AS `group`, `lists`.`id` AS `group_id`, `lists`.`shared_yn`, `tags`.`name` AS `context`, `tags`.`id` AS `context_id`, `tags`.`color` AS `context_color`, `users`.`id` AS `user_id`, `users`.`avatar` 
FROM `contacts`  
LEFT JOIN `lists` ON lists.id=contacts.list_id  
LEFT JOIN `lists_to_users` ON lists_to_users.list_id=lists.id AND lists_to_users.user_id='1' AND lists_to_users.creator='1'  
LEFT JOIN `tags` ON tags.id=lists_to_users.tag_id 
INNER JOIN `users` ON users.email=contacts.email 
WHERE (contacts.user_id='1') 
ORDER BY `contacts`.`name` ASC 
```

（我正在谈论的子句是“用户”表上的最后一个 INNER JOIN）

该查询在 MySQL 5.1 数据库上运行，如果它有所作为的话。

有没有人知道为什么在这种情况下 LEFT JOIN'ed 查询优于 INNER JOIN'ed ？

**更新：**由于 Tomalak 建议我使用的小表使 INNER JOIN 更加复杂，我创建了一个包含一些模拟数据的测试数据库。'users' 表是 5000 行，contacts 表是 ~500,000 行。结果是一样的（时间也没有改变，当你考虑到现在桌子更大时，这很令人惊讶）。

我还在联系人表上运行了 ANALYZE 和 OPTIMIZE。没有任何明显的区别。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-09T18:20:17.650

如果你认为 LEFT JOIN 的实现是 INNER JOIN + 更多的工作，那么这个结果是令人困惑的。如果 INNER JOIN 的实现是（LEFT JOIN + 过滤）呢？啊，现在清楚了。

在查询计划中，唯一的区别是：*用户...额外：使用 where*。这意味着过滤。使用内部联接的查询中有一个**额外的过滤步骤**。

* * *

这是一种不同于通常在 where 子句中使用的过滤。在 A 上创建索引以支持此过滤操作很简单。

```
SELECT *
FROM A
WHERE A.ID = 3 
```

考虑这个查询：

```
SELECT *
FROM A
  LEFT JOIN B
  ON A.ID = B.ID
WHERE B.ID is not null 
```

这个查询相当于内连接。B 上没有索引可以帮助过滤操作。原因是 where 子句声明了连接结果的条件，而不是 B 上的条件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T06:26:22.523

这可能是由于 INNER JOIN 必须检查两个表中的每一行以查看列值（在您的情况下为电子邮件）是否匹配。LEFT JOIN 无论如何都会从一张表中返回所有内容。如果它被编入索引，那么它也会知道更快地做什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T06:41:45.673

表基数对查询优化器有影响。我猜小表，因为你有使内部连接更复杂的操作。一旦您的记录多于数据库服务器愿意保留在内存中的记录，内连接可能会开始优于左连接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T07:32:24.247

imo您陷入了被称为过早优化的陷阱。查询优化器是极其善变的东西。我的建议是继续前进，直到您可以确定某个特定的连接存在问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T19:52:37.057

尝试这个：

```
SELECT `contacts`.*, `lists`.`name` AS `group`, `lists`.`id` AS `group_id`, `lists`.`shared_yn`, `tags`.`name` AS `context`, `tags`.`id` AS `context_id`, `tags`.`color` AS `context_color`, `users`.`id` AS `user_id`, `users`.`avatar` 
FROM `contacts`  
INNER JOIN `users` ON contacts.user_id='1' AND users.email=contacts.email
LEFT JOIN `lists` ON lists.id=contacts.list_id  
LEFT JOIN `lists_to_users` ON lists_to_users.user_id='1' AND lists_to_users.creator='1' AND lists_to_users.list_id=lists.id
LEFT JOIN `tags` ON tags.id=lists_to_users.tag_id 
ORDER BY `contacts`.`name` ASC 
```

这应该会给您带来额外的性能，因为：

*   在出现任何“左”或“右”连接之前放置所有内部连接。这会在应用后续外连接之前过滤掉一些记录
*   “AND”运算符的短路（“AND”的顺序很重要）。如果列和文字之间的比较为假，则不会执行所需的表扫描以进行表 PK 和 FK 之间的比较

如果您没有发现任何性能改进，则将所有列集替换为“COUNT(*)”并进行左侧/内部测试。这样，无论查询如何，您都将仅检索 1 个单行和 1 个单列（计数），因此您可以放弃返回的字节数是导致查询缓慢的原因：

```
SELECT COUNT(*)
FROM `contacts`  
INNER JOIN `users` ON contacts.user_id='1' AND users.email=contacts.email
LEFT JOIN `lists` ON lists.id=contacts.list_id  
LEFT JOIN `lists_to_users` ON lists_to_users.user_id='1' AND lists_to_users.creator='1' AND lists_to_users.list_id=lists.id
LEFT JOIN `tags` ON tags.id=lists_to_users.tag_id 
```

祝你好运

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-10-09T09:23:08.623

LEFT JOIN 返回比 INNER JOIN 更多的行，因为这两个是不同的。
如果 LEFT JOIN 在它正在查找的表中没有找到相关条目，它将为该表返回 NULL。
但是如果 INNER JOIN 没有找到相关条目，它根本不会返回**整**行。

但是对于您的问题，您是否启用了 query_cache ？尝试运行查询

```
SELECT SQL_NO_CACHE `contacts`.*, ... 
```

除此之外，我会用更多数据填充表格，运行

```
ANALYZE TABLE t1, t2;
OPTIMIZE TABLE t1, t2; 
```

看看会发生什么。

# c++ - 有哪些适合初学者的良好 DirectX 资源？

> ID：186073
> 
> 赞同：9
> 
> 时间：2008-10-09T06:02:40.697
> 
> 标签：c++, resources, directx

我正在学习 DirectX 作为一个爱好项目的一部分。我一直在为 DirectX9 寻找一些好的在线资源（使用 C++，如果这种区别很重要的话），但还没有找到任何东西 a) 非常适合初学者和 b) 是最新的。

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T08:30:36.453

当我开始使用 DirectX 时，我发现这是基本内容的最佳资源： [http ://www.directxtutorial.com/](http://www.directxtutorial.com/)

当您开始达到中级水平时，他们希望您付费订阅，但所有好的基本内容都是免费的。教程很清楚，而且是一步一步的。

这个网站也不错：[http](http://www.toymaker.info/) ://www.toymaker.info/ - 有一些不错的项目下载。

如果你有问题，根据我的经验，最好的去处是[http://www.gamedev.net/](http://www.gamedev.net/)，他们有很棒的文章和论坛，里面有很多所谓的大师。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T08:48:52.283

*   [玩具制造商](http://www.toymaker.info/Games/index.html)
*   [三重缓冲器](http://triplebuffer.devmaster.net/list.php?display=s&page=0)
*   [DirectX4VB](http://directx4vb.vbgamer.com/DirectX4VB/TUT_DX9Start.asp)
*   [32位](http://www.32bits.co.uk/)

[使用 DirectX 9 进行 3D 游戏编程简介](https://rads.stackoverflow.com/amzn/click/com/1556229135)：不是在线资源，但那本书对我很有帮助。

还有 DirecX SDK 文档，它应该是您的权威资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T07:04:44.147

Gamedev.net 可能是个不错的地方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T06:15:24.043

[CodeProject.com](http://www.codeproject.com/KB/directx/)

# c - 如何在 Mac OS X 上以编程方式在 C 中创建稀疏文件？

> ID：186077
> 
> 赞同：9
> 
> 时间：2008-10-09T06:03:32.460
> 
> 标签：c, macos, filesystems

我想创建一个稀疏文件，这样在我向它们写入数据之前，全零块不会占用实际的磁盘空间。是否可以？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-10T21:05:42.033

关于默认的 Mac OS X 文件系统 (HFS+) 是否支持文件中的漏洞似乎有些混乱。下面的程序证明情况并非如此。

```
#include <stdio.h>
#include <string.h>
#include <fcntl.h>
#include <unistd.h>

void create_file_with_hole(void)
{
    int fd = open("file.hole", O_WRONLY|O_TRUNC|O_CREAT, 0600);
    write(fd, "Hello", 5);
    lseek(fd, 99988, SEEK_CUR); // Make a hole
    write(fd, "Goodbye", 7);
    close(fd);
}

void create_file_without_hole(void)
{
    int fd = open("file.nohole", O_WRONLY|O_TRUNC|O_CREAT, 0600);
    write(fd, "Hello", 5);
    char buf[99988];
    memset(buf, 'a', 99988);
    write(fd, buf, 99988); // Write lots of bytes
    write(fd, "Goodbye", 7);
    close(fd);
}

int main()
{
    create_file_with_hole();
    create_file_without_hole();
    return 0;
} 
```

该程序创建了两个文件，每个文件的长度为 100,000 字节，其中一个有一个 99,988 字节的孔。

在 HFS+ 分区上的 Mac OS X 10.5 上，两个文件占用相同数量的磁盘块 (200)：

```
$ ls -ls
total 400
200 -rw-------  1 user  staff  100000 Oct 10 13:48 file.hole
200 -rw-------  1 user  staff  100000 Oct 10 13:48 file.nohole
```

而在 CentOS 5 上，没有漏洞的文件比其他文件多消耗 88 个磁盘块：

```
$ ls -ls
total 136
 24 -rw-------  1 user   nobody 100000 Oct 10 13:46 file.hole
112 -rw-------  1 user   nobody 100000 Oct 10 13:46 file.nohole
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T06:18:26.470

与其他 Unix 一样，它是文件系统的一个特性。文件系统要么支持所有文件，要么不支持。与 Win32 不同，您不需要做任何特别的事情来实现它。与 Win32 不同的是，使用稀疏文件不会降低性能。

在 MacOS 上，默认文件系统是*不*支持稀疏文件的 HFS+。

**更新：** MacOS 曾经支持具有稀疏文件支持的 UFS 卷，但已被删除。当前支持的文件系统都没有稀疏文件支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-23T12:21:23.323

该线程成为有关稀疏文件的综合信息来源。这是 Win32 缺少的部分：

[带有示例的体面文章](http://www.flexhex.com/docs/articles/sparse-files.phtml)

[估计将文件设为稀疏是否有意义的工具](http://www.opalapps.com/sparse_checker/sparse_checker.html)

问候

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T06:26:52.957

hdiutil 可以处理稀疏的图像和文件，但不幸的是，它链接的框架是私有的。

您可以尝试定义由下面的 DiskImages 框架定义的外部符号，但这对于生产代码很可能是不可接受的，而且由于该框架是私有的，您必须对其用例进行逆向工程。

cristi:~ diciu$ otool -L /usr/bin/hdiutil

/usr/bin/hdiutil：/System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages（兼容版本 1.0.8，当前版本 194.0.0）[..]

cristi:~ diciu$ nm /System/Library/PrivateFrameworks/DiskImages.framework/Versions/A/DiskImages | awk -F' ''{打印 $3}' | c++过滤器| grep -i 稀疏

[..]

CSparseFile::sector2Band(long long)

CSparseFile::addIndexNode()

CSparseFile::readIndexNode(long long, SparseFileIndexNode*)

CSparseFile::readHeaderNode(CBackingStore*, SparseFileHeaderNode*, unsigned long)

[...为简洁起见]

***稍后编辑***

您*可以*将 hdiutil 用作外部进程并让它为您创建一个稀疏磁盘映像。然后，您将在 C 进程中在（已挂载的）稀疏磁盘映像中创建一个文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T20:21:28.330

如果您寻求 (fseek, ftruncate, ...) 到最后，文件大小将增加而不分配块，直到您写入孔。但是没有办法创建一个自动将零块转换为孔的魔术文件。你必须自己做。

这可能有助于查看（OpenBSD cp 命令插入孔而不是写入零）。 [修补](http://www.openbsd.org/cgi-bin/cvsweb/src/bin/cp/utils.c.diff?r1=1.26;r2=1.27)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T07:12:53.223

如果你想要可移植性，最后的手段是编写你自己的访问函数，这样你就可以管理一个索引和一组块。

本质上，您管理单个文件，因为操作系统管理磁盘，保留作为文件一部分的块链、已分配/空闲块的位图等。

当然这会导致非优化和较慢的访问，只有在节省空间的要求绝对关键并且您有足够的时间编写一组强大的访问函数时，我才会推荐这种方法。

即使在这种情况下，我也会首先调查您的问题是否需要不同的解决方案。也许您应该以不同的方式存储数据？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-29T17:10:21.750

看起来 OS X 支持 UDF 卷上的稀疏文件。我在 OS X 10.9 上尝试了 Titandecoy 的测试程序，它确实在 UDF 磁盘映像上生成了一个稀疏文件。此外，并不是说 OS X 不再支持 UFS，所以如果您需要稀疏文件，UDF 是唯一支持它们的本机支持的文件系统。

我还尝试了有关 SMB 共享的程序。当服务器是 Ubuntu（ext4 文件系统）时，程序会创建一个稀疏文件，但通过 SMB 的“ls -ls”不会显示该文件。如果您在 Ubuntu 主机本身上执行“ls -ls”，它确实显示文件是稀疏的。当服务器是 Windows XP（NTFS 文件系统）时，程序不会生成稀疏文件。

# c# - 初始化静态对象 - 代码设计问题

> ID：186082
> 
> 赞同：0
> 
> 时间：2008-10-09T06:06:50.767
> 
> 标签：c#, design-patterns, architecture, static

在我的 Web 应用程序（C#，.Net 3.5）中，由一个*核心*类库（包含业务逻辑、数据层和几个实用程序类）、一个 Windows 服务项目、一个 Web 服务项目和网站项目组成，我有一个所有其他项目使用的*核心*库中的几个静态类。这些类（例如**Log**类）需要一些初始化（它们有一个**Initialize**方法）才能设置它们以供使用。例如，**Log类的****Initialize**方法有一个目录路径参数，它告诉**Log**将日志文件保存到哪里。或者我正在考虑加载**日志的“设置”********静态构造函数中的配置文件中的类。缺点是，我需要在生产代码中进行不同的单元测试设置。******

 ******有没有更好的方法来设计这个？这种方法的缺点是，静态类的所有使用者都将尝试调用 Initialize。这不是一个真正的问题，因为一旦初始化，该方法将立即返回，而不是再次执行 Initialize 代码，但设计对我来说似乎有点奇怪。

我希望我的英语足以解释我所追求的。如果问题不够清楚，请不要犹豫。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T06:34:30.353

对于需要初始化的东西，我会尽量避免使用静态类。使您的 Log 类成为普通类，并且可能有一个单独的工厂类来创建实例或单个实例。您可能希望使用依赖注入来避免任何静态，尽管这对于非常普遍的日志记录之类的东西可能会很痛苦。

特别是对于日志记录，log4net 和 log4j （顺便说一句，您有什么理由自己滚动？）都使用根据名称（通常基于使用它的类型的名称）向某些工厂类询问日志实例的习惯用法。这通常存储在每个需要执行日志记录的类中的静态变量中。如果返回的日志对象仍然会受到日志子系统初始化的影响，那么您最终不会遇到顺序问题，即 DI 容器必须在初始化日志客户端之前初始化日志框架等。

使用单独的日志记录对象而不是静态类提高了可测试性 - 您可以在测试期间将日志记录对象替换为记录日志的对象，以确保捕获（例如）审计信息。静态已知的日志记录对象的一个​​缺点是，这降低了并行运行测试的可能性。

为有些随意的沉思道歉-我还没有喝第一杯咖啡。希望它是有帮助的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T06:11:33.003

我建议，如果初始化很昂贵，请使用单例（如果您不熟悉设计模式，谷歌单例设计模式）。作为实例构建的一部分，您随后会读入一个配置文件，该文件可以特定于环境。

这样，您将获得两全其美。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T08:50:27.507

我认为您对您在问题中提供的任何一种解决方案都很好。从您的 Main 方法调用 Initialize 一次（或将其放在从 Main 调用的某个单独的 SetupApplicationInfrastructure 方法中）。或者，在构造函数中加载一次设置。

我认为您不必担心每次访问实例时都要检查是否需要初始化。这样做还不错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-12T17:41:50.617

添加到Trav所说的......

除了 Log 的 Singleton 实现之外，您还可以将它包装在静态类周围。这样您就不需要更改已经使用静态 Log 类的位置。并且为您的单元测试交换模拟日志框架将非常容易。我将在 Java 中给出一个示例——假设您有如下所示的内容：

```
public class Log
{
    public static void debug(Object o, String message)
    {
        System.out.println(o + " [DBUG] " + message);
    }

    public static void info(Object o, String message)
    {
        System.out.println(o + " [INFO] " + message);
    }
} 
```

您可以像下面这样重构它：

```
public interface ILoggeer
{
    void debug(Object o, String message);
    void info(Object o, String message);
}

public class Log
{
    private static ILogger log = new ConsoleLogger();

    public static setLogger(ILogger impl)
    {
        log = impl;
    }

    public static void debug(Object o, String message)
    {
        log.debug(o, message);
    }

    public static void info(Object o, String message)
    {
        log.info(o, message);
    }
}

public class ConsoleLogger implements ILogger
{
    public void debug(Object o, String message)
    {
        System.out.println(o + " [DBUG] " + message);
    }

    public void info(Object o, String message)
    {
        System.out.println(o + " [INFO] " + message);
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-09T06:24:28.190

我认为您必须在这里提出棘手的问题。那东西**需要**是静态的吗？静态对象，无论是否是单例形式，都很难使用。如果你真的需要静态，也许像[单态模式](http://jeremyjarrell.com/archive/2008/04/21/88.aspx)这样的东西可以帮助你。它就像一个多态静态类。通常，所有成员变量都是静态的，而构造函数则不是。也许有了这个，你可以继承这个类，并根据你的需要做一些覆盖。只是一个想法。

# c# - 如何将计时器添加到 C# 控制台应用程序

> ID：186084
> 
> 赞同：148
> 
> 时间：2008-10-09T06:07:49.703
> 
> 标签：c#, console, timer

就是这样 - 如何将计时器添加到 C# 控制台应用程序？如果您能提供一些示例编码，那就太好了。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2011-10-23T08:25:48.833

这非常好，但是为了模拟一些时间流逝，我们需要运行一个需要一些时间的命令，这在第二个示例中非常清楚。

然而，使用 for 循环来完成某些功能的风格永远需要大量的设备资源，相反我们可以使用垃圾收集器来做类似的事情。

我们可以在同一本书 CLR Via C# Third Ed 的代码中看到这种修改。

```
using System;
using System.Threading;

public static class Program 
{
   private Timer _timer = null;
   public static void Main() 
   {
      // Create a Timer object that knows to call our TimerCallback
      // method once every 2000 milliseconds.
      _timer = new Timer(TimerCallback, null, 0, 2000);
      // Wait for the user to hit <Enter>
      Console.ReadLine();
   }

   private static void TimerCallback(Object o) 
   {
      // Display the date/time when this method got called.
      Console.WriteLine("In TimerCallback: " + DateTime.Now);
   }
} 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2008-10-09T06:09:42.213

使用 System.Threading.Timer 类。

System.Windows.Forms.Timer 主要设计用于单线程，通常是 Windows 窗体 UI 线程。

在 .NET 框架的开发早期还添加了一个 System.Timers 类。但是，通常建议使用 System.Threading.Timer 类，因为无论如何这只是 System.Threading.Timer 的包装。

如果您正在开发 Windows 服务并需要定期运行计时器，则还建议始终使用静态（在 VB.NET 中共享）System.Threading.Timer。这将避免您的计时器对象可能过早地进行垃圾收集。

这是控制台应用程序中的计时器示例：

```
using System; 
using System.Threading; 
public static class Program 
{ 
    public static void Main() 
    { 
       Console.WriteLine("Main thread: starting a timer"); 
       Timer t = new Timer(ComputeBoundOp, 5, 0, 2000); 
       Console.WriteLine("Main thread: Doing other work here...");
       Thread.Sleep(10000); // Simulating other work (10 seconds)
       t.Dispose(); // Cancel the timer now
    }
    // This method's signature must match the TimerCallback delegate
    private static void ComputeBoundOp(Object state) 
    { 
       // This method is executed by a thread pool thread 
       Console.WriteLine("In ComputeBoundOp: state={0}", state); 
       Thread.Sleep(1000); // Simulates other work (1 second)
       // When this method returns, the thread goes back 
       // to the pool and waits for another task 
    }
} 
```

来自Jeff Richter的[CLR Via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)一书。顺便说一下，本书在第 23 章中描述了 3 种计时器背后的基本原理，强烈推荐。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-10-09T06:24:53.603

下面是创建一个简单的一秒计时器滴答的代码：

```
 using System;
  using System.Threading;

  class TimerExample
  {
      static public void Tick(Object stateInfo)
      {
          Console.WriteLine("Tick: {0}", DateTime.Now.ToString("h:mm:ss"));
      }

      static void Main()
      {
          TimerCallback callback = new TimerCallback(Tick);

          Console.WriteLine("Creating timer: {0}\n", 
                             DateTime.Now.ToString("h:mm:ss"));

          // create a one second timer tick
          Timer stateTimer = new Timer(callback, null, 0, 1000);

          // loop here forever
          for (; ; )
          {
              // add a sleep for 100 mSec to reduce CPU usage
              Thread.Sleep(100);
          }
      }
  } 
```

这是结果输出：

```
 c:\temp>timer.exe
    Creating timer: 5:22:40

    Tick: 5:22:40
    Tick: 5:22:41
    Tick: 5:22:42
    Tick: 5:22:43
    Tick: 5:22:44
    Tick: 5:22:45
    Tick: 5:22:46
    Tick: 5:22:47 
```

**编辑：**将硬自旋循环添加到代码中绝不是一个好主意，因为它们会消耗 CPU 周期而没有任何收益。在这种情况下，添加循环只是为了阻止应用程序关闭，从而允许观察线程的操作。但为了正确起见并减少 CPU 使用率，在该循环中添加了一个简单的 Sleep 调用。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-06-15T18:06:17.957

让我们有一点乐趣

```
using System;
using System.Timers;

namespace TimerExample
{
    class Program
    {
        static Timer timer = new Timer(1000);
        static int i = 10;

        static void Main(string[] args)
        {            
            timer.Elapsed+=timer_Elapsed;
            timer.Start(); Console.Read();
        }

        private static void timer_Elapsed(object sender, ElapsedEventArgs e)
        {
            i--;

            Console.Clear();
            Console.WriteLine("=================================================");
            Console.WriteLine("                  DEFUSE THE BOMB");
            Console.WriteLine(""); 
            Console.WriteLine("                Time Remaining:  " + i.ToString());
            Console.WriteLine("");        
            Console.WriteLine("=================================================");

            if (i == 0) 
            {
                Console.Clear();
                Console.WriteLine("");
                Console.WriteLine("==============================================");
                Console.WriteLine("         B O O O O O M M M M M ! ! ! !");
                Console.WriteLine("");
                Console.WriteLine("               G A M E  O V E R");
                Console.WriteLine("==============================================");

                timer.Close();
                timer.Dispose();
            }

            GC.Collect();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-01-26T14:16:34.347

或者使用 Rx，简短而甜蜜：

```
static void Main()
{
Observable.Interval(TimeSpan.FromSeconds(10)).Subscribe(t => Console.WriteLine("I am called... {0}", t));

for (; ; ) { }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-09T06:29:10.660

如果您想要更多的控制，您也可以使用自己的计时机制，但可能会降低准确性和更多代码/复杂性，但我仍然建议使用计时器。如果您需要控制实际的计时线程，请使用它：

```
private void ThreadLoop(object callback)
{
    while(true)
    {
        ((Delegate) callback).DynamicInvoke(null);
        Thread.Sleep(5000);
    }
} 
```

将是您的计时线程（修改它以在需要时停止，并且在您想要的任何时间间隔）。

并使用/启动您可以执行以下操作：

```
Thread t = new Thread(new ParameterizedThreadStart(ThreadLoop));

t.Start((Action)CallBack); 
```

回调是您希望在每个时间间隔调用的 void 无参数方法。例如：

```
private void CallBack()
{
    //Do Something.
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-10-18T02:25:15.113

**您也可以创建自己的（如果对可用选项不满意）。**

创建自己的`Timer`实现是非常基本的东西。

这是一个应用程序的示例，该应用程序需要在与我的代码库的其余部分相同的线程上访问 COM 对象。

```
/// <summary>
/// Internal timer for window.setTimeout() and window.setInterval().
/// This is to ensure that async calls always run on the same thread.
/// </summary>
public class Timer : IDisposable {

    public void Tick()
    {
        if (Enabled && Environment.TickCount >= nextTick)
        {
            Callback.Invoke(this, null);
            nextTick = Environment.TickCount + Interval;
        }
    }

    private int nextTick = 0;

    public void Start()
    {
        this.Enabled = true;
        Interval = interval;
    }

    public void Stop()
    {
        this.Enabled = false;
    }

    public event EventHandler Callback;

    public bool Enabled = false;

    private int interval = 1000;

    public int Interval
    {
        get { return interval; }
        set { interval = value; nextTick = Environment.TickCount + interval; }
    }

    public void Dispose()
    {
        this.Callback = null;
        this.Stop();
    }

} 
```

您可以按如下方式添加事件：

```
Timer timer = new Timer();
timer.Callback += delegate
{
    if (once) { timer.Enabled = false; }
    Callback.execute(callbackId, args);
};
timer.Enabled = true;
timer.Interval = ms;
timer.Start();
Window.timers.Add(Environment.TickCount, timer); 
```

为了确保计时器正常工作，您需要创建一个无限循环，如下所示：

```
while (true) {
     // Create a new list in case a new timer
     // is added/removed during a callback.
     foreach (Timer timer in new List<Timer>(timers.Values))
     {
         timer.Tick();
     }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-02-01T18:26:21.627

在 C# 5.0+ 和 .NET Framework 4.5+ 中，您可以使用 async/await：

```
async void RunMethodEvery(Action method, double seconds)
{
    while (true)
    {
        await Task.Delay(TimeSpan.FromSeconds(seconds));
        method();
    }
 } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-09-30T14:41:27.873

[使用https://github.com/bigabdoul/PowerConsole](https://www.nuget.org/packages/PowerConsole)上 Github 上的 PowerConsole 项目或[https://www.nuget.org/packages/PowerConsole](https://github.com/bigabdoul/PowerConsole)上的等效 NuGet 包。它以可重复使用的方式优雅地处理计时器。看看这个示例代码：

```
using PowerConsole;

namespace PowerConsoleTest
{
    class Program
    {
        static readonly SmartConsole MyConsole = SmartConsole.Default;

        static void Main()
        {
            RunTimers();
        }

        public static void RunTimers()
        {
            // CAUTION: SmartConsole is not thread safe!
            // Spawn multiple timers carefully when accessing
            // simultaneously members of the SmartConsole class.

            MyConsole.WriteInfo("\nWelcome to the Timers demo!\n")

            // SetTimeout is called only once after the provided delay and
            // is automatically removed by the TimerManager class
            .SetTimeout(e =>
            {
                // this action is called back after 5.5 seconds; the name
                // of the timer is useful should we want to clear it
                // before this action gets executed
                e.Console.Write("\n").WriteError("Time out occured after 5.5 seconds! " +
                    "Timer has been automatically disposed.\n");

                // the next statement will make the current instance of 
                // SmartConsole throw an exception on the next prompt attempt
                // e.Console.CancelRequested = true;

                // use 5500 or any other value not multiple of 1000 to 
                // reduce write collision risk with the next timer
            }, millisecondsDelay: 5500, name: "SampleTimeout")

            .SetInterval(e =>
            {
                if (e.Ticks == 1)
                {
                    e.Console.WriteLine();
                }

                e.Console.Write($"\rFirst timer tick: ", System.ConsoleColor.White)
                .WriteInfo(e.TicksToSecondsElapsed());

                if (e.Ticks > 4)
                {
                    // we could remove the previous timeout:
                    // e.Console.ClearTimeout("SampleTimeout");
                }

            }, millisecondsInterval: 1000, "EverySecond")

            // we can add as many timers as we want (or the computer's resources permit)
            .SetInterval(e =>
            {
                if (e.Ticks == 1 || e.Ticks == 3) // 1.5 or 4.5 seconds to avoid write collision
                {
                    e.Console.WriteSuccess("\nSecond timer is active...\n");
                }
                else if (e.Ticks == 5)
                {
                    e.Console.WriteWarning("\nSecond timer is disposing...\n");

                    // doesn't dispose the timer
                    // e.Timer.Stop();

                    // clean up if we no longer need it
                    e.DisposeTimer();
                }
                else
                {
                    System.Diagnostics.Trace.WriteLine($"Second timer tick: {e.Ticks}");
                }
            }, 1500)
            .Prompt("\nPress Enter to stop the timers: ")

            // makes sure that any remaining timer is disposed off
            .ClearTimers()

            .WriteSuccess("Timers cleared!\n");
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-13T15:12:45.900

[文档](https://docs.microsoft.com/en-us/dotnet/api/system.timers.timer?view=netframework-4.8)

你有它 ：）

```
public static void Main()
   {
      SetTimer();

      Console.WriteLine("\nPress the Enter key to exit the application...\n");
      Console.WriteLine("The application started at {0:HH:mm:ss.fff}", DateTime.Now);
      Console.ReadLine();
      aTimer.Stop();
      aTimer.Dispose();

      Console.WriteLine("Terminating the application...");
   }

   private static void SetTimer()
   {
        // Create a timer with a two second interval.
        aTimer = new System.Timers.Timer(2000);
        // Hook up the Elapsed event for the timer. 
        aTimer.Elapsed += OnTimedEvent;
        aTimer.AutoReset = true;
        aTimer.Enabled = true;
    }

    private static void OnTimedEvent(Object source, ElapsedEventArgs e)
    {
        Console.WriteLine("The Elapsed event was raised at {0:HH:mm:ss.fff}",
                          e.SignalTime);
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-01T18:29:33.643

我建议您遵循 Microsoft 指南 ( [https://docs.microsoft.com/en-us/dotnet/api/system.timers.timer.interval?view=netcore-3.1](https://docs.microsoft.com/en-us/dotnet/api/system.timers.timer.interval?view=netcore-3.1) )。

我第一次尝试使用`System.Threading;`with

```
var myTimer = new Timer((e) =>
{
   // Code
}, null, TimeSpan.Zero, TimeSpan.FromSeconds(5)); 
```

但它在约 20 分钟后连续停止。

有了这个，我尝试了解决方案设置

```
GC.KeepAlive(myTimer) 
```

或者

```
for (; ; ) { }
} 
```

但在我的情况下它们不起作用。

按照 Microsoft 文档，它运行良好：

```
using System;
using System.Timers;

public class Example
{
    private static Timer aTimer;

    public static void Main()
    {
        // Create a timer and set a two second interval.
        aTimer = new System.Timers.Timer();
        aTimer.Interval = 2000;

        // Hook up the Elapsed event for the timer. 
        aTimer.Elapsed += OnTimedEvent;

        // Have the timer fire repeated events (true is the default)
        aTimer.AutoReset = true;

        // Start the timer
        aTimer.Enabled = true;

        Console.WriteLine("Press the Enter key to exit the program at any time... ");
        Console.ReadLine();
    }

    private static void OnTimedEvent(Object source, System.Timers.ElapsedEventArgs e)
    {
        Console.WriteLine("The Elapsed event was raised at {0}", e.SignalTime);
    }
}
// The example displays output like the following: 
//       Press the Enter key to exit the program at any time... 
//       The Elapsed event was raised at 5/20/2015 8:48:58 PM 
//       The Elapsed event was raised at 5/20/2015 8:49:00 PM 
//       The Elapsed event was raised at 5/20/2015 8:49:02 PM 
//       The Elapsed event was raised at 5/20/2015 8:49:04 PM 
//       The Elapsed event was raised at 5/20/2015 8:49:06 PM 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-18T22:02:09.383

你可以使用 `StopWatch`类，这是一个例子

```
StopWatch stopwatch = new Stopwatch();
// creating a new stopwatch class
stopwatch.Start();
// starting the stopwatch
Thread.Sleep(10000);
// waiting for 10 seconds

Timespan timespan = stopwatch.Elapsed;
/* creating a new timespan class and concacting it with the elapsed of the 
stopwatch class */
string time = String.Format("{0:00}:{1:00}:{2:00}",
timespan.Hours, timespan.Minutes, timespan.Seconds
);

Console.Write($"The time right now is {time}");

Console.ReadKey(); 
```

# sqlite - 在查询变得耗时之前，SQLite 表可以保存多少行

> ID：186094
> 
> 赞同：6
> 
> 时间：2008-10-09T06:15:40.593
> 
> 标签：sqlite

我正在建立一个简单的 SQLite 数据库来保存传感器读数。这些表看起来像这样：

```
sensors  
 - id (pk) 
 - name  
 - description
 - units  

sensor_readings  
 - id (pk)  
 - sensor_id (fk to sensors)  
 - value (actual sensor value stored here)
 - time (date/time the sensor sample was taken) 
```

该应用程序将每月从大约 30 个不同的传感器捕获大约 100,000 个传感器读数，我希望尽可能长时间地将所有传感器读数保留在数据库中。

大多数查询将采用以下形式

```
SELECT * FROM sensor_readings WHERE sensor_id = x AND time > y AND time < z 
```

此查询通常会返回大约 100-1000 个结果。

所以问题是，在上述查询变得过于耗时（在标准 PC 上超过几秒钟）之前，sensor_readings 表可以有多大。

我知道一个解决方法可能是为每个传感器创建一个单独的 sensor_readings 表，但如果没有必要，我想避免这种情况。还有其他方法可以优化此数据库模式吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T08:03:01.000

如果您要`time`在查询中使用，则值得为其添加索引。这将是我根据您的信息建议的唯一优化。

每月 100,000 次插入相当于每分钟大约 2.3 次，因此另一个索引不会太繁重，并且会加快您的查询速度。我假设在所有 30 个传感器中插入 100,000 次，而不是每个传感器 100,000 次，但是，即使我弄错了，每分钟 70 次插入应该还是可以的。

如果性能确实成为问题，您可以选择将旧数据卸载到历史表（例如，`sensor_readings_old`），并且只对非历史表（`sensor_readings`）进行查询。

然后，您至少可以在不影响正常查询的情况下获得所有可用数据。如果您真的想获取较旧的数据，您可以这样做，但您会意识到查询可能需要更长的时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T06:40:30.340

您是否正确设置索引？除此之外，阅读[http://web.utk.edu/~jplyon/sqlite/SQLite_optimization_FAQ.html](http://web.utk.edu/~jplyon/sqlite/SQLite_optimization_FAQ.html)，唯一的答案是“你必须自己衡量”——尤其是因为这在很大程度上取决于硬件以及是否您正在使用内存数据库或磁盘，以及是否将插入包装在事务中。

话虽这么说，在几万行之后我已经遇到了明显的延迟，但这绝对不是优化的——从阅读中我得到的印象是，有些人有数百行有适当的索引等. 完全没有问题的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T10:24:29.907

SQLite 现在支持 R-tree 索引 ( [http://www.sqlite.org/rtree.html](http://www.sqlite.org/rtree.html) )，如果您打算进行大量时间范围查询，这是理想的选择。

汤姆

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-06T23:39:31.603

我知道我来晚了，但我认为这可能对稍后查看此问题的任何人有所帮助：

只要 SQLite 一次只为单个应用程序/用户提供服务，它的读取速度就会相对较快。并发和阻塞可能会成为多个用户或应用程序一次访问它的问题，更强大的数据库（如 MS SQL Server）往往在高并发环境中工作得更好。

正如其他人所说，如果您担心读取查询的速度，我肯定会为该表编制索引。对于您的特定情况，我可能会创建一个包含 id 和 time 的索引。

您可能还需要注意写入速度。插入可能很快，但提交很慢，因此您可能希望在提交之前将许多插入批处理到一个事务中。这在这里讨论：[http ://www.sqlite.org/faq.html#q19](http://www.sqlite.org/faq.html#q19)

# regex - 正则表达式搜索和替换程序

> ID：186096
> 
> 赞同：4
> 
> 时间：2008-10-09T06:17:48.203
> 
> 标签：regex, search

是否有一个简单轻量级的程序来搜索文本文件并用正则表达式替换字符串？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T06:19:40.663

搜索：[grep](http://www.opengroup.org/onlinepubs/009695399/utilities/grep.html) - 简单快速。包含在 Linux 中，[这](http://gnuwin32.sourceforge.net/packages/grep.htm)是一个 Windows 版本，不确定 Mac。

用于替换：[sed](http://www.grymoire.com/Unix/Sed.html)。[这](http://gnuwin32.sourceforge.net/packages/sed.htm)是Windows版本，不确定Mac。

当然，如果您想在搜索和替换时实际打开一个文件并查看其内容，您可以使用[emacs](http://souptonuts.sourceforge.net/chirico/emacs_ref.html)。或[上下文](http://www.contexteditor.org/index.html)。或[vim](http://www.vim.org)。或者你有什么。;)

另请参阅[此问题](https://stackoverflow.com/questions/155934/what-gnulinux-command-line-tool-would-i-use-for-performing-a-search-and-replace)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T06:39:30.623

Perl 擅长于此，它的 -i、-n、-p 和 -e 开关。有关示例，请参阅我的演讲[Field Guide To The Perl Command Line Switches](http://petdance.com/perl/command-line-options.pdf)中的幻灯片。

其他人提到了 sed 和 awk，Perl 受到它们的启发也就不足为奇了。但是，对于您和/或您的用户来说，Perl 可能更容易获得和安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T06:25:56.953

还有[sed](http://www.gnu.org/software/sed/manual/html_node/index.html)，它是学习基础知识的有用工具 - 非常适合进行基于正则表达式的快速替换。

快速示例，将 input.txt 中的“foo”更改为“bar”...

```
sed -e 's/foo/bar/g' input.txt > output.txt 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T06:23:41.343

许多体面的文本编辑器也有这个选项，vim、emacs、EditPlus 等等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T06:24:51.713

sed 或 awk。我推荐书[sed&awk](https://rads.stackoverflow.com/amzn/click/com/1565922255)来掌握主题或小册子[sed&awk 袖珍参考](https://rads.stackoverflow.com/amzn/click/com/0596003528)，以供快速参考。当然[掌握正则表达式](https://rads.stackoverflow.com/amzn/click/com/0596528124)是必须的……

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T07:06:14.673

你没有提到你正在使用什么平台......如果你对一个相对简单的 GUI 工具感兴趣，那就是[regexxer](http://regexxer.sourceforge.net/)。否则，前面提到的 sed 等命令行工具会非常有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T12:05:31.310

这取决于您是在处理一个文件还是多个文件。冒着被嘲笑的风险，我假设您使用的是 Windows，因为您没有指定平台。

[Notepad2](http://www.flos-freeware.ch/notepad2.html)可以一次处理一个文件，而且速度极快、重量轻且便携。

要一次搜索/替换多个文件，请尝试[Agent Ransack](http://www.mythicsoft.com/agentransack/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T06:26:32.973

使用 emacs 或 xemacs。它具有完美的正则表达式替换功能。您甚至可以使用 /1（或 /2 或 /3）之类的结构来在替换中获取匹配的表达式，该表达式用 ( ) 围绕它们进行标识。为了防止 vi-emacs 冲突：vi 也将具有类似的结构。我不确定是否有任何现代编辑器支持此功能。

提示：首先尝试一个简单的替换，这可能有点不清楚，因为您可能会添加“\”来逃避特殊的 RegExp 结构......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T11:53:28.417

不知道平台，我会说这个页面上弹出的广告可能是合适的：PowerGREP。对此一无所知，但听起来与您正在寻找的相似。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-03-10T20:36:52.750

试试 WildGem：[http ://www.skytopia.com/software/wildgem](http://www.skytopia.com/software/wildgem)

我是创造者。小巧、超快、便携且独立。您可以使用正则表达式，但它也有自己的简单语言语法，使查询在理论上更容易。

我引用：

> 与类似程序不同，WildGem 速度很快，具有双分割显示，并在您实时键入时更新或突出显示匹配项。独特的颜色编码语法使您可以轻松查找/替换文本，而不必担心必须转义特殊符号。

这是一个屏幕截图：[![野生宝石](https://i.stack.imgur.com/nJBy3.png)](https://i.stack.imgur.com/nJBy3.png)

# bash - 在 Bash 中工作时如何处理“文件过多”问题？

> ID：186099
> 
> 赞同：7
> 
> 时间：2008-10-09T06:18:44.130
> 
> 标签：bash, unix, shell

我很多时候必须处理包含数十万个文件的目录，进行文本匹配、替换等。如果我走标准路线，说

```
grep foo * 
```

我收到太多文件错误消息，所以我最终做了

```
for i in *; do grep foo $i; done 
```

或者

```
find ../path/ | xargs -I{} grep foo "{}" 
```

但这些都不是最佳的（为每个文件创建一个新的 grep 进程）。

这看起来更像是程序可以接收的参数大小的限制，因为 for 循环中的 * 可以正常工作。但是，无论如何，处理这个问题的正确方法是什么？

PS：不要告诉我 grep -r ，我知道，我正在考虑没有递归选项的工具。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T21:43:42.653

在较新版本的 findutils 中，find 可以完成 xargs 的工作（包括 glomming 行为，以便只使用所需数量的 grep 进程）：

```
find ../path -exec grep foo '{}' + 
```

使用`+`而不是`;`作为最后一个参数会触发此行为。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T06:38:27.817

如果存在包含空格的文件名的风险，您应该记住使用 -print0 标志与 -0 标志一起查找 xargs：

```
find . -print0 | xargs -0 grep -H foo 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T06:30:45.400

xargs 不会为每个文件启动一个新进程。它将论点聚集在一起。查看 xargs 的 -n 选项 - 它控制传递给子命令每次执行的参数数量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T06:37:24.060

我看不到那个

```
for i in *; do
    grep foo $i
done 
```

会起作用，因为我认为“文件太多”是 shell 限制，因此 for 循环也会失败。

话虽如此，我总是让 xargs 完成将参数列表拆分为可管理位的繁琐工作，因此：

```
find ../path/ | xargs grep foo 
```

它不会按文件启动进程，而是按文件组启动进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T22:23:04.837

好吧，我遇到了同样的问题，但似乎我想出的所有东西都已经提到了。大多数情况下，有两个问题。执行 glob 很昂贵，对一百万个文件目录执行 ls 需要很长时间（在我的一台服务器上执行 20 多分钟），对一百万个文件目录执行 ls * 需要很长时间，并且由于“参数列表太长”错误而失败。

```
find /some -type f -exec some command {} \; 
```

似乎对这两个问题都有帮助。此外，如果您需要对这些文件执行更复杂的操作，您可能会考虑将您的内容编写到多个线程中。这是一个用于编写 CLI 脚本的 python 入门。 [http://www.ibm.com/developerworks/aix/library/au-pythocli/?ca=dgr-lnxw06pythonunixtool&S_TACT=105AGX59&S_CMP=GR](http://www.ibm.com/developerworks/aix/library/au-pythocli/?ca=dgr-lnxw06pythonunixtool&S_TACT=105AGX59&S_CMP=GR)

# sql-injection - 将部分用户数据存储在文件中以防止 SQL 注入

> ID：186106
> 
> 赞同：0
> 
> 时间：2008-10-09T06:21:00.317
> 
> 标签：sql-injection, security

我是网络编程新手，一直在探索与网络安全相关的问题。

我有一个表单，用户可以在其中发布两种类型的数据 - 我们称它们为“安全”和“不安全”（从 sql 的角度来看）。

大多数地方建议在清理“不安全”部分（使其“安全”）之后将数据的两个部分存储在数据库中。

我想知道另一种方法 - 将“安全”数据存储在数据库中，将“不安全”数据存储在文件中（数据库外部）。当然，这种方法会产生一系列与维护文件和数据库条目之间的关联相关的问题。但是这种方法是否还有其他重大问题，尤其是与安全有关的问题？

> 更新：感谢您的回复！抱歉，我不清楚我认为什么是“安全的”，因此需要进行一些澄清。我正在使用 Django，我认为“安全”的表单数据是通过表单的“cleaned_data”字典访问的，该字典执行所有必要的转义。
> 
> 出于这个问题的目的，让我们考虑一个 wiki 页面。wiki 页面的标题不需要附加任何样式。因此，这可以通过表单的“cleaned_data”字典访问，该字典会将用户输入转换为“安全”格式。但由于我希望为用户提供任意设置内容样式的能力，我可能无法使用“cleaned_data”字典访问内容部分。
> 
> 文件方法是否解决了这个问题的安全方面？还是我忽略了其他安全问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T06:41:47.373

你知道你所说的“安全”数据吗？它不是。这*一切都是*不安全的，你应该这样对待它。不是通过将其存储在文件中，而是通过正确构造 SQL 语句。

正如其他人所提到的，使用准备好的语句或模拟它们的库是要走的路，例如

```
$db->Execute("insert into foo(x,y,z) values (?,?,?)", array($one, $two, $three)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T06:24:12.527

你认为什么是“安全”和“不安全”？您是否考虑将带有斜线的数据转义为“安全”？如果是这样，请不要。

使用带有 SQL 占位符的绑定变量。这是防止 SQL 注入的唯一明智方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T06:28:08.057

拆分数据不会保护您免受 SQL 注入，它只会限制可以通过它公开的数据，但这并不是攻击的唯一风险。他们还可以删除数据、添加虚假数据等。

我认为没有理由使用您的方法，特别是考虑到使用准备好的语句（在许多（如果不是全部）开发平台和数据库中都支持）。

甚至没有进入你的方法最终会成为的噩梦。

最后，*如果您不信任数据库，为什么还要使用它？*如果您愿意，只需使用普通文件，混合是不行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T06:36:28.663

SQL注入不仅可以针对整个数据库用户，而且是查询（中毒查询）的问题，所以对我来说，避免SQL注入攻击的最好方法（如果不是唯一的）是控制你的查询，保护它免受注入的可能性恶意字符而不是拆分存储。

# vxworks - 在 vxWorks 中如何使用环境变量？

> ID：186108
> 
> 赞同：1
> 
> 时间：2008-10-09T06:22:21.190
> 
> 标签：vxworks

**在 vxWorks Real-Time 进程中，您可以将环境变量作为主**例程的参数之一传递。

如何在内核上下文中使用环境变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T06:26:17.187

Vxworks 环境变量支持由 envLib 提供。

使用**putenv("VAR=value")**设置环境变量的值。

使用**char* var = getenv("VAR")**检索值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T06:27:34.300

直接从 VxWorks shell 调用它：

```
putenv "<VARIABLE NAME>=<VALUE>" 
```

替换为您的环境变量名称和您要设置的值。

# c# - 实现像 VS 这样的窗口管理器就可以了

> ID：186115
> 
> 赞同：4
> 
> 时间：2008-10-09T06:25:23.133
> 
> 标签：c#, .net, visual-studio

我的老板认为 VS 2008 IDE 窗口管理器（自动隐藏、解决方案资源管理器的对接、属性等）是自切片面包以来最好的东西。我在工具箱中找不到类似于该功能的控件。有没有你知道的那种可用的控件？还是我应该继续自己实施？顺便说一句，我们使用的是 VS 2008 Express。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T06:39:20.030

您不必创建看起来*像*VS 窗口管理器的东西 - 您可以将实际的 VS 与[Visual Studio Shell](http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx)一起使用。

我相信它旨在创建开发人员工具，但我认为没有理由必须以这种方式使用它。据我了解，它有点像 Eclipse RCP。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T06:37:09.507

我在一个真实的项目中实现了**Weifen Luo 的 DockPanel Suit**，效果非常好，现在它正在一个相当复杂的应用程序上投入生产（它是一个金融市场的应用程序，在性能和稳定性方面对 UI 有非常严格的要求） . 这确实是一个非常好的实现。

我什至不得不进行一些自定义修改，发现代码非常容易理解并且写得很好。

我敢肯定，Infragistics 和类似公司有几种类似的商业实现，但如果您资金短缺或只是不关心您的组件的商业支持服务，您可以尝试一下：

[http://sourceforge.net/projects/dockpanelsuite](http://sourceforge.net/projects/dockpanelsuite)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T07:13:13.113

我只是希望您没有为非技术用户开发标准的业务线应用程序。

我参与了一个业务应用程序。尝试使用 Magic 库（从内存中）并实现属性窗口等，所以它看起来“就像 Visual Studio”。

然后我们向最终用户发布了一个原型，他们讨厌它。这些是非技术财务和会计类型的人，有些甚至是高级用户。主要抱怨是“窗口不在同一个地方”，“太容易意外拖动窗口”，“太繁琐”“我的窗口总是消失”等。

仅仅因为您的老板认为 Visual Studio IDE 很棒，如果您的目标用户群不这样做，这并不意味着什么。

不要忘记 Visual Studio 是由开发人员为开发人员设计/构建的。如果您的用户不会过于技术化，那么首先对他们进行一些原型设计可能是非常明智的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T06:32:20.467

有一个非常好的开源项目就是为了这个。在 SourceForge 上查找~~DockingSuite~~ [Dock Panel Suite](http://sourceforge.net/projects/dockpanelsuite/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T06:31:46.053

你应该看看[SandDock](http://www.divil.co.uk/net/controls/sanddock/)。旧版本是免费许可的（不知道它们是否仍然可用），而新版本相对便宜，特别是考虑到它们可以为您节省的时间/金钱/理智。

我强烈建议不要尝试推出自己的 VM 组件。涉及的工作太多，如果它不是您的主要产品，那将不值得。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T06:41:43.287

[魔法图书馆](http://www.codeproject.com/KB/miscctrl/magicdocking.aspx "魔法图书馆")

[码头面板套件](http://sourceforge.net/projects/dockpanelsuite "码头面板套件")

[码头集装箱](http://www.osec.ro/en/index.php/Downloads#Dock_container "码头集装箱")

我个人认为魔法图书馆是最好的。不记得是不是OSS了。

# eclipse - Eclipse 字体和背景颜色

> ID：186118
> 
> 赞同：250
> 
> 时间：2008-10-09T06:26:09.823
> 
> 标签：eclipse, configuration, eclipse-plugin, eclipse-3.3

我一直在尝试将 Eclipse 窗口的背景颜色更改为黑色并自定义字体颜色。似乎没有办法做到这一点，至少不是以明显的方式。我正在使用 3.3 版。

我该如何做到这一点，或者是否有任何插件可以帮助做到这一点？

* * *

## 回答 #1

> 赞同：294
> 
> 时间：2008-10-09T11:01:21.797

### 更改背景颜色

1.  打开菜单 *Windows →*首选项*→*常规*→*编辑器*→*文本编辑器*
    *   浏览外观颜色选项
    *   选择背景颜色选项，取消选中默认，更改为黑色
    *   选择背景颜色选项，取消选中默认值，更改为选择的颜色

### 更改文本颜色

1.  打开*Java* →*编辑器*→*语法着色*
    *   从 Java 中选择元素
    *   改变颜色
    *   项目清单

### 更改 Java 编辑器字体

1.  打开菜单*Windows* →*首选项*→*常规*→*外观*→*颜色和字体*
    *   从列表中选择*Java* → *Java Editor Text 字体*
    *   点击更改并选择字体

* * *

## 回答 #2

> 赞同：160
> 
> 时间：2011-06-02T23:23:42.440

我刚遇到这个：[Eclipse Color Themes](http://www.eclipsecolorthemes.org/)

安装插件并从一系列预定义主题中进行选择，或者编写自己的主题。正是我需要的！

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-03-10T17:44:52.390

在 Windows → 首选项 → 常规 → 外观下，您可以找到一个深色主题。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-16T11:35:35.617

视图（导航器、控制台、任务等）的背景颜色根据桌面（系统）设置进行设置。在 Linux/GNome 上，我更改了 System/Preferences/Appeareance 以更改此颜色。

编辑器颜色由不同的编辑器设置混乱，在eclipse首选项中搜索*背景*以找到不同的选项。获得漂亮的深色（不仅是深色）主题的一种简单方法是安装[Afae 插件](http://robrohan.com/projects/afae/)，然后在其首选项中选择主题（例如，暮光主题很漂亮） - 再次，eclipse 首选项，Afae 组。当然，这只适用于使用 Afae 进行编辑时。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-04-02T19:31:24.347

如果您在使用 Eclipse 2019 时遇到问题并使用深色主题并设置背景并使其不改变：似乎有一个最近的[Eclipse 错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=558782)。我建议您[在此处](https://stackoverflow.com/questions/59599251/eclipse-2019-black-background)或[此处](https://stackoverflow.com/questions/60450156/eclipse-4-14-0-changing-the-editor-background-colour)查看解决方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-13T02:32:05.573

您可以安装 Eclipse 主题插件，然后选择默认。请访问这里：[http ://eclipsecolorthemes.org/?view=plugin](http://eclipsecolorthemes.org/?view=plugin)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T06:30:13.793

如果您转到 Windows，首选项，然后选择常规，编辑器，文本编辑器，您可以在该属性页上设置颜色（并且有一个用于设置更多颜色的链接 - 常规、外观、颜色和字体）。

无论如何，这与 Eclipse 3.3 版本有关。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-05-25T12:44:13.127

最简单的方法是从 Eclipse Marketplace 安装插件。转到 Help→Eclipse Marketplace，然后搜索 Eclipse Color Theme 并安装它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T06:33:57.657

*在 Windows 或 Mac 上，您可以在常规*→*编辑器*→*文本编辑器*菜单下找到此设置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-18T11:26:27.297

...在 Mac 上，“首选项”位于“Aptana Studio 3”主菜单下，而不是上面提到的“Windows”菜单下。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-23T02:38:34.353

**切换到主题...**也是一个选项

[![在此处输入图像描述](https://i.stack.imgur.com/YU83a.png)](https://i.stack.imgur.com/YU83a.png)

# php - 使用 PHP5 设置您的第一个 SSL 页面

> ID：186125
> 
> 赞同：1
> 
> 时间：2008-10-09T06:27:54.390
> 
> 标签：php, ssl

我想在我的网站上使用安全的 SSL 登录！我以前没有使用过 SSL，所以我正在寻找一些好的阅读材料。谁能告诉我在哪里可以找到一些 SSL 片段或页面代码的示例代码。（技术含量不高）

*   我有一个静态IP
*   我的主机设置为处理 SSL 页面。

感兴趣：基本页面代码。/ 树形结构。/ 其他

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T06:30:28.177

我的第一个想法是在需要安全时简单地调用一个函数来重定向到当前页面的 https: 版本。

像这样的一些代码：

```
if($requireSSL && $_SERVER['SERVER_PORT'] != 443) 
{
   header("HTTP/1.1 301 Moved Permanently");
   header("Location: https://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']);
   exit();
} 
```

[参考](http://www.somacon.com/p536.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T06:31:56.943

如果您有一个启用 SSL 的主机，那么编写登录与不使用 SSL 编写登录没有什么不同——所有加密都发生在协议栈的较低层，所以当您的 PHP 看到请求时，它已经被解密了。同样，您的脚本输出在传输回用户之前由 HTTP 服务器加密。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T12:28:08.377

SSL 发生在请求到达 PHP 之前。对您的 PHP 的唯一影响是您正在发布的面向自我的链接，您希望将其从 http://... 切换到 https://... 有一个 $_SERVER['HTTPS' ] 变量，如果您将同时接受 SSL 和非 SSL 连接，您可以使用它来触发此更改。但是，如果您将所有内容都移至 SSL，您将希望移动所有链接一次，而不是让它检查每个请求。

# visual-studio - 如果我没有 Visual Basic 6.0 并且需要编译一个 VB6 项目怎么办？

> ID：186128
> 
> 赞同：10
> 
> 时间：2008-10-09T06:28:02.300
> 
> 标签：visual-studio, vb6, devtools

一个客户希望我对一个 VB 6.0 应用程序进行一些维护工作（迁移到 .NET 也在进行中），但他没有开发工具，因为他只从原始程序员那里收到了源代码和正在运行的应用程序，谁不再可用。

据我所知，微软不销售 Visual Studio 6.0。**如何在没有 VB6 的情况下修改和编译 VB6 应用程序的源代码？**或者**如果 Microsoft 不销售 Visual Studio 6.0，我从哪里获得？**

即使我在没有发布新的 VB6 版本的情况下将所有内容迁移到 .NET，我也希望能够打开项目并查看它的编译和运行情况，以便更好地理解它。

我有 VS 2005 和 VB 2008。但我知道，如果我尝试打开项目，代码将转换为 VB.NET，这不是我在更好地了解项目之前想要的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-09T06:34:26.687

我记得 Visual Studio 6.0 可用于 MSDN 订阅者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T06:32:03.697

Hunt Ebay 或 Craigslist。或者打电话给你的常规软件供应商，我相信他们仍然可以因为这种原因得到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T07:23:32.923

Visual Basic 5 [Control Creation Edition](http://www.thevbzone.com/vbcce.htm)可能适合您度过难关，直到您获得完整版的 VB6。有限制，它是 5 而不是 6，但根据应用程序的范围和复杂性，它可能对您有用，作为临时措施。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T00:58:08.753

许多关于 Visual Basic 6 的教科书经常包含一个相当可用的版本，如果 VB（我不记得确切的名称，可能是 VB 6 学生版？）允许编译 .exe 文件。VB 5 教科书通常捆绑 VB 5 CCE，VB 4 书籍捆绑 VB 4 WM，这些都不是生产 VB 6 应用程序恕我直言的合适替代品，尤其是它们缺乏创建 .exe 文件的能力。

我会说，Visual Studio 2005 (VB 8) 很好地转换了 VB 6 应用程序，如果这是一个可接受的临时解决方案（它可能不满足大型 .NET 2.0 运行时的要求）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T06:30:12.360

要了解代码，您可以尝试在 MS Office / VBA 中编译部分应用程序。

当然，这只会提供有限的功能，但可能足以进行一些测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T07:06:11.333

亚马逊和 eBay 目前都有出售副本（虽然它们看起来有点贵，但这对您的客户来说是一个转嫁成本，所以他们是否支付这笔费用取决于他们）。

您可能想查看 VB.net 的许可证；它可能允许您运行以前版本的软件，例如 VB6（当然，您仍然需要获取实际媒体来安装它）。

MSDN“Visual Studio 2008 Professional with MSDN Professional”具有以前版本的 Visual Studio 工具，但售价为 1200 美元，因此，如果您只想要 VB6，eBay 是更好的选择。

请记住，MSDN 包包含所有 Visual Studio 语言和 VS6 到 VS2008，因此它可能拥有您需要的一切。

# python - 从映射列表中提取唯一项

> ID：186131
> 
> 赞同：2
> 
> 时间：2008-10-09T06:28:26.823
> 
> 标签：python, unique, duplicate-data

他是一个有趣的问题，正在寻找最 Pythonic 的解决方案。假设我有一个映射列表`{'id': id, 'url': url}`。列表中的某些`id`s 是重复的，我想创建一个新列表，删除所有重复项。我想出了以下功能：

```
def unique_mapping(map):
    d = {}
    for res in map:
        d[res['id']] = res['url']

    return [{'id': id, 'url': d[id]} for id in d] 
```

我想这是相当有效的。但是有没有“更 Pythonic”的方式？或者也许是一种更有效的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T07:47:09.597

您的示例可以稍微重写以使用生成器表达式构造第一个字典并消除构造另一个映射的必要性。只需重用旧的：

```
def unique_mapping(mappings):
    return dict((m['id'], m) for m in mappings).values() 
```

尽管这是单行的，但我仍然认为它具有很强的可读性。

使用您的原始解决方案和我的解决方案时，您必须记住两件事：

*   物品不会总是按照原来的顺序退回
*   后面的条目将覆盖以前具有相同 id 的条目

如果你不介意，那么我建议上面的解决方案。在其他情况下，此函数保留顺序并优先处理第一次遇到的 id：

```
def unique_mapping(mappings):
    addedIds = set()
    for m in mappings:
        mId = m['id']
        if mId not in addedIds:
            addedIds.add(mId)
            yield m 
```

`list(unique_mappings(mappings))`如果您需要列表而不是生成器，则可能需要调用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T07:54:23.453

有几件事你可以改进。

*   您正在执行两个循环，一个在原始字典上，然后在结果字典上再一次。相反，您可以一步建立结果。

*   您可以更改为使用生成器，以避免预先构建整个列表。（如果需要，请使用 list(unique_mapping(items)) 转换为完整列表）

*   仅检查重复项时无需存储值，您可以使用集合代替。

*   您正在为每个元素重新创建字典，而不是返回原始元素。这实际上可能是需要的（例如，您正在修改它们，并且不想接触原始的），但如果不需要，使用已经创建的字典会更有效。

这是一个实现：

```
def unique_mapping(items):
    s = set()
    for res in items:
        if res['id'] not in s:
            yield res
            s.add(res['id']) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T12:32:04.873

我认为这仍然可以变得更简单。字典不允许重复键。将您的映射列表制作成映射字典。这将删除重复项。

```
>>> someListOfDicts= [
    {'url': 'http://a', 'id': 'a'}, 
    {'url': 'http://b', 'id': 'b'}, 
    {'url': 'http://c', 'id': 'a'}]

>>> dict( [(x['id'],x) for x in someListOfDicts ] ).values()

[{'url': 'http://c', 'id': 'a'}, {'url': 'http://b', 'id': 'b'}] 
```

# php - Zend 框架的 MVC 数据设计问题

> ID：186142
> 
> 赞同：2
> 
> 时间：2008-10-09T06:31:40.950
> 
> 标签：php, database, zend-framework

如果我有一个类表示以类：表关系访问我的数据库中的一个表，那么我可以在一个类中隐藏表的详细信息。但作为任何有用的应用程序，我必须查询几个表。我如何使用 class:table 设计来适应这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T13:43:37.087

有几种不同的方法可以实现这一点，但是，您选择哪种方法实际上取决于您的情况。

1) 断开对象和数据库之间的连接

编写您的对象以与您的数据库表无关。首先规范化您的数据库表，然后查看应用程序的用户将如何与您的数据进行交互。将数据建模为对象，但不要将每个对象绑定到表（即使用 Zend_DB_Table_Abstract 类）

建立对象后，编写映射器类，将对象映射回数据库中的相关表。这些是扩展 Zend_DB_Table 的类（如果合适的话）。

您可以通过两种方式处理连接，或者通过 Zend_DB_Table 关系功能映射连接，或者，（恕我直言，更好的选择）只需使用 Zend_DB_Select 在您的映射器类中创建相关方法。

所以你有两个班级（可能是每张桌子，但并非总是如此）

人 PersonMapper

在您的代码中，当您想要使用某些对象时，可以创建一个新对象

```
$person = new Person();
$person->setName('andrew taylor'); 
```

然后将其写入映射器以保存它：

```
$personMapper = new PersonMapper();
$pesonnMapper->save($person); 
```

或者，以另一种方式进行：

```
$personMapper = new PersonMapper();
$person = personMapper->load(29);

$person->setName('joe bloggs');
$personMapper->save($person); 
```

从这里开始的下一步将是一个基于[SPL](http://www.php.net/spl)的集合类：

```
$personList = $personMapper->loadAllMen();

foreach($personList AS $person) {

 echo $person->getName();
} 
```

其中 $personMapper->loadAllMen() 是一个类似的方法：

```
$select = $this->select();
$select=>where('gender = "Male"');
$zendDbRows = this->fetchAll($select);

return new PersonList($zendDbRows); 
```

2) MySQL 视图

如果您有很多连接表，其中每个连接只有一行，那么您将根据订单表中的 id 连接客户信息，并且您正在以只读方式进行操作（所以您不想通过 Zend_DB_Table 适配器更新任何信息）创建规范化表，然后在顶部创建一个视图。视图在幕后处理连接，因此通过 Zend 感觉就像您正在连接到单个表。

对此有一些警告，MySQL 视图确实存在一些性能问题（这就是为什么它最好用于单行 FK 连接），并且它们是严格只读的。

# c# - 如何使用 Linq to SQL 添加到列表中？

> ID：186160
> 
> 赞同：2
> 
> 时间：2008-10-09T06:36:26.853
> 
> 标签：c#, .net, sql, linq, linq-to-sql

我在数据库中有一个表，我正在使用 LINQ to SQL 检索它，作为我处理的一部分，我想添加到这个列表中，然后用新项目和我所做的任何更改来更新数据库。

我认为我能做的是：

```
var list = (from item in db.Table
            select item).ToList();

[do processing where I modify items & add to the list]

list = list.Distinct();

db.SubmitChanges(); 
```

发生的情况是修改发生了（即 SQL 更新），但我添加到列表中的任何新项目都没有添加。

显然我做错了，修改和添加到数据库实体列表，然后提交所有更新和插入的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T07:07:55.077

列表毫无意义。它只是碰巧保存了 DataContext 知道的对象。我们需要确保 DataContext 知道新的。重要的是，当我们向 DataContext 提醒它们时，它们不必是完整的：

```
Item item;
if (needNewOne)
{
     item = new Item();
     db.InsertOnSubmit(item);
}
else
{
     item = list[i];
}
///  build new or modify existing item
///   :
db.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T07:39:15.200

你可以为它创建一个扩展方法：

```
static void EnsureInsertedOnSubmit<TEntity>( this Table<TEntity>  table
                                            ,IEnumerable<TEntity> entities)
 { foreach(var entity in entities) 
    { if  (   table.GetModifiedMembers(entity).Length == 0     
           && table.GetOriginalEntityState(entity) == default(TEntity))
       { table.InsertOnSubmit(entity);
       }
    }
 } 
```

然后你可以这样做：

```
 var list = db.Table1.ToList();
 list.Add(new Item());
 db.Table1.EnsureInsertedOnSubmit(list);
 db.SubmitChanges(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T06:46:55.787

您必须通过 InsertOnSubmit 添加新项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T07:10:33.230

您必须使用 InsertOnSubmit 告诉 LINQ 在提交时插入新行：

```
db.InsertOnSubmit(newrow);
db.SubmitChanges(); 
```

您不需要新的 DataContext，您可以使用您正在使用的进行更新。

与删除 DeleteOnSubmit(row) 相同。不过，修改将被跟踪。

# java - 您使用 Ant / JDK 1.4.x 生成 Websphere 6 EJB 的方法是什么？

> ID：186169
> 
> 赞同：1
> 
> 时间：2008-10-09T06:37:57.787
> 
> 标签：java, ant, websphere, ejb

几年前，我发现的唯一工作方法是：

1.  使用 XDoclet（ejbdoclet 任务）为每个会话 bean 生成 ibm-ejb-jar-bnd.xmi 和 ibm-ejb-jar-ext.xmi
2.  用任务 jar 制作一个 jar（没有存根）；;
3.  使用此 jar 调用二进制 EJBDEPLOY，而没有参数中的存根。

但我觉得必须有一个更清洁的方法。哪个是你的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T07:21:23.533

我使用 wsejbdeploy ant 任务，如果您使用的是 RAD 附带的 ws_ant，那么您可以在构建文件中包含如下内容

```
<taskdef name="wsejbdeploy" classname="com.ibm.websphere.ant.tasks.WsEjbDeploy"/>
<wsejbdeploy inputJar="${EjbJarFile}" outputJar="${tempEjbJarFile}" workingDirectory="${tempWS.dir}"  noWarnings="true" classpathref="project.classpath"/> 
```

# sql-server-2005 - SQL 2005 全文目录随机 sloooowww

> ID：186190
> 
> 赞同：4
> 
> 时间：2008-10-09T06:49:57.483
> 
> 标签：sql-server-2005, full-text-search

我在一个 SQL 2005 机器上构建了一个全文目录，在它重新构建过程完成后，运行速度非常慢。我已经实现了一个 hack（即 try...catch{do again}），这样我的用户就不会收到超时错误；这让我内心感觉很糟糕。所有后续查询都快如闪电。

有没有人遇到过这个问题并且有/是否有解决方案？谢谢！

PS是的，我已经谷歌了很多次。即使用我的左手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-06T16:32:34.023

它也可能是由我们经历过的这个 Sql Server '特性'引起的。

**在没有 Internet 访问权限的服务器上运行的 SQL Server 2005 实例中运行全文查询时，您可能会遇到 45 秒的延迟**

[http://support.microsoft.com/default.aspx/kb/915850](http://support.microsoft.com/default.aspx/kb/915850)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T14:44:36.107

这可能不是您问题的直接答案，但在 mssql 上的全文搜索已涵盖在 stackoverflow 播客系列中，结论是这不是最好的事情 :)

因此，如果您能够将其更改为 3rd 方库，您可以尝试 jeff & co. 使用的 Apache Lucene 库。Java 版本在[http://lucene.apache.org/java/docs/](http://lucene.apache.org/java/docs/)和 .net 端口在[http://incubator.apache.org/lucene.net/](http://incubator.apache.org/lucene.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T13:55:10.527

我也有这个。第一次打很慢，休息很快。试了各种办法都解决不了。

很想知道这个问题的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T16:43:51.747

您可以通过“设置启动后台更新索引”和“启动更改跟踪”（每个单词之间应该有一个下划线）在每个全文索引的表上避免完全重建索​​引。

这允许 sql server 仅在需要时使用更改来更新索引。由于未重建索引，因此它可能会对您的问题有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T00:20:35.180

我支持 Lucene.Net 的建议。我以前曾尝试使用全文搜索和 SQL 构建各种“搜索引擎”。当搜索条件变得复杂并且经常查询会超时时，总是会出现问题。在[我的新站点上](http://www.jobtree.com.au)，我使用 Lucene.Net 项目构建了搜索引擎，它运行得非常好，并且比 SQL FTS 快得多。

# svn - 哪些项目文件不应该签入 SVN

> ID：186196
> 
> 赞同：5
> 
> 时间：2008-10-09T06:54:57.830
> 
> 标签：svn

目前我检查了我的所有文件（包括 dll、VS 解决方案文件、图像等）。我经常需要将这些文件签出到登台服务器或另一个开发人员，因此将这些文件放在那里意味着项目已经准备就绪。

这里的最佳做法是什么？

编辑：如果我不添加生成的文件，如 dll 文件，我如何确保它们在更新登台服务器时存在？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T06:56:50.963

我通常只签入未生成的文件 - 所以源文件、配置文件、项目文件，而不是目标文件 - dll 的 exe 的 jar 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T07:07:53.517

在项目文件方面，不要签入“.csproj.user”文件或“.suo”文件。

此外，“bin”和“obj”文件夹中没有任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T07:28:13.427

如果每个人都使用相同的 IDE - 也请检查项目文件。它有助于进行适当的格式化程序设置、构建设置等。如果不是这种情况（例如，对于开源项目），只需保留代码和所需的构建文件。没有人关心您使用的是什么 IDE。

还要忽略编译或生成的所有内容。相反，请确保您的构建过程在需要时执行此操作。

我喜欢 Maven 处理这些东西的方式。我只是检查了这个项目，它只包含源代码而没有依赖项，如果我想将它导入到 eclipse 中，我所要做的就是运行`mvn eclipse:eclipse`并且一切都为我设置好了。如果我想摆脱特定于 Eclipse 的垃圾，我运行`mvn eclipse:clean`. 其他 IDE 也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T06:57:14.737

我检查作为项目一部分或项目依赖项的所有内容，包括但不限于它所依赖的程序集、生成数据库和测试数据的 SQL 脚本、单元测试、文档、图表，以及几乎所有其他内容开发人员需要。至于我不包括将生成的 dll、项目/解决方案生成的 pdb 和 xml 注释。

不过，作为旁注，有一个例外。有些项目可能要求某人有权访问解决方案，但可能无法编译/构建它。在这些情况下，根据项目是什么，我可能会包含最新的构建二进制文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T07:00:52.907

我只检查在其他计算机上编译项目所需的文件，包括 .lib 甚至 dll，但不检查预编译的头文件或用垃圾填充存储库的每个用户文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T07:02:53.650

任何生成的文件（已编译或发布 tarball 等）都应通过构建/发布机制检入版本控制系统的不同区域。

# python - 在 Python 中打开文件以进行独占访问的最佳方法是什么？

> ID：186202
> 
> 赞同：49
> 
> 时间：2008-10-09T06:58:54.907
> 
> 标签：python, file, locking

解决这个问题的最优雅的方法是什么：

*   打开文件进行读取，但前提是它尚未打开以进行写入
*   打开文件进行写入，但前提是它尚未打开以进行读取或写入

内置函数是这样工作的

```
>>> path = r"c:\scr.txt"
>>> file1 = open(path, "w")
>>> print file1
<open file 'c:\scr.txt', mode 'w' at 0x019F88D8>
>>> file2 = open(path, "w")
>>> print file2
<open file 'c:\scr.txt', mode 'w' at 0x02332188>
>>> file1.write("111")
>>> file2.write("222")
>>> file1.close() 
```

scr.txt 现在包含“111”。

```
>>> file2.close() 
```

scr.txt 已被覆盖，现在包含“222”（在 Windows 上，Python 2.4）。

该解决方案应该在同一个进程（如上面的示例中）以及另一个进程打开文件时工作。
如果一个崩溃的程序不会保持锁打开，这是首选。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-09T09:00:09.717

我认为没有完全跨平台的方式。在 unix 上， fcntl 模块将为您执行此操作。但是在 Windows 上（我假设你是通过路径），你需要使用 win32file 模块。

幸运的是，python 食谱中有一个使用平台适当方法的可移植实现（ [portalocker ）。](https://github.com/WoLpH/portalocker)

要使用它，请打开文件，然后调用：

```
portalocker.lock(file, flags) 
```

其中标志是 portalocker.LOCK_EX 用于独占写入访问，或 LOCK_SH 用于共享读取访问。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-12T02:46:56.523

> 该解决方案应该在同一个进程（如上面的示例中）以及另一个进程打开文件时工作。

如果“另一个进程”是指“任何进程”（即不是您的程序），那么在 Linux 中，仅依靠系统调用（*fcntl*和朋友）是无法完成此任务的。你想要的是[强制锁定](http://en.wikipedia.org/wiki/File_locking)，而 Linux 获取它的方式有点复杂：

*使用mand*选项重新挂载包含您的文件的分区：

```
# mount -o remount,mand /dev/hdXY
```

为您的文件设置*sgid*标志：

```
# chmod g-x,g+s yourfile
```

在您的 Python 代码中，获取对该文件的排他锁：

```
fcntl.flock(fd, fcntl.LOCK_EX)
```

现在，在您释放锁之前，即使*cat*也无法读取文件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-02-15T23:41:16.677

编辑：**我自己解决了！**通过使用***目录存在***和年龄作为锁定机制！按文件锁定仅在 Windows 上是安全的（因为 Linux 会默默地覆盖），但按目录锁定在 Linux 和 Windows 上都可以完美运行。请参阅我的 GIT，我为此创建了一个易于使用的类**“lockbydir.DLock”**：

[https://github.com/drandreaskrueger/lockbydir](https://github.com/drandreaskrueger/lockbydir)

在自述文件的底部，您可以找到 3 个 GITplayer，您可以在其中看到在浏览器中实时执行的代码示例！很酷，不是吗？:-)

感谢您的关注

* * *

## 这是我最初的问题：

我想回答 parity3 ( [https://meta.stackoverflow.com/users/1454536/parity3](https://meta.stackoverflow.com/users/1454536/parity3) ) 但我既不能直接发表评论（'你必须有 50 声望才能发表评论'），我也看不到任何联系方式他/她直接。你有什么建议给我，让他打通？

我的问题：

我已经实现了类似于 parity3 在这里建议的答案：[https](https://stackoverflow.com/a/21444311/3693375) ://stackoverflow.com/a/21444311/3693375 （“假设你的 Python 解释器，并且......”）

它运行良好 - 在 Windows 上。（我正在使用它来实现跨独立启动的进程工作的锁定机制[。https://github.com/drandreaskrueger/lockbyfile](https://github.com/drandreaskrueger/lockbyfile)）

但除了 parity3 说的，它在 Linux 上的工作方式不同：

> os.rename(src, dst)
> 
> 将文件或目录 src 重命名为 dst。... 在 Unix 上，如果 dst 存在并且是一个文件，如果用户有权限，它将被静默替换。如果 src 和 dst 在不同的文件系统上，该操作可能会在某些 Unix 风格上失败。如果成功，重命名将是一个原子操作（这是 POSIX 要求）。在 Windows 上，如果 dst 已经存在，将引发 OSError ( [https://docs.python.org/2/library/os.html#os.rename](https://docs.python.org/2/library/os.html#os.rename) )

无声替换是问题所在。在 Linux 上。“如果 dst 已经存在，将引发 OSError”对我的目的来说非常有用。但遗憾的是，仅在 Windows 上。

我猜 parity3 的例子大部分时间仍然有效，因为他的 if 条件

```
if not os.path.exists(lock_filename):
    try:
        os.rename(tmp_filename,lock_filename) 
```

但是整个事情不再是原子的了。

因为 if 条件可能在两个并行进程中为真，然后两者都会重命名，但只有一个会赢得重命名竞赛。并且没有引发异常（在 Linux 中）。

有什么建议么？谢谢！

PS：我知道这不是正确的方法，但我缺乏替代方法。请不要以降低我的声誉来惩罚我。我环顾四周，自己解决这个问题。如何在这里 PM 用户？我*为什么*不能呢？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T19:30:33.970

这是一个可移植实现的 win32 部分的开始，它不需要单独的锁定机制。

需要[Python for Windows Extensions](http://python.net/crew/mhammond/win32/)才能使用 win32 api，但这对于 windows 上的 python 来说已经是强制性的了，也可以使用[ctypes](http://www.python.org/doc/lib/module-ctypes.html)来完成。如果需要，可以调整代码以公开更多功能（例如允许`FILE_SHARE_READ`而不是根本不共享）。另请参阅 MSDN 文档以了解[`CreateFile`](http://msdn.microsoft.com/en-us/library/aa363858.aspx)和[`WriteFile`](http://msdn.microsoft.com/en-us/library/aa365747.aspx)系统调用，以及[有关创建和打开文件的文章](http://msdn.microsoft.com/en-us/library/aa363874.aspx)。

如前所述，如果需要，您可以使用标准[fcntl](http://www.python.org/doc/lib/module-fcntl.html)模块来实现 unix 的一半。

```
import winerror, pywintypes, win32file

class LockError(StandardError):
    pass

class WriteLockedFile(object):
    """
    Using win32 api to achieve something similar to file(path, 'wb')
    Could be adapted to handle other modes as well.
    """
    def __init__(self, path):
        try:
            self._handle = win32file.CreateFile(
                path,
                win32file.GENERIC_WRITE,
                0,
                None,
                win32file.OPEN_ALWAYS,
                win32file.FILE_ATTRIBUTE_NORMAL,
                None)
        except pywintypes.error, e:
            if e[0] == winerror.ERROR_SHARING_VIOLATION:
                raise LockError(e[2])
            raise
    def close(self):
        self._handle.close()
    def write(self, str):
        win32file.WriteFile(self._handle, str) 
```

以下是您上面的示例的行为方式：

```
>>> path = "C:\\scr.txt"
>>> file1 = WriteLockedFile(path)
>>> file2 = WriteLockedFile(path) #doctest: +IGNORE_EXCEPTION_DETAIL
Traceback (most recent call last):
    ...
LockError: ...
>>> file1.write("111")
>>> file1.close()
>>> print file(path).read()
111 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-01-17T21:50:28.297

我更喜欢使用[filelock](https://pypi.org/project/filelock/)，这是一个几乎不需要任何额外代码的跨平台 Python 库。以下是如何使用它的示例：

```
from filelock import FileLock

lockfile = r"c:\scr.txt"
lock = FileLock(lockfile + ".lock")
with lock:
    file = open(path, "w")
    file.write("111")
    file.close() 
```

块中的任何代码`with lock:`都是线程安全的，这意味着它将在另一个进程访问该文件之前完成。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-29T22:45:22.670

假设您的 Python 解释器，以及底层操作系统和文件系统将 os.rename 视为原子操作，并且当目标存在时会出错，则以下方法没有竞争条件。我在 linux 机器上的生产中使用它。不需要第三方库并且不依赖于操作系统，并且除了创建额外的文件之外，对于许多用例来说，性能损失是可以接受的。您可以在这里轻松应用 python 的函数装饰器模式或“with_statement”上下文管理器来抽象出混乱。

在新进程/任务开始之前，您需要确保 lock_filename 不存在。

```
import os,time
def get_tmp_file():
    filename='tmp_%s_%s'%(os.getpid(),time.time())
    open(filename).close()
    return filename

def do_exclusive_work():
    print 'exclusive work being done...'

num_tries=10
wait_time=10
lock_filename='filename.lock'
acquired=False
for try_num in xrange(num_tries):
    tmp_filename=get_tmp_file()
    if not os.path.exists(lock_filename):
        try:
            os.rename(tmp_filename,lock_filename)
            acquired=True
        except (OSError,ValueError,IOError), e:
            pass
    if acquired:
        try:
            do_exclusive_work()
        finally:
            os.remove(lock_filename)
        break
    os.remove(tmp_filename)
    time.sleep(wait_time)
assert acquired, 'maximum tries reached, failed to acquire lock file' 
```

**编辑**

os.rename 会默默地覆盖非 Windows 操作系统上的目的地。感谢您指出这一点@akrueger！

[这是一个解决方法，从这里](https://stackoverflow.com/questions/1348026/how-do-i-create-a-file-in-python-without-overwriting-an-existing-file)收集：

您可以使用以下命令代替使用 os.rename：

```
try:
    if os.name != 'nt': # non-windows needs a create-exclusive operation
        fd = os.open(lock_filename, os.O_WRONLY | os.O_CREAT | os.O_EXCL)
        os.close(fd)
    # non-windows os.rename will overwrite lock_filename silently.
    # We leave this call in here just so the tmp file is deleted but it could be refactored so the tmp file is never even generated for a non-windows OS
    os.rename(tmp_filename,lock_filename)
    acquired=True
except (OSError,ValueError,IOError), e:
    if os.name != 'nt' and not 'File exists' in str(e): raise 
```

@akrueger 您可能对基于目录的解决方案很好，只是为您提供了另一种方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T07:48:44.493

为了确保您在一个应用程序中打开文件时的安全，您可以尝试以下操作：

```
import time
class ExclusiveFile(file):
    openFiles = {}
    fileLocks = []

    class FileNotExclusiveException(Exception):
        pass

    def __init__(self, *args):

        sMode = 'r'
        sFileName = args[0]
        try:
            sMode = args[1]
        except:
            pass
        while sFileName in ExclusiveFile.fileLocks:
            time.sleep(1)

        ExclusiveFile.fileLocks.append(sFileName)

        if not sFileName in ExclusiveFile.openFiles.keys() or (ExclusiveFile.openFiles[sFileName] == 'r' and sMode == 'r'):
            ExclusiveFile.openFiles[sFileName] = sMode
            try:
                file.__init__(self, sFileName, sMode)
            finally:
                ExclusiveFile.fileLocks.remove(sFileName)
         else:
            ExclusiveFile.fileLocks.remove(sFileName)
            raise self.FileNotExclusiveException(sFileName)

    def close(self):
        del ExclusiveFile.openFiles[self.name]
        file.close(self) 
```

这样你就可以继承`file`类。现在只需执行以下操作：

```
>>> f = ExclusiveFile('/tmp/a.txt', 'r')
>>> f
<open file '/tmp/a.txt', mode 'r' at 0xb7d7cc8c>
>>> f1 = ExclusiveFile('/tmp/a.txt', 'r')
>>> f1
<open file '/tmp/a.txt', mode 'r' at 0xb7d7c814>
>>> f2 = ExclusiveFile('/tmp/a.txt', 'w') # can't open it for writing now
exclfile.FileNotExclusiveException: /tmp/a.txt 
```

如果您首先使用“w”模式打开它，它将不再允许打开，即使在读取模式下，正如您想要的那样......

# performance - Visual Studio 6 处理器包兼容性

> ID：186207
> 
> 赞同：5
> 
> 时间：2008-10-09T07:00:53.933
> 
> 标签：performance, intel, visual-c++-6, amd-processor, visual-studio-6

我已经看到一个处理器包可用于 Visual Studio 6，但它似乎仅适用于使用 SP5 的用户并且我已经在使用 SP6：

*此外，Visual C++ 处理器包 ​​(VCPP) 已从 Service Pack 6 中删除。如果您安装了 VCPP，安装 SP6 会将其从您的计算机中删除。如果您希望继续使用 VCPP，则需要继续使用 SP5 或迁移到 Visual Studio 2002 或 2003（推荐）。*

首先，这个处理器包是否与 Visual Studio 6 SP6 兼容？

其次，它真的对我有帮助吗？我担心从我的应用程序中获得最大收益，但它需要在所有类型的 Intel 和 AMD 芯片上运行，所以我不能只针对一个平台。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-10-12T19:59:37.627

重建系统，我刚刚遇到了这个问题，并找到了这篇 Microsoft 知识库文章 (872907)：[**您收到“错误：此版本的处理器包将只......**](http://support.microsoft.com/kb/872907)它适用于 VB，但我假设它适用于 VC++好吧。它似乎已经安装好了。一旦我完成了所有设置和编译，希望它真的安装好了。

**解决方案：**`latest`将注册表项 at修改`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\6.0\ServicePacks`为**5**而不是**6**。

处理器包安装停止抱怨。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T13:08:34.257

看起来线索在问题中：

此外，Visual C++ 处理器包 ​​(VCPP) 已从 Service Pack 6 中删除。如果您安装了 VCPP，安装 SP6 会将其从您的计算机中删除。如果您希望继续使用 VCPP，则需要继续使用 SP5 或迁移到 Visual Studio 2002 或 2003（推荐）。

我将升级到更新的 Visual Studio。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T07:23:53.077

我认为处理器包已经与 SP6 集成，如[下面的文档](http://msdn.microsoft.com/en-us/vs2005/aa718349.aspx)所述。

# latex - 乳胶款式 - 您使用什么以及在哪里可以找到它们

> ID：186208
> 
> 赞同：18
> 
> 时间：2008-10-09T07:01:12.797
> 
> 标签：latex, styles

您使用什么乳胶样式，在哪里可以找到它们？

我问这个的原因是，互联网上所有样式中似乎有 99.9999% 是彼此的副本和[物理试卷的副本](http://www.tug.org/texshowcase/ps_s_1b.pdf)

然而，当你试图为这样的论文找到一种风格时[......](http://www.tug.org/texshowcase/en_gb_eclipse_114.pdf)祝你好运，你永远找不到它。

创建自己的样式通常不是一个真正的选择，因为它需要您深入挖掘 TeX/LaTeX 的非常高级的功能，并与文档类/包/whatnot 可能存在的不兼容问题作斗争。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T08:51:31.963

LaTeX 最初被设计为一个相当灵活的系统，其中分布了一些标准类——它们本身就相当*灵活*。

在目前的情况下，如果您想要自定义布局，您需要自己编写一些支持代码。不然怎么会发生？它不像 HTML+CSS 为您提供模板来使用；您需要自己实现设计。

> 创建自己的风格通常不是一种选择

啊，好吧，除非你知道如何用 LaTeX 编程！

说真的，这一切都取决于知道从哪里开始以及在什么基础上构建。在我看来，您作为示例提供的目录在 LaTeX 中相当容易实现；它只是一堆盒子。

你可以写类似

```
\newcommand\catalogueEntry[4]{%
  \parbox[t]{0.23\linewidth}{\textbf{#1}}%
  \hfill
  \parbox[t]{0.23\linewidth}{\includegraphics{#2}}%
  \hfill
  \parbox[t]{0.23\linewidth}{\textbf{Characteristics}\\ #3}%
  \hfill
  \parbox[t]{0.23\linewidth}{\textbf{Application}\\ #4}
} 
```

并这样使用它

```
\catalogueEntry{Spotlights}{spotlight.jpg}
  {Eclipse spotlights are...}
  {Narrow to medium...} 
```

这只是一个可以快速完成的基本说明——可以使用更复杂的方法将其转变为更灵活的系统。

我认为 LaTeX 是一个可扩展的标记系统。如果您将标记与其在页面上的呈现分开，那么让您的信息以您希望的任何形式呈现都不会太难。但是入门有点棘手，我不得不承认；LaTeX 编程的学习曲线可能相当陡峭。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-02T07:26:54.363

[Memoir](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/)是一个比默认的更灵活的文档类，它的[手册](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/memman.pdf)非常好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T07:51:25.160

好吧，我认为[CTAN](http://ctan.org/)是 LaTeX 和 TeX 相关内容的最佳资源。许多科学组织也提供自己的风格，尝试追踪您喜欢的论文的作者/出版者并查看他们的网站是有意义的。

# asp.net - ASP.Net 1.1 中的运行时错误

> ID：186211
> 
> 赞同：0
> 
> 时间：2008-10-09T07:03:01.327
> 
> 标签：asp.net, asp.net-1.1

我使用的是 Windows 2003。我已将 Web 应用程序映射到虚拟目录。这是建立在框架 1.1 上的，当我尝试浏览到默认页面时，我收到一个错误

说明：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

解析器错误消息：访问被拒绝：'Interop.MSDASC'。

源错误：

第 196 行： 第 197 行： 第 198 行： 第 199 行： 第 200 行：

源文件：c:\windows\microsoft.net\framework\v1.1.4322\Config\machine.config 行：198

程序集加载跟踪：以下信息有助于确定无法加载程序集“Interop.MSDASC”的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-09T07:16:43.310

两个想法...

您的 Web 应用程序 bin 文件夹中是否有 Interop.MSDASC dll？这个互操作库使用的 com 组件是否安装在这台机器上？
这些文件的权限是否有任何奇怪的事情发生？

祝你好运，听起来很糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T07:21:51.863

标准 machine.Config 的第 198 行包含以下行：

```
 <add assembly="*"/> 
```

我假设是从本地 bin 目录加载所有程序集。此目录似乎包含程序集 Interop.MSDASC，并且 IIS 由于“拒绝访问”错误而无法加载此程序集。

需要检查的一些事项：

*   运行您的 Web 应用程序的帐户（默认为网络服务帐户）是否有权访问此文件。

*   你的网络应用真的需要这个程序集吗？AFAIK tt's for the Microsoft Data Link API，它允许应用程序提示用户输入 OLEDB 连接信息——我不明白你为什么要在 Web 应用程序中使用它。

# wpf - 在 WPF 样式中，触发器如何访问它所附加的元素的子元素

> ID：186217
> 
> 赞同：2
> 
> 时间：2008-10-09T07:06:47.137
> 
> 标签：wpf, triggers

下面是ListBoxItem的一个Simple Style，ListBoxItem有一个子Border。Border 有一个值为 8 的 Padding 属性，我想在选择项目时将值更改为 0。如何编写触发器？

```
 <??Style TargetType="{x:Type ListBoxItem}">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}" >
                    <Border 
                        SnapsToDevicePixels="True" 
                        HorizontalAlignment="Center" 
                        VerticalAlignment="Center"
                        Padding = "8"
                        Background="{TemplateBinding Background}">
                        <ContentPresenter />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            ??<Setter Property="Padding" Value="0" />??   <----How Can I do this?
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    <??/Style> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T07:17:48.440

尝试为边框命名（例如，使用 x:Name="border1"），然后使用 Setter 的[TargetName](http://msdn.microsoft.com/en-us/library/system.windows.setter.targetname.aspx)属性，如下所示：

```
<Setter TargetName="border1" Property="Padding" Value="0" /> 
```

不确定它是否可以在这样的控制模板中工作，但试一试。

# c# - EPiServer 是线程安全的吗？

> ID：186222
> 
> 赞同：5
> 
> 时间：2008-10-09T07:08:12.593
> 
> 标签：c#, asp.net, multithreading, episerver

我在 www.episerver.com 或 world.episerver.com 上都找不到任何相关信息，有人知道吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T07:10:18.127

从我所看到的 Episerver 使用两种机制来实现线程安全：

*   锁定（初始化昂贵的资源时）
*   不可变数据（传递页面数据时）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T08:47:02.987

线程安全是一个模糊的概念。在这种特殊情况下，如果您在不同请求之间共享数据，则不是。否则，根据网络请求的性质，它是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T07:15:42.807

是的，根据定义，它是线程安全的，因为它在使用线程执行的 Web 服务下运行（因此它必须是线程安全的，否则它是一个错误，并且这些错误很少 - 但没有人报告 CMS R2 我可以在错误列表中看到的内容）。

# nhibernate - NHibernate 双向多对多关联

> ID：186229
> 
> 赞同：5
> 
> 时间：2008-10-09T07:12:52.757
> 
> 标签：nhibernate

我有一堂课，描述如下：

```
public class Customer {
    public ISet<Client> Contacts { get; protected set;}
} 
```

我想将 Contacts 属性映射到下表：

```
CREATE TABLE user_contacts (
    user1 uuid NOT NULL,
    user2 uuid NOT NULL
) 
```

我希望它双向映射，即当 Customer1 添加到 Customer2 的联系人时，Customer1 的联系人集合应该包含 Customer2（可能仅在实体重新加载后）。我怎么能那样做？

**更新**当然我可以映射从左到右和从右到左的集合，然后在运行时组合，但它会......嗯......不好吃......还有其他解决方案吗？无论如何，非常感谢你，**FryHard**！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T07:21:19.947

看看这个关于 hibernate 称为单向[多对多关联的](http://www.hibernate.org/hib_docs/v3/reference/en/html_single/#assoc-unidirectional-join-m2m)链接。在[Castle ActiveRecord](http://www.castleproject.org/activerecord/index.html)中，我使用了 HasAndBelongsToMany 链接，但我不确定它在 nhibernate 中是如何映射的。

尽管更深入地研究了您的问题，但看起来您将从客户到 user_contacts 进行双向链接，这可能会破坏多对多链接。我将举一个例子，看看我能想出什么。

从 ActiveRecord 导出 hbm 文件显示了这一点

```
<?xml version="1.0" encoding="utf-16"?>
<hibernate-mapping  auto-import="true" default-lazy="false" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="urn:nhibernate-mapping-2.2">
  <class name="NHibernateMapping.Customer, NHibernateMapping" table="Customer" schema="dbo">
    <id name="Id" access="property" column="Id" type="Int32" unsaved-value="0">
      <generator class="identity">
      </generator>
    </id>
    <property name="LastName" access="property" type="String">
      <column name="LastName" not-null="true"/>
    </property>
    <bag name="ChildContacts" access="property" table="user_contacts" lazy="false">
      <key column="user1" />
      <many-to-many class="NHibernateMapping.Customer, NHibernateMapping" column="user2"/>
    </bag>
    <bag name="ParentContacts" access="property" table="user_contacts" lazy="false" inverse="true">
      <key column="user2" />
      <many-to-many class="NHibernateMapping.Customer, NHibernateMapping" column="user1"/>
    </bag>
  </class>
</hibernate-mapping> 
```

活动记录示例：

```
[ActiveRecord("Customer", Schema = "dbo")]
public class Customer
{
    [PrimaryKey(PrimaryKeyType.Identity, "Id", ColumnType = "Int32")]
    public virtual int Id { get; set; }

    [Property("LastName", ColumnType = "String", NotNull = true)]
    public virtual string LastName { get; set; }

    [HasAndBelongsToMany(typeof(Customer), Table = "user_contacts", ColumnKey = "user1", ColumnRef = "user2")]
    public IList<Customer> ChildContacts { get; set; }

    [HasAndBelongsToMany(typeof(Customer), Table = "user_contacts", ColumnKey = "user2", ColumnRef = "user1", Inverse = true)]
    public IList<Customer> ParentContacts { get; set; }
} 
```

希望能帮助到你！

# c++ - 导出 DLL C++ 类，关于 .def 文件的问题

> ID：186232
> 
> 赞同：2
> 
> 时间：2008-10-09T07:13:54.797
> 
> 标签：c++, build, windows-ce, nmake, function

我想在我的项目中使用隐式链接，nmake 真的想要一个 .def 文件。问题是，这是一个类，我不知道在导出部分写什么。谁能指出我正确的方向？

错误消息如下：

**NMAKE : U1073: 不知道如何制作 'DLLCLASS.def'**

PS：我正在尝试使用 Windows CE Platform Builder 进行构建。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T07:21:00.167

如果我没记错的话，您可以`__declspec(dllexport)`在*class*上使用，VC++ 会自动为与该类相关的所有符号（构造函数/析构函数、方法、vtable、typeinfo 等）创建导出。

Microsoft 在[此处](http://msdn.microsoft.com/en-us/library/81h27t8c(VS.80).aspx)提供了更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T11:32:08.693

您始终可以使用[dumpbin](http://msdn.microsoft.com/en-us/library/c1h23y6c(VS.80).aspx) /symbols myclass.obj找到成员函数的修饰名称

就我而言

```
class A {
   public:
     A( int ){}
}; 
```

`dumpbin`转储显示符号`??0A@@QAE@H@Z (public: __thiscall A::A(int))`

将此符号放在 .def 文件中会导致链接器在导出符号中创建 A::A(int) 符号。

**但！**正如@paercebal 在他的评论中所说：手动输入修饰（损坏）名称是一件苦差事——容易出错，而且很遗憾，不能保证在编译器版本之间移植。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-03-23T08:26:18.780

我找到了成为抽象工厂的最佳途径。

首先定义一个纯虚拟基类。这是一个没有实现的类，一个纯粹的虚拟接口类。

您可以导出这个虚拟基础“抽象接口”类，但没有真正的理由这样做。当调用者使用它时，他们将通过一个指针（PImpl，或指向实现的指针）来使用它，所以调用者所知道的只是一个简单的内存地址。Def 文件虽然需要更多的工作来跟上，但提供的好处超出了 __declspec(dllexport) 所能达到的范围。你问有什么好处？我们会解决的，你等着。

让你的真实类从虚拟基础公开继承。现在创建一个工厂方法来构造你的对象和一个“*释放*”可调用的析构函数来执行清理。将这些方法命名为“ *ConstructMyClass* ”和“ *ReleaseMyClass* ”。拜托，请替换“ *MyClass* ” :-)

如果需要任何参数（普通旧数据：整数、字符等），那些工厂/发布方法应该只采用 POD 类型。返回类型应该是您的虚拟抽象接口基类——或者更确切地说，是指向它的指针。

IMyClass* CreateAnObjectOfTypeIMyClass();

也许现在很明显为什么我们需要虚拟基类？由于虚拟接口类没有实现，它本质上是所有 POD 类型（某种），因此大多数调用者（如 Visual Basic、C 或截然不同的 C++ 编译器）都可以理解该类的“数据类型”。

如果你足够花哨，你可以绕过对“*手动发布*”方法的需求（抱歉，不得不这样做）。如何？通过智能指针和 pImpl 类型的体系结构在类中管理您自己的资源，因此当对象死亡时，它会自行清理。这样做意味着，用我们的圣人和救世主[斯科特·迈耶斯 (Scott Meyers) 的不朽名言来说，您的班级是“*易于正确使用，难以正确使用*”](http://programmer.97things.oreilly.com/wiki/index.php/Make_Interfaces_Easy_to_Use_Correctly_and_Hard_to_Use_Incorrectly)，让调用者无视清理的需要。让我们中间那些从未忘记调用“ *.close* ”的人投下第一块石头。

也许这种架构听起来很熟悉？它应该，它基本上是 COM 的微机版本。好吧，至少是接口、工厂构建和发布的概念。

最后，您已经为您的类导出了接口，创建（并导出）了*Create*和*Destroy*方法，现在调用者可以调用您的*PleaseConstructMyClass*工厂函数，让您的 DLL 在伪装下返回一个完全构造、完全实现和完全烘焙的对象它的界面。他们可以调用类的所有公共方法（至少是抽象虚拟接口中的方法）并做所有有趣的事情。

当他们完成了工厂函数返回的对象时，他们可以调用“ *ReleaseMyClass* ”函数来要求你的DLL清理对象的资源，或者你可以通过让你的类清理自己来帮助他们，使“ *ReleaseMyClass* ”方法是多余且无用的。

如果有人对使用 Def 文件和界面的具体收益和权衡感兴趣（除了我的盲说），请竖起大拇指，我们可以更深入地挖掘。

你不只是喜欢这些东西吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T08:39:46.857

解决方案如下：

*   由于导出了一个类，因此还需要在 .def 文件中添加导出的方法

*   我不知道如何导出构造函数，所以我使用了工厂方法（静态），它将返回对象的新实例

*   其他函数将通过在 .def 文件中添加正常的导出声明来导出

希望有人会从这些信息中受益。

# php - 简单的 IIS 安装 php

> ID：186234
> 
> 赞同：4
> 
> 时间：2008-10-09T07:17:34.837
> 
> 标签：php, iis

iis 上是否有用于 php + mysql 的“一体化”安装程序？最好带有gui配置界面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-26T01:00:09.483

使用 Web 平台安装程序，PHP 部分很容易：

[http://php.iis.net/](http://php.iis.net/)

在 Windows 上安装 MySQL 是一件轻而易举的事：

[http://dev.mysql.com/downloads/mysql/5.1.html#win32](http://dev.mysql.com/downloads/mysql/5.1.html#win32)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T07:29:32.287

我不知道有任何适用于 MySql 和 PHP 的一体化安装程序，但 PHP 本身带有一个自动安装程序，可以将自己附加到 IIS - 但首选方法仍然是手动的（自动程序仅使用 CGI）。网络上有很多操作指南页面，它们为您提供了设置所需的分步过程（这些过程因您的 IIS 版本而异）——我建议您改用其中之一。

一些帮助您入门的链接：
[PHP 文档](http://www.php.net/manual/en/install.windows.iis.php)
[通过 5 个简单步骤在 IIS 上安装 PHP 5](http://www.iis-aid.com/articles/how_to_guides/installing_php_5_on_iis_in_5_simple_steps)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T07:47:36.523

我知道这不是一个直接的答案，而只是一个***兴趣点***。如果您正在寻找运行 php/mysql 的快速设置以进行测试的东西，您可以尝试使用[虚拟设备](http://virtualappliances.net/products/lamp.php)+ [vmware 服务器](http://www.vmware.com/products/server/)/[播放器](http://www.vmware.com/products/player/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-02T13:30:19.010

我不知道任何一体式安装程序，但您最好单独安装 MySQL 和 PHP。这很简单。

MySQL 在 windows 中有一个 GUI 安装向导。我假设你知道在哪里下载这个。您可以从此处的 Microsoft 网站下载适用于 IIS 的 PHP。安装时会有一定的GUI界面：http: [//www.microsoft.com/web/gallery/install.aspx?appid=PHP53](http://www.microsoft.com/web/gallery/install.aspx?appid=PHP53)

您可能仍需要通过手动编辑 php.ini 文件来引用 MySQL。这是一个特别好的常见问题解答： [http ://learn.iis.net/page.aspx/353/install-and-configure-mysql-for-php-applications-on-iis-7-and-above/](http://learn.iis.net/page.aspx/353/install-and-configure-mysql-for-php-applications-on-iis-7-and-above/)

# c++ - 程序仅在发布版本时崩溃——如何调试？

> ID：186237
> 
> 赞同：101
> 
> 时间：2008-10-09T07:18:42.980
> 
> 标签：c++, debugging

我在这里遇到了“薛定谔猫”类型的问题——我的程序（实际上是我的程序的测试套件，但仍然是一个程序）正在崩溃，但只有在发布模式下构建时，并且只有在从命令行启动时. 通过穴居人调试（即到处都是讨厌的 printf() 消息），我确定了代码崩溃的测试方法，但不幸的是，实际崩溃似乎发生在某些析构函数中，因为我看到的最后一条跟踪消息在其他干净执行的析构函数。

当我尝试在 Visual Studio 中运行该程序时，它不会崩溃。从 WinDbg.exe 启动时也是如此。崩溃仅在从命令行启动时发生。这是在 Windows Vista 下发生的，顺便说一句，不幸的是我现在无法访问 XP 机器进行测试。

如果我能让 Windows 打印出堆栈跟踪，或者不是简单地终止程序，就好像它已经干净地退出一样，那将是非常*好的*。有没有人对我如何在这里获得一些更有意义的信息并希望修复这个错误有任何建议？

编辑：问题确实是由越界数组引起的，[我在这篇文章中对此进行了更多描述](https://stackoverflow.com/questions/186237/program-only-crashes-as-release-build-how-to-debug#187966)。感谢大家帮助找到这个问题！

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-10-09T07:41:26.583

在我见过或听说过的 100% 的案例中，C 或 C++ 程序在调试器中运行良好但在外部运行时失败，原因是写入超出了函数本地数组的末尾。（调试器在堆栈上放了更多东西，所以你不太可能覆盖重要的东西。）

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-10-09T07:24:56.210

当我之前遇到这样的问题时，通常是由于变量初始化。在调试模式下，变量和指针会自动初始化为零，但在发布模式下不会。因此，如果您有这样的代码

```
int* p;
....
if (p == 0) { // do stuff } 
```

在 debug 模式下 if 中的代码没有被执行，但是在 release 模式下 p 包含一个未定义的值，这个值不太可能是 0，所以代码被执行经常会导致崩溃。

我会检查你的代码是否有未初始化的变量。这也适用于数组的内容。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-08-29T14:01:03.810

到目前为止，还没有答案试图对调试发布应用程序的可用技术进行认真的概述：

1.  **由于许多原因，发布和调试版本的行为不同。** [这是一个很好的概述。](https://stackoverflow.com/questions/312312/what-are-some-reasons-a-release-build-would-run-differently-than-a-debug-build?rq=1)这些差异中的每一个都可能导致发布版本中出现调试版本中不存在的错误。

2.  **调试器的存在也可能改变程序的行为**，无论是发布版本还是调试版本。[看到这个答案。](https://stackoverflow.com/a/811980/214777)简而言之，至少 Visual Studio 调试器在附加到程序时会自动使用调试堆。您可以使用环境变量 _NO_DEBUG_HEAP 关闭调试堆。您可以在计算机属性或 Visual Studio 的项目设置中指定此设置。这可能会使附加调试器的崩溃重现。

    [更多关于调试堆损坏here。](https://stackoverflow.com/questions/1010106/how-to-debug-heap-corruption-errors?lq=1)

3.  如果之前的解决方案不起作用，您需要捕获未处理的异常并在发生崩溃的实例时**附加一个事后调试器。**您可以为此使用例如 WinDbg，[有关可用事后调试器及其在 MSDN 上的安装的详细信息](http://msdn.microsoft.com/en-us/library/windows/hardware/ff542967(v=vs.85).aspx)

4.  您可以改进您的异常处理代码，如果这是一个生产应用程序，您应该：

    一种。**使用安装自定义终止处理程序[`std::set_terminate`](http://en.cppreference.com/w/cpp/error/set_terminate)**

    如果你想在本地调试这个问题，你可以在终止处理程序中运行一个无限循环，并将一些文本输出到控制台以通知你`std::terminate`已被调用。然后附加调试器并检查调用堆栈。 [或者您按照此答案中的描述打印堆栈跟踪。](https://stackoverflow.com/questions/691719/c-display-stack-trace-on-exception?rq=1)

    在生产应用程序中，您可能希望将错误报告发送回家，理想情况下[，还需要一个小的内存转储，以便您按此处所述分析问题。](https://stackoverflow.com/questions/1547211/how-to-create-minidump-for-my-process-when-it-crashes)

    湾。**使用 Microsoft 的结构化异常处理机制**，该机制允许您捕获硬件和软件异常。[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681409(v=vs.85).aspx)。您可以使用 SEH 保护部分代码，并使用与 a) 中相同的方法来调试问题。SEH 提供了有关您在从生产应用程序发送错误报告时可以使用的异常的更多信息。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-10-09T08:15:37.607

需要注意的事项：

数组溢出 - Visual Studio 调试器插入可能会阻止崩溃的填充。

竞争条件 - 如果竞争条件仅在直接执行应用程序时出现，您是否涉及多个线程。

链接 - 您的发布版本是否包含正确的库。

要尝试的事情：

Minidump - 非常易于使用（只需在 msdn 中查找）将为您提供每个线程的完整故障转储。您只需将输出加载到 Visual Studio 中，就好像您在崩溃时正在调试一样。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-09T07:33:04.837

您可以将 WinDbg 设置为您的事后调试器。当崩溃发生时，这将启动调试器并将其附加到进程。要安装 WinDbg 以进行事后调试，请使用 /I 选项（注意它是**大写**的）：

```
windbg /I 
```

更多细节[在这里](http://msdn.microsoft.com/en-us/library/cc266343.aspx)。

至于原因，它很可能是其他答案所暗示的统一变量。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-09T16:04:55.023

经过几个小时的调试，终于找到了问题的原因，确实是缓冲区溢出造成的，导致了单字节差异：

```
char *end = static_cast<char*>(attr->data) + attr->dataSize; 
```

这是一个栅栏错误（一个错误），并通过以下方式修复：

```
char *end = static_cast<char*>(attr->data) + attr->dataSize - 1; 
```

奇怪的是，我在代码的各个部分对 _CrtCheckMemory() 进行了多次调用，它们总是返回 1。我能够通过放置“return false;”来找到问题的根源；调用测试用例，然后通过反复试验最终确定故障所在。

谢谢大家的评论——我今天学到了很多关于windbg.exe的知识！:)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-09T07:51:03.193

即使您已将 exe 构建为发行版，您仍然可以生成 PDB（程序数据库）文件，这些文件将允许您进行堆栈跟踪，并进行有限数量的变量检查。在您的构建设置中，有一个创建 PDB 文件的选项。打开它并重新链接。然后尝试先从 IDE 运行以查看是否出现崩溃。如果是这样，那就太好了——你们都准备好了。如果没有，那么从命令行运行时，您可以执行以下两项操作之一：

1.  运行 EXE，并在崩溃之前执行附加到进程（Visual Studio 上的工具菜单）。
2.  崩溃后，选择启动调试器的选项。

当被要求指向 PDB 文件时，浏览以找到它们。如果 PDB 与您的 EXE 或 DLL 放在相同的输出文件夹中，它们可能会被自动拾取。

PDB 提供了一个指向源的链接，其中包含足够的符号信息，以便可以查看堆栈跟踪、变量等。您可以正常检查这些值，但请注意，您可能会得到错误的读数，因为优化通过可能只意味着事情出现在寄存器中，或者事情发生的顺序与您预期的不同。

注意：我在这里假设一个 Windows/Visual Studio 环境。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-09T07:29:31.973

几乎总是会导致这样的崩溃，因为 IDE 通常会将未初始化变量的内容设置为零、null 或其他类似的“合理”值，而在本机运行时，您将得到系统拾取的任何随机垃圾。

因此，您的错误几乎可以肯定是您正在使用类似于在正确初始化之前使用指针的东西，并且您在 IDE 中逃脱了它，因为它没有指向任何危险的地方 - 或者该值由您处理错误检查 - 但在发布模式下它会做一些讨厌的事情。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-09T07:38:51.457

为了获得可以分析的故障转储：

1.  为您的代码生成 pdb 文件。
2.  你 rebase 让你的 exe 和 dll 加载到同一个地址。
3.  启用事后调试器，例如[Dr. Watson](http://support.microsoft.com/kb/308538)
4.  使用诸如[crash finder](http://www.wintellect.com/CS/blogs/jrobbins/archive/2006/04/19/crashfinder-returns.aspx)之类的工具检查崩溃故障地址。

您还应该查看[Debugging tools for windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)中的工具。您可以监控应用程序并查看在您的第二次机会异常之前的所有第一次机会异常。

希望能帮助到你...

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-02-06T19:07:33.793

调试此类错误的一个好方法是为您的调试构建启用优化。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-09T08:25:20.363

当应用程序的行为与您的相似时，我遇到了问题。事实证明这是 sprintf 中令人讨厌的缓冲区溢出。自然，它在附加调试器的情况下运行时起作用。我所做的是安装一个未处理的异常过滤器（[SetUnhandledExceptionFilter](http://msdn.microsoft.com/en-us/library/ms680634(VS.85).aspx)），我只是在其中无限地阻塞（在超时值为 INFINITE 的虚假句柄上使用 WaitForSingleObject）。

因此，您可以采用以下方式：

```
长 __stdcall MyFilter(EXCEPTION_POINTERS *)
{
    处理 hEvt=::CreateEventW(0,1,0,0);
    如果（hEvt）
    {
        如果（WAIT_FAILED==::WaitForSingleObject（hEvt，无限））
        {
            //日志失败
        }
    }

}
// 在你的 wmain/WinMain 的某个地方：
SetUnhandledExceptionFilter(MyFilter);

```

然后我在错误出现后附加了调试器（gui程序停止响应）。

然后，您可以转储并稍后使用它：

> .dump /ma path_to_dump_file

或者马上调试。最简单的方法是跟踪运行时异常处理机制保存处理器上下文的位置：

> sd esp*范围*1003f

提供搜索长度的命令将在堆栈地址空间中搜索 CONTEXT 记录。我通常使用类似*'l?10000' 的*东西。请注意，不要使用异常大的数字作为您通常在未处理的异常过滤器框架附近的记录。1003f 是用于捕获处理器状态的标志组合（我相信它对应于 CONTEXT_FULL）。您的搜索将与此类似：

> 0:000> sd esp l1000 1003f
> **0012c160** 0001003f 00000000 00000000 00000000 ?................

得到结果后，使用 cxr 命令中的地址：

> .cxr **0012c160**

这将在崩溃时将您带到这个新的 CONTEXT（您将在应用程序崩溃时准确地获得堆栈跟踪）。此外，使用：

> .exr -1

找出究竟发生了哪个异常。

希望能帮助到你。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-05-28T09:28:37.610

有时会发生这种情况，因为您将重要操作包装在“断言”宏中。您可能知道，“assert”仅在调试模式下评估表达式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-09T07:38:25.730

关于获取诊断信息的问题，您是否尝试过使用 adplus.vbs 作为 WinDbg.exe 的替代品？要附加到正在运行的进程，请使用

```
adplus.vbs -crash -p <process_id> 
```

或者在崩溃迅速发生的情况下启动应用程序：

```
adplus.vbs -crash -sc your_app.exe 
```

有关 adplus.vbs 的完整信息，请访问：http: [//support.microsoft.com/kb/286350](http://support.microsoft.com/kb/286350)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-09T09:39:30.713

## 带有调试器的 Ntdll.dll

从 IDE 或 WinDbg 启动程序与从命令行/桌面启动程序之间的一个鲜为人知的区别是，当使用附加的调试器（即 IDE 或 WinDbg）启动时，ntdll.dll 使用不同的堆实现来执行一些小验证关于内存分配/释放。

[您可能会在 ntdll.dll](http://www.debuginfo.com/tips/userbpntdll.html)中的意外用户断点中阅读一些相关信息。一种可以帮助您识别问题的工具是[PageHeap.exe](http://support.microsoft.com/?id=286470)。

## 崩溃分析

您没有写出您正在经历的“崩溃”是什么。一旦程序崩溃并让您将错误信息发送给 Microsoft，您应该能够单击技术信息并至少检查异常代码，并且通过一些努力您甚至可以执行事后分析（参见[Heisenbug : WinApi 程序在某些计算机上崩溃）](https://stackoverflow.com/questions/132116/heisenbug-winapi-program-crashes-on-some-computers#132189)获取说明）

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-08-19T16:16:40.033

Vista SP1 实际上在系统中内置了一个非常好的故障转储生成器。不幸的是，默认情况下它没有打开！

请参阅这篇文章： http: [//msdn.microsoft.com/en-us/library/bb787181 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb787181(VS.85).aspx)

这种方法的好处是不需要在受影响的系统上安装额外的软件。抓住它，撕开它，宝贝！

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-03-28T20:15:28.260

根据我的经验，这主要是内存损坏问题。

例如 ：

```
char a[8];
memset(&a[0], 0, 16);

: /*use array a doing some thing */ 
```

运行代码时很有可能在调试模式下正常。

但在发布时，那会/可能会崩溃。

对我来说，翻找记忆越界的地方太辛苦了。

使用[Visual Leak Detector](https://vld.codeplex.com/SourceControl/latest#README.md) (windows) 或[valgrind](http://valgrind.org/) (linux) 等工具是更明智的选择。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-05-01T15:15:12.337

我看到了很多正确的答案。但是，没有一个对我有帮助。就我而言，**未对齐内存的***SSE 指令*使用错误。看看你的数学库（如果你使用的话），并尝试禁用 SIMD 支持，重新编译并重现崩溃。

 ***例子：*

一个项目包括[mathfu](https://github.com/google/mathfu "数学")，并使用带有 STL 向量的类：**std::vector< mathfu::vec2 >**。**这样的使用可能会在构建mathfu::vec2**项时导致崩溃，因为 STL 默认分配器不保证所需的 16 字节对齐。在这种情况下，为了证明这个想法，可以在[mathfu](https://github.com/google/mathfu "mathfu")`#define MATHFU_COMPILE_WITHOUT_SIMD_SUPPORT 1`的每个包含之前定义，在 Release 配置中重新编译并再次检查。

**Debug**和**RelWithDebInfo**配置适用于我的项目，但不适用于**Release**。这种行为背后的原因可能是因为调试器处理分配/解除分配请求并进行一些内存簿记以检查和验证对内存的访问。

*我在 Visual Studio 2015 和 2017 环境中体验过这种情况。*

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-09T07:26:32.400

我曾经在 GCC 上发生过类似的事情。结果证明这是一个过于激进的优化，仅在创建最终版本时启用，而不是在开发过程中启用。

好吧，说实话，这是我的错，而不是 gcc 的错，因为我没有注意到我的代码依赖于不会进行特定优化的事实。

我花了很多时间来追踪它，我只是因为我在一个新闻组上问过，有人让我思考它才找到它。所以，让我回报一下，以防万一这也发生在你身上。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-09T07:34:21.933

我发现这篇[文章](http://www.codeproject.com/KB/debug/releasemode.aspx)对您的场景很有用。ISTR 的编译器选项有点过时了。查看您的 Visual Studio 项目选项，了解如何为您的发布版本生成 pdb 文件等。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-09T07:46:18.180

怀疑它会发生在调试器之外而不是内部；在调试器中运行通常不会改变应用程序的行为。我会检查控制台和 IDE 之间的环境差异。此外，显然，编译没有优化和调试信息的版本，看看这是否会影响行为。最后，看看其他人在这里推荐的事后调试工具，通常你可以从中得到一些线索。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-09T08:24:28.197

由于优化改变了代码行的执行顺序，调试发布版本可能会很痛苦。它真的会让人感到困惑！

至少缩小问题范围的一种技术是使用 MessageBox() 显示快速语句，说明您的代码必须到达程序的哪个部分（“Starting Foo()”、“Starting Foo2()”）；开始将它们放在您怀疑的代码区域中的函数顶部（当它崩溃时您在做什么？）。当您可以分辨出哪个函数时，将消息框更改为代码块，甚至该函数中的单个行，直到将其缩小到几行。然后您可以开始打印变量的值，以查看它们在崩溃时处于什么状态。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-09T10:14:35.137

尝试使用**_CrtCheckMemory()**查看分配的内存处于什么状态。如果一切顺利，**_CrtCheckMemory**返回**TRUE**，否则返回**FALSE**。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-09T11:48:15.120

您可以在启用全局标志的情况下运行您的软件（查看 Windows 调试工具）。它通常有助于解决问题。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-12-10T14:33:22.653

让您的程序在发生异常时生成一个小型转储，然后在调试器中打开它（例如，在 WinDbg 中）。要看的关键函数：MiniDumpWriteDump、SetUnhandledExceptionFilter

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-10-04T23:41:03.527

这是我遇到的一个案例，有人可能会觉得很有启发性。它只在 Qt Creator 的发布中崩溃 - 而不是在调试中。我使用的是 .ini 文件（因为我更喜欢可以复制到其他驱动器的应用程序，而不是注册表损坏时会丢失设置的应用程序）。这适用于将其设置存储在应用程序目录树下的任何应用程序。如果调试和发布版本位于不同的目录下，您也可以在它们之间进行不同的设置。我有偏好签入一个没有签入另一个。原来这是我崩溃的根源。还好我找到了。

我不想这么说，但我只在 MS Visual Studio 社区版中诊断出崩溃；安装 VS 后，让我的应用程序在 Qt Creator 中崩溃，并选择在*Visual Studio 的*调试器中打开它。虽然我的 Qt 应用程序没有符号信息，但事实证明 Qt 库有一些。它把我带到了令人讨厌的地方；因为我可以看到正在调用什么方法。（不过，我认为 Qt 是一个方便、强大且跨平台的 LGPL 框架。）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-10-30T18:06:53.990

我也有这个问题。就我而言，RELEASE 模式在链接器定义中有 msvscrtd.dll。我们删除了它并解决了问题。

或者，将 /NODEFAULTLIB 添加到链接器命令行参数也解决了该问题。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-05-05T05:22:32.977

我将为未来的读者添加另一种可能性：检查您是否从没有控制台窗口的应用程序登录到 stderr 或 stdout（即您与 /SUBSYSTEM:WINDOWS 链接）。这可能会崩溃。

我有一个 GUI 应用程序，我在其中登录到 stderr 和调试和发布的文件，因此始终启用日志记录。我在调试中创建了一个控制台窗口以便于查看日志，但不是在发布中。但是，如果 VS 调试器附加到发布版本，它会自动将 stderr 传送到 VS 输出窗口。因此，只有在没有调试器的版本中，当我写信给 stderr 时它才真正崩溃。

更糟糕的是，printf 调试显然不起作用，直到我找到根本原因（通过在各个位置插入无限循环来痛苦地将代码库一分为二），我才明白为什么。

* * *

## 回答 #28

> 赞同：-3
> 
> 时间：2014-10-09T11:12:43.397

我有这个错误，即使在尝试 !clean 时 vs 也崩溃了！我的项目。所以我从 Release 目录中手动删除了 obj 文件，之后它就构建好了。

* * *

## 回答 #29

> 赞同：-6
> 
> 时间：2008-10-09T07:52:03.520

我同意罗尔夫的观点。因为可重复性非常重要，所以您不应该使用非调试模式。您的所有构建都应该是可调试的。拥有两个调试目标会使您的调试负载增加一倍以上。只需发布“调试模式”版本，除非它无法使用。在这种情况下，使其可用。

# javascript - Javascript 是一种基于原型的语言是什么意思？

> ID：186244
> 
> 赞同：266
> 
> 时间：2008-10-09T07:22:57.540
> 
> 标签：javascript, oop, inheritance, prototype-programming

据说 Javascript 的主要优点之一是它是一种基于原型的语言。

但是 Javascript 基于原型意味着什么，为什么这是一个优势？

* * *

## 回答 #1

> 赞同：308
> 
> 时间：2008-10-09T07:38:11.193

**原型继承**是面向对象**代码重用**的一种形式。Javascript 是唯一使用原型继承的 [主流] 面向对象语言之一。几乎所有其他面向对象的语言都是经典的。

在**经典继承**中，程序员编写一个定义对象的类。多个对象可以从同一个类中实例化，因此您可以在一个地方拥有描述程序中多个对象的代码。然后可以将类组织成层次结构，从而促进代码重用。更通用的代码存储在较高级别的类中，较低级别的类从该类继承。这意味着一个对象与同一类的其他对象以及它的父类共享代码。

在**原型继承**形式中，对象**直接**从其他对象继承。所有关于课程的事情都消失了。如果你想要一个对象，你只需写一个对象。但是代码重用仍然是一件有价值的事情，因此允许对象在层次结构中链接在一起。在 javascript 中，每个对象都有一个指向创建它的对象的秘密链接，形成一个链。当一个对象被询问一个它没有的属性时，它的父对象将被询问......不断地向上链直到找到该属性或直到到达根对象。

JavaScript 中的每个函数（它们本身就是对象）实际上都有一个名为“原型”的成员，它负责在对象被请求时提供值。拥有这个成员允许构造器机制（通过它从函数构造对象）工作。将属性添加到函数对象的原型将使其可用于构造的对象，以及从它继承的所有对象。

**好处**

关于为什么原型继承是代码重用的一种有利形式，可能没有硬性规定。代码重用本身是有利的，原型继承是一种明智的做法。您可能会争辩说，原型继承是一种相当**简单**的代码重用模型，并且可以以**直接的方式**大量重用代码。但古典语言当然也能做到这一点。

**旁注：** *@Andrew Hedges*提出了一个很好的观点，实际上有[很多](http://en.wikipedia.org/wiki/Prototype-based_programming#Languages)原型语言。值得注意的是，这些其他的存在，但也值得注意的是，它们都不是接近主流的东西。NewtonScript 似乎有一段时间的吸引力，但随着它的平台而死。还可以通过添加原型功能的方式扩展一些现代语言。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2008-10-09T07:26:18.377

基于原型的语言不区分类与对象：它只是具有对象。基于原型的语言具有原型对象的概念，该对象用作模板，从中获取新对象的初始属性。任何对象都可以在您创建它时或在运行时指定它自己的属性。此外，**任何对象都可以作为另一个对象的原型关联**，从而允许第二个对象共享第一个对象的属性。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-10-09T07:27:12.760

基于原型的编程是一种面向对象的编程风格，其中不存在类，行为重用（或基于类的语言中的继承）是通过克隆用作原型的现有对象来执行的。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-09T07:45:21.520

优点/缺点是，我们可以在运行时创建新类型的对象，而无需定义类（静态代码）。像大多数功能一样，开发人员可以将其转化为优势/劣势。

以上是可能的，因为对象本质上是 java 脚本中的函数（也是闭包）。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-06-10T12:19:03.137

看完所有答案，这就是结论

1) 对象直接从其他对象继承的继承

2）不使用类

3) 也称为基于实例的编程或面向无类原型的编程

4）通过克隆作为原型的现有对象来执行行为重用

5) 从新对象中用作模板的对象获取初始属性

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-09T07:25:55.163

无需声明类结构，您可以创建相同类型的对象，并在您喜欢使用对象的原型的任何时候添加到它们的定义中。它比正常的做事方式更灵活。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-09T08:14:09.403

如果您只是在运行时使用对象而不是在编译时使用类来构建新对象，这将打开扩展对象而不知道任何细节的可能性。当然，根据使用情况，它可能很快就会成为劣势。我对这里的语言不做任何假设，因此它适用于除 javascript 之外的非动态语言。

```
myobject.prototype=unkownobject;
myobject.newproperty=1; 
```

您几乎可以从任何地方获取该对象；你自己的代码，来自网络，来自数据库，来自外部链接等等。

请注意，语言不必像 javascript 那样实现原型继承。在 javascript 中，原型对象只是在继承者之间共享，它的属性也是如此。另一种方法是将原型的所有属性复制到新对象。每种方法在不同情况下都有其优势。我更喜欢第二个，但这不是 javascript 所做的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-14T11:32:53.437

节省内存是 JS 中原型继承的好处之一。在像 Java 这样的语言中，对象生成它们自己的超类实例变量和方法的副本，而在 JS 中，“超级”对象提供对其变量和方法的获取访问权限，以访问从它继承的每个“子”对象无需重新创建它们。

# testing - 您如何组织发布测试？

> ID：186277
> 
> 赞同：2
> 
> 时间：2008-10-09T07:37:38.337
> 
> 标签：testing

在我工作的公司，我们每年都会发布两次主要版本。广泛的测试（自动和手动）在几周前完成。自动化测试生成日志文件，手动测试的结果记录在测试计划（Word 文档）中。正如您可以想象的那样，这会导致测试工程师管理和解释许多不同的文件。
您如何进行`organize`发布测试？
例如，是否使用错误跟踪器？你使用任何其他工具吗？您如何指定要测试的内容？谁做测试？开发人员/测试人员的比例如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T07:46:58.413

您可以结合使用错误跟踪器（JIRA、Mantis、Bugzilla）和测试用例管理工具，如[testlink](http://testlink.org/wordpress/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T09:31:14.630

如果不很好地跟踪您的测试及其结果，几乎不可能正确地组织测试。我们使用[PMC 套件](http://www.epam-pmc.com/)( `1`)，它有一个非常有用的测试组织结构：

*   测试场景（测试电池）
    *   测试用例（链接到需求）
        *   测试运行各自的结果

这些与错误相关联，而错误又与任务等相关联。

当运行手动测试时，测试人员会执行一个场景并遍历测试用例，并跟踪结果。所有发现的问题都记录为错误。

> *1\. 由我公司开发，但请不要认为这是广告:)*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T07:53:57.743

如果您使用 MS 产品和技术进行开发，您可以随时查看[Team Foundation Server](http://msdn.microsoft.com/en-us/tfs2008/default.aspx)。我发现它非常适合管理自动化单元测试/构建、管理错误、管理测试结果、分配测试任务等。这就是我们使用的。它并不便宜，但如果在预算范围内，值得投资。

# c# - .NET 部分类对多个文件的可访问性

> ID：186291
> 
> 赞同：2
> 
> 时间：2008-10-09T07:44:31.943
> 
> 标签：c#, .net, partial-classes

如果我在一个文件中将一个类的核心定义为“公共部分”，并且我希望在另一个文件中对此进行添加，那么在我的第二个文件中再次定义“公共部分”或仅定义“部分”之间有什么区别?

如果我在第二个文件中定义“私有部分”会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T07:48:18.490

您可以复制类修饰符或将它们留在一个文件中，但如果在不同文件中将它们指定为不同的访问级别，则会出现编译器错误。

来自[C# 编程指南](http://msdn.microsoft.com/en-us/library/wa80x488(VS.80).aspx)：

> 部分类型定义中的以下关键字是可选的，但如果存在于一个部分类型定义中，则不能与同一类型的另一个部分定义中指定的关键字冲突：
> 
> *   上市
> *   私人的
> *   受保护
> *   内部的
> *   抽象的
> *   密封
> *   基类
> *   新修饰符（嵌套部分）
> *   通用约束

# xml - 将 XML 数据转换为强 Flex 类型

> ID：186307
> 
> 赞同：4
> 
> 时间：2008-10-09T07:51:30.633
> 
> 标签：xml, apache-flex, data-structures

我正在进行的一个项目将从网络服务器中提取 XML 并从中构建数据存储。数据将具有某些核心字段，但需要可扩展......例如，我有一个，以后可能想要添加额外的字段。

在 Flex 应用程序中，我不希望中央数据存储处理 XML 对象或只是将属性放入对象中。我想要有强类型，例如 Person 类，它是从 XML 创建/填充的。

如何以灵活的方式做到这一点？如果属性名称匹配，Flex 是否能够从 XML 自动构建 Person，或者我是否需要为 、 等编写转换功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T12:13:52.913

我不认为这可以自动完成。我通常创建一个类来镜像我拥有的​​ XML 结构，然后创建一个静态类方法来创建给定 XML 节点的对象的实例。例如：

```
package {

  public class Foo{

     public function Foo(barparam1:String, barparam2:uint, barparam3:String, barparam4:Number){
       this._bar1 = barparam1;
       this._bar2 = barparam2;
       this._bar3 = barparam3;
       this._bar4 = barparam4;
       }

     protected var _bar1:String;
     protected var _bar2:uint;
     protected var _bar3:String;
     protected var _bar4:Number;

     public function get bar1():String{ return this._bar1; }
     public function get bar2():uint    { return this._bar2; }
     public function get bar3():String  { return this._bar3; }
     public function get bar4():Number  { return this._bar4; }

     public function toString():String{
        return "[Foo bar1:\"" + this.bar1 + "\", bar3:\"" + this.bar3 + "\", bar2:" + this.bar2 + ", bar4:" + this.bar4 + "]";
        }

     public static function createFromXml(xmlParam:XML):Foo{

        /* XML Format:
          <foo bar1="bar1value" bar2="5">
            <bar3>bar3 data</bar3>
            <bar4>10</bar4>
          </foo>
        */

       return new Foo(xmlParam.@bar1, xmlParam.@bar2, xmlParam.bar3[0], xmlParam.bar4[0]);
       }
    }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T19:49:36.337

如果您不依赖于 XML（例如，您有一个应用服务器而不是文件服务器），您可以考虑使用 AMF（[动作消息格式](http://en.wikipedia.org/wiki/Action_Message_Format)）来传输数据。有一些项目将 AMF 暴露给服务器，包括 Adob​​e 自己的[Blaze DS](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)和社区开源变体，如[OpenAMF](http://sourceforge.net/projects/openamf/)、[AMFPHP](http://www.amfphp.org/)、[PyAMF](http://pyamf.org/)等。这将使您能够将自定义对象从服务器传输到 Flex，自动解析数据类型和类型安全。看看[这个数据传输选项的比较，](http://www.jamesward.com/census/)以了解相对优点。

话虽如此，XML 对于应用程序配置数据之类的东西非常有用，并且在这些情况下，您没有运行应用程序服务器。我同意另一张海报，我将立即手动将 xml 解析为适当的结构。我通常将这些与修复后的 VO（用于值对象）一起存储，并将成员保留为公开。我经常分层地做这件事。

```
package model.vo
{
public class ConfigVO
{
    public var foo:String;
    public var bar:int;
    public var baz:Boolean;
    public var sections:Array;

    public function ConfigVO(xml:XML)
    {
        parseXML(xml);
    }

    private function parseXML(xml:XML):void
    {
        foo = xml.foo;
        bar = xml.bar;
        baz = (xml.baz == "true");

        sections = [];
        for each(var sectionXML:XML in xml.section)
        {
            sections.push(new SectionVO(sectionXML));
        }
    }
}
}

package model.vo
{
public class SectionVO
{
    public var title:String;

    public function SectionVO(xml:XML)
    {
        parseXML(xml);
    }

    private function parseXML(xml:XML):void
    {
        title = xml.@title;
    }
}
} 
```

过去我见过将 XML 元素名称绑定到类定义的系统。这些通常对类使用某种自省来确定要从 xml 中读取哪些属性，或者它们将具有一些静态类属性，这些属性将实例属性映射到 xml 标记或属性。根据我的经验，它们带来的麻烦比它们的价值要大得多。添加一个新的公共属性和从属性或子标签读取数据的一行需要全部 2 秒。我的建议是避免使用这种复杂的方案，但为了完整起见，我将举一个简单的例子。

```
package model
{
    public class XMLReader
    {
        // maps <tagname> to a class 
        private static var elementClassMap:Object =
        {
            "section": SectionVO,
            "person": PersonVO
        };

        public var parsedElements:Array;

        public function XMLReader(xml:XML)
        {
            parsedElements = [];
            parseXML(xml);
        }

        private function parseXML(xml:XML):void
        {
            var voClass:Class;
            for each(var element:XML in xml.children())
            {
                voClass = elementClassMap[element.name().localname];
                if(voClass)
                {
                    parsedElements.push(new voClass(element));
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-24T11:11:18.807

[使用 flex simplexmldecoder 类](http://blog.flexexamples.com/2007/09/19/converting-xml-to-objects-using-the-flex-simplexmldecoder-class/)@flexExamples将 xml 转换为对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T12:13:59.537

不久前，我开始研究一个 Flex 库，该库将帮助序列化和反序列化动作脚本对象与 XML 之间的关系。您所要做的就是创建模型对象，在字段上添加一些注释，让序列化程序知道您希望如何序列化字段（元素、属性、名称等）并调用（反）序列化过程。

我认为它适合您的需求。

如果您愿意，可以在[http://code.google.com/p/flexxb/](http://code.google.com/p/flexxb/)上查看。

希望这将被证明是有帮助的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-13T13:11:16.017

创建强数据类型有几个优点，代码完成和编译时语法检查是最重要的。可以完成手动映射，但应该生成（因此毕竟不再是真正的手动映射）以避免迟早不同步。

基于自省的通用转换库是通用的、易于使用的，并且应该足以满足大多数用例。

JAXB 是 Java 的标准。[ASXB](http://lab.arc90.com/2009/02/actionscript_xml_binding.php)为 Actionscript 世界提供了这个想法的轻量级实现。它使用带有注释的显式 AS 对象来（取消）编组对象和 XML。

如果您被迫在线上使用 XML，我建议您仔细看看 ASXB。如果您可以自由选择格式并拥有支持的服务器端，那么 Adob​​e 自己的 AMF 格式应该是您的选择，因为它在语言中直接受支持，并且在传输过程中的开销要低得多。

在我们当前的项目中，我们编写了小型代码生成器，它采用 Java 端的外部 API（源自省，也复制 Javadoc）并在我们的构建过程中从中生成 AS 类。因此，当外部需求迫使我们这样做时，从 AMF 切换到 XML 很容易。

PS：记得将编译器参数添加到您的 flex 配置文件中以保留注释

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-02T22:39:15.233

[AsBeanGen](http://splink.org/?p=14)可以做到这一点。它为 DTD 驱动的 XML 文件生成值对象。

# java - 在日期列表中找到最接近目标的日期的最佳方法？

> ID：186311
> 
> 赞同：6
> 
> 时间：2008-10-09T07:53:05.250
> 
> 标签：java, date

我有一个日期对象列表和一个目标日期。我想在列表中找到最接近目标日期的日期，但只查找在目标日期之前的日期。

示例：2008-10-1 2008-10-2 2008-10-4

目标日期为 2008-10-3，我想获得 2008-10-2

最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T08:34:15.213

```
private Date getDateNearest(List<Date> dates, Date targetDate){
    return new TreeSet<Date>(dates).lower(targetDate);
} 
```

不需要预先排序的列表，TreeSort 解决了这个问题。如果找不到，它将返回 null，因此如果出现问题，您将不得不对其进行修改。也不确定效率：P

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T09:07:51.510

Sietse de Kaper 解决方案假设一个*反向*排序的列表，绝对不是最自然的事情

Java中的自然排序顺序遵循升序自然排序。（参见 Collection.sort [http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collections.html#sort(java.util.List)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collections.html#sort(java.util.List))文档）

从你的例子中，

```
目标日期 = 2008-10-03
列表 = 2008-10-01 2008-10-02 2008-10-04

```

如果另一个开发人员以天真的方法使用您的方法，他会得到 2008-10-01 这不是预期的

*   不要对列表的顺序做出假设。*   如果出于性能原因必须尝试遵循最自然的约定（升序排序）*   如果你真的必须遵循另一个约定，你真的应该记录下它。

    ```
    private Date getDateNearest(List<Date> dates, Date targetDate){
      Date returnDate = targetDate
      for (Date date : dates) {
        // if the current iteration'sdate is "before" the target date
        if (date.compareTo(targetDate) <= 0) {
          // if the current iteration's date is "after" the current return date
          if (date.compareTo(returnDate) > 0){
            returnDate=date;
          }
        }
      }  
      return returnDate;
    } 
    ```

    编辑 - 我也喜欢 Treeset 答案，但我认为它可能会稍微慢一些，因为它相当于对数据进行排序然后查找它 => nlog(n) 进行排序，然后文档暗示它是 log(n) 用于访问所以那将是 nlog(n)+log(n) 与 n

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T07:54:51.487

我目前使用以下方法，但我不确定它是否是最有效的方法，因为这假设一个已经排序的列表，并且（可能）迭代列表中的每个日期。

```
private Date getDateNearest(List<Date> dates, Date targetDate){
  for (Date date : dates) {
    if (date.compareTo(targetDate) <= 0) return date;
  }

  return targetDate;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T09:08:05.770

尽管 Keeg 的答案在 1.5 中的 1.6 中是有效的，但没有方法 lower() （我们很遗憾针对 1.5 进行开发 :-( ）

这个适用于 1.5

```
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.TreeSet;

public class GetNearestDate {

  public static void main( String[] args ) throws ParseException {

    final SimpleDateFormat simpleDateFormat = new SimpleDateFormat( "dd.MM.yyyy HH:mm:ss" );

    List< Date > otherDates = Arrays.asList( new Date[]{
      simpleDateFormat.parse( "01.01.2008 01:00:00" ) ,
      simpleDateFormat.parse( "01.01.2008 01:00:02" ) } );
    System.out.println( simpleDateFormat.parse( "01.01.2008 01:00:00" ).equals(
      get( otherDates , simpleDateFormat.parse( "01.01.2008 01:00:01" ) ) ) );
    System.out.println( simpleDateFormat.parse( "01.01.2008 01:00:02" ).equals(
      get( otherDates , simpleDateFormat.parse( "01.01.2008 01:00:03" ) ) ) );
    System.out.println( null == get( otherDates , simpleDateFormat.parse( "01.01.2008 01:00:00" ) ) );
  }

  public static Date get( List< Date > otherDates , Date dateToApproach ) {
    final TreeSet< Date > set = new TreeSet< Date >( otherDates );
    set.add( dateToApproach );
    final ArrayList< Date > list = new ArrayList< Date >( set );
    final int indexOf = list.indexOf( dateToApproach );
    if ( indexOf == 0 )
      return null;
    return list.get( indexOf - 1 );
  }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-25T21:36:33.463

# `NavigableSet::lower`

基格的[回答](https://stackoverflow.com/a/186420/642706)巧妙地简短。这个想法是利用接口中[`lower`](http://docs.oracle.com/javase/8/docs/api/java/util/NavigableSet.html#lower-E-)定义并在类中实现的方法。[`NavigableSet`](http://docs.oracle.com/javase/8/docs/api/java/util/NavigableSet.html)[`TreeSet`](http://docs.oracle.com/javase/8/docs/api/java/util/TreeSet.html)

但与其他答案一样，它使用与最早版本的 Java 捆绑在一起的旧的过时日期时间类。下面是使用[java.time](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)类的更新版本。

旧的问题和答案使用的是`java.util.Date`UTC时间线上的时刻，表示日期*和*时间，或者`java.sql.Date`笨拙地扩展 util.Date 而假装它没有时间。混乱的混乱。

# java.time

那些麻烦的旧类已被Java 8 及更高版本中内置的[java.time类所取代。](http://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html)请参阅[Oracle 教程](http://docs.oracle.com/javase/tutorial/datetime/TOC.html)。大部分功能已在 ThreeTen-Backport 中向后移植到 Java 6 和 7，并在[ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP)[中](http://www.threeten.org/threetenbp/)进一步适应 Android 。

# `LocalDate`

该类[`LocalDate`](http://docs.oracle.com/javase/8/docs/api/java/time/LocalDate.html)表示没有时间和时区的仅日期值。虽然这些对象不存储时区，但请注意时区 ( [`ZoneId`](http://docs.oracle.com/javase/8/docs/api/java/time/ZoneId.html)) 对于确定当前日期至关重要。对于任何给定的时刻，日期都会因时区而在全球范围内变化。

```
ZoneId zoneId = ZoneId.of( "America/Montreal" );
LocalDate today = LocalDate.now( zoneId );  // 2016-06-25 
```

# ISO 8601

提示：用前导零填充这些月份和日期。这使它们符合[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)标准日期时间格式。在解析/生成表示日期时间值的字符串时，这些格式在 java.time 中默认使用。

所以使用`2008-10-01`而不是`2008-10-1`. 如果填充不可行，请使用[`DateTimeFormatter`](http://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html).

```
NavigableSet dates = new TreeSet( 3 );
dates.add( LocalDate.parse( "2008-10-01" );
dates.add( LocalDate.parse( "2008-10-02" );
dates.add( LocalDate.parse( "2008-10-04" );
LocalDate target = LocalDate.parse( "2008-10-03" );
LocalDate hit = dates.lower( target );
// Reminder: test for `null == hit` to see if anything found. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T03:32:17.787

你看过 JodaTime API 吗？我似乎记得有这样的功能可用。

# javascript - 如何在 Scriptaculous 中创建可嵌套的可拖动对象？

> ID：186313
> 
> 赞同：2
> 
> 时间：2008-10-09T07:53:25.280
> 
> 标签：javascript, drag-and-drop, scriptaculous, draggable

我正在使用 Scriptaculous 库在帮助最终用户构建列表的应用程序上打造吸引人的 UI。让我们说它用于披萨制作。

要填写订单，您可以将披萨调色板中的披萨尺寸拖到可放置的订单中。一旦它被放在那里，它就会被一个新的 div 替换，该 div 既可拖动（因为您可以通过将其移回调色板来将其丢弃）和可放置（因为您可以向其中添加成分）。

然后，您可以将配料调色板中的配料添加到订单组中的任何比萨饼。

我已经成功实现了这些位并且一切正常。坚持者：如果我尝试从放置的比萨中拖放配料，该比萨被正确标记为可拖动，并且，从良好的角度来看，它位于比萨上方的 z 轴上，它反而会抓取比萨批发。这使我无法撤消成分选择，这是此屏幕的一个关键功能。

关于如何让它做我想做的任何建议？理想情况下，我希望保留简单的拖拽式 UI，因为它比我们以前使用的更直观*。*（一个多阶段的 HTML 表单……不寒而栗……）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T04:08:25.203

事实证明，在将我的头撞到各种墙壁几天之后，Scriptaculous 会很乐意默认嵌套东西。

问题是当你的电话`draggable_element`看起来像这样

```
<% draggable_element blah blah blah blah blah blah blah%> 
```

代替

```
<%= draggable_element blah blah blah blah blah blah blah %> 
```

哦！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T12:46:49.307

试试这个，我认为它接近你想要做的。我正在对左侧的列表使用可排序的。你可能不需要。

```
<table border="1" cellpadding="5">
<tr>
    <td valign="top">
        <ul id='fList' style='border:1px solid #c0c0c0'>
            <li class='fruit'>Apples</li>
            <li class='fruit'>Grapes</li>
            <li class='fruit'>Strawberries</li>
        </ul>
        (drag items or panel)
    </td>
    <td valign="top">
        <div id='fish' class='meat'>Fish</div>
        <div id='chicken' class='meat'>Chicken</div>
        (drop to left list)
    </td>
</tr></table>

Sortable.create("fList", {constraint:false})
new Draggable('fish',{revert:true})
new Draggable('chicken',{revert:true})
new Draggable('fList')
Droppables.add('fList',{accept:'meat',onDrop:function(dragName,dropName){placeFood(dragName,dropName)}})
Droppables.add('fList',{accept:'fruit'})

function placeFood(dragName,dropName) {
    $("fList").insert(new Element("li", { id: $(dragName).id+"_" }))
    $($(dragName).id+"_").innerHTML = $(dragName).innerHTML
    Sortable.destroy("fList")
    Sortable.create("fList", {constraint:false})
} 
```

# javascript - JavaScript 中的请求来自哪里？

> ID：186314
> 
> 赞同：1
> 
> 时间：2008-10-09T07:53:48.850
> 
> 标签：javascript, jquery, debugging

我正在调试一个包含大量 JavaScript、JQuery、Ajax 等的大型复杂网页。在该代码的某处，我收到了一个调用服务器根目录的 rouge 请求（我认为它是一个空的 img）。我知道它不在 html 或 css 中，并且非常确信在 JavaScript 代码中的某个地方正在发出请求，但我无法追踪它。我习惯于使用 firebug、VS 和其他调试工具，但我正在寻找某种方法来找出执行此操作的位置 - 这样我就可以在大约 150 个 .js 文件中找到有问题的行。

除了输入“你现在在这里”的大量控制台输出之外，是否有人对调试工具提出建议，该工具可以突出显示对外部资源发出 Javascript 请求的位置？还有其他想法吗？

一步一步调试需要很长时间 - 我必须小心我进入的内容（jQuery 源 - yuk！），我可能会错过关键时刻

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T07:58:19.467

在 Firebug 中使用分步脚本调试器怎么样？

我还认为这可能是对 Firebug 的一个非常有趣的增强，能够在 AJAX 调用上添加断点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-12T16:21:04.587

[您可以使用Firebug](http://getfirebug.com)控制台查看所有通过 JavaScript 完成的 HTTP 请求。

如果要手动跟踪所有 HTTP 请求，可以使用以下代码：

```
$(document).bind('beforeSend', function(event, request, ajaxOptions)
{
   // Will be called before every jQuery AJAX call
}); 
```

有关详细信息，请参阅[有关 AJAX 事件的 jQuery 文档](http://docs.jquery.com/Ajax_Events)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T09:05:13.263

你谈到了 jQuery 源代码......

假设请求通过 jQuery，在 jQuery 源 get() 函数中放置一个调试语句，如果 URL 是 '/' 则启动。也许你可以从调用堆栈中看出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T08:00:14.750

如果它是发送到 Web 服务器的 HTTPRequest，我建议在 Firefox 上使用 TamperData 插件。只需安装插件，启动篡改数据，发送的每个请求都会先提示篡改/继续/中止。

在 Mozilla 网站上访问[此页面](https://addons.mozilla.org/en-US/firefox/addon/966)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T15:05:16.063

在这里只是一个猜测，但你使用的是ThickBox吗？它尝试在代码的开头加载图像。

我要做的第一件事是通过 Firebug 中的 Net 面板检查此 rouge 请求是 Ajax 请求还是图像加载请求。

如果它是 Ajax，那么您可以使用自己的重载 $.ajax 函数并执行 strack 跟踪并在移交给原始 $.ajax 之前包含请求的 URL。

如果是图像，则不理想，但是如果您可以使用服务器端睡眠（即仅睡眠 20 秒的 php 文件）来响应图像请求，您也许可以挂起应用程序并开始猜测在哪里问题可能是。

# python - Python - 如何使用 Conch 创建虚拟 SSH 服务器

> ID：186316
> 
> 赞同：5
> 
> 时间：2008-10-09T07:54:12.033
> 
> 标签：python, twisted

我正在考虑在 python 中创建一个可以运行的服务器，并将用作 SSH 服务器。然后，这将让不同的用户登录，并像他们正常登录一样行事，但只能访问一个命令。

我想这样做，以便我可以拥有一个可以添加用户的系统，而无需创建系统范围的帐户，这样他们就可以提交到 VCS 分支或类似的分支。

虽然我可以弄清楚如何使用 conch 将其放入“自定义”外壳中......但我无法弄清楚如何制作它，以便 SSH 流就像它是真实的一样工作（我最好希望限制为 /bin/bzr 以便 bzr+ssh 可以工作。

它需要在 python 中（我可以进行授权），但不知道如何链接到应用程序。

这需要在 python 中才能在其设计的应用程序中工作，并且能够用于那些无权添加新用户的人

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T22:30:29.813

当你编写一个 Conch 服务器时，你可以通过实现[`ISession.openShell`](http://twistedmatrix.com/trac/browser/trunk/twisted/conch/interfaces.py?rev=24441#L62). Conch 服务器[`IConchUser`](http://twistedmatrix.com/trac/browser/trunk/twisted/conch/interfaces.py?rev=24441#L6)将从您的领域请求，然后调整生成的头像以在必要时`ISession`调用它。`openShell`

`ISession.openShell`的工作是获取传递给它的传输对象并将其与协议相关联，以解释从它接收到的字节，如果需要，将字节写入它以发送给客户端。

不幸的是，传递给`openShell`它的代表传输的对象实际上是一个[`IProcessProtocol`](http://twistedmatrix.com/trac/browser/trunk/twisted/internet/interfaces.py?rev=24441#L1028)提供者。这意味着您需要调用[`makeConnection`](http://twistedmatrix.com/trac/browser/trunk/twisted/internet/interfaces.py?rev=24441#L1033)它，传递一个[`IProcessTransport`](http://twistedmatrix.com/trac/browser/trunk/twisted/internet/interfaces.py?rev=24441#L1261)提供程序。当从客户端收到数据时，`IProcessProtocol`将调用[`writeToChild`](http://twistedmatrix.com/trac/browser/trunk/twisted/internet/interfaces.py?rev=24441#L1282)您传递给的传输`makeConnection`。当你想向客户端发送数据时，你应该调用[`childDataReceived`](http://twistedmatrix.com/trac/browser/trunk/twisted/internet/interfaces.py?rev=24441#L1043)它。

要查看确切的行为，我建议阅读[传入](http://twistedmatrix.com/trac/browser/trunk/twisted/conch/ssh/session.py?rev=24441#L173)[的`IProcessProtocol`](http://twistedmatrix.com/trac/browser/trunk/twisted/conch/ssh/session.py?rev=24441#L173). 不要依赖任何不属于 的东西`IProcessProtocol`，但是查看实现可以更容易理解正在发生的事情。

您可能还想查看[正常创建 shell 的实现，](http://twistedmatrix.com/trac/browser/trunk/twisted/conch/unix.py?rev=24441#L174)以了解您的目标。这将为您提供有关如何将您启动的 bzr 子进程的 stdio 与 SSH 通道相关联的线索。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-10-09T09:00:11.760

虽然 Python 确实是我最喜欢的语言，但我认为您无需为此创建自己的服务器。当您查看[sshd 的 OpenSSH 手册页](http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&sektion=8)时，您会发现授权密钥文件的“命令”选项，它允许您定义在登录时运行的特定命令。

使用密钥，您可以使用一个系统帐户允许多个用户登录，只需将他们的公钥放入帐户的授权密钥文件中即可。

我们正在使用它为 SVN 创建 SSH 隧道，效果很好。

# .net - .NET 迭代数据表中行的最快方法？

> ID：186328
> 
> 赞同：0
> 
> 时间：2008-10-09T07:58:55.753
> 
> 标签：.net, performance, ado.net, datatable, iteration

从 DataTable 读取/比较行信息时，哪个通常最快？

```
'assume dt as datatable'

'method 1'
dim i as int32
for i = 0 to dt.rows.count - 1
   ....
next

'method 2'
dim row as datarow
for each row in dt.rows
    ....
next 
```

如果有区别，在什么情况下使用其中一种是值得的？

提前感谢您的任何指导！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T08:11:07.553

编译器将 For Each 扩展为一个短暂的 while 循环。

```
for each row in dt.rows
// expands to:
IEnumerator e = dt.rows.GetEnumerator()
while e.MoveNext()
    row = e.Current 
```

因此，您需要支付少量的间接费用。但是为了清楚起见，如果您只处理一行并且没有修改数据集，我仍然会坚持使用 For Each。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T08:04:27.660

实际上没有区别。尽管从技术上讲，通过 IEnumerable 接口，您在 foreach 方法中付出了很小的代价。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T08:07:32.553

第二个将受到轻微处罚。但是，就情况而言，为了代码的清晰，我总是会使用方法 2。但是，如果我需要在分析当前行时访问下一行/上一行等操作，我会使用方法 1。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T08:17:52.343

好吧，这是有区别的，因为在 foreach 循环中调用的 GetEnumerator 和 MoveNext 是虚拟的（调用需要通过指针），因此不能内联。这个开销实际上很小，除非你做**很多**循环。

在某些情况下，尽管编译器会将 foreach 替换为 for 循环（我相信在迭代数组时）。

为了清晰起见，我个人更喜欢在我的 ASP.NET MVC 代码中使用 foreach，正如许多人在这里所说的那样，但也经常使用 for 循环。Joe Duffy 最近发表了一篇关于枚举成本的有趣文章 [http://joeduffyblog.com/2008/09/21/the-cost-of-enumerating-in-net/](http://joeduffyblog.com/2008/09/21/the-cost-of-enumerating-in-net/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T08:08:44.017

@gdean232 是对的 - 几乎没有区别。如果性能是一个问题，使用 SqlDataReader 会明显更快。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-09T08:17:49.177

foreach 的实现实际上比标准的实现要快一些，因为每个索引数组的访问都需要进行边界检查。但是，由于成语：

```
for(int i =0; i < myArray.Count; ++i)
{
    // do something with myArray[i];
} 
```

很常见，编译器会寻找它作为特例并对其进行优化，因此它变得更快。但是，任何与该格式的微小偏差（例如 int len = MyArray.Count; for(int i =0; i< len; ++i)）都不会被识别，并且会使用较慢的代码。

# php - 为什么 require_once 不好用？

> ID：186338
> 
> 赞同：145
> 
> 时间：2008-10-09T08:03:02.717
> 
> 标签：php, performance, require-once

我读到的关于更好的 PHP 编码实践的所有内容都一直在说不要`require_once`因为速度而使用。

为什么是这样？

做同样事情的正确/更好的方法是什么`require_once`？如果重要的话，我正在使用 PHP 5。

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2008-10-12T02:05:57.840

这个线程让我感到畏缩，因为已经有一个“解决方案发布”，而且无论出于何种意图和目的，它都是错误的。我们列举一下：

1.  PHP 中的定义**非常**昂贵。您可以自己[查找](http://bugs.php.net/bug.php?id=40165)或测试它，但在 PHP 中定义全局常量的唯一有效方法是通过扩展。（类常量实际上在性能方面相当不错，但这是一个有争议的问题，因为 2）

2.  如果您使用`require_once()`得当，即包含类，您甚至不需要定义；只需检查是否`class_exists('Classname')`。如果您包含的文件包含代码，即您以程序方式使用它，那么您绝对没有`require_once()`必要这样做；每次包含您认为正在进行子例程调用的文件时。

所以有一段时间，很多人确实使用这种`class_exists()`方法来制作他们的夹杂物。我不喜欢它，因为它很丑，但他们有充分的理由：`require_once()`在一些较新版本的 PHP 之前效率很低。但这已经解决了，我的观点是，你必须为条件编译的额外字节码和额外的方法调用，将远远超过任何内部哈希表检查。

现在，承认：这些东西很难测试，因为它占执行时间的时间太少了。

这是您应该考虑的问题：通常，包含在 PHP 中是昂贵的，因为每次解释器命中一个时，它都必须切换回解析模式，生成操作码，然后跳回。如果您有 100 多个包含，这肯定会对性能产生影响。为什么使用或不使用 require_once 是一个如此重要的问题，因为它使操作码缓存变得困难。可以在此处找到对此的[解释](http://t3.dotgnu.info/blog/php/demystifying-autofilter.html)，但这归结为：

*   如果在解析期间，您确切地知道在请求的整个生命周期中需要哪些包含文件，那么`require()`一开始的那些文件和操作码缓存将为您处理其他所有内容。

*   如果您没有运行操作码缓存，那么您将处于困境中。将所有包含内容内联到一个文件中（不要在开发期间这样做，仅在生产中这样做）当然可以帮助解析时间，但这样做很痛苦，而且，您需要确切知道在要求。

*   自动加载非常方便，但速度很慢，因为每次包含完成时都必须运行自动加载逻辑。在实践中，我发现为一个请求自动加载多个专用文件不会造成太大问题，但您不应该自动加载所有需要的文件。

*   如果您可能有 10 个包含（这是一个*非常*落后的计算），那么所有这些手淫都是不值得的：只需优化您的数据库查询或其他东西。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2008-10-09T08:20:31.480

`require_once`并且`include_once`两者都要求系统记录已经包含/需要的内容。每次`*_once`通话都意味着检查该日志。所以肯定*有一些*额外的工作在那里完成，但足以损害整个应用程序的速度？

*...我真的很*怀疑...除非您使用的是*非常*旧的硬件或经常这样做，否则不会。

 *如果你*正在*做成千上万的`*_once`工作，你可以以更轻松的方式自己完成工作。对于简单的应用程序，只需确保只包含一次*就*足够了，但如果您仍然遇到重新定义错误，您可以这样做：

```
if (!defined('MyIncludeName')) {
    require('MyIncludeName');
    define('MyIncludeName', 1);
} 
```

我个人会坚持这些`*_once`陈述，但在愚蠢的百万通过基准测试中，您可以看到两者之间的区别：

```
 php                  hhvm
if defined      0.18587779998779     0.046600103378296
require_once    1.2219581604004      3.2908599376678 
```

慢 10-100 倍，`require_once`奇怪的`require_once`是`hhvm`. 同样，这仅在您运行`*_once`数千次时才与您的代码相关。

* * *

```
<?php // test.php

$LIMIT = 1000000;

$start = microtime(true);

for ($i=0; $i<$LIMIT; $i++)
    if (!defined('include.php')) {
        require('include.php');
        define('include.php', 1);
    }

$mid = microtime(true);

for ($i=0; $i<$LIMIT; $i++)
    require_once('include.php');

$end = microtime(true);

printf("if defined\t%s\nrequire_once\t%s\n", $mid-$start, $end-$mid); 
```

* * *

```
<?php // include.php

// do nothing. 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2008-10-12T01:43:19.477

我很好奇并查看了 Adam Backstrom 与[Tech Your Universe](https://web.archive.org/web/20080808221243/http://www.techyouruniverse.com/software/php-performance-tip-require-versus-require_once)的链接。本文描述了应该使用 require 而不是 require_once 的原因之一。然而，他们的说法并没有支持我的分析。我很想看看我可能在哪里错误地分析了解决方案。我使用 PHP 5.2.0 进行比较。

我首先创建了 100 个头文件，这些头文件使用 require_once 来包含另一个头文件。这些文件中的每一个看起来都类似于：

```
<?php
    // /home/fbarnes/phpperf/hdr0.php
    require_once "../phpperf/common_hdr.php";

?> 
```

我使用快速 Bash hack 创建了这些：

```
for i in /home/fbarnes/phpperf/hdr{00..99}.php; do
    echo "<?php
    // $i" > $i
    cat helper.php >> $i;
done 
```

这样我可以在包含头文件时轻松地在使用 require_once 和 require 之间切换。然后我创建了一个 app.php 来加载一百个文件。这看起来像：

```
<?php
    // Load all of the php hdrs that were created previously
    for($i=0; $i < 100; $i++)
    {
        require_once "/home/fbarnes/phpperf/hdr$i.php";
    }

    // Read the /proc file system to get some simple stats
    $pid = getmypid();
    $fp = fopen("/proc/$pid/stat", "r");
    $line = fread($fp, 2048);
    $array = split(" ", $line);

    // Write out the statistics; on RedHat 4.5 with kernel 2.6.9
    // 14 is user jiffies; 15 is system jiffies
    $cntr = 0;
    foreach($array as $elem)
    {
        $cntr++;
        echo "stat[$cntr]: $elem\n";
    }
    fclose($fp);
?> 
```

我将 require_once 标头与使用头文件的要求标头进行了对比，如下所示：

```
<?php
    // /home/fbarnes/phpperf/h/hdr0.php
    if(!defined('CommonHdr'))
    {
        require "../phpperf/common_hdr.php";
        define('CommonHdr', 1);
    }
?> 
```

使用 require 与 require_once 运行此程序时，我没有发现太大区别。事实上，我最初的测试似乎暗示 require_once 稍微快一些，但我不一定相信这一点。我用 10000 个输入文件重复了这个实验。在这里，我确实看到了一致的差异。我多次运行测试，结果很接近，但使用 require_once 平均使用 30.8 个用户 jiffies 和 72.6 个系统 jiffies；使用 require 平均使用 39.4 个用户 jiffies 和 72.0 个系统 jiffies。因此，使用 require_once 的负载似乎略低。但是，挂钟时间略有增加。10,000 个 require_once 调用平均使用 10.15 秒完成，10,000 个 require_once 调用平均使用 9.84 秒。

下一步是研究这些差异。我使用[strace](https://en.wikipedia.org/wiki/Strace)来分析正在进行的系统调用。

在从 require_once 打开文件之前，会进行以下系统调用：

```
time(NULL)                              = 1223772434
lstat64("/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat64("/home/fbarnes", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat64("/home/fbarnes/phpperf", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat64("/home/fbarnes/phpperf/h", {st_mode=S_IFDIR|0755, st_size=270336, ...}) = 0
lstat64("/home/fbarnes/phpperf/h/hdr0.php", {st_mode=S_IFREG|0644, st_size=88, ...}) = 0
time(NULL)                              = 1223772434
open("/home/fbarnes/phpperf/h/hdr0.php", O_RDONLY) = 3 
```

这与 require 形成对比：

```
time(NULL)                              = 1223772905
lstat64("/home", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat64("/home/fbarnes", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat64("/home/fbarnes/phpperf", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
lstat64("/home/fbarnes/phpperf/h", {st_mode=S_IFDIR|0755, st_size=270336, ...}) = 0
lstat64("/home/fbarnes/phpperf/h/hdr0.php", {st_mode=S_IFREG|0644, st_size=146, ...}) = 0
time(NULL)                              = 1223772905
open("/home/fbarnes/phpperf/h/hdr0.php", O_RDONLY) = 3 
```

Tech Your Universe 暗示 require_once 应该进行更多的 lstat64 调用。但是，它们都进行了相同数量的 lstat64 调用。可能不同的是我没有运行 APC 来优化上面的代码。但是，接下来我比较了整个运行的 strace 输出：

```
[fbarnes@myhost phpperf]$ wc -l strace_1000r.out strace_1000ro.out
  190709 strace_1000r.out
  210707 strace_1000ro.out
  401416 total 
```

当使用 require_once 时，每个头文件实际上大约有两个系统调用。一个区别是 require_once 对 time() 函数有一个额外的调用：

```
[fbarnes@myhost phpperf]$ grep -c time strace_1000r.out strace_1000ro.out
strace_1000r.out:20009
strace_1000ro.out:30008 
```

另一个系统调用是 getcwd()：

```
[fbarnes@myhost phpperf]$ grep -c getcwd strace_1000r.out strace_1000ro.out
strace_1000r.out:5
strace_1000ro.out:10004 
```

这是因为我决定在 hdrXXX 文件中引用的相对路径。如果我将此作为绝对引用，那么唯一的区别是代码中进行了额外的 time(NULL) 调用：

```
[fbarnes@myhost phpperf]$ wc -l strace_1000r.out strace_1000ro.out
  190705 strace_1000r.out
  200705 strace_1000ro.out
  391410 total
[fbarnes@myhost phpperf]$ grep -c time strace_1000r.out strace_1000ro.out
strace_1000r.out:20008
strace_1000ro.out:30008 
```

这似乎意味着您可以通过使用绝对路径而不是相对路径来减少系统调用的数量。除此之外的唯一区别是 time(NULL) 调用似乎用于检测代码以比较更快的代码。

另一个注意事项是 APC 优化包有一个名为“apc.include_once_override”的选项，声称它减少了由 require_once 和 include_once 调用进行的系统调用次数（请参阅[PHP 文档](http://us3.php.net/manual/en/apc.configuration.php)）。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-10-09T08:27:36.257

你能给我们任何链接到这些编码实践，说要避免它吗？就我而言，**这完全不是问题**。`include`我自己没有查看源代码，但我想和之间的唯一区别`include_once`是`include_once`将文件名添加到数组并每次检查数组。保持该数组排序很容易，因此搜索它应该是 O(log n)，即使是中大型应用程序也只有几十个包含。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-09T08:05:28.483

更好的方法是使用面向对象的方法并使用[__autoload()](http://www.php.net/__autoload)。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-02-25T05:31:47.467

它没有使用不好的功能。在整个代码库中，这是对如何以及何时使用它的错误理解。我将为这个可能被误解的概念添加更多上下文：

人们不应该认为 require_once 是一个缓慢的函数。您必须以一种或另一种方式包含您的代码。`require_once()`vs.`require()`的速度不是问题。这是关于性能阻碍可能导致盲目使用它的警告。如果在不考虑上下文的​​情况下广泛使用，可能会导致大量内存浪费或代码浪费。

我所看到的非常糟糕的是，当巨大的单体框架`require_once()`以所有错误的方式使用时，尤其是在复杂的面向对象 (OO) 环境中。

`require_once()`以在许多库中看到的每个类的顶部使用 using 为例：

```
require_once("includes/usergroups.php");
require_once("includes/permissions.php");
require_once("includes/revisions.php");
class User{
  // User functions
} 
```

所以`User`该类被设计为使用所有其他三个类。很公平！

但是现在，如果访问者正在浏览站点并且甚至没有登录并且框架加载了：`require_once("includes/user.php");`对于每一个请求。

它包括在该特定请求期间永远不会使用的 1+3 个*不必要的类。*这就是臃肿的框架最终使用 40 MB 每个请求而不是 5 MB 或更少的原因。

* * *

它可能被滥用的其他方式是当一个类被许多其他人重用时！假设您有大约 50 个使用`helper`函数的类。为了确保`helpers`这些类在加载时可用，您将获得：

```
require_once("includes/helpers.php");
class MyClass{
  // Helper::functions(); // etc..
} 
```

这里本身没有错。但是，如果一个页面请求恰好包含 15 个类似的类。您正在运行`require_once`15 次，或者是为了获得漂亮的视觉效果：

```
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php");
require_once("includes/helpers.php"); 
```

除了必须解析那些不必要的行之外，使用 require_once() 在技术上会影响运行该函数 14 次的性能。只有 10 个其他高度使用的类具有类似的问题，它可以解释 100 多行这种相当无意义的重复代码。

有了它，它可能值得`require("includes/helpers.php");`在您的应用程序或框架的引导程序中使用。但由于一切都是相对的，*这完全取决于*类的权重与使用频率`helpers`是否值得节省 15-100 行`require_once()`. `helpers`但是，如果在任何给定请求上不使用文件的可能性为零，那么`require`肯定应该在您的主类中。分别在`require_once`每个班级中成为资源浪费。

* * *

该`require_once`函数在必要时很有用，但不应将其视为在任何地方都可用于加载所有类的单一解决方案。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-09T12:35:01.640

`*_once()`函数[统计](https://en.wikipedia.org/wiki/Stat_(system_call))每个父目录以确保您包含的文件与已包含的文件不同。这是放缓的部分原因。

我建议使用[Siege 之](http://www.joedog.org/JoeDog/Siege)类的工具进行基准测试。您可以尝试所有建议的方法并比较响应时间。

更多信息请`require_once()`参见[Tech Your Universe](http://www.techyouruniverse.com/software/php-performance-tip-require-versus-require_once)。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-11T04:55:35.750

PEAR2 wiki（当它存在时）曾经列出了放弃[*所有*](http://web.archive.org/web/20090219000012/http://wiki.pear.php.net/index.php/PEAR2_Standards#Introduction)[require/include 指令以支持 autoload 的](http://web.archive.org/web/20090219000012/http://wiki.pear.php.net/index.php/PEAR2_Standards#Introduction)[充分理由](http://web.archive.org/web/20090219000012/http://wiki.pear.php.net/index.php/PEAR2_Standards#Introduction)*，至少对于库代码而言。[当诸如phar](http://www.php.net/manual/en/intro.phar.php)之类的替代包装模型即将出现时，这些会将您束缚在严格的目录结构中。*

 *更新：由于 wiki 的网络存档版本非常丑陋，我复制了以下最令人信服的理由：

> *   需要 include_path 才能使用 (PEAR) 包。这使得很难将 PEAR 包与它自己的 include_path 捆绑到另一个应用程序中，以创建包含所需类的单个文件，将 PEAR 包移动到 phar 存档而无需大量修改源代码。
> *   当顶级 require_once 与条件 require_once 混合时，这可能会导致代码无法被操作码缓存（例如 APC）缓存，这将与 PHP 6 捆绑在一起。
> *   相对 require_once 要求 include_path 已经设置为正确的值，因此无法使用没有正确 include_path 的包

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-27T13:14:09.670

即使`require_once`and`include_once` *比*`require`and慢`include`（或任何可能存在的替代方案），我们在这里谈论的是最小级别的微优化。与担心类似`require_once`.

现在，有人可能会说`require_once`允许糟糕的编码实践，因为您不需要注意保持包含的干净和有条理，但这与函数*本身*无关，尤其是与它的速度无关。

*显然，为了代码的整洁和易于维护，自动加载更好，但我想明确一点，这与速度*无关。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T10:04:49.353

您使用 include、oli 的替代方法和 __autoload() 进行测试；并使用安装[了 APC 之类的东西](http://en.wikipedia.org/wiki/Alternative_PHP_Cache#Alternative_PHP_Cache)对其进行测试。

我怀疑使用常量会加快速度。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T12:45:59.853

是的，它比普通的 require() 稍微贵一些。我认为关键是如果你能保持你的代码足够有条理以不重复包含，不要使用 *_once() 函数，因为它会为你节省一些周期。

但是使用 _once() 函数不会杀死你的应用程序。基本上，**不要以此为借口不必组织您的 include**。在某些情况下，使用它仍然是不可避免的，而且没什么大不了的。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2008-10-09T08:42:48.957

我认为在 PEAR 文档中，有对 require、require_once、include 和 include_once 的建议。我确实遵循该准则。你的申请会更清楚。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2008-10-12T02:11:59.637

它与速度无关。这是关于优雅地失败。

如果 require_once() 失败，你的脚本就完成了。没有其他任何处理。如果您使用 include_once() 脚本的其余部分将尝试继续渲染，因此您的用户可能对您的脚本中失败的事情一无所知。

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2008-10-09T10:18:33.270

我个人的看法是，使用 require_once（或 include_once）是不好的做法，因为 require_once 会检查您是否已经包含该文件并抑制双重包含文件的错误，从而导致致命错误（例如函数/类/等的重复声明） .

您应该知道是否需要包含文件。

# asp.net - ASP.NET 中的 onClose 事件

> ID：186340
> 
> 赞同：0
> 
> 时间：2008-10-09T08:03:47.707
> 
> 标签：asp.net, .net, events

有没有像 onLoad 这样的事件？

只是在关闭网站（onClose）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T08:07:18.340

不是在我怀疑你在想的意义上。您在 ASP.net 中的所有代码都在服务器上运行，该服务器本身并不“知道”用户何时关闭站点。为了实现您的目标，您需要使用 Javascript 来处理 window.onunload / window.onbeforeunload 事件并触发某种形式的服务器请求。

查看[http://developer.mozilla.org/en/DOM/window.onunload](http://developer.mozilla.org/en/DOM/window.onunload)以获取有关 window.onunload 事件的更多信息。

更新：如果您正在使用/能够使用 ASP.net AJAX，那里有一些非常整洁的包装器，可为您提供与服务器端页面生命周期类似的一组事件/行为。[Stephen Walther在他的博客上](http://weblogs.asp.net/stephenwalther/archive/2008/03/07/asp-net-ajax-in-depth-application-events.aspx)有一个相当不错的教程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T08:09:05.857

“关边”是指用户关闭客户端的浏览器窗口，对吧？

在 JavaScript 中，您有[OnUnload-event](http://www.w3schools.com/jsref/jsref_onunload.asp)。如果您需要服务器上的事件，那么您可以（我从未尝试过）使用自定义客户端脚本手动将事件推送到服务器。但是你没有开箱即用的，因为它是一个客户端事件。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T08:10:58.707

我建议为此使用 asp.net ajax。请参阅此[页面 lfecycle](http://msdn.microsoft.com/en-us/library/bb386417.aspx)的链接，它显示了 application.unload 事件（在页面关闭时触发，导航离开）。

出于显而易见的原因，这很适合 asp.net，比直接使用 onunload 事件要好，当然除非你在没有 asp.net ajax 的情况下做所有事情。它唯一不能做的就是在浏览器崩溃的情况下通知您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T09:37:16.770

您可以在 ASP.NET 应用程序文件 (Global.asax) 中使用有限的[Session_End方法。](http://msdn.microsoft.com/en-us/library/2027ewzw.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T08:06:13.227

最接近您可以将其卸载。

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# javascript - 如何自动过滤 HTML 选择列表？

> ID：186345
> 
> 赞同：2
> 
> 时间：2008-10-09T08:05:20.060
> 
> 标签：javascript, asp.net, autosuggest, autofilter

我有一个包含很多（1000 多个）名称的 HTML 选择列表。我有一个 javascript，如果有人开始输入，它将选择第一个匹配的名称。此匹配查看项目的开头：

```
var optionsLength = dropdownlist.options.length;
  for (var n=0; n < optionsLength; n++)
  {
    var optionText = dropdownlist.options[n].text;
    if (optionText.indexOf(dropdownlist.keypressBuffer,0) == 0)
    {
      dropdownlist.selectedIndex = n;
      return false; 
    }
  } 
```

客户希望有一个建议或自动过滤器：键入名称的一部分应该“找到”包含该部分的所有名称。我见过一些类似 Google Suggest 的选项，大多数都使用 Ajax，但我想要一个纯 JavaScript 选项，因为无论如何都已经加载了选择列表。有人指点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T08:23:09.197

改变

```
if (optionText.indexOf(dropdownlist.keypressBuffer,0) == 0) 
```

到

```
if (optionText.indexOf(dropdownlist.keypressBuffer) > 0) 
```

在. `dropdownlist.keypressBuffer`_`optionText`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T09:40:41.070

我会设置一个缓存来保存`options`我的`select`. 而不是在 中过滤`options`，`select`我会清除`select`，然后用 match 重新填充它`options`。

大量伪代码：

```
onLoad:
    set cache

onKeyPress:
    clear select-element
    find option-elements in cache
    put found option-elements into select-element 
```

这是我写的一个小 POC，`selects`从另一个中选择的内容中进行过滤`select`——实际上是将一堆选择链接在一起。

也许它可以给你一些想法：

```
function selectFilter(_maps)
{
    var map = {};

    var i = _maps.length + 1; while (i -= 1)
    {
        map = _maps[i - 1];

        (function (_selectOne, _selectTwo, _property)
        {
            var select = document.getElementById(_selectTwo);
            var options = select.options;
            var option = {};
            var cache = [];
            var output = [];

            var i = options.length + 1; while (i -= 1)
            {
                option = options[i - 1];

                cache.push({
                    text: option.text,
                    value: option.value,
                    property: option.getAttribute(_property)
                });
            }

            document.getElementById(_selectOne).onchange = function ()
            {
                var selectedProperty = this
                                       .options[this.selectedIndex]
                                       .getAttribute(_property);
                var cacheEntry = {};
                var cacheEntryProperty = undefined;

                output = [];

                var i = cache.length + 1; while (i -= 1)
                {
                    cacheEntry = cache[i - 1];

                    cacheEntryProperty = cacheEntry.property;

                    if (cacheEntryProperty === selectedProperty)
                    {
                        output.push("<option value=" + cacheEntry.value + " "
                        _property + "=" + cacheEntryProperty + ">" +
                        cacheEntry.text + "</option>");
                    }
                }

                select.innerHTML = output.join();
            };
        }(map.selectOne, map.selectTwo, map.property));
    }
}

$(function ()
{
    selectFilter([
        {selectOne: "select1", selectTwo: "select2", property: "entityid"},
        {selectOne: "select2", selectTwo: "select3", property: "value"}
    ]);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T09:53:37.190

YUI 库有一个用于此类功能的库，称为[AutoComplete](http://developer.yahoo.com/yui/autocomplete/)。

AutoComplete 的 DataSource 可以是本地 javascript 对象，如果您改变主意，也可以轻松切换到 Ajax。

YUI 组件是相当可定制的，具有相当多的功能。

编辑：我不确定您是否可以按照问题的要求使用选择框。也许是可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-23T00:12:56.423

使用这个过滤器脚本 [http://www.barelyfitz.com/projects/filterlist/](http://www.barelyfitz.com/projects/filterlist/)

# javascript - 如何在自定义助手中重新实现 jQuery 的默认助手

> ID：186351
> 
> 赞同：2
> 
> 时间：2008-10-09T08:06:51.430
> 
> 标签：javascript, jquery

我正在创建一个自定义拖动助手（在 jQuery 中）：

```
$('.dragme', element).draggable({
    appendTo: 'body',
    helper  : custom_drag_helper,
    opacity : 0.5
}); 
```

我这样做是因为我有时想克隆有时做默认功能，即拖动原始元素。

```
function custom_drag_helper() {
    if (/*criteria on when to move instead of clone */) {
        return $(this); /* this is what helper: 'original' seems to do */
    } else {
        clone = $(this).clone(); /* this is what helper: 'clone' does */
        return clone;
    }
} 
```

但我根本无法让原始功能正常工作。return clone() 工作正常，但 return $(this) 没有任何乐趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T08:07:48.340

好的，在输入这​​个问题时，我做了更多的来源潜水，发现了这条小线：

```
if (this.options.helper == 'original' && !(/^(?:r|a|f)/).test(this.element.css("position")))
        this.element[0].style.position = 'relative'; 
```

在我试图解决这个问题的那天我没有找到。添加`this.style.position = 'relative';`到我上面的代码解决了这个问题！

# database - DB：是否使用身份列？

> ID：186369
> 
> 赞同：7
> 
> 时间：2008-10-09T08:14:42.303
> 
> 标签：database, design-patterns

在设计表格时，我的同事说我应该避免使用标识列，因为它特定于 SQL Server 和 MS Access，但我与他的观点不同，因为它使我的编码更简单。

我应该使用身份列吗？如果不是从应用程序代码创建标识列的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T08:18:42.017

您不能将应用程序与数据库供应商完全分开。如果这样做，您将无法利用数据库为您提供的任何功能。

我会说使用身份列。如果您转移到 Oracle（例如），您可以使用序列。变化不大。

我不知道您使用的是什么技术，但有一点会有所帮助，那就是使用 Hibernate 或 iBATIS（我认为它们都可用于 Java 和 .NET）之类的工具，它可以将您与数据库实现区分开来细节。然后，如果您更改数据库供应商，则无需更改应用程序代码，只需更改配置即可。（理论上，至少！）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T08:47:37.887

使用身份列！

它确实将您的“应用程序逻辑”与“业务逻辑”分开。

假设您使用“电子邮件”作为主键（这在“业务逻辑”方面确实有意义）。当该电子邮件不再存在并且您的用户想要编辑您的电子邮件时，您将遇到麻烦。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T08:45:58.777

据我所知，每一个稍微严肃的 RDBMS 每个表都有某种独特的编号方案。

1.  Access 和 SQL Server 具有标识列
2.  MySQL具有自动增量列
3.  PostgreSQL 有序列
4.  sqlite 有一个隐式 ROWID 列
5.  Oracle 有某种序列，虽然我一点也不熟悉

我主要使用它，理论上它并不总是必需的，但如果你想保持引用完整性，int 比 varchar 存储更少并且更容易比较，特别是如果你的外键比单个列更复杂。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-06T08:52:56.577

除非您完全意识到它的缺陷并且没有正当理由使用 SEQUENCE 或模拟序列生成器，否则不要使用标识列。

序列更加灵活，并且没有身份列所具有的缺点/限制。

来自[http://www.jumpingbean.co.za/blogs/mark/identity_autoincrement_fields_and_database_sequences](http://www.jumpingbean.co.za/blogs/mark/identity_autoincrement_fields_and_database_sequences)：

> **自动递增的痛苦**
> 
> *在保留身份值的同时复制数据*
> 
> 当您需要复制整个表并保留主键值时，自动递增键可能会变得很痛苦。尝试直接插入标识列将导致引发错误。通常，供应商会提供一些允许您暂时删除约束的语句，以便您可以插入现有值。在 MSSQL 中，您可以发出命令
> 
> “设置 IDENTITY_INSERT 产品开启”。
> 
> 其他供应商将要求您删除约束，然后重新启用它。
> 
> *更痛苦 - 如何检索新插入行的值？*
> 
> 此外，服务器通常提供不同的方法来检索新插入的行的标识列值。对于 MySQL，这是 LAST_INSERT_ID() 函数，对于 MSSQL，它是 @@identity，例如选择 @@identity。

MS SQL Server 2011 将支持 SEQUENCE。

如果您使用不支持 SEQUENCE 的 RDBMS 服务器（如 MSSQL pre-2011 或 MySQL），则有两种选择：

1.  **切换到[PostgreSQL](http://www.postgresql.org/)。**这是最简单的选择，真的。您将获得企业级、完全开源的 RDBMS 服务器。如果你愿意，你也可以得到商业支持。
2.  **使用支持模拟 SEQUENCE 的数据访问库**。[JPA 2.0](http://en.wikipedia.org/wiki/Java_Persistence_API)实现，例如[EclipseLink](http://www.eclipse.org/eclipselink/)、[Hibernate](http://www.hibernate.org/)使[这对您来说非常简单（TABLE 策略）](http://wiki.eclipse.org/EclipseLink/Examples/JPA/PrimaryKey)。它与上述并不相互排斥。将 JPA 2.0 与 PostgreSQL 一起使用将比使用原始 JDBC 与 MySQL 轻松得多。

# c# - C# 控制台批处理应用程序中的最佳计时器方法

> ID：186385
> 
> 赞同：3
> 
> 时间：2008-10-09T08:20:20.203
> 
> 标签：c#, batch-file, console, timer

对于必须按以下方式处理的 C# 控制台批处理应用程序，这是最好的计时器方法：

1.  连接到数据源
2.  处理批处理，直到发生超时或处理完成。“用数据源做点什么”
3.  优雅地停止控制台应用程序。

相关问题：[如何将计时器添加到 C# 控制台应用程序](https://stackoverflow.com/questions/186084/how-do-you-add-a-timer-to-a-c-console-application)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T11:47:41.733

抱歉，这是一个完整的控制台应用程序……但这是一个完整的控制台应用程序，可以帮助您入门。再一次，我为这么多代码道歉，但其他人似乎都在给出“哦，你所要做的就是去做”的答案:)

```
using System;
using System.Collections.Generic;
using System.Threading;

namespace ConsoleApplication1
{
    class Program
    {
        static List<RunningProcess> runningProcesses = new List<RunningProcess>();

        static void Main(string[] args)
        {
            Console.WriteLine("Starting...");

            for (int i = 0; i < 100; i++)
            {
                DoSomethingOrTimeOut(30);
            }

            bool isSomethingRunning = false;

            do
            {
                foreach (RunningProcess proc in runningProcesses)
                {
                    // If this process is running...
                    if (proc.ProcessThread.ThreadState == ThreadState.Running)
                    {
                        isSomethingRunning = true;

                        // see if it needs to timeout...
                        if (DateTime.Now.Subtract(proc.StartTime).TotalSeconds > proc.TimeOutInSeconds)
                        {
                            proc.ProcessThread.Abort();
                        }
                    }
                }
            }
            while (isSomethingRunning);

            Console.WriteLine("Done!");    

            Console.ReadLine();
        }

        static void DoSomethingOrTimeOut(int timeout)
        {
            runningProcesses.Add(new RunningProcess
            {
                StartTime = DateTime.Now,
                TimeOutInSeconds = timeout,
                ProcessThread = new Thread(new ThreadStart(delegate
                  {
                      // do task here...
                  })),
            });

            runningProcesses[runningProcesses.Count - 1].ProcessThread.Start();
        }
    }

    class RunningProcess
    {
        public int TimeOutInSeconds { get; set; }

        public DateTime StartTime { get; set; }

        public Thread ProcessThread { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T08:55:06.683

这取决于您希望停止时间有多准确。如果您在批处理中的任务相当快并且您不需要非常准确，那么我会尝试使其成为单线程：

```
DateTime runUntil = DataTime.Now.Add(timeout);
forech(Task task in tasks)
{
   if(DateTime.Now >= runUntil)
   {
        throw new MyException("Timeout");
   }
   Process(task);
} 
```

否则你需要多线程，这总是比较困难的，因为你需要弄清楚如何在中间终止你的任务而不引起副作用。您可以使用 System.Timers 中的计时器：http: [//msdn.microsoft.com/en-us/library/system.timers.timer](http://msdn.microsoft.com/en-us/library/system.timers.timer(VS.71).aspx) (VS.71).aspx或 Thread.Sleep。当超时事件发生时，您可以终止执行实际处理的线程，清理并结束进程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T08:43:45.507

当您说“直到发生超时”时，您的意思是“继续处理一个小时然后停止”吗？如果是这样，我可能会说得非常明确——在你想完成的时候开始工作，然后在你的处理循环中，检查你是否已经到了那个时间。它非常简单，易于测试等。就可测试性而言，您可能需要一个假时钟，它可以让您以编程方式设置时间。

编辑：这里有一些伪代码试图澄清：

```
List<DataSource> dataSources = ConnectToDataSources();
TimeSpan timeout = GetTimeoutFromConfiguration(); // Or have it passed in!
DateTime endTime = DateTime.UtcNow + timeout;

bool finished = false;
while (DateTime.UtcNow < endTime && !finished)
{
    // This method should do a small amount of work and then return
    // whether or not it's finished everything
    finished = ProcessDataSources(dataSources);
}

// Done - return up the stack and the console app will close. 
```

那只是使用内置时钟而不是可以模拟的时钟接口等 - 但它可能使一般适当的更容易理解。

# linux - 部署使用 cron 的 Web 应用程序

> ID：186387
> 
> 赞同：1
> 
> 时间：2008-10-09T08:21:27.080
> 
> 标签：linux, deployment, cron

部署依赖 cron 作业（用于缓存维护、数据库更新等）的 Web 应用程序的最佳程序是什么？对于 DB 架构更改之类的事情，有诸如 DBDeploy 之类的工具来管理版本之间的更改，但是如何自动更新 crontab？

我知道实际的 cron 文件存储在 /var/spool/ 中，但我听说直接编辑这些文件是非常不明智的。其他人是如何做到的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T08:24:53.843

您可以（在大多数 Linux 发行版上）将文件放在 /etc/cron.d 中，而不是单个用户的 crontab 中。它们可以由您想要的任何用户运行（显然，您需要是 root）。

如果您将 Web 应用程序构建到 RPM（debian pkg 等）中，那么它可以将文件放入 /etc/cron.d 并运行作业。

只需将相同的 RPM 加载到您的系统测试机器上，以检查它是否首先工作 - 完成工作。

# sql - 你如何记录你的数据库结构？

> ID：186392
> 
> 赞同：30
> 
> 时间：2008-10-09T08:23:02.397
> 
> 标签：sql, database, documentation, relational

许多数据库系统不允许对表和字段进行注释或描述，那么除了具有良好命名约定的明显内容之外，您如何记录表/字段的用途？

（我们现在假设“优秀”的表和字段名称不足以记录数据库中每个表、字段和关系的全部含义。）

我知道很多人使用 UML 图来可视化数据库，但我很少（如果有的话）见过包含字段注释的 UML 图。`.sql`但是，我在文件中使用注释方面有很好的经验。这种方法的缺点是，`.sql`当数据库结构随时间发生变化时，它需要手动保持文件是最新的——但如果你这样做了，你也可以让它处于版本控制之下。

我见过的其他一些技术是描述数据库结构和关系的单独文档，以及在 ORM 代码或其他数据库映射代码中手动维护的注释。

您过去是如何解决这个问题的？存在哪些方法以及与之相关的各种利弊？您希望如何在“完美世界”中解决这个问题？

**更新**

正如其他人所指出的，大多数流行的 SQL 引擎实际上都允许注释，这很棒。奇怪的是，人们似乎并没有过多地使用这些功能。至少不是我过去参与的项目。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-09T12:09:27.557

MySQL[允许](http://dev.mysql.com/doc/refman/5.0/en/create-table.html)对表和行进行注释。PostgreSQL[也是如此](http://www.postgresql.org/docs/7.4/interactive/sql-comment.html)。从其他答案来看，Oracle 和 MSSQL 也有评论。

对我来说，UML 图的组合用于快速复习字段名称、类型和约束，以及外部文档（TeX，但可以是任何格式）以及对所有与数据库相关的内容的扩展描述 - 特殊值、字段注释、访问笔记，无论如何 - 效果最好。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-31T13:46:19.787

晚了，但希望有用……这是我们在开发相对较大的数据库时使用的过程（总共大约 100 个表和大约 350 个对象）

*   开发人员需要使用扩展属性来为所有对象添加细节。
*   管理员拒绝了任何没有扩展属性的 DDL
*   每天使用第三方工具通过命令行界面自动生成可视化文档。我们使用了[ApexSQL Doc](http://www.apexsql.com/sql_tools_doc.aspx)，它工作得很好，但我也成功地使用了其他公司 Red Gate 的 SQL Doc。

这个过程确保我们将所有对象记录在案并保持最新状态。

困难的事情是让开发人员始终如一地写出好的评论；）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-09T08:28:05.117

SQL Server 具有可以处理此问题的扩展属性。

本文介绍如何在 SQL Sever 中设置它们 [http://www.developer.com/db/article.php/3677766](http://www.developer.com/db/article.php/3677766)

[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms190243.aspx)

它可以与[RedGate SQL Doc](http://www.red-gate.com/products/SQL_Doc/index.htm)结合使用来创建一个漂亮的数据字典。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-12T20:10:42.997

我使用附在表格和列上的注释。[SchemaSpy](http://schemaspy.sourceforge.net/)是一个很棒的工具，可以从你的模式中生成 html 文档文件，包括注释。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T09:06:04.400

有一次，我编写了一个基本的 SQL 解析器，它可以解析 CREATE TABLE 语句并去除特殊格式的注释。然后将这些后处理为 LaTeX 源并呈现为 PDF。这受到[Javadoc](http://en.wikipedia.org/wiki/Javadoc)的启发，用于创建[This product](http://www.niit-tech.com/industries/insurance/property-and-casualty/solutions/acumen-advantage)的文档。随后，数据字典功能被内置到仓库管理器中，并使用 LaTeX 生成器的修改版本从仓库管理器中呈现数据字典。

在另一个项目中，我使用了 Visio——Visual Studio Enterprise Architect 附带的版本将对数据库进行正向工程。如此生成的 SQL 将表和列注释呈现在注释字符串中，这些注释字符串解析起来相当简单。我编写的工具生成了 MIF 文件，这些文件包含在使用 FrameMaker 构建的规范文档中。

如果您有一个存储库工具，例如[Powerdesigner](http://www.sybase.com/products/modelingmetadata/powerdesigner)，您可以在其中维护数据模型并获取包含您输入的文档的存储库报告。如果您需要将数据字典与功能规范进行更深入的集成（对于 ETL 复杂且涉及派生值的大量计算的数据仓库系统非常有用），您仍然可以提取元数据并编写实用程序来生成将集成数据的东西字典转换成规范文档。这还允许在数据字典项和其他规范文档之间进行交叉引用，并生成涵盖数据字典定义和相关文档的索引，例如如何通过示例计算某些内容的规范。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T09:13:44.197

我们编写了一个 word 文档，列出了表格、字段以及所有内容。这由一个图表支持，该图表显示了所有内容如何相互链接/相关。这真的是一个非常简单的文档，只是一堆具有字段名称>数据类型>目的的表

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T09:21:03.903

我正在使用[Firebird](http://www.firebirdsql.org)，它具有所有系统对象（表、列、视图、过程和参数、触发器等）的描述字段。这很好，因为您可以轻松地与其他人共享它（文档与数据库一起使用，而不是单独使用）并且您永远不要失去它。

大多数管理员。Firebird 的工具允许您编辑这些描述，并且有一些专门的工具（例如 IBDesc）可以创建漂亮的 HTML 或 PDF 报告，您可以轻松地打印（部分或全部表格）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T11:49:26.457

这是一种非常简单的方法，但我使用了一对 wiki 页面：一个带有数据库的 mysqldump，一个以稍微更像英语的格式编写。

对于我从事的项目，这已经足够了（通过几十个表级别）。我不知道它可以扩展到更大的项目（比如数百个表），但到目前为止它一直很好。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-16T10:08:15.607

我在评论我的程序时评论我的数据库。通过在源代码（包含 DDL 指令的 SQL 文件）中编写好的（我希望的）注释。

使用 SQL COMMENT 是另一种可能性。它们的好处是它们始终与您的对象在一起，并与它们一起备份，等等。坏处是它们受到更多限制（例如长度）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-08-13T21:24:44.557

我最近开始编写 Markdown 文档，其中包括链接到单个表格`.sql`文件（希望表格和字段可以直观地命名并带有大量注释）。

我使用以下命令将单个表模式保留在版本控制中：

`mysqldump --no-data --tab=./tables dbname`

单个表的模式允许您查看注释、索引、唯一键等。因此是相当不言自明的（至少是这样的想法）。

主 Markdown 文档有超链接，例如贯穿始终的用户表，因此读者可以轻松转到不同的表。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T08:25:26.573

由于我们使用 Rational Software Architect，我们使用它的数据发现功能来记录我们的数据库，然后从那里注释它们。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-09T09:22:01.840

在 Oracle 中，您可以对表进行评论并将其存储在数据字典中。

但是，我将所有表、列、索引注释存储在一个非常旧版本的 ERWin 中。它是事实的主要来源，并生成 DDL 以创建表格等。从那里，我可以将其提取到 word 文档或 pdf 中。

# .net - 如何使用 .NET 显示 VRML 模型？

> ID：186396
> 
> 赞同：4
> 
> 时间：2008-10-09T08:24:27.590
> 
> 标签：.net, 3d, visualization, vrml

我有一个在 .NET 应用程序中显示 VRML 模型的请求。有人知道一种简单的方法，可能使用标准的 .NET 组件来实现这一点吗？在应用程序中表示 VRML 时，我可能必须面对哪些问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-20T03:19:16.467

VRML 标准已演变为 X3D（它仍然支持旧语法，但现在推出基于 XML 的语法。对于查看此线程的任何人，最好搜索 X3D 和 .Net 而不是 VRML 和 .Net。另外，对于网络，[请查看 X3DOM](http://www.x3dom.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T08:27:47.253

我认为主要问题是我至少在五年内没有看到任何/任何人使用 VRML。我认为你最好只找到一个 VRML-> SVG 转换器。如今，在浏览器中显示 SVG 的定义相当明确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T09:59:26.367

为自己获取一个 VRML ActveX 控件，并将其[插入](http://msdn.microsoft.com/en-us/library/aa446515.aspx)到您的 .NET 应用程序中，您应该可以在[www.web3d.org找到一个](http://www.web3d.org/x3d/content/examples/X3dResources.html)

# oracle - Oracle 中 varchar2 PL/SQL 子程序参数的大小限制是多少？

> ID：186403
> 
> 赞同：14
> 
> 时间：2008-10-09T08:26:10.113
> 
> 标签：oracle, plsql

在 Oracle PL/SQL 中创建过程（或函数）时，不能指定 varchar2 参数的最大长度，只能指定数据类型。例如

```
create or replace procedure testproc(arg1 in varchar2) is
begin
  null;
end; 
```

您知道可以作为 arg1 参数传递给 Oracle 中此过程的字符串的最大长度吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-09T08:35:34.227

在 PL/SQL 过程中它可能高达 32KB

更多信息在这里：http: [//it.toolbox.com/blogs/oracle-guide/learn-oracle-sql-and-plsql-datatypes-strings-10804](http://it.toolbox.com/blogs/oracle-guide/learn-oracle-sql-and-plsql-datatypes-strings-10804)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-09T08:43:03.557

我尝试使用 testproc( lpad( ' ', 32767, ' ' ) ) 并且它有效。

32768 字节失败，所以它是 32K - 1 字节

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-27T06:26:16.097

`VARCHAR2`在 PL/SQL 中，自 10gR2 以来数据类型的最大大小为**32767 字节**（可能更早，但我刚刚检查了该版本的文档）。

文档参考：

*   Oracle 12cR1：[PL/SQL 语言参考 12c 第 1 版](http://docs.oracle.com/cd/E16655_01/appdev.121/e17622/datatypes.htm#LNPLS99943)
*   Oracle 11gR2：[PL/SQL 语言参考 11g 第 2 版](http://docs.oracle.com/cd/E11882_01/appdev.112/e17126/datatypes.htm#LNPLS99943)
*   Oracle 10gR2：[PL/SQL 用户指南和参考 10g 第 2 版](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/datatypes.htm#sthref732)

# visual-c++ - Visual C++ 未解析的外部符号（找不到我自己的函数之一）

> ID：186405
> 
> 赞同：4
> 
> 时间：2008-10-09T08:27:25.180
> 
> 标签：visual-c++, linker-errors

这是一个非常基本的问题，目前让我感到沮丧。假设在一个解决方案中，我有两个项目。我们将第一个项目称为 SimpleMath。它有一个头文件“Add.h”，其中

```
int add(int i, int j) 
```

以及具有的实现“Add.cpp”

```
int add(int i, int j) {
  return i+j;
} 
```

现在假设在第二个项目中我想使用 add 函数。但是，这段代码：

> **#include "..\SimpleMath\Add.h"**

```
int main() {

    add(1, 2);

} 
```

导致“未解析的外部符号”。如何让第二个程序“了解” .cpp 文件中的实际实现。作为旁注，所有代码都是虚构的，这不是我实际编程的方式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-30T14:34:28.707

如果您尝试将 C 库链接到 C++ 项目，则需要执行类似的操作

```
extern "C" {
    #include "..\SimpleMath\Add.h"
} 
```

因为 C 和 C++ 使用不同的符号名称。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-09T08:42:07.817

你得到错误的原因是通过包含头文件你告诉编译器有一个符号

```
int add (int, int) 
```

这将在链接期间出现，但您实际上并未在项目中包含该符号（函数的代码）。解决此问题的一种快速方法是简单地将 Add.cpp 添加到两个项目中。但“不错”的解决方案可能是通过更改项目属性中的项目类型将 SimpleMath 变成库而不是应用程序。

顺便说一句，您可能需要某种机制来防止多次包含该头文件。如果您坚持使用 Visual C++，我通常使用`#pragma once`which 应该没问题，但它可能不是完全可移植的，所以如果您想要可移植性，请使用更传统的方法，将头文件包装在`#ifndef`-block 中，如下所示：

```
#ifndef __ADD_H
#define __ADD_H

int add (int i, int j);

#endif 
```

祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T08:29:06.800

您要么必须使 Add.cpp 成为库的一部分并将其包含在两个项目中。或者您也必须将 Add.cpp 添加到您的第二个项目中。

编辑：使 SimpleMath 成为一个库，进入 General 上的项目设置，并将 Configuration Type 更改为 Static Lib。

然后进入您的解决方案设置，单击 Project Dependencies，然后在下拉列表中选择您的第二个项目，并在 SimpleMath 旁边打勾。这将自动将 SimpleMath 链接到您的第二个项目，并且还将确保在您重新构建第二个项目时重新构建对 SimpleMath 的任何更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T08:31:12.660

SimpleMath 需要在其项目属性中定义为库文件（.LIB），我假设这是一个非托管（非.Net）C++。然后在另一个项目中包含 SimpleMath.lib。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-27T15:04:13.877

刚刚在同一个项目中也有它，结果我有两个过滤器并将两个 .cpp-files 命名**为相同的名称**。所以 Visual Studio 只是在编译另一个时覆盖了一个 .obj 。导致第一个 .obj 中缺少函数。教训：永远不要将 .cpp 文件命名为相同的名称，即使在不同的文件夹/过滤器中也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-12T09:42:34.770

我只是**在同一个项目**中遇到了这个问题......仔细查看我的代码后，我注意到尝试调用该函数的代码正在**使用接口**（通过纯虚拟方法调用 = 0）。但是，**我忘记**在接口类和实现类中添加“虚拟”二字。一旦我添加了“虚拟”，问题就解决了。

# xml - 如何设置“xml:lang”属性？

> ID：186413
> 
> 赞同：1
> 
> 时间：2008-10-09T08:30:01.697
> 
> 标签：xml, xsd, schema, biztalk, biztalk-2006

我需要`xml:lang`在 BizTalk 出站文档中的根 xml 节点上添加一个属性。

这是一个固定值，所以它可以在模式或其他东西中设置。

这就是我想要摆脱的：

```
<Catalog xml:lang="NB-NO">
...
</Catalog> 
```

我试图定义属性“xml：lang”，但它不允许我在架构中使用“：”。

这是我收到的错误消息：

> 'name' 属性值 'xml:lang' 无效：名称中第 3 位的 ':' 字符、十六进制值 0x3A 不能包含在名称中。

是否有另一种方法可以在 BizTalk 中插入“：”作为属性名称的一部分？

谁能告诉我该怎么做？

我正在使用 BizTalk 2006 并且没有编排。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T08:43:03.103

尝试将 xml 命名空间声明添加到架构中

```
xmlns:xml="http://www.w3.org/XML/1998/namespace" 
```

请注意，重新创建架构文件时将删除此添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-10T16:02:48.820

代替

```
<xs:attribute name="xml:lang" /> 
```

尝试

```
<xs:attribute ref="xml:lang" /> 
```

反而。至少 PhpStorm 不再抱怨它了。

# c# - 从 ac# .net Web 应用程序生成 PDF/Excel 报告

> ID：186421
> 
> 赞同：1
> 
> 时间：2008-10-09T08:34:22.640
> 
> 标签：c#, crystal-reports, reporting

我们有一个由数百个不同客户使用的系统，客户喜欢在月底生成一份与他/她的客户的活动报告。这些报告没什么特别的；它们可能包含一个标志、地址和几行数学数据。目前我们使用 Crystal Reports，但这并不是一个愉快的体验；）也似乎有点矫枉过正，因为我们使用了它的 1% 的功能。

其他人曾经从 Web 应用程序生成报告，PDF 生成是必须的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T08:41:41.627

好吧，我们也使用 CR。我听说过[iTextSharp](http://itextsharp.sourceforge.net)，并且已经看到它在我们的系统中用于 pdf 连接。也许这就是你要找的。对于 Excel 报告生成，我们对简单的表格数据使用 csv 格式，对更高级的报告使用[COM 互操作。](http://msdn.microsoft.com/en-us/library/ms173186(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T09:03:48.540

如果您只需要生成 PDF 文件，您可以使用[ABCpdf.NET 之](http://www.websupergoo.com/purchase.htm#abcpdfnet)类的库。每个许可证大约 329 美元，但易于使用且非常可靠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T08:50:06.053

我们使用 SQL Server 报告服务 (SSRS)。报告在 Visual Studio 中构建。 [链接文本](http://www.microsoft.com/sql/reporting/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T14:57:35.220

始终在这里使用 SQL 报告，但如果您想手动创建 PDF，那么 iTextSharp 非常成熟。它实际上是 iText Java 库的一个端口，因此谷歌搜索通常会发现大量文档和示例可供使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T09:11:07.370

在评估一些 Web 控制套件以获得一个像样的网格时，我注意到其中一些已经导出到内置的 xls/csv/pdf。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T10:55:01.623

为了生成 PDF 输出，我一直使用 FOP 或[nFOP](http://sourceforge.net/projects/nfop "nFOP")。这是一个非常好的开源 XSL:FO 处理器。

# ruby-on-rails - Mongrel集群和多应用问题

> ID：186422
> 
> 赞同：2
> 
> 时间：2008-10-09T08:34:37.710
> 
> 标签：ruby-on-rails, apache, mongrel, soap4r

我们正在处理这个问题。我们正在使用网络服务（使用soap4r）来运行某种搜索，当网络服务服务器关闭并且我们的应用程序试图连接到它时，问题就会出现。此时应用程序无法访问，并且所有客户都被阻止。

我们能做些什么来避免这种情况？是否有可能阻止到它被阻止的杂种的路由？（我想apache的代理使用循环算法）

谢谢罗伯托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T16:04:41.840

在我看来，这可能更像是一个 mod_proxy 问题，而不是 Mongrel 或 Apache 的问题——您是否按照[此处](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxytimeout)所述设置代理超时？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-12T16:46:46.983

使用 mod_rewrite 重新生成对 Web 服务客户端比 Apache 的代理超时错误更有用的错误页面。例如，此 Apache 配置将呈现`maintence.html`（如果存在）。因此，您只需将文件放入其中，服务器就会自动处于维护模式。

```
# Check for maintenance file and redirect all requests
RewriteCond %{DOCUMENT_ROOT}/system/maintenance.html -f
RewriteCond %{SCRIPT_FILENAME} !maintenance.html
RewriteRule ^.*$ /system/maintenance.html [L] 
```

您可以将其设置为使用适当的内容类型设置的 XML 文件，使静态文件看起来像 Web 服务响应，本质上是“请等待 10 分钟，然后重试”，可能具有可配置的等待时间。

[Capistrano 的](http://capify.org/)web:disable 任务可能对您有所帮助，因为它需要一个参数来确定站点将在多长时间内不可用，并在生成`maintence.html`文件时将其放入 HTML 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T17:47:56.063

You need to put a timeout on your Soap4R requests. Set the connect_timeout attribute to something rather small. This should cause an exception to be handled in your code and not just leave the requests hanging.

You should also make sure your timeouts are set in your mod_proxy_balancer config.

# php - 给定周数计算星期几

> ID：186431
> 
> 赞同：29
> 
> 时间：2008-10-09T08:42:11.377
> 
> 标签：php, date

给定一个星期数，例如`date -u +%W`，你如何计算从星期一开始的那一周的天数？

第 40 周的示例 rfc-3339 输出：

```
2008-10-06
2008-10-07
2008-10-08
2008-10-09
2008-10-10
2008-10-11
2008-10-12 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-09T09:07:03.523

**PHP**

```
$week_number = 40;
$year = 2008;
for($day=1; $day<=7; $day++)
{
    echo date('m/d/Y', strtotime($year."W".$week_number.$day))."\n";
} 
```

* * *

下面的帖子是因为我是一个没有正确阅读问题的白痴，但是会从星期一开始得到一周内的日期，给定日期，而不是周数..

**在 PHP**中，改编自[PHP 日期手册页](http://ie2.php.net/manual/en/function.date.php)上的[这篇文章](http://ie2.php.net/manual/en/function.date.php#85258)：

```
function week_from_monday($date) {
    // Assuming $date is in format DD-MM-YYYY
    list($day, $month, $year) = explode("-", $_REQUEST["date"]);

    // Get the weekday of the given date
    $wkday = date('l',mktime('0','0','0', $month, $day, $year));

    switch($wkday) {
        case 'Monday': $numDaysToMon = 0; break;
        case 'Tuesday': $numDaysToMon = 1; break;
        case 'Wednesday': $numDaysToMon = 2; break;
        case 'Thursday': $numDaysToMon = 3; break;
        case 'Friday': $numDaysToMon = 4; break;
        case 'Saturday': $numDaysToMon = 5; break;
        case 'Sunday': $numDaysToMon = 6; break;   
    }

    // Timestamp of the monday for that week
    $monday = mktime('0','0','0', $month, $day-$numDaysToMon, $year);

    $seconds_in_a_day = 86400;

    // Get date for 7 days from Monday (inclusive)
    for($i=0; $i<7; $i++)
    {
        $dates[$i] = date('Y-m-d',$monday+($seconds_in_a_day*$i));
    }

    return $dates;
} 
```

输出`week_from_monday('07-10-2008')`给出：

```
Array
(
    [0] => 2008-10-06
    [1] => 2008-10-07
    [2] => 2008-10-08
    [3] => 2008-10-09
    [4] => 2008-10-10
    [5] => 2008-10-11
    [6] => 2008-10-12
) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T20:21:10.263

如果你有 Zend 框架，你可以使用 Zend_Date 类来做到这一点：

```
require_once 'Zend/Date.php';

$date = new Zend_Date();
$date->setYear(2008)
     ->setWeek(40)
     ->setWeekDay(1);

$weekDates = array();

for ($day = 1; $day <= 7; $day++) {
    if ($day == 1) {
        // we're already at day 1
    }
    else {
        // get the next day in the week
        $date->addDay(1);
    }

    $weekDates[] = date('Y-m-d', $date->getTimestamp());
}

echo '<pre>';
print_r($weekDates);
echo '</pre>'; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-06-12T12:24:24.127

由于发布了这个问题和接受的答案，[DateTime](http://php.net/datetime)类使这更简单：-

```
function daysInWeek($weekNum)
{
    $result = array();
    $datetime = new DateTime('00:00:00');
    $datetime->setISODate((int)$datetime->format('o'), $weekNum, 1);
    $interval = new DateInterval('P1D');
    $week = new DatePeriod($datetime, $interval, 6);

    foreach($week as $day){
        $result[] = $day->format('D d m Y H:i:s');
    }
    return $result;
}

var_dump(daysInWeek(24)); 
```

这具有照顾闰年等的额外优势。

[看到它工作](http://3v4l.org/HqSEv)。包括艰难的第 1 周和第 53 周。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T09:09:04.283

此计算在很大程度上取决于您居住的地方。例如，在欧洲，我们从星期一开始一周，在美国，星期日是一周的第一天。在英国，第 1 周是 1 月 1 日，其他国家/地区从包含一年中第一个星期四的那周开始第 1 周。

[您可以在http://en.wikipedia.org/wiki/Week#Week_number](http://en.wikipedia.org/wiki/Week#Week_number)找到更多一般信息

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T22:24:43.897

此函数将给出找到 $date 的星期几的时间戳。如果 $date 没有给出，它假定“现在”。如果您更喜欢可读日期而不是时间戳，请将日期格式传递给第二个参数。如果您不是在星期一开始您的一周（幸运），请为第三个参数传入不同的日期。

```
function week_dates($date = null, $format = null, $start = 'monday') {
  // is date given? if not, use current time...
  if(is_null($date)) $date = 'now';

  // get the timestamp of the day that started $date's week...
  $weekstart = strtotime('last '.$start, strtotime($date));

  // add 86400 to the timestamp for each day that follows it...
  for($i = 0; $i < 7; $i++) {
    $day = $weekstart + (86400 * $i);
    if(is_null($format)) $dates[$i] = $day;
    else $dates[$i] = date($format, $day);
  }

  return $dates;
} 
```

所以**week_dates()**应该返回类似...

```
Array ( 
  [0] => 1234155600 
  [1] => 1234242000 
  [2] => 1234328400 
  [3] => 1234414800 
  [4] => 1234501200
  [5] => 1234587600
  [6] => 1234674000
) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-29T12:10:40.903

```
$week_number = 40;
$year = 2008;

for($day=1; $day<=7; $day++)
{
    echo date('m/d/Y', strtotime($year."W".$week_number.$day))."\n";
} 
```

如果`$week_number`小于 10，这将失败。

```
//============Try this================//

$week_number = 40;
$year = 2008;

if($week_number < 10){
   $week_number = "0".$week_number;
}

for($day=1; $day<=7; $day++)
{
    echo date('m/d/Y', strtotime($year."W".$week_number.$day))."\n";
}

//==============================// 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-06T17:40:15.967

另一个代码嘿嘿：

```
public function getAllowedDays($year, $week) {
    $weekDaysArray = array();
    $dto = new \DateTime();
    $dto->setISODate($year, $week);

    for($i = 0; $i < 7; $i++) {
        array_push($weekDaysArray, $dto->format('Y-m-d'));
        $dto->modify("+1 days");
    }

    return $weekDaysArray;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T15:03:55.287

我发现这个解决方案有问题。我必须将周数填零，否则它会中断。

我的解决方案现在看起来像这样：

```
$week_number = 40;
$year = 2008;
for($day=1; $day<=7; $day++)
{
    echo date('m/d/Y', strtotime($year."W".str_pad($week_number,2,'0',STR_PAD_LEFT).$day))."\n";
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-26T16:22:44.497

对于那些在给定周数（1-52）的情况下寻找一周中的日子的人， **从星期日开始，**这是我的小工作。考虑到检查周是否在正确的范围内，并填充值 1-9 以保持一切正常。

```
$week = 2; $year = 2009;

$week = (($week >= 1) AND ($week <= 52))?($week-1):(1);

$dayrange  = array(7,1,2,3,4,5,6);

for($count=0; $count<=6; $count++) {
    $week = ($count == 1)?($week + 1): ($week);
    $week = str_pad($week,2,'0',STR_PAD_LEFT);
    echo date('d m Y', strtotime($year."W".$week.($dayrange[$count]))); } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-03T19:11:51.437

我有同样的问题，只使用 strftime 而不是日期作为我的起点，即使用 %WI 从 strftime 导出周数想知道该周的日期范围 - 周一到周日（或实际上任何起始日）。对几个类似帖子的评论，特别是尝试了上述几种方法并没有让我得到我想要的解决方案。当然，我可能误解了一些东西，但我无法得到我想要的东西。

因此，我想分享我的解决方案。

我的第一个想法是，鉴于 strftime %W 的描述是：

> 当年的周数，从第一个星期一开始作为第一周的第一天

如果我确定每年的第一个星期一是什么，我可以计算一个日期范围数组，其索引等于 %W 的值。此后我可以使用 strftime 调用该函数。

所以这里是：

功能：

```
<?php

/*
 *  function to establish scope of week given a week of the year value returned from strftime %W
 */

// note strftime %W reports 1/1/YYYY as wk 00 unless 1/1/YYYY is a monday when it reports wk 01
// note strtotime Monday [last, this, next] week - runs sun - sat

function date_Range_For_Week($W,$Y){

// where $W = %W returned from strftime
//       $Y = %Y returned from strftime

    // establish 1st day of 1/1/YYYY

    $first_Day_Of_Year = mktime(0,0,0,1,1,$Y);

    // establish the first monday of year after 1/1/YYYY    

    $first_Monday_Of_Year = strtotime("Monday this week",(mktime(0,0,0,1,1,$Y)));   

    // Check for week 00 advance first monday if found
    // We could use strtotime "Monday next week" or add 604800 seconds to find next monday
    // I have decided to avoid any potential strtotime overhead and do the arthimetic

    if (strftime("%W",$first_Monday_Of_Year) != "01"){
        $first_Monday_Of_Year += (60 * 60 * 24 * 7);
    }

    // create array to ranges for the year. Note 52 wks is the norm but it is possible to have 54 weeks
    // in a given yr therefore allow for this in array index

    $week_Start = array();
    $week_End = array();        

    for($i=0;$i<=53;$i++){

        if ($i == 0){   
            if ($first_Day_Of_Year != $first_Monday_Of_Year){
                $week_Start[$i] = $first_Day_Of_Year;
                $week_End[$i] = $first_Monday_Of_Year - (60 * 60 * 24 * 1);
            } else {
                // %W returns no week 00
                $week_Start[$i] = 0;
                $week_End[$i] = 0;                              
            }
            $current_Monday = $first_Monday_Of_Year;
        } else {
            $week_Start[$i] = $current_Monday;
            $week_End[$i] = $current_Monday + (60 * 60 * 24 * 6);
            // find next monday
            $current_Monday += (60 * 60 * 24 * 7);
            // test for end of year
            if (strftime("%W",$current_Monday) == "01"){ $i = 999; };
        }
    };

    $result = array("start" => strftime("%a on %d, %b, %Y", $week_Start[$W]), "end" => strftime("%a on %d, %b, %Y", $week_End[$W]));

    return $result;

    }   

?> 
```

例子：

```
// usage example

//assume we wish to find the date range of a week for a given date July 12th 2011

$Y = strftime("%Y",mktime(0,0,0,7,12,2011));
$W = strftime("%W",mktime(0,0,0,7,12,2011));

// use dynamic array variable to check if we have range if so get result if not run function

$date_Range = date_Range . "$Y";

isset(${$date_Range}) ? null : ${$date_Range} = date_Range_For_Week($W, $Y);

echo "Date sought: " . strftime(" was %a on %b %d, %Y, %X time zone: %Z",mktime(0,0,0,7,12,2011)) . "<br/>";
echo "start of week " . $W . " is " . ${$date_Range}["start"] . "<br/>";
echo "end of week " . $W . " is " . ${$date_Range}["end"]; 
```

输出：

```
> Date sought: was Tue on Jul 12, 2011, 00:00:00 time zone: GMT Daylight
> Time start of week 28 is Mon on 11, Jul, 2011 end of week 28 is Sun on
> 17, Jul, 2011 
```

我已经测试了几年，包括 2018 年，即 2018 年 1 月 1 日 = 星期一的下一年。到目前为止，似乎提供了正确的日期范围。

所以我希望这会有所帮助。

问候

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-31T08:21:35.337

另一种解决方案：

```
//$date Date in week
//$start Week start (out)
//$end Week end (out)

function week_bounds($date, &$start, &$end) {
    $date = strtotime($date);
    $start = $date;
    while( date('w', $start)>1 ) {
        $start -= 86400;
    }
    $end = date('Y-m-d', $start + (6*86400) );
    $start = date('Y-m-d', $start);
} 
```

例子：

```
week_bounds("2014/02/10", $start, $end);
echo $start."<br>".$end; 
```

出去：

```
2014-02-10
2014-02-16 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-11-16T18:08:30.227

```
$year      = 2016; //enter the year
$wk_number = 46;   //enter the weak nr

$start = new DateTime($year.'-01-01 00:00:00');
$end   = new DateTime($year.'-12-31 00:00:00');

$start_date = $start->format('Y-m-d H:i:s');

$output[0]= $start;    
$end   = $end->format('U');    
$x = 1;

//create array full of data objects
for($i=0;;$i++){
    if($i == intval(date('z',$end)) || $i === 365){
        break;
    }
    $a = new DateTime($start_date);
    $b = $a->modify('+1 day');
    $output[$x]= $a;        
    $start_date = $b->format('Y-m-d H:i:s');
    $x++;
}    

//create a object to use
for($i=0;$i<count($output);$i++){
    if(intval ($output[$i]->format('W')) === $wk_number){
        $output_[$output[$i]->format('N')]        = $output[$i];
    }
}

$dayNumberOfWeek = 1; //enter the desired day in 1 = Mon -> 7 = Sun

echo '<pre>';
print_r($output_[$dayNumberOfWeek]->format('Y-m-d'));
echo '</pre>'; 
```

用作来自 php [日期 php的 date() 对象](http://php.net/manual/en/function.date.php)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-02-03T11:39:22.297

**基于周数和天数的周期**

一些国家（如斯堪的纳维亚国家和德国）使用周数，作为预订假期、会议等的实用方式。此功能可以根据周数开始日期和周期长度（以天为单位）发送有关周期的文本消息。

```
function MakePeriod($year,$Week,$StartDay,$NumberOfDays, $lan='DK'){
    //Please note that start dates in january of week 53 must be entered as "the year before"
    switch($lan){
    case "NO":
        $WeekDays=['mandag','tirsdag','onsdag','torsdag','fredag','lørdag','søndag'];
        $the=" den ";
        $weekName="Uke ";
        $dateformat="j/n Y";
    break;      
    case "DK":
        $WeekDays=['mandag','tirsdag','onsdag','torsdag','fredag','lørdag','søndag'];
        $the=" den ";
        $weekName="Uge ";
        $dateformat="j/n Y";
    break;
    case "SV":
        $WeekDays=['måndag','tisdag','onsdag','torsdag','fredag','lördag','söndag'];
        $the=" den ";
        $weekName="Vecka ";
        $dateformat="j/n Y";
    break;
    case "GE":
        $WeekDays=['Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag','Sonntag'];
        $the=" die ";
        $weekName="Woche ";
        $dateformat="j/n Y";
    break;
    case "EN":
    case "US":  
        $WeekDays=['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday'];
        $the=" the ";
        $weekName="Week ";
        $dateformat="n/j/Y";
    break;  
    }   
    $EndDay= (($StartDay-1+$NumberOfDays) % 7)+1;
    $ExtraDays= $NumberOfDays % 7;
    $FirstWeek=$Week;
    $LastWeek=$Week;    
    $NumberOfWeeks=floor($NumberOfDays / 7) ;
    $LastWeek=$Week+$NumberOfWeeks;

    if($StartDay+$ExtraDays>7){
        $LastWeek++;
    }       

    if($FirstWeek<10) $FirstWeek='0'.$FirstWeek;
    if($LastWeek<10) $LastWeek='0'.$LastWeek;

    $date1 = date( $dateformat, strtotime($year."W".$FirstWeek.$StartDay) ); // First day of week

    $date2 = date( $dateformat, strtotime($year."W".$LastWeek.$EndDay) ); // Last day of week

    if($LastWeek>53){
        $LastWeek=$LastWeek-53;
        $year++;
        if($LastWeek<10) $LastWeek='0'.$LastWeek;
        $date2 = date( $dateformat, strtotime($year."W".$LastWeek.$EndDay) );
    }
    $EndDayName=$WeekDays[$EndDay-1];
    $StartDayName=$WeekDays[$StartDay-1];
    $retval= " $weekName $Week $StartDayName  $the $date1 - $EndDayName $the $date2 ";
    return $retval;     

} 
```

测试：

```
$Year=2021;
$Week=22;   
$StartDay=4;    
$NumberOfDays=3;
$Period=MakePeriod($Year,$Week,$StartDay,$NumberOfDays,"DK");
echo $Period; 
```

Uge 22 torsdag den 3/6 2021 - søndag den 6/6 2021

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2014-02-19T11:16:13.580

```
 <?php
    $iWeeksAgo = 5;// need weeks ago
    $sWeekDayStartOn = 0;// 0 - Sunday, 1 - Monday, 2 - Tuesday
    $aWeeksDetails = getWeekDetails($iWeeksAgo, $sWeekDayStartOn);

    print_r($aWeeksDetails);
    die('end of line of getWeekDetails ');

    function getWeekDetails($iWeeksAgo, $sWeekDayStartOn){
        $date = new DateTime();
        $sCurrentDate = $date->format('W, Y-m-d, w');
        #echo 'Current Date (Week of the year, YYYY-MM-DD, day of week ): ' . $sCurrentDate . "\n";

        $iWeekOfTheYear = $date->format('W');// Week of the Year i.e. 19-Feb-2014 = 08
        $iDayOfWeek = $date->format('w');// day of week for the current month i.e. 19-Feb-2014 = 4
        $iDayOfMonth = $date->format('d'); // date of the month i.e. 19-Feb-2014 = 19

        $iNoDaysAdd = 6;// number of days adding to get last date of the week i.e. 19-Feb-2014  + 6 days = 25-Feb-2014

        $date->sub(new DateInterval("P{$iDayOfWeek}D"));// getting start date of the week
        $sStartDateOfWeek = $date->format('Y-m-d');// getting start date of the week

        $date->add(new DateInterval("P{$iNoDaysAdd}D"));// getting end date of the week
        $sEndDateOfWeek = $date->format('Y-m-d');// getting end date of the week

        $iWeekOfTheYearWeek = (string) $date->format('YW');//week of the year
        $iWeekOfTheYearWeekWithPeriod = (string) $date->format('Y-W');//week of the year with year

        //To check uncomment
        #echo "Start Date / End Date of Current week($iWeekOfTheYearWeek), week with - ($iWeekOfTheYearWeekWithPeriod) : " . $sStartDateOfWeek . ',' . $sEndDateOfWeek . "\n";

        $iDaysAgo = ($iWeeksAgo*7) + $iNoDaysAdd + $sWeekDayStartOn;// getting 4 weeks ago i.e. no. of days to substract

        $date->sub(new DateInterval("P{$iDaysAgo}D"));// getting 4 weeks ago i.e. no. of days to substract
        $sStartDateOfWeekAgo = $date->format('Y-m-d');// getting 4 weeks ago start date i.e. 19-Jan-2014

        $date->add(new DateInterval("P{$iNoDaysAdd}D")); // getting 4 weeks ago end date i.e. 25-Jan-2014
        $sEndDateOfWeekAgo = $date->format('Y-m-d');// getting 4 weeks ago start date i.e. 25-Jan-2014

        $iProccessedWeekAgoOfTheYear = (string) $date->format('YW');//ago week of the year
        $iProccessedWeekOfTheYearWeekAgo = (string) $date->format('YW');//ago week of the year with year
        $iProccessedWeekOfTheYearWeekWithPeriodAgo = (string) $date->format('Y-W');//ago week of the year with year

        //To check uncomment
        #echo "Start Date / End Date of week($iProccessedWeekOfTheYearWeekAgo), week with - ($iProccessedWeekOfTheYearWeekWithPeriodAgo) ago: " . $sStartDateOfWeekAgo . ',' . $sEndDateOfWeekAgo . "\n";

        $aWeeksDetails = array ('weeksago' => $iWeeksAgo, 'currentweek' => $iWeekOfTheYear, 'currentdate' => $sCurrentDate, 'startdateofcurrentweek' => $sStartDateOfWeek,  'enddateofcurrentweek' => $sEndDateOfWeek,
                                'weekagoyearweek' => $iProccessedWeekAgoOfTheYear, 'startdateofagoweek' => $sStartDateOfWeekAgo,  'enddateofagoweek' => $sEndDateOfWeekAgo);

        return $aWeeksDetails;
    }
?> 
```

# sql-server - 哪些选项可用于从 Oracle 数据库连接到 Microsoft SQL Server 数据库？

> ID：186443
> 
> 赞同：1
> 
> 时间：2008-10-09T08:45:55.703
> 
> 标签：sql-server, oracle, jdbc, tnsnames

目前，我使用定制的 JDBC 连接器从远程 MS SQL Server 数据库中提取数据。这工作正常，但感觉不像这样做的方式。

我觉得我应该能够将 JDBC 连接字符串放入服务器上的 tnsnames 并让它“正常工作”。我已经四处寻找这个功能，但它似乎不存在。

通过这种方式，我可以仅使用数据库链接连接到几乎任何数据库。

我错过了什么吗？

* * *

看起来这两个选项是通用连接和 Oracle 网关，但我很惊讶这就是全部。Generic Connectivity 附带数据库许可证，Oracle Gateways 是一个附加组件。对于通用连接，如果您在 Linux（如我）上运行，则需要获取 ODBC 驱动程序，因为它没有与数据库捆绑在一起。

但是...由于 Oracle 是 Java 的狂热爱好者，并且数据库中内置了 JVM，我原以为基于 JDBC 的链接技术将是一件轻而易举的事。在 TNSNAMES 中有一个 JDBC 连接字符串似乎是一个自然的扩展，一切都会“正常工作”。

有人知道为什么这不可用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T11:23:04.403

[通用连接](http://www.oracle.com/pls/db102/search?remark=quick_search&word=Generic+Connectivity&tab_id=&format=ranked)是您所追求的，它可以让您针对 MS SQL Server 设置远程数据库链接，因此您可以执行以下查询

```
select * from mytable@my_ms_sql_server; 
```

我只在 Oracle 9i 中针对 mysql 使用过它，发现在我们的案例中，它运行得不是很好，因为它最终消耗了 MASSIVE 数量的 ram，我们仍然使用它，但现在只是将它用于同步到本地表，而不是对其进行“实时”查询。但是，它可能与 MS SQL Server 完全不同，在 10g/11g 中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T14:58:25.093

另一个值得关注的产品是 Oracle 网关。

看一下：

[http://www.oracle.com/technology/documentation/gateways10g.html](http://www.oracle.com/technology/documentation/gateways10g.html)

# javascript - What is the best practice to use ExtJS with Asp.net and WCF in .NET 3.5?

> ID：186456
> 
> 赞同：2
> 
> 时间：2008-10-09T08:56:26.197
> 
> 标签：javascript, asp.net-ajax, extjs

How do you save data from ExtJS form? Load data from the business layer into form or grid?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-12T05:05:57.803

For me, I have used an ASHX page to push straight XML - and then use the ExtJS data reader to read.. then, say using a form etc, I push the form data straight back to another ASHX page to interrogate/post to the DB.. darned if I know the best way - but it suited me, and seems very quick and stable, and most importantly it is easier to follow/debug.

Here is some code example if it helps... hopefully not to hinder!

## GETTING DATA

As you will see, the URL to get the data is getting a simple ASHX (generic handler) .NET page which will return straight XML...

```
 // Define the core service page to get the data (we use this when reloading)
    var url = '/pagedata/getbizzbox.ashx?duration=today';

    var store = new Ext.data.GroupingStore(
    {
        //  Define the source for the bizzbox grid (see above url def). We can pass (via the slider)
        //  the days param as necessary to reload the grid
        url: url,

        //  Define an XML reader to read /pagedata/getbizzbox.ashx XML results
        reader: new Ext.data.XmlReader(
        {
            //  Define the RECORD node (i.e. in the XML <record> is the main row definition), and we also
            //  need to define what field is the ID (row index), and what node returns the total records count
            record: 'record',
            id: 'inboxID',
            totalRecords: 'totalrecords'
        },
            //  Setup mapping of the fields                         
        ['inboxID', 'messageCreated', 'subject', 'message', 'messageOpened', 'messageFrom', 'messageFromID', 'groupedMessageDate']),

        //  Set the default sort scenario, and which column will be grouped
        sortInfo: { field: 'groupedMessageDate', direction: "DESC" },
        groupField: 'groupedMessageDate'

    }); // end of Ext.data.store 
```

## DATA TO THE EXTJS GRID

Ok, I have some extra code here that creates a toolbar in the top part of the grid which you can ignore...

```
 var grid = new Ext.grid.GridPanel(
    {
        // Define the store we are going to use - i.e. from above definition
        store: store,

        // Define column structs

        // { header: "Received", width: 180, dataIndex: 'messageCreated', sortable: true, renderer: Ext.util.Format.dateRenderer('d-M-Y'), dataIndex: 'messageCreated' },

        columns: [
            { header: "ID", width: 120, dataIndex: 'inboxID', hidden: true },
            { header: "Received", width: 180, dataIndex: 'messageCreated', sortable: true },
            { header: "Subject", width: 115, dataIndex: 'subject', sortable: false },
            { header: "Opened", width: 100, dataIndex: 'messageOpened', hidden: true, renderer: checkOpened },
            { header: "From", width: 100, dataIndex: 'messageFrom', sortable: true },
            { header: "FromID", width: 100, dataIndex: 'messageFromID', hidden: true },
            { header: "Received", width: 100, dataIndex: 'groupedMessageDate', hidden: true }
        ],

        //  Set the row selection model to use
        gridRowModel: new Ext.grid.RowSelectionModel({ singleSelect: true }),

        // Set the grouping configuration
        view: new Ext.grid.GroupingView(
        {
            forceFit: true,
            groupTextTpl: '{text} ({[values.rs.length]} {[values.rs.length > 1 ? "Messages" : "Message"]})'
        }),

        // Render the grid with sizing/title etc
        frame: true,
        collapsible: false,
        title: 'BizzBox',
        iconCls: 'icon-grid',
        renderTo: 'bizzbox',
        width: 660,
        height: 500,
        stripeRows: true,

        //  Setup the top bar within the message grid - this hosts the various buttons we need to create a new
        //  message, delete etc
        tbar: [

            //  New button pressed - show the NEW WINDOW to allow a new message be created
            {
                text: 'New',
                handler: function()
                {
                    //  We need to load the contacts, howver we only load the contacts ONCE to save
                    //  bandwidth - if new contacts are added, this page would have been destroyed anyway.
                    if(contactsLoaded==false)
                    {
                        contactStore.load();
                        contactsLoaded=true;
                    }
                    winNew.show();
                }
            },

            //  Delete button pressed
            //  We need to confirm deletion, then get the ID of the message to physically delete from DB and grid
            {
                text: 'Delete', handler: function() 
                {
                    Ext.MessageBox.confirm('Delete message', 'are you sure you wish to delete this message?', function(btn) {

                    //  If selected YES, get a handle to the row, and delete
                    if (btn == 'yes') 
                    {
                        //  Get the selected row
                        var rec = grid.getSelectionModel().getSelected();
                        if(rec==null)
                        {
                            Ext.Msg.show(
                            {
                               title:'No message selected',
                               msg: 'please ensure you select a message by clicking once on the required message before selecting delete',
                               buttons: Ext.Msg.OK,
                               icon: Ext.MessageBox.QUESTION
                            });
                        }

                        //  Proceed to delete the selected message
                        else
                        {
                            var mesID = rec.get('inboxID');

                            //  AJAX call to delete the message
                            Ext.Ajax.request(
                            {
                                url: '/postdata/bizzbox_message_delete.ashx',
                                params: { inboxID: mesID },

                                //  Check any call failures
                                failure: function() 
                                {
                                    Ext.Msg.show(
                                    {
                                        title: 'An error has occured',
                                        msg: 'Having a problem deleting.. please try again later',
                                        buttons: Ext.Msg.OK,
                                        icon: Ext.MessageBox.ERROR
                                    })
                                }, // end of failure check

                                //  Success check
                                success: function()
                                {
                                    //  Need to remove the row from the datastore (which doesn't imapct
                                    //  a reload of the data)
                                    store.remove(rec);
                                }
                            }); // end if delete ajax call

                        } // end of ELSE for record selected or not

                    } // end of YES button click
                })
            } // end of delete button pressed
        }] // end of tbar (toolbar def)

    }); // end of grid def 
```

## POSTING DATA FROM A FORM TO THE BACKEND

Again, note the url in the first part of the definition.. going to send the posted form data back to another ASHX page to then send to the DB...

```
 //  ---------------------------------------------------------------------------------------------
        //  DEFINE THE REPLY FORM
        //  This is used to show the existing message details, and allows the user to respond
        //  ---------------------------------------------------------------------------------------------
        var frmReply = new Ext.form.FormPanel(
        {
            baseCls: 'x-plain',
            labelWidth: 55,
            method: 'POST',
            url: '/postdata/bizzbox_message_reply.ashx',

            items: [
            {
                xtype: 'textfield',
                readOnly: true,
                fieldLabel: 'From',
                name: 'messageFrom',
                value: selectedRow.get('messageFrom'),
                anchor: '100%'  // anchor width by percentage
            },
            {
                xtype: 'textfield',
                readOnly: true,
                fieldLabel: 'Sent',
                name: 'messageCreated',
                value: selectedRow.get('messageCreated'),
                anchor: '100%'  // anchor width by percentage
            },
            {
                xtype: 'textarea',
                selectOnFocus: false,
                hideLabel: true,
                name: 'msg',
                value: replyMessage,
                anchor: '100% -53'  // anchor width by percentage and height by raw adjustment
            },

            //  The next couple of fields are hidden, but provide FROM ID etc which we need to post a new/reply
            //  message to
            {
                xtype: 'textfield',
                readOnly: true,
                fieldLabel: 'subject',
                name: 'subject',
                hidden: true,
                hideLabel: true,
                value: selectedRow.get('subject')
            },
            {
                xtype: 'textfield',
                readOnly: true,
                fieldLabel: 'FromID',
                name: 'messageFromID',
                hidden: true,
                hideLabel: true,
                value: selectedRow.get('messageFromID')
            },
            {
                xtype: 'textfield',
                readOnly: true,
                fieldLabel: 'InboxID',
                name: 'inboxID',
                hidden: true,
                hideLabel: true,
                value: selectedRow.get('inboxID')
            }]
        });  // end of frmReply 
```

## THE LAST BIT TO ACTUALLY SUMBIT THE ABOVE FORM TO THE BACKEND...

This window uses the form definition above to actually submit the data.. in the ASHX page the data simply comes through as a posted form - i.e. you can access via normal Request.form object.. I know there is a way to essentially post the form data to the ASHX page as XML, although for my purpose it wasn't required - quite simple form.

```
 //  ---------------------------------------------------------------------------------------------
        //  REPLY WINDOW - uses the frmReply as defined previously on stargate atlantis
        //  ---------------------------------------------------------------------------------------------
        var win = new Ext.Window(
        {
            title: selectedRow.get("subject"),
            width: 500,
            height: 300,
            minWidth: 300,
            minHeight: 200,
            layout: 'fit',
            plain: false,
            bodyStyle: 'padding:5px;',
            buttonAlign: 'right',
            items: frmReply,

            //  Add the action buttons for the message form
            buttons: [
            {
                //  When the user replies, we send the form results to the posting ashx which updates
                //  the DB etc, and returns the result
                text: 'reply',
                handler: function()
                {
                    frmReply.getForm().submit({ waitMsg: 'Sending your message now...' });
                }
            },
            {
                text: 'close',
                handler: function()
                {
                    //  We need to close the message window
                    win.close();
                }
            }]
        });

        //  Show the message detail window                      
        win.show(); 
```

Again, hope this helps somewhat - took me a few weeks to get to that!! getting too old for coding perhaps!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-27T21:14:01.743

We used the combination of ExtJS and WCF to great success. We used regular Asp.net page to provide theming, authentication and basic page UI then ExtJS kicked in on the client side issuing GETs to WCF services that returned pure simple bare format JSON (without the "d" property). Worked really great. WCF services were also part of the same web application so user authentication/authorisation was used throughout it.

The only problems we had were with pages returning files and pages that used a combination of both: Ajax and regular Asp.net postbacks. We had to take care of ExtJS control persistence on those roundtrips. But we've made it anyway.

ExtJS+WCF worked great and I'd recommend it to anyone doing a web application that has to be more window app like. Just don't overcomplicate your project with regular asp.net page functionality and Ajax combination. Or UpdatePanels as well.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T09:04:23.827

I used ExtJs in conjuction with ASP.NET only through web services. It works just fine if you are willing to work without "Page" and all that stuff.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T02:21:33.937

[http://extjs.com/forum/showthread.php?t=48921](http://extjs.com/forum/showthread.php?t=48921)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T17:19:20.070

Most likely I found the best solution [http://developmentalmadness.blogspot.com/2008/07/using-extjs-with-wcf.html](http://developmentalmadness.blogspot.com/2008/07/using-extjs-with-wcf.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-08T05:43:58.413

If you interest to develop Extjs with java by gwt you can learn more at this extjs-gwt gxt blog. It maybe help you [How to setup Ext js-GWT : GXT and Example on Eclipse Ganymede 3.4](http://extjs-gwt.blogspot.com/)

# firefox - 您是否注意到没有参数的网页的杂散点击？

> ID：186467
> 
> 赞同：2
> 
> 时间：2008-10-09T09:01:47.543
> 
> 标签：firefox, ssl, parameters, browser, get

我们有一个 Web 应用程序，它在 url 中传递参数，如下所示：

```
www.example.com/ViewCustomer?customer=3945 
```

合理地经常，我们会看到尝试访问：

```
www.example.com/ViewCustomer 
```

或者系统将此记录为无效并发回“发生错误，请联系支持人员，跟踪号为 XXX”类型页面。

我们的日志包含会话信息，因此它实际上是使用有效会话登录的人，这意味着他们已使用用户名和密码成功登录。

可能是他们只是在地址栏中输入了该内容，但这种情况似乎发生得太频繁了。另一种选择是我们的代码中有一个错误，但我们已经调查过，有时只有一个地方，这显然是可以的。我们从未有过用户抱怨某些东西不起作用并导致这种情况。一切都在 SSL 之下。

有没有其他人经历过这个？某些浏览器是否偶尔会发送这些狡猾的请求？

编辑：我们的日志显示：

```
 user-agent = Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T09:05:20.657

您的日志是否包含推荐人信息？如果存在任何信息，那么它可能有助于查明错误。如果没有，则可能表示“编辑 URL”尝试。（诚​​然，我不知道 SSL 会改变多少。）

浏览器有时会[预取链接](http://en.wikipedia.org/wiki/Link_prefetching)，但我不知道他们是否会摆脱该参数——而且他们似乎不太可能为 HTTPS 这样做。

您对这些请求使用哪些浏览器有一个模式吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-15T20:01:49.227

我已经在我们支持的 Web 应用程序中看到了这一点 - 一个已经登录的用户突然出现的杂散 GET 请求，破坏了服务器端状态并导致后续合法 POST 请求出错。

由于在我们的例子中，URL 使用 URL 重写将 sessionid 附加到 URL，因此 GET 有时也会有旧的 sessionid。

在导致解决此问题的特定日志文件中，这些杂散请求的代理字符串与同一会话中的其他请求不同（尽管有效）。

我相信不是浏览器本身，而是一些插件/扩展。代理可能会执行此操作，甚至是恶意软件。

我们通过禁止对相关 URI 的 GET 请求来克服这个特殊问题。

但是，现在我正在处理一个类似的问题，即 POST 请求突然出现在它不应该出现的地方，唯一的区别在于“接受”标头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-22T00:01:50.943

我现在认为这实际上是一个 tomcat 错误[getParameter() 在 POST 上使用 transfer-encoding: chunked 失败](https://issues.apache.org/bugzilla/show_bug.cgi?id=37794)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T10:32:31.013

检查您的日志中的代理字符串，并查看这些请求是否由搜索引擎蜘蛛发出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T10:44:14.280

我知道我有时会删除参数只是为了检查那里有什么。我确定我不是唯一一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T06:11:40.413

一些流氓爬虫将用户代理更改为浏览器的用户代理并爬取页面。这也可能是这样一种情况。

此外，大多数爬虫确实会尝试将其他一些值替换为查询参数以获取未链接的页面。

# python - 'from X import a' 与 'import X; Xa'

> ID：186472
> 
> 赞同：9
> 
> 时间：2008-10-09T09:04:34.217
> 
> 标签：python, python-import, maintainability, duck-typing

我见过一些 Python 程序员相当一致地使用以下风格（我们称之为风格 1）：

```
import some_module
# Use some_module.some_identifier in various places. 
```

为了支持这种风格，您可以引用[“显式优于隐式”](http://www.python.org/dev/peps/pep-0020/)的格言。我见过其他程序员使用这种风格（风格 2）：

```
from some_module import some_identifier
# Use some_identifier in various places. 
```

我在样式 2 中看到的主要好处是可维护性——尤其是对于[鸭子类型](http://en.wikipedia.org/wiki/Duck_typing)的理想，我可能想将 some_module 换成 some_other_module。[我也觉得风格 2 以“可读性很重要”](http://www.python.org/dev/peps/pep-0020/)的格言赢得了积分。尽管我倾向于不同意，但人们总是可以争辩说，在使用第一种样式时，搜索和替换同样是一个不错的选择。

**附录：**有人指出，您可以使用样式 1`as`来解决从`some_module`to的切换`some_other_module`。我忘了提到，决定`some_identifier`在*当前*模块中实现也很常见，这使得创建等效`some_module`容器有点尴尬。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T09:08:22.150

存在以下语法：

```
import some_other_module as some_module 
```

样式 2 的可维护性论点不再相关。

我倾向于使用样式 1。通常，我发现在典型的 Python 程序中我只显式引用了几次导入的包名称。其他都是对象上的方法，当然不需要引用导入的包。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T11:24:46.773

这两种情况都有用，所以我不认为这是一个非此即彼的问题。在以下情况下，我会考虑使用 from 模块`import x,y,z`：

*   要导入的东西很少

*   与模块名称分离时，导入函数的目的是显而易见的。如果名称相当通用，它们可能会与其他名称发生冲突，并且几乎不会告诉您什么。例如。看到`remove`告诉你很少，但`os.remove`可能会暗示你正在处理文件。

*   名字不冲突。与上述类似，但更重要。 **永远不要**做类似的事情：

    ```
     from os import open 
    ```

`import module [as renamed_module]`优点是它提供了更多关于使用它时所调用内容的上下文。它的缺点是，当模块没有真正提供更多信息时，这有点混乱，并且性能略低（2 次查找而不是 1 次）。

然而，它在测试时也有优势（例如，用模拟对象替换 os.open，而不必更改每个模块），并且应该在使用可变模块时使用，例如

```
import config
config.dburl = 'sqlite:///test.db' 
```

如果有疑问，我总是会选择这种`import module`风格。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T09:09:49.230

我通常使用阈值来决定这一点。如果我想在 中使用很多东西`some_module`，我会使用：

```
import some_module as sm
x = sm.whatever 
```

如果我只需要一两件事：

```
from some_module import whatever
x = whatever 
```

当然，这是假设我不需要`whatever`from `some_other_module`。

我倾向于`as`在导入时使用该子句，以便将来可以轻松地减少输入**并**替换另一个模块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T10:13:42.563

我更喜欢`import X`然后`X.a`尽可能多地使用。

我的异常集中在像 Django 这样的大框架中的深层嵌套模块上。他们的模块名称往往会变得很长，而且他们的示例都说`from django.conf import settings`可以节省您`django.conf.settings.DEBUG`在任何地方打字的时间。

如果模块名称嵌套很深，则例外是使用`from X.Y.Z import a`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T09:37:03.370

我发现符号

```
from some_module import some_symbol 
```

在大多数情况下效果最好。此外，如果符号名称冲突，您可以使用：

```
from some_module import some_symbol as other_symbol 
```

正如问题所述，它避免了一直重写模块名称，每次都有输入错误的风险。我使用以下语法：

```
import  module [as other_module] 
```

仅在两种情况下：

1.  我使用了太多的模块函数/对象来全部导入
2.  模块定义了一些在执行过程中可能会改变的符号

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T09:10:18.387

我相信更新版本的 Python（2.5+？必须检查我的事实......）你甚至可以这样做：

```
import some_other_module as some_module 
```

因此，您仍然可以使用样式 1 并稍后换入不同的模块。

我认为它通常映射到你想要多少混乱你的命名空间。您会在模块中只使用一两个名称吗？或者所有这些（`from x import *`并不总是坏的，只是一般来说）？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T10:16:30.950

我个人尽量不要把我的命名空间搞得太乱，所以在大多数情况下我只是这样做

```
import module 
```

或将模块导入为 mod

唯一真正的区别是当我有一个带有一个经常使用的类的模块时。如果我对一个`list`类型进行了子类化以在那里添加一些功能，我会使用

```
from SuperImprovedListOverloadedWithFeatures import NewLIst
nl = NewList() 
```

等等

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T13:54:15.847

我倾向于只使用每个模块的几个成员，所以有很多

```
from john import cleese
from terry import jones, gilliam 
```

在我的代码中。如果我希望使用大部分模块并且模块名称很短，我将导入整个模块（例如`os`或）。`wx`如果存在名称冲突或者我想提醒读者该函数与什么相关联，我还将导入整个模块。

```
import michael
import sarah

import wave

gov_speech = wave.open(sarah.palin.speechfile)
parrot_sketch = wave.open(michael.palin.justresting) 
```

（我可以使用`from wave import open as wave_open`，但我认为这`wave.open`对读者来说会更熟悉。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-17T12:58:47.533

您可能对 Stack Overflow 问题感兴趣，*[为什么 'import x;xy' 的行为与 'from x import y' 不同，第一个在 package x 时失败。**init**没有完成？](https://stackoverflow.com/questions/6386061)*.

# c# - 使用代码删除 WPF 中的绑定

> ID：186475
> 
> 赞同：60
> 
> 时间：2008-10-09T09:05:28.660
> 
> 标签：c#, wpf

在 TextBox 中显示数据时，我想使用数据绑定。我基本上是这样做的：

```
 public void ShowRandomObject(IRandomObject randomObject) {
        Binding binding = new Binding {Source = randomObject, Path = new PropertyPath("Name")};
        txtName.SetBinding(TextBox.TextProperty, binding);
    } 
```

我似乎找不到解除绑定的方法。我将使用许多不同的对象调用此方法，但 TextBox 将保持不变。有没有办法删除以前的绑定，还是在我设置新绑定时自动完成？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-10-09T15:49:36.363

交替：

```
BindingOperations.ClearBinding(txtName, TextBox.TextProperty) 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2008-10-09T09:07:20.653

有空的时候

```
BindingOperations.ClearBinding(txtName, TextBox.TextProperty) 
```

对于较旧的 SilverLight 版本，但不可靠，如评论中所述：

```
txtName.SetBinding(TextBox.TextProperty, null); 
```

启用 C# 6.0 功能

```
this.btnFinish.ClearBinding(ButtonBase.CommandProperty); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-09T11:44:40.023

怎么样：

```
this.ClearValue(TextBox.TextProperty); 
```

我认为它更清洁；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-04T10:09:08.077

刚刚怎么样

```
txtName.Text = txtName.Text; 
```

无论如何，您都必须在清除后设置该值。这至少在 SL4 中有效。

# .net - 在 C++/CLI 中，如何声明和调用带有“out”参数的函数？

> ID：186477
> 
> 赞同：49
> 
> 时间：2008-10-09T09:06:34.460
> 
> 标签：.net, c++-cli, pass-by-reference

我有一个函数可以将一个字符串解析为两个字符串。在 C# 中，我会这样声明：

```
void ParseQuery(string toParse, out string search, out string sort)
{
    ...
} 
```

我会这样称呼它：

```
string searchOutput, sortOutput;
ParseQuery(userInput, out searchOutput, out sortOutput); 
```

当前项目必须在 C++/CLI 中完成。我试过了

```
using System::Runtime::InteropServices;

...

void ParseQuery(String ^ toParse, [Out] String^ search, [Out] String^ sort)
{
    ...
} 
```

但如果我这样称呼它：

```
String ^ searchOutput, ^ sortOutput;
ParseQuery(userInput, [Out] searchOutput, [Out] sortOutput); 
```

我得到一个编译器错误，如果我这样称呼它：

```
String ^ searchOutput, ^ sortOutput;
ParseQuery(userInput, searchOutput, sortOutput); 
```

然后我在运行时遇到错误。我应该如何声明和调用我的函数？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-10-09T14:43:27.603

C++/CLI 本身不支持真正的“输出”参数，但您可以将引用标记为输出参数，以使其他语言将其视为真正的输出参数。

您可以对引用类型执行此操作：

```
void ReturnString([Out] String^% value)
{
   value = "Returned via out parameter";
}

// Called as
String^ result;
ReturnString(result); 
```

对于值类型为：

```
void ReturnInt([Out] int% value)
{
   value = 32;
}

// Called as
int result;
ReturnInt(result); 
```

% 使其成为“ref”参数，OutAttribute 标记它仅用于输出值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-05-25T21:28:49.810

使用 Visual Studio 2008，这有效并解决了我工作中的一个主要问题。谢谢！

```
// header
// Use namespace for Out-attribute.
using namespace System::Runtime::InteropServices; 
namespace VHT_QMCLInterface {
   public ref class Client
   {
    public:
        Client();
        void ReturnInteger( int a, int b, [Out]int %c);
        void ReturnString( int a, int b, [Out]String^ %c);
   }
}

// cpp
namespace VHT_QMCLInterface {

    Client::Client()
    {

    }

    void Client::ReturnInteger( int a, int b, [Out]int %c)
    {
        c = a + b;
    }
    void Client::ReturnString( int a, int b, [Out]String^ %c)
    {
        c = String::Format( "{0}", a + b);
    }
}

// cs
namespace TestQMCLInterface
{
    class Program
    {
        VHT_QMCLInterface.Client m_Client = new VHT_QMCLInterface.Client();
        static void Main(string[] args)
        {
            Program l_Program = new Program();
            l_Program.DoReturnInt();
            l_Program.DoReturnString();
            Console.ReadKey();
        }

        void DoReturnInt()
        {
            int x = 10;
            int y = 20;
            int z = 0;
            m_Client.ReturnInteger( x, y, out z);
            Console.WriteLine("\nReturnInteger: {0} + {1} = {2}", x, y, z);
        }

        void DoReturnString()
        {
            int x = 10;
            int y = 20;
            String z = "xxxx";
            m_Client.ReturnString(x, y, out z);
            Console.WriteLine("\nReturnString: {0} + {1} = '{2}'", x, y, z);
        }
     }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-09T09:18:49.930

不支持。你能得到的最接近的是 ref

当然，您可以伪造它，但是您会丢失编译时检查。

# c# - 如何编写 Mono 守护程序

> ID：186493
> 
> 赞同：52
> 
> 时间：2008-10-09T09:12:51.627
> 
> 标签：c#, linux, mono, daemon, mono-service

我正在尝试为 linux 编写一个 Mono C# 守护程序。

我想在它完成处理时启动和停止它，而不是仅仅终止进程。

有没有人有这方面的例子？

编辑：我想出了如何在 debian 中使用 start-stop-daemon --background，所以我想我现在就使用它。

编辑：我也在 java 中实现这个，他们有这个很好的 addShutdownHook 可以捕获终止应用程序。我需要花更多的时间来整理单声道服务的依赖关系，或者找到一种方法来捕获应用程序终止。

有 SessionEnd 事件，但这仅适用于服务而不是控制台应用程序

**答：** [在linux上使用mono-service封装一个windows服务](https://stackoverflow.com/questions/351971/using-mono-service-to-wrap-a-windows-service-on-linux)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-19T16:30:08.183

要以 Unix 方式接收通知，即使用信号，您希望对您计划接收的每个信号使用[Mono.Unix.UnixSignal](http://mapsbkp.geolives.com/monodoc/monodoc.ashx?link=T%3aMono.Unix.UnixSignal)，然后在信号数组上调用 UnixSignal.WaitAny ()。

* * *

您通常会在单独的线程上执行此操作。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-11T11:18:29.020

您应该实现一个服务并使用单一服务。谷歌它，你会发现几个例子。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-09T14:28:14.953

一个简单的方法是侦听（本地，高）端口并从管理客户端接收命令，就像 bind 一样。

一种更类似于 unix 的方法是使用[UnixSignal](http://docs.go-mono.com/index.aspx?link=T%3AMono.Unix.UnixSignal)[注册一个信号处理程序](http://www.jprl.com/Blog/archive/development/mono/2008/Feb-08.html)，并在接收到某个信号时正确关闭。请参阅[Mono 常见问题解答，“我可以在 Mono 中使用信号处理程序吗？”](http://www.mono-project.com/FAQ:_Technical) 警告和示例。

[lupus](https://stackoverflow.com/users/27051/lupus)找到了[mono-service](http://go-mono.com/docs/index.aspx?link=man%3Amono-service(1))[`ServiceProcess`](http://msdn.microsoft.com/en-us/library/system.serviceprocess.aspx) ，这是一个使用接口的托管进程。遗憾的是，这需要设置`MONO_DISABLE_SHM`，这会禁用 Mono 中的某些功能，尤其是跨进程 IPC 系统。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T14:41:58.887

Linux 下的守护进程通常会监听信号，例如 kill 信号，但还有其他一些允许它执行诸如软重启（在配置中回读）等操作。

通常，这伴随着 /etc/init.d 目录中的一个脚本，该脚本控制启动和停止此类守护程序。通常会在 /var/run 下创建一个 pid 文件，该文件保留进程 ID，以便脚本快速识别进程。

即使在为 Mono 编码时，您也会很好地了解您正在编码的环境，因为 Mono 进程或本机进程（例如，用 C 语言创建）或脚本之间没有区别。

戴夫

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T02:59:13.453

Miguel de Icaza 最近写了一篇关于新的[Mono C# 交互式 shell](http://www.mono-project.com/CsharpRepl "安装和使用 Mono C# 交互式 shell")，您应该能够很容易地对它进行守护进程。Miguel 有一篇[后续文章](http://tirania.org/blog/archive/2008/Sep-29.html)，其中包含一些源代码，展示了如何在其他 C# 应用程序中包含交互式 shell。它可以作为你的守护进程的一个很好的起点。

请注意，交互式 shell 需要 Mono 版本 2.2，该版本尚未发布。但是，该代码在[Mono 的 svn 存储库](http://www.mono-project.com/SVN "访问 Mono 的 svn 存储库")中可用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T03:27:28.797

David 是正确的，停止服务是通过 UNIX 信号完成的，您应该使用信号处理程序来捕获它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-20T12:24:15.780

作为替代方案，我使用 shell 脚本。它启动我的单声道应用程序，然后当我的应用程序退出（有意或无意）时，查看我的应用程序设置的任何返回信号。这可用于指示脚本复制更新、重新启动或退出。如果我的应用程序崩溃，则不会返回任何信号，因此脚本将重新启动我的应用程序并向我发送一封电子邮件，其中包含控制台输出的最后几行。

在 LINUX 中使用MONO[进行类似 Windows 的服务开发？](https://stackoverflow.com/questions/1221110/windows-like-services-development-in-linux-using-mono/1234761#1234761)

# c++ - if(str1==str2) 与 if(str1.length()==str2.length() && str1==str2)

> ID：186494
> 
> 赞同：2
> 
> 时间：2008-10-09T09:12:57.240
> 
> 标签：c++, performance, stl, stdstring

我在另一个人的代码中看到了第二个，我想这种长度比较是为了提高代码效率。它用于具有特定字典的脚本语言的解析器：单词长度为 4 到 24 个字母，平均为 7-8 个小写字母，字母表包括 26 个拉丁字母加上“@”、“$”和“_”。

长度比较用于转义 == 运算符处理 STL 字符串，这显然比简单的整数比较需要更多时间。但同时给定字典中的首字母分布比单词大小的分布更宽，因此比较字符串的两个首字母通常比字符串的大小更经常不同。这使得长度比较变得不必要。

我已经进行了一些测试，这就是我发现的：在测试两个随机字符串比较数百万次时，第二种方法要快得多，所以长度比较似乎很有帮助。但是在一个工作项目中，它在调试模式下运行得更慢，而在发布模式下运行速度不够快。

所以，我的问题是：为什么长度比较可以加快比较速度，为什么可以减慢速度？

UPD：我也不喜欢第二种方式，但我想这样做是有原因的，我想知道这是什么原因。

UPD2：说真的，问题不在于如何做到最好。在这种情况下，我什至不再使用 STL 字符串。难怪长度比较是不必要的和错误的等等。奇怪的是 - 它确实倾向于在某个测试中稍微好一点。这怎么可能？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-09T09:18:00.617

如果这很重要，请假设您的图书馆已经这样做了。除非它真的很重要，否则不要以这种方式弄乱你的代码进行微优化。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-09T11:17:25.447

## 短路何时有益

只有在以下情况下，短路优化才有帮助：

*   与完整测试的成本相比，比较的成本较低
*   比较通常会导致短路

在数学上，让 S 是短路条件的成本，F 是完全条件的成本，P 是发生短路的情况的百分比（完全条件不是必需的）。

原案（无短路）的平均成本为 F

短路优化的平均成本为 S + F * (1-P)

因此，如果优化要产生任何好处，则必须应用以下内容：

S + F * (1-P) < F

IE

S < F*P

## 字符串比较成本

你还写道：

*这显然比简单的整数比较需要更多时间。*

这一点都不明显。字符串比较在找到第一个差异时终止，因此根据您处理的字符串，在绝大多数情况下，它可能会在第一个或第二个字符处终止。此外，只要两个字符串中都有足够的数据，通过首先比较 DWORDS（一次 4 个字符），甚至可以针对较长的字符串优化比较。

## 你的情况

随机测试数据和脚本解析之间的主要区别在于真实数据远非随机。解析器很可能是确定性的，一旦匹配，它就不再进行比较。甚至脚本数据也不是随机的——某些关键字可能比其他关键字使用得更多。如果解析器的构造方式是它首先检查最常用的关键字，那么可能需要完成大量比较，因为当字符串匹配时总是需要完成完全比较。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T09:29:43.150

一般来说，你应该把它留给 STL 而不必担心。

但是，如果这是您需要优化的区域（我对此表示严重怀疑），并且如果您了解字符串的字母分布/长度分布，则可以从字符串派生一个新类，并重载 == 运算符以执行以最有效的方式为您的应用程序进行相等性测试。（长度优先，第一个字符优先，向前，向后，等等）。

这比在你的代码中分散“优化”要好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T09:19:06.510

在您的随机测试中，字符串可能已经足够长以显示增益，而在您的实际情况下，您可能会处理较短的字符串，并且两个比较的常数因子不会被不执行测试的字符串比较部分的任何增益所抵消。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-09T09:22:07.940

std::string operator== 的实现无法知道首先检查长度还是开始检查字符是否会更快。显然检查长度对于相同长度的字符串是一种浪费。因此，不同的 STL 实现可能会执行不同的操作。

仅将显式长度检查作为最终优化（明确注释为这样），并且仅当您的分析器确认好处时。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T09:39:05.707

长度比较对我来说没有任何意义..使用比较运算符就足够了

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T09:15:48.063

触发你的 STL 实现。没关系

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T10:51:16.217

长度比较是为了尝试一些短路优化。

我假设长度比较比完整字符串比较快，所以如果这可以消除 99% 的不匹配，它会比每次进行完整字符串比较更快。

代码将执行长度比较，它会失败，然后它会忽略完整的字符串比较并跳过代码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T11:51:05.473

std::string 的长度很可能是 std::string 对象的成员。相比之下，第一个字符很可能在堆上。这意味着比较字符串长度可以提高引用的局部性。当然，通过短字符串优化，这变得更加复杂 -`Lhs[0]`可能在堆上而`Rhs[0]`在堆栈上。

# java - 我可以列出给定包中的资源吗？

> ID：186496
> 
> 赞同：18
> 
> 时间：2008-10-09T09:15:11.137
> 
> 标签：java, list, resources, war

假设我的类是从压缩的 .war 文件中加载或在其他地方加载的，我如何才能发现给定包中的所有资源？枚举文件不会真正起作用，因为这是一个战争文件。这很可能涉及使用当前的类加载器？

有没有一个图书馆可以做这样的事情？谷歌搜索只发现了一些带有列表文件的黑客行为。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-17T23:27:23.180

是的。您可以使用`ClassLoader.getResources("")`;

或者您可以使用雪貂 API：
[https ://www.ohloh.net/p/pureperfect-ferret](https://www.ohloh.net/p/pureperfect-ferret)

此 API 允许您使用访问者模式扫描类路径以及任意存档和目录。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T09:34:22.970

不，您不能列出包中的资源，因为 JVM 根本不知道包中的资源。看到[这个问题](https://stackoverflow.com/questions/176527/how-can-i-enumerate-all-classes-in-a-package-and-add-them-to-a-list)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-07-12T21:26:49.453

Spring 框架提供了一个名为[`PathMatchingResourcePatternResolver`](http://docs.spring.io/spring/docs/3.2.4.RELEASE/javadoc-api/org/springframework/core/io/support/PathMatchingResourcePatternResolver.html). 使用这个类，您可以使用通配符提供 Ant 样式路径，它会为您找到相关资源（搜索类路径上的文件夹和 jar）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-03T23:20:06.863

我这样做： - 在打包之前，`ls myResources/*.ext > myResources/list.txt` - 然后先读取文件

# unit-testing - 为测试而设计或停止为测试而设计

> ID：186501
> 
> 赞同：2
> 
> 时间：2008-10-09T09:18:14.143
> 
> 标签：unit-testing, testing

那么哪个更好。我们是否开始让测试设计我们的代码。我们是否开始为依赖项引入构造函数注入只是为了使代码可测试？还是我们使用“覆盖”受保护的方法和被测类的子类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T09:25:25.203

我通常认为可测试的代码是好的代码。为了使代码可测试，您需要更好的解耦，以便可以使用测试工具单独测试每个组件。但是，实现中不应该有仅由单元测试使用的代码。

另外，请记住，您需要测试的是对象的公共 API，而不是受保护/私有方法。在私有/受保护方法中查找错误应该是日志记录/调试器的用途。毕竟，其中的错误也会传播到公共方法。因此，只要公共方法满足测试，受保护的方法也将被覆盖。

如果您使用的是 java，并且在同一个包中具有实现公共接口的包范围类，我会将单元测试放在同一个包中的单独文件夹中以测试这些类。您还可以将单元测试与被测类放在同一个包中，以测试受保护的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T13:09:22.647

我基本同意 Staale，精心设计的代码应该是可测试的。
我不使用构造函数注入或派生类进行测试。我相信使用“服务定位器”是进行依赖注入的正确方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T13:19:30.503

如果您的测试设计得很好，它们将模拟真实世界的使用。因此，一套非常好的单元测试将涵盖应用程序可以利用您的代码的所有可能方式，这~~将~~产生一个健壮的实现。如果您的测试有缺陷，那么您不会获得太多收益。

# windows - exe中的DllMain？

> ID：186502
> 
> 赞同：3
> 
> 时间：2008-10-09T09:18:39.740
> 
> 标签：windows, dll

是否可以在不使用任何额外 dll 的情况下在独立 exe 中接收有关线程附加/分离的通知之类的 DllMain？

**编辑：**这只是一个与我正在做的一些测试有关的理论问题。不是现实生活中的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T16:42:15.463

有趣的问题。我不知道 Win32 中内置的任何内容 - 我认为您可能必须创建一个 DLL，该 DLL 具有一个 API，当它收到各种附加/分离消息时，它会发出事件信号或发布消息。

另一种不需要单独的 DLL 但需要一些技巧的替代方法是使用调试 API（`WaitForDebugEvent()`特别是）。`CreateProcess()`如果您的应用程序具有特殊的“测试”模式（可能由命令行选项指示），除了使用标志重新启动 exe 之外什么都不做`DEBUG_ONLY_THIS_PROCESS`，父（“调试器”）进程可以调用`WaitForDebugEvent()`以获取线程开始和结束的通知事件以及一堆其他有趣的事件。父进程可以将它们作为消息或通过信号事件（如果这是您想要的）传递给子进程，或者如果您需要的话，也可以执行自己的日志记录。

这绝不是一件简单的事情，但它可以工作并且不需要单独的 DLL 或图像，只是当您想要执行这些测试时的一种特殊模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T09:39:20.167

没有在线程上运行并加载可执行文件的外部代码，因此没有线程附加/分离通知 [1]。可执行文件中的代码通常控制线程 [2]。

如果你描述你的场景，人们可能会给你一些如何实现它的想法。

* * *

[1] 嗯，大多数时候。可以在另一个进程中加载​​可执行文件，但人们通常不这样做。
[2] 在某些例外情况下，线程模型和线程是由操作系统创建的，而不是由可执行代码创建的。这些大多与 COM/RPC 有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T14:28:37.027

您的问题是在进程加载和卸载时收到通知。这更适用于 DLL，因为它们正在被其他进程加载。

对于 Exes，您有 InitInstance 和 ExitInstance，您可以等效地处理它们！

# design-patterns - 灵活的装饰器模式？

> ID：186507
> 
> 赞同：2
> 
> 时间：2008-10-09T09:19:26.387
> 
> 标签：design-patterns, decorator

我正在寻找一种模式来模拟我正在考虑在个人项目中做的事情，并且我想知道修饰器模式的修改版本是否可以工作。

基本上我正在考虑创建一个游戏，其中角色属性通过他们装备的物品进行修改。装饰器堆叠其修改的方式非常适合这一点，但是我从未见过允许您删除中间装饰器的装饰器，当物品未装备时会发生这种情况。

有没有人以这种方式使用装饰器模式的经验？还是我在叫错树？

**澄清**

解释“中间装饰器”，例如，如果我的基类是用牛奶装饰的咖啡，用糖装饰的牛奶（使用 Head first 设计模式中的示例）牛奶将是中间装饰器，因为它装饰了基础咖啡，并被装饰由糖。

**还有更多的澄清:)**

这个想法是物品会改变统计数据，我同意我将装饰器硬塞进这个。我会查看状态袋。本质上，我想要一个统计数据点，并在装备/不装备物品时让它们上升/下降。

我可以将修改器应用于装备时的角色统计数据，并在取消装备时将它们回滚。或者每当要求统计数据时，遍历所有项目并计算统计数据。

我只是在这里寻找反馈，我知道我可能正在使用电锯，剪刀更合适......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T11:32:41.017

老实说，这听起来像是你真的在试图适应一个你并不真正需要的模式，只是为了使用一个模式。不要成为那个人。

现在，如果武器给了角色一些额外的力量/耐力/生命值或其他什么，那么它可能值得考虑。但听起来你根本不会用这些来修改（或装饰）角色的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T11:39:46.073

我明白你想要做什么，但是关于模式要记住的一件事是，你不应该试图把你的设计硬塞进一个模式。模式自然发生 - 您描述的行为实际上并不是装饰器模式的一部分。

话虽如此，我想你会想通过一些独特的 ID 来解除武器装备，比如：

```
Character.unequip(LIGHTSABER); 
```

如果您尝试将其放入装饰器模式中，则必须跟踪当前装备的物品，然后在移除武器后，您必须将装饰光刃的对象的引用更新为LIGHTSABER 正在装饰。这是很多工作。

相反，也许值得考虑@Mitch 的想法，让角色的武器在财产袋中有所帮助。请记住，一个角色拥有一套武器。对我来说，似乎组合可能是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T12:33:56.090

嗯..我在想也许命令模式会是解决这个问题的好方法。这就是我的意思：

这是你的角色类：

```
Public class Character {

 //various character related variables and methods here...

 Command[] equipCommands;
 Command[] unequipCommands;

 public Character(Command[] p_equipCommands, Command[] p_unequipCommands) {

  equipCommands = p_equipCommands;
  unequipCommands = p_unEquipCommands;
 }

 public void itemEquiped(int itemID) {

  equipCommands[itemID].execute(this);
 }

 public void itemUnequiped(int itemID) {

  unequipCommands[itemID].execute(this);
 }
} 
```

以下是一些命令示例：

```
public class SwordOfDragonSlayingEquipCommand implements ItemCommand{

 public void execute(Character p_character) {

  //There's probably a better way of doing this, but of the top of my head...
  p_character.addItemToInventory(Weapons.getIteM(Weapons.SWORD_OF_DRAGON_SLAYING));

  //other methods that raise stats, give bonuses etc. here...
 }
}

public class SwordOfDragonSlayingUnequipCommand implements ItemCommand{

 public void execute(Character p_character) {

  //There's probably a better way of doing this, but of the top of my head...
  p_character.removeItemFromInventory(Weapons.getIteM(Weapons.SWORD_OF_DRAGON_SLAYING));

  //other methods that lower stats, remove bonuses etc. here...
 }
} 
```

当然，这只是一个建议，绝对可以讨论，我并不是说这是最好的或唯一的方法......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T19:15:16.497

在视频游戏中实现传播的统计数据有三个答案：

(1) 这将满足您将制作的任何业余爱好者游戏（以及几乎所有职业游戏）：

```
character.GetStrength() {
  foreach(item in character.items)
    strFromItems += item.GetStrengthBonusForItems();
       foreach(buff in character.buffs)
    strFromBuffs += buff.GetStrengthBonusForBuffs();
  ...

  return character.baseStrength + strFromItems + ...;
} 
```

（注意不同的 GetStrength*() 函数彼此无关）

(2) 这将满足所有标题中没有“暗黑破坏神”一词的游戏：

```
 character.GetStr() { ... // same as above, strength is rarely queried }
 character.GetMaxHP() { 
   if (character._maxHPDirty) RecalcMaxHP();
   return character.cachedMaxHP;
 }
 // repeat for damage, and your probably done, but profile to figure out
 // exactly which stats are important to your game 
```

(3) 其他

```
 // changes in diablo happen very infrequently compared to queries, 
 // so up propegate to optimize queries.  Moreover, 10 people edit 
 // the stat calculation formulas so having the up propegation match 
 // the caculation w/o writing code is pretty important for robustness.

 character.OnEquip(item) {
     statList.merge(item.statlist);
 }

 character.GetStrength() {
     statList.getStat(STRENGTH);
 }

 statlist.getStat(id) {
     if (IS_FAST_STAT(id)) return cachedFastStats[id];
     return cachedStats.lookup(id);
 }

 statlist.merge(statlist) {
      // left for an exercise for the reader
 } 
```

老实说（3）可能是矫枉过正。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-12T13:18:39.010

只需保留 2 组统计数据，即您的基本统计数据和有效统计数据。当您装备或取消装备物品时，在适当的情况下从有效统计数据中添加或减少。这样您就不必每次想知道您的统计数据时都遍历您的设备列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-24T23:26:17.850

我知道这个问题已经过时了，但是如果不是 OP，这可能会对其他人有所帮助。阅读这篇文章，了解如何在游戏中真正做到这种事情（由参与 Tony Hawk 游戏的开发人员之一）：

[http://cowboyprogramming.com/2007/01/05/evolve-your-heirachy/](http://cowboyprogramming.com/2007/01/05/evolve-your-heirachy/)

组合您的实体/游戏对象。为了在游戏中构建实体行为，永远，永远不要依赖继承，或者任何本身以任何方式依赖继承的东西——这包括 OP 建议的装饰器模式。你会束缚自己的双手。组合是要走的路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-11T20:52:09.203

您在寻找策略模式吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T00:45:31.743

为什么不对武器进行如下编码：

1 = 电锯 2 = 霰弹枪 4 = 轨道枪

所以现在6的总和只能意味着角色拥有霰弹枪和轨道炮。这是一个快速摘要，因此您不必遍历您的武器字典列表。你仍然需要一些结构来容纳武器，但至少你会通过这种方法获得速度。这假定您只能拥有每个类别的一种武器，但同时可以拥有许多类别。

# php - PHP 的 file_get_contents 直到超过远程服务器的保持活动限制才返回

> ID：186520
> 
> 赞同：0
> 
> 时间：2008-10-09T09:23:28.903
> 
> 标签：php, html, apache, networking

从一个 apache 服务器 file_get_contents 立即返回 url 的内容。在另一个 apache 服务器上，file_get 内容不会返回相同 url 的内容，直到托管该 url 的服务器的保持活动限制已过期。2 个 php 服务器正在检索相同的 url，但通过不同的网络路由。什么可能导致一个 php 安装在返回之前等待远程保持活动限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T09:40:45.920

`fopen`手动使用会更快吗？

与其花几个小时弄清楚为什么`file_get_contents`不起作用，不如换掉它。

如果`fopen`没有更快，则可能是配置或文件系统问题。如果速度更快，则可能是 php.ini 问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T09:34:58.663

我对那个 php 函数并不完全熟悉，但是我看到了由于输出没有被刷新回流而导致的类似情况。我相信一旦数据达到一定大小或当流关闭时，数据通常会被刷新到流中。在您使用的每个 php 服务器上，此大小的配置可能不同，从而导致不同的效果。在调用 file_get_contents 之后直接调用 flush() 可能是值得的。希望这可以帮助。

# php - 更好的剖析方式？

> ID：186522
> 
> 赞同：0
> 
> 时间：2008-10-09T09:25:38.667
> 
> 标签：php, profile

那么有没有更好的方法来分析代码：

```
$start1 = microtime(TRUE);
for($i=0;$i<count($array);$i++)
 {
    //do something
 }
$time1 = microtime(TRUE) - $start1; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T09:56:48.057

如果您在安装 Xdebug 时遇到困难，请使用 Xdebug 或 Zend Debugger。

他们的分析器将为您计时，无需修改您的代码。

[http://www.xdebug.org/](http://www.xdebug.org/)

[http://www.zend.com/en/community/pdt](http://www.zend.com/en/community/pdt)

[http://devzone.zend.com/article/2899-Profiling-PHP-Applications-With-xdebug](http://devzone.zend.com/article/2899-Profiling-PHP-Applications-With-xdebug) - 一系列关于 xdebug 的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T11:43:59.713

如果不使用外部工具，我会说你已经尽力了。

如果您想使用为此目的而构建的工具，那么其他答案都是固定的。

# c# - C#/CLI 标识符的最大长度是多少？

> ID：186523
> 
> 赞同：29
> 
> 时间：2008-10-09T09:26:23.487
> 
> 标签：c#, .net, clr, language-features, command-line-interface

名称还有哪些其他限制（除了范围内明显的唯一性）？

那些定义在哪里？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-01-09T20:46:17.153

除了其他答案之外，Microsoft Visual C# 编译器接受的最大标识符长度是**511 characters**。这可以使用以下代码进行测试：

```
class Program
{
    private static void Main(string[] args)
    {
        int aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa = 5;
    }
} 
```

变量名的长度有 511 个字符。此代码可以编译，但如果在名称中添加一个字符，编译器会输出`error CS0645: Identifier too long`.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-09T09:36:02.857

来自[ECMA-335 的 PDF](https://www.ecma-international.org/publications/standards/Ecma-335.htm)，第 II 部分，第 22 节：

> 元数据保持由编译器或代码生成器创建的名称字符串不变。本质上，它将每个字符串视为一个不透明的 blob。特别是，它保留了大小写。CLI 对存储在元数据中并随后由 CLI 处理的名称的长度没有限制

如果我已正确阅读并且上下文正确，则 CLR 中标识符的长度没有实际限制。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-09T09:36:28.270

C# 语言规范在统一 C# 3.0 规范的第 2.4.2 节中定义了标识符。基本上它是“字母或下划线”后跟任意数量的“字母、十进制数字、连接字符、组合字符、格式字符”。要将关键字用作标识符，您需要将 @ 放在前面，例如`int @int = 5;`

我没有研究 CLI 规范，但我知道它比 C# 规范的限制要少一些，因为 C# 编译器对匿名方法之类的东西使用“不可描述”的名称——这些通常包括尖括号，这在 CLI 中是有效的，但是在 C# 中无效。

编辑：C# 规范中没有明确的名称长度限制，但第 2.4.2 节确实有一个保留：

> 包含两个连续下划线字符 (U+005F) 的标识符保留供实现使用。例如，一个实现可能会提供以两个下划线开头的扩展关键字。

换句话说，以特定标识符开头的特定标识符是否有效是特定于实现的`__`。（有些编译器可能有`__foo`扩展关键字，有些可能没有。）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-01-09T21:48:19.520

根据“Expert .NET 2.0 IL Assembler”（Serge Lidin，Apress）中的各个地方，功能 CIL/CLR 限制为 1,023 字节，以 UTF-8 编码。引号：

第 122 页：

> ILAsm 中任何一种名称的长度在语法上都没有限制，但元数据规则对名称长度施加了一定的限制。

第 126 页：

> 公共语言运行库对完整的类名长度施加了限制，指定它在 UTF-8 编码中不应超过 1,023 个字节。但是，ILAsm 编译器不强制执行此限制。单引号，如果它们用于 ILAsm 中的简单名称，是一种纯粹的词汇工具，不会出现在元数据中；因此，它们不会影响完整类名的总长度。

第 143 页：

> [TypeDef 表] Name 和 Namespace 条目引用的字符串的组合长度不得超过 1,023 字节。

第 144 页：

> [TypeRef Table] [run time] Name 和 Namespace 条目引用的字符串的组合长度不得超过 1,023 字节。

第 186 页：

> [方法表] 名称（#Strings 流中的偏移量）。方法的名称（不包括该方法所属的类的名称）。此条目必须索引长度不超过 1,023 字节的 UTF-8 编码的非零字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-15T10:07:23.963

**Visual Studio 2015（更新 3）- C# 6**

最大类名长度 = **993 个**字符

```
 public class AaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaAAAAAZZZ
{            
} 
```

如果您再添加 1 个字符，它不会编译，而且令人惊讶的是错误列表也是空的！

编辑：对于我的 VS2013 Update 3 同事，类名限制 = **1012**。不知道为什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T09:41:40.537

查看 Partition II Metadata docs，它指出标识符是 ID 或 SQSTRING

一个 ID 被描述为

> 以字母字符或“_”、“$”、“@”或“?”之一开头的连续字符串 并且后跟任意数量的字母数字字符或“_”、“$”、“@”或“?”中的任何一个</p>

这意味着没有长度限制。

# google-maps - Mapstraction 作为访问 Google 地图的图书馆

> ID：186525
> 
> 赞同：4
> 
> 时间：2008-10-09T09:27:06.683
> 
> 标签：google-maps, mapping, maps, gis

您是否建议[将 Mapstraction](http://www.mapstraction.com/)（图书馆）作为访问 Google 地图的图层？

它是一个积极维护的项目吗？除了它的提供者独立的主要原因之外，我是否会通过使用这个库来再次/失去任何东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-19T17:58:57.257

已将此用于相当主要的产品，易于使用和扩展。强烈推荐，以便将来可以根据需要更换映射产品。

干杯，

抢

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-19T06:45:05.147

读完这篇文章后，我研究了同样的问题，我认为可能需要做一点澄清。

OpenLayers 的用户群比 Mapstraction 大，但仍比 GoogleMaps 小（[过去两周 GM 有超过 1000 个帖子](http://code.google.com/apis/maps/documentation/javascript/forum.html)，OpenLayers[开发者论坛在 10 月有 169 个帖子](http://lists.osgeo.org/pipermail/openlayers-dev/2010-October/thread.html)，[mapstraction 有 33 个](http://lists.mapstraction.com/pipermail/mapstraction-mapstraction.com/2010-October/thread.html)。这不是一个完全公平的比较，因为 OpenLayers 和Mapstraction 似乎是更复杂的开发人员类型并且垃圾邮件更少。我认为开放图层和 Mapstraction 都通过包装完整的 google maps js api 支持在 google 的 TOS 中使用 google maps。

Mapstraction 优于 OpenLayers 的一个优势是可以更直接地访问 googles api，而开放层支持的 google api 端口更少，但在它支持的地图中更一致地支持它们。这个列表服务问题很好地涵盖了它 [http://www.mail-archive.com/dev@openlayers.org/msg02039.html](http://www.mail-archive.com/dev@openlayers.org/msg02039.html)

我们一直在考虑从 GoogleMaps 转移到 mapstraction，这里有一些关于我开始使用 Mapstraction api 包装器的经验的想法。

在他们的主页上，他们链接到一个[复杂的错误演示](http://mapstraction.appspot.com/)，该演示不包括当前版本的谷歌地图。如果你在 git hub 附近挖掘，这里有一个 api v3 演示 [https://github.com/mapstraction/mxn/blob/master/examples/googlev3.html](https://github.com/mapstraction/mxn/blob/master/examples/googlev3.html)

github 上的代码库似乎写得很好，但他们的文档很不稳定。事实上，当您[在 google 上搜索“mapstraction”时](http://www.google.com/search?sourceid=chrome&ie=UTF-8&q=mapstraction)，API Doc 站点链接指向也不涵盖 v3的[过时文档。](http://mapstraction.com/doc/)如果您下载 git hub 源代码，则会有自动生成的文档涵盖 v3，但没有很好的简单入门示例。他们的邮件列表很难搜索，但我也没有看到任何示例。看起来，虽然他们放弃了 code.google.com 作为主要源主干，但他们仍然在所有示例中依赖它来托管 js 文件并使用 .js(apitype) 设置注入依赖项。像这样 [http://mapstraction.googlecode.com/svn/trunk/source/mxn.js?(openlayers](http://mapstraction.googlecode.com/svn/trunk/source/mxn.js?(openlayers)) 我在 list serv 上遇到了一些喋喋不休的消息，他们建议 google js 文件经常在代码库中排除必要的补丁。我还没有找到一个很好的入门文档或电子邮件来解释他们首选的链接代码或注入 api 依赖项的方案。

所有这些都是小问题，他们似乎有一个很好的核心团队。因此，如果您需要支持谷歌特定的地图功能，它们似乎是一个不错的选择。

这里是他们更简单的例子供参考 [https://github.com/mapstraction/mxn/tree/master/examples/](https://github.com/mapstraction/mxn/tree/master/examples/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T00:58:15.267

你也可以看看[http://openlayers.org/](http://openlayers.org/)

# c# - 如何同步对列表的访问 在 ASP.NET 中使用？

> ID：186527
> 
> 赞同：5
> 
> 时间：2008-10-09T09:27:38.257
> 
> 标签：c#, asp.net, .net, multithreading, access-synchronization

我在同时访问列表的站点上遇到了一些问题。这个列表保留了一个购物车，多次删除会使网站崩溃。 **同步它们的最佳方法是什么？** 一把锁就够了吗？锁定选项似乎很难看，因为代码遍布各处并且非常混乱。

更新：这是一个这样实现的列表： public class MyList : List< SomeCustomType> { }

这是一个旧站点，因此不允许对其进行太多修改。我应该如何重构它以便在迭代它时安全锁定？

任何的想法！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T09:40:21.103

那么这个内存列表是否在请求之间共享？即使您已经锁定，这听起来也是一个潜在的问题原因。通常应避免使用可变共享集合，IME。

请注意，如果您*决定*进行同步，则需要在整个迭代过程中锁定列表以及其他复合操作。仅仅锁定每个特定的访问权限是不够的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T09:31:24.613

使用锁是同步访问泛型集合的正确方法。对集合的访问遍布各处，您可以创建一个包装类来包装对集合的访问，从而减少交互面。然后，您可以在包装对象中引入同步。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T11:47:02.593

是的，您必须像这样使用[List.SyncRoot](http://msdn.microsoft.com/en-us/library/bb356596.aspx)锁定：

```
lock (myList.SyncRoot) 
{
    // Access the collection.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-21T09:48:49.250

@Samuel 这正是重点：您不能仅通过修改现有类来纠正这样的问题。没关系，`class extends List<T>`与 MS 方式保持一致的 . 大部分都避免使用虚拟方法（只有在 MS 打算让我们覆盖的地方，它们才会使其成为虚拟方法，这主要是有道理的，但在您有点需要破解的情况下会使生活变得更加困难）。即使它嵌入了`List<T>`并且所有对它的访问都通过您可以更改的代码，您也不能简单地修改此代码添加锁来解决问题。

为什么？好吧，一件事的迭代器。不能仅仅在每次访问集合之间不修改集合。在整个枚举过程中不能修改。

实际上，同步是一件复杂的事情，它取决于列表的真正含义以及系统中需要始终为真的事物类型。

为了说明，这里有一个滥用 IDisposable 的黑客。这*将嵌入*列表并重新声明在某处使用的列表的任何功能，以便可以同步对列表的访问。此外，它*没有*实现 IEnumerable。相反，访问枚举列表的唯一方法是通过返回一次性类型的方法。此类型在创建时进入监视器，并在释放时再次退出。这确保列表在迭代期间不可访问。但是，这仍然不够，正如我的示例使用将说明的那样。

首先是被黑名单：

`public class MyCollection { object syncRoot = new object(); List list = new List();`

 ````
public void Add(T item) { lock (syncRoot) list.Add(item); }

public int Count
{
    get { lock (syncRoot) return list.Count; }
}

public IteratorWrapper GetIteratorWrapper()
{
    return new IteratorWrapper(this);
}

public class IteratorWrapper : IDisposable, IEnumerable<T>
{
    bool disposed;
    MyCollection<T> c;
    public IteratorWrapper(MyCollection<T> c) { this.c = c; Monitor.Enter(c.syncRoot); }
    public void Dispose() { if (!disposed) Monitor.Exit(c.syncRoot); disposed = true; }

    public IEnumerator<T> GetEnumerator()
    {
        return c.list.GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
} 
```` 

`}`

然后是一个使用它的控制台应用程序：

`class Program { static MyCollection strings = new MyCollection();`

 ````
static void Main(string[] args)
{
    new Thread(adder).Start();
    Thread.Sleep(15);
    dump();
    Thread.Sleep(125);
    dump();
    Console.WriteLine("Press any key.");
    Console.ReadKey(true);
}

static void dump()
{
    Console.WriteLine(string.Format("Count={0}", strings.Count).PadLeft(40, '-'));
    using (var enumerable = strings.GetIteratorWrapper())
    {
        foreach (var s in enumerable)
            Console.WriteLine(s);
    }
    Console.WriteLine("".PadLeft(40, '-'));
}

static void adder()
{
    for (int i = 0; i < 100; i++)
    {
        strings.Add(Guid.NewGuid().ToString("N"));
        Thread.Sleep(7);
    }
} 
```` 

`}`

请注意“转储”方法：它访问 Count，这会毫无意义地锁定列表以使其“线程安全”，然后遍历项目。但是 Count getter（锁定、获取计数、然后释放）和 using 语句之间存在竞争条件。所以它可能不会转储它所做的事情的数量。

在这里，可能无关紧要。但是，如果代码改为执行以下操作会怎样：

```
var a = new string[strings.Count];
for (int i=0; i < strings.Count; i++) { ... } 
```

或者更有可能把事情搞砸：

```
var n = strings.Count;
var a = new string[n];
for (int i=0; i < n; i++) { ... } 
```

如果项目同时添加到列表中，前者会爆炸。如果从列表中删除项目，后者的情况不会很好。在这两种情况下，代码的*语义*可能不会不受列表更改的影响，即使更改不会导致代码崩溃。在第一种情况下，可能项目已从列表中删除，导致数组未填充。随后，由于数组中的空值，代码中的某些内容崩溃了。

从中吸取的教训是：共享状态可能非常棘手。你需要一个*前期*计划，你需要有一个策略来确保你的意思是正确的。

在每种情况下，只有确保锁跨越所有相关操作，才能实现正确操作。两者之间可能有许多其他语句，并且锁可能跨越许多方法调用和/或涉及许多不同的对象。没有什么灵丹妙药可以仅仅通过修改集合本身来解决这些问题，因为*正确*的同步取决于集合的*含义*。诸如只读对象缓存之类的东西可能只能与 同步`add/remove/lookup`，但如果集合本身应该代表一些有意义/重要的概念，这永远不够。

# c# - 为什么我的 datagridview 在逃逸时重新定位

> ID：186534
> 
> 赞同：0
> 
> 时间：2008-10-09T09:32:07.687
> 
> 标签：c#, datagridview

我在管理的 c# 项目中的表单上有一个 DataGridView 控件。（.net 2.0）当我使用鼠标上的滚动按钮然后单击一个单元格并单击退出按钮或选择另一个单元格时，网格将自行重新定位。但是，如果我在控件上使用滚动条，则不会发生这种行为。

有没有人以前见过这样的行为，或者对可能导致它的原因有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T09:52:55.163

我以前从未见过这样的事情。

你检查过你的事件处理程序吗？

我问的原因是，采用 1 个表单的最小应用程序，1 DataGridView，不会出现这个问题。

# sql - INSERT 语句后的@@IDENTITY 总是返回 0

> ID：186544
> 
> 赞同：14
> 
> 时间：2008-10-09T09:38:52.167
> 
> 标签：sql, database, ms-access, primary-key, jet

我需要一个在数据库上执行 INSERT 语句并返回 Auto_Increment 主键的函数。我有以下 C# 代码，但是，虽然 INSERT 语句工作正常（我可以看到数据库中的记录，PK 生成正确并且行 == 1），但 id 值始终为 0。关于可能发生的任何想法错误的？

```
 public int ExecuteInsertStatement(string statement)
    {
        InitializeAndOpenConnection();
        int id = -1;

        IDbCommand cmdInsert = connection.CreateCommand();
        cmdInsert.CommandText = statement;
        int rows = cmdInsert.ExecuteNonQuery();

        if (rows == 1)
        {
            IDbCommand cmdId = connection.CreateCommand();
            cmdId.CommandText = "SELECT @@Identity;";
            id = (int)cmdId.ExecuteScalar();
        }

        return id;
    }
    private void InitializeAndOpenConnection()
    {
        if (connection == null)
            connection = OleDbProviderFactory.Instance.CreateConnection(connectString);

        if(connection.State != ConnectionState.Open)                 
            connection.Open();
    } 
```

为了回应答案，我尝试了：

```
public int ExecuteInsertStatement(string statement, string tableName)
    {
        InitializeAndOpenConnection();
        int id = -1;
        IDbCommand cmdInsert = connection.CreateCommand();
        cmdInsert.CommandText = statement + ";SELECT OID FROM " + tableName + " WHERE OID = SCOPE_IDENTITY();";
        id = (int)cmdInsert.ExecuteScalar();

        return id;
    } 
```

但我现在收到错误“SQL 语句结束后找到的字符”

我正在使用带有 OleDb 连接的 MS Access 数据库，Provider=Microsoft.Jet.OLEDB.4.0

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-09T09:42:35.170

1) 将 INSERT 和 SELECT 语句（使用“;”连接）组合成 1 个 db 命令

2) 使用 SCOPE_IDENTITY() 而不是 @@IDENTITY

插入 blabla ... ; 从表中选择 OID WHERE OID = SCOPE_IDENTITY()

- 更新：

事实证明，这个问题与 MS ACCESS 有关，我发现[这篇文章](http://www.mikesdotnetting.com/Article.aspx?ArticleID=54)表明只需重用第一个命令并将其 CommandText 设置为“SELECT @@IDENTITY”就足够了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T12:13:57.687

Microsoft.Jet.OLEDB.4.0 提供程序支持 Jet v3 和 Jet v4 数据库引擎，但是 Jet v3 不支持 SELECT @@IDENTITY。

MSAccess 97 是 Jet v3，不支持 SELECT @@IDENTITY；它支持 MSAccess 2000 及更高版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T09:42:50.567

您需要在打开初始连接的同时返回身份。从插入或输出变量返回结果集。

您还应该始终使用 SCOPE_IDENTITY() 而不是 @@identity。[参考这里](http://blog.sqlauthority.com/2007/03/25/sql-server-identity-vs-scope_identity-vs-ident_current-retrieve-last-inserted-identity-of-record/)

你应该添加

```
SELECT SCOPE_IDENTITY() 
```

插入后。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T10:22:45.523

您使用的是 Jet（不是 SQL Server），而 Jet 每个命令只能处理一个 SQL 语句，因此您需要`SELECT @@IDENTITY`在单独的命令中执行，显然要确保它使用与`INSERT`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T09:40:54.797

我认为您需要在第一个创建命令中使用 Select @@identity - 尝试通过 ";SELECT @@Identity" 和 .ExecuteScalar 插入语句附加它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T23:19:27.037

如果您想检索您正在插入的事务的自动运行数的值以及您的环境如下 1\. 数据库是 MsAccess。2\. 驱动程序是 Jet4，连接字符串如下“Provider=Microsoft.Jet.OLEDB.4.0;Password={0};Data Source={1};Persist Security Info=True” 3\. 使用 Oledb

您可以将我的示例应用于您的代码

```
OleDbConnection connection =  String.Format("Provider=Microsoft.Jet.OLEDB.4.0;Password={0};Data Source={1};Persist Security Info=True",dbinfo.Password,dbinfo.MsAccessDBFile);
connection.Open();
OleDbTransaction transaction = null;
try{
    connection.BeginTransaction();
    String commandInsert = "INSERT INTO TB_SAMPLE ([NAME]) VALUES ('MR. DUKE')";
    OleDbCommand cmd = new OleDbCommand(commandInsert , connection, transaction);
    cmd.ExecuteNonQuery();
    String commandIndentity = "SELECT @@IDENTITY";
    cmd = new OleDbCommandcommandIndentity, connection, transaction);
    Console.WriteLine("New Running No = {0}", (int)cmd.ExecuteScalar());
    connection.Commit();
}catch(Exception ex){
    connection.Rollback();
}finally{
    connection.Close();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T09:41:39.803

您的表上是否有任何可能插入到其他表中的触发器？通常，我们建议不要使用@@Identity 来支持[IDENT_CURRENT](http://msdn.microsoft.com/en-us/library/ms175098.aspx)，这样您就可以保证返回的身份是针对您刚刚插入的表的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T09:42:24.937

我认为 @@identity 仅在命令范围内有效 - 在您执行“语句”时。

修改您的“语句”，使存储过程本身在 INSERT 语句之后立即返回 @@IDENTITY 值，并将其读取为存储过程执行的返回码。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-09T10:00:25.010

检查您的数据库设置。不久前我遇到了类似的问题，发现启用了 SQL Server 连接设置“无计数”。

在 SQL Server Management Studio 中，您可以通过右键单击对象资源管理器中的服务器，选择“属性”，然后导航到“连接”页面来找到它。查看“默认连接选项”的设置

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T10:51:00.757

大多数回答者不是忘记了提问者没有使用 SQL Server 吗？

~~显然，MS Access 2000 及更高版本[不支持 @@IDENTITY](http://msdn.microsoft.com/en-us/library/ks9f57t0(VS.71).aspx)。~~另一种方法是“使用 RowUpdated 事件，您可以确定是否发生了 INSERT，检索最新的 @@IDENTITY 值，并将其放在 DataSet 中本地表的标识列中。”

是的，这是用于 Access DB 中的嵌入式 VBA。这仍然可以通过 Access 对象库在 Access 之外调用。

编辑：好的，它受支持，对于昏昏沉沉的清晨回答感到抱歉。但是这个答案的其余部分可能会有所帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-02T18:10:19.440

简短的回答：
1\. 创建两个命令，每个命令都接受一个查询。
2.第一个sql查询是INSERT记录。
3.第二个sql查询是“SELECT @@Identity;” 它返回自动编号。
4\. 使用 cmd.ExecuteScalar() 返回第一行的第一列。
5、返回的结果输出为当前插入查询中生成的AutoNumber值。

[它是从此链接中引用的](http://blogs.msdn.com/b/spike/archive/2009/12/02/getting-autonumber-from-access-via-select-identity-needs-to-be-done-in-same-connection-as-the-insert.aspx)。示例代码如下。请注意“相同连接与新连接”的区别。SAME Con​​nection 提供所需的输出。

```
 class Program
{
    static string path = @"<your path>";
    static string db = @"Test.mdb";
    static void Main(string[] args)
    {
        string cs = String.Format(@"Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0}\{1}", path, db);
        // Using the same connection for the insert and the SELECT @@IDENTITY
        using (OleDbConnection con = new OleDbConnection(cs))
        {
            con.Open();
            OleDbCommand cmd = con.CreateCommand();
            for (int i = 0; i < 3; i++)
            {
                cmd.CommandText = "INSERT INTO TestTable(OurTxt) VALUES ('" + i.ToString() + "')";
                cmd.ExecuteNonQuery();

                cmd.CommandText = "SELECT @@IDENTITY";
                Console.WriteLine("AutoNumber: {0}", (int)cmd.ExecuteScalar());
            }
            con.Close();
        }
        // Using a new connection and then SELECT @@IDENTITY
        using (OleDbConnection con = new OleDbConnection(cs))
        {
            con.Open();
            OleDbCommand cmd = con.CreateCommand();
            cmd.CommandText = "SELECT @@IDENTITY";
            Console.WriteLine("\nNew connection, AutoNumber: {0}", (int)cmd.ExecuteScalar());
            con.Close();
        }
    }
} 
```

这应该产生不言自明的输出：

```
AutoNumber: 1 <br>
AutoNumber: 2 <br>
AutoNumber: 3 <br>

New connection, AutoNumber: 0 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-10-09T09:42:42.360

当您使用 Access 时，请查看 aspfaq 中的[这篇文章](http://databases.aspfaq.com/general/how-do-i-get-the-identity/autonumber-value-for-the-row-i-inserted.html)，向下滚动到页面的大约一半。代码在经典 ASP 中，但希望这些原则仍然有效。

* * *

我相信 SELECT @@Identity 最终会被视为一个单独的执行上下文。*应该*工作的代码是：

```
public int ExecuteInsertStatement(string statement)
{
    InitializeAndOpenConnection();

    IDbCommand cmdInsert = connection.CreateCommand();
    cmdInsert.CommandText = statement + "; SELECT @@Identity";
    object result = cmdInsert.ExecuteScalar();

    if (object == DBNull.Value)
    {
       return -1;
    }
    else
    {
       return Convert.ToInt32(result);
    }
} 
```

不过，您可能希望/需要整理将“SELECT @@Identity”添加到代码末尾的连接。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2010-01-10T08:22:25.980

```
CREATE procedure dbo.sp_whlogin
(
 @id nvarchar(20),
 @ps nvarchar(20),
 @curdate datetime,
 @expdate datetime
)

AS
BEGIN
 DECLARE @role nvarchar(20)
 DECLARE @menu varchar(255)
 DECLARE @loginid int

 SELECT     @role = RoleID
 FROM         dbo.TblUsers
 WHERE    UserID = @id AND UserPass = @ps

 if @role is not null 
 BEGIN
  INSERT INTO TblLoginLog (UserID, LoginAt, ExpireAt, IsLogin) VALUES (@id, @curdate, @expdate, 1);
  SELECT @loginid = @@IDENTITY;
  SELECT @loginid as loginid, RoleName as role, RoleMenu as menu FROM TblUserRoles WHERE RoleName = @role
 END
 else
 BEGIN
  SELECT '' as role, '' as menu
 END
END
GO 
```

# iis-6 - IIS6 + HttpModule：此操作需要IIS集成管道模式

> ID：186548
> 
> 赞同：18
> 
> 时间：2008-10-09T09:39:45.487
> 
> 标签：iis-6, httpmodule

我正在使用 IIS6，我写了一个 HttpModule，我得到了这个错误？谷歌搜索后发现这个问题是由.NET framework 3.5引起的，所以我把这个放在我没有安装.NET 3.5的机器上，但问题仍然存在！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-09T10:02:27.267

我尝试进行心理调试：您正在使用如下语句：

```
Response.Headers("X-Foo") = "bar" 
```

如果确实是这种情况，则如下所示进行更改将解决该问题：

```
Response.AddHeader("X-Foo", "bar") 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T09:48:36.077

只有 IIS7 支持集成管道。在 IIS7 上，HttpModule 可以参与到 Web 服务器的所有请求，而不仅仅是针对特定文件扩展名的请求。

II6 使用 IIS7 所称的经典管道，只有在早期基于 ISAPI 的管道确定脚本映射需要将请求移交给 ASP.NET 时，HttpModules 才能参与其中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-17T21:09:52.990

刚遇到这个问题。使用 IIS6 和 .NET 3.5。对我来说修复是使用`Response.AddHeader`而不是`Response.Headers.Add`. HTH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-14T10:16:19.983

受其他答案的启发，我发现它正在访问导致“操作需要 IIS 集成管道模式”异常的`Response.Headers` *对象。*

避免`.Headers`并调用其他（旧的？）辅助函数，例如：

*   `Response.AddHeader()` 和
*   `Response.ClearHeaders()` （就我而言！）

# .net - 有人使用 Microsoft ASML 语言吗？

> ID：186549
> 
> 赞同：3
> 
> 时间：2008-10-09T09:40:15.267
> 
> 标签：.net, asml

对我来说，“Gurevich 抽象状态机”（以前称为“进化代数”）的概念似乎很有希望为系统行为提供坚实的基础。它可能是数据库的关系代数：潜在的理论基础。

据我所知，最完整的实现是生成 .NET 程序集的 Microsoft **[ASML语言。](http://research.microsoft.com/fse/asml/)**

有人真的在工作环境中使用它吗？而且，以防万一，成功程度如何？

如果其他人有成功的故事可以分享，我真的很想开始进行更多调查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T09:57:33.190

几年前我尝试过，但似乎这个项目已经过时了。很遗憾，因为我有点喜欢它。

# silverlight - 将鼠标单击发送到silverlight 2中的按钮

> ID：186553
> 
> 赞同：3
> 
> 时间：2008-10-09T09:40:50.820
> 
> 标签：silverlight, events

silverlight 应用程序中有按钮控件。我可以以编程方式向它发送鼠标单击事件吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-06-22T17:09:15.253

如果你还想这样做。您现在可以升级到 Silverlight 3.0 版或更高版本并执行以下操作：

您可以使用 System.Windows.Automation.Peers 中的按钮自动化对等方来完成您想要的。

```
if (button is Button)
{
    ButtonAutomationPeer peer = new ButtonAutomationPeer((Button)button);

    IInvokeProvider ip = (IInvokeProvider)peer;
    ip.Invoke();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T12:01:03.063

出于安全原因，您不能触发 Click 事件，因为这样您就可以在用户不知情的情况下强制用户进入全屏模式。正如 Oli 所说，您可以直接调用 Click 事件处理程序，但实际上不能触发 Click 事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-22T10:23:12.987

尝试使用 Automation Peers（如果您绝对需要以编程方式执行此操作）。

[http://www.vbdotnetheaven.com/UploadFile/dbeniwal321/TriggerEvent01232009020637AM/TriggerEvent.aspx](http://www.vbdotnetheaven.com/UploadFile/dbeniwal321/TriggerEvent01232009020637AM/TriggerEvent.aspx)有一个使用 vb.net 的示例

理想的方法是拥有一个共享函数，该函数既可以从按钮单击处理程序中调用，也可以在其他需要的情况下调用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T00:41:45.557

在 .Net 中执行此操作的经典方法是从 user32.dll 中 P/Invoke SendInput()，因为无法使用 .Net 框架执行此操作。

我不熟悉 Silverlight，但我知道它使用 .Net 的紧凑沙箱，所以如果互操作性可用，您会在 Internet 上找到大量示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-10T20:49:05.297

我的页面中有用于 CRUD 操作的按钮，在保存、删除或更新之后，我需要刷新 Datagrid 中的数据，最简单的方法是将点击事件从其他 CRUD 按钮发送到“读取”按钮

此代码触发该事件：

```
 private void btnSave_Click(object sender, RoutedEventArgs e)
    {
  //.....Save Operation

      //--At Finish refresh the datagrid
      btnRead_Click(btnRead, new RoutedEventArgs());
    } 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-10-09T10:06:32.517

我没有使用过 Silverlight，但我认为它与 Windows.Forms 和 WebControls 的过程相同。您只需要调用按钮的`.Click(Object o, EventArgs e)`方法。

# windows - 从 Windows 命令行自动复制文件

> ID：186556
> 
> 赞同：1
> 
> 时间：2008-10-09T09:41:15.030
> 
> 标签：windows, command-line

假设您有 100 个目录，并且对于每个目录，您都有一个名为 .pdf 的文件存储在其他地方。如果要将每个文件移动/复制到同名目录中，可以在 Windows 命令行上完成吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T10:01:33.930

这是一个批处理脚本，可能会执行您想要的操作：

```
setlocal
set target_dir=D:\
set source_dir=C:\WINDOWS

for %%i in (%source_dir%\*.pdf) do move %%i %target_dir%\%%~ni.%%~xi

endlocal 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T05:49:50.020

从命令行：

```
for /f %f in ('dir /s /b mypath\*.pdf') do @copy %~nxf myotherpath 
```

因为它在命令行上而不是在批处理文件中，所以您只需要 %，而不是 %%。

dir /s /b 是递归的和裸露的。（见目录/？）

复制前的@ 停止每个复制命令的回显。如果你愿意，你可以回应他们，这取决于你。

%~nxf 获取 %f 的名称和扩展名。（见电话/？）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T09:55:36.297

您可以使用[FOR 命令](http://technet.microsoft.com/en-us/library/bb490909.aspx)来完成。符合以下条件的东西：

```
for /f %%f in ('dir /s /b c:\source\*.pdf') do copy "%%f" c:\target 
```

如果您在文本文件中有一个带有完整路径的文件名列表，例如 files.txt，您也可以这样做

```
for /f %%f in (files.txt) do copy "%%f" c:\target 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T09:51:05.027

您需要编写一个脚本来遍历每个文件（及其路径），提取文件名-'.pdf'，然后将文件移动到同名目录

# windows - 用户是否需要管理员权限才能安装 Flash 播放器？

> ID：186569
> 
> 赞同：3
> 
> 时间：2008-10-09T09:44:28.097
> 
> 标签：windows, linux, flash, macos, unix

计算机上没有管理员权限的用户能否自行升级到新的 Flash 播放器版本？

这会很有趣： Windows 98 Windows XP/2000/Vista Macs Unix/Linux

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T09:56:30.460

查看[Adob​​e 说明](http://www.adobe.com/products/flashplayer/productinfo/instructions/)以获取更多说明...

我知道在 Linux 上，至少，你不需要管理员权限。使用ed 安装程序脚本`~/.mozilla/plugins`时会安装 Flash 。`.tar.gz`

在 Windows 上，我*认为*只能选择进行系统范围的安装，因此您需要管理员权限。

根据 Mac 和 Windows 的说明：

> 安装 Adob​​e Flash Player 可能需要对您的 PC 进行管理访问，这通常由您的 IT 部门提供。

*可能*需要？感谢您的明确，Adobe =) 我认为假设他们这样做是安全的，因为它们都是系统集成的安装程序。如果您使用 YUM/RPM 安装程序，Linux 也是如此。如果您使用该脚本，您可以像任何具有执行权限的人一样运行它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-09T10:26:58.963

对于 Mac，答案是“不是真的，但话又说回来，是的”：P

其实他也不需要。在 Mac 上，有一个浏览器插件目录。无论您使用的是 Safari 还是 Firefox（或者可能是其他浏览器），浏览器在该文件夹中搜索其插件都是标准的或 Mac 的。它被命名为：

```
Library/Internet Plug-ins 
```

和 Mac 上的往常一样，这个目录存在两次。曾经作为系统目录

```
/Library/Internet Plug-ins 
```

并且每个用户一次

```
/Users/<username>/Library/Internet Plug-ins 
```

用户将插件放在哪个目录中并不重要，浏览器会同时查看两者。这意味着如果我将它放入系统的库文件夹中，所有用户都将拥有该插件，如果我将其仅放入我的文件夹中，则只有我的用户拥有它。

理论到此为止。实践中的问题是 Adob​​e 不会将 flash 插件作为插件文件提供，您可以将其复制到任一位置（为什么不呢？在 Mac 上，几乎任何应用程序或插件都可以作为文件提供。它真的不会杀死用户手动将其复制到某处），但它附带了一个安装程序（我**讨厌**Mac 上的安装程序）。安装程序希望将其放入所有用户 AFAIK 的系统库文件夹中。为此，它将提示用户提供适当的权限，并且只有管理员用户才能授予这些权限。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T09:48:09.870

**对于 Windows：**是的，您需要系统管理员权限才能安装 Flash Player。通过exe文件安装

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-18T06:45:19.567

我只是设法让它在没有管理员权限的 Mac OS X 上工作。

从 Adob​​e 下载安装程序并确保将其保存在某个位置，而不是让它自动打开。解压缩安装存档，您最终应该会安装“安装 Flash Player 10”。检查里面，但不是打开“Adobe Flash Player.pkg”，而是右键单击该文件以显示包内容。

在弹出的文件夹中，打开 Contents 并查找archive.pax.gz 或resources/adobe flash player.pax.gz，两者似乎都包含相同的内容。解压缩该存档。

您会在其中找到 flashplayer.xpt 和 flash player.plugin。将它们复制到用户/无论您是哪个用户/库/互联网插件...如果您已经在那里看到这些文件，那是正确的地方，只想用新文件替换它们，然后重新启动浏览器。

希望这对你有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T08:22:16.840

**否**如果您使用 Firefox 将 Flash Player 插件的 XPI 存档下载到您的硬盘 [http://fpdownload.macromedia.com/get/flashplayer/xpi/current/flashplayer-win.xpi](http://fpdownload.macromedia.com/get/flashplayer/xpi/current/flashplayer-win.xpi)

将您下载的名为 flashplayer-win.xpi 的文件重命名为 flashplayer-win.zip 提取存档中的文件

# 将文件 flashplayer.xpt 和 NPSWF32.dll 复制到 %APPDATA%\Mozilla\Plugins\

```
* %APPDATA% is the folder which holds your applications profiles and settings.
* You can open this folder simply choosing "Start → Run → Type in %APPDATA% → OK". 
```

# 重启火狐

# sql-server - 在 sql server 中检索日期，CURRENT_TIMESTAMP vs GetDate()

> ID：186572
> 
> 赞同：74
> 
> 时间：2008-10-09T09:47:36.983
> 
> 标签：sql-server, getdate

使用 SQL Server - 这是用于日期检索的最快或最佳实践方法？有区别吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-10-09T09:52:15.540

`CURRENT_TIMESTAMP`是标准的 ANSI SQL，如果您需要移动数据库，理论上是在数千条 SQL Server 特定的 SQL 行中“不需要更改”的一个小岛。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-09T09:52:56.803

`CURRENT_TIMESTAMP`是 ANSI SQL 规范的一部分。`GETDATE()`是 SQL Server 特定的函数，它继承自 SQL Server 所基于的原始 Sybase 代码。

不过，他们做的事情完全相同。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-09T11:11:12.573

我的投票是出于`CURRENT_TIMESTAMP`“可移植性”的原因，即当有直接的 SQL-92 等价物时，为什么要特定于 SQL Server？

PS为什么没有命名`getdatetime()`？既然 SQL Server 2008 有`DATE`和`TIME`数据类型，我们可以希望获得对 SQL-92 的支持`CURRENT_DATE`和`CURRENT_TIME`，此时`getdate()`可能会更加混乱。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-09T09:50:33.953

Books Online 告诉我们`CURRENT_TIMESTAMP`“相当于`GETDATE()`”。

# user-interface - 您什么时候先设计 GUI，然后再设计后端代码，反之亦然？

> ID：186581
> 
> 赞同：12
> 
> 时间：2008-10-09T09:51:42.030
> 
> 标签：user-interface, language-agnostic

当我在做一个项目时，有时我会先设计 GUI，然后编写后端代码以使其工作，但有时我会做相反的事情，一旦系统工作，我就会制作 GUI。您如何选择哪种方式来编码，是否有任何特定类型的项目或环境会偏向您？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T09:55:39.777

您需要创建一些可以让您的测试人员立即开始的东西。试着从这个角度思考。

如果他们正在进行手动 UI 测试，请给他们一个 UI 外壳，其中包含所有功能的存根。如果有要测试的接口，请确保它可以工作（即使它返回虚拟数据），以便他们可以开始使用它，等等。

大多数时候它是用户界面。您可以将其展示给您的用户并立即获得非常有用的反馈。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-09T10:13:59.193

他们真的是齐头并进。如果没有至少对 UI 将涵盖的功能的后端进行基本设计，您就无法设计您的 UI。并且添加了一个新的后端功能，设计的一部分是弄清楚该功能如何向用户公开以及它如何适应现有的工作流程。

顺便说一句，我真的不喜欢快速而肮脏的用户界面“只是为了让测试人员访问该功能”。一旦您构建了 UI，您将很少有时间在项目后期从头开始重新构建它（假设它是按计划进行的项目 :-)）。如果您正在构建一个 UI，请将其构建成像素完美的，即您希望它在交付给客户时的外观。

否则你最终会得到像[这个怪物](http://thedailywtf.com/Articles/Classic_WTF_-_Enter_the_Matrix.aspx)这样的东西。:-)

顺便说一句，如果您需要为可用性测试构建 UI 原型，请确保它是用无法集成到生产代码中的东西构建的。例如，如果您正在编写 C++/C#/Java 代码，则在 Flash 中构建原型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T09:57:46.230

我会假设这取决于项目的类型，是的，我知道这并不是真正的答案，因为他们都这样做。但通常你也可以想象前端想要从后端看到的样子。

我自己会一直关注前端，因为在一天结束时，那是可见的部分。此外，它通常有助于通过可视化了解预期的内容，即使以块形式或通过帖子的形式，它也会记录您想要看到的内容，以及您确实在编码的内容。

当然，如果它是为客户提供的，并且他们事先为您提供视觉效果，这总是有帮助的 :) 这样，只要您匹配视觉效果，您仍然可以带着非视觉相关的后端乐趣去城镇。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T10:19:10.040

既不也不。我们通常将项目拆分为任务。有些任务是构建请求的 UI 的一部分，有些是实现其背后的必要功能的一部分。不同的人从事不同的任务，因此团队的一部分负责 UI，另一部分负责实现其背后的功能。所以我们在 UI 和功能上并行工作。

将任务按正确的顺序排列是很重要的。如果我们已经准备好功能，它是没有用的，但是使用它的 UI 还需要两周时间。为某些东西准备好 UI 也是没有用的，但由于缺少后端功能，它在另外两周内将无法正常工作。

这就是为什么我们尝试指定小的里程碑。在完成当前任务的所有任务之前，没有人会开始着手另一个里程碑。里程碑总是将前端和后端功能组合在一起。因此，如果已达到里程碑，则每个已实现功能的前端都必须准备好，并且每个已实现的后端功能都必须有一个前端来对其进行测试。

然而，在某种意义上，你可以说我们先做后端代码，然后做 UI，因为当说里程碑需要提供 UI 来测试功能时，这并不意味着这是我们将发布的最终 UI。通常在接近尾声时，当几乎所有后端功能都准备好并经过测试时，我们通常会进行 UI 大修。这是因为用于测试的 UI 需要为里程碑做好准备，但它可能并不总是好看或我们最终会发布的 UI。通常，UI 会减慢整个项目的速度（我们的应用程序通常是 UI 密集型的，因为我们不喜欢使用无聊的标准 UI 来制作应用程序，我们想要漂亮的 UI 让你说“哇，这看起来棒极了！”） ，因此我们经常需要实现一个中间 UI 以使 UI 为里程碑和测试做好准备。通常我们会在发布前将 UI 修改为最后一步。因为我们已经有了所有的 UI，如果我们不能修改它的某些部分（因为时间限制）也没什么大不了的，毕竟有一个 UI，它只是不漂亮，但它正在工作和测试。因此，我们将尝试在给定的时间范围内尽可能多地进行改造，始终知道如果我们明天必须停止改造过程，我们就有了一个完全可以工作的、可交付的应用程序。UI 改造只是抛光，IOW 很好，但你也可以在没有它的情况下发布。因此，我们将尝试在给定的时间范围内尽可能多地进行改造，始终知道如果我们明天必须停止改造过程，我们就有了一个完全可以工作的、可交付的应用程序。UI 改造只是抛光，IOW 很好，但你也可以在没有它的情况下发布。因此，我们将尝试在给定的时间范围内尽可能多地进行改造，始终知道如果我们明天必须停止改造过程，我们就有了一个完全可以工作的、可交付的应用程序。UI 改造只是抛光，IOW 很好，但你也可以在没有它的情况下发布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T09:56:28.510

我认为首先编写 GUI 并向最终用户展示一个快速原型有助于分享最终产品的相同愿景。恕我直言，我认为服务器端代码不依赖于 GUI 代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-09T16:13:24.053

要确定这一点，需要提出两个问题：a) 哪个最重要 b) 哪个最难。

如果您正在编写一个订单处理应用程序，那么显然它的成功将更多地取决于用户界面而不是后端代码。所以你可能应该首先设计它，从你的客户那里获得一定程度的认可，然后设计后端以适应它。

还应该说，直到两者都设计完，设计才完成，无论你做什么，都可能涉及重新设计你先做的任何一个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T09:57:28.977

当项目是“数据密集型”（创建、读取、更新和删除元素，显示数据列表）时，我通常更喜欢从后端代码开始。

开发快速原型时首先使用 GUI。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-31T14:55:40.500

我的方法是：

1.  在纸上非常具体地写下我希望应用程序做什么
2.  根据我希望应用程序执行的操作，在纸上绘制应用程序的基本视图
3.  考虑应用程序所需的基本元素
4.  原型应用程序的基本视图，无论是在我正在使用的 SDK 还是原型应用程序上（原型应用程序更好，因为这样可以节省时间，以防万一你在过程中发现你认为的东西没有帮助应用程序的使用）
5.  将原型传输到您的 SDK 并编写代码
6.  研究用户体验“法则”并应用于设计……这就是您可能必须相应地更改代码的地方

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-22T20:55:48.843

您应该首先收集用户或客户的需求，然后对其进行分析。之后，您可以遵循以下设计过程的一般模型：

[![在此处输入图像描述](https://i.stack.imgur.com/cLz14.png)](https://i.stack.imgur.com/cLz14.png)

因此，要进行专业设计，您应该遵循 Ian Sommerville 的软件工程书中声明的这三个层次。

总之，如果我们缩短答案，我们可以说最好的答案是几乎同时进行 GUI 和数据库设计。在对它们进行了许多更改之后；最后，这两种设计几乎同时生产。

# mysql - 哪个最快？SELECT SQL_CALC_FOUND_ROWS FROM `table`，或 SELECT COUNT(*)

> ID：186588
> 
> 赞同：187
> 
> 时间：2008-10-09T09:53:56.067
> 
> 标签：mysql, optimization

当您限制 SQL 查询返回的行数时，通常用于分页，有两种方法可以确定总记录数：

### 方法一

`SQL_CALC_FOUND_ROWS`在原始选项中包含该选项`SELECT`，然后通过运行获取总行数`SELECT FOUND_ROWS()`：

```
SELECT SQL_CALC_FOUND_ROWS * FROM table WHERE id > 100 LIMIT 10;
SELECT FOUND_ROWS(); 
```

### 方法二

正常运行查询，然后通过运行得到总行数`SELECT COUNT(*)`

```
SELECT * FROM table WHERE id > 100 LIMIT 10;
SELECT COUNT(*) FROM table WHERE id > 100; 
```

**哪种方法最好/最快？**

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2008-10-09T18:58:57.933

这取决于。请参阅有关此主题的 MySQL 性能博客文章：[To `SQL_CALC_FOUND_ROWS`or not to `SQL_CALC_FOUND_ROWS`?](https://www.percona.com/blog/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/)

只是一个简短的总结：彼得说这取决于你的索引和其他因素。该帖子的许多评论似乎都说这`SQL_CALC_FOUND_ROWS`几乎总是比运行两个查询慢 - 有时慢 10 倍。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2019-04-16T12:46:17.833

MySQL 从[`SQL_CALC_FOUND_ROWS`](https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_found-rows)8.0.17 版本开始弃用功能。

因此，**始终优先**考虑使用 执行您的查询`LIMIT`，然后使用`COUNT(*)`和不执行第二个查询`LIMIT`以确定是否还有其他行。

来自[文档](https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_found-rows)：

> SQL_CALC_FOUND_ROWS 查询修饰符和随附的 FOUND_ROWS() 函数自 MySQL 8.0.17 起已弃用，并将在未来的 MySQL 版本中删除。
> 
> COUNT(*) 受到某些优化。SQL_CALC_FOUND_ROWS 导致某些优化被禁用。
> 
> 请改用这些查询：
> 
> ```
> SELECT * FROM tbl_name WHERE id > 100 LIMIT 10;
> SELECT COUNT(*) WHERE id > 100; 
> ```

* * *

此外，`SQL_CALC_FOUND_ROWS`已观察到通常存在更多问题，如[MySQL WL# 12615](https://dev.mysql.com/worklog/task/?id=12615)中所述：

> SQL_CALC_FOUND_ROWS 有许多问题。首先，它很慢。通常，使用 LIMIT 运行查询，然后*对同一查询使用单独的 SELECT COUNT( ) 会更便宜，因为 COUNT(* ) 可以利用在搜索整个结果集时无法完成的优化（例如 filesort可以跳过 COUNT(*)，而使用 CALC_FOUND_ROWS，我们必须禁用一些文件排序优化以保证正确的结果）
> 
> 更重要的是，它在许多情况下具有非常不明确的语义。特别是，当一个查询有多个查询块（例如使用 UNION）时，根本没有办法在生成有效查询的同时计算“本来”的行数。随着迭代器执行器向这些类型的查询发展，尝试保留相同的语义确实很困难。此外，如果查询中有多个 LIMIT（例如，对于派生表），则不一定清楚 SQL_CALC_FOUND_ROWS 应该引用哪一个。因此，与以前相比，这种不平凡的查询必然会在迭代器执行器中获得不同的语义。
> 
> 最后，SQL_CALC_FOUND_ROWS 看起来有用的大多数用例应该简单地通过 LIMIT/OFFSET 以外的其他机制来解决。例如，电话簿应该按字母分页（无论是在用户体验方面还是在索引使用方面），而不是记录号。讨论越来越多地按日期无限滚动（再次允许使用索引），而不是按帖子编号分页。等等。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-12-19T18:19:05.587

在选择“最佳”方法时，比速度更重要的考虑因素可能是代码的可维护性和正确性。如果是这样，最好使用 SQL_CALC_FOUND_ROWS，因为您只需要维护一个查询。使用单个查询完全排除了主查询和计数查询之间存在细微差异的可能性，这可能导致 COUNT 不准确。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-06-22T14:54:16.483

根据以下文章：[https ://www.percona.com/blog/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/](https://www.percona.com/blog/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/)

如果你的 where 子句上有一个*INDEX*（如果 id 在你的情况下被索引），那么最好不要使用**SQL_CALC_FOUND_ROWS**而是使用 2 个查询，但是如果你没有关于你在 where 子句中放入的内容的索引（在您的情况下为 id）然后使用**SQL_CALC_FOUND_ROWS**更有效。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-08-04T17:36:26.570

恕我直言，2个查询的原因

```
SELECT * FROM count_test WHERE b = 666 ORDER BY c LIMIT 5;
SELECT count(*) FROM count_test WHERE b = 666; 
```

比使用 SQL_CALC_FOUND_ROWS 更快

```
SELECT SQL_CALC_FOUND_ROWS * FROM count_test WHERE b = 555 ORDER BY c LIMIT 5; 
```

必须被视为一个特例。

它实际上取决于 WHERE 子句的选择性与隐含的选择性相比，相当于 ORDER + LIMIT。

正如 Arvids 在评论中所说（[http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/#comment-1174394](http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/#comment-1174394)），说明使用与否的事实，一个临时表，应该是了解 SCFR 是否会更快的良好基础。

但是，正如我添加的（[http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/#comment-8166482](http://www.mysqlperformanceblog.com/2007/08/28/to-sql_calc_found_rows-or-not-to-sql_calc_found_rows/#comment-8166482)），结果真的，真的取决于具体情况。对于特定的分页器，您可以得出这样的结论：“对于 3 个首页，使用 2 个查询；对于以下页面，请使用 SCFR”！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-04-07T19:53:39.570

删除一些不必要的 SQL 然后`COUNT(*)`会比`SQL_CALC_FOUND_ROWS`. 例子：

```
SELECT Person.Id, Person.Name, Job.Description, Card.Number
FROM Person
JOIN Job ON Job.Id = Person.Job_Id
LEFT JOIN Card ON Card.Person_Id = Person.Id
WHERE Job.Name = 'WEB Developer'
ORDER BY Person.Name 
```

然后计算没有不必要的部分：

```
SELECT COUNT(*)
FROM Person
JOIN Job ON Job.Id = Person.Job_Id
WHERE Job.Name = 'WEB Developer' 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-04-29T19:16:02.327

您可以使用其他选项进行基准测试：

**1.)**窗口函数将直接返回实际大小（在 MariaDB 中测试）：

```
SELECT 
  `mytable`.*,
  COUNT(*) OVER() AS `total_count`
FROM `mytable`
ORDER BY `mycol`
LIMIT 10, 20 
```

**2.)**开箱即用，大多数时候用户不需要知道表格的*确切*大小，一个近似值通常就足够了。

```
SELECT `TABLE_ROWS` AS `rows_approx`
FROM `INFORMATION_SCHEMA`.`TABLES`
WHERE `TABLE_SCHEMA` = DATABASE()
  AND `TABLE_TYPE` = "BASE TABLE"
  AND `TABLE_NAME` = ? 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-16T19:19:55.943

具有 2.000.000 行的表上的简单示例，查询如下：

```
select fieldname 
from table_add 
where 
descryption_per like '%marihuana%' 
or addiction_per like '%alkohol%'; 
```

这是一个全表扫描每个查询 - 所以它需要时间 x 2。我的意思是“从......中选择计数（*）

# visual-studio-2008 - 让 Visual Studio 跨线程抛出异常

> ID：186600
> 
> 赞同：0
> 
> 时间：2008-10-09T09:58:30.723
> 
> 标签：visual-studio-2008, multithreading, exception, silverlight-2-rc0

在我的 Silverlight 项目中，我有一个每 x 毫秒触发一次的线程。在这个线程中，我试图更改应用程序的状态。这不起作用，我不知道为什么，所以在 Timer 回调中设置一个断点。断点被击中，但在我尝试更改状态的那一刻，它刚刚退出了函数（假设已引发异常）。

我知道*为什么*会发生错误 - 您无法通过非 GUI 线程更改 GUI 内容。

我的问题是 - 当发生这样的异常时，如何让 Visual Studio 真正中断？（而不是只是默默地救助，如果有问题不会通知我）。

我已经尝试过“当异常跨越 AppDomain 或托管/本机边界时中断”，但这没有任何效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T10:04:35.577

您能否更改 InvalidOperationException 的中断处理，使其立即中断而不是仅在未处理时中断？

# php - Zend 框架 fetchAll

> ID：186606
> 
> 赞同：5
> 
> 时间：2008-10-09T10:01:16.053
> 
> 标签：php, zend-framework, model, overriding, fetchall

我可以覆盖模型中的 fetchall 方法吗？每次调用 fetchAll 时我都需要检查一下。该模型扩展了 Zend_db_table_abstract

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-13T16:02:15.873

要覆盖这个方法，您需要继承 Zend_Db_Table_Abstract。像这样：

```
<?php
abstract class My_Db_Table_Abstract extends Zend_Db_Table_Abstract
{
    ...

    public function fetchAll($where, $order)
    {
        ...
    }

    ...
} 
```

然后确保您的模型改为扩展 My_Db_Table_Abstract。这样，您将始终继承覆盖的 fetchAll 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-23T13:33:32.687

是的。只需在模型中定义一个新的 fetchAll() 方法，其结构与 Zend_db_table_abstract 方法相同（即相同的输入/输出），然后在方法结束时调用父方法：

父::fetchAll($params)

安德鲁

# java - 如何设置 Eclipse TPTP

> ID：186615
> 
> 赞同：10
> 
> 时间：2008-10-09T10:05:34.327
> 
> 标签：java, eclipse, jakarta-ee, profiling

我需要为客户分析一个 java 应用程序。这是一个 eclipse/maven 项目，所以我决定使用 eclipse TPTP ( [http://www.eclipse.org/tptp](http://www.eclipse.org/tptp) )。

我尝试通过标准 Eclipse 安装中的更新管理器安装 Eclipse TPTP，但由于令人难以置信的复杂设置和下载名称非常神秘的依赖项，我放弃了。

[然后我从http://www.eclipse.org/tptp/home/downloads/?ver=4.5.1](http://www.eclipse.org/tptp/home/downloads/?ver=4.5.1)下载了“all in one TPTP 4.5.1”包，但是当我启动它时，它弹出一个错误说“Eclipse 可执行启动器无法找到它的配套共享库”。

我正在运行 Windows XP、Sun Java 1.5，并在解压的 eclipse TPTP 安装中单击“eclipse.exe”。

我需要做什么才能让 Eclipse TPTP 运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T06:33:14.733

[VisualVM 1.1.1](https://visualvm.dev.java.net/)是使用 NetBeans 的一个很好的替代方案，它是一个独立的应用程序，因此您不必将 Maven/Ant/Eclipse 项目带入它的项目格式。它可以在打开时看到任何本地 Java 进程，因此只需在 Java 进程列表中双​​击您的应用程序即可。你可以：

1.  进行堆转储
2.  比较内存快照
3.  [使用 VisualGC 插件查看垃圾收集](https://visualvm.dev.java.net/plugins.html)
4.  [运行 BTrace 脚本](https://btrace.dev.java.net/)为您的代码添加运行时分析和调试建议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T18:32:18.907

如果您更新到 Java 1.6u7 或更高版本，您将可以访问与 Netbeans Profiler 基本相同的 VisualVM 工具。

我尝试使用 Eclipse 测试和性能工具包，但它的效果不如 Netbeans 分析器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T13:48:34.563

另一种方法是使用 Netbeans 来分析 Eclipse 应用程序。

我在下面的链接上有一篇博文，解释了如何配置这两个应用程序：

[http://www.jroller.com/ortegon/entry/on_profiling_eclipse_rcp_applications](http://www.jroller.com/ortegon/entry/on_profiling_eclipse_rcp_applications)

它工作得很好。一年多以来，我一直在以这种方式进行分析。易于使用，易于设置和漂亮的图形也。

我发现安装 TPTP 很痛苦，至少我使用的版本没有很好地与 Eclipse 集成。我花了很长时间才让它正常工作。Netbeans 的学习和跟上速度要快得多。在较新的版本中，还可以使用特殊的 netbeans 插件导入 Eclipse 项目的源代码（尽管需要单独下载）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T14:59:00.553

真奇怪。我已经尝试了多合一的程序包，它在带有 Java 1.5 的 Windows XP 上运行没有问题。难道你不能使用 64 位版本的 Windows 吗？也许这可能是问题的原因。

我个人不太使用TPTP。我认为 NetBeans 分析器提供了更多（至少更易于理解）的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T12:28:03.243

[也许尝试从http://www.eclipse.org/tptp/home/downloads/?ver=4.5.1](http://www.eclipse.org/tptp/home/downloads/?ver=4.5.1)下载“Java 1.5+ (JVMTI) Profiler SDK”（运行时）

我也认为 IBM 最新的 Rational Developer 集成了这项技术（有 60 天试用期）。您可以在那里看到他们如何配置它。

# unit-testing - 如何对伪随机数生成器进行单元测试？

> ID：186619
> 
> 赞同：35
> 
> 时间：2008-10-09T10:06:43.390
> 
> 标签：unit-testing, random

我有一个要进行单元测试的伪随机数生成器 (PRNG) 类。有两种方法：

1.  编写一个需要大量样本的测试用例，并测试它们是否分布正确。这种方法可能会导致测试用例的执行时间相当长；
2.  “手动”计算一小部分样本并验证 PRNG 算法是否重现它。这种方法可能会导致在不被注意的情况下生成非随机序列；

我想说第一种方法不是真正的单元测试，因为它不执行生成器的白盒测试，但另一方面它正确地测试了类的责任。第二种方法更像是一个真正的单元测试，专注于算法，但它并没有提供太多的证据来证明类是否履行了它的职责。

你更喜欢哪种方法，为什么？

* * *

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-09T10:12:01.520

获取相同 PRNG 算法的另一个实现，根据已知种子生成少量较长的测试用例，并验证您的算法实现与其他所有人的实现相匹配。你测试的数据越多，它的机会就越大。如果您想认真，请查看如何为算法完成 FIPS 验证。

无需测试输出是否是随机的，因为其他人对该算法所做的研究远远超出了您的复制能力。

如果您已经发明了自己的 PRNG 算法，那么您将遇到一个完全不同的问题，因为除了测试您的代码之外，您还需要测试您的新算法。有很多事情要做——我认为最重要的是对输出的统计测试，以及其他密码学家的同行评审。但是，基本上，如果您要设计一个 PRNG 算法而没有足够的领域知识来知道如何测试它，那么它将是垃圾。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-09T10:09:43.913

为了测试 PRNG，我会使用[ENT](http://fourmilab.ch/random/)，它是一套统计测试，可以告诉您 PRNG 的执行情况。我想这是方法1。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T10:10:59.947

我想最终你会想要两个测试 - 因为你想确保以下两个都成立：

(1) 数字分布正确，(2) 特定算法按预期工作。

也许第一个测试只能偶尔运行，而第二个可以用来检查任何代码更改是否没有破坏算法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T10:32:37.237

我相信您的第一点（＃1）在测试生成的随机数的质量时会得到更多，这是由所使用的算法决定的。第二点（＃2）在测试算法的*实现*方面得到更多。如果您设计了算法，那么这两个测试都很重要。如果你实现了一个表现出性能的算法，#2 应该就足够了。虽然，我可能会使用您的特定生成器结构的一些知识来测试多个种子和序列。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T12:08:01.023

伪随机数生成器中的“随机性”通常表示为一个数字重复之前的平均迭代次数。有许多算法具有不同的“随机性”和性能。 [Random.org](http://www.random.org/analysis/)很好地解释了对其算法进行的一些分析。查看页面一半左右的图片。在静态图像中很容易看出这两种算法的随机性。

PRNG 的一个特性（一个真正的特性，而不是伪装成特性的错误）是它是可预测的。对于给定的种子，应该产生相同的数字序列。这对于测试和调试使用随机（又名随机）方法的程序非常重要和必要。

数列应该近似于某种统计分布。通过生成一个大序列（比如 10^6 个数字）来测试您的 PRNG，并对序列执行多个统计测试，尤其是卡方检验（如果分布正常）。制作样本的直方图，看看它是否看起来像您期望的那样。

如果控制种子的设置方式，那么每次生成的序列应该是一样的，适合做白盒测试。在进行测试时，在收集样本之前运行生成器大约 100 次迭代来“预热”生成器也是一个好主意。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-18T19:34:28.683

这是一篇[CodeProject 文章](http://www.codeproject.com/KB/recipes/SimpleRNG.aspx)，其中包括 Donald Knuth 的第 2 卷半数值算法中提到的 Kolmogorov-Smirnov 测试的实现。正如上面提到的 InSciTek Jeff，有两个问题：测试算法和测试算法的实现。KS 测试可能会发现实现中的错误，它是测试算法本身质量的良好开端。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-09T11:07:14.093

请注意：如果您“发明”了您的 PRNG，那么您可能会弄错并产生一些分布不理想的东西。生成器随机性的基本测试是卡方检验

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-09T22:24:47.673

您可能会发现对[这个问题](https://stackoverflow.com/questions/56411/how-to-test-randomness-case-in-point-shuffling)的一些回答很有用。

基本上，您无法“证明”RNG 是随机的，但您可以执行各种测试来提高您的信心。这些测试的复杂性各不相同。 [顽固分子](http://stat.fsu.edu/pub/diehard/)是全面的，但它并没有真正提供是/否的答案，更像是几百个“也许”。在频谱的另一端，生成一系列值（至少 10,000 个）然后检查均值和标准偏差/方差是否[符合预期](http://en.wikipedia.org/wiki/Uniform_distribution_(discrete))非常简单。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-12-16T13:57:09.780

一种方法是将其输出通过管道传输到[PractRand](http://pracrand.sourceforge.net/)。

如果 PractRand 说 PRNG 的输出没问题，那么 PRNG 真的没问题吗？我没有资格判断，但我能说的是 PRNG 足够严格，以至于它认为我在文献或网上找到的各种 LFSR 和 xor-and-shift 算法的输出不能令人满意，并且认为输出还可以RP Brent 的 xorgens。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T10:37:51.423

严格来说，没有办法测试随机生成器是否真的是随机的 :-) 第一种方法让您知道它是否仅适用于固定数量的样本，无论这个数量有多大。第二种方法可以支持它是否像算法一样表现的知识，但同样适用于固定数量的样本。

你能做的最好的 - 使用两者。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T11:45:01.770

除非您正在实施给定的 PNRG 算法，否则无法判断数字是随机的，这就是随机性的本质。是的，平均而言，当您的数字生成器趋向无穷大时，它会变得均匀，但您不会测试无限次数的迭代。

如果您正在实施一个已知算法，请检查前几千个数字是否与给定一组种子提供的结果相匹配。虽然可能的种子数量是无限的，但无法确定。

你甚至无法从数学上证明一个数字序列是随机的......

XKCD

![替代文字](https://imgs.xkcd.com/comics/random_number.png)

迪尔伯特

![替代文字](https://web.archive.org/web/20011027002011/http://dilbert.com/comics/dilbert/archive/images/dilbert2001182781025.gif)

被改装下来...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-18T19:59:44.420

回到学校的时候，我正在为模拟作业开发一个随机数生成器，并且需要一些方法来识别非随机性。

我想到了取两个随机数并将它们绘制成图形（x，y）的好主意。人类大脑如何能够检测到非随机模式真是令人惊讶。（“随机模式”是矛盾的。）

我调整了 PRNG 以删除图表上出现的条纹和星爆，然后绘制 (log(x), log(y)) 以获得全新的视角并重复该过程。

后来，我被迫进行统计，并了解到你可以做一些奇怪的数学来量化随机性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-26T22:49:23.673

Random.org 使用这个测试套件：[http ://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html](http://csrc.nist.gov/groups/ST/toolkit/rng/documentation_software.html)

您可以在以下位置下载软件（unix 和 mac os x）：[http ://csrc.nist.gov/groups/ST/toolkit/rng/documents/sts-2.1.1.zip](http://csrc.nist.gov/groups/ST/toolkit/rng/documents/sts-2.1.1.zip)

文档在这里：[http ://csrc.nist.gov/groups/ST/toolkit/rng/documents/SP800-22rev1a.pdf](http://csrc.nist.gov/groups/ST/toolkit/rng/documents/SP800-22rev1a.pdf)

# tomcat - 如何使用嵌入在 Tomcat 应用程序中的 jython 动态添加 jar？

> ID：186621
> 
> 赞同：2
> 
> 时间：2008-10-09T10:06:59.240
> 
> 标签：tomcat, classpath, jython

我想让我的应用程序的用户，这又是一个应用程序容器（应用程序包含子应用程序），将 java jar 添加到他们的 jython 路径。

我让子应用管理器在 jython 中编写自己的扩展，但是他们想要添加的一些功能需要额外的 jar。例如，如果他们想检查 svn 存储库，他们需要 svn 访问 jar，我宁愿不将其复制到 /WEB-INF/lib，而是复制到 /subapps/appX/lib。

虽然我可以将类目录结构添加到 sys.path，但似乎我无法添加 jar。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T12:52:46.267

这很有趣。它在命令行中不起作用，但在从 tomcat 尝试时会起作用。缓存可能会有延迟吗？

在命令行中，如果我尝试不存在的导入，缓存管理器会显示为新添加的 jar 找到的新包。然后它就起作用了*。*

# datetime - VB6 日期数据类型：精度和格式

> ID：186622
> 
> 赞同：4
> 
> 时间：2008-10-09T10:07:23.607
> 
> 标签：内存泄漏, datetime, vb6, formatting, types

1.  VB6 数据类型有多精确`Date`（以几分之一秒计）？
2.  如何格式化它以显示几分之一秒？

经过多年的缺席，我正在重温VB6，而我这辈子都不记得我曾经知道的事情了。我考虑在这上面贴上[内存泄漏](/questions/tagged/memory-leak "显示标记为“内存泄漏”的问题")标签，因为我的内存泄漏了（呼呼呼）。

之后我发现了这个 API 调用，它似乎有效：

```
Declare Sub GetSystemTime Lib "kernel32.dll" (lpSystemTime As SystemTime)

Public Type SystemTime
  Year As Integer
  Month As Integer
  DayOfWeek As Integer
  Day As Integer
  Hour As Integer
  Minute As Integer
  Second As Integer
  Milliseconds As Integer
End Type 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T12:34:51.733

`Date`数据类型基于具有范围检查（最小/最大日期值）的数据`Double`类型加上考虑的纪元。换句话说，它并没有什么特别之处，尤其是考虑到 VBA 不是一种强类型语言。

如果您认为时间是连续的（并且您应该考虑 IMO），那么 a`Double`是一个很好的选择。一天 = 1（整数）的双精度浮点的精度实际上是九位小数。因此 type 的值`Double`（因此 type `Date`）可以轻松地容纳亚秒级的值。

但是，您面临的问题是 VBA 中的时间函数（`Now`、`DateSerial`、`DateDiff`等`DateAdd`）的最小粒度为**1 秒**。如果您将它们与`Double`以亚秒精度存储的日期值一起使用，您将体验到四舍五入到一秒。为 VBA6 编写的用户控件等也是如此。

当然，您*可以*编写自己的时间函数实现（我记得必须实现包装类`StdDataFormat`，以便读取/写入亚秒级 SQL Server 值，而无需在 VBA 中四舍五入到 MS 数据网格），但它会开始感觉就像您正在滚动自己的时间数据类型（哎哟！）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T10:30:32.157

1) 仅几秒钟，并且

2）没有办法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T10:27:09.807

我认为 VB6 中的日期数据类型不能处理几分之一秒。

# wcf - WCF 服务的 REST / SOAP 端点

> ID：186631
> 
> 赞同：432
> 
> 时间：2008-10-09T10:11:30.150
> 
> 标签：wcf, rest, soap

我有一个 WCF 服务，我想将它作为 RESTfull 服务和 SOAP 服务公开。以前有人做过这样的事情吗？

* * *

## 回答 #1

> 赞同：590
> 
> 时间：2008-10-09T10:39:29.563

您可以在两个不同的端点中公开服务。SOAP 可以使用支持 SOAP 的绑定，例如 basicHttpBinding，RESTful 可以使用 webHttpBinding。我假设您的 REST 服务将采用 JSON 格式，在这种情况下，您需要使用以下行为配置来配置两个端点

```
<endpointBehaviors>
  <behavior name="jsonBehavior">
    <enableWebScript/>
  </behavior>
</endpointBehaviors> 
```

您的场景中的端点配置示例是

```
<services>
  <service name="TestService">
    <endpoint address="soap" binding="basicHttpBinding" contract="ITestService"/>
    <endpoint address="json" binding="webHttpBinding"  behaviorConfiguration="jsonBehavior" contract="ITestService"/>
  </service>
</services> 
```

因此，该服务将在

*   [http://www.example.com/soap](http://www.example.com/soap)
*   [http://www.example.com/json](http://www.example.com/json)

将 [WebGet] 应用于操作合约，使其成为 RESTful。例如

```
public interface ITestService
{
   [OperationContract]
   [WebGet]
   string HelloWorld(string text)
} 
```

注意，如果 REST 服务不是 JSON 格式，则操作的参数不能包含复杂类型。

## 回复 SOAP 和 RESTful POX(XML) 的帖子

对于作为返回格式的普通旧 XML，这是一个适用于 SOAP 和 XML 的示例。

```
[ServiceContract(Namespace = "http://test")]
public interface ITestService
{
    [OperationContract]
    [WebGet(UriTemplate = "accounts/{id}")]
    Account[] GetAccount(string id);
} 
```

**REST普通旧 XML**的 POX 行为****

 **```
<behavior name="poxBehavior">
  <webHttp/>
</behavior> 
```

**端点**

```
<services>
  <service name="TestService">
    <endpoint address="soap" binding="basicHttpBinding" contract="ITestService"/>
    <endpoint address="xml" binding="webHttpBinding"  behaviorConfiguration="poxBehavior" contract="ITestService"/>
  </service>
</services> 
```

服务将在

*   [http://www.example.com/soap](http://www.example.com/soap)
*   [http://www.example.com/xml](http://www.example.com/xml)

**REST 请求** 在浏览器中尝试，

> [http://www.example.com/xml/accounts/A123](http://www.example.com/xml/accounts/A123)

**添加服务引用后 SOAP 服务的**SOAP 请求客户端端点配置，****

 **```
 <client>
    <endpoint address="http://www.example.com/soap" binding="basicHttpBinding"
      contract="ITestService" name="BasicHttpBinding_ITestService" />
  </client> 
```

在 C# 中

```
TestServiceClient client = new TestServiceClient();
client.GetAccount("A123"); 
```

另一种方法是公开两个不同的服务合同，每个服务合同都有特定的配置。这可能会在代码级别生成一些重复项，但是在一天结束时，您希望使其正常工作。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2010-02-19T11:28:51.340

这篇文章已经有“社区维基”的一个很好的回答，我也推荐看一下 Rick Strahl 的网络博客，有很多关于 WCF Rest 的好文章[这样](http://west-wind.com/weblog/posts/896411.aspx)的。

我用两者来获得这种 MyService 服务......然后我可以使用来自 jQuery 的 REST 接口或来自 Java 的 SOAP。

这是来自我的 Web.Config：

```
<system.serviceModel>
 <services>
  <service name="MyService" behaviorConfiguration="MyServiceBehavior">
   <endpoint name="rest" address="" binding="webHttpBinding" contract="MyService" behaviorConfiguration="restBehavior"/>
   <endpoint name="mex" address="mex" binding="mexHttpBinding" contract="MyService"/>
   <endpoint name="soap" address="soap" binding="basicHttpBinding" contract="MyService"/>
  </service>
 </services>
 <behaviors>
  <serviceBehaviors>
   <behavior name="MyServiceBehavior">
    <serviceMetadata httpGetEnabled="true"/>
    <serviceDebug includeExceptionDetailInFaults="true" />
   </behavior>
  </serviceBehaviors>
  <endpointBehaviors>
   <behavior name="restBehavior">
    <webHttp/>
   </behavior>
  </endpointBehaviors>
 </behaviors>
</system.serviceModel> 
```

这是我的服务类（.svc-codebehind，不需要接口）：

```
 /// <summary> MyService documentation here ;) </summary>
[ServiceContract(Name = "MyService", Namespace = "http://myservice/", SessionMode = SessionMode.NotAllowed)]
//[ServiceKnownType(typeof (IList<MyDataContractTypes>))]
[ServiceBehavior(Name = "MyService", Namespace = "http://myservice/")]
public class MyService
{
    [OperationContract(Name = "MyResource1")]
    [WebGet(ResponseFormat = WebMessageFormat.Xml, UriTemplate = "MyXmlResource/{key}")]
    public string MyResource1(string key)
    {
        return "Test: " + key;
    }

    [OperationContract(Name = "MyResource2")]
    [WebGet(ResponseFormat = WebMessageFormat.Json, UriTemplate = "MyJsonResource/{key}")]
    public string MyResource2(string key)
    {
        return "Test: " + key;
    }
} 
```

实际上，我只使用 Json 或 Xml，但这两者都是出于演示目的。这些是获取数据的 GET 请求。要插入数据，我会使用带有属性的方法：

```
[OperationContract(Name = "MyResourceSave")]
[WebInvoke(Method = "POST", ResponseFormat = WebMessageFormat.Json, UriTemplate = "MyJsonResource")]
public string MyResourceSave(string thing){
    //... 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2010-08-18T01:52:13.803

如果您只想开发单个 Web 服务并将其托管在许多不同的端点上（即 SOAP + REST，带有 XML、JSON、CSV、HTML 输出）。您还应该考虑使用我专门为此目的而构建的**[ServiceStack](http://www.servicestack.net)**，您开发的每项服务都可以在 SOAP 和 REST 端点上自动提供，开箱即用，无需任何配置。

[Hello World](http://www.servicestack.net/ServiceStack.Hello/)示例展示了如何创建一个简单的with 服务（无需配置）：

```
public class Hello {
    public string Name { get; set; }
}

public class HelloResponse {
    public string Result { get; set; }
}

public class HelloService : IService
{
    public object Any(Hello request)
    {
        return new HelloResponse { Result = "Hello, " + request.Name };
    }
} 
```

无需其他配置，该服务可立即通过 REST 使用：

*   肥皂
*   [XML](http://www.servicestack.net/ServiceStack.Hello/hello/World!?format=xml)
*   [JSON](http://www.servicestack.net/ServiceStack.Hello/hello/World!?format=json)
*   [HTML](http://www.servicestack.net/ServiceStack.Hello/hello/World!)

它还内置[了友好的 HTML 输出（当使用具有](https://github.com/ServiceStack/ServiceStack/wiki/HTML5ReportFormat)**Accept:text/html**例如浏览器的 HTTP 客户端调用时），因此您能够更好地可视化服务的输出。

处理不同的 REST 动词也很简单，这是一个完整的 REST 服务 CRUD 应用程序，位于 C# 的 1 页中（少于配置 WCF 所需的时间；）：

*   [前端 TODO 应用](http://www.servicestack.net/Backbone.Todos/)
*   [后端 REST 服务实现](https://github.com/ServiceStack/ServiceStack.Examples/blob/master/src/Backbone.Todos/Global.asax.cs)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-11-12T17:53:53.087

MSDN现在似乎有一篇文章：

[https://msdn.microsoft.com/en-us/library/bb412196(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/bb412196(v=vs.110).aspx)

介绍：

> 默认情况下，Windows Communication Foundation (WCF) 使终结点仅对 SOAP 客户端可用。在如何：创建基本 WCF Web HTTP 服务中，端点可供非 SOAP 客户端使用。有时您可能希望以两种方式提供相同的合同，作为 Web 端点和作为 SOAP 端点。本主题显示了如何执行此操作的示例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-02-05T01:20:31.203

我们必须将行为配置定义到**REST**端点

```
<endpointBehaviors>
  <behavior name="restfulBehavior">
   <webHttp defaultOutgoingResponseFormat="Json" defaultBodyStyle="Wrapped" automaticFormatSelectionEnabled="False" />
  </behavior>
</endpointBehaviors> 
```

还有服务

```
<serviceBehaviors>
   <behavior>
     <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
   </behavior>
</serviceBehaviors> 
```

在行为之后，下一步是绑定。例如 basicHttpBinding 到**SOAP**端点和 webHttpBinding 到**REST**。

```
<bindings>
   <basicHttpBinding>
     <binding name="soapService" />
   </basicHttpBinding>
   <webHttpBinding>
     <binding name="jsonp" crossDomainScriptAccessEnabled="true" />
   </webHttpBinding>
</bindings> 
```

最后，我们必须在服务定义中定义 2 端点。注意端点的地址=“”，REST服务在哪里是没有必要的。

```
<services>
  <service name="ComposerWcf.ComposerService">
    <endpoint address="" behaviorConfiguration="restfulBehavior" binding="webHttpBinding" bindingConfiguration="jsonp" name="jsonService" contract="ComposerWcf.Interface.IComposerService" />
    <endpoint address="soap" binding="basicHttpBinding" name="soapService" contract="ComposerWcf.Interface.IComposerService" />
    <endpoint address="mex" binding="mexHttpBinding" name="metadata" contract="IMetadataExchange" />
  </service>
</services> 
```

在服务的接口中，我们使用其属性定义操作。

```
namespace ComposerWcf.Interface
{
    [ServiceContract]
    public interface IComposerService
    {
        [OperationContract]
        [WebInvoke(Method = "GET", UriTemplate = "/autenticationInfo/{app_id}/{access_token}", ResponseFormat = WebMessageFormat.Json,
            RequestFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.Wrapped)]
        Task<UserCacheComplexType_RootObject> autenticationInfo(string app_id, string access_token);
    }
} 
```

加入各方，这将是我们的 WCF system.serviceModel 定义。

```
<system.serviceModel>

  <behaviors>
    <endpointBehaviors>
      <behavior name="restfulBehavior">
        <webHttp defaultOutgoingResponseFormat="Json" defaultBodyStyle="Wrapped" automaticFormatSelectionEnabled="False" />
      </behavior>
    </endpointBehaviors>
    <serviceBehaviors>
      <behavior>
        <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
        <serviceDebug includeExceptionDetailInFaults="false" />
      </behavior>
    </serviceBehaviors>
  </behaviors>

  <bindings>
    <basicHttpBinding>
      <binding name="soapService" />
    </basicHttpBinding>
    <webHttpBinding>
      <binding name="jsonp" crossDomainScriptAccessEnabled="true" />
    </webHttpBinding>
  </bindings>

  <protocolMapping>
    <add binding="basicHttpsBinding" scheme="https" />
  </protocolMapping>

  <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />

  <services>
    <service name="ComposerWcf.ComposerService">
      <endpoint address="" behaviorConfiguration="restfulBehavior" binding="webHttpBinding" bindingConfiguration="jsonp" name="jsonService" contract="ComposerWcf.Interface.IComposerService" />
      <endpoint address="soap" binding="basicHttpBinding" name="soapService" contract="ComposerWcf.Interface.IComposerService" />
      <endpoint address="mex" binding="mexHttpBinding" name="metadata" contract="IMetadataExchange" />
    </service>
  </services>

</system.serviceModel> 
```

要测试这两个端点，我们可以使用**WCFClient**到**SOAP**和**PostMan**到**REST**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-08T09:06:47.923

这就是我为使它工作所做的。确保将
**webHttp automaticFormatSelectionEnabled="true"**放入端点行为中。

```
[ServiceContract]
public interface ITestService
{

    [WebGet(BodyStyle = WebMessageBodyStyle.Bare, UriTemplate = "/product", ResponseFormat = WebMessageFormat.Json)]
    string GetData();
}

public class TestService : ITestService
{
    public string GetJsonData()
    {
        return "I am good...";
    }
} 
```

内部服务模型

```
 <service name="TechCity.Business.TestService">

    <endpoint address="soap" binding="basicHttpBinding" name="SoapTest"
      bindingName="BasicSoap" contract="TechCity.Interfaces.ITestService" />
    <endpoint address="mex"
              contract="IMetadataExchange" binding="mexHttpBinding"/>
    <endpoint behaviorConfiguration="jsonBehavior" binding="webHttpBinding"
              name="Http" contract="TechCity.Interfaces.ITestService" />
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost:8739/test" />
      </baseAddresses>
    </host>
  </service> 
```

端点行为

```
 <endpointBehaviors>
    <behavior name="jsonBehavior">
      <webHttp automaticFormatSelectionEnabled="true"  />
      <!-- use JSON serialization -->
    </behavior>
  </endpointBehaviors> 
```

# asp.net - window.showModalDialog 页面加载未执行

> ID：186633
> 
> 赞同：2
> 
> 时间：2008-10-09T10:12:37.777
> 
> 标签：asp.net, asp.net-1.1

我实际上正在将页面作为模式对话框加载为 window.showModalDialog("url.aspx")。第一次弹出模式对话框时会调用页面加载事件。当我关闭它并再次调用它时，控件不会进入 PageLoad。相反，页面会弹出所有控件中的先前值。

我实际上希望每次弹出模式对话框时触发 PageLoad。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T10:50:13.550

好的....你知道 showModalDialog 是专有的 IE 唯一功能吗？只要您知道这一点，那么我认为您可能需要向您正在使用的 url 添加一个唯一的查询字符串值，以避免显示缓存版本。因此生成一个随机数并将其附加到 url，例如 url.aspx?rnd=12237827348273。这应该会破坏缓存并发出新的请求

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T09:43:20.710

`InPage`在表单中应用以下指令：

```
<%@ OutputCache Location="None" %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-31T05:23:13.597

Firefox 3 支持[https://developer.mozilla.org/en/DOM/window.showModalDialog](https://developer.mozilla.org/en/DOM/window.showModalDialog)

# .net - 在 Silverlight 2.0 beta 中导致 System.ArgumentException 的延迟初始化

> ID：186634
> 
> 赞同：1
> 
> 时间：2008-10-09T10:12:55.390
> 
> 标签：.net, silverlight, silverlight-2.0

我在一个简单的 Silverlight 页面中运行了以下示例：

```
public Page()
{
  InitializeComponent();
  InitializeOther();
}

private DoubleCollection dashes;

public DoubleCollection Dashes
{
  get
  {
    //dashes = new DoubleCollection(); //works ok
    //dashes.Add(2.0);
    //dashes.Add(2.0);

    if (dashes == null)
    {
      dashes = new DoubleCollection(); //causes exception
      dashes.Add(2.0);
      dashes.Add(2.0);
    }
    return dashes;
  }
  set
  {
    dashes = value;
  }
}

private void InitializeOther()
{
  Line line;
  for (int i = 0; i < 10; i++)
  {
    line = new Line();
    line.Stroke = new SolidColorBrush(Colors.Blue);
    line.StrokeDashArray = Dashes; //exception thrown here
    line.X1 = 10;
    line.Y2 = 10;
    line.X2 = 400;
    line.Y2 = 10 + (i * 40);
    canvas1.Children.Add(line);
  }
} 
```

上面的代码在标记的行上抛出 System.ArgumentException。示例中还标记了该问题的一种解决方案。

有谁知道这个问题是否与属性 System.Windows.Shapes.Shape.StrokeDashArray 是一个依赖属性有关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T15:08:16.480

感谢您的回答和评论。

我可以在 WPF 应用程序中运行完全相同的代码并且它不会失败。对我来说，这清楚地表明这是一个 Silverlight 错误。我现在认为它与依赖属性没有任何关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T13:24:14.270

StrokeDashArray 是一个依赖属性这一事实不应该与该代码失败有任何关系，因为在 XAML 中，您不断设置在 InitializeComponent 中解析期间处理的依赖属性。

我会说问题是在您的代码中，您为每一行重用了相同的双集合。每当您尝试将子项设置为不同的父项时，SL 都会因参数异常而失败，当您重用不是样式的资源时也是如此。似乎每一行都需要自己的 DoubleCollection。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T17:27:30.580

我想这个真正的问题是，你想在这里做什么？您真的希望所有行共享同一个 DoubleCollection 吗？显然，您可能做的更多，这只是分享问题的好方法，但您可能应该为每一行提供自己的集合。很容易做到：

```
line = new Line();    
line.Stroke = new SolidColorBrush(Colors.Blue);
line.StrokeDashArray = **new DoubleCollection() { 2.0, 2.0 };**   
line.X1 = 10;    
... 
```

你真的需要在行之间共享 StoreDashArray，然后将它作为你的类的属性公开吗？我会研究编写该代码的其他方法。

# c# - 创建 COM 组件和 ActiveX 控件

> ID：186640
> 
> 赞同：5
> 
> 时间：2008-10-09T10:15:19.660
> 
> 标签：c#, .net, .net-3.5

可以在 .Net 中创建 COM 组件和 ActiveX 控件（使用 c# 语言）。我搜索了互联网，但我什么也得不到。

谢谢，
桑托什

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-09T10:24:56.427

声明一个接口并用类实现它。
如果您有与 OLE 自动化不兼容的参数/返回值（自定义结构、枚举等），您可能需要使用[MarshalAs 属性](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)来装饰它们。
将[GUID 属性](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.guidattribute.aspx)添加到两者。
将[COMVisible 属性](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comvisibleattribute.aspx)添加到两者。或者，您可以用它[标记程序集](http://msdn.microsoft.com/en-us/library/ms182157(VS.80).aspx)。
使用[tlbexp](http://msdn.microsoft.com/en-us/library/hfzzah2c.aspx)为本地客户端生成类型库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T10:24:44.397

是的，有可能，[CodeProject](http://www.codeproject.com/KB/COM/com_object_in_c_.aspx)中有这篇文章。我的一个朋友尝试过，但在从他的非托管应用程序访问 COM 对象时遇到了一些问题，因此存在一些陷阱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T10:23:04.807

我认为您正在寻找有关“COM Callable Wrapper”的信息。谷歌，或者基本介绍在这里（我还没有读过）：[http ://www.dnzone.com/ShowDetail.asp?NewsId=126](http://www.dnzone.com/ShowDetail.asp?NewsId=126)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T10:49:36.407

Alan Gordon 编写的 .Net 和 COM 互操作性手册 ISBN 0-13-046130-X 如果您正在做大量互操作性工作，那么它是必不可少的资源

# sql - 是否可以通过 SQL Server Management Studio 自动执行 MS SQL Server (2005) 查询？

> ID：186642
> 
> 赞同：4
> 
> 时间：2008-10-09T10:16:04.180
> 
> 标签：sql, sql-server-2005, scheduled-tasks

我在我的 SQL Server 2005 上保存了两个查询，我希望它们以特定的时间间隔运行，例如每 24 小时运行一次。有没有办法通过 SQL Server Management Studio 自动执行这些查询并安排它们？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-09T10:23:27.443

您需要使用作为 SQL Server 的一部分安装的 SQL Server 代理。这是负责运行计划维护和备份任务的后台服务。

在 SQL Server Management Studio 中展开 SQL Server Agent 节点，您应该会看到一个名为“Jobs”的树节点

右键单击它将为您提供添加新作业的选项。作业由一系列要按顺序执行的步骤组成，当您在作业中添加新步骤时，您可以选择各种类型的步骤，包括“Transact-SQL 脚本”

创建一个新作业，添加一个 T-SQL 步骤，将要运行的查询放入步骤属性中，然后使用作业属性中的“计划”选项创建一个定期计划，该计划将在每个24 小时（或任何时候）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T11:50:38.000

您可以使用 SQL Server 代理，这将允许服务器运行脚本/存储过程。

您还可以在服务器或任何其他服务器或工作站上使用 Windows 任务计划程序来计划 isqlw/sqlcmd 以执行您的脚本/存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-10T10:59:56.657

[如何安排每天运行 sql 查询的作业？](https://stackoverflow.com/questions/5471080/how-to-schedule-a-job-for-sql-query-to-run-daily)

这是一个类似的问题，有帮助的答案。

涵盖简单的分步手册。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T11:21:40.150

在以前的雇主处，运营部门有一个任务调度应用程序。他们更喜欢使用 sql server 附带的命令行工具来按计划执行作业（存储过程）。这样，“任务调度应用程序”可以接收退出状态（通过/失败、正常/错误）并暂停相关作业。

对不起，我不记得命令行工具的名称，但它是 sql server 发行版的一部分。我也不记得任务调度应用程序的名称。它不是 Windows 任务调度程序。这是企业级用来管理夜间周期的东西。

不确定您的项目的规模，但这是另一种方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T00:21:25.303

[SKapsal](https://stackoverflow.com/questions/186642/is-it-possible-to-automate-ms-sql-server-2005-queries-via-sql-server-management#186807)对用于执行 SQL 命令的命令行工具的评论是对[osql](http://msdn.microsoft.com/en-us/library/aa214012.aspx)（用于 SQL2000）或[sqlcmd](http://msdn.microsoft.com/en-us/library/ms162773.aspx)（用于 SQL2005+）的引用。您可以将脚本保存为文件，然后使用 Windows 任务计划程序或类似工具从该命令行运行它。

然而，SQL 代理仍然是首选解决方案，因为它为作业创建、调度、日志记录和查看作业执行历史/结果提供了 GUI 控件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T10:22:33.560

创建一个包含执行查询的步骤的作业；可以根据您的需要安排工作。

# .net - Visual Studio 参考和版本控制 - 它是如何工作的？

> ID：186643
> 
> 赞同：14
> 
> 时间：2008-10-09T10:16:05.133
> 
> 标签：.net, visual-studio, dll

我们有几个常见的库。理想情况下，我们希望它们都使用最新版本的 dll，即使它们是针对旧的不同版本编译的（假设最新版本向后兼容）

例如，我们有：

项目 dll
常用控件 dll
日志记录 dll
数据库访问 dll

项目和常用控件参考数据库 dll 的 v2。然而，日志记录参考 v1。

如果在不同的组件中引用了不同的版本，VS 如何选择使用哪一个？
我们是否必须重新编译 v1 dll 才能使用最新的数据库 (v2) 或者我们可以让它自动获取？
是否可以强制使用特定版本？

谢谢，

亚历克斯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T10:35:36.280

默认情况下，对于版本化的 DLL，我相信 VS 会强制进行完全匹配。但是，如果您查看参考的属性，您会发现一个名为“特定版本”的属性。将其设置为“false”，它将匹配更高版本。

不幸的是，我没有完整版的 VS 来找到合适的 MSDN 链接。

此外，您可以使用 app.config 中的[assemblyBinding](http://msdn.microsoft.com/en-us/library/7wd6ex19(VS.80).aspx)元素。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-09T12:50:20.843

这里实际上有两种情况——使用强名称/GAC，或者不使用强名称。

如果您使用强名称并将组件安装到 GAC 中，那么 .Net 将希望使用客户端在编译时引用的组件版本。因此，在您的示例中，Project 很可能引用数据库 V2，而 Logging 引用数据库 V1，因为 DLL 可以并行存储在 GAC 中。因此，如果您确实希望 Logging 使用 V2 而不是 V1，则需要修改配置文件以说明“对 V1 的引用应该指向 V2”。有不同的地方可以做到这一点 - 应用程序文件，机器文件等。

如果您不使用强名称，那么 .Net 将默认使用与客户端位于同一文件夹中的 DLL 版本。因此，假设您将 Project、CommonControls 和 Logging 部署在与数据库 V2 相同的文件夹中。然后，即使 Logging 是针对数据库 V1 构建的，它也会尝试使用同一文件夹中的组件，即数据库 V2。只要 V2 可以提供 Logging 想要使用的相同公共类和方法，它就可以正常工作。

在我的环境中——我们所有的应用程序都是内部的——我们不使用 GAC。我们只是将应用程序需要的所有文件部署到一个文件夹中。当你有很多通用组件时，保持配置文件同步简直就是一场噩梦。

这与 COM 完全不同，COM 中所有应用程序都获取当前注册的 DLL 副本（假设 V1 和 V2 是二进制兼容的）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T11:26:37.347

我遇到了这个有几个建议的网站：http: [//blog.fredrikhaglund.se/blog/2008/02/23/get-control-over-your-assembly-dependencies/](http://blog.fredrikhaglund.se/blog/2008/02/23/get-control-over-your-assembly-dependencies/)

要获得特定版本显然您必须编辑 web.config 或 app.config？

“最后，使用记事本查看您的 csproj 文件（或在 Visual Studio 中卸载项目以便能够将其作为文本打开）。当您使用 Visual Studio 添加引用时，您将获得包含版本号和公钥的程序集引用当您将供应商组件升级到较新版本时，这会给您带来一些麻烦。”
[http://blog.fredrikhaglund.se/blog/2008/02/23/get-control-over-your-assembly-dependencies/](http://blog.fredrikhaglund.se/blog/2008/02/23/get-control-over-your-assembly-dependencies/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T11:19:25.443

如果您有源代码，则可以使用项目引用而不是 dll 引用。这样你总是能得到最新的。

# c++ - 如何组织 C++ 测试应用程序和相关文件？

> ID：186648
> 
> 赞同：8
> 
> 时间：2008-10-09T10:17:31.307
> 
> 标签：c++, unit-testing, testing

我正在开发一个 C++ 库，该库（除其他外）具有读取配置文件的功能；我想为此添加测试。到目前为止，这导致我创建了许多有效和无效的配置文件，每个文件只有几行来测试一个特定的功能。但它现在变得非常笨重，因为有很多文件，还有很多小的 C++ 测试应用程序。不知何故，这对我来说似乎是错误的 :-) 那么您是否有提示如何组织所有这些测试、测试应用程序和测试数据？

注意：库的公共 API 本身不易测试（它需要一个配置文件作为参数）。实际读取和解释配置值的多汁、容易出错的方法是私有的，所以我看不到直接测试它们的方法吗？

所以：你会坚持对真实文件进行测试吗？如果是这样，您将如何组织所有这些文件和应用程序以使它们仍然可维护？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-09T10:38:07.617

也许该库可以接受某种流输入，因此您可以传入一个类似字符串的对象并避免所有输入文件？或者根据配置的类型，您可以提供“get/setAttribute()”函数来直接、公开、修改参数。如果这不是真正的设计目标，那没关系。数据驱动的单元测试在某些地方不受欢迎，但总比没有好！我可能会像这样布置代码：

```
 project/
          src/
          tests/
                test1/
                      input/
                test2
                      input/ 
```

在每个 testN 目录中，您将有一个与输入目录中的配置文件关联的 cpp 文件。

然后，假设您使用的是 xUnit 样式的测试库（[cppunit](http://cppunit.sourceforge.net/)、[googletest](http://code.google.com/p/googletest/)、[unittest++](http://unittest-cpp.sourceforge.net/)或其他），您可以将各种 testXXX() 函数添加到单个类中以测试相关的功能组。这样，您可以通过将至少一些测试组合在一起来消除部分大量小程序问题。

唯一的问题是库是否希望配置文件被称为特定的东西，或者位于特定的位置。情况并非如此，但如果是这样，则必须通过将测试文件复制到预期位置来解决。

并且不要担心大量测试会使您的项目变得混乱，如果它们被隐藏在测试目录中，那么它们就不会打扰任何人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T11:11:27.923

**第1部分。**

正如 Richard 建议的那样，我会看一下[CPPUnit](http://cpptest.sourceforge.net/)测试框架。这将在一定程度上推动您的测试框架的位置。

根据 Richard 的示例，您的测试可能位于位于高级别的并行目录中，或者位于与您要测试的区域平行的测试子目录或测试目录中。

无论哪种方式，请在整个项目的目录结构中保持一致！**特别是**在测试包含在单个高级目录中的情况下。

没有什么比必须在以下位置维护源代码的心理映射更糟糕的了：

```
/project/src/component_a/piece_2/this_bit 
```

并将测试放在某处，例如：

```
/project/test/the_first_components/connection_tests/test_a 
```

我曾参与过有人这样做的项目！

多么浪费湿件循环！8-O 谈论违反亚历山大的无名质量概念。

更好的是让您的测试始终位于被测源代码的位置：

```
/project/test/component_a/piece_2/this_bit/test_a 
```

**第2部分**

至于 API 配置文件，在每个本地测试区域中制作参考配置的本地副本，作为测试环境的一部分。在执行测试之前运行的设置。不要将配置（或数据）的副本撒在整个测试树中。

HTH。

干杯，

抢

顺便说一句，真的很高兴看到你现在在设置时问这个问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T20:31:22.743

你不会找到比 CppUnit 更糟糕的单元测试框架。说真的，任何推荐 CppUnit 的人都没有真正看过任何竞争框架。

所以是的，去进行单元测试框架，但不要使用 CppUnit。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T11:20:16.080

对于这样的事情，我总是有一个小的实用程序类，它将一个配置加载到内存缓冲区中，然后从那里它被输入到实际的配置类中。这意味着真正的来源无关紧要 - 它可以是文件或数据库。对于单元测试，它被硬编码在 std::string 中，然后传递给类进行测试。您可以轻松模拟 currup!pte3d 数据以测试故障路径。

我使用[UnitTest++](http://unittest-cpp.sourceforge.net/UnitTest++.html)。我将测试作为 src 树的一部分。所以：

```
solution/project1/src <-- source code
solution/project1/src/tests <-- unit test code 
solution/project2/src <-- source code
solution/project2/src/tests <-- unit test code 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T11:46:55.247

假设您可以控制库的设计，我希望您能够进行重构，以便将实际文件读取的关注点与将其解释为配置文件的关注点分开：

1.  FileReader 类读取文件并生成输入流，
2.  类 ConfigFileInterpreter 验证/解释等输入流的内容

现在要测试 FileReader，您需要非常少量的实际文件（空、二进制、纯文本等），而对于 ConfigFileInterpreter，您将使用 FileReader 类的存根，该存根返回要读取的输入流。现在，您可以将所有各种配置情况准备为字符串，而不必读取这么多文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T10:43:23.987

在我做过的一些测试中，我实际上是使用测试代码编写配置文件，然后在测试使用该文件后将其删除。它在某种程度上填充了代码，我不知道这是否是一种好的做法，但它确实有效。如果你碰巧在使用 boost，那么它的文件系统模块对于创建目录、导航目录和删除文件很有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T10:45:16.120

我同意@Richard Quirk 所说的话，但您也可能想让您的测试套件类成为您正在测试的类的朋友并测试其私有功能。

# c# - 除了使用层次结构之外，没有更好的方法来显示对象吗？

> ID：186649
> 
> 赞同：3
> 
> 时间：2008-10-09T10:18:15.283
> 
> 标签：c#, design-patterns

我有一个这样的类层次结构：

```
 +-- VirtualNode
        |
INode --+                  +-- SiteNode
        |                  |
        +-- AbstractNode --+
                           |
                           +-- SiteSubNode 
```

以及一个`NodeCollection`建立在`INode`. 为了显示一个`NodeCollection`我需要知道每个成员的最终类型。所以我需要这样的功能

```
foreach (INode n in myNodeCollection)
{
    switch(n.GetType())
    {
        case(typeof(SiteNode)):
        // Display n as SiteNode
    }
} 
```

现在，这实际上不是一种面向对象的方式。**在您看来，是否有任何模式或推荐的方法来做同样的事情？**

**编辑**
我已经考虑向INode 接口添加一个`Display`or方法。`Render`这具有将视图耦合到模型的副作用，我真的很想避免这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T10:20:08.370

我想你所追求的是[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T10:43:22.253

[多态性：](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)

当你有一个使用对象类型的 select 语句时，它是重构为多态性的主要候选者。

查看Martin Fowler的《[重构》一书：](https://rads.stackoverflow.com/amzn/click/com/0201485672)

“面向对象代码最明显的症状之一是它相对缺乏 switch（或 case）语句。switch 语句的问题本质上是重复问题。通常你会发现相同的 switch 语句散布在程序的不同地方。如果你在 switch 中添加一个新的子句，你必须找到所有这些 switch、语句并改变它们。多态的面向对象的概念为你提供了一种优雅的方式来处理这个问题。

大多数时候你看到一个 switch 语句你应该考虑多态性。问题是应该在哪里发生多态性。switch 语句通常会打开类型代码。您需要承载类型代码值的方法或类。因此，使用 Extract Method 提取 switch 语句，然后使用 Move Method 将其放到需要多态性的类中。此时，您必须决定是用子类替换类型代码还是用状态/策略替换类型代码。设置好继承结构后，可以使用 Replace Conditional with Polymorphism。”

这是在您的情况下使用多态性的一种方法：

1.  在 AbstractNode 中定义一个抽象方法，命名为 Display()。

2.  然后在每个 SiteNode 和 SiteSubNode 类中实际实现 Display()。

3.  然后，当您需要显示这些节点时，您可以简单地遍历包含 AbstractNode 类型项目的集合并为每个项目调用 Display()。

4.  对 Display() 的调用将自动解析为该项目的真实类型的实际具体实现。

5.  注意：如果要显示 VirtualNode，您还可以将 Display() 方法从 AbstractNode 移动到 INode 接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T10:50:33.923

如果您可以更改 INode 接口 - 添加一个返回“视图”的虚拟方法并在继承的类中覆盖它。

如果您无法更改基本接口 - 为每个类实现扩展方法并让它们返回每个特定类的“视图”。

# c# - 获取字符串第 n 次出现的索引？

> ID：186653
> 
> 赞同：105
> 
> 时间：2008-10-09T10:20:00.210
> 
> 标签：c#, .net, string, indexing, indexof

除非我遗漏了一个明显的内置方法，否则在字符串中第*n*次出现字符串的最快方法是什么？

我意识到我可以通过在循环的每次迭代中更新它的起始索引来循环[IndexOf](https://msdn.microsoft.com/en-us/library/k8b1470s(v=vs.110).aspx)方法。但这样做对我来说似乎很浪费。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2008-10-09T14:01:58.250

您真的可以使用正则表达式`/((s).*?){n}/`来搜索第 n 次出现的 substring `s`。

在 C# 中，它可能看起来像这样：

```
public static class StringExtender
{
    public static int NthIndexOf(this string target, string value, int n)
    {
        Match m = Regex.Match(target, "((" + Regex.Escape(value) + ").*?){" + n + "}");

        if (m.Success)
            return m.Groups[2].Captures[n - 1].Index;
        else
            return -1;
    }
} 
```

**注意：**我已添加`Regex.Escape`到原始解决方案中，以允许搜索对正则表达式引擎具有特殊含义的字符。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-10-09T10:26:51.290

这基本上就是你需要做的——或者至少，这是最简单的解决方案。您“浪费”的只是 n 次方法调用的成本 - 如果您考虑一下，您实际上不会检查任何情况两次。（IndexOf 将在找到匹配项后立即返回，并且您将从中断处继续。）

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2011-03-22T03:34:26.223

> 这基本上就是你需要做的——或者至少，这是最简单的解决方案。您“浪费”的只是 n 次方法调用的成本 - 如果您考虑一下，您实际上不会检查任何情况两次。（IndexOf 将在找到匹配项后立即返回，并且您将从中断处继续。）

这是递归实现（上述*想法*）作为扩展方法，模仿框架方法的格式：

```
public static int IndexOfNth(this string input,
                             string value, int startIndex, int nth)
{
    if (nth < 1)
        throw new NotSupportedException("Param 'nth' must be greater than 0!");
    if (nth == 1)
        return input.IndexOf(value, startIndex);
    var idx = input.IndexOf(value, startIndex);
    if (idx == -1)
        return -1;
    return input.IndexOfNth(value, idx + 1, --nth);
} 
```

此外，这里有一些（MBUnit）单元测试可能对您有所帮助（证明它是正确的）：

```
using System;
using MbUnit.Framework;

namespace IndexOfNthTest
{
    [TestFixture]
    public class Tests
    {
        //has 4 instances of the 
        private const string Input = "TestTest";
        private const string Token = "Test";

        /* Test for 0th index */

        [Test]
        public void TestZero()
        {
            Assert.Throws<NotSupportedException>(
                () => Input.IndexOfNth(Token, 0, 0));
        }

        /* Test the two standard cases (1st and 2nd) */

        [Test]
        public void TestFirst()
        {
            Assert.AreEqual(0, Input.IndexOfNth("Test", 0, 1));
        }

        [Test]
        public void TestSecond()
        {
            Assert.AreEqual(4, Input.IndexOfNth("Test", 0, 2));
        }

        /* Test the 'out of bounds' case */

        [Test]
        public void TestThird()
        {
            Assert.AreEqual(-1, Input.IndexOfNth("Test", 0, 3));
        }

        /* Test the offset case (in and out of bounds) */

        [Test]
        public void TestFirstWithOneOffset()
        {
            Assert.AreEqual(4, Input.IndexOfNth("Test", 4, 1));
        }

        [Test]
        public void TestFirstWithTwoOffsets()
        {
            Assert.AreEqual(-1, Input.IndexOfNth("Test", 8, 1));
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-10-07T04:39:44.747

```
private int IndexOfOccurence(string s, string match, int occurence)
{
    int i = 1;
    int index = 0;

    while (i <= occurence && (index = s.IndexOf(match, index + 1)) != -1)
    {
        if (i == occurence)
            return index;

        i++;
    }

    return -1;
} 
```

或在 C# 中使用扩展方法

```
public static int IndexOfOccurence(this string s, string match, int occurence)
{
    int i = 1;
    int index = 0;

    while (i <= occurence && (index = s.IndexOf(match, index + 1)) != -1)
    {
        if (i == occurence)
            return index;

        i++;
    }

    return -1;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-08T19:58:14.913

经过一些基准测试，这似乎是最简单和最有效的解决方案

```
public static int IndexOfNthSB(string input,
             char value, int startIndex, int nth)
        {
            if (nth < 1)
                throw new NotSupportedException("Param 'nth' must be greater than 0!");
            var nResult = 0;
            for (int i = startIndex; i < input.Length; i++)
            {
                if (input[i] == value)
                    nResult++;
                if (nResult == nth)
                    return i;
            }
            return -1;
        } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-13T09:08:10.327

也许使用`String.Split()`方法并检查请求的事件是否在数组中也会很好，如果您不需要索引，但索引处的值

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-19T00:07:26.703

System.ValueTuple ftw：

`var index = line.Select((x, i) => (x, i)).Where(x => x.Item1 == '"').ElementAt(5).Item2;`

写一个函数是作业

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-16T15:39:55.610

托德的回答可以稍微简化。

```
using System;

static class MainClass {
    private static int IndexOfNth(this string target, string substring,
                                       int seqNr, int startIdx = 0)
    {
        if (seqNr < 1)
        {
            throw new IndexOutOfRangeException("Parameter 'nth' must be greater than 0.");
        }

        var idx = target.IndexOf(substring, startIdx);

        if (idx < 0 || seqNr == 1) { return idx; }

        return target.IndexOfNth(substring, --seqNr, ++idx); // skip
    }

    static void Main () {
        Console.WriteLine ("abcbcbcd".IndexOfNth("bc", 1));
        Console.WriteLine ("abcbcbcd".IndexOfNth("bc", 2));
        Console.WriteLine ("abcbcbcd".IndexOfNth("bc", 3));
        Console.WriteLine ("abcbcbcd".IndexOfNth("bc", 4));
    }
} 
```

输出

```
1
3
5
-1 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-21T21:48:47.427

或者像这样的 do while 循环

```
 private static int OrdinalIndexOf(string str, string substr, int n)
    {
        int pos = -1;
        do
        {
            pos = str.IndexOf(substr, pos + 1);
        } while (n-- > 0 && pos != -1);
        return pos;
    } 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-07-08T07:05:54.497

这可能会做到：

```
Console.WriteLine(str.IndexOf((@"\")+2)+1); 
```

# vba - dd/mm 自动更改为 mm/dd

> ID：186655
> 
> 赞同：5
> 
> 时间：2008-10-09T10:20:50.817
> 
> 标签：vba, ms-access, ms-office

我在 Access VBA 中使用 Date 语句编写了一些代码。直到本月初它工作正常，但现在我看到 Date 已自动将格式从 更改`dd/mm/yyyy`为`mm/dd/yyyy`. 有没有其他人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T10:45:15.933

无论区域设置如何，默认的 Access SQL 日期格式都是 mm/dd/yyyy。如果您使用无效的日期格式，它将“有帮助地”尝试将其转换为您的有效日期。

因此，如果您使用 '30/09/2008'，它会识别出您正在使用 dd/mm/yyyy，并进行适当的转换。但是，像 '10/01/2008' 这样的值是一个有效的 mm/dd/yyyy 值，因此它不会被转换，并且存储不正确，以防您实际上是指 dd/mm/yyyy...。

解决方案是始终将日期值转换为 mm/dd/yyyy 字符串，然后再在 Access SQL 语句中使用它们。您必须在这里小心一点，因为使用 VBA 日期格式掩码可能无法完全像您在非美国语言环境中所期望的那样工作（例如，“有帮助”将“mm/dd/yyyy”解释为“本地化短日期格式” )，因此请使用您的特定 Access/VBA 版本仔细测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T15:07:19.323

访问需要一个明确的日期。通常建议您使用 yyyy/mm/dd，无论语言环境如何。例如：

```
strSQL="SELECT SomeDate FROM tblT WHERE SomeDate=#" & Format(DateVar, "yyyy/mm/dd") & "#" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-24T12:57:15.740

试试这个代码：

```
stLinkCriteria = "[ProjectDate] Between #" & Format(CDate(Me![txtDateFrom]), "mm/dd/yyyy") & "# And #" & Format(CDate(Me![txtDateTo]), "mm/dd/yyyy") & "#" 
```

这个对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-23T09:06:02.893

我使用 datevalue() 函数非常成功。从未绑定控件获取日期时，它似乎足够聪明地正确解释格式“dd/mm/yyyy”。因此，Jet SQL 查询如

`"Select * from DateTable where StartDate = datevalue(" & me!TxtStartDate & ");"`

似乎每次都有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-12T18:40:54.873

这有效：

```
sentenciaSQL = "UPDATE Numeraciones " & _
"SET Valor = " & Valor & ", " & _
"Fecha = #" & **Format(fecha,"mm/dd/yyyy HH:nn:ss") & "#, " &** _
"Id_Usuario = " & Id_Usuario & _
" WHERE Nombre = '" & Nombre & "'" 
```

# php - 存储上传文件（声音、图片和视频）的位置

> ID：186656
> 
> 赞同：5
> 
> 时间：2008-10-09T10:21:19.070
> 
> 标签：php, mysql, storage, blob

有一阵子我不得不开发一个音乐网站，允许将音频文件上传到一个网站，然后使用 ffmpeg 转换为各种格式，然后人们会在购买后下载上传的音频文件并创建一个 tmp 文件并放置在下载位置，仅对每个下载实例有效，然后 tmp 文件将被删除。

现在我正在重新审视这个项目，我还必须添加图片和视频作为上传内容。

我想找到存储文件的最佳方法，

选项 1：将文件存储在文件夹中并在数据库中引用它们

选项2：将数据库（mysql）中的实际文件存储为blob。

我正在玩弄这个想法，以考虑每种方法的安全隐患，以及我可能没有计算过的其他问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-09T10:28:09.680

请参阅早期的 StackOverflow 问题[将图像存储在数据库中，是还是不是？](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay).

我知道您提到了图像和视频，但是这个问题与所有大型二进制内容媒体文件有关。

共识似乎是将文件路径存储到文件系统上的图像，而不是实际图像是要走的路。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T10:35:54.233

我建议存储为文件并将它们的位置存储在数据库中。

将文件存储在数据库中需要更多资源，并且会使备份/恢复数据库的速度变慢。您真的希望每次进行数据库转储时都必须传输大量视频吗？文件系统非常适合分发文件，您可以非常轻松地备份/同步它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T12:45:29.887

我会选择数据库选项。我在许多项目中使用过它，一些非常大的 100+GB。存储实现是关键，如果设计不好，你的表现就会受到惩罚。请参阅[此](http://www.dreamwerx.net/phpforum/?id=1)示例了解一些好的实现思路：
数据库存储允许更高的可扩展性和安全性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-09T10:31:53.587

我会直接将文件存储在磁盘上，而数据库只保存它们的 ID/url。

这种方式访问​​这些文件（可以是大的二进制文件）不需要任何 php/database 操作，它是由网络服务器直接完成的。
此外，如果您愿意，将这些文件移动到另一台服务器会更容易。

实际上，我只能看到将它们存储在数据库中的一个好处是更容易备份 - 你无论如何都想备份你的数据库，这样你就可以将所有数据放在一个地方，并且你可以确保每个备份都是完整的（即你没有'磁盘上没有数据库条目未使用的文件；并且您的数据库中没有指向无处的图像 ID）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T10:32:01.747

我[使用 Oracle](https://stackoverflow.com/questions/62876/whats-the-best-way-to-save-and-retrieve-binary-files-with-oracle-10g)作为 Windows Forms 应用程序的后端问了一个类似的问题。

答案实际上归结为您对备份和恢复文件的要求。如果该要求很重要，那么使用数据库会更容易（因为无论如何您都在备份数据库，对吗？：o）

# c# - 为少数控件启用 ViewState 并为其他/页面禁用

> ID：186657
> 
> 赞同：13
> 
> 时间：2008-10-09T10:21:32.393
> 
> 标签：c#, asp.net, viewstate

当我禁用页面的 ViewState 时。它不允许任何其他控件使用 ViewState .. 即使我为该特定控件设置 EnableViewState="true" ..

当为页面本身禁用 ViewState 时，是否可以为控件启用 ViewState？

如果不是，如何禁用页面上控件的视图状态，除了少数没有明确指定 EnableViewState="false" .. 在这么多控件中输入相同内容是忙碌的..

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-09T10:38:09.237

如果您将翻页的 ViewState 设置为关闭，那么您将无法为特定组件启用 ViewState。这是因为 ViewState 是递归序列化的，所以如果 Page 不允许 ViewState，它不会为它的任何子控件序列化 ViewState。

在回答您的问题时，如果您不想在单个控件上显式关闭 ViewState，但希望保持某些控件 ViewState 感知，最好的方法是编写一个小的实用程序方法来关闭所有控件的 ViewState（使用递归或其他）。然后为要为其启用 ViewState 的控件启用 ViewState。

或者，如果控件是其他容器控件（例如 Panel）内的组，则可以采用中间立场和不太有力的方式。您可以通过禁用面板的 ViewState 来禁用面板内所有控件的 ViewState。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-05T21:11:40.660

> 如果您将翻页的 ViewState 设置为关闭，那么您将无法为特定组件启用 ViewState。这是因为 ViewState 是递归序列化的，所以当 Page 不允许 ViewState 时，它​​不会为它的任何子控件序列化 ViewState。它的子控件。

随着 ASP.NET 4 的出现，我们有了一个名为[ViewStateMode](http://msdn.microsoft.com/en-us/library/system.web.ui.control.viewstatemode.aspx)的新属性，即使页面的视图状态被禁用，它也可用于启用单个控件的视图状态。

要使用这个新属性，您可以创建一个将 ViewStateMode 设置为 Disabled 的基本页面类，也可以创建一个执行相同操作的 PageAdapter。web.config 中没有 viewStateMode 属性。

这是页面适配器的代码：

```
using System.Web.UI;
using System.Web.UI.Adapters;

namespace Playground.Web.UI.Adapters
{
    public class PageAdapter: System.Web.UI.Adapters.PageAdapter
    {
        protected override void OnLoad(EventArgs e)
        {
            ViewStateMode = ViewStateMode.Disabled;
            base.OnLoad(e);
        }
    }
} 
```

这是浏览器文件的代码：

```
<browser refID="default">
    <controladapters>
        <adapter controlType="System.Web.UI.Page" adapterType="Playground.Web.UI.Adapters.PageAdapter" />
    </controladapters>
</browser> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T10:53:55.663

这里有一些代码扩展了@Samuel Kim 的概念，即有一种方法可以在除某些控件之外的所有控件上禁用 ViewState（顺便说一句，它使用 .NET 3.5）：

```
List<string> allowedControls = new List<string> { "Control1", "Control3" };
IEnumerable<Control> controlsWithoutViewState = Page.Controls.Where(c => !allowedControls.Contains(c.ID));
foreach(Control c controlsWithoutViewState){
  if(c is WebControl) ((WebControl)c).EnableViewState = false;
} 
```

唯一我不能 100% 确定（而且我没有运行我的虚拟机）是 Page.Controls 是否需要强制转换，如果需要，只需使用这个：

```
IEnumerable<Control> controlsWithoutViewState = Page.Controls.Cast<Control>().Where(c => !allowedControls.Contains(c.ID)); 
```

上面只是一个快速的概念，它没有考虑嵌套控件，你可能想要 1 和 1 没有 ViewState，但是制作一个 recusive 函数来处理它并不难。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-07T08:06:09.940

使用 .NET 4.0，您还可以定义控制适配器

```
namespace BB.Common.UI.Adapters
{
    [AspNetHostingPermission(System.Security.Permissions.SecurityAction.Demand, Level = AspNetHostingPermissionLevel.Minimal)]
    public class DisableViewStateControl : System.Web.UI.Adapters.ControlAdapter
    {
        protected override void OnInit(EventArgs e)
        {
            if (Control.ViewStateMode == ViewStateMode.Inherit)
                Control.ViewStateMode = ViewStateMode.Disabled;
            base.OnInit(e);
        }
    }
} 
```

在上面的代码中，ViewState 模式在继承时被禁用。在浏览器设置文件中添加以下行。

```
<browsers>
  <browser refID="Default" >
    <controlAdapters>
      <adapter
          controlType="System.Web.UI.WebControls.Label"
          adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" />
      <adapter
         controlType="System.Web.UI.WebControls.HyperLink"
         adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" />
      <adapter
         controlType="System.Web.UI.WebControls.ImageButton"
         adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" />
      <adapter
          controlType="System.Web.UI.WebControls.Button"
          adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" />
    <adapter
          controlType="System.Web.UI.WebControls.TextBox"
          adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" />
      <adapter
          controlType="System.Web.UI.WebControls.CheckBox"
          adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" /> 
      <adapter
          controlType="System.Web.UI.WebControls.HiddenField"
          adapterType="Fiserv.Common.UI.Adapters.DisableViewStateControl" /> 
    </controlAdapters>
  </browser>
</browsers> 
```

通过这种方式，您可以对整个应用程序中的每个单个控件的视图状态进行更精细的控制。在需要控制视图状态的地方，只需在代码中启用它即可。就是这样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-19T17:38:21.390

最简单的解决方案是：

```
<%@ Page Language="C#" EnableViewState="true" ViewStateMode="Disabled" %> 
```

以及要启用视图状态的任何位置：

```
<asp:yourcontrol EnableViewState="true" ViewStateMode="Enabled"> 
```

保留给 Shredder 在这篇[文章中的回答的所有学分](https://stackoverflow.com/questions/11105154/dropdownlist-populated-from-datasource-values-are-inaccessible-from-code-behin/11105644#comment14546361_11105644)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T21:19:55.053

您也可以从 BasePage 继承。在 BasePage 上禁用 ViewState。

```
/// <summary>
/// All pages inherit this page
/// </summary>
public class BasePage : System.Web.UI.Page {

    protected override void OnLoad(EventArgs e) {
        base.OnLoad(e);
    }

    public bool ViewStateEnabled {
        get {
            return Page.EnableViewState;
        }
        set {
            Page.EnableViewState = value;
        }
    }

    public BasePage() {
        // Disable ViewState By Default
        ViewStateEnabled = false;
    }
} 
```

在您希望启用 ViewState 的每个页面中，您在 Page_Load 中执行以下操作：

```
public partial class Products_Default : BasePage {
    protected void Page_Load(object sender, EventArgs e) {
        this.ViewStateEnabled = true;
    }
} 
```

这应该只为该页面启用 ViewState（假设它在 MasterPage 中为 ON）。注意：您需要在该页面上单独设置每个控件的 ViewState。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-03T21:26:21.103

我很好奇塞缪尔的方法是否有效。如果您尝试，请发布您的结果。

我不是说塞缪尔错了，我只是好奇。

我很好奇的原因是因为视图状态是递归序列化的（如 Samuel 所述），如果您有一个启用了视图状态的控件，它是禁用了视图状态的控件的子控件，那么子控件将没有视图状态，因为递归序列化将在父级完全跳过它。如果您已经构建了自己的用户控件，自然会包含很多子控件，这将特别令人不安。

另一种解决方案是使用 Samuel 的实用方法方法，但不是禁用所有内容，而是禁用它，以便为没有孩子的标签、文字等控件禁用它......或者如果他们确实有孩子，那么如果孩子禁用 viewstate 就可以了。

由于我上面提到的原因，您自然希望避免禁用面板和占位符的视图状态。

编辑：

```
Public Shared Sub DisableViewState(ByVal cntrl As Control)
    If TypeOf cntrl Is Label Then
        cntrl.EnableViewState = False
    ElseIf TypeOf cntrl Is Literal Then
        cntrl.EnableViewState = False
    ElseIf TypeOf cntrl Is Button Then
        cntrl.EnableViewState = False
    Else
        If cntrl.Controls IsNot Nothing Then
            For Each subControl As Control In cntrl.Controls
                DisableViewState(subControl)
            Next
        End If
    End If
End Sub 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-03T21:29:39.287

您还可以子类化内置控件，并在您的子类中将 EnableViewState 属性设置为 false。

# .net - XSD 和自动类/消息生成

> ID：186671
> 
> 赞同：2
> 
> 时间：2008-10-09T10:28:08.963
> 
> 标签：.net, xml

使用 XSD 生成消息实例的途径有哪些？我似乎记得阅读过有关从 XSD 生成类的信息，但现在找不到任何具体内容。我知道您可以从 XSD 生成类和数据集，但我正在寻找一种模式来自动生成消息的实际生成。

顺便说一句，SO 是我选择的知识共享者，而不是谷歌。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-08T20:18:39.530

Visual Studio XSD 应该是第一个调用端口。它将生成您可以序列化和反序列化 xml 文档的类。

XSD 适用于“简单”模式，有很多它无法处理。

注意：如果您架构导入其他架构文件，您还需要在命令行中包含这些架构文件。

其他从模式文件生成代码的工具包括 XMLSpy、Enterprise Architect。如果 XSD 未能满足您的要求，值得一看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T10:32:58.500

```
xsd /c yourschema.xsd > yourschema.cs 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T19:07:32.520

您还可以使用 xsd.exe 从 XML 示例创建 XSD。启动 Visual Studio 命令提示符并使用它从 xml 示例创建 xsd。然后，您可以如 leppie 所示，使用 xsd.exe 从该 XSD 创建一个类型化的数据集。我不建议盲目地这样做，但在使用第三方 xml 服务时肯定会有所帮助。

XML -> XSD -> TypedDS 使用 xsd.exe。

# vb.net - 如何处理 vb.net 中双精度数的舍入错误？

> ID：186693
> 
> 赞同：2
> 
> 时间：2008-10-09T10:38:32.200
> 
> 标签：vb.net, rounding-error

我正在尝试使用 vb.net 平衡一组货币价值。这两个值的总和被转换为双精度值。在某些情况下，我会遇到舍入错误。

避免这种情况的最佳方法是什么？有没有一种我可以优先使用的类型？如何将结果值四舍五入到小数点后两位？

这是我的代码——我可能不需要展示它，但以防万一。

```
 Dim nInvValue As Double
  Dim nCreditValue As Double

  For Each oReferenceItem In oMatchInvoices
     Dim nUnallocated As Double = oReferenceItem.DocumentOutstandingValue - oReferenceItem.DocumentAllocatedValue
     If ((nUnallocated <> 0) And (sReferenceValue = oReferenceItem.InstrumentNo)) Then
        iCount = iCount + 1
        If (oReferenceItem.IsDebit) And (nUnallocated > 0) Then
           nInvValue = nInvValue + nUnallocated
           InvoiceList.Add(nUnallocated.ToString("c"), oReferenceItem.URN.ToString)
        End If
        If (oReferenceItem.IsCredit) And (nUnallocated < 0) Then
           nCreditValue = nCreditValue - nUnallocated
           CreditList.Add(nUnallocated.ToString("c"), oReferenceItem.URN.ToString)
        End If
     End If
  Next 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T10:43:39.647

对于财务计算，我相信当前的智慧是使用小数而不是双精度数。

您可能对此讨论感兴趣[Decimal Vs。双](https://stackoverflow.com/questions/4/decimal-vs-double)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T10:40:11.997

尝试使用小数类型。

[MSDN - 十进制](http://msdn.microsoft.com/en-us/library/system.decimal.aspx)

# visual-studio-2005 - 在 Crystal Reports 中显示 RichText

> ID：186699
> 
> 赞同：7
> 
> 时间：2008-10-09T10:41:15.783
> 
> 标签：visual-studio-2005, crystal-reports, richtext

我在 Crystal（Visual Studio 2005 附带的版本）中创建了一个报表，其中包含一个 IFieldObject，我想用它来显示一些富文本。我已将 IFieldObject 的 TextFormat 设置为 crRTFText，但是当我运行报告时，文本框会显示所有 rtf 标记，而不是实际显示格式化文本。

为了让 Crystal 显示富文本，是否需要更改其他一些设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-13T14:39:30.493

您在报告中使用什么查看器？基于 HTML 的查看器（WebForm 和 Java）可能不支持 RTF 输出。

ActiveX（当然！）或 WinForm（我认为）查看器应该在字段中支持 RTF。

您是否尝试过使用 html 进行丰富的格式化？

# project-management - 在审查需求规范时，需要解决哪些“致命罪”？

> ID：186716
> 
> 赞同：7
> 
> 时间：2008-10-09T10:47:55.070
> 
> 标签：project-management, qa, specifications, review

在审查需求规范（包括功能性、非功能性需求、约束等）时，无论大小，作者所犯的“致命罪”是什么？

请列出不超过 7 件最重要的事情（按严重性递减顺序）在需求规范中完成（或未完成）会对软件产品的质量产生不利影响。小于 7 完全没问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-09T11:33:32.590

OK，这已经不止7个了，不过好的需求有以下属性：

*   **独一无二**的。还有其他类似的要求吗？
*   **Identifiable** , 能否唯一标识需求？它可以在您的整个开发过程中被追踪吗？
*   **完成**。有什么遗漏或遗忘吗？是否彻底？它是否包括使其独立所需的一切？
*   **准确**。这是正确的吗？它是否正确定义了目标？有没有错误？
*   **毫不含糊**。描述是否准确而不含糊？有单一解释吗？是否易于阅读和理解？
*   **一致**的。特性描述是否写得不与规范中的其他项目冲突？
*   **相关**。该声明是该功能所必需的吗？是否应该省略额外的信息？它是否可以追溯到最初的客户需求？
*   **可行**。是否可以在指定的预算和时间表内使用可用的人员、工具和资源来实施？
*   **无代码**。规范是否坚持定义产品而不是底层软件设计、架构和代码？
*   **可测试**。可以测试吗？是否提供了足够的信息，测试人员可以创建测试来验证需求是否得到满足？
*   **优先**。它比其他要求更重要还是更不重要？
*   **使用主动语音**。规范是否使用主动语态？被动语态并不总是指定谁或什么执行动作。
*   **分类**。需求是否在逻辑上与相似的需求分组？可能的类别有：行为、性能、接口、数据结构/元素、实施、合规/质量、操作（可靠性、安全性、安保）、衍生/工程。

一个体面的需求跟踪工具可以自动化/强制执行上述一些，如可识别、优先级、分类，但只有团队审查才能检查其余部分。关键是在这些属性方面对您的团队进行培训，通过阅读需求的好坏示例来让他们练习，并建立一个有效的审查流程，在您的生命周期中尽早检查需求，以便对下游活动产生影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T11:03:56.207

缺少要求 - 更难捕捉。将需求分成清晰的部分（例如安全性、性能、样式等）可以使这一点更容易被发现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T11:04:27.283

功能、时间、质量 - 选择任何两个。确保要求不会将这三个要求都强加给您的团队。

推回试图控制您的流程的要求。

从一开始就要求明确的优先级。

坚持为每个要求制定明确的验收标准。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T10:50:20.337

需求必须具体且明确地说明需要什么，但在如何满足需求方面不应该如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T10:56:20.857

做出假设 - 仔细检查任何看起来像假设的东西实际上已经得到验证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-09T10:58:21.523

包含多个要求的措辞不佳的句子。将它们分开在某个地方，使它们更清晰，更容易在完成后打勾。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-09T11:00:38.617

不容易验证是否满足的要求 - 更改为在审核时更容易标记为满足或未满足的表单。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-09T11:05:08.153

该要求没有具体说明谁/做什么。

```
"The invoice is reconciled to the purchase order." 
```

这是否意味着系统做某事，或用户？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T11:06:23.317

我在一个我为之编码的项目中见过的最糟糕的一个：-

```
The system shall interface to SAP as required. 
```

首先，带有“根据需要”的要求是愚蠢的。那一条线一定要花费 40 万美元。顾客不停地指着它说它说你要在那里做废话，废话，废话。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-09T11:07:25.763

过于严格 - 如果可能，请指定相关公差。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-09T11:09:07.430

模棱两可的要求是不好的。

无法验证和无法量化的需求加倍。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-09T11:13:59.337

当然，这一切都取决于你得到什么样的要求。我习惯于典型的 Gui 或 Web 应用程序、批处理和

*   首先提出标准，不必在每个规范中定义，参考它们
*   让它尽可能小——很少有人可以阅读 200 页的文档并牢记一切
*   具体、可衡量、具体
*   做例子（图纸，会计著作）
*   在描述功能之前先说明目的
*   包括性能标准、弹性标准、部署说明、所需操作的文档

我还给审稿人一个建议：**了解你的主题**

您必须非常详细地了解需求的上下文、特定客户的需求、技术环境，或许还有最重要的需求将针对谁，以及他们对全球的了解程度如何。

我在项目中获得了非常糟糕的经验，因为他们的个人知识非常浅薄，很多人都在审查规范。您会在同一水平上获得反馈，主要是正式的更正，但规范的严重缺乏只会在项目中最近才被发现。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-09T11:38:08.273

避免使用“狡猾的词”——任何可以从上下文中分离出来并且听起来很糟糕的语言都是糟糕的。

确保一切都非常清楚：模糊 == 坏事（tm）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-09T10:57:53.347

我的建议以及在新项目之前我总是做的事情是仔细检查史蒂夫麦康[奈尔代码完成第 42,43 页上的检查清单](https://rads.stackoverflow.com/amzn/click/com/0735619670)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-09T11:09:16.350

无所不知的维基百科有一个很好的需求概要 - [http://en.wikipedia.org/wiki/Requirement#Good_requirements](http://en.wikipedia.org/wiki/Requirement#Good_requirements)。我想说的是，在这些方面，缺乏可验证性是最常见的。了解大局在生活中很重要，但是，您需要在需求中明确说明，例如。系统应快速响应。相反，系统应在 2 秒内响应所有请求。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-09T11:22:24.937

*   功能、架构、接口、非功能需求的分离。
*   使用明确和一致的符号来描述实体
*   明确用例的进入和退出标准
*   有流程图（思维导图与 UML 的目的相同，并且更容易绘制）
*   明确定义范围，涵盖哪些内容和未涵盖的内容以及在哪里可以找到那些未知的内容
*   有一个可追溯性矩阵

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-09T11:40:28.503

您可能会考虑阅读一些[需求管理](http://en.wikipedia.org/wiki/Requirements_Management)和[CMMI](http://en.wikipedia.org/wiki/Capability_Maturity_Model_Integration)文档。

还可以访问[Requirement Checklist](http://users.csc.calpoly.edu/~jdalbey/205/Deliver/SRS_QA.html)和 google 以获取“良好要求的标准”。

这些专门设计用于创建有助于软件开发的流程。

# delphi - Delphi 7异常未捕获

> ID：186718
> 
> 赞同：3
> 
> 时间：2008-10-09T10:49:34.317
> 
> 标签：delphi, exception

我有一些我一直在处理的非常复杂的遗留代码在收集大量数据时会崩溃。我一直无法找到崩溃的确切原因，并且正在尝试不同的方法来解决它，或者至少可以很好地恢复。我做的最后一件事是将崩溃的代码包含在一个

```
try
  ...
except
  cleanup();
end; 
```

只是为了让它表现。但清理工作永远不会完成。什么情况下异常不会被捕获？这可能是由于一些内存溢出或其他原因，因为该应用程序正在收集相当多的数据。

哦，我在添加之前遇到的异常`try`是“访问冲突”（还有什么？）并且 CPU 窗口指向非常低的地址。任何想法或指示将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T10:55:55.990

“非常低的地址”可能意味着有人试图在一个实际上并不存在的对象上调用虚拟方法（即“nil”）。例如：

TStringList(nil).清除；

不过，第一部分非常神秘。我不知道这怎么会发生。

我认为您应该尝试使用[madExcept](http://www.madshi.net/madExceptDescription.htm)来捕获该异常。它从来没有让我失望过。（免责声明：我没有使用 D7。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-09T12:04:21.140

废弃的堆栈或堆栈溢出都可能对堆栈上的结构造成无法弥补的损害，Windows 中的结构化异常处理 (SEH) 使用这些结构来查找实际的异常处理程序。

如果您在堆栈上的缓冲区中发生缓冲区溢出（例如，将静态数组作为局部变量但写入超出其末尾），并覆盖异常记录，那么您可以覆盖指向下一个异常的“下一个”指针记录在栈上。如果指针被破坏，操作系统就无法找到下一个异常处理程序并最终到达你的包罗万象的处理程序。

堆栈溢出是不同的：它们可以完全阻止调用函数，因为每个函数调用都需要至少一个双字的堆栈空间作为返回地址。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T23:02:03.073

你有很多很好的答案。我不得不追逐的最疯狂的问题来自巴里提到的堆栈损坏问题。我已经看到链接器页面上项目的“内存大小”部分发生了一些事情。我可能很迷信，但似乎更大并不一定更好。您可以考虑使用增强型内存管理器 FastMM4——它是免费的并且非常有用。

[http://sourceforge.net/projects/fastmm/](http://sourceforge.net/projects/fastmm/)

我已经将它与 d7 一起使用，并发现了一些对陈旧指针和其他邪恶事物的访问。

您可能还希望创建一种方法来跟踪有效对象和/或以其他方式检测代码，以使代码在工作时自行检查。

当我看到对 0x00001000 或更小的地址的访问时，我想到了对 nil 指针的访问。我的字符串列表：=无；我的字符串列表。清除；

当我看到访问具有更大数字的其他地址时，我会想到过时的指针。

当事情异常不稳定并且堆栈跟踪被证明是无稽之谈和/或变化很大时，我知道我有堆栈问题。有一次在 Controls.pas 中；下次它在 mmsys.pas 等中。

对 DLL 使用错误的调用约定也确实会弄乱您的堆栈。这是因为从 DLL 调用/返回时参数传递/释放。

MadExcept 将有助于找到此问题的根源，即使它显示出胡说八道......你会赢任何一种方式，因为你会知道问题发生在哪里，或者你会知道你有一个堆栈问题。

有没有什么测试框架可以放在上面来锻炼它？我发现它*非常*强大，因为它可以完全重复。

我用这种方式解决了一些非常难看的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T17:34:27.540

在调用一些使用安全调用调用约定的 COM 对象时，我曾经遇到过这种奇怪的行为。此对象/方法可能会引发 EOleException，而不是被客户端代码上通常的 try/except 捕获。您应该捕获一个 EOleException 并正确处理它。

```
try
...
except
on E: EOleException do
...
end; 
```

不知道是不是你面临的问题。但如果是这样，我建议您看一下[正确实现错误处理](http://www.techvanguards.com/com/tutorials/tips.asp)，这是一篇关于 delphi 异常处理的非常清晰的帖子。

您还可以启用您的 IDE 调试选项以在出现德里异常时停止并监控堆栈跟踪。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T19:09:38.660

我将把 except 可能不起作用的原因留给[Barry](https://stackoverflow.com/questions/186718/delphi-7-exception-not-caught#186956) ...

但我强烈建议一个简单的策略来缩小它发生的区域。将大块切成较小的部分

```
try
  OutputDebugString('entering part abc');
  ... // part abc code here
except
  OutputDebugString('horror in part abc');
  raise;
end;
...   
try
  OutputDebugString('entering in part xyz');
  ... // part xyz code here
except
  OutputDebugString('horror in part xyz');
  raise;
end; 
```

[并在旁边使用DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)运行您的代码...（适用于没有 GUI 的应用程序以及服务）。
您将看到执行了哪个部分以及是否在此处捕获了异常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T15:14:59.120

这可能是一个 DLL 还是一个 COM 对象？如果是这样，则主机应用程序可能将 FPUExcpetion 掩码设置为与 Delphi 习惯不同的东西。默认情况下，溢出会在 Delphi 中产生异常，但可以设置 FPUExcpetionmask 使其不会，并将值设置为 NAN。有关 FPUExceptionmask 的更多信息，请参阅 math.pas 单元

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-14T19:37:39.540

我在我的代码的初始化和终结块中遇到了异常，madExcept 甚至似乎都没有捕捉到。如果您在该 try 块内引用外部 DLL，则可能会发生这种情况。我不确定原因。

实际上（感谢@Gung 告诉我我的古老答案毫无价值），我最近在古老的 O'Reilly Delphi Tome 中读到了这篇文章。您应该将 SysUtils 作为第一个（或在您的非标准内存管理器单元之后的第二个）放在您的主窗体的 DPR 中，以便它驻留在内存中并具有所有它的异常捕获优点。否则，如果它是从其他单元加载的，它也将与该单元一起卸载，您可以告别内置的异常处理。

# windows - 如何将自定义协议添加到 Vista“设置关联”列表？

> ID：186723
> 
> 赞同：2
> 
> 时间：2008-10-09T10:50:33.830
> 
> 标签：windows, windows-vista, registry, protocols

我在 Windows Vista 上注册了自定义协议“xyz”：

```
HKEY\_CLASSES\_ROOT\xyz = "URL:Extensions Protocol" 
```

它适用于我的应用程序。

打开**“控制面板 -> 程序 -> 默认程序 -> 设置关联”**，将列表滚动到最后。这是协议列表。我想查看与我的应用程序关联的自定义协议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T04:08:07.650

If you can't find the extension you are looking for in the `Set Associations`, then first open `Command` prompt and type

```
assoc .abc= 
```

where *.abc* is the extension you want to associate. This will add the extension (in this example .abc) to the list of extensions in Set Associations. Then choose the program you want to use for opening files of that type in Set Associations. I haven't tested myself if this works for protocols as well but I don't see any reasons why it wouldn't.

# winapi - DrawFrameControl 中的 GDI 资源泄漏

> ID：186729
> 
> 赞同：2
> 
> 时间：2008-10-09T10:51:57.043
> 
> 标签：winapi, gdi, bounds-checker

似乎 DrawFrameControl() 创建了 Font 和 Brush 对象，将它们选择到 dc 中，并且没有删除它们。（根据 BoundsChecker 消息）。有没有人遇到过这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T11:40:13.433

我在各种 OS/CRT Dll 中都经历过同样的事情。其中一种模式是

*   我得到一个窗口的 DC（GetDC 或 GetWindowDC），以便执行我喜欢的任何操作（即创建一个兼容的内存 DC）。
*   完成后我释放 DC，即使我没有在其中选择任何 GDI 对象，有时我也会收到 Boundschecher 警告，指出设备上下文中仍有选定的对象。

由于这些警告绝对不在我的代码中，因此我建议对它们持保留态度。一般来说，我所做的是清理所有引用我的代码的 BC 警告。

题外话：BC 抛出了许多开发人员无法在其代码中修复的警告。在 stl 中，您将收到无数警告，但其中大多数是“比较不相关的指针”。这并不意味着 BC 错误地扔了它们。在常规应用程序中“比较不相关的指针”可能是一场灾难，但我认为编写 stl 实现的人知道他们在做什么，并且可能已经检查了这些案例。

# php - How do I detect Mobile Safari server side using PHP?

> ID：186734
> 
> 赞同：8
> 
> 时间：2008-10-09T10:54:32.747
> 
> 标签：php, iphone, optimization, mobile-safari

Mobile Safari is a very capable browser, and it can handle my website as it is perfectly. However, there are a few elements on my page that could be optimized for browsing using this device; such as serving specific thumbnails that are smaller than the desktop counterparts to help fit more content into the screen.

I would like to know how I can detect Mobile Safari (all versions, preferably) using PHP, so then I can serve a) a specific css file and b) different sized image thumbnails.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-09T11:12:04.130

Thanks Joe, I read that page and found the [WebKit detection library](http://trac.webkit.org/wiki/DetectingWebKit) (in JavaScript). I changed the code to suit my needs.

For anyone that's interested, here's my solution.

```
<?php

/* detect Mobile Safari */

$browserAsString = $_SERVER['HTTP_USER_AGENT'];

if (strstr($browserAsString, " AppleWebKit/") && strstr($browserAsString, " Mobile/"))
{
    $browserIsMobileSafari = true;
}

?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T10:57:05.517

```
$_SERVER['HTTP_USER_AGENT'] 
```

That will give you the user-agent string back which you can compare to mobile safari.

p.s. [http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/) WURFL may help you determine which UAs you want.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T10:59:50.270

Compare the user agent string with the one of a Safari Mobile uses:

[Safari Mobile User Agent String](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/OptimizingforSafarioniPhone/OptimizingforSafarioniPhone.html#//apple_ref/doc/uid/TP40006517-SW3)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-20T14:27:55.857

I have published a new mode to detect devices in any programming language (JSP, PHP, Perl, Python.....), it's called Apache Mobile Filter is an Apache module ([http://modules.apache.org/search.php?id=1787](http://modules.apache.org/search.php?id=1787)) that detect mobile device and also can adapt the images to the screen size of device.

For more info: [http://www.idelfuschini.it/it/apache-mobile-filter-v2x.html](http://www.idelfuschini.it/it/apache-mobile-filter-v2x.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-16T18:47:07.250

Mozilla/5.0 (webOS/1.0; U; en-US) AppleWebKit/525.27.1 (KHTML, like Gecko) Version/1.0 Safari/525.27.1 Pre/1.0 that is the browser for the palm Pre, and the word 'Mobile' is not there.

I am working on making my detect work fully with all newer capable browsers. After looking at the mytouch, G1, Palm Pre, droid and others, (but not all) I am now confident this is workable for all new phones:

if(preg_match("/applewebkit/i", $_SERVER['HTTP_USER_AGENT']) && preg_match("/(mobile|pre)/i", $_SERVER['HTTP_USER_AGENT'])) header("Location: [http://simplefoodie.com/iphone/?carryover=](http://simplefoodie.com/iphone/?carryover=)".urlencode($_SERVER[REQUEST_URI]));

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-17T09:25:08.220

```
<?php

// detect Safari only!

$string = $_SERVER['HTTP_USER_AGENT'];

if (strstr($string, " AppleWebKit/") && strstr($string, " Safari/") && !strstr($string, " CriOS"))
    {
        echo 'See in Safari only';
    }

?> 
```

# windows - 在 Windows 中删除大文件夹的最快方法是什么？

> ID：186737
> 
> 赞同：224
> 
> 时间：2008-10-09T10:55:05.210
> 
> 标签：windows, windows-xp, file-management

我想删除一个包含数千个文件和文件夹的文件夹。如果我使用 Windows 资源管理器删除该文件夹，可能需要 10-15 分钟（并非总是如此，但经常如此）。Windows 中是否有更快的方法来删除文件夹？

其他详情：

*   我不关心回收站。
*   它是一个 NTFS 驱动器。

* * *

## 回答 #1

> 赞同：1040
> 
> 时间：2011-06-01T21:49:07.383

最糟糕的方法是发送到回收站：您仍然需要删除它们。下一个最糟糕的是使用 Windows 资源管理器进行 shift+delete：它会在开始删除任何内容之前浪费大量时间检查内容。

下一个最好的方法是`rmdir /s/q foldername`从命令行使用。`del /f/s/q foldername`也很好，但它留下了目录结构。

我发现最好的是一个两行批处理文件，第一遍删除文件并输出到 nul 以避免为每个单个文件写入屏幕的开销。然后第二遍清理剩余的目录结构：

```
del /f/s/q foldername > nul
rmdir /s/q foldername 
```

根据使用 Windows XP 加密磁盘的时间测试，这比单个 rmdir 快了近三倍，删除 ~30GB/1,000,000 个文件/15,000 个文件夹：`rmdir`大约需要 2.5 小时，`del+rmdir`大约需要 53 分钟。更多信息在[超级用户](https://superuser.com/questions/19762/mass-deleting-files-in-windows/289399#289399)。

这对我来说是一项常规任务，因此我通常将需要删除的内容移动到 C:\stufftodelete 并将这些`del+rmdir`命令放在 deletestuff.bat 批处理文件中。这计划在晚上运行，但有时我需要在白天运行它，所以越快越好。

`del`可以在[此处](https://technet.microsoft.com/en-us/library/cc771049(v=ws.11).aspx)找到有关命令的 Technet 文档。关于上面使用的参数的附加信息：

*   `/f`- 强制（即删除文件，即使它们是只读的）
*   `/s`- 递归/包含子文件夹（此定义来自[SS64](https://ss64.com/nt/del.html)，因为 technet 只是简单地说明了“指定文件”，这没有帮助）。
*   `/q`- 安静（即不提示用户确认）

`rmdir` [此处](https://technet.microsoft.com/en-us/library/cc726055(v=ws.11).aspx)的文档。参数是：

*   `/s`- 递归（即与del的/s参数相同）
*   `/q`- 安静（即与del的/q参数相同）

* * *

## 回答 #2

> 赞同：374
> 
> 时间：2008-10-09T10:59:14.157

### 使用 Windows 命令提示符：

```
rmdir /s /q folder 
```

### 使用 Powershell：

```
powershell -Command "Remove-Item -LiteralPath 'folder' -Force -Recurse" 
```

请注意，在更多情况下`del`，`rmdir`会留下剩余文件，Powershell 会设法删除这些文件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-23T14:12:51.590

使用[fastcopy](http://www.ipmsg.org/tools/fastcopy.html.en)，一个免费的工具。它有一个删除选项，比 Windows 删除文件的方式快得多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T11:04:13.647

按照建议使用命令提示符。不久前我弄清楚了为什么资源管理器这么慢，它可以让您估计删除文件/文件夹需要多长时间。为此，它必须扫描项目的数量和大小。这需要很长时间，因此大文件夹的等待很可笑。

此外，如果文件存在特定问题，资源管理器将停止，

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T07:27:48.053

并且要删除很多文件夹，您还可以使用发布的命令 spdenne 创建一个批处理文件。

1）制作一个包含以下内容的文本文件，用您的文件夹名称替换引号中的文件夹名称：

```
rmdir /s /q "My Apps"  
rmdir /s /q "My Documents"  
rmdir /s /q "My Pictures"  
rmdir /s /q "My Work Files" 
```

2) 以 .bat 扩展名保存批处理文件（例如 deletefiles.bat）
3) 打开命令提示符（开始 > 运行 > Cmd）并执行批处理文件。您可以在命令提示符下执行此操作（用 X 代替您的驱动器号）：

```
X:  
deletefiles.bat 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2011-06-15T09:16:36.483

试试`Shift`+ `Delete`。为我在 2 分钟内完成了 24.000 个文件。

# grails - Groovy“例外”语法？

> ID：186752
> 
> 赞同：1
> 
> 时间：2008-10-09T11:01:19.143
> 
> 标签：grails, groovy

我是一个完全的 Groovy 新手。[我在这里](http://docs.huihoo.com/grails/1.0.3/ref/Controllers/beforeInterceptor.html)看到了以下代码。

```
def beforeInterceptor = [action:this.&auth,except:'login'] 
```

如果操作是“login2”，我将如何扩展它以包含第二个异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T11:37:02.863

哇，本来希望对此有一个快速的回答！

好吧，找到了我自己的答案：除了例外，你不能有多个例外。

请参阅此处的[功能请求](http://jira.codehaus.org/browse/GRAILS-92)。

相反，他们建议创建一个过滤器。[见这里](http://docs.huihoo.com/grails/1.0.3/guide/single.html#6.1.5+Controller+Interceptors)。

# sql - 在 MySQL 中生成一系列数字

> ID：186756
> 
> 赞同：61
> 
> 时间：2008-10-09T11:03:40.700
> 
> 标签：sql, mysql

如何从 MySQL 查询中生成一系列连续数字（每行一个），以便我可以将它们插入到表中？

例如：

```
nr
1
2
3
4
5 
```

我只想为此使用 MySQL（不是 PHP 或其他语言）。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-09T14:04:20.680

这是一种没有循环的基于集合的方法。这也可以制成视图以供重用。该示例显示了从 0 到 999 的序列的生成，但当然，可以对其进行修改以适应。

```
INSERT INTO
    myTable
    (
    nr
    )
SELECT
    SEQ.SeqValue
FROM
(
SELECT
    (HUNDREDS.SeqValue + TENS.SeqValue + ONES.SeqValue) SeqValue
FROM
    (
    SELECT 0  SeqValue
    UNION ALL
    SELECT 1 SeqValue
    UNION ALL
    SELECT 2 SeqValue
    UNION ALL
    SELECT 3 SeqValue
    UNION ALL
    SELECT 4 SeqValue
    UNION ALL
    SELECT 5 SeqValue
    UNION ALL
    SELECT 6 SeqValue
    UNION ALL
    SELECT 7 SeqValue
    UNION ALL
    SELECT 8 SeqValue
    UNION ALL
    SELECT 9 SeqValue
    ) ONES
CROSS JOIN
    (
    SELECT 0 SeqValue
    UNION ALL
    SELECT 10 SeqValue
    UNION ALL
    SELECT 20 SeqValue
    UNION ALL
    SELECT 30 SeqValue
    UNION ALL
    SELECT 40 SeqValue
    UNION ALL
    SELECT 50 SeqValue
    UNION ALL
    SELECT 60 SeqValue
    UNION ALL
    SELECT 70 SeqValue
    UNION ALL
    SELECT 80 SeqValue
    UNION ALL
    SELECT 90 SeqValue
    ) TENS
CROSS JOIN
    (
    SELECT 0 SeqValue
    UNION ALL
    SELECT 100 SeqValue
    UNION ALL
    SELECT 200 SeqValue
    UNION ALL
    SELECT 300 SeqValue
    UNION ALL
    SELECT 400 SeqValue
    UNION ALL
    SELECT 500 SeqValue
    UNION ALL
    SELECT 600 SeqValue
    UNION ALL
    SELECT 700 SeqValue
    UNION ALL
    SELECT 800 SeqValue
    UNION ALL
    SELECT 900 SeqValue
    ) HUNDREDS
) SEQ 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2011-12-01T23:26:26.860

[这是匹兹堡 DBA 解决方案](https://stackoverflow.com/a/187410)的硬件工程师版本：

```
SELECT
    (TWO_1.SeqValue + TWO_2.SeqValue + TWO_4.SeqValue + TWO_8.SeqValue + TWO_16.SeqValue) SeqValue
FROM
    (SELECT 0 SeqValue UNION ALL SELECT 1 SeqValue) TWO_1
    CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 2 SeqValue) TWO_2
    CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 4 SeqValue) TWO_4
    CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 8 SeqValue) TWO_8
    CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 16 SeqValue) TWO_16; 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-10-09T11:24:58.770

如果您需要表中的记录并且想要避免并发问题，请按照以下步骤操作。

首先，您创建一个表来存储您的记录

```
CREATE TABLE `incr` (
  `Id` int(11) NOT NULL auto_increment,
  PRIMARY KEY  (`Id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8; 
```

其次创建一个这样的存储过程：

```
DELIMITER ;;
CREATE PROCEDURE dowhile()
BEGIN
  DECLARE v1 INT DEFAULT 5;
  WHILE v1 > 0 DO
    INSERT incr VALUES (NULL);
    SET v1 = v1 - 1;
  END WHILE;
END;;
DELIMITER ; 
```

最后调用 SP：

```
CALL dowhile();
SELECT * FROM incr; 
```

结果

```
Id
1
2
3
4
5 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2011-12-13T23:56:54.197

假设您想在表中插入数字 1 到 100。只要您有一些其他表至少有那么多行（与表的内容无关），那么这是我的首选方法：

```
INSERT INTO pivot100 
SELECT @ROW := @ROW + 1 AS ROW
 FROM someOtherTable t
 join (SELECT @ROW := 0) t2
 LIMIT 100
; 
```

想要一个以非 1 开头的范围？只需更改 @ROW 在加入时设置的内容。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-09T11:12:23.397

```
DECLARE i INT DEFAULT 0;

WHILE i < 6 DO
  /* insert into table... */
  SET i = i + 1;
END WHILE; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-01-22T15:04:19.110

大家都明白，这是相当hacky所以小心使用

```
SELECT
  id % 12 + 1 as one_to_twelve
FROM
  any_large_table
GROUP BY
  one_to_twelve
; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-11-02T20:15:02.687

与接受的响应非常相似，但使用`WITH`mysql >= 8.0 的新语法，这使得更易读，意图也更清晰

```
WITH DIGITS (N) AS (
  SELECT 0 UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL
  SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL
  SELECT 8 UNION ALL SELECT 9)
SELECT 
  UNITS.N + TENS.N*10 + HUNDREDS.N*100 + THOUSANDS.N*1000 
FROM 
  DIGITS AS UNITS, DIGITS AS TENS, DIGITS AS HUNDREDS, DIGITS AS THOUSANDS; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-08-23T06:16:17.437

所有其他答案都很好，但是它们都存在较大范围的速度问题，因为它们强制 MySQL 生成每个数字然后过滤它们。

以下仅使 MySQL 生成所需的数字，因此更快：

```
set @amount = 55; # How many numbers from zero you want to generate

select `t0`.`i`+`t1`.`i`+`t2`.`i`+`t3`.`i` as `offset`
from
(select 0 `i` union select 1 union select 2 union select 3 union select 4 union select 5 union select 6 union select 7 union select 8 union select 9) `t0`,
(select 0 `i` union select 10 union select 20 union select 30 union select 40 union select 50 union select 60 union select 70 union select 80 union select 90) `t1`,
(select 0 `i` union select 100 union select 200 union select 300 union select 400 union select 500 union select 600 union select 700 union select 800 union select 900) `t2`,
(select 0 `i` union select 1000 union select 2000 union select 3000 union select 4000 union select 5000 union select 6000 union select 7000 union select 8000 union select 9000) `t3`
where `t3`.`i`<@amount
and `t2`.`i`<@amount
and `t1`.`i`<@amount
and `t0`.`i`+`t1`.`i`+`t2`.`i`+`t3`.`i`<@amount; 
```

使用上述方法，您可以生成多达 10,000 个数字（0 到 9,999），而对于较小的数字，无论它们有多低，都不会产生较慢的速度开销。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-03-05T20:16:34.753

我知道（在 MySQL 中）创建具有长序列的表的“最短”方法是将现有表与其自身（交叉）连接。由于任何（常见）MySQL 服务器都有`information_schema.COLUMNS`我会使用它的表：

```
DROP TABLE IF EXISTS seq;
CREATE TABLE seq (i MEDIUMINT AUTO_INCREMENT PRIMARY KEY)
    SELECT NULL AS i
    FROM information_schema.COLUMNS t1
    JOIN information_schema.COLUMNS t2
    JOIN information_schema.COLUMNS t3
    LIMIT 100000; -- <- set your limit here 
```

通常一个连接应该足以创建超过 100 万行 - 但再连接一个不会受到伤害:-) - 只是不要忘记设置限制。

如果要包含`0`，则应“删除”该`AUTO_INCEMENT`属性。

```
ALTER TABLE seq ALTER i DROP DEFAULT;
ALTER TABLE seq MODIFY i MEDIUMINT; 
```

现在您可以插入`0`

```
INSERT INTO seq (i) VALUES (0); 
```

和负数

```
INSERT INTO seq (i) SELECT -i FROM seq WHERE i <> 0; 
```

您可以使用验证数字

```
SELECT MIN(i), MAX(i), COUNT(*) FROM seq; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-11T16:47:36.830

这是基于先前的答案（[https://stackoverflow.com/a/53125278/2009581](https://stackoverflow.com/a/53125278/2009581)），但与 MySQL 5.7 兼容。它适用于副本和只读用户：

```
SELECT x1.N + x10.N*10 + x100.N*100 + x1000.N*1000
  FROM (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) x1,
       (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) x10,
       (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) x100,
       (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) x1000
 WHERE x1.N + x10.N*10 + x100.N*100 + x1000.N*1000 <= @max; 
```

它生成 [0, `@max`] 范围内的整数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-14T23:43:04.940

我想分享的想法不是对这个问题的精确回答，但对某些人可能有用，所以我想分享它。

如果您经常只需要一组有限的数字，那么创建一个包含您可能需要的数字的表格并每次都使用该表格会很有帮助。例如：

```
CREATE TABLE _numbers (num int);
INSERT _numbers VALUES (0), (1), (2), (3), ...; 
```

仅当您需要低于某个合理限制的数字时才可以应用此方法，因此不要将其用于生成序列 1...100 万，但可以用于例如数字 1...10k。

如果您在`_numbers`表中有这个数字列表，那么您可以编写这样的查询，以获取字符串的各个字符：

```
SELECT number, substr(name, num, 1) 
    FROM users
    JOIN _numbers ON num < length(name)
    WHERE user_id = 1234
    ORDER BY num; 
```

如果您需要大于 10k 的数字，则可以将表连接到自身：

```
SELECT n1.num * 10000 + n2.num
    FROM _numbers n1
    JOIN _numbers n2
    WHERE n1 < 100 
    ORDER BY n1.num * 10000 + n2.num; -- or just ORDER BY 1 meaning the first column 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-02-16T15:07:09.347

如果您有 MySql 8 及更高版本，这是一种使用 json_table 的方法：

```
set @noRows = 100;
SELECT tt.rowid - 1 AS value
  FROM JSON_TABLE(CONCAT('[{}', REPEAT(',{}', @noRows - 1), ']'),
                  "$[*]" COLUMNS(rowid FOR ORDINALITY)
       ) AS tt; 
```

（h/t - [https://www.percona.com/blog/2020/07/27/generating-numeric-sequences-in-mysql/](https://www.percona.com/blog/2020/07/27/generating-numeric-sequences-in-mysql/)）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-06-15T05:11:59.950

带递归 cte..

```
 with recursive rnums as (
  select 1 as n
      union all
  select n+1 as n from rnums
      where n <10
  )
  select * from rnums
  ; 
```

结果将是.. +-----+ | n | +--------+ | 1 | | 2 | | 3 | | 4 | | 5 | | 6 | | 7 | | 8 | | 9 | | 10 | +-----+ 10 行（0.00 秒）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-04T20:10:59.457

在 MariaDB 中，您可以：

选择 * FROM seq_i_to_N

例如：

选择 * 从 seq_0_to_1000

选择 * FROM seq_1_to_1000000

参考：[https ://www.percona.com/blog/2020/07/27/generating-numeric-sequences-in-mysql/](https://www.percona.com/blog/2020/07/27/generating-numeric-sequences-in-mysql/)

# apache-flex - 您可以通过 Flex 使用 Amazon S3 吗？

> ID：186768
> 
> 赞同：8
> 
> 时间：2008-10-09T11:06:46.357
> 
> 标签：apache-flex, amazon-web-services, amazon-s3

由于缺少 clientaccesspolicy.xml，通过 Flex 使用 Amazon S3 似乎存在问题。有解决办法吗？

**编辑：**以下两个答案都很棒并且有效，我都赞成（我不会为这个问题分配答案，因为它们都有效）：

[您可以通过 Flex 使用 Amazon S3 吗？](https://stackoverflow.com/questions/186768/can-you-use-amazon-s3-via-flex#186889)

[您可以通过 Flex 使用 Amazon S3 吗？](https://stackoverflow.com/questions/186768/can-you-use-amazon-s3-via-flex#194362)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T11:49:12.277

您可以对您在 Amazon S3 中控制的子域进行 CNAME（到具有子域名称的存储桶），如下所示：

[http://s3.ceejayoz.com/](http://s3.ceejayoz.com/)（转到我的“s3.ceejayoz.com”存储桶）

如果我正确理解您的问题，将您自己的 clientaccesspolicy.xml 文件上传到该存储桶的根目录（并将权限设置为全局可见）应该可以解决问题，因为它可以在[http://s3.ceejayoz访问.com/clientaccesspolicy.xml](http://s3.ceejayoz.com/clientaccesspolicy.xml)。

S3 文档中的更多信息：[http ://docs.amazonwebservices.com/AmazonS3/2006-03-01/index.html?VirtualHosting.html](http://docs.amazonwebservices.com/AmazonS3/2006-03-01/index.html?VirtualHosting.html)

**编辑：**从这个角度来看，您还可以使用没有 CNAME 的“示例虚拟托管样式方法”：http: [//bucketname.s3.amazonaws.com/clientaccesspolicy.xml](http://bucketname.s3.amazonaws.com/clientaccesspolicy.xml)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-11T17:38:45.023

是的。您可以在以下位置找到用于连接到 S3 的 ActionScript 3 库：

[http://code.google.com/p/as3awss3lib/](http://code.google.com/p/as3awss3lib/)

更多信息请访问：

[http://weblogs.macromedia.com/cantrell/archives/2007/05/actionscript_li.html](http://weblogs.macromedia.com/cantrell/archives/2007/05/actionscript_li.html)

您可以通过查看 S3E AIR 应用程序来查看正在使用的 API 示例：

[http://download.macromedia.com/pub/developer/air/sample_apps/S3E.air](http://download.macromedia.com/pub/developer/air/sample_apps/S3E.air)

您可以从以下位置获取源代码：

[http://download.macromedia.com/pub/developer/air/sample_apps/S3E.zip](http://download.macromedia.com/pub/developer/air/sample_apps/S3E.zip)

希望有帮助...

迈克室

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-07T10:26:49.113

如果您正在寻找一个可用的 Rails - Flex - S3 示例，请查看这个 rails 项目：http: [//github.com/GreenAsJade/s3-swf-upload-plugin](http://github.com/GreenAsJade/s3-swf-upload-plugin)

它记录在案并且开箱即用。您甚至可以对 Flex 逻辑进行逆向工程。

# c# - 从 WinForms 过渡到 AJAX，我需要知道什么？

> ID：186785
> 
> 赞同：1
> 
> 时间：2008-10-09T11:13:32.240
> 
> 标签：c#, .net, ajax, user-interface, asp.net-ajax

我目前有一个正常运行的内部 Windows 窗体应用程序，它广泛使用`DataGridView`控件进行数据输入。当我们将其推广到更多位置时，预​​计会出现一些支持问题，因此我们的一位顾问建议将具有基本相同功能的 AJAX 应用程序放在一起。

过去我曾在旧模型中使用过 ASP.NET，其中基本上所有内容都发送到服务器，但我听说 AJAX 应用程序可以使 UI 响应性更强。

所以我的问题是，对于主要在 WinForms C# 中工作的人来说，开始使用 AJAX 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T11:21:02.553

最简单但不一定是最好的方法是熟悉 UpdatePanel，它是 ASP.net AJAX 控件的一部分。您可以使用 ASP.net GridView 控件（它共享大部分 Winforms 等效功能），将 UpdatePanel 包裹在它周围，然后您就离开了。

从那以后，您将希望参与 web/wcf 服务以从 javascript 调用服务器并根据响应更新您的 UI。这当然需要更多的时间、精力和知识！

您可以购买许多 gridview 控件，这些控件会有所帮助，例如 One from Essential objects 不错，但并不完美，但与 Telerik 和其他大牌产品相比非常便宜。

ASP.net 仍然是一种基于服务器的技术，但是通过包含 ASP.net 对服务器的 AJAX 调用很容易，并且使用 jQuery 更新 UI 变得更加容易！

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T21:12:28.973

您想要做的并不难，尤其是使用 Telerik 或 Infragistic 的控件时，但正如之前的评论者所说，它们并不便宜。如果您不想花时间滚动自己的响应式和可编辑网格，它们可能物有所值。

# linux - Linux 中的最佳安全实践

> ID：186789
> 
> 赞同：1
> 
> 时间：2008-10-09T11:15:37.273
> 
> 标签：linux, security, selinux

在维护 Linux 服务器时，您强烈推荐哪些安全最佳实践？
（即打开防火墙，禁用不必要的服务，提防 suid 可执行文件，等等。）

另外：是否有关于 Selinux 的明确参考？

编辑：是的，我打算把机器放在互联网上，至少有 openvpn、ssh 和 apache（目前，没有动态内容），并为某些人提供 shell 访问。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T11:31:53.153

对于 SELinux，我发现[SELinux By Example](https://rads.stackoverflow.com/amzn/click/com/0131963694)非常有用。它非常深入地保持服务器尽可能安全，并且针对如此广泛的主题编写得非常好。

但总的来说：

*   禁用任何你不需要的东西。攻击范围越广，您就越有可能遭到破坏。
*   在任何有意义的服务器前使用入侵检测系统 (IDS) 层。
*   将服务器保持在与内部网络不同的安全区域中。
*   尽快部署更新。
*   随时了解可远程访问的应用程序的 0 天攻击。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T11:27:17.127

简短的回答是，这取决于。这取决于您使用它的目的，这反过来又会影响您应该投入多少精力来保护它。

这个问题的答案中有一些方便的提示： [Securing a linux webserver for public access](https://stackoverflow.com/questions/5078/personal-linux-web-server)

如果您不将盒子扔到互联网上，那么其中一些答案将不相关。如果你把它扔到互联网上*并*在上面托管一些甚至有点有趣的东西，那么这些答案对你来说太自由放任了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T12:11:18.363

有一个 NSA 文件“RHEL5 的 NSA 安全指南”可在以下位置获得：

[http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf](http://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf)

这很有帮助，至少是系统的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-09T13:05:12.937

*   将软件限制为您真正使用的唯一软件
*   通过 sudo、ACL、内核功能和 SELinux/AppArmor/PaX 策略限制用户的权限
*   强制使用硬密码（没有人类可以理解的单词，没有生日日期等）
*   为“危险”应用程序制作 LXC 计数器、chroot 或 vserver 监狱
*   安装一些 IDS，例如用于网络流量的 Snort 和用于日志分析的 OSSEC
*   监控服务器
*   加密您的敏感数据（truecrypt 是神的礼物）
*   用 GRSecurity 给你的内核打补丁：这增加了一个非常好的偏执水平

这或多或少是我会做的。

编辑：我添加了一些我以前忘记命名的想法......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T11:25:59.703

1.) 仅启用必要和相关的端口。

2.) 定期扫描网络数据进出

3.) 定期扫描访问服务器的 IP 地址，并验证是否从日志/跟踪中发现与这些 IP 地址相关的任何异常数据活动

4.）如果一些关键和机密的数据和代码，需要在服务器上存在，可能是可以加密的

-广告

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-20T00:34:32.377

目标：最困难的部分始终是定义您的安全目标。在这一点上，其他一切都相对容易。

探测/研究：考虑攻击者采取的相同方法，即网络侦察（namp 对此非常有帮助）。

更多信息：SELinux by example 是一本很有帮助的书，要找到一个集中的 SELinux 信息来源仍然很困难。我有一小部分有用的链接，我不时觉得这些链接很有用[http://delicious.com/reverand_13/selinux](http://delicious.com/reverand_13/selinux)

有用的解决方案/工具：正如大多数人所说的，少即是多。对于带有 SELinux 的开箱即用的精简框，我建议使用剪辑 ( [http://oss.tresys.com/projects/clip](http://oss.tresys.com/projects/clip) )。我的一个朋友在一个学术模拟中使用了它，在这个模拟中，盒子受到其他参与者的直接攻击。我记得这个故事对这个盒子的结局非常有利。

您将希望熟悉编写 SELinux 策略。模块化策略也可以变得有用。诸如 SLIDE 和 seedit 之类的工具（尚未尝试过）可能会对您有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T13:29:48.020

除非必须，否则不要使用 DNS 服务器。BIND 一直是安全问题和漏洞利用的热点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-04T22:46:00.540

强化 Linux 服务器是一个庞大的主题，主要取决于您的需求。

通常，您需要考虑以下关注组（我将举例说明每个组中的最佳实践）：

1.  **引导和磁盘**
    Ex1：禁用从外部设备引导。
    Ex2：为 GRUB 引导加载程序设置密码 - [Ref](https://www.cyberciti.biz/tips/how-do-i-secure-grub-boot-loader.html)。

2.  **文件系统分区**
    Ex1：将用户分区 ( `/home`, `/tmp`, `/var`) 与操作系统分区分开。
    Ex2：`nosuid`在分区上设置——为了防止权限升级`setuid`。

3.  **内核**
    Ex1：更新安全补丁。
    Ex2：在[这里](https://www.howtoforge.com/hardening-the-linux-kernel-with-grsecurity-debian)阅读更多内容。

4.  **联网**
    Ex1：关闭未使用的端口。
    Ex2：禁用 IP 转发。
    Ex3：禁用发送数据包重定向。

5.  **用户/帐户**
    Ex1：强制使用强密码 (SHA512)。
    Ex2：设置密码的时效和过期。
    Ex3：限制用户使用旧密码。

6.  **审计和日志记录**
    Ex1：Configure `auditd`- [ref](https://sematext.com/blog/auditd-logs-auditbeat-elasticsearch-logsene/)。
    Ex2：使用 journald- [ref](https://dzone.com/articles/why-journald)配置日志记录。

7.  **服务**
    Ex1：删除未使用的服务，例如：FTP、DNS、LDAP、SMB、DHCP、NFS、SNMP 等。
    EX2：如果您使用的是 Apache 或 nginx 之类的 Web 服务器 - 不要以 root 身份运行它们 -[在此处](https://geekflare.com/apache-web-server-hardening-security/)阅读更多信息。
    Ex3：安全 SSH[参考](http://acmeextension.com/secur-ssh-server/)。

8.  **软件**
    确保删除未使用的软件包。

阅读更多：

[https://www.computerworld.com/article/3144985/linux-hardening-a-15-step-checklist-for-a-secure-linux-server.html](https://www.computerworld.com/article/3144985/linux-hardening-a-15-step-checklist-for-a-secure-linux-server.html)

[https://www.tecmint.com/linux-server-hardening-security-tips/](https://www.tecmint.com/linux-server-hardening-security-tips/)

[https://cisofy.com/checklist/linux-security/](https://cisofy.com/checklist/linux-security/)

[https://www.ucd.ie/t4cms/UCD%20Linux%20Security%20Checklist.pdf](https://www.ucd.ie/t4cms/UCD%20Linux%20Security%20Checklist.pdf)

[https://www.cyberciti.biz/faq/linux-kernel-etcsysctl-conf-security-hardening/](https://www.cyberciti.biz/faq/linux-kernel-etcsysctl-conf-security-hardening/)

[https://securecompliance.co/linux-server-hardening-checklist/](https://securecompliance.co/linux-server-hardening-checklist/)

* * *

现在专门针对 SELinux：
首先，确保在您的机器中启用了 SELinux。

继续阅读以下指南：
[https ://www.digitalocean.com/community/tutorials/an-introduction-to-selinux-on-centos-7-part-1-basic-concepts](https://www.digitalocean.com/community/tutorials/an-introduction-to-selinux-on-centos-7-part-1-basic-concepts)

[https://linuxtechlab.com/beginners-guide-to-selinux/](https://linuxtechlab.com/beginners-guide-to-selinux/)

[https://www.computernetworkingnotes.com/rhce-study-guide/selinux-explained-with-examples-in-easy-language.html](https://www.computernetworkingnotes.com/rhce-study-guide/selinux-explained-with-examples-in-easy-language.html)

# language-agnostic - How to determine what log level to use?

> ID：186798
> 
> 赞同：63
> 
> 时间：2008-10-09T11:18:27.737
> 
> 标签：language-agnostic, logging, verbosity

The log levels WARN, ERROR and FATAL are pretty clear. But when is something DEBUG, and when INFO?

I've seen some projects that are annoyingly verbose on the INFO level, but I've also seen code that favors the DEBUG level too much. In both cases, useful information is hidden in the noise.

What are the criteria for determining log levels?

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2008-10-09T11:33:40.483

I don't think there are any hard-and-fast rules; using the log4j-type levels, my 'rules of thumb' are something like:

*   **FATAL**: the app (or at the very least a thread) is about to die horribly. This is where the info explaining *why* that's happening goes.
*   **ERROR**: something that the app's doing that it shouldn't. This isn't a user error ('invalid search query'); it's an assertion failure, network problem, etc etc., probably one that is going to abort the current operation
*   **WARN**: something that's concerning but not causing the operation to abort; # of connections in the DB pool getting low, an unusual-but-expected timeout in an operation, etc. I often think of 'WARN' as something that's useful in aggregate; e.g. grep, group, and count them to get a picture of what's affecting the system health
*   **INFO**: Normal logging that's part of the normal operation of the app; diagnostic stuff so you can go back and say 'how often did this broad-level operation happen?', or 'how did the user's data get into this state?'
*   **DEBUG**: Off by default, able to be turned on for debugging specific unexpected problems. This is where you might log detailed information about key method parameters or other information that is useful for finding likely problems in specific 'problematic' areas of the code.
*   **TRACE**: "Seriously, WTF is going on here?!?! I need to log every single statement I execute to find this @#$@ing memory corruption bug before I go insane"

Not set in stone, but a rough idea of how I think of it.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-09T11:27:25.520

Informally I use this sort of hierarchy,

*   DEBUG - actual trace values
*   INFO - Something just happened - nothing important, just a flag
*   WARN - everything's working, but something isn't quite what was expected
*   ERROR - something has happened that will need to be fixed, but we can carry on and do other (independent) activities
*   FATAL - a serious enough problem that we shouldn't even carry on

I'll generally release with INFO being logged, but only if I know that log files are actually reviewed (and size isn't an issue), otherwise it's WARN.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-09T11:22:16.917

Think about who needs to use each level. In my code I keep **DEBUG** reserved for a developer output, e.g. output that would only help a developer. **VERBOSE** is used for a normal user when alot of info is needed. **INFO** I use to normally show major events (e.g. sending a webpage, checking something important).

And **FAIL** and **WARN** are pretty self explanatory.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T11:28:19.073

The convention in my team is to use `debug` if something is calculated in the message, whereas `info` is used for plain text. So in effect `info` will show you what's happening and `debug` will show the values of the things that are happening.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T12:02:55.963

I tend to target INFO towards the user to give them messages that aren't even warnings. DEBUG tends to be for developer use where I output messages to help trace the flow through the code (with values of variables as well).

I also like another level of DEBUG (DEBUG2?) which gives absolute bucketloads of debug information such as hex dumps of all buffers and so on.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-10T19:11:12.807

There's no need for a DEBUG2 level. That's what 'TRACE' is for. TRACE is intended to be the absolute lowest level of logging outputting every possible piece of information you might want to see.

To avoid a deluge of information, it is generally not recommended that you enable trace-level logging across an entire project. Instead use 'DEBUG' to find out general information about the bug and where it occurs (hence the name), and then enable TRACE only for that component if you still can't figure it out.

# java - ResultSet：按索引检索列值与按标签检索

> ID：186799
> 
> 赞同：52
> 
> 时间：2008-10-09T11:18:50.233
> 
> 标签：java, optimization, jdbc, resultset, maintenance

使用 JDBC 时，我经常遇到类似的结构

```
ResultSet rs = ps.executeQuery();
while (rs.next()) {
    int id = rs.getInt(1);
    // Some other actions
} 
```

我问自己（以及代码作者）为什么不使用标签来检索列值：

```
int id = rs.getInt("CUSTOMER_ID"); 
```

我听到的最好的解释是关于性能的。但实际上，它是否使处理速度非常快？我不相信，尽管我从未进行过测量。在我看来，即使按标签检索会慢一些，但它提供了更好的可读性和灵活性。
那么有人可以给我很好的解释来避免通过列索引而不是列标签来检索列值吗？两种方法的优缺点是什么（也许，关于某些 DBMS）？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-10-09T11:26:27.550

警告：我要在这里夸夸其谈，因为这让我发疯。

99%* 的时间里，人们有一些模糊的想法让事情变得“更好”是一种荒谬的微优化。这完全忽略了这样一个事实，除非您一直处于极其紧凑和繁忙的循环中，处理数百万个 SQL 结果（希望这种*情况*很少见），否则您永远不会注意到它。对于不这样做的每个人，开发人员维护、更新和修复列索引中的错误的时间成本远远大于性能极差的应用程序的硬件增量成本。

不要对这样的优化进行编码。为维护它的人编写代码。然后观察、测量、分析和优化。再观察，再测量，再分析，再优化。

优化几乎是开发的最后一步，而不是第一步。

* 图是组成的。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-10-09T14:07:06.493

您应该**默认使用字符串标签。**

**优点：**

*   列顺序的独立性
*   更好的可读性/可维护性

**缺点：**

*   您无法控制列名（通过存储过程访问）

**你更喜欢哪个？**

整数？

```
int i = 1;  
customerId = resultSet.getInt(i++);  
customerName = resultSet.getString(i++);  
customerAddress = resultSet.getString(i++); 
```

还是字符串？

```
customerId = resultSet.getInt("customer_id");  
customerName = resultSet.getString("customer_name");  
customerAddress = resultSet.getString("customer_address"); 
```

如果在位置 1 插入了一个新列怎么办？你更喜欢哪个代码？或者，如果列的顺序发生了变化，您需要更改哪个代码版本？

这就是为什么您应该**默认使用字符串标签的原因。**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-04T05:10:51.520

答案已被接受，不过，这里有一些我还没有看到的额外信息和个人经验。

如果可能，一般使用列名（最好使用常量而不是文字）。这既更清晰，更易于维护，而且未来的更改不太可能破坏代码。

但是，列索引也有用途。在某些情况下，这些速度更快，但不足以覆盖上述名称的原因*。这些在开发处理`ResultSet`s 的工具和通用方法时非常有价值。最后，可能需要索引，因为列没有名称（例如未命名的聚合）或存在重复名称，因此没有简单的方法来引用两者。

*请注意，我编写了一些 JDBC 驱动程序并查看了一些开源驱动程序，并且在内部这些驱动程序使用列索引来引用结果列。在我使用过的所有情况下，内部驱动程序首先将列名映射到索引。因此，您可以很容易地看到，在所有这些情况下，列名总是需要更长的时间。不过，这可能不适用于所有驱动程序。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-06-26T06:27:26.633

从java文档：

> ResultSet 接口提供用于从当前行检索列值的 getter 方法（getBoolean、getLong 等）。可以使用列的索引号或列的名称来检索值。一般来说，使用列索引会更有效。列从 1 开始编号。为了获得最大的可移植性，每行中的结果集列应按从左到右的顺序读取，并且每列应仅读取一次。

当然，每种方法（命名或索引）都有它的位置。我同意命名列应该是默认值。但是，在需要大量循环并且 SELECT 语句在同一段代码（或类）中定义和维护的情况下，索引应该没问题 - 建议列出正在选择的列，而不仅仅是“SELECT * FROM...”，因为任何表更改都会破坏代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T09:06:00.647

我在 Oracle 数据库上对这个确切的主题进行了一些性能分析。在我们的代码中，我们有一个包含许多列和大量行的 ResultSet。在 20 秒 (!) 中，请求执行方法 oracle.jdbc.driver.ScrollableResultSet.findColumn(String name) 大约需要 4 秒。

显然整体设计有问题，但是使用索引而不是列名可能会花费 4 秒的时间。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-02-04T04:57:55.133

当然，使用列名可以提高可读性并使维护变得容易。但是使用列名有另一面。如您所知，SQL 允许多个同名的列名，不能保证您在 resultSet 的 getter 方法中键入的列名实际上指向您要访问的列名。理论上，最好使用索引号而不是列名，但这会降低可读性。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-11-28T21:00:09.327

你可以两全其美！使用索引的速度与使用列名的可维护性和安全性。

首先 - 除非您通过结果集循环，否则只需使用列名。

1.  定义一组整数变量，一个用于您将访问的每一列。变量的名称可以包括列的名称：例如 iLast_Name。

2.  在结果集循环之前遍历列元数据并将每个整数变量的值设置为相应列名的列索引。如果“Last_Name”列的索引为 3，则将“iLast_Name”的值设置为 3。

3.  在结果集循环中，在 GET/SET 方法中使用整数变量名称。变量名称是开发人员/维护人员关于正在访问的实际列名称的视觉线索，但值是列索引，将提供最佳性能。

注意：初始映射（即列名到索引的映射）仅在循环之前完成一次，而不是针对循环中的每个记录和列。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-09T11:27:11.697

我认为使用标签不会对性能产生太大影响。但是还有另一个不使用`String`s 的原因。或者`int`s，就此而言。

考虑使用常量。使用`int`常量使代码更具可读性，但也不太可能出现错误。

除了更具可读性之外，该常量还可以防止您在标签名称中打错字 - 如果您这样做，编译器会抛出错误。任何有价值的 IDE 都会选择它。如果您使用`String`s 或，情况并非如此`ints`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T11:24:20.533

JDBC 驱动程序负责对列进行索引查找。因此，如果您每次驱动程序进行查找（通常在哈希映射中）时按列名提取值以检查列名的相应索引。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T12:20:59.110

我同意以前的答案，即性能并不是可以迫使我们选择任何一种方法的东西。最好考虑以下事项：

*   代码可读性：对于每个阅读代码标签的开发人员来说，比索引更有意义。
*   维护：考虑 SQL 查询及其维护方式。在修复/改进/重构 SQL 查询后，您的情况更有可能发生什么：更改提取列的顺序或更改结果列名称。在我看来，更改提取列的顺序（作为在结果集中添加/删除新列的结果）更有可能发生。
*   封装：无论您选择哪种方式，都尝试隔离在同一组件中运行 SQL 查询和解析结果集的代码，并仅让该组件知道列名及其与索引的映射（如果您决定使用它们）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T12:29:17.687

使用索引是一种优化的尝试。

开发人员需要花费额外的精力来查找必要的数据以检查他们的代码在更改后是否可以正常工作，从而节省了由此节省的时间。

我认为使用数字而不是文本是我们的本能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-19T09:20:11.600

除了在 Map 中查找标签之外，它还会导致额外的字符串创建。虽然它会在堆栈上发生，但它仍然需要付出代价。

这完全取决于个人选择，到目前为止我只使用索引:-)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-04-15T14:47:59.693

正如其他海报所指出的那样，我会坚持使用列名，除非你有一个非常强大的理由不这样做。与查询优化等相比，对性能的影响可以忽略不计。在这种情况下，维护比小的优化更重要。

# c# - 是否可以在您的 web.config 中指定代理凭据？

> ID：186800
> 
> 赞同：63
> 
> 时间：2008-10-09T11:19:18.187
> 
> 标签：c#, web-services, proxy

我需要配置一个网站以通过代理访问另一台机器上的 web 服务。我可以将网站配置为使用代理，但我找不到指定代理所需凭据的方法，这可能吗？这是我当前的配置：

```
<defaultProxy useDefaultCredentials="false">
    <proxy usesystemdefault="true" proxyaddress="<proxy address>" bypassonlocal="true" />
</defaultProxy> 
```

我知道你可以通过代码做到这一点，但网站运行的软件是一个闭源 CMS，所以我不能这样做。

有没有办法做到这一点？MSDN对我帮助不大..

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-10-11T18:29:33.220

是的，可以在不修改当前代码的情况下指定您自己的凭据。不过，它需要您的一小段代码。

使用此类创建一个名为*SomeAssembly.dll的程序集：*

```
namespace SomeNameSpace
{
    public class MyProxy : IWebProxy
    {
        public ICredentials Credentials
        {
            get { return new NetworkCredential("user", "password"); }
            //or get { return new NetworkCredential("user", "password","domain"); }
            set { }
        }

        public Uri GetProxy(Uri destination)
        {
            return new Uri("http://my.proxy:8080");
        }

        public bool IsBypassed(Uri host)
        {
            return false;
        }
    }
} 
```

将此添加到您的配置文件中：

```
<defaultProxy enabled="true" useDefaultCredentials="false">
  <module type = "SomeNameSpace.MyProxy, SomeAssembly" />
</defaultProxy> 
```

这会在列表中“注入”一个新代理，并且由于没有默认凭据，WebRequest 类将首先调用您的代码并请求您自己的凭据。您需要将 assemble SomeAssembly 放在 CMS 应用程序的 bin 目录中。

这是一个静态代码，要获取所有字符串，如用户、密码和 URL，您可能需要实现自己的[ConfigurationSection ，或者在](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsection.aspx)[AppSettings](http://msdn.microsoft.com/en-us/library/ms228154.aspx)中添加一些信息，这要容易得多。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-17T23:03:13.677

虽然我还没有找到在 web.config 中指定代理网络凭据的好方法，但您可能会发现您仍然可以使用非编码解决方案，方法是将其包含在您的 web.config 中：

```
 <system.net>
    <defaultProxy useDefaultCredentials="true">
      <proxy proxyaddress="proxyAddress" usesystemdefault="True"/>
    </defaultProxy>
  </system.net> 
```

实现这一目标的关键因素是更改 IIS 设置，确保运行该进程的帐户可以访问代理服务器。如果您的进程在 LocalService 或 NetworkService 下运行，那么这可能不起作用。很有可能，您需要一个域帐户。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-06-26T21:28:11.903

您可以通过在 Windows 凭据管理器中添加代理服务器的新通用凭据来指定凭据：

1 在 Web.config 中

```
<system.net>    
<defaultProxy enabled="true" useDefaultCredentials="true">      
<proxy usesystemdefault="True" />      
</defaultProxy>    
</system.net> 
```

2.  在控制面板\所有控制面板项\凭据管理器 >> 添加通用凭据

Internet 或网络地址：您的代理地址
用户名：您的用户名
密码：您通过

此配置对我有用，无需更改代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T11:38:39.677

目录服务/LDAP 查找可用于实现此目的。它涉及基础架构级别的一些更改，但大多数生产环境都有这样的规定

# ruby-on-rails - 如何从 ActiveRecord 模型中提取常见的 named_scopes

> ID：186802
> 
> 赞同：12
> 
> 时间：2008-10-09T11:19:58.793
> 
> 标签：ruby-on-rails, activerecord, named-scope

我已经在多个 ActiveRecord 模型中重用了 named_scope。例如：

```
 named_scope :limit, lambda {|limit| {:limit => limit}} 
```

提取此代码以在模型之间共享的最佳实践是什么。是否可以将其提取到模块中，或者我应该重新打开 ActiveRecord::Base 类？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-09T12:47:26.560

使用一个模块。像这样的东西应该工作：

```
module CommonScopes
  def self.included(base)
    base.class_eval do
      named_scope :limit, lambda {|limit| {:limit => limit}}
    end
  end
end 
```

然后只需包括 CommonScopes 就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T10:32:08.813

@Matt 通过[instance_eval](http://apidock.com/ruby/v1_9_1_378/BasicObject/instance_eval)， @see[通过模块共享范围？](https://stackoverflow.com/questions/7323793/shared-scopes-via-module)

# asp.net-mvc - 在 asp.net mvc 中缓存用户控件或其关联数据的最佳方法是什么

> ID：186816
> 
> 赞同：1
> 
> 时间：2008-10-09T11:26:00.297
> 
> 标签：asp.net-mvc, caching, outputcache, html.renderpartial

我正在使用 ASP.NET MVC 实现应用程序，并且希望缓存传递给用户控件的数据或我使用 Html.RenderPartial 呈现的某些用户控件上的输出呈现，这样我就不必用我对控制器的每个请求查询数据库以获得新视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T02:27:06.813

这似乎是那些 100 万美元的问题之一！

似乎很多人都遇到了这个问题，但解决方案并非易事。

查看[最近](http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2062)在 ASP.NET MVC Codeplex 站点上报告的问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T03:14:08.900

我可能会建议使用 MVC Contrib 中的子控制器，然后使用 OutputCache 的东西缓存控制器的方法。

# tfs - 您如何在 Team System 中自定义工作项？

> ID：186817
> 
> 赞同：0
> 
> 时间：2008-10-09T11:26:06.660
> 
> 标签：tfs, tfs-workitem, tfs-process-template

在我的公司，我们使用带有一些修改的默认敏捷流程模板。我们所做的一项修改是添加了一个字段，该字段指示如何报告在工作项上花费的时间。

您对默认流程模板进行了哪些自定义？您是否定制了第三方流程模板，或者可能从头开始制作自己的流程模板？

我认为从其他自定义 Team System 的流程模板中学习会很有趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-24T23:31:55.930

我为几个不同的客户做了很多不同的修改。他们中的大多数是添加新的“状态”和“转换”来支持客户的变更控制，以及在一次情况下的 SOX 合规性。该特定客户还希望对 WHO 实施安全性，可以更改某些转换中的状态 - 以及可以将工作项分配给谁。

我还添加了一些字段，common 是“紧急变更”的指标，其他优先级字段 - 以及特定于客户业务线的字段。

如果您使用“模板编辑器”电动工具 - 这很容易。但遵循任何开发的正常最佳实践。将开发服务器与生产 TFS 服务器分开（或至少 - 一个测试团队项目）。将您的模板置于版本控制之下（我喜欢一个单独的“TFS 实施”团队项目并逐步进行小改动。

# c# - 从 .NET 应用程序 (C#) 捕获控制台输出

> ID：186822
> 
> 赞同：143
> 
> 时间：2008-10-09T11:27:14.803
> 
> 标签：c#, .net, debugging, console

如何从我的 .NET 应用程序调用控制台应用程序并捕获控制台中生成的所有输出？

（请记住，我不想先将信息保存在文件中，然后再重新列出，因为我很乐意接收它作为实时信息。）

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-10-09T11:32:02.903

[使用ProcessStartInfo.RedirectStandardOutput](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput.aspx)属性可以很容易地实现这一点。完整的示例包含在链接的 MSDN 文档中；唯一需要注意的是，您可能还必须重定向标准错误流才能查看应用程序的所有输出。

```
Process compiler = new Process();
compiler.StartInfo.FileName = "csc.exe";
compiler.StartInfo.Arguments = "/r:System.dll /out:sample.exe stdstr.cs";
compiler.StartInfo.UseShellExecute = false;
compiler.StartInfo.RedirectStandardOutput = true;
compiler.Start();    

Console.WriteLine(compiler.StandardOutput.ReadToEnd());

compiler.WaitForExit(); 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2016-09-21T18:37:20.230

**这比@mdb**接受的答案有所改进。具体来说，我们还捕获过程的错误输出。此外，我们通过事件捕获这些输出，因为`ReadToEnd()`如果您想同时捕获错误和常规输出，则无法正常*工作*。我花了一段时间才完成这项工作，因为它实际上还需要`BeginxxxReadLine()`在`Start()`.

异步方式：

```
using System.Diagnostics;

Process process = new Process();

void LaunchProcess()
{
    process.EnableRaisingEvents = true;
    process.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(process_OutputDataReceived);
    process.ErrorDataReceived += new System.Diagnostics.DataReceivedEventHandler(process_ErrorDataReceived);
    process.Exited += new System.EventHandler(process_Exited);

    process.StartInfo.FileName = "some.exe";
    process.StartInfo.Arguments = "param1 param2";
    process.StartInfo.UseShellExecute = false;
    process.StartInfo.RedirectStandardError = true;
    process.StartInfo.RedirectStandardOutput = true;

    process.Start();
    process.BeginErrorReadLine();
    process.BeginOutputReadLine();          

    //below line is optional if we want a blocking call
    //process.WaitForExit();
}

void process_Exited(object sender, EventArgs e)
{
    Console.WriteLine(string.Format("process exited with code {0}\n", process.ExitCode.ToString()));
}

void process_ErrorDataReceived(object sender, DataReceivedEventArgs e)
{
    Console.WriteLine(e.Data + "\n");
}

void process_OutputDataReceived(object sender, DataReceivedEventArgs e)
{
    Console.WriteLine(e.Data + "\n");
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-09T11:32:20.313

创建控制台进程时，使用[ProcessInfo.RedirectStandardOutput重定向输出。](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput.aspx)

然后您可以使用[Process.StandardOutput](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardoutput.aspx)来读取程序输出。

第二个链接有一个示例代码如何做到这一点。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-03-31T01:36:20.547

[ConsoleAppLauncher](https://github.com/slavagu/ConsoleAppLauncher)是一个专门为回答这个问题而设计的开源库。它捕获控制台中生成的所有输出，并提供简单的界面来启动和关闭控制台应用程序。

每次控制台将新行写入标准/错误输出时，都会触发 ConsoleOutput 事件。这些行排队并保证遵循输出顺序。

也可用作[NuGet 包](https://nuget.org/packages/ConsoleAppLauncher/)。

获取完整控制台输出的示例调用：

```
// Run simplest shell command and return its output.
public static string GetWindowsVersion()
{
    return ConsoleApp.Run("cmd", "/c ver").Output.Trim();
} 
```

带有实时反馈的示例：

```
// Run ping.exe asynchronously and return roundtrip times back to the caller in a callback
public static void PingUrl(string url, Action<string> replyHandler)
{
    var regex = new Regex("(time=|Average = )(?<time>.*?ms)", RegexOptions.Compiled);
    var app = new ConsoleApp("ping", url);
    app.ConsoleOutput += (o, args) =>
    {
        var match = regex.Match(args.Line);
        if (match.Success)
        {
            var roundtripTime = match.Groups["time"].Value;
            replyHandler(roundtripTime);
        }
    };
    app.Run();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-11-26T18:02:57.547

我在[O2 平台](http://o2platform.com)（开源项目）中添加了许多辅助方法，允许您通过控制台输出和输入轻松编写与另一个进程的交互脚本（请参阅[http://code.google.com/p/o2platform/源/浏览/主干/O2_Scripts/APIs/Windows/CmdExe/CmdExeAPI.cs](http://code.google.com/p/o2platform/source/browse/trunk/O2_Scripts/APIs/Windows/CmdExe/CmdExeAPI.cs)）

对您也有用的 API 可能允许查看当前进程的控制台输出（在现有控件或弹出窗口中）。有关更多详细信息，请参阅此博客文章：http: [//o2platform.wordpress.com/2011/11/26/api_consoleout-cs-inprocess-capture-of-the-console-output/](http://o2platform.wordpress.com/2011/11/26/api_consoleout-cs-inprocess-capture-of-the-console-output/)（此博客还包含有关如何使用的详细信息新进程的控制台输出）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-12-17T11:46:45.723

我制作了一个响应式版本，它接受 stdOut 和 StdErr 的回调。
`onStdOut`并在 数据到达后（在进程退出之前）`onStdErr`被异步调用。

```
public static Int32 RunProcess(String path,
                               String args,
                       Action<String> onStdOut = null,
                       Action<String> onStdErr = null)
    {
        var readStdOut = onStdOut != null;
        var readStdErr = onStdErr != null;

        var process = new Process
        {
            StartInfo =
            {
                FileName = path,
                Arguments = args,
                CreateNoWindow = true,
                UseShellExecute = false,
                RedirectStandardOutput = readStdOut,
                RedirectStandardError = readStdErr,
            }
        };

        process.Start();

        if (readStdOut) Task.Run(() => ReadStream(process.StandardOutput, onStdOut));
        if (readStdErr) Task.Run(() => ReadStream(process.StandardError, onStdErr));

        process.WaitForExit();

        return process.ExitCode;
    }

    private static void ReadStream(TextReader textReader, Action<String> callback)
    {
        while (true)
        {
            var line = textReader.ReadLine();
            if (line == null)
                break;

            callback(line);
        }
    } 
```

## 示例用法

以下将运行`executable`并`args`打印

*   标准输出为白色
*   红色的标准错误

到控制台。

```
RunProcess(
    executable,
    args,
    s => { Console.ForegroundColor = ConsoleColor.White; Console.WriteLine(s); },
    s => { Console.ForegroundColor = ConsoleColor.Red;   Console.WriteLine(s); } 
); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-17T16:18:59.957

来自*[PythonTR - Python Programcıları Derneği、e-kitap、örnek](http://pythontr.org/index.php?option=com_content&view=article&id=50:python-script-lerinin-c-ile-caltrlmas-execute-python-script-in-c&catid=31:makale&Itemid=66)*：

```
Process p = new Process();   // Create new object
p.StartInfo.UseShellExecute = false;  // Do not use shell
p.StartInfo.RedirectStandardOutput = true;   // Redirect output
p.StartInfo.FileName = "c:\\python26\\python.exe";   // Path of our Python compiler
p.StartInfo.Arguments = "c:\\python26\\Hello_C_Python.py";   // Path of the .py to be executed 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-09T19:30:53.760

添加`process.StartInfo.**CreateNoWindow** = true;`和`timeout`。

```
private static void CaptureConsoleAppOutput(string exeName, string arguments, int timeoutMilliseconds, out int exitCode, out string output)
{
    using (Process process = new Process())
    {
        process.StartInfo.FileName = exeName;
        process.StartInfo.Arguments = arguments;
        process.StartInfo.UseShellExecute = false;
        process.StartInfo.RedirectStandardOutput = true;
        process.StartInfo.CreateNoWindow = true;
        process.Start();

        output = process.StandardOutput.ReadToEnd();

        bool exited = process.WaitForExit(timeoutMilliseconds);
        if (exited)
        {
            exitCode = process.ExitCode;
        }
        else
        {
            exitCode = -1;
        }
    }
} 
```

# java - Java 中带有 CRAM-MD5 的 SMTP

> ID：186827
> 
> 赞同：6
> 
> 时间：2008-10-09T11:28:23.287
> 
> 标签：java, smtp, sasl

我需要从 Java 通过（外部）SMTP 服务器发送电子邮件，但是该服务器只接受 CRAM-MD5 身份验证，JavaMail 不支持这种身份验证。

发送这些电子邮件的好方法是什么？（它必须是 Java 语言。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T14:04:47.467

这是[线程](http://lists.gnu.org/archive/html/classpathx-javamail/2010-10/msg00004.html)，它说您需要添加以下属性：

```
props.put("mail.smtp.auth.mechanisms", "CRAM-MD5") 
```

在 Geronimo 实现中还有[CramMD5Authenticator](http://geronimo.apache.org/maven/javamail/1.7/geronimo-javamail_1.4_provider/apidocs/org/apache/geronimo/javamail/authentication/CramMD5Authenticator.html)

希望它有助于解决这个老问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T09:03:34.107

从 Java Mail 1.4.4 开始，支持 CRAM-MD5 与 smtp 一起使用。只需将此参数设置为您的属性，它将起作用：

`props.put("mail.smtp.sasl.enable", "true");`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-09T11:52:48.137

这并不能直接帮助您，但是，如果您将[布尔](http://java.sun.com/j2se/1.5.0/docs/guide/security/sasl/sasl-refguide.html)[`mail.imap.sasl.enable`](http://java.sun.com/products/javamail/javadocs/com/sun/mail/imap/package-summary.html)属性设置为`true`.

不幸的是，没有`mail.smtp.sasl.enable`属性，并且无法在 JavaMail 中为 SMTP 启用 SASL。:-(

但是，您可以下载[JavaMail 源代码](https://maven-repository.dev.java.net/nonav/repository/javax.mail/java-sources/)，并且您可以尝试以与 IMAP 代码类似的方式编辑 SMTP 代码以支持 SASL。祝你好运！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T13:32:24.940

这可能对您没有帮助，但 CRAM-MD5 和 CRAM-SHA1 很容易实现，前提是您有正确的库 (md5/sha1)，并且理想情况下，有一个 base64 编码库（尽管 base64 的东西很容易自己实现在紧要关头）。

交易看起来像这样：

```
C: AUTH CRAM-MD5
S: 334 BASE64(NONCE)
C: BASE64(USERNAME, " ", MD5((SECRET XOR opad),MD5((SECRET XOR ipad), NONCE)))
S: 235 Authentication succeeded 
```

其中 NONCE 是一次挑战字符串，USERNAME 是您尝试验证的用户名，SECRET 是共享密钥（“密码”），opad 是 0x5C，ipad 是 0x36。

（CRAM-SHA1 将是相同的事务，但使用 SHA1() 而不是 MD5() 进行消化）

所以，这是一个真正的 CRAM-MD5 交易的例子

```
C: AUTH CRAM-MD5
S: 334 PDQ1MDMuMTIyMzU1Nzg2MkBtYWlsMDEuZXhhbXBsZS5jb20+
C: dXNlckBleGFtcGxlLmNvbSA4YjdjODA5YzQ0NTNjZTVhYTA5N2VhNWM4OTlmNGY4Nw==
S: 235 Authentication succeeded 
```

备份过程你得到一个步骤：

```
S: 334 BASE64("<4503.1223557862@mail01.example.com>")
C: BASE64("user@example.com 8b7c809c4453ce5aa097ea5c899f4f87") 
```

在计算摘要之前进一步备份一步，您将获得：

```
S: 334 BASE64("<4503.1223557862@mail01.example.com>")
C: BASE64("user@example.com ", MD5(("password" XOR opad),MD5(("password" XOR ipad), "<4503.1223557862@mail01.example.com>"))) 
```

我想现在我把它写出来有点令人困惑，但相信我，与尝试手动执行 NTLM/SPA 相比，它轻而易举。如果你有动力，它实际上很容易实现。或者，也许我只是在邮件客户端和服务器的内部花费了很长时间才能清楚地考虑它......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-31T17:46:13.843

## JAVA中非常简单的CRAMMD5程序

* * *

```
import java.security.*;

class CRAMMD5Test
{
public static void main(String[] args) throws Exception
{
    // This represents the BASE64 encoded timestamp sent by the POP server
    String dataString = Base64Decoder.decode("PDAwMDAuMDAwMDAwMDAwMEBteDEuc2VydmVyLmNvbT4=");
    byte[] data = dataString.getBytes();

    // The password to access the account
    byte[] key  = new String("password").getBytes();

    // The address of the e-mail account
    String user = "client@server.com";

    MessageDigest md5 = MessageDigest.getInstance("MD5");
        md5.reset();

    if (key.length > 64)
        key = md5.digest(key);

    byte[] k_ipad = new byte[64];
    byte[] k_opad = new byte[64];

    System.arraycopy(key, 0, k_ipad, 0, key.length);
    System.arraycopy(key, 0, k_opad, 0, key.length);

    for (int i=0; i<64; i++)
    {
        k_ipad[i] ^= 0x36;
        k_opad[i] ^= 0x5c;
    }

    byte[] i_temp = new byte[k_ipad.length + data.length];

    System.arraycopy(k_ipad, 0, i_temp, 0, k_ipad.length);
    System.arraycopy(data, 0, i_temp, k_ipad.length, data.length);

    i_temp = md5.digest(i_temp);

    byte[] o_temp = new byte[k_opad.length + i_temp.length];

    System.arraycopy(k_opad, 0, o_temp, 0, k_opad.length);
    System.arraycopy(i_temp, 0, o_temp, k_opad.length, i_temp.length);

        byte[] result = md5.digest(o_temp);
        StringBuffer hexString = new StringBuffer();

        for (int i=0;i < result.length; i++) {
                hexString.append(Integer.toHexString((result[i] >>> 4) & 0x0F));
                hexString.append(Integer.toHexString(0x0F & result[i]));
             }

        System.out.println(Base64Encoder.encode(user + " " + hexString.toString()));
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T09:58:50.143

我尝试了真实 CRAM-MD5 事务示例中的代码，以及 RFC 2195 中给出的示例。

它不起作用，因为转换为十六进制字符串不正确。例如，使用此代码，您将获得“b913a62c7eda7a495b4e6e7334d3890”而不是“b913a602c7eda7a495b4e6e7334d3890”，并且发送的身份验证字符串将不正确。

如果你下载javaMail的源代码，你会看到函数toHex的实现到单元“DigestMD5”中。使用此转换，它将起作用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-03T22:28:33.040

**改变：**

```
for (int i=0; i<result.length; i++)
  hexString.append(Integer.toHexString(0xFF & result[i])); 
```

**到：**

```
for (int i=0;i < result.length; i++) {
  hexString.append(Integer.toHexString((result[i] >>> 4) & 0x0F));
  hexString.append(Integer.toHexString(0x0F & result[i]));
} 
```

# tcp - 端口如何与 IPv6 配合使用？

> ID：186829
> 
> 赞同：164
> 
> 时间：2008-10-09T11:29:26.857
> 
> 标签：tcp, udp, ipv6, ports

传统的 IPv4 点分四边形表示法用冒号将地址与端口隔开，如以下环回接口上的 Web 服务器示例：

```
127.0.0.1:80 
```

但是使用 IPv6 表示法，地址本身可以包含冒号。例如，这是环回地址的缩写形式：

```
::1 
```

端口（或其功能等效项）如何以 IPv6 地址/端口端点的文本表示形式表示？

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2008-10-09T11:34:11.183

它们的工作方式与今天几乎相同。但是，请确保您包含`[]`在您的 IP 周围。

例如 ：[`http://[1fff:0:a88:85a3::ac1f]:8001/index.html`](http://en.wikipedia.org/wiki/IPv6_address#Literal_IPv6_addresses_in_network_resource_identifiers)

维基百科有一篇关于 IPv6 的不错的文章：[http ://en.wikipedia.org/wiki/IPv6#Addressing](http://en.wikipedia.org/wiki/IPv6#Addressing)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-10-09T11:33:55.867

IPv6 中使用的协议与 IPv4 中的协议相同。两个版本之间唯一改变的是寻址方案，DHCP [DHCPv6] 和 ICMP [ICMPv6]。所以基本上，任何与 TCP/UDP 相关的东西，包括端口范围 (0-65535) 都保持不变。

**编辑：**端口 0 是 TCP 中的保留端口，但它确实存在。见[RFC793](http://www.faqs.org/rfcs/rfc793.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-08-29T14:36:28.100

Wikipedia[指出](http://en.wikipedia.org/wiki/IPv6#Addressing)，IPv6 地址的语法包括冒号，并且具有防止固定长度解析的简短形式，因此您必须用 [] 分隔地址部分。这完全避免了奇怪的解析错误。

（取自[Peter Wone](https://stackoverflow.com/users/1715673/peter-wone)对原始问题所做[的编辑。）](https://stackoverflow.com/revisions/186829/2)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-09T11:33:32.090

他们是一样的，不是吗？现在我对自己失去了信心，但我真的认为 IPv6 只是一种寻址方式的改变。TCP 和 UDP 仍然像在 IPv4 下一样被寻址。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-09T11:33:59.220

我很确定端口只在 tcp 和 udp 中有一部分。所以即使你使用新的IP协议也是一样的

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-03-03T08:47:36.143

我会说最好的参考是[URL 中的文字 IPv6 地址格式，](http://www.ietf.org/rfc/rfc2732.txt)其中定义了 [] 的使用。

另外，如果是用于编程和代码，特别是 Java，我建议阅读[Class for Inet6Address](https://docs.oracle.com/javase/8/docs/api/java/net/Inet6Address.html) [java/net/URL 定义](https://docs.oracle.com/javase/8/docs/api/java/net/URL.html)，其中详细介绍了 Inet6 内涵中 Inet4 地址的使用和其他情况。就我而言，IPv4 映射地址的形式为::ffff:wxyz，因为 IPv6 地址用于表示 IPv4 地址也解决了我的问题。它允许本地程序在与 IPv4 和 IPv6 节点通信时使用相同的地址数据结构和相同的套接字。亚马逊云 Linux 盒子默认设置就是这种情况。

# http-headers - 有趣的 UTF-8 雅虎文件下载标头

> ID：186840
> 
> 赞同：2
> 
> 时间：2008-10-09T11:33:05.790
> 
> 标签：http-headers, download

我的公司运行网络邮件服务，我们试图诊断 Word 下载无法自动打开的问题 - 从 Yahoo Mail 下载的相同 *.doc 文件会打开，但我们的不会打开。

在调查标头的过程中，我们看到这来自雅虎：

```
content-disposition attachment; filename*="utf-8''word document.doc"; 
```

而我们的标题是这样的：

```
content-disposition attachment; filename="word document.doc"; 
```

雅虎究竟在用额外的星号和 utf-8'' 指定做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T13:50:17.697

我认为正确的答案在 rfc 2231 中：

星号 ("*") 被重用以提供存在语言和字符集信息以及正在使用编码的指示符。单引号 ("'") 用于在参数值的开头分隔字符集和语言信息。百分号（“%”）用作编码标志，符合 RFC 2047。

具体来说，参数名称末尾的星号表示字符集和语言信息可能出现在参数值的开头。单引号用于分隔参数值字符串中的字符集、语言和实际值信息，百分号用于标记以十六进制编码的八位字节。例如：

```
 Content-Type: application/x-stuff;
     title*=us-ascii'en-us'This%20is%20%2A%2A%2Afun%2A%2A%2A 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T11:47:24.090

您使用的是什么 Mime-Type？

根据 RFC 2183 ( [http://www.ietf.org/rfc/rfc2183.txt](http://www.ietf.org/rfc/rfc2183.txt) )，星号是必需的：

在 [RFC 822] 的扩展 BNF 表示法中，Content-Disposition 头字段定义如下：

```
 disposition := "Content-Disposition" ":"
                disposition-type
                *(";" disposition-parm)

 disposition-type := "inline"
                   / "attachment"
                   / extension-token
                   ; values are not case-sensitive

 disposition-parm := filename-parm
                   / creation-date-parm
                   / modification-date-parm
                   / read-date-parm
                   / size-parm
                   / parameter

 filename-parm := "filename" "=" value

 creation-date-parm := "creation-date" "=" quoted-date-time

 modification-date-parm := "modification-date" "=" quoted-date-time

 read-date-parm := "read-date" "=" quoted-date-time

 size-parm := "size" "=" 1*DIGIT

 quoted-date-time := quoted-string
                  ; contents MUST be an RFC 822 `date-time'
                  ; numeric timezones (+HHMM or -HHMM) MUST be used 
```

# c# - 如何防止后台线程中的异常终止应用程序？

> ID：186854
> 
> 赞同：43
> 
> 时间：2008-10-09T11:36:55.390
> 
> 标签：c#, .net, exception

我可以连接到`AppDomain.CurrentDomain.UnhandledException`从后台线程记录异常，但是如何防止它们终止运行时？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-09T11:44:51.147

首先，您真的应该尽量不要在后台线程中抛出异常 - 并且不处理异常。如果您控制委托的运行方式，请将其封装在 try catch 块中，并想办法将异常信息传递回主线程（如果您明确调用 BeginInvoke，则使用 E​​ndInvoke，或者通过在某处更新某些共享状态）。

忽略未处理的异常可能很危险。如果您有一个真正无法处理的异常（想到 OutOfMemoryException），那么无论如何您也无能为力，并且您的过程基本上注定要失败。

回到 .Net 1.1，后台线程中未处理的异常只会被抛到无处，而主线程会很高兴地继续工作。这可能会产生恶劣的影响。所以在 .Net 2.0 中，这种行为发生了变化。

现在，在不是主线程的线程中抛出未处理的异常将终止该进程。您可能会收到通知（通过订阅 AppDomain 上的事件），但该进程仍然会终止。

由于这可能很不方便（当您不知道线程中将运行什么并且您不确定它是否得到了适当的保护，并且您的主线程必须具有弹性时），所以有一种解决方法。它旨在作为旧设置（意思是，强烈建议您确保没有杂散线程），但您可以通过这种方式强制执行前一种行为：

只需将此设置添加到您的服务/应用程序/任何配置文件：

```
<configuration>
  <runtime>
    <!-- the following setting prevents the host from closing when an unhandled exception is thrown -->
    <legacyUnhandledExceptionPolicy enabled="1" />
  </runtime>
</configuration> 
```

不过，它似乎不适用于 ASP.NET。

有关更多信息（以及即将发布的 CLR 版本可能不支持此设置的巨大警告），请参阅[http://msdn.microsoft.com/en-us/library/ms228965.aspx](http://msdn.microsoft.com/en-us/library/ms228965.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-09T11:40:07.413

来自 Joe Albahari 的优秀[线程](http://www.albahari.com/threading/)文章：

> .NET 框架为全局异常处理提供了一个较低级别的事件：AppDomain.UnhandledException。当任何线程和任何类型的应用程序（有或没有用户界面）中存在未处理的异常时，将触发此事件。然而，虽然它为记录未捕获的异常提供了一个很好的最后手段机制，但它没有提供阻止应用程序关闭的方法——也没有抑制 .NET 未处理异常对话框的方法。
> 
> 在生产应用程序中，所有线程入口方法都需要显式异常处理。可以通过使用包装器或帮助器类来执行工作来减少工作，例如 BackgroundWorker（在第 3 部分中讨论）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-29T04:38:38.407

保持简短的答案，是的，您确实可以防止运行时终止。

这是解决方法的演示：

```
class Program
{
    void Run()
    {
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException);

        Console.WriteLine("Press enter to exit.");

        do
        {
            (new Thread(delegate()
            {
                throw new ArgumentException("ha-ha");
            })).Start();

        } while (Console.ReadLine().Trim().ToLowerInvariant() == "x");

        Console.WriteLine("last good-bye");
    }

    int r = 0;

    void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        Interlocked.Increment(ref r);
        Console.WriteLine("handled. {0}", r);
        Console.WriteLine("Terminating " + e.IsTerminating.ToString());

        Thread.CurrentThread.IsBackground = true;
        Thread.CurrentThread.Name = "Dead thread";            

        while (true)
            Thread.Sleep(TimeSpan.FromHours(1));
        //Process.GetCurrentProcess().Kill();
    }

    static void Main(string[] args)
    {
        Console.WriteLine("...");
        (new Program()).Run();
    }
} 
```

本质上，您只是没有让运行时显示“...程序已停止工作”对话框。

如果您需要记录异常并*静默*退出，您可以调用`Process.GetCurrentProcess().Kill();`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-24T11:22:13.420

```
 AppDomain.CurrentDomain.UnhandledException += (sender, e2) =>
    {
        Thread.CurrentThread.Join();
    }; 
```

但要小心，这段代码会冻结线程和线程托管对象本身的所有堆栈内存。但是，如果您的应用程序处于确定状态（可能是您抛出 LimitedDemoFunctionalityException 或 OperationStopWithUserMessageException）并且您没有开发 24/7 应用程序，则此技巧将起作用。

最后，我认为 MS 应该允许开发人员从堆栈顶部覆盖未处理异常的逻辑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T11:51:26.360

这是一篇关于此问题的精彩博客文章：[Handling "Unhandled Exceptions" in .NET 2.0](http://www.julmar.com/blog/mark/PermaLink,guid,f733e261-5d39-4ca1-be1a-c422f3cf1f1b.aspx)

IMO 手动处理后台线程中的异常并在必要时通过回调重新抛出它们是正确的。

```
delegate void ExceptionCallback(Exception ex);

void MyExceptionCallback(Exception ex)
{
   throw ex; // Handle/re-throw if necessary
}

void BackgroundThreadProc(Object obj)
{
   try 
   { 
     throw new Exception(); 
   }
   catch (Exception ex)
   { 
     this.BeginInvoke(new ExceptionCallback(MyExceptionCallback), ex); 
   }
}

private void Test()
{
   ThreadPool.QueueUserWorkItem(new WaitCallback(BackgroundThreadProc));
} 
```

# python - 在 Python 中将分号分隔的字符串拆分为字典

> ID：186857
> 
> 赞同：86
> 
> 时间：2008-10-09T11:38:22.347
> 
> 标签：python, string, dictionary, split

我有一个看起来像这样的字符串：

```
"Name1=Value1;Name2=Value2;Name3=Value3" 
```

Python 中是否有一个内置的类/函数将获取该字符串并构造一个字典，就好像我已经这样做了：

```
dict = {
    "Name1": "Value1",
    "Name2": "Value2",
    "Name3": "Value3"
} 
```

我浏览了可用的模块，但似乎找不到任何匹配的东西。

* * *

谢谢，我确实知道如何自己制作相关代码，但是由于这种小型解决方案通常是等待发生的雷区（即有人写道：Name1='Value1=2';）等等，所以我通常更喜欢一些预先测试功能。

那我自己做吧。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2008-10-09T11:43:42.087

没有内置函数，但您可以通过生成器理解相当简单地完成此操作：

```
s= "Name1=Value1;Name2=Value2;Name3=Value3"
dict(item.split("=") for item in s.split(";")) 
```

**[编辑]** 从您的更新中，您表明您可能需要处理报价。这确实使事情复杂化，具体取决于您要查找的确切格式是什么（接受什么引号字符，什么转义字符等）。您可能想查看 csv 模块，看看它是否可以覆盖您的格式。这是一个示例：（请注意，此示例的 API 有点笨拙，因为 CSV 旨在遍历一系列记录，因此我进行 .next() 调用只是为了查看第一行。调整为满足您的需求）：

```
>>> s = "Name1='Value=2';Name2=Value2;Name3=Value3"

>>> dict(csv.reader([item], delimiter='=', quotechar="'").next() 
         for item in csv.reader([s], delimiter=';', quotechar="'").next())

{'Name2': 'Value2', 'Name3': 'Value3', 'Name1': 'Value1=2'} 
```

但是，根据格式的确切结构，您可能需要编写自己的简单解析器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-03-01T02:46:12.353

这接近于做你想做的事：

```
>>> import urlparse
>>> urlparse.parse_qs("Name1=Value1;Name2=Value2;Name3=Value3")
{'Name2': ['Value2'], 'Name3': ['Value3'], 'Name1': ['Value1']} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-03-04T13:23:26.300

```
s1 = "Name1=Value1;Name2=Value2;Name3=Value3"

dict(map(lambda x: x.split('='), s1.split(';'))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-23T11:37:28.070

它可以简单地通过字符串连接和列表理解来完成

`",".join(["%s=%s" % x for x in d.items()])`

```
>>d = {'a':1, 'b':2}
>>','.join(['%s=%s'%x for x in d.items()])
>>'a=1,b=2' 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-03-26T23:59:36.120

```
easytiger $ cat test.out test.py | sed 's/^/    /'
p_easytiger_quoting:1.84563302994
{'Name2': 'Value2', 'Name3': 'Value3', 'Name1': 'Value1'}
p_brian:2.30507516861
{'Name2': 'Value2', 'Name3': "'Value3'", 'Name1': 'Value1'}
p_kyle:7.22536420822
{'Name2': ['Value2'], 'Name3': ["'Value3'"], 'Name1': ['Value1']}
import timeit
import urlparse

s = "Name1=Value1;Name2=Value2;Name3='Value3'"

def p_easytiger_quoting(s):
    d = {}
    s = s.replace("'", "")
    for x in s.split(';'):
        k, v = x.split('=')
        d[k] = v
    return d

def p_brian(s):
    return dict(item.split("=") for item in s.split(";"))

def p_kyle(s):
    return urlparse.parse_qs(s)

print "p_easytiger_quoting:" + str(timeit.timeit(lambda: p_easytiger_quoting(s)))
print p_easytiger_quoting(s)

print "p_brian:" + str(timeit.timeit(lambda: p_brian(s)))
print p_brian(s)

print "p_kyle:" + str(timeit.timeit(lambda: p_kyle(s)))
print p_kyle(s) 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-04-24T10:22:23.813

如果您的 Value1、Value2 只是实际值的占位符，您还可以将该`dict()`函数与`eval()`.

```
>>> s= "Name1=1;Name2=2;Name3='string'"
>>> print eval('dict('+s.replace(';',',')+')')
{'Name2: 2, 'Name3': 'string', 'Name1': 1} 
```

这是因为`dict()`函数理解语法`dict(Name1=1, Name2=2,Name3='string')`。字符串中的空格（例如在每个分号之后）被忽略。但请注意，字符串值确实需要引用。

# architecture - 最灵活的 Web 开发框架架构？

> ID：186865
> 
> 赞同：4
> 
> 时间：2008-10-09T11:40:16.133
> 
> 标签：architecture, frameworks

编辑，2020/09：如果有人想知道，12 年后，是的，我们现在都已经迁移到 JSON 和 Kubernetes。原文如下。

显然，没有一种单一的解决方案可以满足每个人的需求。架构始终是一种权衡。我想创建一个框架，最初是针对网页游戏的RAD。目标语言是 PHP，尽管该架构应该是广泛适用的。

我为这个框架设定的目标是：实现结果的方式的灵活性；为开发人员提供最大的舒适度；连接乐高®积木等模块；多种输入，多种输出，一种处理格式。

不优先的目标是速度、企业使用和赚钱。它应该是一个开源项目。

这种设计的基石是所有内容，在转换之前，都在 XML 中处理（基于我使用过的 EAI 系统，eGate 的想法）。数据抽象层——希望是一些智能的 ORM——现在并不重要。输出将使用 XSLT 或任何其他自定义模块生成，几乎适用于任何客户端 - 用于旧浏览器的 HTML、用于现代浏览器的 XHTML/HTML5、用于移动客户端的简单 HTML、用于 AJAX/XMLRPC 的 XML 等。

使用 XML 的主要原因是：

*   这是一个众所周知的标准
*   用于导航和修改内容的现有工具，如 XPath、SimpleXML 和 DOM
*   XSLT 提供了一种强大而统一的方法来将代码转换为任何标签汤
*   我发现 XML 标记非常容易阅读，因此我不认为 JSON 或 YAML 的优势在这里有所作为
*   内容可以轻松堆叠，只要使用 XSLT 正确转换，内容的顺序并不重要

页面生成过程将包括以下阶段：

1.  预处理：初始化模块，处理 GPCS 数据，应用默认 [XML] 模板
2.  处理/生成：业务逻辑的主要部分，使用最大数据生成臃肿的 XML（尽管希望优化为不生成压载物）
3.  处理：一些额外的业务逻辑，例如削减一些标记，准备转换，报告，统计等。
4.  后处理：通过转换引擎（很可能只是 XSLT）解析 XML，输出。

生成的内容将包含大量元数据（例如标签、权限、重要性、必要性、目标输出类型），这些元数据将在后处理期间被剥离。

所以，我的问题是：除了速度，这个解决方案的缺点是什么？在框架的开发/维护及其应用程序中，哪里可能出错？这种架构的缺点是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T19:18:55.753

XSLT 管理起来可能很笨重，并且本质上增加了开发人员必须使用的额外编程语言（至少如果我正确理解您的描述的话）。我的经验是，知道它的人相对较少，能够让它为所欲为的人就更少了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T21:08:46.517

我也不确定向您建议什么“灵活框架”。这一切都取决于你喜欢什么和你的个人品味。

我知道的一件事是，它乍一看可能多么吸引人，那就是远离 XSLT。用 XSLT 做 Hello World 类型的东西和简单的例子非常简单。但是，使用 XSLT，更复杂的项目变得完全无法管理（更不用说不可读了）。我的经验是它给项目带来了巨大的压力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-09T19:28:11.697

我认为您正在寻找一个非常复杂的解决方案。简单地设计和构建您将使用的模式是一项重大工作。如果您的项目总共涉及超过 5-6 人，您可能需要进行有组织的架构设计工作。我想这是你意识到的一点。

我质疑并可能对前端 PHP 的选择提出质疑。我还认为您在很大程度上错误地决定了 XML。

这是我所做的：

1.  使用 Grails.org 构建服务层
2.  保持所有可以 RESTFUL 的资源处于静止状态
3.  使用 Grails 中的 X-fire 插件构建任何需要构建的 SOAP 服务
4.  利用 Grails 的 GORM 和 RAD 功能来缩短开发时间。
5.  以 X 或 Y 语言或平台构建客户端以使用这些服务。

我肯定想要纯 Java 的速度来完成我所有的 XML 翻译/处理。如果您有大型文档，则处理这些文档将花费大量时间。

你比任何人都更了解环境的力量，但我会提醒你先做最简单的事情，而不是过度架构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T21:24:38.293

您所描述的可能使用[tox](http://tox.sourceforge.net/)来实现。它使用混合[MVC-ARS](https://stackoverflow.com/questions/140098/is-mvc-ars-preferable-to-classic-mvc-to-prevent-overloading)架构。我看到的障碍是成本点[tox](http://tox.sourceforge.net/)由于它对 Oracle 的依赖而呈现。当然，由于它是开源的，您可以[将其转换为 Postgresql](https://stackoverflow.com/questions/87603/what-is-the-equivalent-of-oracles-ref-cursor-in-postgresql-when-using-jdbc)。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-09T12:55:14.297

我过去曾开发过一些网页游戏，老实说，它们都不需要如此复杂和笨重的东西。

# asp.net - 什么内容类型可以强制下载文本响应？

> ID：186867
> 
> 赞同：21
> 
> 时间：2008-10-09T11:40:50.297
> 
> 标签：asp.net

我需要将文件流式传输到响应以保存在最终用户的机器上。该文件是纯文本，那么我可以使用什么内容类型来防止文本显示在浏览器中？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-09T11:51:36.187

为了安全起见并确保所有浏览器中的行为一致，通常最好同时使用这两者：

```
Content-Type: application/octet-stream
Content-Disposition: attachment;filename=\"My Text File.txt\" 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-09T11:43:30.760

在大多数情况下，以下应该有效：

```
Content-type: application/octet-stream
Content-Disposition: attachment; filename="myfile.txt" 
```

有一些边缘浏览器仍会将其显示为文本文件，但主流浏览器都不会（我说的是嵌入在某些 MID 中的浏览器）。

* * *

*编辑*：最初发布此答案时，发送 Mime-Type`application/octet-stream`是在某些浏览器中触发下载的唯一可靠方法。现在在 2016 年，如果您不需要支持古老的浏览器，您可以安全地指定正确的 mime-type。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-09T11:43:15.970

我不认为它是这样工作的。

使用`Content-Disposition: attachment`标题，但坚持使用正确的 Content-Type。

# jquery - IE 中的 jQuery CSS 选择器

> ID：186876
> 
> 赞同：2
> 
> 时间：2008-10-09T11:44:34.207
> 
> 标签：jquery, cross-browser

以下在 Firefox 中有效，但在 IE7 和 8 中中断：

```
$("#my-first-div, #my-second-div").hide(); 
```

所以我必须这样做：

```
$("#my-first-div").hide();
$("#my-second-div").hide(); 
```

这是正常的吗？

编辑：好的，我实际的代码是这样的：

```
$("#charges-gsm,#charges-gsm-faq,#charges-gsm-prices").html(html); 
```

我的错误是这个

```
( IE8): Message: 'nodeName' is null or not an object
  Line: 19 Char: 150 Code: 0
  URI: http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T12:54:51.757

您指定的位置说明：

```
Message: 'nodeName' is null or not an object
    Line: 19 Char: 150 Code: 0
    URI: http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js 
```

那个特定的 jquery 是：

```
nodeName:function(elem,name){
    return elem.nodeName&&elem.nodeName.toUpperCase()==name.toUpperCase();
} 
```

它本身就是为调用创建的闭包`jQuery.extend()`。所以我想问一下，如果您执行“查看源代码”或其 IE 等效项，是否存在任何其他可能干扰 jQuery 的字符串“nodeName”。

您是否还可以通过创建一个 xx.html 文件并在 IE7/8 中打开它来测试以下内容？它在 Ubuntu 的 Firefox 3 下运行良好，无论选择器中的逗号后面有没有空格。

```
<html>
  <head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function(){
      $("a").click(function(event){
        $("#charges-gsm,#charges-gsm-faq,#charges-gsm-prices").html("xx")
        event.preventDefault();
      });
    });
  </script>
  </head>
  <body>
    <a href="http://jquery.com/">jQuery</a>
    <hr>
    <div id="charges-gsm">CHARGES-GSM</div>
    <div id="charges-gsm-faq">CHARGES-GSM-FAQ</div>
    <div id="charges-gsm-prices">CHARGES-GSM-PRICES</div>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T11:54:39.583

嗯，我似乎无法在 IE7 中复制该问题（两种形式对我来说都很好）。怎么破？它也不隐藏，还是只隐藏第一个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T11:57:41.997

您是否尝试过逗号后没有空格？[规范中给出的示例没有空格。](http://docs.jquery.com/Selectors/multiple#selector1selector2selectorN)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T12:00:20.977

*根据[文档，](http://docs.jquery.com/Selectors/multiple#selector1selector2selectorN)*应该*可以工作。您有可能需要删除逗号后的尾随空格字符。*

 ** * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T10:29:33.417

碰巧，您的元素之一是否嵌套在另一个元素中？

IE：

```
<div id="foo">
  <div id="bar"> 
    <div id="baz">
  </div>
</div> 
```

如果是这样，您可能会遇到指针问题，IE 可能在您尝试确定它是一个 div 之前释放了 bar。的行为

```
$("#foo,#bar,#baz").html("xx"); 
```

在这种情况下是：

1.  用 xx 替换 #foo
2.  用 xx 替换 #bar
3.  将 #baz 替换为 xx

但是，如果在第 2 和第 3 阶段，#bar 和 #baz 不再存在，您将获得一些乐趣。（如果 xx 恰好包含 #bar 和 #baz 的副本并不重要，它们可能是不同的对象，并且您要替换的初始对象已经被捕获，只是不再在 DOM 中： / )

您可以通过将过程封装在 try/catch 中来抑制（是的，gah，糟糕的想法）这个错误

```
try { 
  $("#foo,#bar,#baz").html("xx"); 
}
catch( e ) 
{
   /* DO NOTHING D: */ 
} 
```

但这是你最后的手段，就在获得某种 JS 调试器绑定 IE 并将错误跟踪到其核心之后。

# deployment - 最佳实践：Erlang Application Deploy on windows

> ID：186883
> 
> 赞同：8
> 
> 时间：2008-10-09T11:45:21.083
> 
> 标签：deployment, erlang

在部署准备使用的 erlang 应用程序时，我**不**希望用户

*   在 Internet 上找到正确的 erl 版本。
*   安装 erl 虚拟机
*   解压缩并确定梁文件的位置（使用应用程序）
*   阅读自述文件
*   修改任何看起来像配置文件的东西

我对可能的方法有一些想法，但我想获得一些意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T12:34:04.390

还有[Erlware](http://erlware.org/)。

> 我们的核心是托管公共存储库，其中包含可靠的符合 Erlang OTP 的应用程序。我们的存储库使开发人员能够使用 Erlang 社区编写的软件并发布和分发他们自己的软件。

虽然它更面向后端，所以不是一个完整的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T12:03:20.283

对于您所描述的情况，SAE（独立 Erlang）曾经是一个非常好的解决方案，但似乎不再得到维护。

尽管我自己从未使用过它，[但 CEAN](http://cean.process-one.net/doc/)似乎与您想要的很接近：它提供了一个自解压安装程序（尽管目前不适用于 Windows）和提供自定义最小 Erlang 框架的选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-26T11:13:54.573

与 Erlang R13B02 一起发布的[reltool](http://www.erlang.org/doc/apps/reltool/index.html)应用程序旨在解决这个问题。请注意，它目前是一个测试版（0.5 版）。

# asp.net - 如何在 ASP.NET 中使用简历进行文件上传控制？

> ID：186887
> 
> 赞同：1
> 
> 时间：2008-10-09T11:47:46.103
> 
> 标签：asp.net, .net, file-upload

如何使用简历进行 ASP.NET 文件上传控制，不受文件大小限制和安全连接？

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-09T12:49:59.550

您可以将文件拆分为小部分。分别上传每个部分。如果连接中断，只需重新上传最后一部分并继续其他部分。上传所有部分后，只需将服务器上的所有部分合并到一个文件中即可。

# c# - 为什么在传递对象时使用 'ref' 关键字？

> ID：186891
> 
> 赞同：323
> 
> 时间：2008-10-09T11:49:35.507
> 
> 标签：c#, .net, pass-by-reference, ref

如果我将对象传递给方法，为什么要使用 ref 关键字？这不是默认行为吗？

例如：

```
class Program
{
    static void Main(string[] args)
    {
        TestRef t = new TestRef();
        t.Something = "Foo";

        DoSomething(t);
        Console.WriteLine(t.Something);
    }

    static public void DoSomething(TestRef t)
    {
        t.Something = "Bar";
    }
}

public class TestRef
{
    public string Something { get; set; }
} 
```

输出是“Bar”，这意味着该对象是作为引用传递的。

* * *

## 回答 #1

> 赞同：325
> 
> 时间：2008-10-09T11:52:51.647

`ref`如果要更改对象是什么，请传递 a ：

```
TestRef t = new TestRef();
t.Something = "Foo";
DoSomething(ref t);

void DoSomething(ref TestRef t)
{
  t = new TestRef();
  t.Something = "Not just a changed t, but a completely different TestRef object";
} 
```

调用 DoSomething 后，`t`不是指原来的`new TestRef`，而是指完全不同的对象。

如果您想更改不可变对象的值，这也可能很有用，例如 a `string`。`string`一旦创建，您就无法更改它的值。但是通过使用 a `ref`，您可以创建一个函数，将字符串更改为另一个具有不同值的字符串。

`ref`除非需要，否则使用它不是一个好主意。Using`ref`使方法可以自由地更改其他参数，方法的调用者需要进行编码以确保他们处理这种可能性。

此外，当参数类型是对象时，对象变量始终充当对对象的引用。这意味着当使用`ref`关键字时，您将获得对引用的引用。这使您可以按照上面给出的示例中的描述进行操作。但是，当参数类型是原始值（例如`int`）时，如果在方法内分配了这个参数，则在方法返回后，传入的参数的值将改变：

```
int x = 1;
Change(ref x);
Debug.Assert(x == 5);
WillNotChange(x);
Debug.Assert(x == 5); // Note: x doesn't become 10

void Change(ref int x)
{
  x = 5;
}

void WillNotChange(int x)
{
  x = 10;
} 
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2008-10-09T12:02:32.547

您需要区分“通过值传递引用”和“通过引用传递参数/参数”。

我已经写了一篇[相当长的关于这个主题的文章，](http://jonskeet.uk/csharp/parameters.html)以避免每次出现在新闻组上时都必须仔细写

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2008-10-09T12:02:46.820

在 .NET 中，当您将任何参数传递给方法时，都会创建一个副本。在值类型中意味着您对值所做的任何修改都在方法范围内，并且在您退出方法时会丢失。

当传递一个引用类型时，也会创建一个副本，但它是一个引用的副本，即现在您在内存中有两个对同一个对象的引用。因此，如果您使用引用来修改对象，它就会被修改。但是，如果您修改引用本身——我们必须记住它是一个副本——那么任何更改也会在退出该方法时丢失。

正如人们之前所说，赋值是对引用的修改，因此丢失了：

```
public void Method1(object obj) {   
 obj = new Object(); 
}

public void Method2(object obj) {  
 obj = _privateObject; 
} 
```

上述方法不会修改原始对象。

对您的示例进行一些修改

```
 using System;

    class Program
        {
            static void Main(string[] args)
            {
                TestRef t = new TestRef();
                t.Something = "Foo";

                DoSomething(t);
                Console.WriteLine(t.Something);

            }

            static public void DoSomething(TestRef t)
            {
                t = new TestRef();
                t.Something = "Bar";
            }
        }

    public class TestRef
    {
    private string s;
        public string Something 
        { 
            get {return s;} 
            set { s = value; }
        }
    } 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-10-09T11:53:32.707

由于 TestRef 是一个类（它们是引用对象），因此您可以更改 t 内部的内容，而无需将其作为 ref 传递。但是，如果您将 t 作为 ref 传递，则 TestRef 可以更改原始 t 所指的内容。即使它指向不同的对象。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-09T11:52:37.433

你`ref`可以写：

```
static public void DoSomething(ref TestRef t)
{
    t = new TestRef();
} 
```

并且 t 将在方法完成后更改。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-07-17T16:30:51.860

`foo`将引用类型（例如）的变量（例如`List<T>`）视为持有“Object #24601”形式的*对象标识符*。假设语句`foo = new List<int> {1,5,7,9};`导致`foo`保存“Object #24601”（一个包含四个项目的列表）。然后调用`foo.Length`将询问对象#24601 的长度，它会响应 4，因此`foo.Length`等于 4。

如果`foo`在不使用的情况下传递给方法`ref`，则该方法可能会更改 Object #24601。由于此类更改，`foo.Length`可能不再等于 4。但是，方法本身将无法更改`foo`，它将继续持有“对象#24601”。

`foo`作为参数传递`ref`将允许被调用的方法不仅对 Object #24601 进行更改，还对其`foo`自身进行更改。该方法可能会创建一个新对象 #8675309 并将对该对象的引用存储在`foo`. 如果这样做，`foo`将不再持有“对象#24601”，而是“对象#8675309”。

实际上，引用类型变量不包含“Object #8675309”形式的字符串；他们甚至没有任何可以有意义地转换为数字的东西。尽管每个引用类型变量都将保存一些位模式，但存储在这些变量中的位模式与它们所标识的对象之间并没有固定的关系。代码无法从对象或对它的引用中提取信息，然后确定另一个引用是否标识了同一对象，除非代码持有或知道标识原始对象的引用。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-09T11:58:03.070

这就像在 C 中传递一个指向指针的指针。在 .NET 中，这将允许您更改原始 T 所指的内容，尽管我*个人*认为如果您在 .NET 中这样做，您可能遇到了设计问题！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-09T11:53:39.977

通过将`ref`关键字与引用类型一起使用，您实际上是在传递对引用的引用。在许多方面，它与使用`out`关键字相同，但细微的差别在于不能保证该方法实际上会将任何内容分配给`ref`'ed 参数。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-05-10T20:55:07.337

`ref`仅针对两个范围模仿（或表现）为全局区域：

*   呼叫者
*   被调用者。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-09T11:51:31.227

但是，如果您要传递一个值，则情况会有所不同。您可以强制通过引用传递值。例如，这允许您将整数传递给方法，并让该方法代表您修改整数。

# c# - 通过 C# 应用程序测试网站是否存在

> ID：186894
> 
> 赞同：53
> 
> 时间：2008-10-09T11:50:44.070
> 
> 标签：c#, webrequest

我正在寻找通过 C# 应用程序测试网站是否存在的最佳方法。

### 背景

我的应用程序包含一个*Winforms UI*、一个后端*WCF 服务*和一个用于向 UI 和其他消费者发布内容的*网站。*为了防止 UI 启动并且由于缺少 WCF 服务或网站关闭而无法正常工作的情况，我添加了一个应用程序启动检查以确保所有内容都处于活动状态。

该应用程序是用 C#、.NET 3.5、Visual Studio 2008 编写的

### 当前解决方案

目前我正在向网站上的测试页面发出网络请求，该页面将反过来测试网站，然后显示结果。

```
WebRequest request = WebRequest.Create("http://localhost/myContentSite/test.aspx");
WebResponse response = request.GetResponse(); 
```

我假设如果在此调用期间没有出现异常，那么一切都很好并且 UI 可以启动。

### 问题

这是最简单、正确的方法，还是有其他一些我在 C# 中不知道的偷偷摸摸的调用或更好的方法。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2008-10-09T11:58:44.363

```
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
if (response == null || response.StatusCode != HttpStatusCode.OK) 
```

正如@Yanga 提到的， HttpClient 可能是现在更常见的方法。

```
HttpClient client = new HttpClient();
var checkingResponse = await client.GetAsync(url);
if (!checkingResponse.IsSuccessStatusCode)
{
   return false;
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-10-15T05:22:55.867

在使用 WebResponse 时，请确保关闭响应流，即 (.close)，否则它会在某些重复执行后挂起机器。例如

```
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(sURL);
HttpWebResponse response = (HttpWebResponse)req.GetResponse();
// your code here
response.Close(); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-09T12:03:17.973

来自 CodePlex 上的[NDiagnostics](http://www.codeplex.com/NDiagnostics)项目...

```
public override bool WebSiteIsAvailable(string Url)
{
  string Message = string.Empty;
  HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(Url);

  // Set the credentials to the current user account
  request.Credentials = System.Net.CredentialCache.DefaultCredentials;
  request.Method = "GET";

  try
  {
    using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
    {
      // Do nothing; we're only testing to see if we can get the response
    }
  }
  catch (WebException ex)
  {
    Message += ((Message.Length > 0) ? "\n" : "") + ex.Message;
  }

  return (Message.Length == 0);
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-02-14T16:30:29.717

我们今天可以使用[HttpClient()](https://msdn.microsoft.com/en-us/library/system.net.http.httpclient(v=vs.118).aspx)更新答案：

```
HttpClient Client = new HttpClient();
var result = await Client.GetAsync("https://stackoverflow.com");
int StatusCode = (int)result.StatusCode; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-09T12:00:42.473

假设 WCF 服务和网站位于同一个 Web 应用程序中，您可以使用返回应用程序状态的“状态”WebService。您可能想要执行以下一些操作：

*   测试数据库是否启动并运行（良好的连接字符串、服务启动等...）
*   测试网站是否正常工作（具体取决于网站）
*   测试 WCF 是否正常工作（具体取决于您的实现）
*   额外的好处：如果您将来需要支持不同的版本，您可以返回一些关于服务的版本信息。

然后，在 Win.Forms 应用程序上为 WebService 创建一个客户端。如果 WS 没有响应（即您在调用时遇到一些异常），则网站已关闭（如“一般错误”）。
如果 WS 响应，您可以解析结果并确保一切正常，或者如果出现问题，则返回更多信息。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-10-09T11:55:40.017

您需要检查 OK（状态 200）的状态代码。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2014-11-11T08:46:14.967

来自的解决方案：[如何在 C# 中检查网站是否在线？](https://stackoverflow.com/questions/7523741/how-do-you-check-if-a-website-is-online-in-c)

```
var ping = new System.Net.NetworkInformation.Ping();

var result = ping.Send("https://www.stackoverflow.com");

if (result.Status != System.Net.NetworkInformation.IPStatus.Success)
    return; 
```

# visual-studio - 自动命名空间导入

> ID：186895
> 
> 赞同：72
> 
> 时间：2008-10-09T11:51:14.457
> 
> 标签：visual-studio, import, keyboard-shortcuts, hotkeys

Visual Studio（热键）中是否有办法自动导入类型（或在已知名称空间之间选择），如Eclipse中的`Ctrl`+ ？`O`

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-10-09T11:57:10.593

是的，Visual Studio 可以`using`为您添加。当你输入一个类名时，点击`Ctrl`+`.`然后`Enter`（第一个选项是 99.99% 正确的，所以只需点击`Enter`）。您可以让它`using`在该类的命名空间的文件顶部添加。我用它所有的时间。

这比`Shift`+ `Alt`+ `F10`+更容易，`Enter`因为它的键更少并且`.`and`Enter`更接近。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-10-09T11:53:55.747

当您的成员末尾出现红色插入符号时，只需点击`Shift`+ `Alt`+ `F10`，然后使用箭头键选择正确的选项：

[![在此处输入图像描述](https://i.stack.imgur.com/OIf8C.png)](https://i.stack.imgur.com/OIf8C.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-09T11:52:45.127

查看[JetBrain](https://en.wikipedia.org/wiki/JetBrains)出色的[ReSharper](https://en.wikipedia.org/wiki/JetBrains#ReSharper_Ultimate)产品。它为你做这件事。

# webserver - Web 服务器重定向管理工具？

> ID：186900
> 
> 赞同：0
> 
> 时间：2008-10-09T11:51:50.057
> 
> 标签：webserver

我正在考虑推出我自己的，但以防万一已经有一个好的软件可用，我在这里问：是否有东西可以为网络服务器重定向配置提供接口，并允许重定向由一个相当不- 技术用户群。必须满足以下要求：

*   开源
*   阿帕奇
*   支持内部/外部重定向
*   支持网络服务器配置和 htaccess 或元刷新文件（适用于无法重新启动服务器的用户）
*   有效日期范围

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T14:08:59.110

您可以使用[RewriteMap](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap)脚本/程序或静态地图（以您/您的用户最简单的方式）。

查看[http://rewrite.drbacchus.com/rewritewiki/RewriteMap](http://rewrite.drbacchus.com/rewritewiki/RewriteMap)以获取脚本功能的基本示例。性能损失并不像您想象的那么大，因为该进程只启动一次，并且在 Apache 关闭之前一直保持活动状态。所以要小心资源管理。

# python - 带有python中键值对列表的配置文件

> ID：186916
> 
> 赞同：25
> 
> 时间：2008-10-09T11:55:48.643
> 
> 标签：python, configuration, serialization

我有一个 python 脚本，它分析一组错误消息并检查每条消息是否与某个模式（正则表达式）匹配，以便对这些消息进行分组。例如，“文件 x 不存在”和“文件 y 不存在”将匹配“文件 .* 不存在”并被视为两次出现的“文件未找到”类别。

随着模式和类别的数量越来越多，我想将这些“正则表达式/显示字符串”放在一个配置文件中，基本上是某种字典序列化。

我希望这个文件可以手动编辑，所以我放弃了任何形式的二进制序列化，而且我宁愿不使用 xml 序列化来避免字符转义的问题（& <> 等等...... ）。

你知道什么是实现这一目标的好方法吗？

更新：感谢 Daren Thomas 和 Federico Ramponi，但我不能有一个可能包含任意代码的外部 python 文件。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-09T12:32:37.557

我有时只是编写一个名为的python模块（即文件）`config.py`或具有以下内容的东西：

```
config = {
    'name': 'hello',
    'see?': 'world'
} 
```

然后可以像这样“读取”：

```
from config import config
config['name']
config['see?'] 
```

简单的。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-09T14:57:08.293

你有两个不错的选择：

1.  [使用ConfigParser 的](http://docs.python.org/lib/module-ConfigParser.html "配置解析器")Python 标准配置文件格式
2.  [YAML](http://www.yaml.org/ "YAML")使用[PyYAML 之类的库](http://pyyaml.org/ "PyYAML")

标准的 Python 配置文件看起来像带有`[sections]`和`key : value`或`key = value`对的 INI 文件。这种格式的优点是：

*   无需第三方库
*   简单、熟悉的文件格式。

YAML 的不同之处在于它被设计为一种对人类友好的数据序列化格式，而不是专门为配置而设计的。它非常易读，并为您提供了几种不同的方式来表示相同的数据。对于您的问题，您可以创建一个如下所示的 YAML 文件：

```
file .* does not exist : file not found
user .* not found : authorization error 
```

或者像这样：

```
{ file .* does not exist: file not found,
  user .* not found: authorization error } 
```

使用 PyYAML 再简单不过了：

```
import yaml

errors = yaml.load(open('my.yaml')) 
```

此时`errors`是具有预期格式的 Python 字典。YAML 能够表示的不仅仅是字典：如果您更喜欢对列表，请使用以下格式：

```
-
  - file .* does not exist 
  - file not found
-
  - user .* not found
  - authorization error 
```

或者

```
[ [file .* does not exist, file not found],
  [user .* not found, authorization error]] 
```

调用时将生成列表列表`yaml.load`。

YAML 的一个优点是您可以使用它将现有的硬编码数据导出到文件中以创建初始版本，而不是通过剪切/粘贴加上一堆查找/替换来将数据转换为正确的格式。

熟悉 YAML 格式需要更多时间，但使用 PyYAML 比使用 ConfigParser 更简单，其优点是您有更多关于如何使用 YAML 表示数据的选项。

任何一种听起来都适合您当前的需求，如果您的需求扩大，ConfigParser 将更容易开始，而 YAML 会在未来为您提供更多灵活性。

祝你好运！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-09T12:13:27.423

我听说[ConfigObj](http://www.voidspace.org.uk/python/configobj.html "配置对象")比 ConfigParser 更容易使用。它被许多大型项目使用，IPython、Trac、Turbogears 等......

从他们的[介绍中](http://www.voidspace.org.uk/python/configobj.html#introduction)：

ConfigObj 是一个简单但功能强大的配置文件读取器和写入器：一个 ini 文件往返程序。它的主要特点是非常易于使用，具有简单的程序员界面和简单的配置文件语法。它还有很多其他功能：

*   嵌套部分（子部分），到任何级别
*   列出值
*   多行值
*   字符串插值（替换）
*   与强大的验证系统集成
    *   包括自动类型检查/转换
    *   重复部分
    *   并允许默认值
*   写出配置文件时，ConfigObj 保留所有注释以及成员和部分的顺序
*   许多用于处理配置文件的有用方法和选项（如“重新加载”方法）
*   完整的 Unicode 支持

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-09T12:00:52.957

我认为您想要标准库中的[ConfigParser](http://docs.python.org/library/configparser.html#module-ConfigParser)模块。它读取和写入 INI 样式文件。我链接到的标准文档中的示例和文档非常全面。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-09T12:22:03.070

如果您是唯一有权访问配置文件的人，则可以使用简单的低级解决方案。将文本文件中的“字典”保存为元组列表（正则表达式，消息），就像它是 python 表达式一样：

```
[
("file .* does not exist", "file not found"),
("user .* not authorized", "authorization error")
] 
```

在您的代码中，加载它，然后对其进行评估，并在结果中编译正则表达式：

```
f = open("messages.py")
messages = eval(f.read()) # caution: you must be *sure* of what's in that file
f.close()
messages = [(re.compile(r), m) for (r,m) in messages] 
```

最后得到一个元组列表（compiled_regexp，message）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-09T12:57:56.787

我通常按​​照达伦的建议做，只需将您的配置文件设为 Python 脚本：

```
patterns = {
    'file .* does not exist': 'file not found',
    'user .* not found': 'authorization error',
} 
```

然后您可以将其用作：

```
import config

for pattern in config.patterns:
    if re.search(pattern, log_message):
        print config.patterns[pattern] 
```

顺便说一句，这就是 Django 对他们的设置文件所做的事情。

# java - 如何捕获 ClassCastException？

> ID：186917
> 
> 赞同：10
> 
> 时间：2008-10-09T11:56:07.753
> 
> 标签：java, exception, exception-handling

从 xml 反序列化对象时，我试图捕获 ClassCastException。

所以，

```
try {
    restoredItem = (T) decoder.readObject();
} catch (ClassCastException e){
    //don't need to crash at this point,
   //just let the user know that a wrong file has been passed.
} 
```

然而这不会因为异常没有被捕获。你有什么建议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-09T12:36:44.850

问题中的代码应该给你一个未经检查的强制转换警告。听-Xlint。

编译器对 T 的所有了解都是它的边界，它可能不知道（除了显式扩展 Object 和 null 类型的 super）。因此，运行时的有效转换是 (Object) - 不是很有用。

您可以做的是传入参数化类型的 Class 的实例（假设它不是通用的）。

```
class MyReader<T> {
    private final Class<T> clazz;
    MyReader(Class<T> clazz) {
        if (clazz == null) {
            throw new NullPointerException();
        }
        this.clazz = clazz;
    }
    public T restore(String from) {
        ...
        try {
            restoredItem = clazz.cast(decoder.readObject());
            ...
            return restoredItem;
        } catch (ClassCastException exc) {
            ...
        }
    }
} 
```

或作为通用方法：

```
 public <T> T restore(Class<T> clazz, String from) {
        ...
        try {
            restoredItem = clazz.cast(decoder.readObject());
            ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T12:51:44.320

不会有任何 ClassCastException，除非你的 T 有一些基础：

```
public class GenericsTest
{
    public static void main(String[] args)
    {
        System.out.println(cast(Integer.valueOf(0)));
        System.out.println(GenericsTest.<Long> cast(Integer.valueOf(0)));
        System.out.println(GenericsTest.<Long> cast("Hallo"));

        System.out.println(castBaseNumber(Integer.valueOf(0)));
        System.out.println(GenericsTest.<Long> castBaseNumber(Integer.valueOf(0)));
        System.out.println(GenericsTest.<Long> castBaseNumber("Hallo"));
    }

    private static <T extends Number> T castBaseNumber(Object o)
    {
        T t = (T)o;
        return t;
    }

    private static <T> T cast(Object o)
    {
        T t = (T)o;
        return t;
    }
} 
```

在上面的示例中，前 5 次调用 cast 和 castBaseNumber 时不会出现 ClassCastException。只有第 6 次调用会引发 ClassCastException，因为编译器有效地将 cast() 转换为 return (Object) o，并将 castBaseNumber() 转换为 return (Number)o;。温你写

```
String s = GenericsTest.<Long> cast("Hallo"); 
```

你会得到一个 ClassCastException，但不是在 cast-method 中，而是在分配给 s 时。

因此，我确实认为，您的“T”不仅仅是“T”，而是“T extends Something”。所以你可以检查：

```
Object o = decoder.readObject();
if (o instanceof Something)
    restoredItem = (T) o;
else 
    // Error handling 
```

但这仍然会在以后使用类时导致错误。

```
public Reader<T extends Number>{...}

Long l = new Reader<Long>("file.xml").getValue(); // there might be the ClassCastException 
```

对于这种情况，只有汤姆的建议可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T12:10:08.413

好吧，我不能使用`instanceof`运算符，因为该方法是参数化的：

```
public T restore(String from){
...
restoredItem = (T) decoder.readObject();
...
} 
```

Java 中的泛型只是编译时的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T16:35:08.190

如果你不能使用 instaceof 你也许可以在 Class 上使用 isAssignableFrom 方法

# c# - C# - 如何更改 HTML 元素的属性

> ID：186918
> 
> 赞同：18
> 
> 时间：2008-10-09T11:56:36.677
> 
> 标签：c#, html, asp.net

我的母版页包含一个列表，如此处所示。不过，我想做的是将“class=active”属性添加到当前活动的列表 li 中，但我不知道该怎么做。我知道代码在 aspx 页面的 page_load 事件中，但不知道如何访问我需要添加属性的 li。请赐教。非常感谢。

```
<div id="menu">
  <ul id="nav">
    <li class="forcePadding"><img src="css/site-style-images/menu_corner_right.jpg" /></li>               
    <li id="screenshots"><a href="screenshots.aspx" title="Screenshots">Screenshots</a></li>
    <li id="future"><a href="future.aspx" title="Future">Future</a></li>
    <li id="news"><a href="news.aspx" title="News">News</a></li>
    <li id="download"><a href="download.aspx" title="Download">Download</a></li>
    <li id="home"><a href="index.aspx" title="Home">Home</a></li>
    <li class="forcePadding"><img src="css/site-style-images/menu_corner_left.jpg" /></li>
  </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-09T12:26:21.890

为了从服务器端访问这些控件，您需要使它们 runat="server"

```
<ul id="nav" runat="server">
  <li class="forcePadding"><img src="css/site-style-images/menu_corner_right.jpg" /></li>               
  <li id="screenshots"><a href="screenshots.aspx" title="Screenshots">Screenshots</a></li>
  <li id="future"><a href="future.aspx" title="Future">Future</a></li>
  <li id="news"><a href="news.aspx" title="News">News</a></li>
  <li id="download"><a href="download.aspx" title="Download">Download</a></li>
  <li id="home"><a href="index.aspx" title="Home">Home</a></li>
  <li class="forcePadding"><img src="css/site-style-images/menu_corner_left.jpg" /></li>
</ul> 
```

在代码隐藏中：

```
foreach(Control ctrl in nav.controls)
{
   if(!ctrl is HtmlAnchor)
   {
      string url = ((HtmlAnchor)ctrl).Href;
      if(url == GetCurrentPage())  // <-- you'd need to write that
         ctrl.Parent.Attributes.Add("class", "active");
   }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-09T12:25:11.470

下面的代码可用于在控件层次结构中的任何位置查找命名控件：

```
public static Control FindControlRecursive(Control rootControl, string id)
{
    if (rootControl != null)
    {
        if (rootControl.ID == id)
        {
            return rootControl;
        }

        for (int i = 0; i < rootControl.Controls.Count; i++)
        {
            Control child;

            if ((child = FindControlRecursive(rootControl.Controls[i], id)) != null)
            {
                return child;
            }
        }
    }

    return null;
} 
```

因此，您可以执行以下操作：

```
Control foundControl= FindControlRecursive(Page.Master, "theIdOfTheControlYouWantToFind");
((HtmlControl)foundControl).Attributes.Add("class", "active"); 
```

之前忘了提到，您确实需要 runat="server" 在您希望能够以这种方式找到的任何控件上 =)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T23:35:42.473

在母版页中的 li 标记上添加 runat="server" 然后将其添加到适当的 page_load 事件中以将“活动”类添加到母版页中的 li

HtmlGenericControl li = HtmlGenericControl)Page.Master.FindControl("screenshots"); li.Attributes.Add("class", "active");

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T12:09:44.467

您可以像这样注册客户端脚本：

（将 id 设置为要设置为活动的 li 的 id）

```
ClientScript.RegisterStartupScript(this.GetType(), "setActiveLI", "document.getElementById(\""+id+"\").setAttribute(\"class\", \"active\");", true); 
```

这会在元素已经呈现后在靠近底部的页面上生成一个 JavaScript 调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T13:59:52.857

以前的答案中已经提供了所有部分，但是要将整个内容放在一起，您需要：

*   将 runat="server" 属性添加到`<ul>`and`<li>`元素*   添加一个公共方法来完成母版页上的工作，该方法可以从使用母版页的页面调用*   从页面的 Page_Load 调用方法

    或者，您也可以将代码添加到母版页的 OnLoad(...) 方法，这样您就不必在每个页面上都添加对 Page_Load 的方法调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T11:57:43.930

如果它们是 runat=server 你可以使用 attributes 属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T12:10:29.520

为了找到该特定控件，需要将其定义为公共（在生成的设计器中）

或者需要在代码隐藏中由公共获取包装。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-09T12:23:35.797

您可以通过将母版页上的属性包装在母版页上的属性中，将母版页上的 li 公开给任何内容页：

```
public GenericHtmlControl Li1
{
    get
    {
        return this.LiWhatever;
    }
} 
```

然后在内容页面上：

```
MasterPage2 asd = ((MasterPage2)Page.Master).Li1.Attributes.Add("class", "bla"); 
```

如果我做对了！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-11T00:59:32.700

我找到了一个使用 CSS 工作的链接，并且只涉及更改 body 标签的 class 属性。这意味着没有 Javascript，也没有 for 循环或任何东西。

```
#navbar a:hover,
  .articles #navbar #articles a,
  .topics #navbar #topics a,
  .about #navbar #about a,
  .contact #navbar #contact a,
  .contribute #navbar #contribute a,
  .feed #navbar #feed a {
 background: url(/pix/navbarlinkbg.gif) top left repeat-x; color: #555;
}

....

<body class="articles" onload="">

<ul id="navbar">
  <li id="articles"><a href="/articles/" title="Articles">Articles</a></li>
  <li id="topics"><a href="/topics/" title="Topics">Topics</a></li>
  <li id="about"><a href="/about/" title="About">About</a></li>
  <li id="contact"><a href="/contact/" title="Contact">Contact</a></li>
  <li id="contribute"><a href="/contribute/" title="Contribute">Contribute</a></li>
  <li id="feed"><a href="/feed/" title="Feed">Feed</a></li>
</ul> 
```

在此处阅读更多信息 [http://www.websiteoptimization.com/speed/tweak/current/](http://www.websiteoptimization.com/speed/tweak/current/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-02T08:16:51.333

试试这个很好的例子以备将来使用。我知道这个线程很旧，但对于未来的查询......

[http://community.discountasp.net/showthread.php?p=33271](http://community.discountasp.net/showthread.php?p=33271)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-29T07:57:26.347

感谢您的解决方案。

最小化的代码。

母版页控件也可以在子页中找到..

我的意思是母版页包含 html 控件

和chilld页面可以像这样找到母版页html控制

```
((HtmlControl)this.Master.FindControl("dpohome1")).Attributes.Add("class", "on"); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-10-08T10:05:52.547

简单的逻辑和最少的代码，我通常使用下面的代码，尤其是在动态菜单中。希望这可以帮助。

在母版页后面的代码中创建此方法代码

代码隐藏 (C#)

`protected string SetCssClass(string page) { return Request.Url.AbsolutePath.ToLower().EndsWith(page.ToLower()) ? "active" : ""; }`

在您创建的菜单列表项中调用此方法传递页面名称，如下所示

HTML PAGE（ASPX 内联代码）

`<li id="screenshots" class = "<%= SetCssClass("screenshots.aspx") %>"> <a href="screenshots.aspx" title="Screenshots">Screenshots</a></li>`

`<li id="future" class = "<%= SetCssClass("future.aspx") %>"> <a href="future.aspx" title="Future">Future</a></li>`

等等。

By this method, every time you add a page and link, you don't have to write code in every page. Just when you add the link in the master page, with every `<li>` invoke the `SetCssClass(pagename)` method call for setting class and it's done. (you can rename the method as per your ease.

You can use longer codes if you are being paid per lines of code bcoz then this is just one line of code. (lol). Just kidding. Hope it helps.

Note: I am ignoring other parts of the html code, you can include them also, that would work fine.

# javascript - 当页面上有一个大表格时，我可以加快 YUI 布局管理器的速度吗？

> ID：186921
> 
> 赞同：0
> 
> 时间：2008-10-09T11:57:15.553
> 
> 标签：javascript, internet-explorer, layout, yui

我正在使用 YUI 布局管理器，它似乎以正常的速度工作。但是，如果页面包含`<Table>`大约 500 行的大页面，则 YUI`render()`函数需要大约一**分钟**的时间才能运行。

当我在没有布局管理器的情况下打开同一页面时，它会在不到一秒的时间内打开。

我*唯一*关心的是**IE 7**。我在firefox上试了一下，只用了大约三秒钟。

关于什么需要这么长时间的任何想法？我可以以某种方式告诉布局管理器忽略表格吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-09T14:06:26.900

我终于自己弄清楚了。

诀窍是隐藏布局管理器应该忽略的内容。

在为包含大量页面的标签调用`render()`set之前`style.display = 'none'`，您不需要布局管理器来管理。使用 后将其恢复正常`style.display = 'block'`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-12T12:02:57.610

你的意思是你的大表的 render() 方法需要很长时间吗？

YUI DataTable 有一个专门针对这种情况的[renderLoopSize属性。](http://developer.yahoo.com/yui/datatable/#renderLoop)它使表格每 X 行渲染到 DOM，而不是等到最后并一次性渲染它们。

```
var myDataTable = new YAHOO.widget.DataTable("myContainer", 
                         myColumnDefs, 
                         myDataSource, 
                        {renderLoopSize: 100}); 
```

# java - Java/Glassfish 日志文件的远程日志查看器

> ID：186922
> 
> 赞同：12
> 
> 时间：2008-10-09T11:57:26.067
> 
> 标签：java, logging

我正在寻找与 Chainsaw 具有相似功能的日志查看器，我可以在其中跟踪 Glassfish 日志文件，例如 SSH/SCP。有谁知道这样的工具是否存在？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-04-05T22:40:15.897

OtrosLogViewer 用户 VFSFileSystems 并且可以从远程服务器（ftp、sftp、smb、http）加载日志。它支持 java.util.logging.XMLFormatter 和 java.util.logging.SimpleFormatter。请参阅： [http ://code.google.com/p/otroslogviewer/](http://code.google.com/p/otroslogviewer/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-01T03:06:31.997

我已经开始查看 OtrosLogViewer 并发现它最近的更新需要更改 GlassFish 的模式文件格式。信息来自[这个问题](http://code.google.com/p/otroslogviewer/issues/detail?id=97)。

这是对我有用的模式定义：

```
name=GlassFish Pattern
type=log4j
pattern=[#|TIMESTAMP|LEVEL|PROP(A)|LOGGER|_ThreadID=PROP(B);_ThreadName=THREAD;|MESSAGE
dateFormat=yyyy-MM-dd'T'HH:mm:ss.SSSZZZZ
charset=UTF-8
customLevels=SEVERE=FATAL,WARNING=WARN,CONFIG=INFO,FINE=DEBUG,FINER=TRACE,FINEST=TRACE,INFO=INFO 
```

我正在使用 OtrosLogViewer 的 2012-04-25 版。在解析尾随`\n|#]`的问题得到解决之前，它们会稍微污染消息。

**编辑：** [第四个字段是记录器名称](http://docs.oracle.com/cd/E26576_01/doc.312/e24928/logging.htm#gkmex)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-12-16T19:00:35.700

OtrosLogViewer 很好，但您必须为 glassfish 日志设置模式。

只需在 ${OTROS_ROOT}/plugins/logimporters/glassfish.pattern 中创建一个文件：

```
type=log4j
pattern=[#|TIMESTAMP|LEVEL|PROP(A)|CLASS|_ThreadID=PROP(B);_ThreadName=THREAD;|MESSAGE|#]
dateFormat=yyyy-MM-ddTHH:mm:ss.SSSZZZZ
name=glassfish parser
charset=UTF-8 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-09T12:26:41.500

带有 VFS 插件的电锯不会这样做吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T17:50:37.683

从[其他帖子](https://stackoverflow.com/questions/186968/map-ssh-drive-in-windows)：

1.  配置 putty 以从连接中写出日志文件。
2.  对 putty 日志文件进行日志分析。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-06T05:04:36.717

我整理了一些东西，让我可以将 java.util 日志记录与 GlassFish 和 Chainsaw 一起使用。来源等：http: [//blog.cotopia.com/2009/10/sending-glassfish-javautil-log-records.html](http://blog.cotopia.com/2009/10/sending-glassfish-javautil-log-records.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-14T13:49:18.290

尝试回顾性日志分析器-> [http://www.retrospective.ch/](http://www.retrospective.ch/)

它可以使用 SSH 搜索远程服务器上的文件和尾部文件（也可以在本地磁盘上）。它不必下载文件的内容来搜索它（如 Otros）。一切都是在服务器上临时完成的（以只读方式 - 以便生产服务器是安全的）。

它还可以自动进行行和列拆分（它将解析日志文件并生成符合 log4j 的行和列拆分模式，以便您的日志条目被正确拆分） - 您不必猜测/键入它你自己。

最后，它还可以解析日期，以便您可以使用日期过滤器搜索本地/远程文件（如果您在一个文件夹中有很多旧文件，这非常有用）。

免责声明：我是 Retrospective 的开发人员之一。这篇文章不是广告，而是基于我的观点和经验的个人陈述。我已经测试了这个线程中提到的所有建议的解决方案，并且我相信回顾是解决这个问题的最佳解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-15T05:41:27.973

VFSLogFilePatternReceiver 使用 Jakarta Commons-VFS，因此它支持 SFTP 和 SCP。请参阅：[http ://commons.apache.org/vfs/filesystems.html#SFTP](http://commons.apache.org/vfs/filesystems.html#SFTP)

# .net-2.0 - 如何为应用程序定义程序集文件夹？

> ID：186923
> 
> 赞同：3
> 
> 时间：2008-10-09T11:57:29.140
> 
> 标签：.net-2.0

如何正确定义应用程序的程序集文件夹？我尝试使用注册表项：HKLM/SOFTWARE/Microsoft/.NET Framework/AssemblyFolders/App-Name 并使用（默认）将其设置为程序集所在的路径。

前段时间这工作得很好，但是当我编译一个新版本并将其部署到 PC 时，它就不再工作了。

我是否必须添加其他内容或错过任何任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-14T17:23:24.723

如果您尝试在运行 64 位操作系统的机器上添加引用，则需要在以下注册表项下添加您的 App-Name。

HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft.NETFramework\AssemblyFolders\App-Name。

这与您的示例完全相同，只是您需要在 SOFTWARE 和 Microsoft 之间添加 Wow6432Node 键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-30T06:33:32.710

这些注册表项仅由 Visual Studio 用于加载引用列表和帮助提示路径。基于 .Net 构建的应用程序使用程序集加载规则检查 GAC、应用程序的私有 bin 路径或私有 bin 路径下的某些其他子文件夹中的程序集。.Net 运行时不使用注册表在运行时解析程序集。

# c - 在通信中添加 TLS/SSL 层..？

> ID：186932
> 
> 赞同：2
> 
> 时间：2008-10-09T11:59:00.120
> 
> 标签：c, ssl

我的东西是由几个组件组成的，其中一些是用 C 编写的。由于我想添加一些安全功能，我正在考虑通过 SSL/TLS 层进行通信。

你能给我一些好的库来做这个（如果可能的话）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-19T11:50:47.210

[GnuTLS](http://www.gnu.org/software/gnutls/)（请注意，它主要是 LGPL 而不是 GPL，因此您**可以**链接到它）。至少我更喜欢它的 API 而不是[OpenSSL](http://www.openssl.org/)。

还有 Mozilla 的[NSS](http://www.mozilla.org/projects/security/pki/nss/intro.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T12:13:09.453

[OpenSSL](http://www.openssl.org/)怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-09T12:22:26.483

我们使用[axTLS](http://axtls.cerocclub.com.au/)，它在我们的服务器 (.NET) 和我们的嵌入式系统（Linux 和 uClinux）上都非常有效。我们在让 OpenSSL 在 uClinux 上正常工作时遇到了问题。
axTLS 的功能不如 OpenSSL 完整，因此请确保在使用前满足您的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T02:03:20.373

我建议不要花时间尝试在您的应用程序中实现 SSL 功能。相反，您可以只使用现有的 SSL 隧道软件，该软件在您现有的套接字应用程序前面创建一个 SSL 隧道。

```
Internet --- [SSLTunnel] --- Your App 
```

例如，您可以告诉 SSL 隧道侦听端口 443 (https) 并将所有解密的数据包转发到端口 80 (http)。对于您的自定义应用程序，它只会看到解密的数据包。

有很多免费的应用程序可以做到这一点。只需谷歌一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-29T17:19:19.117

CyaSSL 将是一个很好的选择。这是一个用 C 语言编写的嵌入式 SSL 库，已针对速度和大小进行了优化。它最多可以比 OpenSSL 小 20 倍，而且速度也快很多。

功能列表中包括 30-100kb 的最小大小和 OpenSSL 兼容层。完整的功能列表可以在 yaSSL 网站上找到：

[http://www.yassl.com/yaSSL/Products_cyassl.html](http://www.yassl.com/yaSSL/Products_cyassl.html)。

它在开源 GPLv2 和商业许可下双重许可（用于支持）。它非常频繁地更新新功能。我认为其中一个很酷的功能是支持来自 eStream 项目的 RABBIT 和 HC-128 流密码。

# iphone - iPhone“网站错误”

> ID：186935
> 
> 赞同：2
> 
> 时间：2008-10-09T12:00:41.553
> 
> 标签：iphone, encoding, utf-8

我正在用 PHP 为 iPhone 应用程序编写服务器端程序。而且我没有 iPhone。:P

每当用户运行 iPhone 应用程序时，iPhone 应用程序都会从​​站点请求 XML 文件。您可以访问[http://www.appvee.com/iphone/ads](http://www.appvee.com/iphone/ads)或[http://www.appvee.com/iphone/latest](http://www.appvee.com/iphone/latest)获取 XML 文件。

并且会显示一个消息框，其中包含以下错误消息：“Web Site Error Conversion of data failed. The file is not UTF-8, or in the encoding specified in XML header if XML.” ![替代文字](https://farm4.static.flickr.com/3195/2925993535_bd62b7cf42.jpg?v=0)

也许我必须添加 header("Content-type: text/xml"); 在 PHP 文件的开头？我没有添加这一行，它之前运行良好。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-09T12:06:08.187

它可能是“最新”XML 中未转义的特殊字符（看起来应该是卷曲撇号）。（在“找出关于你周围的[这是字符]以及如何......”的信息的行中）

添加 XML 内容类型标头是否可以解决问题？你问它是否有必要，但没有说明它是否有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-09T12:21:28.030

我同意ceejayoz，看起来这是一个特殊字符问题。

我建议使用[htmlentities](http://us.php.net/htmlentities)方法对 xml 文件中的数据进行编码。

# sql - 生成多个和过滤的 Drop + 创建存储过程

> ID：186942
> 
> 赞同：1
> 
> 时间：2008-10-09T12:01:19.553
> 
> 标签：sql, sql-server, stored-procedures, system-stored-procedures

我有这个脚本：

```
select name,create_date,modify_date from sys.procedures order by modify_date desc 
```

我可以看到最近修改了哪些程序。我将添加一个“where modify_date >=”并且我想使用一些系统存储过程，这将生成我：drop + create scripts for the（比如说 5 个匹配的）存储过程

我能以某种方式做到这一点吗？

谢谢

* * *

行。我有最终版本：

[http://swooshcode.blogspot.com/2008/10/generate-stored-procedures-scripts-for.html](http://swooshcode.blogspot.com/2008/10/generate-stored-procedures-scripts-for.html)

你们帮了很多忙

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T12:47:15.077

这不漂亮，但它有效。手动运行它的输出或使用 sp_executesql 执行它。

```
SELECT OBJECT_DEFINITION(object_id), 'drop procedure [' + name + ']'
FROM   sys.procedures
WHERE modify_date >= @date 
```

您还必须担心失去权利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-09T13:30:01.327

不需要游标（根据需要修改模式等）：

```
DECLARE @dt AS datetime
SET @dt = '10/1/2008'

DECLARE @sql AS varchar(max)

SELECT @sql = COALESCE(@sql, '')
    + '-- ' + o.name + CHAR(13) + CHAR(10)
    + 'DROP PROCEDURE ' + o.name + CHAR(13) + CHAR(10)
    + 'GO' + CHAR(13) + CHAR(10)
    + m.definition + CHAR(13) + CHAR(10)
    + 'GO' + CHAR(13) + CHAR(10)
FROM sys.sql_modules AS m
INNER JOIN sys.objects AS o
    ON m.object_id = o.object_id
INNER JOIN sys.procedures AS p
    ON m.object_id = p.object_id
WHERE p.modify_date >= @dt

PRINT @sql -- or EXEC (@sql) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-09T12:37:54.083

您可以使用游标遍历每条记录：

```
DECLARE @spName NVARCHAR(128)
DECLARE myCursor CURSOR FOR SELECT name FROM sys.procedures ORDER BY modify_date DESC
OPEN myCursor
FETCH NEXT FROM myCursor INTO @spName
WHILE @@fetch_status = 0
BEGIN
    -- Process each stored procedure with a dynamic query
    PRINT @spName
FETCH NEXT FROM myCursor INTO @spName
END
CLOSE myCursor
DEALLOCATE myCursor 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-09T13:09:15.953

同时我做了一些挖掘，看起来像

```
sp_helptext 'my_stored_procedure' 
```

是我需要的，（加上当我问 jdecuyper 更多解释的问题时我已经知道的部分）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T13:53:40.437

这最好用比 SQL 更合适的语言来完成。尽管有许多扩展，例如 T-SQL、PL/SQL 和 PL/pgSQL，但 SQL 并不是完成这项任务的最佳选择。

这是一个类似问题的链接，我的回答是使用 SQL-DMO 或 SMO，具体取决于您使用的是 SQL 2000 还是 2005。

[如何使用c#复制数据库](https://stackoverflow.com/questions/174515/how-do-you-copy-a-ms-sql-2000-database-programmatically-using-c#175062)

# c - 如何使用c将文件从linux复制到windows服务器

> ID：186944
> 
> 赞同：1
> 
> 时间：2008-10-09T12:01:39.413
> 
> 标签：c, windows, linux, file, copy

我必须创建一个将在 Linux 服务器上运行的 C 程序。它将从 Oracle 数据库中获取信息，创建一个本地文件，然后将该文件复制到 Windows 服务器。我知道如何在 Linux 服务器上创建本地文件。但是将它从C复制到Windows服务器的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-09T12:03:35.417

先挂载 Windows 共享，然后在挂载的目录中创建文件。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-09T12:32:14.080

这取决于两台机器之间的连接类型以及您必须达到的安全级别。

最简单的情况是两台机器在同一个局域网上，没有特别的安全性。在这种情况下，可能的解决方案是：

*   **[Samba](http://us6.samba.org/samba/)** : 在 Win 机器上共享一个目录，在 Linux 机器上安装/配置 Samba。C 程序会将共享磁盘视为特定路径下的本地磁盘（例如 /win/share）。

*   **NFS**：或者，您可以使用 NFS 在 Linux 上导出目录并在 Win 机器上安装/配置 NFS 产品。如果出于任何原因（例如安全/身份验证）无法使用 Samba，我认为这是第二个选项。

*   **ftp**：您需要在 Windows 机器上安装一个 ftp 服务器。通过 C 程序复制文件也会比较棘手。如果我没记错的话，Linux 上的 ftp 客户端是交互式的，它不应该在脚本中（或通过其他程序）使用，但你应该检查一下。

*   **http**：您需要在 Windows 机器上安装一个 http 服务器和一个允许上传的页面（IIS 加上一些 asp 页面就足够了）并使用**[libcurl](http://curl.haxx.se/)**与之对话。

当安全性受到关注时，更复杂的场景将需要使用 scp 或 sftp over 和 SSL 连接。带有 https 的 libcurl 也可以提供足够好的解决方案。

我的建议是：首先尝试 Samba，看看是否满足您的需求，作为程序员，所有其他选项都需要您做更多的工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-09T13:11:19.617

也许您可以简单地使用 smbclient？无需设置任何服务器或任何东西，只需在服务器上拥有某种共享驱动器即可。

```
smbclient //myserver/my_directory <password> -U [domain/]<my_user> 
```

然后，您可以在 linux 机器上的当前目录和 Windows 服务器之间“放置”和“获取”您喜欢的任何文件。

```
put my_file_to_copy.dat 
```

就是这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T20:43:04.573

是的 - 只需使用您想要的任何网络文件系统（例如 Samba）安装 windows 框，然后使用普通 IO 原语将文件复制到该目录中。

标记

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T12:10:44.043

或者使用 FTP。有很多 FTP 库可以链接到你的 Linux C 代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T12:10:49.707

windows机器应该首先提供一种接受这种行为的方法（想到FTP）。您可以开发一个在 windows 机器上运行的应用程序来接受文件，但更容易使用已经开发的应用程序之一。

[filezilla](http://filezilla-project.org/)就是一个例子。

对于实际问题，如何上传文件，任何 ftp 客户端都可以解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-09T13:38:12.620

使用 SMTP 并邮寄怎么样？

# java - 将 Delphi Web 服务导入 Java

> ID：186945
> 
> 赞同：1
> 
> 时间：2008-10-09T12:01:56.137
> 
> 标签：java, eclipse, web-services, delphi

我有一个在 Delphi 中构建的 Web 服务器，我试图通过 Eclipse 向导创建一个 Web 服务客户端，在 Java 上使用它的 Web 服务（我正在使用 Eclipse IDE）。Web 服务资源管理器识别 WSDL 文件，但在尝试创建客户端时，向导说存在“意外属性”并且没有创建任何文件。

这是我的 wsdl 文件（我的 Delphi Web Server 发布的那个）。

```
<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:xs="http://www.w3.org/2001/XMLSchema" name="ITSOAPWebServiceservice" targetNamespace="http://tempuri.org/" xmlns:tns="http://tempuri.org/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:mime="http://schemas.xmlsoap.org/wsdl/mime/">
  <message name="WebMethod0Request">
    <part name="Document" type="xs:string"/>
  </message>
  <message name="WebMethod0Response">
    <part name="return" type="xs:boolean"/>
  </message>
  <portType name="ITSOAPWebService">
    <operation name="WebMethod">
      <input message="tns:WebMethod0Request"/>
      <output message="tns:WebMethod0Response"/>
    </operation>
  </portType>
  <binding name="ITSOAPWebServicebinding" type="tns:ITSOAPWebService">
    <soap:binding style="rpc" transport="http://schemas.xmlsoap.org/soap/http"/>
    <operation name="WebMethod">
      <soap:operation soapAction="urn:TWebServiceIntf1-ITSOAPWebService#WebMethod" style="rpc"/>
      <input message="tns:WebMethod0Request">
        <soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="urn:TWebServiceIntf1-ITSOAPWebService"/>
      </input>
      <output message="tns:WebMethod0Response">
        <soap:body use="encoded" encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" namespace="urn:TWebServiceIntf1-ITSOAPWebService"/>
      </output>
    </operation>
  </binding>
  <service name="ITSOAPWebServiceservice">
    <port name="ITSOAPWebServicePort" binding="tns:ITSOAPWebServicebinding">
      <soap:address location="http://localhost:1024/soap/ITSOAPWebService"/>
    </port>
  </service>
</definitions> 
```

现在，Eclipse 说两者中的“消息”属性：

```
definicions.binding.operation.input  
definitions.binding.operation.output 
```

出乎意料。我知道这是多余的，因为这些已经在

```
definitions.portType.operation.input  
definitions.portType.operation.output 
```

但是，我仍然无法导入 Web 服务。

我的 Java 应用程序将在 JBoss 4.2 服务器上运行，但我认为将客户端创建为 Java 实用程序项目会更容易（因为它只创建一个项目而不是两个）。

那么，关于如何让 Eclipse 忽略这些属性，或者 Delphi 不发布它们的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T18:09:15.583

从 apache 尝试 Axis2，查看 wsdl2java 命令为您的 Delphi Web 服务生成 java 客户端。如果您使用 Ant 进行构建，则有一个任务是生成您的客户端。

[http://ws.apache.org/axis2/1_3/userguide-creatingclients.html](http://ws.apache.org/axis2/1_3/userguide-creatingclients.html)

# testing - PC+嵌入式软件组合的自动化系统测试方法

> ID：186953
> 
> 赞同：0
> 
> 时间：2008-10-09T12:03:31.470
> 
> 标签：testing, testing-strategies

该系统由硬件设备和PC组成。PC 运行一个控制硬件设备的 GUI。为了测试设备，使用了可以通过 RS232 或 GPIB 控制的各种测试硬件。为了使测试自动化，测试软件必须控制测试硬件并与 PC GUI 交互。

您知道自动化该系统测试的最佳方法是什么？

有很多方法可以测试这样的系统。测试可以由 COTS 测试软件或内置的定制测试软件控制。COTS 包的组合可能是最好的方法——一种专门用于 GUI 测试，另一种用于设备。我已经看到 Labview 应用于测试设备——不确定它是否也可以做 GUI。也许离开 Windows 应用程序的 GUI 层并公开自动化层是最好的方法。你怎么看？你试过什么？

投票支持更好的技术应该非常有趣。

“最佳方式”必须考虑以下因素：最有效、可维护性、实施时间、成本等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T19:17:24.400

在这种具有多个单独组件的情况下，几乎可以肯定最好先单独测试每个组件，然后再测试集成的整体。

因此，为测试创建框架和测试：
Windows GUI
自动化层。
硬件设备。

虽然大多数组件可以通过无限预算和无限时间实现自动化，但测试关键组件并使用人员测试其余部分通常更值得。

用户显然有能力破坏任何东西，所以一旦你解决了大部分问题，就让他们参与进来。这也意味着您将获得宝贵的反馈。

最后......只有在硬件/软件中有错误是可以接受的情况下才使用这种方法。
例如，如果您正在编写飞机控制软件，我不会推荐这种方法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-09T12:04:17.490

使用 xUnit 框架创建自定义测试软件包。

# excel - 如何阻止 Excel 提示重新打开工作簿？

> ID：186963
> 
> 赞同：6
> 
> 时间：2008-10-09T12:07:04.923
> 
> 标签：excel, vba

我有一个包含 VBA 应用程序的只读 Excel 工作簿。应用程序将需要保存在数据库中的所有数据保存在数据库中，并且工作簿始终关闭而不保存（通过在 BeforeClose 中设置 ThisWorkbook.Saved = True）。

我有以下问题：

*   用户在 Windows 资源管理器中双击工作簿，工作簿打开。

*   用户在 Windows 资源管理器中再次双击工作簿。

*   Excel 提示：“MyWorkbook.xls 已打开。重新打开将导致您所做的任何更改被丢弃。是否要重新打开 MyWorkbook.xls？”

*   如果用户单击“是”，则重新打开工作簿*而不执行已打开实例的 BeforeClose 事件处理程序*。

这是我的应用程序中的一个问题，因为这意味着 BeforeClose 事件处理程序中的一些重要清理代码没有被执行。

任何人都可以为此建议一个 VBA 解决方案。这可能是：

*   禁止提示重新打开工作簿。而是默默地使用已经打开的实例。

*   以某种方式让 BeforeClose 或其他一些事件处理程序在原始实例关闭之前运行，这样我就可以运行我的清理代码。

更新：

这是 Excel 2003。

我可以通过在 Workbook_SheetChanged 事件处理程序中设置“ThisWorkbook.Saved = True”来摆脱不需要的提示（VBA 应用程序负责保存需要保存在数据库中的任何数据，所以我不关心拥有 Excel保存更改）。

但是，这并不能解决我的问题：如果我这样做，则在资源管理器中双击工作簿会静默地重新打开工作簿，但仍然会这样做而无需通过“BeforeClose”事件处理程序调用。

所以重新表述这个问题：

*   无论如何使用VBA来检测和拦截以这种方式重新打开的工作簿？

**更新 2**

接受 BKimmel 的回答 - 似乎没有 VBA 方法可以从工作簿中拦截此事件。

我将实施的解决方案是将应用程序代码移动到 XLA 加载项中，该加载项会在加载工作簿时自动加载（如果尚未加载）。加载项可以处理 Open 和 BeforeClose 事件，并存储进行清理所需的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T16:55:04.530

您可以使用一些特殊的应用程序事件来处理重新打开工作簿并手动触发 Workbook_Close 代码：

使用以下代码创建一个名为 ApplicationController 的类模块：

```
Public WithEvents CApp As Application
Public CurrentWB as Workbook

Private Sub CApp_WorkbookOpen(ByVal wb As Excel.Workbook)

Dim sPathName As String
sPathName = wb.Name
if sPathName = CurrentWB.Name then CallSomeMethod()

End Sub 
```

然后在您的 workbook_load 事件上执行以下操作：

```
Public controller as new ApplicationController
Private Sub Workbook_Open()
set controller.CApp = Excel.Application
set controller.CurrentWB = ThisWorkbook
End Sub 
```

现在，当 excel 打开一个新工作簿时，您将捕获该事件并运行您的安全方法。如果您愿意，您甚至可以阻止它重新打开工作簿。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T22:36:30.957

伙计……这*似乎*很容易，但这是一个艰难的过程。我玩弄了我在使用 Excel VBA 的 7 年左右的经验中能想到的每一个事件和应用程序/工作簿属性，但我根本想不出任何优雅的东西......我认为简短的答案是这个问题并没有真正简短的优雅解决方案（如果有，我真的很想看看）。这就是坏消息。

好消息是，我认为有*一些*方法可以解决这个问题……1 更优雅一点，但需要你重新考虑一些方法，而另一种方法很脏，但可能更简单一些。

**更优雅的方式**将涉及重新思考和重构您的方法...我认为我在工作中从未遇到过这个问题的原因是，在我的每个方法结束时，工作簿都处于“良好”状态...或换句话说，如果有“清理”要做，那么它会在每个方法结束时完成。如果这会对性能造成巨大的开销，您可能会考虑设置一个布尔标志并限制它是否在每个其他方法的末尾运行。（即 runCleanup = ReturnTrueIfCleanupIsNeeded() If (runCleanup = true) Then CleanupMethod() End If)

**更肮脏的方法**是将整个工作簿本身变成一种“临时互斥体”
*****temp ) WorkBook 并在****temp**上使用“SaveAs”方法将其放置在单独的位置。
2）存储（**原始**）路径。
3) 将代码添加到检查 ( **temp** ) 的 WorkBook 打开事件和 A) 立即关闭并激活**temp或 B) 用 (** **temp** ) 覆盖自身，然后使用 SaveAs
4) 在用户保存 WorkBook 之前捕获事件并将其保存到原始*位置***和**临时**位置**。
5) 在 WorkBookClose 事件中，运行您需要的任何清理并将**临时**保存回其原始位置。

所有这一切的重点是避开两次打开工作簿时发生的“冲突” - 本质上，通过在第一次打开它时创建一个**临时**工作簿并将其保存在不同的位置（也许你甚至可以隐藏文件？）您确保当用户单击原始文件时，它不会与他们已经在应用程序中使用的数据发生冲突。（当然，这有它自己的问题/问题，例如“如果我不知道用户可以访问哪些路径来保存临时文件怎么办”或“如果用户打开*临时*XLS 文件怎么办......但这就是为什么我称之为*肮脏*的方式）”

我知道这很多，特别是如果您不习惯使用 VBA；如果您希望我发布一些代码来帮助您完成任何这些步骤，请发表评论，我会的。

感谢您提出有趣的问题。***

 **** * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-09T11:21:40.897

您还可以通过以下方式抑制提示：

这将在没有警告的情况下重新打开一个打开的文件。但请注意，任何更改都将被丢弃！

```
Application.DisplayAlerts = False
Workbooks.Open (sPath)
Application.DisplayAlerts = True 
```

来自[Excel 论坛](https://www.excelforum.com/excel-programming-vba-macros/351901-skipping-reopen-file-prompt-box-using-vba.html "excel论坛")

该解决方案满足我的需求

# c# - 您使用哪些适用于 C# 的 ReSharper 4+ 实时模板？

> ID：186970
> 
> 赞同：94
> 
> 时间：2008-10-09T12:07:43.097
> 
> 标签：c#, templates, refactoring, resharper

您使用哪些适用于**C#**的 ReSharper 4.0 模板？

让我们以以下格式分享这些内容：

* * *

## [标题]

*可选描述*

**快捷方式：**快捷方式
**适用于：** [AvailabilitySetting]

```
// Resharper template code snippet
// comes here 
```

**宏属性**（如果存在）：

*   **Macro1** - 值 - EditableOccurence
*   **Macro2** - 值 - EditableOccurence

* * *

*   请每个答案一个宏！
*   以下是[NUnit 测试夹具](https://stackoverflow.com/questions/186970/what-resharper-40-templates-for-c-do-you-use#186978)和[独立 NUnit 测试用例](https://stackoverflow.com/questions/186970/what-resharper-40-templates-for-c-do-you-use#186978)的一些示例，它们以建议的格式描述了实时模板。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-02-15T07:45:49.033

## 简单的 Lambda

如此简单，如此有用 - 一个小 lambda：

**快捷方式**：x

**可用**：允许表达式的 C#。

```
x => x.$END$ 
```

宏：无。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-09T15:33:46.693

## 实施“处置（布尔）”方法

*实现[Joe Duffy 的 Dispose 模式](http://www.bluebytesoftware.com/blog/2005/04/08/DGUpdateDisposeFinalizationAndResourceManagement.aspx)*

**捷径：**处置

**适用于：**允许类型成员声明的 C# 2.0+ 文件

```
public void Dispose()
{
    Dispose(true);
    System.GC.SuppressFinalize(this);
}

protected virtual void Dispose(bool disposing)
{
    if (!disposed)
    {
        if (disposing)
        {
            if ($MEMBER$ != null)
            {
                $MEMBER$.Dispose();
                $MEMBER$ = null;
            }
        }

        disposed = true;
    }
}

~$CLASS$()
{
    Dispose(false);
}

private bool disposed; 
```

**宏属性**：

*   **成员**- 建议 System.IDisposable 的变量 - 可编辑的出现 #1
*   **CLASS** - 包含类型名称

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-09T12:09:05.437

## 为某种类型创建新的单元测试夹具

**快捷方式：** ntf 适用
**于：**允许类型成员声明或命名空间声明的 C# 2.0+ 文件

```
[NUnit.Framework.TestFixtureAttribute]
public sealed class $TypeToTest$Tests
{
    [NUnit.Framework.TestAttribute]
    public void $Test$()
    {
        var t = new $TypeToTest$()
        $END$
    }
} 
```

**宏：**

*   **TypeToTest** - 无 - #2
*   **测试**- 无 - V

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-02-15T18:51:45.930

## 检查字符串是否为空或空。

*如果您使用的是 .Net 4，您可能更喜欢使用 string.IsNullOrWhiteSpace()。*

**快捷键**：sne

**适用于**：允许表达式的 C# 2.0+。

```
string.IsNullOrEmpty($VAR$) 
```

**宏属性**：

*   VAR - 建议一个字符串类型的变量。可编辑 = 真。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-09T12:10:12.423

## 创建新的独立单元测试用例

**快捷方式：** ntc 适用
**于：**允许类型成员声明的 C# 2.0+ 文件

```
[NUnit.Framework.TestAttribute]
public void $Test$()
{
    $END$
} 
```

**宏：**

*   **测试**- 无 - V

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-15T23:23:04.760

为当前类型声明一个 log4net 记录器。

**快捷方式：**日志

**适用于：**允许类型成员声明的 C# 2.0+ 文件

```
private static readonly log4net.ILog log = log4net.LogManager.GetLogger(typeof($TYPE$)); 
```

**宏属性**：

*   **TYPE** - 包含类型名称

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-08-27T22:08:42.080

## MS 测试单元测试

*使用 AAA 语法和[单元测试艺术中的命名约定的新 MS 测试单元测试](http://www.manning.com/osherove/)*

**快捷方式：**测试（或 tst，或任何您想要的）
**可用于：**允许类型成员声明的 C# 2.0+ 文件

```
[TestMethod]
public void $MethodName$_$StateUnderTest$_$ExpectedBehavior$()
{
    // Arrange
    $END$

    // Act

    // Assert

} 
```

**宏属性**（如果存在）：

*   **MethodName** - 被测方法的名称
*   **StateUnderTest** - 您尝试测试的状态
*   **ExpectedBehavior** - 您期望发生的事情

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-09-30T15:50:54.003

## 检查变量是否为空

**快捷方式：** ifn 适用
**于：** C# 2.0+ 文件

```
if (null == $var$)
{
    $END$
} 
```

## 检查变量是否不为空

**快捷方式：** ifnn 适用
**于：** C# 2.0+ 文件

```
if (null != $var$)
{
    $END$
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-12-02T09:49:46.913

**断言.AreEqual**

*将断言添加到单元测试的简单模板*

**快捷方式**：ae
**可用于**：在允许语句的 C# 2.0+ 文件中

```
Assert.AreEqual($expected$, $actual$);$END$ 
```

流畅版：

```
Assert.That($expected$, Is.EqualTo($actual$));$END$ 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2011-01-25T07:16:20.043

## 为类构造函数编写符合 StyleCop 的摘要

*（如果您厌倦了不断为每个构造函数输入长标准摘要，因此它符合 StyleCop 规则 SA1642）*

**快捷方式：** csum

**适用于：** C# 2.0+

```
Initializes a new instance of the <see cref="$classname$"/> class.$END$ 
```

**宏：**

*   **类**名 - 包含类型名称 - V

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2011-02-16T16:24:26.287

## 大量的 Lambda

使用不同的变量声明创建一个 lambda 表达式，以便于嵌套。

**快捷键：** la、lb、lc

**适用于：**允许表达式或查询子句的 C# 3.0+ 文件

*la*定义为：

```
x => x.$END$ 
```

*lb*定义为：

```
y => y.$END$ 
```

*lc*定义为：

```
z => z.$END$ 
```

这类似于上面的 Sean Kearon，除了我定义了多个 lambda 实时模板以便于 lambda 嵌套。“ *la* ” 是最常用的，但在处理这样的表达式时，其他的也很有用：

```
items.ForEach(x => x.Children.ForEach(y => Console.WriteLine(y.Name))); 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2011-04-18T07:32:24.287

**依赖属性生成**

*生成依赖属性*

**快捷方式：** dp适用
**于：**允许成员声明的 C# 3.0

```
public static readonly System.Windows.DependencyProperty $PropertyName$Property =
        System.Windows.DependencyProperty.Register("$PropertyName$",
                                                   typeof ($PropertyType$),
                                                   typeof ($OwnerType$));

    public $PropertyType$ $PropertyName$
    {
        get { return ($PropertyType$) GetValue($PropertyName$Property); }
        set { SetValue($PropertyName$Property, value); }
    }

$END$ 
```

宏属性（如果存在）：

PropertyName - 无宏 - #3
PropertyType - 此时需要猜测类型 - #2
OwnerType - 包含类型名称 - 不可编辑出现

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-02-16T16:26:39.607

## 等它...

在控制台应用程序结束之前暂停用户输入。

**快捷键：**暂停

**适用于：**允许使用语句的 C# 2.0+ 文件

```
System.Console.WriteLine("Press <ENTER> to exit...");
System.Console.ReadLine();$END$ 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-03-12T17:22:26.440

## 快速 ExpectedException 快捷方式

只是添加到我的单元测试属性的快捷方式。

**快捷方式**：ee

**适用于**：适用于：允许类型成员声明的 C# 2.0+ 文件

```
[ExpectedException(typeof($TYPE$))] 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2011-02-15T19:24:50.677

## 通知属性已更改

*这是我最喜欢的，因为我经常使用它，它为我做了很多工作。*

**捷径**：NPC

**适用于**：允许表达式的 C# 2.0+。

```
if (value != _$LOWEREDMEMBER$)
{
  _$LOWEREDMEMBER$ = value;
  NotifyPropertyChanged("$MEMBER$");
} 
```

**宏**：

*   MEMBER - 包含成员类型名称。不可编辑。*注意：确保这个是列表中的第一个。*
*   LOWEREDMEMBER - MEMBER 的值，第一个字符小写。不可编辑。

**用法**：在这样的属性设置器中：

```
private string _dateOfBirth;
public string DateOfBirth
{
   get { return _dateOfBirth; }
   set
   {
      npc<--tab from here
   }
} 
```

它假定您的支持变量以“_”开头。用你使用的任何东西替换它。它还假设您有一个类似这样的属性更改方法：

```
private void NotifyPropertyChanged(String info)
{
   if (PropertyChanged != null)
   {
      PropertyChanged(this, new PropertyChangedEventArgs(info));
   }
} 
```

实际上，我使用的这个版本是基于 lambda 的（因为我喜欢我的 lambdas！）并产生以下内容。原理与上述相同。

```
public decimal CircuitConductorLive
{
   get { return _circuitConductorLive; }
   set { Set(x => x.CircuitConductorLive, ref _circuitConductorLive, value); }
} 
```

那时我没有使用极其优雅和有用[的 PostSharp 来毫不费力地完成整个 INotifyPropertyChanged 的​​事情](http://www.sharpcrafters.com/solutions/ui#data-binding)，也就是说。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2011-04-04T19:36:47.490

## AutoMapper 属性映射

**快捷键：** fm

**适用于：**允许使用语句的 C# 2.0+ 文件

```
.ForMember(d => d$property$, o => o.MapFrom(s => s$src_property$))
$END$ 
```

**宏：**

*   属性 - 可编辑的出现
*   src_property - 可编辑的出现

**笔记：**

我将 lambda“点”关闭，以便可以点击 . 立即获得属性智能感知。需要 AutoMapper ( [http://automapper.codeplex.com/](http://automapper.codeplex.com/) )。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2008-10-10T15:31:36.870

## 为 NUnit 创建测试用例存根

*这可以作为单元测试运行器中出现的提醒（实现或测试的功能）（与任何其他被忽略的测试一样），*

**快捷方式：** nts适用
**于：**允许类型成员声明的 C# 2.0+ 文件

```
[Test, Ignore]
public void $TestName$()
{
    throw new NotImplementedException();
}
$END$ 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-03-04T09:21:55.020

# 需要时调用

在开发 WinForms 应用程序时很有用，其中方法应该可以从非 UI 线程调用，然后该方法应该将调用编组到 UI 线程。

**快捷方式**：inv

**适用于**：允许 C# 3.0+ 文件语句

```
if (InvokeRequired)
{
    Invoke((System.Action)delegate { $METHOD_NAME$($END$); });
    return;
} 
```

**宏**

*   **METHOD_NAME** - 包含类型成员名称

* * *

您通常会将此模板用作给定方法中的第一条语句，结果类似于：

```
void DoSomething(Type1 arg1)
{
    if (InvokeRequired)
    {
        Invoke((Action)delegate { DoSomething(arg1); });
        return;
    }

    // Rest of method will only execute on the correct thread
    // ...
} 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-03-12T17:09:40.107

## MSTest 测试方法

这有点蹩脚，但它很有用。希望有人能从中获得一些效用。

快捷方式：测试方法

适用于：C# 2.0

```
[TestMethod]
public void $TestName$()
{
    throw new NotImplementedException();

    //Arrange.

    //Act.

    //Assert.
}

$END$ 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2010-09-16T17:22:27.553

## 新的 C# 指南

*生成初始化为新生成的 guid 值的新 System.Guid 实例*

**快捷方式：** csguid 适用 **于：**在 C# 2.0+ 文件中

```
new System.Guid("$GUID$") 
```

**宏属性**：

*   **GUID** - 新 GUID - 错误

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2009-09-29T15:32:58.813

## NUnit 设置方法

**快捷方式：** setup适用
**于：**适用于：允许类型成员声明的 C# 2.0+ 文件

```
[NUnit.Framework.SetUp]
public void SetUp()
{
    $END$
} 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2009-09-29T15:37:28.943

## NUnit 拆解方法

**快捷方式：** teardown 适用
**于：**适用于：允许类型成员声明的 C# 2.0+ 文件

```
[NUnit.Framework.TearDown]
public void TearDown()
{
    $END$
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-03-04T09:09:06.627

# 不需要断言调用

在开发 WinForms 应用程序时很有用，您希望确保代码在给定项目的正确线程上执行。请注意，`Control`实现`ISynchronizeInvoke`.

**捷径**：ani

**适用于**：允许 C# 2.0+ 文件语句

```
Debug.Assert(!$SYNC_INVOKE$.InvokeRequired, "InvokeRequired"); 
```

**宏**

*   **SYNC_INVOKE** - 建议变量`System.ComponentModel.ISynchronizeInvoke`

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2008-10-22T18:31:23.180

## 创建健全性检查以确保参数永远不会为空

**快捷方式：** eann 适用
**于：**允许类型语句的 C# 2.0+ 文件

```
Enforce.ArgumentNotNull($inner$, "$inner$"); 
```

**宏：**

*   **内部**- 建议参数 - #1

**备注：** *虽然此代码段针对开源 .NET [Lokad.Shared](http://rabdullin.com/projects/lokad-shared/)库，但它可以轻松适应任何其他类型的参数检查。*

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2009-02-02T16:25:11.340

# 新的 COM 类

**快捷方式**：comclass

**适用于**：允许类型成员声明或命名空间声明的 C# 2.0+ 文件

```
[ComVisible(true)]
[ClassInterface(ClassInterfaceType.None)]
[Guid("$GUID$")]
public class $NAME$ : $INTERFACE$
{
    $END$
} 
```

**宏**

*   **GUID** - 新的 GUID
*   **名称**- 可编辑
*   **界面**- 可编辑

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2008-11-03T16:10:58.360

## Trace - Writeline，带格式

使用格式化字符串添加跟踪的非常简单的模板（如 Debug.WriteLine 已经支持）。

**快捷方式：** twlf
**可用于：**允许语句的 C# 2.0+ 文件

```
Trace.WriteLine(string.Format("$MASK$",$ARGUMENT$)); 
```

**宏属性：**

*   **参数**- `value`- EditableOccurence
*   **蒙版**- `"{0}"`- EditableOccurence

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-02-16T16:36:13.033

## 使方法虚拟

添加虚拟关键字。在使用 NHibernate、EF 或类似的框架时特别有用，其中方法和/或属性必须是虚拟的以启用延迟加载或代理。

**快捷方式：** v

**适用于：**允许类型成员声明的 C# 2.0+ 文件

```
virtual $END$ 
```

这里的技巧是 virtual 之后的空间，这在上面可能很难看到。实际模板是启用了重新格式化代码的“虚拟 $END$”。这允许您转到下面的插入点（用 | 表示）并输入 v：

```
public |string Name { get; set; } 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2012-02-10T23:38:04.247

## 等于

*一般的 .NET 和默认的“equals”模板都不能轻易地敲出一个好的、简单的 Equals 方法。虽然关于如何编写一个好的 Equals 方法有很多想法，但我认为以下内容足以满足 90%[的](https://stackoverflow.com/questions/2509965/writing-a-good-c-sharp-equals-method) [简单](http://msdn.microsoft.com/en-us/library/336aedhh%28v=vs.100%29.aspx) [案例](https://blogs.msdn.com/b/jaredpar/archive/2009/01/15/if-you-implement-iequatable-t-you-still-must-override-object-s-equals-and-gethashcode.aspx)[。](http://www.infoq.com/articles/Equality-Overloading-DotNET) 对于更复杂的事情——尤其是在继承方面——最好[不要使用 Equals](https://stackoverflow.com/a/2510092/27581)。*

**快捷方式：** equals
**适用于：** C# 2.0+ 类型成员

```
public override sealed bool Equals(object other) {
    return Equals(other as $TYPE$);
}

public bool Equals($TYPE$ other) {
    return !ReferenceEquals(other, null) && $END$;
}

public override int GetHashCode() {
    // *Always* call Equals.
    return 0;
} 
```

**宏属性**：

*   **TYPE** - 包含类型名称 - 不可编辑

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-10-01T11:17:58.133

# **新型 Typemock 隔离器假货**

**快捷方式**：fake
**可用于**：[在允许语句的 c# 2.0 文件中]

$TYPE$ $Name$Fake = Isolate.Fake.Instance();
Isolate.WhenCalled(() => $Name$Fake.)

宏属性：
* $TYPE$ - 建议新变量的类型
* $Name$ -**另一个变量**的值( *Type* )，第一个字符小写

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2010-04-20T17:22:49.340

因为我现在正在使用 Unity，所以我想出了一些让我的生活更轻松的方法：

* * *

## 类型别名

**快捷方式**：ta
**可用于**：*.xml；*.config

```
<typeAlias alias="$ALIAS$" type="$TYPE$,$ASSEMBLY$"/> 
```

* * *

## 类型声明

这是一个没有名字也没有参数的类型

**快捷方式**：tp
**可用于**：*.xml；*.config

```
<type type="$TYPE$" mapTo="$MAPTYPE$"/> 
```

* * *

## 类型声明（带名称）

这是一个有名字但没有参数的类型

**快捷方式**：tn
**可用于**：*.xml；*.config

```
<type type="$TYPE$" mapTo="$MAPTYPE$" name="$NAME$"/> 
```

* * *

## 带有构造函数的类型声明

这是一个有名字但没有参数的类型

**快捷方式**：tpc
**可用于**：*.xml；*.config

```
<type type="$TYPE$" mapTo="$MAPTYPE$">
  <typeConfig>
    <constructor>
        $PARAMS$
    </constructor>
  </typeConfig>
</type> 
```

ETC....

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2010-09-10T08:04:28.747

**log4net XML 配置块**

您可以直接导入模板：

```
<TemplatesExport family="Live Templates">
  <Template uid="49c599bb-a1ec-4def-a2ad-01de05799843" shortcut="log4" description="inserts log4net XML configuration block" text="  &lt;configSections&gt;&#xD;&#xA;    &lt;section name=&quot;log4net&quot; type=&quot;log4net.Config.Log4NetConfigurationSectionHandler,log4net&quot; /&gt;&#xD;&#xA;  &lt;/configSections&gt;&#xD;&#xA;&#xD;&#xA;  &lt;log4net debug=&quot;false&quot;&gt;&#xD;&#xA;    &lt;appender name=&quot;LogFileAppender&quot; type=&quot;log4net.Appender.RollingFileAppender&quot;&gt;&#xD;&#xA;      &lt;param name=&quot;File&quot; value=&quot;logs\\$LogFileName$.log&quot; /&gt;&#xD;&#xA;      &lt;param name=&quot;AppendToFile&quot; value=&quot;false&quot; /&gt;&#xD;&#xA;      &lt;param name=&quot;RollingStyle&quot; value=&quot;Size&quot; /&gt;&#xD;&#xA;      &lt;param name=&quot;MaxSizeRollBackups&quot; value=&quot;5&quot; /&gt;&#xD;&#xA;      &lt;param name=&quot;MaximumFileSize&quot; value=&quot;5000KB&quot; /&gt;&#xD;&#xA;      &lt;param name=&quot;StaticLogFileName&quot; value=&quot;true&quot; /&gt;&#xD;&#xA;&#xD;&#xA;      &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;&#xD;&#xA;        &lt;param name=&quot;ConversionPattern&quot; value=&quot;%date [%3thread] %-5level %-40logger{3} - %message%newline&quot; /&gt;&#xD;&#xA;      &lt;/layout&gt;&#xD;&#xA;    &lt;/appender&gt;&#xD;&#xA;&#xD;&#xA;    &lt;appender name=&quot;ConsoleAppender&quot; type=&quot;log4net.Appender.ConsoleAppender&quot;&gt;&#xD;&#xA;      &lt;layout type=&quot;log4net.Layout.PatternLayout&quot;&gt;&#xD;&#xA;        &lt;param name=&quot;ConversionPattern&quot; value=&quot;%message%newline&quot; /&gt;&#xD;&#xA;      &lt;/layout&gt;&#xD;&#xA;    &lt;/appender&gt;&#xD;&#xA;&#xD;&#xA;    &lt;root&gt;&#xD;&#xA;      &lt;priority value=&quot;DEBUG&quot; /&gt;&#xD;&#xA;      &lt;appender-ref ref=&quot;LogFileAppender&quot; /&gt;&#xD;&#xA;    &lt;/root&gt;&#xD;&#xA;  &lt;/log4net&gt;&#xD;&#xA;" reformat="False" shortenQualifiedReferences="False">
    <Context>
      <FileNameContext mask="*.config" />
    </Context>
    <Categories />
    <Variables>
      <Variable name="LogFileName" expression="getOutputName()" initialRange="0" />
    </Variables>
    <CustomProperties />
  </Template>
</TemplatesExport> 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2011-04-04T16:47:24.720

## Machine.Specifications - 因为

作为一个重度 mspec 用户，我有几个专门用于 MSpec 的实时模板。这是一个快速设置因为并捕获错误的方法。

**快捷方式：** bece 适用
**于：**允许类型成员声明或命名空间声明的 C# 2.0+ 文件

**bece - 因为（异常捕获）**

```
Protected static Exception exception;
Because of = () => exception = Catch.Exception(() => $something$);
$END$ 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2010-08-27T21:54:37.807

借鉴 Drew Noakes 的绝妙想法，这里是 Silverlight 的调用实现。

**捷径：dca**

**适用于：C# 3.0 文件**

```
if (!Dispatcher.CheckAccess())
{
    Dispatcher.BeginInvoke((Action)delegate { $METHOD_NAME$(sender, e); });
    return;
}

$END$ 
```

**宏**

*   `$METHOD_NAME$`当前包含方法的不可编辑名称。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2010-03-16T05:57:39.663

## Rhino 模拟记录回放语法

**快捷方式**：RhinoMocksRecordPlaybackSyntax *

**适用于：** C# 2.0+ 文件

**注意：**此代码片段依赖于`var mocks = new new MockRepository();`已在其他地方声明和初始化的 MockRepository ()。

```
using (mocks.Record())
{
    $END$
}

using (mocks.Playback())
{

} 
```

* 快捷方式名称可能看起来有点长，但输入时智能感知不是问题。Rhino Mocks 也有其他代码片段，因此完全限定名称可以更容易地在视觉上将它们组合在一起

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2011-07-06T10:50:21.250

## Machine.Specifications - 它

**捷径：**它

**适用于：**允许类型成员声明或命名空间声明的 C# 2.0+ 文件

```
Machine.Specifications.It $should_$ =
    () => 
    {

    }; 
```

**宏属性**（如果存在）：

*   **should_** - （无宏） - EditableOccurence

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2010-04-13T06:57:41.833

## Rhino 模拟 Expect 方法

**快捷方式**：RhinoMocksExpectMethod

**适用于：** C# 2.0+ 文件

```
Expect.Call($EXPECT_CODE$).Return($RETURN_VALUE$); 
```

**快捷方式**：RhinoMocksExpectVoidMethod

**适用于：** C# 2.0+ 文件

```
Expect.Call(delegate { $EXPECT_CODE$; }); 
```******************