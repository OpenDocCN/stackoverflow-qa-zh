# StackOverflow 问答 10319000-10319999

# mysql - 即使没有添加记录，INSERT IGNORE 也会增加自动增量计数器？

> ID：10319003
> 
> 赞同：3
> 
> 时间：2012-04-25T15:40:11.797
> 
> 标签：mysql, sql, insert, auto-increment

在**MySQL**中，我使用`INSERT IGNORE`语句向表中插入行。因为一列是`UNIQUE`，所以没有插入一些行（因为它们已经存在）。执行该语句后，我注意到自动增量列在行之间缺少一些数字，后来我意识到这是由于行被忽略且未添加而发生的。

如果没有插入带有子句的行，是否可以将系统设置为不增加**自动增量计数器？**`IGNORE`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:20:08.057

引用[INSERT 的手册页](http://dev.mysql.com/doc/refman/5.5/en/insert.html)：

> 如果使用 IGNORE 关键字，则执行 INSERT 语句时发生的错误将被视为警告。例如，如果没有 IGNORE，复制表中现有 UNIQUE 索引或 PRIMARY KEY 值的行会导致重复键错误并且语句被中止。使用 IGNORE，行仍然没有插入，但不会发出错误。

该`INSERT IGNORE`语法只是一种抑制某些错误消息的方法，当您意识到这些错误可能发生和/或希望在稍后阶段处理它们时，它会很有帮助。在幕后，你仍然有一个常规的插入，除了它由于违反键而失败。MySQL 需要实际的行值来进行插入，并且 AUTO_INCREMENT 计数器将根据[常规规则](http://dev.mysql.com/doc/refman/5.5/en/example-auto-increment.html)递增：

1.  该列的值为 NULL。
2.  未设置列的值。
3.  该列的值大于计数器。

因此，除非您可以重新考虑您的逻辑（例如，在进行插入之前测试键值是否存在），否则*重置*计数器的唯一方法是[ALTER TABLE](http://dev.mysql.com/doc/refman/5.5/en/alter-table.html)：

```
ALTER TABLE t2 AUTO_INCREMENT = value; 
```

# php - 如何将其放入变量中？

> ID：10319008
> 
> 赞同：-1
> 
> 时间：2012-04-25T15:40:36.633
> 
> 标签：php, variables, loops, while-loop

```
$now = time();
while(file_exists($uploadFilename = $uploadsDirectory.$now.'-'.$_FILES[$fieldname]        
['name']))
 {
$now++;
 } 
```

有人知道如何将其放入变量中，以便我可以将结果插入数据库吗？

编辑：

对不起，要清楚一点：

我需要从这个while循环生成的图像文件名到一个变量中，这样我就可以将它插入到数据库中。

例如，如果我要上传一个名为“mypic.png”的文件，它将变为：

1335367953-mypic。

这是我在变量中需要的字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:01:56.190

尝试：

```
basename($uploadFilename); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T15:57:56.573

您已经在变量中拥有文件名，`$uploadFilename`.

**澄清后编辑**

您可以创建一个变量来仅保存文件名，然后在检查它时包含 $uploadsDirectory。

```
$now = time();
$filename = $now.'-'.$_FILES[$fieldname]        
['name'])
while(file_exists($uploadFilename = $uploadsDirectory . $filename))
 {
    $now++;
    $filename = $now.'-'.$_FILES[$fieldname]        
 } 
```

# c++ - unique_ptr 用于数组专业化的 lambda 自定义删除器

> ID：10319009
> 
> 赞同：34
> 
> 时间：2012-04-25T15:40:38.083
> 
> 标签：c++, lambda, c++11, smart-pointers, unique-ptr

我最近开始将大量现有的 C++ 应用程序代码移植到 C++11，现在我正在转换为新的智能指针**std::unique_ptr**和**std::shared_ptr**，我有一个关于自定义删除器的具体问题。我想添加一个 lambda 记录器来查看我的删除被调用的位置，但我无法获得要编译的数组专业化版本。建议将不胜感激。

我一直在徒劳地寻找用于**VC++10**或**GCC 4.5.2+的数组专业化****unique_ptr**的自定义删除器的示例。我想在 lambda 中调用删除器时打印一条日志消息 - 主要是为了确保我认为超出范围的所有指针都在这样做。这对于专业化的数组版本是否可行？我可以让它与非数组版本一起工作，如果我将外部结构“MyArrayDeleter”作为第二个参数传递，我也可以让它与数组专业化一起工作。还有一件事，是否可以删除丑陋的**std::function**，因为我认为我可以让 lambda 签名解决这个问题。

 ******```
struct MySimpleDeleter {
    void operator()(int* ptr) const {
        printf("Deleting int pointer!\n");
        delete ptr;
    }
};
struct MyArrayDeleter {
    void operator()(int* ptr) const {
        printf("Deleting Array[]!\n");
        delete [] ptr;
    }
};
{
    // example 1 - calls MySimpleDeleter where delete simple pointer is called
    std::unique_ptr<int, MySimpleDeleter> ptr1(new int(5));

    // example 2 - correctly calls MyArrayDeleter where delete[] is called
    std::unique_ptr<int[], MyArrayDeleter> ptr2(new int[5]);

    // example 3 - this works (but default_delete<int[]> would have been passed
    // even if I did not specialize it as it is the default second arg
    // I only show it here to highlight the problem I am trying to solve
    std::unique_ptr<int[], std::default_delete<int[]>> ptr2(new int[100]);

    // example 3 - this lambda is called correctly - I want to do this for arrays
    std::unique_ptr<int, std::function<void (int *)>> ptr3(
        new int(3), [&](int *ptr){ 
            delete ptr; std::cout << "delete int* called" << std::endl; 
        });

    // example 4 - I cannot get the following like to compile
    // PLEASE HELP HERE - I cannot get this to compile
    std::unique_ptr<int[], std::function<void (int *)>> ptr4(
        new int[4], [&](int *ptr){  
            delete []ptr; std::cout << "delete [] called" << std::endl; 
        });
}

The compiler error is as follows:

The error from the compiler (which complains about the new int[4] for ptr4 below is:
'std::unique_ptr<_Ty,_Dx>::unique_ptr' : cannot access private member declared in class 'std::unique_ptr<_Ty,_Dx>'
1>          with
1>          [
1>              _Ty=int [],
1>              _Dx=std::tr1::function<void (int *)>
1>          ]
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\memory(2513) : see declaration of 'std::unique_ptr<_Ty,_Dx>::unique_ptr'
1>          with
1>          [
1>              _Ty=int [],
1>              _Dx=std::tr1::function<void (int *)>
1>          ] 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-26T14:23:33.973

关于什么：

```
auto deleter=[&](int* ptr){...};
std::unique_ptr<int[], decltype(deleter)> ptr4(new int[4], deleter); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-09T03:13:27.207

首先，我使用带有 SP1 的 VC2010，Mingw g++ 4.7.1

对于新数组，unique_ptr 已经以干净的方式支持它：

```
struct X
{
    X()   { puts("ctor"); }
   ~X()   { puts("dtor"); }
};

unique_ptr<X[]>  xp(new X[3]); 
```

输出是：

```
ctor
ctor
ctor
dtor
dtor
dtor 
```

不幸的是，对于自定义删除器，VC2010 和 g++ 不一致：

VC2010：

```
 unique_ptr<FILE, function<void (FILE*)> > fp(fopen("tmp.txt", "w"), [](FILE *fp){
    puts("close file now");
    fclose(fp);
  }); 
```

克++：

```
 unique_ptr<FILE, void (*)(FILE*) > fp(fopen("tmp.txt", "w"), [](FILE *fp){
    puts("close file now");
    fclose(fp);
  }); 
```

Managu 的方法非常好，因为 inline lambda 很酷，但恕我直言，这会损害可读性。它还强调在获取之前释放资源（RAII）。

在这里，我建议使用声明式方法来分离资源获取和释放（Scope Guard，适用于 VC2010 和 g++ 4.7.1）：

```
template<typename T>
struct ScopeGuard
{
    T deleter_;
    ScopeGuard( T deleter) : deleter_(deleter) {}
    ~ScopeGuard() { deleter_() ; }
};
#define UNI_NAME(name, line) name ## line
#define ON_OUT_OF_SCOPE_2(lambda_body, line) auto UNI_NAME(deleter_lambda_, line) = [&]() {    lambda_body; } ; \
       ScopeGuard<decltype(UNI_NAME(deleter_lambda_, line))> \
       UNI_NAME(scope_guard_, line)  ( UNI_NAME(deleter_lambda_, line ));
#define ON_OUT_OF_SCOPE(lambda_body) ON_OUT_OF_SCOPE_2(lambda_body, __LINE__)

FILE * fp = fopen("tmp.txt", "w");
ON_OUT_OF_SCOPE( { puts("close file now"); fclose(fp); } ); 
```

关键是您可以以旧的、清晰的方式获取资源，并在资源获取行之后立即声明释放资源的语句。

缺点是您不能将单个对象连同它的删除器一起转发。

对于 FILE *，shared_ptr 可以作为替代指针用于相同的目的（可能有点重量级，但适用于 VC2010 和 g++）

shared_ptr fp2 ( fopen("tmp.txt", "w"), [](FILE * fp) { fclose(fp); puts("关闭文件"); });******

# iphone - 如何使用 OAUTH 使用 500PX API 登录用户

> ID：10319010
> 
> 赞同：2
> 
> 时间：2012-04-25T15:40:38.880
> 
> 标签：iphone, oauth

我正在尝试通过 500 PX API 登录用户，

[http://developers.500px.com/docs/oauth-request](http://developers.500px.com/docs/oauth-request)

似乎这样做的唯一方法是通过 web 视图，让用户进行身份验证，一旦他们登录到 500px，他们将使用访问令牌重新路由回我的应用程序。

如果没有网络视图，我怎么能做到这一点？我希望实现 2 个文本字段，一个用于用户名，一个用于密码，然后登录用户。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-04T07:25:35.373

OAuth 模式背后的整个前提是，用户的用户名和密码永远不应信任第三方开发人员。相反，它们被重定向到用户知道并信任的服务登录门户，在那里他们输入用户名和密码，向不受信任的第三方应用程序授予权限，然后使用授权密钥和秘密被重定向回不受信任的应用程序，然后第三方应用程序可以使用它来代表用户访问服务。

用户习惯了这种模式，他们信任它。通过打破这种模式，你打破了惯例，精通网络的用户不太可能使用你的应用程序。

# javascript - 如何在 JS 中禁用指针使用？

> ID：10319012
> 
> 赞同：0
> 
> 时间：2012-04-25T15:40:43.433
> 
> 标签：javascript, json, pointers, reference

为什么是结果`{"a":"b","c":1}`？

```
var foo = {"a":"b","c":0};
var bar = foo;
bar.c++;
alert(JSON.stringify(foo)); 
```

如何禁用此行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T15:42:38.753

Both `foo` and `bar` variables reference the same object. It doesn't matter which reference you use to modify that object.

You cannot *disable* that behaviour, this is how JavaScript and many other major languages work. All you can do is to clone the object explicitly.

```
var foo = {"a":"b","c":0};
var bar = {"a":foo.a, "c": foo.c};
bar.c++; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T15:43:26.230

首先，Javascript 不传递指针，它传递引用，略有不同。其次，不幸~~的是，~~**没有办法修改 Javascript 的默认行为**。

 ~~您可能想要做的是创建一个构造函数并使用它来创建一个对象的两个相似但独立的实例。

```
function Foo(a, b) {
    this.a = a;
    this.b = b;
}

var bar1 = new Foo(0, 0);
var bar2 = new Foo(0, 0);
bar2.b++;

console.log(bar1);
console.log(bar2);

>> {a:0, b:0};
>> {a:0, b:1}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T15:47:30.457

您正在做的是对对象进行第二次引用，但您似乎想要的是该对象的*副本*。

如果你想要那个功能，那么你真的想要一个复制函数，将所有属性一个一个地复制到一个新对象中：

```
// Take all the properties of 'obj' and copy them to a new object,
// then return that object
function copy(obj) {
  var a = {};
  for (var x in obj) a[x] = obj[x];
  return a;
}

var foo = {"a":"b","c":0};
var bar = copy(foo);
bar.c++;
alert(JSON.stringify(foo)); 
```

你会得到`{"a":"b","c":0}`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T15:42:43.920

**您不能禁用 javascript 的工作方式。**

如果更改引用对象，它会影响所有对象引用...~~

# php - PHP电子邮件表格格式在代码中不起作用

> ID：10319013
> 
> 赞同：0
> 
> 时间：2012-04-25T15:40:50.943
> 
> 标签：php, email, background, html-table

我试图弄清楚如何通过 php 电子邮件将属性应用于我的表。我无法让背景和行跨度工作。想不通。

```
$to = 'XXXXX';
$subject = 'New Homeless Connection';
$msg = "<html>
<head>
<title>New Homeless Connection</title>
</head>

<body>

<table cellspacing=\"0\" cellpadding=\"10\" border=\"1\" align=\"left\">
<tr>
<td align=\"left\" width=\"150px\" background=\"#EEEEEE\">Registery No.:</td>
<td align=\"left\"> $reg</td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">First Name:</td>
<td align=\"left\">$first_name </td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">Connection Date:</td>
<td align=\"left\"$>$connect_date</td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">Probability:</td>
<td align=\"left\"$>$prob</td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">Volunteer Name:</td>
<td align=\"left\"$><strong>$hv_name</strong></td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">Volunteer Phone:</td>
<td align=\"left\"$><strong>$hv_phone</strong></td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">Consent Form:</td>
<td align=\"left\"$>$consent</td>
</tr>
<tr>
<td align=\"left\" background=\"#eee\">Field Count:</td>
<td align=\"left\"$>$reg_count</td>
</tr>
<tr>
<td align=\"left\" rowspan=\"2\">http://wwww.41q.org/admin/</td>
</tr>
</table>

</body>
</html>
"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:47:54.317

关于表的一些事情：

*   您不使用“px”来定义宽度/高度。应该只是`width="150"`
*   背景属性应该是bgcolor，它不使用`#`. 刚设置`bgcolor="eeeeee"`
*   为什么你有`$`这样的？`<td align=\"left\"$>`. 那些不应该在那里。

rowspan 没问题，但它什么也没做，因为它下面没有行。我不确定您要对行跨度做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T15:50:50.397

`rowspan`应该是`colspan`，因为除了最后一行（其单元格需要跨越两列）之外，您的表格一直向下有两列。

另外，`background`应该是`bgcolor`。

我在这里发布了一个替换示例：http: [//jsfiddle.net/8ymMh/4/](http://jsfiddle.net/8ymMh/4/) 网格线显示了跨越两列的最后一个单元格，并且背景颜色通过 OK。

我坦率地承认已经采纳了 AndrewR 的建议，即从颜色名称 ( `eeeeee`) 前面删除散列，所以这一切都归功于他。

# asp.net - 在 RowCommand 上调用 RangeValidator

> ID：10319015
> 
> 赞同：0
> 
> 时间：2012-04-25T15:40:57.333
> 
> 标签：asp.net

我已将范围验证器添加到我的 gridview 的 editItemTemplate 中的文本框中。

现在，我在网上找到的所有示例都已提交页面以使验证器启动，我不希望这样，我希望能够从调用来更新行的 rowCommand 事件中调用。有没有办法将 RangeValidator 链接到提交的按钮？我可以以编程方式调用吗？

谢谢

编辑：

我确实找到了以下内容，但似乎完全被忽略了：

```
GridViewRow EditRow = (GridViewRow)((Control)e.CommandSource).NamingContainer;

RangeValidator test = EditRow.FindControl("rvClass") as RangeValidator;

test.MinimumValue = "1";
test.MaximumValue = "255";
test.Type = ValidationDataType.Integer;
test.Validate();

if (!test.IsValid)
{
   test.ErrorMessage = "BOO!";
}                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T15:48:24.957

您可以在 rowCommand 事件内的 RangeValidator 上调用 Validate。

# python - Python (lists) strings are anagrams or not?

> ID：10319023
> 
> 赞同：-9
> 
> 时间：2012-04-25T15:41:16.853
> 
> 标签：python

Write a function that checks whetherb two words are anagrams. Two words are anagrams if they contain the same latters. (Example: silent and listen). The header of the function is : def isAnagram(s1, s2):

(Hint: Obtain two lists for the 2 strings. Sort the lists and check if two lists are identical)

Write a test program that promts the user to enter two stringd and if theyre anagrams, display 'are anagram' otherwise, 'are not anagram'.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:44:02.077

提示准确地告诉您需要做什么。

`list()`函数将帮助您将字符串转换为列表。 [http://docs.python.org/library/functions.html#list](http://docs.python.org/library/functions.html#list)

然后查找列表方法`sort()`。 [http://docs.python.org/tutorial/datastructures.html](http://docs.python.org/tutorial/datastructures.html)

然后查找列表比较。 [http://docs.python.org/tutorial/datastructures.html#comparing-sequences-and-other-types](http://docs.python.org/tutorial/datastructures.html#comparing-sequences-and-other-types)

或者只是查找`sorted()` [http://docs.python.org/library/functions.html#sorted](http://docs.python.org/library/functions.html#sorted)

# c# - 是否可以扩展现有的 TypeConverter？

> ID：10319024
> 
> 赞同：0
> 
> 时间：2012-04-25T15:41:20.860
> 
> 标签：c#, .net, wpf, silverlight, xaml

我在 Silverlight 中做了一个具有`SolidColorBrush`属性的控件。在 XAML 中，您可以将其设置为预先存在的颜色，例如黑色、黄色、白色等。我假设有一个`TypeConverter`接受字符串“黑色”并将其转换为颜色对象并`SolidColorBrush`基于此对象创建新的颜色。我希望保留此功能，但增加了接受十六进制字符串来设置颜色的功能。我需要一个`TypeConverter`，对吗？有没有一种方法可以从当前扩展，以便我仍然可以传递颜色名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T15:45:42.563

XAML 已经接受十六进制。例如：

```
Background="#FF9D661C" 
```

在 XAML 元素上打开 VS 属性窗格有助于指示通过智能不一定明显的可能性（例如，将背景设置为十六进制或渐变画笔）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T15:54:07.827

正如@Ricibob 所说，现有的转换器已经可以按照您的意愿工作。此外，看起来所有内置的 TypeConverters 都是密封的，因此您不能从它们继承（尽管没有什么可以阻止您使用组合来解决问题）。

# javascript - RequireJS - pass parameters into module for initialization

> ID：10319027
> 
> 赞同：13
> 
> 时间：2012-04-25T15:41:42.467
> 
> 标签：javascript, module, requirejs, amd

> **Possible Duplicate:**
> [How to load bootstrapped models in Backbone.js while using AMD (require.js)](https://stackoverflow.com/questions/9916073/how-to-load-bootstrapped-models-in-backbone-js-while-using-amd-require-js)

I am currently creating a RESTful API for one of our projects and also wanted to provide a Javascript library to access it.

Since I like the AMD principle and using require.js, I would provide an AMD module as well. The problem is: the initialization of the module would require some information like the API key on initialization.

How do I pass such parameters into a module upon initalization?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-25T19:11:23.927

如果你有类似的东西：

```
define(['dep1', 'dep2', 'dep3'], function (dep1, dep2, dep3) {

    var module = {
        ...
    };

    return module;

}); 
```

将其更改为：

```
define(['dep1', 'dep2', 'dep3'], function (dep1, dep2, dep3) {
    var module = {
        ...
    };

    var init = function (options) {
        // Initialize here
        return module;

    };

    return init;
}); 
```

然后在某个地方需要你的模块之后，你可以*调用*它来初始化。如果您需要更复杂的东西并返回工厂，您可能还想研究工厂模式。

require.js 不会限制您返回的内容。它可以是一个简单的对象，一个字符串，一个函数......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T18:32:21.327

我认为您正在寻找的是能够设置模块获取的配置变量的能力。这是一个使用 require.js 的示例

[使用 AMD (require.js) 时如何在 Backbone.js 中加载引导模型](https://stackoverflow.com/questions/9916073/how-to-load-bootstrapped-models-in-backbone-js-while-using-amd-require-js/10288587#10288587)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-26T07:30:11.797

我想到的另一种可能性是在您请求模块时使用服务器端脚本来操作模块的源。

例如，当您必须将 API 密钥传递给模块时，您可以执行以下操作：

在进行第一次 define() 调用之前，请输入以下代码：

```
require.config({
    paths: {
        api: 'https://api.example.com/api.amd.js?api_key=f615ac61&'
    }
}); 
```

这使您可以像这样从任何地方简单地要求您的 API：

```
require(['api'], function(api){

}); 
```

因此服务器接收到请求 - 通过 mod_rewrite 将其映射到某个脚本，获取 GET 参数并将其放在模块源代码中的正确位置，然后返回自定义源。

这就是我现在解决这个问题的方法，它就像一个魅力，不需要改变开发人员的任何行为，它利用了已经内置在 requirejs 中的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T16:32:16.407

我不认为你可以使用 require.js 来做到这一点，但你可以使用[Frame.js](https://github.com/bishopZ/Frame.js)或其他一些模块库。在 Frame 中，您会这样做：

```
//moduleName.js

(function(exports){
    exports.moduleName = function(args){
        // do stuff
    }
})(window.exports);

// in main js file

var exports = {}; // global variable

Frame('moduleName.js');
Frame(function(next){
    var myArgs = { ... settings ... };
    exports.moduleName(myArgs);
    next();
});
Frame.init(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T18:16:50.857

是否可以使用命名空间变量，然后在初始化特定库时引用适当的对象？也许我不明白你想要 require.js 做什么，但看起来你无论如何都从你的 main.js 调用它，所以我很确定它会工作......我不认为你可以这样做 `<script = "require.js?apiKey=jsdfhjkfklsjkfdjks">`

```
var libData = {
   apiKey: "jsdfhjkfklsjkfdjks",
   otherpram: "userIDorsomething"
}

require(libData.apiKey); 
```

但是如果您需要在页面的 url 参数中发送 apikey，您可以使用这样的脚本来获取参数：

```
<script>
      function getQueryParams(qs) {
            qs = qs.split("+").join(" ");
            var params = {},
                tokens,
                re = /[?&]?([^=]+)=([^&]*)/g;

            while (tokens = re.exec(qs)) {
                params[decodeURIComponent(tokens[1])]
                    = decodeURIComponent(tokens[2]);
            }

            return params;
        }

// assuming the page is loaded like page.html?apikey=jsdfhjkfklsjkfdjks

     apiKey = getQueryParams(document.location.search).apiKey; 
```

// 但是你必须调用 require，传递 api 密钥？

```
</script> 
```

# php - Select Statement Not Working ("mysql_fetch_array(): supplied argument is not a valid")

> ID：10319032
> 
> 赞同：-1
> 
> 时间：2012-04-25T15:42:11.053
> 
> 标签：php, mysql

Error:

> Warning: mysql_fetch_array(): supplied argument is not a valid MySQL result resource in E:\webareas\ie803\projectx\search.php on line 306

My php code is as follows:

```
 <?php

$car = mysql_real_escape_string($_REQUEST['car']);
$model = mysql_real_escape_string($_REQUEST['model']);
$type = mysql_real_escape_string($_REQUEST['type']);
$colour = mysql_real_escape_string($_REQUEST['colour']);
$year = mysql_real_escape_string($_REQUEST['year']);
$price = mysql_real_escape_string($_REQUEST['price']);

$con = mysql_connect("--","---","---");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db('-----', $con);

$sql = "SELECT * FROM Cars WHERE Make ='$car', Model ='$model', Type ='$type', Colour = '$colour', Year  = '$year', Price = '$price'";
$result=mysql_query($sql, $con);

{
     while($info = mysql_fetch_array($result)){
        echo "<tr>";
        echo "<td>" . $info['Make']. "</td>";
        echo "<td>" . $info['Model']. "</td>";
        echo "<td>" . $info['Type']. "</td>";
        echo "<td>" . $info['Colour']. "</td>";
        echo "<td>" . $info['Year']. "</td>";
        echo "<td>" . $info['Price']. "</td>";

        echo "<br/><br/><td>" . '<hr>' .  "</td>";

}
}
echo "</tr>";
echo "</table>";
?> 
```

line 306 is the while statement. I keep on getting errors after each change I make.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T15:43:25.073

select 语句只是一个字符串，您必须通过 mysql_query 将其输入以获取结果集，通常如下所示：

```
$sql = "SELECT * FROM Cars WHERE Make ='$car', Model ='$model', Type ='$type', Colour = '$colour', Year  = '$year', Price = '$price'";
$result=mysql_query($sql, $con); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T15:44:43.347

你没有mysql_query()，试试

```
$sql = "SELECT * FROM Cars WHERE Make ='$car', Model ='$model', Type ='$type', Colour = '$colour', Year  = '$year', Price = '$price'";
$result = mysql_query($sql) or die("ERROR: ".mysql_error()); 
```

**编辑** 我放入 or die 语句以帮助调试，您可以随时将其删除。我个人觉得这样更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:44:54.900

你需要使用`mysql_query`之前`mysql-fetch-aarray`。有关如何执行此操作的示例，请参见此[页面](http://php.net/manual/en/function.mysql-fetch-array.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:36:41.020

我认为您的查询甚至没有被执行。我从未见过`WHERE [column], [column], [column]`以前的语法。

尝试：

```
SELECT * FROM Cars WHERE Make ='$car' AND Model ='$model' AND Type ='$type' AND Colour = '$colour' AND Year  = '$year' AND Price = '$price' 
```

我添加了一些错误检查，如果语法正确，你可以看到你得到的任何 mysql 错误。

```
$sql = "SELECT * FROM Cars WHERE Make ='$car', Model ='$model', Type ='$type', Colour = '$colour', Year  = '$year', Price = '$price'";
$result=mysql_query($sql, $con);
if($result)    
{
     while($info = mysql_fetch_array($result)){
        echo "<tr>";
        echo "<td>" . $info['Make']. "</td>";
        echo "<td>" . $info['Model']. "</td>";
        echo "<td>" . $info['Type']. "</td>";
        echo "<td>" . $info['Colour']. "</td>";
        echo "<td>" . $info['Year']. "</td>";
        echo "<td>" . $info['Price']. "</td>";

        echo "<br/><br/><td>" . '<hr>' .  "</td>";

}
else {
    die(mysql_error();
} 
```

# java - `if else` 和 `if-else if-else` 之间有区别吗？

> ID：10319038
> 
> 赞同：2
> 
> 时间：2012-04-25T15:42:25.843
> 
> 标签：java, algorithm, optimization, assembly, compilation

在[WikiPedia](http://en.wikipedia.org/wiki/Binary_search_algorithm)文章中，`Binary Search`有一个名为的部分`Deferred detection of equality`提供了一种“优化”的二进制搜索版本，如下所示：

```
int binary_search(int A[], int key, int imin, int imax)  
{  
  while (imax > imin)  
  {  
    int imid = (imin + imax) / 2;  
    if (A[imid] < key)  
      imin = imid + 1;  
    else  
      imax = imid;  
  }  
  if((imax == imin) && (A[imin] == key))  
    return imin;  
  else  
    return KEY_NOT_FOUND;  
} 
```

据称这是比传统教科书二进制搜索更好的版本，因为这`.... algorithm uses only one conditional branch per iteration`
是真的吗？我的意思是`if`指令被翻译成汇编指令`CMP`，`Branch`所以我不认为 an`if-else`比 an 更好`if-else if-else`
是否存在这样的差异，我应该在更高级别的语言中考虑到这一点？`if-else`我管理“延迟”版本的代码似乎更严格，但是您如何形成语句有优化或惩罚吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:45:57.183

关键概念是*每次迭代*使用较少的条件。也就是说，相等检查已移到`while`循环之外，因此它只运行一次，而在基本版本中，每次都需要检查¹。

也就是说，我不确定在使用优化形式时是否真的会有可测量的差异。例如，考虑一下：

1.  如果您要比较的只是两个整数，那么编译器可以检测到它可以只计算一次比较结果，然后评估要采用哪个分支。
2.  二进制搜索是 O(logN)，因此即使要搜索的元素数量很大，所进行的迭代次数实际上也会非常少。你是否会*看到*任何不同是有争议的。
3.  现代 CPU 功能的实现，例如推测执行和分支预测（特别是在像二进制搜索这样的“好”算法中）可能比这种优化具有更明显的效果（尽管我不知道）。

**笔记：**

¹ 实际上，当相等比较移出时，这是*另一个*不需要检查的条件，但从概念上讲没有区别。

# php - XML DOMDocument php - 查询

> ID：10319043
> 
> 赞同：0
> 
> 时间：2012-04-25T15:42:38.847
> 
> 标签：php, xml, domdocument

我有这个问题。我有一个包含以下代码的 xml 文件：

```
<Products>
<Product>
    <ID_Product>1</ID_Product>
    <ID_ProductKind>green</ID_ProductKind>
    <ID_ProductStatus>apple</ID_ProductStatus>
    </Product>
    <Product>
    <ID_Product>2</ID_Product>
    <ID_ProductKind>yellow</ID_ProductKind>
    <ID_ProductStatus>banana</ID_ProductStatus>
    </Product>
 </Products> 
```

现在我想选择 ID_ProductKind 和 ID_ProductStatus，其中 ID_Product 等于一 (1)。无论如何，我的查询结果应该是：

青苹果

在mysql中很简单。如何在 DOMDocument 中执行此操作？

问候，大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T03:50:53.047

我假设您正在寻找一个基本的 XPath 表达式。

它不是特别优雅，但您可以尝试这样的操作：“//ID_ProductKind[preceding-sibling::ID_Product='1']/text()”。

您可以对 ID_ProductStatus 使用类似的东西。

我不太确定连接这些值——也许你可以在你的 php 代码中处理它。我看到在更高版本的 XPath 中有一个字符串连接函数。

# deployment - 使用 Presto 部署应用程序的多个实例

> ID：10319048
> 
> 赞同：3
> 
> 时间：2012-04-25T15:42:55.510
> 
> 标签：deployment, automated-deploy, presto

我有一个要部署的应用程序，但我需要在同一台服务器上部署该应用程序的多个实例。每个实例都需要在其 app.config 文件中具有不同的单元 ID。我怎样才能做到这一点？

我设置了应用程序：

![在此处输入图像描述](../Images/a89ccaf046d4365de96fbcc5fffa5234.png)

然后我创建了变量：

![在此处输入图像描述](../Images/acc0b47d3f8c25d4526462394fc6e93c.png)

但是当我尝试将第二个实例添加到服务器时，我收到以下消息：

![在此处输入图像描述](../Images/f9e618914d71f8edd3a9109b7f20a29b.png)

如何添加另一个实例，并让每个实例都使用唯一的单元 ID 变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:39:48.907

如果部署实例因某个变量而异，只需创建这些单独的变量：

![在此处输入图像描述](../Images/1d860f0fb179acf9463b89a59f11b150.png)

它们看起来像这样：

![在此处输入图像描述](../Images/212c3fd4c0cddbc9997975ccd0694cbd.png)

![在此处输入图像描述](../Images/7fcf1ea769949af062905b672fdbb9f4.png)

然后，在服务器选项卡上，您可以输入任意数量的该应用程序实例，只要它们各自具有不同的覆盖组即可。

![在此处输入图像描述](../Images/a45a50740860fbe9ee7e8bd17a22a0f8.png)

现在，当部署这些应用程序时，每个应用程序实例将使用为该应用程序指定的覆盖组中的单元 ID 值。

希望有帮助。

# mysql - MySQL将查询结果追加到当前记录？

> ID：10319053
> 
> 赞同：0
> 
> 时间：2012-04-25T15:43:23.580
> 
> 标签：mysql, join, append

我有一个成功的查询，当前返回除一个表之外的所有数据。最后一个表包含元数据，其中它是一对多关系（一个产品，具有相关数据的多个记录）。

有没有办法将带有值的字段附加到现有查询的末尾，以便我仍然可以使用 mysql_fetch_array() 命令访问 PHP 中的记录集？

本质上，我想用产品 ID 查询任何记录，然后附加多个附加字段。

在考虑之后，我实际上想知道我是否可以在记录集中包含一个数组（即元数据的结果数组）并通过 PHP 访问它？

**工作查询：**

```
SELECT offers.*, c.short_name AS sponsorName, c.logo AS sponsorLogo 
FROM offers LEFT JOIN sponsors AS c ON c.id=offers.sponsor ORDER BY end_date ASC 
```

**结果：**

```
ID: 43875
category: 1
state: CO
city: Denver
zip: 80221
sponsor: 1
title: The coolest thing ever
duration: 2 years
price: 10
frequency:: Month 
```

**获取正确元数据的第二个查询-**

```
SELECT mo.`name` AS meta_value FROM offer_metas 
LEFT JOIN meta_options AS mo ON mo.id = offer_metas.meta_option 
WHERE offer_id='48735' ORDER BY meta_option ASC 
```

**结果：**

```
meta_value:
'5-10 tickets'
'General Admission' 
```

我想将这两个字段添加到顶部的记录中......但不知道如何将查询结果中的所有字段附加到单个现有记录中。

**- 解决了 -**

**查询已调整为考虑 GROUP_CONCAT，如下所示**

```
SELECT
offers.*,
s.short_name AS sponsorName,
s.logo AS sponsorLogo,
GROUP_CONCAT( mn.title) titles,
GROUP_CONCAT( mo.`name`) metas
FROM offers
LEFT JOIN sponsors AS s ON s.id = offers.sponsir
INNER JOIN offer_metas ON offer_metas.offer_id = offers.id
INNER JOIN meta_options as mo ON offer_metas.meta_option = mo.id
INNER JOIN meta_names as mn ON mo.category = mn.category AND mo.cat_seq = mn.seq
ORDER BY end_date ASC 
```

**数据结果看起来不错，包括 2 个名为“titles”和“metas”的字段，看起来像这样**

```
titles: 'Number of Tickets,Purchased Seats'
metas: '5-10,General Administration' 
```

现在 THOSE .. 我可以在 PHP 中使用 .. 并且由于它们具有相同数量的元素，我只需将它们解析为一个数组，我可以更好地使用 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:19:59.300

除了您上面的评论之外，这听起来[`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)会给您您所追求的。它不会`meta_values`以数组的形式返回，而是以字符串的形式返回（例如，每个值用 分隔`<br/>`，以便它们可以直接作为 HTML 发出）：

```
SELECT
  offers.*,
  c.short_name AS sponsorName,
  c.logo AS sponsorLogo,
  GROUP_CONCAT(mo.name ORDER BY meta_option ASC SEPARATOR '<br/>') AS meta_values
FROM
  offers
  LEFT JOIN sponsors     AS c  ON c.id       = offers.sponsor
  LEFT JOIN offer_metas  AS o  ON o.offer_id = offers.id
  LEFT JOIN meta_options AS mo ON mo.id      = offer_metas.meta_option
ORDER BY end_date ASC; 
```

请注意，如果您需要转义它们可能包含的任何 HTML 的元值，则需要选择不同的分隔符（可能是[U+001E](http://www.fileformat.info/info/unicode/char/1e/index.htm)，`INFORMATION SEPARATOR TWO`？）并在转义任何包含的 HTML 后让 PHP 用合适的 HTML 替换该分隔符。

# ios4 - 关于在设备上播放视频与替代方案的建议

> ID：10319056
> 
> 赞同：1
> 
> 时间：2012-04-25T15:43:26.180
> 
> 标签：ios4

我正在开发一个应用程序，该应用程序将包含用户需要拥有的大量图片和视频。该应用程序的口头禅是随时随地提供这些视频和图片。然而，我担心应用程序太胖（大），本质上关闭了一些优先考虑大小而不是实质的客户。首选一直是让客户能够从任何地方访问这些视频，而不管 3g/wifi （即设备上的本地）。什么是真正好的选择？假设我选择走非本地路线（即使用 wifi/3g），我还有哪些选择？请指教。视频/图片的大小可达 1.5GB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:06:11.267

通常的方法似乎是按需下载和存储视频。我见过的很多应用程序都允许用户自己管理存储的视频，这样如果他们不打算再次使用它们就可以删除视频。

# sql - 选择语句以显示未来的下一个“事件”

> ID：10319060
> 
> 赞同：2
> 
> 时间：2012-04-25T15:43:42.840
> 
> 标签：sql, date

我正在尝试检索下一个即将发生的事件的记录，我使用了各种不同的方法，但似乎无法得到结果。我需要检索到的事件在未来，

例如，如果昨天有一个事件并且有一个三周内的时间，我想要三周内的时间的记录，而不是昨天的记录。

我目前的声明是：

```
SELECT TOP 1    *
FROM            Events
WHERE           StartDate <= DATEADD(day, DATEDIFF(day,0,getdate()), 0)
ORDER BY        StartDate ASC 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T15:47:24.887

```
SELECT TOP 1 E.* 
FROM Events E 
WHERE E.StartDate > GetDate()
ORDER BY E.StartDate ASC 
```

[http://msdn.microsoft.com/en-us/library/ms188383.aspx](http://msdn.microsoft.com/en-us/library/ms188383.aspx)

# php - PHP 不使用 'json_decode()' 转换 JSON

> ID：10319062
> 
> 赞同：3
> 
> 时间：2012-04-25T15:43:48.290
> 
> 标签：php, json

我有一段非常简单的代码

```
$pc1 = $_POST['post_code1'];
$pc2 = $_POST['post_code2'];
$url = "http://maps.google.com/maps/nav?q=from:".$pc1."%20to:".$pc2;
$url_data = file_get_contents($url);
$json_data = json_decode($url_data);
var_dump($json_data); 
```

`$url_data`充满了多汁的 json 东西，但`$json_data`返回`NULL`。有谁知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:55:46.610

在找到许多有类似问题的人后，我发现以下方法有效

```
$json_data = json_decode(utf8_encode($url_data),true); 
```

[资源](https://stackoverflow.com/a/689195/563247)

# java - 如何从 Java 运行 R 程序？

> ID：10319067
> 
> 赞同：3
> 
> 时间：2012-04-25T15:44:02.817
> 
> 标签：java, r

我有用 R 编写的程序。我可以从 R GUI 运行它，它会吐出结果。

有没有办法从 Java 运行该程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T15:47:17.567

您可能想看看这三个项目。

*   [JRI - Java/R 接口](http://www.rforge.net/JRI/)

*   [储备](http://www.rforge.net/Rserve/)

*   [调用者](http://www.mhsatman.com/rcaller.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-02-19T09:15:41.007

我认为从其他环境执行 R 代码的最简单的可能性之一是 REST Web 服务。

例如，如果您有一个名为 example.R 的 R 脚本，它具有以下功能：

```
#* @get /hello
hello <- function() {
  print("hello")
} 
```

您可以运行以下命令：

```
library(plumber)
r <- plumb("example.R")
r$run(port=8080) 
```

如果你然后调用页面

```
http://localhost:8080/hello 
```

您的 R 代码将被执行。

如果您想从 Java 执行它，解决方案可能是：

```
 URL url = new URL("http://localhost:8080/hello");
   URLConnection connection = url.openConnection();
   BufferedReader br = new BufferedReader(new InputStreamReader( (connection.getInputStream())));
   String result = br.readLine(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-16T11:32:28.047

您还可以使用[FastR](https://github.com/oracle/fastr)，它是在 JVM 之上实现的 R 引擎。在 Java 中使用它很简单：

```
Context context = Context.newBuilder("R").allowAllAccess(true).build();
int result = context.eval("R", "sum").execute(new int[] {3,4,5}).asInt();
context.eval("R", "print('you can eval any R code here');"); 
```

[这是一个](https://github.com/graalvm/examples/blob/master/r_java_embedding)如何将数据从 Java 传递到 R 并使其看起来像`data.frame`. 这是如何将 R 图形重定向到 Java对象[的另一个示例。](https://github.com/graalvm/examples/tree/master/fastr_javaui)`Graphics2D`

这篇文章有更详细的描述：[https ://medium.com/graalvm/faster-r-with-fastr-4b8db0e0dceb](https://medium.com/graalvm/faster-r-with-fastr-4b8db0e0dceb)

在 GraalVM 网站上：http: [//graalvm.org](http://graalvm.org)

# php - array_shift 函数在 php 中无法正常工作

> ID：10319072
> 
> 赞同：-2
> 
> 时间：2012-04-25T15:44:39.270
> 
> 标签：php, zend-framework

我遇到了一些麻烦我有`$currentPages`存储以下数据的变量

```
Array ( [1] => CMS_Content_Item_Page Object ( [id] => 1 [name] => Soft Snacks [headline] => Soft Snacks [image] => /ImageUploaded/4page-img1.png [description] => Cheese Burger.................................................................3500 Frw Beef Burger.....................................................................3000 Frw Eggs Burger.....................................................................3500 Frw [content] => Cheese Burger.................................................................3500 Frw Beef Burger.....................................................................3000 Frw Eggs Burger.....................................................................3500 Frw Meat Ball ( 3 ) ................................................................1500 Frw Chicken wings.................................................................4000 Frw Sambusa ( 3 ).................................................................1500 Frw Cheese Plate ..................................................................2500 Frw Cheese Sausage..............................................................3500 Frw [parent_id] => 0 [_namespace:protected] => restaurant [_restaurantModel:protected] => Application_Model_Restaurant Object ( [_name:protected] => restaurants [_dependentTables:protected] => Array ( [0] => Application_Model_ContentNode ) [_referenceMap:protected] => Array ( [Restaurant] => Array ( [columns] => Array ( [0] => parent_id ) [refTableClass] => Application_Model_Restaurant [refColumns] => Array ( [0] => id ) [onDelete] => cascade [onUpdate] => restrict ) ) [_definition:protected] => [_definitionConfigName:protected] => [_db:protected] => Zend_Db_Adapter_Pdo_Mysql Object ( [_pdoType:protected] => mysql [_numericDataTypes:protected] => Array ( [0] => 0 [1] => 1 [2] => 2 [INT] => 0 [INTEGER] => 0 [MEDIUMINT] => 0 [SMALLINT] => 0 [TINYINT] => 0 [BIGINT] => 1 [SERIAL] => 1 [DEC] => 2 [DECIMAL] => 2 [DOUBLE] => 2 [DOUBLE PRECISION] => 2 [FIXED] => 2 [FLOAT] => 2 ) [_defaultStmtClass:protected] => Zend_Db_Statement_Pdo [_config:protected] => Array ( [host] => localhost [username] => hotelrwanda [password] => password [dbname] => hotelrwanda_db [charset] => [persistent] => [options] => Array ( [caseFolding] => 0 [autoQuoteIdentifiers] => 1 [fetchMode] => 2 ) [driver_options] => Array ( ) ) [_fetchMode:protected] => 2 [_profiler:protected] => Zend_Db_Profiler Object ( [_queryProfiles:protected] => Array ( ) [_enabled:protected] => [_filterElapsedSecs:protected] => [_filterTypes:protected] => ) [_defaultProfilerClass:protected] => Zend_Db_Profiler [_connection:protected] => PDO Object ( ) [_caseFolding:protected] => 0 [_autoQuoteIdentifiers:protected] => 1 [_allowSerialization:protected] => 1 [_autoReconnectOnUnserialize:protected] => ) [_schema:protected] => [_cols:protected] => Array ( [0] => id [1] => parent_id [2] => namespace [3] => name [4] => date_created ) [_primary:protected] => Array ( [1] => id ) [_identity:protected] => 1 [_sequence:protected] => 1 [_metadata:protected] => Array ( [id] => Array ( [SCHEMA_NAME] => [TABLE_NAME] => restaurants [COLUMN_NAME] => id [COLUMN_POSITION] => 1 [DATA_TYPE] => int [DEFAULT] => [NULLABLE] => [LENGTH] => [SCALE] => [PRECISION] => [UNSIGNED] => [PRIMARY] => 1 [PRIMARY_POSITION] => 1 [IDENTITY] => 1 ) [parent_id] => Array ( [SCHEMA_NAME] => [TABLE_NAME] => restaurants [COLUMN_NAME] => parent_id [COLUMN_POSITION] => 2 [DATA_TYPE] => int [DEFAULT] => [NULLABLE] => 1 [LENGTH] => [SCALE] => [PRECISION] => [UNSIGNED] => [PRIMARY] => [PRIMARY_POSITION] => [IDENTITY] => ) [namespace] => Array ( [SCHEMA_NAME] => [TABLE_NAME] => restaurants [COLUMN_NAME] => namespace [COLUMN_POSITION] => 3 [DATA_TYPE] => varchar [DEFAULT] => [NULLABLE] => 1 [LENGTH] => 50 [SCALE] => [PRECISION] => [UNSIGNED] => [PRIMARY] => [PRIMARY_POSITION] => [IDENTITY] => ) [name] => Array ( [SCHEMA_NAME] => [TABLE_NAME] => restaurants [COLUMN_NAME] => name [COLUMN_POSITION] => 4 [DATA_TYPE] => varchar [DEFAULT] => [NULLABLE] => 1 [LENGTH] => 100 [SCALE] => [PRECISION] => [UNSIGNED] => [PRIMARY] => [PRIMARY_POSITION] => [IDENTITY] => ) [date_created] => Array ( [SCHEMA_NAME] => [TABLE_NAME] => restaurants [COLUMN_NAME] => date_created [COLUMN_POSITION] => 5 [DATA_TYPE] => int [DEFAULT] => [NULLABLE] => 1 [LENGTH] => [SCALE] => [PRECISION] => [UNSIGNED] => [PRIMARY] => [PRIMARY_POSITION] => [IDENTITY] => ) ) [_metadataCache:protected] => [_metadataCacheInClass:protected] => 1 [_rowClass:protected] => Zend_Db_Table_Row [_rowsetClass:protected] => Zend_Db_Table_Rowset [_defaultSource:protected] => defaultNone [_defaultValues:protected] => Array ( ) ) ) ) 
```

在使用 array_shift 函数后，它只给了我 Array ( ) 这没什么，有没有其他选项可以帮助处理这些数据。

[编辑] 基本上，我在这里使用 zend 框架是处理这个 array() 的脚本

```
public function indexAction()
{
    $mdlPagepageModel = new Application_Model_Restaurant();
    $recentPages = $mdlPagepageModel->getRecentRestaurants();
    if (is_array($recentPages)) {
        // the 3 most recent items are the featured items
        for ($i = 1; $i <= 2; $i ++) {
            if (count($recentPages) > 0) {
                $featuredItems[] = array_shift($recentPages);
            }
        }
        $this->view->featuredItems = $featuredItems;

        if (count($recentPages) > 0) {

            $this->view->recentPages = $recentPages;
        } else {
            $this->view->recentPages = $null;
        }
    } else{
        throw new Zend_Exception("Currently, menu does't have any file!");
    }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:49:00.050

那是因为整个数组是数组（对象）的第一个元素，使用 array_shift 删除它。你想做什么？

# jquery - jQuery 可拖动溢出：自动问题

> ID：10319078
> 
> 赞同：4
> 
> 时间：2012-04-25T15:45:01.203
> 
> 标签：jquery, draggable, jquery-ui-draggable

如何使用溢出：自动将我的项目拖出#draggable div？下面的例子。

[http://jsfiddle.net/7rmY3/1/](http://jsfiddle.net/7rmY3/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:00:58.647

使用选项：

`'helper':'clone'`

似乎让用户将项目拖出

[http://jsfiddle.net/7rmY3/5/](http://jsfiddle.net/7rmY3/5/)

编辑，

如果您需要删除拖动的项目，请在 droppable 方法的 drop 事件中进行。我应用了索引 id 来识别项目，但这可以通过不同的方式进行

```
$('#target').droppable({
    drop: function(event,ui){
               // Append the item in the droppable div
               $(this).append($(ui.draggable));       
               // Remove the item from the draggable list     
               $('#draggable li#'+$(ui.draggable).attr('id')).remove();
           }
}); 
```

[http://jsfiddle.net/7rmY3/14/](http://jsfiddle.net/7rmY3/14/)

# html - 可以 HTML5 元素用于对过滤或重新排序主要内容的链接进行分组？

> ID：10319079
> 
> 赞同：6
> 
> 时间：2012-04-25T15:45:01.220
> 
> 标签：html, semantics, nav

我们的网站有两个主要导航链接，指向两个完全不同的页面。像这样的东西：

```
<section>
    <header>
        <nav>
            <ul>
                <li><a href="link1.html">Link 1</a></li>
                <li><a href="link2.html">Link 2</a></li>
            </ul>
        </nav>
    </header>
</section> 
```

在其中一个页面上，我们还有一个由链接列表组成的过滤组件，这些链接使用 Ajax 更改主要内容区域中列出的结果集（类似于 kayak.com 在您调整时实时过滤他们的航班选项滑块，单击复选框等）

我的问题是，该组过滤链接是否应该包含在一个`<nav>`元素中？

它看起来像这样：

```
<section>
    <nav>
        <ul>
            <li><a href="#filter1">Filter 1</a></li>
            <li><a href="#filter2">Filter 2</a></li>
            <li><a href="#filter3">Filter 3</a></li>
            <li><a href="#filter4">Filter 4</a></li>
            <li><a href="#filter5">Filter 5</a></li>
        </ul>
    </nav>
</section> 
```

我感到困惑的原因是[规范](http://dev.w3.org/html5/spec/single-page.html#the-nav-element)并不清楚通过过滤等方法对页面内容进行实质性更改是否构成“主要导航”。另外，我不确定从可访问性的角度来看，这样的页面上有两个导航元素是否会在语义上造成混淆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:48:37.607

你可以，但它在语义上不正确。我会在这里使用[命令](http://www.whatwg.org/specs/web-apps/current-work/multipage/interactive-elements.html#the-command-element)标签，因为您不是在导航内容，而是根据某些标准给出显示/隐藏某些内容的命令。

# c - C struct 到 void* 指针

> ID：10319080
> 
> 赞同：12
> 
> 时间：2012-04-25T15:45:07.600
> 
> 标签：c, void-pointers, structure

我有一个结构定义为：

```
typedef struct {
   int type;
   void* info;
} Data; 
```

然后我有几个其他的结构，我想使用以下函数分配给 void*：

```
Data* insert_data(int t, void* s)
{
    Data * d = (Data*)malloc(sizeof(Data));
    d->type = t;
    d->info = s;

    return d;
}

struct {
   ...
} Struct#; 
```

然后我就打电话

```
insert_data(1, variable_of_type_Struct#); 
```

当我编译它时，它会发出警告

```
warning: assignment from incompatible pointer type 
```

我试图将插入中的变量强制转换为 (void*) 但没有用

```
insert_data(1, (void *) variable_of_type_Struct#); 
```

我怎样才能摆脱这个警告？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-25T15:49:03.373

传入结构的地址，而不是它的副本（即不是按值传递）：

```
insert_data(1, &variable_of_type_Struct); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T15:49:58.477

传递一个指向结构对象的指针：

```
struct your_struct_type bla;

insert_data(1, &bla); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-25T15:53:37.417

希望这个程序有帮助！

```
#include <stdio.h>
#include <stdlib.h>

typedef struct {
   int type;
   void* info;
} Data;

typedef struct {
    int i;
    char a;
    float f;
    double d;  
}info;

Data* insert_data(int t, void* s)
{
    Data * d = (Data*)malloc(sizeof(Data));
    d->type = t;
    d->info = s;

    return d;
}

int main()
{
    info in; 
    Data * d;
    d = insert_data(10, &in);

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T16:04:58.027

我不太确定这是什么：

```
struct {
   ...
} Struct#; 
```

因此，在将结构的地址放入调用后，我稍微清理了您的程序并没有收到任何警告， `insert_data(1, &variable_of_type_Struct);`

```
#include <stdlib.h>
#include <stdio.h>

typedef struct {
    int type;
    void* info;
} Data;

Data* insert_data(int t, void* s);

Data variable_of_type_Struct;

Data* insert_data(int t, void* s)
{
    Data * d = (Data*)malloc(sizeof(Data));
    d->type = t;
    d->info = s;

    return d;
}

void test()
{
    insert_data(1, &variable_of_type_Struct);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T16:07:03.253

`insert_data`等待一个`void*`，你放一个`Data`。

```
insert_data(1, &variable_of_type_Struct#); 
```

它错过了一定程度的间接性。

# ruby-on-rails - Rails 不会在 ajax 请求下重新加载类

> ID：10319082
> 
> 赞同：0
> 
> 时间：2012-04-25T15:45:15.327
> 
> 标签：ruby-on-rails, ajax

我像这样启动rails服务器：

```
$rails server thin -d 
```

当然，我的环境是发展。

如果请求不是 ajax，则重新加载类。

在客户端，我使用 jQuery 处理 ajax 请求。

客户端的片段：

```
$.ajax({
    url: '/products/all',
    success: function(data) {
    $('.result').html(data);
    alert('Load was performed.');
 } 
```

});

**如何在 ajax 请求下强制 Rails 重新加载类？**

# algorithm - 遍历具有负节点和循环节点的图的最佳算法是什么

> ID：10319085
> 
> 赞同：3
> 
> 时间：2012-04-25T15:45:28.473
> 
> 标签：algorithm, path, routes, shortest

我有一个非常困难的问题要解决，我只是想知道什么算法可以用来找到最快的路线。无向图由正调整和负调整组成，这些调整会影响在迷宫中导航的机器人或事物。我遇到的问题是包含可以是 + 或 - 的循环的迷宫。一个例子可能会有所帮助：-

1.  节点 A 给对象 10 分

2.  节点 B 从对象中取 15

3.  节点 C 给对象 20 分

路线=""

起始节点是A，结束节点是C

给定图形结构为：-

```
a(+10)-----b(-15)-----c+20

 node() means the node loops to itself   - and + are the adjustments 
```

没有循环的节点是c+20，所以节点c有20的正调整但是没有循环

如果机器人或对象在其资源中有 10 个点，那么最佳路径是：-

```
a > b > c    the object would have 25 points when it arrives at c 
```

路线="a,b,c"

这很容易实现，下一个挑战是知道如何回溯到一个好的节点，让我们假设在每个节点上你可以找到它的任何邻居节点及其调整级别。这是下一个示例：-

如果机器人开始时只有 5 个点，那么最好的路径是

```
a > a > b > c the bot would have 25 points when arriving at c 
```

路线="a,a,b,c"

这是一个非常简单的图表，但是当您有更多节点时，机器人很难知道是在一个好的节点上循环还是从一个好的节点转到另一个，同时跟踪可能的路线。

这样的路线将是一个回溯队列。

一个更难的例子会导致很多来回

机器人有 10 分

```
a(+10)-----b(-5)-----c-30 
```

a > b > a > b > a > b > a > b > a > b > c 剩下 5 分。

机器人可以做到的另一种方式是：-

a > a > a > b > c

这是一种更有效的方法，但你怎么能编程这部分是我的问题。

有没有人知道解决这个问题的好算法，我已经研究了 Bellman-fords 和 Dijkstra 但这些只给出了一个简单的路径而不是循环路径。

它可以以某种方式或某种形式的启发式递归吗？

* * *

参考您的类比：-

我想我明白你的意思，到目前为止，有点伪会更清楚 route()

```
q.add(v)
best=v
hash visited(v,true)

while(q is not empty)
    q.remove(v)
    for each u of v in G

        if u not visited before
            visited(u,true)
            best=u=>v.dist
        else
            best=v=>u.dist 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:09:17.893

这是一个简单的动态规划问题。

假设对于给定长度的路径，对于每个节点，您想知道在该节点处结束的最佳成本，以及该路径的来源。（该长度的数据可以存储在散列中，即链表中的路由。）

假设我们有 n 个步骤的数据。然后对于第 n+1 次，我们从一张白纸开始，然后为第 n 次获取每个答案，将其向前移动一个节点，如果我们降落在一个节点上，我们没有数据，否则我们比最好的更好，然后我们用我们改进的分数更新那个节点的数据，并添加路由（只是这个节点链接回之前的链表）。

一旦我们获得了您想要的步数，找到具有最佳现有路线的节点，然后您将您的分数和路线作为链接列表。

========

这是实现该算法的实际代码：

```
class Graph:
    def __init__(self, nodes=[]):
        self.nodes = {}
        for node in nodes:
            self.insert(node)

    def insert(self, node):
        self.nodes[ node.name ] = node

    def connect(self, name1, name2):
        node1 = self.nodes[ name1 ]
        node2 = self.nodes[ name2 ]
        node1.neighbors.add(node2)
        node2.neighbors.add(node1)

    def node(self, name):
        return self.nodes[ name ]

class GraphNode:
    def __init__(self, name, score, neighbors=[]):
        self.name = name
        self.score = score
        self.neighbors = set(neighbors)

    def __repr__(self):
        return self.name

def find_path (start_node, start_score, end_node):
    prev_solution = {start_node: [start_score + start_node.score, None]}
    room_to_grow = True
    while end_node not in prev_solution:
        if not room_to_grow:
            # No point looping endlessly...
            return None
        room_to_grow = False
        solution = {}
        for node, info in prev_solution.iteritems():
            score, prev_path = info
            for neighbor in node.neighbors:
                new_score = score + neighbor.score
                if neighbor not in prev_solution:
                    room_to_grow = True
                if 0 < new_score and (neighbor not in solution or solution[neighbor][0] < new_score):
                    solution[neighbor] = [new_score, [node, prev_path]]
        prev_solution = solution
    path = prev_solution[end_node][1]
    answer = [end_node]
    while path is not None:
        answer.append(path[0])
        path = path[1]
    answer.reverse()
    return answer 
```

以下是如何使用它的示例：

```
graph = Graph([GraphNode('A', 10), GraphNode('B', -5), GraphNode('C', -30)])
graph.connect('A', 'A')
graph.connect('A', 'B')
graph.connect('B', 'B')
graph.connect('B', 'B')
graph.connect('B', 'C')
graph.connect('C', 'C')

print find_path(graph.node('A'), 10, graph.node('C')) 
```

请注意，我明确地将每个节点连接到自身。根据您的问题，您可能希望使其自动化。

（注意，还有一个可能的无限循环。假设起始节点的得分为 0 并且没有办法离开它。在这种情况下，我们将永远循环。为这种情况添加检查需要工作.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:02:31.750

我对您的描述感到有些困惑，您似乎只是在寻找最短路径算法。在这种情况下，谷歌是你的朋友。

在您给出的示例中，您有 -ve 调整，在图遍历的通常用语中，这实际上应该是 +ve 成本。即你想找到一条成本最低的路径，所以你需要更多的+ve调整。

如果您的图表有利于遍历的循环（即通过调整降低成本或增加点数），那么最佳路径是未定义的，因为再通过一次循环将提高您的分数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:30:08.577

这是一些伪代码

```
steps = []
steps[0] = [None*graph.#nodes]
step = 1
while True:
     steps[step] = [None*graph.#nodes]
     for node in graph:
         for node2 in graph:
             steps[step][node2.index] = max(steps[step-1][node.index]+node2.cost, steps[step][node2.index])

     if steps[step][lastnode] >= 0:
         break; 
```

# java - 按照对象 ID 列表的顺序对对象列表进行排序

> ID：10319088
> 
> 赞同：1
> 
> 时间：2012-04-25T15:45:35.510
> 
> 标签：java, list, sorting

这就是我所拥有的：

```
class Person {
  Integer id;
  String name;
}

// A list of persons:
List<Person> persons

// Now I have something like this:
List<Integer> ids  // where the ids are stored in an specific order 
```

基本上我想按照与ID相同的顺序对人员列表进行排序。

有没有更好的方法然后使用两个循环并创建一个新的人员列表？

问候 && 蒂亚

noircc

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:05:58.043

使用`Collections.sort`自定义`Comparator`，如下所示。比较器获取被比较人员的 id 并计算出它们在 ids 列表中出现的顺序：

```
List<Person> persons = ...;
final List<Integer> ids = ...;

Collections.sort(persons, new Comparator<Person>() {
    @Override
    public int compare(Person p1, Person p2) {
        int index1 = ids.indexOf(p1.getId());
        int index2 = ids.indexOf(p2.getId());
        return index1 < index2 ? -1 : (index1 == index2 ? 0 : 1);
    }
}); 
```

注意：此代码假定列表中所有人员的 id 都将出现在 ids 列表中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T15:53:22.413

1.  将每个 映射`ids`到其索引中：`Map<Integer, Integer> idToIndex`;
2.  运行以下循环。

* * *

```
for (int i = 0, size = persons.length - 1; i < size; ++i) {
  var targetIndex = idToIndex.get(persons.get(i).id);
  if (targetIndex != i) {
    persons[i] <-> persons[targetIndex];
  }
} 
```

# ruby-on-rails - 迁移属性未被识别产生 ActiveRecord::UnknownAttributeError

> ID：10319093
> 
> 赞同：1
> 
> 时间：2012-04-25T15:46:00.073
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, rspec2

我有一个名为**会议**的模型，它将用于存储会议的详细信息等。以前我只包含基本字段：id、created_at 和 updated_at 包含在我调用时使用的空白工厂类中：

```
@meeting_attr = FactoryGirl.attributes_for(:meeting)
@meeting = Meeting.create(@meeting_attr) 
```

这工作得很好，直到我在数据库中添加了另一个名为**name**的列，它将用于提供有关会议类型的更多信息。我检查了迁移运行正常，可以看到它包含在数据库表和**schema.rb**中，但是当我运行前面提到的代码时，我现在收到此错误：

```
Failure/Error: @meeting = Meeting.create(@meeting_attr)
ActiveRecord::UnknownAttributeError:
  unknown attribute: name 
```

是否有任何我可能忽略的原因导致无法识别此属性。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T10:13:30.077

rake db:test:prepare 必须在更新的表详细信息被识别之前运行

# android - 在 osmdroid 中将叠加添加到 MapView

> ID：10319094
> 
> 赞同：6
> 
> 时间：2012-04-25T15:46:00.147
> 
> 标签：android, mapping, overlay, osmdroid

我正在使用 osmdroid 编写一个简单的 android 应用程序，该应用程序可以在线离线工作，直到现在我能够显示地图（在线和离线），并且我想在地图上添加覆盖（标记），我已经搜索了使用的简单示例在 osmdroid 中覆盖，我尝试了其中一些，但它们没有用，所以我想要使用 osmdroid 添加覆盖或标记的任何示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T05:19:25.870

查看 ItemizedIconOverlay 类。

如果您搜索，互联网上有一些示例，此处的 Stack Overflow 上已发布示例：[将 Overylay 添加到 OSMDROID](https://stackoverflow.com/questions/6496366/adding-overylay-to-osmdroid)

# vba - 当我使用 AutoFilter 的 SpecialCells 在 VBA 中获取可见单元格时出错

> ID：10319096
> 
> 赞同：4
> 
> 时间：2012-04-25T15:46:10.143
> 
> 标签：vba, excel, visible, autofilter

我的主要目标是复制自动过滤器的可见单元格，然后将可见单元格的尺寸复制到新工作表中。我正在使用这段代码：

```
Sheets(1).AutoFilterMode = False
Sheets(1).Range("A1:A1").AutoFilter Field:=columnaNumeroIntervalo, criteria1:=CDec(paramCantidadCriterio)
Sheets(1).Range("A1:A1").AutoFilter Field:=columnaNumeroIntervaloUnidades, Criteria1:=paramUnidadesCriterio

MsgBox AutoFilter.Range.SpecialCells(xlCellTypeVisible)(2, 11).Value 
```

最后一行我想检查值 oa 单元格。如果我使用`Cells(2,11)`而不是，`SpecialCells`我可以看到单元格具有工作表的所有单元格，可见和不可见。所以我想用`SpecialCells`.

如果我使用特殊单元格，我会收到以下错误：

`error '-2147417848 (80010108) in runtime. Automatization error.`

对于一次执行的类型，它似乎进入了一个循环，最后给出了这个错误。也许 SpecialCells 修改了自动过滤器，然后在每次修改中再次执行自动过滤器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T15:54:15.980

要使用自动过滤器的可见单元格，`Offset`如果您打算排除标题，则必须使用。你得到的错误是因为你错过了一个“。” 前`Cells(2,11)`

```
'~~> Remove any filters
ActiveSheet.AutoFilterMode = False

'~~> Filter, 
With rRange 
  .AutoFilter Field:=1, Criteria1:=strCriteria

  '~~> offset(to exclude headers)
  Debug.Print .Offset(1, 0).SpecialCells(xlCellTypeVisible).Cells(2,11).Value

  Debug.Print .SpecialCells(xlCellTypeVisible).Cells(2,11).Value
End With

'~~> Remove any filters
ActiveSheet.AutoFilterMode = False 
```

我决定将此添加为此答案的一部分，以便将来可能对其他人有所帮助。

假设我们的范围是

A1:F6

![在此处输入图像描述](../Images/fe3926c585311402b90bf92d126f3e0f.png)

当你运行下面的代码时，根据你是否使用`Offset`，你会得到这些结果。

```
Option Explicit

Sub Sample()
    '~~> Remove any filters
    ActiveSheet.AutoFilterMode = False

    Dim rRange As Range
    Dim Rnge As Range

    Set rRange = Sheets("Sheet1").Range("A1:F6")

    '~~> Filter,
    With rRange
      .AutoFilter Field:=1, Criteria1:="<>2"

      '~~> Offset(to exclude headers)
      Set Rnge = .Offset(1, 0).SpecialCells(xlCellTypeVisible)

      Debug.Print Range(Rnge.Address).Address
      Debug.Print ActiveSheet.Cells(3, 2).Address
      Debug.Print Range(Rnge.Address).Cells(3, 2).Address

      Debug.Print "--------------------------------------------------"

      '~~> To include headers
      Set Rnge = .SpecialCells(xlCellTypeVisible)

      Debug.Print Range(Rnge.Address).Address
      Debug.Print ActiveSheet.Cells(3, 2).Address
      Debug.Print Range(Rnge.Address).Cells(3, 2).Address

    End With

    '~~> Remove any filters
    ActiveSheet.AutoFilterMode = False
End Sub 
```

![在此处输入图像描述](../Images/05187a6b18ab7d7b51b64dd950bf86b8.png)

高温高压

# cartesian-product - 如何优化笛卡尔积

> ID：10319098
> 
> 赞同：1
> 
> 时间：2012-04-25T15:46:13.903
> 
> 标签：cartesian-product

有没有更好的方法来计算笛卡尔积。由于笛卡尔积是一种特殊情况，每种情况都不同。我想，我需要解释我需要实现什么，以及为什么我最终会做笛卡尔积。如果笛卡尔积是我问题的唯一解决方案，请帮助我。如果是这样，如何提高性能？

### 背景：

我们正在努力帮助客户以更便宜的价格购买产品。

假设客户订购了 5 种产品（prod1、prod2、prod3、prod4、prod5）。

每个订购的产品都由不同的供应商提供。

### 表示格式 1：

*   供应商 1 - 提供 prod1、prod2、prod4
*   供应商 2 - 提供 prod1、prod5
*   供应商 3 - 提供 prod1、prod2、prod5
*   供应商 4 - 提供 prod1
*   供应商 5 - 提供 prod2
*   供应商 6 - 提供 prod3、prod4

换句话说

### 表示格式 2：

*   产品 1 - 由 vendor1、vendor2、vendor3、vendor4 提供
*   产品 2 - 由 vendor5、vendor3、vendor1 提供
*   产品 3 - 由供应商提供 6
*   产品 4 - 由供应商 1、供应商 6 提供
*   产品 5 - 由供应商 3、供应商 2 提供

现在根据价格选择最好的供应商。我们可以按价格对产品进行分类并取第一个。

在这种情况下，我们选择

*   来自供应商 1 的产品 1
*   来自供应商 5 的产品 2
*   来自供应商 6 的产品 3
*   来自供应商 1 的产品 4
*   来自供应商 3 的产品 5

### 复杂：

由于我们选择了 4 个独特的供应商，我们需要支付 4 个运费。

此外，每个供应商都有一个最低采购订单。如果我们不满足它，那么我们最终也要支付这笔费用。

为了选择产品的最佳组合，我们必须对提供的产品进行笛卡尔积来计算总价格。

```
total price computation algorithm:

foreach unique vendor 
if (sum (product price offered by specific vendor * quantity) < minimum purchase order limit specified by specific vendor)
totalprice += sum (product price * quantity) + minimum purchase charge + shipping price
else
totalprice += sum (product price * quantity) + shipping price
end foreach 
```

在我们的例子中

*   {vendor1，vendor2，vendor3，vendor4}
*   {供应商1，供应商3，供应商5}
*   {供应商6}
*   {供应商1，供应商6}
*   {供应商2，供应商3}

需要计算 4 * 3 * 1 * 2 * 2 = 48 个组合以找到最佳组合。

*   {vendor1，vendor1，vendor6，vendor1，vendor2} = totalprice1，
*   {vendor1，vendor3，vendor6，vendor1，vendor2} = totalprice2，

*   {vendor4，vendor5，vendor6，vendor6，vendor3} = totalprice48

现在对计算的总价格进行排序以找到最佳组合。

### 实际问题：

如果客户订购的产品超过 15 种，并假设每种产品都由 8 个不同的供应商提供，那么我们最终会计算 8^15=35184372088832 组合，这需要几个小时以上的时间。如果客户订购超过 20 种产品，则需要几天以上的时间。

有没有办法从不同的角度解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:00:22.620

您的问题可能会变得更加复杂。一个简单的例子：

```
 Product   1     2     3
Vendor 1    10    20    40
Vendor 2    20    10    40
--------------------------
needed cnt 100   100    25 
```

你需要 100 艾尔。P1、P2 的 100 和 P3 的 25。

P1 可以在 V1 中以 1000 美元购买，P2 在 V2 中以 1000 美元购买，P3 在 V1 或 V3 中以 1000 美元购买。

现在运费是免费的，如果您购买 1500，但在其他每个供应商处花费您 200。

因此，如果您在 V1 订购所有商品，您将支付**4000**：

```
1000+2000+1000+0 (shipping) = or for the same sum   
2000+1000+1000+0 at V2, or splitted

1000+0+0+200  = 1200 at V1 plus 
0+1000+1000+0 = 2000 at V2, 
```

总计为**3200**，可以通过您的方法找到。

但是您可以通过这种方式拆分产品 3 的购买：

```
1000+0+500+0 = 1500 at V1 plus 
0+1000+500+0 = 1500 at V2 
```

总共只有**3000**并且不会被您的方法找到。

Afaik，在这些主题上有既定的研究，关键词是*矩阵*和*方程组*。

您可以将您的问题描述为

```
f(c11, p11) + f(c22, p12) + f(c13, p13) = c1 => dc1
f(c21, p21) + f(c22, p22) + f(c23, p23) = c2 => dc2
...
f(c31, p31) + f(c32, p32) + f(c13, p33) = c3 => dc3 
```

其中 cij 是供应商 i 处产品 j 的数量，而 pij 是供应商 i 处产品 j 的价格，但 f(c11,p11) 不仅仅是 count*price，而是 count 和 price 的函数，因为可能存在数量折扣。右侧是供应商 i 的采购总额。

这是没有购买折扣的，必须在上面建模。如果运费折扣仅取决于总成本，则可以仅从 ci => dci 建模。

您会尝试最小化总和 (dc1+dc2+...+dcm)。

# java - 如何在 VB.Net Server 中解压缩由 Java Client 压缩的位图

> ID：10319099
> 
> 赞同：1
> 
> 时间：2012-04-25T15:46:16.773
> 
> 标签：java, android, vb.net, tcpclient, tcpserver

我正在尝试让 android 通过 tcp/ip 将图像发送到 vb.net 服务器。Android 会压缩位图，当服务器接收到位图并将其转换为图像时，它会全黑，我认为解压缩可能是问题或其他问题。我真的不知道如何解压缩该图像。任何帮助，将不胜感激。谢谢。

这是创建位图的Java：

```
Bitmap bmp=BitmapFactory.decodeStream(getContentResolver().openInputStream(uri));
ByteArrayOutputStream stream = new ByteArrayOutputStream();
bmp.compress(Bitmap.CompressFormat.JPEG, 100, stream);
byteArray = stream.toByteArray(); 
```

这是我的 vb.net 服务器

```
Sub Main()
    Dim bmp As Bitmap

    Dim serverSocket As New TcpListener(1334)
    Dim requestCount As Integer
    Dim clientSocket As TcpClient
    serverSocket.Start()

    While (True)
        Try
            msg("Waiting For Client...")
            clientSocket = serverSocket.AcceptTcpClient()
            msg("Accept connection from client")
            requestCount = requestCount + 1
            Dim networkStream As NetworkStream = clientSocket.GetStream()
            Dim bytesFrom(clientSocket.ReceiveBufferSize) As Byte
            networkStream.Read(bytesFrom, 0, CInt(clientSocket.ReceiveBufferSize))

            Dim newImage As Image = Nothing
            Byte2Image(newImage, bytesFrom)
            newImage.Save("C:\Users\ppetrenko\Desktop\test.jpeg")

            Dim dataFromClient As String = System.Text.Encoding.ASCII.GetString(bytesFrom)
            dataFromClient = dataFromClient.Substring(0, dataFromClient.IndexOf("$"))
            msg("Data from client -  " + dataFromClient)
            Dim serverResponse As String = "Server response " + Convert.ToString(requestCount)
            Dim sendBytes As [Byte]() = Encoding.ASCII.GetBytes(serverResponse)
            networkStream.Write(sendBytes, 0, sendBytes.Length)
            networkStream.Flush()
            msg(serverResponse)
            clientSocket.Close()
        Catch ex As Exception
            Console.WriteLine(ex.Message)
        End Try
    End While 
```

# java - 记忆游戏java

> ID：10319100
> 
> 赞同：0
> 
> 时间：2012-04-25T15:46:21.587
> 
> 标签：java, memory, colors

> **可能重复：**
> [记忆游戏图形java](https://stackoverflow.com/questions/10310661/memory-game-graphics-java)

我正在编写一个 4x4 记忆游戏的程序。在这 16 个框中将是一对从 0 到 7 的整数。我已经将所有这些随机化并正确编码。现在我试图弄清楚每次鼠标点击框时如何将颜色与相应的整数配对。

这里大部分代码。我知道这个游戏的逻辑还没有开始，但我现在更专注于 displayHit 方法和 setColor 方法。只是发布整个代码，因为也许我在其他地方搞砸了。

```
/*Sets the background of your memory board to black*/
public void init() 
{
    setSize(400,400);
    setBackground(Color.BLACK);
    buildBoard(4);

}   
/*This is main in java applets
    You may need to add (not change) a couple things in this method
 */
public void paint(Graphics canvas)
{
    if(firstRun) //for the first run we need to build our random board
    {

        print2DArray(board);
        buildBoard(4);
        firstRun = false;
    } 
    else // once our board is built we will display the game
    {
        displayGame(canvas);
        if (mouseClicked) // if the mouse has been clicked
        {
            displayHit(canvas);//find which box the user clicked
            mouseClicked = false;
        }
    }
}

/*
    DO NOT change this method
    determines if the mouse has been pressed
    sets x and y Mouse to the location of the mouse arrow
    redraws the image
 */
public boolean mouseDown(Event e, int x, int y ) 
{
    mouseClicked = true; 
    xMouse = x;
    yMouse = y;
    repaint();
    return true;
}

/*DO NOT change this method
    redraws the scene
 */

public void update ( Graphics g ) 
{
    paint(g);
}

/*
    pre: none
    post: build an array that holds the memory values for a board of size x size
    the board will hold two of each int from 0 to size randomly placed in the array
 */

public void buildBoard(int s)

{
    int a = 4;
    for (int row = 0; row < a; row++)
        for (int column = 0; column < a; column++)
        {

            board[row][column] = count++ % 8;
        }
    for(int row = 0; row < 4; row++)

        for(int column = 0; column < 4; column ++) 
        {
            int x = (int)Math.floor(Math.random()*4);
            int y = (int)Math.floor(Math.random()*4);
            temp = board[row][column];
            board[row][column] = board[x][y];
            board[x][y] = temp;

        }
}
public static void print2DArray(int[][] arr)
{
    for (int row = 0; row < arr.length; row++)
    {
        for (int col = 0; col < arr[row].length; col++)
        {
            System.out.print(arr[row][col] + " ");
        }
        System.out.println();
    }
}

public void displayGame(Graphics canvas)
{
    canvas.setColor(Color.WHITE);

    for(int i =0; i < 400; i+= WIDTH)
        for(int j = 0; j < 400; j+= WIDTH)
            canvas.drawRect(i, j, WIDTH, WIDTH);
}

/*
    Pre: xMouse and yMouse have been initialized
    Post: A circle is displayed in the correct box on the screen
    Currently the circle is displayed at the mouse location
 */
public void displayHit(Graphics g)
{

    setColor(g);
    centerHit(xMouse, xMouse);
    g.fillOval(xMouse, yMouse, 40, 40);
}

public void setColor(Graphics g)
{

    switch(temp)
    {
    case 0: g.setColor(Color.RED);
    break;
    case 1: g.setColor(Color.GREEN);
    break;
    case 2: g.setColor(Color.BLUE);
    break;
    case 3: g.setColor(Color.ORANGE);
    break;
    case 4: g.setColor(Color.CYAN);
    break;
    case 5: g.setColor(Color.MAGENTA);
    break;
    case 6: g.setColor(Color.PINK);
    break;
    case 7: g.setColor(Color.YELLOW);
    break;
    }

}
public void centerHit(int centerX, int centerY)
{
    {
        if ((xMouse > 0) && (xMouse <=100))
            xMouse = 33;
        else if ((xMouse > 100) && (xMouse <=200))
            xMouse = 133;
        else if ((xMouse > 200) && (xMouse <=300))
            xMouse = 233;
        else if ((xMouse > 300) && (xMouse <=400))
            xMouse = 333;
    }
    {
        if ((yMouse > 0) && (yMouse <=100))
            yMouse = 33;
        else if ((yMouse > 100) && (yMouse <=200))
            yMouse = 133;
        else if ((yMouse > 200) && (yMouse <=300))
            yMouse = 233;
        else if ((yMouse > 300) && (yMouse <=400))
            yMouse = 333;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:02:46.110

一旦调用 buildBoard，看起来 temp 就永远不会改变。这就是为什么你总是看到相同的颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:15:34.840

这段代码很好

```
public void setColor(Graphics g) 
```

{

```
switch(temp)
{
case 0: g.setColor(Color.RED);
break;
case 1: g.setColor(Color.GREEN);
break;
case 2: g.setColor(Color.BLUE);
break;
case 3: g.setColor(Color.ORANGE);
break;
case 4: g.setColor(Color.CYAN);
break;
case 5: g.setColor(Color.MAGENTA);
break;
case 6: g.setColor(Color.PINK);
break;
case 7: g.setColor(Color.YELLOW);
break;
}

} 
```

但是您没有在代码中的任何地方设置 temp 来选择要使用的案例/颜色。您需要通过硬编码或随机生成 0-7 之间的数字来随机设置颜色来更改温度

# actionscript-3 - Adobe Flex：如何在 TabNavigator 上的 3 个选项卡之间共享数据

> ID：10319102
> 
> 赞同：0
> 
> 时间：2012-04-25T15:46:31.353
> 
> 标签：actionscript-3, apache-flex, flash-builder, flex4.5

我有一个有 4 个选项卡的选项卡式对话框。父组件是一个 mx:TabNavigator，每个选项卡的视图都是 s:NavigatorContent 内的自定义 MXML 组件。3 个选项卡的数据必须作为一个单元发送到后端服务。我正在尝试找出让 3 个选项卡访问要作为一个单元向下发送的数据的最佳方法。我目前有一个 .mxml 文件，它定义了顶级 mx:TabNavigator ，其中 4 个选项卡中的每一个代表 s:NavigatorContent 在它自己的单独的.mxml 文件中定义，以保持文件大小相当短。我目前的方法是让每个选项卡在它们的 creationComplete 处理程序中从后端服务加载它们的数据，并将其存储在一个公共类中，供 3 ​​个选项卡共享的数据模型使用。这个解决方案是可以的，除了：

1.  第一个选项卡的创建完成处理程序在应用程序启动时调用，即使它不是第一个可见组件（即用户首先看到的 UI 的其他部分）。我更喜欢真正的延迟加载，在该选项卡对用户可见之前不会加载数据。
2.  如果用户在第一个选项卡上编辑数据，然后第一次导航到第二个选项卡而不点击应用按钮，则在第一个选项卡中所做的更改将丢失，因为第二个选项卡的创建完成处理程序将加载共享的数据模型通过 3 个选项卡。

我理想中想要的是：

1.  真正的延迟加载；直到用户单击选项卡并且它变得可见时才会加载数据。
2.  拥有它，这样当用户在 3 个选项卡中的任何一个上点击应用时，3 个选项卡中的每个选项卡上的当前条目都会被发送到后端服务。

如果有人能就此提出建议，非常感谢。如果需要，我可以更详细地解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:10:28.893

> 我正在尝试找出让 3 个选项卡访问要作为一个单元向下发送的数据的最佳方法。

最好的总是主观的。最简单的方法是为您的共享数据创建一个变量，并将该实例传递到每个相关选项卡中。

在某些情况下，您可以将数据存储在某个中心位置，并使用依赖注入将该数据注入需要它的相关选项卡组件中。依赖注入是由一堆 Flex 框架实现的，例如 RobotLegs 或 Swiz。

另一种选择是使用单例方法或类上的静态变量在多个选项卡之间共享数据。

> 我目前的方法是让每个选项卡在它们的 creationComplete 处理程序中从后端服务加载它们的数据

为什么使用creationComplete？在组件完成了它的布局例程和它的子级的布局例程之后，会触发 creationComplete 事件，然后一切都可以使用了。我假设加载更多数据的行为将迫使你的许多组件不得不再次经历它们的渲染过程。您可以考虑在生命周期中将其移至更早的位置，例如初始化或预初始化。

> 1) 第一个选项卡的创建完成处理程序在应用程序启动时调用，即使它不是第一个可见组件（即用户首先看到的 UI 的其他部分）。我更喜欢真正的延迟加载，在该选项卡对用户可见之前不会加载数据。

这将是预期的行为，基于 TabNavigators 初始化的方式。您可以查看 creationPolicy 以获取更多信息。您可以重写您的“加载数据”方法来操作组件的显示方法，也许？

> 2) 如果用户在第一个选项卡上编辑数据，然后第一次导航到第二个选项卡而不点击应用按钮，则在第一个选项卡中所做的更改将丢失，因为第二个选项卡的创建完成处理程序将加载数据模型由 3 个选项卡共享。

您可以在组件的隐藏事件中强制保存数据。或者可能在 TabNavigator 的更改事件上。

# rewrite - Zeus rewrite.script - 多个目录

> ID：10319104
> 
> 赞同：1
> 
> 时间：2012-04-25T15:46:41.180
> 
> 标签：rewrite, wordpress, zeus

为多个目录寻找 Zeus Rewrite.Script 的一点帮助 - 我有一个可以运行的工作脚本，我将 Wordpress 放在一个子目录中 - 但是，如果我想在另一个目录中运行另一个 Wordpress 安装，我无法获得重写也可以使用它。任何帮助将不胜感激！

我对 1 个目录的重写；-

```
#Zeus webserver version of basic Wordpress mod_rewrite rules
map path into SCRATCH:path from %{URL}
look for file at %{SCRATCH:path}
if exists then goto END
look for dir at %{SCRATCH:path}
if exists then goto END
##### FIX FOR LOGIN/FORGOTTEN PASSWORD/ADMIN ETC #####
match URL into $ with ^/site1/wp-.*$
if matched then goto END
##### FIX TO ALLOW SEARCH TO WORK #####
match URL into $ with ^/oxford-walking-tours/(.*)
set URL = /site1/index.php/$1 
```

所以第一个目录中的site1 - 任何人都可以建议我如何使这个工作也适用于site2？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T11:04:43.027

下面的脚本可以帮助所有 ZEUS 服务器重定向它忽略名为 myfolder 的文件夹（将其替换为您要从任何重定向中排除的文件夹，您仍然可以访问它。）

文件的其余部分以 www 形式（规则 2）和不带 www（规则 1）的形式重定向到 .com 版本的网站。

将文件保存为 rewrite.script 并上传到服务器的根目录。

```
#ignore anything to do with myfolder
match URL into $ with ^/myfolder(\/)?.*
if matched then goto END

RULE_1_START:
match IN:Host into $ with ^mywebsite\.net$             
if matched then            
match URL into $ with ^/(.*)$             
if matched then            
set OUT:Location  = http://www.mywebsite.com/$1             
set OUT:Content-Type = text/html             
set RESPONSE = 301             
set BODY = Moved             
endif             
endif
RULE_1_END:

RULE_2_START:
match IN:Host into $ with ^www.\mywebsite\.net$             
if matched then            
match URL into $ with ^/(.*)$             
if matched then            
set OUT:Location  = http://www.mywebsite.com/$1             
set OUT:Content-Type = text/html             
set RESPONSE = 301             
set BODY = Moved             
 endif       
endif
RULE_2_END: 
```

# asp.net - 接口、属性和反射

> ID：10319106
> 
> 赞同：0
> 
> 时间：2012-04-25T15:46:52.500
> 
> 标签：asp.net, vb.net, interface

有谁知道获取接口属性的基础属性名称的方法？

例如，以[Juliet 的](https://stackoverflow.com/questions/558152/asp-net-unfamiliar-with-interfaces)接口为例，我稍作修改：

```
Module1

Interface ILifeform 
    ReadOnly Property Name() As String 
    Sub Speak() 
    Sub Eat() 
End Interface 

Class Dog 
    Implements ILifeform 

    Public ReadOnly Property Name() As String Implements ILifeform.Name 
        Get 
            Return "Doggy!" 
        End Get 
    End Property 

    Public Sub Talk() Implements ILifeform.Speak 
        Console.WriteLine("Woof!") 
    End Sub 

    Public Sub Eat() Implements ILifeform.Eat 
        Console.WriteLine("Yum, doggy biscuits!") 
    End Sub 
End Class 

Class Ninja 
    Implements ILifeform 

    Public ReadOnly Property Name() As String Implements ILifeform.Name 
        Get 
            Return "Ninja!!" 
        End Get 
    End Property 

    Public Sub Speak() Implements ILifeform.Speak 
        Console.WriteLine("Ninjas are silent, deadly killers") 
    End Sub 

    Public Sub Eat() Implements ILifeform.Eat 
        Console.WriteLine("Ninjas don't eat, they wail on guitars and kick ass") 
    End Sub 
End Class 

Class Monkey 
    Implements ILifeform 

    Public ReadOnly Property Name() As String Implements ILifeform.Name 
        Get 
            Return "Monkey!!!" 
        End Get 
    End Property 

    Public Sub Speak() Implements ILifeform.Speak 
        Console.WriteLine("Ook ook") 
    End Sub 

    Public Sub Eat() Implements ILifeform.Eat 
        Console.WriteLine("Bananas!") 
    End Sub 
End Class 

Sub Main() 
    Dim lifeforms As ILifeform() = New ILifeform() {New Dog(), New Ninja(), New Monkey()} 
    For Each x As ILifeform In lifeforms 
        HandleLifeform(x) 
    Next 

    Console.ReadKey(True) 
End Sub 

Sub HandleLifeform(ByVal x As ILifeform) 
    Console.WriteLine("Handling lifeform '{0}'", x.Name) 
    x.Speak() 
    x.Eat() 
    Console.WriteLine() 
End Sub 
End Module 
```

对于 Dog 类，实现“Speak”的属性称为“Talk”。

如果我收到一个作为“对象”类型的狗对象，我可以做这样的事情吗？

```
If TypeOf(object) Is ILifeForm Then
   Dim str as string = CType(object, ILifeForm).GetUnderLyingPropertyName("Speak"))
   ' str now contains "Talk"
End If 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2015-05-01T21:00:05.300

why doing this:

```
CType(object, ILifeForm).GetUnderLyingPropertyName("Speak")) 
```

when it is much simpler doing this:

```
CType(object, ILifeForm).Speak 
```

? Job Done. that's a classic polymorphism.

# android - 带有部分的 Android 列表视图

> ID：10319109
> 
> 赞同：5
> 
> 时间：2012-04-25T15:47:13.790
> 
> 标签：android, listview, header

嗨，我在尝试了解分段 ListViews 的工作方式时遇到问题。我让它进入一个正常的列表视图。但现在我想将部分添加到我的列表中。如何在其中添加部分标题。

这是我的有效代码。

```
public class ChooseTeamActivity extends ListActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

    setContentView(R.layout.chooseact);    

    String FullData = getIntent().getStringExtra("FullData");

    try{

      JSONObject obj = new JSONObject(FullData);
      List<String> leagues = new ArrayList<String>();

      JSONObject objData = obj.getJSONObject("data");

      JSONArray jArray = objData.getJSONArray("structure");

      for (int i=0; i < jArray.length(); i++) {
        JSONObject oneObject = jArray.getJSONObject(i);   
        leagues.add(oneObject.getString("league_website_name"));
        JSONArray DivisionsArray = oneObject.getJSONArray("divisions");

        for (int d=0; d < DivisionsArray.length(); d++){            
           JSONObject DivDict = DivisionsArray.getJSONObject(d);   
           leagues.add(DivDict.getString("name"));              
        }               
     }         

      setListAdapter ( new ArrayAdapter<String>(this, R.layout.single_item, 
                                                                    leagues));

      ListView list = getListView();
      list.setTextFilterEnabled(true);

    } catch (JSONException e) {
        e.printStackTrace();
    }     
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T15:53:11.030

“android 分段列表视图”的快速谷歌将返回结果，例如[http://w2davids.wordpress.com/android-sectioned-headers-in-listviews/](http://w2davids.wordpress.com/android-sectioned-headers-in-listviews/)

快速总结一下，尽管您最终编写了一个列表适配器，该适配器在需要时返回标题布局，并在需要时返回行布局。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-03-30T17:47:30.350

正确的答案是根本不支持该部分。你必须伪造它们。

# git - 如何检测强制更新

> ID：10319110
> 
> 赞同：16
> 
> 时间：2012-04-25T15:47:15.667
> 
> 标签：git

当遥控器上的分支历史发生变化时，您通常会得到

```
o git@git.server.com:XXXXX/Project.git
 + efe2e8b...cda0ee7 HEAD -> Ant_Config_processing (forced update) 
```

有没有办法使用脚本来获得这个（强制更新）状态？

这个想法是编写一个别名来检测它并提示用户采取行动。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-04T07:36:01.447

我有一个类似的问题，我想通了。

我想检测远程（裸）存储库中的钩子脚本中的强制更新，所以我的答案可能不适合原始问题，但我希望对未来的访问者有用。

* * *

# 如何在 Git hooks 脚本中检测是否强制更新

[https://github.com/kyanny/git-hooks-detect-force-update](https://github.com/kyanny/git-hooks-detect-force-update)

这是一个示例 git pre-receive 钩子脚本，用于学习如何检测强制更新。

## 结论

```
$ git rev-list oldrev ^newrev 
```

## 如何测试

```
$ rake -T
rake forced_push  # git hooks test detect forced update
rake normal_push  # git hooks test 
```

## 分步介绍

[首先，我描述了git-rev-list(1)](http://git-scm.com/docs/git-rev-list)的语法。

在这种情况下，我们假设在具有此直接历史的 Git 工作存储库中。

```
1 --- 2 --- O --- X --- 3 --- 4 --- N 
```

的一般用法`git-rev-list`如下。

```
$ git rev-list N 
```

此命令将显示从提交 N 可到达的所有提交（注意：`git-rev-list`显示提交*逆时间顺序*）

`git-rev-list`接受多个参数。

```
$ git rev-list N O 
```

此命令将显示与 相同的输出`git rev-list N`，因为提交 O 是提交 N 的祖先。

然后，`git-rev-list`允许您从输出中排除提交。

```
$ git rev-list N ^O 
```

^O 表示排除 O 可达的提交，因此该命令将显示 N, 4, 3, X （注意：排除 O）

* * *

由于我们了解了`git-rev-list`，我描述了一个关于发生强制更新的案例。

在这种情况下，我们假设在具有这种复杂历史的 Git 工作存储库中。

```
* --- B --- * --- O ($oldrev)
       \
        * --- X --- * --- N ($newrev) 
```

1.  在老树中，我们有 4 个提交（*、B、*、O）并将它们推送到远程。
2.  我们从提交 B 签出一个新分支，它是新树。
3.  在新树中，我们有 4 个提交（*、X、*、N）并使用 --force 选项将它们推送到远程！

推送时，挂钩使用标准输入调用的预接收脚本。stdin 参数的格式在[githooks(5)](http://git-scm.com/docs/githooks)中有描述。

通常，我们从标准输入中提取两个提交对象 sha1 - oldrev 和 newrev。oldrev 是老树的*HEAD*，newrev 是*新树*的 HEAD 。

`git-rev-list`在这种情况下，我们可以通过输出检测强制推送。

`git rev-list oldrev ^newrev`显示可从 oldrev 访问但无法从 newrev 访问的提交。这表明提交*只存在于 old tree*。如果此命令显示任何提交，则旧树被新树替换，因此发生了强制更新。这就是我们想要的！

如果此命令显示没有提交，则新树已正常更新，因此不会发生强制更新。简单地。

## 也可以看看

*   [git-rev-list(1)](http://git-scm.com/docs/git-rev-list)
*   [Git 钩子示例：post-receive-email](http://git.gnus.org/gnus.git/hooks/post-receive-email)
*   [git - 如何检测强制更新 - 代码日志](https://stackoverflow.com/questions/10319110/how-to-detect-a-forced-update)
*   [githooks - 检测推送的 Git 钩子 --mirror - 代码日志](https://stackoverflow.com/questions/9210957/git-hook-to-detect-push-mirror)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-25T17:49:46.640

一种方法是使用`git reflog`，它会记录对分支的更改。

使用 reflog，您可以在 pull/fetch 之前获取您的分支指向的位置（如果它是脚本化的，我会使用 fetch，因为它不会自动合并）并检查该提交是否可以从新远程的“提示”访问分支。

使用 bash 你可以试试这个：

```
$ git rev-list remotename/branchname | grep $(git rev-parse remotename/branchname@{1})
$ echo $?
1 
```

如果它返回一个散列（或退出状态 0），则意味着它在分支历史记录中找到了我们之前的分支提示，因此这是一个快进合并。如果它什么都不返回（或退出状态 1），它被强制更新。

您可以检查`git reflog remotename/branchname`输出以查看分支名称是否得到强制更新。

```
$ git reflog remotename/branchname
dc2afab refs/remotes/remotename/branchname@{0}: fetch rewrite: forced-update
4603c2c refs/remotes/remotename/branchname@{1}: fetch rewrite: forced-update 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T22:32:05.883

You can use `git-merge-base` command, it finds nearest common ancestor for two commits.

For fast-forward update, common ancestor for `oldrev` and `newrev` must point to `oldrev`. Sample code to be put into pre-receive hook to block non fast-forward:

```
mergebase=`git merge-base $oldrev $newrev`
if [ "$oldrev" != "$mergebase" ]; then
  echo "Non fast-forward update not allowed for $refname, from ${oldrev:0:16} to ${newrev:0:16} merge base ${mergebase:0:16}"
  exit 1
fi 
```

# java - BigDecimal 错误

> ID：10319112
> 
> 赞同：2
> 
> 时间：2012-04-25T15:47:17.937
> 
> 标签：java

有人可以说我哪里有问题吗？

```
double interval;
         BigDecimal diff = BigDecimal.valueOf(17);
         int n=39;
         BigDecimal N = BigDecimal.valueOf(n);
         interval = diff.divide(N).doubleValue();//line26

         System.out.println(interval); 
```

我有这个错误

```
Exception in thread "main" java.lang.ArithmeticException: Non-terminating decimal expansion; no exact representable decimal result.
    at java.math.BigDecimal.divide(BigDecimal.java:1603)
    at newlogoot.class.main(class.java:26)
Java Result: 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T15:50:13.920

问题是除法的结果是一个非终止十进制数，它不能按`BigDecimal`原样完全表示（因为这需要无限量的内存）。

因此，您需要使用 的两个（或三个）参数版本来限制其小数位数[`BigDecimal.divide`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#divide%28java.math.BigDecimal,%20int,%20java.math.RoundingMode%29)，例如

```
 interval = diff.divide(N, 3, RoundingMode.HALF_DOWN).doubleValue();//line26 
```

（这会将结果四舍五入为 3 位小数。）

# ios - 为什么只有一名代表？

> ID：10319113
> 
> 赞同：3
> 
> 时间：2012-04-25T15:47:24.120
> 
> 标签：ios, objective-c, cocoa-touch

我读过一个对象一次只能有一个委托。但这是真的吗？

假设我使用协议制作了一个对象，并且我想从该对象中收集来自其他几个对象的大量数据。我将每个符合我的协议的对象添加到一个数组中。然后我只是循环遍历它并在每个委托上调用我的方法。

```
NSMutableArray *collectFromDelegates = [NSMutableArray alloc]init];

//in delegateArray I keep pointers to every delegate.
for(id delegate in delegateArray){
  [collectFromDelegates addObject:[delegate someProtocolMethod]];
} 
```

这是错的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T16:00:03.207

那不是真正的[代表团](https://developer.apple.com/library/ios/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html)。

> 委托是一种简单而强大的模式，其中程序中的一个对象代表另一个对象或与另一个对象协作。委托对象保留对另一个对象（委托）的引用，并在适当的时间向它发送消息。该消息通知委托对象将要处理或刚刚处理的事件的委托。

让多个对象为您处理一个事件没有多大意义，因为它已经被处理过了。我可以看到有多个委托的唯一原因是，如果第一个未能处理事件，它可以传递给下一个，一直持续到某个对象处理它为止。

在您的示例中，对象充当数据源。这比多个委托更有意义，但可以通过让单个数据源组合来自多个对象的数据来轻松实现，这意味着请求数据的对象不必担心如何组合它。

您经常需要多个对象的另一种情况是接收事件通知。这不是委托，因为对象不为对象工作，只是对对象发生的事情起作用。使用通知或观察可以更好地实现这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T15:52:34.147

Apple 的惯例是只有一个“委托”对象。但是如果你需要的话，你可以设置你自己的类来拥有一个代表数组。为了清楚起见，您可能想将它们称为其他名称。

在您的示例中，将它们称为“数据源”可能更合适。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T15:55:39.890

一个班级实际上只需要一个代表，如果你有多个代表，那么你正在解决一个不同的问题。委托模式用于修改类的行为。例如，我们有一个可以吠叫的 Dog 类，但是不同类型的狗以不同的方式吠叫。代表将是改变吠叫行为的一种方式。

如果你需要不止一个，你可能对观察你的班级在做什么更感兴趣，它需要通知其他人当前的事件。由于其他几个类可能对一个类的行为感兴趣，因此您需要一个数组。在 iOS SDK 中，这已经为您完成了通知。这称为观察者模式。

不同的用例...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T16:05:15.640

> 我读过一个对象一次只能有一个委托。但这是真的吗？

你在哪里读到的？不，这不是真的。例如，`UITableView`有两个委托，一个提供数据，另一个处理动作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T15:53:31.110

委托只是一个抽象概念——您可以拥有任意数量的委托。但是，这很少需要，而且通常是一种糟糕的模式。

苹果很好地利用了a`source`和`delegate`模式。源 ivars（委托的一种形式）提供数据，而委托 ivars 被调用以进行逻辑响应。也许这是一个更好的解决方案？

或者，您可以使用`NSNotification`通知多个侦听器单个事件。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T15:51:03.780

通常，当您想向多个对您的班级所做的事情感兴趣的班级发送消息时，您会使用`NSNotification`s. 但是，除非您允许他们向通知发送消息，否则这将不允许他们返回数据`object`。我不确定这是否是一个更清洁的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-25T15:55:02.230

除了提到的通知之外，一种方法可能是，您的委托实现包含一个符合协议的对象数组，并在其上调用协议方法作为包装器。

# vb.net - 如何在 VB.NET 中将事件处理程序添加到局部变量

> ID：10319121
> 
> 赞同：6
> 
> 时间：2012-04-25T15:47:42.620
> 
> 标签：vb.net, event-handling, local-variables

我在 VB.NET 中有一个用作主窗体中的对话框的窗体。它的实例总是在本地定义的，它没有字段。当用户单击对话框中的“确定”按钮时，它将触发一个带有唯一参数的事件，即我的一个类的实例。

由于它始终是局部变量，我如何为该事件添加事件处理程序？我已经搜索了自己并找到了一些东西，但我真的无法弄清楚......

事件代码，中的一个字段`MyDialog`：

```
public Event ObjectCreated(ByRef newMyObject as MyObject) 
```

调用对话框的主窗体的代码：（不要介意语法）

```
Dim dialog As New MyDialog()
dialog.ShowDialog(Me)
AddHandler ObjectCreated, (what do I put here?) //Or how do I add a handler? 
```

如您所见，我一直坚持如何为我的事件添加处理程序。谁能帮我？最好用最好的方法来做到这一点......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T16:04:52.490

为保持一致性，建议您使用与所有系统事件处理程序相同的源和事件参数模型。

创建您自己的继承自 EventArgs 的类，如下所示：

```
Public Class MyObjectEventArgs
    Inherits EventArgs

    Public Property EventObject As MyObject

End Class 
```

然后声明您的事件和处理程序方法，例如：

```
Public Event ObjectCreated As EventHandler(Of MyObjectEventArgs)

Private Sub Container_ObjectCreated(ByVal sender As Object, ByVal e As MyObjectEventArgs)
    ' Handler code here
End Sub 
```

然后使用以下方法将处理程序附加到您的事件：

```
AddHandler ObjectCreated, AddressOf Container_ObjectCreated 
```

此外，您可以使用`Handles`附加到从主窗体引发的事件（假设名称为 MainForm），如下所示：

```
Private Sub MainForm_ObjectCreated(ByVal sender As Object, ByVal e As MyObjectEventArgs) Handles MainForm.ObjectCreated
    ' Handler code here
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:14:28.747

您需要编写事件生成时实际执行的子程序：

```
public Sub OnObjectCreated(ByRef newMyObject as MyObject)
   ...
End Sub 
```

然后添加处理程序：

```
AddHandler ObjectCreated, AddressOf OnObjectCreated 
```

作为旁注，ByRef 在这里什么都不做。VB 中的所有对象都是通过引用传递的。默认情况下，只有原始变量（字符串、整数等）使用 ByVal 并且可以设置为 ByRef

# python - PYTHON - 比较两个不同的文件；如果包含 ID 的行已存在，则更新 else 追加该行

> ID：10319123
> 
> 赞同：0
> 
> 时间：2012-04-25T15:47:54.040
> 
> 标签：python

我有一个将不断更新的主文件和一个每分钟创建的文件。我希望能够将每分钟创建的新文件与现有的主文件进行比较。到目前为止，我有：

```
with open("jobs") as a:
   new = a.readlines()

count=0
for item in new:
   new[count]=new[count].split(",")
   count+=1 
```

这将允许我比较我的主文件中每一行的第一个索引（[0]。现在我开始困惑自己。我猜它会是这样的：

```
counter=0
for item in new:
    if new[counter][0] not in master:
        end = open("end","a")
        end.write(str(new[counter]) + "\n")
        counter+=1
        end.close()
    else:
         REPLACE LINES THAT ALREADY EXIST IN MASTER FILE WITH NEW LINE 
```

每次新文件进入时，ID 的顺序不一定相同，并且新文件在某些​​时候可能包含比主文件更多的条目。

如果我没有理解或遗漏了一些信息，请告诉我，我会尽力澄清。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:11:36.743

听起来`csv`对我来说是个问题。

不幸的是，您的问题并不清楚，如果您想修改主文件本身、输出文件或两者兼而有之。这是第二个（它需要一个主文件和一个更新文件，都是 csv 格式，并将未排序的合并内容打印到一个输出文件）。如果这不是您想要的，或者如果您使用逗号分隔数据，但顶部没有字段名，那么根据需要进行更改应该很容易。

```
import csv
with open("master.csv") as m, open("update.csv") as u, open("out.csv", "w") as o:
    master = { line['ID']: line for line in csv.DictReader(m) }
    update = { line['ID']: line for line in csv.DictReader(u) }
    master.update(update)
    fields = csv.DictReader(open("master.csv")).fieldnames
    out = csv.DictWriter(o, fields)
    out.writeheader()
    out.writerows(master.values()) 
```

与 master.csv 一样：

```
ID,Name,Foo,Bar,Baz,Description
1000001,Name here:1,1001,1,description here
1000002,Name here:2,1002,2,description here
1000003,Name here:3,1003,3,description here
1000004,Name here:4,1004,4,description here
1000005,Name here:5,1005,5,description here
1000006,Name here:6,1006,6,description here
1000007,Name here:7,1007,7,description here
1000008,Name here:8,1008,8,description here
1000009,Name here:9,1009,9,description here 
```

和 update.csv 这样：

```
ID,Name,Foo,Bar,Baz,Description
1000003,UPDATED Name here:3,1003,3, UPDATED description here
1000010,NEW ITEM Name here:9,1009,9,NEW ITEM description here 
```

它输出到 out.csv：

```
ID,Name,Foo,Bar,Baz,Description
1000010,NEW ITEM Name here:9,1009,9,NEW ITEM description here ,
1000008,Name here:8,1008,8,description here,
1000009,Name here:9,1009,9,description here,
1000006,Name here:6,1006,6,description here,
1000007,Name here:7,1007,7,description here,
1000004,Name here:4,1004,4,description here,
1000005,Name here:5,1005,5,description here,
1000002,Name here:2,1002,2,description here,
1000003,UPDATED Name here:3,1003,3, UPDATED description here,
1000001,Name here:1,1001,1,description here, 
```

请注意，订单*不会*保留（如有必要，从问题中不清楚）。但它又快又干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:19:16.787

也许这样的事情会起作用：

```
#First create a set of all the ids contained in a masterfile
master_set = set()
with open('masterfile.txt') as mf:

    for ele in mf:
        master_set.add(ele.split(',')[0])

#if id is not in masterfile (or set) append the line to masterfile
with open('tempfile.txt') as temp, open('masterfile.txt', 'a') as mf:
    for line in temp:
        index = line.split(',')[0]
        if not index in master_set:
            master_set.add(index)
            mf.write(line) 
```

我还没有测试过。

# switch-statement - C++ 中的 SWITCH 语句与 IF ELSE IF 语句

> ID：10319125
> 
> 赞同：3
> 
> 时间：2012-04-25T15:47:54.743
> 
> 标签：switch-statement, case, if-statement

我在这里有技术上的疑惑，switch语句执行得更快，我知道的那件事

但我想知道的是它如何比 if & else if 执行得更快？

它如何直接在所有案例中找到 controlExpression 合适的案例？

如果我认为它是使用 if else if 编写的，如果它自己运行并找到合适的案例，那么它不应该执行得更快，它的性能与 if else if 相同？

所以你能回答我吗？提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:44:10.093

一条`switch`语句基本上对每种情况执行相同类型的比较：`var == a`、`var == b`、`var == c`等。

[此页面详细介绍了编译器如何将其转换为程序集](http://www.eventhelix.com/realtimemantra/basics/CToAssemblyTranslation3.htm)，但基本上有三种“类型”的 switch 语句：

1.  **`switch`具有连续`case`整数**的语句- 例如`case 3: ... case 4: ... case 5: ...`. 在这些情况下，编译器可以创建一个跳转表——在一个连续的内存块中跳转到的地址列表，并且只计算偏移量、找到地址并跳转。这可能比`if-else if`类型链更快。（当然，如果只有一种情况，会稍微慢一点。）
2.  **`switch`带有看似随机`case`整数**的语句- 例如`case 12: ... case 106: ... case 9: ...`. 在这些情况下，编译器只会构建一个`if-else if`链，因此它不会比`if-else if`代码类型更快。
3.  **`switch`带有大量看似随机`case`整数**的语句- 如果有一个重要的数字，一些编译器将为所有情况构建一个二叉搜索树，因此您有`O(log(n))`时间执行任何特定的分支，这应该会提高代码的性能。（这取决于您正在编译的架构，因为检查您应该遵循哪个树的分支或现在是否应该跳转会产生额外的开销。）

在这种情况下，您有时可以比编译器更聪明：如果您知道您的情况只能通过某个等式匹配，例如`3x+5`，那么您可以构建一个函数指针数组，计算索引 ( `(caseNum - 5) / 3`)，然后执行它继续 -传递风格（或者，如果你想让人们发疯，做同样的计算并构建一个`goto`标签数组，然后跳转意大利面条风格。无论哪种方式，你都会得到具有`O(1)`分支时间的最佳“连续案例”风格的装配。

# java - Spring MVC - 没有 DAO 服务层，如何获取当前会话以进行条件查询

> ID：10319127
> 
> 赞同：1
> 
> 时间：2012-04-25T15:47:57.453
> 
> 标签：java, spring, hibernate, spring-mvc, hibernate-criteria

我在 Spring MVC 项目中没有 DAO 服务层。在我的控制器中，我希望创建一个条件查询。为此，我需要一个会话对象来调用“createCriteria(myClass.class)”。

如何获取会话对象？

我看到有些人在使用 HibernateUtil 类，例如“HibernateUtil.currentSession()”。我试过这个，但导入无法解决。我在这里发布了一些相关代码来解决另一个问题[Hibernate criteria queries - Query Conditions](https://stackoverflow.com/questions/10234133/hibernate-criteria-queries-query-conditions)

有人可以在这方面提供某种形式的指导吗，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:10:59.330

HibernateUtil 是一个你应该根据自己的需要创建的类。这是[相应的文档部分](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#tutorial-firstapp-helpers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:18:15.457

我会看一下 dispatcher-servlet.xml。会话（休眠）、tx 管理器在上下文中设置以供以后访问。旧的 2.5 示例 .. [http://static.springsource.org/spring/docs/2.5.x/reference/orm.html](http://static.springsource.org/spring/docs/2.5.x/reference/orm.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:18:44.790

`HibernateUtil`是 Hibernate 教程中的一个类。这*不是真正的用途*。请勿将其用于教程以外的任何内容。如果您已经在使用 Spring，它具有[出色的 Hibernate 集成](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/orm.html#orm-hibernate)。从一开始就以正确的方式去做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T18:50:13.650

好的，通过使用父实体类中暴露的实体管理器解决了问题。我有一个名为 person 的类，其中放置了一个临时方法，如下所示

```
@Transient
public static Collection<?> searchResults(JsonJqgridSearchModel jsonJqgridSearchModel){
    HibernateEntityManager hem = Person.entityManager().unwrap(HibernateEntityManager.class);
    Session session = hem.getSession();
    Criteria criteria = session.createCriteria(Person.class);
    Iterator<JqgridSearchCriteria> iterator = jsonJqgridSearchModel.rules.iterator();
        while(iterator.hasNext()){  
            criteria.add(iterator.next().getRestriction());
        }
    return criteria.list();     
} 
```

主要是 HibernateEntityManager 和 Session 是如何获得的。希望这可以帮助那里的人。

# c# - 如何在预构建事件中将源文件 (.cs) 添加到资源 (.resx)？

> ID：10319128
> 
> 赞同：4
> 
> 时间：2012-04-25T15:47:58.163
> 
> 标签：c#, visual-studio, embedded-resource, pre-build-event

这很简单，甚至可能吗？

**为什么**：根据我的[另一个问题](https://stackoverflow.com/questions/9608064/is-it-possible-to-return-the-code-of-a-method-as-a-string-using-delegates-in-c)并使用[这种方法](https://stackoverflow.com/a/9608522/309561)，现在我想简单地将源文件嵌入到资源中，以便在应用程序运行时将其复制到临时文件夹 - 并将应用程序保留为单个文件。

我认为使用预构建事件是最好的方法。如果是这样，它会怎么做？

**编辑**：我问的是在构建之前添加它，因为我还假设如果我手动添加一次然后在之后更改代码，它不会自动更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:56:16.903

我最近在为 .NET 控件开发示例套件时遇到了[同样的问题，该控件必须在应用程序中显示其自己的示例源代码。](https://stackoverflow.com/questions/10073600/silverlight-msbuild-task-execute-command-line-after-xap-copied-to-clientbin)

我最终采用的方法如下。

1.  我创建了一个批处理脚本（在预构建中运行）将 /Examples/* 下的所有代码文件复制到解决方案 Resources/ExamplesSrc/* 中的另一个文件夹

2.  然后，我将所有这些文件包含在 csproj 中的 Resources/ExamplesSrc/* 下并保存。

3.  下一步是我将 Resources/ExamplesSrc/* 下的所有文件设置为嵌入式资源并将更改提交给 SVN。我没有将示例（生成）提交给 SVN，只是修改后的 csproj 和批处理文件。

开发人员签出时的效果是他们在所有资源上都有（！）图标（它们不在磁盘上，但 csproj 正在寻找它们），但是一旦他们构建生成的文件就会出现并且一切都很好。这种方法也适用于构建服务器（Team city），示例套件现在可以通过嵌入式资源加载和浏览自己的代码。

您应该注意的一个警告。VS2010 中有一个怪癖（显然是设计使然）。如果嵌入式资源中包含“.cs”（即任何代码文件！），则无法使用 Assembly.GetManifestResourceStream() 从程序集中加载它。为了解决这个问题，在批量复制步骤中将所有源文件从 *.Xaml.cs 重命名为 *.Xaml.c.txt，从 *.cs 重命名为 *.c.txt

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T02:05:12.267

事实证明，每次构建解决方案时，我都不需要（重新）添加源文件！

当我手动添加它成为资源上的“文本”文件时 - 我可以使用（具有名为“SourceCode.cs”的文件）轻松地将其***作为字符串访问。***`Properties.Resources.SourceCode`是的，它会自动更新，因为资源属性“持久性”：文件在编译时链接。

# jquery - 按钮单击事件未在 asp.net 中触发

> ID：10319131
> 
> 赞同：0
> 
> 时间：2012-04-25T15:48:10.380
> 
> 标签：jquery, asp.net, .net, ajax

我是一个工作实习的谦虚学生，我继承了一个“半成品”的应用程序。它是用 C#（完全没有经验）.NET（一点经验）编写的，使用 AJAX（没有经验）和 Jquery（一点经验）。我写了一个小方法来从网页中获取文本并将其解析为文本文档。我希望它在用户推送“发布”时触发。

按钮不会触发。我在我的“btnPublish_Click”处理程序中放置了一个断点，它甚至没有到达它。

我已经注册了按钮单击事件（我读到您需要在 C# 中执行此操作）：

```
namespace MaintainTenderFiles.ajax
{
    public partial class publish : TendersPage
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (Page.IsPostBack == false)
            {
                loadPendingTenders();
                preloadTender();
                btnPublish.Click += new EventHandler(this.btnPublish_Click);
            }
            else
            {
               //more code 
```

然后对点击事件进行编码：

```
 public void btnPublish_Click(object sender, EventArgs e)
    {
        String script = "alert('Clicked!!!');";
        ScriptManager.RegisterStartupScript(this.Page, this.GetType(),
 "alertScript", script, true);
    } 
```

当我单击该按钮时，所发生的一切就是将我带到一个名为“已发布”的页面。

为什么我不能让事件触发？

编辑**

显然忘记包含标记页面中按钮的代码：

```
 <asp:Button ID="btnPublish" OnClick="btnPublish_Click" 
  CssClass="ui-state-default ui-corner-all" runat="server" 
  Text="Publish" CausesValidation="False" UseSubmitBehavior="False" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:59:04.707

移动按钮事件寄存器，以便记录每次加载。

```
namespace MaintainTenderFiles.ajax
{
    public partial class publish : TendersPage
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            btnPublish.Click += new EventHandler(this.btnPublish_Click);
            if (Page.IsPostBack == false)
            {
                loadPendingTenders();
                preloadTender();

            }
            else
            { 
```

# c# - 有趣的财产行为

> ID：10319135
> 
> 赞同：5
> 
> 时间：2012-04-25T15:48:26.567
> 
> 标签：c#, .net, vb.net

任何人都知道为什么这不起作用（C# 或 VB.NET 或其他 .NET 语言无关紧要）。这是我的问题的一个非常简化的例子（对不起 VB.NET）：

```
 Private itsCustomTextFormatter As String
    Public Property CustomTextFormatter As String
        Get
            If itsCustomTextFormatter Is Nothing Then CustomTextFormatter = Nothing  'thinking this should go into the setter - strangely it does not'
            Return itsCustomTextFormatter
        End Get
        Set(ByVal value As String)
            If value Is Nothing Then
                value = "Something"
            End If
            itsCustomTextFormatter = value
        End Set
    End Property 
```

如果你这样做：

```
Dim myObj as new MyClass
Console.WriteLine(myObj.CustomTextFormatter) 
```

你会对结果感到惊讶。它将打印“无”。任何人都知道为什么它不打印“某事”

这是每个建议的单元测试：

```
Imports NUnit.Framework

<TestFixture()> _
Public Class Test
   Private itsCustomTextFormatter As String
    Public Property CustomTextFormatter As String
        Get
            If itsCustomTextFormatter Is Nothing Then CustomTextFormatter = Nothing 'thinking this should go into the setter - strangely it does not' 
            Return itsCustomTextFormatter
        End Get
        Set(ByVal value As String)
            If value Is Nothing Then
                value = "Something"
            End If
            itsCustomTextFormatter = value
        End Set
    End Property

    <Test()>
    Public Sub Test2()
        Assert.AreEqual("Something", CustomTextFormatter)
    End Sub
End Class 
```

这将返回：

```
Test2 : Failed  
  Expected: "Something"
  But was:  null

at NUnit.Framework.Assert.That(Object actual, IResolveConstraint expression, String message, Object[] args)
at NUnit.Framework.Assert.AreEqual(Object expected, Object actual) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-25T16:10:43.030

你的评论：

```
'thinking this should go into the setter - strangely it does not' 
```

指出你的错误是什么。在 Visual Basic 中，有两种方法可以从函数中返回内容：

```
Function GetSomeValue() As String
    Return "Hello"
End Function 
```

或者

```
Function GetSomeValue() As String
    GetSomeValue = "Hello"
End Function 
```

混合这两种风格是完全合法的，但令人困惑和不好的做法：

```
Function GetSomeValue() As String
    GetSomeValue = "Hello" ' I should return Hello... '
    Return "GoodBye"       ' ...or perhaps not. '
End Function 
```

如您所见，您在 getter 中混合了两种样式。**设置该变量不会调用设置器；它通知运行时当 getter 返回时，这是它应该返回的值。**然后，您用您的`Return`语句覆盖该值。

如果你这样做时很痛，那就*不要那样做*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-25T15:55:42.660

在单元测试中对我来说很好；尽管在 C# 中（见下文）。

*（玩了一段时间后）*

啊明白了！这是因为您正在调用`CustomTextFormatter = Nothing`which，在 Getter 的范围内实际上只是设置封闭访问器方法的返回值 - 它实际上并没有触发 setter（如果您在 setter 中放置断点，您将看到并调试它）会看到它直接越过它）。

基本上你*真的*不应该做这种模式。这不是返回默认属性值的方法。这会更好（或使用与 C#`??`运算符等效的任何东西）：

```
Public Property CustomTextFormatter As String
    Get
        If itsCustomTextFormatter Is Nothing Then
            Return "Something"
        End If
        Return itsCustomTextFormatter

    End Get
    Set(ByVal value As String)
        itsCustomTextFormatter = value
    End Set
End Property 
```

*原始 C# 测试*

```
 private string _foo;
    private string foo
    {
        get
        {
            if (_foo == null)
                foo = null;
            return _foo;
        }
        set
        {
            if (value == null)
                value = "Something";
            _foo = value;
        }
    }

    [TestMethod]
    public void Test()
    {
        Assert.AreEqual("Something", foo);
    } 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-25T15:54:03.960

因为您从未真正初始化变量。您必须将属性“设置”为空才能真正获得“某物”。要修复它，您可能应该在声明内部变量时设置默认值

```
Private itsCustomTextFormatter As String = "Something" 
```

# java - 正则表达式限制为一个分号

> ID：10319136
> 
> 赞同：0
> 
> 时间：2012-04-25T15:48:30.113
> 
> 标签：java, regex

我正在制作一个代码，它需要一个文件并检查它是否是有效的 Java 代码，必须使用正则表达式来完成。

我遍历每一行并检查它是否以 ; 或 { 或 }。但是，我似乎无法将其限制为仅出现 1 次。即两者

```
int i=0; 
```

和

```
int i=0 ;;;;;;; 
```

会通过..我现在使用的正则表达式是

```
.+;{1}\\s*$ 
```

尝试了许多其他选项，似乎没有工作。任何帮助都会很棒！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:06:32.367

您的问题是 也`.`将匹配分号，因此您的表达式将匹配除最后一个分号之外的所有内容作为`.+`.

为避免这种情况，您可以使用 匹配*除*分号以外的任何字符`[^;]`。IE

```
[^;]+;\\s*$ 
```

但是，您应该知道这`int i=0 ;;;;;;;;;`是完全有效的 Java 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:01:16.377

如果要确保整行中只有一个分号，请使用：

```
^[^;]+;{1}\\s*$ 
```

然而，这不是对有效 java 源的正确检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:02:24.183

正则表达式的这一部分：`.+`将匹配任何字符，包括除最后一个之外的所有字符`;`。

您需要`;`从您的正则表达式的第一部分中排除，以便您可以匹配“除 a 之外的任何内容；后跟恰好一个；” （一旦你开始工作，你可以扩展你的角色类来捕捉 { 和 } 如果你愿意）

高温高压

# dapper - 有没有办法在 Dapper 中同时使用 MultiMapping 和 QueryMultiple？

> ID：10319140
> 
> 赞同：8
> 
> 时间：2012-04-25T15:48:45.273
> 
> 标签：dapper

我有一些查询需要一起运行，我可以使用*QueryMultiple*功能来完成。

但在这种情况下，我无法找出如何使用*MultiMapping*。

有谁知道实现这一目标的方法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-05T12:23:00.453

我认为这就是您正在寻找的内容，尽管如果没有您尝试执行的查询示例就很难判断。

```
var sql = @"Select * 
            From Parent 
            Left Join Child on Child.ParentID = Parent.ParentID 
            Where Parent.ParentID = @id
            ... more queries";

using(var reader = connection.QueryMultiple(sql, new {id=selectedId}))
{
    var stuff = reader.Read<Parent, Child, Parent>(
        (p,c)=> 
        {
            p.Child = c;
            return p;
        }, splitOn: "ChildId").Single();
    // Continue to read from the other queries in your sql.
} 
```

基本上的`Read`方法`SqlMapper.GridReader`类似于`Query`扩展方法。您只能获得`splitOn`具有两个以上泛型类型的重载之一的参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T06:25:00.660

有一个来自另一个线程的快速示例：[how-to-get-values-for-child-objects](https://stackoverflow.com/a/10242703/1028323)

```
var sql = 
@"
select * from PROFILES where profileId= @id
select * from PROFILEIMAGES where OWNER_PROFILESIDFK = @id";

using (var multi = connection.QueryMultiple(sql, new {id=selectedId}))
{
   var profile = multi.Read<Models.PROFILE>().Single();
   profile.ProfileImages = multi.Read<Model.PROFILEIMAGES>().ToList();
} 
```

每个查询都会返回一组对象，然后可以将其映射到您的实体。

# jquery - jQuery 当所有元素都有一个类时做某事

> ID：10319141
> 
> 赞同：0
> 
> 时间：2012-04-25T15:48:45.767
> 
> 标签：jquery

我在一个页面上有任意数量的元素，可以选择一个类，例如

```
<div class="choice"></div>
<div class="choice"></div> 
```

当我运行一个函数时，它会在 div 中添加一个 done 类，因此它们变为：

```
<div class="choice done"></div> 
```

在每次运行时在同一个函数中，我将检查其中有多少选项具有 done 类，当它们都具有它时，我将运行另一个函数。

这是我到目前为止所做的：

```
function addDone(element) {

$num = 0;

$(element).addClass('done');

$('.choice').each(function() {
    if($(this).hasClass('done')) {
        $num + 1;
    }
});

if($num >= $('.choice').length) {
    alert('all done...');
}

} 
```

但是一旦我调用该函数，它就会运行警报......所以不能正常工作，关于问题是什么或更好的解决方案的任何想法？

**注意：在真正的应用程序中，每个选项都有一个 id，什么时候代替函数中使用的元素变量！**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T15:52:16.923

您可以将其改写为：

> 当没有元素有`choice`但没有时做某事`done`

在这种情况下，以下内容会更简洁一些：

```
if (!$(".choice").not(".done").length) {
    alert("all done");
} 
```

[工作小提琴](http://jsfiddle.net/stevegreatrex/NVHXm/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T15:57:37.767

```
$num + 1; 
```

应该是

```
$num = $num + 1; 
```

除此之外，可能还有其他人建议的更好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T15:54:11.513

```
if (!$(".choice:not(.done)").length)
    // do your magic here. 
```

# solr - 问答网站的 Solr 索引策略

> ID：10319145
> 
> 赞同：0
> 
> 时间：2012-04-25T15:49:14.577
> 
> 标签：solr, indexing

我对 Solr 很陌生，我想用它在我正在构建的问答网站（Quora 之类）上进行搜索。

以下是问题和回答者的方式：问题 - 标题 - 描述 - 标签（社交标签） - 分数（分数来自用户对问题的赞成/反对票）

答案 - 描述 - 标签 - 分数（分数来自用户对答案的赞成/反对票）

当然，您可以根据需要对问题有尽可能多的答案。

将有三种类型的文档需要被索引：问题、文章、...

就索引而言，使问题和答案可搜索的最佳策略是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:34:59.237

如果您使用的是[DataImportHandler](http://wiki.apache.org/solr/DataImportHandler)，您可以`<entity>`为问题设置一个子实体，然后为答案指定一个子实体。例如：

```
<document name="questions">
  <entity name="question" query="select id, question from questions">
    <field column="id" name="id" />
    <field column="question" name="question" />

    <entity name="answer" 
        query="select question_id, answer from answers"
        cacheKey="question_id"
        cacheLookup="question.id" 
        processor="CachedSqlEntityProcessor">
      <field name="answer" column="answer" />
    </entity>

  </entity>
</document> 
```

请注意，此示例使用[CachedSqlEntityProcessor](http://wiki.apache.org/solr/DataImportHandler#CachedSqlEntityProcessor)来避免不必要地访问数据库。

# c# - 使用 Silverlight 和 WCF 服务的两种方式绑定

> ID：10319146
> 
> 赞同：1
> 
> 时间：2012-04-25T15:49:16.577
> 
> 标签：c#, silverlight

为了简化问题，我有一个文本框控件，我想应用两种方式绑定。例如，我在服务器端有一个名为 Customer 的对象类，silverlight 应用程序显然是一个单独的项目。

```
public class Customer
{
    public string Name{ get; set; }
} 
```

在 WCF 服务中，我有查询填充客户名称，并返回客户类型的列表。

```
List<Customer> data = new List<Customer>(); 
```

然后在客户端我将它绑定到文本框控件：

```
<TextBox Canvas.Left="345" Canvas.Top="12" Height="23" Name="tb_customer" Width="120" Text="{Binding Path=Name}" />

List<ServiceReference.Customer> data = e.Result;
tb_customer.DataContext = data[0]; 
```

这工作正常，并将客户名称绑定到文本框控件。但我的问题是，当我在客户端更改值时，如何将修改后的客户名称发送回数据源，在本例中为 sqlserver 中名为客户的表。我需要在客户类上实现 INotifyPropertyChanged 吗？但是显然客户类是坐在服务器端的，所以我需要在客户端创建一个客户类的本地实例，然后通过 wcf 服务将这些更改上传回服务器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:43:52.687

像这样设置文本框：

```
<TextBox Canvas.Left="345" Canvas.Top="12" Height="23" Name="tb_customer" Width="120" Text="{Binding Path=Name, Mode=TwoWay}" /> 
```

使用此设置，对文本框值所做的更改将在本地自动更新*对象的状态。*然后，您必须将更改提交回数据存储。如果您使用的是诸如实体框架之类的 ORM，那很容易——只需调用`SubmitChanges()`您的上下文即可。如果您不使用 ORM，则必须手动处理更新。

# python - 调试时如何调用 Python 的列表？

> ID：10319147
> 
> 赞同：75
> 
> 时间：2012-04-25T15:49:21.430
> 
> 标签：python, debugging

我有以下python代码：

```
values = set([1, 2, 3, 4, 5])
import pdb
pdb.set_trace() 
```

我运行脚本，我在调试 shell 中：

```
(pdb) list(values)
*** Error in argument: '(values)'
(Pdb) 
```

如何`list(values)`在不调用调试器自己的`list`命令的情况下调用调试器？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-04-25T15:52:38.547

只是`print`它：

```
(Pdb) print list(values) 
```

不要忘记为 python3 版本添加括号

```
(Pdb) print(list(values)) 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2012-08-23T03:05:31.143

使用感叹号！转义调试器命令：

```
(Pdb) values = set([1, 2, 3, 4, 5])
(Pdb) list(values)
*** Error in argument: '(values)'
(Pdb) !list(values)
[1, 2, 3, 4, 5] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:04:20.533

蒂埃里，

由于该数据结构已经是一个序列，因此将其指定为列表是多余的。所以这会很好。

```
(Pdb) print values 
```

或者

```
(Pbd) print(values) 
```

如果您使用的是 Python3

* * *

可选的带有换行符的漂亮列表

```
(Pdb) for x in values:  print x 
```

或者

```
(Pdb) for x in values:  print(x) 
```

对于 Python3

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-04T00:27:32.427

通过键入 进入“交互模式” `interact`。

```
(Pdb) heros = ['Gecko', 'Catboy', 'Owlette']
(Pdb) list(heros)
*** Error in argument: '(heros)'
(Pdb) interact
*interactive*
>>> list(heros)
['Gecko', 'Catboy', 'Owlette'] 
```

“交互模式”还允许您处理名称与 PDB 命令冲突的变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-15T12:54:45.810

另一种有点骇人听闻的方法是输入：

```
lst=list 
```

在`pdb`提示下。接下来你可以写：

```
values = set([1, 2, 3, 4, 5])
lst(values) 
```

显然这不是推荐的答案。

# html - HTML中的自动行高调整

> ID：10319149
> 
> 赞同：0
> 
> 时间：2012-04-25T15:49:37.613
> 
> 标签：html, css

我想将我的文本包装在单元格内，以便所有单元格的宽度都相等。换行后不应隐藏文本。这是我的桌子-

```
<table border="2" width="20px">
<tr>
<td>testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest</td>
<td>test</td>
</tr>
<tr>
<td>test</td>
<td></td>
</tr>
</table> 
```

随着`wordwrap:break-word`，文本被隐藏。我也不想要滚动条。

我希望输出是[这样](http://www.imageurlhost.com/images/9knb492g6wk5x84o6r.png)的。

CSS如何实现这一点？为我指明正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T15:51:35.513

[http://jsfiddle.net/fekSg/](http://jsfiddle.net/fekSg/)。使用 fixed 进行表格布局，并使所有 td 元素换行

```
<style>
td {
word-wrap: break-word;
}
</style>
<table border="2" width="100px" style='table-layout:fixed;'>
<tr>
<td>testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest</td>
<td>test</td>
</tr>
<tr>
<td>test</td>
<td></td>
</tr>
</table> 
```

# java - JNA 使用 LPCWSTR 参数调用 C++ 函数

> ID：10319152
> 
> 赞同：4
> 
> 时间：2012-04-25T15:49:48.363
> 
> 标签：java, c++, unicode, jna

我已经完成了一个带有 unicode 字符串（LPCWSTR 类型）的函数的 C++ dll：

```
extern "C" __declspec( dllexport ) HRESULT signFile(LPCWSTR fileName, LPCWSTR certSubject, LPCWSTR storeName);

HRESULT signFile(LPCWSTR fileName, LPCWSTR certSubject, LPCWSTR storeName) 
```

我的一位同事正试图通过 JNA 调用它

使用String作为参数失败（调用了C++函数，但参数无效）

使用 WString 也失败了。

不幸的是，[JNA 映射](https://github.com/twall/jna/blob/master/www/Mappings.md)不引用 LPCWSTR 类型。

对此有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T09:07:02.557

`LPCWSTR`和的 JNI 等效项`LPWSTR`是`WString`.

Java 字符串映射到`char*`or`LPSTR`或`LPCSTR`，但我相信会以 UTF-8 结尾编码，因此仍然可以传递完整的字符集。

# garbage-collection - 使用 JVM GC args -XX:SurvivorRatio=8 不起作用

> ID：10319153
> 
> 赞同：5
> 
> 时间：2012-04-25T15:49:57.747
> 
> 标签：garbage-collection, jvm

我`java -Xms20m -Xmx20m -Xmn10m -XX:+PrintGCDetails -XX:SurvivorRatio=8 GCTest` 用来设置幸存率，但它不起作用！GCDetail 打印以下数据：

```
[GC [PSYoungGen: 7495K->144K(9216K)] 7495K->144K(19456K), 0.0010500 secs] [Times: user=0.01 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 7561K->120K(9216K)] 7561K->120K(19456K), 0.0007090 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 7344K->128K(9216K)] 7344K->128K(19456K), 0.0009420 secs] [Times: user=0.00 sys=0.00, real=0.01 secs] 
[GC [PSYoungGen: 7333K->128K(9216K)] 7333K->128K(19456K), 0.0004850 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 7320K->128K(9216K)] 7320K->128K(19456K), 0.0010080 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 7312K->128K(10048K)] 7312K->128K(20288K), 0.0009700 secs] [Times: user=0.00 sys=0.00, real=0.01 secs] 
[GC [PSYoungGen: 9356K->0K(10048K)] 9356K->116K(20288K), 0.0009580 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 9224K->0K(10048K)] 9340K->116K(20288K), 0.0003100 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 9221K->0K(10048K)] 9337K->116K(20288K), 0.0002790 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 9219K->0K(9920K)] 9335K->116K(20160K), 0.0004440 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 9218K->0K(9984K)] 9334K->116K(20224K), 0.0003780 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
[GC [PSYoungGen: 9218K->0K(9984K)] 9334K->116K(20224K), 0.0003980 secs] [Times: user=0.00 sys=0.00, real=0.00 secs] 
Heap
 PSYoungGen      total 9984K, used 5316K [0xb2e00000, 0xb3800000, 0xb3800000)
  eden space 9728K, 54% used [0xb2e00000,0xb3331300,0xb3780000)
  from space 256K, 0% used [0xb37c0000,0xb37c0000,0xb3800000)
  to   space 256K, 0% used [0xb3780000,0xb3780000,0xb37c0000)
 PSOldGen        total 10240K, used 116K [0xb2400000, 0xb2e00000, 0xb2e00000)
  object space 10240K, 1% used [0xb2400000,0xb241d060,0xb2e00000)
 PSPermGen       total 16384K, used 1759K [0xae400000, 0xaf400000, 0xb2400000)
  object space 16384K, 10% used [0xae400000,0xae5b7f70,0xaf400000) 
```

**“从”和“到”只有 256K，我应该是 1024K，伊甸园有 8192K** 我给错了参数吗？

java的版本是：

```
java version "1.6.0_27"
Java(TM) SE Runtime Environment (build 1.6.0_27-b07)
Java HotSpot(TM) Server VM (build 20.2-b06, mixed mode) 
```

操作系统：Ubuntu 11.10

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-25T04:22:15.470

`-XX:SurvivorRatio`除非您使用`-XX-UseAdaptiveSizePolicy`.

`UseAdaptiveSizePolicy`需要禁用，以便您可以自己设置幸存者空间的大小。

另请参阅解释所有参数的[Java Hotspot VM options](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)或[Java Performance book。](https://rads.stackoverflow.com/amzn/click/com/0137142528)

# c# - 在 GAC 中找不到应用程序正在使用的程序集

> ID：10319157
> 
> 赞同：0
> 
> 时间：2012-04-25T15:50:15.117
> 
> 标签：c#, asp.net, .net, gac

我需要更新我的应用程序正在使用的程序集。

它是一个网站应用程序，通过 web.config 中的这一行引用 GAC 中的程序集

```
<add assembly="dotnetCHARTING, Version=4.3.2721.21869, Culture=neutral, PublicKeyToken=AF2CD47DB69D93BD" /> 
```

但是我很困惑，我在 C:\Windows\assembly 或 C:\Windows\Microsoft.NET\Assembly 中找不到程序集

我什至试过这个工具，没有骰子。 [http://gacbrowser.blogspot.co.uk/2008/03/gac-browser-introduction.html](http://gacbrowser.blogspot.co.uk/2008/03/gac-browser-introduction.html)

我尝试通过公钥和程序集名称查看。

有任何想法吗？

（已编辑 - 将 web.config 行转换为代码示例）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:56:30.927

您是否尝试过使用 .NET [Fusion Logger](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.71%29.aspx)？它应该告诉您加载程序集的确切路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:49:13.683

您使用的是什么版本的 .Net？在 .Net4 中，GAC 的位置发生了变化。有关详细信息，请参阅此问题： [.NET 4.0 有一个新的 GAC，为什么？](https://stackoverflow.com/questions/2660355/net-4-0-has-a-new-gac-why)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:09:15.690

尝试使用进程资源管理器创建转储或迷你转储。它将显示您的应用程序正在使用的所有 dll。

# c# - 单击按钮：禁用和执行按钮的处理程序

> ID：10319158
> 
> 赞同：-1
> 
> 时间：2012-04-25T15:50:15.840
> 
> 标签：c#, asp.net

在 Button 的 Click 事件中，您可以禁用该按钮并调用其事件处理程序吗？

我试过这个：

```
protected void Button1_Click(object sender, EventArgs e)
{
    Button1.Enabled = false;
} 
```

这在 IE、Mozilla 或 Chrome 中不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:00:15.513

你可以尝试添加这个：

```
protected void Button1_Click(object sender, EventArgs e)
{
    // Do some stuff here

    Button1.Attributes.Add("onclick", "javascript:return false;");
    Button1.Enabled = false;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T15:55:56.817

```
<asp:Button ... OnClientClick="disableButton(this);" />

<script type="text/javascript">
function disableButton(button)
{
//need to delay a few ms so that the button posts back before being disabled
  var buttonToDisable = button;
  setTimeout("reallyDisableButton()"), 2);
}

function reallyDisableButton()
{
  buttonToDisable.disabled = true;
}
</script> 
```

我假设您的问题是人们多次单击一个按钮（因为页面需要一段时间才能加载），因此会多次启动该事件，而您只希望他们能够执行一次。这将在回发后禁用按钮，防止意外发送多个并发回发。

# jquery - Mouseover 更改出现的 div 的位置

> ID：10319164
> 
> 赞同：0
> 
> 时间：2012-04-25T15:50:41.793
> 
> 标签：jquery, css, tooltip

我在一个项目中使用这个 jQuery[这个工具提示。](http://www.queness.com/post/92/create-a-simple-cssjavascript-tooltip-with-jquery)

问题是当我有很多东西出现在隐藏的工具提示（div）中时。发生这种情况时，div 的高度会变大，无法放入屏幕，因此它会位于屏幕下方，并且无法读取 div 的某些部分。

我想让 div 出现在鼠标指针的中间，而不是指针的右下角。

那可能吗？

编辑：

这是 jQuery 代码

```
 /*=========================Tooltip NOT MINE===================================*/
    //Select all anchor tag with rel set to tooltip
$('a[rel=tooltip]').mouseover(function() {

    //Grab the title attribute's value and assign it to a variable
    var tip = $(this).attr('title');    

    //Remove the title attribute's to avoid the native tooltip from the browser
    $(this).attr('title','');

    //Append the tooltip template and its value
    $(this).append('<div id="tooltip"><div class="tipHeader"></div><div class="tipBody">' + tip + '</div><div class="tipFooter"></div></div>');     

    //Show the tooltip with faceIn effect

    $('#tooltip').fadeIn('1000');
    $('#tooltip').fadeTo('100',0.9);

}).mousemove(function(e) {

    //Keep changing the X and Y axis for the tooltip, thus, the tooltip move along with the mouse
    $('#tooltip').css('top', e.pageY + 10 );
    $('#tooltip').css('left', e.pageX + 20 );

}).mouseout(function() {

    //Put back the title attribute's value
    $(this).attr('title',$('.tipBody').html());

    //Remove the appended tooltip template
    $(this).children('div#tooltip').remove();

});
     /*=========================Tooltip END===================================*/ 
```

这就是我从数据库中获取工具提示中所有文本的方式

```
 echo "<p class='resultInfo'><a rel='tooltip' class='tip' 
   title='<p    class=title>Information: </p><p>
   <span class=title>Knowledge</span><span>". $resultData['Knowledge'] ."<span     class=title>Competence: </span><span>". 
   $resultData['Competence'] ."<span class=title>
   Skills: </span><span>". $resultData['Skills'] ."</span>'>"
   . $resultData["Level"] . "<span class='icon'></span></a></p>"; 
```

正如我上面所说，该脚本运行良好。唯一的问题是当回显输出有时很长并导致我的 div 工具提示在屏幕高度上扩展时。所以我想把 div 推到光标的中间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:16:51.427

经过大量搜索，我想我找到了

我改变了这段代码

```
.mousemove(function(e) {

    //Keep changing the X and Y axis for the tooltip, thus, the tooltip move along with the mouse
    $('#tooltip').css('top', e.pageY + 10 );
    $('#tooltip').css('left', e.pageX + 20 ); 
```

至

```
.mousemove(function(e) {

    //Keep changing the X and Y axis for the tooltip, thus, the tooltip move along with the mouse
    $('#tooltip').css('top', e.pageY - 100 );
    $('#tooltip').css('left', e.pageX + 20 ); 
```

不知道以后会不会出现一些奇怪的行为，我会测试一下。

# .net - 检查 .NET webbrowser 控件是否可以播放 flash

> ID：10319168
> 
> 赞同：0
> 
> 时间：2012-04-25T15:50:46.993
> 
> 标签：.net, flash, browser

在加载 Flash 页面后，我如何从代码中检查 webbrowser 控件是否可以播放 Flash 或显示损坏的图像？

想法是如果用户不能播放flash，应用程序应该用adobe flash player网站打开Internet explorer，这样用户就可以在IE中安装flash，并启用flash内容。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:59:45.627

由于 IE 中的 Flash 是一个 Active-X 控件，因此您可以使用应用程序本身的 C# 来查看是否可以使用 Flash 的 Class ID 实例化一个 COM 对象：

```
private bool IsFlashInstalled()
{
    object instance = null;
    try
    {
        var type = Type.GetTypeFromCLSID(new Guid("d27cdb6e-ae6d-11cf-96b8-444553540000"));
        instance = Activator.CreateInstance(type);
        return true;
    }
    catch (Exception)
    {
        return false;
    }
    finally
    {
        if (instance != null)
        {
            Marshal.FinalReleaseComObject(instance);
        }
    }
} 
```

您可能希望尽可能多地缓存结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T15:57:56.830

对于所有与 Flash 相关的需求，我建议使用[SWFObject](http://code.google.com/p/swfobject/) JavaScript 库。

教程：[“检测 Flash Player 版本并使用 SWFObject 2 嵌入 SWF 文件”](http://www.adobe.com/devnet/flashplayer/articles/swfobject.html)

# mysql - 使用 where 子句将单个值插入到列中

> ID：10319169
> 
> 赞同：6
> 
> 时间：2012-04-25T15:50:47.543
> 
> 标签：mysql, sql

我试图在两种情况下将“测试”插入到我的 MeetingNotes 列中，但对于我的一生，我无法让它发挥作用。是否有可能做到这一点？我是 sql 和 mysql 的初学者？提前致谢！

```
SELECT MeetingNotes
FROM Meeting
INSERT INTO MeetingNotes
VALUES ('testing')
WHERE MeetingProcessId = '1001' AND MeetingId = '25' 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-25T15:54:26.190

您想使用[UPDATE 查询](http://dev.mysql.com/doc/refman/5.5/en/update.html)来更改现有记录中的值。[INSERT 查询](http://dev.mysql.com/doc/refman/5.5/en/insert.html)严格*添加新记录*。

```
UPDATE Meeting
SET MeetingNotes = 'testing'
WHERE MeetingProcessId = '1001' AND MeetingId = '25' 
```

为了将来参考，我不确定为什么您的示例中有一个 SELECT 语句：不需要插入或更新记录。将新记录插入到会议表中（仅给出显示的三列）如下所示：

```
INSERT INTO Meeting (MeetingId, MeetingProcessId, MeetingNotes)
VALUES ('25', '1001', 'Notes about this very exciting meeting...') 
```

对此有几点说明：

*   由于 INSERT 语句向表中添加了一条全新的记录，因此无法应用列约束，因此它们不支持 WHERE 子句
*   如果`MeetingId`是数据库生成的自增记录 ID，则应该 / 必须在 INSERT 语句中省略
*   只有字符串 (CHAR/VARCHAR) 值出现在查询中时才应该被引用，而数值不应该被引用。因此，例如，如果 MeetingId 和 MeetingProcessId 是整数而不是字符串列，则应删除上述查询中`25`的引号`1001`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T15:55:13.903

你想要的可能是：

```
UPDATE Meeting SET MeetingNotes='testing' WHERE MeetingProcessID = '1001' AND MeetingId = '25'; 
```

# svn - 在詹金斯结帐期间排除目录

> ID：10319173
> 
> 赞同：7
> 
> 时间：2012-04-25T15:50:58.230
> 
> 标签：svn, build, jenkins, sparse-checkout

我在主干下有 20 个目录

```
/trunk/a1
/trunk/a2
/trun/a3
..
..
/trunk/a20 
```

如何在Jenkins结帐期间排除（不包括）一些（任意目录。例如，我想拥有除**/trunk/a3/b1**之外的所有目录。 如何做到这一点？

[我已经在SVN checkout ignore 文件夹](https://stackoverflow.com/questions/192824/svn-checkout-ignore-folder)中找到了答案，但这在 Jenkins 下是不可能的。需要一个更简单的解决方案，我不知道主干下的目录数量，除了我要排除的目录。

另外如何添加自定义 svn 结帐。假设我想执行 svn 命令行工具进行结帐？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-24T05:52:04.513

我知道这已经很晚了，但也许这很有用： [https ://issues.jenkins-ci.org/browse/JENKINS-25273](https://issues.jenkins-ci.org/browse/JENKINS-25273)

重要提示：此版本包含快速而肮脏的修复！在我们的测试中，它很稳定，没有错误，但为了避免出现问题，请在测试之前保存 Jenkins 环境。

安装：只需删除 Jenkins - plugin 文件夹中的 subversion 文件夹和文件，然后用票证中的 subversion.hpi 文件替换它们。您还必须在插件文件夹中创建一个名为 subversion.hpi.pinned 的空文件，以确保新插件不会被原始插件覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T20:39:05.947

由于您确实更新（而不是完成结帐），您可以执行以下操作：在初始结帐后转到您要忽略的目录并执行`svn up --set-depth=empty`. 后续更新不会更新目录。

# javascript - 带回一个“覆盖”的窗口方法

> ID：10319174
> 
> 赞同：2
> 
> 时间：2012-04-25T15:50:59.787
> 
> 标签：javascript

如果我将 window.alert 重置为其他功能，我有什么方法可以在不先“保存”它的情况下恢复它？

例如：

```
window.alert = function() { }; 
```

这样做之后，有没有办法将 window.alert() 恢复到以前的状态？（顺便说一句：仅针对“预定义”DHTML 对象询问此问题 - 不针对随机 js 对象）

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-25T15:55:17.533

您可以使用[`delete`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/delete)：

```
window.alert = function() { };
delete window.alert; 
```

这是一个[工作示例](http://jsfiddle.net/sKRYR/)。

# java - 类来计算变量设计问题

> ID：10319175
> 
> 赞同：2
> 
> 时间：2012-04-25T15:51:02.073
> 
> 标签：java

我是 OO 编程的新手，在设计我的程序以使用这些概念时遇到了一些麻烦。我已经完成了教程，但仍然有问题。

我有一个递归，它接受一个项目的值（在这个例子中可以是任何东西，股票）并计算出需要多少个项目才能等于一个特定的值（在这个代码中是 100）。这部分有效，但我想知道股票的权重是否超过阈值。最初，我使用一种执行 for 循环并计算整个值列表的方法来解决这个问题，但这非常低效，因为它在递归的每个循环上都执行此操作。我认为这将是尝试学习类的好时机，因为我可以使用类来维护状态信息并在每个循环上增加值，它会让我知道何时达到阈值。

我想我有代码，但我不完全理解如何用类设计这个问题。到目前为止，它在递归的每一步都运行循环，因为我最初是那里的班级。有没有更好的方法来设计这个？我的最终目标是在超过权重时收到通知（我已经可以做到），但我想以使用最少资源的方式进行（避免低效/不必要的循环）

代码（这是我用来学习的全部代码，但问题在于 Counter 类及其在 findVariables 方法中的位置）：

```
import java.util.Arrays;

public class LearningClassCounting {

    public static int[] stock_price = new int[]{ 20,5,20};
    public static int target = 100;

    public static void main(String[] args) {
        // takes items from the first list
        findVariables(stock_price, 100, new int[] {0,0,0}, 0, 0);
    }

    public static void findVariables(int[] constants, int sum, 
            int[] variables, int n, int result) {
        Counter Checker = new Counter(stock_price, variables);
        if (n == constants.length) { 
            if (result == sum) {
                System.out.println(Arrays.toString(variables));
            }
        } else if (result <= sum){ //keep going
            for (int i = 0; i <= 100; i++) {
                variables[n] = i;
                Checker.check_total_percent(n, i);
                findVariables(constants, sum, variables, n+1, result+constants[n]*i);
            }
        }
    }

}

class Counter {
    private int[] stock_price;
    private int[] variables;
    private int value_so_far;
    public Counter(int[] stock_price, int[] variables) {
        this.stock_price = stock_price;
        this.variables = variables; 
        for (int location = 0; location < variables.length; location++) {
            //System.out.println(variables[location]  + " * " + stock_price[location] + " = " + (variables[location] * stock_price[location]) );
            value_so_far = value_so_far + (variables[location] * stock_price[location]);
        }
        //System.out.println("Total value so far is " + value_so_far);
        //System.out.println("************");
    } 

    public  void check_total_percent(int current_location, int percent) {
        // Check to see if weight exceeds threshold
        //System.out.println("we are at " + current_location + " and " + percent + " and " + Arrays.toString(variables));
        //System.out.println("value is " + stock_price[current_location] * percent);
        //formula I think I need to use is:
        if (percent == 0) {
            return;
        }
        int current_value = (stock_price[current_location] * percent);
        int overall_percent = current_value/(value_so_far + current_value);
        if (overall_percent > 50 ) {
            System.out.println("item " + current_location + " is over 50%" );
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:00:36.543

你所描述的听起来像是著名的[背包](http://en.wikipedia.org/wiki/Knapsack_problem)问题的变体。有许多方法可以解决这些问题，这些方法本质上是难以计算的。

本质上，可能需要检查“所有组合”。所谓的优化来自于当某个选择子集已经太大时的回溯（例如，如果给定的10只股票超过我的总和，则无需探索其他组合）。此外，可以缓存某些子集（例如，如果我知道 XY 和 Z 等于某个值 V，我可以重用该值）。你会看到很多关于如何解决这类问题以及如何设计解决方案的讨论。

话虽如此，我的观点是，虽然这类算法问题对于学习如何编程和构建代码和数据结构可能很重要，但对于学习面向对象的设计和建模来说，它们通常是一个非常糟糕的选择。

# java - WCF 客户端/Java Web 服务 - SOAP

> ID：10319178
> 
> 赞同：1
> 
> 时间：2012-04-25T15:51:07.497
> 
> 标签：java, .net, wcf, web-services, c#-4.0

我需要发送具有以下格式的 SOAP 消息（从我给出的示例中删减）：-

```
<soapenv:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns:ret="http://www.another.com/ret"
                  xmlns:ser="http://www.another.com/ret/retTransaction/service"
                  xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Header/>
  <soapenv:Body>
    <ser:store>
      <ret:retTransaction>
        <ret:retailTransaction xsi:type="ret:NormalTransaction">                                           <ret:applicationId>POS</ret:applicationId>   
        </ret:retailTransaction>
      </ret:retTransaction>
    </ser:store>
  </soapenv:Body>
</soapenv:Envelope> 
```

有问题的操作是“存储”。该操作在添加服务引用之后的代理中有一个“对象”参数。

如何确保发送格式正确的消息？特别是 SOAP 信封中的多个命名空间？

谢谢

# java - 显示前 100 个素数的程序未显示

> ID：10319183
> 
> 赞同：2
> 
> 时间：2012-04-25T15:51:23.057
> 
> 标签：java, primes

我是 Java 新手，我在互联网上搜索了一个小时的答案，但找不到任何东西。

我正在尝试创建一个以这种格式显示前 100 个素数的程序：

```
First One Hundred Primes:
2 3 5 7 11 13 17 19 23 29
31 37 41 43 47 53 59 61 67 71
73 79 83 89 97 101 103 107 109 113
127 131 137 139 149 151 157 163 167 173
179 181 191 193 197 199 211 223 227 229
233 239 241 251 257 263 269 271 277 281
283 293 307 311 313 317 331 337 347 349
353 359 367 373 379 383 389 397 401 409
419 421 431 433 439 443 449 457 461 463
467 479 487 491 499 503 509 521 523 541 
```

编辑：^ 这种格式也应该是右对齐的。

我不确定为什么当我尝试在控制台中运行它时它没有显示任何内容。不，我的代码还没有完全完成。请帮助我解释为什么它没有显示以及我做错了什么，谢谢！:)

这是我现在的代码：

```
public class PrimeNumbers {

    public static void main(String[] args) {
        final int DIVISOR = 1;
        boolean isPrime;
        int test1 = 0;
        int test2 = 0;
        int num = 1;
        int count = 0;

        while(count < 101) {
            test1 = num/DIVISOR; //divides number by 1
            test2 = num%num; //gets remainder of number

            if (test1 == num && test2 == 0 && num > 1) //checks if test 1 is the same as num, test2 equals to 0 and if num is greater than 1
                isPrime = true;
            else
                isPrime = false;

                if (isPrime == true) {
                    System.out.format("%3.3f");
                    System.out.println("First One Hundred Primes:");
                    System.out.print(num);
                }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:26:36.647

所以基本上你要做的是有一个函数来检查一个数字是否是素数。之后，您必须从 2 开始计数并将每个数字传递给该函数。如果它返回真，打印它并记录你找到一个素数的事实。当你这样做了 100 次时，你就可以停下来了。以下代码正是实现了这一点：

```
public class OneHundredPrimes
{
    public static boolean isPrime(int x)
    {
        for (int i = 2; i <= Math.sqrt(x); i++) {
            if (x % i == 0) {
                return false;
            }
        }

        return true;
    }

    public static void main(String[] args)
    {
        int currentNumber = 2;
        int primesFound = 0;

        while (primesFound < 100) {
            if (isPrime(currentNumber)) {
                primesFound++;

                System.out.print (currentNumber + " ");
                if (primesFound % 10 == 0) {
                    System.out.println();
                }
            }

            currentNumber++;
        }
    }
} 
```

如果有不清楚的地方，请询问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T15:58:33.090

我认为您应该重新考虑代码的设计：

*   创建一个方法`boolean isPrime(int i)`，如果 i 是素数则返回 true，否则返回 false。
*   测试该方法是否返回一些数字的预期值（真/假），以说服自己您的算法有效
*   循环从 1 到 Integer.MAX_VALUE 的整数，并使用上面的方法检查它们中的每一个：如果它是素数，则打印它并增加你的计数。
*   当计数达到 100 时停止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:58:22.970

如果这是家庭作业，请相应地标记。

考虑你的`while`循环。循环如何退出？考虑您的计数器，它们何时递增？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-21T19:03:07.037

```
class StackOfInteger {
    private int[] elements;
    private int size;
    public static final int DEFAULT_CAPACITY = 2;

    public StackOfInteger() {
        size = 0;
        elements = new int[DEFAULT_CAPACITY];
    }

    public StackOfInteger(int capacity) {
        elements = new int[capacity];
    }

    public int push(int value) {
        if (size >= elements.length) {
            int[] temp = new int[elements.length * 2];
            System.arraycopy(elements, 0, temp, 0, elements.length);
            elements = temp;
        }
        return elements[size++] = value;
    }

    public int pop() {
        return elements[--size];
    }

    public int peek() {
        return elements[size - 1];
    }

    public boolean empty() {
        return size == 0;
    }

    public int getSize() {
        return size;
    }
}

public class JavaApplication82 {
    public static void main(String[] args) {
        // TODO code application logic here
        String getInput = JOptionPane.showInputDialog("Get your shit !");
        int input = Integer.parseInt(getInput);
        getPrime(input);
    }

    public static void getPrime(int getInput) {
        StackOfInteger stack = new StackOfInteger();
        int dem = 4;
        stack.push(2);
        stack.push(3);
        do {
            if (isPrime(dem) == true) {
                stack.push(dem);
                dem++;
            } else
                dem++;
        } while (dem <= getInput);
        while (!stack.empty())
            System.out.println(stack.pop() + " ");
    }

    public static boolean isPrime(int getNumber) {
        int dem1 = 0;
        int[] arrayTest = new int[getNumber];
        for (int i = 2; i <= getNumber; i++) {
            arrayTest[i] = i;
        }
        for (int i = 2; i < getNumber; i++) {
            if (getNumber % arrayTest[i] == 0)
                dem1++;
            else
                continue;
        }
        if (dem1 != 0)
            return false;
        else
            return true;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T16:06:30.973

## 质数：

```
A Prime Number can be divided evenly only by 1 or itself. 
And it must be greater than 1. 
```

基于此，您需要修改您的程序：-
1\. 进行 2 个循环
2\. 一个是计数 <= 100 的外循环
3\. 一个是检查数字是否为素数并显示它的内循环

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-25T15:54:01.770

您应该`num`在每个周期中递增，并且`count`在找到素数时也应该递增。

哦，你`DIVISOR`不能是 1 也不能是最终的 :) 对于你的每个数字，你应该尝试将它除以 2 和 number-1 之间的除数 - 以确定它是否是质数。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-06-25T12:56:55.353

另一种方法是将主要方法与主要方法分开（基于第一个解决方案）注意：这是没有文本格式的：

```
public class Primes
{
    public static boolean isPrime (int x)
    {
        for (int i = 2; i <= Math.sqrt (x); i++)
        {
            if (x % i == 0)
            {
                return false;
            }
        }
        return true;
    }

    public static void main (String[] args)
    {
    new Primes().findprimes(100);  // <<--here you can choose whatever k prime
    }

    public void findprimes (int k){
    for (int i = 2, primesfound = 0; primesfound < k+1 ; i++)
    {
        if (isPrime (i))
        {
            primesfound++;
            System.out.print (i + " ");
        }
    }   
  }
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-04-18T18:04:10.297

```
public class prime {
    public static int Prime(int n,int counter)
    {
        if(n<=3 && n>0)
        {
            return n;
        }
        if((n-counter)==n || n%(n-counter)>0){
            counter++;
            return Prime(n,counter);
        }
        else if((n-counter)>1 && n%(n-counter)==0){
            return 0;
        }
        else
            return n;
    }
    public static void main(String[] args) {
        int k=0,found=0;
        for(int i=1;found<100;i++){
            k=Prime(i, 0);
            if(k>0){
               found++;
               System.out.println(k);
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-04-26T12:44:40.203

```
package com.mehmood.nisar;

public class Myclass {

    public static void main(String [] args)
    {
        int status = 0;

        for (int i = 2; i < 100; i++) {

            status =0;
            for (int j = 2; j < i; j++) {

                if(i %2 == 0)
                {
                    status = 1;
                    break;
                }

                try {
                    if(i % j == 0)
                    {
                        status = 1;
                        break;
                    }
                } catch (Exception e) {
                    System.out.println(e.getMessage());
                }

            }//break;

            if(status == 0)
            {
                System.out.println(i);
            }
        }
    }
} 
```

# c# - 实体框架中关联的继承混淆

> ID：10319186
> 
> 赞同：2
> 
> 时间：2012-04-25T15:51:36.827
> 
> 标签：c#, entity-framework, entity-framework-4

我有表/实体 A。我也有表/实体 B。B 继承自 A。（B 有 A 的外键）

到目前为止，没有问题。英孚很高兴。

我有一个包含 B 集合的表/实体 C。我将表 B 中的外键添加到 C。

当我更新我的模型时，EF 创建了从 C 到 A 的关系，而不是 B。它将表 B 视为 C 和 A 之间的一种关联表。

我希望我已经足够好地描述了这种情况。

无论如何，有没有办法完成我想要的？我希望 C 有一个 B 集合而不是 As。

**更新**

在 EDMX 编辑器中，我手动删除了 EF 创建的关联，然后手动创建了自己想要的关联。然后我必须将关联映射到正确的表。到目前为止，它似乎正在工作......但我想知道是否有比我的手动干预更好的方法。

# objective-c - setFetchBatchSize 似乎无法正常工作

> ID：10319188
> 
> 赞同：3
> 
> 时间：2012-04-25T15:51:48.413
> 
> 标签：objective-c, ios, core-data, nsfetchrequest

我就这个话题问了几个问题，但仍然无法让它发挥作用。我有一个核心数据，其中包含我在表格视图中显示的 10k+ 行人名。我希望能够用每个字母搜索和更新表格。这是非常滞后的。正如我所建议的那样，我观看了 WWWDC '10 核心数据演示文稿并试图实施

```
[request setFetchBatchSize:50]; 
```

似乎不起作用。当我使用仪器检查核心数据时，它仍然显示加载 tableview 时仍有 10k 请求，当我搜索时它也得到所有结果。是否需要做任何其他事情来设置批量大小，或者这对我没有帮助。

似乎唯一可行的方法是在我搜索时将 fetchlimit 设置为 100。您认为这是一个好的解决方案吗？

提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T18:22:06.190

批量大小只是告诉它一次要获取多少个对象。这可能不会对您有太大帮助。让我们考虑一下您的用例...

用户键入“F”，您告诉数据库，“去查找所有以 'F' 开头的名称”，然后数据库查看所有 10k+ 条记录以找到以 'F' 开头的记录

然后，用户键入“r”，因此您告诉数据库查找所有以“Fr”开头的记录，然后它再次查看所有 10k+ 记录以查找以“Fr”开头的记录。

fetchBatchSize 所做的只是告诉它“嘿，当你在记录中出错时，立即带入 50 个，因为无论如何我可能需要所有这些。” 这不会限制您的搜索。

但是，将 fetchLimit 设置为 100 会有所帮助，因为数据库开始搜索所有 10k+ 条记录，但是一旦它拥有 100 条记录，它就不必继续查看其余记录，因为它已经满足了它的请求。它已经完成，并且一旦获得满足请求的 100 条记录，就会停止搜索。

因此，您可以做几件事，这一切都取决于您的其他用例。

最简单的尝试是在您正在搜索的字段上添加索引。您可以在 Xcode 模型编辑器中设置它（索引部分，就在您可以在检查器中命名实体的位置下方）。这将允许数据库在该字段上设置一个特殊的索引，并且搜索会更快。

其次，在您的初始请求之后，您已经有了一个以“F”开头的名称数组，因此无需返回数据库询问以“Fr”开头的名称如果它也以“Fr”开头以“F”开头，并且您已经拥有所有这些的 NSManagedObject 指针。现在，您可以搜索返回的数组。

更好的是，如果你给它一个排序描述符，数组就会被排序。因此，您可以对数组进行简单的二进制搜索。或者，如果您愿意，可以只使用相同的谓词，并将其应用于结果数组而不是数据库。

即使您不使用我刚刚讨论的结果修剪，我认为索引属性也会显着增加。

**编辑**

也许你应该运行仪器来看看你在哪里花费了多少时间。此外，格式错误的谓词可能会使任何索引方案陷入困境。代码会有所帮助。

最后，考虑一下您将多少元素带入内存。CoreData 不会对其中的所有信息进行故障排除，但它确实为数组中的所有内容创建了 shell。

如果你给它一个排序谓词，

我不知道 SQLLite 如何在索引上实现搜索，但是 B-Tree 具有复杂性 logBN，因此即使在 30k 条记录上，搜索也不是很多。除非您有其他问题，否则索引应该会给您带来很大的改进。

一旦你有了索引，你就不应该检查所有的记录。但是，您仍然可能拥有非常庞大的数据集。在这些上尝试 fetchBatchSize，因为它会限制获取的记录数，并为其余的创建代理。

您也可以调用 countFetchRequext 而不是 executeFetchRequest 来获取项目数。然后，您可以使用 fetchLimit 来限制您获得的数量。

至于使用获取的结果控制器处理所有这些......好吧，那个人必须知道记录，所以它仍然必须进行搜索。

另外，一个地方看...你在做部分吗？如果您有任何用户定义的比较器（例如翻译部分），则将为每条记录调用该比较器。

因此，我想我的主要建议是，在更改索引后，运行工具并真正研究它以确定您将时间花在哪里。这应该很明显。这将有助于引导您解决真正的问题。

我敢打赌，由于某种原因，您仍然可以访问所有元素...

# atk4 - 表单更新（）在 4.2 中不返回 id

> ID：10319190
> 
> 赞同：0
> 
> 时间：2012-04-25T15:51:57.920
> 
> 标签：atk4

我已经用 ATK4 试验了一段时间，真是太棒了！

迁移到 4.2 我遇到了更新表单并且不返回插入的 ID 的问题。

这是一个例子：

```
class page_kids_new extends Page {
function init() {
    parent::init();

    $this -> add('H1') -> set('New Kid');

    $f = $this -> add('Form');
    $f -> setModel('Kid');
    $f -> addSubmit('Opslaan');

    if ($f -> isSubmitted()) {

        $id = $f -> update();

        $js = $this -> js() -> univ() -> successMessage('Record Saved # ' . $id);

        $js -> execute();
    }

} 
```

}

数据很好地保存在数据库中（新记录）。

出于某种原因，它返回了表单对象。到浏览器的输出是：Record Saved # Object Form(boaadmin_kids_new_form)

希望有人可以提供帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T07:28:44.873

可能行为改变了......需要向罗马人询问这个！;) 您`$id = $f->get('id');`在更新后尝试过吗？

# java - 防止 Android 应用程序关闭/停止

> ID：10319191
> 
> 赞同：3
> 
> 时间：2012-04-25T15:52:08.240
> 
> 标签：java, android, ondestroy

有什么方法可以防止应用程序关闭吗？我可以在里面做`OnDestroy`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T15:54:42.423

如果您的问题是在哪里可以防止您的应用程序被关闭，那是不可能的。当系统在低资源下运行或用户想要关闭时，系统有权关闭 - 通过任务杀手或 ICS 中的合并系统。

OnDestroy 只是通知你，你不能在那里“恢复”应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T15:54:26.560

您无法阻止应用程序关闭，因为如果设备资源不足，内核可能会强制它关闭。通常，当系统资源不足时，内核会通知应用程序它希望关闭它。允许应用程序执行其`onDestroy`方法然后关闭。

您的`onDestroy`方法可用于保存状态。这是一个骨架示例：

```
protected void onDestroy() {        
   super.onDestroy();
   //state is saved here.
} 
```

但是，值得记住的是，您不能保证`onDestroy()`会执行。内核可能会也可能不会给它时间这样做。您应该查看[活动生命周期](http://developer.android.com/reference/android/app/Activity.html)以获取更多信息

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T16:11:27.227

不知道你的问题是什么，试着解释一下，我认为这就是你需要的：

如果您希望您的应用程序继续其正在运行的进程而不管应用程序状态如何，请创建一个将运行该进程的前台服务，并且可以在需要时绑定到该应用程序。

[http://developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)

# c# - MultipleActiveResultSets 启用但不工作

> ID：10319193
> 
> 赞同：4
> 
> 时间：2012-04-25T15:52:11.857
> 
> 标签：c#, sql

我启用了 MARS，但仍然无法在一个连接中执行两个 SqlDataReader，我使用 RegEdit 搜索了默认启用 MARS 的解决方案，但找不到任何解决方案，但仍然出现该错误：已经有一个与此命令关联的打开 DataReader，必须关闭第一的。

这是代码：

```
public partial class student_Courses : System.Web.UI.Page
{
    string connectionString = "";
    string query1 = "";
    string query2 = "";
    string courseName = "";
    string chapterName = "";
    string chapterVideoName = "";
    string courseValue = "";
    SqlDataReader sr2 = null;

    protected void Page_Load(object sender, EventArgs e)
    {
        query1 = "SELECT * FROM Courses";
        query2 = "SELECT * FROM Chapters WHERE value='" + courseValue + "'";
        connectionString = "Data Source=Prince-PC;" + 
                            "Initial Catalog=Elearning;" + 
                            "Integrated Security=True;"+ 
                            "MultipleActiveResultSets=True";
        SqlConnection con = new SqlConnection(connectionString);
        SqlCommand command1 = new SqlCommand(query1, con);
        SqlCommand command2 = new SqlCommand(query2, con);
        if (con.State == ConnectionState.Closed)
            con.Open();

        using (SqlDataReader sr1 = command1.ExecuteReader())
        {
            while (sr1.Read())
            {
                courseName = sr1["name"].ToString();
                courseValue = sr1["value"].ToString();
                sr2 = command2.ExecuteReader();
                while (sr2.Read())
                {
                    chapterName = TextBox3.Text =  sr2["name"].ToString();
                    chapterVideoName = Label2.Text =  sr2["video_name"].ToString();
                }
            }
        }
        con.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T19:09:47.483

您需要通过[此 MSDN MARS 示例](http://msdn.microsoft.com/en-us/library/yf1a7f4f%28v=vs.80%29.aspx)`sr2`中的`using`语句进行处理

```
// The following line of code requires
// a MARS-enabled connection.
productReader = productCmd.ExecuteReader();
using (productReader)
{
  while (productReader.Read())
  {
    Console.WriteLine("  " +
      productReader["Name"].ToString());
  }
} 
```

# javascript - 使用 jQuery 交换列表元素

> ID：10319197
> 
> 赞同：4
> 
> 时间：2012-04-25T15:52:23.207
> 
> 标签：javascript, jquery

我有一个清单：

```
<li>item one<img src="/assets/img/site/up_arrow.png" class="upArrow"/><img src="/assets/img/site/down_arrow.png" class="downArrow"/</li>
<li>item two<img src="/assets/img/site/up_arrow.png" class="upArrow"/><img src="/assets/img/site/down_arrow.png" class="downArrow"/</li>
<li>item three<img src="/assets/img/site/up_arrow.png" class="upArrow"/><img src="/assets/img/site/down_arrow.png" class="downArrow"/</li>
<li>item four<img src="/assets/img/site/up_arrow.png" class="upArrow"/><img src="/assets/img/site/down_arrow.png" class="downArrow"/</li>
<li>item five<img src="/assets/img/site/up_arrow.png" class="upArrow"/><img src="/assets/img/site/down_arrow.png" class="downArrow"/</li> 
```

每个都有一个向上和向下的箭头。在我的 jquery 中，我有：

```
$(".upArrow").click(function() {

});

$(".downArrow").click(function() {

}); 
```

我怎样才能得到它，以便当用户单击向上箭头时，它将 li 与上面的一个交换，当他们单击向下时，它与下面的 li 交换（如果存在的话）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T15:59:25.923

jsfiddle（[http://jsfiddle.net/A9j3E/6/](http://jsfiddle.net/A9j3E/6/)）

```
$(".upArrow").click(function() {
    $(this).parent().insertBefore( $(this).parent().prev() );
});

$(".downArrow").click(function() {
    $(this).parent().insertAfter( $(this).parent().next() );
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T15:55:37.557

您可以获得对列表项的引用，并将其插入到其兄弟之前/之后。

```
$(".upArrow").on("click", function(){
  var li = $(this).closest("li");
  li.insertBefore( li.prev() );
}); 
```

此外，请务必正确关闭您的图像。您的向下箭头图像均格式错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:58:16.673

尝试这样的事情

```
$(".upArrow").click(function() {
  var thisItem = $(this).closest('li');
  var prevItem = thisItem.prev();

  if(prevItem.length != 0) {
    thisItem.before(prevItem);
  }
});

$(".downArrow").click(function() {
  var thisItem = $(this).closest('li');
  var nextItem = thisItem.next();

  if(nextItem.length != 0) {
    thisItem.after(nextItem);
  }
}); 
```

# iphone - 线程安全的 UIImage 调整大小？

> ID：10319198
> 
> 赞同：0
> 
> 时间：2012-04-25T15:52:24.867
> 
> 标签：iphone, multithreading, uiimage, resize, scale

我做了这个 UIImage 扩展以获得重新缩放的副本：

```
-(UIImage*)scaleByRatio:(float) scaleRatio
{ 
    CGSize scaledSize = CGSizeMake(self.size.width * scaleRatio, self.size.height * scaleRatio);

    //The output context.   
    UIGraphicsBeginImageContext(scaledSize);
    CGContextRef context = UIGraphicsGetCurrentContext();

//Percent (101%)    
#define SCALE_OVER_A_BIT 1.01

    //Scale.
    CGContextScaleCTM(context, scaleRatio * SCALE_OVER_A_BIT, scaleRatio * SCALE_OVER_A_BIT);
    [self drawAtPoint:CGPointZero];

    //End?
    UIImage *scaledImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return scaledImage;
} 
```

它在大多数情况下都有效，但在我最近的项目中，它输出原始图像（我在使用*UIImageJPEGRepresentation*和*imageWithData:*缩放后立即保存到磁盘）。

我在后台线程中调用该方法。这可能是问题吗？如何将其重写为线程安全的（假设问题是由线程引起的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:53:03.050

```
-(UIImage*)scaleByRatio:(float) scaleRatio
{ 
   CGSize scaledSize = CGSizeMake(self.size.width * scaleRatio, self.size.height * scaleRatio);
   CGColorSpaceRef colorSpace;
   int   bitmapBytesPerRow;
   bitmapBytesPerRow   = (size.width * 4);

   //The output context.   
   UIGraphicsBeginImageContext(scaledSize);
   CGContextRef context = context = CGBitmapContextCreate (NULL,
                                 scaledSize .width,
                                 scaledSize .height,
                                 8,      // bits per component
                                 bitmapBytesPerRow,
                                 colorSpace,
                                 kCGImageAlphaPremultipliedLast);

 //Percent (101%)    
 #define SCALE_OVER_A_BIT 1.01

    //Scale.
   CGContextScaleCTM(context, scaleRatio * SCALE_OVER_A_BIT, scaleRatio * SCALE_OVER_A_BIT);
[self drawAtPoint:CGPointZero];

   //End?
   UIImage *scaledImage = UIGraphicsGetImageFromCurrentImageContext();
   UIGraphicsEndImageContext();
   return scaledImage;
 } 
```

简而言之，您必须`CGContextRef`使用`CGBitmapContextCreate`不使用 UIGraphicsGetCurrentContext();创建 因为 UIGraphicsGetCurrentContext(); 不是安全的。

希望，这会帮助你......享受

# php - openid 验证返回 false

> ID：10319202
> 
> 赞同：0
> 
> 时间：2012-04-25T15:52:39.093
> 
> 标签：php, openid, lightopenid

我已经下载了 LightOpenID (http://gitorious.org/lightopenid) 并且它工作但几天前停止了。我的代码：

```
<?php
require 'openid.php';
try {
if(!isset($_GET['openid_mode'])) {
    if(isset($_GET['login'])) {
        $openid = new LightOpenID('my-domain.com');
        $openid->identity = 'https://www.google.com/accounts/o8/id';
            $openid->required = array('namePerson/friendly', 'contact/email');
        header('Location: ' . $openid->authUrl());
    }
?>
<form action="?login" method="post">
<button>Login with Google</button>
</form>
<?php
} elseif($_GET['openid_mode'] == 'cancel') {
    echo 'User has canceled authentication!';
} else {
    $openid = new LightOpenID('my-domain.com');
    echo 'User ' . ($openid->validate() ? $openid->identity . ' has ' : 'has not ') . 'logged in.';
}
} catch(ErrorException $e) {
echo $e->getMessage();
}
echo '<pre>'.print_r($openid,true).'</pre>';
?> 
```

在 localhost 它可以工作，但不能在 Web 服务器上工作。

编辑：我找到了旧版本的 LightOpenID，它可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T17:42:45.043

request_streams() 方法存在问题，我通过注释第 352 行并将其替换为 return $data; 解决了它。

```
//return file_get_contents($url, false, $context);
return $data; 
```

# java - Hibernate 性能最佳实践？

> ID：10319205
> 
> 赞同：18
> 
> 时间：2012-04-25T15:52:44.337
> 
> 标签：java, performance, hibernate, jpa, orm

我正在使用 Hibernate 3 编写一个 Web 应用程序。

所以，过了一会儿，我注意到有些东西很慢。所以我测试了hibernate profiler，发现hibernate会为简单的操作进行不合理的许多db调用。原因当然是我加载了一个对象（这个对象有几个“父母”），而这些“父母”还有其他“父母”。所以基本上休眠会加载它们，即使我只需要基本对象。好的，所以我研究了延迟加载。这导致我进入延迟加载异常，因为我有一个 MVC webapp。

所以现在我有点困惑，什么是我最好的方法。基本上我只需要更新对象上的单个字段。我已经有了对象键。

我应该： 1\. 深入研究延迟加载。然后重写我的应用程序以获得开放会话视图？2\. 深入研究延迟加载。然后重写我的道更具体。例如，编写 DAO 方法将返回实例化的对象，这些对象只包含每个用例所需的内容？可能是很多额外的方法... 3\. 从头开始​​休眠并自己做？4\. 现在真的想不出其他解决方案。有什么建议么？

最佳做法是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-25T17:26:13.307

*   除非真的需要，否则不要使用连接。它们不允许您既不使用延迟加载，也不使用二级缓存进行关联
*   对大型集合使用lazy="extra"，在您询问之前它不会检索所有元素，您也可以使用 size() 方法例如而不从数据库中获取元素
*   如果可能，请使用 load() 方法，因为它在需要之前不会发出选择查询。例如，如果您有 Book 和 Author 并且您想将它们关联在一起，这将不会发出任何选择，只有单个插入：

    > ```
    > Book b = (Book) session.load(Book.class, bookId);
    > Author a = (Author) session.load(Author.class, authorId);
    > b.setAuthor(a);
    > session.save(b); 
    > ```

*   使用命名查询（在您的 hbm 文件或 @NamedQuery 中），以便在每次查询期间不解析它们。在需要之前不要使用 Criteria API（在这种情况下无法使用 PreparedStatement 缓存）

*   在您的网络应用程序中使用 OSIV，因为它只会在需要时/如果需要时加载数据
*   对仅选择使用只读模式：`session.setReadOnly(object, true)`. 这将使 Hibernate 不会在持久上下文中保留所选实体的原始快照以进行进一步的脏检查。
*   用于只读和只读数据的用户二级缓存和查询缓存。
*   使用 FlushMode.COMMIT 而不是 AUTO，这样 Hibernate 不会在更新前发出 select，但要做好准备，这可能会导致写入过时的数据（尽管 Optimistic Locking 可以帮助您）。
*   看一下批量获取（批量大小），以便一次选择多个实体/集合，而不是为每个实体/集合发出单独的查询。
*   执行诸如“从实体中选择新实体（id，someField）”之类的查询，以便仅检索必填字段。看看结果转换器。
*   如果需要，使用批处理操作（如删除）
*   如果您使用本机查询，请明确指定应使哪些缓存区域无效（默认情况下 - 全部）。
*   看一下树状结构的物化路径和嵌套集。
*   设置`c3p0.max_statements`以便在池中启用 PreparedStatment 缓存，并在默认情况下关闭数据库的语句缓存。
*   如果可能，请使用 StatelessSession，它可以克服脏检查、级联、拦截器等。
*   不要将分页（`setMaxResults()`, `setFirstResult()`）与包含集合连接的查询一起使用，这将导致从数据库中提取所有记录，并且分页将由 Hibernate 在内存中进行。如果你想要分页，理想情况下你不应该使用连接。如果您无法逃脱它，请再次使用批量获取。

实际上有很多技巧，但我现在想不起来更多了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-12-15T08:45:52.793

您可以做很多事情来加速 Hibernate 性能，例如：

1.  启用 SQL 语句日志记录，以便您可以验证所有语句，甚至在测试期间检测 N+1 个查询问题。
2.  使用 FlexyPool 进行数据库连接管理和监控
3.  JDBC 批处理以减少提交 INSERT、UPDATE 和 DELETE 语句所需的往返次数。
4.  JDBC 语句缓存
5.  JPA 标识符优化器，例如 pooled 或 pooled-lo
6.  选择紧凑型色谱柱类型
7.  使用正确的关系：双向`@OneToMany`而不是单向，使用`@MapsId`for `@OneToOne`，使用`Set`for`@ManyToMany`
8.  以正确的方式使用继承并出于性能原因更喜欢 SINGLE_TABLE
9.  注意持久性上下文大小并避免长时间运行的事务
10.  使用操作系统缓存，在跳转到二级缓存之前进行数据库缓存，这对于在进行数据库复制时卸载主节点也很有用
11.  通过 SQL 原生查询释放数据库查询功能
12.  在多个一对一实体之间拆分写入以[减少乐观锁定误报，即使在修改某些实体时也有更好的机会命中数据库缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:30:45.637

我相信您想查看[Hibernate 手册中的这一部分](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch21.html#performance-fetching)。

我希望您最初的“...不合理的许多数据库调用...”问题是他们所谓的“N+1 选择问题”的一个实例。如果是这样，他们可以选择如何处理它。

1.  使获取类型加入。然后，假设没有中间集合，您将有一个带有多个连接的单一选择。
2.  做延迟加载。
3.  可能还有其他一些，例如我没有经验的 FetchProfiles。

前两个可以在关联级别指定，并且可以在查询级别覆盖获取类型。您应该能够让您的查询只做您需要的事情，而不是更多，并使用这些工具通过一个“好的”SQL 查询来完成它。

# c# - 导入外部应用程序以在 Visual Studio 中运行

> ID：10319208
> 
> 赞同：0
> 
> 时间：2012-04-25T15:52:56.460
> 
> 标签：c#, asp.net

我正在尝试在 Visual Studio 中运行我的 asp.net 站点的此应用程序：

[http://www.ezreserve.com/Appt.aspx?action=overview#](http://www.ezreserve.com/Appt.aspx?action=overview#)

但我不太确定该怎么做。这甚至可能吗？我还想修改一些 ASP.NET 服务器页面，但我不确定这是否可行。当我下载该应用程序时，它带有一个“站点”文件夹，其中有一堆子文件夹，如“消费者”、“管理员”和 ASP.NET 服务器文件，因为这是一个调度应用程序。我如何让这个东西运行？

# javascript - 如何基于 javascript 中的对象文字创建 if/elseif/else 语句

> ID：10319210
> 
> 赞同：1
> 
> 时间：2012-04-25T15:53:05.687
> 
> 标签：javascript, image, object-literal

我想要一个基于对象文字的 if/else if/else 语句。对象文字将由用户生成，因此我不知道它会持续多久，尽管我会知道键/值对命名方案。

例如，我有一些代码可以获取视口宽度和下面的更新 img src 属性的函数

```
vpwidth =  window.innerWidth;

function modifyImgSrc (srcModifier) {
    src = src.replace(".jpg", srcModifier + ".jpg");
    src = src.replace(".png", srcModifier + ".png");
    src = src.replace(".gif", srcModifier + ".gif");
}; 
```

然后我有我的对象文字

```
var brkpnts = [
   {width: 320, srcmodifier: '-s'},
   {width: 768, srcmodifier: '-m'},
   {width: 1024, srcmodifier: '-l'},
]; 
```

我想根据对象文字生成一个 if 语句

```
if ( vpwidth <= brkpnts[0].width ) {
    modifyImgSrc(brkpnts[0].srcmodifier);
}
else if ( vpwidth <= brkpnts[1].width ) {
    modifyImgSrc(brkpnts[1].srcmodifier);
}
else {
    modifyImgSrc(breakpoints[2].srcmodifier);
} 
```

虽然由于用户可以修改对象文字，但我如何生成 if/else if/else 语句以匹配用户添加到对象文字的内容。例如， 可能有超过 3 个键/值对。

```
var breakpoints = [
    {width: 320, srcmodifier: '-xs'},
    {width: 534, srcmodifier: '-s'},
    {width: 768, srcmodifier: '-m'},
    {width: 1024, srcmodifier: '-l'},
    {width: 1440, srcmodifier: '-xl'}
]; 
```

在这种情况下，我想要一个看起来像这样的 if 语句。

```
if ( vpwidth <= brkpnts[0].width ) {
    modifyImgSrc(brkpnts[0].srcmodifier);
}
else if ( vpwidth <= brkpnts[1].width ) {
    modifyImgSrc(brkpnts[1].srcmodifier);
}
else if ( vpwidth <= brkpnts[2].width ) {
    modifyImgSrc(brkpnts[1].srcmodifier);
}
else if ( vpwidth <= brkpnts[3].width ) {
    modifyImgSrc(brkpnts[1].srcmodifier);
}
else {
    modifyImgSrc(breakpoints[4].srcmodifier);
} 
```

这可能吗？如果是这样，如何实现，这是实现这一目标的最佳方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T15:59:23.363

遍历数组：

```
var modified = false;
for(var i = 0, len = brkpnts.length; i < len; i++) {
    if(vpwidth <= brkpnts[i].width) {
        modifyImgSrc(brkpnts[i].srcmodifier);
        modified = true;
        break;
    }
}

// Use the biggest one if vpwidth larger than all
if(!modified) {
    modifyImgSrc(brkpnts[brkpnts.length - 1].srcmodifier);
} 
```

**编辑：**虽然 Xander 在他的评论中是正确的，但您可能应该使用[媒体查询](http://www.w3.org/TR/css3-mediaqueries/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:02:29.163

```
vpwidth =  window.innerWidth;  

function modifyImgSrc (srcModifier) {     
  src = src.replace(".jpg", srcModifier + ".jpg");     
  src = src.replace(".png", srcModifier + ".png");     
  src = src.replace(".gif", srcModifier + ".gif"); 
}; 

var breakpoints = [     
  {width: 320, srcmodifier: '-xs'},      
  {width: 534, srcmodifier: '-s'},     
  {width: 768, srcmodifier: '-m'},     
  {width: 1024, srcmodifier: '-l'},      
  {width: 1440, srcmodifier: '-xl'} 
];

for(var i=0; i<breakpoints.length;i++)
{
  if(breakpoints[i].width == vpwidth)
  {
     modifyImgSrc(breakpoints[i].srcmodifier);
     break;
  }
} 
```

# jboss - 如何将 jboss.bind.address.management 和 jboss.bind.address.unsecure 设置为与 jboss.bind.address 相同的值？

> ID：10319213
> 
> 赞同：0
> 
> 时间：2012-04-25T15:53:15.540
> 
> 标签：jboss, bind, ip-address

JBoss 7.1.1.Final 问题：

有什么方法可以将 jboss.bind.address.management 和 jboss.bind.address.unsecure 设置为与 jboss.bind.address 相同的值，而无需在standalone.xml中硬编码或将它们作为命令行参数传递？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T15:59:40.500

接口地址接受表达式。默认值如下所示：

```
<interfaces>
    <interface name="management">
        <inet-address value="${jboss.bind.address.management:127.0.0.1}"/>
    </interface>
    <interface name="public">
        <inet-address value="${jboss.bind.address:127.0.0.1}"/>
    </interface>
    <!-- TODO - only show this if the jacorb subsystem is added  -->
    <interface name="unsecure">
        <!-- Used for IIOP sockets in the standard configuration.
             To secure JacORB you need to setup SSL -->
        <inet-address value="${jboss.bind.address.unsecure:127.0.0.1}"/>
    </interface>
</interfaces> 
```

由于它们是表达式，因此可以很容易地将它们更改为使用相同的属性值，如下所示：

```
<interfaces>
    <interface name="management">
        <inet-address value="${jboss.bind.address:127.0.0.1}"/>
    </interface>
    <interface name="public">
        <inet-address value="${jboss.bind.address:127.0.0.1}"/>
    </interface>
    <!-- TODO - only show this if the jacorb subsystem is added  -->
    <interface name="unsecure">
        <!-- Used for IIOP sockets in the standard configuration.
             To secure JacORB you need to setup SSL -->
        <inet-address value="${jboss.bind.address:127.0.0.1}"/>
    </interface>
</interfaces> 
```

# iphone - 是否存在类似 cvShowImage for iOS 的东西？

> ID：10319214
> 
> 赞同：0
> 
> 时间：2012-04-25T15:53:20.857
> 
> 标签：iphone, objective-c, ios, opencv, cmsamplebufferref

我正在处理图像（在 iOS 上使用 AVFoundation 和 OpenCV），我想*简单地*将 CMSampleBufferRef（或 IplImage）的内容显示到屏幕上。

**简单地说**：我只想显示（如使用 OpenCV 的`cvShowImage()`）未转换的图像，看看我是否没有处理损坏或以某种方式变形的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:08:22.413

可悲的是没有。不同的位图表示。

也许你想要一个类别？我使用了一些类似的东西：

```
 // NSImage+OpenCV.h
 @interface NSImage (OpenCV)
 + (NSImage*)imageWithCVMat:(const cv::Mat&)cvMat;
 - (id)initWithCVMat:(const cv::Mat&)cvMat;
 - (cv::Ptr<cv::Mat>)cvMat;
 @end

 // NSImage+OpenCV.m
 using namespace cv;
 @implementation NSImage (OpenCV)

 - (id)initWithCVMat:(const cv::Mat&)cvMat {
      NSData *data = [NSData dataWithBytes:cvMat.data
                                 length:cvMat.total()*cvMat.elemSize()];    
      CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)data);
      CGColorSpaceRef colourSpace =  CGColorSpaceCreateDeviceRGB();

      CGImageRef imageRef = CGImageCreate(cvMat.cols,
                                         cvMat.rows,
                                         8,
                                         8 * cvMat.elemSize(),
                                         cvMat.step[0],
                                         colourSpace,                                           
                                         kCGImageAlphaNone |
                                         kCGBitmapByteOrderDefault,
                                         provider,
                                         NULL,
                                         false,
                                         kCGRenderingIntentDefault);       

      NSImage *image = [[NSImage alloc] initWithCGImage:imageRef size:CGSizeMake(cvMat.cols,cvMat.rows)];

      CGColorSpaceRelease(colourSpace);
      CGDataProviderRelease(provider);
      CGImageRelease(imageRef);

      return image;
 }

 +(NSImage*)imageWithCVMat:(const cv::Mat&)cvMat {
    return [[NSImage alloc] initWithCVMat:cvMat];
 }

 - (cv::Ptr<cv::Mat>)cvMat {
      CGImageSourceRef source =  CGImageSourceCreateWithData((__bridge CFDataRef)[self TIFFRepresentation],  NULL);     
      CGImageRef imageRef =  CGImageSourceCreateImageAtIndex(source, 0, NULL);
      cv::Ptr<cv::Mat> cvMat = new cv::Mat(self.size.height, self.size.width, CV_8UC4);          

      CGContextRef contextRef = CGBitmapContextCreate(cvMat->data,
                                                   cvMat->cols,
                                                   cvMat->rows,
                                                   8,
                                                   cvMat->step[0],                                                    
                                                   CGImageGetColorSpace(imageRef),
                                                   kCGImageAlphaNoneSkipLast |
                                                   kCGBitmapByteOrderDefault);   

      CGContextDrawImage(contextRef,
                        CGRectMake(0, 0, cvMat->cols, cvMat->rows),
                        imageRef);

      CGContextRelease(contextRef);
      CGImageRelease(imageRef);

      return cvMat;   
 }

 @end 
```

# ssrs-2008 - SSRS 报告中没有数据

> ID：10319220
> 
> 赞同：4
> 
> 时间：2012-04-25T15:53:38.153
> 
> 标签：ssrs-2008

我在 SSRS 报告上有一个 tablix，它从存储过程中获取数据。

当没有数据存在时，我试图向用户显示消息，例如“**此报告没有数据* **”。**我可以通过在 tablix 的 **NoRowsMessage 属性中**指定此消息来轻松完成此操作。**但我想与这条消息一起显示 tablix 的标题。

如果我不设置**NoRowsMessage**属性，我会得到标题但没有消息，但如果我这样做了，我会得到消息但没有标题。

我需要一些帮助。

注意：我使用的是 SSRS 2008。

编辑：

我还可以在 tablix 下方放置一个带有相关文本消息的文本框，并仅在 tablix 不包含行时将其设置为可见。但我无法弄清楚如何从文本框的可见性表达式中找出 tablix 是否包含任何行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T15:59:09.330

Tablix 对象与基础数据集相关，因此如果没有数据，则输出中没有表。

除了使用**NowRowsMessage**属性之外，我能想到的唯一其他方法是确保您的查询在现在返回行时返回一个空值占位符。这样，您本质上将拥有一个数据行。

然后，您可以尝试在表格上添加一个条件表达式（即在详细信息行的 Visibility 属性上），以防止任何包含占位符的行出现。

因此，在您的查询中，您可以：

```
IF (@@ROWCOUNT= 0)
BEGIN

SELECT 
'[IAMEMPTY]' as [Col1]
,'[IAMEMPTY]' as [Col2]
,'[IAMEMPTY]' as [Col3]

END 
```

然后在表的详细信息行的 Visibility 属性中：

```
=Iif(Fields!Col1.Value = "[IAMEMPTY]",True,False) 
```

编辑：或者，要检查 SSRS 中的 DataSet 是否为空并显示包含您的消息/标题的矩形（如 TooSik 的评论中所述），您可以在 Visibility 表达式中设置一个矩形：

```
=Iif(Rownumber("Dataset_Name")=0, False,True) 
```

# java - hashmap 1.4 和 1.6 的区别

> ID：10319224
> 
> 赞同：3
> 
> 时间：2012-04-25T15:54:06.503
> 
> 标签：java, hashmap

我有在两者上运行的应用`1.4`程序`1.6`。在版本中打印的元素顺序`1.6`不同于`1.4`. 我用`LinkedHashMap`了它解决了这个问题。现在这个顺序与 of 完全相同`1.4`。除了下载整个 jdk 之外，我没有找到`1.4`源代码。`HashMap`除了在新版本中更改的通用内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T15:57:00.157

元素的迭代顺序`HashMap`从未得到保证，因此实现可以自由更改它。这个缺点已经得到了弥补`LinkedHashMap`。

这样的变化可能是由于[Java 1.4.1 中散列算法的彻底修改造成的](http://www.javaspecialists.eu/archive/Issue054.html)……但话又说回来，我们在将项目迁移到 Java6 时也注意到了这样的变化，因此该版本也发生了变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T15:57:12.130

`HashMap`中的迭代顺序*未定义*。这意味着它可以（并且确实）一直在变化。它不仅取决于代码，还取决于对象的哈希码值，这些值本身不仅因版本而异，甚至因运行而异。

`LinkedHashMap`专门作为具有`HashMap`可预测迭代顺序的替代方案而存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T15:58:14.787

我想 HashMap 的实现已经改变了。HashMap 不保证任何顺序，所以你不应该依赖它，因为它可能会在没有任何通知的情况下随着新版本的变化而改变。

# java - Web服务中的Spring Security CAS实现

> ID：10319229
> 
> 赞同：3
> 
> 时间：2012-04-25T15:54:13.610
> 
> 标签：java, spring-security, cas

我们的团队一直负责以某种方式保护 Web 服务，现在我们有其他使用 SpringSecurity CAS 保护的 Web 应用程序，我们认为它也可以用它来保护 Web 服务。想法是，如果用户通过 CAS 服务器登录到其中一个 Web 应用程序，当调用 Web 服务时，它将看到该用户已经过身份验证并允许他们使用它。我们不确定这是否是正确的方法，因为有很多关于使用 HMAC 或 Oauth 2.0 的讨论，但想到了 CAS，因为这是其他所有东西都在使用的。

以下是我遵循本教程后的内容：

[http://www.oudmaijer.com/2009/12/28/spring-3-spring-security-3-cas-3-3-4-integration/](http://www.oudmaijer.com/2009/12/28/spring-3-spring-security-3-cas-3-3-4-integration/)

pom.xml

```
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-core</artifactId>
    <version>3.0.0.RELEASE</version>
    <optional>false</optional>
</dependency>
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-config</artifactId>
    <version>3.0.0.RELEASE</version>
    <scope>compile</scope>
</dependency>
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-cas-client</artifactId>
    <version>3.0.0.RELEASE</version>
    <optional>false</optional>
</dependency> 
```

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xmlns="http://java.sun.com/xml/ns/javaee" 
        xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
        xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
        http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
        id="WebApp_ID" 
        version="2.5">
<display-name>webservice</display-name>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<servlet>
    <servlet-name>service</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>service</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping>
<!-- Start Spring CAS integration -->
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext-security.xml</param-value>
</context-param>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping>

<welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.jsp</welcome-file>
</welcome-file-list>
<!-- End Spring CAS integration --> 
```

applicationContext-security.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"     xmlns:security="http://www.springframework.org/schema/security" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">

<!--
    Enable security, let the casAuthenticationEntryPoint handle all intercepted urls.
    The CAS_FILTER needs to be in the right position within the filter chain.
-->
<security:http entry-point-ref="casAuthenticationEntryPoint" auto-config="true">
    <security:intercept-url pattern="/**" access="ROLE_USER"></security:intercept-url>
    <security:custom-filter position="CAS_FILTER" ref="casAuthenticationFilter"></security:custom-filter>
</security:http>

<!--
    Required for the casProcessingFilter, so define it explicitly set and
    specify an Id Even though the authenticationManager is created by
    default when namespace based config is used.
-->
<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider ref="casAuthenticationProvider"></security:authentication-provider>
</security:authentication-manager>

<!--
    This section is used to configure CAS. The service is the
    actual redirect that will be triggered after the CAS login sequence.
-->
<bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties">
    <property name="service" value="http://localhost:8080/service/j_spring_cas_security_check"></property>
    <property name="sendRenew" value="false"></property>
</bean> 

    <!--
    The CAS filter handles the redirect from the CAS server and starts the ticket validation.
-->
<bean id="casAuthenticationFilter" class="org.springframework.security.cas.web.CasAuthenticationFilter">
    <property name="authenticationManager" ref="authenticationManager"></property>
</bean>

<!--
    The entryPoint intercepts all the CAS authentication requests.
    It redirects to the CAS loginUrl for the CAS login page.
-->
<bean id="casAuthenticationEntryPoint" class="org.springframework.security.cas.web.CasAuthenticationEntryPoint">
    <property name="loginUrl" value=""></property>
    <property name="serviceProperties" ref="serviceProperties"></property>
</bean>

<!--
    Handles the CAS ticket processing.
 -->
<bean id="casAuthenticationProvider" class="org.springframework.security.cas.authentication.CasAuthenticationProvider">
    <property name="userDetailsService" ref="userService"></property>
    <property name="serviceProperties" ref="serviceProperties"></property>
    <property name="ticketValidator">
        <bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
            <constructor-arg index="0" value=""></constructor-arg>
        </bean>
    </property>
    <property name="key" value="cas"></property>
</bean>

<!--
    The users available for this application.
-->
<security:user-service id="userService">
    <security:user name="user" password="user" authorities="ROLE_USER"></security:user>
</security:user-service> 
```

不确定缺少什么或发生了什么，但是当我在 eclipse 中启动我的 tomcat 服务器时，我收到一个错误，例如：

```
ERROR 2012-04-25 09:24:33 Context initialization failed
java.lang.NoClassDefFoundError: org/springframework/core/convert/support/PropertyTypeDescriptor
at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:108)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1003)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:907)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:722)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:410)
at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:276)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:197)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3843)
at org.apache.catalina.core.StandardContext.start(StandardContext.java:4342)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
at org.apache.catalina.core.StandardService.start(StandardService.java:516)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
at org.apache.catalina.startup.Catalina.start(Catalina.java:578)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)
Caused by: java.lang.ClassNotFoundException: org.springframework.core.convert.support.PropertyTypeDescriptor
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1387)
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1233)
at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:316)
... 29 more
Apr 25, 2012 9:24:33 AM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class  org.springframework.web.context.ContextLoaderListener 
java.lang.NoClassDefFoundError: org/springframework/core/convert/support/PropertyTypeDescriptor
at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:108)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1003)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:907)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:722)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:410)
at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:276)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:197)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3843)
at org.apache.catalina.core.StandardContext.start(StandardContext.java:4342)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
at org.apache.catalina.core.StandardService.start(StandardService.java:516)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
at org.apache.catalina.startup.Catalina.start(Catalina.java:578)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)
Caused by: java.lang.ClassNotFoundException: org.springframework.core.convert.support.PropertyTypeDescriptor
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1387)
at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1233)
at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:316)
... 29 more
Apr 25, 2012 9:24:33 AM org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart
Apr 25, 2012 9:24:33 AM org.apache.catalina.core.StandardContext start
SEVERE: Context [/bannernotifications] startup failed due to previous errors
Apr 25, 2012 9:24:33 AM org.apache.catalina.core.ApplicationContext log
INFO: Closing Spring root WebApplicationContext
Apr 25, 2012 9:24:33 AM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Apr 25, 2012 9:24:33 AM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Apr 25, 2012 9:24:33 AM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/15  config=null
Apr 25, 2012 9:24:33 AM org.apache.catalina.startup.Catalina start
INFO: Server startup in 855 ms 
```

对不起，这太长了，但我只是想尽可能多地放在那里。

正如@smp7d 指出的那样，CAS 可能不是最好的情况。我找到了这个，

[保护 REST 和 JSON](https://stackoverflow.com/questions/1141008/securing-rest-and-json)

这正是这个 Web 服务的内容，RESTful 并提供 JSON，它将在内部托管并且只能在内部访问。现在我想问题已经从使用 CAS 转移到了我们应该使用什么，标准是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:15:36.160

看来你要参考资料...

我可以告诉你，我现在怀疑这是否存在，当我执行类似的集成时，我必须通过代码才能真正了解如何为我们的环境正确设置它。（因为它都是开源的，所以这对你来说应该不是问题。）然后我们根据我们学到的知识创建了内部文档。这将是您需要避免尝试将现有配置中的工作实现拼凑在一起的情况之一。有人需要完全了解实际发生的事情。

至于参与 CAS 身份验证的 Web 服务，您需要实现类似 Restlet 的东西： [https ://wiki.jasig.org/display/CASUM/RESTful+API](https://wiki.jasig.org/display/CASUM/RESTful+API)

我建议您彻底评估您的系统，以确定它是否真的需要这样的解决方案。如果您的“网络服务”调用来自浏览器，CAS 将通过正常设置来处理它（尽管您必须有创意来处理未经身份验证的情况，因为您不会重定向到登录页面）。

# f# - 尾递归/高效函数来计算列表项（不使用 List.count/Seq.count）

> ID：10319231
> 
> 赞同：1
> 
> 时间：2012-04-25T15:54:20.823
> 
> 标签：f#, tail-recursion

我尝试做一个尾递归函数来计算列表的元素，遵循规则，使用累加器，但是当我像这样运行它时：

```
lstcountr [1..98765432];; 
```

我明白了：

> System.OutOfMemoryException：引发了“System.OutOfMemoryException”类型的异常。

这是我的功能（我认为是尾递归/高效）：

```
let lstcountr ls =
    let rec loop ls total = 
        match ls with
        | [] -> total
        | hd::tl -> loop tl total+1I
    loop ls 0I 
```

这可以做得更好吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T16:27:31.573

你的函数不是尾递归的。

```
| hd::tl -> loop tl total+1I 
```

应该

```
| hd::tl -> loop tl (total+1I) 
```

运算符在函数调用之后被解释，通常在这种情况下你无法分辨，因为结果是相同的，但尾递归不是这样。

同样正如 Tejs 所说，您正在创建一个列表，其中包含太多导致您的`OutOfMemoryException`. 您是否尝试过使用`seq { }`?

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T16:02:07.187

太多的递归意味着你得到一个`StackOverflowException`，而不是`OutOfMemoryException`- 这是因为你试图一次创建一个 98765432 个元素的列表。

不管你的递归如何，这个作为参数传递的列表是在内存中创建的，而不是我可能会懒惰地添加。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T20:30:41.260

以下是编写返回类型为多态的基于序列的版本的两种方法：

```
module Seq =
  open LanguagePrimitives

  let inline count items = Seq.fold (fun i _ -> i + GenericOne) GenericZero items

  //faster
  let inline count (items: seq<_>) =
    use e = items.GetEnumerator()
    let rec loop n =
      if e.MoveNext() then loop (n + GenericOne)
      else n
    loop GenericZero 
```

这允许您使用最合适的类型计算长度：

```
let n : bigint = Seq.count {1I .. 987298234982374923847I}
let n : float = Seq.count {1I .. 987298234982374923847I} 
```

# php - php javascript部分页面重新加载

> ID：10319237
> 
> 赞同：0
> 
> 时间：2012-04-25T15:54:37.730
> 
> 标签：php, javascript, jquery, ajax

我有一个页面设置，有几个 div。现在我们需要的是

```
<div id="main">...</div> & <div id="sidebar">...</div> 
```

每个 div 都有如下代码：

```
<?php include("page.php") ?> 
```

主 div 完成所有工作，并包含一个 JavaScript 函数。例如，此时用户可以单击按钮来记住表格中显示的项目。

当用户调用此函数时，我是否只能重新加载侧边栏而不是整个页面？我在此处发布该功能，我现在需要的只是能够刷新侧面板及其包含的 php 文件（如果可能的话）？我认为类似的东西可以完成这项工作吗？还是我错了？`load("#sidebar")`

```
function saveToFavorites(code)
{

    $.ajax({
        async:false,
        type: "POST",
        url: 'formPostsUser.php?reqtype=addToFavorite',
        data:'coursecode='+ code,
        success: function(data) 
        {
            $('.result').html(data);
            if(data != "")
            {
                alert(data);
                load("#sidebar") 
            }
        }
    });
} 
```

亲切的问候亚历克斯

对任何回复和提示感到高兴；）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:22:46.537

第一件事

```
 <div="sidebar">..</div> 
```

上面的标记是错误的 HTML。您应该将侧边栏作为属性的值，例如 id 或 class

```
<div id="sidebar">..</div> 
```

**加载侧边栏内容**

您可以使用 jQuery ajax 使用 jQuery[加载](http://api.jquery.com/load/)方法来加载此 div 的内容，如下所示

```
$(function(){
  $("#sidebar").load("yourPHPPageToReturnSideBarContent.php");  
}); 
```

假设`yourPHPPageToReturnSideBarContent.php`是为侧边栏呈现 HTML Markkup 的 PHP 页面。请注意，这将加载[文档就绪](http://api.jquery.com/ready/)事件上的内容。

**加载事件的侧边栏内容**

如果你想将它加载到像按钮点击这样的特殊事件上，你可以这样做

```
$(function(){
  $(document).on("click","yourButtonId",function(){
     $("#sidebar").load("yourPHPPageToReturnSideBarContent.php");  
   });
}); 
```

上面的脚本将在单击按钮时加载侧栏内容。在此示例中，按钮的 id 是 e“yourButtonId”。

请注意，我[在这里使用 jQuery](http://api.jquery.com/on/)来绑定函数，因为如果您想动态加载包含按钮的标记，它将处理当前元素和未来元素。

# underscore.js - 突破 _.filter()

> ID：10319239
> 
> 赞同：3
> 
> 时间：2012-04-25T15:54:46.493
> 
> 标签：underscore.js

```
_.filter(this.pluck(key),function(item){
    return item ? value.toLowerCase() === item.toLowerCase() : false;
  }); 
```

如果回调的返回值为真，有没有办法停止过滤器迭代？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T19:53:44.187

我发现这可以用[`any`](http://underscorejs.org/#some)（又名`some`）来完成：

```
_.any(this.pluck(key),function(item){
        return item ? value.toLowerCase() === item.toLowerCase() : false;
      }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-14T20:10:37.687

这样更糟 - 但最好的方法似乎是处理你的 DS 像（或转换为）一个数组并使用`for`-loop 或等效的`break;`条件进行迭代。

请投反对票*并*完成任务。如果这是错误的。;)

# c# - Sockets.Connected 总是正确的？

> ID：10319244
> 
> 赞同：0
> 
> 时间：2012-04-25T15:55:02.513
> 
> 标签：c#, sockets

我有一个使用 WCF 服务的小型文件传输应用程序，它通过 tcp 套接字发送文件和文件夹。
我的问题是，当我从客户端取消传输操作*（后台工作人员）*时，服务器仍然冻结`client.Receive`，它应该给我这个异常：`An existing connection was forcibly closed by the remote host`，但它没有，尽管在客户端，**listener.Connected**变成`false`了**套接字。已连接**成为`false`
我需要获取此异常并处理它，以便我可以关闭流和套接字并准备好接收另一个任务！

**客户端：**

```
private void worker_DoWork(object sender, DoWorkEventArgs e)
    {
        List<Job> Jobs = (List<Job>)e.Argument;
        using (Socket listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))
        {
            IPEndPoint endpoint = new IPEndPoint(IPAddress.Any, 0);
            listener.Bind(endpoint);
            listener.Listen(1);
            client.ConnectToClient((IPEndPoint)listener.LocalEndPoint);
            Socket socket = listener.Accept();
            foreach (Job job in Jobs)
            {
                if (job.IsFile)
                   {
                      if (job.IsSend)
                      { SendFile(socket, job, e); }  //here i send a single file.
         //           else
         //           { ReceiveFile(socket, job, e); }
                   }
         //        else
         //        {
         //           if (job.IsSend)
         //           { SendDir(socket, job, e); }
         //           else
         //           { ReceiveDir(socket, job, e); }
         //        }
                if (worker.CancellationPending)
                {
                    e.Cancel = true;
                    socket.Dispose();
                    listener.Dispose();
                    Console.WriteLine(socket.Connected + "  " + listener.Connected);  
                    //it prints "FALSE FALSE"
                    return;
                }
            }
        }
    }

private void SendFile(Socket socket, Job job, DoWorkEventArgs e)
    {
        UpdateInfo(job.Name, job.Icon);              //update GUI with file icon and name.
        client.ReceiveFile((_File)job.Argument, bufferSize); //tell the client to start receiving
        SendX(socket, ((_File)job.Argument).Path, e);    //start sending..
    }

private void SendX(Socket socket, string filePath, DoWorkEventArgs e)
    {
        using (Stream stream = File.OpenRead(filePath))
        {
            byte[] buffer = new byte[bufferSize];
            long sum = 0;
            int count = 0;
            while (sum < stream.Length)
            {
                if (worker.CancellationPending)
                {
                    e.Cancel = true;
                    return;
                }
                count = stream.Read(buffer, 0, buffer.Length);
                socket.Send(buffer, 0, count, SocketFlags.None);
                sum += count;
                SumAll += count;
                worker.ReportProgress((int)((sum * 100) / stream.Length));
            } 
        }
    } 
```

**服务器端：**

```
public void ConnectToClient(IPEndPoint endpoint)
    {
        if (client == null)
        {
            Thread th = new Thread(unused => ConnectTh(endpoint));
            th.Start();
        }
    }
    private void ConnectTh(IPEndPoint endpoint)
    {
        client = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        client.Connect(IPAddress.Parse("127.0.0.1"), endpoint.Port);
    }

public void ReceiveFile(_File file, int bufferSize)
    {
        System.Threading.Thread th = new System.Threading.Thread(unused => ReceiveX(client, file.Name, file.Size, bufferSize));
        th.Start();
    }

private void ReceiveX(Socket client, string destPath, long size, int bufferSize)
    {
        try
        {
            using (Stream stream = File.Create(destPath))
            {
                byte[] buffer = new byte[bufferSize];
                long sum = 0;
                int count = 0;
                while (sum < size)
                {
                    int bytesToReceive = (int)Math.Min(buffer.Length, size - sum);
                    count = client.Receive(buffer, 0, bytesToReceive, SocketFlags.None);
                    stream.Write(buffer, 0, count);
                    sum += count;
                }
            }
        }
        catch
        {
            if (File.Exists(destPath))
                File.Delete(destPath);
            client.Dispose();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:08:08.720

您永远不应该（必须）指望常规程序流的异常。

当客户端关闭一个套接字时，服务器将收到一个 0 字节的数据包，并在您调用`Receive`. 这会导致您的 while 循环永远持续下去。您应该处理`count`0 的情况并将其视为常规的“客户端关闭的连接”。您提到的异常仅在客户端无法正常关闭时发生。

# c++ - 删除指针错误

> ID：10319245
> 
> 赞同：0
> 
> 时间：2012-04-25T15:55:04.703
> 
> 标签：c++, pointers

我很困惑为什么在我创建了一个指针并尝试`delete`它之后我收到了错误消息。以下是我一直在使用的一些精简代码：

```
func()
{
  ptree *resultTree = new ptree;
  resultTree = &getNodeptree(pt);
  delete resultTree;
}

ptree& getNodeptree (ptree &pt)  
{
  BOOST_FOREACH(ptree::value_type &v, pt.get_child("root"))
  {
    ptree &temp = v.second;
    return temp;
  }
} 
```

据我了解`resultTree`，仍然需要删除，因为它的内存仍在堆上。但是，尝试这样做会产生：

```
*** glibc detected *** /home/nathan/Programming/Project_Code/MyBoostXmlTest/Debug/MyBoostXmlTest: free(): invalid pointer: 0x00000000018347b8 *** 
```

有人可以解释为什么`delete`在这种情况下调用会产生错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T15:58:03.303

当您删除时`resultTree`，您正在删除从函数调用传递给您的内存`getNodeptree`。而且您无法从对 new 的显式调用中删除内存。

```
func()
{
  ptree *resultTree = new ptree; // you will need to delete this one
  resultTree = &getNodeptree(pt); // now it points to something else!
  delete resultTree; // now you delete something you shouldn't
} 
```

由于`getNodeptree`返回一个引用，你真的不应该删除它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T15:57:57.250

您确实需要删除内存，但是在重新分配`resultTree = &getNodeptree(pt);`. 我不明白应该发生什么，所以恐怕我目前无法提供建议。

# android - Android Spinner 在自定义 ListView 中不完全可见

> ID：10319246
> 
> 赞同：1
> 
> 时间：2012-04-25T15:55:08.510
> 
> 标签：android, android-layout, android-listview, spinner

我需要以类似网格的格式显示一些数据。为此，我使用了一个 ListView，并且为 ListViewROW 定义了一个单独的 XML 布局。

**主要.xml：**

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/newback" >

    <TableLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
        <Tablerow> SOME OTHER CONTROLS HERE  </Tablerow>
        <Tablerow>
            <ListView
                android:id="@+id/mylistview"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:padding="10dp">
            </ListView>
        </Tablerow>
    </TableLayout>
</TableLayout> 
```

**ListViewRow.xml**

```
<TableLayout
    android:layout_height="fill_parent"
    android:layout_width="fill_parent"
    android:orientation="vertical"
    android:weightSum="1">

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="fill_parent"
        android:layout_height="60dp"
        android:weightSum="1">

        <TextView
            android:id="@+id/col1"
            android:layout_width="100dp"
            android:layout_height="50dp"
            android:clickable="true"
            android:padding="5dip"
            android:gravity="left"/>

            <TextView  android:id="@+id/col2"/>
            <TextView  android:id="@+id/col3"/>
            <TextView  android:id="@+id/col4"/>

            <Spinner
                android:id="@+id/cmbOptions"
                android:layout_width="100dp"
                android:layout_height="50dp"
                android:clickable="true"
                android:padding="5dip"
                android:gravity="left"
                android:drawSelectorOnTop="true"
                android:prompt="@string/optionPrompt"/>
        android:text="" />

        <ImageView
            android:id="@+id/imagecorrectivedocument"
            android:layout_width="35dp"
            android:layout_height="35dp"
            android:background="@drawable/crane_ins"
            android:clickable="true"/>
    </TableRow>
</TableLayout> 
```

**问题**：

问题是在生成的网格中，微调器控件不是完全可见的。请看屏幕截图：

![截屏](../Images/b39274aeb8b08b6c8c37e131e2490ab9.png).

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:14:08.953

在微调器的 XML 中，尝试：

```
android:layout_gravity="center_vertical" 
```

# ios - UIPopoverViewController 自动调整大小

> ID：10319249
> 
> 赞同：0
> 
> 时间：2012-04-25T15:55:17.527
> 
> 标签：ios, resize, uipopovercontroller

我有一个带有选取器视图、一些文本框、一些标签和一些分段控件的 UIPopoverViewController。我将情节提要中视图控制器的高度设置为 640。当应用程序加载弹出框时，它似乎是固定大小，并且控件被重新定位，底部的一些被切断。

如何控制此弹出视图控制器的高度以及导致它调整大小的原因？任何好的参考资料的链接都会有所帮助。

谢谢！鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:59:00.453

实例化 popoverController 后，调用`- (void)setPopoverContentSize:(CGSize)size animated:(BOOL)animated;`手动设置 popover 的大小。

# java - 傅里叶变换和傅里叶描述符在 Java 上提取形状特征

> ID：10319251
> 
> 赞同：3
> 
> 时间：2012-04-25T15:55:18.467
> 
> 标签：java, fft, feature-detection

我正在尝试构建一个简单的系统来使用傅立叶描述符识别简单的形状：我在我的程序中使用快速傅立叶变换的这种实现：（下面的链接）
[http://www.wikijava.org/wiki/The_Fast_Fourier_Transform_in_Java_%28part_1%29](http://www.wikijava.org/wiki/The_Fast_Fourier_Transform_in_Java_%28part_1%29)

```
fft(double[] inputReal, double[] inputImag, boolean direction) 
```

输入是：real 和 imag 部分（本质上是我拥有的边界参数的 x,y 坐标），输出是转换后的 real 和 imag 数。

问题：如何使用输出（变换的 real,imag ）作为我的简单形状的不变描述符？

这就是我的想法：

*   每N步计算`R = sqrt( real^2 + imag^2 )`。
*   将每个`R`除以`R[1]`= 归一化因子以使其不变。

问题是对于略有不同的图像（例如应用轻微旋转等），我得到了非常不同的 R 值

**换句话说**：
我的描述符不是一成不变的......我认为我在获取 R 值方面做错了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-13T11:59:35.937

关于傅立叶描述符，您首先需要了解一些理论：这是一种非常有趣的技术，但应该正确设计。你想要的是不变性；旋转、平移甚至仿射变换的不变性。为了与其他傅里叶描述符集进行良好比较，您应该考虑以下事项：

*   如果您想要平移不变性，请不要使用 DC 项，它是结果傅立叶系数数组中的第一个元素
*   如果您想要缩放不变性，请使比较比率类似，例如通过将每个傅立叶系数除以 DC 系数。f*[1] = f[1]/f[0]、f*[2]/f[0] 等等。
*   如果您想要轮廓起点的不变性，请仅使用所得傅立叶系数的绝对值。
*   在比较两个不同对象的系数时，只有前 5 到 8 个傅里叶系数有用；更高的系数只会进入轮廓的细节，而这些细节大多不是非常有用的信息。（重要的是全局形式）
*   假设您有 2 个对象和它们的傅立叶描述符。得到的傅立叶系数数组可以具有不同的大小，这意味着对于两种形状，得到的频率内容的“频率间隔”是不同的。你不能将苹果与梨进行比较。零填充最短轮廓以匹配最长轮廓的大小，然后计算傅立叶描述符。现在你有了系数之间的类比和一个很好的比较。

希望这可以帮助。顺便说一句，我认为用户制作的 FFT 解决方案不可信。寻求解决方案库。如果使用图像，OpenCV 提供傅立叶变换实用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-12T10:40:17.290

如果您希望匹配不同的形状，请尝试使用来自 MPEG-7 标准的不同形状描述符。您可能需要一个分类器，看看 SVM、Boosting、Neural Networks ...：[http ://docs.opencv.org/modules/ml/doc/ml.html](http://docs.opencv.org/modules/ml/doc/ml.html)

# java - 使用 sourceforge spnego 对活动目录进行 SSO 身份验证

> ID：10319252
> 
> 赞同：1
> 
> 时间：2012-04-25T15:55:24.157
> 
> 标签：java, authentication, servlets, servlet-filters, spnego

我已经使用[sourceforge spnego 项目](http://spnego.sourceforge.net/)实现了 SSO 身份验证。

这是我第一次实现任何类型的 servlet 身份验证，所以我可能会遗漏一些非常基本的身份验证或我不知道的 servlet...

我使用的`SpnegoHttpFilter`是与我的过滤器链顶部的库一起打包的，没有覆盖，然后我`QueryFilter`在过滤器链中包含我自己的过滤器，以便我可以将登录名映射到数据库 user_id。登录名称（Windows 域上的 NT 用户 ID）`getRemoteUser`在 HttpRequest 通过后由调用返回`SpnegoHttpFilter`，这一切似乎都工作正常。

我自己的过滤器`QueryFilter`正在做它应该做的事情，它将登录名正确映射到数据库 user_id。我在此过滤器中也有逻辑来拒绝未通过我的身份验证的请求，这也可以正常工作：当我模拟未经授权的请求时，此过滤器将其停止，并且永远不会到达 servlet。

问题是*所有*请求都返回 401（未经授权的 HTTP 请求状态），即使它们通过了 my 中的身份验证`QueryFilter`并在 servlet 上完全正常执行。

我尝试使用以下方法在我自己的过滤器中将响应明确定义为 200 (HTTP Request Status OK)：`myHttpResponse.setStatus(HttpServletResponse.SC_OK)`但这并没有改变任何东西。

为了隔离问题，我`HttpSpnegoFilter`完全删除了这个问题，只是将一个硬编码的登录名（NT 用户 ID）传递给我的`QueryFilter`. 这工作正常，响应不再是 401（未经授权）。

这意味着打包`HttpSpnegoFilter`以某种方式将请求转换为`Unauthorized`. 当我说它实际上没问题时，它不会改变。

有谁知道如何使用这个 spnego sourceforge 项目将响应标头设置为返回 200（OK）？

我来自网络应用程序的完整过滤器链`web.xml`如下，如前所述，我使用`HttpSpnegoFilter`链顶部的包装，然后在其下方使用我自己的过滤器（这似乎正确地完成了它的工作）：

```
<filter>
    <filter-name>SpnegoHttpFilter</filter-name>
    <filter-class>net.sourceforge.spnego.SpnegoHttpFilter</filter-class>

    <init-param>
        <param-name>spnego.allow.basic</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.allow.delegation</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.allow.localhost</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.allow.unsecure.basic</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.login.client.module</param-name>
        <param-value>spnego-client</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.krb5.conf</param-name>
        <param-value>krb5.conf</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.login.conf</param-name>
        <param-value>login.conf</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.preauth.username</param-name>
        <param-value>myADServicePrincipal</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.preauth.password</param-name>
        <param-value>myADServicePrincipalPassword</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.login.server.module</param-name>
        <param-value>spnego-server</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.prompt.ntlm</param-name>
        <param-value>true</param-value>
    </init-param>

    <init-param>
        <param-name>spnego.logger.level</param-name>
        <param-value>1</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>SpnegoHttpFilter</filter-name>
    <servlet-name>QueryServlet</servlet-name>
</filter-mapping>

<filter>
    <filter-name>QueryFilter</filter-name>
    <filter-class>my.package.name.QueryFilter</filter-class>

    <init-param>
        <param-name>query.permission.list</param-name>
        <param-value>getQueryPermission</param-value>
    </init-param>

    <init-param>
        <param-name>remote.user.column</param-name>
        <param-value>nt_user_id</param-value>
    </init-param>

    <init-param>
        <param-name>user.id.column</param-name>
        <param-value>user_id</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>QueryFilter</filter-name>
    <servlet-name>QueryServlet</servlet-name>
</filter-mapping> 
```

我还在`QueryFilter`下面包含了我的完整性（尽管它似乎与我的问题没有任何关系，因为当我不使用`SpnegoHttpFilter`该类并仅将硬编码的 NT 用户 ID 传递给它时，它本身就可以正常工作）。倒数第二行是我明确告诉响应`OK`无效的地方：

```
import java.io.IOException;
import java.util.Map;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public final class QueryFilter implements Filter {

    private MapListDAO myMapListDAO;
    private String myPermissionsList;
    private String myRemoteUserColumn;
    private String myUserIdColumn;

    @Override
    public void init(final FilterConfig filterConfig) throws ServletException {
        myMapListDAO = Config.getInstance(filterConfig.getServletContext()).getMapListDAO();
        myPermissionsList = filterConfig.getInitParameter("query.permission.list");
        myRemoteUserColumn = filterConfig.getInitParameter("remote.user.column");
        myUserIdColumn = filterConfig.getInitParameter("user.id.column");
    }

    @Override
    public void destroy() {
        // TODO ...?
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) 
            throws IOException, ServletException {

        HttpServletRequest httpRequest = (HttpServletRequest) request;
        HttpServletResponse httpResponse = (HttpServletResponse) response;
        String queryName = request.getParameter("queryName");
        // because I have SpnegoHttpFilter earlier in my filter chain
        // this returns the NT User ID (what the user logged in to the domain with)
        String remoteUser = httpRequest.getRemoteUser();
        Map<String, Object> queryPermissions = myMapListDAO.getEntry(myPermissionsList, myRemoteUserColumn, remoteUser);

        // if there is no queryName defined
        if (null == queryName) {
            httpResponse.sendError(HttpServletResponse.SC_BAD_REQUEST, 
                    "Missing queryName parameter.");
            return;
        }

        // if this query is protected perform the gauntlet
        if (myMapListDAO.getList(myPermissionsList).get(0).containsKey(queryName)) {

            // if there is no remoteUser
            if (null == remoteUser || remoteUser.isEmpty()) {
                httpResponse.sendError(HttpServletResponse.SC_UNAUTHORIZED, 
                        "Cannot get remoteUser.");
                return;
            }

            // if the remoteUser does not have any queryPermissions
            if (null == queryPermissions) {
                httpResponse.sendError(HttpServletResponse.SC_UNAUTHORIZED, 
                        "Cannot find queryPermissions for " + remoteUser + ".");
                return;
            }

            // if this remoteUser does not have permission to execute the queryName
            if ((Boolean) queryPermissions.get(queryName)) {
                httpResponse.sendError(HttpServletResponse.SC_UNAUTHORIZED, 
                        "The remoteUser: " + remoteUser + " does not have permission to access queryName: " + queryName + ".");
                return;
            }

        }

        // attempt to add the userId to this request as an attribute we can get later
        if (null != queryPermissions) {
            httpRequest.setAttribute("userId", String.valueOf(queryPermissions.get(myUserIdColumn)));
        }

        // continue to servlet
        httpResponse.setStatus(HttpServletResponse.SC_OK);
        chain.doFilter(request, response);
    }

}

    // attempt to add the userId to this request as an attribute we can get later
    if (null != queryPermissions) {
        httpRequest.setAttribute("userId", String.valueOf(queryPermissions.get(myUserIdColumn)));
    }

    // continue to servlet
    httpResponse.setStatus(HttpServletResponse.SC_OK);
    chain.doFilter(request, response);
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-01T16:14:27.370

因为我的应用程序完全基于 Intranet，所以我最终完全放弃了安全协议。

我只是创建了一个数据库表，其中包含我所有的域 IP 地址和一个用于当前用户 ID、登录时间和注销时间的列。

每当用户登录或注销活动目录时，我都会编写一些服务器端代码来更新此表。

现在，因为我们可以很容易地获得远程地址，所以我编写了一个 servlet 过滤器：

1.  检查它们是否是用户 ID 的 HttpSession 属性
2.  如果不是，则在数据库中查询用户 ID 并将其存储在会话属性中
3.  根据用户 ID 执行一些自定义身份验证并拒绝或通过请求
4.  如果请求通过过滤器，则向我的 servlet 发送一个包装的 HttpRequest，该请求强制`getRemoteUser`调用返回我的用户 ID 会话属性。

我想 Intranet 上的用户可能会更改他们的 IP 地址以复制其他人，但是当我尝试时，我只是收到错误，即存在重复的 IP 地址并且我无法连接到 Intranet 上的任何内容。

**更新（3个月后）：**

最后我选择了[**华夫饼**](http://dblock.github.com/waffle/)。它很容易集成。由于多种原因，我上面的解决方案不可行。

# c# - 我可以以编程方式覆盖客户端 app.config WCF 终结点地址吗？

> ID：10319253
> 
> 赞同：1
> 
> 时间：2012-04-25T15:55:27.610
> 
> 标签：c#, winforms, wcf, web-services

我想覆盖存储在 app.config 中的客户端 WCF 端点地址，以便我可以将它们从指向“localhost”更改为指向生产 URL [取决于可以从应用程序中设置的配置（包含在对象“appConfig”中）在下面显示的代码中） - 这是一个 WinForms 项目。]

通过阅读该领域的其他问题，我已经了解了我从 Form_Load 事件中调用的以下代码片段（调用 InitEndpoint 的 InitAllEndpoints）。我在我的应用程序中尝试了这些，如果我将鼠标悬停在“ep”变量中的值上，它们似乎会更改端点地址。然而，如果我在我的代码之后再次循环通过 serviceModelSectionGroup.Client.Endpoints 我发现它们实际上没有改变。（我现在读到端点地址是不可变的 - 所以我的代码看起来还是错误的，因为我希望用新的端点地址对象覆盖地址 - 而不是 Uri？）

如何以编程方式覆盖客户端 app.config WCF 端点地址？

```
private void InitAllEndpoints()
{
    ServiceModelSectionGroup serviceModelSectionGroup =
               ServiceModelSectionGroup.GetSectionGroup(
               ConfigurationManager.OpenExeConfiguration(
               ConfigurationUserLevel.None));
    if (serviceModelSectionGroup != null)
    {

        foreach (ChannelEndpointElement ep in serviceModelSectionGroup.Client.Endpoints)
        {
            InitEndpoint(ep,

                appConfig.ExternalComms_scheme,
                appConfig.ExternalComms_host,
                appConfig.ExternalComms_port);
        }
    }
}

private void InitEndpoint(ChannelEndpointElement endPoint,  string scheme, String host, String port)
{
    string portPartOfUri = String.Empty;
    if (!String.IsNullOrWhiteSpace(port))
    {
        portPartOfUri = ":" + port;
    }

    string wcfBaseUri = string.Format("{0}://{1}{2}", scheme, host, portPartOfUri);

    endPoint.Address = new Uri(wcfBaseUri + endPoint.Address.LocalPath);
} 
```

注意：我的代理存在于一个单独的项目/DLL 中。

例如

```
public class JournalProxy : ClientBase<IJournal>, IJournal
{
    public string StoreJournal(JournalInformation journalToStore)
    {
        return Channel.StoreJournal(journalToStore);
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:53:47.430

我这样做的唯一方法是替换`EndpointAddress`每个构造的客户端实例。

```
using (var client = new JournalProxy())
{
    var serverUri = new Uri("http://wherever/");
    client.Endpoint.Address = new EndpointAddress(serverUri,
                                                  client.Endpoint.Address.Identity,
                                                  client.Endpoint.Address.Headers);

    // ... use client as usual ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:13:43.297

我通过使用客户端代理中的 ClientBase<> 构造函数来完成修改客户端上 wcf 服务的端点

[MDSN - 客户库](http://msdn.microsoft.com/en-us/library/ms576141.aspx)

```
public class JournalProxy : ClientBase<IJournal>, IJournal 
{     

    public JournalProxy()
        : base(binding, endpointAddress)
    {
    }

    public string StoreJournal(JournalInformation journalToStore)     
    {         
        return Channel.StoreJournal(journalToStore);     
    }   
} 
```

在我的情况下，我从客户端代理中的数据库设置创建绑定和端点，您可以改用 ClientBase(string endpointConfigurationName, string remoteAddress)

# cryptography - 使用字典攻击在 UNIX 中查找所有用户密码的预期时间是多少？

> ID：10319259
> 
> 赞同：-2
> 
> 时间：2012-04-25T15:55:45.977
> 
> 标签：cryptography, password-protection, salt, dictionary-attack

我正在阅读 UNIX 密码算法的设计者使用 12 位盐来修改 unix 散列函数（DES）的 E 表。假设我有一个有 2^(24) 个用户的系统？

用户字典攻击有可能吗？如果是这样，需要多长时间？年？？

我对计算机安全真的很陌生

抱歉编辑：我不确定我想我必须根据我的代码假设每分钟字节数是多少单位时间？

**我问的原因是一个项目，其中一个问题是：“考虑一个有 2^24 个用户的系统。假设每个用户都被分配了一个均匀随机分布的盐，并且任何人都可以读取密码哈希和盐用户。” 使用字典攻击找到所有用户密码的预期时间是多少？”**

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:51:25.970

听起来像是一个家庭作业问题，需要一个公式作为答案。太多的事情未指定。特别是，可以为一个密码预先计算一个字典，其中包含所有可能的盐（2^12 = 4096，不是那么大）。如果所有 2^24 个用户都使用同一个密码，那么每个密码都将在字典中，问题是对 4096 表进行 2^24 次查找的预期时间是多少。另一方面，如果没有用户密码在字典中，那么除非您偶然发现哈希冲突，否则您将永远无法使用字典攻击找到密码。

最好在[**security.stackexchange.com上询问**](https://security.stackexchange.com/)

# c# - 不同视觉树上的 ZIndex

> ID：10319261
> 
> 赞同：1
> 
> 时间：2012-04-25T15:55:52.990
> 
> 标签：c#, wpf, tabcontrol, visual-tree

我必须为`TabControl`. 这种设计使用了`DropShadowEffect`围绕该控件内容部分的边框。此阴影应与 TabControl 中未选择的那些元素重叠，但不应与所选项目重叠。

我的第一种方法是为未选择的项目定义 zIndex = 1、内容容器 = 2 和选定的项目 = 3。但不幸的是，这没有成功，因为内容和选项卡项目不在同一个面板。

有什么想法可以实现预期的目标吗？

WPF Inspector 可视化树截图：
![在此处输入图像描述](../Images/9e5599221869cfa8f221e25fa73c5b7d.png)

我需要内容下方的一些 TabItems 和上方的一个..

# postgresql - Tomcat 7 上的连接池

> ID：10319266
> 
> 赞同：0
> 
> 时间：2012-04-25T15:56:19.007
> 
> 标签：postgresql, jakarta-ee, connection-pooling, tomcat7

我在 tomcat7 上实现连接池时遇到问题。出于某种原因，tomcat 试图连接我的机器用户名。我已经用谷歌搜索了一段时间，但没有运气。

```
org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory 
(FATAL: role "caspinol" does not exist)
Cant connect to db
Log In failed: An Exception has occurred! java.lang.NullPointerException
java.lang.NullPointerException
 at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1549)... 
```

我的 context.xml 如下所示：

```
<Resource auth="Container" name="jdbc/postgres" type="javax.sql.DataSource" user="biller" password="biller" 
            driverClassName="org.postgresql.Driver" url="jdbc:postgresql://localhost:5432" maxActive="150"
            schema="biller" maxIdle="4"/> 
```

和 web.xml：

```
<resource-ref>
    <description>postgreSQL Datasource</description>
    <res-ref-name>jdbc/postgres</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
</resource-ref> 
```

我正在使用 jdbc4.jar postgres 驱动程序。如果有人可以查看并指出错误是什么，我将不胜感激

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T06:26:05.043

网址似乎是错误的。试试这个网址：

```
jdbc:postgresql://localhost:5432/<db_name> 
```

将 替换为`<db_name>`实际的数据库名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-16T04:16:08.727

这不是该问题的正确解决方案，但可以帮助使用正确连接字符串搜索相同问题的人。

检查您的网络连接访问：像连接字符串

```
jdbc:postgresql://[::1]:5432/<db_name> 
```

uses IPv6, This will break other connections like accessing wsdl urls from application that are available only via IPv4. Please hava a look on network connection especially windows 8.

# google-app-engine - KeyProperty 对象没有属性 get

> ID：10319267
> 
> 赞同：0
> 
> 时间：2012-04-25T15:56:23.913
> 
> 标签：google-app-engine, app-engine-ndb

我将 a`_post_put_hook`放入我的 NDB 模型类型之一，这样每当放置该类型的实体时，它都会使 memcache 键无效。该键由设置键的 urlsafe 版本组成。但是，当这段代码运行时，它会这样说：

```
Traceback (most recent call last):
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1536, in __call__
    rv = self.handle_exception(request, response, e)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1530, in __call__
    rv = self.router.dispatch(request, response)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1102, in __call__
    return handler.dispatch()
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 572, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 570, in dispatch
    return method(*args, **kwargs)
  File "U:\Hefner\Dropbox\Public\Projects\GHI\dev\rpc.py", line 68, in get
    result = func(*args)
  File "U:\Hefner\Dropbox\Public\Projects\GHI\dev\rpc.py", line 154, in pub_refreshSandbox
    team_key = s.create.team("Cool Group")
  File "U:\Hefner\Dropbox\Public\Projects\GHI\dev\GlobalUtilities.py", line 534, in team
    new_team.put()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\model.py", line 2902, in _put
    return self._put_async(**ctx_options).get_result()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\tasklets.py", line 320, in get_result
    self.check_success()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\tasklets.py", line 315, in check_success
    self.wait()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\tasklets.py", line 299, in wait
    if not ev.run1():
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\eventloop.py", line 219, in run1
    delay = self.run0()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\eventloop.py", line 181, in run0
    callback(*args, **kwds)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\tasklets.py", line 454, in _on_future_completion
    self._help_tasklet_along(gen, val)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\tasklets.py", line 368, in _help_tasklet_along
    self.set_result(result)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\ext\ndb\tasklets.py", line 264, in set_result
    callback(*args, **kwds)
  File "U:\Hefner\Dropbox\Public\Projects\GHI\dev\DataModels.py", line 182, in _post_put_hook
    tools.expireCache('allteams-' + self.settings.get().websafe)
AttributeError: 'KeyProperty' object has no attribute 'get' 
```

这是相关的模型类：

```
class Team(ndb.Expando):
    name = ndb.StringProperty()
    show_team = ndb.BooleanProperty()
    settings = ndb.KeyProperty()

    @classmethod
    def _post_put_hook(self, future):
        memcache.delete('allteams-' + self.settings.get().websafe) 
```

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:08:38.427

在这种情况下 self.settings 不是实际的键而是 Models 属性，因为这是一个类方法而不是实例方法。你需要处理未来的对象。
这里的文档：[https ://developers.google.com/appengine/docs/python/ndb/futureclass](https://developers.google.com/appengine/docs/python/ndb/futureclass)

在这种情况下：

```
@classmethod
def _post_put_hook(self, future):
    entitykey = future.get_result()
    entity    = entitykey.get()
    memcache.delete('allteams-' + entity.settings.get().websafe) 
```

不知道`websafe`对你有什么好处。也许你的意思是`entity.settings.urlsafe()`？

# ios - 接受提示后核心位置未更新

> ID：10319269
> 
> 赞同：4
> 
> 时间：2012-04-25T15:56:28.327
> 
> 标签：ios, core-location

我正在使用核心位置框架来定位设备，一旦使用位置调用 locationManager:didUpdateToLocation:fromLocation: 方法，我就会停止跟踪用户。

但是，我第一次启动该应用程序（从全新安装）。当我向我的位置管理器发送 startUpdatingLocation 消息时，用户会收到接受或拒绝位置服务的警报。

当我接受跟踪没有开始时，只有当我离开并回到这个视图控制器时，当再次调用 startUpdatingLocation 时，通知才会开始进入。

我正在实现 locationManager:didChangeAuthorizationStatus: 认为当用户接受（或拒绝）位置服务时会收到消息，但事实并非如此。

一旦位置服务消息被解除，任何人都可以指出我更新位置的正确方向吗？

谢谢。

使用代码示例更新

我有一个封装我的逻辑的单例类，想法是在请求用户位置时，对 CLLocation 的时间戳进行检查，如果它太旧，则发送开始跟踪消息，这会延迟加载我的 CLLocationManager iVar，

```
-(void)startTracking{

    if(!self.locationManager)
        _locationManager = [[CLLocationManager alloc] init];

    if([CLLocationManager authorizationStatus] == kCLAuthorizationStatusDenied){
        [self invalidateUserLocation];
    }else{
        self.locationManager.delegate = self;
        [self.locationManager startUpdatingLocation];
    }

} 
```

收到的新位置：

```
- (void)locationManager:(CLLocationManager *)manager 
    didUpdateToLocation:(CLLocation *)newLocation 
           fromLocation:(CLLocation *)oldLocation
{
    _userLocation = [newLocation retain];

    NSDictionary * info = [NSDictionary dictionaryWithObject:self.userLocation 
                                                      forKey:@"userLocation"];

    [[NSNotificationCenter defaultCenter] postNotificationName:kUserLocationFound 
                                                        object:self 
                                                      userInfo:info];
    [self stopTracking];

} 
```

停止跟踪：

```
-(void)stopTracking{
    if(!self.locationManager)
        return;

    [self.locationManager stopUpdatingLocation];
    self.locationManager.delegate = nil;
} 
```

当我有一个需要用户位置的视图控制器时，我像这样在我的单例对象上调用 userLocation。如果它是最近的，我返回 CLLocation，否则我返回 nil 并重新开始。请注意，当我收到第一次更新时，我会停止跟踪。但是第一次运行并且我得到警报视图时，根本没有跟踪任何内容。

```
- (CLLocation*)userLocation
{
    if(_userLocation.coordinate.latitude == 0 && _userLocation.coordinate.longitude == 0){
        [self startTracking];
        return nil;
    }else{
        NSDate* timeNow = [NSDate date];
        NSTimeInterval interval = [timeNow timeIntervalSinceDate:_userLocation.timestamp];
        if(interval >10)
             [self startTracking];

        return _userLocation;
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-25T21:52:12.593

你试过打电话`– locationManager:didChangeAuthorizationStatus:`吗`CLLocationManagerDelegate`？

我猜你会`startTracking`在视图控制器加载时调用。这被询问是否可以的警报所规避。此时，开始定位消息将不再被调用，因此通过调用`didChangeAuthorizationStatus`，您可以调用您的`startTracking`方法。

就像是：

```
-(void)locationManager:(CLLocationManager *)manager didChangeAuthorizationStatus:(CLAuthorizationStatus)status {

    if (status == kCLAuthorizationStatusDenied) {
        //location denied, handle accordingly
    }
    else if (status == kCLAuthorizationStatusAuthorized) {
        //hooray! begin startTracking
    }

} 
```

如果不是这样，请告诉我。

# c# - 应该在哪个库中定义抽象工厂接口和实际工厂？

> ID：10319273
> 
> 赞同：2
> 
> 时间：2012-04-25T15:56:34.343
> 
> 标签：c#, .net, dependency-injection, instantiation

# 简短的问题

我应该把抽象工厂接口和实际工厂放在哪里？

# 概述

我正在编写一个简单的视频转码应用程序，我正试图围绕依赖注入来解决问题。

我已将我的应用程序分成 Visual Studio 中的几个项目。

*   一个用于转码器的类库，由应用程序引擎使用
*   一个用于应用程序引擎的类库，将由 gui 或控制台界面使用
*   目前将作为主要用户界面的一个控制台应用程序

# 无 DI

这是依赖注入之前的一切

转码器库：

```
namespace SimpleFFmpeg {
    public interface ITranscoder {
        void Transcode(String fileName);

    }

    public class Transcoder:ITranscoder {
        // ...

        public void Transcode(String fileName) {
            // do transcoding stuff
        }

        // ...
    }
} 
```

PusherEngine 库：

```
using SimpleFFmpeg;
namespace PusherLib {
    public class PusherEngine {
        private readonly List<VideoItem> _items;

        public PusherEngine() {
            _items = new List<VideoItem>();
        }

        // ...

        public void processItems() {
            foreach (VideoItem item in _items) {
                ITranscoder t = new Transcoder();
                t.Transcode(item.FileName);
            }
        }

        // ...
    }
} 
```

实际应用：

```
namespace Pusher {
    class Program {
        static void Main(string[] args) {
            PusherEngine pe = new PusherEngine();
            pe.addVideoItem(new VideoItem(...));
            pe.processItems();
        }
    }
} 
```

# 重构以使用 DI

我创建了一个通用抽象工厂接口，就像这个问题中建议的那样：[Creating new instances while still using Dependency Injection](https://stackoverflow.com/questions/6915252/creating-new-instances-while-still-using-dependency-injection)

```
public interface IFactory<T> {
    T Get();
} 
```

接下来我创建一个创建 ITranscoders 的工厂

```
public class TranscoderFactory: IFactory<ITranscoder> {
    public ITranscoder Get() {
        return new SimpleFFmpeg.Transcoder();
    }
} 
```

然后我修改 PusherEngine 以在构造函数中要求工厂依赖：

```
using SimpleFFmpeg;
namespace PusherLib {
    public class PusherEngine {
        private readonly IFactory<ITranscoder> _transcoderFactory;
        private readonly List<VideoItem> _items;

        public PusherEngine(IFactory<ITranscoder> transcoderFactory) {
            _items = new List<VideoItem>();
            _transcoderFactory = transcoderFactory;
        }

        // ...

        public void processItems() {
            foreach (VideoItem item in _items) {
                ITranscoder t = _transcoderFactory.Get();
                t.Transcode(item.FileName);
            }
        }

        // ...
    }
} 
```

最后，在程序中它看起来像这样：

```
namespace Pusher {
    class Program {
        static void Main(string[] args) {
            IFactory<ITranscoder> f = new TranscoderFactory();
            PusherEngine pe = new PusherEngine(f);
            pe.addVideoItem(new VideoItem(...));
            pe.processItems();
        }
    }
} 
```

# 问题

IFactory 接口应该在哪个库/项目中定义？TranscoderFactory 应该在哪个库/项目中定义？

他们住在转码器库中吗？在 PusherLib 中？还是在实际的前端应用程序中？我正在寻找最佳实践。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:25:44.367

在我看来，没关系。对我来说，依赖注入的要点是能够在测试时注入不同于实际实现的东西。我将单元测试与用于测试的各种模拟定义一起保存在一个单独的项目中。真正的实现以及“抽象”逻辑都保存在同一个程序集/项目/命名空间中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:53:28.313

如果你真的需要工厂（见评论），那么Mark Seemann 的[这篇博客文章](http://blog.ploeh.dk/2012/03/15/ImplementingAnAbstractFactory.aspx)解决了这个问题。

简而言之，如果您在工厂中使用 IoC 容器，您希望在组合根中使用它。如果不是，它与它正在实例化的类保持在同一个程序集中是没有害处的。

**编辑**

对于您的特定情况，您不需要工厂，因为您已经拥有解决这种依赖关系所需的一切。

```
using SimpleFFmpeg;
namespace PusherLib {
    public class PusherEngine {
        private readonly ITranscoder _transcoder;
        private readonly List<VideoItem> _items;

        public PusherEngine(ITranscoder transcoder) {
            _items = new List<VideoItem>();
            _transcoder = transcoder;
        }

        // ...

        public void processItems() {
            foreach (VideoItem item in _items) {
                _transcoder.Transcode(item.FileName);
            }
        }

        // ...
    }
} 
```

初始化将如下所示：

```
namespace Pusher {
    class Program {
        static void Main(string[] args) {
            ITranscoder t = new Transcoder();
            PusherEngine pe = new PusherEngine(t);
            pe.addVideoItem(new VideoItem(...));
            pe.processItems();
        }
    }
} 
```

您链接的答案中需要工厂的原因是依赖项需要仅在运行时知道的值才能被实例化，而您的依赖项不需要创建运行时依赖的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T12:15:27.980

要回答您的实际问题，而不是这是否是工厂的好用例：

为了这个目的，我有时会分成不同`Interface`的`Implementation`项目，像你的 IFactory<> 这样的东西会存在于 Common.I 项目中。这并非在所有情况下都有效，但这种方法对我来说的一个优点是，`Implementation`当底层技术发生变化时，我可以用模拟或新实现替换 dll。
例如，我们最近从解析目录中的 xml 文件切换到从服务中获取数据。我唯一需要在客户端机器上更新的是这个`Implementation`dll，因为界面根本没有改变。

但我想最后这并不重要，如前所述。

# iphone - 我可以用来唯一识别 iOS 设备的长期方法是什么？

> ID：10319275
> 
> 赞同：19
> 
> 时间：2012-04-25T15:56:41.213
> 
> 标签：iphone, objective-c, ios

唯一注册iOS设备的最佳方式是什么，不受未来Apple限制的限制？

我目前注册iOS设备的方法（基本上是唯一标识设备）是我使用iOS设备的UDID来识别它并注册它，然后在识别它之后执行必要的操作。

问题是 UIDevice uniqueIdentifier 属性已被弃用。我知道有一些解决方法（如[本问题中所讨论的）。](https://stackoverflow.com/questions/6993325/uidevice-uniqueidentifier-deprecated-what-to-do-now)

一种可能性是使用 iOS 设备的 MAC 地址。但是，我觉得苹果可能会在未来的某个时候限制对这些信息的访问。

有没有其他方法（除了访问 MAC 地址）来识别 iOS 设备，我们将来可以依赖它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-08T03:39:09.940

Using Apple's preferred method of generating a CFUUIDRef is probably the better solution as I feel the MAC address may be removed in the future as well. If you use this and save it to your NSUserdefaults you will have it persist unless the user deletes the app. If you want to have a generated unique ID that you can share between apps or persist between installs you should look at using the UIPasteboard and saving your generated UID with a key that you share between apps.

```
//Create a unique id as a string
CFUUIDRef theUUID = CFUUIDCreate(NULL);
CFStringRef string = CFUUIDCreateString(NULL, theUUID);

//create a new pasteboard with a unique identifier
UIPasteboard *pasteboard = [UIPasteboard pasteboardWithName:@"youruniquestring" create:YES];

[pasteboard setPersistent:YES];

//save the unique identifier string that we created earlier
[pasteboard setString:((__bridge NSString*)string)];

 //accessing it
UIPasteboard *pasteboard = [UIPasteboard pasteboardWithName:@"youruniquestring" create:NO];
NSLog([pasteboard string]); 
```

I have written a brief tutorial here but its basically the lines above: [http://www.roostersoftstudios.com/2012/03/26/a-way-to-share-data-between-apps-on-a-given-ios-device/](http://www.roostersoftstudios.com/2012/03/26/a-way-to-share-data-between-apps-on-a-given-ios-device/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T07:17:47.753

除非您的应用程序用于管理我的 Apple 设备，否则这是错误的方法。作为用户，我不想让你知道我使用的是哪种设备。我希望你能认出我，无论我使用什么设备。我希望能够更换有缺陷的设备。Apple*将*越来越多地限制对这些信息的访问。

[编辑] 我看不出 MAC 地址是如何工作的。我的 iOS 设备可以有多个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-04T18:39:17.613

另一种选择是动态生成您自己的 UUID。

```
CFUUIDRef uuid = CFUUIDCreate(NULL); 
CFStringRef generatedUuidStr = CFUUIDCreateString(NULL, uuid);
CFRelease(uuid);
NSString* uuidStr = [(NSString*)generatedUuidStr autorelease]; 
```

您可以在 NSUserDefaults 中保留此 UUID 以实现基于安装的唯一性。如果基于设备的唯一性确实是最重要的事情（以便在卸载和重新安装后保留 ID），您将需要一种机制来将 ID 保留在设备上。我认为您可以考虑使用钥匙串来保留该 ID，该 ID 应该在应用程序卸载之后仍然存在。您甚至可以在将 UUID 添加到钥匙串时使用访问组，这样您就可以拥有一套使用相同 UUID 的应用程序。

有关保存钥匙串项目和检索它们的更多信息，请参阅苹果的安全框架参考。

[http://developer.apple.com/library/ios/#DOCUMENTATION/Security/Reference/SecurityFrameworkReference/_index.html](http://developer.apple.com/library/ios/#DOCUMENTATION/Security/Reference/SecurityFrameworkReference/_index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T16:10:22.713

我见过的最好的方法是使用钥匙串。您可以使用*CFUUIDCreateString*函数生成 UUID 并将其存储在钥匙串中。此数据在安装和从备份恢复之间保留在设备中。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-04-25T16:16:45.697

使用设备 Mac 地址。我想它就像你需要的一样独特。

[如何以编程方式获取 iphone 的 MAC 地址](https://stackoverflow.com/questions/677530/how-can-i-programmatically-get-the-mac-address-of-an-iphone)

# html - 如何使用 Google Chrome 扩展向图像添加 HTML 链接？

> ID：10319276
> 
> 赞同：0
> 
> 时间：2012-04-25T15:56:41.333
> 
> 标签：html, css, google-chrome-extension, inject

我使用我的 Google Chrome 扩展程序，使用 CSS 将图像插入到某个域上的所有页面中。用户不断要求我将图像链接到域的主页。我不知道该怎么做。

图片位于页面的右上角。基本上我只需要注入html

```
<a href="domain.com">[IMAGE]</a> 
```

其中 [IMAGE] 是图像。

我不认为我可以用 CSS 做到这一点，所以我不知道该怎么做。

* * *

更新：

我需要将它附加到**当前**元素，而不是创建新元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:41:19.243

您可以添加一个注入正确 html 的 js 文件，而不仅仅是使用 css 文件。

这是您的 js 可能的样子：

```
var node = document.createElement("a");
node.setAttribute('href',"http://canop.org");
var img = document.createElement("img");
img.setAttribute('src', "http://canop.org/chrall/screens/screen_01.png");
node.appendChild(img);
document.body.​insertBefore(node, document.body.​​​​​​​​​​​​​firstChild);​ 
```

这是一个演示 js 的小提琴：http: [//jsfiddle.net/dystroy/sftAX/](http://jsfiddle.net/dystroy/sftAX/)

# c# - 尝试从动态自定义控件中检索值

> ID：10319278
> 
> 赞同：0
> 
> 时间：2012-04-25T15:56:42.570
> 
> 标签：c#, xml, winforms, custom-controls, dynamic-controls

我需要从自定义控件中的文本框中检索文本。自定义控件是 ArrayList 的一部分，因此可以在表单上显示多个自定义控件。如何从 ArrayList 中的一个控件中的单个文本框访问文本？

下面的代码显示了我如何创建动态自定义控件：

```
 ArrayList assessmentInfo = new ArrayList();

    int length = (int)moduleInfoLevel6.numericUpDownModuleAssessmentNum.Value;
    for (int i = 0; i < length; i++)
    {
        assessmentInfo.Add(new AssessmentInfo());
        System.Drawing.Point p = new System.Drawing.Point(10, 160 + i * 32);
        (assessmentInfo[i] as AssessmentInfo).Location = p;
        (assessmentInfo[i] as AssessmentInfo).Size = new System.Drawing.Size(440, 32);                
        tabPageLevel6.Controls.Add((assessmentInfo[i] as AssessmentInfo));
    } 
```

以下是显示自定义控件如何显示的屏幕截图：

评估信息自定义控件

[http://i.imgur.com/9qwCL.jpg](http://i.imgur.com/9qwCL.jpg)

自定义控件如何在窗体上显示

[http://i.imgur.com/DFJYV.jpg](http://i.imgur.com/DFJYV.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:11:39.637

您可以为每个控件添加一个名称

就像是：

```
(assessmentInfo[i] as AssessmentInfo).Name = "assessmentInfo" + i.ToString(); 
```

那么您可以通过以下方式访问它

```
foreach (object control in tabPageLevel6.Controls)
{
    if (control is AssessmentInfo)
    {
        if ((control as AssessmentInfo).Name == "assessmentInfo1")
            // do something with the control
            MessageBox.Show((control as AssessmentInfo).Name);                    
    }
} 
```

# ruby-on-rails-3 - Rails 3.2.1 登录有两个可能的答案：js 或 html

> ID：10319279
> 
> 赞同：0
> 
> 时间：2012-04-25T15:56:51.017
> 
> 标签：ruby-on-rails-3

我有一个使用 Ajax 发送登录信息的登录表单。

如果登录错误，我会发送一个 .js，显示一些警报并摇动表单。

如果登录成功，我只想重定向整个页面。

Rails 控制器总是期望一个 .js 调用，实际上在这两种情况下我都会发送一个 .js 回复，因为 rails 中的重定向将进入浏览器期望的一些 .js 回复。

```
login wrong:
$("#login").effect("shake", { times:2 , distance:10},20);

login successfull:
window.location.replace("<%=root_url(:only_path => false)%>enterprises/"); 
```

问题是这是否是一种好方法（我个人不喜欢它，但它有效）还是更好的方法来处理这个问题。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T20:29:20.513

我认为这是一个很好的解决方案。也许我会在成功依赖助手而不是硬编码路径的情况下修复 url，但这是一件小事。

如果用户在浏览器中禁用了 javascript，那么对这两个操作都有一个额外的 .html 视图可能会很好。

# php - 在构建链接时减轻 xss 攻击

> ID：10319284
> 
> 赞同：1
> 
> 时间：2012-04-25T15:57:09.337
> 
> 标签：php, security, xss, linkify

我不久前发布了这个问题，它非常适合从用户生成的帖子中查找和“链接”链接。 [Linkify 正则表达式函数 PHP 大胆火球法](https://stackoverflow.com/questions/10002227/linkify-regex-function-php-daring-fireball-method)

```
 <?php
if (!function_exists("html")) {
function html($string){
    return htmlspecialchars($string, ENT_QUOTES, 'UTF-8');
}
}

if ( false === function_exists('linkify') ):   
  function linkify($str) {
$pattern = '(?xi)\b((?:(http)s?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:\'".,<>?«»“”‘’]))';
return preg_replace_callback("#$pattern#i", function($matches) {
    $input = $matches[0];
    $url = $matches[2] == 'http' ? $input : "http://$input";
    return '<a href="' . $url . '" rel="nofollow" target="_blank">' . "$input</a>";
}, $str); 
}
endif;

echo "<div>" . linkify(html($row_rsgetpost['userinput'])) . "</div>";

?> 
```

我担心我可能会通过将用户生成的内容插入链接来引入安全风险。`htmlspecialchars($string, ENT_QUOTES, 'UTF-8')`在通过 linkify 函数运行它并回显到页面之前，我已经在转义来自我的数据库的用户内容，但是我在 OWASP 上读到需要对链接属性进行特殊处理以缓解 XSS。我认为这个功能没问题，因为它将用户生成的内容放在双引号内并且已经用 转义了`htmlspecialchars($string, ENT_QUOTES, 'UTF-8')`，但非常感谢具有 xss 专业知识的人来确认这一点。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T05:39:57.607

首先数据在进入数据库之前一定不能被转义，这是非常严重的错误**。**这不仅不安全，而且会破坏功能。链接字符串的值会导致数据损坏并影响字符串比较。这种方法是不安全的，因为[XSS 是一个输出问题](https://sitewat.ch/en/Blog/5)。当您将数据插入数据库时​​，您不知道它出现在页面上的什么位置。例如，即使您使用此函数，以下代码仍然容易受到 XSS 攻击：

例如：

```
<a href="javascript:alert(1)" \> 
```

就您的正则表达式而言。我最初的反应是，这是一个可怕的想法。没有评论它*应该*如何工作以及大量使用 NOT 运算符，黑名单**总是**比白名单更糟糕。

所以我加载了[Regex Buddy](https://stackoverflow.com/questions/2348694/how-do-you-debug-a-regex)，**大约 3 分钟后**，我用这个输入绕过了你的 regex：

```
https://test.com/test'onclick='alert(1);// 
```

没有开发人员愿意编写易受攻击的代码，因此他们是由程序员认为他的应用程序如何工作以及它实际上如何工作的故障引起的。在这种情况下，我会假设您从未测试过这个正则表达式，并且它对问题的过度简化。

[HTMLPurifer](http://htmlpurifier.org/)是一个旨在清理 HTML 的 php 库，它由**数千个**正则表达式组成。它非常慢，并且经常被绕过。所以如果你走这条路，一定要定期更新。

在修复这个缺陷方面，我认为你最好使用`htmlspecialchars($string, ENT_QUOTES, 'UTF-8')`，然后强制字符串以“http”开头。HTML 编码是一种转义形式，值会自动解码，从而使 URL 不受干扰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T05:52:21.060

因为数据进入一个属性，它应该是 url（或百分比）编码：

```
return '<a href="' . urlencode($url) . '" rel="nofollow" target="_blank">' . "$input</a>"; 
```

*从技术上讲*，它也应该是 html 编码的

```
return '<a href="' . htmlspecialchars(urlencode($url)) . '" rel="nofollow" target="_blank">' . "$input</a>"; 
```

但没有浏览器我知道关心，因此没有人这样做，听起来你可能已经在做这一步，你**不想**这样做两次

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-05T23:38:39.480

首先，正如 PHP 文档所述，htmlspecialchars 仅在未设置[ENT_NOQUOTES](http://php.net/htmlspecialchars)时转义“'&'（与号）变为'&''”'（双引号）变为'"'。"'"（单引号）变为'''（或 ') 仅当设置了 ENT_QUOTES 时。'<'（小于）变为 '<' '>'（大于）变为 '>'"。javascript: 仍在常规编程中使用，所以为什么 : 没有转义超出了我的范围。

其次，如果 !html 只期望您认为将被输入的字符，而不是那些可以输入并被视为有效的字符的表示。utf [-8 字符集](http://www.utf8-chartable.de/)，以及所有其他字符集都支持同一字符的多种表示形式。此外，您的错误陈述允许 0-9 和 az，因此您仍然需要担心[base64 characters](http://en.wikipedia.org/wiki/Base64)。我认为你的代码是一个很好的尝试，但它需要大量的改进。那或者你可以只使用[htmlpurifier](http://htmlpurifier.org/)，人们仍然可以绕过它。我确实认为在 htmlspecialchars 中设置字符集真是太棒了，因为大多数程序员不明白他们为什么要这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T13:55:50.420

您的正则表达式正在寻找 http 或 https 的 url。该表达式似乎相对安全，因为 in 不会检测到任何不是 url 的内容。

XSS 漏洞来自将 url 转义为 html 参数。这意味着确保 url 不能过早地转义 url 字符串，然后向@Rook 提到的 html 标记添加额外的属性。

所以我真的想不出如何按照@tobyodavies 的建议执行 XSS 攻击，但没有 urlencode，它会做其他事情：

```
$pattern = '(?xi)\b((?:(http)s?://|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:\'".,<>?«»“”‘’]))';
return preg_replace_callback("#$pattern#i", function($matches) {
    $input = $matches[0];
    $url = $matches[2] == 'http' ? $input : "http://$input";
    return '<a href="' . htmlspecialchars($url) . '" rel="nofollow" target="_blank">' . "$input</a>";
}, $str); 
```

请注意，我还添加了一个小快捷方式来检查 http 前缀。

现在您生成的锚链接是安全的。

但是，您还应该清理文本的其余部分。我想您根本不想允许任何 html 并将所有 html 显示为明文。

# ruby-on-rails - url_for 如何检查来自我的 routes.rb 的约束

> ID：10319285
> 
> 赞同：0
> 
> 时间：2012-04-25T15:57:11.403
> 
> 标签：ruby-on-rails, routes

我尝试在我的 rails 应用程序上定义一些翻译路线。路由随子域定义而变化。所以我想要这个结果：

```
 describe "url_for" do
    context 'with en' do
      it 'brand translate' do
        url_for(
          :controller => 'boats',
          :action => 'index',
          :subdomain => :en,
          :brand => 'hello',                                                                                                                                                         
          :only_path => true
        ).should == '/yacht-charter/brand-hello'
      end
    end

    context 'with fr' do
      it 'brand translate' do
        url_for(
          :controller => 'boats',
          :action => 'index',
          :subdomain => :fr,
          :brand => 'hello',
          :only_path => true
        ).should == '/location-bateau/marque-hello'
      end 
    end   
  end 
```

就像您可以看到两个 url_for 参数之间的唯一变化是子域。我尝试：

```
 constraints => :subdomain => :en  do                                                                                                                   
    match '/yacht-charter/brand-:brand' => 'boats#index', :as => 'en_brand_search'
  end 

  constraints :subdomain => :fr do
    match '/location-bateau/marque-:brand' => 'boats#index', :as => 'fr_brand_search'
  end 
```

但它始终是定义它使用的第一条路线。第二个是永远不会定义的。

我怎样才能做到这一点。这是一个rails错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:13:01.900

Not sure about it being a rails bug or not, but have a look at [https://github.com/francesc/rails-translate-routes](https://github.com/francesc/rails-translate-routes) it works well and may help achieving this.

# c - sysmalloc：断言失败 - 我该如何解决？

> ID：10319288
> 
> 赞同：3
> 
> 时间：2012-04-25T15:57:15.397
> 
> 标签：c, memory, graph, malloc

我正在编写一些简单的函数来管理图形。

当我运行我的程序时，会发生以下错误：

```
malloc.c:3096: sYSMALLOc: Assertion `(old_top == (((mbinptr) (((char *)
&((av)->bins[((1) - 1) * 2])) - __builtin_offsetof (struct malloc_chunk, fd))))
&& old_size == 0) || ((unsigned long) (old_size) >= (unsigned long)
((((__builtin_offsetof (struct malloc_chunk, fd_nextsize))
+((2 * (sizeof(size_t))) - 1)) & ~((2 * (sizeof(size_t))) - 1)))
&& ((old_top)->size & 0x1) && ((unsigned long)old_end & pagemask) == 0)' failed. 
```

我执行 valgrind，它显示了这个错误：

```
==5903== Memcheck, a memory error detector
==5903== Invalid write of size 4
==5903==    at 0x8048866: creategraph
==5903==    by 0x8048718: readFile
==5903==    by 0x80486BF: main
==5903==  Address 0x41c3204 is 0 bytes after a block of size 4 alloc'd
==5903==    at 0x4027ABA: malloc (vg_replace_malloc.c:263)
==5903==    by 0x8048850: createGraph
==5903==    by 0x8048718: readFile
==5903==    by 0x80486BF: main 
```

这是我的结构

```
typedef struct GRAPH {
   int id;
   int destination;
   int cost;
   struct GRAPH *next;
   struct GRAPH *prev;
} GRAPH; 
```

这是我的函数 readFile

```
void readFile() {
   FILE *f = NULL;
   char c;
   f = fopen("g.txt", "r");
   if (f == NULL) {
     puts("Error");
   }
   int line = 0, column = 0;
   g = createGraph(16);
   while (!feof(f)) {
     c = fgetc(f);
     if (c == '\n') {
        line++;
     } else if (c == '1') {
        createEdge(line, column, 1, g);
        column++;
     }
   }
  fclose(f);
 } 
```

这是我的函数 createGraph

```
graph **creatgraph(int tV) {
   int i;
   graph **v;
   v = (graph**) malloc(sizeof (graph*));
   if (v == NULL) {
      puts("Error");
      exit(EXIT_FAILURE);
   }
   for (i = 0; i < tV; i++) {
      v[i] = NULL;
   }
   return v;
} 
```

这是我的函数 createVertex

```
graph *createVertex() {
   graph *newVertex = NULL;
   newVertex = (graph*) malloc(sizeof (graph));
   if (newVertex == NULL) {
      puts("Error");
      exit(EXIT_FAILURE);
   }
   newVertex->id = 0;
   newVertex->destination = 0;
   newVertex->cost = 1;
   newVertex->next = NULL;
   novoVertice->prev = NULL;
   return (newVertex);
} 
```

这是我的函数 createEdge

```
void createEdge(int vStart, int vFinal, int id, graph** g) {
   graph *newVertex = createVertex();
   newVertex->destination = vFinal;
   newVertex->id = id;
   g[vFinal] = insertLast(g[vStart], newVertex);
} 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:00:11.447

这里有一个内存损坏错误：

```
 v = (graph**) malloc(sizeof (graph*));
   ...
   for (i = 0; i < tV; i++) {
      v[i] = NULL;
   } 
```

您只为一个`graph*`指针分配存储空间，但将分配的块视为足够大以容纳`tV`此类指针。

要修复，将该`malloc()`调用更改为：

```
 v = (graph**) malloc(tV * sizeof (graph*)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:01:52.023

您正在分配一个只有一个元素的指针数组。尝试：

```
graph **creatgraph(int tV) {
   int i;
   graph **v;
   v = malloc(tV * sizeof *v);
   if (v == NULL) {
      puts("Error");
      exit(EXIT_FAILURE);
   }
   for (i = 0; i < tV; i++) {
      v[i] = NULL;
   }
   return v;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:10:07.340

此错误意味着您在某处损坏了内存。例如，使用 Valgrind 运行您的代码，以查找您的程序失败的地方。

# javascript - 用jquery重置html表单后如何执行代码？

> ID：10319289
> 
> 赞同：52
> 
> 时间：2012-04-25T15:57:18.743
> 
> 标签：javascript, html, jquery

单击 html 重置按钮后，

```
<input type="reset" /> 
```

我想执行一些代码。我怎样才能做到这一点并确保在这样做之前重置表单？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2014-02-08T02:50:29.320

我不是特别喜欢将重置事件绑定到重置按钮而不是表单的想法。可以通过其他方式重置表单，在这种情况下，您的事件将不会触发。

相反，将函数绑定到重置事件，但将其置于瞬时 setTimeout 中。它将确保在调用函数之前实际重置表单。

```
$('form').on('reset', function(e)
{
    setTimeout(function() { /* ... */ });
}); 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-04-25T16:09:40.757

最好像 Ben 一样使用 setTimeout：[https ://stackoverflow.com/a/21641295/144665](https://stackoverflow.com/a/21641295/144665)

```
$("input[type='text']").val('Hello Everybody!');

$("input[type='reset']").closest('form').on('reset', function(event) {

  // executes before the form has been reset
  console.log('before reset: ' + $("input[type='text']").val());

  setTimeout(function() {
    // executes after the form has been reset
    console.log('after reset: ' + $("input[type='text']").val());
  }, 1);

}); 
```

您可能希望将该表单选择器缩小到所涉及的特定表单，可能带有一个 id。

小提琴证明：http: [//jsfiddle.net/iambriansreed/Zh5cd/](http://jsfiddle.net/iambriansreed/Zh5cd/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T16:13:00.957

更新：使用`preventDefault`而不是`return false`.

```
$('input[type="reset"]').click(function(evt) {
    // Prevent the reset button from firing the form's reset event again
    evt.preventDefault();
    $(this).closest('form').get(0).reset();
    // At this point your form's inputs should have their values reset
}); 
```

[http://jsfiddle.net/EYqrX/1/](http://jsfiddle.net/EYqrX/1/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-14T18:25:22.367

建议不要以这种方式使用`<input type='Reset'>`use ，而`<input type = "button">`不必停止`reset`按钮的默认行为。您只需将`onclick`属性添加到按钮，并且在函数中您可以在任何您希望的地方调用表单的重置方法并根据需要控制行为。下面的代码说明了

**HTML：**

```
<input type="button" value="Limpiar" onclick="resetForm(this);"/> 
```

* * *

**JavaScript：**

```
function resetForm(element) {
    //Do what you need before reset the form
    element.form.reset(); //Reset manually the form
    //Do what you need after reset the form
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T16:00:16.377

尝试

```
$('your-form').bind('reset', function() {
  alert('hi');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-10T13:32:19.373

这里有一个使用`onreset`事件的示例，类似于您通常如何使用`onsubmit`表单元素的事件来捕获单击提交按钮的方式。添加示例以`onsubmit`进行说明。

在您的脚本中：

```
function submitForm(form){
    var xhr = new XMLHttpRequest(),
        data = new FormData(form);

    xhr.open("POST", url, true);
    xhr.onload = function(event) {
        switch (event.target.status){
            case 200:
                onSuccess(event);
                break;
            default:
                onError(event);
        }
    };
    xhr.send(data);
    return false;
}

function resetForm(form){
    var elements = form.elements;
    // set some initial values to those form elements
    return false;
} 
```

在您的 html 中：

```
<form onsubmit="return submitForm(this);" onreset="return resetForm(this);">
    <button type="submit">Save</button>
    <button type="reset">Reset</button>
</form> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-29T22:08:44.153

单击重置按钮时重置显示内容。

```
$('.custom-file-input').on('change', function(){
    const $label = $(this).next('.custom-file-label');
    const fileName = $(this).val().split('\\').pop(); 
    $label.data('default', $label.html());
    $label.addClass('selected').html(fileName);
});

$('form').on('reset', function(){
    $('.custom-file-input').each(function(){
        const $label = $(this).next('.custom-file-label');
        $label.html($label.data('default'));
    });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-16T14:05:01.023

我最终使用了一个承诺来允许我将 dom 更改链接在一起。这样，我可以确保先重置表单，然后再重置其他需要根据表单输入进行更改的 dom 内容，其中也包括重置表单。我不一定期望表单重置失败，所以我不使用拒绝功能：

```
const form = document.getElementById("saveForm");
const resetBtn = form.querySelector("button[type=reset]");
resetBtn.addEventListener("click", function overrideReset(e) {
    e.preventDefault();
    return new Promise((resolve, reject) => resolve(form.reset())).then(() => {
        //run code here.
    });
}); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-04-25T16:02:10.090

这有帮助吗

```
 $("input[type='reset']").on("click", function(){
    alert("the form has been reset");
  }); 
```

链接到 jsfiddle：http: [//jsfiddle.net/sdkTz/1/](http://jsfiddle.net/sdkTz/1/)

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2012-04-25T16:08:46.623

将`click`事件添加到重置按钮，并使其看起来像这样：

```
function(e) {
    setTimeout(function() {
        // your actual code here
    },1);
} 
```

# android - 为什么 ScrollView 有时（！）在调用 scrollTo 时不滚动（在 onClick 事件中）

> ID：10319290
> 
> 赞同：3
> 
> 时间：2012-04-25T15:57:21.643
> 
> 标签：android, onclick, scrollview

所以我在屏幕的右侧有这个按钮（`ImageView`带有方法），当我把它拉到左边时，它会延伸到你可以选择一天中的时间的地方。为了创建它，我制作了一个水平视图，左侧是透视视图，右侧是“按钮”+ （主要在屏幕之外）。“按钮”有一个和监听器。`onClick``SeekBar``ScrollView``LinearLayout``SeekBar``OnTouch``OnClick`

在 onTouch 中，scrollview 被告知要根据手指移动的位置来平滑滚动到正确的位置。当您移动小于某个阈值并释放时，将调用 onClick。

在 onClick 我已经告诉滚动视图`smoothScrollTo`// `scrollTo`。`fullScroll`fullScroll 从来没有工作过。smoothScrollTo 大部分时间都在一台设备上工作（HTC Desire 与 Android 2.2.2），但从未在另一台设备（三星 Galaxy Tab（旧款）与 Android 2.2）上的 ONCLICK（？）上工作。scrollTo 有时在两种设备上都可以使用...我确信`onClick`当我记录它启动时以及在告诉`ScrollView`滚动之后直接调用它。

我尝试将 scrollTo 发布到`ScrollView`可运行和延迟可运行中：

```
scrollView.postDelayed(new Runnable() {

   @Override
   public void run() {
       scrollView.scrollTo(left, 0);
       Log.d("SomeTag", "The scroller should scroll to: "+left);
   }
}, 200); 
```

但这与不发布它一样经常（有时）起作用......

我不知所措。我习惯于使用 Android 并习惯于不同的设备表现不同，但我不习惯在同一设备上“有时”工作而“有时”没有相同的呼叫......任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-21T08:13:03.917

See [this answer](https://stackoverflow.com/a/18930335/2153244).

`ScrollView.scrollTo()` may not working if some layout changes are being made when you called the method. And you are right, using `postDelayed()` you cannot guarantee that layout changes in will always finish within the same delay time.

# php - Facebook解码Json

> ID：10319292
> 
> 赞同：0
> 
> 时间：2012-04-25T15:57:29.087
> 
> 标签：php, json

我想解码用户的位置。认为

```
"id": "100000564553314",
"name": "Adi Mathur",
"location": {
      "id": "106487939387579",
      "name": "Gurgaon, Haryana"
} 
```

我正在使用脚本来获取名称，但位置给了我一个错误

> 不能将 stdClass 类型的对象用作数组

```
$token_url = "https://graph.facebook.com/oauth/access_token?"
   . "client_id=" . $app_id . "&redirect_uri=" . urlencode($my_url)
   . "&client_secret=" . $app_secret . "&code=" . $code;

$response = file_get_contents($token_url);
$params = null;
parse_str($response, $params);

$graph_url = "https://graph.facebook.com/me?access_token=" 
. $params['access_token'];

$user = json_decode(file_get_contents($graph_url));

echo $_SESSION['name']=$user->name;  // WORKS 
echo $_SESSION['fbid']=$user->id;     // WORKS

echo $_SESSION['location']=$user->location[0]; // ERROR
echo $_SESSION['location']=$user->location->name; // ERROR 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:01:29.397

考虑使用：

```
$user = json_decode(file_get_contents($graph_url), true); 
```

这将确保 $user 是关联数组而不是对象。然后你可以像这样设置你的 $_SESSION 变量：

```
$_SESSION['name']=$user['name'];
$_SESSION['fbid']=$user['id'];
$_SESSION['location']=$user['location']['name']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:01:31.760

添加第二个参数`assoc`，如下`true`所示`json_decode`：

```
json_decode(file_get_contents(...),true); 
```

这将返回一个数组而不是一个对象。然后您可以使用数组表示法`[]`而不是对象运算符`->`

# dynamics-crm - 动态 CRM DDL？- 将一组更改传达给另一个实例的最简单方法

> ID：10319296
> 
> 赞同：2
> 
> 时间：2012-04-25T15:57:38.623
> 
> 标签：dynamics-crm, dynamics-crm-2011

Dynamics CRM 2011 相当新。

我正在使用另一个客户的服务接口创建与 Dynamics CRM 的数据集成。服务接口效果很好，但是我们需要将一些自定义字段（属性）添加到它们的实例中。客户不会在他们的开发/测试实例上给我们临时管理员甚至“定制者”角色来创建额外的属性。

我们已经尝试用散文描述我们需要他们进行的更改，但总是需要一天的时间在电子邮件中往返，并且有些事情会正确完成，而其他字段在他们第一次尝试更改后需要进行小的更正. （痛苦）

(1) 有没有办法在**DDL**类型脚本中导出模式更改？**我对“解决方案**”知之甚少，我正在尝试创建一个。但是对于像这样的一小部分更改，他们可以检查然后运行的 DDL 脚本似乎是显而易见的解决方案。

我知道自定义 Dynamics CRM 具有出色的编程访问权限。(2) 这是导出模式更改的选项，还是不是它的用途？

(3) 如果“**解决方案**”是我最好的选择，我应该知道哪些技巧可以让每个人都能轻松轻松地处理这少数新领域、关系和查找？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T17:08:20.663

(1) 对 CRM 基础架构的直接更改是不受支持的更改。您的 DDL 脚本可能会工作，但是如果您走这条路并且无法保证工作，那么如果您没有得到支持，您将失去从 Microsoft 获得支持的能力。

(2) 不支持。和上面一样。

(3) 解决方案绝对是这里最好的选择。可以在这里找到关于他们所做工作的一个很好的介绍：[http](http://www.dynamicscrmtrickbag.com/2011/05/28/dynamics-crm-2011-solutions-part-1/) ://www.dynamicscrmtrickbag.com/2011/05/28/dynamics-crm-2011-solutions-part-1/ 。针对您的场景的一些具体提示：

*   制作一个新的解决方案（您以后可以修改它）。这将是您的非托管解决方案。

*   您将要寻找的关键概念是实体属性。使用解决方案编辑器（组件->实体->字段）进行修改并保存解决方案。

*   将解决方案发送给他们以作为托管或非托管解决方案导入，在您的情况下，非托管可能是首选（因此他们可以进行调整并导出他们的更改以发送回给您），但托管确保他们不会搞砸。选择一种类型并始终向他们发送该类型。

# c++ - 多处理器提升::线程？所有线程在一个处理器上运行

> ID：10319297
> 
> 赞同：4
> 
> 时间：2012-04-25T15:57:46.873
> 
> 标签：c++, multithreading, boost, parallel-processing, boost-thread

我有一个令人尴尬的并行问题，我想在多个处理器上执行。我原以为这`boost::thread`会自动将新线程发送到新处理器，但它们都在与父进程相同的核心上执行。是否可以让每个线程在不同的处理器上运行，或者我需要像 MPI 这样的东西吗？

我的怀疑是这`boost::thread`根本不是一个多处理器工具，我要求它做一些不是为它设计的事情。

编辑：我的问题归结为：为什么所有线程都在一个处理器上执行？有没有办法`boost::thread`将线程发送到不同的处理器？

这是我的代码的相关示例：

```
size_t lim=1000;
std::deque<int> vals(lim);
std::deque<boost::thread *> threads;
int i=0; 
std::deque<int>::iterator it = vals.begin();
for (; it!=sigma.end(); it++, i++) {
  threads.push_back(new boost::thread(doWork, it, i));
  while (threads.size() >= maxConcurrentThreads) {
    threads.front()->join();
    delete threads.front();
    threads.pop_front();
  }
}
while(threads.size()) {
  threads.front()->join();
  threads.pop_front();
} 
```

应该清楚，`doWork`使用参数进行一些计算`i`并将结果存储在`vals`. 我的想法是设置`maxConncurrentThreads`等于可用的核心数量，然后每个线程将使用空闲的核心。我只需要有人确认`boost::thread`不能以这种方式工作。

（我想有比使用队列更好的方法来限制并发线程的数量；也请随意责骂我。）

* * *

这是`doWork`功能：

```
void doWork(std::deque<int>::iterator it, int i) {
  int ret=0;
  int size = 1000; // originally 1000, later changed to 10,000,000
  for (int j=i; j<i+size; j++) {
    ret+=j;
  }
  *it=ret;
  return;
} 
```

* * *

编辑：正如 Martin James 建议的那样，问题在于 doWork 函数最初只有 1000 个 int 加法。对于这么小的作业，调度线程比执行线程花费的时间更长，因此只使用了一个处理器。使工作更长（添加 10,000,000 个整数）会产生所需的行为。关键是：默认情况下`boost::thread` *将*使用多个内核，但是如果您的线程做的工作比调度线程少，那么您将看不到多线程的任何好处。

感谢大家帮助我理解这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:13:25.300

您总是加入队列中的第一个线程。如果这个线程需要很长时间，它可能是唯一剩下的线程。我想您想要的是在*任何*线程完成后启动一个新线程。

我不知道为什么您只能获得一个有效的并发级别。

在查看了 doWork 函数之后，我认为它所做的工作是如此之少，以至于它所花费的工作比首先启动一个线程要少。尝试用更多的工作（1000x）运行它。

# html - CSS HTML如何忽略非ie7或ie8的一些css

> ID：10319298
> 
> 赞同：0
> 
> 时间：2012-04-25T15:57:46.800
> 
> 标签：html, css

因此，我有以下 CSS 用于将背景图像的大小设置为 div 的 100%。

```
#solutionsNav div.leadgen {
background:url(/images/leadGen_bg2.png) no-repeat;
background-size: 100% 100%;  
filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/images/leadGen_bg2.png', sizingMethod='scale');
-ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/images/leadGen_bg2.png', sizingMethod='scale')";
behavior: url(/scripts/PIE.htc);
padding: 10px;
color: #FFF;
cursor: pointer; 
```

}

这似乎现在在所有浏览器中都有效，但唯一的问题是在 IE7 和 IE8 中，当图像被拉伸以适合 div 时，我可以看到背景的轮廓：url(/images/leadGen_bg2.png)。而且我已经测试过，如果我在上面取出 background:url(/images/leadGen_bg2.png) ，它在 IE7 和 IE8 中仍然可以正常工作，但在 Firefox 中无法再看到它。

我怎么能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T15:59:32.557

使用条件注释来加载专门用于 IE8 及更低版本的样式表，并使用它来加载所有的 hax。

```
<!--[if lte IE 8]><link rel="stylesheet" href="ie-hax.css" /><![endif]--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:01:27.400

要扩展 Kolink 的答案：

```
<!--[if lte IE 8]>
#solutionsNav div.leadgen { background: none; }
<![endif]--> 
```

确保此规则出现在您在答案中定义的规则之后，以便优先。为您的 IE hack 使用单独的样式表是个好主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:05:33.787

我使用[条件类](http://lostmonocle.com/post/108304549/css-tip-conditional-classes)来解决这个问题。例如，如果您将开始`<body>`标签替换为：

```
<!--[if lt IE 7 ]><body class="oldie ie6"><![endif]-->
<!--[if IE 7 ]><body class="oldie ie7"><![endif]-->
<!--[if IE 8 ]><body class="ie8"><![endif]-->
<!--[if IE 9 ]><body class="ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><body><!--<![endif]--> 
```

...您将获得一系列专门针对 Internet Explorer 的课程。您可以在 CSS 中专门针对 IE，如下所示：

```
/* Good browsers */
#solutionsNav div.leadgen {
    background:url(/images/leadGen_bg2.png) no-repeat;
    background-size: 100% 100%;  
    padding: 10px;
    color: #FFF;
    cursor: pointer;
}
/* IE-specific code */
.oldie #solutionsNav div.leadgen,
.ie8 #solutionsNav div.leadgen {
    filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/images/leadGen_bg2.png', sizingMethod='scale');
    -ms-filter: "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/images/leadGen_bg2.png', sizingMethod='scale')";
    behavior: url(/scripts/PIE.htc);
} 
```

# c# - WPF项目的方程可视化

> ID：10319304
> 
> 赞同：0
> 
> 时间：2012-04-25T15:58:01.920
> 
> 标签：c#, wpf, math, expression

我有一个用 C# 编写的 wpf 项目，我想可视化复杂的数学表达式。

是否有任何工具/api 可以用于此目的（向最终用户显示复杂的数学表达式）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T12:04:30.373

试试这个： [https ://launchpad.net/wpf-math](https://launchpad.net/wpf-math)

# android - 内存管理逻辑的总可用内存

> ID：10319306
> 
> 赞同：0
> 
> 时间：2012-04-25T15:58:13.317
> 
> 标签：android

我在释放内存时遇到问题。我有一个`Hashmap`我正在添加一个`Bitmap`，并且位图的数量非常大。出于这个原因，我得到`OutOfMemoryError`. 因此，为此我决定在内存紧缩或系统堆内存不足时释放`Bitmap`最少使用的内容。`Collection`

为了获得当前可用的内存，我使用了“ **ActivityManager.MemoryInfo.availMem** ”，但它给出了总 RAM 大小的内存，而不是可用的堆内存。而且我发现这个内存在从集合**中释放位图时没有得到更新。**

然后我使用了这三种方法：

```
Debug.getNativeHeapAllocatedSize()
Debug.getNativeHeapFreeSize()
Debug.getNativeHeapSize() 
```

但我发现 NativeHeapSize 继续增加到某个水平，比如 16 MB，然后`OutOfMemoryError`发生变化。在这方面，我发现`NativeHeapAllocatedSize`and`getNativeHeapSize`并没有`Bitmap`从`Collection`.

我该如何解决这个问题？

我的问题是我想计算分配的最大可用应用程序内存和当前可用内存，这样如果当前可用内存超出阈值内存，我将从`Bitmap`集合中释放一些内存，[垃圾收集](http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29)将回收内存并释放它而不生成错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:08:23.070

存储`Bitmaps`在内存中非常昂贵。根据图像格式，每个像素最多可消耗 4 个字节的内存。

您是否同时显示`Collection`全部`Bitmaps`？如果不是，我强烈建议 store**不要**存储未显示`Bitmaps`的内容，而是`URI`为图像存储 a 并在需要时动态加载它。

如果您要显示整个集合，我会确保您将位图下采样到适当的大小，这样您就不会存储未渲染的像素。

# mysql - 组织和优化大表

> ID：10319311
> 
> 赞同：1
> 
> 时间：2012-04-25T15:58:32.393
> 
> 标签：mysql, optimization, database-optimization

我正在构建一个速度至关重要的预测拨号器。为了拨打这个号码，我从表格中提取客户信息并构建呼叫文件以供 pbx 采取行动。

目前，我为每个区号都有一个表格，我们一次拨打一个区号，但我们正在切换到一个模型，在该模型中，我们根据跨越多个邮政编码的领土进行拨号。一些区号存在于多个邮政编码中。每个表每月都会添加新号码，并通过与数百万个号码的请勿呼叫列表进行比较来清理。

所以我的问题是，我应该如何最有效地组织这些数据？

一张大表似乎适得其反，因为我们正在谈论数百万条已清理数据的记录。

我目前的推理是维护区号表以进行导入和清理，然后将清理后的记录复制到地区表中，通过在地区代码表中搜索该地区的邮政编码来创建。

我目前通过一个 auto_incremented INT 主键、一个唯一的电话号码和一个跟踪已被呼叫的号码的状态来索引这些表，或者在请勿呼叫列表中。在构建通话文件时，我将记录标记为排队，然后根据通话完成后的方式进行标记，因此对于每个通话，都会进行一次搜索和两次更新。

搜索在区域代码表中查找特定状态。更新基于记录 ID。

问题的核心是：按邮政编码组织并按状态搜索会更快，还是按区号组织它们并按状态和邮政编码搜索？或者每次我们建立一个从区号表构建的区域时，最好的办法是创建一个新表？

如果这似乎是一个愚蠢的问题，请原谅我，我一直在自学 SQL，因为我一直在构建它，并且数据库设计和性能的细微差别有点超出我的技能范围。

表的总大小为 200 万行并且还在增长。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T17:54:05.623

> 问题的核心是：按邮政编码组织并按状态搜索会更快，还是按区号组织它们并按状态和邮政编码搜索？或者每次我们建立一个从区号表构建的区域时，最好的办法是创建一个新表？

**答：除非你真的知道自己在做什么，否则不要做任何这些。** 相反，创建一个表来保存该实体的所有行，使用列值来区分各种邮政编码和地区。可能创建`zipcodes`和`territory`表，并添加引用它们的外键。

根据属性值创建单独的表格不是典型的解决方案，并且会引入许多额外的困难（例如，如果您按邮政编码组织表格，如何按地区搜索所有邮政编码？）

更常见的解决方案，也是数据库擅长的一种解决方案，是使用索引。使用多个索引，数据库可以提供对表的快速访问，以便在多个不同列上进行搜索。

所以我推荐的基本策略：

1.  创建逻辑数据模型
2.  实现物理数据模型
3.  分析性能
    *   [`explain <query>`](http://dev.mysql.com/doc/refman/5.5/en/explain-output.html)很方便
    *   如果还不够好，请考虑添加更多索引、改进现有索引的使用（阅读聚集索引和覆盖索引）或选择性非规范化
    *   选择和插入之间的平衡是什么？索引可以减慢插入速度

同样重要的是要注意，200 万行对于 MySQL 来说并不是一个巨大的数字（当然，这取决于负载）。底线是优化是一个非常棘手的主题，其答案取决于您的具体情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-02T14:09:16.763

如果你想要速度，规范化数据不是你想要的。当数据增长时，速度性能会降低。

这种情况下的性能将与硬盘的速度有关，ssd 可能会大大提高性能，但是您会遇到空间问题并且价格更高

权衡可以使用旋转磁盘而不是规范化数据。索引用于执行搜索的字段。

其他策略（更聪明）可以对可以在数据集上重复的数据使用整数代码，并使用来自 memcache 的邮政编码、城市等的真实值（邮政编码、国家名称、城市是不是可变的），但这种方法为问题增加了新的依赖关系。

我有一个包含 2.5 亿行的表，这些信息用国家和城市、邮政编码和 ISP 标记。我有 ssd 来存储主要数据，地理数据存储在 memcached 中，当我需要进行一些搜索时，我有一个逻辑层来进行查找并转换为数据库中的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T04:59:42.460

TaoNonnanes，不需要`territory`每次都为`area code table`.

只制作了一张外键`area code table`为区域和区号表的索引的区域表，并尝试将整个数据库标准化至少到 3NF。我不知道您的整个数据库规范化是什么。

# macports - 阻止 MacPorts 安装预构建的包？

> ID：10319314
> 
> 赞同：12
> 
> 时间：2012-04-25T15:58:48.157
> 
> 标签：macports

我正在尝试使用 MacPorts 安装 libiconv。我需要构建它以在我的 Mac 运行 10.6 时在 OS X 10.5 中运行。所以我添加了这样的`macports.conf`：

```
macosx_deployment_target 10.5 
```

据说这会迫使 MacPorts 使用 10.5 SDK 构建端口。但是，已安装的库仍然包含`LC_DYLD_INFO`仅在 10.6 中可用的加载命令。

我使用 -v 选项重新安装了该端口，发现它无需编译即可下载并安装预构建的软件包。该软件包显然是在 10.6 机器上构建的。

问题是：如何强制 MacPorts 使用我的设置在我的机器上构建端口？谢谢。

编辑：我正在使用以下命令构建 x86/x64 通用二进制文件：

```
sudo port -v install libiconv +universal 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-25T18:18:19.920

呸！在一天中的大部分时间里，我一直在上下左右寻找。在我发布问题之后，我自己就发现了。

添加`-s`到`port`命令，它将在本地提取和编译源代码：

```
sudo port -s -v install libiconv +universal 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-19T22:59:00.797

`buildfromsource`从 MacPorts 2.1.0 开始，在配置文件中调用了一个新设置`/opt/local/etc/macports/macports.conf`来控制预建档案的使用：

```
# When to build ports from source. Default is 'ifneeded', which downloads an
# archive if available or builds from source otherwise. 'always' has the same
# effect as -s on the command line, and 'never' is likewise the same as -b.
#buildfromsource    ifneeded 
```

# java - onDestroy() 同时“等待” onActivityResult()

> ID：10319330
> 
> 赞同：17
> 
> 时间：2012-04-25T15:59:54.943
> 
> 标签：java, android, ondestroy

我有一个包含两个活动的应用程序：“A”和“B”。

“A”用于`startActivityForResult()`产生“B”，即它等待“B”。现在，假设“B”在前台。Android系统可以在不破坏“B”的情况下破坏活动“A”吗？（如果是，那么当“B”完成时，例如在用户输入之后，Android 系统必须重新创建活动“A”并再次将其置于前台，我需要记住并将“A”恢复到其早期的 UI 状态。 )

请注意，我不是在谈论进程*终止*（这是不同的情况：如果一个进程被终止，则所有活动都将被终止，并且不会调用或不保证调用 onDestroy()）。问题仅仅是关于在等待子活动结果时是否可以使用 onDestroy()。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-25T16:06:51.530

如果活动 A 在 B 完成时被杀死，则可以保证

1.  A*将*被重新创建。
2.  A*将*提供结果。

换句话说，A 将在用户下次访问/需要它时重新创建，届时将传递任何未决结果（从 B 到 A）。

另请注意，这就是为什么必须通过带有整数请求代码的单个 Activity 回调而不是任意回调对象来返回结果的原因。

# forms - 在输入中使用 0 值时出现 Codeigniter 验证错误

> ID：10319335
> 
> 赞同：0
> 
> 时间：2012-04-25T16:00:15.130
> 
> 标签：forms, codeigniter, codeigniter-2, codeigniter-form-helper

我认为 codeigniter 表单验证类中有一个错误。

如果值大于零但如果它是“0” set_value 函数不起作用，我的代码工作得很好：

控制器：

```
 $this->form_validation->set_rules('age', 'Age', 'required|is_natural'); 
```

看法：

```
<?  if(set_value('age')) { ?>           
<input id="age" name="age" type="text" value="<?=set_value('age')?>" />                                          
<? } else { ?>
<input id="age" name="age" type="text" value="Age" /> 
<? } ?> 
```

我做错了什么还是这是一个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:04:59.020

`0`当值是因为您的`if`语句将其评估为`FALSE`然后输出没有`value`属性的表单字段时，您的表单字段不会被重新填充。

所以，摆脱这种`if`说法。你只是想要这个：

```
<input id="age" name="age" type="text" value="<?=set_value('age')?>" /> 
```

`set_value()`将要么返回值（如果提供），要么返回默认值，如果没有提供值，则返回空字符串。

# r - 根据每日时间序列数据进行预测

> ID：10319338
> 
> 赞同：0
> 
> 时间：2012-04-25T16:00:16.683
> 
> 标签：r, xts

> **可能重复：**
> [预测时间序列数据](https://stackoverflow.com/questions/10302261/forecasting-time-series-data)

我有每日数据，想根据数据进行预测：

```
Date        Used
11/1/2011   587
11/2/2011   578
11/3/2011   600
11/4/2011   599
11/5/2011   678
11/6/2011   555
11/7/2011   650
11/8/2011   700
11/9/2011   600
11/10/2011  550
11/11/2011  600
11/12/2011  610
11/13/2011  590
11/14/2011  595
11/15/2011  601
11/16/2011  700
11/17/2011  650
11/18/2011  620
11/19/2011  645
11/20/2011  650
11/21/2011  639
11/22/2011  620
11/23/2011  600
11/24/2011  550
11/25/2011  600
11/26/2011  610
11/27/2011  590
11/28/2011  595
11/29/2011  601
11/30/2011  700
12/1/2011   650
12/2/2011   620
12/3/2011   645
12/4/2011   650
12/5/2011   639
12/6/2011   620
12/7/2011   600
12/8/2011   550
12/9/2011   600
12/10/2011  610
12/11/2011  590
12/12/2011  595
12/13/2011  601
12/14/2011  700
12/15/2011  650
12/16/2011  620
12/17/2011  645
12/18/2011  650
12/19/2011  639
12/20/2011  620
12/21/2011  600
12/22/2011  550
12/23/2011  600
12/24/2011  610
12/25/2011  590
12/26/2011  750
12/27/2011  750
12/28/2011  666
12/29/2011  678
12/30/2011  800
12/31/2011  750 
```

我真的很感激这方面的任何帮助。我正在处理时间序列数据，需要能够根据历史数据创建预测。

1.  首先我尝试将其转换为 xts：

    `x.xts<-xts(x$Used, x$Date)`

2.  将 x.xts 转换为常规时间序列：

    `x.ts<-as.ts(x.xts)`

3.  将值放入 ets：

    `x.ets <- ets(x.ts)`

4.  进行了 10 个时期的预测：

    `x.fore<-forecast(x.etc, h=10)`

5.  `x.fore`这是：

    `Point Forecast Lo 80 Hi 80 Lo 95 Hi 95 87 932.9199 831.7766 1034.063 778.2346 1087.605 88 932.9199 818.1745 1047.665 757.4319 1108.408 89 932.9199 805.9985 1059.841 738.8103 1127.029 90 932.9199 794.8706 1070.969 721.7918 1144.048 91 932.9199 784.5550 1081.285 706.0153 1159.824 92 932.9199 774.8922 1090.948 691.2375 1174.602 93 932.9199 765.7692 1100.071 677.2849 1188.555 94 932.9199 757.1017 1108.738 664.0292 1201.811 95 932.9199 748.8254 1117.014 651.3717 1214.468 96 932.9199 740.8897 1124.950 639.2351 1226.605`

6.  当我尝试绘制 时`x.fore`，我得到一个图表，但 xaxis 显示的是数字而不是日期：

![在此处输入图像描述](../Images/c436418cf9986b39c8bf465f73b54672.png)

7.  我正在做的步骤是否正确？如何更改 xaxis 以读取显示日期？我非常感谢您的任何意见？

# reflection - 是否有任何语言可以获取局部变量或传递参数的名称？

> ID：10319340
> 
> 赞同：0
> 
> 时间：2012-04-25T16:00:25.887
> 
> 标签：reflection

我正在寻找一种非常“了解”自身的语言。

由于我不知道是否有这样的语言或它是什么，所以我在这里以 Java 为例。

例如，它可以获得为局部变量定义的“名称”。

```
String google = "http://google.com";
System.out.println(google.???);
// it prints `google` 
```

或者获取传递的参数名称：

```
void hello(String name) {
   System.out.println(name.???);
}

String jeff = "My name is Jeff";
hello(jeff);
// it prints `jeff`, not `My name is Jeff` 
```

有没有语言有这样的力量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:07:24.727

这称为“反射”。大多数现代语言都有这样的特点。

*   PHP： http: [//php.net/manual/en/book.reflection.php](http://php.net/manual/en/book.reflection.php)
*   Java：http: [//java.sun.com/developer/technicalArticles/ALT/Reflection/](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:09:10.430

搜索java和introspection。您可以获得属性的名称和类型、方法名称和参数。Objective-c 也有类似的特性。

# java - 为什么调用 remove 方法时会删除整个 ArrayList 列表？

> ID：10319348
> 
> 赞同：2
> 
> 时间：2012-04-25T16:00:57.837
> 
> 标签：java, jpa, arraylist, persistence

首先，我有两个实体。

用户.java

```
@Entity
public class User { 
    @Id
    private String username;
    private String password;
    @OneToMany(mappedBy = "to", cascade=CascadeType.PERSIST, orphanRemoval=true)
    private ArrayList<Message> messages;
}

public void deleteMessage(Message message){
        System.out.println(messages);
        messages.remove(message);
        System.out.println(messages);
} 
```

消息.java

```
@Entity
public class Message {

    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    private String id;
    @ManyToOne
    @NoGson
    private User to;
} 
```

ArrayList 消息包含该用户的消息，并且该列表中的每条消息都具有该用户的“收件人”字段。所有这些都正确地保留了下来。但是，当我运行 deleteMessage 方法时，第一个 sysout 正确给出了完整列表，而第二个 sysout 只给出了 null 而不是没有删除消息的列表。

我不知道它是否与 jpa 有关，或者我只是犯了一个愚蠢的错误，但我找不到 remove 方法只是删除整个 ArrayList 的原因。当我调用 deleteMessage 函数时，我还调用实体管理器的 remove 方法从数据库中删除消息。

## 更新

经过更多测试后，我注意到第二个 sysout 确实给出了正确的输出。所以问题不在于 ArrayList 中的 remove 方法。但是arraylist在执行以下方法后变为null。

```
public void deleteMessage(Message message) {
    em.remove(message);
} 
```

所以现在我知道这是一个 JPA 问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:15:50.877

您似乎在说的是，之前`messages.remove()`是`messages`对列表的引用，但之后引用为空。如果这是真的，那么可能性是相当有限的。可能有另一个线程正在修改状态，或者可能发生了一些面向方面的魔法。您可能会从尝试[提供 SSCCE](http://sscce.org/)中受益，因为您将在此过程中自己发现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:14:08.090

我通过将必须删除的消息的*to*字段重置为空来解决了这个问题。这样双向连接就被破坏了。如果我再次从上面运行*deleteMessage*方法，则 ArrayList 不会更改为 null 并且一切正常。

# php - 控制器在 CodeIgniter 中的 URL 中重复

> ID：10319350
> 
> 赞同：1
> 
> 时间：2012-04-25T16:01:02.037
> 
> 标签：php, apache, .htaccess, codeigniter, wamp

我有一个`Register`看起来像这样的控制器：

```
class Register extends CI_Controller
{
    public function index()
    {
        $this->load->view('register');
    }

    public function create()
    {
        $this->load->library('form_validation');
        //set rules here

        if ($this->form_validation->run() == TRUE)
        {
            //everything checks out
        }
        else
        {
            $this->load->view('register');
        }
    }
} 
```

该视图包含一个发布到 的表单`register/create`。

我的问题是，当我`localhost/register`错误地填写表格时，表格会重新加载，但现在的网址是：

`localhost/register/register/create`

如果我再次输入错误

`localhost/register/register/register/create`

等等...

我猜这是一个`htaccess`并且我已经尝试使用一些在线可用的标准 CodeIgniter htaccess 文件，但没有一个可以解决这个问题。我在 WAMP 服务器上使用它。

**编辑**

视图文件目前仅包含表单。我更喜欢使用直接 HTML 而不是 CodeIgniter 表单助手。

```
<form id="register_form" method="post" action="register/create" title="Create an Account">
    <!-- input fields -->
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:18:52.420

使用完整的网址。或者在您的表单的操作中`current_url()`。`site_url('register')`

使用这些或前缀是一种很好的做法，`base_url()`因为这允许您的站点运行而不必是域路径。
例如，如果需要，您可以在 example.com/my_site/ 上运行该站点，而不是只能在 example.com 上运行。

为了尽可能全面地控制表单的操作，请始终从相对 url 开始`http://`并避免使用相对 url（例如 action="register"）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-25T16:18:33.923

将表单的 action 参数从 更改`register/create`为`/register/create`。您正在发布到相对 URL。通过将斜杠添加到 action 参数的开头，您可以使 URL 成为绝对 URL。因此，表格将始终发布到`http://domain-name/register/create`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-30T17:27:23.997

我遇到了同样的问题，我可以通过在我的域之前将“http://”放在我的 base_url 中来解决它，如下所示：

```
$config['base_url'] = 'http://example.com'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-09T00:08:19.540

添加`base_url()`您的网址：

```
<a href="<?=base_url()?>/mypage"> 
```

# sql - 如何提高访问谷歌云SQL中大量数据的速度

> ID：10319352
> 
> 赞同：0
> 
> 时间：2012-04-25T16:01:15.343
> 
> 标签：sql, cloud

我尝试将图像文件存储到`MEDIUMBLOB`谷歌云 sql 中。但它只能存储不到1k。我想存储 6K 文件。我怎么解决这个问题？还是我必须将其拆分并存储？我花了 4 天时间，但我什至有任何提示。

如果我上传超过 1k，它会显示一条消息：

> 结果集中的一些值被截断。

这是服务器中的sql代码

```
statement = "INSERT INTO picture (registration_id, pic) VALUES( ?, ?)";
stmt = c.prepareStatement(statement);
stmt.setString(1, sender_id);
stmt.setBytes(2, message.getBytes());

int success = 2;
success = stmt.executeUpdate();` 
```

请帮我

*   感谢您使用`LONGBLOB`.
    但我之前试过，结果还是只能不到1kbyte。
    我认为 google cloud sql 存在容量限制。
    还有其他人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:05:35.183

您可以转换为 LONGBLOB

# javascript - 正则表达式（javascript）提取前面有一些常量字符串的字符串

> ID：10319354
> 
> 赞同：2
> 
> 时间：2012-04-25T16:01:17.790
> 
> 标签：javascript, regex, extract

我正在尝试提取一个前面有一些常量字符串的字符串，示例如下。

```
string ="deleteabc@bcd" 
match should be "abc@bcd"
or
string = "deletebcd@def"
match should be "bcd@def" 
```

如您所见，我想在常量字符串“delete”之后提取任何内容，请帮助，在此先感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:08:49.240

如果您只想删除前缀

```
function removePrefix(str, prefix) {
    if (str.search(prefix) === 0) {
        return str.substr(prefix.length);
    } else {
        return str;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:09:28.153

```
string = "deleteabc@bcd"
result = string.match(/^delete(.+)/)
console.log(result[1]) 
```

abc@bcd

# android - 我可以将多个翻译动画添加到一个 AnimationSet

> ID：10319357
> 
> 赞同：3
> 
> 时间：2012-04-25T16:01:26.200
> 
> 标签：android, android-animation, android-imageview

我想将多个翻译动画添加到一个 AnimationSet。我目前正在通过为 AnimationSet 设置一个侦听器并在 onAnimationEnd() 方法上执行一个新的 AnimationSet 来执行此操作（见下文）。这是很多代码，想知道这是否可以在一个 AnimationSet 中完成

任何的想法？

```
view_2_anim_c.setAnimationListener(new AnimationListener() {

        public void onAnimationStart(Animation animation) {
            // TODO Auto-generated method stub

        }

        public void onAnimationRepeat(Animation animation) {
            // TODO Auto-generated method stub

        }

        public void onAnimationEnd(Animation animation) {
            // TODO Auto-generated method stub
            apa2.startAnimation(view_2_anim_d);
            //viewBAnimationD(apa2, 0);
        }
    }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T16:04:35.650

AnimationSet 可以包含任意数量的动画。如果您希望第二个平移动画在第一个动画之后开始，您可以将第二个动画的 startoffset 设置为与第一个动画的持续时间相同。这样做的一个限制是您只能在单个视图上执行动画。如果您希望翻译一个视图，然后完成另一个视图，您应该使用 AnimationListener 来运行新动画。

# sbt - 如何在运行时覆盖 Play 2.0 依赖项？

> ID：10319362
> 
> 赞同：2
> 
> 时间：2012-04-25T16:01:32.410
> 
> 标签：sbt, playframework-2.0

我需要在我的项目中覆盖 play2.0 的运行时依赖项。`play dependencies`在我可以看到的 play 2.0 项目上运行

> com.google.guava:guava:10.0.1 | org.seleniumhq.selenium:selenium-api:2.16.1, play:play_2.9.1:2.0 |As guava.jar

但我的应用程序依赖于 guava:12.0-rc2。

如何使用 sbt 或其他方式覆盖此依赖项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T02:04:34.530

只需在 build.scala 中添加以下依赖项：

> “com.google.guava”%“guava”%“12.0-rc2”

或从 sbt 命令行（在您的项目目录中）：

> 设置 seq(Seq(libraryDependencies += "com.google.guava" % "guava" % "12.0-rc2"): _*)
> 
> 显示依赖类路径

**如果下载成功，将显示**show dependency-classpath 。****

# jquery - 如何使用包含可点击 SPAN 的单元格附加表格

> ID：10319364
> 
> 赞同：1
> 
> 时间：2012-04-25T16:01:40.353
> 
> 标签：jquery, html-table, onclick, append

使用 jQuery 1.7x，我在动态生成的选项卡中创建了整个表格，这些选项卡有几列，其中一些需要可点击。

除了动态内容上难以捉摸的点击事件之外，一切似乎都很棒。我刚刚学会了如何使用 .on 方法对列表项执行此操作，但它似乎不适用于我的表格。（如果重要，每个 jQuery 选项卡都会为给定年份动态添加，并且该选项卡上的表格包含该年举行的所有会议）

我错过了什么？我在[http://jsfiddle.net/KYkRZ/有这个](http://jsfiddle.net/KYkRZ/)

```
<table>
     <tr><td><span class="ClickableClass">Is Clickable</span></td><td>Regular TD</td></tr>
</table>
<div id='myTab'></div>

$('.ClickableClass').on('click',function() {alert("ClickableClass click event") });

$('#myTab').append('<table border></table>');
var myTable = $('#myTab').children();
for(i=0;i<3;i++){
   var mySpan = $('<span></span>').addClass('ClickableClass').text('Should be clickable ' + i);
    var myTD = $('<td></td>').append( mySpan );
    var myTR = $('<tr></tr>').append( myTD );
   $(myTable).append( myTR );
} 
```

另外，我不知道这是动态构建表格的最佳方式，但它对我来说是最清楚的理解，因此对此提出的任何建议将不胜感激。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:07:53.723

您正在将事件处理程序添加到对象，然后创建新的并且永远不会将事件处理程序添加到新的对象。有两种方法可以处理这个问题。第一个只是在每个之后添加事件处理程序，但这会重复代码。如果您知道您将拥有动态内容，则更好的方法是将事件处理程序添加到容器中，并通过将选择器传递给事件来告诉容器在特定类型的元素中查找单击事件。

```
$('body').on('click', '.ClickableClass', function() {
    alert("ClickableClass click event"); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:05:55.463

函数参数顺序的问题[`.on()`](http://api.jquery.com/on/)：

```
$('body').on('click', '.ClickableClass', function() {
   alert("ClickableClass click event"); 
}); 
```

[http://jsfiddle.net/KYkRZ/5/](http://jsfiddle.net/KYkRZ/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:08:53.620

```
$('#myTab').on('click', 'span.ClickableClass', function() {alert("ClickableClass click event") });
$('#myTab').append('<table border></table>');
var myTable = $('#myTab').children();
for(i=0;i<3;i++){
    var mySpan = $('<span></span>').addClass('ClickableClass').text('Should be clickable ' + i);
    var myTD = $('<td></td>').append( mySpan );
    var myTR = $('<tr></tr>').append( myTD );
    $(myTable).append( myTR );
} 
```

[**演示。**](http://jsfiddle.net/KYkRZ/6/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:16:31.033

在这种情况下，您可以将点击事件绑定到您的跨度：

```
var mySpan =
    $('<span></span>')
        .addClass('ClickableClass')
        .bind('click', function() { alert('it works'); })
        .text('Should be clickable ' + i); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T17:37:59.830

只是为了更优化的方式，您可以缓存变量并消除 for 循环中不必要的 jQuery 对象。

***[我会这样做：](http://jsfiddle.net/DotNetScott/wr5Hu/)***

```
var $body = $("body"),
    $myTab = $("#myTab").append("<table border></table>").children();

$body.on("click", ".ClickableClass", function() {
    alert($(this).html().trim()); 
});

for(i = 0; i < 3; i++) 
{
   $myTab.append("<tr><td><span class=\"ClickableClass\">Should be clickable " 
                 + i + "</span></td></tr>");    
} 
```

# asp.net-mvc - ASP.NET MVC、EF：使操作方法返回 List 而不是 IEnumerable

> ID：10319367
> 
> 赞同：0
> 
> 时间：2012-04-25T16:01:49.147
> 
> 标签：asp.net-mvc, performance, entity-framework

我的控制器中有几个操作返回 EF 实体的 IEnumerable。

我正在考虑让这些操作方法返回一个列表（只是在将它传递回视图之前调用一个 model.ToList() ）。

我考虑这样做的原因有两个：

*   首先，我正在测量 BaseController 类（onactionexecuted/onactionexecuting）中每个 actionmethods 的性能，如果我返回一个 IEnumerable，那么直到 onactionexecuted 方法之后才会执行查询。
*   其次，我计划在 OnActionExecuted 中处理我的“服务层”使用的连接，但是如果我在那里处理它们，视图会因未检索到模型而失败。

我的问题是，这样做有什么缺点吗？我很确定每个 IEnumerable 模型都将被完全遍历，因此检索不会使用的数据不会有问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:09:31.083

这是做 IMO 完全有效的事情。您几乎已经指出了利弊。主要区别在于 .ToList 一次性加载到内存中，而另一个允许按需加载。

如果您打算加载整个枚举，那么调用 .ToList 将通过一次请求而不是一次请求所有内容来节省带宽。所以，如果这听起来像是一条更好的道路。

# r - 子集数据/根据前 7 个字母提取数据

> ID：10319369
> 
> 赞同：8
> 
> 时间：2012-04-25T16:01:52.520
> 
> 标签：r, subset, names

我有一个庞大的数据集，其中包含来自不同人群的基因型信息。我想按人口对数据进行排序，但我不知道如何。

我想按“pedigree_dhl”排序。我正在使用以下代码，但我不断收到错误消息。

```
newdata <- project[pedigree_dhl == CCB133$*1,  ] 
```

我的问题也是，'pedigree-dhl' 包含各个基因型的所有名称。只有 'pedigree-dhl' 列中的前 7 个字母是种群名称。在此示例中：CCB133。我如何告诉 R，我想提取包含 CCB133 的所有列的数据？

```
 Allele1 Allele2      SNP_name gs_entry pedigree_dhl
1       T       T ZM011407_0151      656    CCB133$*1
2       T       T ZM009374_0354      656    CCB133$*1
3       C       C ZM003499_0591      656    CCB133$*1
4       A       A ZM003898_0594      656    CCB133$*1
5       C       C ZM004887_0313      656    CCB133$*1
6       G       G ZM000583_1096      656    CCB133$*1 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T16:26:25.573

您可能需要考虑[使用 regexp to select rows in R dataframe](https://stackoverflow.com/a/9521239/1290420)`grep`的答案。适应您的数据：

```
df <- read.table(text="  Allele1 Allele2      SNP_name gs_entry pedigree_dhl
1       T       T ZM011407_0151      656    CCB133$*1
2       T       T ZM009374_0354      656    CCB133$*1
3       C       C ZM003499_0591      656    CCB133$*1
4       A       A ZM003898_0594      656    CCB133$*1
5       C       C ZM004887_0313      656    CCB133$*1
6       G       G ZM000583_1096      656    CCB133$*1", header=T)

# put into df1 all rows where pedigree_dhl starts with CCB133$
p1 <- 'CCB133$'
df1 <- subset(df, grepl(p1, pedigree_dhl) ) 
```

但是您的问题意味着您可能想要选择七个字母的名称，或者只是按系谱名称对行进行排序，并且将所有行放在一个排序的数据框中可能更容易。所有这三个操作：子设置、提取新列或排序，都可以独立进行。

```
# If you want to create a new column based
# on the first seven letter of SNP_name (or any other variable)

df$SNP_7 <- substr(df$SNP_name, start=1, stop=7)

# If you want to order by pedigree_dhl
# then you don't need to select out the rows into a new dataframe

df <- df[ with(df, order(df$pedigree_dhl)), ] 
```

所有这些可能是显而易见的——我只是为了完整性而添加它们。

# sql - SQL Server 从图像字段打开文件

> ID：10319370
> 
> 赞同：1
> 
> 时间：2012-04-25T16:01:54.643
> 
> 标签：sql, sql-server, vb.net

我在 SQL Server 2005 数据库中有一个“图像”类型的字段，其中包含文档，主要是 pdf。当我查看数据库中的字段时，看起来好像数据存储为十六进制字符串。我已经广泛搜索并想出了下面的 VB.net 函数将字段转换为实际文件，但它只输出一个包含十六进制字符串的文件，而不是该字段应该代表的文件。

这是字段数据的示例（出于隐私目的，我已将其截断）：

```
0x1F8B0800000000000400EDBD07601C499625262F6DCA7B7F4AF 
```

我编写的将字段转换为文档的函数：

```
 Private Sub SimpleButton1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SimpleButton1.Click

    sql = New MySqlClient.MySqlConnection(connectionString)

    Dim cmd As New MySqlClient.MySqlCommand("SELECT docdata FROM temp.temp_docs WHERE docid = " + TextEdit1.Text, sql)

    sql.Open()

    Dim dr As MySqlClient.MySqlDataReader = cmd.ExecuteReader()

    dr.Read()

    Dim b(dr.GetBytes(0, 0, Nothing, 0, Integer.MaxValue) - 1) As Byte

    dr.GetBytes(0, 0, b, 0, b.Length)

    dr.Close()

    sql.Close()

    Dim DestFilePath As String = "C:\... \Desktop\" & String.Format("{0:hhmmss}", DateTime.Now) & ".pdf"

    Dim fs As New System.IO.FileStream(DestFilePath, IO.FileMode.Create, IO.FileAccess.Write)

    fs.Write(b, 0, b.Length)

    fs.Close()

End Sub 
```

谁能发现我哪里出错了？是否可以直接从 SQL Server 中的查询打开文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:35:14.700

IMAGE 字段不包含“十六进制字符串”。它们包含二进制数据，您可以使用[`SqlBytes.Stream`](http://msdn.microsoft.com/en-us/library/system.data.sqltypes.sqlbytes.stream.aspx). 您使用 . 将流复制到所需的文件中[`Stream.CopyTo`](http://msdn.microsoft.com/en-us/library/dd782932.aspx)。

# html - HTML5 画布线性渐变对我不起作用

> ID：10319372
> 
> 赞同：2
> 
> 时间：2012-04-25T16:02:01.160
> 
> 标签：html, canvas

我在尝试使用 createLinearGradient 时遇到问题

```
//linear gradient
canvas.beginPath();
canvas.arc(350,400,100,0,2*Math.PI,false);
canvas.strokeStyle = 'lightblue';

var grad = canvas.createLinearGradient(350,110,100,0);  //(x0,y0) to (x1,y1)
grad.addColorStop(0,'red');
grad.addColorStop(1,'yellow');
grad.fillStyle = grad;
canvas.fill();
canvas.stroke(); 
```

问题是圆圈上的线性渐变不起作用。圆圈本身显示良好..

在该代码之前我有“canvas.fillStyle = 'green';” 所以圆圈是绿色的，不是红色或黄色。所以也许我忘记了什么..

谢谢！（顺便说一句，我使用 chrome，这种效果在其他东西上效果很好）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:05:11.447

`canvas.fillStyle = grad;`，不`grad.fillStyle = grad;`！

让渐变完全符合您的要求是另一个问题:)

它现在看起来全是红色，但是如果您更改 x/y 值，您将能够看到渐变。例如：

`var grad = canvas.createLinearGradient(350,110,100,330);`

会做的伎俩。

[http://jsfiddle.net/3EzUq/](http://jsfiddle.net/3EzUq/)

* * *

我认为您不应该调用 context `canvas`。我会推荐`ctx`或`context`代替。这没什么大不了的，但总有一天你会让合作者感到困惑。

# html - HTML，CSS - 粘滞页脚显示在屏幕调整大小的内容上

> ID：10319377
> 
> 赞同：3
> 
> 时间：2012-04-25T16:02:07.847
> 
> 标签：html, css, footer

请参考我的网站 [已删除]

我的页脚按预期显示在视口的末尾。

当屏幕垂直调整大小时，页脚将覆盖其上方的所有内容。

如何避免这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:07:22.240

看看[这个粘性页脚教程](http://ryanfait.com/sticky-footer/)。以下代码应该是您所需要的。

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -142px; /* the bottom margin is the negative value of the footer's height */
}
.footer, .push {
    height: 142px; /* .push must be the same height as .footer */
}

/*

Sticky Footer by Ryan Fait
http://ryanfait.com/

*/ 
```

**编辑：**

包装器中的负值与页脚的高度不匹配。这很可能是您问题的一部分。

```
#wrapper {
    min-height: 100%;
    min-width: 450px;
    height: auto !important;
    height: 100%;
    /* your old code: margin: 0 auto -4em;*/
    margin: 0 auto -83px;
}

footer {    
    background: url('images/foot_bg.jpg') center no-repeat,
    url('images/foot_liq_bg.jpg') repeat;
    position:absolute;
    bottom:0;
    width:100%;
    height:83px;
    min-width: 450px;
} 
```

**编辑：**

您没有将 html 和正文的高度设置为 100%。因此，body 将仅设置为其父 (html) 的 100%，而不是浏览器的 100%。您还必须将 html 的高度设置为 100% 才能正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:12:28.453

它重叠是因为你给它绝对定位。您需要将其相对于您的其他内容进行定位。将您的主要内容设置为页面的 100% 高度，并将页脚放在下面。然后对页脚应用负边距，其像素数量与其高度相同。

例如，如果`height:100px;`使用了页脚`margin-top:-100px;`

来源：[CSS 粘滞页脚](http://www.cssstickyfooter.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T17:43:10.243

别担心，肖恩。你离让它工作不远了。

您需要在元素上更改`padding-bottom`为，并从元素上取下绝对定位。此外，添加 'push' div 是让这种粘页脚方法起作用的必要条件。`margin-bottom``body``footer`

这个 jsFiddle 应该有帮助，它对我有用：http: [//jsfiddle.net/4vunq/](http://jsfiddle.net/4vunq/)

HTML：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Vault-X</title>
<!--JS enabling IE <=8 to recognise HTML5 elements-->
    <script type="text/javascript">
    document.createElement ('header')
    document.createElement ('footer')
    </script>
    <script type="text/javascript" src="javascript.js"></script>
    <link href="style_01.css" title="one" rel="stylesheet" type="text/css">
</head>
<body>
    <div id="switchoff">
        <div id="wrapper">
            <header></header>
            <div id="switch">
                <a href="#" onClick="lightSwitch();">
                    <img src="http://www.vault-x.com/images/switch.jpg">
                </a>
            </div>
            <div id="content"><p class="switch">Hello World</p></div>
            <div class='push'></div>
        </div>
        <footer></footer>
    </div>
</body>
</html> 
```

​ 相关CSS：

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
footer, .push {
    height: 83px; /* .push must be the same height as "footer" */
} 
```

在这里你有`padding-bottom`而不是`margin-bottom`：

```
body {
    background:url('http://www.vault-x.com/images/body_bg.jpg') repeat-x;
    background-color: #000;
    margin-bottom:83px;
} 
```

下边距在这里也很重要：

```
#wrapper {
    min-height: 100%;
    min-width: 450px;
    height: auto !important;
    height: 100%;
    margin: 0 auto -83px; /* bottom margin is negative value of footer's height */
} 
```

你的页脚代码：

```
footer {
background: url('http://www.vault-x.com/images/foot_bg.jpg') center no-repeat,
url('http://www.vault-x.com/images/foot_liq_bg.jpg') repeat;;
        width:100%;
        height:83px;
        min-width: 450px;
} 
```

那应该差不多了。漂亮的网站；还有祝你好运！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-07T14:44:29.497

我补充说：两者都解决了我的重叠问题。

```
#footer {
        position:relative;
        width:100%;
        height: 200px;
        background-color:#7B7168;
        margin-top: -200px;
        padding-bottom:50px;
        clear:both;
        } 
```

# c# - 分块枚举DataTable

> ID：10319378
> 
> 赞同：2
> 
> 时间：2012-04-25T16:02:08.560
> 
> 标签：c#, datatable, ado.net

我有一个填充了 360,000 行 SQL 数据的 DataTable（这是有意的）。但是，这会遇到 OOM 问题。

这就是我所拥有的，但是，我不确定在最后一个 1000 间隔之后如何处理任何事情。或者也许有更好的方法

```
int catchInt = 0;
string combineWhereClause = string.Empty;

for (int i = 0; i < ThousandLoopTable.Rows.Count; i++)
{
    catchInt++;
    combineWhereClause = combineWhereClause + 
                        "','" + 
                         ThousandLoopTable.Rows[i].ItemArray[0].ToString();

    if (catchInt >= 1000)
    {
        catchInt = 0;
        combineWhereClause = combineWhereClause.TrimStart('\'');
        combineWhereClause = combineWhereClause.TrimStart(',');

        Directory.CreateDirectory(ExportDirectory);
        SQLProcessing.SQLProcessor.MasterSqlConnection = 
            SQLProcessing.SQLProcessor.OpenMasterSqlConnection(SQLServer);
        DataTable dtTable = 
            SQLProcessing.SQLProcessor.QueryDataTable(sql_selectionquery);
        for (int m = 0; m < dtTable.Rows.Count; m++)
        {
            string FileName = dtTable.Rows[m].ItemArray[0].ToString() + ".txt";
            string OCR = dtTable.Rows[m].ItemArray[1].ToString();
            File.AppendAllText(ExportDirectory + "\\" + FileName, OCR);

        }

        combineWhereClause = string.Empty;
    }
} 
```

因此，例如，如果有 3120 行，这将执行 3000，但不会执行最后 120 行。但是，我不确定如何处理最后 120 行，因为我真的不想在 for 循环中这样做我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:17:28.630

您可以遵循一些简单的规则来避免 OutOfMemory 异常：

**绝不**

1.  使用整个数据集
2.  将整个数据集加载到内存中
3.  执行阻塞服务器端数据库的长时间运行的事务代码

**总是**

1.  处理小块数据
2.  加载小块数据（分页模式）
3.  运行非阻塞服务器代码
4.  如果可以在服务器上做任何事情，让它完成工作

确保服务器上的数据不可变（没有人更改它）。如果这无法保证，您可能需要重新考虑您的架构并使用队列和附加表来处理数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:05:07.777

[考虑使用带有Take](http://msdn.microsoft.com/en-us/library/bb300906.aspx) / [Skip](http://msdn.microsoft.com/en-us/library/bb357513.aspx)方法的 LINQ to SQL 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:40:11.080

可能有更好的方法来处理数据（请参阅其他答案），但我认为这是您当前方法所需要的：

不要`catchInt`为每个批次重置。相反，将其初始化为`1`并让它作为整个操作的计数器运行。然后将其更改`if`为：

```
if (catchInt % 1000 == 0 || catchInt == ThousandLoopTable.Rows.Count)
{
    // Execute your batch
} 
```

这使用[模数运算符](http://msdn.microsoft.com/en-us/library/0w4e0fzs%28v=vs.90%29.aspx)来识别何时`catchInt`可被 1000 整除。

# objective-c - 格式化实体提取的数据

> ID：10319386
> 
> 赞同：0
> 
> 时间：2012-04-25T16:02:27.870
> 
> 标签：objective-c, nsdate, nsdateformatter

在由核心数据管理的表格视图中，我有一个日期字段。现在我需要得到它，但输出中有错误。

```
for (FesteGruppo *festeGruppoEntity in arrayController_.selectedObjects) {
                NSString *valorePrimaFesta=[festeGruppoEntity.data descriptionWithCalendarFormat:@"%w" timeZone:nil locale:nil];
                int prova = [valorePrimaFesta intValue];

                if (prova==0) {
                    --domenica;
                } else if (prova==1){
                    --lunedi;
                } else if (prova==2){
                    --martedi;
                } else if (prova==3){
                    --mercoledi;
                } else if (prova==4){
                    --giovedi;
                } else if (prova==5){
                    --venerdi;
                } else if (prova==6){
                    --sabato;
                }

                NSLog(@"The entity's date is %@", festeGruppoEntity.data);
                NSLog(@"The date number is %i", prova);
            } 
```

我把这个日期：10/04/2012 (dd/MM/yyyy)，但我得到了这个结果：实体的日期是 2013-04-09 22:00:00 +0000 日期编号是 3。我需要得到我在上面输入的日期相同，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:49:38.373

我猜您所在的时区是 GMT+02:00。我也猜你要么输入了 2013 年的日期，要么错误地复制了输出。没有时间信息的 10/04/2012 日期在您的时区中是“2012-04-10 00:00:00 +0200”，这与“2012-04-09 22:00:00 +”相同0000”。`NSDate`以 GMT+00:00 登录。

所以，我认为你必须`nil`为方法的`timeZone:`参数传递一个真实的值，而不是`-descriptionWithCalendarFormat:timeZone:locale:`。

# java - EclipseLink 错误：实体类没有指定主键。它应该定义@Id、@EmbeddedId 或@IdClass

> ID：10319387
> 
> 赞同：1
> 
> 时间：2012-04-25T16:02:28.263
> 
> 标签：java, spring, jpa, spring-data, spring-data-jpa

我试图让 EclipseLink 与 Spring（MVC 和 spring-data）版本 3.1.1 一起工作，但我从一开始就遇到了问题。启动 Tomcat (v7.0) 时出现以下错误。我已经搜索了错误但想出的很少，我不确定下一步该去哪里。在使用带有实体类的接口时会出现这个问题，但是你可以看到我的`User.java`类没有扩展任何内容。

```
 Apr 25, 2012 5:18:34 PM org.apache.catalina.core.AprLifecycleListener init
    INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Java\jdk1.6.0_29\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:/Java/jdk1.5.0_22/bin/../jre/bin/server;C:/Java/jdk1.5.0_22/bin/../jre/bin;C:/Java/jdk1.5.0_22/bin/../jre/lib/amd64;C:\oracle\product\10.2.0\client_1\bin;C:\Java\jdk1.5.0_22\bin;c:\windows\system32;c:\windows;c:\windows\system32\wbem;c:\windows\system32\windowspowershell\v1.0\;C:\Program Files\TortoiseSVN\bin;C:\Program Files (x86)\Apache Software Foundation\apache-ant-1.7.0\bin;C:\Program Files\SlikSvn\bin\;C:\JAD;C:\Program Files\MySQL\MySQL Server 5.5\bin;C:\maven\apache-maven-3.0.4\bin;C:\eclipse;;.
    Apr 25, 2012 5:18:34 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
    WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:proxi' did not find a matching property.
    Apr 25, 2012 5:18:34 PM org.apache.coyote.AbstractProtocol init
    INFO: Initializing ProtocolHandler ["http-bio-8980"]
    Apr 25, 2012 5:18:34 PM org.apache.coyote.AbstractProtocol init
    INFO: Initializing ProtocolHandler ["ajp-bio-8909"]
    Apr 25, 2012 5:18:34 PM org.apache.catalina.startup.Catalina load
    INFO: Initialization processed in 842 ms
    Apr 25, 2012 5:18:34 PM org.apache.catalina.core.StandardService startInternal
    INFO: Starting service Catalina
    Apr 25, 2012 5:18:34 PM org.apache.catalina.core.StandardEngine startInternal
    INFO: Starting Servlet Engine: Apache Tomcat/7.0.22
    Apr 25, 2012 5:18:35 PM org.apache.catalina.core.ApplicationContext log
    INFO: Initializing Spring root WebApplicationContext
    INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization started
    INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Wed Apr 25 17:18:35 CEST 2012]; root of context hierarchy
    INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/root-context.xml]
    INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@e8ae59a: defining beans [userService,entityManagerFactory,dataSource,txManager]; root of factory hierarchy
    INFO : org.springframework.jdbc.datasource.DriverManagerDataSource - Loaded JDBC driver: org.hsqldb.jdbcDriver
    INFO : org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Building JPA container EntityManagerFactory for persistence unit 'default'
    [EL Config]: 2012-04-25 17:18:36.484--ServerSession(1353906974)--Thread(Thread[Thread-2,5,main])--The access type for the persistent class [class com.proxi.user.User] is set to [FIELD].
    [EL Config]: 2012-04-25 17:18:36.552--ServerSession(1353906974)--Thread(Thread[Thread-2,5,main])--The alias name for the entity class [class com.proxi.user.User] is being defaulted to: User.
    INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@e8ae59a: defining beans [userService,entityManagerFactory,dataSource,txManager]; root of factory hierarchy
    ERROR: org.springframework.web.context.ContextLoader - Context initialization failed
    org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/spring/root-context.xml]: Invocation of init method failed; nested exception is javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.EntityManagerSetupException
    Exception Description: Predeployment of PersistenceUnit [default] failed.
    Internal Exception: Exception [EclipseLink-7161] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException
    Exception Description: Entity class [class com.proxi.user.User] has no primary key specified. It should define either an @Id, @EmbeddedId or an @IdClass. If you have defined PK using any of these annotations then make sure that you do not have mixed access-type (both fields and properties annotated) in your entity class hierarchy.
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
        at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
        at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)
        at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
        at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
        at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
        at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4723)
        at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5226)
        at org.apache.catalina.core.StandardContext$1.call(StandardContext.java:5221)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
        at java.util.concurrent.FutureTask.run(FutureTask.java:138)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.Thread.run(Thread.java:662)
    Caused by: javax.persistence.PersistenceException: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.EntityManagerSetupException
    Exception Description: Predeployment of PersistenceUnit [default] failed.
    Internal Exception: Exception [EclipseLink-7161] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException
    Exception Description: Entity class [class com.proxi.user.User] has no primary key specified. It should define either an @Id, @EmbeddedId or an @IdClass. If you have defined PK using any of these annotations then make sure that you do not have mixed access-type (both fields and properties annotated) in your entity class hierarchy.
        at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.predeploy(EntityManagerSetupImpl.java:1127)
        at org.eclipse.persistence.jpa.PersistenceProvider.createContainerEntityManagerFactory(PersistenceProvider.java:187)
        at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:268)
        at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:310)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
        ... 20 more
    Caused by: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.EntityManagerSetupException
    Exception Description: Predeployment of PersistenceUnit [default] failed.
    Internal Exception: Exception [EclipseLink-7161] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException
    Exception Description: Entity class [class com.proxi.user.User] has no primary key specified. It should define either an @Id, @EmbeddedId or an @IdClass. If you have defined PK using any of these annotations then make sure that you do not have mixed access-type (both fields and properties annotated) in your entity class hierarchy.
        at org.eclipse.persistence.exceptions.EntityManagerSetupException.predeployFailed(EntityManagerSetupException.java:210)
        ... 26 more
    Caused by: Exception [EclipseLink-7161] (Eclipse Persistence Services - 2.2.0.v20110202-r8913): org.eclipse.persistence.exceptions.ValidationException
    Exception Description: Entity class [class com.proxi.user.User] has no primary key specified. It should define either an @Id, @EmbeddedId or an @IdClass. If you have defined PK using any of these annotations then make sure that you do not have mixed access-type (both fields and properties annotated) in your entity class hierarchy.
        at org.eclipse.persistence.exceptions.ValidationException.noPrimaryKeyAnnotationsFound(ValidationException.java:1352)
        at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.validatePrimaryKey(EntityAccessor.java:1325)
        at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.processMappingAccessors(EntityAccessor.java:1070)
        at org.eclipse.persistence.internal.jpa.metadata.accessors.classes.EntityAccessor.process(EntityAccessor.java:603)
        at org.eclipse.persistence.internal.jpa.metadata.MetadataProject.processStage2(MetadataProject.java:1541)
        at org.eclipse.persistence.internal.jpa.metadata.MetadataProcessor.processORMMetadata(MetadataProcessor.java:485)
        at org.eclipse.persistence.internal.jpa.deployment.PersistenceUnitProcessor.processORMetadata(PersistenceUnitProcessor.java:454)
        at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.predeploy(EntityManagerSetupImpl.java:1081)
...
...
... 
```

这是我的 User.java 类：

```
/**
 * 
 */
package com.proxi.user;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Table;

import org.springframework.data.annotation.Id;

/**
 * Represents an application user.
 */
@Entity
@Table(name = "user")
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "id")
    private Long id;

    @Column(name = "first_name")
    private String firstName;

    @Column(name = "last_name")
    private String lastName;

    // /////// GETTERS AND SETTERS ///////////

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }
} 
```

我有一个 root-context.xml 文件，我在其中声明组件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans 
    xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans 
                        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

    <!-- Root Context: defines shared resources visible to all other web components -->
    <bean id="userService" class="com.proxi.user.UserService" />    

    <!-- Starting with Spring 3.1, the persistence.xml XML file is no longer necessary. 
         The LocalContainerEntityManagerFactoryBean now supports a ‘packagesToScan’ property where the packages to scan 
         for @Entity classes can be specified. -->
    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
       <property name="dataSource" ref="dataSource" />
       <property name="packagesToScan" value="com.proxi.user" />
       <property name="jpaVendorAdapter">
          <bean class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter">
             <property name="showSql" value="true" />
             <property name="generateDdl" value="true" />
             <property name="databasePlatform" value="org.eclipse.persistence.platform.database.HSQLPlatform" />
          </bean>
       </property>
    </bean>

    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
       <property name="driverClassName" value="org.hsqldb.jdbcDriver" />
       <property name="url" value="jdbc:hsqldb:file:\Users\nly31175\hsqldb;shutdown=true" />
       <property name="username" value="proxi" />
       <property name="password" value="" />
    </bean>

    <bean id="txManager" class="org.springframework.orm.jpa.JpaTransactionManager">
       <property name="entityManagerFactory" ref="entityManagerFactory" />
    </bean>

</beans> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T16:04:26.493

您正在导入错误的`@Id`注释。删除 spring 之一，添加 javax.persistence 之一。

代替

```
import org.springframework.data.annotation.Id; 
```

和

```
import javax.persistence.Id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-25T09:21:05.780

尽管在这种情况下接受的答案是正确的，但在使用 Glassfish / EclipseLink 时可能还有另一个导致此错误的原因：EclipseLink <2.6.0 有一个[令人讨厌的错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=429992)，导致其中包含 lambda 表达式的类被忽略。这可能会导致令人困惑的错误，例如此处提到的错误，或其他类似错误（例如，EclipseLink 可能会告诉您带有 @Entity 注释的类不是实体）。

Glassfish 4.1 包括 EclipseLink 2.5.x，所以如果使用 Glassfish，这个错误（以及许多其他错误）会咬你。我使用的是这个版本而不是 4.1.1，因为另一个错误导致无法在 REST Web 服务中使用验证。如果您想保持理智，请尽可能远离 Glassfish。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-18T07:41:03.863

使用 Java-8，将 EclipseLink 升级到至少 2.6.0 。

除了 POJO，我在添加任何自定义 get/constructor 时遇到问题。

版本升级有帮助。

# ios - 检测弹出框关闭

> ID：10319392
> 
> 赞同：7
> 
> 时间：2012-04-25T16:02:44.043
> 
> 标签：ios, uipopovercontroller

我想玩 UIPopupController，我知道我无法检测到我的弹出框何时关闭。我的步骤：
1\. 从 XCode 创建示例（文件 -> 新项目 -> 实用程序）
2\. 添加到 MainViewController.h`UIPopoverControllerDelegate`

```
#import "FlipsideViewController.h"

@interface MainViewController : UIViewController <FlipsideViewControllerDelegate,UIPopoverControllerDelegate>

@property (strong, nonatomic) UIPopoverController *flipsidePopoverController;

- (IBAction)showInfo:(id)sender;

@end 
```

1.  在 MainViewController 中：

```
    - (IBAction)showInfo:(id)sender
    {
        if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
            FlipsideViewController *controller = [[FlipsideViewController alloc] initWithNibName:@"FlipsideViewController" bundle:nil];
            controller.delegate = self;
            controller.modalTransitionStyle = UIModalTransitionStyleFlipHorizo​​ntal;
            [自我presentModalViewController：控制器动画：YES]；
        } 别的 {
            如果（！self.flipsidePopoverController）{
                FlipsideViewController *controller = [[FlipsideViewController alloc] initWithNibName:@"FlipsideViewController" bundle:nil];
                controller.delegate = self;

                self.flipsidePopoverController.delegate = self

                self.flipsidePopoverController = [[UIPopoverController alloc] initWithContentViewController:controller];
            }
            if ([self.flipsidePopoverController isPopoverVisible]) {
                [self.flipsidePopoverControllerdismissPopoverAnimated:YES];
            } 别的 {
                [self.flipsidePopoverController presentPopoverFromBarButtonItem:sender allowedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
            }
        }
    }

    -(void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController
    {
        NSLog(@"OLOLO");
    }

```

但是当我点击某个地方并且弹出框消失时，控制台中没有 NSLog 消息。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-30T11:03:10.153

将弹出框的代表设置为 self ，您也可以使用两个弹出框代表，即：-

```
 /* Called on the delegate when the popover controller will dismiss the popover. Return NO to prevent the dismissal of the view.
 */
- (BOOL)popoverControllerShouldDismissPopover:(UIPopoverController *)popoverController;

/* Called on the delegate when the user has taken action to dismiss the popover. This is not called when -dismissPopoverAnimated: is called directly.
 */
- (void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-14T13:09:23.240

较早的答案建议使用 UIPopoverControllerDelegate ，这似乎是实现目标的唯一明智方法。我认为添加一个实际示例会很好，因为这不是最简单的事情。我的要求很简单 - 我希望在弹出框可见的同时模糊背景视图，因此步骤如下：

1.  在情节提要中连接您的弹出框，在目标视图控制器属性中配置它的弹出框内容大小。

2.  通过打开 .h 文件并执行以下操作，使您的源视图控制器成为 UIPopoverControllerDelegate：

    ```
    @interface MyController : UIViewController <UIPopoverControllerDelegate> 
    ```

3.  覆盖 prepareForSegue，将源视图控制器指定为弹出框的委托，然后在 segue 呈现目的地之前将 alpha 设置为 0.5：

    ```
    - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
        UIStoryboardPopoverSegue* popover = (UIStoryboardPopoverSegue*)segue;
        popover.popoverController.delegate = self;
        self.view.alpha = 0.5;
    } 
    ```

4.  实现popover委托方法popoverControllerDidDismissPopover。将 alpha 设置回 1.0 并取消将自己指定为委托，以确保我们不会阻止 ARC 完成它的工作：

    ```
    -(void)popoverControllerDidDismissPopover:(UIPopoverController *)popoverController {
        self.view.alpha = 1.0;
        popoverController.delegate = nil;
    } 
    ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T16:11:32.137

Did you set your MainViewController instance as the delegate of the popover?

(if you create the popover through code) `popover.delegate = self;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-20T15:43:11.493

```
- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
UIStoryboardPopoverSegue *popoverSegue;
popoverSegue = (UIStoryboardPopoverSegue *)segue;
popoverController = popoverSegue.popoverController;
pCVisible = YES;
[[segue destinationViewController] setDelegate:self];
}

- (void) setDataFromPopover {
  if (pCVisible) {
     [popoverController dismissPopoverAnimated:YES]; // THIS IS KEY!   this is where the popover is dismissed, not in the popover itself
  }
} 
```

和

```
//TableViewController.m
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:       (NSIndexPath *)indexPath
{
   //variable = whatever

OtherViewController *initialView;
initialView=(OtherViewController *)self.delegate;
initialView.theLabel.text = variable;
[initialView setDataFromPopover];
} 
```

# php - 函数从数据库表中填充第一个列表框而不是第二个列表框

> ID：10319398
> 
> 赞同：0
> 
> 时间：2012-04-25T16:02:58.340
> 
> 标签：php, mysql, html

函数`popList()`有两个参数——列名和表名。基本上`popList(`) 函数连接到`mysql`服务器，然后连接到数据库，并构建一个 sql 查询，以根据您传递给函数的内容来检索数据，以用于填充页面上的列表框。

只有一个列表框适用于该函数，但如果页面上有第二个列表框使用不同的参数（列名和表名）再次调用该函数，则它显示为空，并且以下内容打印在页面的源代码中第一个填充列表框的来源：

> **警告：mysql_connect() [function.mysql-connect]：第****7**行**C:\xampp\htdocs\test**中的用户 'ODBC'@'localhost' 的访问被拒绝（使用密码：否） 未连接：用户的访问被拒绝ODBC'@'localhost'（使用密码：否）

 **我在两个调用中使用相同的连接凭据，它们是默认的 localhost、root 和无密码（纯粹用于测试目的）

为什么会这样？

**编辑***（来源）*：

```
<?php
function popList($col, $tbl) {

    require_once "credentials.php";

    // Opens a connection to a MySQL server
    $connection=mysql_connect($host, $username, $password);
    if (!$connection) {
      die('Not connected : ' . mysql_error());
    }

    // Set the active MySQL database
    $db_selected = mysql_select_db($database, $connection);
    if (!$db_selected) {
      die ('Can\'t use db : ' . mysql_error());
    }

    $sql = "SELECT $field FROM $table";
    $query = mysql_query($sql);

    while ($row = mysql_fetch_array($query)) {
        echo '<option value="' . $row["$field"] . '">' . $row["$field"] . '</option>';
    }

    mysql_close($connection);
}
?> 
```

**解决方案**：

*新*：似乎使用`require_once`并`include_once`导致问题，但使用`include`或`require`实际解决了问题。

~~替换为像这样`require_once "credentials.php"`的实际代码`credentials.php`~~：

```
function popList(...) {

require "credentials.php"; // changed to require from require_once. same with include

...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:09:33.790

引用你的话，

> 我在两个调用中使用相同的连接凭据，它们是默认的 localhost、root 和无密码（纯粹用于测试目的）

由于您提到没有密码的root用户，并且在错误中，它出现：**`Access denied for user 'ODBC'@'localhost' (using password: NO)`**这意味着您实际上是在尝试连接`ODBC`没有密码的用户，我认为这是有密码的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:54:01.527

`require_once`做它所说的：它需要**一次**。第一次`popList`被调用，所有内容都`credentials.php`被转储到你的函数范围内。第二次`popList`被调用，*没有任何*反应，因为`credentials.php`在此运行期间已经需要一次。

你应该在某个地方有一个配置对象，而不是文件中的一堆变量，你不应该使用`require`或`include`在这样的函数中使用，你应该`E_STRICT`打开，这样你就会看到关于`$password`etc 未定义的警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T11:21:30.830

嗨，你可以这样做

```
$query="SELECT * FROM bus_type order by bus_type_id Asc";
$result = mysqli_query($conn, $query);
echo "<select name=bustype size=sizes class=bus_txtbox value=''>Type of the Bus</option>";
    while($line=mysqli_fetch_array($result, MYSQLI_ASSOC)){
    echo "<option value=$line[bus_type_id]>$line[bus_type]</option>";
}
echo "</select>"; 
```**

# opencv - OpenCV：GPU 上的 3D 矩阵

> ID：10319400
> 
> 赞同：3
> 
> 时间：2012-04-25T16:03:08.453
> 
> 标签：opencv, computer-vision, gpu

我想知道是否可以将 3 维矩阵上传到 gpu 以使用它？我有一系列具有相同分辨率的图像（大约 100 帧）；现在我想使用 OpenCV 的 .upload 函数将它们上传到 gpu 并对它们进行一些计算。

简单的方法是为每个帧创建一个 GpuMat 并按顺序上传它们，但我想知道是否有更优雅的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:06:47.513

根据您的算法的工作原理，您可以简单地将图像连接到现有图像尺寸之一，而不是尝试创建“3D”图像。例如，如果您有两帧 640x480 图像，则制作一个 640x960 图像作为要发送到 GPU 的图像。

# php - 在 PHP 中使用摘要身份验证的 curl 请求以下载 Bitbucket 私人存储库

> ID：10319403
> 
> 赞同：13
> 
> 时间：2012-04-25T16:03:25.417
> 
> 标签：php, curl, command-line, bitbucket, digest-authentication

我正在尝试在 php 上执行此请求，以从我的 Bitbucket 私有存储库下载最后一个源：

```
curl --digest --user user:pass https://bitbucket.org/user/repo/get/tip.zip -o test.zip 
```

在命令行中没问题，文件下载完美，但在 php 中不起作用，这是我的 php 代码：

```
$out = fopen('test.zip', 'w+');
$ch = curl_init();
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_VERBOSE, true);
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_DIGEST);
curl_setopt($ch, CURLOPT_USERPWD, 'user:pass');
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_FILE, $out);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_setopt($ch, CURLOPT_NOBODY, false);
curl_setopt($ch, CURLOPT_URL, 'https://bitbucket.org/user/repo/get/tip.zip');
curl_exec($ch); 
```

这是响应，登录无效，服务器重定向到登录页面：

```
Error CURL: '' 
Error number: 0
Array
(
    [url] => https://bitbucket.org/account/signin/?next=/user/repo/get/tip.tar.gz
    [content_type] => text/html; charset=utf-8
    [http_code] => 200
    [header_size] => 1099
    [request_size] => 194
    [filetime] => -1
    [ssl_verify_result] => 0
    [redirect_count] => 1
    [total_time] => 1.055465
    [namelookup_time] => 1.5E-5
    [connect_time] => 0.102969
    [pretransfer_time] => 0.216164
    [size_upload] => 0
    [size_download] => 10049
    [speed_download] => 9520
    [speed_upload] => 0
    [download_content_length] => 10049
    [upload_content_length] => 0
    [starttransfer_time] => 0.527512
    [redirect_time] => 0.527519
    [redirect_url] => 
) 
```

任何人都知道我可以如何解决我的问题？非常感谢！！！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T00:15:01.097

这段代码对我来说很好：

```
define('USERNAME','username');
define('PASSWORD','password');

function download($url, $destination) {
    try {
        $fp = fopen($destination, "w");
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
        curl_setopt($ch, CURLOPT_USERPWD, USERNAME . ":" . PASSWORD);
        curl_setopt($ch, CURLOPT_FILE, $fp);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
        curl_setopt($ch, CURLOPT_TIMEOUT, 30);
        $resp = curl_exec($ch);

        // validate CURL status
        if(curl_errno($ch))
            throw new Exception(curl_error($ch), 500);

        // validate HTTP status code (user/password credential issues)
        $status_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        if ($status_code != 200)
            throw new Exception("Response with Status Code [" . $status_code . "].", 500);
    }
    catch(Exception $ex) {
        if ($ch != null) curl_close($ch);
        if ($fp != null) fclose($fp);
        throw new Exception('Unable to properly download file from url=[' + $url + '] to path [' + $destination + '].', 500, $ex);
    }
    if ($ch != null) curl_close($ch);
    if ($fp != null) fclose($fp);
}

download('https://bitbucket.org/brunobraga/playground/get/tip.tar.gz', '/tmp/test.tar.gz'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T18:35:43.343

I've given it the customary "20 minute tinker" and I'll be damned, working with CURL and my OSX HTTP Client this does not seem to want to budge, and I've worked successfully with HTTP Digest and Curl in the past.

One suggestion: if the command line is working then why not use the command? Does your production server support `exec()`?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T11:57:58.933

我有同样的问题；从密码中删除了所有**非字母数字字符**，它起作用了！虽然不知道为什么。

我希望它有所帮助。

# css - 为什么我的导航列表没有向左浮动？

> ID：10319409
> 
> 赞同：0
> 
> 时间：2012-04-25T16:03:55.250
> 
> 标签：css, asp.net-mvc, html, css-float

它不在主要部分的左侧，而是在其上方。我不确定为什么。

```
#sidebar {
    float:left;
}

<body>
    <div class="page">
        <header>
            <div id="title">
                <h1>My MVC Application</h1>
            </div>
            <div id="logindisplay">
                Welcome <strong>@User.Identity.Name</strong>!
            </div>
            <nav>
                <ul id="menu">
                    <li>@Html.ActionLink("Home", "Index", "Home")</li>
                    <li>@Html.ActionLink("About", "About", "Home")</li>
                </ul>
            </nav>
        </header>
        <nav id="sidebar">
            Go To...
            <ul>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
                <li>First Move to Moon</li>
            </ul>
        </nav>
        <section id="main">            
            @RenderBody()
        </section>
        <footer>
        </footer>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:26:24.507

您的导航列表浮动到左侧。为了确定出了什么问题，您需要更具体地了解您所看到的和您所期望的。你使用的是什么浏览器？

我假设您已经注意到正文文本在导航旁边被压扁，并且页脚没有在它下方结束。我`clear:both;`在页脚中添加了一些边框和 a 以更好地说明结构。

[http://jsfiddle.net/frGtX/8/](http://jsfiddle.net/frGtX/8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:24:26.913

如果没有所有相关的 CSS，很难发现 CSS 问题。您似乎发布了新 Asp.Net MVC 应用程序的默认共享布局视图，并添加了导航 div。但是如果没有所有的 css，就不可能确定到底出了什么问题。我确实看到的一个问题是您的`#sidebar`css 没有被`<style>`标签包裹。它应该是这样的：

```
<style>
    #sidebar
    {
        float: left;
    }
</style> 
```

此外，解决 css 异常最简单快捷的方法是使用 FF 或 Chrome 中的开发人员工具来检查您的标记样式。如果您检查了`sidebar`div 的 css，您将看到`float:left`样式未与您发布的代码一起应用，这应该会导致您推断您没有引用 css 或没有正确声明它。

# java - 包 java.servlet 不存在

> ID：10319412
> 
> 赞同：0
> 
> 时间：2012-04-25T16:04:00.210
> 
> 标签：java, servlets

这是我的第一个 Servlet 程序，但即使在添加了`servlet-api.jar`cmd 的类路径后，我也会遇到同样无聊的错误：“java.servlet 包不存在”

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:17:11.057

确保您已经安装了一个具体的 servletcontainer。例如，[Apache Tomcat](http://tomcat.apache.org)。至少是您将 Web 应用程序定位到的那个。

Servlet API 然后位于`/path/to/Tomcat/lib/servlet-api.jar`文件中。您需要确保在命令的`-cp`or`-classpath`参数中包含此路径`javac`。假设您当前位于所有 Java 代码的根文件夹中：

```
javac -cp .:/path/to/Tomcat/lib/servlet-api.jar com/example/SomeServlet.java 
```

或者，如果它在 Windows 上，请使用分号`;`而不是冒号`:`作为路径分隔符，如果路径包含类似这样的空格`C:\Program Files\Tomcat\lib\servlet-api.jar`，则用引号将单个路径括起来：

```
javac -cp .;"C:\Program Files\Tomcat\lib\servlet-api.jar" com/example/SomeServlet.java 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:09:43.143

听起来你还没有正确设置。仔细检查您的类路径中的所有内容，在该特定 CMD 窗口中打印出 PATH 并确保 JAR 在那里。听起来您没有使用 Eclipse，因此您必须手动完成许多令人困惑的设置工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:14:06.813

对于动态 Web 项目 (eclipse)，它应该被自动添加。如果不是 - 只需下载 jar 并将其添加到类路径中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:19:36.523

首先，Servlet 是属于`javax.servlet`而不是`java.servlet`包的。那可能是你的问题。在您的代码中组织您的 servlet 导入。

* * *

要在 Tomcat 上运行 servlet，您必须将 WAR 文件（包含已编译的 Servlet）放在文件夹下，并通过调用（调用 startup.bat 文件，并假设您在文件夹中）`TOMCAT_HOME/webapps`从命令行运行 Tomcat 。`startup``TOMCAT_HOME\bin`

# vb.net - 在vb中减去时间

> ID：10319413
> 
> 赞同：2
> 
> 时间：2012-04-25T16:04:00.457
> 
> 标签：vb.net

我想从 VB 日期对象中减去 18 年。
这是代码示例：

```
Dim someVar
DirectCast(pcontrol, DateTimePicker).Value = Date.Now.Subtract(someVar) 
```

someVar 值是 ?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T16:06:37.840

这看起来很奇怪，但请尝试使用`AddYears`, 但使用负数：

```
With DirectCast(pcontrol, DateTimePicker)
  .Value = .Value.AddYears(-18)
End With 
```

或者正如 MarkJ 指出的那样，试图从现在开始减去它：

```
With DirectCast(pcontrol, DateTimePicker)
  .Value = Now.AddYears(-18)
End With 
```

# in-app-purchase - 应用内购买“等待审核”很长时间

> ID：10319414
> 
> 赞同：1
> 
> 时间：2012-04-25T16:04:02.880
> 
> 标签：in-app-purchase, app-store-connect

您好，我在 5 天前将我的第一次应用内购买添加到 iTunes 连接并将其连接到我的更新。现在苹果甚至开始审查应用内购买？他们通常需要多长时间才能开始审核？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:06:30.807

大约 5 个工作日，但最多几周。耐心是一种美德！（尤其是苹果）

# javascript - unicode转二进制？

> ID：10319415
> 
> 赞同：1
> 
> 时间：2012-04-25T16:04:03.373
> 
> 标签：javascript, unicode, binary, type-conversion

在 Javascript 中，如何将 BMP unicode 字符转换为二进制（并返回）？

我似乎找不到任何内置的字符串方法`binaryCharCodeAt()`是否存在类似的东西？

如果没有，我对如何手动操作的猜测是创建一个包含例如`[00001111], [00001110], [00001100]`等的数组......

然后得到二进制，我可以做`myArray[String.charCodeAt(j)]`

然后从二进制到 unicode，我可以在数组中搜索二进制字符串，返回它在数组中的位置，并将其放入`String.fromCharCode()`

在这种情况下，这些二进制代码是任意分配的，并且不是每个字符的正确代码。但这没关系..（虽然最好是正确的）我只需要任何二进制文件。

我预见的问题是，搜索包含 65000 多个项目的数组，数百或数千次，最终可能会花费大量的处理时间。

那么，是否有任何预先存在的方法或库，或者您能否建议一种更好的手动执行此操作的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T18:22:56.673

请注意，说“二进制并返回”并不完全正确，因为 unicode 字符不需要具有唯一的二进制表示（它取决于编码，例如 UTF-8）。但是，我相信大多数 UTF-... 编码在二进制编码方面彼此向后兼容。

但是既然你说你不在乎你使用的是什么编码，你可以完全按照 Kolink 所说的去做（他的回答被错误地否决了，但也不完整）：

*编辑：*正如 Esailija 指出的那样，OP 只对基本的多语言平面字符感兴趣，它们只有一个代码点。下面的代码有点矫枉过正，但仍然适用于 BMP 和非 BMP 代码点。

`"some string".charCodeAt`给你一些编码的代码点的十六进制。就我而言，它是 UTF-16：

```
"".charCodeAt(0)==55356
"".charCodeAt(1)==56513 
```

在 UTF-16 中，这是`0xF0 0x9F 0x83 0x81`( `f09f8381`)，或 "\uD83C\uDCC1"：

```
"\uD83C\uDCC1"=="" 
```

你不能仅仅假设 charCodeAt 会给你你想要的数字而不需要做一些工作。Unicode 是一种可变宽度编码。因此，您可以执行以下操作以获得自洽的结果。

```
var UTF_BITS = 16;

function padLeftTo(string, padChar, numChars) {
    return (new Array(numChars-string.length+1)).join(padChar) + string;
}

function unicodeToBinary(char) {
    return char.split('').map(function(codepoint) {
        return padLeftTo(codepoint.charCodeAt(0).toString(2), 0, UTF_BITS);
    }).join('').split('').map(function(char){return parseInt(char)});
    //         ^^^^( ignore this part if you just want a string )^^^^
}

function binaryToUnicode(binaryList) {
    var codepointsAsNumbers = [];
    while( binaryList.length>0 ){
        var codepointBits = binaryList.slice(0,UTF_BITS);
        binaryList = binaryList.slice(UTF_BITS);
        codepointsAsNumbers.push( parseInt(codepointBits.join(''),2) );
    }
    return String.fromCharCode.apply(this,codepointsAsNumbers);
} 
```

演示：

```
> unicodeToBinary("")
[1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1]

> binaryToUnicode(unicodeToBinary(""))
"" 
```

请注意，由于您没有说明您的用例是什么，因此二进制文件可能并不是您真正想要的。例如，如果您满足于唯一标识符，您可以使用字符串本身，或者十六进制字符串甚至整数表示。您更有可能想要一个更简单的表示。

完整的旁注：如果您打算将对象用作查找表，则可以只使用原始原始字符串“”作为键，例如`table={}; table[""]='something'; table[""]`. 但是，由于 unicode 3.2 标准中有 95156 个字符，我不建议在内存中做任何这样的事情。你还说了一些让我觉得你不熟悉查找表的性能的话：如果你不知道，它需要 O(1) 时间来做`table[...]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:05:51.913

用于`charCodeAt`获取十进制数，然后调用`toString(2)`它以将其转换为二进制。

# jquery - jQuery Click 函数在不同的 DIV 上触发 SWFObject ...但仅在 Firefox 中

> ID：10319416
> 
> 赞同：1
> 
> 时间：2012-04-25T16:04:04.580
> 
> 标签：jquery, flash, firefox, swfobject

也许这是用户错误，但我无法弄清楚。它在 IE 或 Chrome 中运行良好，但在最新的 Firefox 中失败。

在本页面：

[http://detroittheopera.com/plot-view-unformat2](http://detroittheopera.com/plot-view-unformat2)

单击任何歌词链接，jQuery 单击功能会显示/隐藏下一个 div。美好的。

现在单击任何三角形（一个链接也有一个 jQuery 函数来加载 SWF 的 SWF）。工作也很好。

现在返回并单击任何歌词链接。它继续工作，但 div 上方 div 上的 SWF 将开始播放。

我很确定选择器不会重叠。我试图在控制台中跟踪它，但每当它发生在 jQuery 库的深处，我就无法跟踪它。

会发生什么？

TIA,

---JC

# scala - 在抽象类中使用模式匹配来调用依赖于类型的方法

> ID：10319423
> 
> 赞同：0
> 
> 时间：2012-04-25T16:04:42.213
> 
> 标签：scala, pattern-matching, abstract-class

我对我的原始代码做了一些简化，只是为了专注于这个问题。

我有这组课程：

```
abstract class A(n: String){
   def name = n
}

abstract class B[T](n: String) extends A(n){
   def printT(t: T) = println(t)
}

object B{
   def unapply[T](b: B[T]) = Some(b.name)
}

case class C extends B[Int]("integer") 
```

现在我想在 As 列表中发现扩展 B 的内容，然后使用 printT。像这样的东西：

```
val list = List(C)

list match{
   case b @ B(_) => b.printT(2) 
} 
```

在`case b @ B(_) => b.printT(2)`我得到的线上：

```
found   : Int(2)
required: T where type T
case b @ B(_) => b.printT(2)
                              ^ 
```

如果我可以将 T 与我想使用类的 T 的对象相关联，那么这个问题可能会得到解决。有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:13:36.047

您的代码有一些问题。

1) 案例类应使用参数列表声明：`case class C()`

2）要实例化 a `C`，您需要编写`C()`. `List(C)`是 a`List[C.type]`但是`List(C())`是 a `List[C]`，这就是你想要的。

3)`list match`如果您的案例是 a `B`:`list`是 a没有意义`List`，所以它*永远不可能*是 a `B`。也许您的意思是`list foreach`，哪个会匹配列表中的每个元素？

这是`2`按预期打印的代码的更正版本。

```
case class C() extends B[Int]("integer")

val list = List(C())

list foreach {
  case b @ B(_) => b.printT(2)
} 
```

此外，`b @ B(_)`语法对我来说有点奇怪，因为`B`如果你不打算使用它的部分，那么提取是没有意义的。相反，您可以只匹配类型：

```
list foreach {
  case b: B[Int] => b.printT(2)
} 
```

# jquery - jQuery 拉取 我正在尝试让我的 jQuery 脚本从单击的链接中提取 url，然后将其插入到我的视频标签中。有什么建议吗？ 我试过拼接我从 .html() 得到的东西，但引号总是搞砸了。

| name | description | location | duration |
| [Clip1234](clip1234.mov) | dolor sit amet, consectetur adipiscing elit | dr101 | :60 |
| [Clip456](clip456.mov) | Lorem ipsum dolor sit amet | dr101 | :60 |

 您可以href直接从单击的上下文中提取： $("#tableBin").on("click", "a", function(e){ e.preventDefault(); url = this.href; }); jqueryhtml 4 3 回答 3 This answer is useful 4 您可以href直接从单击的上下文中提取： $("#tableBin").on("click", "a", function(e){ e.preventDefault(); url = this.href; }); 于 2012-04-25T16:07:47.943 回答 This answer is useful 2 给你： $("#tableBin a").on("click", function(e) { e.preventDefault(); var url = $(this).attr("href"); var overlay = jQuery(''); overlay.appendTo(document.body); }); 于 2012-04-25T16:07:49.633 回答 This answer is useful 0 var url = $(this).html();将为您提供一个包含 html 的字符串 [...](...)标签。在你的情况下，它会读到类似Clip1234 你想读取href属性。 var url = this.href; //Plain old Javascript, not jQuery 于 2012-04-25T16:09:29.253 回答 Related 3 ios - 复制对象时的目标内存泄漏 1 css - 为什么 li 中的浮动项目在其他缩放级别用 chrome 包装？ 4 sql - SQL 为什么使用 isnull(field, '') <> ''？ 3 android - 加载 XML 布局 1 javascript - 哪个更好：来自服务器的更多数据，更少的客户端计算，反之亦然 1 ruby-on-rails-3 - Heroku/Rails 将 example.com 路由到 mydomain.example/example 1 mysql - MySQL：查询多个表的奇怪行为 1 c# - 另一个进程正在使用 pdf 文档 0 java - 用于传入连接的 Java NIO 选择器和用于传入消息的选择器 1 jquery - 使用 AWS 中静态文件夹中的项目创建 Sprite 图像 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10319424
> 
> 赞同：3
> 
> 时间：
> 
> 标签：jquery, html

我正在尝试让我的 jQuery 脚本从单击的链接中提取 url，然后将其插入到我的视频标签中。有什么建议吗？

我试过拼接我从 .html() 得到的东西，但引号总是搞砸了。

```
<div class="binShadow">
        <div class="bin">       
            <table id="tableBin" border="0">
                <tr>
                    <th>name</th>
                    <th>description</th>
                    <th>location</th>
                    <th>duration</th>
                </tr>
                <tbody>
                    <tr>
                        <td><a href='clip1234.mov'>Clip1234</a></td>
                        <td>dolor sit amet, consectetur adipiscing elit</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                    <tr>
                        <td><a href="clip456.mov">Clip456</a></td>
                        <td>Lorem ipsum dolor sit amet</td>
                        <td>dr101</td>
                        <td>:60</td>
                    </tr>
                </tbody>
                </div>
            </table>
        </div>
    </div>  
</div>
<script>
    $("#tableBin").click(function () {
            var url = $(this).html(); //Not even close to working
            var overlay = jQuery('<div class="boxWrapper"><div class="box"><video src="'+url+'"</div></div>');

            overlay.appendTo(document.body);
    });
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:07:47.943

您可以`href`直接从单击的上下文中提取：

```
$("#tableBin").on("click", "a", function(e){
  e.preventDefault();
  url = this.href;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:07:49.633

给你：

```
$("#tableBin a").on("click", function(e) {
 e.preventDefault();
 var url = $(this).attr("href");
 var overlay = jQuery('<div class="boxWrapper"><div class="box"><video src="'+url+'"</div></div>');

 overlay.appendTo(document.body);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:09:29.253

`var url = $(this).html();`将为您提供一个包含 html 的字符串

`<a href="...">...</a>`标签。在你的情况下，它会读到类似`Clip1234`

你想读取`href`属性。

```
var url = this.href; //Plain old Javascript, not jQuery 
```

# java - 理论上是否有可能使用静态分析工具证明 Java 代码没有竞争条件？

> ID：10319428
> 
> 赞同：0
> 
> 时间：2012-04-25T16:05:03.690
> 
> 标签：java, multithreading, theory, static-analysis, race-condition

不管市场上有哪些静态分析工具，理论上是否有可能使用静态分析工具证明 Java（或任何其他命令式语言）代码没有竞争条件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:23:49.330

“Java 代码没有竞争条件”这句话非常含糊。也许您的意思是其中之一：

*   静态分析工具能否证明没有 Java 程序存在竞态条件？显然不是，因为确实存在具有竞争条件的 Java 程序。

*   静态分析工具是否*总能*证明无竞态条件的 Java 程序没有竞态条件？不，因为这相当于解决了停止问题（在可能终止也可能不终止的循环之后放置一个静态竞争条件。要判断竞争是否会实际发生，您需要知道循环是否终止）。

*   静态分析工具*有时*能证明无竞争条件的 Java 程序没有竞争条件吗？是的。事实上，这样的工具可能会非常有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:17:57.370

这只是我的直觉，但我会说不，至少对于一般的 Java 程序来说。*证明某些*程序不存在竞争条件应该不难（通常，任何单线程程序，识别单线程并不难）。*但是要为所有*Java程序做出决定？我怀疑 Java 的并发模型对此太无限制了。

我认为有可能证明在任意 Java 代码中确定不存在竞争条件等同于[停止问题](http://en.wikipedia.org/wiki/Halting_problem)，因为某些东西（最明显的是公共静态字段）可以被所有线程隐式访问，并且它们可以通过以下方式访问反射，使用任意复杂的代码确定用于查找它们的字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:10:10.267

这应该可以使用像 spin (http://spinroot.com/spin/whatispin.html) 这样的模型检查器。

但是，您需要创建从 java 到模型语言的翻译，并且这种类型的模型检查在计算上非常昂贵（包括占用大量内存），因此它的可行性是另一个问题。

如其他答案所述，对于特别复杂的代码，可能很难或不可能进行适当的建模，这些代码会掩盖实际调用或访问的数据成员。但是，对于合理的代码，这实际上在数学上不应该是不可能的（而不是真的很慢）。

也不可能考虑代码外部的任何特定竞争条件 - 因此，如果存在竞争条件的真正风险，将某些东西建模为非原子的原子 IO 操作将导致模型无效。

# networking - 设置 Arduino 以远程连接

> ID：10319431
> 
> 赞同：0
> 
> 时间：2012-04-25T16:05:08.993
> 
> 标签：networking, arduino, nat

我有一个 Arduino 使用以太网屏蔽连接到我的家庭网络。我可以使用简单的 URL 请求（例如 192.168.2.1/digitaloutput/8/1，将引脚 8 转为高电平等）来控制电路板。我只能在连接到我的家庭网络时这样做。

我需要做什么才能远程连接到它，比如从我的工作计算机上说？是否可以使用我目前使用的相同方法（Arduino 充当 Web 服务器）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:25:48.113

您显示的网络地址是一个“私有”地址，由您的路由器分配。在全球互联网上，这些地址是“不可路由的”，这意味着没有其他人可以访问您的 192.168.2.1（因为在其他家庭路由器后面有很多该地址的其他副本，并且无法知道哪个一个使用）。您需要找到路由器的公共 IP 地址，然后使用端口转发将路由器上的端口重定向到您的 Arduino。这是做你想做的最简单的方法，但也是最不安全的。

你可以`http:<router-address>/digitaloutput/8/1`从你的工作计算机上说类似的话，你的路由器会将 HTTP 请求转发到你的 Arduino。当然，世界上任何其他人也将能够做到这一点。提示：不要求从标准端口 80 提供 HTTP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T11:48:35.113

设置 Arduino Webserver 以进行远程访问

[http://arduino.cc/forum/index.php/topic,112955.0.html](http://arduino.cc/forum/index.php/topic,112955.0.html)

或者

[http://community.cosm.com/node/112](http://community.cosm.com/node/112)

# asp.net - 简单的 SignalR 聊天

> ID：10319438
> 
> 赞同：0
> 
> 时间：2012-04-25T16:05:36.827
> 
> 标签：asp.net, signalr

我按照[https://github.com/SignalR/SignalR/wiki/QuickStart-Hubs](https://github.com/SignalR/SignalR/wiki/QuickStart-Hubs)上的文档使用 SignalR Hubs 创建了一个简单的聊天应用程序。

我无法让它工作并且不明白我做错了什么？

我不断收到以下错误：

**SignalR：必须先启动连接，然后才能发送数据。在 .send() 之前调用 .start()**

集线器类：

```
public class Chat : Hub
{
    public void Send(string message)
    {
        Clients.addMessage(message);
    }
} 
```

客户：

```
<head runat="server">
    <title></title>
    <script src="Scripts/jquery-1.6.4.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery.signalR.min.js" type="text/javascript"></script>
    <script src="signalr/hubs" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            // Proxy created on the fly
            var chat = $.connection.chat;

            // Declare a function on the chat hub so the server can invoke it
            chat.addMessage = function (message) {
                $('#messages').append('<li>' + message + '</li>');
            };

            $("#broadcast").click(function () {
                // Call the chat method on the server
                chat.send($('#msg').val())
            .done(function () {
                console.log('Success!');
            })
            .fail(function (e) {
                console.warn(e);
            });
            });

            // Start the connection
        $.connection.hub.start();

        });
    </script>
</head>
<body>
    <div>
        <input type="text" id="msg" />
        <input type="button" id="broadcast" value="broadcast" />
        <ul id="messages">
        </ul>
    </div>
</body> 
```

套餐：

```
<packages>
  <package id="Newtonsoft.Json" version="4.0.8" />
  <package id="SignalR.Server" version="0.4.0.0" />
  <package id="Microsoft.Web.Infrastructure" version="1.0.0.0" />
  <package id="SignalR.Hosting.AspNet" version="0.4.0.0" />
  <package id="jQuery" version="1.6.4" />
  <package id="SignalR.Js" version="0.4.0.1" />
  <package id="SignalR" version="0.4.0" />
  <package id="jQuery.Color" version="1.0" />
</packages> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:31:15.650

您是否查看过浏览器的开发者工具，看看是否有任何错误？

SignalR 可能由于尝试连接到服务器时出现错误（例如 500）而无法在客户端上启动。

# linux-kernel - Linux中的进程调度机制

> ID：10319444
> 
> 赞同：2
> 
> 时间：2012-04-25T16:06:00.007
> 
> 标签：linux-kernel

我正在尝试为 Linux 2.4.18 实现一种新的调度机制，作为硬件分配的一部分。我有以下问题：在新机制中我需要在活动队列不为空时更改纪元，为此我需要将所有进程从活动队列转移到过期，然后在过期和活动之间切换. 我怎样才能检查活动队列中的所有进程，以便将它们转移到过期的队列中？

我尝试检查所有 140 个值为 1 的位图，并且在每个位图中我都使用了 for_each_task 并从活动中删除并插入到过期的位图中。

但是由于某种原因，当我更改为新机制（使用系统调用）时，系统会自行重置。

我的想法是，系统在调度功能期间处理这么多进程可能太难了？

有任何想法吗？

这是我在 schedule 函数中写的代码

```
for(int i=0;i<140;i++)
{

    if(this_rq()->active->bitmap[i])
    {
        list_t* iterator;
        list_t* queue=this_rq()->active->queue;
        list_for_each(iterator, queue + i)
        {
            task_t* p = list_entry(iterator,task_t,run_list);
            dequeue_task(p,this_rq()->active);
            enqueue_task(p,this_rq()->expired);
        }   

    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:18:02.807

我建议您在虚拟机中执行此操作，并通过串行使用 gdb 进行远程调试。它将帮助您更快地解决硬件中的后续错误——您将能够在代码所在的位置设置断点，并逐步查看内核死机的确切原因。

例如，如果您使用的是 VirtualBox，则可以按照[此处的说明进行操作](http://fotis.loukos.me/blog/?p=25)

您还需要在内核中[启用 kgdb](http://en.gentoo-wiki.com/wiki/KGDB)。

# c# - 释放文件上的句柄。来自 BitmapImage 的 ImageSource

> ID：10319447
> 
> 赞同：28
> 
> 时间：2012-04-25T16:06:23.560
> 
> 标签：c#, wpf, xaml

如何释放此文件的句柄？

img 是 System.Windows.Controls.Image 类型

```
private void Load()
{
    ImageSource imageSrc = new BitmapImage(new Uri(filePath));
    img.Source = imageSrc;
    //Do Work
    imageSrc = null;
    img.Source = null;
    File.Delete(filePath); // File is being used by another process.
} 
```

* * *

**解决方案**

* * *

```
private void Load()
{
    ImageSource imageSrc = BitmapFromUri(new Uri(filePath));
    img.Source = imageSrc;
    //Do Work
    imageSrc = null;
    img.Source = null;
    File.Delete(filePath); // File deleted.
}

public static ImageSource BitmapFromUri(Uri source)
{
    var bitmap = new BitmapImage();
    bitmap.BeginInit();
    bitmap.UriSource = source;
    bitmap.CacheOption = BitmapCacheOption.OnLoad;
    bitmap.EndInit();
    return bitmap;
} 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-25T16:19:05.967

在 MSDN 论坛上找到了答案。

> 除非缓存选项设置为 BitmapCacheOption.OnLoad，否则不会关闭位图流。所以你需要这样的东西：
> 
> ```
> public static ImageSource BitmapFromUri(Uri source)
> {
>     var bitmap = new BitmapImage();
>     bitmap.BeginInit();
>     bitmap.UriSource = source;
>     bitmap.CacheOption = BitmapCacheOption.OnLoad;
>     bitmap.EndInit();
>     return bitmap;
> } 
> ```
> 
> 并且当您使用上述方法获得 ImageSource 时，源文件将立即关闭。

[见 MSDN 社交论坛](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/5b2270cb-f182-4f5f-a6c6-c78dfe4e3230/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-07T19:55:49.230

在一个特别令人不安的图像上，我一直遇到这个问题。接受的答案对我不起作用。

相反，我使用流来填充位图：

```
using (FileStream fs = new FileStream(path, FileMode.Open))
{
    bitmap.BeginInit();
    bitmap.StreamSource = fs;
    bitmap.CacheOption = BitmapCacheOption.OnLoad;
    bitmap.EndInit();
} 
```

这导致文件句柄被释放。

# python - 用于 numpy 的大型磁盘阵列

> ID：10319448
> 
> 赞同：6
> 
> 时间：2012-04-25T16:06:28.113
> 
> 标签：python, arrays, numpy, sparse-matrix

我有一个稀疏数组，它似乎太大而无法在内存中有效处理（2000x2500000，float）。我可以将它形成一个稀疏的 lil_array (scipy) 但是如果我尝试输出一个列或行压缩的稀疏数组 (A.tocsc(), A.tocsr()) 我的机器内存不足(而且两者之间也存在严重的不匹配文本文件中的数据 4.4G 和腌制的 lil 数组 12G - 最好有一个更接近原始数据大小的磁盘格式）。

将来我可能会处理更大的数组。

问题：以透明方式使用常规 numpy 函数的方式处理大型磁盘阵列的最佳方法是什么。例如，沿行和列的总和、向量积、最大值、最小值、切片等？

pytables 是要走的路吗？是否有一个好的（快速）sql-numpy 中间件层？numpy 内置磁盘阵列的秘密？

在过去（略小）的数组中，我总是将长计算结果pickel缓存到磁盘。当阵列最终小于 4G 左右但不再成立时，此方法有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:08:49.960

我经常使用[内存映射`numpy`数组](http://docs.scipy.org/doc/numpy/reference/generated/numpy.memmap.html)来处理数 GB 的数值矩阵。我发现它们非常适合我的目的。显然，如果数据的大小超过了 RAM 的数量，则必须小心访问模式以避免[颠簸](http://en.wikipedia.org/wiki/Thrashing_%28computer_science%29)。

# html5-video - 在 HTML5 中循环下载视频的可靠方法？

> ID：10319449
> 
> 赞同：0
> 
> 时间：2012-04-25T16:06:29.447
> 
> 标签：html5-video

据我所知，没有可靠的方法可以在 HTML5 中循环播放视频。循环视频在超声等医疗应用中很重要。我已经尝试了所有我能找到的方法。

*   视频标签的“循环”属性在大多数情况下不起作用或需要媒体服务器

*   尝试在“结束”事件上设置处理程序以重置当前时间，包括各种博客中该主题的所有变体

有些人建议需要媒体服务器来处理部分请求。击中服务器重新启动不是一种选择。时间太长了。视频需要立即循环播放。

无法循环播放下载的视频似乎是一件愚蠢的事情。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:14:45.707

我知道这不是一个非常直接的答案，但是如果您在这里查看 jPlayer 及其循环选项[http://www.jplayer.org/latest/developer-guide/#jPlayer-option-loop](http://www.jplayer.org/latest/developer-guide/#jPlayer-option-loop)您可能会找到一些有用的提示如何让它跨浏览器工作。此外，如果您需要跨浏览器的可移植性，jPlayer 非常好（我经常将它用于音频，但视频应该相同）。

# android - IntentService 中实现的 Android LocationLister 从不执行 OnLocationChanged() 方法

> ID：10319466
> 
> 赞同：4
> 
> 时间：2012-04-25T16:07:25.967
> 
> 标签：android, intentservice, locationlistener

我编写了一个实现 LocationListener 接口的 IntentService。当第一次调用 OnLocationChanged() 方法时，服务应该发送一条消息。但是永远不会调用 OnLocationChanged()。这是我的代码：

```
public class MyIntentService extends IntentService implements LocationListener {

    private int result = Activity.RESULT_CANCELED;
    protected Messenger mMessenger;
    protected LocationManager mLocationManager = null;

    public MyIntentService() {
        super("LocationService");
    }

    @Override
    protected void onHandleIntent(Intent intent) {
        Log.i(TAG, "Got starting intent: " + intent.toString());
        Bundle extras = intent.getExtras();

        if (extras != null) {
            Messenger = (Messenger) extras.get("MESSENGER");

            if(mLocationManager == null) {  
            mLocationManager =  (LocationManager) MyIntentService.this
                                    .getSystemService(Context.LOCATION_SERVICE);
            }
            String provider = LocationManager.GPS_PROVIDER;
            boolean gpsIsEnabled = mLocationManager.isProviderEnabled(provider);

            if(gpsIsEnabled) {
                Context con = MyIntentService.this;
                mLocationManager.requestLocationUpdates(provider, 0, 0,
                                                        MyIntentService.this);
            } 
            else {
                Log.i(TAG, "NO GPS!");
            }
        }

    @Override
    public void onLocationChanged(Location location) {
        Log.i(TAG, "Got Location");
        Log.i(TAG, "Got Messenger: " + mMessenger.toString() 
                    + "\nand Location Manager: " + mLocationManager.toString());

        if(mMessenger != null && mLocationManager != null){
            result = Activity.RESULT_OK;
            Message msg = Message.obtain();
            msg.arg1 = result;
            msg.obj = location;
            mLocationManager.removeUpdates(MyIntentService.this);

            try { mMessenger.send(msg); } 
            catch (RemoteException e) {
                Log.i(TAG, "Exception caught : " + e.getMessage());
            }
        }
    }

    @Override
    public void onProviderDisabled(String provider) {}

    @Override
    public void onProviderEnabled(String provider) {}

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {}

} 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T17:59:19.013

> 我编写了一个实现 LocationListener 接口的 IntentService。

这不是一个好主意。An`IntentService`不应该做任何超出该`onHandleIntent()`方法的事情。

> 当第一次调用 OnLocationChanged() 方法时，服务应该发送一条消息。但是永远不会调用 OnLocationChanged()。

这并不奇怪，因为服务将在创建后一毫秒左右被销毁，具体取决于您的实现。

如果您的目标是始终拥有一个合理的当前位置，请尝试[Little Fluffy Location Library](http://code.google.com/p/little-fluffy-location-library/)。或者，考虑我的[`LocationPoller`](https://github.com/commonsguy/cwac-locpoll).

# ios - 如何查看使用 NSURLConnection 为 HTTP 请求设置的标头字段（cookie）？

> ID：10319468
> 
> 赞同：1
> 
> 时间：2012-04-25T16:07:30.180
> 
> 标签：ios, nsurlconnection, nsurlrequest

我想检查传出 HTTP 消息的标头值是什么，特别是我想看看标头中设置了哪些 cookie。

我正在使用 NSURLConnection，如果在使用 NSURLRequest 初始化 NSURLConnection 时我检查 [NSURLRequest allHTTPHeaderFields] 那么它是空的（除非我自己设置了一个标头字段，例如用户代理，在这种情况下这是唯一的字段由 allHTTPHeaderFields 返回。

但是，操作系统必须在此之后的某个时候为标头添加其他默认值，我在哪里/如何查看使用 HTTP POST/GET 发送的标头值？

特别是我想检查是否/哪些cookies被自动设置在标题中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:32:12.820

Cookie 由系统添加并从手机上的共享 Cookie 存储中提取。因此，要查看为您的域存储了哪些 cookie，您将使用：

```
[[NSHTTPCookieStorage sharedHTTPCookieStorage] cookiesForURL:[NSURL URLWithString:yourURL]] 
```

# ios - 将数据从应用程序传输到应用程序？

> ID：10319470
> 
> 赞同：1
> 
> 时间：2012-04-25T16:07:42.247
> 
> 标签：ios, networking, data-transfer

这是我的计划。两个人有我的应用程序，我需要从一个人到另一个人获取一堆数据。

接收数据的人不知道他们可能会收到一些东西，他们两个人可能在世界上完全不同的地方，所以无法在本地传输。

因此，我们可能有数千名使用该应用程序的人，我可以拥有它，托管一堆数据，然后只有我指定的接收者才能从我那里获取这些数据并将其保存在他们的应用程序中。

我对服务器/网络的东西非常陌生，因此您的回复中的详细信息将非常有帮助。

任何有关如何执行此操作的帮助或提示将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:14:21.423

听起来像一个经典的客户端服务器。

设置服务器。让用户 A 的应用程序向服务器发送数据。向我们发送推送通知 B 他有新数据。当用户 B 打开应用程序时，让他轮询服务器以获取他的新信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-25T16:14:16.813

将数据存储在在线数据库中。

# android - Android - sdcard_rw 的 groupId 是否始终为 1015？

> ID：10319471
> 
> 赞同：2
> 
> 时间：2012-04-25T16:07:45.467
> 
> 标签：android, permissions, emulation, sd-card, device

我发现该组在我的模拟器上`sdcard_rw`的 id 为**1015 。**

在我的 Nexus One 上也是如此。

是固定的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T10:51:41.603

是的，它是固定的，请参阅`android_filesystem_config.h`android 源代码：

```
#define AID_SDCARD_RW     1015  /* external storage write access */ 
```

# python - Python- ArcMap - 计算字段

> ID：10319478
> 
> 赞同：1
> 
> 时间：2012-04-25T16:08:22.963
> 
> 标签：python, arcmap

我是 python 新手，我试图通过使用来计算 ArcMap 中一列（名称）中的单词数

> !NAME!.count(' ') + 1

但我遇到了以下字符串的问题：

*First N'婴儿护理中心“婴儿世界”*

type.exceptions.Syntaxerror，即使我使用“”，我在使用其他方法（如拆分、剥离等）时也会遇到同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T00:05:09.747

尝试

len(!Name!.split(" "))

如果这不起作用...让我们知道它在哪个功能上失败了，也许还有更多示例数据？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-17T17:22:48.050

尝试对字符串进行编码，arc 用他们的字符串编码做了一些有趣的事情......

```
!NAME!.encode('ascii', 'ignore').count(' ') + 1 
```

# java - 从另一个活动调用时，Android 中的 Sharedpreferences 返回 null

> ID：10319481
> 
> 赞同：1
> 
> 时间：2012-04-25T16:08:30.387
> 
> 标签：java, android, sharedpreferences, android-context

我做了两项活动，一项用于小部件，一项用于设置活动。

在设置活动中初始化了两个变量“strSavedMem1”和“strSavedMem1”......并通过 sharedPreference 方法生成。

但是当我尝试在小部件活动中使用该变量时，该变量返回一个“null”值。

小部件活动：

```
package com.eightbitcloud.example.widget;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Calendar;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Handler;
import android.preference.PreferenceManager;
import android.util.Log;
import android.widget.RemoteViews;

import com.shashank.pingwidget.R;

public class ExampleAppWidgetProvider extends AppWidgetProvider {
private static final String LOG_TAG = "Ping_Widget";
private static Handler handler;
static String currentTime = null ;
public String strSavedMem1;
public String strSavedMem2;
public static final String PREFS_NAME="LocalePrefs";

/**
 * Custom Intent name that is used by the AlarmManager to tell us to update the               clock once per second.
 */
public static String PING_WIDGET_UPDATE =    "com.eightbitcloud.example.widget.8BITCLOCK_WIDGET_UPDATE";

@Override
public void onReceive(Context context, Intent intent) {
    super.onReceive(context, intent);

    if (PING_WIDGET_UPDATE.equals(intent.getAction())) {
        Log.d(LOG_TAG, "Clock update");
        // Get the widget manager and ids for this widget provider, then call the shared
        // clock update method.
        ComponentName thisAppWidget = new        ComponentName(context.getPackageName(), getClass().getName());
        AppWidgetManager appWidgetManager =   AppWidgetManager.getInstance(context);
        int ids[] = appWidgetManager.getAppWidgetIds(thisAppWidget);
        for (int appWidgetID: ids) {
            updateAppWidget(context, appWidgetManager, appWidgetID);

        }
    }
}

private PendingIntent createClockTickIntent(Context context) {
    Intent intent = new Intent(PING_WIDGET_UPDATE);
    PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent,     PendingIntent.FLAG_UPDATE_CURRENT);

    return pendingIntent;
}

@Override
public void onDisabled(Context context) {
    super.onDisabled(context);
    Log.d(LOG_TAG, "Widget Provider disabled. Turning off timer");
    AlarmManager alarmManager = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
    alarmManager.cancel(createClockTickIntent(context));    
}

@Override 
public void onEnabled(Context context) {
    super.onEnabled(context);

SharedPreferences sharedPreferences = context.getSharedPreferences(PREFS_NAME,0);
    strSavedMem1 = sharedPreferences.getString("MEM1", null);
    if (strSavedMem1 == null) {
        strSavedMem1="google.com";
          Log.d(getClass().getSimpleName(),"MEM1 name is: "+ strSavedMem1);
    } 

    strSavedMem2 = sharedPreferences.getString("MEM1", null);
    if (strSavedMem2 == null) {
        strSavedMem2 = "1";
        Log.d(getClass().getSimpleName(),"MEM2 name is: "+ strSavedMem2);
    } 

    Log.d(LOG_TAG, "Widget Provider enabled.  Starting timer to update widget every second");
    AlarmManager alarmManager = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);

    Calendar calendar = Calendar.getInstance();
    calendar.setTimeInMillis(System.currentTimeMillis());
    calendar.add(Calendar.SECOND, 30);
    alarmManager.setRepeating(AlarmManager.RTC, calendar.getTimeInMillis(), 50000, createClockTickIntent(context));
}

@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
    final int N = appWidgetIds.length;

    Log.d(LOG_TAG, "Updating Example Widgets.");

    // Perform this loop procedure for each App Widget that belongs to this
    // provider
    for (int i = 0; i < N; i++) {
        int appWidgetId = appWidgetIds[i];

        // Create an Intent to launch ExampleActivity
        Intent intent = new Intent(context, WidgetExampleActivity.class);
        PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0);

        // Get the layout for the App Widget and attach an on-click listener
        // to the button
        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget1);
        views.setOnClickPendingIntent(R.id.button, pendingIntent);
        // Tell the AppWidgetManager to perform an update on the current app
        // widget
        appWidgetManager.updateAppWidget(appWidgetId, views);

        // Update The clock label using a shared method
        updateAppWidget(context, appWidgetManager, appWidgetId);
    }
}

public  void updateAppWidget(final Context context, final AppWidgetManager appWidgetManager, final int appWidgetId) {
    //String currentTime =  df.format(new Date());
    handler = new Handler();

    Runnable runnable = new Runnable() {

        @Override
        public void run() {

            try {
                String pingCmd = "ping -c 3 " + "google.com";
                String pingResult = "";
                Runtime r = Runtime.getRuntime();
                Process p = r.exec(pingCmd);
                BufferedReader in = new BufferedReader(new
                InputStreamReader(p.getInputStream()));
                String inputLine;
                while ((inputLine = in.readLine()) != null) {
                System.out.println(inputLine);
                currentTime = inputLine + "\n";
                pingResult += inputLine+ "\n";
                currentTime = pingResult ;
                }
                in.close();
                }//try
                catch (IOException e) {
                System.out.println(e);
                }

                handler.post(new Runnable() {
                    @Override
                    public void run() {
                        //progress.setProgress(value);
                        RemoteViews updateViews = new RemoteViews(context.getPackageName(), R.layout.widget1);
                        updateViews.setTextViewText(R.id.widget1label, currentTime+"\n"+ strSavedMem1+"\n"+strSavedMem2);
                        appWidgetManager.updateAppWidget(appWidgetId, updateViews); 

                    }
                });
        }

    };
    new Thread(runnable).start();

    }
} 
```

设置活动是：

```
package com.eightbitcloud.example.widget;
import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

import com.shashank.pingwidget.R;

public class WidgetExampleActivity extends Activity {
public static final String PREFS_NAME="LocalePrefs";
public Context ctx = null;
EditText editText1, editText2;
TextView textSavedMem1, textSavedMem2;
Button buttonSaveMem1, buttonSaveMem2;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

     textSavedMem1 = (TextView)findViewById(R.id.savedmem1);
       textSavedMem2 = (TextView)findViewById(R.id.savedmem2);
       editText1 = (EditText)findViewById(R.id.edittext1);
       editText2 = (EditText)findViewById(R.id.edittext2);
       buttonSaveMem1 = (Button)findViewById(R.id.save_mem1);
       buttonSaveMem2 = (Button)findViewById(R.id.save_mem2);

       buttonSaveMem1.setOnClickListener(buttonSaveMem1OnClickListener);
       buttonSaveMem2.setOnClickListener(buttonSaveMem2OnClickListener);

       LoadPreferences();
   }

   Button.OnClickListener buttonSaveMem1OnClickListener
    = new Button.OnClickListener(){

  @Override
  public void onClick(View arg0) {
   // TODO Auto-generated method stub
   SavePreferences("MEM1", editText1.getText().toString());
   LoadPreferences();
  }

   };

   Button.OnClickListener buttonSaveMem2OnClickListener = new Button.OnClickListener(){

  @Override
  public void onClick(View arg0) {
   // TODO Auto-generated method stub
   SavePreferences("MEM2", editText2.getText().toString());
   LoadPreferences();
  }

   };

  private void SavePreferences(String key, String value){

    SharedPreferences sharedPreferences = getSharedPreferences(PREFS_NAME,MODE_WORLD_READABLE);

        /*SharedPreferences.Editor editor = sharedPreferences.edit();
        editor.putString(key, value);
        editor.commit();*/

        //SharedPreferences sharedPreferences =PreferenceManager.getDefaultSharedPreferences(WidgetExampleActivity.this);

      //SharedPreferences sharedPreferences = getSharedPreferences(PREFS_NAME,  MODE_WORLD_READABLE);

        SharedPreferences.Editor editor = sharedPreferences.edit();
        editor.putString(key, value);
        editor.commit();
       }

       public void LoadPreferences(){

    //  SharedPreferences sharedPreferences = ctx.getSharedPreferences(PREFS_NAME, MODE_WORLD_READABLE);
        SharedPreferences sharedPreferences = getSharedPreferences(PREFS_NAME,  MODE_WORLD_READABLE);

        String strSavedMem1 = sharedPreferences.getString("MEM1", "google.com");
        String strSavedMem2 = sharedPreferences.getString("MEM2", "1");
        textSavedMem1.setText(strSavedMem1);
        textSavedMem2.setText(strSavedMem2);

        strSavedMem1 = sharedPreferences.getString("MEM1", null);
        if (strSavedMem1 == null) {
            strSavedMem1="google.com";
              Log.d(getClass().getSimpleName(),"Wallpaper name is: "+ strSavedMem1);
        } 

        strSavedMem2 = sharedPreferences.getString("MEM1", null);
        if (strSavedMem2 == null) {
            strSavedMem2 = "1";
            Log.d(getClass().getSimpleName(),"Wallpaper name is: "+ strSavedMem2);
        }

       }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:32:53.240

你应该

*   检查提交是否有效并返回true。
*   使用 MODE_PRIVATE 以相同的方式打开两个 SharedPreferences（作为常量而不是它的值）

# css - H1标签和P标签在同一行？

> ID：10319483
> 
> 赞同：25
> 
> 时间：2012-04-25T16:08:32.347
> 
> 标签：css

我试图在结束 H1 标记之后的 P 标记内放置一些文本，如下所示：

**标题**这是紧随其后的文字......

但我无法让它工作。我制作了这个 CSS，但可能缺少一些东西？

CSS：

```
p.start {
    font-family: 'Open Sans', sans-serif;
    font-size: 16px;
    line-height: 28px;
    text-align: justify;
    display: inline;
}

h1.start {
    font-family: 'Open Sans', sans-serif;
    font-size: 16px;
    line-height: 28px;
    margin: 0;
    display: inline-block;
} 
```

HTML：

```
<div id="containerIntro">
    <h1 class="start">Headline </h1>
    <p class="start">Text......</p>
</div> 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-25T16:14:49.617

所以如果你有：

```
<div id="containerIntro">
    <h1>Headline</h1>
    <p>And here the text right after...</p>
</div> 
```

您的 CSS 必须看起来像这样：

```
#containerIntro h1,
#containerIntro p {
    display: inline;
    vertical-align: top;
    font-family: 'Open Sans', sans-serif;
    font-size: 16px;
    line-height: 28px;
} 
```

请参阅[http://jsfiddle.net/F3Bcd/3/](http://jsfiddle.net/F3Bcd/3/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T16:11:49.277

`<p>`和元素都是`<h1>`块级的——这意味着它们占据了容器的整个宽度。您可以尝试将两个元素都向左浮动。这会将它们彼此堆叠到左侧，并将它们转换为内联元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:12:22.450

如果您还可以显示您的 HTML，那就更容易了。我现在只是猜测。

```
h1.start {
font-family: 'Open Sans', sans-serif;
font-size: 16px;
line-height: 28px;
margin: 0;
display: inline-block;
width: 200px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:35:43.187

将您的 CSS 更改为以下内容：

```
p.start {
font-family: 'Open Sans', sans-serif;
font-size: 16px;
line-height: 28px;
text-align: justify;
width: 200px;
float: left;
}

h1.start {
font-family: 'Open Sans', sans-serif;
font-size: 16px;
line-height: 28px;
margin: 0;
width: 200px;
float: left;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-20T00:44:59.633

在 CSS 中创建具有所需属性和值的新标签，或编辑现有标签（例如：.address）。然后将您想要内联的文本放在该标签下，就是这样。

之后，代码应如下所示：

```
containerIntro h1,

containerIntro address //(in our case) 

{display: inline;} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-09-23T16:18:38.907

您可以**用最简单的方式在 ONE LINE中实现这一目标**

如果您不只严格使用 h1 和 p 并且想要实现此目的：

**标题**下面是...之后的文本，将您的 html 更改为：

html:

```
<p><b="seems-h1">Headline</b>the text right after....</P> 
```

然后在class的帮助下增加css中b的字体大小，看起来像h1

CSS：

```
.seems-h1{font-size: 32px;} 
```

我认为这是最简单的方法，**可能效率不高**，如果您想快速完成工作，请使用。

# java - “类 filereader.FileReader 中的构造函数 FileReader 不能应用于给定类型”

> ID：10319495
> 
> 赞同：2
> 
> 时间：2012-04-25T16:09:12.253
> 
> 标签：java, filereader

第一次在这里发帖。

我正在编写一个 Java 程序，该程序接受一个输入文本文件，读取内容，然后将它们打印到屏幕上，并创建一个包含内容的输出文件。我已经设置了必要的作家，但是当我尝试使用`BufferedReader readername = new BufferedReader(new FileReader(inFile));`它时，标题中出现了错误。

任何想法是什么原因造成的？

这是代码。

```
public class FileReader 
{
    public static void main(String[] args) throws IOException
    {
        try
        {
        File inFile = new File("inputText.txt");
        BufferedReader reader = new BufferedReader(new FileReader(inFile));
        String line = null;
        BufferedWriter writer = new BufferedWriter(new FileWriter("Contents.txt"));

        while ((line=reader.readLine()) != null)
                    {
                        writer.write(line);
                        System.out.println("File 'Contents.txt' successfully written");
                        System.out.println(line);
                    }
        }
        catch (IOException e)
        {
            System.out.println(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T16:17:25.073

使用完全限定的类名，因为在调用 a 时`java.io.FileReader`已经调用了一个类，如下所示：`FileReader``BufferedReader`

```
BufferedReader reader = new BufferedReader(new java.io.FileReader(inFile)); 
```

如果不完全限定您的`FileReader`（或指定导入），编译器将使用您声明的`FileReader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:19:39.733

这里的问题是你的类名是`FileReader`你想要使用的，`java.io.FileReader`因此编译器很困惑，而不是`java.io.FileReader`假设它是你的类。基本上，您的 ClassName 会隐藏 java.io 包中的名称。

将您的课程重命名为其他`MyFileReader`名称或使用完全限定的命名`java.io.FileReader`

# properties - 未从属性文件中读取 Struts 2 属性

> ID：10319496
> 
> 赞同：0
> 
> 时间：2012-04-25T16:09:14.287
> 
> 标签：properties, struts2, formatting

在关注了 struts 2 网页和大量示例之后，我的应用程序仍然不会从 struts.properties 文件中获取值。

我正在尝试这样做，以便为某些值提供货币类型格式：

```
<s:property value="getText('struts.money.format',{value})" /> 
```

我的 struts.properties 文件位于 WEB-INF/classes 下，因此可见，具有以下单行

```
struts.money.format= {0,number,\u00A4##0.00} 
```

我将字符串`struts.money.format`打印到屏幕上。如果我更改 getText 调用的第一个参数，我输入的新字符串也将被打印出来，而不是发生真正的查找。

如果我这样做，`<s:property value="value" />`我会得到一个正确的号码。如果我在 getText 调用中删除第二个参数，我希望在属性文件中取回赋值的右侧，但我得到了同样的结果`struts.money.format`。

我将 Tomcat 6 与 Struts 2.2.1.1 一起使用。我可能遗漏了这个谜题的其他部分吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:35:22.617

所以在我的 struts.xml 文件中，我把这一行

```
 <constant name="struts.custom.i18n.resources" value="struts" /> 
```

它需要知道我正在尝试使用 struts.properties 文件。我假设默认情况下，一个名为 struts.properties 的文件位于位置链中以查找诸如此类的常量。仅当您将其命名为其他名称时，您才需要指定它。尽管它位于 Struts 2 文档推荐的 WEB-INF/classes 中，但它只是没有在该文件中查找。

**编辑**

对于它的价值，我还必须像这样修改我的 struts 文本标签

```
<s:property value="getText('struts.money.format',{@java.lang.Double@valueOf(value)})" /> 
```

实际上，`value`它应该是一个 BigDecimal，但在这里的视图级别被视为 java.lang.String。问题是某些 String 对象具有指数格式（如 1.642E07 或类似的东西），并且 struts 格式化程序无法处理指数格式。valueOf 消除了这种指数格式

# java - 我如何将代码移动到不同的类？

> ID：10319497
> 
> 赞同：1
> 
> 时间：2012-04-25T16:09:14.863
> 
> 标签：java, android

在[SimpleApp](http://code.google.com/p/libgdx/wiki/SimpleApp)教程中，作者将他所有的代码放在一个类文件中。使雨水和水桶在其中。

我尝试只获取代码并将其放入另一个类，但是我的代码中会有重复的方法，从逻辑上讲它是不正确的。例如，我不能在一个游戏中拥有两个创建方法。

**我如何将[教程中的](http://code.google.com/p/libgdx/wiki/SimpleApp)*雨水*或*水桶*放入不同的班级？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:10:57.363

您将常用函数抽象为[抽象类](http://docs.oracle.com/javase/tutorial/java/IandI/abstract.html)或[接口](http://docs.oracle.com/javase/tutorial/java/concepts/interface.html)，然后从该类继承 rain 和 bucket。

因此，对于您的特定示例，请遍历两个类，找到所有常用函数并将它们抽象为超类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:37:30.150

这很简单：您可以从 OOP 风格的编码中受益：
只需使用一个包含所有方法的超类`RainBucket`，每个方法的代码最少。
从这个超类扩展其他两个类并在其中覆盖您的类想要使用的方法，这样您将完成以下 OOP 规则：

1.  继承：当您从超类派生其他两个对象时：

    `class Bucket extends RainBucket {`

    `class Rain extends RainBucket {`

2.  多态性：您可以从同一个超类声明两个对象，但是通过将两个不同的派生类分配为如下值：

    `RainBucket bucket = new Bucket()`和

    `RainBucket rain = new Rain()`

# mysql - SQL 语句中的错误

> ID：10319502
> 
> 赞同：1
> 
> 时间：2012-04-25T16:09:22.613
> 
> 标签：mysql, database, mysql-error-1064, create-table

我在sql中找不到这个错误，有人可以帮忙吗？

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'ID MEDIUMINT(9) NOT NULL AUTO_INCREMENT, datetimeTIMESTAMP, title TEXT NOT' 附近使用正确的语法

```
CREATE TABLE tableName1 (
    ID MEDIUMINT(9) NOT NULL AUTO_INCREMENT,
    timestamp TIMESTAMP NOT NULL,
    title TEXT NOT NULL,
    titleEdited TEXT,
    description TEXT NOT NULL,
    descriptionEdited TEXT,
    URL VARCHAR(255) NOT NULL,
    URLEdited VARCHAR(255),
    imgPath VARCHAR(255) NOT NULL,
    PRIMARY KEY (ID),
    UNIQUE KEY (URL, imgPath)
)

CREATE TABLE tableName2 (
    ID MEDIUMINT(9) NOT NULL AUTO_INCREMENT,
    linkID MEDIUMINT(9) NOT NULL,
    timestamp TIMESTAMP NOT NULL,
    comment TEXT NOT NULL,
    userID BIGINT(20) NOT NULL,
    PRIMARY KEY(ID),
    FOREIGN KEY(linkID) REFERENCES tableName1(ID),
    FOREIGN KEY(userID) REFERENCES users(ID)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:12:07.963

I think the only thing that is wrong here is that mySQL needs a semicolon after each execution. You should just have to end each `create table` with a `;` and this should work

[Here is a SQL Fiddle to prove that.](http://sqlfiddle.com/#!2/5a1a3/1) (Minus the FK to users since that table is not in your example)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:12:27.937

Are you sure you are creating this tables and getting error? I created them succesfuly.

And with looking error, it seems you are trying to create another field named datetime which type is timestamp? datetime is reserverd word. You need to use backticks.

'ID MEDIUMINT(9) NOT NULL AUTO_INCREMENT, **datetimeTIMESTAMP**, title TEXT NOT' at line 1

# javascript - 用绝对值创建 div

> ID：10319505
> 
> 赞同：2
> 
> 时间：2012-04-25T16:09:26.033
> 
> 标签：javascript, jquery, css, html, absolute

我想像下图一样订购 div 任何人都可以提供帮助吗？

所有 div 都有特定的宽度，但它们没有高度限制。每列可以有 4 个 div，下一个 div（第 5 个 div）位于第一个 div 的底部，但顶部和底部 div 的空间必须相同（边距：5px）

![在此处输入图像描述](../Images/c0af026c3ebae06a9764d591e6423a77.png)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:11:04.110

正如你可能知道的那样，你不能在纯 CSS 中做到这一点，因为它是水平的。对于 jQuery 解决方案，请查看[Columnizer jQuery Plugin](http://welcome.totheinter.net/columnizer-jquery-plugin/)之类的插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T17:37:33.410

查看它使用[同位素的](http://isotope.metafizzy.co/)[https://stackexchange.com/sites](https://stackexchange.com/sites)！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T17:33:56.850

Nathan 的建议很好——还有[Masonry](http://masonry.desandro.com/)，它也依赖于 jQuery。

# c - 如何将合成鼠标事件插入 X11 输入队列

> ID：10319519
> 
> 赞同：12
> 
> 时间：2012-04-25T16:09:53.567
> 
> 标签：c, gtk, mouseevent, x11, gtk2

我有一个运行 Linux/X11 的嵌入式设备，它连接到通过 USB 连接提供触摸事件的设备。该设备不被识别为任何形式的标准指针/鼠标输入。我正在尝试做的是找到一种在外部设备报告事件时将鼠标事件“注入”到 X11 的方法。

这样做将消除我的应用程序（使用 Gtk+ 用 C 语言编写）通过 Gtk+ 调用伪造鼠标按下的需要。

如果可以做到这一点，我的 Gtk+ 应用程序就不需要知道或关心生成触摸事件的设备。它只会在应用程序中显示为标准鼠标事件。

有人知道如何将合成鼠标事件插入 X11 吗？

现在我正在做以下工作，但不是最佳的。

```
GtkWidget *btnSpin;     /* sample button */

gboolean buttonPress_cb( void *btn );
gboolean buttonDePress_cb( void *btn );

/*  make this call after the device library calls the TouchEvent_cb() callback
    and the application has determined which, if any, button was touched

    In this example we are assuming btnSpin was touched.

    This function will, in 5ms, begin the process of causing the button to do it's 
    normal animation ( button in, button out effects ) and then send the actual
    button_clicked event to the button.
*/
g_timeout_add(5, (GSourceFunc) buttonPress_cb, (void *)btnSpin);

/*  this callback is fired 5ms after the g_timeout_add() function above.
    It first sets the button state to ACTIVE to begin the animation cycle (pressed look)
    And then 250ms later calls buttonDePress_cb which will make the button look un-pressed
    and then send the button_clicked event.
*/    
gboolean buttonPress_cb( void *btn )
{

    gtk_widget_set_state((GtkWidget *)btn, GTK_STATE_ACTIVE);
    g_timeout_add(250, (GSourceFunc) buttonDePress_cb, btn);

    return( FALSE );
}

/*  Sets button state back to NORMAL ( not pressed look )
    and sends the button_clicked event so that the registered signal handler for the
    button can be activated
*/
gboolean buttonDePress_cb( void *btn )
{

    gtk_widget_set_state( btn, GTK_STATE_NORMAL);
    gtk_button_clicked( GTK_BUTTON( btn ));

    return( FALSE );
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-25T16:25:00.180

有几种方法。

1.  使用`XSendEvent`. 警告：一些应用程序框架会忽略使用`XSendEvent`. 我认为 Gtk+ 没有，但我没有检查过。
2.  使用`XTestFakeMotionEvent`和`XTestFakeButtonEvent`。您需要 X 服务器上的 XTest 扩展。
3.  为您的设备编写内核驱动程序，使其显示为鼠标/触摸板。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-25T19:01:52.623

Linux 输入系统有一个用于用户空间实现输入设备的工具，称为 uinput。您可以编写一个后台程序，使用您设备的回调库将输入事件发送到内核。X 服务器（假设它使用 evdev 输入模块）然后会像处理任何其他鼠标事件一样处理这些。

有一个名为[libsuinput](http://tjjr.fi/sw/libsuinput/)的库可以让这很容易做到。它甚至包括一个[示例鼠标输入程序](https://github.com/tuomasjjrasanen/libsuinput/blob/master/examples/mouse.c)，您可以将其用作模型。但是，由于您的设备是基于触摸的设备，它可能会使用绝对轴 (ABS_X, ABS_Y) 而不是相对轴 (REL_X, REL_Y)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-25T16:27:26.150

最酷的事情是在内核中实现一个设备驱动程序，该驱动程序创建一个`/dev/input/eventX`使用 evdev 协议的文件。`Linux Device Drivers`如果你想这样做，我建议你阅读这本书。这本书在网络上免费提供。

如果您想在用户空间执行此操作，我建议您使用 Xlib（或 XCB）。在普通 Xlib（C 语言）上，您可以使用`X Test Extension`or `XSendEvent()`。

xautomation 包中还有一个名为 xte 的二进制文件（在 Debian 上，`sudo apt-get install xautomation`然后是`man xte`）。`xte`非常好用，你也可以看看它的源码来学习如何使用X Test Extension。

指针：

*   [http://lwn.net/Kernel/LDD3/](http://lwn.net/Kernel/LDD3/)
*   [http://cgit.freedesktop.org/xorg/lib/libXtst/](http://cgit.freedesktop.org/xorg/lib/libXtst/)
*   [http://cgit.freedesktop.org/xcb/xpyb/](http://cgit.freedesktop.org/xcb/xpyb/)
*   [http://hoopajoo.net/projects/xautomation.html](http://hoopajoo.net/projects/xautomation.html)
*   [http://linux.die.net/man/1/xte](http://linux.die.net/man/1/xte)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T18:47:00.410

似乎经过一番研究，Gtk+ 使用了一个 GDK 库，它可以做我想做的事，而无需深入研究 X11 编码或编写内核驱动程序。虽然，如果我有时间，我更愿意编写一个 Linux 内核鼠标驱动程序。

使用[GDK 2 Reference Manual](http://developer.gnome.org/gdk/stable/gdk-Events.html#gdk-event-put)我发现我可以执行以下操作：

用于`gtk_event_put()`附加一个`GdkEvent`类型`GdkEventButton`

a 的结构`GdkEventButton`是：

```
struct GdkEventButton {
  GdkEventType type;
  GdkWindow *window;
  gint8 send_event;
  guint32 time;
  gdouble x;
  gdouble y;
  gdouble *axes;
  guint state;
  guint button;
  GdkDevice *device;
  gdouble x_root, y_root;
}; 
```

这些字段中的大多数将很容易填写，但以下内容除外：

```
gdouble x;
    the x coordinate of the pointer relative to the window.

gdouble y;
    the y coordinate of the pointer relative to the window.

GdkDevice *device;
    the device where the event originated.

gdouble x_root;
    the x coordinate of the pointer relative to the root of the screen.

gdouble y_root;
    the y coordinate of the pointer relative to the root of the screen. 
```

我将需要研究如何将屏幕根坐标转换为窗口相对坐标。

`*device`- 我不确定是否需要使用此字段（设置为 NULL ），因为这是用于扩展输入设备。但是，如果我确实需要在这里有一个有效的设备，我应该能够使用[gdk_devices_list()](http://developer.gnome.org/gdk/stable/gdk-Input-Devices.html#gdk-devices-list)

# c# - 如何使用带有 4.6.5 时区组件 VTIMEZONE 的 C# TimeZoneInfo 类创建会议请求

> ID：10319520
> 
> 赞同：0
> 
> 时间：2012-04-25T16:09:56.263
> 
> 标签：c#, asp.net, timezone, timezone-offset

再会！

我正在尝试更新一些预先存在的代码，这些代码使用 4.6.5 时区组件 VTIMEZONE 根据用户在 asp.net 网站上的表单中的输入创建会议请求。我正在进行的更新是删除作为枚举列出的静态时区列表，并用 TimeZoneInfo GetSystemTimeZones 方法替换它们。问题是 VTIMEZONE 的设置方式具有静态值。我想知道如何最好地解决这个问题，并欢迎任何建议。

这是代码片段：

```
 private const string vTimeZoneTemplate = @"
BEGIN:VTIMEZONE
TZID:Pacific
BEGIN:STANDARD
DTSTART:20071104T020000
RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11
TZOFFSETFROM:-0700
TZOFFSETTO:-0800
TZNAME:PST
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:20070311T020000
RRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3
TZOFFSETFROM:-0800
TZOFFSETTO:-0700
TZNAME:PDT
END:DAYLIGHT
END:VTIMEZONE
BEGIN:VTIMEZONE
TZID:Eastern
BEGIN:STANDARD
DTSTART:20071104T020000
RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11
TZOFFSETFROM:-0400
TZOFFSETTO:-0500
TZNAME:EST
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:20070311T020000
RRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3
TZOFFSETFROM:-0500
TZOFFSETTO:-0400
TZNAME:EDT
END:DAYLIGHT
END:VTIMEZONE"; 
```

最终目标是为所选时区设置会议请求的开始时间。即，我选择在伊斯坦布尔 (UTC+02:00) 下午 4:00 开始的 2 小时会议，它将在伊斯坦布尔时间（目前是土耳其标准时间）的下午 4:00 到下午 6:00 创建一个会议请求。

如果有帮助，我正在使用 TimeZoneInfo：

```
 if (!IsPostBack)
    {
        System.Collections.ObjectModel.ReadOnlyCollection<TimeZoneInfo> TimeZoneList = TimeZoneInfo.GetSystemTimeZones();
        this.ddlTimezones.DataSource = TimeZoneList;
        this.ddlTimezones.DataTextField = "DisplayName";
        this.ddlTimezones.DataValueField = "Id";
        this.ddlTimezones.DataBind();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:38:00.083

这个：

```
//This string is used for timezones that observe DST
//RRULE:FREQ=YEARLY;BYDAY=[Week of Month][Day];BYMONTH=[Month]
    private const string vTimeZoneTemplate1 = @"
BEGIN:VTIMEZONE
TZID:{0}
BEGIN:DAYLIGHT
DTSTART:{1}
RRULE:FREQ=YEARLY;BYDAY={9}{11};BYMONTH={7}
TZOFFSETFROM:{2}
TZOFFSETTO:{3}
TZNAME:{4}
END:DAYLIGHT
BEGIN:STANDARD
DTSTART:{6}
RRULE:FREQ=YEARLY;BYDAY={10}{12};BYMONTH={8}
TZOFFSETFROM:{3}
TZOFFSETTO:{2}
TZNAME:{5}
END:STANDARD
END:VTIMEZONE";

//This string is used for timezones that do not observe DST; however, DAYLIGHT and STANDARD are required.
//Therefore used static dates and made no change to the UTCOffset
    private const string vTimeZoneTemplate2 = @"
BEGIN:VTIMEZONE
TZID:{0}
BEGIN:DAYLIGHT
DTSTART:20070311T020000
RRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3
TZOFFSETFROM:{1}
TZOFFSETTO:{1}
TZNAME:{2}
END:DAYLIGHT
BEGIN:STANDARD
DTSTART:20071104T020000
RRULE:RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11
TZOFFSETFROM:{1}
TZOFFSETTO:{1}
TZNAME:{2}
END:STANDARD
END:VTIMEZONE"; 
```

和这个：

```
 /**
         * get the adjustment rules for the selected timezone.
         * the adjustment rule is the Daylight Savings adjustment by default.
         * using the i to note the most recent rule.
         * DateStart and .DateEnd designate the begin and end of the rule.
         * DaylightTransitionStart and End designate the begin and end date of DST.
         * DayLightDelta is the difference between base UTC and the offset by DS, add to get DS value from Base.
         **/
        if (timezone.SupportsDaylightSavingTime)
        {
            TimeZoneInfo.AdjustmentRule[] adjustments = timezone.GetAdjustmentRules();
            int i = adjustments.Length - 1;

            string body = string.Format(vTimeZoneTemplate1
                , timezone.Id
                , adjustments[i].DateStart.ToString(DateTimeFormat)
                , timezone.BaseUtcOffset
                , adjustments[i].DaylightDelta.Add(timezone.BaseUtcOffset)
                , timezone.DaylightName
                , timezone.StandardName
                , adjustments[i].DateEnd.ToString(DateTimeFormat)
                , adjustments[i].DaylightTransitionStart.Month.ToString("MM")
                , adjustments[i].DaylightTransitionEnd.Month.ToString("MM")
                , adjustments[i].DaylightTransitionStart.Week.ToString()
                , adjustments[i].DaylightTransitionEnd.Week.ToString()
                , adjustments[i].DaylightTransitionStart.IsFixedDateRule
                    ? adjustments[i].DaylightTransitionStart.Day.ToString().Substring(0, 2) 
                    : adjustments[i].DaylightTransitionStart.DayOfWeek.ToString().Substring(0, 2)
                , adjustments[i].DaylightTransitionEnd.IsFixedDateRule
                    ? adjustments[i].DaylightTransitionEnd.Day.ToString().Substring(0, 2)
                    : adjustments[i].DaylightTransitionEnd.DayOfWeek.ToString().Substring(0, 2)) +
                string.Format(vEventTemplate
                    , timezone.Id
                    , startDate
                    , endDate
                    , summary
                    , description
                    , Guid.NewGuid().ToString()
                    , sequence
                    , DateTime.Now.ToString(DateTimeFormat)
                    , vCalAttendees.ToString()
                    , organizer.FullName
                    , organizer.Email
                    , location
                    , string.IsNullOrEmpty(this.DescriptionHtml) ? string.Empty : string.Format("X-ALT-DESC;FMTTYPE=text/html:{0}", Email.WrapHTMLBody(this.DescriptionHtml, false, false))) +
                (enableReminder ? vAlarmTemplate : string.Empty);

            return string.Format(baseVCalTemplate, body);
        }
        else
        {
            string body = string.Format(vTimeZoneTemplate2
                , timezone.Id
                , timezone.BaseUtcOffset
                , timezone.DisplayName) +
                string.Format(vEventTemplate
                    , timezone.Id
                    , startDate
                    , endDate
                    , summary
                    , description
                    , Guid.NewGuid().ToString()
                    , sequence
                    , DateTime.Now.ToString(DateTimeFormat)
                    , vCalAttendees.ToString()
                    , organizer.FullName
                    , organizer.Email
                    , location
                    , string.IsNullOrEmpty(this.DescriptionHtml) ? string.Empty : string.Format("X-ALT-DESC;FMTTYPE=text/html:{0}", Email.WrapHTMLBody(this.DescriptionHtml, false, false))) +
                (enableReminder ? vAlarmTemplate : string.Empty);

            return string.Format(baseVCalTemplate, body);
        }
    } 
```

为我工作。所以，我希望它也可以帮助其他人。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:24:30.560

对于当前信息 String.Format 和 TimeZoneInfo 的字段，如[BaseUtcOffset](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.baseutcoffset.aspx)应该有助于一些属性

```
vTimeZoneTemplate =   String.Format(
     "BEGIN:VTIMEZONE\n...{0}{1}...",
      tz.BaseUtcOffset.Hours, tz.BaseUtcOffset.Minutes); 
```

但我不确定您是否可以使用 TimeZoneInfo 收集足够的信息来构建完整的 VTIMEZONE 结构。

# php - $_files 数组包含什么？如何参考？

> ID：10319525
> 
> 赞同：-1
> 
> 时间：2012-04-25T16:10:11.263
> 
> 标签：php

我是一个原始的 PHP 初学者。查看此示例上传脚本：

```
<?php
if ($_FILES["file"]["error"] > 0)
{
  echo "Error: " . $_FILES["file"]["error"] . "<br />";
  }
else
  {
  echo "Upload: " . $_FILES["file"]["name"] . "<br />";
  echo "Type: " . $_FILES["file"]["type"] . "<br />";
  echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
  echo "Stored in: " . $_FILES["file"]["tmp_name"];
  }
?> 
```

现在，如何准确地查看这个内置数组包含哪些值？我在任何地方都找不到这样的信息。谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:11:45.060

You mean `var_dump($_FILES)`? That tells you exactly what the array contains.

# c++ - 了解 C++ 中的自删除程序

> ID：10319526
> 
> 赞同：8
> 
> 时间：2012-04-25T16:10:12.843
> 
> 标签：c++, winapi

有一个自删除程序

```
#include <windows.h>
#include <stdio.h>

void main(int argc, char* argv[])
{
    STARTUPINFO si = {0};
    PROCESS_INFORMATION pi = {0};
    si.cb = sizeof(si);

    if (argc == 1)
    {
        SECURITY_ATTRIBUTES sa;
        sa.nLength = sizeof(sa);
        sa.lpSecurityDescriptor = NULL;
        sa.bInheritHandle = TRUE;

        CopyFile(argv[0], "1.exe", FALSE);
        MoveFile(argv[0], "2.exe");

        CreateFile("1.exe", 0, FILE_SHARE_READ, &sa, 
            OPEN_EXISTING, FILE_FLAG_DELETE_ON_CLOSE, NULL);

        CreateProcess(NULL, "1.exe x", NULL, NULL, 
            TRUE, 0, NULL, NULL, &si, &pi);
    }
    else if (argc == 2)
    {
        while(!DeleteFile("2.exe"));

        CreateProcess(NULL, "net", NULL, NULL, TRUE, 
            DEBUG_ONLY_THIS_PROCESS, NULL, NULL, &si, &pi);
    }
} 
```

如果我删除它：`CreateProcess(NULL, "net", NULL, NULL, TRUE, DEBUG_ONLY_THIS_PROCESS, NULL, NULL, &si, &pi);` 它不能工作。
谁能向我解释它是如何工作的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T16:37:43.807

这是一个解释（据我了解）

```
void main(int argc, char* argv[])
{
    STARTUPINFO si = {0};
    PROCESS_INFORMATION pi = {0};
    si.cb = sizeof(si);

    if (argc == 1)
    {
        SECURITY_ATTRIBUTES sa;
        sa.nLength = sizeof(sa);
        sa.lpSecurityDescriptor = NULL;
        sa.bInheritHandle = TRUE;

        // Make a copy of ourselves which we'll use to delete the version we were run from
        CopyFile(argv[0], "1.exe", FALSE);

        // Rename the running copy of ourself to another name
        MoveFile(argv[0], "2.exe");

        // Make sure we delete the copy of ourselves that's going to delete us when we die
        CreateFile("1.exe", 0, FILE_SHARE_READ, &sa, OPEN_EXISTING, FILE_FLAG_DELETE_ON_CLOSE, NULL);

        // Invoke the process that will delete us
        // allowing it to inherit the handle we just created above.
        CreateProcess(NULL, "1.exe x", NULL, NULL, TRUE, 0, NULL, NULL, &si, &pi);
    }
    else if (argc == 2)
    {
        // Wait for the original program to die (deleting us and closing a handle), then delete it
        while(!DeleteFile("2.exe"));

        // Launch a child process which will inherit our file handles
        // -- This keeps the file handle with FILE_FLAG_DELETE_ON_CLOSE (which we inherited) alive beyond our lifetime
        // this allowing us to be deleted after we've died and our own handle is closed.
        CreateProcess(NULL, "notepad", NULL, NULL, TRUE, DEBUG_ONLY_THIS_PROCESS, NULL, NULL, &si, &pi);
    }
} 
```

# php - PHP 显式变量在闭包中使用时的优势

> ID：10319529
> 
> 赞同：1
> 
> 时间：2012-04-25T16:10:35.727
> 
> 标签：php, javascript, design-patterns, closures, anonymous-function

在 PHP 中，如果要访问外部范围内的变量，则需要显式声明它，例如

```
$foo = 'bar';
func (function() use ($foo) {

    echo $foo;

}); 
```

但在 JavaScript 中，它们是隐式的，例如

```
foo = 'bar';
func (function() {
    console.log(foo);
}); 
```

这两种闭包的优缺点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:28:35.520

> 在 PHP 中，如果要访问外部范围内的变量，则需要显式声明它 [...]`use ($foo)`

从技术上讲，您的函数不在`$foo`外部范围内访问。为此，您需要：

```
$foo = 'bar';
$func = function() {
    global $foo;
    echo $foo;
}; 
```

这不是关闭。**该函数没有关闭任何变量。**如果`$foo`更改了 的值，则下一次调用`func`将反映：

```
$func(); // bar
$foo = 'baz';
$func(); // baz 
```

`$foo`但是，如果我们关闭`func`：

```
$foo = 'bar';
$func = function() use ($foo) {
    echo $foo;
};

$func(); // bar
$foo = 'baz';
$func(); // bar 
```

`func`'s`$foo`将保留它的价值，因为它已被封闭到函数中。

要在 JavaScript 中做同样的事情，您只需在函数中创建一个函数，然后将创建一个闭包（让内部函数访问封闭函数的范围）：

```
function getFunc(foo) {
    return function () {
        console.log(foo);
    };
}

foo = "bar";
func = getFunc(foo);
func(); // bar
foo = "baz";
func(); // bar 
```

> 这两种闭包的优缺点是什么？

使用“堆”类型范围，而不是堆栈，以便变量环境保持附加到函数允许一流函数更加灵活，因为它们可以传递和调用，而无需担心创建（或传入）一组特定的变量，以使函数可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:16:41.650

PHP 这样做是因为它不知道您是否打算使用外部变量，因为未设置的变量就像一个空字符串。因此 PHP 需要这种类型的闭包，而 Javascript 则不需要。

# tsql - 动态列表上的 T-SQL GROUP BY

> ID：10319530
> 
> 赞同：0
> 
> 时间：2012-04-25T16:10:40.693
> 
> 标签：tsql

我有一个带有 XML 类型列的表。此列包含记录之间可能不同的属性的动态列表。

我正在尝试对这些属性进行 GROUP BY COUNT，而不必为每个属性分别浏览表格。

例如，一条记录可能有属性 A、B 和 C，而另一条记录可能有 B、C、D，然后，当我执行 GROUP BY COUNT 时，我会得到 A = 1、B = 2、C = 2 和 D = 1 .

有没有直接的方法可以做到这一点？

**编辑**回复安德鲁的[回答](https://stackoverflow.com/questions/10319530/t-sql-group-by-over-a-dynamic-list/10319968#10319968)：

因为我对这个结构的了解充其量是肤浅的，所以我不得不摆弄它来让它做我想做的事。在我的实际代码中，我需要按 TimeRange 进行分组，并且只根据它们的名称选择一些属性。我在下面粘贴实际查询：

```
WITH attributes AS (
  SELECT 
  Timestamp,
  N.a.value('@name[1]', 'nvarchar(max)') AS AttributeName,
  N.a.value('(.)[1]', 'nvarchar(max)') AS AttributeValue  
  FROM MyTable
  CROSS APPLY AttributesXml.nodes('/Attributes/Attribute') AS N(a)
)
SELECT Datepart(dy, Timestamp), AttributeValue, COUNT(AttributeValue)
FROM attributes
WHERE AttributeName IN ('AttributeA', 'AttributeB')
GROUP BY Datepart(dy, Timestamp), AttributeValue 
```

附带说明：有没有办法进一步减少这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:35:18.477

```
WITH attributes AS (
  SELECT a.value('(.)[1]', 'nvarchar(max)') AS attribute
  FROM YourTable
  CROSS APPLY YourXMLColumn.nodes('//path/to/attributes') AS N(a)
)
SELECT attribute, COUNT(attribute)
FROM attributes
GROUP BY attribute 
```

CROSS APPLY 就像能够将 xml 作为表加入。需要 WITH 是因为您不能在 group 子句中包含 xml 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:27:07.580

这是一种将属性数据转换为您可以轻松使用它并减少您需要通过主表的次数的方法。

```
--create test data
declare @tmp table (
    field1 varchar(20),
    field2 varchar(20),
    field3 varchar(20))

insert into @tmp (field1, field2, field3)
values ('A', 'B', 'C'),
    ('B', 'C', 'D')

--convert the individual fields from seperate columns to one column
declare @table table(
    field varchar(20))

insert into @table (field)
select field1 from @tmp
union all
select field2 from @tmp
union all
select field3 from @tmp

--run the group by and get the count
select field, count(*)
from @table
group by field 
```

# c# - asp.net c#中是否有等效的echo

> ID：10319531
> 
> 赞同：4
> 
> 时间：2012-04-25T16:10:41.020
> 
> 标签：c#, asp.net

我有一个已转换为 asp.net 代码的 php 代码。PHP 代码只是回显客户端读取和解释的响应，但是在 asp.net 中，生成的输出被强制为 html 格式——这正是因为我使用 asp.net 标签来打印输出。

有没有办法可以实现与 php 中的 echo 相同的功能，或者是否有一个非常轻量级的代码可以帮助我正确解析 html 文本？

**编辑：**

我想做的是

> //获取发布数据
> 
> 回声“一些东西”

我当前的测试 aspx 文件*是*：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="grabber.aspx.cs" Inherits="qProcessor.grabber" %> 
```

后面的代码只有一种方法：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        //this.Response.Write("Welcome!");
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-25T16:12:52.433

一对一的等价物是[`Response.Write`](http://msdn.microsoft.com/en-us/library/1463ysyw.aspx)：

```
Response.Write("some text"); 
```

也就是说，ASP .NET 和 PHP 是非常不同的框架。使用 ASP .NET（包括 MVC 框架）很少需要以这种方式直接写入响应流。

一种这样的情况是，如果您想返回一个非常轻量级的响应。你可以这样做：

```
Response.ContentType = "text/xml";
Response.Write("<root someAttribute = 'value!' />"); 
```

除了直接使用之外的*任何*方法`Response`都可以（并且可能会）改变输出。简而言之 - 如果您只想将原始数据转储`HttpResponse`到`Response.Write()`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-25T16:13:09.670

您可以使用`Response.Write("");`

或在您的 .aspx 页面中使用`<%="string"%>`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T16:12:37.150

你可以写任何你想给客户的文本：

```
Response.Write(yourString); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T16:13:00.410

您可以`Response.Write()`为此使用：

```
Response.Write("your text here"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T16:36:15.797

正如[Yuck 所提到的，](https://stackoverflow.com/a/10319576/1159478)大多数时候你真的不需要`Response.Write`在 ASP 中使用（这是 echo 的直接端口）。鉴于您的示例，您可能想要执行以下操作：

```
protected void Page_Load(object sender, EventArgs e)
{

    this.Controls.Add(new LiteralControl(Server.HTMLEncode("<h1>Welcome!</h1>")));
    //will actually print <h1>Welcome!</h1>, rather than Welcome! that's bolded/centered/etc.
} 
```

或者您甚至可以将文字控件、标签等添加到标记中，然后只需`Text`在后面的代码中设置属性。这是在 ASP 环境中解决此问题的标准方法。

# android - 我被困在我的 Android 程序上

> ID：10319537
> 
> 赞同：1
> 
> 时间：2012-04-25T16:10:59.853
> 
> 标签：android, android-layout, android-intent

我正在做一个海上预报项目。知道我已经实现了 ListView 的位置，onListItemClick 和 AsyncTask 来获取数据。

所以现在当我按下某个地方时，我在数组 windSpeed、windDir 中有风速或风向等信息......

这是我卡住的地方。现在我有了数据，我希望地点列表消失并按天显示一个包含信息的新窗口。

我想我必须实现一个新类来制作表格视图并按意图切换到它。但是..如何将主要活动中的数组传递给第二个活动？因为使用 putExtra 我只能传递一个值而不是数组，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:19:31.387

你绝对可以传一个数组，看看：http: [//developer.android.com/reference/android/content/Intent.html](http://developer.android.com/reference/android/content/Intent.html)

# url-rewriting - 在 IIS7 中使用 URL Rewrite 2.0 并清理 POST

> ID：10319538
> 
> 赞同：0
> 
> 时间：2012-04-25T16:11:00.670
> 
> 标签：url-rewriting, url-rewrite-module

我在使用 IIS 7 在 URL Rewrite 2.0 中设置规则时遇到了一些问题。我正在开发一个结合了更现代的 .NET 4.0 内容和经典 .ASP 内容的网站。我当前的任务是尝试从用户输入中去除一些特定字符，以帮助防止 XSS 攻击。

我得到了基本语法：

```
<rule name="Rule Name" stopProcessing="true">
    <match url="myPage.asp" />
    <conditions>
        <add input="" pattern="" />
    </conditions>
    <action type="" />
</rule> 
```

我知道我需要三个步骤，1) 确保我们正在查看的是帖子 2) 使用正则表达式识别许多坏字符中的任何一个 3) 继续发布帖子，去掉这些字符。

我认为第一个可以通过以下方式解决：

```
<add input="{REQUEST_METHOD}" matchType="Pattern" pattern="POST" ignoreCase="true" /> 
```

令我沮丧的是第二个和第三个问题。
第二个也是一个输入，但我一直在努力寻找最好的 {} 变量来放入输入。现在我有这个：

```
<add input="{REQUEST_URI}" pattern="[\\\|&lt;>]" /> 
```

但我知道 {REQUEST_URI} 不是去那里的正确变量。我一直在 URL 重写站点 (http://www.iis.net/download/urlrewrite)，我找到了 IIS 6.0 服务器变量列表 (http://msdn.microsoft.com/en- us/library/ms524602(v=vs.90).aspx)，但我似乎无法找到 7.0 及更高版本中可用的变量及其含义的良好列表。这是任何人在某处添加书签并可以传递的东西吗？

第三个也是给我的问题。现在，我已经`<action type="AbortRequest" />`设置了其他一些规则，但为此，我不想停止请求，我只想删除坏字符并继续 POST。IIS 中的自定义规则设置看起来很有希望，但它似乎只是想重定向到一个 URL，而不是做任何其他事情。这甚至是可能的吗？

我还应该注意，我正在研究 IIS 托管模块作为获得我正在寻找的东西的替代方案。这听起来对任何人来说都是更好的途径吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T13:52:14.970

所以，事实证明你不能这样做，而且我误解了 URL 重写应用程序的范围。我应该关注 IIS 托管模块，并将在未来转向该模块。

# php - 看起来像空间但不是空间的符号是什么？（不是一个）

> ID：10319539
> 
> 赞同：3
> 
> 时间：2012-04-25T16:11:03.420
> 
> 标签：php, html, special-characters, symbols

我说的不是`&nbsp;`另一个符号“”，即使在文本区域中也看起来像“”，但这是另一个符号（用空格符号拆分字符串不会将“hello world”拆分为两个词）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T16:16:10.750

`&thinsp;`或以下其中之一？

[http://www.w3.org/TR/html4/sgml/entities.html](http://www.w3.org/TR/html4/sgml/entities.html)

```
<!-- General Punctuation -->
<!ENTITY ensp    CDATA "&#8194;" -- en space, U+2002 ISOpub -->
<!ENTITY emsp    CDATA "&#8195;" -- em space, U+2003 ISOpub -->
<!ENTITY thinsp  CDATA "&#8201;" -- thin space, U+2009 ISOpub --> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-04-04T13:45:32.177

不间断空格 U+00A0 160 char(160) 这就是你要找的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T16:13:18.787

在 DOS 的旧时代，char 255 是一个空白字符

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T16:24:14.553

你可以看看[Unicode 空白字符](http://en.wikipedia.org/wiki/Whitespace_character#Unicode)，因为它们有很多

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T16:36:00.003

`rawurlencode()`只需使用函数回显您的字符串包含任何特殊字符：

```
echo rawurlencode("whatever string with any \05 \02 weird symbols"); 
```

并查看以 % 符号开头的代码

# winforms - 在 Windows 窗体 VB EF 中将文件从文件夹保存到 SQL 数据库

> ID：10319541
> 
> 赞同：0
> 
> 时间：2012-04-25T16:11:04.980
> 
> 标签：winforms, entity-framework-4, vb.net-2010

我真的很挣扎，任何帮助将不胜感激。

我需要一些代码来遍历文件夹中的每个文件并将其保存到数据库中，以便以后可以将其拉出并显示。我还没有到显示部分，哈哈，仍在尝试获取数据库中的文件。

到目前为止，我给了我一个错误

```
Value of type '1-dimensional array of Byte' cannot be converted to 'String'. 
```

数据库中的所有字段都是`nvarchar(MAX)`

```
 Dim dir As New System.IO.DirectoryInfo("C:\Users\Will\Desktop\SUBARU")
    For Each f As System.IO.FileInfo In dir.GetFiles("*.*")
        Using db As New FileStoreAppDBEntities
            Dim NewFile As New StoredFile
            NewFile.FileName = f.Name
            NewFile.FileSize = f.Length
            'got trouble here
            Dim ImageData As Byte() = System.IO.File.ReadAllBytes(f.FullName)
            NewFile.FileContent = ImageData
            '
            NewFile.FileType = f.Extension
            db.StoredFiles.AddObject(NewFile)
            db.SaveChanges()
        End Using
    Next 
```

也许我做错了？

非常感谢您的帮助。

- 编辑

这似乎做到了！

```
 For Each f As System.IO.FileInfo In dir.GetFiles("*.*")
        Using db As New FileStoreAppDBEntities
            Dim NewFile As New StoredFile
            NewFile.FileName = f.Name
            NewFile.FileSize = f.Length
            Dim filename As String = f.FullName
            NewFile.FileContent = System.IO.File.ReadAllBytes(filename)
            NewFile.FileType = f.Extension.ToLower
            db.StoredFiles.AddObject(NewFile)
            db.SaveChanges()
        End Using
     Next 
```

虽然不确定性能，我认为这可能会将文件放入内存然后发送而不是流式传输？

并检索文件：

```
 Using db As New FileStoreAppDBEntities
        Dim IDofFile As Integer = 31
        Dim getFile = (From files In db.StoredFiles Where files.FileID = IDofFile Select files).SingleOrDefault
        'getFile.FileName eg. mydocument.txt
        System.IO.File.WriteAllBytes("C:\LocationToSaveTo\" & getFile.FileName, getFile.FileContent)
    End Using 
```

获得非常大的文件的错误`System.OutOfMemoryException` 虽然非常适合较小的文件......

也许将文件分块是可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T18:17:20.420

你的文件是文本文件吗？如果是这样，您不应该将它们作为二进制数据读取，而应作为文本数据读取。像这样的东西（对不起，它是 C#，但它应该很容易转换为 VB.NET）：

```
using(StreamReader textFile = new StreamReader(path))
{
    NewFile.FileContent = textFile.ReadToEnd();
} 
```

如果文件是二进制文件，那么您不想将它们作为字符串存储在数据库中，而可能存储为 varbinary。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-14T06:28:37.353

这似乎做到了！

```
 For Each f As System.IO.FileInfo In dir.GetFiles("*.*")
    Using db As New FileStoreAppDBEntities
        Dim NewFile As New StoredFile
        NewFile.FileName = f.Name
        NewFile.FileSize = f.Length
        Dim filename As String = f.FullName
        NewFile.FileContent = System.IO.File.ReadAllBytes(filename)
        NewFile.FileType = f.Extension.ToLower
        db.StoredFiles.AddObject(NewFile)
        db.SaveChanges()
    End Using
 Next 
```

虽然不确定性能，我认为这可能会将文件放入内存然后发送而不是流式传输？

并检索文件：

```
Using db As New FileStoreAppDBEntities
    Dim IDofFile As Integer = 31
    Dim getFile = (From files In db.StoredFiles Where files.FileID = IDofFile Select files).SingleOrDefault
    'getFile.FileName eg. mydocument.txt
    System.IO.File.WriteAllBytes("C:\LocationToSaveTo\" & getFile.FileName, getFile.FileContent)
End Using 
```

获得非常大的文件的错误 System.OutOfMemoryException 虽然非常适合较小的文件......

# ruby - Ruby rails - 下拉大小属性

> ID：10319543
> 
> 赞同：-1
> 
> 时间：2012-04-25T16:11:11.930
> 
> 标签：ruby, ruby-on-rails-3

我正在尝试为下拉菜单提供大小属性并选择默认值。在我看到的 html 上似乎不起作用，`length="35"`但它对实际宽度没有影响。我该怎么做呢？

```
@roles = ['admin','user']
collection_select(:user, :title, roles.all, :id, :name, :value => "user", {:length => 35})
collection_select(:user, :title, roles.all, :id, :name, :value => "user", {:width => 35}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:15:27.557

您应该使用`:style => "width:200px"`:length 来代替。

或者更好的是，为该选择框使用 css 类。

# jquery - 动态加载后获取图像宽度的问题。为什么？

> ID：10319545
> 
> 赞同：0
> 
> 时间：2012-04-25T16:11:17.863
> 
> 标签：jquery, dynamic, load, width

我正在将图像加载到 div 中，然后为新加载的图像启动轮播。一切正常，除了我无法获取脚本来获取图像的宽度并进行设置。

这是我目前拥有的...

获取图片大小函数

```
function imgSize() {
    $('img').each(function() {
        var imgWidth = $(this).width();
        var imgHeight = $(this).height();
        $(this).attr('height', imgHeight);
        $(this).attr('width', imgWidth);
    });
} 
```

加载新页面，调用图片大小函数，轮播函数

```
$('.menu a').live('click', function() {
        var id = $(this).attr('id');
        var page = id + '.html'
        $('#portfolio').load( page , function() {
            imgSize();
            $('#portfolio').carouFredSel(settings);
            $('#bodyFooter span').show();
        });
    }); 
```

您可以在此处查看示例：http: [//www.amandarecker.com/siteTest](http://www.amandarecker.com/siteTest) 当您单击“美”时，所有图像都相互叠加，或者甚至不显示。当我用 firebug 查看源代码时，宽度设置为 0。为什么？

希望有人可以帮助...谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:21:11.790

我可能是错的，但你可能试图让图像宽度太快。即图像尚未加载，因此其宽度返回 0。

尝试为您的功能添加负载。

```
function imgSize(){
    $("img").load(function(){
        var width = $(this).width();
        var height = $(this).height();
        $(this).attr("width",width).attr("height",height);
    });
} 
```

这只会在图像完全加载后尝试获取值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:14:30.800

您可能需要访问图像的 DOM，请尝试：

```
function imgSize() {
    $('img').each(function() {
        var imgWidth = $(this)[0].naturalWidth;
        var imgHeight = $(this)[0].naturalHeight;
        $(this).attr('height', imgHeight);
        $(this).attr('width', imgWidth);
    });
} 
```

我不确定您是如何加载图像的，但这是一个示例：

```
function loadImage(src, f)
{ 
  var img = new Image();

  $(img).load(function() {
    $(this).hide();
     if(f) f(img);
  }).error(function() {
    return false;
  }).attr('src', src);
}

loadImage('path/to/image.png', function(image) {
  // access image.naturalWidth and image.naturalHeight here to get the dimensions
}); 
```

因此，如果您加载一些新的 html（它可能应该首先插入到页面上），请尝试：

```
// passive (wait for load)
$(html).find('img').load(function() {
  var imgWidth = $(this).width();
  var imgHeight = $(this).height();
  //var imgWidth = $(this)[0].naturalWidth;
  //var imgHeight = $(this)[0].naturalHeight;
  $(this).attr('height', imgHeight);
  $(this).attr('width', imgWidth);
});

// aggressive (load them yourself)
$(html).find('img').each(function() {
  $this = $(this);
  loadImage($(this).attr('src'), function(image) {
    $this.attr('width', image.naturalWidth).attr('height', image.naturalHeight);
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T23:19:28.180

首先，js 的答案很棒，您也可以尝试通过为图像添加 width="xxx" height="xxx" 来更新您的 IMG 标签。Dom 不关心 img 高度并且可以围绕它展开，js不了解未加载图像的高度 - 需要在脚本之前知道大小，您可以先对其进行硬编码，然后再覆盖。

另一种方法是将图像加载到隐藏的 div 或延迟加载中，然后在执行完成后运行您的脚本。祝你好运！

# bison - 在 lex/yacc 程序中遇到奇怪的错误

> ID：10319548
> 
> 赞同：0
> 
> 时间：2012-04-25T16:11:27.233
> 
> 标签：bison, yacc, lex, flex-lexer

我是 lex/yacc 的新手，我正在使用 lex/yacc 编写 SQL 解析器。但是对于特定的 JOIN 查询（​​如下所列），我的解析器故意访问“select_statement”规则而不是“nested_join_statement”规则。

我得到了这个查询的正确输出：SELECT * FROM sample1 JOIN sample2 ON sample1.C1 = sample2.C4;
（这将进入'join_statement rule'，满足其中的simple_join规则）

但是当我尝试这个查询时：SELECT * FROM (SELECT * FROM (SELECT * FROM sample1)T8)AS temp1 JOIN (SELECT * FROM (SELECT * FROM sample2)T9)as temp2 ON temp1.C1 = temp2.​​C4;

（理想情况下，这应该转到“nested_join_statement”，但它会转到“select statement”规则中的“SELECT selection FROM LPAREN select_statement2 RPAREN VAR”规则，我收到以下错误消息：错误：语法错误，意外 AS，期待 VAR）

我将 nested_join_statement 的优先级置于 select_statement 之上，但仍然出现此错误。我不明白为什么。

lex 中的 VAR 定义为 [A-Za-z][A-Za-z0-9_#-]*

任何帮助，将不胜感激。生无可恋。

```
 manipulation_statement: NEWLINE
            | join_statement SEMICOLON
            | nested_join_statement SEMICOLON
            | select_statement SEMICOLON { flag=0;q=0;}
            | join_statement SEMICOLON NEWLINE
            | nested_join_statement SEMICOLON NEWLINE
            | select_statement SEMICOLON NEWLINE { flag=0;q=0;}
            ;
    nested_join_statement: two_nest_select_join { for(x=0;x<q;x++) strcpy(sj[x], ""); i=0;j=0;vardot=0;q=0;flag=0;nest=0;}
            ;
    join_statement: 
            simple_join { for(x=0;x<q;x++) strcpy(sj[x], ""); i=0;j=0;vardot=0;q=0;flag=0;}
            | simple_join_nest_select { for(x=0;x<q;x++) strcpy(sj[x], ""); i=0;j=0;vardot=0;q=0;flag=0;}
           ;
    simple_join: SELECT selection FROM VAR JOIN VAR ON VAR DOTS VAR EQUAL VAR DOTS VAR { printf("inside simple join\n");                                                                
                                                            if(strcmp($4,$8) == 0) join_table($4,$6,sj,q,$10,$14,"","");
                                                            else join_table($4,$6,sj,q,$14,$10,"",""); p=q;}
        ;

    simple_join_nest_select: SELECT selection FROM VAR JOIN LPAREN select_statement RPAREN AS VAR ON VAR DOTS VAR EQUAL VAR DOTS VAR {
                                                   if (strcmp($4,$12) == 0) join_table($4,"_temp_",sj,q,$14,$18,"","");
                                                    else join_table($4,"_temp_",sj,q,$18,$14,"",""); p=q;}
        ;

    two_nest_select_join: SELECT selection FROM LPAREN select_statement RPAREN AS VAR JOIN LPAREN select_statement RPAREN AS VAR ON VAR DOTS VAR EQUAL VAR DOTS VAR {
                                        join_table("temp1","temp2",sj,q,$18,$22,"",""); }
        ;

    select_statement:  SELECT selection FROM VAR WHERE where_clause { select_table($4,s,i,whr_var,whr_val); 
                                                             for(x=0;x<i;x++) strcpy(s[x],"");i=0; strcpy(whr_var,""); strcpy(whr_val,"");j=0;}
            | SELECT selection FROM VAR {   select_table($4,s,i,whr_var,whr_val); 
                                            for(x=0;x<i;x++) strcpy(s[x],"");i=0;j=0;}
            | SELECT selection FROM LPAREN select_statement2 RPAREN VAR { printf("inner tab: %s\n", inner_tab); printf("dep:%d\n", dep+1);
                                                                            for(x=0; x<i;x++) printf("%s\n", col_array[x]);
                                                                            for(y=0; y<j;y++) printf("%d\n", col_count[y]);
                                                                            strcpy(inner_tab,""); nest =1; dep=0;
                                                                            for(x=0; x<i;x++) strcpy(col_array[x], "");
                                                                            for(y=0; y<j;y++) col_count[x] =0;
                                                                            i=0;j=0;k=0;m=0;}
            ;
    select_statement2: SELECT selection2 FROM VAR { dep++; inner_tab=malloc(strlen($4)); strcpy(inner_tab,$4); }
                | select_list
            ;
    select_list: SELECT selection2 FROM LPAREN select_statement2 RPAREN VAR { dep++; }
        ;
    selection2: ASTERISK { col_array[i] = $1; i++; m++; col_count[j] = m; j++; printf("in level:%d value of k:%d\n",j,m); k=0; m=0;}
      | comma_list2 { col_count[j] = m; j++; printf("in level:%d value of k:%d\n",j,m); k=0; m=0;  }
      ;
    comma_list2: VAR { col_array[i] = $1; i++; m++;}
        | comma_list2 COMMA VAR { col_array[i] = $3; i++; m++; 
                                  k=m;}
        ;
    selection: ASTERISK { if(q != 0 || nest == 1) { for(x=0;x<j;x++) col_count[x]=0; i=0; j=0;flag=1;}
                        s[i] = $1; col_array[i] = $1; i++; col_count[j] = i; j++; 
                        if(q == 0) {sj[q] = $1; q++;} printf("in level t:%d value of k:%d\n",j,i); printf("sj2:%s\n",sj[0]);}
      | comma_list { if (flag ==1 ) {col_count[j] = i; j++; printf("in level 2:%d value of k:%d\n",j,i); k=0; m=0; printf("temp:"); 
                                    for(x=0;x<i;x++) printf("%s ",s[x]); } else {col_count[j] = i; j++;} }
      ;
    comma_list: 
        VAR { if(q != 0 || nest == 1) { for(x=0;x<j;x++) col_count[x]=0; i=0; j=0;flag=1;}
                s[i] = $1; col_array[i] = $1; i++; if(q==0) {sj[q] = $1; q++; }}
        | VAR DOTS VAR { strcpy(temp,""); strcat(temp,$1); strcat(temp,$2); strcat(temp,$3); 
            sj[q] = temp;  q++; 
            printf("temps:"); for(x=0;x<q;x++) printf("%s\n",sj[x]);}
        | comma_list COMMA vardot {if (flag == 1) { s[i] = $3; col_array[i] = $3, i++;} else {sj[q] = $3; q++; vardot++;s[i] = $3; col_array[i] = $3, i++;}
                                                                            }
        ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:40:53.853

您的语法中存在减少/减少冲突——在 selection 和 selection2 之间，以及 comma_list 和 comma_list2 之间。由于 '2' 版本首先出现在您的语法文件中，因此它总是会减少使用这些规则，这意味着在任何无法区分 select_statement 和 select_statement2 的地方，只需查看所有内容即可相关的“FROM”令牌可能会做错事。

在您的示例中，在看到 之后`SELECT * FROM (SELECT * FROM`，它必须做出此选择（因为括号中的嵌套选择可能是 two_nest_select_join 的选择，或者是简单 select_statement 的 select2），并选择 select2，因此将其解析为select_statement，导致您在获取`AS`令牌时看到的错误 - 它期望`VAR`

如果你想解决这个问题，你需要使用更多的前瞻，或者改变语法来摆脱减少/减少冲突。

要使用更多前瞻，您可以使用 bison 的`%glr-parser`选项。由于此处没有歧义，因此无需添加任何额外的消歧代码，但如果您在其他地方有歧义，则可能会因此出现运行时错误。

要摆脱减少/减少冲突，您需要摆脱重复的 selection2 规则——如果您将它们全部更改为相应的选择规则，您就摆脱了冲突，但是您现在接受了一些以前的构造会被拒绝（例如`SELECT * FROM (SELECT * FROM VAR WHERE where_clause) VAR`您可能想要禁止的。

# struts2 - 在另一个动作中通过构造函数调用 Struts 动作是一种好习惯吗？

> ID：10319551
> 
> 赞同：2
> 
> 时间：2012-04-25T16:11:44.020
> 
> 标签：struts2

我有两个 Struts2 动作。我想在另一个动作中使用一个动作的公共方法。我可以通过`new`运算符调用一个动作并调用它的公共方法吗？（为了重用一些常用功能）

```
public class OneAction extends ActionSupport{
public void doSomeThing(){
    // some code
}

public String execute(){
    // some code
}
}

 public class AnotherAction extends ActionSupport{

public String execute(){
    /* is it ok?*/
    new OneAction().doSomeThing();
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:15:24.500

（颤抖）我不会。我会将通用功能重构为一个单独的类，两者都可以调用。但该类将是 POJO，而不是 Action。

我会小心在 Actions 中嵌入功能。我认为他们坚定地在网络层阵营。您应该做的只是验证并将参数绑定到对象中，将它们交给 POJO 进行处理，并将结果打包返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T18:50:54.677

我加了@duffymo 的回答，但这里还有一些值得深思的地方。

如果该功能在动作中是通用的，则它属于基本动作（如果与 Web 相关）或实用程序类（与 Web 相关或不相关）。哪个最有意义在很大程度上取决于上下文。

沿着这些上下文线，根据您正在谈论的实际功能，它可能在其他地方更有意义——在拦截器、方面、mixin（如何做到这一点取决于实现语言）等。没有知道细节，很难说得更具体。

# javascript - 当页面加载后鼠标指针已经结束时触发 onMouseOver

> ID：10319554
> 
> 赞同：2
> 
> 时间：2012-04-25T16:11:49.973
> 
> 标签：javascript, html, image, mouseevent, rollover

我有几个非常相似的页面。他们有一些javascript翻转链接（图像被预加载，然后有一个调用图像交换函数的onMouseOver事件，最后有一个恢复原始图像的onMouseOut事件）。

当用户点击指向另一个页面的翻转链接时，该页面在完全相同的位置上具有翻转链接，新页面上的图像预计将加载到“over”状态。在 Chrome 和 Safari 中情况并非如此（IE 和 Firefox 按预期工作）。

所以......在页面加载时，有没有办法检查鼠标是否已经悬停在图像上以立即交换它？像“OnMouseAlreadyOver”之类的东西？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:29:54.443

如果您使用 jQuery，它可以正常工作！

[http://jsfiddle.net/beuae](http://jsfiddle.net/beuae)

（不仅适用于按钮，[也适用于 div](http://jsfiddle.net/beuae/1/)）

实际上，jQuery 是一个非常好的框架，它可以确保一切按您的预期进行，并且可以跨浏览器。这个例子证实了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:19:45.817

W3C[标准](http://www.w3.org/TR/html4/interact/scripts.html#h-18.2.3)说

> **onmouseover** = script [CT]
> onmouseover 事件在指针设备移动到元素上时发生。此属性可用于大多数元素。
> 
> **onmousemove** = script [CT]
> onmousemove 事件发生在指针设备在元素上方移动时发生。此属性可用于大多数元素。

`mouseover`在移动到对象的边界上时触发。`mousemove`当鼠标已经在元素上时发生。

您可能需要使用`onmousemove`（甚至两者都需要）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:14:43.227

您可能需要根据元素位置和鼠标光标位置实际进行计算。

```
//Get Mouse Position
document.onmousemove=getMouseCoordinates;
function getMouseCoordinates(event){
    ev = event || window.event;
    mouseX = ev.pageX;
    mouseY = ev.pageY;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:18:46.757

您不能不将变量传递给其他页面或使用 cookie 来跟踪哪个被悬停（如果人们确实更改了鼠标位置，这将失败）

从理论上讲，您可以检查鼠标位置和按钮位置，但是除非触发事件，否则无法获取鼠标位置，因此鼠标必须移动，如果移动 CSS :hover 应该被触发。

这是一个小问题，我怀疑大多数人会点击一个链接，等待下一页，然后期望该链接悬停并准备再次点击（为什么没有人继续点击同一个按钮，除非它做不同的事情）

从 UX 的角度来看，我想知道 webkit 是否在这里没有最好的方法，为什么要将一个页面的操作移植到另一个页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T16:19:02.540

您可以使用`document.getElementFromPoint(mouseX, mouseY)`来获取元素，但获取光标位置的唯一方法是通过事件。问题是，唯一的事件是点击和鼠标移动，这需要用户从一开始就输入，这是您要避免的。

简而言之，不，不可能用 JavaScript 来做。你只剩下使用 CSS 了。

# .net - SOAP HttpRequest and the Nagle Algorithm

> ID：10319555
> 
> 赞同：1
> 
> 时间：2012-04-25T16:11:52.517
> 
> 标签：.net, soap

SOAP requests are not interactive. Furthermore, they usually cannot be processed by a server until the entire request is received.

Therefore, should we always disable the Nagle algorithm on an HttpWebRequest used for SOAP?

```
HttpWebRequest req = ...;
req.ServicePoint.UseNagleAlgorithm = false; 
```

# css - Match overflowing box height to its parent box

> ID：10319559
> 
> 赞同：0
> 
> 时间：2012-04-25T16:12:05.857
> 
> 标签：css

I have box with nested image and div with text information. I'm doing simple CSS trick with positioning and display parameter changes on hover, so text box is only seen if hover on main box.

Here's my problem, text box has background with opacity, how can I match height of the box with background to its parent when it's show on hover.

Here's live example: [http://jsfiddle.net/Mamaduka/jDYu5/16/](http://jsfiddle.net/Mamaduka/jDYu5/16/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:26:26.833

如果我理解正确，您需要做的就是给出`texts`一个高度`100%`

```
.box:hover .texts {
    display: block;
    height:100%;
} 
```

当我编辑你的小提琴时为我工作。

# sql - 带字符串的 SQL 透视图

> ID：10319562
> 
> 赞同：16
> 
> 时间：2012-04-25T16:12:19.110
> 
> 标签：sql, pivot

我在 SQL Server 中有两个表：客户和地址

**客户表**：

```
CustomerID  FirstName  LastName
----------- ---------- ----------
1           Andrew     Jackson         
2           George     Washington 
```

**地址表**：

```
AddressID   CustomerID  AddressType City
----------- ----------- ----------- ----------
1           1           Home        Waxhaw     
2           1           Office      Nashville    
3           2           Home        Philadelphia 
```

这是我需要的输出：

```
CustomerID  Firstname  HomeCity      OfficeCity
----------- ---------- ----------    ----------
1           Andrew     Waxhaw        Nashville
2           George     Philadelphia  Null 
```

这是我的查询，但没有得到正确的结果：

```
SELECT CustomerID, Firstname, HOme as HomeCity, Office as OfficeCity FROM 
   (SELECT C.CustomerID, C.FirstName, A.AddressID, A.AddressType, A.City 
    FROM Customer C, Address A 
    WHERE C.CustomerID = A.CustomerID)as P
PIVOT (MAX(city) FOR AddressType in ([Home],[Office])) as  PVT 
```

这是我得到的结果：

```
CustomerID  Firstname  HomeCity      OfficeCity
----------- ---------- ----------    ----------
1           Andrew     Waxhaw        NULL
1           Andrew     NULL          Nashville
2           George     Philadelphia  Null 
```

如您所见，客户 1 在最终结果中出现了两次。是否有可能每个客户只能获得一排？

我查了这个例子，但没有帮助：http://stackoverflow.com/questions/6267660/sql-query-to-convert-rows-into-columns

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-25T16:22:31.797

它给出了这一行，因为您`AddressID`在选择列表中有子查询“P”。因此，即使您在顶级选择中没有 AddressID，该`PIVOT`功能仍会按它进行分组。您需要将其更改为：

```
SELECT  CustomerID, Firstname, Home as HomeCity, Office as OfficeCity 
FROM    (   SELECT C.CustomerID, C.FirstName, A.AddressType, A.City 
            FROM #Customer C, #Address A 
            WHERE C.CustomerID = A.CustomerID
        ) AS P
        PIVOT 
        (   MAX(city) 
            FOR AddressType in ([Home],[Office])
        ) AS  PVT 
```

尽管我倾向于`INNER JOIN`在客户和地址之间使用显式而不是隐式连接。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-25T16:19:01.510

我会这样写：

```
SELECT C.CustomerID, C.Firstname,
    Home.City as HomeCity,
    Office.City as OfficeCity
FROM Customer C
    LEFT JOIN Address Home
        on Home.CustomerID = C.CustomerID and Home.AddressType = 'Home'
    LEFT JOIN Address Office
        on Office.CustomerID = C.CustomerID and Office.AddressType = 'Office' 
```

# asp.net - how to display current user's name in asp.net

> ID：10319564
> 
> 赞同：-2
> 
> 时间：2012-04-25T16:12:23.163
> 
> 标签：asp.net, login

Please tell me how to get current user and how to display loggedin users name in Asp.net using C#. Please tell me ASAP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:13:38.577

```
var username = HttpContext.Current.User.Identity.Name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:15:52.540

您可以将[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview.aspx#Y0](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview.aspx#Y0) Loginview 控件放在页面上

```
<asp:LoginView ID="LoginView1" Runat="server">
  <LoggedInTemplate>
   <asp:LoginName ID="LoginName1" Runat="server" 
                  FormatString ="Welcome, {0}" />
   <br />
    <asp:HyperLink ID="HyperLink1" Runat="server" 
      NavigateUrl="~/MemberPages/ChangePassword.aspx">
      Change Password
    </asp:HyperLink>
  </LoggedInTemplate>
  <AnonymousTemplate>
    <asp:Login id="Login1" runat="server" 
        CreateUserText="Create a new user..."
        CreateUserUrl="~/Register.aspx" 
        PasswordRecoveryUrl="~/Recovery.aspx" 
        UserNameLabelText="E-mail address:" />
  </AnonymousTemplate>
</asp:LoginView> 
```

# android - 对导入的 makefile 的更改不会触发 android-ndk 中的重建

> ID：10319565
> 
> 赞同：4
> 
> 时间：2012-04-25T16:12:27.530
> 
> 标签：android, android-ndk, makefile, android-ndk-r7

我有一个想要编译的 Android JNI 项目`ndk-build`。该项目包含多个第三方子项目。

```
+- 杰尼
   +- 安卓.mk
   +- 我的项目.mk
   +- 其他项目.mk
   +- 我的项目
      +- a.cpp
      +- b.cpp
   +- 其他项目（第三方）
      +- c.cpp
      +- d.cpp

```

现在的想法是在 中包含/导入所有子项目的 makefile `Android.mk`，如下所示：

```
LOCAL_PATH := $(call my-dir)

include $(LOCAL_PATH)/my-proj.mk
include $(LOCAL_PATH)/other-proj.mk 
```

`other-proj`构建为*静态*库。`my-proj.mk`依赖`other-proj`并构建为*共享*库。

构建这个项目有效。**但是，修改`my-proj.mk`或修改`other-proj.mk`不会触发相应项目的重建。**有没有办法做到这一点？

我虽然可以将makefile列为依赖项，`Android.mk`但我想不出办法。（在下面列出它们`LOCAL_SRC_FILES`是行不通的。）

我还读到了`$(call import-module,foo/bar)`which 似乎完全符合我的要求。但是，在这种情况下，我必须将 makefile 放在与项目目录*相邻*的目录中（例如`jni/makefiles/other-proj/Android.mk`），但我不知道如何指定`LOCAL_SRC_FILES`. 他们似乎不喜欢用绝对路径或`..`路径内部来指定。（我不能将 makefile 直接放在子项目目录中，因为它们是第三方项目。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T11:08:20.227

我想出了一种方法来做到这一点，虽然不是使用简单的包含，而是使用`$(call import-module,foo/bar)`.

首先进行更改，您需要确定其中一个子项目作为主项目。让我们`my-proj`为此吧。然后目录结构改变如下：

```
+- jni
   +- Android.mk
   +- my-proj
      +- a.cpp
      +- b.cpp
   +- other-proj  (third-party)
      +- Android.mk
      +- c.cpp
      +- d.cpp 
```

基本上我重命名`my-proj.mk`为`/Android.mk`和。`other-proj.mk``other-proj/Android.mk`

然后主要`Android.mk`更改为这样的：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)
...
LOCAL_STATIC_LIBRARIES := other-proj
include $(BUILD_SHARED_LIBRARY)

$(call import-add-path,$(LOCAL_PATH))
$(call import-module,other-proj) 
```

包含在`other-proj`最后一行中。

请注意，最后一行之前的行设置模块路径。*通过在*makefile中设置模块路径

```
NDK_MODULE_PATH := $(LOCAL_PATH) 
```

不起作用。**_** （如果`NDK_MODULE_PATH`要使用，它需要定义为makefile之外的环境变量）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-27T21:40:40.393

这可能不是最优雅的方式，但有时我会通过添加额外的空格或换行来修改其中一个来源。这似乎唤醒了编译器。

# windows-phone-7 - 如何在按钮上打开 TimeSpanPicker（Coding4Fun 工具包）

> ID：10319568
> 
> 赞同：1
> 
> 时间：2012-04-25T16:12:29.137
> 
> 标签：windows-phone-7

我在 XAML 中有按钮和 TimeSpanPicker。

```
<Image x:Name="sleepButton" Source="img/Sleep.png"
       Grid.Row="2" Grid.Column="2" Grid.ColumnSpan="2"
       Stretch="None" Tap="sleepButton_Tap"/>

<controls:TimeSpanPicker x:Name="timespanPicker" Step="0:5" Value="0:0"
                         PickerPageUri="timePickerPage"
                         Grid.Column="1" Grid.Row="2"
                         Visibility="Collapsed" IsEnabled="False" /> 
```

这是我的代码。

```
private void sleepButton_Tap(object sender, GestureEventArgs e)
{
    TimeSpanPicker timespanPicker = new TimeSpanPicker();
    timespanPicker.PickerPageUri = new Uri("/MainPage.xaml", UriKind.Relative);
    timespanPicker.OpenPicker();
} 
```

然后我点击按钮什么也不做。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:27:52.557

您需要将 PickerPageUri 更改为 MainPage.xaml 以外的其他内容。目的是导航到另一个页面，以便您可以使用该另一个页面来设置时间。以下文章应该可以帮助您：-

[http://windowsphonegeek.com/articles/WP7-TimeSpanPicker-in-depth](http://windowsphonegeek.com/articles/WP7-TimeSpanPicker-in-depth)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T01:29:07.450

PickerPageUri 是如果您有一个自定义选择器控件，例如一个按钮来设置日期/时间，而不是显示 TimeSpanPicker。您还在这里创建了 TimeSpanPicker 的新实例，基本上覆盖了您的 xaml：

```
private void sleepButton_Tap(object sender, GestureEventArgs e)
{
    TimeSpanPicker timespanPicker = new TimeSpanPicker();
    ... 
```

你应该可以打电话`timespanPicker.OpenPicker();`。不确定您是否需要启用它，但是是的，可见性已折叠。

# android - Could a package have more than one launch intent?

> ID：10319572
> 
> 赞同：2
> 
> 时间：2012-04-25T16:12:49.780
> 
> 标签：android, android-intent

I need to know the list of installed applications that can be launched by the user (for example: Browser, Email, Maps, etc.). I read [this question](https://stackoverflow.com/questions/2695746/how-to-get-a-list-of-installed-android-applications-and-pick-one-to-run) about the `getInstalledApplications` method, so I wrote the following code:

```
final PackageManager pm = getPackageManager();
List<ApplicationInfo> apps = pm.getInstalledApplications(PackageManager.GET_META_DATA);
for (ApplicationInfo app : apps) {
    Intent launchIntent = pm.getLaunchIntentForPackage(app.packageName);
if (launchIntent != null) {
        Log.d(LOG_TAG, "getApplicationLabel: " + pm.getApplicationLabel(app));
        Log.d(LOG_TAG, "loadLabel: " + app.loadLabel(pm));
        Log.d(LOG_TAG, "packageName: " + app.packageName);
        Log.d(LOG_TAG, "name: " + app.name);
    }
} 
```

In this way I get the list of applications that can be launched. Each of these applications is characterized by a package name, so if I want to start one of these, just get the launch intent for the package by specifying the package name. This means that each package has at most an activity that can be launched, so each of the applications (which are returned by the `getInstalledApplications` method) should have a unique package name. Is that correct?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:34:24.923

Android 通常不会让您使用相同的包名称安装多个应用程序。根据我的经验，第二个应用程序的 .apk 文件不会安装，更不用说运行了。所以，不，每个包名你不会得到一个以上的应用程序。

但是，可以通过同一应用程序的意图启动多个活动。您的代码不会得到它们，因为 getLaunchIntentForPackage() 只返回一个意图，但每个活动都可以有自己的意图过滤器。[http://developer.android.com/guide/topics/intents/intents-filters.html](http://developer.android.com/guide/topics/intents/intents-filters.html)上的“记事本示例”具有三个不同的活动，每个活动都可以从外部启动。

# 3d - modify java3d SceneGraph dynamically

> ID：10319573
> 
> 赞同：1
> 
> 时间：2012-04-25T16:12:49.760
> 
> 标签：3d, java-3d, scenegraph

I recently started working on java3D. Currently I am working on a java3D racing game. I just wanted to know is it possible to add objects (i.e. scenegraph nodes nodes) e.g. spehere, box, etc. to a scene graph which has been compiled.

If i want to add an object onto a graph on a keyPress event, or on a timing event how can it be done?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T09:49:05.527

是的，您可以从 Universe 场景图中动态添加和删除 BranchGroup。

通常，每个 BranchGroup 都在内部编译为单个网格，以加快渲染速度。

因此，您可以使您的球体、汽车网格等成为 BranchGroup 的子项，然后将该 BranchGroup 添加为主 BranchGroup 的子项。

您可能还需要设置 MyBranchGroup.setCapability(Group.ALLOW_CHILDREN_EXTEND); 允许添加孩子。

# facebook - 是否可以在没有对话框的情况下发送 Facebook 请求？

> ID：10319574
> 
> 赞同：1
> 
> 时间：2012-04-25T16:12:51.470
> 
> 标签：facebook, facebook-graph-api, dialog

我需要使用我的自定义对话框（该用户有其他选项）向用户发送请求。在此之后，我有“users_ids”来发送请求。

[是否可以使用Graph API](http://en.wikipedia.org/wiki/Facebook_Platform#Graph_API)做到这一点？

*[（我在Requests Dialog](http://developers.facebook.com/docs/reference/dialogs/requests/)*没有找到任何方法。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T17:05:14.560

[社交渠道](http://developers.facebook.com/docs/channels/)文档（请求部分）中提到了两种类型的请求：用户生成的和应用程序生成的。

您可以从服务器端和客户端向用户发送 App 生成的请求，而无需使用对话框。您如何只能为授权您的应用程序的用户发送这些请求，如[用户对象中的连接中所述](http://developers.facebook.com/docs/reference/api/user/#apprequests)。

顾名思义，用户生成的请求只能使用对话框发送。

此问题的最佳来源是[Requests 文档](http://developers.facebook.com/docs/requests/)。

# database - SQL Server 2008 高 CPU 使用率

> ID：10319575
> 
> 赞同：11
> 
> 时间：2012-04-25T16:12:52.343
> 
> 标签：database, performance, sql-server-2008

我们有一个带有 SQL Server 2008 的 Windows 2008 R2 Server。该服务器有多个具有 SQL 服务器数据库的 .net 站点。

我们目前的平均 CPU 使用率为 95%，其中大部分使用由 SQL Server 负责。

我想确定哪个站点对此负责，以便我们可以对其进行优化或将其移至另一台服务器。但我没有找到任何直接的方式来看待这个。

我一直在寻找是否可以找到：

*   获得最多 CPU 密集型查询的数据库
*   负责 CPU 密集型查询的进程

使事情复杂化的一件事是我们有多个站点和使用同一个数据库的“crons”。因此，一旦我确定了数据库，我还需要获得一些关于哪个站点/cron 负责它的提示。

我真的很感谢任何帮助，因为这个问题使我们的网站真的很慢......

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-25T16:47:07.190

您可以使用 DMV 识别代价高昂的查询（以及与之关联的数据库），例如[来自这篇 TechNet 文章](http://msdn.microsoft.com/en-us/magazine/cc135978.aspx)：

```
SELECT TOP 50
 [Average CPU used] = total_worker_time / qs.execution_count,
 [Total CPU used] = total_worker_time,
 [Execution count] = qs.execution_count,
 [Individual Query] = SUBSTRING (qt.text,qs.statement_start_offset/2, 
         (CASE WHEN qs.statement_end_offset = -1 
            THEN LEN(CONVERT(NVARCHAR(MAX), qt.text)) * 2 
          ELSE qs.statement_end_offset END - 
qs.statement_start_offset)/2)
,[Parent Query] = qt.text
,DatabaseName = DB_NAME(qt.dbid)
FROM sys.dm_exec_query_stats qs
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) as qt
ORDER BY [Average CPU used] DESC; 
```

这些将告诉您有关重击查询的信息，但不幸的是，它不会查明可能具有大量小型查询的数据库，这些查询单独使用少量 CPU，但总体使用大量 CPU。[您可以通过 Glenn Allan Berry 的 DMV 查询](http://sqlserverperformance.wordpress.com/tag/dmv-queries/)中的查询来做到这一点：

```
WITH DB_CPU_Stats
AS
(SELECT DatabaseID, DB_Name(DatabaseID) AS [DatabaseName], 
  SUM(total_worker_time) AS [CPU_Time_Ms]
 FROM sys.dm_exec_query_stats AS qs
 CROSS APPLY (SELECT CONVERT(int, value) AS [DatabaseID] 
              FROM sys.dm_exec_plan_attributes(qs.plan_handle)
              WHERE attribute = N'dbid') AS F_DB
 GROUP BY DatabaseID)
SELECT ROW_NUMBER() OVER(ORDER BY [CPU_Time_Ms] DESC) AS [row_num],
       DatabaseName, [CPU_Time_Ms], 
       CAST([CPU_Time_Ms] * 1.0 / SUM([CPU_Time_Ms]) 
       OVER() * 100.0 AS DECIMAL(5, 2)) AS [CPUPercent]
FROM DB_CPU_Stats
WHERE DatabaseID > 4 -- system databases
AND DatabaseID <> 32767 -- ResourceDB
ORDER BY row_num OPTION (RECOMPILE); 
```

这些查询都不能识别运行它们的应用程序，并且使用的 DMV 不存储该信息（您必须在行为中捕获查询并在 sys.dm_exec_sessions 中记下应用程序名称，或查看跟踪）。

当然，您可以使用市场上的各种 3rd 方性能工具来自动化这项工作（免责声明：我为其中之一工作，SQL Sentry，它生产[Performance Advisor](http://www.sqlsentry.net/performance-advisor/sql-server-performance.asp)，它可以完成上述所有工作，包括跟踪高成本查询和维护有关它们在哪个数据库中运行以及哪个应用程序调用它们的信息）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T17:27:56.793

或者，您可以使用活动监视器查看服务器的运行状况。从那里你将能够挑选出长时间运行的查询，任何锁，如行锁、表锁等

[http://www.mssqltips.com/sqlservertip/1917/performance-analysis-using-sql-server-2008-activity-monitor-tool/](http://www.mssqltips.com/sqlservertip/1917/performance-analysis-using-sql-server-2008-activity-monitor-tool/)

# javascript - 以编程方式激活自定义 TinyMCE 按钮

> ID：10319578
> 
> 赞同：1
> 
> 时间：2012-04-25T16:12:59.530
> 
> 标签：javascript, tinymce

我的 TinyMCE 工具栏上有很多自定义按钮，当您单击它们时，其中大部分会打开一个对话框，其中包含一些进一步的选项。这一切都很好。这是我的 tinyMCE_setup() 函数中的一个示例：

```
ed.addButton('link2', {
    title: '{!link!}',
    image: '../style/common/images/link_20x20.png',
    onclick: function() {
        replyBoxDialog('link', ed);
    }
}); 
```

但是，我希望能够以编程方式调用这些，并且使用 jQuery 在按钮上伪造 .click() 不会削减它。我试过直接调用函数

```
replyBoxDialog('link',tinyMCE); 
```

但是无论我如何尝试作为第二个参数，我都无法获得正确的对象（因此当需要将某些内容插入编辑器时它会失败，因为它不知道编辑器是什么）。

我也尝试过各种 execCommand() 调用，但我不知道该放什么。

有什么线索吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T07:32:23.723

您所要做的就是使用真实的编辑器对象作为参数

```
var editor_instance = tinymce.activeEditor; // in case you just use one editor
var editor_instance = tinymce.get('my_special_editor_id'); // in case you have more than one editor

replyBoxDialog('link', editor_instance); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:24:34.173

我设法通过在脚本顶部创建一个变量“globalEd”并添加`globalEd = ed;`到 来使其工作`tinyMCE_setup()`，然后我可以调用`replyBoxDialog('dragndrop', globalEd);`. 不过，这似乎是一种适当的做事方式，所以我欢迎任何进一步的建议。

# sql - Ambiguous column name not detected or warned for some columns

> ID：10319588
> 
> 赞同：0
> 
> 时间：2012-04-25T16:13:25.480
> 
> 标签：sql, oracle, oracle10g

> **Possible Duplicate:**
> [Why Oracle 10g doesn't complain about column ambiguity?](https://stackoverflow.com/questions/6293193/why-oracle-10g-doesnt-complain-about-column-ambiguity)

Relatively simple query:

```
SELECT X.a
       ,X.b
       ,X.c
       ,created_date -- exists in X, Y and Z, as you might expect
FROM X
LEFT JOIN Y
    ON Y.b = X.b
LEFT JOIN Z
    ON Z.c = X.c 
```

We get no error regarding ambiguous join, but notice unexpected `NULL`s in the data for `created_date` - after investigating, it turns out correctly when prefix `created_date` with `X`.

Other columns, when prefixes are removed, do cause an error when creating the package.

Advised colleague to ensure table alias prefixes are always used, but why would it not warn about ambiguity when creating the package for come columns and not for others?

# nhibernate - 父类的 NHibernate 约束关联被丢弃在子类上

> ID：10319589
> 
> 赞同：1
> 
> 时间：2012-04-25T16:13:25.657
> 
> 标签：nhibernate, inheritance, nhibernate-mapping

我认为主要问题是子类删除了与基本映射集合相关的所有约束。

使用每个具体类策略的表，我发现在另一个（可能相关的）问题中，父集合也**没有**与子类关联，也没有创建 Basetypes 和 ChildTypes 之间的关联。

我有一个类似于这样的架构：

```
public class Parent{

   public virtual Int64 Id{get; set;}
   public virtual IList<Foo> foos{get; set;}
   public virtual IList<ParentType> _pts{get; set;}

}

public class child: Parent{
   public virtual int chilInt{get; set;}
}

public class BaseType{
   public virtual Int64 Id{get; set;}
   public virtual Parent ParentReference{get; set;}
}

public class ChildType: BaseType{
    public virtual string childBacon{get; set;}
} 
```

映射文件

```
<class name="Parent" abstract="true">

<id name="Id" type="Int64" column="Id"  unsaved-value="0">
  <generator class="native"/>
</id>

<set name="foos" inverse="false"  >
  <key column="Id"/>
  <one-to-many class="Foo" />
</set>

<set name="pts" inverse="false"  >
  <key column="Id"/>
  <one-to-many class="ParentType" />
</set>

</class>

<union-subclass name="Child" table="Child" extends="Parent">
     <property name="childInt" type="int" />
</union-subclass>

<class name="ParentType" abstract="true">

  <id name="Id" type="Int64" column="Id"  unsaved-value="0">
   <generator class="native"/>
  </id>

 <many-to-one name="ParentReference" class="Parent"/>

</class>

<union-subclass name="ChildType" table="ChildType" extends="ParentType">
     <property name="childBacon" type="string" />
</union-subclass> 
```

子表与 foo 表没有任何关系的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T22:12:13.873

如果您使用 <union-subclass> 映射，很明显 foo 条目与您的子表没有直接关系，因为子表只包含在子类中声明的附加内容。

当使用联合子类映射实例化子实例时，您会在父表和子表中都获得一行。如果您的子实例包含 foo 集中的条目，您会在 foo 表中获得一些与父表相关的行。

使用每个具体类映射的表对于指向父类的关联没有意义（因为 foo 类不是代码示例的一部分似乎是这样做的），因为这样 parent 的不同派生类都继承了 foo 集但 foo 表不能所有这些表都有外键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:37:23.540

好吧，ORM 和继承有三种常用方法（每个类层次结构表、每个子类表、每个具体类表）。`<union-subclass>`，您使用的一个，用于每个具体类的表中，它应该嵌入到 parent 中`<class>`。[在此处](http://knol.google.com/k/nhibernate-chapter-8-inheritance-mapping#)阅读(8.1.5)。

也许它不会解决你所有的问题，但至少它应该有助于建立继承映射。

# c# - WIF 和子域

> ID：10319597
> 
> 赞同：3
> 
> 时间：2012-04-25T16:13:47.280
> 
> 标签：c#, .net, subdomain, single-sign-on, wif

我们有一个使用本地身份验证的现有 ASP.NET 应用程序 (WebForms)。我们的任务是实施单点登录解决方案，并选择使用 WIF。

我们有一个正在运行的应用程序实例，我们通过使用子域（例如 client1.ourapp.com、client2.ourapp.com 等）来识别客户端。在应用程序代码中，我们剥离了第一个子域并标识了客户端。

我们一直在使用 WIF 概念验证来弄清楚如何在用户通过身份验证后将其重定向回正确的子域。开箱即用的行为似乎是 STS 将用户重定向到配置文件中标识的任何领域。以下是 PoC 配置文件。我正在使用我的主机文件来伪造不同的客户端（即 127.0.0.1 client1.ourapp.com、127.0.0.1 client2.ourapp.com）。

```
<federatedAuthentication>
    <wsFederation 
        passiveRedirectEnabled="true" 
        issuer="http://ourapp.com/SSOPOCSite_STS/" 
        realm="http://client1.ourapp.com" 
        requireHttps="false" />
</federatedAuthentication> 
```

显然这是行不通的，因为我们不能将所有人重定向到同一个子域。

我们认为我们已经想出了如何处理这个问题，但希望得到一些外界的意见，看看我们是否以正确的方式做这件事，或者我们是否幸运。

我们为 FAM 的 RedirectingToIdentityProvider 事件创建了一个事件处理程序。在其中，我们从请求 URL 中获取公司名称，使用公司名称构建领域字符串，设置 SignInRequestMessage 的领域和 HomeRealm，然后让 FAM 做它的事情（即将我们重定向到 STS 进行身份验证）。

```
protected void WSFederationAuthenticationModule_RedirectingToIdentityProvider( object sender, RedirectingToIdentityProviderEventArgs e )
{
    // this method parses the HTTP_HOST and gets the first subdomain
    var companyName = GetCompanyName();
    var realm = GetRealm( companyName );

    e.SignInRequestMessage.Realm = realm;
    e.SignInRequestMessage.HomeRealm = companyName;
}

string GetRealm( string companyName )
{
    return String.Format( "http://{0}.ourapp.com/SSOPOCSite/", companyName );
} 
```

这似乎是解决问题的合理方法吗？

我们可能会因此遇到任何问题吗？

有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:22:54.977

您的解决方案听起来不错（明确传递您需要的信息），唯一想到的其他解决方案是使用`Request.UrlReferrer`来确定用户来自哪个子域。

# python - 在python中创建文件夹

> ID：10319598
> 
> 赞同：0
> 
> 时间：2012-04-25T16:13:47.807
> 
> 标签：python, html, mechanize, lxml

如何让这个脚本从链接名称中获取“nmv-fas”并创建一个具有该名称的目录，然后将所有下载的文件放在该目录中。

all.html：

```
<a href="http://www.youversion.com/bible/gen.45.nmv-fas">http://www.youversion.com/bible/gen.45.nmv-fas</a>
<a href="http://www.youversion.com/bible/gen.46.nmv-fas">http://www.youversion.com/bible/gen.46.nmv-fas</a>
<a href="http://www.youversion.com/bible/gen.47.nmv-fas">http://www.youversion.com/bible/gen.47.nmv-fas</a>
<a href="http://www.youversion.com/bible/gen.48.nmv-fas">http://www.youversion.com/bible/gen.48.nmv-fas</a>
<a href="http://www.youversion.com/bible/gen.49.nmv-fas">http://www.youversion.com/bible/gen.49.nmv-fas</a>
<a href="http://www.youversion.com/bible/gen.50.nmv-fas">http://www.youversion.com/bible/gen.50.nmv-fas</a>
<a href="http://www.youversion.com/bible/exod.1.nmv-fas">http://www.youversion.com/bible/exod.1.nmv-fas</a>
<a href="http://www.youversion.com/bible/exod.2.nmv-fas">http://www.youversion.com/bible/exod.2.nmv-fas</a>
<a href="http://www.youversion.com/bible/exod.3.nmv-fas">http://www.youversion.com/bible/exod.3.nmv-fas</a> 
```

保存在文件夹中的文件名为：

```
nmv-fas 
```

Python：

```
import lxml.html as html
import urllib
import urlparse
from BeautifulSoup import BeautifulSoup
import re

root = html.parse(open('all.html'))
for link in root.findall('//a'):
  url = link.get('href')
  name = urlparse.urlparse(url).path.split('/')[-1]
  f = urllib.urlopen(url)
  s = f.read()
  f.close()
  soup = BeautifulSoup(s)
  articleTag = soup.html.body.article
  converted = str(articleTag)
  open(name, 'w').write(converted) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:26:19.783

您可以使用该`lxml`模块从文件中解析链接，然后使用`urllib`下载每个链接。阅读链接可能如下所示：

```
import lxml.html as html

root = html.parse(open('links.html'))
for link in root.findall('//a'):
  url = link.get('href') 
```

您可以使用以下方式下载文件的链接`urllib.urlopen`：

```
import urllib
import urlparse

# extract the final path component and use it as
# the local filename.
name = urlparse.urlparse(url).path.split('/')[-1]

fd = urllib.urlopen(url)
open(name, 'w').write(fd.read()) 
```

把这些放在一起，你应该得到与你想要的相似的东西。

# makefile - 如何使用 autotools 设置条件 bin 程序创建

> ID：10319601
> 
> 赞同：0
> 
> 时间：2012-04-25T16:13:52.803
> 
> 标签：makefile

我是使用autotool的初学者，我想在Makefile.am中添加一些shell脚本，当我使用下面的方法时，autotool创建的Makefile不是我所期望的。我怎样才能写来创建正确的。感谢您的回复！

PS：这是我的 configure.in 和 Makefile.am(parts)

配置.in：

```
if test "$sample" = yes;then
    DEFS="$DEFS -DSAMPLE=1"
    AC_SUBST(SAMPLE, [yes])
fi 
```

生成文件.am：

```
if test "$SAMPLE" = yes;then
    noinst_PROGRAMS = test
    test_SOURCES = test.c
else
    bin_PROGRAMS = release
    release_SOURCES = main.c
fi 
```

Makefile 自动工具创建：

```
 ........
 ........
 .PHONY: CTAGS GTAGS all all-am check check-am clean clean-generic \
 clean-libLTLIBRARIES clean-libtool clean-noinstPROGRAMS ctags \
 distclean distclean-compile distclean-generic \
 distclean-libtool distclean-tags distdir dvi dvi-am html \
 html-am info info-am install install-am install-data \
 install-data-am install-dvi install-dvi-am install-exec \
 install-exec-am install-html install-html-am \
 install-includeHEADERS install-info install-info-am \
 install-libLTLIBRARIES install-man install-pdf install-pdf-am \
 install-ps install-ps-am install-strip installcheck \
 installcheck-am installdirs maintainer-clean \
 maintainer-clean-generic mostlyclean mostlyclean-compile \
 mostlyclean-generic mostlyclean-libtool pdf pdf-am ps ps-am \
 tags uninstall uninstall-am uninstall-includeHEADERS \
 uninstall-libLTLIBRARIES

if test "yes" = yes;then
fi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T07:58:37.830

Automake 条件不是那样工作的。请参阅[手册](http://www.gnu.org/software/automake/manual/html_node/Conditionals.html#Conditionals)。

这是它的外观：

配置.ac：

```
AM_CONDITIONAL([SAMPLE], [test "$SAMPLE" = yes]) 
```

生成文件.am：

```
if SAMPLE
noinst_PROGRAMS = test
test_SOURCES = test.c
else
bin_PROGRAMS = release
release_SOURCES = main.c
endif 
```

# javascript - 为什么可以删除窗口的覆盖属性？

> ID：10319602
> 
> 赞同：15
> 
> 时间：2012-04-25T16:13:55.277
> 
> 标签：javascript

操作员从对象中`delete`删除属性。如果我在 上设置一个属性`window`，我可以删除它：

```
window.myProp = 10;
delete window.myProp; 
```

正如我经常提到的其他人提到的关于操作符状态的行为的[文章](http://perfectionkills.com/understanding-delete/)`delete`一样，这是因为属性赋值不会设置`DontDelete`属性（与变量声明相反，它会设置属性）。

该文章还指出以下内容（强调）：

> 请注意，属性是在属性创建期间确定的（即没有设置任何属性）。**以后的分配不会修改现有 property 的属性**。了解这种区别很重要。

考虑到这一点，为什么我可以覆盖 window, 的现有属性，`alert`然后将其删除以*返回原始值*？我错过了一些明显的东西吗？我很少使用`delete`运算符，所以很可能就是这种情况。

例如：

```
window.alert = function() {};
alert("Hi!"); //Nothing happens

delete window.alert;
alert("Hello?"); //Alerts 'Hello?' 
```

这是一个证明这一点的[小提琴](http://jsfiddle.net/sKRYR/1/)（仅在 Chome 中测试过，很确定 IE 不会以这种方式运行，但现在除了 Chrome 之外无法访问任何东西）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T16:19:05.560

在 Chrome 中，`window.alert`函数是类*原型*的一部分`DOMWindow`，它不是`window`自身的属性。

因此，当您覆盖时，`window.alert`您正在向 中添加*新*属性`window`，但原型中的版本继续存在，但被隐藏了。

当您`delete window.alert`重新公开原型中的功能时。

下面是一些控制台输出，显示该函数在原型中：

```
> window.constructor.prototype
DOMWindow

> window.constructor.prototype.alert
function alert() { [native code] } 
```

Firefox 的行为类似，尽管类名不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:19:24.473

这是预期的行为，称为阴影。它允许您提供自定义功能而不会消除超类的功能。当您删除该方法时，您的自定义方法将被删除，从原型中显示原始方法。

你越深入继承和理解原型的工作方式，你就会越多地发现自己看到人们这样做的例子。

很好的问题。根据我的经验，这不是大多数 JavaScript 开发人员经常探索的领域。如果不是这种类型的东西，许多扩展或覆盖 JavaScript 基础对象的核心功能的 polyfill 是不可能的。

# ajax - 如何在 MVC3 的 Ajax Post 中使用相对 URL

> ID：10319603
> 
> 赞同：5
> 
> 时间：2012-04-25T16:14:01.237
> 
> 标签：ajax, asp.net-mvc-3, post, relative-path

我有一个写在单独的“.js”文件中的 Ajax 发布调用，我在多个页面中调用该文件。我的代码如下所示：

```
 $.ajax({
               url: '/MyVirtualDirectory/Controller/Action',
               type: 'POST',
               dataType: 'json',
               ....
               ....
              }) 
```

每次我更改服务器中的虚拟目录时，都需要更改“URL”中的代码以使我的 Ajax 调用正常工作。

是否有任何方法可以使我的代码独立于 IIS 中的“虚拟目录”名称 ..？

我的应用程序是 MVC3。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-25T16:17:55.417

### 描述

您应该使用该`Url.Action`方法。但在你的情况下，一个单独的 js 文件，你不能访问这个方法。所以我会为你视图中的每个 url 创建一个 javascript 变量。然后你可以在你的js文件中使用这个变量。

> **UrlHelper.Action 方法**- 生成操作方法的完全限定 URL。

### 样本

**你的看法**

```
<script type="text/javascript">
    var myUrl = '@Url.Action("actionName", "controllerName")';
</script>

<script type="text/javascript" src="yourJsFile.js"/> 
```

**你的 js 文件**

```
$.ajax({
       url: myUrl,
       ....
}) 
```

## 更新

另一种方法是将您的 url 存储在视图内的隐藏字段中，并在 js 文件中获取隐藏字段值。

### 更多信息

*   [MSDN - UrlHelper.Action 方法](http://msdn.microsoft.com/en-us/library/system.web.mvc.urlhelper.action.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:36:58.430

我终于找到了部分解决方法。在我的 .js 文件中，我做了一些像这样的脏代码：

```
 var Path = location.host;
 var VirtualDirectory;
 if (Path.indexOf("localhost") >= 0 && Path.indexOf(":") >= 0) {
 VirtualDirectory = "";

 }
 else {
 var pathname = window.location.pathname;
 var VirtualDir = pathname.split('/');
 VirtualDirectory = VirtualDir[1];
 VirtualDirectory = '/' + VirtualDirectory;
 }
$.ajax({
   url: VirtualDirectory/Controller/Action,
   ....}) 
```

基本思想是我检查 localhost 和端口号的 URL。如果两者都存在，则意味着我正在本地计算机上进行调试，因此我不需要 URL 中的虚拟目录。如果我运行的是托管版本，那么我的 URL 中将没有 localhost 和端口号（假设我在端口 80 上托管）。

通过这种方式，当我在本地机器上运行时调试 url 将只有 Controller/Action，而我托管 URL 将是 VirtualDirectory/Action/Controller。它现在对我来说很好。

但是，如果有任何其他简单的方法，请发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-16T08:02:03.547

我认为声明一个全局 Javascript 变量然后第一次设置变量会更安全，也许是在`Home/Index`触发时。然后在每个 ajax 调用中重用它，如下所示：
`$.ajax({... url: GlobalVariablePath + "Controller/Action/RouteValues" ...})`
如果您已经设计了 WebApp，并且在部署站点时一切正常并且卡住了，那么您可以像这样操作所有 ajax URL：

```
$.ajaxSetup({
  beforeSend: function (jqXHR, settings) {        
        settings.url = GlobalVariablePath + settings.url;
  }
}); 
```

使用这种方式，您可以安全地使用现有的 js 代码，其余部分无需更改。

# c# - monodevelop 解析肥皂响应

> ID：10319615
> 
> 赞同：3
> 
> 时间：2012-04-25T16:14:42.783
> 
> 标签：c#, soap, monodevelop

几个小时和几天以来一直在阅读这个论坛和其他论坛，但找不到我的肥皂反应的解决方案。在这里尝试了各种答案，但无法解析我的回复:(

我的回复 ：

```
<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <soapenv:Body>
        <getLocationsResponse xmlns="http://getlocations.ws.hymedis.net">
            <locs>
                <loc>
                    <name>Zeebrugge Wielingen Zand</name>
                    <abbr>ZWZ</abbr>
                    <RDX>1435.8</RDX>
                    <RDY>378678.6</RDY>
                    <params>
                        <param>GHs</param>
                        <param>SS10</param>
                    </params>
                </loc>
            </locs>
        </getLocationsResponse>
    </soapenv:Body>
</soapenv:Envelope> 
```

到目前为止，我的 c# 代码（param soapresponse 是字符串格式的整个soapresponse）我的响应是正确的，所以完整的xml soap 响应，但不能很好地解析它

```
public void readXml(string soapresponse){
        XmlDocument xmlresponse = new XmlDocument();
        xmlresponse.LoadXml(soapresponse);

        XmlNamespaceManager nsmanager = new XmlNamespaceManager(xmlresponse.NameTable);
        nsmanager.AddNamespace ("soapenv", "http://schemas.xmlsoap.org/soap/envelope/");

        XmlNodeList nodes = xmlresponse.SelectNodes("/soapenv:Envelope/soapenv:Body/getLocationsResponse/locs/loc", nsmanager);
        List<Locatie> locatielijst = new List<Locatie>();
        // loop
        foreach(XmlNode node in nodes){
            string loc_naam = node["name"].InnerText;
            string loc_code = node["abbr"].InnerText;
            ...
            Locatie locatie = new Locatie();
            locatie.loc_naam = loc_naam;
            locatie.loc_code = loc_code;
            ...
            locatielijst.Add (locatie);
        }

        Console.WriteLine(locatielijst.Count.ToString());
        foreach(Locatie loc in locatielijst){
            Console.WriteLine (loc.loc_code);
        }

    } 
```

但每次我的 list.count 返回 0 -> 所以其中没有数据.. 请帮帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T18:20:23.093

以下代码可能有效。

```

    公共类主类
    {
        公共静态无效主要（字符串[]参数）
        {
            var response = new FileStream("Response.xml", FileMode.Open);

            XDocument doc = XDocument.Load(response);
            XNamespace xmlns = "http://getlocations.ws.hymedis.net";

            var 节点 = doc.Descendants(xmlns + "locs")
                                .Elements(xmlns + "loc");

            var list = new List();
            foreach（节点中的var节点）
            {
                列表。添加（新位置 {
                    Name = node.Element(xmlns + "name").Value,
                    代码 = node.Element(xmlns + "abbr").Value
                });
            }

            foreach（列表中的变量项）{
                Console.WriteLine(item.Code);
            }
        }

        公共课位置
        {
            公共字符串代码 { 获取；放; }
            公共字符串名称 { 获取；放; }
        }
    }

```

我对单声道没有太多经验，但 .net 使使用 WCF SOAP 服务变得非常容易。本文解释了如何为 WCF 服务生成代理类：http: [//johnwsaunders3.wordpress.com/2009/05/17/how-to-consume-a-web-service/](http://johnwsaunders3.wordpress.com/2009/05/17/how-to-consume-a-web-service/)

我希望这有帮助。

问候， Wouter Willaert

# json - WCF 数据服务 - JSON 响应有额外的“结果”部分

> ID：10319618
> 
> 赞同：1
> 
> 时间：2012-04-25T16:14:49.403
> 
> 标签：json, wcf-data-services

使用[WCF Data Services Toolkit](http://wcfdstoolkit.codeplex.com)或其他支持`$format`参数的方法，例如`JSONPSupportInspectorAttribute`我得到一些对我来说有点奇怪的 json 响应。

为什么我的 json 看起来像：

```
{
"d" : {
"results": [
{
"__metadata": { 
```

当来自[OData.org $format](http://services.odata.org/OData/OData.svc/Products?%24format=json)的 json如下：

```
{
"d" : [
{
"__metadata": { 
```

为什么我的有一个额外的“结果”子部分？

我的数据服务直接构建在我的实体框架模型上。我是否必须使用特定的上下文模板才能消失？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:50:32.007

这是版本控制。在 V2 中，我们添加了服务器驱动的分页和内联计数功能，这些功能需要在提要上存储额外的元数据。但由于 V1 中的提要只是一个 JSON 数组，因此没有地方放置此类元数据。

因此，在 V2 中，响应中的所有提要都包装在“结果”包装器中。也就是说，提要是一个 JSON 对象，它具有一个名为“results”的属性，该属性具有数组。提要对象上可能还有其他属性（下一个链接、计数等）。

有效负载的版本控制基于该有效负载中任何功能所需的最低版本。因此，如果您的服务使用的内容需要高于 V1 版本的有效负载，则整个有效负载将使用该更高版本编写。

您甚至可以在 odata.org 服务上看到这一点 - 试试这个： [http](http://services.odata.org/OData/OData.svc/Products) : //services.odata.org/OData/OData.svc/Products ?$inlinecount=allpages&$format=json

响应将是 V2 并将使用结果包装器。

# .net - Delphi Prism 中的 BinaryReader 和 BinaryWriter 文件句柄

> ID：10319621
> 
> 赞同：0
> 
> 时间：2012-04-25T16:15:04.773
> 
> 标签：.net, file, delphi-prism, binaryreader, binarywriter

我希望能够在同一实例中或通过同一文件句柄读取和写入文件。我的意思是这个。假设您按如下方式打开一个文件。

```
BinaryReader jfile := new BinaryReader(File.OpenRead('c:\jokes.dat')); 
```

我希望能够写入文件而不必关闭 jfile 句柄然后调用 BinaryWriter 来写入文件。你能做到吗？

此外，一旦打开要写入的文件，旧文件中的任何同名数据都将被完全删除。真的吗？

我知道您可以按照以下方式为 Win32 执行此操作，而无需重新分配 f 文件句柄。

```
Assignfile(f,fname);
Reset(f,1);
BlockRead(f,jokeA,SizeOf(jokeA));

Reset(f,1);
BlockWrite(f,jokeB,SizeOf(jokeB));
CloseFile(f); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T06:12:02.757

你可以：

```
using lFile := File.Open('c:\jokes.dat', FileMode.ReadWrite) do begin
  var lReader := new BinaryReader(lFile);
  // read using reader

  lFile.Position := lFile.Length;
  var lWriter := new BinaryWriter(lFile);
  lWriter.Write...

end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:35:40.630

FWIW，我不认为你可以用 Binary* 类做到这一点。不过，您可以使用 FileStream 类。此外，FWIW，经典的 Pascal/Delphi Reset(File) 命令实际上打开了一个新句柄——它只是被重用的文件变量（本质上是文件名）。

# git - 如何处理版本化文件的自定义配置？- 混帐

> ID：10319623
> 
> 赞同：2
> 
> 时间：2012-04-25T16:15:09.847
> 
> 标签：git, version-control, mercurial

这个问题 [如何处理源代码管理中的配置文件？](https://stackoverflow.com/questions/6009/how-do-you-deal-with-configuration-files-in-source-control)建议忽略它们，虽然这是另一种选择，但我真的不想让他们移动 .ignore 文件那么多，对我来说似乎很脏。

大多数团队成员在许多版本文件中都有某种配置，这些文件不会提交到主分支。IE。app.config 文件与本地数据库等。

如何处理这些文件？他们需要他们让他们的环境运行，但总的来说，他们往往忘记向 repo 添加新文件，因为他们开始忽略修改过的文件。

我在想有某种脚本可以在编译时将它们从本地文件系统中删除，这样他们就可以判断整个解决方案在推入存储库时是否仍然可以编译，但我想知道是否有更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T18:30:51.097

我不确定您所说的“真的不想让他们移动 .ignore 文件那么多”是什么意思，但是您应该坚持最初找到的建议，并将不应添加的文件放在忽略中按预期归档。这就是它的用途，用不是每个人都会拥有的文件填充它根本没有害处。

您可以使用的其他一些工具是：

*   提交配置文件的模板（例如`config.sample`），并让您的构建脚本从`config.sample`被忽略的位置复制，`config`如果（且仅当）它不存在
*   增强您的配置系统以包括覆盖。例如`config.local`，被忽略的 ，会覆盖从其加载`config.shared`的跟踪设置。
*   增强您的配置系统以允许包含。例如`%include ~/settings`，人们可以将自己的配置放入其中

但是，所有这些都假定您忽略了一个因用户而异的配置文件，因为这是您应该做的。:)

# iphone - 如何在iphone Objective-c中用手指移动视图

> ID：10319625
> 
> 赞同：4
> 
> 时间：2012-04-25T16:15:13.927
> 
> 标签：iphone, objective-c, cocoa-touch, touch, swipe

我认为他的尺寸是 1280 X 345，我在我的屏幕上左右移动它。现在，我的主要问题是如何让它用我的手指移动（不是 swipeLeft / swipeRight）我希望它像 iPhone IOS 的主屏幕一样用我的手指移动。

现在，我使用这段代码：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint location = [touch locationInView:infoView];
    //[self.view setTransform:CGAffineTransformTranslate(CGAffineTransformIdentity, (location.x + self.view.frame.origin.x - dx), 0.0)];
    NSLog(@"touch: %f",location.x);

    infoView.frame = CGRectMake(infoView.frame.origin.x + location.x, 0, 1280, 345);
} 
```

这应该是当前的**方式**，但我无法弄清楚。我也尝试在谷歌和这里找到答案，但是，如你所知.. 我没有找到有用的东西。

我也做了这个，所以你可以更好地理解它。

![在此处输入图像描述](../Images/c68a4d795e401a52c4bb460e67aa511f.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T16:23:59.347

不要自己编写代码来执行此操作。使用`UIScrollView`. 这就是它的设计目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T04:12:05.350

如果你想拥有与 iPhone/iPad 主屏幕相同的效果，你应该使用 UIScrollView 并启用分页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:44:01.303

如果您出于某种原因真的想自己处理它，避免使用 UIScrollView，则有 UIGestureRecognizers，特别是 UIPanGestureRecognizer，它可以利用大部分工作在一个地方处理多个触摸事件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-26T21:30:39.067

我使用 UIPagecontrol 和 UIScrollView 来制作它。非常简单和智能的对象！

# google-maps-api-3 - 您可以通过 Google 地图使用单个请求 URL 对多个坐标进行反向地理编码吗？

> ID：10319626
> 
> 赞同：2
> 
> 时间：2012-04-25T16:15:23.217
> 
> 标签：google-maps-api-3, geocode, google-geocoder

是否可以通过谷歌地图使用单个请求 URL 请求多个坐标进行反向地理编码？

例如，我希望能够做这样的事情：

```
http://maps.googleapis.com/maps/api/geocode/json?latlng=53,-1.6&latlng=52,1.2&latlng=23,-2.9&sensor=false 
```

我通过三个不同的坐标进行地理编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:23:41.730

所有“有可能……”问题的答案是“当你这样做时会发生什么？”

**不**，这不是一个选项。

# haskell - 如何将 MonadThrow 实例添加到 Warp 服务器中的 ResourceT Monad Transformer

> ID：10319629
> 
> 赞同：5
> 
> 时间：2012-04-25T16:15:30.067
> 
> 标签：haskell, haskell-warp

我正在尝试使用 Warp 构建一个简单的反向代理服务器（主要是为了我自己的启发，因为还有很多其他现成的选项）。

到目前为止，我的代码大部分是从 Warp 文档中提取的（将输出写入文件只是一个临时测试，再次从文档中提取）：

```
import Network.Wai as W
import Network.Wai.Handler.Warp
import Network.HTTP.Types
import Network.HTTP.Conduit as H
import qualified Data.Conduit as C
import Data.Conduit.Binary (sinkFile)
import Blaze.ByteString.Builder.ByteString
import Control.Monad.Trans.Resource
import Control.Monad.IO.Class

proxApp req = do
    let hd = headerAccept "Some header"
    {-liftIO $ logReq req-}
    pRequest <- parseUrl "http://some_website.com"
    H.withManager $ \manager -> do
        Response _ _ _ src <- http pRequest manager
        src C.$$ sinkFile "test.html"
    return $ ResponseBuilder status200 [hd] $ fromByteString "OK\n"

main = do
    putStrLn "Setting up reverse proxy on 8080"
    run 8080 proxApp 
```

当我尝试在 ResourceT Monad 中运行 Network.HTTP 操作时，编译器正确地要求它是 MonadThrow 的一个实例。我的困难是如何将它添加到 monad 堆栈或将它的实例添加到 ResourceT。以下代码的编译器错误是：

```
No instance for (MonadThrow
                   (conduit-0.1.1.1:Control.Monad.Trans.Resource.ResourceT IO))
  arising from a use of `proxApp'
Possible fix:
  add an instance declaration for
  (MonadThrow
     (conduit-0.1.1.1:Control.Monad.Trans.Resource.ResourceT IO))
In the second argument of `run', namely `proxApp'
In a stmt of a 'do' block: run 8080 proxApp
In the expression:
  do { putStrLn "Setting up reverse proxy on 8080";
       run 8080 proxApp } 
```

如果我删除 HTTP 行，则不再需要 MonadThrow 实例，并且一切正常。

如果我将一个新的自定义 monad 定义为 MonadThrow 的实例，我如何让服务器使用它实际运行？寻找在我的堆栈中引入这种异常处理的正确方法（甚至只是满足编译器）。

谢谢/O

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:23:23.783

这应该这样做（如果你`import Control.Monad.Trans.Resource`这样的话`ResourceT`）：

```
instance (MonadThrow m) => MonadThrow (ResourceT m) where
    monadThrow = lift . monadThrow 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T14:44:49.780

感谢所有的回复。以下面的代码结束，它似乎与 warp-1.2.0.1 完美配合。

```
proxApp req = do
    liftIO $ logReq req
    pRequest <- parseUrl "http://some_website.com"
    H.withManager $ \manager -> do
        Response status version headers src <- http pRequest manager
        body <- src C.$$ responseSink
        liftIO $ putStrLn $ show status
        return $ ResponseBuilder status headers body

responseSink = C.sinkState
    (fromByteString "")
    (\acc a -> return $ C.StateProcessing $ mappend acc $ fromByteString a )
    (\acc -> return acc) 
```

# javascript - 在文本区域中对某些正则表达式匹配进行颜色编码？

> ID：10319630
> 
> 赞同：0
> 
> 时间：2012-04-25T16:15:31.507
> 
> 标签：javascript, jquery, textarea

有没有办法通过 JS 突出显示与特定模式匹配的文本区域内的文本？

我讨厌使用完全所见即所得的编辑器，因为我只想突出显示某些文本（科学文章中的引用，阅读起来非常麻烦）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:19:33.673

textarea 不能支持不同的颜色。所以你的答案是你不能在文本区域中做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:20:36.823

看看这篇文章：[Javascript - 更改 textarea 中某些文本的字体颜色](https://stackoverflow.com/questions/1102149/javascript-change-font-color-of-certain-text-in-textarea)

总而言之，您无法在文本区域内添加标签，因此您无法修改其中包含的文本的字体/样式。

# ruby-on-rails - 格式化导轨数据

> ID：10319631
> 
> 赞同：0
> 
> 时间：2012-04-25T16:15:32.800
> 
> 标签：ruby-on-rails, view

我有像年月这样的整数值，但我不会看到月年，我怎么能在 Rails 视图中做到这一点？例如

> 197903 198812

必须被视为

> 03-1979 12-1988

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:39:29.677

尝试这个

```
"#{197903.to_s[0...4]}-#{197903.to_s[4...6]}" 
```

如果您可以先将其转换为日期对象，则可能会有更优雅的方式来执行此操作。

# android - ClassNotFoundException / RuntimeException

> ID：10319641
> 
> 赞同：0
> 
> 时间：2012-04-25T16:16:09.980
> 
> 标签：android, android-activity, android-intent

我正在尝试在我的项目中实现一个类......但是在`onClick`按下按钮时调用意图后它给了我一个错误。这是我的代码片段，看看您是否可以帮助我。

文件名：

> QrCapture.java
> qrcapture.xml

在我的 android 清单中，我有：

```
 <activity android:name=".QrCapture" 
         android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.VIEW"/>
            <action android:name="org.jujitsu.app.qrcapture" />
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
    </activity> 
```

在 qrcapture.xml 文件中，我有：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

  <TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/hello" />
  <FrameLayout
    android:layout_width="200dip" 
    android:layout_height="200dip" 
    android:layout_gravity="center_horizontal">
    <include layout="@layout/capture"/>

 </FrameLayout>
</LinearLayout> 
```

我的 qrcapture.java 文件包含以下源：

```
package org.jujitsu.app.com; 
import android.graphics.Bitmap;
import android.os.Bundle;
import android.widget.Toast;

public class QrCapture extends CaptureActivity {

@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.qrcapture);         
}

//TODO Save bitmap to file. 

@Override
public void handleDecode(Result rawResult, Bitmap barcode)
{
   Toast.makeText(this.getApplicationContext(), "Scanned code "+ rawResult.getText(), Toast.LENGTH_LONG);
}

} 
```

我以这种方式开始活动：

```
 Intent i = new Intent("org.jujitsu.app.qrcapture");
 startActivity(i); 
```

这是我得到的错误：

```
04-25 16:49:09.220: E/AndroidRuntime(1010): FATAL EXCEPTION: main

04-25 16:49:09.220: E/AndroidRuntime(1010): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{org.jujitsu.app.com/org.jujitsu.app.com.QrCapture}: java.lang.ClassNotFoundException: org.jujitsu.app.com.QrCapture

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2118)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2237)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.ActivityThread.access$600(ActivityThread.java:139)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.os.Handler.dispatchMessage(Handler.java:99)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.os.Looper.loop(Looper.java:154)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.ActivityThread.main(ActivityThread.java:4974)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at java.lang.reflect.Method.invokeNative(Native Method)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at java.lang.reflect.Method.invoke(Method.java:511)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at dalvik.system.NativeStart.main(Native Method)

04-25 16:49:09.220: E/AndroidRuntime(1010): Caused by: java.lang.ClassNotFoundException: org.jujitsu.app.com.QrCapture

04-25 16:49:09.220: E/AndroidRuntime(1010):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.Instrumentation.newActivity(Instrumentation.java:1039)

04-25 16:49:09.220: E/AndroidRuntime(1010):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2109)

04-25 16:49:09.220: E/AndroidRuntime(1010):     ... 11 more 
```

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:38:24.753

尝试将完整的包名放在清单中

```
<activity android:name="org.jujitsu.app.com.QrCapture" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:23:55.897

您如何处理活动 QrCapture 中的操作？

像这样实施 onNewIntent 并查看...可能会有所帮助

它看起来像

```
public void onNewIntent(Intent intent)
{
  String action = intent.getAction();

if(action.equals("UR ACTION NAME")
{
  // do ur stuff here
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:24:40.857

您可以尝试像这样开始意图：

```
Intent intent = new Intent(FirstActivity.this, QrCapture.class);
startActivity(intent); 
```

# ios - 正确使用 beginBackgroundTaskWithExpirationHandler

> ID：10319643
> 
> 赞同：109
> 
> 时间：2012-04-25T16:16:10.677
> 
> 标签：ios, objective-c, network-programming, multitasking, background-thread

我对如何以及何时使用有点困惑`beginBackgroundTaskWithExpirationHandler`。

Apple 在他们的示例中展示了在`applicationDidEnterBackground`委托中使用它，以获得更多时间来完成一些重要任务，通常是网络事务。

在查看我的应用程序时，似乎我的大部分网络内容都很重要，当启动一个应用程序时，如果用户按下主页按钮，我想完成它。

那么，为了安全起见，包装每个网络事务（我不是在谈论下载大块数据，主要是一些简短的 xml）是否被接受/良好做法 `beginBackgroundTaskWithExpirationHandler`？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2012-04-25T16:23:42.123

如果您希望您的网络事务在后台继续进行，那么您需要将其包装在后台任务中。完成后打电话也很重要`endBackgroundTask`- 否则应用程序将在分配的时间到期后被杀死。

我的往往看起来像这样：

```
- (void) doUpdate 
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

        [self beginBackgroundUpdateTask];

        NSURLResponse * response = nil;
        NSError  * error = nil;
        NSData * responseData = [NSURLConnection sendSynchronousRequest: request returningResponse: &response error: &error];

        // Do something with the result

        [self endBackgroundUpdateTask];
    });
}
- (void) beginBackgroundUpdateTask
{
    self.backgroundUpdateTask = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
        [self endBackgroundUpdateTask];
    }];
}

- (void) endBackgroundUpdateTask
{
    [[UIApplication sharedApplication] endBackgroundTask: self.backgroundUpdateTask];
    self.backgroundUpdateTask = UIBackgroundTaskInvalid;
} 
```

我有`UIBackgroundTaskIdentifier`每个后台任务的属性

* * *

Swift 中的等价代码

```
func doUpdate () {

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), {

        let taskID = beginBackgroundUpdateTask()

        var response: URLResponse?, error: NSError?, request: NSURLRequest?

        let data = NSURLConnection.sendSynchronousRequest(request, returningResponse: &response, error: &error)

        // Do something with the result

        endBackgroundUpdateTask(taskID)

        })
}

func beginBackgroundUpdateTask() -> UIBackgroundTaskIdentifier {
    return UIApplication.shared.beginBackgroundTask(expirationHandler: ({}))
}

func endBackgroundUpdateTask(taskID: UIBackgroundTaskIdentifier) {
    UIApplication.shared.endBackgroundTask(taskID)
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-12-27T05:20:34.660

接受的答案非常有帮助，在大多数情况下应该没问题，但是有两件事困扰着我：

1.  正如许多人所指出的那样，将任务标识符存储为属性意味着如果多次调用该方法，它可以被覆盖，从而导致任务在到期时被操作系统强制结束之前永远不会优雅地结束.

2.  这种模式要求每次调用都有一个唯一的属性，`beginBackgroundTaskWithExpirationHandler`如果你有一个带有很多网络方法的大型应用程序，这似乎很麻烦。

为了解决这些问题，我编写了一个单例来处理所有管道并在字典中跟踪活动任务。不需要任何属性来跟踪任务标识符。似乎运作良好。用法简化为：

```
//start the task
NSUInteger taskKey = [[BackgroundTaskManager sharedTasks] beginTask];

//do stuff

//end the task
[[BackgroundTaskManager sharedTasks] endTaskWithKey:taskKey]; 
```

可选地，如果您想提供一个完成块来完成任务（内置）之外的其他操作，您可以调用：

```
NSUInteger taskKey = [[BackgroundTaskManager sharedTasks] beginTaskWithCompletionHandler:^{
    //do stuff
}]; 
```

下面提供了相关的源代码（为简洁起见，排除了单一的东西）。欢迎评论/反馈。

```
- (id)init
{
    self = [super init];
    if (self) {

        [self setTaskKeyCounter:0];
        [self setDictTaskIdentifiers:[NSMutableDictionary dictionary]];
        [self setDictTaskCompletionBlocks:[NSMutableDictionary dictionary]];

    }
    return self;
}

- (NSUInteger)beginTask
{
    return [self beginTaskWithCompletionHandler:nil];
}

- (NSUInteger)beginTaskWithCompletionHandler:(CompletionBlock)_completion;
{
    //read the counter and increment it
    NSUInteger taskKey;
    @synchronized(self) {

        taskKey = self.taskKeyCounter;
        self.taskKeyCounter++;

    }

    //tell the OS to start a task that should continue in the background if needed
    NSUInteger taskId = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
        [self endTaskWithKey:taskKey];
    }];

    //add this task identifier to the active task dictionary
    [self.dictTaskIdentifiers setObject:[NSNumber numberWithUnsignedLong:taskId] forKey:[NSNumber numberWithUnsignedLong:taskKey]];

    //store the completion block (if any)
    if (_completion) [self.dictTaskCompletionBlocks setObject:_completion forKey:[NSNumber numberWithUnsignedLong:taskKey]];

    //return the dictionary key
    return taskKey;
}

- (void)endTaskWithKey:(NSUInteger)_key
{
    @synchronized(self.dictTaskCompletionBlocks) {

        //see if this task has a completion block
        CompletionBlock completion = [self.dictTaskCompletionBlocks objectForKey:[NSNumber numberWithUnsignedLong:_key]];
        if (completion) {

            //run the completion block and remove it from the completion block dictionary
            completion();
            [self.dictTaskCompletionBlocks removeObjectForKey:[NSNumber numberWithUnsignedLong:_key]];

        }

    }

    @synchronized(self.dictTaskIdentifiers) {

        //see if this task has been ended yet
        NSNumber *taskId = [self.dictTaskIdentifiers objectForKey:[NSNumber numberWithUnsignedLong:_key]];
        if (taskId) {

            //end the task and remove it from the active task dictionary
            [[UIApplication sharedApplication] endBackgroundTask:[taskId unsignedLongValue]];
            [self.dictTaskIdentifiers removeObjectForKey:[NSNumber numberWithUnsignedLong:_key]];

        }

    }
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-04-15T03:17:14.080

这是一个封装运行后台任务的[Swift 类](https://gist.github.com/phatmann/e96958529cc86ff584a9)：

```
class BackgroundTask {
    private let application: UIApplication
    private var identifier = UIBackgroundTaskInvalid

    init(application: UIApplication) {
        self.application = application
    }

    class func run(application: UIApplication, handler: (BackgroundTask) -> ()) {
        // NOTE: The handler must call end() when it is done

        let backgroundTask = BackgroundTask(application: application)
        backgroundTask.begin()
        handler(backgroundTask)
    }

    func begin() {
        self.identifier = application.beginBackgroundTaskWithExpirationHandler {
            self.end()
        }
    }

    func end() {
        if (identifier != UIBackgroundTaskInvalid) {
            application.endBackgroundTask(identifier)
        }

        identifier = UIBackgroundTaskInvalid
    }
} 
```

最简单的使用方法：

```
BackgroundTask.run(application) { backgroundTask in
   // Do something
   backgroundTask.end()
} 
```

如果您需要在结束之前等待委托回调，请使用以下内容：

```
class MyClass {
    backgroundTask: BackgroundTask?

    func doSomething() {
        backgroundTask = BackgroundTask(application)
        backgroundTask!.begin()
        // Do something that waits for callback
    }

    func callback() {
        backgroundTask?.end()
        backgroundTask = nil
    } 
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-05-02T18:37:40.203

如here和其他SO问题的答案所述，您不想`beginBackgroundTask`仅在您的应用程序进入后台时使用；相反，您应该将后台任务用于*任何*您希望确保其完成的耗时操作，即使应用程序*确实*进入了后台。

因此，您的代码可能最终会重复使用相同的样板代码进行调用`beginBackgroundTask`和`endBackgroundTask`连贯。为了防止这种重复，将样板打包成一些单一的封装实体当然是合理的。

我喜欢这样做的一些现有答案，但我认为最好的方法是使用 Operation 子类：

*   您可以将操作排入任何 OperationQueue 并在您认为合适的时候操作该队列。例如，您可以自由地提前取消队列上的任何现有操作。

*   如果你有不止一件事情要做，你可以链接多个后台任务操作。操作支持依赖项。

*   操作队列可以（也应该）是后台队列；因此，无需担心在任务中执行异步代码，因为 Operation*是*异步代码。*（实际上，在操作中执行另一层*异步代码是没有意义的，因为操作会在代码开始之前完成。如果你需要这样做，你会使用另一个操作。）

这是一个可能的操作子类：

```
class BackgroundTaskOperation: Operation {
    var whatToDo : (() -> ())?
    var cleanup : (() -> ())?
    override func main() {
        guard !self.isCancelled else { return }
        guard let whatToDo = self.whatToDo else { return }
        var bti : UIBackgroundTaskIdentifier = .invalid
        bti = UIApplication.shared.beginBackgroundTask {
            self.cleanup?()
            self.cancel()
            UIApplication.shared.endBackgroundTask(bti) // cancellation
        }
        guard bti != .invalid else { return }
        whatToDo()
        guard !self.isCancelled else { return }
        UIApplication.shared.endBackgroundTask(bti) // completion
    }
} 
```

如何使用它应该很明显，但如果不是，想象我们有一个全局 OperationQueue：

```
let backgroundTaskQueue : OperationQueue = {
    let q = OperationQueue()
    q.maxConcurrentOperationCount = 1
    return q
}() 
```

所以对于一个典型的耗时的代码，我们会说：

```
let task = BackgroundTaskOperation()
task.whatToDo = {
    // do something here
}
backgroundTaskQueue.addOperation(task) 
```

如果您的耗时代码批次可以分为多个阶段，那么如果您的任务被取消，您可能希望提前退出。在这种情况下，只需从关闭中过早返回。请注意，您在闭包中对任务的引用需要很弱，否则您将获得一个保留周期。这是一个人工插图：

```
let task = BackgroundTaskOperation()
task.whatToDo = { [weak task] in
    guard let task = task else {return}
    for i in 1...10000 {
        guard !task.isCancelled else {return}
        for j in 1...150000 {
            let k = i*j
        }
    }
}
backgroundTaskQueue.addOperation(task) 
```

如果您有清理工作以防后台任务本身被提前取消，我提供了一个可选的`cleanup`处理程序属性（在前面的示例中未使用）。其他一些答案因不包括在内而受到批评。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-22T07:01:47.680

我实施了 Joel 的解决方案。这是完整的代码：

.h 文件：

```
#import <Foundation/Foundation.h>

@interface VMKBackgroundTaskManager : NSObject

+ (id) sharedTasks;

- (NSUInteger)beginTask;
- (NSUInteger)beginTaskWithCompletionHandler:(CompletionBlock)_completion;
- (void)endTaskWithKey:(NSUInteger)_key;

@end 
```

.m 文件：

```
#import "VMKBackgroundTaskManager.h"

@interface VMKBackgroundTaskManager()

@property NSUInteger taskKeyCounter;
@property NSMutableDictionary *dictTaskIdentifiers;
@property NSMutableDictionary *dictTaskCompletionBlocks;

@end

@implementation VMKBackgroundTaskManager

+ (id)sharedTasks {
    static VMKBackgroundTaskManager *sharedTasks = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        sharedTasks = [[self alloc] init];
    });
    return sharedTasks;
}

- (id)init
{
    self = [super init];
    if (self) {

        [self setTaskKeyCounter:0];
        [self setDictTaskIdentifiers:[NSMutableDictionary dictionary]];
        [self setDictTaskCompletionBlocks:[NSMutableDictionary dictionary]];
    }
    return self;
}

- (NSUInteger)beginTask
{
    return [self beginTaskWithCompletionHandler:nil];
}

- (NSUInteger)beginTaskWithCompletionHandler:(CompletionBlock)_completion;
{
    //read the counter and increment it
    NSUInteger taskKey;
    @synchronized(self) {

        taskKey = self.taskKeyCounter;
        self.taskKeyCounter++;

    }

    //tell the OS to start a task that should continue in the background if needed
    NSUInteger taskId = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
        [self endTaskWithKey:taskKey];
    }];

    //add this task identifier to the active task dictionary
    [self.dictTaskIdentifiers setObject:[NSNumber numberWithUnsignedLong:taskId] forKey:[NSNumber numberWithUnsignedLong:taskKey]];

    //store the completion block (if any)
    if (_completion) [self.dictTaskCompletionBlocks setObject:_completion forKey:[NSNumber numberWithUnsignedLong:taskKey]];

    //return the dictionary key
    return taskKey;
}

- (void)endTaskWithKey:(NSUInteger)_key
{
    @synchronized(self.dictTaskCompletionBlocks) {

        //see if this task has a completion block
        CompletionBlock completion = [self.dictTaskCompletionBlocks objectForKey:[NSNumber numberWithUnsignedLong:_key]];
        if (completion) {

            //run the completion block and remove it from the completion block dictionary
            completion();
            [self.dictTaskCompletionBlocks removeObjectForKey:[NSNumber numberWithUnsignedLong:_key]];

        }

    }

    @synchronized(self.dictTaskIdentifiers) {

        //see if this task has been ended yet
        NSNumber *taskId = [self.dictTaskIdentifiers objectForKey:[NSNumber numberWithUnsignedLong:_key]];
        if (taskId) {

            //end the task and remove it from the active task dictionary
            [[UIApplication sharedApplication] endBackgroundTask:[taskId unsignedLongValue]];
            [self.dictTaskIdentifiers removeObjectForKey:[NSNumber numberWithUnsignedLong:_key]];

            NSLog(@"Task ended");
        }

    }
}

@end 
```

# php - 如何更正 foreach 循环并获得所需的数组深度？

> ID：10319644
> 
> 赞同：2
> 
> 时间：2012-04-25T16:16:11.083
> 
> 标签：php, pchart

我将一种颜色推入一个数组，以用一种颜色覆盖每个条形图颜色，但它没有按预期工作，数组有问题。

我的原始问题：如何将数组推送到 barChart 并在 pChart 中使用单色覆盖？

**更新**的问题： print_r 结果显示了额外的 2 组数组，它​​应该只是一个包含数组的数组，没有更深，这些是在哪里添加的？我该如何纠正？

PHP/pChart：

```
$prop_open=(1,5,8,4,2,66);

$j=0;
$palette_cycle=array();
foreach($prop_open as $value) {
    array_push($palette_cycle,array("$j"=>array("R"=>108,"G"=>157,"B"=>49,"Alpha"=>100)));
    $j++;
}

$palette=$palette_cycle;
$myPicture->drawBarChart(array("OverrideColors"=>$palette,"DisplayOrientation"=>ORIENTATION_HORIZONTAL,"DisplayPos"=>LABEL_POS_INSIDE,"DisplayValues"=>TRUE,"DisplayColor"=>DISPLAY_MANUAL,"DisplayR"=>0,"DisplayG"=>0,"DisplayB"=>0,"Surrounding"=>-60,"InnerSurrounding"=>60)); 
```

这就是我的 $palette_cycle 数组在完成后应该如何处理（但所有 RGB 都是相同的）：

```
$palette_cycle = array("0"=>array("R"=>188,"G"=>224,"B"=>46,"Alpha"=>100),
                 "1"=>array("R"=>224,"G"=>100,"B"=>46,"Alpha"=>100),
                 "2"=>array("R"=>224,"G"=>214,"B"=>46,"Alpha"=>100),
                 "3"=>array("R"=>46,"G"=>151,"B"=>224,"Alpha"=>100),
                 "4"=>array("R"=>176,"G"=>46,"B"=>224,"Alpha"=>100),
                 "5"=>array("R"=>224,"G"=>46,"B"=>117,"Alpha"=>100),
                 "6"=>array("R"=>92,"G"=>224,"B"=>46,"Alpha"=>100),
                 "7"=>array("R"=>224,"G"=>176,"B"=>46,"Alpha"=>100)); 
```

$palette_cycle 的 Print_R 结果：

```
Array ( 
[0] => Array ( [0] => Array ( [R] => 108 [G] => 157 [B] => 49 [Alpha] => 100 ) ) 
[1] => Array ( [1] => Array ( [R] => 108 [G] => 157 [B] => 49 [Alpha] => 100 ) ) 
[2] => Array ( [2] => Array ( [R] => 108 [G] => 157 [B] => 49 [Alpha] => 100 ) ) 
[3] => Array ( [3] => Array ( [R] => 108 [G] => 157 [B] => 49 [Alpha] => 100 ) ) 
[4] => Array ( [4] => Array ( [R] => 108 [G] => 157 [B] => 49 [Alpha] => 100 ) ) 
[5] => Array ( [5] => Array ( [R] => 108 [G] => 157 [B] => 49 [Alpha] => 100 ) ) ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:41:25.637

也许尝试使用这样的数组：

```
$j=0;
$palette_cycle=array();
foreach($prop_open as $value) {
   $palette_cycle[] = array("R"=>108,"G"=>157,"B"=>49,"Alpha"=>100);
} 
```

1、使用整数索引代替字符串索引 2、不需要array_push

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:38:10.347

试试这个

```
foreach($prop_open as $value) {
array_push($palette_cycle,"$j"=>array("R"=>108,"G"=>157,"B"=>49,"Alpha"=>100));
$j++;
} 
```

如果没有，请尝试

```
foreach($prop_open as $value) {
$palette_cycle[$j] = array("R"=>108,"G"=>157,"B"=>49,"Alpha"=>100);
$j++;
} 
```

# javascript - _references.js 是做什么用的？

> ID：10319645
> 
> 赞同：241
> 
> 时间：2012-04-25T16:16:11.423
> 
> 标签：javascript, visual-studio, asp.net-mvc-4

新的 ASP.NET MVC 4 项目中使用的 _references.js 文件是什么？

* * *

## 回答 #1

> 赞同：264
> 
> 时间：2012-04-25T16:21:02.930

> 在 VS 11 中，Visual Studio 将为您提供来自“_references.js”文件中引用的所有文件的智能感知。

[欲了解更多信息](http://gurustop.net/blog/2012/03/03/javascript-js-intellisense-auto_complete-in-visual-studio-11-beta-the-web-_references-js-file/)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-12-10T11:01:42.763

MSDN 文档：[JavaScript IntelliSense](http://msdn.microsoft.com/en-us/library/bb385682.aspx)

简而言之，_references.js 存储 JS 文件路径列表，您希望 Visual Studio 为其收集和构建智能感知（也称为“代码完成”）。VS 项目在那里添加了一些常见的 JS 库，如 jQuery 来为其构建智能感知。您可以以如下形式添加对自定义 JS 文件的引用：

```
/// <reference path="MyScriptFile.js" /> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-07-12T19:01:34.003

[从 Visual Studio 2017 开始，不再使用](https://docs.microsoft.com/en-us/visualstudio/javascript/javascript-in-vs-2017?view=vs-2019#no-more-references-or-_referencesjs)此文件。

# c++ - 像 C# 一样在 Qt 中锁定对象

> ID：10319647
> 
> 赞同：4
> 
> 时间：2012-04-25T16:16:18.500
> 
> 标签：c++, qt4, locking

在 C# 中，如果我有例如我可以做的列表

```
lock (this.mylist)
{
    ...
} 
```

并且使用该代码，我确信在释放锁定之前没有其他人可以使用该列表。这在多线程应用程序中很有用。我怎样才能在 Qt 上做同样的事情？我阅读了有关 QMutex 和 QReadWriteLock 的文档，但我不明白如何在特定对象上使用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:19:22.300

要使用`QMutex`（或 C/C++ 中的任何标准同步方法），所有相互依赖的关键部分都必须了解互斥锁。确保这一点的最简单（但不是 C++ 中的最佳实践，即使其成为类成员或其他东西）方法是创建一个全局变量互斥锁（例如，我们将这样做）。

所以考虑以下

```
QMutex mutex;

void someMethod()
{
  mutex.lock();
  // Critical section
  mutex.unlock();
} 
```

现在，`lock`和`unlock`是原子方法，因此在任何给定时间只有一个线程能够进入临界区。关键是两者都试图访问*同一个*互斥锁。

因此，本质上，这与`C#`您需要自己管理互斥锁的方式相同。所以`lock(...) { ... }`块被替换为`mutex.lock() ... mutex.unlock()`. 然而，这也意味着，无论何时您想要访问关键部分项目（即在您的示例中`this->mylist`），您都应该使用互斥锁。

**编辑** Qt 有很好的文档。您可以在此处阅读更多信息：http `QMutex`: [//doc.qt.io/qt-4.8/qmutex.html](http://doc.qt.io/qt-4.8/qmutex.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:24:28.533

执行此类操作的一般 C++ 方法是使用 RAII，因此您最终会得到如下代码：

```
// Inside a function, a block that needs to be locked
{
  QMutexLocker lock(&mutex); // locks mutex
  // Do stuff

  // "QMutexLocker" destructor unlocks the mutex when it goes out of scope
} 
```

我不知道这如何转化为 Qt，但如果没有本机支持，您可能会编写一个帮助程序类。

编辑：感谢 Cory，您可以看到 Qt 非常好地支持这个习语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:45:54.693

在 C++11 中，您可以这样做：

```
#include <thread>
#include <mutex>

std::mutex mut;

void someMethod()
{
  std::lock_guard(mut);
  // Critical section
} 
```

这是 RAII 惯用语 - 锁守卫是一个无论 someMethod 范围如何退出（正常返回或抛出）都会释放锁的对象。请参阅 Anthony Williams 的 C++ concurrency In Action。他还有一个[C++11 线程实现](http://www.stdthread.co.uk/)。C++11 的实现很像 boost 线程的实现。

# bash - 检查文件是否可执行

> ID：10319652
> 
> 赞同：97
> 
> 时间：2012-04-25T16:16:41.150
> 
> 标签：bash, tcsh

我想知道检查程序是否可以使用 bash 执行而不执行它的最简单方法是什么？它至少应该检查文件是否具有执行权限，并且与当前系统具有相同的体系结构（例如，不是 windows 可执行文件或其他不受支持的体系结构，如果系统是 32 位，则不是 64 位，...）。

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2012-04-25T16:27:37.847

看看各种[测试](http://unixhelp.ed.ac.uk/CGI/man-cgi?test)运算符（这是针对测试命令本身的，但内置的 BASH 和 TCSH 测试或多或少相同）。

您会注意到`-x FILE`FILE*存在并授予执行（或搜索）权限*。

BASH、Bourne、Ksh、Zsh 脚本

```
if [[ -x "$file" ]]
then
    echo "File '$file' is executable"
else
    echo "File '$file' is not executable or found"
fi 
```

TCSH 或 CSH 脚本：

```
if ( -x "$file" ) then
    echo "File '$file' is executable"
else
    echo "File '$file' is not executable or found"
endif 
```

要确定文件的*类型*，请尝试使用[file](http://unixhelp.ed.ac.uk/CGI/man-cgi?file)命令。您可以解析输出以准确查看它是什么类型的文件。***Word 'o 警告***：有时`file`会返回多行。这是我的 Mac 上发生的情况：

```
$ file /bin/ls    
/bin/ls: Mach-O universal binary with 2 architectures
/bin/ls (for architecture x86_64):  Mach-O 64-bit executable x86_64
/bin/ls (for architecture i386):    Mach-O executable i386 
```

该`file`命令根据操作系统返回不同的输出。然而，这个词`executable`将出现在可执行程序中，通常架构也会出现。

将上面的内容与我在 Linux 机器上得到的内容进行比较：

```
$ file /bin/ls
/bin/ls: ELF 64-bit LSB executable, AMD x86-64, version 1 (SYSV), for GNU/Linux 2.6.9, dynamically linked (uses shared libs), stripped 
```

还有一个 Solaris 盒子：

```
$ file /bin/ls
/bin/ls:        ELF 32-bit MSB executable SPARC Version 1, dynamically linked, stripped 
```

在所有三个中，您都会看到单词`executable`和架构（`x86-64`、`i386`或`SPARC`with `32-bit`）。

* * *

# 附录

> 非常感谢，这似乎是要走的路。在我将此标记为我的答案之前，请您指导我必须对“文件”执行什么样的脚本外壳检查（即，什么样的解析）以检查我是否可以执行程序？如果这样的测试很难在一般基础上进行，我至少想检查它是 linux 可执行文件还是 osX (Mach-O)

在我的脑海中，你可以在 BASH 中做这样的事情：

```
if [ -x "$file" ] && file "$file" | grep -q "Mach-O"
then
    echo "This is an executable Mac file"
elif [ -x "$file" ] && file "$file" | grep -q "GNU/Linux"
then
    echo "This is an executable Linux File"
elif [ -x "$file" ] && file "$file" | grep q "shell script"
then
    echo "This is an executable Shell Script"
elif [ -x "$file" ]
then
    echo "This file is merely marked executable, but what type is a mystery"
else
    echo "This file isn't even marked as being executable"
fi 
```

基本上，我正在运行测试，如果测试成功，我会对`file`命令的输出执行 grep。该`grep -q`方法不打印任何输出，而是使用 grep 的退出代码查看我是否找到了字符串。如果你的系统不走`grep -q`，你可以试试`grep "regex" > /dev/null 2>&1`。

同样，`file`命令的输出可能因系统而异，因此您必须验证这些是否可以在您的系统上运行。另外，我正在检查可执行位。如果文件是二进制可执行文件，但可执行位未打开，我会说它不可执行。这可能不是你想要的。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-09-14T11:17:55.410

似乎没有人注意到`-x`操作员不会将文件与目录不同。

因此，要精确检查可执行文件，您可以使用 `[[ -f SomeFile && -x SomeFile ]]`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-04-07T13:20:41.387

## 测试文件、目录和符号链接

此处给出的解决方案在目录或符号链接（或两者）上都失败。在 Linux 上，您可以使用以下命令测试文件、目录和符号链接：

```
if [[ -f "$file" && -x $(realpath "$file") ]]; then .... fi 
```

在 OS X 上，您应该能够使用 homebrew 安装 coreutils 并使用`grealpath`.

## 定义一个`isexec`函数

为方便起见，您可以定义一个函数：

```
isexec() {
    if [[ -f "$1" && -x $(realpath "$1") ]]; then
        true;
    else
        false;
    fi;
} 
```

或者干脆

```
isexec() { [[ -f "$1" && -x $(realpath "$1") ]]; } 
```

然后您可以使用以下方法进行测试：

```
if `isexec "$file"`; then ... fi 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-12-03T06:04:35.477

似乎也没有人注意到符号链接上的 -x 运算符。指向常规文件（未归类为可执行文件）的符号链接（链）未通过测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-19T11:13:45.653

首先你需要记住，在 Unix 和 Linux 中，一切都是文件，甚至是目录。一个文件要具有作为命令执行的权限，它需要满足 3 个条件：

1.  它需要是一个常规文件
2.  它需要具有读取权限
3.  它需要有执行权限

所以这可以通过以下方式简单地完成：

```
[ -f "${file}" ] && [ -r "${file}" ] && [ -x "${file}" ] 
```

如果您的文件是指向常规文件的符号链接，则 test 命令将对目标而不是链接名称进行操作。所以上面的命令区分文件是否可以用作命令。因此，无需先将文件传递给这些变体`realpath`或`readlink`任何变体。

如果文件可以在当前操作系统上执行，那就是另一个问题了。上面的一些答案已经指出了一些可能性，因此无需在此重复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-04T07:15:19.163

这可能不是那么明显，但有时需要测试可执行文件以在没有外部 shell 进程的情况下适当地调用它：

```
function tkl_is_file_os_exec()
{
  [[ ! -x "$1" ]] && return 255

  local exec_header_bytes
  case "$OSTYPE" in
    cygwin* | msys* | mingw*)
      # CAUTION:
      #   The bash version 3.2+ might require a file path together with the extension,
      #   otherwise will throw the error: `bash: ...: No such file or directory`.
      #   So we make a guess to avoid the error.
      #
      {
        read -r -n 4 exec_header_bytes 2> /dev/null < "$1" ||
        {
          [[ -x "${1%.exe}.exe" ]] && read -r -n 4 exec_header_bytes 2> /dev/null < "${1%.exe}.exe"
        } ||
        {
          [[ -x "${1%.com}.com" ]] && read -r -n 4 exec_header_bytes 2> /dev/null < "${1%.com}.com"
        }
      } &&
      if [[ "${exec_header_bytes:0:3}" == $'MZ\x90' ]]; then
        # $'MZ\x90\00' for bash version 3.2.42+
        # $'MZ\x90\03' for bash version 4.0+
        [[ "${exec_header_bytes:3:1}" == $'\x00' || "${exec_header_bytes:3:1}" == $'\x03' ]] && return 0
      fi
    ;;
    *)
      read -r -n 4 exec_header_bytes < "$1"
      [[ "$exec_header_bytes" == $'\x7fELF' ]] && return 0
    ;;
  esac

  return 1
}

# executes script in the shell process in case of a shell script, otherwise executes as usual
function tkl_exec_inproc()
{
  if tkl_is_file_os_exec "$1"; then
    "$@"
  else
    . "$@"
  fi
  return $?
} 
```

**myscript.sh**：

```
#!/bin/bash

echo 123

return 123 
```

**在 Cygwin 中**：

```
> tkl_exec_inproc /cygdrive/c/Windows/system32/cmd.exe /c 'echo 123'
123
> tkl_exec_inproc /cygdrive/c/Windows/system32/chcp.com 65001
Active code page: 65001
> tkl_exec_inproc ./myscript.sh
123
> echo $?
123 
```

**在 Linux 中**：

```
> tkl_exec_inproc /bin/bash -c 'echo 123'
123
> tkl_exec_inproc ./myscript.sh
123
> echo $?
123 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-18T11:47:18.130

测试文件本身是否`ACL_EXECUTE`在任何权限集（用户、组、其他）中设置了位，无论它位于何处，即。e. 即使在 带有 **noexec**选项的**tmpfs**上，也可以使用来获取权限字符串，然后检查它是否至少包含一个“x”字母：**`stat -c '%A'`**

 **```
if [[ "$(stat -c '%A' 'my_exec_file')" == *'x'* ]] ; then
    echo 'Has executable permission for someone'
fi 
```

比较的右侧部分可以修改以适应更具体的情况，例如`*x*x*x*`检查是否所有类型的用户都应该能够执行文件，当它被放置在使用 *exec*选项挂载的卷上时。**

# c++ - Arduino上的意外程序停止

> ID：10319655
> 
> 赞同：2
> 
> 时间：2012-04-25T16:16:47.130
> 
> 标签：c++, arduino, microcontroller

我有一个问题，我的 Arduino 程序无缘无故挂起。我运行我的程序，在某个未确定的时间点，串行监视器停止打印输出。这是我到目前为止测试过的内容：

*   在我的“com.init_drone()”方法中，除了最后一行，我已将所有内容都注释掉，这表明该方法已返回。当我这样做时，我的程序挂在其他地方，但它仍然没有进入无限的 while 循环。
*   我一直在输出内存使用情况，我得到的数字不低于 450——这告诉我我没有使用荒谬的内存量。
*   我已经尝试删除对程序没有影响的 Timer1 实例化、中断附加/分离、bu。

我的[.ino 文件（和命令）位于此处](https://github.com/hwrdprkns/SeniorProject/blob/timerTroubles/ATCommand/)，供任何想要更全面的图片并且不想滚动浏览我将在下面发布的所有代码的人使用。

* * *

到目前为止，这是我的日志输出。**注意截断！**：

```
AT&F
AT+NMAC=00:1d:c9:10:39:6f
AT+WM=0
AT+NDHCP=1
AT+WA=ardrone_279440
AT+NCUDP=192.168.1.1,5556
S0AT*CONFIG=1,"general:navdata_demo","TRUE"
EAT*CONFIG=1,"general:navdata_demo","TRUE"

638
S0AT*CONFIG=2,"control:altitude_max","2000"
EAT*CONFIG=2,"control:altitude_max","2000"

638
S0AT*CONFIG=3,"control:euler_angle_max","0.35"
EAT*CONFIG=3,"control:euler_angle_max","0.35"

586
S0AT*CONFIG=4,"control:outdoor","FALSE"
EAT*CONFIG=4,"control:outdoor","FALSE"

635
S0AT*CONFIG=5,"control:flight_without_shell","FALSE"
EAT*CONFIG=5,"control:flight_without_shell","FALSE"

574
S0AT*CTRL=6,4,0
吃*CTRL=6,4,0

629
S0AT*CTRL=7,0,0
吃*CTRL=7,0,0

629
S0AT*CTRL=8,4,0
吃*CTRL=8,4,0

629
S0AT*COMWDG=9
吃*COMWDG=9

629
S0AT*COMWDG=10
吃*COMWDG=10

629
S0AT*COMWDG=11
吃*COMWDG=11

629
S0AT*COMWDG=12
吃*COMWDG=12

629
S0AT*COMWDG=13
吃*COMWDG=13

629
S0AT*FTRIM=14
吃*FTRIM=14

629

```

这是我的 .ino 文件：

```
#include "Command.h"
#include "Streaming.h"

int debug = 1;
extern ring_buffer rx_buf;
extern resultint_ resultint;

Command com;
int sequenceNumber = 1;
String atcmd = "";

#include "TimerOne.h"
#define LEDpin 13

void setup()
{
  PCsrl.begin(9600);

  com.start_wifi_connection();

  com.drone_is_init = com.init_drone();

  Timer1.initialize(COMWDG_INTERVAL_USEC);
  Timer1.attachInterrupt(watchdog_timer);

}

void watchdog_timer() {
  com.sendwifi(com.makeComwdg());
}

void loop()
{  

  if (com.drone_is_init == 0) {
        if (debug) {
      // never use three ! together in arduino code
      PCsrl.println("Drone wasn't initlized before loop() was called. Initalizing now.\r\n");
    }

  } else {

    com.drone_takeoff();
    com.drone_takeoff();

    com.sendwifi(com.makePcmd(1,0,0,0,0));
    com.sendwifi(com.makePcmd(1,0,0,0,0));
    delay(5000);

    com.moveForward(1);
    com.moveRotate(180);
    com.moveForward(1);
    com.moveRotate(180);

    delay(500);

    com.drone_landing();
    com.drone_landing();

    delay(500);

    //end of program
    Timer1.detachInterrupt();
    PCsrl.println("Program finished");
    while (1){};

  }
} 
```

还有我的 Command.cpp

```
#ifndef GAINSPAN
#define GAINSPAN
#include "Command.h"

extern int sequenceNumber;
extern int debug;

ring_buffer rx_buf= {{0}, 0, 0};
resultint_ resultint;

Command::Command()
{
  at = "";
  command = "";
  s2ip_running = 0;
  drone_is_init = 0;
  drone_is_hover = 0;
  emergency = 0;
}

void Command::sendwifi(String s) {

    WIFIsrl.write(27); //esc
    WIFIsrl.print("S0"); //choose connection CID 0
    WIFIsrl.print(s);
    WIFIsrl.write(27);
    WIFIsrl.print("E");

    if(debug) PCsrl.println(s);

    WIFIsrl.println(memoryTest()); 
}

int Command::start_wifi_connection()
{
  WIFIsrl.begin(9600);

  WIFIsrl.println("");
  WIFIsrl.println("AT&F");
  //WIFIsrl.println("ATE0"); //turn off echo
  WIFIsrl.print("AT+NMAC=00:1d:c9:10:39:6f\r"); //set MAC address
  WIFIsrl.println("AT+WM=0");

  WIFIsrl.println("AT+NDHCP=1");

  /* drone's network profile, change if needed*/
  WIFIsrl.println("AT+WA=ardrone_279440");
  WIFIsrl.println("AT+NCUDP=192.168.1.1,5556");
  readARsrl();

  delay(3000); //need 3 seconds for connection to establish
  return 0;
}  

String Command::makeComwdg()
{
  at = "AT*COMWDG=";
  command = at + getSequenceNumber() + "\r\n";
  return command;
}

void Command::sendComwdg_t(int msec)
{
  for (int i = 0; i < msec; i+=20) {
    sendwifi(makeComwdg());
    delay(20);
  }
}

void Command::sendFtrim()
{
  at = "AT*FTRIM=";
  command = at + getSequenceNumber() + "\r\n";
  sendwifi(command);
}

void Command::sendConfig(String option, String value)
{
  at = "AT*CONFIG=";
  command = at + getSequenceNumber() + ",\"" + option + "\",\"" + value + "\"\r\n";
  sendwifi(command);
}

void Command::sendRef(flying_status fs)
{
  at = "AT*REF=";
  if(fs == TAKEOFF){
    command = at + getSequenceNumber() + ",290718208\r\n"; //takeoff
  }
  else if(fs == LANDING){
    command = at + getSequenceNumber() + ",290717696\r\n"; //landing
  } else if (fs == EMERGENCY_TOGGLE){
    command = at + getSequenceNumber() + ",290717952\r\n"; //landing
  }

  // emergency -> 290717952
  sendwifi(command);
}

void Command::send_control_commands(){
    at = "AT*CTRL=";
    sendwifi(at+getSequenceNumber()+",4,0\r\n");
    sendwifi(at+getSequenceNumber()+",0,0\r\n");
    sendwifi(at+getSequenceNumber()+",4,0\r\n");
}

void Command::drone_emergency_reset()
{
  at = "AT*REF=";
  command = at + getSequenceNumber() + ",290717952\r\n";
  sendwifi(command);
}

/** Movement functions **/
int Command::moveForward(float distanceInMeters)
{
  float i = 0;
  String moveForward = makePcmd(1, 0, -.855, 0, 0);
  delay(1000*distanceInMeters);
  sendPcmd(moveForward);
  return 1;
}

int Command::moveRotate(float yawInDegrees)
{
  int i = 0;
  while (i < yawInDegrees) {
    String stayRotate = makePcmd(1, 0, 0, 0, 0.17);
    sendPcmd(stayRotate);
    delay(150);
    i += 8;
  }
  return 1;
}

String Command::makePcmd(int enable, float roll, float pitch, float gaz, float yaw)
{
  at = "AT*PCMD=";
  command = at + getSequenceNumber() + "," + enable + "," + fl2int(roll) + "," + fl2int(pitch) + "," + fl2int(gaz) + "," + fl2int(yaw) + "\r";
  return command;
}

void Command::sendPcmd(String command)
{
  previousCommand = command;
  sendwifi(command);
}

void Command::sendPcmd(int enable, float roll, float pitch, float gaz, float yaw)
{
  at = "AT*PCMD=";
  command = at + getSequenceNumber() + "," + enable + "," + fl2int(roll) + "," + fl2int(pitch) + "," + fl2int(gaz) + "," + fl2int(yaw) + "\r";
  sendwifi(command);
}

String Command::makeAnim(anim_mayday_t anim, int time)
{
  at = "AT*ANIM=";
  command = at + getSequenceNumber() + "," + anim + "," + time + "\r\n";
  return command;
}

void Command::doLEDAnim(int animseq, int duration)
{
  PCsrl << "calling LEDAnim" << endl;
  at = "AT*LED=";
  command = at + getSequenceNumber() + "," + animseq + ",1073741824," + duration + "\r\n";
  sendwifi(command);
}

int Command::start_s2ip()
{
  char temp;
  //delay(20000); //wait for drone to start

  readARsrl();

  if (debug) {
    PCsrl << "trying to start s2ip" << endl;
  }

  ARsrl.print("\r\n");
  delay(500);
  ARsrl.print("\r\n");
  delay(500);
  ARsrl << "cd ~" << endl;

  if (debug) {
    readARsrl();
  }

  delay(500);
  ARsrl << "cd data/video/apps/" << endl;
  delay(500);
  ARsrl << "./s2ip.arm" << endl; 
  while ((int) temp != 2) {
    temp = ARsrl.read();
    if (temp == 2) {
      PCsrl << "s2ip is running" << endl;
      ARsrl << "bullshit\r\n"; //to fix a delay bug
      break;
    }
    //PCsrl << "s2ip not running" << endl;
  }
  if (debug) {
    while (ARsrl.available()) {
      PCsrl.write(ARsrl.read());
    }
  }
  return 1;
}

void Command::quit_s2ip()
{
  ARsrl.println("EXIT");
  while (ARsrl.available()) {
    PCsrl.write(ARsrl.read()); 
  }
}

int Command::init_drone()
{
  sendConfig("general:navdata_demo","TRUE");
  sendConfig("control:altitude_max","2000");
  sendConfig("control:euler_angle_max","0.35");
  sendConfig("control:outdoor","FALSE");
  sendConfig("control:flight_without_shell","FALSE");
  send_control_commands();
  sendComwdg_t(90);
  sendFtrim();

  drone_emergency_reset(); //clear emergency flag

  return 1;
}

int Command::drone_takeoff()
{
  sendRef(TAKEOFF);
  int i = 0;
  return 1;
}

int Command::drone_hover(int msec)
{
  int i = 0;
  while (i < msec) {
    sendwifi(makePcmd(1, 0, 0, 0, 0));
    delay(100);
    i += 100;
  }
  return 1;
}

int Command::drone_landing()
{
  sendRef(LANDING);
  return 1;
}

int Command::drone_move_up(int centimeter)
{
  int i = 0;
  while (i < centimeter) {
    ARsrl << makePcmd(1, 0, 0, 0.6, 0);
    delay(100);
    i += 10;
  }
  return 1;
}

int Command::drone_move_down(int centimeter)
{
  int i = 0;
  while (i < centimeter) {
    sendwifi(makePcmd(1, 0, 0, -0.5, 0));
    delay(100);
    i += 10;
  }
  return 1;
}

long Command::fl2int(float value)
{
  resultint.i = 0;
  if (value < -1 || value > 1) {
    resultint.f = 1;
  } else {
    resultint.f=value;
  }

  return resultint.i;
}

void Command::readARsrl()
{
  while (ARsrl.available()) {
    if (debug) {
      PCsrl.write(ARsrl.read());
    }
  }
}

//Memory test code from : http://www.faludi.com/2007/04/18/arduino-available-memory-test/
int Command::memoryTest() {
  int byteCounter = 0; // initialize a counter
  byte *byteArray; // create a pointer to a byte array
  // More on pointers here: http://en.wikipedia.org/wiki/Pointer#C_pointers

  // use the malloc function to repeatedly attempt
  // allocating a certain number of bytes to memory
  // More on malloc here: http://en.wikipedia.org/wiki/Malloc
  while ( (byteArray = (byte*) malloc (byteCounter * sizeof(byte))) != NULL ) {
    byteCounter++; // if allocation was successful, then up the count for the next try
    free(byteArray); // free memory after allocating it
  }

  free(byteArray); // also free memory after the function finishes
  return byteCounter; // send back the highest number of bytes successfully allocated
}

int Command::getSequenceNumber(){
  return sequenceNumber++;
}

// Volatile, since it is modified in an ISR.
volatile boolean inService = false;

void SrlRead()
{
  if (inService) {
    PCsrl.println("timer kicked too fast");
    return;
  }
  interrupts();
  inService = true;
  while(ARsrl.available()) {
    unsigned char k = ARsrl.read();
    store_char(k, &rx_buf);
  }
  inService = false;
}

void read_rx_buf()
{
  while (rx_buf.tail != rx_buf.head) {
    if (debug) {
      PCsrl.write(rx_buf.buffer[rx_buf.tail]);
    }
    rx_buf.tail = (unsigned int) (rx_buf.tail+ 1) % SERIAL_BUFFER_SIZE;
  }
}

inline void store_char(unsigned char c, ring_buffer *buffer)
{
  int i = (unsigned int)(buffer->head + 1) % SERIAL_BUFFER_SIZE;

  // if we should be storing the received character into the location
  // just before the tail (meaning that the head would advance to the
  // current location of the tail), we're about to overflow the buffer
  // and so we don't write the character or advance the head.
  if (i != buffer->tail) {
    buffer->buffer[buffer->head] = c;
    buffer->head = i;
  }
  else {
    Serial.println("ring buffer is too small");
  }
}

#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T03:48:50.053

我知道这听起来很奇怪，但是有时当 arduino 没有获得足够的电源时会发生这种情况。尝试将 arduino 连接到不同于 USB 的电源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T12:32:51.997

一旦我开始把东西放在`prog`内存中，我的程序就开始清理它的打嗝。似乎是内存问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T16:07:35.620

我有同样的问题，但问题出在`Timer1.initialize()`. 尝试这个：

```
 com.drone_is_init = com.init_drone();

  Serial.println("One");
  Serial.println("Two");
  Serial.println("Three");

  Timer1.initialize(COMWDG_INTERVAL_USEC);
  Timer1.attachInterrupt(watchdog_timer); 
```

打开串口监视器，看看……它会一直显示到“Two”，然后 Arduino 就会挂起。

问题是我调用了 LiquidCrystal_I2C 库的一些函数，这些函数需要中断例程。检查你的定时器 ISR 是否使用了一些中断。如果是这样，您应该将此代码移动到项目中的另一个位置。

# jquery - jquery each + $.get 不起作用

> ID：10319656
> 
> 赞同：4
> 
> 时间：2012-04-25T16:16:52.813
> 
> 标签：jquery, ajax

我正在用法语做一个类似 Reddit 的网站，为了完全优化我正在获取结果，缓存它，然后通过 jQuery 查询每个链接以查看它们是否被否决/赞成。

1.  您如何看待优化查询？

2.  为什么它不起作用！这是我的代码。

HTML：

```
 <div class="box ajax_div" title="3">
        <div class="score">
            <a href="#" class="upvote_position" title="post-up-3"><img src="images/up.png" /></a>
            <div class="score_position">1</div>
            <a href="#" class="downvote_position" title="post-down-3"><img src="images/down.png" /></a>
    </div>

    <div class="box_info">
        <div class="link">
            <a href="#" class="text-show"><a href="?show=3" rel="nofollow" class="out">ouioui</a> 
        </div>
        <div class="further">
            <span class="date" title="2012-04-25 04:57:05">il y a 13 heures</span> | posté par <a href="?user=david">david</a> dans <a href="?chan=100hp.fr">100hp.fr</a>
        </div>
        <div class="further_more">
            <a href="?show=3"><img src="images/comment.png" />2 commentaires</a> <a href="#" class="save" title="3"><img src="images/save.png" />sauvegarder le lien</a> <a href="#" class="spam" title="3"><img src="images/report.png" />spam?</a>
        </div>
    </div>
    <div class="textbox" style="display:none;">razraz</div>
    </div> 
```

JavaScript：

```
 $(".box").each(function(index){
        ele = $('.box').eq(index);
        $.get("ajax/score.php",
        { idbox: ele.attr('title'), type: "post" },
        function(data) {
            ele.find(".score_position").html(data);
        });
    }); 
```

我有多个这样的盒子，它只影响最后一个。我首先尝试不使用索引和 eq(index)，它做同样的事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T16:19:47.197

您覆盖`ele`全局变量，尝试添加`var`：

```
$(".box").each(function(index){
    var ele = $('.box').eq(index);
    $.get("ajax/score.php",
    { idbox: ele.attr('title'), type: "post" },
    function(data) {
        ele.find(".score_position").html(data);
    });
}); 
```

这样做的另一个改进是使用`.each()`执行回调的上下文。这会稍微加快您的脚本速度，因为不需要再次评估选择器，您只需将 DOM 元素 ( `this`) 包含在`jQuery`对象中：

```
$(".box").each(function(index){
    var ele = $(this);
    $.get("ajax/score.php",
    { idbox: ele.attr('title'), type: "post" },
    function(data) {
        ele.find(".score_position").html(data);
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:24:36.170

请求是异步的`.get`，这意味着一旦调用它就不会阻塞代码执行。

实际上，`ele`不是您认为`.get`最终调用回调时的元素（它可能是 的最后一个元素`.box`）。

要克服这个问题，请尝试在没有变量的情况下定位元素，该变量在循环的每次迭代中都会更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:23:43.217

jquery 的 each 函数在 "each" 中提供了两个参数

$('...').each(function(index, value) {...});

只需使用第二个参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-11T10:33:07.620

I had the same issue. @Blender gave me the initial idea so: thanks.

My solution was to use:

```
$.ajax({
url: "myExample.html",
context: this //"this" refer to the outer-context "this" & not the internal $ajax "this"
}).done(function() {
//do all the stuff you need to do, it will then be executed in the right order
}); 
```

In my case if I don't do it that way, the rest of my code finishes so much quicker than the returned $.ajax call. It doesn't matter if I use a global variable.

UPDATE:

When using $.ajax, there are only 2 sockets available from the browser to run the requests. If you have many requests (over 500) this will cause the browser (I use Chrome) to hang because the requests add up but can't be handled on time. After some time you will get connection errors from the server.

The solution: Use an AJAX queue manager. I used [http://plugins.jquery.com/ajaxQueue/](http://plugins.jquery.com/ajaxQueue/)

So now my code is slightly different (only had to replace $.ajax with jQuery.ajaxQueue):

```
jQuery.ajaxQueue({
url: "myExample.html",
context: this //"this" refer to the outer-context "this" & not the internal $ajax "this"
}).done(function() {
//do all the stuff you need to do, it will then be executed in the right order
}); 
```

Hope this will help future generations :-)

# function - 这个函数或模式有名字吗？

> ID：10319659
> 
> 赞同：16
> 
> 时间：2012-04-25T16:17:07.063
> 
> 标签：function, haskell, typeclass

而不是`fmap`, 将函数应用于函子中的值：

```
fmap :: Functor f => (a -> b) -> f a -> f b 
```

我需要一个函数，其中仿函数具有函数并且值很简单：

```
thing :: Functor f => f (a -> b) -> a -> f b 
```

但我[找不到一个](http://www.haskell.org/hoogle/?hoogle=Functor%20f%20=%3E%20f%20%28a%20-%3E%20b%29%20-%3E%20a%20-%3E%20f%20b)。

这种模式叫什么，我将函数中的函子（或应用程序，或单子）应用于普通值？

[[我已经实现了它，我只是不太明白我做了什么以及为什么标准库中还没有这样的功能。]]

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-25T16:52:00.810

你不需要`Applicative`这个；`Functor`会做得很好：

```
apply f x = fmap ($ x) f
-- or, expanded:
apply f x = fmap (\f' -> f' x) f 
```

有趣的`apply`是，实际上是对`flip`; [lambdabot](http://www.haskell.org/haskellwiki/Lambdabot)将此定义替换`flip`为标准 Haskell 的概括之一，因此这是一个可能的名称，尽管令人困惑。

顺便说一句，通常值得尝试[Hayoo](http://holumbus.fh-wedel.de/hayoo/hayoo.html)（它搜索整个 Hackage，与 Hoogle 不同）来查看函数经常给出的名称，以及它是否在任何通用包中。搜索[`f (a -> b) -> a -> f b`](http://holumbus.fh-wedel.de/hayoo/hayoo.html?query=f%20%28a%20-%3E%20b%29%20-%3E%20a%20-%3E%20f%20b&start=0)，它找到`flip`(in [`Data.Functor.Syntax`](http://hackage.haskell.org/packages/archive/functors/latest/doc/html/Data-Functor-Syntax.html), from the [`functors`](http://hackage.haskell.org/package/functors)package) 和`($#)`(from the [`synthesizer`](http://hackage.haskell.org/package/synthesizer)package) 作为可能的名称。不过，我可能只是`fmap ($ arg) f`在使用现场使用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-25T16:30:41.030

正如 Niklas 所说，这是在一些应用函子中对提升值的应用。

```
\f a -> f <*> pure a

:: Applicative f => f (a -> b) -> a -> f b 
```

或更一般地（？），使用[类别](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Category.html) `(.)`

```
\f a -> f . pure a

:: (Applicative (cat a), Category cat) => cat b c -> b -> cat a c 
```

# arrays - 计算数组中后续组的数量

> ID：10319661
> 
> 赞同：1
> 
> 时间：2012-04-25T16:17:21.397
> 
> 标签：arrays, delphi

这个问题可能看起来有点晦涩难懂，但我会尝试用外行的话来分解它。

假设我有一个包含 24 个`Byte`值的数组，仅包含`0`or `1`：

```
011000100000001000000111 
```

该数组在逻辑上分为每组四个值的组，这给了我们：

```
0110 0010 0000 0010 0000 0111 
```

现在，我想数一数，有多少后续组将**至少**一个值设置为`1`. 在我提供的示例中，我们有`2`后续组。

我应该如何以编程方式进行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T17:53:59.347

基于 Arnaud 的回答，它有正确的想法，但实际上并没有按照 OP 的要求做：

```
function CountNonNullGroupSequenceLength(Values: PByte; ValuesCount: integer): integer;
var Groups: PIntegerArray;
    i, counter: integer;
begin
  Groups := Values;
  result := 0;
  counter := 0;
  for i := 0 to (ValuesCount shr 2)-1 do
    if Groups[i]<>NULLGROUP then
      inc(counter)
    else begin
      result := max(result, counter);
      counter := 0;
    end;
  result := max(result, counter);
end; 
```

确保放入`Math`您的**使用**列表，以便您可以获得该`Max`功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:27:41.590

由于一个组是 4 个字节，这就像将 4 个字节类型转换为一个整数。

例如：

```
const
  NULLGROUP = 0;

function CountNonNullGroups(const Values: TByteArray): integer;
var Groups: TIntegerArray absolute Values;
    i: integer;
begin
  result := 0;
  for i := 0 to (length(Values) shr 2)-1 do
    if Groups[i]<>NULLGROUP then
      inc(result);
end; 
```

或者用指针：

```
function CountNonNullGroups(Values: PByte; ValuesCount: integer): integer;
var Groups: PIntegerArray;
    i: integer;
begin
  Groups := Values;
  result := 0;
  for i := 0 to (ValuesCount shr 2)-1 do
    if Groups[i]<>NULLGROUP then
      inc(result);
end; 
```

# c# - C# 网络服务。需要可转换为“字符串”

> ID：10319665
> 
> 赞同：2
> 
> 时间：2012-04-25T16:17:35.287
> 
> 标签：c#, web-services

我正在为我的 .svc webservice 创建一个调解器，但我被困住了。它一直给我一个错误

> 需要可转换为“字符串”类型的对象

我不知道我必须返回什么。那么这是我的代码。

```
var proxy = SomeProxy();
try
{
    var contact = proxy.FindContactByLogin("0002221111", "test123", false);
    if (contact.Result != SomeService.Results.Succeeded)
    {
        Assert.Fail(string.Join(Environment.NewLine, contact.Errors.ToString()));
        return;
    }

    var result = proxy.GetAccountsListByContactID(contact.Value.ID);
    if (result.Result == SomeService.Results.Succeeded)
    {
        Console.WriteLine(result.Value);
    }
    else
    {
        foreach (string error in result.Errors)
            return error;

            //Console.WriteLine(error);
    }
}
finally
{
    proxy.Close();
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:32:26.313

您应该能够调试以确定代码失败的确切位置。

1.  您的 try 块没有捕获。那就是你的处理应该去的地方。
2.  该错误表明您正在尝试进行字符串转换。可能是第`contact.Errors.Tostring()`6 行的电话

# ios - Cocos2d：似乎无法使用类或实例方法正确创建子精灵

> ID：10319666
> 
> 赞同：0
> 
> 时间：2012-04-25T16:17:48.490
> 
> 标签：ios, methods, cocos2d-iphone, instance, sprite

昨天我发了一个类似的帖子，但几乎没有收到任何回复，可能是因为缺乏细节。我会更彻底。

所以我一直在清理我的类（JoinedMapsLayer），其中添加了我的 tmx 地图并运行更新、绘制等。我尝试将一些方法添加到其他类但没有完全成功。有些创建精灵并成功地在屏幕上显示它们，但 JoinedMapsLayer 似乎无法再识别它们，即使它们来自它的头文件。因此，我不能使用 JoinedMapsLayer 或其他一些类来删除它。我尝试在添加断点后设置断点（无论添加到何处），然后在控制台中键入 po [spritename] ，结果为零。

也许我只是不明白这应该如何完全工作，我必须采取错误的方法。如果有人可以帮助我一劳永逸地理解这一点，将不胜感激！

我遇到了一个很好的例子，我又一次没有成功。这个根本没有出现。

在这里，我可以向您展示我曾经拥有的东西，效果很好：

(in .h) JoinedMapsLayer 的界面我有：

```
CCSprite *selectionScreenOverlaySprite;
CCSpriteBatchNode * selectionScreenOverlaySpriteSheet; 
```

我的属性：

```
@property(nonatomic, retain) CCSprite *selectionScreenOverlaySprite;
@property(nonatomic, retain) CCSpriteBatchNode *selectionScreenOverlaySpriteSheet; 
```

声明方法：

```
-(void) addSelectionScreenOverlay; 
```

（以 .m 为单位）我综合了我的属性：

```
@synthesize selectionScreenOverlaySprite, selectionScreenOverlaySpriteSheet; 
```

我的方法：

```
-(void) addSelectionScreenOverlay {

    // overlay

    [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"selectionScreenOverlay.plist"];

    selectionScreenOverlaySpriteSheet = [CCSpriteBatchNode batchNodeWithFile:@"selectionScreenOverlay.png"];

    NSMutableArray *selectionScreenFrames = [NSMutableArray array];

    [selectionScreenFrames addObject:
     [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
      [NSString stringWithFormat:@"selectionScreenOverlay.png"]]];

    selectionScreenOverlaySprite = [CCSprite spriteWithSpriteFrameName:[NSString stringWithFormat:@"selectionScreenOverlay.png"]];  

    [selectionScreenOverlaySpriteSheet addChild:selectionScreenOverlaySprite];

    [self addChild:selectionScreenOverlaySpriteSheet z:13];

    selectionScreenOverlaySprite.position = [self convertToNodeSpace:CGPointMake(512, 384)];
    selectionScreenOverlaySprite.scale = 260;

    selectionScreenOverlaySprite.opacity = 0;

} 
```

所以效果很好...

* * *

但是当我在我的头文件中导入一个名为 SpriteFX.h 的类并调用新方法时，什么也没有发生？？？

我像这样调用类方法：

```
[SpriteFX addSelectionScreenOverlayOnLayer:self
                                withSprite:selectionScreenOverlaySprite
                           withSpriteSheet:selectionScreenOverlaySpriteSheet]; 
```

我在 SpriteFX.h 中声明了这样的方法：

```
+(void) addSelectionScreenOverlayOnLayer:(CCLayer*)layer
                              withSprite:(CCSprite*)sprite
                         withSpriteSheet:(CCSpriteBatchNode*)spriteSheet; 
```

我在 SpriteFX.m 中的方法如下所示：

```
+(void) addSelectionScreenOverlayOnLayer:(CCLayer*)layer
                              withSprite:(CCSprite*)sprite
                         withSpriteSheet:(CCSpriteBatchNode*)spriteSheet {

    [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:@"selectionScreenOverlay.plist"];

    spriteSheet = [CCSpriteBatchNode batchNodeWithFile:@"selectionScreenOverlay.png"];

    NSMutableArray *selectionScreenFrames = [NSMutableArray array];

    [selectionScreenFrames addObject:
     [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
      [NSString stringWithFormat:@"selectionScreenOverlay.png"]]];

    sprite = [CCSprite spriteWithSpriteFrameName:[NSString stringWithFormat:@"selectionScreenOverlay.png"]];  

    [spriteSheet addChild:sprite];

    [layer addChild:spriteSheet z:13];

    sprite.position = [layer convertToNodeSpace:CGPointMake(512, 384)];
    sprite.scale = 260;

    sprite.opacity = 0;
} 
```

没有豆子

如果我理解正确，因为我将 self 作为 CCLayer 传递，那么我的类方法中的层应该指向 JoinedMapsLayer 中的 CCLayer。此外，传递的精灵和精灵表应该指向 JoinedMapsLayer，所以它应该可以正常工作.. 但事实并非如此。

在 JoinedMapsLayer 中调用类方法后，我检查了 selectionScreenOverlaySprite 上的父对象。它是零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T23:44:56.153

那么在您的第一段代码中，您没有正确访问属性。您应该使用 self 指针来获取属性...在您的代码中，您只是直接访问 ivar。现在有了 ARC，理论上它应该在 ivar 上进行正确的保留/释放，但仍然如此。

```
self.selectionScreenOverlaySpriteSheet = [CCSpriteBatchNode batchNodeWithFile:@"selectionScreenOverlay.png"]; 
```

在您的第二个示例中， spriteSheet 是传入方法的参数，您会在第二行立即用新值覆盖该方法，因此 spriteSheet 中的任何内容现在都丢失了。这取决于代码的其余部分可能会或可能无关紧要，但是无论谁调用您的共享方法，都无法引用精灵表。

如果您在 ARC 上，那么运行时可能会在调用 addChild 之后立即释放 spriteSheet。我不熟悉这些引用是如何在 cocos2d 中设置的，但如果它们很弱或没有保留，那么这也可能是一个问题。

# java - 将两张地图合并为第三张

> ID：10319668
> 
> 赞同：0
> 
> 时间：2012-04-25T16:17:54.677
> 
> 标签：java, map, hashmap

我有两张地图：

*   s1 有键：1,3,5,7
*   s2 有键：2,4,6

我想创建第三个映射，它将保存来自上面映射的键值对，以便一次从上面两个映射中交替获取键值对。所以第三个映射将形成键为 1,2,3,4,5,6,7。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:24:17.143

```
s3 = new HashMap();
s3.putAll(s1);
s3.putAll(s2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:21:11.830

您可以使用自动对键进行排序的 TreeMap，并使用该`putAll`方法将原始映射的键/值对添加到新映射中。

# c# - 在 DatagridView 中添加/删除/选择 ComboBox 的值

> ID：10319674
> 
> 赞同：3
> 
> 时间：2012-04-25T16:18:22.577
> 
> 标签：c#, datagridview, datagridviewcombobox

我正在尝试为各种格式和字段的文件自动执行数据处理任务。我创建了一个程序来确定分隔文件的分隔符，并将文件的一部分加载到表单上的 DataGridView 中，以便用户可以在文件被批量加载到 SQL 表之前确认文件的某些字段. 该表将使用用户在数据网格的组合框中选择的一些字段名称即时创建。

这是我的目标，但我不确定我是否正确地解决了这个问题。

此时，我已经为组合框创建了一个 BindingSource ...

```
BindingSource bindingSource = new BindingSource(); 
```

这里我展示了选中文件的DataGridView，为数据文件中的每个字段添加一列

```
 private void ShowDataGridView(string file, string delimiter, string[] fieldNames, string[] fieldLengths)
    {
        StreamReader fileReader = new StreamReader(file);
        if (bindingSource.Count == 0)
        {
            bindingSource.Add("FIRSTNAME");
            bindingSource.Add("LASTNAME");
            bindingSource.Add("ADDRESS1");
            bindingSource.Add("ADDRESS2");
            bindingSource.Add("CITY");
            bindingSource.Add("STATE");
            bindingSource.Add("ZIP");
            bindingSource.Add("COMPANY");
            bindingSource.Add("EMAIL");
            bindingSource.Add("");
        }           
        dataGridView1.Rows.Clear();
        dataGridView1.Columns.Clear();
        int count = 0;
        for (int i = 0; i < 17; i++)  //read 17 lines into datagridview for field confirmation, 17 lines just so happens to fill my datagridview nicely, last row will be combobox for field name selection
        {
            string[] fields = StringFunctions.Split(fileReader.ReadLine(), delimiter, Convert.ToString("\""));
            count = fields.Count();
            if (i == 0)
            {
               // Adding Column Header to DataGridView
                for (int x = 0; x < count; x++)
                {
                    DataGridViewTextBoxColumn columnDataGridTextBox = new DataGridViewTextBoxColumn();
                    columnDataGridTextBox.Name = fieldNames[x];
                    columnDataGridTextBox.HeaderText = fieldNames[x];
                    dataGridView1.Columns.Add(columnDataGridTextBox);
                }
            }
            dataGridView1.Rows.Add(fields);
        }

        for (int x = 0; x < count; x++)
        {
            DataGridViewComboBoxCell combobox = new DataGridViewComboBoxCell();             
            combobox.DataSource = bindingSource;
            dataGridView1[x, 16] = combobox;  //remember 17 rows added, combobox will be last row in datagridview
            combobox = null;
        }
        dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.AllCells;

        fileReader.Close();
        fileReader = null;
    } 
```

好的，现在我可以查看数据，以及所有数据字段的组合框。某些字段是必需的（BindingSource 字段名称）我希望用户能够从组合框中为数据列选择适当的字段名称。当用户从组合框中选择了一个字段时，我想从 BindingSource 中删除该字段名称，因此用户不能为另一列选择相同的字段名称。其余字段将具有默认字段名称，例如（FirstName、Field2、LastName、Address1、Field5、Field6、Address2 等）

组合框是我遇到问题的地方:)

我已经搜索了代码片段，并且正在取得一些进展，但是我可以使用对 datagridview 事件以及如何处理它们有更好理解的人的一些建议。我真的不知道我在做什么，只是把东西扔在墙上，看看它是否会粘住。以下是我到目前为止尝试过的...

```
InitializeComponent();
dataGridView1.EditingControlShowing += new DataGridViewEditingControlShowingEventHandler(DataGridViewEditingControlShowing);

private void DataGridViewEditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
    {
        //here we will add the combo box's selected event changed 
        ComboBox cmbBox; 
        if (dataGridView1.CurrentCell is DataGridViewComboBoxCell)
        { 
            cmbBox = e.Control as ComboBox; 
            if (cmbBox == null)
                return; 
            cmbBox.SelectedIndexChanged += cmbBox_SelectedIndexChanged; 
        }
    }

    //This will display value of Select values of Combo Box 
    //which is DataGridView
    void cmbBox_SelectedIndexChanged(object sender, EventArgs e)
    {
        ComboBox cmbBox = (ComboBox)sender;
        if (cmbBox.SelectedValue != null)
        {
            MessageBox.Show(cmbBox.SelectedValue.ToString());  //testing
            bindingSource.Remove(cmbBox.SelectedValue);   //this removes it from the current combobox as well, no good.  Also run time error when clicking into a different combobox
        }          
    } 
```

我希望我已经进行了足够的描述并发布了足够的代码，以便让任何可能的代码专家帮助者了解我正在尝试完成的工作。如果需要更多信息，请告诉我。非常感谢任何想法/解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:25:25.837

您走在正确的轨道上，但是要使其正常工作，我认为每个组合框都需要自己的数据源，因此可以单独操作它们。如果它们都共享相同的源，则它们不能有不同的内容，这就是您想要的（从组合框 A 中选择 X 应该从所有其他组合框中删除它。）

在您创建组合框的循环中，“克隆”数据源，以便它们每个都有自己的。

# google-analytics - 在 Google Analytics 中，有没有办法从来源中排除流量，但仅限于流量使用某个服务提供商时？

> ID：10319683
> 
> 赞同：0
> 
> 时间：2012-04-25T16:18:49.520
> 
> 标签：google-analytics

我正在尝试在 Google Analytics 中进行一些分析，发现有一个特定的机器人正在向我的网站发送大量“虚假”流量。我想从分析中排除此流量。它来自某个来源（每次都相同），并且始终位于 4 个服务提供商中的 1 个。我用以下部分隔离了流量：

```
INCLUDE "Service Provider" Matches RegExp "W|X|Y|Z"
AND
INCLUDE "Source" Matches RegExp "nameOfSource.com" 
```

^^返回我想排除的确切流量。所以有人会假设，当我将 INCLUDEs 设置为 EXCLUDEs 时，它会给我我需要的东西（除了那个段之外的所有东西）。相反，它会排除来自 nameOfSource.com 的所有流量。

有没有人知道我如何成功排除该流量，同时又不从 nameOfSource.com 中删除合法流量？

先谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:37:09.910

谷歌分析为此目的提供过滤器。首先创建另一个配置文件，这样您就有 2 个配置文件，一个包含所有数据的未过滤配置文件，并创建第二个配置文件，并在该配置文件上添加您想要的过滤器。您可以在 GA 帐户的管理部分下找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T07:18:04.223

高级段中的 AND 语句不是累积的，但它们不是累积的，而是一个接一个地运行。

您可以使用高级过滤器来做到这一点。

1.  在字段 A 上从源中提取“nameOfSource.com”
2.  在字段 B 上从 ISP 提取“W|X|Y|Z”
3.  将 A+B 输出到自定义变量

然后，您可以使用第二个过滤器通过此自定义 var 排除流量，或在其上使用高级细分。

# c++ - 新的 MinGW gcc 没有做任何事情

> ID：10319685
> 
> 赞同：5
> 
> 时间：2012-04-25T16:18:59.730
> 
> 标签：c++, c, mingw

我正在尝试在 Windows 上编译一个简单的`helloworld`程序，但没有任何反应。`MinGW`没有输出，没有可执行文件，什么都没有。我刚刚用他们的`mingw-get-inst-20120421.exe`安装程序安装了最新的 MinGW。当我使用旧版本的 MinGW 时`Code::Blocks`，我可以编译该程序。我没有想法，我的谷歌搜索是徒劳的。C:\MinGW\bin 在我的路径上，我正在使用 MSYS。

MSYS 中的命令行参数：

```
gcc helloworld.c -o helloworld 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:28:06.793

从开始菜单、开始->MingW->MinGW Shell 或从文件系统执行控制台：

C:\MinGW\msys\1.0\msys.bat

在这个 shell 中执行 gcc。

否则，您必须将 minGW/bin 目录添加到 PATH 环境变量中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-11-18T13:19:02.123

转到您拥有 gcc 可执行文件的目录。就我而言，它是：

```
C:\MingW\bin 
```

从那里执行 gcc：

```
gcc myFile.c 
```

如果它编译，那么一定是有什么东西搞砸了你的`$PATH`

# javascript - 从对象中查找和删除项目

> ID：10319690
> 
> 赞同：1
> 
> 时间：2012-04-25T16:19:07.893
> 
> 标签：javascript, jquery, object

我有以下数据表使用的对象，我想知道如何按名称删除项目。

例子

假设我想从下面的对象中删除 sEcho、mDataProp_1 和 sSearch，这是遍历所有项目并检查名称的最佳方法，还是有更简单的方法。

```
[{"name":"sEcho","value":1},{"name":"iColumns","value":9},
{"name":"sColumns","value":""},{"name":"iDisplayStart","value":0},
{"name":"iDisplayLength","value":10},{"name":"mDataProp_0","value":0},
{"name":"mDataProp_1","value":1},{"name":"mDataProp_2","value":2},
{"name":"mDataProp_3","value":3},{"name":"mDataProp_4","value":4},
{"name":"mDataProp_5","value":5},{"name":"mDataProp_6","value":6},
{"name":"mDataProp_7","value":7},{"name":"mDataProp_8","value":8},
{"name":"sSearch","value":""},{"name":"bRegex","value":false},
{"name":"sSearch_0","value":""},{"name":"bRegex_0","value":false},
{"name":"bSearchable_0","value":false},{"name":"sSearch_1","value":""},
{"name":"bRegex_1","value":false},{"name":"bSearchable_1","value":false},
{"name":"sSearch_2","value":""},{"name":"bRegex_2","value":false}] 
```

例子会很棒。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:33:44.490

这是一个小小的 jsfiddle，它可以做到这一点[http://jsfiddle.net/wHkTS/](http://jsfiddle.net/wHkTS/)

这个想法是迭代该区域并将您要删除的名称与当前迭代的对象名称进行比较，并基本上构建一个新数组以分配回不包含您要删除的对象。

```
var data = [
        {"name":"sEcho","value":1},{"name":"iColumns","value":9},
        {"name":"sColumns","value":""},{"name":"iDisplayStart","value":0},
        {"name":"iDisplayLength","value":10},{"name":"mDataProp_0","value":0},
        {"name":"mDataProp_1","value":1},{"name":"mDataProp_2","value":2},
        {"name":"mDataProp_3","value":3},{"name":"mDataProp_4","value":4},
        {"name":"mDataProp_5","value":5},{"name":"mDataProp_6","value":6},
        {"name":"mDataProp_7","value":7},{"name":"mDataProp_8","value":8},
        {"name":"sSearch","value":""},{"name":"bRegex","value":false},
        {"name":"sSearch_0","value":""},{"name":"bRegex_0","value":false},
        {"name":"bSearchable_0","value":false},{"name":"sSearch_1","value":""},
        {"name":"bRegex_1","value":false},{"name":"bSearchable_1","value":false},
        {"name":"sSearch_2","value":""},{"name":"bRegex_2","value":false}
    ];

function remove(name) {

    var arr = [], len, i;

    // we reset len as data.length will change after erach remove
    for(i = 0, len = data.length; i < len; i++) {
        if (data[i].name != name) arr.push(data[i]);
    };

    data = arr;
};

console.log(data);
remove('sEcho');
console.log(data); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:30:33.407

现代 ES5 方式是[`Array.filter`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/filter)：

```
var original = [{"name":"sEcho","value":1}, ... ];

var filtered = original.filter(function(val, index, array) {
    var n = val.name;
    return n !== 'sEcho' && n !== 'mDataProp_1' && n !== 'sSearch';
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:23:23.323

我认为您需要创建一个可以搜索然后删除它们的功能，例如

```
function deleteByName(needle, haystack) {
 for(i in haystack) {
  if ( haystack[i].name == needle) { 
   haystack.splice(i,1);
 }
} 
```

# c# - 如何在具有内部 ctor 的类上使用 AutoFixture.CreateAnonymous<>()

> ID：10319693
> 
> 赞同：3
> 
> 时间：2012-04-25T16:19:13.817
> 
> 标签：c#, unit-testing, autofixture

我做了类似以下的事情

```
public class Foo
{
    public Bar { get; set; }
}

public class Bar
{
    internal Bar(string id)
    {}
}

public static class Bars
{
     public static class TypeOne
     {
           public static readonly SimpleBar = new Bar("id-for-type1-simple-bar");
     }
} 
```

现在，`InternalsVisibleTo`我在我的单元测试程序集中添加了一个，以便能够访问内部 Bar ctor，然后我做了：

```
var fixture = new Fixture();
fixture.Register(() => new Bar(fixture.CreateAnonymous<string>()));
var foo = fixture.CreateAnonymous<Foo>(); 
```

问题：
这是使用 AutoFixture 的“正确”方式还是有更好的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T20:04:25.033

你不能做这样的事情吗？

```
fixture.Inject(Bars.TypeOne.SimpleBar); 
```

这都是公开的。不需要 InternalsVisibleTo，我认为...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T00:28:05.297

此代码有效，因为您已经有一个引用 Bar 的公共静态类，无需设置`InternalsVisibleTo`属性即可

```
 var fixture = new Fixture().Customize(new AutoMoqCustomization());

        fixture.Inject(Bars.TypeOne.SimpleBar);

        var sut = fixture.CreateAnonymous<Foo>();

        sut.Should().NotBeNull();
        sut.Bar.Should().NotBeNull();
        sut.Bar.Should().Be(Bars.TypeOne.SimpleBar); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T07:53:21.490

永远不要走`InternalsVisibleTo`- 不要让我开始列表，但它从系统的每个部分开始，包括所有测试助手都被强命名。

如果您绝对不能（仔细考虑一下-大多数情况下，最好将不考虑公共api的一部分的内部组件放入名称空间中，这样它们就不会弄乱任何东西-例如Xunit.Sdk和`.Internal`我为我的雇主使用的各种子命名空间），那么管理这种东西的暴露的正确方法 For Tests Only 是[For](http://xunitpatterns.com/Test%20Logic%20in%20Production.html) Tests Only 的概念。[注意，它有一个名字的原因是它（正确地）在xUnit Test Patterns book](http://xunitpatterns.com/)中被称为反模式。

* * *

现在，回答你的问题...

1.  考虑在单独的命名空间中隐藏用户通常不需要的内容
2.  永远不要使用`InternalsVisibleTo`
3.  不要使用仅测试代码

公开一个只在内部公开的工厂（也许`DEBUG`？）你的软件的构建（但理想情况下你会在另一个命名空间中无条件地拥有它）：

```
#if INCLUDE_FOR_TEST_ONLY
public static class BarsForTestOnly
{
    public static Bar Create( string id )
    {
        return new Bar( id );
    }
}
#endif 
```

并像这样使用它：

```
#if INCLUDE_FOR_TEST_ONLY
public class Facts
{

[Fact]
public void Fact()
{
    Fixture fixture = new Fixture();
    fixture.Register( ( string name ) => BarsForTestOnly.Create( name ) );
    var anonymousBar = fixture.CreateAnonymous<Bar>();
}

[Fact]
public void FactSyntax2() // Just a variant of Fact above
{
    Fixture fixture = new Fixture();
    fixture.Register<string, Bar>( BarsForTestOnly.Create );
    var anonymousBar = fixture.CreateAnonymous<Bar>();
}

[Fact]
public void UsingFromFactory()
{
    Fixture fixture = new Fixture();
    fixture.Customize<Bar>(  x=> x.FromFactory<string>( BarsForTestOnly.Create ) );
    var anonymousBar = fixture.CreateAnonymous<Bar>();
}
#endif 
```

* * *

或者，要使您拥有的只是工作，您可以执行以下操作：

```
[Fact]
public void UsingCtor()
{
    Fixture fixture = new Fixture();
    fixture.Register( ( string name )=> new Bar( name ) );
    var anonymousBar = fixture.CreateAnonymous<Bar>();
} 
```

# java - 精确匹配同一字符的 N 次重复

> ID：10319696
> 
> 赞同：8
> 
> 时间：2012-04-25T16:19:22.437
> 
> 标签：java, .net, python, regex, perl

如何编写一个完全匹配同一字符的 N 次重复（或者，理想情况下是同一组）的表达式？基本上是什么`(.)\1{N-1}`，但有一个重要限制：如果主题重复N 次*以上，则表达式应该失败。*例如，给定`N=4`和字符串`xxaaaayyybbbbbzzccccxx`，表达式应该匹配`aaaa`和`cccc`而不是`bbbb`。

我不专注于任何特定的方言，随意使用任何语言。请不要发布仅适用于此特定示例的代码，我正在寻找通用解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-25T16:57:59.137

使用负前瞻*和*负后瞻。

这将是正则表达式：`(.)(?<!\1.)\1{N-1}(?!\1)`除了 Python 的 re 模块已损坏（请参阅[此链接](https://stackoverflow.com/questions/10279055/impossible-lookbehind-with-a-backreference)）。

英文翻译：“匹配任何字符。确保在匹配该字符之后，它之前的字符不是那个字符。匹配该字符的 N-1 个重复。确保那些重复之后的字符不是那个字符特点。”

不幸的是，re 模块（和大多数正则表达式引擎）已损坏，因为您不能在后向断言中使用反向引用。Lookbehind 断言必须是恒定长度，并且编译器不够聪明，无法推断它是在使用反向引用时（即使在这种情况下，反向引用是恒定长度的）。我们必须通过这个来处理正则表达式编译器，如下所示：

实际的**答案**必须更加混乱：`r"(.)(?<!(?=\1)..)\1{N-1}(?!\1)"`

这可以通过使用`(?=\1)..`而不是解决 re 模块中的错误`\1.`（这些在大多数情况下是等效的。）这让正则表达式引擎准确地知道后向断言的宽度，因此它可以在 PCRE 和 re 等中工作。

* * *

当然，现实世界的解决方案类似于`[x.group() for x in re.finditer(r"(.)\1*", "xxaaaayyybbbbbzzccccxx") if len(x.group()) == 4]`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-25T16:21:04.143

我怀疑你想使用负前瞻： `(.)\1{N-1}(?!\1)`。

但这就是说……我怀疑*最简单*的跨语言解决方案就是*自己编写而不使用正则表达式。*

更新：

`^(.)\\1{3}(?!\\1)|(.)(?<!(?=\\2)..)\\2{3}(?!\\2)`更普遍地为我工作，包括从字符串开头开始的匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T17:35:07.377

Perl 的正则表达式引擎不支持可变长度的lookbehind，所以我们必须慎重考虑。

```
sub runs_of_length {
  my($n,$str) = @_;

  my $n_minus_1 = $n - 1;
  my $_run_pattern = qr/
    (?:
       # In the middle of the string, we have to force the
       # run being matched to start on a new character.
       # Otherwise, the regex engine will give a false positive
       # by starting in the middle of a run.
       (.) ((?!\1).) (\2{$n_minus_1}) (?!\2) |
       #$1 $2        $3

       # Don't forget about a potential run that starts at
       # the front of the target string.
           ^(.)      (\4{$n_minus_1}) (?!\4)
       #    $4       $5
    )
  /x;

  my @runs;
  while ($str =~ /$_run_pattern/g) {
    push @runs, defined $4 ? "$4$5" : "$2$3";
  }

  @runs;
} 
```

几个测试用例：

```
my @tests = (
  "xxaaaayyybbbbbzzccccxx",
    "aaaayyybbbbbzzccccxx",
  "xxaaaa",
    "aaaa",
  "",
);

$" = "][";
for (@tests) {
  my @runs = runs_of_length 4, $_;
  print qq<"$_":\n>,
        "  - [@runs]\n";
} 
```

输出：

```
“xxaaaayybbbbbzzccccxx”：
  - [aaaa][cccc]
“aaaayybbbbbzzccccxx”：
  - [aaaa][cccc]
“xxaaaa”：
  - [aaaa]
“啊啊”：
  - [aaaa]
“”：
  - []
```

这是一个有趣的谜题，但如果这样的结构出现在生产代码中，你厌恶正则表达式的同事可能会不高兴。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-25T17:02:12.030

很容易给正则表达式增加太多负担并试图让它们做*所有事情*，而*几乎*所有事情都可以！

使用正则表达式查找由单个字符组成的所有子字符串，然后分别检查它们的长度，如下所示：

```
use strict;
use warnings;

my $str = 'xxaaaayyybbbbbzzccccxx';

while ( $str =~ /((.)\2*)/g ) {
  next unless length $1 == 4;
  my $substr = $1;
  print "$substr\n";
} 
```

**输出**

```
aaaa
cccc 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-25T16:38:31.897

```
>>> import itertools
>>> zz = 'xxaaaayyybbbbbzzccccxxaa'
>>> z = [''.join(grp) for key, grp in itertools.groupby(zz)]  
>>> z  
['xx', 'aaaa', 'yyy', 'bbbbb', 'zz', 'cccc', 'xx', 'aa'] 
```

`N==4`从那里您可以很容易地遍历列表并检查场合，如下所示：

```
>>> [item for item in z if len(item)==4]
['cccc', 'aaaa'] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-26T01:26:36.267

在Java中，我们可以像下面的代码那样做

```
String test ="xxaaaayyybbbbbzzccccxx  uuuuuutttttttt";

int trimLegth = 4; // length of the same characters

Pattern p = Pattern.compile("(\\w)\\1+",Pattern.CASE_INSENSITIVE| Pattern.MULTILINE);

Matcher m = p.matcher(test);
while (m.find())
{ 
    if(m.group().length()==trimLegth) {
        System.out.println("Same Characters String " + m.group());
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-25T16:55:26.800

这在python中怎么样？

```
def match(string, n):
    parts = []
    current = None
    for c in string:
        if not current:
            current = c
        else:
            if c == current[-1]:
                current += c
            else:
                parts.append(current)
                current = c

    result = []
    for part in parts:
        if len(part) == n:
            result.append(part)

    return result 
```

使用各种大小的字符串进行测试：

```
match("xxaaaayyybbbbbzzccccxx", 6) = []
match("xxaaaayyybbbbbzzccccxx", 5) = ["bbbbb"]
match("xxaaaayyybbbbbzzccccxx", 4) = ['aaaa', 'cccc']
match("xxaaaayyybbbbbzzccccxx", 3) = ["yyy"]
match("xxaaaayyybbbbbzzccccxx", 2) = ['xx', 'zz'] 
```

## 解释：

第一个循环基本上将文本分成几部分，如下所示：[“xx”、“aaaa”、“yyy”、“bbbbb”、“zz”、“cccc”、“xx”]。然后第二个循环测试这些部分的长度。最后，该函数仅返回具有当前长度的部分。我不是最擅长解释代码的人，所以如果需要，任何人都可以自由地加强这个解释。

无论如何，我认为这会做！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-25T16:59:50.997

为什么不让正则表达式引擎做它最擅长的事情——找到最长的相同符号字符串，然后自己检查长度？

在 Perl 中：

```
my $str = 'xxaaaayyybbbbbzzccccxx';

while($str =~ /(.)\1{3,}/g){
    if(($+[0] - $-[0]) == 4){ # insert here full match length counting specific to language
        print (($1 x 4), "\n")
    }
} 
```

# python - 将 Twisted AMP 与数据库插入一起使用

> ID：10319699
> 
> 赞同：1
> 
> 时间：2012-04-25T16:19:24.713
> 
> 标签：python, twisted

我正在学习如何使用 Twisted AMP。我正在开发一个程序，将数据从客户端发送到服务器并将数据插入 SQLite3 DB。然后服务器将结果发送回客户端，指示成功或错误（尝试和除外可能不是最好的方法，但它只是我解决主要问题时的临时解决方案）。为了做到这一点，我修改了一个示例，该示例最初进行了求和并返回了结果，因此我意识到这可能不是执行我想做的最有效的方法。特别是我正在尝试对多次插入进行一些计时（即多次将数据发送到服务器以进行多次插入）并且我已经包含了我编写的代码。

我已经尝试了几种方法来解决这个问题，包括将 ClientCreator 传递给 reactor.callWhenRunning() 但你不能通过延迟来做到这一点。

任何有关如何执行此操作的建议、建议或帮助将不胜感激。这是代码。

服务器：

```
from twisted.protocols import amp
from twisted.internet import reactor
from twisted.internet.protocol import Factory
import sqlite3, time

class Insert(amp.Command):
    arguments = [('data', amp.Integer())]
    response = [('insert_result', amp.Integer())]

class Protocol(amp.AMP):
    def __init__(self):     
       self.conn = sqlite3.connect('biomed1.db')
       self.c =self.conn.cursor()
       self.res=None

    @Insert.responder
    def dbInsert(self, data):
        self.InsertDB(data) #call the DB inserter
        result=self.res     # send back the result of the insertion
        return {'insert_result': result}

    def InsertDB(self,data):
      tm=time.time()
      print "insert time:",tm
      chx=data
      PID=2
      device_ID=5
      try:
        self.c.execute("INSERT INTO btdata4(co2_data, patient_Id, sensor_Id) VALUES ('%s','%s','%s')" % (chx, PID, device_ID))    
      except Exception, err:
             print err
             self.res=0
      else:
             self.res=1

      self.conn.commit()

pf = Factory()
pf.protocol = Protocol
reactor.listenTCP(1234, pf) 
reactor.run() 
```

客户：

```
from twisted.internet import reactor
from twisted.internet.protocol import ClientCreator
from twisted.protocols import amp
import time

class Insert(amp.Command):
    arguments = [('data', amp.Integer())]
    response = [('insert_result', amp.Integer())]

def connected(protocol):
    return protocol.callRemote(Insert, data=5555).addCallback(gotResult)

def gotResult(result):
    print 'insert_result:', result['insert_result']
    tm=time.time()
    print "stop", tm    

def error(reason):
    print "error", reason

tm=time.time()
print "start",tm
for i in range (10): #send data over ten times
  ClientCreator(reactor, amp.AMP).connectTCP(
     '127.0.0.1', 1234).addCallback(connected).addErrback(error)

reactor.run() 
```

代码结束。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T20:31:11.670

很少有东西可以改善您的服务器代码。

首先也是最重要的：在twisted 中不鼓励使用直接数据库访问函数，因为它们通常会导致阻塞。Twisted 对数据库访问有很好的抽象，它为数据库连接提供了扭曲的方法 - [twisted.adbapi](http://twistedmatrix.com/documents/current/core/howto/rdbms.html)

现在重用 db 连接：如果您想跨多个协议实例重用某些资产（如数据库连接），您应该在 Factory 的构造函数中初始化它们，或者如果您不希望在启动时启动这些东西，创建一个资源访问方法，它将在第一次方法调用时启动资源，然后将其分配给类变量并在后续调用时返回。

当 Factory 创建特定的 Protocol 实例时，它会在协议内部添加对自身的引用，参见[twisted.internet.protocol 的第 97 行](http://twistedmatrix.com/trac/browser/tags/releases/twisted-11.0.0/twisted/internet/protocol.py#L97)

然后在您的协议实例中，您可以访问共享数据库连接实例，例如：

```
self.factory.whatever_name_for_db_connection.doSomething() 
```

重新设计的服务器代码（我没有可用的 python、twisted 甚至像样的 IDE，所以这几乎没有经过测试，一些错误是可以预料的）

```
from twisted.protocols import amp
from twisted.internet import reactor
from twisted.internet.protocol import Factory
import time

class AMPDBAccessProtocolFactory(Factory):
    def getDBConnection(self):
        if 'dbConnection' in dir(self):
            return self.dbConnection
        else:
            self.dbConnection = SQLLiteTestConnection(self.dbURL)
            return self.dbConnection

class SQLLiteTestConnection(object):
    """
    Provides abstraction for database access and some business functions.
    """
    def __init__(self,dbURL):
        self.dbPool =  adbapi.ConnectionPool("sqlite3" , dbURL,  check_same_thread=False)

    def insertBTData4(self,data):
        query = "INSERT INTO btdata4(co2_data, patient_Id, sensor_Id) VALUES (%s,%s,%s)" 
        tm=time.time()
        print "insert time:",tm
        chx=data
        PID=2
        device_ID=5
        dF = self.dbPool.runQuery(query,(chx, PID, device_ID)) 
        dF.addCallback(self.onQuerySuccess,insert_data=data)
        return dF
    def onQuerySuccess(self,insert_data,*r):
        """
        Here you can inspect query results or add any other valuable information to be parsed at client.
        For the test sake we will just return True to a customer if query was a success.
        original data available at kw argument insert_data
        """
        return True

class Insert(amp.Command):
    arguments = [('data', amp.Integer())]
    response = [('insert_result', amp.Integer())]

class MyAMPProtocol(amp.AMP):

    @Insert.responder
    def dbInsert(self, data):
        db = self.factory.getDBConnection()
        dF = db.insertBTData4(data)
        dF.addErrback(self.onInsertError,data)
        return dF

    def onInsertError(self, error, data):
        """
        Here you could do some additional error checking or inspect data 
        which was handed for insert here. For now we will just throw the same exception again
        so that the client gets notified
        """
        raise error

if __name__=='__main__':
    pf = AMPDBAccessProtocolFactory()
    pf.protocol = MyAMPProtocol
    pf.dbURL='biomed1.db'
    reactor.listenTCP(1234, pf) 
    reactor.run() 
```

现在到客户端。如果 AMP 遵循整体 RPC 逻辑（目前无法对其进行测试），它应该能够在多个调用中细读相同的连接。所以我创建了一个 ServerProxy 类，它将保存该可阅读的协议实例并为调用提供抽象：

```
from twisted.internet import reactor
from twisted.internet.protocol import ClientCreator
from twisted.protocols import amp
import time

class Insert(amp.Command):
    arguments = [('data', amp.Integer())]
    response = [('insert_result', amp.Integer())]

class ServerProxy(object):
    def connected(self,protocol):
        self.serverProxy = protocol # assign protocol as instance variable
        reactor.callLater(5,self.startMultipleInsert) #after five seconds start multiple insert procedure

    def remote_insert(self,data):
        return self.serverProxy.callRemote(Insert, data)

    def startMultipleInsert(self):
        for i in range (10): #send data over ten times
            dF = self.remote_insert(i)
            dF.addCallback(self.gotInsertResult)
            dF.addErrback(error)

    def gotInsertResult(self,result):
        print 'insert_result:', str(result)
        tm=time.time()
        print "stop", tm    

def error(reason):
    print "error", reason

def main():
    tm=time.time()
    print "start",tm
    serverProxy = ServerProxy()
    ClientCreator(reactor, amp.AMP).connectTCP('127.0.0.1', 1234).addCallback(serverProxy.connected).addErrback(error)
    reactor.run()    

if __name__=='__main__':
    main() 
```

# c# - 为任何 cpu 部署应用程序。读取 HKLM 注册表

> ID：10319710
> 
> 赞同：0
> 
> 时间：2012-04-25T16:19:53.623
> 
> 标签：c#, registry, installation, windows-7-x64

我有一个始终在 x86 (XP) 上运行的 .NET 3.5 应用程序。我现在需要这个程序在 x64 (Win7) 上运行。此应用程序的构建是 Any CPU，因此它应该在 x64 上运行。在我的设置项目 > 注册表编辑器中，我在 HKEY_LOCAL_MACHINE\Software\Company\Product\AppPath 中创建了一个名为 AppPath 的注册表项。

在 64 位机器上，我的安装项目将此密钥安装在 HKEY_LOCAL_MACHINE\Software\Wow6432Node\Company\Product\AppPath

我的第一个问题是，如果我将 Setup 项目的 TargetPlatform 更改为 x64，为什么要将注册表项添加到 Wow6432Node 子系统？如果我理解正确定位 x64 应该在 x64 注册表而不是 Wow6432Node 子系统中安装密钥。显然，我还没有完成针对 x64 所需的所有工作。即使安装项目的目标平台是 x64，我可能错过了什么会导致程序像 32 位一样安装？

我的第二个问题是我是否有如下代码读取注册表：

```
clientPbDir = Registry.LocalMachine.OpenSubKey("Software\\Company\\Product").GetValue("AppPath").ToString(); 
```

我怎样才能使这适用于 x86 和 x64？

这篇文章回答了这个问题。

[读取注册表和 Wow6432Node 键](https://stackoverflow.com/questions/2039186/c-sharp-reading-the-registry-and-wow6432node-key)

但是我宁愿不必将我的项目编译为 x86 只是为了能够在 x86 和 x64 上读取注册表，如果我可以避免的话。我希望能够充分利用 x64 性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:24:11.470

您可能错过了这个链接：[http ://www.rhyous.com/2011/01/24/how-read-the-64-bit-registry-from-a-32-bit-application-or-vice-versa /](http://www.rhyous.com/2011/01/24/how-read-the-64-bit-registry-from-a-32-bit-application-or-vice-versa/)

看起来它做了您想做的事情，即从 x64 程序读取 x86 注册表。

# java - GAE Memcache 读\写问题

> ID：10319715
> 
> 赞同：0
> 
> 时间：2012-04-25T16:20:20.473
> 
> 标签：java, google-app-engine, memcached

我试图在数据存储区（JAVA）中存储一个“复杂”对象 - 它只是一个类，它有一个 MyObject 类型的 ArrayList 之类的成员，其中 MyObject 有他自己的数据成员（原始数据 - 字符串和整数）。我一直遇到问题 - 数据没有存储\检索，所以我读写 Memcache 的方式可能是错误的 - 我尝试使用常规 put 方法 Memcache.put(Object Key,Object Value) 结果不好- 不存储数据。

像这样将对象存储到 Memcache 有问题吗？我知道，例如，对于 Datastore，您必须使用 Blobs 。这里需要 Blob 吗？有人可以举一个简短的例子来说明它需要如何完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:00:13.573

Memcache 可以处理任何类型的对象，包括复杂的数组和子对象。所有的对象都需要继承 Serializable。我猜你的问题是你的对象不继承可序列化。

使用 Memcache 很容易。GAE 文档有一个示例： [https ://developers.google.com/appengine/docs/java/memcache/overview](https://developers.google.com/appengine/docs/java/memcache/overview)

有关 Memcache 服务的更多信息： [https ://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/MemcacheService](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/MemcacheService)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T20:55:57.143

你有可能达到 1 兆的限制吗？

# visual-studio - Visual Studio - Web 开发和调试

> ID：10319716
> 
> 赞同：0
> 
> 时间：2012-04-25T16:20:27.913
> 
> 标签：visual-studio, visual-studio-2010

我正在做一些网络开发，当我按下调试按钮时，它会从选定的选项卡开始，这真的很烦人，因为它会抛出错误，因为这些页面一开始并不打算运行。有没有办法让 Visual Studio 始终首先运行默认页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:24:37.193

右键单击要作为起始页的页面，然后选择“设置为起始页：”

![在此处输入图像描述](../Images/6e0409d30191e49a742f6d00199062bc.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:23:12.283

查看 Web 应用程序的属性窗口，Web 选项卡。它有一个框，您可以在其中输入要在开始调试时加载的 URL。

那是; 右键单击解决方案资源管理器中的项目项，选择“属性”，然后单击“Web”选项卡，然后选择适合您需要的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:24:35.023

您也可以右键单击所需的起始页并选择设置为起始页。

# objective-c - Objective C - 分配给'int *'的不兼容指针类型

> ID：10319719
> 
> 赞同：0
> 
> 时间：2012-04-25T16:20:30.763
> 
> 标签：objective-c, ios

在 AppDelegate.m 为什么我收到此消息错误

> 从“MyPlugin*”分配给“int*”的不兼容指针类型

在这条线上：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{

self.myPlugin = [[MyPlugin alloc] init]; 
```

在 AppDelegate.h 我有：

```
@property (strong, nonatomic) MyPlugin *myPlugin; 
```

在 MyPlugin 我有：

```
#import "MyPlugin.h"
#import <UIKit/UIKit.h>

@implementation MyPlugin

- (void)dealloc {

    [super dealloc];

}

- (MyPlugin*)init
{
    if (self = [super init]) {

    }

    return self;
} 
```

# .net - GridView 根据 URL 中的键值对搜索

> ID：10319724
> 
> 赞同：0
> 
> 时间：2012-04-25T16:20:43.843
> 
> 标签：.net, gridview

我正在发送带有目标 URL 的键值对。基于这个键值对，我想搜索目标页面中存在的 GridView。有人可以帮我解决吗？

目标页面包含一个 GridView，其中包含“JobNo”、“Customer”、“JobDate”列。

我在目标 URL 中发送 JobNo 的键值对，如下所示，

[http://localhost:1637/Website1/Customer.aspx?JobNo=1234](http://localhost:1637/Website1/Customer.aspx?JobNo=1234)

因此，当此 URL 加载时，它应该搜索并向我显示仅包含 JobNo=1234 信息的 GridView

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T12:26:17.413

在 page_load 事件中执行以下代码：

```
YourGridView.DataSource = ((DataTable)(YourGridView.DataSource)).Select("JobNo = '" + Request.QueryString["JobNo"] + "' ").CopyToDataTable();
YourGridView.DataBind(); 
```

这将获取当前的 GridView 数据源，解析为 DataTable，然后从中过滤，然后将过滤结果再次绑定到 GridView。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:30:45.653

在目标 page_load 事件中，使用

```
grid.DataSource = yourDataSource.Select(item => item.JobNo == Request.QueryString["JobNo"]);
grid.DataBind(); 
```

# facebook-graph-api - 是否不允许使用按请求访问令牌对 FQL 进行批处理查询？它不工作

> ID：10319725
> 
> 赞同：0
> 
> 时间：2012-04-25T16:20:56.063
> 
> 标签：facebook-graph-api, facebook-fql, fql.multiquery, facebook-batch-request

是否无法使用多个访问令牌使用 'method/fql.query?query=...' 批量查询图形？

过去，我从来没有遇到过使用多个访问令牌批量查询非 fql 端点的问题，但是通过批量查询 FQL 调用，只有第一个调用返回数据，其余的返回一个空的主体。

我能做出的唯一猜测是它与 access_token 相关，但如果是这样，我对如何补救感到不知所措..

例子：

```
import json
from pyfaceb import *

user1_tk = '...' #valid token (tested)
user1_qry = '...' #valid query (tested unbatched)
user1_rqst = {'method': 'POST', 'relative_url': 'method/fql.query?query=' + user1_qry, 'access_token': user1_tk}

user2_tk = '...' #valid token (tested)
user2_qry = '...' #valid query (tested unbatched)
user2_rqst = {'method': 'POST', 'relative_url': 'method/fql.query?query=' + user2_qry, 'access_token': user2_tk}

batches = [user1_rqst, user2_rqst]

fbg = FBGraph(user1_tk) # use user1_tk as fallback access token (cuz you have to specify one)
data = fbg.get_batch(batches)

print data[0]['body'] #comes back with data, but
print data[1]['body'] #comes back as an empty array. 
```

data[0]['code'] 和 data[1]['code'] 都是 HTTP 200 响应。

如果我将回退访问令牌更改为 user2_tk，则 data[0]['body'] 会以空数组的形式返回（反之亦然）。即使我为每个请求指定了 access_tokens（根据：[https](https://developers.facebook.com/docs/reference/api/batch/#differentaccesstokens) ://developers.facebook.com/docs/reference/api/batch/#differentaccesstokens ）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:16:10.287

弄清楚了。acccess_token 需要在请求正文中，因为它是一个 POST：

```
...
user1_rqst = {
    'method': 'POST',
    'relative_url': 'method/fql.query?query=' + user1_qry,
    'body': 'access_token=' + user1_tk
}

...

user2_rqst = {
    'method': 'POST',
    'relative_url': 'method/fql.query?query=' + user2_qry,
    'body': 'access_token=' + user2_tk
} 
```

# javascript - 在博客文章中加载 jQuery 会导致它冻结

> ID：10319728
> 
> 赞同：1
> 
> 时间：2012-04-25T16:21:05.740
> 
> 标签：javascript, jquery, jcarousel, blogger

我创建了一些代码，人们可以将它们复制并粘贴到他们的网站中，它应该可以在 blogspot 中使用。此代码需要 jQuery 和 jCarousel 插件。我用

```
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script> 
```

在运行我的 javascript 代码之前加载 jQuery。问题是一些博客模板已经加载了 jQuery，然后运行上面的代码会导致博客文章永远不会加载（它只是停留在加载屏幕上）。

我可以在之后使用 javascript 加载它，`if (typeof jQuery == "undefined")`但是要让 jCarousel 插件工作，必须先加载 jQuery，所以这会导致帖子加载但轮播中断。

有人知道任何解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:26:45.320

你不能检查 jQuery 的存在并在那之后仍然加载 jCarousel 吗？

```
<script type="text/javascript">
    if (typeof jQuery === "undefined") {  
        document.write('<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"><\/script>');
    }
</script>

<script src="http://path/to/jcarousel" type="text/javascript"></script> 
```

**再三考虑**，我不相信这会永远有效。我认为这不能保证 jQuery 会在 jCarousel 之前加载。我想出了一个似乎更强大的替代解决方案。它确保 jQuery 已加载，然后使用 jQuery 加载使用`$.getScript()`. 然后你的代码从`getScript`. 这确保了一切都以正确的顺序发生：

```
<script type="text/javascript">
    if (typeof jQuery !== "undefined") {
        loadLibs();
    } else {
        var script = document.createElement('script');
        script.src = 'http://code.jquery.com/jquery.js';
        document.getElementsByTagName('head')[0].appendChild(script);
        var timeout = 100; // 100x100ms = 10 seconds
        var interval = setInterval(function() {
            timeout--;
            if (window.jQuery) {
                clearInterval(interval);
                loadLibs();
            } else if (timeout <= 0) {
                // jQuery failed to load
                clearInterval(interval);
            }
        }, 100);
    }

    function loadLibs() {
        $.getScript("http://sorgalla.com/projects/jcarousel/lib/jquery.jcarousel.min.js", function(data, textStatus, jqxhr) {
            myCode();
        });
    }

    function myCode() {
        $(document).ready(function() {
            $('#mycarousel').jcarousel();
        });
    }
</script> 
```

演示：http: [//jsfiddle.net/jtbowden/Y84hA/2/](http://jsfiddle.net/jtbowden/Y84hA/2/)

（将左栏中的框架更改为任何版本的 jQuery 或其他库。它应该始终正确加载轮播）

**编辑**：

这个版本是类似的，但是`<head>`对 lib 使用了一个负载，就像 jQuery 一样。它比`$.getScript()`：

[http://jsfiddle.net/jtbowden/y8nGJ/1/](http://jsfiddle.net/jtbowden/y8nGJ/1/)

# c# - 无法转换类型的对象

> ID：10319735
> 
> 赞同：1
> 
> 时间：2012-04-25T16:21:36.877
> 
> 标签：c#, wpf

在我的 wpf 应用程序中尝试将字符串从一个窗口发送到另一个窗口时出现错误：

> 无法将“WpfApplication4.LoginWindow”类型的对象转换为“WpfApplication4.MainWindow”类型。

在我的登录窗口中，错误出现在这一行：

```
((MainWindow)Application.Current.MainWindow).StudentID = UserAuthenticationID; 
```

在我的主窗口中，我有这个要测试：

```
 public string StudentId { get; set; }
    void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        label1.Content = StudentID;
    } 
```

我究竟做错了什么？

**编辑：**

到目前为止没有任何答案是有意义的，这将是由于我的模糊问题，我创建了一个 wpf 应用程序，并且我有两个窗口 MainWindow.xaml 和 LoginWindow.xaml。

我想在身份验证后将一个字符串（学生 ID）从登录窗口传递到主窗口。

当我读到它时，我认为上述方法是如何做到的：`((MainWindow)Application.Current.MainWindow).StudentID`说我打算将字符串`UserAuthenticationID`发送到哪里？

然后在`MainWindow.xaml`我得到字符串`UserAuthenticationID`并设置它，然后我将标签内容分配给这个公共字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:27:23.853

错误来了，因为它试图转换`Application.Current.MainWindow`为`MainWindow`，事实上`LoginWindow`。

当您覆盖一个对象时的建议，其他对象在它之前进行了检查

```
if(Application.Current.MainWindow is MainWindow)
{
 /// than do the code 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:32:43.253

大概您从主窗口创建登录窗口。如果您需要从登录窗口引用主窗口，则在构建时将主窗口引用传递给登录窗口。例如

```
void MainWindow_Loaded(object sender, RoutedEventArgs e) {
    LoginWindow login = new LoginWindow(this);
    login.ShowDialog();
}

class LoginWindow : Window {
    MainWindow app_window;
    public LoginWindow(MainWindow app_window) {
        Owner = app_window;
        this->app_window = app_window;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:27:54.683

您的 Application.Current.MainWindow 似乎属于 LoginWindow 类型。但是您想将其强制转换为 MainWindow。两者都（也许）从 Window 派生。但是您不能将派生类强制转换为另一个派生类。

//编辑

尝试

```
((LoginWindow)Application.Current.MainWindow) 
```

或将您的 Application.Current.MainWindow 更改为 MainWindow 类型的对象

//编辑 2 我想我明白你的意图是什么。您可以尝试以下方法：

在您按下按钮“登录”的登录窗口中，处理 Buttonevent（单击），获取来自任何位置的 ID（文本框），将其放入 MainWindow 的新实例中并设置

```
Application.Current.MainWindow 
```

到 MainWindow 的新实例。如果我对你将如何做到这一点有误，你应该提供更多事实。

其他解决方案是 Ricibob 的 LoginDialog 解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:41:54.480

看起来您试图将登录对话框中的 UserAuthenticationID 提供回您将其存储为 StudentId 的主窗口。
为什么不在主窗口中处理它例如：

```
if (login.ShowDialog())
    StudentId = login.UserAuthenticationID; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T17:15:59.247

您需要重新构建程序的设计。你想做的事情并不难；您本质上是在寻求一种在表单之间进行通信的好方法。

首先，我建议不要使用`Application.Current.MainWindow`，除非你真的确定你需要。你可以让应用程序使用它来工作，但它不是好的设计并且会导致问题。

我们将从定义一些`OtherWindow`弹出窗口开始。

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for OtherWindow.xaml
    /// </summary>
    public partial class OtherWindow : Window
    {
        public OtherWindow()
        {
            InitializeComponent();
        }

        public string SomeData
        {
            get
            {
                //you'll probably want to return the value of a textbox or something else 
                //the user fills in.
                return "Hello World!";
            }
        }
    }
} 
```

从通信的角度来看，真正重要的是它具有一个（或多个）属性，其中包含主窗体需要访问的信息。显然，我省略了所有用于实际收集要返回的数据的代码，而是为这个示例硬编码了一个值。

现在是主窗体。（我添加的只是一个按钮和一个标签。）

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            OtherWindow other = new OtherWindow();
            other.Closed += (sender2, e2) =>
                {
                    label1.Content = other.SomeData;
                };

            //either of the methods below, depending on desired behavior.
            other.Show();
            //other.ShowDialog();
        }
    }
} 
```

虽然有很多方法可以让不同的窗口/表单进行通信，但这是我最喜欢的。窗口之间交互的所有逻辑都在一个地方（按钮单击事件）。主窗体明确“拥有” `OtherWindow`，`OtheWindow`不需要知道什么`MainWindow`，只需要知道如何收集一些信息。 `MainWindow`将负责提取所需的信息。

按钮单击的代码甚至读起来就像您希望它执行的操作一样：创建一个新窗口，当它关闭时，将其内容设置为我的标签，然后显示表单。这一切都在一个地方，并且按照我逻辑思考的顺序（`Show`如果需要，您可以在之后附加事件处理程序）。

哦，这与我在 winforms 应用程序中执行此操作的方式完全相同，以防万一有人关心，除非某些类/属性名称会有所不同。

# powershell - powershell 2.0 无法获取 Internet Explorer 日志

> ID：10319738
> 
> 赞同：0
> 
> 时间：2012-04-25T16:22:12.807
> 
> 标签：powershell, powershell-2.0, event-log

当我尝试在 powershell V2.0 中的 win2003 std 上运行 cmd get-eventlog -list 时。它给了我以下输出

```
 Max(K) Retain OverflowAction        Entries Log
 ------ ------ --------------        ------- ---
 16,384      0 OverwriteAsNeeded         117 Application
 512      7 OverwriteOlder              0 Internet Explorer
 20,480      0 OverwriteAsNeeded           0 Microsoft-Windows-Forwarding/Operational
 16,384      0 OverwriteAsNeeded         136 Security
 16,384      0 OverwriteAsNeeded         173 System
 15,360      0 OverwriteAsNeeded          83 Windows PowerShell 
```

当尝试运行 get-eventlog "Internet Explorer" 时，它给了我错误

```
Get-EventLog : No matches found
At line:1 char:13
+ get-eventlog <<<<   $event
    + CategoryInfo          : ObjectNotFound: (:) [Get-EventLog], ArgumentException
    + FullyQualifiedErrorId : GetEventLogNoEntriesFound,Microsoft.PowerShell.Commands.GetEventLogCommand 
```

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T04:44:13.610

这仅仅是因为你的日志此刻是空的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T04:49:20.090

你得到了异常，因为它是空的，**但是**你仍然可以通过这样做来获取对象：

```
$ieLog = get-eventlog -list | where-object {$_.Log -eq "Internet Explorer"} 
```

要验证您确实获得了正确的日志，请尝试在其中写入一些内容：

```
$ieLog.Source = "Testing"
$ieLog.WriteEntry("Write Succeeded") 
```

# .net - 如何将图片从资源管理器拖放到 WPF 控件上？

> ID：10319739
> 
> 赞同：1
> 
> 时间：2012-04-25T16:22:20.013
> 
> 标签：.net, wpf, windows, c#-4.0, drag-and-drop

我四处寻找答案，但似乎没有一个明确的例子来说明如何做到这一点！

我只想能够从桌面/资源管理器中抓取图片并将其拖放到 WPF 图像控件或类似控件上。

谁能指出我正确的方向？我已经看到了大量关于从应用程序到应用程序、在应用程序内或从应用程序到桌面拖放的示例，但反之则几乎没有。

我猜想某种形式的剪贴板交互是必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:33:50.337

您需要在图像控件上启用拖放功能，然后只需在事件处理程序中打开拖放到它的文件即可。

请参阅[将文件拖放到 WPF](https://stackoverflow.com/questions/5662509/drag-and-drop-files-into-wpf) 中的答案（如果有帮助，请记住对该问题的最高答案进行投票:)）

```
private void ImagePanel_Drop(object sender, DragEventArgs e)
{

  if (e.Data.GetDataPresent(DataFormats.FileDrop))
  {
    // Note that you can have more than one file.
    string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);

    // Assuming you have one file that you care about, pass it off to whatever
    // handling code you have defined.
    HandleFileOpen(files[0]);
  }
} 
```

# linux - 将命令输出重定向到 bash 中的变量失败

> ID：10319745
> 
> 赞同：34
> 
> 时间：2012-04-25T16:22:47.420
> 
> 标签：linux, apache, bash, shell, terminal

我正在尝试将命令输出重定向到一个变量：

```
OUTPUT=$(sudo apache2ctl configtest) 
```

然后阅读它：

```
echo $OUTPUT 
```

运行时输出如下：

```
19:19:12 user@user ~ OUTPUT=$(sudo apache2ctl configtest)
Syntax OK
Syntax OK 
```

但变量保持空白。我已经对其他命令进行了同样的尝试，一切正常。

```
OUTPUT=$(ls -l) 
```

这会将文件列表写入变量`OUTPUT`，以便稍后读取。我应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-04-25T16:26:07.857

也许输出去`stderr`，不是`stdout`吗？试试这个：

```
OUTPUT=$(sudo apache2ctl configtest 2>&1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-07T09:20:24.993

对于 nginx 可能的情况，当 configtest 可以成功但配置文件中有错误。例子：

```
nginx: [warn] conflicting server name "test.com" on 0.0.0.0:80, ignored
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful 
```

要正确检查 bash 脚本中的错误，需要使用：

```
if [[ $((sudo /sbin/service nginx configtest) 2>&1 | grep "failed\|warn" ) ]]; then
    echo "ERROR!!!"
else
    echo "OK!!!"
fi 
```

# c# - 实体框架 - “无法定义两个对象之间的关系”错误，但我认为我使用的是相同的上下文

> ID：10319747
> 
> 赞同：5
> 
> 时间：2012-04-25T16:22:53.260
> 
> 标签：c#, entity-framework-4, ado.net, ado.net-entity-data-model

在我的 ViewModel 中，我有一些这样的代码：

```
public class OrderViewModel
{
    private UserOrder order;
    private DeliveryCentre deliveryCentre;

    // This is my EF Container
    private CatalogueContainer catalogue = new CatalogueContainer();

    // do some stuff...

    public void Save()
    {
        if (order == null)
        {
            order = catalogue.UserOrders.CreateObject();
        }
        // do some other stuff...

         if ((deliveryCentre == null)
            || (deliveryCentre.Id != deliveryCentreId))
        {
           deliveryCentre = catalogue.DeliveryCentres.First(centre => centre.Id == deliveryCentreId);

            //Causes a context error, not sure why...
            order.DeliveryCentre= deliveryCentre;
        }

        catalogue.SaveChanges();

    } 
```

因此，当交付中心是新的并且订单是新的时，我遇到了旧的“无法定义两个对象之间的关系，因为它们附加到不同的 ObjectContext 对象”错误，这对我来说似乎有点不公平 - 我只是无法弄清楚我需要做什么才能使它们更多地属于同一个对象上下文。我认为这是由于对实体框架行为的一些基本误解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T17:13:38.723

你没有处理你的上下文。有可能其中一个实体`order`或`deliveryCentre`附加到仍然持有对实体的引用的旧上下文。`using`您可以使用方法内部的语句创建和处置上下文，`Save`而不是将其用作成员变量：

```
public void Save()
{
    using (var catalogue = new CatalogueContainer())
    {
        // your code...
    }
} 
```

并删除私人`catalogue`成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-27T10:22:50.127

结果证明该解决方案仅与错误消息间接相关-@Slauma 询问了`//do stuff...`占位符，当我将这些注释掉时，错误消失了。

事实证明，那里还有另一种关系，我创建对象`this.Item = new Item()`而不是使用`this.Item = catalogue.Items.CreateObject()`，所以它是在上下文之外创建的，当它被添加到订单时，尽管订单本身是从本地上下文创建的，当项目被添加到其中，这以某种方式弄脏了上下文，但由于某种原因，这仅在我添加下一个相关对象时才出现问题。

# wordpress - 当前类别的 Wordpress 年度档案

> ID：10319749
> 
> 赞同：2
> 
> 时间：2012-04-25T16:23:08.567
> 
> 标签：wordpress, function, filter, archive

这真的让我发疯了一段时间，所以我希望有人能提供帮助。我正在尝试使用显示*当前类别中显示帖子的*`wp_get_archives()`年度档案的链接列表。

 *重要的是，我试图在**没有**插件的情况下做到这一点，只使用函数文件甚至`WP_Query`循环。

**例子**

想象一下，我有以下类别都充满了帖子：

展览（父）
--当前（子）
--过去（子）

艺术品（父）
--最近（子） --
精选（子） --旧（
子）

我想要做的基本上是这样的：

```
/* Get current Cat ID */
function getCurrentCatID() {
    global $wp_query;
    if(is_category() || is_single()){
        $cat_ID = get_query_var('cat');
    }
    return $cat_ID;
}

$currentCat = getCurrentCatID();

wp_get_archives('type=yearly&cat=$currentCat'); // But, you can't filter this by category it seems 
```

因此，如果我查看“展览”类别（使用 category.php），`wp_get_archives()`将显示 2012、2011、2010 等的链接。

当我点击 2011 年时，我会看到属于“展览”类别的帖子，并且它是子类别（也很重要）。

我发现这篇文章可能包含答案：[从 wp_get_archives 中排除类别？](https://stackoverflow.com/questions/2789228/exclude-category-from-wp-get-archives)

但我不知道如何使用帖子中提到的过滤器中正在查看的当前类别，也不知道如何向其中添加多个类别（即父类别加上它的子类别）。

任何帮助都非常感谢。

大须

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T00:18:31.157

我读这篇文章的方式，这个问题有两个方面。第一个与生成和打印链接有关。但是还有那些指向存在的 URL 的链接的问题。这可能有助于第二点：

[http://wordpress.org/support/topic/per-category-date-archives-not-working](http://wordpress.org/support/topic/per-category-date-archives-not-working)

我曾经成功地使用它来生成“/category/date/”样式的 URL。*

# c# - 如何从项目集合中选择特定项目？

> ID：10319752
> 
> 赞同：2
> 
> 时间：2012-04-25T16:23:22.780
> 
> 标签：c#, windows-phone-7.1

我正在使用 Windows Phone 的 DataBoundApp 模板，并且在模板中 selectedIndex 值从 MainPage 传递到 DetailsPage 以定义数据上下文......像这样：

```
 // When page is navigated to set data context to selected item in list
    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        string selectedIndex = "";
        if (NavigationContext.QueryString.TryGetValue("selectedItem", out selectedIndex))
        {
            int index = int.Parse(selectedIndex);
            DataContext = App.ViewModel.Items[index];
        }
    } 
```

这是设置数据上下文的唯一方法还是我可以选择其中具有特定值的项目，例如，我想将数据上下文设置为具有 LineOne = “runtime 7” 值的项目...

我该如何设置？

编辑：这些是视图模型项目

```
 public void LoadData()
    {
        // Sample data; replace with real data
        this.Items.Add(new ItemViewModel() { LineOne = "runtime one", LineTwo = "Maecenas praesent accumsan bibendum", LineThree = "Facilisi faucibus habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime two", LineTwo = "Dictumst eleifend facilisi faucibus", LineThree = "Suscipit torquent ultrices vehicula volutpat maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime three", LineTwo = "Habitant inceptos interdum lobortis", LineThree = "Habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu suscipit torquent" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime four", LineTwo = "Nascetur pharetra placerat pulvinar", LineThree = "Ultrices vehicula volutpat maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime five", LineTwo = "Maecenas praesent accumsan bibendum", LineThree = "Maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos interdum lobortis nascetur" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime six", LineTwo = "Dictumst eleifend facilisi faucibus", LineThree = "Pharetra placerat pulvinar sagittis senectus sociosqu suscipit torquent ultrices vehicula volutpat maecenas praesent" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime seven", LineTwo = "Habitant inceptos interdum lobortis", LineThree = "Accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos interdum lobortis nascetur pharetra placerat" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime eight", LineTwo = "Nascetur pharetra placerat pulvinar", LineThree = "Pulvinar sagittis senectus sociosqu suscipit torquent ultrices vehicula volutpat maecenas praesent accumsan bibendum" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime nine", LineTwo = "Maecenas praesent accumsan bibendum", LineThree = "Facilisi faucibus habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime ten", LineTwo = "Dictumst eleifend facilisi faucibus", LineThree = "Suscipit torquent ultrices vehicula volutpat maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime eleven", LineTwo = "Habitant inceptos interdum lobortis", LineThree = "Habitant inceptos interdum lobortis nascetur pharetra placerat pulvinar sagittis senectus sociosqu suscipit torquent" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime twelve", LineTwo = "Nascetur pharetra placerat pulvinar", LineThree = "Ultrices vehicula volutpat maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime thirteen", LineTwo = "Maecenas praesent accumsan bibendum", LineThree = "Maecenas praesent accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos interdum lobortis nascetur" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime fourteen", LineTwo = "Dictumst eleifend facilisi faucibus", LineThree = "Pharetra placerat pulvinar sagittis senectus sociosqu suscipit torquent ultrices vehicula volutpat maecenas praesent" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime fifteen", LineTwo = "Habitant inceptos interdum lobortis", LineThree = "Accumsan bibendum dictumst eleifend facilisi faucibus habitant inceptos interdum lobortis nascetur pharetra placerat" });
        this.Items.Add(new ItemViewModel() { LineOne = "runtime sixteen", LineTwo = "Nascetur pharetra placerat pulvinar", LineThree = "Pulvinar sagittis senectus sociosqu suscipit torquent ultrices vehicula volutpat maecenas praesent accumsan bibendum" });

        this.IsDataLoaded = true;
    } 
```

我不想通过项目的索引号设置数据上下文，而是通过特定的项目值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:55:39.173

只要您可以赋予 value 您正在搜索的值，以下将起作用。

```
string value = "runtime seven";

DataContext = App.ViewModel.Items.FirstOrDefault(item => item.LineOne == value); 
```

# vba - 运行程序的批处理文件（他们不等我）

> ID：10319756
> 
> 赞同：0
> 
> 时间：2012-04-25T16:23:28.550
> 
> 标签：vba, batch-file, cmd, wait

我的 VBA 宏已写入此 cmd 文件

```
cd/d H:\QUB\2dcfd
"C:\ANSYS Inc\v130\icemcfd\win64_amd\bin\icemcfd.bat" -batch -script test0deg.rpl
"C:\ANSYS Inc\v130\fluent\ntbin\win64\fluent.exe" 2d -i test0deg.jou 
```

转到目录，执行一个程序，执行下一个程序。

如果我按原样运行它，第一个程序将执行并正常工作，并且 cmd 窗口关闭

我在让第二个等到第一个完成之前遇到问题。

开始/等待不起作用。当我使用它时，它会弹出一个新的命令窗口，第一个程序（在新窗口中）然后新的命令窗口挂在那里。当我手动关闭这个新窗口时，它说继续批处理文件？我输入 y 并按回车键，第二个程序开始。

请帮忙。我只希望第一个运行，然后第二个运行。

ps 第二个程序需要第一个程序制作的文件。这就是为什么我需要它

提前致谢

奥利弗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:00:42.787

我使用以下方法修复了它：

```
cd/d H:\QUB\2dcfd
cmd /c "C:\ANSYS Inc\v130\icemcfd\win64_amd\bin\icemcfd.bat" -batch -script test0deg.rpl
"C:\ANSYS Inc\v130\fluent\ntbin\win64\fluent.exe" 2d -i test0deg.jou 
```

第一个运行，然后当它关闭时，第二个运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:25:58.457

用于`call`调用批处理文件：

```
call "C:\ANSYS Inc\v130\icemcfd\win64_amd\bin\icemcfd.bat" ... 
```

# android - 使用 wifi 热点在建筑物内定位

> ID：10319758
> 
> 赞同：0
> 
> 时间：2012-04-25T16:23:35.710
> 
> 标签：android, location, android-wifi

我正在尝试构建一个 android 应用程序，它可以根据位置更改手机的警报配置文件。我正在使用谷歌地图来获取用户的位置。但这给我的位置只能达到建筑物的粒度。
例如，谷歌地图可能会告诉我我在我的办公楼里，但不能告诉我我是在会议室还是在食品储藏室。我可能想要两个地方的不同配置文件。
假设大楼每个房间都有单独的无线路由器，我打算使用 wifi 热点来获取精确位置。

这可能吗？是否已经存在为此的服务/应用程序？
也欢迎任何其他实现这一目标的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:36:46.313

这是一个活跃的[研究课题](http://en.wikipedia.org/wiki/Indoor_positioning_system)，还没有真正的解决方案。您可能能够获取有关近距离热点信号强度的信息（不知道 Android 中有一个 API）或至少您当前热点的 BSSID（该 AFAIK 有一个 API）并根据你在哪里。

如果有一个很好的解决方案，谷歌可能已经这样做了（他们必须在有限的范围内：http: [//googlemobile.blogspot.de/2011/11/go-indoors-with-google-maps-60- for.html](http://googlemobile.blogspot.de/2011/11/go-indoors-with-google-maps-60-for.html) )

# html - x3dom 人工制品渲染

> ID：10319759
> 
> 赞同：0
> 
> 时间：2012-04-25T16:23:35.463
> 
> 标签：html, x3dom

我只是在发现 X3DOM 并使用它。我用sketchup画了一把椅子，用meshlab转换成x3d。我正在使用“html5”语法来编写我的页面。根据“某事”，我有不同的渲染，我不知道是什么。

渲染我认为可以：http: [//aws.ysagon.com/x3d/x3dom/ok.html](http://aws.ysagon.com/x3d/x3dom/ok.html)

渲染我认为不行：[http ://aws.ysagon.com/x3d/x3dom/bad.html](http://aws.ysagon.com/x3d/x3dom/bad.html)

困扰我的是，我认为没问题的是带有 html 错误的那个（标签`<Coordinate>`是自关闭的，不应该）。在不好的例子中，标签不是自封闭的。

有人可以解释一下为什么它似乎有两种渲染模式吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T10:27:25.120

好的，我弄清楚了问题所在。当我的 html 文件中存在语法错误时，`<Normal vector" ...">`不会使用 ，在我的情况下，如果没有此向量，渲染效果会更好。我现在必须弄清楚为什么！

编辑：

法线向量是“错误的”（至少对于 x3dom）。与对象一起生成正确的法线向量就可以了。因此，似乎没有正常比“坏”正常要好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-20T08:35:32.170

HTML5 不能很好地与 X3DOM 一起工作，事实上，X3DOM 是 JavaScript 和 HTML 讨论 Shockwave Flash 语法的结果。我不知道你是如何让它与 HTML5 一起工作的，但建议使用 flash。

好的，我有一些可能有效也可能无效的解决方案。

1\. 使用文本应用程序进入 X3D 文件。（任何，推荐使用TextWrangler）

2.使用另一个3D建模程序。（搅拌机工作正常，所以我推荐它）

3.对象的文件大小是否很大？...（大于~50 MB）因为 X3DOM 正在尝试尽其所能来呈现对象文件。

# internet-explorer-9 - 带有 JCE 编辑器 154 的 Joomla 1.5 - IE9 问题

> ID：10319767
> 
> 赞同：1
> 
> 时间：2012-04-25T16:23:56.943
> 
> 标签：internet-explorer-9, joomla1.5

几年来，我们一直在使用带有 JCE 编辑器 154 的 Joomla 1.5，在任何浏览器中都没有出现任何问题。我们的一些用户现在有 Windows 7 和 Ie9，他们无法保存，并且其他一些命令不起作用。

# .htaccess - 如何使用 RewriteRule 处理 HTTP 和 HTTPS 访问

> ID：10319782
> 
> 赞同：0
> 
> 时间：2012-04-25T16:24:41.700
> 
> 标签：.htaccess, mod-rewrite, https

这是一个 htaccess 文件，可确保网站的每个条目上都有 www：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !^www\.mysite\.com$ [NC]
RewriteRule ^(.*)$ http://www.mysite.com/$1 [R=301,L] 
```

这工作正常，直到站点被访问为“HTTPS://mysite.com”，因为它随后被重写为“HTTP://mysite.com”

如何修改此 htaccess 文件以适用于 http 和 https 情况？该站点上的某些页面设计为 HTTP，而其他页面设计为仅在 HTTPS 中工作。我不是 Mod_rewrite 方面的专家，我一直在为此苦苦挣扎。任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:38:37.810

将您的代码更改为：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /

RewriteCond %{HTTPS}s on(s)|
RewriteCond %{HTTP_HOST} !^www\.mysite\.com$ [NC]
RewriteRule ^ http%1://www.mysite.com%{REQUEST_URI} [R=301,L] 
```

# php - 是什么导致 CPU 负载如此之高（来自 MySQL）？

> ID：10319783
> 
> 赞同：0
> 
> 时间：2012-04-25T16:24:43.287
> 
> 标签：php, mysql, configuration

我的网站最近遇到了 MYSQL 的高 CPU 使用率问题。当我检查 Parallels 电源面板时，它说：“ **/usr/sbin/mysqld --basedir=/ --datadir=/var/lib/mysql --user=mysql --pid-file=/var/lib /mysql/exa.example.com.pid --skip-external-locking** “正在使用高百分比的 CPU 并且站点变得非常慢。

我检查了整个站点上的每个 MySQL 查询，没有什么会导致这样的长期问题。当我禁用站点上的路由文件时，负载会下降（几乎为 0%）。一旦重新打开，最高可达 100%。我今天上班发现服务器因此而宕机。

该数据库的总记录不超过 200,000 条，分为 10 个表。我开始认为进程可能没有完成（挂起）或其他问题。您可以在站点停止之前加载一两个页面。

我应该考虑什么样的想法？我在配置 php 和 mysql 方面有点新手，所以我还没有尝试过太多。

更新：

我已将此添加到 mysql 配置文件中：

```
log-slow-queries = log-slow-queries.log

long_query_time = 5

log-queries-not-using-indexes 
```

这看起来好吗？当然，一旦我添加了这一点，该站点似乎加载得更好了，并且日志文件还没有写入任何内容......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:28:17.563

考虑启用然后检查[慢查询日志](http://dev.mysql.com/doc/refman/5.5/en/slow-query-log.html)，以帮助您找到有问题的查询。

您还说您“检查了每个 MySQL 查询” - 怎么样？您是否`EXPLAIN`为所有人制定了计划？有时查询的行为方式可能出乎您的意料。

# php - 将一个 MySQL 表中的结果按另一个排序，这会将多个值保存到 order 字段中

> ID：10319784
> 
> 赞同：0
> 
> 时间：2012-04-25T16:24:55.730
> 
> 标签：php, mysql, database, web

我正在尝试解决 MySQL 问题，我有两个表：

1.  `CATEGORIES`（列：_id，_name）
2.  `POSTS`（列：_id、_category、_title、_text）

_category 中的字段`POSTS`是`LONGTEXT`并且可以有多个`CATEGORIES`_ID 仅由 分隔，使用 implode(",") PHP 函数。

我尝试用 PHP 列出 10 个最受欢迎的类别，并在 () 中显示其中的帖子，但没有运气。

我对 MySQL 不是很熟悉，我只知道如何使用 SELECT FROM WHERE ORDER LIMIT, INSERT & UPDATE 所以如果有人能给我一个好的解决方案，我会很高兴。我尝试使用 IN() 但 IN() 需要 _category 字段`POSTS`像这样 '1','2','3','4'，现在它的 1,2,3,4 没有引号，所以如果有人知道如何在没有 FIELD TYPE SET 的情况下将此字段转换为列表，我会非常高兴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:32:01.763

您可能希望将关系模型更改为以下内容：

带有列的表 CATEGORIES：

*   `_id`
*   `_name`

带有列的表 POSTS：

*   `_id`
*   `_title`
*   `_text`

带有列的 POSSESS 表：

*   `post_id`（外键）
*   `category_id`（外键）

POSSESS 关系（表）中的元组表示`post_id`属于该`category_id`类别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:33:44.393

关键词是“多对多”关系，如果可能的话，像马克贝克所写的那样重构你的方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:53:25.893

使用 Dyin 建议的模型，您将使用类似这样的方法按受欢迎程度列出前 10 个类别（假设一个类别的帖子越多，它越受欢迎）：

```
SELECT 
  c.*, # get all values for rows in categories
  count(p.post_id) AS post_count # here we are counting the posts for each category using a field alias for the count
FROM (
  categories AS c, # we are aliasing the tables also to shorten the typing a bit
  possess AS p     # you could also use aliases to join the same table multiple times
)
WHERE 
  c.id = p.category_id # link the categories and the possess tables
GROUP BY c.id # without this, the query would just count all posts, this way the result set is separated into groups by category
ORDER BY post_count DESC 
LIMIT 10 
```

鉴于你所说的关于你使用 SQL 的经验，这个查询现在可能看起来有点过头了，但我认为你可以将其作为学习更多知识的起点，一如既往，谷歌是你的朋友。首先研究如何使用外键和连接来链接表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T22:41:54.123

我用过这个：

```
SELECT *, (SELECT COUNT(*) FROM offer WHERE FIND_IN_SET(type._id, offer._type)) AS _count FROM type ORDER BY _count DESC LIMIT 0, 10 
```

现在工作正常，它的表类型（列：_id，_name）和报价（列：..，..，_types，

# sql - 如何使用空值进行 SQL 自联接

> ID：10319788
> 
> 赞同：3
> 
> 时间：2012-04-25T16:25:01.580
> 
> 标签：sql, tsql

我正在使用 MS SQL 2008。我的表如下所示：

```
| Name  | Code | Amt  |
| ----- | ---- | ---- |
| April |  A   | 1.23 |
| Barry |  A   | 2.34 |
| Barry |  B   | 3.45 |
| Cliff |  A   | 4.56 |
| Cliff |  B   | 5.67 |
| Cliff |  C   | 6.78 | 
```

我需要输出是这样的：

```
| Name  | Code_A | Code_B | Code_C |
| ----- | ------ | ------ | ------ |
| April |  1.23  |  NULL  |  NULL  |  
| Barry |  2.34  |  3.45  |  NULL  |
| Cliff |  4.56  |  5.67  |  6.78  | 
```

NULL 可以为零。

通过自我加入，我可以获得 Cliff，但无法获得 Barry 和 April，因为我正在使用类似这样的东西，只有在所有三个条件都可用的情况下才会输出。

```
SELECT     a.Name, a.Amt Code_A, b.Amt Code_B, c.Amt Code_C
FROM       Table_1 as c INNER JOIN
                  Table_1 AS b ON c.Name = b.Name INNER JOIN
                  Table_1 AS a ON b.Name = a.Name 
WHERE     (a.Code = 'A') AND (b.Code = 'B') AND (c.Code = 'C') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:34:33.467

而不是`JOIN`s，我认为a[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410.aspx)在这里更合适：

```
SELECT 
    Name, 
    [A] AS Code_A, 
    [B] AS Code_B, 
    [C] AS Code_C
FROM (
    SELECT Name, Code, Amount
    FROM Table_1
) t
PIVOT (
    SUM(Amount)
    FOR Code IN ([A], [B], [C])
) AS pvt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:40:03.670

一个完全与 sql 引擎无关的方法是：

```
select names.Name, 
   (select sum(a2.Amt) from amounts a2
    where a2.Name = names.Name
       and a2.Code = 'A') as AmtA,
   (select sum(a3.Amt) from amounts a3
    where a3.Name = names.Name
       and a3.Code = 'B') as AmtB,
   (select sum(a4.Amt) from amounts a4
    where a4.Name = names.Name
       and Code = 'C') as AmtC
from (select distinct Name from amounts) as names 
```

在哪里选择唯一的名称集，然后汇总每个特定代码的数量。这更多是为了说明 SQL 的工作原理。

在实践中，我实际上不会在您的情况下使用它——`PIVOT`对于任何支持它的引擎来说，它的效率都会更高。如图所示： [http ://sqlfiddle.com/#!3/7cb0a/5](http://sqlfiddle.com/#!3/7cb0a/5)

# android - Android中按钮的自定义图片？

> ID：10319791
> 
> 赞同：0
> 
> 时间：2012-04-25T16:25:25.180
> 
> 标签：android, json

我想在 Android 中实现一个星星作为按钮，这样当用户想要收藏他们的“当前设置”时，他们触摸星星，然后变成黄色。

你会怎么做？你能改变默认按钮吗？或者你可以只导入图片然后像 OnTouchListener 一样设置吗？

如果有人也可以告诉我如何导入图片（星号），那也将是有益的。

感谢所有的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:27:47.860

声明一个[`ImageButton`](http://developer.android.com/reference/android/widget/ImageButton.html)以星星为背景的。然后，您可以注册一个侦听器，以了解何时按下按钮以显示或移除星星。

注意：在大多数情况下，移除星号相当于将 imagebutton 的背景设置为 null。

要导入星星，请将其放在“res/drawables”目录中，然后在 xml 或 Java 代码中引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:27:31.947

当用户单击它时，您只需更改按钮背景，您只需要有两个星形图像，一个用于选定模式，另一个用于未选定模式。

因此，当用户单击时，您可以切换选择并将所需的图像设置为背景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:31:53.787

我建议你检查 RatingBar 是一个明星。

[http://developer.android.com/reference/android/widget/RatingBar.html](http://developer.android.com/reference/android/widget/RatingBar.html)

RatingBar 是 SeekBar 和 ProgressBar 的扩展，显示星级。使用默认大小的 RatingBar 时，用户可以触摸/拖动或使用箭头键来设置评分。较小的 RatingBar 样式 ( ratingBarStyleSmall) 和较大的仅指标样式 (ratingBarStyleIndicator) 不支持用户交互，只能用作指标。

使用支持用户交互的 RatingBar 时，不鼓励将小部件放置在 RatingBar 的左侧或右侧。

设置的星数（通过 setNumStars(int) 或在 XML 布局中）将在布局宽度设置为包裹内容时显示（如果设置了另一个布局宽度，结果可能无法预测）。

客户端不应修改次要进度，因为它在内部用作部分填充星的背景。

```
<RatingBar
    android:id="@+id/ratingBar1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" android:clickable="true"  android:numStars="1"/> 
```

# django - django 查询设置值（）特定字段以包含用户配置文件

> ID：10319794
> 
> 赞同：0
> 
> 时间：2012-04-25T16:25:28.887
> 
> 标签：django, django-models

我有 2 个这样的 django 模型：

```
class UserProfile(models.Model):
    user             = models.OneToOneField(User)
    organisation     = models.CharField(max_length=200)

class Submission(models.Model):
    user             = models.ForeignKey(User)
    date_submission  = models.DateTimeField(db_index=True, default=datetime.now())
    date_published   = models.DateTimeField(db_index=True, null=True)
    status           = models.CharField(db_index=True, max_length=4000)
    logfile          = models.TextField(db_index=False) 
```

其中每个“提交”对象由普通 django 用户拥有，并且每个用户都有一个使用 AUTH_PROFILE_MODULE 以正常方式配置的 UserProfile。

这如您所料，我可以看到 UserProfile 对象的组织字段：

```
Submission.objects.all()[0].user.userprofile.organisation 
```

当我想序列化提交列表（用于导出到 json）时，通常我使用：

```
Submission.objects.all().values()
# or for more control of fields
Submission.objects.all().values('status', 'date_submission')
# to traverse a relationship.. get info from the User object
Submission.objects.all().values('user__username') 
```

..这些工作正常。但我的问题是我不能：

```
Submission.objects.all().values('user__userprofile__organisation')

raise FieldError("Invalid field name: '%s'" % name)
django.core.exceptions.FieldError: Invalid field name: 'user__userprofile__organisation' 
```

所以看起来 UserProfile 是一个“特例”。这在这里讨论过： [Django 查询：在 user__userprofile 上调用 values()](https://stackoverflow.com/questions/6305017/django-query-call-values-on-user-userprofile)

但解决方案对我没有帮助（我很确定..）

这是 values() 方法的限制吗？有谁知道获得相同的 values() 输出但能够遍历 UserProfile 模型的方法？

感谢您的任何想法

-一世

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:27:46.597

原来升级到 Django 的 1.4 版解决了这个问题，Jingo 的评论表明 1.3.1 也可以。

所以现在我可以：

```
query_set = Submission.objects.filter()
query_set.values('user__userprofile__organisation')
[{'user__userprofile__organisation': u'organisation test 1'}] 
```

干杯

-一世

# java - 有没有办法有时需要来自标准输入的数据，有时不需要来自 Java 的数据？

> ID：10319795
> 
> 赞同：0
> 
> 时间：2012-04-25T16:25:41.513
> 
> 标签：java, pipe, stdin

我正在使用下面的代码在命令行上从标准输入读取 sql 语句：

```
 BufferedReader in = null;
    StringBuilder sb = new StringBuilder();
    String line = null;
    try {
        in = new BufferedReader(new InputStreamReader(System.in));
        while((line = in.readLine()) != null) {
            sb.append(line);
        }
    } finally {
        if (in!=null) in.close();
    } 
```

我的问题是应用程序有时需要使用来自标准输入的数据运行，有时不需要（无管道输入）。如果上述代码中没有输入，则`in.readLine()`阻塞。有没有办法重写这段代码，以便在没有任何管道输入的情况下它仍然可以运行？

更新：该应用程序旨在期望来自命令行的管道数据，而不是来自键盘的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:29:44.320

您可以使用[`ready`](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html#ready%28%29)来测试流是否已准备好数据。如果`ready`返回`false`，则当您调用它时，该流没有准备好数据（它可能在一微秒后接收到数据）。如果您调用`ready`并且它返回`true`，则您知道您可以[`read`](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html#read%28%29)在没有阻塞的情况下调用。（当然，您可能无法在`readLine`没有阻塞的情况下拨打电话。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:43:47.963

我认为没有任何方法可以检查您是否最终会获得另一行输入。请注意，如果用户关闭输入流（例如，在终端中使用 ^D），您当前的代码会终止。

`BufferedReader.ready()`检查流上是否有一些数据。就像 TJ 提到的那样，您可能不走运并在实际收到数据之前就要求提供数据，您的用户会因为您没有回答他们的查询而感到难过。

`Scanner.hasNextLine()`是一个阻塞操作，所以可能不是你要找的。

您可以让用户指定是否从 System.in 读取，例如通过使用命令行参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T17:02:24.807

支持选择性地从标准输入读取的 Unix 实用程序通常会根据它们的命令行确定要做什么。例如，`cat`如果命令行上没有命名文件，将从标准输入读取。您可以按照这些方式做一些事情——添加一个命令行标志或选项或其他东西来指示程序是否应该尝试从标准输入读取任何内容。

如果没有您希望程序读取的输入，另一种方法是从 /dev/null 重定向输入。在这种情况下，您可以从标准输入读取并立即获得文件结束指示。windows 等价于从`NUL`.

如果您确实需要您的程序来检测它是否可以从标准输入读取而不阻塞，请查看`InputStream.available()`. 但是，如果您想支持某人在程序的输入中键入（或将其复制粘贴到终端窗口中），那么在用户实际键入内容之前，InputStream 不会将输入显示为可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T17:06:16.753

这取决于没有管道输入时程序的运行方式。一般来说，一个程序会有一个开放的标准输入，你所能做的就是设置一个计时器，等待一段时间的输入，如果计时器在没有输入的情况下到期，假设不会有任何输入。另一种方法是安排程序在标准输入关闭的情况下运行，在这种情况下，当您尝试阅读时会得到一个 EOF。

要在 unix（包括 Mac OS）中关闭标准输入，您需要编写一个 bash 脚本来启动您的程序：

```
#!/bin/bash

exec 0>&- # close stdin

java -jar yourProgram.jar # run your program 
```

当然，如果您还是从 bash 命令行启动，则不需要脚本：

```
prompt> java -jar yourProgram.jar 0>&- 
```

但是，如果您的程序在 Java EE 容器中运行，我不知道您将如何在启动前关闭标准输入，也许您不能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T17:16:15.953

在 unix 上，您可以检查是否`/proc/self/fd/0`指向文件、管道或来自控制台。

```
$ ls -l /proc/self/fd/0
lrwx------ 1 peter peter 64 Apr 25 18:12 /proc/self/fd/0 -> /dev/pts/21
$ ls -l /proc/self/fd/0 < /dev/null
lr-x------ 1 peter peter 64 Apr 25 18:13 /proc/self/fd/0 -> /dev/null
$ echo Hello World | ls -l /proc/self/fd/0 
lr-x------ 1 peter peter 64 Apr 25 18:13 /proc/self/fd/0 -> pipe:[139250355] 
```

这将告诉您输入是文件、已通过管道传输还是终端。

# iphone - ModalViewController 中的 UIImageView 正在忽略 ContentMode - iPhone

> ID：10319796
> 
> 赞同：2
> 
> 时间：2012-04-25T16:25:42.323
> 
> 标签：iphone, objective-c, uiimageview, xib, contentmode

我正在呈现一个模式视图，其中 UIImageView 设置为内容模式填充比例（通过 xib）。我在模态视图类中使用父类的缩略图设置 UIImage ：

```
NSURL * finishedMovie = [self applicationDocumentsDirectory:@"FinishedVideo.mov"];
MPMoviePlayerController *player = [[MPMoviePlayerController alloc] initWithContentURL:finishedMovie];
UIImage *thumbnail = [player thumbnailImageAtTime:1.0 timeOption:MPMovieTimeOptionNearestKeyFrame];

previewScreen = [[PreviewScreenViewController alloc]initWithNibName:@"PreviewScreenViewController" bundle:nil];
previewScreen.thumbnailImage = thumbnail;
[self presentModalViewController:previewScreen animated:YES]; 
```

然后在模态视图类本身：

```
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view from its nib.
previewImageBox.image = thumbnailImage;

} 
```

问题是，当视图出现时，它似乎忽略了 xib 中设置的内容模式，只是以全尺寸插入图像。

这似乎是一个错误，因为当我返回此视图时，图像正确适合 UIImage 视图。

任何人都可以帮忙吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T15:24:06.840

好的解决了！如果您在代码中手动创建 UIImageView，它似乎可以工作。

```
// Do any additional setup after loading the view from its nib.
//Work around to solve bug in UIToolkit where aspect ratio is ignored when view loads.
imageView = [[UIImageView alloc] initWithFrame:CGRectMake(13, 87, 294, 164)];
//Set the image to our thumbnail.
[self.view addSubview:imageView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T00:10:53.387

您很可能将`clipsToBounds`属性设置为`NO`. 这将防止`UIImageView`剪切其矩形之外的内容。您可以设置图层`borderColor`的`UIImageView`，看看这是否真的发生了。

# ruby-on-rails - formtastic select，默认选择一个条目

> ID：10319797
> 
> 赞同：8
> 
> 时间：2012-04-25T16:25:43.807
> 
> 标签：ruby-on-rails, formtastic

我有一个我渲染的输入：as => :select。我希望选择一个选项作为默认选项。我该怎么做呢？

谢谢，亨德里克

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-29T18:59:21.863

如果您不是从模型中制作表格。

```
= semantic_form_for :report do |f|
  = f.inputs name: 'Choose a Report Year' do
    = f.input :report_year, collection: options_for_select(['2010', '2011', '2012', '2013'], '2012')
    = f.action :submit, label: 'Submit Year', as: :button 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-30T12:28:49.490

因此，设置一个预先选择的答案，您必须将您的对象与所需的值相关联。

```
countries = ['USA','Germany']
@user.country = countries.first 
```

这对我行得通。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-25T16:34:02.380

您可以在 formtastic wiki 中阅读有关此内容的信息。在询问任何内容之前，请务必查看 gem 自述文件。这是一个[链接。](https://github.com/justinfrench/formtastic/wiki/Deprecation-of-%3aselected-option)祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-27T18:14:46.587

如果您没有关联模型到 semantic_form_for 中，您可以这样做：

```
f.inputs do
  f.input :service_type, :as => :radio,
          :collection => [
                           ['Group', 'Group', { :'checked' => 'checked' }],
                           ['Device', 'Device', {}]
                         ]
end 
```

# c - C - unsigned int 到 unsigned char 数组转换

> ID：10319805
> 
> 赞同：19
> 
> 时间：2012-04-25T16:26:06.553
> 
> 标签：c, byte, unsigned-integer, type-conversion, unsigned-char

我有一个无符号整数（2 字节），我想将其转换为无符号字符类型。从我的搜索中，我发现大多数人建议执行以下操作：

```
 unsigned int x;
 ...
 unsigned char ch = (unsigned char)x; 
```

是正确的方法吗？我问是因为 unsigned char 是 1 字节，我们将 2 字节数据转换为 1 字节。

为了防止任何数据丢失，我想创建一个 unsigned char[] 数组并将各个字节保存到数组中。我陷入了以下困境：

```
 unsigned char ch[2];
 unsigned int num = 272;

 for(i=0; i<2; i++){
      // how should the individual bytes from num be saved in ch[0] and ch[1] ??
 } 
```

另外，**我们如何将 unsigned char[2] 转换回 unsigned int**。

非常感谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-25T16:29:38.317

您可以`memcpy`在这种情况下使用：

```
memcpy(ch, (char*)&num, 2); /* although sizeof(int) would be better */ 
```

> 此外，如何将 unsigned char[2] 转换回 unsigned int。

同样的方法，只是颠倒 memcpy 的参数。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-25T16:28:52.433

怎么样：

```
ch[0] = num & 0xFF;
ch[1] = (num >> 8) & 0xFF; 
```

逆运算留作练习。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-04-25T16:31:21.213

使用工会怎么样？

```
union {
    unsigned int num;
    unsigned char ch[2];
}  theValue;

theValue.num = 272;
printf("The two bytes: %d and %d\n", theValue.ch[0], theValue.ch[1]); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-04-25T16:54:42.823

这实际上取决于您的目标：为什么要将其转换为`unsigned char`? 根据答案，有几种不同的方法可以做到这一点：

*   **截断**：这是推荐的。如果您只是想将数据压缩到需要 的函数中`unsigned char`，则只需强制转换`uchar ch = (uchar)x`（当然，请注意如果您的 int 太大会发生什么）。

*   **特定字节序**：当您的目的地需要特定格式时使用它。通常网络代码喜欢将所有内容转换为大端字符数组：

    ```
    int n = sizeof x;
    for(int y=0; n-->0; y++)
        ch[y] = (x>>(n*8))&0xff; 
    ```

    会这样做。

*   **机器字节序**。当没有字节序要求时使用它，并且数据只会出现在一台机器上。阵列的顺序将在不同的架构中发生变化。人们通常用`union`s 来处理这个问题：

    ```
    union {int x; char ch[sizeof (int)];} u;
    u.x = 0xf00
    //use u.ch 
    ```

    与`memcpy`：

    ```
    uchar ch[sizeof(int)];
    memcpy(&ch, &x, sizeof x); 
    ```

    或者使用非常危险的简单转换（这是未定义的行为，并且在许多系统上崩溃）：

    ```
    char *ch = (unsigned char *)&x; 
    ```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-25T16:33:43.803

当然，足够大以包含更大值的字符数组必须与该值本身一样大。所以你可以简单地假设这个更大的值已经是一个字符数组：

```
unsigned int x = 12345678;//well, it should be just 1234.
unsigned char* pChars;

pChars = (unsigned char*) &x;

pChars[0];//one byte is here
pChars[1];//another byte here 
```

（一旦你明白了发生了什么，它可以在没有任何变量的情况下完成，所有只是铸造）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-25T16:37:02.967

您只需要使用`bitwise & operator`. `OxFF`是提取一个字节的十六进制掩码。请在这里查看各种位操作 - [http://www.catonmat.net/blog/low-level-bit-hacks-you-absolutely-must-know/](http://www.catonmat.net/blog/low-level-bit-hacks-you-absolutely-must-know/)

一个示例程序如下：

```
#include <stdio.h>

int main()
{
    unsigned int i = 0x1122;
    unsigned char c[2];

    c[0] = i & 0xFF;
    c[1] = (i>>8) & 0xFF;

    printf("c[0] = %x \n", c[0]);
    printf("c[1] = %x \n", c[1]);
    printf("i    = %x \n", i);

    return 0;
} 
```

输出：

```
$ gcc 1.c 
$ ./a.out 
c[0] = 22 
c[1] = 11 
i    = 1122 
$ 
```

# python - Python：wget 在 Eclipse 中不起作用

> ID：10319808
> 
> 赞同：0
> 
> 时间：2012-04-25T16:26:14.793
> 
> 标签：python, eclipse

当我从命令行运行以下功能时，以下功能有效`python test.py`

```
 def get_pdb(self,pdb):

        import os
        from subprocess import call

        os.chdir('./mobcal_data/PDBs/')
        call(["wget", "http://www.pdb.org/pdb/files/2kqx.pdb"]) 
```

但是当我尝试用 eclipse 运行它时，我得到以下信息`OSError`

```
OSError: [Errno 2] No such file or directory 
```

我不明白为什么当我从命令行而不是在 Eclipse 中运行脚本时它会起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:30:09.983

我可能错了，但我认为错误实际上可能来自`os.chdir()`通话。

根据您是手动运行脚本还是通过 Eclipse 运行脚本，您可能有不同的工作目录。尝试在脚本中的某处添加以下行来检查：

```
print os.getcwd() 
```

如果这是问题所在，您可能需要在调用中使用绝对路径而不是相对路径`os.chdir()`，或者更改 Eclipse 中的配置以在预期位置启动脚本。 [这个答案](https://stackoverflow.com/a/3089474/505154)有一些关于如何做到这一点的说明。

# c++ - Solaris 上的 UCS-4 到多字节转换

> ID：10319810
> 
> 赞同：0
> 
> 时间：2012-04-25T16:26:23.013
> 
> 标签：c++, unicode, solaris, multibyte

为什么这段代码：

```
char a[10]; 
wchar_t w[10] = L"ä"; // German a Umlaut
int e = wcstombs(a, w, 10); 
```

返回 e == -1？

我在 Solaris 11 上使用 Oracle Solaris Studio 10。语言环境是 Latin-1，其中包含德语变音符号。我发现的所有文档都表明（对我而言）转换应该成功。

如果我这样做：

```
char a[10] = "ä"; // German a Umlaut
wchar_t w[10];
int e = mbstowcs(w, a, 10);
e = wcstombs(a, w, 10); 
```

没有错误，但结果是错误的。（上 A 的一些变体。）

我也尝试了类似结果的 wstostr。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T17:19:20.657

1) 验证进入 wchar_t 的值是否正确。生成宽字符串文字的编译器必须将`L"ä"`源代码编码转换为宽执行字符集。

2) 验证程序的语言环境是否正确。你可以这样做`printf("%s\n", setlocale(LC_ALL, NULL));`

我怀疑问题是 1) 因为对我来说，即使程序的语言环境设置不正确，我仍然可以获得预期的输出。为避免源代码编码出现问题，您可以转义非 ascii 字符，例如`L"\x00E4"`.

```
 1  #include <iostream>
 2  #include <clocale>
 3
 4  int main () {
 5    std::printf("%s\n", std::setlocale(LC_ALL, NULL));   // prints "C"
 6
 7    char a[10];
 8    wchar_t w[10] = L"\x00E4"; // German a Umlaut
 9    std::printf("0x%04x\n", (unsigned)w[0]);             // prints "0x00e4"
10
11    std::setlocale(LC_ALL, "");
12    printf("%s\n", std::setlocale(LC_ALL, NULL));        // print something that indicates the encoding is ISO 8859-1
13    int e = std::wcstombs(a, w, 10);
14    std::printf("%i 0x%02x\n", e, (unsigned char)a[0]);  // print "1 0xe4"
15  }
16 
```

* * *

### C 和 C++ 程序中的字符集

在您的源代码中，您可以使用“源字符集”中的任何字符，它是“基本源字符集”的超集。编译器会将字符串和字符文字中的字符从源字符集中转换为执行字符集（或宽字符串和字符文字的宽执行字符集）。

问题是源字符集依赖于实现。通常，编译器只需要知道您对源代码使用什么编码，然后它将接受来自该编码的任何字符。GCC 具有用于设置源编码的命令行参数，Visual Studio 将假定源在用户的代码页中，除非它检测到 UTF-8 或 UTF-16 的所谓 Unicode 签名之一，并且 Clang 当前始终使用 UTF- 8.

一旦编译器为您的代码使用正确的源字符集，它将在“执行字符集”中生成字符串和字符文字。执行字符集是基本源字符集的另一个超集，也依赖于实现。GCC 采用命令行参数来设置执行字符集，VS 使用用户的语言环境，Clang 使用 UTF-8。

因为源字符集依赖于实现，所以在基本集之外写入字符的可移植方式是使用十六进制编码直接指定要在执行中使用的数值，或者（如果您不使用 C89/90）使用通用字符名称 (UCN)，将其转换为执行字符集（或用于宽字符串和字符文字时的宽执行字符集）。UCN 看起来像 \uNNNN 或 \UNNNNNNNN，并使用代码点值 NNNN 或 NNNNNNNN 指定 Unicode 字符集中的字符。（请注意，C99 和 C++11 禁止您使用代理代码点，如果您想要来自 BMP 外部的字符，只需使用 \U 直接写入该字符的值。）

源和执行字符集是在编译时确定的，不会根据运行程序的系统的语言环境而改变。也就是说，程序语言环境使用了另一种不一定与执行字符集匹配的编码。但是，宽执行字符集应与支持的语言环境使用的宽字符编码相对应。

* * *

### Solaris Studio 的行为

Oracle 的 Solaris 编译器具有非常简单的行为。对于窄字符串和字符文字，没有指定特定的源编码，源代码中的字节直接用作执行文字。这实际上意味着执行字符集与源文件的编码相同。对于宽字符文字，源字节使用系统语言环境进行转换。这意味着您必须使用语言环境编码保存源文件才能获得正确的宽文字。

我怀疑您的源代码以不同于语言环境指定的编码保存，因此您的编译器无法从`L"ä"`. 您的编辑器可能正在使用 UTF-8。您可以使用以下程序进行检查。

```
 1  #include <iostream>
 2  #include <clocale>
 3
 4  int main () {
 5    wchar_t w[10] = L"ä"; // German a Umlaut
 6    std::printf("0x%04x 0x%04x\n", (unsigned)w[0], (unsigned)w[1]);
 7  }
 8 
```

由于 wcstombs 可以正确地将宽字符 0x00E4 转换为 'ä' 的 latin-1 编码，因此您希望上面显示`0x00E4 0x0000`. 如果源代码编码是 UTF-8，那么您应该看到`0x00C3 0x00A4`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T17:18:26.080

您可能必须设置语言环境才能理解德语。具体来说，您需要 ctype 方面。

试试这个：

```
setlocale( LC_ALL, ".1252" ); 
```

或者特别是这个：

```
setlocale( LC_CTYPE, ".1252" ); 
```

您可能必须搜索比“.1252”更好的代码页。祝你好运。

上面的代码页示例是 Windows。在 Unixy 系统上，尝试使用“de_DE”作为代码页。

# c# - 从 url 下载图像并在 wp7 的图像控件中打开它

> ID：10319817
> 
> 赞同：2
> 
> 时间：2012-04-25T16:26:34.227
> 
> 标签：c#, windows-phone-7, windows-phone-7.1

我正在制作一个 WP7 应用程序，它可以下载我所有的 Twitter 提要。在此，我想下载所有个人资料图像并将它们存储在本地并使用它们，以便每次打开应用程序时都会下载它们。请建议任何这样做的方法。

**我在做什么**：使用 WebClient 下载图像

```
public MainPage()
    {
        InitializeComponent();

        WebClient client = new WebClient();
        client.DownloadStringCompleted += new DownloadStringCompletedEventHandler(client_DownloadStringCompleted);
        client.DownloadStringAsync(new Uri("http://www.libpng.org/pub/png/img_png/pnglogo-blk.jpg"));
    } 
```

并将其存储到文件中。

```
 void client_DownloadStringCompleted(object sender, DownloadStringCompletedEventArgs e)
    {            
        using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
        {
            if (myIsolatedStorage.FileExists(fileName1))
                myIsolatedStorage.DeleteFile(fileName1);

            var fileName1 = "Image.jpg";
            using (var fileStream = new IsolatedStorageFileStream(fileName1, FileMode.Create, myIsolatedStorage))
            {
                using (var writer = new StreamWriter(fileStream))
                {
                    var length = e.Result.Length;
                    writer.WriteLine(e.Result);
                }
                var fileStreamLength = fileStream.Length;
                fileStream.Close();
            }
        } 
```

现在我正在尝试将图像设置为 BitMapImage

```
BitmapImage bi = new BitmapImage();

using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
{
    using (IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile(fileName1, FileMode.Open, FileAccess.Read))
    {
         var fileStreamLength2 = fileStream.Length;
         bi.SetSource(fileStream);
    }
} 
```

但我无法设置 BitmapImage 的来源。它抛出 System.Exception 并没有什么特别的。我做对了吗？我是说程序。

**编辑**另一个观察是 fileStreamLength 和 fileStreamLength2 是不同的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T17:40:01.910

您不应该使用 DownloadString 来下载二进制文件。请改用 OpenReadAsync，并将二进制数组保存到隔离存储中。

DownloadString 会尝试将您的数据转换为 UTF-16 文本，这在处理图片时当然不可能正确。

# simple.data - 魔术铸造到结果的集合

> ID：10319820
> 
> 赞同：0
> 
> 时间：2012-04-25T16:26:42.500
> 
> 标签：simple.data

在 Simple.Data 示例中，有一个“Magic Casting”示例：

```
// When you assign the dynamic record to a static type, any matching properties are auto-mapped.
var db = Database.Open();
Customer customer = db.Customers.FindByCustomerId(1); 
```

如果返回多条记录，Simple.Data 是否也会神奇地转换？像这样的东西：

```
var db = Database.Open();
IEnumerable<Customer> customers = db.Customers.FindBySurname("Smith"); 
```

显然我已经尝试了上述方法，但它不起作用（“无法将类型隐式转换”从 SimpleQuery 到我的具体类型）。任何的建议都受欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:29:39.963

FindBySurname 返回一条记录。如果你使用 FindAllBySurname，你会得到一个可枚举的，它应该是魔法施法好的。（如果由于某种原因没有，您可以调用 .Cast() 。）

# asp.net-mvc - 从视图中获取程序集名称

> ID：10319824
> 
> 赞同：0
> 
> 时间：2012-04-25T16:27:01.153
> 
> 标签：asp.net-mvc, stack-trace, .net-assembly

目前我遇到了下一个问题：我有本地化类，它是静态的，在项目的一个程序集中指定（让我们将其命名为 Proj.Common）。而且我有许多实现某些功能的插件。每个插件都是独立的程序集，有自己的视图。为了本地化消息，我制作了通过`Assembly.GetCallingAssembly.GetName().Name`. 但是视图被编译为单独的程序集，因此当视图调用本地化类时，我不知道哪个插件具有该视图。我如何获得调用程序集的名称，而不是编译视图的程序集。谢谢你。是的，我的应用程序是 MVC 2 ASP.Net 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:58:27.700

假设您可以访问函数中的 MVC 对象，您可以调用`ViewContext.Controller.GetType()`.

# javascript - 将一个值除以另一个

> ID：10319838
> 
> 赞同：0
> 
> 时间：2012-04-25T16:27:41.890
> 
> 标签：javascript, math

我有一些来自某人的代码，但想知道他们为什么会使用这样的函数。

```
 this.viewable= 45;

    getGroups: function() {

        return Math.ceil( this.getList().length / this.viewable );
    } 
```

他们为什么要将列表长度除以可查看的数字。结果是应该在屏幕上呈现的项目数量。为什么不直接说 45 是这个数字。它是否意味着成为列表的百分比。通常我会将一个较大的值除以一个较小的值来获得百分比。

对不起，如果这看起来像一个愚蠢的数学问题，但我的数学技能是垃圾:) 只是试图理解和学习一些简单的数学技能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:33:10.410

它返回显示列表所需的组（页）数。将其声明为变量（相对于在公式中使用常量）的原因是它可以在一个地方轻松修改。很可能这是插件的一部分，可以从外部修改视图长度，所以这个声明提供了一个句柄，默认值为 45。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:30:12.987

这将给出查看它们所需的页数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:30:24.267

我猜你可以在一个页面上放置 45 个项目，这是计算页数。或者类似的东西？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-25T16:31:21.957

这将返回**总页数**。

> 项目总数 = 100（例如）
> 
> 可见 = 45
> 
> 100 / 45 = 2.22222....
> 
> 数学.ceil(2.2222) = 3
> 
> 因此 3 页

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T16:35:11.880

从函数名称“getGroups”来看，viewable 是显示项目的能力（可能是一些界面列表大小）。通过进行这种划分，我们知道数据将被划分（分组）多少页以便在界面上查看。**ceil**函数保证我们不会遗漏部分页面，如果我们留下了没有填满完整页面的记录，我们仍然想显示它们，因此让它们计入页面。

# java - 编译后 JSF 页面和配置文件中的注释

> ID：10319843
> 
> 赞同：0
> 
> 时间：2012-04-25T16:28:04.553
> 
> 标签：java, jsf, jsf-2, comments, facelets

当我在 Netbeans 中编译 JSF 页面时，我很感兴趣 JSF 页面和 faces-config.xml 文件中的注释会发生什么？它们是保留还是被编译器删除。如果它们被保留，我可以以某种方式删除它们吗？我知道编译器会删除 Java bean 代码中的注释，但我不确定 JSF 页面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-25T16:42:14.560

对于 JSF 页面，您可以在 中使用以下上下文参数`web.xml`：

```
<context-param>
    <param-name>javax.faces.FACELETS_SKIP_COMMENTS</param-name>
    <param-value>true</param-value>
</context-param> 
```

配置文件未处理。

# python - TypeError：在列表上使用“sum()”时，“NoneType”对象不可迭代

> ID：10319846
> 
> 赞同：0
> 
> 时间：2012-04-25T16:28:10.437
> 
> 标签：python, list, sum, nonetype

我正进入（状态

```
TypeError: 'NoneType' object is not iterable 
```

当我尝试查找列表的总和时。

出现问题的地方：

```
if(sum(self._candidates) + self._allCandidates[self._depth]._weight > 20):
    self._left = Node(self._candidates, self._depth + 1, self._allCandidates)
else:
    self._left = Node(self._candidates.append(self._allCandidates[self._depth]), self._depth + 1, self._allCandidates) 
```

节点定义：

```
def __init__(self, candidates = [], depth = -1, allCandidates = []):
        self._candidates = candidates
        self._depth = depth
        self._allCandidates = allCandidates 
```

感谢您对此事的任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:31:00.340

这是错误的：

```
Node(self._candidates.append(self._allCandidates[self._depth]) 
```

的返回值`.append`是`None`，因此是错误。

# python - 在 Python 2.7 中是否有一种通用的方法来迭代 dict 的集合或值？

> ID：10319850
> 
> 赞同：2
> 
> 时间：2012-04-25T16:28:19.300
> 
> 标签：python

我希望该集合是一个集合或一个字典。问题是：

```
for element in collection:
    print element 
```

如果集合是一个集合，会给我元素，但如果集合是一个字典，就会给我索引。我想要的是一个可以迭代 dict 值的单行代码。

那可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-25T16:32:30.550

测试映射最简单的方法是使用`isinstance`on [`collections.Mapping`](http://docs.python.org/library/collections.html#collections.Mapping)：

```
import collections

for element in (collection.values() 
                if isinstance(collection, collections.Mapping) else collection): 
```

如果你需要经常这样做（你不应该这样做，或者你可能有设计问题），你可以把它移到一个函数中：

```
def values(collection):
    return (collection.values() 
                  if isinstance(collection, collections.Mapping) else collection)

for element in values(collection): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:42:00.567

```
import collections

def values(collection):
    for v in collection.values() if isinstance(collection, collections.Mapping) else collection:
        yield v

for element in values(collection):
    print element 
```

编辑：我[`collections.Mapping`从 agf 复制了建议](https://stackoverflow.com/a/10319923/5987)。我的答案因将解决方案实现为函数而有所不同。我发现 Python 对于将问题分解为可重用的部分非常有用。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-04-25T16:48:54.013

怎么样：

```
def vals(c):
    try: return c.values()
    except: return c

for a in vals(whatever):
    ... 
```

特别是对于那些被洗脑的人除了是“坏习惯”之外：

```
find "/System/Library/Frameworks/Python.framework" -name "*.py" | xargs grep "except:" | wc -l
2901 
```

去告诉他们。

# ruby-on-rails - 想要使布尔字段的行为类似于带有关联对象的单选按钮

> ID：10319851
> 
> 赞同：0
> 
> 时间：2012-04-25T16:28:22.230
> 
> 标签：ruby-on-rails, ruby

我的应用程序有一个 Image 类，多态关联到不同的类。所以这些对象中的每一个都有一组图像，我希望能够将其中一个设置为特色图像。

因此，我`is_featured`在 Image 类中添加了一个字段，并且我想确保每个关联对象只有一个图像，并将该字段设置为 true。

所以我试图覆盖这个字段的setter方法。这是我到目前为止得到的，但它不起作用（它没有将其余`is_featured`字段设置为`false`）：

```
def is_featured=(is_featured_value)
  if is_featured_value == true
    current_featured = self.imageable.featured_image
    if current_featured and current_featured != self
      current_featured.write_attribute(:is_featured, false)
    end
  end
  super(is_featured_value)
end 
```

有谁知道什么不起作用？

顺便说一句，我知道可能有更好的方法来做到这一点，比如`featured_image_id`在关联对象中使用一个字段，但在这一点上，我想知道如何使它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:01:54.287

您需要遍历所有未执行的 OTHER 记录。我认为您认为对 super 的调用可能会为您执行此操作，但事实并非如此。

你需要它看起来像：

```
def is_featured=(is_featured_value)
  if is_featured_value == true
    ???.each do |i|
       if i.id == self.id
         i.is_featured = true
       else
         i.is_featured = false
       end
    end
  else
    self.is_featured = false
  end
end 
```

怎么办 ？？？这取决于您如何建立关系，您没有显示足够的代码来确定。

# c# - 用户控件运行时宽度和高度

> ID：10319852
> 
> 赞同：6
> 
> 时间：2012-04-25T16:28:31.400
> 
> 标签：c#, visual-studio-2008, .net-3.5, user-controls

我正在尝试在 VS2008 中创建一个简单的用户控件（不是 WPF），它实际上是一个`SplitContainer`带有按钮的`Panel1`，当按下时，它会切换`Panel2Collapsed`属性并将控件的大小调整为`Panel1`.

以下是控件的基本内容：

```
private int _openHeight;
private int _closedHeight;

public MyUserControl(bool open)
{
  InitializeComponent();

  _openHeight = this.Height;
  _closedHeight = splitContainer1.SplitterDistance;
  Open = open;  
}    

private bool _open;
private bool Open
{
  get { return _open; }
  set 
  { 
    _open = value;
    splitContainer1.Panel2Collapsed = !_open;
    this.Height = _open ? _openHeight : _closedHeight;
  }
}

private void button1_Click(object sender, EventArgs e)
{
  Open = !Open;
} 
```

问题是`this.Height`在运行时是控件在用户控件设计器中的值，而不是在主窗体设计器的设计时设置的值。

任何帮助将不胜感激。

**更新**

继 Lucas 的解决方案之后，这种方式意味着 _openHeight 只设置一次，从而产生预期的效果：

```
private int? _openHeight;
private int _closedHeight;

public MyUserControl(bool open)
{
  InitializeComponent();

  //the _closedHeight doesn't change so can be defined in the constructor
  _closedHeight = splitContainer1.SplitterDistance;

  //set value
  Open = open;  

  this.SizeChanged += new EventHandler(MyUserControl_SizeChanged);
  this.Load += new EventHandler(MyUserControl_Load);
}    

void MyUserControl_SizeChanged(object sender, EventArgs e)
{
  //this event is called BEFORE the _Load event so gets the height set in the designer
  //  and not any changes at run time (e.g. when you collapse the control)

  if (_openHeight == null)
    _openHeight = this.Height;
}

private bool _open;
private bool Open
{
  get { return _open; }
  set 
  { 
    _open = value;

    if (_open)
    {
      //sets height only if it has been initialized
      if (_openHeight != null)
        this.Height = (int)_openHeight;
    }
    else
    {
      this.Height = (int)_closedHeight;
    }
  }
}

void MyUserControl_Load(object sender, EventArgs e)
{
  //now that control is loaded, set height
  Open = Open;
}

private void button1_Click(object sender, EventArgs e)
{
  Open = !Open;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T17:14:56.083

您正在它的构造函数中读取控件的 Height 属性，这意味着它可能在它显示在表单中之前。问题是，当需要在表单中显示控件时，似乎调整了大小。在此之前，它是在控件设计器中设置的值，您现在可以得到它。

解决该问题的最简单方法是`Height`在您确定控件已在表单中绘制时读取该值，即您可以从`open`控件的构造函数中获取参数，添加一个初始化的新方法，`Open`并在发生以下情况时`_closedHeight`调用它`Load`表格。

像这样的东西：

```
public MyUserControl()
{
    InitializeComponent(); 
}

public AdjustControlSize(bool open)
{
    _openHeight = this.Height;
    _closedHeight = splitContainer1.SplitterDistance;
    Open = open; 
}

//the rest of the control's code is unchanged
... 
```

`AdjustControlSize`然后从表单的`Load`事件中调用方法。

**事件机制的解决方案**

您还可以`Height`在适当的时候使用控件自己的事件来读取。这样您就不必更改`Form`'s 代码中的任何内容。

所以，在这种情况下，代码看起来像这样（虽然我还没有测试过）：

```
public MyUserControl(bool open)
{
    InitializeComponent();

    _openHeight = this.Height;
    _closedHeight = splitContainer1.SplitterDistance;
    Open = open;
    this.SizeChanged += new EventHandler(MyUserControl_SizeChanged);
}

void CustomPictureBox_SizeChanged(object sender, EventArgs e)
{
    _openHeight = this.Height;
    _closedHeight = splitContainer1.SplitterDistance;
} 
```

这样，控件可以在每次更改其大小时自行调整。

# php - 在 SQL/PHP 中使用三个术语进行查询

> ID：10319854
> 
> 赞同：1
> 
> 时间：2012-04-25T16:28:40.617
> 
> 标签：php, mysql, sql

我正在使用 WordPress，但这个问题更与所涉及的 SQL 有关。如果需要，我会很乐意移动它。

我正在研究[http://www.libertyguide.com/jobs](http://www.libertyguide.com/jobs)，并且正在尝试更改过滤机制。目前它是一个全局`OR`查询。

无论如何，我有三个过滤列表，我通过以下方式将选择的内容存储到三个字符串（兴趣、类型、经验）中：

```
"( $wpdb->terms.slug = 'webdevelopment' OR $wpdb->terms.slug = 'journalism' OR ... ) AND" 
```

它由我的过滤列表中选择的任何内容填充。

归根结底，我将此作为基本查询（我省略了`LEFT JOINS`）：

前：

```
SELECT * FROM $wpdb->posts WHERE ($wpdb->terms.slug = 'fromlist1' 
OR $wpdb->terms.slug = 'fromlist2' OR $wpdb->terms.slug = 'fromlist3') 
AND $wpdb->term_taxonomy.taxonomy = 'jobtype'... 
```

后：

```
SELECT * FROM $wpdb->posts WHERE 
($wpdb->terms.slug = 'fromlist1' OR $wpdb->terms.slug = 'fromlist1again') 
AND ($wpdb->terms.slug = 'fromlist2' OR $wpdb->terms.slug = 'fromlist2again') 
AND ($wpdb->terms.slug = 'fromlist3' OR $wpdb->terms.slug = 'fromlist3again') 
AND $wpdb->term_taxonomy.taxonomy = 'jobtype'... 
```

所以本质上我想从一个

`OR`筛选

**至**

中间`AND`有过滤的过滤器`OR`。

我的新过滤仅在整体选择一项时有效，但当我选择多于一项时（我知道会与几篇文章匹配），则不返回任何内容。

我已经仔细考虑了逻辑，我认为它没有任何问题。我知道其他任何事情都没有问题，所以它必须是查询本身。

朝着正确方向迈出的任何一步将不胜感激。谢谢！

**更新** 从混乱中，基本上我有这个：

```
"SELECT ...... WHERE $terms ..." 
```

但我想要

```
"SELECT ....... WHERE $interests AND $type AND $experience" 
```

我不想让它过滤`$interest[1] OR $interest[2] OR $type[1] OR $experience[1]`，而是希望它过滤`($interest[1] OR $interest[2]) AND ($type[1]) AND ($experience[1])`

我希望这更有意义

****更新 2* ***

这是和示例：

在我的兴趣列表中，我选择了三件事：WebDevelopment、Academia、Journalism。

在我的类型列表中，我选择了两件事：全职，兼职

在我的经验列表中，我选择了三件事：Earlycareer、Midcareer、Latecareer。

当我运行查询时，我想确保每条记录至少包含三个列表中的每一个。可能的结果：（网络开发、兼职、职业中期）、（学术界、全职、早期职业、职业中期）。

不是结果：（新闻，早期职业） - 缺少全职或兼职

我真的希望这能更清楚。如果我能正常工作，我愿意给予补偿。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:48:58.473

好的，我将对此进行拍摄：

```
SELECT * FROM $wpdb->posts WHERE
(
$wpdb->terms.slug IN ('$interest1', '$interest2') AND 
$wpdb->terms.slug IN ('$type1', '$type2') AND 
$wpdb->terms.slug IN ('$exp1', '$exp2')
)
AND $wpdb->term_taxonomy.taxonomy = 'jobtype' 
```

如果集合的`IN`任何成员匹配，则关键字将返回 true。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T18:02:29.217

我认为您正在寻找`WHERE category IN (comma, seperated, list, of, values)`可以从表单动态生成的。如果将其与其他类别结合使用，则可以要求他们从每个类别中选择一些...

```
 WHERE category1 IN (a, comma, seperated, list, of, values)
 AND   category2 IN (another, list, of, values)
 AND ... 
```

如果从每个类别中选择了某些内容，它将仅返回一个值，如果任何选择列表为空，则不会返回任何内容；实际上它很可能会抛出一个错误，所以如果给定类别有任何内容，我也会动态生成查询。

```
if (!empty($arrayOfCategory1)) {  
    //sanitize input logic here  
    $Category[1] = 'category1 IN ('. implode(', ', $arrayOfCategory1) .')';  
} else {  
    $Category[1] = '';  
} 
```

您将结果字符串连接在一起并使用它构建查询。这个`WHERE 1=1`技巧是有问题的，因为如果什么都不选择，数据库中的所有内容都会匹配，所以我强烈建议通过`AND`正确添加运算符的过程。

编辑：在我看来，如果你将条件语句构建为一个数组，你可以用相当少的代码行来内爆这些条件语句并获取查询*。*`' AND '`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:58:42.997

你所说的有点困惑，但如果我想构建一个过滤器，我会根据提交的过滤器值动态生成 SQL 查询。就像是：

```
$sql = "SELECT * FROM $wpdb->posts WHERE 1=1";
if ( !empty($interest) ) { // they ticked the interested in ??? checkbox
    $sql .= " AND $wpdb->terms.slug = $interest"
} 
```

显然，您需要过滤和转义任何已提交的值。

# database - 将现有数据库克隆到新数据库

> ID：10319855
> 
> 赞同：2
> 
> 时间：2012-04-25T16:28:44.710
> 
> 标签：database, sql-server-2008, schema, transfer, management-studio-express

我正在努力寻找合适的解决方案。我有一个相当大的 SQL Server 2008 Express 数据库，其中包含 60 多个表（许多具有关键约束）和一大堆数据。

我需要将所有这些表、数据和约束从一个数据库准确复制到另一个数据库。我基本上是在复制网站 A - 以在不同的域上生成一个精确的副本（网站 B），因此我们最终会得到两个完全相同的网站并行运行，每个网站都有自己相同的数据库开始。

数据库 A 已在网站 A 上启动并运行。数据库 B 已设置并拥有自己的用户。我只需要从 A 到 B 获取完整的表和数据。我可以修改我的 web.config 连接以使用数据库 B 的登录凭据，它应该可以工作。

我尝试通过 Management Studio Express 备份数据库 A 并恢复到数据库 B，但它告诉我：

> System.Data.SqlClient.SqlError：备份集包含数据库的备份，而不是现有的“数据库-B”数据库。
> (Microsoft.SqlServer.Smo)

我还尝试在 Management Studio Express 中右键单击数据库 A 并转到`Tasks > Generate scripts`. 但是，当我这样做并在数据库 BI 上运行 SQL 脚本时，会在导入内容时遇到与外键等有关的大量错误。似乎它在做正确的事情，但无法处理不同的键/关系。

那么，有没有人知道一种简单、可靠的方法，可以让我的数据 100% 准确无误地从数据库 A 到数据库 B？

我想我大约在 5 年前使用 SQL Server 数据库发布向导来执行类似的操作，但该产品现在似乎已经失效 - 我尝试安装它，它希望我将我的 SQL Server 版本回归到 2005，所以我我不去那里！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-25T16:35:41.190

不要为此使用 UI。如果您不熟悉 BACKUP/RESTORE 的各个方面，那么 UI 只会将您引向错误的道路，从而获得许多选项。最简单的备份命令是：

```
BACKUP DATABASE dbname TO DISK = 'C:\some folder\dbname.bak' WITH INIT; 
```

现在要将其还原为不同的数据库，您需要知道文件名，因为它会尝试将相同的文件放在同一个位置。因此，如果您运行以下命令：

```
EXEC dbname.dbo.sp_helpfile; 
```

您应该会看到包含数据和日志文件的名称和路径的输出。当你构建你的恢复时，你需要使用这些，但是将路径替换为新数据库的名称，例如：

```
RESTORE DATABASE newname FROM DISK = 'C\some folder\dbname.bak'
  WITH MOVE 'dbname' TO 'C:\path_from_sp_helpfile_output\newname_data.mdf',
  MOVE 'dbname_log' TO 'C:\path_from_sp_helpfile_output\newname_log.ldf'; 
```

您必须将`dbname`and替换`newname`为您的实际数据库名称，以及`some folder`您`C:\path_from_sp_helpfile_output\`的实际路径。除非我知道那些是什么，否则我无法更具体地回答。

* * *

** 编辑 **

这是一个完整的复制品，对我来说完全没问题：

```
CREATE DATABASE [DB-A];
GO

EXEC [DB-A].dbo.sp_helpfile; 
```

部分结果：

```
name     fileid filename
-------- ------ ---------------------------------
DB-A     1      C:\Program Files\...\DB-A.mdf
DB-A_log 2      C:\Program Files\...\DB-A_log.ldf 
```

现在我运行备份：

```
BACKUP DATABASE [DB-A] TO DISK = 'C:\dev\DB-A.bak' WITH INIT; 
```

当然，如果克隆目标（在这种情况下`DB-B`）已经存在，你会想要删除它：

```
USE [master];
GO
IF DB_ID('DB-B') IS NOT NULL
BEGIN
  ALTER DATABASE [DB-B] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
  DROP DATABASE [DB-B];
END
GO 
```

现在此还原将成功运行：

```
RESTORE DATABASE [DB-B] FROM DISK = 'C:\dev\DB-A.bak'
  WITH MOVE 'DB-A'     TO 'C:\Program Files\...\DB-B.mdf',
       MOVE 'DB-A_log' TO 'C:\Program Files\...\DB-B_log.ldf'; 
```

如果您收到有关 BAK 文件内容的错误，那么我建议您验证您确实正在生成一个新文件并且您在 RESTORE 命令中指向正确的文件。请尝试上述方法并让我知道它是否有效，并尝试找出您正在以不同方式执行的过程的任何部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-30T06:11:03.370

我意识到这是一个老问题，但我遇到了同样的问题，我发现 UI 比创建脚本更容易和更快。

我相信 Dan 的问题是他先创建了新数据库，然后尝试将另一个数据库恢复到其中。我也试过这个，得到了同样的错误。诀窍是不要先创建数据库并在“恢复数据库”过程中命名数据库。

以下文章在指导您完成该过程方面有些有用：http: [//msdn.microsoft.com/en-us/library/ms186390 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms186390(v=sql.105).aspx)

# ruby-on-rails - activeadmin 管理员帐户无法访问

> ID：10319863
> 
> 赞同：4
> 
> 时间：2012-04-25T16:29:11.010
> 
> 标签：ruby-on-rails, activeadmin

我试过`rake db:reset`了，现在我无法访问它 admin@example.com|password 它在我登录时返回一个无效的用户/密码。我检查了我的数据库它在那里为什么会这样？

```
id          email              encrypted_password                                            reset_password_token  reset_password_sent_at  remember_created_at         sign_in_count  current_sign_in_at          last_sign_in_at             current_sign_in_ip  last_sign_in_ip  created_at                  updated_at                
----------  -----------------  ------------------------------------------------------------  --------------------  ----------------------  --------------------------  -------------  --------------------------  --------------------------  ------------------  ---------------  --------------------------  --------------------------
1           admin@example.com  $2a$10$cCUYBOKQHAZhpYgdLIZIWuQArkrsjpgIMu9/kk17127Oj.DKYwVxa                                                2012-04-19 15:23:02.857402  36             2012-04-25 02:37:36.689711  2012-04-25 02:31:55.088037  127.0.0.1           127.0.0.1        2012-03-09 16:23:58.779104  2012-04-25 02:37:36.692613
sqlite> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-26T10:11:57.287

做

```
$ rails console
>> AdminUser.create :email => 'admin@example.com', :password => 'password', :password_confirmation => 'password' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-23T03:00:45.440

我有同样的问题，我通过执行以下操作解决了它：

```
rake db:drop:all
rake db:create:all
rake db:migrate 
```

我能够重新登录！

假设您不介意对所有内容进行完全重置！

# ios - 如何使用 Core Data 构建我的模型对象

> ID：10319865
> 
> 赞同：1
> 
> 时间：2012-04-25T16:29:14.743
> 
> 标签：ios, object

我第一次在我的 iOS 应用程序中使用 Core Data。我正在测试它是如何工作的，但我有一些这样的问题：我有 3 个实体（页面、用户、注释），我的应用程序是一本书，用户可以查阅页面并做笔记，用户可以在几页。我如何在核心数据中组织我的对象模型以及我的对象之间的关系。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:33:05.267

对于初学者，您可以添加一个与 Page 和 Note 具有多对多关系的 Book 实体。您还可以向 Book 添加方法，`-pageForPageNumber:`以便`-notesForPage:`轻松访问您可能需要的内容。如果您的应用程序代表一本书，那么您可以使用一些适当的类，例如您的应用程序委托或根视图控制器，以获取商店中 Book 的一个实例。如果您的应用更像是一个包含多本书的阅读器，那么您可能会先获取所有书籍并将它们显示在一个列表中，以便用户可以选择一本书。

# html - 如何将绝对 div 包裹在 3 个浮动 div 周围

> ID：10319874
> 
> 赞同：0
> 
> 时间：2012-04-25T16:30:07.237
> 
> 标签：html, css, css-float, absolute

基本上我有一个容器设置为绝对定位，我不能为它设置宽度或高度......所以它需要自动环绕内容。

但是，在绝对 div 内部，有 3 个 div 设置为“float:left”，这样它们就会彼此相邻堆叠。

一旦我将父级设置为绝对定位，内部的 3 个 div 就会向下跳，而父级 div 不会环绕它们。

有可能吗？这样我就可以包装一个绝对 div，大约 3 个浮动的（彼此相邻）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:30:50.797

应用溢出：隐藏到父 div

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:40:50.423

确保您在浮动之后使用清晰的元素（使用您的 abs 位置 div）

[这是它的小提琴](http://jsfiddle.net/TNCodeMonkey/Rujdf/)

CSS：

```
.left{
float:left
}
.clearL{
height:1px;
margin-bottom:-1px;
clear:left;
}
#wrapper
{
 padding:5px;
background-color:#e37c00; 
} 
```

​ HTML：

```
<div id="wrapper">
    <div id="divOne" class="left">
       <p>Some content goes here...</p>
    </div>
    <div id="divTwo"  class="left">
       <p>Some content goes here...</p>
    </div>
    <div id="divThree"  class="left">
       <p>Some content goes here...</p>
    </div>
    <div class="clearL">
    </div>
<div/> 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:44:05.320

这可以解决问题：

```
div.wrapper { /* outer-most div */
    ...       /* other styles */
    overflow:auto;
} 
```

我经常使用它，在所有现代浏览器中都很好用。

干杯

# ant - 在巡航控制中将选项传递给蚂蚁

> ID：10319883
> 
> 赞同：0
> 
> 时间：2012-04-25T16:30:23.193
> 
> 标签：ant, cruisecontrol

我在 `config.xml`文件中有以下代码：

```
<schedule interval = "300">
    <ant     anthome="/usr/share/ant"
         antworkingdir="${GitDir}"
         uselogger="true"
         usedebug="true"/>
</schedule> 
```

当我通过它执行构建时，我只是得到输出，就像我一直`ant`在命令行中输入一样。我需要能够从 Cruisecontrol 执行以下命令：

```
ant debug 
```

如果这有什么不同，我需要能够构建 android 应用程序。如何做到这一点？提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:23:47.210

您已经在 config.xml 中使用了正确的属性来启动带有日志级别调试的 ant 脚本

```
...
usedebug="true"
... 
```

相当于`ant -debug ...`
查看[http://cruisecontrol.sourceforge.net/main/configxml.html#ant](http://cruisecontrol.sourceforge.net/main/configxml.html#ant)了解详情。

# ssas - SSAS -> 一个人的年龄 -> 属性或度量或两者兼而有之？

> ID：10319886
> 
> 赞同：2
> 
> 时间：2012-04-25T16:30:29.997
> 
> 标签：ssas, cube, dimension

目前，正在与同事讨论年龄是属性还是维度，还是两者兼而有之？

我们无法就此达成一致，因为年龄可以用作类别属性，而年龄也可以用作平均衡量标准。

我相信其他人已经遇到过这种情况，不仅是年龄，还有其他处于属性和度量边界的字段。

这个怎么处理最好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T17:36:44.317

Age 或 AgeGroup 通常是它自己的维度。因此，您将有一个年龄维度，其年龄从 1 到 150 岁，并且将具有 AgeGroup 的属性（例如 20-25）。

在决定维度属性或度量时，您需要满足您的要求。有时，您最终会在事实表中同时拥有维度属性和度量。

阅读 Kimball 的这个设计技巧，它通过示例解释了这种情况：

[将数据建模为维度和事实](http://www.kimballgroup.com/html/07dt/KU97ModelingDataBothFactDimen.pdf)

# php - 是否在本地使用 eclipse/develop-debug 连接到网站？

> ID：10319898
> 
> 赞同：-1
> 
> 时间：2012-04-25T16:31:01.057
> 
> 标签：php, eclipse, ide

所以我下载了 Eclipse，因为一致认为dreamweaver 是蹩脚的。在 Dreamweaver 中，我习惯于进行更改并按 ⌘+shift+u 将我的文件上传到我的站点并查看我所做的更改。

在eclipse中，我可以连接到我的网站以便模仿这种行为吗？有一个更好的方法吗？我是否应该在本地使用 mamp 或其他东西进行调试，然后在完成后使用 fetch （再次或其他东西）传输文件？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:53:38.720

安装可用的 FTP 插件之一：

*   [http://www.wemakeapplejuice.be/2008/05/ftp-support-in-eclipse/](http://www.wemakeapplejuice.be/2008/05/ftp-support-in-eclipse/)
*   [http://wiki.eclipse.org/TM_and_RSE_FAQ#What_is_the_Target_Management_Project.3F](http://wiki.eclipse.org/TM_and_RSE_FAQ#What_is_the_Target_Management_Project.3F)
*   [http://sourceforge.net/projects/classftp/](http://sourceforge.net/projects/classftp/)
*   [http://www.eclipse.org/eclipse/platform-team/target.php](http://www.eclipse.org/eclipse/platform-team/target.php)

# apache-flex - 团队和层编程 java+spring+hibernate+flex+jstl

> ID：10319906
> 
> 赞同：0
> 
> 时间：2012-04-25T16:31:23.133
> 
> 标签：apache-flex, spring

使用最后提到的技术，我们已经在一个增量项目上工作了 4 或 5 年。

该项目一直在增长，现在我觉得我们的方法不够有效。到目前为止，每个参与该项目的程序员都必须学习整个层结构和围绕它们的技术，并且每个新功能都分配给一个人。

所以我们推迟了交付时间，很难培训一个人并让他们富有成效，而且团队中的人感到不知所措，我认为这不是金钱和资源的问题，辩论正在进行中，我真的觉得我们应该结对、分层工作，在某些领域变得专业化，并在团队中工作。有什么争论说我们不能分层工作，因为一个人可能无法完成他的部分，因为他无法测试它，直到另一个成员完成他的层。现在我们只有 3 个程序员。

因此，如果您认为这些建议是有道理的，我需要的是一些简单有效的参考资料，说明我们如何作为一个团队将其转变为更积极的动力，如何使用这些技术在各个层面上工作，我需要有实用的解决方案和论据这样我们就可以把船转向正确的方向。任何人都可以引导我们走向正确的方向吗？将不胜感激。先感谢您！

技术：

后端：Java + Spring + Hibernate + Mysql 前端 HTML：Jstl + html 前端 Flex：Flex SDK 3.5 + Blaze DS、cairngorm、第三方库和源代码。开发操作系统：Mac 或 windows 开发工具：用于管理的 Trac、svn 存储库 生产环境：Linux Debian 或 Centos、tomcat 5.5 工具：Intellij 和 Flash Builder

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T19:22:32.503

这是一个非常开放的问题，我认为没有真正的“正确”答案。有助于在不同层上独立工作的一件事是首先设计层之间的合约/接口。然后，您可以独立地在两层上工作，一方面致力于履行合同/接口，另一方面致力于构建合同提供的数据/功能。您可以从一方面的合同/接口的某种模拟实现开始，另一方面可以模拟数据/功能的消费者。这可以在您的 Java/Spring/Hibernate/MySQL 后端以及后端和前端中工作。您仍然会有时间需要实际集成您的层并测试该集成，

# api - 从 Google 地图获取所有者上传或用户上传的照片

> ID：10319909
> 
> 赞同：2
> 
> 时间：2012-04-25T16:31:33.063
> 
> 标签：api, google-maps, google-maps-api-3, panoramio

我想使用某些 Google API 获取用户上传或所有者上传的位置照片。

例如： 在这个地方： http: [//g.co/maps/pxbse](http://g.co/maps/pxbse)，您可以在地图上该地方的弹出窗口中看到该地方的所有者上传的照片。此外，如果您点击这张照片，您将被带到一个关于这个地方的更详细的页面，您可以在其中看到由所有者或其他谷歌用户上传的照片列表。

有没有办法使用 Google Maps API 来获取这些照片？

（请注意：我已经检查了 Panoramio 和 Google Street View API，但这些并不适合我的需要）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T21:01:10.487

在这一点上没有办法得到那张照片。Google Places API 不支持检索照片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T17:25:09.893

您正在查看的是 Google Place。您可以使用[Google Places API](https://developers.google.com/maps/documentation/places/)访问这些数据。

**更新**：你是对的。该 API 提到了一个包含在[地点详细信息响应](https://developers.google.com/maps/documentation/places/#PlaceDetailsResponses)中的图标 URL ，但似乎并未指示所有所有者上传的图像。

我建议您参加2012 年 5 月 1 日太平洋时间 13:00的[Google Maps API 办公时间。](https://plus.google.com/u/0/104063627743574070634/posts/EiZUgx8PgR1)有一个[谷歌版主设置](http://www.google.com/moderator/#15/e=1f9e7b&t=1f9e7b.46&f=1f9e7b.652fef)为事先发布问题。您可以使用 Google Plus 参加视频群聊（请务必关注 +Google Maps API），或者他们将视频直播到 YouTube。

# asp.net - 如何在按钮单击时动态触发文本框 onBlur 事件

> ID：10319911
> 
> 赞同：0
> 
> 时间：2012-04-25T16:31:41.823
> 
> 标签：asp.net, gridview

当我单击时，我`gridview`有一个`Copy`按钮，我想制作为事件`javascript`编写的`Textbox` `blur`事件..

我的示例脚本

```
<script type="text/javascript">
        function f(txt) {
            alert("hi");
        }
    </script> 
```

在循环网格视图时，我将在需要的地方调用，如下所示

`curTexbox.Attributes.Add("onBlur", "return f('" + curTexbox.ClientID + "'");`

当我从文本框失去焦点时，这将起作用，但是是否有可能使文本框失去对按钮单击的焦点并触发我需要的事件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T16:34:51.633

尝试这个

```
curTexbox.Attributes.Add("onBlur", "document.getElementById('buttonId').click();"); 
```

# opencv - Mac 上的 CodeBlocks 和 OpenCV（雪豹）

> ID：10319917
> 
> 赞同：0
> 
> 时间：2012-04-25T16:32:16.450
> 
> 标签：opencv, linker, settings, codeblocks, directory

我和我的朋友正在尝试使用 OpenCV 2.3.1 在 Mac 上设置 CodeBlocks 项目。我们已经为 GNU GCC 编译器编译了二进制文件（dylib 和 .a 文件）。

我们有以下设置：

搜索目录：

*   编译器：OpenCV/Include（这是 opencv 和 opencv2 包含 .h 文件的地方）
*   链接器：OpenCV/Lib（这是 dylib 和 .a 文件所在的位置）

链接器设置：

*   链接库：libopencv_calib3d_pch_dephelp.a, ...（所有 .a 文件）

我们不断收到错误：未找到符号，在“cv::VideoCapture::isOpened() const”和更多地方。

有谁知道这是否正确，或者有参考显示如何设置的指南？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T20:49:21.917

你看过[官方教程](http://opencv.willowgarage.com/wiki/CodeBlocks)吗？

本教程描述了如何在 Windows 上配置它，但在 Mac OS X 下你必须做几乎相同的事情。路径肯定会不同，但整体过程保持不变。此外，`.lib`您将使用文件而不是`.dylib`文件。

# python - GNU R 的 Python 替代品

> ID：10319920
> 
> 赞同：2
> 
> 时间：2012-04-25T16:32:21.680
> 
> 标签：python, r, open-source

我记得读过有关使用 Python 替代 GNU R（统计研究系统）的文章。我用谷歌搜索了一下，但似乎找不到。你能为我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-25T16:33:53.987

我猜你正在寻找 RPy2 项目：[https ://rpy2.github.io/](https://rpy2.github.io/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T14:18:22.627

我认为你的意思是 ipython 和 pylab。这是一个真正的替代方案，但不完全适用于 R，而是适用于 Matlab。

# c# - 加载项目的程序集

> ID：10319922
> 
> 赞同：1
> 
> 时间：2012-04-25T16:32:29.123
> 
> 标签：c#, reflection, methodinfo

嗨，我不知道这是否可能，但我有 ac# Project 可以说`A`，我正在尝试一个`ccess Assembly Info of another project B`，以便我可以`Method Info`使用. 问题是我想不出一种方法来整合这两者。项目 A 提供一个并选择文件。读取它并提取项目 B 中正在使用的文件。`project B``Reflection``openFileDialogue``.csproj`

你能建议我锻炼一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:44:32.323

我不认为你可以通过使用反射来做到这一点。要使用反射，您需要一个程序集，而不是 csproj（或 cs 文件）。您应该寻找一个解析器，也许使用 Roslyn API，它将以语法树格式为您提供有关源代码的信息。 [http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx](http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:38:32.577

每个 .csproj 文件都是 XML，因此您可以很容易地阅读它。该文件中列出了项目中包含的每个文件，因此您可以解析 XML .cs​​proj 文件以查找所有 .cs 文件。

从那里，如果您需要提取 MethodInfo，您将不得不解析 .cs 文件，或者使用[Roslyn](http://blogs.msdn.com/b/visualstudio/archive/2011/10/19/introducing-the-microsoft-roslyn-ctp.aspx)之类的东西将代码解析到其语法树中，然后以这种方式找到方法。

* * *

您可以只使用“项目 B”中构建的程序集（.exe 或 .dll）而不是其 .csproj 文件吗？加载程序集的反射信息会容易得多，只需遍历每个类和每个方法......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:37:43.327

用于`Assembly.LoadFile`直接加载已编译的程序集——即 DLL 或 EXE；这将为您提供一个`Assembly`对象，您可以在其上调用`GetTypes()`等以访问您想要的所有信息。

# c# - 远程服务器返回错误：(500) 内部服务器错误。

> ID：10319924
> 
> 赞同：1
> 
> 时间：2012-04-25T16:32:35.627
> 
> 标签：c#, httpwebrequest, httpwebresponse

我收到此错误：

（远程服务器返回错误：(500) Internal Server Error. at System.Net.HttpWebRequest.GetResponse()）

突然出现在我使用 c# 制作的一个 Windows 应用程序中。我已经使用这个应用程序多年了，直到昨天才出现任何问题。它突然开始抛出这个错误。

以下是我的方法和我正在调用的网址：

```
 public string CallOnlineUrl() {    
        try {
          Uri onlineupdateUrl = new Uri("https://billett.tusenfryd.no/admin/update.aspx");
          HttpWebRequest req = (HttpWebRequest)WebRequest.Create(onlineupdateUrl);
               System.Net.WebResponse resp = req.GetResponse();
               System.IO.Stream stream = resp.GetResponseStream();
          //****some code
          //-------
         } catch(Exception ex) {
            ERPLog.AddLogEntry(ex.Message + ex.StackTrace);       
        }
      return cont;
    } 
```

任何解决此问题的帮助或建议表示赞赏:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:31:00.523

我在这里找到了问题。Fiddler 在检测问题方面有很大帮助......实际上在服务器上，他们对在智能手机（Iphone/Andriod）上运行应用程序进行了一些更改......因为这对 global.asax 进行了一些更改应用程序开始事件...这里他们正在检查一些 Request.UserAgent..这导致运行时错误，因此返回的响应是内部服务器。无论如何，一旦遇到问题，一切都很好。

# android - PDF发送意图上的Android SecurityException

> ID：10319928
> 
> 赞同：4
> 
> 时间：2012-04-25T16:32:53.903
> 
> 标签：android, android-intent, permission-denied, securityexception

我在`ACTION_SEND`使用数据类型的意图期间遇到以下异常`application/pdf`：

```
java.lang.SecurityException: Permission Denial: starting Intent { act=android.intent.action.SEND typ=application/pdf flg=0x3080000 cmp=com.adobe.reader/.ARSendForSignature (has extras) } 
```

这会弹出一个对话框来选择所需的应用程序来接收 PDF。我相信`SecurityException`当用户从列表中选择 Adob​​e Reader 时，它会被抛出，尽管它似乎是专门打开`ARSendForSignature`活动的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-25T16:45:20.830

根据您的观点，您会遇到 Adob​​e Reader 应用程序中的错误或 Android 中的错误。

Adobe Reader`ARSendForSignature`活动支持`ACTION_SEND` `<intent-filter>`，但他们明确拥有`android:exported="false"`，这会拒绝除他们之外的任何人启动该活动的能力。

任何一个：

1.  Adobe Reader 不应该有那个`<intent-filter>`，或者
2.  Adobe Reader 不应将其标记为未导出，或
3.  Android 选择器应过滤掉未导出的活动

从长远来看，答案应该是#3——我将努力重现这个问题并提出一个问题，假设还没有问题。短期内，Adobe 可以比我们修复几亿台设备更快地解决这个问题。:-)

# c++ - 字符串反转中的神秘分段错误

> ID：10319929
> 
> 赞同：1
> 
> 时间：2012-04-25T16:32:55.533
> 
> 标签：c++, segmentation-fault

我正在编写一段代码，旨在使用递归来反转字符串。我相信我的方法是正确的，但我不断收到分段错误，我不确定它来自哪里。我所有的研究都表明这意味着我正在做“一些奇怪的记忆”。我在这方面足够新，这些类型的错误仍然令人困惑，所以这里的任何帮助将不胜感激。这是我的代码：

```
#include <iostream>
#include <string>
using namespace std;
class Palindrome
{
    int front;
    int back;
public:
    Palindrome();
    string reverse(string word)
    {
        int len = word.length()-1;
        if (back == 0) {
            back = len;
        }
        if (front >= back)
            return word;
        else{
            char first = word[front];
            char last = word[back];
            word[front] = last;
            word[back] = first;
            front += 1;
            back -= 1;
            reverse(word);
        }
    }
};

Palindrome::Palindrome(){
front = 0;
back = 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:04:56.827

我认为 Jacob Abrahams 试图说的`front`是迭代，但永远不会重新设置为零，所以第二次调用它时，它会根据第二个单词是更长还是更短而产生段错误或产生不正确的结果。

此外，Mark B 已经暗示的是，您可以`algorithm`将整个`Palindrome::reverse`函数包含并替换为

```
std::reverse(word.begin(), word.end()); 
```

最重要的是，如果您学会了如何使用调试器，或者将来至少为这类问题提供特定的错误消息，这将有所帮助。

编辑：忘记添加递归（例如调用自身的函数）通常是一个坏主意，因为执行堆栈非常小，在这种情况下，即使在解决了上述问题之后，对于特别长的字符串，您也会得到堆栈溢出. 它实际上使这个特定的代码不太清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T17:20:35.103

即使只有一个电话，我也尝试了您的代码并且也遇到了“访问冲突”。除了其他答案和评论中描述的初始化问题之外，导致您的段错误的是在递归调用“reverse”之前缺少“return”。你需要写`return reverse(word);`

在 Visual Studio 中，您的原始代码给出：警告 C4715: 'Palindrome::reverse' : 并非所有控制路径都返回一个值。

有关更多详细信息，请参阅[此问题](https://stackoverflow.com/questions/1735038/why-not-all-control-paths-return-a-value-is-warning-and-not-an-error)。

这是一个带有两个修复的 reverse() 版本：

```
 string reverse(string word)
    {
        int len = word.length()-1;
        if (back == 0) 
        {
            back = len;
        }
        if (front >= back)
        {
            front = 0;
            back = 0;
            return word;
        }
        else
        {
            char first = word.at(front);
            char last = word.at(back);
            word.at(front) = last;
            word.at(back) = first;
            front += 1;
            back -= 1;
            return reverse(word);
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T17:40:47.253

就个人而言，我认为混合递归和对象有点奇怪。对象的基本概念之一是对象保持您想要跟踪的状态。递归的基本概念之一是执行堆栈保存您想要跟踪的状态。

在这种情况下，您要跟踪的状态是已处理了多少字符串/还有多少字符串需要处理。您可以在没有对象的情况下跟踪它。

这闻起来很像家庭作业问题。但是我想不出一个提示给你而不只是给你答案。我能做的最好的就是让我的答案（1）反转任何容器，包括但不限于字符串；(2) 使用类似 STL 的接口（即迭代器）；(3) 将字符串反转到位，而不是反转字符串的副本：

```
#include <algorithm> // std::swap

// the other headers are only for my example on how to use the code
#include <iostream>
#include <iterator>
#include <string>
#include <list>

template<typename Itor> void reverse_with_recursion(Itor begin, Itor end)
{
    using std::swap; // same trick used by the STL to get user-defined swap's,
                     // but fall back to std::swap if nothing else exists:
                     // http://en.wikipedia.org/wiki/Argument-dependent_name_lookup#Interfaces

    // if begin and end are pointing at the same element,
    // then we have an empty string and we're done
    if (begin == end) {
        return;
    }

    // the STL follows the pattern that end is one element after
    // the last element;  right now we want the last element
    --end;

    // if begin and end are pointing at the same element *now*,
    // then we have a single character string and we're done
    if (begin == end) {
        return;
    }

    swap(*begin, *end);
    return reverse_with_recursion(++begin, end);
}

int main()
{
    std::string foo("hello world");
    reverse_with_recursion(foo.begin(), foo.end());

    std::cout << foo << '\n';

    std::list<int> bar;
    for (int i = 0; i < 10; ++i) {
       bar.push_back(i);
    }

    reverse_with_recursion(bar.begin(), bar.end());

    std::copy(bar.begin(),
              bar.end(),
              std::ostream_iterator<int>(std::cout, " "));
    std::cout << '\n'; 
```

# eclipse - Eclipse 多上下文插件

> ID：10319930
> 
> 赞同：1
> 
> 时间：2012-04-25T16:33:01.430
> 
> 标签：eclipse, eclipse-rcp, eclipse-plugin

我对 Eclipse 插件中的多个上下文有疑问，我可以在插件中有一个处理程序定义，并在标签中有多个上下文吗？像这儿：

```
<enabledWhen>
         <with variable="activeContexts">
            <and>
                  <iterate operator="or">
                          <equals
                              value="context1"/>
                  </iterate>
                  <iterate operator="or">
                        <equals
                            value="context2"/>
                    </iterate>
            </and>
         </with>         
</enabledWhen> 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T06:54:09.097

你可以。据我所知，你的表达应该照常工作。

# sql - Oracle 中的时间戳转换为 YYYY-MM-DD HH:MM:SS 格式

> ID：10319935
> 
> 赞同：15
> 
> 时间：2012-04-25T16:33:11.560
> 
> 标签：sql, oracle, oracle11g, sql-timestamp

我正在尝试将带有`YYYY-MM-DD HH:MM:SS`格式的记录从 Netezza 插入 Oracle，但我得到的日期类型无效。

我怎样才能完成这个？

```
CREATE TABLE AM_PROGRAM_TUNING_EVENT_TMP1
(
    ST TIMESTAMP,
    ET TIMESTAMP,
    MAS_DIV_KEY INTEGER NOT NULL,
    SBSC_GUID_KEY INTEGER NOT NULL,
    STN_KEY INTEGER NOT NULL
 );

INSERT INTO  AM_PROGRAM_TUNING_EVENT_TMP1 VALUES('2012-03-28 11:10:00','2012-03-28 11:30:00',1,3636815,151); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-25T16:37:36.140

使用[TO_TIMESTAMP](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions193.htm)函数

```
TO_TIMESTAMP(date_string,'YYYY-MM-DD HH24:MI:SS') 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-25T16:42:30.083

```
INSERT INTO AM_PROGRAM_TUNING_EVENT_TMP1 
VALUES(TO_DATE('2012-03-28 11:10:00','yyyy/mm/dd hh24:mi:ss')); 
```

[http://www.sqlfiddle.com/#!4/22115/1](http://www.sqlfiddle.com/#!4/22115/1)

# xcode - Xcode 快捷方式打开文档项列表

> ID：10319937
> 
> 赞同：2
> 
> 时间：2012-04-25T16:33:16.423
> 
> 标签：xcode, keyboard-shortcuts

是否有一个键盘快捷键可以打开这个很棒的列表（我不知道它的名字）？

![语用标记列表](../Images/9a334321b42f269087665c3dbaa2beb3.png)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-25T16:39:26.193

尝试`⌃</kbd> `6``

还有其他控件 + 数字以查看该披露列表中的其他下拉菜单。

您可以在 Xcode 首选项的 Key Bindings 部分中查看它们和其他内容：

![在此处输入图像描述](../Images/56f62bae1b0264f19b7d108a265c5035.png)

# symfony - 安全删除对象

> ID：10319939
> 
> 赞同：0
> 
> 时间：2012-04-25T16:33:18.020
> 
> 标签：symfony, entity

我有一个表，我可以在其中编辑和删除实体类的所有对象，这些对象持久化到数据库中。

当我现在转到删除网址时：保护删除的最佳做法是什么，以便用户必须确认删除？

一个简单的按钮还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-25T17:29:48.040

不！不要这样做！不要提供直接删除任何内容的 URL！

GET 请求应该是幂等的，不这样做实际上是[违反了 HTTP 规范](http://www.w3.org/2001/tag/doc/whenToUseGet.html)。

应用程序中的破坏性操作应作为 POST 请求执行。

JavaScript 驱动的确认对话框是一个不错的 UI 功能，但它*不能解决*问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:41:37.043

您可以使用 javascript 捕获按钮的 onclick 事件并显示允许用户确认删除的弹出窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T17:15:50.760

按钮上的警报是不够的。如果直接在浏览器中输入 URL，记录将被删除。您需要确保使用 POST 动词发出请求。

# html - 找不到带有 ID、名称或标签“”的文本字段、文本区域或密码字段 (Capybara::ElementNotFound)

> ID：10319941
> 
> 赞同：0
> 
> 时间：2012-04-25T16:33:23.190
> 
> 标签：html, ruby-on-rails, cucumber

我正在使用 cucumber 来测试我的 rails 应用程序。

要填写表格，我在黄瓜中使用“填写”步骤：

```
When /^(?:|I )fill in "([^"]*)" with "([^"]*)"(?: within "([^"]*)")?$/ do |field, value, selector|
  with_scope(selector) do
    fill_in(field, :with => value)
  end
end 
```

我有一个页面，我想用“example@example.com”填写“电子邮件地址”：

当我用“example@example.com”填写“电子邮件地址”时

但其中一页出现以下错误：

**找不到带有 ID、名称或标签“电子邮件地址”的文本字段、文本区域或密码字段 (Capybara::ElementNotFound)**

有什么想法是 html 代码中缺少的吗？还是问题出在不匹配的版本上？

这是我收到错误的该页面的 html 代码的一部分：

```
<p class=" medium text email_wrapper required">
 <label for="user_email">Email Address<span class="required">*</span></label> <br />
 <input class=" medium text" id="user_email" name="user[email]" size="30" type="text" /><br />
 <span class=" note">Must be valid. Privacy is guaranteed.</span>
</p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T19:19:19.740

您确定您的正则表达式有效吗？好像行不通。[http://rubular.com/r/RUIKYIk5Wb](http://rubular.com/r/RUIKYIk5Wb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T13:58:02.030

标签中的这个 html 可能会混淆匹配器：

```
<span class="required">*</span> 
```

您可以指定字段的 id：

```
When I fill in "user_email" with "example@example.com" 
```

# asp.net-mvc-3 - umbracoNaviHide 在 Where 语句中不起作用

> ID：10319943
> 
> 赞同：0
> 
> 时间：2012-04-25T16:33:33.473
> 
> 标签：asp.net-mvc-3, razor, umbraco, umbraco5

尝试获取给定文档类型的孩子，但 umbracoNavihide 未设置为 false：

以下产生正确的输出。

```
@foreach (var child in root.Children.Where("ContentTypeAlias == \"DocumentTypehere\""))
{
    if (child.umbracoNaviHide == "False")
    {
        continue;
    }
    <li>@child.Name</li>
} 
```

这不会：

```
@foreach (var child in root.Children.Where("umbracoNaviHide == @0 && ContentTypeAlias == \"DocumentTypehere\"","False"))
{
        <li>@child.Name</li>   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T15:18:46.723

`umbracoNaviHide`[根据 Niels Hartvig 的话，](http://our.umbraco.org/forum/core/umbraco-5-general-discussion/25819-Umbraco-5-Does-umbracoUrlName,-umbracoUrlAlias,-umbracoRedirect,-umbracoNaviHide,-umbracoInternalRedirectId-still-work) Umbraco 5 不支持：

> 虽然这些特殊别名确实*[sic] [recte: do] 做得*很好并且超级容易使用（尽管如果你不偶然发现提到它们用法的文档，完全不可能发现），但问题在于它们'重新“魔术”字符串，这确实是一团糟（阅读：它们是核心内部的黑客）。
> 
> 所以他们不会以我们从 v4 中知道的形式在 v5 中返回。

所以，除了 Linq 的模仿无论如何都被打破了，简短的回答是这个（任何一种形式）都不应该工作（Athul 的回答也不应该）。

长答案是，只有当您明确支持它作为文档类型的一部分时，您才能使用此属性（以及其他类似的属性）。[但是，有一个功能请求，如果您愿意关注并支持它，请在此处](http://issues.umbraco.org/issue/U5-254)请求“内置”`umbraco...`属性。

但是，我个人会要求您不要这样做。因为使用这些属性并依赖它们是有问题的（尤其是尼尔斯本人提到的一点）。制作您自己的专用属性，为其任务适当地别名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T04:59:03.783

你可以简单地这样做

```
@foreach (var child in root.Children.Where("umbracoNaviHide != true &&  NodeTypeAlias == \"DocumentTypehere\" ")
{
    <li>@child.Name</li>   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T14:03:12.097

只是添加另一种方法 - 一些现有的答案对我不起作用 - 你可以试试这个。在 Umbraco 4.11 中为我工作

```
@foreach (var child in root.Children.Where(child => child.GetPropertyValue("umbracoNaviHide") == "0"))
{
..
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T22:42:32.633

您可以在 umbracoNaviHide 上写下您的支票：

```
if (!child.umbracoNaviHide)
{
    continue;
}
<li>@child.Name</li> 
```

# c# - 切换 div 种类控制

> ID：10319944
> 
> 赞同：0
> 
> 时间：2012-04-25T16:33:33.943
> 
> 标签：c#, .net, winforms, controls

有没有人遇到过一个可以执行类似于`toggling divs`in的控件`win forms`。我正在使用 `visual studio 2010`和`C#`。我正在寻找类似的工具，但找不到。

如果有人有想法，请告诉我

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:40:15.577

我想你想要的是[FlowLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowlayoutpanel.aspx)吗？

[这是 FlowLayoutPanel 上的 MSDN](http://msdn.microsoft.com/en-us/library/f9e8s203.aspx)

而且，从文章中：

> 当您将 AutoSize 属性设置为 true 时，FlowLayoutPanel 控件会根据其内容自动调整大小。

因此，任何不可见的东西都会导致其他控件适当折叠

# android - 这个 RelativeLayout 布局或者它的 LinearLayout 父级是没用的

> ID：10319947
> 
> 赞同：11
> 
> 时间：2012-04-25T16:33:43.753
> 
> 标签：android, android-layout, layout

我正在开发 Android 3.1。及以上应用。

在一项活动中，我动态生成其布局。我使用**formdetail.xml**作为内容视图：

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.formdetail);

    Bundle extras = getIntent().getExtras();
    if (extras != null)
    {
        currentFormId = extras.getString("FormId");
    }
} 
```

formdetail.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/detailLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
        <Button
            android:id="@+id/downloadFormsButton"
            android:enabled="false"
            android:layout_alignParentLeft="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="10dp"
            android:text="@string/download_forms_button" />
        <TextView
            android:id="@+id/formErrorMsg"
            android:layout_alignParentRight="true"
            android:layout_alignParentBottom="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:padding="10dp"
            android:textSize="16dp" >
        </TextView>
    </RelativeLayout>

</LinearLayout> 
```

`downloadFormsButton`并且`formErrorMsg`必须始终保持形式。

但是使用那个xml我得到这个警告：

`This RelativeLayout layout or its LinearLayout parent is useless`

我需要 linearLayout 以编程方式添加 TableLayouts。

我该如何解决这个警告？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-25T18:20:54.967

Lint 的警告是正确的，您的 LinearLayout 没有做任何有用的事情，因为它唯一的孩子是 RelativeLayout。删除线性布局：

```
<?xml version="1.0" encoding="utf-8"?> 

<RelativeLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:id="@+id/detailLayout"
 android:layout_width="match_parent"
 android:layout_height="match_parent">

 <Button android:id="@+id/downloadFormsButton" 
         android:enabled="false"
         android:layout_alignParentLeft="true"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content" 
         android:layout_margin="10dp"
         android:text="@string/download_forms_button" />
 <TextView 
         android:id="@+id/formErrorMsg" 
         android:layout_alignParentRight="true"
         android:layout_alignParentBottom="true"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:padding="10dp"
         android:textSize="16dp" />
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-25T16:40:15.900

您要么忽略它，要么右键单击您的项目。单击`Build Path->Configure Build Path...`。在`Android Lint Preferences`查找`UselessParent`并设置它的严重性以忽略或单击`Ignore All`。

编辑：

我收回最后一部分。我认为`Ignore All`会清除所有 Lint 警告和错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-06T07:21:42.243

我的应用程序布局也有同样的问题。

我不知道如何以及它是否正确，但是在将背景属性设置为两种布局后，这个问题得到了解决。

现在没有警告并且工作完美。希望它也对你有用。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:background="@drawable/bg"
    android:layout_height="match_parent" >

        <FrameLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_marginBottom="10dp"
            android:layout_marginLeft="10dp"
            android:layout_marginRight="10dp"
            android:background="@drawable/bg2"
            android:layout_marginTop="10dp" >

            <ImageView
                android:id="@+id/img_BookImage"
                android:layout_width="200dp"
                android:layout_height="200dp"
                android:scaleType="fitXY"
                android:contentDescription="@string/India"
                android:src="@drawable/india" />
        </FrameLayout>

    </FrameLayout> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T16:39:05.590

这只是一个警告`lint`。`Lint`不知道您稍后会将视图附加到此布局，它会警告您添加了不必要的额外视图（增加了布局深度）。

您应该忽略警告（如果它真的让您感到困扰，这里有一个关于[如何从中删除警告](http://tools.android.com/tips/lint/suppressing-lint-warnings)的链接`lint`）。

# ios - 使用 Core Data 进行快速零结果过滤

> ID：10319956
> 
> 赞同：1
> 
> 时间：2012-04-25T16:34:16.260
> 
> 标签：ios, core-data, nspredicate, nsfetchrequest

## ![数据模型](../Images/cdb1715e696f8ffc6aef7817515c3bdd.png)

我正在构建一个界面以允许用户过滤一组照片。数据模型如上。我想禁用任何会导致 0 结果的控件。

为了实现这一点，我正在为每次用户进行自己的更改时关闭/未选择的每个控件运行新的获取请求。我将控件表示的数据添加到我的 NSCompoungPredicate 中，然后在获得结果后将其删除。如果结果的计数为 0，我禁用该控件。

我在主线程上做这一切，所以在某些情况下，应用程序有一点延迟。有没有更好的方法来以更少的开销进行这种类型的过滤？我应该在他们自己的线程上运行这些过滤器获取吗？我从来没有用 CoreData 和蠕虫做过这件事，我读过我需要一个单独的上下文，我不知道如何去设置代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:58:03.300

一些代码会有所帮助。除此之外，这里有一些建议。

首先，在您的获​​取请求上，使用 countForFetchRequest:error: 因为它只会查询数据库，并返回计数而不是对象信息。

其次，如果你不想使用线程，并且搜索仍然太慢，你可以在应用启动时进行初始查询。然后，这将启用/禁用各种控件。

您可以简单地捕获告知数据何时更改的上下文通知，并相应地更新该信息。然后，您根本不必进行任何查询。只需初始化并在从数据库中添加/删除对象时更新状态。

如果您想使用线程，那么这并不是那么困难。

听起来您想要的只是一个正在运行查询的线程。你设置了一个 MOC...

```
NSManagedObjectContext *checkerMoc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
checkerMoc.persistentStoreCoordinator = MyCurrentMoc.persistentStoreCoordinator; 
```

现在，每当您想检查数据库时...

```
[checkerMoc performBlock:^{
    NSFetchRequest *fetchRequest = ...
    // Do your fetch request... this block of code is running in the other thread
    [checkerMoc fetch...];
    // When the fetch request is done, do whatever you want in your UI...
    dispatch_async(dispatch_get_main_queue(), ^{
        // Now this code is running in the main thread... access your UI
        self.myControl.enabled = fetchResultCount > 0;
    });
}]; 
```

请注意，您使用的是相同的持久存储协调器，因此如果主线程尝试访问数据库，它将堆积在此请求后面。您也可以为 checkerMoc 使用单独的 persistentStoreCoordinator，这是一个问题。

# facebook - Facebook 喜欢 HTML5 画布

> ID：10319958
> 
> 赞同：1
> 
> 时间：2012-04-25T16:34:27.683
> 
> 标签：facebook, canvas

有谁知道用户生成的 HTML5 Canvas 是否可以附加到 Facebook 的“Like”操作并在 Facebook 墙上分享？

我猜画布必须被渲染到一个`<img>`标签和`og:image`元数据中指定的标签的id？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:43:29.707

在我看来，你有两个选择。

(1) 使用[Like 按钮](http://developers.facebook.com/docs/reference/plugins/like/)并在其中放置一个动态 url，该 url 为用户选择的配置生成 og 标签。在点赞按钮教程的第二步中，它会为您生成 og 标签，以便您查看需要什么，然后确保您的服务器根据用户配置生成这些标签。当用户完成他的配置时，您必须从您的页面向服务器发出请求，这样才有可能。

(2) 使用js sdk自带的[Feed Dialog](https://developers.facebook.com/docs/reference/dialogs/feed/)。使用它，您可以指定所有故事字段，例如：

```
var obj = {
    method: "feed",
    picture: "URL_FOR_THE_CONFIGURED_BIKES_PIC",
    name: "My custom bikes!",
    caption: "I just finished building a new pair of bikes",
    description: "My configuration: ....."
};

FB.ui(obj, function(response) {
    console.log(response);
}); 
```

当然可以将这两个选项混合到第三个选项中，如果每个配置都有一个特定的 url，那么你可以简单地：

```
FB.ui({
    method: "feed",
    link: "URL_FOR_THE_USER_CONFIGURATION"
}, function(response) {
    console.log(response);
}); 
```

然后 facebook 将从该链接中的 og 标签中提取数据。

# ios - 在 deleteRowsAtIndexPaths 之后的 contentOffset 更改通知的任何委托方法

> ID：10319969
> 
> 赞同：1
> 
> 时间：2012-04-25T16:35:25.090
> 
> 标签：ios, uitableview

使用 删除一些底部行后`deleteRowsAtIndexPaths:withRowAnimation:`，我的表格视图的长度会缩小，并且会自动向下滚动以补偿这些底部行的丢失，这意味着它的 contentOffset 已更改。

问题是`scrollViewDidScroll:`在这种情况下没有调用。是否有任何其他委托方法可以用来在此处获取有关 contentOffset 更改的通知？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:22:25.577

这听起来像是键值观察的用例。

尝试将此添加到您的控制器：

```
 [tableView addObserver:self 
                    forKeyPath:@"contentOffset"
                       options:NSKeyValueObservingOptionNew
                       context:nil]; 
```

然后，您可以在控制器中实现此方法。

```
-(void) observeValueForKeyPath: (NSString *)keyPath 
                      ofObject: (id) object
                        change: (NSDictionary *) change 
                       context: (void *) context {

    if ([keyPath isEqualToString:@"contentOffset"]) {

        //Do Something with content offset

    } 
```

}

但是，由于您正在观察 contentOffset 属性，因此每次滚动时都可能会触发此通知。我建议改为观察**contentSize**属性，它应该只在添加或删除行时触发此通知。

# ios - UIWebView 没有填充 UITableView 单元格

> ID：10319970
> 
> 赞同：0
> 
> 时间：2012-04-25T16:35:35.650
> 
> 标签：ios, uitableview, uiwebview, height

我在 uitableview 单元格中有一个 webview。问题是web视图只占了uitableview单元格的75%

我不确定 iOS 是如何决定 web 视图的高度的，因为我似乎无法增加它需要多少空间。我可以增加或降低表格视图单元格的高度，但网络视图不会增加。

我想我需要做的一件事是根据文本的大小以某种方式获取 Web 视图本身的高度，以便它可以自动缩放 tableview 单元格的大小。

a）我不确定是什么函数检索它

b）我认为这会进入`(void)webViewDidFinishLoad:(UIWebView *)webView`方法，但我无法让应用程序进入该功能。我试过调试器，它似乎根本不进去。（网络视图对象在它自己的控制器中）

```
#import "WebViewCell.h"

NSUInteger const WEB_VIEW_ROW_HEIGHT = 75;

@implementation WebViewCell

@synthesize webView;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
 self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
if (self) {
    // Initialization code
}
return self;
}

  - (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
  [super setSelected:selected animated:animated];

// Configure the view for the selected state
}

 @end 
```

并在实际使用 Web 视图填充 tableview 单元格的控制器中：

```
 WebViewCell *cell = [[ViewManager instance] loadWebViewCell:self.tableView cellID:eventDetailsValueCellID];

        NSString *htmlText = [news valueForKey:propertyName];

        [cell.webView loadHTMLString:htmlText baseURL:nil];

        return cell; 
```

我不确定在哪里放置`(void)webViewDidFinishLoad:(UIWebView *)webView`这个设置的方法。它是否进入 WebViewCell.m 或调用 WebViewCell.m 的控制器

另外，根本问题是如何使 web 视图缩放到单元格的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T17:14:16.487

`(void)webViewDidFinishLoad:(UIWebView *)webView`需要由UIWebViewDelegate**实现**。

尝试添加`cell.webView.delegate = self`cellForRowAtIndexPath 方法，并将委托协议“UIWebViewDelegate”添加到控制器的头文件中。

这至少应该让您的`(void)webViewDidFinishLoad:(UIWebView *)webView`呼叫触发允许您在 Web 视图加载后进行高度计算。

计算可能看起来像：

```
webView.frame = CGRectMake(0, 0, webView.superview.frame.size.width, webView.superview.frame.size.height); 
```

# nopcommerce - 复合 C1 - nopCommerce 集成

> ID：10319973
> 
> 赞同：1
> 
> 时间：2012-04-25T16:35:39.317
> 
> 标签：nopcommerce, c1-cms

我正在按照分步说明 (http://docs.composite.net/Packages/Commerce/NopCommerce) 将 nopCommerce 模块集成到 Composite C1 CMS 中，但在转换文件时尝试执行步骤 2 时已停止。

```
"Run the Composite.Commerce.nopCommerce.Convertor.exe from the command prompt redirecting its output to Handlers.xml like this:
C:\nopFiles\Composite.Commerce.nopCommerce.Convertor.exe > Handlers.xml" 
```

当我尝试执行此操作时，我收到“访问被拒绝”消息并且该进程未运行。尝试将两者整合时，有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:53:49.897

TGuimond，请尝试[以管理员身份运行 CMD](http://www.howtogeek.com/howto/windows-vista/run-a-command-as-administrator-from-the-windows-vista-run-box/)，然后从 CMD 运行命令“C:\nopFiles\Composite.Commerce.nopCommerce.Convertor.exe > Handlers.xml”

# php - php mysql 选择框

> ID：10319977
> 
> 赞同：2
> 
> 时间：2012-04-25T16:35:41.470
> 
> 标签：php, mysql

我有一个选择框，我希望循环添加到数据库中。它看起来对我来说是正确的，但它不会进入数据库。

```
<select name="countylist" style="height:300px;" class="multiple" multiple="multiple" id="box2View">
      <option value="11">Beer Gardens</option><option value="10">Historic Bars</option>           
      <option value="8">Live Music</option><option value="1">Night Clubs</option>
      <option value="4">Pubs Serving Food</option><option value="6">Sports Bars</option>      
 </select> 
```

SQL：

```
foreach($_POST["countylist[]"] as $s) {  
  $insertSQL = sprintf("INSERT INTO cat_pubs (pub_id, cat_id) 
  VALUES(LAST_INSERT_ID(),". $s . ")");

  mysql_select_db($database_localhost, $localhost);
  $Result1 = mysql_query($insertSQL, $localhost) or die(mysql_error());
} 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T16:49:12.017

您需要调整选择的名称以包含数组标记`[]`，如下所示：

```
<select name="countylist[]"... 
```

然后在 PHP 中删除数组标记，如下所示：

```
foreach($_POST["countylist"] as... 
```

非常重要的是，在 PHP 中，您检查输入实际上是允许的值之一，而不是用户自己恶意输入的内容。对于选择，保存一个允许值的数组可能是最简单的，然后对此进行检查：

```
if(!in_array($s, $allowed_counties)) { /*false input, do not save in db*/} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-25T16:43:20.793

您需要将 select 标记的名称更改为，`countylist[]`以便 PHP 知道它代表一个数组：

```
<select name="countylist[]"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:40:05.910

你想用那个做`LAST_INSERT_ID()`什么？

*   您是否完成了您现在尝试引用的插入？

在这种情况下，将值存储在变量中，因为它将在您第一次（新）插入后被覆盖。

*   您是否试图让插入进行下一个自动增量？

然后不要在插入中命名列，或将 NULL 放入值中：

```
INSERT INTO cat_pubs (cat_id)   VALUES(". $s . ")"); 
```

PS：如果您只是通过从此类字符串构建 SQL 将 POST 中的数据直接插入数据库，您**将被 MySQL 注入攻击。**转义字符串，或使用准备好的语句...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-25T16:59:53.743

一些指针，您需要告诉 POST 该值是一个数组，`name="countylist[]"`否则您只能获得 php.ini 中最后选择的值。

此外，如果您进行多次插入，与迭代结果并在每次迭代中插入相比，为插入构建单个查询总是更快。

您还在每次迭代中选择错误的数据库：

```
<?php 
//connect
mysql_connect('localhost','user','pass');
//select your db
mysql_select_db('database');

//is posted
if($_SERVER['REQUEST_METHOD']=='POST'){
    //build query for a single insert
    $query = 'INSERT INTO cat_pubs (pub_id, cat_id) VALUES ';
    foreach($_POST["countylist"] as $s) {
        $query .='("","'.mysql_real_escape_string($s).'"),';
    }
    //trim the last ,
    $query = rtrim($query,',');
}

//do query
$result = mysql_query($query) or die(mysql_error());

?>

<form method="POST" action="">
  <!-- tell POST that countylist is an array --> 
  <select name="countylist[]" style="height:300px;" class="multiple" multiple="multiple" id="box2View">
      <option value="11">Beer Gardens</option>
      <option value="10">Historic Bars</option>           
      <option value="8">Live Music</option>
      <option value="1">Night Clubs</option>
      <option value="4">Pubs Serving Food</option>
      <option value="6">Sports Bars</option>      
 </select>

  <p><input type="submit" value="Submit"></p>
</form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-25T16:40:02.640

举个例子，没关系，我有一句话：

使用 mysql_real_escape() 喜欢

```
$insertSQL = sprintf("INSERT INTO cat_pubs (pub_id, cat_id) VALUES(LAST_INSERT_ID(),". mysql_real_escape_string($s) . ")"); 
```

# django - 在控制台启动时在 pydev (Eclipse) 中设置交互式控制台的当前目录

> ID：10319980
> 
> 赞同：2
> 
> 时间：2012-04-25T16:35:47.023
> 
> 标签：django, eclipse, path, pydev, chdir

我想从项目目录在 pydev 中启动一个交互式控制台，以便导入一个应用程序。我尝试在启动时从 Window->Preferences->PyDev->Interactive Console->Initial 解释器命令使用 os.chdir。我阅读[https://docs.djangoproject.com/en/dev/ref/settings/](https://docs.djangoproject.com/en/dev/ref/settings/)搜索设置路径的条目，但我没有找到任何东西。谢谢

编辑：我必须先导入模块才能导入应用程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:52:38.410

奇怪的是，我必须说，在将初始解释器命令更改为：

```
import sys; print('%s %s' % (sys.executable or sys.platform, sys.version))
import os;os.chdir('c:\\') 
```

后来做（在shell中）：

```
import os.path
os.path.abspath('.') 
```

是否显示了预期的路径......你不明白吗？启动后在 shell 中执行 abspath('.') 会得到什么？

# c# - 雷恩代尔 256 键

> ID：10319984
> 
> 赞同：0
> 
> 时间：2012-04-25T16:36:14.783
> 
> 标签：c#, rijndael

如何创建密钥和 iv，以便加密字符串应仅包含数字和字符。密钥字符串和 iv 字符串应包含 32 个字符。目的是加密字符串不应包含任何特殊字符。块大小为 256。现在我正在使用像这样的密钥和iv。使用它加密后，得到带有特殊字符的加密字符串。我们怎样才能避免这种情况。

AES_Key=PSVJQRk9QTEpNVU1DWUZCRVFGV1VVT0ZOV1RRU1NaWQ=

Aes_iv=YWlFLVEZZUFNaWlhPQ01ZT0lLWU5HTFJQVFNCRUJZVA=

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:44:49.437

您需要对输出进行 Base64 编码。这将确保它只是可打印的 ASCII，并且是存储/传输加密数据的标准。

您希望您的密钥和 IV 完全随机。仅仅因为您的键中没有特殊字符，并不意味着您不会在输出中获得特殊字符。绝对没有相关性。看起来在您的密钥中，IV 是 base64 编码的。确保您使用的是原始密钥和 IV。

以下是如何在 C# 中执行此操作。假设您的 AES 输出是一个字节数组：

```
 string encoded = System.Convert.ToBase64String(aesOutput); 
```

如果是字符串：

```
 byte[] encodedBytes = System.Text.Encoding.ASCII.GetBytes(aesOutput);
        string base64encoded = System.Convert.ToBase64String(encodedBytes); 
```

您可以使用 System.Convert.FromBase64String(encodedData) 转换回它的原始输出。

# javascript - JQuery：选择已填充，但显示的文本是旧的

> ID：10319987
> 
> 赞同：0
> 
> 时间：2012-04-25T16:36:20.067
> 
> 标签：javascript, jquery, html-select

我有一个下拉框（选择），用户在其中选择某个教授。之后，AJAX 请求从服务器获取 JSON 数据并使用该教授的主题填充另一个下拉框。第二个下拉框填充没有任何问题。但是第二个下拉框中的旧值（“请先选择教授！”）中的文本，现在甚至不再出现在下拉框中，在第二个下拉框填充后，仍然显示为默认选择。

这是js：

```
$('#professorCombo').combobox({
            selected: function() {
                validateAllFields();
                var idProfessor = $(this).val();

                var servletUrl = 'GetTeachersServlet?idProfessor=' + idProfessor;

                $.getJSON(servletUrl, function(data) {
                    var subject = $('#subjectCombo');

                    $('option', subject).remove();

                    if (data) {
                        subject.append($("<option/>").val(-1).text("Select subject..."));

                        $.each(data, function(key, value) {
                            subject.append($('<option/>').val(key).text(value));
                        });
                    } else {
                        subject.append($("</option/>").val(-1).text("There are no subjects available!"));
                    }
                });
            }
        }); 
```

在第二个下拉框填充后，默认选项应该是：“选择主题”。如果我打开下拉框，这是第一选择，但下拉框仍然显示旧文本（“请先选择教授！”）。我想我应该以某种方式刷新它。Firebug 还说下拉框的选定值是带有文本“选择主题”的值，这真的很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-25T17:40:11.590

尝试将主题组合值设置为 -1，如下所示：

```
subject.val(-1).attr('selected',true); 
```

似乎您从未将组合设置为填充的新值，并保留旧值。

# android - Android：如何仅在特定活动中显示菜单？

> ID：10319989
> 
> 赞同：0
> 
> 时间：2012-04-25T16:36:34.923
> 
> 标签：android, session, android-activity, login, menu

我的项目中有许多活动和一个登录活动，但我希望仅在活动登录之外的所有活动中显示菜单，因为在该菜单中将是结束会话的图标，当按下时，返回登录活动。而不是如何，你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:45:03.483

我建议登录的布局没有菜单，如果菜单有其他活动的布局

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T16:39:28.177

最好是包含您的菜单代码的基本活动，然后您可以将其扩展为您的活动而不是活动。

对于登录，您可以扩展活动。因此所有扩展 baseactivity 的活动都将反映在菜单中，而无需在每个活动中编写菜单代码。并且因为它不扩展基本活动，所以将没有菜单。

更新：：：

```
public class BaseActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
    }
     /* Creates the menu items */
    public boolean onCreateOptionsMenu(Menu menu) {
          MenuInflater inflater = getMenuInflater();
          inflater.inflate(R.menu.options_menu, menu);
          return true;
    }

        /* Handles item selections */
        public boolean onOptionsItemSelected(MenuItem item) {
            switch(item.getItemId())
            {       
                case R.id.menu1:
                                           //your stuff
                break;
                case R.id.menu2:
                                           //your stuff
                break;
            }
        return true;
        }

} 
```

# python - 如何将 optparse.Values 类型声明为全局

> ID：10319990
> 
> 赞同：0
> 
> 时间：2012-04-25T16:36:37.540
> 
> 标签：python

我想将“选项”设置为全局：

```
(options, _) = parser.parse_args() 
```

它是什么类型的？

TIA,

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:39:45.250

它不需要使用特定类型的值显式初始化。您只需要使用`global`关键字：

```
global options
(options, _) = parser.parse_args() 
```

# codeigniter - CodeIgniter - 从 db 中选择数据，对所有视图都通用

> ID：10319992
> 
> 赞同：1
> 
> 时间：2012-04-25T16:36:45.267
> 
> 标签：codeigniter, view

我对 CI 很陌生。:)

在我的项目中，我将页面分为页眉、页脚和正文。并且正文部分（视图）是基于控制器加载的。页眉和页脚对所有页面都是通用的。

例如，对于登录页面，它将是这样的：

```
$this->load->view('header');
$this->load->view('login');
$this->load->view('footer'); 
```

但现在我关心的是，如何生成“类别”部分（它将在正文部分的左侧列出几个类别名称）。单击类别后，相应的详细信息页面将显示在右侧（即在内容部分中）。因此，在所有视图（所有页面）中，我需要显示类别列表。

视觉示例：

```
----------------------------
   Header Portion of Page
----------------------------
       Body Portion
       ============
Cat1 |
Cat2 |
Cat3 |     Content
Cat4 |
Cat5 |
----------------------------
          Footer
---------------------------- 
```

这些类别是从 db 中的数据填充的。

我刚刚做了一些搜索。所以，我正在考虑创建一个辅助类并自动加载它。因此，在所有观点中，我都会调用该函数并回显结果。

例如：

```
function hlp_getCategories()
{
    $ci =& get_instance();
    $q = $ci->db->query('SELECT cat_name FROM tblCategories');
            return $q;
} 
```

在视图中：

```
<?php
$q = hlp_getCategories();
foreach ($q->result_array() as $row)
{
   echo anchor('cat/' . $row['cat_name'], $row['cat_name']) ;
}
?> 
```

这是正确的方法吗？我在正确的轨道上吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T16:43:51.577

这是解决它的一种方法——尽管如果你遵循严格的 MVC 方法——助手会调用模型 $this->category->select_cat()，并将 SQL 查询放入模型中。此外，SQL 查询应该使用活动记录选择，而不是文本 SQL 查询。

解决它的另一种方法是使用一些CSS，其中左侧菜单（即类别）具有DIV，右侧菜单（即内容）具有DIV。

然后你可以做

```
 $this->load->view('header'); 
 $this->load->view('categories');
 $this->load->view('login'); 
 $this->load->view('footer'); 
```

然后在您的类别视图中

```
 <div class = "left">
     // show categories here
 </div> 
```

在您的内容视图中

```
 <div class = "right">
     // show content here
 </div> 
```

# qt - 将项目 Qt 转换为文件 .exe 用于窗口

> ID：10319996
> 
> 赞同：2
> 
> 时间：2012-04-25T16:36:50.290
> 
> 标签：qt, qt4.7

您好，我是 Qt 的年轻开发者。我想知道我们可以将项目 Qt（标题、源、表单、资源）转换为可以在没有 Qt Creator 的情况下运行的文件吗？我们如何将其转换为窗口上的可执行文件（.exe）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-25T17:23:32.177

编译器负责从源代码中生成可执行文件。这与Qt无关。当您从 QtCreator 启动程序时，编译器会构建一个可执行文件，然后启动。查看您的项目文件夹以找到该 .exe 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T17:57:04.050

你不必做任何特别的事情。每个 Qt 项目都有一个用于编译的 .pro 文件。您需要在命令行上使用 qmake，并将 .pro 文件作为输入。这将生成一个 makefile，然后您可以将其提供给 nmake.exe（如果使用 Visual Studio 编译器）或 mingw-make（如果您是 uisng mingw 编译器）进行构建。这些步骤会将您的源代码编译成 .exe。查看 qmake 的文档以了解更多信息。Qt Creator 也执行相同的步骤，您可以查看 Qt Creator 中的构建日志以查看它是否正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T07:10:36.730

是的，您使用 Qt Creator 或其他 IDE 或编译器编译的 exe 文件在技术上就是您从那里运行项目所需的全部内容，除非您需要以某种方式将链接的 Qt 库提供给可执行文件。如果您计划在与您开发它的机器不同的机器上运行它，这一点尤其重要。有关在这种情况下您可能需要考虑的其他详细信息，请参阅有关[部署 Qt 应用程序的 Qt 文档。](http://doc-snapshot.qt-project.org/4.8/deployment.html)

# css - CSS 定位问题。元素未在调用位置显示

> ID：10319997
> 
> 赞同：0
> 
> 时间：2012-04-25T16:36:51.517
> 
> 标签：css, wordpress

所以，CSS 不是我的强项。我需要一些帮助。我正在开发一个 Wordpress 插件，当我关闭 PHP 时，我需要帮助来让 CSS 与我一起工作。该页面可以在[http://www.airupt.com/?page_id=386](http://www.airupt.com/?page_id=386)看到。问题是我在搜索结果调用下方调用了搜索框的简码。这仅用于演示目的，修复后链接将很快失效。

请输入一些内容并搜索，您会明白我的意思。搜索框背景将出现在结果的顶部，在第一个之上。正如预期的那样，搜索框本身将出现在结果之后。

谁能告诉我代码哪里出错以及如何修复？:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:54:19.523

您是否在多个浏览器中对此进行测试？看起来不像。要回答您的问题：

给它一个`float:left;`，就像在`<div class="entry">`

```
.search-custom {
    float:left;
    /* all the other styles for search-custom that it normally has*/
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-25T16:54:25.257

我会说宁可设置`clear:both`。`.search-custom`

`overflow:hidden`会让你陷入更多/不同的麻烦，因为你的尺码有点偏

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-25T16:51:16.873

设置`overflow:hidden;`在您的`.search-custom`div 上，然后去获取一份[Firebug](http://getfirebug.com/)的副本。它会让你摆脱 80% 的困境。