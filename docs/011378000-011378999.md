# StackOverflow 问答 11378000-11378999

# android - 使用 Android GCM，您可以使用深度 JSON“数据”字段吗？

> ID：11378004
> 
> 赞同：11
> 
> 时间：2012-07-07T19:25:53.423
> 
> 标签：android, google-cloud-messaging

也就是说，你可以发送

```
{
  "registration_ids": ["whatever", ...],
  "data": {
    "foo": {
      "bar": {
        "baz": [42]
      }
    }
  }
} 
```

还是 GCM 请求的“数据”成员仅限于一级键值对？我问 b/c 谷歌文档 [1] 中的措辞提出了限制，其中说“数据”是：

> 一个 JSON 对象，其字段表示消息有效负载数据的键值对。如果存在，有效负载数据将作为应用程序数据包含在 Intent 中，键是额外的名称。例如，"data":{"score":"3x1"} 会产生一个额外命名为 score 的意图，其值为字符串 3x1 键/值对的数量没有限制，尽管消息的总大小。选修的。

[1] [http://developer.android.com/guide/google/gcm/gcm.html#request](http://developer.android.com/guide/google/gcm/gcm.html#request)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T03:49:37.447

刚刚自己做了一个测试，证实了我的猜想。

使用此有效负载向自己发送 GCM：

```
{
  "registration_ids": ["whatever", ...],
  "data": {
     "message": {
        "bar": {
           "baz": [42]
        }
     }
  }
} 
```

我的客户收到了它并额外解析了“消息”意图，如下所示：

```
handleMessage - message={        "bar": {          "baz": [42]        }      } 
```

因此，您确实可以对数据键的值进行进一步的 JSON 解析。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-28T22:28:37.227

尽管它似乎有效（请参阅其他答案和评论），但如果没有 Google 的明确声明，我不建议依赖它，因为他们的文档始终将 json 的顶级成员称为“键值对”。他们提供的服务器端助手 jar [1] 也强化了这个想法，因为它将用户数据建模为`Map<String, String>`. 他们的`Message.Builder.addData`方法甚至不支持非字符串值，所以即使布尔值、数字和 null 可以在 json 中表示，我也会谨慎使用它们。

如果 Google 以破坏这种（可以说不受支持的）用法的方式更新其后端代码，则依赖它的应用程序将需要更新才能继续工作。为了安全起见，我将使用单个键值对，其值为 json 字符串化的深度对象 [2]。我的数据不是很大，我可以承受 json-inside-json 开销，但是 ymmv。此外，我的成员之一是一个可变长度列表，将它们展平为键值对总是很难看的 :)

[1] [http://developer.android.com/guide/google/gcm/server-javadoc/index.html（jar](http://developer.android.com/guide/google/gcm/server-javadoc/index.html)本身只能在 Android SDK 的 gcm-server/dist 目录中使用，每个[http： //developer.android.com/guide/google/gcm/gs.html#server-app](http://developer.android.com/guide/google/gcm/gs.html#server-app) )

[2] 例如，我的整个有效载荷将如下所示：

```
{
  "registration_ids": ["whatever", ...],
  "data": {
    "player": "{\"score\": 1234, \"new_achievements\": [\"hot foot\", \"nimble\"]}"
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-13T11:06:40.980

如果我错了，请原谅我，`Map<String, String>`表示 key=string 和 value=string。

如果字符串是一个长的不合理的 json 提取，它是 UTF-8 格式并且很好地转义。按理说应该调用 new JSONObject(receivedString); 它可以工作，然后所有其他 json 调用都会跟随。

不要忘记原始 JSON 是一个字符串！我们不需要谷歌来澄清如何使用字符串..这就是您的测试有效的原因！

# objective-c - ViewController 不接受我的委托

> ID：11378007
> 
> 赞同：0
> 
> 时间：2012-07-07T19:26:19.577
> 
> 标签：objective-c, ios, delegates

我有一个具有以下结构的 ViewController 类：

头文件：

```
@protocol GCStageViewControllerDelegate;

@interface GCStageViewController : UIViewController <UIActionSheetDelegate, UITextFieldDelegate, UIImagePickerControllerDelegate> {
     id <GCStageViewControllerDelegate> delegate;
...
}

@property (nonatomic, retain) id <GCStageViewControllerDelegate> delegate;

...

@end

@protocol GCStageViewControllerDelegate

- (void)gcStageViewContollerDidFinish:(GCStageViewController *)controller withGCStageItem:(GCStageItem *)item;

@end 
```

实现文件：

```
- (void)viewDidLoad {
...
     stageInputTextField.delegate = self; // works
...
}

- (void)takePicture {
    UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];

    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) {
        [imagePicker setSourceType:UIImagePickerControllerSourceTypeCamera];
    } else {
        [imagePicker setSourceType:UIImagePickerControllerSourceTypePhotoLibrary];
    }

    imagePicker.delegate = self; // here I get the error

    [self presentModalViewController:imagePicker animated:YES];
} 
```

如果我在 takePicture 方法中设置委托，我会收到以下警告：

> 分配给`'id<UINavigationControllerDelegate,UIImagePickerControllerDelegate>'`不兼容的类型'GCStageViewController *'

有什么想法有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:42:01.790

显然 UIImagePicker 需要你也实现 UINavigationControllerDelegate 协议。请参阅[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImagePickerController_Class/UIImagePickerController/UIImagePickerController.html#//apple_ref/doc/uid/TP40007070-CH3-SW7)，其中清楚地表明委托应符合两者。:-)

幸运的是，该协议中的所有方法都是可选的，因此您只需假装：

```
// change this
@interface GCStageViewController : UIViewController <UIActionSheetDelegate, UITextFieldDelegate, UIImagePickerControllerDelegate> {
// to this
@interface GCStageViewController : UIViewController <UIActionSheetDelegate, UITextFieldDelegate, UIImagePickerControllerDelegate, UINavigationControllerDelegate> { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T19:44:32.730

UIImagePickerControllerDelegate 实际上需要符合*两个*协议：`UIImagePickerControllerDelegate`和`UINavigationControllerDelegate`. 标头中的符合，`UINavigationControllerDelegate`错误将消失。

```
@interface GCStageViewController : UIViewController <UIActionSheetDelegate, UITextFieldDelegate, UIImagePickerControllerDelegate, UINavigationControllerDelegate> 
```

# objective-c - 重命名 Quicklook-template GeneratePreviewForURL.m 会导致链接器错误

> ID：11378010
> 
> 赞同：0
> 
> 时间：2012-07-07T19:26:37.877
> 
> 标签：objective-c, xcode, linker-errors, quicklook

我正在使用稍微过时的 Xcode 版本（4.2.1，Apple clang 3.0 版），这可能是一个问题，但是.. 这应该可以工作：

我创建了一个新的 Quicklook 插件项目（“File > New > New Project”，然后是“System Plugin > Quick Look Plug-in”）

然后我重命名`GeneratePreviewForURL.c`为`GeneratePreviewForURL.m`（如[Apple docs 中所述](http://developer.apple.com/library/mac/#documentation/userexperience/conceptual/Quicklook_Programming_Guide/Articles/QLProjectConfig.html)）

如果我尝试在文件中使用任何 Objective-C 代码，我会收到错误消息。例如，如果我将以下内容添加到`GeneratePreviewForURL`方法中：

```
#include <Foundation/Foundation.h> // at start of file

NSMutableDictionary *blah;
[blah setValue:@"valuething" forKey:@"keything"]; 
```

我收到以下链接器错误：

```
Undefined symbols for architecture x86_64:
  "_objc_msgSend", referenced from:
      _GeneratePreviewForURL in GeneratePreviewForURL.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

导致问题的稍微修剪/重组的链接器命令是：

```
cd ~/QuicklookExample

setenv MACOSX_DEPLOYMENT_TARGET 10.7

/Developer/usr/bin/clang
-arch x86_64 -bundle
-isysroot /Developer/SDKs/MacOSX10.7.sdk
-L/snip -F/snip -filelist /snip/QuicklookExample.LinkFileList
-mmacosx-version-min=10.7
-framework QuickLook
-framework ApplicationServices
-framework CoreServices
-framework CoreFoundation
-o /snip/QuicklookExample 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T22:59:44.737

您必须至少将 Foundation 框架添加到链接库中。

请注意，这里缺少的是 libobjc，它应该通过 clang 应该理解您的代码实际上是 Objective-C 的事实直接链接。

# android - 挂载/卸载 SD 卡，或模拟它 - Android

> ID：11378012
> 
> 赞同：0
> 
> 时间：2012-07-07T19:26:54.483
> 
> 标签：android, media, sd-card, mount

编辑：Android 手机的默认媒体播放器会扫描 sdcard 中的歌曲文件，然后允许用户根据扫描的内容播放这些歌曲。

我制作的应用程序将其他歌曲文件写入 sdcard，但默认媒体播放器看不到这些歌曲，因为它仅在 A：重新启动（手机打开）时扫描歌曲文件。或 B：当手机的 sdcard 已**安装**时。

我的问题是我需要以编程方式卸载/安装 SD 卡，或者模拟一些让音乐播放器认为已经发生的事情。

在我需要使用设置应用[程序的android状态下以编程方式安装sdcard ？](https://stackoverflow.com/questions/8342679/mount-sdcard-programmitically-in-android)

我不想使用其他应用程序。我发现的所有其他文章都围绕模拟器展开。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T19:52:05.053

```
sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://" + Environment.getExternalStorageDirectory()))); 
```

请注意，在广播此意图时，某些制造商自定义操作系统版本无法正确扫描。我有一个 motoblur 设备，我必须使用其他东西才能开始工作。不记得到底是什么。

# java - 哈希码实现

> ID：11378014
> 
> 赞同：0
> 
> 时间：2012-07-07T19:27:30.463
> 
> 标签：java, hashcode

```
class A{

      @Override
      public int hashCode() {
        return 10;
    }
}

public class SampleClass {

    public static void main(String[] args){
        Map map = new HashMap();

        map.put(new A(), "A");
        map.put(new A(), "B");

        System.out.println(map.size());

        System.out.println(new A().hashCode());
        System.out.println(new A().hashCode());
    }
} 
```

**输出 ：-**

```
2

10

10 
```

为什么2？？？如果我们正在实现返回相同整数的 hashCode 方法。大小不应该是1吗？？？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-07T19:28:07.663

你还没有覆盖`equals(Object)`，所以他们不比较相等。

仅仅因为两个对象具有相同的哈希码并不意味着`HashMap`假设它们是相同的——事实上，如果*是*这样的话，那将是*非常非常糟糕的。*

如果您希望两个`A`对象被 视为相等`HashMap`，则必须覆盖`equals(Object)`in`A`以将一个对象定义`A`为与另一个对象相等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T19:32:48.950

来自[http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#hashCode](http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html#hashCode) ()

> hashCode 的一般合约是：
> 
> *   每当在 Java 应用程序执行期间对同一个对象多次调用它时，hashCode 方法必须始终返回相同的整数，前提是没有修改对象上的 equals 比较中使用的信息。该整数不需要从应用程序的一次执行到同一应用程序的另一次执行保持一致。
>     
>     
> *   如果两个对象根据 equals(Object) 方法相等，则对两个对象中的每一个调用 hashCode 方法必须产生相同的整数结果。
>     
>     
> *   **如果根据 equals(java.lang.Object) 方法，如果两个对象不相等，则不需要对两个对象中的每一个调用 hashCode 方法都必须产生不同的整数结果。** 但是，程序员应该意识到，为不相等的对象生成不同的整数结果可能会提高哈希表的性能。

因此，当要知道两个对象是否相等时，正如 Louis 指出的那样，equals 是要走的路。哈希码仅告诉给定基于哈希的集合实现的对象在哪里/如何存储。

# php - CodeIgniter MySQL 查询在标签后不起作用

> ID：11378018
> 
> 赞同：-6
> 
> 时间：2012-07-07T19:28:31.177
> 
> 标签：php, mysql, codeigniter

我正在尝试有条件地从数据库中获取结果。就像 a = 1 和 b != 2 以及这么多条件......

这是我的代码示例

```
$u = $this->ion_auth->user()->row()->id;

$hide=$this->find_hide_post();

$friend=$this->get_all_contacts(); 
```

在此之后我开始我的主要查询

```
$this->db->where('user_id',$u);

foreach($friend as $fr)
{
  foreach($fr as $f)
  {
    if($f->sub_id !=$u)
    {
      $this->db->or_where('user_id', $f->sub_id);
    }
    elseif($f->obj_id !=$u)
    {
      $this->db->or_where('user_id', $f->obj_id);
    }

    $this->db->where('time >', $f->time);
  }
} 
```

我得到了很好的正确结果，但是每当我添加这些行时，我都没有得到正确的结果。但我需要从结果中删除这些帖子。

```
foreach($hide as $h)
{
  $this->db->where('id !=', $h->post_id);
} 
```

最后我通过这种方式

```
$result=$this->db->get('my_wall');
$row=$result->result();
print_r($row); 
```

结果是：

数组 ( [0] => stdClass 对象 ( [id] => 18 [user_id] => 19 [post] => [img] => public/users/wall/pic/Messenger14.png [doc] => [video ] => [link] => [link_name] => [access_id] => [like] => 0 [time] => 1340792296）

```
[1] => stdClass Object
    (
        [id] => 19
        [user_id] => 19
        [post] => This is my test Documents
        [img] => 
        [doc] => public/users/wall/doc/19/20745322_temp.pdf
        [video] => 
        [link] => 
        [link_name] => 
        [access_id] => 
        [like] => 0
        [time] => 1340792743
    ) 
```

我想避免那些 id 不是 19 或类似的帖子。但我的最后一个查询不起作用:(，结果是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:27:13.407

这是因为您的逻辑与 CodeIgniter 的 Active Record 类没有很好地混合。你不能混合`or_where`，`where`否则你会得到模糊的逻辑。您需要修复您的逻辑以使您的查询正确。这是我的建议。

重写您的`foreach`语句以将所有内容打包到一个数组中。

```
$ids = array();
foreach ($friend as $fr) {
    foreach($fr as $f) {
        if (...) {
            $ids[] = $f->sub_id;
        }
    }
    $this->db->where('time >', $f->time);
} 
```

... 等等。完成`foreach`语句后，请改为添加以下行。

```
$this->db->where_in('user_id', $ids); 
```

这应该使您能够正确呈现 SQL 语句：

```
foreach($hide as $h)
{
  $this->db->where('id !=', $h->post_id);
} 
```

# google-chrome - Chrome 开发者工具 > 资源 > cookies > http 一栏，这里打勾是不是表示HttpOnly cookie？

> ID：11378025
> 
> 赞同：65
> 
> 时间：2012-07-07T19:29:34.333
> 
> 标签：google-chrome, cookies, google-chrome-devtools, httponly

Chrome devtool 的 Cookie 资源面板的 Http 列的复选标记是否表示 HttpOnly cookie？

我找不到证实这一点的文档，尽管我怀疑是这样。我正在尝试验证我的应用程序是否将 HttpOnly 用于会话 cookie。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-07-07T19:36:35.480

是的。在控制台中输入[`document.cookie`](https://developer.mozilla.org/en/DOM/document.cookie)，您将看到所有已检查的 cookie 均不可见。

![名称 值 域 路径 过期 大小 HTTP 安全](../Images/4dd26f738a297fb24211053dc4909b93.png)

HTTP = HttpOnly 标志，Secure = 安全标志。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-11-18T07:21:52.767

是的。右键单击您的页面或按下`F12`按钮。这将打开开发人员工具窗口。转到应用程序选项卡。它将显示如下：-

[![在此处输入图像描述](../Images/d99eb7847f246aeccdcd34d927881fa6.png)](https://i.stack.imgur.com/pfLjD.png)

现在，在选项卡上键入 document.cookie，您将看到只显示 csrf 令牌。[![在此处输入图像描述](../Images/a9a685781f42bb78e9ca2d69241be822.png)](https://i.stack.imgur.com/2sHP5.png)

要将会话 cookie 默认指定为 httpCookie，请`'useHttpOnly'`在 tomcat 的 context.xml 中设置属性，用于 java Web 应用程序。有关详细信息，请参阅[http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Common_Attributes](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Common_Attributes)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-01-08T07:36:47.703

所以 2 件事。

1)`HTTP only cookie`这个名字有点误导，因为我们可以通过 HTTPS 发送 HTTPOnly cookie，它工作得很好。cookie 的主要特点`HTTP Only`是无法使用 JavaScript 访问。事实上，您甚至无法在 Chrome 的`Application`标签中手动编辑它。

2) 那么如何编辑 HTTP Only cookie 呢？在 chrome 中，您可以在开发时使用[扩展来编辑](https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg?hl=en)cookie。`man in the middle`在生产模式下，如果不对HTTP 连接进行攻击，您就无法对其进行掺假。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-21T17:19:04.807

今天（2016 年 5 月），出于同样的原因谷歌搜索，我发现了这个问题和[来自 developers.google.com 的这个页面](https://developers.google.com/web/tools/chrome-devtools/iterate/manage-data/cookies#learn-about-each-cookie)解释：

> HTTP：如果存在，则表示只能通过 HTTP 使用 cookie，并且不允许修改 JavaScript。

# c# - lucene.net search & order search result by hit.score c#

> ID：11378026
> 
> 赞同：1
> 
> 时间：2012-07-07T19:29:37.533
> 
> 标签：c#, lucene.net

我正在寻找通过 lucene.net 搜索索引数据的代码。我从这个网址得到了一个代码 [http://www.eggheadcafe.com/tutorials/csharp/c69ef65f-e3c6-409e-ab97-168897c74f83/lucenenet-indexing-searching-entry-level-tutorial.aspx](http://www.eggheadcafe.com/tutorials/csharp/c69ef65f-e3c6-409e-ab97-168897c74f83/lucenenet-indexing-searching-entry-level-tutorial.aspx)

这是小示例代码。

```
List<SearchResult> list = new List<SearchResult>();
SearchResult sr = null;
for (int i = 0; i < results; i++)
{
    sr = new SearchResult();
    Document doc = hits.Doc(i);
    float score = hits.Score(i);
    sr.Id = int.Parse(doc.Get("id"));
    sr.Score = score;
    sr.Description = doc.Get("Description");
    sr.Title = doc.Get("Title");
    sr.Link = doc.Get("Link");
    list.Add(sr);
}
//sort by score
list = list.OrderByDescending(x => x.Score).ToList(); 
```

我不清楚一件事是什么是**hit.score？** 为什么结果集按**hit.score**降序排列？

我通过上面的代码搜索索引并且代码正在运行。我输入**“audi jcb”**进行搜索，我看到 audi 有六个搜索数据，jcb 有一个数据，但 jcb 数据排在最前面....我只是不明白为什么。我想在顶部显示那些将具有最大搜索结果的数据。因为那是改变代码有点像

```
list = list.OrderBy(x => x.Score).ToList(); 
```

我通过升序搜索，但仍然没有以我想要的方式获得结果....audi 数据没有排在首位。所以请指导我在我的代码中包含哪些内容，因为结果这些数据将在搜索结果集中出现最多。请指导我谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:25:37.267

分数是文档与查询的相关性的指标。分数越高，文档越有可能是相关的。

在不了解您的数据集的情况下，我很难说出为什么 jcb 文档的得分超过了 audi 文档。如果就您的文档中关键字的出现而言，其他所有条件都相同，我猜想 jcb 是一个比 audi 少见的术语。频率较低的术语权重较高，因为如果您碰巧匹配一个罕见的术语，它们更有可能是您正在寻找的内容。

使用 2 种不同类型获得相同结果的问题可能是我能想到的两件事。一个是你的某种错误。两个是如果所有结果都具有相同的分数。

你能检查你的结果的分数吗？

# cocoa - 剥离 NSDate 的时间

> ID：11378027
> 
> 赞同：3
> 
> 时间：2012-07-07T19:29:41.213
> 
> 标签：cocoa, nsdate, nscalendar, nsdatecomponents

我已经看到以下代码的许多版本来从 NSDate 中删除时间元素。

```
NSCalendar *cal = [NSCalendar currentCalendar];
NSDate *now = [NSDate date];
unsigned int intFlags = NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit;
NSDateComponents *components = [cal components:intFlags fromDate:now];

NSDate *today = [cal dateFromComponents:components]; 
```

问题是它没有按预期工作。我目前在英国夏令时 (BST)。如果我现在运行这段代码，now=@"2012-07-07 19:24:06 +0000"

今天=@"2012-07-06 23:00:00 +0000"

我想看的是今天=@"2012-07-07 00:00:00 +0000"

我只能猜测它与夏令时有关。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T00:35:58.480

您将获得 BST 午夜（格林威治标准时间 + 1 小时），与格林威治标准时间 23:00 (+0000) 相同。

[NSDate date] 将返回当前时区的日期，因此您的日期为 BST。您是否也尝试过将时区设置为 GMT：

```
[components setTimeZone:[NSTimeZone timeZoneWithName:@"GMT"]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T02:34:03.143

没有没有时间的日期，因为从来没有一个时间点没有时间（无论如何，根据我们当前的日历系统），日期只是一个时间点。因此，日期必然*有*时间。

您*可以*做的是*格式化*日期，以便不显示时间。为此，您使用`NSDateFormatter`：

```
NSDate *date = [NSDate date];
NSCalendar *calendar = [NSCalendar currentCalendar];
NSDateComponents *components = [calendar components:(NSEraCalendarUnit | NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit) fromDate:date];

NSDate *todayAtMidnight = [calendar dateFromComponents:components];

NSString *formatted = [NSDateFormatter localizedStringFromDate:todayAtMidnight dateStyle: NSDateFormatterMediumStyle];
// "formatted" is now something like "Jul 8, 2012". 
// It varies according to your locale and user settings. 
```

从技术上讲，如果您只是在没有时间的情况下格式化日期，那么第一个位（将时间部分设置为午夜）是不必要的，但如果它让您觉得您实际上是在“删除时间”，则可以将其保留. :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T19:40:17.593

添加一个

```
[components setHour:0];
[components setMinute:0];
[components setSecond:0]; 
```

以避免使用默认值。文档甚至没有说明这些值是什么，因此它们可能不是“0”。

# php - 通过 PHP 获取 ObjectId MongoDB

> ID：11378029
> 
> 赞同：4
> 
> 时间：2012-07-07T19:29:46.920
> 
> 标签：php, mongodb

这是我的脚本

```
$terms = ['username' => $uri];
$user = $collection->findOne($terms); 
```

结果

```
array (size=4)
  '_id' => 
    object(MongoId)[29]
      public '$id' => string '4ff6e96bb0b4599016000006' (length=24)
  'username' => string 'me' (length=10)
  'name' => string 'Yes, It's me!' (length=16) 
```

**获取名称**

`$name = $user['name'];`

但是，我怎样才能得到`$user['_id']`？

我尝试`$user['_id']`不工作

请帮忙。谢谢

**更新**

问题解决了`$user['_id']->{'$id'}`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-13T09:13:11.830

`$user['_id']->{'$id'}`没有必要也很丑陋，您可以简单地将其转换为字符串以获取 id`$id = (string)$user['_id'];`

# asp.net - 使用 LINQ 创建简单的登录

> ID：11378033
> 
> 赞同：0
> 
> 时间：2012-07-07T19:30:36.943
> 
> 标签：asp.net, database, linq, login

我是 C# ASP.NET 初学者，所以请原谅任何……不太正确的事情！

简而言之，我想创建一个非常基本的登录系统：一个通过数据库运行并使用会话的系统，这样只有登录的用户才能访问某些页面。我知道如何做大部分事情，但我坚持在登录页面上使用 LINQ 查询数据。

在登录页面上，我有一个用于选择用户名的 DropDownList、一个用于输入密码的文本框和一个用于登录的按钮（我还有一个用于错误的文字）。DropDownList 数据绑定到名为 DT_Test 的数据表。DT_Test 包含三列：UsernameID (int)、Username (nchar(30)) 和 Password (nchar(30))。UsernameID 是主键。

我想使用 DropDownList 和文本框从数据库中查询按钮的单击事件数据，以检查用户名和密码是否匹配。但是我不知道该怎么做...

当前代码（不是很多！）：

前端：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Login_Test.aspx.cs" Inherits="Login_Login_Test" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Login Test</title>
</head>
<body>
    <form id="LoginTest" runat="server">
    <div>

        <asp:DropDownList ID="DDL_Username" runat="server" Height="20px" 
            DataTextField="txt">
        </asp:DropDownList>
        <br />
        <asp:TextBox ID="TB_Password" runat="server" TextMode="Password"></asp:TextBox>
        <br />
        <asp:Button ID="B_Login" runat="server" onclick="B_Login_Click" Text="Login" />
        <br />
        <asp:Literal ID="LI_Result" runat="server"></asp:Literal>

    </div>
    </form>
</body>
</html> 
```

后端：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Login_Login_Test : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            Binder();
            }
    }

    private void Binder()
    {
        using (DataClassesDataContext db = new DataClassesDataContext())
        {
            DDL_Username.DataSource = from x in db.DT_Honeys select new { x.UsernameID, txt = x.Username };
            DDL_Username.DataBind();
        }
    }
    protected void B_Login_Click(object sender, EventArgs e)
    {
        if (TB_Password.Text != "")
        {
            using (DataClassesDataContext db = new DataClassesDataContext())
            {

            }
        }

    }
} 
```

我花了几个小时搜索和尝试不同的代码，但似乎没有一个适合这种情况。

无论如何，感谢您的帮助和提示，非常感谢！

*   我知道安全风险等，但这不是一个实时网站或任何东西，它只是作为初学者的测试目的。*

更新代码：

后端：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Login_Page_Test : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            Tester();
        }
    }

    private void Tester()
    {
        using (DataClassesDataContext db = new DataClassesDataContext())
        {
            DDL_Username.DataSource = from x in db.DT_Honeys select new { id = x.UsernameID, txt = x.Username };
            DDL_Username.DataValueField = "id";
            DDL_Username.DataTextField = "txt";
            DDL_Username.DataBind();
        }
    }
    protected void B_Login_Click(object sender, EventArgs e)
    {
        if (TB_Password.Text != "")
        {
            using (DataClassesDataContext db = new DataClassesDataContext())
            {
                DT_Honey blah = new DT_Honey();
                blah = db.DT_Honeys.SingleOrDefault(x => x.UsernameID == int.Parse(DDL_Username.SelectedValue.ToString()));

                if (blah != null)
                {
                    if (TB_Password.Text.ToString().Trim() == blah.Password.ToString())
                    {
                        LI_Result.Text = "Credentials correct.";
                    }
                    else
                    {
                        LI_Result.Text = "Error: credentials are incorrect.";
                }
                }
                else
                {
                    LI_Result.Text = "Error: null value.";
                }

            }
    }

    }
} 
```

前端：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Login_Page_Test.aspx.cs" Inherits="Login_Page_Test" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Logi Page Test</title>
</head>
<body>
    <form id="LoginPageTest" runat="server">
    <div>

    </div>
    <asp:DropDownList ID="DDL_Username" runat="server">
    </asp:DropDownList>
    <br />
    <asp:TextBox ID="TB_Password" runat="server"></asp:TextBox>
    <br />
    <asp:Button ID="B_Login" runat="server" onclick="B_Login_Click" Text="Login" />
    <br />
    <asp:Literal ID="LI_Result" runat="server"></asp:Literal>
    </form>
</body>
</html> 
```

*   我检查了数据库方面，就主键、列、实际数据和数据类而言，一切都很好。

* * *

与文本框相同：

后端：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Login_Login_Page_2 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void B_Login_Click(object sender, EventArgs e)
    {
        if (TB_Username.Text.ToString().Trim() != "" && TB_Password.Text.ToString().Trim() != "")
        {
            using (DataClassesDataContext db = new DataClassesDataContext())
            {
                DT_Honey Login = new DT_Honey();
                Login = db.DT_Honeys.SingleOrDefault(y => y.UsernameID == int.Parse(TB_Username.Text.ToString().Trim()));

                if (Login != null)
                {
                    if (TB_Password.Text.Trim() == Login.Password.ToString().Trim())
                    {
                        LI_Result.Text = "Yeah! The credentials you entered were correct!";
                    }
                }

                else
                {
                    LI_Result.Text = "Oops! There was an error with the credentials you entered; please try again.";
                }
            }
        }

        else
        {
            LI_Result.Text = "Wow! Please fill out <b>both</b> the Username and Password text fields to login; thank you.";
        }
    }
} 
```

前端：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Login_Page_2.aspx.cs" Inherits="Login_Login_Page_2" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Login Page 2</title>
</head>
<body>
    <form id="LoginPage2" runat="server">
    <div>

        <asp:TextBox ID="TB_Username" runat="server"></asp:TextBox>
        <br />
        <asp:TextBox ID="TB_Password" runat="server"></asp:TextBox>
        <br />
        <asp:Button ID="B_Login" runat="server" onclick="B_Login_Click" Text="Login" />
        <br />
        <asp:Literal ID="LI_Result" runat="server"></asp:Literal>

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:00:44.360

由于您自称是初学者，因此我真的**建议您使用本机 asp.net 登录控件。**您的代码很可能不如 100 名工程师花费数年时间开发的登录控件安全。您是否真的有一个令人信服的理由来构建自己的自定义登录？首先，做你正在做的事情依赖于存储未加密的密码......

**您通过自己重做登录控制在您的应用程序中引入了潜在的严重安全漏洞！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T19:52:18.503

也许这会对你有所帮助？：

```
protected void B_Login_Click(object sender, EventArgs e)
    {
        if (TB_Password.Text != "")
        {
            using (DataClassesDataContext db = new DataClassesDataContext())
            {
                var user = db.DT_Test.SingleOrDefault(x => x.Username == DDL_Username.SelectedText);

                if (user == null) 
                {
                    // whoops something's wrong (no matching username in db)
                }

                if (user.Password == TB_Password.Text)
                {
                    // do something (correct password)
                }
                else
                {
                    // something else (incorrect password)
                }
            }
        }

    } 
```

但是，最佳实践是使用 ASP.NET 的标准成员资格提供程序。然后，您不必在数据库中设置自己的成员资格模式。（看起来好像您正在以明文形式存储密码，但会员提供商会解决这个问题并为您处理详细信息。）

[MSDN 会员介绍](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)

**编辑** 您可能需要更改 Binder 代码，以便下拉项目的 ID 与数据库 ID 号匹配：

```
private void Binder()
{
    using (DataClassesDataContext db = new DataClassesDataContext())
    {
        DDL_Username.DataSource = from x in db.DT_Honeys select new { id = x.UsernameID, txt = x.Username };
        DDL_Username.DataValueField = "id";
        DDL_Username.DataTextField = "txt";
        DDL_Username.DataBind();
    }
} 
```

# html - 使表单输入无法发送

> ID：11378034
> 
> 赞同：0
> 
> 时间：2012-07-07T19:31:05.500
> 
> 标签：html, forms

如何在标签中放置可编辑的输入并使其无法发送，这可能吗？因为我想通过使用这些来编辑隐藏值。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T19:34:03.983

要使输入不可发送，只需删除其'`name`属性：

```
<input type="text" id="myInput" value="" /> 
```

# objective-c - 活动指示器仅显示在一个单元格中

> ID：11378037
> 
> 赞同：0
> 
> 时间：2012-07-07T19:31:16.213
> 
> 标签：objective-c, ios, cocoa

我有一个 UITableView 填充了显示文件名的单元格，这些单元格还指示文件的上传/下载进度。移动文件时，其对应的单元格应`UIActivityIndicatorView`在其附件视图中显示 a。我有一个`UIActivityIndicatorView`设置并准备进入`viewDidLoad`，**但是当我尝试将其设置为多个单元格的附件视图时，它只显示在*一个*单元格**中。

```
-(void)viewDidLoad {

    [super viewDidLoad];

    activityIndicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    [activityIndicator startAnimating];

}

//...code that detects file changes and calls fileChange

-(void)fileChange {

    for (int i = 0; i < [self.cloudNames count]; i++) {

        //detect whether file name in array is uploading, downloading, or doing nothing

        NSIndexPath *indexPath = [NSIndexPath indexPathForRow:i inSection:0];
        UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];

        if (downloading) {

            cell.accessoryView = activityIndicator;
            //other changes here specific to downloads

        } else if (uploading) {

            cell.accessoryView = activityIndicator;
            //other changes here specific to uploads

        } else {

            cell.accessoryView = nil;

        }

    }

} 
```

正如我所说，**活动指示器只显示在一个单元格中，即使有多个单元格应该显示它**。

我不想`UIActivityIndicatorView`在`fileChange`方法中设置（即使它有效），因为在上传/下载过程中会多次调用此方法。如果调用该方法并在那里设置了活动指示器，则在调用该方法时，所有表格视图单元格中的活动指示器都会重置，从而导致动画出现故障和不流畅，并导致巨大的内存问题。

有什么想法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T19:57:29.120

即使您正在为单元格设置活动指示器，您也只有一个实例变量。这样做的方法是为里面的每个单元格创建一个指标`tableView:cellForRowAtIndexPath:`

您可以为 设置标签，`UIActivityIndicatorView`并且无论何时您想访问它或抓取它，您都可以获取单元格，并使用 获取指示器视图`[cellView viewWithTag:theTag]`。不需要实例变量。

如果你想让事情变得更漂亮，你可以继承`UITableViewCell`并在你的自定义单元格中做任何你想做的事情。

***编辑：***

要获取视图，您可以分配给附件视图并获取单元格附件视图：

```
 UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];

 UIActivityIndicatorView *indicator = (UIActivityIndicatorView *) cell.accessoryView; 
```

或者您可以将 UIActivityIndi​​catorView 添加到单元格的 contentView 中（这样您就可以将其放置在您想要的任何位置，您将拥有更大的灵活性）：

添加指标：

```
myIndicatorView.tag = 1;
[cell.contentView addSubview:myIndicatorView]; 
```

获取指标：

```
UIActivityIndicatorView *indicator = [cell.contentView viewWithTag:1]; 
```

希望这可以帮助

# c++ - Ellipsis Switch Case Visual Studio 等效项

> ID：11378039
> 
> 赞同：0
> 
> 时间：2012-07-07T19:32:05.763
> 
> 标签：c++, switch-statement, ellipsis

我正在尝试编写一个 switch 语句案例，以文本形式标识从 0 到 9 的所有数字。在 gcc 中，我相信可以使用语句 case '0'...'9'：

是否有可以在 Microsoft Visual Studio 中使用的等效表达式，或者我是否必须为每个数字编写一个单独的案例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-08-24T17:48:23.533

> 在 gcc 中，我相信可以使用语句 case '0'...'9'

是的，但这是 GNU C 编译器的扩展，它不是 C++ 标准。

我认为最好的方法是写这样的东西：

```
switch(c) {
  case '0':
  case '1':
  case '2':
  //...
  case '9':
    //Do something
  break;
} 
```

或者，如果您愿意：

```
switch(c) {
  case '0': case '1': case '2': /*...*/ case '9':
    //Do something
  break;
} 
```

`:`（注意和以下之间的空格`case`）

# php - 会话变量不在页面之间传输

> ID：11378040
> 
> 赞同：2
> 
> 时间：2012-07-07T19:32:17.537
> 
> 标签：php, session, transfer

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我正在制作一个简单的登录页面，但是我的`$_SESSION`变量没有在页面之间传输。我在`session_start()`每一页的开头阅读了许多其他关于文件夹写入权限等的帖子`session_write_close()`，但没有一个有效。不管有`session_write_close()`没有都没有什么不同，所以我把它留在里面。下面的所有代码都可以正常工作，因为我省略了下面和上面的代码，比如`$login_fail`来自哪里。

目前我设置的`$_SESSION`变量如下面的代码所示：

```
if($login_fail == "")
{
    $query = "SELECT first_name, last_name, email_address,password FROM user_info WHERE     email_address = '$email_address' AND password = '$password'";
    $result = mysql_query($query);

    if(!$result) die ("Database access : " .mysql_error());
    elseif (mysql_num_rows($result))
    {
        $row = mysql_fetch_row($result);
        $token = "$email_address";
        $token1 = "$password";
        echo "token: $token, token1: $token1, row[1]: $row[1], row2: $row[2] </ br>";
        if($token == $row[2] && $token1 == $row[3]) 
        {
            session_start();
            $_SESSION['first_name'] = $row[0];
            $_SESSION['last_name'] = $row[1];
            $_SESSION['email_address'] = $row[2];
            $_SESSION['password'] = $row[3];
            $_SESSION['check'] = md5($_SERVER['REMOTE_ADDR'].$_SERVER['HTTP_USER_AGENT']);
            //print_r($_SESSION);
            session_write_close();
            header("Location: http://127.0.0.1/websiteproject/test.php"); 
        }
        else die("Invalid username/password combination");       
    }
}
else
{
    echo "Login failed. Please try again.";
} 
```

我已经完成了`print_r($_SESSION)`，它打印了所有正确的信息。

然后在我的 test.php 中再次调用会话变量，以查看在真正简单的代码中发生了什么。

```
session_start();
print_r($_SESSION); 
```

结果是一个空数组。当我转到编写会话的 easyphp 临时文件时，我总是会找到两个文件：一个包含所有正确信息的原始文件和一个没有任何信息的新文件。似乎当我打电话给第二个时`session_start()`，它实际上是在开始一个新的会话，而不是回忆当前的会话。

我尝试进行研究以提供尽可能多的信息，而不是浪费人们的时间。任何想法都非常感谢。奇怪的是，这在几天前还有效，然后我开始对程序更深入的文件进行更改，这发生了。所以我`test.php`只是为了了解更多关于转移问题的信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T19:35:36.080

`session_start()`一旦任何数据或空格输出到浏览器，您就无法调用。

在您发布的代码中，您在调用`echo "token: $token, token1: $token1, row[1]: $row[1], row2: $row[2] ";`之前调用`session_start()`它不会启动会话。

添加`error_reporting(E_ALL); ini_set('display_errors', 1);`到脚本的开头，您应该会看到有关由于输出已发送而无法启动会话的警告。

尝试将`session_start();`调用移动到文件的*开头*。

# objective-c - Objective-C，以编程方式检测二进制的 i386 或 x86_x64 架构？

> ID：11378042
> 
> 赞同：4
> 
> 时间：2012-07-07T19:32:48.837
> 
> 标签：objective-c, binary, x86-64

有没有办法以编程方式检测/确定二进制文件（与我的应用程序分开）是否已编译为 i386、x86_x64 或两者？我想有一种方法（显然），虽然我真的不知道怎么做。任何建议或建议将不胜感激，谢谢。

编辑：我在 Apple 开发者网站上找到了一个示例，尽管它是用 C 语言编写的，并且设置更多地用作命令行工具。如果有人知道如何将它实现到我的 Objective-C 代码中，那将非常有帮助。

*   示例 [C] 代码：[CheckExecutableArchitecture](http://developer.apple.com/library/mac/#samplecode/CheckExecutableArchitecture/Introduction/Intro.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:00:54.207

您可以包含`mach-o`标头并简单地加载二进制文件，然后检查`mach_header`. 您应该阅读 Apple 的 Mach-O 格式说明以获取更多信息，它包括您需要的一切：http: [//developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/MachORuntime/Reference/reference.html](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/MachORuntime/Reference/reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T21:20:02.237

```
- (void)checkArchitecture {

NSArray *bundleArch = [[NSBundle bundleWithPath:@"/path/to/other/bundle"] executableArchitectures];

} 
```

# asp.net - ASP.NET Web Api (REST)：使用用户凭据或令牌进行身份验证？留下“注册新用户”资源密码免费？

> ID：11378046
> 
> 赞同：11
> 
> 时间：2012-07-07T19:32:56.450
> 
> 标签：asp.net, rest, asp.net-web-api, wcf-rest, asp.net-authentication

我正在尝试使用 asp.net web api 创建一个 REST 服务，一切正常，但我现在遇到了如何处理身份验证。

我有点困惑从哪里开始，这是我一直在想的。

我有一个包含许多资源的 REST api，每个资源都需要注册用户，那么这样做的最佳操作是什么？我是否应该在每次调用服务时在标头中发送用户名和密码，以便我可以使用在服务器上进行身份验证

> AuthorizationFilterAttribute

我至少应该加密它？我很想知道其他人在做什么，我知道有一个创建令牌的概念（我认为这将是短暂的），因此用户将进行身份验证然后接收令牌，然后发送该令牌进一步调用该服务。那么当令牌过期时我将如何处理这个问题呢？

我还有一个用于注册新用户的资源，实际上唯一会调用它的是我的客户（Android、iPhone）。那么我应该让它免于任何身份验证方法或输入硬编码密码或类似的东西，以便至少没有其他人可以注册新用户吗？请记住，该服务将在互联网上公开。

我只是似乎无法找到正确的方法来做到这一点，我当然想第一次尝试就正确，所以我不必完全重构服务。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T08:23:42.620

以下链接似乎涵盖了一些明智的 DIY 选项[http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/](http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/)。“基于公钥/私钥的令牌”部分涵盖了我过去有效使用的一种方法，可能会对您有所帮助。

目前虽然我正在使用[http://identityserver.codeplex.com/](http://identityserver.codeplex.com/) Thinktecture IdentityServer 和 OAuth 不记名令牌（“资源所有者密码凭证”授权类型）......我发现这是一组非常好的代码和示例工作并让 IOS 客户端获取令牌并调用 WebApi。

如果您真的必须保护您的注册屏幕，您可以使用安装在设备上的客户端证书进行身份验证...... Thinktecture 服务可以在这里提供帮助[https://identity.thinktecture.com/idsrv/docs/default.htm?RequestingatokenusingOAuth2。 .html](https://identity.thinktecture.com/idsrv/docs/default.htm?RequestingatokenusingOAuth2.html) _ 虽然如果您的注册过程是安全[的 什么是带有 nonce 的电子邮件中的激活/注册/密码重置链接的最佳实践，](https://stackoverflow.com/questions/1066611/what-are-best-practices-for-activation-registration-password-reset-links-in-emai)例如电子邮件确认和激活等，但公开访问可能是安全的 - 这一切都取决于您的业务需求和所需的标志向上工作流程。

您至少应该使用传输级安全 SSL，但正如您建议的消息级安全性，例如加密任何令牌是非常可取的 - OAuth 规范对此[http://self-issued.info/docs/draft-ietf-oauth有话要说-v2-bearer.html#mitigation](http://self-issued.info/docs/draft-ietf-oauth-v2-bearer.html#mitigation)。

关于过期令牌 - 我们倾向于以与我们的密码更改策略相同的频率使令牌过期；虽然保持有效时间很重要（以尽量减少令牌盗窃的影响）并且考虑平衡您的要求。OAuth 有刷新令牌的概念[为什么 OAuth v2 既有访问令牌又有刷新令牌？](https://stackoverflow.com/questions/3487991/why-does-oauth-v2-have-both-access-and-refresh-tokens)这里有一些关于这个主题的辩论和链接，我们目前没有使用这种方法，因为我们使用的 ID 服务器目前不支持这种方法。

确保您的令牌安全也是一个考虑因素，例如我们在 IOS 中使用 KeyChain，但如果可能的话，还要考虑移动设备管理策略，好像这些令牌或密码是它们可能被盗的设备之一，也许查看越狱检测、锁定屏幕执法等

# python - 遍历python字典中的单个维度

> ID：11378048
> 
> 赞同：1
> 
> 时间：2012-07-07T19:33:05.177
> 
> 标签：python, key, loops, dimension

> **可能重复：**
> [在 python 多维关联数组中迭代一个键](https://stackoverflow.com/questions/11377908/iterating-one-key-in-a-python-multidimensional-associative-array)

我创建了一个二维字典 myaddresses['john','smith'] = "address 1" myaddresses['john','doe'] = "address 2"

我如何以时尚方式迭代一维

```
for key in myaddresses.keys('john'): 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T19:48:35.377

坏消息：你不能（至少不能直接）。您所做的不是“二维”字典，而是以元组（在您的情况下为字符串对）作为键的字典，并且仅使用键的哈希值（通常使用哈希表）。您想要的需要顺序查找，即：

```
for key, val in my_dict.items():
    # no garantee we have string pair as key here
    try:
        firstname, lastname = key
    except ValueError:
        # not a pair...
        continue
    # this would require another try/except block since
    # equality test on different types can raise anything
    # but let's pretend it's ok :-/
    if firstname == "john":
        do_something_with(key, val) 
```

不用说，它有点打败了使用 dict 的全部意义。错误...如何使用适当的关系数据库来代替？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T19:38:41.570

尝试：

```
{k[1]:v for k,v in myaddresses.iteritems() if k[0]=='john'} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T19:37:33.473

它遍历所有键，因此它可能不是最有效的方法，但我将仅说明显而易见的方法，以防您忽略它：

```
for key in myaddresses.keys():
    if key[0] == 'john':
        print myaddresses[key] 
```

# mod-rewrite - 使用 mod_rewrite 指向博客

> ID：11378050
> 
> 赞同：1
> 
> 时间：2012-07-07T19:33:22.487
> 
> 标签：mod-rewrite, clean-urls

我正在尝试使用 mod_rewrite 将网站的博客部分指向博客网站。

这就是我必须处理的正常事情

```
RewriteRule ^(\w+)/?$ index.php?page=$1 
```

这就是我试图用于博客网站的内容

```
RewriteRule ^blog/?$ http://url.to.my.blogger.site 
```

但它不起作用，当我去站点/博客时，它会引导我到 index.php?page=blog 如果第一个是正确的，我需要做些什么来不进行第二次重写？像 if/else？抱歉，对 mod_rewrite 了解不多，所以任何建议都会很棒。

我还注意到，如果我尝试执行类似 site/home 之类的操作，一切正常，但如果我尝试点击 site/home/，它会将我所有的 url 放入错误的上下文中，例如我的 css 和图像无法正确加载.

我的完整文件是这个

```
RewriteEngine on

RewriteRule ^blog/?$ remote/blog/uri/here

RewriteRule ^(\w+)/?$ index.php?page=$1

RewriteCond %{THE_REQUEST} index\.php
RewriteRule ^index\.php - [F] 
```

当我点击站点/博客时，它仍然尝试为 index.php?page=blog 提供服务，我猜我必须在某个时候打破代码？我找不到有关 if/else 语句的文档

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-21T14:11:06.860

我需要在我的 RewriteRule 行中添加标志，这样服务器就不会进一步评估。将它们更改为

```
RewriteRule ^/blog http://url.to.blog [L] 
```

成功了，问题是它一直在评估，因为我没有尝试去索引最后一个要评估的有效规则是一般重写规则。

# netty - 你想过在 Netty 中使用 GNU Trove 吗？

> ID：11378055
> 
> 赞同：0
> 
> 时间：2012-07-07T19:34:24.210
> 
> 标签：netty

在尝试了一些示例之后，我真的很喜欢这个项目。我认为你们在这方面做得很好。只是好奇您是否考虑过使用 GNU Trove？你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T12:48:02.200

我可能是错的，但我怀疑这无助于进一步加快网络速度。我们也尽量保持依赖树尽可能小。因此，目前您可以将 netty 与“零”依赖项一起使用 :)

# mysql - WHILE 循环中的准备好的语句

> ID：11378056
> 
> 赞同：1
> 
> 时间：2012-07-07T19:34:40.087
> 
> 标签：mysql, stored-procedures, while-loop, prepared-statement

我有一个`autos`有列的表`name`，我想检查表中的前 5 行，如果`name`值是`"toyota"`，在表中`mytable`写“是”，否则写“否”。我编写存储过程，但`mysqli_error()`在行中返回错误，我有`EXECUTE ...`.

如果`WHEN`我不是写`PREPARED STATEMENT`，而是直接写查询，则该过程有效。请查看我的代码并告诉我，哪里错了？

```
CREATE PROCEDURE proc_auto()
BEGIN

DECLARE start INT;
SET start = 0;
PREPARE stmt FROM  ' SELECT name FROM autos ORDER BY id LIMIT ?,1 ';

WHILE start < 5 DO

    CASE 
        WHEN (EXECUTE stmt USING @start ) = 'toyota'
            THEN INSERT INTO mytable (log)  VALUES('yes');
        ELSE 
           INSERT INTO mytable (log)  VALUES('no');
    END CASE;
    SET start = start + 1;

END WHILE;
END; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T17:35:21.043

Andriy M 的`INSERT`语句是最优雅的解决方案，但如果您仍想使用过程，这将起作用：

```
CREATE PROCEDURE proc_auto()
BEGIN
    DECLARE start INT DEFAULT 0;

    PREPARE stmt FROM 
        'SELECT name INTO @name FROM autos ORDER BY id LIMIT ?,1';

    WHILE start < 5 DO
        SET @start = start;
        EXECUTE stmt USING @start;
        IF @name = 'toyota' THEN
            INSERT INTO mytable (log)  VALUES('yes');
        ELSE 
            INSERT INTO mytable (log)  VALUES('no');
        END IF;
        SET start = start + 1;
    END WHILE;
END; 
```

但是，在这种情况下，使用 a`CURSOR`会产生更好的性能：

```
CREATE PROCEDURE proc_auto()
BEGIN
    DECLARE start INT DEFAULT 0;
    DECLARE b_not_found BOOL DEFAULT FALSE;

    DECLARE cur CURSOR FOR
        'SELECT name FROM autos ORDER BY id LIMIT 5';

    DECLARE CONTINUE HANDLER FOR NOT FOUND SET b_not_found = TRUE;

    OPEN cur;

    loop1: WHILE start < 5 DO
        FETCH cur INTO @name;
        IF b_not_found THEN
            LEAVE loop1;
        END IF;

        IF @name = 'toyota' THEN
            INSERT INTO mytable (log)  VALUES('yes');
        ELSE 
            INSERT INTO mytable (log)  VALUES('no');
        END IF;
        SET start = start + 1;
    END WHILE;

    CLOSE cur;
END; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T20:47:52.650

[*（关于的建议`EXECUTE`被删除为不正确且可能令人困惑。）*]

您尝试使用存储过程解决的问题实际上可以在没有它的情况下解决，使用完全不同的方法：只需使用单个`INSERT ... SELECT`语句：

```
INSERT INTO mytable (log)
SELECT
  CASE name
    WHEN 'toyota' THEN 'yes'
    ELSE 'no'
  END
FROM autos
ORDER BY id
LIMIT 5 
```

也就是说，上述语句的作用与您的存储过程相同：它从 中检索前 5 行`autos`并将 5 行插入到`mytable`. 根据它的值`name`生成`yes`es 或`no`s。

# c++ - 如何将 QLine 添加到 QGridLayout

> ID：11378057
> 
> 赞同：4
> 
> 时间：2012-07-07T19:34:40.627
> 
> 标签：c++, qt, qt4

我正在尝试开发一个井字游戏，其中我将在 QMainWindow 中央小部件中放置一个 QGridLayout。在那里，我打算添加其他小部件（板单元）和分隔游戏单元的线。

这可能吗？我找不到在 QGridLayout 中插入 QLine 的任何 API。

如果这不可能，我可以将子小部件直接放在 QMainWindow 的中央小部件上吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T20:04:34.863

是的，您可以在容器小部件中使用 QGridLayout 进行井字游戏。

关于行：它是 Qt Designer 提供的一个便利工具，它不直接存在。实际上，一行是经过一些重新设计的 QFrame：

```
QFrame* line = new QFrame();
line->setGeometry(QRect(/* ... */));
line->setFrameShape(QFrame::HLine); // Replace by VLine for vertical line
line->setFrameShadow(QFrame::Sunken); 
```

您应该给这个框架一个非空高度（或垂直框架的宽度），例如 2 个像素。GUI 中的线条只能是水平的或垂直的。

**注意**：当您不知道 Qt Designer 中的小部件是如何完成的（甚至是 Qt Creator 中包含的小部件）时，您应该创建一个仅包含所需小部件的对话框，然后查看生成的代码。

# javascript - Javascript String nodejs流实现

> ID：11378059
> 
> 赞同：3
> 
> 时间：2012-07-07T19:35:00.220
> 
> 标签：javascript, node.js

我需要一个将数据发送到字符串的 nodejs 流 (http://nodejs.org/api/stream.html) 实现。你认识任何人吗？

直截了当，我试图通过管道发送这样的请求响应： request('http://google.com/doodle.png').pipe(fs.createWriteStream('doodle.png'))

来自[https://github.com/mikeal/request](https://github.com/mikeal/request)

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T19:55:50.640

编写一个符合 Stream 接口的类并不难；这是一个实现非常基础的示例，并且似乎可以与您链接的请求模块一起使用：

```
var stream = require('stream');
var util = require('util');
var request = require('request');

function StringStream() {
  stream.Stream.call(this);
  this.writable = true;
  this.buffer = "";
};
util.inherits(StringStream, stream.Stream);

StringStream.prototype.write = function(data) {
  if (data && data.length)
    this.buffer += data.toString();
};

StringStream.prototype.end = function(data) {
  this.write(data);
  this.emit('end');
};

StringStream.prototype.toString = function() {
  return this.buffer;
};

var s = new StringStream();
s.on('end', function() {
  console.log(this.toString());
});
request('http://google.com').pipe(s); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-10T19:28:03.460

您可能会发现模块中的类`Sink`对于`pipette`这个用例很方便。使用它，您可以编写：

```
var sink = new pipette.Sink(request(...));
sink.on('data', function(buffer) {
  console.log(buffer.toString());
} 
```

`Sink`还可以相当优雅地处理从流中返回的错误事件。有关详细信息，请参阅[https://github.com/Obvious/pipette#sink](https://github.com/Obvious/pipette#sink)。

[编辑：因为我意识到我使用了错误的事件名称。]

# c++ - 运算符关键字和运算符重载模拟

> ID：11378061
> 
> 赞同：0
> 
> 时间：2012-07-07T19:35:22.800
> 
> 标签：c++, operator-overloading

我知道我们可以对内在数据类型应用递增和递减，例如：

```
int a;

a++;
a--; 
```

...ETC。

但是，在下面的代码中，如果我`&`在行中省略`operator int& ( ) { return value; }`，我会得到一个编译错误。请在此处解释如何以及为什么使用`&`使增量成为可能：

```
#include <iostream>

class Foo {

public:
   int value;
   operator int& ( ) { return value; }

};

int main ( ) {
    Foo p;
    p.value = 10;

    p++;

    std::cout << p <<  std::endl;

    std::cin.get ( );
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T19:39:00.920

这个函数定义：

```
operator int&() { return value; } 
```

允许从您的类转换为`Foo`对 int 的引用。

这一行：

```
p++; 
```

由于类尚未实现，因此无法增加`p`类型。但是，它能够通过调用将 p 转换为对的引用，该调用返回对的特定实例内的引用。对的引用是可以使用递增的类型。所以代码然后就地递增。`Foo``operator++``int``operator int&()``value``Foo``value``int``++``value`

至于返回 in 和对 int 的引用之间的区别，以下代码显示您提到的行为与转换操作符不同：

```
class Foo
{
public:
    Foo() : m_value(0)
    {
    }

    int getCopy() { return m_value; }
    int& getRef() { return m_value; }
private:
    int m_value;
};

int main()
{
    Foo f;

    // Works
    f.getRef()++;

    // Does not work on g++ with 'error: lvalue required as increment operand`
    f.getCopy()++;
} 
```

`int`当转换运算符返回而不是增量操作时，您不能执行增量的原因`int&`是增量操作需要一个左值，即可以作为赋值目标的东西。有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/1353384/l-value-required-error)。

# grails - 问题 Grails 中的标签迭代

> ID：11378070
> 
> 赞同：0
> 
> 时间：2012-07-07T19:36:18.527
> 
> 标签：grails, dynamic, tags, dns, each

我是 grails 的新手，我正在尝试在表中显示数据库中域类的所有数据。当我打开 gsp 文件时，我的表是空白的。我不确定我做错了什么，因为我一直在使用相同的语法完全遵循每个教程。我的域类名称是“Test”，这是我的表格代码：

```
 <g:each var="test" in="${tests}">
        <tr>
            <td>
                ${test.testName}
            </td>
            <td>
                ${test.numberofQuestions}
            </td>
            <td>
                ${test.responseType}
            </td>
        </tr>
    </g:each> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T22:36:20.920

如果您只是想恢复所有“测试”域对象，您可以执行以下操作：

```
<g:each var="test" in="${com.mypackage.Test.list()}"> 
```

或者

```
<g:each var="test" in="${com.mypackage.Test.listOrderByTestName()}"> 
```

如果您希望它们按顺序排列`testName`（请务必使用实际的包名称代替`com.mypackage`）。

如果您尝试将`tests`变量传递到 GSP 中以用作 jonaldomo 在评论中所说的，我们将需要更多信息。

# javascript - 更改 Content-Type 时，Http-Method 从 POST 更改为 OPTIONS

> ID：11378075
> 
> 赞同：5
> 
> 时间：2012-07-07T19:37:15.773
> 
> 标签：javascript, xmlhttprequest, google-closure, plovr

我正在使用闭包库来做一个简单的 POST。我认为 XhrIo 应该可以工作，因为当我使用任何其他休息客户端（如 Firefox 浏览器应用程序 RESTClient 或 Chrome 的简单休息客户端）时，我可以从我的机器向服务器发出 POST 请求，并且内容类型是应用程序/json。

但从我的申请中，我无法发帖。我正在使用以下代码

```
xhr = new goog.net.XhrIo;
xhr.send('http://myhost:8181/customer/add','POST', goog.json.serialize(data)); 
```

如果我保留标题默认值，我会得到这个

> ```
> Encoding: UTF-8
> Http-Method: POST
> Content-Type: application/x-www-form-urlencoded;charset=UTF-8 
> ```

如果我尝试通过`{'content-type':'application/json'}`作为第 4 个参数传递来更改标题，标题更改为

> Http 方法：选项
> 内容类型：

我不应该像 RESTClient 使用 JQuery 对 XMLHttpRequest 所做的那样，使用 Closure 库适当地更改标题吗？

如何更改标题以使其看起来像这样

> ```
> Encoding: UTF-8
> Http-Method: POST
> Content-Type: application/json;charset=UTF-8 
> ```

感谢任何帮助埃迪

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-07T19:39:35.303

当您向 XHR 对象添加标头时，大多数浏览器都会执行预检请求，这就是`OPTIONS`您所看到的方法。不幸的是，如果您要添加自定义标头，则无法避免这种情况。将`POST`在 之后发送`OPTIONS`。

[这篇文章](https://developer.mozilla.org/En/HTTP_access_control#Preflighted_requests)`OPTIONS`稍微解释了这个请求。[前段时间我遇到](https://stackoverflow.com/questions/11199426/jquery-cors-json-without-padding-and-authentication-issues)了预检问题，如果这有帮助的话。

如果您对请求有特定问题，`OPTIONS`您应该编辑您的问题以包含它们；否则，这是预期的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-17T15:51:15.077

当我指定时，FWIW 我的也未能更新类型......

```
{'content-type':'application/json'} 
```

但是，如果我将情况更正为

```
{'Content-Type':'application/json'} 
```

... 有效。

去搞清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-17T13:46:17.303

如果您通过`Content-Type`请求`authorization`，它会将`POST`方法转换为`OPTIONS`方法，因此当我们使用**ouath**并传递**授权令牌**时，不需要时间`Content-Type`。

所以**不要传递** `Content-Type`所有`authorization`请求它不会改变你的`POST`方法`OPTIONS`

# php - 共享主机 + 静态 FFMPEG + PHP（或其他脚本语言）== 找不到编解码器失败

> ID：11378081
> 
> 赞同：1
> 
> 时间：2012-07-07T19:38:33.637
> 
> 标签：php, apache, ffmpeg, wordpress

这是以下环境：

1.  1and1 共​​享主机（他们没有安装 ffmpeg，都很好）
2.  我构建了一个不需要动态加载共享库的静态 ffmpeg 二进制文件（我在 Ubuntu 系统上构建了这个）
3.  ffmpeg 二进制文件是完全可访问的并且能够访问
4.  执行相同的命令终端或通过终端执行 php/perl 脚本工作正常......但是，通过浏览器/Web 请求的两个脚本都失败，并显示以下内容：

```
    为输出流 #0:0 打开编码器时出错 - 可能是不正确的参数，例如 bit_rate、rate、width 或 height

    大批
      0 => 字符串 'ffmpeg 版本 git-2012-07-06-6936111 版权所有 (c) 2000-2012 FFmpeg 开发人员' (长度=83)
      1 => 字符串 ' 使用 gcc 4.4.3 构建于 2012 年 7 月 5 日 23:04:34' （长度 = 46）
      2 => 字符串'配置：--prefix='~/ffmpeg'--enable-gpl --enable-libfaac --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libtheora --enable-libvorbis --enable-libvpx --enable-libx264 --enable-nonfree --enable-version3 --enable-static --disable-shared --extra-libs=-static --extra-cflags=-静态'（长度=323）
      3 => 字符串'libavutil 51.64.100 / 51.64.100'（长度=40）
      4 => 字符串'libavcodec 54.33.100 / 54.33.100'（长度=40）
      5 => 字符串'libavformat 54.15.100 / 54.15.100'（长度=40）
      6 => 字符串'libavdevice 54.1.100 / 54.1.100'（长度=40）
      7 => 字符串'libavfilter 3.0.101 / 3.0.101'（长度=40）
      8 => 字符串'libswscale 2.1.100 / 2.1.100'（长度=40）
      9 => 字符串'libswresample 0.15.100 / 0.15.100'（长度=40）
      10 => 字符串'libpostproc 52.0.100 / 52.0.100'（长度=40）
      11 => 字符串'输入#0，image2，来自'http://axiomchurch.co/main/wp-content/plugins/video-embed-thumbnail-generator/flash/skin/images/PlayNormal.png'：'（长度=136)
      12 => 字符串'持续时间：00:00:00.04，开始：0.000000，比特率：N/A'（长度=54）
      13 => string ' Stream #0:0: Video: png, rgba, 100x100, 25 tbr, 25 tbn, 25 tbc' (长度=66)
      14 => string '[graph 0 input from stream 0:0 @ 0x9482000] w:100 h:100 pixfmt:rgba tb:1/25 fr:25/1 sar:0/1 sws_param:flags=2' (length= 109)
      15 => 字符串'[输出流 0:0 @ 0x948ccc0] 未提供不透明字段'（长度=56）
      16 => 字符串'[自动插入缩放器 0 @ 0x948d160] w:100 h:100 fmt:rgba sar:0/1 -> w:100 h:100 fmt:yuvj420p sar:0/1 标志:0x4'（长度=111)
      17 => 字符串'[mjpeg @ 0x948c760] ff_frame_thread_encoder_init 失败'（长度=55）
      18 => 字符串'输出#0，image2，到'/homepages/17/d411786663/htdocs/main/wp-content/uploads/2012/07/ffmpeg_exists_test%d.jpg':'（长度=113）
      19 => string ' Stream #0:0: Video: mjpeg, yuvj420p, 100x100, q=2-31, 200 kb/s, 90k tbn, 25 tbc' (长度=83)
      20 => 字符串'流映射：'（长度=15）
      21 => 字符串'流#0:0 -> #0:0 (png -> mjpeg)' (长度=36)
      22 => string 'Error while opening encoder for output stream #0:0 - 可能参数不正确，例如 bit_rate、rate、width 或 height'（长度=119）

```

正在执行的命令：

```
 /kunden/homepages/17/.../htdocs/bin/ffmpeg -i http://....co/main/wp-content/plugins/video-embed-thumbnail-generator/flash/skin/images/PlayNormal.png -ac 2 /homepages/17/.../htdocs/main/wp-content/uploads/2012/07/ffmpeg_exists_test.jpg 
```

你可以看到我有我的 ffmpeg 二进制文件的完整路径并且它正在执行。这是通过终端成功的样子：

```
    ffmpeg 版本 git-2012-07-06-6936111 版权所有 (c) 2000-2012 FFmpeg 开发者
      使用 gcc 4.4.3 于 2012 年 7 月 5 日 23:04:34 构建
      配置： --prefix='~/ffmpeg' --enable-gpl --enable-libfaac --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libtheora --enable-libvorbis --enable-libvpx --enable-libx264 --enable-nonfree --enable-version3 --enable-static --disable-shared --extra-libs=-static --extra-cflags=-static
      libavutil 51\. 64.100 / 51\. 64.100
      libavcodec 54\. 33.100 / 54\. 33.100
      libavformat 54\. 15.100 / 54\. 15.100
      libav 设备 54\. 1.100 / 54\. 1.100
      libavfilter 3\. 0.101 / 3\. 0.101
      libswscale 2\. 1.100 / 2\. 1.100
      libswresample 0\. 15.100 / 0\. 15.100
      libpostproc 52\. 0.100 / 52\. 0.100
    输入 #0，image2，来自“http://axiomchurch.co/main/wp-content/plugins/video-embed-thumbnail-generator/flash/skin/images/PlayNormal.png”：
      持续时间：00:00:00.04，开始：0.000000，比特率：N/A
        流#0:0：视频：png、rgba、100x100、25 tbr、25 tbn、25 tbc
    [来自流 0:0 @ 0x9482000 的图 0 输入] w:100 h:100 pixfmt:rgba tb:1/25 fr:25/1 sar:0/1 sws_param:flags=2
    [输出流 0:0 @ 0x948ccc0] 未提供不透明字段
    [自动插入缩放器 0 @ 0x948d160] w:100 h:100 fmt:rgba sar:0/1 -> w:100 h:100 fmt:yuvj420p sar:0/1 标志:0x4
    输出#0，image2，到'/homepages/17/d411786663/htdocs/main/wp-content/uploads/2012/07/ffmpeg_exists_test.jpg'：
      元数据：
        编码器：Lavf54.15.100
        流 #0:0：视频：mjpeg、yuvj420p、100x100、q=2-31、200 kb/s、90k tbn、25 tbc
    流映射：
      流 #0:0 -> #0:0 (png -> mjpeg)
    按 [q] 停止，按 [?] 寻求帮助
    帧= 1 fps=0.0 q=0.0 Lsize= 0kB 时间=00:00:00.04 比特率= 0.0kbits/s    
    视频：2kB 音频：0kB 字幕：0 全局标题：0kB 复用开销 -100.000000%

```

在终端运行脚本的用户和 apache 用户是同一个用户......我已经验证了这一点。

关于 apache 正在运行的环境的某些事情正在杀死我……不幸的是，我无法访问 apache 错误日志。

作为旁注...我正在尝试将视频嵌入和缩略图生成器用于 wordpress。

任何帮助表示赞赏，谢谢！

# c - 浮点二进制表示的混淆

> ID：11378085
> 
> 赞同：4
> 
> 时间：2012-07-07T19:38:48.373
> 
> 标签：c, floating-point, number-formatting, ieee-754

我试图输出以下内容但感到困惑，

```
 float f=3.4;
    char *cp;
    cp=(char *)&f;
    printf("%d\n",*cp); 
```

我计算出的标准化数 IEEE 754 标准是，

```
0 10000000 10110011001100110011001 
```

这就是为什么我假设现在 cp 的价值有，

```
10011001 
```

转换为 2 的补码后，

```
01100111 
```

它应该输出 -103 ，但我在流血事件/DevC 中得到了 -102 。为什么这样的输出？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T19:46:53.647

那是因为`f`正在四舍五入：

```
3.4 = 10110011001100110011001 100110011001...  (repeating 1001) 
```

四舍五入：

```
3.4 = 10110011001100110011010
                            ^ 
```

当存储为单精度浮点数时。

现在，当您提取最后 8 位时，您实际上得到`10011010`的是`10011001`.

转换`10011010`->`-102`而不是`-103`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T19:46:26.843

我认为你计算错误：

```
Prelude> decodeFloat (3.4 :: Float)
(14260634,-22)
(0.03 secs, 2929112 bytes)
Prelude> Numeric.showHex (fst it) ""
"d9999a" 
```

尾数以`1010`.

# windows-7 - 手写识别windows 7

> ID：11378087
> 
> 赞同：2
> 
> 时间：2012-07-07T19:38:55.617
> 
> 标签：windows-7, handwriting

Windows 7 中的手写识别非常棒，我想知道我是否可以使用某种 API 来使用它。

如果没有，是否有其他选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T19:52:24.613

[MSDN 记录](http://msdn.microsoft.com/en-us/library/windows/desktop/ms702484%28v=vs.85%29.aspx)了用于“墨迹分析”的公开 API。他们可能为您工作：

> Ink Analysis 库有四个层：Windows 窗体、WPF、COM 和基础层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T19:54:00.500

事实上，Windows 7 中的手写工具是以前在 Microsoft Office 和 Windows XP 中可用的工具的扩展。

它们可供其他应用程序使用，但了解 Microsoft，您几乎可以肯定最终需要包括 Visual Studio 在内的完整 MS 工具集。

Drat - @reuben 击败了我并给出了适当的 MSDN 链接。

更新：如果您想寻找替代方案，我建议您访问 phatware.com - 他们在手写领域已经有很长时间了，并且有一些有趣的工具。

# javascript - 将 jquery ajax 请求设置为 async = false 不起作用

> ID：11378088
> 
> 赞同：4
> 
> 时间：2012-07-07T19:38:56.850
> 
> 标签：javascript, ajax, jquery

我正在尝试开始使用谷歌钱包并通过 ajax 请求生成 jwt 令牌。

当用户点击购买按钮时，它会触发 purchase() 函数，该函数又会发送一些数据以使用 get_jwt_token_for_user() 函数获取 jwt。我已将 ajax 请求设置为非异步，以确保将 jwt 发送到谷歌支付处理程序。

但是，在 get_jwt_token_for_user() 函数返回 jwt 之前，purchase() 函数似乎会继续。日志输出显示数字 1 和 2 在 jwt 从 get_jwt_token_for_user() 函数打印到控制台之前打印到控制台。

```
function get_jwt_token_for_user(the_key)
{
    var JwtTokenURL = "/get_jwt_token";
    var the_user_name = $('#user_name').val();
    var the_user_email = $('#user_email').val();
    var the_user_number = $('#user_number').val();
    $.ajax({ 
        type: "Get",
        url: JwtTokenURL,
        data: {user_number : the_user_number, user_name : the_user_name, user_email : the_user_email, the_d_key : the_key},
        async: false,
        success: function(result) {
            var myObject = JSON.parse(result);
            console.log(myObject.jwt_token);
            return myObject.jwt_token
        },
        failure: function(fail){ alert(fail); }
     });
}

function purchase(the_key)
{
    console.log("1");
    var jwt_token = get_jwt_token_for_user(the_key);
    console.log("2");
    if (jwt_token !== "")
    {
        console.log(jwt_token);
        goog.payments.inapp.buy({
            parameters: {},
            'jwt'     : jwt_token,
            'success' : successHandler,
            'failure' : failureHandler
          });
    }
} 
```

知道我能做些什么来确保在 purchase() 函数在没有 jwt 值的情况下继续执行之前，ajax 请求已经返回数据吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T20:10:29.080

你的`get_jwt_token_for_user`函数不返回任何东西，你需要更多这样的东西：

```
function get_jwt_token_for_user(the_key) {
    //...
    var myObject;
    $.ajax({ 
        //...
        success: function(result) {
            myObject = JSON.parse(result);
        },
        //...
     });
     return myObject ? myObject.jwt_token : '';
} 
```

从`success`回调中返回某些内容不会导致该值被返回，`$.ajax`并且 JavaScript 函数**不会**返回其最后一个表达式的值，如果您希望函数返回某些内容，则**必须**包含显式。`return`

`async:false`你也应该尽快停止使用，它对用户很不利，而且[它正在消失](http://bugs.jquery.com/ticket/11013)。您的代码应该看起来更像这样：

```
function get_jwt_token_for_user(the_key, callback) {
    //...
    $.ajax({ 
        type: "Get",
        url: JwtTokenURL,
        data: {user_number : the_user_number, user_name : the_user_name, user_email : the_user_email, the_d_key : the_key},
        success: function(result) {
            var myObject = JSON.parse(result);
            callback(myObject.jwt_token);
        },
        failure: function(fail){ alert(fail); }
     });
}

function purchase(the_key) {
    get_jwt_token_for_user(the_key, function(jwt_token) {
        if (jwt_token !== "") {
            //...
        }
    });
} 
```

# java - Android 内容提供者修改/创建日期

> ID：11378091
> 
> 赞同：1
> 
> 时间：2012-07-07T19:39:28.310
> 
> 标签：java, android, database, android-contentprovider, android-cursor

例如：如果我正在访问 SMS 数据库，则消息时间戳有一个“日期”字段。但是，假设我将具有较旧时间戳的消息加载到数据库中，我怎么知道它们是在后来的时间戳消息*之后添加的？*是否有我可以访问的表格行的修改或创建日期？

编辑和澄清：

SMS 表具有以下列：long_id、thread_id、address、person、date、protocol、read、status、type、reply_path_present、subject、body、service_center、locked、error_code 和 seen。

“日期”是指消息发送的日期，而不是消息添加到数据库的日期。Android 数据库 (SQLite) 是否会跟踪在数据库中添加或修改数据的时间？如果是这样，我该如何访问它？如果没有，只需添加/删除/更新数据而不记录，这也是一个答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-06T19:33:47.183

您可以通过创建一个包含当前日期和时间的列来解决此问题（当前表示当前，该行已插入）：

```
create table mytable(_id int primary key, date datetime default current_timestamp); 
```

这将在每一行中产生一个指向插入时刻的时间戳

另一种解决方案是简单地将当前时间戳从 SQLiteOpenHelper 中插入，例如：

```
ContentValues values = new ContentValues(2);
values.put(COLUMN_NAME_ID, id);
values.put(COLUMN_NAME_TITLE, title);
values.put(COLUMN_NAME_CREATED_DATE, System.currentTimeMillis());

dbHelper.getWritableDatabase().insert(TABLE_NAME, null, values); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:49:05.380

sqlite 中没有插入或更新行的日期。

# c# - 未定义的布局资源错误，但资源确实存在

> ID：11378093
> 
> 赞同：3
> 
> 时间：2012-07-07T19:39:46.880
> 
> 标签：c#, android, monodevelop, xamarin.android, xamarin

我正在关注本教程：[http ://docs.xamarin.com/android/tutorials/User_Interface/list_view](http://docs.xamarin.com/android/tutorials/User_Interface/list_view)

我有`list_item.xml`下`HelloListView/Resources/layout/`

我将 XML 文件作为以下参数引用：

```
protected override void OnCreate (Bundle bundle)
{
    base.OnCreate (bundle);
    ListAdapter = new ArrayAdapter<string> (this, Resource.Layout.list_item, countries);
    // ...
} 
```

**构建错误**

> “HelloListView.Resource.Layout”不包含“list_item”的定义

我逐字按照教程中的几个步骤进行操作。我在这里想念什么？

**此外**

如果我`Resources/layout/`通过右键单击`layout/`并`Add`输入 XML 文件来添加文件，它将不允许我编辑源代码——例如，我单击“源代码”选项卡，没有光标，我无法在窗口中输入。

如果我将文件添加到解决方案中，然后根据需要对 XML 文件进行更改，然后将文件移动到`Resources/layout/`，这仍然不起作用（正如@CheeseBaron 提到的，它没有添加到`Resource.Designer.cs`）

**快速解决**

通过右键单击添加 XML 后`layout/`，面对上述问题，我在MonoDevelop*之外*编辑了文件（使用 Notepad++），这触发了`Resource.Designer.cs`使用生成的 ID 重新加载`list_item`. 绝对不理想。

# php - PHP 图像上传链接到 MySQL

> ID：11378095
> 
> 赞同：0
> 
> 时间：2012-07-07T19:39:59.617
> 
> 标签：php, mysql, image, upload

我编写了一个脚本来使用 PHP 将图像上传到一个文件夹，该文件夹应该将文件名链接到 MySQL。

我想在漫长的一天之后我错过了一些我看不到的东西:(

上传.php

```
<form enctype="multipart/form-data" action="add.php" method="POST">
 Photo: <input type="file" name="images"><br> 
 <input type="submit" value="Add"> 
 </form> 
```

添加.php

```
 <?php 
 error_reporting(E_ALL);
 //This is the directory where images will be saved 
 $target = "images/"; 
 $target = $target . basename( $_FILES['images']); 

 //This gets all the other information from the form 
 $images=($_FILES['images']); 

 // Connects to your Database 
 mysql_connect("localhost", "root", "pass") or die(mysql_error()) ; 
 mysql_select_db("formular") or die(mysql_error()) ; 

 //Writes the information to the database 
 mysql_query("INSERT INTO `employees` VALUES ('$images')") ; 

 //Writes the pictures to the server 
 if(move_uploaded_file($_FILES['images']['tmp_name'], $target)) 
 { 

 //Tells you if its all ok 
 echo "The file ". basename( $_FILES['uploadedfile']). " has been uploaded, and your information has been added to the directory"; 
 } 
 else { 

 //Gives and error if its not 
 echo "Sorry, there was a problem uploading your file."; 
 } 
 ?> 
```

视图.php

```
 <?php 
 // Connects to your Database 
 mysql_connect("localhost", "root", "pass") or die(mysql_error()) ; 
 mysql_select_db("formular") or die(mysql_error()) ; 

 //Retrieves data from MySQL 
 $data = mysql_query("SELECT * FROM employees") or die(mysql_error()); 
 //Puts it into an array 
 while($info = mysql_fetch_array( $data )) 
 { 

 //Outputs the image and other data
 Echo "<img src=images/".$info['images'] ."> <br>";
 }
 ?> 
```

完全感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T19:53:17.280

这一行：

```
mysql_query("INSERT INTO `employees` VALUES ('$images')"); 
```

可能没有按照您的预期进行。`Array`我相信您会看到表格中每一行插入的单词。您将需要插入所需的数组的每个特定部分，例如：

```
INSERT INTO `employees` VALUES('{$images['name']}'); 
```

`employees`该表包含多少列？如果它有多个，则查询可能会失败，并显示无效的列计数消息。将该查询的结果分配给一个变量并检查它是否有错误（`$res = mysql_query(...); if (!$res) die(mysql_error());`

从那里开始，希望有帮助。随时要求进一步澄清或问题。

# arrays - 将数组从 HLSL 顶点着色器传递到像素着色器

> ID：11378097
> 
> 赞同：1
> 
> 时间：2012-07-07T19:40:18.077
> 
> 标签：arrays, parameter-passing, hlsl

我有一堆从顶点着色器输出的参数，我想将它们传递给像素着色器。

执行此操作的正常方法是声明一个输出结构

```
struct vOut
{
    float4 param0 : TEXCOORD0 ;
    float4 param1 : TEXCOORD1 ;
} ; 
```

所以你必须编写一个单独的变量并将每个变量放在一个纹理坐标中。

有没有办法声明一个 16 * float4 的数组，并让它们占据`TEXCOORD0 -> TEXCOORD15`而不必写出这样的顶点声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T21:32:06.160

像这样声明它：

```
struct VertexOutput_Test
{
  float4 hPosition    : POSITION;
  float4 vArr[5]     : TEXCOORD0;
}; 
```

并在顶点和像素着色器中正常处理它，例如这个虚拟代码：

```
VertexOutput_Test VS_Test(VertexInput_1UV IN) 
{
  VertexOutput_Test OUT = (VertexOutput_Test)0;
  float4 Po = float4(IN.position.xyz,1.0);
  float3 No = IN.normal.xyz;
  OUT.hPosition = mul(Po,worldViewProj);
  OUT.vArr[0] = float4(1,0,0,0);
  OUT.vArr[1] = float4(1,1,0,0);
  OUT.vArr[2] = float4(1,0,1,0);
  OUT.vArr[3] = float4(1,0,0,1);
  OUT.vArr[4] = float4(1,1,1,1);
  return OUT;
} 
```

如果您查看 fxc 输出，您会发现它按顺序很好地排列它们

# php - 是否有任何技巧可以避免在查询字符串中对 url 进行 urlencode

> ID：11378100
> 
> 赞同：0
> 
> 时间：2012-07-07T19:40:51.497
> 
> 标签：php, query-string, urlencode

我正在尝试为需要能够接受查询字符串中的网址而不首先对其进行urlencoded 的客户端编写一个脚本。一个例子是这样的：

[http://foo.com/script.php?url=www.amazon.co.uk/ESET-Smart-Security-User-Year/dp/B005NPFOBM/ref=sr_1_1?s=software&ie=UTF8&qid=1341685530&sr=1- 1](http://foo.com/script.php?url=www.amazon.co.uk/ESET-Smart-Security-User-Year/dp/B005NPFOBM/ref=sr_1_1?s=software&ie=UTF8&qid=1341685530&sr=1-1)

但是，当我回显 $_GET['url'] 的内容时，它给了我以下信息：

www.amazon.co.uk/ESET-Smart-Security-User-Year/dp/B005NPFOBM/ref=sr_1_1?s=software

所以基本上它似乎在第一个＆符号上窒息 - 我猜是因为它认为它是另一个变量。

除了表单 urlencoding，还有什么技巧可以让它工作吗？我可能可以从表单中发布它，但这违背了脚本的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:00:54.570

对于这个特定的用例，您应该`$_SERVER['QUERY_STRING']`改用。这将一次性为您提供完整的查询字符串，然后您可以自己拆分它。

在您的示例中，PHP 假设 & 是下一个 GET 变量的分隔符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T19:56:54.370

您可以询问查询参数，并将它们添加到您收到的 URL。以正确的顺序列出 $_GET 中的剩余参数，并将它们添加到 $_GET['url'] 的末尾。

```
$_GET['url']
 + '&ie=' + $_GET['ie']
 + '&qid=' + $_GET['qid']
 + '&sr=' + $_GET['sr'] 
```

请注意，有一天您可能会得到一个额外的参数 url。 [http://foo.com/script.php?url=www.amazon.co.uk/ESET-Smart-Security-User-Year/dp/B005NPFOBM/ref=sr_1_1?s=software&ie=UTF8&qid=1341685530&sr=1- 1&url=http://someAmazoneStuff](http://foo.com/script.php?url=www.amazon.co.uk/ESET-Smart-Security-User-Year/dp/B005NPFOBM/ref=sr_1_1?s=software&ie=UTF8&qid=1341685530&sr=1-1&url=http://someAmazoneStuff)

# php - 直接来自 C/C++ 语言的 PHP 响应

> ID：11378104
> 
> 赞同：1
> 
> 时间：2012-07-07T19:41:58.533
> 
> 标签：php, c++, exchange-server, mixed-mode

我正在寻找一种有效的方式来响应 http 请求。当收到http请求时（apache/php webserver环境），我想知道是否可以在c++库方法中获取对php响应实例的引用，并将输出数据直接写入C++上下文中的响应实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:24:42.747

通常，您只需通过**[mod_fastcgi](http://www.fastcgi.com/devkit/doc/fcgi-devel-kit.htm)**将请求重定向到您的外部 C/C++ 程序，在您的程序中完全处理它并将响应写入客户端。

如果不可能，您可以通过从 Apache 作为**[服务器端包含](http://httpd.apache.org/docs/2.2/howto/ssi.html)**(SSI) 访问您的程序，将程序输出包含到生成的网页中。

从 PHP 中，您还可以对外部程序[执行系统调用](http://www.php.net/manual/en/function.shell-exec.php)并处理返回的输出，如链接所示。

**[fastcgi 文档](http://www.fastcgi.com/devkit/doc/fcgi-devel-kit.htm#S3.1)**中提供了一些简单的 C 示例。

用 C/C++（[这里](http://blog.slickedit.com/2007/09/creating-a-php-5-extension-with-visual-c-2005/)和[那里](http://php.webtutor.pl/en/2011/07/07/how-to-create-php-extensions-in-c-part-i-adding-simple-function/)）编写 PHP 扩展并在 Apache 中（通过 mod_php）使其工作是可能的，但被认为是*火箭科学*，因此不鼓励 ;-)

# mercurial - 同步 Mercurial 存储库的集合

> ID：11378106
> 
> 赞同：3
> 
> 时间：2012-07-07T19:42:00.177
> 
> 标签：mercurial, synchronization

我在网络共享上有一组 Mercurial 存储库。要启用离线工作，我需要在我的笔记本电脑上保存此集合的本地副本，以及在我在线时同步两者的简单方法。

为此，我编写了一个快速脚本，该脚本自动将每个本地存储库与相应的远程存储库（推送和拉取）同步，但它缺少一些理想的功能：

*   将新存储库从本地自动克隆到远程集合（反之亦然）
*   能够组织（移动/重命名）本地存储库并将更改也应用到远程端，下次我同步时
*   同步的能力`hg strip`和其他重写存储库历史的命令
*   `hgwebdir`与集合甚至 Bitbucket同步的能力

是否有任何现有的解决方案可以提供部分（或全部）这些功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T12:35:21.597

据我所知，这样的事情是不存在的。在存储库之间来回移动变更集的最安全方法始终是`hg push`，`hg pull`并且这些命令都不会在多个源或目标存储库上运行。

出于备份目的，我以前做过这样的事情：

```
for thedir in $(find . -type d -name .hg) ; do
   repopath=$(dirname $thedir)
   hg push $repopath ssh://mybackupserver//path/to/backups/$(basename $repopath)
done 
```

它将所有本地存储库推送到异地备份。从理论上讲，您可以同时执行 push 和 pull 以及必要时的初始化/克隆，但是您很快就会开始遇到边缘 ccase。

# html - iOS中按钮内的奇怪文本样式

> ID：11378108
> 
> 赞同：1
> 
> 时间：2012-07-07T19:42:03.853
> 
> 标签：html, css

在 Windows/Mac/Android 或任何操作系统中查看我的网站时，我的网站会按照我的意愿显示。但在 iOS 中（在 iPhone、iPod Touch、iPad 等上）它会使按钮内的文本看起来很奇怪。

![][1]

在这里，您可以看到问题发生在 iPad 上。带有“男”的按钮显示正确，但“女”按钮显示错误。（女性性别标志在顶部）

这是两个按钮的代码：

```
<button class="choose">&#9794; Male</button>
<button class="choose">&#9792; Female</button> 
```

CSS 代码：

```
// body code for the whole document:
body{
    font-size:14px;
    font-family:"Lucida Grande", "Lucida Sans Unicode" Tahoma, Verdana, Arial, sans-serif;
    -webkit-font-smoothing:subpixel-antialiased;
    text-align:center;
    margin:0px;
    padding:0px;
}

// code just for the two buttons:
    .choose{
        font-size:15px;
        height:40px;
        width:100px;
    } 
```

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:43:58.330

将按钮样式更改为`.choose{ font-size:15px; height:40px; width:120px; }`. 您没有为“女性”一词提供足够的空间以与符号位于同一行，因此它会下降以尝试适合按钮而不会流失。增加按钮的宽度应该可以解决这个问题。

如果不是这样，我就迷路了。它在您的网站上运行良好，但可能是更改 iOS 的字体会导致问题——它可能会稍大一些，因此不合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:07:55.610

您是否尝试过使用不间断的空间？

```
<button class="choose">&#9794;&nbsp;Male</button> 
```

# objective-c - 对于跨行拆分的方法名称，Xcode 不会自动缩进冒号

> ID：11378109
> 
> 赞同：0
> 
> 时间：2012-07-07T19:42:29.463
> 
> 标签：objective-c, xcode, code-formatting, auto-indent

我希望 Xcode 在我输入冒号时自动缩进我的方法，但事实并非如此。我有自动缩进：“：”打开。我怎样才能让它工作？

例子：

*   类型`- (id)initWithName:(NSString *)name`
*   按回车
*   类型`value:(int)aValue`
*   按回车
*   类型`number:(int)aNumber;`
*   按回车

这就是我得到的

```
- (id)initWithName:(NSString *)name
value:(int)aValue
            number:(int)aNumber; 
```

为什么第二行不缩进？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:59:57.870

我不确定“为什么”是否真的可以回答。确保`Return`有时似乎不会触发自动缩进很烦人。

不过，有一个解决方法：在移动到下一行之前，您可以键入一个分号。这会触发缩进，然后您可以删除它并点击`Return`.

如果您先在一行上键入方法名称，然后返回并插入换行符，它也会正确缩进。

当然，这些都不是特别好的选择。

# mysql - 如何编写一个 SQL 查询，根据不同优先级的条件分配有限数量的位置

> ID：11378112
> 
> 赞同：0
> 
> 时间：2012-07-07T19:43:37.870
> 
> 标签：mysql, sql

我创建了一个页面，我可以在其中查看学生对宿舍的申请。您可以在以下位置进行预览：http: [//formularz.funpic.de/dormitory.htm](http://formularz.funpic.de/dormitory.htm)。我正在寻求帮助编写查询以获取页面上显示的信息。房间应该先给贫困学生，然后再给远离宿舍的学生。我有 3 个宿舍：“lubel”、“mleczko”、“maryks”

我当前的数据库查询如下所示：

```
SELECT * 
  FROM aplication 
  WHERE (sex='w' AND preference1='lubel') 
  GROUP BY poor DESC, distance DESC 
UNION ALL SELECT * 
  FROM aplication 
  WHERE (sex='w' AND preference2='lubel' AND poor='') 
  GROUP BY distance DESC  
UNION ALL SELECT * 
  FROM aplication 
  WHERE (sex='w' AND preference3='lubel' AND poor='') 
  GROUP BY distance DESC 
```

我想为此查询添加限制：

*   用于润滑油：12 处
*   为mleczko：13个地方
*   玛丽克斯：5个地方

如何编写查询以获得这样的结果？我知道我可以`LIMIT`用来限制结果的数量，但是有什么方法可以确保结果没有冗余？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:51:09.370

您可以通过将它们`(preference1, preference2, preference3)`分成单独的表来使这变得非常容易——我们称之为“规范化”。

如果可能，您应该创建类似以下的表：

```
CREATE TABLE application (application_id ... PRIMARY KEY, sex ..., poor ...);
CREATE TABLE preference (application_id ..., dorm ..., rank ...); 
```

现在，对于每个表格，您将在表格`application`中拥有三行：一行与，一行与，另一行与。`preference``rank = 1``rank = 2``rank = 3`

您可能无法永久更改结构，在这种情况下，您可以使用 临时做同样的事情`TEMPORARY TABLE`：

```
CREATE TEMPORARY TABLE preference (...)
INSERT INTO preference (SELECT application_id, preference1, 1 FROM application);
INSERT INTO preference (SELECT application_id, preference2, 2 FROM application);
INSERT INTO preference (SELECT application_id, preference3, 3 FROM application); 
```

有了这些，查询就很简单了：

```
SELECT application.*
FROM application
INNER JOIN preference ON (preference.application_id = application.application_id)
WHERE sex = 'w' AND dorm='lubel' AND poor=''
ORDER BY rank, poor DESC, distance DESC
LIMIT 12 
```

但你要求的远不止这些：实际上一次对每个人进行分类。

为此，我建议添加一个新`assignment`列（如果需要，这可以临时完成），因此您可以使用一系列四个查询：

```
UPDATE application SET assignment = NULL

UPDATE application.*
INNER JOIN preference ON (preference.application_id = application.application_id)
SET assignment = 'lubel'
WHERE assignment IS NULL AND sex = 'w' AND dorm='lubel' AND poor=''
ORDER BY rank, poor DESC, distance DESC
LIMIT 12

UPDATE application.*
INNER JOIN preference ON (preference.application_id = application.application_id)
SET assignment = 'mleczko'
WHERE assignment IS NULL AND sex = 'w' AND dorm='mleczko' AND poor=''
ORDER BY rank, poor DESC, distance DESC
LIMIT 13

UPDATE application.*
INNER JOIN preference ON (preference.application_id = application.application_id)
SET assignment = 'maryks'
WHERE assignment IS NULL AND sex = 'w' AND dorm='maryks' AND poor=''
ORDER BY rank, poor DESC, distance DESC
LIMIT 5 
```

请注意，每次您只找到尚未分配任务的人时，因此一旦有人得到他们的选择，分配列就会被填充，并且他们不会匹配任何未来的查询。

我假设任何人都可以获得任何宿舍（即，每个人都偏好所有三个宿舍；这只是这些偏好的顺序问题）。

# jsf-2 - 在 JSF2.0 中禁用按钮回发

> ID：11378113
> 
> 赞同：0
> 
> 时间：2012-07-07T19:43:38.373
> 
> 标签：jsf-2

我的JSF页面如下

```
 <h:head>
        <title>Ajax Test</title>
    <h:outputScript name="giveEffect.js" library="jquery"/>
    <h:outputScript name="jquery.js" library="jquery"/>
</h:head>
<h:body>
    <div id="div1">
        <h:button id="b1" onclick=" button1Click(this)" value="#{kp.firstname}"/>
    <h:button id="b2" onclick="button1Click(this)" value="#{kp.home}"/>
    </div>
</h:body>
</html> 
```

button1Click 是一个 jquery 函数，它执行 ajax 调用并更新我的页面。但是看不到ajax更新。由于回发/jsf 生命周期调用，我的更改正在丢失。

使用 firebug 检查 Dom。我找到了以下代码。

```
<div id="div1">
<input id="b1" type="button" value="Kar" onclick="button1Click(this); window.location.href='/AJAXTest/faces/index.xhtml'; return false;">
<input id="b2" type="button" value="Alike" onclick="button1Click(this); window.location.href='/AJAXTest/faces/index.xhtml'; return false;">
 </div> 
```

假设我使用萤火虫消除了 window.location.href='/AJAXTest/faces/index.xhtml' 我得到了预期的输出。

是否有任何标签或机制来删除回发调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:55:44.910

按钮组件的结果属性用于确定由 onclick 激活的目标 URL。整个目标 URL 字符串将作为“window.location.href = ''”写入按钮的 onclick 属性。如果您有自定义 onclick 方法，则 window.location.href 将附加在脚本的末尾。由于您没有提及结果，它将导致对您当前视图的 GET 请求。

您可以改为使用 `<h:commandButton>`并提及 type="button" ，如下所示：

```
<h:commandButton id="b1" onclick=" button1Click(this)" value="#{kp.firstname} "type="button"> 
```

[文档](http://javaserverfaces.java.net/nonav/docs/2.0/pdldocs/facelets/h/button.html)

# sed - 正则表达式更改 sed 命令+特殊字符？

> ID：11378123
> 
> 赞同：0
> 
> 时间：2012-07-07T19:44:37.160
> 
> 标签：sed, cmd

我在 Windows Xp 上使用 CMD 用 Sed 替换特殊文本。我正在使用此命令替换特殊字符，例如`$ or *`：

```
sed -i "s/\*/123/g;" 1.txt 
```

上一个命令不起作用，因为我有sed 用于制作正则表达式的其他特殊字符串`\`。`"`转义字符`^`不能很好地工作，因为 sed no 给我错误但文件内部没有任何变化。

要更改此文本，`"{\*)(//123/$$`我尝试使用此命令：
`sed -i "s£"^"{^\^*)(//123/^$^$"£xx£g;" 1.txt`

`£`是分隔符，`xx`是新文本..但没有任何变化

我想如何转换这样的文本？
`sed -i^/\\*$/$[{" ;" 1.txt`进入`xx`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:57:39.207

这可能对您有用：

```
echo '"{\*)(//123/$$' | sed "s/[\"][{][\\][*][)][(][/][/]123[/][$][$]/xx/"
xx 
```

# dotnetnuke - DotNetNuke v6 和 Xmod Pro 中的简单搜索、发布和结果页面

> ID：11378125
> 
> 赞同：0
> 
> 时间：2012-07-07T19:44:58.140
> 
> 标签：dotnetnuke

我正在努力使用 Xmod Pro 4.x。我需要做的就是创建一个简单的表单，将 3 个文本字段作为参数传递到第二个页面，其中包含一个尝试接收参数的 xmod 模板。表单是通过 xmod 设计器自动构建的，模板显然是自定义的。

当我尝试发布到页面（将 POST 重定向到“搜索结果”页面）时，xmod 模板会引发此错误：

消息：必须声明标量变量“@Part”。

这是我的 ListDataSource 片段：

```
<ListDataSource CommandText="SELECT [Id], 
[PartNumber] 
,[Manufacturer] 
,[Condition] 
,[Description] 
,[Location] 
,[Quantity] 
, 
(CASE WHEN 
(SELECT TOP 1 ThumbnailUrl FROM PKT_PartImage pi WHERE pi.PartNumber = p.PartNumber)     
IS NULL THEN 
'no-photo.png' ELSE 
(SELECT TOP 1 ThumbnailUrl FROM PKT_PartImage pi WHERE pi.PartNumber = p.PartNumber) 
END) AS ThumbnailUrl 
, 
(CASE WHEN 
(SELECT TOP 1 ThumbnailUrl FROM PKT_PartImage pi WHERE pi.PartNumber = p.PartNumber)     IS NULL THEN 
'_default' ELSE 
[PartNumber] END) AS ThumbnailPath 
FROM [PKT_Part] p WHERE [PartNumber] LIKE '%' + @Part + '%' OR [Manufacturer] LIKE '%'     + @Mfr + '%' 
OR [PartNumber] LIKE '%' + @Key + '%' OR [Manufacturer] LIKE '%' + @Key + '%' OR     [Condition] LIKE '%' + @Key + '%' 
OR [Description] LIKE '%' + @Key + '%' OR [Location] LIKE '%' + @Key + '%'"> 
<Parameter Name="Part" Value="[[Url:part]]" /> 
<Parameter Name="Mfr" Value="[[Url:mfr]]" /> 
<Parameter Name="Key" Value="[[Url:key]]" /> 
</ListDataSource> 
```

基本上，我收到错误消息，说它不知道如何处理传递的参数。我正在使用的搜索表单是由 xmod pro 自动生成的，并且正在对结果页面进行“重定向 POST”，这就是相应的 xmod pro 模块引发错误的地方。

您可以在此处查看小型搜索表单 (http://pickett.clients.solid-code.com/Home.aspx)，它转到的结果页面会引发错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T15:30:11.890

您需要使用重定向`method="get"`而不是`POST`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-20T16:59:02.123

尝试将值参数周围的引号更改为单引号而不是双引号。

# javascript - jqplot js 破坏了我的 jquery

> ID：11378127
> 
> 赞同：1
> 
> 时间：2012-07-07T19:45:15.030
> 
> 标签：javascript, jquery, jqplot

我正在使用[jqplot](http://www.jqplot.com/deploy/dist/examples/smoothedLine.html)来制作一些图表，它们工作正常，但我正在尝试使用“平滑”属性来平滑线条，但是当我添加 js 文件时，我的 jquery 会中断。我不知道为什么。我在 FF 上运行它，firebug 似乎没有向我显示任何错误。

这些是我用来绘制图形的 js 文件（工作正常）

```
 <script type="text/javascript" src="/miloWeb/js/jqplot/jquery.jqplot.min.js"></script>
    <script type="text/javascript" src="/miloWeb/js/jqplot/jqplot.dateAxisRenderer.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/miloWeb/css/jqplot/jquery.jqplot.css" media="screen" /> 
```

但是后来我添加了这些，jquery会中断。

```
<script type="text/javascript" src="/miloWeb/js/jqplot/jquery.min.js"></script>
    <script type="text/javascript" src="/miloWeb/js/jqplot/plugins/jqplot.highlighter.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/miloWeb/css/jqplot/jquery.jqplot.min.css" /> 
```

我构建图表的方式是这样的：

```
$( "#chartPointsBmi" ).dialog( "open" );
                  var plot2 = $.jqplot('bmiChartDiv', coordinates, {
                       title:'BMI/Time Graph',
                      gridPadding:{right:35},
                      axes:{
                        xaxis:{
                          renderer:$.jqplot.DateAxisRenderer,
                          tickOptions:{formatString:'%b %#d, %y'},
                         // min:'May 01, 2011',
                          tickInterval:'1 year'
                        },
                        yaxis:{  
                          min:0,
                          max:40,
                          tickInterval:'5'
                        }
                      },
                      series:[{lineWidth:5, rendererOptions: {smooth: true}, markerOptions:{style:'filledCircle'}}]
                  }); 
```

关于他们为什么不一起玩的任何想法？谢谢！

～喵喵

**编辑：**

这是呈现的html

```
 <link rel="stylesheet" type="text/css" href="/miloWeb/css/redmond/jquery-ui-1.8.11.custom.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/miloWeb/css/style.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/miloWeb/css/view.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="/miloWeb/css/ezmark.css" media="screen" />

    <!--[if IE]>
        <style type="text/css"> 
            /* place css fixes for all versions of IE in this conditional comment */
            .milo #content { zoom: 1; }
            /* the above proprietary zoom property gives IE the hasLayout it may need to avoid several bugs */
        </style>
    <![endif]-->

    <script type="text/javascript" src="/miloWeb/js/jquery.ezmark.js"></script>
    <script type="text/javascript" src="/miloWeb/js/jquery.maskedinput.js"></script>
    <script type="text/javascript" src="/miloWeb/js/random.js"></script>
    <script type="text/javascript" src="/miloWeb/js/jquery-ui-1.8.11.custom.min.js"></script>
    <script type="text/javascript" src="/miloWeb/js/jquery.maxlength-min.js"></script>  

    <script type="text/javascript">
        $(document).ready(function(){
            $(".button").button();
        });

        function loading(){
            $( "#loadingPopUp" ).dialog( "open" );
            return false;
        }

        function unloading(){
            $( "#loadingPopUp" ).dialog( "close" );
            return false;
        }
    </script>
    <!--[if lt IE 9]><script language="javascript" type="text/javascript" src="/miloWeb/js/jqplot/excanvas.js"></script><![endif]-->
    <script type="text/javascript" src="/miloWeb/js/jqplot/jquery.jqplot.min.js"></script>

    <script type="text/javascript" src="/miloWeb/js/jqplot/jquery.min.js"></script>
    <script type="text/javascript" src="/miloWeb/js/jqplot/plugins/jqplot.highlighter.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/miloWeb/css/jqplot/jquery.jqplot.min.css" /> 

    <script language="javascript"> 
```

# c# - 在 WPF 中运行时更改位图颜色

> ID：11378130
> 
> 赞同：0
> 
> 时间：2012-07-07T19:45:58.000
> 
> 标签：c#, wpf, silverlight, xaml, bitmap

我在 WPF 中开发。我有一个黑色位图，我想在运行时将颜色更改为白色！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:49:52.310

如果你使用[WriteableBitmapExtensions](http://writeablebitmapex.codeplex.com/)就很简单了。

```
using WriteableBitmapEx;

...

myBitmap.Clear(System.Windows.Media.Colors.White); 
```

# javascript - 将 DJango 列表的数据传递到 javascript 列表时出错

> ID：11378136
> 
> 赞同：2
> 
> 时间：2012-07-07T19:46:45.817
> 
> 标签：javascript, python, django, django-templates, python-2.7

我有一个 python-Django 列表：

```
list_a = ['user_a', 'user_b'] 
```

现在我使用以下代码将其渲染为模板：

```
extra_context = {
    'a': list_a
}
return direct_to_template(request, 'mytemplate.html', extra_context) 
```

在我的模板中，我编写了以下 java 脚本代码来将 `list_a`Django-list 传递给 Js-list：

```
var user = [{% for i in user_list %}{{ i }}{% if forloop.last %}{%else%},{%endif%}{% endfor %}]; 
```

但是当我打开模板时。它显示以下错误（使用 Inspect 元素检查）：

```
Uncaught ReferenceError : user_a is not defined 
```

我尝试使用 打印`user`驻留在 javascript 中的变量`Inspect Element`。它打印正确的值，即

var user = [user_a, user_b]

我无法理解为什么会这样:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:43:56.930

我认为我发现了错误：

```
Update `var user = [{% for i in user_list %}{{ i }}{% if forloop.last %}{%else%},{%endif%}{% endfor %}]; 
```

到

```
var user = [{% for i in user_list %}"{{ i }}"{% if forloop.last %}{%else%},{%endif%}{% endfor %}];` 
```

正在给我正确的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T00:03:29.893

在您的模板中，您可以使用

```
var user = {{user_list|safe}}; 
```

使用此模板代码，python 列表定义为

```
user_list = ['te"s\'t1', 'test2']; 
```

查看javascript源时给出以下结果

```
var user = ['te"s\'t1', 'test2']; 
```

而你原来的解决方案会给

```
var user = ["te&quot;s&#39;t1","test2"]; 
```

您使用哪一个实际上取决于您打算对用户名做什么。无论您是否在模板中使用“安全”，您的模板中的 for 和 if 语句似乎有点过度工作。

# javascript - Javascript 号码放置和如何，4 = 1.04, 14 = 1.14, 100 = 2.00

> ID：11378140
> 
> 赞同：-1
> 
> 时间：2012-07-07T19:47:05.550
> 
> 标签：javascript, html, math, numbers

> **可能重复：**
> [Javascript 号码放置和如何，4 = 0.04, 14 = 0.14, 100 = 1.00](https://stackoverflow.com/questions/11377918/javascript-number-placing-and-how-to-4-0-04-14-0-14-100-1-00)

我正在尝试编写一个自定义计算器，但我无法计算出一个数字，我希望能够在输入的数字之前添加小数点。

例如，如果用户输入 4，我希望字符串中的值看起来像 1.04，依此类推 14 = 1.14, 100 = 2.00。

我尝试使用内置函数 var num = 4; fig = num.toFixed(2);

但这不起作用，我能想到的唯一方法是使用 if(val.length >2){ do something; } 这将是一个很长的路要走。有没有人对此有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:51:09.777

这与您之前的问题非常相似：[Javascript number placement and how to , 4 = 0.04, 14 = 0.14, 100 = 1.00](https://stackoverflow.com/questions/11377918/javascript-number-placing-and-how-to-4-0-04-14-0-14-100-1-00)

假设您的用户输入了一个您分配给 variable 的数字`num`。结果由下式给出

```
var result = 1 + (num / 100) 
```

您也可以在上一个问题的任何答案给出的结果上加 1。

# database - 三向关系的实体关系图

> ID：11378142
> 
> 赞同：3
> 
> 时间：2012-07-07T19:48:03.333
> 
> 标签：database, er-diagram

我想在以下人为情况下为三向关系创建实体关系图：

每个公司都有许多部门。一个员工可以同时为多个部门工作。但是，一名员工只能为公司的一个部门工作。换句话说，员工在与公司一样多的部门工作。

这样的图会有什么样的关联和关系呢？我的目的不是在数据库中创建表，而只是为了帮助理解。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:11:20.273

```
COMPANY_EMPLOYEE_DEPARTMENT:
    COMPANY (PK)
    EMPLOYEE (PK)
    DEPARTMENT 
```

公司和员工的每一种组合，只能与一个部门关联。也就是说，一名员工只能为每个公司的一个部门工作。

只要一个部门不属于一个以上的公司，并且该`COMPANY_EMPLOYEE_DEPARTMENT`关系不将一个公司的部门与另一家公司联系起来，这应该可以工作。

# math - 使用四元数创建第三人称相机位置计算

> ID：11378146
> 
> 赞同：3
> 
> 时间：2012-07-07T19:48:45.907
> 
> 标签：math, rotation, webgl, three.js, quaternions

我想创建一个类似于[示例](http://www.youtube.com/watch?v=pQFRkqMWfmI)的第三人称相机。如果相机和物体之间的旋转差异太大（可能超过百分之十），相机应该贴在物体后面并旋转。

这是我的实际相机代码：

```
var targetPosition = this.getTargetPosition();
var targetRotation = this.getTargetRotation();
var tmpQuaternion = new THREE.Quaternion();
tmpQuaternion.setFromAxisAngle(new THREE.Vector3(0, 1, 0), 180 * (Math['PI'] / 180));
this.camera.quaternion = targetRotation;
this.camera.position = targetPosition;
this.camera.quaternion.multiplySelf(tmpQuaternion);
this.camera.quaternion.normalize();
this.camera.updateMatrix();
this.camera.translateZ(200);
this.camera.translateY(50); 
```

但是现在有几个问题。相机四元数不应直接设置为目标旋转。但我不知道如何计算相机四元数和目标四元数之间的差异，如果距离太高，可能会使用这个：

```
var qm = new THREE.Quaternion();
THREE.Quaternion.slerp(targetRotation, this.camera.quaternion, qm, time);
this.camera.quaternion = qm; 
```

第二个问题是职位本身。目前我将相机位置设置为对象位置并将其转换回后面的视图，但平移应该已经在目标位置并且相机位置应该转换为目标位置。

**更新 1**：我做了一个示例 html：[http ://ssachtleben.github.com/CameraProblem/](http://ssachtleben.github.com/CameraProblem/)

**更新 2**：我现在取得了一些进展。好像我得到这个函数的四元数差异：

```
getAxisAngle = function(quaternion1, quaternion2) {
  var tmpQuaternion = new THREE.Quaternion();
  tmpQuaternion.setFromAxisAngle(new THREE.Vector3(0, 1, 0), 180 * (Math['PI'] / 180));
  var tmpRotation1 = quaternion1.clone();
  tmpRotation1.multiplySelf(tmpQuaternion);
  tmpRotation1.normalize();
  var tmpRotation2 = quaternion2.clone();
  if (tmpRotation2.w > 1) {
    tmpRotation2.normalize();
  }
  var angle1 = 2 * Math['acos'](tmpRotation1.w);
  var angle2 = 2 * Math['acos'](tmpRotation2.w);
  var diff = angle1 > angle2 ? angle1 - angle2 : angle2 - angle1;
  return diff;
}; 
```

但是如果角度差太大，我需要冻结轴。我怎样才能做到这一点？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T09:42:15.480

好的，最后相机已修复并且可以正常工作：

```
var targetPosition = this.getTargetPosition();
var targetRotation = this.getTargetRotation();
var tmpQuaternion = new THREE.Quaternion();

tmpQuaternion.setFromAxisAngle(new THREE.Vector3(0, 1, 0), 180 * (Math['PI'] / 180));
targetRotation.multiplySelf(tmpQuaternion);
targetRotation.quaternion.normalize();

var qm = new THREE.Quaternion();
THREE.Quaternion.slerp(this.camera.quaternion, targetRotation, qm, 0.07);
this.camera.quaternion = qm;
this.camera.quaternion.normalize(); 
```

# r - 使用 R 读取包含许多 2D 数据集的文本文件

> ID：11378147
> 
> 赞同：3
> 
> 时间：2012-07-07T19:49:28.323
> 
> 标签：r, import

我有一个数据文件，我想读入 R，它类似于以下内容：

```
STARTOFDATA 2011-06-23 35
143 6456 23 646 123.53A 864.95 23B
343 634 24 545 65.3 235.2 94C
...
524 542 45 245.4 24 245A 45B
STARTOFDATA 2011-06-24 84
245 6532 24.4 624.2 542 23B 35A
241 4532 13.5 235.12 534.23 54 32B
etc... 
```

如您所见，它基本上是一个 2D 数据集（标题行之间的每一列都是不同的变量），它存储了多个日期，由`STARTOFDATA`行指定，这些日期将不同的日期分开。标题行末尾的数字是下一个标题行之前的数据行数。A、B 和 C 等是质量控制信息，基本上可以丢弃 - 可能就像`gsub`我从文件中获得的文本一样。

我的问题是：我应该如何将其读入 R？理想情况下，我希望能够读取整个文件或指定的日期（或日期范围）。我可能应该指出该文件超过 200,000 行！

我已经对此进行了一些思考和研究，但似乎无法找到一种明智的方法来做到这一点。

据我所知，有两个问题：

1.  **如何读取文件：**有没有办法在 R 的文件中移动指针？我使用过的其他一些语言也有这种能力，在这种情况下，我可以阅读第一行，阅读日期，看看我是否想要那个日期，然后如果不跳过最后列出的行数标题（最好不要阅读它们！）并阅读下一个标题行。我在文档中看不到任何关于可以让我在不实际阅读行的情况下做到这一点的功能。似乎如果我手动创建一个连接对象，那么它将跟踪我在文件中的位置，并且我可以使用对 readLines 的重复调用（在循环中）来读取文件的块，如果它们一旦读取就丢弃它们'不需要。

2.  **如何存储数据：**理想情况下，我想将每个日期的 2D 数据集存储在数据框中，然后我可以继续相当轻松地对它们进行任何分析。但是，我应该如何存储这些 2D 数据集的负载？我正在考虑一个数据框列表，但这是最好的方法（就能够明智地索引列表而言）？

任何想法或意见将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T20:03:44.673

用于`readLines`将数据读取为字符向量，然后操作此向量。以下是将您的示例数据拆分为块列表的一些代码：

用于`readLines`读取数据：

```
x <- readLines(textConnection(
"STARTOFDATA 2011-06-23 35
143 6456 23 646 123.53A 864.95 23B
343 634 24 545 42 65.3 235.2 94C
...
524 542 45 245.4 24 542.54 245A 45B
STARTOFDATA 2011-06-24 84
245 6532 24.4 624.2 542 23B 35A
241 4532 13.5 235.12 534.23 54
etc...")) 
```

确定 的位置`STARTOFDATA`，然后拆分为块列表：

```
positions <- c(grep("STARTOFDATA", x), length(x)+1)
lapply(head(seq_along(positions), -1), 
       function(i)x[positions[i]:(positions[i+1]-1)])

[[1]]
[1] "STARTOFDATA 2011-06-23 35"          
[2] "143 6456 23 646 123.53A 864.95 23B" 
[3] "343 634 24 545 42 65.3 235.2 94C"   
[4] "..."                                
[5] "524 542 45 245.4 24 542.54 245A 45B"

[[2]]
[1] "STARTOFDATA 2011-06-24 84"      
[2] "245 6532 24.4 624.2 542 23B 35A"
[3] "241 4532 13.5 235.12 534.23 54" 
[4] "etc..." 
```

现在每个数据块都是列表中的一个元素，您可以根据需要使用第二个`lapply()`

# c# - ItemsSource 作为带有 null 的 DataView 绑定

> ID：11378149
> 
> 赞同：0
> 
> 时间：2012-07-07T19:50:22.867
> 
> 标签：c#, wpf, mvvm

我制作了自己的控件，该控件继承自 DataGrid，在事件 ItemsChanged 中设置了一个名为 CurrentView 的属性，我只是将我的属性设置为

```
if (ItemsSource is DataTable)
        {
            CurrentView = ((DataTable)ItemsSource).DefaultView;
        }
        else if (ItemsSource is DataView)
        {
            CurrentView = ((DataView)ItemsSource);
        } 
```

但有时当加载数据网格时，我的属性取值，但在绑定到 CurrentView 的属性中的视图模型中，我得到空值。怎么了 ？为什么如果我正确设置我的 CurrentView 我会得到 null ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T23:18:19.413

您可以检查的一些事情：

1.  确保 CurrentView 是一个依赖属性，以允许数据绑定
2.  确保绑定是双向绑定

# python - 优化在 Python 中删除大文件中的重复项

> ID：11378152
> 
> 赞同：1
> 
> 时间：2012-07-07T19:50:35.227
> 
> 标签：python, optimization, duplicates, large-files

我有一个非常大的文本文件（27GB），我试图通过删除在第二个数据库中重复的行来缩小它，该数据库有几个更合理大小的文件（500MB-2GB）。我有一些功能代码，我想知道有什么方法可以优化此代码以更快地运行，人类时钟时间？目前，在一个 1.5GB 输入和 500MB 过滤器的小型测试运行中，这需要 75~ 秒才能完成。

我已经对这个想法进行了多次迭代，这个目前是最好的，如果有人有想法为过滤器制作更好的逻辑结构，我很想听听，过去的尝试都比这个更糟糕：将过滤器加载到一个集合中并在输入中循环搜索重复项（大约是这个速度的一半），将输入加载到一个集合中并通过差异更新运行过滤器（几乎和这个一样快，但也做相反的事情我想要），并将输入和过滤器分块加载到集合中并进行集合差异（这是一个可怕的，可怕的想法，如果我的过滤器更小，那么我也不必拆分它们。 )

所以，这些都是我尝试过的所有事情。所有这些进程都在 CPU 上发挥最大作用，我的最终版本以大约 25-50% 的磁盘 I/O 运行，过滤器和输出在一个物理磁盘上，输入在另一个物理磁盘上。我正在运行双核，不知道这个特定的脚本是否可以线程化，以前从未做过任何多线程处理，所以如果有可能，我很想指出正确的方向。

有关数据的信息！如前所述，输入比滤波器大很多倍。我预计重复的比例很小。数据以行为单位，所有行的长度都小于 20 个 ASCII 字符。文件全部排序。

我已经改变了三个逻辑语句的顺序，基于唯一输入行将是大多数行的期望，然后是唯一过滤器，然后是重复，在完全没有重复的“最佳”情况下，节省了我大约 10% 的时间。

有什么建议么？

```
def sortedfilter(input,filter,output):
    file_input = open(input,'r')
    file_filter = open(filter,'r')
    file_output = open(output,'w')
    inline = file_input.next()
    filterline = file_filter.next()
    try:
        while inline and filterline:
            if inline < filterline:
                file_output.write(inline)
                inline = file_input.next()
                continue
            if inline > filterline:
                filterline = file_filter.next()
                continue
            if inline == filterline:
                filterline = file_filter.next()
                inline = file_input.next()
    except StopIteration:
        file_output.writelines(file_input.readlines())
    finally:
        file_filter.close()
        file_input.close()
        file_output.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:57:01.693

您可以通过执行每行仅执行一次字符串比较操作`cmp(inline, filterline)`：

*   `-1`方法`inline < filterline`
*   `0`方法`inline == filterline`
*   `+1`意味着`inline < filterline`。

这可能会让你多赚几个百分点。所以像：

```
 while inline and filterline:
        comparison = cmp(inline, filterline)
        if comparison == -1:
            file_output.write(inline)
            inline = file_input.next()
            continue
        if comparison == 1:
            filterline = file_filter.next()
            continue
        if comparison == 0:
            filterline = file_filter.next()
            inline = file_input.next() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:07:56.217

看到您的输入文件已排序，以下应该可以工作。heapq 的合并从 groupby 操作的排序输入生成排序流；长度大于 1 的组将被丢弃。这种基于流的方法应该具有相对较低的内存要求

```
from itertools import groupby, repeat, izip
from heapq import merge
from operator import itemgetter

with open('input.txt', 'r') as file_input, open('filter.txt', 'r') as file_filter, open('output.txt', 'w') as file_output:
  file_input_1 = izip(file_input, repeat(1))
  file_filter_1 = izip(file_filter, repeat(2))
  gen = merge(file_input_1, file_filter_1)
  gen = ((k, list(g)) for (k, g) in groupby(gen, key=itemgetter(0)))
  gen = (k for (k, g) in gen if len(g) == 1 and g[0][1]  == 1)
  for line in gen:
    file_output.write(line) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T20:10:36.290

我很想知道这是如何比较的；它基本上只是在玩一点迭代的顺序。

```
def sortedfilter(in_fname, filter_fname, out_fname):
    with open(in_fname) as inf, open(filter_fname) as fil, open(out_fname, 'w') as outf:
        ins = inf.next()
        try:
            for fs in fil:
                while ins < fs:
                    outf.write(ins)
                    ins = inf.next()
                while ins == fs:
                    ins = inf.next()
        except StopIteration:
            # reached end of inf before end of fil
            pass
        else:
            # reached end of fil first, pass rest of inf through
            file_output.writelines(file_input.readlines()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T20:59:19.387

考虑将文件作为二进制文件打开，因此无需转换为 unicode：

```
with open(in_fname,'rb') as inf, open(filter_fname,'rb') as fil, open(out_fname, 'wb') as outf: 
```

# .net - 尝试从 mvc Web 应用程序加载 dll 时出现内存异常

> ID：11378153
> 
> 赞同：0
> 
> 时间：2012-07-07T19:50:55.997
> 
> 标签：.net, loadlibrary

我正在使用第三方 .net 库，它使用

`Kernel.LoadLibrary(DllFileName)`

当此代码在 ac# 控制台应用程序中执行时，一切正常，但是当我尝试从 Web 应用程序（mvc 应用程序）使用库时，我收到“对内存位置的无效访问”异常。我是否必须更改一些设置才能从 Web 应用程序加载托管 dll？

让我知道是否需要任何其他细节

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T03:54:37.210

这可能是位问题。Kernel.LoadLibrary 可能是对非托管[LoadLibrary](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)调用的 PInvoke 调用，可能用于加载非托管库。如果它不检查进程是 32 位还是 64 位并加载适当版本的未管理库，那么您将遇到问题（我实际上以为您会收到有关无效格式的错误，但不同消息可能是因为它跳过了其他一些保护）。尝试强制 32 位模式，看看它是否有帮助（或更改错误）：[IIS 6](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/405f5bb5-87a3-43d2-8138-54b75db73aa1.mspx?mfr=true)或[IIS 7](http://blogs.msdn.com/b/rakkimk/archive/2007/11/03/iis7-running-32-bit-and-64-bit-asp-net-versions-at-the-same-time-on-different-worker-processes.aspx)。

尽管错误消息似乎与我对“找不到文件”问题的预期不符，但控制台应用程序和 Web 应用程序之间可能重要的另一个区别是当前目录不同（以防第三方library 没有将完整路径传递给 LoadLIbrary) - 它通常是运行控制台应用程序时应用程序的目录，但它通常以 web 应用程序中的 Windows 系统目录开始。如果它期望它正在加载的 DLL 在当前目录中，这可能很重要。如果您怀疑它加载了错误的文件，[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)可能是一个非常有用的工具 - 它可以让您查看进程正在执行的所有活动，例如它尝试加载的文件等。

# android - 启动新活动并将它们添加到基于片段的布局中

> ID：11378157
> 
> 赞同：0
> 
> 时间：2012-07-07T19:51:34.267
> 
> 标签：android, android-fragments, android-activity, android-actionbar

我对 Fragments API 很陌生，这是我的问题：假设我有一个`Activity`和一个`ActionBar`带有标签的标签。假设我想从我的应用程序启动消息传递应用程序，通常它将作为一个新的`Activity`. 是否可以将消息`Activity`作为新标签添加到我的`Activity`? 我怎样才能达到这个效果？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:25:24.393

在您的 onCreate 方法中执行以下操作

```
 Context context = getApplicationContext();
     ActionBar actionbar = getActionBar();
    actionbar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

    ActionBar.Tab PlayerTab = actionbar.newTab().setText("Fragment A");
    ActionBar.Tab StationsTab = actionbar.newTab().setText("Fragment B");

    Fragment PlayerFragment = new AFragment();
    Fragment StationsFragment = new BFragment();

    PlayerTab.setTabListener(new MsgTabsListener(PlayerFragment, context));
    StationsTab.setTabListener(new MsgTabsListener(StationsFragment, context));

    actionbar.addTab(PlayerTab);
    actionbar.addTab(StationsTab); 
```

然后添加类`MsgTabListener`并执行以下操作

```
class MsgTabsListener implements ActionBar.TabListener {
public Fragment fragment;
public Context context;

public MsgTabsListener(Fragment fragment, Context context) {
    this.fragment = fragment;
    this.context = context;
}

@Override
public void onTabReselected(Tab tab, FragmentTransaction ft) {

//Start a new activity here with respect to your main context.
 context.StartActivity(new Intent(....));     

}

@Override
public void onTabSelected(Tab tab, FragmentTransaction ft) {
    ft.replace(R.id.fragment_container, fragment);
}

@Override
public void onTabUnselected(Tab tab, FragmentTransaction ft) {
    ft.remove(fragment);
} 
```

如果您正在寻找好的 Fragments API 教程，那么 Lars Vogel 有很好的解释。

[http://www.vogella.com/articles/Android/article.html#fragments_tutorial](http://www.vogella.com/articles/Android/article.html#fragments_tutorial)

# ruby - curl/libcurl 的最佳红宝石绑定/宝石

> ID：11378158
> 
> 赞同：4
> 
> 时间：2012-07-07T19:51:38.007
> 
> 标签：ruby, curl, gem, libcurl

我想通过 ruby​​ 使用 curl 工具。到目前为止，我已经通过命令行调用 curl `curl`，然后解析从文件中转储的数据。但是，我想在我的应用程序中使用它。这将使我更好地控制处理等。

那里很少有宝石[http://curb.rubyforge.org/](http://curb.rubyforge.org/)和[http://curl-multi.rubyforge.org/](http://curl-multi.rubyforge.org/)但是目前尚不清楚哪一个是最好的。我有以下判断标准

1.  库的稳定性和可靠性
2.  全面支持底层 curl 功能。（我需要大量发布数据、伪造 HTTP 标头、重定向和多线程请求。）

得到一些反馈会很棒。

谢谢你的帮助。

- 讲义

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T15:51:59.790

我强烈推荐[Typhoeus](http://rubydoc.info/gems/typhoeus/0.4.2/frames)。它依赖于 lib-curl，并允许各种并行和异步的可能性。它提供 ssl、存根、跟踪重定向、允许自定义标头、真正的并行请求以实现极快的速度，而且通常还没有让我失望。此外，它维护得很好——目前，最后一次提交是 2 天前！

# php - 从您的服务器连接到 mysql

> ID：11378160
> 
> 赞同：0
> 
> 时间：2012-07-07T19:51:51.407
> 
> 标签：php, sql

我正在尝试上传一个使用 mysql 数据库的投资组合网站，我只是 Xampp 来测试它，但现在我想上传，当我上传到我的网站时，我一直无法连接到数据库，让我知道我需要放置而不是本地连接到 schellshockdesign.com 谢谢

```
<?php
//connect to database
$db = mysql_connect( 'localhost', 'blog_ss_user', 'secret' );
//choose the right DB
mysql_select_db( 'schells_portfolio', $db ) or die( 'could not connect to DB' ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:12:53.307

开始阅读 json_encode。在您的实时服务器上创建一个秘密 php 文件。将数据从本地传递到现场，如[http://www.domain.com/secretfile.php?data=](http://www.domain.com/secretfile.php?data=) $json; 现在，用 $_GET['data'] 捕捉，用 json_decode($_GET['data']); 解码 json；并建立数据库连接并插入您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T19:57:56.267

[http://www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html](http://www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html)

您必须启用远程访问才能远程连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T19:58:10.857

你必须做/检查两件事：

1.  检查您是否**有权****远程**访问 MySQL 服务器。

2.  键入MySQL 服务器**所在的****正确域名**。

 *** * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-07T19:53:22.533

在连接过程中插入你的网址 $db = mysql_connect( 'schellshockdesign.com', 'blog_ss_user', 'secret' );**

# php - 我需要在另一个中使用一个 mySQL 查询的输出（它的值）

> ID：11378163
> 
> 赞同：0
> 
> 时间：2012-07-07T19:52:12.457
> 
> 标签：php, mysql, variables, sql-update, nested-queries

我无法将一个查询的输出用作另一个查询的值。问题是我需要使用以下查询获取一种产品的价格（已成功完成）：

```
SELECT Cena FROM Proizvod WHERE ProzivodID = $PID 
```

$PID 是一个 PHP 变量，这个查询工作得很好。当我想从买家的余额中减去产品的价格时，问题就来了。我尝试使用以下查询来做到这一点：

```
UPDATE Kupuvac SET Saldo = Saldo - ".$cena." WHERE KupuvacID=$KID 
```

$cena 是一个 PHP 变量，它的值是第一个查询。

第二个查询根本不起作用，它不会返回错误消息，但不会改变买家的余额。

* * *

*如果有人需要的话，一本简短的字典： `Cena - Price`; `Proizvod - Product`; `Kupuvac - Buyer`; `Saldo - Balance`.*

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T19:58:12.647

您可以`UPDATE`在一个语句中执行操作：

```
UPDATE Kupuvac a
CROSS JOIN
(
    SELECT Cena FROM Proizvod WHERE ProzivodID = $PID
) b
SET a.Saldo = a.Saldo - b.Cena
WHERE a.KupuvacID = $KID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T19:59:07.627

你不能把这些组合成一个查询吗？

```
UPDATE Kupuvac 
SET Saldo = Saldo - (SELECT Cena FROM Proizvod WHERE ProzivodID = $PID) 
WHERE KupuvacID = $KID 
```

# ios - 将 UIView 保存为具有透明背景的 png 文件

> ID：11378165
> 
> 赞同：7
> 
> 时间：2012-07-07T19:52:21.357
> 
> 标签：ios, png, transparent

```
[[[globalSingleton paintingView] drawingView] setOpaque:NO];
[[[[globalSingleton paintingView] drawingView] layer] setOpaque:NO];    
[[[globalSingleton paintingView] drawingView] setBackgroundColor:[UIColor clearColor]];
[[[[globalSingleton paintingView] drawingView] layer] setBackgroundColor:[UIColor clearColor].CGColor];

[[[[globalSingleton paintingView] drawingView] layer] renderInContext:ctx];

UIImage *image1 = UIGraphicsGetImageFromCurrentImageContext(); 
```

上面的代码是我用来将“drawingView”保存到 png 文件的代码。我找到了几个问题和答案，所以我应用了它们。我将“drawingView”和drawingView.layer 的不透明设置为NO，并将“drawingView”的背景颜色设置为[UIColor clearColor]。我想我应用了stackoverflow的所有答案。但是，没有任何改变。png fil的背景仍然是黑色的。我需要透明背景，而不是黑色！！

我试过 UIImage *image1 是否有问题。我使用 image1 在屏幕上显示，然后我可以从该 image1 中找到黑色背景。所以我猜想在创建 image1 时有什么问题。

这就是我发现的全部。是否有任何可能的解决方案可以使用透明背景图像保存我的 png 图像？提前致谢！！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T09:19:07.390

天啊！我做到了！！我添加了 [[UIColor clearColor] set]; . 就这样。

```
UIGraphicsBeginImageContextWithOptions(screenRect.size, NO, [[UIScreen mainScreen] scale]);

CGContextRef ctx = UIGraphicsGetCurrentContext();
[[UIColor clearColor] set];
CGContextFillRect(ctx, screenRect);

[[[globalSingleton paintingView] drawingView] setOpaque:NO];
[[[[globalSingleton paintingView] drawingView] layer] setOpaque:NO];    
[[[globalSingleton paintingView] drawingView] setBackgroundColor:[UIColor clearColor]];
[[[[globalSingleton paintingView] drawingView] layer] setBackgroundColor:[UIColor clearColor].CGColor];

[[[[globalSingleton paintingView] drawingView] layer] renderInContext:ctx]; 

UIImage *image1 = UIGraphicsGetImageFromCurrentImageContext(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-12-29T13:03:47.747

斯威夫特 4.2 版本：

```
extension UIView {

func saveAsImage()-> UIImage? {
    UIGraphicsBeginImageContext(self.bounds.size)
    guard let context = UIGraphicsGetCurrentContext() else { return nil }

    UIColor.clear.set()
    context.fill(self.bounds)

    self.isOpaque = false
    self.layer.isOpaque = false
    self.backgroundColor = UIColor.clear
    self.layer.backgroundColor = UIColor.clear.cgColor

    self.layer.render(in: context)
    let image = UIGraphicsGetImageFromCurrentImageContext()

    return image
}
} 
```

# mysql - Mysql表并入一张表

> ID：11378167
> 
> 赞同：0
> 
> 时间：2012-07-07T19:52:25.860
> 
> 标签：mysql, mysql5

```
CREATE TABLE emp_u (
        id      INT NOT NULL AUTO_INCREMENT,
        emailAddress    VARCHAR(100) NOT NULL,
        username        VARCHAR(30) NOT NULL,
        passwd          VARCHAR(40) NOT NULL,
        title           CHAR(4) NOT NULL,
        firstName       VARCHAR(50) NOT NULL,
        surname         VARCHAR(50) NOT NULL,
        PRIMARY KEY (id),
        UNIQUE KEY(emailAddress),
        UNIQUE KEY(username),
        KEY idx_fullname (firstName, surname)
    ) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE emp_u_p (
    employer_id_fk  INT NOT NULL DEFAULT 0,
    s_mgt           TINYINT(1) NOT NULL DEFAULT 0,
    add_j_mgt       TINYINT(1) NOT NULL DEFAULT 0,
    edit_j_mgt      TINYINT(1) NOT NULL DEFAULT 0,
    del_j_mgt       TINYINT(1) NOT NULL DEFAULT 0,
    j_mgt           TINYINT(1) NOT NULL default 0,
    cp_mgt  TINYINT(1) NOT NULL default 0,
    ph_mgt      TINYINT(1) NOT NULL default 0,
    cb_mgt      TINYINT(1) NOT NULL default 0,
    search_mgt      TINYINT(1) NOT NULL default 0,
    PRIMARY KEY (employer_id_fk)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

我的数据库中有这两个表。将这两个表组合在一起会更好，或者保持原样。

我是数据库新手，只是为我的 mysql 写了一些表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:59:31.260

如果我们建议进行规范化（总是！），那么我建议您将它们保留为两个表，但将权限表的性质更改为一对多而不是像现在看起来那样的 1-1。

在雇员表中每个雇员应该有一行，然后在权限表中*每个权限一行。*

```
CREATE TABLE emp_u_p (
 emp_u_id INT NOT NULL DEFAULT 0,
 permission_name varchar
); 
```

当您需要向系统添加权限类型时，这是非常有利的；您将不需要重构您的架构。如果你真的想一路走下去，做第三个表叫做“权限”，然后有一个多对多，你的employee_permissions表只有两个外键：一个用于employee_id，一个用于permission_id

要选择具有给定权限的员工：

```
SELECT emp_u.* 
FROM emp_u JOIN emp_u_p 
  ON emp_u.id = emp_u_p.emp_u_id 
  AND permission_name = "add_j_mgt"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:00:40.023

正如您的表格所代表的那样，第一个表格包含员工的基本信息，第二个表格包含该员工的权限...我认为，两个表格之间应该存在关系`foreign relationship`...您可以`foreign key`在第二个表格中使用员工的 ID表......它将维护数据库属性......所以，我建议你使用两个表`foreign relationship`......

# c - 在 gcc 的内联 asm 中使用 printf 函数

> ID：11378181
> 
> 赞同：1
> 
> 时间：2012-07-07T19:54:19.573
> 
> 标签：c, gcc, assembly, segmentation-fault, inline-assembly

我想在 gcc 上测试内联 asm 功能。因此，我在 ubuntu 12.04 64 位上键入并编译以下代码，但系统在运行时在屏幕上显示“分段错误”。我不知道是什么导致了问题。

```
#include <stdio.h>
char Format[]="Hello world %d\n";
int main()
{
    asm
    (
        "movl $3,4(%esp);"
        "movl $Format,(%esp);"
        "call printf;"
    );
    return 0;
} 
```

谢谢你们帮助我一个程序新手。我使用 Code::blocks 作为 IDE 来编写这段代码。我曾尝试使用 64 位寄存器，例如 %rdx，但编译代码时生成消息的日志显示“错误：错误的寄存器名称 `%rdx'”。我认为这意味着 Code::blocks 调用的 gcc 是 32 位版本，因此它无法识别这些寄存器。我修改代码以保留堆栈空间

```
#include <stdio.h>
char Format[]="Hello world %d\n";
int main()
{
    asm
    (
        "subl $8,%esp;"         //I  don't know  $4, $8, $12, $16, $20 which is correct
                                        //but I had tried them all but results are still  ''segmentation fault."
        "movl $3,4(%esp);"
        "movl $Format,(%esp);"
        "call printf;"
        "movl %ebp,%esp;"
    );
    return 0;
} 
```

甚至使用 -m32 作为编译器选项，但它仍然显示“分段错误”。

再次感谢谁提供帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T20:37:07.720

用于 x64 的 System V ABI 要求函数的前六个整数/指针参数应该放在寄存器`%rdi`、`%rsi`、`%rdx`、`%rcx`和`%r8`中`%r9`。堆栈用于传递更多参数。它还要求在调用具有可变参数数量的函数（如`printf`）时，应将其设置为寄存器`%rax`中传递的浮点参数的总数。`XMM`在您的情况下调用的正确顺序`printf()`是：

```
xorl %eax, %eax
movl $Format, %edi
movl $3, %esi
call printf 
```

`%rax`应该设置为，`0`因为没有传递浮点参数。该代码还使用了这样一个事实，即初始化数据的 VA 通常位于前 4 GiB 的某个位置，因此使用了较短的 32 位指令。当然`printf`仍然会检查完整的内容`%rdi`来确定格式字符串在内存中的位置。

您的代码使用 32 位调用约定，并且如果交叉编译为 32 位 with 理论上应该可以工作，`-m32`但您应该首先使用类似的东西为参数保留堆栈空间`subl $20, %esp`并在调用后恢复它 with `addl %20, %esp`，否则您要么覆盖堆栈`main()`或`ret`将选择错误的退货地址。这是一个在 32 位模式下编译和运行的完全工作（测试）的 C/asm 代码：

```
#include <stdio.h>

char Format[] = "Hello world, %d\n";

int main (void)
{
   asm
   (
      // Make stack space for arguments to printf
      "subl $8, %esp\n"
      "movl $3, 4(%esp)\n"
      "movl $Format, (%esp)\n"
      "call printf\n"
      // Clean-up the stack
      "addl $8, %esp\n"
   );
   return 0;
}

$ gcc -m32 -o test.x test.c
$ ./test.x
Hello world, 3 
```

备注：我在每条装配线的末尾使用`\n`代替只是为了提高编译器装配输出的可读性 - 它与代码的正确性无关。`;`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T20:02:21.463

首先尝试查看一个普通的 C 程序，看看它给出了什么样的 asm（你可以使用 得到它`gcc -S`）。

然后，确定调用所需的 ASM 部分`printf`并在您的原始程序中重现它。

你在这里有一个[调用](http://unixwiz.net/techtips/win32-callconv-asm.html) [约定](http://en.wikipedia.org/wiki/X86_calling_conventions)错误。

# php - 循环时搜索字符串

> ID：11378182
> 
> 赞同：0
> 
> 时间：2012-07-07T19:54:27.403
> 
> 标签：php, mysql, replace

我正在尝试格式化另一个站点数据以插入到我的数据库中。他想关闭他的网站，所以给我他的网站列表。但是我必须从他的平面文件数据库中格式化他的数据，才能进入我的 mysql 数据库。

我遍历他的文本文件，并获取他的值。然后在将它们插入我的数据库之前根据需要进行格式化。

因为我们的站点使用完全不同的存储格式和字段，所以我遇到了一些问题。

我的网站有一个设计师领域。他没有。所以我试图搜索他的描述字段以在我的设计师表中找到匹配项。如果有匹配项，我希望将设计师 ID 插入到设计师 ID 字段中。但我无法让这段代码工作。

有人可以建议修复吗？或者是否有更好的方法来做到这一点？

```
$fp = fopen('listings.txt','r');
if (!$fp) {echo 'ERROR: Unable to open file.'; exit;}

$loop = 0;

while (!feof($fp)) {
$loop++;
$line = fgets($fp,1024); //use 2048 if very long lines
$field[$loop] = explode ('  ', $line);

$get_designers = mysql_query("SELECT * FROM dress_designers");
$row_designers = mysql_fetch_array($get_designers);
$totalRows_designers = mysql_num_rows($get_designers);

do{
// Note our use of ===.  Simply == would not work as expected
// because the position of 'a' was the 0th (first) character.

$mystring = strtolower($field[$loop][8]);
$findme   = strtolower($row_designers['designer_name']);
$pos = strpos($mystring, $findme);

// Note our use of ===.  Simply == would not work as expected
// because the position of 'a' was the 0th (first) character.
if ($pos === false) {
$designer = "Other";
} else {
$designer = "Siopa Rince";
}

} while ($row_designers = mysql_fetch_assoc($get_designers));

$fp++;
}

fclose($fp); 
```

我只把“Siopa Rince”作为测试。但这不起作用。如果我从文件中获取文本，并将其粘贴到 $mystring 中并将 siopa rince 放入 $findme... 它可以工作。

任何建议将不胜感激！

谢谢，丹尼

好的...直接输入信息怎么样？我尝试了几种不同的方法，但结果返回 null ...

在我插入数据后，我会使用搜索来加入所需的行以获取 ID：

```
SELECT dress_test.dress_title, (

SELECT dress_designers.designer_id
FROM dress_designers
WHERE MATCH (
dress_test.dress_desc
)
AGAINST (
'dress_designers.designer_name'
IN boolean MODE
)
) AS real_designer_id
FROM dress_test 
```

另一个版本：

```
SELECT dress_test.dress_title, dress_designers.designer_name 
FROM dress_test
JOIN dress_designers ON MATCH(dress_test.dress_title, dress_test.dress_desc) AGAINST
('dress_designers.designer_name' in boolean mode) 
```

还有什么建议吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:07:20.753

您的第一次分配`$row_designers`使用`mysql_fetch_array`，而您的第二次使用`mysql_fetch_assoc`

而不是 do { ... } while，为什么不只是 while () { ... }

删除此行`$row_designers = mysql_fetch_array($get_designers);`

并将你的循环变成......

```
while ($row_designers = mysql_fetch_assoc($get_designers)) {
  // string search here
} 
```

其他一切看起来都很好 - 如果您遇到问题，请检查值`echo`以打印字符串或`print_r`打印数组。

# c++ - 用于通过 FTP 代理进行 FTP 上传的 C++ 库

> ID：11378185
> 
> 赞同：0
> 
> 时间：2012-07-07T19:55:26.470
> 
> 标签：c++, proxy, ftp

我正在尝试编写一个 C++ 组件以通过 FTP 代理（由主机/端口/用户/密码指定）在 FTP 服务器上上传文件。

我第一次尝试使用 Qt (QNetworkAccessManager/QNetworkProxy) 但由于未知原因它不起作用（当我尝试使用相同的连接参数使用 FileZilla 上传相同的文件时，它起作用了）。当我没有代理时，我的代码也可以工作。

第二次，我尝试使用 libcurl，但似乎这个 lib 不支持 FTP 代理。

我可以尝试另一个 C++ lib 的任何建议吗？还是 Win32 (winsock) 的例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:23:44.703

如果您的目标是 Windows，您可以尝试使用[Windows Internet API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa385331%28v=vs.85%29.aspx)来实现 FTP 客户端。我想您会更轻松地使用它们，而不是在套接字上手动实现 FTP 客户端。

我没有看过它们，但这里似乎[有一些样本](http://support.microsoft.com/kb/289253)。

# android - android java.lang.IllegalStateException 当我想创建一个新的活动

> ID：11378187
> 
> 赞同：-1
> 
> 时间：2012-07-07T19:55:26.830
> 
> 标签：android, android-intent, android-emulator

我有下面列出的例外情况，我添加了代码，在创建这个问题之前，我用谷歌搜索了这个问题，但没有找到解决方案，我找不到问题或在其他帖子上有相同错误的任何帮助，所以我错过了什么？

模拟器 android 版本 2.2 api 级别 8

这是问题所在：

```
07-07 19:40:20.782: E/AndroidRuntime(588): FATAL EXCEPTION: main
07-07 19:40:20.782: E/AndroidRuntime(588): java.lang.IllegalStateException: Could not execute method of the activity
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.view.View$1.onClick(View.java:2072)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.view.View.performClick(View.java:2408)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.view.View$PerformClick.run(View.java:8816)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.os.Handler.handleCallback(Handler.java:587)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.os.Handler.dispatchMessage(Handler.java:92)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.os.Looper.loop(Looper.java:123)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-07 19:40:20.782: E/AndroidRuntime(588):  at java.lang.reflect.Method.invokeNative(Native Method)
07-07 19:40:20.782: E/AndroidRuntime(588):  at java.lang.reflect.Method.invoke(Method.java:521)
07-07 19:40:20.782: E/AndroidRuntime(588):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-07 19:40:20.782: E/AndroidRuntime(588):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-07 19:40:20.782: E/AndroidRuntime(588):  at dalvik.system.NativeStart.main(Native Method)
07-07 19:40:20.782: E/AndroidRuntime(588): Caused by: java.lang.reflect.InvocationTargetException
07-07 19:40:20.782: E/AndroidRuntime(588):  at app.hearts.multiplayer.MainActivity.onPlayClick(MainActivity.java:24)
07-07 19:40:20.782: E/AndroidRuntime(588):  at java.lang.reflect.Method.invokeNative(Native Method)
07-07 19:40:20.782: E/AndroidRuntime(588):  at java.lang.reflect.Method.invoke(Method.java:521)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.view.View$1.onClick(View.java:2067)
07-07 19:40:20.782: E/AndroidRuntime(588):  ... 11 more
07-07 19:40:20.782: E/AndroidRuntime(588): Caused by: java.lang.SecurityException: Permission Denial: starting Intent { cmp=app.hearts.multiplayer/.GameActivity } from ProcessRecord{44fc09f0 588:app.hearts.multiplayer/10032} (pid=588, uid=10032) requires android.permission.ACCESS_NETWORK_STATE
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.os.Parcel.readException(Parcel.java:1247)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.os.Parcel.readException(Parcel.java:1235)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.app.ActivityManagerProxy.startActivity(ActivityManagerNative.java:1298)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.app.Instrumentation.execStartActivity(Instrumentation.java:1373)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.app.Activity.startActivityForResult(Activity.java:2817)
07-07 19:40:20.782: E/AndroidRuntime(588):  at android.app.Activity.startActivity(Activity.java:2923)
07-07 19:40:20.782: E/AndroidRuntime(588):  ... 15 more 
```

MainActivity.java：

```
package app.hearts.multiplayer;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;    
import android.widget.EditText;

public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

public void onPlayClick(View view)
{
    Intent gameIntent = new Intent(MainActivity.this, GameActivity.class);
    startActivity(gameIntent);
}
} 
```

活动主.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/LinearLayout2"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/background"
    android:gravity="right"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1.05"
        android:scaleType="fitXY"
        android:src="@drawable/hearts_hat" />

    <LinearLayout
        android:id="@+id/LinearLayout1"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="0.70"
        android:orientation="vertical"
        android:paddingRight="@dimen/padding_small"
        android:paddingTop="@dimen/padding_large" >

        <ImageButton
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="48dp"
            android:layout_weight="0.00"
            android:adjustViewBounds="true"
            android:background="@drawable/select_play"
            android:onClick="onPlayClick"
            android:clickable="true"
            android:paddingTop="@dimen/padding_medium" />

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:paddingBottom="@dimen/padding_large"
            android:paddingTop="@dimen/padding_large" >
        </TableRow>

        <ImageButton
            android:id="@+id/button2"
            android:layout_width="wrap_content"
            android:layout_height="48dp"
            android:layout_weight="0.00"
            android:background="@drawable/select_highscore"
            android:clickable="true"
            android:paddingTop="@dimen/padding_large" />
    </LinearLayout>

</LinearLayout> 
```

清单文件：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="app.hearts.multiplayer"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/hearts_icon"
        android:label="@string/app_name"
        android:permission="android.permission.ACCESS_NETWORK_STATE"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main"
            android:screenOrientation="landscape" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".GameActivity"
            android:label="@string/title_activity_game" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

游戏活动.java：

```
package app.hearts.multiplayer;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.MenuItem;
import android.support.v4.app.NavUtils;

public class GameActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_game);
    }

} 
```

活动游戏.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:padding="@dimen/padding_medium"
        android:text="@string/hello_world"
        tools:context=".GameActivity" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:03:01.147

从下面的错误：

```
07-07 19:40:20.782: E/AndroidRuntime(588): Caused by: java.lang.SecurityException: Permission Denial: starting Intent { cmp=app.hearts.multiplayer/.GameActivity } from ProcessRecord{44fc09f0 588:app.hearts.multiplayer/10032} (pid=588, uid=10032) requires android.permission.ACCESS_NETWORK_STATE 
```

您似乎需要添加**ACCESS_NETWORK_STATE** - 使用以下代码添加此权限，该代码应位于“应用程序”标签之外：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example" android:versionCode="1" android:versionName="1.0" >

    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <!-- more data goes here... -->
    </application>  

</manifest> 
```

试试看。

# php - 通过从服务器搜索文件名来显示 html 文件

> ID：11378188
> 
> 赞同：1
> 
> 时间：2012-07-07T19:55:31.147
> 
> 标签：php, javascript

这对我来说有点复杂：假设我的服务器有 1200 个文件，例如：

`file:///D:/xampp/htdocs/bibek/address/WRTRThu-05-Jul-2012-14-02-14pm.html`
`file:///D:/xampp/htdocs/bibek/address/WRTRThu-05-Jul-2012-13-02-23pm.html`
`file:///D:/xampp/htdocs/bibek/address/BRTRThu-05-Jul-2012-13-05-35pm.html`
`file:///D:/xampp/htdocs/bibek/address/BRTRThu-05-Jul-2012-12-06-52pm.html`等等

可以看到它们每个都有一个名称：WRTR 和 BRTR 以及日期和时间。我必须用 php mysql javascript 编写一个脚本（只有最后不得已），让用户输入日期时间和名称（wrtr 或 brtr），他将能够查看相应的文件。谁能建议如何进行？

根据建议并在 maxhud 的帮助下，我得到了这个，向你致敬......

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript">
    function showFile(){
        var name = document.getElementById("name").value;
        var dday = document.getElementById("dday").value;
        var month = document.getElementById("month").value;
        var year = document.getElementById("year").value;
        var hour =document.getElementById("hour").value;
        var minute = document.getElementById("minute").value;
        var second = document.getElementById("second").value;
        var ofday = document.getElementById("ofday").value;
        var day = document.getElementById("day").value;
        var ofday=document.getElementById("ofday").value;
        window.location = "address/" + name + day + "-" + dday+ "-" + month + "-" + year + "-" +hour + "-" + minute + "-" + second + ofday + ".html";
    }
</script>
</head>
<body>

    Name: <input id="name" placeholder="accountname"/><br/>

    Date: <input id="dday" placeholder="01-31"/> - <input id="month" placeholder="month"/> - <input id="year" placeholder="year"/><br/><br/>

    Time: <input id="hour" placeholder="24hours"/> - <input id="minute" placeholder="minute"> - <input id="second" placeholder="second"/>
     of Day <input id="ofday" placeholder="am/pm"/>
     <br/><br/>
     Day: <input id="day"/>
     <br/><br/>

    <button onclick="showFile()">Take me to the file</button>
</body>
</html> 
```

和 php 脚本：fileLocator2.php

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <title>Ethernet database check</title>
<style type="text/css">
body
{
    width:90%;
    max-height:auto;
    min-height:600px;
    background-color:#000;
    color:white;
    font-size:17px;
}
br{
    margin-bottom:1em;
}
#textleft
{
    float:left;
    text-align:left;
}
#textright
{
    float:right;
    margin-right:2em;
}
.inputcont{
    float:left;
    width:20%;
    margin-left:0.1em;
    autofocus:autofocus;
}
a:link
{
    text-decoration:none;
    color:white;
}
title
{

    border-radius:5px;
    font-size:3em;
    background-color:blue;
    color:white;
}

    .yellobutton
{
    background-color:yellow;
    margin-top:1%;
    float:right;
    margin-right:2%;
    width:10em;
    height:2.4em;
    border:1px solid blue;
    border:inset 1px solid black;
    box-shadow:2px 2px 5px #fff;
    color:black;
    font-weight:bold;
}

</style>
</head>
<body>
        <header style="height:4em;font-size:2em;"> Employee Access Only</header>
        <div style="margin:2em;padding:1em 1em 4em 1em;height:auto;border:1px solid #000;border-radius:5px;-moz-box-shadow:0 0 5px 2px #ddb;box-shadow:0 0 5px 2px #ddd;">
                <form method="POST" action="confirm.php">

            <div id="textleft">Path or folder:<br></div>
            <div id="textright"> <input id="path" name="path" placeholder="address no/"/>[?]</div><br/>

            <div id="textleft">Name of file:<br/></div>
            <div id="textright"> <input id="name" name="name" placeholder="filename"/><a href="#" title="WRTR &#13;BRTR">[?]</a></div><br/>

            <div id="textleft">Day:<br/></div>
            <div id="textright"> <input  id="day" name="day"/><a href="#" title="Mon Tue Wed Thu Fri Sat">[?]</a></div>
            <br/>
            <div id="textleft">Date:</div>
            <div id="textright"><input  id="ddate" placeholder="01-31" name="ddate"/> - <input id="month" placeholder="month" name="month"/> - <input id="year" placeholder="2001-2011" name="year"/><a href="#" title="date:01-02-03..31 &#13;month:Jan,Feb,Mar,Apr,May,Jun,Jul,Aug&#13; year:2001...2011">[?]</a></div><br/>
            <div id="textleft">Time:<br/></div>
            <div id="textright"><input  id="time" name="time"/><a href="#" title="hours-mins-seconds &#13; 13-20-23">[?]</a></div></br>

        <input type="submit" class="yellobutton" id="submit" name="submit" value="show me"/>
    </form>
    </div>
    <footer style="font-size:1.4em ;margin-top:20%;">&copy;Bibek Agarwal Scripts</footer>

</body>
</html> 
```

并确认.php

```
<?php
if(isset($_POST['submit']))
    {

    $pathfolder=trim($_POST['path']);
    $filename=trim($_POST['name']);
    $day=trim($_POST['day']);
    $ddate=trim($_POST['ddate']);
    $dmonth=trim($_POST['month']);
    $dyear=trim($_POST['year']);
    $time=trim($_POST['time']);
    /*echo 'path '.$pathfolder.'<br/>';
    echo 'filename '.$filename. '<br/>';
    echo 'day' . $day.'<br/>';
    echo 'time ' .$time. '<br/>';*/
     if((!empty($pathfolder)) && (!empty($filename)) && (!empty($day)) && (!empty($ddate)) && (!empty($dmonth)) && (!empty($dyear)) && (!empty($time)))
        {
            list($hour,$minute,$second)=explode("-",$time);

            echo 'hours '.$hour.'<br/>';
            echo 'minutes '.$minute.'<br/>';
            echo 'seconds '.$second.'<br/>';
            if(($hour>=12) && ($hour<=59))

                $flag="pm";

            if(($hour>=00) && ($hour<=11))
                  $flag="am";

                        $filesever=$pathfolder."/".$filename.$day."-".$ddate."-".$dmonth."-".$dyear."-".$hour."-".$minute."-".$second.$flag.".html";
                         header("Location:$filesever") ;
        }
        else 'Empty Inputs';

 }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:01:09.197

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript">
    function showFile(){
        var name = document.getElementById("name").value;
        var time = document.getElementById("time").value;
        var dayom = document.getElementById("dayom").value;
        var month = document.getElementById("month").value;
        var year = document.getElementById("year").value;
        var day = document.getElementById("day").value;

        window.location = "address/" + name + day + "-" + dayom + "-" + month + "-" + year + "-" time + ".html";
    }
</script>
<style>
    input{
        display:block;
    }
</style>
</head>
<body>
    Name: <input id="name"/>
    Time: <input id="time"/>
    Day of the Month <input id="dayom"/>
    Month: <input id="month"/>
    Year: <input id="year"/>
    Day: <input id="day"/>
    <button onclick="showFile()">Take me to the file</button>
</body>
</html> 
```

# java - 为什么我得到数组的空指针异常？

> ID：11378191
> 
> 赞同：0
> 
> 时间：2012-07-07T19:56:01.573
> 
> 标签：java, nullpointerexception

```
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;

public class Test {
private static ArrayList<Countries> arr =null;
static String country;
static String capital;
static String cities;
static String answer;

public static void main(String args[]) throws IOException{
    Scanner keybord = new Scanner(System.in);
    ArrayList<Countries> d = read("data.txt");
    String res = "";
    for(int i = 0; i < d.size(); i++){
             res += d.get(i).toString();
        answer = keybord.nextLine();
        if(answer.equalsIgnoreCase(d.get(i).getCapital()))
            res+= "The answer is true!";
        else
            res += "The answer is not true" + "The answer is " + d.get(i).getCapital();
        System.out.println(res);
    }
}

public static ArrayList<Countries> read(String filename) throws IOException{
    Scanner scan = new Scanner(new File(filename));
    while(scan.hasNext()){
        country = scan.nextLine(); //System.out.println(country);
        String cities1 = scan.nextLine(); //System.out.println(cities1);
        String cities2 = scan.nextLine(); //System.out.println(cities2);
        String cities3 = scan.nextLine(); //System.out.println(cities3);
        String cities4 = scan.nextLine(); //System.out.println(cities4);
        String capital = scan.nextLine(); //System.out.println(capital);
        Countries c = new Countries(cities1, cities2, cities3, cities4, capital); 
        arr.add(c); // where i get the exception
        scan.nextLine();
    }
    return arr; 
```

}

我不明白为什么在尝试将国家/地区添加到数组列表时出现空指针异常？我不应该在创建它之前将它实例化为 null 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T19:57:35.973

你还没有初始化`arr`，所以默认情况下它是`null`

初始化它

```
private static ArrayList<Countries> arr = new ArrayList<Countries>(); 
```

**还有**，

您检查下一个元素是否存在

```
 while(scan.hasNext()){ 
```

然后你正在阅读下 7 行

```
country = scan.nextLine(); //System.out.println(country);
String cities1 = scan.nextLine(); //System.out.println(cities1);
String cities2 = scan.nextLine(); //System.out.println(cities2);
String cities3 = scan.nextLine(); //System.out.println(cities3);
String cities4 = scan.nextLine(); //System.out.println(cities4);
String capital = scan.nextLine(); //System.out.println(capital);

scan.nextLine(); 
```

哪个会失败

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T19:58:02.947

您需要初始化 arr：

```
private static ArrayList<Countries> arr = new ArrayList<Countries>(); 
```

如果省略该`new ArrayList<Countries>();`部分，则默认值为 null，然后当您调用 时`arr.add()`，您会得到`NullPointerException`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T19:58:32.133

arr 变量未初始化，替换

```
private static ArrayList<Countries> arr 
```

和

```
private static ArrayList<Countries> arr = new ArrayList<Countries>(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T20:00:09.930

您从未初始化`arr`.

添加`arr = new ArrayList<Countries>();`到您的`main`.

# ruby-on-rails - 在heroku上延迟_job rails gem错误，也许与引导相关？

> ID：11378194
> 
> 赞同：1
> 
> 时间：2012-07-07T19:56:53.490
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, twitter-bootstrap, delayed-job

出于某种原因，简单地安装 gem delayed_job_active_record 会导致我的 heroku 应用程序崩溃。

我已经运行了以下步骤：添加到 gem 文件中：

```
gem "delayed_job_active_record" 
```

终端：

```
bundle install
rails generate delayed_job:active_record
rake db:migrate
git add .
git commit -m "added delayed_job gem"
git push
git push heroku master
heroku run rake db:migrate
heroku ps:scale worker=1 
```

一切安装都没有错误，但是当我加载页面时，我的 heroku 日志显示以下内容：

```
WARN: tilt autoloading 'sass' in a non thread-safe way; explicit require 'sass' suggested.
2012-07-07T19:47:14+00:00 app[web.1]:     5:   <%= stylesheet_link_tag    "application", :media => "all" %>
2012-07-07T19:47:14+00:00 app[web.1]:     8:   <%= yield :head %>
2012-07-07T19:47:14+00:00 app[web.1]:   (in /app/app/assets/stylesheets/custom.css.scss)):
2012-07-07T19:47:14+00:00 app[web.1]:     2: <html xmlns:fb="http://ogp.me/ns/fb#">
2012-07-07T19:47:14+00:00 app[web.1]:   app/assets/stylesheets/custom.css.scss:1
2012-07-07T19:47:14+00:00 app[web.1]: 
2012-07-07T19:47:14+00:00 app[web.1]: Completed 500 Internal Server Error in 1465ms
2012-07-07T19:47:14+00:00 app[web.1]: 
2012-07-07T19:47:14+00:00 app[web.1]: Load path: /app
2012-07-07T19:47:14+00:00 app[web.1]:     7:   <%= csrf_meta_tags %>
2012-07-07T19:47:14+00:00 app[web.1]:   app/views/layouts/application.html.erb:5:in `_app_views_layouts_application_html_erb__1868084818636776228_47102160'
2012-07-07T19:47:14+00:00 app[web.1]: ActionView::Template::Error (File to import not found or unreadable: bootstrap. 
```

当我卸载 gem 时，程序恢复没有错误。如果我在本地主机上运行，​​我也没有任何问题。仅当我加载delayed_job gem 时才会发生错误（即使除了安装它我什么都不做）

任何帮助，将不胜感激！

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T20:30:20.013

对于将来想知道的任何人......这解决了它：

将以下内容添加到 application.rb：

```
config.assets.initialize_on_precompile = false 
```

# asp.net - 样式化一个 asp.net 按钮

> ID：11378198
> 
> 赞同：0
> 
> 时间：2012-07-07T19:57:28.737
> 
> 标签：asp.net, css

我对 Asp.net 很陌生，如果这是基本的，我很抱歉。我正在尝试让按钮控件以某种方式显示。

我正在使用我之前使用的 CSS 文件，它会以某种方式设置我的标签样式。

如果我使用的是 asp.net 按钮控件，如何将这种样式应用于按钮控件？

我尝试设置 CSSClass='button' 但这不起作用。我将标签放在我的 asp.net 按钮控件周围，但这只会使 asp.net 位于我的风格化按钮内。

有什么想法我需要做什么吗？

谢谢你的帮助。

```
/******************** Button ********************/
button,
.big-button {
    display: inline-block;
    border: 1px solid;
    border-color: #50a3c8 #297cb4 #083f6f;
    background: #0c5fa5 url(../images/old-browsers-bg/button-element-bg.png) repeat-x left top;
    -webkit-background-size: 100% 100%;
    -moz-background-size: 100% 100%;
    -o-background-size: 100% 100%;
    background-size: 100% 100%;
    background: -moz-linear-gradient(
        top,
        white,
        #72c6e4 4%,
        #0c5fa5
    );
    background: -webkit-gradient(
        linear,
        left top, left bottom,
        from(white),
        to(#0c5fa5),
        color-stop(0.03, #72c6e4)
    );
    -moz-border-radius: 0.333em;
    -webkit-border-radius: 0.333em;
    -webkit-background-clip: padding-box;
    border-radius: 0.333em;
    color: white;
    -moz-text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    -webkit-text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
    -moz-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.4);
    -webkit-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.4);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.4);
    font-size: 1.167em;
    padding: 0.286em 1em 0.357em;
    line-height: 1.429em;
    cursor: pointer;
    font-weight: bold;
    }
    /* IE class */
    .ie button {
        overflow: visible;
    }
    /* IE class */
    .ie7 button {
        padding-top: 0.357em;
        padding-bottom: 0.214em;
        line-height: 1.143em;
    }
    button img,
    .big-button img {
        margin-bottom: -3px;
    }
    button:hover,
    .big-button:hover {
        border-color: #1eafdc #1193d5 #035592;
        background: #057fdb url(../images/old-browsers-bg/button-element-hover-bg.png) repeat-x left top;
        background: -moz-linear-gradient(
            top,
            white,
            #2bcef3 4%,
            #057fdb
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(white),
            to(#057fdb),
            color-stop(0.03, #2bcef3)
        );
    }
    button:active,
    .big-button:active {
        border-color: #5b848b #b2def1 #b2def1 #68a6ba;
        background: #3dbfed url(../images/old-browsers-bg/button-element-active-bg.png) repeat-x top;
        background: -moz-linear-gradient(
            top,
            #89e7f9,
            #3dbfed
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(#89e7f9),
            to(#3dbfed)
        );
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
    }

    button.red,
    .red button,
    .big-button.red,
    .red .big-button {
        color: white;
        border-color: #bf3636 #5d0000 #0a0000;
        background: #790000 url(../images/old-browsers-bg/button-element-red-bg.png) repeat-x top;
        background: -moz-linear-gradient(
            top,
            white,
            #ca3535 4%,
            #790000
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(white),
            to(#790000),
            color-stop(0.03, #ca3535)
        );
        }
        button.red:hover,
        .red button:hover,
        .big-button.red:hover,
        .red .big-button:hover {
            border-color: #c24949 #9d3d3d #590909;
            background: #9d0404 url(../images/old-browsers-bg/button-element-red-hover-bg.png) repeat-x top;
            background: -moz-linear-gradient(
                top,
                white,
                #fe6565 4%,
                #9d0404
            );
            background: -webkit-gradient(
                linear,
                left top, left bottom,
                from(white),
                to(#9d0404),
                color-stop(0.03, #fe6565)
            );
        }
        button.red:active,
        .red button:active,
        .big-button.red:active,
        .red .big-button:active {
            border-color: #7c5656 #f7cbcb #f7cbcb #a15151;
            background: #ff5252 url(../images/old-browsers-bg/button-element-red-active-bg.png) repeat-x top;
            background: -moz-linear-gradient(
                top,
                #ff9d9d,
                #ff5252
            );
            background: -webkit-gradient(
                linear,
                left top, left bottom,
                from(#ff9d9d),
                to(#ff5252)
            );
        }

    button:disabled,
    button:disabled:hover,
    .big-button.disabled,
    .big-button.disabled:hover {
        color: #bfbfbf;
        border-color: #e9f2f6 #c4c3c3 #a2a2a2 #e3e2e2;
        background: #c8c8c8 url(../images/old-browsers-bg/button-element-disabled-bg.png) repeat-x top;
        background: -moz-linear-gradient(
            top,
            #f0f2f2,
            #c8c8c8
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(#f0f2f2),
            to(#c8c8c8)
        );
        -moz-text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.75);
        -webkit-text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.75);
        text-shadow: 1px 1px 0 rgba(255, 255, 255, 0.75);
        -moz-box-shadow: none;
        -webkit-box-shadow: none;
        box-shadow: none;
        cursor: auto;
    }
    /* IE class */
    button.disabled,
    button.disabled:hover {
        color: #bfbfbf;
        border-color: #e9f2f6 #c4c3c3 #a2a2a2 #e3e2e2;
        background: #c8c8c8 url(../images/old-browsers-bg/button-element-disabled-bg.png) repeat-x top;
        cursor: auto;
    }

    button.grey,
    .big-button.grey {
        color: white;
        border-color: #a1a7ae #909498 #6b7076;
        background: #9fa7b0 url(../images/old-browsers-bg/button-element-grey-bg.png) repeat-x top;
        background: -moz-linear-gradient(
            top,
            white,
            #c5cbce 5%,
            #9fa7b0
        );
        background: -webkit-gradient(
            linear,
            left top, left bottom,
            from(white),
            to(#9fa7b0),
            color-stop(0.05, #c5cbce)
        );
        -moz-text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        -webkit-text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
        -moz-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
        -webkit-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
        }
        button.grey:hover,
        .big-button.grey:hover {
            border-color: #a1a7b0 #939798 #6e7275;
            background: #b1b5ba url(../images/old-browsers-bg/button-element-grey-hover-bg.png) repeat-x top;
            background: -moz-linear-gradient(
                top,
                white,
                #d6dadc 4%,
                #b1b5ba
            );
            background: -webkit-gradient(
                linear,
                left top, left bottom,
                from(white),
                to(#b1b5ba),
                color-stop(0.03, #d6dadc)
            );
        }
        button.grey:active
        .big-button.grey:active {
            border-color: #666666 #ffffff #ffffff #979898;
            background: #dddddd url(../images/old-browsers-bg/button-element-grey-active-bg.png) repeat-x top;
            background: -moz-linear-gradient(
                top,
                #f1f1f1,
                #dddddd
            );
            background: -webkit-gradient(
                linear,
                left top, left bottom,
                from(#f1f1f1),
                to(#dddddd)
            );
        }

    button.small,
    .big-button.small {
        font-size: 0.833em;
        padding: 0.2em 0.3em 0.3em 0.2em;
        vertical-align: 0.2em;
        }
        /* IE class */
        .ie button.small {
            padding: 0.5em 0.3em;
            vertical-align: 0.1em;
        }

    .ie7 button + button {
        margin-left: 0.25em;
    } 
```

按钮：

```
<asp:Button ID="LoginButton" runat="server"  CommandName="Login" 
                        Text="Log In" type="button"
                        ValidationGroup="mainLogin" onclick="LoginButton_Click" CSSClass='button'/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:03:39.873

在调查了您的 CSS 之后，下面的行有问题以及 css 无法为您工作的原因 asp:button 在 CssClass

```
button,
.big-button { 
```

您必须以这种方式使用 css

```
.button,
.big-button { 
```

> 所以问题是你错过了 period operator **。** 在按钮之前，

类选择器使用 HTML 类属性，并用“.”定义。 [http://www.w3schools.com/css/css_id_class.asp](http://www.w3schools.com/css/css_id_class.asp)

# c++ - 筛选提取 - opencv

> ID：11378203
> 
> 赞同：9
> 
> 时间：2012-07-07T19:58:02.697
> 
> 标签：c++, opencv, sift, surf, feature-extraction

我正在尝试使用（C++）OpenCv 开始使用筛选特征提取。我需要使用 SIFT 提取特征，在原始图像（例如一本书）和场景之间进行匹配，然后计算相机姿势。

到目前为止，我已经使用 SURF找到[了这个算法。](http://opencv.itseez.com/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html)有谁知道我可以从中开始的基本代码，或者可能是一种将链接中的算法从 SURF 转换为 SIFT 的方法？

提前致谢。

**编辑：** 好的，我为筛选问题制定了解决方案。现在我正在尝试确定相机姿势。我正在尝试使用：solvePnP，有人可以帮我举个例子吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T20:02:49.087

查看新 OpenCV 文档网站的[feature2d 教程部分](http://docs.opencv.org/doc/tutorials/features2d/table_of_content_features2d/table_of_content_features2d.html)。有代码显示的教程：

1.  使用例如 SURF 进行[特征检测](http://docs.opencv.org/doc/tutorials/features2d/feature_detection/feature_detection.html#feature-detection)
2.  [功能描述](http://docs.opencv.org/doc/tutorials/features2d/feature_description/feature_description.html)
3.  [特征匹配](http://docs.opencv.org/doc/tutorials/features2d/feature_flann_matcher/feature_flann_matcher.html#feature-flann-matcher)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-03T13:27:19.787

如果你已经设法找到图像和场景之间的匹配，那么我建议你应用 cv::findHomography()。它将使用 4 个匹配项作为输入来计算单应矩阵。

您可以直接从单应矩阵转换为相机姿势。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T14:30:16.500

为了使用 SIFT 而不是 SURF，我更改`SurfFeatureDetector`为`SiftFeatureDetector`和。对于某些图像，我发现组合 SURF 检测器 <--> SIFT 描述符产生相对准确的结果，但您应该根据您的要求尝试其他组合（FAST 检测器 - FREAK 描述符或 ORB 检测器 - BRISK 描述符）。`SurfDescriptorExtractor``SiftDescriptorExtractor`

请按照本教程解决问题的单应性部分： [特征匹配和单应性](http://docs.opencv.org/doc/tutorials/features2d/feature_homography/feature_homography.html#feature-homography)

此外，也许这会有所帮助：[姿势估计](https://stackoverflow.com/questions/8140924/opencv-extrinsic-camera-from-feature-points/8192775#8192775)

# python - Python 中的 DFS 图生成

> ID：11378208
> 
> 赞同：0
> 
> 时间：2012-07-07T19:59:04.670
> 
> 标签：python, depth-first-search, maze

因此，我尝试更加精通 Python，并决定制作迷宫是一件有趣的事情，知道如何去做。我发现[这个页面](http://www.mazeworks.com/mazegen/mazetut/index.htm)介绍了一些如何做到这一点。

```
 create a CellStack (LIFO) to hold a list of cell locations  
   set TotalCells = number of cells in grid  
   choose a cell at random and call it CurrentCell  
   set VisitedCells = 1  

    while VisitedCells < TotalCells 
        find all neighbors of CurrentCell with all walls intact   
        if one or more found 
            choose one at random  
            knock down the wall between it and CurrentCell  
            push CurrentCell location on the CellStack  
            make the new cell CurrentCell  
            add 1 to VisitedCells
        else 
            pop the most recent cell entry off the CellStack  
            make it CurrentCell
        endIf
    endWhile 
```

现在，我得到了以下代码，尽管它与伪代码中的明显内容相差无几。

```
class Cell:
    top_wall = 0
    bottom_wall = 0
    left_wall = 0
    right_wall = 0
    def knock_down(self,wall):
        if wall is 'top_wall' and self.top_wall is 0:
            self.top_wall = 1
        if wall is 'bottom_wall' and self.bottom_wall is 0:
            self.bottom_wall = 1
        if wall is 'left_wall' and self.left_wall is 0:
            self.left_wall = 1
        if wall is 'right_wall' and self.right_wall is 0:
            self.right_wall = 1
        else
            return 'Error: Wall Already Gone'

maze = [10][10]
CellStack = []          # LIFO stack to hold list of cell locations
TotalCells = 100        # Number of cells in grid
VisitedCells = 0        # Cells that have been visited
CurrentCell = 0         # The current cell

while VisitedCells < TotalCells: 
```

我不确定这门课是做细胞的最好方法，但我还没有想到另一种方法。但是，我在检查单元格的邻居时遇到了一些问题。这`find all neighbors of CurrentCell with all walls intact`让我陷入了一个循环。

如何检查单元格是否为邻居？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:06:45.963

您可以给每个单元格一个位置，存储为两个整数。然后，如果这些整数是邻居，则两个单元格是邻居。

```
def isCellNeighbor(c1, c2):
   if abs(c1.x - c2.x) == 1: return True
   if abs(c1.y - c2.y) == 1: return True
   return False 
```

如果每个单元的至少一个角相互接触，则以上将两个单元视为相邻单元。您可以对其进行调整以满足您的需求。

PS：看看[迷宫算法的惊人集合](http://weblog.jamisbuck.org/2011/2/7/maze-generation-algorithm-recap)

# javascript - 在 JavaScript/JQuery 中创建对象的成本

> ID：11378209
> 
> 赞同：1
> 
> 时间：2012-07-07T19:59:06.763
> 
> 标签：javascript, jquery

有人可以比较和对比在 JavaScript/JQuery 中创建对象的成本和简单的变量声明吗？

例如：

```
var G = {}
G.obj = (function(){
        var x = 10; //'private' attribute, can be accessed internally only
        G.y   = 20; //'public'  property
        }); 
```

x 显然有一个本地范围，因为 Y 可以通过**G**使用选择器公开访问。后一种方法是否涉及任何重大开销？

谢谢。

编辑：我意识到这听起来可能是一个愚蠢的问题，但我正在为 HTML5 游戏规划一个架构，在我前进的过程中，我必须牢记这些小事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:36:50.240

首先，您并没有真正在代码块中执行该函数。

```
G.obj = (function(){
    var x = 10; //'private' attribute, can be accessed internally only
    G.y   = 20; //'public'  property
    })(); 
```

现在，就创建局部变量v / s全局属性的成本而言，AFAIK，访问（获取/设置）全局属性会稍微贵一些，因为您正在遍历范围链。范围链中的属性越高，成本越高。但是，恕我直言，这不是一个问题。

更大的问题是您选择在全球商店中粘贴东西。使用局部变量很有帮助，因为局部变量在函数完成执行后不会一直存在。因此，您不会在内存中保留不必要的状态。这个 IMO 应该推动你的设计在哪里为你的应用程序保持状态。

# php - 使用 post 和/或 get 在一个页面上提交帖子并在另一个页面上查看。类似于博客

> ID：11378220
> 
> 赞同：1
> 
> 时间：2012-07-07T20:00:10.603
> 
> 标签：php, mysql, post, get, blogs

我有点沮丧，但在空闲时间尝试解决这个问题。我想要的是为我的女儿创建一个博客页面，我自己在网页设计方面有点初学者，虽然我确实对 css 和 html 了如指掌。我的问题是关于 php 和/或 mySQL，我想要的是让我的女儿在一个通用页面上写她的博客/故事（她 9 岁），以便提交我写到我们家庭网站上她页面上的某个位置的文本，仍然在制作中。所以我学会了如何发布一些东西，而不是发布到特定页面上的目标空间。我假设您在她的页面 rose.html 和 getelmentbyID 或 post 上使用锚标记？我现在很困惑。如果有人不想向我解释所有这些，我可以查找 php 的连接顺序，但请耐心等待，虽然我对 php 和 mysql 有一些经验，但我还是有点耳后。任何事情都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:18:32.753

使用 WordPress 之类的东西会更好——如果你很了解 HTML/CSS，你可以自定义它对你非常有用。

安装起来非常简单，他们有一百万个指南供您使用。

[http://wordpress.org/](http://wordpress.org/)

试一试，它会让你的生活更轻松。

主题化 WordPress： [http ://webdesignerwall.com/tutorials/building-custom-wordpress-theme](http://webdesignerwall.com/tutorials/building-custom-wordpress-theme)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:23:43.130

通过在名为“entry”的文本框中提交单词，说出您向 div 动态发布 ap 消息。您只需将 php 插入要查看的 div 中间。例如

```
<div>
<!--PHP HERE-->
<?php
    $post = $_POST['entry'];
     echo '<p>'.$post.'</p>';
?>
<!--END PHP-->
</div>
<!--Area you enter message to post-->
<form method="post" action="<!--PUT NAME OF FILE HERE-->">
<textarea name="entry" cols="40" rows="5">
Enter your comments here...
</textarea><br>
<input type="submit" value="Submit" />
</form> 
```

# java - 无法在 ormlite 中使用列名 =“`GROUP`”的 QueryBuilder

> ID：11378221
> 
> 赞同：0
> 
> 时间：2012-07-07T20:00:16.797
> 
> 标签：java, sql, h2, ormlite, query-builder

编码

```
QueryBuilder<MyClass, String> builder = mnDao.queryBuilder();
builder.where().eq("`GROUP`", someGroup)); 
```

抛出异常

> “表 MyClassTable 中的未知列名 '`GROUP`'”

我尝试使用 UpdateBuilder 中的 escapeColumnName() 但结果是一样的。我可以使用原始查询，但它们不安全，因为它们不提供占位符。

数据库是H2。

它看起来像 ormlite 中的一个错误。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:02:48.960

我不知道 ormlite，它*应该*有一种引用名称的方式，允许您使用奇怪的表名，但这种事情最简单的解决方法是避免使用 sql 关键字作为表名或列名字。

如果您可以将表名更改为 sql 不用于其他内容的名称，那么它可能会正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T14:47:56.237

正确的答案是根本不做任何引用。 [ORMLite](http://ormlite.com/)自动引用所有字段和表名。这肯定非常依赖于数据库，但 H2 是我的主要测试数据库，所以我确信它在我所知道的所有情况下都能正常工作。至于为什么它对你不起作用，我无法评论。如果您发布 ORMLite 生成的查询，我可能会看到问题。

推荐的模式是将要在查询中使用的任何列定义为公共字符串。例如：

```
protected static class Reserved {
    public static final String FIELD_NAME_GROUP = "group";
    ...
    @DatabaseField(columnName = FIELD_NAME_GROUP)
    String group;
    ...
} 
```

然后，当您查询时，然后使用`FIELD_NAME_GROUP`不带任何引号的方法并执行以下操作：

```
QueryBuilder<Reserved, Integer> sb = dao.queryBuilder();
sb.where().eq(Reserved.FIELD_NAME_GROUP, "something");
... 
```

我在几个单元测试中对此有很好的覆盖。请参阅我在所有受支持的数据库类型上运行的以下测试。[在JdbcBaseDaoImplTest.java 单元测试](http://ormlite.svn.sourceforge.net/viewvc/ormlite/ormlite-jdbc/trunk/src/test/java/com/j256/ormlite/dao/JdbcBaseDaoImplTest.java?revision=2598&view=markup)中查找`testCreateReserverdTable()`和`testCreateReserverdFields()`方法及其关联的类。

# objective-c - 并发访问 GCD 中的单个 FFTSetup 数据结构

> ID：11378223
> 
> 赞同：3
> 
> 时间：2012-07-07T20:00:34.273
> 
> 标签：objective-c, ios, multithreading, grand-central-dispatch, accelerate-framework

是否可以创建*单个* `FFTSetup`数据结构并使用它同时执行多个 FFT 计算？会像以下工作吗？

```
FFTSetup fftSetup = vDSP_create_fftsetup(
                                         16,         // vDSP_Length __vDSP_log2n,
                                         kFFTRadix2  // FFTRadix __vDSP_radix
                                         );
NSAssert(fftSetup != NULL, @"vDSP_create_fftsetup() failed to allocate storage");

for (int i = 0; i < 100; i++)
{
  dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0),
  ^{
    vDSP_fft_zrip(
                  fftSetup,              // FFTSetup __vDSP_setup,
                  &(splitComplex[i]),    // DSPSplitComplex *__vDSP_ioData,
                  1,                     // vDSP_Stride __vDSP_stride,
                  16,                    // vDSP_Length __vDSP_log2n,
                  kFFTDirection_Forward  // FFTDirection __vDSP_direction
                  );
  });
} 
```

我想答案取决于以下考虑：

1) 是否仅以“只读”方式`vDSP_fft_zrip()`访问其中的数据（或它指向的数据）？`fftSetup`或者在执行其 FFT 计算时`fftSetup`可能会写入一些临时缓冲区（暂存空间）？`vDSP_fft_zrip()`

2）如果`fftSetup` **以“只读”方式访问**这样的数据，多个进程/线程/任务/块可以同时访问它吗？（我在考虑这样一种情况，即有可能多个进程打开同一个文件进行读取，但不一定用于写入或追加。这个类比合适吗？）

`FFTSetup`在相关的说明中，数据结构占用了多少内存？有什么办法可以查到吗？（它是一种不透明的数据类型。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-13T14:39:34.887

您可以创建一个 FFT 设置并重复和同时使用它。这是预期用途。（我是 vDSP_fft_zrip 的当前实现和 vDSP 中其他 FFT 实现的作者。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T16:40:30.360

在[使用傅里叶变换](http://developer.apple.com/library/ios/#documentation/Performance/Conceptual/vDSP_Programming_Guide/UsingFourierTransforms/UsingFourierTransforms.html)中，我们被告知`FFTSetup`包含 FFT 权重数组，它是一系列复指数。vDSP_create_fftsetup[文档](https://developer.apple.com/library/mac/documentation/Accelerate/Reference/vDSPRef/Reference/reference.html#//apple_ref/doc/uid/TP40009464-CH18-BBCFEHAC)说

> 一旦准备好，设置结构可以被 FFT 函数（读取结构中的数据并且不改变它）重复使用任何（2 的幂）长度，直到您创建结构时指定的长度。

所以

1.  从概念上讲，[vDSP_fft_zrip](https://developer.apple.com/library/mac/documentation/Accelerate/Reference/vDSPRef/Reference/reference.html#//apple_ref/doc/uid/TP40009464-CH18-BAJGFEBG)不需要修改权重数组，因此它似乎是不会改变的 FFT 函数之一（*我*`FFTSetup`没有看到除了创建/销毁之外的任何函数），但是不能保证实际的实现是做什么的——它可以做任何事情。

**   *如果* `vDSP_fft_zrip`真正`FFTSetup`以只读方式访问它，那么可以从多个线程中执行此操作。* 

 *至于内存使用，FFT 权重数组是 e^{i*k*2*M_PI/N} for k = [0..N-1]，它们是 N 个复浮点值，所以 2*N*sizeof （漂浮）。

但是那些复杂的指数是非常对称的，所以谁知道，在幕后实现可能需要更少的内存。或者更多！

在您的情况下，N = 2^16，因此看到最多使用 256k 也就不足为奇了。

这会让你在哪里？我认为`FFTSetup`可以从多个线程访问似乎是合理的，但它似乎没有记录。你可能很幸运。或者现在或在框架的未来版本中不幸和令人不快的惊喜。

所以……你觉得幸运吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-08T18:49:45.947

为此，我不会尝试与 vDSP 函数或 Accelerate 框架（其中 vDSP 是其中的一部分）中的任何其他函数进行任何显式并发。为什么？因为 Accelerate 已经被设计为利用多个内核以及给定处理器实现的特定细微差别，所以代表您 - 请参阅[http://developer.apple.com/library/mac/#DOCUMENTATION/Darwin/Reference/ManPages /man7/vecLib.7.html](http://developer.apple.com/library/mac/#DOCUMENTATION/Darwin/Reference/ManPages/man7/vecLib.7.html). You may end up essentially re-parallelizing already parallel computations that are internal to the implementation (if not now, then possibly in a later version). The best approach to the Accelerate framework is generally to assume that it's more clever than you are and just use it in the simplest way possible, then do your performance measurements. If those measurements reflect a level of performance that is somehow insufficient for your needs, then try your own optimizations (and/or file a bug report against the Accelerate framework at [http://bugreport.apple.com](http://bugreport.apple.com) since the authors of that framework are always interested in knowing where or if their efforts somehow fell short of developer requirements).*

# php - 来自运行 Apache 的 Linux 服务器的实时视频流

> ID：11378228
> 
> 赞同：0
> 
> 时间：2012-07-07T20:01:03.473
> 
> 标签：php, javascript, apache, webcam, live-video

我只想将几个摄像头连接到我的 apache 服务器，在 PHP 页面中嵌入一些代码并将实时视频流式传输到互联网。

有谁知道任何不涉及 Microsoft 的 Flash 的简单实惠的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:05:36.930

对于*实时流媒体*，您需要在客户端使用 flash 或 silverlight，但 iOS 设备除外，它可以使用 HTML5。

根据您的评论，您似乎需要一个混合解决方案。Flash 用于普通设备，HTML5+m3u8 用于 iOS。

# amazon-ec2 - 为 VMware 使用亚马逊 EC2

> ID：11378235
> 
> 赞同：1
> 
> 时间：2012-07-07T20:02:32.567
> 
> 标签：amazon-ec2, amazon, vmware, penetration-testing

我正在寻找允许我远程部署 Linux 虚拟主机并将其用于安全测试（即端口扫描等）的云解决方案。不使用时，也许让它充当蜜罐。我真的很喜欢亚马逊的按需付费方式。这里有没有人以类似的方式使用亚马逊的服务？

有什么建议么？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:07:52.647

我还没有，但我对亚马逊服务的评论是，它们可以非常迅速地增加成本，而且由于变量太多，很难控制成本。

除非您需要高弹性，否则我建议您简单地使用 VPS。

还要确保无论您使用谁，都仔细检查条款和条件，因为大多数提供商不会对您从他们的服务进行端口扫描感到高兴。

# c# - ITextSharp 中的特殊字符导致的错误

> ID：11378245
> 
> 赞同：0
> 
> 时间：2012-07-07T20:03:45.143
> 
> 标签：c#, asp.net-mvc, itextsharp, telerik-mvc

我一直在使用 itextsharp，它运行良好，直到我将编辑器更改为 Telerik MVC 编辑器，如果我输入特殊字符，例如`<`或`>`我收到以下错误：

> 你调用的对象是空的。

我的程序的工作方式是使用以下脚本从 SQL Server 表中读取建议列表：

```
string BPRecommendation = "<span style='font-size:10;'>";
for (int i = 0; i < this.selectedVisit.Recommendations.Count; i++)
{
    if (i > 0) BPRecommendation += "<br />";
    BPRecommendation += this.selectedVisit.Recommendations[i].FullName + 
        " (" + this.selectedVisit.Recommendations[i].UserType + "):<br />";
    BPRecommendation += this.selectedVisit.Recommendations[i].Comments + 
        ".<br /><br />";
}
BPRecommendation += "</span>";

List<IElement> htmlarraylist = iTextSharp.text.html.simpleparser.HTMLWorker
    .ParseToList(new StringReader(BPRecommendation), null);

//add the collection to the document
for (int k = 0; k < htmlarraylist.Count; k++)
{
    paragraph.Add((IElement)htmlarraylist[k]);
}
doc.Add(paragraph); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:34:03.727

使用 HtmlEncoding。

```
if (i > 0) BPRecommendation += "<br />";
BPRecommendation += HttpUtility.HtmlEncode(this.selectedVisit.Recommendations[i].FullName) + 
    " (" + HttpUtility.HtmlEncode(this.selectedVisit.Recommendations[i].UserType) + "):<br />";
BPRecommendation += HttpUtility.HtmlEncode(this.selectedVisit.Recommendations[i].Comments) + 
    ".<br /><br />"; 
```

# windows-phone-7 - WP7 如何使用情节提要同时定位两个控件

> ID：11378246
> 
> 赞同：0
> 
> 时间：2012-07-07T20:03:50.987
> 
> 标签：windows-phone-7, storyboard

我似乎无法找到一种方法来使用我的 Storyboard 同时定位两个控件。有谁知道我该怎么做？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:07:08.497

故事板本身不针对控件，个别动画是。`TargetName`只需为您的动画使用不同的。

# c++ - 翻译坐标以重新定位对话框？

> ID：11378247
> 
> 赞同：0
> 
> 时间：2012-07-07T20:03:57.330
> 
> 标签：c++, windows, winforms, dialog, gdi

我上钩了`CreateDialogIndirectParam`。我想对对话框进行一些操作，但是宽度、高度以及 x 和 y 位置都以对话框为单位。有人可以解释如何将它们转换为屏幕坐标吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:07:26.547

试试[MapDialogRect()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645502%28v=vs.85%29.aspx)函数。我认为它会如你所想。

请记住，映射取决于对话框使用的字体，因此`HWND`必须是那个特定的对话框。

同样来自[GetDialogBaseUnits()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645475%28v=vs.85%29.aspx)：

```
pixelX = MulDiv(templateunitX, baseunitX, 4);
pixelY = MulDiv(templateunitY, baseunitY, 8); 
```

作为函数[GetTextMetrics()](http://msdn.microsoft.com/en-us/library/windows/desktop/dd144941%28v=vs.85%29.aspx)返回`baseunitX`的值`tmAveCharWidth`和`baseUnitY`值。您只需要选择一个对话框字体。`tmHeight``HDC`

# ios - 使用贝塞尔曲线绘制螺旋

> ID：11378249
> 
> 赞同：6
> 
> 时间：2012-07-07T20:04:38.867
> 
> 标签：ios, math, bezier, uibezierpath, spiral

这是针对 iPad 应用程序的，但它本质上是一道数学题。

我需要绘制一个不同（单调增加）线宽的圆弧。在曲线的开始，它会有一个起始厚度（比如说 2pts），然后厚度会平滑地增加，直到弧线的末端达到最大厚度（比如说 12pts）。

我认为最好的方法是创建一个 UIBezierPath 并填充形状。我的第一次尝试是使用两个圆弧（具有偏移中心），并且在 90° 以内都可以正常工作，但圆弧通常在 90° 到 180° 之间，因此这种方法不会削减它。

![厚度增加的 90 度圆弧示例](../Images/6a100b1881f8183d0870a1c9344f9828.png)

我目前的方法是使用贝塞尔四边形或三次曲线制作一个轻微的螺旋形（一个从圆弧略微增长，一个略微缩小）。问题是**我将控制点放在哪里，**以便圆弧的偏差（也就是形状“厚度”）是我想要的值。

约束：

*   形状必须能够以任意角度开始和结束（彼此在 180° 以内）
*   形状的“厚度”（与圆的偏差）必须以给定值开始和结束
*   “厚度”必须单调增加（不能变大再变小）
*   它必须看起来光滑，不能有任何急弯

我也对其他解决方案持开放态度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T04:24:09.710

我的方法只是构建 2 个圆弧并填充其间的区域。棘手的一点是找出这些弧的中心和半径。如果厚度不太大，看起来还不错。（剪切和粘贴，并自行决定是否满足您的需求。）可以通过使用剪切路径来改进。

```
- (void)drawRect:(CGRect)rect
{
  CGContextRef context = UIGraphicsGetCurrentContext();

  CGMutablePathRef path = CGPathCreateMutable();

  // As appropriate for iOS, the code below assumes a coordinate system with
  // the x-axis pointing to the right and the y-axis pointing down (flipped from the standard Cartesian convention).
  // Therefore, 0 degrees = East, 90 degrees = South, 180 degrees = West,
  // -90 degrees = 270 degrees = North (once again, flipped from the standard Cartesian convention).
  CGFloat startingAngle = 90.0;  // South
  CGFloat endingAngle = -45.0;   // North-East
  BOOL weGoFromTheStartingAngleToTheEndingAngleInACounterClockwiseDirection = YES;  // change this to NO if necessary

  CGFloat startingThickness = 2.0;
  CGFloat endingThickness = 12.0;

  CGPoint center = CGPointMake(CGRectGetMidX(self.bounds), CGRectGetMidY(self.bounds));
  CGFloat meanRadius = 0.9 * fminf(self.bounds.size.width / 2.0, self.bounds.size.height / 2.0);

  // the parameters above should be supplied by the user
  // the parameters below are derived from the parameters supplied above

  CGFloat deltaAngle = fabsf(endingAngle - startingAngle);

  // projectedEndingThickness is the ending thickness we would have if the two arcs
  // subtended an angle of 180 degrees at their respective centers instead of deltaAngle
  CGFloat projectedEndingThickness = startingThickness + (endingThickness - startingThickness) * (180.0 / deltaAngle);

  CGFloat centerOffset = (projectedEndingThickness - startingThickness) / 4.0;
  CGPoint centerForInnerArc = CGPointMake(center.x + centerOffset * cos(startingAngle * M_PI / 180.0),
                                          center.y + centerOffset * sin(startingAngle * M_PI / 180.0));
  CGPoint centerForOuterArc = CGPointMake(center.x - centerOffset * cos(startingAngle * M_PI / 180.0),
                                          center.y - centerOffset * sin(startingAngle * M_PI / 180.0));

  CGFloat radiusForInnerArc = meanRadius - (startingThickness + projectedEndingThickness) / 4.0;
  CGFloat radiusForOuterArc = meanRadius + (startingThickness + projectedEndingThickness) / 4.0;

  CGPathAddArc(path,
               NULL,
               centerForInnerArc.x,
               centerForInnerArc.y,
               radiusForInnerArc,
               endingAngle * (M_PI / 180.0),
               startingAngle * (M_PI / 180.0),
               !weGoFromTheStartingAngleToTheEndingAngleInACounterClockwiseDirection
               );

  CGPathAddArc(path,
               NULL,
               centerForOuterArc.x,
               centerForOuterArc.y,
               radiusForOuterArc,
               startingAngle * (M_PI / 180.0),
               endingAngle * (M_PI / 180.0),
               weGoFromTheStartingAngleToTheEndingAngleInACounterClockwiseDirection
               );

  CGContextAddPath(context, path);

  CGContextSetFillColorWithColor(context, [UIColor redColor].CGColor);
  CGContextFillPath(context);

  CGPathRelease(path);  
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:20:32.283

一种解决方案是手动生成折线。这很简单，但它的缺点是如果控件以高分辨率显示，则必须按比例增加生成的点数。我对 iOS 的了解不够，无法为您提供 iOS/ObjC 示例代码，但这里有一些 python 式的伪代码：

```
# lower: the starting angle
# upper: the ending angle
# radius: the radius of the circle

# we'll fill these with polar coordinates and transform later
innerSidePoints = []
outerSidePoints = []

widthStep = maxWidth / (upper - lower)
width = 0

# could use a finer step if needed
for angle in range(lower, upper):
    innerSidePoints.append(angle, radius - (width / 2))
    outerSidePoints.append(angle, radius + (width / 2))
    width += widthStep

# now we have to flip one of the arrays and join them to make
# a continuous path.  We could have built one of the arrays backwards
# from the beginning to avoid this.

outerSidePoints.reverse()
allPoints = innerSidePoints + outerSidePoints # array concatenation

xyPoints = polarToRectangular(allPoints) # if needed 
```

# foreach - 为 foreach() 提供的参数无效

> ID：11378251
> 
> 赞同：3
> 
> 时间：2012-07-07T20:05:10.550
> 
> 标签：foreach, php

下面的代码每 60 秒删除文件夹“Images”中的文件，它可以工作，但是当文件夹为空时，它会显示：警告：为 foreach() 提供的参数无效，如果没有文件，如何解决？ " 文件夹为空而不是那个警告..

```
<?php
$expiretime=1; 

$tmpFolder="Images/";
$fileTypes="*.*";

foreach (glob($tmpFolder . $fileTypes) as $Filename) {

// Read file creation time
$FileCreationTime = filectime($Filename);

// Calculate file age in seconds
$FileAge = time() - $FileCreationTime;

// Is the file older than the given time span?
if ($FileAge > ($expiretime * 60)){

// Now do something with the olders files...

echo "The file $Filename is older than $expiretime minutes\r\n";

//delete files:
unlink($Filename);
}

}
?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T20:08:30.500

由于 glob() 可能无法可靠地为空匹配返回一个空数组（[请参阅文档的 Return 部分中的“note”）](http://php.net/manual/en/function.glob.php)，您只需要一个`if`保护循环的语句，如下所示：

```
$files = glob($tmpFolder . $fileTypes);
if (is_array($files) && count($files) > 0) {
    foreach($files as $Filename) {
        // Read file creation time
        $FileCreationTime = filectime($Filename);

        // Calculate file age in seconds
        $FileAge = time() - $FileCreationTime;

        // Is the file older than the given time span?
        if ($FileAge > ($expiretime * 60)){

        // Now do something with the olders files...

        echo "The file $Filename is older than $expiretime minutes\r\n";

        //delete files:
        unlink($Filename);
    }
} else {
    echo 'Your error here...';
} 
```

# c++ - 动态分配二维数组

> ID：11378255
> 
> 赞同：0
> 
> 时间：2012-07-07T20:06:05.500
> 
> 标签：c++, dynamic, multidimensional-array

> **可能重复：**
> [如何在 C++ 中使用数组？(FAQ)](https://stackoverflow.com/questions/4810664/how-do-i-use-arrays-in-c)
> [在 c++ 中使用动态多维数组](https://stackoverflow.com/questions/1471721/using-dynamic-multi-dimensional-arrays-in-c)

```
void fillTestCase (int * tC)
{
    ifstream infile;
    infile.open("input00.txt",ifstream::in);
    int * tempGrid;
    int i,j;
    infile >>i;
    infile >>j;
    tempGrid = new int[i][j];
} 
```

给我一个错误：

```
error C2540: non-constant expression as array bound
error C2440: '=' : cannot convert from 'int (*)[1]' to 'int *' 
```

如何使这两个维度数组动态化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:11:53.813

最简单的方法是使数组一维，并自己计算索引。

伪代码：

```
int MaxWidth;
int MaxHeight;
int* Array;

Array=new int[MaxWidth*MaxHeight];

int Column, Row;
...

Element=Array[Row*MaxWidth+Column]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:17:55.800

到目前为止，最好的方法是使用[boost 多维数组库](http://www.boost.org/doc/libs/1_50_0/libs/multi_array/doc/user.html)。

他们的 3-d 数组示例：

```
int main ()
{
  // Create a 3D array
  typedef boost::multi_array<double, 3> array_type;
  typedef array_type::index index;

  for ( int x = 3; x < 5; ++x )
  {
      int y = 4, z = 2;

      array_type A(boost::extents[x][y][z]);

      // Assign values to the elements
      int values = 0;
      for(index i = 0; i != x; ++i) 
        for(index j = 0; j != y; ++j)
          for(index k = 0; k != z; ++k)
            A[i][j][k] = values++;

      // Verify values
      int verify = 0;
      for(index i = 0; i != x; ++i) 
        for(index j = 0; j != y; ++j)
          for(index k = 0; k != z; ++k)
            assert(A[i][j][k] == verify++);
    }

  return 0;
} 
```

# height - 使用动态高度和宽度将子 div 与父 div 的底部对齐

> ID：11378257
> 
> 赞同：1
> 
> 时间：2012-07-07T20:06:27.070
> 
> 标签：height, width, alignment, parent

我不知道如何将“.buttons-box”移动到“.blog-item”的底部。我可以为“.blog-item”和 {position: absolute;} 设置 {position: relative;} 底部：0；右：0} 为“.buttons-box”，但它不能解决我的问题，因为改变我的宽度为“.buttons-box”，我需要他的宽度与“.content-box”完全一样，然后我可以' t 将宽度设置为 100%，因为从相对父级获取宽度，在这种情况下是“博客项目”。我无法为“div.buttons-box”设置以像素为单位的特定宽度，因为它是动态的“.content-box”和“.text”。它们根据图像具有宽度，并且该图像在每个“博客项目”中都可以具有不同的大小。

**我需要的：**

*   将 div ".buttons-box" 移动到 ".blog-item" 的底部
*   “.buttons-box”必须与“.content.box”具有相同的宽度
*   ".buttons-box" 必须在 ".text" 下并且必须有 self 的占位符，因为如果文本太长，如果他有位置 abolute 将在文本之上

谢谢！

**图片样本：** ttp://i.stack.imgur.com/6WfUm.jpg

**JSFIDDLE 示例和演示：http:** [//jsfiddle.net/yjdEk/](http://jsfiddle.net/yjdEk/)

**编辑：** 我对 JSFIDDLE 的想法：http: [//jsfiddle.net/RhShT/](http://jsfiddle.net/RhShT/)

*   我为按钮框创建了占位符“按钮框占位符”
*   我为“.content-box”设置相对位置，为“.buttons-box”设置绝对位置

我现在需要一些用于设置宽度和高度的脚本，但只能来自他的父母而不是全局，因为每个 .blog-item 都可以不同：

*   .buttons-box 宽度 = .content-box 宽度
*   .content-box 高度 = .blog-item 高度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:34:23.247

有一个名为“继承”的 CSS 宽度属性值，它应该使孩子的宽度等于父母的宽度。

# mono - ImageMagick - 单色噪声

> ID：11378263
> 
> 赞同：3
> 
> 时间：2012-07-07T20:07:32.677
> 
> 标签：mono, imagemagick, noise

我正在尝试使用命令行向类似于 Photoshop 版本的图像添加单色噪声，但是我看不到任何实现它的选项。

我在 JS 中创建了一个代码，它做得很好，这里的逻辑非常简单：

Foreach 像素：

1.  生成随机噪声像素
2.  在原始像素中添加或减去（随机）噪声像素

创建单色噪声加/减是基于像素而不是通道，例如

```
Pi - original pixel
Pr - noise pixel

MonoPixel = Pi+Pr or Pi-Pr 
```

有什么方法可以通过命令行随机添加或减去像素？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T22:02:45.487

您可以使用 ImageMagick [+noise 命令](http://www.imagemagick.org/script/command-line-options.php#noise)添加噪声。要获得单色噪声，您必须做一些更复杂的事情，即创建一个单独的噪声图像与基色相结合，并将其与源图像合成。

此链接可能会有所帮助：[http ://brunogirin.blogspot.com/2009/09/making-noise-with-imagemagick.html](http://brunogirin.blogspot.com/2009/09/making-noise-with-imagemagick.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:27:34.620

您可以尝试构建自己的小 shell 函数。使用 $RANDOM（返回 0..32767 范围内的随机整数的 Bash 环境变量）并查看它是奇数还是偶数。使奇怪的意思`+`和均匀的意思`-`。

```
 echo $(($RANDOM % 2)) 
```

应该以随机顺序返回`1`($RANDOM 是奇数) 或($RANDOM 是偶数)...`0`

# ruby - 将 exec 输出放入变量中

> ID：11378269
> 
> 赞同：0
> 
> 时间：2012-07-07T20:08:15.390
> 
> 标签：ruby, variables, command-line, exec

我是 ruby​​ 的新手，正在尝试做一些命令行的东西。

现在我需要**保存的**输出

```
exec 'cat /etc/system-release' 
```

在一个**变量**中扫描它的一个数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:18:45.817

如果您想获取输出，最好使用`system`或反引号（或对于运行时间较长的任务，`IO.popen`）

在这种情况下，这样做会快很多

```
File.read('/etc/system-release') 
```

而不是为此创建额外的进程。

# ruby-on-rails - JW Flash Player 无法设置要播放的文件

> ID：11378271
> 
> 赞同：0
> 
> 时间：2012-07-07T20:08:26.500
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1, jwplayer

我在我的 rails 3.1.3 网站上使用 JW Flash Player，但我无法设置我希望播放器播放的视频。

我正在尝试这样 <%= player(:file=>Event.first.video.url) %>

但没有运气，它试图找到 /others/video.flv

我不知道我要做什么，我按照这个配置：[https ://github.com/bagwanpankaj/flash_player_helper](https://github.com/bagwanpankaj/flash_player_helper)

我将 demo_player 更改为播放器。

但没有运气。

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T22:08:13.760

解决了。你需要使用 flashvars

```
<%= player({:flashvars =>{:file=>Event.first.video.url}}) %> 
```

谢谢

# actionscript-3 - mx:datagrid - ctrl + 单击

> ID：11378274
> 
> 赞同：0
> 
> 时间：2012-07-07T20:08:34.353
> 
> 标签：actionscript-3, apache-flex, flash-builder

我想拦截`Ctrl`键并单击数据网格线。我知道如何测试用户是否单击数据网格线但如何添加`Ctrl`事件？

第一部分的工作方式如下：

```
<mx:DataGrid id="dgRDVt" fontWeight="normal" 
                 dataProvider="{acList}" 
                 width="100%" height="85%" change="dgRdvPat_changeHandler(event)">
        <mx:columns> 
```

...

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:17:21.887

您必须使用`MouseEvent.CLICK`处理程序来确定这一点。

`MouseEvent`有几个属性可以知道用户是否`Ctrl`在单击时按下了键。[ctrlKey](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/MouseEvent.html#ctrlKey)检测他们是在 Windows 还是 Linux 上执行此操作。 [controlKey](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/MouseEvent.html#controlKey)是跨平台的（也适用于 Mac）。

所以你应该检查`controlKey`. `MouseEvent`将鼠标单击处理程序添加到网格：

```
<mx:DataGrid click="onDataGridClick(event)"/> 
```

然后在事件处理程序中：

```
private function onDataGridClick(event:MouseEvent):void
{
    if (event.controlKey)
    {
        // do something
    }
} 
```

# javascript - 谷歌分析跟踪链接点击次数

> ID：11378276
> 
> 赞同：0
> 
> 时间：2012-07-07T20:08:44.913
> 
> 标签：javascript, html, google-analytics

我想知道如何为我正在为客户开发的网站上的某个链接添加简单的跟踪

我正在使用谷歌分析来跟踪传入流量的来源，在访问者进入他应该点击链接的网站后，我很想知道我从每个来源获得了多少点击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:12:36.693

您正在寻找“广告系列”。这里有一篇关于它的详细文章：http: [//support.google.com/analytics/bin/answer.py ?hl=en&answer=1239239](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1239239)

您可以使用“ [URL Builder](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1033867) ”工具为特定链接（可能是在外部站点上）创建一个 URL，方法是为您的广告系列和其他详细信息命名。这些参数特别是 utm_source、utm_medium 和 utm_campaign。

我会提到，Analytics 已经告诉您（无需对链接进行任何修改）哪些引荐页面发送了访问者，因此您可以知道访问者在到达您的站点之前正在查看的页面。所有这些都可以在 Analytics 报告界面的“流量来源”下找到。广告系列的实用性是（a）您将在许多不同网站上的广告中分散链接，并且它是***广告***而不是您要跟踪的***页面***，或者（b）可能有多个链接到您的网站同一页面，您想知道访问者点击了哪个页面。

# python - 存储迭代值

> ID：11378281
> 
> 赞同：0
> 
> 时间：2012-07-07T20:09:04.640
> 
> 标签：python, python-3.x, python-2.7

我有这个代码：

```
 file_open=open("/python32/doc1.txt","r")
  file=a1.read().lower()
  for line in file:
       line_word=line.split() 
```

这工作正常。但是如果我打印`line_word`它会连续打印。我喜欢存储一些变量，这样我就可以打印我选择的一行并根据我的选择操作它们。有没有办法解决这个问题？

通常我会附加到一个列表并做必要的事情，但对于更大的文件，这确实是有问题的。

如果有人可以提出解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:48:20.123

您不需要调用`.read()`来遍历文件的行。

```
with open("/python32/doc1.txt", "r") as f:
    for line in f:
        line_word = line.lower().split() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:46:03.157

这有帮助吗？

```
file_open=open("/python32/doc1.txt","r")
file=a1.read().lower()
line_word = []
for line in file.splitlines():
    line_word.append(line.split()) 
```

# fossil - 让化石在提交时接受多个标签？

> ID：11378282
> 
> 赞同：3
> 
> 时间：2012-07-07T20:09:25.627
> 
> 标签：fossil

如果我能做类似的事情，我真的很想：

```
fossil commit --tag 0.1.2 release 
```

并让化石同时添加`0.1.2`和`release`作为标签。

我怎样才能做到这一点？

**编辑：**
我按照建议在窗户上建造了化石，它解决了这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T21:15:38.683

`--tag`您可以多次重复该选项，例如`fossil commit --tag 0.1.2 --tag release`

```
d:\test>fossil new test
project-id: 6cf7c1419425e47a71c35900179cb879a68fe495
server-id:  3a9e9a972204274d5a137b9e50df9a54928c4f96
admin-user: Eigenaar (initial password is "846ac5")

d:\test>fossil open test

d:\test>echo hello >world

d:\test>fossil add world
ADDED  world

d:\test>fossil commit --comment "First release" --tag 0.1.2 --tag release
New_Version: 761d2a6c3be8fc22413b5ddedbab46e5500b1b38

d:\test>fossil info
project-name: <unnamed>
repository:   d:/test/test
local-root:   d:/test/
user-home:    C:/Users/Eigenaar/AppData/Local
project-code: 6cf7c1419425e47a71c35900179cb879a68fe495
checkout:     761d2a6c3be8fc22413b5ddedbab46e5500b1b38 2012-07-09 21:13:17 UTC
parent:       1099fa0a0516d4b8a57306c4ee449f86a44f534d 2012-07-09 21:13:17 UTC
tags:         trunk, 0.1.2, release
comment:      First release (user: Eigenaar) 
```

# c# - ServiceStack.DataAnnotations 缺少属性定义？

> ID：11378284
> 
> 赞同：2
> 
> 时间：2012-07-07T20:09:40.930
> 
> 标签：c#, attributes, servicestack

我正在尝试使用 ServiceStack.DataAnnotations 中的 ServiceStack 属性装饰器，但是当我在 MSVS 对象浏览器中查看 ServiceStack.DataAnnotations 命名空间时，只有以下类型：

ComputeAttribute DecimalLengthAttribute IgnoreAttribute PrimaryKeyAttribute

我有最新的垃圾箱，我的所有参考资料都已签出。具体来说，我希望使用 [AutoIncrement] 和 [Index] 属性。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T01:49:03.060

[AutoIncrement] 和 [Index] 属性位于无依赖关系的 ServiceStack.Interfaces.dll 中的 ServiceStack.Interfaces.DataAnnotations 命名空间中**，**[如果](https://github.com/ServiceStack/ServiceStack/tree/master/src/ServiceStack.Interfaces/DataAnnotations)您使用 NuGet，您可以在[ServiceStack.Common NuGet 包](http://nuget.org/packages/ServiceStack.Common)中找到该命名空间。

# android - 为什么查询联系人选择器需要不同的权限取决于 android 版本？

> ID：11378291
> 
> 赞同：3
> 
> 时间：2012-07-07T20:10:47.857
> 
> 标签：android, android-intent

我们一直在尝试使用 Android 联系人选择器，以允许用户在应用程序不需要 READ_CONTACTS 权限的情况下选择联系人。以下意图似乎适用于 4.0 (ICS) 设备以及 2.3.3 模拟器：

```
Intent contactPickerIntent = new Intent(Intent.ACION_GET_CONTENT);
contactPickerIntent.setType(Phone.CONTENT_ITEM_TYPE); // returns content://com.android.contacts/data/...

Intent contactPickerIntent = new Intent(Intent.ACTION_PICK, Contacts.CONTENT_URI); // returns content://com.android.contacts/lookup/... 
```

但是，在 2.2 模拟器和某些 ICS 之前的模型（例如，HTC Thunderbolt、摩托罗拉 Droid）上，尝试查询返回的 UI 会导致权限拒绝异常：

> 引起：java.lang.SecurityException：权限被拒绝：从 pid=273，uid=10036 读取 com.android.providers.contacts.ContactsProvider2 uri content://com.android.contacts/contacts/lookup/0r1-52345052324E483C32/1需要 android.permission.READ_CONTACTS

这看起来像是操作系统或设备碎片问题；我们正在寻求对此主题的澄清，以便我们可以继续采用这种方法或替代方法。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T22:22:11.383

这是故意的。在[此页面](http://developer.android.com/training/basics/intents/result.html)的底部记录了此行为：

> 在 Android 2.3（API 级别 9）之前，对 Contacts Provider 执行查询（如上所示）需要您的应用声明`READ_CONTACTS`权限（请参阅安全和权限）。但是，从 Android 2.3 开始，Contacts/People 应用程序会在您返回结果时授予您的应用程序从 Contacts Provider 读取的临时权限。临时权限仅适用于请求的特定联系人，因此您不能查询除意图指定的联系人之外的联系人`Uri`，除非您声明了`READ_CONTACTS`权限。

还有十几个其他地方你希望这会被记录下来，但那个页面是我发现它解释的唯一地方。

# css - font-face 在除一页之外的所有页面上都有效-可能是什么问题？

> ID：11378297
> 
> 赞同：1
> 
> 时间：2012-07-07T20:12:19.383
> 
> 标签：css, fonts, font-face

Font-Face 正在处理除我的一个页面之外的所有页面——[关于](http://www.massagebybodyworx.com/about)。因为它只是一个不起作用的页面，所以我认为这可能不是文件路径的问题。此外，一切都在当地运作良好。可能是什么原因？我该如何补救？

谢谢你。

```
<div id="about">
    <div class="blurb">
        <p style="text-decoration:underline;color:#f20000;"><span style="color:#282828;">Welcome to BodywoRx</span></p>
</div><!-- end blurb -->

    <div class="banner-image">
        <img src="<?php echo get_template_directory_uri(); ?>/img/large.jpg" alt="about-place-holder" id="aph" />
    </div><!-- end banner-image -->
    <p>Body WoRx was founded on the belief that many dysfunctions of the body can be healed through massage therapy.  In a world where prescriptions are written for variety of symptoms, we offer an alternative solution to helping the body heal itself.  We are located in historic downtown Grand Prairie, conveniently centered between Fort Worth and Dallas.</p>
    <div class="bio">
        <img src="<?php echo get_template_directory_uri(); ?>/img/bridgett.jpg" alt="bridgett-freiburger" id="bf" />
        <p>Bridgett suffered from chronic neck, back, and shoulder pain for many years.  She went to many doctors, specialists, had many MRI&apos;s, but no one knew what was causing the pain.  She had been prescribed countless medications to help ease discomfort, but nothing to address the cause.  Bridgett stumbled across massage therapy and has since become a firm believer and advocate in its many benefits and healing properties.  Before getting into massage therapy, Bridgett served in the Marine Corps, and then continued supporting the war fighter while working at Bell Helicopter. Bridgett is a graduate of North Texas School of Swedish Massage.</p>
    </div><!-- end bio -->
</div><!-- end about -->

#about .banner-image {
    padding-bottom: 40px;
}

#about span {
    font-family: alexandria-bold;
    font-size: 193%;
    font-weight: normal;
    line-height: 1.5;
}

#about p {
    padding-top: 10px;
}

#about .bio {
    margin-top: 40px;
    padding-bottom: 40px;
}

#about .bio p {
    float: right;
    padding-left: 35px;
    width: 655px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T21:28:21.530

您在**主页**和**关于**页面的指定位置有**6 种字体中的 3 种。** `@font-face`

 ******带有 Firebug 网络选项卡的 Firefox 屏幕截图：** ![在此处输入图像描述](../Images/fba700732acd670e9a0954c328a29c79.png)

**旁注：**您在这两个（也许更多）页面中都缺少**关闭。** `anchor tag``id="address"`

* * *

**状态更新：**我找到了解决您的**Firefox**`@font-face`问题的方法。有2个问题。

 **首先，让我们**回到**您最初发布 LIVE 网页链接的时间，并说明您对此没有任何问题。 *下面的所有链接都是可用的，并反映了所看到的格式。*

据了解，这`works`是一个**TYPO**，应该是`worx`. *这显然不是您的网站。*

[`http://massagebybodyworks.com/`](http://massagebybodyworks.com/)

好的，这是更正的版本……***对吧***？

[`http://massagebybodyworx.com/`](http://massagebybodyworx.com/)

好吧，更正后的版本**可以**根据需要使用（双关语）。

现在让我们看看不起作用的**关于****页面**的链接：

 **[`http://www.massagebybodyworx.com/about`](http://www.massagebybodyworx.com/about)

休息一下！*你看到错误了吗？*好吧，事实证明您的**关于页面**正在使用**`www`**锚标签，它**不应该**。这就是它破裂的原因。锚标记应该是：

[`http://massagebybodyworx.com/about`](http://massagebybodyworx.com/about)

话虽如此，这是您更正后的主页，**`www`**并注意它在 Firefox 中也中断了： [`http://www.massagebybodyworx.com/`](http://www.massagebybodyworx.com/)

好的，问题1解决了。只需修复您的锚标记，**不要**在链接中使用**`www`**。

问题 2 与您的服务器`.htaccess`文件有关，因为它控制如何处理链接的传入处理。

**`www`**具体来说，每当有人通过前缀手动键入或访问您的网页时，您的服务器***需要配置***为为他们提供非**`www`**站点服务。然后，您的网页将按照您的预期呈现。[**`.htaccess file`**](http://davidwalsh.name/no-www-using-htaccess-file)如果需要，请在 Google 上进行更多研究。

* * *

***那么，为什么它在 Firefox 而不是 Chrome 中失败了呢？***

Firefox 有不同的安全规则，使用`@font-face`不当会因为[**同源策略**](http://en.wikipedia.org/wiki/Same_origin_policy)规则而导致其崩溃。

它在 Firefox 中中断的原因可以在您的 HTML 网页标记中看到。`@font-face`在那里，您正在使用[**绝对 URL**](http://kb.iu.edu/data/abwp.html)调用负责字体的 CSS 文件：

`"http://massagebybodyworx.com/wp-content/themes/bodyworx/style.css"`

然后，通过访问您的网站**`www`**将导致应用同源策略规则，从而导致您的`@font-face`字体无法按预期显示。

但是，您可以使用[**相对 URL**](http://kb.iu.edu/data/abwp.html)来让 Firefox 满意：

`"wp-content/themes/bodyworx/style.css"`

拥有一个**相对 URL**也意味着`@font-face`当访问您的网站时无论是否使用**`www`**传入链接都不会出现问题，但`.htaccess`最好是正确处理文件。

**旁注：**您有一个空白问题，应该为您的 head 部分中的链接标签进行 URL 编码。这是它的外观：

```
<link rel="pingback" href="BodywoRx%20Massage" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:22:21.960

此页面正在选择#about div 的样式，如下所示

```
#about span {
    font-family: alexandria-bold;
    font-size: 193%;
    font-weight: normal;
    line-height: 1.5;
    } 
```

我假设您希望它是其他页面上的较小文本？如果是这样，请将其从 #about div 中删除或将以下内容放入您的 css 以使其与相应页面相同

```
#about .blurb p,
#about .blurb p span {
    font-family: alexandria;
    font-size: 193%;
    font-weight: normal;
    line-height: 1.5;
    text-decoration: underline #f20000;
    } 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T20:54:30.077

似乎浏览器无法从以下目录在 about 页面上加载 webfont：http: [//massagebybodyworx.com/wp-content/themes/bodyworx/type/](http://massagebybodyworx.com/wp-content/themes/bodyworx/type/)

我认为这与服务器配置有关，它允许从 Massagebybodyworx.com 访问该目录的内容，但不能从 www.massagebybodyworx.com 访问，将其视为跨站点脚本的尝试。********

# javascript - 携带状态是什么意思，一个对象如何携带和继承状态？

> ID：11378301
> 
> 赞同：4
> 
> 时间：2012-07-07T20:13:21.677
> 
> 标签：javascript

ECMAScript 5.1，第 3 页：

> 在 ECMAScript 中，状态和方法由对象承载，结构、行为和状态都是继承的。

携带状态是什么意思，一个对象如何携带和继承状态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T20:33:32.237

“状态”本质上是指“对象记住的东西”。如果一个对象有一个`color`设置为的属性`"blue"`，那是它的状态的一部分。而“携带状态”只是意味着它有一些。

因此，我们可以（不精确地）将该句子的第一部分简化为：“在 ECMAScript 中，对象可以存储数据（和方法）。”

然而，ECMAScript 是一种面向对象的语言，使用原型继承。这意味着任何对象不仅可以拥有***自己的***数据和方法，而且还可以从其父对象（其原型）继承数据和方法。

用 JavaScript 写一个非常粗略的例子：

```
function Foo() {
    this.color = "blue";
}
Foo.prototype = { shape: "circle" }

var foo = new Foo();
alert(foo.shape); // This will be "circle", even though the datum is technically part of the prototype. 
```

# android - 如何在 Android 中的图像上添加文本并使用 JavaMail API 通过电子邮件发送

> ID：11378303
> 
> 赞同：0
> 
> 时间：2012-07-07T20:13:41.057
> 
> 标签：android, jakarta-mail

我想在图片上添加一些文本，然后使用 JavaMail API 通过电子邮件将其作为内容（而不是附件）发送（[在不使用默认/内置应用程序的情况下使用 JavaMail API 在 Android 中发送电子邮件](https://stackoverflow.com/questions/2020088/sending-email-in-android-using-javamail-api-without-using-the-default-built-in-a)）。

我不知道如何将它添加到电子邮件的正文中，我在想，因为我实际上正在生成一个新图像，所以它必须采用特定格式才能添加到电子邮件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T02:15:37.967

你真的有两个问题。

问题 1）如何生成带有一些文本的新图像。（以 jpg 或 png 等格式）

问题 2）我如何通过电子邮件将图像作为消息（而不仅仅是附件）。您基本上发送带有图像附件的 html 电子邮件，但使用 cid 源作为 img 标签。大量示例，例如：http: [//javaeenotes.blogspot.com/2010/04/sending-html-email-with-images-with.html](http://javaeenotes.blogspot.com/2010/04/sending-html-email-with-images-with.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:38:44.280

是的，使用图像 API 生成一个新图像，将旧图像和您要添加的文本组合在一起，然后以正常方式通过电子邮件发送该新图像。

# java - Java：等于和 ==

> ID：11378309
> 
> 赞同：2
> 
> 时间：2012-07-07T20:14:42.870
> 
> 标签：java, reference, equals

让我们看看我们有 2 个对用户定义类实例的引用，Java 中的 a 和 b。是否会出现 a == b 但 a.equals(b) 返回 false 的情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T20:17:49.093

当然！的实现`.equals()`完全取决于班级，所以我可以写：

```
class Foo
    public boolean equals(Object other) {
        return false;
    }
} 
```

现在，你通过什么两个实例并不重要——即使是完全相同的实例两次——我总是会说它们不相等。

这种特别的设置很愚蠢，但它说明您可以`false`从`.equals()`同一对象获得两次结果。

请注意，我们在这里谈论的是***可能***发生的事情，而不是***应该***发生的事情。任何类都不应该实现`.equals`声称对象不等于自身的方法。对于受信任的代码，可以合理地假设这永远不会发生。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T20:17:39.103

是的，只是超载`equals`做一些愚蠢的事情。例如

```
class Foo {
    @Override
    boolean equals(Object rhs) { return false; }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-07T20:24:14.590

`if a == b`那么`a.equals(b)`应该是真的。如果`a.equals(b)`那么可能`a == b`但不一定。

操作员只是测试两者`==`是否引用同一个对象。While`equals`执行您实现的逻辑。最后一个可以被覆盖第一个是语言中的运算符，例如在 Java 中不能被覆盖。

## 参考

[== 运算符和 equals() 有什么区别？（使用哈希码（）？？？）](https://stackoverflow.com/questions/4505357/what-is-the-difference-between-operator-and-equals-with-hashcode)

从[`java.lang.Object`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)文档：

> equals 方法在非空对象引用上实现等价关系：
> 
> 1.  它是自反的：对于任何非空引用值 x，x.equals(x) 应该返回 true。
> 2.  它是对称的：对于任何非空引用值 x 和 y，当且仅当 y.equals(x) 返回 true 时，x.equals(y) 才应该返回 true。
> 3.  它是可传递的：对于任何非空引用值 x、y 和 z，如果 x.equals(y) 返回 true 并且 y.equals(z) 返回 true，则 x.equals(z) 应该返回 true。
> 4.  它是一致的：对于任何非空引用值 x 和 y，x.equals(y) 的多次调用始终返回 true 或始终返回 false，前提是没有修改对象上 equals 比较中使用的信息。
> 5.  对于任何非空引用值 x，x.equals(null) 应该返回 false。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-07T20:44:03.050

正如其他答案所指出的那样，显然***可以编写执行此操作的代码。***

但是，它也***始终是代码中的逻辑错误***，因为它违反了 equals() 函数的隐式通用合同。

一个对象应该总是等于它自己，所以 if `(a==b)`then`a.equals(b)` ***应该***总是返回 true。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-07T20:29:52.213

是的，我们可以重载该`.equals`函数以提供所需的输出。但是没有任何情况下`==`返回真而`.equals`返回假。

```
class s {
    int a;
}

class dev {
    public static void main(String args[]) {
        s a = new s();
        s b = new s();
        System.out.println(a == b);
        System.out.println(a.equals(b));
    }
} 
```

```
输出
错误的
错误的

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-07T20:17:57.043

是的，很容易：

```
public class Wrong{
    public boolean equals(Object other) 
    {
    return false;
    }
} 
```

当然，这完全违反了实现的正常规则`.equals()`- 请参阅[Javadocs](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html#equals%28java.lang.Object%29) - 但除了明智之外，没有什么可以阻止您。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-07T20:18:49.577

可以重写该`equals`方法以提供不同于典型`==`方法的自定义功能。此外，某些类型，例如`Strings`在使用 == 方法时不会返回 true。您必须使用`.equals`或`.compareTo`（当返回 0 时等于）。

这应该提供一些[额外的帮助](http://www.javapractices.com/topic/TopicAction.do?Id=17)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-07T20:49:12.883

```
package com.stackOverFlow;

import java.util.Date;

public class SampleClass {

public static int  myint = 1;
private SampleClass() {
};

public Integer returnRandom() {
    return myint++;
}

private static SampleClass _sampleClass;

public static SampleClass getInstance() {

    if (_sampleClass == null) {
        _sampleClass = new SampleClass();
    }
    return _sampleClass;
}

@Override
public boolean equals(Object other) {
    if (this.returnRandom().equals(((SampleClass) other).returnRandom())) {
        return true;

    }
    return false;
}

}

package com.stackOverFlow;

public class Run {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub

    SampleClass a = SampleClass.getInstance();
    SampleClass b = SampleClass.getInstance();
    if(a==b){
        System.out.println("references are same as they are pointing to same object");
        if(!a.equals(b)){
            System.out.println("two random number Instance will never be same");
        }
    }

}

} 
```

您可以通过实际示例来理解这一点。其中单例类将始终返回相同的引用，并且您可以覆盖 equals 方法以获取不是类变量的内容。例如在两个特定时间来自数据库的值，或随机数。希望可以清除您的情况

# delphi - 重构 - 如何防止重构选项卡显示？

> ID：11378313
> 
> 赞同：9
> 
> 时间：2012-07-07T20:14:57.073
> 
> 标签：delphi, ide, delphi-xe

在 Delphi XE 中，我经常使用重命名变量重构 (Ctrl+Shift+E) 通过提供更有意义的变量名称来使我的代码更易于理解，例如：

![在此处输入图像描述](../Images/bf1249a4f77c45c2df1a81038b0a6205.png)

这一切都很好，但是当我使用它时，我有一个关于工作空间的小问题。我喜欢将代码消息等固定在底部，它们仅在我将鼠标悬停在它们上方时才会出现 - 这是我为编辑器留出更多空间的偏好。

现在，当我使用重命名变量重构时，对话框有复选框：`View references before refactoring`如上图所示。我没有检查这个，因为我通常不需要监督更改的内容等，如果需要我只需撤消它。

这是我的问题，我希望在未经检查的情况下以静默方式执行重构，但不，我仍然会在下面显示重构窗口：

![在此处输入图像描述](../Images/054e05b8a1692de286f4ca4c967f5149.png)

它可能不被认为是一个主要问题，但每次我必须手动关闭重构窗口只是在浪费时间并且变得令人讨厌。

我注意到如果您单击编辑器中的重构选项卡，则会有一个隐藏选项，但这不是永久性的，因为它会在您下次重构时再次出现。

是否有一个我可能错过的选项来阻止重构窗口显示在代码编辑器中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T20:35:18.430

> *…防止重构窗口显示**在代码编辑器中***

把它搬到别处怎么样？从编辑器窗口的底部取消停靠并将其停靠在不同的位置。（除非你隐藏*了所有*的侧面板。）

# python - 用于 Django 的 OpenID 服务器/提供程序

> ID：11378318
> 
> 赞同：7
> 
> 时间：2012-07-07T20:16:05.390
> 
> 标签：python, django, openid, openid-provider

我正在寻找一个库来在 Django 的 OpenID 服务器上实现。也就是说，我有自己的用户数据库，需要成为自己的 OpenID 提供者。我不需要*像*我找到的所有 Django 库那样使用*OpenID 。*有没有好的图书馆？

我找到的一个库是[https://bitbucket.org/romke/django_openid_provider/](https://bitbucket.org/romke/django_openid_provider/)，但已经有一年没有动过了。它的状态好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T21:23:49.360

对于它的价值，我在生产中使用 django_openid_provider (v.0.4)，它的性能非常好。我根据个人喜好在这里和那里进行了一些调整，但是是的，我会说它的状态很好:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T00:52:09.397

从[OpenID wiki](http://wiki.openid.net/w/page/12995226/Run%20your%20own%20identity%20server)有[DjangoID](http://trac.nicolast.be/djangoid)。我还没有测试过，但它可能会有所帮助。

我今天开始寻找 django OpenID 解决方案，因为我看到有更多人感兴趣，也许我们可以分叉其中一个项目并在此基础上推进。

# servlets - 生成 NullPointerException 的简单 Servlet CDI

> ID：11378319
> 
> 赞同：1
> 
> 时间：2012-07-07T20:16:12.530
> 
> 标签：servlets, java-ee-6, glassfish-3, cdi

我正在开发一个名为 bookstore 的示例应用程序，我在其中使用了依赖注入。非常简单的应用程序。我正在使用 JavaEE 6、GlassFish 3.1.2、类中的静态数据（无 db）、Eclipse Juno。

***如果需要，我可以提供更多信息。***

**我得到的错误：**

```
WARNING: StandardWrapperValve[com.bookstore.web.BookListServlet]: PWC1406: Servlet.service() for servlet com.bookstore.web.BookListServlet threw exception
java.lang.NullPointerException
    at com.bookstore.web.BookListServlet.doGet(BookListServlet.java:29)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:668) 
```

我知道这是没有注入依赖项。没有创建类实例来使用它。如果我删除 @Inject 并创建了一个类的实例，那么页面加载正常。

*Servlet 代码生成错误：见粗体注释*

```
package com.bookstore.web;

import java.io.IOException;

import javax.inject.Inject;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.bookstore.BookRepositoryImp;

@WebServlet("/book/")
public class BookListServlet extends HttpServlet {

    private static final long serialVersionUID = 1L;

    @Inject
    private BookRepositoryImp bookRepo;

    public BookListServlet() {
        super();
    }

    protected void doGet(HttpServletRequest req, HttpServletResponse res) throws ServletException,
            IOException {

                **//bookRepo = new BookRepositoryImp(); If uncommect this code and remove @Inject than page working fine**
        req.setAttribute("books", bookRepo.listBooks());
        String path = "/WEB-INF/pages/book-list.jsp";
        getServletContext().getRequestDispatcher(path).forward(req, res);
    }

    protected void doPost(HttpServletRequest req, HttpServletResponse res) throws ServletException,
            IOException {

    }

} 
```

**项目结构：**

![项目](../Images/4cec362d49bbff601da16bca39067c73.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T15:04:32.437

您是否尝试过将 beans.xml 文件移动到 web.xml 所在的 WEB-INF 文件夹中，可能由于某种原因，您的 beans.xml 文件未正确复制到生成的 war 文件中。

# spring - 使用 JSR-303 验证器代替 Spring 验证器

> ID：11378320
> 
> 赞同：12
> 
> 时间：2012-07-07T20:16:20.873
> 
> 标签：spring, spring-mvc

我在这里有一个非常幼稚的概念问题需要澄清。在我的应用程序中，我目前使用 JSR 303 Hibernate Validator 来验证带有 @NotBlank 和 @NotNull 注释的域模型，例如检查用户名、密码等。

```
public class Admin {

  private Long id;
  @NotBlank(message = "Username should not be null")
  private String username;
  @NotBlank(message = "Username should not be null")
  private String password;
  ... 
```

但是为了验证现有用户名之类的域逻辑，我仍在使用 Spring 的 Validator 接口

```
@Component
public class AdminValidator implements Validator {
  ...
  @Override
  public void validate(Object target, Errors errors) {
    Admin admin = (Admin) target;
    if (usernameAlradyExist())){
        errors.rejectValue("username", null, "This user already exist's in the system.");
    }

} 
```

在控制器中我同时使用

```
@RequestMapping(value = "/register", method = RequestMethod.POST)
public String register(@Valid @ModelAttribute("admin") Admin admin, BindingResult bindingResult,) {
    validator.validate(admin, bindingResult);
    if (bindingResult.hasErrors()) {
        return REGISTER_ADMIN.getViewName();

    } 
```

是否可以只使用 Hibernate Validator 而根本不使用 Spring Validator 来验证域逻辑？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-08T09:25:53.313

是的，您可以将 JSR 验证用于域逻辑验证。您需要定义自定义约束注释并在其中定义域逻辑验证。
Like
定义自定义约束注解`UserExistsConstraint`

```
@Target({ElementType.FIELD})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Constraint(validatedBy=UserExistsConstraintValidator.class)

public @interface UserExistsConstraint {
 String message() default "This user already exist's in the system.";
 Class<!--?-->[] groups() default {};
 Class<!--? extends Payload-->[] payload() default {};
} 
```

为自定义注释定义验证器。

```
public class UserExistsConstraintValidator implements ConstraintValidator<UserExistsConstraint, object=""> {

 @Override
 public void initialize(UserExistsConstraint constraint) {

 }

 @Override
 public boolean isValid(Object target, ConstraintValidatorContext context) {
   if (usernameAlradyExist())
   {    
     return false;
   }
   else
   {
     return true; 
   }    
 }
} 
```

使用自定义注释

```
public class Admin {

  private Long id;
  @NotBlank(message = "Username should not be null")
  @UserExistsConstraint
  private String username;
  @NotBlank(message = "Username should not be null")
  private String password;
  ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T22:10:16.437

如果您正在配置 Spring MVC，那么如果类路径中存在一些 JSR 303 验证器 impl（例如 hibernate-validator）`<mvc:annotation-driven/>`，它将自动配置[JSR 303 验证器。](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/validation.html#validator)

或者，如果您明确想要配置验证器，您可以这样做：

```
<bean id="validator"
      class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"/> 
```

这将再次寻找 JSR 303 实现并将其用作验证器。

您可以通过以下方式注册全局验证器来默认验证任何 @Valid 表单对象：

```
<mvc:annotation-driven validator="validator"/> 
```

# objective-c - 为什么在 button.enabled = NO; 之后我的 UIButton 仍然调用方法？

> ID：11378321
> 
> 赞同：2
> 
> 时间：2012-07-07T20:16:23.753
> 
> 标签：objective-c, uibutton

我刚刚开始编程并且已经做到了这一点，但是我现在已经为此苦苦挣扎了一段时间并且完全被卡住了。我用两副牌创建了一个 10x10 的扑克牌板。然后我在下面的 -(void)displayBoard 中制作了所有按钮。每张卡片都有一个 BOOL 属性 card.button 持有它是否应该作为按钮启用。

我将它们打开，一切正常。他们一开始是不可触碰的，然后我打开它们，他们正确地调用 (void)boardCardPressed。但是，当我在那里关闭它们时，它们以图形方式似乎已关闭，但当我触摸它们时仍在调用 (void)boardCardPressed。如果我记录按钮属性，则设置正确。我怀疑这与我添加目标而不是删除有关，但我尝试的一切都没有区别。

我在任何地方都没有找到任何帮助，因此非常感谢任何想法、提示或帮助。顺便说一句 - 我怀疑我的尝试不是最优雅的，所以那里的提示也会很棒。这是我能找到的让我的卡片图像可供选择的唯一方法:)

```
-(void)displayBoard{

    board = [model board];

    for (int x = 0; x < 10; x++){
        for(int y = 0; y < 10; y++){
            Card *tCard = [board getCardxpos:x ypos:y];

            UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
            button.tag = tCard.tag;            
            button.enabled = tCard.button;            

            button.adjustsImageWhenDisabled = NO;

            [button setImage:tCard.image forState:UIControlStateNormal];             

            button.frame = CGRectMake(tCard.xPos, tCard.yPos, tCard.sizeW, tCard.sizeH);            
            [button setImage:tCard.image forState:UIControlEventTouchUpInside];

            [button addTarget:self action:@selector(boardCardPressed:) forControlEvents:UIControlEventTouchUpInside];

            [(SequenceView *)self.view drawIt:button];    
        }   
    }
}

-(void)boardCardPressed:(id)sender {

    int tid = ((UIControl*)sender).tag;    
    int x = tid / 10;
    int y = tid%10;
    Card *tCard = [[model board] getCardxpos:x ypos:y];

    tCard.chosen = YES;
    tCard.button = NO;

    [self displayBoard];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:27:12.753

您的代码中有一些对我来说并不完全清楚的东西。据我所知，您创建了显示板并在其中包含 100 个按钮；当触摸这些按钮中的任何一个时，将`boardCardPressed`再次调用 并再次创建板，其 100 个按钮与原始按钮无关。

这是故意的吗？或者这可能与你不理解的行为有关？

# ivy - IVY：无法解决 restlet 依赖

> ID：11378322
> 
> 赞同：3
> 
> 时间：2012-07-07T20:16:46.073
> 
> 标签：ivy, restlet, dependency-management

我有一个 java 项目设置，想使用 ivy 作为依赖管理工具。但是，我无法让最简单的工作。

这是我的代码：

**常春藤.xml**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<ivy-module version="2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="http://ant.apache.org/ivy/schemas/ivy.xsd">
    <info
        organisation="de.fau.fsahoy"
        module="de.fau.fsahoy.android.api15"
        status="integration">
    </info>

    <dependencies>
        <dependency org="org.restlet.android" name="org.restlet" rev="2.1-RC5"/>
    </dependencies>
</ivy-module> 
```

**常春藤设置.xml**

```
<?xml version="1.0"?>
<ivysettings >
    <settings defaultResolver="maven" />
    <resolvers>
        <chain name="maven" returnFirst="true">
            <ibiblio name="restlet" m2compatible="true" root="http://maven.restlet.org/" />
        </chain>
    </resolvers>

</ivysettings> 
```

我得到的错误是：

```
Impossible to resolve dependencies of de.fau.fsahoy#de.fau.fsahoy.android.api15;working@JonasErl-PC

Failed to load the descriptor for ivysettings.xml[*] in fsahoy-team-d-gitThe ivy file 'C:\Users\JonasErl\Code\fsahoy-team-d-git\ivysettings.xml' could not be parsed: null in file:/C:/Users/JonasErl/Code/fsahoy-team-d-git/ivysettings.xml

org.apache.ivyde.eclipse.IvyDEException: The ivy file 'C:\Users\JonasErl\Code\fsahoy-team-d-git\ivysettings.xml' could not be parsed: null in file:/C:/Users/JonasErl/Code/fsahoy-team-d-git/ivysettings.xml
    at org.apache.ivyde.eclipse.CachedIvy.getModuleDescriptor(CachedIvy.java:376)
    at org.apache.ivyde.eclipse.resolve.IvyResolveJob.run(IvyResolveJob.java:137)
    at org.eclipse.core.internal.jobs.Worker.run(Worker.java:54)
Caused by: java.text.ParseException: null in file:/C:/Users/JonasErl/Code/fsahoy-team-d-git/ivysettings.xml
    at org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorParser$Parser.parse(XmlModuleDescriptorParser.java:301)
    at org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorParser.parseDescriptor(XmlModuleDescriptorParser.java:116)
    at org.apache.ivy.plugins.parser.ModuleDescriptorParserRegistry.parseDescriptor(ModuleDescriptorParserRegistry.java:88)
    at org.apache.ivy.plugins.parser.AbstractModuleDescriptorParser.parseDescriptor(AbstractModuleDescriptorParser.java:48)
    at org.apache.ivyde.eclipse.CachedIvy.getModuleDescriptor(CachedIvy.java:368)
    ... 2 more
Caused by: java.lang.NullPointerException 
```

您可以在[maven.restlet.org查看存储库结构](http://maven.restlet.org)

不幸的是，这些错误消息并不是最好的。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T07:53:42.950

我无法重现您的错误....

*   你用的是什么版本的ivy？
*   你是如何调用常春藤任务的？

# 测试

## 构建.xml

```
<project name="demo" default="init" xmlns:ivy="antlib:org.apache.ivy.ant">

    <target name="init">
        <ivy:resolve/>
    </target>

    <target name="clean">
        <ivy:cleancache/>
    </target>

</project> 
```

## 构建输出

```
init:
[ivy:resolve] :: Apache Ivy 2.3.0-rc1 - 20120416000235 :: http://ant.apache.org/ivy/ ::
[ivy:resolve] :: loading settings :: file = /home/mark/tmp/ivysettings.xml
[ivy:resolve] :: resolving dependencies :: de.fau.fsahoy#de.fau.fsahoy.android.api15;working@mark-laptop
[ivy:resolve]   confs: [default]
[ivy:resolve]   found org.restlet.android#org.restlet;2.1-RC5 in restlet
[ivy:resolve] downloading http://maven.restlet.org/org/restlet/android/org.restlet/2.1-RC5/org.restlet-2.1-RC5.jar ...
[ivy:resolve] ..............................................................................................................................................................................................................................................................................................................................................................................................
[ivy:resolve] ................ (699kB)
[ivy:resolve] .. (0kB)
[ivy:resolve]   [SUCCESSFUL ] org.restlet.android#org.restlet;2.1-RC5!org.restlet.jar (1880ms)
[ivy:resolve] downloading http://maven.restlet.org/org/restlet/android/org.restlet/2.1-RC5/org.restlet-2.1-RC5-sources.jar ...
[ivy:resolve] ............................................................................................................................................................................................................................................................................................................................................................................................................................................................... (738kB)
[ivy:resolve] .. (0kB)
[ivy:resolve]   [SUCCESSFUL ] org.restlet.android#org.restlet;2.1-RC5!org.restlet.jar(source) (971ms)
[ivy:resolve] :: resolution report :: resolve 1713ms :: artifacts dl 2864ms
    ---------------------------------------------------------------------
    |                  |            modules            ||   artifacts   |
    |       conf       | number| search|dwnlded|evicted|| number|dwnlded|
    ---------------------------------------------------------------------
    |      default     |   1   |   1   |   1   |   0   ||   2   |   2   |
    --------------------------------------------------------------------- 
```

# cocoa - NSEventPhaseEnded 未使用 IKImageBrowserView 在 NSScrollView 上调用

> ID：11378323
> 
> 赞同：1
> 
> 时间：2012-07-07T20:16:48.070
> 
> 标签：cocoa, appkit, nsscrollview, nsevent, ikimagebrowserview

我在 NSScrollView 中嵌入了一个 IKImageBrowserView，为了帮助测试这个问题，IKImageBrowserView 只填充了 NSScrollView 宽度的一半。

我的 NSScrollView 子类实现了以下方法并在滚动视图上滚动开始和结束时记录。

```
- (void)scrollWheel:(NSEvent *)event {
    switch (event.phase) {
        case NSEventPhaseBegan:
            NSLog(@"NSEventPhaseBegan");
            break;
        case NSEventPhaseEnded:
            NSLog(@"NSEventPhaseEnded");
            break;
    }

    [super scrollWheel:event];
} 
```

NSEventPhaseBegan 事件阶段在您开始滚动时成功调用光标是否在 IKImageBrowserView 上。这是预期的行为。

但是当您停止滚动时，当光标位于 IKImageBrowserView 上方时，不会调用 NSEventPhaseEnded 事件阶段。如果光标不在 IKImageBrowserView 上，则 NSEventPhaseEnded 会被调用。

为什么 IKImageBrowserView 阻止在我的 NSScrollView 上调用 NSEventPhaseEnded？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-01T20:15:09.577

与 Apple 的一位乐于助人的工程师交谈，他告诉我这种行为实际上是一个错误。不幸的是，ImageKit 正在吃一些 scrollWheel 事件。作为一种解决方法，子类化 IKImageBrowserView，实现 scrollWheel 并将事件转发到“super”和封闭的滚动视图。

```
@implementation MyImageBrowserView

- (void)scrollWheel:(NSEvent *)theEvent {
   [super scrollWheel:theEvent];

   if ([theEvent phase] == NSEventPhaseEnded) 
       [[self enclosingScrollView] scrollWheel:theEvent];
   }
}

@end 
```

# zend-framework - 在 zend 框架中使用 SoapClient、ArrayObject、ArrayIterator 会导致错误

> ID：11378333
> 
> 赞同：0
> 
> 时间：2012-07-07T20:18:35.550
> 
> 标签：zend-framework, doctrine-orm, zend-autoloader

我正在我的实体中研究一些有用的方法。

```
private function setApi($api_address,$api_username,$api_password){

    $this->api_address = $api_address;
    $this->api_username = $api_username;
    $this->api_password = $api_password;
    $this->api_client = new SoapClient($api_address); // error
} 
```

警告：require（App/Entity/SoapClient.php）：无法打开流：第 148 行的 /zendboilerplate/library/Doctrine/Common/ClassLoader.php 中没有这样的文件或目录致命错误：require（）：打开失败需要' App/Entity/SoapClient.php' (include_path='/zendboilerplate/application/../library:/zendboilerplate/application/../library/Bisna/Application/Resource:/zendboilerplate/library:.:/usr/share/ php:/usr/share/pear') 在第 148 行的 /zendboilerplate/library/Doctrine/Common/ClassLoader.php 中似乎 zend 寻找一个类声明（并且它不使用 php 中包含的类）。

每个“*新*类”声明的相同错误。使用库中包含的我自己的类，一切正常。（也尝试使用 @new SoapClient() 但没有结果）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:16:33.813

我猜这是命名空间相关的。尝试将出错的行更改为：

```
$this->api_client = new \SoapClient($api_address); 
```

这应该迫使它使用 PHP SoapClient 而不是可能在您遇到问题的文件开头声明的命名空间。

# string - 提取bash中两个字符之间的字符串

> ID：11378334
> 
> 赞同：5
> 
> 时间：2012-07-07T20:18:45.443
> 
> 标签：string, bash, sed, awk

我有一个格式如下的字符串

```
Walk Off the Earth - Somebody That I Used to Know
[playing] #36/37   1:04/4:05 (26%)
volume: n/a   repeat: off   random: on    single: off   consume: off 
```

现在，我需要从上面的字符串中`36`提取`#36/37`.

我做的第一件事是`#36/37`使用从第二行中提取

```
echo "above mentioned string" | awk 'NR==2 {print $2}' 
```

现在，我想`36`从上面提取的部分中提取我所做的

```
echo `#36/37` | sed -e 's/\//#/g' | awk -F "#" '{print $2}' 
```

这给了我`36`作为我的输出。

但是，我觉得同时使用两者`sed and awk`只是为了从中提取文本`#36/37`是矫枉过正的。那么，有没有更好或更短的方法来实现这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T20:30:55.707

将磅和斜线字符上的字段拆分为一个数组并检索所需的元素。

```
awk 'NR==2 {split($2, arr, "[#/]"); print arr[2]}' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T20:47:48.597

`=~`这个答案利用了 bash 使用test 运算符的内置扩展正则表达式语法。（我说`test`，但不要指望它与`test`命令一起使用。它只与`[[`关键字一起使用。）

```
mini:~ michael$ cat foo
Walk Off the Earth - Somebody That I Used to Know
[playing] #36/37   1:04/4:05 (26%)
volume: n/a   repeat: off   random: on    single: off   consume: off

mini:~ michael$ [[ $(<foo) =~ \#[[:digit:]]{2} ]] && echo "${BASH_REMATCH[0]#\#}"
36 
```

当你把它归结起来时，这只是一个匹配井号后两位数字的正则表达式，并将它们保存在`BASH_REMATCH`数组的第零个元素中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-09T11:43:36.930

这将解决您的问题。

```
awk -F'[#/]' 'NR==2{print $2}' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-07T20:28:26.887

使用`sed`假设的一种方法`infile`是问题的内容。在第二行匹配任何字符直到`#`，然后将任何数字保存在第 1 组中，并用该组替换整行`\1`。除非在代码`-n`中用指令指示，否则该开关会避免打印任何内容。`p`

```
sed -ne '2 { s/^[^#]*#\([0-9]*\).*$/\1/; p; q }' infile 
```

输出：

```
36 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-07T20:33:15.790

这可能对您有用：

```
sed 's/.*#\([0-9]*\)\/[0-9]*.*/\1/p;d' file
36 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-07T20:33:29.357

```
input | while read playing numbers rest
do
  if [[ $playing = "[playing]" ]]; then
    t="${numbers:1}"
    echo "${t%/*}"
  fi
done 
```

Bash 默认拆分是按空格，所以你在第二个字段（数字）中得到的就是那个数字。剩下的就是使用 bash 参数扩展运算符来获取感兴趣的部分：删除第一个字符并删除以“/”开头的后缀

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-07-07T20:41:21.300

```
sed -n '2s/.*\#\([0-9]*\)\/.*/\1/p' 
```

这会抑制除第二行之外的所有内容，然后回显和之间的`#`数字`/`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-22T08:13:26.633

我编写了一个脚本，它输出第一个字符和最后一个字符之间的字符串。要解决您的问题，您可以使用以下命令与此脚本结合使用。

```
echo '[playing] #36/37   1:044:05 (26%)' | cut -d' ' -f2 | ./cut_between.sh -f '#' -l '/' 
```

[您可以在GitHub 上](https://gist.github.com/ahaitoute/5004850)下载此脚本。

# c# - 将字符串拆分为基于单词长度的列表c#

> ID：11378338
> 
> 赞同：7
> 
> 时间：2012-07-07T20:19:14.030
> 
> 标签：c#, string, list

我有一串用空格分隔的单词。如何根据单词长度将字符串拆分为单词列表？

**例子**

> 输入：
> 
> ```
> " aa aaa aaaa bb bbb bbbb cc ccc cccc cccc bbb bb aa " 
> ```
> 
> 输出 ：
> 
> ```
> List 1 = { aa, bb, cc}
> List 2 = { aaa, bbb, ccc}
> List 3 = { aaaa, bbbb, cccc} 
> ```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T20:21:53.113

您可以使用它`Where`来查找与谓词匹配的元素（在这种情况下，具有正确的长度）：

```
string[] words = input.Split();

List<string> twos = words.Where(s => s.Length == 2).ToList();
List<string> threes = words.Where(s => s.Length == 3).ToList();
List<string> fours = words.Where(s => s.Length == 4).ToList(); 
```

或者，您可以使用`GroupBy`一次查找所有组：

```
var groups = words.GroupBy(s => s.Length); 
```

您还可以使用`ToLookup`以便您可以轻松索引以查找特定长度的所有单词：

```
var lookup = words.ToLookup(s => s.Length);
foreach (var word in lookup[3])
{
    Console.WriteLine(word);
} 
```

结果：

```
啊啊啊
bbb
ccc

```

在线查看它：[ideone](http://ideone.com/nlyzc)

* * *

在您的更新中，您似乎想要删除空字符串和重复的单词。您可以通过 using 执行前者，`StringSplitOptions.RemoveEmptyEntries`后者通过 using 执行`Distinct`。

```
var words = input.Split((char[])null, StringSplitOptions.RemoveEmptyEntries)
                 .Distinct();
var lookup = words.ToLookup(s => s.Length); 
```

输出：

```
aa, bb, cc
aaa, bbb, ccc
aaaa, bbbb, cccc 
```

在线查看它：[ideone](http://ideone.com/HyDAE)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-07T21:11:29.537

> **编辑：**我很高兴我的原始答案帮助 OP 解决了他们的问题。然而，在稍微思考了这个问题之后，我已经对其进行了调整（我强烈建议*不要*使用我以前的解决方案，我在帖子末尾留下了这个解决方案）。

# 一个简单的方法

```
string input = " aa aaa aaaa bb bbb bbbb cc ccc cccc cccc bbb bb aa ";
var words = input.Trim().Split().Distinct();
var lookup = words.ToLookup(word => word.Length); 
```

## 解释

首先，我们修剪输入以避免来自外部空间的空元素。然后，我们将字符串拆分为一个数组。如果*单词之间出现多个空格，则*需要使用`StringSplitOptions`as in [Mark's answer](https://stackoverflow.com/a/11378353/1106367)。

在调用`Distinct`只包含每个单词一次之后，我们现在将`words`from 转换`IEnumerable<string>`为`Lookup<int, string>`，其中单词的长度由 key 表示，`(int)`单词本身存储在 value 中`(string)`。

等等，这怎么可能？我们不是每个键都有多个单词吗？当然，但这正是[`Lookup`](http://msdn.microsoft.com/en-us/library/bb460184)课程的用途：

> **`Lookup<TKey, TElement>`**表示一组键，每个键映射到一个或多个值。A`Lookup<TKey, TElement>`类似于`Dictionary<TKey, TValue>`. 不同之处在于 Dictionary 将键映射到单个值，而 Lookup 将键映射到*值的集合*。
> 
> `Lookup`您可以通过调用`ToLookup`实现 的对象来创建 a 的实例`IEnumerable<T>`。
> 
> * * *
> 
> **注意**
> 没有用于创建 Lookup 的新实例的公共构造函数。此外，Lookup 对象是不可变的，也就是说，您不能在 Lookup 创建后添加或删除元素或键。

`word => word.Length`是*KeySelector* lambda：它定义了我们要按单词的长度来索引（或分组，如果你愿意`Lookup`的话）。

## 用法

### 将所有单词写入控制台

*（类似于问题最初要求的输出）*

```
foreach (var grouping in lookup)
{
    Console.WriteLine("{0}: {1}", grouping.Key, string.Join(", ", grouping));
} 
```

**输出**

> ```
> 2: aa, bb, cc
> 3: aaa, bbb, ccc
> 4: aaaa, bbbb, cccc 
> ```

### 将一定长度的所有单词放在一个`List`

```
List<String> list3 = lookup[3].ToList(); 
```

### 按键排序

*（请注意，这些将返回`IOrderedEnumerable<T>`，因此不再可以通过密钥访问）*

```
var orderedAscending = lookup.OrderBy(grouping => grouping.Key);
var orderedDescending = lookup.OrderByDescending(grouping => grouping.Key); 
```

* * *

原始答案 - 请*不要这样做*（性能不佳，代码混乱）：

```
string input = " aa aaa aaaa bb bbb bbbb cc ccc cccc cccc bbb bb aa ";
Dictionary<int, string[]> results = new Dictionary<int, string[]>();
var grouped = input.Trim().Split().Distinct().GroupBy(s => s.Length)
    .OrderBy(g => g.Key); // or: OrderByDescending(g => g.Key);
foreach (var grouping in grouped)
{
    results.Add(grouping.Key, grouping.ToArray());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-07T20:40:44.497

首先，让我们声明一个可以保存长度以及单词列表的类

```
public class WordList
{
    public int WordLength { get; set; }
    public List<string> Words { get; set; }
} 
```

现在，我们可以用

```
string input = " aa aaa aaaa bb bbb bbbb cc ccc cccc ";
string[] words = input.Trim().Split();
List<WordList> list = words
    .GroupBy(w => w.Length)
    .OrderBy(group => group.Key)
    .Select(group => new WordList { 
        WordLength = group.Key, 
        Words = group.Distinct().OrderBy(s => s).ToList() 
    })
    .ToList(); 
```

这些列表分别按长度和 aphabetally 排序。

* * *

结果

![在此处输入图像描述](../Images/236618c53ecb210777f0d32b589ab6d4.png)

例如

```
list[2].WordLength ==> 4
list[2].Words[1] ==> "bbbb" 
```

* * *

### 更新

如果需要，您可以立即处理结果，而不是将其放入数据结构中

```
string input = " aa aaa aaaa bb bbb bbbb cc ccc cccc ";

var query = input
    .Trim()
    .Split()
    .GroupBy(w => w.Length)
    .OrderBy(group => group.Key);

// Process the result here
foreach (var group in query) {
    // group.Key ==> length of words
    foreach (string word in group.Distinct().OrderBy(w => w)) {
       ...
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T20:42:48.657

您可以使用 Linq GroupBy

**编辑** 现在我应用了 Linq 来生成你想要输出的字符串列表。

**edit2** 应用了多个输入，单个输出，就像在编辑的问题中一样。这只是 Linq 中的一个 Distinct 调用

```
string input = " aa aaa aaaa bb bbb bbbb cc ccc cccc ";

var list = input.Split(' ');

var grouped = list.GroupBy(s => s.Length);

foreach (var elem in grouped)
{
    string header = "List " + elem.Key + ": ";
    // var line = elem.Aggregate((workingSentence, next) => next + ", " + workingSentence);

    // if you want single items, use this
    var line = elem.Distinct().Aggregate((workingSentence, next) => next + ", " + workingSentence);
    string full = header + " " + line;
    Console.WriteLine(full);
}

// output: please note the last blank in the input string! this generates the 0 list
List 0:  ,
List 2:  cc, bb, aa
List 3:  ccc, bbb, aaa
List 4:  cccc, bbbb, aaaa 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T21:13:39.733

有点冗长的解决方案，但确实在字典中得到了结果

```
class Program
    {
        public static void Main()
        {
            Print();
            Console.ReadKey();
        }

        private static void Print()
        {
            GetListOfWordsByLength();

            foreach (var list in WordSortedDictionary)
            {
                list.Value.ForEach(i => { Console.Write(i + ","); });
                Console.WriteLine();
            }
        }

        private static void GetListOfWordsByLength()
        {
            string input = " aa aaa aaaa bb bbb bbbb cc ccc cccc ";

            string[] inputSplitted = input.Split(' ');

            inputSplitted.ToList().ForEach(AddToList);
        }

        static readonly SortedDictionary<int, List<string>> WordSortedDictionary = new SortedDictionary<int, List<string>>();

        private static void AddToList(string s)
        {
            if (s.Length > 0)
            {
                if (WordSortedDictionary.ContainsKey(s.Length))
                {
                    List<string> list = WordSortedDictionary[s.Length];
                    list.Add(s);
                }
                else
                {
                    WordSortedDictionary.Add(s.Length, new List<string> {s});
                }
            }
        }
    } 
```

# android - 将文件内容添加到 ArrayList；安卓

> ID：11378341
> 
> 赞同：0
> 
> 时间：2012-07-07T20:20:11.370
> 
> 标签：android, file-io

我想要完成的是逐行读取文件并将每一行存储到 ArrayList 中。这应该是一个如此简单的任务，但我一直遇到很多问题。起初，当它被保存回文件时，它正在重复这些行。另一个似乎经常发生的错误是它跳过了尝试但没有捕获异常？我尝试了几种技术，但没有运气。如果您有任何建议或无论如何可以提供帮助，将不胜感激。谢谢

当前代码：

```
try{
    // command line parameter
    FileInputStream fstream = new FileInputStream(file);
    // Get the object of DataInputStream
    DataInputStream in = new DataInputStream(fstream);
    BufferedReader br = new BufferedReader(new InputStreamReader(in));
    String strLine;

    while ((strLine = br.readLine()) != null)   {
        fileList.add(strLine);
    }
    //Close the input stream
    in.close();
} catch (Exception e){//Catch exception if any
    Toast.makeText(this, "Could Not Open File", Toast.LENGTH_SHORT).show();
}
fileList.add(theContent);

//now to save back to the file
try {
    FileWriter writer = new FileWriter(file); 
    for(String str: fileList) { 
        writer.write(str);
        writer.write("\r\n");
    }
    writer.close();
} catch (java.io.IOException error) {
    //do something if an IOException occurs.
    Toast.makeText(this, "Cannot Save Back To A File", Toast.LENGTH_LONG).show();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:36:17.370

有一个非常简单的替代方法可以替代您对类所做的操作`Scanner`：

```
Scanner s = new Scanner(new File("filepath"));
ArrayList<String> list = new ArrayList<String>();
while (s.hasNext()){
    list.add(s.next());
}
s.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:37:16.793

为什么在 try/catch 之后有 fileList.add(theContent) ？我不明白这有什么意义。**删除该行，看看它是否有帮助。**

例如，我刚刚在我的本地机器上测试了这段代码（不是android，但应该是一样的）

```
import java.io.*;
import java.util.ArrayList;
class FileRead 
{
 public static void main(String args[])
  {
  ArrayList<String> fileList = new ArrayList<String>();
  final String file = "textfile.txt";
  final String outFile = "textFile1.txt";
  try{
      FileInputStream fstream = new FileInputStream(file);
      DataInputStream in = new DataInputStream(fstream);
      BufferedReader br = new BufferedReader(new InputStreamReader(in));
      String strLine;

      //Read File Line By Line
      while ((strLine = br.readLine()) != null)   {
      // Print the content on the console
        fileList.add(strLine);
      }
      //Close the input stream
      in.close();
    } catch (Exception e){//Catch exception if any
        System.err.println("Error: " + e.getMessage());
    }

   try {
        FileWriter writer = new FileWriter(outFile); 
        for(String str: fileList) { 
          writer.write(str);
          writer.write("\r\n");
        }
        writer.close();
    } catch (java.io.IOException error) {
        System.err.println("Error: " + error.getMessage());
    }
  }
} 
```

在我运行这个之后，这两个文件没有任何区别。所以我的猜测是这条线可能与它有关。

# php - 更快地抓取页面 [PHP]

> ID：11378347
> 
> 赞同：1
> 
> 时间：2012-07-07T20:20:57.923
> 
> 标签：php, web-crawler

我有一个关于在 PHP 中抓取网页的小问题。我必须在一个大型 eshop 上抓取大约 90 000 种产品。我在 PHP 中尝试过，但一个产品大约需要 2-3 秒，这很糟糕。任何提示，如何更快地做到这一点？也许是 C++ 多线程版本？但是 HTTP 请求的时间呢？我的意思是，它是否是 PHP 的限制？感谢您的小费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:25:35.690

这是一个非常模糊的问题。当你对你的代码进行基准测试时，最慢的部分是什么？是网络传输时间吗？使用不同的语言（或多个线程）不会改变这一点。

是花时间解析页面吗？你是怎么做到的？如果您使用 XML 库来解析整个 DOM，您是否可以只查找关键字（甚至是正则表达式）而摆脱困境？这不太精确（在某种意义上也不太正确），但也许更快。

您使用什么算法进行分析？其他数据结构会提供更好的性能吗？举一个简单的例子，如果您花费大量时间迭代一个数组，那么哈希映射可能更合适。

PHP 可以在多个进程中运行。如果您一次启动脚本的多个实例（在不同的页面上）会发生什么？总时间会减少吗？

最终，您已经描述了一个非常普遍的问题，因此我无法提供非常具体的解决方案，但是 PHP 不适合此任务并没有内在的原因。当您确定了慢的原因（无论您使用什么语言），您应该能够更准确地解决如何解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:25:27.137

我认为这不是 PHP 问题，但可能取决于连接速度/计算机速度。不过，我从来没有遇到过 PHP/cURL 的速度问题。

只需执行多个线程（即一次多个连接），我建议您使用 cURL 但这只是因为我熟悉它。

这是我用于使用 cURL 进行多线程抓取的指南：http: [//semlabs.co.uk/journal/object-oriented-curl-class-with-multi-threading](http://semlabs.co.uk/journal/object-oriented-curl-class-with-multi-threading)

要非常小心，不要意外导致脚本出现拒绝服务的情况。但我敢肯定你已经摆脱了这种可能性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T20:46:40.267

你有 99% 的可能性**PHP 不是问题**。它是 eshop 网络服务器或任何其他网络延迟。

我肯定知道这一点，因为我已经这样做了好几个月了，即使你的代码有很多正则表达式，在 PHP 中数据抓取也非常快。

加快速度的解决方案？**使用命令行爬虫预先缓存所有网站，**因为磁盘空间很便宜。curl 可以做到这一点，[httrack](https://en.wikipedia.org/wiki/HTTrack)也可以。它将比 PHP 进行爬取更快、更稳定。

然后让 PHP 单独进行解析，你会看到 PHP 每分钟吞下几十页，希望这会有所帮助:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T20:34:14.930

如果您的程序运行缓慢，我的建议是在其上运行分析器，并分析它运行缓慢的原因。

该建议适用于任何语言，但对于 PHP，您需要的分析器软件称为[xDebug](http://xdebug.org/)。

这是一个 PHP 扩展，因此您需要将其安装到您的服务器中。如果您在 ISP 的服务器上运行，那么您可能无权执行此操作，但您始终可以在本地 PC 上使用 PHP 安装它并在那里运行您的测试。

安装 xDebug 后，打开 PHP.ini 中的分析功能（请参阅 xDebug 文档以获取相关说明），然后运行您的程序。然后它将生成分析器文件，可用于分析程序在做什么。

下载[KCacheGrind](http://sourceforge.net/projects/precompiledbin/)以执行分析。这将生成调用树信息，准确显示程序运行时发生的情况，以及每个函数调用花费了多长时间。

使用此信息，您可以查找运行缓慢的函数调用，并找出正在发生的事情。通常，代码慢的原因是某些东西的编写方式效率低下；xDebug 将帮助您找到它。

希望有帮助。

# android - 在哪里可以找到 ImageLoader？

> ID：11378350
> 
> 赞同：1
> 
> 时间：2012-07-07T20:21:24.080
> 
> 标签：android

我正在尝试通过 sephiroth74 使用[它](https://github.com/sephiroth74/ImageViewZoom)，但是，我遇到了一些麻烦。

到目前为止，这是我的代码：[https ://gist.github.com/3067961](https://gist.github.com/3067961)

我在下面有一条红线：

*   loadFromUri（第 57 行）：“ImageLoader 类型的 loadFromUri(ImageZoomActivity, String, int, int) 方法未定义”
*   并且，setImageBitmapReset（第 58 行）：“ImageViewTouch 类型的方法 setImageBitmapReset(Bitmap, int, boolean) 未定义”

我不确定在哪里可以找到 ImageLoader 类，所以我下载了（http://code.google.com/p/libs-for-android/wiki/ImageLoader）一个。但是，这是错误的类，因为这两种方法显然不存在。

有人可以帮我找到正确的课程吗？我已经到处找了！

谢谢

# facebook - Grails Facebook 插件 - 如何处理无效用户

> ID：11378351
> 
> 赞同：2
> 
> 时间：2012-07-07T20:21:46.063
> 
> 标签：facebook, grails, plugins, filter

我正在使用出色的[Grails Facebook 插件](http://grails.org/plugin/spring-security-facebook)，一切正常。问题在于我提供了另一种身份验证方式：表单身份验证。如果系统中已经有用户使用 Facebook 用户的电子邮件地址，我想优雅地提醒用户这一事实。我不知道该怎么做，因为我被埋在从过滤器调用的服务中。理想情况下，我想在登录页面上显示一条错误消息。这可能吗？

在我的里面`FacebookAuthService`：

```
 FacebookUser create(FacebookAuthToken token) {
    log.info("Create domain for facebook user $token.uid")

    Facebook facebook = new FacebookTemplate(token.accessToken.accessToken)
    FacebookProfile fbProfile = facebook.userOperations().userProfile
    String email = fbProfile.getEmail() 

    String emailMatch = User.findByEmailAddress(email)

    if(emailMatch != null)
        throw new RuntimeException("username is bad!!") 
```

我想向用户显示此错误消息，而不是一路涓涓异常。我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T04:03:03.630

您可以将此消息放入 flash 对象中：

```
def grailsWebRequest = WebUtils.retrieveGrailsWebRequest()
def flash = grailsWebRequest.attributes.getFlashScope(request)
flash.error = "username is bad!!!"
return null // Facebook filter will skip authorization at this case 
```

此外，`RuntimeException`最好使用`AuthenticationException`. 在这种情况下，您可以配置 Spring Security 以在异常后重定向到特殊 url。只需放入`Config.groovy`：

```
grails.plugins.springsecurity.failureHandler.exceptionMappings = [
   'MyException': '/usernameIsBad'
] 
```

# c# - 改变窗户风格？

> ID：11378352
> 
> 赞同：-1
> 
> 时间：2012-07-07T20:21:51.427
> 
> 标签：c#, winforms, visual-studio, nonclient-area

如何让我的应用看起来像 chrome 窗口？没有标题文字和非常纤细的边框。或者像没有边框（或填充排序）的 spotify。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:26:30.763

将`FormBorderStyle`表单的属性设置为`None`。

# c# - 如何在使用 Linq-to-sql 完成插入之前锁定表以防止写入操作

> ID：11378357
> 
> 赞同：4
> 
> 时间：2012-07-07T20:23:09.463
> 
> 标签：c#, linq-to-sql

我正在研究一个拍卖系统，我试图确保我不会受到影响的问题之一是两个人在同一时间为同一项目出价的情况。

为此，我需要锁定表格，获取当前项目的最高出价，确保输入的出价大于该出价，在表格中添加新的出价条目，然后解锁表格。

我需要锁定它，这样第二个网络服务器就不会在我检查最高出价和我将新出价插入表格之间触发出价插入，因为这会导致数据问题。

如何使用 Linq-to-sql 完成此任务？

请注意，我不知道 transactionscopes 是否可以做到这一点，但我不能使用它们，因为由于我们的 webfarm 设置，它们往往会触发分布式事务，而我不能使用分布式事务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T23:11:59.363

在纯 Linq 中实施解决方案似乎存在一些障碍：

*   你绝对应该避免表锁

表锁会使得在处理一个单一的投标期间不可能对多个项目进行投标，从而严重损害性能

*   Linq to SQL 似乎不支持悲观锁定

如关于SO的其他答案所述。

如果您的代码中不能有事务，我建议您执行以下过程：

*   为您的操作生成 GUID
*   使用 guid 伪锁定项目的记录：

    ```
    UPDATE Items SET LockingGuid = @guid 
    WHERE ItemId = @ItemId and LockingGuid IS NULL

    SELECT @recordsaffected = @@ROWCOUNT 
    ```

*   如果@@rowcount == 1，则锁定成功

*   执行您的出价操作
*   将记录更新回 LockingGuid = NULL

*   如果锁定失败，则将失败提交给 .Net 客户端，或者使用[WAITFOR](https://stackoverflow.com/a/664907/21336)进行忙碌等待。

您应该实施适当的异常处理，以便项目记录不会被垂死或失败的进程无限期地锁定，可能通过添加一个存储锁定发生的时间戳的日期时间列，并清理孤立的锁。

如果您的架构允许单独的后端操作，您可能需要查看[CQRS](http://en.wikipedia.org/wiki/Command-query_separation)和[事件](http://martinfowler.com/eaaDev/EventSourcing.html)溯源来处理此类投标操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T22:25:17.150

当此处理发生时，您可以使用单独的表来存储信息。例如，您的第二个表可能类似于：

表名：
ItemProcessing

列：
ItemId (int)
ProcessingToken (guid)

当一个进程想要检查当前的出价时，它会将项目的 ID 和一个令牌/guid 写入 ItemProcessing 表。这告诉其他进程当前正在检查该项目。如果 ItemProcessing 表中已经有该项目的行，则其他进程必须等待或中止。原始过程完成后，它会删除令牌（将其设置为 null），或从 ItemProcessing 中完全删除该行。然后其他进程知道他们可以处理该项目。

当然，您需要一种方法来确保两个进程不会同时写入此处理表。您可以通过在 ProcessingToken 为空的表中插入来完成此操作。如果另一个表刚刚击败了一个进程，则第二个进程将无法插入，因为 ProcessingToken 将存在。

虽然不是一个完整的解决方案，但详细地说，这是基本思想。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T23:21:45.217

您可以手动开始事务并将该事务传递给 DataContext。

[http://geekswithblogs.net/robp/archive/2009/04/02/your-own-transactions-with-linq-to-sql.aspx](http://geekswithblogs.net/robp/archive/2009/04/02/your-own-transactions-with-linq-to-sql.aspx)

我认为手动控制连接的打开和关闭也是必要的，以避免不必要的升级到分布式事务。看起来 DataContext 实际上会以自己的方式有时会尝试打开两个连接，从而导致对分布式事务的提升。

# objective-c - 什么时候真正可以访问 NSManagedObject？

> ID：11378363
> 
> 赞同：1
> 
> 时间：2012-07-07T20:24:48.303
> 
> 标签：objective-c, core-data, nsobject, nsobjectcontroller

我有个问题。

我有一个名为“mapController”的 NSObjectController，我想在创建对象时设置一些默认值。**按照文档的建议，我在文档的windowControllerDidLoadNib**方法中执行此操作。但是……</p>

```
if (![mapController content]){   // No map defined yet.
    [mapController add: self];   // This should create the instance.

    NSLog(@"%@",[mapController content]); // Gives NULL. 
```

我试过了：

```
 BOOL ok = [mapController fetchWithRequest:nil merge:NO error:nil];
    NSLog(@"%@",[mapController content]); // Gives NULL. 
```

mapController 的内容在核心数据“便笺簿”中，但我无法访问它。我必须像这样设置它的一个属性：

```
 [[mapController content] setValue:[matrix colorReference] forKey:@"mapData"]; 
```

这没有错误，文件被标记为已更改，但我测试了值：

```
 NSLog(@"%@",[mapController content]); // Gives NULL. 
```

什么时候控制器的内容真的在这里？屏幕上出现了一些东西，但是……实际上是什么？阅读文档对我没有帮助……</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:10:00.860

好的，我在文档中找到了答案：

> **add：**创建一个新对象并将其设置为接收者的内容对象。
> 
> 讨论
> 
> 创建适当实体（由 entityName 指定）或类（由 objectClass 指定）的新对象——参见 newObject——并使用 addObject: 将其设置为接收者的内容对象。
> 
> 特别注意事项
> 
> 从 Mac OS X v10.4 开始**，此方法的结果被推迟到**runloop 的下一次迭代，以便错误呈现机制可以以表格形式提供反馈。

这就是为什么

```
[[mapController content] setValue:[matrix colorReference] forKey:@"mapData"]; 
```

在应用程序的其他地方调用时工作正常。几次迭代之后……</p>

嗯……也许这篇文章会为你节省几个小时，你可以用来睡得更久。

问候，

伯纳德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T09:09:37.440

我不认为它是你的 mapController，我认为它是你的 NSLog。尝试这个：

```
NSLog(@"%@", mapController); 
```

还可以尝试从内容中获取简单数据，例如 CGColorRef 的浮点值，以便您可以使用其他格式化程序，例如 %f。

我会对此进行测试，但我似乎无法创建 NSObjectController 的实例，因为它是一个未声明的标识符。它是在什么框架中定义的？你必须#import什么吗？

# java - 将 SQL 连接传递给 ActionListener（线程）

> ID：11378364
> 
> 赞同：0
> 
> 时间：2012-07-07T20:25:11.413
> 
> 标签：java, sql, swing, actionlistener

如何将 SQL 连接传递给 Action Listener。我想要一个无限循环，它会休眠 100 毫秒。假设循环的每次迭代都查询数据库。摆动计时器是最好的方法吗？如果是这样，我如何将连接传递给动作侦听器。如果没有，有人可以建议如何做到这一点。非常感谢。

代码：

```
public static void main(String[] args) throws InterruptedException {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    AdminManager frame = new AdminManager();
                    frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }

            }
        });

        BoneCP connectionPool = null;
        Connection connection = null;

        try {
            Class.forName("com.mysql.jdbc.Driver");
        } catch (Exception e) {
            e.printStackTrace();
            return;
        }

        try {
            // setup the connection pool
            BoneCPConfig config = new BoneCPConfig();
            config.setJdbcUrl("jdbc:mysql://192.162.0.0");
            config.setUsername("root"); 
            config.setPassword("");
            connectionPool = new BoneCP(config); // setup the connection pool

            connection = connectionPool.getConnection(); // fetch a connection

            if (connection != null){
                System.out.println("Connection successful!");
            }

        } catch (SQLException e) {
            e.printStackTrace();
        } finally {
            if (connection != null) {
                try {
                    connection.close();
                } catch (SQLException e) {
                    e.printStackTrace();
                }
            }
        }

        // Define listner
        ActionListener taskPerformer = new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent evt) {
                //...Perform a task...

                String sql = "SELECT * table;";
                Statement st = connection.createStatement();
                ResultSet rs = st.executeQuery(sql);
                while(rs.next()) {
                    String symbol = rs.getString("name");
                    System.out.println(symbol);
                }

            }
            };
        Timer timer = new Timer( 100 , taskPerformer);
        timer.setRepeats(true);
        timer.start();

        Thread.sleep(1000);

        //connectionPool.shutdown(); // shutdown connection pool.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:10:26.657

不要让`javax.swing.Timer`类周期性地执行一个非 Swing 任务。相反，使用[`ScheduleExecutorService`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html),

```
ScheduledExecutorService exec = Executors.newSingleThreadScheduledExecutor();
exec.schedule(new Runnable(){
    @Override
    public void run(){
        // query database
    }
}, 0, 100, TimeUnit.MILLISECONDS); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T02:15:42.840

如果后台任务必须不断更新 Swing 组件，请使用`SwingWorker`定期`process()`更新组件的模型。在此[示例](https://sites.google.com/site/drjohnbmatthews/randomdata)中，使用`JTextArea`从 H2 数据库获得的数据更新 a。

# symfony1 - Symfony sfWidgetFormInputFile 删除了我的文件

> ID：11378371
> 
> 赞同：0
> 
> 时间：2012-07-07T20:25:44.157
> 
> 标签：symfony1, upload, image, overwrite

很抱歉有很多问题，但我是 Symfony 的新手。我做了一个表格，一切都很好。我有几个图片字段（图片1、图片2、图片3等）。我使用了 te sfWidgetFormInputFile 并且一切都很好。它将文件上传到需要的位置，并给它一个唯一的名称。

我遇到的问题是这些字段在 mySQL 中设置为具有默认值“no-pic.png”，因此如果用户不上传图片，它仍然会在帖子中显示一些内容。但是每次有人上传图片时，它都会删除我的 no-pic.png 文件，并且没有图片的帖子会显示为空白方块。我在想这是因为它在上传新图片之前设置为“删除以前的图片”，以减少服务器上多余的未使用图片。

我想知道是否有办法让它在从文件夹中删除它之前检查该值是否为“no-pic.png”。如果有帮助，这是我在 form.class 文件中使用的代码。

```
 $this->widgetSchema['picture1'] = new sfWidgetFormInputFile(array('label' => 'Pictures', ));
  $this->validatorSchema['picture1'] = new sfValidatorFile(array('required' => false, 'path' => sfConfig::get('sf_upload_dir').'/car', 'mime_types' => 'web_images', ));
  $this->widgetSchema['picture1'] = new sfWidgetFormInputFileEditable(array(
    'label' => 'Pictures',
    'file_src' => '/uploads/car/'.$this->getObject()->getPicture1(),
    'is_image' => true,
    'edit_mode' => !$this->isNew(),
    'template' => '<div>%file%<br />%input%<br />%delete%%delete_label%</div>',
    ));
  $this->validatorSchema['picture_delete'] = new sfValidatorPass(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:44:39.403

仅供参考这里是我使用的代码。

```
$this->setWidget('logo_image', new sfWidgetFormInputFileEditable(array(
  'file_src'  => 'uploads/logos/'.$this->getObject()->getFilename(),
  'edit_mode' => !$this->isNew()
)));

$validatorOptions = array(
  'max_size'           => 1024*1024*10,
  'path'               => sfConfig::get('sf_upload_dir').'/logos',
  'mime_type_guessers' => array(),
  'required'           => false
);

if ($this->isNew())
{
  $validatorOptions['required'] = true;
}

$this->setValidator('logo_image', new sfValidatorFile($validatorOptions));
$this->setValidator('logo_image_delete', new sfValidatorString(array('required' => false))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T01:59:41.800

我找到了解决方法。我检查了页面是否设置为 no-pic.png，然后它在另一个位置显示 no-pic.png。这样当它上传图片时，它不会删除它。:) 感谢您的帮助。

# java - XPath normalize-space() 返回标准化字符串序列

> ID：11378372
> 
> 赞同：6
> 
> 时间：2012-07-07T20:25:47.693
> 
> 标签：java, xml, xpath

我需要使用 XPath 函数 normalized-space() 来规范化我想从 XHTML 文档中提取的文本：http: [//test.anahnarciso.com/clean_bigbook_0.html](http://test.anahnarciso.com/clean_bigbook_0.html)

我正在使用以下表达式：

```
//*[@slot="address"]/normalize-space(.) 
```

它在我用来测试 XPath 表达式的工具 Qizx Studio 中完美运行。

```
 let $doc := doc('http://test.anahnarciso.com/clean_bigbook_0.html')
    return $doc//*[@slot="address"]/normalize-space(.) 
```

这个简单的查询返回一个`xs:string`.

```
144 Hempstead Tpke
403 West St
880 Old Country Rd
8412 164th St
8412 164th St
1 Irving Pl
1622 McDonald Ave
255 Conklin Ave
22011 Hempstead Ave
7909 Queens Blvd
11820 Queens Blvd
1027 Atlantic Ave
1068 Utica Ave
1002 Clintonville St
1002 Clintonville St
1156 Hempstead Tpke
Route 49
10007 Rockaway Blvd
12694 Willets Point Blvd
343 James St 
```

现在，我想在我的 Java 代码中使用前面的表达式。

```
String exp = "//*[@slot=\"address"\"]/normalize-space(.)";
XPath xpath = XPathFactory.newInstance().newXPath();
XPathExpression expr = xpath.compile(exp);
Object result = expr.evaluate(doc, XPathConstants.NODESET); 
```

但最后一行抛出异常：

`Cannot convert XPath value to Java object: required class is org.w3c.dom.NodeList; supplied value has type xs:string`

显然，我应该改变`XPathConstants.NODESET`一些东西；我试过`XPathConstants.STRING`了，但它只返回序列的第一个元素。

如何获得类似字符串数组的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T21:01:20.097

您的表达式在 XPath 2.0 中有效，但在 XPath 1.0（在 Java 中使用）中是非法的 - 它应该是`normalize-space(//*[@slot='address'])`.

无论如何，在 XPath 1.0 中，当`normalize-space()`在节点集上调用时，只会采用第一个节点（按文档顺序）。

为了做你想做的事，你需要使用兼容 XPath 2.0 的解析器，或者遍历生成的节点集并`normalize-space()`在每个节点上调用：

```
XPath xpath = XPathFactory.newInstance().newXPath();
XPathExpression expr;

String select = "//*[@slot='address']";
expr = xpath.compile(select);
NodeList result = (NodeList)expr.evaluate(input, XPathConstants.NODESET);

String normalize = "normalize-space(.)";
expr = xpath.compile(normalize);

int length = result.getLength();
for (int i = 0; i < length; i++) {
    System.out.println(expr.evaluate(result.item(i), XPathConstants.STRING));
} 
```

...输出您给定的输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T20:51:25.680

这取决于您使用的 XPath 版本。看看这篇文章，希望它能回答你的问题：[是否可以将 normalize-space 应用于 XPath 表达式找到的所有节点？](https://stackoverflow.com/questions/3359512/is-it-possible-to-apply-normalize-space-to-all-nodes-xpath-expression-finds)祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-07T21:00:47.560

正如您所注意到的，XPath 2.0 表达式`//*[@slot="address"]/normalize-space(.)`返回一个字符串序列。JAXP 类不支持这种返回类型`XPathConstants`，因为 JAXP 接口不是为支持 XPath 2.0 而设计的。

这让您有两个选择：

1.  使用具有 XPath 2.0 的[本机接口](http://www.saxonica.com/documentation/xpath-api/s9api-xpath.xml)或可以[将序列转换为 JAXP 支持的返回类型的 XPath 2.0 处理器](http://www.saxonica.com/documentation/javadoc/net/sf/saxon/xpath/XPathExpressionImpl.html#evaluate%28java.lang.Object,%20javax.xml.namespace.QName%29)
2.  仅使用 XPath 1.0 表达式。例如，在您的情况下，您可以简单地选择目标节点：

    ```
    //*[@slot="address"] 
    ```

    然后迭代生成的节点集，将结果收集到一个数组或`List`.

请注意，区分用于*评估*表达式的处理器和用于启动评估的*接口非常重要。*

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-07T21:01:07.197

**表达式**：

```
//*[@slot="address"]/normalize-space(.) 
```

在语法上是合法的（并且实际上很有用）XPath 2.0 表达式。

在 XPath 1.0 中，相同的表达式在语法上是不合法的——定位步骤不允许作为函数调用。

事实上，不可能编写一个*XPath* 1.0 表达式，其求值结果是所需的字符串集。

您需要在程序中使用实现 XPath 2.0 的产品——例如 Saxon 9.x。

# xaml - 模板中的 WinRT Combobox 奇怪行为

> ID：11378373
> 
> 赞同：0
> 
> 时间：2012-07-07T20:26:02.380
> 
> 标签：xaml, combobox, windows-8, microsoft-metro, windows-runtime

在 Win 8 Release Preview 下运行的 WinRT 应用程序中的组合框有一个奇怪的问题。这是一个代码片段：

```
<ListView.ItemTemplate>
     <DataTemplate>
         <Grid>
              <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>
              <TextBox Grid.Column="0" Text="{Binding Name, Mode=TwoWay}" VerticalAlignment="Center"/>
              <ComboBox Grid.Column="1" ItemsSource="{Binding Source={StaticResource evtTypeRes}}" SelectedValuePath="ID" DisplayMemberPath="Name" SelectedValue="{Binding EventTypeID, Mode=TwoWay}" VerticalAlignment="Center"/>
          </Grid>
     </DataTemplate>
</ListView.ItemTemplate> 
```

ListView 由 ObservableCollection 列表支持，并且项目实现 INotifyPropertyChanged。问题是，当我更改屏幕中组合框的值时，该值不仅会更改特定行，而且会更改每一行（属性的设置器会在集合中的每个对象上调用）。文本框不是这种情况。这种奇怪行为的原因可能是什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T12:42:41.207

我找到了`IsSynchronizedWithCurrentItem`属性的用途：值`False`解决了我的问题。

# mysql - 显示表 MySQL 结果的别名

> ID：11378375
> 
> 赞同：7
> 
> 时间：2012-07-07T20:26:43.220
> 
> 标签：mysql, sql, list

在 MySQL 中执行 SHOW TABLES FROM *your_db_name_here*时，结果以*Tables_in_{your_db_name_here}*作为其索引。我想改变它，像这样：

```
SHOW TABLES as _tables FROM mydb; 
```

或类似的东西

```
SELECT Tables_in_mydb AS _tables FROM (SHOW TABLES FROM mydb); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-07T20:36:15.047

`INFORMATION_SCHEMA`与数据库交互通常更容易：

[http://dev.mysql.com/doc/refman/5.0/en/tables-table.html](http://dev.mysql.com/doc/refman/5.0/en/tables-table.html)

例子：

```
SELECT TABLE_NAME AS _tables 
FROM INFORMATION_SCHEMA.TABLES 
WHERE TABLE_SCHEMA = 'mydb' 
```

# iphone - 导航栏按钮的操作不起作用

> ID：11378378
> 
> 赞同：0
> 
> 时间：2012-07-07T20:27:51.503
> 
> 标签：iphone, objective-c, ios

我的代码：

```
-(void)loadView {
[super loadView];
self.informationButton = [[UIBarButtonItem alloc] initWithCustomView:[UIButton buttonWithType:UIButtonTypeInfoLight]];
}

- (void)viewDidLoad
{
[super viewDidLoad];
self.navigationItem.leftBarButtonItem = self.informationButton;
self.informationButton.target = self;
self.informationButton.action = @selector(showHelpInfo);
}

-(void)showHelpInfo {
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Test" 
                                                message:@"Test" 
                                               delegate:nil 
                                      cancelButtonTitle:@"cansel" 
                                      otherButtonTitles:nil, nil];
[alert show];
} 
```

然后我点击我的`informationButton`uialertview 不显示。有我的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:33:11.037

您的 UIButton 是现在调度动作和事件的东西，因为此时 UIBarButtonItem 只是它的容器。因此，当您单击该按钮时，是 UIButton 拦截了触摸事件。只需创建一个与 UIBarButtonItem 具有相同操作的 UIButton 对象。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UIButton *iButton = [UIButton buttonWithType:UIButtonTypeInfoLight];
    [iButton addTarget:self action:@selector(showHelpInfo) forControlEvents:UIControlEventTouchUpInside];
    self.informationButton = [[UIBarButtonItem alloc] initWithCustomView:iButton];
    self.navigationItem.leftBarButtonItem = self.informationButton;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:34:18.750

您需要将目标设置`UIButton`为`showHelpInfo`选择器...

# iphone - iPhone上的CSS输入按钮

> ID：11378380
> 
> 赞同：2
> 
> 时间：2012-07-07T20:28:26.543
> 
> 标签：iphone, css

我有这个网站[http://www.taranmarlowjewelry.com/?page_id=5](http://www.taranmarlowjewelry.com/?page_id=5)在右上角我有一个输入按钮，它在 iPhone 上看起来很奇怪，我不知道为什么。它变成了一个圆形/气泡状按钮。

这是输入按钮的 HTML

```
<input type="submit" id="button" name="button" class="searchBtn" value="GO"/> 
```

这是CSS

```
.searchBtn{
    background-color:#ffa18a;
    color:#FFF;
    height:31px;
    padding:0;
    width:32px;
    border:0;
    cursor:pointer;
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T15:23:29.240

我解决了我的问题，但像这样调整我的CSS......

```
.searchBtn{
    background-color:#ffa18a;
    color:#FFF;
    height:31px;
    padding:0;
    width:32px;
    border:0;
    cursor:pointer;
   -webkit-appearance: none;
} 
```

通过添加`-webkit-appearance: none;`按钮现在看起来不错的 iphone，这也适用于 iPad。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T18:39:20.473

如果您的网站上有很多不同的按钮，这是一个问题，请尝试：

```
input[type="button"], input[type="submit"], input[type="reset"] {
    -webkit-appearance: none;
} 
```

这应该重置所有输入按钮，而不会导致复选框和其他输入出现问题。保持 CSS 的其余部分保持原样。

考虑将 -moz-appearance 和 -ms-appearance 也设置为 none...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T21:11:11.973

如果您可以访问 Mac，您可以在 Safari 中打开开发人员工具并将浏览器置于 iPhone 模拟模式并尝试以这种方式进行调试。

# ruby-on-rails - 使用箭头键浏览数据库列？

> ID：11378382
> 
> 赞同：0
> 
> 时间：2012-07-07T20:28:27.120
> 
> 标签：ruby-on-rails

我是网络开发的新手。我现在要使用 rails 3 制作应用程序。我无法在索引页面中显示整个表格，因为列太多。我需要一种快速浏览整个数据库的方法。

我有下表：

```
 create_table "fields", :force => true do |t|
        t.string   "basin_name"
        t.string   "basin_type"
        t.string   "area"
        t.string   "prospect_name"
        t.string   "type_of_data_shore"
        t.string   "type_of_processing"
        t.string   "processing_agency_name"
        t.string   "seismic_investigation_number"
        t.string   "field_season"
        t.string   "block_name"
        t.string   "block_type"
        t.string   "sps_format"
        t.string   "input_media"
        t.string   "input_data_location"
        t.integer  "group_interval"
        t.integer  "shot_interval"
        t.string   "active_channels"
        t.decimal  "fold"
        t.decimal  "bin_size"
        t.string   "data_stage"
        t.string   "output_format"
        t.string   "output_media"
        t.string   "output_location"
        t.integer  "volume_of_data_size"
        t.string   "volume_of_data_dimensions"
        t.string   "volume_of_data_type"
        t.date     "date_of_start_of_processing"
        t.date     "date_of_completion_of_processing"
        t.text     "remarks"
        t.text     "problems_faced_and_solutions"
        t.text     "highlights_of_processing"
        t.datetime "created_at",                       :null => false
        t.datetime "updated_at",                       :null => false
        t.integer  "custom_id"
      end 
```

是否可以仅使用左右箭头键从一个字段的“显示”操作导航到另一个字段？并且列应该基于“custom_id”列出现（我也不知道javascript:(）

还是有更好的方法通过任何宝石来做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:28:15.307

如果我理解得很好，你只需要这个来显示动作，同时只显示一条记录。

如果是这样，您需要在显示操作中呈现一个大的 html，但一次只显示一小部分页面，并且在导航时，用户不应向服务器发出新请求。

```
<div id="field">
  <div id="field_basin_name">..basin_name..</div>
  <div id="field_basin_type" style="display:hidden">..basin_type..</div>
  <div id="field_area" style="display:hidden">..area</div>
  ..
</div> 
```

现在你需要一些 javascript，你需要检查当用户按右或左时显示的部分，隐藏显示的部分并显示相关的部分。

我会按照这个逻辑去。它不是真正的rails问题，它主要是javascript / html。

在我看来，与 rails 相关的最重要的事情是使用 show action 只渲染一次大型 html。Rails 部分应该很简单。否则会太复杂。

一旦你弄清楚如何处理这个问题，你会发现很多你可以使用的 css / js 化妆品。

编辑

如果这有帮助，您可以使用 attributes 方法迭代记录的列

```
<% object.attributes.each do |attribute| %>
  <div id="field_<%= attribute_name %>">..</div>
<% end %> 
```

# list - 如果选择了项目，则显示 appbar 按钮

> ID：11378383
> 
> 赞同：1
> 
> 时间：2012-07-07T20:28:33.737
> 
> 标签：list, xaml, microsoft-metro, appbar

我正在编写一个带有 appbar 和项目列表的应用程序。我想向应用程序栏添加一些按钮，这些按钮仅在选择列表项时才会出现。

那么，当列表项被选中时，如何在应用栏上显示一个附加按钮？

这是 Windows 8 Metro 风格的 C#/XAML 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T13:19:52.233

```
<AppBar x:Name="bottomAppBar" IsOpen="True" IsSticky="True"> 
```

...

```
private void itemGridView_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    if (itemGridView.SelectedItems.Count > 0)
    {
        nextButton.Visibility = Windows.UI.Xaml.Visibility.Visible;
    }
    else
    {
        nextButton.Visibility = Windows.UI.Xaml.Visibility.Collapsed;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T07:53:17.170

设置`AppBar.IsOpen`属性而不是`Visibility`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-29T12:44:45.383

创建附加的应用栏按钮并将其`Visibility`属性设置为`Collapsed`。在`SelectionChanged`列表的事件处理程序中，将按钮`Visibility`属性设置为`Visible`或`Collapsed`取决于列表项是被选择还是取消选择。

# php - PHP中的自定义排序数组

> ID：11378385
> 
> 赞同：0
> 
> 时间：2012-07-07T20:29:19.897
> 
> 标签：php, arrays, multidimensional-array

这是我的数组

```
Array
(
    [_id] => MongoId Object
        (
            [$id] => 4ff6e96bb0b4599016000006
        )

    [alias] => me
    [create] => 1341581675
    [name] => It's Me!
) 
```

我设置`[id] => 4ff6e96bb0b4599016000006`和取消设置`[_id]`

现在

```
Array
(
    [alias] => me
    [create] => 1341581675
    [name] => It's Me!
    [id] => 4ff6e96bb0b4599016000006 
) 
```

`[id]`什么是在顶部订购并`[create]`在之后订购的最佳方式`[name]`

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:46:11.283

而不是设置`$yourArray['id'] = '4ff6e9...0006'`，你可以（ab）使用[`array_merge()`](http://php.net/manual/en/function.array-merge.php)来添加它：

```
$yourArray = array_merge(array('id'=>'4ff6e9...006'), $yourArray); 
```

这应该基本上将您的原始数组附加到上面仅包含键“id”的小数组中。

# python - 多处理和内存问题

> ID：11378388
> 
> 赞同：0
> 
> 时间：2012-07-07T20:29:45.410
> 
> 标签：python, python-2.7

所以我有一个脚本可以读取一个包含 700,000 行左右的文件。对于每一行，它返回从该行计算的值列表。在我尝试使用多处理之前，我使用了一个 for 循环并将每行的值增加到一个全局变量（因为最后我是求和）。不幸的是，对于多处理模块，我不能只向全局变量添加一些东西，因为它们是独立的进程。相反，我让每个进程返回我所追求的值，并使用 Pool.map 创建一个巨大的返回值列表。然后，我可以遍历该列表并获得我想要的总和。这是非常占用内存的。有什么建议么？我意识到这可能很难阅读，因此，如果需要，我可以澄清一下。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:33:38.400

在每个过程中保留一个累加器，然后最后将所有这些累加器相加。每个进程只需要存储一个值。

# c# - 从经典 ASP 转移到 ASP.Net 的困惑

> ID：11378390
> 
> 赞同：1
> 
> 时间：2012-07-07T20:30:03.853
> 
> 标签：c#, asp.net

可能听起来有点愚蠢，但我对从经典 ASP 到 ASP.net 的迁移感到困惑。

在查看了该语言的两种不同变体（VB 或 C#）之后，我决定使用 C#。我正在阅读另一个 StackOverflow 答案，该答案解释了从 VBScript 迁移到 C# 更容易从 VBScript 学习。

所以，我以为我会去 W3schools 学习一些 C# 基础知识，但是当我得到选择时感到困惑；网页、MVC 或 Web 表单。有人可以解释一下差异，哪一个最适合我？

多年来我一直在使用经典的 ASP/VBScript 进行编码，构建了各种 Web 应用程序，有大有小，我不想使用 Visual Studio 之类的任何软件，我只想写代码。我目前仅使用 Dreamweaver 进行编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:32:37.180

对于从经典 ASP 到 .NET Web 平台的迁移，我建议使用 ASP.NET/MVC。

WebForms 是一种抽象，旨在使 VB6 程序员能够适应在 Web 上工作，它是一个非常容易泄漏的抽象。它使用事件模型，而这种想法`PostBacks`根本不是网络真正运作方式的一部分。它有一些起初并不熟悉或没有多大意义的限制（例如，您只能在页面上拥有一个表单）。因此，MVC 将更加熟悉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:37:46.650

我建议您观看asp.net 官方开发人员的[此视频](http://www.asp.net/web-forms/videos/migrating/migrating-from-classic-asp-to-aspnet)以及[迁移](http://www.asp.net/web-forms/videos/migrating)部分的其他相关视频

这是另一个帮助程序员[选择编程模型](http://www.asp.net/web-forms/videos/how-do-i/choosing-the-right-programming-model)（webforms、网页或 mvc、工具等）的好视频

虽然 w3schools 有几个很好的例子，但它有几个不一致的地方以及不正确的信息。w3schools 的不错替代品包括[MDN](https://developer.mozilla.org/en-US/)和[IE Reference API](http://msdn.microsoft.com/en-us/library/ie/hh772384%28v=vs.85%29.aspx)（顾名思义，它针对 IE，当某些东西在其他浏览器中有效但在 IE 中无效时，它是一个很好的参考）

# c++ - 使用 sys/mount.h 挂载 ISO

> ID：11378392
> 
> 赞同：4
> 
> 时间：2012-07-07T20:30:09.657
> 
> 标签：c++, linux, system, mount

我正在尝试在 linux 的 C++ 程序中挂载 ISO 文件

我知道实现此目的的 linux 命令，即 mount -o loop ~/Test.iso /mnt/myISO

但是 mount(2) 手册页说明了以下安装原型：

```
int mount(const char *source, const char *target,
const char *filesystemtype, unsigned long mountflags,
const void *data); 
```

如何在此处指定循环选项？

--

此外，一般来说，在 Linux 编程中使用来自 C++ 的系统 shell 调用来实现诸如此类的任务是否是好的（/可接受的）实践？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T21:44:46.097

小例子

```
#include <sys/mount.h>
#include <linux/loop.h>
#include <fcntl.h>

int main()
{
    int file_fd, device_fd;

    file_fd = open("./TVM_TOMI1.iso", O_RDWR);
    if (file_fd < -1) {
        perror("open backing file failed");
        return 1;
    }
    device_fd = open("/dev/loop0", O_RDWR);
    if (device_fd < -1) {
        perror("open loop device failed");
        close(file_fd);
        return 1;
    }
    if (ioctl(device_fd, LOOP_SET_FD, file_fd) < 0) {
        perror("ioctl LOOP_SET_FD failed");
        close(file_fd);
        close(device_fd);
        return 1;
    }
    close(file_fd);
    close(device_fd);
    mount("/dev/loop0","/mnt/iso","iso9660",MS_RDONLY,"");
} 
```

upd：卸载后你需要自由循环：

```
device_fd = open("/dev/loop0", O_RDWR);
...
if (ioctl(device_fd, LOOP_CLR_FD, 0) < 0) {
    perror("ioctl LOOP_CLR_FD failed");
    return 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-07-17T20:52:41.497

这是一个代码，它也为您创建循环设备。请注意不要在生产中使用此类代码，因为没有对返回值、异常等的单一检查:)。

```
#include <sys/mount.h>  //mount
#include <sys/ioctl.h>  //ioctl
#include <sys/stat.h>   //open
#include <linux/loop.h> //LOOP_SET_FD
#include <fcntl.h>      //open
#include <cstdio>       // declaration of ::fileno
#include <cstdint>      //int32_t
#include <sstream>      //std::stringstream
#include <string>

constexpr char IMAGE_NAME[] = "image.iso";       //of course we need this file to be present in same folder as built tool
constexpr char MOUNT_POINT[] = "/tmp/image_mnt"; //of course we need this folder already created
constexpr char FILESYSTEM_TYPE[] = "iso9660";
constexpr char DEV_LOOP_CONTROL[] = "/dev/loop-control";
constexpr char DEV_LOOP_PREFIX[] = "/dev/loop";
constexpr int32_t MOUNT_FLAGS = MS_RDONLY;

int main()
{
    const auto loop_control = std::fopen(DEV_LOOP_CONTROL, "r");
    const auto loop_control_fd = fileno(loop_control);
    const auto devnr = ioctl(loop_control_fd, LOOP_CTL_GET_FREE);
    std::stringstream loopname;
    loopname << DEV_LOOP_PREFIX << devnr;
    const auto loop_device_name = loopname.str();
    const auto loop_device = std::fopen(loop_device_name.c_str(), "r");
    const auto loop_device_fd = fileno(loop_device);
    const auto image = std::fopen(IMAGE_NAME, "r");
    const auto image_fd = fileno(image);
    //Associate the loop device with the open file whose file descriptor is passed as the (third) ioctl(2) argument.
    ioctl(loop_device_fd, LOOP_SET_FD, image_fd);
    const auto result = mount(loop_device_name.c_str(), MOUNT_POINT, FILESYSTEM_TYPE, MOUNT_FLAGS, NULL);
    ioctl(loop_device_fd, LOOP_CLR_FD, 0);
    return result;
} 
```

基于： http:
[//man7.org/linux/man-pages/man4/loop.4.html](http://man7.org/linux/man-pages/man4/loop.4.html)
[https://linux.die.net/man/2/mount](https://linux.die.net/man/2/mount)

# ruby-on-rails-3 - 无法获得在 OS X Lion 上工作的基本 Rails 教程

> ID：11378393
> 
> 赞同：0
> 
> 时间：2012-07-07T20:30:10.710
> 
> 标签：ruby-on-rails-3, osx-lion

我一直试图让这个介绍工作：

[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

当我尝试这一步'rails generate scaffold Post name:string title:string content:text'时，我得到以下信息：

> Cerberus:app lab49$ rails generate scaffold 帖子名称：字符串标题：字符串内容：文本调用 active_record /usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.6/lib/active_record/connection_adapters /abstract/connection_specification.rb:66:in `connection_url_to_hash': undefined method`sub' for nil:NilClass (NoMethodError) from /usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord-3.2.6/lib/active_record/connection_adapters /abstract/connection_specification.rb:34:in `block in resolve_string_connection' from /usr/local/rvm/gems/ruby-1.9.3-p194/gems/activerecord->3.2.6/lib/active_record/connection_adapters/abstract/connection_specification.rb:33:in`fetch'

我在 Mac OS X Lion 10.7.4 上使用 ruby​​-1.9.3-p194 和 rails 3.2.6。

在过去的几天里，我一直在互联网上寻找解决方案。我取得的唯一进展是降级到 rails 3.1.6，但这会引入保存模型的错误。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:35:58.313

你安装了`iconv`吗`readline`？[http://blog.merjis.com/2011/12/18/rails-3-1-ruby-1-9-3-lion-xcode-4-1/](http://blog.merjis.com/2011/12/18/rails-3-1-ruby-1-9-3-lion-xcode-4-1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:43:12.393

我从源代码编译了 ruby​​ 1.9.3p194，但我首先必须从源代码编译[libyaml](http://pyyaml.org/wiki/LibYAML)。

删除/移动 /usr/bin 中的默认文件

```
sudo mv rails rails-old
sudo mv bundle bundle-old
sudo mv ruby ruby-old
sudo mv gem gem-old 
```

编译 libyaml

```
cd libyaml-x.x.x
./configure
make
make install 
```

编译 ruby​​（前缀会告诉它在 make install 期间安装在哪里，with-opt-dir 会告诉它在哪里可以找到诸如 readline、libyaml 等库。如果您安装了 xcode，Lion 应该已经将它们放在目录中）

```
./configure --prefix=/usr/local --with-opt-dir=/usr/local/lib
make
make install 
```

安装导轨

```
gem install rails 
```

# clojure - dbmaintain 之类的 Clojure 数据库迁移工具

> ID：11378397
> 
> 赞同：1
> 
> 时间：2012-07-07T20:30:52.113
> 
> 标签：clojure

Clojure是否有类似[dbmaintain](http://dbmaintain.sourceforge.net/overview.html)的工具？

我想直接将 SQL 用于 DDL 而不是 DSL，将 DSL 用于 DML 和查询就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-05T23:41:41.243

我已经为使用普通 sql 的迁移编写了一个非常简单的 leiningen 插件。它在 clojure 文件的上下文中运行，因此这些 sql 字符串仍然可以动态生成。

查看： [https ://github.com/ckuttruff/clj-sql-up](https://github.com/ckuttruff/clj-sql-up)

我最近开始了这个项目，所以非常欢迎反馈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T05:44:01.717

[Lobos](http://budu.github.com/lobos/)是 Clojure 的一个类似工具。执行 DDL 的默认方法是使用 Clojure DSL，因此它可能不符合您的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-08T14:43:40.357

由于没有可用于 Clojure 的 dbmaintain 集成，我们编写了自己的[https://github.com/mysema/lein-dbmaintain](https://github.com/mysema/lein-dbmaintain)

lein-dbmaintain 将 dbmaintain 集成到 leiningen

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T20:50:44.297

也许我误解了您的问题，尽管 dbmaintain 似乎是一种用于自动部署和维护 SQL 数据库模式的工具。它能够确保数据库处于正确的配置（模式等）以运行特定版本的程序。这听起来像 dbmaintain 将与用 Clojure 编写的程序很好地匹配，所以按原样使用它应该没问题，除非 dbmaintain 有一些与代码更紧密集成的其他功能？

# f# - 在 F# 中使用无点样式的非对称算子的偏函数应用？

> ID：11378402
> 
> 赞同：6
> 
> 时间：2012-07-07T20:31:52.177
> 
> 标签：f#, pointfree

如何为非对称运算符（例如模运算符）创建关于第一个参数的部分函数应用程序，而 F# 中没有任何参数名称？我的第一次尝试是

`let mod10 = (%) 10`这当然转化为

`mod10(x) = 10 mod x`而不是想要的

`mod10(x) = x mod 10`. 我当然可以写

`let mod10 x = (%)x 10`但我不想命名参数所以有一些可以使用的占位符，比如

`let mod10 = (%)_ 10`?

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-08T13:14:41.047

这是基于功能组合的解决方案。

```
let mod10 = (%) >> (|>) 10 
```

**UPD**这是一个冗长的解释，但程序员会说代码，所以我想下面会以数学证明的方式更好地描述它。

**以下表达式是相等的**：

```
let m1 x = x % 10                    
let m2 x = (%) x 10                  // x (op) y = (op) x y
let m3 x = ((%) x) 10                // f x y = (f x) y
let m4 x = 10 |>         ((%) x)     // f x = x |> f
let m5 x = ((|>) 10)     ((%) x)     // x |> f = (|>) x f
let m6 x = ((%) x)    |> ((|>) 10)   // f x = x |> f
let m7 x = (x |> (%)) |> ((|>) 10)   // (op) x = x |> (op)
let m8 x = x |> ((%)  >> ((|>) 10))  // f(x) |> g = x |> (f >> g)
let m9   =       (%)  >> ((|>) 10)   // remove formal argument
let m10  =       (%)  >>  (|>) 10    // remove unnecessary parenthesis 
```

替代语法：

```
let mod10_2 = (|>) 10 << (%) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-07T20:36:12.943

您可以定义`flip`无点样式中常见的函数：

```
let inline flip f x y = f y x 
```

并像这样使用它：

```
let (%-) = flip (%)
let mod10 = (%-) 10 
```

或直接像这样：

```
let mod10 = flip (%) 10 
```

无点样式并不总是可读的（如本例所示），并且在 F# 编程中并不流行。

# javascript - 强制（版本 10）Firefox 重新加载

> ID：11378404
> 
> 赞同：1
> 
> 时间：2012-07-07T20:32:34.910
> 
> 标签：javascript, firefox

我用谷歌搜索

Firefox Force Reload 并读取/扫描了前 4 个点击。

所有人都说对我使用其中任何一个`Control R`或`Control F5.` 都不使用。II 能够强制重新加载（我的 javascript）的唯一方法是重新启动。

我通过 Ajax Post 提取了 3 个文件 CSS、HTM 和 JS。奇怪的是，CSS 和 HTM 会重新加载，但 .js 会被缓存。

尽管使用了 reload 方法，但浏览器似乎正在检查 ajax 帖子的文件扩展名和自动缓存 .js。

有没有办法强制重新加载.js。我只是仔细检查了上述解决方案，但它们不起作用。

此外，让 Firefox 知道何时缓存和何时下载的机制是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T20:35:29.787

我通常做的是禁用Firefox内置的缓存。然后你所要做的就是刷新页面，不需要特殊的击键。为此，请在您的 url 栏中输入 about:config 然后找到设置 browser.cache.disk.enable 和 browser.cache.memory.enable 将它们都设置为 false 并重新启动。问题永远解决了。

![在此处输入图像描述](../Images/0e18889957438a7da2dcd991f2533062.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-24T17:10:36.983

在其自己的选项卡中打开 javascript 文件，然后在该页面上按 control+F5。然后重新加载使用 javascript 文件的页面。当所有其他方法都失败时，这对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T20:35:55.910

要强制重新加载，请按`Control + Shift + R`。这将清空缓存并重新加载所有页面元素。

# jquery - 调整 jQuery 图像预加载器以获取具有特定前缀的所有文件

> ID：11378407
> 
> 赞同：0
> 
> 时间：2012-07-07T20:33:04.347
> 
> 标签：jquery, image, automation, preloader, prefix

我开始了，对不起我的无知...

我想将所有图像文件预加载到带有“_”前缀（_1.gif、_x.jpg 等）的混合文件夹中。

有没有办法合并这个 jQuery 图像预加载脚本：

```
$.fn.preload = function() {
    this.each(function(){
        $('<img/>')[0].src = this;
    });
} 
```

似乎有一种方法可以在这种用法中加入一些东西：

```
$(<--here?-->).preload(); 
```

我为另一个脚本设置了这个：

```
var prefix = "_"; 
```

但是搜索并没有让我走远......

谢谢阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:42:39.563

这里重要的考虑是：浏览器如何知道该目录中的内容？除非发出特定的 HTTP 请求，否则在浏览器中运行的 JavaScript 非常有目的地无法访问您的 Web 服务器上的文件。

如果您事先知道名称，则可以简单地在脚本中列出它们：

```
$.preload(['_1.gif', '_2.gif', ...]); 
```

如果您确实有所有这些图像的列表，则可以先过滤该列表以获取仅包含以 开头的数组`_`。（如果这就是你被卡住的地方，请说出来，我们可以更具体。）

但是如果在脚本中包含所有图像名称是不切实际或不可能的（例如，因为它们是动态更改的），您需要向服务器执行 AJAX 请求，请求图像列表，然后使用该列表来处理预加载。（老实说，根据图像的大小和其他一些因素，您最好让图像自然加载。）

# php - WHILE 循环中的 IF 和 ELSE IF 语句无法正常工作

> ID：11378409
> 
> 赞同：0
> 
> 时间：2012-07-07T20:33:14.537
> 
> 标签：php, while-loop, php-5.3

我正在尝试为我的社区网站创建通知系统，正在尝试使用`while`循环来获取数据，当 if 语句中的条件在 while 循环中得到满足时，它应该将数据显示/打印到页面。由于某种原因，它只显示一个结果，不知道为什么。

我的数据库结构：

```
CREATE TABLE IF NOT EXISTS `notifications` (
  `notification_id` int(11) NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `to_id` int(11) NOT NULL,
  `notification_identifier` enum('1','2','3','4','5','6') NOT NULL,
  `notify_id` int(11) NOT NULL,
  `opened` enum('0','1') NOT NULL,
  `timestamp` datetime NOT NULL,
  PRIMARY KEY (`notification_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=4 ; 
```

notification_identifier 告诉我它是什么类型的通知（例如个人资料评论、状态更新、喜欢），并`notify_id`告诉我需要检查的每个特定表的 id。

我的代码：

```
<?
$DisplayNotification ="";

$unread = "0";

$mynotify = mysql_query("SELECT * FROM notifications WHERE to_id='$logOptions_id' AND opened='$unread'") or die (mysql_error());
$notify_Count = mysql_num_rows($mynotify);

if($notify_Count>0){

        while($row = mysql_fetch_array($mynotify)){
        $notification_id = $row["notification_id"];
        $memb_id = $row["user_id"];
        $identifier = $row["notification_identifier"];
        $notify_id =$row["notify_id"];
        $timestamp = $row["timestamp"];
        $convertedTime = ($myObject -> convert_datetime($timestamp));
        $when_notify = ($myObject -> makeAgo($convertedTime));

        if($identifier == 1){// condition 1

            $DisplayNotification ='user added you as a friend';

        }else if ($identifier == 2) {//condition 2

            $DisplayNotification ='user commented on your post';
        }

        }

 }else{// End of $notify
    $DisplayNotification ='You have no new notifications.';
 }

?> 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:36:46.883

`$DisplayNotification`实际显示在哪里？它肯定不在你的循环体内。

每次通过循环时，您都会分配`$DisplayNotification`一个新值，这当然会替换旧值。当你完成时，无论发生了什么，最近的变化是唯一剩下的。

我很可能怀疑你打算做类似的事情

```
$DisplayNotification .= "User added you as a friend\n"; 
```

将`.=`在整个循环中继续向同一变量添加新文本。

或者也许你可以使用一个数组，在这种情况下你会这样做

```
$DisplayNotifications[] = "User added you as a friend"; 
```

然后，您可以根据需要在最后显示所有项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:36:56.590

看起来您在实际转储变量之前完全运行了*while*`$DisplayNotification`语句。如果是这种情况，您只是在循环期间切换变量的值。您要么需要将要转储的值存储在 Array 中，要么只需将它们转储到循环中。

# haskell - Emacs 24.1 & Haskell 语法高亮 Prelude 和常用函数

> ID：11378420
> 
> 赞同：1
> 
> 时间：2012-07-07T20:35:14.610
> 
> 标签：haskell, emacs

关于 Emacs 24.1 和 Haskell 的另一个问题。我注意到它确实为我缩进并且它为我做了非常基本的突出显示（例如，类型为绿色）。但是开箱即用的 Emacs 24.1 没有突出显示常用功能，如`foldr`,`map`等。Emacs 和 haskell-mode 是否有能力突出常用功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T20:41:02.477

从根本上说，标准库函数就是函数。事实上，根据您的进口，其中任何一个都可能是用户提供的，而不是标准前奏！这实际上经常发生——例如，如果你想使用`Control.Category`你通常隐藏`id`并用多态版本替换它。

所以简而言之，没有真正的理由突出标准功能。所以我真的怀疑这个功能是否存在于标准的 Haskell 模式中。

也就是说，这是 Emacs。您可以轻松添加任何您想要的内容。如果您有要突出显示的所有函数名称的列表，那么将其添加到 Haskell 模式中应该不难。

您可以在文件中使用类似这样的代码将新函数添加到 haskell 模式突出显示`.emacs`：

```
(font-lock-add-keywords 'haskell-mode 
                        '(("\\<\\(map\\|foldr\\|foldl\\)\\>" 1 
                           '(:foreground "#3366FF") t))) 
```

看起来怪异的字符串是一个 Emacs 风格的正则表达式。`\<`与 和`\>`类似`\b`，并且用于组`\(`内的交替。由于没有正则表达式文字，每个都必须在字符串中转义。正则表达式将更具可读性，因为. 您可以通过向表达式添加新案例来轻松添加其他函数名称。`\|``\)``\``\<\(map\|foldr\|foldl\)\>`

`(:foreground "#3366FF")`只是将文本的颜色设置为相当吸引人的蓝色阴影。

# c# - MVC 视图：如何仅在单击按钮时在视图中呈现表格

> ID：11378421
> 
> 赞同：0
> 
> 时间：2012-07-07T20:35:16.750
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, search-engine

我是 MVC 的新手，并且有一个包含搜索文本框 + 按钮、导航选项卡和表格的视图。

我希望仅在输入搜索条件并单击按钮时才填充表格。

我现在遇到的问题是视图的表格部分被渲染并在页面加载时返回空对象引用错误。

除了使用 jquery/java 函数之外，我如何才能让表格仅在输入搜索条件并单击按钮时才填充？

我是否需要创建 2 个单独的视图（一个有表格，一个没有）？

以下是我的部分观点：

```
 <div class="searchBox">

              <label>Please search here
                        <input type="text" name="searchTerm" id="searchTerm" value="<%= !string.IsNullOrEmpty((string) ViewData["SearchTerm"]) ? Html.Encode(ViewData["SearchTerm"]) : "" %>" />
                        <input type="button" value="Add" />
                </label>
        </div>

        <ul class="navigation">
    <li><a class="selected" href="#name" >Person1</a></li>
    <li><a href="#dob">Person2</a></li>
    <li><a href="#address">Person3</a></li>
    <li><a href="#status">Person4</a></li>
    </ul>

    <div class="tabSection">
    <div class="basic">

        <table id="person" class="gridview">
            <thead>
                <tr>
                    <th>name</th>
                    <th>dob</th>
                    <th>address</th>
                    <th></th>
                </tr>
                <tr>
                    <td><%= Model.name %></td>
                    <td><%= Model.dob%></td>
                    <td><%= Model.address%></td>
                    <td></td>
                </tr>
            </thead>
        </table>

</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:17:29.917

你应该把你的桌子包起来：

```
@if (Model != null)
{
    // table code
} 
```

此外，您可能需要考虑将表逻辑放入局部视图，并将 if 语句放在局部视图中。这样，在您的主视图中，您可以只使用`Html.RenderPartial("PARTAILVIEWNAME");`这种方式将允许您在任意数量的视图中拥有同一个表，而不必记住每次都将表包装在 if 语句中。

# c++ - 具有毫秒精度的 Linux/OSX 时钟分辨率？

> ID：11378437
> 
> 赞同：1
> 
> 时间：2012-07-07T20:37:05.027
> 
> 标签：c++, linux, macos, time

在 Windows 上，我可以调用 QueryPerformanceCounter 来获取高分辨率数据点，但是这个方法调用会受到 BIOS、多核 CPU 和一些 AMD 芯片问题的影响。我可以调用 timeBeginPeriod 将 Windows 中的系统时钟分辨率提高到 1 毫秒（而不是标准的 ~15 毫秒），这意味着我可以只使用调用 timeGetTime 并以我指定的时钟分辨率获取时间。

所以！在 OSX/Linux 上，我应该期待什么样的 C++ 时钟分辨率？我可以获得类似于 Windows 的 1ms 分辨率吗？由于我在做实时媒体，我希望这个时钟分辨率尽可能低：我可以在内核中更改这个值（比如在 Windows 中使用 timeBeginPeriod）吗？这是一个高性能的应用程序，所以我想让当前时间成为一个快速的函数调用。而且我想知道时钟是否通常会漂移或我会遇到什么奇怪的问题。

谢谢！布雷特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T20:57:46.667

如果您使用的是 C++11，您可以使用[`std::chrono::high_resolution_clock`](http://en.cppreference.com/w/cpp/chrono/high_resolution_clock)它应该为您提供系统提供的高分辨率时钟。要获得毫秒的持续时间，您会这样做

```
typedef std::chrono::high_resolution_clock my_clock;

my_clock::time_point start = my_clock::now();

// Do stuff

my_clock::time_point end = my_clock::now();

std::chrono::milliseconds ms_duration = 
    std::chrono::duration_cast<std::chrono::milliseconds>(end - start); 
```

如果您不使用 C++11，则该[`gettimeofday`](http://pubs.opengroup.org/onlinepubs/009604599/functions/gettimeofday.html)函数适用于 OSX 和大多数 linux 发行版。它以秒和微秒为单位为您提供自纪元以来的时间。分辨率未指定，但它应该在任何现代系统上为您提供至少毫秒级的精度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T21:29:09.760

为了补充大卫的答案，如果您不能使用 C++11，Boost 的[Timer](http://www.boost.org/doc/libs/1_50_0/libs/timer/doc/index.html)类可以帮助您。

# python - 无法使用 python 中的 abc 模块和属性访问成员变量

> ID：11378440
> 
> 赞同：-1
> 
> 时间：2012-07-07T20:37:13.063
> 
> 标签：python, properties, abc

我写了一个代码来模拟`abc`模块和`properties`. 但是，似乎我无法访问`width`和`height`变量。代码如下：

```
from abc import ABCMeta, abstractmethod

class Polygon:

__metaclass__ = ABCMeta

@abstractmethod
def compute_area(self): pass

def __init__(self):
    self.width = None
    self.height = None

@property
def width_prop(self):
    return self.width

@property
def height_prop(self):
    return self.height

@width_setter.setter
def width_setter(self, width):
    self.width = width

@height_setter.setter
def height_setter(self, height):
    self.height = height

class Triangle(Polygon):
    def compute_area(self):
        return 0.5 * width * height

if __name__ == "__main__":
    tri = Triangle()
    tri.height_setter(20)
    tri.width_setter(30)
    print "Area of the triangle = ", tri.compute_area() 
```

我得到的错误信息是`NameError: name 'width_setter' is not defined`. 我的实施可能有什么问题？

编辑：

```
from abc import ABCMeta, abstractmethod

class Polygon:

__metaclass__ = ABCMeta

@abstractmethod
def compute_area(self): pass

def __init__(self):
    self.width = None
    self.height = None

@property
def width_prop(self):
    return self.width

@width_prop.setter
def width_setter(self, width):
    self.width = width

@property
def height_prop(self):
    return self.height

@height_prop.setter
def height_setter(self, height):
    self.height = height

class Triangle(Polygon):
    def compute_area(self):
        return 0.5 * self.width * self.height

if __name__ == "__main__":
    tri = Triangle()
    tri.height_prop = 20
    tri.width_prop = 30
    print "Area of the triangle = ", tri.compute_area() 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-07T23:04:14.917

将 Python 编写为 Python，而不是 C++ 或 Java：

```
class Polygon:
    def compute_area(self):             # if you need this at all...
        raise NotImplementedError()     # what does it do for you?

    def __init__(self):
        self.width = None
        self.height = None

class Triangle(Polygon):
    def compute_area(self):
        return 0.5 * self.width * self.height

if __name__ == "__main__":
    tri = Triangle()
    tri.height = 20
    tri.width = 30
    print "Area of the triangle = ", tri.compute_area() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-07T20:41:52.517

“固定”（但完全不符合标准）代码：

```
class Polygon(object):
    __metaclass__ = ABCMeta

    @abstractmethod
    def compute_area(self): 
        pass

    def __init__(self):
        self.width = None
        self.height = None

    @property
    def width_prop(self):
        return self.width

    @width_prop.setter
    def width_prop(self, width):
        self.width = width

    @property
    def height_prop(self):
        return self.height

   @height_prop.setter
   def height_prop(self, height):
    self.height = height

class Triangle(Polygon):
    def compute_area(self):
        return 0.5 * self.width_prop * self.height_prop

if __name__ == "__main__":
    tri = Triangle()
    tri.height_prop = 20
    tri.width_prop = 30
    print "Area of the triangle = ", tri.compute_area() 
```

现在是严肃的部分：Python 不是 Java。您**不需要**getter/setter 来访问普通属性，因为 Python 作为对计算属性的很好支持（`property`您未能正确使用的类型是一个非常简单的通用 - 但非常方便 - 实现）。您的 getter 和 setter 没有做任何有用的事情，并且您将获得相同的结果（使用更少的代码和更好的性能）直接访问属性：

```
class Polygon(whatever):
    __metaclass__ = ABCMeta

    def __init__(self, witdh=None, height=None):
        self.width = width
        self.height = height

    @abstractmethod
    def compute_area(self): 
        pass

class Triangle(Polygon):
    def compute_area(self):
        return 0.5 * self.width * self.height

if __name__ == "__main__":
    tri = Triangle(20, 30)
    print "Area of the triangle = ", tri.compute_area() 
```

作为记录，Python 没有“private”/“public”关键字——只有以下划线开头的名称是“实现的东西”，客户端代码*不应*访问。请注意，“不应该”仅表示其含义：没有什么可以阻止您访问它们，但是如果现在或下一个版本出现任何问题，请不要抱怨。一种“如果未密封，则保修无效”。

wrt/正确使用或属性：我不会详细介绍（需要深入的 Python 执行模型和对象模型解释），但正确的语法是：

```
class MyClass(object):

    def __init__(self, prop):
        # this will invoke prop.setter
        self.prop = prop

    # defines a property named "prop"
    # will be accessed just like a plain
    # attribute but will go thru the getter and setter

    @property
    def prop(self):
        # this is the getter
        return self._some_val * 42

    # now add a setter to 'prop':
    @prop.setter
    def prop(self, val):
        self._some_val = val / 42

obj = MyClass(10)
print obj.prop
obj.prop = 5
print obj.prop 
```

另外（也是最后）：Python 没有“隐式 this”（或“隐式自我”）。您**必须**在方法内使用`self.attr`才能访问任何属性。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-07-07T22:03:40.330

编辑：在这种简单的情况下，例如使用直接变量访问。请参阅 Ned Batchelder 的回答。

如果您在访问变量时需要额外的功能，您可以使用它。

* * *

[http://docs.python.org/library/functions.html#property](http://docs.python.org/library/functions.html#property)

```
from abc import ABCMeta, abstractmethod

class Polygon(object):

    __metaclass__ = ABCMeta

    @abstractmethod
    def compute_area(self): 
        pass

    def __init__(self):
        self._width = None
        self._height = None

    @property
    def width(self):
        getting_variable_value()
        return self._width

    @width.setter
    def width(self, width):
        setting_variable_value()
        self._width = width

    @property
    def height(self):
        getting_variable_value()
        return self._height

    @height.setter
    def height(self, height):
        setting_variable_value()
        self._height = height

class Triangle(Polygon):
    def compute_area(self):
        return 0.5 * self.width * self.height

if __name__ == "__main__":
    tri = Triangle()
    tri.height = 20
    tri.width = 30
    print "Area of the triangle = ", tri.compute_area() 
```

# asp.net - 将控制值发布到控制器

> ID：11378442
> 
> 赞同：0
> 
> 时间：2012-07-07T20:37:36.193
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

我的视图上有一个从开始到现在的搜索框。

这 POST 到我的控制器，然后搜索所选日期之间的可用房间。然后结果再次列在视图中。

我习惯了 WebForms，您可以在其中 PostBack 并获取任何控制数据 - 但是在 MVC 中您不能这样做。

显示结果后，我如何将已选择的 RoomId POST 回控制器：

```
 @Html.ActionLink("Book Room","Book", new { id=item.RoomId }) 
```

...以及来自 TextBoxes 的 tbFrom 和 tbTo 日期？

我的看法如下。

感谢您的任何帮助，

标记

```
@model IEnumerable<ttp.Models.Room>
@{
ViewBag.Title = "Avail";
}

<h2>Avail</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
@using (Html.BeginForm())
{
    <p>
        Availability between @Html.TextBox( "dteFrom" , String.Format( "{0:dd/MM/yyyy}", DateTime.Now) , new  { @class = "datepicker span2" } ) 
                         and @Html.TextBox( "dteTo" , String.Format( "{0:dd/MM/yyyy}", DateTime.Now) , new  { @class = "datepicker span2" } )
        <input type="submit" value="Search" /></p>
}
<table class="table table-striped table-bordered table-condensed" style="width:90%" id="indexTable" >
<tr>
    <th>
        @Html.DisplayNameFor(model => model.RoomName)
    </th>
</tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.RoomName)
        </td>
...
...
        <td>
            @Html.ActionLink("Book Room","Book", new { id=item.RoomId }) 
        </td>
    </tr>
}

</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T20:43:34.530

使您的视图具有强类型...并且要知道 mvc.net 中的强类型视图是什么，这里有一些链接

[http://www.howmvcworks.net/OnViews/BuildingASstronglyTypedView](http://www.howmvcworks.net/OnViews/BuildingAStronglyTypedView)

[什么是 ASP.NET MVC 中的强类型视图](https://stackoverflow.com/questions/2896544/what-is-strongly-typed-view-in-asp-net-mvc)

[http://blog.stevensanderson.com/2008/02/21/aspnet-mvc-making-strongly-typed-viewpages-more-easily/](http://blog.stevensanderson.com/2008/02/21/aspnet-mvc-making-strongly-typed-viewpages-more-easily/)

此外，如果您在应用程序中设置了默认路由，则在您的`POST`操作结果中，您可以获得`id`路由值，例如

```
[HttpPost]
public ActionResult POSTACTION(int id){
 //here you will get the room id 
} 
```

但从代码中我看到的是您没有发布表单，actionlinks`GET`在这种情况下发出请求，`[HttpPost]`从操作结果中删除操作过滤器......

编辑

可能我只是误解了这个问题......在你目前的情况下，如果`ajax`是一个选项，你可以做这样的事情

为您的操作链接分配一个类，例如

```
 @Html.ActionLink("Book Room","Book", new { id=item.RoomId },new{@class="roomclass",id=item.RoomId}) 
```

现在附加一个点击事件处理程序

```
$(function(){
 $(".roomclass").on("click",function(e){
   e.preventDefault(); //prevent the default behaviour of the link 
   var $roomid = $(this).attr("id");//get the room id here 
   //now append the room id using hidden field to the form and post this form 
   //i will assume that you have only one form on the page 
   $("<input/>",{type:'hidden',name="RoomId",value:$roomid}).appendTo("form");
   $("form").submit();   
  });
}); 
```

指定表单将发布到的操作名称和控制器

```
@using (Html.BeginForm("MyAction","ControllerName",FormMethod.POST)){...} 
```

在您的控制器中，您将拥有类似的东西

```
[HttpPost]
public ActionResult MyAction(int RoomId,DateTime? dteFrom ,DateTime? dteTo ){
 //you will get the form values here along with the room id 
 // i am not sure about the type `DateTime?` parameteres if this doesn't work try using string dteFrom and string dteTo
} 
```

# c - win32 上的“struct EVENT_LIST”是什么？

> ID：11378445
> 
> 赞同：1
> 
> 时间：2012-07-07T20:38:08.663
> 
> 标签：c, winapi, header-files

我正在查看[将 Windows 事件日志数据中继到 syslog 安装的项目](http://code.google.com/p/eventlog-to-syslog/)的源代码，以便尝试在我管理的网络上整合内容。执行此操作的程序需要针对我们的应用程序进行调整，我非常愿意这样做，所以我放弃了 GNU 构建系统，目前正试图让这个东西在 GCC 下构建。（我在 Linux 机器上进行开发。）

无论如何，即使在 Windows 系统上，我也找不到这个“struct EVENT_LIST”（在 main.h 和引用项目代码中的其他几个地方引用，但从未定义），所以我无法弄清楚数据类型是什么. 这里有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:43:21.140

这不是 Windows 的东西，它是[在那个项目中](http://code.google.com/p/eventlog-to-syslog/source/browse/trunk/4.0/check.h)定义的......

```
/* Ignored Events Structure */
struct EVENT_LIST {
        char source[50];
        BOOL wild;
        int id;
}; 
```

# javascript - 使用旋转旋钮垂直和水平滚动

> ID：11378446
> 
> 赞同：-2
> 
> 时间：2012-07-07T20:38:14.703
> 
> 标签：javascript, jquery, html, css

我对此做了很多研究，但不幸的是，我什至不知道从哪里开始。我有两个使用插件（knobKnob.jquery.js）旋转 360 度的旋钮。

我的目标是，当我旋转相应的旋钮时，我可以水平和垂直滚动特定的 div。

该插件非常庞大，所以我无法在这里全部展示。我的目标是拥有 HTML5 和 CSS3 旋转旋钮，但我一直无法弄清楚这一点。任何为我指明正确方向的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:43:39.143

我认为这是一个看起来很酷的插件，所以我决定试一试。[这个页面有一切可以开始](http://tutorialzine.com/2011/11/pretty-switches-css3-jquery/)。不幸的是，我无法正确执行最后一点，因为 100% 转弯不会一直向右/向下滚动。（它与 KnobKnob 无关，更多与我无法掌握滚动和元素尺寸有关）

我放弃了，我会把它留给你和更聪明的读者来弄清楚:) 也许它与滚动条的厚度有关。

[**查看演示**](http://jsfiddle.net/XrVF8/4/)

```
$(function() {
    $('#control').knobKnob({
        snap: 10,
        value: 0,
        turn: function(ratio) {
            $("#ratio").val(ratio);
            $("#frame").scrollLeft(($("#frame")[0].scrollWidth - $("#frame").innerWidth()) * ratio);
        }
    });
    $('#control2').knobKnob({
        snap: 10,
        value: 0,
        turn: function(ratio) {
            $("#ratio2").val(ratio);
            $("#frame").scrollTop(($("#frame")[0].scrollHeight - $("#frame").innerHeight()) * ratio);
        }
    });
});​ 
```

# php - 提取和删除不允许的锚标签

> ID：11378447
> 
> 赞同：2
> 
> 时间：2012-07-07T20:38:18.583
> 
> 标签：php, regex

我试图编写一个脚本来执行以下操作：

1.  从文件或数据库中读取内容
2.  从内容中提取所有锚标签
3.  扫描所有链接并保留允许的链接，例如指向社交网络、搜索引擎或权威域的链接，并删除其余链接，同时保留其内容（锚文本）。

示例内容：

`<p><a rel="nofollow" href="http://www.test.com/tyest">test1</a></p>`
`<p><a href="http://google.com">google</a></p>`
`<p><a title="This is just a check" href="http://www.check.com">check</a></p>`
`<p><a rel="nofollow" href="http://www.ip.com">http://www.ip.com</a></p>`

允许的域：

`google.com`
`msn.com`
`ip.com`

期望的输出：

`<p>test1</p>`
`<p><a href="http://google.com">google</a></p>`
`<p>check</p>`
`<p><a rel="nofollow" href="http://www.ip.com">http://www.ip.com</a></p>`

限制：

1.  锚标签将不遵循任何特定规则，并且可以包含或不包含 rel、title、description 属性和任何顺序。
2.  锚文本本身也可以是一个链接，例如： http: [//google.com](http://google.com)，即使链接不被允许，也应该保留。

我做了功课并尝试编写一个简单的裸级脚本来使用不同的正则表达式以及在线提供的帮助来开始初始工作，但没有成功。这是我的代码：

```
// sample input
$comment = '<p><a rel="nofollow" href="http://www.1google.com/tyest">test with no http</a></p>
                <p><a rel="nofollow" href="http://google.com">just a domain name</a></p>
                <p><a rel="nofollow" href="http://www.g1gle.com">check</a></p>
                <p><a rel="nofollow" href="http://www.ip.com">http://www.ip.com</a></p>
                <p><a rel="nofollow" href="http://osamashabrez.com">http://testx.osamashabrez.com</a></p>
                <p><a rel="nofollow" href="http://www.subchalega.com">http://www.subchalega.com</a></p>
                <p><a rel="nofollow" href="http://www.letscheck.com">http://www.letscheck.com</a></p>
                <p><a rel="nofollow" href="http://www.google.com/osama/here/">http://www.google.com</a></p>
                <p><a rel="nofollow" description="testing" title="google" href="http://www.google.com/last/">laaaaaaaa</a></p><h1>Header one</h1>
                <p><a rel="nofollow" href="http://domain1.com">http://testx.osamashabrez.com</a></p>';

// add http to the domain name if not already present
function addhttp($url) {
    if (!preg_match('~^(?:f|ht)tps?://~i', $url)) {
        $url = 'http://' . $url;
    }
    return $url;
}

// removed deep links to match with the allowed URLS 
function removeDeepLinks($url) {
    $pos = strrpos ( $url, '.com' );
    if ( $pos !== false )
        return substr( $url, 6, $pos-2 );
    return $url;
}
// allowed domains fetched from the db
$domains = "http://osamashabrez.com\rhttp://google.com\rwordpress.org\rabc.com";
$domains = preg_split( "~\r~", $domains, -1, PREG_SPLIT_NO_EMPTY );
// adding http if not already present
// will be done one when data will be inserted
foreach ( $domains as $key => $domain ) { $domains[$key] = addhttp($domain); }
// remove this and sky will fall on your head :D
sort( $domains );
print_r ( $domains );
// regex to extract href="xyz.com" link as we can not use any other option
// due to the uncertainity of data passed to this script
$regex = '/(href=".*?")/is';
if ($c=preg_match_all ($regex, $comment, $matches)) {
    $matches = $matches[1];
    foreach ( $matches as $key => $url ) {
        // remove deep links for matching
        $matches[$key] = removeDeepLinks($url);
    }
    print_r($matches);
    foreach( $matches as $key => $url ) {
        // if domain is not allowed
        if ( !array_search( $url, $domains ) ) {
            // find position of URL
            $pos_url     = strrpos( $comment, $url );
            // fint the starting position of anchor tag
            $pos_a_start = strrpos(substr($comment, 0, $pos_url), '<a ');
            // fint the end
            $pos_a_end   = strpos($comment, '</a>',$pos_url);
            // extract the whole anchor tag
            $anchor_tag  = substr($comment, $pos_a_start, $pos_a_end - $pos_a_start + 4);
            echo "URL:\t" .$url . "\r";
            echo "Anchor Tag:\t{$anchor_tag}\r";
            echo "POS START :: END:\t{$pos_a_start}::{$pos_a_end}\r";

            // something weired goes where commenting this line works but only the opening
            // tags are removed from the text
            // the code does work with some data inputs and does not work with a few others
            $comment = substr($comment, 0, $pos_a_end) . substr($comment, $pos_a_end+4);
            // removing opening tags
            $opening_tag = substr( $anchor_tag, 0, strpos($anchor_tag, '>') +1 );
            $comment = str_replace($opening_tag, '', $comment);
        }
    }
}
echo $comment; 
```

上面的代码正在处理一些数据输入和其他中断，我想获得一些帮助，工作代码示例或对我提供的代码的审查。还要提及是否有更好的方法来完成工作。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:34:44.333

DOM 解析器更适合此任务。

有很多选择，包括：

*   [DOM文档](http://php.net/manual/en/class.domdocument.php)
*   [PHP 简单的 HTML DOM 解析器](http://simplehtmldom.sourceforge.net/)
*   [查询路径](http://querypath.org/)

下面是一个使用 QueryPath 的示例：

```
$qp = qp($html)
foreach ($qp->find('a') as $link) {
    $href = $link->attr('href');
    // Get the host domain
    $host = parse_url($href, PHP_URL_HOST);
    // Check our allowed hosts
    if (!in_array($host, $allowedHosts) {
        // Replace the links HTML with just its text
        $link->html($link->text());
    }
}
// Echo our result
echo $query->top()->html(); 
```

（未经测试，但应该进行一些修改。）

# sed - 使用 sed 交换列

> ID：11378449
> 
> 赞同：1
> 
> 时间：2012-07-07T20:39:27.033
> 
> 标签：sed, swap

我在文件中有如下数据`test`：

```
2233:Jorge Bill :56Blue Pkwy  :99999
1111:Mary Smith :33Red Street :123456 
```

我想使用 sed 和分组交换姓氏和名字，但我的代码不起作用！

```
sed 's/\([^:]*:\)\([^' ']*' '\)\([^:]*\)/\1\3\2' test 
```

你知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:58:09.677

您忘记在正则表达式中转义单引号，并且您还需要在替换字符串的末尾再添加一个正斜杠。我去掉了单引号，就在这里。

```
sed 's/\([^:]*:\)\([^ ]* \)\([^:]*\)/\1\3\2/' test 
```

# google-maps - Google Map API V3：如何将自定义数据添加到标记

> ID：11378450
> 
> 赞同：122
> 
> 时间：2012-07-07T20:39:36.513
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

有没有办法可以将一些自定义信息添加到我的标记以供以后使用。有一些方法可以获得信息窗口和标题，但是如果我想将标记与其他信息相关联怎么办。

我在页面上显示了取决于标记的其他内容，因此当单击标记时，页面上的内容必须根据单击的标记而改变。一旦标记被单击，我想存储和检索自定义数据点击等

谢谢

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2012-07-07T20:53:38.210

由于 Google Marker 是一个 JavaScript 对象，您可以在表单中添加自定义信息`key: value`，其中 key 是一个有效的字符串。它们被称为*对象属性*，可以通过许多不同的方式来处理。该值可以是任何合法的东西，如数字或字符串，也可以是函数，甚至是其他对象。三种简单的方式：在声明中，点符号和方括号

```
var markerA = new google.maps.Marker({
    map: map,
    position: new google.maps.LatLng(0, 0),
    customInfo: "Marker A"
});

var markerB = new google.maps.Marker({
    map: map,
    position: new google.maps.LatLng(-10, 0)
});
markerB.customInfo = "Marker B";

var markerC = new google.maps.Marker({
    map: map,
    position: new google.maps.LatLng(-20, 0)
});
markerC['customInfo'] = "Marker C"; 
```

然后以类似的方式检索它：

```
google.maps.event.addListener(markerA, 'click', function() {
    alert(this.customInfo);
}); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-07T20:53:14.510

您可以将自己的自定义属性添加到标记（请注意不要与 API 的属性冲突）。

# android - Android WifiManager 建立幻象连接？

> ID：11378452
> 
> 赞同：0
> 
> 时间：2012-07-07T20:39:49.847
> 
> 标签：android, android-wifi, android-networking

我正在使用 WifiManager 测试特定 SSID 的存在并验证给定的 WPA 密码，但我得到了一个奇怪的结果。

代码如下所示：

```
WifiConfiguration wc = new WifiConfiguration();

// init ssid and password as Strings ...
wc.SSID = "\"" + ssid + "\"";
wc2.preSharedKey  = "\"" + password + "\"";

wc.hiddenSSID = true;
wc.status = WifiConfiguration.Status.ENABLED;
wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.TKIP);
wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.CCMP);
wc.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_PSK);
wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.TKIP);
wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.CCMP);
wc.allowedProtocols.set(WifiConfiguration.Protocol.RSN);

int res = wifi.addNetwork(wc);
boolean b = wifi.enableNetwork(res, true); 
```

奇怪的是 enableNetwork() 会返回 true，即使带有 SSID 的 wifi 网络不在线（？！）。但是请注意，如果存在目标 Wifi 网络并且密码正确，则代码会成功建立连接。

Android 文档说 enableNetwork() “如果操作成功，则返回 true”。我的问题是：

1）如果网络甚至不存在，如何启用网络？

2) 我是否错误地初始化了 WifiConfiguration 参数 wc？

3) 这是建立/测试与 Wifi 网络连接的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T19:47:13.750

> 1）如果网络甚至不存在，如何启用网络？
> 
> Android 文档说 enableNetwork() “如果操作成功，则返回 true”。

它们实际上意味着启用操作已成功启动，它没有崩溃......如果 wifi 实例不再链接到 wifi 请求者，这可能会返回 false。

> 2) 我是否错误地初始化了 WifiConfiguration 参数 wc？

我不确定，但看起来还不错。

> 3) 这是建立/测试与 Wifi 网络连接的正确方法吗？

`startScan()`在启用网络之前，您应该使用该方法检查网络是否实际可用。（您将在回调中获得 SSID 列表）。

您还应该使用 BroadcastReceiver 从 Intent 操作中获取结果`NETWORK_STATE_CHANGED_ACTION`，您可以在其中检查与接入点的连接是否成功。

# c# - C# - 尝试获取进程句柄时访问被拒绝

> ID：11378453
> 
> 赞同：1
> 
> 时间：2012-07-07T20:39:51.203
> 
> 标签：c#, process, handle

我正在尝试获取进程的句柄，但我收到一条错误消息“拒绝访问”。这是我的代码：

```
namespace Program
{
    public partial class Form1 : Form
    {

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            IntPtr sign = Process.GetProcessesByName("thatProgram")[0].Handle;
        }
    }
} 
```

似乎这适用于除此特定程序之外的所有程序。你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-03-23T14:27:46.317

也许您尝试获取系统进程的句柄或由另一个用户启动的进程（后者只有在您的应用程序以管理员身份启动时才有可能）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-29T12:04:41.530

尝试 **process.MainWindowHandle**代替句柄

# android - Android：以编程方式在布局中创建用户指定的进度条数

> ID：11378454
> 
> 赞同：0
> 
> 时间：2012-07-07T20:40:09.963
> 
> 标签：android, android-layout, progress-bar

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

//this is where I want the progressbars to be.
    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

我想以编程方式在布局中创建用户指定数量的进度条，而不必在 xml 文件中指定它。请帮我弄清楚这一点。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:02:09.760

我建议为这些进度条（实际上是任何小部件）放置一个容器，例如

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="@string/hello" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

    <LinearLayout 
        android:id="@+id/linBars"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical">
    </LinearLayout>
    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

然后在您的代码中，即在您的活动中（基本上您需要访问一个`Context`对象）请记住，我给容器提供了 id 'linBars'。这可以是任何有效的 Java 标识符（它被放入 R.id。）

```
 //Get the container
 LinearLayout container = (LinearLayout) findViewById(R.id.linBars);

 ProgressBar pbar = new ProgressBar(this);
 //Set any properties for it here (eg setInterpolator etc)
 container.addView(pbar); //ProgressBar and just about any widget is a subclass of View 
```

我建议阅读[ViewGroups](http://developer.android.com/reference/android/view/ViewGroup.html)，这是大多数“将小部件添加/删除到容器”代码所在的位置。`LinearLayout`是它的一个子类，你也可以使用其他一些，但它可能是一堆`ProgressBar`实例的最佳选择。

回答您的评论*如何引用创建的小部件？*

两种方式各有优劣

*   创建一个列表或数组来保存您的小部件，并在将它们`LinearLayout`添加到列表/数组之前或之后创建它们。您可以随心所欲地引用它们，除非您需要清理您的房屋`OnDestroy`并删除对它们的所有引用，否则您的程序将占用内存，并且如果它在其父级被破坏的小部件上调用某些东西，它将什么也不做或爆炸（又名抛出异常）。
*   `ViewGroup`实际上会让您访问它下面的任何和所有小部件。不幸的是，您无法保证检索到的小部件的顺序或类型。方法是[`getChildAt(int index)`](http://developer.android.com/reference/android/view/ViewGroup.html#getChildAt%28int%29)和`getChildCount()`。请记住，它返回一个`View`对象，因此只有当您确定所有孩子都属于某种类型时，您才能安全地转换它。我给它的SDK链接中描述的另一个警告，如果您指定的索引处没有子节点，它将返回null。在我们的示例中，我们知道添加的所有视图都是`ProgressBar`如此，因此我们可以执行以下操作

获取所有进度条的示例：

```
 //Get the container
  LinearLayout container = (LinearLayout) findViewById(R.id.linBars);

  ProgressBar pbar;
  for (int i = 0; i < container.getChildCount(); i++) {
      pbar = (ProgressBar) container.getChildAt(i);
      //Do whatever to the progress bar here
  } 
```

我觉得我还必须指出另一个问题。如果用户离开应用程序（即点击主页按钮，接听电话），一段时间后系统决定销毁活动以节省内存，然后用户导航回您的应用程序，除非您保存信息，否则进度条将消失在此`Bundle`期间重建它们`OnDestroy`并检查您`OnCreate`的项目，`Bundle`然后重新添加到您的`linearLayout`.

# javascript - Acrobat PDF：计算非空文本字段

> ID：11378455
> 
> 赞同：1
> 
> 时间：2012-07-07T20:40:12.630
> 
> 标签：javascript, pdf

在开始之前，我不确定我正在做的事情是否是正确的方法，或者是否有更好/更简单的方法......

我有以下文本字段：
Resident[0]
Resident1[0]
Resident2[0]
Resident3[0]
Resident4[0]
Resident5[0]
Resident6[0]
Resident7[0]

占用计数

如果用户在字段中键入名称（或任何文本），我需要 occupancy_count 来中间自动计算非空字段的总数......

我试图做的，完成我的任务是去：[右键单击] occupancy_count -> 属性 -> 计算 -> 自定义计算脚本 -> “编辑...”

**JS脚本：**

```
 var count = 0;
    var field = "Resident";
    var numFields = 8;

for (var i=0; i<=numFields; i++) {
    var series = ( i === 0 )? "" : i;
    var v = getField(field + series  + "[0]").valueAsString;
    if (v!="") {
        count++;
    }
}

event.value = count; 
```

但是， occupancy_count 字段没有做任何事情 >_< 你能帮我弄清楚我做错了什么并让该字段计数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:56:05.817

右键单击文本字段 [occupancy_count] -> 属性 -> 计算 -> 自定义计算脚本 -> “编辑...”

当弹出窗口出现时，复制并粘贴此 javaScript 代码：

**JS脚本：**

```
var sum = 0;
for ( i = 0; i < 9; i++ ) {
    f = "Resident" + ( i == 0? "" : i ) + "[0]";
    if (getField( f ).valueAsString) {sum += 1;}
    }
event.value = sum; 
```

# mysql - MySQL 在特定列中查找字符串模式的最后一次出现

> ID：11378456
> 
> 赞同：0
> 
> 时间：2012-07-07T20:40:31.977
> 
> 标签：mysql, sql

我有一个 mysql 表，其中有一列，例如名为 name。列数据具有特定的模式 nameBase+number。例如

```
name
----------
test0
test1
test2
stack0
stack1
stack2 
```

每次我想向列中添加数据时，我都必须找到特定 nambeBase 的最后一个数字并添加新条目 +number+1。

例如，如果现在测试来了，我必须将 test3 添加到 db。

我的问题： 1\. 检查 nameBase 是否已经存在于 db(sth like contains) 和 2.find 姓氏的最佳方法是什么。例如这里的测试是3。

更新：每个人，一个更新。我终于使用了 java Pattern 类。很酷很容易。它让一切变得如此简单。我只需将 /d 添加到模式，然后我可以检查它是否与名称匹配，并可以使用模式组轻松访问第二部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:45:35.373

这里真正的解决方案是更改数据库模式，将其分成*两*列，名称和编号。然后通过以下方式获取聚合变得`MAX()`微不足道

```
SELECT name, MAX(num) AS num FROM tbl GROUP BY name 
```

但是，如果更改它不是一个选项，我建议使用从列值`REPLACE()`中*删除*`MAX()`名称部分，在查询时只留下数字部分，并获取它的聚合以找到它的最高现有数字：

```
SELECT
  MAX(REPLACE(name, <the name to search>, '')) AS maxnum
FROM tbl
WHERE 
  name LIKE '<the name to search>%' 
```

或者代替`LIKE`，使用正则表达式，这比`LIKE`（如果名称包含另一个名称，`LIKE`可能匹配）更准确但更昂贵：

```
SELECT
  MAX(REPLACE(name, <the name to search>, '')) AS maxnum
FROM tbl
WHERE 
  name REGEXP '^<the name to search>[0-9]+$' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:01:38.370

如果您无法更改架构，请尝试以下操作：

```
INSERT INTO names (name)
  SELECT CONCAT("stack", CAST(TRIM(LEADING "stack" FROM name) AS INT)+1) 
   WHERE name LIKE "stack%" ORDER BY name DESC LIMIT 1; 
```

这个想法是：

1.  选择“最高”的先前值，
2.  名字的印章，
3.  将剩余的字符串转换为 int，
4.  添加一个，
5.  然后把名字放回去。

我还没有测试过这个......我希望它能引导你朝着正确的方向前进。

请注意，我使用了一个常量字符串“stack”作为示例，您可能希望使其动态化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T20:57:49.080

假设您无法更改表的结构，您可以为所欲为。但是，它相当昂贵。

你想做的是这样的：

```
select name
from t
where left(name, length(<name parameter>)) = <name parameter>
order by name desc
limit 1 
```

不幸的是，您的命名可能不允许这样做，因为您没有用零填充数字部分。

因此，以下解决了这个问题：

```
select name,
       cast(substring(name, length(<name parameter>), 1000) as int) as number
from t
where left(name, length(<name parameter>)) = <name parameter>
order by 2 desc
limit 1 
```

这不是特别有效。此外，索引并不能真正帮助解决这个问题，因为字符串的整理顺序与数字的不同（test0、test1、test10、test100、test11 等与 0、1、2、3、4 ......）。

如果可以的话，我会听从建议多个列或表的其他人的建议。我只提供这种方法，您不必修改当前表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T20:47:39.220

如果可能的话，我会重组表格以将它们放置在 2 个表格（更好）或至少两列（中等）中。您拥有的结构根本没有标准化：-/

在不了解您的架构的情况下；这是我对两表解决方案的建议：（注意：这是标准化的，也遵循成语“不要存储可以计算的内容”）

```
names
------
id  | name
01  | test
02  | stack

name_hits
-------
name_id | date
01      | 01/01/2001
01      | 01/15/2001
01      | 04/03/2001
02      | 01/01/2001
... 
```

然后像这样选择：

```
SELECT names.name, count(name_hits.id) as hits 
FROM names JOIN name_hits ON names.id=name_hits.name_id
GROUP BY names.id 
```

并像这样插入：

```
INSERT INTO name_hits SELECT id, NOW() FROM names WHERE name = "stack"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-07T20:45:30.907

我将使用带有两列的附加表来执行此操作，并将每个名称和最后分配的 ID 存储在该表中。然后将`nameBase+number`原始表中的`name`列替换为作为加法表的外键的`number`列，以及作为该条目的适当计数的列。

这将更容易和更有效地操作。

# nosql - NOSQL 表模式

> ID：11378457
> 
> 赞同：0
> 
> 时间：2012-07-07T20:40:32.330
> 
> 标签：nosql, azure-table-storage

我正在尝试规划一个 NOSQL 表架构。我的数据中有关系，但它们大多是关系数据库中的 N:N；很少有正常的 1:N 关系。

所以在这种情况下，我试图创建隐式关系，允许我从关系的两端进行浏览。我正在使用 Azure 表存储，所以我知道全文搜索不可用；我只能通过分区键 + 行键组合检索“对象”。

所以想象我有一个名为“People”的表和一个名为“Hamburgers”的表，表中的每个对象都可以与另一个表中的多个对象相关联。汉堡被很多人吃，每个人都吃很多汉堡。

由于这种关系可能偏重于人员方面 - 即每个汉堡包的人多于反之亦然，我会在这样的表格中处理这个问题：

**汉堡桌**

分区键：只有 1 个分区

行键：唯一 ID

**人员表**

分区键：只有 1 个分区

行键：唯一 ID

“列”：每个人吃的每个汉堡都有额外的价值

**汉堡包-人桌**

分区键：汉堡行键

行键：人员行键

这样，如果我正在查看一个汉堡包并想查看所有吃它的人，我可以转到 Hamburger-People 表并使用我的 Hamburger's Row Key 来获取所有吃汉堡包的人的分区。

如果我在一个人身上并想查看他/她吃的所有汉堡包，那么我对这个人吃的汉堡包的行键有额外的价值。

在向表中插入数据时，如果数据涉及汉堡包/人的关系，我会将这两个值插入到适当的表中，然后创建汉堡包-人表。如果我试图保留一个无重复的汉堡包列表，我需要先搜索汉堡包表以确保汉堡包不在那里（比如“Whopper” - 如果它在那里，我不会插入再次）。然后，我需要在 Hamburger-People 表中的汉堡包现有分区中插入一行。

但在大多数情况下，不存在重复要求。

这是一个很好的 NOSQL 模式的最佳实践方法，还是我以后会遇到问题？

更新另外，我希望以后能够对数据表进行分区，但我不确定如何使用这种结构进行分区；向 hamburger 表添加第二个分区需要我在 hamburger-People 表中存储一个额外的值，我不确定这是否会开始变得太复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T02:05:24.617

好的，很好的问题，我认为其中大多数是每个 RDMBS 开发人员在进入 NoSQL 世界时都会面临的问题：

**1.如何对分区进行分组？** 为了充分利用分区，您需要考虑数据库的负载应该分布在您的服务器上，让我们看看您的方法会发生什么

一个带有“A”键的人进入餐厅，您将保存它和他的汉堡，这是一个经典美味（“T”键），人员记录进入服务器 X，汉堡进入服务器 Y，现在是新客户go 用钥匙“B”进入，想要一些不同的东西，汉堡“W”，这个人再次去服务器 X，汉堡到服务器 X，这次服务器 X 正在承受所有负载，如果你重复这个你'会看到服务器 X 变成了瓶颈，因为 75% 的记录都流向那里（所有人和 50% 的汉堡），这会给你的负载带来一些问题。但是......当您尝试查询时问题会更好，因为所有查询都会到达服务器 X。为了解决这个问题，您可以使用人的键作为关系分区的一部分，

**2\. 我应该在 NoSQL 数据库中使用“关系”吗？** 请记住，NoSQL 意味着只要您的问题需要解决方案以避免“过度查询”，您就可以复制信息，因此，如果您可以存储通常一起查询的信息，您将避免往返数据库。因此，如果您存储“事务”而不是“人和 burguers”，您将获得更好的性能并避免对数据库的一些打击，让我们用您的方法做一个真实数据的示例，并将其与“我的”方法进行比较：

1.  Joe Black 来到餐厅要一份美味，在这里您将进行以下交易： 创建 Joe Black 记录 创建 Burguer 交易记录

如果您想列出您的日常交易，您需要：

从“表”person-burguer 中获取当天的所有记录，然后转到“表”人并检索客户的姓名，现在，转到汉堡记录并检索他们的姓名。（您将无法进行跨表查询，因为某些记录可能在一台服务器中，而其他记录可能在第二台服务器中）

好的，如果您创建一个表“事务”并在其中存储以下 json 怎么办：

{ custid: "AAABCCC", name: "Joe", lastName: "Black", date: "2012/07/07", order: { code: "Burger0001", name: "Tasty", price: 3.5 } }

我知道您将有几条具有相同“美味”描述的记录，这是反规范化，当您使用 NoSQL 解决这些类型的问题时非常有用，现在，您创建了多少事务来将信息存储到数据库中？只有一个！哇...在一天结束时您需要多少查询才能检索信息？再一次...只是一个，它会产生一些问题，但也会为您节省很多工作，例如...您可以轻松地重新打印订单吗？（是的，你可以！）如果客户的名字发生了变化怎么办？这甚至可能吗？

我希望这对你有所帮助，

我是[http://djondb.com](http://djondb.com)的创建者，所以我认为根据数据库能够做什么，拥有内部知识会给我一种不同的方法来解决问题，但我不知道 azure 将如何处理如果您无法查询文档值和行键，则查询，但无论如何我希望这能让您有所了解。

# php - (PHP) 解析正则表达式字符串 - 平衡括号

> ID：11378459
> 
> 赞同：8
> 
> 时间：2012-07-07T20:40:56.360
> 
> 标签：php, regex

我正在尝试在 PHP 中解析以下格式的字符串（EBNF，我希望这是正确的）：

```
<exp>      ::= <base>[{<modifier>["!"]"("<exp>")"}]
<base>     ::= <role>[{<modifier><role>}]
<modifier> ::= "&" | "|"
<role>     ::= ["!"]<str>[","<str>] 
```

`<str>`可以通过的字符串在哪里`[a-zA-Z0-9\-]+`

以下是必须解析的模式示例：

```
token1
token1&token2
token1|(token2&!token3)
(token1&token2)|(token3&(token4|(!token5,12&token6)))
!(token1&token2|(token3&!token4))|token5,12 
```

我正在尝试编写一个 RegEx 模式，它总是会给我四个组：

1.  最左边的`<expression>`. 从上面的例子来看，这将是：
    *   `token1`
    *   `token1`
    *   `token1`
    *   `token1&token2`
    *   `token1&token2|(token3&!token4)`
2.  如果`["!"]`在场。IE
    *   `null`
    *   `null`
    *   `null`
    *   `null`
    *   `!`
3.  下`<modifier>`一个`<expression>`（如果有的话）。这将是：
    *   `null`
    *   `&`
    *   `|`
    *   `|`
    *   `|`
4.  剩下的图案。
    *   `null`
    *   `token2`
    *   `token2&!token3`
    *   `token3&(token4|(!token5,12&token6))`
    *   `token5,12`

如果第一个表达式不包含任何`<modifier>`s，我可以解析它。

```
^\(?(!?)([a-zA-Z0-9\-]+)\)?([&|]?)(.*)$ 
```

我被困在这一点上。我尝试过使用环视，但是我不知道如何确保在所有括号都平衡时捕获该组。这是否可以通过 RegEx 实现，或者我是否需要使用循环等编写代码来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:54:21.797

据我所知，这是不可能的。

您有一个上下文无关的语法（EBNF 适用于这种类型的语法 - Type-2 语法），它不能用正则表达式解析（用于正则语法 - Type-3 语法）。

[http://en.wikipedia.org/wiki/Chomsky_hierarchy](http://en.wikipedia.org/wiki/Chomsky_hierarchy)

举个你不能在这里处理的例子：开括号的数量——你只能为每个数量写一个正则表达式（但可以是无限的，对吗？），否则无法判断匹配的数量结束括号是相同的。没有办法计算正则表达式的特定部分用量词（ , 等）计算出的`+`字符`*`数

# iphone - 让应用识别“正确答案”

> ID：11378460
> 
> 赞同：3
> 
> 时间：2012-07-07T20:40:59.010
> 
> 标签：iphone, ios, xcode4.3

我是游戏新手，所以可能是一个简单的问题。我想要做的是制作一个带有问题的应用程序，以及一个用于回答的文本文件。然后，我希望应用程序识别答案何时正确（在本例中为数字 25）以及何时错误（不是 25）。一切正常，我收到“错误”消息，但我无法让它识别正确的答案。

```
- (IBAction)btnSubmitAction:(id)sender {
if (textFieldAnswer.text == @"25") {
    lblAnswer.text = @"Yes, your right!";
    btnNext.hidden = 0;
} else {
    lblAnswer.text = @"No, try again.";
} 
```

}

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T20:43:05.703

好吧，这就是你应该如何比较字符串：

```
- (IBAction)btnSubmitAction:(id)sender {
if ([textFieldAnswer.text isEqualToString:@"25"]) {
    lblAnswer.text = @"Yes, you're right!";
    btnNext.hidden = NO;
} else {
    lblAnswer.text = @"No, try again.";
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:45:46.160

在 Objective-C 中比较对象是由 == 完成的。这意味着您比较指针，这与比较字符串不同，因为它们是指针。如果你想比较字符串是否相等，你应该调用类的`BOOL`实例方法`isEqualToString`。`NSString`

```
[string1 isEqualToString:@"someString"] 
```

# objective-c - 为 Objective-C 配置 TextMate 以运行 clang 而不是 gcc

> ID：11378465
> 
> 赞同：1
> 
> 时间：2012-07-07T20:41:36.843
> 
> 标签：objective-c, textmate, llvm-clang

我正在运行最新的 TextMate 1.5（在 OSX Lion 上）并安装了最新的 XCode 4.3。在学习 Objective-C 时，我有点走低路，绕过 XCode 开始并使用 TextMate 和命令行进行简单的示例和练习。在 TextMate 中点击 Cmd-R 时，（控制台）会构建并运行类型化的 Objective-C 控制台程序。但是，它不会编译它应该（从我的 POV）编译的东西，因为使用 clang 从命令行编译它们可以正常工作。当我从命令行切换到构建时，我发现当我使用 gcc 而不是 clang 时，同样的事情会失败。

我的问题是 - 当我为 Objective-C (.m) 源文件点击 Cmd-R 时，如何说服 TextMate 使用 clang 而不是 gcc？

（我翻遍了捆绑设置，但无济于事，用谷歌搜索，等等。所以它一定是我想念的简单的东西，或者没有人想那样做。我假设是第一个。）

PS 几周前我从 Windows 转换过来，所以不要以为我是 Mac 专家。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T12:47:07.077

这是一种方法：

1.  捆绑包 > 捆绑包编辑器 > 显示捆绑包编辑器
2.  展开“C”
3.  选择“运行”命令
4.  在这种情况下用“CLANG”替换“GCC” `when "objc"`（它是`g`变量）

# c# - GetCookie 提取信息到字符串

> ID：11378467
> 
> 赞同：1
> 
> 时间：2012-07-07T20:41:58.747
> 
> 标签：c#, cookies

我正在尝试从通过 Set-Cookie 获得的 cookie 中获取数字信息我需要`&om=-&lv=1341532178340&xrs=`这里的数字

这就是我想出的：

```
 string key = "";
        ArrayList list = new ArrayList();
        foreach (Cookie cookieValue in agent.LastResponse.Cookies)
        {
            list.Add(cookieValue);

        }
        String[] myArr = (String[])list.ToArray(typeof(string));
        foreach (string i in myArr)
        {

            // Here we call Regex.Match.
            Match match = Regex.Match(i, @"&lv=(.*)&xrs=",
                RegexOptions.IgnoreCase);

            // Here we check the Match instance.
            if (match.Success)
            {
                // Finally, we get the Group value and display it.
                 key = match.Groups[1].Value;
            }
        }

 agent.GetURL("http://site.com/" + key + ".php"); 
```

我遇到的问题是我无法将 ArrayList 更改为 String （错误是：“源数组中的至少一个元素无法转换为目标数组类型。”），我想你们可以帮助我，也许你们可以想出一种方法来修复它或更好的代码来做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:52:01.553

在第一个循环中，您正在构建一个`ArrayList`包含`Cookie`实例的对象。不可能像您在第二个循环之前尝试做`Cookie`的那样简单地转换 from 。`string`

获取所有 cookie 值的一种简单方法是使用 LINQ：

```
IEnumerable<string> cookieValues = agent.LastResponse.Cookies.Select(x => x.Value); 
```

如果您仍在使用 .NET Framework 2.0，则需要使用循环：

```
List<string> cookieValues = new List<string>();
foreach (Cookie cookie in agent.LastResponse.Cookies)
{
    cookieValues.Add(cookie.Value);
} 
```

然后，您可以像以前一样迭代此集合。但是，您是否知道，如果多个 cookie 与您的正则表达式匹配，则匹配的最后一个将存储到`key`? 当有多个匹配的 cookie 时，不知道您希望它如何工作，但如果您只是想要第一个，您可以再次使用 LINQ 使您的代码更简单，并在一个查询中完成几乎所有您需要的事情：

```
var cookies = agent.LastResponse.Cookies;
string key = cookies.Cast<Cookie>()
    .Select(x => Regex.Match(x.Value, @"&lv=(.*)&xrs=", RegexOptions.IgnoreCase))
    .Where(x => x.Success)
    .Select(x => x.Groups[1].Value)
    .FirstOrDefault(); 
```

如果没有匹配，`key`则为空，否则，它将包含第一个匹配项。该`Cast<Cookie>()`位对于启动类型推断是必要的 - 我相信它会返回一个未实现`agent.LastResponse.Cookies`的实例。`CookieCollection``IEnumerable<Cookie>`

# d - 泛型类型的签名约束

> ID：11378470
> 
> 赞同：4
> 
> 时间：2012-07-07T20:42:16.993
> 
> 标签：d

```
struct S(int a, int b) { }

void fun(T)(T t) { } 
```

我只想`fun`合作`S`。签名约束是什么样的？

我不能成为`fun`的成员`S`，并且`void fun(T)(T t) if(is(T : S)) { }`我得到`Error: struct t1.S(int a,int b) is used as a type`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T22:14:56.907

`S`不是类型。它是一种类型的模板。`S!(5, 4)`是一种类型。很可能不同的实例化*生成*`S`完全*不同*的代码，因此 的定义`S!(5, 4)`可能与. 例如，可以是*`S!(2, 5)``S`*

 *```
struct S(int a, int b)
{
    static if(a > 3)
        string foo;

    static if(b == 4)
        int boz = 17;
    else
        float boz = 2.1;
} 
```

请注意，成员变量的数量和类型不同，因此您不能真正使用 an`S!(5, 4)`代替`S!(2, 5)`. 它们也可能是命名的结构`U`，并且`V`对于它们彼此之间真正具有的所有关系根本没有被模板化。

现在，特定模板的不同实例化在其 API 方面通常是相似的（或者它们可能不会使用相同的模板完成），但从编译器的角度来看，它们彼此没有关系。因此，处理它的正常方法是仅在类型的 API 上使用约束，而不是在其名称或实例化模板上使用约束。

因此，如果您希望`S`拥有函数`foo`、`bar`和`foozle`，并且希望`fun`使用这些函数，那么您将构建一个约束来测试给定的类型是否`fun`具有这些函数以及它们是否按预期工作。例如

```
void fun(T)(T t)
    if(is({ auto a = t.foo(); t.bar(a); int i = t.foozle("hello", 22);}))
{} 
```

然后，任何类型如果有一个返回值的被调用`foo`函数，一个`bar`可能返回值或不返回值并接受结果的`foo`命名函数，以及一个`foozle`接受 a`string`和 an`int`并返回 an的函数，都`int`将与 . 一起编译`fun`。因此，`fun`比您坚持只采用`S`. 在大多数情况下，这些约束被分离到单独的同名模板（例如`isForwardRange`或`isDynamicArray`）中，而不是将原始代码放在一个中`is expression`以便它们可重用（并且对用户更友好），但是这样的表达式是此类同名模板在内部使用的。

现在，如果你*真的*坚持限制`fun`它只适用于 的实例化`S`，那么我知道有两个选项。

**1.**添加某种类型的声明，它`S`总是有并且你不希望任何其他类型有。例如

```
struct S(int a, int b)
{
    enum isS = true;
}

void fun(T)(T t)
    if(is(typeof(T.isS)))
{} 
```

请注意，声明的实际值无关紧要（其类型也无关紧要）。这是一个简单的事实，即您正在测试它。

**2.**更优雅（但不太明显的解决方案）是这样做：

```
struct S(int a, int b)
{
}

void fun(T)(T t)
    if(is(T u : S!(i, j), int i, int j))
{} 
```

[`is`表达式](http://dlang.org/expression.html#IsExpression)一旦变得非常复杂，就会倾向于接近巫毒，但带逗号的版本正是您所需要的。`T u`是您正在测试的类型和标识符；`: S!(i, j)`给出您想要`T`实例化的模板专业化；其余的是`TemplateParameterList`声明在左边的东西中使用但以前没有声明过的符号 - 在这种情况下，`i`和`j`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-26T16:23:25.623

我认为其他答案中有一些小红鲱鱼。您可以使用模式匹配来确定 T 是否是 S 的某个实例，如下所示。

最简单的方法是仅对参数本身进行模式匹配：

```
void fun(int a, int b)(S!(a, b) t) {
} 
```

更一般地，您可以在模板约束内进行模式匹配：

```
void fun(T)(T t) if (is(T U == S!(a, b), int a, int b)) {
} 
```

在这两种情况下，您都可以访问实例化参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-07T20:46:24.920

*“`S`仅使用”*在 D 中实际上没有意义，因为 `S`它不是类型，而是*模板*。

与其他语言不同，模板*本身就是*D 中的“东西”。

你写的是一个**简写**：

```
template S(int a, int b) { struct S { } } 
```

所以*type*的全名是`S(a, b).S`, 无论`a`你`b`使用什么。没有办法让它“一般地”指`S`.

如果您需要设置这样的约束，我建议在里面放一些私有的东西`S`，并检查它`T`是否具有相同的成员。*

# javascript - 如何使用 JavaScript 更改 onClick，包括函数参数

> ID：11378472
> 
> 赞同：0
> 
> 时间：2012-07-07T20:42:47.157
> 
> 标签：javascript

在**JavaScript**`onclick`中，我可以通过传统方式分配：

```
button.onclick = engineStop(); 
```

但是如何分配给`onclick`带有参数的函数呢？

这不起作用>>

```
button.onclick = engineStop(this); 
```

该函数需要接收`this`参数才能知道单击了哪个按钮。

请建议...（没有jQuery）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:44:26.000

```
button.onclick = function() {engineStop(this);}; 
```

使用匿名函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T20:44:33.253

像这样：

```
function engineStop(param){
    return function(){
        //engineStop function's body here,
        //which uses 'param' argument
    };
}
button.onclick = engineStop(this); 
```

# ruby - 在 Ruby 中将日期时间转换为 UTC

> ID：11378479
> 
> 赞同：1
> 
> 时间：2012-07-07T20:44:18.273
> 
> 标签：ruby, datetime, date, time, utc

我想以以下格式显示日期和时间

2012 年 7 月 7 日星期六 19:28:06 UTC

我一直无法找到最后离开 UTC 的转换方法。

我目前正在使用以下

```
t = Time.now.utc.strftime("%a, %B %d, %Y %H:%M:%S %Z") 
```

但是，这显示以下内容

格林威治标准时间 2012 年 7 月 7 日星期六 19:28:06

我想最后看到 UTC 而不是 GMT。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T20:52:17.867

根据[时代文档](http://www.ruby-doc.org/core-1.9.3/Time.html)：

> Time 类将 GMT（格林威治标准时间）和 UTC（协调世界时）视为等效的。

运行代码时，我的系统最后会显示“UTC”。无论出于何种原因，您的系统更喜欢“GMT”这个绰号。由于这只是化妆品，您可以使用：

```
Time.now.utc.strftime("%a, %B %d, %Y %H:%M:%S UTC") 
```

# jquery - jQuery，我想要一个解释。为什么这行得通？$($('div'))

> ID：11378482
> 
> 赞同：1
> 
> 时间：2012-07-07T20:44:58.377
> 
> 标签：jquery, css-selectors

我很好奇。这个：

```
$('div'), this $($('div')), and this $($($('div')))... and so on 
```

似乎都可以作为 HTML 元素的选择器。有谁知道为什么这样做，如果有任何实际（除了冗余），这样做时会出现问题吗？

[http://jsfiddle.net/NpT2b/](http://jsfiddle.net/NpT2b/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T20:49:01.527

jQuery 函数可以将现有的 jQuery 对象作为其参数。这是记录在案的故意行为。看看这里的手册：http: [//api.jquery.com/jQuery/](http://api.jquery.com/jQuery/)

它也不特定于 HTML 元素。`$( $('#foo') )`会工作。

我过去利用的一个原因是让函数接受选择器***或******jQuery***对象。所以我可以写一个函数：

 *```
function excite(target) {
    $(target).append(' This is exciting!');
}; 
```

可以安全地使用`excite('.foo');`或使用`excite( $('p:not(.exciting-already)').empty() );`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T20:47:44.500

如果 jQuery 接收到一个 jQuery 对象，它不需要做任何事情，因此返回原样的 jQuery 对象。

这通常用于处理不道德的编码人员，他们可能会不小心将 jQuery 对象放回`$()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T20:47:25.980

jQuery 选择器将字符串、HTML 元素或其他 jQuery 对象作为选择器。在这种情况下，您的第一个示例选择`<div>`页面上的所有元素。在您的第二个示例中，您重新选择了所有`<div>`元素的 jQuery 集。在您的第三个示例中，您正在重新选择集合。除了完全和完全冗余之外，这可以无限期地继续下去而不会出现任何问题。*

# object - 删除 NSMutableSet 核心数据中的对象

> ID：11378483
> 
> 赞同：0
> 
> 时间：2012-07-07T20:45:14.967
> 
> 标签：object, core-data, nsmutableset

我在`NSMutableSet`使用核心数据中删除对象时遇到问题。我试图在我的表格视图的第二部分中删除一个“播放器”对象。我收到错误消息；

> 无效更新：第 1 节中的行数无效。更新后现有节中包含的行数 (6) 必须等于更新前该节中包含的行数 (6)，加上或减去数字从该部分插入或删除的行数（0 插入，1 删除）加上或减去移入或移出该部分的行数（0 移入，0 移出

*解决方案*

看看我的代码。

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle          forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {

        if (indexPath.section==0) {

        }else{

            _player = [self.fetchedResultsController.fetchedObjects objectAtIndex: indexPath.row];
            [self.managedObjectContext deleteObject:_player];
            [self performFetch];
            [self.managedObjectContext save:nil];

            // here the solution to make it works...
            [self.tableView reloadSections:[NSIndexSet indexSetWithIndex:1]  withRowAnimation:UITableViewRowAnimationFade];               
        }            
    }   
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    switch(section){
        case 0:
            return 4;
        case 1:
            return [self.fetchedResultsController.fetchedObjects count];
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T13:14:04.617

一般当你需要从表格视图中删除或移除元素时，你需要执行一个两步操作：

1.  处理模型
2.  处理表格动画

你只表演了第一部分。要完成，您需要执行如下调用

```
[tableView beginUpdates];
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath]
        withRowAnimation:UITableViewRowAnimationFade];
[tableView endUpdates]; 
```

如果您对表格执行多个动画，例如删除、修改等，则需要包装`deleteRowsAtIndexPaths:withRowAnimation:`中间。这里不是这种情况，但无论如何您都可以这样做。`beginUpdates``endUpdates`

`NSFetchedResultsController`当您使用核心数据时，您可以使用它的委托免费（您必须编写一些代码）`NSFetchedResultsControllerDelegate`。因此，当您通过调用（第 1 步）删除元素时`deleteObject`，委托将自动响应该更改并执行第 2 步。

查看[如何使用 NSFetchedResultsController](http://www.raywenderlich.com/999/core-data-tutorial-how-to-use-nsfetchedresultscontroller)以了解如何正确设置它。

上面代码的修复是使用

```
[self.tableView reloadSections:[NSIndexSet indexSetWithIndex:1]  withRowAnimation:UITableViewRowAnimationFade]; 
```

希望有帮助。

# django - 在 Django 中将跨多个模型的业务逻辑放在哪里

> ID：11378494
> 
> 赞同：1
> 
> 时间：2012-07-07T20:46:29.983
> 
> 标签：django, model-view-controller, django-models

你不需要阅读所有这篇文章来帮助我回答这个问题，这篇文章的其余部分只是问题出现的上下文，但一般问题是：

**在 Django 中将跨多个模型的业务逻辑放在哪里？**

一些可能性：

*   一些观点？（我不这么认为，它必须在管理员和几个视图中工作，DRY）
*   在模型/表单中保存方法？（如何？）
*   模型/表单中的清洁方法？（如何？）
*   拆分逻辑并使用信号？（如何？）
*   其他？

**语境：**

我有这个模型：

1.  部门：参考公司的不同部门（风险、财务、IT、...）
2.  员工：可能在一段时间内只属于一个部门，然后转入另一个部门。
3.  项目：每个部门可以有多个项目，一个项目属于多个部门。
4.  Membership：Employee 和 Department ManyToMany 关系之间的中间表，包括 join_date 和 leave_date 等其他字段，重要字段是 fk:Department，fk:Employee
5.  历史：Membership 和 Project 之间的中间表，让我知道哪个员工参与了希望项目，当他在某个部门工作时，重要的字段是 fk:Membership，fk:Project。
6.  CurrentProjects：将部门与他们当前正在进行的项目相关联的表格。

假设我在 Django 管理员中，我去部门 Risk，并且 Risk 目前已分配 Project1 和 Project2。当我添加一个新员工“Jhon Smith”（例如，在部门中使用内联表单）并按下保存按钮时，我希望模型历史记录使用以下信息进行更新：

```
成员表（仅重要字段）：

pk 部门员工 join_date leave_date
20 风险 Jhon Smith xxxx xxxx

历史表（仅重要字段）：

会员项目
20 项目1
20个项目2

```

我的意思是当一个新员工被分配到一个新部门时，该部门的所有实际项目都必须分配给历史表中的该成员资格员工部门。

问题是在 Django 中将这个逻辑放在哪里？如您所见，此逻辑涉及多个模型，一些可能性是：

*   在某些方面（我不这么认为，它必须在管理界面和其他地方工作）
*   在 Membership、Department 或 Employee 模型/表单的 clean 方法中？
*   在 Membership、Department 或 Employee 模型/表单的保存方法中？
*   我必须拆分逻辑并使用信号之类的东西？（一些例子？）
*   其他的？
*   我把一切都复杂化了？=)

注意事项：如果代码可以在过程中的任何时候生成 valueerror 并且用户/管理员能够以无限制的形式看到这个错误，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:47:48.900

我只是在评论逻辑应该存在的方面。这对我来说听起来像是模型逻辑。Django 对 MVC 的概念有些混杂。当它纯粹是数据关系时，我相信它的所有模型逻辑。我建议将方法尽可能靠近它们影响的模型，并简单地从触发模型中进行最小的调用。

如果您非常关心应用程序的解耦，那么您可以使用信号。模型 A 不知道它需要在保存期间调用 XYZ，而是采用了另一种方式。模型 A 只是发出一个信号。XYZ 将负责连接到信号。你甚至可以在一个完全通用的项目应用程序中定义你的信号，在这种情况下，触发或接收模型都不知道彼此的动作。它只是将它们绑定在一起。

有一些内置信号，例如在模型上[保存之前和之后](https://docs.djangoproject.com/en/dev/ref/signals/#django.db.models.signals.post_save)，这意味着如果您正在寻找保存触发器，则不必发出自定义内容。但是让我们说在一个模型逻辑的各个点上，您需要发出一个自定义信号，例如“名称已更改”，您可以发出自己的信号。

**A型**

```
import django.dispatch

name_changed = django.dispatch.Signal(providing_args=["name"])

class ModelA:
    ...

    def foo:
        # something happened here
        name_changed.send(sender=self, name=the_name) 
```

**B、C、D 型**

```
from myApp.modelA import name_changed

name_changed.connect(modelB.handle_name_change, dispatch_uid="my_unique_identifier")
name_changed.connect(modelC.handle_name_change, dispatch_uid="my_unique_identifier")
name_changed.connect(modelD.handle_name_change, dispatch_uid="my_unique_identifier") 
```

就我个人而言，我习惯为需要一些通用“控制器模型”逻辑的应用程序创建一个 utils.py 模块。它们更像是动作或助手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:48:44.117

也许问题在于您那里的“历史”表。我不知道你的`Project`表中有什么样的信息。但是，如果每个项目都有开始和结束日期，那么您的历史表正在处理重复信息。在这种情况下，如果您想知道员工在哪个项目中工作，您只需要知道该员工在该部门工作的日期，然后您需要找到该部门在该部门之间开发的项目。上一个日期范围。

我希望你明白我的意思。如果不是，请告诉我，以便我更好地解释（也许有一个例子）。

但是，当我了解您的问题和模型时，我认为您不需要该历史记录表。它会重复信息...

因此，如果您的`Project`模型具有此信息（日期范围），则解决方案应该存在于管理器中，因为只需找到您想要存在于多个表中的信息......

希望能帮助到你！

# ruby-on-rails - Carrierwave 通过雾检查远程文件是否存在

> ID：11378495
> 
> 赞同：14
> 
> 时间：2012-07-07T20:46:32.113
> 
> 标签：ruby-on-rails, carrierwave, fog

我知道我在这里错过了一些非常简单的东西......

`CarrierWave::Storage::Fog::File`有一个方法[存在](https://github.com/jnicklas/carrierwave/blob/master/lib/carrierwave/storage/fog.rb)吗？

我该如何使用它？我只是想检查远程存储上是否存在以前上传的文件。

我的图像对象和上传器对象都无法访问此方法。当然我不必创建一个新`CarrierWave::Storage::Fog::File`对象来测试文件是否存在？

如果是这样，我应该输入什么参数？它需要以下内容：上传器、基础、路径（我使用了上传器、存储目录和图像 url，但这不起作用）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-08-04T12:12:00.037

假设您有一个模型用户，其中包含您使用 Carrierwave 的现场图像。你现在可以写：

```
user = User.first
user.image.file.exists? 
```

这将执行返回 true 或 false 的远程检查

# git - “make clean”不清除 Automake 的依赖关系？

> ID：11378496
> 
> 赞同：6
> 
> 时间：2012-07-07T20:46:34.203
> 
> 标签：git, dependencies, makefile, automake

我有一个使用 Autoconf 和 A​​utomake 的 C++ 项目。我认为我的目录中有太多源文件`src`，并将一些文件移动到子目录中。然后，我修改`Makefile.am`并将这些文件从 更改`source.cpp`为`subdir/source.cpp`。我知道这种方法应该有效，就像我之前为一些新文件所做的那样（但后来我没有重命名任何东西）。现在我像往常一样运行以下命令：

```
autoreconf
./configure
make clean
make 
```

我收到类似这样的错误消息：

```
No rule to make target "source.cpp" needed for "source.o" 
```

我不明白出了什么问题。我检查了我的 Makefile，但它似乎是正确的。所以我将我的 git 存储库克隆到了一个新的地方，并在那里尝试了一个 make，它工作了。没问题，我想，并`git clean -xf`在我的原始目录上做了一个。在此之后，编译仍然无法正常工作。现在我对两个目录结构进行了比较（又一个`git clean -xf`，发现还有一个`.deps`目录。删除后，它编译了。

故事的寓意如下：

*   `make clean`不删除依赖项。
*   `git clean -xf`不会删除依赖项（可能是因为隐藏目录）。

有没有办法让`make clean`（或可能`git clean`）自动删除这个目录？当然我可以手动完成，但是清理后留下依赖文件非常烦人。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-09T18:24:40.270

> 有没有办法让 make clean （或者可能是 git clean ）自动删除这个目录？

使用`make distclean`而不是`make clean`将删除`.deps`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:55:47.683

`make clean`只是做你的makefile中的干净目标。如果要删除`.deps`目录，请添加

```
clean::
        rm -rf .deps 
```

到 Makefile。

如果您想`git clean`为您执行此操作，只需添加`-d`标志： `git clean -fxd`也会清除未跟踪的子目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-26T20:58:07.643

如果你愿意跑`git clean -xf`，你就应该愿意跑`git clean -xfd`。

来自`git help clean`：

> `-d Remove untracted directories in addition to untracted files.`

# c++ - C++11的多线程模型

> ID：11378498
> 
> 赞同：3
> 
> 时间：2012-07-07T20:47:20.880
> 
> 标签：c++, multithreading, c++11

我想了解更多关于 c++11 多线程模型的信息。谷歌搜索我可以找到很多示例、演示等，但有些东西对我来说并不明显。

我们在大学的操作系统课程中研究了线程概念。当然，这与特定的实现或语言无关。以下段落来自 Abraham Silberschatz、Greg Gagne 和 Peter Baer Galvin，“操作系统概念，第八版”，第 4 章：

> 4.2 多线程模型
> 
> 现代系统中有两种类型的线程需要管理：用户线程和内核线程。内核之上支持用户线程，没有内核支持。这些是应用程序程序员将放入他们的程序中的线程。
> 
> 操作系统本身的内核支持内核线程。所有现代操作系统都支持内核级线程，允许内核
> 
> *   执行多个同时任务和/或服务多个内核
> *   系统调用同时进行。
> 
> 在特定实现中，必须使用以下策略之一将用户线程映射到内核线程：
> 
> 4.2.1 多对一模型
> 
> 4.2.2 一对一模型
> 
> 4.2.3 多对多模型

那么c++11支持哪些模型呢？AFAIK`c++`不应该用于特定种类的操作系统。所以标准库应该只支持用户空间线程，对吧？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T20:53:47.140

关于您询问的问题（即用户级或内核级线程及其实现），C++11 标准没有指定*任何内容*。因此，任何遵循标准规则的实现（可能是您提到的任何一个 - 规则不涉及线程模型的实现细节）。当然，如果你写的是用户空间程序，那么自然遵循 C++11 的线程就会是用户空间线程。但是该标准对“用户空间”或“内核空间”一无所知，因此如果您选择在 C++11 中实现 OS 内核，则线程将（自然如上）内核线程。

从某种意义上说，C++11 标准不支持这些线程模型（例如，没有 API 可以获取线程并指定“这必须是内核线程，或者单独的 lwp 或其他东西”）。另一方面，它支持所有这些（例如，建立在任何用户内核线程映射概念上的线程库可以提供 C++11 线程）。

# database - flex 本地数据库 lastInsertId = 0

> ID：11378507
> 
> 赞同：1
> 
> 时间：2012-07-07T20:48:08.557
> 
> 标签：database, actionscript-3, sqlite, air, last-insert-id

```
var insertReq:SQLStatement = new SQLStatement(); 
insertReq.addEventListener(SQLErrorEvent.ERROR, dbErrorHandler);
insertReq.sqlConnection = conn; 
insertReq.text = "INSERT INTO table1 (inputTime) VALUES (DATETIME('now'))";
insertReq.execute();
insertReq.text = "SELECT last_insert_rowid() as ID";
insertReq.execute();
var lastInsertId:int = insertReq.getResult().data[0].id;
trace(lastInsertId); 
```

我创建了一个本地数据库，我正在尝试插入一些数据，但我得到了`lastInsertId`零？！我在哪里搞砸了！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:04:05.467

您不需要额外执行查询来检索最后插入的行的 id 。为此目的， [**SQLResult类有一个内置的**](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/data/SQLResult.html)[**.lastInsertRowID**](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/data/SQLResult.html#lastInsertRowID)属性。像这样使用它：[](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/data/SQLResult.html)

 **```
var insertReq:SQLStatement = new SQLStatement(); 
insertReq.addEventListener(SQLErrorEvent.ERROR, dbErrorHandler);
insertReq.sqlConnection = conn; 
insertReq.text = "INSERT INTO table1 (inputTime) VALUES (DATETIME('now'))";
insertReq.execute();
var lastInsertId:int = insertReq.getResult().lastInsertRowID;
trace(lastInsertId); 
```**

# ruby-on-rails - Rails 迁移以生成日历表

> ID：11378510
> 
> 赞同：1
> 
> 时间：2012-07-07T20:48:54.047
> 
> 标签：ruby-on-rails, database, activerecord, rails-migrations

如何编写 Ruby on Rails 迁移以生成日历表，所有日期都在 2010 年 1 月到 2099 年 12 月之间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-21T16:35:23.843

当我再次发现这个问题时，供我自己参考。

架构：

```
create_table :calendar_days, primary_key: :day, id: :date do |t|
  t.integer :year, null: false
  t.integer :month, null: false
  t.integer :day_of_month, null: false
  t.integer :day_of_week, null: false
  t.integer :quarter, null: false
  t.boolean :business_day, null: false
  t.boolean :week_day, null: false
end

class CalendarDay < ActiveRecord::Base
  self.primary_key = :day
end 
```

数据：

```
# Non-exhaustive, needs to be customized for your needs.
def business_day?(d)
  matches = ->(month, day) { [month, day] == [d.month, d.day] }
  falls_on = ->(month, wday, r) {
    [month, wday] == [d.month, d.wday] && r.cover?(d.day)
  }

  return false if [0,6].include?(d.wday) # Weekends
  return false if matches[1, 1]   # New Years
  return false if matches[7, 4]   # Independence Day
  return false if matches[12, 25] # Christmas
  return false if matches[11, 11] # Veterans Day
  return false if falls_on[1,  1, 15..21] # MLK Day
  return false if falls_on[5,  1, 25..31] # Memorial Day
  return false if falls_on[9,  1, 1..7]   # Labor Day
  return false if falls_on[11, 4, 22..28] # Thanksgiving
  true
end

task populate_calendar_days: :environment do
  (Date.new(2013,1,1)...Date.new(2014,1,1)).each do |d|
    CalendarDay.create!(
      day:          d,
      year:         d.year,
      month:        d.month,
      day_of_month: d.day,
      day_of_week:  d.wday,
      quarter:      (d.month / 4) + 1,
      week_day:     ![0,6].include?(d.wday),
      business_day: business_day?(d)
    )
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:39:43.410

我不明白你在做什么，但如果你想用 2010 年 1 月到 2099 年 12 月的日期填充表格并进行迁移，

你可以用一些东西

```
class CreateCalendar < ActiveRecord::Migration
  def change
    create_table :calendars do |t|
      t.date :date
      t.timestamps
    end
  end
  (Date.new(2010,1,1)..Date.new(2099,12,31)).each do |date|
    Calender.create(:date=> date )
  end
end 
```

# nosql - 安装和连接 Couchbase 客户端 ASP.NET

> ID：11378512
> 
> 赞同：2
> 
> 时间：2012-07-07T20:49:03.623
> 
> 标签：nosql, couchbase

我真的无法将我的 c# 客户端与 couchbase DB 连接起来。我真的不知道我做错了什么.. 还有为什么我的服务器名称是 192.168.1.3 是什么意思？

服务器：

![在此处输入图像描述](../Images/86c7cf8126d50a10c90c1fbd6082689c.png)

创建测试数据库： ![在此处输入图像描述](../Images/d8da6aef9066bec759f336623591aed7.png)

检查防火墙端口： ![在此处输入图像描述](../Images/0bf19d8e50aaa59537e3135220c0df54.png)

我的 web.config： ![在此处输入图像描述](../Images/94d0dcb9775a67f9eb96aebd1b0efcdf.png)

最后是我的 C# 代码： ![在此处输入图像描述](../Images/bb2cd1e66a9eba1a3677d6296d21441c.png)

再一次，我做错了什么以及该服务器名称的含义是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T15:09:04.560

您在 app.config 中使用的引导 URI 不应为 /pools/test。实际上，我很惊讶它给出了结果。主池始终是默认的，因此它应该是 /pools 或 /pools/default。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-14T22:02:06.447

非常感谢你，Mike737。我没有注意到一个角色的情况，有点迷失在那里。更正存储桶名称的大小写解决了我的问题。

# c++ - 了解 C++ 重构语法

> ID：11378515
> 
> 赞同：2
> 
> 时间：2012-07-07T20:49:13.137
> 
> 标签：c++, syntax, constructor, scope, language-lawyer

我们可以在创建对象后再次调用它的构造函数吗？

```
#include <iostream>

struct A
{
    A ( ) { std::cout << "A::A" << std::endl; }
    ~A ( ) { std::cout << "A::~A" << std::endl; }
};

int main( )
{
    A a;
    a.~A();    // OK
    a.A::A();  // OK in Visual Studio 2005, 2008, 2010

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T21:10:47.297

您不应该像这样调用构造函数，作为成员函数调用。原因是（n3242, 12.1/2）：

> 构造函数用于初始化其类类型的对象。因为构造函数没有名称，所以在名称查找过程中永远找不到它们；然而，使用函数符号 (5.2.3) 的显式类型转换将导致调用构造函数来初始化对象。

如果你真的想在应该是一个对象的东西上调用构造函数——除非在非常特殊的情况下你不应该这样做——你可以使用调用构造函数的placement new：

```
new (&a) A(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-07T21:04:06.560

好吧，`a.A()`编译失败是因为您根本无法在 C++ 中调用构造函数。（您可以通过多种方式间接调用它。）出于同样的原因，我认为`a.A::A()` *不应该*编译。

# bash - 如何在终端的文本文件中放置标签？

> ID：11378516
> 
> 赞同：20
> 
> 时间：2012-07-07T20:49:26.237
> 
> 标签：bash, shell, scripting, terminal

当我使用终端查找过去 24 小时内完成的所有工作时，我会得到一个文本文件，其中包含如下行：

ABC 12345 工作于 DATE

DEF 67890 DATE 的另一份工作

GHI 10112 日期的最终作业

这个文本文件最多可以有一百行。我必须将所有这些数据插入 Microsoft Excel 的表格中。为了让我的生活更轻松，我想弄清楚如何在每行的数字后面添加一个标签。

像这样的东西：

```
echo "ABC 12345 <tab> Job Worked on DATE" >> jobs.txt
echo "DEF 67890 <tab> Another Job on DATE" >> jobs.txt
echo "GHI 10112 <tab> Final Job on DATE" >> jobs.txt 
```

我将如何实现这一目标？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-07T20:57:30.673

使用 echo -e 和 \t 作为选项卡。像这样：

```
echo -e "ABC 12345 \t Job Worked on DATE" >> jobs.txt 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-07T20:59:44.610

您可以按下`Ctrl-v``Tab`以键入原始选项卡。

* * *

您还可以使用`$'...'`c-string 语法：

```
echo $'ABC 12345 \t Job Worked on DATE' >> jobs.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:07:34.580

将选项卡附加到第二个字段：

```
awk '{$2 = $2 "\t"; print}' inputfile  > outputfile 
```

类似，但使用正则表达式：

```
sed 's/[[:digit:]]\+/&\t/' inputfile > outputfile 
```

# html - CSS 动画不适用于“溢出：隐藏；”

> ID：11378517
> 
> 赞同：6
> 
> 时间：2012-07-07T20:49:56.960
> 
> 标签：html, css

如果有人能告诉我我做错了什么，我将不胜感激。请看这个[例子](http://jsfiddle.net/c_vilander/GLdQs/7/)。如您所见，当单击按钮时，我试图将“div 2”移动到“div 1”中。它实际上工作正常，第二个 div 按预期出现在第一个 div 中，但由于某种原因，单击不会触发 CSS 动画，这应该给第二个 div 一个幻灯片效果。

我把它缩小到它与“溢出：隐藏”属性有关，因为当它从“div 1”中删除时动画实际上会起作用，但正如你最可能想出的那样，我想要第二个 div只有当它位于第一个 div 时才可见。

为什么动画效果不好？

我正在使用 Chrome，OSX。

提前致谢！

/克里斯托弗

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-07T21:52:57.913

如果您遇到困难，他可以帮助您：

![](../Images/a3a7e6074eae907f2e5f47f073d62e1a.png)

[http://jsfiddle.net/GLdQs/8/](http://jsfiddle.net/GLdQs/8/)

```
.container {
    /* overflow: hidden; */
    clip: rect(auto, auto, auto, auto);
} 
```

不幸的是，它显示了水平滚动条。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T22:59:16.967

另一个技巧可能是移动`overflow: hidden`到动画元素：

[http://jsfiddle.net/GLdQs/9/](http://jsfiddle.net/GLdQs/9/)

```
#id1 {
    width: 0px;
    overflow: hidden;
}

#id1 > p {
    width: 500px; /* you probably want a fixed width for the content  */
}

@-webkit-keyframes slide {
  0%   { left: 500px; top: 0px; width:   0px; }
  100% { left:   0px; top: 0px; width: 500px; }
}

​ 
```

# vb.net - VB.NET 接口

> ID：11378532
> 
> 赞同：2
> 
> 时间：2012-07-07T20:52:55.160
> 
> 标签：vb.net

我了解接口的概念，但是我经常发现很难找到如何使用它们的实际示例。我已经生成了以下代码：

```
Public MustInherit Class Deletion2
    Implements DeletionInterface2

    Public MustOverride Function Delete() As String Implements DeletionInterface2.Delete
    Public Function CheckDate() As Boolean Implements DeletionInterface2.CheckDate
        Return True
    End Function
End Class

Public Class System1Delete
    Inherits Deletion2
    Implements DeletionInterface2
    Overrides Function Delete() As String
        Return "System 1 Deleted"
    End Function

End Class

Public Class System2Delete
    Inherits Deletion2
    Implements DeletionInterface2
    Overrides Function Delete() As String
        Return "System 2 Deleted"
    End Function

End Class

Public Interface DeletionInterface2
    Function CheckDate() As Boolean
    Function Delete() As String
End Interface

Public Class Form1

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

Dim IDeletion As DeletionInterface2
        IDeletion = New System1Delete
        IDeletion.CheckDate()
        IDeletion.Delete()
        IDeletion = Nothing

        IDeletion = New System2Delete
        IDeletion.CheckDate()
        IDeletion.Delete()
        IDeletion = Nothing
End Sub 
```

在上面的示例中（在页面加载中），我使用了对接口的引用来创建对象的实例，但我不明白这样做的真正好处。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:57:28.763

使用像接口（或`MustInherit`类）这样的抽象的好处是，您可以以完全相同的方式对待*任何实现该接口的对象。*

例如，`System.Data`命名空间使用了许多这样的抽象，这意味着实现不同的数据提供者更容易，并且由于核心使用这些抽象，它不需要随着新实现的添加而改变（关于所有不同提供者的东西，内置和第三方 - SQL Server、Oracle、PostGresSQL、MySQL 等）。

# php - FTP中的php代码使用URL备份数据库

> ID：11378534
> 
> 赞同：2
> 
> 时间：2012-07-07T20:53:09.060
> 
> 标签：php, ftp, backup

我资助并将此代码插入到我的 FTP 中的 backup.php 中，效果很好，但它将文件复制到根文件夹（homez/）

1-我想将这些备份文件放在 homez/backupDB 中，知道将这条路径放在哪里吗？

2- db 备份文件 (DB.sql.bz2) 始终具有相同的名称，是否可以用创建日期命名每个文件？（我用 URL 链接启动这个 php）

```
<?
echo "Votre base est en cours de sauvegarde.......

";
$db="nom_de_ma_base";
$status=system("mysqldump --host=mysql5-1.perso --user=$_POST[login] --password=$_POST[password] $db > ../$db.sql");
echo $status;
echo "Compression du fichier.....

";
system("bzip2 -f ../$db.sql");
echo "C'est fini. Vous pouvez récupérer la base par FTP
\n
";
?> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:12:52.873

```
<?
echo "Votre base est en cours de sauvegarde.......

";
$db="nom_de_ma_base";
$status=system("mysqldump --host=mysql5-1.perso --user=$_POST[login] --password=$_POST[password] $db > ../$db.sql");
echo $status;
echo "Compression du fichier.....

";
system("bzip2 -f /homez/backupDB/$db" . date("d-M-Y", time()) . ".sql");
echo "C'est fini. Vous pouvez récupérer la base par FTP
\n
";
?> 
```

# haskell - 定义实例时种类不匹配

> ID：11378535
> 
> 赞同：2
> 
> 时间：2012-07-07T20:53:13.640
> 
> 标签：haskell, types, functional-programming, ghc

我在阅读各种 Haskell 教程时编写的第一个程序给了我一个“Kind mis-match”错误

```
import qualified Data.Vector as V

class SupervisedLearner l where
    learn :: l (Input n) -> Output n

data Input n = Supervised (V.Vector n ,V.Vector n) | Unsupervised (V.Vector n)
data Output n =  Regression n | KClass (V.Vector n) | Bernoulli (n, n)
newtype Perceptron  = Perceptron (V.Vector Float)

instance SupervisedLearner Perceptron  where
    learn = undefined 
```

让我感到困惑的是，当我尝试遵循错误的类型签名时，

```
Kind mis-match
The first argument of `SupervisedLearner' should have kind `*
                                                            -> *',
but `Perceptron' has kind `*'
In the instance declaration for `SupervisedLearner Perceptron' 
```

我似乎无法理解我应该从哪里开始纠正它。所以我的问题有两个，错误在哪里，一般意义上，我是否正确使用了 Haskell 类型类系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:42:38.357

根据您的类定义，您需要定义一个`learn`类型的方法`l (Input n) -> Output n`来`l`创建`SupervisedLearner`. 因此，要使 Perceptron 成为 的实例`SupervisedLearner`，`learn`必须具有类型`Perceptron (Input n) -> Output n`。

但是该`Perceptron`类型不接受任何类型参数，因此`Perceptron (Input n)`不是有效类型。这就是错误消息所抱怨的（kind`*`意味着一个类型不接受任何类型参数，而 kind`* -> *`意味着一个类型接受一个类型参数）。

# php - 具有冗长循环的 PHP 创建不稳定的服务器错误

> ID：11378537
> 
> 赞同：0
> 
> 时间：2012-07-07T20:53:30.503
> 
> 标签：php, loops, sleep

我有一个 PHP 脚本，可以拉下一堆 RSS 提要。为了防止发布者的服务器超载，我使用 PHP 睡眠功能来减慢速度。

整个脚本可能会持续几个小时。

如果我从 GoDaddy 上的 Cron 作业运行它，它会愉快地工作 5 到 10 分钟，然后返回服务器错误。我查了一下，PHP 的最大执行时间是 30 秒，所以我不确定这是否是问题的原因。

如果我在我的 Mac 上运行该作业，我的本地 PHP 的默认最大执行时间也为 30 秒，但如果我从终端运行该脚本，它确实有效，但我不明白为什么。

如何循环超过 30 秒的脚本而不会遇到不可靠性问题？

帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:01:33.967

简短的回答是用于`set_time_limit(0)`允许长时间运行的脚本。您的终端 (CLI) PHP 可能已将其设置为 0。您也可能内存不足，尤其是在 PHP 5.2 或更早版本上。将所有错误记录到一个文件中，然后检查它。

您可以重写您的程序，以便能够在一次运行期间处理数据的子集。这种方法的好处是您可以使用它来运行 24/7 或每五分钟运行一次，这取决于 PHP 环境支持什么。您还可以一次运行多个实例，每个实例都处理自己的数据。

# android - 我可以通过更改内核或使用 GNU 无线电使用我的 Android 手机发送具有特定频率和数据速率的信号吗？

> ID：11378540
> 
> 赞同：1
> 
> 时间：2012-07-07T20:53:39.297
> 
> 标签：android, linux-kernel, signals, gnuradio, usrp

我想以一定的数据速率传输某些数据，而我的 USRP 不支持这种高速率，所以我在想我是否可以通过任何方式更改我的内核（2.6.35.7）以制作移动传输信号，或者是有没有可以做到这一点的应用程序？请帮忙！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T05:51:37.000

理论上是，实际上，不是。问题是没有记录手机的射频模块，除非您知道如何修改手机内部芯片的射频（调制解调器）模块，否则您无法修改手机以传输任何内容。

至于 GNU Radio，我认为（目前）还不能在手机上运行 GR。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T20:09:52.990

首先，您的手机没有使用您与之交互的内核来驱动收音机。您可以使用外部的、USB 连接的（或其他总线）无线电接口，但是将其连接到系统的其余部分（除非您只想在自己的应用程序中使用它）会很困难。

蜂窝、wifi、bt 和其他无线电接口有自己的固件、单独的 cpu，并且通常会因未经授权的修改而面临巨额罚款/监禁（这也是您的设备带有“FCC ID”标签等原因的一部分 - 固件经过测试不会为其他设备的操作制造麻烦等）。

# javascript - JavaScript - 使用数组索引转换为字符串

> ID：11378542
> 
> 赞同：0
> 
> 时间：2012-07-07T20:53:52.083
> 
> 标签：javascript, arrays, string

我从一本书中得到了这段代码，但我不明白这个语句“mm=months[mm]”如何转换为月份名称字符串：

```
function init(){
    var panel = document.getElementById("panel");

    var days=["sun","mon","tue","wed","thur","fri","sat"];
    var months=["jan","feb","mar","apr","may","jun",
    "jul","aug","sep","oct","nov","dec"];

    var now = new Date();

    var yy = now.getFullYear();
    var mm = now.getMonth();
    var dd = now.getDate();
    var dy = now.getDay();

    mm=months[mm];  //convert to month name string
    dy=days[dy];  //convert to month name string

    var str = dy+","+mm","+dd+","+yy;
    panel.innerHTML+="us date string: "+str;
    str = dy+","+dd+" "+mm+","+yy;
    panel.innerHTML+="<br>uk date string: "+str;
}
window.onload=init(); 
```

`mm=months[mm]`我的问题是和`dy=days[dy]`（转换为月份或日期名称字符串）究竟是做什么的。当月份是一个数组时，我不明白这个语句“mm=months[mm]”如何转换为月份名称字符串。这只是数组的一些内置功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:57:24.070

`mm`是语句开头的数字`mm=months[mm]`，因此它返回数组中的`mm`第 th 个值，`months`它是一个字符串。在 JavaScript 中，变量不是严格类型的，因此它会将这个字符串插入到变量中`mm`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T20:58:40.807

`mm`是一个从 0 到 11 的数字，表示您从中检索它的日期对象所特有的月份。`months`是一个包含所有月份名称的数组。如果你说`mm = months[mm]`，你是说等于数组`mm`中位置的字符串`mm`。`months`这很令人困惑，因为它们使用相同的变量名。这样做可能会更好：

```
var mm = now.getMonth();
alert(mm); // will alert 6
var monthName = months[mm]; // will alert July, which is position 7 in the months array 
```

原因`mm`是 6 是因为月份由于某种原因是 0 索引的，这意味着它们从 0 开始到 11；一月为 0，十二月 11 日。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T20:59:36.200

`days`是一个数组。给定 index `dy=0`，`days[dy]`返回`"sun"`，这是数组中的第 0 个值。同样，给定 index `dy=1`，`days[dy]`返回`"mon"`，这是数组中的第一个值。等等。

相同的概念`months`。

但正确的答案应该是“在 Javascript 或 jQuery 中使用一些内置函数”。有关更多详细信息，请参阅此[帖子](http://blog.stevenlevithan.com/archives/date-time-format)。从长远来看，滚动你自己的日期时间转换函数几乎肯定会回来咬你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T21:02:04.353

假设日期是 08，月份是 7 月。

```
var yy = now.getFullYear();   
var mm = now.getMonth();    // month is 7 now
var dd = now.getDate();     // dd is 8 now
var dy = now.getDay(); 
```

现在，

```
mm=months[mm]; 
```

方法，

`mm = months[7];`

`// in months array, at seventh index we have july,`

所以mm是七月。

不，它不转换，而是使用基于索引的数组中的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T21:05:27.170

`mm=month[mm]`取数组中索引处的值`mm`（由 返回`now.getMonth()`）`months`并将其放入`mm`变量中。那个 id 也是一样的`dy=days[dy]`。

我承认代码写得不好。`mm2=month[mm]`并且使用`mm2`after （而不是 "new" `mm`）应该被写出来。

# html - CSS，HTML 问题。我如何让文档的主体从顶部向下某种方式？

> ID：11378544
> 
> 赞同：0
> 
> 时间：2012-07-07T20:54:01.023
> 
> 标签：html, css, positioning, css-position, spacing

基本上我有一个导航栏和一个标题，它们都有属性，位置：固定；顶部：（我插入的值）；我的问题是，很明显，当我编写文档的主体时，文本位于标题/导航栏下方。我需要让文本位于标题和导航栏下方，但没有固定位置。如果需要更多关于代码的信息，只需发表评论即可。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:56:25.410

适用于您的主要内容区域

```
#content {
    margin-top: YOUR HEADER HEIGHT
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:57:02.500

您可以做到这一点的最佳方法是将整个站点放在栏之后，您将其称为 div 之类的容器中的主体。这将使您可以自由地操纵它，并在将来根据您的需要对其进行定制。

用于以像素为单位测量高度。安装firefox的[web开发者扩展](http://chrispederick.com/work/web-developer/)然后重新启动firefox并点击下图指向的选项并使用标​​尺。

如图所示单击杂项并激活“显示标尺” ![在此处输入图像描述](../Images/43a0eb35bcb2c9e62281904c182e6aae.png)

然后单击并拖动以测量并取所表示的高度和宽度

![在此处输入图像描述](../Images/907138fb641233414c03297ec5a8ff2c.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:02:12.473

首先，将主要内容区域包装在一个 div 中（例如 id="wrapper",），然后应用 css：

html 将如下所示：

```
<div id="wrapper">
<p class="title">About</p>
<h6 class="bottom"><marquee>This page is the about page of 'Fred's Page'</marquee></h6>
<p class="body">Main body of document. At the moment it's in a fixed position.</p>
</div> 
```

和CSS：

```
#wrapper{
margin-top: 25px; //your actual navigation bar height. (as @Zoltan Toth suggested)
} 
```

# cakephp - CakePHP - Auth - $current_user - 没有 ID、名字、姓氏等

> ID：11378545
> 
> 赞同：0
> 
> 时间：2012-07-07T20:54:02.930
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

当我登录时：

```
$this->Auth->login($this->request->data) 
```

现在，当我说：

```
$this->set('current_user', $this->Auth->user()); 
```

在我的 $current_user 中**只有**用户名和密码。在我的数据库中没有 ID、first_name、last_name 等。为什么？我需要那个数据！

我试过 $this->Auth->login() - 没有 $this->request->data 但这没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:30:31.157

您不需要将请求数据发送到登录函数，如果匹配，它将根据当前的帖子数据返回一个用户。

这是我的 UserController.php 中的登录功能

```
public function login() {
    if($this->Auth->user()) {
        $this->redirect('/');
    }

    if ($this->request->is('post')) {
        if ($this->Auth->login()) {
            $this->redirect($this->Auth->redirect());
        } else {
            $this->Session->setFlash(__('Invalid username or password.'));
        }
    }
} 
```

要在视图中查找我的用户字段，我在 AppController.php 中进行了如下设置：

```
class AppController extends Controller {

    public function beforeFilter() {
        $this->set('user', $this->Auth->user());
    }

} 
```

然后在`$user`您的所有视图中都可以使用。

```
index.ctp

if($user) {
    echo var_dump($user);
}

array
  'id' => string '15' (length=2)
  'created' => string '2012-06-29 21:50:44' (length=19)
  'modified' => string '2012-06-29 21:50:44' (length=19)
  'group_id' => string '1' (length=1)
  'username' => string 'user' (length=4)
  'email' => string 'email@email.com' (length=15)

echo $user['id']; -> 15
echo $user['email']; -> email@email.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:11:36.887

该`Auth::login()`方法在 2.0 中的工作方式发生了变化。您现在不需要将 post 数据传递给 login 方法，它会自动从请求对象中获取数据。

有关更多信息，请参见此处的红框：http: [//book.cakephp.org/2.0/en/core-libraries/components/authentication.html#identifying-users-and-logging-them-in](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#identifying-users-and-logging-them-in)

# ruby-on-rails-3 - FactoryGirl 的 RSpec 唯一性电子邮件测试失败

> ID：11378546
> 
> 赞同：0
> 
> 时间：2012-07-07T20:54:10.723
> 
> 标签：ruby-on-rails-3, tdd, factory-bot, rspec-rails

## 编辑

使用问题的答案，我将测试更改为正确测试并通过的以下测试。

```
describe "when email is already taken" do
  let(:user_with_same_email) { @user.dup }
  before do
    user_with_same_email.email.upcase!
    user_with_same_email.save
  end

  it { user_with_same_email.should_not be_valid }
end 
```

注意：不使用会使测试失败，因为如果它只是在块中重复，就像在这个问题的选择答案中`let(:user_with_same_email) { @user.dup }`一样，它无法找到变量。`user_with_same_email``before`

* * *

我有一个`User`模型和一个`user_spec.rb`测试文件，它对`User`模型属性进行了各种验证。

以前我在`user_spec.rb`文件顶部写了以下内容来测试`User`模型：

```
describe User do

  before do
  @user = User.new(name: "Example User", email: "user@example.com",
                 password: "foobar88", password_confirmation: "foobar88")
end
... 
```

我想将此模型创建移动到，`FactoryGirl`所以我创建了一个`factories.rb`文件：

```
FactoryGirl.define do
  factory :user do
    name "foo"
    email { "#{name}@example.com" }
    password "foobar99"
    password_confirmation "foobar99"
  end
end 
```

然后我改变了我的`user_spec.rb`：

```
describe User do

  before do
    @user = FactoryGirl.create(:user)
  end
... 
```

现在每个测试都像以前一样通过，除了一个：

```
describe "when email is already taken" do
  before do
    user_with_same_email = @user.dup
    user_with_same_email.email = @user.email.upcase
    user_with_same_email.save
  end

  it { should_not be_valid }
end 
```

现在，除非`FactoryGirl 跳过我的电子邮件唯一性验证，否则我无法弄清楚这里出了什么问题。

我的`User`模型验证代码：

```
class User < ActiveRecord::Base

  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i unless const_defined?(:VALID_EMAIL_REGEX)

  has_secure_password
  attr_accessible :name, :email, :password, :password_confirmation

  has_many :programs

  before_save { self.email.downcase! }

  validates :name, presence: true, length: { maximum: 50 }
  validates :email, presence: true, format: { with: VALID_EMAIL_REGEX },
                    uniqueness: { case_sensitive: false } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:16:51.837

问题是当你说它 { should_not be_valid } 时，RSpec 会检查主题。在这种情况下，主题是 User.new（您在顶部有“描述用户”，因此除非您指定其他内容，否则这是默认设置）。

您想检查 user_with_same_email 的有效性。

**编辑：** 试试这个，我认为它可能有效：

```
describe "when email is already taken" do
  before do
    @user_with_same_email = @user.dup
    @user_with_same_email.email = @user.email.upcase
    @user_with_same_email.save
  end

  it { @user_with_same_email.should_not be_valid }
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T21:41:54.007

看起来您可能正在做（或参考）Michael Hartl 的[Rails Tutorial](http://ruby.railstutorial.org/)。这是我的代码对于您正在做的事情的样子，所以我希望它可以使用：

**规格/模型/user_spec.rb**

```
describe User do

  let(:user) { valid_user }
  subject { user }

  # ...

  context "when email address is already taken" do
    before { save_user(user) }
    it { should_not be_valid }
  end

  # ...
end 
```

**spec/support/utilities.rb**（创建特定用户）

```
def valid_user
  User.new(name:     "Example User", 
           email:    "user@example.com",
           password: "foobar", 
           password_confirmation: "foobar")
end

# ...

def save_user(user)
  user_with_same_email = user.dup
  user_with_same_email.email.upcase!
  user_with_same_email.save
end 
```

供参考：**spec/factories.rb**（只创建任何旧的随机用户）

```
FactoryGirl.define do
  factory :user do
    sequence(:name)  { |n| "Person #{n}" }
    sequence(:email) { |n| "person_#{n}@example.com" }
    password "foobar"
    password_confirmation "foobar"

    # ...
  end
  # ...
end 
```

**更新**：在概述相同问题的[这个 StackOverflow 答案](https://stackoverflow.com/a/10305735/567863)中找到了您正在寻找的答案。我也用我的代码测试了它，它对我有用。

**更新 2**：也更改了我的代码，`FactoryGirl.build`在我想要用户但*不希望将其保存到数据库时使用*。 [这个 StackOverflow 答案](https://stackoverflow.com/a/2697416/567863)帮助我理解。

**规格/模型/user_spec.rb**

```
describe User do

  let(:user) { FactoryGirl.create(:user) }
  subject { user }

  # ...

  context "when email address is already taken" do
    let(:user_with_same_email) do
      FactoryGirl.build(:user, email: user.email)
    end

    subject { user_with_same_email }

    before do
      user_with_same_email.email.upcase!
      user_with_same_email.save
    end

    it { should_not be_valid }
  end
  # ...
end 
```

感谢您提出这个问题。给了我一些思考的食物，并在我自己的代码中进行了一些重构。

# java - 如何测量算法的时间

> ID：11378549
> 
> 赞同：4
> 
> 时间：2012-07-07T20:54:29.547
> 
> 标签：java, time

我有一个算法，我想测量它的工作时间，但我得到 0。如何解决它？开始和结束是一样的。

```
public static String MD5(String message) {
    try {
        long start = System.currentTimeMillis();
        MessageDigest md5 = MessageDigest.getInstance("MD5");
        md5.update(message.getBytes());
        byte[] hashBytes = md5.digest();

        StringBuffer sb = new StringBuffer();
        for (int i = 0; i < hashBytes.length; i++) {
            sb.append(Integer.toString((hashBytes[i] & 0xff) + 0x100, 16)
                    .substring(1));
        }
        long end = System.currentTimeMillis();
        MD5TIME = end - start;
        System.out.println(end);
        System.out.println(start);
        return sb.toString();

    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
} 
```

编辑

但现在不幸的是，当我将静态：MD5 和 SHA-1 写入文件时，它们仍然是 1 和 2。

```
 import java.io.BufferedWriter;
import java.security.MessageDigest;

public class ShortCuts {
volatile static long  MD5TIME = 1, SHA1TIME = 2;
    public static String MD5(String message) {
        try {
            long start = System.nanoTime();
            MessageDigest md5 = MessageDigest.getInstance("MD5");
            md5.update(message.getBytes());
            byte[] hashBytes = md5.digest();

            StringBuffer sb = new StringBuffer();
            for (int i = 0; i < hashBytes.length; i++) {
                sb.append(Integer.toString((hashBytes[i] & 0xff) + 0x100, 16)
                        .substring(1));
            }
            long end = System.nanoTime();
            MD5TIME = end - start;
            System.out.println(MD5TIME);
            return sb.toString();

        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

    public static String SHA(String message) {
        long start = System.nanoTime();
        int[] t = SHA1.prepareDataForSHA1(message);
        SHA1TIME = System.nanoTime() - start;
        return SHA1.doSHA1(t);
    }

    public static void addShortcutsIntoTheFile(BufferedWriter bw, String message) {
        try {
            bw.newLine();
            bw.write("MD5");
            bw.newLine();
            System.out.println(MD5TIME);
            bw.write("TIME: " + MD5TIME);
            bw.newLine();
            bw.write(ShortCuts.MD5(message));
            bw.newLine();
            bw.newLine();
            bw.write("SHA");
            bw.newLine();
            bw.write("TIME: " + SHA1TIME);
            bw.newLine();
            bw.write(ShortCuts.SHA(message));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

} 
```

输出

```
 MD5
TIME: 1
c4909803cf840c8cf0556e16e4cc1483

SHA

TIME: 2
7d3f446eef84b651dc7b519fe5ad4157279cb45e 
```

安慰

```
794076 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T20:55:02.047

用于[`System.nanoTime()`](http://download.oracle.com/javase/6/docs/api/java/lang/System.html#nanoTime%28%29)更精确的测量

**笔记：**

> 此方法只能用于测量经过的时间，与系统或挂钟时间的任何其他概念无关

* * *

**也可以看看**

*   [如何找到运行java程序所花费的时间？](https://stackoverflow.com/questions/6646467/how-to-find-time-taken-to-run-java-program)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T21:04:58.880

或者更好的是，使用专为微基准测试设计的工具：[Google 的 Caliper](http://code.google.com/p/caliper/)

[如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java/4480774#4480774)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T21:00:42.270

您可以增加计时器的分辨率。但是，如果您得到的数字（以毫秒为单位）为零，那么您可以通过一次性计时多次执行功能（1000+）来获得更准确的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T21:16:11.373

更正的代码，工作正常：

```
 import java.io.BufferedWriter;
import java.io.IOException;
import java.security.MessageDigest;

public class ShortCuts {
volatile static long  MD5TIME = 1, SHA1TIME = 2;
    public static String MD5(String message,BufferedWriter bw) {
        try {
            long start = System.nanoTime();
            MessageDigest md5 = MessageDigest.getInstance("MD5");
            md5.update(message.getBytes());
            byte[] hashBytes = md5.digest();

            StringBuffer sb = new StringBuffer();
            for (int i = 0; i < hashBytes.length; i++) {
                sb.append(Integer.toString((hashBytes[i] & 0xff) + 0x100, 16)
                        .substring(1));
            }
            long end = System.nanoTime();
            MD5TIME = end - start;
            System.out.println(MD5TIME);
            bw.newLine();
            System.out.println(MD5TIME);
            bw.write("TIME: " + MD5TIME);
            bw.newLine();
            return sb.toString();

        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

    public static String SHA(String message, BufferedWriter bw) throws IOException {
        long start = System.nanoTime();
        int[] t = SHA1.prepareDataForSHA1(message);
        SHA1TIME = System.nanoTime() - start;
        bw.newLine();
        bw.write("TIME: " + SHA1TIME);
        bw.newLine();
        return SHA1.doSHA1(t);
    }

    public static void addShortcutsIntoTheFile(BufferedWriter bw, String message) {
        try {
            bw.newLine();
            bw.write("MD5");

            bw.write(ShortCuts.MD5(message,bw));
            bw.newLine();
            bw.newLine();
            bw.write("SHA");
            bw.write(ShortCuts.SHA(message,bw));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

} 
```

感谢你的回答。

# c# - 用优雅来逃避进口大象：一个dll进口过多的案例

> ID：11378554
> 
> 赞同：2
> 
> 时间：2012-07-07T20:55:37.990
> 
> 标签：c#, marshalling, dllimport, graphic

我正在使用 DllImport 编写与旧版（2012 年 2 月）C 程序接口的 C# 代码。它工作得很好，但我需要调用 30 多个不同的函数，将我通常无可挑剔、精致的代码变成近乎大象比例的东西。肯定有办法解决这个问题吗？[警告：那些胃虚弱的人可能希望将视线从以下内容中移开]：

```
 [DllImport("C:\\Users\\mitt\\Documents\\Visual Studio 2010\\Projects\\mrSolution\\mr\\x64\\Debug\\mrDll.dll", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
    public static extern bool mrEngine_initialize(     [In, Out, MarshalAs(UnmanagedType.LPStruct)] PLOT_SPEC PlotSpec);
    [DllImport("C:\\Users\\mitt\\Documents\\Visual Studio 2010\\Projects\\mrSolution\\mr\\x64\\Debug\\mrDll.dll", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
    public static extern bool mrEngine_getDataPoint(   [In, Out, MarshalAs(UnmanagedType.LPStruct)] PLOT_SPEC PlotSpec); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:25:03.100

对于 C 风格的 api，这是不可避免的。Windows api 是具有*数千个*功能的主要示例。用把手把它们绑在一起。句柄是*this*的 C 风格等价物，是类对象的对象引用。

下一步是 COM 接口，它允许构建对象模型。在 Windows apis 中很常见，看起来你迷失了那个。

然而，这并不能阻止您使用 C# 类创建自己的对象模型，这些类的方法和属性以逻辑方式映射到底层 C 样式 api。实现您的类成员并进行 pinvoke 调用的丑陋代码可以隐藏在 #region 中，您希望永远不必再查看它。

这样做的好处不止一个。考虑对象模型映射*确实*有助于您理解底层 api。并为您提供大量的单元测试扩展点。并且让您对从混乱中创造秩序感觉*非常好。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:09:38.530

尝试仅在项目中引用 dll。有时它可以正常工作，Visual Studio 会为您完成所有工作。如果 Visual Studio 出于某种原因抱怨，请尝试使用工具[TblImp.exe](http://msdn.microsoft.com/en-us/library/tt0cf3sx%28v=vs.80%29.aspx)。它创建了一个您可以在项目中引用的包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T21:12:39.630

[DllImport](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.dllimportattribute%28v=vs.100%29.aspx)有一个限制，使其仅适用于方法。虽然它可能会变得丑陋，但它**非常简单**，并且真实地反映了它的意图。

我现在想到两件事：

1.  使用部分类并将您的导入拆分为多个文件。它会使每个文件变小，并且不会伤害您的眼睛；
2.  使用[T4](http://msdn.microsoft.com/en-us/library/bb126445.aspx)生成包含导入的类并忘记它的存在。

# html - SUP 元素和圆角

> ID：11378556
> 
> 赞同：1
> 
> 时间：2012-07-07T20:55:45.073
> 
> 标签：html, css

我想为`sup`元素和一些填充添加圆角。

```
<div>Here is my main text<sup>sup text</sup></div>
<style>
  sup {
    background-color:#f00;
  }
</style> 
```

[http://jsfiddle.net/HPzuZ/](http://jsfiddle.net/HPzuZ/)

`sup`元素`display:inline;`默认有。我可以`display:block;`使用填充和圆角设置和操作，但我应该修改 HTML 结构，因为`sup`现在是块。`sup`是否可以在不修改 HTML 结构的情况下使用填充和圆角进行装饰，而只需修改 CSS。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:59:52.180

是的，您可以申请`inline-block`- [http://jsfiddle.net/HPzuZ/1/](http://jsfiddle.net/HPzuZ/1/)

```
sup {
    background-color: #f00;
    display: inline-block;
    border-radius: 3px;
    padding: 0 6px;
}​ 
```

# iphone - 如何检查您在 bash 中运行的设备

> ID：11378558
> 
> 赞同：-1
> 
> 时间：2012-07-07T20:55:48.073
> 
> 标签：iphone, ios, ipad, bash, ipod-touch

我想检查正在运行的设备（iPod/iPhone/iPad）脚本。我怎样才能做到这一点 ？我已经浏览了网络，但我找不到任何有用的东西..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:18:47.703

在 bash 中尝试以下命令：

```
sysctl hw.model
sysctl hw.machine 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:08:33.473

在重击中？？

这就是我实现这一目标的方式（在一个用 Objective-C 编写的 iOS 应用程序中，这是非越狱手机上的唯一方法）：

```
 NSLog(@"%@", [[UIDevice currentDevice] model]); 
```

检查[UIDevice 参考](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIDevice_Class/Reference/UIDevice.html)以了解您可以访问的内容。

编辑：在我的 Mac 上，我可以运行`ioreg -l |grep -i "Device Model Name"`并查看我的设备型号。*也许*在 iOS 中也有类似的东西。

# parsing - 如何使用 XSLT 解析 YouTube 网址？

> ID：11378564
> 
> 赞同：6
> 
> 时间：2012-07-07T20:57:33.170
> 
> 标签：parsing, url, xslt, query-string, c1-cms

我想使用 XSLT 解析一个 youtube url，并只从该 URL 获取视频 ID。使用 XSLT 执行此操作的最佳方法是什么？

所以，如果网址是：[http ://www.youtube.com/watch?v=qadqO3TOvbQ&feature=channel&list=UL](http://www.youtube.com/watch?v=qadqO3TOvbQ&feature=channel&list=UL)

我只想`qadqO3TOvbQ`将其放入嵌入代码中：

```
<iframe width="560" height="315" src="http://www.youtube.com/embed/qadqO3TOvbQ" frameborder="0" allowfullscreen=""></iframe> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T01:20:59.457

**I. 这个 XPath 2.0 表达式**：

```
substring-after(tokenize($pUrl, '[?|&amp;]')[starts-with(., 'v=')], 'v=') 
```

**产生想要的、正确的结果**。

**或者，可以使用稍短的：**

```
tokenize(tokenize($pUrl, '[?|&amp;]')[starts-with(., 'v=')], '=')[2] 
```

**这是一个完整的 XSLT 2.0 转换**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:param name="pUrl" select=
"'http://www.youtube.com/watch?v=qadqO3TOvbQ&amp;feature=channel&amp;list=UL'"/>

 <xsl:template match="/">
   <xsl:sequence select=
    "tokenize(tokenize($pUrl, '[?|&amp;]')[starts-with(., 'v=')], '=')[2]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于任何 XML 文档（未使用）时，将产生所需的正确结果**：

```
qadqO3TOvbQ 
```

* * *

**二、这个 XPath 1.0 表达式**：

```
 concat
   (substring-before(substring-after(concat($pUrl,'&amp;'),'?v='),'&amp;'),
    substring-before(substring-after(concat($pUrl,'&amp;'),'&amp;v='),'&amp;')
   ) 
```

**产生想要的结果**。

**请注意**：

即使命名的查询字符串参数`v`不是第一个，甚至在它是最后一个的情况下，两种解决方案都会提取所需的字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T21:10:14.777

XSLT/XPath 不是最适合字符串处理（尤其是 1.0），但您可以通过混合`substring-after()`和`substring-before()`函数来实现您所需要的：

```
<xsl:value-of select="substring-before(substring-after($yt_url, '?v='), '&amp;feature')" /> 
```

（假设 YT URL 存储在 XSLT var 中`$yt_url`，并且它已`&`转义为`&amp;`）。

[在这个 XML Playground](http://www.xmlplayground.com/ZRy0ix)演示

# jsf - 想要创建一个镜像现有组件功能的自定义组件，但使用不同的渲染器

> ID：11378572
> 
> 赞同：1
> 
> 时间：2012-07-07T20:58:33.147
> 
> 标签：jsf, jsf-2, custom-component, selectonemenu

JSF 组件`SelectOneRadio`布局非常有限，所以我为它编写了一个自定义渲染器，它工作得很好。但是，有时我也想使用标准的 SelectOneRadio 布局。所以我决定让我的新组件利用我创建的自定义渲染器，但我希望这个新组件能够反映 的功能`SelectOneRadio`，唯一不同的是它将使用我的渲染器。在这种情况下，我是否需要同时创建`custom tag`并`custom component`使用我`custom renderer`的？我`class`应该扩展什么来获得所有功能`SelectOneRadio`？如果您能提供一些代码，我将不胜感激。

**编辑**
@BalusC：我喜欢你关于检测`layout`委托正确渲染器的值的想法。因此，如果我有 layout="div_layout"，那么它工作得很好，但如果它是`pageDirection`或`lineDirection`没有出现。我所做的是：我创建了一个类`extends MenuRenderer`并覆盖了`encodeEnd`方法，所以在那里我做了这个

```
String layout = (String) component.getAttributes().get("layout");

if(layout != null){
        if(layout.equals(PAGE_DIRECTION) || layout.equals(LINE_DIRECTION)){
            super.encodeEnd(context, component);
            return;
        } else if (!layout.equals(DIV_LAYOUT)){
            //Throw error message
        }
}
//Continue with my own renderer code 
```

**EDIT2**
上面当我说什么都没出现时，我错了。super.encodeEnd（上下文，组件）；确实渲染了，但不是渲染收音机，而是渲染`select option`标签。所以看来我委托给了错误的渲染器。我需要使用 RadioRenderer 而不是 MenuRenderer。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T23:38:37.557

如果它特定于您自己的 Web 应用程序，那么您可以只替换渲染器。最简单的方法是扩展特定于实现的渲染器，然后根据标准属性之一的值（`layout`是最佳选择）委托给特定于实现的渲染器，或者执行您自己的自定义渲染工作。

我是 Mojarra 的情况，您想扩展[`com.sun.faces.renderkit.html_basic.RadioRenderer`](http://grepcode.com/file/repo1.maven.org/maven2/com.sun.faces/jsf-impl/2.1.0/com/sun/faces/renderkit/html_basic/RadioRenderer.java)然后按如下方式注册它

```
<renderkit>
    <renderer>
        <component-family>javax.faces.SelectOne</component-family>
        <renderer-type>javax.faces.Radio</renderer-type>
        <renderer-class>com.example.ExtendedRadioRenderer</renderer-class>
    </renderer>
</renderkit> 
```

如果您希望实现独立，那么您需要自己编写整个渲染器实现。

如果您希望有一个自定义组件，那么您也需要自己编写它。

# asp.net-mvc - 使用 Razor 引擎和 EF CodeFirst 创建 MVC 应用程序

> ID：11378574
> 
> 赞同：0
> 
> 时间：2012-07-07T20:58:59.543
> 
> 标签：asp.net-mvc, entity-framework, razor, ef-code-first

我正在练习实体框架。我正在使用 Razor Engine 和 EF Code First 练习 Asp.net MVC 框架。在实践中，我发现问题很少。问题是实体框架没有在我的 SQL 中创建数据库。我正在使用 VisualStudio 2011 Beta 版和 MSSQL 2008。我不知道问题是什么。需要帮助。下面是我的代码：

```
 Person.cs

using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;

namespace MvcDemo.Data
{
    public class Person
    {
        [Key]
        public int PersonID { get; set; }

        [Required]
        [StringLength(40)]
        public string FirstName { get; set; }

        [Required]
        [StringLength(30)]
        public int LastName { get; set; }

        public int? Age { get; set; }

        [ForeignKey("PrefixID")]
        public Prefix Prefix { get; set; }

        [Required]
        public int PrefixID { get; set; }

    }
}

    Prefix.cs

using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Text;

namespace MvcDemo.Data
{
    public class Prefix
    {
        public int PrefixID { get; set; }

        [Required]
        [StringLength(20)]
        public string PrefixName { get; set; }
    }
}

MvcContext.cs

using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Linq;
using System.Text;
using MvcDemo.Data;

namespace MvcDemo.DataAccess
{
    public class MvcContext : DbContext
    {
        public MvcContext()
            : base("name = MvcDemoApp")
        {
        }
        public DbSet<Person> People { get; set; }

        public DbSet<MvcDemo.Data.Prefix> Prefix { get; set; }

    }
}

ConnectionString:
<connectionStrings>
    <add name="MvcDemoApp" 
         connectionString="Server=.;Initial Catalog=MvcDemoApp;Integrated Security=true" 
  providerName="System.Data.SqlClient" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T20:29:17.020

如果这是您的所有代码，那么没有创建数据库也就不足为奇了。没有对数据库执行命令的代码。一旦你开始迭代例如`MvcContext.People`或做一些插入，你会注意到数据库被创建了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T20:56:31.507

网上有很多循序渐进的例子。我会选择其中一个，然后走一遍；你可以试试这个，例如：http: [//msdn.microsoft.com/en-us/data/gg685467.aspx](http://msdn.microsoft.com/en-us/data/gg685467.aspx)。它应该涵盖帮助您入门的大部分基础知识。

如果您更喜欢视频而不是文字，请搜索[Channel 9](http://channel9.msdn.com/Shows/HanselminutesOn9/Hanselminutes-on-9-Digging-into-Entity-Framework-4-Code-First-Magic-Unicorn-Edition)或[复数视觉](http://www.pluralsight-training.net/microsoft/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T10:47:31.057

您应该操作包管理器控制台来执行此操作。

打开包管理器控制台窗口并运行“update-database”命令，该命令仍然存在错误，因此您需要在 DbContext 文件中指定“startupprojectname”参数来执行它和连接字符串。

# vb.net - 跨多个上下文实体框架使用实体 4

> ID：11378580
> 
> 赞同：2
> 
> 时间：2012-07-07T21:00:07.007
> 
> 标签：vb.net, entity-framework-4, objectcontext

我有个奇怪的需求，不知道怎么解决。

我有一个包含我所有主要实体的上下文。实体之一是“客户”。

现在我有另一个应用程序，它们是单独上下文中的实体。但是，该应用程序应该能够从主上下文访问客户。如果没有关系，我不介意。我知道客户的密钥并且可以手动访问它。

我想过这样的事情：（例子是伪vb.net）

```
Imports MainModels

Namespace OtherApplication

Dim myMainContext as new MainModels.MainContext

Dim myAppContext as new AppContext

Dim myOrder as order = AppContext.Orders.Find(OrderIdent)

Dim myCustomer as customer = MainModels.MainContext.Customers.Find(myOrder.CustomerKey) 
```

有解决这些要求的通用方法吗？我将这两个上下文分开的原因是 MainContext 不会再改变，而 AppContext 可以扩展。甚至可能有一些其他应用程序的 App2Context。

我发现了以下帖子：通过公开外键选择子集 [http://blogs.msdn.com/b/adonet/archive/2008/11/24/working-with-large-models-in-entity-framework-part -1.aspx](http://blogs.msdn.com/b/adonet/archive/2008/11/24/working-with-large-models-in-entity-framework-part-1.aspx)

发现了类似的问题： [Entity Framework: Multiple models - the current state of thinking？](https://stackoverflow.com/questions/6899548/entity-framework-multiple-models-the-current-state-of-thinking)

# arrays - 对我是否将标量或数组传递给 perl 中的子例程感到困惑？

> ID：11378587
> 
> 赞同：4
> 
> 时间：2012-07-07T21:00:47.460
> 
> 标签：arrays, perl, subroutine, shift, scalar

我刚刚开始学习 perl，我对这个练习感到困惑（来自学习 Perl 第 4 章）。

在 greet() 子例程的开头，我试图将参数 $_ 分配给我的 $name (my $name = $_) 变量，但它不起作用。这本书说要使用“我的名字=班次；” 但我不明白**为什么**。shift 用于从数组中删除一个值，据我所知，我的参数不是数组，它是标量内的字符串！

谁能解释我不明白的地方？

谢谢！这是整个代码。

```
use 5.012;
use warnings;
use utf8;

sub greet {
   my $name = $_;
   state $last_person ;
   if (defined $last_person ) {
          print "Hi $name! $last_person is also here!\n";

   } else {
          print "Hi $name! You are the first one here!\n";
   }
   $last_person = $name;
}

greet( 'Fred' );
greet( 'Barney' );
greet( 'Wilma' );
greet( 'Betty' ); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T21:23:08.523

在 Learning Perl（第 6 版）的第 4 章中，有一节称为**Arguments**。在那里它陈述了以下内容：

> 这意味着第一个子程序参数在 中`$_[0]`，第二个参数存储在 中`$_[1]`，依此类推。`$_`但是 - 这里有一个重要说明 - 这些变量与变量没有任何关系，就像 `$dino[3]`（数组的元素`@dino` ）与`$dino`（完全不同的标量变量）有任何关系。只是参数列表必须在某个数组变量中才能让您的子例程使用它，而 Perl 就是`@_`为此目的使用 。

（[学习 Perl，第 6 版，第 4 章](http://shop.oreilly.com/product/0636920018452.do)）

`$_`因此，当您应该使用`my $name = $_[0];`或时，您可能会误用`my $name = shift @_;`. 为方便起见，当您在子例程中`shift`时，如果您未提供显式参数，则默认为关闭`@_`，因此常见的习惯用法是`my $name = shift;`.

对于那些需要其他资源的人，[perldoc perlintro](http://perldoc.perl.org/perlintro.html#Writing-subroutines)也有一个很好的（并且适当简短的）解释将参数传递给子例程并通过`@_`or访问它们`shift`。

这是一个简短的片段`perlintro`：

> 那是什么`shift`？好吧，子例程的参数可以作为一个特殊的数组提供给我们`@_`（`perlvar`有关详细信息，请参阅）。该`shift`函数的默认参数恰好是`@_`. 因此`my $logmessage = shift;`将第一项从参数列表中移出并将其分配给`$logmessage`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T21:26:04.240

听起来你已经跳过了本章的一部分。你读过*论据*部分吗（最新第六版的第 66 页）。它说

> Perl 将列表传递给子程序；也就是说，Perl 使列表可供子例程根据需要使用。当然，您必须将这个列表存储在某个地方，因此 Perl 在子例程期间自动将参数列表（参数列表的另一个名称）存储在名为 @_ 的特殊数组变量中。您可以访问此数组以确定参数的数量和这些参数的值。
> 
> 这意味着第一个子程序参数在 $_[0] 中，第二个参数存储在 $_[1] 中，依此类推。但是——这里有一个重要的说明——这些变量与 $_ 变量没有任何关系，就像 $dino[3]（@dino 数组的一个元素）与 $dino（一个完全不同的标量变量）有任何关系。 ）。只是参数列表必须在某个数组变量中才能让您的子例程使用它，而 Perl 使用数组 @_ 来达到此目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T21:03:55.257

所有 perl 子例程的参数都存在于一个参数数组中，你的书没有提到。

这个数组是`@_`，在你的情况下，`shift`你将得到你的第一个参数，这将是一个标量。

# python - Python (w/pyglet) 内存泄漏

> ID：11378590
> 
> 赞同：0
> 
> 时间：2012-07-07T21:01:04.907
> 
> 标签：python, memory, memory-leaks, pyglet

在一个非常大的项目中，我正在寻找内存泄漏。到目前为止，我的进展如下：

使用类计数器，

```
import gc
from collections import Counter
def count():
      return Counter(type(o).__name__ for o in gc.get_objects()) 
```

我看到对于程序的每个渲染通道，我都会获得 dicts 和 instancemethods：

```
Counter({'instancemethod': 9714, 'dict': 7274, ...
Counter({'instancemethod': 9716, 'dict': 7275, ...
Counter({'instancemethod': 9718, 'dict': 7276, ...
Counter({'instancemethod': 9720, 'dict': 7277, ... 
```

然后，我尝试通过以下方式识别未收集垃圾的附加字典：

```
def get_latest():
    for e in gc.get_objects():
        if type(e).__name__ == "dict":
            latest = e
    return latest 
```

不幸的是，返回的结果大多相同（dict1 是 dict2），所以它不是列表中的最后一个。

任何有关如何找到泄漏的指针将不胜感激。使用 python 2.7 和最前沿的 pyglet。

此外，这只会影响游戏的客户端，而不影响服务器。所以这可能是 pyglet 中的一个问题 - 即使我想找到它。

编辑：这个问题由我自己回答，我的问题是每帧都使用 pyglet 的 push_handlers 方法，而不是一次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T10:45:40.913

我的问题是每帧都使用 pyglet 的 push_handlers 方法，而不是一次。删除它，内存泄漏就消失了。

# google-apps-script - 列表框上的 GAS 客户端处理程序验证

> ID：11378602
> 
> 赞同：2
> 
> 时间：2012-07-07T21:02:37.963
> 
> 标签：google-apps-script

我正在用 GAS 编写一个简单的 UI Web 表单。我有几个文本框和列表框。我添加了客户端处理程序来验证模糊文本框中的输入，它们都工作正常。但是，当我尝试在列表框上使用客户端处理程序时，它不起作用。例如，列表框中的第一个项目是一个空字符串，我想检查一个项目是否已被选中。无论我使用什么验证选项，它都会触发。我试过验证长度。我想也许脚本可能会获取列表的索引值，所以我尝试了选项和范围。还有，不许走。我猜该脚本正在使用一个空值，这会使任何验证短路。有小费吗？当小部件是一个列表框时，无论条件如何，这个东西都会一直触发。

```
var required_field = app.createClientHandler()
  .validateNotLength(widget, min, max)
  .forTargets(lblInfo)
  .setStyleAttribute('color','red')
  .setText('Please correct errors in red NOW.')
  .forTargets(lbl)
  .setStyleAttribute('color','red')
  .forTargets(widget)
  .setStyleAttribute('background', '#ffe7e7');
widget.addBlurHandler(required_field); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T11:02:38.337

我对这个问题很感兴趣，所以我进行了几次测试，最终找到了一个可能很有趣的解决方法。代码有点长，但我没有找到任何方法让它更短但仍然清晰;-)

此版本正在运行，有一些评论建议如何使其“透明”，以及如何证明处理程序验证在 listBoxes 上不起作用。

告诉我你的想法 ;-）

编辑：我已经在[网上发布了一个版本](https://script.google.com/macros/s/AKfycbwpo1YtexOD873ioYU0xXnClL-asiBM8UBazfAoRRRaM5gDqga2/exec)以进行快速测试。

```
 function showtest() {
   var doc = SpreadsheetApp.getActiveSpreadsheet();
   var app = UiApp.createApplication().setTitle('ListBox Clienthandler test');
   var panel = app.createVerticalPanel();
   var lb = app.createListBox(false).setId('myId').setName('myLbName').setWidth(350);
   var former = app.createTextBox().setName('former value').setId('former').setWidth(350);
   var textbox = app.createTextBox().setName('text').setId('valtext').setWidth(350)//.setVisible(false);// set it visible to test how it works, invisible to use it 'transparently'
   var label = app.createHTML("<BR><BR>Use this textBox as a button, click on it to update its value,<BR>the Client handler doesn't fire when selected color = white<BR>(if you set the upper textBox invisible then it works as if the<BR>listBox had the handler)<BR><BR>")    
   // add items to ListBox
   lb.setVisibleItemCount(7);
   lb.addItem('white');
   lb.addItem('pink');
   lb.addItem('orange');
   lb.addItem('green');
   lb.addItem('yellow');
   lb.addItem('red');
   lb.addItem('cyan');
//  
   panel.add(textbox);
   panel.add(lb);
   panel.add(label);
   panel.add(former);
   var handler = app.createServerClickHandler('click').addCallbackElement(panel);
   lb.addClickHandler(handler);
   app.add(panel);
   doc.show(app);
 }
//
function click(e) {
   var app = UiApp.getActiveApplication();
   var value = e.parameter.myLbName
       if(value==''){value='white'}
   var textboxvalue = e.parameter.text
       if(textboxvalue==''){textboxvalue='none'}
   var text=app.getElementById('valtext')
       text.setText(value)
   var lb=app.getElementById('myId')
   var former=app.getElementById('former')
//   var handlerval = app.createClientHandler().validateNotMatches(lb, 'white') // this line puts handler on listBox and doesn't work
   var handlerval = app.createClientHandler().validateNotMatches(text, 'white')  // this line puts handler on TextBox and works as expected
     .forEventSource().setText("Click here for Former Value = "+textboxvalue+" / present value = "+value)
     .forTargets(lb).setStyleAttribute("background", value)
      former.addClickHandler(handlerval);   
   return app;
 } 
```

**编辑 2：**

这是模拟（**几乎**完全）您需要的功能的另一种可能性：（[在线版本](https://script.google.com/macros/s/AKfycbye87E1QhRlr1Ri57uGg3LMuWIUX3GeogNhuIOXyiWSvHKA-dY2/exec)）

```
 function showtest() {
       var doc = SpreadsheetApp.getActiveSpreadsheet();
       var app = UiApp.createApplication().setTitle('ListBox Clienthandler test');
       var panel = app.createVerticalPanel();
       var lb = app.createListBox(false).setId('lb').setName('lb').setWidth(350);
       var label = app.createHTML("<BR>You forgot to choose a value in the list").setVisible(false).setId('label');
       lb.setVisibleItemCount(7);
       lb.addItem('');
       lb.addItem('pink');
       lb.addItem('orange');
       lb.addItem('green');
       lb.addItem('yellow');
       lb.addItem('red');
       lb.addItem('cyan');
       var othertextbox = app.createTextBox().setText('other question');
       var grid = app.createGrid(4,1)
           grid.setWidget(0, 0, lb)
           grid.setWidget(1, 0, label)
           grid.setWidget(3, 0, othertextbox)
       panel.add(grid)
       var handler = app.createServerBlurHandler('alert').addCallbackElement(panel);
       lb.addBlurHandler(handler);
       app.add(panel);
       doc.show(app);
     }
    //
function alert(e) {
   var app = UiApp.getActiveApplication();
   var lb = app.getElementById('lb')
   var label = app.getElementById('label')
   var value = e.parameter.lb
       if(value==''){
  lb.setStyleAttribute("background", 'red');
         label.setVisible(true)
           }else{
  lb.setStyleAttribute("background", 'white');
         label.setVisible(false)
           }
   return app; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T12:31:43.917

客户端处理程序不适用于 ListBox。但不要忘记，您始终可以选择服务器处理程序，这适用于大多数情况下，您可以延迟 1-2 秒的反应

# java - 使用 Java 反射创建静态抽象类的实例？

> ID：11378603
> 
> 赞同：1
> 
> 时间：2012-07-07T21:02:43.620
> 
> 标签：java, reflection

我有这个：

```
public interface Receiver extends x.y.a
{
    public static abstract class Stub extends x.y.b implements Receiver
    {
        public Stub()
        {
        }
    }
} 
```

并想写这个：

```
private final Receiver receiver = new Receiver.Stub()
{
}; 
```

使用反射。这甚至可能吗？我可以找到 Stub() 构造函数，但它当然无法自行执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:16:46.917

不，那是不可能的，如果你尝试通过反射来实例化抽象类，你会得到异常。不管是什么情况，永远记住你不能实例化抽象类。虽然您可以创建匿名类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:05:53.793

据我所知，您无法创建抽象类的实例。即使有反思。如果那个类不是抽象的，你可以简单地调用

```
Constructor c = Receiver.Stub.class.getConstructor(null);
Receiver r= (Receiver)c.newInstance(null); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:22:22.633

您的代码可以正常工作，无需反思。您正在创建一个匿名子类。AFAIK 无法使用反射创建子类（匿名）。也许这个线程是有用的：

[在Java中是否可以仅给定父类的实例动态创建匿名子类实例？](https://stackoverflow.com/questions/5058748/in-java-is-it-possible-to-dynamically-create-anonymous-subclass-instance-given-o)

或者这个：[是否可以在使用反射时创建一个匿名类？](https://stackoverflow.com/questions/5100035/is-it-possible-to-create-an-anonymous-class-while-using-reflection)

# section508 - Brightcove 508 兼容播放器是否支持 Javascript API？

> ID：11378604
> 
> 赞同：0
> 
> 时间：2012-07-07T21:02:45.873
> 
> 标签：section508, brightcove

首先，Brightcove 论坛毫无用处，因为您必须拥有 Brightcove 帐户才能做出贡献。IA m 只是一个开发人员，没有帐户。

我已经获得了 Brightcove 508 兼容播放器的源代码，并且需要使用 Javascript API 执行一些简单的操作（停止、启动、跳转）。

这里不需要代码，标准播放器可以很好地接受呼叫，508 则不能。这是为什么？

生成播放器时是否必须专门开启 API 支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:16:41.267

是的，播放器中有一个标志（模板，如果我没记错的话）启用 API 访问。我认为关键在于，如果您不拥有播放器，则不应控制其行为方式。

[BC 支持文档](http://support.brightcove.com/en/docs/editing-settings-players-global-tab)

# c - 功能和性能的返回值

> ID：11378606
> 
> 赞同：-2
> 
> 时间：2012-07-07T21:02:49.360
> 
> 标签：c, gcc

考虑这两个`C`具有不同标头但具有相同主体的函数，仅在它们返回结果的方式（通过堆栈或指针）方面有所不同：`T f1(int x)`以及`void f2(int x, T *ret)`where `sizeof(T) >= 16`。`f1`调用调用`f2`或编译`gcc -O2`器将两个调用优化为相似的结果时是否有任何性能损失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:11:26.313

从我所看到的情况来看，会有性能损失。对于 f1，该函数将必须创建一个 T 类型的对象，然后它会返回该对象的副本，因为您没有指定它应该从引用或指针返回（但随后该函数必须分配内存为了它）。

但至于 f2，您发送的是 T 类型的对象，您已经为其分配了内存。这可以节省时间，因为该函数不必创建新对象或为其分配内存。

虽然我不确定使用 gcc 2 级优化是否使用 RVO 来避免将对象复制为返回类型。

# command-line - Oh My Zsh - 禁用“你想检查更新”提示

> ID：11378607
> 
> 赞同：106
> 
> 时间：2012-07-07T21:02:49.900
> 
> 标签：command-line, zsh

每次我在 Mac 上打开终端时，我都会收到提示

> 您想检查更新吗？

我觉得这很烦人。无论如何要阻止它这样做？

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2014-09-16T18:54:00.997

将环境变量设置`DISABLE_UPDATE_PROMPT=true`为始终回复**是**并自动升级。

将环境变量设置`DISABLE_AUTO_UPDATE=true`为始终回复**“否”**且永不升级。

`~/.zshrc`只需在调用之前在您的某处添加其中一个`source $ZSH/oh-my-zsh.sh`。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2012-07-07T21:17:15.460

您必须`DISABLE_AUTO_UPDATE="true"`在您`.zshrc`的行前添加`source $ZSH/oh-my-zsh.sh`。通过这样做，oh-my-zsh 将跳过更新检查脚本。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2021-11-01T19:15:29.727

# 其他一些答案中的弃用

其他答案可能会引用不推荐使用的更新设置的方法。

根据 OhMyZsh wiki，有一个部分在讨论[`Deprecated settings`](https://github.com/ohmyzsh/ohmyzsh/wiki/Settings#deprecated-settings).

> 这些设置仍受支持，但将在 Oh My Zsh 的未来版本中删除。尽可能迁移到`zstyle`设置。

例如，以下两种方法可以达到相同的结果：

#### A. 不推荐修改设置的方法（环境变量在`.zshrc`）

```
DISABLE_AUTO_UPDATE=true 
```

#### B. 修改设置推荐方法（`zstyle`设置）

```
zstyle ':omz:update' mode disabled 
```

我很惊讶没有人提到对 OhMyZsh 更新的新的和微调的控件，它弃用了旧方法。

**这当然不会阻止您`zstyle`从`.zshrc`.**

您可以尝试 OMZ 文档中所述的以下命令：

# OMZ 文档——[获取更新](https://github.com/ohmyzsh/ohmyzsh#getting-updates)

您有几个选项来调整 OMZ 更新。

*   默认情况下，系统会提示您每 2 周检查一次更新。在 Oh My Zsh 加载之前，您可以通过在 ~/.zshrc 文件中添加一行来选择其他更新模式：

*   自动更新无确认提示：

```
zstyle ':omz:update' mode auto 
```

*   如果有可用更新，请每隔几天提供一次提醒：

```
zstyle ':omz:update' mode reminder 
```

*   **要完全禁用自动更新**：

```
zstyle ':omz:update' mode disabled 
```

*   注意：您可以使用以下设置控制 Oh My Zsh 检查更新的频率：

```
# This will check for updates every 7 days
zstyle ':omz:update' frequency 7
# This will check for updates every time you open the terminal (not recommended)
zstyle ':omz:update' frequency 0 
```

## 重要（`zstyle`前提）

*   请注意，上面的命令 ( `zstyle`) 必须在 OhMyZsh shell 中严格执行。
*   换句话说，在安装 ZSH 和 OhMyZsh 之后，也许您决定不将默认 shell 更改为 ZSH。
*   在这种特殊情况下，您必须暂时将 shell 切换到 ZSH 才能使上述命令正常工作。你可以用 来做到这一点`exec /bin/zsh`，这可能也适用于`.zshrc`。

## 理解`zstyle`

*   警告：这是一个潜在的兔子洞:)
*   [在线文档](http://zsh.sourceforge.net/Doc/Release/Zsh-Modules.html#The-zsh_002fzutil-Module)
*   手册页：`man zshmodules`
*   [在这个问题](https://unix.stackexchange.com/questions/214657/what-does-zstyle-do)中查看一些有见地的答案。

# php - 使用 CakePHP 在不同的控制器中使用模型

> ID：11378608
> 
> 赞同：4
> 
> 时间：2012-07-07T21:03:12.497
> 
> 标签：php, cakephp

我的 Cake 应用程序中有一些控制器，即`servers`和`users`. 我想编写一个简单的 API 并有一个名为`ApiController`. 在这个控制器中，我想同时使用`servers`和`users`模型。

我对 Cake 很陌生，但通常不是 MVC。从我目前所掌握的情况来看，Cake 会自动使用控制器`servers`中的模型`ServersController`，我不知道如何显式地使用来自某个控制器的模型。

此外，我希望 API 请求仅提供 JSON 服务，而无需任何 HTML 标记。我有一个默认布局，它定义了我所有网站页面的页眉/页脚，当我从视图中请求 API 函数和 JSON 时，它就会被输出。如何停止输出布局而只提供视图？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-07T22:02:43.203

您需要`$uses`在控制器中声明该属性，请参见[http://book.cakephp.org/2.0/en/controllers.html#controller-attributes](http://book.cakephp.org/2.0/en/controllers.html#controller-attributes)

该`$uses`属性说明控制器可以使用哪些模型：

```
<?php
class ApisController extends AppController{
    public $uses = array(
        'User',
        'Server'
    );
} 
```

此外，您似乎没有遵循 Cake 命名约定，其中控制器名称是复数 ( `Apis`or `Servers`) 而模型名称是单数 ( `Api`or `Server`)。这些名称也应该使用 CamelCase。有关更多信息，请参阅[http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html](http://book.cakephp.org/2.0/en/getting-started/cakephp-conventions.html)

关于 JSON，您可以使用 Ajax 布局来帮助您处理 JSON 请求。有关如何实现此目的的更多信息，请参阅[http://book.cakephp.org/2.0/en/views.html#layouts 。](http://book.cakephp.org/2.0/en/views.html#layouts)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T12:01:52.340

Yottatron 的答案很准确，Nick Savage 的答案也很准确。了解加载模型的不同方式之间的差异很重要，以下评论简要介绍了这一点：[https ://stackoverflow.com/a/4753244/117413](https://stackoverflow.com/a/4753244/117413)

就个人而言，我远离重载全局`$uses`数组，因为我需要在全局级别引用所有模型对象是非常罕见的（根据此处的 Cake 文档，重载它只是不好的做法：[https://book .cakephp.org/1.3/en/The-Manual/Developing-with-CakePHP/Controllers.html#components-helpers-and-uses](https://book.cakephp.org/1.3/en/The-Manual/Developing-with-CakePHP/Controllers.html#components-helpers-and-uses) )

# javascript - 连接到服务器时出错：未定义套接字 io

> ID：11378611
> 
> 赞同：0
> 
> 时间：2012-07-07T21:03:54.253
> 
> 标签：javascript, node.js, socket.io

我知道有几个关于同一个问题的问题，我已经检查过了。

我有非常简单的 node.js 聊天应用程序

我有一个在 8000 端口上运行的服务器，它工作正常

我的客户端页面是 html ，它们在 apache 上运行，我正在使用 socket.io 将它们连接到服务器，它在本地主机上运行良好

但是当我在服务器上上传应用程序时，我不断在萤火虫中收到这个错误

```
io is not defined
var socket = io.connect('http://atenak.com:8000/'); 
```

或者有时它没有显示，但是当我尝试从客户端广播消息时，我收到此错误：

```
socket is undefined
socket.emit('msg', { data: msg , user:'max' }); 
```

唯一的区别是我用 atenak.com 更改了本地主机！

这是我的html代码

```
var socket = io.connect('http://atenak.com:8000/');
    var user = 'jack';
  socket.on('newmsg', function (data) {
       if(data.user == user )
       {
           $('#container').html(data.data);
       }
  });

     function brodcast(){
           var msg = $('#fild').val();
          socket.emit('msg', { data: msg , user:'max' });
      }

</script>
</head>
<body>
<div id="container">  </div>
   <input id="fild"  type="text">  <input name="" type="button" onClick="brodcast();">

</body> 
```

我已经包含了 sockt.io.js

```
src="http://atenak.com:8000/socket.io/socket.io.js" 
```

并且服务器运行正常，这意味着 socket.io 已安装在服务器上

这是实时页面

```
http://atenak.com/client.html 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:08:57.763

我越来越：

```
> Uncaught ReferenceError: io is not defined client.html:7
x GET http://atenak.com:8000/socket.io/socket.io.js 
```

表示您的页面无法加载`http://atenak.com:8000/socket.io/socket.io.js`；实际上，如果您尝试在浏览器中加载该 URL，则会出现连接错误。确保您的 Node.js 服务器（运行 Socket.IO）是可访问的（例如端口未被防火墙阻止等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T04:11:20.523

根据以下链接，您的主机上似乎未打开端口 8000

[atenak.com 的反向 ip 检查](http://www.domaintools.com/research/reverse-ip/?hostname=46.4.110.26)和[开放端口检查](http://www.yougetsignal.com/tools/open-ports/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T22:09:23.917

Socket.io 需要一个 javascript 文件，而该文件无法正确加载。

这是网址：[http ://atenak.com:8000/socket.io/socket.io.js](http://atenak.com:8000/socket.io/socket.io.js)

在这个文件中定义了`îo`对象。

# ruby-on-rails - 使用 rspec 设计和 OmniAuth twitter 集成测试

> ID：11378613
> 
> 赞同：4
> 
> 时间：2012-07-07T21:03:58.103
> 
> 标签：ruby-on-rails, rspec, devise, omniauth

我正在尝试编写一个集成测试，用于使用 OmniAuth 和 Devise 登录 twitter。我无法设置请求变量。它适用于控制器测试，但不适用于集成测试，这让我认为我没有正确配置规范助手。我环顾四周，但似乎找不到可行的解决方案。这是我到目前为止所拥有的：

```
# spec/integrations/session_spec.rb
require 'spec_helper'
describe "signing in" do
  before do
    request.env["omniauth.auth"] = OmniAuth.config.mock_auth[:twitter]
    visit new_user_session_path
    click_link "Sign in with twitter"
  end

  it "should sign in the user with the authentication" do
    (1+1).should == 3
  end
end 
```

该规范在进行测试之前会出现错误，我不太确定`request`变量需要在哪里初始化。错误是：

```
Failure/Error: request.env["omniauth.auth"] = OmniAuth.config.mock_auth[:twitter]
  NoMethodError:
    undefined method `env' for nil:NilClass 
```

现在我`request`在我的控制器规范和测试通过中使用该变量，但它没有为集成测试初始化​​。

```
 # spec/spec_helper.rb
 Dir[Rails.root.join("spec/support/*.rb")].each {|f| require f}
 ...

 # spec/support/devise.rb
 RSpec.configure do |config|
   config.include Devise::TestHelpers, :type => :controller
 end 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T04:56:02.433

[Capybara README](https://github.com/jnicklas/capybara/blob/master/README.md)说“无法从测试中访问会话和请求”，所以我放弃了在测试中配置并决定在`application_controller.rb`.

```
before_filter :set_request_env
def set_request_env
  if ENV["RAILS_ENV"] == 'test'
    request.env["omniauth.auth"] = OmniAuth.config.mock_auth[:twitter] 
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-09T18:50:21.037

Devise 测试助手仅用于控制器规范而不是集成规范。在 capybara 中没有请求对象，因此设置它不起作用。

您应该做的是将设计测试助手的范围加载到您的控制器规范，如下所示：

```
class ActionController::TestCase
  include Devise::TestHelpers
end 
```

并按照本指南中的建议对水豚规格使用看守助手：[https ://github.com/plataformatec/devise/wiki/How-To:-Test-with-Capybara](https://github.com/plataformatec/devise/wiki/How-To:-Test-with-Capybara)

如需更详细的讨论，请查看此 github 问题页面：[https ://github.com/nbudin/devise_cas_authenticable/issues/36](https://github.com/nbudin/devise_cas_authenticatable/issues/36)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-12T06:29:14.970

在使用 rspec + devise + omniauth + omniauth-google-apps 进行测试期间，这对我有用。毫无疑问，twitter 解决方案将非常相似：

```
# use this method in request specs to sign in as the given user.
def login(user)
  OmniAuth.config.test_mode = true
  hash = OmniAuth::AuthHash.new
  hash[:info] = {email: user.email, name: user.name}
  OmniAuth.config.mock_auth[:google_apps] = hash

  visit new_user_session_path
  click_link "Sign in with Google Apps"
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-31T13:58:20.710

将请求规范与较新版本的 RSpec 一起使用时，不允许访问请求对象：

```
before do
  Rails.application.env_config["devise.mapping"] = Devise.mappings[:user] # If using Devise
  Rails.application.env_config["omniauth.auth"] = OmniAuth.config.mock_auth[:twitter]
end 
```

# objective-c - 在 iOS 应用程序中实现 SoundCloud API - 出现错误

> ID：11378617
> 
> 赞同：3
> 
> 时间：2012-07-07T21:05:19.967
> 
> 标签：objective-c, ios, soundcloud

我已按照以下链接的说明将声音云 API 包含到我的应用程序中：

[https://github.com/soundcloud/CocoaSoundCloudAPI](https://github.com/soundcloud/CocoaSoundCloudAPI)

但是当我到达我需要的部分时 - #import "SCUI.h"

我收到一个错误 SCUI.h 文件未找到。

我已经尝试了我能想到的一切来解决这个问题。

我正在使用 Xcode 4.3.3 和 iOS SDK 5.1

如果有人可以帮助我，我将不胜感激。

谢谢

本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T18:23:24.953

我正在回答您在评论中提出的问题。我没有使用过这个特定的库，但是从查看源代码来看，您似乎正在尝试使用该库的作者标记为私有的函数。如果你*真的*需要你的代码能够使用`[SCSoundCloud shared]`，你可以包含标题`SCSoundCloud+Private.h`，这应该可以解决你的问题......但是你应该能够通过调用来访问你需要的所有功能`[SCRequest perform...withAccount:[SCSoundCloud account]...]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T22:18:37.497

将递归添加`$PROJECT_DIR`到`Header Search Path`您的目标。

# javascript - jQuery：淡化链接下方的图像

> ID：11378620
> 
> 赞同：0
> 
> 时间：2012-07-07T21:05:21.937
> 
> 标签：javascript, jquery, html, fade

我有一个链接的背景图片，我想淡化和旋转。我使用了两个 div，一个带有图像，一个是空白的。在这些之上是一个链接的图像。

这是一个例子：http: [//jsfiddle.net/YURg8/48/](http://jsfiddle.net/YURg8/48/)

该链接在 Chrome 或 FF 中淡入淡出时无效，但在 IE 中有效。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:25:36.243

制作一个元素来包装这些`div`-s 并将它们绝对定位 - [http://jsfiddle.net/YURg8/49/](http://jsfiddle.net/YURg8/49/)

```
wrapper {
    position: relative;
    overflow: hidden;
}

#bgblack {
    background:#555;
    position: absolute;
    left: 0;
    width:200px;
    height:50px;
}

#bgwhite {
    background:#fff;
    position: absolute;
    left: 0;
    width:200px;
    height:50px;
}

#link {
    display:block;
    position: absolute;
    left: 0;
    color: yellowgreen;
    width: 200px;
    line-height: 50px;
    text-align: center;
} 
```

# objective-c - EXC_BAD_ACCESS 代码 1

> ID：11378623
> 
> 赞同：0
> 
> 时间：2012-07-07T21:05:40.053
> 
> 标签：objective-c, exception, cocos2d-iphone

我正在制作一个应用程序，当你触摸一个物体时，它会移动。在它移动后，它会被释放。超过 30 次移动后，抛出了一个名为 EXC_BAD_ACESS 且 CODE = 1 的异常。为什么会抛出异常？

```
 if (myselunit!=nil) {
                touch = [touches anyObject];
                location = [touch locationInView:[touch view]];
                location = [[CCDirector sharedDirector] convertToGL:location];  // Locks on to touch's coordinates
                realx = location.x;
                realy = location.y;
                realDest = ccp(location.x, location.y);
                int offRealX = realx - myselunit.position.x;  // exception occurs here
                int offRealY = realy - myselunit.position.y;
                float length = sqrtf((offRealX*offRealX)+(offRealY*offRealY));
                float velocity = 50*myselunit.speed; // 480pixels/1sec
                float realMoveDuration = length/velocity;
                [myselunit runAction:[CCSequence actions:[CCMoveTo actionWithDuration:realMoveDuration position:realDest],[CCCallFuncN actionWithTarget:self selector:@selector(spriteMoveFinished:)],nil]];

               //             [myselunit runAction:[CCSequence actions:[CCCallFuncN actionWithTarget:self selector:@selector(staminaUse:)],nil]];

                NSLog(@"%f",location.x);
                myselunit = nil;

            } 
```

这是 myselunt 的回流错误列表：

回流：

*   线程 1
    0x1fa509f: movl (%edi), %esi
    if (myselunit!=nil && myselunit.unitType != 0) {
    0x19f9e99: addl $28, %esp
    [handler.delegate performSelector:helper.touchesSel withObject:mutableTouches withObject:event]; [CCTouchDispatcher touches:withEvent:withTouchType:] 1 [self touches:touches withEvent:event withTouchType:kCCTouchBegan]; 4 -[CCTouchDispatcher touchesBegan:withEvent:] 1 [touchDelegate_touchesBegan:touches withEvent:event]; 5 - [EAGLView touchesBegan:withEvent:] 1 0x8562cf: movl 6769896(%esi), %eax 6 - [UIWindow_sendTouchesForEvent:] 1 0x82e626: xorl %eax, %eax 18 UIApplicationMain 1 int retVal = UIApplicationMain(argc, argv, 无，@“AppDelegate”）；19 main // (内存错误) 1 0x2815: movl %eax, (%esp) 20 开始 0

*   线程 3 0x9062690a：jae 0x9062691a；kevent + 26 0 kevent 1 libdispatch.dylib`_dispatch_mgr_thread: 2_dispatch_mgr_thread 1

    *   线程 6 0x9062583e：jae 0x9062584e；__psynch_cvwait + 26 0_psynch_cvwait 1 0x97a76ed9: movl %ebx, %ecx 4_pthread_start 1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:45:26.313

**如果发生崩溃，请发布回溯。**

**如果您知道崩溃所在的行并且该行包含变量，请显示变量是如何初始化的。**

鉴于您稍后将`myselunit`其视为一个对象，这很可能是因为`myselunit`已不正确地初始化、在此代码块之前释放或以其他方式管理不善。

* * *

作为对问题的编辑，您的评论会更好；更多的格式化机会。

*   `myselunit`假设非 ARC 代码，看起来您可能错误地管理的内存。

*   请注意，您的“解除分配”代码似乎并未实际设置`myselunit`为`nil`，因此导致指针悬空。

# ruby-on-rails - Rails 3 处理 */*

> ID：11378626
> 
> 赞同：1
> 
> 时间：2012-07-07T21:06:01.497
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我注意到在 中**`Rails 3.2.2`**，所有动作都以**`*/*`**格式处理。所以问题是：什么意思**`*/*`**？以及为什么默认调用它（每次）？

因为一个动作有两个处理：

```
Started GET "/" for 127.0.0.1 at 2012-07-07 22:50:22 +0200
Processing by MainController#index as HTML

Started GET "/" for 127.0.0.1 at 2012-07-07 22:50:22 +0200
Processing by MainController#index as */* 
```

我试图设置：

```
 respond_to :html

  def index
    @posts = Post.all
    respond_with(@posts)
  end 
```

但同样的问题仍然存在。

* * *

刚刚创建了基于**`Rails 3.2.6`**. 用`Thin 1.4.1`和测试`Webrick`。同样的问题：

```
=> Booting Thin
=> Rails 3.2.6 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
>> Thin web server (v1.4.1 codename Chromeo)
>> Maximum connections set to 1024
>> Listening on 0.0.0.0:3000, CTRL+C to stop

Started GET "/mains" for 127.0.0.1 at 2012-07-09 10:53:55 +0200
Connecting to database specified by database.yml
Processing by MainsController#index as HTML
  Main Load (0.1ms)  SELECT `mains`.* FROM `mains` 
  Rendered mains/index.html.erb within layouts/application (2.7ms)
Completed 200 OK in 97ms (Views: 51.6ms | ActiveRecord: 1.3ms)

Started GET "/mains" for 127.0.0.1 at 2012-07-09 10:53:55 +0200
Processing by MainsController#index as */*
  Main Load (0.1ms)  SELECT `mains`.* FROM `mains` 
  Rendered mains/index.html.erb within layouts/application (0.5ms)
Completed 200 OK in 10ms (Views: 8.6ms | ActiveRecord: 0.1ms) 
```

# javascript - jQuery两列（一维）数组？

> ID：11378628
> 
> 赞同：0
> 
> 时间：2012-07-07T21:06:06.347
> 
> 标签：javascript, jquery, arrays

我有一个简单的一维数组，但我想使用 jQuery 将长列表分成两列。我怎样才能做到这一点？

```
var articles = ['article10','article9','article8','article7','article6','article5','article4','article3', 'article2', 'article1'];
for ( var articCounter = articles.length; articCounter > 0; articCounter--) {
    document.write('<a href="../articles/' + articles[articCounter-1] + '.pdf" > ' + articles[articCounter-1] + '</a></br>');  
} // end for 
```

我不想为两个不同的浮点 div 创建两个不同的数组......我已经用谷歌搜索了很多次，但许多其他方法处理多维数组。

非常感谢您提前提供的帮助。

编辑：现在它只是一个长长的列表，如下所示：

第 1 条第 2 条 第 3 条
....

但我想实现这一点：
![在此处输入图像描述](../Images/0e8631e006deeda3264556e38de77b18.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:25:29.583

这会将您的数组拆分为 2 个数组：

```
var articles = ["article1", "article2", "article3", "article4", "article5", "article6", "article7", "article8", "article9", "article10"];   
var separatorIndex = articles.length & 0x1 ? (articles.length+1)/2 : articles.length/2;

var firstChunk = articles.slice(0,separatorIndex); 
//["article1", "article2", "article3", "article4", "article5"] 
var secondChunk = articles.slice(separatorIndex,articles.length); 
//["article6", "article7", "article8", "article9", "article10"] 
```

然后你可以在你想要的地方和/或如何使用它们。

*解释*

第 2 行找到一个*锚索引*（别名 -> 分割的中间索引），数组应该被分成 2 个块。数组可以有`odd`和`even`长度，必须区分这两种情况。由于不可能将奇数长度的数组分成 2 个*相等*的部分，因此必须以这样的方式进行划分，即第一个块*将比第二个块**多*或少1 个元素。这里，我实现了第一种情况，即第一个块将多于 1 个元素，而不是第 2 个。以下是不同情况的示例：

 *```
total length | 1st (length) | 2st (length) | separatorIndex 
    10            0-4 (5)        5-9 (5)          5        
    11            0-5 (6)       6-10 (5)          6
    12            0-5 (6)       0-11 (6)          6 
```

在表中，*`number`-`number`*语法相应地显示数组中的开始和结束索引。除法由[.slice()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice)函数完成。*

# image - 谷歌浏览器重新托管图像扩展

> ID：11378630
> 
> 赞同：3
> 
> 时间：2012-07-07T21:06:12.380
> 
> 标签：image, google-chrome-extension, imgur

我想要一个谷歌浏览器扩展来重新托管我点击的任何图像。

例如，我有一个带有使用`<img>`标签的图像的 html 文档。我想要一个扩展，它将将该图像重新托管到另一个图像主机。[我在imgur 扩展名](https://chrome.google.com/webstore/detail/ehoopddfhgaehhmphfcooacjdpmbjlao)中看到了类似的东西。我不知道我应该从哪里开始，或者我应该怎么做才能完成这项工作。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T09:40:08.337

首先，您必须获得一个[API](http://api.imgur.com/)密钥。如果每小时最多上传 50 次就足够了，并且您不想注册帐户，请[获取匿名 API 密钥](https://imgur.com/register/api_anon)。

我建议不要绑定可能会干扰页面的左键单击事件处理程序，而是使用[`chrome.contextMenus`](http://code.google.com/chrome/extensions/contextMenus.html)API 添加一个内容菜单条目。

[清单文件](http://code.google.com/chrome/extensions/manifest.html)，`manifest.json`：

```
{
  "name": "Rehost img at imgurl",
  "version": "1.0",
  "manifest_version": 2,
  "background": {"scripts":["background.js"]},
  "permissions": [
    "contextMenus",
    "http://*/*", // This permission is needed to fetch URLs
    "https://*/*"
  ]
} 
```

将以下代码放入您的[后台脚本](http://code.google.com/chrome/extensions/background_pages.html)中（使用[`chrome.contextMenus.create`](http://code.google.com/chrome/extensions/contextMenus.html#method-create)）：

```
// background.js
chrome.contextMenus.create({
    title: "Rehost image",
    contexts: ["image"],
    onclick: function(info) {
        // Get the image from cache:
        var x = new XMLHttpRequest();
        x.onload = function() {
            // Create a form
            var fd = new FormData();
            fd.append("image", x.response); // x.response = blob
            fd.append("key", "API KEY HERE");

            // Now, upload the image
            var y = new XMLHttpRequest();
            y.onload = function() {
                var url = JSON.parse(xhr.responseText).upload.links.imgur_page;
                // Now, do something with the new url.
            };
            y.open('POST', 'http://api.imgur.com/2/upload.json');
            y.send(fd);
        };
        x.responseType = 'blob';    // Chrome 19+
        x.open('GET', info.srcUrl); // <-- info.srcUrl = location of image
        x.send();
    }
}); 
```

您可以向用户显示 URL（最简单的方法是`prompt("Here's the URL:",url);`，或使用`localStorage`将先前的 URL 映射到新主机和/或使用[`chrome.webRequest`](http://code.google.com/chrome/extensions/webRequest.html)API 将图像请求重定向到新主机。

* * *

使用不同的网络服务/图像主机上传图片。[http://picstore.eu/](http://picstore.eu/)不提供 API，因此我们以编程方式提交表单。

```
// background.js
chrome.contextMenus.create({
    title: "Rehost image",
    contexts: ["image"],
    onclick: function(info) {
        // Get the image from cache:
        var x = new XMLHttpRequest();
        x.onload = function() {
            var file_name = info.srcUrl.split(/[?#]/)[0].split('/').pop();
            var fd = new FormData();
            fd.append("imgUrl", "");
            fd.append("fileName[]", file_name);
            fd.append("Search files", "Browse");
            fd.append("file[]", x.response, file_name);
            fd.append("alt[]", file_name.replace(/[-_]/g, " ").replace(/\.[^.]*$/, ""));
            //fd.append("private[0]", "1"); // "Private images.."
            //fd.append("shorturl[0]", "1"); // "Create short URLs using b54"
            fd.append("new_height[]", "");
            fd.append("new_width[]", "");
            fd.append("submit", "Upload");
            var y = new XMLHttpRequest();
            y.responseType = 'document'; // Chrome 18+ (but blob is 19+)
            y.onload = function() {
                var url = y.response.getElementById('codedirect').value;
                prompt("URL:", url);
                // Now, do something with the new url.
            };
            y.open('POST', 'http://picstore.eu/upload.php');
            y.send(fd);
        };           
        x.responseType = 'blob'; // Chrome 19+
        x.open('GET', info.srcUrl); // <-- info.srcUrl = location of image
        x.send();
    }
}); 
```

# python - Tornado Facebook 获取请求。如何移动到下一页

> ID：11378641
> 
> 赞同：1
> 
> 时间：2012-07-07T21:08:00.807
> 
> 标签：python, facebook, facebook-graph-api, tornado

我正在使用 Tornado 从 FB 的 API 获取用户的朋友。响应包含单页结果，我想移至下一页。你是怎样做的？您是否再次使用 facebook_request() 以及从下一页 url 解析的相对路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:34:47.377

我以前没有一起使用过 tornado 和 facebook API，但是 Facebook 的响应应该像 JSON 对象一样格式化，并带有一个 'paging' 属性，该属性具有 'next' 和/或 'previous' 属性，其中包含其他页面的 url（如果它们存在）。所以你应该能够只做一个 http 请求来获取下一页，这也将是一个 JSON 响应。

在您的回调函数中，您应该能够解析好友列表并将好友添加到您的列表中，然后检查是否有下一个链接；如果是这样，则向该 url 发送一个异步 http 请求，回调与原始请求相同，否则您已经拥有了所有朋友，并且可以对他们做任何您想做的事情。

编辑：好的，我没有尝试过这个，所以它可能有错误，但我认为它会是这样的：

```
@tornado.web.asynchronous
def get(self):
    self.friends = []
    self.facebook_request("/me/friends", access_token=user["access_token"], callback=self.async_callback(self._save_user_profile))

@tornado.web.asynchronous
def _save_user_profile(self, stream):
    self.friends += stream['data']
    if stream['paging'].get('next', None) != None:
        next_url = stream['paging']['next']
        #THIS WOULD BE WHERE YOU GET THE NEXT REQUEST

    else:
        #THIS WOULD BE WHERE YOU DO WHATEVER YOU WANT WITH THE FRIENDS LIST 
```

在我评论下一个请求的地方，您可能应该首先解析 next_url 以获取它的所有参数（基本上用'&'分割，然后用'='分割它们以获得参数的名称和值）然后将它们传递给另一个facebook_request 如上所述。那有意义吗？

# vim - 文件后加载 Vim 插件

> ID：11378642
> 
> 赞同：3
> 
> 时间：2012-07-07T21:08:03.033
> 
> 标签：vim

我正在为 Vim 实现[纯文本/源代码文件头](http://www.synchro.net/draft-swindell-ptsc-hdr-01.txt)，我需要我的解析器在文件之后运行，因为它需要缓冲区的前 60 行。我成功地制作了一个*手动*解析器，但它需要我手动`call PtScParse()`在每个缓冲区上运行。有没有办法让`PtScParse()`每个缓冲区自动运行？

我的解析器[在这个 DARCS repo 上](http://darcsden.com/karl/vim-ptsc-header)。寻找`ptsc-header.vim`文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T21:38:36.840

阅读文档，`:help initialization`我`:help :autocmd`找到了我的解决方案。我所要做的就是在脚本末尾添加以下行：

```
autocmd VimEnter * call PtScHeaderParse() 
```

它调用`PtScHeaderParse()` event 上的所有文件`VimEnter`。现在每次我打开文件时，该函数都会运行并正确显示我的代码:)

# c# - 加载表信息

> ID：11378643
> 
> 赞同：-4
> 
> 时间：2012-07-07T21:08:22.243
> 
> 标签：c#, asp.net, sql

这很简单，但我找不到任何例子来说明它是如何在任何地方完成的。我创建了一个新的 ASP 网站并具有以下代码：

```
 <form id="form1" runat="server">
    <div class="clear_10">&nbsp;</div>
    <div id="load_wrapper">
    &nbsp;
    </div>
    <div id="name_selection_wrapper">
        <p><span>Please enter one of the choices below</span></p>
        <div class="clear_10">&nbsp;</div>
        <div class="user_input">
            <input class="input" type="text" />
            <input type="submit" value="Submit" />
        </div>
        <ul class="name_wrapper">
            <li><span class="dash">-</span>Sue</li>
            <li><span class="dash">-</span>Joe</li>
        </ul>
    </div>
    <div class="clear_10">&nbsp;</div>
</form> 
```

我创建了一个名为 People 的新数据库，其中包含两个表，一个用于 Sue，另一个用于 Joe。简单地说，我究竟如何传递一个查询来检索和显示来自我的 div load_wrapper 中任一表的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:46:15.050

这是一个简单的示例，如何从数据库中检索数据并将其显示在表中（ASP.NET 方式，您可以采用这种方式，但需要更多工作）。如果您使用 DataSource 适配器和 asp.net 控件来显示您的数据，您将节省大量时间，因为您通常可以通过编写任何代码来显示您的数据。我没有编写任何 HTML 或 C# 后端代码，都是拖放和鼠标点击......

**数据库**

![在此处输入图像描述](../Images/697b624734435c4a7fced63b30a6925f.png)

**HTML**

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataKeyNames="Id" DataSourceID="SqlDataSource1">
            <Columns>
                <asp:BoundField DataField="Id" HeaderText="Id" InsertVisible="False" ReadOnly="True" SortExpression="Id" />
                <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
                <asp:BoundField DataField="Age" HeaderText="Age" SortExpression="Age" />
            </Columns>
        </asp:GridView>
        <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:ConnectionString %>" SelectCommand="SELECT * FROM [People]"></asp:SqlDataSource>
    </div>
    </form>
</body>
</html> 
```

**输出**

![在此处输入图像描述](../Images/843cd0e7889a64ef24328041fffdac88.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:19:57.280

您需要使用后端 C# 代码检索数据。

然后，您必须将数据传递到页面。

`runat='server'`或者，通过使 div 具有属性并为其提供 ID ，将您从数据生成的 HTML 插入到需要的页面中。div 的 ID 可以在文件的代码中使用，您可以插入一些内部 HTML。

如果您想在不进行完整回发的情况下获取信息，则必须有一个处理程序和从页面对处理程序的 AJAX 调用。JQuery 有一个很好的 AJAX 方法，在 .NET 4 中创建 API 是创建处理程序的最简单方法。

附带说明一下，如果 Joe 和 Sue 具有相同的数据，您可能会将它们放在一个表中，然后添加另一列来指示数据是与 Joe 还是 Sue 相关。

# python - 防止安全漏洞

> ID：11378645
> 
> 赞同：0
> 
> 时间：2012-07-07T21:08:29.023
> 
> 标签：python, html, pyramid, templating

我正在创建一个您“发布”的网站，表单内容保存在 MySql 数据库中，并在加载页面时被检索，类似于 facebook。我构建了所有帖子并将原始 html 插入到模板中。问题是，当我在测试时，我注意到我可以将 javascript 或其他 HTML 写入表单并提交，并且在重新加载时，html 或 JS 将被视为源代码，而不是帖子。我认为一些简单的编码可以解决问题，但使用`<form accept-charset="utf-8">`不起作用。有没有一种有效的方法来防止这种类型的安全漏洞？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T23:00:07.853

好吧，为了图片的完整性，我想提一下，您可以在 Pyramid 中清理用户输入的两个地方 - 在将数据保存到数据库之前，以及在输出数据之前模板。可以说，将 HTML/JavaScript 存储在数据库中并没有什么问题，它不会对您不利——只要您确保模板中呈现的所有内容都正确转义即可。

事实上，Chameleon 和 Mako 模板引擎都默认开启了 HTML 转义，所以如果你只是“像往常一样”使用它们，你永远不会让用户输入的 HTML 被注入到你的页面中——相反，它会被渲染为文本。没有这个，清理用户输入将是一项艰巨的任务，因为您需要检查用户输入数据的每个表单中的每个字段（即不仅“方便”的文本区域小部件，还有其他所有内容 - 用户名、用户电子邮件等.)。

因此，您必须做一些不寻常的事情（或使用其他模板库）才能使 Pyramid 以这种方式运行。如果您提供有关您正在使用的模板库的更多详细信息和代码示例，我们将能够找到以适当方式修复它的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T21:16:41.263

您所描述的攻击类型称为“Javascript 注入攻击”或“跨站点脚本 (XSS) 攻击”。你可能有更多的运气来寻找它。 [使用 Python 清理用户输入](https://stackoverflow.com/questions/16861/sanitising-user-input-using-python)是一个类似的问题，其中包括一些非常全面的答案，尽管最好的答案[可能在这里](https://stackoverflow.com/a/93857/1508243)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:12:28.350

您可以将`<script>`,`<iframe>`标记替换为其他内容，也可以对字符串进行 html 编码，使其在页面上显示为文本，但不会由浏览器本身呈现。

`<`用 < 和 > 对所有's 和's 进行字符串替换`>`应该足以防止您看到的 XSS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T21:15:35.073

我找到了这个，它谈到了 python 中的 XSS 预防。

[用于 XSS 过滤的 Python 库？](https://stackoverflow.com/questions/901369/python-library-for-xss-filtering)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T21:21:11.393

它有点小，但您可以编写一段代码来识别 html/javascript 代码的某些关键方面并采取相应的行动。例如，识别块，要么不允许传递该查询，要么对其进行编辑，使其不再是有效的 html....

# c++ - 如何使 C++ 模板适用于具有 ARC 的 Objective C 类型？

> ID：11378647
> 
> 赞同：4
> 
> 时间：2012-07-07T21:09:06.017
> 
> 标签：c++, objective-c, automatic-ref-counting, clang

举一个简单的例子。`main.mm`如果我在没有 ARC的情况下编译以下文件，它工作正常。

```
#import <Foundation/Foundation.h>

template <typename T>
int testing(const T & whoCares) {
    return 0;
}

int main(int argc, const char * argv[])
{
    return testing(@"hello");
} 
```

如果我用 ARC 编译它，会出现以下错误：

```
/Users/sam/Projects/TemplateTest/TemplateTest/main.mm:10:12: error: no matching function for call to 'testing'
return testing(@"hello");
       ^~~~~~~
/Users/sam/Projects/TemplateTest/TemplateTest/main.mm:4:5: note: candidate template ignored: substitution failure [with T = NSString *]
int testing(const T & whoCares) {
    ^
1 error generated. 
```

为什么？更重要的是，它可以解决吗？对于替换失败的原因，没有任何进一步的解释。如果我显式传递类型，如下所示：

```
return testing<NSString *>(@"hello"); 
```

有用。话虽如此，我不想也不应该在我的代码中这样做。

同样有趣的是，这只对 Objective C 类型失败。无论启用 ARC，以下替换都可以正常工作：

```
return testing("hello");
return testing(123); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:23:31.757

不幸的是，看起来这可能是一个带有 clang 的编译器错误。

请参阅： http: [//lists.apple.com/archives/objc-language/2012/Feb/msg00078.html](http://lists.apple.com/archives/objc-language/2012/Feb/msg00078.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:27:03.550

除非我错过了 Objective-C++ 和 C++ 之间的根本区别，否则您**总是**传递模板的类型。编译器不会尝试在这方面变得聪明。您必须声明类型。在 GCC G++ 中，它失败并显示以下消息：

```
hello.cpp: In function ‘int main()’:
hello.cpp:7: error: ‘t’ was not declared in this scope 
```

模板不应该像那样聪明。您必须记住，C++ 是静态类型的，并且类型推断非常有限。在 Objective-C 中，您可以将任何内容传递给 an`id`并忘记它。长话短说，即使它确实可以编译，也不应该，也不应该依赖 C++ 和 Objective-C 来很好地混合。Objective-C++ 可能是一个强大的组合，但请记住，它们很少能完美地协同工作。

# c++ - 读取原语时，字符串流会引发异常吗？

> ID：11378649
> 
> 赞同：10
> 
> 时间：2012-07-07T21:09:19.340
> 
> 标签：c++, stringstream

查看一些旧代码，我们有很多类似以下的内容：

```
// This is dumb
string do_something(int in)
{
    stringstream out;
    try
    {
        out << std::fixed << in;
    }
    catch(std::exception &e)
    {
        out << e.what();
    }

    return out.str();
}

// Can't we just do this? Can this ever fail?
string do_something_better(int in)
{
    stringstream out;
    out << std::fixed << in;
    return out.str();
} 
```

当一个字符串流读取一个原语时，它会抛出异常吗？读取字符串时怎么办？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T17:36:27.610

总结几个答案

默认情况下，流不会抛出异常。如果启用，它们可以。

```
stringstream out;
out.exceptions(std::ios::failbit);   // throw exception if failbit gets set 
```

根据 [Apache C++ 标准库用户指南](http://stdcxx.apache.org/doc/stdlibug/29-2.html)

> 标志 std::ios_base::badbit 指示底层流缓冲区存在问题。这些问题可能是：
> 
> **内存不足**。没有可用于创建缓冲区的内存，或者由于其他原因（例如从流外部提供），缓冲区的大小为 0，或者流无法为其自己的内部数据分配内存，如 std::ios_base:: iword() 和 std::ios_base::pword()。
> 
> **底层流缓冲区引发异常。**流缓冲区可能会失去其完整性，例如内存不足、代码转换失败或来自外部设备的不可恢复的读取错误。流缓冲区可以通过抛出异常来指示完整性丢失，该异常被流捕获并导致在流的状态中设置坏位。
> 
> 通常，您应该记住，badbit 表示可能无法恢复的错误情况，而 failbit 表示可能允许您重试失败操作的情况。

所以看起来最安全的方法是

```
string do_something(int in)
{
    stringstream out; // This could throw a bad_alloc
    out << std::fixed << in; // This could set bad or fail bits

    if(out.good())
    {
        return out.str();
    }
    else
    {
        return "";
    }
} 
```

这有点过头了，因为根据[处理 bad_alloc](https://stackoverflow.com/questions/2505257/manage-bad-alloc-exception-in-c-construtor)如果创建流失败，需要担心更大的问题，并且程序可能会退出。因此，假设它通过创建流，它是可能的，但极不可能设置坏位。（流被分配内存< sizeof(int)）。

也不太可能设置故障位（不确定读取堆栈的用例，而不是损坏的堆栈）。所以下面的代码就足够了，因为此时从流错误中恢复是不可能的。

```
string do_something(int in)
{
    stringstream out;
    out << std::fixed << in;
    return out.str();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T21:19:01.623

所有流，包括，都可以在读取`istringstreams`时抛出异常（用 控制），例如。[`ios::exceptions`](http://www.cplusplus.com/reference/iostream/ios/exceptions/)当他们用完输入时。另外，它们可能会在内存不足时抛出（例如，在构造当前读取的字符串时）。

但是，您的代码示例执行写入（？）AFAIK 写入并且`int`不应该产生任何异常，除了明显的内存不足错误（您的代码不能很好地处理）。

# knockout.js - 数组的敲除映射问题

> ID：11378650
> 
> 赞同：1
> 
> 时间：2012-07-07T21:09:20.183
> 
> 标签：knockout.js, knockout-mapping-plugin

[在这里](http://jsfiddle.net/Quu4f/25/)提琴

我有一个对象数组，我想直接映射到我的视图模型上的集合中，但我想自定义映射。除非 data.UserReports 集合中只有一项，否则代码不起作用。

如果我将另一个层添加到对象图中，我可以做到这一点 - 例如，而不是将 data.UserReports 映射到 model.UserReports - 如果我在模型上有一个名为 Foo 的属性 - 我可以将数据映射到 foo 然后访问集合通过 model.Foo.UserReports，但这是不可取的和混乱的。

我还认为，如果我遍历 data.UserReports 数组，然后将每个 UserReport 依次推送到模型的集合中，我可以做到这一点——但这又显得笨拙。

那么小提琴有什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:41:20.863

该小提琴中的代码根本不起作用，至少不适合我。但是，以下是您通常如何将映射插件与现有视图模型实例一起使用：

```
function PageModel() { /* ... */ }

$(document).ready(function() {
    var model = new PageModel();

    // Don't replace some observable, but extend the view model automatically,
    // creating an observable for each property in "data".
    ko.mapping.fromJS(data, userReportMapping, model);

    ko.applyBindings(model);
}​);​ 
```

[http://jsfiddle.net/Quu4f/27/](http://jsfiddle.net/Quu4f/27/)

* * *

*更新：*您还需要/应该指定映射选项应该应用于数据对象中的哪个键：

```
var userReportMapping = {
   'UserReports': {
        key: function(data) {
            return ko.utils.unwrapObservable(data.Id);
        },
        create: function(options) {
            return new userReportModel(options.data);
        }
    }
}; 
```

但是，当您在数据集中有两个具有相同 ID 的项目时会出现错误，这有点奇怪。似乎没有为副本执行“创建”回调，但仍然创建了一个正常的可观察对象。

[http://jsfiddle.net/Quu4f/29/](http://jsfiddle.net/Quu4f/29/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:30:03.440

[这](http://jsfiddle.net/Quu4f/26/)是通过遍历数组并将每个项目依次推送到可观察集合来实现的——有更好的方法吗？

# ruby-on-rails - 创建一个对象然后重定向到该对象路径会导致每次刷新页面时不断运行 Object.new

> ID：11378655
> 
> 赞同：0
> 
> 时间：2012-07-07T21:10:16.250
> 
> 标签：ruby-on-rails, object, save

所以我有一个随机项目生成器，这里是 ring.rb 的代码

```
class Ring < ActiveRecord::Base

  belongs_to :user

  after_initialize :randomly_make_ring

  def randomly_make_ring
    #everything is figured during initialization
    #You can call instance.make_ring to do it at any time.

    #chance calculation for description
    random_description = rand(1000)

    case random_description
    when 0..500
      self.description = 'Silver'
    when 501..800
      self.description = 'Gold'
    when 801..1000
      self.description = 'Diamond'
    end

    #Chance Calculation for Quality
    random_quality = rand(1000)

    case random_quality
    when 0..500
      self.quality = 'Sturdy'
    when 501..800
      self.quality = 'Elegant'
    when 801..1000
      self.quality = 'Platinum'
    end

    # Attributes according to the description
    case description
    when 'Silver'
      self.min_guard_roll = 1
      self.max_guard_roll = 2 + rand(4)
      self.min_pet_roll = 0
      self.max_pet_roll = 1
      self.min_trap_roll = 0
      self.max_trap_roll = 2
      self.buy = 20 + rand(15)      
    when 'Gold'
      self.min_guard_roll = 2
      self.max_guard_roll = 3 + rand(7)
      self.min_pet_roll = 1
      self.max_pet_roll = 3
      self.min_trap_roll = 1
      self.max_trap_roll = 3
      self.buy = 30 + rand(25)
    when 'Diamond'
      self.min_guard_roll = 4
      self.max_guard_roll = 5 + rand(10)
      self.min_pet_roll = 2
      self.max_pet_roll = 5
      self.min_trap_roll = 2
      self.max_trap_roll = 6
      self.buy = 80 + rand(48)
    end   

    # Attributes according to the quality
    case quality
    when 'Sturdy'
      self.min_guard_roll = self.min_guard_roll + 1
      self.max_guard_roll = self.max_guard_roll + (1 + rand(2))
      self.buy = self.buy + (10 + rand(6))   
    when 'Elegant'
      self.min_guard_roll = self.min_guard_roll + 2
      self.max_guard_roll = self.max_guard_roll + (2 + rand(3))
      self.buy = self.buy + (25 + rand(14))  
    when 'Platinum'
      self.min_guard_roll = self.min_guard_roll + 4
      self.max_guard_roll = self.max_guard_roll + (4 + rand(8))
      self.buy = self.buy + (45 + rand(25))  
    end

    # Generate display name
    self.display_name = quality + ' ' + description + ' Ring'

    # Generate Sell Value
    self.sell = self.buy * ((10 + rand(20)).to_f / (31 + rand(20)).to_f).to_f

  end

  attr_accessible :user, :active, :display_name, :description, :buy, :sell, :min_guard_roll, :max_guard_roll, :min_trap_roll, :max_trap_roll, :min_pet_roll, :max_pet_roll, :image 
```

结尾

现在这是我设置的控制器和操作：

```
def create

@ring = Ring.new
@ring.user = current_user

@ring.save

@user = current_user
@user.gold = @user.gold - 25 
@user.save

redirect_to ring_path(:id => @ring.id)

end  

def show
    @ring = Ring.find(params[:id])
  end 
```

我遇到的问题是，每当创建一个环时，它都会将我带到显示页面的页面，但环的属性与保存到数据库的属性不同。所以它没有抓住正确的戒指，由于我不明白的原因，每次显示或刷新页面时都会生成一个新的戒指。在我调出@ring 以显示其属性的任何页面上都会发生同样的事情。

我希望这个工作的确切方式是，用户可以寻找一个戒指，然后会弹出一个随机戒指，他们可以选择购买它或查看不同的戒指。如果他们选择购买它，它就在那里，如果他们选择查看不同的，当前的会被销毁。

有人可以帮我理解为什么会发生这种情况以及是否有更好的设置方法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T14:59:23.513

`after_initialize`每次实例化对象时都会运行回调，无论您是`Ring.new`使用`find`. 就目前而言，每当您从数据库中获取对象时，您都会立即用随机生成的属性覆盖其所有属性。

您可以将回调更改为 a `before_create`，这将导致它在首次保存对象时运行，或者根本不使其成为回调，仅在需要时调用它。

# iphone - iPhone：删除所需的缩略图以自定义完整的图像

> ID：11378658
> 
> 赞同：5
> 
> 时间：2012-07-07T21:10:40.213
> 
> 标签：iphone, image, drag-and-drop, cocos2d-iphone

我正在开发一个 iPhone 应用程序，它应该允许用户选择/拖放一些缩略图类型的图像以在一个模块中自定义更大的图像（等距图像渲染）。例如：将给出一个更大的房屋图像，并将为“屋顶”设置不同的小缩略图图像。用户可以选择任何感兴趣的屋顶图像并将其放到更大的房屋图像中。选定的屋顶图像将按比例和右侧部分适合更大的房屋图像，并为用户获得定制的新建房屋图像。我想，我在“拼图”游戏中的“Thomas”应用程序中看到了完全相同的功能，用户可以拖放火车零件图像来自定义完整的火车图像。

我在想，这个拖放到适当的部分，只能使用 Cocos2D 来完成吗？有人可以点亮它并帮助我开始。另外，有样品吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T06:04:11.527

您可以使用 QuartzCore 框架实现拖放功能。

# reporting-services - 如何根据下拉选择更改我的 sql 语句 WHERE 子句

> ID：11378665
> 
> 赞同：1
> 
> 时间：2012-07-07T21:11:48.427
> 
> 标签：reporting-services

我知道这是一个新手问题，但我需要知道如何根据下拉选择动态更改 SQL 语句中的 WHERE 子句。

我在下拉列表中有一个主管列表。我知道如何使用参数单独使用每个参数，但是当他们选择 ALL 选项时如何更改 SQL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:25:04.343

您需要的是一个*多值参数*。设置的基本步骤：

1.  创建一个数据集，用于为可用的主管选择键和标签。
2.  `@SupervisorIDs`使用第一个数据集作为可用值创建参数。
3.  将参数设置为“允许多个值”。
4.  创建检索实际结果的第二个数据集
5.  在第二个数据集中，创建一个像这样的过滤器：`WHERE SuperVisorId IN (@SupervisorIDs)`

在将查询发送到 SQL Server 之前，报告服务将用逗号分隔的列表动态替换 WHERE 子句中的参数，其中包含用户选择的值。

有关该主题的更多（详细）信息，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/aa337292%28v=sql.100%29.aspx)。

# php - Yii，为 CGridView 的每个 tr 元素生成一个 unquie id

> ID：11378666
> 
> 赞同：1
> 
> 时间：2012-07-07T21:12:27.137
> 
> 标签：php, html, activerecord, yii

我有一个 CDbActiveRecord 设置，并且我有一个 CGridView 类设置的实例作为小部件。

基本上我的最终结果是我需要一个表，但每一行都包含与 Active Record 关联的行的主键。

如：

```
<tr id="123"> <td> Column value 1 </td> <td> Col 2 </td> <td> Col 3 </td> </tr> 
```

那是我正在寻找的特定行。

这是我到目前为止生成表格的代码。（设置 json 变量是因为它位于控制器内部，并且小部件以 json 形式返回。）

```
// get the content id for the version list
$contentID_v = Yii::app()->request->getParam("id"); 

// setup the criteria to fetch related items 
$versionCdbCriteria = new CDbCriteria;
$versionCdbCriteria->compare("contentID",$contentID_v); 

// setting up the active data provider for the version 
$vActiveDP = new CActiveDataProvider("FactsheetcontentVersion", array(
    "criteria" => $versionCdbCriteria,
    'pagination' => array('PageSize' => $this->paginationSize),
    'keyAttribute'=>'vID',
));

$json_data .= $this->widget('zii.widgets.grid.CGridView', array(
        'dataProvider' => $vActiveDP,
        'columns' => array(
        'title',
        'created',
        'createdBy'
        ),
    'showTableOnEmpty' => 'false', 
),true); 
```

这就是它为我的活动记录所产生的。

```
 <div class="grid-view" id="yw0">
<div class="summary">Displaying 1-1 of 1 result(s).</div>
<table class="items"><thead>
    <tr><th id="yw0_c0">Factsheettitle</th>
        <th id="yw0_c1"><a href="jq/work/admin/index.php?r=factsheetManager/Editor
        &amp;id=25601&amp;getV=true&amp;_=1341694154760&amp;FactsheetcontentVersion_sort=created">Created</a>
        </th>
        <th id="yw0_c2"><a href="jq/work/admin/index.php?r=factsheetManager/
        Editor&amp;id=25601&amp;getV=true&amp;_=1341694154760&amp;FactsheetcontentVersion_sort=createdBy">Created By</a>
        </th>
    </tr></thead>
<tbody><tr class="odd"><td>Distribution</td><td>0000-00-00 00:00:00</td><td>NULL</td></tr></tbody>
</table>
<div title="jq/work/admin/index.php?r=factsheetManager/Editor&amp;id=12&amp;id=25601&amp;getV=true&amp;_=1341694154760" style="display:none" class="keys"><span>8</span></div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T03:42:04.163

只是自己学习 Yii，但这似乎很明显？像这样扩展小部件。

```
 Yii::import('zii.widgets.grid.CGridView');

    class MyGridView extends CGridView {
    //This does depend on your data structure
    $data=$this->dataProvider->data[$row];
    $id = $data['id']; //(This may be an object I have not checked is so: $data->id)

        public function renderTableRow($row)
        {
            if($this->rowCssClassExpression!==null)
            {
echo '<tr id="'.$id.'" class="'.$this->evaluateExpression($this->rowCssClassExpression,array('row'=>$row,'data'=>$data)).'">';
            }
            else if(is_array($this->rowCssClass) && ($n=count($this->rowCssClass))>0)
                echo '<tr id="'.$id.'"  class="'.$this->rowCssClass[$row%$n].'">';
            else
                echo '<tr id="'.$id.'" >';
            foreach($this->columns as $column)
                $column->renderDataCell($row);
            echo "</tr>\n";
        }

    } 
```

现在使用这个：

```
$json_data .= $this->widget('zii.widgets.grid.MyGridView', array(
        'dataProvider' => $vActiveDP,
        'columns' => array(
        'title',
        'created',
        'createdBy'
        ),
    'showTableOnEmpty' => 'false', 
),true) 
```

我还不熟悉 YII，但是您可能必须将其注册为扩展并将其添加到您的扩展目录中......或者它可能更多的是一个组件，我不清楚您将代码放置在哪里覆盖现有的小部件，一旦我知道我将编辑这个答案。

# c# - LINQ to SQL - 提交后数据库关系不会更新

> ID：11378669
> 
> 赞同：0
> 
> 时间：2012-07-07T21:12:34.463
> 
> 标签：c#, asp.net, sql-server, linq-to-sql

我有一个包含表格`Users`和`Uploads`. 重要的列是：
`Users -> UserID`
`Uploads -> UploadID, UserID`
关系中的主键是`Users -> UserID`，外键是`Uploads -> UserID`。
在`LINQ to SQL`中，我做了以下操作：

```
Retrieve files
var upload = new Upload();
upload.UserID = user.UserID;
upload.UploadID = XXX;
db.Uploads.InsertOnSubmit(upload)
db.SubmitChanges(); 
```

如果我这样做并重新运行应用程序（`db`当然，对象是重新构建的） - 如果执行以下操作：

```
foreach(var upload in user.Uploads) 
```

我使用该用户的 ID 获取所有上传。（就像在前面的例子中添加的那样）
问题是，我的应用程序在添加上传和提交更改后，不会更新`user.Uploads`集合。即 - 我没有收到新添加的上传。

`user`对象存储在对象中`Session`。起初，我虽然`LINQ to SQL Framework`不会更新对象的引用，因此我应该简单地`user`从新`SQL`请求中“重置”对象。我的意思是：

```
Session["user"] = db.Users.Where(u => u.UserID == user.UserID).SingleOrDefault(); 
```

（以前的用户在哪里`user`）
但这没有帮助。
请注意：重新运行应用程序后，`user.Uploads`确实有新的上传！
有没有人遇到过这种类型的问题，或者这是正常行为？我是这个框架的新手。我很乐意接受任何建议。

谢谢！

PS我在另一种方法中有`DB.Uploads.Count()`一行，添加上传后*确实*增加了。

编辑：我尝试过的一些事情：

1.  我的代码中的第一个方法（初始化）是`db = new new DBDataContext();`.
    我在我的第一种方法中添加了`db.Dispose; db = new DBDataContext();`after `db.SubmitChanges();`，只是为了看看它是否有任何作用。它没有。

2.  作为一个快速修复，我做到了`user.Uploads.Add(upload);`。它*确实*添加了适当的对象`user.Uploads`，然后在`foreach`循环中使用该对象。嗯，呃。但我仍在等待有关此行为的一些解释。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T15:57:03.410

将 User 对象存储在 Session 中会导致它在后续请求中与数据上下文断开连接。因此，对数据库所做的任何更改（对于用户实体或其任何子实体）都不会反映在对象实例中。

为了解决这个问题，您有多种选择。正如您所做的那样，您可以在任何时候进行更改时自己简单地更新会话存储的对象实例。您还可以在进行任何数据库更改之前重新连接存储在 Session 中的实体（这本身可能有问题）。您还可以在任何时候更改数据时刷新会话对象实例。最后，您根本无法将对象存储在会话中，只需在需要时随时从数据库中检索它。

您提到您尝试刷新存储的会话对象并没有帮助。我假设你是在打电话后这样做`SubmitChanges()`的，对吗？这应该有效。您能否发布有问题的两种方法（即插入新上传的完整方法和包含`foreach`循环的方法）以及它们如何交互？

# java - RemoteWebDriver(Firefox) 不适用于 xpath

> ID：11378673
> 
> 赞同：0
> 
> 时间：2012-07-07T21:13:07.240
> 
> 标签：java, selenium, webdriver, selenium-webdriver

我正在尝试在 google.com 上将 RemoteWebDriver 与 xpath 定位器一起使用，这是来自运行 firefox 的节点的日志。它接收所有这些命令但不执行它们。除了打开谷歌主页外，我没有看到任何浏览器活动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:30:20.820

我有类似的麻烦。我的虽然是 webdriver。我注意到行为取决于浏览器。在下面的链接中，我举了两个例子。第一个是像你这样的Firefox，第二个是使用android驱动程序。不过，他们都使用 chrome。

在我的情况下，xpath 最终确实使用了更明确的路径（比查找元素所需的更明确），如果这不可能，我不得不走另一条路线，比如 css。

[https://stackoverflow.com/a/11341946/1258245](https://stackoverflow.com/a/11341946/1258245)

# java - 番石榴多图。将价值放在结尾和开头

> ID：11378674
> 
> 赞同：3
> 
> 时间：2012-07-07T21:13:12.317
> 
> 标签：java, guava, multimap

我使用番石榴多图：

```
Multimap<Integer, String> commandMap = LinkedHashMultimap.create();
...
actionMap.put(index, "string"); // Put value at the end of list. 
```

此命令将值放在列表的末尾。但我需要能够同时添加到结尾和开头。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:17:02.027

链接的 hashmap 不能作为列表工作，因为它只是一个常规映射，其中保留了添加节点的顺序，供您以后使用（例如使用迭代器）。这就是为什么您没有任何功能来添加具有索引的元素。

如果要在 a 的开头添加一个元素，`LinkedHashMultimap`则需要创建一个新元素并将旧元素的所有元素添加`LinkedHashMultimap`到新元素中：

```
Multimap<Integer, String> newMap = LinkedHashMultimap.create();
newMap.put(key,valueForTheFirstIndex); // first (and only) object of new map
newMap.putAll(commandMap); // adds with the order of commandMap 
commandMap = newMap; 
```

add all 会将所有其他元素添加到 newMap 中，从而使它们`valueForTheFirstIndex`实际上保留在第一个索引中。请注意，如果这样做，您将失去使用映射的优势，因为如果总是添加到数组的开头，您的复杂性将是 O(n^2)。如果要添加到索引中，则应在添加内容时使用列表，然后转换为linkedhashmap 以便快速访问。

* * *

（不在问题范围内）

您在那里命名的`index`值不是索引，而是实际上是键。您在地图中没有索引。

```
actionMap.put(index, "string"); 
```

正如您在文档中所读到的：[http ://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/LinkedHashMultimap.html](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/LinkedHashMultimap.html)

```
put(K key, V value) // you don't see any reference to index there 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:44:57.737

这不是一个`ListMultimap`，这是一个`SetMultimap`。如果您想要`ListMultimap`，请使用`ArrayListMultimap`或`LinkedListMultimap`。

# ruby-on-rails - Rails 3.1 App 仅在本地机器上可见

> ID：11378676
> 
> 赞同：1
> 
> 时间：2012-07-07T21:14:34.530
> 
> 标签：ruby-on-rails, fedora, ports

我制作了一个 Rails 3.1 应用程序，并将其以生产模式部署在本地 fedora 16 服务器上。在服务器上，我可以成功访问应用程序。

现在，当我尝试从本地网络中的另一台机器访问应用程序时，它会失败。

Webrick 在启动时说

```
Rails 3.1.0 application starting in production on http://0.0.0.0:3000 
```

ping这台机器有效。

我还编辑`/etc/sysconfig/iptables`添加

```
-A INPUT -m state --state NEW -m tcp -p tcp --dport 3000 -j ACCEPT 
```

并重新启动 iptables 没有任何成功。

有什么我错过的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:53:53.087

您使用的是什么网络服务器？使用 apache，您需要确保您正在“监听”URL 和端口。这是在配置文件中设置的。本地主机是默认设置的，所以如果你没有为 URL 或 IP 设置它，那么你需要这样做。

/etc/hosts.allow

```
 #
  # /etc/hosts.allow
  #
  sshd: ALL: ALLOW
  httpd: ALL: ALLOW
  ruby: ALL: ALLOW
  WEBrick: ALL: ALLOW
  webrick: ALL: ALLOW
  # End of file 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-07T22:37:56.587

尝试在端口 80 上运行它

```
$ rails s -p 80 
```

# c++ - find() 相等运算符重载

> ID：11378678
> 
> 赞同：1
> 
> 时间：2012-07-07T21:15:14.743
> 
> 标签：c++

什么是实现自定义 find() 函数的干净方法？例如，我希望我的 operator== 为类 X 工作，匹配接近现有值的变量值。

```
class X{
public:

  double _a;
  double _b;
  double _c;

X(double a, double b, double c){
   _a = a;
   _b = b;
   _c = c;
 }

  bool operator==(const X& other) const
  { 
      if(fabs(other._a - _a) < 0.02) return true;       
      return false;
  }

};

typedef X* ptrX;

std::vector<ptrX> vec;
ptrX t1 = new X(1,2,3);
vec.push_back(t1);
ptrX t = new X(1.01,2,3); 

bool b = (find(vec.begin(),vec.end(),t) == vec.end()); //b should be false 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:28:56.343

您的 find 函数比较指针而不是它们的数据。如果你有一个兼容 C++11 的编译器，你应该可以这样做：

```
bool b = std::find_if( vec.begin(), vec.end(), 
    [&]( const ptrX& p ){ return *t == *p; }
) == vec.end(); 
```

或者在非 C++11 环境中：

```
bool b = std::find_if( vec.begin(), vec.end(), your_deref_equal ) == vec.end(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:34:19.403

你的相等运算符很好（除了它不是等价的，但你想要那样）。但是，您的问题是您在向量中存储指针，而不是对象，因此，您根本不使用比较运算符（`find`如果有的话，会比较指针是否相等）。

您可以通过以下方式修复它

*   要么将对象直接存储在向量中，即将您的代码段更改为

    ```
    std::vector<X> vec;
    X t1 =  X(1,2,3);
    vec.push_back(t1);
    X t =  X(1.01,2,3); 
    bool b = (find(vec.begin(),vec.end(),t) == vec.end()) 
    ```

    这很容易，并且会起作用，但在某些情况下可能不可接受（如果您希望*同一个*对象在向量中出现两次）。在这种情况下，您可以

*   使用[Boost Ponter Container Library](http://www.boost.org/doc/libs/1_50_0/libs/ptr_container/doc/tutorial.html) `ptr_vector`作为你的向量，它为指针容器提供了更清晰的界面，或者

*   为 STL 算法提供自定义比较器，请参阅其他答案。

# html - 使侧边栏高度匹配内容区域

> ID：11378682
> 
> 赞同：-1
> 
> 时间：2012-07-07T21:15:38.093
> 
> 标签：html, css

所以，我在布局方面遇到了麻烦。我想让侧边栏达到内容高度的 100%。我已经尝试过其他人提供的技巧，但他们没有奏效。我不知道是不是因为我的页面布局略有不同还是什么，但是是的......

编码：

```
<div id="page">
    <div id="top">
       <div id="topwidth">
             this is a top bar
       </div>
   </div>
   <div id="leftmenu">
        this is a fixed floating menu to the left
   </div>
   <div id="wrapper">
    <div id="maincontent">
        <div class="post">
                         This is my content area. multiple post divs will be here
        </div>
    </div><!-- Main Content-->
    <div id="sidebar">
                Yep... this is where the trouble is; It won't go 100%.
    </div> <!-- Sidebar -->
    <div id="clearfix">
        ...I tried this.
    </div>
</div> <!-- Wrapper -->
<div id="footer">
    This is my footer, it's 100% the width of the page.         
</div> <!-- Footer -->
</div> <!-- Page --> 
```

和CSS：

```
* {
margin:0px;
padding:0px;
border:0px;
outline:0px;
font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
cursor:default;
}

a {
transition: color 1s;
-moz-transition: color 1s; /* Firefox 4 */
-webkit-transition: color 1s; /* Safari and Chrome */
-o-transition: color 1s; /* Opera */
}

html {
height:100%;
width:100%;
}

body {
height:100%;
width:100%;
overflow-y: scroll;
}

#page {
width:100%;
display:block;
background-color:#FFF;
    background-image: -moz-linear-gradient(left , #BCBCBC 0%, #FFFFFF 10%,     #FFFFFF 90%, #BCBCBC 100%);
        background-image: -webkit-gradient(
            linear,
            left top,
            right top,
            color-stop(0, #BCBCBC),
            color-stop(0.1, #FFFFFF),
            color-stop(0.9, #FFFFFF),
            color-stop(1, #BCBCBC)
    );
}

#top {
background-color:#6666ff;
border-bottom:1px solid #3333ff;
height:39px;
width:100%;
z-index:99;
position:fixed !important;
box-shadow:0px 5px 10px rgba(50, 50, 50, 0.5);
}

#wrapper {
margin:0px auto;
padding-top:50px;
width:950px;
text-align:center;
}

#leftmenu {
margin-left:-75px !important;
z-index:98;
height:100%;
width:75px;
text-align:center;
position:fixed;
border-right:15px solid #999fff;
display:block;
background-color:#FFF;
    background-image: -moz-linear-gradient(left , #f5f5f5 0%, #f5f5f5 95%, #e5e5e5 100%);
        background-image: -webkit-gradient(
            linear,
            left top,
            right top,
            color-stop(0, #e5e5e5),
            color-stop(0.5, #f5f5f5),
            color-stop(0.95, #f5f5f5),
            color-stop(1, #e5e5e5)
    );
background-repeat:no-repeat;
box-shadow:0px 0px 10px rgba(50, 50, 50, 0.5);
transition: margin-left 0.3s;
-moz-transition: margin-left 0.3s; /* Firefox 4 */
-webkit-transition: margin-left 0.3s; /* Safari and Chrome */
-o-transition: margin-left 0.3s; /* Opera */
}

#header:hover {
margin-left:0px !important;
}
#maincontent {
width:625px;
height:100%;
float:left;
position:relative;
}

#clearfix {
width:100%;
clear:both;
}

#sidebar {
width:300px;
height:100%;
margin-top:5px;
position:relative;
float:right;
}

#footer {
text-align:center;
clear:both;
height:100%;
width:100%;
padding-top:10px;
background-image: -moz-linear-gradient(top, rgba(255,255,255,0.001) 0%, rgba(255,255,255,1) 100%);
        background-image: -webkit-gradient(
            linear,
            left top,
            left bottom,
            color-stop(0,rgba(255,255,255,0.001)),
            color-stop(1,rgba(255,255,255,1))
        );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T22:13:32.583

我想这就是你想要做的？

**CSS**：

```
 * {
    margin: 0;
    padding: 0;
    border: 0;
    outline: 0;
    font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
    }

a {
    transition: color 1s;
    -moz-transition: color 1s; /* Firefox 4 */
    -webkit-transition: color 1s; /* Safari and Chrome */
    -o-transition: color 1s; /* Opera */
    }

html {
    background-color: #FFF;
    background-image: -moz-linear-gradient(left , #BCBCBC 0%, #FFFFFF 10%,     #FFFFFF 90%, #BCBCBC 100%);
    background-image: -webkit-gradient(
        linear,
        left top,
        right top,
        color-stop(0, #BCBCBC),
        color-stop(0.1, #FFFFFF),
        color-stop(0.9, #FFFFFF),
        color-stop(1, #BCBCBC)
        );
    height: 100%;
    width: 100%;
    }

body {
    height: 100%;
    overflow-y: scroll;
    position: relative;
    width: 100%;
    }

#footer {
    background: #ccc;
    clear: both;
    min-height: 150px;
    padding-top: 10px;
    text-align: center;
    }

#header {
    background-color: #6666ff;
    border-bottom: 1px solid #3333ff;
    box-shadow: 0px 5px 10px rgba(50, 50, 50, 0.5);
    height:39px;
    position:fixed;
    width:100%;
    z-index:99;
    }

#leftmenu {
    margin-left:-75px;
    height:100%;
    width:75px;
    text-align:center;
    position:fixed;
    border-right:15px solid #999fff;
    display:block;
    background-color:#FFF;
        background-image: -moz-linear-gradient(left , #f5f5f5 0%, #f5f5f5 95%, #e5e5e5 100%);
            background-image: -webkit-gradient(
                linear,
                left top,
                right top,
                color-stop(0, #e5e5e5),
                color-stop(0.5, #f5f5f5),
                color-stop(0.95, #f5f5f5),
                color-stop(1, #e5e5e5)
        );
    background-repeat:no-repeat;
    box-shadow:0px 0px 10px rgba(50, 50, 50, 0.5);
    transition: margin-left 0.3s;
    -moz-transition: margin-left 0.3s; /* Firefox 4 */
    -webkit-transition: margin-left 0.3s; /* Safari and Chrome */
    -o-transition: margin-left 0.3s; /* Opera */
    z-index:98;
    }

#maincontent {
    background: #ccc;   
    float: left;
    position: relative;
    width:950px;
    }

    #maincontent .post {
        background: #eee;
        width:625px;
        }

#sidebar {
    background: #f00;
    bottom: 0;
    position: absolute;
    right: 0;
    top: 0;
    width: 300px;
    }

#wrapper {
    height: 100%;
    margin:0px auto;
    padding-top:50px;
    width:950px;
    } 
```

* * *

**HTML**：

```
<div id="header">
    HEADER
</div>

<div id="leftmenu">
    this is a fixed floating menu to the left
</div>

<div id="wrapper">

    <div id="maincontent">
        <div class="post">
            This is my content area. multiple post divs will be here
        </div>

        <div class="post">
            This is my content area. multiple post divs will be here
        </div>

        <div class="post">
            This is my content area. multiple post divs will be here
        </div>

        <div class="post">
            This is my content area. multiple post divs will be here
        </div>

        <div class="post">
            This is my content area. multiple post divs will be here
        </div>                                      

        <div id="sidebar">
            Yep... this is where the trouble is; It won't go 100%.
        </div>                                              

    </div><!--maincontent-->

</div><!--wrapper-->

<div id="footer">
    FOOTER
</div> 
```

# c++ - core_c.h 的 OpenCV 包含错误

> ID：11378686
> 
> 赞同：2
> 
> 时间：2012-07-07T21:16:10.567
> 
> 标签：c++, c, visual-studio-2010, opencv

我已经用 svn 下载了 opencv 并使用 cmake 编译它。我遵循[了这个不错的指南](http://redkiing.wordpress.com/2010/10/03/opencv-and-visual-studio-2010-with-cmake/)。

我创建了第一个包含基本内容的项目：

```
#include <cv.h>
#include <highgui.h> 
```

但是当我尝试编译时，我得到：

```
C:\Progam Files\OpenCV\include\opencv\cv.h(63): fatal error
"opencv2/core/core_c.h" no such file or directory 
```

我该如何解决这个问题？我应该明确设置一些自定义包含目录吗？这很奇怪，因为 Cmake 应该完成所有配置......

我在使用**Windows Vista的****Visual Studio 2010**

 **在我添加`"C:\Progam Files\OpenCV\include"`为包含目录的项目属性上

注意`configuration properties->C/C++->Aditional include directories`里面已经有：`C:\Progam Files\OpenCV\include`

## 编辑

原来 cmake 制作的 VC 项目包含错误的目录，我不得不手动设置所有

```
C:\Progam Files\OpenCV\modules/*/include 
```

目录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:21:23.057

确保您已将`include`目录添加到`include directories`VS 中的选项（配置属性->C/C++->附加包含目录）。**

# java - jexcel API 中的 IndexOutOfBoundsException

> ID：11378688
> 
> 赞同：1
> 
> 时间：2012-07-07T21:16:14.837
> 
> 标签：java, jxl

我遇到了 indexoutofboundsexception，我搜索了互联网并查看了几种不同的解决方案，但这段代码没有运气。

这是我的错误信息：

```
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
at java.util.ArrayList.RangeCheck(ArrayList.java:547)
at java.util.ArrayList.get(ArrayList.java:322)
at jxl.write.biff.WritableWorkbookImpl.getSheet(WritableWorkbookImpl.java:408)
at Segmentation.main(Segmentation.java:81) 
```

第 81 行：

```
WritableSheet sheet = copy.getSheet(0); 
```

一些帮助将不胜感激。谢谢你！

```
import java.io.File; 
import java.util.Date; 
import jxl.*; 
import java.io.IOException;
import jxl.read.biff.*;
import jxl.write.*;
import jxl.Workbook;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.net.MalformedURLException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLEncoder;

public class Segmentation{

    private static  final String googleTranslate = "http://http://translate.google.com/#zh-CN|zh-TW|";

    public static String translate(String string) {

        String translation = googleTranslate + string;
        URL translationURL;

        try { translationURL = new URL(translation); }
        catch(MalformedURLException e) { return e.getMessage(); }

        BufferedReader httpin;
        String fullPage = "";
        System.out.println(translation);
        try {
            httpin = new BufferedReader(
                    new InputStreamReader(translationURL.openStream()));
            String line;
            while((line=httpin.readLine()) != null) { fullPage += line + '\n'; }
            httpin.close();
        } catch(IOException e) { return e.getMessage(); }

        int begin = fullPage.indexOf("<span class=\"\">");
        int end = fullPage.indexOf("</span>");

        return fullPage.substring(begin + 15, end);

    }

public static void main(String[] args) throws IOException, WriteException, BiffException
    {

        /*try
        {
            Workbook workbook = Workbook.getWorkbook(new File("DATA_Chinese_All.xls"));
            Sheet sheet = workbook.getSheet(0);

        }
        catch (IOException e)
        {   
            e.printStackTrace();
        }
        catch (BiffException e)
        {
            e.printStackTrace();}*/

            Workbook workbook = Workbook.getWorkbook(new File("DATA_Chinese_All.xls"));
            WorkbookSettings s = new WorkbookSettings();  
            s.setUseTemporaryFileDuringWrite(true);  
            WritableWorkbook copy = Workbook.createWorkbook(new File("someFile.xls"), s);
            //WritableWorkbook copy = Workbook.createWorkbook(new File("output.xls"), workbook);

            WritableSheet sheet = copy.getSheet(0); 

            int max = 302;
            int count = 0;
            for(int i = 1; i < max; i++)
            {   
                WritableCell cell  = sheet.getWritableCell(1, i);

                if (cell.getType() == CellType.LABEL);

                {

                    Label l = (Label) cell;
                    //Result = "http://translate.google.com/#zh-CN|zh-TW|"+(l.getContents();)
                    l.setString(translate(l.getContents()));

                    //l.setString();
                }   
                count++;

            copy.write();
            copy.close();

    } 

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:27:00.210

尝试使用 createSheet 而不是 getSheet

[http://jexcelapi.sourceforge.net/resources/javadocs/2_6_10/docs/jxl/write/WritableWorkbook.html#createSheet%28java.lang.String,%20int%29](http://jexcelapi.sourceforge.net/resources/javadocs/2_6_10/docs/jxl/write/WritableWorkbook.html#createSheet%28java.lang.String,%20int%29)

# php - 正则表达式在 PHP 中提取 JavaScript 变量

> ID：11378690
> 
> 赞同：4
> 
> 时间：2012-07-07T21:16:21.620
> 
> 标签：php, javascript, arrays, web-scraping

我有一个很大的 HTML 文件，其中包含很多内容。我想`'a'`从整个文件中获取一个 JavaScript 变量，例如命名。

示例：（删除了很​​多实际内容）

```
<html>
    <head>
        <script>
            var a = [{'a': 1, 'b': 2}];
        </script>
    </head>
    <body>
        ....
    </body>
</html> 
```

从上面应该得到的是：

```
[{'a': 1, 'b': 2}] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T21:17:58.073

```
preg_match('#var a = (.*?);\s*$#m', $html, $matches);
echo $matches[1]; 
```

解释：

*   正则表达式将尝试匹配任何包含`var a =`
*   然后它将匹配所有内容，直到 a `;`，任意数量的空格`\s*`，然后是行尾`$`
*   修饰符将`m`尝试独立匹配每一行，没有它，`$`只会匹配字符串的结尾，这有点没用

*任何数量的空格*仅在定义后有一些空格的情况下存在，没有其他原因（例如人为错误）。如果您确定不会发生这种情况，您可以删除`\s*`.

请注意，这不会取代成熟的解析器。`a`如果定义超过一行，如果`a`定义不止一次（考虑范围，您可以`var a`在全局范围内，然后`var a`在函数内）等，您将需要进行修改。

# c# - 如何在 C# 的字节数组中找到字节模式？

> ID：11378691
> 
> 赞同：2
> 
> 时间：2012-07-07T21:16:23.017
> 
> 标签：c#, arrays, search, byte

我正在做一个项目，我从文件中读取数据，我需要操作其中的一些数据。

数据是二进制的，其中包含一些 ASCII 编码文本。如果这很重要，数据也会保存在 Big Endian 中。

我想要完成的是在这些数据中找到一个模式并操作该模式的一部分。

示例：（09 49 6E 76 65 6E 74 6F 72 79 0A 00 00 00 02 01 00）

这表示 Inventory 中有多少个字母的数字 9，后跟不带引号的 ASCII“Inventory”。“0A”标记该 ASCII 文本的结尾，后跟 00 00 00 02 标记我们库存的大小“2”。“01 00” 标志着整个库存区域的结束。

示例 2：（04 53 6C 6F 74 00 02 00）

这表示 Slot 中有多少个字母的数字 4，后跟不带引号的 ASCII“Slot”。“00”是 ASCII 文本和插槽号“02”之间的空格，后跟区域“00”的结尾。

我需要在文件中找到这些模式和其他几个模式。然后我需要修改部分模式并写入磁盘。

ExampleModify: (04 53 6C 6F 74 00 02 00) "From above" to (04 53 6C 6F 74 00 07 00) 改变 "slot number '02' to '07'.

另一个需要注意的是，虽然我需要在文件中搜索不同大小、长度和包含的数据的多个模式，但这些模式的多个部分可能包含需要单独修改的不同数据作为一个整体。

澄清：（库存，插槽，id，计数） - 将被视为一个人的信息。

记录的每个人都可以有多个（Inventory、Slot、id、Count）副本。

我想向用户显示此信息，并为他们提供修改组中每个元素的选项。

我不是一个好的程序员，想学习，如果你有例子我很感激，如果你有建议，请给它。如果你能把它调低就更好了，谢谢。我现在有一个正在进行的工作，但我现在卡住了。如果你想看看我有什么，请告诉我。

我所拥有的总结：将文件读入 byte[] 然后将整个数组显示到控制台。就是这样。带有一些格式化和一些调试信息，用于定位我读入数组的那个块。

这是我在 pastebin 上的代码的链接。[关联](http://pastebin.com/f8Kk2gbL)

我意识到我没有得到 (Inventory, Slot, id, Count) 的所有出现，我也需要修复它。

编辑：示例（09 49 6E 76 65 6E 74 6F 72 79 0A 00 00 00 02 01 00）这是我正在读取的文件中固定长度的二进制数据块。如前所述，09 表示字符串的长度。字符串后面是 (0A 00 00 00 02 01 00) 的重要部分是 (02) 这是因为这是二进制数据片中唯一改变的字节。“02”表示“2”，表示该特定人员记录有 2 个 (Slot, id, Count) 实例。

```
(File)
    (09 Inventory 0A 00 00 00 02 01 00) // Start of person 1's record with 2 instances.
        (Slot)
        (id)
        (Count)
        (Slot)
        (id)
        (Count)
    (Rotation)  // End of person 1's record

    (09 Inventory 0A 00 00 00 04 01 00) // Start of person 2's record with 4 instances.
        (Slot)
        (id)
        (Count)
        (Slot)
        (id)
        (Count)
        (Slot)
        (id)
        (Count)
        (Slot)
        (id)
        (Count)
    (Rotation)  // End of person 2's record
(File End) 
```

这个想法是我想编辑“id”或通过添加到库存中来增加插槽的数量并添加更多的（Slot，id，Count）实例。

“id” - 包含项目 ID

“Slot” - 包含库存槽编号

“计数” - 包含该插槽中有多少项目。编辑注意：如果我不清楚，请告诉我，再次感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:44:31.230

你说你不是一个好的程序员。然后我会提出一些基本的建议。

首先，对于任何问题，将其分解。尝试将其分解为您可以解决的更简单的子问题，或者认为会更容易解决。您说您想检查文件中的模式，然后可能会修改一些数据并将其写回。作为第一步，我想说这些是您需要解决的主要子问题才能获得完整的解决方案。

*   读取文件
*   在二进制数据中搜索模式
*   进行修改
*   写出修改后的数据。

您主要关注“搜索模式”部分，因此我将集中进一步评论。所有这些其他部分也可能很棘手，但您可以自己解决它们，或者在 stackoverflow 或其他地方寻找其他人如何解决它们的提示。

好的，现在，关于“搜索模式”。在我阅读你的描述时，

在我看来，字节数组中的第一个字节是文本长度。在 C# 代码中，可以像这样显式声明展示您的模式的数据数组：

```
byte[] data = new byte[] { 9, 0x49, 0x6E, 0x76, 0x65, 0x6E, 0x74,
               0x6F, 0x72, 0x79, 0x0A, 0, 0, 0, 2, 1, 0 } ; 
```

当然，您不会明确声明数组。您将通过文件读取操作创建或填充数组。在这一点上，文件读取仍然是一个悬而未决的问题，但没关系 - 您可以单独解决它。而且，效果是一样的——当您成功读取文件时，您将拥有一个看起来像上面明确声明的数组的字节数组。

好的，现在你如何操作这些数据？第一个字节是字符串数据的长度。接下来的 N 个字节是字符串数据。然后你有一些其他的东西。

您没有准确描述要进行哪些“修改”，但是根据您提供的信息，应该很容易浏览数据。

如果您想获取数组中数据的“切片”，您可以这样做。

```
int length = (int) data[0];
byte[] s = new byte[length];
Array.Copy(data, 0, s, 0, length);
// now, s contains N bytes, representing the string 
```

您可能想要做的下一件事是从您切出的那些字节中获取一个实际的字符串。为此，请使用[Encoding 类](http://msdn.microsoft.com/en-us/library/system.text.encoding.utf8%28v=vs.80%29.aspx)：

```
String word = System.Text.Encoding.UTF8.GetString(s); 
```

我不理解字符串数据后面的数据模式。在某些情况下是`00`，在某些情况下是`0A`。

但也许你知道模式。遵循相同的方式，您可以遍历一个“记录”的所有数据。当您到达记录的末尾时，请重新开始并处理下一个。进入下一个“记录”的关键是知道从你从文件中读取的数据中取出多大的数据片段。

* * *

这让我们回到了“读取文件”的子问题。从文件中获取适量数据的一种方法是只读取第一个字节，然后再读取文件中的 N 个字节。（参见[System.IO.Stream.Read](http://msdn.microsoft.com/en-us/library/system.io.stream.read.aspx)）。

```
byte[] size = new byte[1];
var fileStream = File.OpenRead(path);
int offset = 0;
int n;
n = fileStream.Read(size, offset, 1);
// size[0] now contains the byte of data indicating the number of bytes to follow 
```

此时您可以读取接下来的 N 个字节：

```
int length = (int)size[0];
byte[] stringData = new byte[length];
n = fileStream.Read(stringData, offset, length); 
```

现在你可以得到字符串了。

```
String word = System.Text.Encoding.UTF8.GetString(stringData); 
```

...等等。读取所有尾随字节。此时，由`fileStream`指向文件中下一条记录的指针隐式持有的游标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:03:01.653

我同意@Cheeso 上面所说的，这是一个好的开始。我将描述一个替代解决方案：

1.  为所有已知部分定义操作码（一个以 0x4 0x56 开头，一个以 0xA 0x2 开头，等等）。
2.  读取内存中的文件。
3.  对内存中的字节数组应用匹配算法并提取每个匹配模式的起始位置。出于性能原因，我建议使用一种众所周知的搜索算法（或其变体），例如[Knuth-Morris-Pratt](http://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm)或[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)。
4.  此时，您应该在应用程序中缓存您找到的所有模式的所有开始位置。您可以为此使用列表字典（其中键是模式类型），但您可以将其包含到自定义类（在文件中具有模式 id 和模式偏移量），然后只需使用列表并使用 LINQ 访问所有内容.
5.  在需要时访问和解码实际模式，因此不要在读取文件后立即访问和解码。我想您对它们有不同的用途，并不是在有人加载文件后立即出现。

因此，这已经为您提供了文件中所有模式出现的列表。您可以使用它向用户显示某种列表。

我快速浏览了您的代码。它真的很大，都塞满了几个大功能。您需要对其进行一些结构化。每个任务需要一个类来加载和解析文件，然后是许多较小的函数。

当您在应用程序中使用模式时，例如当您让用户可以对其进行修改时，使用此机制应该相当容易：

*   在您已经拥有的偏移量处读取数据。
*   你知道偏移量，你也知道长度。当需要写回修改时，您可以将自己定位在加载流中的特定位置并覆盖。

必须不断地处理文件中的数据以进行各种修改，我会说最好将其保存在内存中并在需要时保存它，同时仍将修改后的版本保存在内存中。有时可能需要在内存缓存中更新模式偏移量，因此您可以仅将初始解析过程应用于文件的一小部分（以加快处理速度）。

如果您在加载文件后立即需要模式数据，那么您可以在第一次遍历文件时应用模式解码过程（当您提取偏移量时）。我建议仅将重要的内容保留在单独的集合中，以便向用户显示（例如仅 ID 和您需要显示的任何文本）。实际需要时加载整个条目。

# php - codeIgniter 闭包表模型

> ID：11378692
> 
> 赞同：0
> 
> 时间：2012-07-07T21:16:40.343
> 
> 标签：php, mysql, codeigniter, transitive-closure-table

这是我正在使用的课程：[**https ://gist.github.com/2174233**](https://gist.github.com/2174233)

我有两张表：一张表包含用户，另一张表包含闭包。

当我使用[`get_children()`](https://gist.github.com/2174233#L53)方法时（比如说从根或另一个父级），它只显示层次结构的第一级。`lvl` 我应该在列中存储什么值？

这是闭包表的定义，我有：

```
 CREATE TABLE closures (
     id         INT(11) NOT NULL AUTO_INCREMENT,
     ancestor   INT(11) NOT NULL,
     descendant INT(11) NOT NULL,
     lvl        INT(11) NOT NULL,

     PRIMARY KEY (id)
 ) 
```

这是我存储在闭包表中的数据示例：

```
INSERT INTO `closures` (`id`, `ancestor`, `descendant`, `lvl`) 
VALUES (1, 1, 20, 0),
       (4, 20, 26, 0),
       (5, 26, 25, 0); 
```

最后是`lvl`列，但我不知道那里有什么值。你能给我一个如何使用它的建议吗？

我必须存储的结构有 3 个级别：根 -> 20 节点 -> 26 节点，但它只给了我第一级子节点，即 20 节点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T03:02:39.317

我建议您阅读[SQL Antipatterns](http://pragprog.com/book/bksqla/sql-antipatterns)书。第二章将*闭包表*作为实现类别树的推荐方法之一。

那就是说。看起来你的闭包表有点奇怪。那里的`id`列没有意义。相反，您应该有一个复合主键，由一对唯一的祖先和后代值组成。

而且您还没有插入节点本身..只有两个不同节点之间的连接。也许阅读[“用闭包表渲染树”](http://karwin.blogspot.com/2010/03/rendering-trees-with-closure-tables.html)可以对这个主题有所启发。

猜测`INSERT`声明应该是这样的（至少是[我的结论](https://gist.github.com/2174233#L59)）：

```
INSERT INTO closures(ancestor, descendant, lvl) 
VALUES (1,  1,  null),
       (20, 20, null),
       (26, 26, null),
       (28, 28, null),
       (1,  20, 1),
       (20, 26, 2),
       (26, 25, 3); 
```

您必须了解的是，闭包表不存储树。相反，您正在使用的数据结构是有向图。像这样的东西：

![在此处输入图像描述](../Images/53d45f8ec61a6351bd28c6b956b8d9f8.png)

如您所见，该图具有**三个**根节点：3、5 和 7。此外，非常重要的是要注意，节点 10 的深度级别不同，具体取决于您从哪个根节点开始。

它将用两个闭包定义：[3,10,1] 和 [11,10,2]。意思是，来自第 11 个节点的连接将其置于二级，而从第 3 个节点开始，它是一级项目。

问题是，当您使用闭包表时，**每个类别都可以有多个父类别，每个类别的深度都不同**。

* * *

加法（@ypercube）：

我对“级别”或“深度”列的理解是它存储了从祖先到后代的“距离”（需要走的**步骤）。**它不是节点的绝对级别，因此闭包表可用于存储比树图更复杂的图。你甚至可能有多个从祖先到后代的路径，每一个（路径）都有不同的步骤。

此外，Nulls 应该为 0，并且需要更多的行。

因此，数据将是：

```
INSERT INTO closures(ancestor, descendant, lvl) 
VALUES ( 1,  1,  0), (20, 20, 0), (26, 26, 0), (25, 25, 0),
                     ( 1, 20, 1), (20, 26, 1), (26, 25, 1),
                                  ( 1, 26, 2), (20, 25, 2),
                                               ( 1, 25, 3) ; 
```

# windows - 证书路径问题

> ID：11378699
> 
> 赞同：0
> 
> 时间：2012-07-07T21:17:02.643
> 
> 标签：windows, iis, certificate

我有一个与子域关联的证书。

证书有效；当我在特定服务器上打开证书并选择“证书路径”选项卡时，我看到一个 3 级证书路径树（正确）。

在我想将证书安装到（在 IIS 中使用）的服务器上，证书路径已损坏，并收到以下消息：

> Windows 没有足够的信息来验证此证书

...安装我的 EV 证书后。

为什么会发生这种情况，我该如何解决？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T23:37:02.760

您是否检查过是否有需要安装的中间权威证书？转到您的 SSL 提供商网站，如果这是问题所在，他们通常会在那里提供。

无论哪种方式，都会生成错误，因为 IIS 无法验证根证书颁发机构的完整性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T19:12:44.740

就像我说的那样，我确信证书请求是从我试图安装证书的机器（VM）发出的。

此问题的根源是 IT 部门的某个人恢复了此 VM 的先前备份，因此证书的私钥不可用。

我使用以下教程重新生成了私钥：

[http://www.entrust.net/knowledge-base/technote.cfm?tn=7905](http://www.entrust.net/knowledge-base/technote.cfm?tn=7905)

谢谢

# php - 如何在将页面加载到 div 时恢复浏览器标准功能

> ID：11378701
> 
> 赞同：0
> 
> 时间：2012-07-07T21:17:18.097
> 
> 标签：php, javascript, jquery, html

问题是我的网站只包含一个页面，其中包含一个侧面菜单和一个 div，而所有其他页面都加载在其中，问题是所有浏览器诽谤的功能（返回、刷新、书签）都消失了。所以我的问题是有没有办法在将页面加载到 div 时恢复浏览器功能，或者我应该使用另一种方式在主页中加载页面？

主页：

```
<div id="nav" class="mmenu">
            <ul id="nav_ul" class="float_left">
                <li><a class="upper" id="1" target="collabsoft" href= "profilePage.php?property_variable=mine">My Profile</a></li>
                <li><a id="2" class="menu-message"
                       href= "viewMessages.php">Messages<label id="num_msg">(<?php echo $count; ?>)</label></a></li>
                <li><a id="3" class="menu-conference"  target="collabsoft" href= "userHomepage.php">My Conferences</a></li>
                <li><a id="4" class="menu-conference2"  target="collabsoft" href= "availableConferences2.php">Conferences</a></li>
                <li><a id="5" class="menu-request"
                       href= "incomingRequests.php">Requests<label id="num_requests">(<?php echo $total ?>)</label></a></li>
                <li><a id="6" class="menu-news"
                       target="collabsoft" href= "viewNews.php" >News</a></li>
                <li><a class="lower" id="7" target="collabsoft" href= "generalOptions.php" >Options</a></li>
            </ul>
        </div>
        <table id="collabsoft_table" class="no_border">
            <tr>
                <td id="collabsoft_td" class="no_border">
                    <div scrolling="no" id="collabsoft" name="collabsoft" class="collabsoft"></div>
                </td>
            </tr>
        </table>
        <br/>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:04:26.673

您需要为不同的资源提供不同的 URL，否则浏览器将不会保留/更新其历史记录，服务器将提供相同的页面。

*   您应该使用哈希链接（URL 中“#”字符之后的部分）
*   另一种选择是使用 HTML5 的 History API，它可用于“推送”虚假 URL

让我们关注第一个选项（哈希 URL），主要是因为浏览器支持。

此外，您没有指定是否使用任何 JavaScript 框架，我假设您使用的是 jQuery（因为它很受欢迎）。

查看[jQuery 历史](https://github.com/balupton/jquery-history/)

让我解释一下它是如何工作的：

创建链接时，不要绑定到它的“click”事件，而是给它一个哈希字符串，例如：

```
<a href="#about" title="About me">About</a> 
```

单击链接时，浏览器不会重新加载页面。

然后，使用 jQuery History 插件绑定到该历史更改，例如：

```
$.History.bind('/about',function(state){
    // Load resource using AJAX, update the "main" div, etc.
}); 
```

# php - MySQL 撇号的错误

> ID：11378704
> 
> 赞同：0
> 
> 时间：2012-07-07T21:17:32.307
> 
> 标签：php, mysql

我将如何将撇号 ' 插入 MySQL 而不会在 PHP 中引发任何错误。从 MySQL 中回显它们的正确方法是什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:22:10.060

您需要同时考虑 PHP 和 MySQL，如果您使用的是框架，也需要考虑。

就 PHP 而言，您需要使用与字符串中包含的相反的引用样式，或者“转义”它们，如下所示：

```
$string = 'this is not a problem; it\'s escaped.';
$string = "I don't need to escape"; 
```

对于 MySQL，您应该使用转义函数，如[mysql_real_escape_string](http://php.net/mysql_real_escape_string)或类似的。

有一种更高级的技术可以在查询中使用用户提供的数据，称为“准备语句”，这是使用用户提供的参数实现动态查询的最稳健、最安全的方法。请参阅[文档的此部分](http://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php)以开始使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:20:15.943

您应该使用准备好的查询，[PDO](http://php.net/manual/en/book.pdo.php)可能是最好的。你不需要担心逃避你的输入。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-07T21:20:43.597

在 php 中，您使用反斜杠转义撇号。

# google-apps-script - 将 GMail 保存到 Google Doc 并保持相同的外观

> ID：11378707
> 
> 赞同：0
> 
> 时间：2012-07-07T21:17:43.703
> 
> 标签：google-apps-script, gmail

我正在尝试保存一封电子邮件（来自 GMail），它有一些花哨的东西，比如可以使用 GMail 完成的不同字体颜色等（并且 GMail 可以理解）。

但是当我将电子邮件保存到 Doc 时，我看到它使用 HTML（我认为），所以想知道是否已经有一个 Google 脚本可以将 GMail 奇特的东西转换为 Google Docs 奇特的东西 =）

我是 Google Scripts 的新手，在查找一些参考资料时仍然遇到一些问题，所以如果已经有一个脚本，那么有人可以告诉我吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T13:08:59.390

AFAIK 没有这样的脚本。您可以做的可能会更好的是获取电子邮件 html 并通过 UrlFetch 将其发送到[Google Docs List Data API](https://developers.google.com/google-apps/documents-list/)，然后将其转换为 Google Documents 格式。这可能比尝试直接对脚本进行“转换”要好得多。

这样的脚本也更有可能已经实现，但我自己还没有完成。

# ios - 更优雅的方式来处理来自 UIActionSheet 的取消按钮单击？

> ID：11378710
> 
> 赞同：0
> 
> 时间：2012-07-07T21:18:08.583
> 
> 标签：ios, ios5

我正在开发一个 iOS 5.0 应用程序，我想知道是否有更“优雅”的方式来处理单击取消按钮。文档中似乎没有任何内容，所以我认为答案是否定的。

基本上我有一个 UIActionSheet，目前有 2 个按钮和取消按钮。根据我的代码，前两个按钮完全按照他们应该做的事情

```
 -(void)actionSheet:(UIActionSheet *)actionsheet clickedButtonAtIndex:(NSInteger)buttonIndex 
```

前两个按钮依赖于一些相同的变量，但根据单击的变量，它们会执行不同的操作。在上述方法中，这些变量在我的 switch 语句之外实例化，然后在案例内部执行。取消按钮不依赖任何这些变量（显然），因此为了避免所有实例化，我将所有这些代码包装在一个 if 语句中，用于测试取消按钮索引。

这不太理想。如果我向操作表添加新按钮，我必须记住更新 if 语句。代码本身通常看起来很混乱。我可以编写一个新方法来处理前两个按钮的单击逻辑，但如果有一种方法可以通过取消按钮简单地解除 ActionSheet 以防止调用 clickedButtonAtIndex 方法，那么我不想走那么远。

所以这是我的问题：有没有办法在不调用该方法的情况下关闭 ActionSheet？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:47:58.120

嗯，你可以做一些事情......在你提到的方法中，首先要做的是：

```
if(buttonIndex == actionSheet.cancelButtonIndex)
     return; 
```

据我所知，这是你能做的最好的。

希望这可以帮助。

问候，

乔治

# android - ViewPager，何时加载子 xml 文件？

> ID：11378711
> 
> 赞同：0
> 
> 时间：2012-07-07T21:18:20.853
> 
> 标签：android

我使用本指南来实现`ViewPager`：

[http://mobile.tutsplus.com/tutorials/android/android-user-interface-design-horizo​​ntal-view-paging/](http://mobile.tutsplus.com/tutorials/android/android-user-interface-design-horizontal-view-paging/)

这是我的`main.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:padding="10dp"
android:background="@drawable/gradientbg" >

 <android.support.v4.view.ViewPager
android:layout_width="match_parent"
android:layout_height="match_parent"
android:id="@+id/viewPager"/>

</LinearLayout> 
```

我的主要活动：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
setContentView(R.layout.main);

MyPagerAdapter adapter = new MyPagerAdapter();
    ViewPager myPager = (ViewPager)findViewById(R.id.viewPager);
    myPager.setAdapter(adapter);
    myPager.setCurrentItem(1);

    //textviews and other controls that arent located in main.xml will be null for a couple of seconds here 
```

viewpager 使用 2 个子 xml 文件作为可滚动内容。我如何知道 viewpager 何时完成以便我可以使用子控件，例如 textviews 等？

希望你明白这个想法，否则会详细说明。提前致谢！

```
public class MyPagerAdapter extends PagerAdapter {

public int getCount() {
    return 2;
}

public Object instantiateItem(View collection, int position) {

    LayoutInflater inflater = (LayoutInflater) collection.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    int resId = 0;
    switch (position) {
    case 0:
        resId = R.layout.debug;
        break;
    case 1:
        resId = R.layout.home;
        break;
    }

    View view = inflater.inflate(resId, null);

    ((ViewPager) collection).addView(view, 0);

    return view;
}

@Override
public void destroyItem(View arg0, int arg1, Object arg2) {
    ((ViewPager) arg0).removeView((View) arg2);

}

@Override
public boolean isViewFromObject(View arg0, Object arg1) {
    return arg0 == ((View) arg1);

}

@Override
public Parcelable saveState() {
    return null;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T22:31:21.310

在这种情况下，我更喜欢编写一个自定义`View`实现，该实现保留对其子项的引用，这些子项在创建时被初始化。（我经常为此使用内部静态类。）这有助于保持模块化。

例如：

```
public class MyView {
  private TextView myTextView;
  private ListView myListView;

  public MyView(Context context) {
    super(context);
    LayoutInflater.from(context).inflate(R.layout.my_layout, this, true);
    myTextView = (TextView) findViewById(R.id.my_textview);
    myListView = (TextView) findViewById(R.id.my_listview);
  }
} 
```

你得到了演习。现在你可以有这样的`setText(String)`方法：

```
 public void setText(String text) {
    myTextView.setText(text);
  } 
```

在您的情况下，您将创建两个这样的视图类，一个`HomeView`和一个`DebugView`（或其他）。

您可以预先创建所需的实例，如果 ViewPager 预先缓存了这两个实例，这似乎是合理的，或者您可以按需创建它们。

第一种情况（急切的实例化）可能如下所示：

```
private HomeView homeView;
private DebugView debugView;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    homeView = new HomeView(getContext());
    debugView = new DebugView(getContext());

    MyPagerAdapter adapter = new MyPagerAdapter();
    ViewPager myPager = (ViewPager)findViewById(R.id.viewPager);
    myPager.setAdapter(adapter);
    myPager.setCurrentItem(1);
} 
```

您在自定义 View 类的构造函数中执行所有需要的初始化，并根据需要传递所需的信息（和/或可能的`savedInstanceState`）。

然后您的 PagerAdapter`instantiateItem`可能如下所示：

```
public Object instantiateItem(ViewGroup container, int position) {

    final View view;
    switch (position) {
    case 0:
       view = debugView;
       break;
    case 1:
       view = homeView;
       break;
    default:
       throw new IllegalStateException("Should not happen");
    }

    container.addView(view, 0);

    return view;
} 
```

（您不想使用该`instantiateItem(View, int)`方法，它已被弃用且不方便。）

如果您想按需实例化您的视图，您可以将构造函数调用移动到适配器中，然后您必须`null`在访问视图时检查值。

如果您负担得起以 API 13 及更高版本为目标，您可能希望改用[FragmentPagerAdapter](http://developer.android.com/reference/android/support/v13/app/FragmentPagerAdapter.html)。

* * *

为了让事情看起来更好，如果你想要一个 PagerAdapter 只提供非常有限数量的预先创建的视图（你真的只想要它是一个非常小的数字，比如 2），你可以这样写：

```
public class ArrayPagerAdapter extends PagerAdapter {

  private final View[] mViews;

  public ArrayPagerAdapter(View... views) {
      mViews = views;
  }

  @Override
  public int getCount() {
      return mViews.length;
  }

  @Override
  public Object instantiateItem(ViewGroup container, int position) {
      final View view = mViews[position]

      container.addView(view);

      return view;
  }

  @Override
  public void destroyItem(ViewGroup container, int position, Object object) {
      container.removeView((View) object);
  }

  @Override
  public boolean isViewFromObject(View view, Object object) {
      return view == object;
  }

} 
```

然后您可以使用它来实例化

```
PagerAdapter adapter = new ArrayPagerAdapter(debugView, homeView); 
```

# java - 如何解决 Android 上的 HttpGet 问题？

> ID：11378712
> 
> 赞同：0
> 
> 时间：2012-07-07T21:18:28.090
> 
> 标签：java, android

我编写了代码以在 Android 上发出 get 请求，但出现如下错误：

```
07-07 21:12:39.674: E/AndroidRuntime(2409):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117) 
```

所以我读到我必须使用 AsyncTask。我做的。一次它运行良好，但下次我运行应用程序时，我又遇到了这个错误。

这是我的代码：

```
package app.teksty;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;

import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.os.AsyncTask;
import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;

public class MainActivity extends Activity {

    private class HttpGetRequest extends AsyncTask<String, Integer, Void>
    {

        private InputStream content;

        @Override
        protected Void doInBackground(String... params) {

              String url = params[0];
              Log.i("[GET REQUEST]", "STARTED");
              try {
                  HttpClient httpclient = new DefaultHttpClient();
                  HttpResponse response = httpclient.execute(new HttpGet(url));
                  content = response.getEntity().getContent();
              } catch (Exception e) {
                  Log.e("[GET REQUEST]", "Network exception", e);
              }

              return null;

        }

        @Override
        protected void onPostExecute(Void result) { 
            super.onPostExecute(result);

            BufferedReader r = new BufferedReader(new InputStreamReader(content));
            StringBuilder respond = new StringBuilder();
            String line;
            try {

                while ((line = r.readLine()) != null) {
                    respond.append(line);
                }

                Log.i("[GET REQUEST]", respond.toString());

            } catch (IOException e) {

                Log.e("[GET REQUEST]", "", e);
            }

        }

    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        new HttpGetRequest().execute("http://www.google.pl");

        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

我做错了什么或者我必须解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T09:57:53.360

尝试将此代码放入您的方法中`onCreate()`：

```
StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
StrictMode.setThreadPolicy(policy); 
```

但是，这仅适用于 build sdk 版本 9 及更高版本

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T21:38:30.313

您在使用 Inputstream 时正在处理主线程，这算作在网络上工作。阅读 doInBackground() 处理程序中的全部内容，你应该没问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T22:02:09.680

该`onPostExecute()`方法在主 UI 线程上运行。您没有在其中使用任何 UI 元素，那么为什么要在 UI 线程中包含所有这些语句。只需将所有这些语句移到`doInBackground()`最后，在 return 语句之前，然后尝试是否可行。

# gcc - 了解 GCC 的 `-fmem-report` 输出

> ID：11378717
> 
> 赞同：1
> 
> 时间：2012-07-07T21:19:43.260
> 
> 标签：gcc

我应该如何解释 GCC`-fmem-report`标志给出的输出？

我可以从表和后续统计中检索到哪些信息？

我尝试在编译期间检索峰值内存消耗并直观地认为，表的最后一行 ( `Total`) 给了我这个值。但这些与我在`top`.
在编译我的项目时，进程的最高峰`gcc`值约为 1.7GB，但我在构建日志中可以找到的最大值约为 750MB。

还有哪些其他 GCC 标志可以帮助我监控这些 ~1.7GB？还是我需要`make`在脚本监控`gcc`和`ld`流程中进行包装？

给定以下输出，哪些值是最重要且信息量最大的？

```
Memory still allocated at the end of the compilation process
Size   Allocated        Used    Overhead
8             40k         38k       1200 
16           104k        100k       2288 
32           296k        295k       5328 
64            20k         16k        320 
128         4096         384          56 
256           48k         45k        672 
512          188k        187k       2632 
1024         888k        887k         12k
2048         156k        154k       2184 
4096         188k        188k       2632 
8192          56k         48k        392 
16384         16k         16k         56 
32768         32k          0          56 
65536         64k          0          56 
131072        128k        128k         56 
24           236k        232k       4248 
40            36k         33k        576 
48            12k       8496         192 
56          4096        2016          64 
72            12k       8136         168 
80          4096         480          56 
88          1448k       1429k         19k
96            12k         10k        168 
112         4096        1568          56 
120         8192        5040         112 
184           16k         14k        224 
160         4096         960          56 
168           36k         35k        504 
152           56k         51k        784 
104         4096         416          56 
352          516k        486k       7224 
136         4096         408          56 
Total       4640k       4424k         63k

String pool
entries     16631
identifiers 16631 (100.00%)
slots       32768
deleted     0
bytes       252k (17592186044415M overhead)
table size  256k
coll/search 0.4904
ins/search  0.0345
avg. entry  15.55 bytes (+/- 9.75)
longest entry   66

??? tree nodes created

(No per-node statistics)
Type hash: size 1021, 27 elements, 0.140351 collisions
DECL_DEBUG_EXPR  hash: size 1021, 0 elements, 0.000000 collisions
DECL_VALUE_EXPR  hash: size 1021, 0 elements, 0.000000 collisions
no search statistics
decl_specializations: size 61, 0 elements, 0.000000 collisions
type_specializations: size 61, 0 elements, 0.000000 collisions
No gimple statistics

Alias oracle query stats:
  refs_may_alias_p: 0 disambiguations, 0 queries
  ref_maybe_used_by_call_p: 0 disambiguations, 0 queries
  call_may_clobber_ref_p: 0 disambiguations, 0 queries

PTA query stats:
  pt_solution_includes: 0 disambiguations, 0 queries
  pt_solutions_intersect: 0 disambiguations, 0 queries 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T10:30:25.473

输出显示编译期间使用的内存。GCC/G++ 根据需要以各种大小的块分配内存。

以第一个条目为例：

```
Size   Allocated        Used    Overhead
8             40k         38k       1200 
```

这表明 40K 的内存以 8 字节块的形式分配，其中 40K，38K 被编译器使用，1200 字节是“会计开销”。Malloc(3) 并不总是准确地返回你所要求的，通常有几个字节表示这个块有多大，各种会计数据（谁拥有这个块），如果需要对齐，可能会有也未使用的字节。

基本上，这些信息只是会计记录。

接近结尾的哈希表显示了哈希例程是如何工作的，以允许 GCC/G++ 在其表中查找内容、发生了多少冲突（相同的哈希值）、需要处理的内容等等。

我确实喜欢“字符串池”中的“字节”条目：

```
bytes       252k (17592186044415M overhead) 
```

存储字符串需要多少内存？我的天啊！！那就是兆字节。{Grin} 可能是个错误。可能不会...你有多少内存？

总的来说，GCC/G++ 在你的编译过程中使用了 1.7GB，因为那是可用的，同时考虑一下，你是否使用了多重/并行编译？（-j 开关），这将增加使用量，因为并行程序不相互交谈。用 512M 的可用 RAM 编译同样需要更长的时间，因为 GCC/G++ 必须更频繁地停止和清理以保持足够的可用 RAM。

如果您想了解它在较小的内存限制下如何反应，请查看**ulimit**命令，尤其是*d*、*v*、*m*和*l*限制。请记住也使用*-S*（软限制）开关，否则您必须关闭终端/控制台/控制台才能重新获得无限限制。（听起来像是那里的营销计划）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T13:34:49.920

fmem-report 在 gcc 源代码的 common.opt 文件中定义。您可以使用 ctags 和 cscope 来获取设置 fmem-report 标志的实际文件，然后您需要查看检查此标志的代码。如果你不明白，让我知道我会找到的

# makefile - 与 Makefile 混淆

> ID：11378718
> 
> 赞同：2
> 
> 时间：2012-07-07T21:19:43.283
> 
> 标签：makefile

我正在尝试了解makefile，主要是为了了解我正在使用的makefile，但是却被一些可能很简单的东西所迷惑。我的 makefile 中让我感到困惑的部分如下所示：

```
SUBS = dir1 dir2 dir3

depend clean:
         @-X=`pwd`;\
         for i in $(SUBS);\
         cd $$X/$$i;\
         done 
```

"@-X=`pwd`是做什么的？我认为它以某种方式将当前目录的值分配给 X，但我不知道如何阅读 "@-" 语法。

另外，为什么 X & i 需要在前面加上 '$$' 而不仅仅是 '$'？我已经通过实验验证了两个 $ 都是必需的，但我认为只需要一个就可以将每个 $ 替换为它们的值

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:30:21.880

> 我不知道如何阅读“@-”语法。

只需从左到右阅读 :-) 开个玩笑，行首的“@”告诉 make 在执行之前不要回显该行；“-”告诉它忽略错误

> X & i 需要在前面加上'$$' 而不是'$'？

因为 make 本身有通过 $ 访问的变量，但是在这种情况下规则使用 shell 变量，这些变量也可以通过 $ 访问。$$ 只是一个转义，因此执行的 shell 命令包含 $X，而不是可能为空的 makefile 变量 X 的内容。

# iphone - ABMultiValueCopyLabelAtIndex 中的 CFStringRef 无效

> ID：11378723
> 
> 赞同：1
> 
> 时间：2012-07-07T21:20:28.083
> 
> 标签：iphone, objective-c, addressbook, cfstring

我正在从通讯录中获取电话号码。我是这样做的：

```
ABMultiValueRef arrTelefonos = ABRecordCopyValue(contacto,kABPersonPhoneProperty);
for(int i=0;i<ABMultiValueGetCount(arrTelefonos);i++) {
   CFStringRef labelTelefono = ABMultiValueCopyLabelAtIndex(arrTelefonos,i);
   CFStringRef numeroTelefono = ABMultiValueCopyValueAtIndex(arrTelefonos,i);
   CFStringRef labelTelefonoLoc = ABAddressBookCopyLocalizedLabel(labelTelefono);
   /* Do some stuff */
} 
```

一切都很好，除了在一种情况下：如果有一个带有特殊字符标签的电话的联系人（在我的情况下，标签是：带有“é”的“Teléfono”我在做的时候得到一个“无效的 CFStringRef”

```
CFStringRef labelTelefono = ABMultiValueCopyLabelAtIndex(arrTelefonos,i); 
```

由于 CFStringRef 不允许特殊字符，是否存在问题？如果这是问题，有人知道解决方案吗？

先感谢您

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-06-09T13:58:08.960

```
NSMutableArray *phoneNumbers = [[NSMutableArray alloc] init];

        ABMultiValueRef multiPhones = ABRecordCopyValue(person, kABPersonPhoneProperty);
        for(CFIndex i=0;i<ABMultiValueGetCount(multiPhones);i++) {

            CFStringRef phoneNumberRef = ABMultiValueCopyValueAtIndex(multiPhones, i);
            NSString *phoneNumber = (__bridge NSString *) phoneNumberRef;
            [phoneNumbers addObject:phoneNumber];

            //NSLog(@"All numbers %@", phoneNumbers);

        } 
```

# java - 无法在 JNI 项目中加载 .so

> ID：11378725
> 
> 赞同：3
> 
> 时间：2012-07-07T21:20:48.300
> 
> 标签：java, java-native-interface

我已经阅读了许多类似的问题，但仍然对这个项目感到困惑。我正在 Ubuntu 11.04 64 位上使用 Eclipse 尝试一个非常简单的 JNI 项目。

我已经正确构建了我的 .so 文件。我知道这一点，因为当我从 Java 程序中使用 System.load("/exact/path/to/my/libcproject.so") 时，我可以调用它。但是当我尝试使用 System.loadLibrary("libcproject") 我得到一个不满意的链接错误。

这是我的简单Java程序：

```
package pkg;
public class MyClass {
static {
    System.out.println("java.library.path: " + System.getProperty("java.library.path"));
    System.loadLibrary("libcproject");
}
private native String foo(String input);
public static void main(String[] args) {
    MyClass mc = new MyClass();
    String output = mc.foo("input");
    System.out.println(output);
}
} 
```

如您所见，我正在打印 java.library.path 是什么。当我运行程序时，我得到：

```
java.library.path: /usr/lib/jvm/java-6-sun-1.6.0.26/jre/lib/amd64/server:/usr/lib/jvm/java-6-sun-1.6.0.26/jre/lib/amd64:/usr/lib/jvm/java-6-sun-1.6.0.26/jre/../lib/amd64:/home/mlevin/workspace/cproject/Debug:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
input 
```

“输入”是我的 C 函数返回的内容（它只是把你给它的东西还给你）。

如果我将 System.load 调用更改为 System.loadLibrary("libcproject")，我会收到 unsatisfied link 错误，即使从输出 /home/mlevin/workspace/cproject/Debug 中可以看出，这是在哪里libcproject.so 存在，位于 java.library.path 中。

```
java.library.path: /usr/lib/jvm/java-6-sun-1.6.0.26/jre/lib/amd64/server:/usr/lib/jvm/java-6-sun-1.6.0.26/jre/lib/amd64:/usr/lib/jvm/java-6-sun-1.6.0.26/jre/../lib/amd64:/home/mlevin/workspace/cproject/Debug:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
Exception in thread "main" java.lang.UnsatisfiedLinkError: no libcproject in java.library.path
at java.lang.ClassLoader.loadLibrary(ClassLoader.java:1738)
at java.lang.Runtime.loadLibrary0(Runtime.java:823)
at java.lang.System.loadLibrary(System.java:1028)
at pkg.MyClass.<clinit>(MyClass.java:7)
Could not find the main class: pkg.MyClass.  Program will exit. 
```

在这一点上我很困惑。有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T21:40:43.220

删除`lib`前缀，如下所示：

```
System.loadLibrary("cproject"); 
```

Java 会`lib`在开头和`.so`结尾自动添加（无论如何，对于类 Unix 操作系统。在 Windows 上它会添加`.dll`到末尾）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T09:11:57.287

.export LD_LIBRARY_PATH =.，从而设置库路径为当前目录，Java文件查找so。

# ruby - Facebook自动登录需要在Rails 3上加载双页面

> ID：11378726
> 
> 赞同：0
> 
> 时间：2012-07-07T21:20:52.310
> 
> 标签：ruby, facebook, ruby-on-rails-3, facebook-graph-api, facebooker2

登录 Facebook 并验证应用程序后，带有 Facebooker2 的 Rails 3 站点需要重新加载 2 次页面，直到它自动登录到 Facebook。

如何使被动登录在首页加载时起作用？

红宝石 1.9.3p125，导轨 3.2.3，facebooker2 0.0.16

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T23:33:09.840

如果您使用 Javascript SDK，则需要重新加载。要跳过页面重新加载，您需要使用服务器端身份验证流程。

[https://developers.facebook.com/docs/authentication/server-side/](https://developers.facebook.com/docs/authentication/server-side/)

# ios - 如何在 Xcode 中访问 DCIM

> ID：11378728
> 
> 赞同：0
> 
> 时间：2012-07-07T21:21:22.440
> 
> 标签：ios, xcode, camera, cck, copying

我的想法：在没有 wifi 或蓝牙的情况下同步音乐。首先我得到我想要的文件，然后我将它们压缩成一个 zip 文件。然后我想重命名扩展名JPG，以便iPad可以识别该文件。然后我将它复制到我的 SD 卡，然后使用相机连接套件将它连接到我的 iPad。

我希望我的应用程序复制整个 jpg 形式的 dcim，以便我可以将文件扩展名更改回 zip，然后将其解压缩以停用我的文件。

但到目前为止，我只找到了一种复制图片的方法，而不是整个文件。我需要整个文件，我希望你们能帮助我。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:40:31.083

您可以像这样使用`NSFileManager`'s`copyItemAtPath`方法：

```
NSError *error;
[[NSFileManager defaultManager] copyItemAtPath:sourceFile toPath:destFile error:&error]; 
```

`sourceFile`jpg 文件的完整路径在哪里，并且`destFile`是 zip 文件的完整路径。

# java - 如何从另一个 JPanel/JFrame/等添加 String JList 元素？

> ID：11378735
> 
> 赞同：1
> 
> 时间：2012-07-07T21:22:13.860
> 
> 标签：java, swing, concurrency, jlist, swingworker

我知道如何将元素实际添加到 JList 本身，但我不确定如何在实际发生更新时更新我的​​事件日志（它使用 JList 和 DefaultListModel）。好像我的应用程序冻结了，然后在它结束时显示所有条目。请帮忙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:23:35.100

我 100% 确定您遇到了 Swing 并发问题，您将 Swing 事件调度线程或 EDT 与长时间运行的进程捆绑在一起。问题是 Swing 偶数线程负责执行所有 Swing 绘图和用户交互。如果它与一些长时间运行的进程（例如文件或数据库输入或输出）捆绑在一起，那么它就无法履行其职责，整个 GUI 就会冻结。*解决方案是使用诸如 SwingWorker 之类的后台线程，这样长时间运行的进程就不会占用 EDT，而是注意在*EDT 上更新诸如 JList 或其模型之类的 Swing 组件。

请查看[Swing 并发教程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)以获取有关该问题及其解决方案的更多详细信息。

# ruby - 返回不打破红宝石？

> ID：11378742
> 
> 赞同：3
> 
> 时间：2012-07-07T21:23:25.843
> 
> 标签：ruby

对 ruby​​ 来说还是相当新的，并且编写了这个非常简单的递归函数。

```
 def test(input)
    if input != 0
        test(input-1)
    end
    if input == 0
        return true
    end
  end
  puts test(5) 
```

根据我的 Java 知识，我知道这应该返回 true，但事实并非如此。似乎 return 语句实际上并没有脱离方法。我该如何解决？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T21:27:35.127

如果您仔细观察，您会发现该方法确实返回了，但它只是将堆栈展开一层并继续在调用者中执行代码。

问题是您忘记了退货：

```
def test(input)
    if input != 0
        return test(input-1)
    end
    if input == 0
        return true
    end
end
puts test(5) 
```

使用此修复程序，结果如预期：

```
true 
```

在线查看它：[ideone](http://ideone.com/CngE4)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T22:14:13.297

请注意，可能会被视为稍微更 Ruby-ish 的版本是`return`完全省略 s 并使用`elsif`：

```
def test(input)
    if input != 0
        test(input - 1)
    elsif input == 0
        true
    end
end 
```

# javascript - HTML5 跨域 XmlHttpRequest 与旧 XmlHttpRequests

> ID：11378751
> 
> 赞同：4
> 
> 时间：2012-07-07T21:25:31.307
> 
> 标签：javascript, xml, html, xmlhttprequest

我已经感觉到很多关于使用新的 HTML5 JS XHR 技术的简单跨域 XmlHttpRequest 方法的讨论。鉴于下面的标准 JavaScript XHR 代码...

```
 var xhr=new XMLHttpRequest();
  xhr.open("GET",url,false);
  xhr.send();
  var output=xhr.responseXML; 
```

...提供相同输出的等效 HTML5 XHR 启用跨域的代码是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:54:23.010

与 JS 的观点没有什么不同。跨域授权由浏览器在 HTTP 级别使用[CORS](https://developer.mozilla.org/en/http_access_control)处理，因此您的服务器必须支持跨域协商。

# objective-c - managedObjectContext 保存不立即插入？

> ID：11378753
> 
> 赞同：0
> 
> 时间：2012-07-07T21:25:39.257
> 
> 标签：objective-c, ios, xcode, nsmanagedobjectcontext

我有这个委托方法：

```
- (void)didFinishCreatingTrip:(Trip *)trip
{
    NSLog(@"before");
    NSError* error = nil;
    if (![self.database.managedObjectContext save:&error]) {
        NSLog(@"%@", error);
    }
    NSLog(@"after");
} 
```

调用此方法时，INSERT SQL 查询不会立即发生，而是在大约 10 秒后发生（根据控制台日志）。这是预期的吗？我能做些什么让它立即发生？问题是当我过早杀死 iPhone 模拟器时，我的数据会丢失。

日志：

```
2012-07-07 23:29:41.702 tripmoney[57542:fb03] before
2012-07-07 23:29:41.703 tripmoney[57542:fb03] after
2012-07-07 23:29:54.948 tripmoney[57542:11407] CoreData: sql: BEGIN EXCLUSIVE
2012-07-07 23:29:54.949 tripmoney[57542:11407] CoreData: sql: SELECT Z_MAX FROM Z_PRIMARYKEY WHERE Z_ENT = ?
2012-07-07 23:29:54.950 tripmoney[57542:11407] CoreData: sql: UPDATE Z_PRIMARYKEY SET Z_MAX = ? WHERE Z_ENT = ? AND Z_MAX = ?
2012-07-07 23:29:54.951 tripmoney[57542:11407] CoreData: sql: COMMIT
2012-07-07 23:29:54.953 tripmoney[57542:11407] CoreData: sql: BEGIN EXCLUSIVE
2012-07-07 23:29:54.954 tripmoney[57542:11407] CoreData: sql: INSERT INTO ZTRIP(Z_PK, Z_ENT, Z_OPT, ZNAME) VALUES(?, ?, ?, ?)
2012-07-07 23:29:54.955 tripmoney[57542:11407] CoreData: sql: COMMIT
2012-07-07 23:29:54.956 tripmoney[57542:11407] CoreData: sql: pragma page_count
2012-07-07 23:29:54.957 tripmoney[57542:11407] CoreData: annotation: sql execution time: 0.0006s
2012-07-07 23:29:54.957 tripmoney[57542:11407] CoreData: sql: pragma freelist_count
2012-07-07 23:29:54.958 tripmoney[57542:11407] CoreData: annotation: sql execution time: 0.0006s 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:47:43.327

CoreData 通过保留一些对象的内存缓存来工作。它决定保留哪些内容有点神秘，但我认为它可能会将您最近访问的内容保留在内存中，因此下次需要时不必将其放入磁盘。这就是内存中的副本返回正确值的原因。我理解您的担忧，但我从未在许多核心数据应用程序中被此困扰。如果您真的很担心，请添加一个`save`并`applicationDidEnterBackground`保持活力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-11T03:31:46.980

使用 UIManagedDocument 时，只需保存即可：

```
[document saveToURL:document.fileURL forSaveOperation:UIDocumentSaveForOverwriting completionHandler:NULL]; 
```

# sed - 使用 sed 替换双引号字符之间的斜杠

> ID：11378754
> 
> 赞同：1
> 
> 时间：2012-07-07T21:25:46.307
> 
> 标签：sed

在 HTML 文件中，我试图将`/`出现在一对双引号之间的斜杠`"`替换为`%20`. 例如，而不是这一行：

```
<a href="i/love/unix">i/am/happy!</a> 
```

我想得到：

```
<a href="i%20love%20unix">i/am/happy!</a> 
```

我正在尝试使用这样的`sed`命令：

```
sed -e 's/\(^.*href=\"\).*\(\".*\)/\1@@@\2/g' 
```

但不是'@@@'，而是我尝试使用另一个`sed`命令来`/`替换`%20`：

```
's/\//%20/g' 
```

是否可以将这两个`sed`命令组合在一起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T22:35:50.480

这可能对您有用（GNU sed）：

```
echo '<a href="i/love/unix">i/am/happy!</a>' |
sed 's/"[^"]*"/\n&/g;h;s/[^"\n]*\(\n"[^"]*"\)[^"\n]*/\1/g;s/\//%20/g;H;g;:a;s/\n"[^"]*"\(.*\n\)\n\("[^"]*"\)/\2\1/;ta;s/\n//'
<a href="i%20love%20unix">i/am/happy!</a> 
```

解释：

*   `s/"[^"]*"/\n&/g``\n`在每个预期的字符串之前全局插入 a`"..."`
*   `h`在保留空间 (HS) 中制作副本
*   `s/[^"\n]*\(\n"[^"]*"\)[^"\n]*/\1/g`删除其他所有内容
*   `s/\//%20/g``/`用's替换' `%20`s
*   `H`将修改后的替换附加到原始行
*   `g`用 HS 覆盖模式空间。
*   `:a;s/\n"[^"]*"\(.*\n\)\n\("[^"]*"\)/\2\1/;ta`一次一个地用新的替换旧的
*   `s/\n//`删除使用时`\n`引入的`H`

尝试插入`l0`上述解决方案以查看模式空间中的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T23:43:17.443

只是为了品种，这里有一个解决方案`awk`。您可以将它们全部放在一行上：

```
bash$ echo '<a href="i/love/unix">i/am/happy!</a>' |
   awk -v FS='"' -v OFS='"' '{ for (i=2; i<NF; i+=2) { gsub("/", "%20", $i); } print }'
<a href="i%20love%20unix">i/am/happy</a> 
```

我认为它在多行上更具可读性：

```
bash$ echo '<a href="i/love/unix">i/am/happy!</a>' | awk -F \" -v OFS=\" '{
>   for (i=2; i<NF; i+=2) {
>      gsub("/", "%20", $i)
>   }
>   print
> }'
<a href="i%20love%20unix">i/am/happy</a> 
```

# android - 如何删除上下文菜单上的选定行？

> ID：11378755
> 
> 赞同：1
> 
> 时间：2012-07-07T21:25:48.670
> 
> 标签：android, sqlite, android-contextmenu

当我从上下文菜单中选择删除菜单项时，我想删除一个 sqlite 数据库记录。我创建了一个上下文菜单并且它正在工作，但我无法删除数据库行。有什么办法可以删除记录吗？我该怎么办？

```
public void deleteItem(dbItem item) {
    SQLiteDatabase db = this.getWritableDatabase();

    db.delete(TABLE_ITEMS, items_id + " = ?",
        new String[] { String.valueOf(item.getID()) });
    db.close();
}

public boolean onContextItemSelected(MenuItem item) {
    AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo)item.getMenuInfo();

    int menuitemindex = item.getItemId();

    if(item.getItemId()==0)
    {
        //code for send text
    } 
    else if(item.getItemId()==1) // Delete menu item
    {
       //  db.deleteItem(item2);
    }
    return super.onContextItemSelected(item);    
 } 
```

如何在上下文菜单部分使用我的**deleteItem()过程？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T14:40:28.473

12天后我找到了解决方案:)

```
public boolean onContextItemSelected(MenuItem item) {
    AdapterView.AdapterContextMenuInfo info = (AdapterView.AdapterContextMenuInfo)item.getMenuInfo();

    int menuitemindex = item.getItemId();

    if(menuitemindex == 0)
    {
        //code for send text
    } 
    else if(menuitemindex == 1)
    {           
        dbItem silinen = adapter.getItem(info.position);      
        adapter.remove(silinen);            
        adapter.notifyDataSetChanged();
        db.deleteItem(silinen, getApplicationContext());        
    }
    return super.onContextItemSelected(item);    
 } 
```

并删除程序：

```
public void deleteItem(dbItem item, Context context) {
    SQLiteDatabase db = this.getWritableDatabase();

    try {

      db.delete(TABLE_ITEMS, items_id + " = ?",
              new String[] { String.valueOf(item.getID())});

    } catch (Exception e) 
    {
      Log.e("insert",e.getMessage());
    }

    Toast.makeText(context, "Item succesfully deleted. Name: "+ item.getName(), Toast.LENGTH_LONG).show();

    db.close();        

} 
```

# ios - UITableViewController 不调用 viewWillAppear、viewDidAppear 等

> ID：11378759
> 
> 赞同：0
> 
> 时间：2012-07-07T21:26:32.580
> 
> 标签：ios, cocoa-touch, uinavigationcontroller, uitabbarcontroller, uitableview

我在 UITabBarController 中有一组五个 UINavigationController。问题是只有一些 UINavigationControllers 有 viewWillAppear: 在它们各自的 UITableViewControllers 中调用。

我目前的设置是：（一切都是以编程方式创建的）

```
 |
                tabBarController
              (UITabBarController)
                        |
        ---------------------------------------- ...etc...
        |                              |
tempNavController               tempNavController      <--- Secondary NavContr
(UINavigationController)      (UINavigationController)      Not subclassed
        |                              |
scheduleViewController        currentViewController
(UITableViewController)       (UITableViewController)
        |                              |
        ...more UITableViewControllers... 
```

只有一些 UITableViewController 调用 viewWillAppear 和 viewDidAppear，而那些调用它的 UITableViewController 并没有为视图出现的每种方式调用它。有些仅在我推送到视图时调用它，有些仅在我弹出到视图时调用，有些仅在我将选项卡切换到视图时调用。

什么会导致问题只出现在一些 UITableViewControllers 而不是全部？为什么视图只能以某些方式出现？所有选项卡和表格都以相同的方式设置。

编辑：这是我用来设置标签的代码：

```
- (void)viewDidLoad
{
    //Setup of two of the tabs
    //Create navigation controller and root view for each tab
    //Current Comps
    CurrentCompsViewController *tempCurrentCompsViewController = [[CurrentCompsViewController alloc] init];
    [tempCurrentCompsViewController setAProgram:self.currentProgram];
    self.currentCompsviewcontroller = [[UINavigationController alloc] initWithRootViewController:tempCurrentCompsViewController];

    //Comp List
    CompetitionListViewController *tempCompListViewController = [[CompetitionListViewController alloc] init];
    [tempCompListViewController setAProgram:self.currentProgram];
    self.competitionListViewController = [[UINavigationController alloc] initWithRootViewController:tempCompListViewController];

     //Create and add tabBarItems
    UITabBarItem *compListITem = [[UITabBarItem alloc] initWithTitle:@"Competitions" image:[UIImage imageNamed:@"CompsIcon.png"] tag:6];
    [self.competitionListViewController setTabBarItem:compListITem];

    UITabBarItem *curentItem = [[UITabBarItem alloc] initWithTitle:@"Current Comps." image:[UIImage imageNamed:@"CurrentIcon.png"] tag:7];
    [self.currentCompsviewcontroller setTabBarItem:curentItem];

    //Add everything to tab array, and sort tabs... etc...
} 
```

我不会覆盖与在选项卡视图中选择项目有关的任何事情，也不会在每个选项卡的根目录中对导航控制器进行子类化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T02:24:54.267

结果我忘了在 viewWillAppear:、viewDidLoad 和 viewDidAppear: 中调用“[super viewWillAppear:animated]”。尽可能回电给超级班。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T00:28:50.333

尝试为每个 UINavigationController 手动设置委托？

前任：

```
tempNavController.delegate = self; 
```

# extjs - 过滤网格中的记录 - 使用代码

> ID：11378760
> 
> 赞同：0
> 
> 时间：2012-07-07T21:26:50.090
> 
> 标签：extjs, extjs4, extjs4.1

我有一个有 50 条记录的网格。一旦网格被填充，我希望它在加载到特定表单时过滤记录。例如; 一旦加载，它应该显示所有 10 岁的学生。

这必须编码；我浏览了这个`grid-filter-local.js`例子，它展示了如何清除过滤器选项，而不是通过代码设置过滤器选项。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:48:11.230

类似的东西？

```
var st = Ext.getStore('MyStore');

st.clearFilter();
st.on('load', function() {
   st.filter({
       filterFn: function(rec) { return rec.get('age') > 10; }
   });
}, this, { single: true }); 
```

# php - 如何通过 PHP 查找所有 URL？

> ID：11378763
> 
> 赞同：-2
> 
> 时间：2012-07-07T21:27:05.713
> 
> 标签：php, search, search-engine, web-scraping

我想知道是否有一些代码或库可以获取域下的所有 url。我需要找到一个域的所有 url。

例如，如果我的域是[https://stackoverflow.com/](https://stackoverflow.com/)并且我想查找所有问题的 url，如下所示：

1.  [[将 CSV 转换为 XML 文件的 Java 库或应用程序？](https://stackoverflow.com/questions/123/how-can-i])
2.  [ [https://stackoverflow.com/questions/456/what-c​​an-i]](https://stackoverflow.com/questions/456/what-can-i])
3.  [ [https://stackoverflow.com/questions/789/where-can-i]](https://stackoverflow.com/questions/789/where-can-i])

我不知道该域下有多少问题，但我必须创建一个引擎来搜索所有 url，然后在找到需要将内容插入数据库的 url 之后。

我将为我的 5 个网页创建一个小型搜索引擎。

有人可以帮忙吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:38:07.277

[Lucene 搜索](http://en.wikipedia.org/wiki/Lucene)使您可以轻松地为您的页面编制索引，从而可以高效、准确地搜索它们。

有关Lucene 搜索的 PHP 实现，请参见[Zend_Search_Lucene 。](http://framework.zend.com/manual/en/zend.search.lucene.html)

您仍然需要爬取您的网站并构建索引，这是另一个问题。您可以使用[Teleport Pro](http://www.tenmax.com/teleport/pro/home.htm)之类的软件来抓取您的站点并为您提供 URL 列表，然后您可以将这些 URL 提供给 PHP 脚本，该脚本获取所有页面的内容并将它们提供给 Zend_Search_Lucene 以构建索引。您也可以用 PHP 编写爬虫或使用现有的解决方案。搜索`php crawler`会产生很多东西，包括这个有用的[php crawler](http://phpcrawl.cuab.de/)。

# css - div背景半透明，不是内容？

> ID：11378765
> 
> 赞同：1
> 
> 时间：2012-07-07T21:27:34.543
> 
> 标签：css, html

我正在尝试制作一个具有半透明背景但内容完全不透明的 div。这是我所拥有的：

```
#mydiv { 
 color: #FFFFFF;
 width: 900px;
 height: 140px;
 border: 0px;
 border-radius: 15px;
 background: #000000;
 opacity: .2;
 margin: 0px 0px 10px 0px;
 padding: 10px;
} 
```

有没有办法用 CSS 做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T21:32:02.600

尝试使用这个：

```
background-color: rgba(255, 0, 0, 0.2); 
```

[这里](http://www.w3.org/TR/css3-color/#rgba-color)有更多关于`rgba()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T21:32:59.433

使用 CSS3 颜色属性`rgba`。

```
background-color:rgba(0,255,0,0.5); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:31:36.403

所有子级最多将具有与其父级相同的透明度。这意味着如果您的 div 的不透明度为 0.2，则其子项的不透明度为 1 将等于 0.2。

```
div1 opacity = 0.2
  div2 opacity = 1
    div3opacity = 0.5 
```

意义 ：

```
div1 --> real opacity = 0.2 == 0.2
div2 --> real opacity = 0.2 * 1 == 0.2
div3 --> real opacity = 0.2 * 1 * 0.5 == 0.1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T21:44:07.340

```
#mydiv { 
 color: #FFFFFF;
 width: 900px;
 height: 140px;
 border: 0px;
 border-radius: 15px;
 background: rgba(0,0,0,0.1);
 opacity: .2;
 margin: 0px 0px 10px 0px;
 padding: 10px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-22T16:45:19.027

这样做的一个技巧（除了 CSS3 rgba 规则）是创建一个只有 10% 不透明度的纯色 png。将其用作`background-image`下面的示例图像

X ![在此处输入图像描述](../Images/20830e1a420a4a6f233bd50b8da8b7da.png)X

（上面是 10% 白色的 png）

# enums - IAR Embedded Workbench 观察窗口

> ID：11378771
> 
> 赞同：0
> 
> 时间：2012-07-07T21:28:21.827
> 
> 标签：enums, watch, iar

在 IAR Embedded Workbench 中，监视窗口显示几列（表达式、值、位置、类型）。我想将给定表达式的值视为枚举而不是实际值。意义...

```
ucFruit  APPLE 
```

相对于...

```
ucFruit  0x02 
```

这似乎是可能的，因为我可以`ucFruit`通过简单地键入 APPLE 作为其值来更改 的值。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T15:08:09.667

如果您在监视窗口中右键单击变量名称并从显示的列表中选择“默认格式”选项，则会显示枚举而不是数值。如果选择“十进制”或其他数字格式，则会显示数值。

这就是它在我的 EW430 上的工作方式。

# javascript - 使用 Canvas 和 HTML5 创建类似 Flash 的动画

> ID：11378774
> 
> 赞同：14
> 
> 时间：2012-07-07T21:28:58.590
> 
> 标签：javascript, html, animation, canvas

这是一个“我可以从哪里开始”类型的问题。

我正在学习 HTML5 和 Canvas 的工作，但感觉我找错地方了。

我想学习如何创建卡通类型的类似 Flash 的响应式动画。想象一下这只泰迪熊： ![泰迪熊图片](../Images/3b5f04708263d57e15a8ea2c896f8b59.png)

当我将鼠标指向它时，我想通过实现我的“移动脚”动画等让他在屏幕上行走。点击时，我希望他挥动他的爪子。

使用 HTML5 和 Javascript，我可以让他移动/漂浮，但我找不到实际动画动画的方法。

我要创建小的 .mp4 文件吗？我是否创建一堆图像来循环它们？动画 GIF？我当然想远离闪光灯......

我认为带有 Canvas 动画的 HTML5 可以让我实现我想要的，但除了绘制简单的形状动画和视频作品之外，我似乎找不到教程或“如何”文章。

我怎样才能实现我正在尝试做的事情，或者我需要寻找其他地方吗？我会很感激被指出正确的方向。

编辑：我在研究时遇到了以下游戏：[http](http://www.cuttherope.ie/) ://www.cuttherope.ie/ 例如，怪物是如何以这样的方式动画的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T03:51:38.510

帆布在这里会很好。

动画通常仅通过循环浏览不同的 PNG 文件（或具有不同图像的 spritemap）来完成。这是我不久前做[的一个 jsfiddle 示例，它在画布上显示了一个简单的动画：](http://jsfiddle.net/Jrjyq/72)

```
var canvas = document.getElementById('canvas');
var context = canvas.getContext('2d');

var image = new Image();

var drawTile = function(x, y, tile, width, height) {
    context.drawImage(image, (tile % 6) * width, Math.floor(tile / 6) * height, width, height, x, y, width, height);
};

image.onload = function() {
    // draw all 12 tiles:
    var i = 0;
    setInterval(function() {
        context.clearRect(0,0,500,500);
        drawTile(0, 0, i, 48, 32);
        i++;
        if (i > 11) i = 0;
    }, 85);
}
image.src = 'http://i.stack.imgur.com/qkWe2.png'; 
```

如果您查看示例中的图像，您会了解动画的精灵图是什么样子的：

![在此处输入图像描述](../Images/97700f0f3ae0551f1670af3fc8fe91bc.png)

骑自行车认为这种基于计时器的图像中的精灵就足够了！

* * *

在画布上制作和移动可点击、可选择的对象需要一些步骤。画布上没有任何内置对象检测功能。但是，如果您以前做过编程，这并不太难，而且我已经写了一篇[关于这件事的流行教程](http://simonsarris.com/blog/510-making-html5-canvas-useful)，作为一个非常温和的介绍。它应该可以帮助你。

除此之外，您最好的资源当然是 Stack Overflow。:) 当您遇到个别问题时，我们总是很乐意回答这些问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T00:08:27.623

如果练习的目的是学习 HTML5 和画布，那么以下内容可能不适合您。如果您需要尽可能快速轻松地创建您的泰迪动画，并使用基于标准的技术交付它，那么我建议您下载并探索[Adob​​e Edge](http://labs.adobe.com/technologies/edge/)的预览版。它是一种类似于 Flash（时间线和关键帧）的动作和交互设计工具，它输出 HTML、CSS 和 JavaScript 的组合。我还没有玩过预览版，但我很确定它能够制作你所说的那种动画。

**更新：**

您可能还想考虑[Zoë](http://gskinner.com/blog/archives/2011/02/zoe-export-swf-animation-as-easeljs-spritesheets.html)，它可用于将 SWF 动画直接导出到精灵表。它是由开发`Canvas`图书馆[画架.js](http://www.createjs.com/#!/EaselJS)的团队创建的，可以将随附的帧数据导出为 JSON 或画架.js。它将允许您在 Flash 中创建动画（让我们面对现实，它仍然是最好的网络动画工具），但使用 HTML 渲染它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T23:03:57.047

对于动画，[three.js](http://mrdoob.github.com/three.js/)很好。它甚至还有一些[物理引擎插件](http://chandlerprall.github.com/Physijs/)。

另外，看看[HTML5 游戏开发的部分内容](http://www.html5gamedevelopment.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-08T00:59:50.733

在我看来，有两个问题需要解决：

1.  让熊在自身内部运动（至少腿）
2.  在屏幕上移动熊

解决这两个问题会让你看起来像熊在屏幕上行走（而不是仅仅在屏幕上移动或原地行走）。听起来您已经解决了问题 #1。

要解决 #2，最好的办法是每帧都有一个图像。尝试在每一帧中将熊画在不同的位置是浪费时间。如果您预加载帧图像，您可以在开始时收取一次费用，并且您只是在他走路时显示不同的图像。

现在，这是帆布的工作吗？我不知道。我认为您可能可以构建我在“老派”HTML/JavaScript/CSS 中描述的内容。该平台由您决定——但框架——更具体地说，每个框架的图像——是这里的关键概念。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-07T23:01:32.207

我会很快接受一个更有根据的答案，但我猜你想要做的可能对于浏览器中的 canvas/javascript 性能来说有点太多了。

如果您是一名动画师，这似乎不是一项繁琐的任务，但我想您会编写大量代码来为复杂的路径设置动画并填充它们等等......

我确定您已经研究过，但是那里有许多 JavaScript 画布库。想到[Paper js或者](http://paperjs.org/)[处理 js](http://processingjs.org/)。如果您查看他们关于路径和动画的示例/功能，他们可能会为您指明一个不错的方向。

# wordpress - Wordpress 自定义帖子类型的类别刚刚停止工作

> ID：11378775
> 
> 赞同：-2
> 
> 时间：2012-07-07T21:29:07.147
> 
> 标签：wordpress, categories, custom-post-type

我们没有更改任何内容，出于某种原因，wordpress 将不再保留新帖子或更新帖子的类别设置。

我们创建了一个自定义帖子类型：“会员”，并为该类型创建了自定义分类：“业务类型”

我们有大约 200 个该类型的帖子，今天添加一个新帖子时，我会选择它所属的类别，单击发布，然后它会从选择中删除这些类别。

我们已经尝试注销、重新登录、更新 wordpress，并尝试了多个帖子。

有任何想法吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T19:00:57.543

它随机重新开始工作，没有任何变化..

# ios - 如何从 UITableViewCell (iOS5) 中删除披露 V 形？

> ID：11378776
> 
> 赞同：0
> 
> 时间：2012-07-07T21:29:08.847
> 
> 标签：ios, uitableview, tableview

根据用户输入，我需要从我的表格视图的一个单元格中删除披露 V 形。在控制器的`viewDidAppear`方法中，我有以下代码：

```
NSIndexPath *section0Row10 = [NSIndexPath indexPathForRow:10 inSection:0];
[[self.tableView cellForRowAtIndexPath:section0Row10] setAccessoryType:UITableViewCellAccessoryNone]; 
```

什么都没发生。我会很感激知道我做错了什么。

更新：

这些是单个部分中的静态分组单元。`UILabel`我使用情节提要构建了表格视图，并通过控制从表格视图拖动到视图控制器的头文件中，将我需要以编程方式更改的每个字段（通常是 s）设置为命名的 outlets。

例如，我有：

```
@property (weak, nonatomic) IBOutlet UILabel *symbolLabel; 
```

在我的视图控制器的 .h 文件中。在 .m 文件中，我在`viewDidAppear`方法中包含以下行：

```
self.symbolLabel.text = self.dataSource.symbol; 
```

这样一来，我就完全不需要实现`cellForRowAtIndexPath:`了。这是不正确的做事方式吗？

另外：当表格视图出现时，我要删除其 V 形的单元格位于屏幕底部下方。

感谢您的所有帮助和耐心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:23:10.493

当您的单元格未显示在屏幕上时，`cellForRowAtIndexPath`返回`nil`。这是合乎逻辑的：重用单元格以节省内存，因此不必显示的单元格只需重新排队，以便它们属于当前可见的索引路径。

为了解决这个问题，不要从外部显式设置单元格的显示样式，而是将其设置在

```
tableView:cellForRowAtIndexPath: 
```

方法。您可以将附件类型的数值或基于的条件存储在 NSArray 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:39:13.813

重新加载表。或者更好，只是那个细胞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-08T12:56:08.040

代替

```
{
NSIndexPath *section0Row10 = [NSIndexPath indexPathForRow:10 inSection:0];
[[self.tableView cellForRowAtIndexPath:section0Row10] setAccessoryType:UITableViewCellAccessoryNone];`
} 
```

和，

```
NSIndexPath *section0Row10 = [NSIndexPath indexPathForRow:10 inSection:0];
[[self tableView:self.tableView cellForRowAtIndexPath:section0Row10] setAccessoryType:UITableViewCellAccessoryNone]; 
```

你没有调用你的实现`CellForRowAtIndexPath:`......这就是问题所在:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T21:41:19.453

尝试重新加载单元格：

```
[self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:section0Row10] withAnimation:UITableViewRowAnimationAutomatic]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T22:22:18.510

我相信您需要调用@max_ 提到的重新加载功能

```
[self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObject:section0Row10] withAnimation:UITableViewRowAnimationAutomatic]; 
```

但是当您调用它时，它将使用您的`cellForRowAtIndexPath`方法来获取要加载的新单元格。因此，您需要确保从该方法返回的单元格，对于您在 reload 方法中指定的索引路径，没有`accessoryView`.

也许在你的 cellForRowAtIndexPath 方法中设置一个断点，看看触发重新加载后会发生什么。

# c# - 在富文本框中选择一段文本

> ID：11378779
> 
> 赞同：0
> 
> 时间：2012-07-07T21:29:15.000
> 
> 标签：c#, winforms, richtextbox

您好，我试图在 c# 的富文本框中选择一段文本

例如：

富文本框中的文本是“Hello my friends !!”

我想从“我的”中选择文本到结尾，如下所示：

```
string myText="my friends !! "; 
```

如何？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:42:29.187

SelectionStart 和 SelectionLength 是这里需要的属性
并且可以使用 string.IndexOf 找到初始位置

```
int pos = richTextBox.Text.IndexOf("my");
if(pos != -1)
{
    richTextBox.SelectionStart = pos;
    richTextBox.SelectionLength = richTextBox.Text.Length - pos;
    richTextBox.Focus();
} 
```

将选定的文本返回到您编写的字符串 var 中：

```
string myText = richTextBox.SelectedText; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:03:55.267

SendKeys 的另一种方式

```
int linePosition = richTextBox1.Text.IndexOf("my");
richTextBox1.SelectionStart = linePosition;
richTextBox1.Focus();
SendKeys.Send("{HOME}+{END}");
SendKeys.Flush(); 
```

# jsp - 如何使用动态重定向服务在 Win7 Pro 上服务 JSP 和 servlet

> ID：11378780
> 
> 赞同：0
> 
> 时间：2012-07-07T21:29:26.843
> 
> 标签：jsp, web-applications, iis-7, webserver, tomcat7

我在为一个包含 3 个 jsp 页面且不超过 3 个 servlet 的小型 Java Web 应用程序提供服务时遇到问题。请原谅我缺乏知识，我会将我所拥有的所有信息都提供给您（如果我没有列出，请询问）。我将 Apache Tomcat 7.0.22 作为服务运行。这是一个 Win 7 Pro x64 盒子。我在 No-Ip.com 上有一个动态重定向服务，它将直接流量到端口 8080（可以更改为我需要的任何内容）。

我不知道从哪里开始。我可以使用 IIS7 还是需要更简单的 Apache HTTP Server……这只是一个小站点？我需要 isapi_redirect.dll 吗？如何配置它以服务于我的网站？任何和所有的帮助将不胜感激。我对托管您自己的小型网站所需的知识水平感到相当沮丧。

仍然无法正常工作...也许我们可以检查一下我的本地设置。解决后我会发布所有答案。

# r - 如何使用一个数据帧中的值重新编码另一个数据帧中的值？

> ID：11378787
> 
> 赞同：0
> 
> 时间：2012-07-07T21:31:07.963
> 
> 标签：r, variables

我有一个名为的文件`traffic`，如下所示：

```
city statenum casenum vnumber pnumber county accdate accday accmin accmon acctime
-1       6      23       1       1     47 1082010      8     50      1     150
0        6      25       1       1     73 1042010      4      0      1    2200
0        6     652       1       4     71 3282010     28      1      3    1901
1        6    1289       1       2     71 7152010     15     40      7    2140
4        6    1289       1       3     71 7152010     15     40      7    2140
1        6    1289       1       4     71 7152010     15     40      7    2140 
```

以及一组单独的文件，告诉我每列中的数字代码指的是什么。例如，我有一个名为的文件`city`，如下所示：

```
Code     Definition
-1       Blank
0        NA
1        ACAMPO
2        ACTON
3        ADELANTO
4        ADIN 
```

如何使用`city`文件中的代码替换 中的编码值`traffic`？输出将如下所示：

```
city statenum casenum vnumber pnumber county accdate accday accmin accmon acctime
Blank     6      23       1       1     47 1082010      8     50      1     150
NA        6      25       1       1     73 1042010      4      0      1    2200
NA        6     652       1       4     71 3282010     28      1      3    1901
ACAMPO    6    1289       1       2     71 7152010     15     40      7    2140
ADIN      6    1289       1       3     71 7152010     15     40      7    2140
ACAMPO    6    1289       1       4     71 7152010     15     40      7    2140 
```

我使用 recode 看到的所有解决方案或同样涉及明确说明哪个值对应于`cars`包示例中的哪个值：`recode(x, "c(1,2)='A'; else='B'")`相反，我想做的是让字符串`city$Definition` 替换`traffic$city`if `city$Code`matches中的数字代码`traffic$city`。

我可以做`traffic<-merge(traffic, city, by.x = "city", by.y = "Code")`and `traffic$city<-traffic$Definition`then `traffic$Definition<-NULL`，但看起来这将是一个足够常见的操作，因此会有一个方便的功能来执行此操作。

一个解决方案的奖励点，它允许我指定多个列被多个文件中的值替换，而不会重复自己太多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:38:33.440

这也许是你想要的

```
traffic<-read.table(header=T,text="city statenum casenum vnumber pnumber county accdate accday accmin accmon acctime
-1       6      23       1       1     47 1082010      8     50      1     150
0        6      25       1       1     73 1042010      4      0      1    2200
0        6     652       1       4     71 3282010     28      1      3    1901
1        6    1289       1       2     71 7152010     15     40      7    2140
4        6    1289       1       3     71 7152010     15     40      7    2140
1        6    1289       1       4     71 7152010     15     40      7    2140")

city<-read.table(header=T,text="Code     Definition
-1       Blank
0        NA
1        ACAMPO
2        ACTON
3        ADELANTO
4        ADIN")

traffic$city<-city$Definition[match(traffic$city,city$Code)] 
```

但我可能误解了你的意思

或者更有趣

```
library(sqldf)
sqldf("SELECT c.Definition,t.statenum,t.casenum,t.vnumber,t.pnumber,t.county,t.accdate,t.accday,t.accmin,t.accmon from traffic t, city c where t.city=c.Code") 
```

我会提倡 sqldf 和 SQL 类型 SELECTS 可能会回答您的最后一部分。但是，我无法评论它如何处理大型数据帧。

编辑：我想在`SELECT c.Definition as city.....`这里，但它会引发错误

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T06:23:15.780

也许最简单的方法是重命名查找表中的列，以便合并操作“起作用”：

```
names(city) <- c("city", "City Name")
merge(traffic, city)

  city statenum casenum vnumber pnumber county accdate
1   -1        6      23       1       1     47 1082010
2    0        6      25       1       1     73 1042010
3    0        6     652       1       4     71 3282010
4    1        6    1289       1       2     71 7152010
5    1        6    1289       1       4     71 7152010
6    4        6    1289       1       3     71 7152010
  accday accmin accmon acctime City Name
1      8     50      1     150     Blank
2      4      0      1    2200      <NA>
3     28      1      3    1901      <NA>
4     15     40      7    2140    ACAMPO
5     15     40      7    2140    ACAMPO
6     15     40      7    2140      ADIN 
```

* * *

由于这是关系数据库中期望的结构，因此如果您希望使用`sqldf`or ，这应该很容易`data.table`。

# iphone - iPhone UITextField撇号问题

> ID：11378788
> 
> 赞同：1
> 
> 时间：2012-07-07T21:31:10.620
> 
> 标签：iphone, nsstring, uitextfield

我的 UITextfield 中的帖子有问题。任何时候有一个撇号的单词，它都会添加一个反斜杠。

所以我的测试帖子在 NSLog 中说“我认为以 \'s 结尾的单词可能有问题”

它应该是：“我认为以 's 结尾的单词可能有问题”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:36:47.103

听起来像是转义——在某个地方，您的数据正在被转义。问题不在于 UITextField，而在于代码的其他部分。检查正在发送到该字段的字符串，您会发现它已在那里转义。从那里跟踪您的代码。

# java - 我应该创建一个新类来制作代码的 gui 吗？

> ID：11378794
> 
> 赞同：1
> 
> 时间：2012-07-07T21:32:02.300
> 
> 标签：java, user-interface

```
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;
import javax.swing.JOptionPane;

public class Test {
    private static ArrayList<Countries> arr = new ArrayList<Countries>();
    private static ArrayList<Countries> d = new ArrayList<Countries>();
    static String country;
    static String capital;
    static String cities;
    static String cevap;
    static int score =0;

    public static void main(String args[]) throws IOException{
        Scanner keybord = new Scanner(System.in);
        arr = new ArrayList<Countries>();
        d = read("data.txt");

         for(int i = 0; i < d.size(); i++){
             System.out.print( d.get(i).toString());
             cevap = keybord.nextLine();
             if(cevap.equalsIgnoreCase(d.get(i).getCapital())){
                 System.out.println ("The answer is true!\nYou win 10 points");
             score += 10;
             }
             else{
                 System.out.println("The answer is not true" + " The answer is " + d.get(i).getCapital() + "\nYou loose 10 points");
                 score -= 10;
             }
             System.out.println("You're score is: " + score);
             System.out.println();
         }
    }

    public static ArrayList<Countries> read(String filename) throws IOException{
        Scanner scan = new Scanner(new File(filename));
        while(scan.hasNext()){
            country = scan.nextLine(); //System.out.println(country);
            String cities1 = scan.nextLine(); //System.out.println(cities1);
            String cities2 = scan.nextLine(); //System.out.println(cities2);
            String cities3 = scan.nextLine(); //System.out.println(cities3);
            String cities4 = scan.nextLine(); //System.out.println(cities4);
            String capital = scan.nextLine(); //System.out.println(capital);
            Countries c = new Countries(country, cities1, cities2, cities3, cities4, capital); 
            arr.add(c);
            scan.nextLine();
        }
        return arr;
    }

} 
```

为了制作这个程序的 GUI，我应该改变主要部分，如下所示。因为我认为从我读取的数据中读取和初始化变量会更方便。或者我应该为 Gui 创建另一个类？

```
public static void main(String args[]) throws IOException{
        Scanner keybord = new Scanner(System.in);
        arr = new ArrayList<Countries>();
        d = read("data.txt");

         for(int i = 0; i < d.size(); i++){
             lcountry = new JLabel(d.get(i).getCity1());
             label1 = new JLabel(d.get(i).getCity1());
             label2 = new JLabel(d.get(i).getCity2());
             label3 = new JLabel(d.get(i).getCity3());
             label4 = new JLabel(d.get(i).getCity4()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:34:26.483

不，我建议将所有 UI 内容封装在一个单独的类中。如果你把它放在一个主要的方法中，它的可用性就会大大降低。

事实上，这适用于所有课程。main 方法应该非常小，并且只做一些实际工作的类的实例。如果主要是大，你做错了。

无论您使用文本还是图形 UI，您的问题都应该可用。当您可以将文本 UI 换成图形 UI 并且一切仍然有效时，您可以说您已经很好地封装了一些东西。这称为封装和分层。如果你不能轻松地交换 UI，那你就错了。

# http - Post Redirect Get - POST 如何永远不会重新提交？

> ID：11378799
> 
> 赞同：1
> 
> 时间：2012-07-07T21:32:53.027
> 
> 标签：http, http-post, http-get

有很多关于 Post Redirect Get 模式的有趣文章，例如这里：[http ://www.theserverside.com/news/1365146/Redirect-After-Post](http://www.theserverside.com/news/1365146/Redirect-After-Post)

但这里有一个简单的问题......

如果用户执行 POST 并被重定向到 GET。很好，如果他们点击刷新浏览器只是发送 GET，很容易理解。但是，如果在 GET 之后点击 BACK 按钮然后点击刷新，他们肯定可以再次点击 POST 吗？是的？

我试图了解我们如何能 100% 确定 POST 永远不会被重新提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:42:35.757

确保不重新提交 POST 的一种方法是使用与该发布会话关联的唯一标识符，例如，如果它是购物车，则当他们开始结账时，为该进程生成唯一 ID。结帐完成后（例如已发送 POST），从可使用的 ID 中删除该 ID。

您还可以通过使用表单生成唯一键来执行此操作，如果提交了表单，请从存储它的位置删除该键。

```
<input type="hidden" name="key" value="<?php echo generateUniqueKey(); ?>" /> 
```

其中 generateUniqueKey() 函数将查询表并插入唯一 ID，然后返回 ID。在您处理表单的页面上，执行以下操作：

```
<?php 
    $key = $_POST['key'];
    if (isKeyStillValid ($key)) {
        markKeyAsInvalid ($key);
        // Process form ...
    }
    else {
        die ("You have already submitted this form".);
    }
?> 
```

isKeyStillValid() 函数将检查数据库以确保与表单一起使用的密钥仍然是可用的密钥，而 markKeyAsInvalid() 函数将从数据库中删除该密钥。

**更新：** 这是我刚刚制作的一个示例，其中涉及我之前描述的内容。这是一个很简单的例子，只是简单地使用了一个 SQL 表中的自增 ID 作为 key，但作为一个例子应该足够了。实际上，你会想要比这更深思熟虑的东西。 [http://alexloney.com/post/](http://alexloney.com/post/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:36:02.180

> 但是，如果在 GET 之后点击 BACK 按钮然后点击刷新，他们肯定可以再次点击 POST 吗？是的？

是的。

当用户使用后退按钮时，可能会发生这种情况 - 该模式不能防止这种情况发生，只是防止结果出现在与原始表单**相同**的页面中，其中刷新 (F5) 会导致重新发布。

> 我们如何能 100% 确定 POST 永远不会被重新提交？

一种方法是根据最后 X 分钟内提交的所有值检查发布的值，丢弃重复项（有丢失故意重复项的风险）。

# javascript - Jquery鼠标悬停在孩子身上触发

> ID：11378802
> 
> 赞同：1
> 
> 时间：2012-07-07T21:33:57.777
> 
> 标签：javascript, jquery, mouseevent, mouseover

我已经阅读了堆栈上关于类似主题的每一篇文章，其中有很多，但似乎没有一个可以为我解决这个问题。

基本上，我有一个 ul 包含单个图像的 div，在悬停时我触发淡入淡出到 50% 的不透明度。这没有问题。现在对于其中一个 div，我有第二张图片，绝对位于 div 的中心。当我悬停说 div 时，鼠标悬停被触发，但是当指针通过第二个图像上方时，它会重新触发事件。

请在下面找到代码

jQuery

```
jQuery('.lighter').mouseover(function() {
    jQuery(this).fadeTo(200, 0.5);
});
jQuery('.lighter').mouseout(function() {
    jQuery(this).fadeTo(200, 1);
}); 
```

html

```
<ul class="home-three-columns">
    <li>
        <a href="#">
            <div class="lighter">
                <img class="first" src="<?php echo $this->getSkinUrl('images/gift-finder.jpg') ?>" alt="" />
            </div>
        </a> 
    </li>
    <li style="position:relative;">
        <a href="#">
            <div class="lighter">
                <img class="mid" src="<?php echo $this->getSkinUrl('images/product-of-the-month.jpg') ?>" alt="" />
                <img class="prod-week" src="<?php echo (string)Mage::helper('catalog/image')->init($product, 'image')->resize(68, 86);?>" style="position:absolute; top:99px; left:89px;" />
            </div>
        </a>
    </li>
    <li>
        <a href="#">
            <div class="lighter">
                <img class="last" src="<?php echo $this->getSkinUrl('images/in-the-press.jpg') ?>" alt="" />
            </div>
        </a>
    </li>
</ul> 
```

正如您所看到的，一旦指针超过.prod-week，这是导致问题的第二个 li，基于我已经尝试使用的搜索

```
jQuery('.lighter').not('.prod-week').mouseover(function() {
        jQuery(this).fadeTo(200, 0.5);
    }); 
```

等，没有效果。

如果有人可以提供见解或指出我遗漏的明显错误，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T22:06:18.930

您需要使用[`.mouseenter()`](http://api.jquery.com/mouseenter)和[`.mouseleave()`](http://api.jquery.com/mouseleave)。

```
$('.lighter').mouseenter(function() {
  $(this).fadeTo(200, 0.5);
});
$('.lighter').mouseleave(function() {
  $(this).fadeTo(200, 1);
});​ 
```

或者，[`.hover()`](http://api.jquery.com/hover/)简称。

```
$('.lighter').hover(function(){
  $(this).fadeTo(200, 0.5);
}, function(){
  $(this).fadeTo(200, 1);
});​ 
```

您使用的实际解决方案`.stop()`仅使其不明显，但如果您记录该功能的触发，那么您会看到它保持不变。

[一个例子](http://jsfiddle.net/UzWmY/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:50:34.523

似乎以某种方式在动画中添加一个停止解决了这个问题。

```
jQuery('.lighter').mouseover(function() {
    jQuery(this).stop().fadeTo(200, 0.5);
});
jQuery('.lighter').mouseout(function() {
    jQuery(this).stop().fadeTo(200, 1);
}); 
```

不太确定如何解决它，如果有人想发表评论！

# php - 使用 composer 安装 propel

> ID：11378803
> 
> 赞同：5
> 
> 时间：2012-07-07T21:34:04.787
> 
> 标签：php, propel, composer-php

我正在尝试将推进器与作曲家一起使用，但出现错误。

我的 composer.json 是：

```
{
    "require": {
        "propel/propel" : "*"
    }
} 
```

错误是：

```
 Problem 1
    - The requested package propel/propel * could not be found. 
```

有谁知道我错过了什么？我正在谷歌搜索，但我不明白。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-07T22:27:19.780

您是在尝试使用推进 1.x 还是推进 2？

试试这个推进1：

```
{
    "require": {
        "propel/propel1": "1.6.*"
    }
} 
```

对于推进 2，我认为这可以工作：

```
{
    "require": {
        "propel/propel": "dev-master"
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-07T14:32:06.607

```
{
    "require": {
        "propel/propel": "~2.0@dev"
    }
} 
```

这是我们实际使用的。

# jquery - jquery在jquery中重写搜索

> ID：11378806
> 
> 赞同：1
> 
> 时间：2012-07-07T21:34:23.047
> 
> 标签：jquery, function, select, html, each

如何制作这种格式：

```
$('a[href*=wikipedia.org/][rel]').each(function()

But with a div instead of a href
    $('#block_profile[rel]').each(function () { 
```

任何人都可以展示如何并澄清原因？问题是我自定义的第二行代码对每个 block_profile 执行一个操作，一个页面上有 10 个，如果我单击第 10 个，则该操作执行 10 次，如果我单击第 8 个 block_profile，则该操作被触发 8 次，什么解决此问题的解决方案？谢谢！

​ 我的 HTML 是这样的：

```
<div rel="2" id="block_profile" class="block_profile">
  ...
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:51:12.180

首先你必须使用`class`而不是`id`，因为`id`应该是唯一的并且`class`可以用于一个组并且选择全部并且`divs`你可以使用`class='block_profile'``rel`

```
$('div.block_profile[rel]') 
```

[**演示。**](http://jsfiddle.net/qbWkp/3/)（见控制台）

# c# - 带有实体框架的 Azure SQL 中的文化特定排序顺序

> ID：11378809
> 
> 赞同：1
> 
> 时间：2012-07-07T21:34:37.057
> 
> 标签：c#, entity-framework, azure-sql-database

我正在尝试根据用户文化对查询进行排序，但我找不到如何做到这一点！它是如何完成的？

目前，始终根据瑞典文化 (se-SV) 进行排序就足够了，但我的猜测是，也可以为每个连接或每个查询设置它。

我从 EDMX 模型生成数据库，并且如果可能的话还想指定默认的数据库文化，但主要是我想为每个连接设置它。

谢谢！/胜利者

# r - 'forecast' 包版本 3.22 Auto.arima 在 R 中预测，超过一个季节性周期

> ID：11378812
> 
> 赞同：0
> 
> 时间：2012-07-07T21:35:16.550
> 
> 标签：r, prediction, forecasting

我使用 ARIMA 的季节性周期为“周”，有 672 个测量值，如下所示：

```
day_freq<-96
Week_freq<-day_freq*7 #672
## Weekly seasonality
NEW.xx<-ts(x,start=1,freq=672)
F.Xreg <- fourier(NEW.xx,24)
fit <-auto.arima(NEW.xx, D=0, max.P=0, max.Q=0, xreg=F.Xreg)
##new xreg fourierf
FForecast<-fourierf(NEW.xx,24,3000)
forecast(fit, h=3000, xreg=FForecast, level=0) 
```

如何将这两个季节性结合起来，并在同一时间将每日季节性“96”与一周季节性一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T00:28:08.157

首先，ARIMA 模型不能很好地处理大的季节性周期。其次，R 不允许 ARIMA 模型中有多个季节性周期。我建议您使用`tbats()`处理长季节性周期和多季节性的预测包中的函数。

# php - $errors[] 没有返回

> ID：11378816
> 
> 赞同：0
> 
> 时间：2012-07-07T21:35:54.833
> 
> 标签：php, error-handling, return

我正在为我的网站构建一个 PHP 登录和注册系统。如果表单字段为空，则编码要求使用 $errors[] 并用于检查输入用户名是否存在于数据库中。即使我没有输入任何信息，我也没有收到任何错误。

**登录.php**

```
<?php
include 'cic/initalize.php';

if (user_exists('cassey') === true) {
    echo 'exists';
}
die();

if (empty($_POST) === false) {
    $username = $_POST['username'];
    $password = $_POST['password'];

    if (empty($username) === true || empty($password) === true) {
        $errors[] = 'Please provide your username and password.';
    } else if (user_exists($username) === false) {
        $errors[] = 'We can\'t find the username entered, please enter a valid 
        username or register to continue';
        }
}
?> 
```

**clients.php（用户）**

```
<?php
function user_exists($username) {
    $username = sanitize($username);
    return (mysql_result(mysql_query("SELECT userId FROM clients WHERE 
    username = '$username'"), 0) === 1) ? true : false; 
}
?> 
```

**调用 login.php 的代码**

```
 <div class="widget">
      <h2>Login | Register</h2>
 </div><!--End widget class tag-->
 <div class="inside">
    <form action="login.php" method="post">
       <ul id="logIn">
          <li>
            Username:<br/>
            <input type="text" name="username"/>
          </li>
          <li>
            Password:<br/>
            <input type="password" name="password"/>
          </li>
          <li>
            <input type="submit" value="Login"/>
          </li>
          <li>
            <a href="register.php">Register</a>
          </li>
       </ul>
    </form>
 </div><!--End inside class tag--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:46:39.777

**登录.php**：

```
<?php
ini_set('display_errors', 1);
error_reporting(E_ALL);
include 'cic/initalize.php';

if (user_exists('cassey') === true)
    echo 'exists';
else
    die "User does not exist!";

if (isset($_POST['your_submit_button']) && isset($_POST['username']) && isset($_POST['password']))
{
    $username = $_POST['username'];
    $password = $_POST['password'];

    if (strlen($username)==0  || strlen($password)==0)
    {
        $errors[] = 'Please provide your username and password.';
    }
    elseif(user_exists($username) === false)
    {
        $errors[] = 'We can\'t find the username entered, please enter a valid 
        username or register to continue';
    }
}
else
{
    echo "Error: at least one field wasn't set in the form !<br>";
    print_r($_POST);
}
?> 
```

文档：
[isset](http://php.net/isset)
[empty](http://php.net/empty)
[ini_set](http://php.net/ini_set)
[error_reporting](http://php.net/error_reporting)
[print_r](http://php.net/print_r)

替换`your_submit_button`为 HTML 表单中提交按钮的真实名称。
使用`empty()`不是一个好主意，因为字符串“0”被认为是空的。您需要检查的是字符串是否至少包含一个字符（长度不等于零）。

# asp.net-mvc - 简单地理定位功能的选项？

> ID：11378818
> 
> 赞同：1
> 
> 时间：2012-07-07T21:36:04.393
> 
> 标签：asp.net-mvc, geolocation

我需要向分类广告应用程序添加位置功能。基本上，

*   用户必须按城市和州搜索分类
*   结果应包括附近的城市和州（例如 50 英里内的结果）

如果有的话，我对我可以使用的 API 一无所知。任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T22:00:31.620

查看[NGeo](https://github.com/danludwig/NGeo)。

免责声明：我是 NGeo 的作者。

Nuget 包也[可在此处获得](https://preview.nuget.org/packages/NGeo)。

# xml - XSLT 空格分隔并添加一个元素

> ID：11378821
> 
> 赞同：1
> 
> 时间：2012-07-07T21:36:20.587
> 
> 标签：xml, xslt, xslt-1.0, xslt-2.0

我在 xml 和 xslt 中有一个查询

以下是输入 XML

```
<?xml version="1.0" encoding="UTF-8"?>    
<Employer>
    <Employees>
        <EmployeesDetails>van ind 26%</EmployeesDetails>
    </Employees>    
    <Employees>
        <EmployeesDetails>van ind</EmployeesDetails>
    </Employees>    
</Employer> 
```

以上是我的输入文件

以下是我的输出文件

```
<?xml version="1.0" encoding="UTF-8"?>
<Employer>
    <Employees>
        <Names>van</Names>
        <Location>ind</Location>                
        <Weather>26</Weather>
    </Employees>
    <Employees>
        <Names>van</Names>
        <Location>ind</Location>
        <Weather>100</Weather>
    </Employees>
</Employer> 
```

如何将以下 XSLT 应用于上述 XML 输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:14:12.857

**一、本次 XSLT 2.0 改造：**

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 exclude-result-prefixes="xs">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <Employer>
    <xsl:apply-templates/>
  </Employer>
 </xsl:template>

 <xsl:template match="Employees">
  <xsl:variable name="vNames" select="tokenize(Names, ' ')"/>
  <xsl:variable name="vLoc" select="tokenize(Location, ' ')"/>
  <xsl:variable name="vWeather"
       select="tokenize(translate(Weather, '%', ' '), ' ')"/>
  <xsl:for-each select="$vNames">
    <xsl:variable name="vPos" select="position()" as="xs:integer"/>
    <Employees>
      <Names><xsl:sequence select="."/></Names>
      <Location>
        <xsl:sequence select="(lower-case($vLoc[$vPos]), 'Unknown')[1]"/>
      </Location>
      <Weather>
        <xsl:sequence select="($vWeather[$vPos], 100)[1]"/>
      </Weather>
    </Employees>
    </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<Employer>
    <Employees>
        <Names>vel bel sel tel mel</Names>
        <Location>IND AUS ENG CAL JAP</Location>
        <Weather>26%</Weather>
    </Employees>
    <Employees>
        <Names>asd sadl asdsel tdddel dmdel</Names>
        <Location>IND AUS ENG CAL JAP</Location>
    </Employees>
</Employer> 
```

**产生想要的正确结果：**

```
<Employer>
   <Employees>
      <Names>vel</Names>
      <Location>ind</Location>
      <Weather>26</Weather>
   </Employees>
   <Employees>
      <Names>bel</Names>
      <Location>aus</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>sel</Names>
      <Location>eng</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>tel</Names>
      <Location>cal</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>mel</Names>
      <Location>jap</Location>
      <Weather>100</Weather>
   </Employees>
      <Employees>
      <Names>asd</Names>
      <Location>ind</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>sadl</Names>
      <Location>aus</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>asdsel</Names>
      <Location>eng</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>tdddel</Names>
      <Location>cal</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>dmdel</Names>
      <Location>jap</Location>
      <Weather>100</Weather>
   </Employees>
</Employer> 
```

**请注意**：

我做了以下合理的假设：

1.  你其实想要`100`，不是`100%`。

2.  您希望所有的都`Employees`被处理——不仅仅是这个元素的第一次出现。

我还为任何缺失的位置添加了一个默认值，以防提供的位置数量少于提供的名称数量。

* * *

**二、XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
 xmlns:my="my:my" exclude-result-prefixes="ext my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>
 <my:defaults>
  <L>Unknown</L>
  <W>100</W>
 </my:defaults>

 <xsl:variable name="vUpper" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/>
 <xsl:variable name="vLower" select="'abcdefghijklmnopqrstuvwxyz'"/>

 <xsl:variable name="vDefaults" select="document('')/*/my:defaults"/>

 <xsl:template match="/*">
  <Employer>
   <xsl:apply-templates/>
  </Employer>
 </xsl:template>

 <xsl:template match="Employees">
  <xsl:variable name="vrtfNames">
   <xsl:apply-templates select="Names"/>
  </xsl:variable>
  <xsl:variable name="vNames" select="ext:node-set($vrtfNames)/*"/>
  <xsl:variable name="vrtfLocs">
   <xsl:apply-templates select="Location"/>
  </xsl:variable>
  <xsl:variable name="vrtfWeather">
   <xsl:apply-templates select="Weather"/>
  </xsl:variable>

  <xsl:apply-templates select="$vNames">
   <xsl:with-param name="pLocs" select="ext:node-set($vrtfLocs)/*"/>
   <xsl:with-param name="pWeather" select="ext:node-set($vrtfWeather)/*"/>
  </xsl:apply-templates>
 </xsl:template>

 <xsl:template match="s" priority="3">
  <xsl:param name="pLocs"/>
  <xsl:param name="pWeather"/>

  <xsl:variable name="vPos" select="position()"/>
  <Employees>
   <Names><xsl:value-of select="."/></Names>
   <Location>
     <xsl:value-of select=
       "translate($pLocs[position() = $vPos]
                   | $vDefaults[not($pLocs[position() = $vPos])]/L,
                  $vUpper, $vLower)"/>
   </Location>
   <Weather>
     <xsl:value-of select=
       "$pWeather[position() = $vPos]
      | $vDefaults[not($pWeather[position() = $vPos])]/W"/>
   </Weather>
  </Employees>
 </xsl:template>

 <xsl:template match="Weather">
  <xsl:call-template name="tokenize">
    <xsl:with-param name="pText" select="translate(., '%', ' ')"/>
  </xsl:call-template>
 </xsl:template>

 <xsl:template match="Employees/*/text()" name="tokenize">
  <xsl:param name="pText" select="."/>

  <xsl:variable name="vText" select="normalize-space($pText)"/>
  <xsl:if test="$vText">
   <s>
    <xsl:value-of select="substring-before(concat($vText, ' '), ' ')"/>
   </s>

   <xsl:call-template name="tokenize">
    <xsl:with-param name="pText" select="substring-after($vText, ' ')"/>
   </xsl:call-template>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档（上图）时，同样会产生相同的正确结果**：

```
<Employer>
   <Employees>
      <Names>vel</Names>
      <Location>ind</Location>
      <Weather>26</Weather>
   </Employees>
   <Employees>
      <Names>bel</Names>
      <Location>aus</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>sel</Names>
      <Location>eng</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>tel</Names>
      <Location>cal</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>mel</Names>
      <Location>jap</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>asd</Names>
      <Location>ind</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>sadl</Names>
      <Location>aus</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>asdsel</Names>
      <Location>eng</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>tdddel</Names>
      <Location>cal</Location>
      <Weather>100</Weather>
   </Employees>
   <Employees>
      <Names>dmdel</Names>
      <Location>jap</Location>
      <Weather>100</Weather>
   </Employees>
</Employer> 
```

**请注意**：

1.  基本上实现了与 XSLT 2.0 转换中相同的逻辑。

2.  由于 XPath 1.0 没有 a `tokenize`or`lower-case()`函数并且在 XPath 1.0 数据模型中没有*序列*的概念，因此这些（分别）使用用于标记化的模板、使用`translate()`转换为小写的函数和使用元素来实现包含天气和位置的默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:45:23.093

您的问题在某些关键领域含糊不清。例如，您似乎声明如果一个`<Employees>`节点集*没有*`<weather>`节点，它应该得到一个值为 100%的节点；也就是说，您的预期输出似乎不一致地应用该逻辑。您想要的`<Location>`结果节点从大写转换为小写。此外，您的输出似乎完全忽略`<Employees>`了源 XML 中的第二个节点集。

做一些假设，这里是一个使用[EXSLT](http://www.exslt.org/)的 XSLT 1.0 解决方案。如果这不是您想要的，请更新您的问题以更具体，我会尽量适应。

**当这个 XSLT：**

```
<?xml version="1.0"?>
<xsl:stylesheet
  xmlns:exsl="http://exslt.org/common"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  exclude-result-prefixes="exsl" 
  version="1.0">

  <xsl:output omit-xml-declaration="no" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="Employees">
    <xsl:variable name="vNames">
      <xsl:call-template name="tokenize">
        <xsl:with-param name="text" select="Names/text()"/>
      </xsl:call-template>
    </xsl:variable>
    <xsl:variable name="vLocations">
      <xsl:call-template name="tokenize">
        <xsl:with-param name="text" select="Location/text()"/>
      </xsl:call-template>
    </xsl:variable>
    <xsl:apply-templates select="exsl:node-set($vNames)/token">
      <xsl:with-param name="pLocation"
          select="exsl:node-set($vLocations)/token"/>
      <xsl:with-param name="pWeather" select="Weather"/>
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="token">
    <xsl:param name="pLocation"/>
    <xsl:param name="pWeather"/>
    <xsl:variable name="vPosition" select="position()"/>
    <Employees>
      <Names>
        <xsl:value-of select="."/>
      </Names>
      <Location>
        <xsl:value-of select="translate($pLocation[$vPosition],
            'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')"/>
      </Location>
      <xsl:choose>
        <xsl:when test="$pWeather != ''">
          <xsl:apply-templates select="$pWeather"/>
        </xsl:when>
        <xsl:otherwise>
          <Weather>100%</Weather>
        </xsl:otherwise>
      </xsl:choose>
    </Employees>
  </xsl:template>

  <xsl:template name="tokenize">
    <xsl:param name="text"/>
    <xsl:param name="delimiter" select="' '"/>
    <xsl:choose>
      <xsl:when test="contains($text,$delimiter)">
        <xsl:element name="token">
          <xsl:value-of select="substring-before($text,$delimiter)"/>
        </xsl:element>
        <xsl:call-template name="tokenize">
          <xsl:with-param name="text"
              select="substring-after($text,$delimiter)"/>
          <xsl:with-param name="delimiter" select="$delimiter"/>
        </xsl:call-template>
      </xsl:when>
      <xsl:when test="$text">
        <xsl:element name="token">
          <xsl:value-of select="$text"/>
        </xsl:element>
      </xsl:when>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet> 
```

**...应用于此 XML：**

```
<?xml version="1.0"?>
<Employer>
  <Employees>
    <Names>vel bel sel tel mel</Names>
    <Location>IND AUS ENG CAL JAP</Location>
    <Weather>26%</Weather>
  </Employees>
  <Employees>
    <Names>asd sadl asdsel tdddel dmdel</Names>
    <Location>IND AUS ENG CAL JAP</Location>
  </Employees>
</Employer> 
```

**...产生所需的（？）结果：**

```
<?xml version="1.0" encoding="UTF-8"?>
<Employer>
  <Employees>
    <Names>vel</Names>
    <Location>ind</Location>
    <Weather>26%</Weather>
  </Employees>
  <Employees>
    <Names>bel</Names>
    <Location>aus</Location>
    <Weather>26%</Weather>
  </Employees>
  <Employees>
    <Names>sel</Names>
    <Location>eng</Location>
    <Weather>26%</Weather>
  </Employees>
  <Employees>
    <Names>tel</Names>
    <Location>cal</Location>
    <Weather>26%</Weather>
  </Employees>
  <Employees>
    <Names>mel</Names>
    <Location>jap</Location>
    <Weather>26%</Weather>
  </Employees>
  <Employees>
    <Names>asd</Names>
    <Location>ind</Location>
    <Weather>100%</Weather>
  </Employees>
  <Employees>
    <Names>sadl</Names>
    <Location>aus</Location>
    <Weather>100%</Weather>
  </Employees>
  <Employees>
    <Names>asdsel</Names>
    <Location>eng</Location>
    <Weather>100%</Weather>
  </Employees>
  <Employees>
    <Names>tdddel</Names>
    <Location>cal</Location>
    <Weather>100%</Weather>
  </Employees>
  <Employees>
    <Names>dmdel</Names>
    <Location>jap</Location>
    <Weather>100%</Weather>
  </Employees>
</Employer> 
```

**解释：**

1.  第一个模板 -[身份模板](http://web.archive.org/web/20090525135108/http://www.dpawson.co.uk/xsl/sect2/identity.html)- 按原样复制所有元素和属性。
2.  第二个模板，它匹配`<Employee>`元素，运行一个特殊`tokenize`的模板，它的工作是将你的空格分隔的字符串分割成结果树片段。为了方便起见，这些片段被保存到变量中。
3.  第三个模板匹配所有名为 的元素`token`。这些由 EXSLT 生成，它将结果树片段转换为由`<token>`元素组成的节点集。对于其中的每一个，我们提取必要的元素值来创建`<Names>`和`<Location>`。`<weather>`此模板还包含确定元素所需的值所需的逻辑。

# lua - 在 Lua 中获取前一天的日期

> ID：11378822
> 
> 赞同：3
> 
> 时间：2012-07-07T21:36:38.780
> 
> 标签：lua

谁能告诉我如何使用 Lua 以 'YYYY-MM-DD' 格式获取前一天的日期？

IE，一个片段，它将从它运行的那一天返回前一天的日期。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T21:42:35.337

尝试

`print(os.date("%Y-%m-%d",os.time()-24*60*60))`

严格来说，这只能保证在 POSIX 系统上工作，但它可能在大多数系统中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T21:49:48.953

有一个库 LuaDate 对日期操作非常有帮助 [http://luaforge.net/projects/date/](http://luaforge.net/projects/date/)

它非常易于使用，因为它有很好的文档记录！

# jquery - 为输入文本框设置样式，如 jQuery Redmond 主题

> ID：11378825
> 
> 赞同：0
> 
> 时间：2012-07-07T21:37:46.480
> 
> 标签：jquery, jquery-ui, textbox

我在我的网页中使用来自 jQuery-ui 团队的 Redmond 主题的 jQuery。**问题是输入文本框仍然没有被 Redmond 主题设置样式。**这创造了一个不太令人印象深刻的外观和感觉。有没有办法为输入文本框元素创建适当的样式，以便它们与 jQuery 中的 Redmond 主题融合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T17:58:57.157

正如我在评论中提到的，没有内置的方法可以实现这一点。您可以做的是获取主题中使用的一些颜色，然后将其应用于文本框以获得看起来相似的内容。

这是我根据日期选择器的外观和感觉制作的几个选项。

```
/* Option 1 */
​input[type=text] {
    background: #5C9CCC url(http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/redmond/images/ui-bg_gloss-wave_55_5c9ccc_500x100.png) 50% 50% repeat-x;
    border: 1px solid #4297D7;
    font-weight: bold;
    color: white;
    padding: 5px;
    border-radius: 5px;
}

/* Option 2 */
input[type=text] {
    background: #DFEFFC url(http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/redmond/images/ui-bg_glass_85_dfeffc_1x400.png) 50% 50% repeat-x;
    color: #2E6E9E;
    font-weight: bold;
    border: 1px solid #C5DBEC;
    padding: 5px;
    border-radius: 5px;
} 
```

**示例**- [http://jsfiddle.net/XjCjR/1](http://jsfiddle.net/XjCjR/1)

# java - 将内容从 XML 添加到 Java

> ID：11378829
> 
> 赞同：0
> 
> 时间：2012-07-07T21:38:06.873
> 
> 标签：java, android, xml

我一直在阅读本教程 -
[http://developer.android.com/training/basics/firstapp/building-ui.html](http://developer.android.com/training/basics/firstapp/building-ui.html)
我遇到了一个问题......在教程中，他们解释了 XML 元素（TextField 和 Button）和最后他们说如何调整程序以查看按钮+文本字段。
问题是，模拟器没有显示它们..只是一个黑屏。
我想这是因为我没有在 .java 主文件中添加任何内容，但在教程中没有提到任何内容。
我应该怎么办？**非常**
感谢所有愿意提供帮助的人！

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:42:11.327

如果您的 XML 文件名是`main.xml`显示它的内容，您需要此方法

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
} 
```**

# algorithm - 需要一个有效的选择算法？

> ID：11378831
> 
> 赞同：0
> 
> 时间：2012-07-07T21:38:25.140
> 
> 标签：algorithm, selection

我正在寻找一种算法来选择 A [N/4] 未排序数组 A 中的元素，其中 N 是数组 A 的元素数。我希望算法在次线性时间内进行选择。我有基本的知识BST等结构？哪一个对我来说是最好的算法，记住我希望它是最快的，并且对我来说实施起来不应该太难。这里 N 可以变化到 250000。任何帮助将不胜感激。注意数组可以有非独特的元素

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:14:25.060

正如@Jerry Coffin 提到的，除非您愿意预先进行一些预处理，否则您不能希望在这里获得次线性时间算法。如果你想要一个线性时间算法来解决这个问题，你可以使用[快速选择算法](http://en.wikipedia.org/wiki/Selection_algorithm#Partition-based_general_selection_algorithm)，它在预期的 O(n) 时间内运行，最坏的情况是 O(n ^(2 )。)中[位数算法](http://en.wikipedia.org/wiki/Selection_algorithm#Linear_general_selection_algorithm_-_Median_of_Medians_algorithm)具有最坏情况的 O(n) 行为，但具有较高的常数因子。您可能会发现一种有用的算法是[introselect](http://en.wikipedia.org/wiki/Selection_algorithm#Introselect)算法，它结合了前面的两种算法以获得具有低常数因子的最坏情况 O(n) 算法。该算法通常用于`std::nth_element`在 C++ 标准库中实现该算法。

如果您愿意提前进行一些预处理，您可以将所有元素放入一个[订单统计树](http://www.cs.cornell.edu/courses/cs211/2004su/slides/Topic20b.pdf)中。从那时起，您可以在 O(log n) 最坏情况下查找任何 k 的第 k 个元素。但是，所需的预处理时间为 O(n log n)，因此除非您进行重复查询，否则这不太可能是最佳选择。

希望这可以帮助！

# android - Android：声音播放错误。压缩问题？

> ID：11378836
> 
> 赞同：0
> 
> 时间：2012-07-07T21:38:41.333
> 
> 标签：android, audio, compression, media-player, logcat

我重写了我的声音类以捕获异常，以便在调用声音时它不再使应用程序崩溃。问题仍然是声音文件无法播放。它在模拟器上运行和播放。

在我用我的 HTC VIVID 测试之前没有错误。我觉得我的手机不是问题。

我的声音文件的文件结构是 Resources>raw>soundfiles.ogg

这是我用于声音类的代码。

```
public class Sound extends Activity
{
   MediaPlayer mp;
   Context context;
public Sound (Context res)
    {
           context=res;
    }

        public void playSound(int ID) 
        {
         try {
                mp = MediaPlayer.create(context, ID);
                mp.start();

                mp.setOnCompletionListener(new OnCompletionListener() {

                    @Override
                    public void onCompletion(MediaPlayer mp) {
                        mp.release();
                        mp = null;

                    }
                });
            } catch (Exception exception) {
            }   
        }   
} 
```

这是日志猫：

```
E/AndroidRuntime(  981): FATAL EXCEPTION: main
E/AndroidRuntime(  981): android.content.res.Resources$NotFoundException: File r
es/raw/soundfile.ogg from drawable resource ID #0x7f040000
E/AndroidRuntime(  981):        at android.content.res.Resources.openRawResource
Fd(Resources.java:1081)
E/AndroidRuntime(  981):        at android.media.MediaPlayer.create(MediaPlayer.
java:762)

E/AndroidRuntime(  981): Caused by: java.io.FileNotFoundException: This file can
 not be opened as a file descriptor; it is probably compressed 
```

如何解决此压缩问题？

这是设置的大致轮廓。我不认为这是问题的一部分。

```
final Context res;
    Sound fx;

 public GameView(Context context) //reference to activity 
    {
        super(context);
        res=context;
        fx=new Sound(res);

public boolean onTouchEvent(MotionEvent event)
{

            fx.playSound(R.raw.sound); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T23:04:22.563

声音文件以允许模拟器读取文件但手机无法正确访问的方式进行转换。用新的声音文件替换所有声音文件后，程序再次按预期运行:)

以下是一些帮助我为将来遇到此问题的人找出问题的方法：

[http://ponystyle.com/blog/2010/03/26/dealing-with-asset-compression-in-android-apps/](http://ponystyle.com/blog/2010/03/26/dealing-with-asset-compression-in-android-apps/) [http://code.google.com/p/android-apktool/issues/detail? id=153](http://code.google.com/p/android-apktool/issues/detail?id=153) [在 Content Provider 的帮助下打开资产文件时出现问题](https://stackoverflow.com/questions/3177026/problem-while-opening-asset-file-with-the-help-of-content-provider)

虽然其中一些没有解决我的问题，但它们使找到解决方案成为可能。

# java - 需要帮助才能记住使用 # 符号缩短 ANSI-C 代码的方法

> ID：11378851
> 
> 赞同：1
> 
> 时间：2012-07-07T21:41:16.887
> 
> 标签：java, c

当我在大学上 ANSI-C 的课程时，我学到了一种缩短大量重复代码的方法。基本上，它是在开头使用 # 符号的声明，您可以使用它来分配名称和它应该替换的代码。谁能帮我记住这个方法叫什么，可以用Java实现吗？我不知道如何在网上搜索这个，所以我想我会在这里寻求帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T21:42:32.887

您可能正在考虑[宏](http://www.cprogramming.com/tutorial/cpreprocessor.html)。

例如：

```
#define INCREMENT(x) x++ 
```

然而，宏在字面上被扩展为意义，除非它们被积极地括号括起来，否则它们会产生意想不到的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T21:42:48.870

在 C 中，您可以将预处理器与

```
#define 
```

允许您定义宏的指令

Java 没有宏之类的东西，但您可以使用函数和过程调用删除任何现代语言中的重复代码。

与 C 宏相比，函数调用（在 Java 中）的优势在于它们强制类型安全，这是值得高兴的。

# python - Python：如何防止范围内的长变量名

> ID：11378861
> 
> 赞同：2
> 
> 时间：2012-07-07T21:42:36.467
> 
> 标签：python, variables, scope

我有类似的东西：self.megacity.resourceloader.sound.mcintro.play()

有什么优雅的方法可以防止这样长的东西吗？也许是某种结构性变化？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:44:10.413

```
x = self.megacity.resourceloader.sound.mcintro
x.play() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T21:48:48.983

查阅得[墨忒耳定律](http://en.wikipedia.org/wiki/Law_of_Demeter)以帮助您找到更好的方法来放松程序中组件之间的耦合：

> 当应用于面向对象的程序时，得墨忒耳定律可以更准确地称为“函数/方法的得墨忒耳定律”（LoD-F）。在这种情况下，对象 A 可以请求对象实例 B 的服务（调用方法），但对象 A 不能“通过”对象 B 访问另一个对象 C 来请求其服务。这样做意味着对象 A 隐含地需要对对象 B 的内部结构有更多的了解。相反，如有必要，应修改 B 的接口，以便它可以直接服务对象 A 的请求，并将其传播到任何相关的子组件。或者，A 可能直接引用对象 C 并直接向该对象发出请求。如果遵循这个规律，那么只有对象 B 知道它自己的内部结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T22:59:27.997

使用[Facade 模式](https://en.wikipedia.org/wiki/Facade_pattern)，例如：

```
class SoundPlayer:
    def play_megacity(self):
        return self.megacity.resourceloader.sound.mcintro.play() 
```

# javascript - 通过actionscript（或Javascript）获取本地文件路径

> ID：11378863
> 
> 赞同：1
> 
> 时间：2012-07-07T21:42:39.990
> 
> 标签：javascript, actionscript-3, actionscript

我有一个场景，用户单击 flex 应用程序中的菜单项，该菜单项应该在他们的操作系统（现在是 Mac OSX）上为他们提供文件浏览器，然后一旦他们选择文件，我就会传递该文件的本地文件到应用程序的另一部分（已经编写）的路径，该部分使用它建立连接。

我做了一些研究，发现只有在包含我不喜欢的 AIR SDK 时才能使用的代码，有没有办法在 actionscript 或 javascript 中执行此操作（因为我可以从我的 actionscript 应用程序调用 javascript）？

编辑：我传递路径的服务需要完整的本地路径，这意味着浏览文件后，我必须获取本地路径才能传递它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:41:21.637

在不使用 AIR 的情况下，您仍然可以使用带有 Flex 或纯 ActionScript 项目的[FileReference类来生成用于上传本地文件的文件浏览对话框。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/FileReference.html)

这可以抽象为一个服务类。

**应用**

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark">

    <fx:Script>
        <![CDATA[
            protected function buttonClickHandler(event:MouseEvent):void
            {
                var uploadService:UploadService = new UploadService("http://destination.com");
                uploadService.browse();
            }
        ]]>
    </fx:Script>

    <s:Button label="Upload..."
              click="buttonClickHandler(event)" />

</s:Application> 
```

**上传服务**

```
package
{
    import flash.events.Event;
    import flash.events.EventDispatcher;
    import flash.events.IOErrorEvent;
    import flash.events.SecurityErrorEvent;
    import flash.net.FileFilter;
    import flash.net.FileReference;
    import flash.net.URLRequest;

    public class UploadService extends EventDispatcher
    {

        public var fileReference:FileReference;

        public var fileTypes:FileFilter;

        public var uri:String

        public function UploadService(uri:String)
        {
            this.uri = uri;
        }

        public function browse():void
        {
            fileTypes = new FileFilter("* (*.*)", "*.*;");
            var allTypes:Array = new Array(fileTypes);

            fileReference = new FileReference();

            fileReference.addEventListener(Event.SELECT, fileSelectHandler);
            fileReference.addEventListener(Event.OPEN, fileOpenHandler);
            fileReference.addEventListener(Event.COMPLETE, fileCompleteHandler);
            fileReference.addEventListener(SecurityErrorEvent.SECURITY_ERROR, fileSecurityErrorHandler);
            fileReference.addEventListener(IOErrorEvent.IO_ERROR, fileIoErrorHandler);

            fileReference.browse(allTypes);
        }

        protected function fileSelectHandler(event:Event):void
        {
            fileReference.upload(new URLRequest(uri));
        }

        protected function fileOpenHandler(event:Event):void
        {
            dispatchEvent(new Event(Event.OPEN));
        }

        protected function fileCompleteHandler(event:Event):void
        {
            fileReference.removeEventListener(Event.SELECT, fileSelectHandler);
            fileReference.removeEventListener(Event.OPEN, fileOpenHandler);
            fileReference.removeEventListener(Event.COMPLETE, fileCompleteHandler);
            fileReference.removeEventListener(SecurityErrorEvent.SECURITY_ERROR, fileSecurityErrorHandler);
            fileReference.removeEventListener(IOErrorEvent.IO_ERROR, fileIoErrorHandler);

            dispatchEvent(new Event(Event.COMPLETE));
        }

        protected function fileSecurityErrorHandler(event:SecurityErrorEvent):void
        {
            dispatchEvent(new SecurityErrorEvent(SecurityErrorEvent.SECURITY_ERROR));
        }

        protected function fileIoErrorHandler(event:IOErrorEvent):void
        {
            dispatchEvent(new IOErrorEvent(IOErrorEvent.IO_ERROR));
        }

    }
} 
```

# xcode4 - 使用 Xcode 4 设置 SFML 1.6

> ID：11378864
> 
> 赞同：0
> 
> 时间：2012-07-07T21:42:47.180
> 
> 标签：xcode4, sfml

在互联网上搜索有关使用 Xcode 4 设置 SFML 1.6 的指南后，我没有遇到任何问题。我知道您不能将 SFML 1.6 的模板与 xcode 4 一起使用。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T02:24:44.510

好的，我花了 5 天的时间来修复，但它奏效了：

*   遵循本指南中的所有内容：[http ://www.sfml-dev.org/tutorials/1.6/start-osx.php](http://www.sfml-dev.org/tutorials/1.6/start-osx.php)
    *   将 sfml 框架放在 /usr/local/lib/**非常重要**
*   下载了 xcode 3 dmg 并安装在单独的位置。
*   从模板制作项目
*   在 xcode 4 中打开的项目 - 无法编译
*   转到项目 -> 构建设置 -> 框架搜索路径 = /usr/local/lib

Xcode 现在应该可以正常编译了 :)

# eclipse - Eclipse：在项目快捷键中查找所有引用不起作用

> ID：11378866
> 
> 赞同：11
> 
> 时间：2012-07-07T21:43:01.303
> 
> 标签：eclipse

使用 Eclipse（相信我使用的是 Ganymede），我希望按 F9 来“查找项目中的所有引用”。

我设置了键绑定——它没有说有任何冲突，“绑定”说 F9，“何时”设置为编辑 Java 源。

但它不起作用。我已经尝试重新打开我正在使用的 .java 文件（编辑器），然后重新启动 Eclipse ......仍然没有好处。有人知道会发生什么吗？

该项目是一个 Java 项目，并且 .java 源文件位于构建路径内的源文件夹中（而不仅仅是文件夹中）。使用右键单击上下文菜单查找引用工作正常（搜索-> 引用-> 项目）。

![Eclipse 对话框](../Images/ca1962bb01509badc10a829a62b02b73.png)

# jquery - 将浏览器移动到锚点位置而不导致页面刷新

> ID：11378868
> 
> 赞同：7
> 
> 时间：2012-07-07T21:43:22.793
> 
> 标签：jquery, html, css, anchor

我有一个网页，每 30 秒使用 jquery 帖子重新加载一些数据，jquery 帖子将以选项卡形式检索锚点，因此当 jquery 刷新时，锚点始终放在第一个锚点。

假设我有#anchor1、#anchor2 和#anchor3。如果用户正在查看 #anchor2 并且 jquery 重新加载，则默认为 #anchor1。在 jquery 完成之前，我检查查看器正在使用哪个锚点，然后在 jquery 完成后，我使用下面的代码选择他们正在查看的锚点

```
document.location.href= "#anchor2"; 
```

当我使用上面的代码时，它显然会导致页面刷新，因此它会执行初始 document.ready 函数来检索数据，因此计时器永远不会被使用，它只是永久保持重新加载 jquery，每秒执行一次或所以不要使用javascript计时器。

如何在不刷新页面的情况下将用户引导到用户在 ajax 重新加载之前正在查看的锚点。

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-07T21:46:02.170

使用[`document.location.hash`](https://developer.mozilla.org/en/DOM/window.location#section_5)属性：

```
document.location.hash = "#anchor2"; 
```

# c# - 条件验证检查属性

> ID：11378871
> 
> 赞同：1
> 
> 时间：2012-07-07T21:43:46.877
> 
> 标签：c#, wpf, validation, data-annotations

我很难找出如何进行有条件的要求验证。

基本上我有一个需要验证的对话框对象。它有一个布尔值，用于确定对话框的某种状态。

如果该状态为真，则需要验证属性，如果为假，则不使用该属性，因此不需要验证。同时，我想保留值无效时的标准验证行为，即属性绑定到的控件周围的红色边框。

我得到的示例代码：

```
public class Dialog
{
    public bool UseValidation { get; set; }

    [Required]
    [StringLength(15)]
    public string NotNullString { get; set; }
} 
```

这样做的原因是我想在按下 OK 按钮时验证对话框，从而使用该`Validator.TryValidateObject()`方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:03:55.953

如果您使用 DataBinding，您可以为您的属性创建显式的 getter 和 setter，如果数据在 setter 中无效，则抛出异常。然后，您可以将文本框绑定的**ValidatesOnException属性设置为 True。**

```
public string NotNullString { 
   get { return _NotNullString; }
   set { 
          if(UseValidation && (String.IsNullOrEmpty(value) || value.Length > 15)) {
              throw new Exception("Value must be between 1 and 15 characters long.");
          }
          _NotNullString = value;
       }
} 
```

这是一篇好文章： http: [//www.codeproject.com/Articles/86955/Silverlight-4-Data-Validation-Tip-of-the-Day-Part](http://www.codeproject.com/Articles/86955/Silverlight-4-Data-Validation-Tip-of-the-Day-Part)

# c# - 调用 ListBox 的 SelectionChanged() 事件时，如何为 TextBlock 设置动画？

> ID：11378876
> 
> 赞同：1
> 
> 时间：2012-07-07T21:44:29.743
> 
> 标签：c#, silverlight, windows-phone-7, xaml, silverlight-4.0

在下面的代码中，我想在调用 TextBlock 的 TextChanged() 事件时启动动画。但是当我尝试这段代码时，我得到一个错误......

“未能分配给属性 'System.Windows.EventTrigger.RoutedEvent'”

我迷路了，有人可以帮助我，我该怎么做？

```
<StackPanel>
   <ListBox Name"lstSample" SelectionChanged="lstSample_SelectionChanged">
       <ListBox.Triggers>
          <EventTrigger RoutedEvent="ListBox.SelectionChanged">
              <BeginStoryboard>
                  <BeginStoryboard.Storyboard>
                      <Storyboard>
                         <DoubleAnimation Storyboard.TargetName="txtSample" Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:1.0">
                              <DoubleAnimation.EasingFunction>
                                  <PowerEase EasingMode="EaseIn" Power="8"/>
                              </DoubleAnimation.EasingFunction>
                          </DoubleAnimation>
                      </Storyboard>
                  </BeginStoryboard.Storyboard>
              </BeginStoryboard>
          </EventTrigger>
       </ListBoxTriggers>
   </ListBox>

   <Border Name="brdrTextSampleLanguageOne" BorderThickness="0" BorderBrush="{StaticResource PhoneAccentBrush}">
      <TextBlock 
             Text="This is sample text." 
             Name="txtSample" 
             TextAlignment="Right" 
             VerticalAlignment="Center" />

    </Border>
</StackPanel> 
```

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T19:50:22.903

使用代码真的很容易，只需创建一个如下属性：

```
 private string _textBlockText;
        public string textBlockText
        {
            get { return _textBlockText; }
            set
            {
                if (txtSample.Text != value)
                {
                    if (Storyboard1.GetCurrentState() != ClockState.Active)
                        Storyboard1.Begin();
                    txtSample.Text = value;
                }
            }
        } 
```

只需使用 textBlockText 属性来更新代码中任何地方的文本，这应该像 TextChanged 事件一样工作... 注意：Storyboard1 是您希望在 TextChanged 事件上播放的动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T04:15:22.830

这将帮助您找到下面的代码

```
<UserControl x:Class="WrapPanel.MainPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="300"
             d:DesignWidth="400"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
             xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit"
             xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk">

    <Grid x:Name="LayoutRoot"
          Background="White">
        <StackPanel>
            <StackPanel.Resources>
                <Storyboard x:Key="mystoryboard">
                    <DoubleAnimation Storyboard.TargetName="txtSample"
                                     Storyboard.TargetProperty="Opacity"
                                     From="0"
                                     To="1"
                                     Duration="0:0:1.0">
                        <DoubleAnimation.EasingFunction>
                            <PowerEase EasingMode="EaseIn"
                                       Power="8" />
                        </DoubleAnimation.EasingFunction>
                    </DoubleAnimation>
                </Storyboard>
            </StackPanel.Resources>
            <ListBox Name="lstSample"
                     SelectionChanged="lstSample_SelectionChanged">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <ei:ControlStoryboardAction ControlStoryboardOption="Play"
                                                    Storyboard="{StaticResource mystoryboard}">

                        </ei:ControlStoryboardAction>

                    </i:EventTrigger>
                </i:Interaction.Triggers>

            </ListBox>

            <Border Name="brdrTextSampleLanguageOne"
                    BorderThickness="0">
            <TextBlock Text="This is sample text."
                       Name="txtSample"
                       TextAlignment="Right"
                       VerticalAlignment="Center" />

            </Border>

        </StackPanel>

    </Grid>
</UserControl> 
```

请让我知道这对你有没有用。

干杯!

维诺德

# c# - 如何在一个值中构建变量 1 到 4 个字节的结构？

> ID：11378880
> 
> 赞同：2
> 
> 时间：2012-07-07T21:45:33.113
> 
> 标签：c#, .net

我尝试做的事情：

我想在 RAM 中存储很多数据。为了更快的访问和更少的内存占用，我需要使用一个结构值数组：

```
MyStruct[] myStructArray = new MyStruct[10000000000]; 
```

现在我想在 MyStruct 中存储一个、两个、三个或四个字节的无符号整数值。但它应该只使用尽可能少的内存量。当我将一个值存储为一个字节时，它应该只使用一个字节，依此类推。

我可以用类来实现它，但这在这里不合适，因为在 64 位系统上，指向对象的指针需要 8 个字节。所以最好为每个数组条目存储 4 个字节。但我只想在需要时存储/使用一/二/三字节。所以我不能使用一些花哨的类。

我也不能使用一个带有一个字节的数组，一个带有两个字节的数组等等，因为我需要值的特殊顺序。而且这些值非常混杂，因此在切换到另一个数组时存储一个额外的引用将无济于事。

不管我只需要存储一个字节，大约 60% 的时间里只需要存储两个字节，大约 25% 的时间里只需要存储三个字节，是否有可能想要或者是唯一的方法来存储一个 4 字节的 uint 数组？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T22:31:09.020

这是不可能的。CLR 将如何处理以下表达式？

```
myStructArray[100000] 
```

如果元素的大小可变，则 CLR 无法知道第 100000 个元素的地址。因此，数组元素始终是固定大小的。

如果您不需要`O(1)`访问，您可以在 a 上实现可变长度元素`byte[]`并自己搜索数组。

您可以将列表拆分为 1000 个单独打包的子列表。这样，您可以获得`O(n/2000)`平均搜索性能。也许这在实践中已经足够好了。

`O(n/2)`平均只能搜索“打包”数组。但是，如果您的部分数组是大小的 1/1000，它将变为`O(n/2000)`. 您可以选择部分数组，`O(1)`因为它们都具有相同的大小。

此外，您可以调整部分数组的数量，使它们的大小分别约为 1k 个元素。那时，数组对象的开销和对它的引用消失了。这会给你`O(1000/2 + 1)`查找性能，我认为这是一个很大的改进`O(n/2)`。这是一个**常数时间查找**（有一个大常数）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T22:34:43.147

如果您愿意牺牲一些额外的 CPU 时间并为每个存储值浪费额外的 2 或 4 位，您可以接近您想要的。

您可以只使用 byte`byte[]`并将其与[`BitArray`collection](http://www.dotnetperls.com/bitarray)结合使用。然后，在 byte[] 中，您只需顺序存储一个、两个、三个或四个字节，并在 BitArray 中以二进制形式（两位对）表示，或者只是将一个位设置为值 1 以表示一组新的字节刚刚开始（或结束，但是你实现它）在你的数据数组中。

但是你可以在内存中得到这样的东西：

```
byte[]   --> [byte][byte][byte][byte][byte][byte][byte]...
BitArray --> 1001101... 
```

这意味着您的字节数组中存储了 3 个字节、1 个字节、2 个字节等值。

或者您也可以将您的位数组编码为二进制对以使其更小。这意味着每个实际数据字节会占用 1.0625 到 1.25 个字节。

这取决于您的实际数据（您的`MyStruct`）是否足够。如果您需要区分这些字节真正对应的结构中的哪些值，您可能会在`BitArray`.

**更新您的 O(1) 要求：**

使用另一种索引结构，该结构将为每个 N 个元素存储一个索引，例如 1000。然后，您可以例如访问索引为 234241 的项目作为

```
indexStore[234241/1000] 
```

它为您提供元素 234000 的索引，然后您只需通过检查 BitArray 中的几百个元素来计算元素 234241 的确切索引。

O(const) 是这样实现的，const 可以通过主索引的密度来控制，当然你用时间换空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T23:16:30.587

你不能这样做。

如果数据没有排序，并且您对此无话可说，那么您将无法做您想做的事情。

简单场景：

```
array[3] 
```

应该指向一些内存地址。但是，你怎么知道`array[0]`-的尺寸是`array[2]`多少？要以 O(1) 的方式存储该信息，您只会浪费比一开始想要保存的更多的内存。

您正在跳出框框思考，这很棒。但是，我的猜测是，这是您试图摆脱的错误盒子。如果您的数据确实是随机的，并且您希望直接访问每个数组成员，则您必须使用每个数字所需的最大宽度。对不起。

我有一种类似的情况，我需要存储的长度小于 32 位。但它们都是固定宽度，所以我能够通过自定义容器和一些位移来解决这个问题。

希望：

[http://www.dcc.uchile.cl/~gnavarro/ps/spire09.3.pdf](http://www.dcc.uchile.cl/~gnavarro/ps/spire09.3.pdf)

也许您可以阅读它，并且您不仅可以每个数字拥有 8、16、24、32 位，而且可以拥有任何数字大小......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T23:47:47.863

我几乎要开始研究一些短字编码的变体，比如 PkZip 程序。

甚至是 RLE 编码。

或者尝试更好地了解您的数据的使用情况。就像，如果这些都是向量或其他东西，那么某些组合是不允许的，例如，-1、-1、-1 对于金融图形应用程序基本上没有意义，因为它表示数据超出了可绘制范围。如果你能发现一些关于你的数据的奇怪之处，你可以通过为不同的需求使用不同的结构来减小大小。

# c# - 在 DataGridRow 出现错误时阻止所有控件

> ID：11378882
> 
> 赞同：2
> 
> 时间：2012-07-07T21:45:50.530
> 
> 标签：c#, wpf, datagrid

我正在开发一个 WPF 项目，现在我正在验证`DataGrid`. 因此，当插入无效数据时，我会在`RowHeader`. 到目前为止一切顺利。

但我的问题是：**除了DataGrid的当前行之外，当插入“无效”数据时，有没有办法阻止应用程序中的任何其他控件？或者，我该怎么做才能防止当前行失去焦点，直到输入正确的数据？**

到目前为止，我的想法是引发一个事件，`eventAggregator`用于通知所有控件有关该错误的信息。但这很难，因为我必须在我可以拥有的每个控件中订阅一个方法。

希望有人可以帮助我，在此先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:50:23.973

通过取消 CellEditEnding 事件，您可以阻止单元格失去焦点：

```
public MainWindow()
{
    InitializeComponent();

    dataGrid1.ItemsSource = new List<TestClass>() { new TestClass() };
    dataGrid1.CellEditEnding += new EventHandler<DataGridCellEditEndingEventArgs>(dataGrid1_CellEditEnding);
}

void dataGrid1_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
{
    if(whateveryouwant == true)
        return;
     else    
    e.Cancel = true;
} 
```

**编辑：**

EventAggregator 是解决它的好方法，但是由于您知道但似乎不喜欢它，因此将采用更简单的方法，尽管您必须指定一些应该能够停止的控件类型：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        dataGrid1.ItemsSource = new List<TestClass>() { new TestClass() };
        dataGrid1.CellEditEnding += new EventHandler<DataGridCellEditEndingEventArgs>(dataGrid1_CellEditEnding);

        MouseDownHandler = new MouseButtonEventHandler((sender, args) => { args.Handled = true; });
        MouseClickHandler = new RoutedEventHandler((sender, args) => { args.Handled = true; });
    }

    private bool IsMouseEventStopped = false;
    private RoutedEventHandler MouseClickHandler = null;
    private MouseButtonEventHandler MouseDownHandler = null;

    void dataGrid1_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
    {
        bool correctCellValue = false;

        //correctCellValue = true to stop editing, if the cell value is correct

        if (correctCellValue)
        {
            // unblock mouse events
            if (IsMouseEventStopped == true)
            {
                foreach (Button c in FindVisualChildren<Button>(this))
                    c.Click -= MouseClickHandler;
                foreach (TextBox c in FindVisualChildren<TextBox>(this))
                    c.PreviewMouseLeftButtonDown -= MouseDownHandler;
            }
            IsMouseEventStopped = false;
        }
        else
        {
            e.Cancel = true;
            // block mouse events to certain controls
            if (IsMouseEventStopped == false)
            {
                IsMouseEventStopped = true;
                foreach (Button c in FindVisualChildren<Button>(this))
                    c.Click += MouseClickHandler;
                foreach (TextBox c in FindVisualChildren<TextBox>(this))
                    c.PreviewMouseLeftButtonDown += MouseDownHandler;
            }
        }
    }

    public static IEnumerable<T> FindVisualChildren<T>(DependencyObject depObj) where T : DependencyObject
    {
        if (depObj != null)
        {
            for (int i = 0; i < VisualTreeHelper.GetChildrenCount(depObj); i++)
            {
                DependencyObject child = VisualTreeHelper.GetChild(depObj, i);
                if (child != null && child is T)
                    yield return (T)child;

                foreach (T childOfChild in FindVisualChildren<T>(child))
                    yield return childOfChild;
            }
        }
    }
} 
```

感谢 Bryce Kahle 在[这里的 FindVisualChildren](https://stackoverflow.com/questions/974598/find-all-controls-in-wpf-window-by-type)

# php - httpd.conf@Windows

> ID：11378885
> 
> 赞同：0
> 
> 时间：2012-07-07T21:46:12.607
> 
> 标签：php, apache, cakephp, webmatrix

我用 MS WebMatrix 创建了 PHP 项目并将 CakePHP 复制到其中。它提示：

> 您的服务器上未正确配置 URL 重写。

但是，除此之外，一切都很好：

> 您的 PHP 版本是 5.2.8 或更高版本。
> 
> 您的 tmp 目录是可写的。
> 
> FileEngine 用于核心缓存。要更改配置编辑 APP/Config/core.php
> 
> 您的数据库配置文件存在。
> 
> Cake 能够连接到数据库。

我相信我应该只编辑 httpd.conf 文件（CakePHP 文档告诉我）但我根本找不到这样的文件......它是隐藏在某个地方还是有任何 GUI 配置器？我真的是 Windows 新手，不知道在哪里搜索，谷歌只告诉我明显的 Linux 目录...

我可以将所有文件上传到服务器并从那里工作，但这并不是很方便。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T04:27:29.330

您应该编辑应用根文件夹中的 .htaccess 文件。IIS 配置需要对 cakephp 项目中的 htaccess 文件进行一些修改。

希望它对你有用。请询问它是否不适合您。

# sqlite - SQLite 数据库中的 Unicode 文本似乎已损坏

> ID：11378889
> 
> 赞同：1
> 
> 时间：2012-07-07T21:47:05.050
> 
> 标签：sqlite, haskell, unicode, utf-8

我正在使用 [http://hackage.haskell.org/package/sqlite-0.5.2.2](http://hackage.haskell.org/package/sqlite-0.5.2.2)绑定到 SQLite 数据库。在 *.db 文件中有 UTF-8 编码的文本，我可以在文本编辑器和 sqlite CLI 工具中保证这一点。

连接到数据库并检索数据时 - 文本内容已损坏。简单的测试如下：

```
import qualified Database.SQLite as SQL
import Control.Applicative ((<$>))
import System.IO

buildSkypeMessages dbh = 
  (go <$> (SQL.execStatement dbh "select chatname,author,timestamp,body_xml from messages order by chatname, timestamp")) >>=
  writeIt
  where
    writeIt content = withFile "test.txt" WriteMode (\handle -> mapM_ (\(c:a:t:[]) -> hPutStrLn handle c) content)
    go (Left msg) = fail msg
    go (Right rows) = map f $ concat rows
      where
        f' (("chatname",SQL.Text chatname):
            ("author",SQL.Text author):
            ("timestamp",SQL.Int timestamp):
            r) = ([chatname, author], r)
        f xs = let (partEntry, (item:_)) = f' xs
               in case item of
                 ("body_xml",SQL.Text v) -> v:partEntry
                 ("body_xml",SQL.Null)   -> "":partEntry
        escape (_,SQL.Text v) = v
        escape (_,SQL.Null) = ""
        escape (_,SQL.Int v) = show v 
```

那里可能有什么问题？我是否缺少 Sqlite 或 Haskell I/O 和编码的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T07:12:15.797

实际上，问题与 SQLite 绑定无关，而是与 Haskell 中的字符串处理有关。是什么解决了这个问题 - 在将数据放在句柄上之前调用 hSetBinaryMode ：

```
writeIt content = withFile "test.txt" WriteMode (\handle -> hSetBinaryMode handle True >> mapM_ (\(c:a:t:[]) -> hPutStrLn handle c) content) 
```

# javascript - javascript中的对象字面量数组

> ID：11378895
> 
> 赞同：1
> 
> 时间：2012-07-07T21:48:02.393
> 
> 标签：javascript, jquery

我想知道是否可以使用数组获取对象属性。我得到 this.label[i].xOffset 的“未定义”值。有什么建议么？

```
function label() {
    var lbl = this;
    lbl.rText;
    lbl.precision =1;
    lbl.prefix = '';
    lbl.suffix = '';
    lbl.xOffset = this.width/2;
    lbl.yOffset = this.height*82/100    
}
this.NoOfneedles=2;
if (this.NoOfneedles > 1) {
    this.label = [];
    for (i=0;i<this.NoOfneedles;i++) {
        this.label[i]=new label();
        alert("label xOffset:"+this.label[i]+this.label[i].xOffset);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:07:49.753

首先，您的`label`功能存在问题：

```
lbl.xOffset = this.width/2; 
```

在这里，`this.width`is `undefined`，因为`this`是指您使用 创建的对象`new label()`。但是，`xOffset`对象的属性将等于`NaN`。而这一行：

```
lbl.rText; 
```

什么也没做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T22:13:54.667

我认为这可能是问题：

在您的构造函数 label() 中，您将 xOffset 和 yOffset 设置为“this”宽度和“this”高度，但“this”没有宽度/高度属性，因此它们未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T22:21:10.993

您的`label`对象没有`width`和`height`属性，并且其他人已经说过了，但是如果您只是在构造函数中定义`width`和`height`，那么它可以写成如下

```
function Label() {
   var lbl = this;
   lbl.width=window.outerWidth;
   lbl.height=window.outerHeight;
   lbl.precision =1;
   lbl.prefix = '';
   lbl.suffix = '';
   lbl.xOffset = lbl.width/2;
   lbl.yOffset = lbl.height*82/100    
}

this.NoOfneedles=2;
if (this.NoOfneedles > 1){
    this.label = [];
    for (i=0;i<this.NoOfneedles;i++){
        this.label[i]=new Label();
        alert ("label xOffset:"+this.label[i].xOffset);
    }
} 
```

请记住，这指的是当前对象，并且您`this.width/2;`在构造函数内部使用，所以`this=Label`我已经将`label`to`Label`和构造函数外部 / 全局范围内`this`指的是默认全局对象`window`和全局范围内`this.someVar`，并且`someVar`是相同的，因为`window`是默认全局对象和 by默认我们不需要使用它，所以我们可以使用`document.getElementbyId`instrad of `window.document.getElementbyId`.

# ssl - 我需要在我的服务器上安装 SSL 吗？

> ID：11378896
> 
> 赞同：0
> 
> 时间：2012-07-07T21:48:14.737
> 
> 标签：ssl

我有一个虚拟服务器，上面有几个网站。老实说，我对 SSL 几乎一无所知。当我尝试登录到我的服务器 Web 主机管理器或我的任何站点 Cpanels 时，我会看到一个屏幕（在 chrome 中），上面写着“此网站不受信任”。这是因为服务器需要安装 SSL 吗？

也许它甚至与 SSL 无关，但任何解释都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T23:45:11.430

SSL 保护您的浏览器和服务器之间的连接。如果您在那里有重要数据，则应安装 SSL 以保护您的连接不被“嗅探”。

SSL 是网络协议，因此您必须在服务器上安装或启用它。

这是在 Apache 服务器上安装/启用 SSL 的资源：

[http://www.digicert.com/ssl-certificate-installation-apache.htm](http://www.digicert.com/ssl-certificate-installation-apache.htm)

以下是如何在 IIS 上安装/启用 SSL：

[http://support.microsoft.com/kb/299875](http://support.microsoft.com/kb/299875)

# c++ - Boost为同一个线程获取多个锁

> ID：11378898
> 
> 赞同：4
> 
> 时间：2012-07-07T21:48:25.700
> 
> 标签：c++, linux, boost-thread

我有一个需要审查的基本示例（C++）。

假设我有一个函数 PublicFunc()，还有一个叫做 PrivateFunc()。我想仔细同步它们。但是 PrivateFunc 有时也可以调用 PublicFunc，这意味着我们从同一个线程调用它。这会导致阻塞，我想解决它。

```
mutable boost::mutex m;

void PublicFunc() {
 m.lock();
 //Here it blocks, but why?
 //What I need is to get the lock if this func was called from PrivateFunc(), so exactly from the same thread.
 //But! It should definitely block on calling PublicFunc from outside while we are for example in the 'OtherPrivateFunc'.

 //Do some stuff

 //this is not necessary
 m.unlock(); 
}

void PrivateFunc() {
 m.lock();

 PublicFunc();

 OtherPrivateFunc();

 m.unlock();
} 
```

boost 库中的哪个互斥锁或锁是正确的？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T21:54:00.550

A`mutex`只能被锁定一次；任何在互斥锁被锁定时锁定互斥锁的调用都会阻塞，即使尝试锁定互斥锁是由持有互斥锁锁的线程进行的。

如果您希望能够在同一个线程上多次锁定互斥锁，请使用`recursive_mutex`.

或者，考虑重新组织您的代码，以便您拥有一组（私有）成员函数，假设互斥锁已锁定，并让所有其他函数委托给这些函数。这可以使代码更清晰，并且可以更容易地验证同步是否正确。

# c++ - 如果放在行尾，为什么 EOF 字符不起作用？

> ID：11378899
> 
> 赞同：13
> 
> 时间：2012-07-07T21:48:27.003
> 
> 标签：c++, windows, stream, event-handling, eof

我正在学习 C++ 并试图理解，
如果将 EOF 字符（Windows 上的 Ctrl + Z）放在行尾，为什么不打破 while 循环？

我的代码：

```
 int main() {
        char ch;
        while(cin >> ch) {
            cout << ch;
        }
    } 
```

当我输入 ^Z 时，循环中断；
但是当我输入 12^Z 时，它没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-07T22:25:00.893

您不会在 C++ 标准中找到问题的答案。

`cin >> ch`只要既没有文件结束条件也没有输入错误，它将是“真”条件。文件结束条件的触发方式不是由语言指定的，它可以并且会因操作系统而异，甚至在同一操作系统中具有配置选项。（例如，类 Unix 系统默认使用 control-D，但可以通过`stty`命令更改。）

Windows 使用 Control-Z 触发文本输入流的文件结束条件；除了在一行的开头之外，它只是碰巧没有这样做。

Unix 的行为有点不同。它在一行的开头使用 Control-D（默认情况下），或者在一行的中间使用*两个*Control-D。

对于 Unix，这仅适用于从终端读取；如果您从文件中读取，control-D 只是另一个非打印字符，它不会触发文件结束条件。即使从磁盘文件读取，Windows 似乎也将 control-Z 识别为文件结束触发器。

底线：不同的操作系统表现不同，主要是出于模糊的历史原因。C++ 旨在处理任何这些行为，这就是为什么它没有具体说明某些细节的原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-07T22:25:53.453

C 和 C++ 标准允许文本流在默认的**文本模式下**做一些非常邪恶的事情。这些 Unholy Things 包括内部换行标记和外部换行控制字符之间的转换，以及将某些字符或字符序列视为表示**文件结尾**。在 Unix 领域它没有完成，但在 Windows 领域它已经完成，因此代码只能与原始 Unix 领域的约定相关。

这意味着在 Windows 中，没有办法编写可移植的 C 或 C++ 程序来将其输入准确地复制到其输入。

在 Unix 领域，这根本没有问题。

在 Windows 中，由单个 [Ctrl Z] 组成的行按照惯例是文件结束标记。不仅在控制台中如此，在文本文件中也是如此（取决于工具）。Windows 继承了 DOS 的这一点，后者又继承了 CP/M 的总体思想。

我不确定 CP/M 是从哪里得到的，但它只是*类似于*Unix 的 [Ctrl D]。

在 Unix 领域，文件结尾的一般约定只是“不再有数据”。默认情况下，在控制台中，[Ctrl D] 会将您输入的文本立即发送到等待程序。当您还没有在该行上键入任何内容时，将发送 0 个字节，并且按照惯例，返回 0 个字节的读取会遇到文件结尾。

主要区别在于，在 Windows 内部，文件标记的文本结尾是*data*，可以出现在文件中，而在 Unix 内部，它*缺少 data*，不能出现在文件中。当然，Windows 也支持文本的普通文件结尾（没有更多数据！）。这使事情变得复杂——Windows 只是更复杂。

* * *

```
#include <iostream>
using namespace std;

int main()
{
    char ch;
    while(cin >> ch) {
        cout << 0+ch << " '" << ch << "'" << endl;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T21:59:35.303

这是由 cin >> ^Z 将评估为 false 引起的。

更详细： cin.eof() 将返回 true ，因此隐式调用 eof() 的 while 将返回 false 并因此结束循环。

如果输入 12^Z，eof() 将返回 false，因为它可以解析有效的输入值，因此不会停止循环。

您可能也对这个 SO 感兴趣：

[SO关于标志的语义](https://stackoverflow.com/questions/4258887/semantics-of-flags-on-basic-ios/4258924#4258924)

# javascript - 如何根据条件启用或禁用脚本？

> ID：11378908
> 
> 赞同：0
> 
> 时间：2012-07-07T21:50:15.100
> 
> 标签：javascript, ruby-on-rails, coffeescript

这似乎相当简单。但我不知道。

例如，如果用户是管理员，则可以使用额外的功能。如果用户不是，则某些操作将不再可能，因为未生成代码。

我是否真的将 Ruby 放入脚本中并以 .erb 结尾文件名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T23:22:42.470

好的，从您上面的评论中，我现在对您想要的有所了解。

这是在服务器的哪一边做事的问题。当然，用户凭据是在服务器端处理的。因此，这将需要传达给客户端，即 JS。

你如何做到这一点很大程度上取决于你的设置。一个可以想象的模型是您的 JS 通过 AJAX 调用一个服务器端脚本，该脚本会报告用户是管理员还是普通用户。也许服务器端脚本只是返回一个字符串 -`user`或`admin`.

根据响应，您可以加载您需要的仅管理员功能 - 即 JS 脚本。

您可以手动执行此操作，或者更轻松地使用众多 JS 加载程序之一。AMD（异步模块定义）加载非常流行，因此请查看 require.js 或 curl.js 之类的内容。一个简单的（非 AMD）选项是 LABS.js。

# javascript - 在 Javascript 中访问 Rails 子对象

> ID：11378911
> 
> 赞同：1
> 
> 时间：2012-07-07T21:50:44.180
> 
> 标签：javascript, ruby-on-rails, google-maps-api-3, geocoding

我对rails很陌生，所以请多多包涵。我还没有完全掌握所有的“魔法”。

基本上我需要访问 Javascript 中的 Location 对象，它们都包含 0-N 坐标。我很确定模型设置正确，每个坐标都有一个 location_id。

我设法使用以下方法获取解析的位置对象 JSON：我把

```
 def index
     @locations = Location.all.to_json
  end 
```

在控制器中，并在视图中访问它

```
var theLocations = <%= @locations.html_safe %>; 
```

但是，当我在日志中显示此变量时，它不显示坐标，这是有道理的。问题是，我计划遍历所有位置，并为每个位置创建一个具有相关坐标的 javascript var。然后这些变量将作为对象传递给 Google 地图。

基本上我打算做类似（伪代码）的事情：

```
for(Location l in Locations){

    get all Coordinate objects within Location

    for(Coordinate c: Coordinates);

        var myObject = new google.maps.LatLng(c.X, c.Y),
        add myObject to list for this location.
    }
} 
```

我只是不确定如何解决这个问题。如何获得对位置内坐标的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:10:45.610

快速而肮脏的答案是在您的`to_json`调用中传递一个参数：

```
@locations = Location.all.to_json(:include => :coordinate) 
```

您可能还需要考虑通过在此之后覆盖对象并将其呈现为 JSON来[创建自定义 JSON 结构。](http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/)`as_json`

# ruby-on-rails - 在 Rails 邮件主题行中包含 ERB

> ID：11378912
> 
> 赞同：2
> 
> 时间：2012-07-07T21:50:45.753
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, actionmailer

我想在我的 Rails 邮件程序的主题行中包含以下代码，但无法使其正常工作。什么是正确的语法？谢谢！

```
<%= @occasions.map{|o|o.pname+"'s "+o.name}.to_sentence %> 
```

邮寄者：

```
 def upcoming_deals_mail(user)

    @user = user
    @occasions = user.upcoming_occasions_with_deals
    @deals = user.upcoming_deals

    @subject = "An friendly Reminder"

    mail(:to => "#{ user.email } <#{ user.email }>", :subject => @subject)
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-25T17:04:11.283

添加双引号 (" ") 而不是单引号 (' ') 为我做了

失败：

```
mail(to: 'test@email.com', subject: 'Application for: #{@applicant.full_name}') 
```

成功：

```
mail(to: 'test@email.com', subject: "Application for: #{@applicant.full_name}") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:02:34.870

我不确定我是否理解你，但如果你想做的只是在你的邮件主题中包含指定的 ruby​​ 表达式，你可以替换`@subject = "An friendly Reminder"`为

```
@subject = @occasions.map{|o|o.pname+"'s "+o.name}.to_sentence 
```

# xml - 仅使用 R 从 xml 文件（声明）中提取数据

> ID：11378913
> 
> 赞同：3
> 
> 时间：2012-07-07T21:51:25.330
> 
> 标签：xml, r

我正在尝试从看起来像这样的 xml 文件中提取数据（见下文）。我需要在**节点**内提取类型 = 0的**节点的****id 。**我只需要为 R 找到解决方案。现在我可以通过*xmlToList("test.xml")[[3]][[1]]*和*xmlToList("test.xml")[[3]][[4]]*提取类型和 id 。将 3 更改为 6,9 等 - 我可以检索所有需要的类型和 id。但我不确定这是否正确，因为它基于可以更改的编号（在 xml 结构更改的情况下）。您能否提出另一种更简单的从 xml 中提取数据的方法？或对我的非理想解决方案进行任何修改？谢谢！

 ******```
<?xml version="1.0" encoding="UTF-8"?>
<image name="test1" id="367432589" width="952" height="1024" create_date="Mar 2, 2009" >
  <nodes>
    <node type="16" name="Target532" url="/cgi/im?id=5657" id="5657" x="67" y="45" width="153" height="69">
      <alt>Synthesis1</alt>
      <Appearance TextArea="Rectangle: 550"  Comlex="Boolean: true" />
    </node>
    <node type="0" name="Target1" url="/cgi/im?id=680" id="680" x="193" y="535" width="70" height="70">
      <alt>Object &lt;b&gt;Target1&lt;TestingCond32</alt>
      <Appearance TextArea="Rectangle: 210"  Comlex="Boolean: false" />
    </node>
  </nodes>
  <edges>
    <edge type="-100" id="234523">
      <alt />
      <Appearance Visualization="String: Hexa" HexagonIndex="Integer: 0" />
    </edge>
    <edge type="-100" id="23">
      <alt />
      <Appearance Visualization="String: Hexa" HexagonIndex="Integer: 0" />
    </edge>
  </edges>
</image> 
```

我是 xml 新手，对 R 有基本的了解。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:21:07.497

您可以尝试以下方法

```
xpathSApply(xdata,"//*/node[@type=\"0\"]/@id")

> xpathSApply(xdata,"//*/node[@type=\"0\"]/@id")
   id 
"680" 
```

这会查找一个名为“node”的节点，其属性“type”的值为 0。然后它返回与该节点关联的 id 的属性值******

# plugins - Jekyll 不处理服务器上的插件

> ID：11378915
> 
> 赞同：0
> 
> 时间：2012-07-07T21:52:08.670
> 
> 标签：plugins, jekyll

Jekyll 正在我的本地机器（OS X 10.7.4，ruby 1.9.3）上处理我的 _plugins 文件夹，但它没有在服务器上处理它们（Ubuntu 12.04，ruby 1.9.3）。两者都安装了相同版本的 Jekyll (0.11.2)。

我正在尝试使用 generate_sitemap 插件，[在这里](http://recursive-design.com/projects/jekyll-plugins/)。

我正在通过 git 和 post-receive 挂钩进行部署，如下所示：

```
#!/bin/bash -l

GIT_REPO=/my_repo.git
TMP_GIT_CLONE=/my_temp_folder/
PUBLIC_WWW=/my_public_folder/

git clone $GIT_REPO $TMP_GIT_CLONE
jekyll --no-auto $TMP_GIT_CLONE $PUBLIC_WWW
rm -Rf $TMP_GIT_CLONE
exit 
```

我在部署时看到此错误：

```
remote: /home/ed/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': iconv will be deprecated in the future, use String#encode instead. 
```

但是，根据我的阅读，这是一个 Maruku 警告，与插件无关。

有人对我可以尝试解决的问题有任何想法吗？我有点不知所措。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T07:44:06.857

Jekyll 很难调试，但它是一个很棒的工具！！！

我假设您的 _plugins 文件夹中有多个插件。

所以也许你的一个或一些插件会导致问题。

如果我是对的，您可以执行以下操作：

*   杀死你的杰基尔
*   在另一个位置（不在 _plugins 文件夹中）创建插件的备份。
*   在你的 _plugins 文件夹中只留下一个插件并启动 Jekyll。
*   如果可行，请将另一个插件复制到 _plugins 文件夹，直到找到无法通过 Jekyll 的插件。

当您找到它时，您可以将调试打印输出添加到有问题的插件中（这就是我所做的）。

类似的东西： ***放“之前......”***

我仅使用 Jekyll 构建了[http://www.cloudifysource.org/](http://www.cloudifysource.org/)，您可以在我们的 GitHub 存储库中找到并使用我们的许多有用示例：[https ://github.com/CloudifySource/cloudifysource.github.com](https://github.com/CloudifySource/cloudifysource.github.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T22:44:44.260

当从 post-receive 钩子调用时，我遇到了 Jekyll 不加载插件的同样问题。

正如上面评论中提到的，将当前工作目录更改为可以`$TMP_GIT_CLONE`解决问题。

您不必更改 _config.yml 中的任何内容。

```
#!/bin/bash -l

GIT_REPO=/my_repo.git
TMP_GIT_CLONE=/my_temp_folder/
PUBLIC_WWW=/my_public_folder/

git clone $GIT_REPO $TMP_GIT_CLONE
cd $TMP_GIT_CLONE                             # move to the temp dir
jekyll --no-auto $TMP_GIT_CLONE $PUBLIC_WWW
cd                                            # move back to allow deletion
rm -Rf $TMP_GIT_CLONE
exit 
```

这是一个真正令人头疼的问题，因为 git 用户工作得很好，所以手动执行原始的 post-receive 钩子......无论如何，Jekyll 现在正在我的服务器上加载插件，希望这是一个正确的答案将帮助其他人找到这个解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-04T03:01:48.727

最近，我开始用 jekyll构建[https://github.com/alswl/code-standards-jekyll 。](https://github.com/alswl/code-standards-jekyll)我在 中写了两个插件`_plugins`，发现很难调试。

起初，我用`puts "balabala"`调试，它似乎工作。但是一旦我遇到在文件夹中没有生成任何东西的问题`_site`，并且控制台中没有'balabala'，我很恐慌。

在我阅读了 jekyll 源码后，我尝试设置`auto=false`，`_config.yml`运行 jekyll 会产生一些调试跟踪堆栈错误。感谢上帝。

因此，ues`auto=false`将帮助您调试插件。

# linux - Linux管道和循环

> ID：11378916
> 
> 赞同：5
> 
> 时间：2012-07-07T21:52:22.783
> 
> 标签：linux, pipe, piping

是否可以使用 Linux 管道创建循环？例如

> cmd1 | 命令2 | cmd3 | '返回标准输入 cmd1'

换句话说，我想`stdout`连接`cmd3`回`stdin`of `cmd1`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T21:54:13.517

您可以使用命名管道/FIFO：

```
mkfifo cmd3-to-cmd1
cmd1 < cmd3-to-cmd1 | cmd2 | cmd3 >> cmd3-to-cmd1 
```

# clojure - Leiningen 和 Clojure 依赖项

> ID：11378918
> 
> 赞同：4
> 
> 时间：2012-07-07T21:52:42.143
> 
> 标签：clojure, leiningen, slick2d

我对clojure还很陌生，但我一直无法在网上找到好的资源和示例，所以希望有人能指出我正确的方向。我用 lein 开始了一个项目，project.clj 看起来像这样：

```
(defproject scratch "1.0"
  :description ""
  :main scratch.core
  :dependencies [
    [org.clojure/clojure "1.3.0"]
    [org.clojars.jyaan/slick "247.1"]
  ]) 
```

和 src/scratch/core.clj 看起来像这样：

```
(ns scratch.core 
    (:import org.newdawn.slick))    

(defn -main [] (println "hello world")) 
```

据我所知，这是正确的，但是当我尝试运行时，`lein run`我得到了 ClassNotFoundException。

我在 lib/slick-247.1.jar 文件上做了一个 jar tf，并确认它有一个目录结构，表明它有那个命名空间（org/newdawn/slick/etc...）。我确定这是一个简单的错误，但我看不出它是什么，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T22:13:59.330

我认为问题在于您正在尝试导入整个包，例如 Java 中的“import org.newdawn.slick.*”。在 Clojure 中你不能这样做，但你必须导入你想使用的每个类。

你能得到的最短的是：

```
(:import (java.io BufferedReader Bits BufferedWriter)) 
```

# ruby-on-rails - 对于 Ruby on Rails，术语“供应商”或“供应商”是什么意思？

> ID：11378921
> 
> 赞同：19
> 
> 时间：2012-07-07T21:52:56.610
> 
> 标签：ruby-on-rails, ruby

示例：“在测试/虚拟环境中销售 Rails 应用程序”“在生产环境中销售 Rails 的推荐方式是什么？”

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-07T22:00:11.090

供应商是将所有 3rd 方项目（如插件、gem 甚至 rails）移动到`/vendor`目录中。这是确保将所有文件部署到与开发环境相同的生产服务器的一种方法。

最好的方法是：

```
 rake gems:unpack 
```

或者

```
 rake rails:freeze:gems 
```

用于`rake -T`查看 rake 任务的完整列表。

# javascript - 如何将构建脚本与 kickstrap 一起使用？

> ID：11378925
> 
> 赞同：0
> 
> 时间：2012-07-07T21:53:17.263
> 
> 标签：javascript, twitter-bootstrap, html5boilerplate, kickstrap

我刚刚开始玩 Kickstrap，但无法让构建脚本正常工作。

按照[此处](http://ajkochanowicz.github.com/Kickstrap/h5bp.html)的说明，我创建了一个新的 Kickstrap 项目（只需将文件解压缩到一个目录），然后转到 site1/build/ 并运行：

```
ant build 
```

但构建失败并出现以下错误：

```
-js.all.minify:
     [echo] Minifying scripts
     [copy] Copying 2 files to /home/bob/site1/intermediate/js
    [apply] /home/bob/site1/js/tests/server.js:10: ERROR - Parse error. missing name after . operator
    [apply]       .use(connect.static(__dirname + '/../../'));
    [apply]                           ^
    [apply] 
    [apply] 1 error(s), 0 warning(s)
    [apply] Result: 1 
```

和

```
-less:
     [echo] Converting LESS to CSS...
     [echo] Minifying css...
 [checksum] Could not find file /home/bob/site1/intermediate/css/style.less.min.css to generate checksum for. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T16:27:02.733

不幸的是，在 1.0 以下的 KS 版本中，构建脚本还没有准备好。（因此它不是一个完整的稳定版本）。不过，我希望能在 2012 年 7 月之前完善 v.1.0 的候选版本。感谢您的耐心等待。

# ruby-on-rails - 在获取请求上使用 rspec 没有路由匹配

> ID：11378927
> 
> 赞同：2
> 
> 时间：2012-07-07T21:53:29.353
> 
> 标签：ruby-on-rails, ruby, rspec

我忘记了什么？

路线：

```
 get "/comingsoon" => "visitors#comingsoon"
  resources :visitors 
```

控制器：

```
class VisitorsController < ApplicationController
  def comingsoon
    @new_visitor = Visitor.new
  end
end 
```

规格：

```
require 'spec_helper'

describe VisitorsController do
  describe "GET /comingsoon" do
    it "should be happy" do
      get "/comingsoon"
      response.should be_success
    end
  end
end 
```

结果如下：

```
✗ rspec spec/controllers/visitors_controller_spec.rb
F

Failures:

  1) VisitorsController GET /comingsoon should be valid
     Failure/Error: get "/comingsoon"
     ActionController::RoutingError:
       No route matches {:controller=>"visitors", :action=>"/comingsoon"}
     # ./spec/controllers/visitors_controller_spec.rb:7:in `block (3 levels) in <top (required)>'

Finished in 0.14226 seconds
1 example, 1 failure

Failed examples:

rspec ./spec/controllers/visitors_controller_spec.rb:6 # VisitorsController GET /comingsoon should be valid 
```

我忘记了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T22:13:44.353

在您的规范文件中替换`get "/comingsoon"` 为`get "comingsoon"`

当您使用 rspec 指定控制器时，http 动词（get、post、put、delete）的操作数是控制器的操作而不是 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:13:05.857

可能是愚蠢的建议，但您有意见吗？否则你必须告诉你的控制器渲染一些东西。

# javascript - 通过在顶部和左侧添加空间来调整画布大小..？

> ID：11378929
> 
> 赞同：1
> 
> 时间：2012-07-07T21:53:52.603
> 
> 标签：javascript, html, canvas

是否可以通过在画布的顶部和左侧添加新空间来调整**画布**`dx`的大小 - 通过在左侧添加像素和`dy`在顶部添加像素？如果是这样，如果当前画布非常大，那么最好的优化解决方案是什么......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T03:45:06.730

是的，这可以通过内存画布实现。您所要做的就是通过将画布位图绘制到内存中的临时画布来“保存”画布位图，调整画布大小，然后在正确的位置绘制旧位图。

这是一个活生生的例子：

[http://jsfiddle.net/simonsarris/YdtEd/](http://jsfiddle.net/simonsarris/YdtEd/)

# java - 具有许多具有默认值的字段的“不可变类”的Java构造函数？

> ID：11378932
> 
> 赞同：22
> 
> 时间：2012-07-07T21:54:00.720
> 
> 标签：java, oop, design-patterns

我有一个包含很多字段的 JAVA 类。它们基本上应该在构造函数阶段设置并且永远不会改变。从语义上讲，这个类是一个不可变的。

```
public class A{
    final int a;
    final short b;
    final double e;
    final String f;
    final String g;
    //and more
} 
```

问题是这些字段通常具有默认值，因此我不想总是让用户负担所有这些字段的构造函数。大多数时候，他们只需要设置几个。有几种方法可以解决这个问题：

1.  我需要很多具有不同签名的构造函数。
2.  创建一堆这些字段的设置方法，只设置那些非默认值。但这以某种方式表明了与不可变性质不同的语义。
3.  创建一个新的可变参数类并将该类用作构造函数。

这些都不是完全令人满意的。还有其他方法吗？谢谢。单程

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-07T22:06:10.953

我将使用参数类和流利的构建器 API 的组合来创建参数：

```
public class A {
    private final int a;
    private final short b;
    private final double e;
    private final String g;

    public static class Aparam {
        private int a = 1;
        private short b = 2;
        private double e = 3.141593;
        private String g = "NONE";

        public Aparam a(int a) {
            this.a = a;
            return this;
        }

        public Aparam b(short b) {
            this.b = b;
            return this;
        }

        public Aparam e(double e) {
            this.e = e;
            return this;
        }

        public Aparam g(String g) {
            this.g = g;
            return this;
        }

        public A build() {
            return new A(this);
        }
    }

    public static Aparam a(int a) {
        return new Aparam().a(a);
    }

    public static Aparam b(short b) {
        return new Aparam().b(b);
    }

    public static Aparam e(double e) {
        return new Aparam().e(e);
    }

    public static Aparam g(String g) {
        return new Aparam().g(g);
    }

    public static A build() {
        return new Aparam().build();
    }

    private A(Aparam p) {
        this.a = p.a;
        this.b = p.b;
        this.e = p.e;
        this.g = p.g;
    }

    @Override public String toString() {
        return "{a=" + a + ",b=" + b + ",e=" + e + ",g=" + g + "}";
    }
} 
```

然后像这样创建 A 的实例：

```
A a1 = A.build();
A a2 = A.a(7).e(17.5).build();
A a3 = A.b((short)42).e(2.218282).g("fluent").build(); 
```

A类不可变，参数可选，接口流畅。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-07-07T21:56:12.690

你可以做两件事：

*   许多构造函数重载
*   使用[构建器对象](http://en.wikipedia.org/wiki/Builder_pattern)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T23:14:07.157

这只是一个半严肃的建议，但我们可以将[mikera 的答案](https://stackoverflow.com/a/11378969/116639)修改为类型安全。

假设我们有：

```
public class A {
    private final String foo;
    private final int bar;
    private final Date baz;
} 
```

然后我们写：

```
public abstract class AProperty<T> {
    public static final AProperty<String> FOO = new AProperty<String>(String.class) {};
    public static final AProperty<Integer> BAR = new AProperty<Integer>(Integer.class) {};
    public static final AProperty<Date> BAZ = new AProperty<Date>(Date.class) {};

    public final Class<T> propertyClass;

    private AProperty(Class<T> propertyClass) {
        this.propertyClass = propertyClass;
    }
} 
```

和：

```
public class APropertyMap {
    private final Map<AProperty<?>, Object> properties = new HashMap<AProperty<?>, Object>();

    public <T> void put(AProperty<T> property, T value) {
        properties.put(property, value);
    }
    public <T> T get(AProperty<T> property) {
        return property.propertyClass.cast(properties.get(property));
    }
} 
```

高级设计模式和/或晦涩的 Java 技巧的爱好者会认为这是一个类型安全的异构容器。只是感谢我没有使用`getGenericSuperclass()`。

然后，回到目标类：

```
public A(APropertyMap properties) {
    foo = properties.get(AProperty.FOO);
    bar = properties.get(AProperty.BAR);
    baz = properties.get(AProperty.BAZ);
} 
```

这都是这样使用的：

```
APropertyMap properties = new APropertyMap();
properties.put(AProperty.FOO, "skidoo");
properties.put(AProperty.BAR, 23);
A a = new A(properties); 
```

仅仅为了 lulz，我们甚至可以给地图一个流畅的界面：

```
public <T> APropertyMap with(AProperty<T> property, T value) {
    put(property, value);
    return this;
} 
```

这让调用者可以写：

```
A a = new A(new APropertyMap()
    .with(AProperty.FOO, "skidoo")
    .with(AProperty.BAR, 23)); 
```

您可以对此进行许多小改进。`AProperty`可以更优雅地处理其中的类型。`APropertyMap`如果你喜欢那种东西，可以有一个静态工厂而不是构造函数，允许更流畅的代码风格。`APropertyMap`可以增长一个`build`调用`A`构造函数的方法，本质上把它变成一个构建器。

您还可以使其中一些对象更通用。`AProperty`并且`APropertyMap`可以具有执行功能位的通用基类，以及非常简单的`A`特定子类。

如果您感觉特别企业，并且您的域对象是 JPA2 实体，那么您可以使用元模型属性作为属性对象。这让地图/构建器做更多的工作，但它仍然很简单；我有一个在 45 行中工作的通用构建器，每个实体都有一个包含单个单行方法的子类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T22:00:33.947

一个有趣的选择是创建一个构造函数，该构造函数将 a`Map<String,Object>`作为输入，其中包含用户想要指定的值。

构造函数可以使用映射中提供的值（如果存在），否则可以使用默认值。

**编辑：**

我认为随机投票者完全忽略了这一点——这并不总是最好的选择，但它是一种有用的技术，有几个优点：

*   它简洁，避免了创建单独的构造函数/构建器类的需要
*   它允许参数集的简单编程构造（例如，如果您正在从解析的 DSL 构造对象）
*   这是一种经常使用并被证明可以在动态语言中工作的技术。您只需要编写体面的测试（无论如何您都应该这样做！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T23:01:52.543

拥有许多字段可能表明一个类做得太多。

也许您可以将类拆分为几个不可变的类，并将这些类的实例传递给其他类的构造函数。这将限制构造函数的数量。

# c++ - 硬件扫描码到ascii char转换

> ID：11378936
> 
> 赞同：1
> 
> 时间：2012-07-07T21:54:44.167
> 
> 标签：c++, windows, winapi, keyboard, ascii

是否有 Windows API 可以将硬件扫描代码转换为 ASCII 字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:21:01.273

[MapVirtualKeyEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646307%28v=vs.85%29.aspx)和[ToAsciiEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646318%28v=vs.85%29.aspx)是您正在寻找的 - 示例用法[here](http://www.gamedev.net/page/resources/_/technical/directx-and-xna/converting-scan-codes-to-ascii-r842)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T22:30:57.213

Windows 是一个 Unicode 操作系统，它并不特别喜欢 ASCII。它也不偏向世界各地人们使用机器的方式。

*由键盘输入事件（如 WM_KEYDOWN）产生的虚拟键*的映射由窗口过程执行。它产生一个 WM_CHAR 键消息，底层的 api 函数是 ToUnicodeEx()，也暴露给你。一个有很多参数的函数，lpKeyState 参数对于翻译修饰键和死键是必不可少的，比如 Alt+Gr 和 Shift。dwhkl 参数对于允许不同用户使用不同的键盘布局至关重要。您不想参与进行相同翻译的业务，尤其是键盘状态是进程本地属性。

但是 ToUnicodeEx() 是它所需要的。

# android - 在 android 回调中无法处理 TextView

> ID：11378937
> 
> 赞同：0
> 
> 时间：2012-07-07T21:55:10.287
> 
> 标签：android, google-tv

我正在尝试为 Google TV 制作遥控器。我想在设备成功连接后更改布局中的文本（TextView statusText）。但是当我尝试这样做时出现异常：“07-07 22:42:20.870: E/AndroidRuntime(5750):android.view.ViewRootImpl$CalledFromWrongThreadException: 只有创建视图层次结构的原始线程才能触摸其视图."

感谢任何帮助/指针

这是我的 MainActivity.java 和 main.xml：

MainActivity.java：

```
package uk.co.mypack.gtvremote;

//imports removed for paste

public class MainActivity extends Activity implements ClientListener{

    private AnymoteSender anymoteSender;
    private TextView statusText;
    protected AnymoteClientService mAnymoteClientService;
    private static String statusPrefix = "Status: ";
    private Context mContext;
    private ProgressBar progressBar;

    private Handler handler;
    private TouchHandler touchPadHandler;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        progressBar = (ProgressBar) findViewById(R.id.a_progressbar);
        progressBar.setVisibility(View.VISIBLE);

        mContext = this;

        ImageButton upArrowButton = (ImageButton) findViewById(R.id.upArrow);
        ImageButton leftArrowButton = (ImageButton) findViewById(R.id.leftArrow);
        ImageButton centreButton = (ImageButton) findViewById(R.id.centreButton);
        ImageButton rightArrowButton = (ImageButton) findViewById(R.id.rightArrow);
        ImageButton downArrowButton = (ImageButton) findViewById(R.id.downArrow);

        upArrowButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                sendKeyEvent(KeyEvent.KEYCODE_DPAD_UP);
            }
        });

        leftArrowButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                sendKeyEvent(KeyEvent.KEYCODE_DPAD_LEFT);
            }
        });

        centreButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                sendKeyEvent(KeyEvent.KEYCODE_DPAD_CENTER);
            }
        });

        rightArrowButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                sendKeyEvent(KeyEvent.KEYCODE_DPAD_RIGHT);
            }
        });

        downArrowButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                sendKeyEvent(KeyEvent.KEYCODE_DPAD_DOWN);
            }
        });

        handler = new Handler();

        // Bind to the AnymoteClientService
        Intent intent = new Intent(mContext, AnymoteClientService.class);
        bindService(intent, mConnection, Context.BIND_AUTO_CREATE);
        statusText = (TextView) findViewById(R.id.statusText);

    }

    /** Defines callbacks for service binding, passed to bindService() */
    private ServiceConnection mConnection = new ServiceConnection() {
        /*
         * ServiceConnection listener methods.
         */
        @Override
        public void onServiceConnected(ComponentName name, IBinder service) {

            mAnymoteClientService = ((AnymoteClientService.AnymoteClientServiceBinder) service)
                    .getService();
            mAnymoteClientService.attachClientListener(MainActivity.this);
        }

        @Override
        public void onServiceDisconnected(ComponentName name) {
            mAnymoteClientService.detachClientListener(MainActivity.this);
            mAnymoteClientService = null;   
        }

    };

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    @Override
    public void onConnected(AnymoteSender anymoteSender) {
        if (anymoteSender != null) {
            // Send events to Google TV using anymoteSender.
            // save handle to the anymoteSender instance.
            this.anymoteSender = anymoteSender;

            //THIS IS WHERE I AM TRYING TO SET THE TEXTVIEW

            TextView localStatusText = (TextView) findViewById(R.id.statusText);
            localStatusText.setText(statusPrefix + "Connected to GoogleTV");

            //ABOVE IS WHERE I AM TRYING TO SET THE TEXTVIEW

            // Attach touch handler to the touchpad view
            touchPadHandler = new TouchHandler(
                    findViewById(R.id.touchPad), Mode.POINTER_MULTITOUCH, anymoteSender);

        } else {
            statusText.setText(statusPrefix + "Connection attempt failed, cant find send handler");
            //attempt to connect again?
            //attemptToConnect();
        }

        // Hide the progressBar once connection to Google TV is established.
        handler.post(new Runnable() {
            public void run() {
                progressBar.setVisibility(View.INVISIBLE);
            }
        });
    }

    @Override
    public void onDisconnected() {
        // show message to tell the user about disconnection.
        statusText.setText(statusPrefix + "Disconnected");
        // Try to connect again if needed. This may be need to be done via button
        attemptToConnect();
        this.anymoteSender = null;

    }

    @Override
    public void onConnectionError() {
        // show message to tell the user about disconnection.
        statusText.setText(statusPrefix + "Connection error encountered");
        // Try to connect again if needed.
        attemptToConnect();
        this.anymoteSender = null;

    }

    @Override
    protected void onDestroy() {
        if (mAnymoteClientService != null) {
            mAnymoteClientService.detachClientListener(this);
        }
        unbindService(mConnection);
        super.onDestroy();
    }

    public void attemptToConnect()
    {
        //stub to invoke connection attempt
    }

    private void sendKeyEvent(final int keyEvent) {
        // create new Thread to avoid network operations on UI Thread
        if (anymoteSender == null) {
            Toast.makeText(MainActivity.this, "Waiting for connection",
                    Toast.LENGTH_LONG).show();
            return;
        }
        anymoteSender.sendKeyPress(keyEvent);
    }
} 
```

主要.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/control_message"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:padding="@dimen/padding_medium"
        android:text="@string/control_msg"
        android:textSize="90dp"
        tools:context=".MainActivity" />

    <LinearLayout
        android:id="@+id/middlePanel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/statusText"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Status: Disconnected - startup"
            android:textSize="20dp" />

        <ImageView
            android:id="@+id/touchPad"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:src="@drawable/greysquare" 
            />

        <LinearLayout
            android:layout_width="0dp"
            android:layout_weight="1"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:orientation="vertical" >

            <ImageButton
                android:id="@+id/upArrow"
                android:layout_width="150dp"
                android:layout_height="150dp"
                android:background="@drawable/blackuparrow" />

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center"
                android:orientation="horizontal" >

                <ImageButton
                    android:id="@+id/leftArrow"
                    android:layout_width="150dp"
                    android:layout_height="150dp"
                    android:background="@drawable/blackleftarrow" />

                <ImageButton
                    android:id="@+id/centreButton"
                    android:layout_width="150dp"
                    android:layout_height="150dp"
                    android:background="@drawable/emptycircle"
                    android:paddingBottom="10dp"
                    android:paddingLeft="10dp"
                    android:paddingRight="10dp"
                    android:paddingTop="10dp" />

                <ImageButton
                    android:id="@+id/rightArrow"
                    android:layout_width="150dp"
                    android:layout_height="150dp"
                    android:background="@drawable/blackrightarrow" />
            </LinearLayout>

            <ImageButton
                android:id="@+id/downArrow"
                android:layout_width="150dp"
                android:layout_height="150dp"
                android:background="@drawable/blackdownarrow" />
        </LinearLayout>
    </LinearLayout>
<ProgressBar
        android:id="@+id/a_progressbar"
        style="@android:style/Widget.ProgressBar.Large"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center" />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T07:10:33.610

onConnected() 回调不在主 UI 线程上调用，而是在服务使用的单独线程上调用。所以它无法访问在主 UI 线程中创建的 TextView。您应该做的是在主 UI 线程中创建一个处理程序，然后使用该处理程序发布一个可对 TextView 进行更改的可运行文件。您可以在 Android 开发者网站上阅读更多关于处理程序的信息。

# iphone - UIScrollView 的子视图之间的差距

> ID：11378945
> 
> 赞同：0
> 
> 时间：2012-07-07T21:56:21.490
> 
> 标签：iphone, uiscrollview, subviews, gaps-in-visuals

我有 UIScrollView 的两个子视图。一个是textView，另一个是tableView。我根据其内容使 textview 的高度灵活，但我有一个问题。如果 textview 中的文本（也就是解析出来的数据）很小，那么 textview 和 tableview 之间就有很大的差距。或者如果文本太大，那么它会覆盖 tableview。无论文本视图的内容量如何，如何在 textview 和 tableview 之间保持相同的差距？这一切都在IB中完成。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T19:11:22.613

您必须像您的文本视图高度一样动态处理 textview 和 tableview 位置，并且 y 轴是 y 轴 10；身高40；现在在 tableview setframe:cgrectmake(你的 X 坐标，textview.frame.size.height+20)

因此，如果您的 textview 高度为 60 而不是 tableview y 点为 60+20，则它始终显示 textview 和 tableview 之间的相同差异

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T14:23:52.893

```
- (void)loadView 
{    
    CGRect pagingScrollViewFrame = [self frameForPagingScrollView];
    pagingScrollView = [[UIScrollView alloc] initWithFrame:pagingScrollViewFrame];
    pagingScrollView.pagingEnabled = YES;
    pagingScrollView.backgroundColor = [UIColor blackColor];
    pagingScrollView.showsVerticalScrollIndicator = NO;
    pagingScrollView.showsHorizontalScrollIndicator = NO;
    pagingScrollView.contentSize = CGSizeMake(pagingScrollViewFrame.size.width * [self imageCount],
                                              pagingScrollViewFrame.size.height);
    pagingScrollView.delegate = self;
    self.view = pagingScrollView;

}

- (CGRect)frameForPagingScrollView {
    CGRect frame = [[UIScreen mainScreen] bounds];
    frame.origin.x -= PADDING;
    frame.size.width += (2 * PADDING);
    return frame;
}

- (CGRect)frameForPageAtIndex:(NSUInteger)index {
    CGRect pagingScrollViewFrame = [self frameForPagingScrollView];

    CGRect pageFrame = pagingScrollViewFrame;
    pageFrame.size.width -= (2 * PADDING);
    pageFrame.origin.x = (pagingScrollViewFrame.size.width * index) + PADDING;
    return pageFrame;
} 
```

# algorithm - 用于在彼此之上绘制像素的算法（使用 alpha）

> ID：11378946
> 
> 赞同：1
> 
> 时间：2012-07-07T21:56:29.343
> 
> 标签：algorithm, graphics2d

我正在寻找在目标像素之上绘制源像素时用于计算输出像素值的算法。当源像素没有 alpha 时，显然我可以将输出像素设置为等于源像素。当源有 alpha 时怎么办？如何计算新的 alpha 和 RGB 值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:06:12.080

输出只是目标和源的加权和。

```
output = alpha * source + (1 - alpha) * destination 
```

对三个 RGB 通道中的每一个都执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T22:03:05.097

这完全取决于您要使用哪种混合算法：乘法、加法等。例如，加法只会将元素相加：

`RGBA(1, 2, 3, 4) + RGBA(5, 6, 7, 8) = RGBA(6, 8, 10, 12)`

乘法混合（显然）乘以（在某些情况下交叉乘）RGBA 基准。您还可以减去通道、除以或进行任何其他花哨的代数数学运算。无论您选择实施哪种混合方法，Alpha 通道通常都是附加的——除非您有特定的理由不这样做（即掩蔽）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T22:09:58.213

实际上，您还遇到了预乘 alpha 与非预乘 alpha。不过，默认值应该是预乘的，所以我将使用它。

公式很简单：

```
DestinationRGB = ImageRGB+(1-ImageAlpha)*DestinationRGB 
```

# drupal - 带有zen主题的drupal7中缺少管理员覆盖

> ID：11378947
> 
> 赞同：2
> 
> 时间：2012-07-07T21:56:44.353
> 
> 标签：drupal, drupal-7, drupal-modules

我正在使用 Zen 主题在 Drupal 7 中创建一个站点。当我开始时，每当我将鼠标悬停在允许我配置块或生成它的视图（如果适用）的块上时，它就会有一个管理覆盖。最近，菜单消失了，我不知道如何找回它。

我查看了我的模块，并注意到有些模块已被禁用（视图 UI、仪表板和覆盖等）。我重新启用了模块，但我的覆盖仍然没有返回。我该如何调试这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T22:07:14.620

您只需要再启用一个模块...上下文链接。

# jquery - 无论如何都不能停止形式

> ID：11378950
> 
> 赞同：0
> 
> 时间：2012-07-07T21:56:55.850
> 
> 标签：jquery, events, submit

我用它来阻止：

```
$("#searchform").submit(function(e){
    e.stopPropagation();
    e.preventDefault();
} 
```

问题是，如果我在此之后使用 Ajax，提交表单不会停止。任何人都知道如何在不触发再次提交的情况下进行 ajax 查询。

```
ajax_function(options){
    $.ajax(options);
}

$("#searchform").submit(function(e){
    e.stopPropagation();
    e.preventDefault();
    ajax_function(options);
} 
```

此代码触发表单在 Chrome 中提交

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:59:04.560

```
ajax_function(options){
$.ajax(options);
} 
```

一定是

```
function ajax_function(options) {
    $.ajax(options);
} 
```

否则，这是一个语法错误，您的事件永远不会被注册。

# ios - 如何在 iOS 中获取 Google Drive 中文件夹的标识符？

> ID：11378952
> 
> 赞同：4
> 
> 时间：2012-07-07T21:57:35.833
> 
> 标签：ios, google-drive-api

我需要使用我的 iOS 应用将文件上传到 Google Drive 上的特定文件夹。我知道文件夹的名称，但为了将其上传到特定文件夹，我还需要指定文件夹的标识符。这是我的代码的一部分，我在其中硬编码了目标文件夹的标识符。所以，我的问题是如何以编程方式找到目标文件夹的标识符。

```
 NSString *mimeType = @"image/png";
    NSData *imageData = UIImagePNGRepresentation(imageView.image);
GTLUploadParameters *uploadParameters = [GTLUploadParameters uploadParametersWithData:imageData MIMEType:mimeType];
GTLDriveFile *fileObj = [GTLDriveFile object];
fileObj.title = @"this_is_a_test.png";
GTLDriveParentReference *parentRef = [GTLDriveParentReference object];
parentRef.identifier = @"0B1Em3SqS0WHrQi15SHB4OHRGd2c";
fileObj.parents = [NSArray arrayWithObject:parentRef]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-10T08:37:07.623

可以使用查询字符串参数将驱动器列表查询限制为获取文件夹：

```
GTLQueryDrive *query = [GTLQueryDrive queryForFilesList];
query.q =  [NSString stringWithFormat:
    @"mimeType='application/vnd.google-apps.folder' and title='%@' and trashed=false",
    title]; 
```

但文件和文件夹标题在 Google Drive 中并不是唯一的，因此用户帐户中可能有许多同名的文件夹或文件。

# c# - 不接受 ItemEventArgs 或 ItemClickEventArgs 作为参数

> ID：11378956
> 
> 赞同：1
> 
> 时间：2012-07-07T21:59:02.063
> 
> 标签：c#, android, monodevelop

我正在关注这个简短的教程：[http ://docs.xamarin.com/android/tutorials/User_Interface/list_view](http://docs.xamarin.com/android/tutorials/User_Interface/list_view)

这行有问题的代码

```
ListView.ItemClick += delegate (object sender, ItemEventArgs args) { //... 
```

产生以下错误/警告

> 警告 CS0618：“Android.Widget.ItemEventArgs”已过时：“改用 AdapterView.ItemClickEventArgs”(CS0618) (HelloListView)
> 
> 错误 CS1661：无法将匿名方法转换为委托类型“System.EventHandler”，因为参数类型与委托参数类型不匹配 (CS1661) (HelloListView)
> 
> 错误 CS1678：参数 2 声明为“Android.Widget.ItemEventArgs”类型，但应为“Android.Widget.AdapterView.ItemClickEventArgs”（CS1678）（HelloListView）

我的解决方案是来自简短教程的逐字记录。如果我按照警告/错误的建议更改`ItemEventArgs args`为`ItemClickEventArgs args`，那么我会收到一个不同的错误，表明它是`does not exist in the current context`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-06T18:08:42.030

```
aListView.ItemClick += (object sender, AdapterView.ItemClickEventArgs args) 
  => ItemClicked(sender, args);

public void ItemClicked(object sender, AdapterView.ItemClickEventArgs args)
{
  try
  {
    String fName = ((TextView)args.View).Text;
    // Do something with clicked item text
  }
  catch (Exception) { throw; }
} 
```

# jquery - jquery过滤器选择器不匹配

> ID：11378960
> 
> 赞同：0
> 
> 时间：2012-07-07T21:59:21.777
> 
> 标签：jquery, filter, selector

我对一个找不到问题的简单问题感到沮丧：

我想通过查找由于不同标准而被标记为“已过滤”的任何单元格来过滤表中的行。所以最后一种行过滤类型“选择”过滤的单元格来决定是否要过滤包含的行。

这是一个简单的例子：

html:

```
<table>   <tbody>
    <tr class="">
        <td class=""><span>1-1</span></td>
        <td class=""><span>1-2</span></td>
        <td class=""><span>1-3</span></td>      
    </tr>
    <tr class="">
        <td class=""><span>2-1</span></td>
        <td class="filtered"><span>2-2</span></td>
        <td class="filtered"><span>2-3</span></td>      
    </tr>
    <tr class="">
        <td class=""><span>3-1</span></td>
        <td class="filtered"><span>3-2</span></td>
        <td class=""><span>3-3</span></td>      
    </tr>   </tbody> </table> 
```

​CSS：

```
table { margin: 20px; }
td { padding:4px; }
td span { background-color: silver; }
tr.filtered { display:none; }​ 
```

js/jquery：

```
$('table tbody tr').filter('td.filtered').addClass('filtered'); 
```

我为此准备了一个提琴手：http: [//jsfiddle.net/dtsZX/3/](http://jsfiddle.net/dtsZX/3/)

我希望第 2 行和第 3 行添加“过滤”类，从而被隐藏。然而，这是行不通的。jquery 命令有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T22:05:29.547

你想要`:has`：

```
$('table tbody tr:has(td.filtered)').addClass('filtered'); 
```

`tr`s自己永远比不上`td`！相反，您想要过滤*以 a**作为其后代*`tr`的 s 。*`td`*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T22:03:47.717

如果要在 tr 中添加“过滤”：

```
$('table tbody tr').find("td.filtered").parent().addClass("filtered") 
```

代替：

```
$('table tbody tr').filter('td.filtered').addClass('filtered'); 
```

[http://jsfiddle.net/dtsZX/7/](http://jsfiddle.net/dtsZX/7/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T22:05:38.070

过滤方法不能以这种方式工作。请参阅[JQuery 文档](http://api.jquery.com/filter/)。

过滤器实际上返回在前一个选择器中选择的项目，这些项目**也**与方法中的选择器匹配`filter`。

尝试使用这个：`$('table tbody tr td.filtered').parent().addClass('filtered');`

或`:has`另一个回答者提到的选择器（如果使用 jQuery 1.1.4 或更高版本）。

# django - 使用 django crispyforms 获取我的表单对象不可调用的 TypeError

> ID：11378961
> 
> 赞同：1
> 
> 时间：2012-07-07T21:59:22.310
> 
> 标签：django, django-crispy-forms

我第一次使用 django-crispyforms。

当我尝试使用我使用 django-crispyforms 为我的模型创建的表单添加对象时，我收到以下错误：

`TypeError: 'requestform' object is not callable`

特别是在我的views.py中这行有问题：

`new_request = formtoaddrequest(commit=False)`

知道这个错误消息是什么意思吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:22:24.493

嗯，这意味着你不应该打电话给它。你为什么叫它？这似乎是一件奇怪的事情。也许你的意思是`formtoaddrequest.save(commit=False)`？

# jstree - jsTree 搜索：显示子节点

> ID：11378965
> 
> 赞同：5
> 
> 时间：2012-07-07T22:00:07.477
> 
> 标签：jstree

如何让 jsTree 隐藏不匹配的元素，但仍显示匹配元素的子节点？

据我所知，只有两种可能性，都不适合这种情况。您可以通过设置让 jsTree 完全不隐藏任何元素

```
show_only_matches: false 
```

或者您可以通过设置使其隐藏所有不匹配的元素

```
 show_only_matches: true 
```

但是这个选项也隐藏了匹配节点的子节点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T13:14:03.683

最后，我找到了解决方案，虽然它看起来不太好，但它确实有效。只需将找到的元素传递给*enableSubtree()* -函数，它就会显示节点并注意正确的外观（即正确显示和隐藏虚线）。

```
enableSubtree = function(elem) {
  elem.siblings("ul:first").find("li").show();
  return correctNode(elem.siblings("ul:first"));
};

correctNode = function(elem) {
  var child, children, last, _j, _len1, _results;
  last = elem.children("li").eq(-1);
  last.addClass("jstree-last");
  children = elem.children("li");
  console.log(children);
  _results = [];
  for (_j = 0, _len1 = children.length; _j < _len1; _j++) {
    child = children[_j];
    _results.push(correctNode($(child).children("ul:first")));
  }
  return _results;
}; 
```

此函数的调用可能如下所示：

```
enableSubtree($(".jstree-search")) 
```

因为所有找到的节点都会收到 CSS 类*.jstree-search*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-08T16:56:08.933

```
“搜索” ： {
   “show_only_matches”：是的，
   “show_only_matches_children”：真
}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T10:44:34.407

您是否尝试过用类似的东西重载“search.jstree”？（使用 show_only_matches==false）

```
 $("#mytreecontainerid").bind("search.jstree", function (e, data) {
   // close the whole tree if a search text in set
   if (data.rslt.str.length>0) $("#mytreecontainerid").jstree('close_all');

   // open the found nodes' parent
   for (var i = 0 ; i<data.rslt.nodes.length ; i++) {
     data.inst._get_parent(data.rslt.nodes[i]).open_node(this, false);
     /* here you can do any additional effect to your node */
   }
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-02T10:47:22.703

这是我为过滤所做的简单代码。

```
 filterTree = function (elem) {
        $('li a', elem).not(".jstree-search").parent().css('display', 'none');
        $('a.jstree-search', elem).parentsUntil(elem, 'li').css('display', 'block');
    }; 
```

并用 jstree 实例调用它..

```
 filterTree($treeVar); 
```

它可能不是最佳解决方案，但它可以完美运行:)

# c++ - C ++按值获取数组元素的索引

> ID：11378973
> 
> 赞同：6
> 
> 时间：2012-07-07T22:01:09.413
> 
> 标签：c++, arrays, stl, indexing

到目前为止，我一直将数组存储在一个向量中，然后循环遍历该向量以找到匹配的元素，然后返回索引。

在 C++ 中有没有更快的方法来做到这一点？我用来存储数组的 STL 结构对我来说并不重要（它不必是向量）。我的数组也是唯一的（没有重复的元素）并且是有序的（例如，一个及时向前的日期列表）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T22:03:22.787

由于元素已排序，因此您可以使用二进制搜索来查找匹配的元素。C++ 标准库具有`std::lower_bound`可用于此目的的算法。为了清晰和简单，我建议将其包装在您自己的二进制搜索算法中：

```
/// Performs a binary search for an element
///
/// The range `[first, last)` must be ordered via `comparer`.  If `value` is
/// found in the range, an iterator to the first element comparing equal to
/// `value` will be returned; if `value` is not found in the range, `last` is
/// returned.
template <typename RandomAccessIterator, typename Value, typename Comparer>
auto binary_search(RandomAccessIterator const  first,
                   RandomAccessIterator const  last,
                   Value                const& value,
                   Comparer                    comparer) -> RandomAccessIterator
{
    RandomAccessIterator it(std::lower_bound(first, last, value, comparer));
    if (it == last || comparer(*it, value) || comparer(value, *it))
        return last;

    return it;
} 
```

（C++ 标准库有一个`std::binary_search`, 但如果范围包含该元素，它返回一个`bool`: ，否则。如果你想要一个元素的迭代器，它就没有用了。）`true``false`

一旦有了元素的迭代器，就可以使用`std::distance`算法来计算范围内元素的索引。

这两种算法在任何随机访问序列（包括`std::vector`普通数组和普通数组）中都同样适用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-07T22:10:36.163

如果要将值与索引相关联并快速找到索引，可以使用`std::map`或`std::unordered_map`。您还可以将这些与其他数据结构（例如 a`std::list`或`std::vector`）结合起来，具体取决于您要对数据执行的其他操作。

例如，在创建向量时，我们还创建了一个查找表：

```
vector<int> test(test_size);
unordered_map<int, size_t> lookup;
int value = 0;
for(size_t index = 0; index < test_size; ++index)
{
    test[index] = value;
    lookup[value] = index;
    value += rand()%100+1;
} 
```

现在要查找索引，您只需：

```
size_t index = lookup[find_value]; 
```

使用基于哈希表的数据结构（例如 unordered_map）是一种相当经典的空间/时间折衷方案，当您需要进行大量查找时，这种“反向”查找操作的二分查找性能优于二分查找。另一个优点是它在向量未排序时也有效。

为了好玩:-) 我在 VS2012RC 中做了一个快速基准测试，将 James 的二进制搜索代码与线性搜索和使用 unordered_map 进行查找进行了比较，所有这些都在向量上： ![各种查找索引方法的性能](../Images/392d09ec9cfc86262f74386e8af2687c.png)

对于〜50000个元素，unordered_set（x3-4）明显优于表现出预期的O（log N）行为的二分搜索，有点令人惊讶的结果是unordered_map在10000个元素之后失去了它的O（1）行为，大概是由于散列冲突，也许是一个实施问题。

编辑：无序地图的 max_load_factor() 为 1，因此应该没有冲突。对于非常大的向量，二分查找和哈希表之间的性能差异似乎与缓存相关，并且取决于基准中的查找模式。

[在 std::map 和 std::unordered_map 之间进行选择](https://stackoverflow.com/questions/3902644/choosing-between-stdmap-and-stdunordered-map)讨论了有序映射和无序映射之间的区别。

# c# - 与 Mono C# 的蓝牙通信

> ID：11378974
> 
> 赞同：7
> 
> 时间：2012-07-07T22:01:19.327
> 
> 标签：c#, mono, bluetooth, rfcomm

我正在尝试通过蓝牙在 PC（Linux 32 位）和硬件设备之间建立串行连接。

我已经使用cutecom 测试了系统。有用。波特率 115200`/dev/rfcomm0`等...

现在我正在尝试使用 Mono 创建一个客户端软件，以便能够实现通信协议。我已经测试了`SerialPort`对象：

```
 SerialPort mySerial;
    mySerial = new SerialPort("/dev/rfcomm0", 115200);
    mySerial.Open();
    mySerial.ReadTimeout = 1000; 
```

它不起作用。我已经通过有线串行连接在 上测试了系统`/dev/ttyACM0`，它工作正常。所以我不认为这是方法。

我尝试使用`FileStream`但`StreamReader`抛出`Exception.IO: WIN32 IO returned 997`.

如何使用带有 Mono C# 的蓝牙设备进行串行连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-29T14:09:50.777

从 bluez 5 开始，[dbus 是](http://blog.mrgibbs.io/bluetooth-pairing-with-bluez-and-dbus/)与 bluez 和 interop 交互的首选方法。[这里](http://blog.mrgibbs.io/get-on-d-bus/)有一系列关于这个主题的帖子，基本上它涉及连接到 dbus 并执行以下操作。

*   注册配对代理
*   配对设备
*   注册串行 / rfcomm 配置文件
*   向您要连接的设备发出信号并在您的配置文件对象上等待连接
*   从返回的文件描述符对象打开一个流。

一旦你有了流，你就可以对流执行所有常见的读/写操作，就像你将它作为串行端口打开一样。

# android - 如何阅读更新的共享偏好？

> ID：11378975
> 
> 赞同：1
> 
> 时间：2012-07-07T22:01:33.267
> 
> 标签：android, sharedpreferences

我有两个活动：一个（SettingsActivity），它在 onStop() 中保存首选项，如下所示：

```
SharedPreferences.Editor editor = getSharedPreferences("myprefs", Context.MODE_PRIVATE).edit();

editor.putString("login", etLogin.getText().toString());
editor.putString("password", etPassword.getText().toString());

editor.commit(); 
```

第二个（MainActitivy），它在 onResume() 中读取它们，例如

```
SharedPreferences prefs = activity.getSharedPreferences("myprefs", Context.MODE_PRIVATE);
prefs.getString(...); 
```

当我更改设置并返回主要活动时，会加载旧值！我必须再次打开 SettingsActivity 并再次返回，以进行更改。

onStop() 是否在 onResume() 旁边的单独线程中运行保存例程，因此在读取时，尚未提交更改？如何实现正确的行为？

肮脏的解决方案想法：我正在考虑一个单例，它包含我的偏好并具有保存（）和加载（），但这是一个丑陋的解决方案，我想知道如何正确地做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T22:26:47.073

如果没有，SettingsActivity 是否已停止，您必须调用 finish()；保存用户名和密码后调用 onstop() 方法（[活动生命周期）。](http://developer.android.com/images/activity_lifecycle.png)

如果您只是调用 save 方法并通过点击后退按钮返回主活动，则不会触发 onStop() 方法。因为 SettingsActivity 仍在后台运行并暂停。

# python - 如何使用 gitpython 自动推送到 repo

> ID：11378980
> 
> 赞同：3
> 
> 时间：2012-07-07T22:02:12.970
> 
> 标签：python, git, gitpython

我正在尝试制作一个 python 脚本来检查我的 git 本地工作文件夹中的更改，并自动将它们推送到在线仓库。目前只能手动使用 git 来完成。我想知道，在没有人工干预的情况下，脚本需要什么才能做到这一点。

我在 shell 中输入的命令是：

```
#for checking the status, and determining if there are untracked files
git status

#if there are untracked files...add them
git add .

#add my commit message
git commit -m "7/8/2012 3:25am"

#push it to my online repo
git push origin master

#check if changes came on remote
git diff origin/master

#merge my repo with origin
git merge origin/master 
```

执行 git push 时，您总是需要输入用户名/密码。我知道 git 有办法解决这个问题，包括制作 ssh 密钥等等。但我假设 GitPython 有某种方式可以做到这一点。我的意思是我们可以通过代码传递用户名/密码，或者使用前者。那么当我使用 GitPython 时，我有哪些关于身份验证的选项？

**编辑：**有些应用程序实际上会生成 ssh 密钥，例如 github 的 windows 应用程序。windows应用程序是如何做到这一点的？我的假设是肯定有一些 git api 用于它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T12:49:46.707

如果您使用 SSH 密钥进行身份验证，则使用[`ssh-agent`](http://en.wikipedia.org/wiki/Ssh-agent)加载您的密钥*一次*，然后您可以继续使用该密钥，而无需一直提供密码。

或者，如果您不关心密钥的安全性，您可以简单地生成一个没有密码的密钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T22:41:44.787

我查看了代码以确定，没有什么可以定义用于通信的用户名/密码组合。

这必须是它，因为`ssh`它没有让您事先提供密码的能力，它故意要求用户提示。唯一的用途是`ssh keys`用于自动化。

但是，如果你真的想打破你的极限。有用于非交互 ssh 通信的开源应用程序，无需使用`ssh keys`：http: [//sourceforge.net/projects/sshpass/](http://sourceforge.net/projects/sshpass/)

您编译并安装此应用程序并将通信协议定向`ssh://`到此应用程序，它*可能会*起作用。但是，我认为您不应该这样做；只需使用键，它们很棒 =)

# c++ - CMake如何在VC2010上设置正确的包含路径前缀？

> ID：11378981
> 
> 赞同：1
> 
> 时间：2012-07-07T22:02:14.037
> 
> 标签：c++, visual-studio-2010, visual-studio, opencv, cmake

所以基本上我正在使用 cmake 使用 opencv 为 Visual Studio 2010 创建项目。

我在 Windows 7 上遵循了本指南并且一切正常：[http ://redkiing.wordpress.com/2010/10/03/opencv-and-visual-studio-2010-with-cmake/](http://redkiing.wordpress.com/2010/10/03/opencv-and-visual-studio-2010-with-cmake/)

然后我用windows vista尝试过，cmake不断创建包含错误目录的项目，导致错误：`C:\Program Files\OpenCV\include\opencv\cv.h(63): fatal error "opencv2/core/core_c.h" no such file or directory`

Cmake 而是像这样设置正确的目录

```
C:\Program Files\OpenCV/modules/core/include
etc 
```

它像这样设置directroy：（并且它们不存在）：

```
C:\Program Files\myFirstOpenCVProject\Files/modules/core/include 
```

我必须手动包含所有正确的路径。有没有办法告诉 cmake 哪些是正确的路径？

Cmake 版本 2.8.8

## 编辑

我正在使用的 Cmake 文件：

```
SET( PROJECT_NAME project_name_goes_here )
PROJECT( ${PROJECT_NAME} )
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
FIND_PACKAGE( OpenCV REQUIRED )
ADD_EXECUTABLE( ${PROJECT_NAME} main.cpp )
TARGET_LINK_LIBRARIES( ${PROJECT_NAME} ${OpenCV_LIBS} ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T17:14:02.057

我不确定 FindOpenCV.cmake 模块是如何设置的，但我认为您需要添加以下行：

```
include_directories(${OpenCV_INCLUDE_DIR}) 
```

行前`add_executable`。

**编辑：**我假设你正在使用这个[FindOpenCV.cmake](http://opencv.willowgarage.com/wiki/FindOpenCV.cmake)

# php - 如何从 php 中的选择查询中获取列名？

> ID：11378982
> 
> 赞同：0
> 
> 时间：2012-07-07T22:02:29.683
> 
> 标签：php, mysql, select

我想执行一个 SELECT 查询，但我不知道要选择多少列。

喜欢：

```
select name, family from persons; 
```

我怎么知道要选择哪些列？

“我目前正在为用户执行查询设计一个站点。因此，当用户执行此查询时，我不会知道选择了哪些列。但是当我想显示结果并为用户绘制表格时，我应该知道哪个选定的列。”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-22T23:08:16.370

对于未知的查询字段，您可以使用此代码。

它为您提供每一行字段名称=> 数据。您甚至可以更改键以`''`按照数据库中列的顺序按 num 获取有序数组列。

```
$data = array();
while($row = mysql_fetch_assoc($query))
{
    foreach($row as $key => $value) {
        $data[$row['id']][$key] = $value;
    }
}
print_r($data); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T22:15:11.083

首先，准确了解您要检索的数据。然后查看数据库模式以找出数据库包含哪些表，以及这些表包含哪些列。

以下查询返回数据库中每个表的每一列的结果集：

```
SELECT table_name, column_name
FROM INFORMATION_SCHEMA.COLUMNS; 
```

在此[sqlfiddle](http://sqlfiddle.com/#!2/d41d8/1073)中，它返回以下结果集（为简洁起见，此处截断）：

```
TABLE_NAME  COLUMN_NAME
-----------------------
CHARACTER_SETS  CHARACTER_SET_NAME
CHARACTER_SETS  DEFAULT_COLLATE_NAME
CHARACTER_SETS  DESCRIPTION
CHARACTER_SETS  MAXLEN
COLLATIONS  COLLATION_NAME
COLLATIONS  CHARACTER_SET_NAME
COLLATIONS  ID
COLLATIONS  IS_DEFAULT
COLLATIONS  IS_COMPILED
COLLATIONS  SORTLEN 
```

现在我知道我可以像这样从表 CHARACTER_SETS 中选择列 CHARACTER_SET_NAME：

```
SELECT CHARACTER_SET_NAME
FROM CHARACTER_SETS; 
```

用于[`mysqli::query`](http://www.php.net/manual/en/mysqli.query.php)执行这些查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T23:23:29.963

如果我明白你在问什么，你可能想在结果集上使用 MySQLIi 和 fetch_fields 方法：

[http://us3.php.net/manual/en/mysqli-result.fetch-fields.php](http://us3.php.net/manual/en/mysqli-result.fetch-fields.php)

请参阅该页面上的示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-16T17:39:40.130

如果您想在所有情况下获取任何查询的列名，这并不容易。

如果至少返回一行，您可以直接从该行获取列。

但是当你想在没有结果显示表/导出到 CSV 的情况下获取列名时，你需要使用不是 100% 可靠的 PDO 函数。

```
// sample query - it might contain joins etc.
$query = 'select person.name, person.family, user.id from persons LEFT JOIN users ON persons.id = user.person_id';

$statement = $pdo->query($query);
$data = $statement->fetchAll(PDO::FETCH_CLASS);
if (isset($data[0])) {
  // there is at least one row - we can grab columns from it
  $columns = array_keys((array)$data[0]);
}
else {
   // there are no results - no need to use PDO functions
   $nr = $statement->columnCount();
   for ($i = 0; $i < $nr; ++$i) {
      $columns[] = $statement->getColumnMeta($i)['name'];
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T22:08:57.243

使用`mysql_query()`并执行此查询：

```
 SHOW COLUMNS FROM table 
```

例子：

```
<?php
 $result = mysql_query("SHOW COLUMNS FROM sometable");
 if (!$result) {
  echo 'Could not run query: ' . mysql_error();
  exit;
 }
 if (mysql_num_rows($result) > 0) {
  while ($row = mysql_fetch_assoc($result)) {
    print_r($row);
  }
 }
 ?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-07T22:13:16.603

使用`DESC table`或

**例子**

```
SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name='your_table'; 
```

**输出**

```
 column1,column2,column3 
```

# javascript - 使用数据表单个列过滤时如何忽略隐藏列

> ID：11378983
> 
> 赞同：2
> 
> 时间：2012-07-07T22:02:33.877
> 
> 标签：javascript, jquery, datatables

嗨，我正在使用带有[multi_filter_select单个列过滤的](http://datatables.net/examples/api/multi_filter_select.html)[jquery 数据表插件](http://datatables.net)（与单个列过滤相同，只是它们是选择框）。我有=隐藏的前 2 列，这导致过滤框显示在错误的列下，因为前 2 个过滤框用于隐藏列，将所有内容向下推 2 列。

这是我的代码：

用于单独过滤的 api 函数

```
(function($) {
/*
 * Function: fnGetColumnData
 * Purpose:  Return an array of table values from a particular column.
 * Returns:  array string: 1d data array
 * Inputs:   object:oSettings - dataTable settings object. This is always the last argument past to the function
 *           int:iColumn - the id of the column to extract the data from
 *           bool:bUnique - optional - if set to false duplicated values are not filtered out
 *           bool:bFiltered - optional - if set to false all the table data is used (not only the filtered)
 *           bool:bIgnoreEmpty - optional - if set to false empty values are not filtered from the result array
 * Author:   Benedikt Forchhammer <b.forchhammer@mind2.de>
 */
$.fn.dataTableExt.oApi.fnGetColumnData = function ( oSettings, iColumn, bUnique, bFiltered, bIgnoreEmpty ) {
        // check that we have a column id
       // alert(iColumn);
       // alert(oSettings);
        if ( typeof iColumn == "undefined" ) return new Array();

        // by default we only wany unique data
        if ( typeof bUnique == "undefined" ) bUnique = true;

        // by default we do want to only look at filtered data
        if ( typeof bFiltered == "undefined" ) bFiltered = true;

        // by default we do not wany to include empty values
        if ( typeof bIgnoreEmpty == "undefined" ) bIgnoreEmpty = true;

        // list of rows which we're going to loop through
        var aiRows;
        // use only filtered rows
        if (bFiltered == true) aiRows = oSettings.aiDisplay;
        // use all rows
        else aiRows = oSettings.aiDisplayMaster; // all row numbers
        //alert(aiRows);
        // set up data array   
        var asResultData = new Array();

        for (var i=0,c=aiRows.length; i<c; i++) {
       // alert("inloop");
                iRow = aiRows[i];
                var aData = this.fnGetData(iRow);
                var sValue = aData[iColumn];

                // ignore empty values?
                if (bIgnoreEmpty == true && sValue.length == 0) continue;

                // ignore unique values?
                else if (bUnique == true && jQuery.inArray(sValue, asResultData) > -1) continue;

                // else push the value onto the result data array
                else asResultData.push(sValue);
        }

        return asResultData;

}}(jQuery));

function fnCreateSelect( aData )
{
    var r='<select><option value=""></option>', i, iLen=aData.length;
    for ( i=0 ; i<iLen ; i++ )
    {
        r += '<option value="'+aData[i]+'">'+aData[i]+'</option>';
    }
    return r+'</select>';
} 
```

这是准备好的文件：

```
$(document).ready(function() {

var customerId = $("#customer").text();

    var fleetT = $('#fleetsTable').dataTable( {
        "bProcessing": true,
        "bServerSide": false,
        "sAjaxSource": "/fleet_processing.php",
        "aoColumns": [{"bVisible":false},{"bVisible":false},null,null,null,null,null],
         "fnInitComplete": function() {
                $("tfoot th").each( function ( i ) {
                    this.innerHTML = fnCreateSelect( fleetT.fnGetColumnData(i) );
                    $('select', this).change( function () {
                     //var realIndex = fleetT.oApi._fnVisibleToColumnIndex( fleetT.fnSettings(), jQuery('tfoot select').index(this));
                    fleetT.fnFilter( $(this).val(), i);
                } );
            } );
         }
    } ); 
```

和html：

```
<table cellpadding="0" cellspacing="0" border="0" class="display" id="fleetsTable">
    <thead>
        <tr>
            <th width="20%">fleet id</th>
            <th width="20%">customer id</th>
            <th width="20%">Equipo</th>
            <th width="25%">Marca y Modelo</th>
            <th width="25%">Filter Type</th>
            <th width="15%">Model Number</th>
            <th width="15%">quantity</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td colspan="5" class="dataTables_empty">Loading data from server</td>
        </tr>
    </tbody>
    <tfoot>
        <tr>
            <th>fleet id</th>
            <th>customer id</th>
            <th>Equipo</th>
            <th>Marca y Modelo</th>
            <th>Filter Type</th>
            <th>Model Number</th>
            <th>quantity</th>
        </tr>
    </tfoot>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T15:00:40.477

这是一个 hack，但您可以手动告诉正确的索引`fnGetColumnData()`

```
this.innerHTML = fnCreateSelect(table.fnGetColumnData(i + 2)); 
```

[http://jsfiddle.net/nicolapeluchetti/Yvpr5/](http://jsfiddle.net/nicolapeluchetti/Yvpr5/)

# objective-c - Analyzer 抱怨多线程 Cocoa 应用程序中可能存在资源泄漏

> ID：11378992
> 
> 赞同：1
> 
> 时间：2012-07-07T22:03:13.453
> 
> 标签：objective-c, macos, cocoa

好的，我是一位经验丰富的 C++ 开发人员。我在尝试构建一个相当充实的 Cocoa 应用程序时正在学习 Objective-C。在为这个项目做准备的同时，我用 Cocoa 做了一些更简单的应用程序，我认为我对大多数概念都有很好的掌握。

内存管理范式对我来说仍然有点模糊，所以我使用内存分析器构建以帮助我立即发现问题，老实说，它非常棒，并且在帮助我理解 Objective-C 内存管理方面做得更多的文档。

所以这是我的问题。

`performSelector:onThread:withObject:waitUntilDone:`我有两个使用该方法相互通信的线程。它们在彼此之间传递作为`withObject:`方法参数传入的对象。

示例代码如下：

```
- (BOOL)postMessage:(id <MessageTarget>)sender messageId:(NSInteger)msgId messageData:(void*)data
{
    // message is allocated and retained here. retain count will be +2
    Message* message = [[[Message alloc] initWithSender:sender messageId:msgId messageData:data] retain];
    if(message)
    {
        // message will be released in other thread.
        [self performSelectorOnMainThread:@selector(messageHandler:) withObject:message waitUntilDone:NO];
        // message is released here and retain count will be +1 or 0 depending on thread ordering
        [message release];
        return YES;
    }
    return NO;
}

- (BOOL)sendMessage:(id <MessageTarget>)sender messageId:(NSInteger)msgId messageData:(void*)data messageResult:(void**)result
{
    // message is allocated and retained here. retain count will be +2
    Message* message = [[[Message alloc] initWithSender:sender messageId:msgId messageData:data] retain];
    if(message)
    {
        // message will be released in other thread. retain count will be +1 on return
        [self performSelectorOnMainThread:@selector(messageHandler:) withObject:message waitUntilDone:YES];
        if(result)
            *result = [message result];
        // message is released here and retain count will be 0 triggering deallocation
        [message release];
        return YES;
    }
    return NO;
}

- (void)messageHandler:(Message*)message
{
    // message will have a retain count of +1 or +2 in here based on thread execution order
    if(message)
    {
        switch ([message messageId])
        {
            case 
               ...
            break;

            default:
               ...
            break;
        }
        // message is released here bringing retain count to +1 or 0 depending on thread execution ordering
        [message release];
    }
} 
```

分析器抱怨`Message`分配的对象可能泄漏`postMessage:`，`sendMessage:`但对象在`messageHandler:`. 代码运行正确并且没有泄漏，我怀疑分析器根本无法看到`Message`对象正在不同的线程中释放。

现在，如果您想知道为什么我在 post/send 方法中而不是在`messageHandler:`方法中进行第二次保留，那是因为该`postMessage:`方法是异步的，并且`[message release]`在 post 方法中可能会在`[message retain]`in之前执行`messageHandler:`，让我无效的对象。如果我在该方法的情况下这样做会很好，`sendMessage:`因为它是同步的。

那么有没有更好的方法来满足内存分析器的要求呢？或者也许是一种向内存分析器提示该对象实际上正在被释放的方法？

# **更新：**

Torrey 在下面提供了答案，但我想澄清我必须做的与他的建议不同的事情。

`messageHandler:`他建议在我的方法上使用一个属性，如下所示

```
- (void)messageHandler:(Message*) __attribute__((ns_consumed)) message; 
```

这不太奏效，因为对象正在被传递`performSelector:`，而分析器没有看到它被传递给`messageHandler:`

由于`performSelector:`调用是由 Cocoa 定义的，而不是由我定义的，所以我不能向它添加属性。

解决此问题的方法是将调用包装`performSelector:`如下：

```
- (void)myPerformSelector:(SEL)sel onThread:(NSThread*)thread withObject:(id) __attribute__((ns_consumed)) message waitUntilDone:(BOOL)wait;
{
    [self performSelector:sel onThread:thread withObject:message waitUntilDone:wait];
} 
```

然后您可以调用包装函数，分析器将看到该属性，而不会抱怨不平衡的保留/释放对。最后我不喜欢额外的间接来摆脱警告，所以我使用了预处理器，如下面的评论中所述。但我可以看到使用这种方法可能有用的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T05:03:52.677

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T00:25:11.097

`ns_consumed`通过明智地使用 Clang 的属性，您应该能够使分析器满意。正如您所建议的，这给内存分析器一个提示，即在函数调用完成后将向参数发送释放消息。你会像这样使用它：

```
- (void)messageHandler:(Message*) __attribute__((ns_consumed)) message 
```

[Clang 分析器文档](http://clang-analyzer.llvm.org/annotations.html#cocoa_mem)中有更多关于 Cocoa 内存管理注释的信息。您可能希望将属性设置包装在 NS_COSUMED 宏中，以便与该页面上建议的其他编译器兼容。

# php - PHP数组的问题，其中键是大整数

> ID：11378998
> 
> 赞同：5
> 
> 时间：2012-07-07T22:04:07.390
> 
> 标签：php, arrays, timestamp

我在这里要做的基本上是从`$stats`一个`$counts`包含四个数组的数组开始，其中每个数组是一对：**键是以毫秒为单位的时间戳，**而值是计数。我在 Windows 7 x64 上使用 PHP 版本 5.3.14。

问题是：为什么我得到否定数组键值以及如何避免这种情况？见`var_dump()`下文：

```
$stats = array();
$stats[] = array(
    'subtype' => 'small_text_message_user',
    'count'   => '6',
    'date'    => '2012-06-03'
);

$stats[] = array(
    'subtype' => 'small_text_message_auto',
    'count'   => '3',
    'date'    => '2012-07-03',
);

$stats = array(
    'subtype' => 'newsletter_auto',
    'count' => '11',
    'date' => '2012-07-16',
);

$counts = array();
$counts['small_text_message_user'] = array();
$counts['small_text_message_auto'] = array();
$counts['newsletter_user']         = array();
$counts['newsletter_auto']         = array();

foreach($data as $stat) :
    $millisecs = 1000 * strtotime($stat['date']);
    $count     = intval($stat['count']);
    $counts[$stat['subtype']][$millisecs] = $count;
    var_dump($millisecs, $count);
endforeach;

var_dump($counts); 
```

结果是错误的：

```
float 1338674400000

int 6

float 1341266400000

int 3

float 1342389600000

int 11

array (size=4)
  'small_text_message_user' => 
    array (size=1)
      -1355396352 => int 6
  'small_text_message_auto' => 
    array (size=1)
      1236603648 => int 3
  'newsletter_user' => 
    array (size=0)
      empty
  'newsletter_auto' => 
    array (size=1)
      -1935163648 => int 11 
```

一个例子（实际上有效）是一小段代码，我在其中生成一个“虚拟”数组：

```
public function createTimestampRangeFromDates(\DateTime $from,
    \DateTime $to = null)
{
    $start = strtotime($from->format('Y-m-d 00:00:00'));
    $limit = strtotime(sprintf('%s 00:00:00', $to ? $to->format('Y-m-d')
        : date('Y-m-d') . ' 00:00:00'));

    return range($start, $limit, 86400);
}

// Test
$start = new \DateTime('2012-06-27');
$end   = new \DateTime('2012-07-07'); // 10 days

$timestamps = createTimestampRangeFromDates($start, $end);
$millisecs  = array_combine($timestamps, array_fill(0, count($timestamps), 0));

var_dump($millisecs); 
```

这**工作正常，我得到大整数**作为键：

```
array (size=11)
  '1340748000000' => int 0
  '1340834400000' => int 0
  '1340920800000' => int 0
  '1341007200000' => int 0
  '1341093600000' => int 0
  '1341180000000' => int 0
  '1341266400000' => int 0
  '1341352800000' => int 0
  '1341439200000' => int 0
  '1341525600000' => int 0
  '1341612000000' => int 0 
```

哦，如果这很重要，那么这段代码的目的是执行以下操作：

```
$values = array_merge($millisecs, $counts['newsletter_auto']); 
```

那就是用真实值覆盖虚拟数组。

# 按照@hakre 的建议更新小测试用例

```
$result1 = array();
$result2 = array();
$test    = array('2012-06-03', '2012-07-03', '2012-07-16');

foreach($test as $date) :
    $result1[1000 * strtotime($date)] = 0;
    $result2[] = 1000 * strtotime($date);
endforeach;

var_dump($result1); // Not working
var_dump($result2); // Works 
```

结果显示 的否定键`$result1`。问题仅在于键，而不是值（因为值转换为`float`）：

```
array (size=3)
  -1355396352 => int 0
  1236603648 => int 0
  -1935163648 => int 0

array (size=3)
  0 => float 1338674400000
  1 => float 1341266400000
  2 => float 1342389600000 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T12:15:27.037

PHP 将数字（so、float 或 integer）数组索引转换为整数：

```
ckruse@lin ~ $ php -r 'var_dump(array(1.2 => "a"));'
array(1) {
  [1]=>
  string(1) "a"
} 
```

因此，如果您有一个非常大的数组索引，它会在计算时由 PHP 转换为浮点数，然后在用作索引时转换为整数。这意味着您会遇到大索引的整数溢出。

一个解决方案可以是使用字符串索引：

```
ckruse@lin ~ $ php -r 'var_dump(array(((string)1.2) => "a"));'
array(1) {
  ["1.2"]=>
  string(1) "a"
} 
```

编辑：http://php.net/manual/en/language.types.array.php 上的手册[说](http://php.net/manual/en/language.types.array.php)：

浮点数也被转换为整数，这意味着小数部分将被截断。例如，密钥 8.7 实际上将存储在 8 之下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T12:24:08.403

> 您是否在 PHP 文档中找到了说明数组键最大长度的内容？

PHP 手册对其进行了如下定义：*“键可以是整数或字符串。”* （[来源](http://php.net/manual/language.types.array.php)）

与每种数据类型一样，整数也是有限的。这在计算中很常见。根据软件或底层处理器处理整数的方式，它们可以翻转、地板或顶部。

在您的情况下，当越过边界时，它会变为最小的负数。我称之为*翻转*，其他人可能称之为*溢出* 或*环绕*。

`PHP_INI_Min`您可以使用和找出边界`PHP_INI_MAX`。

注意字符串键，也有限制，通常不能大于 2GB。只是说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T12:09:05.920

请阅读 php 文档中关于整数溢出的部分。[http://www.php.net/manual/en/language.types.integer.php#language.types.integer.overflow](http://www.php.net/manual/en/language.types.integer.php#language.types.integer.overflow)

> “如果 PHP 遇到超出整数类型边界的数字，它将被解释为浮点数。此外，导致数字超出整数类型边界的操作将返回浮点数。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-08T12:14:16.023

好的，一些研究表明**作为数组键的浮点数被截断为整数**。所以我的大浮点数被截断为整数会导致溢出。仍在寻找官方文档链接。

请参阅此（已关闭）错误[数组键从浮点数转换为整数](https://bugs.php.net/bug.php?id=32671)以及[本文](http://www.michikono.com/2007/01/04/php-array-keys-and-floats/)和此[拉取请求](https://github.com/yetzt/boxing/pull/3)。

**编辑**：在[PHP 文档](http://www.php.net/manual/en/language.types.array.php)中找到：

> 键可以是整数或字符串。该值可以是任何类型。
> 
> 此外，还会发生以下关键转换：
> 
> 浮点数也被转换为整数，这意味着小数部分将被截断。例如，密钥 8.7 实际上将存储在 8 之下。