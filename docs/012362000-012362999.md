# StackOverflow 问答 12362000-12362999

# c# - 两个如何在一个 MVC 应用程序上运行多个 Sql Server 2008 DB？

> ID：12362001
> 
> 赞同：0
> 
> 时间：2012-09-11T02:41:32.567
> 
> 标签：c#, asp.net-mvc-3, entity-framework-4

我有一个使用带有 Razor 的 MVC3 的应用程序，它与一个数据库完美配合。我现在在尝试访问第二个数据库时遇到此错误：

> 数据库“master”中的 CREATE DATABASE 权限被拒绝。

我假设向项目中添加另一个 DbContext 类与添加第一个预先创建的数据库的过程相同，因此我将第二个连接字符串添加到 web.config 中，如下所示：

```
<connectionStrings>
<add name="DbContext1" connectionString="Data Source=db1.server.com;Initial Catalog=dbName1;User Id=db1;Password=*&#!$;" providerName="System.Data.SqlClient" />
<add name="DbContext2" connectionString="Data Source=db2.server.com;Initial Catalog=dbName2;User Id=db2;Password=*&#!$;" providerName="System.Data.SqlClient" /> 
```

然后我将第二个 DbContext 类添加到应用程序中：

```
public class DbContext1 : DbContext
{
    public DbSet<Table1> Object1 { get; set; }

    public DbSet<Table2> Object2 { get; set; }

    public DbSet<Table3> Object3 { get; set; }

    public DbSet<Table4> Object4 { get; set; }
}

public class DbContext2 : DbContext
{

    public DbSet<Table1> Object5 { get; set; }
} 
```

当我尝试访问第二个数据库时出现问题。第一个数据库仍然像魅力一样工作，但由于某种原因，第二个数据库似乎正在尝试创建一个新数据库，而不是在连接字符串末尾读取现有数据库。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T02:46:59.503

尝试在类的构造函数中显式选择上下文：

```
public class DbContext1 : DbContext
{
    public DbContext1() : base("DbContext1")
    {
    }
    public DbSet<Table1> Object1 { get; set; }

    public DbSet<Table2> Object2 { get; set; }

    public DbSet<Table3> Object3 { get; set; }

    public DbSet<Table4> Object4 { get; set; }
}

public class DbContext2 : DbContext
{
    public DbContext2() : base("DbContext2")
    {
    }

    public DbSet<Table1> Object5 { get; set; }
} 
```

或者，重载构造函数以接受连接字符串，并在代码中调用它：

```
public class DbContext2 : DbContext
{
    public DbContext2(string connectionString)  : base (connectionString)
    {
    }

    public DbSet<Table1> Object5 { get; set; }
} 
```

然后当你创建一个新的上下文时：

```
var context = new DbContext2("DbContext2"); 
```

# java - 收集效率

> ID：12362005
> 
> 赞同：0
> 
> 时间：2012-09-11T02:42:00.640
> 
> 标签：java, android, performance, collections

我担心我正在开发一个应用程序，我只需要验证来自哈希表的数据。我有 8 个哈希表，我从中获取数据并进行验证。所有 8 个哈希表都具有相同的结构。我的问题是，如果我将数据放入 8 个哈希表中会更有效，还是将其更改为一个哈希表？每个哈希表有大约 100 个对象。

提前致谢。

你的，极客

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:12:10.417

我同意在这种情况下，大小是如此之小以至于微不足道。

也就是说，使用单个哈希表；否则你必须做 8 次检查才能找到一些东西，并且有 8 个哈希表结构的开销（根据定义，这些结构对用于执行良好的插槽有开销）。

如果您使用原始类型（甚至只是地图中键的原始类型），我强烈推荐 trove 高性能集合库（[GNU Trove](http://trove.starlight-systems.com/)）。它们是为高性能计算而编写的，在像 android 这样的环境中可以为您节省宝贵的内存和计算周期。

它们不是完整的替代品，但具有类似的功能......例如

```
TLongObjectHashMap<String> myMap; // a map from primitive long to strings 
myMap = new TLongObjectHashMap<String>();
myMap.put(4L, "Hello world"); // no boxing, so much less memory overhead, etc. 
```

# c++ - 是否可以防止在没有专门化的情况下使用 C++ 模板？

> ID：12362008
> 
> 赞同：3
> 
> 时间：2012-09-11T02:42:10.803
> 
> 标签：c++, templates, template-specialization

是否可以防止在没有专门化的情况下使用 C++ 模板？

例如，我有

```
template<class T>
void foo() {} 
```

而且我不希望在没有专门用于`foo<int>`or的情况下使用它`foo<char>`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T02:53:59.260

您应该能够声明该函数，而无需在通用情况下实际定义它。这将导致对非专业模板的引用发出未定义符号链接器错误。

```
template<class T>
void foo();

template<>
void foo<int>() {
    // do something here
} 
```

这对我来说很好用`clang++`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T07:16:57.817

您可以在函数体中使用未定义的类型。您将收到**编译时**错误消息：

```
template<class T> struct A;  
template<class T>  
void foo()  
{  
   typename A<T>::type a;  // template being used without specialization!!!
   cout << "foo()\n";  
}  
template<>  
void foo<int>()  
{  
   cout << "foo<int>\n";  
}  
template<>  
void foo<char>()  
{  
   cout << "foo<char>\n";  
}  
int main()  
{  
  foo<int>();  
  foo<char>();  
//  foo<double>();   //uncomment and see compilation error!!!
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T02:46:53.233

当 foo 函数有参数时，这是可能的。例如：template void foo(T param){} 现在，你可以调用 foo(1), foo('c') 而无需专门化。

# ios - 如何分离其他东西的字符串值？

> ID：12362009
> 
> 赞同：0
> 
> 时间：2012-09-11T02:42:16.290
> 
> 标签：ios, objective-c, ios4, uialertview

```
 UIAlertView *myAlert=[[UIAlertView alloc]
initWithTitle:@"Logging in" message:@"you are a member in our website \nWelcome Dear  %@ ",UserName.text
            delegate:self
            cancelButtonTitle:@"Done"
            otherButtonTitles:nil]; 
```

这段代码对我显示错误，因为我输入了字符串变量，它是一个名为“用户名”的文本字段的文本

那我怎么能把这条线分开呢？

`initWithTitle:@"Logging in" message:@"you are a member in our website \nWelcome Dear %@ ",UserName.text delegate:self`

因为错误在这里显示在delegate HELP这个词中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T10:42:48.103

使用以下格式：

```
UIAlertView *myAlert=[[UIAlertView alloc]
initWithTitle:@"Logging in" message:[NSString stringWithFormat:@"you are a member in our website \nWelcome Dear  %@ ",UserName.text]
            delegate:self
            cancelButtonTitle:@"Done"
            otherButtonTitles:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T06:33:26.497

试试这个：

```
NSString *alertstr=[NSString stringWithFormat:@"you are a member in our website \nWelcome Dear  %@",UserName.text];
UIAlertView *myAlert=[[UIAlertView alloc]
                          initWithTitle:@"Logging in" message:alertstr
                          delegate:self
                          cancelButtonTitle:@"Done"
                          otherButtonTitles:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:53:10.250

重组它如下：

```
NSString *psMsg = [NSString stringFromFormat: @"you are a member in our website \nWelcome Dear  %@ ", UserName.text, nil];
UIAlertView *myAlert=[[UIAlertView alloc]
    initWithTitle:@"Logging in" message:psMsg
    delegate:self cancelButtonTitle:@"Done"
    otherButtonTitles:nil]; 
```

分解事物，以便更容易调试和理解正在发生的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T12:15:14.290

这是因为您没有创建字符串作为参数。

您可以通过在行中声明您的字符串（选项 1）或将字符串创建移到 UIAlert 视图之外（选项 2）来解决此问题。

我喜欢对所有字符串使用本地化字符串（选项 3），因为它有助于从代码中获取字符串，允许字符串重用并有助于国际化。

选项1：

```
UIAlertView *myAlert=[[UIAlertView alloc]
                        initWithTitle:@"Logging in" 
                        message:[NSString stringWithFormat:@"you are a member in our website \nWelcome Dear  %@ ",UserName.text]
                        delegate:self
                        cancelButtonTitle:@"Done"
                        otherButtonTitles:nil]; 
```

选项 2：

```
NSString *alertstr=[NSString stringWithFormat:@"you are a member in our website \nWelcome Dear  %@",UserName.text];

UIAlertView *myAlert=[[UIAlertView alloc]
                          initWithTitle:@"Logging in" message:alertstr
                          delegate:self
                          cancelButtonTitle:@"Done"
                          otherButtonTitles:nil]; 
```

选项 3：

```
UIAlertView *myAlert=[[UIAlertView alloc]
                        initWithTitle:NSLocalizedString(@"Login-title", nil) 
                        message:NSLocalizedString(@"Login-message",nil)
                        delegate:self
                        cancelButtonTitle:NSLocalizedString(@"Done", nil)
                        otherButtonTitles:nil]; 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-09-11T07:04:08.653

我认为这是唯一的方法，当您显示该消息时无需显示登录。

```
UIAlertView *myAlert=[[UIAlertView alloc]initWithTitle:@"you are a member in our website Welcome Dear " message:mytext.text
                      delegate:self
                      cancelButtonTitle:@"Done"
                      otherButtonTitles:nil];

[myAlert show];
[myAlert release]; 
```

# emacs - Emacs 23 和 Emacs 24 之间的 Emacs 键绑定更改

> ID：12362012
> 
> 赞同：8
> 
> 时间：2012-09-11T02:42:28.490
> 
> 标签：emacs, key-bindings, emacs23, emacs24

我最近升级到 Emacs24，我的一些自定义键绑定因此而损坏。

根据[精美的手册，](http://www.gnu.org/software/emacs/manual/html_node/emacs/Named-ASCII-Chars.html)可以使 Emacs 停止将功能键与其 ASCII 控制代码混为一谈（例如，可以拥有`C-m`并`RET`绑定到不同的东西，或`C-i`和`TAB`，等等）。这一直是我对 Emacs 的一大不满，这些宝贵的“第一级”键盘快捷键被浪费在我已经在我的键盘上有专用键的东西上。在我的情况下，我想将它们绑定到不同的东西，以通过模仿 gedit 来“现代化”键绑定。在 Emacs23 中，它运行良好：

```
(global-set-key (kbd "C-i") 'goto-line)
(global-set-key (kbd "C-m") 'comment-or-uncomment-region)
(global-set-key (kbd "C-d") 'kill-whole-line)

;; Fix some stuff broken by the above
(global-set-key [delete] 'delete-char)
(global-set-key (kbd "TAB") 'indent-for-tab-command)
(global-set-key (kbd "RET") 'newline) 
```

然后，我升级到 Emacs24，它坏了，有点。从某种意义上说，它仍然“有效”，`C-m`肯定会做一件事，`RET`做另一件事，但问题是返回键在终端模式或 minibuffer 中不再正常运行。在这两种情况下，返回键都没有激活我刚刚输入的命令，而是简单地将光标向下移动到下一行，我无法激活我输入到 minibuffer 或终端的命令。

具有讽刺意味的是，Emacs24 对删除行为引入了很多更改，并且在此过程中它们解耦`C-d`，`DEL`因此现在实际上可以安全地绑定`C-d`到某些东西而无需绑定`DEL`回预期的行为，所以如果我能实现那就太好了对于我的返回键，类似的“它只是有效”的行为，而`C-m`绑定到其他东西。

所以，我可以设想两种可能的解决方案来解决这个问题。一个可能看起来像这样：

```
(global-set-key (kbd "C-m") 'comment-or-uncomment-region)
(global-set-key (kbd "RET") 'do-what-i-expect-the-return-key-to-do-in-any-mode) 
```

或者，这样的事情会更好：

```
(setq decouple-ascii-control-codes-from-function-keys t) 
```

但我不知道有任何此类变量或函数可以在这种情况下帮助我。

我曾多次尝试使用模式挂钩来恢复终端和迷你缓冲区模式下的正确绑定，但我似乎无法得到任何工作。帮助！

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T19:26:10.730

这似乎有效：

```
(add-hook 'find-file-hook
          (lambda ()
            (local-set-key (kbd "C-m") 'comment-or-uncomment-region)
            (local-set-key (kbd "<return>") 'newline-and-indent))) 
```

这里的想法是，我们不是在全局范围内修改返回键（这会破坏终端和 minibuffer 缓冲区），而是仅在每个缓冲区的基础上设置这些键绑定，除了我们无条件地对代表文件的所有缓冲区执行此操作磁盘。

它的效率有点低，每次打开文件时都必须运行，但它很好，因为我不必考虑“修复”所有可能的模式，它根本不会破坏终端/迷你缓冲区/等模式第一名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T17:42:25.017

在 Emacs 中默认处理这些“姐妹键”的方式是（通过功能键映射）将特殊键（如`tab`和`return`）重定向到它们的 ASCII 等效键，然后只将键绑定添加到 ASCII 版本。因此，您可以轻松地为非 ASCII 版本添加新含义，例如

```
(global-set-key [return] 'my-new-command) 
```

但在你的情况下，你想做相反的事情，即`return`在改变时让行为像以前一样`C-m`。我能想到的最可靠的方法（在它应该与大多数主要/次要模式绑定一起使用的意义上是可靠的）是`C-m`尽早且无条件地重新映射到一些新事件，如：

```
(define-key input-decode-map [?\C-m] [C-m])
(define-key input-decode-map [?\C-i] [C-i]) 
```

这不会影响`return`and `tab`since `input-decode-map`is applied before的处理`function-key-map`，即在这些键转换为 ASCII 控制键之前。所以你可以这样做：

```
(global-set-key [C-m] 'my-new-command)
(global-set-key [C-i] 'my-newer-command) 
```

不利的一面是，这不仅适用于绑定，`C-i`而且还适用于`C-c C-i`现在只能用作的绑定`C-c TAB`（有时会很好，但偶尔可能不太容易记忆）。

另一个缺点是，如果有 的绑定`tab`，则`tab`无法使用`C-i`绑定。但是我们可以通过添加以下内容来解决这两个问题：

```
(define-key function-key-map [C-i] [?\C-i])
(define-key function-key-map [C-m] [?\C-m]) 
```

如果没有使用新事件的绑定，这将使新`C-i`事件恢复正常。`C-i`

# java - 线程“主”java.lang.ArrayIndexOutOfBoundsException 4 中的异常

> ID：12362018
> 
> 赞同：-1
> 
> 时间：2012-09-11T02:43:15.600
> 
> 标签：java, arrays

我无法识别代码中的错误，有人可以告诉我出了什么问题，已经尝试了所有方法，但找不到线程“main”java.lang.ArrayIndexOutOfBoundsException：4中的异常。

我是巴西人，我的变量会让你理解起来有点复杂，因为我不会编辑很多工作来更改所有代码

```
package Aulas_POO;

import javax.swing.JOptionPane;

public class edicoes {

    static byte espaço=10;
    static String pesquisa;
    static String informacoes[][] = new String [10][4];
    static String escolhaMenu;

    public static void main(String[] args) {

        String opcao="";

        do{
            opcao= ExibirMenu();

            if(opcao.equals("1")){  Cadastro(); }

            if(opcao.equals("2")){ pesquisa();  }

            if(opcao.equals("3")){  edicao();   }

            if(opcao.equals("4")){visualizar(); }

            if(opcao.equals("5")){deletarTudo();}

            if(opcao.equals("6")){deletarUm();  }

                                    }while(!opcao.equals("7"));

    }

    private static String ExibirMenu() {
        // TODO Auto-generated method stub

String menu  ="DIGITE UMA DAS OPÇÕES\n\n\n"
             +"1) Cadastro\n"
             +"2) Pesquisa de nomes\n"
             +"3) Edição de nomes\n"
             +"4) Visualizar a lista\n"
             +"5) Deletar todos cadastros\n"
             +"6) Deletar Apenas um cadastro\n"
             +"7) SAIR";

        return JOptionPane.showInputDialog(menu);

    }

    private static void deletarUm() {
        // TODO Auto-generated method stub

        pesquisa=JOptionPane.showInputDialog("Informe o Cpf");

        for (int i = 0; i < informacoes.length; i++) {

            if (pesquisa.equals(informacoes[i][1])){

                informacoes[i][0]=null;
                informacoes[i][1]=null;
                informacoes[i][2]=null;
                informacoes[i][3]=null;
        }

        }

        JOptionPane.showMessageDialog(null,"Cadastro Deletado com SUCESSO!");

        }

    private static void deletarTudo() {
        // TODO Auto-generated method stub

        for (int i = 0; i < informacoes.length; i++) {

        informacoes[i][0]=null; 
        informacoes[i][1]=null;
        informacoes[i][2]=null;
        informacoes[i][3]=null;
        }

    }

    private static void visualizar() {
        // TODO Auto-generated method stub

        String exibeInformacoes="";

        for (int i = 0; i < informacoes.length; i++) {

            if(!(informacoes[i][i]==null)){

            exibeInformacoes+="\nNome: "+informacoes[i][0]+", CPF: "+informacoes[i][1]+", CEP: "+informacoes[i][2]+" e Telefone: "+informacoes[i][3];

            }

                                }
    JOptionPane.showMessageDialog(null,exibeInformacoes);

    }

    private static void edicao() {
        // TODO Auto-generated method stub

        pesquisa=JOptionPane.showInputDialog("Informe o CPF");

        escolhaMenu="Digite \n\n"+
                "1-Editar nome\n"+
                "2-Editar cep\n"+
                "3-Editar telefone\n"+
                "4-Editar todos\n"+
                "5-Sair";

        for (int i = 0; i < informacoes.length; i++) {

            if(escolhaMenu.equals("1")){
                informacoes[i][0]=JOptionPane.showInputDialog("Informe o novo Nome");}

            if(escolhaMenu.equals("2")){
                informacoes[i][2]=JOptionPane.showInputDialog("Informe o novo cep");}

            if(escolhaMenu.equals("3")){
                informacoes[i][3]=JOptionPane.showInputDialog("Informe o novo telefone");}

            if(escolhaMenu.equals("4")){
                informacoes[i][0]=JOptionPane.showInputDialog("Informe o novo Nome");
                informacoes[i][1]=JOptionPane.showInputDialog("Informe o novo cpf");
                informacoes[i][2]=JOptionPane.showInputDialog("Informe o novo cep");
                informacoes[i][3]=JOptionPane.showInputDialog("Informe o novo telefone");}

            if(escolhaMenu.equals("5")){return;}

        }

    }

    private static void pesquisa() {
        // TODO Auto-generated method stub

        pesquisa=JOptionPane.showInputDialog("Informe o CPF");

        escolhaMenu="Digite \n\n"+
                    "1-Pesquisar nome\n"+
                    "2-Pesquisar cep\n"+
                    "3-Pesquisar telefone\n"+
                    "4-Pesquisar todos\n"+
                    "5-Sair";

        for (int i = 0; i < informacoes.length; i++) {

        if(pesquisa.equals(informacoes[i])){

            if(escolhaMenu.equals("1")){

            JOptionPane.showMessageDialog(null,informacoes[i][0]);}
        }

        if(escolhaMenu.equals("2")){

            JOptionPane.showMessageDialog(null,informacoes[i][2]);}

        if(escolhaMenu.equals("3")){

        JOptionPane.showMessageDialog(null,informacoes[i][3]);}

        if(escolhaMenu.equals("4")){

        JOptionPane.showMessageDialog(null,"\n"+informacoes[i][i]);}

        }   

        if(escolhaMenu.equals("5")){
            return;
        }

}

    private static void Cadastro() {
        // TODO Auto-generated method stub

if(espaço!=0){

        informacoes[0][0]=JOptionPane.showInputDialog("Informe o nome");
        informacoes[0][1]=JOptionPane.showInputDialog("Informe o cpf");
        informacoes[0][2]=JOptionPane.showInputDialog("Informe o cep");
        informacoes[0][3]=JOptionPane.showInputDialog("Informe o telefone");

        JOptionPane.showMessageDialog(null,"Cadastro efetuado com SUCESSO!");

        espaço--;
}

else{
    JOptionPane.showMessageDialog(null,"Não há mais espaço disponível , remova algum cadastro para novo cadastro");
}

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T02:45:33.133

为了将来参考，*请将*您的代码缩减为一个简短但完整的示例来演示问题，如果您要报告异常，请包括堆栈跟踪和相关的行号。

我*怀疑*这是问题所在：

```
for (int i = 0; i < informacoes.length; i++) {
    if(!(informacoes[i][i]==null)){ 
```

这将在 4 时引起问题`i`。

当然，这可能不是*唯一*的问题 - 您的代码可能还没有达到那么远。阅读超过 240 行代码是相对困难的，如果没有任何关于你想要达到的目标的解释，以及对问题的不充分描述。

# spring - Spring Security 将身份验证委托给 CAS

> ID：12362020
> 
> 赞同：0
> 
> 时间：2012-09-11T02:43:33.627
> 
> 标签：spring, security, integration, cas, delegation

我正在查看 CAS 和 Spring Security 之间的问题，但我还没有找到确切的情况。我的问题是关于设置 Spring Security 以使其用户基于 CAS。

目前，我们正在修改 CAS 以访问用户本身，但是，该应用程序由 Sp​​ring Security 保护。到目前为止，CAS - Spring Security 似乎委托我们制作自己的自定义 UserService 来获取用户，但是如果用户来自 CAS 本身呢？

有没有办法识别当 CAS 发现凭证有效时，Spring Security 也会同意它并且什么也不做？或者这不是它应该如何工作的？

你有什么建议来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-09T19:07:04.637

你没有提到你正在使用的 Spring Security 版本，所以我只是插入一个指向 3.1 链中最新版本的链接。 [Spring Security CAS 认证](http://docs.spring.io/spring-security/site/docs/3.1.7.RELEASE/reference/cas.html)

CAS 规范只需要令牌交换。跟踪认证用户的业务是 Spring Security 的一部分。参考文档中的相关步骤是 14 和 15。 Spring Security 定义流程以使 AuthenticationProvider 委托给 UserDetailsS​​ervice 以创建可以在整个应用程序中引用的对象。您必须定义一个 UserDetailsS​​ervice 并让它构造一个基本的 UserDetails 对象，即使该对象只是从 CAS 身份验证主体中提取用户名。

# macos - 使用 Homebrew 升级 Git 的问题

> ID：12362021
> 
> 赞同：7
> 
> 时间：2012-09-11T02:43:34.587
> 
> 标签：macos, git, osx-lion, homebrew

我在这里非常接近，我想我只需要创建一个符号链接，但我不确定如何（以及为什么需要这样做）。

我使用以下命令下载并安装了 git：

```
brew install git 
```

回应是：

```
git-1.7.12 already installed, it's just not linked 
```

我该怎么做呢？

当我运行时：

```
which git
>/usr/bin/git 
```

当我运行时：

```
git --version
>git version 1.7.4.4 
```

我的路径很好：

```
export PATH="/usr/local/bin:$PATH" 
```

同样，我真正需要知道的是如何设置符号链接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T02:45:45.807

通过使用`link`子命令：

```
brew link git 
```

# c++ - msvc 11 仅在某些情况下尊重 C++ 外部模板

> ID：12362024
> 
> 赞同：1
> 
> 时间：2012-09-11T02:44:09.740
> 
> 标签：c++, templates, visual-c++, c++11

我正在使用 C++ 外部模板来加快编译速度。我注意到 Visual Studio 2012 在处理`extern template`. 这是一个例子：

**主.cpp：**

```
#include <iostream>
#include "Calc.h"

using namespace std;

int main(int argc, char** argv)
{
    Calc<int> c1;
    cout << c1.add(1, 2) << endl;
} 
```

**计算.h：**

```
#pragma once

template <class A_Type>
class Calc
{
public:
    A_Type add(A_Type x, A_Type y)
    {
        return x + y;
    }
};

extern template class Calc<int>; 
```

通常我会包含**Calc.cpp**，`template class Calc<int>;`确保模板只实例化一次。对于这个例子，我只编译**Main.cpp**并期望它失败。

问题是，Visual Studio 2012 会愉快地编译和链接上面的代码。它不尊重`extern template`. 我发现的唯一解决方案是在标题中执行此操作：

**计算.h：**

```
#pragma once

template <class A_Type>
class Calc
{
public:
    A_Type add(A_Type x, A_Type y);
};

template <class A_Type> A_Type Calc<A_Type>::add(A_Type x, A_Type y)
{
    return x + y;
}

extern template class Calc<int>; 
```

如果标头是这样的，则 Visual Studio 无法链接（如预期的那样，抱怨缺少 的定义`Calc<int>::add`）。**但是**，*g++ 4.6.3*无法链接这些示例中的任何一个。

谁是对的？如果一个类中函数的原型和定义都在同一个头文件中指定，真的有区别吗？有没有办法指定“较短形式”的*Calc.h*并让它在 Visual Studio 2012（以及 gcc）中按预期失败？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T02:56:57.887

编译器可以自由地内联它定义的任何函数，如果它选择这样做的话。一旦它被内联，就不需要在另一个文件中进行另一个定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-19T09:30:25.893

根据第 14.7.3 节中的标准，

> 除了内联函数和类模板特化，显式实例化声明具有抑制它们所引用实体的隐式实例化的效果。

在您的第一个示例`Calc<int>::add`中是内联的。

> [注意：意图是作为显式实例化声明主题的内联函数在使用odr（3.2）时仍将被隐式实例化，以便可以考虑将主体内联，但没有外联副本的内联函数将在翻译单元中生成。——尾注]

请记住，尽管成员函数是内联的，但编译器可以自由决定它是否实际上是内联的。

# macos - 使用 Homebrew 安装 Git 的问题

> ID：12362027
> 
> 赞同：28
> 
> 时间：2012-09-11T02:45:03.790
> 
> 标签：macos, git, osx-lion, homebrew

> **可能重复：**
> [使用 Homebrew 升级 Git 时出现问题](https://stackoverflow.com/questions/12362021/problems-upgrading-git-with-homebrew)

我在这里非常接近——我想我只需要创建一个符号链接，但我不确定如何（以及为什么需要这样做）。顺便说一句，我在 OSX Lion 上。

我已经使用这个命令下载并安装了 git。

```
brew install git 
```

回应是

```
git-1.7.12 already installed, it's just not linked 
```

我该怎么做呢？

当我跑步时

```
which git
>/usr/bin/git 
```

当我跑步时

```
git --version
>git version 1.7.4.4 
```

我的路很好

```
export PATH="/usr/local/bin:$PATH" 
```

再说一遍——我真正需要知道的是如何设置符号链接。谢谢！

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-09-11T02:49:15.747

您需要做的就是：

```
brew link git 
```

# ruby-on-rails - 尝试运行 resque-web 时出错

> ID：12362037
> 
> 赞同：0
> 
> 时间：2012-09-11T02:45:45.497
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, resque

运行时出现此错误`resque-web`。我试过重新启动，重新安装 resque 和 vegas 并重新编译 ruby​​。这开始发生在我用完硬盘空间后，而 resque 作业正在写入文件。我腾出了一些空闲空间，但 resque-web 还没有开始。

```
dan@ubuntu:~$ resque-web
[2012-09-10 22:34:02 -0400] Starting 'resque-web'...
/home/dan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:35:in `initialize': No such file or directory -  (Errno::ENOENT)
  from /home/dan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:35:in `open'
  from /home/dan/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/open-uri.rb:35:in `open'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/gems/vegas-0.1.11/lib/vegas/runner.rb:146:in `port_open?'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/gems/vegas-0.1.11/lib/vegas/runner.rb:160:in `check_for_running'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/gems/vegas-0.1.11/lib/vegas/runner.rb:108:in `start'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/gems/vegas-0.1.11/lib/vegas/runner.rb:77:in `initialize'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/gems/resque-1.22.0/bin/resque-web:13:in `new'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/gems/resque-1.22.0/bin/resque-web:13:in `<top (required)>'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/bin/resque-web:19:in `load'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/bin/resque-web:19:in `<main>'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/bin/ruby_noexec_wrapper:13:in `eval'
  from /home/dan/.rvm/gems/ruby-1.9.3-p125/bin/ruby_noexec_wrapper:13:in `<main>' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:30:51.973

我不得不这样做`rm /home/dan/.vegas/resque_web/resque_web.url`，现在它开始了。

# celery - 启动 CeleryBeat 时出现 Django Celery 错误 - 无法将项目添加到数据库

> ID：12362045
> 
> 赞同：9
> 
> 时间：2012-09-11T02:46:40.877
> 
> 标签：celery, django-celery

我已经使用 mod_wsgi 通过 Apache 建立了一个 Django 项目，现在我正在尝试将 django-celery 添加到组合中以运行定期任务和计划任务。不过，我偶尔会遇到错误消息，但我还没有找到对它们含义的解释。

当我使用以下命令启动 Celerybeat 时：

```
./manage.py celery beat 
```

我经常遇到以下两个错误之一：

```
Message Error: cannot add item to database

celerybeat raised exception <class 'dbm.error'>: error('cannot add item to database',) 
```

可以看到celerybeat在项目目录下生成了两个文件：celerybeat-schedule.dir和celerybeat-schedule.pag。我很确定这些文件是错误消息中提到的“数据库”。如果我删除这些文件，Celerybeat 通常会运行几次而没有问题，但随后又出现错误。

为了避免这个错误，我需要对 celerybeat-schedule 文件做些什么吗？我认为这可能是权限问题，但我看不到任何问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2018-06-21T04:17:33.857

只需 rm celerybeat.db，然后再次启动 celerybeat 即可

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-13T18:27:16.843

我能够通过安装`python3-gdbm`（或`python3-dbm`）包并重新创建计划文件来解决这个问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-06T02:45:49.940

有同样的问题，无法弄清楚。

一种解决方法是使用数据库来存储计划：

`celery -A proj beat -S djcelery.schedulers.DatabaseScheduler`

`pip install django-celery`如果你走这条路，你需要更新你的数据库。

# python-3.x - 哪些版本的 pygames 在 Mac OS 上使用 python 3.2.3 运行

> ID：12362054
> 
> 赞同：0
> 
> 时间：2012-09-11T02:48:07.820
> 
> 标签：python-3.x, pygame

> **可能重复：**
> [OSX Mountain Lion 上 Python 3 的 Pygame？](https://stackoverflow.com/questions/12362449/pygame-for-python-3-on-osx-mountain-lion)

网络上充斥着晦涩难懂、难以理解的参考资料，以及让 pygames 在 MAC 上使用 python V3 或更高版本运行的断章取义的帖子。大多数人指出，已经有一个适用于 MAC 的 python 3.2.3 安装程序，但是很少有信息知道 pygames（以及 pygames 的哪些版本）可以在 MAC 上使用 python 2.7 以外的任何东西成功运行。混入这个问题的是 3 种不同的 MAC OS，豹、狮子和现在的山狮。1）所以我想知道人们在所有这些不同的 MAC OS 上使用 pygames plus python 3 或更高版本的体验是什么。2）此外，如果有人愿意为新手创建更好的分步说明，以便使用 python 3 为所有这些 MAC OS 安装 pygames（假设它完全有效）。我 13 岁的儿子正在尝试在他的 Mac 上运行山狮完成一个非常好的 pygames 教程，该教程适用于 python 3 及更高版本。所以现在我们被困住了，因为本教程是为 python 3 编写的。任何帮助或建议将不胜感激。谢谢。

# object - 在 VBScript 派生语言中查找可用的对象方法

> ID：12362056
> 
> 赞同：1
> 
> 时间：2012-09-11T02:48:20.910
> 
> 标签：object, methods, vbscript

如何在 VBScript 中找出对象的可用方法？我正在处理一个使用基于 VBscript 的脚本语言的 CAD 程序，但它没有对象浏览器。我正在尝试编写一个 3rd 方插件的脚本，而开发人员对此保持沉默。谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T08:05:32.080

VBScript 无法为您提供对象可用方法的概览。反过来说，不可能`HasMethod`对一个物体做某种事情。因此，您需要在其他地方获取您的信息。

我的第一次尝试是从 Internet 上查找文档，因为运气好的话，您还可以获得很好的描述和一些关于这些方法正在做什么的示例。
其次，您可以尝试加载对象库作为 VBA 中 MS Office 应用程序（Word、Excel 等）的参考。然后，您可以在创建变量作为该对象或使用 VBA 的对象浏览器时立即查看方法。
（假设您无权访问 Visual Studio。当您可以访问它时，使用 VS 会更容易。）

# java - GWAN 无法识别 Sun Java 7

> ID：12362059
> 
> 赞同：1
> 
> 时间：2012-09-11T02:48:54.833
> 
> 标签：java, sun, g-wan

**操作系统：** Ubuntu 12.04 桌面

**已安装 Java：** java 版本“1.7.0_05”Java(TM) SE 运行时环境（构建 1.7.0_05-b05）Java HotSpot(TM) 64 位服务器 VM（构建 23.1-b03，混合模式）

运行 sudo ./gwan 会出现以下错误：- 请安装 OpenJDK 或 SUN Java。

> 'report.java'：要使用 Java (*.java) 脚本，请安装 'javac' (sudo apt-get install javac)。
> 
> 'loan.java'：要使用 Java (*.java) 脚本，安装 'javac' (sudo apt-get install javac)。
> 
> 'argv.java'：要使用 Java (*.java) 脚本，安装 'javac' (sudo apt-get install javac)..
> 
> 'hello.mm'：要使用 Objective-C++ (*.mm) 脚本，安装 'gobjc++' (sudo apt-get install gobjc++)
> 
> 'all.java'：要使用 Java (*.java) 脚本，安装 'javac' (sudo apt-get install javac)

Javac、Java 都在 sys 路径中，都在终端中可用

我没有触及任何配置文件，只是通过 [http://gwan.com/download](http://gwan.com/download) 然后尝试前往

本地主机：8080/?hello.java

注意：所有 C 文件都有效。

虽然我想远离这个选项，但没有尝试过 openJDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T13:58:05.010

尝试使用`JAVA_HOME`环境变量来判断应该使用哪个 JVM。G-WAN 站点有一个专门针对该问题的 Java[常见问题解答条目](http://gwan.com/faq#languages)。

过去报告过同样类型的问题 我被告知下一个版本将更加与 JVM 无关。

# magento - 如何构建一个magento主题演示站点？

> ID：12362067
> 
> 赞同：0
> 
> 时间：2012-09-11T02:50:14.390
> 
> 标签：magento, themes, demo

现在我需要构建一个包含几十个主题的magento主题演示站点，但是还有几个问题需要解决。

1.  通常，管理员可以通过管理面板更改站点的主题，但这对用户不友好且效率低下。是否可以通过编程方式设置主题，以便用户在前端选择主题以查看效果？

2.  据我了解，当用户选择尝试某个主题时，演示站点会相应地更改其主题设置。那么，如何在单个站点上保存主题并允许用户同时浏览它们而不受干扰呢？

希望有好的建议。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T14:36:51.283

**设置一个多商店 Magento 安装，并将每个店面设置为一个新主题。**

这可以在商店视图范围内完成`system > config > general > design > theme / package`

![在配置面板的商店视图范围下输入您的主题和包](../Images/6862c69d2e60d28c0f134a38b576eca0.png)

我看到了将每个站点设置为子域并使用框架集或 iframe 提供从主题到主题的切换的能力。

在 Magento 中设置店面/站点几乎需要零磁盘空间，因为它只需要一个子文件夹、一个 htaccess 文件、index.php 和 3 个符号链接。见这里： http: [//www.magentocommerce.com/knowledge-base/entry/tutorial-multi-site-multi-domain-setup](http://www.magentocommerce.com/knowledge-base/entry/tutorial-multi-site-multi-domain-setup)

从本质上讲，您的“数十个”主题都将是 Magento 中的店面，您可以使用商店切换器进行 iframe。

# ajax - Grails 渲染模板

> ID：12362072
> 
> 赞同：0
> 
> 时间：2012-09-11T02:51:24.130
> 
> 标签：ajax, grails, grails-domain-class

我有这个`<g:formRemote>`有这个属性，

```
<g:formRemote name="innerForm" id="innerForm" 
              url="[controller:'user', action:'actionAJAX']"
              update="formMessage">
  <div id="formMessage">Fill up the fields</div>
  <g:render template="form" bean="${newUser}" />
  <div class="buttons">
    <g:submitButton name="Create User"/>
    <input type="reset" value="Cancel"/>
  </div>
</g:formRemote> 
```

在提交过程中，它会进入具有这行代码的闭包，

```
def actionAJAX() {
  def userInstance = new User(params)
  render(template:"error", bean:userInstance)
} 
```

`_error.gsp`将包含违反域约束（可为空、空白等）的 bean 错误的脚手架显示。它看起来像这样：

```
<g:hasErrors bean="${userInstance}">
  <ul class="errors" role="alert">
    <g:eachError bean="${userInstance}" var="error">
      <li <g:if test="${error in org.springframework.validation.FieldError}">data-field-id="${error.field}"</g:if>><g:message error="${error}"/></li>
    </g:eachError>
  </ul>
</g:hasErrors>
message 
```

问题是我无法`def userInstance = new User`在`_error.gsp`. 该场景只是留下所有字段`_form.gsp`（具有的内容`generate-view`并删除所有属性），但在`required`提交时，闭包仅返回预期显示违反域约束的域的所有错误。`message``<div id="formMessage">`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T11:24:58.473

只是快速浏览一下代码，所以也许我错过了许多 Grails 约定之一，但是您将使用 'bean' 作为映射键的 userInstance 传递给 render 方法。然后将其称为 ${userInstance}。尝试在模板中将其称为 ${bean} 或像这样传递它：

```
render(template:"error", userInstance:userInstance) 
```

这不是您问题的答案，只是一个额外的提示：您可以在错误模板中使用[g:renderErrors 标记](http://grails.org/doc/2.1.0/ref/Tags/renderErrors.html)，甚至可以代替它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T12:28:16.563

如果这就是您显示的所有代码，那么您的主要问题是您没有调用`.validate()`or `.save()`。您必须调用其中任何一个来获取对象中的错误。

```
def actionAJAX() {
  User userInstance = new User(params)
  if ( !user.save() )
  {
      render(template:"error", model:[userInstance: userInstance])
  }
  else
  {
      render(template:"success", model:[userInstance: userInstance])
  }  
} 
```

# ruby-on-rails - TinyMce Rails Theme Simple 和 Theme Advanced 在一页中

> ID：12362073
> 
> 赞同：2
> 
> 时间：2012-09-11T02:51:26.517
> 
> 标签：ruby-on-rails, tinymce

我有一个 events.html.haml 文件。我希望第一个文本区域有一个自定义插件，主题：简单。

下一个文本区域，我希望它包含我指定的所有内容`config/tinymce.yml`

这是我的代码：

```
= form_for @event, :url => profile_events_path, :html => {:multipart => true} do |event|
    =render "shared/error_messages", :object => @event
    %label{:for => "title"} Title:
    %br
    = event.text_area :title,:class=>"tinymce", :theme => "simple"
    %br
    %label{:for => "image"} File:
    %br
    = event.file_field :image
    %br
    %label{:for => "date"} Date:
    %br
    = event.text_field :date
    %br
    %label{:for => "location"} Location:
    %br
    = event.text_field :location
    %br
    %label{:for => "description"} Description:
    %br
    = tinymce
    = event.text_area :description,:class => "tinymce"

    %br
    -if current_user.admin
        //%label{:for => "featured"} Feature:
        //%br
        //= event.check_box :featured
        //%br
        %label{:for => "special"} Special/Featured:
        %br
        = event.check_box :special
        %br
    %br
    = submit_tag "Add Event" 
```

问题是，每当我将`tinymce theme=>"simple"` 代码与`=tinymce` 它放在一起时，这两个文本区域都变得简单。我希望第一个简单，另一个高级。

这是我的 yml 文件

```
theme_advanced_toolbar_location: top
theme_advanced_toolbar_align: left
theme_advanced_statusbar_location: bottom
theme_advanced_buttons1_add:
  - forecolor
  - fontselect
  - formatselect
theme_advanced_styles : "Header 1=header1;Header 2=header2;Header 3=header3;Table Row=tableRow1"

theme_advanced_buttons3_add:
  - tablecontrols
  - fullscreen
  - emotions
  - styleprops
  - preview
  - media
plugins:
  - table
  - fullscreen
  - emotions
  - style
  - preview
  - media

apply_source_formatting : true
theme_advanced_more_colors : true 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:46:44.903

使用[模式](http://www.tinymce.com/wiki.php/Configuration%3amode) `specific_textareas`和[`editor_selector`](http://www.tinymce.com/wiki.php/Configuration%3aeditor_selector)地址定义的文本区域

```
...
mode : "specific_textareas",
editor_selector : "mceEditor"
... 
```

# recursion - 方案递归函数

> ID：12362078
> 
> 赞同：0
> 
> 时间：2012-09-11T02:51:54.827
> 
> 标签：recursion, scheme, racket, r5rs

嘿，我一直被以下问题困扰，似乎无法提出正确的功能。

编写一个递归函数，给定一个正整数 k，计算乘积 k：(1-1/2)(1-1/3)(1-1/k)... 随着 k 减一。

我似乎无法想出正确的功能，我的程序通常运行直到它没有更多的内存。这是我的方法：

```
(define (fraction-product k)
  (if (= k 0)
       0
       (* (- 1 (/ 1 (fraction-product (- k 1))))))) 
```

提前感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T06:11:59.253

先用手做小案子。

无需尝试对其进行编码，手动计算答案应该是什么：

*   *（分数乘积 1）*
*   *（分数乘积 2）*
*   *（分数乘积 3）*

在你做这些问题之前，你至少应该有三个具体的例子：它不仅有助于澄清一些混淆，而且当你得到实际代码时，它们可以作为健全的测试用例。

*您在(fraction-product 1)*和*(fraction-product 2)*之间手动计算的答案之间是否存在关系？在*(fraction-product 2)*和*(fraction-product 3)*之间怎么样？

我们需要担心*(fraction-product 0)*吗？检查您的问题陈述。

当你看到这样的问题时，不要直接去编码。先用手做小例子：计算答案*应该*是什么。它将帮助您开始对程序真正尝试计算的内容以及如何机械地进行计算的直觉。

如果您有时间，请参阅《[如何设计程序](http://www.ccs.neu.edu/home/matthias/HtDP2e/)》之类的书，其中描述了设计此类功能的系统方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:31:56.073

你错了基本情况：它应该说明 if `k`is `1`，然后返回`1`- 当你递归乘法时，你必须确保在`1`达到数字时递归停止，如果你乘以`0`结果将始终是`0`。

递归调用也是错误的，注意你必须乘以`(- 1 (/ 1 k))`递归的结果。尝试这样的事情：

```
(define (fraction-product k)
  (if (<= k 1)
      1
      (* (- 1 (/ 1 k))
         (fraction-product (- k 1))))) 
```

正如@Axioplase 的回答所建议的那样，可以通过使用尾递归来使用恒定堆栈空间来编写相同的过程 - 递归调用是过程在返回之前执行的最后一件事，因此处于尾部位置：

```
(define (fraction-product k)
  (let loop ((acc 1)
             (k k))
    (if (<= k 1)
        acc
        (loop (* acc (- 1 (/ 1 k))) (- k 1))))) 
```

只是为了好玩，很容易意识到同样的过程可以写得像这样简单：

```
(define (fraction-product k)
  (/ 1 k)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:06:59.920

产品的论据是什么？只有一个！因此，该产品是无用的，因为`(* n) == (* n 1) == n`. 这应该立即告诉您您的算法没有按照您的意愿行事。

找到此类错误的一个好策略是将函数的所有参数写成单独的行……</p>

此外，当`k == 0`,`(fraction-product 0)`返回 0。然后`(fraction-product 1)`将计算`(/ 1 (fraction-product 0)) == (/ 1 0)`可能不是您想要再次执行的操作...</p>

实际上，您似乎想要计算与分数乘积完全不同的东西……而是递归分数（我忘记了这些东西的名称）。

无论如何，`(1 - 1/2) * (1 - 1/3) * ... * (1 - 1/k)`你可以做类似的事情

```
(define (f-p k)
  (define (aux n) (- 1 (/ 1 n)))
  (let loop ((i 2))
    (if (> i k)
      1 ;; base case: multiply by 1, i.e. "do nothing"
      (* (aux i) (loop (+ i 1)))))) 
```

这可以优化为使用常量堆栈空间，但这不是重点，是吗？

# php - MySQL 字符集和排序规则：不区分重音不起作用

> ID：12362082
> 
> 赞同：0
> 
> 时间：2012-09-11T02:52:05.543
> 
> 标签：php, mysql, utf-8, character-encoding

我知道答案很简单，但我要疯了。我想我已经尝试了所有可用的解决方案。开始了...

我有一个带有 charset **latin1**的数据库。是的，我应该把它放在**utf8**中，但是我有几个正在运行的项目，所以我不想弄乱它们。

这个问题伴随`SELECT`着`LIKE "%...%"`

该表是带有 COLLATE utf8_general_ci 的 utf8。这些字段也是带有 utf8_general_ci 排序规则的 utf8。我的脚本文件 (php) 是 utf-8 编码的，服务器还提供 utf-8 格式的文件。所以，一切都是utf-8。

好的，由于所有内容都使用 utf8_general_ci 进行了整理，我应该能够搜索不区分大小写和不区分重音的搜索。例如：

有在表`providers`...

```
id     providerName
1      Jose
2      José 
```

我应该可以做...

```
SELECT * FROM providers WHERE providerName LIKE "%jose%" 
```

或者

```
SELECT * FROM providers WHERE providerName LIKE "%josé%" 
```

并且在这两种情况下都返回了两行。但是，对于第一个查询，我只得到第 1 行；并且通过第二个查询，我只得到第二行。不区分大小写的搜索似乎运作良好，但不区分重音则不行。

所以我尝试`COLLATE utf8_general_ci`在 LIKE 之后添加`"%...%"`。结果相同。

然后，我发现连接是在 latin1 中建立的（通过 PHP 函数`mysql_client_encoding()`）。所以我每次建立连接时都添加一个查询，指示使用utf8。我同时使用了`SET NAMES UTF8 COLLATE utf8_general_ci`AND php 的`mysql_set_charset()`. 当我添加此配置时，第一个查询返回第 1 行，但第二个查询不返回任何结果。此外，所有结果都返回稀有字符（你知道，像 Ã°，即使全部设置为 utf8）。

这让我很困惑。一切都以 UTF8 设置，但它不像（我）期望的那样工作。

```
MySQL Server 5.0.95
PHP 5.2.14
Win7 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T14:37:33.483

停止机器！！

我发现我做的一切都很好，它确实按预期响应。唯一的问题是，即使表格、字段、文件和服务器是 utf8 格式，当表格被填充时（过去的某个时间），连接是用 latin1 建立的。

所以我重新填充了表格，现在使用 utf8 连接，它工作得很好。

感谢你们！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T07:58:09.667

我没有设置来正确测试这个，但这[是一个可能的解决方案](http://forums.mysql.com/read.php?52,161722,161803#msg-161803)。这么多设置UTF8的地方！:)

# c# - 如何使用 wcf ria 服务缩小传输图像的大小？

> ID：12362084
> 
> 赞同：0
> 
> 时间：2012-09-11T02:52:25.467
> 
> 标签：c#, silverlight

我有一个列表框来显示通过在 silverlight 项目中使用 wcf ria 服务从数据库中检索到的照片。数据加载时间长。照片的原始大小是大字节[]，但我只想在列表框中显示一个小图像（图标）。有没有办法可以在传输到客户端之前降低照片的分辨率以减少数据传输大小？

谢谢，

魏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:31:59.387

检查此产品[http://imageresizing.net/](http://imageresizing.net/)。

它可以将您的图像调整为任意大小并保持结果缓存以提高后续请求的速度。它还以一种非常有效的方式实现，以提高 IIS 的吞吐量。

# sql - 获取具有相同 id 值的最长字符串的字段

> ID：12362085
> 
> 赞同：3
> 
> 时间：2012-09-11T02:52:43.257
> 
> 标签：sql, oracle

我必须为相同的 id 字段获取具有最长字符串值的行。

```
create table test(
id number,
test_data varchar2(20)
);

insert all      
    into test values (1,'aaa')
    into test values (1,'a')
    into test values (1,'abxw')
    into test values (2,'aaa')
    into test values (2,'tris')
select * from dual; 
```

我想要的输出是

* * *

1 abxw --最长的字符串

2个

我怎样才能获得所需的输出？我没有任何想法。

**伙计们如何使用光标。我们可以为此目的使用光标吗？有人有什么主意吗？可能吗？？**

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T03:06:59.170

我喜欢对这些查询使用分区：

```
select id,test_data from (
  select
  id, test_data, 
     row_number() over( partition by id order by length(test_data) desc) as rnum
from
  test 
) where rnum=1 
```

[http://www.sqlfiddle.com/#!4/66d4c/20](http://www.sqlfiddle.com/#!4/66d4c/20)

当然，这样做的好处是，如果您决定需要另一个 tiebreak（例如，按字母顺序），您只需将其添加到您的 order by 子句中。顺便说一句，这不是一个坏主意，这样您的结果集就不会是不确定的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T02:59:01.897

你可以试试这个查询。如果多个字符串每个 id 的长度最长，它将返回多个结果：

```
select
  t1.id, t1.test_data
from
  test t1
join
  (select id, max(length(test_data)) as len from test group by id) t2
    on t1.id = t2.id and length(t1.test_data) = t2.len 
```

演示：[http ://www.sqlfiddle.com/#!4/66d4c/6](http://www.sqlfiddle.com/#!4/66d4c/6)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T03:07:50.830

我认为分析（窗口）函数 RANK() 是实现这一目标的最佳方法。

```
SELECT id, test_data FROM (
    SELECT id, test_data
         , RANK() OVER ( PARTITION BY id ORDER BY LENGTH(test_data) DESC ) AS the_rank
      FROM test
) WHERE the_rank = 1 
```

如果您只想要一条记录，则可以执行以下操作：

```
SELECT id, test_data FROM (
    SELECT id, test_data
         , RANK() OVER ( PARTITION BY id ORDER BY LENGTH(test_data) DESC ) AS the_rank
      FROM test
     ORDER BY the_rank
) WHERE rownum = 1 
```

# python - 为什么在 numpy 数组上设置 dtype 会改变尺寸？

> ID：12362094
> 
> 赞同：0
> 
> 时间：2012-09-11T02:54:28.977
> 
> 标签：python, numpy

我试图了解如何设置数组的 dtypes。我原来的 numpy 数组维度是 (583760, 7) 即 583760 行和 7 列。我正在设置 dtype 如下

```
>>> allRics.shape
(583760, 7)
>>> allRics.dtype = [('idx', np.float), ('opened', np.float), ('time', np.float),('trdp1',np.float),('trdp0',np.float),('dt',np.float),('value',np.float)]
>>> allRics.shape
(583760, 1) 
```

为什么数组的原始形状会发生变化？是什么导致了这种变化？我基本上是在尝试按`time`列对原始 numpy 数组进行排序，这就是我设置`dtype`. 但是在维度改变后，我无法对数组进行排序

```
>>> x=np.sort(allRics,order='time') 
```

上述命令的输出没有变化。你能建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:08:04.760

您正在将数组转换为[结构化数组](http://docs.scipy.org/doc/numpy/user/basics.rec.html)。基本上，它现在被视为结构的一维数组，而不是二维数组。下面看一个更简单的例子：

```
>>> import numpy as np
>>> arr = np.array([(1,2,3),(3,4,5)])
>>> arr
array([[1, 2, 3],
       [3, 4, 5]])
>>> arr.shape
(2, 3)
>>> arr.dtype=[('a',int),('b',int),('c', int)]
>>> arr  # Notice that tuples inside the elements
array([[(1, 2, 3)],
       [(3, 4, 5)]], 
      dtype=[('a', '<i8'), ('b', '<i8'), ('c', '<i8')])
>>> arr.shape
(2, 1) 
```

不排序的结构化数组无疑是一个[错误](http://www.mail-archive.com/numpy-discussion@scipy.org/msg23060.html)。它看起来像是一种解决方法，因此实际上将数组声明为结构化数组：

```
>>> arr_s = np.sort(arr, order='b')
>>> arr_s
array([[(1, 2, 3)],
       [(3, 4, 5)]], 
      dtype=[('a', '<i8'), ('b', '<i8'), ('c', '<i8')])
>>> dtype=[('a',np.int64),('b',np.int64),('c', np.int64)]
>>> arr = np.array([(5,2,3),(3,4,1)], dtype=dtype)
>>> arr
array([(5, 2, 3), (3, 4, 1)], 
      dtype=[('a', '<i8'), ('b', '<i8'), ('c', '<i8')])
>>> arr_s = np.sort(arr, order='a')
>>> arr_s
array([(3, 4, 1), (5, 2, 3)], 
      dtype=[('a', '<i8'), ('b', '<i8'), ('c', '<i8')])
>>> arr_s = np.sort(arr, order='b')
>>> arr_s
array([(5, 2, 3), (3, 4, 1)], 
      dtype=[('a', '<i8'), ('b', '<i8'), ('c', '<i8')])
>>> arr_s = np.sort(arr, order='c')
>>> arr_s
array([(3, 4, 1), (5, 2, 3)], 
      dtype=[('a', '<i8'), ('b', '<i8'), ('c', '<i8')])
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:52:54.097

如果您只使用结构化数组进行排序，那么您可能可以避免一起使用结构化数组。您可以执行以下操作：

```
new_order = np.argosrt(allRics[:, 2])
x = allRics[new_order] 
```

# javascript - 带有 TimeStamp 属性的 jQuery 浮点数据

> ID：12362101
> 
> 赞同：1
> 
> 时间：2012-09-11T02:54:59.553
> 
> 标签：javascript, jquery, jquery-plugins, flot

无法在浏览器中显示浮点数据

```
 var plot = $.plot($("#placeholder"),
    [{ data: capacityList, label: "Capacity(MsgNumber/min)"}],
        {
        series:
           {
               lines: { show: true },
               points: { show: true }
           },
        crosshair: { mode: "x" },
        grid: { hoverable: true, clickable: true },
        yaxis: {
            axisLabel: "MsgNumber",
            min: 0
        },
        xaxis: {
            axisLabel: "Time",
            mode: "time",
            timeformat: "%H:%M",
            tickSize: 1000 * 60 * 60
        }
    }); 
```

capacityList 是一个数组，一个元素是一个具有属性的对象`DatetimeStamp & MsgNumber`：

```
capacityList[12]
Object
DatetimeStamp: 1345681620000
MsgNumber: 15 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:02:08.173

只需传递带有 x,y 对的数组数组。然后将在 x 参数上调用 xaxis 时间函数，该参数是时间戳。

```
capacityList = [[1345681620000,15]] 
```

[http://people.iola.dk/olau/flot/examples/time.html](http://people.iola.dk/olau/flot/examples/time.html)

# android - Android：输入无效位置时应用程序崩溃

> ID：12362103
> 
> 赞同：0
> 
> 时间：2012-09-11T02:55:22.193
> 
> 标签：android, location

在我的应用程序中，我必须找出给定位置是否位于指定区域之下。我以新德里的康诺特广场为中心点。我得到了距离中心点 200 英里范围内的地址。但是，如果我输入任何无效位置，例如“abcdfdfkc”，应用程序就会崩溃，因为它正在尝试查找该位置的坐标，而我想避免这种情况。

下面我发布代码：

```
public static  boolean isServicedLocation(Context _ctx, String strAddress){
    boolean isServicedLocation = false;

    Address sourceAddress = getAddress(_ctx, "Connaught Place, New Delhi, India");
    Location sourceLocation = new Location("");
    sourceLocation.setLatitude(sourceAddress.getLatitude());
    sourceLocation.setLongitude(sourceAddress.getLongitude());      

    Address targetAddress = getAddress(_ctx, strAddress);
    Location targetLocation = new Location("");

    if (targetLocation != null) {
        targetLocation.setLatitude(targetAddress.getLatitude());
        targetLocation.setLongitude(targetAddress.getLongitude());
        float distance = Math.abs(sourceLocation.distanceTo(targetLocation));
        double distanceMiles = distance/1609.34;
        isServicedLocation = distanceMiles <= 200;

        //Toast.makeText(_ctx, "Distance "+distanceMiles, Toast.LENGTH_LONG).show();
    }       

    return isServicedLocation;
} 
```

**获取地址方法：**

```
public static Address getAddress(Context _ctx, String addressStr) {
    Geocoder geoCoder = new Geocoder(_ctx, Locale.getDefault());
    try {
        List<Address> addresses = geoCoder.getFromLocationName(addressStr,
                1);

        if (addresses.size() != 0) {
            return addresses.get(0);
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }

    return null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:01:19.510

这是因为当您没有从 GeoCoder 中找到地址时（即 if `addresses.size() == 0`），您会返回`null`.

然后，不管怎样，您取消引用该值，这就是导致您的应用程序崩溃的原因。

```
Address targetAddress = getAddress(_ctx, strAddress);
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
:
if (targetLocation != null) {
    targetLocation.setLatitude(targetAddress.getLatitude());
                               ^^^^^^^^^^^^^ 
```

您可能还应该检查`targetAddress`以`null`避免这种情况（除了（可能），或者代替（不太可能），检查`targetLocation`）。

所以我会考虑改变：

```
if (targetLocation != null) { 
```

进入：

```
if ((targetLocation != null) && (targetAddress != null)) { 
```

这样一来，无效地址会自动成为未提供服务的位置。

# python - 在 Python 中，是否可以使用相同的装饰器来装饰类和非类方法？

> ID：12362120
> 
> 赞同：3
> 
> 时间：2012-09-11T02:57:57.540
> 
> 标签：python, arguments, closures, wrapper, decorator

我有一个简单的异常记录装饰器，当我的脚本抛出异常时，它可以方便地给自己发送电子邮件。

```
def logExceptions(func):
   def wrapper():
      try:
         func()
      except Exception, e:
         logger.exception(e)

   return wrapper 
```

但是，如果我想装饰一个类方法，我必须修改 wrapper() 以获取“自我”，否则会出现以下错误：

```
TypeError: wrapper() takes no arguments (1 given) 
```

当然，此时我不能用它来装饰任何非类方法，因为这样就会出现这个错误：

```
TypeError: wrapper() takes exactly 1 argument (0 given) 
```

有没有一种干净的方法来解决这个问题？谢谢你=)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T03:01:35.243

通常的做法是定义您的包装器，以便它接受`*args`并将`**kwargs`它们传递给它包装的函数。这样它可以包装任何功能。

另外，我的印象是，您所说的“类方法”是 Python 所说的“实例方法”，而您所说的“非类方法”是 Python 所说的“函数”。Python 中的“非类方法”（例如，实例方法）需要一个`self`参数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T03:08:22.273

## 实例方法`classmethod`和`staticmethod`

首先要注意：静态方法和类方法也是函数，因此标准函数规则大多适用于它们。我了解您的问题是关于**静态方法**（没有传递额外的参数）和**类方法**（在第一个参数中接收类）之间的区别：

```
class Test(object):
    def standard_method(*args, **kwargs):
        # it is instance method (first argument will be instance)
        return args, kwargs

    @classmethod
    def class_method(*args, **kwargs):
        # it is class method (first argument will be class)
        return args, kwargs

    @staticmethod
    def static_method(*args, **kwargs):
        # it is static method (receives only arguments passed explicitly)
        return args, kwargs 
```

证明（或者更确切地说是不言自明的例子）在这里：

```
>>> t = Test()
>>> t.standard_method()
((<__main__.Test object at 0x0000000002B47CC0>,), {})
>>> t.class_method()
((<class '__main__.Test'>,), {})
>>> t.static_method()
((), {}) 
```

如您所见，传递的参数列表因您选择的方法类型而异。您面临的问题是**可变数量的参数**。

## 解决方案

有一个解决方案 - 使用参数解包：

```
def some_decorator(func):
    def wrapper(*args, **kwargs):
        # do something here
        # args is a tuple with positional args, kwargs is dict with keyword args
        return func(*args, **kwargs)
    return wrapper 
```

之后，返回的函数`some_decorator`将接受与修饰函数相同数量的参数。

所以这两个例子都可以工作：

```
@some_decorator
def say_hello():
    print 'hello'

@some_decorator
def say_something(something):
    print something 
```

## 附录

为了给你一个完整的例子，如果你使用这样的结构会很好（注意使用`functools.wraps`）：

```
from functools import wraps
def some_decorator(func):
    @wraps(func)
    def wrapper(*args, **kwargs):
        # do something here
        # args is a tuple with positional args, kwargs is dict with keyword args
        return func(*args, **kwargs)
    return wrapper 
```

其原因在[文档`functools.wraps()`](http://docs.python.org/library/functools.html#functools.wraps)中列出：它保留了函数名称和文档字符串，有效地导致包装器看起来像一个包装的函数（有时很有用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T03:08:10.127

装饰的替代方法是使用[`sys.excepthook`](http://docs.python.org/library/sys.html#sys.excepthook)，它是对所有未捕获的异常进行操作的回调，您可以为其分配自定义日志记录函数。这样做的好处是，您不需要*破坏*（更重要的是，跟踪）您对记录异常感兴趣的每个函数。

# php - 组织mysql数据库

> ID：12362121
> 
> 赞同：0
> 
> 时间：2012-09-11T02:58:08.587
> 
> 标签：php, mysql, sql

我很难思考如何正确组织这个数据库。我有一个 7,000,000 行的表。每行都有一个计数、日期和一个非唯一名称。

例子：

```
name -- count -- date
blue -- 27 -- 2012-9-05
red  -- 12 -- 2012-10-05
blue -- 19 -- 2012-9-07
blue -- 13 -- 2012-10-4 
```

`name`存储每个月的总和的最佳方法是什么？如果必须使用服务器端语言来执行此操作，我只知道 PHP。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:06:43.007

我相信，最好在后端做。例如

```
SELECT NAME,date,SUM(Count) AS SumCount
FROM <Your TABLE>
GROUP BY NAME,MONTH(date) 
```

# java - 事件总线 Guava 有一个无界队列

> ID：12362123
> 
> 赞同：1
> 
> 时间：2012-09-11T02:58:25.513
> 
> 标签：java, events, garbage-collection, guava

我害怕使用事件总线[http://code.google.com/p/guava-libraries/wiki/EventBusExplained](http://code.google.com/p/guava-libraries/wiki/EventBusExplained)，因为我认为它在内部使用了无界队列。如果有很多消息发布到它。它可能会遇到完整的 gc。

是否存在类似的实现，它做同样的事情是无界队列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:10:05.107

事实上，Guava 使用了一个[`ConcurrentLinkedQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)，它是无界的：

> 基于链接节点的无界线程安全队列。

请参阅[EventBus.java 的第 151-158 行](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/eventbus/EventBus.java#150)。

> ```
> /** queues of events for the current thread to dispatch */
> private final ThreadLocal<ConcurrentLinkedQueue<EventWithHandler>>
>     eventsToDispatch =
>     new ThreadLocal<ConcurrentLinkedQueue<EventWithHandler>>() {
>   @Override protected ConcurrentLinkedQueue<EventWithHandler> initialValue() {
>     return new ConcurrentLinkedQueue<EventWithHandler>();
>   }
> }; 
> ```

您可以随时修改代码以使用例如[`ArrayBlockingQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ArrayBlockingQueue.html). 您是否研究过其他类似的解决方案，例如[中断](http://code.google.com/p/disruptor/)器？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T14:48:22.080

我同意 Arjit 的观点，即在某些情况下，无界队列可能被认为是不利的。例如，如果我有一个服务正在运行，它使用来自各种来源的消息来处理它们，而我不知道传入消息的速率。它可能会超过我的工人/消费者的处理速度，我可能想建立以下合同：如果仍有许多消息未决，向工人发布新消息将失败或阻塞。这不仅可以防止内存不足，还可以保证消息在特定时间范围内得到实际处理。此外，如果服务在其限制范围内运行，客户将收到直接反馈。

[@Arjit：您可以在https://github.com/bennidi/mbassador](https://github.com/bennidi/mbassador)上查看 MBassador

它与 Google Guava 事件总线非常相似，但提供了更多功能 - 有界消息队列就是其中之一。它也非常快，其内部设计允许大量定制和扩展。据了解，我能够在短时间内解决其他用户的大部分功能请求。也许你试一试。

# mysql - 我真的需要使用 MySQL 空间函数吗？

> ID：12362124
> 
> 赞同：1
> 
> 时间：2012-09-11T02:58:50.970
> 
> 标签：mysql, geolocation, spatial-index

好吧，我想听听你对这个案子的看法：

我需要一个最多有两个或三个表的数据库，其中一个将包含点（纬度，经度）和其他一些信息。

我需要的非常简单：获取给定半径内的点。

我不是在问如何去做（但任何建议都非常受欢迎，**特别是如果它是关于良好实践的**），我想知道使用 MySQL 的空间支持是否会有所帮助。由于只需一个查询就可以很容易地获得我需要的东西，因此我期望通过使用空间支持来提高**性能**。

那么，空间索引是否会有显着的帮助？我*认为*该表不会存储那么多点。我说不超过200。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:07:33.070

如果它真的只有 200 分，我建议你不要这样做：这使得编写可移植 SQL 变得更加容易（我认为这是一件重要的事情）。

编写你的SQL，首先检查经度和纬度与预先计算的最小值和最大值（给你一个矩形），然后检查半径。这样，您只需要计算半径，而无需最终选择结果集的 1/pi 的点。

我个人认为这是对编写 SQL 的可接受折衷，如果必须针对 SQlite 或其他任何东西执行的话。

# javascript - 识别 Javascript 中的重复函数

> ID：12362125
> 
> 赞同：3
> 
> 时间：2012-09-11T02:58:55.777
> 
> 标签：javascript

是否可以检测 Javascript 中的重复函数（在某些情况下可能是偶然编写的）？在谷歌浏览器中，

```
printLah(); //this prints "Haha" for some reason, without even printing an error message in the Javascript console!
function printLah(){
    alert("Hahah!");
}

function printLah(){
    alert("Haha");
} 
```

[这是在 JSfiddle 上。](http://jsfiddle.net/pyZe5/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T03:22:58.003

简短的回答是，**不，不是**。

这就是javascript的工作原理。函数名只是分配了函数的变量。例如：

```
function foo () {
    alert('foo!');
}

foo = 1;

foo(); 
```

上面的代码会产生错误，因为数字不是函数！函数名和变量名没有区别。事实上，定义函数的另一种方法看起来与定义变量的方式完全相同：

```
var foo = function () {
              alert('foo!');
          } 
```

正是由于这种将函数作为第一类对象的行为，javascript 无法阻止重新分配，否则您无法重新分配变量（另一方面，纯函数式语言在不允许变量重新分配方面没有问题）。

* * *

**变通方法和最佳实践：**

这就是人们一直说你不应该在 javascript 中定义太多全局变量的原因。这包括功能。否则它可能会与其他人的代码发生意外冲突。

javascript 中有两个强大的特性可以缓解这个问题：**对象**和**闭包**。

因为 javascript 支持对象，所以您应该使用面向对象编程来限制程序中全局变量的数量。与传统的 OOP 不同，javascript 在将对象用作集合或命名空间时效果更好。这是因为 javascript 没有文件范围，而且一切都是全局的。

这并不意味着您不应该像使用传统 OOP 那样创建封装较小问题的较小对象。这只是意味着如果可以的话，您应该将所有对象包含在一个父对象中。我在这里不是指继承，我是指在一个有关系中。查看 jQuery 和 Raphael 等流行库中的示例。他们只将一个对象导出到全局范围，以避免与其他人的代码发生冲突。

但是，同样，这并不能真正保护人们不重新分配您的对象（因为它们毕竟是变量）。例如，您可以在其他 javascript 部分有机会运行之前，在 HTML 文件的顶部执行此操作，从而轻松破坏 jQuery：

```
jQuery = null; 
```

保护代码不被篡改的方法是使用闭包。第三方代码无法访问您在闭包内运行的任何代码。只要您避免使用全局变量即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-11T03:34:58.270

只是从 slebetman 的回答开始，您可以在声明变量或函数之前使用以下内容检查是否存在。

```
if (typeof(functionName) == 'undefined') {
    functionName = function() { 
        // add code here
    }
} 
```

再一次，您进行此检查的原因是因为您希望/需要将某些内容放在全局范围内，即使通常不需要它。不使用 a`var`会将其隐式放入全局范围。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-03-01T11:27:23.983

试试这个。它对我有用！！！

```
$(document).ready(function () {
    var all_functions = [];
    var duplicate_functions = [];
    var reportRecipientsDuplicate = [];
    for (var i in window) {

        if ((typeof window[i]).toString() == "function") {
            if (window[i].name) {
                all_functions.push(window[i].name);
            }
        }
    }

    var all_functions1 = all_functions.sort();

    for (var i = 0; i < all_functions1.length - 1; i++) {
        if (all_functions1[i + 1] == all_functions1[i]) {
            duplicate_functions.push(all_functions1[i]);
        }
    }
    console.log("Duplicate functions on page");
    console.log(duplicate_functions);
}); 
```

# jquery - 解析 ajax HTML 响应，并追加结果

> ID：12362126
> 
> 赞同：1
> 
> 时间：2012-09-11T02:58:55.967
> 
> 标签：jquery, html, ajax, regex

我得到了需要使用 ajax 请求页面的条件。结果我得到了HTML。解析这些 HTML 结果，并将解析的 HTML 内容附加到当前页面。

假设这个 HTML 内容是请求的内容：

```
<html>
<head></head>
<body>

<div id="main">
<script type="text/javascript" src="http://script.com/js/script.js"></script>
</div>

</body>
</html> 
```

如何解析`#main`id 选择器（包括 javascript 文本）而不是将其附加到当前 HTML 的一部分。

```
jQuery.ajax({
    url: requestedurl,
    type : "POST",
    dataType : "text",
    success: function(data) {
        console.log(jQuery(data).find("#main"));
        // than append
    }
}); 
```

不使用 jquery 解析，而是使用正则表达式会更好吗？非常感谢您的帮助。

ps：我尝试使用 jquery 加载结果，我得到文本节点内容等。不幸的是我不知道如何解析它。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:40:01.107

您应该跳过文本节点。

我进入控制台`[ Text, <div id=​"main">​&lt;/div>​, <script type=​"text/​javascript" src=​"http:​/​/​script.com/​js/​script.js"></script>​, Text]`

所以就得到`jquery(data)[1]`

我在 test.html 中尝试了与您相同的方法：

```
<html>
<head></head>
<body>

<div id="main">
<script type="text/javascript" src="http://script.com/js/script.js"></script>
</div>

</body>
</html> 
```

在另一个文件中

```
 <script type="text/javascript">
    $(document).ready(function(){
       jQuery.ajax({
        url: './test.html',
        type : "POST",
        dataType : "html",
        success: function(data) {
            console.log(jQuery(data)[1]); //Then i got the main div
            // than append
        }
    });
   });
    </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:03:49.357

将您的数据类型从“文本”更改为“html”

# http - 缓冲液有什么作用

> ID：12362129
> 
> 赞同：0
> 
> 时间：2012-09-11T02:59:25.057
> 
> 标签：http, io, buffer

发现很多地方都用到了buffer，比如IO操作，通过网络传输数据，我对buffer的作用和如何确定buffer的大小没有搞清楚？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:35:39.170

缓冲区最常用于 I/O 操作处理大量数据或操作中需要非常低的延迟的情况。大多数 I/O 实现提供缓冲区默认值，但它们也可以轻松覆盖默认值，在某些情况下甚至替换缓冲基础结构，以便开发人员可以选择在更极端的情况下自定义事物。

如果您不处理大量数据或不处理大量用户，那么您可能可以使用大多数情况下提供的缓冲区默认值。

# php - php中的Alexa api

> ID：12362130
> 
> 赞同：1
> 
> 时间：2012-09-11T02:59:27.543
> 
> 标签：php

这是他们的样本，我不知道如何让它工作。 [http://aws.amazon.com/code/AWIS/402](http://aws.amazon.com/code/AWIS/402)

一直显示： Usage: $argv[0] ACCESS_KEY_ID SECRET_ACCESS_KEY site\n 不工作，当你填写：

```
 $urlInfo = new UrlInfo("myaccessKeyId", "mysecretAccessKey", "stackoverflow.com"); 
```

我该如何解决这个问题？

```
 public function UrlInfo($accessKeyId, $secretAccessKey, $site) {
        $this->accessKeyId = $accessKeyId;
        $this->secretAccessKey = $secretAccessKey;
        $this->site = $site;
    }

/**
 * Get site info from AWIS.
 */ 
public function getUrlInfo() {
    $queryParams = $this->buildQueryParams();
    $sig = $this->generateSignature($queryParams);
    $url = 'http://' . self::$ServiceHost . '/?' . $queryParams . 
        '&Signature=' . $sig;
    $ret = self::makeRequest($url);
    echo "\nResults for " . $this->site .":\n\n";
    self::parseResponse($ret);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:04:48.283

该脚本旨在从命令行运行，如下所示：

```
php urlinfo.php ACCESS_KEY_ID SECRET_ACCESS_KEY site 
```

它在自述文件中。如果你只是想使用这个类，你应该把 php 文件中第 122 行之后的东西拿出来。

# php - 在我的'foreach 语句中加入下一个/上一个

> ID：12362131
> 
> 赞同：1
> 
> 时间：2012-09-11T02:59:42.423
> 
> 标签：php, foreach

我想在我的页面上有一个上一个|下一个链接来更改图片。

我使用一个函数来获取相关元素。但是，我不知道我的函数中需要哪些附加代码以及将其放置在哪里。还有什么应该在 html 部分。

我已经查看了“foreach”的下一个/上一个页面的许多页面，但我似乎无法与它们联系起来。

代码：

```
function image_data($image_album_id) {
    $image_album__id = (int)$image_album_id;
    $args = func_get_args();
    unset($args[0]);
    $fields = '`'.implode('`, `', $args).'`';

    $query = mysql_query("SELECT $fields FROM `album_images`
    WHERE `image_album_id`=$image_album_id AND `member_id`= '1'");
    $ query_result = mysql_fetch_assoc($query);

    foreach ($args as $field) {
        $args[$field] = $query_result[$field];

    }
    return $args;
    } 
```

网页：

```
<a href="">Last</a>|
<a href="">Next</a>
</div>

<?php
 $image_album_id =$_GET['image_album_id'];
 $image_data = image_data($image_album_id, 'album_id', 'albumname', 'ext', 'timestamp');

 echo '';
 ?>

<td class="smallfont albumthumb2" align="center" valign="middle"  >
<a href="album_viewT.php?=<?php echo 'images/albums/thumbs/'. $image_data['album_id'].        '/'. $image_album_id. '.' .$image_data['ext']; ?> "></a>
<img alt="" class="album_cover" src="<?php echo 'images/albums/thumbs/'.       $image_data['album_id']. '/'. $image_album_id. '.' .$image_data['ext'];?> " height="175px"      width="175px">
</td> 
```

非常感谢。我希望我说得通。

* * *

感谢您的快速回复。

由于有很多东西要查看和消化，我想我会看看它是否有效。

唉，没有。

有一个解析错误：语法错误，意外的'<'在线

$prev_link = 上一个；

我在该部分中唯一注意到的是 'title="$prev_name"}' 之后的一个额外的大括号

我看到 'title="$next_name"}' 也一样

* * *

参考您的具体问题。

当我单击上一页中的链接时，我进入了 album_viewT 页面。这包含微小的缩略图。以 localhost/Testing/album_view.php?artist_id=4&image_album_id=4 为例。

不确定我是否完全理解“日期顺序是按 image_album_data

是的，数据库中有近 3,000 行。

我还应该提到album_id 已被artist_id 取代。

* * *

是否应该将 href 更改为“album_view.php/id/...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:54:40.120

您的问题缺少一些数据，即您正在访问的生成此代码的页面是什么（即 URL）以及您的数据是如何排序的。例如，我可以看到您正在使用`album_viewT.php?`脚本提供更多信息，但这不一定是显示您生成的 HTML 的信息。

因此，在这一切之后，我将做出一些假设，并希望这将为您提供正确的指导以找到解决方案。

*   我假设您的访问页面是[http://mysite.com/albums/id/25](http://mysite.com/albums/id/25)
*   我还假设数据的顺序是 image_album_id。
*   最后我假设你的数据库中有数据，我不需要检查当前图像的模板中是否有返回的数据。你需要自己解决这个问题。

您需要先从数据库中获取数据：

```
function image_data($image_album_id) 
{
    $results         = array(
                           'previous' => FALSE, 
                           'current'  => FALSE, 
                           'next'     => FALSE,
                       );
    $image_album__id = (int)$image_album_id;
    $args            = func_get_args();
    unset($args[0]);
    $fields = '`'.implode('`, `', $args).'`';

    // Current record 
    $results['current'] = get_data(
                              $fields, 
                              "AND image_album_id = {$image_album_id}"
                          );

    // Previous - no need to run this if we don't have a current
    if ($results['current'])
    {
        // Current record 
        $results['previous'] = get_data(
                                   $fields, 
                                   "AND image_album_id < {$image_album_id} " . 
                                   "LIMIT 1"
                               );
    }

    // Next - no need to run this if we don't have a current
    if ($results['current'])
    {
        // Current record 
        $results['next'] = get_data(
                               $fields, 
                               "AND image_album_id > {$image_album_id} " . 
                               "LIMIT 1"
                           );
    }

    // If all went well the $results array will contain the data 
    // for the 3 records. If we are at the beginning or the end, 
    // the previous and/or next will be FALSE
    return $results;
}

function get_data($fields, $where = '')
{
    $return = FALSE;

    // Template
    $template = "SELECT %s "
              . "FROM album_images "
              . "WHERE member_id = 1 %s";

    // Current record 
    $sql          = sprintf($template, $fields, $where);
    $query        = mysql_query($sql);
    $query_result = mysql_fetch_assoc($query);

    // If data has been found
    if ($query_result)
    {
        $return = $query_result;
    }

    return $return;
} 
```

对于您的 HTML 页面：

```
<?php
    $image_album_id = $_GET['image_album_id'];
    $image_data     = image_data(
                          $image_album_id, 
                          'album_id', 'albumname', 'ext', 'timestamp'
                      );

    $prev_link = '';
    $next_link = '';

    if ($image_data['previous'])
    {
        $prev_id   = $image_data['previous']['album_id'];
        $prev_name = $image_data['previous']['albumname'];
        $prev_link = <a href="/albums/id/{$prev_id}" title="$prev_name"}>Previous</a>";
    }

    if ($image_data['next'])
    {
        $next_id   = $image_data['next']['album_id'];
        $next_name = $image_data['next']['albumname'];
        $next_link = <a href="/albums/id/{$next_id}" title="$next_name"}>Next</a>";
    }

    $curr_id   = $image_data['current']['album_id'];
    $curr_ext  = $image_data['current']['ext'];
?>

<?php echo $prev_link; ?>|<?php echo $next_link; ?>
</div>

<td class="smallfont albumthumb2" align="center" valign="middle">
    <a href="album_viewT.php?images/albums/thumbs/
        <?php echo "{$curr_id}/{$image_album_id}.{$curr_ext}; ?>
        <img alt="" class="album_cover" 
             src="images/albums/thumbs/
                 <?php echo "{$curr_id}/{$image_album_id}.{$curr_ext}"; ?>
             height="175px"
             width="175px" />
    </a>
</td> 
```

注意：为了清楚起见，我在 HTML 文件中拆分了`img`和标记的行。`a`

# css - 垂直对齐 div 中的元素

> ID：12362134
> 
> 赞同：0
> 
> 时间：2012-09-11T03:00:35.887
> 
> 标签：css

我的 div 中有这些 chech 框，但它们都出现在 2 行中。

我想让它们垂直，这样一行中只会出现一个复选框，第二行出现第二个复选框，依此类推..

```
 <g:CheckBox > Article </g:CheckBox>
                <g:CheckBox > Form1 </g:CheckBox>
                <g:CheckBox > Payroll </g:CheckBox>
                <g:CheckBox > TAX </g:CheckBox>
                <g:CheckBox > Import/Export </g:CheckBox>
                <g:CheckBox > Business Consent Form </g:CheckBox>
                <g:CheckBox > HST </g:CheckBox> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:04:45.843

对于 HTML 代码，您可以这样写：

```
input {display: block;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:18:32.063

对于每个文本框元素，我会使用`clear:both;`它在右边或左边没有任何意义，因此跳过行。Clear 与`float`.

# css - 在 CSS 类中插入 CSS 类

> ID：12362136
> 
> 赞同：1
> 
> 时间：2012-09-11T03:01:00.023
> 
> 标签：css

我想要的是这样的代码：

```
class1:hover {
    background-color: #f9f9f9;
    box-shadow: 1px 1px 8px #E0DADF;

    class2 {
        opacity:0.5;
    }
} 
```

这甚至可能还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:03:38.507

```
.class1:hover {
    background-color: #f9f9f9;
    box-shadow: 1px 1px 8px #E0DADF;
}

.class1:hover .class2 {
    opacity: 0.5;
} 
```

或者使用[CSS 预处理器](http://css-tricks.com/musings-on-preprocessing/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:02:30.967

您需要使用[SASS](http://sass-lang.com/)或[LESS](http://lesscss.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:03:43.020

在[SASS](http://sass-lang.com/)或[SCSS](http://sass-lang.com/)的情况下，是的，这是可能的。但是如果你想嵌套 CSS 类，你可以这样做：

```
class1:hover{
    background-color:#f9f9f9;
    box-shadow: 1px 1px 8px #E0DADF;
}

class1:hover class2{
    opacity:0.5;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T03:07:04.293

只是为了添加一些东西。您还可以做的是使元素具有多个类。例如，

```
<div class="class1 class2"></div>
<div class="class2"></div> 
```

第一个`div`元素也将具有第二个元素的 css 样式。

# sql - 这两个查询的结果有什么不同吗？

> ID：12362141
> 
> 赞同：0
> 
> 时间：2012-09-11T03:01:39.490
> 
> 标签：sql, sql-server-2008

```
 Update @A set Column1 = minC     
         from (select Ab.Column2, min(C.Column1) as minC 
        from @A Ab 
        inner join B on Ab.Column2 = B.Column2 
        inner join C on C.column2 = B.Column2 --No need to add again the A.col2 = B.col2
        inner join D on D.column1 = B.column2
        group by Ab.Column2) Grouped where Column2 = Grouped.Column2 
```

和

```
 Update @A set Column1 = minC     
    from (select Ab.Column2, min(C.Column1) as minC, B.column2 as tempcolumn
        from @A Ab 
        inner join B on Ab.Column2 = B.Column2 
        inner join C on C.column2 = B.Column2 --No need to add again the A.col2=B.col2           
        group by Ab.Column2) Grouped 
        inner join D on D.column1 = Grouped.tempcolumn
        where Column2 = Grouped.Column2 
```

2个查询的结果有什么区别吗？

# sed - 从字符串中删除最后一个和第一个字符

> ID：12362142
> 
> 赞同：16
> 
> 时间：2012-09-11T03:01:47.667
> 
> 标签：sed, awk

`awk`使用/从字符串中删除第一个和最后一个字符相当容易`sed`吗？

说我有这个字符串 `( 1 2 3 4 5 6 7 )`

我想从中去掉括号。

我该怎么做？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-11T03:05:40.243

sed方式

```
$ echo '( 1 2 3 4 5 6 7 )' | sed 's/^.\(.*\).$/\1/'
 1 2 3 4 5 6 7 
```

笨方法

```
$ echo '( 1 2 3 4 5 6 7 )' | awk '{print substr($0, 2, length($0) - 2)}'
 1 2 3 4 5 6 7 
```

POSIX 方式

```
$ var='( 1 2 3 4 5 6 7 )'; var="${var#?}"; var="${var%?}"; echo "$var"
 1 2 3 4 5 6 7 
```

重击方式

```
$ var='( 1 2 3 4 5 6 7 )'; echo "${var:1: -1}"
 1 2 3 4 5 6 7 
```

* * *

如果您使用`bash`，则使用 bash 方式。

如果没有，请更喜欢 posix-sh 方式。它比加载`sed`或`awk`.

除此之外，您可能还会进行其他文本处理，您可以将其与此结合使用，因此取决于脚本的其余部分，您可能会受益于使用`sed`或`awk`最终受益。

* * *

> 为什么这不起作用？`sed '..' s_res.temp > s_res.temp`?

这不起作用，因为重定向`>`将在读取文件之前将其截断。为了解决这个问题，您有一些选择：

1.  你真正想做的是*编辑*文件。`sed`是*流编辑器*而不是文件编辑器。
    `ed`不过，它是一个文件编辑器（也是标准的！）。所以，使用`ed`：

    ```
     $ printf '%s\n' "%s/^.\(.*\).$/\1/" "." "wq" | ed s_res.temp 
    ```

2.  使用一个临时文件，然后用`mv`它来替换旧文件。

    ```
     $ sed 's/^.\(.*\).$/\1/' s_res.temp > s_res.temp.temp
     $ mv  s_res.temp.temp  s_res.temp 
    ```

3.  使用`-i`的选项`sed`。这仅适用于 GNU-sed，而`-i`不是**POSIX**和 GNU-only：

    ```
    $ sed -i 's/^.\(.*\).$/\1/' s_res.temp 
    ```

4.  滥用外壳（真的不推荐）：

    ```
     $ (rm test; sed 's/XXX/printf/' > test) < test 
    ```

* * *

在 Mac OS X（最新版本 10.12 - Sierra）`bash`上，卡在了`3.2.57`相当旧的版本上。始终可以`bash`使用[`brew`](https://brew.sh/)并获取`4.x`包含上述工作所需替换的版本。

在[bash-hackers wiki上编译了 bash 版本和相应更改的集合](http://wiki.bash-hackers.org/scripting/bashchanges)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-11-27T13:23:39.973

要从给定字符串中删除第一个和最后一个字符，我喜欢这样`sed`：

```
sed -e 's/^.//' -e 's/.$//'
#         ^^          ^^
# first char          last char 
```

看一个例子：

```
sed -e 's/^.//' -e 's/.$//' <<< "(1 2 3 4 5 6 7)"
1 2 3 4 5 6 7 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-25T14:36:17.350

还有一种 perl 方式：

```
perl -pe 's/^.|.$//g' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-17T06:23:06.070

如果我想使用 sed 删除前 (1) 个字符和后两 (2) 个字符。

输入 `"t2.large",`

输出`t2.large`

```
sed -e 's/^.//' -e 's/..$//' 
```

`

# c# - 在 c# 中使用闪烁自动显示新数据

> ID：12362145
> 
> 赞同：0
> 
> 时间：2012-09-11T03:01:58.503
> 
> 标签：c#, timer, flicker

我正在使用 c# 制作一个表单，它将显示 android 发送的数据。为了使用起来更方便，我每分钟都使用定时器闪烁。这将使表单自动更新。

但是，当它显示与之前发送的相同数据时，闪烁有点恼火。该表单假设仅在用户单击 SENT 按钮时显示，并且此数据不会像下图那样重复显示。

![在此处输入图像描述](../Images/216690353783769523be5ab95f164be6.png)

这是我的表格代码

```
private void button6_Click(object sender, EventArgs e){
//retrieved data sent by android using ip address
do
            {               
                for (int i = 0; i <= _server.Q.NoOfItem - 1; i++)
                {
                    String words = _server.Q.ElementAtBuffer(i).ToString();
                    String[] berjaya = words.Split(new char[] { ',', '[', ']', ' ' });

                    listView1.Items.Clear();

                            listviewitem = new ListViewItem(berjaya[13]);//eta                            
                            listviewitem.SubItems.Add(berjaya[1]);//prio
                            listviewitem.SubItems.Add("777");//ambulansID
                            listviewitem.SubItems.Add("16/08/2012");//date
                            this.listView1.Items.Add(listviewitem);

                            listView1.FullRowSelect = true;

                            //show header
                            listView1.View = View.Details;
}

//do the timer flicker that been set for every minutes
private void timer1_Tick_1(object sender, EventArgs e)
        {           
            button6_Click(sender, e);
        } 
```

此代码首先将检索 android 使用 IP 地址发送的数据`for (int i = 0; i <= _server.Q.NoOfItem - 1; i++)`。接下来我拆分数据并将其显示到它自己的listviewitem。该数据将每分钟自动更新一次，并且假设仅显示用户发送的新数据，并且不会冗余。有谁知道如何解决这个问题？

# http - 有被压缩的请求是合法的 http/rest 吗？

> ID：12362149
> 
> 赞同：5
> 
> 时间：2012-09-11T03:02:59.053
> 
> 标签：http, rest

几天前我问了[这个问题，但我没有得到很多活动。](https://stackoverflow.com/questions/12345292/how-do-enable-a-net-web-api-to-accept-g-ziped-posts)这让我想到，也许这是因为我的问题很荒谬。

我对http的理解是客户端（典型的浏览器）向服务器发送请求（get），在我的例子中是IIS。该请求的一部分是 accept-encoding 标头，它向服务器指示客户端希望返回资源的编码类型。通常这可能包括 gZip。如果服务器设置正确，它将以请求的编码返回请求的资源。

响应将包含一个 Content-Encoding 标头，指示已对资源应用了何种压缩。响应中还包括 Content-Type 标头，它指示资源的 mime 类型。因此，如果响应包含 Content-Type : application/json 和 Content-Encoding: gzip，则客户端知道资源是使用 gzip 压缩的 json。

现在我面临的情况是，我正在为不是浏览器而是移动设备的客户端开发 Web 服务，并且这些设备不会请求资源，而是将数据发布到服务以进行处理。

所以我实现了一个 Restfull 服务，它接受正文中带有 json 的 post 请求。我的客户使用 Content-Type:Application/json 发送他们的帖子请求。但是我的一些客户要求他们想要压缩他们的请求以加快传输速度。但我的理解是，无法在请求中表明请求的正文已使用 gZip 进行编码。

也就是说，请求没有 content-Encoding 标头，只有响应。

是这样吗？

尝试压缩请求是否不正确使用http？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:15:12.870

根据[SO 上的另一个答案](https://stackoverflow.com/a/1184122/14955)，在 HTTP 标准中，在请求上有一个 Content-Encoding 标头并发送放气的实体。

不过，似乎没有服务器会自动为您增加数据，因此您必须自己编写服务器端代码（检查请求标头并采取相应措施）。

# java - glassfish 更新后 JSF 导航规则不起作用

> ID：12362150
> 
> 赞同：1
> 
> 时间：2012-09-11T03:03:16.010
> 
> 标签：java, jsf-2, glassfish-3, netbeans-7

我有类似的导航规则

```
<navigation-case>
  <description>
  Global rule for going to the items page from any page  
  </description>
  <from-outcome>items</from-outcome>
  <to-view-id>/items.xhtml</to-view-id>
  <redirect>
    <view-param>
      <name>page</name>
      <value>#{itemsBean.page}</value>
    </view-param>  
  </redirect>  
  </navigation-case> 
```

在该规则中，我使用了 RequestScoped 的 itemsBean 中的变量“page”。

当我使用 Netbeans 7.0.1 和 GlassFish 3.1.1 时，它运行良好。但是在更新到 NetBeans 7.2 和 GlassFish 3.1.2.2 后，规则不起作用。地址字符串中有“#{itemsBean.page}”而不是它的值。似乎规则中的表达式不起作用，但为什么呢？

PS 我做了一个简单的项目在家里进行测试，发现 JBoss AS 7.1.1.Final 与 GlassFish 3.1.2.2 一样使用导航规则。也许这是一个特点？

谢谢你浪费你的时间。

# regex - 提取特定字符串

> ID：12362151
> 
> 赞同：0
> 
> 时间：2012-09-11T03:03:26.443
> 
> 标签：regex, string, qt, qt4

我有以下 QString，我只想提取 access_token 值，即“http%3a%2f%2fschemas.xmlsoap .....” 怎么做？

> {"token_type":"http://schemas.xmlsoap.org/ws/2009/11/swt-token-profile-1.0","access_token":"http%3a%2f%2fschemas.xmlsoap.org%2fws% 2f2005%2f05%2fidentity%2fclaims%2fnameidentifier=asdasr21321214a%2f%2fschemas.microsoft.com%2faccwresscontrolservice%2f2010%2f07%2fclaims%2fidentityprovider=https%3a%2f%2fdatamarket.accesscontrol.windows.net%2f&Audience=http%3a% 2f%2fapi.microsofttranslator.com&ExpiresOn=1347332993&Issuer=https%3a%2f%2fdatamarket.accesscontrol.windows.net%2f&HMACSHA256=sFqvp2a2xXc3VBdxYZ6xHQf%2fKkOydnuX6VK7A6Yf55k%3d","expires_in":"599" api.microsofttranslator.com"}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:20:46.977

[在http://qjson.sourceforge.net/](http://qjson.sourceforge.net/)上查看 QJson 。

您可以轻松地将字符串解析为标记化属性。从使用页面：

```
QJson::Parser parser;
QString json = "{your json above}";
bool ok;
QVariant result = parser.parse (json, &ok);
qDebug() << result["access_token"].toString(); 
```

玩得开心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:16:20.047

试试这个正则表达式：

`\"access_token\":\"([^\"]*)\"`

解释：

**`( subexpression )`**
`Captures the matched subexpression and assigns it a zero-based ordinal number.`

**`[^ character_group ]`**
`Negation: Matches any single character that is not in character_group. By default, characters in character_group are case-sensitive.`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T22:30:06.047

又快又脏，仅用于 QString::section 的演示：

```
QString Data("{...you json data...}");
QString AccessToken = data.section("access_token\":\"",1).section("\"",0,0); 
```

考虑：QString::section 缓慢而沉重，在后台创建 QStringList 并将标记转换为 RegExp。但在某些情况下，我仍然经常使用它。

# android - 过滤时自定义 ArrayAdapter 不更新

> ID：12362158
> 
> 赞同：1
> 
> 时间：2012-09-11T03:03:51.350
> 
> 标签：android, android-listview, listadapter

我已经从[本教程](http://geekswithblogs.net/bosuch/archive/2011/01/31/android---create-a-custom-multi-line-listview-bound-to-an.aspx)中实现了一个 CustomArrayAdapter，以便为列表视图的每个条目提供一个缩略图和 2 行。除了过滤之外，它工作得很好。我一直在尝试在[this](https://stackoverflow.com/questions/2208225/android-how-do-i-overwrite-the-filter-for-my-arrayadapter)、[this](https://stackoverflow.com/questions/10379261/extending-arrayadapter-in-android)和[this](https://stackoverflow.com/questions/10379261/extending-arrayadapter-in-android)问题之后实现过滤，但列表视图永远不会更新。

这是我的多行布局代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="?android:attr/listPreferredItemHeight"
android:padding="6dip">

<ImageView
    android:id="@+id/thumb"
    android:background="@drawable/thumb"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_marginRight="6dip"
    android:layout_marginTop="2dip"
    android:layout_marginBottom="2dip"/>

<LinearLayout
    android:orientation="vertical"
    android:layout_width="0dip"
    android:layout_weight="1"
    android:layout_height="fill_parent">

    <TextView
        android:id="@+id/custom_title"
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="1"
        android:textColor="@color/black"
        android:gravity="center_vertical"
        />

    <TextView  
        android:id="@+id/desc"
        android:layout_width="fill_parent"
        android:layout_height="0dip"
        android:layout_weight="1" 
        android:textColor="@color/darkgray"
        android:textStyle="italic"
        android:singleLine="true"
        android:ellipsize="marquee"
         />

</LinearLayout> 
```

这是我的 customListAdapter 代码（在[第一个链接](https://stackoverflow.com/questions/2208225/android-how-do-i-overwrite-the-filter-for-my-arrayadapter)之后）

```
public class CustomListAdapter extends ArrayAdapter implements Filterable{

private static ArrayList<CustomListItem> searchArrayList;
private static ArrayList<CustomListItem> subItems;
private PTypeFilter filter;

 private LayoutInflater mInflater;

 public CustomListAdapter(Context context, int textViewResourceId, ArrayList<CustomListItem> results) {
     super(context,textViewResourceId, results);
  searchArrayList = results;
  mInflater = LayoutInflater.from(context);
 }
 public int getCount() {
      return searchArrayList.size();
     }

     public Object getItem(int position) {
      return searchArrayList.get(position);
     }

     public long getItemId(int position) {
      return position;
     }

     public View getView(int position, View convertView, ViewGroup parent) {
      ViewHolder holder;
      if (convertView == null) {
       convertView = mInflater.inflate(R.layout.custom_row, null);
       holder = new ViewHolder();
       holder.txtTitle = (TextView) convertView.findViewById(R.id.custom_title);
       holder.txtDesc = (TextView) convertView.findViewById(R.id.desc);
       holder.thumb = (ImageView) convertView.findViewById(R.id.thumb);

       convertView.setTag(holder);
      } else {
       holder = (ViewHolder) convertView.getTag();
      }

      holder.txtTitle.setText(searchArrayList.get(position).getTitle());
      holder.txtDesc.setText(searchArrayList.get(position).getDesc());
      holder.thumb.setImageBitmap(searchArrayList.get(position).getThumb());
      //holder.thumb.setBackgroundColor(Color.BLACK);

      return convertView;
     }

     static class ViewHolder {
      TextView txtTitle;
      TextView txtDesc;
      ImageView thumb;
     }       

     @Override
     public Filter getFilter() {
         Log.i("CustomListAdapter", "testing filter");
         if (filter == null){
           filter  = new PTypeFilter();
         }
         return filter;
       }

  private class PTypeFilter extends Filter{

@SuppressWarnings("unchecked")
@Override
protected void publishResults(CharSequence prefix,
                              FilterResults results) {
  // NOTE: this function is *always* called from the UI thread.
   subItems =  (ArrayList<CustomListItem>)results.values;

    notifyDataSetChanged();
}

@SuppressWarnings("unchecked")
protected FilterResults performFiltering(CharSequence prefix) {
      // NOTE: this function is *always* called from a background thread, and
      // not the UI thread. 

      FilterResults results = new FilterResults();
      ArrayList<CustomListItem> i = new ArrayList<CustomListItem>();

      if (prefix!= null && prefix.toString().length() > 0) {

          for (int index = 0; index < searchArrayList.size(); index++) {
              CustomListItem si = searchArrayList.get(index);
              if(si.toString().compareTo(prefix.toString()) == 0){
                i.add(si);  
              }
          }
          results.values = i;
          results.count = i.size();                   
      }
      else{
          synchronized (searchArrayList){
              results.values = searchArrayList;
              results.count = searchArrayList.size();
          }
      }

      return results;
   }
 }     
} 
```

从我的主要活动中，我这样称呼自定义基本适配器：

```
adapter = new CustomListAdapter(this, R.id.custom_title, DATA);
setListAdapter(adapter); 
```

（不是 100% 确定那`R.id.custom_title`是我应该放在那里的 id。

我添加了调试消息，并且正在调用 TextChange，作为 getFilter() 方法。所以我不知道我做错了什么。在我从 ListAdapter 切换到 CustomListAdapter 之前，过滤工作正常:(

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:04:01.583

未`ListView`过滤，因为您设置了`subItems`在适配器类中未使用的过滤结果，因此`notifyDataSetChanged`从适配器的角度来看，数据是完整的，因此调用将不起作用。您使用另一个列表来保存旧值是正确的，它们将是必需的，因此您拥有所有旧值。要解决此问题，请添加以下行：

```
subItems = new ArrayList<CustomListItem>(searchArrayList); 
```

在适配器的构造函数中，这是为了让您拥有完整值的副本以供以后使用。然后在`publishResults`方法中使用`searchArrayList`列表，因为那是支持适配器的列表：

```
searchArrayList =  (ArrayList<CustomListItem>)results.values;
notifyDataSetChanged(); 
```

然后在`performFiltering`方法中：

```
 if (prefix!= null && prefix.toString().length() > 0) {
      // use the initial values !!! 
      for (int index = 0; index < subItems.size(); index++) {
          CustomListItem si = subItems.get(index);
          final int length = prefix.length();
          // if you compare the Strings like you did it will never work as you compare the full item string(you'll have a match only when you write the EXACT word)
          // keep in mind that you take in consideration capital letters!
          if(si.toString().substring(0, prefixLength).compareTo(prefix.toString()) == 0){
            i.add(si);  
          }
      }
      results.values = i;
      results.count = i.size();                   
  }
  else{
      // revert to the old values 
      synchronized (searchArrayList){
          results.values = subItems;
          results.count = subItems.size();
      }
  } 
```

我希望它有效。

> （不是 100% 确定 R.id.custom_title 是我应该放在那里的 id。

这并不重要，因为您使用自己的自定义适配器。

# javascript - Test for a specific text format in a text area

> ID：12362160
> 
> 赞同：2
> 
> 时间：2012-09-11T03:04:01.570
> 
> 标签：javascript, html

I am writing some javascript to validate user input in a text area. Here are the requirements for input format:

1.  Input must be in the format of two hex values separated by a space (i.e. A7 B3 9D).
2.  Input must be valid hex values.

I have requirement #2 sorted out with a regExpression `valueOne.match("[0-9A-Fa-f]{1}")` (or at least I hope that is the recommended way to do it). So I am just looking for some input on how to go about handling requirement number one in a simple and efficient way.

Thanks!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T03:09:14.517

This regex will do it:

```
/^[0-9A-F]{2}(\s[0-9A-F]{2})*$/i 
```

That is:

```
^                // beginning of string
[0-9A-F]{2}      // two characters of 0-9 or A-F
(\s[0-9A-F]{2})* // zero or more instances of a space followed by
                 // two characters of 0-9 or A-F
$                // end of string 
```

Where the `i` flag at the end makes it case insensitive.

To use it:

```
 var valueOne = // set to your textarea's value here
 if (/^[0-9A-F]{2}(\s[0-9A-F]{2})*$/i.test(valueOne)) {
     // is OK, do something
 } else {
     // is not OK, do something
 } 
```

# jquery - jQuery/Ajax 未定义 PHP MySQL

> ID：12362163
> 
> 赞同：0
> 
> 时间：2012-09-11T03:04:29.583
> 
> 标签：jquery, function, undefined

当用户单击单选按钮时，我正在尝试更新 MySQL 数据库。我打算使用 jQuery/Ajax 来完成这个。我查看了这个网站和其他网站，看看我做错了什么，但我找不到答案。

第一页代码：

```
<script type="text/javascript" src="http://www.njacfootball.com/styles/autofill/jquery.js"></script>
<script type="text/javascript">
  $(document).ready(UpdateRecord(gid, user, pick, wk) {
    jQuery.ajax({
      type: "POST",
      url: "savePick.php",
      data: {
        gid: gid
        usr: user
        pk: pick
        wk: wk
      },
      cache: false,
      success: function(response)
      {
        alert("Pick successfully updated/saved");
      }
    }
  });
</script> 
```

[查询mysql数据库]

```
 $i=0;

while ($i < $num) {
$date=mysql_result($result,$i,"dt");
$gid=mysql_result($result,$i,"SchedID");
$wk=mysql_result($result,$i,"SchedWk");
$away=mysql_result($result,$i,"away");
$time=mysql_result($result,$i,"ftime");
$home=mysql_result($result,$i,"home");
$hscore=mysql_result($result,$i,"hscore");
$ascore=mysql_result($result,$i,"ascore");
$status=mysql_result($result,$i,"status");
$upick=mysql_result($result,$i,"Pick");
$ucor=mysql_result($result,$i,"Correct");

$formatteddate = strftime("%A %b %d, %Y", strtotime($date));
?>   
<input type="hidden" name="<? echo "gid_".$i; ?>" value="<? echo $gid; ?>" />
<table width="75%" border="0" align="center" style="border-width: 1px; border-color:#000000; border-style: solid;"><tr>
  <th width="50%"><div align="left"><span class="style8"><? echo $formatteddate; ?>  <? echo $time;?>M</span><br />
  <th width="15%"><span class="style7">Who Wins?</span></th>
<th width="25%"><span class="style7">
<? 
if ($status=='F') {
    echo "Final";  }
else {
    echo $status; } ?>

</span></th>
<th>Correct?</th>
</tr>
<tr>
<td><div align="center" class="style7">
  <div align="right"><? print "$away"; ?></div>
</div></td>
<td> <div align="center" class="style7">
    <? if ($upick==$away) { 
            if (($today==$date) && ($status=='')) { 
                if (($curtime>$time) && ($status=='')) {  ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" checked="checked" disabled="disabled" />
           <? } if (($curtime<$time) && ($status=='')) {  ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" checked="checked" onClick="UpdateRecord(<? echo $gid; ?>, <? echo $userid; ?>, '<? echo $away; ?>', <? echo $wk; ?>);" /> <? } 
                    } 
            else if (($today>$date) && ($status=='')) { ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" checked="checked" disabled="disabled" />
      <? }  else if (($today<$date) && ($status=='')) { ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" checked="checked" onClick="UpdateRecord(<? echo $gid; ?>, <? echo $userid; ?>, '<? echo $away; ?>', <? echo $wk; ?>);" />    

    <? }  }  else { 
    if (($today==$date) && ($status=='')) { 
                if (($curtime>$time) && ($status=='')) {  ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" disabled="disabled" />
               <? } if (($curtime<$time) && ($status=='')) {  ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" onClick="UpdateRecord(<? echo $gid; ?>, <? echo $userid; ?>, '<? echo $away; ?>', <? echo $wk; ?>);" /> <? } } 
    else if (($today>$date) && ($status=='')) { ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" disabled="disabled" />
             <? }  else if (($today<$date) && ($status=='')) { ?>
                    <input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" onClick="UpdateRecord(<? echo $gid; ?>, <? echo $userid; ?>, '<? echo $away; ?>', <? echo $wk; ?>);" />  

    <? }  }  
    if ($status<>'') {
        if ($upick==$away) { 
            ?><input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" checked="checked" disabled="disabled" /><?
        }
        else {
            ?><input name="pick_<? echo $i; ?>" type="radio" id="pick_<? echo $i; ?>" value="<? print $away; ?>" disabled="disabled" />
        <? }
    }
    ?>
</div></td>
<td> <div align="center"><span class="style7"><? echo $ascore; ?></span></div></td>
<td>
    <div align="center">
      <?
    if (($status=='F') && ($ucor=='Y') && ($upick==$away)) {
        ?>
      <img src="/images/check.jpg" alt="yes" height="21px" />
      <?
    }
    else if (($status=='F') && ($ucor=='N') && ($upick==$away)) {
        ?>
      <img src="/images/x.jpg" alt="no" height="21px" />    
      <?
    }
?> 
```

[代码继续]

第 2 页上的代码：

```
{connection info}

include ("../../../styles/variables.php");

    $gameid = $_POST["gid"];
    if (!$gameid) return;

    $usr = $_POST["usr"];
    if (!$usr) return;

    $upk = $_POST["pk"];
    if (!$upk) return;

    $weeknumb = $_POST["wk"];
    if (!$upk) return;

    $query="SELECT UserID, Week, GameID, Pick FROM $picktable WHERE GameID='".$gameid."' AND UserID='".$usr."'"; 
    $result=mysql_query($query) or die(mysql_error());
    $n=mysql_numrows($result);
    if ($n==0) {
        $q1="INSERT INTO $picktable (GameID, UserID, Week, Pick) VALUES ('".$upk."','".$usr."','".$weeknumb."','".$pick."')";
        $result1=mysql_query($q1) or die(mysql_error());  }  
     else {
        $old_pick=mysql_result($result,0,"Pick");
        if ($old_pick<>$upk) {
            $q2="UPDATE $picktable SET Pick='".$upk."' WHERE GameID='".$gameid."' AND UserID='".$usr."'";
            $result2=mysql_query($q2) or die(mysql_error());  } 

    mysql_close();

?> 
```

使用 firebug，单击单选按钮时，出现以下错误：

> ReferenceError：未定义 UpdateRecord [中断此错误]
> 
> UpdateRecord(448, 24, "团队", 2);

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:16:26.660

如果没有随之而来的 HTML，我们将无济于事，因为我们不知道在哪里`gid, user, pick, wk`定义。您需要在 HTML 中输出它们，例如

`<input class='ajaxSubmit' type="radio" gid="23892" user="myUser" pick="myPick" wk="myWk"/>`

然后在单击时执行提交 ajax：

```
$(document).ready(function(){
    $('.ajaxSubmit').on('click',function(){
        var gid = $(this).attr('gid');
        var user = $(this).attr('user');
        var pick = $(this).attr('pick');
        var wk = $(this).attr('wk');
        $.ajax({
            type: "POST",
            url: "savePick.php",
            data: {
                gid: gid
                usr: user
                pk: pick
                wk: wk
            },
            cache: false,
            success: function(response)
            {
                alert("Pick successfully updated/saved");
            }
        }
    });
    });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:09:04.983

将 UpdateRecord 移出 DOM 准备就绪。然后将处理程序附加到文档就绪内的单选按钮。

```
var UpdateRecord = function(gid, user, pick, wk) {}

$(function(){
    $('input[type=radio]').on( "change" , function(){
        UpdateRecord(....)
    });
}); 
```

# javascript - how to get week number of a year where sunday as the first day of a week in javascript

> ID：12362164
> 
> 赞同：-2
> 
> 时间：2012-09-11T03:04:31.497
> 
> 标签：javascript, date, calendar

how to get week number of a year where sunday as the first day of a week in javascript, also the fixed year number?

e.g. `2012-12-31` should have the same year number and week number with `2013-01-01`.

I found a snippet to do this, but the week is always start from monday not sunday, how to fix it?

```
exports.getYearAndWeek = function(d) {
    // Copy date so don't modify original
    d = new Date(d);
    d.setHours(0,0,0);
    // Set to nearest Thursday: current date + 4 - current day number
    // Make Sunday's day number 7
    d.setDate(d.getDate() + 4 - (d.getDay()||7));
    // Get first day of year
    var yearStart = new Date(d.getFullYear(),0,1);
    // Calculate full weeks to nearest Thursday
    var weekNo = Math.ceil(( ( (d - yearStart) / 86400000) + 1)/7)
    // Return array of year and week number
    return [d.getFullYear(), weekNo];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:47:41.247

The first week of a year, for weeks starting with Monday, is the first week that has a Thursday in it, as your code suggests.

If your weeks start with Sunday, the first week will be the first week containing a Wednesday.

If the year starts on Thursday to Saturday the days until Sunday will be in the last week of the previous year. If the year starts on Monday, Tuesday or Wednesday, the last Sunday of the previous year is the beginning of the first week of this year.

# ios - 在 UIStoryBoard 上缓存 UIViewControllers 以获得更好的性能

> ID：12362170
> 
> 赞同：0
> 
> 时间：2012-09-11T03:05:35.013
> 
> 标签：ios, xcode, storyboard, uistoryboard

我正在构建一个待办事项应用程序。

我正在使用 iOS 5 中引入的新故事板选项。

我注意到 VC 没有被缓存，这在我的应用程序上产生了性能问题。

我的应用程序的一个 VC 标题为“任务详细信息”并且被广泛使用。我注意到 viewDidLoad: 每次显示屏幕时都会调用大约一秒钟（这是一个相当复杂的屏幕，由代码构建）。

起初我使用segues并将其他屏幕连接到这个屏幕。每当需要时，我都会使用：

```
 [self performSegueWithIdentifier:@"showTaskDetails" sender:self]; 
```

我会准备它的模型：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender; 
```

然后我注意到了性能问题。我调查并看到 viewDidLoad 一次又一次地加载。我被迫停止使用 segues 并缓存 TaskDetailsViewController 并手动将其添加为模态。我想知道是否有在storyBoards 上缓存“流行” VC 的解决方案。否则，我最终会得到一个半对半的解决方案，它可以工作但不太优雅——优雅在我们的职业中很重要，不是吗？;-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T08:07:07.040

UIStoryboard 不提供任何缓存机制。您必须自己缓存视图控制器。

您可以缓存特定视图控制器所基于的数据，以便加载时间更快。

# asp.net-mvc - 在控制器执行的什么时候填充 TempData

> ID：12362173
> 
> 赞同：1
> 
> 时间：2012-09-11T03:05:54.973
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我的控制器有一个基类。在基类的构造函数中，我试图从 TempData 填充 ViewBag 属性。但是，此时似乎没有填充 TempData，也没有在 OnBeginExecute 方法中填充。

我需要在基类中填充这个 ViewBag 属性，因为所有控制器都需要相同的变量（这是一个重定向消息）。

我可以使用基类中的哪个控制器覆盖来执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T04:20:45.103

TempData 以及任何与 HttpContext 相关的东西在控制器构造函数中不可用。您可以从[Initialize](http://msdn.microsoft.com/en-us/library/system.web.mvc.controller.initialize.aspx)方法开始使用它们。因此，如果您需要以全局方式为控制器填充它们，请覆盖此方法或编写自定义操作过滤器并用它装饰您的控制器：

```
public class HomeController: Controller
{
    protected override void Initialize(RequestContext requestContext)
    {
        base.Initialize(requestContext);
        // now you can access the HttpContext
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T03:41:28.613

看看[`BeginExecuteCore`](http://msdn.microsoft.com/en-us/library/system.web.mvc.asynccontroller.beginexecutecore%28v=vs.100%29.aspx)：

```
protected override IAsyncResult BeginExecuteCore(AsyncCallback callback, object state)
{
    // TempData is not populated here
    var result = base.BeginExecuteCore(callback, state);
    // TempData is populated here

    return result;
} 
```

# jquery - jQuery replaceWith() 每个元素的第一个

> ID：12362175
> 
> 赞同：0
> 
> 时间：2012-09-11T03:06:09.280
> 
> 标签：jquery, replace, element, each, nav

尝试复制`.postNav`页面上的第一个并用它替换所有后续导航。我已经简化了它并且逻辑似乎正确，但是该函数仅在我传递字符串而不是元素时才有效。

JS小提琴！[http://jsfiddle.net/cwMhh/1/](http://jsfiddle.net/cwMhh/1/)

HTML：

```
<nav class="postNav">
    <ul>
        <li><a href="#pageHeader">link to header</a></li>
        <li><a href="#one">link to other posts</a></li>
        <li><a href="#two">link to other posts</a></li>
        <li><a href="#three">link to other posts</a></li>
        <li><a href="#four">link to other posts</a></li>
        <li><a href="#five">link to other posts</a></li>
    </ul>
</nav> 
```

JavaScript：

```
$('.postNav:gt(0)').each(function(){
    $(this).replaceWith($('.postNav:eq(0)'));
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:12:09.907

你必须[`.clone()`](http://api.jquery.com/clone/)元素：

```
$('.postNav:gt(0)').replaceWith(function () {
    return $('.postNav:first').clone();
}); 
```

* * *

为了获得更好的性能，缓存选择器：

```
var $navs = $('.postNav'),
    $replaceWith = $navs.first();

$navs.not( $replaceWith ).replaceWith(function () {
    return $replaceWith.clone();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:10:50.610

```
var replaceHTML = $('.postNav:first').html();
$('.postNav:gt(0)').each(function(){
    $(this).replaceWith(replaceHTML);
}); 
```

# r - 如何删除具有单个值的数据框列

> ID：12362176
> 
> 赞同：10
> 
> 时间：2012-09-11T03:06:11.773
> 
> 标签：r, dataframe

假设我在 R 中有以下数据框：

```
df1 <- data.frame(Item_Name = c("test1","test2","test3"), D_1=c(1,0,1),
                  D_2=c(1,1,1), D_3=c(11,3,1)) 
```

我想创建一个函数来删除没有差异的列（例如，在这种情况下，它会删除列`D_2`，因为它只有 1 个值）

我知道我可以手动检查它，但实际上我的数据非常大，我想自动化它。任何想法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-11T03:09:16.073

`Filter`在这里是一个有用的功能。我将只过滤那些有超过 1 个唯一值的。

IE

```
Filter(function(x)(length(unique(x))>1), df1)

##   Item_Name D_1 D_3
## 1     test1   1  11
## 2     test2   0   3
## 3     test3   1   1 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-11T03:09:20.807

你可以做：

```
df1[c(TRUE, lapply(df1[-1], var, na.rm = TRUE) != 0)]
#   Item_Name D_1 D_3
# 1     test1   1  11
# 2     test2   0   3
# 3     test3   1   1 
```

这篇`lapply`文章告诉你哪些变量有一些差异：

```
lapply(df1[-1], var, na.rm = TRUE) != 0
#   D_1   D_2   D_3 
#   TRUE FALSE  TRUE 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-12-04T10:09:41.617

在`dplyr`中，我们可以使用`n_distinct`来计算唯一值并`select_if`选择列

```
library(dplyr)
df1 %>% select(where(~n_distinct(.) > 1))
#For dplyr < 1.0.0
#df1 %>% select_if(~n_distinct(.) > 1)

#  Item_Name D_1 D_3
#1     test1   1  11
#2     test2   0   3
#3     test3   1   1 
```

我们可以使用与`purrr`'s`keep`和相同的逻辑`discard`

```
purrr::keep(df1, ~n_distinct(.) > 1)
purrr::discard(df1, ~n_distinct(.) == 1) 
```

* * *

除了`data.table`这样做的方式可能是

```
library(data.table)

setDT(df1)
df1[, lapply(df1, uniqueN) > 1, with = FALSE] 
```

或者这可能更聪明/更好

```
df1[, .SD, .SDcols=lapply(df1, uniqueN) > 1] 
```

* * *

在上述所有方法中，您可以在仅对数字列进行子集化后替换`n_distinct`/或函数。`uniqueN``var``sd`

例如，

```
df1[-1] %>% select_if(~sd(.) != 0) 
```

# javascript - 如何在 HTML 列表的项目符号上添加事件？

> ID：12362178
> 
> 赞同：-3
> 
> 时间：2012-09-11T03:06:20.383
> 
> 标签：javascript, jquery, html, javascript-events

如何在 HTML 列表的项目符号上添加事件？可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:19:49.967

你想处理点击事件还是其他东西，比如 DOMSubtreeModified？这是一个例子：http: [//jsfiddle.net/quant/At7xd/](http://jsfiddle.net/quant/At7xd/)

HTML：

```
<h1>Some simple events</h1>
<ul id="list">
    <li>Item 1</li>
    <li>Item 2</li>
</ul>
<button>Add Item</button>​ 
```

JavaScript：

```
jQuery(document).ready(function($) {
    $("#list").on("DOMSubtreeModified", function(e) {
        console.log("DOMSubtreeModified event", e);
        $("h1").toggleClass("crazy");
    });
    $("#list").on("click", "li", function(e) {
        console.log("Clicked on an li:", $(e.currentTarget).html(), e);
        e.stopPropagation();
    });
    $("button").on("click", function(e) {
        console.log("Clicked on button", e);            
        $("#list").append("<li>Item " + ($("#list > li").size() + 1) + "</li>");
    } );
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:12:11.173

```
$('ul li').on( "click" , function(){
    // do stuff
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:14:04.157

您可以使用

```
$(document).ready(function() {
  $("li").click(function(event){
    // do something
  });
} 
```

# php - 为什么 Windows 上的 strftime() 返回 false？（我没有使用 %e）

> ID：12362179
> 
> 赞同：5
> 
> 时间：2012-09-11T03:06:25.190
> 
> 标签：php, windows-7-x64

这是我的代码：

```
var_dump(strftime("%m-%d-%Y %l:%M:%S", time()));
echo "<br />";
var_dump(strftime("%Y-%d-%m %H:%M:%S", time())); 
```

第一行返回 false，第三行返回预期字符串 '2012-10-09 23:03:18' (length=19)

为什么第一行返回假？

我正在运行 Windows 7x64 并使用相当默认的设置运行 wamp。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T03:52:31.420

如果第一行不起作用但第二行起作用，那么原因显然是因为`%l`

```
var_dump(strftime("%l", time())); 
```

确实会在 Windows 上引发错误。

阅读有关 strftime 的手册...

> 您的 C 库可能不支持所有转换说明符，在这种情况下，PHP 的 strftime() 将不支持它们。此外，并非所有平台都支持负时间戳，因此您的日期范围可能会限制为不早于 Unix 纪元。这意味着 %e、%T、%R 和 %D（可能还有其他）——以及 1970 年 1 月 1 日之前的日期——将无法在 Windows、某些 Linux 发行版和其他一些操作系统上运行。对于 Windows 系统，可以在 » MSDN 中找到支持的转换说明符的完整概述。

因此`%l`显然是不支持的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T16:17:20.290

在我的本地 WAMP 服务器上遇到此问题时，我找到了一个`%l`无法正常工作的解决方案。在修复 之后`%e`，`%#d`我测试`%#I`了一个小时而没有前面的 0 并且它完美地工作。所以你可以使用这是你的代码：

```
var_dump(strftime("%m-%d-%Y %#I:%M:%S", time())); 
```

不幸的是，这在 linux 环境中不起作用，它会输出 #I 而不是小时。

# c# - 以编程方式更新 DataGridView 中的多行

> ID：12362191
> 
> 赞同：2
> 
> 时间：2012-09-11T03:07:27.600
> 
> 标签：c#, winforms, datagridview

我正在创建一个 C# windows 窗体应用程序来管理发票，我需要一些帮助来看看我是否朝着正确的方向前进。我需要：

*   在可编辑的网格中显示来自 SQL Server 表的一组发票（发票数量会有所不同）
*   窗口上需要有一个文本框，用户可以在其中输入客户数据，它将原始网格结果过滤到与用户输入匹配的行
*   网格顶部需要有一个额外的复选框，用户可以选中该复选框以更新当前显示在网格中的所有行上的匹配复选框列。如果输入了过滤器，则检查操作应仅适用于显示的行
*   更改不应立即提交到数据库，因为用户可能需要在将更改提交到数据库之前取消选中几行，因此还需要一个操作按钮来提交/保存更改。

我知道我可能需要使用`DataGridView`来实现这一点，但我不确定将它绑定到什么。[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)的这篇文章看起来很有希望，但我不确定如何`BindingList`从数据库表中填充类。这篇文章正在调用 Add 方法来添加单独的行，但我希望能够一次添加所有行（或者至少有一个循环，用几行代码将它们全部添加）。

我认为这在`BindingList`课堂上是可能的。另外，`BindingList`类是否支持行过滤，类似于类的`RowFilter`属性`DataView`？[*StackOverflow*](https://stackoverflow.com/questions/4328769/adding-rows-programatically-to-a-datagridview-that-is-data-bound)上有另一篇文章引用了这个类，但没有详细说明如何`BindingList`从数据库中填充、如何对其应用过滤器或如何务实地更改`DataGridView`.

[MSDN 文章](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)似乎不是对 DGV 本身进行更改，而是对底层数据源进行更改，然后通过`INotifyPropertyChanged`接口更新 DGV。我对需要播放的内容有所了解，我只需要一些帮助来安排这些片段。感谢所有帮助！

我想通了，下面的代码作为其他需要帮助的人的示例。这可能是也可能不是最好的方法，但它对我有用。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlClient;

namespace Insurance_Manager
{
    public partial class InvoiceEditor : Form
    {
        private Boolean ignoreChange = false;
        private Char type;
        private DataTable invoices;
        private SqlDataAdapter adapter;

        #region Class Constructors

        public InvoiceEditor(Char iType)
        {
            // Initialize window components
            InitializeComponent();
            type = iType;
        }

        #endregion

        #region Class Methods

        // This function calculates the grid totals
        private void CalculateTotals()
        {
            // Initialize values
            Double all = 0;
            Double doNotPay = 0;
            Double paid = 0;
            Double wrongAmount = 0;

            // Loop through each row in the displayable grid and total the rows
            foreach (DataRowView viewRow in invoices.DefaultView)
            {
                DataRow row = viewRow.Row;
                all += Double.Parse(row["Amount"].ToString());
                if (Boolean.Parse(row["DoNotPay"].ToString()) == true) { doNotPay += Double.Parse(row["Amount"].ToString()); }
                if (Boolean.Parse(row["Paid"].ToString()) == true) { paid += Double.Parse(row["Amount"].ToString()); }
                if (Boolean.Parse(row["WrongAmount"].ToString()) == true) { wrongAmount += Double.Parse(row["Amount"].ToString()); }
            }

            // Set the totals to the textbox
            tbAllTotal.Text = String.Format(all.ToString(), "{0:c}");
            tbDoNotPayTotal.Text = String.Format(doNotPay.ToString(), "{0:c}");
            tbPaidTotal.Text = String.Format(paid.ToString(), "{0:c}");
            tbWrongAmtTotal.Text = String.Format(wrongAmount.ToString(), "{0:c}");
        }

        // This functions loads the invoices for the grid
        private void LoadInvoices()
        {
            // Fill the data table
            SqlConnection conn = new SqlConnection("Data Source=REPORTSERVER;Initial Catalog=Insurance;Integrated Security=True");
            conn.Open();
            String query = "";
            query += "Select ";
            query += "  IsNull(C.CustomerName,'') CustomerName, ";
            query += "  IsNull(C.[Contract],'') [Contract], ";
            query += "  IsNull(Convert(VarChar(20),I.Receipt),'') Receipt, ";
            query += "  IsNull(I.PolicyNumber,'') PolicyNumber, ";
            query += "  IsNull(I.[Type],'') [Type], ";
            query += "  I.DateBilled, ";
            query += "  I.Amount, ";
            query += "  I.DatePaid, ";
            query += "  I.Paid, ";
            query += "  I.DoNotPay, ";
            query += "  I.WrongAmount, ";
            query += "  I.ID, ";
            query += "  IsNull(I.Notes,'') Notes ";
            query += "From ";
            query += "  Invoice I ";
            query += "  Join Customer C On I.CustomerID = C.ID ";
            switch (type)
            {
                case 'A':
                    query += "Where I.ID Is Not Null And I.CustomerID Is Not Null ";
                    break;
                case 'C':
                    query += "Where I.CustomerID Is Null ";
                    break;
                case 'N':
                    query += "Where I.DoNotPay = 1 And I.CustomerID Is Not Null ";
                    break;
                case 'P':
                    query += "Where I.Paid = 1 And I.CustomerID Is Not Null ";
                    break;
                case 'U':
                    query += "Where I.DoNotPay = 0 And I.Paid = 0 And I.CustomerID Is Not Null ";
                    break;
                case 'W':
                    query += "Where I.WrongAmount = 1 And I.CustomerID Is Not Null ";
                    break;
            }
            query += "Order By ";
            query += "  I.DateBilled ";
            adapter = new SqlDataAdapter(query, conn);
            invoices = new DataTable();
            adapter.Fill(invoices);

            // Link the data table to the grid
            dgvInvoices.DataSource = invoices;
            dgvInvoices.Columns[0].DataPropertyName = "CustomerName";
            dgvInvoices.Columns[0].ReadOnly = true;
            dgvInvoices.Columns[1].DataPropertyName = "Contract";
            dgvInvoices.Columns[1].ReadOnly = true;
            dgvInvoices.Columns[2].DataPropertyName = "Receipt";
            dgvInvoices.Columns[2].ReadOnly = true;
            dgvInvoices.Columns[3].DataPropertyName = "PolicyNumber";
            dgvInvoices.Columns[3].ReadOnly = true;
            dgvInvoices.Columns[4].DataPropertyName = "PolicyNumber";
            dgvInvoices.Columns[4].ReadOnly = true;
            dgvInvoices.Columns[5].DataPropertyName = "DateBilled";
            dgvInvoices.Columns[5].ReadOnly = true;
            dgvInvoices.Columns[6].DataPropertyName = "Amount";
            dgvInvoices.Columns[6].DefaultCellStyle.Format = "c";
            dgvInvoices.Columns[7].DataPropertyName = "DatePaid";
            dgvInvoices.Columns[8].DataPropertyName = "Paid";
            dgvInvoices.Columns[9].DataPropertyName = "DoNotPay";
            dgvInvoices.Columns[10].DataPropertyName = "WrongAmount";
            dgvInvoices.Columns[11].DataPropertyName = "ID";
            dgvInvoices.Columns[11].Visible = false;
            dgvInvoices.Columns[12].DataPropertyName = "Notes";
            dgvInvoices.Columns[12].Visible = false;

            // Close the database connection
            conn.Close();

            // Calculate totals
            CalculateTotals();
        }

        // This function resets all of the fields
        private void ResetFields()
        {
            // Turn on the ignore change flag
            ignoreChange = true;

            // Reset actions
            cbDoNotPay.Checked = false;
            cbPaid.Checked = false;
            cbWrongAmt.Checked = false;

            // Reset filter fields
            dpMinDateBilled.Text = "1/1/1900";
            dpMaxDateBilled.Text = "12/31/2099";
            dpMinDatePaid.Text = "1/1/1900";
            dpMaxDatePaid.Text = "12/31/2099";
            tbContract.Text = "";
            tbName.Text = "";
            tbPolicy.Text = "";
            tbReceipt.Text = "";

            // Turn off the ignore change flag
            ignoreChange = false;
        }

        // This function saves the row to the database
        private void Save(DataRow row)
        {
            // Format values as needed
            Double amount = Double.Parse(row["Amount"].ToString());
            Int32 receipt;
            try
            {
                receipt = Int32.Parse(row["Receipt"].ToString());
            }
            catch
            {
                receipt = 0;
            }

            // Acquire a connection to the database
            SqlConnection conn = new SqlConnection("Data Source=REPORTSERVER;Initial Catalog=Insurance;Integrated Security=True");
            conn.Open();

            // Save the customer to the database
            SqlCommand cmd = new SqlCommand("usp_SaveInvoice", conn);
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Parameters.Add("@InvoiceID", SqlDbType.Int).Value = row["ID"];
            if (receipt != 0)
            {
                cmd.Parameters.Add("@Receipt", SqlDbType.Int).Value = row["Receipt"];
            }
            else
            {
                cmd.Parameters.Add("@Receipt", SqlDbType.Int).Value = DBNull.Value;
            }
            cmd.Parameters.Add("@Type", SqlDbType.VarChar, 10).Value = row["Type"];
            cmd.Parameters.Add("@Policy", SqlDbType.VarChar, 15).Value = row["PolicyNumber"];
            cmd.Parameters.Add("@DateBilled", SqlDbType.Date).Value = DateTime.Parse(row["DateBilled"].ToString());
            cmd.Parameters.Add("@Amount", SqlDbType.Money).Value = amount;
            if (row["DatePaid"].ToString().Equals(""))
            {
                cmd.Parameters.Add("@DatePaid", SqlDbType.Date).Value = DBNull.Value;
            }
            else
            {
                cmd.Parameters.Add("@DatePaid", SqlDbType.Date).Value = DateTime.Parse(row["DatePaid"].ToString());
            }
            cmd.Parameters.Add("@Paid", SqlDbType.Bit).Value = row["Paid"];
            cmd.Parameters.Add("@DoNotPay", SqlDbType.Bit).Value = row["DoNotPay"];
            cmd.Parameters.Add("@WrongAmount", SqlDbType.Bit).Value = row["WrongAmount"];
            cmd.Parameters.Add("@Notes", SqlDbType.VarChar, 200000000).Value = row["Notes"];
            cmd.Parameters.Add("@UserName", SqlDbType.VarChar, 100).Value = Environment.UserName;
            cmd.ExecuteNonQuery();
            cmd.Dispose();

            // Close the connection to the database
            conn.Close();
            conn.Dispose();
        }

        // This function goes through the rows and saves each one to the database
        private Boolean SaveRows()
        {
            // Initialize the return variable
            Boolean returnVal = true;

            // Change the grid focus to end any edits so they are committed to the datatable
            dgvInvoices.CurrentCell = null;

            // Loop through each row in the data table and validate it
            foreach (DataRow row in invoices.Rows)
            {
                if (returnVal == false)
                {
                    continue;
                }
                else
                {
                    // If the row has changed, validate changes
                    if (row.RowState == DataRowState.Modified)
                    {
                        returnVal = Validate(row);
                    }
                }
            }

            // Loop through each row in the data table and save it
            if (returnVal)
            {
                // Loop through each row in the data table
                foreach (DataRow row in invoices.Rows)
                {
                    // If the row has changed, save changes
                    if (row.RowState == DataRowState.Modified)
                    {
                        Save(row);
                    }
                }
            }

            if (returnVal)
            {
                MessageBox.Show("Database updated!");
                LoadInvoices();
            }

            // Return value
            return returnVal;
        }

        // This function validates the data row to make sure it can be saved to the database
        private Boolean Validate(DataRow row)
        {
            // Validate date received
            DateTime dateBilled;
            try
            {
                dateBilled = DateTime.Parse(row["DateBilled"].ToString());
            }
            catch
            {
                MessageBox.Show("Date received is incorrect");
                return false;
            }
            if (dateBilled < DateTime.Parse("1/1/2010"))
            {
                MessageBox.Show("Date received must be on or after 1/1/2010");
                return false;
            }

            // Validate date paid
            DateTime datePaid;
            if (!row["DatePaid"].ToString().Trim().Equals(""))
            {
                try
                {
                    datePaid = DateTime.Parse(row["DatePaid"].ToString());
                }
                catch
                {
                    MessageBox.Show("Date paid is incorrect");
                    return false;
                }
                if (datePaid < dateBilled)
                {
                    MessageBox.Show("Date paid must be on or after date received");
                    return false;
                }
            }

            // Validate amount
            Double amount;
            try
            {
                amount = Double.Parse(row["Amount"].ToString());
            }
            catch
            {
                MessageBox.Show("Amount is incorrect");
                return false;
            }
            if (amount <= 0)
            {
                MessageBox.Show("Amount must be positive");
                return false;
            }

            // Return true
            return true;
        }

        #endregion

        #region Window Events

        // This function marks the column as checked
        private void CheckColumn(String columnName, Boolean checkState)
        {
            // Turn on the ignore change flag to prevent recalculating totals for each row
            ignoreChange = true;

            // Loop through each row in the displayable grid
            foreach (DataRowView viewRow in invoices.DefaultView)
            {
                DataRow row = viewRow.Row;
                row[columnName] = checkState;
                if ((columnName == "Paid") && (checkState == true))
                {
                    row["DoNotPay"] = false;
                }
                if ((columnName == "DoNotPay") && (checkState == true))
                {
                    row["Paid"] = false;
                }
            }

            // Turn off the ignore change flag
            ignoreChange = false;

            // Recalculate the totals
            CalculateTotals();

            // Refresh the grid
            dgvInvoices.Refresh();
        }

        // This function is used to limit the characters input in a date box
        private void Date_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (("/0123456789".Contains(e.KeyChar)) || ((Int32)e.KeyChar == 8))
            {
                e.Handled = false;
            }
            else
            {
                e.Handled = true;
            }
        }

        // This function is called when filters update
        private void FilterTextChanged(object sender, EventArgs e)
        {
            // Build the filter
            if (!ignoreChange)
            {
                String filter = "";
                filter += "CustomerName Like '%" + tbName.Text.Replace("'", "''") + "%' ";
                filter += "And [Contract] Like '%" + tbContract.Text.Replace("'", "''") + "%' ";
                filter += "And PolicyNumber Like '%" + tbPolicy.Text.Replace("'", "''") + "%' ";
                filter += "And Convert(Receipt,System.String) Like '%" + tbReceipt.Text.Replace("'", "''") + "%' ";
                filter += "And IsNull(DateBilled,'1/1/1900') >= '" + dpMinDateBilled.Text + "' ";
                filter += "And IsNull(DateBilled,'1/1/1900') <= '" + dpMaxDateBilled.Text + "' ";
                filter += "And IsNull(DatePaid,'1/1/1900') >= '" + dpMinDatePaid.Text + "' ";
                filter += "And IsNull(DatePaid,'1/1/1900') <= '" + dpMaxDatePaid.Text + "' ";

                // Apply the filter to the table
                invoices.DefaultView.RowFilter = filter;

                // Calculate totals
                CalculateTotals();
            }
        }

        // This function is called when the form is closing
        private void InvoiceEditor_FormClosing(object sender, FormClosingEventArgs e)
        {
            // By default, assume not closing
            e.Cancel = false;

            // Check if changes have been made
            Boolean changed = false;
            foreach (DataRow row in invoices.Rows)
            {
                if (changed)
                {
                    continue;
                }
                else
                {
                    if (row.RowState == DataRowState.Modified)
                    {
                        changed = true;
                    }
                }
            }

            // If changes were made, ask the user if they want to save changes
            if (changed == true)
            {
                // Ask the customer if they want to save changes
                DialogResult choice = MessageBox.Show("Changes have been made to invoices. Do you want to save them?", "Save Changes", MessageBoxButtons.YesNoCancel);
                if (choice == DialogResult.Yes)
                {
                    e.Cancel = !SaveRows();
                }
                else if (choice == DialogResult.Cancel)
                {
                    e.Cancel = true;
                }
            }
        }

        // This function is called when the form is loading
        private void InvoiceEditor_Load(object sender, EventArgs e)
        {
            // Set the window fields to defaults
            ResetFields();

            // Load invoices
            LoadInvoices();

            // Set the window header
            switch (type)
            {
                case 'A':
                    this.Text = "All Invoices";
                    break;
                case 'C':
                    this.Text = "Invoices w/o Customers";
                    break;
                case 'N':
                    this.Text = "Do Not Pay Invoices";
                    break;
                case 'P':
                    this.Text = "Paid Invoices";
                    break;
                case 'U':
                    this.Text = "Unpaid Invoices";
                    break;
                case 'W':
                    this.Text = "Wrong Amount Invoices";
                    break;
            }
        }

        // This function is called when the Do Not Pay flag is clicked
        private void cbDoNotPay_CheckedChanged(object sender, EventArgs e)
        {
            // If the user checked the box, check all of the rows in the grid
            if (!ignoreChange)
            {
                CheckColumn("DoNotPay", cbDoNotPay.Checked);
            }
        }

        // This functions is called when the Paid flag is clicked
        private void cbPaid_CheckedChanged(object sender, EventArgs e)
        {
            // If the user checked the box, check all of the rows in the grid
            if (!ignoreChange)
            {
                CheckColumn("Paid", cbPaid.Checked);
            }
        }

        // This function is called when the Wrong Amount flag is clicked
        private void cbWrongAmt_CheckedChanged(object sender, EventArgs e)
        {
            // If the user checked the box, check all of the rows in the grid
            if (!ignoreChange)
            {
                CheckColumn("WrongAmount", cbWrongAmt.Checked);
            }
        }

        // This function is called when the cell value changes
        private void dgvInvoices_CellContentClick(object sender, DataGridViewCellEventArgs e)
        {
            // If one of the flag changes, recalculate the totals
            if ((!ignoreChange) && (" 8 9 10 ".Contains(e.ColumnIndex.ToString())))
            {
                // Change focus to end the edit
                dgvInvoices.CurrentCell = dgvInvoices.Rows[e.RowIndex].Cells[0];

                // If the paid flag changes, flip the other one
                if ((e.ColumnIndex == 8) && (Boolean.Parse(dgvInvoices.Rows[e.RowIndex].Cells[8].Value.ToString()) == true))
                {
                    dgvInvoices.Rows[e.RowIndex].Cells[9].Value = false;
                }

                // If the do not pay flag changes, flip the other one
                if ((e.ColumnIndex == 9) && (Boolean.Parse(dgvInvoices.Rows[e.RowIndex].Cells[9].Value.ToString()) == true))
                {
                    dgvInvoices.Rows[e.RowIndex].Cells[8].Value = false;
                }

                dgvInvoices.Refresh();

                CalculateTotals();
            }
        }

        // This function is called when a row in grid is double clicked
        private void dgvInvoices_DoubleClick(object sender, EventArgs e)
        {
            // Get the selected row
            DataRowView row = (DataRowView)dgvInvoices.BindingContext[invoices].Current;
            Int32 InvoiceID;
            try
            {
                InvoiceID = Int32.Parse(row["ID"].ToString().Trim());
            }
            catch
            {
                InvoiceID = 0;
            }

            // Ensure a row was selected
            if (InvoiceID != 0)
            {
                // Display the window for editing this invoice
                Invoice inv = new Invoice(InvoiceID,row["CustomerName"].ToString());
                inv.ShowDialog(this.MdiParent);
            }
        }

        #endregion

        #region Menu Items

        // This function is called when the close button is clicked on the menu
        private void closeToolStripMenuItem_Click(object sender, EventArgs e)
        {
            // Close the form
            this.Close();
        }

        // This function is called when the save button is clicked on the menu
        private void saveToolStripMenuItem_Click(object sender, EventArgs e)
        {
            // Call the save method
            SaveRows();
        }

        // This function is called when the undo button is clicked on the menu
        private void undoToolStripMenuItem_Click(object sender, EventArgs e)
        {
            // Reset filters
            ResetFields();

            // Reload the grid
            LoadInvoices();
        }

        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T07:19:05.473

我会将您的发票数据加载到数据表中。

您可以使用**绑定源**并将其数据源设置为 DataTable 的数据源。如果您正在考虑使用 DataGridView，则将此对象的数据源设置为绑定源。

这样做意味着您只需要对内存中的 DataTable 执行过滤器，所有更改都会自动传递到您的 DataGridView。

您可以使用 DataView 非常轻松地对 DataTable 执行过滤器。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:15:12.183

在数据绑定事件期间。有一个包含要绑定的数据的事件参数...您可以在此参数中设置值，它将自动设置到 dataGridView

# ruby-on-rails - 当您在安装过程中跳过它时，如何恢复 Test::Unit？

> ID：12362192
> 
> 赞同：1
> 
> 时间：2012-09-11T03:07:31.633
> 
> 标签：ruby-on-rails, railstutorial.org

当我第一次学习 Rails 时，教程建议我使用 RSpec。在评估了我的代码之后，Test::Unit 似乎更合适。但是我的应用程序已经建立起来了，我该如何恢复命令：

```
rails new my_app --skip-test-unit 
```

不破坏/重做我的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:37:45.357

在 config/application.rb 中取消注释以下行

```
 require "rails/test_unit/railtie" 
```

并从 Gemfile 中删除 rspec。

您可能必须创建一个测试目录。同样，您需要从此处为所有其他非自动生成的内容添加所有相关详细信息和文件。在此处查看最新的 Rails 测试：

[http://guides.rubyonrails.org/testing.html](http://guides.rubyonrails.org/testing.html)

```
mkdir test
cd test
mkdir fixtures functional integration 
```

等等以弥补非生成的文件。

此页面有助于获得答案：

[Ruby on Rails：从 test_unit 切换到 rspec](https://stackoverflow.com/questions/9884033/ruby-on-rails-switch-from-test-unit-to-rspec)

# python - 通过记事本在windows中执行python（F6 Exec命令__main__错误）

> ID：12362195
> 
> 赞同：2
> 
> 时间：2012-09-11T03:07:39.293
> 
> 标签：python, windows, module

我在win7上安装了notepad++，并安装了notepad++ exec插件。每当我执行我正在运行的 .py 脚本时，我都会收到以下错误：

```
C:/Python27/python.exe ""
Process started >>>
C:\Python27\python.exe: can't find '__main__' module in ''
<<< Process finished.
================ READY ================ 
```

我的 index.py 脚本如下：

```
text = "Hello World"
print text 
```

Notepad++执行脚本（F6）如下：

```
C:/Python27/python.exe "$(C:/Python27/python.exe)" 
```

这是我系统上 python.exe 的正确路径。在 windows 环境变量中，我也将它添加到了 PATH 中。此外，我已经启动了 python.exe 命令提示符并通过手动输入脚本来运行它。我已经完成了 C:/Python27 的目录搜索，并且存在**主**.py 文件。

这是怎么回事？为什么python找不到__主__模块？？

**编辑：**

没关系，我是个白痴。

所以我误解了 notepad++ exec (F6) 脚本的设置：

```
C:/Python27/python.exe "$(C:/Python27/python.exe)" 
```

它应该是这样的：

```
C:/Python27/python.exe "$(FULL_CURRENT_PATH)" 
```

当然它找不到**主**.py 文件，因为它不会进入 FULL_CURRENT_PATH。继续。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:30:51.157

基本上，这是因为脚本中的第一个参数被误解了。也就是说，用代码

```
C:/python27/python.exe "$(C:/python27/python.exe)" 
```

你正在做一些大致相同的事情

```
C:/python27/python.exe 
```

您需要使用的是：

```
C:/Python27/python.exe "$(FULL_CURRENT_PATH)" 
```

注意：不要将“$(FULL_CURRENT_PATH)”替换为其他内容 - 逐字逐句 - 它是 NppExec 插件的预定义变量。它可能被认为是当前打开选项卡中文件完整路径的简写。

当我执行上面的脚本时（在名为 tmp.py 的文件上，在我的 c:\xampp\htdocs\enhzflep 文件夹中），我会在控制台中显示它：

> C:/Python27/python.exe "C:\xampp\htdocs\enhzflep\tmp.py" CreateProcess() 失败，错误代码 2：系统找不到指定的文件。

这很好，因为我没有在这台机器上安装 python。:)

编辑：刚刚看到你的编辑。看来我是更大的傻瓜！

# ruby-on-rails-3 - 使用 rspec 和 capybara 单击链接不会加载页面

> ID：12362199
> 
> 赞同：-2
> 
> 时间：2012-09-11T03:08:03.470
> 
> 标签：ruby-on-rails-3, testing, rspec, click, capybara

在 Rails 3.2 中，我使用的是 rspec (2.11.0) 和 capybara 1.1.2（并且没有安装 webrat），当我单击网页上的链接时，它会做一些奇怪的事情。

我正在尝试单击主页上的链接以转到另一个页面。下面是基本的 rspec 测试。

```
it "should go to agents page" do
  visit 'home'

  #puts page.body
  #links = page.all('a')
  #links.each do |l|
  #  puts l.text
  #end

  page.find_by_id('menu_agents').click

  puts page.body
  #<various content asserts on page currently commented out>
end 
```

我基本上去一个页面，抓住一个链接然后点击

链接存在。正如您从注释掉的语句中看到的那样，我通过查看控制台中的页面并查看链接列表来确认。我不仅尝试使用上面的链接单击，还尝试使用`click_link`和引用 id。当我运行代码时查看代码和页面的 html，我看到了元素的 id。

在所有情况下，我都会得到以下结果：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> 
```

通过单击链接运行软件时，`rails s`确实会加载正确的页面。同样，当我在测试中访问主页时，它也会正确加载，因为当我将正文打印到控制台时，我会看到正确的 html。

当我单击链接并且页面加载出现某种类型的失败时，页面加载似乎出现问题（尽管测试本身没有失败）。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T05:50:29.307

请试试这个：

页面加载需要一些时间。使用**睡眠**功能。它需要一些时间等待。

然后使用**page.find("#menu_agents").click**代替**page.find_by_id('menu_agents').click**

验证 menu_agents id 名称不存在于结果页面中的任何其他位置。

**注意：确保 menu_agents id 是唯一的。**

```
it "should go to agents page" do

  visit 'home'

  sleep 5

  page.find("#menu_agents").click

  puts page.body
  #<various content asserts on page currently commented out

end 
```

# python - 在创建文件名时使用变量

> ID：12362210
> 
> 赞同：0
> 
> 时间：2012-09-11T03:09:44.653
> 
> 标签：python, file

我对python很陌生，想知道是否有任何方法可以将变量放入文件名中，以便您每次都可以创建具有不同名称的文件。

在我的特殊情况下，我想在文件名中添加日期和时间。如果可能的话，这将完美地工作：

```
example = open("Path/to/file%s", "w") % str(datetime.now()) 
```

...但事实并非如此。有没有办法使用不同的方法获得这种功能？我尝试过使用多个短语来寻找答案，但我找不到是或否。

提前谢谢各位。

编辑：这应该是一个 open() 函数，并进行了相应调整。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T03:11:24.090

这应该有效。将用格式化字符串 ( )`format()`替换字符串中的占位符。`{0}``datetime``datestr`

```
>>> from datetime import datetime
>>> datestr = datetime.strftime(datetime.today(), "%Hh %Mm %Ss %A, %B %Y")
>>> examplefile = open("/home/michael/file{0}".format(datestr), 'w')
>>> print(examplefile)
<open file '/home/michael/file21h 20m 34s Monday, September 2012', mode 'w' at 0x89fcf98> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:14:56.620

修改您的答案以仍使用旧式`%`格式，您可能会这样做：

```
example = open("Path/to/file%s" % datetime.now(), "w") 
```

请注意，我调用`open()`了 ，这可能是您想要做的（否则您只是在创建一个元组）。此外，使用`%s`格式说明符会自动将参数转换为字符串，因此您实际上并不需要`str()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T03:25:04.337

您的示例不起作用的原因与文件无关。

```
example = ("Path/to/file%s", "w") % str(datetime.now()) 
```

上面是使用`%`运算符，左边是一个元组，右边是一个字符串。但该`%`运算符用于基于字符串模板构建字符串，该模板出现在`%`. 在左边放一个元组是没有意义的。

你需要把你想做的事情分解成更基本的步骤。您从“我想打开一个名称包含当前日期和时间的文件”开始。没有办法直接做到这一点，这就是为什么你找不到任何关于它的原因。但是文件名只是一个字符串，因此您可以使用字符串操作来构建一个字符串，然后打开该字符串。因此，您的问题实际上并不是“如何打开名称中包含日期/时间的文件？”，而是“如何将日期/时间与其他一些信息一起放入字符串中？”。您似乎已经知道该问题的答案：使用`%`格式。

这是有道理的；否则我们必须为文件和字符串实现所有可能的字符串操作。对于我们使用字符串的其他所有内容。这不是（理智的）编程工作的方式。我们希望能够重用已经存在的操作，而不是每次都从头开始。

所以你要做的是使用字符串操作（与文件无关，既不知道也不关心你最终会使用这个字符串打开文件）来构建你的文件名。然后将该字符串传递给文件打开函数`open`（连同`"w"`指定您希望它可写的字符串）。

例如：

```
filename = "Path/to/file%s" % datetime.now()
example = open(filename, "w") 
```

如果需要，可以将其放在一行中：

```
example = open("Path/to/file%s" % datetime.now(), "w") 
```

但是如果你对编程和 Python 比较陌生，我建议你保持你的小步骤分解，直到你对一般事情更舒服。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T04:03:46.200

此处发布的所有答案都正确识别了问题，即您的字符串格式不正确。

您还应该检查最终得到的字符串是否实际上是您尝试在其上创建文件的操作系统的有效文件名。

您的示例不会在 Windows 上生成有效的文件名，虽然可以在 Linux 上运行，但创建的文件名不会是您所期望的：

```
>>> f = open(str(datetime.datetime.now()),'w')
>>> f.write('hello\n')
>>> f.close()
>>> quit()

-rw-r--r-- 1 burhan burhan 6 Sep 11 06:53 2012-09-11 06:53:04.685335 
```

在 Windows 上它根本不起作用：

```
>>> open(str(datetime.datetime.now()),'w')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IOError: [Errno 22] invalid mode ('w') or filename: '2012-09-11 06:51:26.873000' 
```

这将是一个更好的选择（2.6+）：

```
filename = "Path/to/file/{0.year}{0.month}{0.day}".format(datetime.now()) 
```

对于旧版本的 Python，您可以使用经典选项：

```
filename = "Path/to/file/%s" % datetime.strftime(datetime.now(),"%Y%m%d") 
```

# java - 知道类中的所有变量是否为空的最佳方法是什么？

> ID：12362212
> 
> 赞同：50
> 
> 时间：2012-09-11T03:10:05.697
> 
> 标签：java

这意味着该类已初始化，但未设置变量。

一个示例类：

```
public class User {

    String id = null;
    String name = null;

    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
} 
```

实际的类很大，我不想检查每个变量的 if(xyz == null) 。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2016-10-25T11:36:30.170

Java 8 的另一个非反射解决方案，在[paxdiabo 的答案](https://stackoverflow.com/a/12362245/525036)行中但不使用一系列`if`'s，将流式传输所有字段并检查是否为空：

```
return Stream.of(id, name)
        .allMatch(Objects::isNull); 
```

*这在避免反射锤*的同时仍然很容易维护。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-09-11T03:15:53.437

尝试这样的事情：

```
public boolean checkNull() throws IllegalAccessException {
    for (Field f : getClass().getDeclaredFields())
        if (f.get(this) != null)
            return false;
    return true;            
} 
```

尽管如果可行的话，检查每个变量可能会更好。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-02-12T14:04:18.253

这可以使用生成的 Lombok`equals`和静态`EMPTY`对象相当容易地完成：

```
import lombok.Data;

public class EmptyCheck {
    public static void main(String[] args) {
        User user1 = new User();

        User user2 = new User();
        user2.setName("name");

        System.out.println(user1.isEmpty()); // prints true
        System.out.println(user2.isEmpty()); // prints false
    }

    @Data
    public static class User {
        private static final User EMPTY = new User();

        private String id;
        private String name;
        private int age;

        public boolean isEmpty() {
            return this.equals(EMPTY);
        }
    }
} 
```

**先决条件**：

*   默认构造函数不应使用自定义行为来实现，因为它用于创建`EMPTY`对象
*   类的所有字段都应该有一个实现`equals`（内置的 Java 类型通常不是问题，如果是自定义类型，您可以使用 Lombok）

**优点**：

*   不涉及反射
*   作为添加到类中的新字段，这不需要任何维护，因为由于 Lombok，它们将在`equals`实现中自动检查
*   与其他一些答案不同，这不仅适用于空检查，而且适用于具有非空默认值的原始类型（例如，如果字段是`int`它检查`0`，如果是`boolean`for`false`等）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2020-01-02T19:58:32.270

如果你想要这个进行单元测试，我只使用`hasNoNullFieldsOrProperties()`来自的方法`assertj`

```
assertThat(myObj).hasNoNullFieldsOrProperties(); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-06-14T12:52:18.967

流呢？

```
public boolean checkFieldsIsNull(Object instance, List<String> fieldNames) {

    return fieldNames.stream().allMatch(field -> {
        try {
            return Objects.isNull(instance.getClass().getDeclaredField(field).get(instance));
        } catch (IllegalAccessException | NoSuchFieldException e) {
            return true;//You can throw RuntimeException if need.
        }
    });
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-11T03:14:30.357

“最佳”是一个如此主观的术语:-)

我只会使用检查每个单独变量的方法。如果您的班级已经有很多这些，那么如果您执行以下操作，则规模的*增加*不会那么多：

```
public Boolean anyUnset() {
    if (  id == null) return true;
    if (name == null) return true;
    return false;
} 
```

如果您将所有内容保持在相同的顺序，代码更改（如果您偏执，则使用脚本自动检查）将相对轻松。

或者（假设它们都是字符串），您基本上可以将这些值放入某种类型的映射中（例如，`HashMap`），然后只保留该列表的键名列表。这样，您可以遍历键列表，检查值是否设置正确。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-09-11T03:57:40.123

我认为最好的方法是其他人推荐的反射。这是一个评估每个本地字段是否为空的示例。如果它找到一个不为空的，方法将返回 false。

```
public class User {

    String id = null;
    String name = null;

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public boolean isNull() {
        Field fields[] = this.getClass().getDeclaredFields();
        for (Field f : fields) {
            try {
                Object value = f.get(this);
                if (value != null) {
                    return false;
                }
            }
            catch (IllegalArgumentException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            catch (IllegalAccessException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
        return true;

    }

    public static void main(String args[]) {
        System.out.println(new User().isNull());
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-12-18T12:36:11.100

我认为这是一个可以轻松解决您的问题的解决方案：（如果任何参数不为空，则返回 true）

```
 public boolean isUserEmpty(){ 
boolean isEmpty;
isEmpty =  isEmpty = Stream.of(id,
            name)
        .anyMatch(userParameter -> userParameter != null);

return isEmpty;} 
```

同一任务的另一个解决方案是：（您可以将其更改为 if(isEmpty==0) 检查所有参数是否为空。

```
public boolean isUserEmpty(){  
       long isEmpty;
            isEmpty = Stream.of(id,
                    name)
                    .filter(userParameter -> userParameter != null).count();

            if (isEmpty > 0) {
                return true;
            } else {
                return false;
            }
    } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-09-11T03:20:58.953

```
Field[] field = model.getClass().getDeclaredFields();     

for(int j=0 ; j<field.length ; j++){    
            String name = field[j].getName();                
            name = name.substring(0,1).toUpperCase()+name.substring(1); 
            String type = field[j].getGenericType().toString();    
            if(type.equals("class java.lang.String")){   
                Method m = model.getClass().getMethod("get"+name);
                String value = (String) m.invoke(model);    
                if(value == null){
                   ... something to do...
                }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-09-16T14:22:34.327

最适合我的是

```
Stream.of(getClass().getDeclaredMethods()).allMatch(Objects::isNull); 
```

它可以在自定义注解+注解处理器中使用，以自动`boolean isNull()`在注解类上定义方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-20T05:58:22.387

如果您想做相反的事情，即检查班级的某些/所有成员是否非非，请检查此答案。

为了确保类的某些成员总是非空的，我们可以`@NonNull`在类的各个字段上使用 lombok 注解。

```
import lombok.Data;
import lombok.NonNull;

@Data
public class DataClass {
  @NonNull
  private String data1;
  private int data2;
  @NonNull
  private String data3;
  @NonNull
  private String data4;
  @NonNull
  private String data5;
  private String data6;

 DataClass(String data1,...) {
    // constructor
 }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-12T13:02:45.203

基于 Irkwz 的回答，但方法不同：

```
public class SomeClass{

private String field1;
private String field2;
private ComplexField field3;
private String field4;
private Integer field15;

public boolean isNullAllFields() {
    return Stream.of(this.getClass().getDeclaredFields()).anyMatch(element -> (element != null));
} 
```

}

最后，您调用 isNullAllFields 方法来确定对象字段是否为空。

# iphone - 保存没有质量损失的 UIImage

> ID：12362220
> 
> 赞同：3
> 
> 时间：2012-09-11T03:11:29.807
> 
> 标签：iphone, objective-c, ios, xcode, uiimage

我的应用程序会截取整个网页。当它保存到相册时，图像质量会受到一些影响，并且静止图像上的文字模糊且难以阅读。我发现这个解决方案在保存到相册时承诺具有更好的质量，但它似乎仍然不能完全接受。有没有比这更好的方法来将 UIImage 保存到相册而质量损失非常小？谢谢。

```
UIImage* img = [UIImage imageWithCGImage:screenshotImage.CGImage];
NSData* imdata =  UIImagePNGRepresentation ( img );
UIImage* image = [UIImage imageWithData:imdata]; // wrap UIImage around PNG representation

UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), nil); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:23:32.130

除了查看图像质量设置之外，您还需要了解哪种图像格式最适合存储不同类型的图像。

对于真实世界的图像，例如用相机拍摄的图像，我更喜欢 JPG。JPEG 在保持高图像质量同时实现良好压缩方面做得更好。

如果您正在截取图像的许多部分颜色相同的屏幕截图（例如此网页或您的编程编辑器），那么我更喜欢使用 PNG。PNG 将保存图像，而不会产生大量经常出现在 JPEG 中的脏东西，但仍然可以为这些类型的图像实现良好的压缩比。

上述原因与每次使用的压缩算法有关（JPEG 是 FFT；PNG 是 DEFLATE）。尝试更改图像类型和质量设置，看看是否会有所不同。

# sql - SQL Server 查询超时取决于 Where 子句

> ID：12362221
> 
> 赞同：3
> 
> 时间：2012-09-11T03:11:29.857
> 
> 标签：sql, sql-server, sql-server-2008r2-express

我有一个使用 3 个函数和下面几个不同视图的查询，这些视图太复杂，无法在此处发布。我遇到的奇怪的事情是在运行顶级查询时，拥有超过 1 个搜索键会导致查询需要大约一个小时才能运行，而将查询分成两部分每个查询大约需要 5 秒。

这是顶级查询：

```
Select * 
from  dbo.vwSimpleInvoice i 
inner join dbo.vwRPTInvoiceLineItemDetail d on i.InvoiceID = d.InvoiceID 
```

当我添加这个 where 子句时：

```
Where i.InvoiceID = 109581 
```

查询运行大约需要 3 秒。同样，当我添加这个 where 子句时：

```
Where i.InvoiceID = 109582 
```

大约需要 3 秒。

当我添加这个 where 子句时：

```
Where i.InvoiceID in (109581, 109582) 
```

大约 50 分钟后，我不得不终止查询，它永远不会返回任何结果。

这发生在运行 SQL Server 2008 R2 Express 的远程客户端服务器上。当我在本地运行它时（也在 SQL Server 2008 R2 Express 上），我没有得到巨大的延迟，最后一个 where 子句需要大约 30 秒才能返回。不过，客户的数据比我多得多。

知道从哪里开始解决这个问题吗？

编辑：

在下面的评论之后，我重建了索引和统计信息，这提高了前两个 where 子句的性能，但对第三个子句没有影响。然后我玩弄了这个查询，发现如果我把它改写为：

```
Select * 
from  dbo.vwSimpleInvoice i 
inner join  
    (Select * from dbo.vwRPTInvoiceLineItemDetail) d on i.InvoiceID = d.InvoiceID 
Where i.InvoiceID in (109581, 109582) 
```

性能恢复到预期水平，大约 200 毫秒。我现在比以往任何时候都更加困惑正在发生的事情......

编辑2：

其实，我错了。它不是那样重写查询，我在重写期间不小心将 Where 子句更改为：

```
Where d.InvoiceID in (109581, 109582) 
```

（改为`i`）`d`。

仍然有点茫然，为什么这会对内部连接产生如此巨大的影响？

* * *

进一步编辑：

玩得更远，我仍然无法理解。

```
Select InvoiceId from tblInvoice Where CustomerID = 2000 
```

返回：

```
80442, 4988, 98497, 102483, 102484, 107958, 127063, 168444, 168531, 173382, 173487, 173633, 174013, 174160, 174240, 175389

Select * from dbo.vwRPTInvoiceLineItemDetail
Where InvoiceID in 
(80442, 4988, 98497, 102483, 102484, 107958, 127063, 168444, 168531, 173382, 173487, 173633, 174013, 174160, 174240, 175389) 
```

运行：31 行返回 110 毫秒

```
Select * from dbo.vwRPTInvoiceLineItemDetail
Where InvoiceID in 
(Select InvoiceId from tblInvoice Where CustomerID = 2000) 
```

运行：31 行返回 65 分钟

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:17:09.063

您遇到的问题（几乎可以肯定）是由于缓存的查询计划造成的，该计划适用于传递给查询的某些版本的参数，但不适用于其他版本（又名[Parameter Sniffing](https://stackoverflow.com/questions/211355/parameter-sniffing-or-spoofing-in-sql-server)）。

这是一种常见的情况，并且经常由于过时的统计数据和/或严重碎片化的索引而变得更糟。

**第一步**：确保您已重建所有索引，并且非索引列的统计信息是最新的。（另外，请确保您的客户有定期安排的索引维护工作）

```
exec sp_msforeachtable "DBCC DBREINDEX('?')"
go

exec sp_msforeachtable "UPDATE STATISTICS ? WITH FULLSCAN, COLUMNS"
go 
```

这是规范参考：[应用程序慢，SSMS 快？](http://www.sommarskog.se/query-plan-mysteries.html)

如果重建索引和更新统计信息后问题仍然存在，那么您有几个选择：

1.  使用动态 SQL（但请先阅读：[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)）

2.  利用[`OPTIMIZE FOR`](http://blogs.msdn.com/b/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)

3.  利用`WITH(RECOMPILE)`

# python - 关于 django 项目路径和模块导入规则的错误

> ID：12362231
> 
> 赞同：0
> 
> 时间：2012-09-11T03:13:01.597
> 
> 标签：python, django

我生成了一个 django 项目，它的目录结构如下：

```
-myproject

    --__init__.py

    --settings.py

    --rooturls.py

    --dbUtils.py

    --app1

        ---__init__.py

        ---views.py

        ---urls.py

    --app2

        ---__init__.py

        ---views.py

        ---urls.py 
```

我想在我的应用程序中导入 dbUtils，所以我在我的 settings.py 中进行配置：

```
PROJECT_ROOT = os.path.dirname(__file__)
sys.path.insert(0, PROJECT_ROOT) 
```

但是，程序仍然找不到该模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:16:12.557

如果您尝试使用 wsgi 设置，则很可能需要更新 wsgi 脚本中的路径`wsgi.py`

否则，请`PYTHONPATH`为此路径更新您的。

**更新：**您可以导入为

```
from myproject import dbUtils 
```

更新并不是一个真正的好地方`sys.path`。`settings.py`

# json - 谷歌字典api不返回纯json？

> ID：12362233
> 
> 赞同：1
> 
> 时间：2012-09-11T03:13:20.377
> 
> 标签：json, google-api

我有以下代码：

```
var json = new WebClient().DownloadString(string.Format(@"http://www.google.com/dictionary/json?callback=dict_api.callbacks.id100&q={0}&sl=en&tl=en", "bar")); 
```

这将返回如下内容：

> dict_api.callbacks.id100({"query":"bar","sourceLanguage":"en","targetLanguage":"en","primaries":[{"type":"headword","terms":[ {"type":"text","text":"bar",....

为什么它返回一个函数而不仅仅是 json？我是否错误地使用了 Web 客户端？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:18:31.320

据我了解，这是[JSONP](http://en.wikipedia.org/wiki/JSONP) - JSON，它通过函数调用“填充”以允许跨域数据传输。我强烈*怀疑*，如果您在 URL 上传入不同的回调名称，您会在响应中看到另一个名称。

（请注意，虽然我为谷歌工作，但这个答案不是谷歌以任何方式、形式或形式的“官方”回应。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:22:52.603

您可能想使用检查一下：

[Google Dictionary API 的 json_decode](https://stackoverflow.com/questions/6889764/json-decode-for-google-dictionary-api)

他们实际上修改了生成的 jsonp 以获取 json

# version-control - 为什么 Rational Team Concert 会更改文件的最后修改属性？

> ID：12362238
> 
> 赞同：1
> 
> 时间：2012-09-11T03:13:57.883
> 
> 标签：version-control, ibm-rational, rational-team-concert, ibm-jazz

我在我的服务器上安装 Rational Team Concert 时遇到了一些问题。

问题是，当我将一些更改上传到服务器（任何类型）时，它会更改文件的最后修改属性，但它不应该这样做。

有没有办法避免这种行为？

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T19:18:26.030

这是我们试图添加到 RTC SCM 的东西（我们仍然计划添加）。但是，我们发现它需要成为加载/更新的一个选项。

[在 jazz.net 上@this work item](https://jazz.net/jazz/web/projects/Rational%20Team%20Concert#action=com.ibm.team.workitem.viewWorkItem&id=83718)有许多细节和讨论可用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:01:25.943

关于时间戳，克服在版本控制工具中依赖它的事实并不总是被认为是最佳实践（请参阅“[什么是 git 的使用提交时间？](https://stackoverflow.com/questions/1964470/whats-the-equivalent-of-use-commit-times-for-git) ”），这实际上是一个复杂的问题：

*   SCM 加载程序不会仅使用时间戳来确定哪些文件已更改（[任务 179263](https://jazz.net/jazz/web/projects/Rational%20Team%20Concert#action=com.ibm.team.workitem.viewWorkItem&itemId=_yijSsO3IEeC6QPXP3XX4bA)）
*   您可以对该时间戳有各种要求（例如在[Defect 159043](https://jazz.net/jazz/web/projects/Rational%20Team%20Concert#action=com.ibm.team.workitem.viewWorkItem&itemId=_e0e9UFYBEeCOBbLKjM8odQ)中，其中磁盘上已修改文件的文件时间戳是交付时的时间戳，而不是我接受时的时间戳。）。提到了该变量`JAZZ_CCM_SKIP_MOD_TIME=true`，因此请检查这是否可以改善您的具体情况。
*   这一切都基于本地工作站正确设置时间戳的假设，这并不总是正确的，如[任务 77201中所示](https://jazz.net/jazz/web/projects/Rational%20Team%20Concert#action=com.ibm.team.workitem.viewWorkItem&itemId=_INPQkR_OEd6gT_fz7RhQTg)

# c# - EF5 和 .NET 4.5 中的未映射错误

> ID：12362243
> 
> 赞同：2
> 
> 时间：2012-09-11T03:14:26.303
> 
> 标签：c#, code-first, visual-studio-2012, .net-4.5, entity-framework-5

在 VS2012（.NET 4.5 和实体框架 5 ）

暴露继承关系时，导致编译时错误：

> 您不能对类型“MrTree.SubSubClass”的属性“InnerString”使用 Ignore 方法，因为此类型继承自映射此属性的类型“MrTree.BaseClass”。要从模型中排除此属性，请对基本类型使用 NotMappedAttribute 或 Ignore 方法。

代码如下：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Data.Entity;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            MyDbcontext db = new MyDbcontext();
            int i = db.SubSubClasses.Count();
        }
    }

    public class BaseClass
    {
        [NotMapped]
        public string InnerString { get; set; }
    }

    public class SubClass : BaseClass
    {
    }

    public class SubSubClass : SubClass
    {
    }

    public class MyDbcontext : DbContext
    {
        public DbSet<SubSubClass> SubSubClasses { get; set; }
        public DbSet<SubClass> SubClasses { get; set; }

    }
} 
```

你能告诉我有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:52:15.177

我找到了解决这个问题的方法，我自己也经历过。我确实发布了一些关于可能导致问题的补充信息，但它被一些自负的书呆子删除了，他们认为这不值得。所以这是我对这个问题的回答 - 可能不完全正确，但它对我有用，所以请不要删除这个书呆子先生，以防它帮助别人。

首先，此问题仅影响不直接使用 NotMapped 属性继承抽象类的类，而是根据原始声明从本身继承自基类的另一个类继承的类。

使用类似于以下类设置的内容对我有用：

基类：

```
public abstract class EntityBase
{
   public virtual int Id { get; set; } // this will be mapped
   public virtual int DoNotMap { get; set; } // this should be ignored   
} 
```

一级继承

```
public class Contact : EntityBase
{
  public string Name { get; set; }
} 
```

二级继承

```
public class Employee : Contact
{
  public DateTime StartDate { get; set; }
} 
```

创建一个继承自 EntityTypeConfiguration 的通用配置类：

```
public class DataEntityBaseConfiguration<T> 
  : EntityTypeConfiguration<T> where T : EntityBase
{
  public DataEntityBaseConfiguration()
  {
    Ignore(x => x.DoNotMap);
  }
} 
```

为直接从 EntityBase 类继承的所有第一级继承创建配置类，即：

```
public class ContactConfiguration : DataEntityBaseConfiguration<Contact>
{
   // place any further configuration rules in the constructor
} 
```

解决方法：任何*间接*继承自 EntityBase的类，只需创建一个继承自 EntityTypeConfiguration 的 Configuration 类：

```
public class EmployeeConfiguration : EntityTypeConfiguration<Employee>
{
  // place any further configuration rules in the constructor
} 
```

在您的 DataContext 中，在 OnModelCreating 方法中，添加您的配置：

modelBuilder.Configurations.Add(new ContactConfiguration()); modelBuilder.Configurations.Add(new EmployeeConfiguration());

假设在这种情况下采用 TPT 方法，将专用版本 Employee 映射到其自己的表，并与 Contact 具有 FK 关系：

```
 modelBuilder.Entity<Contact>().Map<Employee>(m => m.ToTable("Employees")); 
```

至少对我而言，这会创建一个没有“DoNotMap”属性的联系人表和一个没有“DoNotMap”表且与联系人有PK/FK 关系的员工表。即使我没有从 Employee Configuration 的 EntityBaseConfiguration 继承，它仍然以某种方式选择了 Ignore 并将其排除在外。我假设如果我们采用 TPH 方法，我们最终会得到一个单独的 Contact 表和 Discriminator 列。TPC 显然会重新创建 Employee 表中的所有 Contact 属性，但我不确定它是否还会创建 DoNotMap 属性 - 将在我有空时进行测试。

简而言之，回到最初的问题，我不确定为什么 NotMapped 属性和 Ignore 都会发生这种情况。当我的 EmployeeConfiguration 从 EntityBaseConfiguration 继承时出现错误。我不热衷于解决方法，因为它首先错误在其声明中是错误的，其次，即使解决方案现在非常简单，它也是一个很容易再次陷入的错误。

希望能帮助任何在这个继承问题上苦苦挣扎的人。

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-19T21:45:49.490

主键必须包含在 POCO 类定义 A 中的事实已经意味着 A 不是 POCO 对象。您不能忽略 POCO 对象的属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:20:39.790

你有一个叫你的财产`InnerString`吗`SubSubClass`？这就是错误的意思，尽管您的示例代码中没有列出它。

您上面的代码对我有用，但我必须添加一个 PK，这是整个控制台应用程序：

```
 public class BaseClass
   {
      public int Id { get; set; }
      [NotMapped]
      public string InnerString { get; set; }
   }

   public class SubClass : BaseClass
   {
   }

   public class SubSubClass : SubClass
   {
   }

   public class MyDbcontext : DbContext
   {
      public DbSet<SubSubClass> SubSubClasses { get; set; }
      public DbSet<SubClass> SubClasses { get; set; }
   }

   class Program
   {
      static void Main( string[] args )
      {
         var context = new MyDbcontext();

         context.SubSubClasses.Add(new SubSubClass());
         context.SaveChanges();
      }
   } 
```

以及它创建的数据库：

![在此处输入图像描述](../Images/f6b1ccf63aa1fbf5c63c76b9cefaec79.png)

# javascript - NodeList 上的 addEventListener

> ID：12362256
> 
> 赞同：36
> 
> 时间：2012-09-11T03:15:52.483
> 
> 标签：javascript, addeventlistener, nodelist

NodeList 是否支持 addEventListener。如果不是，将 EventListener 添加到 NodeList 的所有节点的最佳方法是什么。目前我正在使用如下所示的代码片段，有没有更好的方法来做到这一点。

```
var ar_coins = document.getElementsByClassName('coins');
for(var xx=0;xx < ar_coins.length;xx++)
{
        ar_coins.item(xx).addEventListener('dragstart',handleDragStart,false);
} 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-11T03:44:53.303

如果不遍历每个元素，就没有办法做到这一点。当然，您可以编写一个函数来为您执行此操作。

```
function addEventListenerList(list, event, fn) {
    for (var i = 0, len = list.length; i < len; i++) {
        list[i].addEventListener(event, fn, false);
    }
}

var ar_coins = document.getElementsByClassName('coins');
addEventListenerList(ar_coins, 'dragstart', handleDragStart); 
```

或更专业的版本：

```
function addEventListenerByClass(className, event, fn) {
    var list = document.getElementsByClassName(className);
    for (var i = 0, len = list.length; i < len; i++) {
        list[i].addEventListener(event, fn, false);
    }
}

addEventListenerByClass('coins', 'dragstart', handleDragStart); 
```

而且，尽管您没有询问 jQuery，但这是 jQuery 特别擅长的：

```
$('.coins').on('dragstart', handleDragStart); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-11-03T05:55:23.207

我能想到的最好的是：

```
const $coins = document.querySelectorAll('.coins')
$coins.forEach($coin => $coin.addEventListener('dragstart', handleDragStart)); 
```

请注意，这使用了 ES6 特性，因此请务必先转译它！

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-31T12:53:40.667

实际上*有一种方法可以在**没有*循环的情况下做到这一点：

```
[].forEach.call(nodeList,function(e){e.addEventListener('click',callback,false)}) 
```

这种方式用于我的一个单行助手库 - [nanoQuery](http://bitbin.it/T1eVO0Ur)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-04-12T09:20:17.840

最简单的示例是将此功能添加到`NodeList`

```
NodeList.prototype.addEventListener = function (event_name, callback, useCapture)
{
    for (var i = 0; i < this.length; i++)
    {
      this[i].addEventListener(event_name, callback, useCapture);
    }
}; 
```

现在你可以这样做：

```
document.querySelectorAll(".my-button").addEventListener("click", function ()
{
    alert("Hi");
}); 
```

同样的，你可以做一个`forEach`循环

```
NodeList.prototype.forEach = function (callback)
{
    for (var i = 0; i < this.length; i++)
    {
      callback(this[i], i);
    }
}; 
```

使用：

```
document.querySelectorAll(".buttons").forEach(function (element, id)
{
    input.addEventListener("change", function ()
    {
        alert("button: " + id);
    });
}); 
```

**编辑**：请注意 NodeList.prototype.forEach 自 2016 年 11 月以来在 FF 中一直存在。虽然不支持IE

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-12-07T13:35:01.560

在 es6 中，您可以使用 Array.from 从节点列表中创建一个数组，例如

```
ar_coins = document.getElementsByClassName('coins');
Array
 .from(ar_coins)
 .forEach(addEvent)

function addEvent(element) {
  element.addEventListener('click', callback)
} 
```

或者只使用箭头函数

```
Array
  .from(ar_coins)
  .forEach(element => element.addEventListener('click', callback)) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-01T13:03:00.927

我想另一种选择是定义`addEventListener`使用`NodeList`. `Object.defineProperty`这样您就可以像对待单个节点一样对待 NodeList。

例如，我在这里创建了一个 jsfiddle：http: [//jsfiddle.net/2LQbe/](http://jsfiddle.net/2LQbe/)

关键点是这样的：

```
Object.defineProperty(NodeList.prototype, "addEventListener", {
    value: function (event, callback, useCapture) {
        useCapture = ( !! useCapture) | false;
        for (var i = 0; i < this.length; ++i) {
            if (this[i] instanceof Node) {
                this[i].addEventListener(event, callback, useCapture);
            }
        }
        return this;
    }
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-31T19:08:55.047

另一种解决方案是使用事件委托。您只需向“.coins”的 closets 父级添加一个事件监听器，并在回调中使用 event.target 来检查点击是否真的在具有“​​coins”类的元素上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-14T10:00:49.637

你也可以使用原型

```
NodeList.prototype.addEventListener = function (type, callback) {
    this.forEach(function (node) {
        node.addEventListener(type, callback);
    });
}; 
```

# java - 如何将 MultiPageEditor 添加到 MultiPageEditor 作为子编辑器？

> ID：12362259
> 
> 赞同：2
> 
> 时间：2012-09-11T03:16:23.280
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp

当我尝试使用 addPage() 将自定义的多页编辑器放入多页编辑器时，我发现自定义的多页编辑器不会显示。有没有人遇到同样的问题，是否有解决方案？

代码如下

```
 private void createMultiPage() {
    try {
        multiPageEditor = new CustomizedMultiPageEditor();
        int index = addPage(multiPageEditor, getEditorInput());
        setPageText(index, "Customized MultiPage");
    } catch (Exception e) {
        System.out.print("opps!!!");
    }

} 
```

# jquery - HTML重置按钮不触发JQuery绑定功能

> ID：12362261
> 
> 赞同：3
> 
> 时间：2012-09-11T03:16:46.633
> 
> 标签：jquery

我在所有匹配的输入上都有这个绑定事件：

```
$('input[name$="_keyword"]').each(function() {
    $(this).bind("propertychange keyup input paste", function(event){
    if ($(this).val() != '') {
        $(this).prevAll('select').attr('disabled', true);
    } else {
        $(this).prevAll('select').attr('disabled', false);
    }
    });
}); 
```

如果文本已被输入到它的文本输入中，这将禁用相关的下拉菜单。

但是，如果我在其中一个输入中键入某人`_keyword`，从而禁用相关的下拉菜单，然后点击我的 HTML 重置按钮，表单中的所有字段都将清除，但下拉菜单将不会启用。单击重置按钮时如何启用这些？

```
<input type="reset" value="Reset"/> 
```

[JSFIDDLE](http://jsfiddle.net/qbVNR/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:26:17.803

您可以在表单的`reset`事件上注册一个处理程序以重新启用下拉菜单：

```
 $('form').on('reset', function() { $('form select').removeAttr('disabled'); }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T03:47:20.883

您需要`propertychange`通过重置按钮上的单击处理程序触发绑定中的事件之一（例如）。

```
$('input:reset').click(function() {
  $('input[name$="_keyword"]').val('').trigger("propertychange");
}); 
```

见工作小提琴：

[http://jsfiddle.net/GHpmh/1/](http://jsfiddle.net/GHpmh/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T03:26:27.670

表单重置不会触发您正在侦听的任何事件。您还需要绑定“重置”事件。不幸的是，您必须在表单级别绑定它，而不是在单个字段上，因为并非所有浏览器都会将重置事件冒泡到字段。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T03:28:14.173

将单击处理程序添加到您的重置按钮如何？例如：

```
$("input[type=\"reset\"]").on("click", function(event) {
    $("select").attr('disabled', true);
}) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-11T03:32:33.253

您可以在表单上监听`reset`事件并在那里启用选择

```
$('form').on('reset', function() {
    $('select', this).prop({disabled: false});
}); 
```

[​演示](http://jsfiddle.net/qbVNR/8/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-29T20:41:02.003

结合上面的几个答案，我会这样做以重置表单中的选择元素并触发更改功能

```
$('form').on('reset', function() { $('form select').val('all').trigger('change'); }); 
```

在表单标记中使用 HTML 重置按钮

```
<input type="reset" id="reset" value="Reset"> 
```

# php - 一般来说，取消codeigniter对象或php？

> ID：12362262
> 
> 赞同：1
> 
> 时间：2012-09-11T03:17:03.977
> 
> 标签：php, codeigniter, memory-management, memory-leaks, codeigniter-2

我正在使用 codeigniter 和 PHP 来构建一个 Web 应用程序，并且由于我必须执行大量查询，我必须在模型内部定义/使用很多对象。有时我必须在循环中多次使用同一个对象，例如：

```
 $dbData = $this->mydb->query($dbQuery);
  if($dbData->num_rows() >0 ){ //check if rows were returned
     $dbResult = $dbData->result();
     foreach( $dbResult as $index => $row){
        $dbArray[$row->JOB_NAME_STG] = $row->REC_LOADED;
    } 
```

在一般的编程实践中，一旦不再需要对象，您就应该将其无效，但我无法找到任何关于确保所有对象都无效的最佳方法的详细信息，从而避免一般的 codeigniter 或 php 的内存泄漏。

在函数末尾将 NULL 分配给对象是否足够？

```
$dbData = $this->mydb->query($dbQuery);
$dbData = NULL; 
```

或者 codeigniter 有更有效的方法来确保没有内存泄漏。

在使用之前是否应该在循环内使对象无效以确保没有内存泄漏？

任何方向的指针将不胜感激。谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:19:44.540

在以下情况下分配`null`没有意义：

1.  php >= 5.3
2.  几个小时都不能工作的应用程序

你符合以上两项吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T02:10:40.753

unset() 应该从内存中释放变量或对象。但是，PHP 没有很好的垃圾收集功能。他们正在尝试使用 5.3 的新循环垃圾收集来改进它，但它仍然面临挑战。

# mysql - 使用另一个表中的值更新表

> ID：12362263
> 
> 赞同：1
> 
> 时间：2012-09-11T03:17:06.370
> 
> 标签：mysql, sql

我正在尝试更新表中调用的行，该表称为从名为`ctcode`的表中的`partnumber`行复制值。然而，我的 SQL 语句返回和“'where 子句'中的未知列'families.parent'”错误。`ctcode``families`

这是我的 SQL 语句

```
UPDATE `partnumber` 
SET `partnumber`.`ctcode`=`families`.`ctcode` 
WHERE `partnumber`.`partnumber`=`families`.`parent`; 
```

我的陈述有什么问题？有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T03:19:22.613

`UPDATE`即使在语句中，您基本上也可以连接两个表，

```
UPDATE `partnumber` a INNER JOIN `families` b
          ON a.`partnumber` = b.`parent`
SET    a.`ctcode`= b.`ctcode` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T03:24:15.347

适用于 MySQL 5.5.24-0ubuntu0.12.04.1

```
UPDATE `partnumber`, `families`
SET `partnumber`.`ctcode`=`families`.`ctcode` 
WHERE `partnumber`.`partnumber`=`families`.`parent`; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T03:28:51.857

试试这个查询

```
UPDATE partnumber 
SET ctcode = f.ctcode   
FROM partnumber p 
INNER JOIN families f ON p.partnumber = f.parent 
```

# asp.net - 隐藏所有重定向信息

> ID：12362266
> 
> 赞同：2
> 
> 时间：2012-09-11T03:17:20.343
> 
> 标签：asp.net, response.redirect

我正在使用 Response.Redirect 来提供媒体文件，但不希望人们看到文件的直接 url 或子域（主机）。是否可以伪造“get”并隐藏主机和引用者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:41:50.703

使用[Server.Transfer](http://msdn.microsoft.com/en-us/library/ms525800%28v=vs.90%29.aspx)将请求处理转移到另一个页面。

> 当您使用 Transfer 方法时，所有内置对象的状态信息都包含在传输中。这意味着已在会话或应用程序范围内分配了值的任何变量或对象都将得到维护。此外，请求集合的所有当前内容都可用于接收传输的 .asp 文件。
> 
> Server.Transfer 作为 Response.Redirect 方法的有效替代品。Response.Redirect 指定浏览器请求不同的页面。因为重定向强制一个新的页面请求，浏览器向 Web 服务器发出两个请求，所以 Web 服务器处理一个额外的请求。IIS 5.0 引入了一个新函数 Server.Transfer，它将执行转移到服务器上的不同 ASP 页。这避免了额外的请求，从而获得更好的整体系统性能以及更好的用户体验。

由于浏览器不会发出另一个请求，因此该 url 对浏览器完全隐藏，但它仍会获取将由您的重定向 url 提供的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:29:04.330

你想要的是不可能的——原因很简单：要让客户端**直接**从另一个来源下载文件，你需要以某种方式将有关位置的信息传达给客户端：如果客户端不知道位置，它不能从那里下载。

无论您尝试以何种方式进行混淆，如果它对客户端浏览器来说是可解码的，那么它对于配备 firebug 的人来说也是可解码的。

# html - 无法确定 svg 元素的颜色

> ID：12362270
> 
> 赞同：2
> 
> 时间：2012-09-11T03:18:00.013
> 
> 标签：html, css, background, svg, background-color

我有一个非常简单的 HTML 页面，可以使用以下代码[在 gh-pages 上查看：](http://yasirs.github.com/toy-css-background/)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link href="style.css" media="screen" rel="stylesheet" type="text/css">
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'>
    </script>
  </head>
  <body>
    <div id="page">
      <div id="content">
        <div id="heatmap">
          <svg style="margin-left: 80px; color: rgb(255, 255, 255);" width="800" height="880">
            <g transform="translate(80,80)">
              <rect style="color: rgb(255, 255, 255);" height="720" width="720">
              </rect>
            </g>
          </svg>
        </div>
      </div>
    </div>
  </body>
</html> 
```

使用以下 CSS：

```
body {
background-color: #FFFFFF;
font-family: Arial, Helvetica, sans-serif;
font-size: 14px;
color: #FFFFFF;
}

#wrapper {
margin: 0 auto;
padding: 0;
}

#page {
width: 1000px;
margin: 0 auto;
padding: 40px 0px 0px 0px;
}

#content {
float: left;
width: 660px;
padding: 0px 0px 0px 0px;
background: #FFFFFF;
} 
```

我希望矩形`'svg rect'`是颜色`#FFFFFF`或白色。但它显示为其他颜色。我在萤火虫中打开它，它显示计算的颜色为#FFFFF： ![在此处输入图像描述](../Images/87e0fc310933677a1635f2e7cbe3c753.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T09:36:43.957

SVG 图形对象有两种颜色，一种内部填充颜色和一种轮廓描边颜色。SVG 使用填充和描边属性来控制这些颜色。

html color 属性在 SVG 中大部分是不用的，它只有在你使用 currentColor 时才起作用，所以你可以做 fill="currentColor" 并且填充颜色将与 html color 属性相同。

填充的默认值为黑色，描边的默认值为无。

因此，在您的情况下，您没有指定填充属性，而是得到黑色填充形状。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:20:39.280

要更改矩形的颜色，请更改填充样式：

```
<rect style="fill:white" width="720" height="720" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T03:23:17.157

颜色取自 svg 中的内联样式。这是 rgb(255,255,255) 它转换为没有 alpha 值的 #FFFFFF。此外，当您仅指定“颜色”值时，填充和描边等是根据通用颜色值计算的。所以最好使用 svg 的填充和描边等特定属性。用完整的十六进制表示法指定颜色，包括 alpha 通道，而不是 rgb()..如果你想指定 alpha。

# django - Cloudinary 的 CloudinaryImage 类的 Django 表单字段问题

> ID：12362288
> 
> 赞同：1
> 
> 时间：2012-09-11T03:20:29.060
> 
> 标签：django, django-forms, django-widget, cloudinary

我有一个[Django](https://www.djangoproject.com/)表单，它显示[CloudinaryImage](https://github.com/django/django/blob/0133d66734f5b0470436a22f5b85bdf7266bf1cf/django/forms/widgets.py#L335)的[ClearableFileInput](https://github.com/cloudinary/pycloudinary/blob/6d897c51c4a46a4f0b7c746125759e36abd4a366/cloudinary/__init__.py#L61)（来自[Cloudinary](https://cloudinary.com/)）。一切都很好，除了当我显示表单字段时，我在锚元素中得到一个损坏的 href：

```
Currently: <a href="&lt;bound method CloudinaryImage.url of &lt;cloudinary.CloudinaryImage object at 0x10b3f4ad0&gt;&gt;">&lt;cloudinary.CloudinaryImage object at 0x10b3f4ad0&gt;</a> <input type="checkbox" name="logo-clear" id="logo-clear_id" /> <label for="logo-clear_id">Clear</label><br />Change: <input id="id_logo" type="file" name="logo" class="span4" /> 
```

这是我正在使用的模板代码：

```
<div class="fieldWrapper">
    <label for="id_logo"><h3>{{ form.logo.label }}:</h3></label>
    {{ form.logo|add_class:"span4" }}
    <p>{{ form.logo.help_text }}</p>
</div> 
```

add_class 部分来自[django-widget-tweaks](https://github.com/kmike/django-widget-tweaks)。我去掉了 add_class 部分，输出没有变化。

这是我的表单定义：

```
class OrganizationFormTheme(forms.ModelForm):
    pass

    class Meta:
        fields = ('logo',)
        model = Organization 
```

看起来 Django 的 CloudinaryImage 的 url 函数有问题。我怀疑它正在寻找一个简单的属性而不是一个函数。

有关如何处理此问题的任何建议？我应该继承 CloudinaryImage 并以某种方式重写 url 函数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T14:03:35.120

`url`实际上，功能和`url`属性之间存在冲突。我们已将函数更改为`build_url`而不是`url`.

此外，您可以`url_options`在调用[CloudinaryImage](https://github.com/cloudinary/pycloudinary/blob/master/cloudinary/__init__.py#L61)的构造函数时指定转换参数作为参数。然后，您可以使用该`url`属性获取完整的 Cloudinary URL。

该修复程序在最新版本的 Python 库中可用：http: [//pypi.python.org/pypi/cloudinary](http://pypi.python.org/pypi/cloudinary)

# javascript - 如何在javascript下划线模板中转义<>？

> ID：12362290
> 
> 赞同：6
> 
> 时间：2012-09-11T03:20:35.460
> 
> 标签：javascript, html, templates, escaping, pug

使用下划线模板时，我想在锚的 href 属性中插入一个值，例如

```
a(href= "<%= id %>", class='products') //underscore template in jade 
```

但输出是

```
<a href="&lt;% id %&gt;" class="products"> 
```

那么如何转义 < 和 > 符号，并正确插入值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:08:54.783

使用 != 而不是 = 来取消转义。

在你的情况下：

```
a.products(href!="<%= id %>") 
```

# iphone - UIImageView 和 UIScrollView 加载很多图片

> ID：12362294
> 
> 赞同：2
> 
> 时间：2012-09-11T03:20:49.400
> 
> 标签：iphone, ios, uiimageview

在我的应用程序中，我使用`UIImageView`and`UIScrollView`来显示很多图像（每次大约有 20 张图像，每张图像大约为 600px*500px，大小约为 600kb）。

我使用这段代码来完成这个功能：

```
// Here is pictures Data;
self.klpArry = self.pictureData;

CGSize size = self.klpScrollView1.frame.size;
for (int i=0; i < [klpArr count]; i++) {
    UIImageView *iv = [[UIImageView alloc] initWithFrame:CGRectMake((size.width * i)+300, 20, 546, 546)];
    NSString *filePath = [[NSBundle mainBundle] pathForResource:[klpArr objectAtIndex:i] ofType:@"jpg"];
    UIImage *imageData = [[UIImage alloc]initWithData:[NSData dataWithContentsOfFile:filePath]];
    [iv setImage:imageData];   
    iv.backgroundColor = [UIColor grayColor];
    [self.klpScrollView1 addSubview:iv];
    imageData = nil;
    iv = nil;
    iv.image = nil;
    filePath = nil;
    [imageData release];
    [filePath release];
    [iv release];
}
    // show the picture in scrollview;
[self.klpScrollView1 setContentSize:CGSizeMake(size.width * numImage, size.height)];
self.klpScrollView1.pagingEnabled = YES;
self.klpScrollView1.showsHorizontalScrollIndicator = NO;
self.klpScrollView1.backgroundColor = [UIColor grayColor]; 
```

但是每次初始化这个函数，内存会增加5MB左右。实际上我释放`UIImageView`,`UIimage`和`UIScrollView`( `vi.image=nil, [vi release]`) 但它不起作用，分配的内存没有被释放。`vi.image = nil`顺便说一句，我先使用了我朋友的代码，`vi = nil;`但图片没有显示在滚动视图上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:46:44.747

正如我所看到的，主要问题是您将局部变量设置为`nil`，然后您继续尝试在诸如`release`之类的方法中使用这些局部变量，但是因为它们已设置为`nil`，这些方法现在可以什么都没有，并且带有 +1 的对象`retainCount`（或者现在 +2，因为您已将它们添加到您的视图中）永远不会被释放。

因此，我建议如下：

```
//Here is pictures Data;
self.klpArry = self.pictureData;

CGSize size = self.klpScrollView1.frame.size;
for (int i=0; i < [klpArr count]; i++) {
    UIImageView *iv = [[UIImageView alloc] initWithFrame:CGRectMake((size.width * i)+300, 20, 546, 546)];
    NSString *filePath = [[NSBundle mainBundle] pathForResource:[klpArr objectAtIndex:i] ofType:@"jpg"];
    UIImage *imageData = [[UIImage alloc]initWithData:[NSData dataWithContentsOfFile:filePath]];
    [iv setImage:imageData];   
    iv.backgroundColor = [UIColor grayColor];
    [self.klpScrollView1 addSubview:iv];

    // Don't set these to nil, or else subsequent release statements do nothing!
    // These statements are actually not necessary because they refer to local
    // variables so you don't need to worry about dangling pointers. Make sure
    // you're not confusing the purpose of setting a pointer to nil in ARC to 
    // what you're doing in your non-ARC code.
    //
    // imageData = nil;
    // iv = nil;

    // You don't want to set this to nil because if iv is not nil, your image
    // will be removed from your imageview. So, not only is this not needed,
    // but it's undesired.
    //
    // iv.image = nil;

    // This statement is not necessary for the same reason you don't do it
    // to imageData or iv, either. This is probably even worse, though, because
    // filePath is not a variable that you initialized via alloc. You should 
    // only be releasing things you created with alloc (or new, copy, mutableCopy,
    // for which you issued a retain statement).
    //
    // filePath = nil;

    [imageData release];

    // filePath is a +0 retainCount already, so don't release. You only release
    // those items for which you increased retainCount (e.g. via new, copy, 
    // mutableCopy, or alloc or anything you manually retained).
    //
    // [filePath release];

    [iv release];
}

// show the picture in scrollview;
[self.klpScrollView1 setContentSize:CGSizeMake(size.width * numImage, size.height)];
self.klpScrollView1.pagingEnabled = YES;
self.klpScrollView1.showsHorizontalScrollIndicator = NO;
self.klpScrollView1.backgroundColor = [UIColor grayColor]; 
```

因此，您的代码将被简化（并更正）为可能只是：

```
//Here is pictures Data;
self.klpArry = self.pictureData;

CGSize size = self.klpScrollView1.frame.size;
for (int i=0; i < [klpArr count]; i++) {
    UIImageView *iv = [[UIImageView alloc] initWithFrame:CGRectMake((size.width * i)+300, 20, 546, 546)];
    NSString *filePath = [[NSBundle mainBundle] pathForResource:[klpArr objectAtIndex:i] ofType:@"jpg"];
    UIImage *imageData = [[UIImage alloc] initWithData:[NSData dataWithContentsOfFile:filePath]];
    [iv setImage:imageData];   
    iv.backgroundColor = [UIColor grayColor];
    [self.klpScrollView1 addSubview:iv];
    [imageData release];
    [iv release];
}

// show the picture in scrollview;
[self.klpScrollView1 setContentSize:CGSizeMake(size.width * numImage, size.height)];
self.klpScrollView1.pagingEnabled = YES;
self.klpScrollView1.showsHorizontalScrollIndicator = NO;
self.klpScrollView1.backgroundColor = [UIColor grayColor]; 
```

或者你可以通过使用进一步简化你的代码`autorelease`：

```
//Here is pictures Data;
self.klpArry = self.pictureData;

CGSize size = self.klpScrollView1.frame.size;
for (int i=0; i < [klpArr count]; i++) {
    UIImageView *iv = [[[UIImageView alloc] initWithFrame:CGRectMake((size.width * i)+300, 20, 546, 546)] autorelease];
    NSString *filePath = [[NSBundle mainBundle] pathForResource:[klpArr objectAtIndex:i] ofType:@"jpg"];
    UIImage *imageData = [[[UIImage alloc] initWithData:[NSData dataWithContentsOfFile:filePath]] autorelease];
    [iv setImage:imageData];   
    iv.backgroundColor = [UIColor grayColor];
    [self.klpScrollView1 addSubview:iv];
}

// show the picture in scrollview;
[self.klpScrollView1 setContentSize:CGSizeMake(size.width * numImage, size.height)];
self.klpScrollView1.pagingEnabled = YES;
self.klpScrollView1.showsHorizontalScrollIndicator = NO;
self.klpScrollView1.backgroundColor = [UIColor grayColor]; 
```

顺便说一句，声明（带`autorelease`）：

```
UIImage *imageData = [[[UIImage alloc] initWithData:[NSData dataWithContentsOfFile:filePath]] autorelease]; 
```

大概可以简化为：

```
UIImage *imageData = [UIImage imageWithContentsOfFile:filePath]; 
```

这会给你一个`UIImage`, 和一个 +0 `retainCount`（即你不必这样做`release`）你的文件。

所以，最后的一些观察：

1.  您真的应该查看和学习[Advanced Memory Management Programming Guide](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)。如果您是内存管理的新手，那么阅读量很大，但掌握这些概念（尤其是在非 ARC 代码中）至关重要。

2.  如果还没有，我鼓励您通过静态分析器（“产品”-“分析”或`shift`++ `command`）运行代码`B`。如果分析仪没有为您识别出许多（如果不是大多数）这些问题，我会感到惊讶。当您通过分析器运行代码时，您应该得到零警告。

3.  如果您想将其提升到一个新的水平，您可能希望对内存管理更加保守。*管理原则将是一个系统设计，在任何给定时间只加载 UI 所需的图像，这不仅涉及 calvinBhai 对图像延迟加载的出色建议（即在你的 UI真正*加载之前不要将图像加载到内存中）*需要它们），而且一旦它们滚出屏幕，它们也会主动释放图像。也许你不需要在你的应用程序中担心它，因为你一次只处理 20 张图像，但是如果你的任何作品集/画廊扩展到 100 或 1000 张图像，那么将所有这些图像保留在在任何给定时间进行记忆都是一个坏主意。这是一个更高级的概念，因此也许您应该首先关注现有代码的基本内存管理问题，但从长远来看，您可能需要考虑延迟加载和主动释放图像。*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T03:34:49.020

如果你关心记忆，

尝试延迟加载图像=加载可见图像，下一个和上一个图像。您不必将所有图像都添加到您的 klpscrollview 中。

一旦您弄清楚将图像延迟加载到滚动视图中，您就可以考虑修复未显示在滚动视图上的图像。

更容易搜索“延迟加载uiimage uiscrollview”*

# php - 将两种类型的引号作为字符串的文本块

> ID：12362297
> 
> 赞同：6
> 
> 时间：2012-09-11T03:21:00.343
> 
> 标签：php, string, escaping, quotes, double-quotes

我正在使用一个基于一些自定义模板系统的网站。假设在模板中我可以使用标签**[custom_text]**，它将像这样输出整个 html 块，通过 CMS 的富文本编辑器定义：

```
<b>Lorem ipsum dolor</b> sit amet, "consectetur adipisicing elit"<br /><br />
<b>sed doeiusmod</b> tempor incididunt ut's labore et dolore magna's aliqua. 
```

请注意，它包含两种类型的引号。除了将模板系统实际输出到页面之外，我无法预处理来自模板系统的任何内容，因为带有模板系统的 CMS 是经过编码的。

现在我实际上需要操作该块，例如从代码中删除所有换行符。我可以在页面上使用 php，但我无法定义包含该代码块的字符串。如果我这样做：

```
$string = "[custom_text]";
$string = '[custom_text]'; 
```

块中的引号会妨碍，过早地结束字符串。有什么明显的方法来处理这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T10:36:34.113

不知道为什么我之前没有想到这个，但是我可以简单地使用heredoc语法。

```
$string = <<<EOT
[custom_text]
EOT; 
```

将解决此案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:33:02.630

试试这个

```
<?php
$string = "This string has 'single quotes'";
echo addcslashes($string, '"\\');
?> 
```

输出将如下所示

```
This string has 'single quotes' 
```

此链接的此答案

[点击这里](https://stackoverflow.com/questions/5611468/is-there-a-php-function-that-only-adds-slashes-to-double-quotes-not-single-quote)

# android - 如何将通过蓝牙接收的数据通过管道传输到 android 设备之间的 mp3 文件中？

> ID：12362301
> 
> 赞同：3
> 
> 时间：2012-09-11T03:21:16.653
> 
> 标签：android, bluetooth, mp3, send, file-transfer

问题：如何将接收到的数据（通过蓝牙聊天示例代码发送）传输到 mp3 文件中？

目的：使用简单的蓝牙文件传输方法将 mp3 文件从一部 android 手机传输到另一部。

方法：使用 Android SDK 提供的蓝牙聊天示例，我将 MP3 文件通过管道传输到字节数组中，然后将数据传输到第二个设备。

当前状态：第二个设备接收到数据，（我通过将流输出到屏幕进行检查）但是我无法打开文件并将数据传输到其中，给它一个“.mp3”扩展名然后播放它.

**蓝牙聊天.java**

```
public byte[] lilfilebuffer = null;

private void sendMessage(String message) {

    lilfilebuffer = read(new File("/sdcard/media/07_The-organ.mp3"));
    mChatService.write(lilfilebuffer);

}

private byte[] read(final File file) {
    Throwable pending = null;
    FileInputStream in = null;
    final byte buffer[] = new byte[(int) file.length()];
    try {
        in = new FileInputStream(file);
        in.read(buffer);
    } catch (Exception e) {
        pending = new RuntimeException("Exception occured on reading file "
                        + file.getAbsolutePath(), e);
    } finally {
        if (in != null) {
                try {
                        in.close();
                } catch (Exception e) {
                        if (pending == null) {
                                pending = new RuntimeException(
                                        "Exception occured on closing file" 
                             + file.getAbsolutePath(), e);
                        }
                }
        }
        if (pending != null) {
                throw new RuntimeException(pending);
        }
    }
    return buffer;
}

// The Handler that gets information back from the BluetoothChatService
private final Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        switch (msg.what) {
        case MESSAGE_STATE_CHANGE:
            if(D) Log.i(TAG, "MESSAGE_STATE_CHANGE: " + msg.arg1);
            switch (msg.arg1) {
            case BluetoothChatService.STATE_CONNECTED:
                setStatus(getString(R.string.title_connected_to, mConnectedDeviceName));
                mConversationArrayAdapter.clear();
                break;
            case BluetoothChatService.STATE_CONNECTING:
                setStatus(R.string.title_connecting);
                break;
            case BluetoothChatService.STATE_LISTEN:
            case BluetoothChatService.STATE_NONE:
                setStatus(R.string.title_not_connected);
                break;
            }
            break;
        case MESSAGE_WRITE:
            byte[] writeBuf = (byte[]) msg.obj;

            try {
                FileOutputStream out = new FileOutputStream("/sdcard/media/testsong.mp3");
                out.write(writeBuf);
                out.close();

                } 
                catch (IOException e) 
                { 
                //System.out.println("Exception ");

                }
            break;
        case MESSAGE_READ:
            byte[] readBuf = (byte[]) msg.obj;

            try {
                FileOutputStream out = new FileOutputStream("/sdcard/media/testsong.mp3");

                out.write(readBuf);
                out.close();

                } 
                catch (IOException e) 
                { 
                //System.out.println("Exception ");

                }

            break;
        case MESSAGE_DEVICE_NAME:
            // save the connected device's name
            mConnectedDeviceName = msg.getData().getString(DEVICE_NAME);
            Toast.makeText(getApplicationContext(), "Connected to "
                           + mConnectedDeviceName, Toast.LENGTH_SHORT).show();
            break;
        case MESSAGE_TOAST:
            Toast.makeText(getApplicationContext(), msg.getData().getString(TOAST),
                           Toast.LENGTH_SHORT).show();
            break;
        }
    }
}; 
```

**蓝牙聊天服务.java**

```
public void write(byte[] out) {

    ConnectedThread r;

    synchronized (this) {
        if (mState != STATE_CONNECTED) return;
        r = mConnectedThread;
    }

    r.write(out);
}

private class ConnectedThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final InputStream mmInStream;
    private final OutputStream mmOutStream;

    public ConnectedThread(BluetoothSocket socket, String socketType) {
        Log.d(TAG, "create ConnectedThread: " + socketType);
        mmSocket = socket;
        InputStream tmpIn = null;
        OutputStream tmpOut = null;

        try {
            tmpIn = socket.getInputStream();
            tmpOut = socket.getOutputStream();
        } catch (IOException e) {
            Log.e(TAG, "temp sockets not created", e);
        }

        mmInStream = tmpIn;
        mmOutStream = tmpOut;
    }

    public void run() {
        Log.i(TAG, "BEGIN mConnectedThread");
        byte[] buffer = new byte[1024];
        int bytes;

        while (true) {
            try {

                bytes = mmInStream.read(buffer);

                mHandler.obtainMessage(BluetoothChat.MESSAGE_READ, bytes, -1, buffer)
                        .sendToTarget();
            } catch (IOException e) {
                Log.e(TAG, "disconnected", e);
                connectionLost();
                // Start the service over to restart listening mode
                BluetoothChatService.this.start();
                break;
            }
        }
    }

    public void write(byte[] buffer) {
        try {
            mmOutStream.write(buffer);

            mHandler.obtainMessage(BluetoothChat.MESSAGE_WRITE, -1, -1, buffer)
                    .sendToTarget();
        } catch (IOException e) {
            Log.e(TAG, "Exception during write", e);
        }
    }

}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T10:09:02.877

数据或 MP3 文件没有什么特别之处。您只需在播放之前将其写入磁盘。

我有一个应用程序 ( [BlueMuze](https://play.google.com/store/apps/details?id=com.alostpacket.bluemuze) ) 可以做到这一点，而我发现更困难的部分是建立和维护蓝牙连接以及正确配对时间。

但是，您的代码的问题是**您似乎每 1024 个字节创建并写入一个新文件。**

`FileOutputStream`每次“聊天”处理程序读取服务发送的消息时，您都会创建一个新的。相反，您只需要创建`FileOutputStream`一次并将缓冲区写入其中，直到到达文件末尾，然后关闭`FileOutputStream`.

希望有帮助。

# makefile - Make 添加了意外的 mv 命令

> ID：12362304
> 
> 赞同：3
> 
> 时间：2012-09-11T03:22:01.997
> 
> 标签：makefile, bison, flex-lexer

我正在使用 makefile 来构建我的 flex/bison 项目。我遇到了问题，因为它正在添加一个调用`yacc`和一个`mv`命令，从而覆盖我的一个文件。

```
user@dk ~/calc ±master⚡ » make clean                                                                  
rm -rf lex.yy.c calc.tab.h calc.tab.c calc
user@dk ~/calc ±master » make
bison -d calc.y
flex calc.lex
g++ -o calc calc.tab.c lex.yy.c calc.c
user@dk ~/calc ±master⚡ » make clean
rm -rf lex.yy.c calc.tab.h calc.tab.c calc
user@dk ~/calc ±master » touch calc.y
user@dk ~/calc ±master » make
bison -d calc.y
flex calc.lex
yacc  calc.y
mv -f y.tab.c calc.c
g++ -o calc calc.tab.c lex.yy.c calc.c
... Failure ... 
```

我将 makefile 简化到最低限度以重现这一点。使用 bison 创建两个文件：`calc.tab.c`和`calc.tab.h`. 我没有将 .h 文件作为目标，因为我不确定正确的方法是什么。对 bison 的调用将生成两个 calc.tab.* 文件，所以这不是我主要关心的问题。

构建此生成文件以避免生成对 yacc 和 mv 的调用的正确方法是什么？

```
calc: calc.tab.c lex.yy.c calc.c
    g++ -o calc calc.tab.c lex.yy.c calc.c

calc.tab.c: calc.y
    bison -d calc.y

lex.yy.c: calc.lex calc.tab.h
    flex calc.lex

clean:
    rm -rf lex.yy.c calc.tab.h calc.tab.c calc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:36:26.027

`mv`来自的`make`内置规则，其中包含：

```
%.c : %.y
    $(YACC.y) $<
    mv -f y.tab.c $@ 
```

看起来`make`正在尝试`calc.c`从`calc.y`. 对此的一些解决方案是自己重新定义该规则，或重命名`calc.y`为不会触发该规则的内容`calc.c`，或禁用`make`的内置规则。

您可以使用 列出所有内置规则`make -p`。

# python - python将输出行保存到新文件

> ID：12362306
> 
> 赞同：0
> 
> 时间：2012-09-11T03:22:07.577
> 
> 标签：python

我想对日志文件使用 python 创建过滤器。获取最近 7 天的记录。但是当我不知道如何比较时间时。就像当前时间是 2012 年 11 月 9 日一样，我想获取从 2012 年 4 月 9 日到现在的记录

日志文件如

```
 Sat Sep  2 03:32:13 2012 [pid 12461] CONNECT: Client "66.249.68.236"
 Sat Sep  2 03:32:13 2012 [pid 12460] [ftp] OK LOGIN: Client "66.249.68.236", anon     password "gxxglxxxxt@google.com"
 Sat Sep  2 03:32:14 2012 [pid 12462] [ftp] OK DOWNLOAD: Client "66.249.68.236",   "/pub/10.5524/100001_101000/100022/readme.txt", 451 
```

我用这个

```
 def OnlyRecent(line):
       print time.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y")
       print time.time()
    if  time.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y") < time.time():
        return True
    return False 
```

但它显示

```
 (2012, 9, 2, 3, 32, 13, 5, 246, -1) 
    1347332968.08
   (2012, 9, 2, 3, 32, 13, 5, 246, -1)
    1347332968.08
   (2012, 9, 2, 3, 32, 14, 5, 246, -1)
    1347332968.08 
```

选择多行后，如何创建新文件（* .txt 或日志）以将它们存储在脚本中，文件名使用当前日期

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:31:55.157

您可以使用 time.mktime 将时间元组转换为 unix 时间戳。

```
>>> import time
>>> time.mktime((2012, 9, 2, 3, 32, 13, 5, 246, -1))
1346527933.0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:33:06.370

使用 datetime.datetime.strptime 和 datetime.datetime.now() 使用相同的数据结构：

```
from datetime import datetime 
def OnlyRecent(line):
  return  datetime.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y") < datetime.now() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T03:36:17.460

而不是`time`使用`datetime`and `timedelta`。

```
seven_days = datetime.timedelta(days=7)

def OnlyRecent(line):
    dt = datetime.datetime.strptime(line.split('[')[0].strip(), "%a %b %d %H:%M:%S %Y")
    return dt > datetime.datetime.now() - seven_days 
```

# android - 如何将图像粘贴到另一个图像上？

> ID：12362309
> 
> 赞同：0
> 
> 时间：2012-09-11T03:22:55.210
> 
> 标签：android, image, overlay

我想拍摄一张图片，然后使用位图将其粘贴到另一张图片上。（基本上将图像 1 覆盖在图像 2 的顶部，然后能够保存它。）

我整天都在寻找这个。是否有任何教程可以显示这一点？我在 Android SDK 中也找不到任何执行此操作的函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:48:33.423

你可以像这样组合两个位图

```
public static Bitmap overlay(Bitmap bmp1, Bitmap bmp2) {
    Bitmap bmOverlay = Bitmap.createBitmap(bmp1.getWidth(), bmp1.getHeight(), bmp1.getConfig());
    Canvas canvas = new Canvas(bmOverlay);
    canvas.drawBitmap(bmp1, new Matrix(), null);
    canvas.drawBitmap(bmp2, 0, 0, null);
    return bmOverlay;
} 
```

# matlab - 在matlab中读取半精度浮点（float16 IEEE 754r）二进制数据

> ID：12362319
> 
> 赞同：1
> 
> 时间：2012-09-11T03:24:50.620
> 
> 标签：matlab

上次你帮了我很大的忙，希望这次你也能给我一些建议。

我用bit16（格式= bitn）将二进制文件读入matlab，得到一串1和0。

`bin = '1,00011,1111111111'`（16 位：1\. 符号，2-6\. 指数，7-16\. 尾数）

根据[ftp://www.fox-toolkit.org/pub/fasthalffloatconversion.pdf](ftp://www.fox-toolkit.org/pub/fasthalffloatconversion.pdf)它可以转换为

`out = (-1)^bin(1) * 2^(bin(2:6)-15) * 1.bin(7:16)`[指数和尾数仍然是二进制的吗？]

有人可以帮助我并告诉我如何处理pdf中提到的'eeeee'和'1.mmmmmmmmmm'，拜托。

非常感谢！

迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T03:03:10.877

[这个家伙](http://half.sourceforge.net/)制作了一个很棒的 C++ 头文件来处理 float16 - 半精度浮点数。惊人的！

迈克尔

# postscript - 如何在 PostScript 中避免 stackunderflow（使用变量# of arguments）

> ID：12362322
> 
> 赞同：3
> 
> 时间：2012-09-11T03:25:03.443
> 
> 标签：postscript, stackunderflow

我有一个带有两个变量的简单函数

```
/func {
/var1 exch def
/var2 exch def
... process ...
} def

(var2)(var1)func 
```

我想让 var2 可选。但是，如果不提供 var2，则会导致 stackunderflow 错误。仅当堆栈不为空时，如何创建 if 语句以捕获 var2，并且如果堆栈为空，则可能分配默认值。

就像是

```
(Stack is no empty) {/var2 exch def}{/var2 (default) def} ifelse 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T12:46:39.057

运算符计算堆栈上的`count`操作数。您可能想改为使用`[`在堆栈上放置一个标记，然后`counttomark`改为使用。当从其他例程调用您的例程时，这可以避免您对剩余或尚未使用的操作数感到困惑。当然，这意味着您必须将 提供`[`为堆栈上的操作数。

另一种常用的方法是让顶部操作数是一个整数，计算附加操作数的数量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T18:18:46.450

还有一种方法是传递命名参数的字典。修改您的示例...

```
/func { %<<params>>
%begin currentdict /var2 2 copy known not {(default) put}{pop pop} ifelse
<</var2(default)>> copy begin
% ... process ...
end } def

<<
/var1 (var1)
/var2 (var2)
>> func 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-16T01:19:05.600

另一种常用的方法是使用最顶层操作数的类型来确定要查找多少个操作数。

这是实现执行此操作的`rotate`运算符的一种方法：

```
/rotate { % angle ([matrix])?  rotate  -|[matrix]
    dup type /arraytype ne 
        { true exch matrix } % no array: create array, concat later
        { false 3 1 roll } % array: do not create, do not concat later
    ifelse                    % bool angle matrix
    dup 0                     % bool angle matrix matrix 0
          3 index cos put     % bool angle matrix
    dup 1 3 index sin put     % bool angle matrix
    dup 2 3 index sin neg put % bool angle matrix
    dup 3 4 3 roll cos put    % bool matrix
    exch { concat } if % [matrix]
} def 
```

# android - 我如何找出禁用接收器的意图过滤器？

> ID：12362332
> 
> 赞同：0
> 
> 时间：2012-09-11T03:26:53.130
> 
> 标签：android, intentfilter

例如

```
<receiver android:name=".BootReceiver" android:enabled="true">
    <intent-filter>    
        <action android:name="android.intent.action.BOOT_COMPLETED"/> 
    </intent-filter>
</receiver> 
```

一个应用程序有一个接收器，它设置`android:enabled="true"`。

我尝试了下面的代码，但它不起作用。

```
Intent intent = new Intent(Intent.ACTION_BOOT_COMPLETED);
List<ResolveInfo> resolveInfoList = mPackageManager.queryBroadcastReceivers(intent, PackageManager.GET_RESOLVED_FILTER); 
```

但 BootReceiver 不在 resolveInfoList 中。

我也尝试过这些代码。

```
PackageInfo packageInfo = mPackageManager.getPackageInfo(applicationInfo.packageName, PackageManager.GET_RECEIVERS);
ActivityInfo[] receivers = packageInfo.receivers; 
```

一些接收器是空的。

那么如何找出禁用接收器的意图过滤器呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:05:51.037

我的错。

我刚才找到了一个标志（GET_DISABLED_COMPONENTS）。

所以我可以使用这段代码

```
List<ResolveInfo> resolveInfoList = mPackageManager.queryBroadcastReceivers(intent, PackageManager.GET_DISABLED_COMPONENTS); 
```

现在它起作用了。

# css - 何时是调用 UIObject.getOffsetWidth 的合适时间？

> ID：12362333
> 
> 赞同：1
> 
> 时间：2012-09-11T03:26:57.937
> 
> 标签：css, gwt, offsetwidth

我想在 gwt 中获取 uiobject 的 offsetwidth。但这个值取决于：

1.  uiobject 附在哪里？
2.  相对css在哪里加载？
3.  uiobject 的大小可以在 onload 回调中修改。
4.  ...

所以，事情变得复杂了，特别是当你想获得 FlowPanel、Label、InlineLabel 等的这个值时。它的大小是动态计算的。

我的问题：何时或如何正确获得 offsetwidth？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T14:14:42.040

只有在页面完全呈现后，您才能获得正确的大小。否则，您将获得零值。通常，有两个用例：

(A) 告诉浏览器渲染你的视图。然后使用调度程序确保浏览器已完成渲染，然后再检查大小：

```
Scheduler.get().scheduleDeferred(new ScheduledCommand() {
    @Override
    public void execute() {
        int width = myPanel.getOffsetWidth();
        // do something with this width
    ]
] 
```

(B) 将调整大小处理程序附加到窗口。如果用户改变浏览器的窗口大小，所有的宽度和高度都可能改变。您不需要在 ResizeHandler 中使用调度程序 - 浏览器将在调用 ResizeHandler 之前完成重新呈现页面。

# mysql - 为什么这个简单的 MySQL 过程需要很长时间才能完成？

> ID：12362335
> 
> 赞同：1
> 
> 时间：2012-09-11T03:27:53.597
> 
> 标签：mysql, database

这是一个非常简单的 MySQL 存储过程。光标“commission”只有 3000 条记录，但过程调用需要 30 多秒才能运行。这是为什么？

```
DELIMITER //

DROP PROCEDURE IF EXISTS apply_credit//

CREATE PROCEDURE apply_credit()
BEGIN

  DECLARE done tinyint DEFAULT 0;
  DECLARE _pk_id INT;
  DECLARE _eid, _source VARCHAR(255);
  DECLARE _lh_revenue, _acc_revenue, _project_carrier_expense, _carrier_lh, _carrier_acc, _gross_margin, _fsc_revenue, _revenue, _load_count DECIMAL;

  DECLARE commission CURSOR FOR
    SELECT pk_id, eid, source, lh_revenue, acc_revenue, project_carrier_expense, carrier_lh, carrier_acc, gross_margin, fsc_revenue, revenue, load_count FROM ct_sales_commission;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

  DELETE FROM debug;

  OPEN commission;

  REPEAT
    FETCH commission INTO
      _pk_id, _eid, _source, _lh_revenue, _acc_revenue, _project_carrier_expense, _carrier_lh, _carrier_acc, _gross_margin, _fsc_revenue, _revenue, _load_count;
    INSERT INTO debug VALUES(concat('row ', _pk_id));

  UNTIL done = 1 END REPEAT;

  CLOSE commission;

END//

DELIMITER ;
CALL apply_credit();
SELECT * FROM debug; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:37:23.167

如果您选择一些数据，并插入到另一个表中，您可以这样做：

```
INSERT INTO debug 
SELECT concat('row ', _pk_id)
FROM ct_sales_commission; 
```

它比使用游标更快。

* * *

一些小转折：

*   删除表上的所有索引`debug`。

*   替换`DELETE FROM`成`TRUNCATE TABLE`.

*   添加`DELAYED`到插入语句。

    ```
    INSERT DELAYED INTO ... VALUES(....) 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:55:59.477

该数据库托管在离我的 MySQL 客户端很远的数据中心中。

连接到离 MySQL 服务器很近的 MySQL 客户端使执行时间快了近 60 倍（过程完成时间不到一秒）。

我怀疑 MySQL 客户端 CLI 在处理这样的远程数据连接时存在问题。

# c# - xaml 中的菜单栏如何自行调整大小？

> ID：12362336
> 
> 赞同：2
> 
> 时间：2012-09-11T03:27:55.757
> 
> 标签：c#, xaml

如果我最大化或最小化窗口，如何使 WPF 应用程序的 xaml 文件中的菜单栏自动调整大小？

这是代码：

```
<Window x:Class="Interface.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Physiosoft" Height="750" Width="1100">
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <Menu Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="1" Height="23" HorizontalAlignment="Left" Name="menu1" VerticalAlignment="Top" Width="1088" MinHeight="23" MinWidth="1088">
        <MenuItem Header="File">
            <MenuItem Header="Save                     Ctrl + S" />
        </MenuItem>
        <MenuItem Header="Help">
            <MenuItem Header="About Physiosoft                                F1" />
        </MenuItem>
    </Menu>
</Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:29:20.053

要么在具有停靠属性的[DockPanel](http://msdn.microsoft.com/en-us/library/system.windows.controls.dockpanel.aspx)内使用它来填充（[通过，精确地不设置它](http://msdn.microsoft.com/en-us/library/ms750624.aspx)），要么在宽度/高度设置为的[Grid](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&frm=1&source=web&cd=1&ved=0CB8QFjAA&url=http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.aspx&ei=XbBOUKGXJOPt0gGAl4DADA&usg=AFQjCNGC4ZxJdgKJY9NNL4uEXTExRi7-jw&sig2=lx_FP10u6vUQAz4w4_-Q4g)`*`列/行中使用它，以便它会自动调整到可用空间。

例如，这将创建一个带有主面板和可调整大小的菜单的三列布局，将其用作起点：

```
<Window x:Class="Interface.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Physiosoft" Height="750" Width="1100">
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <Menu Grid.Column="0" Grid.ColumnSpan="3" Grid.Row="1"  Name="menu1">
        <MenuItem Header="File">
            <MenuItem Header="Save                     Ctrl + S" />
        </MenuItem>
        <MenuItem Header="Help">
            <MenuItem Header="About Physiosoft                                F1" />
        </MenuItem>
    </Menu>
</Grid> 
```

# c - 如果从另一个文件夹调用程序不工作

> ID：12362338
> 
> 赞同：0
> 
> 时间：2012-09-11T03:28:24.447
> 
> 标签：c, windows, command-line

在命令提示符中，这有效：`whatever\folder> bezier.exe`

但这不是：`whatever> folder\bezier.exe`

我的贝塞尔程序从本地文件加载一些设置，所以我认为问题在于程序认为它的目录`whatever\`实际上是`whatever\folder\`. 我在 C 程序中使用`CreateProcess()`. 如果我猜对了这个问题，有没有办法确保程序有正确的目录？

bezier.exe的主要方法：

```
int main(int argc, char* argv[]) {
char buf[200];
FILE* f = fopen("out.txt","w");
GetCurrentDirectory(200,buf);
fprintf(f,buf);
fclose(f);

SDL_Surface* screen;
SDL_Event e;

SDL_Init(SDL_INIT_VIDEO);
screen = SDL_SetVideoMode(WIDTH, HEIGHT, 32, SDL_FULLSCREEN|SDL_HWSURFACE);
if (screen == NULL)
    exit(-1);
SDL_ShowCursor(SDL_DISABLE);

srand(time(NULL));

loadColors(COLOR_FILE);

fill(screen, backColor);
initialiseVars();

while (e.type != SDL_KEYDOWN)
{
        //do stuff
}

SDL_Quit();
return 0; 
```

}

这是疯狂的部分。使用“..> folder\bezier.exe”它不会写它的路径，但它会启动一个新窗口。这对我来说没有任何意义，因为 SDL_SetVideoMode 是在编写路径之后。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:30:26.880

您可以使用[`GetModuleHandle`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683199%28v=vs.85%29.aspx)and[`GetModuleFileName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683197%28v=vs.85%29.aspx)找出可执行文件的位置，然后使用该信息为本地设置文件创建文件规范。

`GetModuleHandle`使用 NULL 参数将为您提供当前可执行文件的句柄。然后，将其传递`GetModuleFileName`给您将为您提供该可执行文件的完全限定名称。只需从末尾剥离可执行文件名并添加您的配置文件名。

*但是，很长一段*时间以来，这一直是个坏主意，因为 Windows 为此类东西提供了每个应用程序和每个用户的设置区域 - 您通常可以使用[`SHGetFolderLocation()`和它的 brethren](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762494%28v=vs.85%29.aspx)获得这些位置。

仅当这是针对个人项目时才使用第一种方法。如果您计划将您的软件发布到野外，您应该按照 Microsoft 指南将可执行信息和配置信息分开。

* * *

不管怎样，您现在似乎遇到了您认为文件没有被写入的问题。你需要检查一下。当您打开该文件`out.txt`进行写入时，它会在*当前*目录中执行此操作。如果您在父目录中运行（带有`folder\bezier.exe`），它将在父目录中创建它，并且在目录中查找它`folder`是浪费时间。

如果您*正在*查看运行该程序的目录，但仍未创建该目录，则可能有原因。首先，您应该检查（即捕获和输出）*所有*这些`f*`函数的返回码`fopen`，`fprintf`和`fclose`。

# javascript - 在页面卸载时写入 HTML5 FileSystem API 存储

> ID：12362340
> 
> 赞同：0
> 
> 时间：2012-09-11T03:28:29.930
> 
> 标签：javascript, html, google-chrome

所以我使用 HTML5 FileSystem API 将大量数据写入文件——我想在 HTML 页面被卸载时写入这些数据，即当用户离开时。

[http://www.html5rocks.com/en/tutorials/file/filesystem/](http://www.html5rocks.com/en/tutorials/file/filesystem/)

它不起作用，我担心可能没有办法让它起作用。即使你已经有一个文件系统的引用，至少有两个回调你必须等待：一个在你调用 getFile 之后，它会给你一个 fileEntry，下一个在你调用 createWriter 之后，它会给你一个 fileWriter——不是提及成功/失败回调。我认为回调没有被调用，因为用户正在导航。

有没有办法解决？我尝试使用 onbeforeunload 和确认消息来导航，只是想看看对话框引入的延迟是否会给它时间写，但这不起作用（可能是由于 Javascript 是单线程的？）现在我想知道如果我可以在他们在页面上的整个过程中保留一个打开的 fileWriter，以期待他们什么时候离开？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T01:34:37.400

`onunload`在某些浏览器中，您可以在/中执行的操作（或您可以执行的工作量）是有限制的`onbeforeunload`。例如，`onunload`在 Chrome 中完成有 1 秒的超时时间。您排队的任何异步任务`onunload`都不能保证一旦退出就会运行。

（当一个页面被卸载时，浏览器会释放脚本执行上下文，因此一些在页面消失之前没有发布的链式回调将不会运行。）

我建议尝试像您正在做的那样缓存 fileEntry/fileWriter，但没有任何保证，尤其是在您写入大量数据的情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T11:17:51.880

我得到了这个工作

1.  打开文件并在页面加载时获取写入器（所以，我全部完成：请求配额、获取文件系统、文件条目和文件写入器，然后在用户在页面上时保持文件写入器

2.  在“onbeforeunload”事件中写入文件

3.  从“onbeforeunload”返回一个字符串，因此当您离开页面时会显示确认消息。这很烦人，但确认消息对于给它时间来完成文件写入是必要的。如果你不这样做，写入永远不会发生。

仍然开放以获得更好的解决方案，如果没有确认消息会很好。

# regex - perl中的数据列表

> ID：12362343
> 
> 赞同：2
> 
> 时间：2012-09-11T03:28:49.057
> 
> 标签：regex, perl, tabular

我有如下输入格式，我想为这些数据创建一个表格格式。

```
CELL    = "abc"
        "model"         "abc"
        "description"   "qwerty+keypad with slide"
**tech**
        size    (big \$l \$w m)
        termOrder         (x y z)
        namePrefix        "S"
        prop       (nil \$l l \$w w)
    **spec**
        term      (nil C \:1 B \:2 E \:3)
        termOrder         (x y z)
***********************************************************
 CELL    = "efg"
        "model"        "efg"
        "description"  "touchscreen+qwerty no slide"
**tech**
        size    (small \$l \$w m)
        termOrder         (x y z)
        namePrefix        "S"
        prop       (nil \$l l \$w w)
 **spec**
        term          (nil x \:1 y \:2 z \:3)
        termOrder         (x y z) 
```

我想要一个表格，左边的名字作为标题，右边的数据作为它的值。

```
.                                         tech                            spec   
CELL   model   description   size   termOrder   namePrefix  prop  termOrder Term 
```

这些是标题，我想要这些标题下方的相应值。我尝试使用我用于另一种制表的代码：

```
my $pr      = "%-12s";  
my @headers = qw/............../;  
my %names;

while (<DATA>) {          

    chomp;          
    my $line = <DATA>;          
    %{$names{$_}} = split /=|\s+/, $line;  
} 

printf $pr x @headers . "\n", @headers;  

for (keys %names) {

    my @ds = ($_);          
    for my $k (@headers[1 .. $#headers]) {     

        my $v = $names{$_}->{$k};                 
        push @ds, $v ? $v : '-';
    }         
    printf $pr x @ds . "\n", @ds;
 } 
```

这不会产生所需的结果，所以请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T14:26:42.407

这确实不是最简单的任务，而且像往常一样，**有不止一种方法可以做到这一点**。这是一个。如果有任何问题，请随时提出，因为代码太多，无法解释所有内容。

但是，如果这是我的任务，我会选择 HTML 作为输出格式来摆脱所有这些宽度计算——还有舒适的 JS 工具来对这些表格进行排序。如果你真的想只用文本做这样的事情，也许“好的旧[格式](http://p3rl.org/perlform)”适合你。;)

## 代码

```
#!/usr/bin/env perl

use strict;
use warnings;
use feature 'switch';
use List::Util 'sum';

# preparations
my @blocks; # array for all data block
my $block;  # the data block we're working with
my $part;   # the data block part we're working with

# read things and decide what to do
for (<DATA>) {
    chomp;

    # start of a new data block, first part: main
    when (/CELL\s*=\s*"?([^"]+)"?/) {
        $part   = 'main';
        $block  = {
            $part   => {CELL => $1},
            tech    => {},
            spec    => {},
        };
        push @blocks, $block;
        next;
    }

    # start a new part
    when (/\*\*(tech|spec)\*\*/) {
        $part = $1;
        next;
    }

    # fill parts
    when (/"?(\w+)"?\s+"?([^"]+)"?/) {
        $block->{$part}{$1} = $2;
        next;
    }
}

# prepare output
my %columns = (
    main => [
        {name => 'CELL',        length =>  5},
        {name => 'model',       length =>  5},
        {name => 'description', length => 30},
    ],
    tech => [
        {name => 'size',        length => 20},
        {name => 'termOrder',   length => 10},
        {name => 'namePrefix',  length => 10},
        {name => 'prop',        length => 20},
    ],
    spec => [
        {name => 'term',        length => 30},
        {name => 'termOrder',   length => 10},
    ],
);

# part legend
foreach my $part (qw(main tech spec)) {
    my $width = sum map {$_->{length} + 2} @{$columns{$part}};
    print $part . ' ' x ($width - length $part);
}
print "\n";

# column legend
foreach my $part (qw(main tech spec)) {
    foreach my $column (@{$columns{$part}}) {
        my ($name, $length) = @{$column}{qw(name length)};
        print $name . ' ' x ($length - length($name) + 2);
    }
}
print "\n";

# print each block in columns
foreach my $block (@blocks) {
    foreach my $part (qw(main tech spec)) {
        foreach my $column (@{$columns{$part}}) {
            my $value = $block->{$part}{$column->{name}};
            print $value . ' ' x ($column->{length} - length($value) + 2);
        }
    }
    print "\n";
}

__DATA__
CELL    = "abc"
        "model"         "abc"
        "description"   "qwerty+keypad with slide"
**tech**
        size    (big \$l \$w m)
        termOrder         (x y z)
        namePrefix        "S"
        prop       (nil \$l l \$w w)
    **spec**
        term      (nil C \:1 B \:2 E \:3)
        termOrder         (x y z)
***********************************************************
 CELL    = "efg"
        "model"        "efg"
        "description"  "touchscreen+qwerty no slide"
**tech**
        size    (small \$l \$w m)
        termOrder         (x y z)
        namePrefix        "S"
        prop       (nil \$l l \$w w)
 **spec**
        term          (nil x \:1 y \:2 z \:3)
        termOrder         (x y z) 
```

## 输出

```
main                                          tech                                                                spec                                        
CELL   model  description                     size                  termOrder   namePrefix  prop                  term                            termOrder   
abc    abc    qwerty+keypad with slide        (big \$l \$w m)       (x y z)     S           (nil \$l l \$w w)     (nil C \:1 B \:2 E \:3)         (x y z)     
efg    efg    touchscreen+qwerty no slide     (small \$l \$w m)     (x y z)     S           (nil \$l l \$w w)     (nil x \:1 y \:2 z \:3)         (x y z) 
```

# string - 空格/制表符/换行不敏感比较

> ID：12362347
> 
> 赞同：2
> 
> 时间：2012-09-11T03:29:15.437
> 
> 标签：string, bash, shell, comparison, diff

假设我有这两个文件：

文件 1： `1 2 3 4 5 6 7`

文件 2：

```
1
2
3
4
5
6
7 
```

是否可以`diff`用来比较这两个文件，结果是`equal`？

（或者如果没有，我应该使用哪些其他工具？）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:38:38.457

您可以折叠空格，`file2`看起来像`file1`，每个数字都在同一行：

```
$ cat file1
1 2 3 4 5 6 7
$ cat file2
1
2
4
3
5
6
7
$ diff <(echo $(< file1)) <(echo $(< file2))
1c1
< 1 2 3 4 5 6 7
---
> 1 2 4 3 5 6 7 
```

解释：

```
< file             # Equivalent to "cat file", but slightly faster since the shell doesn't
                   #     have to fork a new process.

$(< file)          # Capture the output of the "< file" command. Can also be written
                   #     with backticks, as in `< file`.

echo $(< file)     # Echo each word from the file. This will have the side effect of
                   #     collapsing all of the whitespace.

<(echo $(< file))  # An advanced way of piping the output of one command to another.
                   #     The shell opens an unused file descriptor (say fd 42) and pipes
                   #     the echo command to it. Then it passes the filename /dev/fd/42 to
                   #     diff. The result is that you can pipe two different echo commands
                   #     to diff. 
```

或者，您可能希望`file1`看起来像`file2`，每个数字在单独的行上。这将产生更有用的差异输出。

```
$ diff -u <(printf '%s\n' $(< file1)) <(printf '%s\n' $(< file2))
--- /dev/fd/63  2012-09-10 23:55:30.000000000 -0400
+++ file2   2012-09-10 23:47:24.000000000 -0400
@@ -1,7 +1,7 @@
 1
 2
-3
 4
+3
 5
 6
 7 
```

这类似于第一个命令`echo`更改为`printf '%s\n'`在每个单词后放置一个换行符。

**注意：**如果要比较的文件过长，这两个命令都将失败。这是因为命令行长度的限制。如果发生这种情况，那么您将需要解决此限制，例如将 echo/printf 的输出存储到临时文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:37:21.280

一些差异有`-b`（忽略空格）和`-w`（忽略空格），但由于 unix 实用程序都是面向行的，我不认为空格会包含`\n`字符。

Dbl-检查您的版本`diff`是否没有带有`diff --help | less`or的花哨的 gnu 选项`man diff`。

您上面的格式是否正确，文件 1，数据都在一行上？您可以强制 file2 将该格式与

```
awk '{printf"%s ", $0}' file2 
```

或如评论中所述，转换文件 1

```
awk '{for (i=1;i<=NF;i++) printf("%s\n", $i)}' file1 
```

但我猜你的数据并不是那么简单。此外，当您最没有时间处理它们时，可能会出现行长度限制。

可能不是你想听到的，`diff`像源代码这样复杂的东西并不是一门精确的科学。因此，如果您仍然需要帮助，请创建一个稍微复杂的测试用例并将其添加到您的问题中。

最后，您需要向我们展示您期望这样一个差异项目的输出是什么样子。现在我看不到任何有意义的方式来显示非平凡案例的这种差异。IHTH

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T07:28:54.560

如果事实证明数据确实足够简单，不会遇到限制，并且文件之间的唯一区别是第一个用空格分隔，第二个用换行符分隔，您也可以进行进程替换（如上所述）但是用 sed 用换行符替换第一个文件中的空格：

```
diff <(sed 's/ /\n/g' file1) file2 
```

# wpf - WPF 窗口设计的推荐高度和宽度

> ID：12362349
> 
> 赞同：0
> 
> 时间：2012-09-11T03:29:37.310
> 
> 标签：wpf, xaml

WPF 应用程序的推荐**高度**和**宽度是多少？**

我应该从屏幕分辨率 1024 x 768 还是 800 x 600 开始？

什么是推荐的，`DockPanel`或者`StackPanel`？哪个能够缩放到屏幕尺寸的最大值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:55:15.143

**WPF 应用程序的推荐高度和宽度是多少？** 我认为没有推荐的高度和宽度，因为它取决于用户到用户或系统屏幕分辨率。您无法提前预测用户屏幕的屏幕分辨率，它应该是通用的。而且这还取决于您如何管理该窗口中的控件？它们是可扩展的还是固定的高度和宽度。

**推荐的 DockPanel 或 StackPanel 是什么，能够缩放到最大屏幕尺寸？** 不同的面板控件有不同的重要性，但我认为**网格**是窗口级别的最佳面板控件。

我希望这将有所帮助。

# c# - 如何使用 asp.net 4.0 获取角色

> ID：12362355
> 
> 赞同：0
> 
> 时间：2012-09-11T03:29:54.537
> 
> 标签：c#, web-config, asp.net-4.0, roles, web.sitemap

我是 ASP.NET 4.0 和 C# 的新手。如果我想根据使用 web.sitemap 登录的用户隐藏/显示菜单项，我必须使用一个角色并在 web.config 中设置它。我想问，在哪里我能得到那个角色吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:59:37.313

```
if (User.IsInRole("rolename")) {
  // what you wan't to do.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:58:05.550

您需要使用 IPrincipal 来存储角色。

```
GenericIdentity userIdentity = new GenericIdentity((FormsIdentity)HttpContext.Current.User.Identity.Name);

string[] roles = { "rolename1", "rolename2", "rolename3" };
GenericPrincipal userPrincipal = new GenericPrincipal(userIdentity, roles);
Context.User = userPrincipal; 
```

然后您可以检查用户角色

```
if (User.IsInRole("rolename1")) {
  // what you wan't to do.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:04:37.003

如果您真的是 ASP.NET 新手，您需要了解**用户和角色**。尝试将 Membership API 与“登录”等标准元素一起使用。之后，您必须使用自定义数据结构编写自己的用户和角色提供程序。然后，使用@Randolf RF 语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T05:14:48.523

如果我理解正确，您是说您打开了一个 asp.net Web 应用程序项目，并且您想知道如何创建用户并为他们分配角色。

如果您当前将 web.config 配置为使用角色管理器和成员资格提供程序的默认提供程序，那么 asp.net 将处理所有棘手的事情。您唯一需要做的就是转到菜单栏并选择“项目-> ASP.NET 配置”。这将打开一个用于创建用户和角色然后分配它们的 GUI。它应该是一个非常不言自明的工具。这也应该满足您的 web.config 使用要求。

如上所述，如果您让用户登录，则可以执行以下操作：

if (User.IsInRole("rolename")) { // 你不想做什么。}

或者（最适合你的 atm）你应该尝试在你的工具箱中使用 logInView 控件。（我认为这就是它的名字）对使用这些控件进行一些谷歌搜索，它会让你越过界限。

# sql - Linq to SQL 中的常量表达式未正确编译

> ID：12362357
> 
> 赞同：1
> 
> 时间：2012-09-11T03:30:39.503
> 
> 标签：sql, linq, expression, constant-expression

我有两个具有主从关系的表（mysql），我想在 Linq 中查询（然后在 LinqPad 中进行实验）。问题是 Linq to SQL 无法为以下查询生成正确的结果或 SQL 语句

```
from m in masters
select new {
   m.Code,
   m.Total,
   Value = m.details.Sum(d => d.Qty * d.Price * (1 - 6/100))
} 
```

还有一个

```
from m in masters
select new {
   m.Code,
   m.Total,
   Value = m.details.Sum(d => d.Qty * d.Price * 0.94)
} 
```

第一个查询不会像后者一样产生正确的结果，我在 LinqPad 中检查后的问题在于`(1 - 6/100)`编译成`1.0`. 有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:41:02.103

第一个表达式使用整数数学，因此是正确的，但不是您所期望的。您假设 C# 将从整数文字推断浮点语义。第二个表达式是一个简单的双重文字。

在整数数学中，`6/100`是 0，所以`(1 - 6/100)`是 1。您需要通过使分子或分母成为双精度字面量来*强制除法表达式使用双精度值。*

而是尝试：

```
Value = m.details.Sum(d => d.Qty * d.Price * (1 - 6/100.0)) 
```

请注意`.0`使之成为双重表达式。

# java - 当我在我的 tomcat6.0.35 中配置时，useHttpOnly="true" 没有用

> ID：12362360
> 
> 赞同：2
> 
> 时间：2012-09-11T03:31:25.123
> 
> 标签：java, tomcat6

正如我在标题中所说，当我在 context.xml 中设置了 useHttpOnly="true" 但我仍然可以在我的 javascript 中获取 jessionid。有什么我忘记配置的吗？

# c# - Twitter Bootstrap 和 ASP.NET GridView

> ID：12362361
> 
> 赞同：41
> 
> 时间：2012-09-11T03:31:25.700
> 
> 标签：c#, asp.net, gridview, .net-4.0, twitter-bootstrap

我在我的 ASP.NET 应用程序中使用[Twitter Bootstrap时遇到问题。](http://twitter.github.com/bootstrap/base-css.html#tables)当我使用`table table-striped`css 类来`asp:GridView`控制时，**它将表的*Header*视为*Row***。

## 我的网格视图

### ASP.NET 标记

```
<asp:GridView ID="dgvUsers" runat="server" 
    CssClass="table table-hover table-striped" GridLines="None" 
    AutoGenerateColumns="False">
    <Columns>
        <asp:BoundField DataField="UserID" HeaderText="ID" Visible="false" />
        <asp:BoundField DataField="Username" HeaderText="Username" />
        <asp:BoundField DataField="FirstName" HeaderText="First Name" />
        <asp:BoundField DataField="LastName" HeaderText="Last Name" />
    </Columns>
    <RowStyle CssClass="cursor-pointer" />
</asp:GridView> 
```

### 结果

![标题被视为一行](../Images/04136c58652e7b038d7625c43036b7ae.png)

```
<table id="cphMainContent_dgvUsers" class="table table-hover table-striped" 
       cellspacing="0" style="border-collapse:collapse;">
    <tbody>
        <tr>
            <th scope="col">Username</th>
            <th scope="col">First Name</th>
            <th scope="col">Last Name</th>
        </tr>
        <tr class="cursor-pointer">
            <td>user1</td>
            <td>Test</td>
            <td>User 1</td>
        </tr>
        <tr class="cursor-pointer">
            <td>user2</td>
            <td>Test</td>
            <td>User 2</td>
        </tr>
        <tr class="cursor-pointer">
            <td>user3</td>
            <td>Test</td>
            <td>User 3</td>
        </tr>
    </tbody>
</table> 
```

## 应该是这样的

![应该是这样的](../Images/ccaf8829ac29e54027b949c8a0b8ebe8.png)

```
<table class="table table-striped">
    <thead>
        <tr>
            <th>#</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Username</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>Mark</td>
            <td>Otto</td>
            <td>@mdo</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jacob</td>
            <td>Thornton</td>
            <td>@fat</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Larry</td>
            <td>the Bird</td>
            <td>@twitter</td>
        </tr>
    </tbody>
</table> 
```

如何使我`asp:GridView`的标题被 Twitter Bootstrap 视为标题？我的代码是 C#，框架 4，在 VS2010 Pro 中构建。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-11T03:59:54.317

在调用GridView 对象的方法后，您需要将`useaccessibleheader`gridview 的属性设置为`true`，然后还指定 a`TableSection`作为标题。`DataBind()`所以如果你的网格视图是`mygv`

```
mygv.UseAccessibleHeader = True
mygv.HeaderRow.TableSection = TableRowSection.TableHeader 
```

这应该会产生一个带有`thead`和`tbody`标签的格式正确的网格

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-05-14T01:19:28.630

有 2 个步骤可以解决此问题：

1.  添加`UseAccessibleHeader="true"`到 Gridview 标签：

    ```
    <asp:GridView ID="MyGridView" runat="server" UseAccessibleHeader="true"> 
    ```

2.  将以下代码添加到`PreRender`事件中：

```
 Protected Sub MyGridView_PreRender(sender As Object, e As EventArgs) Handles MyGridView.PreRender
    Try
        MyGridView.HeaderRow.TableSection = TableRowSection.TableHeader
    Catch ex As Exception
    End Try
End Sub 
```

请注意，设置 Header Row`DataBound()`仅在对象是数据绑定时有效，任何其他未对 gridview 进行数据绑定的回发将导致 gridview 标题行样式再次恢复为标准行。PreRender 每次都有效，只需确保当 gridview 为空时有错误捕获。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-02-25T20:18:34.233

只是为了记录，我在表格中有边框，为了摆脱它，我需要在 GridView 中设置以下属性：

```
GridLines="None"
CellSpacing="-1" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-20T15:07:34.513

在gridview中添加显示标题的属性

```
 <asp:GridView ID="dgvUsers" runat="server" **showHeader="True"** CssClass="table table-hover table-striped" GridLines="None" 
AutoGenerateColumns="False"> 
```

并在列中添加标题模板

```
<HeaderTemplate>
                   //header column names
</HeaderTemplate> 
```

# data-annotations - DataAnnotations.EnumDataTypeAttribute 在 Silverlight 中不起作用

> ID：12362362
> 
> 赞同：0
> 
> 时间：2012-09-11T03:31:38.930
> 
> 标签：data-annotations, wcf-ria-services, silverlight-5.0

在 SL5 中，我有一个 DataForm，它显示来自实体模型生成的 DomainService.metadata 的数据。

我正在使用诸如Required、StringLength 等DataAnnotation.ValidationAttribues 来修饰DomainService.metadata 中的数据属性。

这些验证属性运行良好，一旦我编译并运行，验证就会出现在 DataForm 中。

但我无法让 EnumDataType 属性在 DataForm 中工作，就好像它不存在一样：

```
 public partial class Student {

     internal sealed class StudentMetadata {

        public enum MyEnum {
           One = 1,
           Two = 2
        }

        private StudentMetadata() {
        }

        [EnumDataType(typeof(MyEnum), ErrorMessage = "Type 1 or 2")]
        public Nullable<int> Other { get; set; }

        [Required]
        public int Age { get; set; } 
```

例如，在 DataForm 中，字段**Age**不能为空，但如果我在**TypeOfRoom**字段中键入 4，则不会显示错误消息。

我知道我可以使用 ComboBox 或其他东西，但我正在尝试学习 EnumDataType 验证属性的用法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T07:05:16.337

您需要将属性`Other`的类型更改为您支持的 Enum 类型（在您的情况下`MyEnum`）。

```
 [EnumDataType(typeof(MyEnum), ErrorMessage = "Type 1 or 2")]
    public MyEnum Other { get; set; } 
```

# c++ - 当我们有模板模板参数时，为什么需要分配器::重新绑定？

> ID：12362363
> 
> 赞同：34
> 
> 时间：2012-09-11T03:31:40.843
> 
> 标签：c++, templates, allocator, template-templates

每个分配器类都必须有一个类似于以下的接口：

```
template<class T>
class allocator
{
    ...
    template<class Other>
    struct rebind { typedef allocator<Other> other; };
}; 
```

*使用*分配器的类会做一些多余的事情，如下所示：

```
template<class T, class Alloc = std::allocator<T> >
class vector { ... }; 
```

但为什么这是必要的？

换句话说，他们就不能说：

```
template<class T>
class allocator { ... };

template<class T, template<class> class Alloc = std::allocator>
class vector { ... }; 
```

哪个更优雅，更少冗余，并且（在某些类似情况下）可能更安全？
他们为什么走这`rebind`条路，这也造成了更多的冗余（即你不得不说`T`两次）？

（类似的问题`char_traits`和其余的......虽然他们不都有`rebind`，但他们仍然可以从模板模板参数中受益。）

* * *

### 编辑：

> ### 但是，如果您需要超过 1 个模板参数，这将不起作用！

实际上，它的效果非常好！

```
template<unsigned int PoolSize>
struct pool
{
    template<class T>
    struct allocator
    {
        T pool[PoolSize];

        ...
    };
}; 
```

现在 if`vector`只是这样定义的：

```
template<class T, template<class> class Alloc>
class vector { ... }; 
```

然后你可以说：

```
typedef vector<int, pool<1>::allocator> int_vector; 
```

它会很好地工作，*而不*需要你（多余地）说`int`两次。

并且`rebind`内部的操作`vector`将变成`Alloc<Other>`而不是`Alloc::template rebind<Other>::other`.

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-09-08T09:12:44.107

*[引用自C++11 算法基础](https://rads.stackoverflow.com/amzn/click/com/1482353482)*，第 1 卷，第 4 章，第 10 页的引用文本。35：

```
template <typename T> 
struct allocator 
{  
   template <typename U>  
   using  rebind = allocator<U>; 
}; 
```

示例用法：

```
allocator<int>::rebind<char> x; 
```

* * *

在*C++ 编程语言*，第 4 版，第 34.4.1 节，p。998，评论默认分配器类中的“经典”重新绑定成员：

```
template<typename U>
     struct rebind { using other = allocator<U>;}; 
```

Bjarne Stroustrup 写道：

> 奇怪的重新绑定模板是一个古老的别名。它应该是：
> 
> ```
> template<typename U>
> using other = allocator<U>; 
> ```
> 
> 但是，分配器是在 C++ 支持此类别名之前定义的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-11T04:07:42.177

> 但为什么这是必要的？

如果你的分配器类有多个模板参数怎么办？

这就是为什么通常不鼓励使用模板模板参数，而是支持使用普通模板参数，即使这意味着在实例化站点有一点冗余。在许多情况下（但是，可能不适用于分配器），该参数可能并不总是类模板（例如，具有模板成员函数的普通类）。

您可能会发现（在容器类的实现中）使用模板模板参数很方便，因为它简化了一些内部语法。但是，如果用户有一个多参数类模板作为他想要使用的分配器，但您要求用户提供一个分配器，它是一个单参数类模板，您实际上将强制他为几乎他必须使用该分配器的任何新上下文。这不仅不可扩展，而且做起来也很不方便。而且，在这一点上，该解决方案远不是您最初认为的“优雅且较少冗余”的解决方案。假设您有一个带有两个参数的分配器，以下哪个对用户来说最简单？

```
std::vector<T, my_allocator<T,Arg2> > v1;

std::vector<T, my_allocator_wrapper<Arg2>::template type > v2; 
```

您基本上强迫用户构建许多无用的东西（包装器、模板别名等）以满足您的实现需求。要求自定义分配器类的作者提供嵌套的重新绑定模板（这只是一个微不足道的模板别名）比使用替代方法所需的所有扭曲要容易得多。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-11T03:53:27.913

在您的方法中，您强制分配器成为具有单个参数的模板，但情况可能并非总是如此。在很多情况下，分配器可以是非模板的，嵌套的`rebind`可以返回相同类型的分配器。在其他情况下，分配器可以有额外的模板参数。第二种情况是 `std::allocator<>`，只要实现提供默认值，标准库中的所有模板都可以有额外的模板参数。还要注意，`rebind`在某些情况下，存在是可选的，`allocator_traits`可以使用 where 来获取回弹类型。

该标准实际上提到嵌套`rebind`实际上只是一个模板化的 typedef：

> §17.6.3.5/3 注意 A：上表中的成员类模板重新绑定实际上是一个 typedef 模板。[注意：通常，如果名称 Allocator 绑定到`SomeAllocator<T>`，则 `Allocator::rebind<U>::other`与 类型相同`SomeAllocator<U>`，其中 `someAllocator<T>::value_type`T 和`SomeAllocator<U>::value_type`U.-结束注释] 如果 Allocator 是形式的类模板实例化`SomeAllocator<T, Args>`，其中 Args 是零个或多个类型参数，并且 Allocator 不提供重新绑定成员模板，默认情况下使用标准 allocator_traits 模板`SomeAllocator<U, Args>`代替`Allocator:: rebind<U>::other`。对于不是上述形式的模板实例化的分配器类型，不提供默认值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-02T11:00:55.313

假设您要编写一个采用各种向量的函数。

那么能写就方便多了

```
template <class T, class A>
void f (std::vector <T, A> vec) {
   // ...
} 
```

而不是写

```
template <class T, template <class> class A>
void f (std::vector <T, A> vec) {
   // ...
} 
```

在大多数情况下，这样的函数无论如何都不关心分配器。

进一步注意，分配器不需要是模板。您可以为需要分配的特定类型编写单独的类。

设计分配器的一种更方便的方法可能是

```
struct MyAllocator { 
   template <class T>
   class Core {
      // allocator code here
   };
}; 
```

那么就可以写了

```
std::vector <int, MyAllocator> vec; 
```

而不是有点误导的表达

```
std::vector <int, MyAllocator<int> > vec; 
```

我不确定`MyAllocator`添加后是否允许将上述内容用作分配器`rebind`，即以下是否是有效的分配器类：

```
struct MyAllocator { 
   template <class T>
   class Core {
      // allocator code here
   };

   template <class T>
   struct rebind { using other=Core<T>; };
}; 
```

# sql - 员工数据库的 SQL 查询

> ID：12362367
> 
> 赞同：3
> 
> 时间：2012-09-11T03:32:06.810
> 
> 标签：sql

我是 SQL 新手，这学期我要上 DB 课。我有大约 20 个查询要在这个数据库上尝试，其中有两个我无法弄清楚......我想知道这里是否有人能够提供帮助！

这是我已经创建的表格。

```
create table employee(
  EID varchar(20) primary key,
  Lastname varchar(20),
  Firstname varchar(20),
  Midinitial char(1),
  gender char(1),
  street varchar(20),
  city varchar(20)
);

create table works(
  EID varchar(20) primary key,
  Lastname varchar(20),
  Firstname varchar(20),
  Midinitial char(1),
  company_name varchar(20),
  salary numeric(5,0),
  foreign key(EID) references employee,
  foreign key(company_name) references company
);

create table company(
  company_name varchar(20) primary key,
  city varchar(20)
);

create table manages(
  EID varchar(20) primary key,
  Lastname varchar(20),
  Firstname varchar(20),
  Midinitial char(1),
  ManagerLastname varchar(20),
  MFirstname varchar(20),
  MMidinitial varchar(20),
  start_date date,
  foreign key (EID) references employee
); 
```

查找为第一银行工作并住在奥马哈的所有经理的薪水。

这是我对这个我认为是正确的，但我不想回答这个问题，直到我也能得到第二个......

```
select distinct salary
from employee, works, manages
where employee.city = 'Omaha' 
  and works.company_name = 'First Bank' 
  and manages.managerlastname = employee.Lastname
  and employee.EID = works.EID 
```

和

查找所有员工中薪水最高的员工的姓名和公司名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:54:24.300

我很确定它应该是：

```
SELECT w.salary FROM works w INNER JOIN employee e ON w.EID = e.EID
 WHERE e.city = 'Omaha' AND w.company_name = 'First Bank' AND EXISTS
 ( SELECT * FROM managers m WHERE m.EID = w.EID); 
```

对于第二个：

```
SELECT e.Firstname, e.Lastname, w.company_name FROM employee e INNER JOIN
  works w ON e.EID = w.EID ORDER BY w.salary DESC LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:38:20.827

```
SELECT w.salary
FROM works w
INNER JOIN employee e
    ON e.EID = w.EID
        AND e.city = 'Omaha'
WHERE w.company_name = 'First Bank'; 
```

那应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T20:38:02.557

这两个都从我的表格中的信息中返回了我需要的东西。谢谢您的帮助！

查询 1

```
select distinct salary
from employee, works, manages
where employee.city = 'Omaha' 
  and works.company_name = 'First Bank' 
  and manages.managerlastname = employee.Lastname
  and employee.EID = works.EID 
```

查询 2

```
select firstname, lastname, company_name
from works w1, (select max(salary) as max_salary
            from works) w2
where w1.salary = w2.max_salary 
```

# ruby - Ruby - 在对象内调用方法并使用 .call()

> ID：12362368
> 
> 赞同：2
> 
> 时间：2012-09-11T03:32:29.850
> 
> 标签：ruby

我正在研究“Learn Ruby The Hard Way”，并且有一个关于在对象内部调用方法的问题。我希望有人可以对此有所了解。

[代码](http://ruby.learncodethehardway.org/book/ex43.html)是：

```
def play()
  next_room = @start

  while true
    puts "\n--------"
    room = method(next_room)
    next_room = room.call()
  end
end 
```

我知道`while`这种方法中的循环是使游戏继续进行到不同区域的原因。我的问题是，为什么`room.call()`必须首先传递给`next_room`它才能工作？为什么不只是做`room.call()`让游戏继续到下一个区域？

我自己对此进行了测试，但我不明白为什么它不能以这种方式工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T04:04:39.167

`next_room`是一个符号，它命名要调用的方法以确定下一个房间。如果我们查看其中一种房间方法，我们会看到如下内容：

```
def central_corridor()
  #...
  if action == "shoot!"
    #...
    return :death 
```

因此，如果您从`@start = :central_corridor`then in开始`play`，`next_room`将会以 as 开始，并且循环`:central_corridor`的第一个迭代器如下所示：`while`

```
room = method(next_room) # Look up the method named central_corridor.
next_room = room.call()  # Call the central_corridor method to find the next room. 
```

假设您选择在`room.call()`发生时进行拍摄，那么`:death`最终会在`next_room`. 然后通过循环的下一次迭代将查找`death`方法`room = method(next_room)`并执行它。

该[`method`](https://ruby-doc.org/core/Object.html#method-i-method)方法用于将符号转换`next_room`为方法，然后调用该方法以找出接下来会发生什么。接下来*发生*的部分来自 的返回值`room`。所以每个房间都由一个方法表示，这些方法返回代表下一个房间的方法的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-04T01:31:11.277

这是我创建的一个简单代码。在 print 语句的帮助下，我们能够可视化 method(next_room) 和 room.call() 的作用。

```
def printThis()
  puts "thisss"
end

next_room = "printThis"
print "next_room is:  ", next_room; puts

room = method(next_room)
print "room is:  ", room; puts

room.call() 
```

# node.js - 在模板中显示格式化的时间戳

> ID：12362373
> 
> 赞同：1
> 
> 时间：2012-09-11T03:32:53.517
> 
> 标签：node.js, meteor

如何在模板内格式化时间戳？我遵循了一个关于建立聊天的教程，它可以工作。现在我扩展了聊天功能，例如删除消息并将时间放在消息前面。`{{timestamp}}`但是当我在模板中写入时，会给出一个 UNIX 时间戳。我如何格式化它以显示像“6:12”这样的时间。时间戳存储在 Messages 集合中。

是在内部操作时间戳的正确位置

`Template.Messages.created = function ( ) { ... }`

功能？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T13:32:19.793

虽然在这种情况下不是必需的，但我建议使用[Moment.js](http://momentjs.com/docs/#/parsing/milliseconds-since-the-unix-epoch/)，它使在 Javascript 中处理日期和时间变得轻而易举。

您可以从 Atmosphere 安装软件包或将[脚本](https://raw.github.com/timrwood/moment/1.7.0/min/moment.min.js)下载到您的`client`目录中，然后使用类似于以下的帮助程序：-

```
Template.Messages.helpers({
    created: function() { 
        var time = moment(this.timestamp);
        return time.format('h:mm a');
    }
}); 
```

*注意：*我假设`timestamp`是上下文对象上的 var 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:07:36.773

我使用这个库。它为您提供了您将需要的所有日期格式。使用流星只需将其放入，您可以在任何帮助程序中使用它来返回格式化的日期。

[http://stevenlevithan.com/assets/misc/date.format.js](http://stevenlevithan.com/assets/misc/date.format.js)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T12:10:46.297

如果您想避免使用库并使用 Javascript Date 对象进行操作，我建议（假设日期采用 ISO 格式 2010-06-15T00:00:00，您可以从 Date.toISOString() 获取）：

实现 format 方法（感谢[JavaScript 等价于 printf/string.format](https://stackoverflow.com/questions/610406/javascript-equivalent-to-printf-string-format)），把它放在 ie lib/utils.js 中：

```
String.prototype.format = function(args, index) {
  return this.replace(/{(\w+)}/g, function(match, number) {
    return typeof args[index[number]] != 'undefined'
      ? args[index[number]]
      : match
    ;
  });
}; 
```

创建助手（放入client/client.js）

```
Handlebars.registerHelper('formatDate',function(input, pattern){
    var iso = /^(\d{4})(?:-?W(\d+)(?:-?(\d+)D?)?|(?:-(\d+))?-(\d+))(?:[T ](\d+):(\d+)(?::(\d+)(?:\.(\d+))?)?)?(?:Z(-?\d*))?$/;
    if(this[input]) {
        var parts = this[input].match(iso);
             return pattern.format(parts, {yyyy:1,MM:4,dd:5,hh:6,mm:7,ss:8,SSS:9});
        }
    return this[input];
}); 
```

使用助手：

```
{{#each logs}}
   <tr>
      <td>{{formatDate 'ts' '{yyyy}-{MM}-{dd} {hh}:{mm}:{ss}'}}</td> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-28T05:01:33.580

看看这个包[swag](https://github.com/elving/swag)，它提供了许多有用的车把助手。

查看它的日期/时间助手：[https ://github.com/elving/swag#dates](https://github.com/elving/swag#dates)

您可以像这样轻松地格式化日期/时间：

```
var date = new Date()

{{formatDate date "%m/%d/%Y"}}
{{formatDate date "%I:%M%p"}}
{{formatDate date "%F"}}
{{formatDate date "%Y%m%dT%H%M%S%z"}}

07/26/2015
11:38PM
2015-08-28
20150828T233805-0004 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-11T05:05:53.043

看看[Template helpers](http://docs.meteor.com/#template_helpers)和[JavaScript Date object](http://www.w3schools.com/js/js_obj_date.asp)。

# javascript - 将 px 中的 .width() 转换为 jQuery 中的 % 以在流动时为 Bootstrap 附加标签

> ID：12362376
> 
> 赞同：3
> 
> 时间：2012-09-11T03:33:10.910
> 
> 标签：javascript, jquery, css, math, units-of-measurement

我目前有：

jQuery

```
$(document).ready(function () { 
    $('.span-fix').each(function(){ /* Do this for each extended input */
        var wide = $(this).width(), /* create a variable that holds the width of the form */
            label = $(this).prev('.add-on').width(); /* create another variable that holds the width of the previous label */
        $(this).width( wide - label ); /* subtract the label width from the input width and apply it in px */
    });
}); 
```

html

```
<div class="input-prepend">
    <span class="add-on">Location</span>
    <input name="ctl00$ContentPlaceHolder1$tbLocation" type="text" id="tbLocation" class="span12 span-fix" placeholder="Location" style="width: 97.04668304668304%; ">
</div> 
```

显示问题的小提琴：http: [//jsfiddle.net/SuguM/](http://jsfiddle.net/SuguM/)

但是，这会在 中应用新的宽度`px`，并且我正在使用流体布局，并且需要再次将其设为百分比。

有没有办法将 apply 转换`px`为 a `%`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T16:18:40.637

实际上，您在计算中省略了填充。我认为这段代码可以帮助你。

**编辑 ：**

这是火狐的代码：

```
$(document).ready(function () {
    $('.span-fix').each(function(){ /* Do this for each extended input */
        var label = $(this).prev('.add-on').outerWidth();
        /* create another variable that holds the width of the previous label */
        $(this).width( (1-(label + $(this).outerWidth() - $(this).width())/$(this).parent().width()) *100 + "%" );
    });
}); 
```

这是 chrome 的代码：

```
$(document).ready(function () {
    $('.span-fix').each(function(){ /* Do this for each extended input */
        var label = $(this).prev('.add-on').outerWidth(); 
        /* create another variable that holds the width of the previous label */
        $(this).css("width", (1-(label)/$(this).parent().width()) *100 + "%" );
    });
});​ 
```

对于chrome，如果在检查width css属性时使用width方法，则必须设置属性css，属性值不等于计算值。

[这里](http://jsfiddle.net/charlesjourdan/vHCFm/)有一个关于 jsFiddle 的示例。

[这里](http://jsfiddle.net/charlesjourdan/vHCFm/3/)有两个实现的 jsFiddle。现在您只需要检测浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T08:08:55.507

根据我之前的一篇[文章](http://yckart.com/jquery-get-elements-percentage/)。

```
var getPercent = function(elem) {
    var elemName = elem.attr("id"),
        width = elem.width(),
        parentWidth = elem.offsetParent().width(),
        percent = Math.round(100 * width / parentWidth);
    return percent;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:41:53.883

这需要父母的宽度，只计算百分比。

```
$(this).width((wide - label)/$(this).parent().width()*100+'%'); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-11T03:44:42.060

这将计算整个文档的百分比：

```
$(this).width((wide - label) * 100 / $(document).width()+'%'); 
```

# php - 在 MySQL 中存储零件数据库可用年数的最佳方式

> ID：12362377
> 
> 赞同：2
> 
> 时间：2012-09-11T03:33:12.297
> 
> 标签：php, mysql

我将汽车零件存储在数据库中。显然，某些零件仅适用于特定车辆的特定年份。

将部分输入到 MySQL 时，我让用户只使用这种格式的日期，“41、42、43、45、46”等。然后我只是内爆，在 PHP 中爆炸。这适用于我需要做的事情。

现在我需要根据可用的年份来提取零件。如果可以的话，我不想在我的表单中使用多个选择框。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:37:48.520

**如果您想单独访问它们，永远不要在一个字段中存储多个信息。绝不。**

您将需要对数据库进行返工，以便在模型年份和零件之间建立可连接性，而不是将所有模型年份塞进零件表的单个字段中。

一些棘手的文本选择会起作用，但它肯定会扼杀你的表现。如果这是一个完整的零件目录，即使是单个模型，它也会影响你的性能到无法使用的程度。

抱歉：如果你真的不能两者兼得，那么诚实胜于礼貌。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T03:39:05.710

你有一个多对多的关系......所以创建另一个表

例子...

```
part_id | Year
--------------
  1      1995
  1      1996
  2      1995
  2      1997
  3      1998 
```

等等等等……

然后你可以使用类似的东西得到一个零件的所有年份

```
select *
from parts
join parts_years
    on (part_id = parts.id); 
```

# opengl-es - 如何在openGL es 2.0中的y轴上的新坐标中旋转（在x轴旋转90度后）

> ID：12362380
> 
> 赞同：1
> 
> 时间：2012-09-11T03:33:39.147
> 
> 标签：opengl-es

我在 x 轴上将立方体旋转 90 度，之后我想在 y 轴上再旋转 90 度，但它确实得到了预期的（来自我的）结果，因为它在我希望旋转发生之前旋转了让我们说在世界坐标中......我认为我当前的代码正在重置单位矩阵，但如果我删除该行，则不会呈现任何内容。这是我的代码：

```
public void onDrawFrame(GL10 arg0) {
//      GLES20.glEnable(GLES20.GL_TEXTURE_CUBE_MAP);
        GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT | GLES20.GL_DEPTH_BUFFER_BIT);
        GLES20.glUseProgram(iProgId);

    cubeBuffer.position(0);
    GLES20.glVertexAttribPointer(iPosition, 3, GLES20.GL_FLOAT, false, 0, cubeBuffer);
    GLES20.glEnableVertexAttribArray(iPosition);

    texBuffer.position(0);
    GLES20.glVertexAttribPointer(iTexCoords, 3, GLES20.GL_FLOAT, false, 0, texBuffer);
    GLES20.glEnableVertexAttribArray(iTexCoords);

    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
    GLES20.glBindTexture(GLES20.GL_TEXTURE_CUBE_MAP, iTexId);
    GLES20.glUniform1i(iTexLoc, 0);

    Matrix.setIdentityM(m_fIdentity, 0);

    if(rotating == true)
    {
        rotate();
    }

    Matrix.rotateM(m_fIdentity, 0, -xAngle, 0, 1, 0);
    Matrix.rotateM(m_fIdentity, 0, -yAngle, 1, 0, 0);

    Matrix.multiplyMM(m_fVPMatrix, 0, m_fViewMatrix, 0, m_fIdentity, 0);
    Matrix.multiplyMM(m_fVPMatrix, 0, m_fProjMatrix, 0, m_fVPMatrix, 0); 
```

// Matrix.translateM(m_fVPMatrix, 0, 0, 0, 1); GLES20.glUniformMatrix4fv(iVPMatrix, 1, false, m_fVPMatrix, 0);

```
 GLES20.glDrawElements(GLES20.GL_TRIANGLES, 36, GLES20.GL_UNSIGNED_SHORT, indexBuffer); 
```

// GLES20.glDisable(GLES20.GL_TEXTURE_CUBE_MAP); }

# image - 302 重定向到 IE8 中的图像不渲染图像

> ID：12362382
> 
> 赞同：1
> 
> 时间：2012-09-11T03:33:55.420
> 
> 标签：image, internet-explorer, redirect, http-status-code-302

我正在帮助迁移旧版应用程序。其中一项要求是我们能够处理对旧图像的请求。

我们拥有的是：

*   new.com 上的新网站
*   old.com 上的旧网站

链接的图像（导入的内容）指向 /imgs/cat.png，但实际图像托管在 old.com/assets/images/cat.png 上（目前）。

```
<img src="/imgs/cat.png"/> 
```

我为 302 对 new.com/imgs/(.*).(png|jpg|jpeg|gif) 的请求的所有 png、jpg、jpeg、gif 设置重定向到[http://old.com/assets/images/](http://old.com/assets/images/) $1.$2

在 Chrome、Firefox 和 IE9 中都可以找到 - 但是在 IE8 中注意到图像不会呈现。它可能在 IE7、6 和 5.5 中存在相同的问题，但是我无法对此进行测试。

有谁知道为什么会发生这种情况以及如何解决？

我尝试在 302 对 image/(png|jpg|jpeg|gif) 的响应中设置 contentType 标头，但这没有任何影响。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T04:12:43.457

事实证明，提供图像的主机不是 IE 中的受信任站点，而提供页面的主机是。通常你会看到一个弹出窗口询问你是否想接受一个不受信任的资源，但是因为这是一个 302 重定向（原始 img URL 是受信任的，但 302'd 是不受信任的）IE 从不显示弹出窗口。

# api - 地图不会在 Joomla 中正确显示

> ID：12362388
> 
> 赞同：0
> 
> 时间：2012-09-11T03:34:49.973
> 
> 标签：api, google-maps, joomla1.5, kml

我有以下使用 api google 的地图代码，我已经在几个 html 编辑器中测试了代码并且它的工作完美，但是当我在我的网页中上传时不起作用。地图在海洋中的某个随机点上全部放大。我在Joomla 1.5.20 中创建了一篇文章，粘贴代码。它显示在预览中，但不在网页中。我禁用过滤并使用无编辑器，但仍然无法工作。谢谢您的帮助。

```
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBInlv7FuwtKGhzBP0oISDoB2Iu79HNrPU&sensor=false">
    </script>
    <script type="text/javascript">

var map;

// lets define some vars to make things easier later

var kml = {
    a: {
        name: "Productor",
        url: "https://maps.google.hn/maps/ms?authuser=0&vps=2&hl=es&ie=UTF8&msa=0&output=kml&msid=200984447026903306654.0004c934a224eca7c3ad4"
    },
    b: {
        name: "A&S",
        url: "https://maps.google.hn/maps/ms?ie=UTF8&authuser=0&msa=0&output=kml&msid=200984447026903306654.0004c94bac74cf2304c71"
    }
// keep adding more if ye like 
};

// initialize our goo
function initializeMap() {
    var options = {
        center: new google.maps.LatLng(13.324182,-87.080071),
        zoom: 9,
        mapTypeId: google.maps.MapTypeId.TERRAIN
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), options);

var ctaLayer = new google.maps.KmlLayer('https://maps.google.hn/maps/ms?authuser=0&vps=5&hl=es&ie=UTF8&oe=UTF8&msa=0&output=kml&msid=200984447026903306654.0004c94bc3bce6f638aa1');
        ctaLayer.setMap(map);

var ctaLayer = new google.maps.KmlLayer('https://maps.google.hn/maps/ms?authuser=0&vps=2&ie=UTF8&msa=0&output=kml&msid=200984447026903306654.0004c94ec7e838242b67d');
        ctaLayer.setMap(map);

    createTogglers();
};

 google.maps.event.addDomListener(window, 'load', initializeMap);

// the important function... kml[id].xxxxx refers back to the top 
function toggleKML(checked, id) {

    if (checked) {

        var layer = new google.maps.KmlLayer(kml[id].url, {
            preserveViewport: true,
            suppressInfoWindows: true 
        });

 google.maps.event.addListener(layer, 'click', function(kmlEvent) {
          var text = kmlEvent.featureData.description;
          showInContentWindow(text);
        });

        function showInContentWindow(text) {
          var sidediv = document.getElementById('content_window');
          sidediv.innerHTML = text;
        }

        // store kml as obj
        kml[id].obj = layer;
        kml[id].obj.setMap(map);
    }
    else {
        kml[id].obj.setMap(null);
        delete kml[id].obj;
    }

};

// create the controls dynamically because it's easier, really
function createTogglers() {

    var html = "<form><ul>";
    for (var prop in kml) {
        html += "<li id=\"selector-" + prop + "\"><input type='checkbox' id='" + prop + "'" +
        " onclick='highlight(this,\"selector-" + prop + "\"); toggleKML(this.checked, this.id)' \/>" +
        kml[prop].name + "<\/li>";
    }
    html += "<li class='control'><a href='#' onclick='removeAll();return false;'>" +
    "Limpiar el Mapa<\/a><\/li>" + 
    "<\/ul><\/form>";

    document.getElementById("toggle_box").innerHTML = html;
};

// easy way to remove all objects
function removeAll() {
    for (var prop in kml) {
        if (kml[prop].obj) {
            kml[prop].obj.setMap(null);
            delete kml[prop].obj;
        }

    }
};

// Append Class on Select
function highlight(box, listitem) {
    var selected = 'selected';
    var normal = 'normal';
    document.getElementById(listitem).className = (box.checked ? selected: normal);
};

</script>

<style type="text/css">
.selected { font-weight: bold; }
</style>

</head>
<body>
<div id="map_canvas" style="width: 80%; height: 400px; float:left"></div>
<div id="toggle_box" style="position: absolute; top: 100px; right: 640px; padding: 10px; background: #fff; z-index: 5; "></div>
<div id="content_window" style="width:10%; height:10%; float:left"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T05:08:25.127

问题是使用 Dropbox 托管 KML 文件 insted google maps 解决的。

# java - 原子整数与同步

> ID：12362391
> 
> 赞同：-4
> 
> 时间：2012-09-11T03:35:17.630
> 
> 标签：java, multithreading

请告知 java.util.concurrent.atomic 包是实现同步的另一种选择，假设有一个变量并且 10 个不同的线程正在递增它，那么在这种情况下，原子整数在同步上下文中的作用是什么......！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:37:14.560

如果您只有一个整数要递增，那么可以 -`AtomicInteger`允许您轻松、高效且稳健地实现这一目标，而无需同步。

如果您需要做的不止这些——例如，如果您*实际上*需要更新多个变量，并且*必须*将它们作为一个单元进行更新，那么您会想要使用同步。

# iphone - 如何在 url 中发布 xml 数据作为请求？

> ID：12362392
> 
> 赞同：1
> 
> 时间：2012-09-11T03:35:16.747
> 
> 标签：iphone, post

我正在开发一个我想在其中发布的应用程序

xml 数据作为请求，但我认为我无法正确发布它。

我的请求 xml 数据是

`<loginRequest><username>101</username></loginRequest>`

我的要求如下：

```
`NSString *post=@"<loginRequest><username>101</username></loginRequest>";
NSURL *url = [NSURL URLWithString:@"my url"];
__block  ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
[request setRequestMethod:@"POST"];
NSMutableData *mutData=[[NSMutableData alloc]init];

[request addRequestHeader:@"Content-Type" value:@"text/xml"];
[request setPostValue:@"test" forKey:@"body"];
[request setCompletionBlock:^{
            NSData *data=[request responseData];

            NSString *response=[request responseString];
        }];
        [request setFailedBlock:^{
            NSLog(@"Failed");
        }];

[request startAsynchronous]; 
```

`

请帮我解决这个问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:14:42.607

您可以检查您的服务器 api 是否支持不同的响应类型。因此，您可以设置 HTTP 请求标头的“接受”参数。

[请求 addRequestHeader:@"Accept" 值:@"application/xml"];

# eclipse - 在 Java 数据库连接中没有得到输出

> ID：12362402
> 
> 赞同：0
> 
> 时间：2012-09-11T03:36:58.023
> 
> 标签：eclipse, jdbc

我正在通过 Eclipse IDE 处理 Java 数据库连接。我通过 Ubuntu Terminal 建立了一个数据库，我需要连接并使用它。但是，当我只是将“mysql-connector-java-5.0.8-bin.jar”添加到项目库中时，我没有得到项目输出，但显示了以下输出，任何人都知道这是什么以及我如何可以从我的项目中获得输出吗？

```
 <ConnectionProperties>
 <PropertyCategory name="Connection/Authentication">
  <Property name="user" required="No" default="" sortOrder="-2147483647" since="all">
    The user to connect as
  </Property>
  <Property name="password" required="No" default="" sortOrder="-2147483646" since="all">
    The password to use when connecting
  </Property>
  <Property name="socketFactory" required="No" default="com.mysql.jdbc.StandardSocketFactory" sortOrder="4" since="3.0.3">
    The name of the class that the driver should use for creating socket connections to the server. This class must implement the interface 'com.mysql.jdbc.SocketFactory' and have public no-args constructor.
  </Property>
  <Property name="connectTimeout" required="No" default="0" sortOrder="9" since="3.0.1">
    Timeout for socket connect (in milliseconds), with 0 being no timeout. Only works on JDK-1.4 or newer. Defaults to '0'.
  </Property> 
```

...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-29T06:24:30.300

运行试图通过 JDBC 作为应用程序连接到 MySQL 的 java 文件。

1）右键单击java文件

2）继续运行

3）选择java应用程序。

它为我解决了这个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-11T04:21:05.553

这是安装驱动程序的过程。您只需执行一次这些步骤。

1.  在您的 cs 主目录中创建一个名为 jdbc 的目录。

2.  将课程网站上的以下文件复制到您刚刚创建的目录中：mysql-connector-java-3.0.6-stable-bin.jar。

3.  使用 emacs 等编辑器打开主目录中的 .bashrc 文件。（请注意，名称以 . 开头的文件通常默认隐藏，因此您可能需要“显示隐藏文件”才能访问 .bashrc。）

4.  将以下两行添加到文件 .bashrc（文件中的任何位置），将“username”更改为您自己的用户名：

MYSQLDRV="mysql-connector-java-3.0.6-stable-bin.jar" export CLASSPATH="/home/username/jdbc/$MYSQLDRV:."

1.  保存.bashrc。

2.  注销并重新登录，或者，在命令提示符下键入 source .bashrc。

另一件事。您必须通知连接 mySQL 的 Eclipse 项目您想使用此驱动程序。通过右键单击有问题的项目，选择“构建路径 - 添加外部档案”，然后导航到上述驱动程序文件来执行此操作。您需要为每个这样的 Eclipse 项目执行此操作。

# java - Java 和 Python 程序的相同一致性哈希算法实现

> ID：12362417
> 
> 赞同：12
> 
> 时间：2012-09-11T03:38:49.177
> 
> 标签：java, python, consistent-hashing

我们有一个应用程序，Python 模块会将数据写入 redis 分片，而 Java 模块将从 redis 分片读取数据，因此我需要为 Java 和 Python 实现完全相同的一致哈希算法，以确保可以找到数据。

我用谷歌搜索并尝试了几种实现，但发现 Java 和 Python 的实现总是不同的，不能一起使用。需要你的帮助。

编辑，我尝试过的在线实现：
Java：[http](http://weblogs.java.net/blog/tomwhite/archive/2007/11/consistent_hash.html)
://weblogs.java.net/blog/tomwhite/archive/2007/11/consistent_hash.html Python：[http://techspot.zzzeek.org/2012/07/07 /the-absolutely-simplest-consistent-hashing-example/](http://techspot.zzzeek.org/2012/07/07/the-absolutely-simplest-consistent-hashing-example/)
[http://amix.dk/blog/post/19367](http://amix.dk/blog/post/19367)

编辑、附加 Java（使用 Google Guava lib）和我编写的 Python 代码。代码基于以上文章。

```
import java.util.Collection;
import java.util.SortedMap;
import java.util.TreeMap;
import com.google.common.hash.HashFunction;

public class ConsistentHash<T> {
    private final HashFunction hashFunction;
    private final int numberOfReplicas;
    private final SortedMap<Long, T> circle = new TreeMap<Long, T>();

    public ConsistentHash(HashFunction hashFunction, int numberOfReplicas,
            Collection<T> nodes) {
        this.hashFunction = hashFunction;
        this.numberOfReplicas = numberOfReplicas;

        for (T node : nodes) {
            add(node);
        }
    }

    public void add(T node) {
        for (int i = 0; i < numberOfReplicas; i++) {
            circle.put(hashFunction.hashString(node.toString() + i).asLong(),
                    node);
        }
    }

    public void remove(T node) {
        for (int i = 0; i < numberOfReplicas; i++) {
            circle.remove(hashFunction.hashString(node.toString() + i).asLong());
        }
    }

    public T get(Object key) {
        if (circle.isEmpty()) {
            return null;
        }
        long hash = hashFunction.hashString(key.toString()).asLong();
        if (!circle.containsKey(hash)) {
            SortedMap<Long, T> tailMap = circle.tailMap(hash);
            hash = tailMap.isEmpty() ? circle.firstKey() : tailMap.firstKey();
        }
        return circle.get(hash);
    }
} 
```

测试代码：

```
 ArrayList<String> al = new ArrayList<String>(); 
        al.add("redis1");
        al.add("redis2");
        al.add("redis3");
        al.add("redis4");

        String[] userIds = 
        {"-84942321036308",
        "-76029520310209",
        "-68343931116147",
        "-54921760962352"
        };
        HashFunction hf = Hashing.md5();

        ConsistentHash<String> consistentHash = new ConsistentHash<String>(hf, 100, al); 
        for (String userId : userIds) {
            System.out.println(consistentHash.get(userId));
        } 
```

Python代码：

```
import bisect
import md5

class ConsistentHashRing(object):
    """Implement a consistent hashing ring."""

    def __init__(self, replicas=100):
        """Create a new ConsistentHashRing.

        :param replicas: number of replicas.

        """
        self.replicas = replicas
        self._keys = []
        self._nodes = {}

    def _hash(self, key):
        """Given a string key, return a hash value."""

        return long(md5.md5(key).hexdigest(), 16)

    def _repl_iterator(self, nodename):
        """Given a node name, return an iterable of replica hashes."""

        return (self._hash("%s%s" % (nodename, i))
                for i in xrange(self.replicas))

    def __setitem__(self, nodename, node):
        """Add a node, given its name.

        The given nodename is hashed
        among the number of replicas.

        """
        for hash_ in self._repl_iterator(nodename):
            if hash_ in self._nodes:
                raise ValueError("Node name %r is "
                            "already present" % nodename)
            self._nodes[hash_] = node
            bisect.insort(self._keys, hash_)

    def __delitem__(self, nodename):
        """Remove a node, given its name."""

        for hash_ in self._repl_iterator(nodename):
            # will raise KeyError for nonexistent node name
            del self._nodes[hash_]
            index = bisect.bisect_left(self._keys, hash_)
            del self._keys[index]

    def __getitem__(self, key):
        """Return a node, given a key.

        The node replica with a hash value nearest
        but not less than that of the given
        name is returned.   If the hash of the
        given name is greater than the greatest
        hash, returns the lowest hashed node.

        """
        hash_ = self._hash(key)
        start = bisect.bisect(self._keys, hash_)
        if start == len(self._keys):
            start = 0
        return self._nodes[self._keys[start]] 
```

测试代码：

```
import ConsistentHashRing

if __name__ == '__main__':
    server_infos = ["redis1", "redis2", "redis3", "redis4"];
    hash_ring = ConsistentHashRing()
    test_keys = ["-84942321036308",
        "-76029520310209",
        "-68343931116147",
        "-54921760962352",
        "-53401599829545"
        ];

    for server in server_infos:
        hash_ring[server] = server

    for key in test_keys:
        print str(hash_ring[key]) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-11T08:02:41.190

您似乎同时遇到了两个问题：编码问题和表示问题。

编码问题的出现尤其是因为您似乎使用的是 Python 2 - Python 2 的`str`类型根本不像 Java 的`String`类型，实际上更像是`byte`. 但是 Java`String.getBytes()`不能保证给你一个与 Python 内容相同的字节数组`str`（它们*可能*使用兼容的编码，但不能保证 - 即使这个修复不会改变事情，一般来说这是一个好主意避免将来出现问题）。

因此，解决此问题的方法是使用行为类似于 Java 的 Python 类型，`String`并将相应的对象从两种语言转换为指定相同编码的字节。从 Python 方面来看，这意味着您要使用该`unicode`类型，如果您使用的是 Python 3，这是默认的字符串文字类型，或者将其放在 .py 文件的顶部附近：

```
from __future__ import unicode_literals 
```

如果这些都不是一个选项，请以这种方式指定您的字符串文字：

```
u'text' 
```

前面`u`的 强制它为 unicode。然后可以使用它的`encode`方法将其转换为字节，该方法采用（不出所料）编码：

```
u'text'.encode('utf-8') 
```

从 Java 方面来看，有一个重载版本`String.getBytes`需要一个编码 - 但它将它作为一个[`java.nio.Charset`](http://docs.oracle.com/javase/6/docs/api/java/nio/charset/Charset.html)而不是一个字符串 - 所以，你会想要这样做：

```
"text".getBytes(java.nio.charset.Charset.forName("UTF-8")) 
```

这些将为您提供两种语言中等效的字节序列，以便哈希具有相同的输入并为您提供相同的答案。

您可能遇到的另一个问题是表示，这取决于您使用的散列函数。Python [`hashlib`](http://docs.python.org/library/hashlib.html#module-hashlib)（这是自 Python 2.5 以来 md5 和其他加密哈希的首选实现）在这方面与 Java 完全兼容[`MessageDigest`](http://docs.oracle.com/javase/1.4.2/docs/api/java/security/MessageDigest.html)——它们都给出字节，所以它们的输出应该是等价的。

另一方面，Python[`zlib.crc32`](http://docs.python.org/library/zlib.html#zlib.crc32)和 Java都给出数字结果 - 但 Java 始终是一个无符号的 64 位数字，而 Python（在 Python 2 中）是一个有符号的 32 位数字（在 Python 3 中，它现在是一个无符号的 32 位数字[`java.util.zip.CRC32`](http://docs.oracle.com/javase/7/docs/api/java/util/zip/CRC32.html)，所以这个问题就消失了）。要将有符号结果转换为无符号结果，请执行：`result & 0xffffffff`，结果应该与 Java 相当。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T03:51:38.570

根据[哈希函数的分析](http://www.strchr.com/hash_functions)：

> Murmur2、Meiyan、SBox 和 CRC32 为各种键提供了良好的性能。它们可以被推荐为 x86 上的通用散列函数。
> 
> 硬件加速 CRC（在表中标记为 iSCSI CRC）是最近的 Core i5/i7 处理器上最快的哈希函数。但是，AMD 和更早的 Intel 处理器不支持 CRC32 指令。

Python 有[zlib.crc32](http://docs.python.org/library/zlib.html#zlib.crc32)，Java 有[CRC32 类](http://docs.oracle.com/javase/7/docs/api/java/util/zip/CRC32.html)。由于它是一种标准算法，因此您应该在两种语言中获得相同的结果。

MurmurHash 3[在 Google Guava](http://docs.guava-libraries.googlecode.com/git-history/v11.0/javadoc/com/google/common/hash/Hashing.html)（一个非常有用的 Java 库）和 Python 的[pyfasthash](http://code.google.com/p/pyfasthash/)中可用。

请注意，这些不是[加密哈希函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)，因此它们速度很快，但不能提供相同的保证。如果这些散列对安全很重要，请使用加密散列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T03:51:13.907

散列算法的不同语言实现不会使散列值不同。在 java 或 python 中生成的`SHA-1`散列将是相同的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-11T03:53:14.027

我不熟悉 Redis，但 Python 示例似乎是散列键，所以我假设我们正在谈论某种 HashMap 实现。

您的 python 示例似乎正在使用 MD5 哈希，这在 Java 和 Python 中都是相同的。

以下是 Java 中的 MD5 散列示例：

[http://www.dzone.com/snippets/get-md5-hash-few-lines-java](http://www.dzone.com/snippets/get-md5-hash-few-lines-java)

在 Python 中：

[http://docs.python.org/library/md5.html](http://docs.python.org/library/md5.html)

现在，您可能想找到一种更快的散列算法。MD5 专注于加密安全，在这种情况下并不真正需要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-11T14:30:31.607

这是一个简单的散列函数，它在 python 和 java 上为您的键生成相同的结果：

## Python

```
def hash(key):
        h = 0
        for c in key:
                h = ((h*37) + ord(c)) & 0xFFFFFFFF
        return h; 
```

## 爪哇

```
public static int hash(String key) {
    int h = 0;
    for (char c : key.toCharArray())
        h = (h * 37 + c) & 0xFFFFFFFF;
    return h;
} 
```

为此，您不需要加密安全哈希。这只是矫枉过正。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-11T08:58:56.110

让我们直截了当地说：在不同的环境/实现（Python，Java，...）中，相同的哈希函数（SHA-1，MD5，...）的相同**二进制**输入将产生相同的**二进制**输出。那是因为这些哈希函数是按照[标准](http://www.itl.nist.gov/fipspubs/fip180-1.htm)实现的。

因此，您将在回答这些问题时发现您遇到的问题的根源：

*   您是否为两个哈希函数提供相同的二进制输入（例如 Python 和 Java 中的 MD5）？

*   您是否等效地解释了两个哈希函数（例如 Python 和 Java 中的 MD5）的二进制输出？

@lvc 的回答提供了有关这些问题的更多详细信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-25T17:24:29.577

对于 java 版本，我建议使用 MD5 生成 128 位字符串结果，然后可以将其转换为 BigInteger（Integer 和 Long 不足以容纳 128 位数据）。

示例代码在这里：

```
private static class HashFunc {

    static MessageDigest md5;

    static {
        try {
            md5 = MessageDigest.getInstance("MD5");
        } catch (NoSuchAlgorithmException e) {
            //
        }
    }

    public synchronized int hash(String s) {
        md5.update(StandardCharsets.UTF_8.encode(s));
        return new BigInteger(1, md5.digest()).intValue();
    }
} 
```

注意：

> The java.math.BigInteger.intValue() converts this BigInteger to an int. This conversion is analogous to a narrowing primitive conversion from long to int. If this **BigInteger is too big to fit in an int**, only the low-order 32 bits are returned. This conversion can lose information about the overall magnitude of the BigInteger value as well as return a result with the opposite sign.

# c# - 选择后删除下拉列表中的元素

> ID：12362421
> 
> 赞同：0
> 
> 时间：2012-09-11T03:39:24.887
> 
> 标签：c#, asp.net, drop-down-menu

我的数据库中有一个存储汽车的表。然后在我的系统中，数据库中有一个汽车的下拉列表（下拉列表中的元素：Car A,Car B,Car C）。假设如果用户 A 选择 Car B，则其他用户在登录时将无法再选择 Car B。我的问题是，如何使汽车不再可供选择？有什么页面可以参考吗？选择后如何删除下拉列表中的元素？如果您不明白我的意思，请随时问我。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T03:46:40.537

我认为在数据库中您可以维护包含布尔值的 Isselected 字段。如果用户选择值为 true 的汽车更新数据库。加载下拉菜单时选择 Isselected =false 的汽车

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:53:01.720

我要做的是使用 ajax 来控制可用汽车的列表。当用户选择汽车时，可以“推送”信息。

流程将是这样的：

1.  用户 A 选择“Nissan Altima”
2.  通过 Ajax 将信息发送到服务器
3.  服务器存储用户A和“Nissan Altima”之间的关联
4.  服务器将信息“推送”给用户 B
5.  用户 B 的屏幕更新，列表更新

您可以使用 Comet 完成从一个用户到另一个用户的 ajax“推送”。

*   [彗星](http://en.wikipedia.org/wiki/Comet_%28programming%29)
*   [反向阿贾克斯](http://www.ibm.com/developerworks/web/library/wa-reverseajax1/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:36:11.433

我建议您创建另一个**临时表**，您可以在其中保存或`CarID`当用户从下拉列表中选择汽车时（您可以在选择项目时触发事件） `CarCode``sessionID`

在此事件中，将 carID 和 SessionID 保存在临时表中

表结构

```
 CarTempTable
    CarID xxx
    SessionID varchar(x)
    Date   datetime 
```

一旦您在此表中有 CarID 和 SessionID，您就可以通过如下查询查询其他用户的主表

```
SELECT CarID, CarName FROM Cars WHERE CarID NOT IN (SELECT CarID FROM CarTempTable WHERE SessionID <> "'+ SessionIDofUSER+'"; 
```

在上述方法中，您必须确保在会话结束时清除特定会话的临时表条目。

这种方法应该适合你

编辑：如果是汽车租赁，那么最好在您的表中添加一个额外的列，根据用户是否预订汽车来说明汽车是否可用。您可以将其与上述临时表一起使用，因为我不确定您是如何通过付款或其他方式进行预订的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T04:02:41.383

您的数据库表*应该*有一个名为 IsReserved（或类似名称）的字段，然后您的下拉列表将填充查询：

```
SELECT * FROM Car Where IsReserved=0 
```

# relational-database - RMDB 表中的“列”是否有顺序？

> ID：12362422
> 
> 赞同：5
> 
> 时间：2012-09-11T03:39:28.050
> 
> 标签：relational-database, relational-algebra

我了解到，就表中的元组（例如行）而言，没有顺序的概念，但根据[维基百科](https://en.wikipedia.org/wiki/Tuple)， “元组是元素的有序列表”。这是否意味着属性确实有顺序？如果是，为什么它们会被区别对待，不能向表中添加另一列（这就是元组没有顺序的原因）？

“在这种表示法中，属性-值对可以按任何顺序出现。” 这是否意味着属性没有顺序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T13:45:34.217

可以这么说，有 2 种元组。有“纯数学”，确实有元组通常被定义为“值的有序列表”。因此，在数学理论中，谈论“元组中的第一个值”等是有意义的。这可能是您的维基百科文章所指的意义或上下文。

Haskell 语言支持这种元组，例如，它也有一个 fst() 运算符来从这种元组中提取“第一个”值。

然而，Codd 意识到，当将元组作为有序列表的这种数学概念应用于数据管理领域时，这将是极其不切实际的。在数据管理中，他希望通过属性名称而不是按序号位置对值进行寻址。确实，想象一下如果从表中删除“五个属性中的第二个”会产生毁灭性的后果，现在所有处理同一个表的“第三个”和“第四个”属性的程序现在都必须被发明和调整。

所以在关系模型中，元组是命名值的集合，因此，在数据关系模型中发挥作用的元组中，确实没有任何值排序的概念。

然后正如其他响应中所指出的那样，存在 SQL 及其与关系理论的亵渎神明的偏差。在 SQL 中，元组和标题中属性的排序是非常有意义的，其后果无处不在。在 FK 声明中，各个引用属性和被引用属性的对应关系是按序号位置，而不是按名称。其他情况是使用 UNION 和 EXCEPT。取一个表 T，列 X 和 Y 的类型相同。

从 T 中选择 X、Y 并从 T 中选择 Y、X

本身不是无效的，但标准规定结果中的列名是系统定义的（！）。“做明智的事情”并偏离这一点的实现，分别生成一个包含名为 X 和 Y 的列的表，然后面对他们的用户，结果是前一个表达式与

从 T 中选择 Y，X 从 T 中选择 X，Y

（因为列排序 X,Y 是 Y,X 之外的另一个排序，因此标题不相等，因此表不相等。）

从 T 中选择 X,Y 除了从 T 中选择 Y,X

给出的结果会让许多 SQL 新手摸不着头脑。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T12:45:22.513

通常理解和使用的关系数据库模型的操作当然不依赖于关系中属性的顺序。关系变量的属性总是可以通过名称而不是位置来识别。然而，关系数据库理论中使用的*符号*并不总是指定属性名称（或属性类型），有时确实暗示了有序的属性。这主要是书面符号的问题，而不是关系模型的结构或行为。以下参考资料中对这些不同的“命名”和“有序”视角进行了更多讨论。 [http://webdam.inria.fr/Alice/pdfs/Chapter-3.pdf](http://webdam.inria.fr/Alice/pdfs/Chapter-3.pdf)

EFCodd 最早关于关系模型的论文实际上提出了一个同时支持有序和无序关系版本的关系系统。从那以后，这个想法似乎已经被遗忘或忽视了，即使是科德本人。它不构成现代关系数据库理论的一部分。

不幸的是，SQL 确实有列顺序的概念。它是 SQL 语法和语义的重要组成部分，并且是每个 SQL DBMS 都支持以符合 ISO SQL 标准的东西。SQL 不是关系型的，这只是它与关系型模型不同的方式之一。SQL 模型和关系模型之间的尴尬差异给同样使用 SQL 的关系模型的学生带来了一定的困惑。

# php - 达到计数后 PHP 查询停止

> ID：12362425
> 
> 赞同：1
> 
> 时间：2012-09-11T03:39:45.183
> 
> 标签：php, count

我似乎无法从 php 手册中弄清楚这一点。以下代码给了我返回的第二篇文章。我想做的是得到2个帖子然后停止。

```
$count=0;
    $related = p2p_type($connected_type)->get_related( get_queried_object_id() );

            // Display related posts
            if ( $related->have_posts() ) :
            $count++;
            while ( $related->have_posts() ) : $related->the_post();            
        if ($count == 2) {

        echo the_title();   

        } else {

        echo 'this post won't show up'; 
        }

    endwhile; 

                // Prevent weirdness
            wp_reset_postdata();

            endif; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T03:44:43.943

您可以使用 `if($count >2) break;` 或`break;`在`else`

break 结束当前 while 的执行。

有关更多信息，请查看此链接[php 手动中断](http://php.net/manual/en/control-structures.break.php)

# php - strip_tags 不允许某些标签

> ID：12362426
> 
> 赞同：6
> 
> 时间：2012-09-11T03:39:53.680
> 
> 标签：php, html, strip-tags

根据[`strip_tags`](http://php.net/manual/en/function.strip-tags.php)文档，第二个参数采用允许的标签。但是在我的情况下，我想做相反的事情。假设我将接受`script_tags`通常（默认）接受的标签，但只`<script>`去除标签。有什么可能的方法吗？

*我并不是说有人为我编写代码，而是非常感谢您提供有关如何实现此目标的可能方法（如果可能）。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T06:39:27.723

**编辑**

要使用 HTML Purifier`HTML.ForbiddenElements`配置指令，您似乎会执行以下操作：

```
require_once '/path/to/HTMLPurifier.auto.php';

$config = HTMLPurifier_Config::createDefault();
$config->set('HTML.ForbiddenElements', array('script','style','applet'));
$purifier = new HTMLPurifier($config);
$clean_html = $purifier->purify($dirty_html); 
```

[http://htmlpurifier.org/docs](http://htmlpurifier.org/docs)

`HTML.ForbiddenElements` [应设置为`array`](http://htmlpurifier.org/live/configdoc/plain.html#HTML.ForbiddenElements). 我不知道`array`成员应该采取什么形式：

```
array('script','style','applet') 
```

或者：

```
array('<script>','<style>','<applet>') 
```

或者是其他东西？

我*认为*这是第一种形式，没有分隔符；[使用一种与TinyMCE](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)[语法](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)[`HTML.AllowedElements`](http://htmlpurifier.org/live/configdoc/plain.html#HTML.AllowedElements)有些共同的配置字符串形式：[`valid elements`](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)

```
tinyMCE.init({
    ...
    valid_elements : "a[href|target=_blank],strong/b,div[align],br",
    ...
}); 
```

所以我的猜测是它只是一个术语，不应该提供任何属性（因为你正在*禁止*元素......虽然也有一个[`HTML.ForbiddenAttributes`](http://htmlpurifier.org/live/configdoc/plain.html#HTML.ForbiddenAttributes)）。但这是一个猜测。

我还将从`HTML.ForbiddenAttributes`文档中添加此注释：

> **警告：**该指令是对 的补充`%HTML.ForbiddenElements`，因此，请查看该指令以讨论为什么在使用该指令之前应该三思而后行。

黑名单并不像白名单那样“强大”，但你可能有你的理由。请注意并小心。

没有测试，我不知道该告诉你什么。我会继续寻找答案，但我可能会先上床睡觉。很晚了。`:)`

* * *

尽管我认为您确实应该使用[HTML Purifier](http://htmlpurifier.org/)并利用它的[`HTML.ForbiddenElements`](http://htmlpurifier.org/live/configdoc/plain.html#HTML.ForbiddenElements)配置指令，但如果您真的非常想使用，我认为一个合理的选择`strip_tags()`是从黑名单中派生白名单。换句话说，删除你不想要的，然后使用剩下的。

例如：

```
function blacklistElements($blacklisted = '', &$errors = array()) {
    if ((string)$blacklisted == '') {
        $errors[] = 'Empty string.';
        return array();
    }

    $html5 = array(
        "<menu>","<command>","<summary>","<details>","<meter>","<progress>",
        "<output>","<keygen>","<textarea>","<option>","<optgroup>","<datalist>",
        "<select>","<button>","<input>","<label>","<legend>","<fieldset>","<form>",
        "<th>","<td>","<tr>","<tfoot>","<thead>","<tbody>","<col>","<colgroup>",
        "<caption>","<table>","<math>","<svg>","<area>","<map>","<canvas>","<track>",
        "<source>","<audio>","<video>","<param>","<object>","<embed>","<iframe>",
        "<img>","<del>","<ins>","<wbr>","<br>","<span>","<bdo>","<bdi>","<rp>","<rt>",
        "<ruby>","<mark>","<u>","<b>","<i>","<sup>","<sub>","<kbd>","<samp>","<var>",
        "<code>","<time>","<data>","<abbr>","<dfn>","<q>","<cite>","<s>","<small>",
        "<strong>","<em>","<a>","<div>","<figcaption>","<figure>","<dd>","<dt>",
        "<dl>","<li>","<ul>","<ol>","<blockquote>","<pre>","<hr>","<p>","<address>",
        "<footer>","<header>","<hgroup>","<aside>","<article>","<nav>","<section>",
        "<body>","<noscript>","<script>","<style>","<meta>","<link>","<base>",
        "<title>","<head>","<html>"
    );

    $list = trim(strtolower($blacklisted));
    $list = preg_replace('/[^a-z ]/i', '', $list);
    $list = '<' . str_replace(' ', '> <', $list) . '>';
    $list = array_map('trim', explode(' ', $list));

    return array_diff($html5, $list);
} 
```

然后运行它：

```
$blacklisted = '<html> <bogus> <EM> em li ol';
$whitelist = blacklistElements($blacklisted);

if (count($errors)) {
    echo "There were errors.\n";
    print_r($errors);
    echo "\n";
} else {
    // Do strip_tags() ...
} 
```

[http://codepad.org/LV8ckRjd](http://codepad.org/LV8ckRjd)

因此，如果您传入您不想允许的内容，它会以一种`array`形式返回 HTML5 元素列表，然后您可以`strip_tags()`在将其加入字符串后将其输入：

```
$stripped = strip_tags($html, implode('', $whitelist))); 
```

***买者自负***

现在，我已经很好地解决了这个问题，我知道有些问题我还没有想到。例如，从参数的[`strip_tags()`手册页](http://us3.php.net/manual/en/function.strip-tags.php)中`$allowable_tags`：

> **笔记：**
> 
> 此参数不应包含空格。将标记视为与第一个空格或.`strip_tags()`之间的不区分大小写的字符串。这意味着返回一个空字符串。`<``>``strip_tags("<br/>", "<br>")`

已经很晚了，由于某种原因，我不太明白这对这种方法意味着什么。所以我明天必须考虑一下。`$html5`我还从这个[MDN 文档页面](https://developer.mozilla.org/en-US/docs/HTML/HTML5/HTML5_element_list)编译了函数元素中的 HTML 元素列表。眼尖的读者可能会注意到所有标签都是这种形式：

```
<tagName> 
```

我不确定这将如何影响结果，我是否需要考虑使用短标签的变化以及一些，咳咳，[更奇怪的`<tagName/>`](http://www.w3.org/QA/2007/10/shorttags.html)*变化*。当然，还有[更多的标签](https://developer.mozilla.org/en-US/docs/HTML/Element)。

所以它可能还没有准备好生产。但你明白了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T04:12:18.360

首先，看看其他人对这个话题的看法：

[用 PHP 去除 <script> 标签和介于两者之间的所有内容？](https://stackoverflow.com/questions/2698079/strip-script-tags-and-everything-in-between-with-php)

和

[从 HTML 内容中删除脚本标签](https://stackoverflow.com/questions/7130867/remove-script-tag-from-html-content)

看来您有 2 个选择，一个是正则表达式解决方案，上面的两个链接都给出了它们。二是使用[HTML Purifier](http://htmlpurifier.org/)。

如果您出于其他原因而不是清理用户内容而剥离脚本标签，那么正则表达式可能是一个很好的解决方案。但是，正如每个人都警告过的那样，如果您正在清理输入，那么使用 HTML Purifier 是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-12T15:51:59.317

PHP（5或更高）解决方案：

如果要删除`<script>`标签（或任何其他标签），并且**还想删除标签内的内容**，则应使用：

选项 1（最简单）：

```
preg_replace('#<script(.*?)>(.*?)</script>#is', '', $text); 
```

选项 2（更通用）：

```
<?php

$html = "<p>Your HTML code</p><script>With malicious code</script>"

$dom = new DOMDocument();

$dom->loadHTML($html);

$script = $dom->getElementsByTagName('script');

$remove = [];
foreach($script as $item)
{
  $item->parentNode->removeChild($item);
}

$html = $dom->saveHTML(); 
```

然后`$html`将是：

```
"<p>Your HTML code</p>" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-15T10:35:08.300

这就是我用来删除禁止标签列表的方法，既可以删除包含内容的标签，也可以删除包含内容的标签，另外还可以修剪剩余的空白。

```
$description = trim(preg_replace([
    # Strip tags around content
    '/\<(.*)doctype(.*)\>/i',
    '/\<(.*)html(.*)\>/i',
    '/\<(.*)head(.*)\>/i',
    '/\<(.*)body(.*)\>/i',
    # Strip tags and content inside
    '/\<(.*)script(.*)\>(.*)<\/script>/i',
], '', $description)); 
```

输入示例：

```
$description = '<html>
<head>
</head>
<body>
    <p>This distinctive Mini Chopper with Desire styling has a powerful wattage and high capacity which makes it a very versatile kitchen accessory. It also comes equipped with a durable glass bowl and lid for easy storage.</p>
    <script type="application/javascript">alert('Hello world');</script>
</body>
</html>'; 
```

输出结果：

```
<p>This distinctive Mini Chopper with Desire styling has a powerful wattage and high capacity which makes it a very versatile kitchen accessory. It also comes equipped with a durable glass bowl and lid for easy storage.</p> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-27T15:53:59.100

我使用以下内容：

```
function strip_tags_with_forbidden_tags($input, $forbidden_tags)
{
    foreach (explode(',', $forbidden_tags) as $tag) {
        $tag = preg_replace(array('/^</', '/>$/'), array('', ''), $tag);
        $input = preg_replace(sprintf('/<%s[^>]*>([^<]+)<\/%s>/', $tag, $tag), '$1', $input);
    }

    return $input;
} 
```

然后你可以这样做：

```
echo strip_tags_with_forbidden_tags('<cancel>abc</cancel>xpto<p>def></p><g>xyz</g><t>xpto</t>', 'cancel,g'); 
```

输出：`'abcxpto<p>def></p>xyz<t>xpto</t>'`

```
echo strip_tags_with_forbidden_tags('<cancel>abc</cancel> xpto <p>def></p> <g>xyz</g> <t>xpto</t>', 'cancel,g'); 
```

输出：`'abc xpto <p>def></p> xyz <t>xpto</t>'`

# sql - xAxis highcharts 的 created_at 日期

> ID：12362435
> 
> 赞同：0
> 
> 时间：2012-09-11T03:41:03.030
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3.2, highcharts, lazy-high-charts

下面是我现在拥有的代码。这为我提供了一个完美的所需数据的二维数组（数组数组），因为据我所知，这是使用 Highstock 完成我正在寻找的最佳方法。

我认为我要做的最后一步是将其转换为 highstock 的正确格式：Date.UTC(2012, 9, 12)

我希望它看起来像这样：http: [//jsfiddle.net/DkgVr/4/](http://jsfiddle.net/DkgVr/4/)

知道我怎样才能让日期变成这样吗？

数组现在看起来像这样：[[Thu, 13 Sep 2012, 215.0], [Wed, 12 Sep 2012, 211.0]]

用户控制器

```
@weight_items = Weight.order("date DESC").select('weights.content,  weights.date').all 
```

高库存

```
<script type="text/javascript">
$(function () {
var chart;
$(document).ready(function() {
    window.chart = new Highcharts.StockChart({
        chart: {
            renderTo: 'weight_chart',
            type: 'line',
            marginRight: 20,
            marginBottom: 25
        },
        title: {
            text: 'Your Weight Over Time',
            x: -20 //center
        },
        yAxis: {
            title: {
                text: 'Weight'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },

        legend: {
            layout: 'vertical',
            align: 'center',
            verticalAlign: 'bottom',
            x: -10,
            y: 100,
            borderWidth: 0
        },

        scrollbar: {
          enabled: true
        },

        rangeSelector : {
            selected : 1
        },

        credits: {
            enabled: false
        },

        series: [{
            tickInterval: <%= 1.day * 1000 %>,
            pointStart: <%= 3.weeks.ago.at_midnight.to_i * 1000 %>,
            name: 'Weight',
            data: <%= weight_and_date_array = @weight_items.map{|row| [row.date.to_date, row.content.to_f] } %>

        }]
    }, 

    function(chart){

        // apply the date pickers
        setTimeout(function(){
            $('input.highcharts-range-selector', $('#'+chart.options.chart.renderTo))
                .datepicker()
        },0)

      });
  });

});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T03:44:26.270

你不需要

```
xAxis: {
            type: 'datetime'
       } 
```

对于 HighStock。还

```
{
    pointInterval: <%= 1.day * 1000 %>,
    pointStart: <%= 3.weeks.ago.at_midnight.to_i * 1000 %>,
    name: 'Weight',
    data: <%= Weight.pluck(:content).reverse %>
} 
```

Highstock 不需要。保持`name`和`data`唯一。

可以使用`tickInterval`X 轴选项指定间隔。

编辑：编辑后，您似乎在以`HighStock`兼容格式添加日期时遇到问题。

因此，在 UTC 中添加日期。使用 Ruby 将日期转换为 UTC，`HighStock`库将自动选择它。

# c++ - 为什么类在 C++ 中称为类？

> ID：12362436
> 
> 赞同：3
> 
> 时间：2012-09-11T03:41:02.907
> 
> 标签：c++

> **可能的重复：**
> [为什么 Java 中的类是“类”？](https://stackoverflow.com/questions/2118495/why-class-for-class-in-java)

我正在考虑 Haskell 中的类型类，它允许您根据可以对它们执行的操作将类型分成不同的组。但是为什么类在 C++ 中被称为类呢？他们最初的目的是分类什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-11T03:46:06.313

因为它们在 Simula 中被称为“类”。消息来源表明，Simula 受到Algol 中“记录类”（即具有相关类型信息的结构化数据）提案的[影响。](http://dl.acm.org/citation.cfm?id=1061041)大多数其他语言（直接或间接）从 Simula 派生其 OO 术语。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T03:44:12.560

对现实世界的实体（对象）进行分类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-11T03:41:57.360

C++ 中的类旨在对*对象*进行分类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-11T03:42:18.843

他们对物体进行分类，因此得名:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-11T03:57:07.923

实际上，不常见的用途是haskell中的一种。在大多数 OO 语言中，*类*用于指代定义一类对象行为的类型。例如，`Car`是一类有很多实例的对象，我的车，你的车，别人的车。在 Haskell 中，该术语在元语言级别用于指代类型的类，而不是对象的类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-11T04:00:15.470

在面向对象编程中，您拥有具有状态并支持某些操作的对象。对于一些不同的对象（例如，在金融程序中表示银行账户的对象，与在赛车模拟器中表示汽车的对象），状态和内容是完全不同的。所以我们不能以同样的方式对待所有的对象。

一个*类*代表一堆工作相似的对象。如果你知道一个对象属于某个类，那么你就知道可以用它做一些事情。代表银行帐户的对象可能支持诸如`deposit`, `withdraw`, `getBalance`,之类的操作`getAccountHolder`。

谈论“支持`deposit`, `withdraw`, `getBalance`, 和`getAccountHolder`操作的对象类”或“支持`accelerate`, `getSpeed`, 和`steer`方法的对象类”只是“类”这个词的正常使用（并且与“分类”有关, 基本上只是“投入课堂”的意思；“课堂”这个词在一群学生中是完全不同的）。

显然，您很快就想*命名*特定的类，这样您就可以说`BankAccount`or `RacingCar`，而不是“支持...的对象类”。

所以一堂课就是这样；一个“事物”，它定义了作为类实例的对象的共同点。

# ruby-on-rails - 不知道出了什么问题。大量字符串嵌入红宝石和数学

> ID：12362437
> 
> 赞同：0
> 
> 时间：2012-09-11T03:41:06.353
> 
> 标签：ruby-on-rails

```
<%= link_to "Next week", "/?week_forward= %>
<% if week_number % 52 == 0 %> 
    2 
<% else %> 
    1
<% end %>
<%= + #{(params[:week_forward].to_i || 0)}" %> 
```

我试图在我的 html.erb 中得到这个。我真的不确定出了什么问题，我的引号错了吗？

这是错误

```
bad URI `/?week_forward=%20);@output_buffer.safe_concat('');%20if%20week_number%20%%2052%20==%200%20%20@output_buffer.safe_concat(''2'');%20else%20%20@output_buffer.safe_concat(''1'');%20end%20@output_buffer.append=%20(%20+%200'. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:02:37.750

跳出来的明显错误是后面缺少的双引号：`"/?week_forward=`

此外，您绝对应该`helpers`在 Rails 中查找，并将大部分代码移出视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:03:19.717

你没有`link_to`正确使用；周数`1`或`2`需要成为第二个参数的一部分，而不是在调用`link_to`.

```
<%= link_to "Next week", "/?week_forward=%d" % (week_number % 52 == 0) ? 2 : 1 %> 
```

您`link_to`将创建以下内容*（一旦您在 之后修复关闭引号`"/?week_forward=`）*

```
<a href="/?week_forward=">Next Week</a>1 
```

当你似乎想要类似的东西时

```
<a href="/?week_forward=1">Next Week</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:29:47.490

使用以下看起来非常漂亮的

```
<% forward = params[:week_forward].to_i || 0 
   week_forward = week_number % 52 == 0 ? 2 : 1
%>
<%= link_to "Next week", "/?week_forward=#{week_forward+forward}" %> 
```

# jquery - jQuery 查找哪个孩子处于活动状态并更新其他部分

> ID：12362447
> 
> 赞同：1
> 
> 时间：2012-09-11T03:42:15.363
> 
> 标签：jquery, nav

多个导航部分都具有相同的链接。活动部分通过活动类 ( `.active`) 显示在第一个导航中。我想在随后的导航部分中突出显示相同的链接。

最初，我使用了一种克隆方法（感谢您的好人，[jQuery replaceWith() 每个元素都带有第一个](https://stackoverflow.com/questions/12362175/jquery-replacewith-each-element-with-the-first)），虽然它工作得很好，但它干扰了一些其他功能（因为它从页面中删除了原始元素并替换它们）。

**所以，我需要想出另一种聪明的方法来检查第一部分的活动类，在后续部分中找到匹配的链接，然后应用该类。**

我在想这样的事情......但是一些高效且不那么丑陋的事情。下面的答案*确实*有效。

HTML：

```
<nav class="postNav">
    <ul>
        <li class="active"><a href="#pageHeader">link to header</a></li>
        <li><a href="#one">link to other posts</a></li>
        <li><a href="#two">link to other posts</a></li>
        <li><a href="#three">link to other posts</a></li>
        <li><a href="#four">link to other posts</a></li>
        <li><a href="#five">link to other posts</a></li>
    </ul>
</nav> 
```

JavaScript：

```
var navs   = $('.postNav'),
    first  = navs.first(),
    active = first.find('.active a').attr('href'),
    anchrs = navs.not(first);

anchrs.find('li').removeClass('active');
anchrs.find('a[href=' + active + ']').parent().addClass('active'); 
```

更新

* * *

也许通过查看索引中的哪个孩子处于活动状态？那我就不需要按锚过滤了...

更新+最终答案

* * *

我的选择器缓存了 jfriend 的答案：

```
var nav   = $('.postNav'),
first = nav.filter(':eq(0)'),
notF  = nav.filter(':gt(0)'),
index = first.find('.active').index();

notF.each(function(){
    $(this).find('li').removeClass('active').eq(index).addClass('active');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:59:10.257

您可以使用 an`li`在其`ul`和 jQuery 中的索引位置来执行此操作，`.index()`并`.eq()`使其更容易：

```
var index = $(".postNav .active").index();
$(".postNav ul").each(function() {
    $(this).children("li").removeClass("highlight").eq(index)
        .not(".active").addClass("highlight");
}); 
```

工作演示：http: [//jsfiddle.net/jfriend00/dWaCn/](http://jsfiddle.net/jfriend00/dWaCn/)

这工作如下：

*   查找活动元素并获取其相对于其兄弟元素的索引
*   查找所有 postNav ul 标签
*   找出每一个中的所有 li 孩子
*   删除任何以前的“突出显示”类
*   获取匹配的索引兄弟
*   删除活动的，这样我们就不会改变它
*   添加高亮类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:25:38.857

为什么不给每个 li 元素添加一个类：

```
<nav class="postNav">
  <ul>
    <li class="header active"><a href="#pageHeader">link to header</a></li>
    <li class="one"><a href="#one">link to other posts</a></li>
    <li class="two"><a href="#two">link to other posts</a></li>
    <li class="three"><a href="#three">link to other posts</a></li>
    <li class="four"><a href="#four">link to other posts</a></li>
    <li class="five"><a href="#five">link to other posts</a></li>
  </ul>
</nav> 
```

然后在你的 JavaScript 中：

```
$(function() {
    $('li').on('click', function() {
        $('.active').removeClass('active');
        $('.'+$(this).attr('class')).addClass('active');
    });
}); 
```

这个[jsFiddle](http://jsfiddle.net/4BaL8/)似乎满足您的要求。我看到的问题是，如果您有多个类分配给这些 li 元素（'active' 除外），这会导致依赖 $(this).attr('class'); 的问题；

# python-3.x - OSX Mountain Lion 上的 Python 3 的 Pygame？

> ID：12362449
> 
> 赞同：2
> 
> 时间：2012-09-11T03:42:22.960
> 
> 标签：python-3.x, pygame, osx-mountain-lion

我一直试图让这个工作好几天，没有运气。我能找到的所有安装演练要么是在山狮上用 python 2.x 讨论 pygame，要么是在 osx 10.6 上用 python 3 讨论 pygame，但从来没有把这三个放在一起。

对不起，如果这很长，但这是我迄今为止尝试过的......

首先，我尝试使用自制软件和 pip，如下所示：http: [//florian-berger.de/en/articles/installing-pygame-for-python-3-on-os-x](http://florian-berger.de/en/articles/installing-pygame-for-python-3-on-os-x)

但我得到了这里提到的相同错误： [在 Mountain Lion 上安装 Pygame 时出错](https://stackoverflow.com/questions/11954497/error-when-installing-pygame-on-mountain-lion)

因此，在对该问题的答案中进行了建议的修改后，我尝试按照 pygame.org 对山狮的说明从源代码编译 pygame：http://www.pygame.org/wiki/MacCompile [（](http://www.pygame.org/wiki/MacCompile) 但是，这些说明需要NumPy，我无法得到它，因为据我所知它不存在于 python 3)

但是尝试像这样编译它，我能得到的最远的结果是：

```
In file included from src/imageext.c:51:
/Library/Frameworks/SDL_image.framework/Versions/Current/Headers/SDL_image.h:27:21: error: /Library/Frameworks/SDL.framework/Versions/Current/Headers/SDL/SDL.h: Too many levels of symbolic links
/Library/Frameworks/SDL_image.framework/Versions/Current/Headers/SDL_image.h:28:29: error: /Library/Frameworks/SDL.framework/Versions/Current/Headers/SDL/SDL_version.h: Too many levels of symbolic links
/Library/Frameworks/SDL_image.framework/Versions/Current/Headers/SDL_image.h:29:28: error: /Library/Frameworks/SDL.framework/Versions/Current/Headers/SDL/begin_code.h: Too many levels of symbolic links
/Library/Frameworks/SDL_image.framework/Versions/Current/Headers/SDL_image.h:136:28: error: /Library/Frameworks/SDL.framework/Versions/Current/Headers/SDL/close_code.h: Too many levels of symbolic links
src/imageext.c: In function ‘PyInit_imageext’:
src/imageext.c:675: warning: implicit declaration of function ‘PyCObject_Check’
src/imageext.c:675: warning: implicit declaration of function ‘PyCObject_AsVoidPtr’
error: command '/usr/bin/gcc' failed with exit status 1 
```

我是新手，我不知道下一步该尝试什么。（是的，我用谷歌搜索过。我所能确定的是我有某种符号链接循环，但我不完全知道是什么/在哪里以及如何修复它。）

如果有一些非常简单的解决方法可以让你们中的一个聪明人向我指出……那就太好了（即使它让我觉得自己像个白痴！）！

做不到这一点，替代策略？我只想在山狮上使用 pygame 和 python 3 ......如果有人这样做，我很想听听如何！

PS我显然是新来的，只是学习编码......请向我解释一下，就好像我是一个5岁的孩子一样。严重地。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T17:37:17.880

我遇到了同样的问题。我刚刚创建了一个 SDL 文件夹并将源文件复制到其中。

所以而不是：

```
ln -s SDL . 
```

去：

```
mkdir SDL; cp *.h SDL 
```

这很丑陋，但它有效。

# ms-access - 以 MSAccess 作为数据提供者的 DataContext

> ID：12362450
> 
> 赞同：2
> 
> 时间：2012-09-11T03:42:38.923
> 
> 标签：ms-access, datacontext, dataprovider

我尝试使用 ms 访问作为数据提供者，但它给了我例外。

```
 static void Main(string[] args)
    {
        DataContext dx = new DataContext(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|\Data\mail.accdb;Persist Security Info=True");
    } 
```

例外是

```
System.ArgumentException was unhandled
Message=Keyword not supported: 'provider'. 
```

这怎么会发生？

提前致谢，

布赖恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T04:30:11.680

好的，我找到了解决方案。有点棘手

首先使用访问数据提供者创建 oledbconnection

```
IDbConnection connection = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=|DataDirectory|\Data\mail.accdb;Persist Security Info=True); 
```

最后将其传递给 DataContext

```
DataContext dx = new DataContext(connection); 
```

# javascript - jQuery 验证：不产生错误，不阻止提交（即不工作）

> ID：12362451
> 
> 赞同：0
> 
> 时间：2012-09-11T03:42:44.560
> 
> 标签：javascript, jquery, html, validation

我只是看不出这有什么问题-如果有一双新的眼睛可以提供帮助，我将不胜感激。这是全部内容（尽管我已将其简化为一个问题等）。

我使用 google 的地址作为操作地址，只是为了在 js fiddle（它什么都不做）中对其进行测试，实际版本指向表单的第二页。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" >

<head>

    <!--jquery-->
    <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <!--jquery-->

    <!--jquerytools-->
    <script src="http://cdn.jquerytools.org/1.2.7/full/jquery.tools.min.js"></script>
    <!--jquerytools--->

</head>

<body>

<form id="form1" method="post" action="http://www.google.com">

                    <label for="question1">How Many?</label> 
                    <input     
                        title="Answer this" 
                        type="number"  
                        id="question1" 
                        name="question1" 
                        value="$question1" 
                        size="10" 
                        maxlength="10"

                    />

                    <input 
                    type="submit" 
                    value="Continue" 
                />
         </form>
<script>
(function($,W,D)
{
    var VALIDATE = {};

    VALIDATE.UTIL =
    {
        setupFormValidation: function()
        {
            //form validation rules
            $("#form1").validate({
                rules: {
                    question1: "required"                    
                    }

                messages: {
                    question1: "Please complete this field",
                    },
                submitHandler: function(form) {
                    form.submit();
                }
            });
        }
    }

    //when the dom has loaded setup form validation rules
    $(D).ready(function($) {
        VALIDATE.UTIL.setupFormValidation();
    });

})(jQuery, window, document);
</script>    

</body>
</html> 
```

我正在使用此处描述的方法： [http ://www.jquery4u.com/forms/basic-jquery-form-validation-tutorial/#.UE6tb41lTwk](http://www.jquery4u.com/forms/basic-jquery-form-validation-tutorial/#.UE6tb41lTwk)

此验证工作正常的地方 - 我是 JS 新手。非常感谢所有帮助，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:02:04.043

您的代码有语法错误。检查这个**[*小提琴*](http://jsfiddle.net/ScwLn/1/)**

```
(function($,W,D)
{
    var VALIDATE = {};

    VALIDATE.UTIL =
    {
        setupFormValidation: function()
        {
            //form validation rules
            $("#form1").validate({
                rules: {
                    question1: "required"                    
                    },//---------->your code was missing this comma
                messages: {
                    question1: "Please complete this field",
                    },
                submitHandler: function(form) {
                    form.submit();
                }
            });
        }
    }

    //when the dom has loaded setup form validation rules
    $(D).ready(function($) {
        VALIDATE.UTIL.setupFormValidation();
    });

})(jQuery, window, document); 
```

要记住的第二件事是最初包含 jquery 库，然后包含 validate 插件，例如

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script> 
```

# c# - installutil 成功完成但未安装服务

> ID：12362455
> 
> 赞同：22
> 
> 时间：2012-09-11T03:43:36.757
> 
> 标签：c#, windows-services

我正在尝试安装 Windows 服务。

运行 c:\windows\microsoft.net\Framework64\v4.0.30319\InstallUtil.exe c:\foo\MyAssembly.exe

我收到一条很好的消息，所有阶段（安装、提交）都已成功完成。

（我没有收到提示输入服务凭据）

之后我在服务控制台中看不到该服务。安装日志中没有任何用处。

该解决方案建立在 64 位机器上，我正在尝试在 64 位机器上安装该服务。但是，我不认为 64 位是解决方案属性中的一个选项。我确实手动编辑了所有 csproj 文件以为 [平台] 节点选择“x64”..

我可以在 Visual Studio 之外运行服务没问题。

安装程序.cs

```
[RunInstaller(true)]
public partial class Installer : System.Configuration.Install.Installer
{
    public Installer() {
        InitializeComponent();
    }
} 
```

这是 Visual Studio 提供的默认安装程序。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-11T04:09:18.980

您需要将一些 Installer 对象添加到 Installers 集合中。[此处](http://msdn.microsoft.com/en-us/library/system.serviceprocess.serviceinstaller.aspx)的示例是您安装 Windows 服务所需的内容。就像是

```
[RunInstaller(true)]
public class Installer : System.Configuration.Install.Installer
{
    private ServiceInstaller serviceInstaller;
    private ServiceProcessInstaller processInstaller;

    public Installer()
    {
        // Instantiate installers for process and services.
        processInstaller = new ServiceProcessInstaller();
        serviceInstaller = new ServiceInstaller();

        // The services run under the system account.
        processInstaller.Account = ServiceAccount.LocalSystem;

        // The services are started manually.
        serviceInstaller.StartType = ServiceStartMode.Manual;

        // ServiceName must equal those on ServiceBase derived classes.
        serviceInstaller.ServiceName = "Hello-World Service 1";

        // Add installers to collection. Order is not important.
        Installers.Add(serviceInstaller);
        Installers.Add(processInstaller);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-22T18:12:48.413

以下 SO 问题具有类似的场景和答案，可能也与从 Google 搜索链接来到这里的人相关。

[安装在 Visual Studio 中创建的 Windows 服务](https://stackoverflow.com/questions/7922105/install-windows-service-created-in-visual-studio)

# c# - 如何使用 JSON.NET 使用十六进制编码字符解析格式错误的 JSONP？

> ID：12362456
> 
> 赞同：3
> 
> 时间：2012-09-11T03:43:40.577
> 
> 标签：c#, google-api, json.net, jsonp

我像这样调用谷歌的字典 api：

```
var json = new WebClient().DownloadString(string.Format(@"http://www.google.com/dictionary/json?callback=dict_api.callbacks.id100&q={0}&sl=en&tl=en", "bar")); 
```

但是我得到一个响应，该代码无法正确解析：

```
json = json.Replace("dict_api.callbacks.id100(", "").Replace(",200,null)", "");
JObject o = JObject.Parse(json); 
```

解析在遇到以下情况时死亡：

```
"entries":[{"type":"example","terms":[{"type":"text","text":"\x3cem\x3ebars\x3c/em\x3e of sunlight shafting through the broken windows","language":"en"}]}]} 
```

这

> \x3cem\x3ebars\x

东西杀死了解析

有没有办法用 JSON.NET 处理这个 JSONP 响应？

[aquinas](https://stackoverflow.com/users/82208/aquinas)对另一个“Parse JSONP”问题的[回答](https://stackoverflow.com/a/48471056/477420)显示了很好的正则表达式来处理 JSONP 部分（可能需要针对这种情况调整正则表达式），所以这里的主要部分是如何处理十六进制编码的字符。`x = Regex.Replace(x, @"^.+?\(|\)$", "");`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T04:04:39.337

参考：[如何解码嵌入在 json 字符串中的 HTML 编码字符](https://stackoverflow.com/questions/1101532/how-to-decode-html-encoded-character-embedded-in-a-json-string)

> 字符串的 JSON 规范不允许十六进制 ASCII 转义序列，但只允许 Unicode 转义序列，这就是转义序列无法识别的原因，这就是为什么使用 \u0027 应该可以工作的原因......现在你可以盲目地将 \x 替换为 \ u00 （这应该完全适用于有效的 JSON，尽管理论上某些注释可能会损坏，但谁在乎......：D）

因此，将您的代码更改为此将修复它：

```
 var json = new WebClient().DownloadString(string.Format(@"http://www.google.com/dictionary/json?callback=dict_api.callbacks.id100&q={0}&sl=en&tl=en", "bar"));

        json = json
                .Replace("dict_api.callbacks.id100(", "")
                .Replace(",200,null)", "")
                .Replace("\\x","\\u00");

        JObject o = JObject.Parse(json); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:03:04.877

服务器没有返回有效的 JSON：JSON*不*支持`\xAB`字符转义序列，只支持`\uABCD`转义序列。

我见过的“解决方案”首先在字符串上执行文本替换。这是我[对 Java 的类似问题的回复](https://stackoverflow.com/questions/11021041/detecting-and-parsing-escape-character-from-a-json-file/11025209#11025209)之一。`inputString.replaceAll("\\x(\d{2})", "\\u00$1")`注意底部的正则表达式；适应语言。

# spring - 在 contextInitializer 类中访问 web.xml 参数

> ID：12362457
> 
> 赞同：1
> 
> 时间：2012-09-11T03:43:48.567
> 
> 标签：spring, profile

所以有几篇文章描述了如何在 contextInitializerClass 中配置 spring.profiles.active。您可以在 web.xml 中添加如下内容：

```
<context-param>
    <param-name>contextInitializerClasses</param-name>
    <param-value>com.mycompany.SpringProfileInitializer</param-value>
</context-param> 
```

以及对应的类：

```
public class SpringProfileInitializer implements       ApplicationContextInitializer<ConfigurableApplicationContext> {

    @Override
    public void initialize(ConfigurableApplicationContext applicationContext) {

        ConfigurableEnvironment environment = applicationContext.getEnvironment();
        environment.setActiveProfiles( getActiveProfiles(NEED_PARAM_HERE) );            
    }

} 
```

但是我需要在上面的 getActiveProfiles() 调用中加入一个参数；只要它在 web.xml 文件中的“某处”，就可以使用字符串。

我怎样才能做到这一点？

谢谢。

编辑：只是备份一步，我*真正*要解决的问题是在一个 JVM 中运行多个战争的概念，每个战争都需要不同的 spring.profiles.active 属性，以及 spring.profiles.active 的值将是特定于环境的，位于某个属性文件中。

显然，我不能使用**-Dspring.active.profiles**，因为这对 JVM 来说是全局的。我们已经有一个特定于 env 的 per-war 属性文件，每场战争都知道如何使用**PropertyPlaceholderConfigurer**来拉入这个属性文件。将**spring.profiles.active**属性添加到此 prop 文件中不起作用（可能在此过程中为时已晚）。请注意，这些特定于战争的道具文件都安装在磁盘上的某个已知位置，并具有特定于战争的名称。

**现在，我可以使用ApplicationContextInitializer**以两种方式解决我的问题，如上所述。

1）我可以简单地为每个战争创建一个实现**ApplicationContextInitializer**的新类，可能扩展一些真正工作的“基”类。class-per-war 将简单地硬编码 prop 文件的名称，将其读入，然后提取 spring.profiles.active 属性。

2）我可以在战争中创建一个具有相同名称的战争特定道具文件，称之为**spring-profile-loc.properties**。该文件将仅包含一个属性，即上述战争特定道具文件的名称。在这种情况下，只有我上面的**SpringProfileInitializer类，它只是读入这个****spring-profile-loc.properties**文件，拉出单个 prop，然后读入真正的 prop 文件以访问**spring.profiles。主动**道具（这个想法还有其他变体）。

我不喜欢这两种方法，它们看起来笨重而迂回。**如果我可以在 web.xml 中“配置”一些东西并直接在我的ApplicationContextInitializer**的 impl 中访问它会更简单。

但是，如果有一些完全不同的方法来解决这个问题，我会全神贯注。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T18:44:47.393

您可以通过在 web.xml 文件中激活配置文件：

在您的 Dispatcher Servlet 的 init-param 中：

```
<servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>spring.profiles.active</param-name>
        <param-value>myenv</param-value>
    </init-param>
</servlet> 
```

或者按照[这个](https://stackoverflow.com/questions/8587489/how-to-set-active-spring-3-1-environment-profile-via-a-properites-file-and-not-v)

```
<context-param>
    <param-name>spring.profiles.active</param-name>
    <param-value>profileName</param-value>
</context-param> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:20:15.357

您可以尝试实现 ServletContextAware 然后使用 servletContext.getInitParameter() （或 getAttribute() ？）

但我不知道此时注入 servletContext 是否有效

# android - 是否有相当于android提示的css？

> ID：12362470
> 
> 赞同：3
> 
> 时间：2012-09-11T03:45:19.853
> 
> 标签：android, css

在 Android 布局 xml 文件中，可以执行以下操作...

```
<EditText android:id="@+id/username"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:hint="@string/username" />
<EditText android:id="@+id/password"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:inputType="textPassword"
    android:hint="@string/password" /> 
```

这会产生一个如下所示的 GUI：![截屏](../Images/779153a5667b76a135e151fd7a17952d.png)

如何使用 CSS 为 HTML 表单创建相同的效果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T03:47:58.490

您可以使用`placeholder`HTML5 属性，例如：

```
<input type="text" name="username" placeholder="Username" />
<input type="text" name="password" placeholder="Password" /> 
```

大多数浏览器都与此功能兼容，除了 Internet Explorer（请参阅 jcater 的评论）。例如，您可以使用[jquery-placeholder](https://github.com/mathiasbynens/jquery-placeholder)添加对旧版浏览器（甚至 IE6！）的支持。

# java - 使用 Jazzy 的 EPub 拼写检查器（拼写错误的单词不会出现在 JTable 中） - 已关闭

> ID：12362472
> 
> 赞同：1
> 
> 时间：2012-09-11T03:45:49.537
> 
> 标签：java, netbeans, spell-checking, epub

我使用 Jazzy Spell Library 创建了一个 EPub Spell Checker。问题是每当我运行我构建的项目时，拼写错误的单词应该出现在 JTable 中，但不会出现在 JTable 中。我尝试在 IDE 上运行该项目并且它可以工作。你认为是什么问题？

**这是拼写检查的代码**

* * *

```
private void btnSpellActionPerformed(java.awt.event.ActionEvent evt)
{                                         
    try {
        this.setCursor(Cursor.WAIT_CURSOR);
        File dic = new File(new File(strTmp,"dic"), cboDictionary.getSelectedItem().toString());
        SpellDictionary dict = new SpellDictionaryHashMap(dic);
        SpellProc p = new SpellProc();

        DataCls dc = new DataCls();
        dc.ExeComm("DROP TABLE IF EXISTS tblError;"
            + "CREATE TABLE tblError("
                + "FILE VARCHAR(255), "
                + "WORD VARCHAR(255), "
                + "LINE INT(10)"
                + ")");
        String[] col = new String[]{"File","Word","Line"};
        p.dtm.addColumn(col[0]);
        p.dtm.addColumn(col[1]);
        p.dtm.addColumn(col[2]);
        for(int i = 0; i < lstFile.getSize(); i++) {
            SpellChecker splChkr = new SpellChecker(dict);
            spellCheck splChk = p.new spellCheck();
            splChk.file = lstFile.getElementAt(i).toString();
            splChk.counter = 0;
            splChkr.addSpellCheckListener(splChk);
            String toCheck = p.readXHTML(new File(lstFile.getElementAt(i).toString()));
            splChkr.checkSpelling(new StringWordTokenizer(toCheck));
        }
        ResultSet rs = dc.ExeQuery("SELECT * FROM tblError");
        try {
            while (rs.next()) {
                String cont[] = new String[rs.getMetaData().getColumnCount()];
                for (int i = 0; i < rs.getMetaData().getColumnCount(); i++) {
                    cont[i] = rs.getString(rs.getMetaData().getColumnName(i + 1).toString());
                }
                p.dtm.addRow(cont);
            }
            rs.close();
            tblView.setModel(p.dtm);
        }
    catch (SQLException e) {
        JOptionPane.showMessageDialog(rootPane, e);
    }
        JOptionPane.showMessageDialog(rootPane, "Spell checking completed.");
        this.setCursor(Cursor.DEFAULT_CURSOR);
    } 
    catch(FileNotFoundException e) {
        JOptionPane.showMessageDialog(rootPane, "File loading error. \r\n\r\n" + e, "Error Occured.", JOptionPane.WARNING_MESSAGE);
    } 
    catch(IOException f) {
        JOptionPane.showMessageDialog(rootPane, "File loading error. \r\n\r\n" + f, "Error Occured.", JOptionPane.WARNING_MESSAGE);
    }
} 
```

* * *

**这是 spellCheck() 的代码；**

* * *

```
public class spellCheck implements SpellCheckListener {
    String file = "";
    String lst = "";
    String[] rValue = {"","",""};
    int counter;
    String find = "";
    DataCls dat = new DataCls();
    @Override
    public void spellingError(SpellCheckEvent svt) {

        lst ="";
        lstError.addElement(svt.getInvalidWord().replace("'", "\\'"));

        try {
            ResultSet rChk = dat.ExeQuery("SELECT MAX(LINE) FROM tblError WHERE FILE='" + new File(file).getName() + "'AND WORD='" + svt.getInvalidWord().replace("'", "''") + "'");
            int rwCnt = 0;
            while(rChk.next()) {rwCnt++;}
            if (rwCnt == 0) {
                try {
                    BufferedReader br = new BufferedReader(new FileReader(file));
                    int i = 0;
                    String line;
                    while((line = br.readLine()) != null) {
                        i++;
                        int index = line.indexOf(svt.getInvalidWord().replace("'", "\\'"));
                        if (index >= 0) {
                            dat.ExeComm("INSERT INTO tblError(FILE,WORD,LINE) "
                                    + "VALUES ('" + new File(file).getName() +"','" + svt.getInvalidWord().replace("'", "\\'") + "','" + i + "')");
                            break;
                        }
                    }
                } catch (IOException e){
                    System.out.println(e);
                }

            } else if (rwCnt > 0){
                ResultSet rs = dat.ExeQuery("SELECT MAX(LINE) FROM tblError WHERE FILE='" + new File(file).getName() + "' AND WORD='" + svt.getInvalidWord().replace("'", "''") + "'");
                rs.next();
                try {
                        int iline = rs.getInt(1);
                        try {
                            BufferedReader br = new BufferedReader(new FileReader(file));
                            int i = 0;
                            String line;
                            while((line = br.readLine()) != null){
                                i++;
                                int index = line.indexOf(svt.getInvalidWord().replace("'", "\\'"));
                                if (i > iline) {
                                    if (index >= 0) {
                                        dat.ExeComm("INSERT INTO tblError(FILE,WORD,LINE) "
                                                + "VALUES ('" + new File(file).getName() +"','" + svt.getInvalidWord().replace("'", "\\'") + "','" + i + "')");
                                        break;
                                    }
                                }
                            }

                        }
                        catch (IOException e) {
                            JOptionPane.showMessageDialog(null, e);
                        }
                } catch (SQLException ex) {
                    JOptionPane.showMessageDialog(null, ex);
                }
            }
        } catch (SQLException ex) {
            JOptionPane.showConfirmDialog(null, ex);
        }
    }
} 
```

# java - Spring：处理具有可变属性的对象

> ID：12362476
> 
> 赞同：1
> 
> 时间：2012-09-11T03:46:32.363
> 
> 标签：java, spring, spring-mvc

我有一个具有动态数量属性的对象。例如，一个展示汽车及其所有详细信息的页面：

*   模型
*   颜色
*   价格

现在一些特权用户可以为汽车对象添加属性。假设在某个时候出现要求任何用户都应该能够指定汽车的长度，所以我们想添加一个新属性

*   长度

我已经到了创建新车的表格的地步，该表格显示了所有字段，包括额外添加的字段：

```
 <!-- ADDITIONAL ATTRIBUTES -->

    <c:forEach items="${attributes}" var="a">

    <div class="${a}">
        <span class="details_headline">${a}:</span>
        <input id="${a}" name="${a}" class="input" type="text" value="" placeholder="${a}"/>
    </div>

    </c:forEach>

    <!-- END ADDITIONAL ATTRIBUTES --> 
```

我现在如何将所有这些属性传递给控制器​​，然后控制器会将新车添加到我的系统中？

我相信我正在寻找的结构是一个映射，其中包含作为键的属性和相应的值，然后控制器可以进一步处理这些值。我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:06:08.520

我假设您使用的是spring mvc？

您可能想要创建一个像这样的简单模型 bean

```
public class AttributesBean {
    private Map<String, String> attributes = new HashMap<String,String>();

    // omitted getters and setters
} 
```

您现在可以将属性值传递给此 bean => attributes[${a}]（假设 'a' 是枚举、字符串或其他原始类型（如果您想使用更复杂的类型作为钥匙））

```
<!-- ADDITIONAL ATTRIBUTES -->

<c:forEach items="${attributes}" var="a">

<div class="${a}">
    <span class="details_headline">${a}:</span>
    <input id="${a}" name="attributes[${a}]" class="input" type="text" value="" placeholder="${a}"/>
</div>

</c:forEach>

<!-- END ADDITIONAL ATTRIBUTES --> 
```

Spring 将创建一个新的 AttributesBean 对象并将这些参数绑定到相应的字段。

```
@RequestMapping
public void handleAttributes(final AttributesBean bean) {
    // bean.getAttributes().get("abc");
} 
```

我无法尝试，但它应该确实有效

# php - 数组的映射函数

> ID：12362479
> 
> 赞同：1
> 
> 时间：2012-09-11T03:46:45.013
> 
> 标签：php, map

我有一个这样的数组`$a=("something","something else","another something");`和另一个这样的数组`$b=("b","bb")`。

我想制作一个`$a = array("something"=>Array("b","bb"),"something else","another something");`. 怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:58:17.127

试试这个，有很多选项，您可以根据位置或数组元素（如@Mike Moore 回答）来执行此操作

```
$a = array ( 'something', 'something else',  'another something');

$b = array('b', 'bb');

for($i = 0; $i < count($a); $i++)
{
    if($i==0)
    {
        $a[$i] = array('something' => $b);
    }
}

print_r($a); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:04:38.637

尝试[array_map](http://www.php.net/manual/en/function.array-map.php)以获得更大的灵活性：

```
function map_a_thing(key, val, compare) {
  if (key == compare)
    return array(key => val);
  else
    return key;
  end
}

$c = array_map('map_a_thing', $a, $b, 'something'); 
```

考虑到您本质上是在问一个 map-reduce 问题，您在其中寻找一个函数来根据条件执行给定的操作。

有了这个答案，您可以遍历基本数组并重新映射某些值

```
$map_targets = array('something', 'some2', 'some45', 'some-other');
foreach ($map_targets as $target) {
    $a = array_map('map_a_thing', $a, $b, $target);
} 
```

另请参阅[array_reduce](http://www.php.net/manual/en/function.array-reduce.php)、[array_filter](http://www.php.net/manual/en/function.array-filter.php)和通用[array_walk](http://www.php.net/manual/en/function.array-walk.php)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T03:49:35.633

**哎呀**，我的旧答案是废话。*谢谢大家*指出！

这是我的更新答案：

```
<?php

$a = array (
    'something',
    'something else',
    'another something'
);

$b = array('b', 'bb');

for($i = 0; $i < count($a); $i++)
{
    if($a[$i] == 'something')
    {
        $a[$i] = array('something' => $b);
    }
}

print_r($a); 
```

# maps - 谷歌地图的 X/Y/Z 到纬度/经度

> ID：12362482
> 
> 赞同：2
> 
> 时间：2012-09-11T03:47:34.330
> 
> 标签：maps, coordinates

我正在尝试将 X/Y/Z 坐标转换为纬度/经度坐标，以便我可以在 Google 地图上绘制它们，但数学不是我最擅长的学科，我遇到了麻烦。

有人可以帮我转换吗？或者有没有办法将 X/Y/Z 直接绘制到谷歌地图上？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T03:52:18.530

```
lat = asin(z / R) //Latitude
lon = atan2(y, x) //Longitube 
```

其中R是地球的大约[半径](http://en.wikipedia.org/wiki/Earth_radius)。

[这是](http://rbrundritt.wordpress.com/2008/10/14/conversion-between-spherical-and-cartesian-coordinates-systems/)非常简单明了的解释的链接。

# c++ - 使用鼠标拖动旋转 QLabel

> ID：12362486
> 
> 赞同：1
> 
> 时间：2012-09-11T03:48:20.427
> 
> 标签：c++, qt, qt4

我正在对 a 进行子类化，`QLabel`并尝试在用户用鼠标拖动（或旋转）图像时旋转它。目前我只是顺时针旋转每个鼠标移动事件：

```
void RotoTest::slotMouseMoved()
{
    currentRotation += 1;
    rotate(currentRotation % 360);
}

void RotoTest::rotate(int degree)
{
    QPixmap pixmap(originalPixmap);
    QPixmap rotatedMap(pixmap.size());
    QPainter p(&rotatedMap);
    p.translate(pixmap.size().width() / 2, pixmap.size().height() / 2);
    p.rotate(degree);
    p.translate(-pixmap.size().width() / 2, -pixmap.size().height() / 2);
    p.drawPixmap(0, 0, pixmap);
    this->setPixmap(rotatedMap);
} 
```

这可以工作和旋转，但问题是图像变得非常滞后、抖动和无响应，尤其是对于给定实例，鼠标移动得更快或更长时间。我怀疑这是由于鼠标移动时发送了大量信号而发生的。有人对平滑旋转的方法有什么建议吗？我正在寻找图像旋转得一样好`QDial`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T16:09:12.233

您的问题是您应该只在`paintEvent()`. 你`slotMouseMoved()`应该看起来像：

```
void slotMouseMoved() {
     currentRotation = (currentRotation + 1) % 360;
     update();
} 
```

像素图生成应在重新实现的`paintEvent()`. 没有理由从 QLabel 派生，只需从 QWidget 派生。

```
void RotoTest::paintEvent(QPaintEvent * ev)
{
    QPixmap pixmap(originalPixmap);
    QPainter p(this);
    p.translate(pixmap.size().width() / 2, pixmap.size().height() / 2);
    p.rotate(degree);
    p.translate(-pixmap.size().width() / 2, -pixmap.size().height() / 2);
    p.drawPixmap(0, 0, pixmap);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:39:15.283

如果没有看到更多代码，我不清楚，但可能是堆积了太多事件。如果是这种情况，那么 1）这是一个惊喜，因为 Qt 应该悄悄地将许多相同的事件压缩成几个，并且 2）您可以通过在处理输入事件的插槽代码中限制对 update() 的调用来自己完成. （或者，因为你是 QLabel 的子类，它会去*某个地方*......？）

有关解释和代码，请参见[http://qt-project.org/forums/viewthread/12257 。](http://qt-project.org/forums/viewthread/12257)

话又说回来，这可能完全是在叫错树。这就是我们有否决按钮的原因；）

# .net - 来自 Azure 中托管的 Web 服务的“操作已超时”不一致的超时错误

> ID：12362488
> 
> 赞同：2
> 
> 时间：2012-09-11T03:48:46.227
> 
> 标签：.net, web-services, azure, timeout, asmx

我创建了一个托管在 Azure 中的 Web 服务应用程序。服务进程运行大约 10 分钟才能完成并返回一个包含 2782 个字符的字符串。服务超时已设置为 1 小时，但我仍然收到超时错误。

但是当我发送一个小数据进行处理时，在 5 分钟内服务响应完美。

```
ERROR: "The operation has timed out" 
```

注意：当我在本地 IIS 中使用已发布的 Web 服务测试我的应用程序时，该过程运行顺利。我还尝试通过 azure 中托管服务实例的远程连接来测试该服务，它也可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:59:16.527

Azure 负载均衡器在一分钟后终止所有空闲连接。这可能是导致您出现此问题的原因。无法配置负载平衡器以允许更长的连接。在等待服务完成时，您可能需要更改服务以使用 post then poll 方法。有关完整说明和示例代码，请参阅[此问题](https://stackoverflow.com/questions/6184752/set-timeout-for-controller-action/6192680#6192680)。

# clojure - 在 ClojureScript One 项目中使用 clojure.browser.event.unlisten

> ID：12362489
> 
> 赞同：2
> 
> 时间：2012-09-11T03:48:47.007
> 
> 标签：clojure, clojurescript

我正在尝试编写一个 clojureScript One 项目，但在删除事件侦听器（未侦听）时遇到问题 - 侦听器已使用以下代码注册：

```
(defn- add-expand_fold-listener
"Accepts a ele-id and creates listeners for click events on div
which will then fire rendering changes"
[ele-id]
(log/log "adding opening listeners")
(event/listen (single-node (by-id ele-id))
    "click"
#(dispatch/fire (re-class ele-id "foldup" "expand")))) 
```

但是当我尝试用这段代码不听时：

```
(defn- remove-expand_fold-listener
 "Accepts a ele-id and removes listener for click events on div"
 [ele-id]
 (log/log "removing opening listener")
(event/unlisten (by-id ele-id) 
      "click" 
      #(dispatch/fire (re-class ele-id "foldup" "expand")) 
      false)
(log/log "done removing listener")) 
```

代码运行没有错误，但监听器没有被删除，我想我有一个语法错误，但我不确定在哪里。

任何帮助将不胜感激。谢谢拉里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:47:58.017

在 DOM 中，您可以将多个事件处理程序附加到单个元素，因此当您想要删除一个事件处理程序时，DOM 需要知道您要删除哪个特定的事件处理程序。在您的代码中，附加事件处理程序会创建一个新的处理程序函数并附加它，而在其他代码中它会创建另一个新函数（尽管代码相同）并尝试取消监听它，所以基本上它不能按您的需要工作将绑定事件时使用的相同函数对象传递给 unlisten。

要解决此问题，您需要将处理程序定义为具有名称（非匿名）的函数，并在绑定和取消绑定事件中使用该函数。

```
(defn myHandler [& args] (dispatch/fire (re-class ele-id "foldup" "expand"))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T17:41:37.913

已解决：与其尝试使用 domina（这是个好东西，但并非所有功能都在 lein-deps 中），而是尝试使用 clojureScript One 事件模型最终直接找到了源代码...添加到了 require 部分命名空间：

```
[goog.events :as g-events] 
```

然后在使用的remove函数中：

```
(g-events/removeAll (by-id ele-id) "click") 
```

它就像一个冠军。希望这对将来的人有所帮助...

# ruby-on-rails - 设计：创建管理员用户和帐户

> ID：12362492
> 
> 赞同：1
> 
> 时间：2012-09-11T03:49:10.693
> 
> 标签：ruby-on-rails, devise

使用这个问题和答案（[将 Account 和 User 表与 Devise 一起使用](https://stackoverflow.com/questions/8305120/use-both-account-and-user-tables-with-devise)）我已经成功地为我的应用程序设置了注册用户同时创建帐户的能力。目前，我有两种模型：用户和帐户。在用户模型中，我有一个`account_id`字段。

我现在正在努力解决如何让这个用户（即第一个创建帐户的用户）默认为管理员。我的用户模型中有一个管理字段（这是与已设置为使用单个用户模型的 ActiveAdmin 一起使用的）。

其次，我知道有多个帖子可以弄清楚管理员用户如何创建其他用户（我仍在尝试使用 Devise），但是有人可以指导我以最简单的方式让其他用户都被分配一样`account_id`。我计划使用 CanCan 来控制管理员和非管理员在 ActiveAdmin 和一般应用程序中可以访问的内容。

任何帮助将不胜感激。

我目前的模型是：

账户模型

```
class Account < ActiveRecord::Base   
  has_many :users, :inverse_of => :account, :dependent => :destroy      
  accepts_nested_attributes_for :users   
  attr_accessible :name, :users_attributes
end 
```

用户模型

```
class User < ActiveRecord::Base
  belongs_to :account, :inverse_of => :users   
  validates :account, :presence => true
  devise :database_authenticatable, :registerable,
    :recoverable, :rememberable, :trackable, :validatable
  attr_accessible :email, :password, :password_confirmation, :remember_me
end 
```

我的控制器是：

帐户控制器

```
class AccountsController < ApplicationController    
  def new     
    @accounts = Account.new     
    @accounts.users.build  
  end    
  def create     
    @account = Account.new(params[:account])     
    if @account.save       
      flash[:success] = "Account created"       
      redirect_to accounts_path     
    else       
      render 'new'     
    end   
  end  
end 
```

用户控制器

```
class UsersController < ApplicationController   
  before_filter :authenticate_user!   
  load_and_authorize_resource # CanCan
  def new     
    @user = User.new   
  end    
  def create         
    @user.skip_confirmation! # confirm immediately--don't require email confirmation     
    if @user.save       
      flash[:success] = "User added and activated."       
      redirect_to users_path # list of all users     
    else       
      render 'new'     
    end   
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T05:00:33.773

如果您只想强制第一个用户成为管理员，请尝试以下操作：

```
class Account < ActiveRecord::Base
   after_create :make_first_user_an_admin

   def make_first_user_an_admin
      return true unless self.users.present?
      self.users.first.update_attribute(:admin, true)
   end
end 
```

它只会运行一次 - 在首次创建帐户时。我还建议验证帐户中有*一些*用户。

# eclipse - 如何在 Eclipse 中定义 printf

> ID：12362493
> 
> 赞同：1
> 
> 时间：2012-09-11T03:49:15.713
> 
> 标签：eclipse

我正在 Eclipse IDE 中学习 Java。我无法弄清楚如何让 printf 工作或定义它。我已经检查过，我正在为我拥有的 Java 使用正确的编译器，即 1.6。这是我得到的错误：

```
Syntax error on token ".", ; expected
The method printf(String, int) is undefined for the type Addition 
```

该程序：

```
// Fig 2.7: Addition.java
// Addition program that displays the sum of two numbers.
import java.util.Scanner; // program uses class Scanner

public class Addition
{
// main method begins execution of Java application
public static void main( String[] args )
{
    // create a Scanner to obtain input from the command window
    Scanner input = new Scanner( System.in );

    int number1; // first number to add
    int number2; // second number to add
    int sum; // sum of number1 and number2

    System.out.print( "Enter first integer: "); // prompt
    number1 = input.nextInt(); // read first number from user

    System.out.print( "Enter second integer: "); // prompt
    number2 = input.nextInt(); // read second number from user

    sum = number1 + number2; // add numbers, then store total in sum

    System out.println( "Sum is %d\n", sum ); // display sum        

} // end method main
} // end class Addition 
```

我已经尝试过 Eclipse 的自动修复，但它仍然会给我令牌“。”的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:01:25.160

你错过了一个`.`：

```
System out.println( "Sum is %d\n", sum ); // display sum 
```

应该：

```
System.out.println( "Sum is %d\n", sum ); // display sum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T03:55:39.753

```
System.out.println("the out put sum is"+ sum). 
```

如果您想在控制台中显示输出，那么这是 java 中使用 eclipse 的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T03:58:03.723

在 Java 中， printf 被称为[format](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/PrintStream.html#format%28java.lang.String,%20java.lang.Object...%29)：

```
 System.out.format("Sum is %d\n", sum); 
```

就像其他一切一样，它不是一个独立的函数，而是一种方法。

如果你想自己实现这个，你需要阅读可变参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T03:59:44.257

你应该`System.out.println`这样使用：

```
System.out.println("Sum is " + sum); 
```

# nunit - 返回列表的测试方法

> ID：12362496
> 
> 赞同：2
> 
> 时间：2012-09-11T03:49:50.537
> 
> 标签：nunit

我是单元测试的新手。

我有一个方法

```
public List<Employee> GetEmployeeList()
{

} 
```

如何为上述方法编写联合测试。列表是否返回任何数据？请....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:40:08.557

如果该方法从数据库中获取其数据（正如您在评论中提到的那样），那么它要么是一个集成测试，要么您需要模拟数据库访问，如果该方法所做的只是检索数据而没有以任何方式改变它。

# mysql - mysql：字段列表中的未知列

> ID：12362497
> 
> 赞同：2
> 
> 时间：2012-09-11T03:50:10.467
> 
> 标签：mysql, sql, mysql-error-1054

我正在创建一个程序，我应该在其中查找考试的最后日期。
所以我为此创建了一个局部变量，因为我在其他事情上也需要这个日期。但是，当我对此局部变量执行简单的 SELECT 操作时，会收到以下消息：

> “字段列表”中的未知列“last_exam”。

代码：

```
DECLARE latest_exam date;

  SELECT DATE(MAX(ex_date))
    INTO latest_exam
    FROM vets
   WHERE an_id = p_animal_id
GROUP BY an_id;

SELECT latest_exam, and a bunch of other stuff. ; 
```

在选择中，是否需要包含 FROM 子句？我不这么认为，因为我认为 latest_exam 在程序内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:52:30.253

您没有在变量中分配选择的结果。

做这个

```
select latest_exam = date(max(ex_date)).. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T03:53:41.637

我认为`CROSS JOIN`可以回答您的问题，因为它会从两个表中生成笛卡尔积。尝试这个。

```
SELECT x.maxDate,
       b.*
FROM tableName b,
    (
        SELECT DATE (max(ex_date)) maxDate
        FROM vets
        WHERE an_id = p_animal_id
        GROUP BY an_id
    ) x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-01T00:36:05.943

我有同样的问题; 结果不是我在过程中的 SELECT INTO 查询（是的，[在 MySQL 中有效](http://dev.mysql.com/doc/refman/5.1/en/select-into.html)），而是稍后在该外部过程中对另一个具有该实际错误的过程进行的调用。

我只是在使用模拟值在程序之外确认我的查询后才发现这一点：

```
SET @this_RID=0, @this_RANo=0, @this_modpos=0;

SELECT Response_ID, Response_attempt_No, position, UNCOMPRESS(RAMX.`data`)
INTO @this_RID, @this_RANo, @this_modpos, @this_XML 
FROM RAMX
WHERE 
    Response_ID>=@this_RID AND Response_attempt_No>=@this_RANo AND position>=@this_modpos 
    AND (NOT (Response_ID=@this_RID AND Response_attempt_No=@this_RANo AND position=@this_modpos))
    AND module_ID=2
    AND `data` <> ""    
ORDER BY Response_ID, Response_attempt_No, position
LIMIT 1;

SELECT @this_RID, @this_RANo, @this_modpos;

+-----------+------------+--------------+
| @this_RID | @this_RANo | @this_modpos |
+-----------+------------+--------------+
|    451994 |          0 |            1 |
+-----------+------------+--------------+
1 row in set (0.00 sec) 
```

在更正它调用的过程之前，调用外部过程会给出此错误：

错误 1054 (42S22)：“字段列表”中的未知列“数据”

# php - 在 htaccess 上使用更具体的重写工具

> ID：12362500
> 
> 赞同：2
> 
> 时间：2012-09-11T03:50:23.517
> 
> 标签：php, mysql, .htaccess, rewrite

我想替换我的链接如下

> www.site.com?action&MasterKategori=Music&kategori=Pop&SubKategori=Western

经过

> www.site.com/Music/Pop/Western

我使用这个脚本

> 重写引擎开启
> 
> RewriteBase /
> 
> 重写引擎开启
> 
> RewriteRule ^([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+) index.php?action&m=$1 &k=$2&s=$3

有用！但是改变了我的网站偏好，当点击 URL 时，所有包含的文件（css，js）也会被重写。

我怎样才能阻止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T03:55:16.973

您可以使用重写条件来告诉规则不匹配对应于实际文件的 URI。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+) index.php?action&m=$1&k=$2&s=$3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T10:37:54.660

试试这个（你可以在第三行添加任何你想要的扩展）：

```
RewriteEngine on
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !\.(js|css|png|jpe?g|ico)$
RewriteRule ^([a-z0-9_-]+)/([a-z0-9_-]+)/([a-z0-9_-]+) index.php?action&m=$1&k=$2&s=$3 [L,NC] 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T03:55:09.923

在 RewriteRule 之前添加以下行

```
RewriteCond $1 !^(favicon\.ico|favicon\.png|media|robots\.txt|crossdomain\.xml|css|js) 
```

# c++ - CMake 不能在 OSX 上使用 C++11

> ID：12362502
> 
> 赞同：9
> 
> 时间：2012-09-11T03:50:38.847
> 
> 标签：c++, macos, c++11, cmake

我刚刚升级到 Mountain Lion，因此我可以在 xcode 附带的新版本 Clang 上使用一些 C++11 功能。我正在使用 Homebrew 的 cmake 2.8.9。

我制作了一个非常简单的 CMake 项目，它为 C++11 添加了编译器标志：

```
# CMakeLists.txt
cmake_minimum_required(VERSION 2.8)
add_executable(test test.cxx)
add_definitions(-std=c++0x -stdlib=libc++) 
```

其中 test.cxx 中的 C++ 代码如下：

```
#include <iostream>

int main()
{
  std::cout << "Howdy" << std::endl;
  return 0;
} 
```

运行 cmake 和 make 时，文件编译得很好，但链接器输出以下错误：

```
Linking CXX executable test
Undefined symbols for architecture x86_64:
  "std::__1::locale::use_facet(std::__1::locale::id&) const", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::endl<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&) in test.cxx.o
  "std::__1::ios_base::getloc() const", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::endl<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&) in test.cxx.o
  "std::__1::basic_ostream<char, std::__1::char_traits<char> >::put(char)", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::endl<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&) in test.cxx.o
  "std::__1::basic_ostream<char, std::__1::char_traits<char> >::flush()", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::endl<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&) in test.cxx.o
  "std::__1::basic_ostream<char, std::__1::char_traits<char> >::sentry::sentry(std::__1::basic_ostream<char, std::__1::char_traits<char> >&)", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::operator<<<std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&, char const*) in test.cxx.o
  "std::__1::basic_ostream<char, std::__1::char_traits<char> >::sentry::~sentry()", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::operator<<<std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&, char const*) in test.cxx.o
  "std::__1::cout", referenced from:
      _main in test.cxx.o
  "std::__1::ctype<char>::id", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::endl<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&) in test.cxx.o
  "std::__1::locale::~locale()", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::endl<char, std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&) in test.cxx.o
  "std::__1::ios_base::__set_badbit_and_consider_rethrow()", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::operator<<<std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&, char const*) in test.cxx.o
  "std::__1::ios_base::clear(unsigned int)", referenced from:
      std::__1::basic_ostream<char, std::__1::char_traits<char> >& std::__1::operator<<<std::__1::char_traits<char> >(std::__1::basic_ostream<char, std::__1::char_traits<char> >&, char const*) in test.cxx.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[2]: *** [test] Error 1
make[1]: *** [CMakeFiles/test.dir/all] Error 2
make: *** [all] Error 2 
```

如果我注释掉 CMakeLists.txt 文件中的 add_definitions 行，我不会收到任何错误，如果我删除 test.cxx 中的 std::cout 行，我也可以避免错误。也许最奇怪的部分是，如果我只是跑

```
clang++ -std=c++0x -stdlib=libc++ test.cxx 
```

它编译得很好！因此，按照评论员的建议，我检查了 cmake 正在运行的实际命令以进行编译和链接。

编译：

```
/usr/bin/c++    -std=c++0x -stdlib=libc++ -o CMakeFiles/test.dir/test.cxx.o -c /Users/luis/test.cxx 
```

关联：

```
/usr/bin/c++    -Wl,-search_paths_first -Wl,-headerpad_max_install_names   CMakeFiles/test.dir/test.cxx.o  -o test 
```

现在的主要问题似乎是链接器没有提供正确的 C++11 标志。有没有更好的方法来提供这些标志，以便编译器和链接器都使用它们？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-11T04:10:57.163

我不确定这[`ADD_DEFINITIONS`](http://www.cmake.org/cmake/help/cmake2.6docs.html#command%3aadd_definitions)是否适合这项特定工作。

也许更好的选择是[`CMAKE_CXX_FLAGS`](http://www.cmake.org/Wiki/CMake_Useful_Variables#Compilers_and_Tools)直接设置值：

```
cmake_minimum_required(VERSION 2.8)
set (CMAKE_CXX_FLAGS "-std=c++0x -stdlib=libc++ -g3 -Wall -O0")
add_executable(test test.cxx) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-30T18:43:28.640

我在运行`gcc`而不是`g++`. 如果我使用`g++`，事情会正确编译。也许您的 Makefile 使用了错误的编译器前端。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-04T14:24:35.840

转到您的项目目标->Apple LLVM 编译器 4.1-语言->选择 c++library 以

```
libc__(LLVM C++ stadard library with c++ 11 support); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-15T16:46:40.140

在最近收到此错误后（使用 Clang），问题在于也没有`-std=c++11 -stdlib=libc++`作为链接器标志传递。

所以它们必须作为编译器标志**和**链接器标志传递。

对于 GCC，第一个标志是`-std=c++0x`，而不是`-std=c++11`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-09T20:33:31.380

对我来说，答案只是使用`clang++`而不是`clang`.

# php - 转换为 Ms 字时隐藏 TextArea

> ID：12362505
> 
> 赞同：-1
> 
> 时间：2012-09-11T03:51:23.453
> 
> 标签：php, jquery, jquery-ui, css

假设我的 php 代码如下：

```
<form method="post" action="htmltortf.php">
<table>
    <tr>
            <td>Candidate Name:</td>
                <td colspan="3"><textarea cols="40" rows="10" name="textArea"><?php echo $var = isset($_POST['textArea']) ? $_POST['textArea'] : ''; ?></textarea></td>
         </tr>
            <tr>
                <td colspan="3"><input type="submit" name="submit" value="submit" /></td>
            </tr>
</table>
<?php
    if(isset($_POST['submit']))
    {                   
    header("Content-type: application/vnd.ms-word");
    header("Content-Disposition: attachment;Filename=html2doc.doc");
        }
?> 
```

**我需要的：**

我希望当用户单击按钮提交时，它会生成到 Ms word 但对于 textArea 我不希望它像边框一样显示它的样式或......我只想显示它的值。例如: `This is the textArea in the Ms word file`.

**问题：**

当我转换它时，它仍然显示 textArea 的样式，如边框和滚动......

我不知道如何解决这个问题？请帮助我，

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:45:56.780

尽管您没有创建有效的 Word (.doc) 文档 - 下载后它仍然可以作为普通的 Word 文件使用。

您的问题的解决方案：

```
<form method="post" action="htmltortf.php">
<table>
    <tr>
         <td>Candidate Name:</td>
         <td colspan="3">
<?php if(isset($_POST['submit'])): ?>
<?php echo $_POST['textArea']; // echo just the posted value ?>
<?php else: // or show textarea field ?>
             <textarea cols="40" rows="10" name="textArea"><?php echo $var = isset($_POST['textArea']) ? $_POST['textArea'] : ''; ?></textarea>
<?php endif ?>
        </td>
    </tr>
    <tr>
        <td colspan="3"><input type="submit" name="submit" value="submit" /></td>
    </tr>
</table>
<?php
if(isset($_POST['submit']))
{                   
    header("Content-type: application/vnd.ms-word");
    header("Content-Disposition: attachment;Filename=html2doc.doc");
}
?> 
```

我假设您知道用户能够在 textarea 中发布 HTML 代码，这可能会导致格式错误的 DOC 输出，因此您可能应该在回显它之前使用`strip_tags()`或`htmlspecialchars()`打开。`$_POST['textArea']`

# javascript - 如何根据每个 item.id 的 NUM_PHOTOS 增加 .jpg 前缀的数字？

> ID：12362506
> 
> 赞同：1
> 
> 时间：2012-09-11T03:51:29.880
> 
> 标签：javascript, jquery, loops

感谢这个站点，我现在有从服务器返回的 json 数据，很好地填充了我的页面。

返回的字段之一是`NUM_PHOTOS`. 每张照片至少有 1 张`item.id`。

但是实际的照片不在 json 数据中，它们在一个 diff 目录中，并且全部递增并开始`'item.id'+/1.jpg`于并取决于`NUM_PHOTOS`该特定项目的存在。

例如，对于项目“20090”，有 5 张照片，在一个单独的目录中： `/20090/1.jpg, 20090/2.jpg, etc.`最多有多少张照片。我如何`.jpg`根据每个 NUM_PHOTOS增加前缀的数字`item.id?`

我已经使用下面的代码为每个“item.id”动态填充了 flexsider 的前 3 张图像，但是当然照片的数量会有所不同，我被困在需要附加的`.jpg'`s前缀上对于`NUM_PHOTOS`每个`item.id.`

```
$('.flexslider .slides').append('<li><img src="http://url/data/listing/pics/' + item.id     + '/1.jpg"></li>');           
$('.slides').append('<li><img src="http://www.url.co.nz/data/listing/pics/' + item.id     + '/2.jpg"></li>');
$('.slides').append('<li><img src="http://www.url.co.nz/data/listing/pics/' + item.id     + '/3.jpg"></li>');
} 
```

我尝试了几种技术，但作为一个初学者，我需要一点帮助。

```
JS is: 
 $('#detailsPage').live('pagebeforeshow', function(event) {
    var id = getUrlVars()["id"];
    $.getJSON('http://www.url.co.nz/feeds/json_detail.php?id='+id, displayItem);
    });
    function displayItem(data) {
var listing = data.item;

$('#id').text(listing.id + ', ' + listing.suburb + ', ' +listing.district); 
$('#Title').text(listing.title);
$('#numberPhotos').text(listing.num_photos);
$('#price').text('Price Approx:   ' + '$' + listing.price );

// how do i auto increment the .jpg according the 'num_photos' field returned from json?
// ?????  if (listing.num_photos???????) {

$('.flexslider .slides').append('<li><img src="http://www.url.co.nz/data/listing/pics/' +     listing.id + '/1.jpg"></li>');
$('.slides').append('<li><img src="http://www.url.co.nz/data/listing/pics/' + listing.id     + '/2.jpg"></li>');
$('.slides').append('<li><img src="http://www.url.co.nz/data/listing/pics/' + listing.id     + '/3.jpg"></li>');
}

function getUrlVars() {
var vars = [], hash;
var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
for(var i = 0; i < hashes.length; i++)
{
    hash = hashes[i].split('=');
    vars.push(hash[0]);
    vars[hash[0]] = hash[1];
  }
  return vars;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:07:01.460

您必须计算 JSON 数据中的 id 数量。

就在这条线之前

```
var listing = data.item; 
```

一旦你计数然后将下面的代码放在循环中就是它

```
for(i=0;i<counted_value;i++){
   var listing = data.item;
   $('.slides').append('<li><img src="http://www.url.co.nz/data/listing/pics/'+ listing.id +'/2.jpg"></li>');
} 
```

如果您不知道如何计数，请先在控制台中打印数据并检查数据格式并尝试在测试文件中打印计数

# linked-list - 使用恒定数量的附加空间反转链表

> ID：12362510
> 
> 赞同：0
> 
> 时间：2012-09-11T03:52:13.493
> 
> 标签：linked-list, reverse

以下是我反转链表的代码：

```
public LinkedList reverse() {
    LinkedList m = new LinkedList();
    Node temp = this.getHeadNode();
    while(temp!= null) {
        m.insertFirst(temp.getElement());
        temp = temp.getNext();
    }
    m.getTailNode().setNext(null);
    return m;
} 
```

对于在我的函数中声明的局部变量 LinkedList mi，这是否意味着我正在使用 O(n) 数量的额外空间，或者它被认为是恒定数量的空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:28:47.000

嗨，我认为一种更好的方法可能是在不创建辅助列表的情况下反转链接列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:49:03.980

只需三个指针在开始时初始化所有三个假设这些指针是 x,y,z 然后移动 y=x->next,z=y->next ,y->next=x,x=y; 这样做直到 x 到达列表的末尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:09:32.240

因为您正在创建链表的新实例 - 您将在内存中有 2 个列表副本。该列表将包含对对象的引用，因此如果您想计算对象的实例 - 那么您是安全的并且额外的内存量是 O(1)。但是列表本身需要一些内存，因此如果您计算列表中“单元格”的数量 - 那么是的，您使用了 O(N) 额外的内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T04:47:35.983

这就是我所做的：

```
public LinkedList reverse1() {
    Node temp1 = tail;
    Node temp2 = head;
    Node temp3 = new Node(this.removeFirst());
    temp1.setNext(temp3);
    temp3.setNext(null);
    //head = temp1;
    tail = temp3;
    while(head != temp1) {
        temp2 = new Node(this.removeFirst());
        temp2.setNext(temp3);
        temp1.setNext(temp2);
        temp3 = temp2;
    }
    return this;
} 
```

这够好吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-04T14:18:41.547

这是我在 C# 中实现的线性时间和恒定空间中反转 LinkedList 的方法。我希望它有所帮助。我们只是颠倒节点之间的链接，使第一个节点在最后，最后一个节点在前。

```
 Node p1, p2, t1, t2;
        p1 = head;
        p2 = p1.next;
        while (p2 != null)
        {
            t1 = p2;
            t2 = p2.next;
            p2.next = p1;
            p1 = t1;
            p2 = t2;
        }
        head.next = null;
        head = p1; 
```

# ruby - 如何使用 Ruby 从包含撇号的字符串创建文件夹？

> ID：12362517
> 
> 赞同：1
> 
> 时间：2012-09-11T03:53:04.790
> 
> 标签：ruby, unix, escaping, text-processing, gsub

我有以下字符串：

```
"Gender and Women's Studies" 
```

我正在尝试将其转换为：

```
"Gender\ and\ Women\'s\ Studies" 
```

这样我就可以使用该字符串创建一个有效的 Unix 文件夹。

我将如何在 Ruby 中解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T04:05:44.087

我会用[`Dir.mkdir("Gender and Women's Studies")`](http://www.ruby-doc.org/core-1.9.3/Dir.html#method-c-mkdir).

如果您让 Ruby 完成工作，则无需逃避任何事情。如果您需要从命令行使用该文件，那么您需要处理转义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T05:45:59.993

如果可以，请避免这样做。尽管 Unix 可以使用这样的目录（文件夹是 Windows 所称的），但许多程序、脚本和实用程序的编写和测试就像目录（和文件）名称没有包括空格在内的标点符号一样，并且可能变得难以使用。

我用这样的程序和脚本操作文件系统，并且了解到 [a-zA-Z0-9_] 的名称（没有破折号“-”）给出的问题最少。

# .htaccess - 将 IP 重定向或指向另一台服务器

> ID：12362519
> 
> 赞同：4
> 
> 时间：2012-09-11T03:53:11.013
> 
> 标签：.htaccess, redirect, ip

我不确定这个问题是否应该在这里问，因为它与编码相关，所以如果我在错误的地方发帖，请建议我应该在哪里发帖。

我最近将我用来在泰国托管的服务器移到了 Godaddy，除了我的网络板（论坛）和以前的网址是[http://mydomainname.com/forum](http://mydomainname.com/forum)现在论坛没有与godaddy一起存在于新服务器中，但它确实存在于`forum`旧服务器中的目录调用中。我不想对我的 Godaddy 服务器进行加载，并想我是否仍然可以将它们托管在泰国服务器中，但不必更改旧 URL。

对于子域，我想我知道如何做到这一点，但我不知道如何通过指向另一台服务器但使用子目录来做到这一点。

我不确定我的问题是否令人困惑，但我想问的是如何指向另一台服务器让我的论坛在我的[http://mydomainname.com/forum上工作](http://mydomainname.com/forum)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T10:42:15.347

您通过在新服务器 htaccess 中添加类似这样的内容来要求新服务器充当旧服务器的代理：

```
RewriteEngine on
RewriteRule ^forum(/.*)?$ http://your.old.server.ip/forum$1 [L,P] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:01:55.447

这是将站点从一台服务器移动到另一台服务器时的典型问题。

简单的答案是 DNS 记录。您将不得不更改名称服务器详细信息并使其指向您想要的所需 IP。这样，您的 URL 将指向新 IP。您可以在任何您想要的地方托管该网站。

# ruby-on-rails - Rails：belongs_to 和 has_one 关联创建的方法

> ID：12362527
> 
> 赞同：2
> 
> 时间：2012-09-11T03:54:16.367
> 
> 标签：ruby-on-rails

我正在制作一个网址缩短器作为学习练习。除了访问模型（这对于这个问题并不重要）之外，它还有一个 Url 和一个 Link 模型，我已经加入了关联。Url 类属于 Link，Link 类有_one :url。

简而言之，问题是当我在 Link 类中调用 short 方法（来自 Url 控制器中的 create 方法）时，我收到此错误消息

```
undefined method `link' for #<ActiveRecord::Relation:0x00000102f648b8> 
```

应用程序跟踪指向 Link 类的“缩短”方法中的这一行（复制如下）

```
return url.link if url 
```

所以，我理解这个错误意味着我不能在“url”上调用“链接”。但是，我认为我创建的关联将允许我这样做。你能解释一下我做错了什么吗

**相关代码**

新形式

```
<%= simple_form_for @url do |f| %>
  <%= f.input :original,  :label => 'Original Link', :input_html => { :maxlength => 70 } %>
  <%#= f.input :custom,  :label => '(Optional) Create your own custom shortened link ' %>
  <%= f.button :submit %>
<% end %> 
```

创建方法url控制器

```
def create
    @url = Url.new(params[:url])
    @link = Link.shorten(@url) 

    respond_to do |format|
      if @url.save
        format.html { redirect_to action: "index", notice: 'Url was successfully created.' }
        format.json { render json: @url, status: :created, location: @url }
      else
        format.html { render action: "new" }
        format.json { render json: @url.errors, status: :unprocessable_entity }
      end
    end

  end 
```

网址类

```
class Url < ActiveRecord::Base
  attr_accessible :original

  belongs_to :link
end 
```

用缩短方法链接类

```
class Link < ActiveRecord::Base
  attr_accessible :identifier
  has_one :url
  has_many :visits

  def self.shorten(original, custom=nil)
    url = Url.find_by_original(original) 

    return url.link if url        #this is the problem line
    link = nil
    if custom
      raise 'Someone has already taken this custom URL, sorry' unless Link.find(:identifier => custom).nil?  #this  Link.find
      raise 'This custom URL is not allowed because of profanity' if DIRTY_WORDS.include? custom
      transaction do |txn|
        link = Link.new(:identifier => custom)
        link.url = Url.create(:original => original)
        link.save        
      end
    else
      transaction do |txn|
        link = create_link(original)
      end    
    end
    return link
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:11:58.923

你在它被创建之前传递`@url`给它。`Link.shorten`所以你`link`在一个 nil 对象上调用该方法。

`@url.save`如果你想让它工作，你需要把它放在后面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:15:49.907

您`Url.new(params[:url])`在`create`方法中正在创建一个`ActiveRecord`对象，但尚未将任何内容保存到数据库中。`Url.find_by_original(original)`方法中的方法`shorten`是在数据库中搜索`urls`表，但找不到，因为还没有保存 url `original`。您需要`url`在调用它之前保存`shorten`它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:41:17.233

您正在传递`@url`to`Link.shorten`而不是传递URL 字符串，并尝试通过匹配到字段`original`来查找现有 URL 。由于某种原因返回（我不知道为什么），而不是你所期望的。`@url object``original``ActiveRecord::Relation``nil`

我认为您应该在这里更改代码：

```
@link = Link.shorten(@url) 
```

到

```
@link = Link.shorten(@url.original) 
```

我认为您不必先保存`@url`，因为您只查找存储的 URL，而是要添加的新 URL。

# sql-server - 如何在 JPA 中自动提交 SQL Server 事务？

> ID：12362531
> 
> 赞同：1
> 
> 时间：2012-09-11T03:54:41.330
> 
> 标签：sql-server, hibernate, jpa

为什么我需要使用事务来持久化实体？有什么我可以添加到我的 persistence.xml 以自动提交的吗？

这不会插入：

```
em.persist(this); 
```

但这确实：

```
em.getTransaction().begin();
em.persist(this);
em.getTransaction().commit(); 
```

我想我最初的参考点是[这个 GWT doco](https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory)

```
public void persist() 
{
   EntityManager em = entityManager();
   try 
   {
     em.persist(this);
   } 
   finally 
   {
     em.close();    
   }  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:28:29.670

IMO 在 persistence.xml 中没有这样的设置

我认为这种模式是从 JDBC 事务管理中采用的，您可以在连接上设置 autocommit false，然后执行任意数量的查询。但是除非您在连接上调用提交，否则不会提交事务。如果 autocommit 为 false（这是默认值），则每个执行的语句都被隐式提交，如果我们有多个语句需要在原子操作中运行，我们不希望这种情况发生。

以您的示例为例，当您持久化对象时，该对象可能具有脏的关联并且也需要持久化。所以会有不止一个 sql 需要以原子方式运行。所以使用了上面提到的事务管理策略。

实体管理器（在 JPA 中）和会话 API（在 Hibernate 中）旨在抽象数据库上的 CRUD 操作。为了实际提交生成的 sql 语句，事务 API 被设计为对事务管理的抽象。我认为这种单独抽象的原因是事务通常有两种类型——资源本地事务和分布式事务。

事务管理基础架构需要以不同于分布式事务的方式处理资源本地事务。在资源本地事务中，发送到数据库的所有 sql 在连接上调用提交时由数据库提交，或者在连接上调用回滚时回滚。在分布式事务管理中，事务管理器组件是管理向所有参与者提交或回滚信号的组件。

在 JPA 中，您可以将事务类型称为

```
<persistence-unit transaction-type="RESOURCE_LOCAL  or JTA">
 .................................
</persitence-unit> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T06:29:29.163

JPA 没有定义此类行为；根据规范，任何“persist()”都被定义为等待下一个事务。显然，JPA 的某些实现（例如[DataNucleus JPA](http://www.datanucleus.org/products/accessplatform_3_1)）确实提供了该（自动提交）设施，但它超出了（不是）JPA 规范的一部分

# android - 如何以编程方式获取APK的应用程序名称（未安装）

> ID：12362534
> 
> 赞同：3
> 
> 时间：2012-09-11T03:55:12.247
> 
> 标签：android

基于[如何在android中获取应用程序的名称？](https://stackoverflow.com/questions/7802780/how-to-get-the-name-of-the-application-in-android).

我有这个片段。`和路径| 是 APK 的位置。

```
PackageInfo info = getPackageManager().getPackageArchiveInfo(andPath, 0);
ApplicationInfo appinfo = info.applicationInfo;
String packageName = getPackageManager().getApplicationLabel(appinfo).toString();

PackageManager pm=getPackageManager();
ApplicationInfo ai;
try {
     ai = pm.getApplicationInfo(packageName, 0);
} catch (final NameNotFoundException e) {
     ai = null;
}

final String applicationName = (String) (ai != null ? pm.getApplicationLabel(ai) : "(unknown)"); 
```

`applicationName`将包名返回给我。

```
CharSequence c = pm.getApplicationLabel(pm.getApplicationInfo(info.processName,PackageManager.GET_META_DATA)); 
```

`c`返回我`null`。

有谁知道我在这里想念什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-05-20T11:42:28.013

这是您可以从`not yet installed`APK 文件中获取应用程序标签的方法：

```
public static String getAppLabel(PackageManager pm, String pathToApk) {  
    PackageInfo packageInfo = pm.getPackageArchiveInfo(pathToApk, 0);

    if (Build.VERSION.SDK_INT >= 8) {
        // those two lines do the magic:
        packageInfo.applicationInfo.sourceDir = pathToApk;
        packageInfo.applicationInfo.publicSourceDir = pathToApk;
    }

    CharSequence label = pm.getApplicationLabel(packageInfo.applicationInfo);
    return label != null ? label.toString() : null;
} 
```

`applicationInfo`SDK 8 之前的版本无需打补丁。更多详情请查看[此问题](http://code.google.com/p/android/issues/detail?id=9151)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-11T04:35:30.327

如果您在这里遇到问题，我会发布完整代码以获取应用程序名称

**它返回 ApplicationInfo**

```
public List<ApplicationInfo> getApplicationList(Context con){
        PackageManager p = con.getPackageManager(); 
        List<ApplicationInfo> info = p.getInstalledApplications(0);
        return info;
    } 
```

**它返回应用程序名称**

```
public String applicationLabel(Context con,ApplicationInfo info){
        PackageManager p = con.getPackageManager();
        String label = p.getApplicationLabel(info).toString();
        return label;
    } 
```

**在您的 onCreate 函数上粘贴以下代码**

```
List<ApplicationInfo> info = new ArrayList<ApplicationInfo>();

        info = list.getApplicationList(this);
        LinearLayout layout = (LinearLayout)findViewById(R.id.content);
        layout.setOrientation(1);
        int size = info.size();
        Log.d("size",String.valueOf(size));
        for(int i=0;i<size;i++){
            Log.d("Val of I",String.valueOf(i));
            String appname = list.applicationLabel(this,info.get(i)).toString();
            Log.d("AppName",appname);
            TextView tv = new TextView(this);
            tv.setText(appname);
            layout.addView(tv);
        }

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:09:46.400

```
public String applicationLabel (ApplicationInfo info){
     PackageManager p = con.getPackageManager();
     return p.getApplicationLabel(info).toString();
} 
```

我希望你得到应用程序信息，将应用程序信息传递给这个函数，它将给出应用程序名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-08T15:34:57.047

```
String title = getResources().getString(R.string.app_name); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-11T06:59:40.373

只需使用正则表达式获取名称并与应用程序标签进行比较。

# sql-server - ASP.NET MVC Html.DropDownList 不显示 SQL 表中的值

> ID：12362539
> 
> 赞同：0
> 
> 时间：2012-09-11T03:55:54.380
> 
> 标签：sql-server, asp.net-mvc, html-select

我的应用程序是使用 ASPX 视图的 MVC3。我有两个页面，创建和编辑，使用以下下拉列表：

```
<%= Html.DropDownList("VesselDiameter", new SelectList(new[] { "", "1", "2", "3"}))%> 
```

它在创建视图中工作并将数据保存到 MS Sql 表中，但是该值不会显示在编辑视图中。如果我使用，

```
<%: Html.EditorFor(model => model.pRCA.VesselDiameter) %> 
```

我在另一个视图中使用了类似的下拉列表并且它有效，但模型不同：

```
<%= Html.DropDownList("Vessel", new SelectList(new[] { "", "1", "2", "3"}))%> 
```

代替

```
<%: Html.EditorFor(model => model.Vessel) %> 
```

价值就在那里！将不胜感激您的建议。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:59:14.353

对于 Model.pRCA.VesselDiameter，mvc 生成此 id（“pRCA.VesselDiameter”），因此您应该将 pRCA 添加到 id 值

```
<%= Html.DropDownList("pRCA.VesselDiameter", new SelectList(new[] { "", "1", "2", "3"}))%> 
```

# python - Python服务器“通常只允许每个套接字地址使用一次”

> ID：12362542
> 
> 赞同：35
> 
> 时间：2012-09-11T03:56:38.170
> 
> 标签：python, sockets, connection, webserver

我正在尝试在 python 中创建一个非常基本的服务器，它在端口上侦听，当客户端尝试连接时创建 TCP 连接，接收数据，发送回一些东西，然后再次侦听（并无限期地重复该过程）。这是我到目前为止所拥有的：

```
from socket import *

serverName = "localhost"
serverPort = 4444
BUFFER_SIZE = 1024

s = socket(AF_INET, SOCK_STREAM)
s.bind((serverName, serverPort))
s.listen(1)

print "Server is ready to receive data..."

while 1:
        newConnection, client = s.accept()
        msg = newConnection.recv(BUFFER_SIZE)

        print msg

        newConnection.send("hello world")
        newConnection.close() 
```

有时这似乎工作得很好（如果我将浏览器指向“localhost:4444”，服务器会打印出 HTTP GET 请求，而网页会打印出文本“hello world”）。但是，当我在最后几分钟关闭服务器后尝试启动服务器时，偶尔会收到以下错误消息：

```
Traceback (most recent call last):
  File "path\server.py", line 8, in <module>
    s.bind((serverName, serverPort))
  File "C:\Python27\lib\socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
error: [Errno 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted 
```

我正在使用 Windows 7 在 python 中编程。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2016-06-13T21:11:03.743

在 Windows 上，您可以尝试以下步骤：

## 1.查看哪个进程使用了​​该端口。

```
# 4444 is your port number
netstat -ano|findstr 4444 
```

你会得到这样的东西：

```
# 19088 is the PID of the process
TCP    0.0.0.0:4444           *:*                                    19088 
```

## 2.杀死这个进程

和：

```
tskill 19088 
```

或者：

```
taskkill /F /PID 19088 
```

祝你好运。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-09-11T04:07:35.983

在调用 bind() 之前启用[SO_REUSEADDR](http://hea-www.harvard.edu/%7Efine/Tech/addrinuse.html)套接字选项。这允许地址/端口立即被重用，而不是停留在 TIME_WAIT 状态几分钟，等待迟到的数据包到达。

```
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-11T08:45:48.240

在@JohnKugelman 发布[的文章](http://hea-www.harvard.edu/~fine/Tech/addrinuse.html)中指出，即使启用后，`SO_REUSEADDR`您也无法使用套接字连接到与以前相同的远程端：

> SO_REUSADDR 允许您使用卡在 TIME_WAIT 中的端口，但您仍然不能使用该端口建立与它连接的最后一个位置的连接。

我看到你只是在测试/玩弄。但是，为避免此错误，您确实需要确保正确终止连接。你也可以弄乱操作系统的 tcp 时间：[http ://www.linuxquestions.org/questions/linux-networking-3/decrease-time_wait-558399/](http://www.linuxquestions.org/questions/linux-networking-3/decrease-time_wait-558399/)

出于测试目的，如果您只是`serverPort`以循环方式更改您的方式也可以，您怎么看？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-06-24T09:57:50.063

这可能是因为您尚未终止服务器代码并尝试在另一个 cmd 上再次运行它。服务器不能托管在相同的端口号上，请尝试杀死以前的托管服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-11T04:15:11.967

关闭套接字很重要（特别是在 Windows 上）。否则，您必须在关闭 Python 后等待它超时。

将：

```
try:
    while 1:
        newConnection, client = s.accept()
        msg = newConnection.recv(BUFFER_SIZE)

        print msg

        newConnection.send("hello world")
        newConnection.close()
finally:
    s.close() 
```

帮助？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-17T15:59:14.513

我将端口号更改为不同的端口号，它可以工作。

```
if __name__ == '__main__':
    socketio.run(app, debug = True, use_reloader = False, port=1111) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-24T08:49:35.350

如果您尝试重新运行服务器而不停止服务器的最后一刻，它将无法正常工作。如果你想停止当前的瞬间去

**外壳->重新启动外壳。**

如果您已经在没有停止服务器的情况下关闭了 shell，请转到**任务管理器**并在后台处理器中**结束任务**python 进程。这将停止服务器的最后一刻。

# jquery - jQuery Multidatepicker 日历在日期选择之间打开和关闭

> ID：12362543
> 
> 赞同：3
> 
> 时间：2012-09-11T03:56:44.493
> 
> 标签：jquery, widget, datepicker, jquery-multidatespicker

我正在使用[Multiple-Dates-Picker-for-jQuery-UI](https://github.com/dubrox/Multiple-Dates-Picker-for-jQuery-UI)。选择多个日期时，日历会在每个选择之间打开和关闭。如何更正此问题，以使日历保持打开状态，直到选择所有日期，然后仅在浏览器中的其他位置单击它时才关闭。

这是我的代码：

```
<div class="row">
    <div class="span4">
         <h3>On <a href="#" class="popover-tip" rel="popover"
                 data-content="Pick a date for your night out."
                 data-original-title="Date">
             <i class="icon-question-sign"></i></a></h3>
         <input type="text" class="datepicker"> 
```

```
// Date picker - allows for multi select
$('.datepicker').multiDatesPicker({
    altField: '#altfield',
    dateFormat: "DD, d MM, yy",

    onBeforeShow: function () {
        $('#inputDate').DatePickerSetDate($('#inputDate').val(), true);
    },
    onChange: function (formated, dates) {
        $('#inputDate').val(formated);
        if ($('#closeOnSelect input').attr('checked')) {
            $('#inputDate').DatePickerHide();
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:06:26.777

[尝试从http://multidatespickr.sourceforge.net](http://multidatespickr.sourceforge.net)获取 MultiDatesPicker 。那里的版本对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T00:52:57.203

如果我理解正确，您的要求是您希望日历永久打开。

为此，您只需要更改 div 的输入。

在您的 html 中，而不是

```
 <input type="text" class="datepicker"> 
```

把这个

```
<div class="datepicker" style="display:block;"></div> 
```

如果您想在选择日期时打开它然后关闭它，您将不得不以编程方式显示/隐藏它，可能使用 onfocus 和 onblur js 事件或 jQuery。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T09:26:54.847

我知道迟到的答案，但你可以删除第 148 行：

```
(setTimeout('$("#'+inst.id+'").datepicker("show")',50);) 
```

从`jquery-ui.multidatespicker.js`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-31T21:30:36.247

可能重复：

另一个答案指出`jQuery UI defaulting to today's date when it can't parse several dates`。的代码修复在`_setDateFromField`这里

[多个日期选择器 - 月份跳跃问题](https://stackoverflow.com/questions/22199601/multiple-date-picker-months-jumping-problems)

# iphone - Xcode 4.5 是否自动设置 Retina 图像

> ID：12362544
> 
> 赞同：0
> 
> 时间：2012-09-11T03:56:48.293
> 
> 标签：iphone, xcode, ios-simulator, retina-display

如何使 Mainstoryboard 中的 UIImage 变成视网膜（我有两个图像文件，我在 UIImage 设置中选择了视网膜图像）。当我启动我的应用程序时它仍然不是视网膜？对不起，如果这个问题没有意义。

编辑：如果您将视网膜图像称为 YourImageName@2x，Xcode 会自动将您的图像设置为视网膜。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T04:17:56.707

实际上你不需要担心视网膜图像......考虑你有一个名为**image.png**的图像。您可以在**图像视图**中使用相同的图像**“image.png”**。现在根据您的**设备内容比例**，它将选择**普通图像，即 image.png 或视网膜图像，即 image@2x**。**iphone 4 及以上的****内容比例为 2**，其他**将使用非视网膜图像**。

 ******* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:06:46.857

您不需要设置视网膜图像，只需将它们命名为 image.png 和 image@2x.png 并将 image.png 设置为 UIImageView 中的图像，它会自动检测设备并相应地获取它们。******

# php - PHP上传文件并逐行读取

> ID：12362549
> 
> 赞同：1
> 
> 时间：2012-09-11T03:57:15.710
> 
> 标签：php, html

我在这里遇到了一个非常奇怪的问题。我正在使用下面的代码通过 php 将 txt 文件上传到我的服务器。

```
 <form enctype="multipart/form-data" action="index.php" method="POST">
        <input type="file" name="uploadfile">
        <button>Submit</button>
    </form> 
```

上传文件后（工作正常），我通过以下代码将内容转换为数组：

```
$fp = @fopen($file, 'r'); 

if ($fp) { 
    $domains = explode("\n", fread($fp, filesize($file))); 
} 
```

然后我运行 preg_match 来过滤数组：

```
$list = preg_grep('/^[a-z]+\.com$/', $domains); 
```

我确认 $domains 正在填充 txt 文件中的数据，但是当我运行 print_r($list) 它只返回“array()”

当我使用 FTP 上传完全相同的文本文件并运行 print_r($list) 时，它工作正常。

我还注意到，当我使用 FTP 客户端上传相同的文本文件时，“domains.txt”的文件大小比使用 html 表单上传时要小。知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:02:59.747

这可能与 FTP 客户端在 UNIX 和 Windows 之间自动更改行尾有关。

要解决此问题，只需在使用`trim`前清理每一行`preg_grep`。就像是：

```
foreach ($domains as $key => $domain) {
    $domains[$key] = trim($domain);
}

// or better use array_walk and closures PHP 5.3+
array_walk($domains, function(&$e) { $e = trim($e); }); 
```

问题可能是因为您的正则表达式具有明确的行首和行尾锚点。

`file`顺便说一句，您只需使用该函数即可将整个文件加载到一个语句中的行数组中。

```
$domains = file($file); 
```

# c# - 为什么“资源字典”不起作用？

> ID：12362552
> 
> 赞同：0
> 
> 时间：2012-09-11T03:57:28.237
> 
> 标签：c#, .net, wpf, xaml, resourcedictionary

我的程序运行良好。

```
 <Window.Resources>    

        <ResourceDictionary Source="GlassButton.xaml">
        </ResourceDictionary>
    </Window.Resources> 
```

但在“MainWindow”上添加 DataGrid 后，字符串中显示错误：

```
 <ResourceDictionary Source="GlassButton.xaml"> 
```

添加 DataGrid 后，Window.Resources 的部分发生了变化，变成了这样：

```
<Window.Resources>            
        <ResourceDictionary Source="GlassButton.xaml">
            <my:DepartmentDataSet x:Key="DepartmentDataSet" />
            <CollectionViewSource x:Key="DepViewSource" Source="{Binding Path=DEP, Source={StaticResource DepartmentDataSet}}" />
        </ResourceDictionary> 
```

错误消息显示：“属性“System.Windows.ResourceDictionary.DeferrableContent”被称为异常。”：行数“10”和行数“29”。致以最诚挚的问候</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T12:17:38.807

我找到了原因。我需要将代码放入“< ResourceDictionary.Merged >”。有了这个添加的代码程序工作得很好！

```
<ResourceDictionary>
    <ResourceDictionary.MergedDictionaries>
             <ResourceDictionary Source="GlassButton.xaml"/>
    </ResourceDictionary.MergedDictionaries>
            <my:DepartmentDataSet x:Key="DepartmentDataSet" />
            <CollectionViewSource x:Key="DepViewSource" Source="{Binding Path=DEP, Source={StaticResource DepartmentDataSet}}" />
        </ResourceDictionary> 
```

# windows-8 - 如何在 Windows8 应用程序中使用 ReadTextAsync（StorageFile 文件）同步获取返回值

> ID：12362553
> 
> 赞同：3
> 
> 时间：2012-09-11T03:57:33.573
> 
> 标签：windows-8

基本上，我的代码是一个非常简单的测试，用于在 Windows 8 风格的应用程序中写入和读取文件。这里，首先将字符串“Jessie”写入dataFile.txt，然后程序读取该字符串，以便更新xaml 中Textblock 的Text 属性。

从 msdn 示例中，我知道 WriteTextAsync 和 ReadTextAsync 用于在 Windows 8 编程中对文件进行 dataFile 访问。但是，测试结果是WriteTextAsync函数确实有效而ReadTextAsync没有（我可以看到“Jessie”已写入dataFile.txt的真实txt文件，但变量str始终为null）。

我在互联网上看到过类似的问题，但这些问题的答案对我来说都没有意义。许多答案提到问题可能是 ReadTextAsync 是一个异步函数，例如使用 Task 但他们的所有解决方案都不适用于我的代码。我的问题是如何使用 ReadTextAsync 同步获取返回值，或者是否有任何其他方法可以从 Windows8 应用程序中的 txt 文件读取数据，以便我可以同步更新 UI？

这是代码：

```
public sealed partial class MainPage : Page
{  
    Windows.Storage.StorageFolder localFolder = Windows.Storage.ApplicationData.Current.LocalFolder;

    public MainPage()
    {
        this.InitializeComponent();

        Write();
        Read();
    }

    async void Write()
    {
        StorageFile sampleFile = await localFolder.CreateFileAsync("dataFile.txt", Windows.Storage.
                  CreationCollisionOption.ReplaceExisting);

        await FileIO.WriteTextAsync(sampleFile, "Jessie");
    }

    async void Read()
    {
        try
        {      
            StorageFile sampleFile = await localFolder.GetFileAsync("dataFile.txt");
            string str = await FileIO.ReadTextAsync(sampleFile);

            Text.DataContext = new Test(str, 1);
        }
        catch (FileNotFoundException)
        {

        }
    }

    public class Test
    {
        public Test() { }

        public Test(string name, int age)
        {
            Name = name;
            Age = age;
        }

        public string Name { get; set; }
        public int Age { get; set; }

        // Overriding the ToString method
        public override string ToString()
        {
            return "Name: " + Name + "\r\nAge: " + Age;
        }
    }
} 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:32:10.853

You should have your `async` methods return `Task` rather than `void` whenever possible. You may find my [intro to async/await post](http://nitoprograms.blogspot.com/2012/02/async-and-await.html) helpful. I also have a blog post on [asynchronous constructors](http://blog.stephencleary.com/2013/01/async-oop-2-constructors.html).

Constructors cannot be `async`, but you can start an asynchronous process from a constructor:

```
public MainPage()
{
  this.InitializeComponent();
  Initialization = InitializeAsync();
}

private async Task InitializeAsync()
{
  await Write();
  await Read();
}

public Task Initialization { get; private set; }

async Task Write() { ... }
async Task Read() { ... } 
```

# mysql - MYSQL - 计算单行中包含相同数据的列

> ID：12362557
> 
> 赞同：-2
> 
> 时间：2012-09-11T03:57:54.970
> 
> 标签：mysql

我有一个包含 151 列的表，第一列是与用户绑定的主 ID。

该表的目的是跟踪一个人是否完成了一项任务，共有 150 个任务。我可能会有成千上万的人为他们自己的任务列表设置一个独特的行。

这些列填充了从 0 到 3 的值，用于标识每个任务的完成级别。

我需要运行一个查询，该查询将清楚地计算特定行中“3”的数量并产生一个数字。然后，我将把这个数字除以 150，得到特定玩家的完成百分比。

我将把这个查询嵌入到一个 num_row 查询中，该查询在一个列表中显示所有用户，上面需要的查询计数作为显示的列之一。

我之前在没有 num_row 列表的页面上获得了以下查询，但是当我将查询嵌入到 num_row 列表中时，它只显示数百行中的第一行。

我的错误在哪里/什么？

```
$query9 = "SELECT * FROM ztnexus_ztnprints WHERE playerbp_id='$player_id' ";
$result9 = mysql_query($query9);
$numfields9 = mysql_num_fields($result9);
$row = 0;
for($i=0; $i < $numfields9; $i++){ if(mysql_result($result9, $row, $i) == '3'){ $name[$bpcount] = mysql_field_name($result9, $i); $bpcount++; } }
if (empty($bpcount)) { $bpcount = 0; }
$bp1 = ($bpcount / 150) ;
$bp2 =  number_format($bp1, 2) ;
$blueprints = ($bp2 * 100) ; 
```

'$blueprints' 是所需的百分比输出。

谢谢你。

****编辑**** 我将添加我的表格的可视化示例：

```
FIELDS --->  | user_id  | task_1  | task_2  | task_3  | etc...  |
             ----------------------------------------------------
ROWS ----->  |    1     |   2     |    3    |    0    |   2     |
             |    20    |   3     |    2    |    3    |   1     |
             |    55    |   3     |    1    |    3    |   2     |
             ---------------------------------------------------- 
```

我需要我的查询来计算每个用户的三分之二。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:01:58.450

您的数据模型并不真正适合您要完成的任务，并且随着代码的发展添加任务需要更改数据模型，这在某种意义上是脆弱的。

我建议改为创建主/详细（或父/子）表关系。有一个包含玩家信息的表格，另一个包含任务完成信息的表格（每个玩家每个任务一行，由玩家 ID 链接）。

然后这种类型的查询就变成了对子表的非常简单的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T00:12:31.787

感谢您的帮助，但我最终使用了

`SUM( IF(column=3,1,NULL) + IF(column2=3,1,NULL)=`ETC....

我还弄清楚了为什么我以前的代码与 numrow 列表冲突，我`i=0;`在列表查询中与

`for($i=0; $i < $numfields9; $i++)`

从列计数查询。

由于所有表格为我的网站捆绑在一起的方式，我只需要以这种方式工作。再一次感谢你的帮助！

# mysql - 从一组相似的行中选择每分钟（日期）？

> ID：12362558
> 
> 赞同：0
> 
> 时间：2012-09-11T03:57:56.890
> 
> 标签：mysql

这是表`Posts`结构（还有其他列对问题不重要）：

```
Verb | Object | Date 
```

我按动词分组，然后按对象分组，对所有相似的行进行分组，这是我当前的查询：

```
SELECT * FROM Posts GROUP BY Verb, Object 
```

我需要知道每组中最旧行的日期。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:01:05.033

怎么样

```
SELECT  Verb, 
        Object, 
        MIN(date) OldestDate
FROM    Posts
GROUP BY    Verb, Object 
```

看看[GROUP BY（聚合）函数](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_min)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:01:45.627

要获取每个组中最早的日期，请尝试以下操作：

```
SELECT Verb, Object, MIN(`date`) AS min_date
FROM Posts
GROUP BY Verb, Object; 
```

如果要获取每个组中日期最早的记录，请尝试以下操作：

然后重启 MySQL 服务器。

```
SELECT a.*
FROM Posts a
     INNER JOIN (SELECT Verb, Object, MIN(`Date`) AS `Date`
                 FROM Posts
                 GROUP BY Verb, Object
                ) b
                ON a.Verb =  b.Verb
                   AND a.Object = b.Object
                   AND a.`Date` = b.`Date`; 
```

# objective-c - NSXMLParser 总是返回错误：NSXMLParserErrorDomain 4

> ID：12362560
> 
> 赞同：1
> 
> 时间：2012-09-11T03:58:14.023
> 
> 标签：objective-c, xml, xml-parsing, plist, nsxmlparser

我正在使用 NSXMLParser 来解析 Mountain Lion 中 Messages 的聊天日志。该文件的扩展名为 .ichat ...

这是我的代码

```
- (void) doParse:(NSData *)data {

NSString *dString;
UtilClass *Debug = [[UtilClass alloc] init];

/*
NSString *dictionaryString = [data description];
dString = dictionaryString;
[Debug debugLog:dString];
*/

dString = @"xmlparser: 10 \n";
[Debug debugLog:dString];

// create and init NSXMLParser object
NSXMLParser *nsXmlParser = [[NSXMLParser alloc] initWithData:data];

// create and init our delegate
XMLParser *parser = [[XMLParser alloc] initXMLParser];

// set delegate
[nsXmlParser setDelegate:parser];

// parsing...
BOOL success = [nsXmlParser parse];

// test the result
if (success) {

    dString = @"xmlparser: YES \n";
    [Debug debugLog:dString];
    // get array of users here
    //  NSMutableArray *users = [parser users];
} else {
    NSError *error2 = [nsXmlParser parserError];
    dString = @"xmlparser: ERROR :: ";
    dString = [dString stringByAppendingFormat:@"%@\n",error2];

    [Debug debugLog:dString];

    dString = @"xmlparser: NO \n";
    [Debug debugLog:dString];
}

[parser release];
[nsXmlParser release]; 
```

}

下面是如何创建 NSData 并将其发送到上面的方法

```
NSString *logPath = @"~/Library/Messages/Archive/2012-09-06/anything on 2012-09-06 at 10.45.ichat";

    NSData *testData = [[[NSData alloc] initWithContentsOfFile:[logPath stringByExpandingTildeInPath]]autorelease];

            [self doParse:testData]; 
```

最后，我总是收到“NSXMLParserErrorDomain 4”，这意味着解析器得到了一个空文档。但是，我在它通过 t0 解析器之前记录了“数据”变量，并且数据看起来很好。这里可能是什么问题？

XML 文档的前几行

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>$archiver</key>
    <string>NSKeyedArchiver</string>
    <key>$objects</key>
    <array>
        <string>$null</string>
        <dict> 
```

# unix - 从 unix 命令行将毫秒时间戳转换为日期

> ID：12362562
> 
> 赞同：37
> 
> 时间：2012-09-11T03:58:20.760
> 
> 标签：unix, date, awk

我知道

```
date -d @<timestamp in seconds> 
```

和

```
awk '{print strftime("%c", <timestamp in seconds>)}' 
```

但是如果我有毫秒怎么办。是否有简单的方法可以在不删除毫秒时间戳的最后三个字符的情况下做到这一点（并不是说删除字符很困难，但我认为对于这样一个简单的任务会有一个一步的方法）？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-11T07:41:19.123

您可以除以 1000，而不是删除字符：

```
awk '{print strftime("%c", ( <timestamp in milliseconds> + 500 ) / 1000 )}' 
```

或者：

```
date -d @$(  echo "(MilliSecondTimeStamp + 500) / 1000" | bc) 
```

或（MacOS）：

```
gdate -d @$(  echo "(MilliSecondTimeStamp + 500) / 1000" | bc) 
```

编辑：调整商而不是除法。Edit2：谢谢 zeekvfu，已修复。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-02-10T18:23:33.010

我在 Mac 上的 bash 配置文件中有什么：

```
day() {
  date -r $(($1 / 1000))
} 
```

`day 1486743904359`返回`Fri Feb 10 08:25:04 PST 2017`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-09-11T03:59:28.610

```
perl -e 'print scalar localtime(<timestamp> / 1000)' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-10-29T13:40:01.143

在 BASH 中

```
ms_date=1603884641215; date -d @$(((ms_date + 500)/1000)) 
```

解释：

1.  `date -d @number-of-seconds`接收秒数（自纪元）并返回格式化日期
2.  `$(())`表示 bash 中的数学插值，例如`echo $((1 + 2))`
3.  将毫秒除以 1000 以获得所需的秒数测量值
4.  添加 500 是为了以毫秒为单位，四舍五入到最接近的秒数

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-30T16:06:54.180

这在 bash 中对我很有用，而且比上面接受的答案要简单一些：

```
date -r $(( (<timestamp in milliseconds> + 500) / 1000 )) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-04T14:21:06.290

扩展 Greg 的 perl 方法，我使用这个 Perl 脚本[https://github.com/moose1089/epoch2iso](https://github.com/moose1089/epoch2iso)自动扫描纪元时间戳并转换为 ISO8061。

此脚本处理秒和毫秒。

当它转换它找到的任何数字时，您不必使用时间戳提取特定字段，但相反它也可能转换不打算成为时间的数字。

# windows-phone-7 - Windows phone 7 3d游戏开发

> ID：12362565
> 
> 赞同：0
> 
> 时间：2012-09-11T03:59:08.580
> 
> 标签：windows-phone-7, 3d, game-engine

我正在寻找任何用于在 windows phone 7 中开发 3d 游戏的 IDE/工具/游戏引擎，比如 Unity3d？请帮助一些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:01:32.837

Windows Phone 7 不支持本机代码，因此没有移植很多工具/引擎（Windows Phone 8 中可能会发生变化）。在 WP7 上开发 3D 游戏的最佳方法是使用 Microsoft XNA 4。

# c++ - 更改向量中字符串的大小

> ID：12362575
> 
> 赞同：2
> 
> 时间：2012-09-11T04:00:45.987
> 
> 标签：c++, stl

当一个或多个元素改变大小时，向量会发生什么？

详细说明，

```
#include <string>
#include <vector>
using namespace std;
int main() {
    vector<string> v;
    v.push_back("first string");
    v.push_back("2nd string");
    v[0] += " has increased in size";
} 
```

“v[0] += ...”会发生什么？是否会进行大规模重新分配，以保持字符串和向量中的内存连续？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-11T04:05:15.113

中不会有内存重新分配，`vector`几乎可以肯定会重新分配`string`，尽管标准没有说明这一点。字符串就像一个向量，因为它将内容与字符串对象本身分开。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T04:04:47.560

No.`string`将其实际字符串数据存储在单独分配的内存中（模短字符串优化）。对象的实际大小永远不会改变，并且在编译时是固定的。任何此类动态调整大小都是使用单独分配的内存或对象层次结构来完成的（例如，set/map 使用节点树，list 使用节点的双链表等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T04:38:13.220

> 是否会进行大规模重新分配，以保持字符串和向量中的内存连续？

向量的元素是连续的，但在每个包含的字符串中都有一个指向动态分配存储的指针，其中存储了文本内容（假设字符串不是空的，也不是短到足以放入固定大小的内部缓冲区 - 一种已知的技术作为“短字符串优化”，实现可能但不需要使用）。

现在，对于向量和字符串，重要的是要了解当前大小（元素数量/`char`数据）和容量（已经保留的堆数量以及容器可以增长而无需分配的堆数量）之间的差异一个新的堆区域并移动元素。

因此，如果现有容量足够，则字符串连接就位。如果容量必须增加，则该字符串指向动态内存的指针被更新以寻址新分配的更大堆区域，文本内容被复制到其中，然后释放原始堆区域。

这些`push_back()`操作可能会导致向量重新分配，但字符串对象“拥有”单独的堆内存块。

如果你想知道你的具体实现在做什么，你可以打印出你的容器`size()`和`capacity()`操作之前和之后，以及第一个元素的地址......不过，容量超过大小之后的数量标准未指定重新分配，因此甚至可能随编译器标志/版本、操作系统等而改变。

从图表上看，像这样：

```
VECTOR:                /-------->[first string's text]...extra capacity...
[ first string object /]
[    second string object   \]
...extra vector capacity...  \-->[second string's text]...extra capacity... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T04:30:42.173

`string`对象是固定大小的。如果包含的字符串不适合字符串实现提供的内部存储（如果有），则单独分配。它与任何其他字符串存储都不连续，至少不是故意的。

# android - 我在哪里保存适用于 Android 的集中式图像？

> ID：12362576
> 
> 赞同：1
> 
> 时间：2012-09-11T04:00:53.743
> 
> 标签：android

想想 Pinterest，当有人拍照并上传该照片时，它会保存在哪里？可能是一个数据库（mysql？）。我正在尝试做类似的事情，但不熟悉我有哪些选择。

我知道 SQLite 是中央 android 数据库，但是当存储在手机外部时，哪个数据库最常用？有没有我可以阅读的参考资料？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:04:19.540

Pinterest 等应用程序将其数据存储在中央服务器上。他们使用的技术与 Android 没有任何关系，他们的客户端软件可以是 Android 或 iPhone 应用程序、网页等。

一种流行的解决方案（由 PhotoBucket、SmugMug 等服务使用）是[Amazon Web Services（通常称为 AWS）](http://aws.amazon.com/what-is-aws/)。特别是，查看他们名为 S3 的文件存储服务。[你可以在这里](http://aws.amazon.com/s3/)阅读它以及如何使用它。

还可以使用运行 SQL 数据库的服务器和某种 Web 服务器来保存和检索数据。一个常见的解决方案是[LAMP](http://en.wikipedia.org/wiki/LAMP_%28software_bundle%29)，它包括一个 MySQL 服务器。这种方法更加亲力亲为，但也有一些缺点，包括需要管理服务器并确保其正常运行时间，以及在用户群增长后负责扩展服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:07:47.010

大多数数据库引擎都有一个类型：BLOB（二进制长对象），它完全按原样存储所有内容。因此，您可以保存图像、A 文件（pdf、exe 或所有内容！）、...

要了解有关 sqlite 中 BLOB 的更多信息，请参阅：[http ://www.sqlite.org/datatype3.html](http://www.sqlite.org/datatype3.html)

# windows-8 - 我可以使用 URL 打开 Windows 8 应用程序吗？

> ID：12362583
> 
> 赞同：6
> 
> 时间：2012-09-11T04:01:40.887
> 
> 标签：windows-8, sharing

我正在创建一个具有共享会话功能的应用程序。例如私人应用程序到应用程序聊天会话......

我会启动应用程序并创建一个“聊天室”，然后通过电子邮件与某人“分享”。我想做的是创建一个 URL，当单击它时，它会在您的计算机上打开应用程序……如果我邀请您到我的“聊天室”。

我在网上四处逛逛，但在任何地方都没有看到这种行为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T15:41:46.993

通过在清单中添加一个特殊部分，并确保在激活处理程序中处理正确的激活类型，您可以使用 Metro 应用程序轻松简单地完成此操作。

您可以使用 VS 编辑器轻松添加到清单中：

*   通过在解决方案资源管理器上双击清单来打开清单
*   选择“声明”选项卡
*   在“可用声明”下选择协议，然后单击添加
*   将名称字段设置为所需的协议。例如“myawesomeapp”（这会给你类似的网址`myawesomeapp://foo/bar/baz`）

要处理此协议，您需要查找激活类型“协议”。这在您的激活处理程序中，并且在“种类”属性中。有关 JavaScript 和 C#/C++/VB的 MSDN[的](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh779670%28v=win.10%29.aspx)完整详细信息（prog. lang. switch 在右上角）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:03:36.763

您可以让您的应用程序安装协议处理程序。

[http://msdn.microsoft.com/en-us/library/aa767914(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa767914(v=vs.85).aspx)

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb266526(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb266526(v=vs.85).aspx)

由于您的应用程序必须安装在两台计算机上，因此两台计算机都安装了协议处理程序。

协议处理程序允许您定义一个新的协议名称，类似于 http: 或 ftp:，并让您的应用程序处理对该协议的请求。我曾经为[Enterprise Architect](http://www.sparxsystems.com.au/)写过一个，它允许用户使用 ea://MyProjectName?diagram=SomeDiagram 格式共享项目中图表的链接。

您可以在此处查看该协议处理程序：

[http://sourceforge.net/projects/eaprotocol/](http://sourceforge.net/projects/eaprotocol/)

# c - SetupDiGetDriverInfoDetail 返回 ERROR_INSUFFICIENT_BUFFER

> ID：12362586
> 
> 赞同：0
> 
> 时间：2012-09-11T04:01:56.477
> 
> 标签：c, winapi, device-driver, wdk

我曾经`SetupDiGetDriverInfoDetail`检索过驱动程序的详细信息。我为此使用了以下代码片段。但是每次我执行我的 exe 时，我都会得到 `ERROR_INSUFFICIENT_BUFFER`. 如何解决这个问题？

> SetupDiGetDriverInfoDetail(hDevInfo, &DeviceInfoData, &drvInfoData, &drvInfoDetail, sizeof(drvInfoDetail), NULL);

谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T06:12:15.323

首先，阅读 Microsoft 对[SetupDiGetDriverInfoDetail 函数](http://msdn.microsoft.com/en-us/library/windows/hardware/ff551973%28v=vs.85%29.aspx)可能返回 ERROR_INSUFFICIENT_BUFFER 的解释。其次，编写代码调用它两次。

第一次使用指向 DWORD 变量的指针调用 SetupDiGetDriverInfoDetail，您将在其中找出所需的字节数。为足够大的变量分配内存并再次调用 SetupDiGetDriverInfoDetail。

# wordpress - Wordpress：不小心设置了站点 URL 和 HOME

> ID：12362602
> 
> 赞同：0
> 
> 时间：2012-09-11T04:04:24.487
> 
> 标签：wordpress

因此，在 Wordpress 设置中，我将这两个字段设置为从[http://myDomain.com](http://myDomain.com)到 [http://myDomain.com/wp，Wordpress](http://myDomain.com/wp)仪表板对我来说已经死了。该网站还显示有趣。

我在这里尝试了第一种方法[http://codex.wordpress.org/Changing_The_Site_URL](http://codex.wordpress.org/Changing_The_Site_URL)，将其设置回[http://myDomain.com](http://myDomain.com)，但没有用。

1）如何让一切恢复正常？

[2) 我可以在http://myDomain.com/wp](http://myDomain.com/wp)访问我的网站的主页并且没有其他任何更改吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:16:18.487

如果您有权访问 cPanel，则可以轻松更改此设置。

做这个：

1.  登录到 cPanel。
2.  访问 PHPmyadmin。
3.  单击 phpMyAdmin 后，在左侧列中单击使用的数据库
4.  现在单击`wp_options`左侧的表格。
5.  在该表中，您需要更改两个值：`siteurl`和`home`。只需单击编辑按钮并添加输入您的新 WordPress 博客的 URL，然后单击“开始”按钮保存更改。

希望这会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:20:00.357

尝试直接通过数据库更新站点 URL，在“直接在数据库中更改 URL”标题下的“更改[站点 URL 法典”页面上](http://codex.wordpress.org/Changing_The_Site_URL)，它为您提供了一个很好的关于如何执行此操作的概要，这就是我要做的它。

1.  登录到您的 SQL 管理工具（最喜欢 PHPMyAdmin）
2.  选择您的数据库
3.  备份您的数据库（以防万一）
4.  选择 wp_options 表
5.  将值 siteurl / home 更改为您的域
6.  现在检查dashboard_widget_options的值并在那里更新你的域（它应该被列出3次，它是一个序列化的数组，所以[在这里插入值](http://blog.tanist.co.uk/files/unserialize/index.php)，更改域然后复制粘贴回来，这应该会让事情变得更容易）
7.  进入 wp-admin 部分，单击永久链接（在设置下），然后单击“更新永久链接”

回来报告！

希望这可以帮助..

# highcharts - 如何调整此折线图上的垂直标签？

> ID：12362610
> 
> 赞同：0
> 
> 时间：2012-09-11T04:05:09.110
> 
> 标签：highcharts

我几乎尝试了所有设置，但无法在 xAxis 线下的[**图表“外部”获取这些垂直日期标签。**](http://jsfiddle.net/R4JvP/11/)任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T05:41:58.770

你肯定没有尝试*每一个*设置:) 你可以给标签一个[y 偏移](http://api.highcharts.com/highstock#xAxis.labels.y)

```
 labels: {
            rotation: 270,
            y:40                
        }, 
```

[http://jsfiddle.net/jugal/5JXBR/](http://jsfiddle.net/jugal/5JXBR/)

# python - Python 和 GO 之间的通信媒介？

> ID：12362615
> 
> 赞同：0
> 
> 时间：2012-09-11T04:05:55.193
> 
> 标签：python, go

我想读写一些特殊格式的保存文件。然而，我目前的能力范围是编译 go 源代码，然后用 Python 调用它并返回 JSON。

GO之间有没有更好的通信方式！和Python？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T05:10:14.267

Go 有一种`gob`用于序列化数据的格式，但一些关于 golang-nuts 的[邮件列表讨论](https://groups.google.com/d/topic/golang-nuts/xtXh0yWOens/discussion)表明它不是与其他语言通信的好选择。

JSON 将是一个非常受人尊敬的选择，或者您可以尝试使用我在上面链接到的讨论中也建议的[protobufs 。](http://code.google.com/p/protobuf/)

编辑：您也可以根据自己的需要尝试与[Thrift](http://thrift.apache.org/)进行交流，但这可能不太适合您正在做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:40:37.017

有[BSON](http://bsonspec.org/ "BSON")，您可以将其视为 JSON 的二进制版本，具有多种语言的实现，包括 Go 和 Python。

# jsf - 如何在primefaces的数据表中实现拖放（行洗牌）？

> ID：12362622
> 
> 赞同：2
> 
> 时间：2012-09-11T04:07:27.173
> 
> 标签：jsf, primefaces

我正在使用 Primefaces DataTable 在网格中显示内容。我想使用拖放（随机播放）对这些行重新排序，我尝试过 jquery 可排序，它只适用于那些，之后我需要刷新浏览器。有什么方法可以实现吗？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-09T13:47:47.107

此功能现在可从 PrimeFaces 5.0 获得：

> 使用非常简单，只需启用 draggableRows 选项，并且还提供了一个可选的 rowReorder ajax 行为，以获取带有索引信息的 ReorderEvent 以实现灵活性。

来源：[http ://blog.primefaces.org/?p=3026](http://blog.primefaces.org/?p=3026)

您还可以在这里查看展示：http: [//www.primefaces.org/showcase/ui/data/datatable/reorder.xhtml](http://www.primefaces.org/showcase/ui/data/datatable/reorder.xhtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T09:04:11.933

目前没有办法使用服务器副作用进行行排序。您可以使用 jQuery 实现客户端重新排序，但这并不存储在服务器上。

```
$('.ui-datatable tbody').sortable(); 
```

PrimeFaces 论坛上有[一个讨论](http://forum.primefaces.org/viewtopic.php?f=3&t=2678)。

PrimeFaces 的问题跟踪器中还有[一个关于拖放功能的问题。](https://code.google.com/p/primefaces/issues/detail?id=564)请注意，该问题已作为 WontFix 关闭，所以我猜您不走运。

# java - 是否可以在 Grails 操作中使用 Spring 的 @RequestBody ？

> ID：12362624
> 
> 赞同：3
> 
> 时间：2012-09-11T04:07:36.937
> 
> 标签：java, json, grails, spring-mvc

我想使用 Spring 的`@RequestBody`注解将 JSON 从请求体绑定到一个对象。是否可以在 Grails 控制器方法中使用它？`request.JSON`如果没有，除了使用创建的对象之外，还有更优雅的方法吗？

这是我想要做的：
**FooController.groovy：**

```
def someMethod(@RequestBody Bar bar) {
    render(bar.baz)
}

class Bar {
    String baz
} 
```

然后我将以下 JSON 发布到此端点：

```
{
    "baz":"chicken"
} 
```

我希望 POST 的响应是`chicken`.

知道这是否可能，或者是否有一些其他机制可以将 JSON 绑定到这样的控制器参数？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T16:30:27.260

如果在相关的 URL 映射中使用`resource`或（详见[http://grails.org/doc/latest/guide/webServices.html](http://grails.org/doc/latest/guide/webServices.html)）那么传入的 JSON 将被解析并用于填充映射，即 JSON`parseRequest``params`

```
{
    "baz":"chicken"
} 
```

将设置`params.baz == "chicken"`。然后可以以通常的方式将生成的参数条目绑定到命令对象中，您不需要注释操作参数。

# python - Python将输出行保存到新文件中

> ID：12362629
> 
> 赞同：-1
> 
> 时间：2012-09-11T04:08:07.103
> 
> 标签：python

我从日志文件中得到了一些行（一条记录），但我不知道如何在其中编写函数来创建一个新的日志文件，其名称包含存储这些行的当前日期。我是新的python，所以我希望你能给我解决方案。谢谢

```
 def OnlyRecent(line):
    if  time.strptime(line.split("[")[0].strip(),"%a %b %d %H:%M:%S %Y")> time.gmtime(time.time()-(60*60*24*7)):
        return True
    return False
  for line in f:
    if OnlyRecent(line):
       print line  //store print lines into new log file.  20120911.log 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:11:43.187

您可以将打印输出重定向到文件：

```
log_file = open('mylog.log', 'w')

print>>log_file, 'hello'

log_file.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:26:55.410

在你的循环之外

```
filename = time.strftime('%Y%m%d') + '.log'
f = open(filename, 'w') 
```

在这里做你的循环，并写下每一行

```
f.write(line) 
```

如果您的行变量中没有换行符，请执行

```
f.write(line +'\n') 
```

退出循环后

```
f.close() 
```

# silverlight - 是否可以在没有 Silverlight 的情况下呈现 XAML 画布？

> ID：12362631
> 
> 赞同：1
> 
> 时间：2012-09-11T04:08:38.700
> 
> 标签：silverlight, xaml

是否可以在 XAML 中创建一个在线照片编辑器（编辑器允许用户添加文本、其他图像、剪贴画），只需在浏览器中呈现，而无需用户下载像 Silverlight 之类的插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:16:18.877

不，最接近的是使用 HTML5 的画布和 javascript 和/或 jquery。

# java - 动态数组列表使用迭代对象 Arraylist 并获取结果 base don object name

> ID：12362632
> 
> 赞同：0
> 
> 时间：2012-09-11T04:08:43.447
> 
> 标签：java, collections, arraylist, dataset

我有一个以这种方式创建的对象集合。我需要做的是按名称排列集合。

对象是

```
public class Object {
    private Integer id;
    private String name;
    private int value;

    public Object(Integer id, String name, int value) {
        this.id = id;
        this.name = name;
        this.value = value;
    }
        //getters,setters
}
private static List<Object> populateObjList1(){
    List<Object> objList = new ArrayList<Object> ();
    Object obj1 = new Object(1, "aa", 4);
    Object obj2 = new Object(2, "bb", 3);
    Object obj3 = new Object(3, "cc", 7);
    Object obj4 = new Object(4, "dd", 6);
    Object obj5 = new Object(1, "aa", 2);
    Object obj6 = new Object(2, "cc", 1);
    Object obj7 = new Object(3, "ee", 5);
    Object obj8 = new Object(4, "ff", 7);
    Object obj9 = new Object(1, "bb", 3);
    Object obj10 = new Object(2, "cc", 4);
    Object obj11 = new Object(3, "dd", 7);
    Object obj12 = new Object(4, "ff", 1);
    objList.add(obj1);
    objList.add(obj2);
    objList.add(obj3);
    objList.add(obj4);
    objList.add(obj5);
    objList.add(obj6);
    objList.add(obj7);
    objList.add(obj8);
    objList.add(obj9);
    objList.add(obj10);
    objList.add(obj11);
    objList.add(obj12);
    return objList;
} 
```

我的代码是-

```
public static void main (String args[]){
    List<Object> day1 = populateObjList1();
    List<String> abj = new ArrayList<String>();
    System.out.println(""+abj.size());
    for (Object object : day1) {
        if(!abj.contains(object.getName())){
            abj.add(object.getName());
        }else{
            System.out.println("available");
        }
    }
    for (String string : abj) {
        System.out.println("__ "+string);
    }   
}

    *** The expected dataset should be *****
    **********************
    |Name | ** | ** | ** |
    **********************
    aa      4     2    - 
    **********************
    bb      3     -    3
    **********************
    cc      7     1    4
    **********************
    dd      6     -    7
    **********************
    ee      -     5    -
    **********************
    ff      -     7    1
    ********************** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:14:56.743

您应该使用[PriorityQueue](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/PriorityQueue.html)。

`PriorityQueue<String> queue = new PriorityQueue<String>(10,comparator)`;

> 实现说明：此实现为插入方法（offer、poll、remove() 和 add）方法提供 O(log(n)) 时间；remove(Object) 和 contains(Object) 方法的线性时间；检索方法（peek、元素和大小）的恒定时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:27:56.753

有你的`Object`工具[`Comparable<Object>`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)，所以...

```
public int compareTo(final Object other) {
  return name.compareTo(other.name);
} 
```

接下来，尝试`List<Object>`使用[`Collections.sort`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List%29).

```
Collections.sort(day1); 
```

现在，`day1`应该按名称的字典升序排序。如果您希望能够修改`day1`而不必重新排序，请尝试使用 a [`TreeSet`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeSet.html)，即

```
final TreeSet<Object> set = new TreeSet<>();
/* add here */ 
```

如果您想支持多个总订单（即按 id 或按值），请考虑将比较从中解耦`Object`并创建一个 distinct [`Comparator<Object>`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)。只需指定`Comparator`to`sort`或`TreeSet`构造函数，具体取决于您使用的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T03:56:40.580

你必须改变你的设计。我想建议使用`Outer-Inner`class 和`TreeSet`.

```
class Foo {
 private String name;
 private TreeSet<Item> items;

 public Foo(String name) {
    this.name = name;
    items = new TreeSet<Item>();
 }
 public String getName() { return name; }
 public void setName(String name) {this.name = name;}
 public TreeSet<Item> getItems() {return items; }
 public void addItem(Integer id, Integer value) {
    items.add(new Item(id, value));
 }

 public class Item implements Comparable {
    @Override
    public int compareTo(Object arg0) {
        Item i = (Item) arg0;
        if (id == i.id)
            return 0;
        else if (id > i.id)
            return 1;
        else
            return -1;
    }

    private Integer id;
    private Integer value;

    public Item(Integer id, Integer value) {
        this.id = id;
        this.value = value;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Integer getValue() {
        return value;
    }

    public void setValue(Integer value) {
        this.value = value;
    }
} 
```

}

并创建`Foo`和的对象`Item`，

```
List<Foo> list = new ArrayList<Foo>();
list.add(new Foo("aa"));
list.add(new Foo("bb"));
list.add(new Foo("cc"));
list.add(new Foo("dd"));

list.get(0).addItem(1, 4);
list.get(0).addItem(2, 2);
list.get(0).addItem(3, 3);
list.get(1).addItem(3, 1);
list.get(1).addItem(1, 1);
list.get(1).addItem(2, 8);
list.get(2).addItem(3, 3);
list.get(3).addItem(2, 10);
list.get(0).addItem(5, 10);

for (Foo foo : list) {
 System.out.print(foo.getName());
 Foo.Item[] ar = foo.getItems().toArray(new Foo.Item[0]);
 for (int i = 1, j = 0; i <= 8; i++) {
   if (j >= ar.length)
    System.out.print(" - ");
   else if (ar[j].getId() == i) {
    System.out.print(" " + ar[j].getValue());
    j++;
   } else
        System.out.print(" - ");
  }
  System.out.println();
} 
```

# c# - 从 JSON 读取，数据不显示

> ID：12362633
> 
> 赞同：0
> 
> 时间：2012-09-11T04:08:48.897
> 
> 标签：c#, javascript, asp.net, json, webforms

当我尝试从 javascript 访问 json 中的元素时，我遇到了这个奇怪的问题。我从这样的 url 中检索一个 json 字符串，

```
 // Create Request
        HttpWebRequest req = (HttpWebRequest)WebRequest.Create(@"www.someurl.com");

        // Create Client
        WebClient client = new WebClient();

        // Assign Credentials
        client.Credentials = new NetworkCredential("username", "pass");

        // Grab Data
        sjson = client.DownloadString(@"www.someurl.com");
        System.Web.Script.Serialization.JavaScriptSerializer oSerializer = new System.Web.Script.Serialization.JavaScriptSerializer();
        oSerializer.MaxJsonLength = Int32.MaxValue;
        sjson = oSerializer.Serialize(sjson); 
```

但是当我在 html 代码中从 javascript 访问这个 sjson 变量时，它不会返回任何东西，但是如果我对其进行硬编码，它会返回值，请帮助解决这个问题。我尝试了很多东西，但没有奏效。我还尝试只传递检索到的 json 字符串而不进行序列化，当我这样做时，javascript 停止工作。:(以下是javascript代码，

```
 <script type="text/javascript">
    var jsons = JSON.parse('<%=sjson%>');

    function initialize() {
        alert("hahahahaaa");
        document.writeln(jsons.Body[0].RowId.SensorIdValue);
        //document.writeln(myobject.Body[0].RowId.SensorIdValue);
    }
    </script> 
```

问题是

```
 document.writeln(myobject.Body[0].RowId.SensorIdValue); 
```

如果我使用 myobject 变量，则返回一个值，但是

```
 document.writeln(jsons.Body[0].RowId.SensorIdValue); 
```

当我将它与解析值一起使用时，什么都不返回。:(

以下是我通过 c# 运行序列化程序后得到的 json 输出示例（response.write），

请帮我解决这个问题。我似乎在这里找不到问题。

编辑：

如果它有帮助，下面是我直接从服务器获得的 json 字符串，没有进行任何序列化，

**由于所有者的要求，该问题的一些内容已被删除**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:16:41.590

您所看到的是双重 JSON 序列化数据。您从远程服务器检索 JSON，然后使用 JavaScriptSerializer 对其进行第二次 JSON 编码。这是我在 ASMX ScriptServices 的上下文中写的一篇文章，其中更详细地解释了：http: [//encosia.com/asp-net-web-services-mistake-manual-json-serialization/](http://encosia.com/asp-net-web-services-mistake-manual-json-serialization/)。您的情况并不完全相同，但最终结果是。

移除 JavaScriptSerializer 代码并返回您检索到的 JSON 字符串 ( `sjson`)，而不是再次对其进行序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:05:23.867

您不需要使用 Json 序列化程序，因为远程服务器已经返回了一个 JSON 编码的字符串，您可以直接在页面中使用它并避免双重编码。

所以：

```
public string GetJson()
{
    // Create Client
    using (WebClient client = new WebClient())
    {
        // Assign Credentials
        client.Credentials = new NetworkCredential("username", "pass");

        // Grab Data
        return client.DownloadString(
            @"www.someurl.com"
        );
    }
} 
```

进而：

```
<script type="text/javascript">
    var jsons = <%= GetJson() %>;
    function initialize() {
        alert("hahahahaaa");
        document.writeln(jsons.Body[0].RowId.SensorIdValue);
        //document.writeln(myobject.Body[0].RowId.SensorIdValue);
    }
</script> 
```

# events - CQRS 中的命令处理程序、聚合、存储库和事件存储之间的关系

> ID：12362641
> 
> 赞同：41
> 
> 时间：2012-09-11T04:10:10.980
> 
> 标签：events, domain-driven-design, cqrs

我想了解基于 CQRS 的系统中命令处理程序、聚合、存储库和事件存储之间关系的一些细节。

到目前为止我所理解的：

*   命令处理程序从总线接收命令。他们负责从存储库中加载适当的聚合并调用聚合上的域逻辑。完成后，他们从总线上删除命令。
*   聚合提供行为和内部状态。国家从不公开。改变状态的唯一方法是使用行为。建模此行为的方法从命令的属性创建事件，并将这些事件应用到聚合，然后调用相应地设置内部状态的事件处理程序。
*   存储库仅允许在给定 ID 上加载聚合，并添加新聚合。基本上，存储库将域连接到事件存储。
*   最后但并非最不重要的一点是，事件存储负责将事件存储到数据库（或使用的任何存储），并将这些事件重新加载为所谓的事件流。

到现在为止还挺好。现在有一些我还没有得到的问题：

*   如果命令处理程序要在现有聚合上调用行为，那么一切都很容易。命令处理程序获取对存储库的引用，调用其 loadById 方法并返回聚合。但是，当还没有聚合但应该创建聚合时，命令处理程序会做什么？据我了解，以后应该使用这些事件重建聚合。这意味着聚合的创建是为了响应 fooCreated 事件而完成的。但是为了能够存储任何事件（包括 fooCreated 事件），我需要一个聚合。所以这在我看来就像一个先有鸡还是先有蛋的问题：没有事件我无法创建聚合，但应该创建事件的唯一组件是聚合。所以基本上它归结为：我如何创建新的聚合，谁做什么？
*   当聚合触发事件时，内部事件处理程序会响应它（通常通过应用方法调用）并更改聚合的状态。这个事件是如何移交给存储库的？谁发起了“请将新事件发送到存储库/事件存储”操作？聚合体本身？通过观察聚合存储库？订阅内部事件的其他人？...？
*   最后但并非最不重要的一点是，我在正确理解事件流的概念时遇到了问题：在我的想象中，它就像一个有序的事件列表。重要的是它是“有序的”。这是正确的吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-11T08:04:44.807

以下内容基于我自己的经验以及我对 Lokad.CQRS、NCQRS 等各种框架的实验。我确信有多种方法可以处理这个问题。我会发布对我最有意义的内容。

**1.聚合创建：**

每次命令处理程序需要聚合时，它都会使用存储库。存储库从事件存储中检索相应的事件列表并调用重载的构造函数，注入事件

```
var stream = eventStore.LoadStream(id)
var User = new User(stream) 
```

如果聚合之前不存在，则流将为空，并且新创建的对象将处于其原始状态。您可能希望确保在此状态下只允许少数命令使聚合生效，例如`User.Create()`.

**2\. 新事件的存储**

命令处理发生在*工作单元内*。在命令执行期间，每个结果事件都将添加到聚合 ( `User.Changes`) 内的列表中。执行完成后，更改将附加到事件存储中。在下面的示例中，这发生在以下行中：

```
store.AppendToStream(cmd.UserId, stream.Version, user.Changes) 
```

**3\. 事件顺序**

想象一下，如果两个后续`CustomerMoved`事件以错误的顺序重播，会发生什么。

**一个例子**

我将尝试用一段伪代码来说明（我故意将存储库问题留在命令处理程序中以显示幕后会发生什么）：

**申请服务：**

```
UserCommandHandler
    Handle(CreateUser cmd)
        stream = store.LoadStream(cmd.UserId)
        user = new User(stream.Events)
        user.Create(cmd.UserName, ...)
        store.AppendToStream(cmd.UserId, stream.Version, user.Changes)

    Handle(BlockUser cmd)
        stream = store.LoadStream(cmd.UserId)
        user = new User(stream.Events)
        user.Block(string reason)
        store.AppendToStream(cmd.UserId, stream.Version, user.Changes) 
```

**总计的：**

```
User
    created = false
    blocked = false

    Changes = new List<Event>

    ctor(eventStream)
        isNewEvent = false
        foreach (event in eventStream)
            this.Apply(event, isNewEvent)

    Create(userName, ...)
        if (this.created) throw "User already exists"
        isNewEvent = true
        this.Apply(new UserCreated(...), isNewEvent)

    Block(reason)
        if (!this.created) throw "No such user"
        if (this.blocked) throw "User is already blocked"
        isNewEvent = true
        this.Apply(new UserBlocked(...), isNewEvent)

    Apply(userCreatedEvent, isNewEvent)
        this.created = true
        if (isNewEvent) this.Changes.Add(userCreatedEvent)

    Apply(userBlockedEvent, isNewEvent)
        this.blocked = true
        if (isNewEvent) this.Changes.Add(userBlockedEvent) 
```

**更新：**

作为旁注：Yves 的回答让我想起了几年前*Udi Dahan的一篇有趣的文章：*

*   **[不要创建聚合根](http://www.udidahan.com/2009/06/29/dont-create-aggregate-roots/)**

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-11T08:26:17.117

丹尼斯优秀答案的一个小变化：

*   在处理“创造性”用例（即应该衍生出新的聚合）时，尝试找到另一个可以将责任转移到的聚合或工厂。这与拥有一个将事件进行水合的 ctor （或任何其他为此再水合的机制）并不冲突。有时工厂只是一个静态方法（适用于“上下文”/“意图”捕获），有时它是另一个聚合的实例方法（“数据”继承的好地方），有时它是一个显式工厂对象（“复杂”的创建逻辑）。
*   我喜欢在我的聚合上提供一个显式的 GetChanges() 方法，该方法将内部列表作为数组返回。如果我的聚合在一次执行后仍保留在内存中，我还添加了一个 AcceptChanges() 方法来指示应清除内部列表（通常在将事物刷新到事件存储后调用）。您可以在此处使用基于拉（GetChanges/Changes）或推送（想想 .net 事件或 IObservable）的模型。很大程度上取决于事务语义、技术、需求等......
*   您的事件流是一个链接列表。每个版本（事件/变更集）都指向前一个版本（也就是父版本）。您的事件流是发生在特定聚合上的一系列事件/更改。顺序仅在聚合边界内得到保证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-23T07:28:26.787

我*几乎*同意 yves-reynhout 和 dennis-traub 的观点，但我想向您展示我是如何做到这一点的。我想剥夺我的聚合体将事件应用到自己身上或重新补充自己的责任；否则会有很多代码重复：每个聚合构造函数看起来都一样：

```
UserAggregate:
    ctor(eventStream)
         foreach (event in eventStream)
            this.Apply(event)

OrderAggregate:
    ctor(eventStream)
         foreach (event in eventStream)
            this.Apply(event)

ProfileAggregate:
    ctor(eventStream)
         foreach (event in eventStream)
            this.Apply(event) 
```

这些责任可以留给指挥调度员。该命令由聚合直接处理。

```
Command dispatcher class

    dispatchCommand(command) method:
        newEvents = ConcurentProofFunctionCaller.executeFunctionUntilSucceeds(tryToDispatchCommand)
        EventDispatcher.dispatchEvents(newEvents)

    tryToDispatchCommand(command) method:
        aggregateClass = CommandSubscriber.getAggregateClassForCommand(command)
        aggregate = AggregateRepository.loadAggregate(aggregateClass, command.getAggregateId())
        newEvents = CommandApplier.applyCommandOnAggregate(aggregate, command)
        AggregateRepository.saveAggregate(command.getAggregateId(), aggregate, newEvents)

ConcurentProofFunctionCaller class

    executeFunctionUntilSucceeds(pureFunction) method:
        do this n times
            try
                call result=pureFunction()
                return result
            catch(ConcurentWriteException)
                continue
        throw TooManyRetries    

AggregateRepository class

     loadAggregate(aggregateClass, aggregateId) method:
         aggregate = new aggregateClass
         priorEvents = EventStore.loadEvents()
         this.applyEventsOnAggregate(aggregate, priorEvents)

     saveAggregate(aggregateId, aggregate, newEvents)
        this.applyEventsOnAggregate(aggregate, newEvents)
        EventStore.saveEventsForAggregate(aggregateId, newEvents, priorEvents.version)

SomeAggregate class
    handleCommand1(command1) method:
        return new SomeEvent or throw someException BUT don't change state!
    applySomeEvent(SomeEvent) method:
        changeStateSomehow() and not throw any exception and don't return anything! 
```

请记住，这是从 PHP 应用程序投射的伪代码；真正的代码应该在其他类中注入东西并重构其他职责。想法是保持聚合尽可能干净并避免代码重复。

关于聚合的一些重要方面：

1.  [命令处理程序不应更改状态；他们产生事件或抛出异常](https://groups.google.com/d/msg/cqrs--event-sourcing-for-php/jDlxObdUzEI/2rIEfhxgBwAJ)
2.  event apply 不应该抛出任何异常，也不应该返回任何东西；他们只改变内部状态

[可以在这里](https://github.com/xprt64/dudulina)找到一个开源的 PHP 实现。

# c - 如何在 php 扩展（用 c 编写）中捕获异常？

> ID：12362643
> 
> 赞同：1
> 
> 时间：2012-09-11T04:10:17.617
> 
> 标签：c, php-extension

我知道如何使用 zend api 抛出异常`zend_throw_exception`，但是如何在扩展源中捕获异常？

# android - android中的MapActivity中的多个地图（带有滑动）

> ID：12362645
> 
> 赞同：2
> 
> 时间：2012-09-11T04:10:41.037
> 
> 标签：android, google-maps, horizontal-scrolling

我在屏幕#1 中有一个地址列表视图。单击导航到下一个屏幕的任何项目，该屏幕显示点击地址的地图。现在我想滑动屏幕查看下一个地址的地图。这是我的代码..

这是我的 map_screen.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
style="@style/background"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:gravity="center_horizontal"
android:orientation="vertical" >

<LinearLayout
    android:id="@+id/linearLayoutTopBar"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@color/scarlet"
    android:gravity="center_vertical|center_horizontal" >

    <TextView
        android:id="@+id/textViewTopBar"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical|center_horizontal"
        android:layout_marginBottom="10dp"
        android:layout_marginTop="10dp"
        android:text="Map"
        android:textColor="@color/white"
        android:textSize="20dp" />
</LinearLayout>

<com.xxx.android.yyyy.activities.HorizontalPager
    android:id="@+id/horizontal_pager"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1" >
</com.xxx.android.yyyy.activities.HorizontalPager>

<ImageButton
    android:id="@+id/imageButton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:layout_margin="10dp"
    android:background="@null"
    android:scaleType="fitCenter"
    android:src="@drawable/button123" /> 
```

这是我的 map.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >
     <com.google.android.maps.MapView
                xmlns:android="http://schemas.android.com/apk/res/android"
                android:id="@+id/mapview"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_weight="1"
                android:apiKey="xxxxxxxxxxxxxxxxxxxxx"
                android:clickable="true" /> 
 </LinearLayout> 
```

活动 ：

```
public class MyMapActivity extends MapActivity
 {
private MapView mapView;
private Drawable mapMarker;
private MyLocationOverlay myMap;
private MapController mapController;
private List<Overlay> overlayList;
private HorizontalPager hPager;

 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.map_screen);
    hPager = (HorizontalPager) findViewById(R.id.horizontal_pager);
    View inflatedView;
    for (int i = 0; i < listViewSize; i++) //// getting listviewSize from intent extras 
    {    
     inflatedView = (View) View.inflate(MyMapActivity.this, R.layout.map, null);
     mapView = (MapView) inflatedView.findViewById(R.id.mapview);  
     showMap(latt, longt);  //getting all the latt, longt values of addresses from previous activity 
     hPager.addView(inflatedView);
    }
    hPager.setCurrentScreen(selectedAddressIndexInListView, false); //<<---- intent extras
  }

  void showMap(double latitude , double longitude )
  {
    mapView.setBuiltInZoomControls(true);
    mapMarker = getResources().getDrawable(R.drawable.map_marker);

    overlayList = mapView.getOverlays(); 
    myMap = new MyLocationOverlay(this, mapView);
    myMap.enableMyLocation();
    mapController = mapView.getController();

    GeoPoint geoPoint = new GeoPoint((int) (latitude * 1E6), (int) (longitude * 1E6));
    mapController.animateTo(geoPoint);
    mapController.setZoom(12);

    OverlayItem overlayItem = new OverlayItem(geoPoint,"xxx", "yyy");
    CustomPinpoint customPinpoint = new CustomPinpoint(mapMarker,MyMapActivity.this);
    customPinpoint.insertPinpoint(overlayItem);
    overlayList.clear();
    overlayList.add(myMap);
    overlayList.add(customPinpoint); 
   }
@Override
protected void onResume() {
    super.onResume();
    myMap.enableCompass();
    myMap.enableMyLocation();
}

@Override
protected void onPause() {
    super.onPause();
    myMap.disableCompass();
    myMap.disableMyLocation();
} 

 @Override
protected boolean isRouteDisplayed() {
    return false;   
} 
 } 
```

{ 参考：[https](https://github.com/ysamlan/horizontalpager/tree/master/src/com/github/ysamlan/horizontalpager) ://github.com/ysamlan/horizo​​ntalpager/tree/master/src/com/github/ysamlan/horizo​​ntalpager }

单击任何列表视图项目时，应用程序会立即强制关闭。

```
Caused by: java.lang.IllegalStateException: You are only allowed to have a single MapView in a MapActivity 
```

我哪里出错了？在以下两种情况下一切正常.. 1\. 如果我只迭代一次 for 循环。2\. 如果我从 xml、活动文件中删除与地图视图相关的行。

如何通过滑动在单个 MapActivity 中拥有多个地图？请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:39:30.370

每个地图活动只能有一个 Mapview，但是，您可以[在一个应用程序中拥有多个地图活动](https://stackoverflow.com/a/10496103/595947)，在您的情况下，这不是一个非常理想的解决方案。

您应该做什么，而不是为地址使用全新的地图视图，您可以为它们设置一组不同的叠加层。这样，当您想要查看另一个地址的地图详细信息时，您只需要更改覆盖集。除了可以使用 Android 来实现之外，它比拥有多个地图视图要优化得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:33:56.890

到目前为止，我知道目前 Android 每个 MapActivity 仅支持一个 MapView。

# c# - 可定制的数据过滤器

> ID：12362650
> 
> 赞同：0
> 
> 时间：2012-09-11T04:11:47.353
> 
> 标签：c#, wpfdatagrid

我们目前有一个 WPF 应用程序显示一些 3D 架构，并且我们制作了一个自定义过滤器，可以只显示具有某些属性的项目。您基本上可以将新项目添加到过滤器，每个项目都有一个组合框来选择要过滤的属性以及属性必须具有的值。我们在 WPF 视图中使用这个过滤器，但我们也有一个 COM 接口，虽然我们也可以使用它，所以过滤器也可以在没有 GUI 的情况下使用。

如果可能，我们正在尝试用现成的解决方案替换过滤器。有谁知道任何具有这种功能的现有产品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T05:30:10.607

我们将使用 Telerik 的表达式编辑器。它有一个返回 LambdaExpression 的 Expression 属性，您可以通过设置 ExpressionText 属性来设置当前表达式。然后编辑器显示新表达式。

看这里：

[http://www.telerik.com/community/forums/wpf/expression-editor/radexpressioneditor-persisting-of-expressions.aspx](http://www.telerik.com/community/forums/wpf/expression-editor/radexpressioneditor-persisting-of-expressions.aspx)

# ruby-on-rails - Rails 上的语法错误 ruby 意外'：'，在调用渲染 json 时需要'}'：

> ID：12362654
> 
> 赞同：0
> 
> 时间：2012-09-11T04:12:59.927
> 
> 标签：ruby-on-rails, ruby-on-rails-3, railscasts

错误：

```
SyntaxError in UsersController#index
 /home/ubuntu/ruby/users/app/controllers/users_controller.rb:7: syntax error, unexpected ':', expecting '}'
      format.json{render json: UsersDatatable.new(view_context)}
                              ^ 
```

我正在尝试让 dataTables 插件与我的 rails 应用程序一起使用（railcast #340）。我一遍又一遍地倾倒，不知道这个错误可能来自哪里。它看起来与[http://railscasts.com/episodes/340-datatables?view=asciicast](http://railscasts.com/episodes/340-datatables?view=asciicast)中列出的代码没有任何不同（除了我将名称从 Products 更改为 users 无处不在。我已经完全碰壁了。我的代码似乎除了名称之外的所有内容都相同，但它不起作用！（在我尝试开始设置 AJAX 部分之前它起作用了）

编辑：最初我使用 1.8.7 和 rails (3.2.7)，但后来升级到 ruby​​ 1.9.3，所以不知道为什么我仍然收到该错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:40:32.390

如果您使用的是 ruby​​ 1.8.7，那么语法`json: ...`将不起作用。

这应该可以代替（正如@Jérôme Boé 指出的那样）

```
format.json { render :json => UsersDatatable.new(view_context) } 
```

# jquery - 如何在 DatePicker 中启用过去的日期？

> ID：12362655
> 
> 赞同：2
> 
> 时间：2012-09-11T04:13:38.910
> 
> 标签：jquery

我使用 jquery.datePicker-2.1.2 作为日期选择器。问题是我需要选择过去的日子，但日历不允许我。有谁知道那里要改什么？

我试图删除`disabled`CSS 文件中的函数，但它只是使过去的日期可用，但我仍然没有选择它们。

```
(function($){

    $.fn.extend({
renderCalendar  :   function(s)
        {
            var dc = function(a)
            {
                return document.createElement(a);
            };

            s = $.extend({}, $.fn.datePicker.defaults, s);

            if (s.showHeader != $.dpConst.SHOW_HEADER_NONE) {
                var headRow = $(dc('tr'));
                for (var i=Date.firstDayOfWeek; i<Date.firstDayOfWeek+7; i++) {
                    var weekday = i%7;
                    var day = Date.dayNames[weekday];
                    headRow.append(
                        jQuery(dc('th')).attr({'scope':'col', 'abbr':day, 'title':day, 'class':(weekday == 0 || weekday == 6 ? 'weekend' : 'weekday')}).html(s.showHeader == $.dpConst.SHOW_HEADER_SHORT ? day.substr(0, 1) : day)
                    );
                }
            };

            var calendarTable = $(dc('table'))
                                    .attr(
                                        {
                                            'cellspacing':2,
                                            'className':'jCalendar'
                                        }
                                    )
                                    .append(
                                        (s.showHeader != $.dpConst.SHOW_HEADER_NONE ? 
                                            $(dc('thead'))
                                                .append(headRow)
                                            :
                                            dc('thead')
                                        )
                                    );
            var tbody = $(dc('tbody'));

            var today = (new Date()).zeroTime();

            var month = s.month == undefined ? today.getMonth() : s.month;
            var year = s.year || today.getFullYear();

            var currentDate = new Date(year, month, 1);

            var firstDayOffset = Date.firstDayOfWeek - currentDate.getDay() + 1;
            if (firstDayOffset > 1) firstDayOffset -= 7;
            var weeksToDraw = Math.ceil(( (-1*firstDayOffset+1) + currentDate.getDaysInMonth() ) /7);
            currentDate.addDays(firstDayOffset-1);

            var doHover = function()
            {
                if (s.hoverClass) {
                    $(this).addClass(s.hoverClass);
                }
            };
            var unHover = function()
            {
                if (s.hoverClass) {
                    $(this).removeClass(s.hoverClass);
                }
            };  

            var w = 0;
            while (w++<weeksToDraw) {
                var r = jQuery(dc('tr'));
                for (var i=0; i<7; i++) {
                    var thisMonth = currentDate.getMonth() == month;
                    var d = $(dc('td'))
                                .text(currentDate.getDate() + '')
                                .attr('className', (thisMonth ? 'current-month ' : 'other-month ') +
                                                    (currentDate.isWeekend() ? 'weekend ' : 'weekday ') +
                                                    (thisMonth && currentDate.getTime() == today.getTime() ? 'today ' : '')
                                )
                                .hover(doHover, unHover)
                            ;
                    if (s.renderCallback) {
                        s.renderCallback(d, currentDate, month, year);
                    }
                    r.append(d);
                    currentDate.addDays(1);
                }
                tbody.append(r);
            }
            calendarTable.append(tbody);

            return this.each(
                function()
                {
                    $(this).empty().append(calendarTable);
                }
            );
        },
datePicker : function(s)
        {           
            if (!$.event._dpCache) $.event._dpCache = [];

            // initialise the date picker controller with the relevant settings...
            s = $.extend({}, $.fn.datePicker.defaults, s);

            return this.each(
                function()
                {
                    var $this = $(this);
                    var alreadyExists = true;

                    if (!this._dpId) {
                        this._dpId = $.event.guid++;
                        $.event._dpCache[this._dpId] = new DatePicker(this);
                        alreadyExists = false;
                    }

                    if (s.inline) {
                        s.createButton = false;
                        s.displayClose = false;
                        s.closeOnSelect = false;
                        $this.empty();
                    }

                    var controller = $.event._dpCache[this._dpId];

                    controller.init(s);

                    if (!alreadyExists && s.createButton) {
                        // create it!
                        controller.button = $($.dpText.TEXT_CHOOSE_DATE)
                                .bind(
                                    'click',
                                    function()
                                    {
                                        $this.dpDisplay(this);
                                        this.blur();
                                        return false;
                                    }
                                );
                        $this.after(controller.button);
                    }

                    if (!alreadyExists && $this.is(':text')) {
                        $this
                            .bind(
                                'dateSelected',
                                function(e, selectedDate, $td)
                                {
                                    this.value = selectedDate.asString();
                                }
                            ).bind(
                                'change',
                                function()
                                {
                                    if (this.value != '') {
                                        var d = Date.fromString(this.value);
                                        if (d) {
                                            controller.setSelected(d, true, true);
                                        }
                                    }
                                }
                            );
                        if (s.clickInput) {
                            $this.bind(
                                'click',
                                function()
                                {
                                    $this.dpDisplay();
                                }
                            );
                        }
                        var d = Date.fromString(this.value);
                        if (this.value != '' && d) {
                            controller.setSelected(d, true, true);
                        }
                    }

                    $this.addClass('dp-applied');

                }
            )
        },
dpSetDisabled : function(s)
        {
            return _w.call(this, 'setDisabled', s);
        },
    dpSetStartDate : function(d)
        {
            return _w.call(this, 'setStartDate', d);
        },
dpSetEndDate : function(d)
        {
            return _w.call(this, 'setEndDate', d);
        },
dpGetSelected : function()
        {
            var c = _getController(this[0]);
            if (c) {
                return c.getSelected();
            }
            return null;
        },
dpSetSelected : function(d, v, m)
        {
            if (v == undefined) v=true;
            if (m == undefined) m=true;
            return _w.call(this, 'setSelected', Date.fromString(d), v, m, true);
        },
    dpSetDisplayedMonth : function(m, y)
        {
            return _w.call(this, 'setDisplayedMonth', Number(m), Number(y), true);
        },
dpDisplay : function(e)
        {
            return _w.call(this, 'display', e);
        },
dpSetRenderCallback : function(a)
        {
            return _w.call(this, 'setRenderCallback', a);
        },
dpSetPosition : function(v, h)
        {
            return _w.call(this, 'setPosition', v, h);
        },
dpSetOffset : function(v, h)
        {
            return _w.call(this, 'setOffset', v, h);
        },
dpClose : function()
        {
            return _w.call(this, '_closeCalendar', false, this[0]);
        },
        // private function called on unload to clean up any expandos etc and prevent memory links...
        _dpDestroy : function()
        {
            // TODO - implement this?
        }
    });
var _w = function(f, a1, a2, a3, a4)
    {
        return this.each(
            function()
            {
                var c = _getController(this);
                if (c) {
                    c[f](a1, a2, a3, a4);
                }
            }
        );
    };

    function DatePicker(ele)
    {
        this.ele = ele;

        // initial values...
        this.displayedMonth     =   null;
        this.displayedYear      =   null;
        this.startDate          =   null;
        this.endDate            =   null;
        this.showYearNavigation =   null;
        this.closeOnSelect      =   null;
        this.displayClose       =   null;
        this.selectMultiple     =   null;
        this.verticalPosition   =   null;
        this.horizontalPosition =   null;
        this.verticalOffset     =   null;
        this.horizontalOffset   =   null;
        this.button             =   null;
        this.renderCallback     =   [];
        this.selectedDates      =   {};
        this.inline             =   null;
        this.context            =   '#dp-popup';
    };
    $.extend(
        DatePicker.prototype,
        {   
            init : function(s)
            {
                this.setStartDate(s.startDate);
                this.setEndDate(s.endDate);
                this.setDisplayedMonth(Number(s.month), Number(s.year));
                this.setRenderCallback(s.renderCallback);
                this.showYearNavigation = s.showYearNavigation;
                this.closeOnSelect = s.closeOnSelect;
                this.displayClose = s.displayClose;
                this.selectMultiple = s.selectMultiple;
                this.verticalPosition = s.verticalPosition;
                this.horizontalPosition = s.horizontalPosition;
                this.hoverClass = s.hoverClass;
                this.setOffset(s.verticalOffset, s.horizontalOffset);
                this.inline = s.inline;
                if (this.inline) {
                    this.context = this.ele;
                    this.display();
                }
            },
            setStartDate : function(d)
            {
                if (d) {
                    this.startDate = Date.fromString(d);
                }
                if (!this.startDate) {
                    this.startDate = (new Date()).zeroTime();
                }
                this.setDisplayedMonth(this.displayedMonth, this.displayedYear);
            },
            setEndDate : function(d)
            {
                if (d) {
                    this.endDate = Date.fromString(d);
                }
                if (!this.endDate) {
                    this.endDate = (new Date('12/31/2999')); // using the JS Date.parse function which expects mm/dd/yyyy
                }
                if (this.endDate.getTime() < this.startDate.getTime()) {
                    this.endDate = this.startDate;
                }
                this.setDisplayedMonth(this.displayedMonth, this.displayedYear);
            },
            setPosition : function(v, h)
            {
                this.verticalPosition = v;
                this.horizontalPosition = h;
            },
            setOffset : function(v, h)
            {
                this.verticalOffset = parseInt(v) || 0;
                this.horizontalOffset = parseInt(h) || 0;
            },
            setDisabled : function(s)
            {
                $e = $(this.ele);
                $e[s ? 'addClass' : 'removeClass']('dp-disabled');
                if (this.button) {
                    $but = $(this.button);
                    $but[s ? 'addClass' : 'removeClass']('dp-disabled');
                    $but.attr('title', s ? '' : $.dpText.TEXT_CHOOSE_DATE);
                }
                if ($e.is(':text')) {
                    $e.attr('disabled', s ? 'disabled' : '');
                }
            },
            setDisplayedMonth : function(m, y, rerender)
            {
                if (this.startDate == undefined || this.endDate == undefined) {
                    return;
                }
                var s = new Date(this.startDate.getTime());
                s.setDate(1);
                var e = new Date(this.endDate.getTime());
                e.setDate(1);

                var t;
                if ((!m && !y) || (isNaN(m) && isNaN(y))) {
                    // no month or year passed - default to current month
                    t = new Date().zeroTime();
                    t.setDate(1);
                } else if (isNaN(m)) {
                    // just year passed in - presume we want the displayedMonth
                    t = new Date(y, this.displayedMonth, 1);
                } else if (isNaN(y)) {
                    // just month passed in - presume we want the displayedYear
                    t = new Date(this.displayedYear, m, 1);
                } else {
                    // year and month passed in - that's the date we want!
                    t = new Date(y, m, 1)
                }
                // check if the desired date is within the range of our defined startDate and endDate
                if (t.getTime() < s.getTime()) {
                    t = s;
                } else if (t.getTime() > e.getTime()) {
                    t = e;
                }
                var oldMonth = this.displayedMonth;
                var oldYear = this.displayedYear;
                this.displayedMonth = t.getMonth();
                this.displayedYear = t.getFullYear();

                if (rerender && (this.displayedMonth != oldMonth || this.displayedYear != oldYear))
                {
                    this._rerenderCalendar();
                    $(this.ele).trigger('dpMonthChanged', [this.displayedMonth, this.displayedYear]);
                }
            },
            setSelected : function(d, v, moveToMonth, dispatchEvents)
            {
                if (v == this.isSelected(d)) // this date is already un/selected
                {
                    return;
                }
                if (this.selectMultiple == false) {
                    this.selectedDates = {};
                    $('td.selected', this.context).removeClass('selected');
                }
                if (moveToMonth && this.displayedMonth != d.getMonth()) {
                    this.setDisplayedMonth(d.getMonth(), d.getFullYear(), true);
                }
                this.selectedDates[d.toString()] = v;

                var selectorString = 'td.';
                selectorString += d.getMonth() == this.displayedMonth ? 'current-month' : 'other-month';
                selectorString += ':contains("' + d.getDate() + '")';
                var $td;
                $(selectorString, this.ele).each(
                    function()
                    {
                        if ($(this).text() == d.getDate())
                        {
                            $td = $(this);
                            $td[v ? 'addClass' : 'removeClass']('selected');
                        }
                    }
                );

                if (dispatchEvents)
                {
                    var s = this.isSelected(d);
                    $e = $(this.ele);
                    $e.trigger('dateSelected', [d, $td, s]);
                    $e.trigger('change');
                }
            },
            isSelected : function(d)
            {
                return this.selectedDates[d.toString()];
            },
            getSelected : function()
            {
                var r = [];
                for(s in this.selectedDates) {
                    if (this.selectedDates[s] == true) {
                        r.push(Date.parse(s));
                    }
                }
                return r;
            },
            display : function(eleAlignTo)
            {
                if ($(this.ele).is('.dp-disabled')) return;

                eleAlignTo = eleAlignTo || this.ele;
                var c = this;
                var $ele = $(eleAlignTo);
                var eleOffset = $ele.offset();

                var $createIn;
                var attrs;
                var attrsCalendarHolder;
                var cssRules;

                if (c.inline) {
                    $createIn = $(this.ele);
                    attrs = {
                        'id'        :   'calendar-' + this.ele._dpId,
                        'className' :   'dp-popup dp-popup-inline'
                    };
                    cssRules = {
                    };
                } else {
                    $createIn = $('body');
                    attrs = {
                        'id'        :   'dp-popup',
                        'className' :   'dp-popup'
                    };
                    cssRules = {
                        'top'   :   eleOffset.top + c.verticalOffset,
                        'left'  :   eleOffset.left + c.horizontalOffset
                    };

                    var _checkMouse = function(e)
                    {
                        var el = e.target;
                        var cal = $('#dp-popup')[0];

                        while (true){
                            if (el == cal) {
                                return true;
                            } else if (el == document) {
                                c._closeCalendar();
                                return false;
                            } else {
                                el = $(el).parent()[0];
                            }
                        }
                    };
                    this._checkMouse = _checkMouse;

                    this._closeCalendar(true);
                }

                $createIn
                    .append(
                        $('<div></div>')
                            .attr(attrs)
                            .css(cssRules)
                            .append(
                                $('<h2></h2>'),
                                $('<div class="dp-nav-prev"></div>')
                                    .append(
                                        $('<a class="dp-nav-prev-year" href="#" title="' + $.dpText.TEXT_PREV_YEAR + '">&lt;&lt;</a>')
                                            .bind(
                                                'click',
                                                function()
                                                {
                                                    return c._displayNewMonth.call(c, this, 0, -1);
                                                }
                                            ),
                                        $('<a class="dp-nav-prev-month" href="#" title="' + $.dpText.TEXT_PREV_MONTH + '">&lt;</a>')
                                            .bind(
                                                'click',
                                                function()
                                                {
                                                    return c._displayNewMonth.call(c, this, -1, 0);
                                                }
                                            )
                                    ),
                                $('<div class="dp-nav-next"></div>')
                                    .append(
                                        $('<a class="dp-nav-next-year" href="#" title="' + $.dpText.TEXT_NEXT_YEAR + '">&gt;&gt;</a>')
                                            .bind(
                                                'click',
                                                function()
                                                {
                                                    return c._displayNewMonth.call(c, this, 0, 1);
                                                }
                                            ),
                                        $('<a class="dp-nav-next-month" href="#" title="' + $.dpText.TEXT_NEXT_MONTH + '">&gt;</a>')
                                            .bind(
                                                'click',
                                                function()
                                                {
                                                    return c._displayNewMonth.call(c, this, 1, 0);
                                                }
                                            )
                                    ),
                                $('<div></div>')
                                    .attr('className', 'dp-calendar')
                            )
                            .bgIframe()
                        );

                var $pop = this.inline ? $('.dp-popup', this.context) : $('#dp-popup');

                if (this.showYearNavigation == false) {
                    $('.dp-nav-prev-year, .dp-nav-next-year', c.context).css('display', 'none');
                }
                if (this.displayClose) {
                    $pop.append(
                        $('<a href="#" id="dp-close">' + $.dpText.TEXT_CLOSE + '</a>')
                            .bind(
                                'click',
                                function()
                                {
                                    c._closeCalendar();
                                    return false;
                                }
                            )
                    );
                }
                c._renderCalendar();

                $(this.ele).trigger('dpDisplayed', $pop);

                if (!c.inline) {
                    if (this.verticalPosition == $.dpConst.POS_BOTTOM) {
                        $pop.css('top', eleOffset.top + $ele.height() - $pop.height() + c.verticalOffset);
                    }
                    if (this.horizontalPosition == $.dpConst.POS_RIGHT) {
                        $pop.css('left', eleOffset.left + $ele.width() - $pop.width() + c.horizontalOffset);
                    }
                    $(document).bind('mousedown', this._checkMouse);
                }
            },
            setRenderCallback : function(a)
            {
                if (a == null) return;
                if (a && typeof(a) == 'function') {
                    a = [a];
                }
                this.renderCallback = this.renderCallback.concat(a);
            },
            cellRender : function ($td, thisDate, month, year) {
                var c = this.dpController;
                var d = new Date(thisDate.getTime());

                // add our click handlers to deal with it when the days are clicked...

                $td.bind(
                    'click',
                    function()
                    {
                        var $this = $(this);
                        if (!$this.is('.disabled')) {
                            c.setSelected(d, !$this.is('.selected') || !c.selectMultiple, false, true);
                            if (c.closeOnSelect) {
                                c._closeCalendar();
                            }
                        }
                    }
                );

                if (c.isSelected(d)) {
                    $td.addClass('selected');
                }

                // call any extra renderCallbacks that were passed in
                for (var i=0; i<c.renderCallback.length; i++) {
                    c.renderCallback[i].apply(this, arguments);
                }

            },
            // ele is the clicked button - only proceed if it doesn't have the class disabled...
            // m and y are -1, 0 or 1 depending which direction we want to go in...
            _displayNewMonth : function(ele, m, y) 
            {
                if (!$(ele).is('.disabled')) {
                    this.setDisplayedMonth(this.displayedMonth + m, this.displayedYear + y, true);
                }
                ele.blur();
                return false;
            },
            _rerenderCalendar : function()
            {
                this._clearCalendar();
                this._renderCalendar();
            },
            _renderCalendar : function()
            {
                // set the title...
                $('h2', this.context).html(Date.monthNames[this.displayedMonth] + ' ' + this.displayedYear);

                // render the calendar...
                $('.dp-calendar', this.context).renderCalendar(
                    {
                        month           : this.displayedMonth,
                        year            : this.displayedYear,
                        renderCallback  : this.cellRender,
                        dpController    : this,
                        hoverClass      : this.hoverClass
                    }
                );

                // update the status of the control buttons and disable dates before startDate or after endDate...
                // TODO: When should the year buttons be disabled? When you can't go forward a whole year from where you are or is that annoying?
                if (this.displayedYear == this.startDate.getFullYear() && this.displayedMonth == this.startDate.getMonth()) {
                    $('.dp-nav-prev-year', this.context).addClass('disabled');
                    $('.dp-nav-prev-month', this.context).addClass('disabled');
                    $('.dp-calendar td.other-month', this.context).each(
                        function()
                        {
                            var $this = $(this);
                            if (Number($this.text()) > 20) {
                                $this.addClass('disabled');
                            }
                        }
                    );
                    var d = this.startDate.getDate();
                    $('.dp-calendar td.current-month', this.context).each(
                        function()
                        {
                            var $this = $(this);
                            if (Number($this.text()) < d) {
                                $this.addClass('disabled');
                            }
                        }
                    );
                } else {
                    $('.dp-nav-prev-year', this.context).removeClass('disabled');
                    $('.dp-nav-prev-month', this.context).removeClass('disabled');
                    var d = this.startDate.getDate();
                    if (d > 20) {
                        // check if the startDate is last month as we might need to add some disabled classes...
                        var sd = new Date(this.startDate.getTime());
                        sd.addMonths(1);
                        if (this.displayedYear == sd.getFullYear() && this.displayedMonth == sd.getMonth()) {
                            $('dp-calendar td.other-month', this.context).each(
                                function()
                                {
                                    var $this = $(this);
                                    if (Number($this.text()) < d) {
                                        $this.addClass('disabled');
                                    }
                                }
                            );
                        }
                    }
                }
                if (this.displayedYear == this.endDate.getFullYear() && this.displayedMonth == this.endDate.getMonth()) {
                    $('.dp-nav-next-year', this.context).addClass('disabled');
                    $('.dp-nav-next-month', this.context).addClass('disabled');
                    $('.dp-calendar td.other-month', this.context).each(
                        function()
                        {
                            var $this = $(this);
                            if (Number($this.text()) < 14) {
                                $this.addClass('disabled');
                            }
                        }
                    );
                    var d = this.endDate.getDate();
                    $('.dp-calendar td.current-month', this.context).each(
                        function()
                        {
                            var $this = $(this);
                            if (Number($this.text()) > d) {
                                $this.addClass('disabled');
                            }
                        }
                    );
                } else {
                    $('.dp-nav-next-year', this.context).removeClass('disabled');
                    $('.dp-nav-next-month', this.context).removeClass('disabled');
                    var d = this.endDate.getDate();
                    if (d < 13) {
                        // check if the endDate is next month as we might need to add some disabled classes...
                        var ed = new Date(this.endDate.getTime());
                        ed.addMonths(-1);
                        if (this.displayedYear == ed.getFullYear() && this.displayedMonth == ed.getMonth()) {
                            $('.dp-calendar td.other-month', this.context).each(
                                function()
                                {
                                    var $this = $(this);
                                    if (Number($this.text()) > d) {
                                        $this.addClass('disabled');
                                    }
                                }
                            );
                        }
                    }
                }
            },
            _closeCalendar : function(programatic, ele)
            {
                if (!ele || ele == this.ele)
                {
                    $(document).unbind('mousedown', this._checkMouse);
                    this._clearCalendar();
                    $('#dp-popup a').unbind();
                    $('#dp-popup').empty().remove();
                    if (!programatic) {
                        $(this.ele).trigger('dpClosed', [this.getSelected()]);
                    }
                }
            },
            // empties the current dp-calendar div and makes sure that all events are unbound
            // and expandos removed to avoid memory leaks...
            _clearCalendar : function()
            {
                // TODO.
                $('.dp-calendar td', this.context).unbind();
                $('.dp-calendar', this.context).empty();
            }
        }
    );

    // static constants
    $.dpConst = {
        SHOW_HEADER_NONE    :   0,
        SHOW_HEADER_SHORT   :   1,
        SHOW_HEADER_LONG    :   2,
        POS_TOP             :   0,
        POS_BOTTOM          :   1,
        POS_LEFT            :   0,
        POS_RIGHT           :   1
    };
    // localisable text
    $.dpText = {
        TEXT_PREV_YEAR      :   'Предыдущий год',
        TEXT_PREV_MONTH     :   'Предыдущий месяц',
        TEXT_NEXT_YEAR      :   'Следующий год',
        TEXT_NEXT_MONTH     :   'Следующий месяц',
        TEXT_CLOSE          :   'Закрыть',
        TEXT_CHOOSE_DATE    :   '<p><u>выбрать дату</u></p>'
    };
    // version
    $.dpVersion = '$Id: jquery.datePicker.js 15 2008-12-17 04:40:18Z kelvin.luck $';

    $.fn.datePicker.defaults = {
        month               : undefined,
        year                : undefined,
        showHeader          : $.dpConst.SHOW_HEADER_SHORT,
        startDate           : undefined,
        endDate             : undefined,
        inline              : false,
        renderCallback      : null,
        createButton        : true,
        showYearNavigation  : true,
        closeOnSelect       : true,
        displayClose        : false,
        selectMultiple      : false,
        clickInput          : false,
        verticalPosition    : $.dpConst.POS_TOP,
        horizontalPosition  : $.dpConst.POS_LEFT,
        verticalOffset      : 0,
        horizontalOffset    : 0,
        hoverClass          : 'dp-hover'
    };

    function _getController(ele)
    {
        if (ele._dpId) return $.event._dpCache[ele._dpId];
        return false;
    };

    // make it so that no error is thrown if bgIframe plugin isn't included (allows you to use conditional
    // comments to only include bgIframe where it is needed in IE without breaking this plugin).
    if ($.fn.bgIframe == undefined) {
        $.fn.bgIframe = function() {return this; };
    };

    // clean-up
    $(window)
        .bind('unload', function() {
            var els = $.event._dpCache || [];
            for (var i in els) {
                $(els[i].ele)._dpDestroy();
            }
        });
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:18:33.070

简单的 datePicker 可选择过去的日期

```
$(function()
{
    $('.datepick').datePicker({startDate:'01/01/1997'});
}); 
```

简单的 datePicker，只能选择过去的日期

```
$(function()
{
    $('.datepick').datePicker(
        {
            startDate: '01/01/1970',
            endDate: (new Date()).asString()
        }
    );
}); 
```

有关更多信息，请查看[此链接](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/)，它很棒

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T06:35:56.917

您必须添加以下 js 和 css 文件：

## JS

*   [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/jquery.datePicker.js](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/jquery.datePicker.js)
*   [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js)

## CSS

*   [http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/datePicker.css](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/datePicker.css)

然后你可以调用日期选择器功能，如

```
$(function() {
    $('your selector').datePicker({
        startDate: '01/01/1996'
    });
});​ 
```

[**工作演示**](http://jsfiddle.net/V4JTq/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:51:10.463

嘿，搜索 defaultDate 选项以设置以下链接并将其放置在您调用 datePicker 插件的位置。

```
defaultDate: '-2m', 
```

此选项用于设置 2 个月前的日期

希望这会帮助你。

# c# - 将数据集（或自定义集合）转换为站点地图

> ID：12362658
> 
> 赞同：0
> 
> 时间：2012-09-11T04:14:00.253
> 
> 标签：c#, asp.net, sitemap, sitemapprovider

我有通用集合列表，它具有某些属性....它是一个分层集合，我现在想将其制作成站点地图文件....即 MSDN 声明的标准....所以输出将是这样的：http: [//msdn.microsoft.com/en-us/library/aa581782.aspx](http://msdn.microsoft.com/en-us/library/aa581782.aspx)

我知道我可能可以使用 xslt 或 xmldoc 编写 xml otuput，但是有没有办法使用 .net 框架提供的 sitemapprovider 和 sitemapnode 类来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:58:37.050

参考这个网址

[http://www.codeproject.com/Articles/15614/Building-and-Consuming-a-Dynamic-Sitemap-in-ASP-NE](http://www.codeproject.com/Articles/15614/Building-and-Consuming-a-Dynamic-Sitemap-in-ASP-NE)

# asp.net - 在 Tabcontainer 中放置组合框时，获取“对象引用未设置为对象的实例”错误

> ID：12362660
> 
> 赞同：1
> 
> 时间：2012-09-11T04:14:13.307
> 
> 标签：asp.net

我有一个带有两个选项卡的 Ajaxtoolkit Tabcontainer，启用的第二个选项卡为 False。我在第二个选项卡中放置了一个 Combobox AjaxToolikit 控件。但是当仅在 IE 浏览器中对服务器进行回发时，我收到以下错误。但在 Firefox 中我没有问题，一切正常。怎么了？

这是我的代码：

```
 <ul>
          <li>
                        <asp:ImageButton ID="BtnNew" CausesValidation="false" runat="server" ImageUrl="~/CssImages/new_document.png"
                            ToolTip="New" Width="20px" OnClick="BtnNew_Click" /></li>
</ul>

 <cc1:TabContainer ID="TabContainer1" runat="server">
    <cc1:TabPanel runat="server" ID="Tab1" HeaderText="xx">
    <ContentTemplate>
    xx
    </ContentTemplate>
    </cc1:TabPanel>
    <cc1:TabPanel runat="server" ID="TabPanel1" HeaderText="yy"  Enabled="false">
    <ContentTemplate>
    dsds <cc1:ComboBox ID="ComboBox1" runat="server">
        <asp:ListItem>loblob</asp:ListItem>
        </cc1:ComboBox>
    </ContentTemplate>

    </cc1:TabPanel>
    </cc1:TabContainer> 
```

错误：

```
 Object reference not set to an instance of an object. 
    Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 

[NullReferenceException: Object reference not set to an instance of an object.]
   AjaxControlToolkit.ComboBox.LoadPostData(String postDataKey, NameValueCollection postCollection) +168
   AjaxControlToolkit.ComboBox.System.Web.UI.IPostBackDataHandler.LoadPostData(String postDataKey, NameValueCollection postCollection) +57
   System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad) +690
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1743 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T07:07:23.267

我相信 IE 不会向服务器禁用表单元素以及禁用容器中的元素提交。有很多方法可以解决这个问题。最简单的方法是同时禁用 ComboBox 控件并使用父选项卡控件启用它。更一般的决定是修复 AjaxControlToolkit 库中的 ComboBox 源。为此，您需要下载库源并更改文件中的第一行`LoadPostData`方法，`Server/AjaxControlToolkit/ComboBox/ComboBox.cs`如下所示：

```
protected virtual bool LoadPostData(string postDataKey, NameValueCollection postCollection)
{
    if (!Enabled || postCollection.GetValues(HiddenFieldControl.UniqueID) == null)
        return false;

    //...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T18:32:05.710

即使我没有使用任何隐藏的面板/控件，我也遇到了这个问题。事实证明，即使它们在 .aspx 中被注释掉，后面的 Designer.cs 也在为我生成 ComboBox 控件。

删除我注释掉的实验/提醒代码，一切正常。

生成的控件就好像它被隐藏了一样——回发时弹出了相同的异常。

# crash - OpenSL ES RegisterCallback 导致崩溃

> ID：12362662
> 
> 赞同：1
> 
> 时间：2012-09-11T04:14:33.420
> 
> 标签：crash, opensl

我必须在我的项目中使用 OpenSL（尝试过 Soundpool，但它一点都不好）。但是，在多次播放声音后（大约连续 35 次），应用程序被关闭（我猜可能是因为溢出）。

我试图释放缓冲区/内存来解决问题（看在上帝的份上，我不知道如何使用这个 OpenSL）。所以我决定在文件播放完毕后尝试释放。OpenSL ES 为我们提供了`RegisterCallback`可能有所帮助的功能。在我的情况下（使用 URI 文件）发生了新问题，`RegisterCallback`导致我的应用程序再次崩溃。它卡住了。

这是我的代码。请帮忙。紧接着就崩溃了`//register callback for uri`。

```
static short fdBuffer[SAWTOOTH_FRAMES];

// create URI audio player
    jboolean Java_jp_mobigame_ayakashi_CardGameActivity_createUriAudioPlayer(JNIEnv* env, jclass clazz,
            jstring uri)
    {
        __android_log_print(ANDROID_LOG_DEBUG, "LOG_TAG", "\n createUri \n");
        SLresult result;

        // convert Java string to UTF-8
        const jbyte *utf8 = (*env)->GetStringUTFChars(env, uri, NULL);
        assert(NULL != utf8);

        // configure audio source
        // (requires the INTERNET permission depending on the uri parameter)
        SLDataLocator_URI loc_uri = {SL_DATALOCATOR_URI, (SLchar *) utf8};
        SLDataFormat_MIME format_mime = {SL_DATAFORMAT_MIME, NULL, SL_CONTAINERTYPE_UNSPECIFIED};
        SLDataSource audioSrc = {&loc_uri, &format_mime};

        // configure audio sink
        SLDataLocator_OutputMix loc_outmix = {SL_DATALOCATOR_OUTPUTMIX, outputMixObject};
        SLDataSink audioSnk = {&loc_outmix, NULL};

        // create audio player
        const SLInterfaceID ids[3] = {SL_IID_SEEK, SL_IID_MUTESOLO /*SL_IID_BUFFERQUEUE*/, SL_IID_VOLUME};
        const SLboolean req[3] = {SL_BOOLEAN_TRUE, SL_BOOLEAN_TRUE, SL_BOOLEAN_TRUE};
        result = (*engineEngine)->CreateAudioPlayer(engineEngine, &uriPlayerObject, &audioSrc,
                &audioSnk, 3, ids, req);
        // note that an invalid URI is not detected here, but during prepare/prefetch on Android,
        // or possibly during Realize on other platforms
        assert(SL_RESULT_SUCCESS == result);

        // release the Java string and UTF-8
        (*env)->ReleaseStringUTFChars(env, uri, utf8);

        // realize the player
        result = (*uriPlayerObject)->Realize(uriPlayerObject, SL_BOOLEAN_FALSE);
        // this will always succeed on Android, but we check result for portability to other platforms
        if (SL_RESULT_SUCCESS != result) {
            (*uriPlayerObject)->Destroy(uriPlayerObject);
            uriPlayerObject = NULL;
            return JNI_FALSE;
        }

        // get the play interface
        result = (*uriPlayerObject)->GetInterface(uriPlayerObject, SL_IID_PLAY, &uriPlayerPlay);
        assert(SL_RESULT_SUCCESS == result);

        // get the seek interface
        result = (*uriPlayerObject)->GetInterface(uriPlayerObject, SL_IID_SEEK, &uriPlayerSeek);
        assert(SL_RESULT_SUCCESS == result);

        __android_log_print(ANDROID_LOG_DEBUG, "LOG_TAG", "\n createUri 1\n");
        //get the buffer queue interface
        result = (*uriPlayerObject)->GetInterface(uriPlayerObject, SL_IID_ANDROIDSIMPLEBUFFERQUEUE, &uriPlayerBufferQueue);
        assert(SL_RESULT_SUCCESS == result);
        __android_log_print(ANDROID_LOG_DEBUG, "LOG_TAG", "\n createUri 2\n");

        //register callback for uri
        result = (*uriPlayerBufferQueue)->RegisterCallback(uriPlayerBufferQueue, bqUriPlayerCallback, NULL);
        assert(SL_RESULT_SUCCESS == result);
        __android_log_print(ANDROID_LOG_DEBUG, "LOG_TAG", "\n createUri 4\n");

        //Enqueue
        __android_log_print(ANDROID_LOG_DEBUG, "LOG_TAG", "\n createUri 3\n");
        result = (*uriPlayerBufferQueue)->Enqueue(uriPlayerBufferQueue, fdBuffer, sizeof(fdBuffer));

        // get the mute/solo interface
        result = (*uriPlayerObject)->GetInterface(uriPlayerObject, SL_IID_MUTESOLO, &uriPlayerMuteSolo);
        assert(SL_RESULT_SUCCESS == result);

        // get the volume interface
        result = (*uriPlayerObject)->GetInterface(uriPlayerObject, SL_IID_VOLUME, &uriPlayerVolume);
        assert(SL_RESULT_SUCCESS == result);

        return JNI_TRUE;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T17:54:05.370

看起来您正在尝试获取缓冲区队列接口，即使您正在指定 uri 源。您似乎也在排队数据。如果您只是尝试从 uri 播放音频，则不需要这样做。如果您尝试输出到缓冲区而不是扬声器，那么这可能是有效的。无论如何，我都不是 OpenSL 专家，所以这可能是有原因的。但是，如果没有原因，请尝试在播放器对象上注册回调。

```
(*uriPlayerPlay)->RegisterCallback(uriPlayerPlay, bqUriPlayerCallback, NULL); 
```

附带说明一下，您可能需要设置回调事件掩码。有几种选择，但我相信您正在寻找的是：

```
(*uriPlayerPlay)->SetCallbackEventsMask(uriPlayerPlay, SL_PLAYEVENT_HEADATEND) 
```

请注意，这可能存在问题。请参阅[https://groups.google.com/forum/?fromgroups=#!topic/android-ndk/7YaqlKlDMO4](https://groups.google.com/forum/?fromgroups=#!topic/android-ndk/7YaqlKlDMO4)。

如果这没有帮助，查看回调函数的定义可能会有所帮助。我相信它应该看起来像：

```
static void bqUriPlayerCallback (SLPlayItf caller, void *pContext, SLuint32 playevent) 
```

# clojure - 如何在 swank 中自动从 project.clj 加载新的依赖项

> ID：12362664
> 
> 赞同：2
> 
> 时间：2012-09-11T04:14:46.553
> 
> 标签：clojure, swank, swank-clojure

我在 emacs，swank-clojure 工作。我使用 clojure-jack-in 开始我的 repl。但是，当我向我的 project.clj 添加新依赖项时，repl 中没有该依赖项。

1）当 project.clj 发生变化时，有没有办法在 swank 中自动加载新的依赖项？

2）还有什么是终止swank服务器的干净方法？目前我只是杀死缓冲区。

谢谢，穆尔塔萨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T06:28:25.377

当 Java VM 启动时，它会读取所有包含的 jars，以后可以直接包含 jars。如果你真的不想重新启动应用程序，你可以尝试[这样的事情](https://stackoverflow.com/questions/194698/how-to-load-a-jar-file-at-runtime)。但这可能会变得非常棘手，就好像您不使用与 Clojure 相同的类加载器，然后在加载另一个 Clojure 库时，您最终可能会得到 2 个 Clojure 核心实例。

要从 swank 服务器断开连接，请使用 Mx slime-disconnect。要停止在服务器上发布，您可以发出：

```
(swank.swank/stop-server) 
```

# c - scanf中的右对齐宽度修饰符？

> ID：12362666
> 
> 赞同：1
> 
> 时间：2012-09-11T04:14:54.760
> 
> 标签：c, scanf

对于赋值，它的一小部分表示整数只能是五位数字。如果输入一个整数，例如 1234567，那么结果应该是 34567。

有什么办法可以直接用scanf设置吗？当然，将它设置为只读取五个整数很容易，但它不会读取最右边的五个。是否可以为此设置标志或其他东西，还是我必须在之后做一些骇人听闻的循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:18:07.470

您可以使用 mod 运算符。`int m = enteredNumber % 100000;`这将截断您的号码。

在这里..我试过了。

```
#include <math.h>

int main(int argc, char** argv)
{
  char* number = "12334567";

  int numberAsInt = atoi(number);

  int shorterNumber = numberAsInt % 100000;

  printf("The number is %d\n", shorterNumber);

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T06:05:11.347

也许像这样

```
char* number = "1234567";
int val = 0;
int len = 0;
int ofset = 0;

len = strlen(number);
if ( len > 5) {
    ofset = len - 5;
}
sscanf(number + ofset, "%d", &val);
printf("result: %d", val); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T08:00:57.277

没有这样的预定义量词具有最右边的数字。你必须编写自己的循环来显示你想要的输出。

# actionscript-3 - 1180：调用可能未定义的方法 loaderInfo 操作脚本错误

> ID：12362668
> 
> 赞同：0
> 
> 时间：2012-09-11T04:15:09.810
> 
> 标签：actionscript-3, flash, apache-flex, action

我是flash的新手。我想测试使用 flashvars 将变量传递给 swf 文件，然后我一直在创建一个带有 name 的动作脚本文件`"test_adver.as"`。我在 fla 文件中使用这个文件作为类文档。这是代码`"test_adver.as"`：

```
package src{
import flash.display.Loader;
import flash.display.LoaderInfo;
import flash.display.MovieClip;
import flash.events.Event;
import flash.external.ExternalInterface;
import flash.net.URLRequest;
import flash.text.TextField;

public class test_adver extends MovieClip {
    public function test_adver() {
        try {
            var param:Object=loaderInfo(this.root.loaderInfo).parameters;
        } catch (error:Error) {
            trace("Loading failed");
        }
    }
} 
```

}

但是当我运行代码时，输​​出显示`"1180: Call to a possibly undefined method loaderInfo action script error"`. 我尝试调试一个小时，但无法解决此问题。帮我。请！对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:29:49.250

It should be a lot more simple. You are trying to request loaderInfo property, but for this you don't even need type casting.

```
var param:Object=this.root.loaderInfo.parameters; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:36:21.387

除了以下之外，您做的一切都是正确的

```
var param:Object = LoaderInfo(this.root.loaderInfo).parameters; 
```

是的，应该有大写“L”。为 flashvars 导入 LoaderInfo 类就足够了。

# zend-framework - Zend 框架：尝试通过 /controller/action url 访问其他视图时，只有索引视图呈现 404 错误

> ID：12362670
> 
> 赞同：2
> 
> 时间：2012-09-11T04:15:21.153
> 
> 标签：zend-framework, frameworks

我是 Zend 框架的新手。

我正在运行 Apache 2.2，并将 httpd.conf 文件中的 DocumentRoot 设置为使用 Zend_Tool 创建的公共目录。

在公共目录中，我有一个 .htaccess 文件；

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

...和一个 index.php 文件；

```
<?php

// Define path to application directory
/*defined('APPLICATION_PATH')
    || */define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'production'));

// Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);

$application->bootstrap()->run(); 
```

当我在浏览器中键入“http://localhost/”时，“application/views/scripts/index/”目录中的文件 index.phtml 呈现正常。

如果我尝试使用 url 中的控制器和操作名称访问其他视图，我会收到 404 错误，指出在服务器上找不到请求的 URL。

例如，我有控制器文件 TestController.php，它与 IndexController.php 位于同一目录中

*/TestController.php/* _ _

```
<?php

class TestController extends Zend_Controller_Action
{

    public function init()
    {
        /* Initialize action controller here */
    }

    public function testAction()
    {
        // action body
    }

} 
```

我在“application/views/scripts/”中创建了一个包含名为 index.phtml 的文件的测试目录；

/views/scripts/test/index.phtml/ *_* _

```
<br /><br />
<div id="view-content">
<p>View script for controller <b>Test</b> and script/action name <b>index</b></p>
</div> 
```

当我尝试通过键入“http://localhost/test/”来呈现此文件时，我收到一个 404 错误，指出无法找到请求的 URL。我阅读过的所有 Zend Framework 文档和无数其他资源都表明该方法应该正确呈现。

我一定遗漏了一些东西，但是经过详尽的搜索后，无法找到其他有此特定问题的人。

问候罗恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:29:54.083

try creating an indexAction in the test controller... or test.phtml in the directory

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T09:49:06.360

您能否检查第二个 url localhost/test 是否正在通过您的 index.php。您可以为此放置一个 die() 或一些调试语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T17:19:02.220

嗯，尝试将其添加到您的 httpd.conf 文件中：

```
NameVirtualHost *:80
<VirtualHost *:80>
DocumentRoot Link to yourSiteFolder exp. C:/AppServ/www/yourSite/public
ServerName youServerName exp. http://mysite.com or you ip http://xxx.xxx.xxx.xxx
 </VirtualHost>

<Directory "Link to yourSiteFolder exp. C:/AppServ/www/yourSite/public">
Options FollowSymLinks
AllowOverride All
</Directory> 
```

找到这个：

```
#LoadModule rewrite_module modules/mod_rewrite.so 
```

并删除'#'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T03:07:10.010

感谢您的回复。

以为我会为其他人发布我的解决方案..

这是我在目录标签内的 httpd.conf 文件中更新的部分；

```
# AllowOverride controls what directives may be placed in .htaccess files.
# It can be "All", "None", or any combination of the keywords:
#   Options FileInfo AuthConfig Limit
#
AllowOverride All 
```

并且我之前取消了上面提到的模块的注释

```
LoadModule rewrite_module modules/mod_rewrite.so 
```

干杯

# javascript - 流浪汉：可以在table-plus中添加cookie吗？

> ID：12362672
> 
> 赞同：0
> 
> 时间：2012-09-11T04:15:31.920
> 
> 标签：javascript, ruby-on-rails, hobo

我在 hobo 中的 table-plus 功能提供的排序方面遇到了一些问题。假设我有一些 javascript 函数来显示不同的表格：

```
function showTable1() {
    ...
}

function showTable2() {
    ...
}

function showTable3() {
    ...
}

Event.observer(windows, 'load', showTable1); 
```

我用来显示表格。我们可以看到，默认情况下会显示表 1，每次我尝试排序时，比如说表 2 显示后，页面会刷新，然后它会自动切换回显示表 1。

我打算用处理程序替换默认行为：

```
function showHandler() {
    if (case1) showTable1();
    else if (case2) showTable2();
    else showTable3();
} 
```

这是否可以通过将 cookie 添加到 table-plus 行为来实现它？有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T20:06:01.903

如果您在 Rails 或 Hobo 应用程序中完成所有服务器端或所有客户端的所有操作，这通常是最简单的。

因此，要么切换到[hobo_data_tables](http://cookbook-1.4.hobocentral.net/api_plugins/hobo_data_tables)并在客户端进行排序，要么在服务器端进行显示切换。要执行后者，您可以添加如下表单：

```
<form action="">
  <input type="hidden" name="search" value="&params[:search]"/>
  <input type="hidden" name="sort" value="&params[:sort]"/>
  <input type="hidden" name="page" value="&params[:page]"/>
  <input type="hidden" name="table" value="2"/>
  <submit label="Show page 2"/>
</form> 
```

然后在每个表周围放置 if 语句：

```
<if test="&params[:table].to_i==2">
   <h2> table 2 </h2>      
   <table-plus .../>
</if> 
```

我还建议向 hobo-users 发帖——那里有一个更活跃的社区。

# jbpm - JBPM 5.3 领域特定流程

> ID：12362674
> 
> 赞同：0
> 
> 时间：2012-09-11T04:15:44.757
> 
> 标签：jbpm

我在 jbpm 5.3 eclipse 工具中创建了 2 个特定于域的进程。然后我将它们存储在我自己的服务存储库中，并将这两个进程导入到同一个 jbpm 项目中。

但是，我只在调色板中看到一个进程。是否可以在调色板中显示/查看两个进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T11:00:04.903

对于您的特定领域示例，您必须首先知道 JBPM 5.4 支持流口水..

对于特定领域的示例，您必须在 src/main/resources 中创建一个 METAS-INF 文件夹

并在其中创建两个文件

在 drools.rulebase.conf

```
 drools.workDefinitions = MyDefinitions.conf 
```

现在在MyDefinitions.conf 中的 MyDefinitions.conf 是我的示例，对于您来说，它会有所不同`import org.drools.process.core.datatype.impl.type.StringDataType; import org.drools.process.core.datatype.impl.type.ObjectDataType; [ // the Shipment work item [ "name" : "Shipment", "parameters" : [ "ShipmentId" : new StringDataType(), "To" : new StringDataType() ], "results" : [ "Result" : new ObjectDataType() ], "displayName" : "Shipping","customEditor":org.drools.eclipse.flow.common.editor.editpart.work.SampleCustomEditor", "icon" : "icons/shipping.gif" ] ]` 

还在您的规则文件夹中的图标文件夹规则中导入您的域的图标

# python - 在同一行上打印函数输出和字符串？

> ID：12362681
> 
> 赞同：0
> 
> 时间：2012-09-11T04:16:18.237
> 
> 标签：python, string, printing

我正在编写一个程序，该程序应该在这样的星星组成的框中打印一个单词：

```
************
*          *
* danielle *
*          *
************ 
```

但是，我得到以下输出：

```
************
*           
None *
* danielle *
*           
None *
************ 
```

我知道我一直得到“无”的输出，因为我不能在同一行上输出`print`一个和一个函数。`string`我怎么能这样做？

我的代码如下：

```
 def star_str(length):
    stars = '*'*length
    print stars

def spaces_str(length):
    spaces = " "*length
    print spaces

def frame_word(input_word):
    length = len(input_word)
    top_bottom_stars = length + 4
    spaces_middle = length + 2

    star_str(top_bottom_stars)
    print '*', spaces_str(spaces_middle), '*'
    print '*', input_word, '*'
    print '*', spaces_str(spaces_middle), '*'

    star_str(top_bottom_stars)

print "Please enter a word:",
input_word = raw_input()
frame_word(input_word) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:18:37.813

您的问题是由于您正在调用一个在 print 语句中打印某些内容的函数。我的建议是拥有`spaces_str()`并`star_str()` *返回*字符串而不是打印它。

更好的是，完全消除这些功能。`" " * 40`是完全可读和惯用的；将它包装在一个函数中只是要输入更多字符，而不会增加可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:18:49.903

在方法的末尾给出一个 return 语句而不是 print ，现在你下面的 print 将产生正确的结果

```
def spaces_str(length):
    spaces = " "*length
    return spaces
print '*', spaces_str(spaces_middle), '*' 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-11T08:50:22.523

我会使用@kindall 和`return`字符串，而不仅仅是打印它，但也会指出，可以`print`通过使用尾随逗号来抑制语句的显式换行符：

```
def test_print():
    print 'one',
    print 'two',
    print 'three'

test_print()
# one two three 
```

那么你*可以*但**不应该**写：

```
print '*', # suppresses newline
spaces_str() # this prints using something as above
print '*' # asterisk and newline 
```

# sql - 将包含视图的代码转换为存储过程

> ID：12362686
> 
> 赞同：2
> 
> 时间：2012-09-11T04:16:49.267
> 
> 标签：sql, stored-procedures, views

我将这段代码拼凑在一起，以根据每个经销商的发票小计总和创建一个支点。它有效，并产生正确的结果。但是，当我尝试将其转换为存储过程时，臭名昭著的波浪形红线出现在 SQL Server 管理工作室的“CREATE VIEW Revenues”下，并且错误显示：

'CREATE VIEW 必须是批处理中的唯一语句'，我不知道足够的 T-SQL 来继续，因为我需要能够从 ASP.NET/C# Web 应用程序执行它。

我正在尝试通过放置来创建一个 SP：

1)

```
USE [Sherwood]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[usp_GetRevenues] 

@StartDate AS DateTime = '20120301',
@EndDate AS DateTime = '20120401'
AS
SET NOCOUNT ON;

BEGIN 
```

在前面，最后有一个 END 语句。

2）参数是能够过滤数据几个月的必要条件，但我似乎无法通过代码传递参数或使用变量。

提前致谢。

代码如下 - 显示我需要在哪里过滤变量。该代码仅适用于 where 子句中格式为“1/1/2012”的日期，但需要能够传递变量，如图所示。

--=================================

```
CREATE VIEW Revenues
AS
SELECT  
i.DateOrdered
,LTRIM(STR(DATEPART(MONTH,i.DateOrdered))) AS [Month]  
,LTRIM(STR(YEAR(i.Dateordered))) AS [Year]  
,c.CustomerCode
,SUM(i.Jobprice) AS Subtotal 
FROM Invoices i
JOIN
Customers c
ON i.CustomerID = c.ID
WHERE i.DateOrdered >= @StartDate 
AND i.DateOrdered <= @EndDate **<-- and here.**  
GROUP BY ROLLUP (YEAR(i.DateOrdered), 
MONTH(i.DateOrdered), i.DateOrdered, c.CustomerCode);
GO

IF OBJECT_ID('Revenues2') IS NOT NULL
DROP VIEW Revenues2
GO

CREATE VIEW Revenues2
AS
SELECT 
 LTRIM(STR([YEAR])) + '-' + STUFF([Month],1,0, REPLICATE('0', 2 - LEN([Month]))) 
 AS [Date] 
,Subtotal
,CustomerCode
FROM Revenues
WHERE CustomerCode IS NOT NULL
GO

DECLARE @query VARCHAR(4000)  
DECLARE @years VARCHAR(2000)  
SELECT  @years = STUFF(( SELECT DISTINCT 
                    '],[' + [Date]  
                    FROM  Revenues2 
                    ORDER BY '],[' + [Date]  
                    FOR XML PATH('')  
                    ), 1, 2, '') + ']' 

SET @query =  
'SELECT * FROM  
(  
  SELECT Subtotal,[Date],CustomerCode  
   FROM Revenues2  
)t  
PIVOT (SUM(Subtotal) FOR [Date] 
IN ('+ @years +')) AS pvt' 

EXECUTE (@query) 
```

--===========================================

问候

悬崖

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:28:09.373

您可以改为使用临时表尝试此操作。

就像是

```
SELECT   
i.DateOrdered 
,LTRIM(STR(DATEPART(MONTH,i.DateOrdered))) AS [Month]   
,LTRIM(STR(YEAR(i.Dateordered))) AS [Year]   
,c.CustomerCode 
,SUM(i.Jobprice) AS Subtotal  
INTO #Revenues
FROM Invoices i 
JOIN 
Customers c 
ON i.CustomerID = c.ID 
WHERE i.DateOrdered >= @StartDate  
AND i.DateOrdered <= @EndDate **<-- and here.**   
GROUP BY ROLLUP (YEAR(i.DateOrdered),  
MONTH(i.DateOrdered), i.DateOrdered, c.CustomerCode)

SELECT  
 LTRIM(STR([YEAR])) + '-' + STUFF([Month],1,0, REPLICATE('0', 2 - LEN([Month])))  
 AS [Date]  
,Subtotal 
,CustomerCode 
INTO #Revenues2
FROM #Revenues 
WHERE CustomerCode IS NOT NULL 

DECLARE @query VARCHAR(4000)   
DECLARE @years VARCHAR(2000)   
SELECT  @years = STUFF(( SELECT DISTINCT  
                    '],[' + [Date]   
                    FROM  #Revenues2  
                    ORDER BY '],[' + [Date]   
                    FOR XML PATH('')   
                    ), 1, 2, '') + ']'  

SET @query =   
'SELECT * FROM   
(   
  SELECT Subtotal,[Date],CustomerCode   
   FROM #Revenues2   
)t   
PIVOT (SUM(Subtotal) FOR [Date]  
IN ('+ @years +')) AS pvt'  

EXECUTE (@query)

DROP TABLE #Revenues
DROP TABLE #Revenues2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:56:57.250

我可能错了，但在我看来，当您转换为 SP 时，您并没有删除/评论“CREATE VIEW”部分。这是错误的，因为您无法从存储过程的定义中定义视图 - 因此“CREATE VIEW must be(...)”投诉。

此外，您的代码有点脆弱：一旦您正确创建了 SP，下次运行它会出错，并显示“SP 已使用，您应该使用 ALTER PROC”或类似的消息（我是凭记忆写的）。

像这样的代码应该可以解决这两个问题：

```
USE [Sherwood]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- It's preferable to set these options before creating an SP,
-- rather than within its execution
SET NOCOUNT ON
GO
IF OBJECT_ID('usp_GetRevenues') IS NOT NULL
    DROP PROC usp_GetRevenues
GO
CREATE PROC [dbo].[usp_GetRevenues] 
    @StartDate AS DateTime = '20120301',
    @EndDate AS DateTime = '20120401' AS
-- BEGIN --This is really optional
SELECT  
i.DateOrdered
,LTRIM(STR(DATEPART(MONTH,i.DateOrdered))) AS [Month]  
,LTRIM(STR(YEAR(i.Dateordered))) AS [Year]  
,c.CustomerCode
,SUM(i.Jobprice) AS Subtotal 
FROM dbo.Invoices i
JOIN dbo.Customers c
ON i.CustomerID = c.ID
WHERE i.DateOrdered >= @StartDate 
AND i.DateOrdered <= @EndDate **<-- and here.**  
GROUP BY ROLLUP (YEAR(i.DateOrdered), 
MONTH(i.DateOrdered), i.DateOrdered, c.CustomerCode);
GO 
```

# algorithm - 新闻排名算法？

> ID：12362690
> 
> 赞同：-1
> 
> 时间：2012-09-11T04:17:19.047
> 
> 标签：algorithm, ranking

现在。我建立了一个新闻公式来获取热门新闻。有任何因素，如浏览量、时间、内容。这个问题有什么解决方案？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T05:39:59.023

您可以尝试使用[机器学习](http://en.wikipedia.org/wiki/Machine_learning)方法来解决此问题。

1.  提取您的特征，并为每个特征赋予一个数值（您可以使用[词袋模型](http://en.wikipedia.org/wiki/Bag-of-words_model)作为内容）。请注意，可能需要一些[特征选择算法。](http://en.wikipedia.org/wiki/Feature_selection)
2.  手动标记足够大的示例集 - 并根据其重要性为每个示例打分。
3.  使用[线性回归](http://en.wikipedia.org/wiki/Linear_regression)并构建一个函数来评估每篇文章并为其打分。
4.  现在你有了回归函数，你可以用它来给每篇文章打分。使用它来获得原始分数。
5.  对于后期处理 - 将此分数与第二个函数中的时间相结合，以获得文章的最终分数。[@MattBall 的建议链接](https://stackoverflow.com/q/3783892/572670)似乎是合理的方法。

# javascript - jQuery滑出菜单

> ID：12362692
> 
> 赞同：0
> 
> 时间：2012-09-11T04:17:51.107
> 
> 标签：javascript, jquery, html, css

[http://jsfiddle.net/HfdXY/368/](http://jsfiddle.net/HfdXY/368/)

那是我的 Jfiddle，我有几个问题。

1.  为什么我的按钮只在第一次点击时滑出，然后从那里保持静止？

2.  如何将代码放在一个函数中，而不是有两个实例，唯一的区别是按钮 B 的 CSS 向左移动了 40 像素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:47:04.543

1.  将“右”动画更改为“左”。[http://jsfiddle.net/73qaC/2/](http://jsfiddle.net/73qaC/2/) 您只想将左侧像素位置从 0 更改为 xx 并再次返回。

2.  更新了上面的 jFiddle 以使用 1 方法。这应该让您了解如何使用一种方法来实现这一目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:30:14.760

For your second one this is my solution

```
$("#openMenu,#openMenu2").click(function() {}) 
```

put like this and give the following code of your at once.and then you can seperatly create its css inside it like

```
$("#openMenu").css();
$("#openMenu2").css(); 
```

# sql - 是否可以在不使用临时表的情况下使用单个选择语句在 sql 中显示两个日期之间的月份

> ID：12362693
> 
> 赞同：-1
> 
> 时间：2012-09-11T04:17:52.823
> 
> 标签：sql, sql-server, sql-server-2008

> **可能重复：**
> [两个日期之间的月份](https://stackoverflow.com/questions/7885851/months-between-two-dates)

我有日期范围现在`[start date] = '2012-09-01'`，`[finish date] = '2014-01-01'`
我需要显示两个日期之间的月份..使用单个选择语句

```
Expected Output :          
9
10
11
12
1
2
3
.
.
.
12
1 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:45:43.143

```
DECLARE @StartDate  DATETIME,
        @EndDate    DATETIME;

SELECT   @StartDate = '20120901'        
        ,@EndDate   = '20140101';

;WITH MONTHS (date)
AS
(
    SELECT @StartDate
    UNION ALL
    SELECT DATEADD(MONTH,1,date)
    FROM MONTHS
    WHERE DATEADD(MONTH,1,date)<=@EndDate
)
SELECT MONTH(date) AS MONTH FROM MONTHS 
```

结果：

```
MONTH
-----------
9
10
11
12
1
2
3
4
5
6
7
8
9
10
11
12
1

(17 row(s) affected) 
```

编辑：根据您更新的要求，您可以使用以下查询实现此目的：

```
DECLARE @StartDate  DATETIME,
        @EndDate    DATETIME;

SELECT   @StartDate = '20120901'        
        ,@EndDate   = '20140101';

SELECT  MONTH(DATEADD(MONTH, x.number, @StartDate)) AS Months
FROM    master.dbo.spt_values x
WHERE   x.type = 'P'        
AND     x.number <= DATEDIFF(MONTH, @StartDate, @EndDate); 
```

结果：

```
Months
-----------
9
10
11
12
1
2
3
4
5
6
7
8
9
10
11
12
1

(17 row(s) affected) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:15:25.883

您还可以使用表变量：

```
DECLARE @startdt DATETIME, @enddt DATETIME
SELECT @startdt =  '2012-09-01', @enddt =  '2014-01-01'

DECLARE @Months TABLE (Months INT)

INSERT INTO @Months VALUES (MONTH(@startdt))
WHILE @startdt < @enddt
BEGIN
 SET  @startdt = DATEADD(MONTH,1,@startdt)
 INSERT INTO @Months VALUES (MONTH(@startdt))
END

SELECT * FROM @Months 
```

# python - 对 python 类和实例变量感到困惑

> ID：12362698
> 
> 赞同：3
> 
> 时间：2012-09-11T04:18:29.780
> 
> 标签：python, syntax

我看到以下 Python 文档说“在类中定义变量”将是类变量：

> "**程序员注：**类定义中定义的变量是类变量；它们被所有实例共享。"

但是当我写这样的示例代码时：

```
class CustomizedMethods(object):
    class_var1 = 'foo'
    class_var2 = 'bar'

cm1 = CustomizedMethods()
cm2 = CustomizedMethods()
print cm1.class_var1, cm1.class_var2 #'foo bar'
print cm2.class_var1, cm2.class_var2 #'foo bar'
cm2.class_var1, cm2.class_var2 = 'bar','for'
print cm1.class_var1, cm1.class_var2 #'foo bar' #here not changed as my expectation
print cm2.class_var1, cm2.class_var2 #'bar foo' #here has changed but they seemed to become instance variables. 
```

我很困惑，因为我尝试的与 Python 的官方文档不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T04:27:14.997

当您在实例上分配属性时，它会在实例上分配，即使它以前存在于类中。起初，`class_var1`确实`class_var2`是类属性。但是当你这样做时`cm1.class_var1 = "bar"`，你并没有改变这个类属性。相反，您正在创建一个新属性，也称为`class_var1`，但这是 instance 上的一个实例属性`cm1`。

这是另一个显示差异的示例，尽管仍然可能有点难以掌握：

```
>>> class A(object):
...     var = []
>>> a = A()
>>> a.var is A.var
True
>>> a.var = []
>>> a.var is A.var
False 
```

起初，`a.var is A.var`是真的（即它们是同一个对象）：因为`a`没有它自己的名为 的属性`var`，所以试图访问该类。在你给`a`它自己的实例属性之后，它就不再和类上的一样了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:27:53.513

您正在为实例分配属性，所以是的，它们此时成为实例变量。Python 在您指定的任何对象上查找属性，然后如果在其中找不到它们，则查找继承链（到类、类的父类等）。因此，您在实例上分配的属性“阴影”或“隐藏”类的同名属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:26:43.980

当您重新分配`cm2`变量时，您创建了“隐藏”类变量的新实例变量。

```
>>> CustomizedMethods.class_var1 = 'one'
>>> CustomizedMethods.class_var2 = 'two'
>>> print cm1.class_var1, cm1.class_var2
one two
>>> print cm2.class_var1, cm2.class_var2
bar for 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T04:27:03.140

字符串是不可变的，因此类和实例变量之间的区别并不明显。对于类定义中的不可变变量，主要需要注意的是内存使用较少（即，如果您有 1,000 个 CustomizedMethods 实例，则仍然只有一个字符串“foo”的实例存储在内存中。）

但是，如果您不知道自己在做什么，在类中使用可变变量可能会引入细微的错误。

考虑：

```
class CustomizedMethods(object):
    class_var = {}

cm1 = CustomizedMethods()
cm2 = CustomizedMethods()

cm1.class_var['test'] = 'foo'
print cm2.class_var
  'foo'

cm2.class_var['test'] = 'bar'
print cm1.class_var
   'bar' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-11T08:30:18.930

尝试

```
print cm1.__dict__ 
print cm2.__dict__ 
```

这将是启发...

当您向 cm2 询问一个属性时，它首先在实例的属性中查找（如果有一个与名称匹配），然后在类属性中查找**是否没有匹配**的属性。

所以 class_var1 和 class_var2 是类属性的名称。

还可以尝试以下方法：

```
cm2.__class__.class_var1 = "bar_foo" 
print cm1.class_var1 
```

你能指望什么？

# objective-c - 如何从一个 sip 帐户向多个 sip 帐户拨打多个电话？

> ID：12362701
> 
> 赞同：3
> 
> 时间：2012-09-11T04:18:44.040
> 
> 标签：objective-c, ios, sip, voip, pjsip

我没有pjsip的经验。现在我想在 iPhone 中编写一个这样的功能：从我的 sip 号码中，我多次呼叫一组 sip 号码。如果有人接听电话，其他人将被拒绝。我正在使用 pjsip 库在 iPhone 中开发我的应用程序。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T15:36:11.837

pjsip 确实允许从同一个帐户进行多次调用。它受此*PJSUA_MAX_CALLS限制*

浏览 simple_pjsua.c。它确实提供了一个很好的例子来说明你所问的。

在这里你会找到*'on_call_state*，只要调用状态发生变化，就会调用这个回调。通常，每当呼叫被应答时，呼叫状态将转换为*PJSIP_INV_STATE_CONNECTING/PJSIP_INV_STATE_CONFIRMED*，因为接收/发送 200OK/ACK。

要拨打电话，请查找*pjsua_call_make_call*

祝你好运！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-12T12:51:18.283

请查看函数 cmd_make_multi_call 中的 pjsua_app_cli.c。

```
for (i=0; i<count; ++i) {
pj_status_t status;

status = pjsua_call_make_call(current_acc, &tmp, &call_opt, NULL,
    NULL, NULL);
if (status != PJ_SUCCESS)
    break;
} 
```

希望能帮助到你！

# python - 忽略 NaN 在 Python 中平均两行

> ID：12362703
> 
> 赞同：1
> 
> 时间：2012-09-11T04:18:59.297
> 
> 标签：python, arrays, numpy, average, mean

我有一个二维数据数组。我需要平均每两行，并返回一个高度为一半的数组的平均值。为了平均目的，我还需要忽略所有 NaN 值。例如：

```
>>> x = numpy.array([[ 1,  nan,  3,  4,  5],
... [ 6,  7,  8,  9, nan],
... [11, 12, 13, 14, nan],
... [16, nan, 18, 19, nan]]) 
```

该函数需要返回：

```
>>> x
array([[3.5,  7,  5.5,  6.5,  5],
[13.5, 12, 15.5, 16.5, nan]]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:33:11.250

This should do the trick:

```
numpy.ma.average(numpy.ma.masked_invalid(x).reshape(-1, 2, x.shape[-1]), 1) 
```

For me it returns

```
masked_array(data =
 [[3.5 7.0 5.5 6.5 5.0]
 [13.5 12.0 15.5 16.5 --]],
             mask =
 [[False False False False False]
 [False False False False  True]],
       fill_value = 1e+20) 
```

# wordpress - 在 wordpress 中转义撇号

> ID：12362704
> 
> 赞同：1
> 
> 时间：2012-09-11T04:19:05.583
> 
> 标签：wordpress, escaping, apostrophe, stripslashes

我为 wordpress 编写了一个插件，用于存储餐厅菜单项。但是，每当使用撇号时，wordpress 在管理和前端都用斜杠转义它们，并在每次保存时不断在文本中添加斜杠。

这是我作为邮政编码的摘录和示例：

```
$dinnerEntree2 = $_POST[$dinnerEntree_option];
for ($i=1; $i<= $dinner_menu_item_number_saved; $i++) {

// entree   dinner_menu_entree_option
$dinnerEntree = "dinner_menu_".$i."_entree";
$dinnerEntree_saved = "dinner_menu_".$i."_entree_save";
$dinnerEntree_option = "dinner_menu_".$i."_entree_option";
$dinnerEntree_saved2 = get_option($ingredients);
$dinnerEntree2 = $_POST[$dinnerEntree_option];

if ($dinnerEntree_saved2 != $dinnerEntree2)
if(!update_option($dinnerEntree,$dinnerEntree2))
$message='failed to save large entree';
// end of entree 
```

并在输入表单字段中：

```
<input type="text" name="dinner_menu_<?php echo $i ?>_entree_option" value="<?php echo get_option($dinnerEntree);  ?>" size="40"/></span> 
```

我试过stripslashes，但没有运气。多年来一直在讨论这个问题，但我没有看到 wordpress 的明确解决方案。我的服务器上的魔术行情已关闭....有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T07:15:24.370

利用

```
$dinnerEntree2 = stripslashes_deep( $_POST[$dinnerEntree_option] ); 
```

参考：[`stripslashes_deep()`](http://codex.wordpress.org/Function_Reference/stripslashes_deep)

注意：它应该在任何（而不是在）与`$wpdb`.

# ruby-on-rails - Rails：应用程序中与一个模型的关联

> ID：12362707
> 
> 赞同：0
> 
> 时间：2012-09-11T04:19:41.510
> 
> 标签：ruby-on-rails

我已经阅读了很多 Rails 书籍/教程，但是到了真正制作应用程序的时候，我一直在绊倒自己，所以我正在尝试这个小练习来帮助我把它变得更好。

我有一个包含 3 个类（Link、Url、Visit）的应用程序，它们之间定义了关联，例如 has_one、belongs_to 等。这允许我调用类似的方法`Link.url`

如果我要将其转换为具有单个模型的应用程序，是否可以创建便捷方法（例如 Link.url），即使模型之间没有关系，因为只有一个模型。

这可能不是“Rails 方式”，但如果您回答这个问题，它将帮助我获得更多。我想问这个问题的另一种方法是，Rails 关联是否只存在因为选项卡

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:26:48.753

存在模型来表示数据库中的表。如果您有 3 个不同的概念对象，那么您需要 3 个不同的模型。将这些对象分开并保存在不同的表/模型中对于使用任何语言进行良好的编程都是必不可少的。这些关系可以帮助您了解每个对象与其他对象的相关性。

如果您认为每个模型的所有数据都可以合理地表示在一个表中，那么将它们组合成一个模型，其名称包含所有数据。如果您选择此选项，您将使用该表的列来表示您需要的每条数据。创建迁移时，这些列名称在模型中是免费的。在名为“Hit”的模型上具有名为“url”的列的表可以这样使用：

```
Hit.first.url 
```

# c# - 如何管理水晶报表中不断增长的参数字段之间的空间？

> ID：12362708
> 
> 赞同：1
> 
> 时间：2012-09-11T04:19:45.850
> 
> 标签：c#, .net, crystal-reports

在 Crystal 报表中，我从 C# 应用程序传递了两个文本字符串。这两个参数基本上都是文本字符串段落，其中可以包含任何单词。

问题是我无法管理两个段落之间的间距。由于它们是动态的，我无法修复它们的高度。如果有更多文本通过一个顶部段落c 超过底部段落，但如果顶部段落中的文本较少，则报告将大区域显示为空白空间。

无论文本的数量是多少，要求是段落之间应该有恒定的空间（两个换行符）。请指导我如何管理它。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T11:04:02.997

将这些字段放在不同的小节中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T10:59:04.003

将这些参数放在**文本对象**中，然后将文本对象的**Can Grow**属性设置为 True。试试这个并返回你的结果。

# algorithm - 伪代码算法，用于计算从 N 个不相等向量中选择的 N 个值的所有排列而不重复

> ID：12362709
> 
> 赞同：1
> 
> 时间：2012-09-11T04:19:48.887
> 
> 标签：algorithm, set, permutation, pseudocode

这个问题是针对我正在尝试编写的一个程序，该程序涉及将物理部件链连接在一起。我相信我已将其提炼成最简单的问题形式。如果有人知道描述此问题的任何其他词，我也将不胜感激，因为搜索相关问题的大约 30 分钟甚至没有为这个问题找到一个名称。

你有 N 个向量。如果您从每个向量中选择一个值并且不允许任何重复，那么您将得到一个我试图找到的类型的排列。什么是伪代码算法可以在没有暴力破解的情况下找到所有这些？

示例：
您有向量

```
v1=[1 2]   v2=[1 2 3]   v3=[1 2 3 4] 
```

（编辑说明：向量的嵌套是无意的，不能在算法中利用。）您从每个向量中选择值并且不允许重复。

```
Value 1 is from v1 ---> 2
Value 2 is from v2 ---> 1   
Value 3 is from v3 ---> 4

Resulting permutation is [2 1 4]. 
```

这是一种允许的排列。这是一个不允许的排列示例，因为它重复。

```
Value 1 is from v1 ---> 2
Value 2 is from v2 ---> 1
Value 3 is from v3 ---> 2    

Resulting permutation is [2 1 2], which is invalid due to repeats. 
```

什么是找到所有有效排列的算法？

如果您可以在计算之前计算出有多少排列，则可以加分。

如果我能在其他人之前找到答案，我一定会回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T05:05:42.240

您给出的示例具有嵌套向量，这意味着 中的条目是 中的条目`v_i`的子集`v_{i+1}`。如果这确实是您的应用程序的一般情况，那么解决方案的数量很简单：

```
n_1 * (n_2 - 1) * ... * (n_k - (k-1)) 
```

其中`n_i`是长度，`v_i`并且有`k`嵌套向量。

就算法而言，如果您想生成所有可能的解决方案，那么我找不到比在消除已选择的条目后从每个连续向量中进行选择更好的方法。

如果您没有嵌套，则可视化此问题的一种好方法是在以下意义上将其视为[婚姻问题。](http://en.wikipedia.org/wiki/Hall%27s_marriage_theorem)制作与给定向量`k`对应的顶点`k`

```
v_1  v_2 ...  v_k 
```

`m`和对应于组合向量的不同条目的另一个顶点

```
a_1 a_2 ... a_m 
```

然后连接`a_i`当`v_j`且仅当`a_i`出现在 中`v_j`。目标是在s 和接触所有 s 的 s之间找到[最大匹配](http://en.wikipedia.org/wiki/Matching_%28graph_theory%29)。也就是说，选择边以使每个边都恰好是一条边的端点。`v``a``v``k``v_i`

任何标准算法，例如使用增强路径，都可以找到一个解决方案或生成所有解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T05:07:31.797

我认为你可以逐步解决这个问题。设 s1, s2, s3,..,sk 是涉及 v1, v2, .., vn 的解。现在对于每个当前解决方案 si 和元素 j（vn+1 中的 j）使用 vn+1，查看 j 是否已经在 si 中，如果没有，则将其添加到您的新集合中（对应于 n+1）。

1.  为 v1 中的 j 初始化 S={ {j} }
2.  对于 n=2..m：
    1.  新 = {}
    2.  对于 vn 中的 j
        1.  对于 s 在 S
            1.  如果 j 不在 s 中，则将 sU{j} 添加到 newS S = newS
3.  返回 S

# ajax - 在 jQuery 代码中添加微调器图像

> ID：12362712
> 
> 赞同：0
> 
> 时间：2012-09-11T04:20:05.583
> 
> 标签：ajax, spinner, preloader

我有一个 jquery 来显示 div 中的链接而无需重新加载页面：jQuery 代码：

```
<script type="text/javascript">
$(document).ready(function() {
    $("a").click(function(event) {
        // Prevent default click action if javascript is enabled
        event.preventDefault();
    //load the content of the new page into the content of the current page
    $("#content").load( $(this).attr("href") + " #content");
    })
});
</script> 
```

一切都很好并且工作正常，但这就是这么简单！如何在此代码中加载内容之前添加加载图像？

第二个问题，有没有办法在加载后在地址栏中显示新的页面链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T04:26:13.347

您可以使用回调函数来删除加载程序。

```
<script type="text/javascript">
$(document).ready(function() {
    $("a").click(function(event) {
        // Prevent default click action if javascript is enabled
        event.preventDefault();
        //load the content of the new page into the content of the current page
        $('#loader').show(); // Show some hidden loader on the page
        $("#content").load( $(this).attr("href") + " #content", function() {
            $('#loader').hide(); // Hide the loader when it completely loads the given URL.
        });
    })
});
</script> 
```

对于您的第二个问题，这应该是答案。[更改浏览器中的 URL 而不使用 JavaScript 加载新页面](https://stackoverflow.com/questions/136458/change-the-url-in-the-browser-without-loading-the-new-page-using-javascript)

# string - 如何在经典asp中将信息从另一个网站检索到我的网站

> ID：12362713
> 
> 赞同：0
> 
> 时间：2012-09-11T04:20:11.977
> 
> 标签：string, asp-classic

我想从其他网站检索产品状态到我的网站。为此，我正在使用此代码。

```
Dim xml
set xml = Server.CreateObject("Microsoft.XMLHTTP")
xml.Open "GET", "http://www.midwayusa.com/Product/"&sCode  , false
xml.Send

Dim strRetrive,strtCnt,endCnt,strStatus,strShippingMessage,a
strRetrive=xml.responseText
strtCnt=InStr(strRetrive,"productStatus")
strtCnt=Instr(strtCnt,strRetrive,">")
endCnt=Instr(strtCnt,strRetrive,"<")
strStatus = (mid(strRetrive,(strtCnt+1),(endCnt-(strtCnt+1))))
getStatusFromMidway = trim(a) 
```

这给了我状态，但有很多空格和不需要的字符。我尝试了修剪功能，但这根本没有删除空格。之后，我尝试了 Replace(vari," ","")，但它从字符串中删除了所有不好的空格..

现在，我正在考虑使用 XML DOM 或类似功能，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T22:50:21.177

用删除所有前导和尾随非单词字符的此功能 (SuperTrim) 替换您的 Trim。

例如。添加此函数并将**getStatusFromMidway = trim(a)**更改为**getStatusFromMidway = SuperTrim(a)**

```
Function SuperTrim(input)
    Dim regex, result
    Set regex = New RegExp
    regex.Pattern = "^\W+"
    regex.IgnoreCase = True
    regex.Global = True
    result = regex.Replace(input, "")
    regex.Pattern = "\W+$"
    result = regex.Replace(result, "")
    Set regex = nothing
    SuperTrim = result
End Function 
```

# jquery - jQuery 使用 .get() 方法将类添加到对象

> ID：12362716
> 
> 赞同：5
> 
> 时间：2012-09-11T04:20:42.600
> 
> 标签：jquery, html, dom, get, indexing

遇到了一件奇怪的事情，我不确定发生了什么。

我已经通过 获取了 DOM 元素的索引，通过`.index()`找到了匹配的元素`.get()`，我正在尝试通过`.addClass()`.

我的控制台返回错误：“ `Uncaught TypeError: Object #<HTMLLIElement> has no method 'addClass'`”......这特别奇怪，因为我的日志显示 HTML 元素很好（http://cloud.dhut.ch/image/2W3S0R3k2h2U）

我错过了什么吗？它不会以数组或任何东西的形式返回。使困惑。

谢谢！

JavaScript：

`nFLi.get(active).addClass('active')`;

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-11T07:42:12.307

您需要将其包装到一个 jquery 对象中。

```
$(nFLi.get(active)).addClass('active'); 
```

或者你可以使用[.eq](http://api.jquery.com/eq/)方法而不是`.get`，它返回一个 jquery 对象而不是原始的 HTMLElement。

```
nFLi.eq(active).addClass('active'); 
```

# html - 使用 CSS，我可以在悬停时增加背景图像的对比度吗？

> ID：12362719
> 
> 赞同：5
> 
> 时间：2012-09-11T04:20:59.607
> 
> 标签：html, css

我已经研究过关于这个的其他线程，但他们都建议使用不透明度和透明度。

但我想做相反的事情：*增加*背景图像的对比度（同时使用相同的 BG 图像），或者实现类似的其他方式。

提前非常感谢。问候

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T04:26:23.833

尝试将背景放在纯黑色背景上，将不透明度设置为 0.8 或 0.9，然后在悬停时将其设置为 1.0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T04:39:47.010

如果你限制自己使用 Webkit，你可以使用一些你可以弄乱的过滤器属性：

[http://html5-demos.appspot.com/static/css/filters/index.html](http://html5-demos.appspot.com/static/css/filters/index.html)

如果你想要更多……好​​吧，似乎每个主要浏览器都有自己的支持（*[是](https://developer.mozilla.org/en-US/docs/Applying_SVG_effects_to_HTML_content)* 的，甚至是[Internet Explorer](http://msdn.microsoft.com/en-us/library/ms532853%28v=vs.85%29) : ）。不过，我不确定如何将它们拼凑成一个全面的解决方案。

# php - 使用 PHP 和 GD 破坏图像

> ID：12362720
> 
> 赞同：1
> 
> 时间：2012-09-11T04:21:02.810
> 
> 标签：php, image, gd

这是我一直在尝试做的，但它总是显示损坏的图像。我什至启用了错误报告，但一切似乎都恢复正常......只是没有显示图像。:(

[http://www.tradenepal.com.np/test.php](http://www.tradenepal.com.np/test.php)

```
<?php
    //Report all Errors
    ini_set("display_errors", "1");
    error_reporting(E_ALL); 

    //Set content type
    header('content-type: image/jpeg');

    //Store the values of our date in separate variables 
    list($month, $day, $year) = explode('/', date('F/jS/Y'));

    //Load our base image 
    $image = imagecreatefrompng('calendar_blank.png');
    $image_width = imagesx($image);

    //Setup colors and font file 
    $white = imagecolorallocate($image, 255, 255, 255);
    $black = imagecolorallocate($image, 0, 0, 0);
    $font_path = 'advent_light';

    //Get the positions of the text string
    $pos_month = imagettfbbox(13, 0, $font_path, $month);
    $pos_day = imagettfbbox(25, 0, $font_path, $day);
    $pos_year = imagettfbbox(8, 0, $font_path, $year);

    //Create Month
    imagettftext($image, 13, 0, ($image_width - $pos_month[2]) / 2, 40, $white, $font_path, $month);

    //Create Day 
    imagettftext($image, 25, 0, ($image_width - $pos_day[2]) / 2, 80, $black, $font_path, $day);

    //Create Year
    imagettftext($image, 8, 0, ($image_width - $pos_year[2]) / 2, 100, $black, $font_path, $year);

    //Create final image 
    imagejpeg($image, '', 100);

    //Clear up memory;
    imagedestroy($image);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:37:57.447

您的脚本的输出如下。如果您删除您的内容类型标头，或者使用诸如 Fiddler 之类的工具，您可以自己看到这一点。此外，有了这些“免费网络托管”行，您将永远无法使用它。

* * *

**PHP 错误消息**
**警告**：imagecreatefrompng(calendar_blank.png) [function.imagecreatefrompng]：无法打开流：第**13**行的**/home/a5838755/public_html/test.php**中没有此类文件或目录免费虚拟主机**PHP 错误消息****警告**：imagesx ()：提供的参数不是第**14**行**/home/a5838755/public_html/test.php**中的有效图像资源免费虚拟主机**PHP 错误消息****警告**：imagecolorallocate()：提供的参数不是**/home/a5838755中的有效图像资源****/public_html/test.php**第**17**行免费虚拟主机**PHP 错误消息****警告** **********************：imagettfbbox（）[function.imagettfbbox]：无法在第**22**行的**/home/a5838755/public_html/test.php**中找到/打开字体免费虚拟主机**PHP错误消息****警告**：imagettftext（）期望参数1是资源，给定的布尔值在第**27**行的**/home/a5838755/public_html/test.php**免费 Web 托管**PHP 错误消息****警告**：imagejpeg()：提供的参数不是第**36**行的**/home/a5838755/public_html/test.php**中的有效图像资源Free Web托管**PHP 错误消息****警告**：imagedestroy()：提供的参数不是有效的图像资源 ************************/home/a5838755/public_html/test.php**在线**39**

免费虚拟主机********************************************

 ***** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-14T22:46:03.253

我有一个类似的问题。`<?php`在我的情况下，我的标签上方有一些空格。当我删除它们时，它工作得很好。我希望你的问题和我的一样简单。****

# php - 无限期运行PHP脚本，MySQL超时

> ID：12362724
> 
> 赞同：4
> 
> 时间：2012-09-11T04:21:41.990
> 
> 标签：php, mysql

我有一个无限期运行的 PHP 脚本，每 5-10 秒执行一次特定任务（一个 do-while 循环，在每次迭代结束时检查数据库以确定它是否应该继续）。此任务包括 MySQL 数据库查询。处理数据库连接的最佳方法是什么？我是不是该：

**a.)**每次迭代都断开连接然后重新连接到数据库？

**b.)**将连接超时设置为无限期限制？

**c.)** ping 数据库以确保我仍然连接，并在执行和查询之前在必要时重新连接？

**d.)**还有别的吗？

编辑：为了澄清，脚本向用户的 iPhone 发送推送通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:44:06.483

不能将 PHP 脚本作为守护进程运行的建议是荒谬的。我已经做了好几次了，而且效果很好。有[一些示例代码可以帮助您入门](http://kevin.vanzonneveld.net/techblog/article/create_daemons_in_php/)。（需要梨……如果你不是粉丝，请自己动手。）

现在，关于你的实际问题。如果您进行常规查询，您的 MySQL 连接不会超时。该超时适用于空闲连接。绝对保持连接......没有理由断开和重新连接的开销。无论如何，在数据库失败时，由于您的脚本作为守护程序运行，您可能不想立即终止该进程。

我建议处理异常并重新连接。如果您的重新连接失败，请稍候再试一次。在几次失败（无论是什么适当的）之后，您可能会在那个时候终止该进程，因为某些东西可能已经损坏，需要人工干预。

# java - java.sql.Array/Blob/Clob 类型是否需要“free()”？

> ID：12362726
> 
> 赞同：8
> 
> 时间：2012-09-11T04:21:46.520
> 
> 标签：java, jdbc, blob, clob

我是否需要显式调用`free()`数组、clob 等...还是会自动关闭 ResultSet 和/或 Statement 来解决这个问题？javadoc 什么也没说，所以我认为没有必要，但我不想做出不正确的假设。

另外，如果没有必要，是否要立即关闭结果集是个好主意？如果您不打算这样做，我可以看到它可能会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T05:46:31.700

这取决于您使用的供应商和 JDBC 版本。由于所有数据库供应商都不支持数组（例如 MySQL）

这可能就是为什么 javadoc 什么也没说的原因。

我在 oracle 站点的 JavaSE 教程上找到了本教程**[Using Array Object](http://docs.oracle.com/javase/tutorial/jdbc/basics/array.html#releasing_array)**，它说要显式释放资源。

这是另一个链接，它说明了 on 的场景`free()`。 [JDBC 4 的 java.sql.Clob.free() 方法和向后兼容性](https://stackoverflow.com/questions/9684438/jdbc-4s-java-sql-clob-free-method-and-backwards-compatibility)

> 如果没有必要，是否要立即关闭结果集是个好主意？

我认为应该不需要 free()，但是如果它是一个长期运行的事务，那么调用 free() 很好。

引用[教程](http://docs.oracle.com/javase/tutorial/jdbc/basics/array.html#releasing_array)：

> 数组对象至少在创建它们的事务期间保持有效。这可能会导致应用程序在长时间运行的事务期间耗尽资源。应用程序可以通过调用它们的 free 方法来释放 Array 资源。

# hadoop - HDFS 什么时候不可用？

> ID：12362727
> 
> 赞同：0
> 
> 时间：2012-09-11T04:22:02.083
> 
> 标签：hadoop, hdfs

名称节点是 HDFS 的单点故障。这个对吗？

那么Jobtracker呢？如果 Jobtracker 失败，HDFS 是否可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T09:58:20.157

HDFS 完全独立于 Jobtracker。只要至少 NN 启动，HDFS 名义上就可以使用，总体降级取决于关闭的 Datanode 的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T13:49:49.927

正如 Ambar 提到的 HDFS 在文件系统中不依赖于 JobTracker。当前发布的 Hadoop 版本不支持开箱即用的 Namenode 高可用性，但您可以解决它（例如，使用具有共享存储的主动/被动的传统集群解决方案部署 Namenode）。下一个版本 (2.0/0.23) 确实修复了名称节点可用性问题。

您可以在 Aaron Myers 的博客文章[“Hadoop 分布式文件系统 (HDFS) 的高可用性”中阅读更多相关信息](http://www.cloudera.com/blog/2012/03/high-availability-for-the-hadoop-distributed-file-system-hdfs/)

如果 JobTracker 不可用，您将无法执行 map/reduce 作业

# javascript - 启动页面动画

> ID：12362728
> 
> 赞同：1
> 
> 时间：2012-09-11T04:22:21.630
> 
> 标签：javascript, jquery, html

我脑子里有这样的想法，当我的网站加载时，有这行文字或图像说......我不知道，“你好”......然后，大约 2 秒左右后，它顺利而快速当页面与浏览器窗口居中时，我的主页会向右滑动，然后它会停止。当您更改页面时，我的整个网站会水平向左或向右滑动。有人知道如何做到这一点吗？太感谢了！

这是我用于我的网站导航的代码。 [http://www.queness.com/post/356/create-a-vertical-horizo​​ntal-and-diagonal-sliding-content-website-with-jquery](http://www.queness.com/post/356/create-a-vertical-horizontal-and-diagonal-sliding-content-website-with-jquery)

# node.js - 函数返回值在nodejs中未定义

> ID：12362737
> 
> 赞同：4
> 
> 时间：2012-09-11T04:23:27.813
> 
> 标签：node.js, mongodb, callback

我第一次从事 NodeJs 项目。现在我被困在函数通过 JS 返回值并获取值以在 express 中使用。

```
var dbitems = "before fn";
function refreshData(callback) {
        db.open(function (err, db) {
            if (!err) {
                db.collection('emp').find().toArray(function (err, items) {
                    dbitems = items;
                    callback(JSON.stringify(items));
                });
            }
            else {
                console.log("Could not be connnected" + err);
                dbitems = {"value":"not found"};
            }
        });

    }
}

refreshData(function (id) { console.log(id); }); 
```

此函数从 refreshData 中完美检索值并写入控制台。但我需要的是使用检索到的值通过“returnedData”从这个函数发送到 express html 文件

```
exports.index = function (req, res) {
    var valrs = refreshData(function (id) {
        console.log(JSON.parse(id)); ---this again writes data perfectly in the console
    });
    console.log(valrs); -------------------but again resulting in undefined
    res.render('index', { title: 'Express test', returnedData: valrs });
}; 
```

任何帮助，将不胜感激。

谢谢和问候，幸运。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T04:35:43.113

您需要在数据库请求完成后呈现它。所以它需要从回调中调用。

```
exports.index = function (req, res) {
    refreshData(function (id) {
        res.render('index', { title: 'Express test', returnedData: JSON.parse(id) });
    });
}; 
```

它是异步的，所以你不能只是按顺序排列值，需要通过回调。

# apache - 在 RHEL 5.3 中安装 httpd-2.4.3

> ID：12362739
> 
> 赞同：0
> 
> 时间：2012-09-11T04:23:40.293
> 
> 标签：apache, redhat

我已经安装`httpd-2.4.3`在`RHEL 5.3`. 我遵循了基本安装，然后它运行

```
/usr/local/bin/apachectl restart -f /usr/local/conf/httpd.conf 
```

我可以在本地访问 ( `just use telnet localhost 80`) ，但我无法使用我的浏览器从远程访问或从其他服务器 telnet 端口 80 访问。

*   将端口 80 添加到`IPtables`, - 完成
*   `httpd`服务正在运行 - 检查

谢谢回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T09:32:59.757

检查您的 /etc/selinux/config 是否启用。

# objective-c - 在 facebook 用户的 Xcode 中查看 ProfilePicture

> ID：12362740
> 
> 赞同：9
> 
> 时间：2012-09-11T04:23:48.817
> 
> 标签：objective-c, ios, facebook, facebook-graph-api, interface-builder

当我使用

```
self.profilePic.profileID = user.id; 
```

我最终遇到了这个错误

```
-[UIView setProfileID:]: unrecognized selector sent to instance 0x69626f0
2012-09-11 09:49:50.535 TweetApp[992:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UIView setProfileID:]: unrecognized selector sent to instance 0x69626f0' 
```

任何人都可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-06T09:26:14.207

您可以简单地解决此问题。只需将此行代码`[FBProfilePictureView class];`放在方法应用程序的第一行：didFinishLaunchingWithOptions：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [FBProfilePictureView class];
    //...
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-14T07:22:24.817

我相信你在谈论 Facebook Scrumptious 示例项目。如果是这种情况，您必须将 UIView 控件的 Class 设置为`FBProfilePictureView`

![在此处输入图像描述](../Images/3ca2f90cb340a52b2060048f82de1e62.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T00:23:40.870

我有同样的问题，它的aboutcode是正确的。调用[FBProfilePictureView 类]；在您的 AppDelegate 中，问题将得到解决

++

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T04:33:27.610

让我们一步一步来。

`self.profilePic`指您的`UIView`类型属性。

然后你试图设置这个属性的属性`profileID`，但是`UIView`类没有这样的，你得到了异常。

以后从错误信息中你会很容易理解，注意原因：

> '-[UIView setProfileID:]: 无法识别的选择器发送到实例 0x69626f0'

它告诉您该方法`-setProfileID:`是为`UIView*`对象调用的，并且您发布的代码很清楚为什么会发生这种情况。

我想你`profileID`在视图控制器中有属性，那么你会想要使用

```
self.profileID = user.id; 
```

或者如果`self.profilePic`应该支持`profileID`属性那么你初始化它不正确，找到初始化的地方看看会发生什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-22T07:57:40.487

我遇到了同样的问题确保您的个人资料图片是 FBProfilePictureView 的一个实例 转到您的布局并将您的视图类更改为 FBProfilePictureView 注意您的 fb 个人资料图片是 UIView 而不是 ImageView 这意味着您需要添加视图并更改其类到 FBProfilePictureView 不是 ImageView

还在您的应用程序委托 [FBProfilePictureView 类] 的第一行添加此行； ![在此处输入图像描述](../Images/ea0c5355d667deed7a2914faf9f5e7dd.png)

![在此处输入图像描述](../Images/4924545b3dd9b1bdad52dfd80a358f07.png)

# c++ - c++ 等价于 matlab max(find(array < x) 和 min(find(array > x)

> ID：12362743
> 
> 赞同：1
> 
> 时间：2012-09-11T04:24:28.160
> 
> 标签：c++, matlab

与此 matlab 代码等效的 c++ 是什么？我开始了，但我不确定 B 的值是多少，我认为 A 是正确的。

**MATLAB**

```
array = (-1:.001:1)';

    A = max(find(array < 1.0e-2));
    B = min(find(array > 1 - 1.0e-2)); 
```

**C++ 尝试**

```
for(i = 0; i < array.size; i++){
    if(array[i] < 1.0e-2){ 
    k++
    A = k;
   }
    if(array[i] > (1- 1.0e-2)){
    //not sure what to do here
    B = ?;
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:38:10.683

```
for(i = 0; i < array.size; i++){  // Would be faster if you reversed loop direction
    if(array[i] < 1.0e-2)
        A = i;
}

for(i = 0; i < array.size; i++) {
    if(array[i] > 1-1.0e-2) {
        B = i;
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:35:42.730

对于第二点，我会在同一个循环中这样做：

```
if(array[array.size-i-1] > (1 - 1.0e-2)) B = array.size - i; 
```

并在循环之前`B`初始化。`array.size`

本质上，您正在查找数组中索引最低的元素，该元素也大于`1 - 1.0e-2`. 如果您从具有最高索引的元素开始，然后遍历整个数组并在每次满足条件时进行更新，您最终将得到您需要的内容。类似的逻辑适用于第一部分，但您需要设置`A = i+1`而不是递增`k`，因为不能保证数组已排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T04:36:53.720

基本上该命令`A = max(find(array < 1.0e-2));`正在寻找大于 1.02e-2 的数组的最大索引。

要了解这是如何发生的，只需将语句分解为几部分：

`array < 1.0e-2)`返回一个逻辑索引向量。

`find( ... )`将逻辑索引转换为数字索引

`max(...)`返回数值索引列表中的最大值。

C++ 等价物看起来像：

```
int A = -1;
int maxVal = 1.0e-2;
for (int i = array.length-1; i>=0; i--)
   if (array[i] < maxVal){
      A = i;
      break;
   } 
```

要`B`设置另一个循环：

```
int B = -1;
int minVal = 1 - 1.0e-2;

for (int i=0; i<array.length; i++)
    if (array[i] > minVal){
        B = i;
        break;
     } 
```

# html - xslt xml to html：如何匹配名称以xxx开头的元素？

> ID：12362746
> 
> 赞同：-1
> 
> 时间：2012-09-11T04:25:09.577
> 
> 标签：html, xml, xslt, xpath

这是我遇到的一个问题。为了防止 h1 被复制，在 xml 中每个 h1 标签都会在 h1 之后有一个随机数。源 xml 和想要的 html 如下所示：

源代码：

```
<h1_JW1XRT>Hello1</h1_JW1XRT>
<h1_JXZRIE>Hello2</h1_JXZRIE> 
```

转换成html

```
<h1 id="h1_JW1XRT">Hello1</h1>
<h1 id="h1_JXZRIE">Hello2</h1> 
```

我怎样才能写这个模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:31:57.943

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="*[starts-with(name(), 'h1')]">
  <h1 id="{name()}"><xsl:apply-templates/></h1>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于以下 XML 文档**（提供的 XML 片段，包装在单个顶部元素中——成为格式良好的 XML 文档）时：

```
<t>
    <h1_JW1XRT>Hello1</h1_JW1XRT>
    <h1_JXZRIE>Hello2</h1_JXZRIE>
</t> 
```

**产生想要的正确结果：**

```
<h1 id="h1_JW1XRT">Hello1</h1>
<h1 id="h1_JXZRIE">Hello2</h1> 
```

**说明**: 正确使用标准 XPath 函数**[`starts-with()`](http://www.w3.org/TR/xpath/#function-starts-with)**

# php - 亚马逊 API 页码不起作用

> ID：12362747
> 
> 赞同：1
> 
> 时间：2012-09-11T04:25:21.830
> 
> 标签：php, amazon-web-services, pagination

我正在尝试通过 Amazon API 获取搜索结果列表，以在我的网站上列出产品。除了指定我要检索的页码外，一切正常。由于某种原因，它总是获取第 1 页。

```
$SecretAccessKey = "xxx";
$request['AWSAccessKeyId'] = "xxx";
$request['AssociateTag'] = "xxx";
$request['Timestamp'] = gmdate("Y-m-d\TH:i:s\Z");
$request['ResponseGroup'] = "ItemAttributes,Offers,Images";
$request['ItemPage'] = 1;
$request['Service'] = 'AWSECommerceService';
$request['Version'] = '2011-08-01';
$request['Operation'] = 'ItemSearch';
$request['SearchIndex'] = $search['category_name'];
$request['Keywords'] = $search['text'];
$request['Page'] = 5;

ksort($request); // Sorts in order of key

$Prepend = "GET\nwebservices.amazon.com\n/onca/xml\n";
$String = http_build_query($request);
$PrependString = str_replace('+', '%20', $Prepend . $String);

$Signature = base64_encode(hash_hmac("sha256", $PrependString, $SecretAccessKey, True));
$Signature = urlencode($Signature);

$BaseUrl = "http://webservices.amazon.com/onca/xml?";
$SignedRequest = $BaseUrl . $String . "&Signature=" . $Signature;

// Fetch the generated URL
$xml = simplexml_load_file($SignedRequest); 
```

我试过用`$request['Page']`,`$request['page']`和. 似乎没有一个可以拉出正确的页面。有谁知道这个参数应该被命名为什么？`$request['Pages']``$request['pages']`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:28:03.043

原来是`ItemPage`。

```
$request['ItemPage'] = 5; 
```

# java - 如何在 weblogic server 9.2 上设置代理

> ID：12362751
> 
> 赞同：1
> 
> 时间：2012-09-11T04:25:43.590
> 
> 标签：java, jakarta-ee, weblogic9.x

我正在使用 httpurlconnection 在 Facebook 上发帖，但出现以下异常

```
 java.net.UnknownHostException: graph.facebook.com 
```

可能是由于代理设置，相同的代码在 java 独立应用程序中运行时运行良好，同时放置以下

```
 codeProxy proxy = new Proxy(Proxy.Type.HTTP,new InetSocketAddress("proxy.domain.com", 8080)) 
```

谁能告诉如何在 weblogic 服务器上设置代理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T08:14:31.797

1.  设置系统属性`http.proxyHost`和`http.proxyPort`. 您可以使用或使用语法`System.setProperty()`从命令行执行此操作。`-D`请参阅[http://docs.oracle.com/javase/7/docs/api/java/net/doc-files/net-properties.html#Proxies](http://docs.oracle.com/javase/7/docs/api/java/net/doc-files/net-properties.html#Proxies)

2.  您还需要`-DUseSunHttpHandler=true`在 weblogic.xml 中声明。它将强制使用 sun/oracle`sun.net.www.protocol.http.HttpURLConnection`实现`java.net.HttpURLConnection`代替`weblogic.net.http.SOAPHttpURLConnection`

在 openConnection() 之后尝试使用 connection.usingProxy() 来验证代理是否有效；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-30T16:03:32.070

要配置 WebLogic 代理文件，请修改位于域 bin 文件夹中的 setDomainEnv.cmd (Windows)。

例如对于集成服务器是here

```
C: \ Users \ [YOUT USER NAME] \ AppData \ Roaming \ JDeveloper \ system11.1.1.4.37.59.23 \ DefaultDomain \ bin 
```

以下财产必须与您的代理人的详细信息一起存档

```
@REM Estableciendo proxi
set JAVA_OPTIONS=%JAVA_OPTIONS% -Dhttp.proxySet=true -Dhttp.proxyHost=192.168.101.11 -Dhttp.proxyPort=8080 -Dhttp.nonProxyHosts=localhost 
```

见下一个链接：

[配置 Web Logic Proxi](http://elektro2.blogspot.com/2013/01/configurar-proxy-en-weblogic-para.html)

# ruby-on-rails - 使用 Ruby Mechanize 访问隐藏字段值

> ID：12362753
> 
> 赞同：0
> 
> 时间：2012-09-11T04:26:06.830
> 
> 标签：ruby-on-rails, ruby, www-mechanize

我正在尝试访问隐藏字段的表单值，以便设置或检索它们。

我尝试了该`form.field_with()`方法，`form.fieldname`但无法弄清楚如何获取隐藏字段的引用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T06:33:27.433

一般来说，您只需执行以下操作：

```
form['foo'] = 'bar' 
```

这适用于各种表单字段，而不仅仅是隐藏。

# android - 如何将 PSD 设计转换为 Android xml？

> ID：12362760
> 
> 赞同：8
> 
> 时间：2012-09-11T04:26:47.813
> 
> 标签：android, xml, themes

在过去的几天里，我一直在玩弄安卓应用程序，似乎无法理解整个 UI 和布局开发。

过去一年我一直在用 Java 编程，所以我对这种语言相当熟悉，而且我已经用 CSS 进行前端开发几年了，但我似乎可以进行过渡。

如果有人可以向我指出一些很棒的在线资源。

非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T05:12:51.257

它真的很简单，就像您为 HTML 所做的那样。除了您必须在 xml 中编写 CSS 之外，一切都相同。有一些东西叫做包装内容，填充父母等等。您应该以适当的方式使用它们。例如，如果您的 PSD 中有一个带有渐变背景的按钮，则对其进行切片并使用 ImageButton 并将切片图像分配给图像按钮。即使是文本，也只需获取颜色、大小……然后在 XML 中寻找可以做到这一点的东西。看看下面的代码。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="fill_parent" 
              android:layout_height="fill_parent" 
              android:orientation="vertical" >
    <TextView android:id="@+id/text"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:text="Hello, I am a TextView" />
    <Button android:id="@+id/button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Hello, I am a Button" />
</LinearLayout> 
```

LinearLayout 将排列其子级单列或单行。现在它是一列，因为方向是垂直的。如果你水平做，那么它是一排。同样，看看[RelativeLayout](http://developer.android.com/reference/android/widget/RelativeLayout.html)，它类似于html中的相对定位。要更改背景，您可以使用`android:background="color value here"`. 这里没有技术限制。您还将获得填充和边距。只需从 xml 布局开始。通过观察 PSD 来做到这一点。我相信你的 CSS 体验会很震撼。一切顺利。

# actionscript-3 - AS3：从 Microsoft Word 文档中逐行拆分文本

> ID：12362767
> 
> 赞同：1
> 
> 时间：2012-09-11T04:27:37.983
> 
> 标签：actionscript-3, ms-word, split

显然，使用该`array.split`函数很容易使用`"\n"`or来分隔文本行`"\r"`- 但是，当从 word 文档中粘贴数据时，这不会识别或拆分换行符。

所以只是想知道，我怎样才能使word文档的粘贴内容可以按行分隔？显然，我不能从 MS Word 复制/粘贴换行符，因为这会破坏代码（编译器不会有它的条），所以我想知道是否有一种简单的方法来分割这种变体的文本？

如有必要，我可以上传 .swf 文件——我不确定到目前为止我的解释是否合理。基本上，在文本内容中使用回车键可以识别换行符，而从 MS Word 粘贴则不会。

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T11:02:53.413

您可以粘贴该文本的示例 - 或提供您正在使用的文件，但您可以尝试以下操作：

```
var reg:RegExp = /(\r\n|\n|\r)/gm;
var lines:Array = source.split(reg); 
```

其中 source 是 word 中的字符串文本

上面的正则表达式匹配 windows 样式的新行，然后是 *nix 和 OSX 类型，然后是 Mac OS 9 类型。Windows 新行由 2 个回车和换行组成，但 flash 将其分开处理，结果您可以在 flash 中获得双换行符。

同样重要的是换行符和换行符是不同的:)所以它可能是你已经换行了但是它是一个没有任何换行符的长行。

# iphone - 来自 XML 文件的缓存表视图的问题

> ID：12362768
> 
> 赞同：1
> 
> 时间：2012-09-11T04:27:47.703
> 
> 标签：iphone, cocoa-touch, uitableview

我的应用程序有一个表格视图，它从 XML 文件加载数据并缓存这些数据。现在，当 XML 文件更新时，表可以添加新部分，但我无法弄清楚如何同时删除/覆盖表中最旧的部分。

这是`fetchEntries`表视图控制器文件的一部分：

```
- (void)fetchEntries {

    // Initiate the request...
    NSURL *url = [NSURL URLWithString:@"http://www.test.com"];
    channel = [[FeedStore sharedStore] fetchRSSFeedWithURL:url completion:
           ^(RSSChannel *obj, NSError *err) {

               if(!err) {

                   // How many items are there currently?
                   int currentItemCount = [[channel items] count];

                   // Set our channel to the merged one
                   channel = obj;

                   // How many items are there now?
                   int newItemCount = [[channel items] count];

                   // For each new item, insert a new row. 
                   int itemDelta = newItemCount - currentItemCount;
                   if(itemDelta > 0) {
                       NSMutableIndexSet *stuff = [NSMutableIndexSet indexSet];
                       for(int i = 0; i < itemDelta; i++) 
                           [stuff addIndex:i];
                       [[self tableView] insertSections:stuff withRowAnimation:UITableViewRowAnimationNone];
                   } 

                }
           }];
[[self tableView] reloadData];

} 
```

另一种选择是检查版本号，如果 XML 已更新，则完全删除缓存和表，然后重新加载数据。但是当我这样称呼时：

```
- (void)deleteCache {
    NSString *cachePath =
    [NSSearchPathForDirectoriesInDomains(NSCachesDirectory,
                                     NSUserDomainMask,
                                     YES) objectAtIndex:0];
    NSFileManager *fileManager = [NSFileManager defaultManager];
    [fileManager removeItemAtPath:cachePath error:NULL];
    [[channel items] removeAllObjects];
    [self fetchEntries];
} 
```

...在我重新启动应用程序之前，表格视图不会使用新数据进行更新。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T18:10:15.990

Prasad 是正确的——我删除的是整个缓存目录而不是单个文件。

# ios - XCode -> 构建设置 -> 代码签名中“不要代码签名”值的目的是什么？

> ID：12362778
> 
> 赞同：3
> 
> 时间：2012-09-11T04:28:49.380
> 
> 标签：ios, xcode, code-signing

我在 XCode -> Build Settings -> Code Signing 中找到了一个代码签名属性“Don't Code Sign”。我们应该在何时何地使用它？这对于正确添加到开发人员门户（具有适当的开发人员证书）的设备意味着什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-04-27T08:20:25.323

我们构建的应用程序被交付给未签名的客户，因为他们随后使用 Citrix 解决方案提供的本地应用程序商店为他们的企业签署和托管应用程序。

如果我们签署了应用程序，Citrix 无法导入它并添加它自己的签名（据说......我仍然觉得这很难相信），所以客户坚持认为应用程序没有签名。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-28T09:15:17.117

这让像我这样的学生更容易，我们需要创建 iOS 应用程序，但我们不想将其发布到 App Store。Apple 允许在自己的 iOS 设备上测试未签名的应用程序。

# javascript - 如何将html元素添加为生成的内容

> ID：12362779
> 
> 赞同：-3
> 
> 时间：2012-09-11T04:28:56.287
> 
> 标签：javascript, html, css

我想将 html 元素作为生成的内容。例如，如果我想在列表项之前放置水平线

这不起作用。它只是将“<hr/>”打印为文本

```
li:before{
     content : '<hr/>'
} 
```

有什么办法吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:34:18.560

> HTML code cannot be inserted, using css content property, the tags show up as `<tag>`.

You can use jquery pretty easy..

```
$('li').prepend('<hr />'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:50:42.437

不，我认为用 css 是不可能的。

一种解决方案可能是使用 a `border-top`on your `li`。

例如

```
li
{
  border-top: 1px solid black;
} 
```

看看这个网站，看看*可以*做什么的一些很好的例子：http: [//css-tricks.com/css-content/](http://css-tricks.com/css-content/)

# macos - nodejs守护进程错误的架构

> ID：12362780
> 
> 赞同：3
> 
> 时间：2012-09-11T04:28:57.867
> 
> 标签：macos, node.js, daemon

我正在尝试在 OSX Mountain Lion 下的 Mac 上从 nodejs 运行“dali”一个 highcharts 导出器

我收到以下错误：

```
module.js:485
    process.dlopen(filename, module.exports);
      ^
Error: dlopen(/Users/greg/node_modules/daemon/lib/daemon.v0.8.8.node, 1): no suitable image found.  Did find:
/Users/greg/node_modules/daemon/lib/daemon.v0.8.8.node: mach-o, but wrong architecture
at Object.Module._extensions..node (module.js:485:11)
at Module.load (module.js:356:32)
at Function.Module._load (module.js:312:12)
at Module.require (module.js:362:17)
at require (module.js:378:17)
at Object.<anonymous> (/Users/greg/node_modules/daemon/lib/daemon.js:12:11)
at Module._compile (module.js:449:26)
at Object.Module._extensions..js (module.js:467:10)
at Module.load (module.js:356:32)
at Function.Module._load (module.js:312:12) 
```

关键部分是：“错误的架构”

如果我运行：

```
lipo -info /Users/greg/node_modules/daemon/lib/daemon.v0.8.8.node 
```

它返回：

```
Non-fat file: /Users/greg/node_modules/daemon/lib/daemon.v0.8.8.node is architecture: i386 
```

我猜需要 x64 版本。

如何获取并安装此库的 64 位版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:34:43.000

我猜这个对话发生在大约一个月前左右。在运行用 C++ 编写的 nodejs 插件时，我遇到了与原始海报相同的问题。

但是，lipo 用于通用文件格式以创建单个体系结构文件。我很确定消息“非胖文件...”是说该文件不是通用（胖）文件格式。由于 lipo 只接受 fat 文件，因此 lipo 对文件没有任何工作要做。

我已经深入研究了 mach-o 二进制文件并查看了标题。该文件被标记为 a mach bundle，这不是我所期望的。

我通过 NodeJS node-waf 程序使用 wscript 构建文件构建了我的文件。目前，我的问题还没有解决。我对 NodeJS 和使用 WAF wscript 文件进行构建都是新手。

# ios - 网站上的帖子可以在模拟器上工作，但不能在设备上工作？

> ID：12362788
> 
> 赞同：1
> 
> 时间：2012-09-11T04:30:20.290
> 
> 标签：ios, objective-c, ios-simulator

我想在我的应用程序中使用网络服务并在网站上上传帖子，起初我使用 ASIFormRequest API，它在模拟器上工作但在设备上不起作用，我在这里问了一个问题，有人告诉我更改 API 并使用RestKit（[这是我上一个问题的链接](https://stackoverflow.com/questions/12241889/asiformdatarequest-works-on-simulator-but-not-on-device)）

现在我正在使用 RestKit API，我遇到了同样的问题，我无法通过设备在网站上发布，但是当我使用模拟器时它可以工作。虽然它不允许我发帖，但我可以通过模拟器和设备登录。

这是我的 POST 代码：

```
- (IBAction)addLinkPressed:(UIButton *)sender {
[RKClient clientWithBaseURLString:@"http://MyWebsite.com"];
    NSDictionary* params = [NSDictionary dictionaryWithObjectsAndKeys:
                            self.linkField.text, @"url",
                            self.linkTitleField.text, @"title",
                            self.linkSummaryField.text, @"summary",
                            nil];

    [[RKClient sharedClient] post:@"/send_link.php" params:params delegate:self];

}

- (void)objectLoader:(RKObjectLoader*)objectLoader didFailWithError:(NSError*)error {
    NSRange range = [[error localizedDescription] rangeOfString:@"-1012"];
    if (range.length > 0){
        //Do whatever here to handle authentication failures
    }
    RKLogError(@"Hit error: %@", error);
}

- (void)request:(RKRequest*)request didLoadResponse:(RKResponse*)response
{
    if ([request isGET]) {
        // Handling GET /foo.xml

        if ([response isOK]) {
            // Success! Let's take a look at the data
            NSLog(@"Retrieved XML: %@", [response bodyAsString]);
        }

    } else if ([request isPOST]) {

        // Handling POST /other.json
        if ([response isJSON]) {
            NSLog(@"Got a JSON response back from our POST!");
        }

    } else if ([request isDELETE]) {

        // Handling DELETE /missing_resource.txt
        if ([response isNotFound]) {
            NSLog(@"The resource path '%@' was not found.", [request resourcePath]);
        }
    }

    NSLog(@"HTTP status code:     %d", response.statusCode);
    NSLog(@"HTTP status message:  %@", [response localizedStatusCodeString]);
    NSLog(@"Header fields: %@", response.allHeaderFields);
    NSLog(@"Body: %@", response.bodyAsString);
} 
```

这是我收到的 RestKit API 错误：

```
 2012-09-11 22:33:01.053 (NameOfMyApp)[16271:707] I restkit.support:RKCache.m:189 Invalidating cache at path: /var/mobile/Applications/897B1DEA-1767-4F5C-AC8F-1809075C5CA9/Library/Caches/RKClientRequestCache-(Mywebsite).com/SessionStore
    2012-09-11 22:33:01.057 (NameOfMyApp)[16271:707] I restkit.network.reachability:RKReachabilityObserver.m:123 Reachability observer initialized with IP address: 0.0.0.0.
    2012-09-11 22:33:01.075 (NameOfMyApp)[16271:707] I restkit.network.reachability:RKReachabilityObserver.m:391 Network availability has been determined for reachability observer <RKReachabilityObserver: 0x10066330 host=0.0.0.0
2012-09-11 22:33:01.075 (NameOfMyApp)[16271:707] I restkit.network.reachability:RKReachabilityObserver.m:391 Network availability has been determined for reachability observer <RKReachabilityObserver: 0x10066330 host=0.0.0.0 isReachabilityDetermined=YES isMonitoringLocalWiFi=NO reachabilityFlags=-R -----l->
2012-09-11 22:33:01.325 (NameOfMyApp)[16271:707] I restkit.network:RKRequest.m:689 Status Code: 200
2012-09-11 22:33:01.328 (NameOfMyApp)[16271:707] HTTP status code:     200
2012-09-11 22:33:01.332 (NameOfMyApp)[16271:707] HTTP status message:  no error
2012-09-11 22:33:01.338 (NameOfMyApp)[16271:707] Header fields: {
    "Cache-Control" = "no-store, no-cache, must-revalidate, post-check=0, pre-check=0";
    Connection = "Keep-Alive";
    "Content-Encoding" = gzip;
    "Content-Length" = 4679;
    "Content-Type" = "text/html";
    Date = "Wed, 12 Sep 2012 03:33:02 GMT";
    Expires = "Thu, 19 Nov 1981 08:52:00 GMT";
    "Keep-Alive" = "timeout=5, max=100";
    Pragma = "no-cache";
    Server = Apache;
    Vary = "Accept-Encoding";
}
2012-09-11 22:33:01.345 (NameOfMyApp)[16271:707] Body: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

在这些代码之后，它显示了我用于 POST ( [http://MyWebsite.com/send_link.php](http://MyWebsite.com/send_link.php) )的地址的 HTML 代码

任何想法将不胜感激，我真的需要帮助:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T17:23:18.863

我找到了答案，在模拟器中它不需要将 http:// 放在 url 地址的开头，但是在设备上，如果我不输入 http:// 我使用他们的网络服务的网站不会允许我发帖。是不是很奇怪！谢谢你们的评论。另一件事是，当我关闭应用程序并重新打开它时，我必须登录，知道如何使用户名和密码持久化吗？

# javascript - Disabling form submit with character whitelist

> ID：12362791
> 
> 赞同：1
> 
> 时间：2012-09-11T04:30:40.033
> 
> 标签：javascript, forms, http-post

I have a form in which I want to disable the submit button if there are any characters other than A-Z, a-z, and 0-9.

* * *

What I have now is...

```
 <form name=form action=process.cgi method=POST />
    <input type=text name=field1 />
    <input type=password name=field2 />
    <input type=submit value=submit />
    </form> 
```

I am trying to make it so that the details are not submitted untill field1 and field2 only have A-Z, a-z, and 0-9

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:42:38.953

```
<input type="text" id="name">
<input type="button" id="but" onClick="validate()" Value="Submit"> 
```

还有你的js

```
String.prototype.isValid = function(){return /^\w*$/.test(this);}

    function validate() {
    if(document.getElementById('name').value.isValid()){
        alert('valid')   ;             

    } else{
        alert('Invalid')   ;     
    }    
        } 
```

检查这个**[演示](http://jsfiddle.net/PuyZW/)**

更新以包括表单提交[**更新的演示**](http://jsfiddle.net/PuyZW/1/)

第二次更新[**在这里**](http://jsfiddle.net/PuyZW/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:33:26.690

Use javascript / JQuery / Server side, to validate text and password with the mentioned regex

```
[A-Za-z\d]+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T04:34:55.817

there is a lot to this question.

I would recommend

1) [javascript regex](http://www.w3schools.com/jsref/jsref_obj_regexp.asp) 2) [Jquery](http://jquery.com/)

You will use regex to ensure that there are not any spaces etc. And jquery to disable the button.

# c++ - Getting "Use of undefined type" and "Must have class/struct/union" errors

> ID：12362797
> 
> 赞同：1
> 
> 时间：2012-09-11T04:31:59.327
> 
> 标签：c++, operator-overloading

EDIT #1: Everything before editing the line

> << "Owner: " << (*wo._owner).getLoginName() << endl;

worked completely fine, or at least didn't throw errors on me.

So I have the following code (obviously there is a lot more that if requested I will post, just not sure if more is needed or that is ok):

```
class Workout
{
private:
    int _workoutid; // the ID of this workout
    User* _owner; // Who did this workout
    float _distance; // in miles
    int _duration; // in seconds
    int _day, _month, _year; // date: MM/DD/YYYY
    int _weight; // lb, on the date of workout
    // private methods (if necessary)
public:
    friend std::ostream& operator<< (ostream& out, Workout& wo)
    {
        out << "Workout ID: " << wo._workoutid << endl
            << "Owner: " << (*wo._owner).getLoginName() << endl
            << "Distance: " << wo._distance << endl
            << "Duration: " << wo._duration / 3600 << ":" << (wo._duration % 3600) / 60 << ":" << wo._duration % 60 << endl
            << "Date: " << wo._month << ":" << wo._day << ":" << wo._year << endl
            << "Weight: " << wo._weight << endl;
        return out;
    }
    // Print workout id, owner’s username, distance
    // duration (HH:MM:SS), date (MM:DD:YY) and weight of
    // the workout
    // and other public methods (mutators/setters, accessors/getters)
    Workout(void);
    Workout(int, User*, float, int, int, int, int, int);
    virtual ~Workout(void);
    float getDistance();
    void setDistance(float);
};
Workout::Workout(void) : _workoutid(), _distance(), _duration(), _day(), _month(), _year(), _weight()
{
    _owner = new User();
}
Workout::Workout(int id, User* user, float distance, int duration, int day, int month, int year, int weight) :
_workoutid(id), _distance(distance), _duration(duration), _day(day), _month(month), _year(year), _weight (weight), _owner(user)
{
}
Workout::~Workout(void)
{
    delete [] _owner;
}

class User
{
private:
    char* _firstname; // First name
    char* _lastname; // Last name
    char* _loginname; // Login name
    char* _password; // password
    Workout* _myWorkouts[50];// an array of pointers to workouts
    int _numWorkouts; // Num. of workout logged
    User* _buddies[10]; // Friends
    int _numBuddies; // Num. of friends

    // private methods (if necessary)

public:
    friend std::ostream& operator<< (ostream& out, User& user)
    {
        out << "First Name: [" << user._firstname << "]" << endl
            << "Last Name: ["<< user._lastname << "]" << endl
            << "Login Name: [" << user._loginname << "]" << endl
            << "Number of Workouts: [" << user._numWorkouts << "]" << endl
            << "Number of Friends: [" << user._numBuddies << "]" << endl;
        return out;
    }
    User(void);
    User(const char*, const char*, const char*, const char*);
    virtual ~User(void);

    char* getPassword(void);
    char* getLoginName(void);
    char* getFirstName(void);
    void addWorkout(Workout*);
    Workout* getWorkout(int);
    void addBuddy(User* buddy);
    // and other public methods (mutators/setters, accessors/getters)
};
User::User(void) : _firstname(), _lastname(), _loginname(), _password(),
    _myWorkouts(), _numWorkouts(), _buddies(), _numBuddies()
{
}
User::User(const char* first, const char* last, const char* login, const char* pass) : _myWorkouts(), _numWorkouts(), _buddies(), _numBuddies()
{
    _firstname = new char[20];
    _lastname = new char[20];
    _loginname = new char[20];
    _password = new char[20];

    for (int i=0; i < 20; i++){
        _firstname[i] = first[i];
        _lastname[i] = last[i];
        _loginname[i] = login[i];
        _password[i] = pass[i];
    }
}
User::~User(void)
{
    delete [] _firstname;
    delete [] _lastname;
    delete [] _loginname;
    delete [] _password;

    for(int i=0;i<50;i++) delete _myWorkouts[i];
    delete [] _myWorkouts;

    for(int i=0;i<10;i++) delete _buddies[i];
    delete [] _buddies;

    //What about variables such as _numWorkouts and _numBuddies?
} 
```

And I am getting the following errors:

> Error 1 error C2027: use of undefined type 'User'
> 
> Error 2 error C2228: left of '.getLoginName' must have class/struct/union

The first error is because the operator<< method somehow doesn't want to recognize that the (*wo._owner) object of type User initialized (which it is!) The second error, obviously must be related to the second one, but it doesn't improve my chances of realizing at all how to solve the problem.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:48:22.297

如果这确实是您的代码结构，那么您正在尝试在定义之前使用“用户”。

你不能这样做。

如果需要，将您的输出运算符声明为朋友，并在知道 User 的定义后对其进行定义。

# java - 使用按值传递创建 Map 副本的最佳方法是什么？

> ID：12362799
> 
> 赞同：4
> 
> 时间：2012-09-11T04:32:22.243
> 
> 标签：java, map, copy

如果我有一个包含 100 个值的 Java 映射，并且我想使用以下代码创建它的另一个副本：

```
LinkedHashMap<String, Vector<String>> map1 = new LinkedHashMap<String, Vector<String>>();
LinkedHashMap<String, Vector<String>> map2 = new LinkedHashMap<String, Vector<String>>( map1 ); 
```

然后，如果我更改 map1 的任何 Vector 条目中的任何值，它也会在 map2 中受到影响。我不要那个。我希望 map2 完全独立于 map1。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-11T04:35:27.933

基本上，您需要克隆每个向量：

```
LinkedHashMap<String, Vector<String>> map2 = new LinkedHashMap<String, Vector<String>>();
for (Map.Entry<String, Vector<String>> entry : map1.entrySet()) {
    Vector<String> clone = new Vector<String>(entry.getValue());
    map2.put(entry.getKey(), clone);
} 
```

当然，您不必比这更深入 - 因为`String`它是不可变的。

（顺便说一句，您使用`Vector`而不是`ArrayList`的任何原因？）

# opencv - How to install opencv in ubuntu 11.10?

> ID：12362801
> 
> 赞同：1
> 
> 时间：2012-09-11T04:32:49.240
> 
> 标签：opencv, ubuntu, ubuntu-11.10

I have been searching all over the net and doing what is being said.How should I install open cv in ubuntu 11.10 platform? I want to do some image processing using open cv. Thanks. Btw, Im a novice in programming.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T07:44:27.027

*   下载最新的 OpenCV-2.4.2.tar.bz2 并解压。
*   在终端`cd`到 Opencv-2.4.2
*   跑`mkdir release`
*   光盘发行
*   跑`cmake -D CMAKE_BUILD_TYPE=RELEASE -D CMAKE_INSTALL_PREFIX=/usr/local -D BUILD_PYTHON_SUPPORT=ON ..`
*   跑`sudo make install`

这就是安装opencv。安装大约需要 30 分钟。

但是在成功安装后，您的 Ubuntu 11.10 可能会出现另一个问题（根据我的经验）。您可能会遇到与 opencv 库的链接错误。为了摆脱这个问题，`export LD_LIBRARY_PATH=/usr/local/lib`在每个登录会话上运行。`/usr/local/lib`或在末尾添加-this 行以`/etc/ld.so.conf`获得永久解决方案。

您可以从我的网站下载我的直方图均衡化的详细 opencv 实现，以获得良好的启动！

我的[网站](http://www.cse.iitd.ac.in/~mcs112580)：

# frameworks - MVCForm Agile Toolkit Form Update Record ID must be specified

> ID：12362805
> 
> 赞同：3
> 
> 时间：2012-09-11T04:33:21.823
> 
> 标签：frameworks, atk4, php, agiletoolkit

hopefully simple questions regarding Agle Toolkit. Currently with the below code getting

> Error in AJAX response: SyntaxError: Unexpected token <
> 
> BaseException
> 
> Record ID must be specified, otherwise use loadAny()

**page\grant.php**

```
<?php
class page_grant extends Page {
    function init(){
        parent::init();

        $saveForm=$this->add('MVCForm');
        $model=$this->add('Model_Grant')->load($_GET['id']);
        $saveForm->setModel($model);

        $saveForm->addSubmit();

        $saveForm->onSubmit(function($saveForm){
            $saveForm->update()->js()->univ()->successMessage('Grant info saved.')->execute();
        });
    }
} 
```

And Model_Grant:

```
<?php

class Model_Grant extends Model_Table {
    public $table='minigrant';

    function init() {
        parent::init();
        $this->addField('grant_number');
        $this->addField('grant_name');
        $this->addField('uid');
    }
} 
```

Data is loaded fine but cannot save it back as per above error message.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T15:13:26.500

您必须将 stickyGET 添加到 id 字段：

```
<?php
class page_grant extends Page {
    function init(){
        parent::init();

        $this->api->stickyGET('id');

        $saveForm=$this->add('MVCForm');
        $model=$this->add('Model_Grant')->load($_GET['id']);
        $saveForm->setModel($model);

        $saveForm->addSubmit();

        $saveForm->onSubmit(function($saveForm){
            $saveForm->update()->js()->univ()->successMessage('Grant info saved.')->execute();
        });
    }
} 
```

发现数据： [http ://agiletoolkit.org/learn/tutorial/jobeet/day8](http://agiletoolkit.org/learn/tutorial/jobeet/day8)

敏捷工具包确实需要一个文档源和更多这样的例子，因为它很容易在我使用过的最好的框架上。

如果他们（@romaninsh）可以更好地编写文档，那么我认为它会做得更好。我想他们可能也需要从 AGPL 更改许可证，但这对我个人而言并不重要，因为我正在研究 OSS。

# iphone - How to replicate a UITableView inside a UIScrollView

> ID：12362815
> 
> 赞同：0
> 
> 时间：2012-09-11T04:34:24.410
> 
> 标签：iphone, objective-c, ios

I wanted to do a simple pagination inside a `UIScrollView` and within each page will have a TableView. For now, my first page always loaded with a `UITableView`, and how can I replicate it to another page too?

Is there any references link for this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T06:49:21.197

检查 ATPagingView ：[https://github.com/andreyvit/SoloComponents-iOS](https://github.com/andreyvit/SoloComponents-iOS)

我想做你似乎想做的事，而 ATPagingView 帮助我实现了它:)

尝试演示项目，并`DemoViewController`替换`self.pagingView.horizontal = NO;`为`self.pagingView.horizontal = YES;`以获取水平分页而不是垂直分页

希望这可以帮助！

# java - Java 部分有序集合

> ID：12362819
> 
> 赞同：14
> 
> 时间：2012-09-11T04:35:28.620
> 
> 标签：java, collections, set, abstract-data-type, poset

我正在寻找一个数据结构的 Java 实现，它包含定义了**部分排序的元素集合，并允许以某种****拓扑顺序**迭代这些元素（任何可能的排序都可以；最好是稳定的随着集合内容的变化进行排序）。

理想情况下，它将实现一个`Collection<E>`、`Set<E>`或`SortedSet<E>`接口并支持该接口上的所有方法。在指定总排序方面，可以用 a 实例化集合，如果要比较的两个元素没有相对于彼此排序，`Comparator<E>`比较器可能会抛出异常 ( ?)。`ClassCastException`作为奖励，如果插入的元素会产生排序异常（元素有序图中的循环），它将引发异常。

所以是的，我想要的是拓扑排序，但我想要一个*集合对象，它*在每次插入/删除时都保持该排序顺序，类似于 SortedSet 如何按排序顺序维护集合。

这样的事情存在吗？在一些开源库中？

**参考：**

[http://en.wikipedia.org/wiki/Partially_ordered_set](http://en.wikipedia.org/wiki/Partially_ordered_set)

[http://en.wikipedia.org/wiki/Topological_sorting](http://en.wikipedia.org/wiki/Topological_sorting)

**更新**

在意识到我的要求对性能的影响（以及我无法完全解决的各种其他问题，使用 poset）之后，我最终采用了一种不同的方法来解决我不需要 poset 的问题。依靠比较器来确定元素之间的顺序意味着对于元素插入，我必须针对每个现有元素咨询比较器，每次插入的成本为 O(n)。

如果性能不是很重要（确实如此），并且如果元素的数量限制在合理的范围内（不是），我想我会采用 Willie 建议的方法，尽管可能使用我自己的图形实现和拓扑排序实现以最小化依赖关系。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T05:07:27.200

有向无环图是否足以满足您的需求？我知道这通常不会捕获 poset，但是您提到要排除图形周期。

如果是这样，您可以查看 JGraphT：http: [//jgrapht.org/](http://jgrapht.org/)

有一个用于拓扑排序的图迭代器。

请注意，有向图不是 java.util.Collections，但您可以获取顶点，即 java.util.Set。如果您需要数据结构本身是一个集合，您可能可以用一个作为集合的薄包装器来包装一个 JGraphT 有向图*，*将顶点视为元素。

这里的潜在缺点是您必须显式创建边缘，这可能会或可能不会被您的应用程序接受。

# html - How to create slide (like powerpoint ) show in JavaFx 2?

> ID：12362822
> 
> 赞同：0
> 
> 时间：2012-09-11T04:35:37.323
> 
> 标签：html, slideshow, javafx-2

This is more of a subjective question because I have no idea about it right now. Is there any way to create my presentation in JavaFx, it might need some coding but the good point is I can include the demos in the slide itself as the presentation is about JavaFx. Something like impress.js helps creating slide shows in HTML5 which is the best wat to demo HTML5 inline

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T07:11:05.740

也许您可以使用 Zen Java 中的 JFX Flow 库？[http://www.zenjava.com/jfx-flow/](http://www.zenjava.com/jfx-flow/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T01:15:33.330

> 有什么方法可以在 JavaFx 中创建我的演示文稿？

是的。我可以想象很多方法来做到这一点。例如，您可以使用 javafx 2.2 中的[分页布局](http://docs.oracle.com/javafx/2/ui_controls/pagination.htm)在不全屏时浏览幻灯片，并将页面（幻灯片）转换绑定到键盘或鼠标事件以浏览分页对象的页面。您甚至可以使用[Stage fullscreen 属性](http://docs.oracle.com/javafx/2/api/javafx/stage/Stage.html#fullScreenProperty)来隐藏您的分页控件并完全集中于您正在呈现的内容。

> 它可能需要一些编码

如果你打算只做一次，实际上使用分页控件非常容易。在创建幻灯片时，您只需牢记 MVC 并做好准备。

> 关键是我可以在幻灯片本身中包含演示，因为演示文稿是关于 JavaFx

有这个新功能可以[使用 JavaFX 拍摄快照](https://blogs.oracle.com/thejavatutorials/entry/take_a_snaphot_with_javafx)以制作场景或节点的缩略图（或使用一些摆动/awt 魔法打印它们）并以编程方式将它们设置为分页按钮，因为您使用的是 javafx 对象，这可以是将幻灯片内容与导航集成的一种很酷且简单的方法。

> impress.js 之类的东西有助于在 HTML5 中创建幻灯片，这是演示 HTML5 内联的最佳方式

现在这将需要额外的编码，因为您必须创建和记录接口，以帮助未来的用户符合（继承、扩展、使用等）您的这个自定义控制器。如果您打算在某种图形工具中进行转换，则需要更多额外的编码。不过也不是不可能。

嗯，这就是我想到的。我很确定关于如何制作它还有其他方法和其他观点，只要您记住这是可行的并且您可以做到。

# algorithm - 在图表中放置框的最佳方式（无交叉线）

> ID：12362824
> 
> 赞同：1
> 
> 时间：2012-09-11T04:35:39.913
> 
> 标签：algorithm, layout

我正在做一个作业，我必须在网页上绘制一个带有多个框的图表，其中一些框将通过箭头连接。我已经完成了所有设置，以便能够绘制实际的图表、箭头和所有内容，但现在我面临着以最佳方式放置盒子的问题。我的意思是布局页面，以便我有最少的线交叉。

我必须做两种类型的图表：一种是更分层的图表，我知道将哪个框放置在左上方以及所有框形成层次结构的位置。另一个比较棘手，没有盒子需要有一个特定的位置，最终结果不是层次结构。在任何一种情况下，两个盒子之间都存在不止一个连接。这与以最易读的方式为数据库布置 E/R 图几乎相同。

有谁知道如何执行此操作或在哪里可以找到有关如何执行此操作的信息？

提前致谢

./CJ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T05:23:29.893

布置具有最小交叉点的任意图是一个 NP 难题，因此您只能找到一个好的启发式方法。

想到的是这样的：

1.  将您的物品放在带有连接边缘的圆圈的周边上。
2.  使用模拟退火交换项目，旨在最大限度地减少交叉次数。
3.  使用强制定向布局进行整理。

另一种选择是找到一个生成树，渲染它，然后添加反向链接。与模拟退火方法相比，这可能会产生更多的交叉，但它的好处是可以将解决方案重用于作业的第一部分。

祝你好运！

# drupal-7 - 使用 Drupal 7 Computed Field 提供 Date Field Token

> ID：12362827
> 
> 赞同：1
> 
> 时间：2012-09-11T04:35:57.970
> 
> 标签：drupal-7, computed-field

在 Drupal 7 中，我有一个 Event 内容类型。保存后，我希望它的 URL 为**/calendar/day/{yyyy-mm-dd}/{title}**，其中**{yyyy-mm-dd}**基于`field_event_date`. [Token 模块](http://drupalmodules.com/module/token)可以为创建和更改日期字段执行此操作，但不适用于我创建的名为 field_event_date 的自定义字段。因此，作为补偿，我想创建一个名为的[计算字段](http://drupalmodules.com/module/computed-field)`field_event_date_Ymd`，它存储来自 的**yyyy-mm-dd**格式`field_event_date`，以便我可以在 URL 模式中引用它。

我不是 PHP 程序员，所以有人可以帮我写代码吗？是这样的吗？

```
$entity_field[0]['value'] = $field_event_date->format('Y-m-d'); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-28T07:08:29.523

```
$entity_field[0]['value'] = $field_event_date->format('Y-m-d'); 
```

# reporting-services - 我在哪里可以下载 Visual Studio 2012 报表查看器运行时？

> ID：12362828
> 
> 赞同：17
> 
> 时间：2012-09-11T04:36:01.027
> 
> 标签：reporting-services, visual-studio-2012

现在 Visual Studio 2012 已经发布，我在哪里可以下载随附的 2012 Report Viewer Runtime 以便将其安装在我的服务器上？Visual Studio 2012 中是否包含可再发行安装程序？

具体来说，我正在寻找更新的 2012 版本：[Microsoft Report Viewer 2010 Redistributable Package](http://www.microsoft.com/en-us/download/details.aspx?id=6442)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-12T01:50:34.430

我相信我已经找到了一个临时的解决方法：

1.  在项目的引用中，选择 Microsoft.ReportViewer.WebForms 程序集。
2.  添加对的引用`C:\Windows\assembly\GAC_MSIL\Microsoft.ReportViewer.Common\11.0.0.0__89845dcd8080cc91\Microsoft.ReportViewer.Common.dll`
3.  在属性窗口中，将两个程序集的“复制本地”设置为 True。
4.  将您的项目部署到服务器。

我没有对此进行广泛测试，但到目前为止，似乎只需将程序集复制到项目的 bin 目录即可满足服务器上的运行时要求。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-07T14:12:51.760

安装程序的最终版本是[http://www.microsoft.com/en-us/download/details.aspx?id=35747](http://www.microsoft.com/en-us/download/details.aspx?id=35747)

# javascript - 当 iFrame url 改变时执行函数

> ID：12362829
> 
> 赞同：2
> 
> 时间：2012-09-11T04:36:05.973
> 
> 标签：javascript, iframe

我的网站上有一个注册表单，`iframe`我想在 URL`iframe`更改时创建重定向（当用户成功注册时）。

这两个站点是跨域的，我知道几乎不可能跨域拉 url，但是有解决方法吗？我知道 src 不会改变，我正在考虑使用`onload()`，当`iframe`第二次加载时（当用户成功注册时），执行一个函数来重定向到感谢页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-20T22:33:48.570

这是一个使用 javascript ' **[Porthole](http://ternarylabs.github.io/porthole/)** ' 的示例。

这是可能的，但请记住 iframe 的安全问题。解决方案：如果您可以控制原始页面 + iframe，则可以通过在两侧实现一些 javascripts 来“欺骗”浏览器。

**首先在两个域**上创建一个“代理”页面。将其命名为“proxy.html”或其他名称（注意：您必须使用“porthole.min.js”，您可以从底部的来源中获取）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <!-- Replace the url with your own location -->
        <script type="text/javascript" src="porthole.min.js"></script>
        <script type="text/javascript">
            window.onload=function(){ Porthole.WindowProxyDispatcher.start(); };
        </script>
    </head>
    <body>
    </body>
</html> 
```

在**父页面上：（**参考**iframe** proxy.html 页面）

```
<script type="text/javascript" src="porthole.min.js"></script>
<iframe id="guestFrame" name="guestFrame" src="http://iframe.otherdomain.com/"></iframe>

<script type="text/javascript">
var iframeDomain = 'http://iframe.otherdomain.com';
var redirectUrl = 'http://www.mydomain.com/redirect-to/signed-up';

function onMessage(messageEvent) {
    if (messageEvent.origin == iframeDomain) {
        if (messageEvent.data["action"]
         && messageEvent.data["action"] == 'signed-up) {
            window.location.href = redirectUrl; // The final action!
            // This is the eventual redirect that will happen
            // once your visitor has signed-up within the iframe
        }
    }
}
var windowProxy;
window.onload=function(){ 
    // Create a proxy window to send to and receive messages from the iFrame
    windowProxy = new Porthole.WindowProxy(
        'http://iframe.otherdomain.com/proxy.html', 'guestFrame');

    // Register an event handler to receive messages;
    windowProxy.addEventListener(onMessage);
};
</script> 
```

在**iframe 页面上**（参考**父**proxy.html 页面）

```
<script type="text/javascript">
var windowProxy;
window.onload=function(){ 
    // Create a proxy window to send to and receive messages from the parent
    windowProxy = new Porthole.WindowProxy(
        'http://www.mydomain.com/proxy.html');

    // Register an event handler to receive messages;
    windowProxy.addEventListener(function(event) { 
        // handle event (not used here, the iframe does not need to listen)
    });
};
</script> 
```

您可以从 iframe 向父页面发送带有 javascript 的消息（也可以通过其他方式）。如果您在 iframe 域中仅使用 1 个 javascript，则可以执行以下操作以在 url 更改为特定内容时向父框架发送消息，例如“signed-up.php”（未经测试，但您将明白了）

```
<script type="text/javascript">
window.onload=function(){
    if(window.location.href.indexOf("signed-up.php") > -1) {
        windowProxy.post({'action': 'signed-up'}); // Send message to the parent frame
        // On the parent page, the function 'onMessage' is triggered.
    }
};
</script> 
```

**资料来源：**

*   [http://ternarylabs.github.io/porthole/](http://ternarylabs.github.io/porthole/)
*   Github：[https ://github.com/ternarylabs/porthole](https://github.com/ternarylabs/porthole)
*   演示：[http ://sandbox.ternarylabs.com/porthole/](http://sandbox.ternarylabs.com/porthole/)

# java - Spring Security 3.1.1 - 自定义登录成功问题

> ID：12362839
> 
> 赞同：1
> 
> 时间：2012-09-11T04:36:58.140
> 
> 标签：java, spring-security, authenticator

我是 Spring Security 的新手，我一直在阅读 API 和 Javadocs，我相信我需要关于我的问题的帮助。

到目前为止，根据反复试验，我观察到抛出异常会提示身份验证方法自动重定向到登录失败处理程序。从那里，很容易重定向和自定义失败的身份验证流程。但是，在成功登录时，除了 HttpServletRequest、HttpServletResponse、Authentication 对象之外，我似乎无法将任何内容传递给登录成功处理程序。

我的登录成功有两种情况：

1.  登录成功。

2.  新用户登录应重定向到更改密码页面。

这里有一些问题：

1.  在这种情况下可以调用 request.setParameter("status", "FOR_CHANGE_PASSWORD") 吗？安全吗？

2.  我应该添加“CHANGE_PASSWORD”权限吗？这是好习惯吗？

我的问题是我不想在我的 LoginAuthenticator 中调用 userService 方法，然后在我的登录成功处理程序上再次调用它只是为了检索用户的状态。有什么解决办法吗？

```
public class LoginAuthenticator implements AuthenticationProvider{
private static final Logger log = LoggerFactory.getLogger(LoginAuthenticator.class);
private static final List<GrantedAuthority> AUTHORITIES = new ArrayList<GrantedAuthority>();
@Autowired
UserService userService;

@Override
public Authentication authenticate(Authentication authentication)
        throws AuthenticationException {
    log.info("Authenticating...");   

    log.debug("Username: {}" , authentication.getPrincipal());
    log.debug("Password: {}" , (String) authentication.getCredentials()); 

    WSResponse response = userService.authenticateLogin(username, password);

    //User log-in failure
    if(response.getResponseCode != 200){  

          if(response.getResponseStatus.equals("BAD CREDENTIALS")){
             throw new BadCredentialsException("Bad Credentials");  
          }
          else{
             throw new AccountStatusException("Account is locked")
          } 
    } 
    else{
        log.info("User credentials are valid... logging in");
        AUTHORITIES.add(new SimpleGrantedAuthority("USER"));
        return new UsernamePasswordAuthenticationToken(authentication.getPrincipal(),          (String) authentication.getCredentials(), AUTHORITIES);

    } 

} 
```

任何更多的建议都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T09:17:28.927

一种典型的方法是将有关登录用户的所有必要信息存储在其`Authentication`.

例如，标准`AuthenticationProvider`（如在成功验证后构造对象时存储一个`DaoAuthenticationProvider`实现），应用程序开发人员可以提供自己的包含必要信息的子类。您可以以相同的方式实现它。`UserDetails``principal``Authentication``UserDetails`

# ruby-on-rails - rails 未定义的方法视图对象属性

> ID：12362840
> 
> 赞同：0
> 
> 时间：2012-09-11T04:37:24.113
> 
> 标签：ruby-on-rails

```
<%= debug(vote.song) %> 
```

产生这个：

```
--- !ruby/object:Song
attributes:
  id: 1
  name: Immigrant Song
  code: aiusbaina
  album: Led Zeppelin III
  created_at: 2012-09-08 10:02:51.654625000 Z
  updated_at: 2012-09-08 10:02:51.654625000 Z 
```

为什么会这样：<%= vote.song.name %> 得到一个未定义的方法错误（名称）？

# multithreading - 如何在不调用 .Sync 的情况下处理 AsyncCalls 函数中引发的异常？

> ID：12362851
> 
> 赞同：3
> 
> 时间：2012-09-11T04:38:35.720
> 
> 标签：multithreading, delphi, exception-handling, delphi-2010

当我使用 AsyncCalls 时，如何最好地将异常放入主线程？例如：

```
procedure TUpdater.needsToGoFirst();
begin
  asyncCall := TAsyncCalls.Invoke(procedure 
  begin 
    //some stuff
    if (possiblyTrueCondition = True) then
      raise Exception.Create('Error Message');
    //more stuff
    TAsyncCalls.VCLSync(procedure 
    begin 
      notifyUpdates(); 
    end);
  end);
end;

procedure TUpdater.needsToGoSecond();
begin
  asyncCall2 := TAsyncCalls.Invoke(procedure 
  begin 
    //initial stuff
    asyncCall.Sync();
    //stuff that needs to go second
    TAsyncCalls.VCLSync(procedure 
    begin 
      notifyUpdates(); 
    end);
  end);
end; 
```

我知道调用`asycCall.Sync`会为我抛出异常，但由于我目前让我的线程通知主线程已进行更新的方式，我真的没有我`Sync`在主线程中调用的任何地方。这样做也很困难，因为我实际上有另一个线程正在调用`Sync`以确保在获取第一个线程应该首先处理的资源之前设置一些东西。

我是否需要用 try-catch 包装这些函数的内部结构并使用 a`VCLSync`自己获取主线程的异常？有没有更好的方法来检查某种主线程空闲循环中的异常？

**编辑 1**

我的另一个想法是创建一个循环，其唯一工作是检查 IAscynCall 引用是否存在异常，并使用它向主线程引发异常，而不是在每个帖子中复制该代码。该`needsToGoSecond`方法仍然可能首先到达异常，但它会保持异常并且循环会在那里捕获它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T15:47:37.260

您声明以下内容：

> 我真的没有在主线程中调用 Sync 的任何地方。这样做也很困难，因为我实际上有另一个线程正在调用 Sync。
> 
> ……
> 
> 我是否需要用 try-catch 包装这些函数的内部结构并使用 VCLSync 自己获取主线程的异常？有没有更好的方法来检查某种主线程空闲循环中的异常？

调用`Sync`另一个线程将在那里引发异常。如果您不希望它在那里提出，并且如果它必须在主线程中提出，那么没有选择。您只需在异步过程中自己捕获任何未处理的异常。然后，您可以将它们排队到主线程，可能通过调用`TThread.Queue`、发布 Windows 消息或一些类似的队列机制。`VCLSync`如果您当时不介意同步，则可以使用另一种选择。

底线是`Sync`从另一个线程调用，并且需要在主线程上引发异常，这不是兼容的目标。因此，您必须自己捕获异常并停止 AsyncCalls 处理它。

本质上，这只是您当前方法的扩展。目前你的火灾通知到主线程，而不是让主线程同步。毕竟，我猜您正在使用异步方法，因为您不想从主线程同步。所以，扩展是你需要能够通知主线程错误和异常，以及更正常的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T23:32:30.773

根据要求，这是我如何将线程内部的异常传递给主线程的示例。异常停止线程中的执行，然后我捕获错误并将其返回给用户。

这里有两个非常简单的类，一个包含要在线程中运行的代码的工作类，以及线程类：

```
type
  TMyWorker = class
  private
    FExceptionObject: Pointer;
    FExceptionAddress: Pointer;
  public
    constructor Create; reintroduce;
    destructor Destroy; override;
    procedure _Execute;
    procedure GetException;
  end;

implementation

constructor TMyWorker.Create;
begin
  inherited Create;
  FExceptionObject := nil;
  FExceptionAddress := nil;
end;

procedure TMyWorker._Execute;
begin
  try
    // run code
  except
    FExceptionObject := AcquireExceptionObject; // increments exception's refcnt
    FExceptionAddress := ExceptAddr;
  end;
end;

procedure TMyWorker.GetException;
begin
  if Assigned(FExceptionObject) then
    raise Exception(FExceptionObject) at FExceptionAddress; // decrements exception's refcnt
end;

destructor TMyWorker.Destroy;
begin
  if Assigned(FExceptionObject) then
  begin
    ReleaseExceptionObject; // decrements exception's refcnt
    FExceptionObject := nil;
    FExceptionAddress := nil;
  end;
  inherited;
end; 
```

.

```
type
  TMyThread = class(TThread)
  private
    FWorker: TMyWorker;
  protected
    procedure Execute; override;
  public
    constructor Create(Worker: TMyWorker);
  end;

implementation

procedure TMyThread.Execute;
begin
  FWorker._Execute;
end;

constructor TMyThread.Create(Worker: TMyWorker);
begin
  FWorker := Worker;
  FreeOnTerminate := False;
  inherited Create(False);
end; 
```

然后我的主线程代码创建一个worker对象并将其传递给线程的构造函数来执行。当执行完成时，主线程检查并重新引发任何异常。

```
var
  myWorker: TMyWorker;
begin
  myWorker := TMyWorker.Create;
  try
    with TMyThread.Create(myWorker) do
    begin
      WaitFor; // stop execution here until the thread has finished
      Free;    // frees the thread object
    end;
    myWorker.GetException; // re-raise any exceptions that occurred while thread was running
  finally
    FreeAndNil(myWorker);
  end;
end; 
```

您还可以查看这篇 EDN 文章：

*   [如何处理 TThread 对象中的异常](http://edn.embarcadero.com/article/10452)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T18:07:46.913

所以最后，我想出了以下适合我需要的解决方案，我只是希望 GUI 显示任何异常消息，而不管线程如何。如果您想更具体地管理错误，我会推荐大卫给出的答案。

首先，使用`asyncCall.Sync();`不正确。我现在正在使用`TEvent`对象来等待有问题的实际事件发生。然后线程可以继续其他工作，而不会使等待的线程等待比需要的时间更长。

其次，我现在使用循环来捕获发生的异常并将错误同步回我的主线程。例如，一个线程可能如下所示：

```
procedure TUpdater.needsToGoSecond();
begin
  fAsyncThreads.Add(TAsyncCalls.Invoke(procedure 
  begin 
    //initial stuff
    myEvent.Wait();
    //stuff that needs to go second
    if (possiblyTrueCondition = True) then
      raise Exception.Create('Error Message');
    TAsyncCalls.VCLSync(procedure 
    begin 
      notifyUpdates(); 
    end);
  end));
end; 
```

我还有另一个线程在其他地方捕获并引发异常：

```
procedure TUpdater.catchExceptions();
begin
  fAsyncCatchExceptions := TAsyncCalls.Invoke(procedure
  var
    asyncThread: IAsyncCall;
    errorText: string;
  begin
    while(true)do
    begin
      for asyncThread in fAsyncThreads do
      begin
        if(Assigned(asyncThread)) and (asyncThread.Finished)then
        begin
          try
            asyncThread.Sync();
          except on E: Exception do
            begin
              errorText := E.Message;
              TAsyncCalls.VCLInvoke(procedure begin raise Exception.Create(errorText); end);
            end;
          end;
          fAsyncThreads.Remove(asyncThread);
        end;//if
      end;//for
      Sleep(2000);
    end;//while
  end);
end; 
```

似乎异常必须由 VCLInvoke（或 TThread.Queue）调用而不是 VCLSync（或 TThread.Synchronize）调用引发。同步时，我认为外部 AsyncCall 会捕获异常并阻止它被 GUI 显示。此外，我的 catch 循环还没有创建要在主线程中引发的异常的副本。因为您似乎需要将 raise 命令排队，所以您无法重新引发当前异常。您将遇到访问冲突，因为它很可能在 GUI 访问它时被清除。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-12T09:29:11.693

好吧，既然我们得到了[不准确的答案](https://stackoverflow.com/questions/12362851/how-to-handle-exceptions-thrown-in-asynccalls-function/12385088#answer-12379327)，这里还有一个。

OmniThreadLibrary：[http ://otl.17slon.com/](http://otl.17slon.com/)

论坛（作者在那里非常敏感）： http: [//otl.17slon.com/forum/](http://otl.17slon.com/forum/)

异步示例：[http ://www.thedelphigeek.com/2012/07/asyncawait-in-delphi.html](http://www.thedelphigeek.com/2012/07/asyncawait-in-delphi.html)

书样：[http ://samples.leanpub.com/omnithreadlibrary-sample.pdf](http://samples.leanpub.com/omnithreadlibrary-sample.pdf)

*   2.1 节介绍了异步。
*   第 2.1.1 节准确介绍了 Async 中的异常处理

有关 OTL 异常的更多信息：[http ://www.thedelphigeek.com/2011/07/life-after-21-exceptions-in.html](http://www.thedelphigeek.com/2011/07/life-after-21-exceptions-in.html)

*   它不使用异步，并且线程原语保持统一，所以它也应该适用于异步

# applescript - 如何自动化具有需要输入的对话框的应用程序安装？

> ID：12362853
> 
> 赞同：0
> 
> 时间：2012-09-11T04:38:39.997
> 
> 标签：applescript

我正在尝试以编程方式安装下载的应用程序，因此我正在使用苹果脚本，因为我在 Mac 上工作。

在这里，我从 adobe 站点下载了 Adob​​e AIR Installer 应用程序，该应用程序位于下载文件夹中，并尝试使用以下 applescript 代码安装该应用程序。在这里，当 Adob​​e AIR 设置对话框打开时，我需要单击“我同意”按钮来安装应用程序。使用以下代码无法单击“我同意”按钮，即使我没有 Xcode Accessibility Inspecter 来检查元素。请指导我处理“我同意”按钮的脚本。

```
try

    tell application "Finder"

        activate

        open application file "Adobe AIR Installer.app" of folder "Applications" of startup disk

        set this_image to open this_file

        delay 5

        tell application "System Events"

            click button "I Agree" of window "Adobe AIR Setup"

        end tell

    end tell

end try 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T18:24:07.163

您可以尝试使用 GUI 脚本编写命令，并在两次点击之间产生延迟，但这需要一点工作。由于 Adob​​e 安装程序不支持从 applescript 中单击，因此您需要下载[ExtraSuite](http://www.macupdate.com/app/mac/9730/extra-suites/)并按照[之前的 MacScripter 帖子](http://macscripter.net/viewtopic.php?id=12445)进行操作。

要获取像素坐标，请在没有 AppleScript 的情况下启动安装程序并键入“⌘ + shift + 4”以获取具有像素位置的十字准线（通常用于截屏）。记下第一个按钮的坐标，然后按“esc”并移动到下一个按钮。

这是完成工作的一种非常痛苦的方式，但我所知道的其他选择并不多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T09:34:53.867

看起来 Adob​​e 安装程序不使用 Cocoa 并且不可编写脚本。你可能有更好的运气与[Sikuli](http://sikuli.org/)。它基于匹配位图，不依赖于任何底层框架。

# google-apps-script - 如何恢复 Google Site List Items 中已删除的项目

> ID：12362855
> 
> 赞同：0
> 
> 时间：2012-09-11T04:38:51.020
> 
> 标签：google-apps-script

我最近在 google 站点中创建了一个新的项目列表页面，用于从成员那里获取用户详细信息。太棒了，用户可以添加一个新项目，输入他们的详细信息。

但我发现任何人都可以编辑任何列表项并将其删除。在删除的情况下，我找不到任何恢复已删除列表的选项。列表项的修订历史不存在。

任何人都可以指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:25:59.970

很遗憾，在 Google Apps 脚本中无法恢复已删除的列表项。一种解决方法可能是将内容也存储在 ScriptDb 中，以便以后可以根据需要重新创建列表项。

# r - 如何将分钟数据转换为小时平均数据

> ID：12362857
> 
> 赞同：7
> 
> 时间：2012-09-11T01:46:03.870
> 
> 标签：r, time-series

我有一周的数据，每 5 秒读取一次。下面是一个数据示例。

```
9/1/2012 00:00:00    1
9/1/2012 00:00:05    2
9/1/2012 00:00:10    3 
```

我想计算每天的小时平均值。然后用代表不同日期的线制作“平均每小时阅读与小时”的多线图。

我这里的一个是每周平均

```
data$date = as.POSIXct(strptime(data$date, 
                  format = "%d/%m/%Y %H:%M","GMT")) 
means <- aggregate(data["nox"], format(data["date"],"%Y-%U"),
                 mean, na.rm = TRUE) 
```

对于日平均值，它是

```
data$date = as.POSIXct(strptime(data$date, 
                 format = "%d/%m/%Y %H:%M","GMT"))
means <- aggregate(data["nox"], format(data["date"],"%Y-%j"),
                 mean, na.rm = TRUE) 
```

任何人都知道如何计算每天的小时平均值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T05:29:30.437

我喜欢@DWin 的回答，但我还记得曾经看过一个帮助文件，`?cut.Date`在这种情况下也可以使用它。我已经制作了一些数据，因此您可以在几个小时内看到结果：

```
set.seed(1)
data <- data.frame(date = seq(from = ISOdatetime(2012, 01, 01, 00, 00, 00),
                              length.out = 4320, by=5),
                   nox = sample(1:20, 4320, replace=TRUE))

hr.means <- aggregate(data["nox"], 
                      list(hour = cut(data$date, breaks="hour")), 
                      mean, na.rm = TRUE)
hr.means
#                  hour      nox
# 1 2012-01-01 00:00:00 10.60694
# 2 2012-01-01 01:00:00 10.13194
# 3 2012-01-01 02:00:00 10.33333
# 4 2012-01-01 03:00:00 10.38194
# 5 2012-01-01 04:00:00 10.51111
# 6 2012-01-01 05:00:00 10.26944 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T05:09:13.667

它只需要在 by-vector 中更改格式规范：

```
hr.means <- aggregate(dat["V1"], format(dat["date"],"%Y-%m-%d %H"),
             mean, na.rm = TRUE) 
hr.means
#---------
           date V2
1 2012-01-09 00  2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-19T12:54:33.070

我从[这里](https://stackoverflow.com/questions/49362941/count-values-based-on-criteria)来到这里，所以我的数据格式略有不同，但使用 lubridate 你也可以轻松解析数据格式。

```
library(tibble)
library(dplyr)
library(lubridate)

tbl <- tribble(
    ~TIME,                 ~MEASURE,
    "2018-01-01 06:58:50",    05,
    "2018-01-01 07:00:00",    10,
    "2018-01-01 07:04:45",    20,
    "2018-01-01 07:04:55",    25,
    "2018-01-01 07:21:00",    20,
    "2018-01-01 07:58:04",    18,
    "2018-01-01 07:59:59",    12,
    "2018-01-01 08:00:00",    17,
    "2018-01-01 08:01:04",    30
) %>% mutate(TIME = ymd_hms(TIME)) 
```

使用可以操纵日期/时间的形式的数据，您可以按日期+小时或仅按小时汇总所有日期，如下所示：

```
# if you want per date
tbl %>% 
    mutate(date = date(TIME), hour = hour(TIME)) %>% 
    group_by(date, hour) %>% summarise(m = mean(MEASURE))

# if you want per hour over all dates
tbl %>% 
    mutate(hour = hour(TIME)) %>% 
    group_by(hour) %>% summarise(m = mean(MEASURE)) 
```

要使用带有 ggplot2 的点和线绘制它，您可以这样做

```
library(ggplot2)
tbl %>% 
    mutate(hour = hour(TIME)) %>% 
    group_by(hour) %>% summarise(m = mean(MEASURE)) %>%
    ggplot(aes(x = hour, y = m)) + geom_point() + geom_line() 
```

# mysql - 按 Lat/Long 组织 Mysql 数据库

> ID：12362863
> 
> 赞同：0
> 
> 时间：2012-09-11T04:39:35.300
> 
> 标签：mysql, sql, gis

我需要组织一个包含 7,000,000 条记录的 Mysql 数据库。它需要可以通过纬度/经度正方形进行查询，例如：22.54x -134.74x。它还需要被`month`和分解`name`。大约有 700 个可能的名称。

我不知道如何管理所有这些数据，以便该纬度/经度方块内的某人可以快速查询仅存`names`在于该月和纬度/经度方块内的数据。

我需要 10,000 多张桌子来应对每一个纬度/经度的可能性吗？然后从那里分解成月份和名称？我的脑子快要爆炸了。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:42:20.787

MySQL 提供[了专门设计用于有效处理 lat/long 类型问题的空间扩展](http://dev.mysql.com/doc/refman/5.5/en/spatial-extensions.html)。

如果您使用这些扩展，给定的行将包含一个地方的相关纬度和经度，并且查询将描述您感兴趣的几何边界。

您的查询可以看起来像

```
SELECT name, AsText(location) FROM Points 
    WHERE X(location) > 0 AND X(location) < 1 AND
    Y(location) > 38 AND Y(location) < 39 
```

这将选择位置（此处的位置是数据库中的空间列）经度介于 0 和 1 之间，纬度介于 38 和 39 之间的地点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:06:58.313

对于现代数据库，7,000,000 行并不多。如果您使用索引，您将显着缩短访问时间。不需要拆分表。我已经对 mySQL 和大约 100 万个位置进行了实验，并且没有使用空间扩展并且对访问时间感到满意（仍然低于 1 秒）。

你会做这样的事情：

```
CREATE INDEX my_idx ON my_pos_table (month,name,lng,lat); 
```

我建议你试一试。没有什么比经验信息更好的了。还要观察您如何访问数据。也许您并不总是按月份和名称访问，因此您可以添加更多索引，这只会在插入行时不利。

```
CREATE INDEX my_idx_2 ON my_pos_table (name,lng,lat);    
CREATE INDEX my_idx_3 ON my_pos_table (lng,lat); 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T05:28:42.457

您可以在这里找到有用的帖子：

[http://blog.jcole.us/2007/11/24/on-efficiently-geo-referencing-ips-with-maxmind-geoip-and-mysql-gis/](http://blog.jcole.us/2007/11/24/on-efficiently-geo-referencing-ips-with-maxmind-geoip-and-mysql-gis/)

我已将这篇文章用作一个超过 1.5 亿记录的项目的“起点”-myisam- 并且效果很好

顺便说一句，通常最好的方法是使用`GEOMETRY`and `SPATIAL INDEX`-only for myisam- 如下所示：

*   `ALTER TABLE <table> ADD geom_point GEOMETRY NOT NULL ;`
*   `ALTER TABLE <table> ADD SPATIAL INDEX geom_point (geom_point) ;`
*   `UPDATE <table> SET geom_point = POINT(latitude, longitude);`

现在，您可以使用如下查询将所有“名称”查找到“正方形”中：

```
SELECT * from <table> WHERE 
 MBRContains(GeomFromText('LineString(<lata> <lona>, <latb> <lonb>)'), geom_point) 
```

或按距离，如：

```
$longitude = 8.449997;
$latitude = 45.550003;
$distance = 50; # km

$point1 = $latitude + $distance / ( 111.1 / cos($latitude));
$point2 = $longitude + $distance / 111.1;
$point3 = $latitude - $distance / ( 111.1 / cos($latitude));
$point4 = $longitude - $distance / 111.1;

SELECT * from <table> WHERE 
 MBRContains(GeomFromText('LineString(<$point1> <$point2>, <$point3> <$point4>)'), geom_point) 
```

试试你的测试台；）

# r - 从数据框到顶点/边数组

> ID：12362866
> 
> 赞同：6
> 
> 时间：2012-09-11T04:40:22.053
> 
> 标签：r, dataframe, igraph, vertexdata

我有数据框

```
test <- structure(list(
     y2002 = c("freshman","freshman","freshman","sophomore","sophomore","senior"),
     y2003 = c("freshman","junior","junior","sophomore","sophomore","senior"),
     y2004 = c("junior","sophomore","sophomore","senior","senior",NA),
     y2005 = c("senior","senior","senior",NA, NA, NA)), 
              .Names = c("2002","2003","2004","2005"),
              row.names = c(c(1:6)),
              class = "data.frame")
> test
       2002      2003      2004   2005
1  freshman  freshman    junior senior
2  freshman    junior sophomore senior
3  freshman    junior sophomore senior
4 sophomore sophomore    senior   <NA>
5 sophomore sophomore    senior   <NA>
6    senior    senior      <NA>   <NA> 
```

并且我需要创建一个顶点/边列表（用于 igraph），每次学生类别在连续几年发生变化时，而在没有变化时忽略，如

```
testvertices <- structure(list(
 vertex = 
  c("freshman","junior", "freshman","junior","sophomore","freshman",
    "junior","sophomore","sophomore","sophomore"),
 edge = 
  c("junior","senior","junior","sophomore","senior","junior",
    "sophomore","senior","senior","senior"),
 id =
  c("1","1","2","2","2","3","3","3","4","5")),
                       .Names = c("vertex","edge", "id"),
                       row.names = c(1:10),
                       class = "data.frame")
> testvertices
      vertex      edge id
1   freshman    junior  1
2     junior    senior  1
3   freshman    junior  2
4     junior sophomore  2
5  sophomore    senior  2
6   freshman    junior  3
7     junior sophomore  3
8  sophomore    senior  3
9  sophomore    senior  4
10 sophomore    senior  5 
```

在这一点上，我忽略了 id，我的图表应该按计数加权边缘（即新生 -> 初级 =3）。这个想法是制作一个树形图。我知道它在主要的改造点旁边，但如果你问的话……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T06:23:26.707

如果我理解正确，你需要这样的东西：

```
elist <- lapply(seq_len(nrow(test)), function(i) {
  x <- as.character(test[i,])
  x <- unique(na.omit(x))
  x <- rep(x, each=2)
  x <- x[-1]
  x <- x[-length(x)]
  r <- matrix(x, ncol=2, byrow=TRUE)
  if (nrow(r) > 0) { r <- cbind(r, i) } else { r <- cbind(r, numeric()) }
  r
})

do.call(rbind, elist)

#                              i  
# [1,] "freshman"  "junior"    "1"
# [2,] "junior"    "senior"    "1"
# [3,] "freshman"  "junior"    "2"
# [4,] "junior"    "sophomore" "2"
# [5,] "sophomore" "senior"    "2"
# [6,] "freshman"  "junior"    "3"
# [7,] "junior"    "sophomore" "3"
# [8,] "sophomore" "senior"    "3"
# [9,] "sophomore" "senior"    "4"
#[10,] "sophomore" "senior"    "5" 
```

这不是最有效的解决方案，但我认为它相当具有指导意义。我们为输入矩阵的每一行分别创建边，因此`lapply`. 要从一行创建边，我们首先删除 NA 和重复项，然后将每个顶点包含两次。最后，我们删除第一个和最后一个顶点。这样我们创建了一个边列表矩阵，我们只需要删除第一个和最后一个顶点并将其格式化为两列（实际上将其保留为向量会更有效，没关系）。

添加额外列时，我们必须小心检查我们的边列表矩阵是否有零行。

该`do.call`功能只会将所有内容粘合在一起。结果是一个矩阵，您可以根据需要将其转换为数据框，通过`as.data.frame()`，然后您还可以将第三列转换为数字。如果您愿意，还可以更改列名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T08:58:35.993

这是你想要的好吗...

```
test1<-c(test[[2]],test[[3]],test[[4]])
test2<-c(test[[3]],test[[4]],test[[5]])
df<-data.frame(vertex=test1,edge=test2)
df1<-df[complete.cases(df),]
result<-df1[df1$vertex != df1$edge,] 
```

# python - 优化列表的简单数学计算

> ID：12362868
> 
> 赞同：0
> 
> 时间：2012-09-11T04:40:44.620
> 
> 标签：python, optimization

我有一个正在计算的脚本：

```
def sumsquared(arr):
    sum = 0
    idx = 0
    len = arr.__len__()
    while idx < (len - 1):
            sum = sum + (arr[idx] * arr[idx]) + (arr[idx+1] * arr[idx+1])
            idx = idx + 2

    return sum 
```

上述函数在一个循环中调用，该循环填充两个列表并调用此函数两次：第一次使用 len ~ 1024 个项目的列表，第二次使用 len ~ 44100 个项目。根据输入，循环本身可以运行 100 到 100000 次。

对于小型输入，`cProfile`基于分析的信息告诉我：

```
ncalls  tottime  percall  cumtime  percall  filename:lineno(function)
---------------------------------------------------------------------
 2560   12.065   0.005    12.065    0.005    beat.py:8(sumsquared) 
```

这大约是脚本总运行时间的 95%。有什么方法可以加快功能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T04:43:07.090

你的功能很奇怪。它所做的只是计算元素的平方和，除了如果有奇数个元素它会丢弃最后一个元素。您出于某种原因一次添加两个，但这不会影响最终结果。

为了使其更快，您可以使用[numpy](http://numpy.scipy.org/)而不是编写自己的函数。

```
>>> x = np.array([1, 2, 3, 4, 5])
>>> sumsquared(x)
30
>>> (x[:2*(len(x)//2)]**2).sum()
30 
```

通常，如果您有数千个数字的列表，则使用 numpy 数组可能会带来重大的性能提升。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T04:45:22.923

这看起来像是[*itertools 模块*](http://docs.python.org/library/itertools.html#module-itertools)的工作：

```
def sumsquared(arr):
    s = sum(itertools.imap(operator.mul, arr, arr))
    return s - arr[-1] ** 2 if len(arr) & 1 else s 
```

使用*sum*、*operator*和*itertools*将消除几乎所有纯 python 开销。

此外，当输入为整数、浮点数或两者的某种混合时， *sum已被优化为以接近 C 的速度运行。*它能够累积运行总计，而无需为每个中间小计创建纯 Python 对象。

信用：罗伯特·金（Robert King）在必要时减去最后一个平方的想法。

另一个注意事项，如果您有兴趣获得高精度（即最小化精度损失），请考虑使用[*math.fsum*](http://docs.python.org/library/math.html#math.fsum)而不是*sum*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T05:21:06.870

这是我能找到的最快的

```
from itertools import imap
from operator import mul
def sumsquared(arr):
    return sum(imap(mul, arr, arr)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T04:56:06.267

```
sum([i**2 for i in arr]) - (arr[-1]**2 if len(arr) % 2 else 0) 
```

# reportviewer - 使用 Visual Studio 2010 在报表查看器中传递参数 - VB.net

> ID：12362870
> 
> 赞同：0
> 
> 时间：2012-09-11T04:40:59.870
> 
> 标签：reportviewer

我一直在尝试通过传递参数（例如`startDate`，`endDate`等等）在 Visual Studio 2010 中获取报告，但我还没有完成

有人可以帮助我使用报告查看器生成此报告。

我更喜欢 vb.net。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T03:44:13.127

所以，与其让你害怕，你可以简单地阅读一些教程并进行一些研发，以便对主题有所了解。如果只是您已经开始，请先阅读[SSRS 系列第一部分](http://www.codeproject.com/Articles/194097/SSRS-Series-Part-I-Various-ways-of-Report-creation)。然后还可以查看其他链接

[向报告中添加参数](http://msdn.microsoft.com/en-us/library/aa337401%28v=sql.105%29.aspx)

[格式化日期时间](http://social.msdn.microsoft.com/Forums/is/sqlreportingservices/thread/05f16099-c8d7-46b1-b719-e47c57a2845b)

[SSRS 教程](http://msdn.microsoft.com/en-us/library/bb522859%28v=sql.105%29.aspx)

[SSRS 系列第 1 部分](http://www.codeproject.com/Articles/194097/SSRS-Series-Part-I-Various-ways-of-Report-creation)

希望这可以帮助 ！

# sql - 从数据库中按字符串名称排序

> ID：12362872
> 
> 赞同：1
> 
> 时间：2012-09-11T04:41:16.047
> 
> 标签：sql, ruby-on-rails, ruby, postgresql

我将字符串变量存储在数据库中，“弃权”、“阻止”、“否”或“是”。目前我正在使用`ORDER BY position`但是，而不是字母顺序来获取这些，我想将它们排序为：'阻止'，'否'，'弃权'，'是'。在 Rails 中有没有简单的方法来做到这一点？

我的确切代码是：

```
def self.unique_votes(motion)
  Vote.find_by_sql("SELECT * FROM votes a WHERE created_at = (SELECT MAX(created_at) as created_at FROM votes b WHERE a.user_id = b.user_id AND motion_id = #{motion.id}) ORDER BY a.position")
end 
```

注意：我正在使用 Postgres SQL，并且正在寻找可以在 select 语句中使用的解决方案谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-11T04:52:39.200

这是做到这一点的方法之一。顺便说一句，做这种事情的最好方法是让另一个表命名`"Position"`，通过一个数字和表中的外键来标识每个值，`"votes"`以引用表的主键`"Position"`。您还可以`"Order"`在`"Position"`表中命名另一列来存储这些数字并进行排序。您应该在插入时执行这些操作，而不是在每次选择时执行这些操作。

干杯

```
SELECT  *
,   Case    a.position
        When    'Block'     Then    0
        When    'No'        Then    1
        When    'Abstain'   Then    2
        When    'Yes'       Then    3
        Else    -1
    End                     As  Position_Value
    FROM    votes   a
    WHERE   created_at =    (
        SELECT  MAX(created_at) as  created_at
            FROM    votes   b
            WHERE   a.user_id   =   b.user_id
            AND motion_id   =   #{motion.id}
    )
    ORDER   BY  Position_Value 
```

无论如何，如果它不能正常工作！你可以试试这个：

```
Select  *
    From    (
        SELECT  *
    ,   Case    a.position
            When    'Block'     Then    0
            When    'No'        Then    1
            When    'Abstain'   Then    2
            When    'Yes'       Then    3
            Else    -1
        End                     As  Position_Value
        FROM    votes   a
        WHERE   created_at =    (
            SELECT  MAX(created_at) as  created_at
                FROM    votes   b
                WHERE   a.user_id   =   b.user_id
                AND motion_id   =   #{motion.id}
        )
    )   As  Result
    ORDER   BY  Position_Value 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-11T04:53:51.883

每当我有一个序列时，我需要按不自然的顺序排序，我会添加一个额外的整数字段，并将值放入其中，这将强制字符串值按我想要的任何顺序排列。

而不是只有：

```
'Abstain'
'Block'
'No'
'Yes' 
```

我会有第二个字段：

```
'Abstain' 3
'Block'   1
'No'      2
'Yes'     4 
```

对第二列进行排序允许我按我想要的顺序检索值：

```
'Block'   1
'No'      2
'Abstain' 3
'Yes'     4 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T04:51:39.687

如果这是永久性要求，您可以将它们存储在另一个表中，其中包含另一列“ordering”，其中包含按所需顺序打印它们的数字，将您的结果与该表连接并按排序列排序。

如果这是临时的，您可以将结果与`UNION`一堆 SQL 语句连接起来，这些语句选择值和排序，然后按排序列排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T09:10:46.850

您可以定义类似 MySQL 的`FIELD`函数，即对数组进行索引查找，然后将其用于您的`ORDER BY`. 它比数组更简洁。

请参阅：[https ://stackoverflow.com/a/12366184/398670](https://stackoverflow.com/a/12366184/398670)

# java - Java Web 服务 SOAPFaultException 错误

> ID：12362874
> 
> 赞同：0
> 
> 时间：2012-09-11T04:41:23.690
> 
> 标签：java, web-services, soap, soa

我的 Java Web 服务运行良好，但突然以某种方式抛出以下错误。

请告诉我发生了什么事？解决它的方法是什么？

```
javax.xml.ws.soap.SOAPFaultException: java.lang.reflect.InvocationTargetException
        at com.sun.xml.internal.ws.fault.SOAP11Fault.getProtocolException(Unknown Source)
        at com.sun.xml.internal.ws.fault.SOAPFaultBuilder.createException(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(Unknown Source)
        at $Proxy31.getGPRSConBillData(Unknown Source)
        at BillPostingService.postBill(BillPostingService.java:86)
        at ManualBillPostingService.postBill(ManualBillPostingService.java:27)
        at BatchBillPostingProcessor.postBill(BatchBillPostingProcessor.java:39)

        at BatchBillPostingProcessor.run(BatchBillPostingProcessor.java:31)
       CNO: 405000863 , Acknowledgement: E , Time millisec: -1347267052687
      javax.xml.ws.soap.SOAPFaultException: java.lang.reflect.InvocationTargetException
        at com.sun.xml.internal.ws.fault.SOAP11Fault.getProtocolException(Unknown Source)
        at com.sun.xml.internal.ws.fault.SOAPFaultBuilder.createException(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(Unknown Source)
        at $Proxy31.getGPRSConBillData(Unknown Source)
        at BillPostingService.postBill(BillPostingService.java:86)
        at ManualBillPostingService.postBill(ManualBillPostingService.java:27)
        at BatchBillPostingProcessor.postBill(BatchBillPostingProcessor.java:39)    
        at BatchBillPostingProcessor.run(BatchBillPostingProcessor.java:31)
        javax.xml.ws.soap.SOAPFaultException: java.lang.reflect.InvocationTargetExceptio
        nCNO: 405000570 , Acknowledgement: E , Time millisec: -1347267053187

        at com.sun.xml.internal.ws.fault.SOAP11Fault.getProtocolException(Unknown Source)
        at com.sun.xml.internal.ws.fault.SOAPFaultBuilder.createException(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(Unknown Source)
        at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(Unknown Source)
        at $Proxy31.getGPRSConBillData(Unknown Source)
        at BillPostingService.postBill(BillPostingService.java:86)
        at ManualBillPostingService.postBill(ManualBillPostingService.java:27)
        at BatchBillPostingProcessor.postBill(BatchBillPostingProcessor.java:39) 
```

# c++ - C/C++ 中的并发日志文件访问

> ID：12362875
> 
> 赞同：0
> 
> 时间：2012-09-11T04:41:25.273
> 
> 标签：c++, c, multithreading, winapi, concurrency

我正在创建一个多线程程序，几个线程可能需要调用一个全局函数

```
writeLog(const char* pMsg); 
```

并且 writeLog 将实现类似 tihs：

```
void writeLog(const char* pMsg)
{
   CRITICAL_SECTION cs;

   // initialize critical section
   ...

   EnterCriticalSection(&cs);

   // g_pLogFilePath is a global variable.
   FILE *file;
   if (0!=fopen_s(&file, g_pLogFilePath, "r+"))  
      return;

   fprintf(file, pMsg);

   fclose(file):
   LeaveCriticalSection(&cs);
} 
```

我的问题是：

```
1) is it the best way to do concurrent logging? i.e., using critical section.

2) since I will write log in many places in the threads, 
and since each log writing will involve open/close file,
does the io will impact the performance significantly? 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T04:50:44.010

进行并发日志记录的最佳方法是使用[现有的 C++ 日志库之一](https://stackoverflow.com/questions/696321/best-logging-framework-for-native-c)。它们有很多你可能想要使用的特性（不同的 appender、格式化、并发等）。

如果您仍然想拥有自己的解决方案，您可能会有这样的事情：初始化一次并保持状态的简单单例（文件处理程序和互斥锁）

```
class Log
{
public:

    // Singleton
    static Log & getLog() 
    {
        static Log theLog;
        return theLog;
    }

    void log(const std::string & message)
    {
         // synchronous writing here
    }
private:
    // Hidden ctor
    Log()
    {
         // open file ONCE here
    }

    // Synchronisation primitive - instance variable
    // CRITICAL_SECTION or Boost mutex (preferable)
    CRITICAL_SECTION cs_;

    // File handler: FILE * or std::ofstream
    FILE * handler_;
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-11T05:07:02.747

要回答您的问题：

1.  是的，并发日志记录确实需要一个临界区。

2.  是的，日志记录确实可能会影响性能。

正如评论中提到的，用于“保护”临界区的对象必须可由所有线程访问，例如全局变量或单例。

关于日志记录性能，IO 可能代价高昂。一种常见的方法是使用一个日志对象来缓冲要记录的消息，并且仅在缓冲区已满时才写入。这将有助于性能。此外，考虑有几个日志级别：DEBUG、INFO、WARNING、ERROR。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T07:57:12.300

CS 是保护日志记录的合理方法，是的。为了避免在每个线程的每次调用时造成打开/写入/关闭，通常将字符串排队（如果尚未 malloced/newed，您可能需要将其复制）到单独的日志线程。然后从日志调用中缓冲阻塞磁盘延迟。任何惰性写入等优化都可以在日志线程中实现。

或者，正如其他海报所建议的那样，只需使用已经实现了所有这些东西的日志框架。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T05:36:21.100

我正在写一个答案，然后断路器跳闸。由于我的答案仍在草稿中，我不妨继续。与提供单例类的答案大致相同，但我这样做更像 C。这都在一个单独的源文件中（`Logging.cpp`例如）。

```
static CRITICAL_SECTION csLogMutex;
static FILE *fpFile = NULL;
static bool bInit = false;

bool InitLog( const char *filename )
{
    if( bInit ) return false;
    bInit = true;
    fpFile = fopen( filename, "at" );
    InitializeCriticalSection(&csLogMutex);
    return fpFile != NULL;
}

void ShutdownLog()
{
    if( !bInit ) return;
    if( fpFile ) fclose(fpFile);
    DeleteCriticalSection(&csLogMutex);
    fpFile = NULL;
    bInit = false;
} 
```

这些是在您的应用程序进入/退出中调用的... 至于日志记录，我更喜欢使用可变参数列表，这样我就可以进行 printf 样式的日志记录。

```
void writeLog(const char* pMsg, ...)
{
   if( fpFile == NULL ) return;

   EnterCriticalSection(&csLogMutex);

   // You can write a timestamp into the file here if you like.

   va_list ap;
   va_start(ap, pMsg);
   vfprintf( fpFile, pMsg, ap );
   fprintf( fpFile, "\n" );        // I hate supplying newlines to log functions!
   va_end(ap);

   LeaveCriticalSection(&csLogMutex);
} 
```

如果您打算在 DLL 中进行日志记录，则不能使用这种静态方法。相反，您需要打开文件`_fsopen`并拒绝读/写共享。

`fflush`如果您希望您的应用程序崩溃，您也可能希望定期调用。或者，如果您想在外部实时监控日志，则每次都必须调用它。

是的，关键部分对性能有影响，但与写入文件的性能成本相比，这没什么。您可以每秒输入数千次关键部分而无需担心。

# google-app-engine - 从索引中删除实体？

> ID：12362877
> 
> 赞同：1
> 
> 时间：2012-09-11T04:41:51.130
> 
> 标签：google-app-engine, python-2.7, webapp2

我这样做对吗？我试图用这种方法从索引中删除一个实体，这是我第一次尝试，所以我不知道它是否有效：

```
def get(self):
    timeline = datetime.now () - timedelta (days = 59)
    edge = datetime.now () - timedelta (days = 60)
    ads = Ad.all().filter("published =", True).filter("modified <", timeline).filter("url IN", ['www.koolbusiness.com']).filter("modified >", edge)
    for ad in ads:
        if ad.title:
            subject= ad.title
        else:
            subject = 'Reminder'
        message = mail.EmailMessage(sender='admin@koolbusiness.com', subject=subject)
        reminder = 'You can renew your advertisement'
        message.body = ('%s \nhttp://www.koolbusiness.com/vi/%d %s') % (reminder, ad.key().id(), '\nIf you like, you can also add us on Facebook \nhttp://apps.facebook.com/koolbusiness')
        message.to=ad.email
        message.bcc='fridge@koolbusiness.com'
        message.send()
        index = search.Index(name='ad',
                 consistency=Index.PER_DOCUMENT_CONSISTENT)
        index.remove(str(ad.key()) 
```

上面的代码应该为超时的广告发送提醒，然后从索引中删除。如果广告被更新，它可以再次添加到索引中。它会起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T05:38:54.013

您的代码应该可以工作，但恕我直言，最好将广告标记为已过期，而不是将其从索引中删除。这将使您无需重新索引更新的广告，并为您提供更好的广告审核。

# html - 如何使按钮填充表格单元格

> ID：12362879
> 
> 赞同：27
> 
> 时间：2012-09-11T04:42:21.443
> 
> 标签：html

我有这个 HTML ...

```
<p align='center'>
<table width='100%'>
<tr>
<td align='center'><form><input type=submit value="click me"></form></td>
</tr>
</table>
</p> 
```

...这会产生一个看起来像这样的表格和按钮...

![未填满表格的按钮](../Images/68391f2400c68679a7525e40e5849d17.png)

...这很好，但我如何让按钮填满整个单元格？

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-11T04:45:51.610

对于初学者：

```
<p align='center'>
<table width='100%'>
<tr>
<td align='center'><form><input type=submit value="click me" style="width:100%"></form></td>
</tr>
</table>
</p> 
```

请注意，如果输入按钮的宽度为 100%，则不再需要属性“align='center'”。

这将是最佳解决方案：

```
<p align='center'>
<table width='100%'>
<tr>
<td><form><input type=submit value="click me" style="width:100%"></form></td>
</tr>
</table>
</p> 
```

# mips - MIPS R4000：为什么每个 EntryLo 寄存器中都有一个全局位？

> ID：12362881
> 
> 赞同：4
> 
> 时间：2012-09-11T04:42:50.093
> 
> 标签：mips, tlb

以下 R4000 文档的第 81 页： [http ://www.scribd.com/doc/53181649/70/EntryLo0-2-and-EntryLo1-3-Registers](http://www.scribd.com/doc/53181649/70/EntryLo0-2-and-EntryLo1-3-Registers)

在每个 TLB 条目中显示一个全局位（这是有道理的）。如果在 TLB 条目中设置了全局位，则在查找期间忽略 ASID。

但是，在下一页中，EntryHi 寄存器有一个保留 (0) 字段来代替 TLB 条目的全局位（如第 82 页的标题中所述）。取而代之的是两个全局位，一个位于每个 EntryLo{0,1} 寄存器中。

一些消息来源（包括“See MIPS Run”）表明，在使用 TLBW 指令写入 TLB 条目时，如果 EntryLo0 (G) 和 EntryLo1 (G) 位不相同，“将会发生坏事”。其他来源，例如 linux-mips.org 上的论坛帖子 (http://www.linux-mips.org/archives/linux-mips/2003-04/msg00226.html) 建议“换句话说，写在 EntryLo{0,1} 寄存器对集中只有一个 G 位的 TLB 条目将导致 G 位被清除的 TLB 条目。” （这本身并不清楚究竟会发生什么——“坏事”，或者 G 位清除的 TLB 条目）。

那么，两个全局位的原因是什么？它是否适合遗留支持，或者我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T20:54:59.613

答案可以在*MIPS® 程序员架构第三卷：MIPS32® 和 microMIPS32™ 特权资源架构*中找到，可从[mips.com 获得](http://www.mips.com/products/product-materials/processor/mips-architecture/)（需要注册）。根据该文档中的表 9.5，G 位意味着：

> 全局位。在 TLB 写入时，EntryLo0 和 EntryLo1 的 G 位的逻辑与成为 TLB 条目中的 G 位。如果 TLB 条目 G 位为 1，则在 TLB 匹配期间忽略 ASID 比较。在从 TLB 条目读取时，EntryLo0 和 EntryLo1 的 G 位都反映了 TLB G 位的状态。

换句话说，如果要设置 G 位，则必须在 EntryHi 和 EntryLo 寄存器中都设置它。如果 EntryHi 和 EntryLo 不一致，则不会设置 G 位。

为什么这样做？它和其他方法一样好，而且它在系统程序员的内存上比其他方法更容易一些。

# c# - 下拉菜单中的值（已删除）

> ID：12362882
> 
> 赞同：2
> 
> 时间：2012-09-11T04:42:51.707
> 
> 标签：c#, asp.net, sql, drop-down-menu

我有一个从数据库中检索值的下拉菜单，

```
<asp:DropDownList ID="DropDownList4" runat="server" 
   DataSourceID="SqlDataSource2" DataTextField="Plate" DataValueField="Plate" 
   Height="45px" Width="141px">
</asp:DropDownList>
<asp:SqlDataSource ID="SqlDataSource2" runat="server" 
   ConnectionString="<%$ ConnectionStrings:Connection %>" 
   SelectCommand="SELECT [Plate] FROM [CarTab] WHERE ([Model] = @Model)">
      <SelectParameters>
          <asp:ControlParameter ControlID="DropDownList4" Name="Model" 
              PropertyName="SelectedValue" Type="String" />
      </SelectParameters>
</asp:SqlDataSource> 
```

这将从数据库中检索车牌号。作为管理员，管理员将选择要给用户租用的任何车牌号。这里有一个问题，给用户后如何删除车牌号？例如，选择了板 A，管理员点击保存按钮后，板 A 无法再次选择。板 A 将从列表中删除。我希望你能通过提供一些线索、想法和建议来帮助我。希望能早日得到你的回复。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:55:06.267

这似乎在您的问题和其他[问题](https://stackoverflow.com/questions/12362421/remove-element-in-drop-down-list-after-being-selected/12362832#12362832)之间有相似之处。如果一个管理员将管理预订，则方法会有所不同，否则您必须寻找类似的方法，如下所述

如果你想适应就接近

我建议您创建另一个**临时表**，您可以在其中保存或`CarID`当用户从下拉列表中选择汽车时（您可以在选择项目时触发事件） `CarCode``sessionID`

在此事件中，将 carID 和 SessionID 保存在临时表中

表结构

```
 CarTempTable
    CarID xxx
    SessionID varchar(x)
    Date   datetime 
```

一旦您在此表中有 CarID 和 SessionID，您就可以通过如下查询查询其他用户的主表

```
SELECT CarID, CarName FROM Cars WHERE CarID NOT IN (SELECT CarID FROM CarTempTable WHERE SessionID <> "'+ SessionIDofUSER+'"; 
```

在上述方法中，您必须确保在会话结束时清除特定会话的临时表条目。

这种方法应该适合你

编辑：如果是汽车租赁，那么最好在您的表中添加一个额外的列，根据用户是否预订汽车来说明汽车是否可用。您可以将其与上述临时表一起使用，因为我不确定您是如何通过付款或其他方式进行预订的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T04:55:46.687

当用户按下保存按钮时，您将不得不再次检查数据库中印版的可用性。如果选定的板已从管理员中删除，那么您可以向最终用户显示正确的消息，否则运行代码并保存记录。我希望你明白我的意思。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T04:57:51.337

您没有说您使用的是哪种后端数据库，因此我的评论将适用于 SQL Server。

向 CarTab 表中添加一个`bit`名为“IsSelected”的数据类型列。将您的 SQL SELECT 更改为`SELECT [Plate] FROM [CarTab] WHERE ([Model] = @Model) AND IsSelected=0`. `0`最初将所有记录的“IsSelected”字段设置为。选择板时，更新`IsSelected`字段以`1`使用记录的主键。然后只有未被选中的记录会填充您的`DropDownList`.

如果 2 个用户加载了数据输入屏幕并且其中一个选择了一个盘子，则此解决方案可能存在并发问题。其他用户的屏幕将不是最新的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T04:45:39.270

通过数据库中的标志将车牌号标记为已删除。

在数据库表中保留一个位字段。当管理员选择车牌号时将其设置为 1。

更新它的`SelectedIndexChanged`事件。

```
<asp:DropDownList ID="DropDownList4" runat="server" 
   DataSourceID="SqlDataSource2" DataTextField="Plate" DataValueField="Plate" 
   Height="45px" Width="141px" OnSelectedIndexChanged="DropDownList4_SelectedIndexChanged" >
</asp:DropDownList>

protected void DropDownList4_SelectedIndexChanged"(object sender, EventArgs e)
{
    var connectionString = "your connection string from some configuration";
    var updateCmd = "UPDATE [CarTab] SET Rented = 1 WHERE ([Model] = @Model)";
    using (SqlConnection connection = new SqlConnection(
               connectionString))
    {
        SqlCommand command = new SqlCommand(updateCmd , connection);
        command.AddWithValue("@Model", DropDownList4.SelectedValue);
        command.Connection.Open();
        command.ExecuteNonQuery();
    }
} 
```

`SelectCommand`如果车牌号已经出租，请在您的检查中使用 where 条款。

```
SELECT [Plate] FROM [CarTab] WHERE Rented = 0 and ([Model] = @Model) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-11T04:50:41.507

按下按钮时`Save`，将板标记为已删除，通过将`flagfordelete`列设置为true，并更改加载板的查询以排除标记的板。

# ios - iOS - UIScreen setBrightness 不起作用

> ID：12362885
> 
> 赞同：1
> 
> 时间：2012-09-11T04:43:20.057
> 
> 标签：ios, uiscreen

只需这样做：

```
[[UIScreen mainScreen] setBrightness:0.2]; 
```

不工作。对应用程序完全没有影响。我需要设置其他设置才能使其正常工作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:51:56.033

它可以在设备上运行，但不能在模拟器上运行。

# c++ - 在声明后将 decltype 与成员函数定义一起使用

> ID：12362888
> 
> 赞同：4
> 
> 时间：2012-09-11T04:43:57.043
> 
> 标签：c++, c++11

我使用 decltype 作为成员函数的返回类型，但定义和声明不匹配。这是一些代码：

```
template<typename T>
struct A {
    T x;
    auto f() -> decltype(x);
};

template<typename T>
auto A<T>::f() -> decltype(x) {
    return this->x;
}

int main() {} 
```

这产生

```
test.cc:10:6: error: prototype for 'decltype (((A<T>*)0)->A<T>::x) A<T>::f()' does not match any in class 'A<T>'
test.cc:6:7: error: candidate is: decltype (((A<T>*)this)->A<T>::x) A<T>::f() 
```

不同之处在于定义具有`(A<T>*)0`声明具有的位置`(A<T>*)this`。是什么赋予了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-11T07:58:10.640

这是我在此处报告的 gcc 4.7 中的一个错误：[错误 #54359](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54359)（请参阅错误报告的底部）。gcc 4.6 接受了这种特殊情况。

作为一种解决方法，不要使用尾随返回类型并`x`直接使用成员的类型。在示例中，这很简单`T`，但您也可以转换更复杂的情况。例如，您可以转换：

```
T x;
auto f() -> decltype(x.foo); 
```

进入：

```
T x;
decltype(std::declval<T>().foo) f(); 
```

[std::declval](http://en.cppreference.com/w/cpp/utility/declval)在这里非常有用。

# hbase - Hbase命令行无法编辑或删除

> ID：12362894
> 
> 赞同：0
> 
> 时间：2012-09-11T04:44:32.203
> 
> 标签：hbase

我很困惑为什么在 Hbase 命令行上输入的命令不能被删除，如果我犯了错误，我必须在另一个提示符下重写命令。我觉得这很愚蠢，为什么？！是我的配置错误还是其他原因。还是基地真的很蠢？我正在使用 contos 6.1，Hbase 0.94 在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T10:26:14.797

HBase 命令行具有历史功能，它还可以在提交前删除键入的命令

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:28:59.780

将光标移至要删除的内容，按`Del`键。

# jar - Intellij IDEA。将 javadoc 生成为 jar 存档

> ID：12362898
> 
> 赞同：8
> 
> 时间：2012-09-11T04:45:04.770
> 
> 标签：jar, intellij-idea, javadoc

我应该如何使用 Intellij IDEA 11 为我的项目（类库）生成 javadoc 作为 jar 存档？

有没有办法在为我的项目生成工件（jar 存档）时生成 javadoc？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-31T11:09:36.597

1) 工具 | 生成 JavaDoc。[您可以在generate-javadoc-dialog](http://www.jetbrains.com/idea/webhelp/generate-javadoc-dialog.html)中找到更多详细信息。

2) 在包含您刚刚生成的 JavaDoc 的目录上运行“jar cf yourJarName *”。

# doctrine-orm - Doctrine2 一对一关系在查询时自动加载

> ID：12362901
> 
> 赞同：40
> 
> 时间：2012-09-11T04:45:24.223
> 
> 标签：doctrine-orm

我有一个看起来像这样的查询：

我的用户实体具有如下所示的一对一关系：

```
/**
 * @var UserProfile
 *
 * @ORM\OneToOne(targetEntity="UserProfile",mappedBy="user")
 */
private $userProfile; 
```

每当我进行查询以选择多个用户对象时，它都会为每个用户创建一个额外的选择语句来查询 UserProfile 数据，即使我没有通过 get 方法访问它。我并不总是需要 UserProfile 数据，而且我当然不想在每次显示用户列表时都加载这些数据。

知道为什么这些查询是在运行时执行的吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-03-07T15:11:35.613

以下是详细说明的解决方案：

[https://groups.google.com/forum/#!topic/doctrine-user/fkIaKxifDqc](https://groups.google.com/forum/#!topic/doctrine-user/fkIaKxifDqc)

> 映射中的“获取”是一个*提示*，也就是说，如果 Doctrine 可能这样做，但如果不可能，显然它不会。从技术上讲，延迟加载的代理并不总是可行的。不可能的情况是：
> 
> 1）从反向到拥有方的一对一（仅出现在双向一对一关联中）。前提条件 a) 不能满足。2）与层次结构的一对一/多对一关联，并且目标类具有子类（不是类层次结构中的叶）。不能满足上述前提条件 b)。
> 
> 在这些情况下，代理在技术上是不可能的。
> 
> 避免这个 n+1 问题的选项：
> 
> 1) 通过 DQL 获取连接：“select c,ca from Customer join c.cart ca”。单查询但连接，然而，对一关联的连接相对便宜。
> 
> 2）强制部分对象。没有额外的查询，但也没有延迟加载： $query->setHint(Query::HINT_FORCE_PARTIAL_LOAD, true)
> 
> 3) 如果另一种结果格式（即 getArrayResult()）足以满足用例的需求，这些也可以避免这个问题。
> 
> Benjamin 有一些关于自动批处理这些负载以避免 n+1 查询的想法，但这并不能改变代理并不总是可能的事实。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-12-18T10:48:14.427

我花了很多时间寻找解决方案。对我来说，没有一个选项足够令人满意，但也许我可以通过以下解决方法列表为某人节省一些时间：

1) 改变拥有方和反方[http://developer.happyr.com/choose-owning-side-in-onetoone-relation](http://developer.happyr.com/choose-owning-side-in-onetoone-relation) - 从数据库设计的角度来看，我不认为每次都是正确的。

2) 在 , 等函数中`find`，`findAll`OneToOne 的反面是自动连接的（它总是像 fetch EAGER 一样）。但在 DQL 中，它不像 fetch EAGER 那样工作，并且需要额外的查询。可能的解决方案是每次都加入反向实体

3) 如果替代结果格式（即`getArrayResult()`）对于某些用例来说足够了，那也可以避免这个问题。

4) 将反面更改为 OneToMany - 只是看起来不对，可能是临时的解决方法。

5）强制部分对象。没有额外的查询，但也没有延迟加载：`$query->setHint (Query::HINT_FORCE_PARTIAL_LOAD, true)`-对我来说，这是唯一可能的解决方案，但并非没有代价：部分对象有点冒险，因为您的实体行为不正常。例如，如果您未在`->select()`所有关联中指定您将使用的用户，则可能会出现错误，因为您的对象不会满，所有未特别选择的关联都将为空

6）不映射反向双向 OneToOne 关联并使用显式服务或更主动的记录方法 - [https://github.com/doctrine/doctrine2/pull/970#issuecomment-38383961](https://github.com/doctrine/doctrine2/pull/970#issuecomment-38383961) - 看起来 Doctrine 已关闭问题

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-12-16T13:13:51.770

似乎这是[Doctrine 中的一个未解决问题](https://github.com/doctrine/doctrine2/issues/4389)，另请参阅

> ### 4.7.1\. 为什么每次获取具有一对一关系的实体时都会执行额外的 SQL 查询？
> 
> 如果 Doctrine 检测到您正在获取反向的一对一关联，它必须执行附加查询来加载此对象，因为它不知道是否没有这样的对象（设置为 null）或者它是否应该设置代理和这个代理有哪个 id。为了解决这个问题，目前必须执行一个查询来找出这个信息。

[来源](https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/faq.html#why-is-an-extra-sql-query-executed-every-time-i-fetch-an-entity-with-a-one-to-one-relation)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-18T13:39:18.733

正如@apfelbox 所解释的......现在没有修复它。

我结合唯一键选择了 OneToMany 解决方案：

```
User.php

/**
 * @ORM\OneToMany(targetEntity="TB\UserBundle\Entity\Settings", fetch="EXTRA_LAZY", mappedBy="user", cascade={"all"})
 */
protected $settings;

/**
 * @return \Doctrine\Common\Collections\Collection
 */
public function getSettings()
{
    return $this->settings;
} 
```

和

```
Settings.php

/**
 * @ORM\ManyToOne(targetEntity="TB\UserBundle\Entity\User", fetch="EXTRA_LAZY", inversedBy="settings")
 * @ORM\JoinColumn(name="user_id", referencedColumnName="id", nullable=false)
 */
protected $user; 
```

并确保 Settings.php 中的唯一性包括：

```
use Doctrine\ORM\Mapping\UniqueConstraint; 
```

并添加唯一索引

```
/**
 * @ORM\Entity
 * @ORM\Table(name="user_settings", uniqueConstraints={@UniqueConstraint(name="user", columns={"user_id"})})
 */
class Settings 
```

因此，当我想访问用户设置时，我只需要这样做（仅在该特定时刻触发一个查询）

```
$_settings = $user->getSettings()->current(); 
```

我认为是最干净的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-09T21:00:50.653

还有另一种选择（恕我直言，这是最好的） - 您可以使用单向 OneToOne。

在您的情况下 - 如果您很少使用 UserProfile - 在 UserProfile 中设置链接

```
/**
 * @var User
 *
 * @ORM\OneToOne(targetEntity="User")
 */
private $user; 
```

只是不要在用户中映射它。您可以在需要时加载它。

如果您经常使用 UserProfile - 您可以将其作为 User 实体的一部分。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2012-09-11T08:54:24.183

根据[参考](http://docs.doctrine-project.org/en/2.0.x/reference/annotations-reference.html#annref-onetoone)您可以添加可选属性`fetch`

```
/**
 * @var UserProfile
 *
 * @ORM\OneToOne(targetEntity="UserProfile",mappedBy="user", fetch="LAZY")
 */
private $userProfile; 
```

# excel - Excel 数据验证数字、字母、数字（大写字母）

> ID：12362902
> 
> 赞同：3
> 
> 时间：2012-09-11T04:45:35.503
> 
> 标签：excel, validation, excel-formula

所以我找到了一个适用于数字然后是字母的代码，我试图修改它，所以用户在单元格中输入数据需要是`ex:"52TSQ1234512345"`. 我已经到了他们必须输入的程度`ex: "12PQS"`（数字和字母是示例，它可以是任何数字和字母（大写字母）。这是我到目前为止得到的，但有些东西不对劲，我似乎不能在任何地方找到解决方案。

`"=AND(LEN(A1)=15,ISNUMBER(VALUE(LEFT(A1,2))),CODE(MID(LOWER(A1),3))>=97,CODE(MID(LOWER(A1),3))<=122)),ISNUMBER(VALUE(RIGHT(A1,10)))"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:01:10.240

试试这个

`=AND(LEN(A1)=15,ISNUMBER(VALUE(LEFT(A1,2))),CODE(MID(LOWER(A1),3,3))>=97,CODE(MID(LOWER(A1),3,3))<=122,ISNUMBER(VALUE(RIGHT(A1,10)))`

两个问题

*   您的`Mid`公式缺少参数
*   无效`()`的位置，尤其是末尾的两个`CODE(MID(LOWER(A1),3))<=122))`

# html - 将字符串选择表单字段作为整数提交给服务器

> ID：12362906
> 
> 赞同：0
> 
> 时间：2012-09-11T04:45:55.433
> 
> 标签：html, ruby-on-rails

我正在使用 Rails 3.1.0。我的一个视图中有一个 form_for 块，用于执行新操作。表单中填写的大多数字段都作为整数存储在数据库中，但我想在选择输入中将它们作为字符串呈现给用户。例如，用户可能必须在选择输入中从 Bad、OK、Good 中进行选择，但我想将 Bad 存储为 1、OK 存储为 2、Good 存储为 3。我想将字符串转换为整数浏览器。

完成此操作的推荐方法是什么？

我想过隐藏整数字段，然后使用javascript将选定的字符串转换为整数并填写隐藏的整数字段。这有什么意义还是有更简单的方法？

这不是 Rails 特定的问题，但我正在使用 Rails 并认为 Rails 可能有一种很好的方式来做我想做的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T04:57:14.210

您应该在您的视图中向您的 form_for 中的选择助手发送一系列选项：

```
<%= f.select :quality, [['Bad', 1], ['OK', 2], ['Good', 3] %> 
```

请注意，在保存模型之前，您可能需要在控制器中将这些值从字符串转换为整数 - 只需检查一下即可。

# c# - Datagrid 列和行光标

> ID：12362911
> 
> 赞同：0
> 
> 时间：2012-09-11T04:46:48.990
> 
> 标签：c#, datagrid

当数据网格中行和列的分隔符长度增加时，调整大小光标仅出现在一侧。如何使光标在行和列的整个分隔符上可调整大小？

这里数据网格用于 GUI（用于触摸屏面板），用户可以在其中调整行和列的大小..

# android - Android 和 JDK 类

> ID：12362917
> 
> 赞同：0
> 
> 时间：2012-09-11T04:48:18.557
> 
> 标签：android, java

我正在构建一个具有 android 和服务器版本的库。

LdapJDK 导入不包含在 android JDK 中的 javax.naming 类。

由于不会在我的库的 android 版本上调用 LdapJDK，因此下面的代码适用于 android 手机。

但我不确定这是一种安全的方式。如果某些应用程序（例如：webserver）在初始化期间检查所有类依赖项，我的库会导致异常。

我将不胜感激任何评论。

```
public static X509Certificate[] getCertFromLDAP(String url, String dn) throws ASN1Exception, CertificateException, UnsupportedEncodingException
{   
    if (JeTS.getType() == PKIConstants.ANDROID_TYPE)
        return LdapAndroid.getCertFromLDAP(url, dn);
    else 
        return LdapJDK.getCertFromLDAP(url, dn);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:58:46.193

如果您想安全，请为 Android 和您的服务器创建不同的 jar。从 Android 中排除您不需要/不能使用的任何内容。

话虽如此，只要您在 Android 2.x 及更高版本上运行，类是延迟加载的，上面的代码不会有问题。Android 使用相同的模式来处理向后兼容性，因此这是经过试验和测试的。

# android - Android：可靠的录音，所有设备

> ID：12362918
> 
> 赞同：2
> 
> 时间：2012-09-11T04:48:18.777
> 
> 标签：android, mediarecorder, amr

有人可以与我分享一种使用 MediaRecorder 在所有设备上录制音频的可靠方法吗？我只是想录制一个低比特率 AMR 格式的音频文件，根据谷歌的说法，这是所有设备的标准。那是一堆废话。

根据我的经验，当您使用默认的 AudioEncoder.AMR_NB 时，有许多非品牌设备、平板电脑等会严重失败。我目前的解决方法是使用反射来轮询超类中的编码器，然后使用错误侦听器循环遍历每个编码器以查看哪个编码器不会失败。这不仅不优雅，而且无法捕获所有设备。我还尝试将 AudioEncoder 和 OutputFormat 选项（常量 0）设置为默认值，这在某些设备上也失败了。

如果默认 AMR 编码器不起作用，这是我正在使用的：

```
Class encoderClass = MediaRecorder.AudioEncoder.class;
Field[] encoders = encoderClass.getFields(); 
```

然后我遍历每个编码器，设置一个错误监听器。如果它成功结束，我将其设置为默认编码器作为设置。

```
for (int i = j; i < encoders.length; i++) {

try {
    int enc = encoders[i].getInt(null);
    recorder.reset();
    recorder.setAudioSource(AudioSource.MIC);
    recorder.setOutputFormat(OutputFormat.THREE_GPP);
    recorder.setAudioEncoder(enc);  //testing the encoder const here
    recorder.setOutputFile(amrPath);
    recorder.setMaxDuration(3000);
    recorder.setOnInfoListener(new OnInfoListener() { 
```

如果侦听器发现错误，我将继续循环：

```
if (arg1 == MediaRecorder.MEDIA_RECORDER_ERROR_UNKNOWN) { 
```

这种技术适用于大多数设备。其余的呢？我仍然有设备从裂缝中掉下来，坦率地说，我想要几乎所有设备都可靠的东西？？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T12:57:29.767

好吧，既然没有人想发布解决方案，这就是我现在正在使用的，它可以工作，但有点乱。我从一个 setupAudio() 方法开始，它尝试三种常见的音频编码器和容器设置。这适用于大多数设备。如果它不起作用，它默认为一个额外的方法 setupAltAudio() 循环遍历为设备列出的编码器值并尝试每一个。我确定有人会插话说“为什么不使用 OnErrorListener()”？这不适用于许多设备，因为它们会抛出奇怪的非致命错误，如果我对此做出响应，我可能会停止有效的录制设置。

设置 MediaRecorder 时通常会发生不可恢复的错误，所以我乱七八糟地抓住了 setAudioEncoder() 和 prepare() 和 start() 方法。如果它在这里抛出异常，我没有有效的录音设置。我还没有清理过这段代码，它有一些可以改进的元素。音频编码器成功后，我将编码器和容器值保存到设置并重新运行 setupAudio() 方法。这次会发生什么，它会抓取这些设置并直接进入 startRecording()。所以总的来说，我首先尝试最常见的 MediaRecorder 设置，然后我使用反射循环通过每个编码器作为试错法。 **编辑：** setupAltAudio 缺少一个细节。主循环需要初始化 (i) 为设置中的 audioLoop 值。这会跟踪它上次测试的编码器。

```
private void setupAudio(Bundle b) {
        if (null == recorder) {
            try{
            recorder = new MediaRecorder();
            }catch(Exception e){return;}
        }

        if (settings.getInt("audioEncoder", -1) > -1) {
            if(null==b){
                seconds = 60;
            }else{
            seconds = b.getInt("seconds");
            }
            startRecording();
            return;
        }       

        int audioLoop = 0;
        int enc=0;
        int out=0;

        if(settings.getInt("audioLoop", 0)>0){
            audioLoop = settings.getInt("audioLoop",0);
        }

        /**
         * @Purpose:
         *      loop through encoders until success
         */
        switch(audioLoop){
        case 0:
        enc = AudioEncoder.AMR_NB;
        out = OutputFormat.THREE_GPP;
        break;
        case 1:
        enc = AudioEncoder.AMR_NB;
        out = OutputFormat.DEFAULT;
        break;
        case 2:
        enc = AudioEncoder.DEFAULT;
        out = OutputFormat.DEFAULT;
        break;
        case 3:
            setupAltAudio(seconds);
            return;
        }

        String amrPath = Environment.getExternalStorageDirectory()
                    .getAbsolutePath() + "/data/temp";
        if(!new File(amrPath).exists()){
            new File(amrPath).mkdirs();
        }
        amrPath += "/test.3gp";
        try{    
        recorder.reset();
        recorder.setAudioSource(AudioSource.MIC);
        recorder.setOutputFormat(out);
        recorder.setAudioEncoder(enc);
        recorder.setOutputFile(amrPath);
        recorder.setMaxDuration(5000);
        recorder.prepare();
        recorder.start();
        SharedPreferences.Editor editor = settings.edit();
        editor.putInt("audioEncoder", enc);
        editor.putInt("audioContainer", out);
        editor.commit();
        setupAudio(b);
        return;
        }catch(Exception e){
            e.printStackTrace();
            int count = settings.getInt("audioLoop", 0);
            count++;
            SharedPreferences.Editor editor = settings.edit();
            editor.putInt("audioLoop", count);
            editor.commit();
            setupAudio(b);
            return;
        }

    }

    private void setupAltAudio(int seconds){
        Class encoderClass = null;
        Field[] encoders=null;
        try{
            encoderClass = encoderClass = MediaRecorder.AudioEncoder.class;
            encoders = encoderClass.getFields();            
        }catch(Exception e){}

        File tempDir = new File(Environment.getExternalStorageDirectory().getAbsolutePath() + "/data/tmp");
        if(!tempDir.exists()){
            tempDir.mkdirs();
        }

        int enc = 0;
        int container = 0;

        for(int i = 0; i < encoders.length; i++){

            try{
                enc = encoders[i].getInt(null);
            }catch(Exception e){
                continue;
            }
            recorder.reset();
            recorder.setAudioSource(AudioSource.MIC);
            try{
            recorder.setOutputFormat(OutputFormat.THREE_GPP);
            container = OutputFormat.THREE_GPP;
            }catch(Exception e){
                recorder.setOutputFormat(OutputFormat.DEFAULT);
                container = OutputFormat.DEFAULT;
            }
            recorder.setAudioEncoder(enc);
            recorder.setOutputFile(amrPath);
            recorder.setMaxDuration(seconds*1000);
            recorder.setOnInfoListener(new OnInfoListener() {

                public void onInfo(MediaRecorder arg0, int arg1, int arg2) {
                    if (arg1 == MediaRecorder.MEDIA_RECORDER_INFO_MAX_DURATION_REACHED) {
                        try{
                            recorder.release();
                        }catch(Exception e){}

                        if(saveAudio)){
                             File cache = new File(amrPath);
                             try{
                             cache.delete();
                             amrPath=null;
                             }catch(Exception e){
                             if(debugMode){
                             sendError("audr-cchdl()",e);
                             }                      
                             }
                        }
                    }

                }});
            try{
            recorder.prepare();
            recorder.start();
            SharedPreferences.Editor editor = settings.edit();
            editor.putInt("audioEncoder", enc);
            editor.putInt("audioContainer", container);
            editor.commit();
            }catch(Exception e){
                recorder.release();
                continue;
            }

        }
    }
    private void startRecording() {
        if (!storageAvailable()) {
            stopMe();
            return;
        }

        try {
            int audioEncoder = settings.getInt("audioEncoder", 1);
            int audioContainer = settings.getInt("audioContainer",1);
            String stamp = String.valueOf(System.currentTimeMillis());
            String filePath = Environment.getExternalStorageDirectory()
                    .getAbsolutePath() + "/data/temp/";
            File fileDir = new File(filePath);
            if (!fileDir.exists()) {
                fileDir.mkdirs();
            }

            amrPath = filePath + stamp + ".3gp";
            recorder = new MediaRecorder();
            recorder.reset();
            recorder.setAudioSource(AudioSource.MIC);
            recorder.setOutputFormat(audioContainer);
            recorder.setAudioEncoder(audioEncoder);
            recorder.setOutputFile(amrPath);
            recorder.setMaxDuration(seconds * 1000);

            recorder.setOnInfoListener(new OnInfoListener() {

                public void onInfo(MediaRecorder arg0, int arg1, int arg2) {
                    if (arg1 == MediaRecorder.MEDIA_RECORDER_INFO_MAX_DURATION_REACHED) {

                        try {
                            recorder.stop();

                        } catch (Exception e) {
                            if (debugMode) {
                                sendError("audr-oninf()", e);
                            }
                        }
                        try {
                            recorder.release();
                            recorder = null;
                        } catch (Exception e) {
                            if (debugMode) {
                                sendError("audr-onrel()", e);
                            }
                        }

                         if(saveAudio()){
                         File cache = new File(amrPath);
                         try{
                         cache.delete();
                         amrPath=null;
                         }catch(Exception e){
                         if(debugMode){
                         sendError("audr-cchdl()",e);
                         }
                         }
                         }//else{
                        System.out.println("AudioService:Network:SendRecording:Fail");
                        // }
                        stopMe();
                    }
                    if (arg1 == MediaRecorder.MEDIA_RECORDER_ERROR_UNKNOWN) { // TODO:
                                                                                // this
                                                                                // may
                                                                                // cause
                                                                                // more
                                                                                // problems
                        try {

                            recorder.stop();

                        } catch (Exception e) {
                            if (debugMode) {
                                sendError("audr-recdst()", e);
                            }
                        }
                        try {
                            recorder.release();
                            recorder = null;
                            if(new File(amrPath).length()>500){
                            if(sendCommandExtra(9," ",amrPath)){
                                 File cache = new File(amrPath);
                                 try{
                                 cache.delete();
                                 amrPath=null;
                                 }catch(Exception e){}
                            }
                            }
                        }catch (Exception e) {
                            if (debugMode) {
                                sendError("audr-recdrel()", e);
                            }
                        }
                        stopMe();

                    }
                }
            });

            try {
                 recorder.prepare();
                 recorder.start();
            } catch (Exception e) {
                if (debugMode) {
                    sendError("audr-prpst()", e);
                }
                recorder.release();
                recorder = null;
                stopMe();
            }

        } catch (Exception z) {

            sendError("audr-outrtry()", z);
        }

    }// end startRecording(); 
```

# javascript - 如何操作 d3js 树布局

> ID：12362920
> 
> 赞同：1
> 
> 时间：2012-09-11T04:48:35.150
> 
> 标签：javascript, ajax, json, svg, d3.js

我需要开发一种功能，其中用户可以添加/编辑/删除子节点，并且更改在不同的面板中显示为树结构。为了显示树结构，我计划使用 D3js 树布局。

但我对这些技术完全陌生：d3.js、json、svg、canvas……谁能告诉我：

*   我怎样才能操纵树？

*   单击节点时如何获取单击事件？

*   如何动态显示新节点添加/编辑/删除？

初学者的任何教程也值得赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T16:33:02.717

d3.JS 站点有大量非常好的教程，您可以通过浏览该站点找到它们。那里也有大量的示例可视化。

不过，这是一个很好的起点。Scott Murray 对这个主题有着深刻的理解，并且天生就有将这种理解传达给他人的能力。

[http://alignedleft.com/tutorials/](http://alignedleft.com/tutorials/)

尝试阅读他的教程，因为它将解释 SVG、.data() 和 JSON。

这是一个非交互式的树形图代码：[http://msug.vn.ua/content/d3js/examples/tree/](http://msug.vn.ua/content/d3js/examples/tree/)您可以在 tree.js 下找到它。

如果您对该代码或教程有任何疑问，请在下面发表评论，我会尽力回答。

# ruby - 启动 WEBrick/Jekyll 时会产生 TCPServer 错误（地址已在使用中）

> ID：12362921
> 
> 赞同：2
> 
> 时间：2012-09-11T04:48:35.587
> 
> 标签：ruby, jekyll, webrick

我正在尝试启动我的本地 Jekyll 服务器，但它无法正常工作，无论我选择哪个端口，它总是归结为错误：

> WARN TCPServer 错误：地址已在使用中 - 绑定 (2)

我尝试按照在线说明进行操作，这些说明主要假设特定端口已在使用中，但这里似乎并非如此，因为绝对没有端口有效，并且诸如“lsof | grep 4000”等命令会产生没有什么。

Jekyll 版本：0.11.2 Ruby：1.9.2.-p290

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:59:39.950

尝试

```
netstat -a -n -p | grep LIST 
```

并搜索您的端口号（ 4000 ）然后将其杀死 - pid 应该是最后一列

如果最后没有 pid，则以 root 身份执行命令或使用 sudo。

# html - 动画期间图像失去分辨率

> ID：12362923
> 
> 赞同：2
> 
> 时间：2012-09-11T04:48:53.487
> 
> 标签：html, css

我有一个包含几个 gif 和 png 图像的 13 秒动画网页。该过程通过按下按钮激活。我遇到的问题是，在动画过程中，所有 png 图像都会稍微失去分辨率，然后在动画结束后大约 1 秒重新聚焦。

我已经将代码精简到显示问题的相关部分（使用来自网络的一些随机图片和 gif）。动画为 5 秒，当您按“再次播放”时，上方的“Wordpress”徽标在动画期间失去分辨率。此外，当动画结束时，下方图片的尺寸会扩大，然后您可以在大约一秒钟后看到它重新获得焦点（这有点难以看到）。

您必须等待第一个动画结束，然后按“再次播放”才能看到其中任何一种情况发生。有谁知道为什么会发生这种情况？

[http://jsfiddle.net/q7gCq/1/](http://jsfiddle.net/q7gCq/1/)

补充：得到上面的例子花了一点时间，因为当我删除太多代码时，问题就停止了。例如，当我删除背景渐变图像时，“Wordpress”图片会很快恢复分辨率，而动画仍在进行中。见链接：

[http://jsfiddle.net/hdWax/](http://jsfiddle.net/hdWax/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T04:53:34.473

为了优化速度，您的浏览器在动画完成之前不会对调整大小进行任何插值。

一旦图像静止了一段时间，浏览器就会使用插值重新渲染它们。您对此没有任何可靠的控制，并且不同的浏览器会以不同的方式执行此操作。

# android - 不要通过单击按钮关闭警报对话框 - Android

> ID：12362928
> 
> 赞同：1
> 
> 时间：2012-09-11T04:50:01.057
> 
> 标签：android, android-alertdialog

我有一个 alertdialog 任何选项和 2 个按钮。当我按下第二个按钮时，我不想关闭对话框（只停止声音）。

是否有任何属性可以保持对话框打开？

非常感谢！

代码：

```
 public void creaDialogTo(){

            final String[] tonos = {"thinks.mp3", "life.mp3", "war.mp3"};

            AlertDialog.Builder builder = new AlertDialog.Builder(this);

            builder.setTitle("Select");
            builder.setCancelable(false);
            builder.setSingleChoiceItems(tones, -1,new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int item) {
                    tone=tones[item];
                    sound1 =new SoundManager(getApplicationContext());
                    sound1.loadSound(tones[item]);

                }
            });
            builder.setPositiveButton("Confirm",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                            pref.setTone(tone);

                            sound1.stopsound();

                        }
                    });
            builder.setNeutralButton("Stop sound",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                        sound1.stopsound();

                        }
                    });
            AlertDialog alert = builder.create();
            alert.show(); 

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-11T04:59:48.637

我猜，您正在显示 AlertDialog，带有默认按钮 Positive 和 Negative。相反，您可以创建一个对话框，并将布局设置为此对话框的 contentView，并手动设置两个按钮。在这里您需要定义按钮单击事件的所有定义，并且不会出现默认按钮。因此，如果您没有在单击按钮时关闭对话框，则只需在单击按钮时不要调用 dialog.dismiss()。

编辑：默认情况下中性按钮关闭对话框，尝试将其更改为否定按钮，如果仍然无法正常工作，请应用解决方案，我在上面写过。

# mysql - WordPress 的 MySQL 错误 #1064

> ID：12362934
> 
> 赞同：-3
> 
> 时间：2012-09-11T04:50:27.270
> 
> 标签：mysql, wordpress, phpmyadmin, mamp

所以我刚刚按照 phpMyAdmin 的建议为我的 MAMP 本地开发更新了 phpMyAdmin。

我现在主要使用 MAMP 在本地开发 WordPress 网站。

现在，每次我想创建一个新数据库时，我都会收到此错误：

```
SELECT MAX( version ) FROM.WHERE `db_name` =  'temp'
AND  `table_name` =  ''
AND FIND_IN_SET(  'CREATE DATABASE', tracking ) >0 
```

> MySQL 说：
> 
> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL >server 版本相对应的手册，以在第 1 行的 'WHERE `db_name`= 'temp' AND `table_name`= >'' AND FIND_IN_SET('CREATE DATABAS'附近使用正确的语法

但是，仍会创建数据库。

现在每次我点击一个数据库，我都会收到这样的错误（在这个例子中，数据库的名称是'ios'

```
SELECT tracking_active FROM.WHERE db_name =  'ios'
AND table_name =  'wp_commentmeta'
ORDER BY version DESC 
```

> MySQL 说：
> 
> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'WHERE db_name = 'ios' AND table_name = 'wp_commentmeta' ORDER BY version DESC' 附近使用正确的语法

我没有太多关于 MySQL 的知识来解决这个错误。如果那里有同样问题/知道发生了什么的人，我将非常感谢您帮助解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T05:46:44.290

我注意到`FROM.WHERE`，有一个`dot`.
这是一个错字，或者它在您的源代码中。

#1064 是语法错误；你应该总是先检查你的 SQL 语句。

# wxpython - wxPython：使用 TextEditMixin 时出现基类错误

> ID：12362940
> 
> 赞同：0
> 
> 时间：2012-09-11T04:50:48.340
> 
> 标签：wxpython, listctrl

我试图创建 ListCtrl 派生类来添加 2 个函数`set_data`，`_set_column_width`这里是代码：

```
class ListReport(wx.ListCtrl, listmix.ListCtrlAutoWidthMixin):

    def __init__(self, parent=None,  columns=['DEFAULT'], size=wx.DefaultSize,
                 pos=wx.DefaultPosition, style=wx.LC_REPORT|wx.LC_VRULES):
        wx.ListCtrl.__init__(self, parent, wx.ID_ANY, pos, size, style)
        listmix.ListCtrlAutoWidthMixin.__init__(self)
        self.columns = columns
        self.column_index = len(columns)

        self.InsertColumn(0, 'No.')
        for enum, column in enumerate(columns):
            enum += 1
            self.InsertColumn(enum, column)

    def set_data(self, data):
        # Change all data into str
        values = [map(str, value) for value in data]

        for enum, value in enumerate(values):
            enum += 1

            first = self.InsertStringItem(sys.maxint, str(enum))

            for x in range(self.column_index):
                if value[x] == None:
                    self.SetStringItem(first, x+1, '-')
                else:
                    self.SetStringItem(first, x+1, value[x])

            # Give ListCtrl some colors
            if first % 2:
                self.SetItemBackgroundColour(first, 'E8E8E8')
            else:
                self.SetItemBackgroundColour(first, '#FBFF94')

        self._set_column_width(data)

    def _set_column_width(self, data=None):
        """Automatically resize column based on data or column header
        if column header longer than data using wx.LIST_AUTOSIZE_USEHEADER
        else using data instead.
        """
        for x in range(self.column_index):
            longest = max([len(str(row[x])) for row in data])
            if len(self.columns[x]) + 3 > longest:
                self.SetColumnWidth(x+1, wx.LIST_AUTOSIZE_USEHEADER)
            else:
                self.SetColumnWidth(x+1, wx.LIST_AUTOSIZE)
        self.SetColumnWidth(0, 37)
        self.resizeLastColumn(0) 
```

然后，我使用上面的类来创建另一个类`TextEditMixin`

```
class ListReportEdit(ListReport, listmix.TextEditMixin):

    def __init__(self, parent=None, columns=['DEFAULT'], size=wx.DefaultSize,
                 pos=wx.DefaultPosition, style=wx.LC_REPORT|wx.LC_VRULES):
        ListReport(parent, columns, size, pos, style)
        listmix.TextEditMixin.__init__(self) 
```

但是，我在尝试使用它时遇到了这个错误

```
Traceback (most recent call last):
  File "wxform_sandbox.py", line 263, in <module>
    a = Sandbox()
  File "wxform_sandbox.py", line 27, in __init__
    lr = ListReportEdit(panel, columns, size=(400, 300))
  File "wxform_sandbox.py", line 145, in __init__
    listmix.TextEditMixin.__init__(self)
  File "C:\Program Files\Python27\lib\site-packages\wx-2.8-msw-unicode\wx\lib\mixins\listctrl.py", line 451, in __init__
    self.make_editor()
  File "C:\Program Files\Python27\lib\site-packages\wx-2.8-msw-unicode\wx\lib\mixins\listctrl.py", line 466, in make_editor
    editor = wx.TextCtrl(self, -1, style=style)
  File "C:\Program Files\Python27\lib\site-packages\wx-2.8-msw-unicode\wx\_controls.py", line 1736, in __init__
    _controls_.TextCtrl_swiginit(self,_controls_.new_TextCtrl(*args, **kwargs))
TypeError: in method 'new_TextCtrl', expected argument 1 of type 'wxWindow *' 
```

但是，当我使用它`wx.ListCtrl`作为基类`ListReportEdit`而不是`ListReport`它完美地工作时，我并不清楚python继承是如何工作的。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T11:13:27.080

试试这个，你还没有调用父母的 init 方法（嗯，你有，但是你正在创建一个新的 ListReport 对象）

```
class ListReportEdit(ListReport, listmix.TextEditMixin):

    def __init__(self, parent=None, columns=['DEFAULT'], size=wx.DefaultSize,
                 pos=wx.DefaultPosition, style=wx.LC_REPORT|wx.LC_VRULES):
        ListReport.__init__(self,parent, columns, size, pos, style)
        listmix.TextEditMixin.__init__(self) 
```

# jquery - 在 HTML 中使用 Transitional Doctype 时，jCarousel Lite 不起作用

> ID：12362947
> 
> 赞同：0
> 
> 时间：2012-09-11T04:51:41.327
> 
> 标签：jquery, html, jcarousellite

我正在使用 jCarousel Lite 作为这个[jCarousel Lite的滑块](http://www.gmarwaha.com/jquery/jcarousellite/)

但是当我把这个

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

它停止工作。jCarousel Lite 如何与 Transitional Doctype 一起使用？请提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-01T06:08:05.103

使用以下过程进行故障排除：

*   将工作的 JCarousel HTML 页面转换为[数据 URI](https://stackoverflow.com/questions/9238890/1113772)

*   `object`使用一个元素将该数据 URL 添加到 XHTML 页面：

    ```
    <object type="text/html" data="data:text/html;charset=utf-8;,%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3Cp%3EXHTML%20is%20the%20best%3C%2Fp%3E%3C%2Fbody%3E%3C%2Fhtml%3E"></object> 
    ```

*   如果它有效，那么这是一个[标记生成问题](https://wiki.mozilla.org/Firefox:3.0_DOM_Case_Sensitivity)

*   如果不是，那么这是一个浏览器特定的问题

# php - 为什么我在使用 rand 时得到 0？我的值带有小数位

> ID：12362949
> 
> 赞同：1
> 
> 时间：2012-09-11T04:52:19.983
> 
> 标签：php

```
$value = rand(0.1, 0.3); 
```

然后输出返回 0

有什么可以解决这个问题的答案吗？

我已经尝试使用

```
$value = 0.01*rand(1, 3); 
```

我仍然得到 0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:58:17.050

函数 rand(); 只接受整数而不接受浮点数值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T04:59:57.423

## 问题

[文档](http://php.net/manual/en/function.rand.php)说明了一切：

> `rand`— 生成一个随机整数

因为您正在传递浮点数（`0.1`和`0.3`），所以它们被转换为`int`s，结果完全是这样的：

```
rand(0, 0) 
```

转换证明：http: [//ideone.com/osg97](http://ideone.com/osg97)

基于上述，唯一的结果可能是从`rand(0.1, 0.3)`是`0`（零）。要获得其他东西，请以整数为基础。

## 解决方案

解决方法很简单，用整数计算即可。如果您想要满足您需要的功能，您可以使用此代码（`$places`是您想要在积分部分之后计算的位数）：

```
function float_rand($start, $end, $places){
    $multiplier = pow(10, $places);
    return rand($start * $multiplier, $end * $multiplier) / $multiplier;
} 
```

证明：http: [//ideone.com/lfUhx](http://ideone.com/lfUhx)

# android - 磁力计转换系数

> ID：12362951
> 
> 赞同：2
> 
> 时间：2012-09-11T04:52:30.913
> 
> 标签：android, android-sensors, magnetometer

我正在研究Android ICS 中的传感器**HAL ，特别是磁力计。**

我指的是一个代码，其中 a`(+/-)CONVERT_M`与所有轴相乘。
在哪里`CONVERT_M = (1.0f/16.0f)`
根据什么数字`16.0f`到达？

我的理解是，如果磁力计驱动程序返回值`Gauss`以将其转换为`Tesla`它必须乘以`(1.0f/10000.f)`。
这是正确的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:47:57.917

> 我的理解是，如果磁力计驱动器返回高斯值以将其转换为特斯拉，则它必须乘以 (1.0f/10000.f)。

它是 10000 的因数

> => 1 Gs = 10 ^(-4) T

# php - PHPExcel 日期格式

> ID：12362953
> 
> 赞同：12
> 
> 时间：2012-09-11T04:52:52.070
> 
> 标签：php, phpexcel

我从 MS SQL 服务器获得 '2012-08-09 00:00:00' （不带引号）格式的输出。

但是，当我将其写入 excel 文件时，我无法以日期格式将其写入 dd mmm yyyy 在 excel 上的格式。

结果，我尝试以 =date(2012,08,09) 格式写入各个单元格的公式。

但我不想将其输出为公式，而是输出数据类型完整性完整的值“2012 年 8 月 9 日”。我该怎么做呢？或者有没有更简单的方法？

我通读了文档，但我不清楚，以为我会要求澄清。

问候。

* * *

抱歉不够详细。

我正在使用 PHPExcel 库。

从我的 sql 数组中，我使用以下内容：

```
$t_year    = substr($xls_column_datas["colname"],0,4);
$t_month   = substr($xls_column_datas["colname"],5,2);
$t_day     = substr($xls_column_datas["colname"],8,2);
$t_format  = $t_year . "," . $t_month . "," . $t_day ;
$t_format  = '=date('.$t_format.')';

$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($data_column_num, $data_row_num, $t_format );
$objPHPExcel->getActiveSheet()->getStyleByColumnAndRow($data_column_num, $data_row_num)->getNumberFormat()->setFormatCode('[$-C09]d mmm yyyy;@'); 
```

在我的 excel 输出中，它显示 A2 列，例如 =DATE(2012,8,9)

而不是显示为公式，我希望 excel 识别 '2012-08-09 00:00:00' 是日期时间并将其格式化为 dd mmm yyyy。

这清楚了吗？对不起。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-11T06:39:27.893

您的问题是从 MS SQL 获取日期作为日期/时间，还是设置 Excel 日期？

PHPExcel 文档中有一个完整的部分解释了使用 the`PHPExcel_Shared_Date::PHPToExcel($PHPDate)`和`PHPExcel_Shared_Date::FormattedPHPToExcel($year, $month, $day, $hours=0, $minutes=0, $seconds=0)`helper 方法将 PHP 日期转换为您设置为单元格值的 Excel 日期时间戳值，然后应用其中一个日期掩码的数字格式掩码比如`PHPExcel_Style_NumberFormat::FORMAT_DATE_YYYYMMDD2`那个细胞

代替

```
$t_year     = substr($xls_column_datas["colname"],0,4);    
$t_month    = substr($xls_column_datas["colname"],5,2);    
$t_day      = substr($xls_column_datas["colname"],8,2);
$t_format   = '=date('.$t_format.')';
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($data_column_num, $data_row_num, $t_format );
$objPHPExcel->getActiveSheet()->getStyleByColumnAndRow($data_column_num, $data_row_num)->getNumberFormat()->setFormatCode('[$-C09]d mmm yyyy;@'); 
```

尝试设置

```
$t_year   = substr($xls_column_datas["colname"],0,4);
$t_month  = substr($xls_column_datas["colname"],4,2);  // Fixed problems with offsets
$t_day    = substr($xls_column_datas["colname"],6,2);
$t_date   = PHPExcel_Shared_Date::FormattedPHPToExcel($t_year, $t_month, $t_day);
$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow(
    $data_column_num, $data_row_num, $t_date 
);
$objPHPExcel->getActiveSheet()
    ->getStyleByColumnAndRow($data_column_num, $data_row_num)
    ->getNumberFormat()->setFormatCode(
        PHPExcel_Style_NumberFormat::FORMAT_DATE_XLSX14
    ); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-30T15:34:13.717

```
$date = PHPExcel_Style_NumberFormat::toFormattedString($data, "M/D/YYYY"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-11T05:08:39.640

虽然不清楚要问什么，但如果您正在寻找日期转换

```
 // convert old date string to YYYYmmdd format
    $date = date('d M Y', strtotime($old_date)); 
```

这将以 2012 年 8 月 9 日格式输出日期

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T05:16:50.377

为什么不让服务器为你格式化呢？使用此查询格式化日期

```
SELECT convert(varchar(15), getdate(), 106) 
```

这将导致`11 Sep 2012`

**[SQL SERVER：日期格式](https://anubhavg.wordpress.com/2009/06/11/how-to-format-datetime-date-in-sql-server-2005/)**

# actionscript-3 - Actionscript : 定时文本格式 xml

> ID：12362960
> 
> 赞同：0
> 
> 时间：2012-09-11T04:53:42.507
> 
> 标签：actionscript-3, flash

我是动作脚本的新手。任何人都可以帮助我尝试从以下 XML 中获取值`timed text format`：

```
<?xml version="1.0" encoding="UTF-8"?>
<tt xml:lang="en"
    xmlns:tts="http://www.w3.org/2006/10/ttaf1#styling"
    xmlns:ttm="http://www.w3.org/2006/10/ttaf1#metadata"
    xmlns:smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"
    xmlns:m608="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt#cea608">
   <head>
      <ttm:title>SCCconvert </ttm:title>
      <ttm:desc>converted document; </ttm:desc>
      <ttm:copyright>Copyright (C) Computer Prompting and Captioning Co.</ttm:copyright>
      <styling>
      <style xml:id='basic' tts:color='white' tts:fontFamily='proportionalSansSerif' 
            tts:lineHeight='8%' 
            tts:fontSize='8%' 
            tts:fontWeight='bold'
            tts:textOutline='black 8% 8%' />
      </styling>
      <layout>
         <region xml:id='pop1' tts:backgroundColor='transparent'></region>
         <region xml:id='pop2' tts:backgroundColor='blue'></region>
       </layout>
   </head>
   <body>
      <div>
         <p region='pop1' style='basic' xml:space='preserve' begin='00:00:02:05' end='00:00:06:16' tts:origin='47% 10%'>
            <span>♫&lt;/span>
         </p>
         <p region='pop1' style='basic' xml:space='preserve' begin='00:00:06:16' end='00:00:08:05' tts:origin='27% 84%'>
            <span>I can&apos;t do this!</span>
         </p>
         <p region='pop2' style='basic' xml:space='preserve' begin='00:00:08:05' end='00:00:09:17' tts:origin='10% 78%'>
            <span>You fail because</span>
         </p>
        </div>
   </body>
</tt> 
```

如果 XML 值是正常格式，我可以读取它。但我需要以本`<layout>`节中提到的样式显示值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T07:41:04.117

这是因为您的属性以命名空间为前缀，因此您必须为 ttm、tts 等创建一个新的命名空间，然后使用它来访问该属性。

访问 layout.region 节点内所有 backgroundColor 的示例：

```
// namespace creation for tts
var tts:Namespace=new Namespace("http://www.w3.org/2006/10/ttaf1#styling");

// and use of the namespace tts for accessing the attribute
// @my_namespace::my_attribute
trace(xml..layout.region.@tts::backgroundColor.toXMLString()); 
```

Wonderfl 上的实时示例：[http ://wonderfl.net/c/ptNa](http://wonderfl.net/c/ptNa)

在 Adob​​e 频道上使用 xml 命名空间的文章：http: [//cookbooks.adobe.com/post_Accessing_XML_attributes_and_nodes_with_different-16316.html](http://cookbooks.adobe.com/post_Accessing_XML_attributes_and_nodes_with_different-16316.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T06:30:58.947

这段代码将帮助您解析 xml。

```
import flash.net.URLLoader;
import flash.events.Event;
import flash.net.URLRequest;

var loader:URLLoader = new URLLoader();
loader.addEventListener(Event.COMPLETE, onXMLLoaded);
loader.load(new URLRequest("style.xml"));

function onXMLLoaded(e:Event){
    loader.removeEventListener(Event.COMPLETE, onXMLLoaded);

    var xml:XML = new XML(loader.data);

    var xlist:XMLList = xml.head.layout.child("region");

    for(var i=0;i<xlist.length();i++){
        trace("--->"+xlist[i].attributes()[0]);
        trace("--->"+xlist[i].attributes()[1]);
    }
} 
```

# c - 访问联合的内部变量

> ID：12362963
> 
> 赞同：4
> 
> 时间：2012-09-11T04:54:03.430
> 
> 标签：c

我正在阅读 Libevent2.0 的源代码，我发现下面有一些我无法理解的代码。为什么我们可以访问成员“ev_ncalls”而不访问“_ev”和“ev_signal”？我编译了一些无法通过 gcc 的代码。这是代码：

```
struct event {
    union {
            /* used for io events */
            struct {
                    TAILQ_ENTRY(event) ev_io_next;
                    struct timeval ev_timeout;
            } ev_io;

            /* used by signal events */
            struct {
                    TAILQ_ENTRY(event) ev_signal_next;
                    short ev_ncalls;
                    /* Allows deletes in callback */
                    short *ev_pncalls;
            } ev_signal;
    } _ev;
};

struct event *ev;
int ncall = ev->ev_ncalls; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T05:05:59.353

这是因为`event-internal.h`有类似的东西：

```
#define ev_ncalls   _ev.ev_signal.ev_ncalls
#define ev_pncalls  _ev.ev_signal.ev_pncalls 
```

所以当你说`ev->ev_ncalls`编译器看到`ev->_ev.ev_signal.ev_ncalls`.

# eclipse - 适用于 Windows 的小型 Eclipse x64 发行版？

> ID：12362966
> 
> 赞同：1
> 
> 时间：2012-09-11T04:54:29.810
> 
> 标签：eclipse, performance, 64-bit, distribution, eclipse-juno

我能找到的所有官方 Eclipse 发行版都用于特定目的： http: [//www.eclipse.org/downloads/](http://www.eclipse.org/downloads/)

我目前安装了**Eclipse Juno**，并使用 PHP、PyDev、PDT、Chrome 主题、Django 模板编辑器和 JGit+EGit 运行。

**不过，这有点太强大了，IDE 运行缓慢并耗尽了我的电池。**

所以我的计划是将它们分成不同的安装——请注意，单独的工作区并不能解决上述问题。

我应该只使用 Eclipse for Testers 还是可以使用更小的 x64 发行版？- 例如：一个非官方的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T07:23:14.377

首先，Eclipse Juno 4.2以存在[性能问题](http://mmilinkov.wordpress.com/2012/09/10/juno-performance/)[而闻名](http://en.wikipedia.org/wiki/Eclipse_IDE#Releases)。这种情况正在迅速[改善](http://blog.springsource.org/2013/03/12/performance-improvements-in-sts-3-2-0/)，但在某些情况下使用 Eclipse Juno 3.8。（例如[SpringSource](http://www.springsource.org/)分发 Spring IDE（作为[STS](http://www.springsource.org/sts)发行版）构建在[两个平台上](http://www.springsource.org/downloads/sts-ggts)，[截至 2013 年 3 月推荐 3.8 版本](http://www.springsource.org/node/4247)）

有关优化，另请参阅[非常慢的 Eclipse 4.2，如何使其更具响应性？](https://stackoverflow.com/questions/11446825/very-slow-eclipse-4-2-how-to-make-it-more-responsive)

对于替代的 Eclipse 发行版，请查看[EclipseSource](https://yoxos.eclipsesource.com/)的[yoxos](http://eclipsesource.com/en/products/yoxos/)

# ubuntu - 如何恢复 /etc/nginx？

> ID：12362967
> 
> 赞同：127
> 
> 时间：2012-09-11T04:54:40.230
> 
> 标签：ubuntu, ubuntu-11.10

我错误地删除了 ubuntu 11.10 PC 中的 /etc/nginx 目录。如何恢复 /etc/nginx 中的 ngnix 目录？

我做了这些命令：

1.  `sudo su`
2.  `rm -rf /etc/nginx`

我想再次获得 /etc/nginx 目录。如何？

我试过这个重新安装nginx：

1.  `sudo apt-get update`
2.  `sudo apt-get upgrade`
3.  `sudo apt-get install nginx`

然后它给出以下

```
Reading package lists... Done

Building dependency tree   

Reading state information... Done
E: Unable to locate package nginx 
```

如何在 ubuntu 11.10 上获得完整的 nginx 软件？

* * *

## 回答 #1

> 赞同：363
> 
> 时间：2012-09-11T05:20:57.793

要重新创建它，首先使用 purge 卸载以删除甚至配置文件和记录：

```
sudo apt-get purge nginx nginx-common nginx-full 
```

然后重新安装：

```
sudo apt-get install nginx 
```

如果上述方法不适合您，您也可以尝试使用 dpkg 的 --force-confmiss 选项。

```
sudo dpkg --force-confmiss -i /var/cache/apt/archives/nginx-common_*.deb 
```

# c# - 更新和显示的型号相同吗？

> ID：12362970
> 
> 赞同：1
> 
> 时间：2012-09-11T04:54:58.750
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

拥有不同的视图模型和更新模型是最佳实践吗？更新可能包含许多下拉列表、ID、文本等。其中视图模型将真正包含文本，并且可能包含几个用于选择目的的 id。

我的问题是：我应该总是使用不同的模型视图显示屏幕和更新/插入屏幕吗？

深入研究，是否可以说很多时候，用于更新屏幕的模型与用于插入屏幕的模型不同？例如，我的数据库可能有一个名为“已创建用户”的不可为空的字段。这在插入屏幕上将是空白的 - 因此，它必须可以为空。

也许是一个愚蠢的例子，因为我猜你可以在将当前用户传递给视图之前用当前用户填充该字段，但你明白我的问题了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T04:57:03.427

> 我的问题是：我应该总是使用不同的模型视图显示屏幕和更新/插入屏幕吗？

这取决于。如果您对这些视图有不同的要求，那么您应该使用不同的视图模型。按照您的描述，情况似乎是这样：例如，在创建实体时，您通常不会在 CreateViewModel 上具有 Id 属性，而 UpdateViewModel 将具有此属性。当然，如果这对避免重复有意义，您可以在视图模型上使用继承。

# maple - 2-伪素数和输出

> ID：12362971
> 
> 赞同：2
> 
> 时间：2012-09-11T04:54:59.623
> 
> 标签：maple

如果`n`是一个大于 2 且满足`modp(2^n-1,n)=1`且`n`不是素数的正整数，则`n`称为 2-伪素数。找出所有小于 2000 的 2-伪素数，对于每个伪素数，输出伪素数及其素数除数的集合。

这是我到目前为止所尝试的。顺便说一句，这是使用枫木。

```
for n from 2 to 2000 do
    n, mod(2^n-1,n) isprime(n);
od; 
```

我不确定在这里还能做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T05:08:55.617

您需要的是使用`if...then...fi`（或更现代的`if...then...end if`.）构造的条件语句

如果满足条件，则可以打印所需的结果。

```
for n from 2 to 2000 do
    if `mod`(2^n-1,n) = 1 and not( isprime(n) ) then
        print(n, map(expand,{op(ifactor(n))}));
    fi;
od; 
```

# c - 从C中的文件打印一定数量的行

> ID：12362972
> 
> 赞同：0
> 
> 时间：2012-09-11T04:55:02.647
> 
> 标签：c, file-io

我正在尝试编写一个程序，该程序将从文本文件中打印出一定数量的行。我想我有代码可以打开文件并扫描它有多少行。我只是无法打印出这些线条。（例如，打印文件的第 1 到 10 行。）

我应该把文件的所有读取都变成一个单独的方法吗？

`numLines`是从用户输入中提前声明的。我还想从命令行参数打开 src。不确定这是否正确实施。

编辑我正在使用的完整代码

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MAX 256

int numLines = 0;
int linecount = 0;
FILE *src = NULL;
char b[MAX];
char ch;

void GetArgs (int argc, char **argv){
if(argc != 4 || argc != 2) {
    printf("Error not enough arguments to continue \n", argv[0]);
    exit(-1);

}// end if argc doenst = 4 or 2

if(argc == 2){
    src = fopen( argv[1], "r:");
    numLines=10;

}// end argc = 2

if(argc == 4){
    if (strcmp (argv[1], "-n") !=0 ){
        numLines = atoi (argv[2]);
        src = fopen (argv[3], "r");
        if ( src == NULL){
            fputs ( "Can't open input file." , stdout);
            exit (-1);
        }
        while (NULL != fgets(ch,MAX, src)){
            linecount++;
            fputs(ch, stdout);
            if (linecount == numLines){
                break;
            }
        }

    }//end of nested if
    else (strcmp (argv[2], "-n") !=0 ){
        numLines = atoi (argv[3]);
        src = fopen (argv[1], "r");
        if ( src == NULL){
            fputs ( "Can't open input file." , stdout);
            exit (-1);
        }
        while (NULL != fgets(ch,MAX, src)){
            linecount++;
            fputs(ch, stdout);
            if (linecount == numLines){
                break;
            }
        }            

    }//end of else
}//end if argc == 4

}// end GetArgs

}// end GetArgs

int main(int argc, char **argv){

GetArgs(argc, argv); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T04:57:33.410

> ```
> while ( fgetc(ch,MAX,src) !=EOF ) 
> ```

你打电话`fgetc`给`fgets`. `fgetc`只接受一个参数：a `FILE *stream`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-11T05:42:48.150

试试这个

```
FILE * src = NULL;
int linecount = 0;
int numLines = 5;
char ch[MAX];

src = fopen( argv[1], "r" );
if ( src == NULL ) {
    fputs( "Can't open input file.", stdout );
    exit(-1);
}

while(NULL != fgets(ch,MAX,src)) {
    linecount++;
    fputs(ch, stdout);

    if (linecount == numLines) {
        break;
    }
} 
```

# iphone - pdf 从网络服务到 iPhone

> ID：12362973
> 
> 赞同：-4
> 
> 时间：2012-09-11T04:55:03.693
> 
> 标签：iphone

如何从服务器下载文件？

有什么方法可以将 pdf 文件从网络服务发送到*iPhone*吗？

是否有必要将 pdf 转换为任何其他形式，然后发送它也重新转换它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:02:23.943

您可以使用以下代码轻松下载 pdf 文件

```
NSData *pdfData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:downloadUrl]];

    //Store the Data locally as PDF File

NSString *resourceDocPath = [[NSString alloc] initWithString:[[[[NSBundle mainBundle]  resourcePath] stringByDeletingLastPathComponent] stringByAppendingPathComponent:@"Documents"]];
NSString *pdf1;
pdf1 = [NSString stringWithFormat:@"%@.pdf",yourBookTitle];

NSString *filePath = [resourceDocPath stringByAppendingPathComponent:pdf1];

[pdfData writeToFile:filePath atomically:YES]; 
```

对于您的第二个问题，将您的 pdf 文件存储到服务器并获取 Url，无需以任何格式转换

# ios - 对于使用 cocos2d 的图像，从左到右移动，反之亦然

> ID：12362979
> 
> 赞同：1
> 
> 时间：2012-09-11T04:56:06.067
> 
> 标签：ios, cocos2d-iphone, cocos2d-x

如何使用弹跳创建图像，从左到右移动，反之亦然使用 cocos2d

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T07:05:24.440

您可以添加物理引擎并创建效果。如需简单教程，请访问[Ray Wenderlich 教程](http://www.raywenderlich.com/457/intro-to-box2d-with-cocos2d-tutorial-bouncing-balls)。本教程有 Box2D 物理模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T07:04:39.373

您可以使用以下链接：

[http://www.raywenderlich.com/457/intro-to-box2d-with-cocos2d-tutorial-bouncing-balls](http://www.raywenderlich.com/457/intro-to-box2d-with-cocos2d-tutorial-bouncing-balls)

# javascript - 插件初始化后动态加载元素的样式

> ID：12362981
> 
> 赞同：1
> 
> 时间：2012-09-11T04:56:11.747
> 
> 标签：javascript, jquery, plugins

我是 JavaScript 新手。我有一个在布局（母版页）中加载的脚本。此脚本用于自定义表单字段（[自定义表单元素](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)）。此[链接](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/custom-form-elements.js)到 js 文件。

我在页面上有很多块是通过 ajax 加载的。因此，我的元素有时并没有按照应有的方式设置样式。

**我的问题**：当插件在主页中加载但稍后通过ajax加载目标元素时，如何处理这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:11:24.397

如果您的样式是通过应用类和 CSS 来应用的，那么它应该适用于 ajax 加载的内容。但如果有应用它们的脚本，则不是这样。

为此，您需要分离出那部分代码，并在每次附加一些内容时在新元素上调用它。

```
$.ajax({
.
.
.

    success:function(data){
      var newElem = $(data);
      target.append(newElem );

      applyStyles(newElem);
    }

}); 
```

# jquery - asp.net datagrid 文本框中的日期时间选择器

> ID：12362982
> 
> 赞同：0
> 
> 时间：2012-09-11T04:56:21.570
> 
> 标签：jquery, asp.net, ajax, datagrid

我在 asp.net 中使用 Datagrid 我的 TextBox 在 DataGrid 内。我想通过 jQuery 或 Ajax 在数据网格中单击文本框上的 datetimepicker

请帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:01:00.260

在这里你去[jQuery UI DatePicker](http://jqueryui.com/demos/datepicker/)

```
<script>
  $(function() {
    $( ".datepicker" ).datepicker();
  });
</script>

<input class="datepicker" type="text" runat="server"> 
```

在 gridview 的项目模板中分配类

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T05:13:58.733

像这样试试

```
$(document).ready(function(){
       ("#textbox_id").datepicker({dateFormat: "yy-mm-dd hh:mm:ss"});
   }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T05:31:35.100

检查这个例子。

```
 <%@ Page Language="C#" AutoEventWireup="true" CodeFile="DataGrid.aspx.cs" Inherits="DataGrid" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/themes/base/jquery-ui.css" type="text/css" media="all" /> 
</head>
<body>
    <form id="form1" runat="server">
    <div>

    </div>
    <asp:GridView ID="gvItems" runat="server">
        <Columns>
            <asp:TemplateField HeaderText="Date">
            <ItemTemplate>
                <asp:TextBox runat="server" id="txtDate" CssClass="txtDate">
                </asp:TextBox>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".txtDate").datepicker();
    });

    </script>
    </form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T07:01:12.653

试试这个并测试它应该可以工作。

在您的代码隐藏中。

```
// Property which will hold your script
protected String Script
{
        get;
        set;
} 
```

您将绑定数据的代码隐藏。

```
Script = String.Empty;
uxGrid.DataSource = WebApplication1.DummyData.GetTempDataTable();
uxGrid.DataBind();
Script = "$(document).ready(function () { " + Script + " });";
Page.ClientScript.RegisterStartupScript(this.GetType(), "DateTimeView", Script.ToString(), true); 
```

网格项绑定事件。（代码隐藏）

```
protected void uxGrid_ItemDataBound(object sender, DataGridItemEventArgs e)
{
        TextBox txt = (TextBox)e.Item.FindControl("uxDTP");        
        if (txt != null)
        {
            Script += RegisterClientScriptDateTimeView(txt.ClientID);
        }
}

public string RegisterClientScriptDateTimeView(string controlId)
{
    StringBuilder script = new StringBuilder("");
    script.AppendFormat(" $('#{0}').datetimepicker();", controlId);
    return script.ToString();
} 
```

在您的 aspx 设计文件中：

```
<asp:DataGrid ID="uxGrid" runat="server" CellPadding="4" ForeColor="#333333" 
            GridLines="None" onitemdatabound="uxGrid_ItemDataBound" AutoGenerateColumns="false" >
            <Columns>
                <asp:TemplateColumn>
                    <ItemTemplate>
                        <asp:TextBox runat="server" ID="uxDTP" TextMode="SingleLine"></asp:TextBox>

                    </ItemTemplate>
                </asp:TemplateColumn>
            </Columns>           
        </asp:DataGrid> 
```

将此脚本包含在您的脚本管理器或 aspx 页面中：

```
<asp:ScriptManager runat="server" ID="uxScriptManager" LoadScriptsBeforeUI="true">
        <Scripts>
            <asp:ScriptReference Path="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js" />
            <asp:ScriptReference Path="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js" />
            <asp:ScriptReference Path="http://trentrichardson.com/examples/timepicker/jquery-ui-timepicker-addon.js" />
        </Scripts>
    </asp:ScriptManager> 
```

# maven - 构建期间的属性文件处理

> ID：12362984
> 
> 赞同：1
> 
> 时间：2012-09-11T04:56:42.337
> 
> 标签：maven, properties, build, maven-plugin, file-processing

我的要求如下： - 我们有四个环境（dev，uat，prod，stag） - 目前我们有 5 个属性文件（例如 log4j.properties），每个环境一个：log4j_dev.properties，log4j_uat.properties， log4j_prod.properties, log4j_stag.properties
- 以上所有文件都有大部分共同点，每个文件中只有一些 4 到 5 个属性不同。

我目前的要求是我们必须将所有属性放在一个公共文件中（例如 log4j.properties），并且特定于环境的文件将仅包含特定的 4 到 5 属性。在构建期间，这些文件应该被合并，并且应该创建一个包含所有这些属性的新文件。

我尝试[了 maven-config-processor-plugin](http://code.google.com/p/maven-config-processor-plugin/)这与 mavne 2 工作正常，但它与 maven3 不兼容。目前我们正在使用 maven3，所以我需要一些替代方法。是否有任何替代 maven config-processor 或者我需要为此编写一些新的 maven 插件。

任何建议请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:53:55.900

您是否尝试过使用 maven-resources-plugin 和资源过滤选项

这是一个例子：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <version>2.4.3</version>
    <executions>
    <execution>
        <id>copy-resources</id>
        <phase>validate</phase>
        <goals>
            <goal>copy-resources</goal>
        </goals>
        <configuration>
            <filters>
                <filter>src/main/filters/${target.filter}.properties</filter>
            </filters>
            <resources>          
                <resource>
                    <directory>src/main/resources</directory>
                    <filtering>true</filtering>
                </resource>
                <resource>
                    <directory>src/test/resources</directory>
                    <filtering>true</filtering>
                </resource>
            </resources>              
        </configuration>            
        </execution>
    </executions>
</plugin> 
```

然后你有一个目录 src/main/filters。为您的每个环境添加一个 filter_env.properties。在其中，您将要可变的密钥放入其中，如下所示

```
ys.client.service.port=8511
ys.client.service.url=http://localhost/yoda-client/service/yoda
ys.env=dev 
```

最后，在您的属性文件中，您添加变量而不是实际值。该插件将用过滤器替换值：

```
ys.client.service.port=${ys.client.service.port}
ys.client.service.url=${ys.client.service.url}
ys.environment=${ys.env} 
```

# css - 通过纯CSS单击时特定持续时间的旋转动画

> ID：12362988
> 
> 赞同：2
> 
> 时间：2012-09-11T04:57:03.037
> 
> 标签：css

我希望通过单击图像时触发的纯 CSS3 动画对 div 中存在的图像进行旋转动画。动画应该有特定的持续时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T09:32:59.783

我能想到的用于触发点击旋转的一种解决方案是使用复选框 hack 和[**关键帧动画**](https://developer.mozilla.org/en-US/docs/CSS/@keyframes)- 请参阅[**DEMO**](http://dabblet.com/gist/3697196)

使用的 HTML：

```
<div class='img-container'>
    <input type='checkbox' name='t' id='t'><label for='t'></label>
    <img src='http://imgsrc.hubblesite.org/hu/db/images/hs-1998-14-i-web.jpg'>
</div> 
```

相关CSS：

```
.img-container {
    position: relative;
    width: 400px;
    height: 295px;
}
.img-container input[type=checkbox] { display: none; }
.img-container input[type=checkbox] + label, .img-container img {
    position: absolute;
    min-width: 100%;
    height: 100%;
}
.img-container input[type=checkbox] + label {
    z-index: 2;
}
.img-container img { z-index: 1; }
.img-container input[type=checkbox] ~ img { animation: rev-rotate-img 1s; }
.img-container input[type=checkbox]:checked ~ img { animation: rotate-img 1s; }

@keyframes rotate-img { to { transform: rotate(360deg); } }
@keyframes rev-rotate-img { to { transform: rotate(-360deg); } } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-11T05:01:11.260

嗨，现在习惯了，这对你有帮助

***[链接一](http://www.the-art-of-web.com/css/css-animation/)***

***[链接二](http://www.pxleyes.com/blog/2010/05/animating-with-pure-css-and-webkit/)***

***[链接三](http://demo.marcofolio.net/3d_animation_css3/)***

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-11T05:31:05.143

您可以通过结合`@keyframes`CSS3`animation`命令来做到这一点。一个简单的方法应该如下所示：

```
-webkit-animation:
    roll-over-rotate 400ms .1s 1 ease-in-out normal forwards,
    roll-over-color 1000ms ease-out;
-moz-animation:
    roll-over-rotate 400ms .1s 1 ease-in-out normal forwards,
    roll-over-color 1000ms ease-out;

@-webkit-keyframes roll-over-rotate {
  from {
    -webkit-transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(90deg);
  }
}

@-moz-keyframes roll-over-rotate {
  from {
    -moz-transform: rotate(0deg);
  }
  to {
    -moz-transform: rotate(90deg);
  }
} 
```

首先定义 webkit 动画，然后参考定义所需 CSS3 特定效果的动画函数。

对于一个活生生的例子，你应该检查这个实验的 css 部分：[http ://www.hellopixel.net/experiments/javascript/worley-noise/worley.html](http://www.hellopixel.net/experiments/javascript/worley-noise/worley.html)

# c# - C#如何处理回调函数

> ID：12362992
> 
> 赞同：0
> 
> 时间：2012-09-11T04:57:10.730
> 
> 标签：c#, parsing, callback

```
 public User Login(User user)
    {
        User responseUser = null; ;
        parse.Users.Login<User>("hello", "99999", r =>
            {
                if (r.Success) { responseUser = r.Data; }
            });
        return responseUser;
    } 
```

为什么返回 responseUser 为 null 但 r.Data 不为 null？谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T05:01:26.597

您还没有告诉我们该`parse.Users.Login<User>`函数是如何工作的，但它似乎是异步的。这意味着它将立即返回，并且稍后调用回调。因此，您将从主函数返回 null。

您需要修改 Login 函数，以便它也可以与回调一起使用：

```
public void Login(User user, Action<User> action)
{
    User responseUser = null;
    parse.Users.Login<User>("hello", "99999", r =>
    {
        if (r.Success) 
        { 
            action(r.Data);
        }
        else
        {
            action(null);
        }
    });
} 
```

# scala - scala：如何避免try catch块中的可变性

> ID：12362994
> 
> 赞同：6
> 
> 时间：2012-09-11T04:57:16.750
> 
> 标签：scala, exception, exception-handling, immutability

我试图避免可变变量，但问题是我必须访问我需要在 try 中初始化的 val（这是一个可能失败的 db 操作），并且我需要在 finally 块中使用该 var

我尝试了几种选择：

在 try 块中声明 val

```
try {
  val resultSet = SQL(sql).resultSet
  return ColumnInfo(resultSet.getMetaData)
} catch {
  case e => throw new ColumnInfoException("Error getting metadata")
} finally {
  resultSet.close
}

error: not found: value resultSet 
```

在 try 块之外声明 val 而不初始化它

```
val resultSet: java.sql.ResultSet
try {
  resultSet = SQL(sql).resultSet
  return ColumnInfo(resultSet.getMetaData)
} catch {
  case e => throw new ColumnInfoException("Error getting metadata")
} finally {
  resultSet.close
}

error: only classes can have declared but undefined members 
```

使用 var，这似乎有效

```
var resultSet: java.sql.ResultSet = null
try {
  resultSet = SQL(sql).resultSet
  return ColumnInfo(resultSet.getMetaData)
} catch {
  case e => throw new ColumnInfoException("Error getting metadata")
} finally {
  resultSet.close
} 
```

最后嵌套 try-catch 块，这看起来很脏

```
try {
  val resultSet = SQL(sql).resultSet
  try {
    return ColumnInfo(resultSet.getMetaData)
  } catch {
    case e => throw new ColumnInfoException("Error getting metadata")
  } finally {
    resultSet.close
  }
} catch {
  case e => throw new ColumnInfoException("Error opening resultSet")
} 
```

我可以采取一些更好的方法来避免使用 vars 和嵌套 try-catch 块吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-11T06:08:42.477

```
import scala.util.control.Exception._

allCatch.either(SQL(sql).resultSet).right.flatMap{ resultSet =>
  val ans = allCatch.either(ColumnInfo(resultSet.getMetaData))
  resultSet.close
  ans
}.fold(e => throw e, identity) 
```

或者您可以跳过`fold`并将异常打包在`Left`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-08T10:05:16.607

In Scala, `try` block is [an expression](http://www.scala-lang.org/files/archive/spec/2.11/06-expressions.html#try-expressions). In your case it can evaluate to a tuple containing both `val`s:

```
val res: (java.sql.ResultSet, ColumnInfo) = try {
  val rs = SQL(sql).resultSet
  (rs, ColumnInfo(rs.getMetaData))
} catch {
  case _: Throwable => throw new Exception("Error getting metadata")
} finally {
  res._1.close
}
val columnInfo = res._2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T05:17:16.930

从这个问题[函数try & catch w/Scala](https://stackoverflow.com/questions/5149009/functional-try-catch-w-scala)

我了解了贷款模式：[https ://wiki.scala-lang.org/display/SYGN/Loan](https://wiki.scala-lang.org/display/SYGN/Loan)

Play 框架本身似乎将它与 DB.withConnection 方法一起使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-11T05:17:43.230

摆脱第一个 catch 块：

```
try {
  val resultSet = SQL(sql).resultSet
  try {
    ColumnInfo(resultSet.getMetaData)
  } finally {
    resultSet.close
  }
} catch {
  case e => throw new ColumnInfoException("Error opening resultSet")
} 
```

# android - android - 电子邮件在三星 Galaxy s 中不起作用

> ID：12362999
> 
> 赞同：0
> 
> 时间：2012-09-11T04:57:54.470
> 
> 标签：android

我想直接打开安卓默认邮件客户端。它适用于除“Samsung Galaxy S”以外的大多数设备。实际上问题是我在编码中设置了电子邮件的主题和正文，这在大多数设备中都受到了影响，但在三星 Galaxy s 中没有受到影响。这里打开了一个空的撰写邮件。我该怎么做才能让它发挥作用？

**代码**

```
btn.setOnClickListener(new OnClickListener(){

    @Override
    public void onClick(View arg0) {
            // TODO Auto-generated method stub
            Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
            emailIntent.setType("text/html");
            List<ResolveInfo> resInfo = getPackageManager().queryIntentActivities(emailIntent, 0);
            if (!resInfo.isEmpty())
            {
                for (ResolveInfo info : resInfo) 
                {
                    System.out.println("info.activityInfo.packageName:"+info.activityInfo.packageName.toLowerCase());
                    System.out.println("info.activityInfo.name:"+info.activityInfo.name.toLowerCase());
                    if (info.activityInfo.packageName.toLowerCase().contains("mail") || info.activityInfo.name.toLowerCase().contains("mail")) 
                    {
                        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "My Allergy Journal");       
                        emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, "My Allergy Journal Body");                                 
                        emailIntent.setPackage(info.activityInfo.packageName);   
                        startActivity(Intent.createChooser(emailIntent, "Email:"));   
                    }
                } 
            }

    }}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T05:37:21.070

try this code

```
 Intent email=new Intent(Intent.ACTION_SEND);
    email.putExtra(Intent.EXTRA_SUBJECT, "YOUR SUBJECT");
    email.putExtra(Intent.EXTRA_TEXT,"YOUR MESSAGE BODY");
    email.setType("message/rfc822");
    a.startActivity(Intent.createChooser(email, "Choose an Email Client :")); 
```