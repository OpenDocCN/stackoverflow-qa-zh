# StackOverflow 问答 000874000-000874999

# c# - ASP.NET Web 应用程序 - 1 页中有 5000 行代码 - 可以接受吗？

> ID：874010
> 
> 赞同：4
> 
> 时间：2009-05-17T06:25:50.480
> 
> 标签：c#, asp.net, scalability, intranet

我正在构建一个基于 ASP .NET 2.0 (C#) 的 Web 应用程序，该应用程序主要用于内部网，即在组织的局域网内使用。

关于用户界面，我需要选择两种方法。

1.  构建一个单页 Web 应用程序，其中包含大量 ASP .NET AJAX 1.0 控件（模式弹出窗口）以显示分类内容，否则这些内容将进入单独的 .aspx 页面。

2.  使用传统方法并构建多个页面。

1 页的 UI 看起来和感觉都非常酷。但是，我对它的可扩展性表示怀疑。

同意该应用程序旨在通过 LAN 使用，但由于它是一个 Web 应用程序，如果客户愿意，它可能会通过 Internet 使用。

由于 1 页 UI，单个 .aspx 页面中已经有大约 2600 行代码，而在代码隐藏 (.aspx.cs) 中还有另外 1600 行代码

这将增长到最多 10,000 行代码（.aspx 中为 10,000 行，.aspx.cs 中为 10,000 行）。所以我需要知道——对于基于 ASP .NET 的页面来说多少是太多了——对于 Intranet 和 Internet 访问来说，2600 + 1600 行代码可以吗？10,000 行代码怎么样？什么是瓶颈？这种单页方法可以吗，还是我需要退回到传统的多页方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T03:21:11.140

在我说出我想说的话之前，我想声明一下，我认为这不是一个好主意。任何 5k 或 10k 行长的类（ASP.NET）都需要重构。这里有很多评论一直说你的下载时间太长了。仅仅因为您有一个 .aspx 文件，其中嵌入了 5k 行代码或 5k 在代码隐藏文件（或两者）中，这并不意味着您的下载时间会因此而显着增加。这些代码行在服务器上编译和执行，它们不会传递给客户端。因此，代码行数与下载大小之间没有直接关系。

赛义德·易卜拉欣·哈希米

我的书：[Microsoft Build Engine 内部：使用 MSBuild 和 Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T06:38:36.127

尽管像这样一个非常臃肿的单页会增加下载时间，但维护起来绝对是一场噩梦。我同意布拉德的观点，单页方法是不对的。而且我想不出任何方法来证明单个代码隐藏中的 10k+ 行是合理的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T07:43:46.813

如果您需要在一个网页中拥有所有功能，我建议将代码移动到单独的 ascx 控件中，并将所有 ascx 组合到一个 aspx 中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T07:29:55.910

从表面上看，这对我来说听起来像是一个可怕的解决方案（我敢打赌你的 DAO 是嵌入在视图中的）但是如果不查看实际代码就不可能说出来。

并且至少您有意识寻求另一种意见和其他选择……您对可扩展性的担忧是有道理的。

仔细考虑适当地分层您的应用程序*......*在支持 WML 视图方面，您的整体解决方案将如何叠加到“适当分层”的解决方案？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T11:17:25.270

你总是应该考虑那些会试图理解你的代码以在你之后修改你的应用程序的人。无论如何，我认为一页 - 这绝对是不可接受的。没有任何“传统的多页方法”。如果您的应用程序包含不同的操作，它应该是“多页”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-18T09:35:34.843

不行，按功能或部分将内容分成不同的文件。

这是用户控件派上用场的地方。如果此页面具有业务逻辑，请将其放在 BLL 中。与 DAL 相同。

使用 DAL、BLL 和用户控件拆分所有内容后，所有内容都应该更易于维护。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T07:10:32.057

多少太多是无法回答的。不仅仅是数量，代码的质量也很重要。可以肯定地说的一件事是，如果您将大量代码放在一个页面中，那么您将在维护代码时遇到问题。例如，如果您是多个开发人员在开发应用程序，您将需要非常频繁地合并源代码控制系统中的更改，而不是执行单独文件的简单更新。

即使您将应用程序实现为单个页面，我强烈建议您将代码后面的单独行为封装到单独的类中，这些类根据页面需要创建和使用。但我会亲自设计应用程序，以便单独的行为也进入单独的页面。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T11:41:18.910

我很惊讶没有人提到 ViewState。我认为，如果您最小化 ViewState 的大小（使用 ascx 控件并动态加载它们），那么设计良好的“单页解决方案”就可以了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-17T11:53:40.037

单页上的 10k 代码太多（它可能运行良好）但是你能维护这个代码吗？我不确定任何人都可以:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-17T12:04:16.907

您的数字与“OK”相去甚远。事实上，说实话，他们是灾难性的......

首先将尽可能多的不同概念填充到用户控件中。然后创建一些有状态的解决方案，以便将用户控件动态加载到页面的区域中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-12-29T21:25:11.900

我在 .aspx 上有一些 2K 行的页面，在代码隐藏文件中有 10,000+ 行。我有许多功能在网站上的其他任何地方都没有使用，并且依赖于一些视图状态信息。在我看来，在这种情况下，我认为这是一种性能提升，而不是要求服务器在另一个页面上搜索功能等。我认为有时，你只需要做你必须做的事情，它就是这样。试着让你的代码尽可能高效。

# asp.net-mvc - 没有具有“IEnumerable”类型的键“Blah”的 ViewData 项 '

> ID：874013
> 
> 赞同：4
> 
> 时间：2009-05-17T06:31:33.647
> 
> 标签：asp.net-mvc, model-view-controller, html-helper, viewdata

此错误消息让我发疯。

我在将 Html.ListBox 和 Html.DropDownList HtmlHelpers 与 ASP.NET MVC v1.0 一起使用时得到它。填充列表工作正常 - 我可以查看它们等 - 但是当我使用传递给控制器​​的 FormCollection 在模型中创建新记录以获取所选值时，会发生此错误。根据其他几篇关于此事的帖子，我已经尝试了几种不同的配置和代码安排 - 不高兴。

希望有人能告诉我这是否是一个已知问题，以便我可以继续我的生活！如有必要，宁愿不必发布代码，但可以根据要求发布。

哦，建议的解决方法/解决方案也会很好;-)

蒂亚！

伯纳德。

* * *

好的，快速更新，我已经在下面的回复中发布了三条评论，以澄清关于我在这里做什么的详细信息。

我现在有另一个问题要分享 - 我已经尝试了 ScottGu 的替代推荐方法 - 实现 ModelView。所以，当我这样做时，它基本上是相同的场景，但我得到一个“对象引用未设置为对象的实例”。在我得到“没有带有'IEnumerable'类型的键'Blah'的ViewData项目。”的同一个地方出错。

我开始认为这可能与 EF 的工作方式有关......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T09:39:55.397

好吧，我显然是一个 EF/MVC 菜鸟……

尽管通过我实际实施适当的异常管理解决了这个问题......异常消息（当我真正开始捕获它时）是“无法定义两个对象之间的关系，因为它们附加到不同的 ObjectContext 对象。”。所以我现在对所有数据访问使用相同的 ObjectContext，事情又回到了正轨。

谢谢关心，下次我会有一个更聪明的问题——保证！

伯纳德。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T08:16:58.807

不知道你是如何编码的，人们很难确定有问题的区域。阅读此论坛主题 - 进一步向下与您有类似的错误。

[http://forums.asp.net/p/1320426/2623986.aspx](http://forums.asp.net/p/1320426/2623986.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-09T13:34:07.847

您可以在发生验证的相应 post 方法中再次绑定您的选择列表。例如，您在控制器的创建视图中有一个错误，您可以在 create post 方法中再次绑定下拉列表。

# c - 这是 C 的一个很好的 substr 吗？

> ID：874015
> 
> 赞同：1
> 
> 时间：2009-05-17T06:32:26.593
> 
> 标签：c, substring, substr

另请参阅[C 分词器](https://stackoverflow.com/questions/874161/c-tokenizer-and-it-returns-empty-too-when-fields-are-missing-yay)

* * *

这是我为 C 编写的一个快速 substr() （是的，变量初始化需要移动到函数的开头等，但你明白了）

我已经看到了许多 substr() 的“智能”实现，它们很简单，只需要一行调用 strncpy()！

它们都是错误的（strncpy 不保证空终止，因此调用可能不会产生正确的子字符串！）

这里有更好的东西吗？

把虫子带出来！

```
char* substr(const char* text, int nStartingPos, int nRun)
{
    char* emptyString = strdup(""); /* C'mon! This cannot fail */

    if(text == NULL) return emptyString;

    int textLen = strlen(text);

    --nStartingPos;

    if((nStartingPos < 0) || (nRun <= 0) || (textLen == 0) || (textLen < nStartingPos)) return emptyString;

    char* returnString = (char *)calloc((1 + nRun), sizeof(char));

    if(returnString == NULL) return emptyString;

    strncat(returnString, (nStartingPos + text), nRun);

    /* We do not need emptyString anymore from this point onwards */

    free(emptyString);
    emptyString = NULL;

    return returnString;
}

int main()
{
    const char *text = "-2--4--6-7-8-9-10-11-";

    char *p = substr(text, -1, 2);
    printf("[*]'%s' (\")\n",  ((p == NULL) ? "<NULL>" : p));
    free(p);

    p = substr(text, 1, 2);
    printf("[*]'%s' (-2)\n", ((p == NULL) ? "<NULL>" : p));
    free(p);

    p = substr(text, 3, 2);
    printf("[*]'%s' (--)\n", ((p == NULL) ? "<NULL>" : p));
    free(p);

    p = substr(text, 16, 2);
    printf("[*]'%s' (10)\n", ((p == NULL) ? "<NULL>" : p));
    free(p);

    p = substr(text, 16, 20);
    printf("[*]'%s' (10-11-)\n", ((p == NULL) ? "<NULL>" : p));
    free(p);

    p = substr(text, 100, 2);
    printf("[*]'%s' (\")\n", ((p == NULL) ? "<NULL>" : p));
    free(p);

    p = substr(text, 1, 0);
    printf("[*]'%s' (\")\n", ((p == NULL) ? "<NULL>" : p));
    free(p);

    return 0;
} 
```

> 输出 ：

```
[*]'' (")
[*]'-2' (-2)
[*]'--' (--)
[*]'10' (10)
[*]'10-11-' (10-11-)
[*]'' (")
[*]'' (") 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T10:33:52.740

对于应该是一个简单的操作，您的功能似乎非常复杂。一些问题是（并非所有这些都是错误）：

*   `strdup()`和其他内存分配功能*可能*会失败，您应该考虑到所有可能的问题。
*   仅在需要时才分配资源（在这种情况下为内存）。
*   您应该能够区分错误和有效的刺痛。目前，您不知道`malloc()`失败`substr ("xxx",1,1)`或工作是否`substr ("xxx",1,0)`会产生空字符串。
*   你不需要`calloc()`记住你无论如何都要覆盖。
*   所有无效参数都应该导致错误或被强制转换为有效参数（并且您的 API 应该记录哪些参数）。
*   释放后不需要将本地 emptyString 设置为 NULL - 它会在函数返回时丢失。
*   您不需要 usr `strncat()`- 在进行任何复制之前，您*应该*知道可用的大小和内存，以便您可以（最有可能）更快地使用`memcpy()`.
*   您使用 base-1 而不是 base-0 来进行字符串偏移违背了 C 的本质。

以下部分是我要做的（我更喜欢负值的 Python 习惯用法从字符串的末尾开始计数，但我保留了长度而不是结束位置）。

```
char *substr (const char *inpStr, int startPos, int strLen) {
    /* Cannot do anything with NULL. */

    if (inpStr == NULL) return NULL;

    /* All negative positions to go from end, and cannot
       start before start of string, force to start. */

    if (startPos < 0)
        startPos = strlen (inpStr) + startPos;
    if (startPos < 0)
        startPos = 0;

    /* Force negative lengths to zero and cannot
       start after end of string, force to end. */

    if (strLen < 0)
        strLen = 0;
    if (startPos >strlen (inpStr))
        startPos = strlen (inpStr);

    /* Adjust length if source string too short. */

    if (strLen > strlen (&inpStr[startPos]))
        strLen = strlen (&inpStr[startPos]);

    /* Get long enough string from heap, return NULL if no go. */

    if ((buff = malloc (strLen + 1)) == NULL)
        return NULL;

    /* Transfer string section and return it. */

    memcpy (buff, &(inpStr[startPos]), strLen);
    buff[strLen] = '\0';

    return buff;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T06:42:56.943

`NULL`如果输入无效而不是`malloc()`空字符串，我会说返回。这样，您可以使用`if(p)`而不是测试函数是否失败`if(*p == 0)`。

另外，我认为您的函数会泄漏内存，因为`emptyString`仅`free()`d 在一个条件中。您应该`free()`无条件地确保它，即在`return`.

至于您对`strncpy()`非 NUL 终止字符串的评论（这是真的），如果您使用`calloc()`分配字符串而不是`malloc()`，如果您分配的字节比复制的多一个字节，这不会成为问题，因为`calloc()`自动设置所有值（包括，在这种情况下，结束）到 0。

我会给你更多的注释，但我讨厌阅读 camelCase 代码。并不是说它有什么问题。

编辑：关于您的更新：

请注意，`sizeof(char)`无论您的系统如何，C 标准都定义为 1。如果您使用的计算机在一个字节中使用 9 位（上帝保佑），`sizeof(char)`它仍然是 1。这并不是说有什么问题`sizeof(char)`- 它清楚地表明了您的意图并提供了对其他类型的调用`calloc()`或`malloc()`对其他类型的调用的对称性。但`sizeof(int)`实际上很有用（`int`s 在 16 和 32 以及这些新奇的 64 位计算机上可以是不同的大小）。你懂得越多。

我还想重申，与大多数其他 C 代码的一致性是返回`NULL`错误而不是`""`. 我知道如果您将许多函数（如`strcmp()`NULL）传递给它们，它们可能会做坏事 NULL - 这是可以预料的。但是 C 标准库（和许多其他 C API）采取的方法是“检查 是调用者的责任`NULL`，而不是函数的责任，如果他/她不这样做的话。” 如果你想以另一种方式来做，那很酷，但它违背了 C 接口设计中更强大的趋势之一。

另外，我会使用`strncpy()`(or `memcpy()`) 而不是`strncat()`. 使用`strncat()`(and `strcat()`) 会掩盖您的意图 -`calloc()`当您想要做的是设置细绳。`strncat()`使它看起来像您正在添加到一个字符串，而`strcpy()`（或另一个复制例程）会使它看起来更像您的意图。以下三行在这种情况下都做同样的事情——选择你认为最好的那一行：

```
strncat(returnString, text + nStartingPos, nRun);

strncpy(returnString, text + nStartingPos, nRun);

memcpy(returnString, text + nStartingPos, nRun); 
```

另外，`strncpy()`并且`memcpy()`可能会比`strncat()`.

`text + nStartingPos`是一样的`nStartingPos + text`- 我会放第`char *`一个，因为我认为这更清楚，但无论你想把它们放在什么顺序都取决于你。此外，它们周围的括号是不必要的（但很好），因为`+`优先级高于`,`.

编辑2：三行代码不做同样的事情，但在这种情况下，它们都会产生相同的结果。谢谢你抓住我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T06:35:26.197

```
char* emptyString = strdup(""); /* C'mon! This cannot fail? */ 
```

您需要检查是否为空。请记住，它仍然必须为空字符分配 1 个字节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T06:48:48.740

strdup 可能会失败（尽管它不太可能并且不值得检查，恕我直言）。然而，它确实有另一个问题——它不是标准 C 函数。最好使用malloc。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-01T20:55:52.840

您还可以使用 memmove 函数返回从 start 到 length 的子字符串。从 paxdiablo 的解决方案改进/添加另一个解决方案：

```
 #include <stdlib.h>
    #include <stdio.h>
    #include <string.h>

    char *splitstr(char *idata, int start, int slen) {
            char ret[150];
            if(slen == NULL) {
                    slen=strlen(idata)-start;
            }
            memmove (ret,idata+start,slen);
            return ret;
    }

    /*
    Usage:
            char ostr[]="Hello World!";
            char *ores=splitstr(ostr, 0, 5);
            Outputs:
                    Hello
    */ 
```

希望能帮助到你。使用 TCC C 编译器在 Windows 7 Home Premium 上测试。

# python - Python：将文件中的单词加载到集合中

> ID：874017
> 
> 赞同：32
> 
> 时间：2009-05-17T06:33:54.860
> 
> 标签：python, text-files

我有一个包含数千个单词的简单文本文件，每个单词都在自己的行中，例如

```
aardvark
hello
piper 
```

我使用以下代码将单词加载到集合中（我需要单词列表来测试成员资格，因此 set 是我选择的数据结构）：

```
my_set = set(open('filename.txt')) 
```

上面的代码生成了一个包含以下条目的集合（每个单词后跟一个空格和换行符：

```
("aardvark \n", "hello \n", "piper \n") 
```

将文件加载到集合中但摆脱空间和 \n 的最简单方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-17T06:38:20.747

字符串的 strip() 方法从两端删除空格。

```
set(line.strip() for line in open('filename.txt')) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-17T06:41:17.603

只需加载所有文件数据并将其拆分，它将处理每行一个单词或每行多个单词，用空格分隔，而且一次加载整个文件会更快，除非您的文件以 GB 为单位

```
words =  set(open('filename.txt').read().split()) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T06:36:03.043

```
my_set = set(map(str.strip, open('filename.txt'))) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T06:40:33.580

仅删除右侧空格。

```
set(map(str.rstrip, open('filename.txt'))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T09:02:27.263

```
with open("filename.txt") as f:
    mySet = map(str.rstrip, f) 
```

如果你想在 Python 2.5 中使用它，你需要

```
from __future__ import with_statement 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T11:27:16.743

```
with open("filename.txt") as f:
    s = set([line.rstrip('\n') for line in f]) 
```

# ruby-on-rails - 从表单输入中保持分页符

> ID：874023
> 
> 赞同：0
> 
> 时间：2009-05-17T06:37:46.380
> 
> 标签：ruby-on-rails, line-breaks

在我的 Rails 应用程序中，我想保留`\n`表单中输入的内容。到目前为止我所做的是输出`simple_format()`。但问题是 simple_format 将文本包装在 <p></p> 中，如果有`\n`. 这对我的聊天室日志来说是有问题的，因为我不希望每条消息都出现在新段落中。

我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T07:21:27.083

```
text.gsub("\n",'<br/>') 
```

# java - Netbeans/Eclipse 提取 GUI 代码

> ID：874038
> 
> 赞同：1
> 
> 时间：2009-05-17T06:49:58.207
> 
> 标签：java, eclipse, emacs, netbeans

是否有一个插件可以让我在 eclipse 或 netbeans 中设计 GUI，然后提取源代码以在另一个环境中使用？

我更喜欢使用 emacs 进行开发，但使用 WYSIWYG 环境进行 gui 设计要容易得多。我正在寻找的是在 eclipse/netbeans 中设计框架，然后只提取 gui 代码，以便我可以将其导入到我的项目中？

就像[JFrameBuilder](http://www.mars3000.com/index.html)一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T07:36:39.263

在同一组文件上同时使用 Netbeans/Eclipse 和 emacs 有什么问题？

1.  使用 Netbeans 或 Eclipse 设计 GUI。
2.  关闭 Netbeans/Eclipse。
3.  打开 Emacs 并编写代码。
4.  关闭 Emacs。
5.  冲洗并重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T14:16:22.157

就我个人而言，我的经验是 Swing 中的 GUI 设计最好在没有 WYSIWYG 的情况下完成。我是在用 Delphi 开发应用程序多年后进入 Java 的，当时还没有适合 Swing 的 GUI 设计器，这让我有点震惊。

为了使手动 UI 设计/编码高效，应该使用一个非常好的布局管理器。[MigLayout](http://www.miglayout.com/)就是这样的布局管理器之一。自从我开始使用它以来，我从未回顾过所见即所得的工具——一张纸、一支铅笔、MigLayout 以及对代码的完全控制。

# c# - 连接到远程主机语法

> ID：874039
> 
> 赞同：0
> 
> 时间：2009-05-17T06:50:13.180
> 
> 标签：c#, ports, remote-connection

在 c# 中，当我使用代码时：

```
 public System.IAsyncResult BeginConnect(System.Net.EndPoint remoteEP, System.AsyncCallback callback, object state) 
```

我使用正在与之通信的远程主机的 IP 地址和端口号声明 EndPoint。在这种情况下，端口号代表我系统或远程主机上的端口？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T06:53:38.727

您连接到**远程端点**，因此该端口是**远程**机器上的端口。

# php - 在 PHP 中确定返回“匿名”客人的方法

> ID：874040
> 
> 赞同：1
> 
> 时间：2009-05-17T06:50:16.893
> 
> 标签：php

两种类型的用户访问我的网站：注册用户和访客。通过 PHP 会话、cookie 和个人登录来跟踪和保留注册用户。我觉得管理客人比较棘手，所以我几乎没有授权提供内容。

我想为用户（注册或未注册）打开编辑以保存收藏夹、购物车、投票、审核、标记、上传和评论。同时，保护其他非注册用户的数据。

有哪些选项或最佳实践可以确定来自另一个访客的唯一身份访问者，以及在允许他们做出更多贡献时要考虑的一些安全措施？我应该绕过他们的安全/限制设置来提供贡献服务，还是应该期望他们在中间会面并放宽他们的一些设置以允许 cookie 等？

**IP 地址**- IP 是一个选项，但只是临时的。对于使用不同 IP 重新连接到 Internet 的用户，它可能会发生变化，因此另一个用户最终可能会共享相同的 IP。IP 也可以是匿名的、共享的或具有误导性的。

**PHP 会话**- 会话正常（如果启用）但在关闭浏览器时丢失。

**Cookies** - 可以存储会话数据，但很容易（并且经常）从客户端禁用。

**标头数据**- 结合用户的已知详细信息可能至少对用户进行分组 - ISP、浏览器、操作系统、引用网站等。

**编辑：**我仍然无法理解所涉及的所有关键因素……我们为客人设置了一个 cookie。将一堆编辑和用户历史记录附加到该会话。如果 cookie 被删除，数据会漂浮在任何东西上，并且用户会丢失他们的数据。或者如果用户登录，则应该合并访客和用户数据......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T06:57:17.003

我认为 cookie 可能是这里的最佳选择，因为这是您 100% 确定请求是唯一的唯一方法。当然，您可以添加一个组合：如果禁用 cookie，您可以尝试其他识别选项，例如 IP 地址方法，但这可能会使它过于复杂。

正如您所说，IP 地址可能会发生变化，并且在某些组织中可能会设置一组代理服务器，这些代理服务器会使请求来自不同的 IP。当然，您可以检查 X_FORWARDED_FOR，但它们仍然可能会更改。

我认为，标题数据可能很难获得好的结果。如果您的组织拥有相同的浏览器、操作系统、IP，它将向人们展示相同的内容。即使不在同一个组织中的人也可能看起来相似（即，通常通过代理服务器获取流量的 AOL 用户，大多数人可能会使用随附提供类似标题的“AOL 浏览器”）。

在这两个选项中，IP 一个将很容易实现，但显然存在我概述的问题。我认为检查标题中的唯一数据将被证明是绝对的痛苦。

显然，正如您所说，关闭浏览器时会话会丢失，并且您似乎希望系统表现得好像他们是注册用户一样，因此 cookie 似乎是一个更明显的选择（尤其是当您希望“收藏夹”保持不变时）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T06:58:01.133

我只想参加会议。

您的用户可以更改 IP 地址（容易在 NAT 和代理后面混淆）、修改/删除 cookie（当然可能）或更改其标头（通过切换浏览器轻松实现）。

如果客人不想被识别，则没有安全的方法来识别客人。只需遵循标准：cookies/sessions。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T01:33:45.923

你应该使用会话。会话 id 存储在 cookie 中（或者对于不接受 cookie 的用户，存储在带有 PHPSID 参数的 url 中）当用户关闭浏览器时它们不会被删除，这取决于您如何设置会话/cookies 选项。您可以将会话的时间寿命设置为您想要的任何内容，所以不要为此烦恼。您还应该告诉您的用户这一点（启用 cookie）关于登录时可以合并的数据，这是您的工作，以适当的方式合并它，甚至询问用户是否应该保存该选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-31T01:02:31.577

您可以使用您可以找到的所有识别点的组合，这些识别点不太可能改变，并且可能是唯一的 - 查看[panopticlick](https://panopticlick.eff.org/about)您可以收集大量数据，例如已安装的字体和浏览器插件。您可以获取这些更独特的数据点并将它们散列给您一个 id，然后将其与不太独特的数据（如用户代理和 IP 地址）进行比较。

但老实说，这是超级复杂和偷偷摸摸的。使用 cookie/会话。如果用户不想启用 cookie，那么他们出于某种原因不希望您进行所有匿名跟踪，您应该尊重他们的决定。

# php - PHP mail() 函数不使用“发件人”地址

> ID：874044
> 
> 赞同：0
> 
> 时间：2009-05-17T06:56:05.820
> 
> 标签：php, email

```
$to = "me@mydomain.com";
$subject = "Auction Registration Confirmation";
$from = "From: donot-reply@mydomain.com";
$body = "Test Message";
if (mail($to, $subject, $body, $from)) {
    echo("<b>Message sent</b>");
    header( "Location: http://www.mydomain.com/thankyou.html" );
}  else {
    echo("<b>Message failed</b>");
} 
```

现在的问题是，当发送电子邮件时，发件人地址不是我需要的，而是服务器登录名。

关于用来自电子邮件 ID 替换服务器登录名的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T06:59:29.947

您的 PHP 代码看起来没有任何问题 - 我有非常相似的代码在做同样的工作，而且效果很好。

您的电子邮件设置可能配置错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T07:03:59.810

PHP 邮件功能依赖于在您的服务器上运行的 MTA。我敢打赌，您的 MTA 设置为强制 $from 变量为您的登录名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T17:47:41.533

你试过这个吗？它对我有用

```
<?php
$to = "email@to.com";
$subject = "subject";
$message = "message";
$from = "email@from.com";
$headers = "From: $from";
mail($to,$subject,$message,$headers);
echo "Mail Sent.";
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-04T17:50:16.667

你可以试试

```
mail($to, $subject, $body, $from, "-f $from"); 
```

这适用于某些配置，实际上取决于服务器设置。否则，按照上面的建议编辑您的 MTA 设置，或者完全跳过 mail() 并使用像 PHPmailer 这样直接连接到 SMTP 服务器的类。

# c++ - C（或 C++）的属性文件库

> ID：874052
> 
> 赞同：14
> 
> 时间：2009-05-17T07:01:10.550
> 
> 标签：c++, c, properties

标题是不言自明的：有没有人知道 C 或 C++ 的（好的）属性文件阅读器库？

编辑：具体来说，我想要一个处理 Java 中使用的 .properties 文件格式的库：[http ://en.wikipedia.org/wiki/.properties](http://en.wikipedia.org/wiki/.properties)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-23T20:39:14.693

[STLSoft](http://www.stlsoft.org/)的[1.10 alpha](https://sourceforge.net/project/showfiles.php?group_id=238860&package_id=294944)包含一个`platformstl::properties_file`类。它可用于从文件中读取：

```
using platformstl::properties_file;

properties_file  properties("stuff.properties");

properties_file::value_type  value = properties["name"]; 
```

或从记忆中：

```
properties_file  properties(
    "name0=value1\n name1 value1 \n name\\ 2 : value\\ 2  ",
    properties_file::contents);

properties_file::value_type  value0 = properties["name0"];

properties_file::value_type  value1 = properties["name1"];

properties_file::value_type  value2 = properties["name 2"]; 
```

看起来最新的 1.10 版本有一堆全面的单元测试，并且他们已经升级了这个类来处理[Java 文档](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html#load(java.io.InputStream))中给出的所有规则和示例。

唯一明显的问题是 是（在[Dobb 博士的这篇文章](http://www.ddj.com/cpp/184402064)中描述`value_type`）的一个实例，它有点类似于，但实际上并不拥有它的内存。大概他们这样做是为了避免不必要的分配，大概是出于性能原因，这是 STLSoft 设计所珍视的。但这意味着你不能只写[`stlsoft::basic_string_view`](http://www.stlsoft.org/doc-1.9/classstlsoft_1_1basic__string__view.html)`std::string`

```
std::string  value0 = properties["name0"]; 
```

但是，您可以这样做：

```
std::string  value0 = properties["name0"].c_str(); 
```

还有这个：

```
std::cout << properties["name0"]; 
```

我不确定我是否同意这个设计决定，因为从文件或内存中读取属性需要绝对最后一个周期的可能性有多大。我认为他们应该将其更改为`std::string`默认使用，然后在明确需要时使用“字符串视图”。

除此之外，该`properties_file`课程看起来可以解决问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-24T03:50:13.177

libconfuse（C 库）也很有用；它一直存在并且很灵活。

*   ( www.nongnu.org/confuse/ ) [http://www.nongnu.org/confuse/tutorial-html/index.html](http://www.nongnu.org/confuse/tutorial-html/index.html)

它远远超出了 java.util.Properties。不过，它不一定能处理 java 属性文件格式的极端情况（这似乎是您的要求）。

请参阅示例：

*   简单：www.nongnu.org/confuse/simple.conf
*   疯狂：www.nongnu.org/confuse/test.conf

不过，我知道没有 C++ 包装库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-23T06:57:19.853

Poco 还有一个读取 PropertyFiles 的实现 [http://pocoproject.org/docs/Poco.Util.PropertyFileConfiguration.html](http://pocoproject.org/docs/Poco.Util.PropertyFileConfiguration.html)

从这里复制的一个简单示例：http: [//pocoproject.org/slides/180-Configuration.pdf](http://pocoproject.org/slides/180-Configuration.pdf)

属性文件内容：

```
# a comment
! another comment
key1 = value1
key2: 123
key3.longValue = this is a very \
long value
path = c:\\test.dat 
```

代码示例

```
#include <Poco/Util/PropertyFileConfiguration.h>
using Poco::AutoPtr;
using Poco::Util::PropertyFileConfiguration;
AutoPtr<PropertyFileConfiguration> pConf;
pConf = new PropertyFileConfiguration("test.properties");
std::string key1 = pConf->getString("key1");
int value = pConf->getInt("key2");
std::string longVal = pConf->getString("key3.longValue"); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T07:50:48.387

我猜“属性文件”是指配置文件。

在这种情况下，谷歌给出（前 4 次命中`C config file library`）：

*   [http://www.hyperrealm.com/libconfig/](http://www.hyperrealm.com/libconfig/)
*   [http://rudeserver.com/config/](http://rudeserver.com/config/)
*   [http://freshmeat.net/projects/cfl/](http://freshmeat.net/projects/cfl/)
*   [http://liblcfg.carnivore.it/](http://liblcfg.carnivore.it/)

# iphone - 如何居中对齐精灵？

> ID：874056
> 
> 赞同：1
> 
> 时间：2009-05-17T07:07:11.033
> 
> 标签：iphone, cocoa-touch, cocos2d-iphone, center

在 cocos2d 中有人知道如何使精灵居中吗？现在，我有一个精灵可以移动到您在屏幕上触摸的位置。问题是精灵与左下角对齐。这意味着如果您只触摸底部一点点，精灵就会向上移动，而不是向下移动。提前致谢！

这是我的代码...

```
(BOOL) ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *) event {
    UITouch *touch = [touches anyObject];
    CGPoint point = [touch locationInView: [touch view]];

    [mainSprite do:[MoveTo actionWithDuration:0.5 position:ccp(point.x, 480 - point.y)]];

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T08:02:18.593

Cocos2D 中精灵的默认转换锚点是精灵的中心，所以它应该移动，使得精灵的中心最终到达您现在所拥有的触摸位置。你改变了精灵的变换锚点吗？

我能想到的唯一另一件事是，如果您的 mainSprite 是另一个 CocosNode 的子节点，那么您可能需要使用以下方法将触摸坐标转换为节点空间：

```
- (CGPoint)convertToNodeSpace:(CGPoint)worldPoint; 
```

...在父节点上。但是，我怀疑这是问题所在。抱歉，如果这没有帮助。

编辑： OP，如果您阅读此内容，您使用的是哪个版本的 Cocos2D？我相信 0.8（目前在 svn 主干中）改变了锚定的工作方式；以供将来参考，了解您正在使用的内容可能对其他人有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T16:10:19.723

我让它工作了！对于任何想知道这里的人都是代码......

```
[mainSprite setTransformAnchor:ccp(24.0, 64.5)]; 
```

24 是精灵宽度的一半

64.5 是精灵高度的一半

# javascript - jQuery 和 Rails

> ID：874057
> 
> 赞同：0
> 
> 时间：2009-05-17T07:08:14.510
> 
> 标签：javascript, jquery, ruby-on-rails

我正在编写一个 Rails 应用程序，需要插入一点点 jQuery 代码，但我真的不知道如何让它工作。这是我的控制器代码：

```
class ChatroomController < ApplicationController
def send_data
    @role = Role.find_by_id(session[:role_id])
    render :juggernaut do |page|

      page.insert_html :bottom, 'chat_data', "<b>#{@role.name}:</b> #{h params[:chat_input]}<br>"
    end
    render :nothing => true
  end
end 
```

并查看代码：

```
<h2>Chat</h2>
<html>
  <head>
    <%= javascript_include_tag :defaults, :juggernaut %>
    <%= juggernaut %>
  </head>
  <body>
        <div id='chat_data', class="chatbox">
        </div>
        <br>
    <%= form_remote_tag(
          :url => { :action => :send_data },
          :complete => "$('chat_input').value = ''" ) %>
      <%= text_area_tag( 'chat_input', '', { :rows => 3, :cols => 70, :id => 'chat_input'} ) %>
      <%= submit_tag "Send" %>
    </form>
  </body>
</html> 
```

现在，我需要让聊天室在任何用户发送新消息时始终向下滚动到底部。而且，当当前用户手动向上滚动时，禁用这种行为。我在这里找到了一些 jQuery 代码：[Scrolling Overflowed DIVs with JavaScript](https://stackoverflow.com/questions/13362/scrolling-overflowed-divs-with-javascript)

现在我不知道让它工作。我粘贴到 application.js 中：

```
$("#chat_data").each( function() 
{
   var scrollHeight = Math.max(this.scrollHeight, this.clientHeight);
   this.scrollTop = scrollHeight - this.clientHeight;
}); 
```

我也添加`<%= javascript_include_tag 'jquery', 'application' %>`了`head`我的观点。

但是当我的聊天室日志填满时，滚动条会出现，但不会随着新消息的出现而自动移动到底部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T08:04:10.540

问题似乎是您插入的代码仅在脚本开头运行一次。

我对 jquery 不太了解，所以这只是一个通用的解决方案。

```
function sub(data) {
  $('#chat_data').each( function () {
    var s_top = this.scrollHeight - this.clientHeight;
    var scl = this.scrollTop == s_top;
    this.innerHTML += '<br/>' + data;
    if ( scl ) this.scrollTop = s_top + this.clientHeight;
  })
}; 
```

问题是现在当您从服务器接收新数据时，您必须通过调用 sub("进入聊天窗口的文本") 将其添加到 #chat_data 中。

你必须更换

```
page.insert_html .... 
```

使用将 rjs 发送到客户端的东西，例如：

```
page.call( :sub, data) 
```

希望能帮助到你。

# iphone - 释放 NSObject 并停止所有方法调用

> ID：874059
> 
> 赞同：0
> 
> 时间：2009-05-17T07:08:35.353
> 
> 标签：iphone

所以我的菜单用这段代码调用了一个游戏：

```
game = [[Game alloc] init];
[self presentModalViewController:memoryTest animated:FALSE]; 
```

UIViewController 然后出现倒计时。倒计时期间，玩家可以返回菜单。但是，当我尝试此操作时，倒计时继续运行并最终开始游戏，即使 UIViewController 在 backToMenu 方法中已被解除（因此 UIView 已消失）。

```
[self.parentViewController dismissModalViewControllerAnimated:FALSE]; 
```

我试图在菜单的 viewDidAppear 方法中释放游戏对象，但没有运气。我想有一个“退出” BOOL 值，所以倒计时可以检查玩家是否退出游戏，但必须有更好的方法来释放对象并停止其中的所有方法调用。

谢谢你的协助。

倒计时方法：

```
- (void)countDown {

    SoundEffect *sound = [[SoundEffect alloc] initWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"tick" ofType: @"wav"]];
    [sound playAndRelease];

    if(self.countDownStep > 0) {
        feedback.image = [UIImage imageNamed:[NSString stringWithFormat:@"countdown%d.png",self.countDownStep]];
        feedback.hidden = FALSE;

        [self performSelector:@selector(countDown) withObject:nil afterDelay:0.8];
    }

    else {
        [self displayMessage:self.startMessage];
        [self.game performSelector:@selector(start) withObject:nil afterDelay:0.8];
        [self performSelector:@selector(hide) withObject:nil afterDelay:0.8];
    }

    self.countDownStep--;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T08:15:54.537

你如何处理倒计时？您似乎想在您提到的 UIViewController 的 viewWillDisappear 方法中明确取消该倒计时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T08:46:48.470

我假设你会使用类似 NSTimer 的东西。事实上，这可能仍然不是一个坏主意。NSTimer 可以处理每 0.8 秒重新运行一次倒计时方法。如果您将该值减为 0，则您的倒计时已过期。如果您的视图消失，请使 viewWillDisappear 中的计时器无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T10:29:30.863

在 viewcontroller 的 viewWillDisappear 中，检查计时器是否正在运行。如果是，则将其无效。

[timerObject invalidate] 将停止计时器

# java - JPA：我应该使用 orm.xml 清理我的实体类吗？

> ID：874064
> 
> 赞同：7
> 
> 时间：2009-05-17T07:09:57.907
> 
> 标签：java, orm, jpa

我目前只使用 JPA 注释，但我真的不喜欢我用这么多与它们的行为无关的 ORM 细节污染我的实体类（例如表名、id 生成策略、连接列...... ）。

我看到[DataNucleus 建议将与 ORM 相关的注释放在 XML 中](http://www.datanucleus.org/products/accessplatform/jpa/annotations.html)（那些以粉红色显示的注释），但我还没有看到任何其他实现建议这样做，而且 JPA 似乎没有将注释分为这两组（我认为 JDO 确实如此） .

有没有人以这种方式使用annotations+orm.xml，你的经验是什么？

它会从我的实体类中消除一些污染，还是会遇到问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T09:56:05.357

我们在半定期的基础上面临的最大问题是，如果您想以**任何**方式仅使用注释来更改持久性映射，则需要重新编译和重新部署。

使用 orm.xml 可以为您提供一定程度的抽象，这可以使重新配置更加直接，并且可以使用技术上相同的代码库来实现（例如，您确定一行代码没有潜入您正在重新编译的内容/重新部署）。

您可以同时使用注释**和**配置——这是我现在正在使用的环境——类使用功能类型持久性元数据（即外键、连接等——具有代码级别表示的事物）进行注释，而无关信息（即表/列名）存储在配置文件中。

当我们使用一种配置机制而不是另一种时，我们仍在尝试开发一些明确的启发式方法，但我们正在实现目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T03:07:16.260

JPA 实体只是 Java Bean（定义 getter 和 setter 的类），带有可选的支持代码（构造函数、hashCode、equals、命名查询、复制方法，还有什么？）即使包含所有类型的 JPA 注释，也很难被认为是污染的。

在 Java 注释和 xml 之间拆分元数据的真正目的是简化和优化部署策略。您将承担的价格是双重的：

1.  执行关于哪些元数据属于哪个地方和
2.  在创建和维护元数据时交叉引用 java 和 xml（或多或少但总是不便）。

Both are rather serious considerations when working in average to large size development team.

If recompiling for database changes presents a significant challenge in your deployment process then it sounds as a reasonable approach. But the price will be more complex development environment and process and maintenance policies.

# frameworks - 是否有任何 USB 记忆棒可运行、免安装、跨平台软件框架（带有 GUI）？

> ID：874070
> 
> 赞同：11
> 
> 时间：2009-05-17T07:14:13.437
> 
> 标签：frameworks, installation, cross-platform, portability, portable-applications

有谁知道具有以下属性的良好软件开发框架或类似框架？

*   跨平台：应该可以在 XP、Vista、OSX 和常见的 Linux 版本（如 Ubuntu 和 Kubuntu）上运行。
*   无需安装：能够从 U 盘运行软件，而无需将任何内容复制到主机。
*   有良好的 GUI 支持（这就是为什么[这个问题](https://stackoverflow.com/questions/383757/ok-programming-language-from-usb-stick-with-no-installation)没有给出合适的答案，据我所知）。
*   许可许可，例如 LGPL 或 BSD 等。

较软的要求包括为最常见的后端功能提供一组抽象，例如套接字、文件 IO 等（通常需要一些特定于平台的适应），并支持良好的语言，例如 Python 或 C++，不过学习一个新的（即不是 perl）通常很有趣。

我认为可能的候选人是 Qt 4.5 或更高版本（但如果没有任何安装，IFAIK Qt 软件将无法在 Vista 上运行（？）），一些 wxWidgets 或 wxPython 解决方案，也许是 gtkmm。我发现的示例在其中一项或多项要求上都失败了。这并不意味着不存在这样的例子，它只是意味着我没有找到任何例子。所以我想知道是否有人知道任何现有的解决方案？

一些说明；

*   “框架”是指带有小部件包的 Qt 或 gtkmm 或 python。
*   这是关于能够在多个平台上运行成品，从一根棍子，无需安装，而不是拥有一个可移植的开发环境。
*   它不是启动棒。
*   如有必要，可以专门为不同的目标构建软件。

我看到的用例是您拥有一些您依赖的软件（例如项目规划、信息管理、分析工具或类似工具）：

*   不依赖于互联网连接可用。
*   在不同的主机上运行，​​安装任何东西都不是很好。
*   由用户通过物理介质（如 U 盘）移动。
*   在不同的操作系统上运行，例如 Windows、Vista、Ubuntu、OSX。
*   在这些不同的主机上处理相同的数据（数据可以存储在主机上或存储棒上）。
*   捆绑框架的大小并没有真正受到限制（除非它是几千兆字节，这不太现实）。

只要软件行为相同并且在不同目标上运行时可以处理相同的数据，在棒上进行并行安装也是可以的。

对用例的不同看法是，我面前有五台新安装的机器，分别是 Vista、XP、OSX、Ubuntu 和 Kubuntu。我想，无需在机器上安装任何新东西，就能够在这五台机器上的每台机器上从单个 USB 记忆棒（满足上述 GUI 要求等）运行相同的软件（不过，如果有必要，从不同的捆绑在棍子上）。

这可能吗？

编辑：我对使用一些小部件和 sqlite 数据库的 Qt 应用程序进行了一些试验。很容易让它在 ubuntu dist 和 osx 上工作。对于 windows xp 和 vista，我必须将 QtCored4.dll、QtGuid4.dll、QtSqld4.dll 和 mingwm10.dll 复制到分发目录（这是调试代码），并将 qsqlited4.dll 复制到分发中名为“sqldrivers”的文件夹中目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T09:03:40.863

您提到[wxWidgets](http://www.wxwidgets.org)但将其视为未满足至少一项要求而将其驳回。

我不知道您的要求是什么以及 wxWidgets 以何种方式不适合您，但 IMO 它确实满足了它们：

> 跨平台：应该可以在 XP、Vista、OSX 和普通版本的 Linux 上运行。

它确实可以在这些平台上运行，但是“通用版本的 Linux”还不够好，因为您永远无法确定是否会安装 wxGTK 所需的 GUI 库（不应静态链接到）。然而，这对于其他解决方案也是一个问题，除非你打算把*所有东西都*放在棒上。

> 无需安装：能够从 U 盘运行软件，而无需将任何内容复制到主机。

请参阅上一点，您需要指定 Linux 上需要哪些库。您也可以在构建时指定不使用某些系统提供的库（例如用于图形、压缩、正则表达式），而是使用 wxWidgets 内部库。

> 有良好的 GUI 支持

查看。

> 许可许可，例如 LGPL 或 BSD 等。

查看。您也可以将 wxWidgets 静态链接到您的应用程序中。

> 支持良好的语言，例如 Python 或 C++

两者都支持，并且还绑定到其他语言。

> 为最常见的后端功能（例如套接字、文件 IO 等）提供一组抽象

它确实有一些类似的抽象，但您也可以链接到其他跨平台库。

我们将 wxWidgets 用于[FlameRobin](http://www.flamerobin.org)，这是 Firebird SQL 服务器的图形管理程序。它具有 Windows、Linux 和 Mac OS X 的活动端口，并且已经为至少一些 BSD 变体和 Solaris 进行了编译。它肯定是从 Windows 上的一根棍子上运行的，我没有尝试过使用 Linux 或 Mac OS X，但我不明白为什么它也不应该在那里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T10:24:54.257

# 爪哇。

*   它具有 GUI 支持。

*   它提供您的网络/文件/等。抽象。

*   它是跨平台的。您能想到的大多数平台都有可用的 JRE。

*   无需安装 JRE。大多数用户可能已经拥有一个，如果没有，您可以立即运行适当的 JRE。

*   您可以为各种平台提供多个启动脚本，以在适当的 JRE 下运行应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T11:46:38.087

其他需要考虑的是 HTML+Javascript。:D

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T08:26:57.350

你可以看看[Mono](http://www.mono-project.com)，它是跨平台的，有 GUI（GTK+ 或 Winforms 2.0），我可以在不安装的情况下执行代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T07:48:01.327

这可能不是跨平台的，但可能更好，它甚至不使用平台：linux on a stick :-)

副标题是

> 使用 USB 密钥将您的 Java 工作区带到任何地方

这里有 java 和 eclipse，但当然没有什么能阻止你。

[http://knol.google.com/k/inderjeet-singh/installing-a-ubuntu-hardy-heron-java/1j9pj7d01g86i/2#](http://knol.google.com/k/inderjeet-singh/installing-a-ubuntu-hardy-heron-java/1j9pj7d01g86i/2#)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T16:26:01.107

[我在这个链接http://www.24hsoftware.com/DevelopersForum/CrossPlatform-C-Library.html](http://www.24hsoftware.com/DevelopersForum/CrossPlatform-C-Library.html)中问了一个类似的问题， 最好的答案似乎是 QT。

我已经开始使用 QT，但它并不像我预期的那么容易，主要是由于 DLL 地狱、Winsxs 地狱和清单地狱造成的部署问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T07:34:11.937

好吧，这取决于您所说的“包装”是什么意思。Kylix 几乎是这样的人。它是基于 QT 的，它允许您编写一次并针对 Windows + Linux 进行编译。但是，它不是一个开源解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-25T22:54:52.617

[Tclkit](http://wiki.tcl.tk/52)是一个单文件、自包含的 Tcl/Tk 系统。我拥有的 mac 版本约为 3.8 兆。您可以获得几乎适用于任何现代操作系统的版本。我随身携带一个带有 mac、windows 和 linux 二进制文件的拇指驱动器，这样我就可以在任何平台上运行我的脚本。无需安装，只需将一个文件复制到任何你想要的地方。

最新版本的 tcklit 使用原生的主题小部件（尽管，在 *nix 上确实没有单一的“原生”小部件集......）

# java - Java中的Crystal Report DB身份验证

> ID：874073
> 
> 赞同：2
> 
> 时间：2009-05-17T07:18:21.600
> 
> 标签：java, jdbc, crystal-reports, login

我在使用 Eclipse 的 Crystal Report 中遇到问题。

我正在使用 servlet 通过将查看器对象写入响应来呈现水晶报表查看器，例如：

```
public class ReportViewer extends HttpServlet {

    @SuppressWarnings("deprecation")
    public void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
        try {
            String reportName = "WEB-INF/includes/reports/"+request.getParameter("ReportName");
            ReportClientDocument clientDoc = (ReportClientDocument) request.getSession().getAttribute(reportName);

            if (clientDoc == null) {
                // Report can be opened from the relative location specified in the CRConfig.xml, or the report location
                // tag can be removed to open the reports as Java resources or using an absolute path
                // (absolute path not recommended for Web applications).

             clientDoc = new ReportClientDocument();

                // Open report
                clientDoc.open(reportName, OpenReportOptions._discardSavedData);
                // Store the report document in session
                ConnectionInfo info = new ConnectionInfo();
                info.setUserName("sa");
                info.setPassword("sa");
                Tables t =  clientDoc.getDatabaseController().getDatabase().getTables();
                for (com.crystaldecisions.sdk.occa.report.data.ITable table : t) {
                    IConnectionInfo Ic = table.getConnectionInfo();
                    Ic.setPassword("sa");
                    Ic.setUserName("sa");
                    table.setConnectionInfo(Ic);                    
                }
                request.getSession().setAttribute(reportName, clientDoc);

            }

                    // Create the CrystalReportViewer object
                    CrystalReportViewer crystalReportPageViewer = new CrystalReportViewer();

                    //  set the reportsource property of the viewer
                    IReportSource reportSource = clientDoc.getReportSource();               
                    crystalReportPageViewer.setReportSource(reportSource);

                    // set viewer attributes
                    crystalReportPageViewer.setOwnPage(true);
                    crystalReportPageViewer.setOwnForm(true);

                    // Apply the viewer preference attributes

                    // Process the report
                    crystalReportPageViewer.processHttpRequest(request, response, request.getSession(false).getServletContext(), null); 

        } catch (ReportSDKExceptionBase e) {
            System.out.println(e);
        } 
    }
    public void doPost(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException {
        doGet(request, response);
    }
} 
```

当我试图请求这个 servlet 时，它会将我重定向到 jdbc 登录页面，然后它会返回到这个 servlet。我需要通过在某处硬编码来避免 jdbc 登录步骤。请帮助我，每条评论将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-06T11:08:57.947

[您是否在https://wiki.sdn.sap.com/wiki/display/BOBJ/Crystal%20Reports%20Java%20%20SDK%20Samples](https://wiki.sdn.sap.com/wiki/display/BOBJ/Crystal%20Reports%20Java%20%20SDK%20Samples)上查看过 wiki

您可以使用一个 JSP 示例：

```
 <%@ page import="com.crystaldecisions.sdk.occa.report.application.OpenReportOptions,
                 com.crystaldecisions.sdk.occa.report.application.ReportClientDocument,
                 com.crystaldecisions.sdk.occa.report.exportoptions.ReportExportFormat,
                 java.io.ByteArrayInputStream,
                 java.util.Calendar"
%><%
String reportPath;
String db_username;
String db_password;
ReportClientDocument reportClientDocument;
ByteArrayInputStream byteArrayInputStream;
byte[] byteArray;
int bytesRead;

reportPath  = request.getParameter("report_path");
db_username = request.getParameter("db_username");
db_password = request.getParameter("db_password");

/*
 * Instantiate ReportClientDocument and specify the Java Print Engine as the report processor.
 * Open a rpt file.
 */

reportClientDocument = new ReportClientDocument();
reportClientDocument.setReportAppServer(ReportClientDocument.inprocConnectionString);
reportClientDocument.open(reportPath, OpenReportOptions._openAsReadOnly);

/*
 * Set the database logon for all connections in main report.
 */

reportClientDocument.getDatabaseController().logon(db_username, db_password);

/*
 * Retrieve PDF format of report and stream out to web browser.
 */

byteArrayInputStream = (ByteArrayInputStream) reportClientDocument
        .getPrintOutputController().export(ReportExportFormat.PDF);

response.reset();

response.setHeader("Content-disposition", "inline;filename=crreport.pdf");
response.setContentType("application/pdf");

byteArray = new byte[1024];
while((bytesRead = byteArrayInputStream.read(byteArray)) != -1) {
    response.getOutputStream().write(byteArray, 0, bytesRead);  
}

response.getOutputStream().flush();
response.getOutputStream().close();

reportClientDocument.close();

%> 
```

# c# - 更快的枚举：利用数组枚举

> ID：874079
> 
> 赞同：4
> 
> 时间：2009-05-17T07:22:52.150
> 
> 标签：c#, arrays, performance, ienumerable

所以，我有一个里面有一个数组的类。目前，我枚举类项目的策略是使用代码`foreach (item x in classInstance.InsideArray)`. 我更愿意使用`foreach (item x in classInstance)`并将数组设为私有。我主要担心的是我真的需要避免任何缓慢的事情。数组受到很多打击（并且有几百个项目）。枚举这个数组很便宜是至关重要的。一个想法是让类实现`IEnumerable<item>`，但`InsideArray.getEnumerator()`只给我一个非泛型枚举器。我也尝试实现`IEnumerable`接口。这很有效，但速度很慢，可能是因为拳击。

有没有办法让类本身可枚举而不会影响性能？

普通代码：

```
//Class
public class Foo {
    //Stuff
    public Item[,] InsideArray {get; private set;}
}

//Iteration.  Shows up all over the place
foreach (Item x in classInstance.InsideArray)
{
    //doStuff
} 
```

调整后的慢得多的代码：

```
//Class
public class Foo : IEnumerable {
    //Stuff
    private Item[,] InsideArray;
    System.Collections.IEnumerator System.Collections.IEnumerable GetEnumerator()
    {
        return InsideArray.GetEnumerator();
    }
}

//Iteration.  Shows up all over the place
foreach (Item x in classInstance)
{
    //doStuff
} 
```

注意：为非泛型迭代器添加一个实现是可能的，并且比我的慢速解决方案更快，但它仍然比直接使用数组差一些。我希望有一种方法可以以某种方式告诉 C#，“嘿，当我要求你迭代这个对象时，迭代它的数组，同样快，”但显然这不太可能......至少从建议的答案来看迄今。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T09:41:48.917

定制的迭代器可能会使其更快（**编辑**为返回已知类型）：

```
Basic: 2468ms - -2049509440
Bespoke: 1087ms - -2049509440 
```

（您可以将 ArrayIterator 直接用作 Foo 的 GetEnumerator - 本质上是从 ArrayEnumerator.GetEnumerator 复制代码；我的意思是表明类型化迭代器比接口更快）

带代码：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Diagnostics;

class Foo
{
    public struct ArrayIterator<T> : IEnumerator<T>
    {
        private int x, y;
        private readonly int width, height;
        private T[,] data;
        public ArrayIterator(T[,] data)
        {
            this.data = data;
            this.width = data.GetLength(0);
            this.height = data.GetLength(1);
            x = y = 0;
        }
        public void Dispose() { data = null; }
        public bool MoveNext()
        {
            if (++x >= width)
            {
                x = 0;
                y++;
            }
            return y < height;
        }
        public void Reset() { x = y = 0; }
        public T Current { get { return data[x, y]; } }
        object IEnumerator.Current { get { return data[x, y]; } }
    }
    public sealed class ArrayEnumerator<T> : IEnumerable<T>
    {
        private readonly T[,] arr;
        public ArrayEnumerator(T[,] arr) { this.arr = arr; }

        public ArrayIterator<T> GetEnumerator()
        {
            return new ArrayIterator<T>(arr);
        }

        System.Collections.Generic.IEnumerator<T> System.Collections.Generic.IEnumerable<T>.GetEnumerator()
        {
            return GetEnumerator();
        }
        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
        {
            return GetEnumerator();
        }

    }
    public int[,] data;

    public IEnumerable<int> Basic()
    {
        foreach (int i in data) yield return i;
    }
    public ArrayEnumerator<int> Bespoke()
    {
        return new ArrayEnumerator<int>(data);
    }
    public Foo()
    {
        data = new int[500, 500];
        for (int x = 0; x < 500; x++)
            for (int y = 0; y < 500; y++)
            {
                data[x, y] = x + y;
            }
    }
    static void Main()
    {
        Test(1); // for JIT
        Test(500); // for real
        Console.ReadKey(); // pause
    }
    static void Test(int count)
    {
        Foo foo = new Foo();
        int chk;
        Stopwatch watch = Stopwatch.StartNew();
        chk = 0;
        for (int i = 0; i < count; i++)
        {
            foreach (int j in foo.Basic())
            {
                chk += j;
            }
        }
        watch.Stop();
        Console.WriteLine("Basic: " + watch.ElapsedMilliseconds + "ms - " + chk);

        watch = Stopwatch.StartNew();
        chk = 0;
        for (int i = 0; i < count; i++)
        {
            foreach (int j in foo.Bespoke())
            {
                chk += j;
            }
        }
        watch.Stop();
        Console.WriteLine("Bespoke: " + watch.ElapsedMilliseconds + "ms - " + chk);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T07:30:39.293

`IEnumerable<item>`在调用之前将您的数组转换为`GetEnumerator()`，您将获得通用的`IEnumerator`. 例如：

```
string[] names = { "Jon", "Marc" };
IEnumerator<string> enumerable = ((IEnumerable<string>)names).GetEnumerator(); 
```

它可能仍然比直接枚举数组要慢一些`foreach`（C# 编译器以不同的方式执行此操作），但至少您不会有任何其他问题。

编辑：

好的，您说您的其他尝试使用了索引器。您可以*尝试*这种方法，尽管我认为它不会更快：

```
public IEnumerable<Item> Items
{
    get
    {
        foreach (Item x in items)
        {
            yield return x;
        }
    }
} 
```

另一种方法是尽量避免使用二维数组。这是绝对要求吗？创建单个数组后，您多久对其进行一次迭代？可能值得在创建时稍作打击以降低迭代成本。

编辑：另一个建议，这有点离题了......而不是将迭代器传递回调用者，为什么不让调用者说如何使用委托来处理每个项目？

```
public void ForEachItem(Action action)
{
    foreach (Item item in items)
    {
        action(item);
    }
} 
```

缺点：

*   您每次访问都会受到委托调用的惩罚。
*   很难跳出循环（除了抛出异常）。有不同的方法可以解决这个问题，但是当我们遇到它时，让我们跨过那座桥。
*   不熟悉委托的开发人员可能会感到有些困惑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T07:30:22.413

如何在类中添加索引器：

```
public MyInsideArrayType this[int index]
{
   get{return this.insideArray[index];
} 
```

如果您真的需要 foreach 功能：

```
public IEnumerable<MyInsideArrayType> GetEnumerator()
{
   for(int i = 0; i<this.insideArray.Count;i++)
   {
      yield return this[i];
   }
} 
```

* * *

## 回答 #4

> 赞同：-8
> 
> 时间：2009-05-17T07:33:01.037

所有形式的迭代都很便宜。如果这个时代的任何人设法以某种方式编写和发布了一个昂贵的迭代器，他们将（正确地）被烧死。

过早的优化是邪恶的。

干杯。基思。

# sql - 仅显示 SQL 查询的前 N 行输出

> ID：874082
> 
> 赞同：22
> 
> 时间：2009-05-17T07:28:24.243
> 
> 标签：sql

有没有办法只显示`SQL`查询的前 N ​​行输出？
奖励积分，如果查询在输出行后停止运行`N`。

我最感兴趣的是找到适用于`Oracle`.

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-17T07:34:37.880

如果您指定要定位的数据库，将会很有帮助。不同的数据库有不同的语法和技术来实现这一点：

例如，在 Oracle 中，您可以通过设置条件来实现这一点`RowNum`（`select ... from ... where ... rownum < 11`-> 将导致输出前 10 条记录）

在`MySQL`你可以使用你可以使用`limit`子句。

**微软 SQL 服务器 =>** `SELECT TOP 10 column FROM table`

**PostgreSQL 和 MySQL =>** `SELECT column FROM table LIMIT 10`

**Oracle =>** `select * from (SELECT column FROM table ) WHERE ROWNUM <= 10`（感谢 stili）

**赛贝斯 =>** `SET rowcount 10 SELECT column FROM table`

**火鸟 =>** `SELECT FIRST 10 column FROM table`

注意：`ORM`Hibernate 等现代工具提供高级 API（查询、限制、条件接口），可根据您选择的方言抽象前 n 行的逻辑。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-17T10:11:23.433

对于 Oracle，建议和接受的解决方案是错误的。尝试使用 order 子句，结果将是不可预测的。SQL 将需要嵌套以在 Oracle 中完成此操作。

```
select name, price
  from (
    select name, price, row_number() over (order by price) r
      from items
  )
where r between 1 and 5; 
```

[上面的例子是从http://www.adp-gmbh.ch/ora/sql/examples/first_rows.html](http://www.adp-gmbh.ch/ora/sql/examples/first_rows.html)借来的，它对这个话题有很好的讨论。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-17T07:30:38.233

我知道 MySQL，但我不知道它是否是标准 SQL：以'limit X'结束查询，X = n。您想要获得的行数。

例子 ：

`SELECT NAME FROM EMPLOYEES ORDER BY SALARY DESC LIMIT 10;`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-03-30T19:32:35.323

对于 Oracle，你可以试试这个

```
select /*+ FIRST_ROWS(10) */ * from table; 
```

# .net - 每秒能够处理 40,000 条消息的系统的模式和技术

> ID：874093
> 
> 赞同：3
> 
> 时间：2009-05-17T07:35:17.287
> 
> 标签：.net, hardware, design-patterns, failover, high-load

我们需要构建一个每秒能够处理 40,000 条消息的系统。在任何软件或硬件故障的情况下都不会丢失任何消息。

每条消息大小约为 2-4Kb。

消息的处理包括验证消息、进行一些简单的算术计算、将结果保存到数据库以及（有时）向其他系统发送通知。

优选的软件技术是.Net。

哪些软件和硬件模式最适合此类任务？

它需要多少硬件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T07:46:24.390

1.  消息队列。您的流程听起来像是它的主要目标。
2.  集群/负载平衡。
3.  简化您的代码

我要做的第一件事是排队通知。然后我将所有不需要返回值的数据库写入排队。然后我会考虑扩大规模。

其他注意事项： * 避免使用比您可能需要的幕后工作更多的大而笨重的框架。* 尽可能使用缓存和静态变量。

每秒 40,000 条消息是可行的，但是当您将 IO 添加到混合中时，即使在具有大量内存的超快速硬件上也可能无法预测。尽可能多地进行带外处理。如果失败，请查看您是否可以运行多个线程（在多核或多进程机器上）并在需要时查看集群中的多个服务器。

编辑：

在这样的场景中，我怎么强调负载测试的好处都不为过。做一个简单的原型和负载测试。完善原型，直到获得所需的结果。然后基于原型构建最终解决方案。在您测试所需的性能水平之前，您只能猜测解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T07:55:19.967

4k * 40.000/s = 160MB/s 是相当多的带宽。

您可能需要在两个方向上都有该带宽，因为不丢失消息的要求意味着所有通信方都可以双向发送和接收。

将该数字除以网卡的平均吞吐量或硬盘的写入速度，可以发现这将是一个高度并行和冗余的系统。

您还需要对您的数据库操作和每条消息的计算进行基准测试，乘以 40.000（或一天 35 亿），以估算所需的硬件。

我想 .Net 要求将是您遇到的最少的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T07:43:20.323

我要做的第一件事是尝试找出您的要求的确切含义。“在任何软件或硬件故障的情况下不会丢失任何消息”是不可能的。假设您将消息写入 5000 个不同位置的 5000 个不同磁盘。如果*所有*这些磁盘同时发生故障，您将不可避免地丢失数据。

同样，如果您在某处*确实*存在错误，则可能会丢失数据。能够设计一个解决方案，在系统中的任何地方遇到错误时总是能正常工作的想法是不可能的。

一旦您确定了您真正需要的冗余和可靠性级别，帮助您将更加可行。您也更容易确信自己已经达到了该级别的可靠性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T08:25:03.267

如果您使用 Microsoft 堆栈，则几乎可以肯定需要使用 MSMQ（Microsoft 消息队列）。它有很多选项可以配置以提高可靠性或性能。查看[MSMQ 常见问题解答](http://www.microsoft.com/windowsserver2003/techinfo/overview/msmqfaq.mspx)。

瓶颈不是处理，而是磁盘 I/O。拥有大量 RAM 并尽可能多地在内存中执行操作。

MSMQ 在内存中管理其队列，但如果硬件出现故障，内存中的所有内容都会丢失。如果您将消息标记为可恢复，它们会被写入磁盘，但您很容易遇到瓶颈。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T13:06:44.477

如果您使用 MSMQ 并将消息标记为可恢复，请非常小心可靠地将消息从队列中取出。尽可能使该过程具有故障安全性，因为如果出现问题，消息会堆积得如此之快，以至于驱动器将在几分之一秒内填满并导致系统崩溃。然后所有传入的消息都将丢失。问我怎么知道的。（不是我创造的，我只是支持它。不好玩。）

我从来没有弄清楚如何告诉 MSMQ 将消息持久保存到 C: 以外的驱动器，但这将是必要的。至少这样系统就能告诉你有问题。

如上所述，磁盘和数据库将成为瓶颈。我认为 MSMQ 可以处理该量，特别是如果您避免触发器等。

IBM 的 MQ 可能更适合这项任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T09:06:09.890

我的建议是雇用已经建立了类似系统的人。让他们选择架构和开发工具。处理如此高的交易率将需要专业的硬件和软件知识，而获得此类知识的最便宜的方法是为此付费。

# jquery - 如何根据带有 jquery 的收音机更改某些文本输入的标题？

> ID：874096
> 
> 赞同：1
> 
> 时间：2009-05-17T07:37:18.373
> 
> 标签：jquery, radio-button, title, textinput

正如您在[http://jsbin.com/erivi/](http://jsbin.com/erivi/)上看到的那样，我正在使用 Jquery 来更改某些图像（和图像属性），具体取决于所选的单选按钮，当单击其中的表单文本时，我也会删除表单文本。

现在我要做的是根据选中的单选按钮更改表单的文本。

例如，当点击“Choice 3”时，我们应该看到“Text of input 3”。

您可以在此处实时查看和编辑我的代码：http: [//jsbin.com/erivi/edit](http://jsbin.com/erivi/edit)

我需要改进的部分是：

```
 imgFldr = 'http://download.kde.org/khotnewstuff/icons/previews/'; 
$("input[type='radio']").click(function() { 
   var strarr = this.title.split('|'); 
   if(strarr.length < 2) return; 
   $('#'+this.name).attr('src', imgFldr+strarr[0]).attr('alt', strarr[1]).attr('title', starr[2]); 
}); 
```

特别`.attr('title', starr[2]);`是应该根据我的广播标题的第三部分更改标题（例如`title='m602-1.png|Logo 3|Text of input 3'`：）

谢谢 ：）

编辑：我忘了提到我在我的真实代码中使用了几种形式，这就是为什么我正在寻找一种方法来做到这一点，而不需要文本输入的特定名称，以避免重复其他文本输入的脚本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T00:46:45.067

**编辑：**输入文本框的 id 必须是唯一的。此外，您需要在单选按钮的单击事件中设置`.attr('title',strarr[2])`,和提示类。`.val(strarr[2])`还需要对您的`inputdynvalue`插件进行一些更改。

请在[http://jsbin.com/akawo查看完整更新的工作代码](http://jsbin.com/akawo)

**更新的插件代码**

```
(function($) { 
    $.fn.inputdynvalue = function (options) { 
        var opts = $.extend({}, $.fn.inputdynvalue.defaults, options); 
        return this.each(function(){ 
            var hvalue = opts.htext; 
            switch (opts.htext) { 
                case 'title' : hvalue = $(this).attr('title'); break; 
                case 'value' : hvalue = $(this).attr('value'); break; 
            } 
            $(this).attr('value', hvalue).addClass(opts.hclass) 
            .unbind('focus blur') 
            .bind('focus', function() {                       
                if (this.value === this.title) { 
                    this.value = ''; 
                    $(this).removeClass(opts.hclass); 
                } 
            }) 
            .bind('blur', function() { 
                if (this.value === '') { 
                    this.value = this.title; 
                    $(this).addClass(opts.hclass); 
                } 
            }); 
        }); 
    }; 
    $.fn.inputdynvalue.defaults = { 
        htext: 'title', 
        hclass: 'hint' 
    }; 
})(jQuery); 
$(document).ready(function(){ 
    $("input[type='text']").inputdynvalue(); 
}); 
```

**更新了单选按钮单击事件处理程序**

```
$("input[type='radio']").click(function() { 
   var strarr = this.title.split('|'); 
   if(strarr.length < 2) return; 
   $('#'+this.name).attr('src', imgFldr+strarr[0]).attr('alt', strarr[1]); 
   $('#'+this.name+'_text')
      .attr('title',strarr[2])
      .val(strarr[2])
      .addClass('hint'); 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T07:46:32.483

试试这个：

```
<form method="post" action="">
    <div>
        <img id="iymok" src="http://download.kde.org/khotnewstuff/icons/previews/m732-1.png" alt="Alt by default" />
        <input type="text" id="iymok_text" title="Blablabla Text 1" />
        <label><input type="radio" checked="checked" name="iymok" title="m133-1.png|Logo 1|Blablabla Text 1" />Choice 1</label>
        <label><input type="radio" name="iymok" title='m203-1.png|Logo 2|Text of input 2' />Choice 2</label>
        <label><input type="radio" name="iymok" title='m602-1.png|Logo 3|Text of input 3' />Choice 3</label>
    </div>
</form>
<script type="text/javascript">
    imgFldr = 'http://download.kde.org/khotnewstuff/icons/previews/';
    $("input[type='radio']").click(function() {
        var strarr = this.title.split('|');
        if (strarr.length >= 3) {
               $('#'+this.name).attr('src', imgFldr+strarr[0]).attr('alt', strarr[1]).attr('title', strarr[2]);
               $('#'+this.name+'_text').attr('title', strarr[2]);
        }
    });
</script> 
```

# html - html标签关闭前：如何通知里面的Flex app？

> ID：874105
> 
> 赞同：1
> 
> 时间：2009-05-17T07:44:31.617
> 
> 标签：html, apache-flex

在Firefox（或IE或其他）中，当Tab关闭时，我记得您可以通知这一点，我想通知我的Flex应用程序并告诉它要关闭（只要它可能）打开的所有连接内容.

有人知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T09:44:54.997

您必须从浏览器监听 onbeforeunload 事件。

有关更多详细信息，请参见此处：http: [//seanmonahan.org/2009/03/19/preventing-users-from-accidently-navigating-away-from-your-flex-app/](http://seanmonahan.org/2009/03/19/preventing-users-from-accidently-navigating-away-from-your-flex-app/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T08:00:27.397

通常，您无法控制选项卡何时关闭以及 flash/flex 应用程序何时被销毁。因此，您不应尝试对此类事件采取任何操作，因为它们可能很容易被抢占，并且您的去初始化逻辑会被打乱。

在您的情况下（关闭连接），您应该注意所有连接都会在 Flash Player 销毁应用程序时自动关闭。

* * *

**编辑：实际上在***某些*情况下有一种方法可以捕获页面卸载事件（请参阅其他答案）。但是不能保证这些方法总是有效（即它们可能无法在浏览器应用程序关闭时工作），因此您仍然不应该完全依赖它们。

# html - 有表单提交模式吗？

> ID：874107
> 
> 赞同：1
> 
> 时间：2009-05-17T07:45:08.870
> 
> 标签：html, forms, crud

在 PHP 中，是否有人们用来提交表单的模式？表单提交最佳实践..等。

例如，我正在尝试实现一个 CRUD 操作。最初我一直在使用相同的函数来处理表单显示和表单提交

```
class Somecontroller extends Controller {

  function form1_add() {
    // if submit exist save it in database
    // else
    // display the form
  }

  function form1_edit() {
    // if submit exist save it in database
    // else
    // display the same form
  }
} 
```

我不喜欢..关于这种做法的是，登录以检查是否有提交或是否是全新的表单具有相同的功能。

我曾想过制作两个不同的功能

```
form1_add() and form1_add_submit() 
```

来处理这些操作。但是会出现其他问题，例如，在验证不成功时，我必须再次调用`form1_add()`from`form1_add_submit()`以显示这些验证错误。

人们对这种操作还使用了哪些其他做法？这些有什么特定的模式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T08:34:03.947

与任何编程一样，一般原则是尽可能保持函数的原子性。在一个函数中执行多个任务只会让你的工作更难，也更难调试。从其他函数调用函数是一个非常好的主意，并且至少会使您的代码更易于理解。

就具体示例而言，我总是将显示和表单提交/验证彼此分开，因为它们是完全不同的功能。如果你想要“漂亮”的验证，也许可以考虑在表单本身上使用 JavaScript，然后在表单上方显示一个 PHP 的“错误”列表，如果表单提交仍然不符合输入（允许用户更正它们）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T09:28:02.693

我不知道有任何“最佳实践”或“标准方法”。

就个人而言，我使用外部函数来处理这个问题。
如果用户提交了，那么我调用 userSubmited()，依此类推。我还将它们分成单独的文件，这样我就可以保持表单更清晰（只是标题等）。

此外，最好将表单处理部分保存在一个文件中，将 UI 显示部分保存在另一个文件中，以保持更清晰。

# xml - 在 ASP.NET MVC 中自动绑定“XElement”属性

> ID：874118
> 
> 赞同：1
> 
> 时间：2009-05-17T08:02:54.363
> 
> 标签：xml, asp.net-mvc, xelement

我有一个“编辑”操作和一个“编辑”视图，允许用户更新数据库中的某个实体。

它的数据库类型是“XML”，DataContext（我使用的是 Linq-to-SQL）将它表示为“XElement”类型的属性。

在我看来，我从属性的“ToString()”输出中渲染一个文本区域，如下所示：

```
<%= Html.TextArea("Text", Model.Text.ToString()) %> 
```

从对象中提取数据时这很好用，但是当我尝试将新数据发回时，它会返回为空白。

我认为这是因为自动绑定器不知道如何处理 XElement 类型的属性。

有没有办法解决这个问题，或者以某种方式自定义自动绑定器的行为，以便正确反序列化传入的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T08:19:44.527

您可以为此编写一个自定义绑定器来实现该[`IModelBinder`](http://msdn.microsoft.com/en-us/library/system.web.mvc.imodelbinder.aspx)接口。您可以在方法本身上注册此活页夹：

```
public ActionResult Edit([ModelBinder(typeof(XElementBinder))] XElement element)
{ ... } 
```

`XElement`或通过在您的应用程序中注册您的活页夹来全局为所有的`Global.asax`：

```
ModelBinders.Binders[typeof(IPrincipal)] = new PrincipalModelBinder(); 
```

您的自定义活页夹看起来像这样：

```
public class XElementModelBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext,
                            ModelBindingContext bindingContext)
    {
        string text = controllerContext.HttpContext.Request.Form["Text"];
        XElement element = ...;
        // Get XElement instance from posted data.
        return element;
    }
} 
```

# python - 具有随机属性的对象的 Python 列表

> ID：874121
> 
> 赞同：1
> 
> 时间：2009-05-17T08:06:07.587
> 
> 标签：python, random

（编辑：randrange 只是 random.randrange，我没有写自己的 RNG）

我正在尝试创建我定义的类的实例列表。这是整个课程（根据要求）：

```
from random import randrange

class Poly:
    points = [0] * 8
    fill = 'red'
    alpha = 1.0

    def __init__(self, width=100, height=100):
        for i in range(0, 8, 2):
            self.points[i] = randrange(width)
            self.points[i+1] = randrange(height)
        self.alpha = random()
        return 
```

似乎工作正常：

```
>>> for i in range(5):
        Poly().points

[28, 64, 93, 26, 15, 31, 44, 50]
[24, 14, 47, 14, 35, 17, 63, 62]
[99, 28, 90, 29, 56, 59, 57, 33]
[62, 56, 48, 28, 40, 73, 70, 99]
[99, 32, 27, 99, 42, 57, 86, 12] 
```

但是，如果我尝试创建这些对象的列表，我会得到单独的实例（不同的内存地址），但它们都具有相同的随机值：

```
>>> p = []
>>> for i in range(5):
        p.append(Poly())

>>> p
[<gen_image.Poly instance at 0x02D773C8>, <gen_image.Poly instance at 0x02D77FD0>, <gen_image.Poly instance at 0x0321D030>, <gen_image.Poly instance at 0x02D51E40>, <gen_image.Poly instance at 0x02D51DA0>]

>>> for poly in p:
        print poly.points

[75, 18, 5, 76, 6, 64, 95, 54]
[75, 18, 5, 76, 6, 64, 95, 54]
[75, 18, 5, 76, 6, 64, 95, 54]
[75, 18, 5, 76, 6, 64, 95, 54]
[75, 18, 5, 76, 6, 64, 95, 54] 
```

这里发生了什么？什么是做我想做的事情的正确方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T08:17:17.480

将数组的创建移到`__init__`方法中。

您正在使用所有对象之间的共享数组。

第一个显示不同的原因是您在构造新的 Poly 对象之前打印了该数组的内容，从而践踏了数组的内容。如果您保留它们并稍后检查它们，它们似乎都具有与您生成的最后一个相同的内容。

哦，在发布问题时尽量不要简化代码。始终发布完整但简短的重现问题的程序。

这是一个简短但完整的程序，可以演示您遇到的问题：

```
from random import randrange
class Poly:
    points = [0]*8

    def __init__(self, width=100, height=100):
        for i in range(0, 8, 2):
            self.points[i] = randrange(width)
            self.points[i+1] = randrange(height)
        return

p1 = Poly()
print "p1:", p1.points
p2 = Poly()
print "p2:", p2.points
print "p1:", p1.points 
```

样本输出：

```
[C:\Temp] test.py
p1: [19, 5, 1, 46, 93, 18, 18, 57]
p2: [92, 71, 42, 84, 54, 29, 27, 71]
p1: [92, 71, 42, 84, 54, 29, 27, 71] 
```

注意 p1 是如何变化的。

固定代码可以很简单：

```
from random import randrange
class Poly:
    def __init__(self, width=100, height=100):
        self.points = [0]*8
        for i in range(0, 8, 2):
            self.points[i] = randrange(width)
            self.points[i+1] = randrange(height)
        return 
```

虽然我更喜欢[@Doug在](https://stackoverflow.com/users/51305/doug)[这里](https://stackoverflow.com/questions/874121/python-list-of-objects-with-random-attributes/874140#874140)发布的附加变体

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T08:27:17.597

你有一个类属性`Poly.points`。在你的`__init__`方法中你做到了`self.points[i] = ...`。现在这使得 Python 使用`Poly.points`它由所有实例共享。但是你想`points`成为一个实例属性。我建议这样做：

```
class Poly:
    # you don't need this here
    #points = [0] * 8
    #fill = 'red'
    #alpha = 1.0

    def __init__(self, width=100, height=100):
        self.points = [0]*8
        self.fill = 'red'
        self.alpha = random()
        for i in range(0, 8, 2):
            self.points[i] = randrange(width)
            self.points[i+1] = randrange(height) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T08:24:34.657

积分列表全部共享。您似乎将点声明为实例或类上的列表。如果您不想在实例之间共享列表，这不是 Python 中的处理方式。尝试：

```
 def __init__(self, width=100, height=100):
    self.points = [] #Create a new list
    for i in range(0, 8, 2):
        self.points.append(randrange(width))
        self.points.append(randrange(height))
    return 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-17T08:24:41.987

好的，这是罪魁祸首

点数 = [[0]] * 8

它分配相同的列表 ([0]) 8 次，而不是你应该做类似的事情

```
points = []
for i in range(8):
    points.append([]) 
```

# python - AppEngine中的非数据存储类型列表？

> ID：874122
> 
> 赞同：2
> 
> 时间：2009-05-17T08:11:05.967
> 
> 标签：python, google-app-engine, orm

我正在构建一个 AppEngine 模型类。我需要一个简单的元组列表：

```
class MyTuple(object):
  field1 = "string"
  field2 = 3

class MyModel(db.Model):
  the_list = db.ListProperty(MyTuple) 
```

这不起作用，因为 AppEngine 不接受 MyTuple 作为有效字段。

我能想到的解决方案：

1.  使 MyTuple 扩展 db.Model。但这不是意味着列表中的每个条目都将存储在专用的 MyTuple 表中吗？

2.  使其成为字符串列表，这是 MyTuple 的“序列化”形式；添加解析（反序列化）代码。呸。

3.  维护两个列表（一个字符串，一个整数）。另一个恶心。

我还缺少任何其他解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T09:26:42.040

在 app-engine-patch 中有一个 FakeModelListProperty 和 FakeModel（都从 ragedja.dbutils 导入）。从 FakeModel 派生 MyTuple 并设置 fields = ('field1', 'field2')。这些字段在存储在列表中时会自动转换为 JSON，因此您可以在文本区域中手动编辑它们。当然，这只适用于原始类型（字符串、整数等）。如果这还不够，请查看源代码。

[http://code.google.com/p/app-engine-patch/](http://code.google.com/p/app-engine-patch/)

# mobile - 移动信使如何工作？

> ID：874129
> 
> 赞同：0
> 
> 时间：2009-05-17T08:16:22.773
> 
> 标签：mobile, instantmessenger

就我而言，ebuddy 管理所有用户帐户，当用户连接到 Messenger 服务（来自网站和手机）时，他们实际上是通过 ebuddy 服务器连接（而不是直接）。

EQO 移动信使的工作方式是否相同？或者我们直接从手机连接到信使服务器（雅虎、gtalk 等）？

这种“通过另一台服务器连接”不会使我们的帐户容易受到攻击吗？

可用于 yahoo、gtalk、msn 等的免费（或者最好是开源）移动信使有哪些？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T18:48:30.950

是的，EQO 以同样的方式工作。是的，它使您的帐户容易受到攻击。Palringo 是一个免费的闭源移动 IM 客户端。我不知道开源的移动 IM 客户端。

# c++ - 找出字符串是否以 C++ 中的另一个字符串结尾

> ID：874134
> 
> 赞同：326
> 
> 时间：2009-05-17T08:19:28.507
> 
> 标签：c++, string, ends-with

如何确定一个字符串是否以 C++ 中的另一个字符串结尾？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2009-05-17T08:34:04.790

只需使用以下方式比较最后*n 个*字符[`std::string::compare`](http://en.cppreference.com/w/cpp/string/basic_string/compare)：

```
#include <iostream>

bool hasEnding (std::string const &fullString, std::string const &ending) {
    if (fullString.length() >= ending.length()) {
        return (0 == fullString.compare (fullString.length() - ending.length(), ending.length(), ending));
    } else {
        return false;
    }
}

int main () {
    std::string test1 = "binary";
    std::string test2 = "unary";
    std::string test3 = "tertiary";
    std::string test4 = "ry";
    std::string ending = "nary";

    std::cout << hasEnding (test1, ending) << std::endl;
    std::cout << hasEnding (test2, ending) << std::endl;
    std::cout << hasEnding (test3, ending) << std::endl;
    std::cout << hasEnding (test4, ending) << std::endl;

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：198
> 
> 时间：2010-01-15T15:59:34.780

使用这个功能：

```
inline bool ends_with(std::string const & value, std::string const & ending)
{
    if (ending.size() > value.size()) return false;
    return std::equal(ending.rbegin(), ending.rend(), value.rbegin());
} 
```

* * *

## 回答 #3

> 赞同：168
> 
> 时间：2011-06-12T21:36:04.233

使用`boost::algorithm::ends_with`（参见例如[http://www.boost.org/doc/libs/1_34_0/doc/html/boost/algorithm/ends_with.html](http://www.boost.org/doc/libs/1_34_0/doc/html/boost/algorithm/ends_with.html)）：

```
#include <boost/algorithm/string/predicate.hpp>

// works with const char* 
assert(boost::algorithm::ends_with("mystring", "ing"));

// also works with std::string
std::string haystack("mystring");
std::string needle("ing");
assert(boost::algorithm::ends_with(haystack, needle));

std::string haystack2("ng");
assert(! boost::algorithm::ends_with(haystack2, needle)); 
```

* * *

## 回答 #4

> 赞同：138
> 
> 时间：2017-03-16T20:57:08.550

Note, that starting from [c++20](https://en.wikipedia.org/wiki/C%2B%2B20) std::string will finally provide [starts_with](http://en.cppreference.com/w/cpp/string/basic_string/starts_with) and [ends_with](http://en.cppreference.com/w/cpp/string/basic_string/ends_with). Seems like there is a chance that by c++30 strings in c++ might finally become usable, if you aren't reading this from distant future, you can use these startsWith/endsWith with C++17:

```
#if __cplusplus >= 201703L // C++17 and later 
#include <string_view>

static bool endsWith(std::string_view str, std::string_view suffix)
{
    return str.size() >= suffix.size() && 0 == str.compare(str.size()-suffix.size(), suffix.size(), suffix);
}

static bool startsWith(std::string_view str, std::string_view prefix)
{
    return str.size() >= prefix.size() && 0 == str.compare(0, prefix.size(), prefix);
}
#endif // C++17 
```

If you are stuck with older C++, you may use these:

```
#if __cplusplus < 201703L // pre C++17
#include <string>

static bool endsWith(const std::string& str, const std::string& suffix)
{
    return str.size() >= suffix.size() && 0 == str.compare(str.size()-suffix.size(), suffix.size(), suffix);
}

static bool startsWith(const std::string& str, const std::string& prefix)
{
    return str.size() >= prefix.size() && 0 == str.compare(0, prefix.size(), prefix);
} 
```

and some extra helper overloads:

```
static bool endsWith(const std::string& str, const char* suffix, unsigned suffixLen)
{
    return str.size() >= suffixLen && 0 == str.compare(str.size()-suffixLen, suffixLen, suffix, suffixLen);
}

static bool endsWith(const std::string& str, const char* suffix)
{
    return endsWith(str, suffix, std::string::traits_type::length(suffix));
}

static bool startsWith(const std::string& str, const char* prefix, unsigned prefixLen)
{
    return str.size() >= prefixLen && 0 == str.compare(0, prefixLen, prefix, prefixLen);
}

static bool startsWith(const std::string& str, const char* prefix)
{
    return startsWith(str, prefix, std::string::traits_type::length(prefix));
}
#endif 
```

IMO, c++ strings are clearly dysfunctional, and weren't made to be used in real world code. But there is a hope that this will get better at least.

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2011-10-10T20:22:14.833

我知道 C++ 的问题，但如果有人需要一个好的老式 C 函数来做到这一点：

```
 /*  returns 1 iff str ends with suffix  */
int str_ends_with(const char * str, const char * suffix) {

  if( str == NULL || suffix == NULL )
    return 0;

  size_t str_len = strlen(str);
  size_t suffix_len = strlen(suffix);

  if(suffix_len > str_len)
    return 0;

  return 0 == strncmp( str + str_len - suffix_len, suffix, suffix_len );
} 

```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2009-05-18T08:12:09.333

当用于从两个字符串的末尾向后迭代时，该`std::mismatch`方法可以达到此目的：

```
const string sNoFruit = "ThisOneEndsOnNothingMuchFruitLike";
const string sOrange = "ThisOneEndsOnOrange";

const string sPattern = "Orange";

assert( mismatch( sPattern.rbegin(), sPattern.rend(), sNoFruit.rbegin() )
          .first != sPattern.rend() );

assert( mismatch( sPattern.rbegin(), sPattern.rend(), sOrange.rbegin() )
          .first == sPattern.rend() ); 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2013-09-08T06:59:46.337

在我看来，最简单的 C++ 解决方案是：

```
bool endsWith(const std::string& s, const std::string& suffix)
{
    return s.rfind(suffix) == std::abs(s.size()-suffix.size());
} 
```

**警告：**如果匹配失败，这将在放弃之前向后搜索整个字符串，因此可能会浪费很多循环。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-05-17T08:27:09.533

让`a`成为一个字符串和`b`你要找的字符串。用于`a.substr`获取 的最后 n 个字符`a`并将它们与 b 进行比较（其中 n 是 的长度`b`）

或使用`std::equal`（包括`<algorithm>`）

前任：

```
bool EndsWith(const string& a, const string& b) {
    if (b.size() > a.size()) return false;
    return std::equal(a.begin() + a.size() - b.size(), a.end(), b.begin());
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-01-03T22:27:31.287

让我用不区分大小写的版本扩展[Joseph 的解决方案（](https://stackoverflow.com/a/2072890)[在线演示](http://coliru.stacked-crooked.com/a/2080ca594951bae9)）

```
#include <string>
#include <cctype>

static bool EndsWithCaseInsensitive(const std::string& value, const std::string& ending) {
    if (ending.size() > value.size()) {
        return false;
    }
    return std::equal(ending.crbegin(), ending.crend(), value.crbegin(),
        [](const unsigned char a, const unsigned char b) {
            return std::tolower(a) == std::tolower(b);
        }
    );
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-05-17T08:38:51.813

你可以使用[string::rfind](http://www.cplusplus.com/reference/string/string/rfind/)

基于评论的完整示例：

```
bool EndsWith(string &str, string& key)
{
size_t keylen = key.length();
size_t strlen = str.length();

if(keylen =< strlen)
    return string::npos != str.rfind(key,strlen - keylen, keylen);
else return false;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2020-05-07T14:46:55.577

使用`<algorithms>`带有反向迭代的 std::equal 算法：

```
std::string LogExt = ".log";
if (std::equal(LogExt.rbegin(), LogExt.rend(), filename.rbegin())) {
   …
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-03-01T22:46:54.483

和上面一样，这是我的解决方案

```
 template<typename TString>
  inline bool starts_with(const TString& str, const TString& start) {
    if (start.size() > str.size()) return false;
    return str.compare(0, start.size(), start) == 0;
  }
  template<typename TString>
  inline bool ends_with(const TString& str, const TString& end) {
    if (end.size() > str.size()) return false;
    return std::equal(end.rbegin(), end.rend(), str.rbegin());
  } 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-12-02T08:41:29.370

检查**str**是否有**suffix**，使用如下：

```
/*
Check string is end with extension/suffix
*/
int strEndWith(char* str, const char* suffix)
{
  size_t strLen = strlen(str);
  size_t suffixLen = strlen(suffix);
  if (suffixLen <= strLen) {
    return strncmp(str + strLen - suffixLen, suffix, suffixLen) == 0;
  }
  return 0;
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-12-05T08:47:54.300

关于 Grzegorz Bazior 的反应。我使用了这个实现，但是原始的有错误（如果我将“..”与“.so”进行比较，则返回 true）。我建议修改功能：

```
bool endsWith(const string& s, const string& suffix)
{
    return s.size() >= suffix.size() && s.rfind(suffix) == (s.size()-suffix.size());
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-06-09T10:19:01.417

为类似的“startWith”问题找到了这个不错的答案：

[如何检查 C++ std::string 是否以某个字符串开头，并将子字符串转换为 int？](https://stackoverflow.com/questions/1878001/how-do-i-check-if-a-c-stdstring-starts-with-a-certain-string-and-convert-a)

您可以采用仅在字符串的最后一个位置进行搜索的解决方案：

```
bool endsWith(const std::string& stack, const std::string& needle) {
    return stack.find(needle, stack.size() - needle.size()) != std::string::npos;
} 
```

通过这种方式，您可以使其简短、快速、使用标准 c++ 并使其具有可读性。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-10-05T05:51:52.743

```
bool EndsWith(const std::string& data, const std::string& suffix)
{
    return data.find(suffix, data.size() - suffix.size()) != std::string::npos;
} 
```

**测试**

```
#include <iostream>
int main()
{
   cout << EndsWith(u8"o!hello!1", u8"o!") << endl; 
   cout << EndsWith(u8"o!hello!", u8"o!") << endl; 
   cout << EndsWith(u8"hello!", u8"o!") << endl; 
   cout << EndsWith(u8"o!hello!o!", u8"o!") << endl; 
   return 0;
} 
```

**输出**

```
0 
1 
1 
1 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-01-30T22:52:54.830

另一种选择是使用正则表达式。以下代码使搜索对大小写不敏感：

```
bool endsWithIgnoreCase(const std::string& str, const std::string& suffix) {
  return std::regex_search(str,
     std::regex(std::string(suffix) + "$", std::regex_constants::icase));
} 
```

可能效率不高，但易于实施。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-03-25T17:01:56.250

如果像我一样，您需要 endsWith 来检查文件扩展名，您可以使用该`std::filesystem`库：

```
std::filesystem::path("/foo/bar.txt").extension() == ".txt" 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-12-08T14:10:28.487

我认为发布一个不使用任何库函数的原始解决方案是有意义的......

```
// Checks whether `str' ends with `suffix'
bool endsWith(const std::string& str, const std::string& suffix) {
    if (&suffix == &str) return true; // str and suffix are the same string
    if (suffix.length() > str.length()) return false;
    size_t delta = str.length() - suffix.length();
    for (size_t i = 0; i < suffix.length(); ++i) {
        if (suffix[i] != str[delta + i]) return false;
    }
    return true;
} 
```

添加一个简单的`std::tolower`我们可以使这个大小写不敏感

```
// Checks whether `str' ends with `suffix' ignoring case
bool endsWithIgnoreCase(const std::string& str, const std::string& suffix) {
    if (&suffix == &str) return true; // str and suffix are the same string
    if (suffix.length() > str.length()) return false;
    size_t delta = str.length() - suffix.length();
    for (size_t i = 0; i < suffix.length(); ++i) {
        if (std::tolower(suffix[i]) != std::tolower(str[delta + i])) return false;
    }
    return true;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-09-10T08:02:11.357

```
bool endswith(const std::string &str, const std::string &suffix)
{
    string::size_type totalSize = str.size();
    string::size_type suffixSize = suffix.size();

    if(totalSize < suffixSize) {
        return false;
    }

    return str.compare(totalSize - suffixSize, suffixSize, suffix) == 0;
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-11-25T17:37:09.253

如果你和我一样，不喜欢 C++ 纯粹主义，这里有一个古老的 skool 混合体。当字符串包含多个字符时会有一些优势，因为大多数`memcmp`实现都会尽可能地比较机器字。

您需要控制字符集。例如，如果这种方法与 utf-8 或 wchar 类型一起使用，则存在一些缺点，因为它不支持字符映射 - 例如，当两个或多个字符在[逻辑上相同时](https://en.wikipedia.org/wiki/Duplicate_characters_in_Unicode)。

```
bool starts_with(std::string const & value, std::string const & prefix)
{
    size_t valueSize = value.size();
    size_t prefixSize = prefix.size();

    if (prefixSize > valueSize)
    {
        return false;
    }

    return memcmp(value.data(), prefix.data(), prefixSize) == 0;
}

bool ends_with(std::string const & value, std::string const & suffix)
{
    size_t valueSize = value.size();
    size_t suffixSize = suffix.size();

    if (suffixSize > valueSize)
    {
        return false;
    }

    const char * valuePtr = value.data() + valueSize - suffixSize;

    return memcmp(valuePtr, suffix.data(), suffixSize) == 0;
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-06-16T18:42:58.553

我的两分钱：

```
bool endsWith(std::string str, std::string suffix)
{
   return str.find(suffix, str.size() - suffix.size()) != string::npos;
} 
```

# delphi - 如何找到程序的位置

> ID：874137
> 
> 赞同：-1
> 
> 时间：2009-05-17T08:19:46.010
> 
> 标签：delphi, delphi-2006

我正在使用 Delphi2006，我想使用 Delphi 代码查找特定程序的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T13:40:20.810

这是一个Delphi 程序，它可以找到所有名为aFileName 的文件，并将结果放入aDestFiles 字符串列表中。

```
 function findFilesCalled(aFileName : String; aDestFiles : TStringList) : boolean;
 var
   subDirs : TStringList;
   dir : Char;
   sRec : TSearchRec;
   toSearch : string;
 begin
   subdirs := TStringList.Create;
   for dir := 'A' to 'Z' do
     if DirectoryExists(dir + ':\') then
       subdirs.add(dir + ':');
   try
     while (subdirs.count > 0) do begin
       toSearch := subdirs[subdirs.count - 1];
       subdirs.Delete(subdirs.Count - 1);
       if FindFirst(toSearch + '\*.*', faDirectory, sRec) = 0 then begin
         repeat
           if (sRec.Attr and faDirectory) <> faDirectory then
             Continue;
           if (sRec.Name = '.') or (sRec.Name = '..') then
             Continue;
           subdirs.Add(toSearch + '\' + sRec.Name);
         until FindNext(sRec) <> 0;
       end;
       FindClose(sRec);
       if FindFirst(toSearch + '\' + aFileName, faAnyFile, sRec) = 0 then begin
         repeat
           aDestFiles.Add(toSearch + '\' + sRec.Name);
         until FindNext(sRec) <> 0;
       end;
       FindClose(sRec);
     end;
   finally
     FreeAndNil(subdirs);
   end;
   Result := aDestFiles.Count > 0;
 end; 
```

# proxy - 代理在 HttpClient 4.0 beta2 中不起作用

> ID：874138
> 
> 赞同：0
> 
> 时间：2009-05-17T08:21:38.640
> 
> 标签：proxy, httpclient

我正在使用`HttpClient 4.0-beta2`, 进行 REST 调用。它在我的笔记本电脑上运行良好，但在 uni 中，我们必须配置我们的应用程序以通过代理，否则我们无法连接到互联网

这是我的原始代码：

```
HttpClient httpclient = new DefaultHttpClient();
HttpPut put = new HttpPut("http://" + PutBlob.ACCOUNT + 
                                      ".blob.core.windows.net/container/abc");
put.addHeader(PutBlob.ContentType, PutBlob.CONTENT_TYPE.TEXT_PLAIN.getValue());
put.setEntity(new StringEntity("Hello world", "UTF-8"));
Sign(put, PutBlob.ACCOUNT, PutBlob.KEY);

log.debug(EntityUtils.toString(httpclient.execute(put).getEntity())); 
```

下面是我如何使用代理，但它对我不起作用。

配置代理的正确方法是`HttpClient 4.0`什么？

```
HttpHost hcProxyHost = new HttpHost("proxyserver", 3128, "http");
DefaultHttpClient httpclient = new DefaultHttpClient();
httpclient.getParams().setParameter(ConnRoutePNames.DEFAULT_PROXY, hcProxyHost);

HttpPut put = new HttpPut("/container/abc");
put.addHeader(PutBlob.ContentType, PutBlob.CONTENT_TYPE.TEXT_PLAIN.getValue());
put.setEntity(new StringEntity("Hello world", "UTF-8"));
Sign(put, PutBlob.ACCOUNT, PutBlob.KEY);

HttpHost target = new HttpHost( PutBlob.ACCOUNT + ".blob.core.windows.net");
log.debug(EntityUtils.toString(httpclient.execute(target, put).getEntity())); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-04T06:54:55.667

尝试使用

```
ConnRouteParams.setDefaultProxy(method.getParams(), new HttpHost("yourproxyname",yourport,"http")); 
```

# asp.net-mvc - 如何让 Ajax.ActionLink 更新元素而不是导航整个页面？

> ID：874143
> 
> 赞同：9
> 
> 时间：2009-05-17T08:25:51.860
> 
> 标签：asp.net-mvc, ajax

当`<div>`用户单击`Ajax.ActionLink`. 但是，它始终导航整个页面，而不是将服务器的响应插入到我指定的元素中。

我觉得我在[这个例子](http://blogger.forgottenskies.com/?p=234)中做了所有事情，但是即使在创建了最简单的测试用例之后，我仍然无法创建我想要的行为。

在接下来的测试用例中，我加载`/Company/test`并单击“开始！”后，我希望`<div>`将 替换为“全部完成”，但整个页面导航到`/Company/test_ajax`.

我确定我在这里遗漏了一些东西。提前致谢。

**公司控制器**

```
public ActionResult test()
{
    return View();
}

public ActionResult test_ajax()
{
    return Content("All done");
} 
```

**测试.aspx**

```
<%@ Page Title="" Language="C#" Inherits="System.Web.Mvc.ViewPage" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>test</title>
<script src="../../Scripts/jquery-1.3.2.min.js" type="text/javascript"></script>
<script src="../../Scripts/MicrosoftAjax.js" type="text/javascript"></script>
<script src="../../Scripts/MicrosoftMvcAjax.js" type="text/javascript"></script>
</head>
<body>

<h2>test</h2>
<%= Ajax.ActionLink("Go!", "test_ajax",
    new AjaxOptions {
        UpdateTargetId="viewport"
        }) %>
<div id="viewport">Replace me!</div>

</body></html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-09-18T16:18:43.650

如果您使用的是 MVC 3，则必须包含“jquery.unobtrusive-ajax.js”作为参考。它应该已经存在于您的 Scripts 文件夹中。\米/

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-28T18:02:45.577

我发现将 jquery.unobtrusive-ajax.js 添加到我的 layout.cshtml 页面可以避免各种愚蠢的*“为什么这不起作用？”* 使用 ajax 对象/方法的时刻。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-19T06:13:35.957

您的示例在我的计算机上按预期工作。检查文件 MicrosoftAjax.js 和 MicrosoftMvcAjax.js 是否真的存在于 ../../Scripts 文件夹中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T15:35:04.327

我必须在 ActionLink 调用中修改 AjaxOptions 才能使其正常工作：

```
<%= Ajax.ActionLink("Update", "UpdateContent", new AjaxOptions() { HttpMethod = "Post", UpdateTargetId = "target", InsertionMode = InsertionMode.Replace })%> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-13T19:33:21.163

这也有问题。我正在使用 VS2013 和 jquery-1.10.2.min.js。必须使用 4 个 js 文件的组合才能使其工作。希望此示例代码对某人有所帮助。

测试.cshtml：

```
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>test</title>

        <script src="@Url.Content("~/Scripts/jquery-1.10.2.min.js")" type="text/javascript"></script>
        <script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script>
        <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery.history.js")" type="text/javascript"></script>

    <script type="text/javascript">

        $(function () {
            $.history.init(function (hash) {
                if (hash.length > 0) {
                    $("#" + hash).click();
                }
            },
            { unescape: ",/" });
        });

        function AddHashTag(hashTag) {
            window.location.hash = hashTag;
        }

    </script>

</head>
<body>
            @Ajax.ActionLink("Render Circle", "GetCircle", null,
                new AjaxOptions { HttpMethod = "Get", UpdateTargetId = "divContent", OnSuccess = "AddHashTag('circle')" },
                new { @id = "circle" })

            @Ajax.ActionLink("Render Diamond", "GetDiamond", null,
                new AjaxOptions { HttpMethod = "Get", UpdateTargetId = "divContent", OnSuccess = "AddHashTag('diamond')" },
                new { @id = "diamond" })

            @Ajax.ActionLink("Render Star", "GetStar", null,
                new AjaxOptions { HttpMethod = "Get", UpdateTargetId = "divContent", OnSuccess = "AddHashTag('star')" },
                new { @id = "star" })

        <div id="divContent" style="width: 300px; height: 300px; text-align: center; vertical-align: middle;
    margin: 50px 50px;">
        </div>
</body>
</html>

star.cshtml:
star<div class="star"></div>

diamond.cshtml:
diamond<div class="diamond"></div>

circle.cshtml:
circle<div class="circle"></div>

Home Controller:

        public ActionResult Test()
        {
            return View();
        }

        [HttpGet]
        public ActionResult GetCircle()
        {
            return PartialView("Circle");
        }

        [HttpGet]
        public ActionResult GetDiamond()
        {
            return PartialView("Diamond");
        }

        [HttpGet]
        public ActionResult GetStar()
        {
            return PartialView("Star");
        } 
```

# .net - 使用 XmlTextWriter 时如何在 xml 元素值中的换行符后缩进？

> ID：874147
> 
> 赞同：4
> 
> 时间：2009-05-17T08:27:12.077
> 
> 标签：.net, xml, xmltextwriter

使用 XmlTextWriter 时，我试图在换行符后缩进

所以基本上我想要这个

```
<?xml version="1.0" encoding="utf-16"?>
<element>
  a
</element> 
```

但是使用下面的代码我得到了这个

```
<?xml version="1.0" encoding="utf-16"?>
<element>
a
</element> 
```

这是我当前的测试工具

```
[Test]
public void XmlIndentingTest()
{
    var provider = new StringBuilder();
    var settings = new XmlWriterSettings
                       {
                           Indent = true,
                           IndentChars = "  ",
                       };
    using (var writer = new StringWriter(provider))
    {
        using (var xmlWriter = XmlTextWriter.Create(writer, settings))
        {
            xmlWriter.WriteStartElement("element");
            xmlWriter.WriteString("\r\na\r\n");
            xmlWriter.WriteEndElement();
        }
    }
    Debug.WriteLine(provider.ToString());
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T08:30:50.927

writer 中指定的缩进用于在没有重要空白的元素之间缩进。您要创建的空白很重要，因为它构成了开始标签和结束标签之间的文本值的一部分。

如果作者对普通 xml 这样做，它将以不可接受的方式修改文本内容。你需要自己做这件事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T08:32:28.910

恐怕您的代码完全按照您的指示去做。

```
xmlWriter.WriteStartElement("element"); //<element>
xmlWriter.WriteString("\r\na\r\n");     //newline, directly followed by 'a'
xmlWriter.WriteEndElement();            //</element> 
```

如果你想要一个缩进，你必须在你的代码中写这个，比如

```
xmlWriter.WriteString("\r\n\ta\r\n"); 
```

这种方法的问题是，如果你`<element>`已经缩进，它会弄乱缩进 - 你的“a”仍然会缩进一个标签。

因此，您可以以某种方式自己计算缩进，并编写适当数量的制表符，或者将整个元素放在一行中

```
<element>a</element> 
```

这肯定更清楚，但是当“a”变成一个很长的文本时，它可能看起来很奇怪。

# jquery - 如何从jQuery中的事件对象中获取按键值

> ID：874158
> 
> 赞同：11
> 
> 时间：2009-05-17T08:34:01.623
> 
> 标签：jquery

我想禁止用户在不是字母或数字的 HTML 文本输入字段中输入字符。

这个确切的功能可以在 Twitter 注册页面（用户名字段）[https://twitter.com/signup](https://twitter.com/signup)上看到。

我试图用 jQuery 写这个。但是我需要能够获取传入的按键事件值来测试按下了哪个键以及它的值是否可以接受。

这是代码：

```
<input type="text" id="username" name="username" />

<script type="text/javascript">
$("#username").keypress(function(event){   

 // Get the keypress value
 // ...?

// If the keypress value is illegal then disable it
if (...){
   event.preventDefault();
}

});
</script> 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-17T08:45:42.483

您可以使用事件对象的“哪个”属性来捕获键码。您可以使用类似下面的代码来获取相应的字符 -

```
var c = String.fromCharCode(e.which);

```

详细解释见链接[http://api.jquery.com/keypress/](http://api.jquery.com/keypress/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T08:57:07.837

当用户按下一个键时，相应的 ascii 代码就是事件中发送的内容。使用 e.which 字段

所以你的条件可能看起来像这样：

```
if ( e.which > 47 &&  e.which < 58)
{
    // it is a number
} 
```

有许多不同的方法可以编写条件。可能通过使用将允许的字符映射到数组。

供参考，大写：65 - 90 小写：97 - 122

您应该意识到这将使您的应用程序仅适用于使用标准 ASCII 集输入英语的人。国际用户将无法在您的表单字段中写入，因为这些键码超出标准 ASCII 范围并且将使用不同的编码。只是需要考虑的事情。

Ascii 代码：[http ://www.petefreitag.com/cheatsheets/ascii-codes/](http://www.petefreitag.com/cheatsheets/ascii-codes/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-09-08T07:43:18.417

```
 var ako ='';
    var novalue = '';
    jQuery('html').keypress(function(event){
        var valuekey = event.charCode;
        ako = String.fromCharCode(event.which);
        jQuery('.a').each(function(){
            var cn = jQuery(this).html();
            if(ako == cn){
                jQuery(this).hide('explode',{},'10000').remove();
            }   
            novalue +=cn;
        });
        //alert(novalue);
        jQuery("#cn").animate({width:'400px',border:'1px solid pink'},'slow');
    }); 
```

试试这个

# c - C Tokenizer（当字段丢失时它也返回空。耶！）

> ID：874161
> 
> 赞同：0
> 
> 时间：2009-05-17T08:34:56.720
> 
> 标签：c, substring, tokenize, substr

另请参阅：[这是 C 的一个好的 substr() 吗？](https://stackoverflow.com/questions/874015/updated-is-this-a-good-substr-for-c)

* * *

`strtok()`和朋友跳过空字段，我不知道如何告诉它在这种情况下不要跳过而是返回空。

我能看到的大多数标记器的类似行为，甚至没有让我开始`sscanf()`（但它从未说过它会在空字段上工作）。

我一直在滚动并且也感到困倦，所以在这里进行审查：

```
char* substr(const char* text, int nStartingPos, int nRun)
{
    char* emptyString = strdup(""); /* C'mon! This cannot fail */

    if(text == NULL) return emptyString;

    int textLen = strlen(text);

    --nStartingPos;

    if((nStartingPos < 0) || (nRun <= 0) || (textLen == 0) || (textLen < nStartingPos)) return emptyString;

    char* returnString = (char *)calloc((1 + nRun), sizeof(char));

    if(returnString == NULL) return emptyString;

    strncat(returnString, (nStartingPos + text), nRun);

    /* We do not need emptyString anymore from this point onwards */
    free(emptyString);
    emptyString = NULL;

    return returnString;
}

int TokenizeC(const char* text, char delim, char ***output)
{
    if((*output) != NULL) return -1; /* I will allocate my own storage */

    int nCountOfDelimiters = 0;
    int dx = 0;
    int nCountOfElements = 0;
    int textLen = strlen(text);

    for(; dx < textLen; ++dx)
    {
        if((text[dx] == delim) && (dx != (textLen - 1))) ++nCountOfDelimiters;
        /* trailing delimiter need not be counted separately as we are */
        /* incrementing the count always by 1 */
    }

    /*
    We will have as many array elements as nCountOfDelimiters + 1
    Tokenizing an empty string should return a single token that would
    be empty (Is this not how most libraries behave? Or should it return NULL?)
    */

    (*output) = (char **)malloc((1 + nCountOfDelimiters) * sizeof(char *));

    for(dx = 0; dx < textLen; dx++)
    {
        int nStartOfString = (1 + dx);

        //printf("\n[! 1]dx = %d, nStartOfString = %d", dx, nStartOfString);

        /* Get the run between delimiters */
        while((dx < textLen) && (text[dx] != delim)) dx++;

        //printf("\n[! 2]dx = %d, nStartOfString = %d", dx, nStartOfString);

        (*output)[nCountOfElements] = (1 + dx - nStartOfString) ? substr(text, nStartOfString, (1 + dx - nStartOfString)) : strdup("");

        //printf("\n[!]substr(text, %d, %d) => '%s'", nStartOfString, (1 + dx - nStartOfString), (*output)[nCountOfElements]);

        if(NULL == (*output)[nCountOfElements])
        {
            // Woops! Undo all
            // TODO: How to test this scenario?!

            for(; nCountOfElements >= 0; --nCountOfElements)
            {
                if((*output)[nCountOfElements] != NULL) free((*output)[nCountOfElements]);
                (*output)[nCountOfElements] = NULL;
            }

            return -2; 
        }

        ++nCountOfElements;
    }

    return nCountOfElements; /* Return the number of tokens if sucessful */
}

void reclaim2D(char ***store, unsigned int itemCount)
{
    for (int x = 0; itemCount < itemCount; ++x)
    {
        if((*store)[x] != NULL) free((*store)[x]);
        (*store)[x] = NULL;
    }

    if((*store) != NULL) free((*store));
    (*store) = NULL;
} 
```

这是驱动程序：

```
int main()
{
    // Trailing '-' scenarios not giving correct count of elements
    // (off by 1 for the last element that should come as empty)

    const char *text = "1-2-3-6-7-8-9-10-11-", delim = '-'; // 10 elements

    char **output = NULL;

    int c = TokenizeC(text, delim, &output);

    printf("\n\n[*]%d", c);

    for (int x = 0; x < c; ++x)
    {
        printf("\n[main]'%s'", output[x]); //Expected : 1-2-3-6-7-8-9-10-11-<empty>
    }

    reclaim2D(&output, c);

    text = "12-3-6-7-8-9-10-11";  // 8 elements

    c = TokenizeC(text, delim, &output);

    printf("\n\n[*]%d", c);

    for(int x = 0; x < c; ++x)
    {
        printf("\n[main]'%s'", output[x]); //Expected : 12-3-6-7-8-9-10-11
    }

    reclaim2D(&output, c);

    text = "-----2--4--6-7100000000-8-9-10-11-100000000-";  // 17 elements

    c = TokenizeC(text, delim, &output);

    printf("\n\n[*]%d", c);

    for(int x = 0; x < c; ++x)
    {
        printf("\n[main]'%s'", output[x]);
        //Expected <empty>-<empty>-<empty>-<empty>
        // -<empty>-2-<empty>-4-<empty>-6-7100000000
        // -8-9-10-11-100000000-<empty>
    }

    reclaim2D(&output, c);

    text = "-----2--4--6-7100000000-8-9-10-11-100000000";  // 16 elements

    c = TokenizeC(text, delim, &output);

    printf("\n\n[*]%d", c);

    for(int x = 0; x < c; ++x)
    {
        printf("\n[main]'%s'", output[x]);
        //Expected : <empty>-<empty>-<empty>-<empty>-<empty>
        //-2-<empty>-4-<empty>-6-7100000000-8-9-10-11-100000000
    }

    reclaim2D(&output, c);

    return 0;
} 
```

是的，你没看错；它现在仅适用于单个分隔符，但当然，我们需要处理一个错误。

> 输出：

```
[*]9
[main]'1'
[main]'2'
[main]'3'
[main]'6'
[main]'7'
[main]'8'
[main]'9'
[main]'10'
[main]'11'

[*]8
[main]'12'
[main]'3'
[main]'6'
[main]'7'
[main]'8'
[main]'9'
[main]'10'
[main]'11'

[*]16
[main]''
[main]''
[main]''
[main]''
[main]''
[main]'2'
[main]''
[main]'4'
[main]''
[main]'6'
[main]'7100000000'
[main]'8'
[main]'9'
[main]'10'
[main]'11'
[main]'100000000'

[*]16
[main]''
[main]''
[main]''
[main]''
[main]''
[main]'2'
[main]''
[main]'4'
[main]''
[main]'6'
[main]'7100000000'
[main]'8'
[main]'9'
[main]'10'
[main]'11'
[main]'100000000' 
```

我也将其设为 wiki，因为我在网上看到了许多类似的请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T08:46:51.263

在某些系统上，有一个名为 strsep() 的函数。你可以通过谷歌找到它的源代码。例如，[http://www.google.com/codesearch/p?hl=zh-TW#XAzRy8oK4zA/libc/string/strsep.c&q=strsep](http://www.google.com/codesearch/p?hl=zh-TW#XAzRy8oK4zA/libc/string/strsep.c&q=strsep)

# php - 迁移现有的 PHP 站点以使用 URL 重写（漂亮的 URL）

> ID：874165
> 
> 赞同：1
> 
> 时间：2009-05-17T08:40:08.487
> 
> 标签：php, url, mod-rewrite, url-rewriting, url-routing

我目前有一个我运行的社区站点，它由 15 个左右的 php 页面组成。它目前不是很动态，仅将 php 用于包含/模板。

目前没有通过查询字符串生成内容。这些页面不遵循标准命名约定，并且有许多入站链接。

我正在寻找扩展站点（并开始使用查询字符串来构建页面），但在此之前，我想改用漂亮的 url。考虑到这一点，我有几个问题。

1）最好将所有请求指向一个url重写页面，首先捕获对.php页面的任何请求并传递它们以保留现有链接，然后为15个页面中的每一个页面提供一个巨大的案例声明，最后将新页面的url重写为这些将遵循固定的格式？

2) 在我更新了我的 sitemap.xml 后，如何防止谷歌中的重复，或者它会删除旧页面？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T09:19:05.727

1）我会使用apache的URL重写重定向，并保持静态。它将避免您的站点中已有 15 个文件的混乱。
我希望我没有误解你的问题，这会有所帮助。

2）在您网站的根目录中编辑 robots.txt 以告诉谷歌（和大多数其他人）它应该索引什么，不应该索引什么：

*   Google 关于该主题的信息：[http ://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=40360](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=40360)
*   维基百科：[http ://en.wikipedia.org/wiki/Robots_exclusion_standard](http://en.wikipedia.org/wiki/Robots_exclusion_standard)
*   更多信息：[http ://www.robotstxt.org/](http://www.robotstxt.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T09:32:15.210

您应该使用从旧页面到新 URL 的 301 永久重定向。这会将跟随链接的用户从旧页面重定向到新页面，Google 会将您在旧页面上积累的 PageRank 传递给新页面。您还可以考虑在旧页面上使用 Google 的新规范标签，以确保它们将权限转移到新页面。

[http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)

在 .htaccess 中，你想要一堆

重定向 301 /old/old.htm [http://www.you.com/new.htm](http://www.you.com/new.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T09:31:06.557

不管它是如何实现的，确保任何重定向都使用 HTTP 状态 301，而不是默认的（在可能的系统中）302。

302 = 移动 301 = 永久移动。

使用 301 有助于谷歌用新的 URL 替换旧的，并且应该有助于 pagerank 等的延续。

# sql-server-2008 - SQL Server 2008 网页管理脚本？

> ID：874166
> 
> 赞同：0
> 
> 时间：2009-05-17T08:40:58.407
> 
> 标签：sql-server-2008, scripting

有谁知道存在哪些 SQL Server 2008 管理脚本（myLittleAdmin 除外）？

谢谢

澄清：我正在寻找除 myLittleAdmin 之外的基于 Web 的管理脚本（支持 SQL Server 2008）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-24T05:06:33.970

看

*   [类似 phpMyAdmin 但适用于 SQL Server 的东西？](https://stackoverflow.com/questions/1372641/something-like-phpmyadmin-but-for-sql-server)
*   [免费或开源的 .Net 数据库查看/编辑工具，例如 phpMyAdmin](https://stackoverflow.com/questions/764539/free-or-open-source-net-database-view-edit-tools-like-phpmyadmin)

# haskell - 嵌套在haskell中

> ID：874168
> 
> 赞同：1
> 
> 时间：2009-05-17T08:42:48.340
> 
> 标签：haskell, nested-if

//当我只使用这 2 行时编辑 5

```
 index :: [String] -> [String] -> Bool
  index a b = and [x `elem` a |x <- b] 
```

它工作正常！！！！

例如：

索引 ["asd","asdd","dew"] ["asdd","asdad"]

错误的

但是当我使用下面提到的整个代码时

```
empty [] = True
empty _ = False

    index a b = do
             if empty a
              then do putStrLn "a is empty"
                      else return ()
             if empty b
              then do putStrLn "b is empty"
                      else return ()
        where
          index :: [String] -> [String] -> Bool
          index a b = and [x `elem` a |x <- b] 
```

没有输出！！这就是我遇到的问题！

//编辑 6

```
index a b = do index'
         if empty a
          then do putStrLn "a is empty"
                  else return ()
         if empty b
          then do putStrLn "b is empty"
                  else return ()
    where
      index' :: [String] -> [String] -> Bool
      index' a b = and [x `elem` a |x <- b] 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T13:47:17.157

这有点离题，因为您可能正在尝试学习布局规则以及如何嵌套 ifs，但是您在修订版 6 中显示的代码仅`if`用于进行错误检查。我只是通过模式匹配而不是`if`.

```
index [] _ = putStrLn "a is empty"
index _ [] = putStrLn "b is empty"
index a b = putStrLn (show index')
    where index' = and [x `elem` a | x <- b] 
```

（你不需要`return ()`after`putStrLn`因为它已经`()`为你返回了。）

模式匹配更容易正确，因为它不需要很多缩进等。

* * *

编辑：

我`index'`从你的角度改变了一点的定义。在我的版本中，它是局部变量而不是局部函数。在 Haskell 中，并没有太大的区别，只是`index'`使用了`a`and `b`from 周围的`index`函数，所以不需要带参数。（诚​​然，`index'`对于变量来说，这不是一个好名字。）

我也省略了类型注释，因为我通常不写它们。但是当某些东西不起作用时，它们会很有帮助。这是它的样子：

```
 where index' :: Bool
          index' = and [x `elem` a | x <- b] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T08:56:56.263

Haskell 中的`if`构造是一个表达式。这意味着它必须始终评估为一个值，因此该`else`部分是强制性的。

此外，的第一部分`if`必须是布尔值，所以你不能`index'`在那里调用，因为它返回 a `[Int]`，而不是 a `Bool`。

我会说，从这样的事情开始：

```
if isEmpty a
then putStrLn "a is empty"
else if isEmpty b
     then putStrLn "b is empty"
     else putStrLn "neither are empty" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T08:50:56.963

Haskell 中的 IO 操作有点困难，因为它们需要所谓的[monads](http://en.wikibooks.org/wiki/Haskell/Understanding_monads) 你需要一个特殊的`do`-notion 来对输出进行排序。

像这样写：

```
empty [] = True
empty _ = False

index a b = do
         if empty a
          then do putStrLn "a is empty"
          else return ()
         if empty b
          then do putStrLn "b is empty"
          else return () 
```

或者也许你可以只返回字符串并`putStrLn`单独使用。`index'`当它应该用作 if 条件时，您必须返回一个布尔值！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T08:55:18.187

```
index a b = if index' [] bs
                       then putStrLn "a is empty"
                       if index' a []          
                        then putStrLn "b is empty"
                        else                  
    where 
        index' :: [String] -> [String] -> [Int]
        index' a b = index' True [(elem x b) | x <- a] 
```

如果你像这样缩进你的语句，你会看到第一个 if 没有匹配的 else 子句。

此外，else 子句不返回任何内容——函数在任何情况下都应该有返回值。

# c++ - 如何获取数组的大小？

> ID：874169
> 
> 赞同：12
> 
> 时间：2009-05-17T08:43:49.210
> 
> 标签：c++, arrays

在 C# 中，我使用嵌入到要获取其大小的数组中的 Length 属性。如何在 C++ 中做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-17T09:30:10.300

这真的取决于你所说的“数组”是什么意思。C++ 中的数组的大小（现在意味着“原始”字节大小）等于一项大小的 N 倍。通过该`sizeof`操作符可以很容易地得到项目的数量。但这要求您仍然可以访问该数组的类型。一旦你将它传递给函数，它将被转换为指针，然后你就迷路了。再也无法确定大小。您将不得不构建一些其他方式，依赖于元素的值来计算大小。

这里有些例子：

```
int a[5];
size_t size = (sizeof a / sizeof a[0]); // size == 5

int *pa = a; 
```

如果我们现在丢失了名称“a”（以及它的类型），例如通过将“pa”传递给一个函数，而该函数只有那个指针的值，那么我们就不走运了。然后我们就不能再收到这个尺寸了。我们需要将大小与指向该函数的指针一起传递。

当我们使用`new`. 它返回一个指向该数组元素的指针，因此大小将丢失。

```
int *p = new int[5];
  // can't get the size of the array p points to. 
delete[] p; 
```

它不能返回包含数组类型的指针，因为创建的数组的大小`new`可以在运行时计算。但是 C++ 中的类型必须在编译时设置。因此，`new`删除该数组部分，并返回一个指向元素的指针。请注意，您不需要`new`在 C++ 中搞乱。您可以`std::vector`按照另一个答案的建议使用模板。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-17T08:45:09.583

C/C++ 中的数组不会将它们的长度存储在内存中，因此不可能仅在给定数组指针的情况下找到它们的大小。在这些语言中使用数组的任何代码都依赖于一个恒定的已知大小，或者一个单独的变量被传递来指定它们的大小。

如果确实存在问题，一个常见的解决方案是使用[`std::vector`](http://www.cplusplus.com/reference/stl/vector/)标准库中的类，它更接近托管 (C#) 数组，即存储它的长度，另外还有一些有用的成员函数（用于搜索和操纵）。

使用`std::vector`，您可以简单地调用`vector.size()`以获取其大小/长度。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T10:02:04.343

要计算静态数组中元素的数量，可以创建一个模板函数：

```
template < typename T, size_t N >
size_t countof( T const (&array)[ N ] )
{
    return N;
} 
```

对于标准容器，例如`std::vector`，使用该`size()` *函数*。这种模式也用于[boost 数组](http://www.boost.org/doc/libs/1_39_0/doc/html/array.html)，它们是固定大小的数组，声称不会比静态数组更差。您在上面评论中的代码应该是：

```
for ( std::vector::size_type i(0); i < entries.size(); ++i ) 
```

（假设循环中的大小发生变化，否则将其提升，）而不是将大小视为成员变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T09:10:26.323

Als Nolrodin 在上面指出，如果您只有一个指向其第一个元素的指针，那么在 C++ 中获取普通数组的大小几乎是不可能的。但是，如果您有一个固定大小的数组，则有一个众所周知的 C 技巧可以在编译时计算出数组中元素的数量，即通过执行以下操作：

```
`GrmblFx loadsOfElements[1027];
GrmblFx_length = sizeof(loadsOfElements)/sizeof(GrmblFx);` 
```

 `* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T08:47:55.613

在 C/C++ 中，数组只是指向数组中第一个元素的指针，因此无法跟踪元素的大小或 #。如果需要使用它，则必须传递一个指示数组大小的整数。

**通过使用 strlen() 函数，可以确定**字符串的长度，假设它们以 null 结尾，但这只会计算到 \0 字符。

# php - 我的服务器中的文件上传问题

> ID：874177
> 
> 赞同：1
> 
> 时间：2009-05-17T08:49:03.410
> 
> 标签：php

我正在尝试使用 php 上传文件。我正在使用函数 move_uploaded_file。但是它在我的本地机器上工作正常，但是当我在服务器上测试它时，它不工作。我怎么知道我的服务器中缺少什么。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T10:10:58.223

1.  `file_uploads`必须是**On**。
2.  您不得超过`upload_max_filesize`上传文件的大小。
3.  您不得超过`post_max_size`您提交的数据的数量。
4.  你也不能超过`max_input_time`。
5.  确保 apache 使用的用户具有在目标目录中写入文件的权限。

检查这些变量`php.ini`是否与您的本地服务器同步，或者，如果您无权访问目标服务器的设置，请使您的本地变量相同并继续处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T08:55:50.727

每当您遇到 PHP 问题时，我建议您查看 Web 服务器的日志文件。在这种情况下，我认为可能是 PHP 配置。检查您的 PHP 配置并确保在 Web 服务器上允许文件上传。PHP 配置存储在 php.ini 文件中。要了解更多信息，请创建一个简单的 php 文件，例如 info.php 并在其中输入以下行：

```
<?php
    phpinfo();
?> 
```

将 info.php 上传到您的服务器并在您的网络浏览器中打开该页面。尝试找到“file_uploads”。它应该是“开”的。如果它关闭，请找到您的 php.ini 文件并将“file_uploads”的值更改为“on”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T08:51:51.313

检查 php_info() 的输出以查看服务器是否允许文件上传 - 'file_uploads' 属性。如果不是，则必须将其配置为允许。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T14:21:13.957

我在上传文件时遇到问题，但它没有授予文件权限，因此如果您尝试从浏览器打开它们，它会显示为它们不存在。您可能想检查一下是否发生了这种情况。

# php - PHP：对数组进行排序

> ID：874181
> 
> 赞同：4
> 
> 时间：2009-05-17T08:52:48.130
> 
> 标签：php, arrays, sorting, nested-sets

我有一个数组，其中包含来自嵌套集模型中的 MySQL 表的数据，我想排序，不仅按字母顺序排序，而且子节点也直接在父节点之后。示例 - 要排序的数组（排序前）：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [name] => Kompetenser
            [parent] => 0
            [depth] => 0
        )

    [1] => Array
        (
            [id] => 2
            [name] => Administration
            [parent] => 1
            [depth] => 1
        )

    [2] => Array
        (
            [id] => 11
            [name] => Organisation
            [parent] => 2
            [depth] => 2
        )

    [3] => Array
        (
            [id] => 4
            [name] => Arbetsledning
            [parent] => 2
            [depth] => 2
        )

    [4] => Array
        (
            [id] => 17
            [name] => Planering
            [parent] => 2
            [depth] => 2
        )

    [5] => Array
        (
            [id] => 9
            [name] => Hantverke
            [parent] => 1
            [depth] => 1
        )

    [6] => Array
        (
            [id] => 10
            [name] => Snickeri
            [parent] => 9
            [depth] => 2
        )

    [7] => Array
        (
            [id] => 12
            [name] => Språk
            [parent] => 1
            [depth] => 1
        )

    [8] => Array
        (
            [id] => 13
            [name] => Tolk
            [parent] => 12
            [depth] => 2
        )

    [9] => Array
        (
            [id] => 15
            [name] => Arabiska
            [parent] => 13
            [depth] => 3
        )

    [10] => Array
        (
            [id] => 14
            [name] => Persiska
            [parent] => 13
            [depth] => 3
        )

    [11] => Array
        (
            [id] => 16
            [name] => Polska
            [parent] => 13
            [depth] => 3
        )

    [12] => Array
        (
            [id] => 18
            [name] => Apotekare
            [parent] => 1
            [depth] => 1
        )

    [13] => Array
        (
            [id] => 19
            [name] => Dotkorand
            [parent] => 1
            [depth] => 1
        )

    [14] => Array
        (
            [id] => 21
            [name] => Atomfysik
            [parent] => 19
            [depth] => 2
        )

    [15] => Array
        (
            [id] => 20
            [name] => Fysik
            [parent] => 19
            [depth] => 2
        )

    [16] => Array
        (
            [id] => 22
            [name] => Ekonom
            [parent] => 1
            [depth] => 1
        )

    [17] => Array
        (
            [id] => 23
            [name] => Industriell ekonomi
            [parent] => 22
            [depth] => 2
        )

    [18] => Array
        (
            [id] => 24
            [name] => Filosofi
            [parent] => 1
            [depth] => 1
        )

) 
```

我想要这样的数组（排序后）：

```
Array
(
    [0] => Array
        (
            [id] => 1
            [name] => Kompetenser
            [parent] => 0
            [depth] => 0
        )

    [1] => Array
        (
            [id] => 2
            [name] => Administration
            [parent] => 1
            [depth] => 1
        )

    [3] => Array
        (
            [id] => 4
            [name] => Arbetsledning
            [parent] => 2
            [depth] => 2
        )

    [2] => Array
        (
            [id] => 11
            [name] => Organisation
            [parent] => 2
            [depth] => 2
        )

    [4] => Array
        (
            [id] => 17
            [name] => Planering
            [parent] => 2
            [depth] => 2
        )

    [12] => Array
        (
            [id] => 18
            [name] => Apotekare
            [parent] => 1
            [depth] => 1
        )

    [13] => Array
        (
            [id] => 19
            [name] => Dotkorand
            [parent] => 1
            [depth] => 1
        )

    [14] => Array
        (
            [id] => 21
            [name] => Atomfysik
            [parent] => 19
            [depth] => 2
        )

    [15] => Array
        (
            [id] => 20
            [name] => Fysik
            [parent] => 19
            [depth] => 2
        )

    [16] => Array
        (
            [id] => 22
            [name] => Ekonom
            [parent] => 1
            [depth] => 1
        )

    [17] => Array
        (
            [id] => 23
            [name] => Industriell ekonomi
            [parent] => 22
            [depth] => 2
        )

    [18] => Array
        (
            [id] => 24
            [name] => Filosofi
            [parent] => 1
            [depth] => 1
        )

    [5] => Array
        (
            [id] => 9
            [name] => Hantverke
            [parent] => 1
            [depth] => 1
        )

    [6] => Array
        (
            [id] => 10
            [name] => Snickeri
            [parent] => 9
            [depth] => 2
        )

    [7] => Array
        (
            [id] => 12
            [name] => Språk
            [parent] => 1
            [depth] => 1
        )

    [8] => Array
        (
            [id] => 13
            [name] => Tolk
            [parent] => 12
            [depth] => 2
        )

    [9] => Array
        (
            [id] => 15
            [name] => Arabiska
            [parent] => 13
            [depth] => 3
        )

    [10] => Array
        (
            [id] => 14
            [name] => Persiska
            [parent] => 13
            [depth] => 3
        )

    [11] => Array
        (
            [id] => 16
            [name] => Polska
            [parent] => 13
            [depth] => 3
        )

) 
```

如您所见，我希望所有父级为 2 的帖子都紧跟在 id 为 2 的帖子之后，依此类推。

任何帮助将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T09:15:59.853

***不要在 PHP 中这样做！***

MySQL 服务器专门设计用于查询和排序数据，阅读 MySQL“ [ORDER BY](http://dev.mysql.com/doc/refman/5.0/en/sorting-rows.html) ”语法。在 MySQL 服务器上执行此操作将节省运行时间、CPU 负载和内存消耗。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T09:16:21.693

使用php的`uasort()`函数定义自己的比较函数。

但是，如果可能的话，使用 MySQL 的排序功能会更合适。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T20:05:16.273

您想像在数据库中一样对其进行排序，多层。我不认为 uasort 可以帮助解决这个问题，因为您想将孩子附加到父母身上。

```
foreach ($arr as &$val) {
    $arr2[$val['id']] = &$val;
}

ksort($arr2);

foreach ($arr2 as $id => &$val) {
    $parent = $val['parent'];
    if ($parent == 0) {
        continue;
    }
    $arr2[$parent]['children'][$id] = &$val;
}

function flattenArrayByChildren($arr) {
    foreach ($arr as $id => $val) {
        if (isset($val['children'])) {
            $temp = flattenArrayByChildren($val['children']);
            unset($val['children']);
            $out[$id] = $val;
            $out = $out + $temp;
        } else {
            $out[$id] = $val;
        }
    }
    return $out;
}

$arr2 = array(1 => $arr2[1]);

$out = flattenArrayByChildren($arr2);

var_dump($out); 
```

如果您绝对想保存密钥，您可以将其添加到第一个 foreach 中的 $val 中，然后在递归函数 flattenArrayByChildren 中检索它并用作密钥。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T17:13:45.330

问题解决了——我做了两个简单的函数。我希望其他人也可以使用它：

```
class data_comp
{
    var $fetched_tree = array();

    function tree_fetch($parent = 0)
    {
        $query = 'SELECT node.id, node.name, node.parent, (COUNT(parent.name) - 1) AS depth FROM test_competence AS node, test_competence AS parent WHERE node.lft BETWEEN parent.lft AND parent.rgt GROUP BY node.name ORDER BY node.name';
        $result = mysql_query($query) or die(mysql_error());
        $tree = array();

        while($data = mysql_fetch_assoc($result))
        {
            $tree[$data['parent']][$data['id']] = array('name' => $data['name'], 'depth' => $data['depth']);
        }

        $this->tree_print($tree, $parent);
    }

    function tree_print($tree, $parent)
    {
        foreach($tree[$parent] as $id => $value)
        {
            $this->fetched_tree[] = array('id' => $id, 'name' => $value['name'], 'depth' => $value['depth']);

            if(isset($tree[$id]) && is_array($tree[$id]))
            {
                $this->tree_print($tree, $id);
            }
        }
    }
} 
```

感谢您的时间。任何改进都非常受欢迎。

# c - c中的ftruncate trunc文件找不到这个函数

> ID：874182
> 
> 赞同：2
> 
> 时间：2009-05-17T08:53:30.110
> 
> 标签：c, windows, file

我想用 FILE * 截断类似 setsizeof() 的文件 * 我正在开发 vs 2003 windows

```
#include <unistd.h> there's no such lib 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T14:12:05.210

_chsize 函数可以更好地完成工作，它将 fd ans 大小更改为

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T09:34:53.037

C 标准中有许多（大约 20 个）头文件，而 unistd 不是其中之一（它是 POSIX/UNIX95/UNIX98 头文件）。所以没有要求供应商提供它。C89 和 C99 都没有作为强制的头文件之一。

截断文件的最简单方法是以写入模式重新打开它（假设您有文件名）。

```
fclose (fh);
fh = fopen ("file_name", "w"); 
```

如果您只有文件句柄，则需要使用`freopen()`. `EINVAL`只有模式不正确，您才会得到。您不能更改模式，除非根据下表：

```
r        -> r
w a      -> a w
r+ w+ a+ -> any mode 
```

有关详细信息，请参阅[man freopen](http://www.manpagez.com/man/3/freopen/)。

# jquery - jQuery 高级选择器

> ID：874189
> 
> 赞同：0
> 
> 时间：2009-05-17T08:59:46.910
> 
> 标签：jquery, dom, jquery-selectors

我可以在 jQuery 选择器方法中使用比较语句吗？
例如。
我有一个由 php 生成的 div 列表，它们都使用相同的 CSS 类，但具有 1、2、3 等值属性。我还有一个带有 id 的文本输入字段。此字段只能接受数字。我想选择具有与放入文本输入框中的值相匹配的值属性的 div（从长列表中）。
我可以这样写吗：
$( '$(".someClass").val() == $("input#someId").val()' )

？？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T09:12:17.957

```
$('.someClass').filter(function() {
    return $(this).attr('value') == $('input#someId').val() ;
 }) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T09:44:25.167

查看 CSS3 选择器页面：[http](http://www.w3.org/TR/css3-selectors/) ://www.w3.org/TR/css3-selectors/ 。

推荐选择器：E[foo="bar"]，如 '.class[value="'+$('#inputId').val()+'"]'。

注意：未测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T09:50:53.183

它只是一个标准的 jquery 选择器：[attributeEquals](http://docs.jquery.com/Selectors/attributeEquals#attributevalue)

```
<html>
<head>
    <title>Just a test</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        $('#txtValue').change(function(){
            $('.selectMe').css('color', 'black');
            $('.selectMe[value= '+$(this).val()+']').css('color', 'red');
        });     
    });
    </script>
</head>
<body>
    <input type="text" id="txtValue" value=""/>
    <div class="selectMe" value="1">one</div>
    <div class="selectMe" value="2">two</div>
    <div class="selectMe" value="3">three</div>
</body>
</html> 
```

# iphone - 重新加载 UITableView 的问题

> ID：874191
> 
> 赞同：1
> 
> 时间：2009-05-17T09:03:22.550
> 
> 标签：iphone

我有一个由数组填充的 UITableView，我在导航栏上有一个按钮（按下时）向数组添加一个项目并在 UITableView 中调用 [self.tableView reloadData]。这导致 numberOfRowsInSection 被调用并返回正确的行数（数组中的项目数）但不调用 cellForRowAtIndexPath。我创建了一个新的基于导航的应用程序来尝试找到解决方案，但遇到了完全相同的问题！如果有人知道答案，将不胜感激，我最后一天一直在扯掉我剩下的头发！我已将测试项目的源代码放在我的网站 www.sofaracing.com/Downloads/Test3.zip

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T12:18:57.557

为我工作！;)

在 MainWindow.xib 中，您添加了一个对象根视图控制器（不是导航控制器的一部分） - 删除它，没有必要。然后将outlet refreshFriendsList 连接到RootViewController 的NavigationItem 的Bar Button。哇啦，魔法！

顺便说一句：您可能需要清理警告。您可能想考虑为您的数据模型创建一个类，而不是使用 UIApplication sharedApplication。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T11:51:43.893

我很快调试了您的测试应用程序。我找不到根本原因，但由于 Interface Builder 设置中的一些混乱，您似乎有两个不同的表视图。

如果使用项目初始化原始数组，则正确调用 cellForRowAtIndexPath。如果您在此调用中检查 self.tableView 实例，并在随后调用 refreshFriendsList 时检查 self.tableView 实例，则 self.tableView 指向不同的实例。

```
2009-05-17 14:33:07.591 Test3[33580:20b] cellForRowAtIndexPath 0
2009-05-17 14:33:07.594 Test3[33580:20b] self.tableView: <UITableView: 0x52b9b0>
2009-05-17 14:42:36.810 Test3[33762:20b] numberOfRowsInSection: tableView <UITableView: 0x53bcd0> 
```

# ruby - 未找到续集模型 set_schema

> ID：874203
> 
> 赞同：4
> 
> 时间：2009-05-17T09:10:42.703
> 
> 标签：ruby, sequel

任何人都可以自愿为什么以下课程失败？

```
... src/model/user.rb:18: undefined method `set_schema' for User:Class (NoMethodError) 
```

我查看了 Sequel-3.0 lib/ 文件夹，该`set_schema`方法在`ClassMethods`模块中定义。

我确信解决方案很简单。我在想它应该“按原样”工作：

```
require 'sequel'

class User < Sequel::Model(:user)

  set_schema do
    set_primary_key :id
    String          :name
  end 
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-01T11:40:06.727

推荐方式...

```
LOGGER = Object.new()
def LOGGER.method_missing( name, args )
    puts "[#{name}] #{args}"
end

Sequel::Model.plugin(:schema)                       # I worked this out, but I can't find it documented

DB = Sequel.sqlite('sql_test.db', :loggers => [LOGGER] )

unless  DB.table_exists?( :user ) 
    DB.create_table :user  do
        set_primary_key :id
        String          :name
        String          :password
        String          :eMail
    end #create_table
end #table exists
class User < Sequel::Model(:user) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T07:22:34.330

答案是调用插件进行模式管理。即。

```
require 'sequel'
require 'logger'

LOGGER = Object.new()
def LOGGER.method_missing( name, args )
    puts "[#{name}] #{args}"
end

**Sequel::Model.plugin(:schema)**            # I still didn't find this documented

DB = Sequel.sqlite('sql_test.db', :loggers => [LOGGER] )

class User < Sequel::Model(:user)

  set_schema do
    set_primary_key :id
    String          :name
  end 
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T15:49:54.037

`Sequel::Model.plugin(:schema)`是的也为我工作。在文档中看不到它，我很困惑为什么，因为我有另一个工作项目可以`set_schema`毫不费力地使用。

# javascript - 为什么我可以将命名属性添加到数组中，就好像它是一个对象一样？

> ID：874205
> 
> 赞同：108
> 
> 时间：2009-05-17T09:11:29.503
> 
> 标签：javascript, arrays, object, javascript-objects

以下两个不同的代码片段似乎与我等效：

```
var myArray = Array();
myArray['A'] = "Athens";
myArray['B'] = "Berlin"; 
```

和

```
var myObject = {'A': 'Athens', 'B':'Berlin'}; 
```

因为它们的行为相同，而且`typeof(myArray) == typeof(myObjects)`（都产生“对象”）。

**这些变体之间有什么区别吗？**

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-05-17T09:29:11.647

实际上，javascript 中的所有内容都是一个对象，因此您可以通过在其上设置任意属性来“滥用”一个[Array](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/Array)对象。这[应该被认为是有害](http://andrewdupont.net/2006/05/18/javascript-associative-arrays-considered-harmful/)的。数组用于数字索引数据 - 对于非数字键，使用对象。

这是一个更具体的示例，为什么非数字键不“适合”数组：

```
var myArray = Array();
myArray['A'] = "Athens";
myArray['B'] = "Berlin";

alert(myArray.length); 
```

这不会显示“2”，而是“0”——实际上，没有向数组添加任何元素，只是向数组对象添加了一些新属性。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-17T09:17:23.483

在 JS 中，数组是对象，只是稍作修改（增加了一些函数）。

像这样的功能：

```
concat
every   
filer
forEach
join
indexOf
lastIndexOf
map
pop
push
reverse
shift
slice
some
sort
splice
toSource
toString
unshift
valueOf 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T09:31:55.243

JavaScript 中的一切都是原始类型之外的对象。

编码

```
var myArray = Array(); 
```

创建 Array 对象的实例，同时

```
var myObject = {'A': 'Athens', 'B':'Berlin'}; 
```

创建 Object 对象的实例。

试试下面的代码

```
alert(myArray.constructor)
alert(myObject.constructor) 
```

所以你会看到不同之处在于对象构造函数的类型。

Array 对象的实例将包含 Array 原型的所有属性和方法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-05-17T20:06:13.587

我认为，我对之前的回答过于隐喻和神秘。澄清如下。

Array、Boolean、Date、Function、Number、RegExp、String 的实例是一个对象，但增强了针对每种类型的方法和属性。例如，数组具有预定义`length`属性，而通用对象则没有。

```
javascript:alert([].length+'\n'+{}.length) 
```

显示

```
0
不明确的

```

从本质上讲，FF Gecko 解释器还区分了数组和通用对象，它们在评估语言结构时存在明显差异。

```
javascript:
  ra=[  "one",   "two",   "three"]; ra.a=4;
  ob={0:"one", 1:"two", 2:"three"}; ob.a=4;
  alert(
    ra            +"\n\n"+
    ob            +"\n\n"+
    ra.toSource() +"\n\n"+
    ra.a          +"\t .toSource() forgot me! \n\n"+
    ra.length     +"\t and my length! \n\n"+
    ob.toSource());
  ps=""; for(i in ra)ps+=i+" "; alert(ps);  /* NB .length is missing! */
  ps=""; for(i in ob)ps+=i+" "; alert(ps); 
```

显示

```
一二三

[对象对象]

[“一二三”]

4 .toSource() 忘记了我！

3和我的长度！

({0:"一", 1:"二", 2:"三", a:4})

```

和`0 1 2 a`和`0 1 2 a`。

关于所有对象都是函数的说法：

将任意对象实例用作函数（如`123()`or `"abc"()`or `[]()`or or `{}()`or `obj()`where`obj`是除 之外的任何类型）在语法上和语义上都不正确`Function`，因此任意对象实例不是`Function`. 但是，给定一个对象`obj`，它的类型为 as `Array, Boolean, Date, ...`，怎么`obj`会变成 as `Array, Boolean, Date, ...`？什么是`Array, Boolean, Date, ...`?

```
javascript:
    alert([Array, Boolean, Date, Function, 
              Number, Object, RegExp, String] . join('\n\n') ); 
```

显示

```
function Array() {
    [native code]
}

function Boolean() {
    [native code]
}

function Date() {
    [native code]
}

function Function() {
    [native code]
}

function Number() {
    [native code]
}

function Object() {
    [native code]
}

function RegExp() {
    [native code]
}

function String() {
    [native code]
} 
```

在任何情况下，对象类型都毫不含糊地表现为`function`定义，因此声明所有对象都是函数！（开玩笑的是，我故意模糊和模糊了对象实例与其类型的区别！不过，这表明“你不能没有另一个”，对象和函数！大写强调类型为反对实例。）

函数范式和对象范式似乎都是 JS 解释器低级内置原语（例如`Math`and`JSON`和）的编程和实现的基础`true`。

```
 javascript:alert([Math, JSON, true.toSource()].join("\n\n")); 
```

显示

```
[object Math]

[object JSON]

(new Boolean(true)) 
```

* * *

在开发 Javascript 时，以对象为中心的编程风格（OOP's - Object Oriented Programming style - “'s” 是我自己的双关语！）很流行，解释器同样被命名为 Java，以赋予它更大的可信度. 函数式编程技术被降级为更抽象和深奥的考试，研究自动机、递归函数、形式语言等理论，因此不受欢迎。然而，这些形式考虑的优势在 Javascript 中明显体现出来，特别是在 FF 的 Gecko 引擎（即 . `.toSource()`）中实现。

* * *

Function 的 Object 定义特别令人满意，因为它被定义为递归关系！使用它自己的定义来定义！

`function Function() { [native code] }`
并且由于一个函数是一个对象，所以同样的情绪也适用于
`function Object() { [native code] }`。

大多数其他定义停顿为静态终端值。但是，`eval()`它是一个特别强大的原语，因此 String 也可以嵌入任意功能。

再次注意，上面使用的白话掩盖了对象类型和实例的区别。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-01-23T08:36:38.930

您可以将命名属性添加到 javascript 中的几乎任何内容，但这并不意味着您应该这样做。 `Array`如果您想要使用关联数组，请在 javascript 中将其用作列表`Object`。

请注意，如果您真的想使用`Array`命名属性而不是`Object`这些属性，则在循环中将无法访问，`for...of`并且当 JSON 对其进行编码以传递它时，您也可能会得到意想不到的结果。请参阅下面的示例，其中所有**非数字**索引都被忽略：

```
let arr = [];
let obj = {};

arr['name'] = 'John';
obj['name'] = 'John';

console.log(arr);    // will output [name: "John"]
console.log(obj);    // will output {name: "John"}

JSON.stringify(arr); // will return [] <- not what you expected
JSON.stringify(obj); // will return {"name":"John"} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-04-19T06:51:48.950

JavaScript 中数组和其他对象的区别。虽然数组有一个神奇的更新长度属性，但对于数组以外的对象，没有办法实现这样的属性。

```
var arrName = [];
arrName[5] = "test";
arrName.length; // <- 6 
```

数组用于存储具有序数索引的事物 - 像传统数组、堆栈或队列一样使用它。对象是一个散列 - 将它用于具有不同键的数据。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-17T18:20:59.277

在 JavaScript 中，数组是特殊类型的对象

```
typeof new Array(); // returns "object" 
typeof new Object(); // returns "object 
```

使用编号索引的数组和使用命名索引的对象

所以我们可以将命名属性添加到 Array

```
const arr = []
arr["A"] = "Hello" //["A":"Hello"]

console.log(arr.length) // 0 
```

arr.length 返回 0 ，因为具有命名索引的数组更喜欢调用 Objects

```
console.log(Object.keys(clothing)); // ["A"]
console.log(Object.keys(clothing).length); //1 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-17T09:14:33.833

-notation`{}`只是语法糖，使代码更好;-)

JavaScript 有很多类似的构造，比如函数的构造，其中 function() 只是

```
var Func = new Function("<params>", "<code>"); 
```

# c# - 跟踪列表框中的项目

> ID：874220
> 
> 赞同：1
> 
> 时间：2009-05-17T09:18:13.387
> 
> 标签：c#, .net, winforms

我是 .net 新手，开始一个有趣的项目。我正在使用填充了一些城市名称的列表框，以便用户可以选择一个。每个城市类别都有名称和 UID。我怎么知道哪个城市用户点击了？显然，我可以获取所选项目的文本，遍历城市列表并按名称找到一个，但这似乎很愚蠢。

是否有相当于 MFC SetItemDataPtr 类型的东西或者最常见的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T09:30:00.083

假设您指的是 WinForms [`ListBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.aspx)，这可以通过以下方式完成。

与其将 设置`Items`为`ListBox`字符串的数组/集合（正如我假设您当前正在做的那样），不如将其设置为用户定义类型的集合（`City`在您的情况下），然后使用[`DisplayMember`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listcontrol.displaymember.aspx)属性（设置to或您要显示的类`Name`的任何属性），以便实际上可以将每个项目作为用户定义的对象访问，而它仍然由其属性显示。`City``ListBox``City``Name`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T13:51:02.643

我会使用 ListView（在详细信息模式下）而不是 ListBox。然后你可以使用 ListViewItem 的 Tag 属性，它相当于 MFC 的 SetItemDataPtr。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T09:27:31.027

您可以通过以下代码获取用户选择的项目：

```
list1.SelectedItem;

//text -> list1.SelectedItem.Text
//value-> list1.SelectedItem.Value 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T09:34:29.213

您可以为 ListBox 提供自己定义的项目类型，因为它接受一个`Object`，最好是实现一个`ToString()`方法。它可以是具有 ID 和 Name 属性的对象，因此可以使用 ListBox 的`SelectedItem`属性访问它们。

# java - Android 项目使用 httpclient --> http.client (apache), post/get 方法

> ID：874227
> 
> 赞同：9
> 
> 时间：2009-05-17T09:22:17.013
> 
> 标签：java, android, http, apache-httpclient-4.x

我正在为一个 android 项目执行 Get 和 Post 方法，我需要将 HttpClient 3.x“翻译”为 HttpClient 4.x（由 android 使用）。我的问题是我不确定我做了什么，我没有找到某些方法的“翻译”......

这是我已经完成的 HttpClient 3.x 和 (-->) HttpClient 4.x “翻译”（如果我找到的话）（仅限向我提出问题的各方）：

```
HttpState state = new HttpState (); --> ?

HttpMethod method = null; --> HttpUriRequest httpUri = null;

method.abort(); --> httpUri.abort(); //httpUri is a HttpUriRequest

method.releaseConnection(); --> conn.disconnect(); //conn is a HttpURLConnection

state.clearCookies(); --> cookieStore.clear(); //cookieStore is a BasicCookieStore

HttpClient client = new HttpClient(); --> DefaultHttpClient client = new DefaultHttpClient();

client.getHttpConnectionManager().getParams().setConnectionTimeout(SOCKET_TIMEOUT) --> HttpConnectionParams.setConnectionTimeout(param, SOCKET_TIMEOUT);

client.setState(state); --> ?

client.getParams().setCookiePolicy(CookiePolicy.RFC_2109); --> HttpClientParams.setCookiePolicy(param, CookiePolicy.RFC_2109);

PostMethod post = (PostMethod) method; --> ?

post.setRequestHeader(...,...); --> conn.setRequestProperty(...,...);

post.setFollowRedirects(false); --> conn.setFollowRedirects(false);

RequestEntity tmp = null; --> ?

tmp = new StringRequestEntity(...,...,...); --> ?

int statusCode = client.executeMethod(post); --> ?

String ret = method.getResponsBodyAsString(); --> ?

Header locationHeader = method.getResponseHeader(...); --> ?

ret = getPage(...,...); --> ? 
```

我不知道这是否正确。这引起了问题，因为包的名称不同，一些方法也不同。我只需要文档（我还没有找到）和很少的帮助。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-01-20T03:41:07.953

这是[HttpClient 4 文档](http://hc.apache.org/httpcomponents-client-ga/index.html)，这就是 Android 正在使用的（4，不是 3，从 1.0->2.x 开始）。文档很难找到（感谢 Apache ;)），因为 HttpClient 现在是 HttpComponents 的一部分（如果你只是寻找 HttpClient，你通常会在 3.x 的东西上结束）。

此外，如果您执行任意数量的请求，您不希望一遍又一遍地创建客户端。相反，正如[HttpClient note 的教程](http://hc.apache.org/httpcomponents-client/tutorial/html/connmgmt.html#d4e604)一样，创建一次客户端并保留它。从那里使用[ThreadSafeConnectionManager](http://hc.apache.org/httpcomponents-client/httpclient/apidocs/org/apache/http/impl/conn/tsccm/ThreadSafeClientConnManager.html)。

我使用了一个辅助类，例如[HttpHelper](http://code.google.com/p/and-bookworm/source/browse/trunk/src/com/totsp/bookworm/data/HttpHelper.java)（它仍然是一个移动的目标——我计划在某个时候将它移动到它自己的 Android util 项目，并支持二进制数据，还没有实现），来帮助这。助手类创建客户端，并为 get/post/etc 提供方便的包装方法。[在Activity](http://developer.android.com/reference/android/app/Activity.html)中使用此类的任何地方，都应该创建一个内部内部[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)（这样在发出请求时就不会阻塞 UI 线程），例如：

```
 private class GetBookDataTask extends AsyncTask<String, Void, Void> {
      private ProgressDialog dialog = new ProgressDialog(BookScanResult.this);

      private String response;
      private HttpHelper httpHelper = new HttpHelper();

      // can use UI thread here
      protected void onPreExecute() {
         dialog.setMessage("Retrieving HTTP data..");
         dialog.show();
      }

      // automatically done on worker thread (separate from UI thread)
      protected Void doInBackground(String... urls) {
         response = httpHelper.performGet(urls[0]);
         // use the response here if need be, parse XML or JSON, etc
         return null;
      }

      // can use UI thread here
      protected void onPostExecute(Void unused) {
         dialog.dismiss();
         if (response != null) {
            // use the response back on the UI thread here
            outputTextView.setText(response);
         }
      }
   } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-24T09:01:49.620

回答我的问题的最简单方法是向您展示我制作的课程：

```
public class HTTPHelp{

    DefaultHttpClient httpClient = new DefaultHttpClient();
    HttpContext localContext = new BasicHttpContext();
    private boolean abort;
    private String ret;

    HttpResponse response = null;
    HttpPost httpPost = null;

    public HTTPHelp(){

    }

    public void clearCookies() {

        httpClient.getCookieStore().clear();

    }

    public void abort() {

        try {
            if(httpClient!=null){
                System.out.println("Abort.");
                httpPost.abort();
                abort = true;
            }
        } catch (Exception e) {
            System.out.println("HTTPHelp : Abort Exception : "+e);
        }
    }

    public String postPage(String url, String data, boolean returnAddr) {

        ret = null;

        httpClient.getParams().setParameter(ClientPNames.COOKIE_POLICY, CookiePolicy.RFC_2109);

        httpPost = new HttpPost(url);
        response = null;

        StringEntity tmp = null;        

        httpPost.setHeader("User-Agent", "Mozilla/5.0 (X11; U; Linux " +
            "i686; en-US; rv:1.8.1.6) Gecko/20061201 Firefox/2.0.0.6 (Ubuntu-feisty)");
        httpPost.setHeader("Accept", "text/html,application/xml," +
            "application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5");
        httpPost.setHeader("Content-Type", "application/x-www-form-urlencoded");

        try {
            tmp = new StringEntity(data,"UTF-8");
        } catch (UnsupportedEncodingException e) {
            System.out.println("HTTPHelp : UnsupportedEncodingException : "+e);
        }

        httpPost.setEntity(tmp);

        try {
            response = httpClient.execute(httpPost,localContext);
        } catch (ClientProtocolException e) {
            System.out.println("HTTPHelp : ClientProtocolException : "+e);
        } catch (IOException e) {
            System.out.println("HTTPHelp : IOException : "+e);
        } 
                ret = response.getStatusLine().toString();

                return ret;
                }
} 
```

我用[这个教程](https://hc.apache.org/httpcomponents-client-ga/tutorial/html/)来做我的帖子方法和[那些例子](https://hc.apache.org/httpcomponents-client-ga/examples.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T16:39:06.037

`HTTPClient` [好吧，您可以在此处](http://hc.apache.org/)找到有关该版本的文档；[浏览他们提供的示例场景](http://hc.apache.org/httpcomponents-client-dev/examples.html)特别有用。

不幸的是，我不知道第 3 版，`HTTPClient`所以我不能给出直接的等价物；我建议您采取您正在尝试做的事情并查看他们的示例场景。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T09:29:29.817

```
 package com.service.demo;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class WebServiceDemoActivity extends Activity 
{
    /** Called when the activity is first created. */
    private static String SOAP_ACTION1 = "http://tempuri.org/GetSubscriptionReportNames";//"http://tempuri.org/FahrenheitToCelsius";
    private static String NAMESPACE = "http://tempuri.org/";
    private static String METHOD_NAME1 = "GetSubscriptionReportNames";//"FahrenheitToCelsius";
    private static String URL = "http://icontrolusa.com:8040/iPhoneService.asmx?WSDL";

    Button btnFar,btnCel,btnClear;
    EditText txtFar,txtCel;
    ArrayList<String> headlist = new ArrayList<String>();
    ArrayList<String> reportlist = new ArrayList<String>();

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        btnFar = (Button)findViewById(R.id.btnFar);
        btnCel = (Button)findViewById(R.id.btnCel);
        btnClear = (Button)findViewById(R.id.btnClear);
        txtFar = (EditText)findViewById(R.id.txtFar);
        txtCel = (EditText)findViewById(R.id.txtCel);

        btnFar.setOnClickListener(new View.OnClickListener() 
        {
            @Override
            public void onClick(View v) 
            {
                //Initialize soap request + add parameters
                SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME1);        

                //Use this to add parameters
                request.addProperty("Fahrenheit",txtFar.getText().toString());

                //Declare the version of the SOAP request
                SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);

                envelope.setOutputSoapObject(request);
                envelope.dotNet = true;

                try {
                    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

                    //this is the actual part that will call the webservice
                    androidHttpTransport.call(SOAP_ACTION1, envelope);

                    // Get the SoapResult from the envelope body.
                    SoapObject result = (SoapObject)envelope.bodyIn;

                    if(result != null)
                    {
                        //Get the first property and change the label text
                        txtCel.setText(result.getProperty(0).toString());
                        Log.e("err  ","output is ::::   "+result.getProperty(0).toString());

                        parseSON();
                    }
                    else
                    {
                        Toast.makeText(getApplicationContext(), "No Response",Toast.LENGTH_LONG).show();
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });

        btnClear.setOnClickListener(new View.OnClickListener()
        {
            @Override
            public void onClick(View v) 
            {
                txtCel.setText("");
                txtFar.setText("");
            }
        });
    }

    private void parseSON() {
            headlist.clear();
            reportlist.clear();
            String text = txtCel.getText().toString() ;//sb.toString();
            Log.i("######", "###### "+text);

            try{
                JSONObject jobj = new JSONObject(text);   
                JSONArray  jarr = jobj.getJSONArray("Head");
                for(int i=0;i<jarr.length();i++){
                    JSONObject e = jarr.getJSONObject(i);
                    JSONArray names = e.names();
                    for(int j=0;j<names.length();j++){
                        String tagname = names.getString(j);
                        if (tagname.equals("ReportID")) {
                            headlist.add(e.getString("ReportID"));
                        }
                        if (tagname.equals("ReportName")) {
                            reportlist.add(e.getString("ReportName"));
                        }
                    }
                }    
            } catch(JSONException e){
                Log.e("retail_home", "Error parsing data "+e.toString());
            }

            Log.d("length ", "head lenght "+headlist.size());
            Log.d("value is  ", "frst "+headlist.get(0));
            Log.d("length ", "name lenght "+reportlist.size());
            Log.d("value is  ", "secnd "+reportlist.get(0));

    }
} 
```

# corporate - “影子 IT”在软件开发中的利弊

> ID：874242
> 
> 赞同：3
> 
> 时间：2009-05-17T09:31:28.847
> 
> 标签：corporate

最近，我们看到许多组织中出现了所谓的“<a href="http://en.wikipedia.org/wiki/Shadow_IT" rel="nofollow noreferrer">Shadow IT”。如果您还不熟悉该术语，它指的是那些设法通过使用拇指驱动器共享文件或“未经批准”的软件产品来完成业务任务等手段来规避通常的 IT 治理的人。影子 IT 可以来自技术团队，但在许多情况下来自非技术领域，例如营销或销售部门。

我真正感兴趣的是您在软件开发中的影子 IT 示例。Excel 和 Access 等产品通常是罪魁祸首，因为它们的共性意味着更广泛的组织可以轻松访问它们。在许多情况下，这是由具有足够知识以使软件执行业务功能但不足以了解为企业构建软件时所需的所有通常考虑因素的人驱动的。

您在软件开发领域见证过哪些影子 IT 案例？您看到这种做法非正式地解决了哪些流程以及这些工具变得多么重要？例如，在文件夹共享上使用单个 Access 数据库成为跟踪营销部门促销活动的常见做法。请记住，这是双向的；它可能具有极大的风险（缺乏安全性、灾难恢复等），但它可能会导致来自完全意想不到的来源的创新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T09:33:59.217

好吧，我想这些东西无处不在。如果它不以任何方式威胁公司运营，这没什么大不了的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T09:57:38.393

归根结底，大多数企业的主要驱动力是结果，即赚钱。如果企业看到它可以在不花费数千美元购买软件但通过“影子 IT”的情况下实现运营所需的预期输出，那么我只能看到它受到鼓励。我觉得指出以这种方式操作的陷阱是我们作为开发人员工作的一部分。

“影子 IT”的优点可能是

*   成本 - 更便宜
*   虽然编写软件的人可能不是软件专家，但他们可能是领域专家，并且对软件应该如何运行具有内在的知识。
*   根据 IT 的组​​织方式，“影子 IT”可能能够比核心 IT 更快地响应变化和业务需求。

和缺点

*   所生产的软件可能无法很好地设计为可扩展、正确处理错误以及来自软件开发经验的所有其他方面。
*   该软件可能没有得到很好的支持，或者由于它的制作方式，可能根本没有支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T10:18:17.860

随着时间的推移，普通人越来越精通 IT。年轻的营销人员和财务人员知道 Excel 和 Access 可以大大提高他们的效率。没有他们的工作会让他们感到残疾。

我预计这种趋势将继续下去，企业 IT 将成为一个更加有利的组织。您在哪里提供可用数据，帮助用户解决他们的工作流程，并将他们限制在特定的隔间以确保安全。

10年前所谓的软件开发，10年后将成为每个人的工具！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T12:15:44.180

哪有这回事。有恐龙，也有需要完成工作的人。如果发生“影子 IT”之类的事情，那是因为“官方 IT”没有做好它的工作。

软件开发人员拥有完成工作所需的数百个小应用程序。IT 治理组织应该学习如何每天处理数十个更新，并转而每天发布（每天打几次补丁）。发展已经学会了如何做到这一点，他们是下一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T12:36:59.433

优点是用户可以在他们想要和需要的时候得到他们想要和需要的东西。通过大型 IT 商店获取请求对用户来说是一种尝试。IT 很少有业务知识来让他们准确地向业务所有者提供他们所要求的内容，并且当请求被拒绝或要求被修改时，很少会用简单的英语（或任何语言）进行解释。

弊大于利。法国兴业银行损失了数十亿美元，部分原因是“影子 IT”。例如，当 Access 应用程序变得必不可少并且超出创建它的人的能力或该人离开时，它可能会导致支持噩梦。即使是写得不好的 Crystal Report 也会变得如此流行和广泛使用，以至于在报告时间到来时它开始拖累它正在访问的数据库。如果编写该报告的人不完全了解关系数据库，则在某些情况下可能会产生不良数据；导致做出错误业务决策的数据。使用商业（外包）应用程序保证用户不会得到他们想要的东西；总会有妥协，也没有解释为什么做出妥协。

之前的海报是对的。影子 IT 的存在是因为 IT 工作做得不够好。业务知识不够，反应不够，尤其是沟通不够。这些就是“影子 IT”存在的原因。企业主为机器、管理员、数据库管理员和程序员付费。当 IT 忽视这一点时，他们会感到沮丧。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-03T20:42:19.787

为什么 IT 假定他们应该拥有并控制业务中的所有技术？

我们为 IT 无法控制的技术命名（影子 IT）这一事实表明，我们希望 IT 能够控制组织中的所有技术。

我能想到 IT 拥有控制权的唯一真正原因是安全性（即便如此，我也会非常厌倦将最敏感的数据信任给 IT）。针对业务用户开发的解决方案给出的大多数其他理由都是完全错误的。拿上面的理由来说：“生产的软件可能没有很好的设计……”，“软件可能没有得到很好的支持……”。我们在这里开谁的玩笑？IT 在这些方面的记录根本不足以在此处占据制高点。

精明的业务用户解决了他们自己的信息问题——他们在 IT 出现之前就已经这样做了。有人记得一式三份的表格吗？传真机？复印机？这些东西不需要 IT 部门来管理，而且效果很好。如果 IT 无法解决问题，或者 IT 的跟踪记录很差，以至于业务用户对 IT 失去信心，那么业务用户将使用他们可用的任何手段来解决他们自己的问题。商业用户经常非常成功地使用 Access、Excel 和共享驱动器。如果 IT 要与组织保持相关性，它需要支持其业务用户的需求并提供人们真正想要使用的技术，而不仅仅是人们必须使用的技术。

我见过一个组织，其中数百万美元的门户实施承诺解决许多业务技术和信息共享问题。多年后，仍然没有投入生产，业务用户放弃了，并在绝望中通过外包以数据为中心的 Web 应用程序的开发来开发自己的解决方案。你猜怎么了？它工作得非常出色，其他部门现在正在绕过 IT 并按照自己的部门预算做同样的事情。

IT 是为业务用户提供支持的组织。这可能会冒犯一些认为 IT 在对业务的重要性方面与执行管理层并列的位置的人，但 IT 必须交付业务所需的东西，否则它证明自己的存在是正当的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-03T20:45:41.277

有时，当我公司的资源不足或预置时间过长时，我会使用 Amazon EC2 和/或 RDS。我为此自掏腰包，但确实可以更快地实现我的目标。所有这一切都无需在会议上花费痛苦的时间，试图说服上级或 SA-s 我确实需要做一些事情或其他事情。

在我看来，EC2 是终极的影子 IT。它非常容易上手，并为我提供了终极控制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T10:08:32.847

大多数软件开发人员在他们的计算机上都有“未经批准”的软件。只是期待它。我不确定我有多少，但我确定我有几十个，如果不是数百个公用事业公司。IT 甚至从未听说过我的工作笔记本电脑。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-17T12:31:51.923

是的，我在哪里工作是个大问题。架构师和 DBA 试图建立一个集中式系统，但这些小的“影子 IT”部门制造了这些具有自己的安全性或重复数据的小型应用程序……就个人而言，如果我是 IT 主管，我会解雇任何启动此类项目的人没有 IT 支持。有点苛刻，但保持系统健康很重要。

# python - Python ctypes 和函数指针

> ID：874245
> 
> 赞同：1
> 
> 时间：2009-05-17T09:33:03.243
> 
> 标签：python, function-pointers, ctypes

这与[我的另一个问题有关](https://stackoverflow.com/questions/867850/creating-a-wrapper-for-a-c-library-in-python)，但我觉得我应该在一个新问题中提出它。

基本上，FLAC 使用函数指针进行回调，并使用 ctypes 实现回调，您使用`CFUNCTYPE`它们来原型化它们，然后使用`prototype()`函数来创建它们。

我遇到的问题是我想我会这样创建我的回调函数（我没有显示我重新创建的结构，FLAC__Frame 是一个结构）：

```
write_callback_prototype = CFUNCTYPE(c_int, c_void_p, 
                                     POINTER(FLAC__Frame), 
                                     POINTER(c_int32), v_void_p)
```

我遇到的问题是实施。FLAC__Frame 永远不会被程序员实例化，它只是从初始化函数和处理函数中调用。我必须自己编写回调函数，但他的问题是我不知道我该怎么做，所以如果有人知道我应该怎么做，那么一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T10:27:01.973

根据[ctypes 回调文档](http://docs.python.org/library/ctypes.html#callback-functions)，您可以定义 python 函数

```
def my_callback(a, p, frame, p1, p2)
    pass 
```

然后创建一个指向 C 可调用函数的指针，如下所示：

```
callback = write_callback_prototype(my_callback) 
```

然后可以将此函数指针传递给 FLAC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T11:16:13.463

> 我遇到的问题是实施。FLAC__Frame 永远不会被程序员实例化，它只是从初始化函数和处理函数中调用。我必须自己编写回调函数，但他的问题是我不知道我该怎么做，所以如果有人知道我应该怎么做，那么一些帮助将不胜感激。

在这种情况下，只需使用：

```
import ctypes

class FLAC__Frame(ctypes.Structure):
    pass 
```

并假装它已经被定义了，不要在意，因为你只需要指向它的指针，它基本上是内存中的位置。

# javascript - 动态加载的 js 函数不会出现在 Firebug js 调试器中

> ID：874256
> 
> 赞同：4
> 
> 时间：2009-05-17T09:43:06.120
> 
> 标签：javascript, debugging, jquery, firebug

有一个 page1.html （我在浏览器中打开它）：

```
<div id="content">
</div>
<script type="text/JavaScript">
    jQuery.ajax({
        type : "GET",
        url : 'page2.html',
        dataType : "html",
        success : function(response) {          
            jQuery('#content').append(response);

        }
    });
</script> 
```

page2.html的代码：

```
<script type="text/JavaScript" src="js/page2.js"></script>

<script type="text/JavaScript">
test();
</script> 
```

页面js/page2.js的代码：

```
function test() {
    alert('Function Test()');
} 
```

一切正常，显示窗口“Function Test()”。但问题是我无法在 firebug js 调试器中访问函数 test() 的代码。它既不会出现在事件脚本中，也不会出现在 eval 中。

我该如何解决？

仅供参考：如果我不将函数放在单独的 js 文件中，而是将其放在 page2.html 中，它会正确显示在调试器中。

如果我在 test() 函数中输入“调试器”字样，Firebug 会停止，但该函数的源代码仍然无法访问。

版本：Firefox 3.0.10、Firebug 1.3.3

[更新：与Making Firebug break inside dynamic loaded javascript](https://stackoverflow.com/questions/858779/making-firebug-break-inside-dynamically-loaded-javascript)的问题几乎相同，但还没有答案

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T11:24:57.937

`js/page2.js`这是一个 hack，但我通过添加单词 debugger 两次让 firebug 在外部文件中停止。一次位于文件顶部，另一次位于函数顶部。

如果调试器字在任一位置仅出现一次，则 firebug 不会停止。

```
debugger;
function test() {
    debugger;
    alert('Function Test()');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-06T12:29:42.950

尝试：

```
eval('debugger;'); 
```

它不漂亮，但它似乎工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T11:01:38.443

将 js/page2.js 更改为：

```
function test() {
    alert('Function Test()');
}
alert('loaded'); 
```

您是否看到“已加载”消息？

# pdf - 是否可以让 PowerPoint 2007 将幻灯片导出为包含动画的 PDF？

> ID：874259
> 
> 赞同：3
> 
> 时间：2009-05-17T09:44:35.417
> 
> 标签：pdf, powershell, powerpoint

我正在使用 PowerShell 导出 PowerPoint 演示文稿。这适用于 Office XPS/PDF 导出器插件。但是，只会导出完整的幻灯片，没有动画。

将演示文稿导出为网页时，如果您选中“浏览时显示幻灯片动画”选项（在“Web 选项”下），演示文稿可以逐步运行（例如，逐个显示项目符号点）。

有没有办法通过脚本在演示文稿中的每个动画步骤生成一个 PDF？（如果没有 - 关于如何做的任何提示？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T10:19:21.820

导出为 PDF 时，它将导出简单的文本和图像，因此不存在动画 :(

对于为每个动画生成一个页面的方法，您将不得不探索 Powerpoint 对象模型并使用一些 PDF 生成库（如 iTextSharp）来一一输出所有过渡。

Powerpoint 对象模型在[这里](http://msdn.microsoft.com/en-us/library/aa213568(office.11).aspx)

# vb.net - 如何在 LINQ to SQL 中仅选择日期值无时间？

> ID：874261
> 
> 赞同：0
> 
> 时间：2009-05-17T09:49:47.010
> 
> 标签：vb.net, linq-to-sql, datetime

我需要一个查询，根据数据库中的日期值列出所有用户。问题是这样的，在数据​​库中日期格式是 5/5/2009 4:30:12 但我想与 5/5/2009 进行比较。我认为基于日期的值是 5/5/2009 12:00:00，这就是我无法查询它的原因。

查询类似于

dim db = new databcontext dim user = from db.datacontext 中的 u.signUpTime = 5/5/2009 选择 u。

可能有人请检查这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T09:53:25.347

你的理论是正确的。您应该在 where 子句中使用范围：

```
u.SignupTime >= new DateTime(2009,5,5,0,0,0) AndAlso _
u.SignupTime < new DateTime(2009,5,6,0,0,0) 
```

或仅检查日期：

```
u.SignupTime.Date = new DateTime(2009,5,5) 
```

# perl - 使用 WWW::Mechanize 透明地处理 GZip 编码的内容

> ID：874262
> 
> 赞同：5
> 
> 时间：2009-05-17T09:50:17.197
> 
> 标签：perl, www-mechanize, content-encoding, lwp

我正在使用 WWW::Mechanize 并且当前`Content-Encoding: gzip`通过首先检查响应标头然后使用 IO::Uncompress::Gunzip 来获取未压缩的内容来处理我的代码中带有 ' ' 标头的 HTTP 响应。

但是，我想透明地执行此操作，以便 WWW::Mechanize 方法（如 form()、links() 等）可以处理并解析未压缩的内容。由于 WWW::Mechanize 是 LWP::UserAgent 的子类，因此我更喜欢使用[LWP::UA::handlers](https://metacpan.org/pod/LWP::UserAgent#Handlers)来执行此操作。

虽然我已经部分成功（例如，我可以打印未压缩的内容），但我无法以我可以调用的方式透明地做到这一点

```
$mech->forms(); 
```

总而言之：我如何“替换” $mech 对象中的内容，以便从那时起，所有 WWW::Mechanize 方法都像 Content-Encoding 从未发生过一样工作？

感谢您的关注和帮助。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T11:00:47.400

[WWW::Mechanize::GZip](https://metacpan.org/pod/WWW::Mechanize::GZip)，我想。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T10:51:43.383

在我看来，您可以使用 $res->content( $bytes ) 成员来替换它。

顺便说一句，我通过查看 LWP::UserAgent 的来源，然后是 HTTP::Response，然后是[HTTP::Message](https://metacpan.org/pod/HTTP::Message)找到了这些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-05T09:56:12.037

它内置于 UserAgent 中，因此是 Mechanize。**一个重要的警告**可以为您节省一些头发

- 要调试，请确保在调用 decoded_content 后检查错误**$@ 。**

```
$html = $r->decoded_content;
die $@ if $@; 
```

更好的是，查看 HTTP::Message 的源代码并确保所有支持包都在那里

在我的例子中，decoded_content 返回 undef，而 content 是原始二进制文件，我进行了一场疯狂的追逐。UserAgent 将在解码失败时设置错误标志，但 Mechanize 将忽略它（它不会检查或记录发生率作为自己的错误/警告）。

就我而言，$@ sez：“找不到 IO/HTML.pm .. 它已被评估

在不得不深入研究源代码后，我发现内置的解码过程漫长、细致、艰巨，几乎涵盖了所有场景并进行了大量猜测（谢谢 Gisle！）。

如果您是偏执狂，请在 new() 处明确设置要与每个请求一起使用的默认标头

```
 $browser = new WWW::Mechanize('default_headers' => HTTP::Headers->new('Accept-Encoding' 
                            => scalar HTTP::Message::decodable())); 
```

# java - 我在哪里可以了解 JVM 调试器协议？

> ID：874266
> 
> 赞同：1
> 
> 时间：2009-05-17T09:53:38.233
> 
> 标签：java, debugging, jvm

我想在 c++ 中测试和构建简单的调试器 GUI，当我从查看文档中读取时调试 Java 我将不得不使用 JVM 调试器协议这里有没有人有经验？我在哪里可以了解它？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T09:57:09.863

Sun的[Java 虚拟机调试接口 (JVMDI) 参考](http://java.sun.com/j2se/1.5.0/docs/guide/jpda/jvmdi-spec.html)将是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T09:56:17.837

官方文档的主页在这里：http: [//java.sun.com/javase/technologies/core/toolsapis/jpda/](http://java.sun.com/javase/technologies/core/toolsapis/jpda/)

那里有指向 Java 调试器可以使用的 API 和低级有线协议的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T14:10:36.430

您可以尝试查看 Eclipse Java IDE 项目源代码...这是我用过的最好的 Java 调试器...如果您可以复制这种用户体验，那将是惊人的...

[http://wiki.eclipse.org/CVS_Howto](http://wiki.eclipse.org/CVS_Howto)

# asp.net - 远程加载 extJS 组合不起作用

> ID：874271
> 
> 赞同：0
> 
> 时间：2009-05-17T09:57:46.273
> 
> 标签：asp.net, javascript, extjs

这是我第一次使用 extJS，经过几个小时的努力，有些事情正常，除了我的组合列表在边缘情况下我无法过滤到少于 2000 个项目，所以我正在尝试远程分页列表，但我一定做错了什么。

我的数据存储和组合如下所示：

```
var remoteStore = new Ext.data.JsonStore({
        //autoLoad    : true,
        url         : 'addition-lists.aspx',
        fields      : [{name: 'extension_id'}, {name: 'extension'}],
        root        : 'extensionList',
        id          : 'remoteStore'               
    });
.
.
                        xtype         : 'combo',
                        fieldLabel    : 'Remote',
                        name          : 'remote',
                        displayField  : 'extension',
                        valueField    : 'extension_id',
                        mode          : 'remote', 
                        //pageSize      : 20,
                        triggerAction : 'query',  
                        typeAhead     : true,                    
                        store         : remoteStore,
                        anchor        : '95%' 
```

该组合可以在本地加载，但是一旦我切换到远程，它就会保持空白。

我返回 JSON 的 ASP.NET 页面是这样的：

```
protected void Page_Load(object sender, EventArgs e)
{
    Response.Clear();
    Response.Write(GetRemote());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T13:13:49.047

在远程存储上，组合默认其`minChars`属性为 4，因此只有在输入 4 个字符后才会发送查询。设置`minChars`几乎可以提供所需的行为。

我说几乎是因为即使自动完成搜索的项目在当前页面中，仍然会发送新的服务器查询，默认选择为新页面中的第一项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T08:31:17.413

您在上面配置商店的方式，您的 ASP 脚本的结果应该是这样的：

```
{"extensionList": [
  {"extension_id": 1, "extension": "js"},
  {"extension_id": 2, "extension": "aspx"}
]} 
```

如果看起来不是这样，您的远程商店将找不到任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T10:10:19.300

可以参考这个问题[ExtJS combobox question in IE](https://stackoverflow.com/questions/681995/extjs-combobox-problem-in-ie)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:15:40.777

几件事。首先，当这样做时：

remoteStore.loadData(<%= GetRemote() %>);

您实际上并没有从您的 javascript 进行远程调用。*您在渲染时*将调用 GetRemote 服务器函数的结果直接回显到页面中。可能不是你想要的？如果 GetRemote 正在写出您的组合数据（并且工作正常），那么您应该能够对**本地**数据使用组合设置。如果您的意图确实是进行远程调用，那么您需要删除服务器标签并通过代理 url 加载数据，如 Ext 附带的几个示例所示。

另一件事是您的 Page_Load 代码实际上并没有显示任何有关您如何加载、格式化或返回数据的信息。我建议查看源代码并验证您的标签实际上是否被您期望的数据替换。如果/当您将其切换为真正的远程调用以加载数据时，您可以使用 Firebug 检查您的 XHR 调用并验证以这种方式传下来的数据。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-17T11:08:41.610

~~你必须设置一个代理，即设置~~

`proxy: new ScriptTagProxy`

~~远程加载“商店”的属性。查看示例以了解确切的语法。~~

编辑：请忽略我之前的注释，因为您使用的是 JsonStore 快捷方式。

尝试将所有这些属性应用于您的组合：

```
 typeAhead: true,
   typeAheadDelay: 500,
   triggerAction: 'all',
   selectOnFocus:true, 
```

并且请不要对记录进行服务器端预取（使用 loadData）。它非常伤害内部过滤器，因此您坚持使用来自不同预取的过滤记录。另一方面，如果您确实在服务器端预取所有记录，为什么您还需要远程访问您的组合？！

# java - java在纸上打印-格式化输出以进行打印

> ID：874275
> 
> 赞同：2
> 
> 时间：2009-05-17T10:00:05.957
> 
> 标签：java, printing

我有一个 Java 桌面应用程序，其中包含有关多个实体的信息。有一个“打印”按钮，当按下时应该收集和打印各种信息。

问题是：我如何选择将在纸张上的特定位置打印的内容？

一个更普遍的问题是：我如何格式化要打印在纸上的信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T10:18:19.593

我建议使用[iText](http://www.lowagie.com/iText/)之类的东西来生成 PDF 并打印 PDF。作为奖励，输出可以轻松保存并附加到电子邮件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T13:24:32.720

您需要 Java 打印服务 - [http://java.sun.com/javase/6/docs/technotes/guides/jps/index.html](http://java.sun.com/javase/6/docs/technotes/guides/jps/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T14:04:55.320

我们已经成功地使用了[JasperReports——](http://jasperforge.org/projects/jasperreports)从简单报告到复杂报告的非常棒的工具。支持直接使用实体列表（非常方便），也支持通过 JDBC 甚至 HQL（Hibernate Query Language）进行 RDBMS 通信。它还有一个名为 iReport 的可视化设计工具，因此可以直观地设计报表的外观。

# asp.net - Asp.net jquery post to ascx: 不提供此类页面

> ID：874278
> 
> 赞同：2
> 
> 时间：2009-05-17T10:03:43.263
> 
> 标签：asp.net, jquery

当我尝试使用 Jquery 帖子调用 ascx 时，我得到：“不提供此类页面”我认为这与 IIS 不允许直接调用 ascx 有关。是否可以允许发布到 ascx？我有 IIS6。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T10:06:23.040

不，.ascx 是一个控件，它包含在 .aspx 页面中并呈现。

所以错误是正确的，ascx 不应该被服务。

将其包装在一个 aspx 页面中，如下所示：

```
<%@ Page %>
<%@ Register TagPrefix="scott" TagName="header" Src="Controls/Header.ascx" %>
<scott:Header runat=server id="control1" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-07T07:01:08.380

仅供参考，在 MVC 应用程序中，您实际上可以通过将 URL 指向返回 PartialView 的 Action 来加载 .ascx。

# c# - 字典键中有字符限制吗？

> ID：874285
> 
> 赞同：8
> 
> 时间：2009-05-17T10:09:54.760
> 
> 标签：c#, .net, dictionary, key, key-value

在 .NET 中，我可以使用任何字符串作为字典键吗？这是模板引擎的一部分，我计划允许用户添加他们的自定义标题和值。

标题将类似于“X 值”或“分析和 XYZ 报告摘要”，我担心它们是否会在罕见字符或类似字符中出现异常。

我假设有大小限制，但希望它大于 256 个字符。MSDN 没有关于该主题的任何详细信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-17T10:25:26.177

字典对用作其键和值的类型没有任何特殊知识。无论对象类型如何，它都会简单地调用`GetHashCode`and`Equals`方法以允许它将值放入正确的存储桶中并再次检索它。这意味着任何正确实现这些方法的类都可以用作键。

该类`string`确实根据其值正确实现了这些方法，因此只要您可以构造字符串的实例，就可以将其用作键。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T10:11:34.477

是的，它可以使用任何有效的字符串（限制为几十亿字节）。

顺便说一句，您可能会传递一个自定义`IEqualityComparer<T>`，您可能会传递给`Dictionary`可能需要最大限制的构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T10:16:22.780

由于密钥只是一个 .NET 字符串，请参阅这个相关的 SO 问题：[.NET 字符串的最大可能长度是多少？](https://stackoverflow.com/questions/140468/what-is-the-maximum-possible-length-of-a-net-string)

# jquery - 更新 AJAX 成功的两个 DIV - 结合 JavaScriptResult 和 PartialViewResult？

> ID：874292
> 
> 赞同：1
> 
> 时间：2009-05-17T10:14:16.263
> 
> 标签：jquery, asp.net-mvc

目前我有一个 jQuery 对返回 ContentResult 的控制器进行 POST。当 OnSuccess 事件从 jQuery 触发时，它会使用返回的数据更新 div。我现在想用模型数据更新另一个 DIV。

我正在考虑在我的视图中有一个 RenderPartial，发布并返回一个 PartialResult 它将处理这个新的 div 但是我之前填充的 DIV 呢？

可以结合 JavaScriptResult 和 PartialResult 吗？JavaScript 结果处理我提到的第一个 DIV，PartialResult 处理新的 DIV。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T15:18:35.423

尽管它在管道上增加了更多噪音，但我认为更简洁的选择是从控制器单独调用以获取额外的 PartialResult，大概是在 OnSuccess 事件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T20:00:18.543

我就是这样做的。

我的主视图现在执行 RenderPartial("PartialViewName",Model)。

在部分视图的顶部，我检查 ViewData["AJAXReturn"] 是否不为空。如果不是，我调用另一个 Partial 视图并传入包含原始 AJAX 响应的 ViewData["AJAXReturn"] 项。

在我的控制器操作方法中，我将原始响应消息添加到 ViewData["AJAXReturn"]，然后调用方法来更新我的模型数据并返回 PartialView("PartialViewName",UpdatedModel)。

现在 ViewData 不为空，因此原始 DIV 通过 ViewData 填充，并使用新模型调用 PartialView 呈现第二个 DIV。这是由 jQuery 帖子中的 OnSuccess 事件完成的，该事件执行 $('# containsdiv').html(responsefromPartialViewreturn);

希望这可以帮助某人。

# asp.net-mvc - 如何从 ASP.NET MVC 的局部视图中获取用户（IPrincipal）？

> ID：874293
> 
> 赞同：4
> 
> 时间：2009-05-17T10:15:00.617
> 
> 标签：asp.net-mvc

在*System.Web.UI.Page.ViewPage*我可以访问当前用户（*System.Security.Principal.IPrincipal*），但我无法通过*System.Web.UI.UserControl.ViewUserControl*访问用户（*ViewPage*属性是内部的）。

我的部分视图 ( *.ascx* ) 如何根据*IPrincipal*的身份显示信息？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-17T10:22:49.100

```
ViewContext.HttpContext.User 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T10:17:30.093

```
HttpContext.Current.User 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T10:24:36.910

您可以通过 ViewContext 访问它

```
ViewContext.HttpContext.User 
```

# sharepoint - 如何根据字段自动对 SPListItems 进行排序

> ID：874294
> 
> 赞同：1
> 
> 时间：2009-05-17T10:15:19.443
> 
> 标签：sharepoint, list

我要求在添加或更新 ListItem 时，SPList 应按“优先级”字段（数字字段，无限制）排序。

排序应该这样工作：

```
Original        Inserted item         Modified
   1                                      1
   2                2                     2
   3                                      3 (old 2)
                                          4 (old 3) 
```

已编辑：此行为主要用于在数据表视图中编辑数据时改善用户体验。这是我想要获得的一种糟糕的 AJAX 风格更新。

我现在看到的唯一解决方案是使用事件处理程序并更新应该取消优先级的 ListItems，但是对于包含数百个项目的列表来说，这可能是一项相当昂贵的操作（除非序列中有间隙）。

我错过了明显的解决方案，还是更好的扩展方式？

蒂亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T12:16:27.953

哇，好难的。我不喜欢返回并从 EventReceiver 更新现有项目的想法。你是在自找麻烦。

这是我的建议。

使用 2 个字段进行排序。

1 您今天拥有的优先字段（有人说 1、2、3、4）... 2 创建日期字段（这是一个内置的日期时间字段）。

所以你的结果看起来像这样

1 2009年 1 月 1 日
2 2009 年 5 月 16 日
2 2009 年 5 月 11 日
3 2009 年 5 月 12 日

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-17T11:50:15.223

如果您希望在视图中对项目进行排序：在视图中设置排序顺序。

如果您希望在使用 SharePoint API 时对项目进行排序：使用带有 OrderBy 元素的 SPQuery。[http://sharepointmagazine.net/technical/development/writing-caml-queries-for-retrieving-list-items-from-a-sharepoint-list](http://sharepointmagazine.net/technical/development/writing-caml-queries-for-retrieving-list-items-from-a-sharepoint-list)

# .net - .NET 类的类似结构的深层 Equals()？

> ID：874295
> 
> 赞同：2
> 
> 时间：2009-05-17T10:15:21.970
> 
> 标签：.net, reflection, equals, struct

给定两个不包含引用循环的对象，您是否知道一种以“通用”方式（通过反射）测试它们相等性的方法？

我基本上想要与结构等价相同的语义，只在类上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T10:41:08.930

我认为框架中没有这样的方法可用，但它很容易编写。也许不是最短的实现，但似乎可以完成这项工作：

```
private bool AreEqual(object x, object y)
{
    // if both are null, they are equal
    if (x == null && y == null)
    {
        return true;
    }
    // if one of them are null, they are not equal
    else if (x == null || y == null)
    {
        return false;
    }

    // if they are of different types, they can't be compared
    if (x.GetType() != y.GetType())
    {
        throw new InvalidOperationException("x and y must be of the same type");
    }

    Type type = x.GetType();
    PropertyInfo[] properties = type.GetProperties();

    for (int i = 0; i < properties.Length; i++)
    {
        // compare only properties that requires no parameters
        if (properties[i].GetGetMethod().GetParameters().Length == 0)
        {
            object xValue = properties[i].GetValue(x, null);
            object yValue = properties[i].GetValue(y, null);

            if (properties[i].PropertyType.IsValueType && !xValue.Equals(yValue))
            {
                return false;
            }
            else if (!properties[i].PropertyType.IsValueType)
            {
                if (!AreEqual(xValue, yValue))
                {
                    return false;
                }
            } // if
        } // if
    } // for

    return true;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-22T18:02:58.807

顺便提一句

```
 Expression.Lambda<Func<T,T,bool>> Compile() 
```

可以用作动态方法构建器。

在构建表达式时仍然必须使用反射

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T10:46:38.620

如果您想在**不对**每个调用进行反射的情况下执行此操作，您可能需要考虑`DynamicMethod`在第一次调用时构建并使用它。（我有一个指向这样做的文章的链接，但我丢失了它 - 抱歉 - 如果有兴趣，请尝试谷歌搜索。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-27T09:39:47.810

这是 Fredrik Mörk 的回答的更新版本，其中考虑了`Nullable`递归引用：

```
public static bool AreEqual<T>(T x, T y) =>
    AreEqual(x, y, new HashSet<object>(new IdentityEqualityComparer<object>()));

private static bool AreEqual(object x, object y, ISet<object> visited)
{
    // if both are null, they are equal
    if (x == null && y == null) return true;

    // if one of them are null, they are not equal
    if (x == null || y == null) return false;

    // if they are of different types, they can't be compared
    if (x.GetType() != y.GetType())
    {
        throw new InvalidOperationException("x and y must be of the same type");
    }

    // check for recursive references
    if (visited.Contains(x)) return true;
    if (visited.Contains(y)) return true;
    visited.Add(x);
    visited.Add(y);

    var type = x.GetType();
    var properties = type.GetProperties();

    foreach (var property in properties)
    {
        // compare only properties that requires no parameters
        if (property.GetGetMethod().GetParameters().Length == 0)
        {
            object xValue = property.GetValue(x, null);
            object yValue = property.GetValue(y, null);

            if (property.PropertyType.IsValueType)
            {
                // check for Nullable
                if (xValue == null && yValue == null) continue;
                if (xValue == null || yValue == null) return false;
                if (!xValue.Equals(yValue)) return false;
            }

            if (!property.PropertyType.IsValueType)
            {
                if (!AreEqual(xValue, yValue, visited)) return false;
            }
        }
    }

    return true;
}

private class IdentityEqualityComparer<T> : IEqualityComparer<T> where T : class
{
    public int GetHashCode(T value) => RuntimeHelpers.GetHashCode(value);
    public bool Equals(T left, T right) => left == right;
} 
```

# c++ - 仅接受某些类型的 C++ 模板

> ID：874298
> 
> 赞同：184
> 
> 时间：2009-05-17T10:16:00.503
> 
> 标签：c++, templates

在 Java 中，您可以定义只接受扩展您选择的类的类型的泛型类，例如：

```
public class ObservableList<T extends List> {
  ...
} 
```

这是使用“扩展”关键字完成的。

C ++中是否有一些与此关键字等效的简单方法？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2014-08-09T07:38:08.623

正如这里的其他答案所指出的，这在 C++ 中通常是没有根据的。在 C++ 中，我们倾向于根据“从此类继承”以外的其他约束来定义泛型类型。如果你真的想这样做，在 C++11 中很容易做到，并且`<type_traits>`：

```
#include <type_traits>

template<typename T>
class observable_list {
    static_assert(std::is_base_of<list, T>::value, "T must inherit from list");
    // code here..
}; 
```

这打破了人们在 C++ 中所期望的许多概念。最好使用诸如定义自己的特征之类的技巧。例如，可能`observable_list`想要接受任何类型的容器，该容器具有 typedefs`const_iterator`和一个返回`begin`的`end`成员函数`const_iterator`。如果您将此限制为继承自的类，`list`则具有自己的类型但不继承自`list`但提供这些成员函数和 typedef 的用户将无法使用您的`observable_list`.

这个问题有两种解决方案，其中之一是不限制任何东西并依赖鸭子类型。该解决方案的一大缺点是它涉及大量错误，用户可能难以理解。另一种解决方案是定义特征来约束提供的类型以满足接口要求。这个解决方案的一大缺点是涉及额外的写作，这可能会让人觉得很烦人。但是，积极的一面是您将能够编写自己的错误消息 la `static_assert`。

为完整起见，给出上述示例的解决方案：

```
#include <type_traits>

template<typename...>
struct void_ {
    using type = void;
};

template<typename... Args>
using Void = typename void_<Args...>::type;

template<typename T, typename = void>
struct has_const_iterator : std::false_type {};

template<typename T>
struct has_const_iterator<T, Void<typename T::const_iterator>> : std::true_type {};

struct has_begin_end_impl {
    template<typename T, typename Begin = decltype(std::declval<const T&>().begin()),
                         typename End   = decltype(std::declval<const T&>().end())>
    static std::true_type test(int);
    template<typename...>
    static std::false_type test(...);
};

template<typename T>
struct has_begin_end : decltype(has_begin_end_impl::test<T>(0)) {};

template<typename T>
class observable_list {
    static_assert(has_const_iterator<T>::value, "Must have a const_iterator typedef");
    static_assert(has_begin_end<T>::value, "Must have begin and end member functions");
    // code here...
}; 
```

上面的示例中显示了很多概念，展示了 C++11 的特性。一些好奇的搜索词是可变参数模板、SFINAE、表达式 SFINAE 和类型特征。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2009-05-17T10:37:36.160

我建议结合Boost Type Traits 库中的 Boost[静态断言](http://www.boost.org/doc/libs/1_39_0/doc/html/boost_staticassert.html)功能：[`is_base_of`](http://www.boost.org/doc/libs/1_39_0/libs/type_traits/doc/html/boost_typetraits/reference/is_base_of.html)

```
template<typename T>
class ObservableList {
    BOOST_STATIC_ASSERT((is_base_of<List, T>::value)); //Yes, the double parentheses are needed, otherwise the comma will be seen as macro argument separator
    ...
}; 
```

在其他一些更简单的情况下，您可以简单地前向声明一个全局模板，但只为有效类型定义（显式或部分特化）它：

```
template<typename T> class my_template;     // Declare, but don't define

// int is a valid type
template<> class my_template<int> {
    ...
};

// All pointer types are valid
template<typename T> class my_template<T*> {
    ...
};

// All other types are invalid, and will cause linker error messages. 
```

**[次要编辑 6/12/2013：使用声明但未定义的模板将导致*链接器*，而不是编译器，错误消息。]**

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2009-05-17T12:04:24.597

没有人提到的简单解决方案就是忽略这个问题。如果我尝试`int`在需要容器类（如向量或列表）的函数模板中使用 an 作为模板类型，则会出现编译错误。粗鲁和简单，但它解决了问题。编译器将尝试使用您指定的类型，如果失败，则会生成编译错误。

唯一的问题是您收到的错误消息将难以阅读。然而，这是一种非常常见的方法。标准库中充满了函数或类模板，这些模板期望模板类型具有某些行为，并且不检查所使用的类型是否有效。

如果您想要更好的错误消息（或者如果您想要捕获不会产生编译器错误但仍然没有意义的情况），您可以根据您想要使其复杂程度，使用 Boost 的静态断言或Boost concept_check 库。

使用最新的编译器，您可以使用 built_in`static_assert`来代替。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-08-13T10:45:29.507

我们可以使用[`std::is_base_of`](http://en.cppreference.com/w/cpp/types/is_base_of)and [`std::enable_if`](http://en.cppreference.com/w/cpp/types/enable_if):(可以去掉，上面的类可以自定义实现，如果我们不能引用，可以
从[boost](http://www.boost.org/doc/libs/1_56_0/libs/type_traits/doc/html/boost_typetraits/reference/is_base_of.html)中使用）[`static_assert`](http://en.cppreference.com/w/cpp/language/static_assert)[`type_traits`](http://en.cppreference.com/w/cpp/types)

```
#include <type_traits>
#include <list>

class Base {};
class Derived: public Base {};

#if 0   // wrapper
template <class T> class MyClass /* where T:Base */ {
private:
    static_assert(std::is_base_of<Base, T>::value, "T is not derived from Base");
    typename std::enable_if<std::is_base_of<Base, T>::value, T>::type inner;
};
#elif 0 // base class
template <class T> class MyClass: /* where T:Base */
    protected std::enable_if<std::is_base_of<Base, T>::value, T>::type {
private:
    static_assert(std::is_base_of<Base, T>::value, "T is not derived from Base");
};
#elif 1 // list-of
template <class T> class MyClass /* where T:list<Base> */ {
    static_assert(std::is_base_of<Base, typename T::value_type>::value , "T::value_type is not derived from Base");
    typedef typename std::enable_if<std::is_base_of<Base, typename T::value_type>::value, T>::type base; 
    typedef typename std::enable_if<std::is_base_of<Base, typename T::value_type>::value, T>::type::value_type value_type;

};
#endif

int main() {
#if 0   // wrapper or base-class
    MyClass<Derived> derived;
    MyClass<Base> base;
//  error:
    MyClass<int> wrong;
#elif 1 // list-of
    MyClass<std::list<Derived>> derived;
    MyClass<std::list<Base>> base;
//  error:
    MyClass<std::list<int>> wrong;
#endif
//  all of the static_asserts if not commented out
//  or "error: no type named ‘type’ in ‘struct std::enable_if<false, ...>’ pointing to:
//  1\. inner
//  2\. MyClass
//  3\. base + value_type
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-17T10:47:41.660

据我所知，这在 C++ 中目前是不可能的。但是，有计划在新的 C++0x 标准中添加一个称为“概念”的功能，以提供您正在寻找的功能。这篇关于 C++ 概念的[维基百科文章](https://en.wikipedia.org/wiki/Concepts_%28C%2B%2B%29)将更详细地解释它。

我知道这并不能解决您的直接问题，但是有一些 C++ 编译器已经开始添加新标准的功能，因此可能会找到一个已经实现概念功能的编译器。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-08-13T09:42:39.717

仅接受从类型 List 派生的类型 T 的等价物看起来像

```
template<typename T, 
         typename std::enable_if<std::is_base_of<List, T>::value>::type* = nullptr>
class ObservableList
{
    // ...
}; 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-08-10T13:08:07.490

我认为所有先前的答案都忽略了树木的森林。

Java 泛型*与模板不同*；他们使用*类型擦除*，这是一种**动态技术**，而不是*编译时多态*，这是一种**静态技术**。为什么这两种截然不同的策略不能很好地融合应该是显而易见的。

与其尝试使用编译时构造来模拟运行时构造，不如让我们看看`extends`实际做了什么：[根据 Stack Overflow](https://stackoverflow.com/questions/9494380/whats-the-difference-between-the-implements-extends-keywords-in-java)和[Wikipedia](http://en.wikipedia.org/wiki/List_of_Java_keywords)，extends 用于指示子类化。

C++ 还支持子类化。

您还展示了一个容器类，它以泛型的形式使用类型擦除，并扩展以执行类型检查。在 C++ 中，您必须自己执行类型擦除机制，这很简单：创建一个指向超类的指针。

让我们将它包装到 typedef 中，以使其更易于使用，而不是创建一个完整的类，等等：

`typedef std::list<superclass*> subclasses_of_superclass_only_list;`

例如：

```
class Shape { };
class Triangle : public Shape { };

typedef std::list<Shape*> only_shapes_list;
only_shapes_list shapes;

shapes.push_back(new Triangle()); // Works, triangle is kind of shape
shapes.push_back(new int(30)); // Error, int's are not shapes 
```

现在，List 似乎是一个接口，代表一种集合。C++ 中的接口只是一个抽象类，即只实现纯虚方法的类。使用此方法，您可以轻松地在 C++ 中实现您的 java 示例，而无需任何概念或模板特化。由于虚拟表查找，它的执行速度也与 Java 风格的泛型一样慢，但这通常是可以接受的损失。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-07-19T22:48:35.183

执行摘要：不要那样做。

j_random_hacker 的回答告诉你*如何*做到这一点。但是，我还想指出，您不应该*这样*做。模板的全部意义在于它们可以接受任何兼容的类型，而 Java 风格的类型约束打破了这一点。

Java 的类型约束是一个错误而不是一个特性。它们在那里是因为 Java 在泛型上进行类型擦除，所以 Java 无法仅根据类型参数的值来弄清楚如何调用方法。

另一方面，C++ 没有这样的限制。模板参数类型可以是与它们一起使用的操作兼容的任何类型。不必有一个通用的基类。这类似于 Python 的“Duck Typing”，但在编译时完成。

一个展示模板强大功能的简单示例：

```
// Sum a vector of some type.
// Example:
// int total = sum({1,2,3,4,5});
template <typename T>
T sum(const vector<T>& vec) {
    T total = T();
    for (const T& x : vec) {
        total += x;
    }
    return total;
} 
```

这个 sum 函数可以对支持正确操作的任何类型的向量求和。它既适用于 int/long/float/double 等原语，也适用于重载 += 运算符的用户定义数字类型。哎呀，你甚至可以使用这个函数来连接字符串，因为它们支持 +=。

不需要对基元进行装箱/拆箱。

请注意，它还使用 T() 构造 T 的新实例。这在使用隐式接口的 C++ 中是微不足道的，但在具有类型约束的 Java 中实际上是不可能的。

虽然 C++ 模板没有显式类型约束，但它们仍然是类型安全的，并且不会使用不支持正确操作的代码进行编译。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-05-17T10:37:23.650

这在纯 C++ 中是不可能的，但您可以在编译时通过概念检查验证模板参数，例如使用[Boost 的 BCCL](http://www.boost.org/doc/libs/1_39_0/libs/concept_check/concept_check.htm)。

从 C++20 开始，概念正在成为该语言的[官方特性](https://en.cppreference.com/w/cpp/language/constraints)。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2020-05-08T09:59:55.277

**C++20 概念使用示例**

改编自 <https://en.cppreference.com/w/cpp/language/constraints cppreference>，你可以做一些鸭子打字：

```
#include <cassert>
#include <concepts>

struct ClassWithMyFunc {
    int myFunc() {
        return 1;
    }
};

struct ClassWithoutMyFunc {};

// Concept HasMyFunc: type 'T' has `.myFunc` and
// its return is convertible to int.
template<typename T>
concept HasMyFunc= requires(T a) {
    { a.myFunc() } -> std::convertible_to<int>;
};

// Constrained function template
template<HasMyFunc T>
int f(T t) {
    return t.myFunc() + 1;
}

int main() {
    assert(f(ClassWithMyFunc()) == 2);
    // assert(f(ClassWithoutMyFunc()) == 2);
} 
```

编译并运行：

```
g++ -ggdb3 -O0 -std=c++20 -Wall -Wextra -pedantic -o main.out main.cpp
./main.out 
```

如果我们取消注释该行`// assert(f(ClassWithoutMyFunc()) == 2);`，它会根据需要失败：

```
In file included from /usr/include/c++/10/cassert:44,
                 from main.cpp:1:
main.cpp: In function ‘int main()’:
main.cpp:27:34: error: use of function ‘int f(T) [with T = ClassWithoutMyFunc]’ with unsatisfied constraints
   27 |     assert(f(ClassWithoutMyFunc()) == 2);
      |                                  ^
main.cpp:21:5: note: declared here
   21 | int f(T t) {
      |     ^
main.cpp:21:5: note: constraints not satisfied
main.cpp: In instantiation of ‘int f(T) [with T = ClassWithoutMyFunc]’:
main.cpp:27:5:   required from here
main.cpp:15:9:   required for the satisfaction of ‘HasMyFunc<T>’ [with T = ClassWithoutMyFunc]
main.cpp:15:20:   in requirements with ‘T a’ [with T = ClassWithoutMyFunc]
main.cpp:16:15: note: the required expression ‘a.myFunc()’ is invalid
   16 |     { a.myFunc() } -> std::convertible_to<int>;
      |       ~~~~~~~~^~
cc1plus: note: set ‘-fconcepts-diagnostics-depth=’ to at least 2 for more detail 
```

**需要多个基类**

如果您确实需要某些基类之一：

```
#include <concepts>
#include <type_traits>

struct Base1 {};
struct Base2 {};

struct Derived1 : public Base1 {};
struct Derived2 : public Base2 {};

struct NotDerived {};

template<typename T>
concept HasBase1Or2= std::is_base_of<Base1, T>::value || std::is_base_of<Base2, T>::value;

template<HasBase1Or2 T>
void f(T) {}

int main() {
    f(Derived1());
    f(Derived2());
    // f(NotDerived());
} 
```

如果我们取消注释该行`// f(NotDerived());`，它会根据需要失败：

```
main.cpp: In function ‘int main()’:
main.cpp:22:19: error: use of function ‘void f(T) [with T = NotDerived]’ with unsatisfied constraints
   22 |     f(NotDerived());
      |                   ^
main.cpp:17:6: note: declared here
   17 | void f(T) {}
      |      ^
main.cpp:17:6: note: constraints not satisfied
main.cpp: In instantiation of ‘void f(T) [with T = NotDerived]’:
main.cpp:22:19:   required from here
main.cpp:13:9:   required for the satisfaction of ‘HasBase1Or2<T>’ [with T = NotDerived]
main.cpp:13:55: note: no operand of the disjunction is satisfied
   13 | concept HasBase1Or2= std::is_base_of<Base1, T>::value ||
      |                                                 ~~~~~~^~
   14 |                      std::is_base_of<Base2, T>::value;
      |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
cc1plus: note: set ‘-fconcepts-diagnostics-depth=’ to at least 2 for more detail 
```

在 Ubuntu 21.04 GCC 10.3.0 上测试。

GCC 10 似乎已经实现了它：[https](https://gcc.gnu.org/gcc-10/changes.html) ://gcc.gnu.org/gcc-10/changes.html ，您可以[在 Ubuntu 20.04 上将其作为 PPA](https://askubuntu.com/questions/466651/how-do-i-use-the-latest-gcc-on-ubuntu/1163021#1163021)获得。[https://godbolt.org/](https://godbolt.org/)`concept` GCC 10.1在 Ubuntu 20.04 上却无法识别。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-12-12T18:28:00.217

```
class Base
{
    struct FooSecurity{};
};

template<class Type>
class Foo
{
    typename Type::FooSecurity If_You_Are_Reading_This_You_Tried_To_Create_An_Instance_Of_Foo_For_An_Invalid_Type;
}; 
```

确保派生类继承 FooSecurity 结构，编译器会在所有正确的地方感到不安。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-07-01T13:18:16.787

这种类型检查没有关键字，但您可以放入一些代码，至少会以有序的方式失败：

(1) 如果您希望函数模板只接受某个基类 X 的参数，请将其分配给函数中的 X 引用。(2) 如果您想接受函数但不接受原语，反之亦然，或者您想以其他方式过滤类，请在您的函数中调用一个（空）模板辅助函数，该函数仅为您要接受的类定义。

您也可以在类的成员函数中使用 (1) 和 (2) 来强制对整个类进行这些类型检查。

您可能可以将其放入一些智能宏中以减轻您的痛苦。:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-17T10:41:14.780

> C ++中是否有一些与此关键字等效的简单方法？

不。

根据您要完成的工作，可能会有足够的（甚至更好的）替代品。

我查看了一些 STL 代码（在 linux 上，我认为它是从 SGI 的实现派生的）。它有“概念断言”；例如，如果您需要一个可以理解`*x`and的类型`++x`，则概念断言将在无操作函数（或类似函数）中包含该代码。它确实需要一些开销，因此将其放入定义依赖于`#ifdef debug`.

如果子类关系确实是您想知道的，您可以在构造函数中断言`T instanceof list`（除了它在 C++ 中的“拼写”不同）。这样，您可以测试您的方式，使编译器无法为您检查它。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-05-17T10:34:26.513

好吧，您可以创建您的模板，内容如下：

```
template<typename T>
class ObservableList {
  std::list<T> contained_data;
}; 
```

然而，这将使限制变得隐含，而且你不能只提供任何看起来像列表的东西。还有其他方法可以限制所使用的容器类型，例如通过使用并非在所有容器中都存在的特定迭代器类型，但这同样是一种隐含的限制，而不是显式的限制。

据我所知，在当前标准中不存在完全反映语句 Java 语句的构造。

有一些方法可以通过在模板中使用特定的 typedef 来限制您可以在您编写的模板中使用的类型。这将确保不包含特定 typedef 的类型的模板特化编译将失败，因此您可以选择性地支持/不支持某些类型。

在 C++11 中，概念的引入应该使这更容易，但我认为它也不会完全符合您的要求。

# java - Jibx：将基类输出集成到扩展类输出中

> ID：874301
> 
> 赞同：0
> 
> 时间：2009-05-17T10:16:32.077
> 
> 标签：java, xml, jibx

我有这个班级模型：

```
abstract class A {
    int a;
}

class B extends A {
    int b;
}

class C extends B {
    int c;
} 
```

我想让 jibx 输出这个 XML：

```
<B b=1 a=0>
    <children>
        <C c=2 b=1 a=0/>        
    </children>
</B> 
```

我有这个绑定xml：

```
<binding>
    <mapping class="A" abstract="true">
        <value name="a" field="a" style="attribute" usage="optional"/>      
        <collection field="children" type="java.util.ArrayList"/>
    </mapping>
    <mapping name="B" class="B" extends="A">
        <value name="b" field="b" style="attribute" usage="optional"/>
        <structure map-as="A"/>
    </mapping>
    <mapping name="C" class="C" extends="B">
        <value name="c" field="c" style="attribute" usage="optional"/>
        <structure map-as="B"/>
    </mapping>
</binding> 
```

但是我不断收到这样的工件：

```
<C c=2>
    <B b=1 a=0>
        <children>
            ...
        </children>
    </B>
</C> 
```

作为临时解决方案，我将继承结构更改为让 AbstractB 和 B 扩展 AbstractB 和 C 扩展 AbstractB，但由于 jibx 不得不重新设计我的类真的很烦人。

任何人都知道如何解决这个问题？

编辑：作为一个额外的问题 - 你如何使用代码/解码 java.util.Map 和 Jibx？我知道它不能在本地完成（很高兴被反驳！）但是你会怎么做 Map 编码（没有字符串）。请注意，我们没有使用 jibx-extras.jar，因此解决方案不应依赖它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T22:27:22.133

实际上，恕我直言，让 C 作为 B 的父级（在 XML 意义上）感觉很正常，因为**C 包含 B 的信息**（从它继承的）**和它自己的信息**，但是 B 不知道那些 C 特定的信息对吗？

为了更清楚：它 B 是**Bird**而 C 是**Chicken**。鸡是鸟，所以 C 继承了 B，OK。但在 XML 格式中，将存储：

```
<Bird color="brown">
    <Chicken label="Kentucky-fried" />
</Bird> 
```

或者

```
<Chicken label="Kentucky-fried"> <!-- chicken-specific information -->
    <Bird color="brown" /> <!-- "birdy" part of the chicken -->
</Chicken> 
```

?

所以从模型的角度来看，这对我来说似乎是合乎逻辑的......而且我没有找到在[绑定教程](http://jibx.sourceforge.net/tutorial/binding-mappings.html#inherit)中实现相反的方法，抱歉。

# svn - Subversion - 处理代码生成

> ID：874307
> 
> 赞同：9
> 
> 时间：2009-05-17T10:20:58.620
> 
> 标签：svn, version-control

我们有一个要与 Subversion 一起使用的 Web 应用程序框架。我们之前已经尝试过几次设置它，但是我们应用程序的代码生成部分导致了问题。

问题是一个开发人员生成的代码可能比另一个开发人员在一个新文件中，但新文件的内容可能更旧，因为作为代码生成基础的代码和 xml 文件已被更新开发商 nr2。

我们研究过的一种解决方案是排除代码生成的文件，但我们经常会得到生成的新文件，除非我们记得排除它，否则它们会自动添加到存储库中，并且我们必须手动签入最新生成的文件文件。你怎么知道你是否有最新的生成文件？

关于如何在 Subversion 中解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-17T10:31:29.780

决定是否应该在 Subversion 中的最好方法是记住它是一个*版本控制系统*。**如果您不需要记住它是如何随时间变化的，则不需要在`svn`.** 用于**`svn:ignore`**从此类考虑中排除文件。

这里就是这种情况：您不关心生成的文件如何随时间变化，只关心用于生成它们的原始代码。这意味着它们应该被排除在 Subversion 之外。您可以使用预提交挂钩来执行此操作——例如，强制所有代码生成的文件都不应该被提交。对于这种策略，我有一个最喜欢的短语：**“版本是食谱，而不是蛋糕。”**

> 你怎么知道你是否有最新的生成文件？

确切地; 你没有，因为生成的文件依赖于用于创建它们的源。您的下一步是确保您的构建过程在给定初始源代码的情况下自动生成这些文件，但如果您不知道如何执行此操作，这可能是一个单独的 StackOverflow 问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-17T10:28:50.300

> 我们研究过的一种解决方案是排除代码生成的文件

是的！一千次是的！永远不要对可以从其他文件生成的文件进行版本控制。相反，将生成规则添加到您的 makefile（或其他构建脚本）。

> 它们会自动添加到存储库中

什么是自动添加它们？据我回忆，我总是不得不手动添加文件。如果自动添加的工具是错误的，那么修复该工具是正确的方法吗？

> 除非我们记得排除它

你有没有生成工具添加一条评论说“文件由 $TOOL 自动生成”，并添加一个颠覆挂钩，该挂钩为该评论获取文件并拒绝它们。为代码生成工具做出适当的规定；例如：如果文件包含“自动生成的”注释，如果它在同一行的注释中也有“svn 拒绝除外”，则无论如何添加它。

> 你怎么知道你是否有最新的生成文件？

通过从最新的 subversion 提交中的最新配方生成它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T10:24:45.210

你应该使用[svn:ignore](http://svnbook.red-bean.com/en/1.1/ch07s02.html)，因为你真的不想将自动生成的东西提交给颠覆。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T10:27:57.387

也许我很简单，但我不会将生成的文件存储在版本控制中。由于它是生成的，因此保留它的版本历史是没有意义的。

使用代码和 xml 在版本控制中进行生成，您始终可以为每个版本生成代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T10:31:47.003

另一个好的策略是不在生成的文件中编写代码。让他们分开。那么无论谁生成它们，都无关紧要。

将您的逻辑排除在生成的文件之外。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T14:14:18.747

将生成的文件命名为“className.autoGenerated.cs”之类的名称，并添加具有相应名称模式“*.autoGenerated.cs”的递归**svn:ignore属性。**

# excel - 可以将 Excel 工作表用作 UDF 吗？

> ID：874311
> 
> 赞同：2
> 
> 时间：2009-05-17T10:22:59.240
> 
> 标签：excel, user-defined-functions

我正在用excel建立一个网络业务模型。类似的模型是 Gawker Media 的模型。

在我的模型中，我有一个数字属性，这些属性有一些重叠的受众。每个属性都吸引用户，这反过来又提供了交叉促销机会。就 Gawker 而言，他们有一系列博客，其受众可能会在他们的网络中阅读他们的几个博客。

如果 gawker 推出了一个新博客，他们就能够引导来自其博客网络的流量。

为单个博客创建模型相当简单——尽管最初的假设更难。下一步是对网络效应进行建模。

Excel 提供了一个场景管理器，允许我改变基本模型中的关键假设。这几乎是完美的，我可以对 10 个属性的发布进行建模，每个属性都有不同的发布假设并查看摘要。

我需要帮助的地方是弄清楚如何改变每个属性的初始用户数量。换句话说，一旦网络建立起来，就有可能将人们带到网络上推出的任何新物业。

我不相信场景经理会做我需要的事情。

所以，我想知道是否可以将模型工作表用作 UDF？考虑到一些输入假设，UDF 将需要吐出月收入和唯一用户数。

然后，我可以为 10 个属性创建自己的摘要表，并使用每个属性的总唯一性来获取网络的摘要。该网络摘要将用于确定可以驱使多少人推出新物业。

实际上，与场景管理器的唯一区别是我需要以编程方式生成我的一个输入变量（初始用户），作为启动时网络中人数的函数。

我希望它有可能在 excel 中实现这些方面的目标。我可以下拉并用 Java 创建整个模型，但是与业务同事共享要困难得多！

谢谢 - 马特。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T14:22:53.360

有一个我研究过但从未使用过的产品——搜索 calc4web。它需要一张公式并生成可编译为 XLL 加载项的代码 (C++)。然后你可以调用一个函数来完成你的工作表所做的事情。但是当然，你有一个 XLL 可以分发，并且每次更改逻辑时都有一个构建步骤，这在很大程度上破坏了使用电子表格的意义。

就我而言，我最终编写了一些非常简单的 VBA 代码来使用场景管理器改变我的工作表“输入”，并捕获我的“输出”。如果您有一批输入，您可以将宏指向并逐步执行，则此方法有效。

编辑：

有关执行此操作的仅 VBA 示例，请参见此处：

[在 Excel 用户定义函数中使用工作表](https://stackoverflow.com/questions/4640336/using-a-sheet-in-an-excel-user-defined-function/4640866#4640866)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-23T12:44:47.407

You could try Data Table.
It only allows you to analyse the effect of varying 2 input parameters, but you can create several data tables, and each parameter can take hundreds of different values.
It's little know, but efficient and available since Excel 3.0.

# windows - Windows XP 下 Ruby FTP 极慢

> ID：874316
> 
> 赞同：3
> 
> 时间：2009-05-17T10:24:57.597
> 
> 标签：windows, ruby, ftp

几周前，我编写了一个简单的 Ruby 脚本来在 Windows XP 环境中测试几个 FTP 命令。一切都按预期工作，我什至不知道代码运行所花费的时间（我猜最多 3-4 秒。）

几天前，我正在开发的一个涉及更多的 Ruby 应用程序开始运行非常缓慢。当我调查这个问题时，我将问题隔离到 FTP 命令。我现在重新运行了原来的测试脚本，它需要两*分钟*多的时间才能运行。命令行 FTP 本质上是即时的。

ruby 目录结构中没有文件被更改。我不相信已经安装了任何新应用程序 - 当然似乎没有其他应用程序正在运行。

谁能建议为什么下面的代码应该运行这么慢？`print`手动计时语句之间的间隔建议`nlst`每个大约`ls`需要 65 秒！分析器给出了更合理的总 ms/调用 16`nlst`和 31 `ls`。

```
require 'net/ftp'

Net::FTP.open("ip_redacted", "user_redacted", "password_redacted") do |ftp|
    ftp.chdir("dir_redacted")

    files = ftp.nlst
    print "files = #{files.sort!}\n"
    list = ftp.ls
    print "list = #{list}\n"

    file = "filename_redacted"

    size = ftp.size(file)
    print "size = #{size}\n"

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T07:46:42.893

从谷歌搜索：

[http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/112910](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/112910)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-28T16:46:13.757

我有一个类似的问题，发现被动模式提高了速度，例如。`ftp.passive=true`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T14:06:08.733

尝试删除`#sort!`(just `puts "files = #{files}"`)，因为如果目录中有一堆文件，这可能会相当昂贵。这将解释周围的大滞后`#nlst`和`#ls`

# web-services - 如何使用 clickatell 发送希伯来语短信

> ID：874321
> 
> 赞同：1
> 
> 时间：2009-05-17T10:27:07.497
> 
> 标签：web-services, sms, hebrew, clickatell

如何通过 Clickatell 发送希伯来语短信？

它以乱码形式出现在设备上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T16:18:45.120

我找不到任何可行的例子，所以我自己写了：

**尝试这个：**

```
UnicodeEncoding unicode = new UnicodeEncoding(true, false);
return string.Concat(unicode.GetBytes(val).Select(c => string.Format("{0:x2}", c))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T10:41:39.287

它是 unicode 吗？如果我没记错的话，他们需要将 unicode 转义为十六进制表示。这应该在他们的文档中。

但是，当我这样做时，我发现这不是唯一的问题，许多手机不支持正确显示 unicode 字符。

此外，发送 unicode 可能会产生更高的成本，因为它可能会被拆分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T10:46:38.260

将您的消息编码为 un​​icode，有关详细信息，请参阅[此常见问题解答页面](http://support.clickatell.com/faq.php?mode=view_entry&kbid=18&kbcat=22)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-25T08:03:38.943

遇到同样的问题...您需要编码为 un​​icode，然后转换为十六进制。奇怪的是，您需要获取最后一个值并将其附加到前面才能使其工作。我通过将我的代码结果与他们的在线工具的输出进行比较发现了这一点。

```
 private string ToUnicode(string val)
    {
        Encoding utf8 = Encoding.UTF8;
        Encoding unicode = Encoding.Unicode;

        byte[] utf8Bytes = utf8.GetBytes(val);

        byte[] unicodeBytes = Encoding.Convert(utf8, unicode, utf8Bytes);

        var result = ByteArrayToString(unicodeBytes);
        result = result.Substring(result.Length - 2, 2) + result.Substring(0, result.Length - 2);
        return result;
    }

    public static string ByteArrayToString(byte[] ba)
    {
        StringBuilder hex = new StringBuilder(ba.Length * 2);
        foreach (byte b in ba)
            hex.AppendFormat("{0:x2}", b);
        return hex.ToString();
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-14T06:43:03.857

我对阿拉伯语使用了以下逻辑.. IT 需要更多测试。语言是 VB.Net

 `````
 If txtArabic.Text.Trim.Length > 0 Then

        Dim unicodeString As String = txtArabic.Text
        Dim unicode As Encoding = Encoding.Unicode
        ' Convert the string into a byte array. 
        Dim unicodeBytes As Byte() = unicode.GetBytes(unicodeString)

        Dim sb As String = ToUnicode(txtArabic.Text)

    End If 
```` 

`这是转换部分`

 ```Private Function ToUnicode(ByVal strVal As String)

```
 Dim unicode As Encoding = New UnicodeEncoding(True, False)
    ' Encoding.Unicode
    Dim utf8 As Encoding = Encoding.UTF8
    Dim utf8Bytes() As Byte = unicode.GetBytes(strVal)
    Dim unicodeBytes() As Byte = Encoding.Convert(utf8, unicode, utf8Bytes)
    Dim result As String = ByteArrayToString(unicodeBytes)

    Return result
End Function

Private Function ByteArrayToString(ByVal ba() As Byte)
    Dim hex As StringBuilder = New StringBuilder(ba.Length)
    For i As Integer = 0 To ba.Length - 1

        If (((i - 2) Mod 4.0) = 0) Then
        Else

            hex.AppendFormat("{0:x00}", ba(i))
            ' hex.Append(ba(i))
        End If
        '   hex.Append("-")
    Next
    Return hex.ToString
End Function 
````  `# mysql - 识别 Mysql DB 中缺失的匹配项

> ID：874327
> 
> 赞同：0
> 
> 时间：2009-05-17T10:32:46.750
> 
> 标签：mysql

有没有办法识别连接表中缺少的组合。例如：三个标签

动物

食物

动物食品

可以识别任何特定的食物是否与动物无关，反之亦然？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T10:42:12.437

您可以使用左连接：

```
SELECT animals.id FROM animals LEFT JOIN animals_food ON animals.id = animals_food.animals_id WHERE animals_food.food_id IS NULL; 
```

[左连接](http://en.wikipedia.org/wiki/Left_join#Left_outer_join)包含左表 (animals) 中的所有行，即使连接条件没有从右表 (animals_food) 中找到任何匹配的行。当未找到匹配项时，右表的列将替换为 NULL。

我的查询中的 WHERE 条件删除了所有匹配的行，只留下左表中的孤立行。

# groovy - 在 Windows XP 上使用 Groovy 支持 ANSI 颜色

> ID：874328
> 
> 赞同：0
> 
> 时间：2009-05-17T10:32:50.057
> 
> 标签：groovy, windows-xp, cygwin, ansi, groovyshell

尝试在[pleac.sf.net](http://pleac.sourceforge.net/pleac_groovy/userinterfaces.html)上找到的示例，我无法在我的WinXP 机器上获得ANSI 颜色的示例（在MacOS 上工作正常）。我发现在我的 WinXP 机器上，在 cygwin 和 DOS 提示符中**`groovysh --color`**（和**'groovysh --terminal=unix'**）显示转义码而不是预期的彩色提示符。**`grep --color`**在 cygwin 终端中工作得很好。我找不到任何明显的我做错的事情。有任何想法吗？

**注意：**我使用的是 Groovy 1.6.0

**更新：**我尝试将 ANSI.sys 添加到[Groovy-dev Mailing List](http://www.nabble.com/-groovy-dev--New-groovysh-interactive-command-line-console-for-Groovy-td12288120.html#a12295707)中提到的我的 config.nt 中，但它没有解决问题（也尝试重新启动）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-01-27T13:16:51.063

我有同样的问题，我的解决方案很丑陋但很简单：管道 groovy 输出到 cygwin cat.exe 假设你的脚本 red.groovy 是：

```
println "\u001B[31mI'm Red\u001B[0m Now not" 
```

然后从命令外壳

```
groovy.bat red.groovy | cat 
```

将显示正确的颜色。当然，您可以编写自己的本地代码来处理 ANSI 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-11T00:33:43.927

问题是，您还必须将 DOSONLY 添加到您的 CONFIG.NT 以使 ANSI.SYS 驱动程序工作，然后它只适用于模拟 DOS 5.0 的 COMMAND.COM。常规命令提示符 (CMD.EXE) 根本不支持 ANSI 颜色。

我不太了解cygwin如何处理它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T21:16:20.030

Groovy 网站说要为 cygwin 执行此操作：

```
groovysh --terminal=unix 
```

对于 winxp 命令 shell，据我所知，根本不支持 ANSI，甚至不支持 ansi.sys。仅通过某些 MS API 支持颜色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-26T21:22:36.070

cygwin 中的一种解决方法是启动 xterm 或 rxvt 并在那里运行它。

# ruby-on-rails - ActiveScaffold - 更改关联对象的默认名称

> ID：874329
> 
> 赞同：2
> 
> 时间：2009-05-17T10:33:15.393
> 
> 标签：ruby-on-rails, ruby, activescaffold

我的模型`"combobox" has_many "comboboxselects"`，和`"comboboxselects" belongs_to "combobox"`。“组合框”的 Activescaffold 在组合框选择列中显示数据，如`"#<Comboboxselect:0x472d25c>"`. 如何从表“comboxselects”中显示“答案”列？

楷模：

```
class Combobox < ActiveRecord::Base
 has_many :comboboxselects
end

class Comboboxselect < ActiveRecord::Base
 belongs_to :combobox
end 
```

架构：

```
 create_table "comboboxes", :force => true do |t|
   t.string   "question"
   t.datetime "created_at"
   t.datetime "updated_at"
  end

  create_table "comboboxselects", :force => true do |t|
   t.integer  "combobox_id"
   t.string   "answer"
   t.datetime "created_at"
   t.datetime "updated_at"
  end 
```

输出：

```
class ComboboxesController < ApplicationController
 active_scaffold :combobox do |config|
   config.list.columns = [:id, :question]
   config.columns = [:question, :comboboxselects]
 end
end

class ComboboxselectsController < ApplicationController
 active_scaffold :comboboxselect  do |config|
   config.list.columns = [:id, :combobox, :answer]
   config.columns = [:answer]
 end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T23:22:39.183

首先，config.list.columns 中引用的所有字段都必须包含在 config.columns 中（任何明确定义的 config.*.columns 字段必须是 config.columns 的子集）。

然后，在每个还没有名称或标题字段或方法的模型中，您必须声明此自定义方法：

```
class Comboboxselect < ActiveRecord::Base
 belongs_to :combobox
 def to_label
  "#{answer}" 
 end
end 
```

请参阅 ActiveScaffold 文档：[描述记录：to_label](https://github.com/activescaffold/active_scaffold/wiki/Describing-Records:-to_label)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T09:31:24.693

当您说显示时，我假设您的意思是在视图中？您可以发布您运行的代码以获得该输出。

在我看来，您只有 Comboboxselect 对象，您是否尝试添加`.answer`到它以访问您想要的属性？

# iphone - 开始使用 OS X 应用程序开发的最快方法是什么？

> ID：874339
> 
> 赞同：3
> 
> 时间：2009-05-17T10:40:57.650
> 
> 标签：iphone, macos, desktop-application

我需要构建一个将在 OS X 上运行的应用程序，轮询数据，并以纯粹的图形方式全屏显示该数据 - 通常是某种表格格式的“标识符：值”文本，但可能带有 spark-显示历史变化的线条和显示更新的“动画”（没什么花哨的，只是褪色的文本和类似的东西）。

但是，我不知道从哪里开始。我没有在 Mac 上开发桌面应用程序或开发的经验。

我应该在哪里/在什么地方寻找 OS X 开发信息，这将使我快速上手（来自网络开发背景）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T11:42:22.637

对于 OS X 开发，以及可以让您快速编写实际应用程序的非常好的概述，我不确定任何东西都可以与 Aaron Hillegass 的书[Cocoa Programming for Mac OS X](https://rads.stackoverflow.com/amzn/click/com/0321503619)相匹配。

许多人认为它是 Cocoa 编程的圣经，并且它是示例驱动的。您正在编写可以实际运行的应用程序。

它对 iPhone 开发很有用，尽管没有那么多用，你在问题中没有提到，但你在标签中提到了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T11:17:47.110

如果你真的想用 OS X 原生，那主要意味着学习 Objective-C 和 Cocoa。您首先要成为[Apple Developer Connection](http://developer.apple.com/) (ADC) 成员并下载 XCode。在 ADC 站点内，有很多可以帮助您入门的信息、Objective C 参考、示例代码等。

根据您的背景，如果您了解 Flex 或 Flash，您可能会考虑将[Adob​​e Air](http://www.adobe.com/products/air/)用于您的应用程序，这可能对您来说更容易学习。

[关于这个主题https://stackoverflow.com/search?q=learn+cocoa](https://stackoverflow.com/search?q=learn+cocoa)的 stackoverflow 上也有几个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T11:35:39.003

看看[http://www.realsoftware.com](http://www.realsoftware.com)。这是一个跨平台的开发环境。易于学习、已建立的用户社区、大量示例、共享代码可帮助您入门。

# jquery - 使用 JQ 切换链接文本的问题

> ID：874346
> 
> 赞同：0
> 
> 时间：2009-05-17T10:43:38.643
> 
> 标签：jquery, toggle

我尝试使用此代码来切换链接上的文本：

```
var showText="<span>Open</span> &darr;";
var hideText="<span>Close</span> &uarr;";
$('h1').before('<a href="javascript:;" id="hc_toggle_close">' + showText + '</a>');
$('#hc_toggle_close').click(function () {
    $('#hc_toggle_close:contains("Open")').html(hideText);
    $('#hc_toggle_close:contains("Close")').html(showText);
}); 
```

但它不起作用！以及通常的 if ... else 构造。有人可以指出我这里出了什么问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T10:51:04.630

使用`toggle`辅助函数：

```
var showText="<span>Open</span> &darr;";
var hideText="<span>Close</span> &uarr;";
$('h1').before('<a href="javascript:;" id="hc_toggle_close">' + showText + '</a>');
$('#hc_toggle_close').toggle(
  function () {
    $('#hc_toggle_close').html(hideText);
  },
  function () {
    $('#hc_toggle_close').html(showText);
  }
); 
```

从以下文档`toggle`：

> 每当单击匹配的元素时，都会触发第一个指定的函数，再次单击时，会触发第二个指定的函数。所有后续的点击继续通过这两个功能旋转。

# visual-studio - 如何将可选组件添加到 Visual Studio 安装和部署项目？

> ID：874350
> 
> 赞同：2
> 
> 时间：2009-05-17T10:47:13.610
> 
> 标签：visual-studio, installation, setup-deployment

我正在尝试使用 Visual Studio 创建一个非常基本的“设置和部署”项目。我想要的是能够选择要安装的*组件。*假设每个组件都包含在单个类库的主要输出中（即每个组件实际上是单个模块或已编译的程序集）。

我还没有在标准的可用对话框集中看到这样的选项。但是我已经看到，只要稍加努力，我们就可以以某种方式创建[自定义对话框](http://www.codeproject.com/KB/install/vsSetupCustomDialogs.aspx "自定义对话框")。

*   **作为设置和部署项目的一部分，我如何以编程方式检测哪些组件可用？**（即，即使在安装中添加或删除组件时，我也希望项目能够正常工作）

*   **如何扩展或创建显示可用组件列表的自定义对话框？**

*   **如何检测最终用户选择安装的组件？**

我对 Orca 有点熟悉，它是操作 .msi 文件的工具以及像 InstallShield 这样的成熟安装程序应用程序，但我想只使用原始 Visual Studio 和其他可用的开源工具来实现这一点。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T16:36:24.023

VDP（Visual Studio 部署项目）不适用于这类东西（阅读：改用 Wix）：

1.  （我猜你在运行时想要这个）你可以使用[MsiQueryComponentState](http://msdn.microsoft.com/en-us/library/aa370360(VS.85).aspx)但为此你需要传递**在 VDP 中你无法控制的组件 GUID。**
2.  这是开箱即用的，除了 VDP 之外的所有内容。
3.  （我猜你在设置时想要这个......）你可以使用 Condition 来执行基于*Component Install State*的自定义操作，在 VDP 中你无法控制组件 ID（不要与组件 guid），这是执行组件条件所需的。

# .net - 在 MySQL .NET Provider 中使用命名参数

> ID：874353
> 
> 赞同：1
> 
> 时间：2009-05-17T10:49:19.223
> 
> 标签：.net, mysql

在 MySQL .NET 提供程序中，您可以在语法中使用命名参数：

```
?parametername 
```

现在，我正在尝试为将在“IN”列表中使用的参数创建一个命名参数，例如：

```
select * from mytable where id in (?ids) 
```

我如何使用命名参数，如果我使用varchar，它将在列表之前和之后添加引号，即：

如果我使用 varchar 传递参数的值：

```
cmd.Parameters.Add("?ids", MySqlDbType.Varchar).Value = ids; // ids is a string which contains the ids separated by commas, e.g. 1, 2, 3 .. etc 
```

查询将像这样执行：

```
select * from mytable where id in ('1, 2 ,3') 
```

当然这会抛出一个错误，如何在不获取引号的情况下传递命名参数，这是它应该执行的方式：

```
select * from mytable where id in (1, 2 , 3) 
```

有什么解决方法吗？我目前正在使用 String.Format() 但想使用命名参数，这可能吗？

PS我只使用纯文本语句，没有sproc，所以这些都不会传递给sproc（以防你认为这是不可能的，因为sprocs不接受数组）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T11:23:26.147

这个问题在这里被问了很多次，我停下来数了数。

无论技术如何，答案总是相同的。您只需将尽可能多的参数添加到您的查询中，因为您计划拥有 IN“参数”。

如果你想查询`WHERE id IN (1, 2 ,3)`，你准备好的语句必须是这样的：

```
SELECT * FROM mytable WHERE id IN (?, ?, ?) 
```

使用您认为合适的任何字符串构建工具来制作这样的 SQL 字符串。之后，将三个参数值添加到其中。

将 SQL 代码与数据分开是准备好的语句的全部意义所在。逗号是 SQL 代码，你永远不会将它们放入带有单个参数的语句中，它们必须在*before*中。

好的，还有*一种*选择。制作一个单独的/临时表，将您的 ID 存储在其中并查询如下内容：

```
SELECT
  * 
FROM 
  mytable m
  INNER JOIN searchtable s ON m.id = s.id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T11:27:27.557

问题是您不只传递一个参数。你想传递一组参数。据我所知，目前尚不支持此功能（没有用于数组或集合的 DbType）。因此，您不能将多个值添加为一个参数。

由于（我假设）“ids”中的数字元素可能会有所不同，因此您需要更改命令字符串以具有正确数量的参数。可以使用一些循环来生成命令字符串并用它们各自的值填充参数。这基本上意味着您正在为每个查询创建一个新命令。

另一种解决方案是使用一个存储过程，它获取您的逗号分隔列表并使用它来构建查询。

# unit-testing - BizTalk 测试具有多个输入 xml 的映射，还是问题在于内联 C#？

> ID：874356
> 
> 赞同：1
> 
> 时间：2009-05-17T10:54:20.600
> 
> 标签：unit-testing, map, biztalk

谁能解释如何让具有多个输入的 BizTalk 映射的单元测试工作？

我一直很高兴地使用 Michael Stephenson[博客](http://geekswithblogs.net/michaelstephenson/archive/2008/03/30/120851.aspx)上的示例来测试我的地图，但我刚刚尝试了我的第一个多输入地图，但它失败了 :-(

我使用 VS2005“测试地图”首先生成带有两个输入消息的输入实例，然后使用该文件的各种作为测试输入......

```
<ns0:Root xmlns:ns0="http://schemas.microsoft.com/BizTalk/2003/aggschema">
  <InputMessagePart_0>
    ...
  </InputMessagePart_0>
  <InputMessagePart_1>
    ...
  </InputMessagePart_1>
</ns0:Root> 
```

当我使用 VS 测试地图时，这些测试消息会生成预期的输出，但是当我尝试单元测试时缺少一个部分。

我唯一能想到的是地图在......*脚本，表格提取器和表格循环*......

单元测试调用 StreamingTransform.ScalableTransform ...

```
// This is the BizTalk Server 2006 way of calling 
mapInstance.StreamingTransform.Transform(inputStream, 
    mapInstance.TransformArgs, outputStream, resolver);
// This is the R2 way of calling
XmlReader xmlRdr = new XmlTextReader(inputStream);
mapInstance.StreamingTransform.ScalableTransform(xmlRdr, 
    mapInstance.TransformArgs, outputStream, 
    resolver, whitespaceCorrect); 
```

并且使用 Transform.Transform 的替代方法也不起作用......

```
XPathDocument doc = new XPathDocument(inputStream);
mapInstance.Transform.Transform(doc, mapInstance.TransformArgs, outputStream); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T09:48:18.453

你有没有试过这个：

```
mapInstance.Transform.Transform(
   multi-part input message filepath, out put file path); 
```

这个对我有用。我已声明`mapInstance`为`Map`该类的对象（未声明为`TestableMapBase`）。

# asp.net - 如何访问嵌套母版页内的控件？为什么它的行为与内容页面不同？

> ID：874357
> 
> 赞同：7
> 
> 时间：2009-05-17T10:55:00.817
> 
> 标签：asp.net, master-pages, nested

这两种情况是否有区别：

(1) 从普通子级访问母版页上的属性

(2) 从嵌套母版页访问母版页上的属性

我试图从这样的内容页面访问母版页中的文本框：

```
TextBox a;
a = (TextBox)Master.FindControl("ayyash"); // Master is declared in MasterType directive
defaultTextbox.Text = a.Text; // defaultTextBox is a textbox control inside default.aspx 
```

它可以工作，但是当我在嵌套母版页上应用相同的方法时：

```
TextBox a;
a = (TextBox)Master.FindControl("ayyash"); // Master is declared in MasterType directive
myTextBox.Text = a.Text; // myTextBox is a textbox control inside child.master 
```

这不起作用，我错过了什么吗？我在regulare page_load处理程序中调用这两个代码......

我还注意到我无法从后面的代码中设置嵌套母版页内的文本框值，我肯定缺少一些东西，它是什么？为了阐明这个问题，这里有一个例子：

嵌套母版页：

```
<%@ Master Language="C#" MasterPageFile="MasterPage.master" AutoEventWireup="false" CodeFile="MasterPage2.master.cs" Inherits="MasterPage2" %>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">

<asp:textbox id="tx2" runat="server" text="this is two"></asp:textbox>
<asp:contentplaceholder id="newstuff" runat="server"></asp:contentplaceholder>
</asp:Content> 
```

后面的代码：

```
Response.Wrote(tx2.Text); 
```

我什么都没有，为什么我错过了什么？请注意，我还尝试了递归查找控件：

```
String str = ((TextBox)((Content)FindControl("Content2")).FindControl("tx2")).Text; 
```

依然没有

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-15T06:16:51.040

```
ContentPlaceHolder cp = (ContentPlaceHolder)this.Master.Master.FindControl("ContentPlaceHolder1");
  //base content place holder id

Label objLabel3 = (Label)cp.FindControl("lblNested");
  //lblNested is id in nested master page 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T05:32:53.257

我在这里读了几件事： [http](http://www.odetocode.com/Articles/450.aspx) ://www.odetocode.com/Articles/450.aspx 发现中间的嵌套页面从不调用 Page_Load！相反，它会触发一个加载事件，您可以捕获该事件以设置任何字段，因此答案是：在嵌套页面上执行以下操作：

```
protected override void OnLoad(EventArgs e)
    {
        myTextBox.Text = "anything";
        base.OnLoad(e);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T11:59:18.197

这应该没有任何问题，所以其他东西一定是错的。我只是在一个简单的测试项目中尝试过，在这两种情况下都可以在母版页上找到控件。

如果您在嵌套母版页中引用正确的母版页，我会再次检查。您还可以检查`Master`嵌套母版页内属性的运行时类型。它应该是您的母版页的类型。

**编辑**：我认为问题在于从嵌套母版页中找到根母版页中的控件，这应该可以正常工作。要在嵌套母版页的内容占位符内查找控件，请查看以下[论坛帖子](http://forums.asp.net/t/1059255.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-06T04:10:35.483

您可以使用以下指令从内容页面对母版页和嵌套页面中的内容进行绝对控制：

```
<%@ MasterType VirtualPath="your_master.master" %>
<%@ Reference VirtualPath="~/your_master.master" %> 
```

请参阅 K. Scott Allen 在[Ode To Code中的出色文章](http://odetocode.com/blogs/scott/archive/2005/11/11/strong-typing-and-nested-master-pages.aspx)

# java - Swing：创建一个可拖动的组件...？

> ID：874360
> 
> 赞同：24
> 
> 时间：2009-05-17T10:56:59.110
> 
> 标签：java, swing, drag-and-drop, draggable

我在网上搜索了可拖动的 Swing 组件的示例，但我发现了不完整或无效的示例。

我需要的是一个**Swing 组件**，它可以通过鼠标**拖动**到另一个组件中。在被拖动时，它应该**已经改变**了它的位置，而不仅仅是“跳”到它的目的地。

*我会很感激没有非标准 API 的例子。*

谢谢你。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-17T11:43:03.023

我提出了一个简单但运行良好的解决方案，由我自己发现；）

我该怎么办？

*   按下鼠标时，我会记录**光标****在 screen 上**的位置以及**组件的**位置。
*   当鼠标被拖动时，我计算新光标和旧**光标****在屏幕上**的位置之间的**差异，并****通过这个差异来**移动组件。

 *******在 Linux（OpenSuse、KDE3）下使用最新的 JDK 6 进行了测试，
但是，嘿，它是 Java Swing，应该在任何地方都能正常工作。*

**代码如下：**

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.*;

public class MyDraggableComponent
    extends JComponent {

  private volatile int screenX = 0;
  private volatile int screenY = 0;
  private volatile int myX = 0;
  private volatile int myY = 0;

  public MyDraggableComponent() {
    setBorder(new LineBorder(Color.BLUE, 3));
    setBackground(Color.WHITE);
    setBounds(0, 0, 100, 100);
    setOpaque(false);

    addMouseListener(new MouseListener() {

      @Override
      public void mouseClicked(MouseEvent e) { }

      @Override
      public void mousePressed(MouseEvent e) {
        screenX = e.getXOnScreen();
        screenY = e.getYOnScreen();

        myX = getX();
        myY = getY();
      }

      @Override
      public void mouseReleased(MouseEvent e) { }

      @Override
      public void mouseEntered(MouseEvent e) { }

      @Override
      public void mouseExited(MouseEvent e) { }

    });
    addMouseMotionListener(new MouseMotionListener() {

      @Override
      public void mouseDragged(MouseEvent e) {
        int deltaX = e.getXOnScreen() - screenX;
        int deltaY = e.getYOnScreen() - screenY;

        setLocation(myX + deltaX, myY + deltaY);
      }

      @Override
      public void mouseMoved(MouseEvent e) { }

    });
  }

}

public class Main {

  public static void main(String[] args) {
    JFrame f = new JFrame("Swing Hello World");

    // by doing this, we prevent Swing from resizing
    // our nice component
    f.setLayout(null);

    MyDraggableComponent mc = new MyDraggableComponent();
    f.add(mc);

    f.setSize(500, 500);

    f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
    f.setVisible(true);
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T09:28:20.037

另外，我发现可以在 JFrame 中创建**JInternalFrame**，但问题是：你总是得到一个**烦人的窗口标题栏**。

遗憾的是，要禁用标题栏，需要一个肮脏的**解决方法**：

```
public class MyDraggableComponent extends JInternalFrame {

  public MyDraggableComponent() {
    InternalFrameUI thisUI = getUI();
    if (thisUI instanceof BasicInternalFrameUI) {
      ((BasicInternalFrameUI) thisUI).setNorthPane(null);
    }

} 
```

我真的很怀念像“someInternalFrame.setWindowTitleBar(false)”这样的方法......
:'(

# c# - 什么是更好的？静态方法或实例方法

> ID：874363
> 
> 赞同：9
> 
> 时间：2009-05-17T10:59:16.127
> 
> 标签：c#

我发现有两种方法称为静态方法和实例方法及其区别。但我仍然无法理解一个比另一个的优势。

有时我觉得静态方法不是 100% 面向对象的。

这两者之间是否有任何性能差异。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T11:08:32.390

在一个完美的 OO 世界中，可能不需要静态方法（我认为 Eiffel 也没有它们）。但归根结底，重要的不是代码的 OO 纯度（C# 有足够多的概念，这些概念并不是严格意义上的 OO，例如扩展方法），而是你要完成的工作。

您可以将静态方法用于一般帮助器方法（不需要一般帮助器类或自己的状态）或 Color.FromARGB() 之类的东西，它们对于值类型的行为有点类似于构造函数。

一般而言，任何不涉及对象状态（因此更特定于类而不是特定于对象）的方法都可以设为静态。性能差异不应该真的出现。无论如何，不​​是很可衡量。Jan Gray 的精彩文章[编写更快的托管代码：了解成本](http://msdn.microsoft.com/en-us/library/ms973852.aspx)有一些硬数据，尽管要小心处理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T11:24:55.673

静态方法的用处主要体现在您需要调用该方法而无需实例化对象时。例如，静态方法可能用于实际查找现有实例并返回它（一个示例是单例实例）。

正如其他人所说，如果它不访问状态，您可以将任何方法设为静态，并且您将获得微小的性能改进。

如果您确实希望能够在特定实例上调用该方法，并获得多态性的好处（即派生类可以覆盖该方法的行为），那么您应该将其设为实例方法。

如果你的类实现了接口，那么属于这些接口的方法也必须声明为实例方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-17T11:33:04.127

实例方法与实例紧密相关。所以你可以看到静态方法的一个优点是对实例不紧。其他对象可以（如果可见）使用静态方法来解决它们的问题。有时这很好而且需要。然后，您必须考虑将静态方法保留在同一个类中，或者是否开始构建实用程序类以供更广泛使用。我不会看到使用“更少 OO”的静态方法。静态方法是规避 OO 缺点的一种方法（尤其是在单继承语言中）。您可以将其称为更实用的方法（我知道它不是真的）。

考虑到这一切只是一堆你应该问你的代码的问题，它应该确定它是更好的实例方法、同一类的静态方法还是另一个类的静态方法。

我什至不会考虑性能问题。它会削弱您的设计，并且差异并不是那么大。如果您遇到性能问题，性能很重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T11:02:31.420

实例方法需要传递一个隐式参数（`this`引用），这使得它们比方法稍慢`static`。但这真的不应该是偏爱它们的理由。

有关相关讨论，请查看：

[*可以*为静态的C#方法应该是静态的吗？](https://stackoverflow.com/questions/731763/should-c-methods-that-can-be-static-be-static)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T11:06:00.150

如果您的方法使用非静态数据成员，请不要将其设为静态（“不能”）。

如果您的方法不使用任何非静态数据成员，则可以将其设为静态，但这主要取决于您的设计，而不是它是否使用非静态成员（正如 Mehrdad 所说，无论如何性能差异不大）。

如果您的类中没有非静态数据成员，则有时最好将所有方法设为静态（例如为了良好的顺序而将辅助函数分组到一个类下）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T11:04:12.463

我部分猜测基于 C# 的遗产，但我怀疑它与其他 OO 语言相同。

静态方法不需要对象来处理。一个很好的例子是：

```
Double pi = Math.PI. 
```

实例方法确实需要一个对象。一个例子是：

```
Integer x = 9;
Integer y = x.sqrt(); 
```

并非属于某个类的所有信息都需要为该类实例化的对象才能访问它。所有可用于创建对象的常量（`Math.PI`、`Window.OVERLAPPED`等）都是最好的例子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-27T13:43:03.250

没有一个比另一个更好。这真的取决于你的要求。当您想将更改应用到整个类时，将调用类方法。而当您不将更改应用于类而是应用于该类的唯一实例（对象）时，将调用实例方法。

所以我看不出一个应该比另一个更好的理由。

# javascript - 100% 窗口的背景图像（并随之调整大小）

> ID：874372
> 
> 赞同：3
> 
> 时间：2009-05-17T11:07:51.113
> 
> 标签：javascript, jquery, image

### 副本：

[拉伸和缩放 CSS 背景](https://stackoverflow.com/questions/376253/stretch-and-scale-css-background)
[如何拉伸背景图像以覆盖整个 HTML 元素？](https://stackoverflow.com/questions/235855/how-do-i-stretch-a-background-image-to-cover-the-entire-html-element)
[背景图像不会拉伸整个页面宽度](https://stackoverflow.com/questions/645279/background-image-doesnt-stretch-full-page-width)

我有一个网页背景图片，需要以 100% 的窗口大小完全显示。如果调整窗口大小，则图像需要随之调整大小，以保持 100%。

CSS 不允许您设置背景图像的大小，只能设置它的重复方式。（但我想把它拉长）

我认为 jQuery 是实现这一点的最安全和最快的方法，可以克服浏览器不兼容问题。或者这可以使用常规 javascript 快速完成吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T11:11:49.417

您可能会对此链接感兴趣：

[如何在网页中拉伸背景图像](http://webdesign.about.com/od/css3/f/blfaqbgsize.htm)

# ruby-on-rails - 简单的验证码 - 如何测试？

> ID：874377
> 
> 赞同：0
> 
> 时间：2009-05-17T11:09:47.440
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-plugins

我正在使用 Simple Captcha 插件来生成验证码。有谁知道我如何修改 Rails 测试来处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-01T12:10:14.347

如果 RAILS_ENV 为“test”，简单验证码会自动返回验证码有效。从源代码：

```
def simple_captcha_valid?
  return true if RAILS_ENV == 'test'
... 
```

# c# - WPF：如何循环浏览窗口中的所有控件？

> ID：874380
> 
> 赞同：21
> 
> 时间：2009-05-17T11:11:52.773
> 
> 标签：c#, .net, wpf

如何循环遍历 WPF 窗口中的所有控件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-07-18T10:10:57.640

我在[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper.aspx)中找到了这个，所以它很有帮助。

```
// Enumerate all the descendants of the visual object.
static public void EnumVisual(Visual myVisual)
{
    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(myVisual); i++)
    {
        // Retrieve child visual at specified index value.
        Visual childVisual = (Visual)VisualTreeHelper.GetChild(myVisual, i);

        // Do processing of the child visual object.

        // Enumerate children of the child visual object.
        EnumVisual(childVisual);
    }
} 
```

对我来说看起来更简单。我用它来查找表单中的文本框并清除它们的数据。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-05-03T22:51:20.290

这种方式优于 MSDN 方法，因为它是可重用的，并且它允许提前中止循环（即 via、`break;`等）——它优化了 for 循环，因为它为每次迭代保存了一个方法调用——并且它还允许您使用常规 for 循环来遍历 Visual 的子级，甚至递归它的子级和大子级——因此使用起来要简单得多。

要使用它，您可以编写一个常规的 foreach 循环（甚至使用 LINQ）：

```
foreach (var ctrl in myWindow.GetChildren())
{
    // Process children here!
} 
```

或者，如果您不想递归：

```
foreach (var ctrl in myWindow.GetChildren(false))
{
    // Process children here!
} 
```

为了让它工作，你只需要把这个扩展方法放到任何一个静态类中，然后你就可以在任何时候编写像上面这样的代码：

```
public static IEnumerable<Visual> GetChildren(this Visual parent, bool recurse = true)
{
    if (parent != null)
    {
        int count = VisualTreeHelper.GetChildrenCount(parent);
        for (int i = 0; i < count; i++)
        {
            // Retrieve child visual at specified index value.
            var child = VisualTreeHelper.GetChild(parent, i) as Visual;

            if (child != null)
            {
                yield return child;

                if (recurse)
                {
                    foreach (var grandChild in child.GetChildren(true))
                    {
                        yield return grandChild;
                    }
                }
            }
        }
    }
} 
```

此外，如果您不喜欢默认启用递归，您可以将扩展方法的声明更改`recurse = false`为默认行为。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-17T11:43:14.757

获取控件所有子组件列表的类：

```
class Utility
    {
        private static StringBuilder sbListControls;

        public static StringBuilder GetVisualTreeInfo(Visual element)
        {
            if (element == null)
            {
                throw new ArgumentNullException(String.Format("Element {0} is null !", element.ToString()));
            }

            sbListControls = new StringBuilder();

            GetControlsList(element, 0);

            return sbListControls;
        }

        private static void GetControlsList(Visual control, int level)
        {
            const int indent = 4;
            int ChildNumber = VisualTreeHelper.GetChildrenCount(control);

            for (int i = 0; i <= ChildNumber - 1; i++)
            {
                Visual v = (Visual)VisualTreeHelper.GetChild(control, i);

                sbListControls.Append(new string(' ', level * indent));
                sbListControls.Append(v.GetType());
                sbListControls.Append(Environment.NewLine);

                if (VisualTreeHelper.GetChildrenCount(v) > 0)
                {
                    GetControlsList(v, level + 1);
                }
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-22T14:47:26.500

我已经使用以下内容来获取所有控件。

```
 public static IList<Control> GetControls(this DependencyObject parent)
    {            
        var result = new List<Control>();
        for (int x = 0; x < VisualTreeHelper.GetChildrenCount(parent); x++)
        {
            DependencyObject child = VisualTreeHelper.GetChild(parent, x);
            var instance = child as Control;

            if (null != instance)
                result.Add(instance);

            result.AddRange(child.GetControls());
        } 
        return result;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-06T02:51:24.840

MSDN 答案的细微变化......只需将一个空的 Visual 对象列表传入其中，您的集合将填充所有子视觉对象：

```
/// <summary>
/// Enumerate all the descendants (children) of a visual object.
/// </summary>
/// <param name="parent">Starting visual (parent).</param>
/// <param name="collection">Collection, into which is placed all of the descendant visuals.</param>
public static void EnumVisual(Visual parent, List<Visual> collection)
{
    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(parent); i++)
    {
        // Get the child visual at specified index value.
        Visual childVisual = (Visual)VisualTreeHelper.GetChild(parent, i);

        // Add the child visual object to the collection.
        collection.Add(childVisual);

        // Recursively enumerate children of the child visual object.
        EnumVisual(childVisual, collection);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-15T20:10:52.247

前面的答案都将返回由`VisualTreeHelper.GetChildrenCount`和标识的孩子`VisualTreeHelper.GetChild`。但是，我发现对于 a `TabControl`，`TabItem`s 及其内容没有被识别为子项。因此，这些将被省略，我认为最初的问题（“窗口中的所有控件”）希望将它们包括在内。

要正确循环通过选项卡式控件，您将需要这样的东西（根据@BrainSlugs83 的答案修改）：

```
public static IEnumerable<Visual> GetChildren(this Visual parent, bool recurse = true)
{
    if (parent != null)
    {
        int count = VisualTreeHelper.GetChildrenCount(parent);
        for (int i = 0; i < count; i++)
        {
            // Retrieve child visual at specified index value.
            var child = VisualTreeHelper.GetChild(parent, i) as Visual;

            if (child != null)
            {
                yield return child;

                if (recurse)
                {
                    foreach (var grandChild in child.GetChildren(true))
                    {
                        yield return grandChild;
                    }

                    // Tabs and their content are not picked up as visual children
                    if (child is TabControl childTab)
                    {
                        foreach (var childTabItem in childTab.Items)
                        {
                            yield return childTabItem;
                            foreach (var childTabItemChild in childTabItem.GetChildren(true))
                            {
                                yield return childTabItemChild;
                            }
                            if (childTabItem.Content != null && childTabItem.Content is Visual childTabItemContentAsVisual)
                            {
                                yield return childTabItemContentAsVisual;
                                foreach (var childTabItemGrandChild in childTabItemContentAsVisual.Children(true)
                                {
                                    yield return childTabItemGrandChild;
                                }
                            }
                        }
                    }
                }
            }
        }
    }
} 
```

或者，您可以迭代逻辑树而不是可视树：

```
public static IEnumerable<DependencyObject> GetLogicalChildren(this DependencyObject parent, bool recurse = true)
{
    if (parent == null) yield break;

    foreach (var child in LogicalTreeHelper.GetChildren(parent).OfType<DependencyObject>())
    {
        yield return child;
        if (recurse)
        {
            foreach (var grandChild in child.GetLogicalChildren(true))
            {
                yield return grandChild;
            }
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-17T17:49:43.260

我自己尝试过，我发现了一个优雅的解决方案，它也适用于任何场景，不像这里发布的所有过度设计和损坏的解决方案。这里的大多数答案都是过度设计且不稳定的。

这个想法是循环通过 Windows Presentation Foundation 中的父控件来获取所需类型或类型的子控件。

首先，您需要一个具有整数的循环，最好设置为零，并使用索引和一个 VisualTreeHelper 对象，该对象将父控件中的所有对象计数为循环的条件。

```
 for(int ControlCounter = 0; ControlCounter <= VisualTreeHelper.GetChildrenCount(MaterialsContentComputerSystemsFoundationYear) - 1; ControlCounter++)
  {
          if(VisualTreeHelper.GetChild(MaterialsContentComputerSystemsFoundationYear, ControlCounter).GetType() == File1.GetType())
          {

                    Button b = (Button)VisualTreeHelper.GetChild(MaterialsContentComputerSystemsFoundationYear, ControlCounter);

                    if (ActualButtonControlIndex == App.FileIndex[ActualButtonControlIndex])
                    {

                    }
                    else
                    {
                        b.Visibility = Visibility.Hidden;
                    }

                    ActualButtonControlIndex++;

                    System.Diagnostics.Debug.WriteLine(ActualButtonControlIndex + "  Button");
          }         
  } 
```

在 for 循环中，您可以创建一个条件语句来验证当前索引处的当前控件类型是否与所需的控件类型相同。在此示例中，我使用了一个名为的控件，它是当前搜索的所需控件类型的一部分。您可以使用存储按钮的变量来进行类型比较。

```
 var b = new Button();

  for(int ControlCounter = 0; ControlCounter <= VisualTreeHelper.GetChildrenCount(MaterialsContentComputerSystemsFoundationYear) - 1; ControlCounter++)
  {
          if(VisualTreeHelper.GetChild(MaterialsContentComputerSystemsFoundationYear, ControlCounter).GetType() == b.GetType())
          {

                    Button B = (Button)VisualTreeHelper.GetChild(MaterialsContentComputerSystemsFoundationYear, ControlCounter);

                    if (ActualButtonControlIndex == App.FileIndex[ActualButtonControlIndex])
                    {

                    }
                    else
                    {
                        B.Visibility = Visibility.Hidden;
                    }

                    ActualButtonControlIndex++;

                    System.Diagnostics.Debug.WriteLine(ActualButtonControlIndex + "  Button");
          }         
  } 
```

在 for 循环的条件语句中，将创建所需控件类型的对象，该对象的值设置为当前索引处的 VisualTreeHelper 对象的值，该对象的值被强制转换为 Button 类型。

您可以使用前面提到的按钮将大小、内容、颜色等属性设置到应用程序窗口中的控件，在该窗口的父控件中，在当前索引处。

```
 var b = new Button();

  for(int ControlCounter = 0; ControlCounter <= VisualTreeHelper.GetChildrenCount(MaterialsContentComputerSystemsFoundationYear) - 1; ControlCounter++)
  {
          if(VisualTreeHelper.GetChild(MaterialsContentComputerSystemsFoundationYear, ControlCounter).GetType() == b.GetType())
          {

                    Button B = (Button)VisualTreeHelper.GetChild(MaterialsContentComputerSystemsFoundationYear, ControlCounter);

                    if (ActualButtonControlIndex == App.FileIndex[ActualButtonControlIndex])
                    {
                        B.Content = "Hello";
                        B.FontSize = 20;
                        B.BackGround = new SolidColorBrush(Colors.Red);

                    }
                    else
                    {
                        B.Visibility = Visibility.Hidden;
                    }

                    ActualButtonControlIndex++;

                    System.Diagnostics.Debug.WriteLine(ActualButtonControlIndex + "  Button");
          }         
  } 
```

这个解决方案是模块化的、简单的和超级稳定的，因此在任何场景中都很有用，给个赞吧。

# silverlight-3.0 - silverlight 3最小化到托盘+从桌面拖放？

> ID：874385
> 
> 赞同：3
> 
> 时间：2009-05-17T11:16:18.627
> 
> 标签：silverlight-3.0

有谁知道silverlight 3是否支持最小化到托盘和从桌面拖放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-25T15:54:53.570

不是 SL3。您可以“离开浏览器”，但由于沙箱，没有桌面交互。

SL4 确实有一些允许弹出窗口（toast）的功能——这很可能会在明年年中发布。有关这方面的更多信息，请参见 www.silverlight.net。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-06T15:17:35.007

只是为了添加到马克的答案

SL3 中没有拖放，但现在可以将 SL4 控件设置为放置目标 - Jesse Liberty 在[http://www.silverlight.net/learn/videos/silverlight-4-beta-上有一个很好的演示视频/silverlight-controls-drop-targets/](http://www.silverlight.net/learn/videos/silverlight-4-beta-videos/silverlight-controls-drop-targets/)

# bash - 使用函数测试未设置的 Bash 变量

> ID：874389
> 
> 赞同：28
> 
> 时间：2009-05-17T11:18:56.797
> 
> 标签：bash, variables, undefined

一个简单的 Bash 变量测试如下：

```
${varName:?    "${varName} is not defined"} 
```

我想通过将它放在一个函数中来重用它。我该怎么做？

以下失败

```
#
# Test a variable exists
tvar(){
 val=${1:?    "${1}    must be defined, preferably in $basedir"}
 if [ -z ${val}  ]
     then
     echo Zero length value
 else
     echo ${1} exists, value ${1}
 fi
} 
```

即，如果测试失败，我需要退出。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-09-24T02:04:30.513

感谢**lhunath 的**回答，我被引导到 Bash`man`页面的一部分，我已经忽略了数百次：

```
    当不执行子字符串扩展时，bash 测试一个参数
    未设置或为空；省略冒号会导致仅对参数进行测试
    三是未设置。

```

这促使我创建了以下真值表：

```
                | 未设置 | 设置 | 设置和 | 意义
                | | 但为空| 不为空 |
    ============+========+===========+==========+======= =======================
     ${var-_} | T | F | T | 不为空或未设置
    ------------+--------+----------+----------+-------- ----------------------
     ${var:-_} | T | T | T | 总是正确的，用于替代。
    ------------+--------+----------+----------+-------- ----------------------
     $变量 | F | F | T | var 已设置且不为空
    ------------+--------+----------+----------+-------- ----------------------
     ${!var[@]} | F | T | T | var 已设置

```

该表在最后一行介绍了规格。Bash`man`页面显示“如果 name 不是数组，如果 name 已设置则扩展为 0，否则扩展为 null。” 出于这个真值表的目的，即使它是一个数组，它的行为也是一样的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-17T12:36:17.467

您正在寻找的是间接性。

```
assertNotEmpty() {
    : "${!1:? "$1 is empty, aborting."}"
} 
```

如果您执行以下操作，这会导致脚本中止并显示错误消息：

```
$ foo=""
$ assertNotEmpty foo
bash: !1:  foo is empty, aborting. 
```

如果您只想**测试**是否`foo`为空，而不是中止脚本，请使用 this 而不是函数：

```
[[ $foo ]] 
```

例如：

```
until read -p "What is your name? " name && [[ $name ]]; do
    echo "You didn't enter your name.  Please, try again." >&2
done 
```

另外，请注意**空**参数和未**设置**参数之间有一个**非常重要的区别。**您应该注意不要混淆这些术语！空参数是已设置但仅设置为空字符串的参数。未设置的参数是根本不存在的参数。

 ****前面的示例都测试**空**参数。如果要测试未**设置**的参数并认为所有设置的参数都可以，无论它们是否为空，请使用以下命令：

```
[[ ! $foo && ${foo-_} ]] 
```

在这样的函数中使用它：

```
assertIsSet() {
    [[ ! ${!1} && ${!1-_} ]] && {
        echo "$1 is not set, aborting." >&2
        exit 1
    }
} 
```

仅当您传递的参数名称表示未设置的参数时，才会中止脚本：

```
$ ( foo="blah"; assertIsSet foo; echo "Still running." )
Still running.
$ ( foo=""; assertIsSet foo; echo "Still running." )
Still running.
$ ( unset foo; assertIsSet foo; echo "Still running." )
foo is not set, aborting. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-26T19:35:23.797

你想用`[ -z ${parameter+word} ]`

的一部分`man bash`：

```
Parameter Expansion
    ...
    In each of the cases below, word is subject to
    tilde expansion, parameter expansion, command
    substitution, and arithmetic expansion.  When
    not performing substring expansion, bash
    tests for a parameter that is unset or
    null; omitting the colon results in a
    test only for a parameter that is unset.
    ...
    ${parameter:+word}
           Use Alternate Value.  If parameter is
           null or unset, nothing is substituted,
           otherwise the expansion of word is
           substituted.
    ... 
```

换句话说：

```
${parameter+word}
       Use Alternate Value.  If parameter is unset,
       nothing is substituted, otherwise the
       expansion of word is substituted. 
```

一些例子：

```
$ set | grep FOOBAR
$ if [ -z "${FOOBAR+something}" ]; then echo "it is unset"; fi
it is unset
$ declare FOOBAR
$ if [ -z "${FOOBAR+something}" ]; then echo "it is unset"; fi
$ FOOBAR=
$ if [ -z "${FOOBAR+something}" ]; then echo "it is unset"; fi
$ FOOBAR=1
$ if [ -z "${FOOBAR+something}" ]; then echo "it is unset"; fi
$ unset FOOBAR
$ if [ -z "${FOOBAR+something}" ]; then echo "it is unset"; fi
it is unset 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-15T02:09:05.323

*此函数测试当前*设置的变量。变量甚至可以是一个数组。请注意，在 Bash 中：0 == TRUE，1 == FALSE。

```
function var.defined {
    eval '[[ ${!'$1'[@]} ]]'
}

# Typical usage of var.defined {}

declare you="Your Name Here" ref='you';

read -p "What's your name: " you;

if var.defined you; then   # Simple demo using literal text

    echo "BASH recognizes $you";
    echo "BASH also knows a reference to $ref as ${!ref}, by indirection.";

fi

unset you # Have just been killed by a master :D

if ! var.defined $ref; then    # Standard demo using an expanded literal value

    echo "BASH doesn't know $ref any longer";

fi

read -s -N 1 -p "Press any key to continue...";
echo ""; 
```

所以在这里要清楚，该函数测试文字文本。每次在 Bash 中调用命令时，变量*通常*会被基础值“换出”或“替换”，除非：

*   $varRef ($) 被转义：$varRef
*   $varRef 是单引号 '$varRef'

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T12:02:35.257

我没有完全理解你需要什么。尽管如此，我还是想回复你。

> 即如果测试失败，我需要退出。

编码：

```
${varName:?    "${varName} is not defined"} 
```

当没有名为“varName”的变量时，将返回非零退出代码。最后一个命令的退出代码保存在`$?`.

关于您的代码：

```
val=${1:?    "${1}    must be defined, preferably in $basedir"} 
```

也许它没有做你需要的。在`$1`未定义的情况下，`"${1}"`将被替换为空。可能您想使用字面上`${1}`没有替换的单引号。

```
val=${1:?    '${1}    must be defined, preferably in $basedir' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-06T00:54:14.540

不确定这是否正是您想要的，但我在编写新的+复杂脚本时使用的一个方便的技巧是使用“set -o”

> set -o #当它发现一个未设置的变量时，会使脚本炸弹

例如：

> $ grep '$1' chex.sh
> 
> 案例“$1”在
> 
> $ ./chex.sh
> 
> ./chex.sh：第 111 行：$1：未绑定变量
> 
> $ ./chex.sh 富
> 
> 不正确/没有选项通过..退出

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-01T07:40:27.903

```
if set | grep -q '^VARIABLE='
then
    echo VARIABLE is set
fi 
```

# pdf - 一种在线阅读带有注释的 pdf 的技术？

> ID：874390
> 
> 赞同：1
> 
> 时间：2009-05-17T11:19:00.273
> 
> 标签：pdf, open-source, web-applications

是否有显示 PDF 以供在线阅读的开源解决方案？它必须像谷歌图书一样可搜索，并且如果可能的话还可以显示注释？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-23T03:06:45.687

通过“在线阅读”，我假设您的意思是客户端上没有 PDF 阅读器插件。在这种情况下，您需要转换为 HTML

[http://pdftohtml.sourceforge.net/](http://pdftohtml.sourceforge.net/)

如果您不介意失去复制文本的能力，那么转换为 PNG 可能会为您提供更准确的渲染

[http://www.imagemagick.org/](http://www.imagemagick.org/)

无论输出格式如何，您都可以使用原始 PDF 数据管理搜索。一种技术是 mnogosearch

[http://www.mnogosearch.org/](http://www.mnogosearch.org/)

Monogosearch 在内部使用 pdftotext，如果您想编写自己的搜索例程，您可能会发现这很有用。pdftotext 是 Xpdf 实用程序套件的一部分

[http://www.foolabs.com/xpdf/about.html](http://www.foolabs.com/xpdf/about.html)

上面列出的所有工具都可以在 Windows 或 Linux 上使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T17:27:00.033

您可能还对 Vuzit DocuPub 平台感兴趣：http: [//vuzit.com/products/docupub_platform](http://vuzit.com/products/docupub_platform)

显示技术本身不是开源的，但他们提供了一个 API 来访问他们的服务，所以也许值得研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T09:18:00.657

不知道您是否正在寻找要安装的软件或要付费的服务...我已经阅读了很多有关 www.getbackboard.com 的内容（这不是广告，仅报告我读过的内容，也许适合您的需求.. ;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T19:37:15.103

不确定他们是否做注释，但这两个都可以很好地显示 PDF：

[http://pdfmenot.com](http://pdfmenot.com)

[http://docs.google.com](http://docs.google.com)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T19:40:49.137

ICEPdf 最近发布了他们的开源代码。它是基于 Java 的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T04:51:28.183

PyPdf 真的很好。它支持阅读文本以及我知道 itextsharp 不支持的加密。

当然，您必须在 python 中编程，因为 IronPython 的类库还没有达到可以从另一种语言引用它们并使用它们的地步。（但我想他们很快就会有） [PyPdf](http://pybrary.net/pyPdf/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T16:57:46.507

这不是开源的，但无论如何都要检查一下。您可以下载他们的 SDK 的免费试用版进行试用。阅读 PDF 及其注释并不简单，我不会相信开源解码器的生产应用程序。

这是一个在线演示。 [http://www.atalasoft.com/ajaxannotations/default.aspx](http://www.atalasoft.com/ajaxannotations/default.aspx)

另一个不错的 pdf 阅读器是 FoxitReader。

# c++ - Getting the name of a DLL from within the dll

> ID：874408
> 
> 赞同：5
> 
> 时间：2009-05-17T11:31:48.170
> 
> 标签：c++, c, windows

If I have a dll called "foo.dll" and the end user renames it to "bar.dll". After calling to a LoadLibrary, how can I get the name "bar.dll" from inside my dll?

Is it GetModuleFileName(hModule, buffer); ?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T11:45:49.227

yes, you need to store hModule in [DllMain](http://msdn.microsoft.com/en-us/library/ms682583(VS.85).aspx)

```
BOOL WINAPI DllMain(HINSTANCE hinstDLL,  DWORD fdwReason,  LPVOID lpvReserved)
{
  switch (fdwReason)
  {
    case DLL_PROCESS_ATTACH:
      hModule = hinstDLL;
      break;
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T11:48:37.597

You need to provide [DllMain](http://msdn.microsoft.com/en-us/library/ms885202.aspx) function, store the module handle you get passed in a static variable, and then use that variable to call [GetModuleFilename](http://msdn.microsoft.com/en-us/library/ms683197%28VS.85%29.aspx). You should avoid calling GetModuleFilename (or any other function) in DllMain itself, as Windows is very picky about what you can and can't do in there.

# ajax - AJAX 可以传输哪些数据格式？

> ID：874417
> 
> 赞同：10
> 
> 时间：2009-05-17T11:38:18.870
> 
> 标签：ajax, data-formats

我是 AJAX 的新手，但作为概述，我想知道您可以上传和下载哪些格式。它是否仅限于 JSON 或 XML，或者您甚至可以发送 MP3 或 UTF-8 HTML 等二进制类型。最后，您是否可以完全控制数据，字节数组中的字节，或者只是发送/接收的字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T11:43:11.620

如果我们谈论 ajax，我们谈论的是 javascript？关于 XMLHTTPRequest？

XMLHttpRequest 只是一个 http 请求，可以传输一切。但是javascript中没有字节数组。只有字符串、数字等。你从 ajax 调用中得到的每一件事都是一段文本（responseText）。这可能会被解析成 XML（这会给你 reponseXML）。特殊编码应该更多是http传输的问题。

二进制文件不依赖于 ajax，而是依赖于 javascript。有一些奇怪的字符串编码可以在 javascript 中传递字节数据（尤其是图像），但这不是一个通用的解决方案。

HTML 不是问题，这是最突出的用例。从这种类型的请求中，您将获得一个 HTML 字符串，并将其添加到解析 HTML 的每个 innerHTML 的 DOM 中的某个节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T12:02:22.103

由于数据是通过 HTTP 传输的，因此您必须确保使用某种编码。最流行的一种是 base64 编码。您可以在以下网址找到更多信息：[http ://www.webtoolkit.info/javascript-base64.html](http://www.webtoolkit.info/javascript-base64.html)

该方法是对您想要发送的数据进行 base64 编码，然后在服务器（或客户端）对数据进行 base64 解码，并按照您的意图使用原始数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T11:40:28.913

您可以传输任何类型的数据，无论是字符串还是字节

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T11:41:26.087

您可以发送任何您喜欢的东西，问题可能是收到后如何处理；）

标准 HTML 可能是最常见的 ajax 内容类型——您也可以选择字符编码，尽管最好始终坚持使用一种编码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T12:56:36.560

AJAX 仅仅意味着您通过 HTTP 使用 JavaScript 调用异步传输数据。因此，您的脚本使用 XmlHttpRequest() 对象发出“正常”HTTP 请求。但是，顾名思义，它实际上只适用于基于文本的数据格式，因为您通常希望使用从服务器返回的数据在客户端执行一些操作（尽管并非总是如此，有时人们只是将 XmlHttpRequests 发送到更新服务器上的某些内容）。

顺便说一句，我从来没有见过一个应用程序可以发送二进制数据。

大多数情况下，人们选择使用 POST 或 GET 将数据发送到服务器（这基本上是一种传输 HTTP 固有的名称-值对的方法）。为了发送更复杂的数据，例如层次结构，它们需要以某种方式进行编码。XML 文档可以通过 JavaScript 本地生成，发送到服务器并解析为任何必要的数据类型。但由于 XML 可能有点麻烦，因此许多开发人员使用 JSON 编码数据代替，因为它易于生成且易于解析。

服务器发回的内容同样具有任意性。通常，您在 Javascript 中指定处理传入数据的回调函数。同样，流行的选择是 XML 和 JSON，它们很容易分别解析为文档对象或数组结构。您也可以发送纯文本或其他一些包装，但请记住，您必须自己负责从中提取可用数据。有时，将实际的 HTML 片段发送到客户端以直接更新页面上的内容也可能是有益的。

对于初学者，我建议你看看 JQuery。这是一个非常轻量级的框架，它抽象了许多邪恶的兼容性内容，让您可以非常好地编写 AJAX 请求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T11:43:22.680

您可以移动任何可以通过 HTTP 发送的内容。对与加载页面相同的域进行调用存在限制，但对传输的内容没有限制。您也可以进行 GET 或 POST 交易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T12:42:02.213

有一个名为[DUI.Stream 和 MXHR的](http://blog.digg.com/?p=621)[Digg 博客](http://blog.digg.com/)条目展示了他们所谓的“Multipart XMLHttpRequests”。现在是 alpha 代码，但是有一个[处理图像的演示](http://demos.digg.com/stream/imageDemo.html)。

# silverlight - 将 HTTP Auth 凭据传递给 SOAP Web 服务

> ID：874419
> 
> 赞同：0
> 
> 时间：2009-05-17T11:40:00.113
> 
> 标签：silverlight, web-services, soap

我正在使用一个 SOAP Web 服务 (ASMX)，它在我的 Silverlight 应用程序中得到了 HTTP Auth 保护。如何将我的凭据传递给 Web 服务？

```
 bb_webservice = new BlackberryWSSoapClient();
        bb_webservice.GetLatestLocationsCompleted += new EventHandler<GetLatestLocationsCompletedEventArgs>(ws_proxy_GetLatestLocationsCompleted);
        bb_webservice.GetLatestLocationsAsync(0); 
```

未提供凭证属性：http: [//dl.getdropbox.com/u/357576/ws.jpg](http://dl.getdropbox.com/u/357576/ws.jpg)

任何帮助，将不胜感激。谢谢。

雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T11:50:22.930

您可以使用 credentials 属性并传递一个新的[NetworkCredential](http://msdn.microsoft.com/en-us/library/system.net.networkcredential.aspx)对象：

```
bb_webservice = new BlackberryWSSoapClient();
bb_webservice.Credentials = 
       new System.Net.NetworkCredential("username","password","domain"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T10:44:49.530

这在 Silverlight 3 Beta 中已“修复”。Credentials 属性再次出现。

# javascript - 更紧凑的方式来做到这一点？

> ID：874431
> 
> 赞同：1
> 
> 时间：2009-05-17T11:46:53.920
> 
> 标签：javascript, arrays, loops

我有几个函数可以围绕单元格的周围单元格循环。网格包含在一个数组中。

在我的代码中，我检查以确保它不是边缘单元之一，因为检查未定义的单元会导致错误。

因此，我有这样的代码：

```
if(x > 0) {
    var firstX = x - 1;
} else {
    var firstX = x;
}
if(x < 199) {
    var lastX = x + 1;
} else {
    var lastX = x;
}

if(y > 0) {
    var firstY = y - 1;
} else {
    var firstY = y;
}
if(y < 199) {
    var lastY = y + 1;
} else {
    var lastY = y;
} 
```

很多行代码做的很少。有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-17T11:51:32.520

或者更清楚：

```
var firstX = Math.max(x - 1, 0);
var lastX = Math.min(x + 1, 199);
var firstY = Math.max(y - 1, 0);
var lastY = Math.min(y + 1, 199); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-17T11:49:03.430

您可以使用条件运算符：

```
var firstX = x > 0 ? x - 1 : x;
var lastX = x < 199 ? x + 1 : x;
var firstY = y > 0 ? y - 1 : y;
var lastY = y < 199 ? y + 1 : y; 
```

您*可以*通过编写一个函数来计算给定值的“第一个”以及“最后一个”的类似函数来消除冗余 - 但我认为在这种情况下这将是矫枉过正。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T11:49:48.687

您可以使用条件运算符：

```
var firstX = x - (x > 0 ? 1:0);
var lastX = x + (x < 199 ? 1:0);
var firstY = y - (y > 0 ? 1:0);
var lastY = y + (y < 199 ? 1:0); 
```

编辑：
提供了另一种使用方式，因为 Jon 已经发布了“我的”代码。;)

编辑 2：
正如 Rafael 指出的那样，条件可以隐式转换为数字，因此不需要条件运算符：

```
var firstX = x - (x > 0);
var lastX = x + (x < 199);
var firstY = y - (y > 0);
var lastY = y + (y < 199); 
```

但是，这段代码的实际作用不太明显。根据我的测试，似乎 Javascript 始终使用值 1 表示 true，但在各种编程语言中，值 -1 一样常用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T11:54:05.853

使用您检查的变量（x 和 y）而不是 First/lastX 和 First/lastY

```
if(x > 0 && x < 199) x-=1;
else if(x > 0) x+=1;

if(y > 0 && y < 199) y-=1;
else if(y > 0) y +=1; 
```

之后只需检查 x 和 y 即可。:)

# c - 什么时候破坏 pthread 屏障是安全的？

> ID：874432
> 
> 赞同：6
> 
> 时间：2009-05-17T11:46:59.833
> 
> 标签：c, multithreading, posix, pthreads

如果我有一个初始化的 pthread_barrier_t，什么时候可以安全地销毁它？下面的例子安全吗？

```
pthread_barrier_t barrier;
...
int rc = pthread_barrier_wait(b);
if (rc != PTHREAD_BARRIER_SERIAL_THREAD && rc != 0){
  perror("pthread_barrier_wait");
  exit(1);
}

if (id == 0){
  if(pthread_barrier_destroy(&(threads[t_root].info.tmp_barrier))){
    perror("pthread_barrier_destroy");
    exit(1);
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T13:59:51.543

返回后`pthread_barrier_wait()`，所有线程都将遇到障碍并继续进行。由于只给了一个线程`PTHREAD_BARRIER_SERIAL_THREAD`返回值，因此可以安全地使用它来有条件地包装销毁代码，如下所示：

```
int rc = pthread_barrier_wait(&b)
if ( rc == PTHREAD_BARRIER_SERIAL_THREAD )
{
    pthread_barrier_destroy(&b);
} 
```

另外，请注意，如果屏障正在使用（即另一个线程已调用） ，`pthread_barrier_destroy()`它将返回结果。`EBUSY``pthread_barrier_wait()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-10-07T06:55:05.243

接受的答案不正确。PTHREAD_BARRIER_SERIAL_THREAD 的返回值并不意味着破坏屏障是安全的。

在破坏屏障之前，您需要额外的同步。

> 问题是在其他线程正在离开屏障的过程中可能会发生销毁调用。由于 futex 系统调用可能有“错误唤醒”，这些线程需要检查屏障的状态。如果屏障使用的内存从它们下面释放出来，则会发生未定义的行为。
> 
> 因此，销毁线程需要等到所有其他线程完成退出屏障。为了实现这一点，需要额外的同步。 [使用 pthread_cond 具有替代实现的源](http://locklessinc.com/articles/barriers/)

在这个问题中，用户正在执行与您在示例代码中相同的逻辑。 [https://groups.google.com/forum/#!topic/thread-sanitizer/81idLTirikQ](https://groups.google.com/forum/#!topic/thread-sanitizer/81idLTirikQ)

# c++ - Windows上的C++ std::string转换问题

> ID：874433
> 
> 赞同：2
> 
> 时间：2009-05-17T11:46:59.833
> 
> 标签：c++, windows, string

这是我的程序：

```
bool Open(std::string filename)
{
    ...
    HANDLE hFile = CreateFile(filename.c_str(), GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, 0, NULL);
    ...
} 
```

错误：'CreateFileW'：无法将参数 1 从 'const char *' 转换为 'LPCWSTR' 指向的类型不相关；转换需要 reinterpret_cast、C-style cast 或 function-style cast

哪里有问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-17T11:58:32.520

std::string 由一个 char 数组组成，因此该`c_str`函数返回一个`const char*`.

A`LPCWSTR`是指向常量宽字符串的长指针，或者换句话说，`const wchar_t*`.

所以你有几个选择。将文件名作为宽字符串 (std::wstring) 获取，或者指定您需要 CreateFile 的非宽版本。这可以通过调用 CreateFileA 或在项目设置中禁用 UNICODE 来完成。

CreateFile 是一个宏，它可以解析为 CreateFileA（字符版本）或 CreateFileW（宽字符版本），具体取决于是否启用了 unicode。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T11:59:34.357

您已指定 std::string，其字符类型为`char`. 并且您使用的代码`CreateFile()`必须在预处理器符号的定义下编译`UNICODE`，因为它选择了实际的底层函数`CreateFileW()`。

要么摆脱`UNICODE`定义，要么明确使用`CreateFileA()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T11:56:51.603

看起来您正在编译时打开了 Unicode 支持。您可能想要将其关闭，或者如果不使用 std::wstring 而不是 std::string。

正如其他人所建议的那样，您可以直接调用 CreateFileA，但我强烈建议您不要这样做 - 您最终会得到一个无法维护的 Unicode 和非 Unicode 函数调用集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T13:08:11.823

问题是您试图将 char* 传递给需要 wchar_t* 的函数

您可以编写一个函数将字符串转换为 wstring：

```
wstring Widen( const string& str ); 
```

然后你可以像这样调用 CreateFile：

```
HANDLE hFile = CreateFile( Widen(filename).c_str(), etc. ); 
```

我见过的另一种技术是根据 Unicode 设置有条件地将 tstring 定义为 string 或 wstring，并在代码中的任何地方使用 tstring。

```
bool Open(tstring filename)
{
    ...
    HANDLE hFile = CreateFile( filename.c_str(), etc. );
    ...
} 
```

恐怕这是一个棘手的问题，对你来说最好的解决方案只有你可以决定。但是，我同意 Neil 的观点，并避免直接调用 CreateFileA，因为这最终会让你一团糟。

# perl - 如何在 Perl 的分叉进程中共享数据库连接？

> ID：874434
> 
> 赞同：0
> 
> 时间：2009-05-17T11:48:15.820
> 
> 标签：perl, db2, fork

我之前在 Perl 中制作了以下程序：

```
my $db = DBconnection with DB2

if ($pid = fork()) {
    #parent
} else {
    #child
    $db->execute("SELECT ****");
    exit;
}

wait();
$db->execute("SELECT ****"); 
```

我认为它等待子进程的结束想要这样做，并会通过一个亲进程为 DB 操作它。

另外，DB没有连接到内容的错误。

怎么了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T14:22:07.557

要让子进程使用其父进程的 DBI 句柄，您必须做很多事情。请参阅 Perl Monks 上关于[DBI、fork 和 clone](http://www.perlmonks.org/?node_id=594175)的这篇文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T14:34:51.647

尝试在您的子块中包含这行代码：

```
$db->{InactiveDestroy} = 1; 
```

# c# - 关于java中实用程序类命名的思考

> ID：874445
> 
> 赞同：2
> 
> 时间：2009-05-17T11:53:33.327
> 
> 标签：c#, java, naming

我正在寻找通用类的非功能（实用程序）扩展的命名指南。

在 C# 中，我曾经使用过其中的一些：

1) ListExtensions，太长但带有扩展方法的 ListExtensions 永远不会出现。用法刚刚好。var productList = new List(); productList.MyExtendedMehod();

2) 列表助手。这是在旧的 C# 2.0 时代，用法是 ListHelpers.MyExtendedMethod(productList );

现在我正在用java潜水。我学到的是集合、数组类。那么你如何命名你的助手类。收集工具？收藏？收藏品？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T11:58:09.430

我认为 XXXUtils 是常用的方法。然后您可以使用静态导入来摆脱类名。

```
class FooUtils {
  public static foo(int x) { ... }
}

static import FooUtils.foo;
foo(5); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T11:58:28.073

查看[Apache Commons Collections](http://commons.apache.org/collections/)库，了解一些命名理念。也许这个库做了很多你想做的事情！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T12:03:06.720

在 Java 中，有一种使用复数形式的模式，例如[`java.util.Collections`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html)为相应的类/包保存全局函数式静态方法。

例如，

```
Collections.shuffle(list); 
```

随机播放列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T12:16:22.930

我总是尝试使用复数形式的包名称。它比 Util 或 Utils 短，听起来更像英语。

我相信 JDK 中的数组和集合听起来比命名为 ArrayUtils 或 CollectionUtils 好得多。

对于 train 包，我的 utils 将放在名为 Trains 的类中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T11:59:06.013

1）我没有看到很多，但我相信好的命名方案是给一个功能名称（SynchronizedSet等）。您可以从[Apache 的 commons-collections](http://code.google.com/p/google-collections/)或[google collections](http://code.google.com/p/google-collections/)中获取示例。

2) “标准”后缀是 Utils - SwingUtils、StringUtils 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T11:59:52.190

[Apache Commons](http://commons.apache.org/)通过使用 XXXUtils 模式设定了相当标准。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-16T08:47:47.597

我个人尝试选择实用程序类名称，以便类名称是方法名称的一部分。例如

```
list = As.list(array);
set = As.set(list);
b = All.notNull(foo, bar, qux, ...);
name = Defaults.to(input, "Joe Random");
value = For.example(StackTest.class, "withSomeValues"); 
b = Is.empty(iterable);
Out.put("Hello, Worlds!"); 
```

等等...

# bash - 从 Bash 脚本更改当前目录

> ID：874452
> 
> 赞同：228
> 
> 时间：2009-05-17T11:58:01.867
> 
> 标签：bash, environment

是否可以从脚本更改当前目录？

我想为 Bash 中的目录导航创建一个实用程序。我创建了一个如下所示的测试脚本：

```
#!/bin/bash
cd /home/artemb 
```

当我从 Bash shell 执行脚本时，当前目录不会改变。是否可以从脚本更改当前的 shell 目录？

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2009-05-17T12:02:35.990

当您启动脚本时，将创建一个仅继承您的环境的新进程。当它结束时，它就结束了。您当前的环境保持原样。

相反，您可以像这样开始您的脚本：

```
. myscript.sh 
```

将`.`在当前环境中评估脚本，因此它可能会被更改

* * *

## 回答 #2

> 赞同：198
> 
> 时间：2009-05-17T12:46:45.477

您需要将脚本转换为 shell 函数：

```
#!/bin/bash
#
# this script should not be run directly,
# instead you need to source it from your .bashrc,
# by adding this line:
#   . ~/bin/myprog.sh
#

function myprog() {
  A=$1
  B=$2
  echo "aaa ${A} bbb ${B} ccc"
  cd /proc
} 
```

原因是每个进程都有自己的当前目录，当您从 shell 执行程序时，它会在新进程中运行。标准的“cd”、“pushd”和“popd”内置于 shell 解释器中，因此它们会影响 shell 进程。

通过使您的程序成为 shell 函数，您正在添加自己的进程内命令，然后任何目录更改都会反映在 shell 进程中。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2009-09-01T20:37:27.390

鉴于答案的不可读性和过于复杂，我相信这是请求者应该做的

1.  将该脚本添加到`PATH`
2.  run the script as `. scriptname`

The `.` (dot) will make sure the script is not run in a child shell.

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2010-08-16T08:09:32.190

Putting the above together, you can make an alias

```
alias your_cmd=". your_cmd" 
```

if you don't want to write the leading "." each time you want to source your script to the shell environment, or if you simply don't want to remember that must be done for the script to work correctly.

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2010-05-11T12:25:23.273

If you are using bash you can try alias:

into the .bashrc file add this line:

```
alias p='cd /home/serdar/my_new_folder/path/' 
```

when you write "p" on the command line, it will change the directory.

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-03-01T19:56:30.990

If you run a bash script then it will operates on its current environment or on those of its children, never on the parent.

If goal is to run your command : goto.sh /home/test Then work interactively in /home/test one way is to run a bash interactive subshell within your script :

```
#!/bin/bash
cd $1
exec bash 
```

This way you will be in /home/test until you exit ( exit or Ctrl+C ) of this shell.

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2009-05-17T12:18:26.480

使用**pushd**将当前目录推送到目录堆栈并更改为给定目录，**popd**获取堆栈顶部的目录，然后更改为该目录。

```
pushd ../new/dir > /dev/null
# do something in ../new/dir
popd > /dev/null 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-10-28T05:14:13.197

Simply go to

```
yourusername/.bashrc (or yourusername/.bash_profile on MAC) by an editor 
```

and add this code next to the last line:

```
alias yourcommand="cd /the_path_you_wish" 
```

Then quit editor.

Then type:

```
source ~/.bashrc or source ~/.bash_profile on MAC. 
```

now you can use: *yourcommand* in terminal

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-03-06T05:17:56.420

I've made a script to change directory. take a look: [https://github.com/ygpark/dj](https://github.com/ygpark/dj)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-12-04T17:22:23.977

Basically we use `cd..` to come back from every directory. I thought to make it more easy by giving the number of directories with which you need to come back at a time. You can implement this using a separate script file using the alias command . For example:

**code.sh**

```
#!/bin/sh
 _backfunc(){
 if [ "$1" -eq 1 ]; then
  cd ..
 elif [ "$1" -eq 2 ]; then
  cd ../..
 elif [ "$1" -eq 3 ]; then
  cd ../../..
 elif [ "$1" -eq 4 ]; then
  cd ../../../..
 elif ["$1" -eq 10]; then
  cd /home/arun/Documents/work
 fi
 }
alias back='_backfunc' 
```

After using `source code.sh` in the current shell you can use :

```
$back 2 
```

to come two steps back from the current directory. Explained in detail over [here](http://www.chettoor.in/2014/11/bash-multiple-cd-using-alias.html). It is also explained over there how to put the code in ~/.bashrc so that every new shell opened will automatically have this new alias command. You can add new command to go to specific directories by modifying the code by adding more `if conditions` and different arguments. You can also pull the code from git over [here](https://github.com/arunchettoor/unix_section/blob/master/one.sh).

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-03-08T11:55:19.967

Add below cd line in your shellscript this:

```
exec $SHELL 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-08-17T16:44:50.620

This is a simplified compilation of above answer.
Create a shell file `shellfile.sh` In the script change your directory inside a function

```
#!/bin/bash

cd folder1/folder2/ 
```

Now run the script with `.` before it.
`.` uses the current thread/session to execute the script.

```
. shellfile.sh 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-02-07T20:00:55.147

This approach is easier for me.

Suppose on a personal iMac where you are an admin, under the default directory when a command window is opened, /Users/jdoe, this will be the directory to go to: /Users/jdoe/Desktop/Mongo/db.3.2.1/bin.

These are the steps that can have the job done:

1.  vi mongobin, in which I entered: `cd /Users/jdoe/Desktop/Mongo/db.3.2.1/bin` as the first line.
2.  `chmod 755 mongobin`
3.  `source mongobin`
4.  `pwd`

Voila!

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-01-11T19:18:15.710

I've also created a utility called [goat](https://github.com/0mp/goat) that you can use for easier navigation.

You can view the source code on [GitHub](https://github.com/0mp/goat).

As of [v2.3.1](https://github.com/0mp/goat/releases/tag/v2.3.1) the [usage overview](https://github.com/0mp/goat/tree/v2.3.1#usage-overview) looks like this:

```
# Create a link (h4xdir) to a directory:
goat h4xdir ~/Documents/dev

# Follow a link to change a directory:
cd h4xdir

# Follow a link (and don't stop there!):
cd h4xdir/awesome-project

# Go up the filesystem tree with '...' (same as `cd ../../`):
cd ...

# List all your links:
goat list

# Delete a link (or more):
goat delete h4xdir lojban

# Delete all the links which point to directories with the given prefix:
goat deleteprefix $HOME/Documents

# Delete all saved links:
goat nuke

# Delete broken links:
goat fix 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-06-27T08:37:33.643

**Declare your path:**

```
PATH='/home/artemb'     
cd ${PATH} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-18T23:11:37.857

This is my current way of doing it for bash (tested on Debian). Maybe there's a better way:

> Don't do it with exec bash, for example like this:

```
#!/bin/bash
cd $1
exec bash 
```

> because while it appears to work, after you run it and your script finishes, yes you'll be in the correct directory, but you'll be in it in a subshell, which you can confirm by pressing Ctrl+D afterwards, and you'll see it exits the subshell, putting you back in your original directory.
> 
> This is usually not a state you want a script user to be left in after the script they run returns, because it's non-obvious that they're in a subshell and now they basically have two shells open when they thought they only had one. They might continue using this subshell and not realize it, and it could have unintended consequences.
> 
> If you really want the script to exit and leave open a subshell in the new directory, it's better if you change the PS1 variable so the script user has a visual indicator that they still have a subshell open.
> 
> Here's an example I came up with. It is two files, an outer.sh which you call directly, and an inner.sh which is sourced inside the outer.sh script. The outer script sets two variables, then sources the inner script, and afterwards it echoes the two variables (the second one has just been modified by the inner script). Afterwards it makes a temp copy of the current user's ~/.bashrc file, adds an override for the PS1 variable in it, as well as a cleanup routine, and finally it runs exec bash --rcfile pointing at the .bashrc.tmp file to initialize bash with a modified environment, including the modified prompt and the cleanup routine.
> 
> After outer.sh exits, you'll be left inside a subshell in the desired directory (in this case testdir/ which was entered into by the inner.sh script) with a visual indicator making it clear to you, and if you exit out of the subshell, the .bashrc.tmp file will be deleted by the cleanup routine, and you'll be back in the directory you started in.
> 
> Maybe there's a smarter way to do it, but that's the best way I could figure out in about 40 minutes of experimenting:

## file 1: outer.sh

```
#!/bin/bash

var1="hello"
var2="world"

source inner.sh

echo $var1
echo $var2

cp ~/.bashrc .bashrc.tmp

echo 'export PS1="(subshell) $PS1"' >> .bashrc.tmp

cat <<EOS >> .bashrc.tmp
cleanup() {
    echo "cleaning up..."
    rm .bashrc.tmp
}

trap 'cleanup' 0
EOS

exec bash --rcfile .bashrc.tmp 
```

* * *

## file 2: inner.sh

```
cd testdir
var2="bird" 
```

* * *

> then run:

```
$ mkdir testdir
$ chmod 755 outer.sh

$ ./outer.sh 
```

> it should output:

```
hello
bird 
```

> and then drop you into your subshell using exec bash, but with a modified prompt which makes that obvious, something like:

```
(subshell) user@computername:~/testdir$ 
```

> and if you Ctrl-D out of the subshell, it should clean up by deleting a temporary .bashrc.tmp file in the testdir/ directory
> 
> I wonder if there's a better way than having to copy the .bashrc file like that though to change the PS1 var properly in the subshell...

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-01-11T19:03:44.947

I like to do the same thing for different projects without firing up a new shell.

In your case:

```
cd /home/artemb 
```

Save the_script as:

```
echo cd /home/artemb 
```

Then fire it up with:

```
\`./the_script\` 
```

Then you get to the directory using the same shell.

# python - 在 Python 中读取 .mat 文件

> ID：874461
> 
> 赞同：489
> 
> 时间：2009-05-17T12:02:04.727
> 
> 标签：python, matlab, file-io, scipy, mat-file

是否可以在 Python 中读取二进制 MATLAB .mat 文件？

我已经看到 SciPy 声称支持读取 .mat 文件，但我没有成功。我安装了 SciPy 0.7.0 版，找不到`loadmat()`方法。

* * *

## 回答 #1

> 赞同：689
> 
> 时间：2009-05-17T12:16:13.443

需要导入，`import scipy.io`...

```
import scipy.io
mat = scipy.io.loadmat('file.mat') 
```

* * *

## 回答 #2

> 赞同：192
> 
> 时间：2013-10-12T23:06:48.453

不适用于 MATLAB 数组 7.3 版`scipy.io.savemat`。`scipy.io.loadmat`但好的部分是 MATLAB 7.3 版文件是 hdf5 数据集。因此可以使用包括[NumPy](http://en.wikipedia.org/wiki/NumPy)在内的多种工具来读取它们。

对于 Python，您将需要`h5py`扩展，这需要您系统上的 HDF5。

```
import numpy as np
import h5py
f = h5py.File('somefile.mat','r')
data = f.get('data/variable1')
data = np.array(data) # For converting to a NumPy array 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2015-06-16T13:25:39.633

首先将 .mat 文件另存为：

```
save('test.mat', '-v7') 
```

之后，在 Python 中，使用通常的`loadmat`函数：

```
import scipy.io as sio
test = sio.loadmat('test.mat') 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2018-09-23T14:06:31.533

有一个很好的包叫做[`mat4py`](https://pypi.org/project/mat4py/)它可以很容易地安装使用

```
pip install mat4py 
```

使用起来很简单（来自网站）：

**从 MAT 文件加载数据**

该函数仅使用 Python和对象`loadmat`将存储在 MAT 文件中的所有变量加载到简单的 Python 数据结构中。数值和元胞数组将转换为按行排序的嵌套列表。数组被压缩以消除只有一个元素的数组。[生成的数据结构由与JSON](http://en.wikipedia.org/wiki/JSON)格式兼容的简单类型组成。`dict``list`

示例：将 MAT 文件加载到 Python 数据结构中：

```
from mat4py import loadmat

data = loadmat('datafile.mat') 
```

该变量`data`是`dict`MAT 文件中包含的变量和值。

**将 Python 数据结构保存到 MAT 文件**

Python 数据可以使用`savemat`. 数据的结构必须与 for 相同`loadmat`，即它应该由简单的数据类型组成，如`dict`、`list`、`str`、`int`和`float`。

示例：将 Python 数据结构保存到 MAT 文件：

```
from mat4py import savemat

savemat('datafile.mat', data) 
```

参数`data`应`dict`与变量一起使用。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2018-03-05T17:10:41.377

**读取文件**

```
import scipy.io
mat = scipy.io.loadmat(file_name) 
```

**检查 MAT 变量的类型**

```
print(type(mat))
#OUTPUT - <class 'dict'> 
```

*字典中的**键是****MATLAB 变量**，**值**是**分配给这些变量的对象**。*

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-03-06T22:58:25.880

安装 MATLAB 2014b 或更新版本后，可以使用[Python 的 MATLAB 引擎：](http://www.mathworks.com/help/matlab/matlab-engine-for-python.html)

```
import matlab.engine
eng = matlab.engine.start_matlab()
content = eng.load("example.mat", nargout=1) 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2014-10-10T09:16:28.483

还有 MathWorks 本身的[MATLAB Engine for Python](http://www.mathworks.de/de/help/matlab/matlab-engine-for-python.html)。如果您有 MATLAB，这可能值得考虑（我自己没有尝试过，但它的功能远不止读取 MATLAB 文件）。但是，我不知道是否允许将其分发给其他用户（如果这些人有 MATLAB，这可能不是问题。否则，也许 NumPy 是正确的方法？）。

此外，如果您想自己完成所有基础知识，[MathWorks 提供了](http://www.mathworks.com/help/pdf_doc/matlab/matfile_format.pdf)（如果链接更改，请尝试 google`matfile_format.pdf`或其标题`MAT-FILE Format`）有关文件格式结构的详细文档。它并不像我个人认为的那么复杂，但显然，这不是最简单的方法。它还取决于`.mat`您想要支持的 -files 的多少功能。

我写了一个“小”（大约 700 行）Python 脚本，它可以读取一些基本`.mat`的文件。我既不是 Python 专家也不是初学者，我花了大约两天时间来编写它（使用上面链接的 MathWorks 文档）。我学到了很多新东西，而且很有趣（大部分时间）。由于我在工作中编写了 Python 脚本，恐怕我无法发布它......但我可以在这里给出一些建议：

*   首先阅读文档。
*   使用十六进制编辑器（例如[HxD](http://mh-nexus.de/en/hxd/)）并查看`.mat`要解析的参考文件。
*   尝试通过将字节保存到 .txt 文件并注释每一行来找出每个字节的含义。
*   使用类来保存每个数据元素（例如`miCOMPRESSED`、`miMATRIX`、`mxDOUBLE`或`miINT32`）
*   -files的`.mat`结构最适合将数据元素保存在树数据结构中；每个节点都有一个类和子节点

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2020-12-08T19:30:56.383

将 mat 文件读取到具有混合数据类型的 pandas dataFrame

```
import scipy.io as sio
mat=sio.loadmat('file.mat')# load mat-file
mdata = mat['myVar']  # variable in mat file 
ndata = {n: mdata[n][0,0] for n in mdata.dtype.names}
Columns = [n for n, v in ndata.items() if v.size == 1]
d=dict((c, ndata[c][0]) for c in Columns)
df=pd.DataFrame.from_dict(d)
display(df) 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2021-03-03T08:28:04.950

这个任务有一个很棒的库，叫做：`pymatreader`.

只需执行以下操作：

1.  安装包：`pip install pymatreader`

2.  导入这个包的相关功能：`from pymatreader import read_mat`

3.  使用函数读取 matlab 结构：`data = read_mat('matlab_struct.mat')`

4.  用于`data.keys()`定位数据的实际存储位置。

*   键通常如下所示：`dict_keys(['__header__', '__version__', '__globals__', 'data_opp'])`. `data_opp`存储数据的实际密钥在哪里。这个键的名字当然可以在不同的文件之间改变。

5.  最后一步 - 创建您的数据框：`my_df = pd.DataFrame(data['data_opp'])`

就是这样 ：）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-05-27T07:43:25.657

除了`scipy.io.loadmat`用于 v4（1.0 级）、v6、v7 到 7.2 格式的 matfile 和 `h5py.File`7.3 格式的 matfile，还有另一种类型的 matfile 是**文本数据格式**而不是二进制文件，通常由**Octave**创建，[甚至无法在 MATLAB 中读取](https://www.mathworks.com/matlabcentral/answers/140081-loading-mat-files-in-matlab-created-from-octave)。

两者`scipy.io.loadmat`都`h5py.File`无法加载（在 scipy 1.5.3 和 h5py 3.1.0 上测试），我找到的唯一解决方案是`numpy.loadtxt`.

```
import numpy as np
mat = np.loadtxt('xxx.mat') 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-11-19T10:48:07.360

```
from os.path import dirname, join as pjoin
import scipy.io as sio
data_dir = pjoin(dirname(sio.__file__), 'matlab', 'tests', 'data')
mat_fname = pjoin(data_dir, 'testdouble_7.4_GLNX86.mat')
mat_contents = sio.loadmat(mat_fname) 
```

您可以使用上面的代码读取 Python 中默认保存的 .mat 文件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-26T15:53:45.677

也可以使用 hdf5storage 库。有关 matlab 版本支持的详细信息，请单击[此处](https://pythonhosted.org/hdf5storage/information.html#matlab-mat-v7-3-file-support)的官方文档。

```
import hdf5storage

label_file = "./LabelTrain.mat"
out = hdf5storage.loadmat(label_file) 

print(type(out)) # <class 'dict'> 
```

# java - 如何在没有重复的情况下添加？

> ID：874467
> 
> 赞同：0
> 
> 时间：2009-05-17T12:03:59.730
> 
> 标签：java, swing

如何在不重复的情况下在我的 JTextArea 中添加新字符……这是当我使用 JAVA 按下我的添加 JButton 时。这是我的代码，我制作了 2 个类（Form 和 FormRunner）期待可以提前帮助的人……抱歉很久了代码-PaLoS（新手）

在 JButtons 中，我真的最需要帮助

```
public class Form extends JFrame{
    int validator = 0;
    public  String ID,Fname,Lname,Course,Year;

    private final static String newline = "\n";
    private final static String newtab = "\t";

    List<Form> myList = new ArrayList<Form>();

    private JTextArea summary,result;
    private JPanel labelPanel,summaryPanel,resultPanel;
    private JLabel iD,fName,lName,yearL,courseL,labelIcon,labelIconS,labelM;
    private JButton searchB,addB,editB,deleteB,updateB;
    private String labels[] = {"ID Number :","First Name :","Last Name :","Course :","Year :"};
    private String namesB[] = {"Search" , "Add" , "Edit" , "Delete" , "Update" };
    private JTextField formTitle,id,fname,lname,year,course;

     Form(){
         super("MAIN FORM: CASE STUDY");
         setupGUI();
    }

     public void setupGUI(){

         Container c =  getContentPane();
         c.setLayout(null);
         ActionEventHandler handler = new ActionEventHandler();

         Insets insets = c.getInsets();

         formTitle = new JTextField("FILE MAINTENANCE ",53);

            labelPanel = new JPanel();

//=====================     LABELS      ===========================
enter code here

//================================ Palos TEXT FIELDS ===================

    id = new JTextField(20);

    id.addKeyListener(new KeyAdapter()
        {
        public void keyTyped(KeyEvent ke){
            char char1 = ke.getKeyChar();
            if((!(Character.isDigit(char1))) && (char1 != '\b') ){ 
                    ke.consume(); 
                }
            } 
        }); 

        id.addActionListener(handler);

        fname = new JTextField(20);

        fname.addKeyListener(new KeyAdapter()
            {
public void keyTyped(KeyEvent ke){
    char char1 = ke.getKeyChar();
        if((!(Character.isLetter(char1))) && (char1 != '\b') ) { 
        ke.consume(); 
        } 
    } 
        public void keyReleased(KeyEvent e){} 
        public void keyPressed(KeyEvent e){} 
}); 
    fname.addActionListener(handler);

    lname = new JTextField(20);

    lname.addKeyListener(new KeyAdapter()
    {
        public void keyTyped(KeyEvent ke){
            char char1 = ke.getKeyChar();
    if((!(Character.isLetter(char1))) && (char1 != '\b') ){ 
        ke.consume(); 
        } 
    } 
    public void keyReleased(KeyEvent e){} 
    public void keyPressed(KeyEvent e){} 
}); 
    lname.addActionListener(handler);

    year = new JTextField(20);
    year.addKeyListener(new KeyAdapter()
    {
public void keyTyped(KeyEvent ke){
        char char1 = ke.getKeyChar();
    if((!(Character.isDigit(char1))) &&     (char1 != '\b') ) { 
        ke.consume(); 
    }           
} 
        public void keyReleased(KeyEvent e){} 
        public void keyPressed(KeyEvent e){} 
                    }); 
            year.addActionListener(handler);

            course = new JTextField(20);

            course.addKeyListener(new KeyAdapter()
            {
    public void keyTyped(KeyEvent ke){
            char char1 = ke.getKeyChar();                   if((!(Character.isLetter(char1))) &&    (char1 != '\b') ) { 
            ke.consume(); 
            } 
        }
        public void keyReleased(KeyEvent e){} 
        public void keyPressed(KeyEvent e){} 
                    }); 
            course.addActionListener(handler);
//=============================== Palos Buttons ===========================

     searchB = new JButton(namesB[0]);
    searchB.setHorizontalAlignment(JTextField.CENTER);
    **addB = new JButton(namesB[1]);
    addB.setHorizontalAlignment(JTextField.CENTER);
    addB.addActionListener(new ActionListener(){

 public void actionPerformed(ActionEvent e){
        id.selectAll();
         fname.selectAll();
         lname.selectAll();
         course.selectAll();
         year.selectAll();                    
             String textID = id.getSelectedText();
             String textFName = fname.getSelectedText();
             String textLName = lname.getSelectedText();
             String textCourse = course.getSelectedText();
             String textYear = year.getSelectedText();

         for(int i = 0; i < 1;i++){ 
            for(int j = i;j < myList.size(); j++){
                myList.add(Form.generateForm(textID));
                if( !myList.contains(id.getSelectedText() )){
        summary.append("["+ j + "]"+ textID +newtab + textFName + newtab 
                                            + textLName + newtab + textCourse + newtab + textYear + newline);
            }
                else{

                continue; 
                 }
            }                
         }

         summary.setCaretPosition(summary.getDocument().getLength());

         } 
    });
        editB = new JButton(namesB[2]);
        editB.setHorizontalAlignment(JTextField.CENTER);
        deleteB = new JButton(namesB[3]);
        deleteB.setHorizontalAlignment(JTextField.CENTER);
        updateB = new JButton(namesB[4]);
        updateB.setHorizontalAlignment(JTextField.CENTER);
        updateB.addActionListener(new ActionListener(){
 public void actionPerformed(ActionEvent e){

    for(int i = 0; i < myList.size();i++ ){
        summary.add(myList.get(i));
    }

     }
});***

//=================== Palos TextArea ===========================
        summaryPanel = new JPanel();
        summary.setEditable(false);
        resultPanel = new JPanel();

        result = new JTextArea(4,30);
        result.setEditable(false);

        summaryPanel.add(new JScrollPane(summary));
        resultPanel.add(new JScrollPane(result));

//===================================== Palos Container ====================

some code here...

//================================== Palos Setting Of Insets ==================

         setSize(700,400);
         setVisible(true);
         show();;

     }
     public static Form generateForm(final String Id){
            Form stud = new Form();
            stud.setID(Id);
            return stud;            
        }

     private class ActionEventHandler implements ActionListener{
         public void actionPerformed(ActionEvent e){

             if(e.getSource() == addB){

             }
             else if(e.getSource() == updateB){

             }
         } 
     }

     public String getID() {
            return ID;
        }

        public void setID(String id) {
            ID = id;
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T12:10:37.530

使用 java.util.Set 来跟踪唯一性。在添加一个新的之前检查它是否已经存在于 Set 中 - 如果不添加到 Set 并继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T12:39:36.307

在 JTextArea 的 keyTyped 方法中，添加以下内容：

```
char c = ke.getKeyChar(); 
if(yourTextArea.getText().contains(String.valueOf(c))){
      //duplicate found, consume the event 
}else{
      //no duplicates 
} 
```

# xml - XML 设计 - 如何？

> ID：874473
> 
> 赞同：2
> 
> 时间：2009-05-17T12:05:29.773
> 
> 标签：xml, xsd

我们目前正在设计一个 RESTful 应用程序。我们已决定使用 XML 作为我们的基本表示。我有以下关于在 XML 中设计/建模应用程序数据的问题。

1.  XML 中的数据建模方法有哪些？从头开始然后评估标准 XML 模式的使用是否是个好主意，反之亦然？
2.  在哪里可以找到有关所有标准 XML 模式的信息？
3.  我应该从一开始就考虑命名空间还是可以推迟到以后？
4.  最后，是先设计 XML 模式，还是从 XML 文档开始，然后定义模式？

注意：我已经查看了 stackoverflow 上的一个相关问题（[What are best practice for design XML schemas?](https://stackoverflow.com/questions/231553/what-are-best-practices-for-designing-xml-schemas)），但这似乎并没有解决上述问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T12:24:03.643

如果您还没有 XML 并且不知道需求，那么首先设计模式将很困难。如果您已经拥有处理 XML 的代码，那么最好将对象树作为您的第一个 XML 树的示例。除了 XML 始终只是一棵树而您的对象不是之外，它们并没有什么不同。

从那时起，稳定您的 XML 并收集需求，哪些用例应该用它建模。如果你有这两个，你就有一个完美的开始来做一个模式。这将巩固您的格式。

寻找标准模式总是一个好主意，但也几乎总是令人沮丧。推迟这个直到你知道你的 xml 会是什么样子。也许那时你意识到已经有一些标准化的东西就像你的格式一样。

你应该小心命名空间。这是 XML 中一个更重要的主题，因为您可能会做很多错误。如果您不确定是否需要它们，请跳过。这就是世界其他地方正在做的事情。如果您认为需要它们，请从一开始就使用它们。混合无命名空间感知代码和命名空间感知代码是一种痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T12:23:21.617

1.  您可以使用 XML Schema 做很多事情，例如抽象类、枚举等。请参阅[XML Schema Part 0: Primer Second Edition](http://www.w3.org/TR/xmlschema-0/)。如果您关心互操作性，请[尽量远离某些数据类型](http://webservices20.blogspot.com/2008/10/java-wcf-web-services-interoperability.html)。
2.  [XML 标记语言](http://en.wikipedia.org/wiki/List_of_XML_markup_languages)列表列出了一些已知的模式。对于 REST 服务上的 POX，我认为您会自己制作。
3.  只要保证唯一，实际名称本身并不重要。在其中包含日期以供将来版本控制。
4.  我认为您首先应该对生成的 XML 文档的外观有所了解。

关于服务设计要注意的一点是，它与设计类/对象不同，您必须在交换文档方面考虑更多。这有时被称为[course-grained](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5064520.html)。在 OO 世界中，您将在对等点之间交换一系列方法调用，但在 SOA 中，您将避免喋喋不休，并尝试将所需的大部分信息填充到文档中，有点像提交税表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T20:47:28.043

我同意你应该首先设计你的应用程序，然后决定你需要交换哪些信息。

当您这样做时，您可能会发现您正在交换的一些信息来自标准模式。您可能还会发现客户使用的标准模式已经描述了您要交换的信息。

如果这些事情都没有发生，那么忘记“标准模式”。除其他外，我认为您不会找到它们的完整列表-太多了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-22T11:41:58.680

最好从一开始就考虑命名空间设计方法。如果您要设计的 XML 文件在概念上是相关的，那么您可以采用同构名称空间设计方法。

异构命名空间设计方法允许共享和可重用性。当您想直观地识别特定于域的文件时，可以使用此选项。

异构设计方法是推荐的方法。请参阅[http://technologyandleadership.com/three-schema-design-approaches/](http://technologyandleadership.com/three-schema-design-approaches/)了解如何为您的项目实施这种设计方法

# python - 脚本的管理员权限

> ID：874476
> 
> 赞同：2
> 
> 时间：2009-05-17T12:09:47.610
> 
> 标签：python, unix, root, sudo

如何在运行期间检查我的脚本的管理员权限？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T12:34:19.063

在我们这个细粒度权限控制的时代，“管理员权限”的概念变得难以定义。如果您在具有“传统”访问控制模型的 unix 上运行，那么获取有效的用户 ID（在 os 模块中可用）并针对 root (0) 进行检查可能是您正在寻找的。如果您知道访问系统上的文件需要您希望脚本拥有的权限，您可以使用 os.access() 来检查您是否有足够的权限。

不幸的是，没有简单或便携的方法可以提供。您需要找出或定义使用的安全模型、系统提供的 API 可用于查询和设置权限，并尝试定位（或可能自己实现）可用于访问 API 的适当 Python 模块。

经典的问题，为什么你需要找出来？如果您的脚本试图做它需要做的事情并且“只是”捕获并正确处理故障怎么办？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T12:14:17.363

[在 Unix 上，您可以使用os.getuid](http://docs.python.org/3.0/library/os.html#os.getuid)函数检查您是否是 root ：

```
os.getuid() == 0 and "root" or "not root" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T23:28:13.587

如果您只是想查看是否有权访问需要管理权限的某个文件，那么检查的好方法是：

```
import os
print os.access("/path/to/file", os.W_OK) 
#replace W_OK with R_OK to test for read permissions 
```

另一方面，如果您确实需要知道用户是否是管理帐户，您也可以在 Windows 2000 及更高版本上使用此代码：

```
import ctypes
print ctypes.windll.shell32.IsUserAnAdmin() 
```

因此，确定用户是否为管理员的更好的跨平台方法是：

```
import ctypes, os
try:
 is_admin = os.getuid() == 0
except:
 is_admin = ctypes.windll.shell32.IsUserAnAdmin()

print is_admin 
```

当然，这种方法只会检测用户是Unix 上的*root*，还是 Windows 上的 Administrators 组的成员。但是，在我看来，这对于大多数目的来说已经足够了。

另请注意，这将在低于 2000 的 Windows 版本以及 Windows ME 上失败，因为它们是基于 DOS 的 Windows 版本并且没有任何权限概念。

# javascript - 仅将 HTML 加载到 IFRAME

> ID：874480
> 
> 赞同：0
> 
> 时间：2009-05-17T12:12:20.223
> 
> 标签：javascript, html, dom, iframe

如何仅将页面的 HTML 加载到 IFRAME 中，而不自动触发页面上所有 css、脚本、图像、视频的下载？

或者你能在DOM“准备好”的那一刻得到一个事件。当初始HTML已经加载，仅此而已。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T12:55:51.900

要仅获取 HTML 内容，请尝试使用 AJAX 调用。当然，这会在变量中返回内容，但您可以在之后按照您认为合适的方式处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T12:24:28.853

没有跨浏览器的方法可以做到这一点。一些浏览器提供了在 DOM 加载时触发的事件，例如Gecko 的[DOMContentLoaded](https://developer.mozilla.org/en/Gecko-Specific_DOM_Events)。

[jQuery 实现了这个功能](http://docs.jquery.com/Events/ready)。我建议您为此使用 jQuery：

```
$(document).ready(function () {
  // Function is called when the DOM is loaded.
}); 
```

或者查看 jQuery 是如何实现它的。请参阅[jQuery 源代码](http://code.jquery.com/jquery-latest.js)`bindReady`中的函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T12:27:42.183

简短的回答是“你不能”。

Internet Explorer 支持[可以阻止脚本的专有属性](http://msdn.microsoft.com/en-us/library/ms534622(VS.85).aspx)执行的专​​有属性，但它不是跨浏览器，也不处理图像或样式表。

[许多 JS 库实现了一个在 DOM 准备好](http://developer.yahoo.com/yui/event/#ondomready)时触发的自定义事件时触发- 但浏览器并行加载资源，因此虽然该事件可能在所有图像和样式表加载之前触发，但不太可能在其他元素开始下载之前触发.

如果您真的希望页面在没有这些东西的情况下加载 - 在服务器上处理它以去除包含它们的 HTML。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T22:50:09.467

将该 HTML 页面的“内容类型”设置为文本/纯文本。

# linux - 估计或测量创建文件的 iops 量

> ID：874486
> 
> 赞同：1
> 
> 时间：2009-05-17T12:15:16.927
> 
> 标签：linux, performance, filesystems

我想知道创建一个空文件需要多少 I/O 操作（iops）。我对 linux 和 GFS 文件系统感兴趣，但也非常欢迎提供其他文件系统信息。

也非常欢迎提出如何准确衡量这一点的建议。

真实场景（由答案要求）：

1.  Linux
2.  GFS 文件系统（如果你可以估计另一个 - 请做）
3.  在现有目录下新建文件，文件不存在，使用如下代码
4.  假设目录在缓存中，目录深度为*D*

代码：

```
int fd = open("/my_dir/1/2/3/new_file", O_CREAT | S_IRWXU);
// assuming fd is valid
fsync(fd); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T20:57:11.750

对于人工测量：

1.  在自己的块设备上创建一个空白文件系统（例如 vmware scsi 等）
2.  挂载它，调用 sync()，然后记录该块 dev 上存在的 IOPS 数。
3.  针对文件系统运行您的测试程序，并且不执行进一步的操作（甚至不执行“ls”）。
4.  等到所有未刷新的块都被刷新 - 说大约 1 分钟左右
5.  再次快照 iops 计数

当然，这是非常不现实的，因为如果您创建了两个文件而不是一个，您可能会发现文件数量不到原来的两倍。

创建空文件或空白文件也是不现实的——因为它们没有做任何有用的事情。

目录结构（目录有多深，有多少条目）可能会有所贡献，但它的碎片程度和其他任意因素也会有所贡献。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T12:48:23.740

这个问题的答案的性质是；最好的情况，正常的情况，最坏的情况。没有单一的答案，因为所需的 IOPS 数量会根据文件系统的当前状态而有所不同。（原始文件系统是非常不现实的场景）。

以FAT32为例，最好的情况是1。正常情况取决于文件系统碎片的程度和新文件的路径名的目录深度。更糟糕的情况是无限的（文件系统的大小除外，它对创建文件的最大可能 IOP 数施加了限制）。

真的，这个问题是无法回答的，除非您定义了一个特定的文件系统方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T05:15:39.907

我做了以下测量，我们编写了一个应用程序，如问题中所述创建 N 个文件。我们在仅专用于该应用程序的磁盘上运行该应用程序，并使用*iostat -x 1测量 IOps 量*

结果，在 GFS 和 linux 内核 2.6.18 上，**每个文件创建 2 IOps**。

该答案基于 MarkR 答案。

# sharepoint - 什么会使使用 SharePoint 进行开发更容易？

> ID：874497
> 
> 赞同：4
> 
> 时间：2009-05-17T12:18:55.543
> 
> 标签：sharepoint

什么会使使用 SharePoint 进行开发更容易？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T16:18:10.247

更好的产品。

现在，很多事情都不像开发环境应该表现的那样。

1.  处理对象
2.  遍历包含 3000/4000 个项目的小列表的性能
3.  缺乏交易支持

希望下一个版本将具有基于 SQLServer 的列表，您可以在其中获得事务支持和更好的性能......

Bill G 在 2008 年 2 月提出了一个问题，即当您在列表中有 3000 个项目并且 SQL Server 轻松支持数百万个项目时，Sharepoint 会出现一些奇怪的问题......

* * *

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-18T02:36:42.167

需要简化构建和部署过程。有许多工具可用于创建 WSP 文件，但它们各方面都不错，但您最终需要为您的环境扩展或修改解决方案 WSP 部署包。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-17T16:49:50.760

标准 HTML 和对 DOM 的更好支持。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-23T11:22:43.627

**信息性错误消息。**
虽然更容易调试和更少的 XML 非常诱人（正如人们所建议的），但我会接受一些更谦虚的东西。
SharePoint 通常会“吞下”异常或其他错误消息。很多时候，当自定义页面或 Web 部件失败时，您会收到一条模糊的“页面无法显示”消息。运气好的话，设计师会指导您解决问题，或者您可能会在日志或系统事件查看器中找到一些详细信息。但在很多情况下，你什么都没有。
示例 - 在编辑器上工作但在网站上无效的业务数据目录 xml 怪物、随机失败的 xml Web 部件、xsl 拼写错误或错误等。所有这些都需要比应有的时间更长的时间才能找到，而且有些无法调试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-17T12:21:56.347

远程部署： - 1 个中央 Sharepoint，以及透明的远程调试。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-17T18:45:49.960

更少的 XML（schema.xml 等）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-23T10:31:27.397

使开发过程更像“传统”的 asp.net 开发，换句话说，使与 VS 的集成更好。您应该从 VS 内部而不是从 SharePoint（即 SPD）内部针对 SharePoint 进行开发。codeplex 上的 SPVisualDev 使该过程变得更好，但我希望（我说希望）在 VS2010 和 SP2010 中获得更好的支持。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-22T11:41:45.437

还应该查看@SPDevWiki 的页面[http://www.sharepointdevwiki.com/pages/viewpage.action?pageId=7340352](http://www.sharepointdevwiki.com/pages/viewpage.action?pageId=7340352)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-06-23T10:21:04.687

尝试滥用该产品的人越少，事情也会变得容易得多；)

# dll - Unix 和 Windows 中的 Dlls 卸载命令

> ID：874499
> 
> 赞同：3
> 
> 时间：2009-05-17T12:20:07.680
> 
> 标签：dll, shared-libraries

我有 2 个 dll：A 和 B。

从 dll A 中的代码，我动态加载 dll B（在 Unix 上使用 dlopen，在 Windows 上使用 LoadLibrary）。是否保证B会在A之前被**卸载**？

Unix 和 Windows 的行为有什么区别吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T12:26:06.603

不能保证首先卸载哪个 DLL（Unix 和 WINdows 在这一点上没有区别）。

# spring - 在 Spring 配置文件中使用 bean id 和 name 的区别

> ID：874505
> 
> 赞同：220
> 
> 时间：2009-05-17T12:23:44.800
> 
> 标签：spring, configuration

在 Spring 配置文件中的元素上使用`id`属性和`name`属性有什么区别吗？`<bean>`

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-05-17T12:30:18.857

从[Spring 参考](http://static.springframework.org/spring/docs/2.5.x/reference/index.html)，[3.2.3.1 命名 Beans](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-beanname)：

> 每个 bean 都有一个或多个 id（也称为标识符或名称；这些术语指的是同一事物）。这些 id 在 bean 所在的容器中必须是唯一的。一个 bean 几乎总是只有一个 id，但如果一个 bean 有多个 id，那么多余的 id 基本上可以被视为别名。
> 
> 当使用基于 XML 的配置元数据时，您可以使用“id”或“name”属性来指定 bean 标识符。'id' 属性允许您只指定一个 id，并且由于它是一个真正的 XML 元素 ID 属性，因此 XML 解析器能够在其他元素引用该 id 时进行一些额外的验证；因此，它是指定 bean id 的首选方式。但是，XML 规范确实限制了 XML ID 中合法的字符。这通常不是一个约束，但是如果您需要使用这些特殊 XML 字符之一，或者想要为 bean 引入其他别名，您也可以或指定一个或多个 bean id，用逗号 (, )、分号 (;) 或“名称”属性中的空格。

所以基本上该`id`属性符合 XML id 属性标准，`name`但更灵活一些。一般来说，我`name`几乎完全使用。它似乎更“春天”。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2013-03-02T09:08:13.050

从 Spring 3.1 开始，该`id`属性是一个`xsd:string`并且允许与该属性相同的字符范围`name`。

`id`an和 a之间的唯一区别`name`是 a`name`可以包含多个别名，由逗号、分号或空格分隔，而 an`id`必须是单个值。

来自 Spring 3.2 文档：

> 在基于 XML 的配置元数据中，您使用 id 和/或 name 属性来指定 bean 标识符。id 属性允许您只指定一个 id。按照惯例，这些名称是字母数字的（“myBean”、“fooService”等），但也可以是特殊字符。如果要给 bean 引入其他别名，也可以在 name 属性中指定，用逗号 (,)、分号 (;) 或空格分隔。**作为历史记录，在 Spring 3.1 之前的版本中，id 属性被键入为 xsd:ID，这限制了可能的字符。从 3.1 开始，它现在是 xsd:string。请注意，bean id 唯一性仍然由容器强制执行，但不再由 XML 解析器执行。**

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-05-17T12:51:49.520

任何一个都可以。这取决于您的需求：
如果您的 bean 标识符包含特殊字符，例如 ( `/viewSummary.html`)，则不允许将其作为 bean `id`，因为它不是有效的 XML ID。在这种情况下，您可以跳过定义 bean`id`并提供 bean `name`。
该`name`属性还有助于`alias`为您的 bean 定义 es，因为它允许为给定 bean 指定多个标识符。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-01-09T16:18:38.680

让我回答下面的问题

> 在 <bean> 标签上**使用 id**属性和**使用 name**属性之间有什么区别吗？

没有区别。当在 <bean> 标签上使用 id 或 name 时，您将体验到相同的效果。

如何？

id 和 name 属性都为我们提供了一种向 bean 提供标识符值的方法（此时，认为 id 表示 id 而不是标识符）。在这两种情况下，如果您调用 ，您将看到相同的结果`applicationContext.getBean("bean-identifier");` 。

以@Bean 为例，Java 等效于 <bean> 标记，您不会找到 id 属性。您只能通过 name 属性将标识符值赋予 @Bean。

让我通过一个例子来解释一下：
以这个配置文件，我们称之为spring1.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans ...>
  <bean id="foo" class="com.intertech.Foo"></bean>
  <bean id="bar" class="com.intertech.Bar"></bean>
</beans> 
```

Spring 为 Foo 返回 Foo 对象`Foo f = (Foo) context.getBean("foo");` 。在上面的 spring1.xml 中替换`id="foo"`为`name="foo"` ，你仍然会看到相同的结果。

定义您的 xml 配置，例如，

```
<?xml version="1.0" encoding="UTF-8"?>
<beans ...>
  <bean id="fooIdentifier" class="com.intertech.Foo"></bean>
  <bean name="fooIdentifier" class="com.intertech.Foo"></bean>
</beans> 
```

你会得到 BeanDefinitionParsingException。它会说，这个元素中已经使用了 Bean 名称“fooIdentifier”。顺便说一句，如果您在下面配置
<bean name="fooIdentifier" class="com.intertech.Foo"></bean>
<bean name="fooIdentifier" class="com. intertech.Foo"></bean>

如果您将 id 和 name 都保留到 bean 标记中，则称该 bean 具有 2 个标识符。您可以使用任何标识符获得相同的 bean。以配置为

```
<?xml version="1.0" encoding="UTF-8"?><br>
<beans ...>
  <bean id="fooById" name="fooByName" class="com.intertech.Foo"></bean>
  <bean id="bar" class="com.intertech.Bar"></bean>
</beans> 
```

以下代码打印为 true

```
FileSystemXmlApplicationContext context = new FileSystemXmlApplicationContext(...);
Foo fooById = (Foo) context.getBean("fooById")// returns Foo object;
Foo fooByName = (Foo) context.getBean("fooByName")// returns Foo object;
System.out.println(fooById == fooByName) //true 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-21T00:26:39.493

在 ApplicationContext xml 中定义 Id & name 有区别吗？否 从 3.1(spring) 开始，id 也被定义为 xsd:string 类型。这意味着在 Id 中也允许定义名称中允许的任何字符。这在 Spring 3.1 之前是不可能的。

为什么在 name 与 Id 相同时使用 name ？它在某些情况下很有用，例如允许应用程序中的每个组件通过使用特定于该组件本身的 bean 名称来引用公共依赖项。

```
For example, the configuration metadata for subsystem A may refer to a DataSource via the name subsystemA-dataSource. The configuration metadata for subsystem B may refer to a DataSource via the name subsystemB-dataSource. When composing the main application that uses both these subsystems the main application refers to the DataSource via the name myApp-dataSource. To have all three names refer to the same object you add to the MyApp configuration metadata the following 

<bean id="myApp-dataSource" name="subsystemA-dataSource,subsystemB-dataSource" ..../>

Alternatively, You can have separate xml configuration files for each sub-system and then you can make use of
alias to define your own names.

<alias name="subsystemA-dataSource" alias="subsystemB-dataSource"/>
<alias name="subsystemA-dataSource" alias="myApp-dataSource" /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-17T19:19:06.077

`id`和都是`name`Spring IOC 容器/ApplicationContecxt 中的 bean 标识符。该`id`属性允许您指定一个 id，但使用`name`属性您可以为该 bean 提供别名。

您可以在此处查看 spring[文档](https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans-beanname)。

# facebook - 从网站更新 facebook 状态

> ID：874512
> 
> 赞同：2
> 
> 时间：2009-05-17T12:27:30.470
> 
> 标签：facebook, status

在我的网站页面中，有一个文本框和发布按钮。当我单击文本框中的文本按钮时，它作为状态发布在 facebook 上。对于此更新状态，用户必须在 facebook 上允许此应用程序。一旦用户在用户单击发布时允许此应用程序，该文本将更新 facebook 的状态。并且用户不需要登录 agian 和 agian 到 facebook。它在内部完成

喜欢从 twitter 更新 facebook 状态。我是php新手。有什么简单的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-02T20:04:02.507

如果有人正在寻找工作脚本：您也可以使用：

[http://360percents.com/posts/php-curl-status-update-working-example/](http://360percents.com/posts/php-curl-status-update-working-example/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T21:52:01.573

由于最近已删除了**offline_access权限（**[请在此处阅读](https://developers.facebook.com/blog/post/2012/05/02/platform-updates--operation-developer-love/)），因此您需要获得一个长期有效的 access_token。这将允许您在 60 天内代表您的应用程序为您的用户进行状态更新。60 天后，您必须让您的用户再次进行身份验证，因为您的访问令牌将失效。

你可以在这里阅读： [https ://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-28T15:28:54.323

有这个类[http://www.barattalo.it/mini-bots-php-class/](http://www.barattalo.it/mini-bots-php-class/)允许您在不使用 facebook API 的情况下使用小型机器人在粉丝页面墙上发帖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T12:45:25.887

如果您只想更新用户状态信息，则不需要创建 Facebook 应用程序。你可以用 PHP Curl 库来做到这一点。看看这里的例子 - [http://codesnippets.joyent.com/posts/show/1204](http://codesnippets.joyent.com/posts/show/1204)

# python - Python - 将脚本安装到系统

> ID：874521
> 
> 赞同：42
> 
> 时间：2009-05-17T12:36:31.663
> 
> 标签：python, installation

如何为我自己的脚本制作 setup.py 文件？我必须使我的脚本全球化。（将它添加到 /usr/bin）所以我可以从控制台运行它，只需输入：scriptName 参数。操作系统：Linux。 **编辑：** 现在我的脚本是可安装的，但我怎样才能让它全球化？这样我就可以从控制台运行它，只需输入名称即可。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-17T12:46:22.263

编辑：此答案仅涉及将可执行脚本安装到`/usr/bin`. `setup.py`我假设您对文件的工作原理有基本的了解。

创建您的脚本并将其放置在您的项目中，如下所示：

```
yourprojectdir/
    setup.py
    scripts/
        myscript.sh 
```

在您的`setup.py`文件中执行以下操作：

```
from setuptools import setup
# you may need setuptools instead of distutils

setup(
    # basic stuff here
    scripts = [
        'scripts/myscript.sh'
    ]
) 
```

然后输入

```
python setup.py install 
```

基本上就是这样。您的脚本有可能不完全位于`/usr/bin`，而是位于其他目录中。如果是这种情况，请键入

```
python setup.py install --help 
```

并搜索`--install-scripts`参数和朋友。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-21T17:54:41.373

我知道这个问题已经很老了，但以防万一，我发布了我是如何为自己解决问题的，那就是想为 PyPI 设置一个包，当使用 安装它时`pip`，会将其安装为系统包，而不是仅适用于 Python。

```
setup(
    # rest of setup
    console_scripts={
        'console_scripts': [
            '<app> = <package>.<app>:main'
        ]
    },
) 
```

[细节](https://stackoverflow.com/a/42934570/4055389)

# programming-languages - 您想删除您语言的哪个关键字？

> ID：874526
> 
> 赞同：-1
> 
> 时间：2009-05-17T12:39:29.130
> 
> 标签：programming-languages, syntax, keyword

编程语言在它们使用的语法上有很大的不同。作为一堆关键字的语法是我们必须在每种语言中处理的。但从直觉上看，并非所有这些关键词似乎都被明智地选择了。一个原因可能是某个词是您希望在代码中经常使用但不允许使用的关键字。在我的情况下，甚至我无法消化其中的一些关键字，所以我忽略了这种语言，直到弹出一个错误，让我想起我的固执。

你有类似的想法吗？您第一次删除您的语言中的关键字是什么？

更新：我对否决票并不感到惊讶，但我不明白。添加一些评论会很有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T12:47:01.437

我会从 Java 中删除 goto 。或者让它真正做点什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T12:48:30.823

在 Javascript 中“with”必须去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T12:50:52.237

我会在 ANSI C 中修复**static**关键字。它现在意味着两个不同的东西。静态变量在对声明它的函数的连续调用之间不会改变。静态函数仅在一个文件中可见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T13:07:01.967

我想从 Haskell 中摆脱 if/then/else 并改用函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T12:47:21.873

我将提出一个*已被删除*的关键字：Python **print**关键字，从 Python 3.0 开始，它已被常规函数替换，因此可以像所有其他函数一样处理它（传递等）。

[打印是一个函数](http://docs.python.org/3.0/whatsnew/3.0.html#print-is-a-function)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T14:27:03.910

我将从 C# 中删除**锁**并引入类 Lock ，而不是像这样的语义：

```
using (myLock.Enter())
{
    // Critical section
} 
```

目前锁定任何课程的能力对我来说看起来很奇怪。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-17T12:42:52.973

从 C++ 和 C# 我会消除**goto**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T14:32:34.460

我在 C++ 中指定**switch语句。**它被严重过度使用，if-ladder 几乎总是更清晰，并且应该由智能编译器同样优化（如果我们有智能编译器的话），至于切换类型，这就是虚函数的用途。

# java - 为什么 Java 包装类没有无参数构造函数？

> ID：874529
> 
> 赞同：2
> 
> 时间：2009-05-17T12:40:09.190
> 
> 标签：java, wrapper

在 Wrapper Classes 中不提供无参数构造函数的理由是什么？我知道它们天生就是为 Wrapping 原始类型而构建的，因此正确的方法是为构造函数提供原始类型。

但是，考虑到原始类型具有无参数构造函数，为什么它们没有呢？

此外，如果它们有无参数构造函数，它们可以被实例化为`T.class.newInstance()`. 但是，由于`newInstance()`需要无参数构造函数，因此这不适用于 Wrapper Classes。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-17T12:54:15.817

包装器对象是不可变的。这意味着一旦为包装对象分配了一个值，该值就无法更改。为无法更改值的对象设置默认值没有多大意义。你不会*想要*一个`newInstance()`包装类，因为那样你就会被默认值困住。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T12:53:50.077

我认为这是因为这些类包装的值是~~最终~~不可变的（*这*是我一直在寻找的词，谢谢比尔:)）。如果有一个默认构造函数，那将毫无用处，因为您以后无法更改该类包装的原语。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T13:19:27.457

在构造函数中提供原始类型是没有用的。包装类的类型表示原始类型。由于实例化的包装对象不能更改（不可变），因此只有一次机会给它一个值：在其构造期间。如果包装类对象不是不可变的，就会发生奇怪的事情。如果你有一个默认的包装类构造函数，它的值是什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T14:19:32.570

一个更好的问题是为什么他们有构造函数。我们应该只对价值感兴趣。对象标识与类型的含义无关。

大多数（但不是全部）反射的使用是没有意义的。像这样构造一个不可变的值几乎没有价值。`Class.newInstance`由于其异常行为而特别邪恶。`T.class`where `T`is 泛型参数由于擦除而无法编译。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T16:00:22.160

只有对象有构造函数，原语没有构造函数，所以它们没有默认构造函数。原语通过将对象/值初始化为所有 0 字节来获得它们的默认值。（布尔值为假，浮点数为0.0f，双精度为0.0，空值作为参考）

您似乎想使用 newInstance() 创建一个对象，但唯一未初始化的值为 null。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T12:43:01.523

很可能是因为虽然原语具有默认值（0、0.0f、0.0、0L、false 等），但 Wrappers 通常将这些默认值表示为 null。

# xslt - 选择时的 xsl 过滤器

> ID：874531
> 
> 赞同：0
> 
> 时间：2009-05-17T12:41:42.760
> 
> 标签：xslt, filter

我想选择所有后代但“博客”节点。例如，只有子树应该出现在输出中。我正在尝试这个 xsl 代码：

```
<xsl:template match="rdf:RDF">
    <xsl:copy>    
        <xsl:copy-of select="descendant::*[not(descendant::blog)]"/>
    </xsl:copy>
  </xsl:template> 
```

对于这个 xml：

```
<rdf:RDF>
  <profesor rdf:ID="profesor_39">
    <nombre rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >Augusto</nombre>
  </profesor>
  <blog rdf:ID="blog_41">
    <entradas>
      <entrada_blog rdf:ID="entrada_blog_42">
        <etiquetas>
          <tecnologia rdf:ID="tecnologia_49">
            <termino rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >Atom</termino>
          </tecnologia>
        </etiquetas>
        <autor>
          <alumno rdf:ID="alumno_38">
            <nombre rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
            >Jesus</nombre>
          </alumno>
        </autor>
      </entrada_blog>
    </entradas>
    <autores rdf:resource="#alumno_38"/>
    <direccion rdf:datatype="http://www.w3.org/2001/XMLSchema#string"
    >http://tfg1.unex.es/10comunidad/wordpress/</direccion>
  </blog>
</rdf:RDF> 
```

我错过了什么？“博客”节点仍然打印在输出上。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T02:06:53.317

这是一个完整的解决方案：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <!-- By default, recursively copy all nodes unchanged -->
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <!-- But strip out <blog> -->
  <xsl:template match="blog"/>

  <!-- If you want to strip out just the <blog> start and end tags, use this instead:
  <xsl:template match="blog">
    <xsl:apply-templates/>
  </xsl:template>
  -->

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T12:58:27.930

省略 blog 及其所有子项：

```
<xsl:template match="RDF">
    <xsl:copy-of select="child::node()[name() != 'blog']"/>
</xsl:template> 
```

省略 blog 但仍然 o/p 它的子项：

```
<xsl:template match="RDF">
    <xsl:copy-of select="descendant::node()[name() != 'blog']"/>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:13:31.350

条件 not(descendant::blog) 排除任何具有名为“blog”的后代的节点。

因此，如果您有：

```
<blog id="1">
  <test id="1.1">
    <blog id="1.1.1" />
  </test>
</blog>
<blog id="2">
  <test id="2.1" />
</blog> 
```

它将排除 <blog id="1"> 和 <test id="1.1">，因为这些节点都有 <blog id="1.1.1"> 作为后代。

但它不会排除 <blog id="1.1.1"> 或 <blog id="2"> 因为它们没有任何名为“blog”的后代

另请注意，您对 descendant::*[not(descendant::blog)] 的选择将输出 <test id="2.1"> 两次：一次在 <blog id="2"> 内，另一次单独输出。

对于完整的解决方案，Evan Lenz 建议的解决方案（身份转换，“博客”节点的空白覆盖模板）可能是提供您想要的结果的解决方案。

# drupal - Drupal：如何在阅读更多链接下移动节点评论？

> ID：874535
> 
> 赞同：1
> 
> 时间：2009-05-17T12:43:50.897
> 
> 标签：drupal, content-management-system, views

我的 Drupal 正在显示一个带有节点列表的简单自定义视图。诀窍是我的视图在列表中的节点下显示评论。这对于一页来说太多了，我需要获取纯节点列表并在 ReadMore 链接下隐藏评论。

我尝试使用我正在显示的自定义节点类型的评论设置，但即使我选择“在单独的页面上显示” - 评论本身仍然保留在主网格中。

**如何移动阅读更多链接下的评论以使其在网格中不可见？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T13:27:36.050

啊主题视图的乐趣。

[查看主题指南](http://drupal.org/node/352970)

本指南应该足以让您入门。

我建议使用 views-view-VIEWNAME-field.tpl.php 而不是编写主题函数。

希望这可以帮助

# excel - 从 MS Access 查询创建 PowerPoint 图表

> ID：874546
> 
> 赞同：3
> 
> 时间：2009-05-17T12:48:04.350
> 
> 标签：excel, vba, ms-access, automation, powerpoint

我有一个 Access 数据库来跟踪指标和“数字计算”数据来构建 PowerPoint 演示文稿。我每个月做大约 40 次演示，它们是 98% 的图表。

我一次运行一个查询（使用 SQL 语句），获取结果数据并将其复制到 Excel 模板中（我在这个“模板”中制作了一个模拟表，因此图表已经构建并格式化），然后将图表复制为将图片转换为 PowerPoint 模板。

所以有很多手工工作。

如何在同一个数据集/表上使用 VBA 在 Access 中运行多个查询（我必须按季度、按月、按地区、按州、按站点进行销售，所有这些都是 Top5 聚合，因此图表的原因)，然后将生成的数据发送到特定的 Excel 工作簿，同时定义什么进入哪个单元格范围？

如果我将所有数据输入 Excel，并准备好图表，是否有一些 VBA 可以从 Excel（活动工作表）中获取图表并将它们作为四视图布局中的图片粘贴到 PowerPoint 中？

我可以用 Access to PowerPoint 方法做同样的事情并剪掉 Excel 吗？

我充其量是个新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-29T18:59:51.040

您根本不需要使用 Excel！在报告中使用 MS Access Charts 和一些 VBA 代码将它们直接放入 Powerpoint。[这里](https://stackoverflow.com/questions/1040720/creating-a-powerpoint-with-graphs-from-access/1202246#1202246)已经有一个例子

一个“陷阱”是如果您在组中生成图表，即您使用组内的图表设计报告 - 因此当您运行报告时，您将创建大量图表。

获取这些图表中的每一个并将它们放入 Powerpoint 有点棘手，但这里有一些代码可以处理它。这适用于 Access 2003

```
'Loop through all the controls in this report and pickout all the graphs
For Each c In pReport.Controls

    'Graphs initially appear to be in an Object Frame
    If TypeOf c Is ObjectFrame Then

        'Check the Class of the object to make sure its a Chart
        If Left$(c.Class, 13) = "MSGraph.Chart" Then

            'Check if this graph must be cloned (required if the graph is in a group in the MS Access report)
            If Not IsGraphToBeCloned(pReport.Name, c.ControlName) Then

                InsertGraphToPptSlide c, "", pReport.Name
            Else
                InsertGraphGroupToPpt pReport.Name, c
            End If
        End If
    End If
Next 
```

这将找到报告中的所有图表，如果图表在一个组中，那么我们调用 InsertGraphGroupToPPt 函数。

这里的诀窍是我们知道我们多次拥有相同的基本图 - 但填充了不同的数据。因此，在 Powerpoint 中，您需要将基础图粘贴到 powerpoint 幻灯片中 n 次 - 其中 n 是组数，然后更新图查询属性

例如

```
Function UpdateGraphInPowerpoint(sql As String, OrigGraph As ObjectFrame, Groups As dao.Recordset, GroupName As String, ReportName As String) As Boolean

    //Copyright Innova Associates Ltd, 2009
    On Error GoTo ERR_CGFF
    On Error GoTo ERR_CGFF

    Dim oDataSheet As DataSheet
    Dim Graph As Graph.Chart
    Dim lRowCnt, lColCnt, lValue As Long, CGFF_FldCnt As Integer
    Dim CGFF_Rs As dao.Recordset
    Dim CGFF_field As dao.Field
    Dim CGFF_PwrPntloaded As Boolean
    Dim lheight, lwidth, LLeft, lTop As Single
    Dim slidenum As Integer
    Dim GraphSQL As String
    Dim lGrpPos As Long

    'Loop thru groups
    Do While Not Groups.EOF

        'We want content to be added to the end of the presentation - so find out how many slides we already have
        slidenum = gPwrPntPres.Slides.Count
        OrigGraph.Action = acOLECopy            'Copy to clipboard
        slidenum = slidenum + 1                 'Increment the Ppt slide number
        gPwrPntPres.Slides.Add slidenum, ppLayoutTitleOnly   'Add a Ppt slide

        'On Error Resume Next    'Ignore errors related to Graph caption
        gPwrPntPres.Slides(slidenum).Shapes(1).TextFrame.TextRange.Text = ReportName & vbCrLf & "(" & Groups.Fields(0).Value & ")" 'Set slide title to match graph title
        gPwrPntPres.Slides(slidenum).Shapes(1).TextFrame.TextRange.Font.Size = 16

        gPwrPntPres.Slides(slidenum).Shapes.Paste  'Paste graph into ppt from clipboard

        Set Graph = gPwrPntPres.Slides(slidenum).Shapes(2).OLEFormat.Object

        Set oDataSheet = Graph.Application.DataSheet    ' Set the reference to the datasheet collection.
        oDataSheet.Cells.Clear                          ' Clear the datasheet.

        GraphSQL = Replace(sql, "<%WHERE%>", " where " & GroupName & " = '" & Groups.Fields(0).Value & "'")
        Set CGFF_Rs = ExecQuery(GraphSQL)

        CGFF_FldCnt = 1
        ' Loop through the fields collection and get the field names.
        For Each CGFF_field In CGFF_Rs.Fields
            oDataSheet.Cells(1, CGFF_FldCnt).Value = CGFF_Rs.Fields(CGFF_FldCnt - 1).Name
           CGFF_FldCnt = CGFF_FldCnt + 1
        Next CGFF_field

        lRowCnt = 2
        ' Loop through the recordset.
        Do While Not CGFF_Rs.EOF

            CGFF_FldCnt = 1
            ' Put the values for the fields in the datasheet.
            For Each CGFF_field In CGFF_Rs.Fields
               oDataSheet.Cells(lRowCnt, CGFF_FldCnt).Value = IIf(IsNull(CGFF_field.Value), "", CGFF_field.Value)
               CGFF_FldCnt = CGFF_FldCnt + 1

            Next CGFF_field

            lRowCnt = lRowCnt + 1
            CGFF_Rs.MoveNext
        Loop

        ' Update the graph.
        Graph.Application.Update

        DoEvents

        CGFF_Rs.Close
        DoEvents
        Groups.MoveNext
    Loop

    UpdateGraphInPowerpoint = True
    Exit Function

End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T14:56:47.083

由于您是新手，也许您应该将任务分解为多个部分并一次一个地自动化这些部分。每一步都会带来好处（即节省时间），您可以边做边学。

由于缺乏具体信息（什么版本等），很难做出具体的建议。话虽如此，第一步可能是将 Excel 表链接到访问查询，以便电子表格可以每月自动更新，您不必将数据从 Access 剪切和粘贴到 Excel。您可以完全在 Excel 中执行此链接。

如果您使用 Excel 2007，请单击功能区中的“数据”，然后单击“来自访问”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:12:52.563

你要问的是很多工作：

通过 VBA，您必须打开 Excel（Access 中的 Excel 应用程序操作），更新您的图表（范围操作、数据更新），如果您有权限，那么我建议您将数据透视图连接到 Access 数据而不是粘贴到工作簿，但我已经在足够多的情况下这是不可能的。然后，您必须打开 PowerPoint 演示文稿并从 Excel 复制到 PowerPoint。我已经完成了所有这些工作，并且知道通过创建一个宏（通过 VBA）可以节省多少工作。这是很多代码。

# c# - C#中的std :: string？

> ID：874551
> 
> 赞同：9
> 
> 时间：2009-05-17T12:50:01.180
> 
> 标签：c#, c++, dll

我以为问题出在我的 C++ 函数中，但我试过了

C++ dll 中的 C++ 函数：

```
bool __declspec( dllexport ) OpenA(std::string file)
{
return true;
} 
```

C#代码：

```
[DllImport("pk2.dll")]
public static extern bool OpenA(string path);

    if (OpenA(@"E:\asdasd\")) 
```

我收到内存损坏的异常，为什么？

如果我删除 std::string 参数，它工作得很好，但使用 std::string 它不起作用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-17T13:00:40.967

std::string 和 c# string 彼此不兼容。据我所知，就互操作而言，c# 字符串对应于传递`char*`或在 c++ 中。 造成这种情况的原因之一是 std::string 可以有许多不同的实现，而 c# 不能假设您正在使用任何特定的实现。`wchar_t*`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T13:28:04.597

尝试这样的事情：

```
bool __declspec( dllexport ) OpenA(const TCHAR* pFile)
{ 
   std::string filename(pFile);
   ...
   return true;
} 
```

您还应该在 DllImport 属性中指定适当的字符集（unicode/ansi）。

顺便说一句，与您的编组问题无关，通常会将 std:string 作为 const 引用传递： const std:string& 文件名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T14:17:02.733

无法以您尝试的方式编组 C++ std::string。您在这里真正需要做的是编写一个包装函数，该函数使用普通的旧函数并在`const char*`后台转换为 std::string。

C++

```
extern C { 
  void OpenWrapper(const WCHAR* pName) {
    std::string name = pName;
    OpenA(name);
  }
} 
```

C＃

```
[DllImport("pk2.dll")]
public static extern void OpenWrapper( [In] string name); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-28T00:52:23.190

std::wstring 和 System.string 可以通过以下转换兼容：

C++：

```
bool func(std::wstring str, int number)
{
  BSTR tmp_str = SysAllocStringLen(str.c_str(), str.size());
  VARIANT_BOOL ret = VARIANT_FALSE;

  // call c# COM DLL
  ptr->my_com_function(tmp_str, number, &ret);

  SysFreeString(tmp_str);

  return (ret != VARIANT_FALSE) ? true : false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-12T14:43:21.397

我知道这个话题有点老了，但对于未来的谷歌人来说，这也应该有效（在 C++ 中不使用 char*）

C＃：

```
public static extern bool OpenA([In, MarshalAs(UnmanagedType.LPStr)] path); 
```

C++：

```
bool __declspec( dllexport ) OpenA(std::string file); 
```

# mysql - mysql代理袜子

> ID：874556
> 
> 赞同：6
> 
> 时间：2009-05-17T12:51:30.270
> 
> 标签：mysql, proxy, socks

简单明了，谁能解释我如何通过代理（socks4/5）连接到 mysql 服务器。最好通过 mysql 命令行（尽管客户端中没有选项）。

如果不能通过 mysql 命令行，那么任何其他方法都可以。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T08:49:32.167

您只需要安装和配置**tsocks**（透明袜子）。它在大多数（如果不是全部）Linux 发行版中都可用。之后你只需要在你的命令前加上'tsocks'，例如：tsocks mysql -h -P .....

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T13:09:14.957

据我所知，无法通过命令行完成，因为 mysql 命令不支持代理连接。

如果客户端和服务器都在一台 UNIX 机器上，并且其中一个可以从外部访问，我建议使用 SSH 隧道。它基本上是一个可以用于任何事情的安全隧道 TCP 连接，并且本地 mysql 命令可以轻松连接到隧道端口。

如果那不是选择，您可以编写某种包装器可执行文件。例如，Java 和 Ruby 的库使您能够与 SOCKS 代理通信并将这些套接字连接到 MySQL 或 JDBC 协议实现。接下来会发生什么完全取决于您接下来的计划。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-07-24T01:25:35.280

如果您拥有代理服务器的管理员访问权限，那么在其上安装 MySQL Proxy 会花费很多吗？

# java - 如何/在哪里将我的 webapp 部署在我自己的服务器上？

> ID：874558
> 
> 赞同：0
> 
> 时间：2009-05-17T12:52:52.357
> 
> 标签：java, jakarta-ee, webserver

我有一个使用 Java/J2ee 构建的小型 Web 应用程序。我想自己在自​​己的服务器上托管它（我现在没有）。我已经下载了 Ubuntu 服务器操作系统。我更喜欢在自己的服务器上托管我的应用程序（最好使用 Linux、Apache 和 MySQL），而不是谷歌应用程序引擎或任何其他托管服务？

1.  有人可以指导我寻找服务器硬件吗？
2.  我应该在哪里购买它们？
3.  我应该在网络服务器硬件中寻找什么样的东西？
4.  托管在第三方服务器或我们自己的服务器上哪个更便宜？
5.  您能否提供一些链接，让我可以了解如何在我们自己的服务器上创建 web 应用程序和托管？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T12:25:11.707

您可能想看看是否可以获得[Professional Apache Tomcat 6](https://rads.stackoverflow.com/amzn/click/com/0471753610)的副本，它为管理 Apache（Web 服务器和 tomcat）提供了很好的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T16:06:08.473

如果您想托管应用程序以进行测试/试用，请选择谷歌应用程序引擎或第三方廉价共享托管。如果您正在寻找可靠的托管或专用服务器，最好选择网格托管服务提供商，例如 media Temple。

我不建议在您自己的服务器上托管应用程序。运行自己的服务器是开销，并且伴随着它自己的一组维护问题。而是选择可靠的托管服务提供商是明智之举。

您可以寻找一些网络托管服务提供商..

*   MediaTemple（强烈推荐）
*   去吧爸爸
*   蓝色主机
*   梦想主机

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T13:14:19.997

您列出的软件几乎可以在任何计算机硬件上运行，您的要求和预期用途/目标受众将是评估可扩展性所需的硬件类型的起点。

如果它用于学习或开发，只需在您自己的电脑上运行它或获取您能找到的最便宜的托管帐户。

需要额外的信息来正确地提出任何建议。

# javascript - Javascript“类”（无框架）

> ID：874559
> 
> 赞同：3
> 
> 时间：2009-05-17T12:53:33.277
> 
> 标签：javascript, class

我正在做我的第一个大量使用对象的 javascript 项目。由于它的工作方式，几乎所有的自定义对象都是这样完成的：

```
namespaceobj = {};
namespaceobj.subobject = {};
namespaceobj.subobject.somefunction = function(arg, uments) {
    // Do Stuff
}
namespaceobj.subobject.somedata = 10;
namespaceobj.othersubject = {};
namespaceobj.othersubject.somefunction = function(some, args) {
    // Do more stuff
}
// More subobjects etc. 
```

这很好，因为所有自定义对象都只有一个实例（子对象的示例是 UI、工具、共享数据等）。

但是我已经看到代码做了这样的事情（语法可能是错误的，这只是从看到类似代码的记忆中）

```
function SomeClass() {
    this.somedata = 42;
    this.somefunction = function(a, few, args) {
        // Do Stuff
    }
}
// More classes and stuff
// Elsewhere:
someInstance = new SomeClass(); // AFA I recall, new was optional
someInstance.somefunction(); 
```

有人可以解释第二个示例中的“类”是如何工作的，以及我在使用它们时可能遇到的任何陷阱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T12:58:26.197

这是一个相当大的话题，但您看到的是*对象文字表示法*（您的第一个示例）和 JavaScript 的特定 OOP 品牌之间的区别。您将在两者之间遇到的主要区别是您的第一个示例只有一个静态实例，而您的第二个示例的修订版本（您很接近）将允许您创建该类的多个实例。

我建议您阅读[JavaScript 和面向对象编程 (OOP)](http://wsabstract.com/javatutors/oopjs.shtml)：

> JavaScript 是编写面向对象的 Web 应用程序的优秀语言。它可以支持 OOP，因为它支持通过原型设计以及属性和方法进行继承。许多开发人员放弃了 JS 作为一种合适的 OOP 语言，因为他们已经习惯了 C# 和 Java 的类风格。许多人没有意识到 JavaScript 支持继承。当您编写面向对象的代码时，它会立即赋予您力量；您可以编写可重用且已封装的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T13:44:07.587

我认为您正在考虑的语法如下所示：-

```
function SomeClass() {
    var somedata = 42;
    this.somefunction = function(a, few, args) {
    // Do Stuff like:-
    return somedata + a;
  }
}
// More classes and stuff
// Elsewhere:
someInstance = new SomeClass(); // AFA I recall, new was optional
someInstance.somefunction(15);  //returns 57 
```

分配给 somefunction 的函数是在**执行上下文**中创建的，该上下文在执行函数时产生（在这种情况下，当 SomeClass() 作为分配给 someInstance 的新操作的一部分执行时）。函数可以访问作为创建它们的执行上下文的一部分的变量，因此在这种情况下 somedata 是 somefunction 可以访问的变量。

这种方法有效地使 somedata 成为对象的私有状态，因为只有在 SomeClass 函数体内创建的函数才能访问它。

这是一个过度简化，你应该考虑先研究Javascript而不参考OO编程，了解**范围链**和**原型链**。了解这些后，您可以更好地了解在 Javascript 中实现 OO 设计的不同方法的数量，以及哪种方法最适合您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T12:56:33.240

第二个例子更清楚，数据被封装了。这意味着，一些类变量可以使用临时变量来计算。此外，第二个示例更适合制作更多相同类型的对象，但在您的情况下它并不重要。无论如何，它不会减慢您的代码速度，因此您可以随心所欲地进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T13:58:02.107

第二种形式可能是更好的形式，因为它创建了一个“类”，在其原型上具有许多功能。当创建一个新类时，新实例也将其原型设置为相同的东西。在 Class 示例中，函数存在于原型上。

第一个示例简单地创建一个具有许多函数的对象，每次需要一个函数时，将相同的函数重新分配给每个对象。

原型更可取，因为这意味着定义“类”的工作只完成一次。所有实例共享相同的原型 - 因此可以实现强大的构造，例如添加/更改/删除功能，并且所有实例都会看到更改。在您给出的第一个示例中，它们都是独立的对象，可以独立地更改任何实例上的任何内容。

最后，所有 Javascript 对象都是属性和函数的哈希表。当一个人通过“object.something”访问一个对象时，一切都是一个值，包括函数。但是，当使用函数调用符号“object.foo(...)”时，运行时会尝试在“object”上找到“foo”。如果运行时未能在“object”上找到“foo”，它将尝试在“object”的原型上找到“foo”。这种情况一直持续到找到某些东西或没有更多原型存在。

然后运行时将尝试调用“foo”传递参数等。如果 foo 不是函数，事情自然会爆炸。

# c# - 从文件中动态读取资源

> ID：874563
> 
> 赞同：3
> 
> 时间：2009-05-17T12:54:49.653
> 
> 标签：c#, asp.net, json, caching, resources

我一直在将 resx 文件用于静态字符串，以便有一个中心位置来更改它们。问题是在项目构建和部署后我无法更改它们。

我想在部署后更改一些字符串，而无需重新启动进程（因此 .config 文件已出）。

可以编写有效地解析配置文件（XML/JSON/YAML/？）的代码，例如将结果缓存 X 秒或使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher(loband).aspx)监视它的更改，但是这样的事情已经完成了吗？

编辑：使用[Json.NET](http://www.codeplex.com/Json)和 Rashmi Pandit 的指针，`CacheDependency`我编写了这个 JSON 解析类，它缓存解析的结果，直到文件被更改：

```
public class CachingJsonParser
{
    public static CachingJsonParser Create()
    {
        return new CachingJsonParser(
            HttpContext.Current.Server,
            HttpContext.Current.Cache);
    }

    private readonly HttpServerUtility _server;
    private readonly Cache _cache;

    public CachingJsonParser(HttpServerUtility server, Cache cache)
    {
        _server = server;
        _cache = cache;
    }

    public T Parse<T>(string relativePath)
    {
        var cacheKey = "cached_json_file:" + relativePath;
        if (_cache[cacheKey] == null)
        {
            var mappedPath = _server.MapPath(relativePath);
            var json = File.ReadAllText(mappedPath);
            var result = JavaScriptConvert.DeserializeObject(json, typeof(T));
            _cache.Insert(cacheKey, result, new CacheDependency(mappedPath));
        }
        return (T)_cache[cacheKey];
    }
} 
```

## 用法

JSON文件：

```
{
    "UserName": "foo",
    "Password": "qwerty"
} 
```

对应的数据类：

```
class LoginData
{
    public string UserName { get; set; }
    public string Password { get; set; }
} 
```

解析和缓存：

```
var parser = CachingJsonParser.Create();
var data = parser.Parse<LoginData>("~/App_Data/login_data.json"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T13:02:03.303

您可以使用 xml 文件并将其存储在缓存中。当对文件进行任何更改时，您可以使用 CacheDependency 重新加载缓存。链接： [CacheDependency](http://msdn.microsoft.com/en-us/library/system.web.caching.cachedependency.aspx)：[CacheItemUpdateCallback](http://msdn.microsoft.com/en-us/library/system.web.caching.cacheitemupdatecallback.aspx)：

在您的情况下，您的 Cache 应该将 XmlDocument 存储为值

编辑：这是我的示例代码

```
protected void Page_Load(object sender, EventArgs e)
{
        XmlDocument permissionsDoc = null;

        if (Cache["Permissions"] == null)
        {
            string path = Server.MapPath("~/XML/Permissions.xml");
            permissionsDoc = new XmlDocument();
            permissionsDoc.Load(Server.MapPath("~/XML/Permissions.xml"));
            Cache.Add("Permissions", permissionsDoc,
                            new CacheDependency(Server.MapPath("~/XML/Permissions.xml")),
                           Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration,
                    CacheItemPriority.Default, new CacheItemRemovedCallback(ReloadPermissionsCallBack));
        }
        else
        {
            permissionsDoc = (XmlDocument)Cache["Permissions"];
        }
}

private void ReloadPermissionsCallBack(string key, object value, CacheItemRemovedReason reason)
    {
        XmlDocument doc = new XmlDocument();
        doc.Load(Server.MapPath("~/XML/Permissions.xml"));
        Cache.Insert("Permissions", doc ,
                            new CacheDependency(Server.MapPath("~/XML/Permissions.xml")),
                           Cache.NoAbsoluteExpiration, Cache.NoSlidingExpiration,
                    CacheItemPriority.Default, new CacheItemRemovedCallback(ReloadPermissionsCallBack));
    } 
```

# asp.net-mvc - 控制控制器动作调用顺序

> ID：874564
> 
> 赞同：2
> 
> 时间：2009-05-17T12:55:37.437
> 
> 标签：asp.net-mvc

我正在拼凑一个类似网络应用程序的向导，如果输入的项目已经存在，它将在表单中输入并有条件地重定向到确认页面。类似的东西

“系统中已有同名的产品，您确定要继续吗？”。

为此，我可以在我的控制器上执行“确认”操作，但此操作只能由初始“添加”操作调用。

我的问题是，控制控制器动作调用顺序的最佳方法是什么。显然有人可以输入 //Confirm url 并欺骗数据。

希望我说得通。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T13:25:56.477

您有时希望用户确认某些内容，对吗？

如果是，将表单提交到确认操作；然后

```
public ActionResult Confirm(MyObject mObj, string confirmButton )
{

   if( NotAlreadyExists(mObj) || confirmButton )
      return RedirectToAction("Create", mObj)
  else
  {
      ModelState.AddModelError("DuplicateProduct","Please confirm");
      ViewData["showConfirm"] = true;
      return View(mObj);
 }
} 
```

当然，您几乎不需要特殊操作，因为您可以简单地放置您的数据上下文创建代码而不是 RedirectToAction，但无论如何......

然后视图将需要查找 showConfirm，并显示消息 + 确认按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T13:10:25.670

您无法控制控制器操作调用顺序。

但是，您可以将此概念推广为您在应用程序中编码的内容。

我可以想出几种方法来确保访问者先看到一步：会话状态、cookie、将令牌从操作传递到操作以及 asp.net mvc 中的临时数据。

我敢打赌，TempData 将是最简单的，如果您只想使用此功能。

在重定向到 Confirm 之前，让 Add 在 TempData 中放置一个特殊值。如果 Confirm 在 TempData 中没有看到该值，它会重定向回 Add。如果它在那里，Confirm 会进行正常的业务。

# iphone - 在设备上进行测试和调试：每次连接设备时如何阻止 iTunes 让我发疯？

> ID：874570
> 
> 赞同：4
> 
> 时间：2009-05-17T12:57:07.027
> 
> 标签：iphone, itunes

太麻烦了：每次我将 iPod touch 连接到我的 Mac 时，iTunes 都会启动并开始同步。这会在 Xcode 尝试在设备上安装应用程序时与 Xcode 发生冲突。我的曝光窗口总是跳到 iTunes 窗口。然后我必须等待，等待，等待，忽略诸如“你真的希望我删除所有内容并在你的设备上创建一个新库？”之类的愚蠢问题，再等待几秒钟，退出 iTunes（以防止配置文件出现问题)，然后切换回 Xcode。

如果我可以在连接设备时禁用 iTunes 的自动启动，那就太好了，因为我根本不是这样的音乐迷。无论如何，我只是将它用于应用程序，而且大多数时候，我只是想测试/调试或只是为电池充电。

我在菜单中看不到任何选项来做到这一点。我还尝试禁用 iPod 后台服务，但这会一次又一次地自动启用。所以我希望有一个解决方案可以防止它自动启动。我的意思是……当我真的想要同步、新音乐或其他什么时，我会手动启动 iTunes。%$!!§&!

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T12:59:39.673

在 ipod 部分，您可以禁用自动同步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T02:23:22.527

取消选中“连接此 iPod 时打开 iTunes”为我解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T20:01:56.013

要*真正*禁用自动同步，您需要从启动列表中删除 iTunesHelper 应用程序。转到系统偏好设置 -> 帐户和“登录项目”选项卡。从列表中删除它并重新启动。

关闭 iTunes 中的自动同步意味着助手仍在运行监控 iPhone 插入（这仍然可能会干扰开发）。它只是不启动 iTunes。这种方法完全不碍事。

当然，这意味着在插入 iPhone 时必须手动同步它。

# jquery - 尽管标题错误，但强制 ie7 将 jquery.get 响应作为 xml

> ID：874571
> 
> 赞同：1
> 
> 时间：2009-05-17T12:57:22.783
> 
> 标签：jquery, internet-explorer-7

我想使用 jquery 的 get 函数来使用 Web 服务。两者之间没有任何层，因为 javascript 文件与运行 Web 服务的服务器放在同一台服务器上。

我的代码在 Firefox 中运行良好，但在 ie7 中出现问题。我很确定我知道答案：xml 标头声明“text/html”，不幸的是 IE7 相信这是真的。

那么，我能做些什么来帮助 IE 将我的 xml-response 理解为 xml？投射/解析？

XML:

```
<?xml version = "1.0" encoding = "UTF-8"?>
<find>
<set_number>005262</set_number>
<no_records>000005611</no_records>
<no_entries>000005611</no_entries>
<session-id>YGSNPECRDEJS4Y3U1A65HMTG9PYPI1UDY1PYNFN2RK4BCDGY2D</session-id>
</find> 
```

代码（简化，附加内容发生在一个单独的函数中）：

```
$(document).ready(
    function(){      
        $.get(
            "http://server/X?op=find&code=wru&request=arbetsliv&base=rik01",   
            function(data){ 
                $("#wru").append($('no_records',data).text());
            },"xml"
    ); 
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T13:11:53.717

我以前处理过这个问题。我发现解决它的唯一方法是进行手动 ajax 调用，获取响应文本，将其解析为 DOM 文档，然后使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T12:52:35.997

我的解决方案：

```
$(document).ready(function(){
    $.ajax({
        url: "http://server/X?op=find&code=wru&request=biografier&base=rik01",
        success: function(data){
            var xml;
            if ($.browser.msie && typeof data == "string") {
                xml = new ActiveXObject("Microsoft.XMLDOM");
                xml.async = false;
                xml.loadXML(data);                
            } else {
                xml = data;
            }
            $("#wsa").append($('no_records',xml).text());
        }
    }); 
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T18:07:39.647

我发现的最简单的解决方法是在需要时简单地转换结果。

```
$.get(
    // all your parameters here
).done(function (data) {
    if (typeof data === 'string') {
        data = jQuery.parseXML(data);
    }
    // data is now a Document for you to use here
}); 
```

# java - Java/Swing 中的分段列表？

> ID：874581
> 
> 赞同：1
> 
> 时间：2009-05-17T13:05:59.613
> 
> 标签：java, swing, jlist, segments

我有一个项目列表`JList`供用户选择。由于项目很多（例如，各州的城市），我想将列表分成几个部分。但是，章节标题不应该是可选的。因此，对于我的城市/州示例，这可能如下所示：

*   状态 1
    *   城市 1
    *   城市 2
    *   城市 3
*   状态 2
    *   城市 4
    *   城市 5
    *   城市 6

`JList`通过将s 嵌入到 custom 中自己编写这个并不难`ListCellRenderer`，但我想知道那里是否已经有这样的类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T14:57:51.653

[JIDE](http://www.jidesoft.com/)提供了一个组件，可以让您完全做到这一点。它被称为 GroupList：

![替代文字](https://www.jidesoft.com/blog/wp-content/uploads/2007/11/grouplist.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T13:22:20.320

也许通过使用[JTree](http://java.sun.com/javase/6/docs/api/javax/swing/JTree.html)？你描述的是一棵有两个层次的树。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-04T12:27:15.710

我看到这个问题已经得到解答，但我注意到罗伯特评论说他希望有一个开源解决方案。我建议使用 Glazed Lists 的分隔符列表，您可以在此处找到该 API：

[http://publicobject.com/glazedlists/glazedlists-1.8.0/api/ca/odell/glazedlists/SeparatorList.html](http://publicobject.com/glazedlists/glazedlists-1.8.0/api/ca/odell/glazedlists/SeparatorList.html)

下面是一些示例代码，它将生成按首字母分组的项目列表：

[替代文字 http://img300.imageshack.us/img300/8977/separatorlist.png](http://img300.imageshack.us/img300/8977/separatorlist.png)

```
public class SeparatorListTest {

private static Comparator<String> createComparator() {
    return new Comparator<String>() {
        public int compare(String stringOne, String stringTwo) {
            return stringOne.substring(0,1).compareTo(stringTwo.substring(0,1));
        }
    };
}

private static ListCellRenderer createListCellRenderer() {
    return new DefaultListCellRenderer() {
        @Override
        public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            JLabel label = (JLabel) super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);

            if (value instanceof SeparatorList.Separator) {
                SeparatorList.Separator separator = (SeparatorList.Separator) value;
                label.setText(separator.getGroup().get(0).toString().substring(0,1));
                label.setFont(label.getFont().deriveFont(Font.BOLD));
                label.setBorder(BorderFactory.createEmptyBorder(0,5,0,0));
            } else {
                label.setFont(label.getFont().deriveFont(Font.PLAIN));
                label.setBorder(BorderFactory.createEmptyBorder(0,15,0,0));
            }

            return label;
        }
    };
}

public static void main(String[] args) {
    EventList<String> rawList = GlazedLists.eventListOf(
            "apple", "appricot", "acorn", "blueberry", "coconut", "chesnut", "grape");
    SeparatorList<String> separatorList = 
            new SeparatorList<String>(rawList, createComparator(), 1, 1000);

    JList list = new JList(new EventListModel<String>(separatorList));
    list.setCellRenderer(createListCellRenderer());
    JScrollPane scrollPane = new JScrollPane(list);
    scrollPane.setBorder(null);

    JFrame frame = new JFrame();
    frame.add(scrollPane, BorderLayout.CENTER);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(200,200);
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T09:47:16.300

您可以使用 Apple 所谓的 SourceList。您可以在 iTunes 和 Mac OS X 的 Finder 中看到它们的作用。这是您描述的问题的优雅解决方案。

一个跨平台的开源 Java Swing 组件在这里： [http ://explodingpixels.wordpress.com/2008/09/08/mac-widgets-for-java/](http://explodingpixels.wordpress.com/2008/09/08/mac-widgets-for-java/)

# iphone - 删除分组 UITableViewCell 上重新排序控件旁边的白线

> ID：874589
> 
> 赞同：7
> 
> 时间：2009-05-17T13:09:31.133
> 
> 标签：iphone, cocoa-touch, uitableview

我已经为我的表格构建了一个自定义 UI，它有一个更暗的 UI 和一个自定义的附件视图。当我将表格置于编辑模式时，重新排序控件左侧有一条白线，我似乎无法摆脱。

*tableView:accessoryTypeForRowWithIndexPath:*似乎不适合摆脱它，因为我没有使用标准的 UITableViewCellAccessoryType，所以我不确定我能做些什么让它不显示在我的单元格上。

[![白线示例](https://i.stack.imgur.com/uYrld.png)](https://i.stack.imgur.com/uYrld.png)
[（来源：[secondgearsoftware.com](http://secondgearsoftware.com/attachments/stackoverflow_reorder.png)）]

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-18T01:57:04.587

发生的情况是，当 UITableViewCell 显示重新排序控件时，它还会在其子视图数组中添加一个空的、1 像素宽的白色 UIView。

坦率地说：这是苹果应该修复的错误。

但是，您可以通过每次出现烦人的视图并将其背景颜色设置为透明来绕过它。**快速提示**：烦人的白色视图总是 UITableViewCell 的子视图数组中的最后一个，并且总是 1 像素宽。我们将使用它来找到它。

当您打开表格的编辑时，使所有可见的烦人的 1 像素视图透明。因此，在表格上切换“编辑”模式的操作方法可能如下所示：

```
- (IBAction)edit:(id)sender
{
    [tableView setEditing:!tableView.editing animated:YES];

    for (UITableViewCell *cell in [tableView visibleCells])
    {
        if (((UIView *)[cell.subviews lastObject]).frame.size.width == 1.0)
        {
            ((UIView *)[cell.subviews lastObject]).backgroundColor =
                [UIColor clearColor];
        }
    }
} 
```

并通过在您的 UITableViewDelegate 中实现这一点，对所有新视图继续这样做：

```
- (void)tableView:(UITableView *)tableView
    willDisplayCell:(UITableViewCell *)cell]
    forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (((UIView *)[cell.subviews lastObject]).frame.size.width == 1.0)
    {
        ((UIView *)[cell.subviews lastObject]).backgroundColor =
             [UIColor clearColor];
    }
} 
```

这种修复问题的技巧是相当无害的，如果 Apple 将来修复错误（停止添加烦人的 1 像素视图），这段代码应该安静地停止做任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T00:11:58.100

这里没有快速的答案，但你能确定这条白线是由哪个特定视图负责的吗？

我有时用来“调试”这类问题的一个技巧是更改可能有嫌疑的视图的背景颜色。我可能会将 TableViewCell 及其 contentView 的背景颜色设置为红色或蓝色，看看是否可以更改线条的颜色。这至少会给你一个关于问题性质的线索，也许会给你一些关于如何解决它的想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-07T16:16:13.453

在尝试了 @matt-gallagher 和 @bryce 的解决方案后，我将两者结合起来并创建了 setEditing 的覆盖。

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated {

    [super setEditing:editing animated:animated];

    for (UIControl *control in self.subviews) {
        if (control.frame.size.width == 1.0f) {
            control.backgroundColor = [UIColor clearColor];
        }                
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-16T18:36:56.490

您实际上可以在单元格转换到编辑状态时捕获视图并对其进行修改。添加（并自定义）此方法覆盖到您的自定义 UITableViewCell。

```
- (void)didTransitionToState:(UITableViewCellStateMask)state
{
//modified from comments here:
//http://www.erasetotheleft.com/post/overriding-the-drag-reorder-control-in-uitableviewcell/

 if(state == UITableViewCellStateEditingMask)
 {
  for (UIControl *control in self.subviews)
  {
   // Find the Reorder Control
   if ([control isMemberOfClass:NSClassFromString(@"UITableViewCellReorderControl")] && [control.subviews count] > 0)
   {
    // Do something with the control
   }
  }
 }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-01T10:57:05.183

我遇到了类似的问题，但在 UITableViewStylePlain 中。

感谢@chrish 和@matt-gallagher，我的解决方案：

```
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    for (UIView *control in cell.subviews) 
    {
        if (control.frame.size.width == 1.0f) 
        {
            control.backgroundColor = [UIColor clearColor];
        }                
    }
} 
```

# html - 填充盒子所有空白空间的浮动div

> ID：874591
> 
> 赞同：0
> 
> 时间：2009-05-17T13:09:59.510
> 
> 标签：html, css

我有这样的html和css。

```
 <div class="selected">
        <div class="text">First</div>
        <div class="arrow">&nbsp;</div>
    </div>

    .selected { width: 150px; }

    .selected .text { background: url(dropdown_text.png);  float: left; }
    .selected .arrow { background: url(dropdown_arrow.png); width:22px; float: right; } 
```

我需要在“.text”中输入 150px - 22px 的宽度。填充两个浮点数之间的所有空。我用 jQuery 做的，但我认为它不是正确的方法。

```
 $('.selected .text').each(function(i, n) {
            var ctrlwidth = $(n).parents('.selected').width();
            var arrowidth = $(n).parent().find('.arrow').width();

            $(n).width(ctrlwidth - arrowidth);
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T15:42:51.957

为什么使用 div 只是为了添加一个单独的背景箭头？

```
<div class="selected with-arrow">
  <div class="text"></div>
</div>

.with-arrow .text { background: url(dropdown_text.png); }
.with-arrow { background: url(dropdown_arrow.png); padding-left:22px; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T14:25:53.197

如果您稍微修改 html，您可以仅在 css 中轻松实现所需的效果：

```
<div class="selected">
<div class="arrow">&nbsp;</div>
    <div class="text">First</div>
</div> 
```

注意：箭头 div 内有一个不间断空格 (nbsp)，但代码美化器未显示。

现在您可以像这样应用css：

```
.selected { 
    width: 150px; 
}

.selected .text {}

.selected .arrow {
    float:right;
    width:22px;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-17T13:29:55.577

从您正在做的事情来看，在我看来，您最好只使用表格然后使用 div。

请注意，我假设您的文本项将显示为垂直列表，那么您将对其进行编码。

```
<style>

#list
{
  width:150px;
  padding:0px; /*set this to what ever you want*/
}

td.arrowCol
{
  width:22px
}

td.arrowCol img
{
   float:right;
}

</style>

<table id="list" >
    <tr>
       <td id="copyCol" >
          first
       </td>
       <td id="arrowCol" >
          <img src="arrow.gif" />
       </td>
    </tr>
</table> 
```

copyCol 列将自动具有 150 - 22 的宽度。如果您决定更改为 200，则 copyCol 将缩放为 200 - 22。

# php - 自动将文本插入 vim

> ID：874607
> 
> 赞同：7
> 
> 时间：2009-05-17T13:19:28.847
> 
> 标签：php, vim

在调试一些 php 脚本时，如果我有一个快捷方式可以插入一段文本，例如带有当前行号和文件名的回显，那将非常方便。

echo "Hello at filename.php at linenumber";

即使自动插入一些文本，如带有静态回声的评论，也会很甜蜜。

/* 调试 */ echo "in here";

这在php中可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-17T13:30:01.910

您要查找的变量称为[`__FILE__`和`__LINE__`](http://us3.php.net/manual/en/language.constants.predefined.php)。vim 中的简单映射可以为您提供所需的结果：

```
:map <C-L> oecho __FILE__ . ':' . __LINE__ . " - ";<C-O>h 
```

*   **`o`**- 开始在当前行下方插入
*   **`echo __FILE__ . ':' . __LINE__ . " - ";`**- 写这个字符串
*   **`<C-O>`**- 在命令模式下执行单个命令
*   **`h`**- 向左移动一个字符，这应该将光标定位在字符串的末尾，以便您可以插入调试语句。

虽然这对于快速修复应该没问题，但您可以考虑使用记录器来记录调试消息（可能是[Pear::Log](http://pear.php.net/package/Log)？）

# user-interface - Google Chrome 使用哪个 GUI 库？

> ID：874609
> 
> 赞同：54
> 
> 时间：2009-05-17T13:20:44.553
> 
> 标签：user-interface, google-chrome

Google Chrome 使用什么 GUI 库？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-17T13:28:47.013

在 Linux 上，它使用 GTK+，在 Mac OS X Cocoa 上，在 Windows 上使用自定义视图库，请参阅[http://www.youtube.com/watch?v=WsvNebq1dRg](http://www.youtube.com/watch?v=WsvNebq1dRg)以及来自[http://dev.chromium.org](http://dev.chromium.org)的文档：

*   [http://dev.chromium.org/developers/design-documents/chromeviews](http://dev.chromium.org/developers/design-documents/chromeviews)
*   [http://dev.chromium.org/developers/design-documents/views-windowing](http://dev.chromium.org/developers/design-documents/views-windowing)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-05-31T22:13:50.857

截至 2014 年 5 月，Google Chrome 使用它自己的自定义 UI 堆栈，称为[Aura](http://dev.chromium.org/developers/design-documents/aura)。目前除 OSX 之外的所有平台都是这种情况。

参考：

*   [PSA：光环计划](https://groups.google.com/a/chromium.org/forum/#!topic/chromium-dev/UMwGGgP0P9c)
*   [谷歌在 Chrome 35 中用 Aura 替换 GTK2](http://www.phoronix.com/scan.php?page=news_item&px=MTYyNzQ)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-08-02T03:48:18.243

您可能想要他们的文档，标题为“[多平台开发的约定和模式](http://dev.chromium.org/developers/design-documents/conventions-and-patterns-for-multi-platform-development)”。你的答案是

```
Mac -> Cocoa,
Linux -> GTK,
Windows -> Their own custom "Windows Views" 
```

您还会看到有一个实验性的“GTK 视图”，所以听起来他们的目标是自己的抽象？

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-17T13:27:39.450

在 Windows [WTL](http://www.hanselman.com/blog/TheWeeklySourceCode33MicrosoftOpenSourceInsideGoogleChrome.aspx)上用于（嗯...）chrome，以及用于 HTML 渲染的 WebKit。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-17T13:27:39.310

正如 Shay 所说，Windows 上的 WTL。Mac 和 Linux 版本中的所有 UI 都分别在 Cocoa 和 GTK+ 中从头开始编写。只有逻辑（和呈现网页的 WebKit）是完全跨平台的。

# c - 支持 Linux 用户空间中的字节排序

> ID：874617
> 
> 赞同：4
> 
> 时间：2009-05-17T13:25:49.860
> 
> 标签：c, linux, endianness

我正在用 C 语言在 Linux 上编写一个程序来分析嵌入式系统生成的核心文件。核心文件可能是小端 (ARM) 或大端 (MIPS)，分析它们的程序可能在小端主机 (x86) 或大端 (PowerPC) 上运行。

通过查看标题，我知道核心是 LE 还是 BE。我宁愿我的程序*不需要*知道它运行的主机是小端还是大端，我想使用 API 为我处理它。如果没有更好的选择，我想我会开始依赖#ifdef __BIG_ENDIAN__。

在 Linux 内核中，我们有 cpu_to_le32 等人将本机字节顺序转换为小端等。在用户空间中有 htonl 等人，它们从本机转换为大端，但我找不到本地到小端的等价物。

任何人都可以为用户空间推荐一个合适的 API 吗？

**编辑**：为了清楚起见，我正在寻找一个 API，它已经知道我的 CPU 是大端还是小端并相应地交换字节。我不想为此用#ifdefs 乱扔我的代码。我不只是在寻找代码片段来交换字节；谢谢你，但这不是重点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-18T20:37:40.217

`#include <arpa/inet.h>`很好且便携，但只有保证`{ntoh,hton}{s,l}`。如果您需要对 64 位值进行转换，或者需要在 big-endian 上进行 endian 翻转（在哪里`ntoh`并且`hton`什么都不做），这还不够。

在 Linux (glibc) 上，[`#include <endian.h>`](http://sources.redhat.com/cgi-bin/cvsweb.cgi/~checkout~/libc/string/endian.h?cvsroot=glibc)提供以下内容，根据当前机器定义。

```
htobe16  be16toh    htole16  le16toh
htobe32  be32toh    htole32  le32toh
htobe64  be64toh    htole64  le64toh 
```

在 *BSD 上，[`#include <sys/endian.h>`](http://cvsweb.se.netbsd.org/cgi-bin/bsdweb.cgi/~checkout~/src/sys/sys/endian.h)提供这些相同的宏。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-05T14:42:41.433

如果您可以访问 neon 协处理器并且内存是连续的（例如视频帧），您可以通过这种方式使用 q 寄存器（128 字节）在帧上执行 swap16；当然，您必须注意对齐问题

```
void swap16(void *__restrict src16)
{
    const void *start = src16;
    const void *end = src16 + FRAME_SIZE;
    asm volatile (
        "1: pld     [%0, #0x100]\n"
        "vld2.8         {q0,q1}, [%0]\n"
        "vmov           q2,q0\n"
        "vst2.8         {q1,q2}, [%0]!\n"
        "cmp            %1,%0\n"
        "bne            1b\n"
        : /* empty output operands */
        : "r" (start), "r" (end)
        : "cc", "memory"
        );
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T19:11:09.407

根据您实际尝试做的事情（阅读 ELF 核心转储文件而不必担心字节序问题），我相信使用 libelf（[此处提供了一个不错](http://www.freebsd.org/cgi/pds.cgi?ports/devel/libelf)[的](http://people.freebsd.org/~jkoshy/download/libelf/article.html)教程）将是一个不错的选择。

这个库透明地与大端和小端 ELF 文件一起工作，并且在 Linux 下运行得很好，尽管它起源于 FreeBSD（通常的“./configure”和“make”序列就是你构建它所需要的全部）。对于咧嘴笑，我在 x86 核心文件和 MIPS big-endian 核心文件上尝试了“读取程序头表”示例（稍作修改以使其构建），它似乎“正常工作”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T20:54:23.397

如果您将文件视为字节数组，那么您可以控制选择字节的顺序，并且 CPU 的字节序实际上最终无关紧要。

这在处理对齐问题方面也非常有用。您的核心转储中可能包含未对齐的引用。我知道这不太可能，但也可能是由于腐败。这是通过将文件视为字节数组来避免的另一个问题。

我在实现 jhead 时使用了这种方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T19:49:29.767

您可以使用 apa/inet.h 中的标准网络字节交换功能：

```
#include <arpa/inet.h>
uint32_t htonl(uint32_t hostlong); // Host to network
uint16_t htons(uint16_t hostshort); // Host to network
uint32_t ntohl(uint32_t netlong); // Network to host
uint16_t ntohs(uint16_t netshort); // Network to host 
```

网络字节顺序是大端。因此，这些功能意味着：

```
hton*: Host endian to big endian
ntoh*: Big endian to host endian 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T13:40:14.117

为什么需要 API 来完成它？只需编写您自己的函数来调用`htonl()`（或任何产生 BE）然后简单地反转字节。这听起来并不难。

就像是：

```
union {
    struct {
        unsigned char c0;
        unsigned char c1;
        unsigned char c2;
        unsigned char c3;
    } ch;
    uint32_t ui;
} u;
unsigned char t;

u.ui = htonl (hostlong);
t = u.ch.c0; u.ch.c0 = u.ch.c3 ; u.ch.c3 = t;
t = u.ch.c1; u.ch.c1 = u.ch.c2 ; u.ch.c2 = t; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T13:44:49.330

查看 /usr/include/linux/byteorder/ 中内核提供的头文件，例如 __cpu_to_be32() 和 __be32_to_cpu()

还可以查看 /usr/include/linux/types.h 文件，您可以在其中将类型定义为显式的大/小端普通整数，这很有帮助，因为在编译时会检测到任何不匹配。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-17T13:46:04.680

鉴于切换 endian-ess[很容易](http://www.ibm.com/developerworks/aix/library/au-endianc/index.html?ca=drs-#N1028E)，我总是最终使用这样的自定义代码，对我在代码中使用的表示形式保持严格的规则，并在端点（输入和输出）处理字节序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-17T13:52:30.047

您可以自己编写（这些基于 Apple 的例程）：

```
static inline uint16_t Swap16(uint16_t x)
{
    return ( (x << 8) | (x >> 8) );
}

static inline uint32_t Swap32(uint32_t x)
{
    return ( (((x ^ (x >> 16 | (x << 16))) & 0xff00ffff) >> 8) ^ (x >> 8 | data << 24) );
} 
```

然后你可以定义条件宏：

```
#ifdef __BIG_ENDIAN__
# define htols(x) Swap16(x)
# define htoll(x) Swap32(x)
#else
# define htols(x) (x)
# define htoll(x) (x)
#endif 
```

如果您对英特尔汇编代码感到满意，您甚至可以这样做：

```
// Swap16 is unchanged

static inline uint32_t Swap32(uint32_t x)
{
    __asm__ ("bswap %0" : "+r" (x));
    return ( x );
}
#ifdef __i386__
static inline uint64_t Swap64(uint64_t x)
{
    __asm__ ("bswap  %%eax\n\t"
             "bswap  %%edx\n\t"
             "xchgl  %%eax, %%edx"
             : "+A" (x));
    return ( x );
}
#elif defined(__x86_64__)
static inline uint64_t Swap64( uint64_t x )
{
    __asm__ ("bswap  %0" : "+r" (x));
    return ( x );
}
#endif 
```

# python - wxPython：导出位图时的路径问题

> ID：874625
> 
> 赞同：2
> 
> 时间：2009-05-17T13:27:42.587
> 
> 标签：python, path, wxpython

我有一个启动 wxPython 应用程序的模块，它加载一个`wx.Bitmap`从文件用作工具栏按钮。它看起来像这样：`wx.Bitmap("images\\new.png", wx.BITMAP_TYPE_ANY)`。当我单独运行该模块时一切正常，但是当我尝试从不同目录中的不同模块导入和运行它时，wxPython 会引发异常。（例外是关于工具栏的内部问题，我认为这只是意味着它没有正确加载位图。）

我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T13:45:10.533

"images\new.png" 是一个相对路径，所以当位图被加载时，它将决定 cur 目录是什么，所以要么设置 cur dir

```
os.chdir("location to images folder") 
```

或具有相对于您的程序加载的功能，例如

```
def getProgramFolder():
    moduleFile = __file__
    moduleDir = os.path.split(os.path.abspath(moduleFile))[0]
    programFolder = os.path.abspath(moduleDir)
    return programFolder

bmpFilePath = os.path.join(getProgramFolder(), "images\\new.png") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T14:00:26.220

[wxPython 常见问题解答](http://wiki.wxpython.org/Frequently%20Asked%20Questions#head-f3905e355271308d301310f0f8c1af64833ed912)建议使用一个名为`img2py.py`将图标文件嵌入 Python 模块的工具。该工具随 wxPython 发行版一起提供。

这是[嵌入工具栏图标的示例](http://wiki.wxpython.org/WorkingWithToolBars)。

# mysql - 创建一个没有 :id 列的 ActiveRecord 数据库表？

> ID：874634
> 
> 赞同：53
> 
> 时间：2009-05-17T13:36:32.800
> 
> 标签：mysql, ruby-on-rails, ruby, security, activerecord

我是否可以在 ActiveRecord、Ruby on Rails 中创建和使用不包含**:id**列的**数据库表。**

 **我不只是想忽略**id 列**，但我希望它绝对不存在。

```
Table Example

:key_column                         :value_column
0cc175b9c0f1b6a831c399e269772661    0cc175b9c0f1b6a831c399e269772661
4a8a08f09d37b73795649038408b5f33    0d61f8370cad1d412f80b84d143e1257
92eb5ffee6ae2fec3ad71c777531578f    9d5ed678fe57bcca610140957afab571 
```

任何更多信息（如 :id_column ）都会破坏整个功能。

我将如何在 Rails 中实现这样的东西？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2009-05-17T14:00:38.250

是的，看起来像这样：

```
create_table :my_table, id: false do |t|
  t.string :key_column
  t.string :value_column
end 
```

只要确保包括

```
id: false 
```

部分。

# c# - 为什么我的转换器会给出无效的转换错误？

> ID：874635
> 
> 赞同：7
> 
> 时间：2009-05-17T13:37:40.067
> 
> 标签：c#, wpf, xaml, casting, converters

我创建了一个转换器来从双精度转换为整数。

但是“返回（int）值；”这一行 总是得到一个“指定的演员表无效”。

我该怎么做才能让我的转换器成功转换双精度并发回整数？

**转换器：**

```
namespace TestChangeAngle
{
    [ValueConversion(typeof(double), typeof(int))]
    class DoubleToIntegerConverter : IValueConverter
    {
        #region IValueConverter Members

        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return (int)value;
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }

        #endregion
    }
} 
```

**XAML：**

```
<Page x:Class="TestChangeAngle.Page1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestChangeAngle"
    Title="Page1">
    <Page.Resources>
        <local:DoubleToIntegerConverter x:Key="DoubleToIntegerConverter"/>
    </Page.Resources>

    <StackPanel HorizontalAlignment="Left" Margin="20">
        <Image Source="images\logo2.png" 
               RenderTransformOrigin="0.5, 0.5"
               Width="100" 
               Margin="10">
            <Image.RenderTransform>
                <RotateTransform Angle="{Binding ElementName=TheSlider, Path=Value}"/>
            </Image.RenderTransform>
        </Image>
        <Slider x:Name="TheSlider"
                Width="200" 
                Minimum="0"
                Maximum="360"
                HorizontalAlignment="Center"
                Margin="10" 
                Cursor="Hand"/>
        <TextBox x:Name="TheAngle"
                 Margin="10"
                 Width="100">
            <TextBox.Text>
                <Binding ElementName="TheSlider"
                         Path="Value"
                         UpdateSourceTrigger="PropertyChanged"
                         Converter="{StaticResource DoubleToIntegerConverter}"
                         Mode="TwoWay">
                    <Binding.ValidationRules>
                        <local:MinMaxValidationRule Minimum="0" Maximum="360"/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>

    </StackPanel>
</Page> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T13:58:35.070

您正在尝试将（而不是转换）从 double 转换为 int，这是行不通的。您需要进行隐式转换或使用 Convert.ToInt32() - 因为参数实际上是 object 类型，我认为您需要后者来让编译器满意。是否要包含文化的格式提供者取决于您。

```
public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
{
    return Convert.ToInt32(value);
} 
```

*当对象具有相同的shape*时，您可以使用 cast 运算符，也就是说，当一个对象是您要转换的类型的实例时。例如，如果类 Foo 扩展类 Bar，那么您可以将 Foo 类型的对象强制转换为 Bar 类型 - 因为 Foo 对象具有 Bar 对象所具有的所有方法和属性。但是，您不能将 Bar 类型的对象强制转换为 Foo 类型，因为 Foo通过添加 Bar 对象没有的方法或属性来更改（或可以更改，就编译器而言）Bar的*形状*.

在您的情况下，您正在处理仅共享对象接口的原始类型 - 除了它们都从对象派生之外，它们之间没有继承关系。但是，两者之间存在隐式**转换。**您可以将一种类型的对象分配给另一种类型的变量，尽管您可能会失去一些值的精度。

```
double x = 1.1;
int y = 0;

y = x;  // implicit conversion, this works, y will be 1
x = y;  // implicit conversion, this works, x will be 1.0 
```

但是，您不能将一种类型的对象转换为另一种类型。强制转换意味着您将像使用其他类型的对象一样使用该对象。在这种情况下，*形状*不同，无法完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T14:13:08.577

问题是您试图同时进行拆箱和强制转换。这将失败。您必须先取消装箱，然后再转换为适当的类型。

```
return (int)(double)value; 
```

Eric Lippert 最近写了一篇很好的文章，说明为什么这是必要的。值得一读

*   [http://blogs.msdn.com/ericlippert/archive/2009/03/19/representation-and-identity.aspx](http://blogs.msdn.com/ericlippert/archive/2009/03/19/representation-and-identity.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T14:16:48.303

该`double`值被装箱在一个对象中，唯一的方法是将其拆箱为`double`. 之后，您可以将其转换为`int`.

```
return (int)(double)value; 
```

您还可以使用该`Convert.ToInt32(object)`方法（如 tvanfosson 建议的那样），它将对象转换为 IConvertible 并调用它的虚拟`ToInt32`方法，而虚拟方法又会调用该`Convert.ToInt32(double)`方法。这当然是更多的开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T14:18:06.490

您想要转换，但您正在从 double 转换为 int。尝试这个：

```
 public object Convert(object value, ...)
    {
        return (int)(double)value;
    } 
```

# c# - c#的图形查看器/抽屉？

> ID：874639
> 
> 赞同：3
> 
> 时间：2009-05-17T13:41:40.837
> 
> 标签：c#, drawing, graph

是否有用于绘制/可视化图形的良好 C# 库？我说的是节点路径可视化而不是折线图等。（最好是原生的，而不是 pstricks 的包装器或类似的东西）谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T13:55:46.187

一些指示：

*   [QuickGraph](http://www.codeplex.com/quickgraph/)是一个开源的通用图形库，它支持 MSAGL 和 graphviz
*   [MSAGL](http://en.wikipedia.org/wiki/Graph_Layout_Execution_Engine)是微软的图形布局引擎
*   [Netron Reloaded](http://netron-reloaded.sourceforge.net/)是一个 .NET 图形库（但看起来该项目在过去 3 年中没有新的开发）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-02T14:26:22.420

本国的：

*   Graph#（开源）（同样基于 QuickGraph）
*   [Netron](http://www.orbifold.net/default/?p=1936)（废弃软件）；G2

有很多图表编辑包，但我不知道它们在布局方面有多好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T13:45:29.347

我不知道有本地人，但我参与了开发一种[产品](http://www.roomsolutions.net/insurance-software/data-warehouse/acumen-advantage.aspx)，有人在其中构建了一个围绕[graphviz](http://www.graphviz.org/)的包装器，没有太多麻烦。这通过使用 API 渲染到文件，然后使用图像查看器控件显示文件来实现。

如果您在本机 .Net 库中找不到您想要的东西，我肯定看到人们通过以这种方式包装 graphviz 获得了很好的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T13:59:36.037

试试[aiSee](http://www.aisee.com/ "爱视")或看看[这个列表](http://www.dmoz.org/Science/Math/Combinatorics/Software/Graph_Drawing/ "这份清单")。

# c# - 编辑 Xml 节点

> ID：874640
> 
> 赞同：3
> 
> 时间：2009-05-17T13:41:52.223
> 
> 标签：c#, xml

我有一个 xml 文档，其中具有特定名称的 xml 节点，比如“数据”可以出现在 xml 文档中的任何位置，即层次结构中的任何位置。我需要单独读取这些节点及其节点名称并编辑节点属性。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T13:53:24.723

```
XmlDocument doc = new XmlDocument();
doc.Load(@"Test.xml");
XmlNodeList elem = doc.GetElementsByTagName("Data");
foreach (XmlNode tag in elem)
{
 //do whatever you want to the attribute using SetAttribute method
} 
```

[XmlElement.GetElementsByTagName 方法](http://msdn.microsoft.com/en-us/library/system.xml.xmlelement.getelementsbytagname(VS.71).aspx)可以解决问题

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T13:48:20.150

使用 XPath，您可以找到所有数据节点：-

```
foreach(XmlElement elem in dom.SelectNodes("//Data"))
{
    //do stuff to each elem.
} 
```

其中 dom 是与您的 Xml 一起加载的 XmlDocument。

或者，如果您更喜欢 XDocument：-

```
foreach(XElement elem in doc.Descendents("Data"))
{
    //do stuff to each elem.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T13:47:12.913

也许这样的事情可能对你有用？

```
XmlNodeList dataNodes = xmlDocument.SelectNodes('//Data')

foreach(XmlNode node in dataNodes)
{
  .. // do whatever you need to do
} 
```

马克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T13:49:22.580

像这样的东西：

```
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.Load(fileName);

XmlNodeList nodes = xmlDoc.SelectNodes("//Data");
for (int i = 0; i < nodes.Count; i++)
{
    nodes[i].Attributes["somevalue"].Value = "edited";
}

xmlDoc.Save(fileName); 
```

# iphone - 如何从 UITableViewCell 中的自定义按钮触发操作

> ID：874647
> 
> 赞同：4
> 
> 时间：2009-05-17T13:46:19.453
> 
> 标签：iphone

我创建了一个子类，`UIButton`允许我在 iPhone 上拥有一个复选框。此复选框是 的子类的一部分`UITableViewCell`。我的问题是如何将动作附加到被按下的按钮并在表格视图控制器中实现该方法？

我尝试使用该`addTarget:action:`方法，但这似乎不起作用。一种选择是使用 App Delegate，但这不是好的编程习惯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T07:32:54.263

好吧，我确实实现了相同的功能。这是我实现它的方式。

1.  创建了一个自定义单元格。

2.  仅在单元类中实现按钮操作。

3.  在单元格中声明一个协议（CustomCellDelegate）并创建一个单元格的委托（CustomCellDelegate）属性。

4.  在 cellForRowAtIndexPath: 表视图控制器的方法中，将表视图控制器（self）设置为委托单元格的属性。

5.  在视图控制器中实现委托。

6.  从单元格中的按钮操作方法调用委托方法。

让我知道您是否理解它或者我需要发布一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T16:18:42.820

确保按钮接收到触摸事件。您可以通过覆盖来检查这一点

```
- (BOOL)beginTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event 
```

或者

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
```

记录某些内容或在其中任何一个上设置断点。如果您的按钮没有收到触摸（我认为没有），请尝试将`exclusiveTouch`TableView 和/或 TableViewCell 设置为 NO。

# internet-explorer - Web 切片未在 IE8 中加载

> ID：874648
> 
> 赞同：0
> 
> 时间：2009-05-17T13:46:50.560
> 
> 标签：internet-explorer, ie8-webslice

我正在尝试将 webslice 添加到我管理的站点，但由于某种原因，我根本无法在 ie8 中使用任何 webslice。我在家里试过两台不同的机器，另一台在工作，但我遇到了同样的问题，我只是得到一个“ie无法显示此页面”的错误。

如果我点击诊断问题按钮，我会收到脚本调试错误：

行：264 错误：对象不支持此属性或方法

我在每个不同的切片上都得到完全相同的错误，甚至到行号。有人有什么想法吗？

编辑 - 通过一个网络片段，我正在谈论附带的新功能，即允许您将网页的一部分（例如包含新闻的 div）广告到您的链接栏。当您单击切片时，它会展开以向您显示切片的内容。更多信息请访问 http://msdn.microsoft.com/en-us/library/cc304073(VS.85).aspx"> [http://msdn.microsoft.com/en-us/library/cc304073(VS.85 ).aspx](http://msdn.microsoft.com/en-us/library/cc304073(VS.85).aspx)

干杯卢克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-26T20:09:52.700

试试这个：[http ://www.code-magazine.com/Article.aspx?quickid=0811052](http://www.code-magazine.com/Article.aspx?quickid=0811052)

这是一个关于如何制作它们的非常低俗的解释。我的猜测是你只是没有正确格式化它们......

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T12:09:14.497

我终于找到了答案！ie和google gears的完整版似乎有一个bug。如果您禁用齿轮即添加它们再次工作！- [http://support.microsoft.com/kb/969213](http://support.microsoft.com/kb/969213)

# asp.net - Asp.net Ajax，有时挂起

> ID：874655
> 
> 赞同：1
> 
> 时间：2009-05-17T13:54:42.273
> 
> 标签：asp.net, ajax, updatepanel

我在我的项目中使用 ASP.net Ajax。并使用 Session 进行状态管理。

在一些代码中，我有一些 modalpop up ，其中包含 UC 并做一些事情。

如果我使用 UpdatePanel ，有时，当我打开弹出窗口时，进度条会显示很长一段时间并且不做任何事情。如果我刷新页面，它将正常工作。此外，如果我删除 UpdatePanel 所有方法都可以正常工作。

在我有多个弹出窗口（或我在更新面板下运行的任何方法）的页面上，我遇到了这个问题。

什么问题？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T14:02:36.200

您应该做的第一件事是获取[Fiddler](http://www.fiddler2.com/fiddler2/version.asp)并查找任何未完成的请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T19:40:32.813

检查[Firebug](http://getfirebug.com)，在控制台模式下，您可以查看发送了哪些 http 请求，以及它们是否已经收到响应（并查看其响应）。这是开始调试与 Ajax 相关的所有内容的好地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T19:42:22.950

我发现，当您实际上没有支持 IPv6 的网络时，启用 IPv6 有时会引入这样的延迟，而系统会尝试 IPv6（最终超时，然后恢复为 IPv4）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T14:14:37.653

您使用的是什么类型的浏览器？有时谷歌浏览器会像我的个人网站一样遇到这个问题。不幸的是，我也不知道发生了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T06:45:11.347

有关更多信息，我在 OnInit 方法的页面上动态加载 UC，因此在每次回帖时，UC 都会再次加载，在我加载 UC 静态之前，我没有像现在这样的问题。我也使用 ModalUpdateProgress ，这是 Progressbar 的第三方和开源控件

# c++ - Log4cxx 自定义附加程序

> ID：874661
> 
> 赞同：6
> 
> 时间：2009-05-17T13:59:07.863
> 
> 标签：c++, logging, log4cxx

是否可以为 log4cxx 编写自定义附加程序并通过属性文件（如内置附加程序）对其进行配置？如果可能的话，我宁愿这样做而不必重建 log4cxx（例如，通过派生/扩展现有的 appender）。

你能给我举个例子吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T14:22:35.153

您可以从 AppenderSkeleton 或 WriterAppender 继承并获得相同的底层行为，而无需重新构建 log4cxx。

[http://svn.apache.org/viewvc/incubator/log4cxx/trunk/src/test/cpp/vectorappender.h?view=markup](http://svn.apache.org/viewvc/incubator/log4cxx/trunk/src/test/cpp/vectorappender.h?view=markup) [http://svn.apache.org/viewvc/incubator/log4cxx/trunk/src /test/cpp/vectorappender.cpp?view=markup](http://svn.apache.org/viewvc/incubator/log4cxx/trunk/src/test/cpp/vectorappender.cpp?view=markup)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-04T15:58:21.993

brlcad 的建议是正确的——在我的公司，我们已经将这种方法用于我们自己的自定义附加程序。

实际上，您已经可以从配置文件中配置这些 - 类定义中的 DECLARE_LOG4CXX_OBJECT(CustomAppenderClassName) 等宏设置了 log4cxx 环境。您可以通过“CustomAppenderClassName”引用您的附加程序类型。显示标准和自定义附加程序的配置文件（旧样式），使用自定义附加程序的标准布局：

```
# Set "realtime" logger level to DEBUG and create two appenders - one to be
# a standard rolling file appender, the other custom.
log4j.logger.realtime=ERROR, StandardAppender, CustomAppender

# StandardAppenderis set to be a RollingFileAppender
log4j.appender.StandardAppender=org.apache.log4j.RollingFileAppender
log4j.appender.StandardAppender.File=example.log

log4j.appender.StandardAppender.MaxFileSize=100KB
# Keep one backup file
log4j.appender.StandardAppender.MaxBackupIndex=1

# StandardAppender uses PatternLayout.
log4j.appender.StandardAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.StandardAppender.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n

# CustomAppender uses PatternLayout too
log4j.appender.CustomAppender=CustomAppenderClassName
log4j.appender.CustomAppender.layout=org.apache.log4j.PatternLayout
log4j.appender.CustomAppender.layout.ConversionPattern=%m 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-02T19:58:32.583

我正在添加此答案，因为评分最高的答案中的链接似乎来自旧版本。在他们的 SysLogAppender 中完成的操作之后，我使用[1.2.0 版创建了一个自定义附加程序。](https://sourceforge.net/p/log4cplus/news/2016/01/log4cplus-120-release/)在高层次上，您需要执行以下步骤：

*   创建一个你自己的类，它继承了他们的 Appender 类。
*   实现纯虚函数`void close()`和`void append(const spi::InternalLoggingEvent& event)`
*   使用 AppenderFactoryRegistry 注册您的 appender 类。

这是一个示例类，其中包含命名空间 yournamespace::ExampleCustomAppender 的类的代码：

```
#include <log4cplus/appender.h>

namespace yournamespace {
    class ExampleCustomAppender : public Appender
    {
    public:
        ExampleCustomAppender(const log4cplus::helpers::Properties & properties);

        // Dtor
        virtual ~ExampleCustomAppender();

        // Methods
        virtual void close();

        /** Register the appender with the factory registry. */
        static void registerAppender();

    protected:
        virtual void append(const spi::InternalLoggingEvent& event);
    };
} 
```

然后实现方法：

```
#include <log4cplus/spi/factory.h>
#include <sstream>

namespace yournamespace {

    ExampleCustomAppender::ExampleCustomAppender(const helpers::Properties & properties)
        : Appender(properties)
    {
    // if you want to use properties to configure your object do so here
    }

    ExampleCustomAppender::~ExampleCustomAppender()
    {
    }

    void ExampleCustomAppender::registerAppender()
    {
        log4cplus::spi::AppenderFactoryRegistry & reg
            = log4cplus::spi::getAppenderFactoryRegistry();
        LOG4CPLUS_REG_PRODUCT(reg, "log4cplus::", ExampleCustomAppender, 
            yournamespace::, log4cplus::spi::AppenderFactory);
    }

    void ExampleCustomAppender::close()
    {
        // do anything you need to close the appender
        closed = true;
    }

    // This method does not need to be locked since it is called by
    // doAppend() which performs the locking
    void LoggingCallbackAppender::append(const spi::InternalLoggingEvent& event)
    {
        if (!closed) {
            std::stringstream logOutput;
            layout->formatAndAppend(logOutput, event);
            std::string outputString = logOutput.str();
        }
    }
} 
```

最后是如何在配置文件中使用它的示例：

```
log4cplus.rootLogger=INFO, STDOUT, ROLLING, EXAMPLE
// other definitions for STDOUT and ROLLING here and then  ...
log4cplus.appender.EXAMPLE=log4cplus::ExampleCustomAppender
log4cplus.appender.EXAMPLE.layout=log4cplus::PatternLayout
log4cplus.appender.EXAMPLE.layout.ConversionPattern=%d{%m/%d %H:%M:%S} [%t] %-5p %c{2} - %m%n 
```

我通过剪切一些其他代码来完成此代码，因此它本身并没有以这种确切的格式编译。让我知道任何问题，我会纠正它。

# jquery - 为ie6修复css需要帮助！

> ID：874662
> 
> 赞同：2
> 
> 时间：2009-05-17T13:59:17.363
> 
> 标签：jquery, html, css, internet-explorer-6

我一直在努力使用 IE6+jquery ui 标签实现圆角。

我准备了这个页面：http: [//jsbin.com/uzoko](http://jsbin.com/uzoko)（不带 dd_roundies）

当然，圆角在 FF 中有效，但在 IE6 中无效。因为 CSS 中使用的一些属性是特定于 FF 和 Chrome 的。

我昨天问了这个问题![以及](https://stackoverflow.com/questions/872816/how-to-work-with-jquery-ui-tabs-in-ie-6)，根据这个建议，我使用了 DD_Roundies 库。但是，我在顶部提供的示例页面没有添加 DD_Roundies 库的能力，所以当它在 css 中打开时，我无法真正“显示”页面到底出了什么问题。

但是在实现 DD_Roundies 之后，我可以在 IE6 中看到圆角。但是，我有以下问题：

1.  只有“第一个”标签似乎有圆角。当我单击第二个选项卡时，它没有圆角，第三个也没有。
2.  当我离开第一个选项卡时，它似乎有一个颜色为 #990000 的边框。

这一切都不会发生在 FF @#$%@$!!

由于我无法将 DD_Roundies 库代码放在 jsbin 中，我将把与 dd_roundies 相关的内容放在我的页面上，这里：

```
 DD_roundies.addRule('.ui-corner-all', '4px');
        DD_roundies.addRule('.ui-corner-top', '2px 2px 0px 0px');
        DD_roundies.addRule('.ui-corner-bottom', '0 0 4px 4px');
        DD_roundies.addRule('.ui-corner-right', '0 4px 4px 0');
        DD_roundies.addRule('.ui-corner-left', '4px 0 0 4px');
        DD_roundies.addRule('.ui-corner-tl', '4px 0 0 0');
        DD_roundies.addRule('.ui-corner-tr', '0 4px 0 0');
        DD_roundies.addRule('.ui-corner-br', '0 0 4px 0');
        DD_roundies.addRule('.ui-corner-bl', '0 0 0 4px'); 
```

我一开始不擅长 CSS，然后更正 css，所以它可以与可怕的 ie6 一起工作，这完全是另一场战斗，我可以使用一些帮助。拜托！

另外，正如我昨天提出的问题中所建议的那样，我也尝试使用图像。我使用cornershop网站创建了两个圆角图像。 [http://tinypic.com/r/30j1rgz/5](http://tinypic.com/r/30j1rgz/5)和[http://tinypic.com/view.php?pic=50joqq&s=5](http://tinypic.com/view.php?pic=50joqq&s=5)但是当我将css和属性的“交互状态”部分更改`.ui-state-active a, .ui-state-active a:link, .ui-state-active a:visited`为以下内容时

```
background: #990000; 
font-weight: bold; 
color: #ffffff; 
text-decoration: none; 
outline: none;
background: url(nw.gif) no-repeat top left; 
background: url(ne.gif) no-repeat top right; 
```

然后我得到了更奇怪的结果:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T21:05:20.653

好的，经过 2 个小时的工作，我放弃了使用 DD_roundies，
它与 Tabs UI 结合使用效果不佳。

然后我尝试[了另一个我知道应该可以工作的插件](http://jrc.meerbox.nl/)，并在：
**IE6、IE7、FF3上进行了测试**

一切正常！

[**在此处查看演示**](http://jsbin.com/ozoge)

我还修改了你的 CSS。
将整个“*拐角半径*”部分放在评论中。没必要。

希望这适合您的需求:)

# c# - 连接超时

> ID：874677
> 
> 赞同：0
> 
> 时间：2009-05-17T14:09:04.110
> 
> 标签：c#, timeout, connection

使用 c# 我正在尝试将消息发送到服务器。但是，我收到了套接字异常 10060，这意味着连接超时错误。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T14:34:59.057

检查服务器上的应用程序是否已启动并正在运行。仔细检查地址和端口。检查您的防火墙是否允许您尝试建立的类型的连接。

最简单的方法可能是使用**telnet**并查看是否可以连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T15:14:10.270

到机器上，在本地使用telnet：

```
telnet localhost yourportnumberhere 
```

...如果您没有连接，请忘记防火墙-您只是没有在该端口上侦听。

如果可行，请从机器返回到其网络上的机器，然后重试。如果失败，是机器上的防火墙阻止了它。

如果可行，请在您的机器上使用相同的 telnet 命令（或者至少是运行尝试连接的代码的那个）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T14:24:17.193

可能是服务器没有在指定的端口上侦听或者它不接受连接。这可能是因为防火墙（软件或硬件）。

我会使用第三方应用程序测试与服务器的连接。例如，只需 telnet 到给定端口上的主机（如果它是 TCP 连接）并查看是否建立了连接。

在服务器上，您可以`netstat -na`（在 Windows 上）运行以查看是否有任何东西在目标端口上侦听。

# iphone - 如何在 iPhone-OS 中终止正在运行的动画？

> ID：874679
> 
> 赞同：3
> 
> 时间：2009-05-17T14:09:48.600
> 
> 标签：iphone, core-animation

我有一个类“Cube”，其中有一个方法-rotate。该方法将anchorPoint设置在左下角，然后将立方体旋转90度。之后，调用另一个方法，使立方体向后旋转 -90 度。完成指定停止选择器。顺便说一句：这没有特殊目的。刚学！

-rotate 在触摸事件时被调用。但是现在，当立方体对象仍在旋转时，假设它当前位于 33.943...，用户可能会在该动画完成之前进行另一个触摸事件。

然后，此触摸事件将立即再次调用 -rotate 方法。发生的情况是，变换重叠，立方体图像被完全拉伸和变形。

所以在新动画开始之前，当前正在运行的动画必须停止。

**更新**

在我开始动画之前，我称之为：

```
- (void)resetAnimation {
    self.layer.transform = CATransform3DIdentity; // reset the transform to the identity transform ("no rotation applied, please")
    [Cube setAnimationDelegate:nil];
    [Cube setAnimationDidStopSelector:NULL];
} 
```

另外，我设置了 [Cube setAnimationBeginsFromCurrentState:YES]; 我开始动画块的任何地方。

所以，当一个动画从外部启动时，会是这样的：（注意，屏幕上这个类的对象有5个，可以踢动）

```
- (void)kickAnimation { // if that's called, the cube gets a kick to rotate
    self.layer.transform = CATransform3DIdentity;
    currentDegrees = 90; // just testing! it may also be negative
    NSString *animID = [NSString stringWithFormat:@"cube_%i",self.datasetID];
    if (currentDegrees > 0) {
        [self rotateRight:animID finished:0 context:self];
    } else if (currentDegrees < 0) {
        [self rotateLeft:animID finished:0 context:self];
    }
}

- (void)rotateRight:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context {
    // 1) here the anchorPoint is set to the lower right corner
    // 2) here the view's frame is repositioned so that the cube doesn't move visually after the anchorPoint changed
    [self rotateByDegrees:currentDegrees animationID:animationID];
}

- (void)rotateByDegrees:(CGFloat)degrees animationID:(NSString *)animationID {
    [Cube beginAnimations:animationID context:self];
    [Cube setAnimationDelegate:self];
    [Cube setAnimationDidStopSelector:@selector(rotateBack:finished:context:)];
    [Cube setAnimationDuration:2.1f];
    [Cube setAnimationBeginsFromCurrentState:YES];
    CATransform3D rotatedTransform = self.layer.transform;
    rotatedTransform = CATransform3DRotate(rotatedTransform, degrees * M_PI / 180.0, 0.0f, 0.0f, 1.0f);
    self.layer.transform = rotatedTransform;
    [UIView commitAnimations];
}

- (void)rotateBack:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context {
    currentDegrees *= -1;
    [Cube beginAnimations:animationID context:self];
    self.layer.transform = CATransform3DIdentity;
    [Cube setAnimationDelegate:nil];
    [Cube setAnimationDidStopSelector:NULL];
    [Cube setAnimationDuration:2.1f];
    [Cube setAnimationBeginsFromCurrentState:YES];
    CATransform3D rotatedTransform = self.layer.transform;
    rotatedTransform = CATransform3DRotate(rotatedTransform, currentDegrees * M_PI / 180.0, 0.0f, 0.0f, 1.0f);
    self.layer.transform = rotatedTransform;
    currentDegrees = 0;
    [UIView commitAnimations];
} 
```

现在它似乎几乎可以工作了。如果动画开始重叠，立方体不再变形。但还有一点是错误的：如果有一个新的“踢”进来，并且立方体正在向后旋转，它应该立即开始向右旋转。但碰巧它首先旋转回来，然后识别出那个“踢”，看起来很奇怪；）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T16:06:27.910

[这](https://stackoverflow.com/questions/554997/cancel-a-uiview-animation)是一个类似的问题和答案。

如果您调用`[UIView setAnimationBeginsFromCurrentState:YES];`新动画将从视图所在的位置开始并停止先前的动画。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-03T10:46:39.657

如果您真的想停止所有动画，然后使用上述方法重新启动，请调用：

```
[self.layer removeAllAnimations]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T15:49:00.600

你是如何应用转换的？我正在描绘这样的事情：

```
- (void)rotate {
    [UIView beginAnimations:@"rotate" context:nil];
    self.transform = [self nextTargetTransform];
    [UIView commitAnimations];
} 
```

我没有为您的多维数据集示例编写代码，但这应该可以在没有您看到的问题的情况下工作。`beginAnimations:context:`应该认识到你已经在转换，并创建一个新的目标状态来顺利完成转换。这没有发生吗？

就像我说的，我没有测试过上面的；一个可能的问题是动画会突然跳回原始设置并重新开始。如果发生这种情况，请发表评论和更多代码，我们将解决该问题。

# java - Java 对象的最具体的子类？

> ID：874680
> 
> 赞同：2
> 
> 时间：2009-05-17T14:10:21.673
> 
> 标签：java, inheritance, instanceof

我有两个类 A 和 B，其中 B 是 A 的子类，A 不是抽象的。因此，我可以拥有作为 A 实例的对象和作为 B 实例的对象（因此也是 A 的实例）。

如何区分仅是 A 实例的对象？

当然，我可以编写类似“object instaceof A && !(object instance of B)”之类的东西，但这是一个非常糟糕的设计，因为每次向 A 添加新的子类时我都需要更改代码。更好的选择？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-17T14:11:56.957

```
object.getClass() == A.class 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T14:18:09.470

为什么要他们区分？通常这与 OO 相反。你有不同的实例，你不需要区分，因为不同的实现做的一切都是正确的。

如果您需要这样做，那么应该有一个协议。为此目的，有一个方法可以返回要识别的东西。这也更灵活。

如果没有充分理由使用它，我会 instanceOf 和 getClass 已经考虑不好的风格

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T14:16:56.073

这不是表明 B 不是真正的 A 吗？我不完全确定你应该进入这种情况吗？也许你可以改进你的设计？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T14:35:12.643

更好的方法是使测试成为方法的结果

```
class A {
   public boolean isSomeTest() {
      return true;
   }
}
class B extends A {
   public boolean isSomeTest() {
      return false;
   }
} 
```

然后，如果您添加一个扩展 A 的 C，您可以允许它返回 true 或 false。

isSomeTest 的名称应该清楚地表明返回 true 或 false 的含义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T14:37:02.060

这就是我认为你在说的：

```
public class A {
}

public class B extends A {
} 
```

稍后在代码中：

```
A apple = new A();
B banana = new B(); 
```

以下是一些您可能会觉得有用的选项：

```
if (apple.getClass() == A.class) { // Found an A }
if (banana.getClass() == A.class) { // This is not an A, won't get here. }
if (apple instanceof A) { // This is definitely an A }
if ((apple instanceof A) && (!(apple instanceof B))) { // It's an A but not a B } 
```

关于最后一个选项，您编写以下内容：

> 当然，我可以编写类似“object instaceof A && !(object instance of B)”之类的东西，但这是一个非常糟糕的设计，因为每次向 A 添加新的子类时我都需要更改代码。更好的选择？

多态性几乎总是在这里帮助我们。您关于每次添加子类时更改代码的观点正是您应该认识到的标准面向对象设计演变的症状。想想你试图产生的行为。您能否将其推入课程本身，而不是将其委托给外部提供者，以推断其当前正在处理的课程？

如果没有更多信息，我无法提供太多指导，但这里有一个相当简单的示例：

```
// Instead of this
if (apple.isClassA()) { // run class A code
} else if (apple.isClassB()) { // run class B code
// And so forth
} 
```

修改设计，使其更像这样：

```
public class A {
    public void executeCommand() { 
        // run class A code 
        // This method knows that it's definitely an A, not a B
    }
}

public class B extends A {
    public void executeCommand() { 
        // run class B code 
        // This method knows that it's a B (and, therefore, an A as well).
    }
} 
```

稍后在执行代码中，您将之前的 if 测试替换为：

```
apple.executeCommand();
banana.executeCommand(); 
```

诚然，这是一个几乎微不足道的面向对象设计审查，但它可能会动摇一些东西并帮助您解决子类化问题。

# mfc - 列表控件

> ID：874684
> 
> 赞同：0
> 
> 时间：2009-05-17T14:12:00.110
> 
> 标签：mfc

有谁知道我可以在哪里获得像 FeedDemon 使用的那样的 MFC ListView 控件？可用于对项目进行分组的一种（FeedDemon）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T17:30:36.500

本机控件支持分组，尽管这是一个相对手动的过程。

在 XP 中，它不支持开箱即用的展开/折叠： [XP](http://www.codeproject.com/KB/list/GroupListView.aspx)

在 Vista 中，您可以展开/折叠：[Vista](http://www.codeproject.com/KB/list/CListCtrl_Grouping.aspx)

# objective-c - Objective-C 是否仅用于 Mac OS/iPhone 上的开发？

> ID：874690
> 
> 赞同：26
> 
> 时间：2009-05-17T14:14:07.827
> 
> 标签：objective-c, open-source, gnustep

我不知道 Objective-C 但对我来说它似乎是一门不错的语言。但我所知道的唯一背景是苹果的一切。但 Objective-C 甚至在 GNU Compiler Collection 中。

开放的是否缺少某些东西？或者，Objective-C 是否已经有了更广泛的基础？如果有公司选择 Objective-C 来开发他们的产品，我很感兴趣。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-17T15:31:13.367

我认为 ObjC 由于历史的怪癖和专有系统的性质而与 Apple 世界隔离开来。

首先，您需要将 ObjC 与 Cocoa 分开。ObjC 是一种非常原始的语言。我认为它是一种非常优雅的语言，但它非常基础。您可以在 C 预处理器中实现 ObjCv1。C++ 和 ObjC 几乎是同时开发的。C++ 建立了大量的基础设施，为基本上完全不同的语言带来了类似 C 的语法。ObjC 为 C 带来了类似 Smalltalk 的语法，几乎没有其他任何东西。甚至像`+alloc`和`-release`不是 ObjC 的语言元素的东西。它们是相当简单的包装器`malloc()`and `free()`。^*就其本身而言，ObjC 并不是那么有趣（我认为它很优雅）。这与 Smalltalk 的性质非常相似。没有它的对象库，你就无能为力了。凭借其对象库，它非常强大。

NeXT 在称为 NeXTSTEP 的 ObjC 之上提供了整个框架。由于 NeXT 计算机没有取得广泛的商业成功，而且 NeXTSTEP 是专有的，所以学习框架或底层语言的人并不多。当 Apple 购买它并将其转变为 Cocoa 时，它仍然是一个专有系统。

GNUStep 已经存在，但他们从未开发出足够有趣的东西来吸引大量开发人员（主要的 Web 浏览器或文字处理器等）。在过去的几年里，Cocoa 已经远远领先于 GNUStep。有可能随着 iPhone 对 Cocoa 的兴趣增加，GNUStep 可能会重新焕发生机并带来一个不错的跨平台开发框架，但我有点怀疑。有 C++ 背景的人看看 C# 并看到明显的改进。当他们查看 ObjC 时，他们会看到很多他们没想到的方括号。对于在“调用方法”范式上长大的人来说，“传递消息”的 Smalltalk 范式是陌生的，甚至有点可怕。许多开发人员认为他们需要一种强类型语言来避免错误，并且对主要依赖于程序员纪律和谨慎一致性的系统感到不舒服。在 C# 中破解“正常工作”的东西比在 ObjC 中容易得多。ObjC 真的希望更多的开发人员了解正在发生的事情，而不是依赖编译器来保护您免受黑客攻击。

基本上，人们从 Unix 就知道 C，C++ 就 C 而言是有意义的，Java 就 C++ 而言是有意义的，而 C# 只是清理了 Java。ObjC 不是这些。是 Smalltalk，没有人再学习 Smalltalk。

^*我最近和写过它历史的人聊天，`+alloc`考虑到包含区域，他可能会反对我称它为简单的包装器。因此，对于知道区别的您，请`+alloc`在此处替换为`+new`.

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-17T14:18:39.967

好吧，还有一些人仍在为其开发的 GNUStep 框架。但是，我不知道该社区有多活跃。

但在大多数情况下，Objective-C 现在是一种 Apple 语言，正如该语言的“2.0”版本是作为 OSX 10.5 的一部分推出的，并且似乎是 Apple 纯粹的内部开发工作。

编辑：你可能知道，Apple 有一个叫做 Cocoa 框架的东西，它基本上指的是 Objective-C 的整个库堆栈，包括 NSObject 通用基类。Cocoa 是 NextStep 库的延续，GNUStep 是它的开源版本。所以你会在这两个地方找到许多以 NS 为前缀的类，但 Apple 并没有阻止在 Cocoa 中添加新类或更改它们，因此 GUI 级别的互操作性实际上只是一种理论上的可能性。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-03-07T05:38:38.673

@Stephen：我一直对人们在说出这样的话之前从未阅读我们的网站甚至检查项目进度感到惊讶。:) GNUstep 现在紧跟 Cocoa，在这一点上我们比 OpenStep 还要多。如果您或其他人想对该主题有真正的看法，请从 SVN 获取 GNUstep，安装并尝试一下。对您一无所知的事情（正如您在此处的回答所证明的那样）的高谈阔论是毫无意义的。

Greg C. GNUstep 首席开发人员

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-15T15:28:56.133

GNUstep 实际上比大多数人想象的要活跃得多，非常值得关注。创建跨 GNUstep 和 Cocoa 工作的应用程序并不难（意味着可能在 OSX、Win、Linux、BSD 上......）

这些链接绝对值得任何对该主题感兴趣的人查看：

[http://www.gnu.org/software/gnustep/information/aboutGNUstep.html](http://www.gnu.org/software/gnustep/information/aboutGNUstep.html)

[http://etoileos.com/news/](http://etoileos.com/news/)

[http://www.nongnu.org/gap/](http://www.nongnu.org/gap/)

然后是 Cocotron，一个“旨在实现类似于 Apple Inc. 的 Cocoa 文档描述的跨平台 Objective-C API 的开源项目”：

[http://www.cocotron.org/](http://www.cocotron.org/)

编辑：有关使用 GNUstep 构建的商业跨平台产品的示例，请查看[Eggplant](http://www.testplant.com/products/eggplant_functional_tester)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-17T14:18:46.067

[GNU步](http://www.gnu.org/software/gnustep/)。还有[Étoilé](http://etoileos.com/)，它是一个使用 GNUstep 构建的操作系统。

我认为很多人更喜欢 C 或 C++，如果他们想要更现代的语言，他们会使用 C# 或 Java。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T14:20:25.050

我认为 Apple 的实施得到了更好的支持，并且仍在积极开发中。还有一些其他地方，例如[GNUStep](http://gnustep.org/)，但它们看起来仍然非常接近 NextStep/OpenStep 级别。不幸的是，从那以后发生了很多事情！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-15T15:37:13.553

Mono 团队正在做一些 iPhone 开发，允许 iPhone 应用程序用 .NET 编写并与 Mono .NET 编译器交叉编译。查看[http://www.mono-project.com/Mono:Iphone](http://www.mono-project.com/Mono:Iphone)

在最新的[.NET Rocks 播客](http://www.dotnetrocks.com/default.aspx?showNum=454)中，[Rory Blythe](http://www.neopoleon.com/home/default.aspx)谈论了他在 Objective C 和 iPhone 开发中所做的事情。

# .net - asp.net：在多个线程对象上调用连接方法？

> ID：874695
> 
> 赞同：0
> 
> 时间：2009-05-17T14:15:40.350
> 
> 标签：.net, multithreading, join, main

我在主线程中有一个listoddata和一个线程列表。我将列表的每个元素数据传递给相应的线程。希望主线程等待所有线程都被执行。

```
for (int i = 0; i < listOfThread.Count; i++)
            {
                listOfThread[i].Join();

            }
// code after all of thread completes its work
//code block2 
```

但是在这个循环的第一次迭代之后，主线程将不会被执行。如果任何线程 0 完成。代码块将被执行。我不想要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T15:22:43.230

这是处理多个线程的一种完全有效的方法`join`。如果您等待所有线程，即使是按顺序等待，也可以。它不必等待已经完成的线程。如果线程仍在运行，它将等待该线程完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T15:20:03.033

Sahil，您通过确保调用所有线程上的连接而不必等待每个线程执行来试图实现什么？如果它是为了性能，它不会有太大帮助，因为无论如何，即使您在所有线程上调用 thread.join，它也必须等待每个线程完成才能继续前进。

无论如何，如果您必须这样做，那么这就是我要说的：

没有直接的方法可以在一个 stmt 中等待所有线程。相反，经过一些研发后，我想出了一些间接的方法。您可以直接在 ParameterizedThreadDelegate 上执行 BeginInvoke，而不是初始化线程并将 ParameterizedThreadDelegate 传递给它。然后您可以使用 WaitHandle.WaitAll 等待所有代表完成执行，然后再继续。

这是代码：

```
class Program
{
    static void Main(string[] args)
    {
        List<ParameterizedThreadStart> listDelegates = new List<ParameterizedThreadStart>();
        listDelegates.Add(new ParameterizedThreadStart(DelegateEg.Print));
        listDelegates.Add(new ParameterizedThreadStart(DelegateEg.Display));

        List<WaitHandle> listWaitHandles = new List<WaitHandle>();

        foreach (ParameterizedThreadStart t in listDelegates)
            listWaitHandles.Add(t.BeginInvoke("In Thread", null, null).AsyncWaitHandle);

        WaitHandle.WaitAll(listWaitHandles.ToArray());

        Console.WriteLine("All threads executed");

        Console.Read();

    }
}

public class DelegateEg
{
    public static void Print(object obj)
    {
        Console.WriteLine("In print");
        Console.WriteLine(obj);
    }

    public static void Display(object obj)
    {
        Console.WriteLine("In Display");
        Console.WriteLine(obj);

    }
} 
```

# versioning - 寻找具有热代码交换的编程平台

> ID：874706
> 
> 赞同：4
> 
> 时间：2009-05-17T14:18:58.080
> 
> 标签：versioning, virtual-machine, hotswap

我目前正在就如何在程序运行时升级程序进行头脑风暴。（不是在调试时，一个“生产”系统。）

但它需要做的一件事是，将更改的源代码或编译后的字节码实际提交到正在运行的进程中。

伪代码

```
var method = typeof(MyClass).GetMethod("Method1");
var content = //get it from a database (bytecode or source code)
  SELECT content FROM methods WHERE id=? AND version=?
method.SetContent(content); 
```

首先，我想实现系统在没有面向对象复杂性的情况下工作。这导致了以下要求：

*   更改函数的源代码或字节码
*   删除函数
*   添加新功能
*   更改函数的签名

使用 .NET（和其他），我可以通过 IoC 注入一个类，从而可以更改源代码。但是加载会很麻烦，因为一切都必须在程序集中或通过 Emit 创建。也许使用Java会更容易？我认为整个 ClassLoader 是可替换的。

使用 JavaScript，我可以实现许多目标。只需评估一个新函数 (MyMethod_V25) 并将其分配给 MyClass.prototype.MyMethod。我认为人们也可以使用“del”以某种方式删除功能

哪个通用平台可以处理这样的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-27T14:52:13.123

我认为任何基于图像的语言都会支持这一点。我知道 Common Lisp 可以，因为它可能是部署 Lisp Web 应用程序的最常见方法之一，但我怀疑它在 Smalltalk 中的工作方式几乎相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T14:58:13.803

在 Java 中，您拥有[OSGi](http://www.osgi.org/Main/HomePage)项目，它有助于升级和更改应用程序的模块，而无需触及其他模块。

如果你不介意学习一些不同的东西，[Erlang](http://erlang.org/)编程语言是从一开始就考虑到这种类型的应用程序而设计的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T14:31:59.687

大多数动态语言都有这种能力。看看 Ruby：您可以在运行时修改现有方法等。IronRuby 推出后，您也可以在 .Net 平台上执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T15:03:50.420

我的印象是，现在 Erlang 作为一种具有这种能力的语言非常明显。话虽如此，我的岳父（我认为是一名高级程序员）告诉我，他在一个更旧的平台上实现了热插拔代码——他们现在称之为 z/OS（之前的 OS/390）的汇编程序）。

就我个人而言，我一直在寻找在 Java 领域实现这一目标的方法，目前我的大部分专业工作都是在 Java 领域完成的。在 Javaland 中，提供热卸载（据我所知）的最佳宣传工作是[OSGi 联盟](http://www.osgi.org/About/WhatIsOSGi)所做的工作。也就是说，由于一些常见的 Java 库是如何构建的（例如：JDBC `DriverManager`），这个解决方案必然涉及到一些类加载器魔法。如果您选择走 OSGI 路线，您的代码可能需要大量审核和测试，以确保它可用于 OSGi 架构。

作为实现热交换代码的替代方案，也许您可​​以使用可能更简单的请求队列机制来实现一个似乎具有此功能的系统。例如，如果您需要热交换处理大型后端请求的系统部分，为什么不通过中介发送这些请求，如果后端组件正在运行，则可以将它们分派到队列中，如果组件已关闭？这可能允许您独立于系统的其余部分升级后端组件，而无需重新部署，正如我们在行业中所说的“整个 shebang”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T14:22:51.563

使用 JavaScript 可以做到。令人惊奇的是，Google 的 V8 引擎是开源的，并且很容易在任何 C++ 程序中实现。

[http://code.google.com/p/v8/](http://code.google.com/p/v8/)

当然，您必须编写一些库来公开功能并从 JavaScript 内部加载脚本。这将取决于你想要做什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-26T22:54:09.487

> 但它需要做的一件事是，将更改的源代码或编译后的字节码实际提交到正在运行的进程中。哪个通用平台可以处理这样的事情？

Erlang 已经提到过，它使用显式的“同步点”，运行中的例程可以通过使用“?MODULE:routine()”进行“自我”调用来显式更新自身。

这是要记住的另一件重要事情：您不仅需要 VM 中的功能来替换正在运行的代码，而且正在运行的代码还需要一种方法来响应此类更新并进行相应的调整。

您可能还想研究[UpgradeJ](http://www.cl.cam.ac.uk/techreports/UCAM-CL-TR-716.pdf)，它是一种专门为满足此要求（代码热交换）而设计的语言。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-06T14:49:23.563

使用 .NET，这是通过托管可扩展性框架完美实现的。此框架是在 .NET 4 中引入的。您可以构建可扩展的应用程序。它做了 IoC 容器可以做的事情，尽管它可以做更多事情。它可以发现不知道先验的功能。此外，您可以更新功能，您不知道会先验更新。换句话说，它是一个模块化应用程序的框架，无论您是想要热交换代码块并想要提供不同的功能，还是更新已经存在的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-06T17:18:52.783

Erlang 可以做你正在寻找的一切，并且它不依赖于任何附加库（除非你将 OTP 计入该类别）或编码变通办法。它可以在重新加载期间保持状态（即命令式语言中的“变量值”），并且不需要缓冲或重新传输事务。如果您以 OTP 风格编写代码，那么您可以让您的应用程序程序员编写简单的顺序代码，这些代码将具有一定程度的并行执行能力，并支持热重载，所有这一切都无需他们担心如何完成。它只是工作。

# javascript - 将用户输入字符串转换为正则表达式

> ID：874709
> 
> 赞同：385
> 
> 时间：2009-05-17T14:20:18.000
> 
> 标签：javascript, html, regex

我正在用 HTML 和 JavaScript 设计一个正则表达式测试器。用户将输入一个正则表达式、一个字符串，并通过单选按钮选择他们想要测试的函数（例如搜索、匹配、替换等），当使用指定参数运行该函数时，程序将显示结果。自然会有额外的文本框来替换额外的参数等。

我的问题是从用户那里获取字符串并将其转换为正则表达式。如果我说他们不需要`//`在他们输入的正则表达式周围有 's，那么他们就不能设置标志，比如`g`and `i`。所以他们必须`//`在表达式周围加上 's，但我怎样才能将该字符串转换为正则表达式？它不能是文字，因为它是一个字符串，我不能将它传递给 RegExp 构造函数，因为它不是没有`//`'s 的字符串。有没有其他方法可以将用户输入字符串变成正则表达式？我是否必须用`//`'s 解析正则表达式的字符串和标志，然后以另一种方式构造它？我应该让他们输入一个字符串，然后分别输入标志吗？

* * *

## 回答 #1

> 赞同：669
> 
> 时间：2009-05-17T14:26:43.303

使用[RegExp 对象构造函数](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp)从字符串创建正则表达式：

```
var re = new RegExp("a|b", "i");
// same as
var re = /a|b/i; 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2009-05-17T14:34:54.547

```
var flags = inputstring.replace(/.*\/([gimy]*)$/, '$1');
var pattern = inputstring.replace(new RegExp('^/(.*?)/'+flags+'$'), '$1');
var regex = new RegExp(pattern, flags); 
```

或者

```
var match = inputstring.match(new RegExp('^/(.*?)/([gimy]*)$'));
// sanity check here
var regex = new RegExp(match[1], match[2]); 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2016-02-18T09:54:52.717

这是一个单行：`str.replace(/[|\\{}()[\]^$+*?.]/g, '\\$&')`

我从[escape-string-regexp](https://github.com/sindresorhus/escape-string-regexp) NPM 模块得到它。

尝试一下：

```
escapeStringRegExp.matchOperatorsRe = /[|\\{}()[\]^$+*?.]/g;
function escapeStringRegExp(str) {
    return str.replace(escapeStringRegExp.matchOperatorsRe, '\\$&');
}

console.log(new RegExp(escapeStringRegExp('example.com')));
// => /example\.com/ 
```

使用带有标志支持的标记模板文字：

```
function str2reg(flags = 'u') {
    return (...args) => new RegExp(escapeStringRegExp(evalTemplate(...args))
        , flags)
}

function evalTemplate(strings, ...values) {
    let i = 0
    return strings.reduce((str, string) => `${str}${string}${
        i < values.length ? values[i++] : ''}`, '')
}

console.log(str2reg()`example.com`)
// => /example\.com/u 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-17T14:24:36.630

使用[JavaScript RegExp 对象构造函数](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)。

```
var re = new RegExp("\\w+");
re.test("hello"); 
```

您可以将标志作为第二个字符串参数传递给构造函数。有关详细信息，请参阅文档。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-03-31T14:15:20.507

在我的情况下，用户输入 somethimes 被分隔符包围，有时没有。因此我添加了另一个案例..

```
var regParts = inputstring.match(/^\/(.*?)\/([gim]*)$/);
if (regParts) {
    // the parsed pattern had delimiters and modifiers. handle them. 
    var regexp = new RegExp(regParts[1], regParts[2]);
} else {
    // we got pattern string without delimiters
    var regexp = new RegExp(inputstring);
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-03-20T10:49:09.303

尝试使用以下功能：

```
const stringToRegex = str => {
    // Main regex
    const main = str.match(/\/(.+)\/.*/)[1]

    // Regex options
    const options = str.match(/\/.+\/(.*)/)[1]

    // Compiled regex
    return new RegExp(main, options)
} 
```

你可以像这样使用它：

```
"abc".match(stringToRegex("/a/g"))
//=> ["a"] 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-17T14:29:00.753

我建议您还为特殊标志添加单独的复选框或文本字段。这样很明显，用户不需要添加任何`//`'s。在替换的情况下，提供*两个*文本字段。这会让你的生活轻松很多。

为什么？因为否则有些用户会添加`//`'s 而其他人不会。有些会出现语法错误。然后，在您剥离`//`'s 之后，您最终可能会得到一个语法上有效的正则表达式，这与用户的意图完全不同，从而导致奇怪的行为（从用户的角度来看）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2021-03-22T18:13:49.423

这是我处理自定义分隔符和无效标志的一个线性函数

```
function stringToRegex(s, m) {
  return (m = s.match(/^([\/~@;%#'])(.*?)\1([gimsuy]*)$/)) ? new RegExp(m[2], m[3].split('').filter((i, p, s) => s.indexOf(i) === p).join('')) : new RegExp(s);
}

console.log(stringToRegex('/(foo)?\/bar/i'));
console.log(stringToRegex('#(foo)?\/bar##gi')); //Custom delimiters
console.log(stringToRegex('#(foo)?\/bar##gig')); //Duplicate flags are filtered out
console.log(stringToRegex('/(foo)?\/bar')); // Treated as string
console.log(stringToRegex('gig')); // Treated as string
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-09-09T07:51:19.467

当字符串无效或不包含标志等时，这也将起作用：

```
function regExpFromString(q) {
  let flags = q.replace(/.*\/([gimuy]*)$/, '$1');
  if (flags === q) flags = '';
  let pattern = (flags ? q.replace(new RegExp('^/(.*?)/' + flags + '$'), '$1') : q);
  try { return new RegExp(pattern, flags); } catch (e) { return null; }
}

console.log(regExpFromString('\\bword\\b'));
console.log(regExpFromString('\/\\bword\\b\/gi')); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-17T14:29:03.873

您可以使用复选框请求标志，然后执行以下操作：

```
var userInput = formInput;
var flags = '';
if(formGlobalCheckboxChecked) flags += 'g';
if(formCaseICheckboxChecked) flags += 'i';
var reg = new RegExp(userInput, flags); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-09-21T01:45:42.303

由于较早的答案，此块可以很好地用作将可配置字符串应用于 RegEx .. 以过滤文本的通用解决方案：

```
var permittedChars = '^a-z0-9 _,.?!@+<>';
permittedChars = '[' + permittedChars + ']';

var flags = 'gi';
var strFilterRegEx = new RegExp(permittedChars, flags);

log.debug ('strFilterRegEx: ' + strFilterRegEx);

strVal = strVal.replace(strFilterRegEx, '');
// this replaces hard code solt:
// strVal = strVal.replace(/[^a-z0-9 _,.?!@+]/ig, ''); 
```

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2019-07-16T07:06:36.047

我`eval`用来解决这个问题。

例如：

```
 function regex_exec() {

        // Important! Like @Samuel Faure mentioned, Eval on user input is a crazy security risk, so before use this method, please take care of the security risk. 
        var regex = $("#regex").val();

        // eval()
        var patt = eval(userInput);

        $("#result").val(patt.exec($("#textContent").val()));
    } 
```

# c# - 如何在 C# 中使 TextBox 非交互

> ID：874716
> 
> 赞同：1
> 
> 时间：2009-05-17T14:23:08.570
> 
> 标签：c#, textbox

我在用于显示数据的表单上有一个 TextBox。我已将其设置为 ReadOnly 以阻止用户更改 TextBox 中显示的数据。虽然用户仍然可以突出显示 TextBox 中的数据，但如何禁用它呢？

注意：我知道使用标签会容易得多，尽管由于某种原因标签不会让我以我想要的方式显示数据。我想从显示区域的右侧开始显示一个数字，即：“25”，尽管标签显示为“25”。我尝试使标签右对齐，但这并不能解决问题。因此我使用的是文本框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T14:27:13.550

```
TextBox1.Enabled = false; 
```

或者您可以使用属性 RightToLeft 设置为 True 的标签

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T14:37:07.630

您可以通过将 TextAlign 属性设置为 MiddleRight 来在标签中显示右对齐的文本。还要记住将 AutoSize 属性设置为 false，否则它将调整标签大小并且位置将更改为向左。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-08T23:35:29.813

您可以修改事件处理程序（例如，在 Enter 操作上）以将表单的 Active 属性移动到另一个控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-01T06:15:45.420

这只是一个简单的`C#`代码，我只是写它来禁用我的一些文本框和按钮。但是，您可以根据您的要求更改它：

* * *

```
TextBox[] tbArray = new TextBox[]
{
    custid,custname , field, email, phone, address
};
for (int i = 0; i < tbArray.Length; i++)
{
    if (status.SelectedIndex == 1)
    {
        tbArray[i].Enabled = false;
        savecust.Enabled = false;
        deletecust.Enabled = false;
    }
    else
    {
        tbArray[i].Enabled = true;
        savecust.Enabled = true;
        deletecust.Enabled = true;
    }
} 
```

* * *

# c++ - VC2008中的返回值优化

> ID：874719
> 
> 赞同：0
> 
> 时间：2009-05-17T14:25:35.677
> 
> 标签：c++, optimization, visual-c++-2008, return-value-optimization

是否有其他技术可以与 VC2008 一起使用，例如 RVO（返回值优化）或 NRVO（命名返回值优化）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T14:38:17.813

如果我是你，我不会太担心这些优化。除此之外，它们不是便携式的。

如果您担心编写高效的 C++ 代码，第一条规则是完全避免复制。确保在所有可能的地方都使用参考，但不要尝试在不能使用的地方使用它们。之后，有时您实际上需要一个新值 - 例如，作为 operator+() 实现的返回值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T14:33:22.397

也许[这](http://en.wikipedia.org/wiki/Compiler_optimization#Optimization_techniques_2)可以帮助你。

但通常是编译器进行这种优化，而不是你。

# svn - 转移 SVN 属性

> ID：874725
> 
> 赞同：0
> 
> 时间：2009-05-17T14:27:19.697
> 
> 标签：svn

看起来 SVN 属性存储在本地工作副本文件夹中，而不是服务器上。

如果这是正确的，我如何将工作副本文件夹下不同文件中已经定义的这些属性复制到另一台机器上？

唯一需要转移的属性是**svn:ignore**。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T14:31:44.227

所有属性（特定于 Subversion，如 'svn:ignore' 或用户定义的）都存储在存储库中。也许您在设置/更改它们之后忘记了提交？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T14:32:18.937

`svn`属性存储在存储库中。当您更改它们时，您必须提交更改。

# django - 不要在 CustomManager.get_query_set() 中过滤！但是 all()、get()、filter()、exclude() 呢？

> ID：874726
> 
> 赞同：2
> 
> 时间：2009-05-17T14:27:32.850
> 
> 标签：django

[django 的经理文档](http://docs.djangoproject.com/en/dev/topics/db/managers/#do-not-filter-away-any-results-in-this-type-of-manager-subclass)有一段被 覆盖`DO NOT FILTER AWAY ANY RESULTS IN THIS TYPE OF MANAGER SUBCLASS`，但在下面的文字中只提到`get_query_set()`

过滤all()、get()、filter()、exclude()是否省事？

我想这样做的原因：我想要自动管理器，因为它使我能够控制哪些行被发送到模板标签，如[b-list 中所述：编写更好的模板标签](http://www.b-list.org/weblog/2006/jun/07/django-tips-write-better-template-tags/)

这段代码可以吗？

```
class ArticleMananger(models.Manager):
    def get_query_set(self):
        return super(ArticleMananger, self).get_query_set()
    def all(self): 
        return super(ArticleMananger, self).filter(published=True)   
    def filter(self,  **kwargs):
        return super(ArticleMananger, self).filter(published=True).filter(**kwargs) 
    .... 
```

* * *

**编辑：**如果有人投反对票，最好或公平地解释原因。这个问题有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T15:15:17.943

我认为，这只是一个警告，如果此管理器获取模型的默认（对象）管理器，则不要在您的 models.Manager 子类中覆盖方法 get_query_set() 而不进一步考虑 Django 本身对该方法的使用。否则，您可能会遇到难以调试的行为。

尝试将打印语句添加到您的覆盖方法中，以查看其他应用程序（即管理应用程序）何时以及多久使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T22:00:30.223

基本思想是，如果您更改模型的*默认*`all()`管理器在or等​​常用方法中检索对象的方式`filter()`，您最终会遇到想要检索某些特定对象但不能检索的情况。通常这将很难诊断，因为它会以神秘的不出现的对象出现，或者出现`DoesNotExist`您没有预料到的异常。

只要您保留一个*可以*正常检索所有内容的默认管理器，就可以在同一类的其他管理器中执行自定义操作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-17T16:26:20.860

我做了一些测试，将回答我自己的问题：

## 也不要过滤 all(),...！

我刚试了一下。它破坏了管理界面的一部分。从技术角度来看，可以覆盖/扩展 template/admin/apps/* 以使用另一个管理器（即通过自己的标签），但我得出的结论是，它不值得这项工作。相反，我会将我的标签重写为如下内容：

```
def render(self, context):
    if hasattr(self.model, 'publicmgr'):
        context[self.varname] = self.model.publicmgr.all().order_by(self.by)[:self.num]
    else:
        context[self.varname] =   self.model._default_manager.all().order_by(self.by)[:self.num]
    return  '' 
```

# c# - 使鼠标位置超过表单的最佳方法是什么？

> ID：874738
> 
> 赞同：4
> 
> 时间：2009-05-17T14:32:24.180
> 
> 标签：c#, .net, mouse, onmousemove, mouse-position

**我想要获得表格鼠标位置的最佳方法。**

我现在在变量中设置鼠标位置的值，以便在另一种方法“Like Form1_Click”中获取它们。

有没有更好的方法来做到这一点？？

非常感谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-17T14:35:34.763

这对你有什么作用？

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.onmousemove.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.onmousemove.aspx)

另一种选择是：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseposition.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mouseposition.aspx)

然后在表单上使用：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoclient.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.pointtoclient.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-13T21:05:34.633

```
xm=System.Windows.Forms.Cursor.Position.X - this.Location.X
ym=System.Windows.Forms.Cursor.Position.Y - this.Location.Y 
```

那么你应该这样做：

```
xm - form border x 
ym - form border y 
```

# c# - 如何从匿名类型中获取属性值？

> ID：874746
> 
> 赞同：25
> 
> 时间：2009-05-17T14:35:33.110
> 
> 标签：c#, .net, anonymous-types

我有一个由 Linq 查询填充的数据网格。当数据网格中的焦点行发生更改时，我需要设置一个变量，该变量等于该对象中的属性之一。

我试过...

```
var selectedObject = view.GetRow(rowHandle);
_selectedId = selectedObject.Id; 
```

...但编译器根本不关心这一点（“嵌入式语句不能是声明或标记语句”）。

看来该物业应该很容易进入。在运行时检查对象显示了我期望的所有属性，我只是不知道如何访问它们。

如何访问匿名对象的属性？

**编辑澄清：**

我碰巧正在使用 DevExpress XtraGrid 控件。我用一个由几个不同对象组成的 Linq 查询加载了这个控件，因此使数据不真正符合我已经拥有的任何一个类（即，我不能将它转换为任何东西）。

我正在使用.NET 3.5。

当我查看 view.GetRow(rowHandle) 方法的结果时，我得到一个匿名类型，如下所示：

```
{ ClientId = 7, ClientName = "ACME Inc.", Jobs = 5 } 
```

我的目标是从这种匿名类型中获取 ClientId，以便我可以做其他事情（例如加载包含该客户记录的表单）。

我在早期答案中尝试了一些建议，但无法达到可以获取此 ClientId 的程度。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2010-07-28T23:33:38.793

你有没有尝试过使用反射？这是一个示例代码片段：

```
// use reflection to retrieve the values of the following anonymous type
var obj = new { ClientId = 7, ClientName = "ACME Inc.", Jobs = 5 }; 
System.Type type = obj.GetType(); 
int clientid = (int)type.GetProperty("ClientId").GetValue(obj, null);
string clientname = (string)type.GetProperty("ClientName").GetValue(obj, null);

// use the retrieved values for whatever you want... 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-12-04T02:25:37.327

获取给定键的数据项值的通用解决方案

```
public static T GetValueFromAnonymousType<T>( object dataitem, string itemkey ) {
    System.Type type = dataitem.GetType();
    T itemvalue = (T)type.GetProperty(itemkey).GetValue(dataitem, null);
    return itemvalue;
} 
```

例子：

```
var dataitem = /* Some value here */;
bool ismember = TypeUtils.GetValueFromAnonymousType<bool>(dataitem, "IsMember"); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-17T14:46:56.610

匿名类型的问题之一是难以在函数之间使用它们。没有办法“命名”匿名类型，因此很难在它们之间进行转换。这可以防止它们被用作出现在元数据中并且是用户定义的任何内容的类型表达式。

我无法准确说出您在上面使用的是哪个 API。但是，API 不可能返回强类型的匿名类型，所以我猜测 selectedObject 的类型是对象。C# 3.0 及更低版本不支持动态访问，因此您将无法访问属性 ID，即使它在运行时可用。

您需要执行以下操作之一才能解决此问题

*   使用反射抓取属性
*   创建一个完整类型并使用它来填充数据网格
*   使用许多 hacky 匿名类型转换之一

**编辑**

这是有关如何进行 hack 匿名类型转换的示例

```
public T AnonymousTypeCast<T>(object anonymous, T typeExpression) { 
  return (T)anonymous;
}

...
object obj = GetSomeAnonymousType();
var at = AnonymousTypeCast(obj, new { Name = String.Empty, Id = 0 }); 
```

它很hacky的原因是它很容易破解。例如在最初创建匿名类型的方法中。如果我在该类型中添加另一个属性，上面的代码将编译但在运行时失败。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-03-30T07:04:33.707

您可以使用动态类型在运行时访问匿名类型的属性，而无需使用反射。

```
var aType = new { id = 1, name = "Hello World!" };
//...
//...
dynamic x = aType;
Console.WriteLine(x.name); // Produces: Hello World! 
```

在此处阅读有关动态类型的更多信息：http: [//msdn.microsoft.com/en-us/library/dd264736.aspx](http://msdn.microsoft.com/en-us/library/dd264736.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-29T16:25:40.947

当我处理传递匿名类型并尝试重铸它们时，我最终发现编写一个处理对象工作的包装器更容易。这是有关它的博客文章的链接。

[http://somewebguy.wordpress.com/2009/05/29/anonymous-types-round-two/](http://somewebguy.wordpress.com/2009/05/29/anonymous-types-round-two/)

最终，您的代码将如下所示。

```
//create an anonymous type
var something = new {  
  name = "Mark",  
  age = 50  
};  
AnonymousType type = new AnonymousType(something);

//then access values by their property name and type
type.With((string name, int age) => {  
  Console.Write("{0} :: {1}", name, age);  
}); 

//or just single values
int value = type.Get<int>("age"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T16:49:25.097

正如 JaredPar 猜对的那样，返回类型`GetRow()`是`object`. 使用 DevExpress 网格时，您可以像这样提取所需的值：

```
int clientId = (int)gridView.GetRowCellValue(rowHandle, "ClientId"); 
```

这种方法有类似的缺点，比如前面描述的“hacky 匿名类型转换”：您需要一个用于标识列的魔术字符串以及从 object 到 int 的类型转换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-28T05:29:09.930

DevExpress 的 xtraGridView 有一个类似 GetRowCellDisplayText(int rowHandle, GridColumn column) 的方法。使用此方法，以下代码从匿名类型返回 id。

```
var _selectedId = view.GetRowCellDisplayText(rowHandle, "Id"); 
```

虽然这并没有回答“我如何才能访问匿名对象的属性？”这个问题，但它仍然试图解决问题的根本原因。

我使用 devXpress 11.1 版进行了尝试，我可以看到这个问题是在大约 2.5 年前首次提出的。问题的作者可能已经找到了解决方法或自己找到了解决方案。但是，我仍在回答，以便它可以帮助某人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-17T15:03:17.693

这可能是错误的（您可能没有足够的代码）但您不需要索引到该行以便选择您想要的列吗？或者，如果“Id”是您想要的列，您应该执行以下操作：

```
var selectedObject = view.GetRow(rowHandle);
_selectedId = selectedObject["Id"]; 
```

这就是我在数据网格中获取列内容的方式。现在，如果列本身是匿名类型，那么我不知道，但是如果您只是获得具有原始类型的命名列，那么这应该可以。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-11T23:05:29.807

希望这会有所帮助，我正在传递一个接口列表，我需要从中获取一个不同的列表。首先我得到一个匿名类型列表，然后我将它传送到我的对象列表中。

```
private List<StockSymbolResult> GetDistinctSymbolList( List<ICommonFields> l )
            {
                var DistinctList = (
                        from a
                        in l
                        orderby a.Symbol
                        select new
                        {
                            a.Symbol,
                            a.StockID
                        } ).Distinct();

                StockSymbolResult ssr;
                List<StockSymbolResult> rl = new List<StockSymbolResult>();
                foreach ( var i in DistinctList )
                {
                                // Symbol is a string and StockID is an int.
                    ssr = new StockSymbolResult( i.Symbol, i.StockID );
                    rl.Add( ssr );
                }

                return rl;
            } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-03-24T14:55:42.757

您可以像这样遍历匿名类型的属性：

```
var obj = new {someValue = "hello", otherValue = "world"};
foreach (var propertyInfo in obj.GetType().GetProperties() {
    var name = propertyInfo.Name;
    var value = propertyInfo.GetValue(obj, index: null);
    ...
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-23T08:36:34.753

如果您知道自己在做什么并且不害怕在代码更改时出现运行时错误，您可以将行数据转换为`dynamic`：

```
var data = view.GetRow(rowHandle) as dynamic;  

int clientId      = data.ClientID;
string clientName = data.ClientName;
int jobs          = data.Jobs 
```

没有编译时验证。但它应该工作得很好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-12-30T21:45:50.347

```
var result = ((dynamic)DataGridView.Rows[rowNum].DataBoundItem).value; 
```

# asp.net - 设置百分比格式 ASP.Net 的属性

> ID：874748
> 
> 赞同：1
> 
> 时间：2009-05-17T14:36:11.143
> 
> 标签：asp.net, formatting, numbers

毫无疑问，Applogies 是一个菜鸟问题。

我在 ASP.Net 的网格视图中显示了几个百分比值

我希望能够设置**NumberFormatInfo.PercentPositivePattern**属性，我认为我必须引入全局“属性”才能进行调整？

从默认 0 到 1

这是我需要调整的属性

[http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.percentpositivepattern(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.percentpositivepattern(VS.71).aspx)

我只是不知道该怎么做！:(

这将删除 % 和数字之间的空格。

如何为整个应用程序执行此操作？

我可以在 WebConfig 中添加一些代码吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T14:58:45.893

您可以在每个请求开始时将 System.Globalization.CultureInfo.CurrentCulture 更改为您想要的任何内容（例如，在 global.asax 中的 Application_BeginRequest 中）。

当然，这会影响应用程序显示的所有值，而不仅仅是 GridView 中显示的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T14:50:24.603

我不确定你是否可以在`web.config`文件中设置它，但你可以做的是从网格视图继承，在构造函数中设置属性并使用新的子类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T15:12:44.393

您可以使用 BoundField 上的 DataFormatString 属性修改格式：

```
<asp:BoundField DataField="YourPropertyName" DataFormatString="#0.##%" /> 
```

根据这篇文章，您可以将格式设置为您喜欢的自定义格式：

[http://msdn.microsoft.com/en-us/library/0c899ak8.aspx](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

# ruby-on-rails - 在 Rails 中转换数据库结构/数据

> ID：874752
> 
> 赞同：3
> 
> 时间：2009-05-17T14:37:23.947
> 
> 标签：ruby-on-rails, migration

这是对这个问题的一种跟进：[Rails Migrations 可以用来转换数据吗？](https://stackoverflow.com/questions/849897/can-rails-migrations-be-used-to-convert-data)

如果我在一个分支上工作，当它重新集成并发布到生产环境时，会极大地改变数据库模式。确保生产中的所有数据都转换为新格式的最佳方法是什么？

一个简单的例子是，我们想要将一个数字列更改为文本并对数据进行一些转换工作。然后我们要删除旧列。

有人建议我不要在迁移中进行任何数据操作，而是为此创建 rake 任务。是否有一种机制可以确保 rake 任务可以与迁移一起按顺序运行？

现在，我能想到的唯一解决方案是将所有将失效列放入第二个集合的迁移捆绑在一起。运行添加新表的第一组迁移。运行 rake 任务，然后运行第二组迁移。这对我来说似乎不是一个理想的解决方案，而且很容易出错。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T22:08:47.210

迁移正是为了这种东西。为新版本的应用程序转换数据库中的数据，无论是否更改架构，都应该是迁移。这是保证在新版本的应用程序上线之前在生产中完成新的更改。

当您在分支中工作时，只需创建一个新的迁移，这将创建一个新的时间戳文件。当您合并回发布分支时，该文件将被复制过来。由于时间戳，迁移将（可能）以正确的顺序执行。

但是，如果您正在进行的转换将继续不时执行，那么您应该使用 Rake 任务。

# mysql - Ruby on Rails、ActiveRecord、二进制搜索

> ID：874755
> 
> 赞同：0
> 
> 时间：2009-05-17T14:41:02.240
> 
> 标签：mysql, ruby-on-rails, activerecord, migration, binary-search

如果我有下表。

```
create_table :my_table, :id => false do |t|
   t.string :key_column
   t.string :value_column
end 
```

我将如何确保通过 :key 字段为二进制搜索优化**存储行？**

我将如何确保使用二进制搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T16:52:18.403

对于任何有趣的行数，通过键访问单个随机记录的最佳方式（对于“最佳”的大多数定义）是​​创建索引。

```
CREATE INDEX my_index ON my_table ( key_column ); 
```

或在 ActiveRecord 迁移中：

```
add_index(:my_table, :key_column) 
```

数据库索引通常使用二分搜索，使用[B-trees](http://en.wikipedia.org/wiki/B-tree)或类似的，这在存储成本和检索和更新时间之间提供了良好的平衡。

对于单表操作，确保使用索引应该相对简单：

```
MyTable.find_by_key_column('ABC123') 
```

例如，应该生成这样的东西（检查 development.log）：

```
SELECT * FROM my_table WHERE (key_column = 'ABC123') 
```

即使是 MySQL 相对不起眼​​的优化器，在优化运行时也应该没有问题。

行存储不应该是单个行检索的问题，这是幸运的，因为无论如何您都无法控制它。对于 MySQL 性能，您可能应该选择 MyISAM 而不是 InnoDB 作为存储引擎，前提是您对“最佳”的定义不包括“最可靠”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T18:00:59.783

准确存储和检索数据是数据库的工作。你描述你想要什么，它就会交付它。如果您想具体控制它是*如何*进行的，那么数据库不是答案。

# python - Python IDLE子进程错误？

> ID：874757
> 
> 赞同：10
> 
> 时间：2009-05-17T14:42:48.007
> 
> 标签：python, python-3.x, python-idle

> IDLE 的子进程没有建立连接。IDLE 无法启动子进程或个人防火墙软件阻止了连接。

不要认为这已经被问过了——为什么在运行非常简单的程序时偶尔会出现这种情况——然后我必须去任务管理器并停止所有 Pythonw 进程才能让它再次工作？

它似乎随机发生在不同的代码位上——这是我目前正在做的——

```
f = open('money.txt')
currentmoney = float(f.readline())
print(currentmoney, end='')
howmuch = (float(input('How much did you put in or take out?:')))
now = currentmoney + howmuch
print(now)
f.close()
f = open('money.txt', 'w')
f.write(str(now))
f.close() 
```

有时有效，有时无效！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-03-10T10:37:44.520

我收到了同样的错误信息。导致我出现问题的原因是我将其中一个脚本命名为“string.py”。每次我尝试在同一目录中运行带有“string.py”的脚本时，都会发生这种情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T05:06:17.383

您可以使用`idle -n`来避免此类问题（尽管可能会遇到一些其他限制）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T18:26:18.153

我在 2.7.3 中遇到了同样的问题。我发现当我学习如何使用 tkinter 并制作了一个基本程序来打开一个窗口时，我将它命名为 Tkinter.py 并将它放在与我尝试使用 IDLE 运行的程序相同的文件夹中。它总是会编译名为 Tkinter 的程序并生成第二个编译文件。当我尝试运行我的其他程序时，我会收到错误消息。我将我的简单的打开窗口的程序重命名为别的东西并删除了编译的文件。我能够在 IDLE 的情况下运行该文件夹中的每个程序没有问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T15:19:09.340

您可以通过提供一个简短的代码示例来更具体吗？

IDLE 有一些线程问题。所以调试你的问题的第一件事是在你的子进程中打印一些简单的东西。因此，您将看到它是网络还是线程相关的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T16:17:45.113

在 Python 3.0.1 中，我在使用 Ctrl-C 中断之前在 Idle 的 Python Shell 中运行的程序然后尝试运行脚本后遇到了该错误。

同样在 3.0.1 中：假设您打开了两个空闲窗口：一个脚本打开以供编辑，以及空闲的 Python Shell 窗口。我发现如果您关闭 shell 窗口然后立即尝试运行脚本，它会在尝试重新打开 shell 时给出该错误 - 但如果您在两者之间稍等片刻让 Idle 执行任何连接清理，则不会向上它需要做的。

我发现的更糟糕的错误（同样，在 v3.0.1 中——不确定这是否会在 2.x 版本中发生）：我有一个很长的脚本——接近 9k 行——一旦达到一定的大小，就执行“另存为”会导致空闲崩溃。我不确定大小的确切阈值是多少——但在此之前，我还会遇到一些间歇性的“另存为”崩溃，这似乎取决于我还发生了什么——其他空闲窗口​​，shell 中有多少输出也许是窗户——类似的东西。它可能会崩溃，您将丢失未保存的工作。

另外-我通常做的一件事是打开一个临时窗口，在其中剪切和粘贴处于有效性的各个阶段的代码，给自己写注释等-因此不是有效的python脚本，但我有时会保存这些以便我可以来回到他们身边。我有一个这样的文件，每次我尝试打开它时都会导致 Idle 崩溃——而且我第一次丢失了未保存的工作。（仅供参考：包括 PythonWin 2.5.2 在内的其他编辑器打开文件没有问题。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-20T19:06:07.490

简单的。只需剪切所有扩展名为 .py 的文件，将它们粘贴到与 os 路径不同的位置，其中一个文件会导致此类错误。再次运行 IDLE。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T10:34:45.773

如果它看起来像真正的随机行为，那么它可能是一个多 CPU/核心问题。您可以尝试将解释器关联设置为固定的 cpu，看看是否仍然出现此问题。

谷歌搜索类似：imagecfg process affinity 了解更多信息。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-18T16:18:04.853

我有同样的错误。我重新启动了调制解调器，令我惊讶的是，它起作用了！

# .net - .net - 如何使用属性并包含参数？

> ID：874761
> 
> 赞同：0
> 
> 时间：2009-05-17T14:47:18.697
> 
> 标签：.net, vb.net

我正在 VB.Net 中编写一个类库，并且从使用我的库的应用程序中调用的 subs 或多或少具有以下语法：

```
Public Sub LoadDict(ByVal PhoneticType As String, ByVal strDict As String) 
```

其中**PhoneticType**可以是*phonSoundex*、*phonDoubleMetaphone*或*noPhonetic*

我想让应用程序开发人员在编写上述 sub 的调用时可以从列表中选择 PhoneticType（我认为它称为属性参数）。这将使开发人员更容易，因为可以避免拼写错误，并且在使用库时可以避免错误。

我认为这全都与属性有关，但尽管尝试了，我还是没有设法让它发挥作用。

任何可以发布示例的人如何使用属性和包括参数。如果这些论点可以成为强制性的，那就更好了。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T14:51:57.143

如果 PhoneticType 仅限于一小组定义的值，则 Enum 可能是您的最佳选择。

```
Enum PhoneticType
  phonSoundex
  phonDoubleMetaphone
  noPhonetic
End Enum 
```

这将有助于防止您提到的拼写错误，另外，像 Visual Studio 这样的 IDE 将提供智能感知，将开发人员直接带到允许的值列表。

```
Public Sub LoadDict(ByVal pt As PhoneticType, ByVal strDict As String)

...

LoadDict(PhoneticType.noPhonetic, False) 
```

# c# - 这个 IDisposable 实现是否正确？

> ID：874764
> 
> 赞同：1
> 
> 时间：2009-05-17T14:48:50.707
> 
> 标签：c#, .net, dispose, idisposable

我永远记不起实现 IDisposable 接口的所有规则，所以我试图想出一个基类来处理所有这些并使 IDisposable 易于实现。我只是想听听你的意见，如果这个实现是好的，或者你是否看到了我可以改进的地方。这个基类的用户应该从它派生，然后实现两个抽象方法`ReleaseManagedResources()`和`ReleaseUnmanagedResources()`. 所以这里是代码：

```
public abstract class Disposable : IDisposable
{
    private bool _isDisposed;
    private readonly object _disposeLock = new object();

    /// <summary>
    /// called by users of this class to free managed and unmanaged resources
    /// </summary>
    public void Dispose() {
        DisposeManagedAndUnmanagedResources();
    }

    /// <summary>
    /// finalizer is called by garbage collector to free unmanaged resources
    /// </summary>
    ~Disposable() { //finalizer of derived class will automatically call it's base finalizer
        DisposeUnmanagedResources();
    }

    private void DisposeManagedAndUnmanagedResources() {
        lock (_disposeLock) //make thread-safe
            if (!_isDisposed) { //make sure only called once
                try { //suppress exceptions
                    ReleaseManagedResources();
                    ReleaseUnmanagedResources();
                }
                finally {
                    GC.SuppressFinalize(this); //remove from finalization queue since cleaup already done, so it's not necessary the garbage collector to call Finalize() anymore
                    _isDisposed = true;
                }
            }
    }

    private void DisposeUnmanagedResources() {
        lock (_disposeLock) //make thread-safe since at least the finalizer runs in a different thread
            if (!_isDisposed) { //make sure only called once
                try { //suppress exceptions
                    ReleaseUnmanagedResources();
                }
                finally {
                    _isDisposed = true;
                }
            }
    }

    protected abstract void ReleaseManagedResources();
    protected abstract void ReleaseUnmanagedResources();

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T14:57:51.963

我无法真正评论您的代码的正确性，但我怀疑您是否会发现在继承树的基础上拥有 Disposable 类尽可能灵活。当你想从你不拥有的东西继承时，它不会有太大用处。我认为 IDispoasble 被保留为一个接口，因为它可能在许多不同的域中使用。在继承层次结构的底部提供一个具体的实现将是......限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T14:55:48.427

**编辑**是的，我误读了关于分离处置托管和非托管资源的部分（仍然在第一杯咖啡上）。

然而，锁仍然几乎可以肯定是没有必要的。是的，在被动处置期间，代码将在终结器线程上运行，这与它最初运行的线程不同。但是，如果对象以这种方式完成，CLR 已经确定没有对该对象的现有引用并因此收集它。因此，当时没有其他地方可以调用您的处置，因此没有理由锁定。

一些其他风格的评论。

为什么要使方法抽象？通过这样做，您将强制派生类实现处置托管和非托管资源的方法，即使它们没有任何可处置的资源。确实，如果您没有任何东西要处理，那么从此类派生是没有意义的。但我认为只有一个或另一个而不是两者都是相当普遍的。我会让它们变得虚拟与抽象。

您还可以防止双重处置，但您不会警告开发人员他们正在双重处置对象。我意识到 MSDN 文档说双重处置本质上应该是无操作的，但同时在什么情况下这应该是合法的？一般来说，在对象被释放后访问它是个坏主意。双重处置需要重复使用已处置的对象，并且可能是一个错误（如果在主动处置中未抑制最终确定，则可能会发生这种情况，但这也是一个坏主意）。如果我正在实现这个，我会抛出双重处置来警告开发人员他们错误地使用了一个对象（即在它已经被处置之后使用它）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T15:09:02.577

您正在终结器中访问托管对象 _disposeLock。到那时它可能已经被垃圾收集了。不确定这会产生什么影响，因为您仅使用它来锁定。

线程安全似乎有点矫枉过正。我认为您不必担心 GC 线程和应用程序线程之间的争用。

否则它看起来是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T16:31:13.930

如果您担心线程安全，那么我会使用轻量级联锁操作而不是重量级锁：

```
class MyClass: IDispose {
  int disposed = 0;

  public void Dispose()
  {
    Dispose(true);
    GC.SuppressFinalize(this);
  }

  public virtual void Dispose(bool disposing)
  {
     if (0 == Thread.InterlockedCompareExchange(ref disposed, 1, 0))
     {
       if (disposing)
       {
          // release managed resources here
       }
       // release unmanaged resources here
     }
  }

  ~MyClass()
  {
    Dispose(false);
  }
} 
```

# javascript - 通过javascript在同一窗口中加载页面

> ID：874775
> 
> 赞同：2
> 
> 时间：2009-05-17T14:55:46.243
> 
> 标签：javascript, load, webpage

如何通过 javascript 在同一窗口中加载页面？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T14:57:47.767

您设置窗口的位置属性：

```
window.location.href = 'http://www.guffa.com/'; 
```

# documentation - Web 应用程序的软件使用文档工具

> ID：874786
> 
> 赞同：4
> 
> 时间：2009-05-17T15:01:37.230
> 
> 标签：documentation

我们想为 Web 应用程序准备软件使用文档。这主要包含大多数页面中的屏幕截图（以及相关文档）。我们还希望有一个顶部菜单链接，我们可以使用它跳转到相应的页面。

请建议可用于满足上述要求的工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-19T04:06:03.493

如果您使用特定的文档工具编写文档，则输出到 HTML 相对简单。LaTex、markdown（考虑到 Pandoc）、reStructuredText（考虑到 Pandoc 或[Sphinx](http://sphinx.pocoo.org/)）、AsciiDoc（考虑到 DocBook 工具）和 DocBook（考虑到 Docbook 工具——请参阅 Pandoc）。

所有这些格式都可以让您轻松组织文档，然后将它们导出为您认为合适的 HTML（可能通过主要标题，然后围绕文件构建一个简单的包装器）。Sphinx 也可以只输出基于 Web 的文档（参见 Python.org 的文档）。

对于屏幕截图，我建议在您选择的平台上使用独立的应用程序，理想情况下，它可以让您在程序中进行注释。适用于 Mac 的 Skitch、适用于 Windows 的 Jing、Shutter shutter-project.org 或 linux 中的 Jing。

最后，我建议还做截屏视频，因为它们特别有助于展示 Web 应用程序的趣味性/功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-17T20:46:51.970

解释博士非常好。

[http://www.dreexplain.com/](http://www.drexplain.com/)

它将分析您的页面并创建需要标注的控件、按钮等列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-19T04:56:25.797

I don't know what king of language you are writing your code, but in the case of **Java**, you can use [**Maven**](http://maven.apache.org/).

With maven you can use many plugins, like [JavaDoc](http://maven.apache.org/plugins/maven-javadoc-plugin/), [site](http://maven.apache.org/maven-1.x/plugins/site/) that create a site with many informations about your API/software and contains the ***top menu*** that you want.

This is a screenshot of the site that maven generates: [link](http://www.sonatype.com/books/maven-book/reference/figs/web/site_index.png)

I hope these could help!

Cheers

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-17T20:38:54.577

This may be overkill for your project, but I've favored preparing documentation in docbook (xml), since it's fantastically portable/convertable.

To simplify the document creation, you could turn to [http://www.oxygenxml.com/](http://www.oxygenxml.com/), but you can also do the same work in just about any other xml (or even *text*) editor.

Once your document is prepared, it's trivial to generate html (multi-page, or single page), and pdf versions.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T15:08:58.037

我确信那里有一些很棒的工具可以集成使用文档所需的一切，但我会告诉你我使用的是什么！

我使用[wink](http://www.debugmode.com/wink/)来抓取正在使用的应用程序的屏幕截图。当我浏览应用程序时，我倾向于启动它并抓取大量屏幕截图，甚至只是应用程序的一部分。接下来，我在 wink 中编辑项目以删除多余的屏幕截图，重新排序并将鼠标定位在每一帧上。然后我添加突出显示，这通常只是我正在演示的屏幕部分周围的一个不错的框。Wink 允许您使用信息框和箭头覆盖图像，然后我将项目导出为 html 并使用编号的导出 png 图像作为我的文档的基础。

我倾向于将它们拖入 OpenOffice Writer（或您用于排版的任何内容）并用更多信息补充它们 - 即顶部的几段解释用户在做什么以及为什么。

我们使用 acrobat 输出此文档，并提供您的目录正确完成，它可以在 pdf 中插入书签以跳转到相关部分。

我们从 wink 中获得的主要好处是，当事情发生变化时，它可以很容易地重新抓取照片，并且它可以输出到 flash 以提供漂亮、时髦的小功能演示，以便在网络上发布。

# .htaccess - 使用 .htaccess 创建绝对路径的子域

> ID：874790
> 
> 赞同：4
> 
> 时间：2009-05-17T15:05:12.087
> 
> 标签：.htaccess, mod-rewrite, httpd.conf

嘿，我的主人绝对是可怕的。由于某些奇怪的原因，在 cPanel 中创建子域根本不起作用，而且他们的支持热线总是很忙。我想我可以通过使用 .htaccess 来解决这个问题。我确信这并不难，但我对 mod_rewrite 有点陌生，在过去 5 小时内搜索几乎没有成功。情况如下：

/home/user/public_html 自动重定向到[http://www.example.com](http://www.example.com)

由于我在 public_html 中使用 CMS，它已经在 .htaccess 中添加了规则，以将 example.com/ 之后的任何不熟悉的内容重定向到“找不到页面”

/home/user/subdomain 需要重定向到[http://subdomain.example.com](http://subdomain.example.com)

我应该如何创建子域重定向到绝对路径？或者如何在我的 .htaccess 中添加异常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-19T22:00:12.280

我怀疑您能否让您的子域在您的 public_html 文件夹之外运行（尽管我不是服务器管理员）。通常这需要修改 DNS 或调整服务器的配置。您是否尝试过创建子目录并重写对子域的调用？例如，这放置在 public_html 目录中的 .htaccess 中：

```
RewriteCond %{HTTP_HOST} ^subdomain\.example\.com$
RewriteRule (.*) /subdomain/$1 [L] 
```

我不确定这是否可行（从不需要自己测试），但它比尝试将位于 webhost 指定的目录之外的文件作为域文件的位置更有可能起作用。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T15:12:39.120

试试这个规则：

```
RewriteCond %{REQUEST_URI} !^/home/user/
RewriteCond %{HTTP_HOST} !^www\.example\.com$
RewriteCond %{HTTP_HOST} ^([^/.]+)\.example\.com$
RewriteRule ^ /home/user/%1%{REQUEST_URI} [L] 
```

但是您的网络服务器已经需要进行配置，以便将每个请求重定向到这个特定的虚拟主机。*`foobar`*`.example.com`

# c# - ASP.NET MVC 列出所有用户

> ID：874791
> 
> 赞同：15
> 
> 时间：2009-05-17T15:05:50.667
> 
> 标签：c#, asp.net-mvc, asp.net-membership

我正在尝试显示所有用户的列表，但不确定如何使用 MVC 模型进行此操作。

我可以通过该方法获取所有用户的列表，`Membership.GetAllUsers()`但是如果我尝试将其传递给视图`ActionResult`，我被告知模型不可枚举。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-17T15:17:10.950

您必须将视图设置为接受 MembershipUserCollection 类型的对象

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<MembershipUserCollection>" %> 
```

在你的行动中：

```
 public ActionResult GetUsers()
        {
            var users = Membership.GetAllUsers();
            return View(users);
        } 
```

然后你可以在你的视图中写下类似的内容：

```
 <ul>
       <%foreach (MembershipUser user in Model){ %>

       <li><%=user.UserName %></li>

       <% }%>
</ul> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T15:12:54.563

在您的视图页面中，您需要在顶部设置视图页面的类型。IE：

在您的视图顶部，在标记的第一行，您会看到如下内容：

```
Inherits="System.Web.Mvc.ViewPage" 
```

将其更改为：

```
Inherits="System.Web.Mvc.ViewPage<MembershipUserCollection>" 
```

或您尝试传递给视图的任何类型。“模型”对象现在将是 MembershipUserCollection 类型，您可以安全地对其进行迭代。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T15:12:11.027

[编辑] 具体来说，视图是什么样的（例如，它期望作为模型得到什么，您如何解析集合等）

你能发布一些代码吗？我正在做类似的事情，但没有问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T15:17:47.300

听起来您需要使视图成为强类型视图。让你的观点来自`ViewPage<MembershipUserCollection>` 而不是仅仅来自`ViewPage`. 另一种解决方案是在您的视图中将您的模型转换为 MembershipUserCollection：

```
<% var members = (MembershipUserCollection) ViewData.Model %>
<% foreach (MembershipUser user in members) { %>
       <%-- Do Stuff with the user --%>
<% } %> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-23T15:13:43.237

尝试 asp.net 应用程序对象

```
 string id = Session.SessionID.ToString();
        String[] users = new String[1000];
        users = (string[])Application["users"];
        int count=0;
        for (int d=0;1000 >d ;d++ )
        {
            if (users == null) { users = new String[1000]; }
            count = d;
            if (users[d] == null) { break; }
        }
        users[count] = id;
        Application["users"] = users;
        string[] usersTable = (string[])Application["users"];
        for (int d=0;1000 >d ;d++ )
        {
            if (usersTable[d] == null) { break; }
        Label1.Text += usersTable[d].ToString()+" | "; 
```

添加到应用程序对象代码

```
 Application["users"] = users; 
```

从应用程序对象中检索

```
 string[] usersTable = (string[])Application["users"]; 
```

这会帮助你

# c# - 在gridview中使用IN子句的自定义sql参数 - C#

> ID：874793
> 
> 赞同：0
> 
> 时间：2009-05-17T15:08:49.007
> 
> 标签：c#, sql

当我放置以下 SQL 查询时，

```
SELECT
   [ItemID], [Name], [RelDate], [Price], [Status] 
FROM 
   [item_k] 
WHERE 
   [ItemID] IN (" + itemIDs + ") 
```

在 gridview 自定义 sql 语句中，它被转换为，

```
SELECT 
   ItemID, Name, RelDate, Price, Status   
FROM 
   item_k 
WHERE 
   (ItemID IN ([ + itemIDs + ])) 
```

当我执行查询时，会显示以下错误

```
SQL Execution Error
Invalid column name '+ itemIDs+' 
```

似乎是什么问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T15:21:14.950

您是否尝试过将 + itemIDs+ 放在单引号中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T15:21:26.777

您的字符串 concat 方法的问题在于它可能会使您容易受到 SQL 注入的攻击。我不会尝试修复这种方法，而是选择不需要字符串连接的参数化查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T16:03:40.170

```
SELECT [ItemID], [Name], [RelDate], [Price], [Status] FROM [item_k] WHERE [ItemID] IN (' + itemIDs + ') 
```

将 " 更改为 ' 并且它起作用了！

# c# - WPF 数据绑定到外部数据模型

> ID：874809
> 
> 赞同：1
> 
> 时间：2009-05-17T15:17:22.447
> 
> 标签：c#, wpf, data-binding

我最近开始使用 WPF 开发一个应用程序，但我无法真正考虑以下事情：

我有我的应用程序的域模型，它是简单的 POCO 对象序列化到/从硬盘。然后我有 WPF 应用程序，我想将它绑定到模型的各个部分。我需要能够通知 UI 对底层模型的更改（例如，实现 INotifyPropertyChanged）但我想在不干扰我的模型的情况下做到这一点（在不修改模型当前实现的情况下读取）。除了修改模型之外，我如何实现更改通知？我想这样做的原因是我在多个项目之间共享模型，只有一个是 WPF，我不想在模型中添加不必要的代码。我想到的一件事是创建模型的“副本”（使用 INotifyPropertyChanges 和 BindingLists 等），但这似乎很难维护......在此先感谢。

翁德雷

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T15:45:30.607

看看这个[MVVM](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

下载其源代码查看层次结构。

基本上，您仍然保留简单的 POCO 对象作为模型。然后围绕模型创建一个 ViewModel，如下所示：

```
public class CustomerViewModel : INotifyPropertyChanged
{
        readonly Customer _customer;
        public CustomerViewModel(Customer customer)
        {
            _customer = customer;
        }

        public string FirstName
        {
            get { return _customer.FirstName; }
            set
            {
                if (value == _customer.FirstName)
                    return;

                _customer.FirstName = value;

                OnPropertyChanged("FirstName");
            }
        }
        ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T15:44:18.840

我在这里看到两种可能的解决方案：

1.  仅对 WPF 屏幕使用单独的模型（[MVVM 模式](http://www.orbifold.net/default/?p=550)）。这将需要维护两个不同的模型，还需要准备大量的映射代码。
2.  使用 PostSharp 通过所有必要的样板代码“增强”您的模型。[在这里](http://thetreeknowseverything.net/2009/01/21/auto-implement-inotifypropertychanged-with-aspects/)您可以找到自动 INotifyPropertyChanged 实现的示例。请记住，将 PostSharp 引入项目是一个重要的决定，所以我建议先熟悉它。

# flash - Flash/As3 - 改变 focusRect 的颜色

> ID：874811
> 
> 赞同：1
> 
> 时间：2009-05-17T15:18:12.477
> 
> 标签：flash, actionscript-3, focusrect

应该很简单吧？但还没有找到任何答案:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T16:08:44.403

嗯..不太确定flash，但是在flex中，对于UIComponents，您可以使用myComponent.setStyle("focusRectSkin", mySkin); 更改颜色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T17:48:02.767

更改 focusrect 的颜色是 AFAIK 从未出现在任何桌面 Flash 播放器中的一项功能。从 v2.0 开始，它只能在 Flash Lite 播放器（用于手机）中实现。

您在 AS3 中所能做的就是[将其隐藏](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/display/Stage.html#stageFocusRect)并以您喜欢的任何颜色绘制您自己的矩形（或使用为您执行此操作的组件）。

# python - 如何从 python (2.5) 中的 subprocess.Popen 获取“实时”信息

> ID：874815
> 
> 赞同：47
> 
> 时间：2009-05-17T15:20:29.647
> 
> 标签：python, subprocess, stdout, popen

我想通过以下方式使用 subprocess 模块：

1.  创建一个可能需要很长时间才能执行的新进程。
2.  捕获`stdout`（或`stderr`，或可能两者，一起或单独）
3.  处理来自子进程的数据**，**可能会在接收到的每一行上触发事件（在 wxPython 中说），或者现在只是将它们打印出来。

我已经使用 Popen 创建了进程，但是如果我使用communicate()，一旦进程终止，数据就会立即出现。

如果我创建一个单独的线程来阻止`readline()`（`myprocess.stdout`使用`stdout = subprocess.PIPE`）我也不会使用此方法获得任何行，直到进程终止。（无论我设置为 bufsize ）

有没有办法解决这个问题，并且在多个平台上运行良好？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T19:16:53.203

使用似乎不起作用的代码进行更新（无论如何在 Windows 上）

```
class ThreadWorker(threading.Thread):
    def __init__(self, callable, *args, **kwargs):
        super(ThreadWorker, self).__init__()
        self.callable = callable
        self.args = args
        self.kwargs = kwargs
        self.setDaemon(True)

    def run(self):
        try:
            self.callable(*self.args, **self.kwargs)
        except wx.PyDeadObjectError:
            pass
        except Exception, e:
            print e

if __name__ == "__main__":
    import os
    from subprocess import Popen, PIPE

    def worker(pipe):
        while True:
            line = pipe.readline()
            if line == '': break
            else: print line

    proc = Popen("python subprocess_test.py", shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE)

    stdout_worker = ThreadWorker(worker, proc.stdout)
    stderr_worker = ThreadWorker(worker, proc.stderr)
    stdout_worker.start()
    stderr_worker.start()
    while True: pass 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-17T15:51:49.717

stdout 将被缓冲 - 因此在该缓冲区被填满或子进程退出之前，您将不会得到任何东西。

您可以尝试`stdout`从子进程中刷新，或使用标准错误，或在非缓冲模式下更改标准输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T15:53:38.610

听起来问题可能是子进程使用缓冲输出 - 如果创建了相对少量的输出，它可以被缓冲直到子进程退出。一些背景可以在[这里](http://www.pixelbeat.org/programming/stdio_buffering/)找到：

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-22T10:06:00.163

这对我有用：

```
cmd = ["./tester_script.bash"]
p = subprocess.Popen( cmd, shell=False, stdout=subprocess.PIPE, stderr=subprocess.PIPE )
while p.poll() is None:
    out = p.stdout.readline()
    do_something_with( out, err ) 
```

在您的情况下，您可以尝试将对子进程的引用传递给您的工作线程，并在线程内进行轮询。我不知道当两个线程轮询（并与之交互）同一个子进程时它会如何表现，但它可能会起作用。

另请注意，这是按原样`while p.poll() is None:`设计的。不要**用**`while not p.poll()`as in python替换它`0`（成功终止的返回码）也被考虑`False`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-18T15:42:43.557

使用 pexpect [ [http://www.noah.org/wiki/Pexpect]](http://www.noah.org/wiki/Pexpect])和非阻塞 readlines 将解决这个问题。它源于管道被缓冲的事实，因此您的应用程序的输出被管道缓冲，因此在缓冲区填满或进程终止之前您无法获得该输出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-21T23:02:35.527

一次读取一个字符：http: [//blog.thelinuxkid.com/2013/06/get-python-subprocess-output-without.html](http://blog.thelinuxkid.com/2013/06/get-python-subprocess-output-without.html)

```
import contextlib
import subprocess

# Unix, Windows and old Macintosh end-of-line
newlines = ['\n', '\r\n', '\r']
def unbuffered(proc, stream='stdout'):
    stream = getattr(proc, stream)
    with contextlib.closing(stream):
        while True:
            out = []
            last = stream.read(1)
            # Don't loop forever
            if last == '' and proc.poll() is not None:
                break
            while last not in newlines:
                # Don't loop forever
                if last == '' and proc.poll() is not None:
                    break
                out.append(last)
                last = stream.read(1)
            out = ''.join(out)
            yield out

def example():
    cmd = ['ls', '-l', '/']
    proc = subprocess.Popen(
        cmd,
        stdout=subprocess.PIPE,
        stderr=subprocess.STDOUT,
        # Make all end-of-lines '\n'
        universal_newlines=True,
    )
    for line in unbuffered(proc):
        print line

example() 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-29T07:39:02.090

这似乎是众所周知的 Python 限制，请参阅 [PEP 3145](http://www.python.org/dev/peps/pep-3145/ "政治人物 3145")和其他可能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-24T17:37:13.897

我也遇到过这个问题。出现问题是因为您也尝试读取 stderr。如果没有错误，则尝试从 stderr 读取会阻塞。

在 Windows 上，没有简单的方法来 poll() 文件描述符（只有 Winsock 套接字）。

所以一个解决方案是不要尝试从标准错误中读取。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-04T19:05:36.527

使用 subprocess.Popen，我可以运行我的 C# 项目之一的 .exe 并将输出重定向到我的 Python 文件。我现在可以将`print()`所有信息输出到 C# 控制台（使用`Console.WriteLine()`）到 Python 控制台。

Python代码：

```
from subprocess import Popen, PIPE, STDOUT

p = Popen('ConsoleDataImporter.exe', stdout = PIPE, stderr = STDOUT, shell = True)

while True:
    line = p.stdout.readline()
    print(line)
    if not line:
        break 
```

这会在创建时逐行获取我的 .NET 项目的控制台输出，并在项目终止时脱离封闭的 while 循环。我想这也适用于两个 python 文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-21T18:51:59.427

我已经为此使用了 pexpect 模块，它似乎工作正常。[http://sourceforge.net/projects/pexpect/](http://sourceforge.net/projects/pexpect/)

# c++ - Windows Mobile 上的连续 VirtualAlloc 行为

> ID：874824
> 
> 赞同：2
> 
> 时间：2009-05-17T15:23:40.687
> 
> 标签：c++, windows-mobile, memory-management, windows-ce, virtualalloc

[我一直在优化 Windows Mobile 应用程序的内存性能，并且在 Win32](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366887.aspx)和[Windows CE上的](http://msdn.microsoft.com/en-us/library/ee488564.aspx)**VirtualAlloc** 之间遇到了一些行为差异。

考虑以下测试：

```
// Allocate 64k of memory
BYTE *a = (BYTE*)VirtualAlloc(0,       65536,
                              MEM_RESERVE|MEM_COMMIT, PAGE_READWRITE);
// Allocate a second contiguous 64k of memory
BYTE *b = (BYTE*)VirtualAlloc(a+65536, 65536,
                              MEM_RESERVE|MEM_COMMIT, PAGE_READWRITE);

BYTE *c = a + 65528; // Set a pointer near the end of the first allocation
BOOL valid1 = !IsBadWritePtr(c, 8); // Expect TRUE
BOOL valid2 = !IsBadWritePtr(c+8, 4088); // Expect TRUE
BOOL valid3 = !IsBadWritePtr(c, 4096); // TRUE on Win32, FALSE on WinCE 
```

代码“分配”从“c”开始的 4096 数据。在 Win32 上这有效。**我在VirtualAlloc**文档中找不到任何提及它是合法的还是巧合的，但是我通过谷歌找到了许多期望这种行为的代码示例。

在 Windows CE 5.0/5.2 上，如果我使用“c”处的内存块，在 99% 的情况下没有问题，但是在某些（不是全部）Windows Mobile 6 设备上，**ReadFile**和**WriteFile**将失败并出现错误 87（参数是不正确的。）。我假设**ReadFile**正在调用**IsBadWritePtr**或类似名称，并因此返回 false。如果我执行两个**ReadFile**调用，那么一切正常。（当然可能还有其他 API 调用也会失败。）

我正在寻找一种方法来扩展**VirtualAlloc**返回的内存，以便我可以完成上述工作。在 Windows CE 上保留大量内存是有问题的，因为每个进程仅获得 32MB，并且由于正在加载其他项目，因此不可能在不引起其他问题的情况下保留大量内存。（可以在共享区域中保留更多的内存，但这也有其他问题。）

有没有办法让**VirtualAlloc**扩大或合并区域而不预先保留它？

鉴于以下示例，我怀疑这可能会出现问题：

```
HANDLE hHeap1 = HeapCreate(0, 0, 0); // Heap defaults to 192k
BYTE * a1 = (BYTE*)HeapAlloc(hHeap1, 0, 64000); // +96 bytes from start of heap
BYTE * b1 = (BYTE*)HeapAlloc(hHeap1, 0, 64000); // +16 bytes from end of a1
BYTE * c1 = (BYTE*)HeapAlloc(hHeap1, 0, 64000); // +16 bytes from end of b1
BYTE * d1 = (BYTE*)HeapAlloc(hHeap1, 0, 64000); // +4528 bytes from end of c1

HANDLE hHeap2 = HeapCreate(0, 4*1024*1024, 4*1024*1024); // 4MB Heap
BYTE * a2 = (BYTE*)HeapAlloc(hHeap2, 0, 64000); // +96 bytes from start of heap
BYTE * b2 = (BYTE*)HeapAlloc(hHeap2, 0, 64000); // +16 bytes from end of a2
BYTE * c2 = (BYTE*)HeapAlloc(hHeap2, 0, 64000); // +16 bytes from end of b2
BYTE * d2 = (BYTE*)HeapAlloc(hHeap2, 0, 64000); // +16 bytes from end of c2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T23:11:49.827

我不相信 IsBadWritePtr，请参阅：http: [//support.microsoft.com/kb/960154](http://support.microsoft.com/kb/960154) 我认为它会尝试写入内存，并查看它是否出现硬件异常。它处理异常，然后返回 true 或 false。但是，我听说某些硬件在尝试写入一页或类似的东西时只会引发一次异常。

如果没有 MEM_COMMIT，您是否无法使用 VirtualAlloc，所以您只需保留虚拟内存地址。然后当你真正想要使用内存时，再次调用 VirtualAlloc 来进行提交。由于您已经保留了页面，因此您应该能够连续提交它们。

你说你想在没有预先保留的情况下这样做。但是，提前预订有什么问题。保留实际上并不使用任何物理内存，它保留了一系列虚拟地址，它只会在您提交页面时使用物理内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-25T16:16:21.407

不，这是不可能的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T19:35:59.890

喔好吧。在那种情况下，您是否听说过大内存区域，我认为这是 Microsoft 针对您的问题的解决方法/解决方案。

基本上，如果您的 VirtualAlloc 超过 2 兆，它会进入虚拟内存的大内存区域，这会让您超过 32mb 的限制。

这里有一个很好的讨论它是如何工作的：http:
[//msdn.microsoft.com/en-us/library/ms836325.aspx](http://msdn.microsoft.com/en-us/library/ms836325.aspx)

我自己在以前的产品上使用过它，它对我有用。

# visual-studio - 有什么方法可以在 Visual Studio 2008 中定义多个视图配置？

> ID：874828
> 
> 赞同：1
> 
> 时间：2009-05-17T15:25:36.967
> 
> 标签：visual-studio, visual-studio-2008, visual-c++, visual-studio-2005

有没有办法在 Visual Studio 2008 中定义 IDE 布局？

可以说，当我在 C# 中编码时，我禁用了属性窗口和底部的输出窗口。现在让我们说，当我在一个窗口的可视化编辑器中时，我希望左侧的工具和属性窗口和输出窗口被禁用。

问题是，如果我想以这种方式工作，每次从代码编辑切换到可视化编辑时，我都必须手动重新排列 IDE 布局。

我想有一个选项来定义几个 IDE 布局并为每个布局分配一个热键。所以我可以在布局之间快速切换。

Visual Studio 2008 中有这样的功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T15:42:35.327

Visual Studio 有布局的概念，但它们会根据当前模式（设计、调试等）自动应用。您可以创建 IDE 宏来显示/隐藏您的工具窗口：

启用属性：

```
子属性On()
    DTE.ExecuteCommand ("View.PropertiesWindow")
结束子

```

禁用属性：

```
子属性Off()
    DTE.Windows.Item(Constants.vsWindowKindProperties).Close
结束子

```

您可以使用宏记录器 (Ctrl+Shift+R) 查看显示或隐藏其他工具窗口所需的命令。构建宏（使用宏 IDE - Alt+F11 或工具 | 宏 | 宏 IDE）以启用/禁用工具窗口组。然后，您可以将宏绑定到您自己的键绑定或简单地从命令窗口调用它们。或者，您可以使用宏资源管理器（Alt+F8 或工具 | 宏 | 宏资源管理器）执行宏。

# iphone - iPhone 上的最佳 SQLite 实践

> ID：874830
> 
> 赞同：9
> 
> 时间：2009-05-17T15:27:51.067
> 
> 标签：iphone, objective-c, cocoa-touch, sqlite

在 iPhone 上广泛使用 SQLite 时要记住哪些最佳实践？提示/技巧/便利因素都受到赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-17T15:50:56.687

我可以推荐使用[FMDB](https://github.com/ccgus/fmdb)作为一个不错的 Cocoa SQLite 包装器。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-17T20:27:52.867

测量您的应用程序的内存占用并查找 Instruments 中的泄漏。然后在调用 sqlite3_exec 后尝试：

*   `pragma cache_size=1`

和/或

*   `pragma synchronous=0`

YMMV。有关于性能提升、RAM 使用量大幅减少和泄漏减少的报告。但是，在不了解影响的情况下进行调整时要小心（例如，`synchronous`关闭刷新会大大加快速度，但如果手机在错误的时间重启，可能会导致数据库损坏）。

更多信息：[http ://www.sqlite.org/pragma.html](http://www.sqlite.org/pragma.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-17T16:24:23.290

在我的头顶上：

*   使用事务。
*   确保您的 SQL 以[正确的顺序](http://www.sqlite.org/cvstrac/wiki?p=PerformanceTuning)利用表。
*   不要添加您不完全确定需要的索引。

也许不仅针对 iPhone，而且针对嵌入式设备，这里有一些很棒的[技巧](http://katastrophos.net/andre/blog/2007/01/04/sqlite-performance-tuning-and-optimization-on-embedded-systems/)。

此[链接](http://web.utk.edu/~jplyon/sqlite/SQLite_optimization_FAQ.html)适用于旧版本的 SQLite，但仍然有用。

最后这个[堆栈问题](https://stackoverflow.com/questions/323739/native-iphone-database-all-data-on-iphone)也有一些很好的信息。

我们目前将 SQLite 与 .Net Compact Framework 应用程序一起使用，它的性能非常好，我们花了一些时间进行优化，但没有尽可能多地进行优化。

祝你好运。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T03:39:07.567

我发现在复杂查询中获取我正在寻找的 ID，然后按需获取其余信息通常更快。

例如：

```
SELECT person_id
  FROM persons
 WHERE (complex where clause) 
```

然后当每个人都被展示出来时，我会跑

```
SELECT first_name, last_name, birth_date, ...
  FROM persons
 WHERE person_id = @person_id 
```

我通常发现这会使复杂查询以 1/2 的时间运行，并且对给定人的查找通常在 2ms 左右（这是在具有 17k 行的表上）。

您的经验可能会有所不同，您应该自己安排时间。

另外，我必须感谢 Wil Shipley 在他的演讲中提出了这种技术：http: [//www.vimeo.com/4421498](http://www.vimeo.com/4421498)。

我实际上广泛使用了 sqlitebooks 中的水合/脱水模式，这是该技术的超集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-28T07:26:05.503

我比较懒，喜欢尽可能的坚持核心代码，所以喜欢ORM工具SQLitePersistentObjects：

[http://code.google.com/p/sqlitepersistentobjects/](http://code.google.com/p/sqlitepersistentobjects/)

你让你的域模型对象继承自 SQLitePersistentObject （好吧有点侵入性），然后你可以根据需要持久化/检索你的对象。

坚持：

```
[person save]; 
```

将其重新加载几乎同样容易。任何可持久对象都会添加动态类方法以允许您进行搜索。因此，我们可以检索所有姓氏为“Smith”的 Person 对象，如下所示：

```
NSArray *people = [PersistablePerson findByLastName:@"Smith"]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T07:30:59.067

我还没有尝试过的另一个选项是[Core Data](http://developer.apple.com/iphone/prerelease/library/documentation/DataManagement/Conceptual/iPhoneCoreData01/Introduction/Introduction.html)（需要是 Apple iphone 开发人员），虽然它是 3.0 功能，所以这取决于你的应用程序是否是一个选项..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-27T04:39:48.800

PLDatabase 是 FMDB 的替代品：[http ://code.google.com/p/pldatabase/](http://code.google.com/p/pldatabase/)

我在我的一个项目中使用它没有问题。

# data-structures - 爬山和单对最短路径算法

> ID：874838
> 
> 赞同：4
> 
> 时间：2009-05-17T15:31:24.927
> 
> 标签：data-structures, artificial-intelligence, graph, hill-climbing

我有一个奇怪的问题。谁能告诉我在哪里可以找到有关的信息，或者给我一些关于使用使用爬山方法的最短路径算法的介绍？我了解两者的基础知识，但我无法将两者放在一起。Wikipedia 有一个有趣的部分是关于通过爬山解决旅行销售人员的问题，但没有提供更深入的解释来说明如何准确地解决这个问题。

> 例如，爬山可以应用于旅行商问题。很容易找到访问所有城市的解决方案，但与最佳解决方案相比会很差。该算法从这样一个解决方案开始，并对其进行了一些小改进，例如切换访问两个城市的顺序。最终，获得了更好的路线。

据我了解，您应该选择任何路径，然后遍历它并在此过程中进行优化。例如，返回并从起始节点选择不同的链接并检查是否提供了更短的路径。

对不起-我没有说得很清楚。我了解如何将这个想法应用于旅行推销员。我想在最短距离算法上使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T15:56:02.310

你可以随机交换两个城市。

您的第一条路径是：长度为 200 的 ABCDEFA

现在您通过交换长度为 350 的 C 和 D: ABDCEFA 来更改它 - 更糟！

下一步：ABCDFEA：长度 150 - 您改进了解决方案。;-)

爬山算法真的很容易实现，但是局部最大值有几个问题！[基于相同想法的更好方法是[模拟退火](http://en.wikipedia.org/wiki/Simulated_annealing)。]

爬山是一种非常简单的进化优化，更复杂的算法类是[遗传算法](http://en.wikipedia.org/wiki/Genetic_algorithm)。

解决 TSP 的另一个很好的元启发式方法是[蚁群优化](http://www.ameisenalgorithmus.de/appletantstour.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T16:08:51.953

示例是数据聚类中的**遗传算法**或**期望最大化**。通过单个步骤的迭代，它试图在每一步中找到更好的解决方案。问题是它只找到一个局部最大值/最小值，它永远不能保证它找到全局最大值/最小值。

作为我们需要的**遗传算法**的旅行商问题的解决方案：

*   **将解决方案表示**为访问城市的顺序，例如 [纽约、芝加哥、丹佛、盐湖城、旧金山]
*   **健身功能**作为行进距离
*   **最佳结果的选择**是通过根据其适应度随机选择项目来完成的，适应度越高，选择解决方案生存的概率就越高
*   **突变**将切换到列表中的城市，例如 [A,B,C,D] 变为 [A,C,B,D]
*   **两个可能的解决方案 [B,A,C,D] 和 [A,B,D,C] 的交叉**导致 [B,A,D,C]，即在中间切割两个列表并使用一个父级的开头和另一个父母的结束形成孩子

那么算法：

*   初始解决方案集的初始化
*   计算每个解的适应度
*   直到期望的最大适应度或直到不再发生变化
    *   选择最佳解决方案
    *   交叉和突变
    *   每个解的适应度计算

算法的每次执行结果都可能不同，因此它应该执行一次以上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-15T19:38:15.603

我不确定你为什么要使用爬山算法，因为 Djikstra 的算法是多项式复杂度 O( | E | + | V | log | V | ) 使用斐波那契队列： [http ://en.wikipedia.org /wiki/Dijkstra](http://en.wikipedia.org/wiki/Dijkstra)的算法

如果您正在寻找单路径问题的启发式方法，那么您可以使用 A*： [http](http://en.wikipedia.org/wiki/A) ://en.wikipedia.org/wiki/A *_search_algorithm

但是效率的提高取决于对目标距离的可接受的启发式估计。 [http://en.wikipedia.org/wiki/A](http://en.wikipedia.org/wiki/A) *_search_algorithm

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T16:23:42.403

要爬上 TSP，您应该有一条起始路线。当然，选择“智能”路线不会受到伤害。

从那条起始路线开始，您进行一项更改并比较结果。高了就保留新的，低了就保留旧的。重复此操作，直到您到达无法再攀爬的点，这将成为您的最佳结果。

显然，使用 TSP，您很可能会达到局部最大值。但有可能获得不错的结果。

# c# - XML 祖先需要

> ID：874842
> 
> 赞同：0
> 
> 时间：2009-05-17T15:34:58.837
> 
> 标签：c#, asp.net

在 C# 中，我需要得到

```
currentnode.parentnode.parentnode.parentnode.firstchild.lastchild.lastchild 
```

我正在使用生成 MLM 树的一些标签，这些标签代表第四级的单个节点过载，所以我试图获取这些节点并将它们分开。

我是 XML 新手，希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-17T16:41:16.613

如果您有要处理的当前节点，则 XmlNode 定义了 ParentNode FirstChild 和 LastNode 属性，您可以使用它来执行此操作，[请参阅](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode_members(VS.71).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T16:43:40.763

考虑使用 XQuery 或 XPath 来对 XML 树执行查询。[这里](http://www.codeproject.com/KB/cpp/myXPath.aspx)有一个很好的教程，展示了所有常见的选项。

# algorithm - 将圆插入 2D 平面的快速碰撞检测

> ID：874843
> 
> 赞同：3
> 
> 时间：2009-05-17T15:35:03.237
> 
> 标签：algorithm, collision-detection

我知道有很多关于碰撞检测的帖子，通常是针对在 2D 平面上移动的精灵，但我的问题略有不同。

我正在将圆圈插入 2D 平面。这些圆具有可变半径。我正在尝试优化我在平面内找到一个随机位置的方法，我可以在其中插入一个新圆圈，而不会与飞机上已经存在的任何其他圆圈发生碰撞。现在我正在使用一种非常“未优化”的方法，它只是在平面内生成一个随机点，然后将其与平面上的所有其他圆圈进行检查。

有没有办法优化这个？对于这个特定的应用程序，平面的边界一次只能容纳 20-25 个圆圈，通常存在 5-10 个。如您所料，当圆圈数接近可以容纳的最大值时，您必须测试许多点才能找到一个有效的点。它变得非常缓慢。

注意：safeDistance 是我要添加到平面的圆的半径。

这是代码：

```
- (CGPoint)getSafePosition:(float)safeDistance {
// Point must be far enough from edges
// Point must be far enough from other sprites

CGPoint thePoint;
BOOL pointIsSafe = NO;

int sd = ceil(safeDistance);

while(!pointIsSafe) {

    self.pointsTested++; // DEBUG

    // generate a random point inside the plane boundaries to test
    thePoint = CGPointMake((arc4random() % ((int)self.manager.gameView.frame.size.width - sd*2)) + sd, 
                           (arc4random() % ((int)self.manager.gameView.frame.size.height - sd*2)) + sd);

    if(self.manager.gameView.sprites.count > 0) {
        for(BasicSprite *theSprite in self.manager.gameView.sprites) {

            // get distance between test point and the sprite position
            float distance = [BasicSprite distanceBetweenPoints:thePoint b:theSprite.position];

            // check if distance is less than the sum of the min safe distances of the two entities
            if(distance < (safeDistance + [theSprite minSafeDistance])) {
                // point not safe
                pointIsSafe = NO;
                break;
            }

            // if we get here, the point did not collide with the last tested point
            pointIsSafe = YES;
        }
    }
    else {
        pointIsSafe = YES;
    }
}

return thePoint;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T16:59:34.623

`w`按`h`块细分您的窗口。您将维护一个`w`按`h`数组，`dist`. `dist[x][y]`包含可以以 (x, y) 为中心的最大圆的大小。（您可以将像素用作块，尽管我们将在放置每个圆圈时更新整个数组，因此您可能希望选择更大的块以提高速度，但会稍微降低包装密度。）

## 初始化

最初，将所有设置`dist[x][y]`为`min(x, y, w - x, h - y)`。这对作为窗口的边界框给出的限制进行编码。

## 更新程序

每次向窗口添加一个圆时，比如说一个位于`(a, b)`radius 的圆，您*都*`r`需要更新.*`dist`*

 *每个职位所需的更新`(x, y)`是：

```
dist[x][y] = min(dist[x][y], sqrt((x - a)^2 + (y - b)^2) - r); 
```

（显然，`^2`这里的意思是平方，而不是 XOR。）基本上，我们是在说：“将 dist[x][y] 设置为到刚刚放置的圆的最小距离，除非情况已经比这更糟了。” `dist`刚刚放置的圆圈内的点的值将是负数，但这没关系。

## 寻找下一个位置

然后，当您想插入下一个半径圆时`q`，只需扫描`dist`查找`dist`值 >=的位置`q`。（如果要随机选择这样的位置，请找到有效位置的完整列表，然后随机选择一个。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T15:56:40.940

[老实说，只有 20-25 个圆圈，通过使用更高级的算法或数据结构（例如四叉树](http://en.wikipedia.org/wiki/Quadtree)或[kd-tree](http://en.wikipedia.org/wiki/Kd_tree)） ，您不会获得太多的速度提升。[对于小 n 来说，一切都很快](http://www.codinghorror.com/blog/archives/000957.html)。

您确定这是您的应用程序的瓶颈吗？你有简介吗？如果是，那么您要加快速度的方法是通过微优化，而不是通过高级算法。您是否因为大部分飞机不安全而通过 while 循环进行大量迭代？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-11T06:06:43.080

只是一个大纲，因为这个解决方案相当复杂。

如果您想保证在可能的情况下总能找到放置圆圈的地方，您可以执行以下操作。考虑每个现有的圆 C。我们将尝试找到一个可以放置新圆的位置，使其与 C 接触。对于每个足够接近 C 的圆 D（除了 C），都会有一系列角度在 C 周围的其中一个角度放置一个新圆将使其与 D 相交。某些几何图形将为您提供该范围。类似地，对于足够接近 C 的四个边界中的每一个，都会有一系列角度，在其中一个角度放置一个新圆将使其与边界相交。如果所有这些区间都覆盖了 C 周围的所有 360 度，那么你不能在 C 附近放置一个圆圈，你将不得不尝试下一个圆圈，直到没有更多候选 C。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T16:07:20.877

您可以将您的平面分割成许多小矩形（与[四叉树](http://en.wikipedia.org/wiki/Quadtree)略微相关）并保存哪些矩形被至少一个圆圈击中。当您寻找插入点时，您只需要寻找一些“空”的（不需要任何随机跳转并且可以在恒定时间内）。

矩形的数量和星座可以通过半径来计算。

# asp.net-mvc - ASP.Net MVC 和会员资格

> ID：874848
> 
> 赞同：1
> 
> 时间：2009-05-17T15:37:25.347
> 
> 标签：asp.net-mvc, asp.net-membership, profiles

我真的很感激一些关于我正在努力实现的反馈：

问题：

1.  我想授权我的应用程序的用户在控制器上执行单个操作。例如：如果用户具有所需的授权，他可以对我的控制器类执行“保存”操作。
2.  在我正在处理的项目中，角色的创建和他们的授权是由客户部署团队完成的，而不是我的控制。因此，我编写了一个可以分配给角色/用户的“控制点”，而我的应用程序只需要检查那个控制点。
3.  如何在 ASP.Net MVC 中获取控制点概念？更具体地说，如何根据控制器上的用户权限启用/禁用视图上的按钮？

我的解决方案：

1.  参考：[http](http://weblogs.asp.net/fredriknormen/archive/2008/03/12/asp-net-mvc-framework-2-interception-and-creating-a-role-action-filter.aspx) ://weblogs.asp.net/fredriknormen/archive/2008/03/12/asp-net-mvc-framework-2-interception-and-creating-a-role-action-filter.aspx - as一个起点
2.  我没有像上面链接中解释的那样创建角色过滤器，而是有一个 ControlPointFilter 类，它可以获取模型并进行授权检查。
3.  我遇到的问题是在 View 类中，我目前正在传递用户在 ViewData[] 集合中可以访问的控制点集合。
4.  在 View 类中，我正在检查 ViewData 集合中是否存在相关的控制点（我不喜欢 - 希望在 View 类中将代码保持在最低限度）
5.  另一个问题是 - 虽然在控制器类的属性中设置了实际的控制点名称，但我在哪里/如何将这些属性传递给视图并保持视图清洁？

希望对您有所帮助并感谢您的时间/努力来回答这个问题！

晴天

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T16:18:54.597

一种可能的解决方案是将控制点转换为控制器操作中的视图属性（也许这些是相同的东西，但从您的问题中并不清楚）。想法是您的控制点将转换为有意义的视图方向，例如“AllowEdit”、“AllowSave”、“AllowDetailedView”等。这些将成为 ViewData 中的条目。

使用基本控制器类来扩展 Controller 并为其提供 ControlPoint 集合。让您的过滤器在控制器中填充此集合。让基本控制器 OnActionExecuted 方法使用此集合，并且在 ViewResult 的情况下，使用视图指令集合的适当值填充 ViewData。各个控制器操作也可以使用 ControlPoint 集合来确定它们是否需要根据视图是否会呈现额外数据来为各个视图提供数据。

在您看来，不依赖于控制点本身，而是依赖于基本控制器确定的视图方向。通过这种方式，您将视图与控制点逻辑分离。视图仅以对视图有意义的方式对视图数据进行操作，而不是对在应用程序上下文中有意义的基于权限的数据进行操作。视图不会关心特定指令的设置方式或原因，它只需要根据指令的值适当地呈现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T15:45:27.110

嗯，你能不能简单地创建一个模板系统来为用户分配角色？即创建具有角色“CustomerService”和“ConfigurationEditor”的用户模板“Power User”，然后像往常一样使用角色系统（即Roles.IsUserInRole(username, rolename)）？

对于操作，然后使用

```
[Authorized(Roles="CustomerService,CustomerServiceAdmin")]
public ActionResult Edit(...)
{
} 
```

对于视图，您使用

```
<% if (Roles.IsUserInRole(Context.User.Name, "CustomerService")) %> 
```

# python - wxPython 在导入子包时两次启动我的应用程序

> ID：874856
> 
> 赞同：0
> 
> 时间：2009-05-17T15:45:07.813
> 
> 标签：python, import, wxpython

我很抱歉口头描述。

我在一个名为的文件中有一个 wxPython 应用程序，该文件`applicationwindow.py`位于一个名为`garlicsimwx`. 当我通过启动上述文件启动应用程序时，一切正常。但是，我`rundemo.py`在包含该`garlicsimwx`程序包的文件夹中创建了一个文件，该程序包也运行该应用程序。但是，当我使用`rundemo.py`时，应用程序会启动，当主程序`wx.Frame`导入 的子包时`garlicsimwx`，即`simulations.life`由于某种原因创建了我的应用程序的一个新实例（即，弹出一个新的相同窗口。）

我已经尝试过一个一个地执行命令，虽然该错误仅在导入子包后发生，但该`import`语句不会直接导致它。只有当控制返回到`PyApp.MainLoop`第二个窗口时才会打开。

我该如何阻止这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T16:05:06.147

我认为您的某个模块中有如下代码：

```
import wx

class MyFrame(wx.Frame):
    def __init__(...):
       ...

frame = MyFrame(...) 
```

首次导入此模块时将创建框架。为了防止这种情况，请使用常见的 Python 习惯用法：

```
import wx

class MyFrame(wx.Frame):
    def __init__(...):
       ...

if __name__ == '__main__':
    frame = MyFrame(...) 
```

我猜对了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T17:26:59.360

您可以创建一个全局布尔变量`g_window_was_drawn`，并在创建窗口的函数中检查它。该值在程序开始时为 false，并在第一次创建窗口时更改为 True。创建窗口的函数会检查 是否`g_window_was_drawn`已经为真，如果是，它会抛出异常。然后你会有一个很好的堆栈跟踪告诉你谁负责执行这个函数。

我希望能帮助你找到它。我很抱歉口头解决方案；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T17:36:17.417

明白了：没有

```
if __name__=='__main__': 
```

在我的`rundemo`档案中。这实际上是一个`multiprocessing`问题：新窗口是在一个单独的进程中打开的。

# asp.net-mvc - 定义要在控制器中加载哪些数据是一种好习惯吗？

> ID：874862
> 
> 赞同：1
> 
> 时间：2009-05-17T15:50:52.303
> 
> 标签：asp.net-mvc

想象一下，您有一个与其他实体有一些关系的实体，并且您只想加载其中一些实体以在不同的视图中显示它们。

例如，给定这个实体：

```
public class Category
{
     public int id;
     public Category child;
     public Category parent;
} 
```

在“ShowChild”视图中，您不想加载“父”属性，因为您没有显示它。

因此，鉴于这种情况，我在我的存储库中实现了一个非常好的“系统”，以从数据库中加载实体，仅填充我想要的属性。它是这样工作的：

类别 category = repo.FindCategory(id, (int)(LoadLevel.basic | LoadLevel.Child))

所以现在我有一个只加载了 id 和 Child 属性的类别实例。

我在这里面临的困境是，如果我在我的 serviceLayer 中定义 LoadLevel（它应该在哪里），我将不得不在我的服务类中编写两个方法，“LoadCategoryWithChild”和“LoadCategoryWithParent”，一个用于每个视图（DRY违反？）。

```
public class CategoryService
{
     public Category LoadCategoryWithChild(int id)
     {
         int loadlevel = (int) (LoadLevel.Basic | LoadLevel.Child);
         return repo.FindCategory(id, loadlevel);
     }
} 
```

或者，我看到的另一个选项是在控制器中定义负载级别（违反 MVC？）并在我的服务类中只实现一个方法：

```
public class CategoryService
{
     public Category LoadCategory(int id, int loadlevel)
     {
         return repo.FindCategory(id, loadlevel);
     }
} 
```

哪个选项会更好？我认为 DRY 违规要严重得多，因为它意味着编写大量冗余代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T22:21:06.323

我绝对更喜欢第二种解决方案。我认为控制器向服务类提示它需要哪些数据不是问题（坦率地说，这与它在第一个解决方案中通过调用函数 A 而不是函数 B 所做的事情相同）。

我会将第二个参数更改为不是 int 而是枚举类型，以便调用者知道有效选项是什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T16:27:56.413

这可能是对象关系映射的第一个问题。大多数 ORM 解决方案通过延迟加载对象属性来解决这个问题，这样您只需要一种满足大多数用例的加载机制。使用附加属性的少数函数可以在通过代理请求视图时透明地从视图中加载所需的内容。

就我个人而言，我不喜欢上述任何一种解决方案，也不是透明代理的第三个解决方案。然而，代理解决方案将更一致地工作，在视图层的微小变化上失败的频率更低，主要影响通常只是一点点性能。当它被证明是一个问题时，你总是可以优化它。

Hibernate 作为一个例子使用了这种方法，尽管你必须告诉它一个属性是否是延迟加载的。在 Hibernate 中通过代理延迟加载也不能在所有情况下延迟加载，因为它需要在事务中。这些限制是出于实际性能的原因。在数据库映射方法中，代理/延迟加载是最容易使用的，但它也有其自身的复杂性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T06:49:08.020

我建议：

```
public Category LoadCategory(int id, params LoadLevel[] levels)
{
    int loadLevel = LoadLevel.Basic;

    foreach (var level in levels)
        loadLevel = loadLevel | level;

    return repo.FindCategory(id, loadlevel);
} 
```

示例用法：

```
LoadCategory(0, LoadLevel.Parent, LoadLevel.Child); // self + parent+ child
LoadCategory(1, LoadLevel.Child); // self + child
LoadCategory(2); // self only 
```

# javascript - jQuery 日期范围选择器在 Google Chrome 中出现错误

> ID：874871
> 
> 赞同：0
> 
> 时间：2009-05-17T15:56:56.697
> 
> 标签：javascript, jquery, google-chrome

我正在使用[灯丝组的 jQuery 日期范围选择器](http://www.filamentgroup.com/lab/date_range_picker_using_jquery_ui_16_and_jquery_ui_css_framework/)。

我的代码是这样的，我正在动态创建一个文本框，或者更确切地说是 AJAX 查询返回表单的 HTML。当我将 HTML 转储到我的页面上时，我调用了一个脚本，该脚本调用了`daterangepicker()`应该将输入框转换为日期范围选择器的函数。

我的代码在 Firefox 和 Internet Explorer 中运行良好，但在 Google Chrome 中却死掉了。该脚本未运行，我在日志中收到此错误：

```
未捕获的错误：INVALID_NODE_TYPE_ERR：DOM 范围异常 2
```

这里可能是什么问题？我真的需要解决这个问题——异常是在核心 jQuery 代码中引发的。当我查看站点演示时，日期选择器似乎工作正常。

您不认为它与被调用以附加到由 AJAX 查询在运行时创建的元素有关。无论我需要什么问题来获得这个工作，并希望得到任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T09:12:59.920

我遇到了同样的问题，Chrome 调试器指出错误在 Jquery 库版本 1.3.2 中

我查看了灯丝 daterangepicker 演示页面的源代码，结果发现他们使用的是 jquery library 1.3.1

... src="js/jquery-1.3.1.min.js"

我使用 1.3.1 而不是 1.3.2 进行了测试，这适用于我的网站。

我建议测试浏览器并在用户使用 chrome 的情况下使用 1.3.1。

万事如意，耶胡达

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T16:37:31.013

有几个人[报告](http://www.filamentgroup.com/lab/update_date_range_picker_with_jquery_ui/)说这个功能在 Chrome 中被破坏了。也许你应该寻找替代品。

# c# - 扩展 ASP.NET DropDownList

> ID：874873
> 
> 赞同：2
> 
> 时间：2009-05-17T15:59:44.017
> 
> 标签：c#, asp.net, controls

我正在尝试创建一个继承自 DropDownList 的自定义控件。

我需要的是向 ListItem（在 Item 集合中）添加一个新属性。

```
<cc1:MyDropDownList ID="MyDropDownList1" runat="server">   
   <asp:ListItem myProperty="true" text="sometext" ... />                     

</cc1: MyDropDownList> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T16:31:07.567

即使您从 DropDownList 继承，您也无法添加此属性，因为您必须将其添加到 ListItem 控件。
但问题是 ListItem 类是密封的，所以你不能从它继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T16:38:04.477

您可以使用 jQuery 扩展客户端的功能吗？

# xna - 在连续二维空间中进行避障的基本寻路

> ID：874875
> 
> 赞同：9
> 
> 时间：2009-05-17T16:03:18.640
> 
> 标签：xna, 2d, collision-detection, path-finding

我正在编写一个模拟，其中一个生物对象应该能够向环境中的其他任意对象移动，在障碍物周围滑动而不是进行任何智能寻路。我不想让它*规划*一条路径——只是朝着一个大方向移动，并绕过障碍物。

这是一个 2D 环境（俯视图），每个对象都有一个用于碰撞检测的边界矩形。没有网格，我不是在寻找 A* 解决方案。

我还没有找到任何关于这种“愚蠢的”基于碰撞的寻路的教程，所以我可能没有使用最常用的术语来描述这一点。

关于如何实现这个（或教程链接）的任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-17T20:33:23.850

Expanding on what Guillaume said about obstacle avoidance, a technique that would work well for you is [anti-gravity movement](http://www.ibm.com/developerworks/java/library/j-antigrav/). You treat local obstacles as point sources of antigravity, the destination as gravity, and your computer controlled character will slip (like soap!) around the obstacles to get to the destination.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-17T20:11:39.237

您可以结合两种转向算法：

*seek*：您在方向上施加转向力，该方向是当前速度与朝向目标的所需速度之间的差值

*避障*：您使用一个长度为常数时间乘以车辆当前速度的框来预测车辆的未来。与此框相交的任何障碍物都是潜在的碰撞威胁。选择最近的这种威胁来避免。为了避开障碍物，向障碍物中心施加横向转向力。此外，施加制动（减速）力。这些力随紧急程度（从盒子尖端到潜在碰撞点的距离）而变化。转向呈线性变化，制动呈二次方变化。

[您可以在“自主角色的转向行为](http://www.red3d.com/cwr/steer/)”网站上找到更多信息

问候

纪尧姆

PS：这假设您正在使用点/速度/加速度方法来进行对象的运动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T16:25:28.440

也许你可以使用[Pledge 的算法](http://en.wikipedia.org/wiki/Maze_solving_algorithm#Pledge_algorithm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T16:32:59.500

每当您的生物在向量方向 移动`v`时与方向由向量表示的墙壁发生碰撞`w`，您需要“滑动”的方向由向量给出，该向量是 on 的`v`投影`w`。这可以使用

```
 v . w
--------- w
 |w|*|w| 
```

其中`.`是[向量点积](http://en.wikipedia.org/wiki/Dot_product)，`|w|`是向量`w`( = `sqrt(w . w)`) 的大小。如果`w`是一个单位向量，这变得简单

```
(v . w) w 
```

使用得到的向量作为你的生物的速度将意味着你的生物在它刚刚“擦过”墙壁时会快速移动，而当它几乎完全撞到墙上时会缓慢移动。（这就是大多数第一人称射击游戏为人类玩家管理碰撞的方式。）

相反，如果您希望您的生物始终全速行进，您只需要标志`v . w`- 您将始终沿墙面对的方向 ( `w`) 或相反的方向 ( `-w`) 行进。

您将遇到的问题是当您的生物完全撞墙时。在这种情况下，您的投影向量将是 (0, 0)，并且您需要一些其他技术来决定走哪条路 (`w`或`-w`)。这里常用的方法是 A*，但如果您的环境具有足够的结构，这可能是不必要的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-17T16:05:49.737

不久前我在 C# 中发布了一个寻路算法

[这是链接](http://www.juanformoso.com.ar/post/2007/10/10/AStar-para-GamingNET.aspx)

您可以尝试将其用作起点，即您可以修改检查下一个单元格的函数以查看检查障碍物是否有效，并且您可以将其输入小间隔而不是起点和终点，有点像多条迷你寻路路线。

（文本为西班牙语，但您可以从顶部的链接下载应用程序）

# html - 如何避免空的清除div？

> ID：874877
> 
> 赞同：4
> 
> 时间：2009-05-17T16:04:07.237
> 
> 标签：html, css, css-float

我最近一直在使用很多这样的花车：

```
<div id="buttons">
  <input type="button" id="btn1" value="Button One">
  <input type="button" id="btn2" value="Button Two">
  <input type="button" id="btn3" value="Button Three">
</div> 
```

有时我会将按钮浮动到右侧。有时我会将它们全部浮动到右侧。这就是问题开始的地方。如果我这样做，它真的会让人流连忘返，所以我必须继续输入这些：

```
<div style="clear:both;"></div> 
```

在最后。如果我**不**将它们全部浮动，那会破坏布局。

有没有好的解决方案？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-17T16:05:58.347

是的，`overflow: hidden`在容器上使用，即：

```
<style type="text/css">
#buttons { overflow: hidden; }
</style> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-17T16:30:13.090

这是 CSS 学习曲线的重要组成部分。当您浮动项目时，它们的包含元素不再考虑浮动元素的垂直高度。您可以使用几种解决方案来解决您的困境。

只需将 #button 容器的高度指定为按钮的高度：

```
#button { height: 30px; } 
```

一个更好的解决方案是 clearfix hack。它非常防弹，并且无需添加额外的标记和内联 CSS 也可以解决问题。

```
#buttons:after {
    content: ".";
    display: block;
    clear: both;
    visibility: hidden;
    line-height: 0;
    height: 0;
}

#buttons {
    display: inline-block;
}

html[xmlns] #buttons {
    display: block;
}

* html #buttons {
    height: 1%;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T17:11:58.000

只要你定义了父级的溢出，它就会清除所有的浮动。

在父级上使用溢出：自动，一切顺利！

[http://www.sitepoint.com/blogs/2005/02/26/simple-clearing-of-floats/](http://www.sitepoint.com/blogs/2005/02/26/simple-clearing-of-floats/)

（我也听说过使用 display:inherit 进行这项工作，但没有尝试过。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-12T13:54:54.747

当您使用 CSS 浮动项目时，它们会从页面的自然流动状态中移除。

如果它们在一个容器中`DIV`，那会将项目移出并且其父项看不到子元素的去向。然后容器会收缩到尽可能多的区域，就好像元素一开始就不存在一样。

为了解决这个问题，您必须指定`overflow:hidden`容器的属性。

默认情况下，它被设置为[`visible`](https://developer.mozilla.org/en/CSS/overflow)并且将允许任何东西“掉出”盒子，如果它已经被浮动的话。

通过在您的 CSS 中设置它来更正它：

```
#buttons 
{
    overflow:hidden;
} 
```

现在，这将约束浮动元素在 parent 的上下文和范围内显示`DIV`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T19:12:29.170

通常，最好的选择是[clearfix 方法](http://www.positioniseverything.net/easyclearing.html)或在包含父项上设置“溢出：隐藏”的方法。

在您的具体示例中，您确实有另一个选择：您根本无法浮动任何输入，并在 #buttons 上设置 'text-align: right'

```
#buttons {
    text-align: right;
    } 
```

虽然我相当依赖“溢出：隐藏”，但值得注意的是，如果您尝试将任何元素放置在设置了“溢出：隐藏”的包含元素的外部（或部分外部），则定位元素将在包含元素的边界处被剪掉。（这不会经常出现，但需要注意的“问题”。）

您可能还会发现[Jeff Starr 的博客文章“关于 Clearfix CSS Hack 的经验教训”很](http://perishablepress.com/press/2008/02/05/lessons-learned-concerning-the-clearfix-css-hack/)有趣。

# php - PHP 有哪些模板引擎选项？

> ID：874892
> 
> 赞同：0
> 
> 时间：2009-05-17T16:09:58.820
> 
> 标签：php, templates, templating, templating-engine

我想知道 PHP 中的模板有哪些选项？如果模板代码可以非常类似于 PHP，那将是最好的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-17T16:12:53.690

我可以推荐[Smarty](http://www.smarty.net/)

该模板是一个纯 HTML，带有一些用于 PHP 调用的额外标记。该模板将自身编译为 PHP 并在服务器上运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T16:24:07.223

php有一种[“替代”语法](http://www.php.net/alternative_syntax)，使其在 html 标签中更具吸引力，我强烈推荐它。

短标签，虽然大多不鼓励和/或嘲笑也有一个很好的优势：

```
<?php echo $variable; ?> 
```

可以变成：

```
<?= $variable; ?> 
```

您可以执行以下操作：

```
<ul>
    <? foreach ( $myListItems as $id => $itemText ) : ?>
    <li id="<?= $id; ?>">
        <?= $itemText; ?>
    </li>
    <? endforeach; ?>
</ul> 
```

这是您将使用 php 实现的最低级别的模板，但仍然非常易读，并且不需要您在视图中混合控制器或模型逻辑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T16:11:53.767

好吧，因为 PHP**是**一个模板引擎，所以总是... PHP。

有些人觉得有必要增加更多。[Smarty](http://www.smarty.net/)非常受欢迎。就个人而言，我从来没有看到过这一点，但每个人都有自己的观点。

# c# - 在 C# 中使用 db 检查时将字符串值转换为 int

> ID：874902
> 
> 赞同：0
> 
> 时间：2009-05-17T16:16:07.873
> 
> 标签：c#

我有一串 itemID，我希望 gridview 使用此参数并从 item 表中获取其余详细信息。我认为的问题是 itemIDs 是 varchar 格式，而 db itemID 是 int 格式。

因此，当显示项目详细信息的 gridview 页面加载时，我收到以下错误。好吧，我认为这是错误的原因，如果我错了，请纠正我！

```
Conversion failed when converting the varchar value ' + itemIDs + ' to data type int. 
```

使用的sql查询是：

```
SELECT ItemID, Name, RelDate, Price, Status FROM item_k WHERE (ItemID IN (' + itemIDs + ')) 
```

itemIDs 字符串包含类似的值`"3,16,8"`

如何将其转换为 int 格式？以及在哪里进行转换？在sql语句中？

谢谢

//编辑 2

```
ArrayList tmpArrayList = new ArrayList();

    tmpArrayList = (ArrayList)Session["array"];

    string itemIDs = string.Empty;

    foreach (object itemID in tmpArrayList)
    {
        itemIDs += itemID.ToString() + ',';
    }

   itemIDs = itemIDs.Substring(0, itemIDs.Length - 1); 
```

有什么简单的方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T16:23:10.670

我认为问题在于 ItemID 列，而不是 itemIDs 字符串，或者您在 3、16、8 附近有引号。

SQL应该是

```
SELECT ItemID, Name, RelDate, Price, Status FROM item_k  
WHERE ItemID IN (3,16,8) 
```

这是假设 ItemID 确实是一个整数，我猜它应该是。

如果您对非整数 IN 子句有相同的情况，那就是

```
SELECT * FROM table  
WHERE columnname IN ('Val1','VaL2') 
```

**对于空值的加法：**

```
SELECT * FROM table 
WHERE (columnname IN ('Val1','VaL2') OR columnname IS NULL) 
```

或者

```
SELECT * FROM table 
WHERE (columnname IN ('Val1','VaL2') AND columnname IS NOT NULL) 
```

**第二个问题的补充：** [参考文章“使用分隔符加入字符串”](https://stackoverflow.com/questions/581448/join-a-string-using-delimiters)以获得多种解决方案。另外，顺便说一句，如果使用 .NET 2.0+ 框架，我将使用 List<int> / List(Of Integer) （分别为 C#、vb.net）而不是 ArrayList。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T16:46:17.063

[从这里](https://stackoverflow.com/questions/337704/parameterizing-a-sql-in-clause/337931#337931)查看我的答案。本质上，您将 int 字符串作为 varchar(8000) 传递给函数，返回一个表变量并使用您的表连接到该变量。该函数的 SQL 包含在我的答案中。这适用于 SQL 报告和其他实例，在这些实例中，您希望过滤的 int 数量不定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T16:25:48.317

我认为它将文字字符串`' + itemIDs + '`放入查询中，而不是将 itemIDs 字符串的值附加到查询中。实际查看构建查询的代码会很有帮助。

# java - 如何强制 Java 的 HttpClient 接受无效的 cookie？

> ID：874903
> 
> 赞同：3
> 
> 时间：2009-05-17T16:16:32.367
> 
> 标签：java, wordpress, cookies, httpclient

我正在编写一个登录 WordPress 的脚本，但是，HttpClient 的 cookie 策略将 WordPress 设置的 cookie 识别为无效：

```
May 17, 2009 12:07:43 PM org.apache.commons.httpclient.HttpMethodBase processCookieHeaders
WARNING: Cookie rejected: "$Version=0; wordpress_dce2080bc042b2e639e4f5b3b704aa43=admin%7C1243786064%7C4c56aef46b1210d3d43d8b829fdf4d9a; $Path=/wp-content/plugins". Illegal path attribute "/wp-content/plugins". Path of origin: "/wp-login.php"
May 17, 2009 12:07:43 PM org.apache.commons.httpclient.HttpMethodBase processCookieHeaders
WARNING: Cookie rejected: "$Version=0; wordpress_dce2080bc042b2e639e4f5b3b704aa43=admin%7C1243786064%7C4c56aef46b1210d3d43d8b829fdf4d9a; $Path=/wp-admin". Illegal path attribute "/wp-admin". Path of origin: "/wp-login.php" 
```

如果没有 cookie 支持，脚本将无法登录。我怎样才能解决这个问题？

（使用 HttpClient 3.1）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-04T15:07:15.440

检查这篇文章以获得更多提示： [Java HtmlUnit - 无法登录到 wordpress](https://stackoverflow.com/questions/4291241/java-htmlunit-cant-login-to-wordpress)

在类似情况下，我能够使用以下代码（尽管我承认它在特定的 wordpress 案例中不起作用）：

```
HttpClient client = new HttpClient();
client.getParams().setParameter("http.protocol.single-cookie-header", true);
client.getParams().setCookiePolicy(CookiePolicy.BROWSER_COMPATIBILITY); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-20T21:54:04.887

HttpClient 是世界上唯一尊重 RFC 的东西。我提出了一个要求，以打击整个前缀路径。有很多站点将路径设置为他们然后将您转发到的路径。这是一件非常有用的事情。由于 Chrome、IE、Firefox、Safari、Opera 和其他所有浏览器都不关心，我认为 HTTPClient 应该停止关心，这样我们才能继续我们的生活。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T16:27:09.970

看看这个页面[HttpClient Cookie Guide](http://hc.apache.org/httpclient-3.x/cookies.html)，看看调整 cookie 策略是否能解决您的问题。

编辑：

更具体地说，尝试 Netscape Draft 策略，看看它的宽松限制是否适用于 WordPress cookie。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T18:18:39.107

您可以注册自己的更宽松的 Cookie 政策吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-07T11:21:03.400

您可以实施自己的 cookie 政策。[请参阅本HTTPClient 指南](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/statemgmt.html)
中的第 3.6 章。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-03-31T07:48:16.117

在我看来，你可以下载httpclient的源代码，找到log.warn ...的位置，可以删除它们。我这样做了。

# php - 如何在 PHP 中更好地使用 Smarty？

> ID：874905
> 
> 赞同：7
> 
> 时间：2009-05-17T16:17:10.243
> 
> 标签：php, smarty, template-engine, templating

我发现在 PHP 中使用 Smarty，有时需要额外的时间用于

1) 使用与 PHP 本身完全不同的语法
2) 需要检查小案例，因为文档没有提供更详细的信息，例如“转义”

[http://www.smarty.net/manual/en/language.modifier.escape.php](http://www.smarty.net/manual/en/language.modifier.escape.php)

它没有说 escape:"quotes" 仅用于双引号或单引号，因此您需要编写代码来测试它。同样对于 escape:"javascript" 的情况——不能准确地告诉它是什么以及它是如何被转义的。

3）对于一些复杂的事情，需要编写辅助函数或修饰符，因此需要创建新文件并最终在 PHP 中完成。

顺便说一句，与单独使用 PHP 相比，使用 Smarty 是否提供了很好的加速？谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-17T16:51:06.220

首先，PHP 是一种模板语言。当您谈论为基于 PHP 的 Web 应用程序使用模板系统时，请记住这一点。

我听说过使用任何模板引擎的唯一“真正”的论点是，它们为模板操作提供了一种更简单的语言，如果你的模板设计师不了解 PHP 并且你不信任他们，这会很方便学会明智地使用 PHP。

关于这些论点，我认为如果您的模板设计师没有能力学习足够的 PHP 进行模板设计，您可能应该考虑寻找新的模板设计师。此外，PHP 本身为您可能在模板和代码中使用的控制语句提供了不同的语法。例如：

```
<? foreach($array as $key => $val): ?>
    <?= $val ?>
<? endforeach; ?> 
```

对比：

```
<?php
    foreach($array as $key => $val) {
        echo $val;
    }

?> 
```

就个人而言，我相信模板引擎出现在 PHP 中是因为：

1.  这就是其他语言的做法
2.  更好的 PHP 程序员意识到他们需要一种方法来强制分离表示和应用程序逻辑，而模板是一种简单的方法来做到这一点。

第一个原因有点傻。第二个原因可以通过一点点自我控制来克服，甚至对应用程序中分离层的必要性有一个基本的了解。MVC 设计模式是解决这个问题的一种方法。至于锻炼一些自我控制，我的规则是只使用必要的循环和 if 语句以及过滤、转义、格式化屏幕输出的函数。

在广泛使用 Smarty 之后，老实说，它总是给我带来比解决方案更多的障碍来克服。如果有的话，切换到基于 PHP 的模板实际上减少了模板和代码的开发时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T16:54:39.930

我不喜欢模板引擎。我发现它们对于 PHP 来说非常有损且资源密集。

使用 MediaWiki，在 1.6.x 版本左右，我们默认放弃使用 Smarty，只使用 PHP 的内置模板，性能有了很大提高。

我发现人们想要用模板系统做的大部分事情（添加链接、更改颜色、删除页面的文本或部分）最好用一个简单的事件挂钩系统来完成。

Laconica 是开放的微博平台，默认不做任何模板。我们为喜欢模板的人准备了一个插件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-17T16:45:21.293

Smarty 无疑是目前最好的模板引擎之一。根据我的经验，尽管人们最好在使用 PHP 之上的任何模板引擎之前更彻底地考虑他们的用例。

首先，PHP 本身非常适合模板。几乎使用另一个模板引擎的唯一理由是，如果您允许不受信任的用户创建或编辑模板，因为他们可能会执行各种错误。因此，如果您的项目有用户可编辑的模板，请使用 Smarty。如果没有，请坚持使用 PHP。

如果你的问题是代码和布局的分离，我建议你考虑实现一个轻量级的 MVC 风格的执行模型。或者，更屈尊地说，如果您的模板中有更深层次的逻辑代码，那么可能是时候进行一些重构了。

性能是另一个考虑因素。是的，渲染 Smarty 模板是有代价的。但是在完成之后，应该缓存输出，从而缩短执行时间。PHP 模板也是如此。PHP 允许您通过使用其输出缓冲区来实现各种粒度缓存模型。但要注意过早的优化：只有在您完成代码并确定实际瓶颈是什么之后才这样做！

使用 Smarty 或任何其他引擎的最大成本来自于开发人员的时间。这是另一层复杂性，您不可避免地会发现自己处于必须*欺骗*引擎执行您在纯 PHP 中一直可以完成的事情的情况下。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-17T16:41:41.200

我喜欢模板引擎并认为应该使用它们，但在 Smarty 的特殊情况下，我认为这是浪费时间，因为它不是 PHP 作为模板语言的显着改进：

*   新语法仍然基于插入文档中随机位置的特殊标签的旧概念。
*   因为 Smarty 不了解 HTML 的语法/结构，所以它不能不帮助您创建有效/格式良好的 HTML。Smarty 的标签违反了 HTML 的语法，所以一旦你添加了它们，其他标准工具也帮不了你。
*   Smarty 的输出，就像在 PHP 中一样，默认情况下是不安全的（未转义的），您*必须*记住`|escape`在以 HTML 格式输出数据的任何地方添加。

我爱上了一个特定的 PHP 模板引擎，它解决了所有这些问题：[PHPTAL](http://phptal.org)。

它仍然是你必须学习的新东西，并且它对你的应用程序来说是一种依赖，但我认为解决 XSS 和格式错误的问题会让你觉得麻烦。

PHPTAL 就像 Smarty 一样编译一次 PHP 并缓存，因此性能与原始 PHP 相当。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T18:48:52.933

## 优点

*   HTML 文件中没有 PHP（允许 PHP 和 HTML 标识）
*   管道 {$var|default:"None selected"} {$var|urlencode}
*   Foreachelse：{foreach item=row from=$results}{$row.name}<br>{foreachelse}没有结果{/foreach}
*   可主题化的网站/页面（仅使用 CSS 有限制）

## 缺点

*   其他语言语法
*   并非总是显而易见的代码 {"Ymd"|strftime:$timestamp} {$array|@var_dump}
*   轻微开销

我强烈推荐“模板”方法（mVc），但 Smarty 和普通 PHP 都可以胜任这项任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T16:20:15.973

使用 Smarty 作为模板引擎可能不会像不使用它那样高效，因为它是一个额外的软件层，即在另一种模板语言 erm 之上的模板语言。另一方面，如果您正确使用缓存功能，您可以实现整体性能提升。

Smarty 模板在输出到浏览器之前会进行预编译，这涉及将临时文件写入磁盘。这一步肯定会惩罚性能，至少是一点点。

如果您对保持实现和表示分离的能力充满信心，并且对服务器端缓存没有真正的兴趣，那么您可能应该只使用纯 php 模板。一些 MVC 框架（例如[Zend Framework](http://framework.zend.com) ）有自己的类似 PHP 的模板系统。

另一方面，smarty 是一种将表示与实现巧妙分离的体面方法，尤其是在不清楚什么属于哪里的情况下。它可能有助于训练你强制执行这种必要的分离。

也就是说，我在我的大部分 PHP 项目中都使用 Smarty，因为它让我想起了 Java-Server Tag Libraries (JSTL)，我非常非常习惯并喜欢它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-17T16:26:22.573

据我所知，Smarty 是速度方面最好的模板引擎之一。也许需要一段时间才能习惯。但是，如果您不是单独在系统上工作，并且 html 和样式文件的数量很大，那么它会显着加快开发速度。

在处理我的上一个项目时，设计更改了几次，但逻辑是相同的。我想这是 Smarty 或任何其他模板引擎有很大帮助时的最佳示例。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-17T16:37:28.393

我个人使用 Blitz 进行模板化。在该网站上，作者声称它是最快的模板引擎，并提供了一个（有偏见的？）图表，说明了 PHP 的不同模板系统之间的性能。我自己没有使用 smarty，但这可能会给你一些关于它的性能的提示。

[http://alexeyrybak.com/blitz/blitz_en.html](http://alexeyrybak.com/blitz/blitz_en.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-02-16T00:36:39.457

是否使用 Smarty 或多或少是一种哲学立场。

我使用它，虽然我不使用太多功能。以这种方式使用它，模板往往非常简单。传递带有参数的关联数组，遍历其组件并在结果页面中插入所需的元素。这使模板保持干净并且（希望）没有业务逻辑。

此外，扩展 Smarty 非常简单。

例如，我在 fetch() 中添加了一个样式参数以具有 fetchUsingStyle()。这让我可以很容易地在网站的不同布局之间切换。

此外，我的 fetchUsingStyle() 在不同位置搜索模板：首先尝试查找当前样式。如果未找到，它会尝试使用默认样式加载模板。最后，它试图定位一个纯静态的虚拟文件，一个占位符，用于稍后实现的某些东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-09T12:27:12.210

尝试将 Smarty 与 MVC 模式一起使用，例如 Codeigniter，它比核心 PHP 更好

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-09-19T19:11:14.907

当您可以只使用 html 文件并在需要的地方注入 php 代码时，为什么还要使用模板引擎？你可以用 Psttt 做到这一点！php的模板引擎

完整的源代码在这里[http://github.com/givanz/psttt](http://github.com/givanz/psttt)

# iphone - 将 UITableView 子类与 UITableViewController 一起使用

> ID：874906
> 
> 赞同：16
> 
> 时间：2009-05-17T16:17:32.490
> 
> 标签：iphone, uitableview

如何告诉我`UITableViewController`使用我的自定义`UITableView`子类`tableView`而不是常规子类`UITableView`？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-17T16:56:21.083

将 UITableViewController.tableView 属性设置为自定义 UITableView 子类的实例。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-17T16:57:54.687

在界面生成器中，将 tableview 类与身份检查器视图中的自定义 tableview 关联

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-17T20:45:07.520

UITableViewController 只是一个带有 UITableView 实例的 UIViewController，并且 viewController 设置为表的委托和数据源。viewController 为这些委托方法实现存根。

您可以通过让 UIViewController 实现 UITableViewDataSource 和 UITableViewDelegate 协议来自己完成。然后在 UIViewController 的 loadView（或 viewDidLoad）方法中设置 tableView 实例的 dataSource 和 delegate 为 self。

您可以在那里使用自己的表子类。

# batch-file - 详细说明：mklink 及其选项

> ID：874913
> 
> 赞同：2
> 
> 时间：2009-05-17T16:20:41.043
> 
> 标签：batch-file, directory, cmd

我最近关注了一个关于如何在您不是管理员的系统上安装 apache 的小教程。基本上，原始的 htdocs 和 conf 文件夹被复制到我拥有所有权的地图中，删除了原始文件夹，然后创建了符号链接。

现在，我检查了一下`mklink /?`，它提供了几个选项。

1.  目录符号链接
2.  硬链接
3.  目录连接

[Microsoft technet](http://technet.microsoft.com/en-us/library/cc753194.aspx)没有对最后两个选项的实际作用提供太多解释。

所以我想知道这里是否有人可以告诉我这些选项的作用，也许可以举一个例子说明这真的很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T16:54:41.630

请参阅 MSDN 上有关[Hardlinks 和 Junctions](http://msdn.microsoft.com/en-us/library/aa365006(VS.85).aspx)的文档。它说：

> 硬链接是文件的文件系统表示，多个路径通过该文件引用同一卷中的单个文件。

和：

> 联结（也称为软链接）与硬链接的不同之处在于它引用的存储对象是单独的目录，并且联结可以链接位于同一台计算机上不同本地卷上的目录。否则，结点的操作与硬链接相同。

# regex - Perl：使用正则表达式从文本中提取数据

> ID：874915
> 
> 赞同：1
> 
> 时间：2009-05-17T16:22:11.840
> 
> 标签：regex, perl

我正在使用 Perl 使用正则表达式进行文本处理。我无法控制输入。我在下面展示了一些输入示例。

如您所见，项目 B 和 C 可以在字符串中出现 n 次，具有不同的值。我需要将所有值作为后向参考。或者，如果您知道另一种方式，我全神贯注。

我正在尝试使用分支重置模式（如[perldoc 中所述：“扩展模式”](http://perldoc.perl.org/perlre.html#Extended-Patterns)）我没有太多运气匹配字符串。

```
（“数据”（诠释“A”22）（诠释“B”1）（诠释“C”2）（诠释“D”34896）（诠释“E”38046））
("数据" (Int "A" 22)(Int "B" 1)(Int "C" 2)(Int "B" 3)(Int "C" 4)(Int "B" 5)(Int "C" " 6)(诠释“D”34896)(诠释“E”38046))
(“数据” (Int “A” 22)(Int “B” 22)(Int “C” 59)(Int “B” 1143)(Int “C” 1210)(Int “B” 1232)(Int “C” " 34896)(诠释“D” 34896)(诠释“E” 38046))

```

我的 Perl 在下面，任何帮助都会很棒。谢谢你提供的所有帮助。

```
if($inputString =~/\("Data" \(Int "A" ([0-9]+)\)(?:\(Int "B" ([0-9]+)\)\(Int "C" ([0-9]+)\))+\(Int "D" ([0-9]+)\)\(Int "E" ([0-9]+)\)\)/) {

    print "\n\nmatched\n";

    print "1: $1\n";
    print "2: $2\n";
    print "3: $3\n";
    print "4: $4\n";
    print "5: $5\n";
    print "6: $6\n";
    print "7: $7\n";
    print "8: $8\n";
    print "9: $9\n";

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-17T17:28:55.240

不要尝试使用一个正则表达式，一组正则表达式和拆分更容易理解：

```
#!/usr/bin/perl

use strict;
use warnings;

while (<DATA>) {
    next unless my ($data) = /\("Data" (.*)\)/;
    print "on line $., I saw:\n";
    for my $item ($data =~ /\((.*?)\)/g) {
        my ($type, $var, $num) = split " ", $item;
        print "\ttype $type var $var num $num\n";
    }
}

__DATA__
("Data" (Int "A" 22)(Int "B" 1)(Int "C" 2)(Int "D" 34896)(Int "E" 38046))
("Data" (Int "A" 22)(Int "B" 1)(Int "C" 2)(Int "B" 3)(Int "C" 4)(Int "B" 5)(Int "C" 6)(Int "D" 34896)(Int "E" 38046))
("Data" (Int "A" 22)(Int "B" 22)(Int "C" 59)(Int "B" 1143)(Int "C" 1210)(Int "B" 1232)(Int "C" 34896)(Int "D" 34896)(Int "E" 38046)) 
```

如果您的数据可以跨行，我建议使用解析器而不是正则表达式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T16:53:25.343

我不确定将这些值作为反向引用有什么好处 - 您希望谁处理重复键的情况（如第二行中的“C”）。另外，我不确定您希望对提取后的值做什么。

但我会从以下内容开始：

```
use Data::Dumper;

while (<DATA>)
{
    my @a = m!\(Int "(.*?)" ([0-9]+)\)!g;
    print Dumper(\@a);
}

__DATA__
("Data" (Int "A" 22)(Int "B" 1)(Int "C" 2)(Int "D" 34896)(Int "E" 38046))
("Data" (Int "A" 22)(Int "B" 1)(Int "C" 2)(Int "B" 3)(Int "C" 4)(Int "B" 5)(Int "C"     6)(Int "D" 34896)(Int "E" 38046)) 
("Data" (Int "A" 22)(Int "B" 22)(Int "C" 59)(Int "B" 1143)(Int "C" 1210)(Int "B" 1232)(Int "C" 34896)(Int "D" 34896)(Int "E" 38046)) 
```

这为您提供了一组重复的键、值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T17:10:30.123

我最初的想法是使用命名捕获并从以下位置获取值`%-`：

```
my $pattern = qr/
  \(
    "Data"\s+
    \(Int\s+"A"\s+(?<A>[0-9]+)\)
    (?:
      \(Int\s+"B"\s+(?<B>[0-9]+)\)
      \(Int\s+"C"\s+(?<C>[0-9]+)\)
    )+
    \(Int\s+"D"\s+(?<D>[0-9]+)\)
    \(Int\s+"E"\s+(?<E>[0-9]+)\)
  \)
/x; 
```

不幸的是，`(?:...)`分组不会触发捕获 B 和 C 的多个值。我怀疑这是一个错误。显式执行此操作会捕获所有值，但您必须提前知道最大实例数。

```
my $pattern = qr/
  \(
    "Data"\s+
    \(Int\s+"A"\s+(?<A>[0-9]+)\)
    \(Int\s+"B"\s+(?<B>[0-9]+)\)
    \(Int\s+"C"\s+(?<C>[0-9]+)\)
    (?:
      \(Int\s+"B"\s+(?<B>[0-9]+)\)
      \(Int\s+"C"\s+(?<C>[0-9]+)\)
    )?
    (?:
      \(Int\s+"B"\s+(?<B>[0-9]+)\)
      \(Int\s+"C"\s+(?<C>[0-9]+)\)
    )?
    # repeat (?:...) N times
    \(Int\s+"D"\s+(?<D>[0-9]+)\)
    \(Int\s+"E"\s+(?<E>[0-9]+)\)
  \)
/x; 
```

最简单的方法是使用`m//g`. 您可以按照 Beano 的建议捕获名称/值对，也可以使用多种模式来捕获每个值：

```
my @b = m/Int "B" ([0-9]+)/g;
my @c = m/Int "C" ([0-9]+)/g;
# etc. 
```

# ms-access - 将访问 adp / sqlserver 重写为 C# .net？

> ID：874941
> 
> 赞同：5
> 
> 时间：2009-05-17T16:35:21.123
> 
> 标签：ms-access

我是一名非技术人员，拥有一家小公司，多年来一直支持我公司的软件。该解决方案运行良好，并且该解决方案的排列已与当前的 IT 服务提供商合作超过 15 年。我最近找了一家更成熟的 IT 公司对软件进行一般审计。当前的解决方案使用 access 作为前端，使用 sqlserver 2005 作为数据库。进行审计的公司提供了一份故障清单，其中包括技术过时、解决方案不可扩展、设计不良、非用户友好界面、表格未规范化、表格没有参照完整性、未使用正确的编码标准和命名约定，没有应用程序安全性，只有数据库安全性等。进行审计的公司建议必须重新编写解决方案并提出这样做​​。目前的服务提供商知道其中的一些发现，但向我保证，这对我的业务构成的风险很小或没有风险。重新编写应用程序将花费大量资金。我处境艰难，希望得到一些技术建议。我基本上需要知道我的企业在当前技术上运行是否存在风险。在给定时间，我最多有 70 个并发用户在系统上工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T16:45:24.227

好吧，如果你重视乔尔的[话](http://www.joelonsoftware.com/articles/fog0000000069.html)，我会说你确实在这里冒了很大的风险。

对公司来说，重写东西曾经并且永远不会是安全的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T00:09:43.767

修复现有应用程序中的问题。它会便宜得多，可以逐步完成，如果做得好，将产生一个更易于维护的应用程序。

更换 ADP 前端的建议对我来说听起来像是纯粹的偏见/无知——他们不出售 Access 开发，所以他们想为您构建一个全新的应用程序。

另一方面，关于后端的建议听起来你不应该等待修复（尽管它可能需要大量工作，因为现有数据可能不适合适当的 RI）。

前端和后端问题是两个独立的问题，可以独立处理（尽管应用程序可能需要更新以反映 RI 的变化——如果没有逐案评估就不可能说）。

我会聘请具有 ADP 经验的合格 Access 开发人员来处理该项目。这将比完全重写便宜得多，并且您不会牺牲任何功能，也不会重新引入现有应用程序中已经解决的错误。它也可以逐步完成（取决于问题是什么以及需要如何解决）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T17:08:06.363

在从技术角度查看问题之前，您必须评估应用程序对您的业务的重要性。听起来好像您有一个正常运行的应用程序。如果它提供一致的行为并且您不需要升级/新开发，您可能希望不理会它。我们软件开发人员喜欢抱怨别人的代码，用“优雅”的解决方案重写别人的工作。那就是钱的意思。

但是，您有一项可能需要维护的投资，并且当您将底层代码和数据库置于分散状态时，您将产生更多成本，因为应用程序本身不适合修改。您需要了解需要支持多少变化。鉴于它已经投入生产了 15 年，因此您运行良好，因此您没有太大的风险。

重新编写将花费您，因为您需要重新创建应用程序的功能，并且由于支持的数据库和程序似乎是“非规范化”和非结构化的，因此需要付出很大的努力。拥有一个干净的数据库模型是有好处的，因为它会更容易生成报告、导出到 Excel 等。如果你想修改它，开发人员将更容易弄清楚要做什么。

要花钱得到你已经拥有的东西，你要求公司详细说明你将获得哪些额外的好处。这些好处是否超出了您今天所获得的，这家公司会兑现他们的承诺吗？如果数据库是“标准化”的，但除了当前应用程序给您带来的好处之外，您没有得到任何其他好处，您的公司会变得更好吗？在您跳转到新平台之前，请记住这些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-17T17:25:46.817

把它归结为简单的术语，问自己这些问题：

1.  您目前的软件有问题吗？是用户抱怨用户界面，还是新用户在使用软件时特别难上手？数据是否在任何阶段丢失或损坏，或者您在从数据库中检索报告时遇到问题？

2.  您目前或将来是否可能需要修改？如果你的软件写得不好，修改成本会更高，而且更有可能破坏应用程序并导致停机。

如果这两个问题的答案是否定的，那么您可能不需要重写软件。您必须记住，优秀的软件开发人员看到写得不好的软件并希望正确地重写它——除此之外，他们开发软件是有钱的，所以他们的观点并非完全没有偏见。

就像其他人所说的那样，重新编写系统有其自身的风险——很久以前修复的旧错误可以再次出现，可以引入新错误，新系统的开发人员可能会完全错过重点，使系统比以前的系统更不可用。

如果当前系统存在问题，尽管考虑让有能力的开发人员重新编写系统可能是值得的 - 但是，如果您选择走这条路，请确保从当前用户那里获得反馈，尤其是“专家”或'权力'用户，以确保系统将满足他们的所有要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T16:51:04.037

“更成熟的 IT 公司”提供的建议对于 access/sql server 项目非常普遍。建议几乎总是将它们重写为 Web 应用程序。

去年我自己做了这个——拿了一个 MS Access 前端/SQL Server 后端应用程序，并将访问部分重写为 C#/ASP.Net 网站。由于切换，我们享受到了更好的性能和更大的灵活性，但是旧的前端已经存在了足够长的时间，以至于我们无法恢复我们在重写之前曾经拥有的所有功能。

如果您实际上看到 70 个并发用户，并且他们都没有遇到性能问题，并且您的公司网络足够安全，那么您可能会因为重写应用程序而损失更多，至少在功能方面是这样。另一方面，这可能是评估“什么有效”和“什么可以更好”的好机会——并增强工作流程。

出色地使用编码标准并不一定会转化为出色的应用程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T13:32:03.897

是什么促使审计？他们的解决方案是否解决了这个问题？

让我们算一下： 人：平均 70 人。小时使用软件/天：2（保守）工资/小时：8.00 美元（非常保守）工作日/年：250（周末和假期/病假）

使用应用程序的人工成本：70 * 2 * 8 * 250 = $280,000 / 年（可能超过 500K）

你能得到多少改进？5%、10%、25% 新申请的费用是多少？50K、100K、200K

如果您能够节省这段时间，您的用户是否可以腾出时间进行创收活动，或者他们是否有更多时间上网？您可能想要创建一些工人效率系数：90%、75%

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T02:50:10.513

简单的答案...使用 Access 的大多数“风险”都可以通过使用 SQL Server 作为后端来克服。您已经说过您当前的解决方案有效。

所以它归结为你未来的计划。如果您现有的应用程序没有缺少任何无法通过访问提供的功能，我会坚持使用您所拥有的。如果您需要新功能，我会考虑一些事情。

1.  它们是 Access 无法提供或做得不好的东西吗（例如：面向 Internet 的解决方案）？
2.  拥有这些新功能有什么潜在的好处？
3.  *没有*新功能会产生什么潜在成本？
4.  你能在 1 和 2 上放一个美元数字吗？
5.  在 Access 中开发解决方案需要多少钱？
6.  用C#开发解决方案多少钱

换句话说，总是做[CBA](http://en.wikipedia.org/wiki/Cost-benefit_analysis) :) 更好的是，你拥有 CBA，然后要求两家公司为你提供一个，然后比较有趣。在最坏的情况下，您可能会让您现有的公司降低价格以保留您作为客户。

# c++ - C++ 中的枚举数据类型和类 API

> ID：874962
> 
> 赞同：0
> 
> 时间：2009-05-17T16:45:38.173
> 
> 标签：c++, api, coding-style, class

如果您应该将所有内容封装在类定义中，那么如何在类中使用枚举数据类型？例如，我刚刚编写了以下代码...

```
enum PizzaType {DEEP_DISH, HAND_TOSSED, PAN};
enum PizzaSize {SMALL, MEDIUM, LARGE};

class Pizza {
    public:
        Pizza();
        void setPizzaType(PizzaType type);
        PizzaType getPizzaType();
        void setPizzaSize(PizzaSize size);
        PizzaSize getPizzaSize();
        void setToppings(int toppings);
        int getToppings();
        void outputDescription();
        double computePrice();
    private:
        PizzaType pizzaType;
        PizzaSize pizzaSize;
        int totalToppings;
}; 
```

有没有办法在类本身中包含枚举数据类型，但仍然允许从外部访问 mutator/accessor 函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T16:58:37.667

是的，你可以这样做：

```
class Pizza {
    public:
        enum PizzaType {DEEP_DISH, HAND_TOSSED, PAN};
        enum PizzaSize {SMALL, MEDIUM, LARGE};

        Pizza();
        void setPizzaType(PizzaType type);
        PizzaType getPizzaType();
        void setPizzaSize(PizzaSize size);
        PizzaSize getPizzaSize();
        void setToppings(int toppings);
        int getToppings();
        void outputDescription();
        double computePrice();
    private:
        PizzaType pizzaType;
        PizzaSize pizzaSize;
        int totalToppings;
}; 
```

..然后其他人说，您只需要使用 Pizza“命名空间”即可访问枚举类型：

```
Pizza::PizzaType tmp = pPizza->getPizzaType(); 
```

等等等等

（作为一种风格说明，当您像这样将枚举放入类中时，我会亲自删除它前面的 Pizza，以便您拥有 Pizza::Type 和 Pizza::Size。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T16:55:39.040

```
class Pizza {
    public:
        enum PizzaType {DEEP_DISH, HAND_TOSSED, PAN};
        void setPizzaType(PizzaType type);
        PizzaType getPizzaType();
};
...
Pizza p;
p.setPizzaType( Pizza::DEEP_DISH );
Pizza::PizzaType pt = p.getPizzaType(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-17T17:04:03.280

在 C++ 中使用枚举的首选方法是在类中定义它们：

```
class Foo {
public:
     enum Bar {
         ENUM_VALUE1,
         ENUM_VALUE2
     };
}; 
```

然后，您可以使用以下方法引用它们：

```
Foo::Bar var;
var = Foo::ENUM_VALUE1; 
```

在类中，您可以删除`Foo::`前缀。

您可能已经注意到，虽然 enum 的类型是`Foo::Bar`，但值不是通过 引用的`Foo::Bar::ENUM_VALUE1`，而是出现在`Foo`的命名空间中。如果不同的枚举共享相同的值名称，这可能会出现问题。为避免这种情况，您可以执行以下技巧：

```
class Foo {
public:
      struct Bar {
             enum ENUM {
                  ENUM_VALUE1,
                  ENUM_VALUE2
             };
      struct Baz {
             enum ENUM {
                  ENUM_VALUE1,
                  ENUM_VALUE2
             };
      };
};
Foo::Bar::ENUM e = Foo::Bar::ENUM_VALUE1;
Foo::Baz::ENUM e2 = Foo::Baz::ENUM_VALUE1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T16:49:49.450

这不是问题，您可以通过指定 Pizza::PizzaType 创建此枚举类型的变量。

将枚举放在您的班级中，如果您希望它们被外部访问，请确保它们也是公开的。

```
Pizza p;
p.setPizzaType(Pizza::PAN);
Pizza::PizzaType pt = p.getPizzaType();
assert(pt == Pizza::PAN); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-17T16:51:06.953

只要枚举类型是公开的，就可以在类外使用。您只需将其范围限定为：Pizza::PizzaType。静态方法以及静态常量和变量存在相同的规则。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T16:51:33.350

您可以在类内部定义枚举，并在外部使用它，就像使用命名空间一样，即 classname::enum_type。实际上，在类中定义它是一个好主意，因为它可以避免全局命名空间污染。

# c# - Windows Mobile 注册表 UnauthorizedAccessException

> ID：874963
> 
> 赞同：0
> 
> 时间：2009-05-17T16:46:00.420
> 
> 标签：c#, windows-mobile, registry

我编写了三个程序来修改 Windows Mobile 中的注册表，以安装和删除一个用于调试目的的 todayscreen 插件。他们工作了一段时间，但他们突然一个接一个地给出“UnauthorizedAccessException”。

请参阅下面两个程序的代码（请注意，以下代码直接位于 Main 中，因此它运行然后程序终止）...

注册表初始化.exe：

```
RegistryKey CustomItem = Microsoft.Win32.Registry.LocalMachine.CreateSubKey(@"Software\Microsoft\Today\Items\TodayLauncher");
CustomItem.SetValue("Type", 4, RegistryValueKind.DWord);
CustomItem.SetValue("Enabled", 1, RegistryValueKind.DWord);
CustomItem.SetValue("Options", 1, RegistryValueKind.DWord);
CustomItem.SetValue("DLL", @"\Program Files\TodayLauncher\TodayLauncher.dll", RegistryValueKind.String);
CustomItem.SetValue("Config", @"\Program Files\TodayLauncher\Settings.cfg", RegistryValueKind.String);
CustomItem.SetValue("Selectability", 1, RegistryValueKind.DWord);

SendMessage((IntPtr)HWND_BROADCAST, WM_WININICHANGE, 0xF2, 0); 
```

注册表清除：

```
Microsoft.Win32.Registry.LocalMachine.DeleteSubKey(@"Software\Microsoft\Today\Items\TodayLauncher");
SendMessage((IntPtr)HWND_BROADCAST, WM_WININICHANGE, 0xF2, 0); 
```

第三个程序是一个配置程序，它可以选择使用上面代码的精确副本添加和删除注册表项，但它从来没有完全起作用。有一段时间它可以运行“RegistryInit”的代码，但这并没有持续多久。现在原来的“RegistryClear”程序不起作用，给出了同样的UnauthorizedAccessException。我觉得很奇怪，这些程序工作了一段时间，然后突然停止工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:00:00.037

我看到您没有调用 RegistryKey.Close() （即您的示例中的 CustomItem.Close()），因此密钥可能仍处于打开状态且未刷新到磁盘，因此您得到 UnAuthorizedAccessException？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T20:00:37.717

我要做的一项更改是将“DeleteSubKey”更改为“DeleteSubKeyTree”，因为如果您要删除的键下有任何子键，“DeleteSubKey”将失败。

您是否尝试将它们编写为 C 中的本机应用程序？看看你是否遇到同样的问题。

# php - 在没有 smtp 的情况下在 Delphi 中发送电子邮件并在服务器上使用 php 函数

> ID：874965
> 
> 赞同：3
> 
> 时间：2009-05-17T16:46:54.397
> 
> 标签：php, delphi, email

使用 Delphi，我想使用 winsock 向我的 Web 服务器发送一条文本消息，然后使用服务器上的电子邮件 php 函数发布消息。

首先我完成了发送过程（Procedure SendEmail）：它读取一个文本文件（日志）并将其发布到我的服务器。在服务器上，消息由名为 email.php 的电子邮件 php 函数接收（请参阅下面该函数的内容）：

```
Procedure SendEmail;

var
WSADat:WSAData; // winsock.pas
Texto:TextFile;
Client:TSocket;
Info,Posting,Linha,Content:String;
SockAddrIn:SockAddr_In; // winsock.pas
begin
try
if not FileExists(Log) then exit;
AssignFile(Texto, Log); // text to be sent 
Reset(Texto);
while not Eof(Texto) do
begin
ReadLn(Texto, Linha);
Content:=Content+#13#10+Linha;
end;
CloseFile(Texto);
DeleteFile(PChar(Log));
WSAStartUp(257,WSADat);
Client:=Socket(AF_INET,SOCK_STREAM,IPPROTO_IP);
SockAddrIn.sin_family:=AF_INET;
SockAddrIn.sin_port:=htons(80);
SockAddrIn.sin_addr.S_addr:=inet_addr('60.64.10.42'); // myserver IP
if Connect(Client,SockAddrIn,SizeOf(SockAddrIn))=0 then begin
Info:='Sender='+CFG.Email+'&content='+Content;
Posting:='POST /blogwp/email.php HTTP/1.0' #13#10
'Connection: close' #13#10
'Content-Type: application/x-www-form-urlencoded' #13#10
'Content-Length: '+IntToStr(Length(Info)) #13#10
'Host: http://myserver.com' #13#10
'Accept: text/html' +#13#10+#13#10+
Info+#13#10;
Send(Client,Pointer(Posting)^,Length(Posting),0);
end;
CloseSocket(Client);
except
exit;
end;
end;
[... some  mutex test...]
end. 
```

服务器端 email.php 函数说明：

```
<?php
$to =$_POST["sender"];
$subject ="mymessages";
$message =$_POST["content"];
$from ="From: some at somedomain dot com";

$headers =implode("\n",array("From: $headers","Subject: $subject","Return-Path: $headers","MIME-Version: 1.0?","X-Priority: 3","Content-Type: text/html" ));

$flag = mail($to,$subject,$message,$from); // create variables

if($flag)
{
echo "ok!";
}
else
{
echo "no ok =/";
}
?> 
```

（注意：我已经按照 php 邮件功能的指南：http: [//us3.php.net/manual/en/book.mail.php](http://us3.php.net/manual/en/book.mail.php)）

这里的总体思路是不使用 smtp 将消息发送到服务器。但是，据我所见，邮件似乎被丢弃在我的服务器上。我对这个过程很有信心，但不确定 php 邮件功能。这东西不容易调试。知道出了什么问题吗？或任何其他看起来相似的解决方案？

任何帮助将不胜感激。谢谢。

[编辑] 我还在我的服务器站点上寻求有关使用 smtp 的支持。如果没有先进行检查，我似乎无法发送任何邮件（使用 smtp）：

> ```
> We use pop-before-smtp mail authentication. You first need to 
> ```
> 
> 检查邮件，然后才能发送任何邮件。您也没有在电子邮件客户端设置中设置 smtp 身份验证。一旦您检查了带有 POP 身份验证的邮件，就不需要了。
> 
> ```
> We use POP before SMTP authentication as it is a fairly 
> ```
> 
> 防止垃圾邮件发送者和开放中继的安全方法。不幸的是，这是我们选择的配置。对于希望发送邮件列表的用户，我们有 Mailman ValueApp，但对于标准电子邮件，SMTP 之前的 POP 是服务器的设置方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T17:55:13.583

您需要确保 POST 值名称的大小写匹配 - 您有

```
$to =$_POST["sender"]; 
```

和

```
Info:='Sender='+CFG.Email 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T17:00:00.740

以下行是错误的：

```
$headers =implode("\n",array("From: $headers","Subject: $subject","Return-Path: $headers","MIME-Version: 1.0?","X-Priority: 3","Content-Type: text/html" )); 
```

它应该是

```
$headers =implode("\r\n", array("From: $from","Return-Path: $from","MIME-Version: 1.0","X-Priority: 3","Content-Type: text/html")); 
```

尽管您的邮件服务器可能已损坏并且需要“\n”。

也 $from 应该只是电子邮件地址，而不包括“发件人：”。

无需设置主题标头 - PHP 会为您完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T13:12:32.753

在 PHP 端，您可以使用 fsockopen()、fputs()、fgets() 和 fclose() 来处理与 POP 服务器的连接需求。fsockopen() 的 PHP 帮助应该为您提供所需的详细信息。

旁注：也许不是问题，但您需要确保您没有创建开放中继的混合体（让其他人使用您的 email.php 端点代表您发送电子邮件）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T21:32:05.023

**测试您的 PHP 代码**

为什么不尝试写入文件？我将使用日期/时间和日志文件内容写入服务器上的文件，然后从[http://myserver.com/log.txt访问它](http://myserver.com/log.txt)

**至于德尔福部分：**

我不会直接使用套接字，你为什么不使用像 Indy (TIDHTTP) 这样的库。

使用它会简单得多。

POST 类似于 IdHttp1.Post(...)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T02:05:01.647

由于您注意到 ISP 需要通过 POP-before-SMTP 进行身份验证，因此您应该考虑使用[PHP Mailer](http://phpmailer.codeworxtech.com/)之类的东西来促进这种交互 - 或者使用 PHP 的[POP](http://php.net/imap)函数（恰好完全相同作为 IMAP 和 NNTP 的那些）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T20:22:08.573

好的，谢谢...我已经应用了更正。现在我有：

```
Procedure EnviarEmail;
var
  WSADat:WSAData;
  Texto:TextFile;
  Client:TSocket;
  Info,Posting,Linha,Content:String;
  SockAddrIn:SockAddr_In;
begin
  try
    if not FileExists(Log) then exit;
    AssignFile(Texto, Log);
    Reset(Texto);
    while not Eof(Texto) do
    begin
      ReadLn(Texto, Linha);
      Content:=Content+#13#10+Linha;
    end;
    CloseFile(Texto);
    DeleteFile(PChar(Log));
    WSAStartUp(257,WSADat);
    Client:=Socket(AF_INET,SOCK_STREAM,IPPROTO_IP);
    SockAddrIn.sin_family:=AF_INET;
    SockAddrIn.sin_port:=htons(80);
    SockAddrIn.sin_addr.S_addr:=inet_addr('86.88.10.42');
    if Connect(Client,SockAddrIn,SizeOf(SockAddrIn))=0 then begin
      Info:='Sender='+CFG.Email+'&Content='+Content;
      Posting:='POST /blogwp/email.php HTTP/1.0'               +#13#10+
             'Connection: close'                               +#13#10+
             'Content-Type: application/x-www-form-urlencoded' +#13#10+
             'Content-Length: '+IntToStr(Length(Info))         +#13#10+
             'Host: http://somedomain.com'                     +#13#10+
             'Accept: text/html'                               +#13#10+#13#10+
             Info+#13#10;
      Send(Client,Pointer(Posting)^,Length(Posting),0);
    end;
    CloseSocket(Client);
   // ShowMessage('INFO == ' +Info + ' POSTING == '+ Posting);
  except
    exit;
  end;
end;
[... some mutex check...] 
```

服务器上的 email.php 是：

```
<?php
$to =$_POST["Sender"];
$subject ="mymessages";
$message =$_POST["content"];
$from ="From: some at somedomain dot com";

$headers =implode("\r\n", array("From: $from","Return-Path: $from","MIME-Version: 1.0","X-Priority: 3","Content-Type: text/html"));

$flag = mail($to,$subject,$message,$from); // create variables

if($flag)
{
echo "ok!";
}
else
{
echo "no ok =/";
}
?> 
```

还是收不到邮件。过程中的 ShowMessage 向我显示 info 变量的类似内容：

```
Sender=validEmailAddressContent=<..... data ....> 
```

这可能是错误的 - 地址和内容之间至少缺少空格或换行符 (?)。这个“信息”变量应该如何格式化？

谢谢。

# c# - 使用 C# 和 asp.net 的 Web 应用程序中的进度条

> ID：874976
> 
> 赞同：0
> 
> 时间：2009-05-17T16:52:07.327
> 
> 标签：c#, asp.net

我的应用程序中需要有 2 个进度条：

1.  [圆形图形进度条](http://developers.sun.com/docs/web-app-guidelines/uispec4_0/15-progress.html#15.3)（*忙碌指示器）*
    *   如链接**[15.1.3]**所示，当页面进行回发时
2.  确定的[进度条](http://developers.sun.com/docs/web-app-guidelines/uispec4_0/15-progress.html#15.3)
    *   如链接**[15.1.1]**中所示，当我将数据更新或加载到我在应用程序中使用的网格中时显示百分比。

任何人都可以帮助我处理代码片段以及如何处理我的 .aspx 和 .aspx.cs 文件以便为我的应用程序获取这些进度条吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T17:04:35.667

您可以对繁忙指示器使用 UpdateProgress 控件，这非常简单：

```
 <asp:UpdateProgress ID="UpdateProgress1" runat="server" AssociatedUpdatePanelID="UpdatePanel1" DisplayAfter="0">
       <ProgressTemplate>
           <div>
               <img src="../Resources/Images/indicator.gif" />
               Loading...
           </div>
       </ProgressTemplate>
   </asp:UpdateProgress> 
```

但是进度条需要更多的工作。您需要运行一个后台线程来完成这项工作，然后您需要定期回发以检查会话变量的值，以获取您当前的进度。

# java - 字符串和最终

> ID：874978
> 
> 赞同：29
> 
> 时间：2009-05-17T16:52:55.890
> 
> 标签：java, string, variables, final

以下陈述有什么区别

```
String name = "Tiger";

final String name ="Tiger"; 
```

虽然`String`类是`final`类，但为什么我们需要创建一个字符串“CONSTANT”变量作为final？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-17T16:55:10.163

`final`在这种情况下，意味着变量`name`只能分配一次。再次为其分配不同的`String`对象会导致编译错误。

我认为这里混乱的根源是`final`关键字可以在几种不同的上下文中使用：

*   final class：该类不能被子类化。
*   final 方法：该方法不能被覆盖。
*   final 变量：变量只能赋值一次。

有关每种情况的示例，请参阅有关[Java 中 final](http://en.wikipedia.org/wiki/Final_(Java))的 Wikipedia 文章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-17T17:09:38.657

“最终”在两种情况下的含义不同。

java.lang.String 类是最终的。这意味着你不能继承它。

变量“name”是最终的，这意味着您不能将其更改为指向不同的 String 实例。因此，非最终字符串变量不是常量，因为您可以在两次不同的时间读取它并获得不同的值。

碰巧的是，Java 字符串对象也是不可变的。这意味着您不能修改特定 String 对象所代表的值。将此与数组进行比较 - 您可以将数组对象的第一个元素替换为不同的对象，但不能将 String 对象的第一个字符替换为不同的字符。这就是 String.replace() 返回一个新字符串的原因——它不能修改旧字符串。

String 是 final 的一个原因是为了防止 String 的子类的实例（它实现了可变行为）被传递来代替 String。

但是是否可以修改特定的对象，以及是否可以将不同的对象分配给变量，是完全不同的概念。一个是 String 对象的属性，另一个是 String 变量的属性，是对 String 对象的引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-17T17:08:41.653

请记住，[Java final 关键字](http://www.javamex.com/tutorials/synchronization_final.shtml)在这种情况下有两个用途：

*   这意味着不能将引用设置为另一个字符串——即您不能随后执行“name = ...”；
*   但至关重要的是，这意味着引用已**正确发布到其他线程**（有关更多详细信息，请参阅链接文章，或 Goetz 等人的作品，“Java Concurrency in Practice”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T17:06:53.480

您将 immutable 与 final 混淆了。

String 与 Integer 和 Long 一样，是一个不可变的类，因为内部数据通过封装被保护不被修改。

但是，就像 Ayman 所说，final 指的是指向字符串的指针。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T09:04:48.367

看看[final 关键字上的最后一句话](http://renaud.waldura.com/doc/java/final-keyword.shtml)。

```
String name = "scott";
name = "tiger"; // OK

final String gender = "male";
gender = "female"; // won't compile you cannot reassign gender cause it's final 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-11T06:44:25.257

如果一个变量被标记为**final**，那么该变量的值就不能改变，即**当与变量一起使用时final关键字使其成为一个常量。**如果您在程序执行过程中尝试更改该变量的值，编译器会给您一个错误。

**注意：** *如果将引用类型的变量标记为 final，则该变量不能引用任何其他对象。但是，您可以更改对象的内容，因为只有引用本身是最终的。*

来源：[Java 中的最终关键字](http://www.code2learn.com/2011/12/final-keyword-in-java.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-29T16:48:53.170

推断 String 对象默认为 Final 本身就是一个模糊的陈述。Java 的基础规定，如果一个实例变量没有指向一个内存位置，它就有资格进行垃圾收集。String 对象也会发生同样的事情。它们是不可变的，但它们的引用可以更改。为了克服这个问题，我们可以使用 "Final String s1 = "Final String" " 关键字不允许对 s1 进行任何赋值，除非在首次声明时，使其真正不可变。

```
public class DemoStringF 
{
    String s1; //Declaring an Instance Variable to type String. 

    public static void main(String... args)
    {
        DemoStringF d = new DemoStringF ();
        d.s1 = "Intializing s1 here"; //Initializing the s1

          System.out.println("Value ref. by s1 is " +d.s1); //Displays the String 
                                                            by which s1 is 
                                                            initialized.

         System.out.println("Value of s1 is " +d.s1.hashCode()); //Displays the 
                                                                 value of the s1.

         d.s1 = d.s1.concat(" Adding String to s1"); //Changing the value ref. by 
                                                       s1.
        System.out.println("Value ref. by s1 after concat() is " +d.s1); 
                                                    //Displays a new value of s1.

        System.out.println("Value of s1 is " +d.s1.hashCode()); //Displays 
                                                            the value of the s1.
    }

    } 
```

[![在此处输入图像描述](https://i.stack.imgur.com/oxHhh.png)](https://i.stack.imgur.com/oxHhh.png)

# winforms - NHibernate Win Forms 会话管理

> ID：874981
> 
> 赞同：9
> 
> 时间：2009-05-17T16:53:53.487
> 
> 标签：winforms, nhibernate, data-binding

我之前在 Web 应用程序中使用过 NHibernate。我必须承认我仍在学习 NHibernate，并没有完全掌握会话管理的艺术。所以我想在我正在编写的 Win Forms 应用程序中使用 NHibernate。我听说 Forms 应用程序中的会话管理有点不同。会话必须在对话的基础上打开和关闭。是的？有谁知道这方面的一个很好的例子？或者也许是一些有凝聚力的文档来解释在 win32 应用程序中创建和拆除会话？

谢谢，

缺口

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-17T17:13:44.067

已经建立了一种用于管理 WinForms 应用程序中的 NHibernate 会话的模式，称为**Conversation per business transaction**。可以在这里找到一个很好的描述：

[http://fabiomaulo.blogspot.com/2008/12/conversation-per-business-transaction.html](http://fabiomaulo.blogspot.com/2008/12/conversation-per-business-transaction.html) [http://fabiomaulo.blogspot.com/2009/01/using-conversation-per-business.html](http://fabiomaulo.blogspot.com/2009/01/using-conversation-per-business.html)

基本上它使用对话抽象：它可以开始、暂停、恢复、结束。每个操作都会进行自动会话和事务管理。我强烈推荐它，绝对值得一看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T17:06:06.630

这里有一些关于这个主题的[好](http://fgheysels.blogspot.com/2008/07/nhibernate-session-management.html) [建议。](http://blog.schuager.com/2009/03/rich-client-nhibernate-session.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T04:28:23.650

uNHAddins 支持 session-per-business-transaction。我们在 WinForms 应用程序上使用它。

[http://gustavoringel.blogspot.com/2009/02/unhaddins-persistence-conversation-part.html](http://gustavoringel.blogspot.com/2009/02/unhaddins-persistence-conversation-part.html)

# algorithm - 如何计算旅行商双调旅行的最佳路径？

> ID：874982
> 
> 赞同：15
> 
> 时间：2009-05-17T16:54:10.070
> 
> 标签：algorithm, graph, dynamic-programming

**更新**

经过更多阅读，可以使用以下递归关系给出解决方案：

```
(a) When i = 1 and j = 2, l(i; j) = dist(pi; pj )
(b) When i < j - 1; l(i; j) = l(i; j - 1) + dist(pj-1; pj)
(c) When i = j - 1 and j > 2, min 1<=k<i (l(k; i) + dist(pk; pj )) 
```

这现在开始变得有意义了，除了 C 部分。我将如何确定最小值 k？我想这意味着您可以遍历所有可能的 k 值并仅存储 ( l(k,i) + dist(pk,pj)?

* * *

是的，这绝对是我在学校学习的一个问题。我们正在研究旅行商问题的双调旅行。

无论如何，假设我有 5 个顶点 {0,1,2,3,4}。我知道我的第一步是按 x 坐标增加的顺序对它们进行排序。从那里开始，我对如何通过动态编程完成这一点有点困惑。

我正在阅读我应该扫描已排序节点的列表，并为两个部分（初始路径和返回路径）维护最佳路径。我对如何计算这些最佳路径感到困惑。例如，我如何知道是否应该在初始路径或返回路径中包含给定节点，因为它不能同时包含在两者中（端点除外）。回想一下动态编程中的斐波那契，你基本上从你的基本情况开始，然后继续前进。我想我要问的是如何开始解决双音旅行商问题？

对于像斐波那契数字这样的东西，动态规划方法非常清楚。但是，我不知道我是否只是过于密集或什么，但我很困惑试图解决这个问题。

感谢您的关注！

注意：我不是在寻找完整的解决方案，但至少有一些好的提示可以帮助我入门。例如，如果这是斐波那契问题，可以说明前几个数字是如何计算的。请让我知道如何改进这个问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-17T10:43:12.777

### 澄清你的算法。

递归函数应该计算访问所有小于 的节点的双调旅行的`l(i,j)`最小距离。因此，最初问题的解决方案将是！`i -> 1 -> j``i``l(n,n)`

重要笔记：

1.  我们可以假设节点按它们的 x 坐标排序并相应地标记 ( `p1.x < p2.x < p3.x ... < pn.x`)。如果它们没有被订购，我们可以`O(nlogn)`及时对它们进行分类。

2.  `l(i,j) = l(j,i)`. 原因是在 lhs 中，我们有一个`i ->...-> 1 -> ... -> j`最佳的游览。然而，向后遍历这条路线会给我们相同的距离，并且不会破坏双音特性。

现在是简单的案例（注意变化！）：

```
(a) When i = 1 and j = 2, l(i; j) = dist(pi; pj ) = dist(1,2) 
```

在这里，我们有以下游览：`1->1->...->2`。这相当于路径的长度`1->...->2`。由于点是按坐标排序的，和`.x`之间没有点，所以连接它们的直线将是最优的。（选择之前访问的任意数量的其他点会导致路径更长！）`1``2``2`

```
(b) When i < j - 1; l(i; j) = l(i; j - 1) + dist(pj-1; pj) 
```

在这种情况下，`j-1`必须在路径的一部分上`1 -> ... -> j`，因为该部分`i -> ... -> 1`不能包含索引大于 的节点`i`。因为路径中的所有节点都按索引的递增顺序排列，所以和`1 -> ... -> j`之间不能没有。所以，这相当于 tour: ，相当于!`j-1``j``i -> ... -> 1 -> .... -> j-1 -> j``l(i,j-1) + dist(pj-1,pj)`

Anf 最后有趣的部分来了：

```
(c) When i = j - 1 or i = j, min 1<=k<i (l(k; i) + dist(pk; pj )) 
```

在这里，我们知道我们必须从`i`to `1`，但没有关于后向扫描的线索！`j`这里的关键思想是我们必须在我们的反向路线上考虑之前的节点。它可能是从`1`到的任何节点`j-1`！让我们假设这个节点是`k`。现在我们有一个游览：`i -> ... -> 1 -> .... -> k -> j`，对吧？这次旅行的费用是`l(i,k) + dist(pk,pj)`。

希望你明白了。

### 执行。

您将需要一个二维数组 say `BT[1..n][1..n]`。设`i`行索引，`j`列索引。我们应该如何填写这张表？

在第一行我们知道`BT[1][1] = 0`, `BT[1][2] = d(1,2)`，所以我们只剩下属于该类别`i,j`的索引。`(b)`

在剩下的行中，我们从对角线到最后填充元素。

这是一个示例 C++ 代码（未经测试）：

```
void ComputeBitonicTSPCost( const std::vector< std::vector<int> >& dist, int* opt ) {
  int n = dist.size();
  std::vector< std::vector< int > > BT;
  BT.resize(n);
  for ( int i = 0; i < n; ++i )
    BT.at(i).resize(n);

  BT.at(0).at(0) = 0;  // p1 to p1 bitonic distance is 0
  BT.at(0).at(1) = dist.at(0).at(1);  // p1 to p2 bitonic distance is d(2,1)

  // fill the first row
  for ( int j = 2; j < n; ++j )
    BT.at(0).at(j) = BT.at(0).at(j-1) + dist.at(j-1).at(j);

  // fill the remaining rows
  int temp, min;  
  for ( int i = 1; i < n; ++i ) {
    for ( int j = i; j < n; ++j ) {
      BT.at(i).at(j) = -1;
      min = std::numeric_limits<int>::max();
      if ( i == j || i == j -1 ) {
        for( int k = 0; k < i; ++k ) {
          temp = BT.at(k).at(i) + dist.at(k).at(j);
          min = ( temp < min ) ? temp : min;
        }        
        BT.at(i).at(j) = min;        
      } else {
        BT.at(i).at(j) = BT.at(i).at(j-1) + dist.at(j-1).at(j);
      }
    }
  }

  *opt = BT.at(n-1).at(n-1);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T17:04:52.357

好的，动态规划解决方案中的关键概念是：

*   您预先计算较小的问题
*   你有一条规则可以让你结合较小的问题来为较大的问题找到解决方案
*   您具有问题的已知属性，可以证明解决方案在某种最优性度量下确实是最优的。（在这种情况下，最短。）

双调旅行的本质属性是坐标系中的一条垂直线最多穿过封闭多边形的一边两次。那么，什么是正好两点的双音之旅呢？显然，任何两点形成一个（退化的）双音巡演。三点有两个双调旅行（“顺时针”和“逆时针”）。

现在，您如何预先计算各种较小的双音旅行并将它们组合起来，直到您包含所有点并且仍然有双音旅行？

* * *

好的，您的更新走在了正确的轨道上。但是现在，在动态编程解决方案中，您如何处理它是*自下而上的*：预先计算和[记忆](http://en.wikipedia.org/wiki/Memoization)（而不是“记忆”）最优子问题。

# buffer - 使用 Python 2.6 从 Web 保存二进制文件的最节省内存的方法？

> ID：874988
> 
> 赞同：1
> 
> 时间：2009-05-17T16:56:17.090
> 
> 标签：buffer, binaryfiles, urllib, python-2.6

我正在尝试使用 Python 2.6 和 urllib 从网络下载（并保存）二进制文件。

据我了解，read()、readline() 和 readlines() 是读取类文件对象的 3 种方法。由于二进制文件并没有真正分成换行符，因此 read() 和 readlines() 将整个文件读入内存。

选择随机 read() 缓冲区大小是在此过程中限制内存使用的最有效方法吗？

IE

```
import urllib
import os

title = 'MyFile'
downloadurl = 'http://somedomain.com/myfile.avi'
webFile = urllib.urlopen(downloadurl)
mydirpath = os.path.join('c:', os.sep,'mydirectory',\
                         downloadurl.split('/')[-1])

if not os.path.exists(mydirpath):
    print "Downloading...%s" % title
    localFile = open(mydirpath, 'wb')
    data = webFile.read(1000000) #1MB at a time
    while data:
        localFile.write(data)
        data = webFile.read(1000000) #1MB at a time
    webFile.close()
    localFile.close()
    print "Finished downloading: %s" % title
else:
    print "%s already exists." % mydirypath 
```

我随意选择了 read(1000000) ，因为它可以工作并降低 RAM 使用率。我假设如果我正在使用原始网络缓冲区，则选择随机数量会很糟糕，因为如果传输速率太低，缓冲区可能会干涸。但似乎 urllib 已经在为我处理较低级别的缓冲。

考虑到这一点，选择任意数字好吗？有没有更好的办法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T17:05:56.630

你应该使用[`urllib.urlretrieve`](http://docs.python.org/library/urllib.html#urllib.urlretrieve)这个。它会为你处理一切。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T17:08:33.633

与其使用自己的读写循环，不如查看`shutil`模块。该`copyfileobj`方法将让您定义缓冲。最有效的方法因情况而异。即使将相同的源文件复制到相同的目的地也可能因网络问题而有所不同。

# wpf - 共享 WPF ControlTemplates

> ID：874998
> 
> 赞同：1
> 
> 时间：2009-05-17T17:01:37.570
> 
> 标签：wpf, controltemplate

我正在尝试了解有关 WPF 的更多信息。我浏览了一个在线教程，该教程创建了一个按钮，然后创建了一个模板以应用于其他按钮。问题是该模板位于 Window.xaml 中，我只能从该应用程序中访问该模板。如何使模板更全球化？我正在考虑某种方式来引用 xaml，就像您可以引用来自不同项目或解决方案的程序集一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T18:10:56.117

您可以像这样使用在 App.xaml 中引用的“资源字典”（Expression Blend 会自动执行）：

```
<Application.Resources>
    <!-- Resources scoped at the Application level should be defined here. -->
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="ResourceDictionary1.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

如何从另一个程序集引用资源，使用包 URI 语法。[这个链接](https://stackoverflow.com/questions/338056/wpf-resource-dictionary-in-a-separate-assembly)也涵盖了它。

# screenshot - 需要身份验证的网页截图问题

> ID：874999
> 
> 赞同：1
> 
> 时间：2009-05-17T17:03:01.203
> 
> 标签：screenshot

我正在制作对用户请求的 URL 进行屏幕截图的应用程序。当需要用户名和密码的网站有问题时，我想使其尽可能透明。

例如，如果用户想要截屏其 iGoogle 页面，他将发送服务器 URL，但是截屏将与他在屏幕上看到的不一样。

有没有办法做到这一点？我想在这种情况下，我将不得不实际向用户请求屏幕截图。也许用户甚至可以为我提供他的那个域的 cookie。

有什么想法吗 ？

泰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T19:54:02.147

是的，在大多数情况下，您需要用户的 cookie。

*如果*站点使用常规 cookie，您可以创建读取`document.cookie`. 这不适`httpOnly`用于越来越频繁地用于会话的 cookie。

一些站点将会话限制为特定 IP，在这种情况下，如果不通过用户计算机代理请求，您将无法截取屏幕截图。

如果您可以让用户使用 bookmarlet，一个有趣的技巧是读取 DOM 并将其发送到您的服务器：

```
image.src = 'http://example.com?source=' +
            escape(document.documentElement.innerHTML); 
```

对于 HTTP 身份验证，最简单的解决方案是询问用户登录名/密码。*************`````