# StackOverflow 问答 000317000-000317999

# oracle - 不使用触发器在 Oracle 中自动递增

> ID：317001
> 
> 赞同：23
> 
> 时间：2008-11-25T11:04:26.577
> 
> 标签：oracle, triggers, auto-increment, sequences

除了使用触发器之外，在 oracle 中实现自动增量的其他方法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-25T11:07:17.243

您可以创建和使用 oracle 序列。语法和详细信息位于 [http://www.techonthenet.com/oracle/sequences.php](http://www.techonthenet.com/oracle/sequences.php)

另请阅读文章 [http://rnyb2.blogspot.com/2006/02/potential-pitfall-with-oracle-sequence.html](http://rnyb2.blogspot.com/2006/02/potential-pitfall-with-oracle-sequence.html) 以了解其他 RDBMS 中关于 AUTONUMBER 的限制

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-25T11:53:37.943

如果您不需要序列号而只需要唯一 ID，则可以使用 SYS_GUID() 的默认值。IE：

```
CREATE TABLE xxx ( ID RAW(16) DEFAULT SYS_GUID() ) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-25T13:09:56.323

从序列中获取下一个值的触发器是实现等价于 AUTOINCREMENT 的最常见方法：

```
create trigger mytable_trg
before insert on mytable
for each row
when (new.id is null)
begin
    select myseq.nextval into :new.id from dual;
end; 
```

如果您控制插入，则不需要触发器 - 只需使用插入语句中的序列：

```
insert into mytable (id, data) values (myseq.nextval, 'x'); 
```

这可以隐藏在 API 包中，因此调用者不需要引用序列：

```
mytable_pkg.insert_row (p_data => 'x'); 
```

但是使用触发器更“透明”。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T11:13:17.573

据我在 Oracle 时代的回忆，不使用 TRIGGER 就无法实现自动增量列。任何用于制作自动增量列的解决方案都涉及 TRIGGER 和 SEQUENCE（我假设您已经知道这一点，因此没有触发备注）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T22:58:43.047

创建一个序列：

```
create sequence seq; 
```

然后添加一个值

```
insert into table (id, other1, other2)
values (seq.nextval, 'hello', 'world'); 
```

注意：查找 oracle 文档以获取有关序列的更多选项（起始值、增量，...）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-05T23:24:36.143

从 12c 开始，您可以使用[标识列](http://docs.oracle.com/cd/E16655_01/server.121/e17209/statements_7002.htm#CJAHCAFF)，它明确表和自动增量之间的链接；不需要触发器或序列。语法是：

```
create table <table_name> ( <column_name> generated as identity ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-05T11:01:29.930

除了例如 FerranB 的回答：
可能值得一提的是，与 auto_incement 在 MySQL 中的工作方式相反：

*   序列在数据库范围内工作，因此它们可以用于多个表，并且值对于整个数据库是唯一的*   因此：截断表不会重置“自动增量”功能

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-08T11:28:27.353

如果您真的不想使用“基于触发器”的解决方案，您可以通过编程的方式实现自增功能，通过该方法获取自增键的值`getGeneratedKeys()`。

以下是供您考虑的代码片段：

```
Statement stmt = null;
ResultSet rs = null;

stmt = conn.createStatement(java.sql.ResultSet.TYPE_FORWARD_ONLY,
                                java.sql.ResultSet.CONCUR_UPDATABLE);

stmt.executeUpdate("DROP TABLE IF EXISTS autoIncTable");

stmt.executeUpdate("CREATE TABLE autoIncTable ("
                + "priKey INT NOT NULL AUTO_INCREMENT, "
                + "dataField VARCHAR(64), PRIMARY KEY (priKey))");

stmt.executeUpdate("INSERT INTO autoIncTable  (dataField) "
                + "values ('data field value')",
                Statement.RETURN_GENERATED_KEYS);

int autoIncKeyFromApi = -1;

rs = stmt.getGeneratedKeys();

if (rs.next()) {
    autoIncKeyFromApi = rs.getInt(1);
}
else {
    // do stuff here        
}

rs.close(); 
```

来源： http: [//forums.oracle.com/forums/thread.jspa?messageID=3368856](http://forums.oracle.com/forums/thread.jspa?messageID=3368856)

* * *

## 回答 #9

> 赞同：-8
> 
> 时间：2008-12-01T12:42:10.280

```
SELECT max (id) + 1 
FROM   table 
```

# inno-setup - 如何在 Inno Setup 中重命名 ini 文件？

> ID：317002
> 
> 赞同：0
> 
> 时间：2008-11-25T11:04:40.943
> 
> 标签：inno-setup

我的安装程序中有这个，我需要更改 ini 文件的名称。

```
[INI]
Filename: {app}\bin\old.ini; Section: Data; Key: key; String: Value; 
```

如果我只是更改文件名，它将创建另一个 ini 文件，我会丢失数据。

有没有一些简单的方法可以在安装程序中重命名这个 ini 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T14:34:47.540

我认为您应该在 [CODE] 部分中使用 RenameFile() ，因为您知道 ini 文件在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T16:18:52.947

只是对 PhiLho 的回答更加冗长：

在安装程序的 [INI] 部分，只需将所有内容更改为新的 .ini 文件，然后在代码中重命名 ssInstall 步骤中的旧文件，如下所示：

```
procedure CurStepChanged(CurStep: TSetupStep);
var
  OldFile: string;
begin
  if CurStep = ssInstall then
  begin
    OldFile := ExpandConstant('{app}\old.ini');
    if FileExists(OldFile) then
      RenameFile(OldFile, ExpandConstant('{app}\new.ini'));
  end;
end; 
```

它按预期工作，因为 ssInstall 发生在 [INI] 部分之前，因此当安装程序尝试创建新的 .ini 文件时，旧的文件已经被重命名，并且它只会在必要时更新任何条目。

# asp.net-mvc - 所有极端情况的默认路线

> ID：317005
> 
> 赞同：2
> 
> 时间：2008-11-25T11:06:40.020
> 
> 标签：asp.net-mvc, url-routing

在我的路由中，我希望有类似未找到路由处理程序的东西。

例如，我创建了一个映射，例如

```
routes.MapRoute(
                     "default",
                     "{controller}/{action}/{id}",
                     new { controller = "Home", action = "Index", id="" }
             );

routes.MapRoute(
                     "Catchall",
                     "{*catchall}",
                     new { controller = "Home", action = "Lost" }
             ); 
```

但是当用户插入类似 /one/two/three/four/bla/bla 的地址时，它将与 Catchall 映射一起缓存。

但是当用户插入一些应该与默认映射匹配的东西时，（比如 /one/two/ ，但是这个控制器或动作没有实现）我希望 Catchall 映射能够接受这个请求，因为所有其他映射都失败了。但不是这个，我得到一个错误。

如果控制器或操作发生异常，我应该重写一些映射处理程序以捕获异常吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T11:13:06.450

这里的问题是确保“一/二”映射到*文件*不是路由的责任。这个责任落在了 ViewEngine 身上。由于“一/二”是有效*路线*，因此将被选中。

如果您想处理无效路由的错误，我建议您只需使用内置的 ErrorHandling“页面”来显示您将在 Catchall 中执行的任何消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T12:28:05.550

我认为这不是最好的解决方案，但您总是可以更具体地了解您的路线：

```
routes.MapRoute(
    "home and action",
    "home/index/{id}",
    new { controller = "Home", action = "Index", id="" }
); 
```

...重复您的其余操作...

```
routes.MapRoute(
    "article catch all",
    "home/{article}",
    new { controller = "Home", action = "ArticleSearcher", article="" }
); 
```

这将尝试匹配直接操作，如果未找到操作，则将通常是默认路由的 {action} 部分的内容作为文章字符串参数传递给“ArticleSearcher”操作。

缺点是必须显式创建每个控制器/动作路由。

# asp.net - ASP.NET 配置文件夹安全登录问题

> ID：317009
> 
> 赞同：0
> 
> 时间：2008-11-25T11:08:25.663
> 
> 标签：asp.net

*   我使用 ASP.NET 配置向导来设置 Web 用户。
*   然后我拒绝访问文件夹上的匿名用户。
*   这在本地有效。

*   但是，当我将我的网站上传到我的托管服务提供商时，在检查登录时它说它不能“访问 SQL Server 2005”。

*   我注意到向导创建了数据库文件：

    App_Data/ASPNETDB.MDF
    App_Data/aspnetdb_log.ldf

*   所以我假设网站上访问这些文件的权限不正确。

*   在我的 FileZilla FTP 客户端中，我将 App_Data 目录和其中的所有文件更改为 777，但它仍然出现“无法访问”错误。

以前有人遇到过问题吗？

**回答：** 谢谢Pradeep，我联系了我的提供商，他说使用在线文件管理器设置权限，这有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T11:14:32.093

请咨询您的托管服务提供商。确保他们支持 sql 数据库驱动程序。还要询问他们对 App_Data 文件夹的权限。检查这一点的一种方法是 - 尝试创建一个从数据库获取数据且不需要身份验证的页面。如果它有效，那么数据库驱动程序应该没有任何问题，并且它必须是权限问题。希望这可以帮助。

# xsd - SOAPUI：验证对 xsd 模式文件的响应

> ID：317017
> 
> 赞同：8
> 
> 时间：2008-11-25T11:11:54.283
> 
> 标签：xsd, wsdl, soapui

如何针对定义响应架构的 XSD 文件验证 SOAP 响应。我正在调用的 Web 服务有一个 XMLDocument 作为输入和输出，因此不能使用 WSDL 进行响应模式验证。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-01-09T22:37:11.330

我觉得你仍然需要这个（对于 SOAP UI 版本 2.5.1 有效）：文件、首选项、编辑器设置、验证响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-15T17:30:55.867

使用脚本断言：

def project = messageExchange.modelItem.testStep.testCase.testSuite.project

def wsdlcontext = project.getInterfaceAt(0).getDefinitionContext()

def 验证器 = 新 com.eviware.soapui.impl.wsdl.support.wsdl.WsdlValidator(wsdlcontext);

def 错误 = validator.assertRequest(messageExchange, false)

断言errors.length < 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-01T05:36:15.307

您可以使用 groovy 脚本来验证对 xsd 文件的响应。这是验证的方法

```
import javax.xml.transform.stream.StreamSource;
import javax.xml.validation.SchemaFactory;
import javax.xml.XMLConstants;

//Read your xsd file and get the conten into a variable like below.
def xsdContent = "Some Schema Standard";

//Take the response into another variable that you have to validate.
def actualXMLResponse = "Actual XML Response ";

//create a SchemaFactory object
def factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

//Create a given schema object with help of factory
def schema = factory.newSchema(new StreamSource(new StringReader(xsdContent ));

//Create a validator
def validator = schema.newValidator();

//now validate the actual response against the given schema
try {
     validator.validate(new StreamSource(new StringReader(actualXMLResponse )));

} catch(Exception  e) {
     log.info (e);
     assert false;
} 
```

我希望这能帮到您 ：-）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-11-09T15:24:58.960

这对我不起作用导致尝试不起作用

```
import javax.xml.transform.stream.StreamSource;
import javax.xml.validation.SchemaFactory;
import javax.xml.XMLConstants;

//Read your xsd file and get the conten into a variable like below.
// trim - XSD SCHEME no spaces
def xsdscheme = context.expand('${Properties-XSD_Scheme_Black_and_White#XSDSchemeWhite}')
def xsdscheme2 = xsdscheme.replace(' ', '')
xsdscheme2 = xsdscheme2.replaceAll("[\n\r]", "");
log.info "RES2 TRIMED " + xsdscheme2
def xsdContent = xsdscheme2;

//Take the response into another variable that you have to validate.

Res = context.expand('${#TestCase#WhiteListDecoded}');
def Res2 = Res.replace(' ', '')
Res2 = Res2.replaceAll("[\n\r]", "");
log.info "RES2 TRIMED " + Res2
def actualXMLResponse = Res2

//create a SchemaFactory object
def factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

//Create a given schema object with help of factory
def schema = factory.newSchema(new StreamSource(new StringReader(xsdContent ));

//Create a validator
def validator = schema.newValidator();

//now validate the actual response against the given schema
try {
     validator.validate(new StreamSource(new StringReader(actualXMLResponse )));

} catch(Exception  e) {
     log.info (e);
     assert false;
} 
```

# c# - 我可以使用扩展方法来实现接口吗？

> ID：317026
> 
> 赞同：5
> 
> 时间：2008-11-25T11:13:39.523
> 
> 标签：c#, .net

我想要一个类来实现一个接口，我不想更改原始类（这会添加不需要的依赖项）。

我知道我可以从该类继承并让它的子类实现这些方法，但是我遇到了如何将父类（来自数据/ORM）转换为这个表示类的问题。

如果我实现了所有接口所需的方法，它是否算作该接口？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-25T11:15:35.697

不，它仍然不能算作实现接口。

扩展方法只不过是一种以不同方式调用静态方法的方法。它们根本不影响对象身份、继承等。

# php - 面向对象的 MySQL 语句，PHP

> ID：317029
> 
> 赞同：0
> 
> 时间：2008-11-25T11:14:11.220
> 
> 标签：php, mysql, oop

到目前为止，我得到了下面的代码，它在尝试更新、删除或选择语句时很有效。但是，当我尝试使用插入时遇到问题。如果有人能指出我正确的方向，我将不胜感激。

```
private function escape($value)
{
    if(get_magic_quotes_gpc())
        $value = stripslashes($value);
    return mysql_real_escape_string($value, $this->dbConn);
}

/**
 * Handles connection to the database.
 * Die functions are used to catch any errors.
 */
public function connect($dbHost, $dbName, $dbUser, $dbPass)
{
    $this->dbConn = mysql_connect(
        $dbHost,
        $dbUser,
        $dbPass
    ) or die(mysql_error());
    mysql_select_db($dbName, $this->dbConn) or die(mysql_error());
}

/**
 * Loads a raw SQL string into the object $dbSql variable
 */
public function prep($sql)
{
    $this->dbSql = $sql;
}

/**
 * Load bound hooks and values into object variable
 */
public function bind($hook, $value)
{
    $this->dbBind[$hook] = $this->escape($value);

}

/**
 * Runs the SQL string in $dbSql object variable
 */
public function run()
{
    $sql = $this->dbSql;
    if(is_array($this->dbBind))
        foreach($this->dbBind as $hook => $value)
            $sql = str_replace($hook, "'" . $value . "'", $sql);  
    $this->dbQuery = mysql_query($sql) or die(mysql_error());
    $this->dbBind = array();
    return $this->numRows();
}

    // Load SQL statment into object
$MyDB->prep("INSERT INTO `demo` (`id`, `name`, `score`, `dept`, `date`) VALUES '1','James Kablammo', '1205550', 'Marketing', '$date'");
// Bind a value to our :id hook
// Produces: SELECT * FROM demo_table WHERE id = '23'
$MyDB->bind(':id',1);

// Run the query
$MyDB->run(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T11:17:18.470

从使用有效的插入语句开始可能会有所帮助。

```
VALUES ( a , b , c ) 
```

不是

```
VALUES a, b , c 
```

此外，为什么狄更斯将 perpared 插入与字符串替换结合起来？

你的意思是

$q->prep("blah blah blah VALUES (:date 等)");
$q->bind(":date", $date);

或类似的规定。使用这两种技术都是荒谬的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T11:16:51.763

您可能也应该将 values() 包装在括号中，例如：

```
$MyDB->prep("INSERT INTO `demo` (`id`, `name`, `score`, `dept`, `date`) VALUES ('1','James Kablammo', '1205550', 'Marketing', '$date'")); 
```

# web-applications - 如何在 Web 应用程序中捕获浏览器关闭事件？

> ID：317042
> 
> 赞同：1
> 
> 时间：2008-11-25T11:17:53.757
> 
> 标签：web-applications

当 Web 应用程序运行并关闭浏览器窗口时，会引发哪个事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T11:22:25.060

**onunload**是关闭浏览器窗口时引发的事件。

仅在关闭浏览器时才触发此事件，这只是一种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:17:17.950

在 Diodeus 指出的线程上查看我的回答：基本上，你不能......很多浏览器不再触发 onbeforeunload 和/或 onunload。即使他们这样做了，也很难区分页面重新加载、页面跳转和浏览器/窗口/选项卡关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T11:23:11.593

当用户关闭窗口时，Web 浏览器不会向 Web 服务器发送任何通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T11:26:49.683

您可能还对**onbeforeunload**感兴趣。

# open-source - 为什么你的公司不回馈开源？

> ID：317046
> 
> 赞同：11
> 
> 时间：2008-11-25T11:19:49.480
> 
> 标签：open-source

为开源做出贡献可以有多种形式：使用问题跟踪器、补丁、进一步开发、文档化、资助等。假设您的公司使用开源项目，那么您不回馈社区的最重要原因是什么?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-25T11:25:15.240

开发商花了我们钱。开源不花钱。因此，如果我们开始给开发人员时间来开发开源软件，那么开源就会失去其竞争优势，我们不妨给 MS 打个电话，因为至少我们可以预先确定它们花了我们多少钱。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-25T12:04:48.390

我们这样做，我们建立在开源基础上——但我想我们很特别；）

无论如何，这不像是对您问题的真正答案，而是对我猜其他答案中“问题”的答案。有很多方法可以为开源做出贡献。当然你可以贡献*代码*，但你可以贡献的另一件事是通过捐赠来获得*金钱*。几个月前，Jeff Atwood（SO 的创始人之一）在我知道的一个 wiki 系统系统上做了这个。

当我为之前的创业公司工作时，我们给了[WatiN](http://watin.sourceforge.net/) 300 美元。这是一个贡献，并且可能是一个更好（并且至少更便宜）的贡献，然后让我们的一个编码人员试图找出 WatiN 背后的代码模型和编码标准等，然后修复一些错误并提供补丁。

但是第三种“贡献”到你最喜欢的开源项目的方式更加微妙，但通常是你可以做出贡献的明确的*最佳*方式，即像我刚刚通过该链接对 WatiN 所做的那样给予*关注。*

我愿意花 100 美元让阅读此答案的人查看 WatiN 的链接，阅读该项目并下载它并开始在他们自己的测试套件中使用它。他们应该这样做，因为 WatiN 是一个*很棒的*开源项目，而背后的人 Jeroen 真的很有帮助！

这*也是*有贡献的。通过告诉其他人它有多棒来帮助您最喜欢的开源项目获得一些关注！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-25T12:36:24.253

我们确实在一种情况下回馈开源，如果不这样做是纯粹的精神错乱。当我们修复错误时，我们始终确保它们被推送到上游。

正如我所说，不这样做真的很疯狂，并且可以选择维护分叉。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-25T11:49:14.910

我们的管理层不了解开源。我不确定我们的老板是否理解我们正在使用 OSS 进行开发。

上次我们老板想把一些东西开源，但是这个包应该是捆绑了支持合同的，所以我不相信他真的知道开源是什么意思。

所以一句话：我们不回馈开源，因为我们的管理层不了解开源背后的概念。

**更新：**现在我们有一个操作系统产品，但我们的管理层直到今天才理解它。实际上我们做到了，因为我们的一些客户谈到了开源（而且真的是*免费的*）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-25T13:44:15.053

我们回馈补丁和错误修正。

不过，我们通常不会启动新项目。我们真的没有开销来支持这样的项目。不幸的是，您不能只在网站上发布 tarball 并期望陌生人为您的代码添加功能。建立一个社区需要付出努力。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-25T11:35:56.403

开发人员时间/团队资源，以及回馈代码的“适当性”。

这意味着，如果我们对 OSS 项目进行修改，有时这些更改不一定适合回馈项目。这可能是因为知识产权，但实际上，最常见的原因是我们根本没有预料到其他人会以我们制作的方式要求对软件进行如此具体的修改。所以一般来说，这样的补丁发回给开发 OSS 项目的团队是没有意义的。

在其他情况下，这些更改*可以*作为补丁发送给 OSS 项目开发人员，但这需要清理/重新格式化代码，从补丁中分离出私有公司数据等。通常，如果我们在 OSS 软件中使用一开始，我们并不关心这些事情，因为无论如何，大多数 OSS 软件在代码质量方面都有些肮脏（即，没有测试用例、编码标准、文档等）。因此，清理*我们*对已经脏代码的脏修复所需的时间通常比我们在这里为利他因素所花费的时间要多。

也就是说，我曾在那些*确实*在必要时回馈 OSS 项目的公司工作过，以及那些没有为某些 OSS 项目或发行版做出金钱贡献的公司。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-25T12:17:46.070

在我看来，最大的问题是大多数公司都在为项目做开发。如果一个项目开发了一些值得作为开源发布的东西，则只能在项目完成之前做出维护承诺。在那之后，没有更多的资源可用于进一步的开发、社区支持、错误修复等。这通常意味着开源“产品”的缓慢消亡。

此外，一些公司非常渴望看到他们发布的东西的公关，这通常意味着要通过所有的发布过程。这通常会让工程师和程序员不知所措。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-17T01:41:29.723

通过合法途径获得。说真的，即使作为开源软件的巨大贡献者，作为一家大公司，官僚主义也是一个杀手。（希望法律不要阅读此内容：）

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-25T20:53:27.463

我工作的公司生产专有软件，我们的软件高度专业化，是我们相对于业内所有其他公司的主要竞争优势。无法想象为什么我们不鼓励开源。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-25T11:40:45.847

没有开发人员的公司怎么办？也许他们不是软件组，而是使用 OSS 来省钱，*一个*使用 LAMP 但从不修改任何组件的基于 Web 的组？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-27T02:13:40.843

在我们的案例中，我们为州政府办公室的特定情况生产高度定制的软件。正因为如此，我们的软件对其他人没有任何效用。作为一个州办公室，我们也无权“捐赠”时间或金钱。

理论上，我们可以开源我们的一些文档，但再次缺乏需求只会使其成为一种空洞的姿态。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-25T11:58:14.487

商业逻辑。

如果我开始构建一个项目，我在其中使用 FLOSS 项目的**源代码**而不仅仅是一个库，那么我需要在开发时意识到两个因素：对代码的更改以使其执行我想要的操作**以及**我需要的那些方面将被允许​​向世界释放。

一般来说，这样做并不难，但如果截止日期很紧，那么我不会“*浪费*”时间剥离我们的专有扩展。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-16T21:09:13.097

程序员让我们花钱，但为开源做贡献并不会产生一分钱的收入。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-06T07:50:26.117

我们确实做出了贡献，并为此感到非常自豪！

[http://hg.nuxeo.org/opensocial](http://hg.nuxeo.org/opensocial)是关于我们对 Leroy Merlin 对 Nuxeo 的贡献。

好吧，我没有产生一分钱的收入，但它并没有真正花费更多。当人们为我们的代码做出贡献时（补丁、错误修复、扩展），这将是我们不会花费任何成本的代码。

此外，我们的贡献现在包含在 Nuxeo 的核心功能中，因此现在我们将受益于供应商认证的代码集成。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-06T08:06:25.227

我不确定捐款是否是帮助开源软件的最佳方式。当 Jeff Atwood 给一个开源项目大约 5000 美元时，该项目的负责人很感激……但如果我没记错的话，他不太确定如何处理它。

为开源项目做出贡献的开发人员不会获得报酬。他们这样做是因为他们喜欢它，想向自己证明一些东西，等等……但金钱永远不是原因，因为他们知道他们可能不会赚到一角钱。充其量，他们可能会吸引注意力，然后可能会产生收入（想想新雇主，他们博客的更多流量等......）

现在，我并不是说一个人不应该贡献，但我认为货币贡献并不像人们想象的那么有效，公司倾向于认为他们的模式（资本主义）自然会扩展到他们周围的一切：/

在我看来，一个开源项目从补丁/错误报告中受益比直接的金钱贡献更多，例外是托管项目的网站/存储库或为顶级贡献者提供资金会议，以便他们可以在需要时面对面讨论，但是虽然这要花钱，但这并不是直接给钱。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-06T08:08:44.223

尽管我们确实以代码补丁的形式回馈开源，并发布开源软件，但我可以理解为什么其他公司不这样做。因为“它没有任何利润”:)

# random - 随机数生成器：类级别还是方法级别？

> ID：317047
> 
> 赞同：2
> 
> 时间：2008-11-25T11:21:08.400
> 
> 标签：random, correctness

使用随机数生成器时，这是使用它来获得新值更大随机性的更好方法：

1.  有一个方法可以每次实例化一个新的 RNG 实例然后返回一个值吗？

2.  在类级别有一个 RNG 实例，它在构造函数中实例化一次，并且所有后续调用都使用现有实例来调用新的随机值？

问题是可能有很多对随机数的调用，通常在不同的范围内，彼此没有联系。

这不是性能问题，因此每个调用都可能实例化一个新实例这一事实没有任何区别。这都是关于返回值的随机性。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T11:24:31.607

实际上，选项 1 不起作用。

选项 2 是唯一的选择。RNG 绝对要求您从单个种子按顺序生成值。

您的“用新种子创建新生成器”打破了数学基础。你得到什么完全取决于你的种子，遗憾的是——这不会是随机的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T11:36:56.167

我建议选项 3：在整个程序中使用单个 RNG。如果 RNG 不是线程安全的（例如在 .NET 中），它需要锁定或线程本地，但它使生活变得更简单，您无需担心重复。

有关我为此目的编写的 .NET StaticRandom 类的详细信息，请参阅[相关的 MiscUtil 页面。](http://pobox.com/~skeet/csharp/miscutil/usage/staticrandom.html)（这非常简单——一点也不聪明。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T11:43:10.290

编辑：*我相信我的意思是选项 3，正如另一个答案中提到的，即全局随机管理器，尽管在特定类中你可以做完全相同的事情。*

使用选项 2 的另一个优点是，如果您在软件中需要“重播”功能，您可以简单地存储用于初始化 RNG 的种子。下一次，您只需要强制 RNG 使用存储的种子，您将获得完全相同的行为集，*假设没有其他问题，例如可能改变执行顺序的并发/线程*。

如果您的软件正在运行需要大量随机性的实验，但您可能希望重复特定的运行以向其他人展示，您可能想要执行类似的操作。它在电脑游戏中也被大量使用，人工智能将根据可能选择的权重做出决定，但最终会有一个随机数“挑选”他们采取的行动。

它还可以对仅偶尔出现的临时错误进行调试。如果您不存储每次运行的种子，则无法重新创建导致错误的确切条件。

# html - 提取标签属性的正则表达式

> ID：317053
> 
> 赞同：64
> 
> 时间：2008-11-25T11:22:53.747
> 
> 标签：html, regex

我正在尝试提取锚标记 ( `<a>`) 的属性。到目前为止，我有这个表达：

```
(?<name>\b\w+\b)\s*=\s*("(?<value>[^"]*)"|'(?<value>[^']*)'|(?<value>[^"'<> \s]+)\s*)+ 
```

这适用于像这样的字符串

```
<a href="test.html" class="xyz"> 
```

和（单引号）

```
<a href='test.html' class="xyz"> 
```

但不适用于没有引号的字符串：

```
<a href=test.html class=xyz> 
```

如何修改我的正则表达式使其与不带引号的属性一起使用？还是有更好的方法来做到这一点？

**更新：** *感谢到目前为止所有好的评论和建议。有一件事我没有提到：遗憾的是，我不得不修补/修改不是我编写的代码。而且没有时间/金钱从下往上重写这些东西。*

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-11-25T11:37:43.623

2021 年更新：[Radon8472](https://stackoverflow.com/users/2377961/radon8472)在[评论](https://stackoverflow.com/questions/317053/regular-expression-for-extracting-tag-attributes/317081?noredirect=1#comment121192951_317081)中提出了正则表达式[https://regex101.com/r/tOF6eA/1](https://regex101.com/r/tOF6eA/1)（`regex101.com`当我最初写这个答案时，注释不存在）

```
<a[^>]*?href=(["\'])?((?:.(?!\1|>))*.?)\1? 
```

更新 2021 之二：[Dave在](https://stackoverflow.com/users/1081918/dave)[评论](https://stackoverflow.com/questions/317053/regular-expression-for-extracting-tag-attributes/317081#comment122184813_317081)中建议考虑包含等号的属性值，例如`<img src="test.png?test=val" />`，如在[此 regex101](https://regex101.com/r/ypPqjy/1)中：

```
(\w+)=["']?((?:.(?!["']?\s+(?:\S+)=|\s*\/?[>"']))+.)["']? 
```

* * *

更新（2020 年），[Gyum Fox](https://stackoverflow.com/users/1010492/gyum-fox)提出[https://regex101.com/r/U9Yqqg/2](https://regex101.com/r/U9Yqqg/2)（同样，当我最初写这个答案时，注释`regex101.com`不存在）

```
(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|\s*\/?[>"']))+.)["']? 
```

应用于：

```
<a href=test.html class=xyz>
<a href="test.html" class="xyz">
<a href='test.html' class="xyz">
<script type="text/javascript" defer async id="something" onload="alert('hello');"></script>
<img src="test.png">
<img src="a test.png">
<img src=test.png />
<img src=a test.png />
<img src=test.png >
<img src=a test.png >
<img src=test.png alt=crap >
<img src=a test.png alt=crap > 
```

* * *

原始答案（2008）：如果你有一个像

```
<name attribute=value attribute="value" attribute='value'> 
```

此正则表达式可用于连续查找每个属性名称和值

```
(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))+.)["']? 
```

应用于：

```
<a href=test.html class=xyz>
<a href="test.html" class="xyz">
<a href='test.html' class="xyz"> 
```

它会产生：

```
'href' => 'test.html'
'class' => 'xyz' 
```

> **注意：**这不适用于数字属性值，例如`<div id="1">`不起作用。
> 
> **已编辑：**改进了正则表达式，用于获取没有值的属性和内部带有“'”的值。

```
([^\r\n\t\f\v= '"]+)(?:=(["'])?((?:.(?!\2?\s+(?:\S+)=|\2))+.)\2?)? 
```

应用于：

```
<script type="text/javascript" defer async id="something" onload="alert('hello');"></script> 
```

它会产生：

```
'type' => 'text/javascript'
'defer' => ''
'async' => ''
'id' => 'something'
'onload' => 'alert(\'hello\');' 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-26T00:39:10.147

尽管不通过正则表达式解析 HTML 的建议是有效的，但这里的表达式几乎可以满足您的要求：

```
/
   \G                     # start where the last match left off
   (?>                    # begin non-backtracking expression
       .*?                # *anything* until...
       <[Aa]\b            # an anchor tag
    )??                   # but look ahead to see that the rest of the expression
                          #    does not match.
    \s+                   # at least one space
    ( \p{Alpha}           # Our first capture, starting with one alpha
      \p{Alnum}*          # followed by any number of alphanumeric characters
    )                     # end capture #1
    (?: \s* = \s*         # a group starting with a '=', possibly surrounded by spaces.
        (?: (['"])        # capture a single quote character
            (.*?)         # anything else
             \2           # which ever quote character we captured before
        |   ( [^>\s'"]+ ) # any number of non-( '>', space, quote ) chars
        )                 # end group
     )?                   # attribute value was optional
/msx; 
```

“但是等等，”你可能会说。“那*评论呢？！？！” 好的，那么您可以将`.`非回溯部分中的 替换为：（它还处理 CDATA 部分。）

```
(?:[^<]|<[^!]|<![^-\[]|<!\[(?!CDATA)|<!\[CDATA\[.*?\]\]>|<!--(?:[^-]|-[^-])*-->) 
```

*   此外，如果您想在 Perl 5.10 下运行替换（我认为是 PCRE），您可以将其放在`\K`属性名称之前，而不必担心捕获您想要跳过的所有内容。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-25T11:33:25.083

Token Mantra 响应：您不应使用正则表达式调整/修改/收获/或以其他方式生成 html/xml。

也可能存在必须考虑的极端情况条件，例如 \' 和 \"。您最好使用适当的 DOM Parser、XML Parser 或许多其他经过试验和测试的工具之一来代替这项工作发明你自己的。

我真的不在乎你使用哪一个，只要它被认可、测试过并且你使用一个。

```
my $foo  = Someclass->parse( $xmlstring ); 
my @links = $foo->getChildrenByTagName("a"); 
my @srcs = map { $_->getAttribute("src") } @links; 
# @srcs now contains an array of src attributes extracted from the page. 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-22T14:05:23.860

您不能对多个捕获使用相同的名称。因此，您不能在具有命名捕获的表达式上使用量词。

所以要么不要使用命名捕获：

```
(?:(\b\w+\b)\s*=\s*("[^"]*"|'[^']*'|[^"'<>\s]+)\s+)+ 
```

或者不要在这个表达式上使用量词：

```
(?<name>\b\w+\b)\s*=\s*(?<value>"[^"]*"|'[^']*'|[^"'<>\s]+) 
```

这也允许像这样的属性值`bar=' baz='quux`：

```
foo="bar=' baz='quux" 
```

那么缺点是你必须在之后去除前导和尾随引号。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-25T12:43:23.117

只是同意其他人的观点：不要使用正则表达式解析 HTML。

不可能创建一个表达式，即使是正确的 HTML 片段也能挑选出属性，更不用说所有可能的格式错误的变体了。即使没有尝试处理无效的引号缺失，您的正则表达式已经非常难以理解；进一步追寻现实世界 HTML 的恐怖，你会被一大堆无法维护的不可靠表达式逼疯。

现有的库可以读取损坏的 HTML，或者将其更正为有效的 XHTML，然后您可以使用 XML 解析器轻松吞食这些库。使用它们。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-07-11T11:05:03.873

## PHP (PCRE) 和 Python

简单的属性提取（[看到它的工作](https://regex101.com/r/TusJNc/1)）：

```
((?:(?!\s|=).)*)\s*?=\s*?["']?((?:(?<=")(?:(?<=\\)"|[^"])*|(?<=')(?:(?<=\\)'|[^'])*)|(?:(?!"|')(?:(?!\/>|>|\s).)+)) 
```

或者使用标签打开/关闭验证、标签名称检索和评论转义。此表达式预见到不带引号的/带引号的、单引号/双引号、属性内的转义引号、等号周围的空格、不同数量的属性、仅检查标签内的属性以及管理属性值内的不同引号。（[看到它工作](https://regex101.com/r/wRD0zq/1)）：

```
(?:\<\!\-\-(?:(?!\-\-\>)\r\n?|\n|.)*?-\-\>)|(?:<(\S+)\s+(?=.*>)|(?<=[=\s])\G)(?:((?:(?!\s|=).)*)\s*?=\s*?[\"']?((?:(?<=\")(?:(?<=\\)\"|[^\"])*|(?<=')(?:(?<=\\)'|[^'])*)|(?:(?!\"|')(?:(?!\/>|>|\s).)+))[\"']?\s*) 
```

（使用“gisx”标志效果更好。）

* * *

## Javascript

由于`Javascript`正则表达式不支持look-behinds，它不支持我建议的先前表达式的大多数功能。但如果它可能适合某人的需要，你可以试试这个版本。（[看到它工作](https://regex101.com/r/MB8lFa/1)）。

```
(\S+)=[\'"]?((?:(?!\/>|>|"|\'|\s).)+) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-10-07T23:54:21.833

***这是我在 HTML 标签中提取属性的最佳正则表达式：***

# 修剪引号内的匹配项（单引号或双引号）

```
(\S+)\s*=\s*([']|["])\s*([\W\w]*?)\s*\2 
```

# 没有修剪

```
(\S+)\s*=\s*([']|["])([\W\w]*?)\2 
```

优点：

*   您可以修剪引号内的内容。
*   匹配引号内的所有特殊 ASCII 字符。
*   如果您有 title="You're mine"，则 RegEx 不会损坏

缺点：

*   它返回3组；首先是属性，然后是引号（“|'），最后是引号内的属性，即：`<div title="You're">`结果是第 1 组：标题，第 2 组：“，第 3 组：你是。

这是在线 RegEx 示例： [https ://regex101.com/r/aVz4uG/13](https://regex101.com/r/aVz4uG/13)

* * *

* * *

***我通常使用这个 RegEx 来提取 HTML 标签：***

如果您不使用, 等标签类型`<div`，我建议您这样做。`<span`

```
<[^/]+?(?:\".*?\"|'.*?'|.*?)*?> 
```

例如：

```
<div title="a>b=c<d" data-type='a>b=c<d'>Hello</div>
<span style="color: >=<red">Nothing</span>
# Returns 
# <div title="a>b=c<d" data-type='a>b=c<d'>
# <span style="color: >=<red"> 
```

这是在线 RegEx 示例： [https ://regex101.com/r/aVz4uG/15](https://regex101.com/r/aVz4uG/15)

***此 RegEx 中的错误是：***

```
<div[^/]+?(?:\".*?\"|'.*?'|.*?)*?> 
```

在这个标签中：

```
<article title="a>b=c<d" data-type='a>b=c<div '>Hello</article> 
```

返回`<div '>`但不应返回任何匹配项：

```
Match:  <div '> 
```

要“解决”此问题，请删除`[^/]+?`模式：

```
<div(?:\".*?\"|'.*?'|.*?)*?> 
```

* * *

* * *

答案 # [317081](https://stackoverflow.com/a/317081/1727383)很好，但与以下情况不匹配：

```
<div id="a"> # It returns "a instead of a
<div style=""> # It doesn't match instead of return only an empty property
<div title = "c"> # It not recognize the space between the equal (=) 
```

***这是改进：***

```
(\S+)\s*=\s*["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))?[^"']*)["']? 
```

对比

```
(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))+.)["']? 
```

避免相等信号之间的空格： (\S+) **\s*** = **\s*** ((?:...

更改最后一个 + 和 . 对于：|[>"'])) **?[^"']*** )["']?

这是在线 RegEx 示例： [https ://regex101.com/r/aVz4uG/8](https://regex101.com/r/aVz4uG/8)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-11-29T03:44:12.127

飞溅，

@VonC 解决方案部分有效，但如果标签混合了未引用和引用，则会出现一些问题

这个适用于混合属性

```
$pat_attributes = "(\S+)=(\"|'| |)(.*)(\"|'| |>)" 
```

测试一下

```
<?php
$pat_attributes = "(\S+)=(\"|'| |)(.*)(\"|'| |>)"

$code = '    <IMG title=09.jpg alt=09.jpg src="http://example.com.jpg?v=185579" border=0 mce_src="example.com.jpg?v=185579"
    ';

preg_match_all( "@$pat_attributes@isU", $code, $ms);
var_dump( $ms );

$code = '
<a href=test.html class=xyz>
<a href="test.html" class="xyz">
<a href=\'test.html\' class="xyz">
<img src="http://"/>      ';

preg_match_all( "@$pat_attributes@isU", $code, $ms);

var_dump( $ms ); 
```

然后 $ms 将包含第二个和第三个元素的键和值。

```
$keys = $ms[1];
$values = $ms[2]; 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-06-17T16:14:37.767

HTML 中的标签和属性具有以下形式

```
<tag 
   attrnovalue 
   attrnoquote=bli 
   attrdoublequote="blah 'blah'"
   attrsinglequote='bloob "bloob"' > 
```

要匹配属性，您需要一个`attr`查找四种形式之一的正则表达式。然后您需要确保仅在 HTML 标记中报告匹配项。假设您有正确的正则表达式，总的正则表达式将是：

```
attr(?=(attr)*\s*/?\s*>) 
```

前瞻确保只有其他属性和结束标记跟随该属性。我使用以下正则表达式`attr`：

```
\s+(\w+)(?:\s*=\s*(?:"([^"]*)"|'([^']*)'|([^><"'\s]+)))? 
```

不重要的组不被捕获。第一个匹配组`$1`为您提供属性的名称，值为 `$2`or`$3`或之一`$4`。我`$2$3$4`用来提取价值。最终的正则表达式是

```
\s+(\w+)(?:\s*=\s*(?:"([^"]*)"|'([^']*)'|([^><"'\s]+)))?(?=(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^><"'\s]+))?)*\s*/?\s*>) 
```

注意：我在前瞻中删除了所有不必要的组，并使所有剩余的组不被捕获。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-25T11:27:38.450

我建议您使用[HTML Tidy](http://tidy.sourceforge.net/)将 HTML 转换为 XHTML，然后使用合适的 XPath 表达式提取属性。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-07-21T20:52:16.703

这样的事情可能会有所帮助

```
'(\S+)\s*?=\s*([\'"])(.*?|)\2 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-25T11:30:20.627

如果您想通用，则必须查看 a 标签的精确规范，例如[此处](http://www.w3.org/TR/REC-html40/struct/links.html#h-12.2)。但即便如此，如果您使用完美的正则表达式，如果您的 html 格式不正确怎么办？

我建议去一个库来解析 html，这取决于你使用的语言：例如 python 的 Beautiful Soup。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-25T11:36:27.807

如果你在 .NET 中，我推荐 HTML 敏捷包，即使是格式错误的 HTML，它也非常健壮。

然后您可以使用 XPath。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-25T11:40:02.917

我会重新考虑只使用一个正则表达式的策略。当然，想出一个可以完成所有工作的正则表达式是一款不错的游戏。但是就可维护性而言，您将要双脚射击自己。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-11-27T10:48:12.040

我也需要这个并写了一个解析属性的函数，你可以从这里得到它：

[https://gist.github.com/4153580](https://gist.github.com/4153580)

（注意：它不使用正则表达式）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-02-01T16:26:16.883

我创建了一个[PHP 函数](https://gist.github.com/tovic/b3b683f28d899e19f830)，可以提取任何 HTML 标记的属性。它还可以处理`disabled`没有值的属性，也可以通过检查结果来确定标签是独立标签（没有结束标签）还是不是（有结束标签）`content`：

```
/*! Based on <https://github.com/mecha-cms/cms/blob/master/system/kernel/converter.php> */
function extract_html_attributes($input) {
    if( ! preg_match('#^(<)([a-z0-9\-._:]+)((\s)+(.*?))?((>)([\s\S]*?)((<)\/\2(>))|(\s)*\/?(>))$#im', $input, $matches)) return false;
    $matches[5] = preg_replace('#(^|(\s)+)([a-z0-9\-]+)(=)(")(")#i', '$1$2$3$4$5<attr:value>$6', $matches[5]);
    $results = array(
        'element' => $matches[2],
        'attributes' => null,
        'content' => isset($matches[8]) && $matches[9] == '</' . $matches[2] . '>' ? $matches[8] : null
    );
    if(preg_match_all('#([a-z0-9\-]+)((=)(")(.*?)("))?(?:(\s)|$)#i', $matches[5], $attrs)) {
        $results['attributes'] = array();
        foreach($attrs[1] as $i => $attr) {
            $results['attributes'][$attr] = isset($attrs[5][$i]) && ! empty($attrs[5][$i]) ? ($attrs[5][$i] != '<attr:value>' ? $attrs[5][$i] : "") : $attr;
        }
    }
    return $results;
} 
```

### 测试代码

```
$test = array(
    '<div class="foo" id="bar" data-test="1000">',
    '<div>',
    '<div class="foo" id="bar" data-test="1000">test content</div>',
    '<div>test content</div>',
    '<div>test content</span>',
    '<div>test content',
    '<div></div>',
    '<div class="foo" id="bar" data-test="1000"/>',
    '<div class="foo" id="bar" data-test="1000" />',
    '< div  class="foo"     id="bar"   data-test="1000"       />',
    '<div class id data-test>',
    '<id="foo" data-test="1000">',
    '<id data-test>',
    '<select name="foo" id="bar" empty-value-test="" selected disabled><option value="1">Option 1</option></select>'
);

foreach($test as $t) {
    var_dump($t, extract_html_attributes($t));
    echo '<hr>';
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-11-30T14:55:44.200

这对我有用。它还考虑了我遇到的一些最终情况。

我正在将此 Regex 用于 XML 解析器

```
(?<=\s)[^><:\s]*=*(?=[>,\s]) 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2012-09-18T10:03:53.110

提取元素：

```
var buttonMatcherRegExp=/<a[\s\S]*?>[\s\S]*?<\/a>/;
htmlStr=string.match( buttonMatcherRegExp )[0] 
```

然后使用 jQuery 来解析和提取你想要的位：

```
$(htmlStr).attr('style') 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2015-06-26T13:17:03.753

看看这个 [Regex & PHP - 从 img 标签中隔离 src 属性](https://stackoverflow.com/questions/2120779/regex-php-isolate-src-attribute-from-img-tag?answertab=active)

也许您可以遍历 DOM 并获得所需的属性。它对我来说很好，从 body-tag 获取属性

# c# - 如何从父级转换为子级？

> ID：317058
> 
> 赞同：0
> 
> 时间：2008-11-25T11:26:09.247
> 
> 标签：c#, .net

我的域模型中有一个名为

```
JobPlan 
```

此类通过 ORM 存储/检索并在各个地方使用。

我正在创建一个显示此类的树列表的视图，并且树列表需要此类来实现某些接口（该接口来自第 3 方库）。但是，将接口添加到 JobPlan 类将强制使用此类的所有程序集也引用第三方控件。这并不理想。

我正在考虑拥有一个

```
JobPlanPresenter 
```

这将简单地继承 JobPlan 并实现接口的方法。这将导致我遇到一个问题，即如何将 JobPlan（父级）转换为 JobPlanPresenter 子级。我显然可以创建一个转换器类，它可以简单地将所有字段从父类复制到子类，但这对我来说似乎是一个非常丑陋的黑客，这也会杀死原始对象等的所有更新。

你认为还有另一种方法吗？我完全错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T11:53:52.360

一种解决方案是让 JobPlanPresenter 持有对 JobPlan 的引用。那么 JobPlanPresenter 只是 JobPlan 的一个包装器，它引用了 JobPlan 和 JobPlan 的子 JobPlanPresenter 包装器。

# iphone - 优化 iPhone 应用程序启动时间

> ID：317062
> 
> 赞同：17
> 
> 时间：2008-11-25T11:27:10.417
> 
> 标签：iphone, cocoa-touch

任何拥有 iPhone 的人都知道，一些应用程序启动速度很快，而另一些则需要几秒钟。

确保 iPhone 应用程序启动并快速可用的最佳技术是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-25T11:38:01.423

Apple 建议您“延迟加载”每个视图。即仅在启动时加载第一页，仅在导航到其他页面时加载。

在图形方面，尽可能使用 PNG，因为设备已针对这种格式进行了大量优化。

还包括启动屏幕截图，以便用户知道应用程序正在加载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T11:36:56.760

我使用了大量的外部资源，所以我使用延迟加载来快速启动和运行。这样，APP 可以从最低限度开始，然后在已经开始时加载其余部分。

在开始时间上有很大的不同

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T14:21:36.023

这是没有万无一失的成功之路的事情之一。使用 Apple 出色的 Instruments 工具来监控您的应用程序的启动。然后，您需要深入研究结果以找出优化启动过程的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-30T21:08:46.610

还可以尝试使用 Shark 进行分析，以发现任何性能瓶颈。

[http://developer.apple.com/iphone/library/documentation/DeveloperTools/Conceptual/SharkUserGuide/Introduction/Introduction.html](http://developer.apple.com/iphone/library/documentation/DeveloperTools/Conceptual/SharkUserGuide/Introduction/Introduction.html)

# sharepoint - SharePoint - 自定义数据视图 - 链接呈现问题

> ID：317067
> 
> 赞同：1
> 
> 时间：2008-11-25T11:30:27.867
> 
> 标签：sharepoint, sharepoint-2007

我有一个包含多个数据视图的自定义 SharePoint 页面。数据视图实质上是从文档库中过滤符合特定标准的文档，并显示指向该文档的链接以及其他一些元数据。

我遇到的问题是，当文档的标题中有单引号时，该字符被呈现为 ' 并使链接无效。这是我的自定义页面中显示无效链接的代码。

```
<A onfocus="OnLink(this)" HREF="{@FileRef}" onclick="return DispEx(this,event,'','','','','{ddwrt:ListProperty(&quot;DefaultItemOpen&quot;)}','{ddwrt:MapToControl(&quot;&quot;, string())}','{@HTML_x0020_File_x0020_Type}','','{ddwrt:GetUserID('CheckoutUser')}','{$Userid}','{ddwrt:ListProperty(&quot;ForceCheckout&quot;)}','{$FieldIDA5KNTB}','{ddwrt:CurrentRights()}')"><xsl:value-of select="ddwrt:UrlBaseName(string(@LinkFilename))" /></A> 
```

有人对如何确保 @FileRef 变量在渲染之前正确编码有任何想法吗？

提前谢谢了 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T14:32:32.367

你需要使用 ServerURL 或 EncodedAbsUrl 属性，这家伙已经写出来了：

[Itay Shakury 的博客](http://blogs.microsoft.co.il/blogs/itaysk/archive/2008/07/25/sharepoint-designer-data-form-web-part-apostrophe-bug.aspx)

# javascript - Javascript：如何确定链接是否指向与其所在页面相同的域？

> ID：317070
> 
> 赞同：8
> 
> 时间：2008-11-25T11:33:27.017
> 
> 标签：javascript, cross-browser, hyperlink

为了通过谷歌分析跟踪非 HTML 文档，我需要提到的算法。它应该：

*   不对域进行硬编码
*   忽略协议（即http/https）
*   不用担心“www”的存在/不存在（任何绝对链接都将以“www”为前缀，所有页面都将通过“www”提供）

这很复杂，因为我需要通过仅 IE 的“attachEvent”调用的函数来访问它。

**更新**对不起，我对这个问题的措辞*非常*糟糕。真正的问题是通过事件让它工作，因为 IE 有自己的事件处理世界。采取以下措施：

```
function add_event(obj) {
    if (obj.addEventListener)
        obj.addEventListener('click', track_file, true);
    else if (obj.attachEvent)
        obj.attachEvent("on" + 'click', track_file);
}

function track_file(obj) { } 
```

似乎 track_file 中的“obj”在浏览器中是不一样的——我如何才能引用在 IE 中单击的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T11:59:41.443

我想指出，如果您在 so.com 上，以下链接是同一域中的 URL：

*   [http://test.so.com](http://test.so.com)
*   [http://so.com/index](http://so.com/index)
*   指数
*   /指数
*   #
*   /#
*   [https://subdomain.so.com#hash](https://subdomain.so.com#hash)
*   mail.google.com
*   mail.google.com/index.php?var=value#index

（这可能看起来很奇怪，但最后两个是有效的：如果您在[http://so.com](http://so.com)上，最后一个会将您带到[http://so.com/mail.google.com/index。 php?var=value](http://so.com/mail.google.com/index.php?var=value)，这是完全有效的）

这并不能真正回答问题，但我希望它能指导其余的答案。如果还有什么奇怪的地方，欢迎补充。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T12:21:28.417

这听起来像是一个喜剧答案，但说真的，建议您也可以执行以下操作：

```
$('a.external') 
```

当然，正则表达式与您的 window.location 的比较是程序化的答案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T12:35:47.813

附加方法并不是 IE 和 W3 事件侦听器不同的唯一方式。对于 IE，您必须阅读 window.event.srcElement；在 W3 中它是 event.target，其中 event 是传递给回调函数的参数。

如果您不需要链接上的多个事件处理程序，老式的 DOM 0 事件处理程序可能是您处理此问题的更简单方法，允许您只使用“this”即可在任何浏览器上获取对象。

```
function bindtolinks() {
    for (var i= document.links.length; i-->0;)
        document.links.onclick= clicklink;
}

function clicklink() {
    if (this.host==window.location.host) {
        dosomething();
        return true; // I'm an internal link. Follow me.
    } else {
        dosomethingelse();
        return false; // I'm an external link. Don't follow, only do something else.
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T12:36:54.877

我将在更新中回答有关 IE 事件的问题：

```
function track_file(evt)
{
  if (evt == undefined)
  {
    evt = window.event; // For IE
  }
  // Use evt
} 
```

是跨浏览器获取一致事件对象的经典方法。

在那之后，我会使用正则表达式来规范化 URL，但我不确定你在看什么。

[编辑] 一些真正的代码可以将我上面写的内容付诸实践...... :-)

```
function CheckTarget(evt)
{
  if (evt == undefined)
  {
    // For IE
    evt = window.event;
//~     event.returnValue = false;
    var target = evt.srcElement;
    var console = { log: alert };
  }
  else
  {
    target = evt.target;
//~     preventDefault();
  }
  alert(target.hostname + " vs. " + window.location.hostname);
  var re = /^https?:\/\/[\w.-]*?([\w-]+\.[a-z]+)\/.*$/;
  var strippedURL = window.location.href.match(re);
  if (strippedURL == null)
  {
    // Oops! (?)
    alert("Where are we?");
    return false;
  }
  alert(window.location.href + " => " + strippedURL);
  var strippedTarget = target.href.match(re);
  if (strippedTarget == null)
  {
    // Oops! (?)
    alert("What is it?");
    return false;
  }
  alert(target + " => " + strippedTarget);
  if (strippedURL[1] == strippedTarget[1])
  {
//~     window.location.href = target.href;  // Go there
    return true; // Accept the jump
  }
  return false;
} 
```

那是测试代码，而不是生产代码，很明显！

带有 //~ 注释的行显示了阻止单击链接进行跳转的替代方法。不知何故，它更有效，因为如果我使用 Firebug 的 console.log，奇怪的是 return false 是无效的。
我在这里使用了“是否关注链接”的行为，不知道真正的最终目的。

正如评论中所指出的，RE 可以通过使用主机名而不是 href 更简单......我保留它是因为它已经编码并且可能在其他情况下有用。
在这两种情况下都应该采取一些特殊的预防措施来处理特殊情况，比如本地主机、IP 地址、端口......
我去掉了域名，然后重新阅读问题并看到它没有问题......好吧，也许它对其他人有用。

注意：我在装饰链接的问题中展示了类似的解决方案：[Editing all external links with javascript](https://stackoverflow.com/questions/290368/editing-all-external-links-with-javascript "使用 javascript 编辑所有外部链接")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-19T15:17:31.283

给定一个点击事件和原始目标元素，这应该适用于原始问题：

```
if(target.protocol == window.location.protocol && target.host == window.location.host){
} 
```

浏览器很好地将链接从@Tom 提到的各种模式转换为完整链接，因此协议和主机值只需要与您的域匹配。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-25T12:39:41.300

```
if( someDomElementWhichIsALink.href.indexOf(window.location) != -1 ) {
  // this is targeting your domain
} 
```

# c# - 如何找出使用 .NET 锁定文件的进程？

> ID：317071
> 
> 赞同：173
> 
> 时间：2008-11-25T11:34:47.140
> 
> 标签：c#, file-locking

我已经看到了几个关于使用[Handle](http://technet.microsoft.com/en-us/sysinternals/bb896655.aspx)或[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)的答案，但我希望能够在我自己的代码（C#）中找出哪个进程正在锁定文件。

我有一种讨厌的感觉，我将不得不在 win32 API 中进行探索，但如果有人已经这样做并且可以让我走上正确的轨道，我将非常感谢您的帮助。

## 更新

### 类似问题的链接

*   [如何确定使用 c# 锁定文件的进程是什么？](https://stackoverflow.com/questions/860656/how-does-one-figure-out-what-process-locked-a-file-using-c)
*   [命令行工具](https://stackoverflow.com/questions/241178/command-line-tool-for-finding-out-who-is-locking-a-file)
*   [跨网络](https://stackoverflow.com/questions/208283/is-it-possible-to-programatically-find-out-what-process-is-locking-a-file-acros)
*   [锁定 USB 设备](https://stackoverflow.com/questions/23197/find-out-which-process-has-an-exclusive-lock-on-a-usb-device-handle)
*   [单元测试因锁定文件而失败](https://stackoverflow.com/questions/305843/determining-what-process-has-a-lock-on-a-file)
*   [删除锁定的文件](https://stackoverflow.com/questions/1040/how-do-i-delete-a-file-which-is-locked-by-another-process-in-c)

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2013-12-16T23:48:46.237

很久以前，不可能可靠地获取锁定文件的进程列表，因为 Windows 根本不跟踪该信息。为了支持[Restart Manager API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373656%28v=vs.85%29.aspx)，现在跟踪该信息。

`List<Process>`我将获取文件路径并返回锁定该文件的所有进程的代码放在一起。

```
using System.Runtime.InteropServices;
using System.Diagnostics;
using System;
using System.Collections.Generic;

static public class FileUtil
{
    [StructLayout(LayoutKind.Sequential)]
    struct RM_UNIQUE_PROCESS
    {
        public int dwProcessId;
        public System.Runtime.InteropServices.ComTypes.FILETIME ProcessStartTime;
    }

    const int RmRebootReasonNone = 0;
    const int CCH_RM_MAX_APP_NAME = 255;
    const int CCH_RM_MAX_SVC_NAME = 63;

    enum RM_APP_TYPE
    {
        RmUnknownApp = 0,
        RmMainWindow = 1,
        RmOtherWindow = 2,
        RmService = 3,
        RmExplorer = 4,
        RmConsole = 5,
        RmCritical = 1000
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
    struct RM_PROCESS_INFO
    {
        public RM_UNIQUE_PROCESS Process;

        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCH_RM_MAX_APP_NAME + 1)]
        public string strAppName;

        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = CCH_RM_MAX_SVC_NAME + 1)]
        public string strServiceShortName;

        public RM_APP_TYPE ApplicationType;
        public uint AppStatus;
        public uint TSSessionId;
        [MarshalAs(UnmanagedType.Bool)]
        public bool bRestartable;
    }

    [DllImport("rstrtmgr.dll", CharSet = CharSet.Unicode)]
    static extern int RmRegisterResources(uint pSessionHandle,
                                          UInt32 nFiles,
                                          string[] rgsFilenames,
                                          UInt32 nApplications,
                                          [In] RM_UNIQUE_PROCESS[] rgApplications,
                                          UInt32 nServices,
                                          string[] rgsServiceNames);

    [DllImport("rstrtmgr.dll", CharSet = CharSet.Auto)]
    static extern int RmStartSession(out uint pSessionHandle, int dwSessionFlags, string strSessionKey);

    [DllImport("rstrtmgr.dll")]
    static extern int RmEndSession(uint pSessionHandle);

    [DllImport("rstrtmgr.dll")]
    static extern int RmGetList(uint dwSessionHandle,
                                out uint pnProcInfoNeeded,
                                ref uint pnProcInfo,
                                [In, Out] RM_PROCESS_INFO[] rgAffectedApps,
                                ref uint lpdwRebootReasons);

    /// <summary>
    /// Find out what process(es) have a lock on the specified file.
    /// </summary>
    /// <param name="path">Path of the file.</param>
    /// <returns>Processes locking the file</returns>
    /// <remarks>See also:
    /// http://msdn.microsoft.com/en-us/library/windows/desktop/aa373661(v=vs.85).aspx
    /// http://wyupdate.googlecode.com/svn-history/r401/trunk/frmFilesInUse.cs (no copyright in code at time of viewing)
    /// 
    /// </remarks>
    static public List<Process> WhoIsLocking(string path)
    {
        uint handle;
        string key = Guid.NewGuid().ToString();
        List<Process> processes = new List<Process>();

        int res = RmStartSession(out handle, 0, key);
        if (res != 0) throw new Exception("Could not begin restart session.  Unable to determine file locker.");

        try
        {
            const int ERROR_MORE_DATA = 234;
            uint pnProcInfoNeeded = 0,
                 pnProcInfo = 0,
                 lpdwRebootReasons = RmRebootReasonNone;

            string[] resources = new string[] { path }; // Just checking on one resource.

            res = RmRegisterResources(handle, (uint)resources.Length, resources, 0, null, 0, null);

            if (res != 0) throw new Exception("Could not register resource.");                                    

            //Note: there's a race condition here -- the first call to RmGetList() returns
            //      the total number of process. However, when we call RmGetList() again to get
            //      the actual processes this number may have increased.
            res = RmGetList(handle, out pnProcInfoNeeded, ref pnProcInfo, null, ref lpdwRebootReasons);

            if (res == ERROR_MORE_DATA)
            {
                // Create an array to store the process results
                RM_PROCESS_INFO[] processInfo = new RM_PROCESS_INFO[pnProcInfoNeeded];
                pnProcInfo = pnProcInfoNeeded;

                // Get the list
                res = RmGetList(handle, out pnProcInfoNeeded, ref pnProcInfo, processInfo, ref lpdwRebootReasons);
                if (res == 0)
                {
                    processes = new List<Process>((int)pnProcInfo);

                    // Enumerate all of the results and add them to the 
                    // list to be returned
                    for (int i = 0; i < pnProcInfo; i++)
                    {
                        try
                        {
                            processes.Add(Process.GetProcessById(processInfo[i].Process.dwProcessId));
                        }
                        // catch the error -- in case the process is no longer running
                        catch (ArgumentException) { }
                    }
                }
                else throw new Exception("Could not list processes locking resource.");                    
            }
            else if (res != 0) throw new Exception("Could not list processes locking resource. Failed to get size of result.");                    
        }
        finally
        {
            RmEndSession(handle);
        }

        return processes;
    }
} 
```

**使用受限权限（例如 IIS）**

此调用访问注册表。如果进程没有权限这样做，你会得到ERROR_WRITE_FAULT，[意思是](https://msdn.microsoft.com/en-us/library/windows/desktop/aa373661(v=vs.85).aspx) `An operation was unable to read or write to the registry`。您*可以*选择性地将您的受限帐户的权限授予注册表的必要部分。虽然让您的受限访问进程设置一个标志（例如在数据库或文件系统中，或通过使用进程间通信机制，如队列或命名管道）并让第二个进程调用 Restart Manager API 会更安全。

向 IIS 用户授予非最低权限是一种安全风险。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-08-12T00:00:32.240

从 C# 调用 Win32 非常复杂。

您应该使用工具[Handle.exe](https://docs.microsoft.com/en-us/sysinternals/downloads/handle)。

之后，您的 C# 代码必须如下：

```
string fileName = @"c:\aaa.doc";//Path to locked file

Process tool = new Process();
tool.StartInfo.FileName = "handle.exe";
tool.StartInfo.Arguments = fileName+" /accepteula";
tool.StartInfo.UseShellExecute = false;
tool.StartInfo.RedirectStandardOutput = true;
tool.Start();           
tool.WaitForExit();
string outputTool = tool.StandardOutput.ReadToEnd();

string matchPattern = @"(?<=\s+pid:\s+)\b(\d+)\b(?=\s+)";
foreach(Match match in Regex.Matches(outputTool, matchPattern))
{
    Process.GetProcessById(int.Parse(match.Value)).Kill();
} 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-11-25T11:48:01.513

好处之一`handle.exe`是您可以将其作为子进程运行并解析输出。

我们在我们的部署脚本中这样做 - 就像一个魅力。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-07-13T18:30:32.887

我对[stefan 的解决方案](https://stackoverflow.com/a/317209/1574221)有疑问。下面是一个修改后的版本，它似乎运行良好。

```
using System;
using System.Collections;
using System.Diagnostics;
using System.Management;
using System.IO;

static class Module1
{
    static internal ArrayList myProcessArray = new ArrayList();
    private static Process myProcess;

    public static void Main()
    {
        string strFile = "c:\\windows\\system32\\msi.dll";
        ArrayList a = getFileProcesses(strFile);
        foreach (Process p in a)
        {
            Debug.Print(p.ProcessName);
        }
    }

    private static ArrayList getFileProcesses(string strFile)
    {
        myProcessArray.Clear();
        Process[] processes = Process.GetProcesses();
        int i = 0;
        for (i = 0; i <= processes.GetUpperBound(0) - 1; i++)
        {
            myProcess = processes[i];
            //if (!myProcess.HasExited) //This will cause an "Access is denied" error
            if (myProcess.Threads.Count > 0)
            {
                try
                {
                    ProcessModuleCollection modules = myProcess.Modules;
                    int j = 0;
                    for (j = 0; j <= modules.Count - 1; j++)
                    {
                        if ((modules[j].FileName.ToLower().CompareTo(strFile.ToLower()) == 0))
                        {
                            myProcessArray.Add(myProcess);
                            break;
                            // TODO: might not be correct. Was : Exit For
                        }
                    }
                }
                catch (Exception exception)
                {
                    //MsgBox(("Error : " & exception.Message)) 
                }
            }
        }

        return myProcessArray;
    }
} 
```

**更新**

如果您只想知道哪些进程正在锁定特定的 DLL，您可以执行并解析`tasklist /m YourDllName.dll`. 适用于 Windows XP 及更高版本。看

[这是做什么的？任务列表 /m "mscor*"](https://stackoverflow.com/questions/152506/what-does-this-do-tasklist-m-mscor)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-25T12:40:28.567

这适用于被其他进程锁定的 DLL。例如，此例程不会发现文本文件被文字处理锁定。

**C＃：**

```
using System.Management; 
using System.IO;   

static class Module1 
{ 
static internal ArrayList myProcessArray = new ArrayList(); 
private static Process myProcess; 

public static void Main() 
{ 

    string strFile = "c:\\windows\\system32\\msi.dll"; 
    ArrayList a = getFileProcesses(strFile); 
    foreach (Process p in a) { 
        Debug.Print(p.ProcessName); 
    } 
} 

private static ArrayList getFileProcesses(string strFile) 
{ 
    myProcessArray.Clear(); 
    Process[] processes = Process.GetProcesses; 
    int i = 0; 
    for (i = 0; i <= processes.GetUpperBound(0) - 1; i++) { 
        myProcess = processes(i); 
        if (!myProcess.HasExited) { 
            try { 
                ProcessModuleCollection modules = myProcess.Modules; 
                int j = 0; 
                for (j = 0; j <= modules.Count - 1; j++) { 
                    if ((modules.Item(j).FileName.ToLower.CompareTo(strFile.ToLower) == 0)) { 
                        myProcessArray.Add(myProcess); 
                        break; // TODO: might not be correct. Was : Exit For 
                    } 
                } 
            } 
            catch (Exception exception) { 
            } 
            //MsgBox(("Error : " & exception.Message)) 
        } 
    } 
    return myProcessArray; 
} 
} 
```

VB.Net：

```
Imports System.Management
Imports System.IO

Module Module1
Friend myProcessArray As New ArrayList
Private myProcess As Process

Sub Main()

    Dim strFile As String = "c:\windows\system32\msi.dll"
    Dim a As ArrayList = getFileProcesses(strFile)
    For Each p As Process In a
        Debug.Print(p.ProcessName)
    Next
End Sub

Private Function getFileProcesses(ByVal strFile As String) As ArrayList
    myProcessArray.Clear()
    Dim processes As Process() = Process.GetProcesses
    Dim i As Integer
    For i = 0 To processes.GetUpperBound(0) - 1
        myProcess = processes(i)
        If Not myProcess.HasExited Then
            Try
                Dim modules As ProcessModuleCollection = myProcess.Modules
                Dim j As Integer
                For j = 0 To modules.Count - 1
                    If (modules.Item(j).FileName.ToLower.CompareTo(strFile.ToLower) = 0) Then
                        myProcessArray.Add(myProcess)
                        Exit For
                    End If
                Next j
            Catch exception As Exception
                'MsgBox(("Error : " & exception.Message))
            End Try
        End If
    Next i
    Return myProcessArray
End Function
End Module 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-07-21T14:42:19.390

使用 linq 更简单：

```
public void KillProcessesAssociatedToFile(string file)
    {
        GetProcessesAssociatedToFile(file).ForEach(x =>
        {
            x.Kill();
            x.WaitForExit(10000);
        });
    }

    public List<Process> GetProcessesAssociatedToFile(string file)
    {
        return Process.GetProcesses()
            .Where(x => !x.HasExited
                && x.Modules.Cast<ProcessModule>().ToList()
                    .Exists(y => y.FileName.ToLowerInvariant() == file.ToLowerInvariant())
                ).ToList();
    } 
```

# c# - 为单元测试做好编码准备的最佳策略

> ID：317074
> 
> 赞同：4
> 
> 时间：2008-11-25T11:36:02.410
> 
> 标签：c#, unit-testing, refactoring, code-coverage

我有一个缺少很多代码覆盖率的解决方案。我需要重构此代码以解耦以开始创建单元测试。什么是最好的策略？我首先认为我应该推动将业务逻辑与来自业务对象的数据访问分离，以首先获得一些组织，然后从那里向下钻取。由于许多类不支持单一责任原则，因此很难开始测试它们。

是否有其他建议或最佳实践来采用遗留解决方案并将其成型以准备好进行代码覆盖和单元测试？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T11:39:38.923

查看[有效地使用旧代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T14:15:09.313

在遗留代码中要做的最重要的事情之一和处理遗留代码的最佳方法是缺陷。这是一个您将继续使用您引入单元测试的任何代码库的过程。每当报告缺陷时，编写一个单元测试来暴露该缺陷。您会很快发现会定期中断的代码（即“哦，耶。xyzzy 类中的plugh() 方法又被破坏*了*！）将开始越来越少地中断。

真的，开始做吧。您不会在一夜之间在遗留应用程序中获得大量覆盖。首先点击更容易损坏的代码，然后开始分支。确保代码中的任何新开发也具有更高的代码覆盖率。

请记住，TDD 的口号是“红/绿/重构”，您可能希望研究重构工具来帮助完成一些随之而来的乏味任务。JetBrain 的[ReSharper](http://www.jetbrains.com/resharper/features/index.html)很受欢迎，也是我个人的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T12:01:06.477

从创建测试开始。根据需要重构代码以支持测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T13:57:41.843

我建议首先为现有代码创建测试，直到你有足够的覆盖率。您需要按原样测试您的代码，以确保在重构​​时不会破坏任何内容。当然，你会想要一块一块地做，为一个模块编写测试，然后在继续下一个之前重构它。一旦获得了良好的覆盖率，您就可以决定是否值得继续重构以使代码更具可测试性。根据你的描述，我怀疑它会是。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T13:33:39.240

这些是我认为对单元测试有用的通用指南：

1) 识别边界对象（Win/WebForms、CustomControls 等）。

2）识别控制对象（业务层对象）

3) 只为边界对象调用的控制对象公共方法编写单元测试。这样您就可以确保您涵盖了应用程序的主要功能方面。

在您的情况下，如果业务规则与边界对象紧密耦合，您就会遇到麻烦 - 在我看来，您应该尝试根据应用程序的功能需求重构您的内容，重点关注热点。

这显然在很大程度上取决于具体情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-25T12:24:09.707

尝试开始阅读有关 TDD 的内容。

[http://www.codeproject.com/KB/dotnet/tdd_in_dotnet.aspx](http://www.codeproject.com/KB/dotnet/tdd_in_dotnet.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-13T07:48:48.173

您需要按原样测试您的代码，以确保在重构​​时不会破坏任何内容。

# .net - 使用 CompareTo 比较 .Net 版本实例无法按预期工作

> ID：317084
> 
> 赞同：0
> 
> 时间：2008-11-25T11:38:36.400
> 
> 标签：.net, version, compare, compareto

.Net 中的 Version 类没有像我期望的那样实现 CompareTo 接口，它似乎以字母数字方式处理比较，而不是比较四个数字。也许不是错误，而是“功能”。

谁能解释一下为什么比较（以及标准的 <、= 和 > 运算符）不能像我在下面所期望的那样工作？

```
 Dim MainVersion As New Version("1.1.3251.4029")
    Dim Ver_Low As New Version("1.1")
    Dim Ver_Same As New Version("1.1.3251.4029")
    Dim Ver_High As New Version("1.1.5.0")

    ' CompareTo here yields 1 which is expected as MainVersion is greater than Ver_Low.
    MessageBox.Show(String.Format("{0}.CompareTo({1}) = {2}", MainVersion.ToString(), Ver_Low.ToString(), MainVersion.CompareTo(Ver_Low).ToString()))

    ' CompareTo here yields 0 which is expected as MainVersion and Ver_Same are the same.
    MessageBox.Show(String.Format("{0}.CompareTo({1}) = {2}", MainVersion.ToString(), Ver_Same.ToString(), MainVersion.CompareTo(Ver_Same).ToString()))

    ' **** Issue here **** CompareTo here yields 1 which is NOT expected as MainVersion is less than Ver_High.
    MessageBox.Show(String.Format("{0}.CompareTo({1}) = {2}", MainVersion.ToString(), Ver_High.ToString(), MainVersion.CompareTo(Ver_High).ToString())) 
```

我知道人们已经为此做了自己的手动解决方法，我想知道这是设计使然还是应该起作用，我可能会做一些愚蠢的事情。

提前致谢

瑞安

更新：我做了一些微妙的愚蠢的事情，并将它们视为 IP 地址。例如; 1.1.3023.5364 大于 1.1.5 但 1.1.3023.5364 小于 1.1.5000。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T11:44:02.410

不，这是比较四个部分，将每个部分视为一个数字。哪个数字更大：5 还是 3251？当然是 3251。因此版本 1.1.3251.* 比 1.1.5.*“更新”（即更大）。

如果您在 1.1.5 之前获得了 1.1.3251，那么您实际上是在使用单个数字（“构建”部分）作为数字序列。这是一个错误。

# load-testing - 您是否有数据表明 Alfresco 社区在连接多个用户时的行为方式？(100>)

> ID：317085
> 
> 赞同：0
> 
> 时间：2008-11-25T11:39:37.067
> 
> 标签：load-testing, alfresco, stress-testing

我的公司将使用 Alfresco 作为 Intranet。我认为它不是最快的应用程序，并且想知道它是否可以与预期的数百名用户一起使用。您有与此类或更大的团体一起使用它的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-02T21:48:36.620

我在[Alfresco](http://www.alfresco.com)工作，可以告诉你我们的客户拥有数十万用户。我们为许多公共网站提供支持（请参阅客户列表），其中[Adob​​e Share](http://www.adobe.com/acom/share/)使用 Alfresco 作为其后端 - 它拥有数百万注册用户和数千名并发用户。

# c++ - boost lambda for_each / 变换拼图

> ID：317087
> 
> 赞同：4
> 
> 时间：2008-11-25T11:39:57.097
> 
> 标签：c++, boost, lambda

有谁知道为什么

```
 vector<int> test(10);
  int a=0;

  for_each(test.begin(),test.end(),(_1+=var(a),++var(a)));

  for_each(test.begin(),test.end(),(cout << _1 << " "));
  cout << "\n" 
```

给出：“0 1 2 3 4 5 6 7 8 9”

但

```
 transform(test.begin(),test.end(),test.begin(), (_1+=var(a),++var(a)));
  ...(as before) 
```

给出：“1 2 3 4 5 6 7 8 9 10”

?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-25T11:47:17.613

逗号运算符从左到右求值，因此

```
_1+=var(a), ++var(a) 
```

是 ++var(a)，您将使用转换版本存储它。

*   for_each：

    _1 += var(a) 被评估，更新你的序列（通过 lambda _1），然后 ++var(a) 被评估，但这对你的序列没有影响。

*   转换：

    _1+=var(a) 被评估，更新你的序列（就像以前一样），然后 ++var(a) 被评估，这也给出了整个表达式的结果，然后用于再次更新你的序列（通过转换）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T12:11:00.530

本质上，在中`for_each`您提供了一个具有副作用的函数，而在中`transform`，您使用了函数的返回值。

在您的情况下，您重用相同的功能。因为`operator +=`碰巧有一个返回值，所以这是作为转换结果使用的那个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T12:26:04.633

> 变换(test.begin(),test.end(),test.begin(), (_1+=var(a),++var(a)));

这将转化为

```
int doit(int & elem) {
    elem += a;
    return ++a;
}

for each elem : elem = doit(elem); 
```

以 a=0 开头将在第一次运行中生成 1。我们将 a 递增 10 次，因此我们将在最后一次运行中得到 10。

* * *

> for_each(test.begin(),test.end(),(_1+=var(a),++var(a)));

这将转化为

```
void doit(int & elem) {
    elem += a;
    ++a;
}

for each elem : doit(elem); 
```

从 a=0 开始，我们将在第一次运行时得到 0。我们将 a 增加 10 次，但在增加之前分配它。因此最后一个数字是 9。

我希望现在通过将这两个函数转换为普通函数已经清楚了。

# database-design - 如何优化对这些数据的访问？

> ID：317089
> 
> 赞同：2
> 
> 时间：2008-11-25T11:40:27.283
> 
> 标签：database-design, optimization, normalization

我有一张包含 5 年 200 家公司股票价格的表格。这是一张大表，包含公司名称、股票开盘价、最高价、最低价、收盘价、日期

我现在需要对其进行一些处理，并让用户 [最多 10 个] 访问此数据库以获取有关不同参数和查询集的报告。

我应该按原样使用数据库还是您有什么建议可以使其更加优化。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T11:50:09.073

提取名称并使用整数 ID。它应该更快，并且可以容忍名称更改。股票代码也可以提取到父表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T11:50:41.320

我认为您需要考虑报告，例如，它们是否总是按月进行？如果是这样，您可以创建一个汇总数据表。

否则，我认为谨慎的索引是您提高性能的唯一选择

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T11:48:25.707

如果它真的只是带有该数据的公司名称，那么它已经被规范化了。如果有更多关于公司的信息，例如地址、电话等，那么您可能希望将其分解为单独的表格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T12:33:59.813

对某人的错误引用：

## 优化规则

1.  不要这样做。
2.  仅限专家：暂时不要这样做。

如果问题是“......我是放手还是放手`make it more optimized`”，*不要管它，*直到您通过测量知道存在问题为止。

如果表的查询或更新出现问题，请使用有关查询的详细信息、任何索引、表的更新/访问频率等更新您的问题。届时您将获得各种建议。

如前所述，就规范化而言，如果同一公司名称在表中多次出现，您可能会考虑将公司名称提取到其自己的表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T11:49:38.747

我会为公司准备一张表格，以及给定日期的股票价格表格（开盘/高/低/收盘位），以节省到处复制公司信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T11:51:37.840

我会为日期添加一个 UID 字段和几个维度（即年表、年+月表、年+季度表、财政年表等）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T11:57:43.600

规范化和优化并不总是一回事。

您的用户将如何处理这些数据？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T12:31:46.573

这不是优化（尽管您可以争辩说这是一种规范化，前提是公司可以更改名称）：

```
CREATE TABLE company (
  id INTEGER PRIMARY KEY, -- Well, this would be a serial, but that works different in different DBMS
  name VARCHAR(256) UNIQUE
);

CREATE TABLE price (
  company_id INTEGER REFERENCES company(id) NOT NULL,
  date  TIMESTAMP NOT NULL,
  open  DECIMAL, -- Just grabbed a type here, probably not right for you.
  high  DECIMAL,
  low   DECIMAL,
  close DECIMAL,

  PRIMARY KEY(company_id, date)
); 
```

有关密钥生成的信息，请参见[此处](http://troels.arvin.dk/db/rdbms/#mix-identity)。

顺便问一下，你们如何处理公司更名的问题？忽略这将是一个简单的答案，但它是否正确？:)

因此，无论如何，如果表变得太大而无法获得良好的性能，我只会对其进行[分区](http://www.postgresql.org/docs/8.3/interactive/ddl-partitioning.html)。

# jquery - 如何使用 jQuery 向 DropDownList 添加选项？

> ID：317095
> 
> 赞同：298
> 
> 时间：2008-11-25T11:42:56.123
> 
> 标签：jquery, user-interface, drop-down-menu

正如问题所说，如何使用 jQuery 向 DropDownList 添加新选项？

谢谢

* * *

## 回答 #1

> 赞同：455
> 
> 时间：2008-11-25T11:52:54.140

无需使用任何额外的插件，

```
var myOptions = {
    val1 : 'text1',
    val2 : 'text2'
};
var mySelect = $('#mySelect');
$.each(myOptions, function(val, text) {
    mySelect.append(
        $('<option></option>').val(val).html(text)
    );
}); 
```

如果您有很多选项，或者此代码需要非常频繁地运行，那么您应该考虑使用[DocumentFragment](https://developer.mozilla.org/en/DOM/document.createDocumentFragment)而不是多次不必要地修改 DOM。对于少数几个选项，我会说这不值得。

- - - - - - - - - - - - - - - - 添加 - - - - - - - - - --------------

`DocumentFragment`是提高速度的好选择，但我们不能使用创建选项元素，`document.createElement('option')`因为 IE6 和 IE7 不支持它。

我们可以做的是，创建一个新的选择元素，然后附加所有选项。循环完成后，将其附加到实际的 DOM 对象。

```
var myOptions = {
    val1 : 'text1',
    val2 : 'text2'
};
var _select = $('<select>');
$.each(myOptions, function(val, text) {
    _select.append(
            $('<option></option>').val(val).html(text)
        );
});
$('#mySelect').append(_select.html()); 
```

这样我们只修改一次 DOM！

* * *

## 回答 #2

> 赞同：170
> 
> 时间：2010-03-31T13:00:14.410

在没有插件的情况下，这可以更容易，无需使用尽可能多的 jQuery，而是稍微老派一点：

```
var myOptions = {
    val1 : 'text1',
    val2 : 'text2'
};
$.each(myOptions, function(val, text) {
    $('#mySelect').append( new Option(text,val) );
}); 
```

如果要指定选项 a) 是否为默认选择值，并且现在应选择 b)，则可以再传入两个参数：

```
 var defaultSelected = false;
    var nowSelected     = true;
    $('#mySelect').append( new Option(text,val,defaultSelected,nowSelected) ); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-25T11:47:27.147

使用插件：[jQuery 选择框](http://www.texotela.co.uk/code/jquery/select/)。你可以这样做：

```
var myOptions = {
        "Value 1" : "Text 1",
        "Value 2" : "Text 2",
        "Value 3" : "Text 3"
    }
    $("#myselect2").addOption(myOptions, false); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-01-23T20:42:21.060

**您可能需要先清除 DropDown $('#DropDownQuality').empty();**

我让 MVC 中的控制器返回一个只有一项的选择列表。

```
$('#DropDownQuality').append(
        $('<option></option>').val(data[0].Value).html(data[0].Text)); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-04-30T12:06:50.297

在开头添加项目到列表

```
$("#ddlList").prepend('<option selected="selected" value="0"> Select </option>'); 
```

最后将项目添加到列表中

```
$('<option value="6">Java Script</option>').appendTo("#ddlList"); 
```

[使用 jQuery 的常见下拉操作（获取、设置、添加、删除）](http://www.jquerybyexample.net/2012/02/common-dropdown-operation-get-set-add.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-08-22T01:15:10.287

请注意@Phrogz 的解决方案不适用于 IE 8，而 @nickf 的解决方案适用于所有主要浏览器。另一种方法是：

```
$.each(myOptions, function(val, text) {
    $("#mySelect").append($("&lt;option/&gt;").attr("value", val).text(text));
}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-09-20T09:14:41.770

你可以直接使用

`$"(.ddlClassName").Html("<option selected=\"selected\" value=\"1\">1</option><option value=\"2\">2</option>")`

-> 这里你可以使用直接字符串

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-03-29T05:51:08.480

此外，使用 .prepend() 将选项添加到选项列表的开头。 [http://api.jquery.com/prepend/](http://api.jquery.com/prepend/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-12T09:44:20.017

使用 jquery 你可以使用

```
 this.$('select#myid').append('<option>newvalue</option>'); 
```

其中“ **myid** ”是下拉列表的**id ，** **newvalue**是您要插入的文本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-11-20T02:37:33.873

我需要向下拉列表中添加与我的页面上的下拉列表一样多的选项。所以我以这种方式使用它：

```
function myAppender(obj, value, text){
    obj.append($('<option></option>').val(value).html(text));
}

$(document).ready(function() {
    var counter = 0;
    var builder = 0;
    // Get the number of dropdowns
    $('[id*="ddlPosition_"]').each(function() {
        counter++;
    });

    // Add the options for each dropdown
    $('[id*="ddlPosition_"]').each(function() {
        var myId = this.id.split('_')[1];

        // Add each option in a loop for the specific dropdown we are on
        for (var i=0; i<counter; i++) {
            myAppender($('[id*="ddlPosition_'+myId+'"]'), i, i+1);
        }
        $('[id*="ddlPosition_'+myId+'"]').val(builder);
        builder++;
    });
}); 
```

这会动态设置具有 1 到 n 等值的下拉菜单，并自动选择下拉菜单所在顺序的值（即第二个下拉菜单在框中得到“2”等）。

我不能在我的 2nd 中使用`this`or `this.Object`or `$.obj`or 类似的东西，这太荒谬了`.each()`——我实际上必须获取该对象的特定 ID，然后在它附加之前抓取并将整个对象传递给我的函数。幸运的是，我的下拉列表的 ID 用“_”分隔，我可以抓住它。我觉得我不应该这样做，但它一直给我 jQuery 异常，否则。其他人与我正在努力的事情可能会喜欢知道。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-10T03:48:35.560

让我们认为您的回答是“successData”。这包含一个列表，您需要将其添加为下拉菜单中的选项。

```
success: function (successData) {
var sizeOfData = successData.length;
if (sizeOfData == 0) {
    //    NO DATA, throw an alert ...
    alert ("No Data Found");
} else {
    $.each(successData, function(val, text) {
        mySelect.append(
            $('<option></option>').val(val).html(text)
        );
    });
} } 
```

这对你有用....

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2011-04-19T12:34:15.423

试试这个功能：

```
function addtoselect(param,value){
    $('#mySelectBox').append('&lt;option value='+value+'&gt;'+param+'&lt;/option&gt;');
} 
```

# .net - 确定 Linq to Sql 查询的源 DataContext

> ID：317114
> 
> 赞同：4
> 
> 时间：2008-11-25T11:52:32.550
> 
> 标签：.net, linq, linq-to-sql, datacontext

在我的应用程序中，我有几个 DataContexts 连接到具有不同模式的不同数据库。在自定义用户控件中，我显示查询结果并让用户编辑它们，当用户编辑数据时，我希望将更改持久保存到数据库中。为此，我需要引用源 DataContext（或至少源 datacontext 类型），以便我可以执行`DataContext.SubmitChanges();`

有什么方法可以确定查询来自哪个 DataContext？DataQuery 类本身被标记为内部的，所以我不能访问它的上下文属性而不诉诸丑陋的反射黑客，所以我正在寻找一种更清洁的方法。

有（几种）解决这个问题的方法，例如传递对源 DataContext 的引用，但我想必须有一种更简单的方法来做到这一点。

编辑：以下代码有效，但很难看：

```
FieldInfo contextField = query.GetType().GetField("context", BindingFlags.Instance | BindingFlags.NonPublic);
if (query != null)
{
  queryContext = contextField.GetValue(value) as DataContext;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-12T11:11:00.433

是的 - 使用反射是确定查询所属的 DataContext 的唯一方法。触发查询时创建的数据对象也是如此。

以下内容并未严格回答 Rune 的问题，但如果您想使用反射来确定数据对象是否附加到数据上下文并由数据上下文监控，则可能会有所帮助：

以下代码定义了一个 Context 属性，该属性可以放置在数据对象上，然后用于返回该对象附加到的 DataContext（如果有）。

```
Private Const StandardChangeTrackerName As String = "System.Data.Linq.ChangeTracker+StandardChangeTracker"

Private _context As DataClasses1DataContext
Public Property Context() As DataClasses1DataContext
    Get
        Dim hasContext As Boolean = False
        Dim myType As Type = Me.GetType()
        Dim propertyChangingField As FieldInfo = myType.GetField("PropertyChangingEvent", BindingFlags.NonPublic Or BindingFlags.Instance)
        Dim propertyChangingDelegate As PropertyChangingEventHandler = propertyChangingField.GetValue(Me)
        Dim delegateType As Type = Nothing

        For Each thisDelegate In propertyChangingDelegate.GetInvocationList()
            delegateType = thisDelegate.Target.GetType()
            If delegateType.FullName.Equals(StandardChangeTrackerName) Then
                propertyChangingDelegate = thisDelegate
                hasContext = True
                Exit For
            End If
        Next

        If hasContext Then
            Dim targetField = propertyChangingDelegate.Target
            Dim servicesField As FieldInfo = targetField.GetType().GetField("services", BindingFlags.NonPublic Or BindingFlags.Instance)
            If servicesField IsNot Nothing Then

                Dim servicesObject = servicesField.GetValue(targetField)

                Dim contextField As FieldInfo = servicesObject.GetType.GetField("context", BindingFlags.NonPublic Or BindingFlags.Instance)

                _context = contextField.GetValue(servicesObject)

            End If
        End If

        Return _context
    End Get
    Set(ByVal value As DataClasses1DataContext)

        _context = value

    End Set

End Property 
```

请注意，如果对象当前附加到已打开 ChangeTracking 的上下文，则该对象只能找到它的 DataContext。此属性依赖于 DataContext 已订阅对象的 OnPropertyChanging 事件以监视对象生命周期内的更改这一事实。

如果这有帮助，请给这篇文章投票。

有关使用反射查找事件处理程序的更多信息：

*   [http://weblogs.asp.net/avnerk/archive/2007/03/29/reflecting-over-an-event.aspx](http://weblogs.asp.net/avnerk/archive/2007/03/29/reflecting-over-an-event.aspx)
*   [https://web.archive.org/web/20131213074318/http://bobpowell.net/eventsubscribers.aspx](https://web.archive.org/web/20131213074318/http://bobpowell.net/eventsubscribers.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T12:52:39.930

我认为您将不得不简单地将 DataContext 传递给代码（手动）。对不起。

# styling - 什么是主应用程序窗口的酷壁纸或背景（如果有）？

> ID：317118
> 
> 赞同：1
> 
> 时间：2008-11-25T11:54:35.900
> 
> 标签：styling

打开窗口是否增强了应用程序的吸引力？它应该是一张照片还是平淡的蓝白相间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T11:57:53.770

使用默认的操作系统主题颜色。其他任何东西都会对某些人群有吸引力，而对其他人来说很丑（他们会*大声*抱怨他们觉得它有多丑）。如果您坚持使用 OS 主题颜色，那么至少您的应用程序的外观不会是您会受到批评的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T12:09:02.360

有些人喜欢它干净漂亮，而另一些人则认为时尚的主题是积极的和好的。您必须考虑您的应用程序指向谁并做该组感兴趣的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T12:09:13.060

我会使用默认的操作系统颜色。但实际上，如果可以的话，我根本不会放任何颜色/主题。我会在该区域放置一些信息/控件（假设您谈论 MDI/SDI 应用程序的背景）。类似于最近的 openoffice 3 版本所做的。例如，将“*你要我做什么？打开/退出/教程/...* ”放入其中。

# cvs - CVSROOT环境

> ID：317127
> 
> 赞同：2
> 
> 时间：2008-11-25T12:03:41.607
> 
> 标签：cvs

WinCVS中如何设置CVSROOT环境变量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-25T14:38:48.330

简单的答案是：你不需要。`CVSROOT`环境变量被严重高估了。CVS(NT) 仅在所有其他确定存储库连接字符串的方法都已用尽时才使用它。人们通常认为情况正好相反，然后想知道他们对 CVSROOT 环境变量所做的更改是否无效。

CVS 评估存储库连接字符串的可能来源的顺序：

1.  命令行上的`-d`选项。这是 WinCvs 允许您通过以下对话框中的 CVSROOT 选项设置的内容：`login`、`init`、`import`和。另请注意，WinCvs 会记住您过去使用过的 CVSROOT：如果您重新访问这些对话框之一，您可以简单地从下拉列表中选择以前的 CVSROOT。`checkout``rtag`

2.  任何 ./CVS/Root 文件的内容（如果存在）（默认情况下它们具有隐藏属性，以防您看不到它们）。这意味着只要您在工作副本中运行命令，就无需通过任何其他方式指定 CVSROOT。如果可用，WinCvs 也会在状态栏中显示它。

3.  最后，作为最后的手段，`CVSROOT`环境变量。当您实际在命令行上工作时，这很有用，在签出的沙箱之外执行命令，但在 WinCvs 中确实没有意义......要么您已经在沙箱内，要么您可以简单地从下拉列表中选择 CVSROOT是需要的。

如果您需要更改现有工作副本的连接设置，您需要修改 ./CVS/Root 文件的内容。WinCvs 带有一个宏，可以为您简化这个过程。只需选择要更改 CVSROOT 的工作副本的根文件夹，然后转到 Macros|CVS|Change CVSROOT...

另请参阅有关整个问题的常见问题解答项目：http: [//cvsgui.sf.net/newfaq.htm#CvsrootWizard](http://cvsgui.sf.net/newfaq.htm#CvsrootWizard)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T12:06:48.120

您可以在“常规”选项卡的首选项窗格中进行设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T12:20:37.220

在 WinCVS 2.0.2.4 中（可能是类似的版本）

转到 Admin->Login 这是一个 ... 按钮，它会弹出一个弹出窗口来构建 CVSROOT。登录后，应设置 CVSROOT 变量。

# .net - 在 .NET 中构建 XML 文档的最佳方法是什么？

> ID：317134
> 
> 赞同：3
> 
> 时间：2008-11-25T12:08:52.827
> 
> 标签：.net, xml

在 .NET 中创建 XML 文档似乎有很多选择。最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T12:25:16.273

如果您只需要生成 XML（不需要解析或编辑），最快的方法是`XmlWriter`使用文件格式良好）：

```
// Create an XmlWriterSettings object with the correct options.
var settings = new XmlWriterSettings();
settings.Indent = true;
settings.IndentChars = ("\t");
settings.OmitXmlDeclaration = true;

// Create the XmlWriter object and write some content.
using (var writer = XmlWriter.Create("data.xml", settings))
{
    writer.WriteStartElement("book");
    writer.WriteElementString("item", "tesing");
    writer.WriteEndElement();
    writer.Flush();
} 
```

如果您已经有一个要序列化的对象模型，您可以考虑使用 XmlSerializer，但是 - 至少从我的经验来看 - 它比 XmlWriter 慢得多，并且仅在简单的对象模型上易于使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T12:10:48.127

如果可能的话，我会亲自使用 LINQ to XML。它比 DOM API 好得多*。*当然，它确实依赖于您使用 .NET 3.5...

请注意，如果您有任何需要转义的文本，您的 String.Format 解决方案就会崩溃。诚然，我想不出任何汽车品牌和型号，包括`&`等等`<`，但在更一般的情况下，这是一个真正的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-25T12:19:23.117

XmlWriter 有一个很好的界面，用于以流式、只进样式创建文档。如果您有一个需要映射到 XML 的递归结构，那么它的效果最好。

我只会使用 DOM API 作为最后的手段。正如 Jon 所说，LINQ to XML 是另一种方式。但是，无论您做什么，都不要退回到字符串格式，因为您需要正确处理名称空间、实体引用、属性引用等微妙之处。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-25T12:22:08.603

另一种方法是使用 Xml 序列化：只需创建代表（复杂）元素的类，填充代表这些元素内容的公共属性，可能使用属性提供有关布局的其他信息：[XmlElement()]、[XmlAttribute ()],... 并使用 XmlSerializer 创建文档：

```
public class Car
{
  public string Make;
  public string Model;
}

public class Cars
{
  [XmlElement("Car")]
  public Car[] cars;
}

class Program
{
  public static void Save(Cars cars, string sFilename)
  {
    try
    {
      XmlSerializer ser = new XmlSerializer(cars.GetType());
      FileStream fs = new FileStream(sFilename, FileMode.Create);
      ser.Serialize(fs, cars);
      fs.Close();
    }
    catch (Exception ex)
    { // Failed to save data to disk.
      Debug.WriteLine(string.Format("Failed to save contents of {0}: {1}", sFilename ,ex.Message));
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-12T16:27:11.367

使用 Visual Studio 2008 中的 PasteXmlAsLinq 示例。打开 C:\Program Files\Microsoft Visual Studio 9.0\Samples\1033\CSharpSamples.zip 并提取 LinqSamples\PasteXmlAsLinq 文件。自述文件告诉您如何设置和使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T12:52:33.130

我还没有做，但是 VB 的[XML Literals](http://www.code-magazine.com/Article.aspx?quickid=0807061)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T12:16:25.433

string.format（或任何其他形式的字符串连接）显然是一种代码异味，实际上比 DOM 方法更不透明，更容易出现人为错误，更难分解，因此更难维护，而且速度较慢。

我*强烈*建议使用 DOM 方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T12:19:29.857

您是否考虑过使用 XML 序列化，并将您的类序列化为 XML 文件

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-25T12:34:59.903

如果您有可用于 XML 文档的模式文件，则可以使用[xsd](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.80).aspx)工具为您生成类，然后使用序列化来读取和写入 XML 文件。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-25T17:28:07.083

我正在进行的当前项目，我有很多信息需要存储在 xml 中。我没有继续使用上面定义的任何方法，而是创建了自己的包装器来为我工作。我建议你也这样做。付出一次努力，然后一遍又一遍地使用它。我是 Fluent Interface 的忠实粉丝，因此我的 api 可以相应地工作。这是一个例子

```
 List<string> hierarchyList = new List<string>();
        hierarchyList.Add("Book");
        hierarchyList.Add("Product");
        ConfigurationManager manager = new ConfigurationManager();
        manager.FileName = "deleteme.xml";

        expression = new ConfigurationManagerExpression(manager);
        expression.AddNode("HierarchySet");

        // ROOT_NODE_CONSTANT is the root node of document
        string nodePath = manager.ROOT_NODE_CONSTANT + "/HierarchySet";

        foreach (string name in hierarchyList)
        {
            expression.UsingNode(nodePath).AddNode("HierarchyName").AssignValue(name);
        }

        string panelPrefix = "PE";
        string pathWithFileName = "define your path here";
        manager.SaveSettings(pathWithFileName );
Let me know if you need code and I"ll post it on my blog (which I need to do eventually). 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-12T16:25:36.957

使用MVP.XML 中的[XML 类型化模板](http://www.codeplex.com/MVPXML/Release/ProjectReleases.aspx?ReleaseId=1860)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-12T16:28:02.520

只使用 API 并且有很多 CreateElement、AppendChild 等方法：

```
XmlNode carNode = xmlDocument.CreateElement("Car");
xmlDocument.DocumentElement.AppendChild(carNode);
XmlNode makeNode = xmlDocument.CreateElement("Make");
carNode.AppendChild(makeNode);
... 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-12T16:28:29.493

为文档的每个组件使用一个字符串。文档的值由 String.Format 插入，然后 LoadXml 将其转换为 XmlDocument：

```
string carString =
  "<Car>" +
  "  <Make>{0}</Make>" +
  "  <Model>{1}</Model>" +
  "</Car>";
XmlDocument carDoc = new XmlDocument();
carDoc.LoadXml(String.Format(carString, make, model)); 
```

# c++ - 在 C++ 中获取 JPEG 的尺寸

> ID：317140
> 
> 赞同：5
> 
> 时间：2008-11-25T12:12:42.413
> 
> 标签：c++, jpeg, openvms

我需要在 C++ 中获取 JPEG 的图像尺寸。我正在寻找一种相当简单的方法或提供该功能的小型库。我在 OpenVMS 上使用 C++ 工作，因此任何外部库都可能必须适应在我们的系统上编译 - 所以请不要向我发布指向大型封闭源代码库的链接！

有没有人遇到过任何可以解决问题的方法，或者了解 JPEG 文件格式（我想我可能在这里指的是 JFIF 文件格式）来告诉我如何着手推出自己的解决方案？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-25T12:16:36.477

你有这个[C 函数](http://carnage-melon.tom7.org/stuff/jpegsize.html)可以为你提取相关数据。

> 这是一个 C 例程，但应该可以用 C++ 编译。
> 将一个普通的 FILE 指针（来自 fopen）传递给一个 jpeg 文件的开头，并将两个 int 指针传递给图像的高度和宽度。

或者您可能会在[Boost 库](http://www.boost.org/doc/libs/1_35_0/boost/gil/extension/io/jpeg_io.hpp)中找到一个具有正确功能的 jpeg 类（来自[Adob](http://www.adobe.com/technology/graphics/generic_image_library.html) [​​e Generic Image Library](http://opensource.adobe.com/wiki/display/gil/Generic+Image+Library)）。

[jpeg_read_dimensions](http://stlab.adobe.com/gil/html/group___j_p_e_g___i_o.html#ga4)

```
boost::gil::jpeg_read_dimensions (const char *filename) 
```

> 返回指定位置的 JPEG 文件的宽度和高度。如果位置不对应于有效的 JPEG 文件，则抛出 std::ios_base::failure。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T12:20:15.923

libjpeg 相当小，是开源的，可在 OpenVMS 上使用。安装它可能比自己处理 JPEG 更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T12:15:18.807

也许是[libjpeg](http://en.wikipedia.org/wiki/Libjpeg)？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T12:18:57.097

您应该能够将此[jpeg 库](http://ftp://ftp.uu.net/graphics/jpeg/)与此[补丁一起用于 OpenVMS](http://nchrem.tnw.tudelft.nl/openvms/software2.html#Jpeglib)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T12:27:53.913

不需要完整的 libjpeg 库来获取此信息（除非您需要对图像执行其他操作）。[ImageInfo](http://schmidt.devlib.org/image-info/index.html "图像信息")可能会对您有所帮助。它是一个 Java 类，但也有其他语言的端口，包括 C++。
正如所指出的，Exif 可能会更改这些信息（例如，使用方向设置）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-20T13:00:58.433

您可能想尝试[GDAL](http://www.gdal.org)库，它用作大量栅格数据格式的抽象层，主要用于 GIS/RS 的地理空间应用程序。

GDAL 为 C、C++ 和脚本语言提供了许多 API。当然，它支持[JPEG](http://www.gdal.org/frmt_jpeg.html)图像及其变体，如[JPEG2000](http://www.gdal.org/frmt_jpeg2000.html)等。

这是一个非常简单的示例，如何打开 JPEG 图像并查询其尺寸：

```
#include <gdal_priv.h>

GDALAllRegister(); // call ones in your application

GDALDataset* ds = (GDALDataset*)GDALOpen("my.jpeg", GA_ReadOnly);
int width  = ds->GetRasterXSize();
int height = ds->GetRasterYSize(),
int nbands = ds->GetRasterCount(); 
```

查看[GDAL API 教程](http://www.gdal.org/gdal_tutorial.html)以获得更完整的示例。

# nhibernate-mapping - NHibernate 多对多

> ID：317154
> 
> 赞同：5
> 
> 时间：2008-11-25T12:20:31.523
> 
> 标签：nhibernate-mapping

我有一个遗留数据库，我正在尝试创建一个 NHibernate DAL。我在多对多表上的映射有问题。

数据库表：

*   `studio_Subscribers`
*   `studio_Groups`（包含订阅者的 IList）
*   `studio_Subscribers_Groups`- 带有主键的多对多表

问题是当我创建一个`SubscriberGroup`实例并用订阅者填充它时，它们会保存到`studio_Subscribers`表中，但不会保存到多对多表中。

我想不通怎么了？

`studio_Subscribers`表映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
    assembly="Meridix.Studio.Common"
    namespace="Meridix.Studio.Common">
    <class name="SubscriberItem" table="studio_Subscribers">
        <id name="StorageId" column="Id" unsaved-value="0" access="nosetter.camelcase">
            <generator class="identity" />
        </id>
        <property name="Id" column="DomainId" not-null="true" />
        <property name="Subscriber" column="Subscriber" not-null="true" length="50" />
        <property name="Description" column="Description" not-null="false" length="100" />
        <property name="Type" column="Type" not-null="true" length="40" 
            type="Meridix.Studio.Data.Repositories.EnumStringTypes.SubscriberTypeEst, Meridix.Studio.Data.Repositories" />
    </class>
</hibernate-mapping> 
```

`studio_Groups`表映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
    assembly="Meridix.Studio.Common"
    namespace="Meridix.Studio.Common">
    <class name="SubscriberGroup" table="studio_Groups">
        <id name="StorageId" column="Id" unsaved-value="0" access="nosetter.camelcase">
            <generator class="identity" />
        </id>
        <property name="Id" column="DomainId" not-null="true" />
        <property name="Name" column="Name" not-null="true" length="200" />
        <property name="Description" column="Description" not-null="false" length="300" />

        <bag name="Subscribers" table="studio_Groups_Subscribers" access="nosetter.camelcase">
            <key column="GroupId"></key>
            <many-to-many column="SubscriberId" class="SubscriberItem" />
        </bag>
    </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T12:37:30.273

难道您不应该在您的订阅者身上有一个合适的包，以及与该组的多对多关系吗？

```
<bag name="Groups" table="studio_Groups_Subscribers" access="nosetter.camelcase">
        <key column="SubscriberId"></key>
        <many-to-many column="GroupId" class="GroupItem" />
</bag> 
```

并且可能在您的 SubscriberItems 集合上有一个 cascade="save-update" ，以便保存组将使用“另一方”的适当关系更新您的孩子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T22:53:07.377

我相信这与级联选项有关，请查看 Ayende 的帖子，我想通过一些谷歌搜索，您可以找到正确的语法进入您的 hbm 文件。我使用 fluent-NHibernate，所以我无法帮助您处理 XML 文件。

[http://ayende.com/Blog/archive/2006/12/02/NHibernateCascadesTheDifferentBetweenAllAlldeleteorphansAndSaveupdate.aspx](http://ayende.com/Blog/archive/2006/12/02/NHibernateCascadesTheDifferentBetweenAllAlldeleteorphansAndSaveupdate.aspx)

# c# - Best resource for memory footprint analysis for winforms app .

> ID：317156
> 
> 赞同：1
> 
> 时间：2008-11-25T12:21:06.593
> 
> 标签：c#, memory

So we have a winforms app that in the task manager should anywhere from 250 - 450 MB of memory. We are trying to figure out the best place to focus on to reduce memory footprint.

what is the best place to start?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T12:23:57.757

I would suggest profiling so you can understand what is using the memory. CLR Profiler and ANTS Profiler are two profilers you may want to check out.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-28T15:48:52.933

[Yourkit](http://yourkit.com/) is better than the other suggested profilers.

# php - PHP应用程序的面向对象设计

> ID：317167
> 
> 赞同：5
> 
> 时间：2008-11-25T12:27:07.050
> 
> 标签：php, oop

对于我们学校的项目，我们的任务是定义一个描述 PHP 应用程序架构的设计文档。

我们可以自由决定在文档中包含哪些内容。

我们的教授建议，很多（UML）图。

他还要求我们考虑类图，但要小心，因为 PHP 不是完全面向对象的。

我的问题：领域驱动的面向对象设计对于 PHP 应用程序是否可行？在 PHP 中做 OO 时要考虑什么？优缺点都有什么？PHP 和 PHP 最佳实践中有关 OO 的任何有用资源？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T13:11:16.197

恕我直言，如果不知道应用程序应该做什么，就很难描述任何应用程序的架构。任何复杂性的所有应用程序（PHP 或其他）看起来都不同。

其次，PHP5 为您提供类/对象和通常过多的 OO gubbings - 所以我认为将其描述为“不完全面向对象”是一种误导。如果您的意思是您可以采取程序方法而不受对象的限制，那么可以，但是如果您希望一切都成为对象，那是您的选择。

DDD 对 PHP 是否可行？是的当然。一种特定的架构方法通常不依赖于技术。OO 设计的最佳实践和优缺点适用于大多数语言 - PHP 让您可以自由决定如何构建代码。

您可能会发现 PHP 站点上的这个[最佳实践](http://talks.php.net/show/tortech04)演讲很有用；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T13:16:38.167

PHP 现在可以被描述为完全面向对象的选择。它提供了您需要的一切，但您不必编写 OO 代码。

有两本书对我理解与 PHP 相关的 OO 原则有很大帮助：

*   PHP 在行动（曼宁）
*   PHP5 Zend 学习指南 (Zend)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T13:23:33.927

当前使用的大多数 OO 语言都不是*完全*面向对象的。每种语言都有特质和陷阱。所以我想说 PHP 对于大多数简单的项目来说已经足够了。我在 Zend 框架上工作，它被设计为一个 OO 类库，具有设计模式等。

对 PHP 的一个建议是您应该注意它的[SPL](http://php.net/spl)组件，它为您提供了许多基本类的接口。

我认为如果你的老师说“把你想要的任何东西都放在设计文档中，UML 图很漂亮”，我认为这很弱。设计文档是软件工程中一个重要但被严重低估的部分。您的老师应该向您展示优秀设计文档的示例或模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T13:37:07.237

OO首先是一种设计方法。

因此，可以提出一种可以在程序语言中实现的 OO 设计。我已经看到 C 和 COBOL 项目都这样做了。它让我相信，几乎所有面向对象的优势都与设计有关，而不是语言实现。

因此，是的，您可以提出一个包含大量 UML（类图、用例、泳道等）的 OO 设计，并且您可以在 php 中实现它（使用或不使用类）。

无论如何，php 实际上是 OO 的超集，所以如果你将自己限制在类（== 方法）中的类和函数，你就有了一个 OO 实现。

唯一缺少的是接口定义，但是用这种（非）有限类型检查的语言定义接口几乎没有意义。

# jquery - 如何使用 jQuery 更改 HTML 属性名称？

> ID：317170
> 
> 赞同：24
> 
> 时间：2008-11-25T12:28:07.657
> 
> 标签：jquery, html

我想更改`class="testingCase"`整个 html 文档中所有属性的名称。

例如更改：

```
<a class="testingCase" href="#" title="name of testing case">Blabla</a>
<a class="testingCase" href="#" title="name of another testing case">Bloo</a> 
```

对此：

```
<a class="testingCase" href="#" newTitleName="name of testing case">Blabla</a>`
<a class="testingCase" href="#" newTitleName="name of another testing case">Bloo</a>` 
```

我正在考虑查找和替换，但对于如此简单的事情来说，这似乎有很多代码。是否有用于此的 jQuery 函数或简单方法？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-25T12:31:48.367

在javascript中没有“重命名”属性的内置方法/函数，但您可以创建新属性并删除其他属性...

```
$('a.testingCase[title]').each(function() {
  var $t = $(this);
  $t.attr({
      newTitleName: $t.attr('title')
    })
    .removeAttr('title');
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a class="testingCase" href="#" title="name of testing case">Blabla</a>
<a class="testingCase" href="#" title="name of another testing case">Bloo</a>
```

编辑：在位中添加，使其仅选择`a`带有 class="testingCase" 的元素

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-25T12:33:42.153

我认为您不能更改属性名称，但您可以做的是：

*   获取所有`<a>`带有title属性的标签；
*   对于它们中的每一个，创建一个与标题具有相同值的 newTitleName 属性；
*   然后删除title属性。

JQuery 让您可以通过这种方式使用内置函数来做到这一点：

```
/* get all <a> with a "title" attribute that are testingCase
then apply an anonymous function on each of them */

$('a.testingCase[title]').each(function() {   

    /* create a jquery object from the <a> DOM object */
    var $a_with_title = $(this);    

    /* add the new attribute with the title value */
    $a_with_title.attr("newTitleName", $a_with_title.getAttribute('title'));

    /* remove the old attribute */
    $a_with_title.removeAttr('title'); 

}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-07-19T14:49:21.977

稍后，但是这个[链接](http://wowmotty.blogspot.de/2011/10/jquery-rename-attribute-renameattr.html)有一个很棒的 jquery 函数扩展：

```
jQuery.fn.extend({
  renameAttr: function( name, newName, removeData ) {
    var val;
    return this.each(function() {
      val = jQuery.attr( this, name );
      jQuery.attr( this, newName, val );
      jQuery.removeAttr( this, name );
      // remove original data
      if (removeData !== false){
        jQuery.removeData( this, name.replace('data-','') );
      }
    });
  }
}); 
```

例子

```
// $(selector).renameAttr(original-attr, new-attr, removeData);

// removeData flag is true by default
$('#test').renameAttr('data-test', 'data-new' );

// removeData flag set to false will not remove the
// .data("test") value
$('#test').renameAttr('data-test', 'data-new', false ); 
```

我没有写这个。但我确实使用 JQ 1.10 进行了测试。代码来自链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-25T14:55:44.993

这是一个简单的 jquery 样式插件，它为您提供了 renameAttr 方法：

```
// Rename an entity attribute
jQuery.fn.renameAttr = function(oldName, newName) {
    var args = arguments[0] || {}; 
    var o = $(this[0]) 

       o
        .attr(
            newName, o.attr(oldName)
        )
        .removeAttr(oldName)
        ;
}; 
```

还有[这个例子](http://wowmotty.blogspot.com/2011/10/jquery-rename-attribute-renameattr.html)，它添加了一个选项来删除旧属性的数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-31T18:56:16.547

一个班轮

```
$('selector').replaceWith($('selector')[0].outerHTML.replace("oldName=","newName=")); 
```

当我需要从我的所有属性中删除前缀时，这对我很有用

```
$('selector').replaceWith($('selector')[0].outerHTML.(/prefix\-/g,"")); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-04-23T07:55:58.620

与@nickf 相同的答案，但代码更简洁：

```
$('a.testingCase[title]').each(function() {
    var curElem = $(this);
    curElem.attr("newTitleName", curElem.attr('title')).removeAttr('title');
}); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-05-17T12:35:44.117

这个对我有用！

```
$('input[name="descricao"]').attr('name', 'title'); 
```

# asp.net - 在 IIS/ASP.NET 站点上替换 .htaccess 是什么？

> ID：317175
> 
> 赞同：7
> 
> 时间：2008-11-25T12:30:24.703
> 
> 标签：asp.net, security, iis

在 Apache/PHP 网站上，如果我想在我的网站文件夹中放置一个敏感文件，我会在该文件夹中放置一个 .htaccess 文件，这样用户就无法下载敏感文件。

**IIS/ASP.NET 站点是否有类似的做法**，即如果我有一个共享主机帐户并且无权访问 IIS 服务器。例如，我可以在 web.config 中执行此操作吗？

例如，ASP.NET 配置放在 App_Data 目录中的 ASPNETDB.MDF 文件。我会假设这在默认情况下受到保护，但是我可以在哪里更改此文件夹的设置，就像使用 .htaccess 文件一样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-25T15:14:04.403

在 ASP.Net web.config 内部，您可以设置位置以向特定文件和文件夹添加安全性。此外，您可以从这些目录中删除所有动词：

```
<location path="Secret" allowOverride="false">
  <system.web>
    <authorization>
      <deny users="*" />
    </authorization>
    <httpHandlers>
      <remove path="*.*" verb="*"/>
    </httpHandlers>
  </system.web>
</location> 
```

我只使用了该片段的授权部分，效果很好。处理程序应进一步锁定它，并使用 ISAPI 过滤器对其进行最后润色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-29T11:34:39.823

好吧，如果您可以访问 IIS 设置，UrlScan 可以提供帮助。对于 IIS 7，请求过滤有很大帮助。

[http://learn.iis.net/page.aspx/473/using-urlscan](http://learn.iis.net/page.aspx/473/using-urlscan)

[http://learn.iis.net/page.aspx/143/how-to-use-request-filtering/](http://learn.iis.net/page.aspx/143/how-to-use-request-filtering/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T12:46:32.173

您可以使用 web.config 执行某些操作，例如定义安全设置等......其他时候您必须使用 HttpModules 或 HttpHandlers，请看这里：http: [//msdn.microsoft.com/en-us/library/aa719858( VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa719858(VS.71).aspx)

如果没有，您可以找到不同的 ISAPI，但在这种情况下，您需要访问 IIS。例如，用于模拟 rewrite mod apache 的 ISAPI：

[> http://www.codeplex.com/IIRF](http://www.codeplex.com/IIRF)

另一个问题，是的 APP_Data 中的 ASPNETDB.MDF 受到正常保护（这取决于您的管理员）。要更改路径，请更改连接字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T15:06:04.547

有两种情况：

*   如果服务器使用的是 IIS7，那么使用 web.config 方法可以为所有文件提供等效的功能。
*   如果服务器使用的是 IIS6 或更早版本（目前这是共享主机最有可能的情况），那么问题就更大了。如果您可以强制所有请求通过 ASP.NET 处理程序（通常需要访问服务器进行配置），那么 web.config 方法将再次起作用，但否则您将需要其他工具和有同情心的托管服务提供商. 仅出于这个原因，人们可能想要 IIS7 ......

这就是说对于 asp.net，无论如何都有默认情况下受保护的文件 - app_data 中的文件，如已经提到的以及特定的文件类型（如 .config）。此外，人们会期望一个体面的主机提供一个无法通过网络访问的目录——我们的提供一个私有文件夹和一个网络文件夹，两者都可以通过 FTP 访问，但只能通过网络访问后者的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-06T10:37:48.420

根据`[documentation on Application Folders][1]`，IIS 不会为存储在`/app_data`文件夹中的内容提供请求，尽管您的应用程序可以读取这些文件并与之交互。

> ASP.NET 可识别可用于特定类型内容的某些文件夹名称。下表列出了保留的文件夹名称和文件夹通常包含的文件类型。
> 
> **笔记**
> 
> 应用程序文件夹的内容（App_Themes 文件夹除外）不会响应 Web 请求，但可以从应用程序代码访问。

# performance - 如何对嵌套的 Sybase 存储过程进行性能测试？

> ID：317176
> 
> 赞同：3
> 
> 时间：2008-11-25T12:30:30.897
> 
> 标签：performance, tsql, stored-procedures, nested, sybase

我正在寻找任何允许对 Sybase 嵌套存储过程进行性能测试/调整的工具。周围有很多工具，当然还有 Sybase 自己的用于性能调整和测试 SQL 的工具，但是这些工具都不能处理嵌套的存储过程（即，一个存储过程调用另一个存储过程）。有人拥有/知道这样的工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-11T21:43:59.540

我不知道有什么可以做到这一点，但我很想看到一个可以做到的工具。在这种情况下，我倾向于尝试确定哪个嵌套存储过程消耗的资源最多或花费的时间最长，然后单独调整该过程的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-07T18:46:31.997

我不确定您目前使用的是哪个 Sybase DB，但您是否尝试过 Sybase Central 工具中的 Profiler？右键单击 DB Connection，然后选择 PROFILE（或 PROFILER???）

我过去曾将它用于单个存储过程，但我不记得它是否一直沿调用链从一个 SP 到另一个工作。至少它应该告诉您从您的初始 SP 调用的每个子 SP 花费了多长时间，然后您可以了解最需要时间的程序。

我希望这会有所帮助。

干杯，

凯文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-16T22:19:37.660

游戏晚了，但在 Sybase 中，您可以选择使用“SET FMTONLY”绕过“SET NOEXEC”关闭嵌套过程的评估。

例如：

假设： sp_B 已定义 sp_A 已定义并调用 sp_B

然后，下面将显示 sp_A*和**sp_B*的执行计划

```
SET SHOWPLAN ON
GO
SET FMTONLY ON
GO
sp_A
GO 
```

请参阅此处的 sybase 文章...这在 ASE 12.5 和 ASE 15 中都有效。 [使用 set showplan 和 noexec](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc00743.1502/html/queryprocessing/queryprocessing45.htm)

# performance - Sql 2008 在 Vista 64 中异常缓慢

> ID：317183
> 
> 赞同：2
> 
> 时间：2008-11-25T12:32:47.443
> 
> 标签：performance, sql-server-2008, vista64

我们的数据库服务器是 SQL 2008 服务器。

我的同事都安装了 Sql 2008 Management Studio 的 XP 服务 2，他们绝对没有性能问题。

然而，我正在运行 Vista x64 (Ultimate)，当我打开 2008 Management Studio 时，速度非常慢。连接到数据库需要将近 25 秒，所以当我针对数据库运行代码的某些部分时，我经常会遇到超时。

这台机器上的其他一切都像梦一样运行！Vista x64 上的 SQL2008 与 Windows 2003 Server 上的 SQL2008 通信是否存在问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T12:56:52.420

没关系，我在提问时遇到了问题。

Vista 具有 TCP/IP 自动调整功能。通过遵循本教程： http: [//www.vistax64.com/tutorials/72308-auto-tuning-tcp-ip-receive-level.html](http://www.vistax64.com/tutorials/72308-auto-tuning-tcp-ip-receive-level.html)我禁用了它，现在一切都像梦一样运行！

# c# - C# USING 关键字 - 何时以及何时不使用它？

> ID：317184
> 
> 赞同：26
> 
> 时间：2008-11-25T12:33:07.630
> 
> 标签：c#, dispose

我想知道什么时候应该和不应该将东西包装在 USING 块中。

据我了解，编译器将其转换为 try/finally，finally 在对象上调用 Dispose()。

我总是在数据库连接和文件访问周围使用 USING，但它更多的是出于习惯而不是 100% 的理解。我知道您应该明确（或使用）控制资源的 Dispose() 对象，以确保立即释放它们，而不是在 CLR 感觉时释放它们，但这就是我的理解崩溃的地方。

IDisposables 超出范围时是否不会被处置？

当我的对象使用 Dispose 来整理自己时，我是否只需要使用 USING ？

谢谢

编辑：我知道关于 USING 关键字还有其他几篇文章，但我对与 CLR 相关的答案以及内部发生的确切情况更感兴趣

安德鲁

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-25T12:37:30.617

不，`IDisposable`项目超出范围时不会被处置。正是出于这个原因，我们需要`IDisposable`- 进行确定性清理。

他们*最终*会被垃圾收集，如果有一个终结器，它将（可能）被调用 - 但这可能是未来很长一段时间（对连接池等不利）。垃圾收集依赖于内存压力——如果没有什么需要额外的内存，则不需要运行 GC 循环。

有趣的是（也许）在某些情况下“使用”是一种痛苦——当违规类有时会抛出异常时`Dispose()`。WCF 是一个罪犯。我在[这里](http://marcgravell.blogspot.com/2008/11/dontdontuse-using.html)讨论了这个话题（有一个简单的解决方法） 。

基本上 - 如果类实现了`IDisposable`，并且您*拥有*一个实例（即您创建了它或其他），那么您的工作就是确保它被处理掉。这可能意味着通过“使用”，或者可能意味着将其传递给另一段承担责任的代码。

我实际上已经看到了以下类型的调试代码：

```
#if DEBUG
    ~Foo() {
        // complain loudly that smoebody forgot to dispose...
    }
#endif 
```

（`Dispose`打电话的地方`GC.SuppressFinalize`）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-25T12:38:43.703

> “当 IDisposables 超出范围时，它们是否不会被丢弃？”

不。如果 IDisposable 对象是*finalizable*，这不是一回事，那么它会在垃圾回收时被终结。

这可能很快，也可能几乎永远不会。

Jeff Richter 的 C#/CLR 书在所有这些方面都非常出色，Framework Design Guidelines 书也很有用。

> 当我的对象使用 Dispose 来整理自己时，我是否只需要使用 USING ？

当对象实现 IDisposable 时，您*只能*使用“使用”。如果您尝试不这样做，编译器将反对。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T12:55:01.580

要添加到其他答案，您应该`using`在对象拥有托管内存以外的任何资源时使用（或显式 Dispose）。例如文件、套接字、数据库连接，甚至 GDI 绘图句柄。

垃圾收集器最终会最终确定这些对象，但只是在未来某个未指定的时间。您不能依赖它及时发生，同时您可能已经用完了该资源。

# c# - 在 HQL 查询的“where”子句中使用日期

> ID：317190
> 
> 赞同：4
> 
> 时间：2008-11-25T12:34:30.437
> 
> 标签：c#, nhibernate

我正在使用[SQLite](http://www.sqlite.org/)数据库并具有以下持久类（简化）：

```
public class Project
{
    public virtual int Id { get; set; }
    public virtual DateTime StartDate { get; set; }
} 
```

映射到数据库中的这个表：

```
CREATE TABLE projects (
    id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, 
    start_date DATETIME
) 
```

现在我需要编写一个查询来选择在给定月份开始的所有项目。

在 SQL 中，我可以使用：

```
SELECT id FROM projects WHERE strftime('%m', start_date) = '12' 
```

我不喜欢这个查询的是它使用了数据库特定的函数“ [strftime](http://www.sqlite.org/lang_datefunc.html) ”。

所以下面的 HQL 依赖于底层数据库：

```
// Get all projects that started in December (no matter which year)
var projects = session
    .CreateQuery(
        "from Project p " +
        "where strftime('%m', p.StartDate) = :month")
    .SetParameter("month", "12")
    .List<Project>(); 
```

我也尝试过“来自项目 p，其中 p.StartDate.Month = 12”，但它没有用。

那么使用 HQL 或标准 API 是否可以以与数据库无关的方式编写这样的查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T15:34:06.487

如果您定期查询月、日、年，那么您实际上不应该将日期存储为 DateTime 列 - 这会使查询效率极低。您可以轻松地创建一个“月份”列并对其进行查询（您的 DBA 会再次爱上您）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T08:35:26.183

我强烈建议您编写自定义函数。

[http://ayende.com/Blog/archive/2006/10/01/UsingSQLFunctionsInNHibernate.aspx](http://ayende.com/Blog/archive/2006/10/01/UsingSQLFunctionsInNHibernate.aspx)

我不是说sql函数，我指的是注册了RegisterFunction的NHibernate函数，用来增强NHibernate方言。

另一个可能更好的例子： [http ://ayende.com/Blog/archive/2007/04/27/Paged-data--Count-with-NHibernate-The-really-easy-way.aspx](http://ayende.com/Blog/archive/2007/04/27/Paged-data--Count-with-NHibernate-The-really-easy-way.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-25T20:57:06.443

来自项目 p 其中 p.StartDate.ToString("M");

# asp.net - 查找本地化文件

> ID：317191
> 
> 赞同：1
> 
> 时间：2008-11-25T12:34:32.853
> 
> 标签：asp.net, localization

在我的 asp.net 应用程序中，用户可以上传几个本地化图像（按钮）。比如他会上传'send.gif', 'send.fr.gif', 'send.en-UK,gif; ETC..

当访问者来到他的页面时，我需要根据访问者的语言环境选择正确的文件。

是否有一个 api（或简单的方法）来根据区域设置找到最合适的图像 - 例如，如果访问者来自法国，API 将返回“send.fr.gif”，如果访问者来自澳大利亚，API 将返回'send.en.gif'等...

其逻辑应该与 ASP.NET 选择正确的本地化资源文件基本相同。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T12:51:23.663

从您的帖子看来，您已经有了一种检测用户区域设置的方法。所以我会假设你持有这些信息。

我们这样做的方式是将用户区域设置存储在会话中，并将所有本地化资源存储在相应的目录名称中。例如：

```
/
    /images
        sendButton.gif
        background.gif
        /de-de/
            sendButton.gif
        /fr-fr/
            sendButton.gif 
```

然后使用 HttpHandler 根据当前用户的区域设置将本地化目录映射到默认目录的顶部。这允许将图像无缝集成到所有代码和 css 中，如果没有找到本地化图像，将使用基本目录中的图像。

如果需要更复杂的排序，那么我建议将您的国家/地区嵌套在您的语言中。像这样：

```
/
    /images
        sendButton.gif
        background.gif
        /de
            /de
                sendButton.gif
        /fr
            sendButton.gif
            /fr
            /be 
```

然后，您可以指定语言级别的资源。甚至让您的 http 处理程序映射文件以一种方式向上传播而不是向下传播。这样 fr-fr 资源将用于所有没有自己的该名称资源的法语国家。

当然，在这一点上它确实变得相当复杂，尤其是在决定使用哪个法语国家作为法语语言的默认值（如果没有指定）时。您可能希望在某处开始存储优先级，以便决定您为哪个语言环境提供服务。以及资源是向上还是向下传播。但是，作为一种用于本地化图像的透明结构，同时保持 yoru 标记和 CSS 干净，这应该会很好地工作。

# php - 将最新消息标记为...“新”

> ID：317194
> 
> 赞同：3
> 
> 时间：2008-11-25T12:35:11.497
> 
> 标签：php, mysql

在我经常去的一些网站或论坛上，我尚未阅读的条目被标记为“新”。我想在我开发的一个网站上实现这个功能（不时发布新闻）——php/mySQL。这通常是怎么做的？是否需要使用 cookie 来记住上次访问日期/时间？或者最后查看的帖子/网址？如何识别用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T13:05:30.687

Cookie 只是在会话中识别用户的一种可能方式，或者在没有身份验证的访问之间识别用户的一种可能方式。虽然是一种非常常见和有用的方式。（PHP 也可以使用 sid 或其他参数，尽管它不再常见。）

您需要存储用户已阅读或未阅读的线程/帖子。对于某些子论坛，您可以通过在“日期”或 postId 之前阅读所有内容来总结事情。

这一切都取决于您的论坛、帖子和新闻的布局，以及它们的动态程度。您可能还只想显示自上次访问以来的新帖子，在用户当前在您的站点时显示新帖子，然后如果用户离开的时间超过预定义（x 小时）/计算（ y 小时（如果是周末），z 小时（如果是管理员）时间。

编辑：已访问链接的 CSS 不会帮助您处理新闻的新评论、线程中的新帖子、直接转到第一个未读帖子或访问工作/学校和家中的网站。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T13:21:16.223

附注：这样做实际上会复制浏览器功能：（只要您使用固定网址）浏览器将为访问的链接提供不同样式的链接。当然，如果您清除历史记录，这将重置，但是如果 cookie 被删除，仅基于 cookie 的解决方案将再次清除（许多浏览器具有“删除私人数据”功能，默认情况下会同时删除两者，通常会在同时）...

*本站*有固定的url（用于问题），没有设置访问颜色和正常链接颜色一样，所以你可以通过链接颜色看到你访问过的问题。

编辑：您还可以使用 CSS[向访问的链接添加图标](http://webdesign.about.com/od/css/a/aa041904.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T12:39:54.293

Cookie 是做这类事情的唯一可靠方法。

我会使用 cookie 来存储用户上次访问的时间，但如果 cookie 不存在，我也会有一个合理的默认值，比如 1 周。

然后针对比该日期新的事物显示新的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T12:41:24.400

您可以将实际的上次访问日期存储在 cookie 中，或者您可以将该人的唯一 ID 存储在 cookie 中并跟踪他们最后在数据库中读取的内容。如果你做后者，你可以允许他们在不同的浏览器上使用相同的 id 登录，并且仍然可以获得准确的计数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T13:10:08.197

我这样做：

*   如果用户没有用户名并且没有登录，那么我不会显示新项目。
*   如果用户已登录，并且已显示所有项目，则我将当前日期/时间存储在用户文件中，并使用此值来确定哪些项目是新的。
*   如果用户日期/时间在最后十分钟内，那么我不会更新用户日期/时间。

这是我的代码...

```
function drawPage
    if (isLoggedIn) 
        get dbUser from database
        lastUserDateTime = dbUser.LastCommentTime
    else 
        lastUserDateTime = yesterdaye
    end if

    for each post
        get date of post 
        if post->date < lastUserDateTime mark it as new
        draw the post
    loop

    if (isLoggedIn) 
        if (lastUserDateTime + 10 mins) < now 
            dbUser.LastCommentTime = now
            update dbUser in database
        end if
    end if
end function 
```

# mysql - 在 MySQL 中执行交互式查询（主要来自 GUI）

> ID：317198
> 
> 赞同：1
> 
> 时间：2008-11-25T12:36:31.133
> 
> 标签：mysql, variables, prompt, interactive

我主要使用 MySQL GUI 工具。这使我可以轻松地查看表格中的结果，以及快速编辑和收藏经常运行的查询。这比命令行更适合我的需求。

我记得几年前我曾经在 Oracle DB 上执行此操作时，我可以将变量放入查询本身，以便在运行查询时提示我输入变量。

例如

```
select email from users where login = [VAR] 
```

当您运行查询时，系统会提示您输入 VAR，您可以输入`john_smith14`并执行查询。这对于您经常运行的即席查询非常有用。

是的，我知道使用 shell 脚本和命令行可以更轻松地完成此操作，但除此之外还有几个原因，shell 脚本对我来说不是一个好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T12:47:09.317

好的，一个不同的解决方案，因为看起来比尔是对的（阅读我的其他答案的评论）。

在右下角的 Params 选项卡中，您可以右键单击“Local Params”文件夹并添加一个新参数。给它一个名字，例如：“myTest”。最初，它被赋予 NULL 值。双击 NULL 并输入一个新值。

现在您可以像这样在查询中访问它：

`SELECT email FROM users WHERE login = :myTest;`

要使其在会话之间持续存在（打开和关闭查询浏览器），只需将其设为全局参数而不是本地参数。即使您重新启动 MySQL 服务器，这也有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T13:48:00.083

在这种情况下，使用准备好的语句可能对您有用。

```
PREPARE query1 FROM 从登录 = 的用户中选择电子邮件？

```

然后用你的变量执行它：

```
SET @a = '约翰';
使用@a 执行查询1；

```

此语句将在您的整个会话期间存在，并在您断开连接时删除。

这可能看起来像很多开销，但在一遍又一遍地使用相同的查询时很有用，但值略有不同。

[http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-prepared-statements.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T12:40:59.487

我不确定是否有办法让 GUI 工具提示您输入值，但您当然可以在 MySQL 中使用变量。

```
SET @myVar='john_smith14';
SELECT email FROM users WHERE login = @myVar; 
```

这可能更适合您，因为您不必每次都输入变量值..？

# c# - 字符串实习记忆

> ID：317204
> 
> 赞同：1
> 
> 时间：2008-11-25T12:38:35.030
> 
> 标签：c#, memory-management

哪里是字符串实习的好资源。. 我如何知道我的应用程序是否适合字符串实习以帮助减少内存占用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T12:44:35.860

实习由运行时自动完成。

[http://msdn.microsoft.com/en-us/library/system.string.isinterned.aspx](http://msdn.microsoft.com/en-us/library/system.string.isinterned.aspx)

# iphone - 如何在 ASP.NET 3.5 中开发可在 iPhone 3G 上查看的基于 Web 的应用程序？

> ID：317221
> 
> 赞同：2
> 
> 时间：2008-11-25T12:45:04.797
> 
> 标签：iphone, asp.net-3.5, mobile-website

我想使用 asp.net 3.5 开发一个可以在 iPhone 上查看的移动 Web 应用程序，但 VS2008 中不再有模板来启用移动开发。这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T14:24:59.260

iphone 使用您网站的“常规”版本，因此开发“移动”版本将无法完成您正在寻找的内容。如果您检测到移动 Safari，您应该检查浏览器标题并将人们重定向到您网站的 iPhone 版本。

[http://iphone.facebook.com/](http://iphone.facebook.com/)

另一种选择（如果您使用 MVC）是让您的控制器检测浏览器并在它捕获移动 safari 时显示不同的视图。这样您就不需要重复的站点，只需要两组视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:31:05.660

iPhone（至少是我的 3G 版本）完全支持带有 Ajax 和一切的“普通”网络应用程序。因此，大多数 Ajax 库都会与 iPhone 100% 兼容，至少只要 Ajax 库专注于开放标准等......

[Shameless-Plug 我与 Ra-Ajax 合作]

[Ra-Ajax](http://ra-ajax.org)对 iPhone 有 100% 的支持，除了“拖放”会干扰 iPhone 上的滚动。这意味着您可以使用 Ra-Ajax（这是一个 LGPL 许可和免费的 ASP.NET 库）来创建一个“正常”的网站，它将 100% 完美运行（除了拖放，它用于例如Ra-Windows 等）在 iPhone 上...

[即使是像我们的Ajax 日历示例](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx)这样真正“高级”的东西也可以在 iPhone 上完美运行 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:37:34.150

Web 应用程序（通过 Asp.Net 3.5）可以通过 Internet 访问，并且可以通过 iPhone 的 Safari 浏览器访问。除非您想为 iPhone 和 Blackberries 等移动设备制作真正的 Web 应用程序，否则您不需要任何真正特别的东西。在这种情况下，您只关注设计方面，因为它仍然只是一个网站。由于移动浏览器功能的多样性，您需要进行一些研究以找出针对您想要访问的特定移动浏览器的推荐内容（英国广播公司的网站是移动渲染的一个很好的例子）。

最终，用户代理由您的系统评估，然后适当地呈现（或重定向）。如果您希望页面在 iPhone 上的呈现方式与网络上的任何其他浏览器不同，那么其他一切都是设计好的。

如果你能拿到 .Net 杂志（在美国又名 Practical Web Design）第 178 期的副本，这里有一篇很棒的文章，介绍了在进行移动开发时需要注意什么以及 iPhone 的浏览器是如何使用的与其他人不同。

# c# - ASP.NET MVC 表单发布

> ID：317225
> 
> 赞同：10
> 
> 时间：2008-11-25T12:46:47.040
> 
> 标签：c#, asp.net-mvc

```
 <form action="/Villa/Add" method="post">
    <table>
        <tr>
            <td>
                Name:
            </td>
            <td>
                <%= Html.TextBox("name") %>
                <%= Html.ValidationMessage("Name") %>
            </td>
        </tr>
                <tr>
                <td>
                </td>
                <td>
                    <input type="submit" value="Add" />
                </td>
            </tr>
        </table>
        </form> 
```

我的表单在上面，如何检索控制器中的值？

提前非常感谢！很难找到合适的材料，因为 MVC 的不同预览发布并且不同。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-25T12:58:38.203

这适用于 ASP.Net MVC Beta。

```
 public ActionResult Add( string name ) {
    ....
 }

 or

 public ActionResult Add( FormCollection form ) {
      string name = form["Name"];
 }

 or

 public ActionResult Add( [Bind(Prefix="")]Villa villa ) {
       villa.Name ...
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-25T12:53:47.853

你有没有尝试过这样的事情？伪代码...

```
public class VillaController : Controller 
{
      public ActionResult Add(string name)
      {
          // Code...
      }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T12:53:42.377

它属于您定义的 url 路由。

在您的情况下，表单正在寻找一个名为“Villa”的控制器，其中的操作名为“Add”。

也许您应该阅读 ScottGu 的博客文章：[http ://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)

# sql-server - 查询获取 SQL Server 中耗时的 sql 语句

> ID：317242
> 
> 赞同：0
> 
> 时间：2008-11-25T12:55:39.677
> 
> 标签：sql-server

我们如何获取有关性能不佳的 sql 的信息（执行时间过长）

MS SQL 服务器是否维护用于存储 sql 查询的表/视图（类似于 Oracle 中的 v$sql）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T13:25:03.767

我使用 SQL Profiler 收集统计数据，然后我可以用它来确定需要做一些工作的地方，调整索引等等。

以下是有关使用 Profiler 进行监控的一些提示：http: [//www.developer.com/db/article.php/3490086](http://www.developer.com/db/article.php/3490086) [http://vyaskn.tripod.com/analyzing_profiler_output.htm](http://vyaskn.tripod.com/analyzing_profiler_output.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T14:03:50.427

看看 sys.dm_exec_query_stats 和[这个页面](http://glennberrysqlperformance.spaces.live.com/blog/cns!45041418ECCAA960!828.entry)。仅限 SQL Server 2005+。

# c# - 在客户端从 Web 打印

> ID：317256
> 
> 赞同：2
> 
> 时间：2008-11-25T13:04:29.160
> 
> 标签：c#, .net, printing

我们如何使用打印文档进行打印，以便我们可以控制打印机的纸张大小？

*   在没有打印对话框弹出或 javascript 弹出窗口的情况下，必须在虚拟主机完成后对其进行控制。
*   在没有打印对话框选项和设置纸张大小的情况下，它应该在虚拟主机上打印在客户端的打印机上。
*   它应该在 C# .net 中完成

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T13:54:42.990

您最好的选择是生成其中包含适当 siez 的 PDF 文件。除非用户在打印对话框中手动更改它，否则打​​印机应根据此选择正确的页面大小。

绕过打印对话框是一种安全限制，ActiveX 或 firefox 扩展是您唯一的选择，这在基于 Intranet 的 Web 应用程序上可能没问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T13:17:40.100

作为用户，我不希望当我进入网站时有人更改我的打印机设置或控制我的打印机。

出于安全原因，我希望这是不可能的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T13:19:44.633

我能够对打印机客户端进行大量控制的唯一方法是创建一个 ActiveX 组件来处理打印界面并从那里开始。它不是跨浏览器，也不是最干净的解决方案；但是，这是我能够管理纸张大小的唯一方法。我查看了 CSS @print 选项，但找不到可以真正控制大小的选项。

唯一的另一种可能性是查看诸如 Flash 或 Silverlight 之类的打印功能。我不知道他们是否有你要找的东西；但是，它可能是另一种选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T13:33:36.683

我相信如果您授予 Java 小程序适当的权限，它可以设置纸张大小。我认为您的用户几乎可以肯定必须跳过箍才能使其正常工作......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-13T22:09:08.120

也许为时已晚，但我正在添加以供将来参考；您可以使用一种下载/打印管理器实用程序。想象一下 torrent 磁力链接，您单击一个链接和一个由 torrent 客户端打开的 .torrent 文件，它会读取必要的信息并在客户端站点完成其余的工作。

因此，您必须编写一个小实用程序，它可以从您的网站识别这些“打印作业”。您单击 [打印发票] 链接，浏览器会下载一个唯一的 .print 文件，该实用程序会捕获它。

.print 文件有两部分：1\. 标题和 2\. 文件 (pdf/jpg/any)。标题包含预定义的打印机/纸张尺寸/方向/等，或者只是要求用户输入。然后从 2.part/body 打印文件。

您还可以将打印作业排队并进行管理。

您必须安装该实用程序；定义一个像 http:// 或 ftp:// 这样的协议来从实用程序中捕获打印链接。并为发票/彩色打印/等特定工作设置打印机/纸张/等。

当我将我们的 winforms 应用程序移植到 web 时，我会做这些。另外，如果您在 LAN 环境中，那么您会将内容从 Web 服务器打印到网络打印机。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T13:42:36.710

我以前研究过这个，强制像纵向/横向等的唯一方法是让用户安装一个 ActiveX 控件（或类似的）。

仅 Javascript 或 CSS 无法做到这一点。

# wpf - 为什么不使用部分类来构建 MVVM 模式中的 ViewModel？

> ID：317258
> 
> 赞同：1
> 
> 时间：2008-11-25T13:06:41.383
> 
> 标签：wpf, design-patterns, xaml, mvvm

为什么不使用部分类来构建 ViewModel？

既然viewmodel类的定义对datamodel的数据类有一定的定义，何不尝试减少一些工作，扩展或制作datamodel的部分类，用命令补全等等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T21:05:59.763

在某些情况下，这可能很有用，但通常 ViewModel（或 PresentationModel）有一组不同的关注点，会混淆模型的其余部分。

例如，假设您有一个表示订单处理工作流的对象模型（每个人都喜欢的示例）。同样的模型可能是 WPF、网站甚至其他服务的基础。在 WPF 应用程序中，将存在 WPF 特定的问题来表示。将这些关注点添加到主模型（即使作为部分类）会导致违反 SRP。最终，它会掩盖模型的意图，并使模型的消费者难以知道模型的哪些部分是必不可少的，哪些是偶然的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-29T13:36:31.773

我同意，但也有一些扩展似乎也属于部分类。例如，计算字段（例如发票总额）在客户端上很有用，并且视图模型可能会公开它以将数据绑定到 UI，但它实际上是实体的属性。它可能不会在模型本身中表示，因为它可以从实体的其他属性派生，并且 IMO 可以通过使用部分类来扩展域实体更好地表示。

# php - 为什么条件不好的作业？

> ID：317259
> 
> 赞同：31
> 
> 时间：2008-11-25T13:07:07.250
> 
> 标签：php, coding-style

我正在为 PHP 6.5 使用 NetBeans。

在我的代码中，我经常使用以下类型的命令：

```
if (($row = $db->get_row($sql))) {
        return $row->folder;
    } else {
        return FALSE;
    } 
```

Netbeans 告诉我，我不应该在 IF 语句中使用赋值。

为什么 ？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-11-25T13:11:46.727

它们并不坏，但它们可能导致危险的错误。

在类似 c 的语言中，赋值是一个表达式，（例如支持 a=b=c=1;）一个常见的错误是：

```
if (a = 1) { .. } 
```

但你想拥有

```
if (a == 1) { .. } 
```

一些开发人员已经学会了打字

```
if (1 == a) { .. } 
```

如果忘记了一个“=”，则创建一个错误。但我认为它并没有提高可读性。

但是现代编译器，如果你写的话，会发出警告

```
if (a = 1) { .. } 
```

我认为这是一个更好的解决方案。在这种情况下，您必须检查这是否是您真正的意思。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-25T13:10:34.327

它可能试图帮助您避免可怕的错字：

> ```
> if(a = b)
>    //logic error 
> ```

尽管我希望环境足够聪明，可以警告您，但也足够聪明，可以有“哦，别担心那种情况”的条件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T13:17:03.300

条件通常包括短路运算符。所以，给定这个例子：

```
if ( a=func(x) && b=func(y) )
{
  // do this
} 
```

这可能不是很明显，但是第二个赋值只有在第一个返回时才会发生`>0`，并且如果`func(y)`有你所期望的其他副作用，它们也不会发生。

简而言之，如果您知道自己在做什么并了解副作用，那么它没有任何问题。但是，您必须考虑在您离开时其他人可能正在维护您的代码的可能性，他们可能不像您那样有经验。

此外，未来的维护者可能会认为您的意图如下：

```
if ( a==func(x) && b==func(y) ) ... 
```

如果他们“修复”您的代码，他们实际上会破坏它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-25T13:14:16.173

在总是返回赋值值的语言中，这还*不错*（我认为这在函数式语言中很常见），但是（正如其他人在我输入这个时已经说过的那样）通常应该避免它，因为你或其他人可能会将它误认为是比较。编译器通常应该警告它，但如果你确定你在做什么，它可以被忽略......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-10T10:02:08.400

如果您不在循环条件中分配 $row 值，代码会是什么样子，我认为这将更加复杂......虽然对于某些维护者来说不是那么好阅读，不是吗？好吧，你可以这样做

```
$next = mysql_fetch_assoc($result)
do{
...
...
...

$next = mysql_fetch_assoc($result) or break;
}while ($next) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T13:13:51.760

我一直使用它们，带有循环（不知道为什么会有所作为），例如：

```
$counter = 0;
while( $getWhateverDataObj = mysql_fetch_object( $sqlResult )) {
   $getWhateverObj->firstName[$counter] = $getWhateverDataObj->firstName;
   $getWhateverObj->lastName[$counter]  = $getWhateverDataObj->lastName;
   $counter++;
} 
```

它工作正常。

# c# - C# 中两种不同类型的列表

> ID：317279
> 
> 赞同：4
> 
> 时间：2008-11-25T13:15:31.350
> 
> 标签：c#, listview, list

我目前在为我的客户使用 ShoppingCart 时遇到问题。

他希望能够在 CartItems 之间添加文本，所以我想知道是否有某种方法仍然只有一个列表。

我的解决方案是有两个列表，一个是 IList 类型，它在计算购物车的重量和总价格时被迭代，而另一个 IList 只公开在 ListView 中显示它的必要字段，它是 CartItem 的 SuperType。（但是我如何访问 listView 的其他字段，在 Description-Text-Class 中将重量和价格默认为 0 会破坏 LSP）。

但是有两个列表在某种程度上感觉有点奇怪（并且仍然给我带来问题），所以我想知道我是否可以做某种 TypedList 来指定每个项目的类型。

欢迎任何建议，我对这两种选择都不满意。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-25T13:20:29.297

使用接口：

```
 ICartListItem 
```

并使您的清单成为：

```
 List<ICartListItem> 
```

现在，创建几个类型，让它们都实现这个接口，你就可以把它们都安全地存储在你的列表中。

或者，如果您希望 CartItem 中有一些默认逻辑，请使用基类而不是接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T07:36:16.210

您可以创建一个类，并在其中定义所需列表类型的属性，然后创建一个相同类的列表。

例如，如果我想创建一个`string`s 和`bool`s 的列表，我会在一个类中创建两个属性，然后创建一个该类的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:28:01.643

界面听起来有点矫枉过正。我只需向您当前的 CartItem 添加一个名为“TextAfterItem”之类的属性。

另外：确保您的客户了解此功能在安全开销方面的成本。听起来他们认为这应该是一个简单的更新，但是您允许用户输入将直接显示回页面的文本，这是一个危险的提议。

# sql - 在 LINQ to Entity 中优化 Group By

> ID：317281
> 
> 赞同：1
> 
> 时间：2008-11-25T13:16:17.263
> 
> 标签：sql, linq, entity-framework, linq-to-entities

我在 LINQ to Entities 中有这个查询。

```
 var query = (from s in db.ForumStatsSet
                     where s.LogDate >= date1 && s.LogDate <= date2
                     group s by new { s.Topic.topicID, s.Topic.subject, s.Topic.Forum.forumName, s.Topic.datum, s.Topic.Forum.ForumGroup.name, s.Topic.Forum.forumID } into g
                     orderby g.Count() descending
                     select new TopicStatsData
                     {
                         TopicId = g.Key.topicID,
                         Count = g.Count(),
                         Subject = g.Key.subject,
                         ForumGroupName = g.Key.name,
                         ForumName = g.Key.forumName,
                         ForumId = g.Key.forumID
                     }); 
```

我知道这是一种“邪恶”查询，但它只用于管理界面。但是它生成的 SQL 绝对是可怕的。看看这个宝贝。

```
 exec sp_executesql N'SELECT TOP (50) 
[Project6].[C1] AS [C1], 
[Project6].[TopicId] AS [TopicId], 
[Project6].[C4] AS [C2], 
[Project6].[subject] AS [subject], 
[Project6].[name] AS [name], 
[Project6].[forumName] AS [forumName], 
[Project6].[C2] AS [C3]
FROM ( SELECT 
    [Project5].[TopicId] AS [TopicId], 
    [Project5].[subject] AS [subject], 
    [Project5].[forumName] AS [forumName], 
    [Project5].[name] AS [name], 
    1 AS [C1], 
     CAST( [Project5].[forumID] AS int) AS [C2], 
    [Project5].[C1] AS [C3], 
    [Project5].[C2] AS [C4]
    FROM ( SELECT 
        [Project4].[TopicId] AS [TopicId], 
        [Project4].[forumID] AS [forumID], 
        [Project4].[subject] AS [subject], 
        [Project4].[forumName] AS [forumName], 
        [Project4].[name] AS [name], 
        [Project4].[C1] AS [C1], 
        (SELECT 
            COUNT(cast(1 as bit)) AS [A1]
            FROM        [dbo].[tForumStats] AS [Extent14]
            LEFT OUTER JOIN [dbo].[tTopic] AS [Extent15] ON [Extent14].[TopicId] = [Extent15].[topicID]
            LEFT OUTER JOIN [dbo].[tForum] AS [Extent16] ON [Extent15].[forumID] = [Extent16].[forumID]
            LEFT OUTER JOIN [dbo].[tForum] AS [Extent17] ON [Extent15].[forumID] = [Extent17].[forumID]
            LEFT OUTER JOIN [dbo].[tForum] AS [Extent18] ON [Extent15].[forumID] = [Extent18].[forumID]
            LEFT OUTER JOIN [dbo].[tForumGroup] AS [Extent19] ON [Extent18].[forumGroupID] = [Extent19].[forumGroupID]
            LEFT OUTER JOIN [dbo].[tForum] AS [Extent20] ON [Extent15].[forumID] = [Extent20].[forumID]
            LEFT OUTER JOIN [dbo].[tForumGroup] AS [Extent21] ON [Extent20].[forumGroupID] = [Extent21].[forumGroupID]
            WHERE ([Extent14].[LogDate] >= @p__linq__25) AND ([Extent14].[LogDate] = @p__linq__25) AND ([Extent6].[LogDate] = @p__linq__25) AND ([Extent1].[LogDate] 
```

 `I do not as anyone to explain that query but it would be great to get some tips on how to optimze the query so that it just do a simple regular join. Something like this works as fine if I write the SQL myself.` 

```
SELECT COUNT(*) AS NumberOfViews, s.topicid AS topicId, t.subject AS TopicSubject, g.[name] AS ForumGroupName, f.forumName AS ForumName 
FROM tForumStats s
join tTopic t on s.topicid = t.topicid
join tForum f on f.forumid = t.forumid
JOIN tForumGroup g ON f.forumGroupID = g.forumGroupID
WHERE s.[LogDate] between @date1 AND @date2
group by s.topicid,  t.subject, f.Forumname, t.Datum, g.[name]
order by count(*) desc 
```

顺便说一句，我喜欢这个网站。惊人的设计和可用性！希望得到一些帮助会很好:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T13:24:33.127

您可以自己加入给定的表，而不是加入组中的所有表。你能试试这个吗？

```
from s in db.ForumStatsSet
join t in db.Topics on t.TopicId == s.TopicId
join f in db.Forums on f.ForumId == t.ForumId
join fg in db.ForumGroups on fg.ForumGroupId == f.ForumGroupId
where s.LogDate >= date1 && s.LogDate <= 
group s by new { t.TopicId, t.subject, f.forumName, t.datum, fg.name, f.forumID } into g
orderby g.Count() descending
select new TopicStatsData
{
 TopicId = g.Key.topicID,
 Count = g.Count(),
 Subject = g.Key.subject,
 ForumGroupName = g.Key.name,
 ForumName = g.Key.forumName,
 ForumId = g.Key.forumID
 }); 
```

ps：可能有一些错误，但逻辑上应该是正确的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T13:23:30.227

我认为问题出在分组结构上。尝试先提取数据（因此不需要通过属性），然后按提取的数据分组。

IOW，尝试为 SQL 编写 LINQ。

# asp.net - 创建自定义服务器控件以接受用户输入

> ID：317282
> 
> 赞同：0
> 
> 时间：2008-11-25T13:16:29.040
> 
> 标签：asp.net, postback, servercontrols

我正在尝试构建一个服务器控件，根据“QuestionTypeId”显示文本框、日期选择器或是-否单选按钮。

我的控件显示了我想要的方式，但是当在表单上按下提交按钮时，在 RenderContents 方法中生成的文本框、日期选择器或单选按钮都为空。

我试图将生成的控件存储在视图状态中，这阻止了它们为空，但没有存储用户输入。

如果需要，我会发布代码。问一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T13:31:54.003

我认为您需要在[CreateChildControls](http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx "MSDN")中创建（并添加）控件。这意味着您需要将 QuestionTypeId 的值存储在 Viewstate 或 ControlState 中（我认为 ControlState 在这种情况下适用，因为如果没有此值，您的控件将无法工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:04:03.360

一种更简单的方法是在设计时创建所有控件，并根据您的要求使控件不可见。

示例代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    txtBox.Visible = QuestionTypeID == 1;
    chkBox.Visible = QuestionTypeID == 2;
} 
```

如果您确实使用动态控件，您应该按照 David 指出的那样做，将值 QuestionTypeID 保存在 ViewState 或 ControlState 中，然后根据该值创建所需的控件。

（每次页面加载时都需要创建控件，即使在回发时也需要创建它们，并且它们不能在页面生命周期的后期创建，如果您希望它们的 ViewState 持久化和恢复，则使用 Page_Load 方法）

示例代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    var questionId = ViewState["QuestionTypeID"];

    if(questionId == /* Value to create TextBox */) {
        var txt = new TextBox { ID = "txt" };
        placeHolder.Controls.Add(txt);
    } else if(questionId == /* Value to create Calender */) {
        var cal = new Calender { ID = "cal" };
        placeHolder.Controls.Add(cal);
    }

    /* Once the controls are added they will be populated with the posted values */
} 
```

PS
使用动态控件指定 ID 总是一个好主意。
您可以将添加的控件保存到成员变量并在其他地方使用它们（在分配它们之后）
您可以订阅他们的事件，如果用户发布了一个新值，您的方法将被调用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T15:34:17.530

我听从了您的建议并做了以下事情：

1）问题类型存储在我的服务器控件的视图状态中。

2) 现在在 CreateChildControls 上创建我的控件的新实例并将其添加到页面上的占位符。

我现在的问题是事情似乎有点奇怪：

1）在页面初始加载时，会触发创建子控件，并触发我的服务器控件的 RenderContents 方法。

2）单击按钮以加载新联系人，这会触发创建子控件并触发 RenderContents。

3）输入详细信息并按下保存，这会触发 Create Child Controls 但不会触发 RenderContents 并且通过尝试访问我的控件以获取值来生成 NullReferenceException。（如果我跳过访问我的控件的代码，则会调用 RenderContents 并进行渲染。

其次，另一个问题是，当我尝试设置一个值（onDataBind）时，我尝试访问在我的服务器控件中生成的文本框并获取另一个 NullReferanceExeption

想法？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T13:30:07.780

当您动态添加控件时，您需要确保在恢复视图状态之前重新创建它们。

我有一段时间没有这样做了，但从记忆中我认为你应该在 OnInit 方法中重新创建你的控件。这发生在加载回发数据之前以及控件从视图状态设置其值之前。

关于 asp.net 页面生命周期可能值得阅读：

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T13:32:52.033

您可以为文本框、日期选择器、单选按钮创建用户控件并使用服务器控件。

如果您创建一个自定义服务器控件，那么您必须将发布的数据添加到您的控件属性中。您可以在您的控制 OnInit 事件中执行此操作：

```
MyProperty = Request.Form("myControl"); 
```

# visual-studio - VS 2008 Team System 在打开解决方案时崩溃

> ID：317292
> 
> 赞同：1
> 
> 时间：2008-11-25T13:19:56.413
> 
> 标签：visual-studio, visual-studio-2008, tfs

VS 2008 在打开解决方案文件时崩溃，当它到达“正在加载项目文件'解决方案项'”阶段时。

有没有办法阻止解决方案项目的虚拟文件夹打开或解决此问题？该解决方案来自 TFS 2005 和源代码控制。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T23:15:36.180

您可以尝试的另一件事是删除解决方案的 .suo 文件。此文件包含您的个人设置，有时可能会损坏。它还包含退出时打开的文档，因此删除此文件也会清除该列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T13:25:35.527

.sln（和 .csproj）文件只是文本文件。因此，您可以在文本编辑器中打开解决方案文件并删除有问题的项目或项目的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T23:17:20.077

您是否尝试过创建新解决方案并将旧解决方案中的项目添加到其中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T23:17:56.283

我也遇到了崩溃 Visual Studio 的问题。当我重置窗口位置时，我的消失了。

不过，我不确定你的崩溃是这样的。

# iphone - 不要为网页中的特定文本框显示 iPhone 键盘？

> ID：317295
> 
> 赞同：24
> 
> 时间：2008-11-25T13:20:37.067
> 
> 标签：iphone, html, web-applications

是否有任何设置使用 iPhone 键盘不会出现在网页中的特定文本框？可能是一些css类型的设置？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-09T10:57:52.310

您只需将输入字段设置为**readonly="true"** / readonly 模式，这样键盘就不会出现！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T13:31:46.653

您是否希望文本框可以在 iPhone 以外的任何其他浏览器中进行编辑？如果没有，您是否尝试禁用文本框？我没有尝试过，也不记得在我的 iPhone 上看到过一个禁用的文本框；但是，它可能会这样做。

*如果禁用文本框有效*，但您仍只想将其限制为 iPhone，则需要查看 iPhone 的用户代理。您可以通过服务器端代码或 JavaScript 的`navigator.userAgent`.

为了为您节省更多时间，iPhone 的用户代理如下：

```
Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en) AppleWebKit/420.1 (KHTML, like Gecko) Version/3.0 Mobile/3B48b Safari/419.3 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-07T04:20:02.520

请记住， readonly="true" 不是必需的。

`<input type="text" readonly>`足够。

*   [W3学校](http://www.w3schools.com/tags/att_input_readonly.asp)
*   [StackOverflow 回答 2011 年 5 月 30 日](https://stackoverflow.com/questions/6172911/what-is-the-difference-between-readonly-true-readonly-readonly)
*   [HTML生活标准](http://www.whatwg.org/specs/web-apps/current-work/multipage/common-input-element-attributes.html#the-readonly-attribute)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-30T19:24:46.363

如果您想为 iphone/ipad/ipod 用户隐藏键盘，您必须识别此用户代理。我建议[http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/)找到这些设备的不同版本，然后`readonly="true" disabled="disabled"`在输入上打印。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T15:50:01.727

我认为您无法真正禁用键盘，就像您通过 PC 或 Mac 浏览网页时无法真正禁用键盘一样。一种技巧是添加 JavaScript 来拦截 OnKeyPress（或 OnKeyDown）事件以拦截击键并根据用户代理取消它。我没有专门针对 iPhone 尝试过它，但是当我想限制启用的文本框上的输入类型（即取消电话号码字段中的字母字符）时，它适用于其他应用程序。由于“OnKey”事件在 iPhone 上仍然有效（由 Google 等具有自动完成功能的网站确定），因此该方法应该可以工作。

# ftp - 所有子目录的 FTP 客户端中的 chmod 语法

> ID：317302
> 
> 赞同：2
> 
> 时间：2008-11-25T13:23:19.277
> 
> 标签：ftp, chmod, subdirectory

哪个 ftp 客户端或哪种语法允许对子目录进行简单的 chmod？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T14:11:53.090

如果客户端允许，LFTP 允许递归 CHMOD。您可以通过从 Unix/Linux CLI 使用 LFTP 登录来完成此操作，然后运行以下命令：

```
chmod -R 0755 /www/directory/* 
```

您还可以为此设置一个真正漂亮的 Bash 脚本：

```
#!/bin/bash
lftp <<EOF
set ftp:ssl-allow no
set ftp:passive-mode true
set ftp:list-options -a
open -u [user],[password] [host]
chmod -R 0777 /www/directory/*
EOF 
```

当然 LFTP 不区分文件和文件夹，为了分别在文件/文件夹上运行此命令，我建议使用 FileZilla。在文件夹上运行命令时，它允许这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T13:27:02.483

chmod 你所在位置的所有子目录（递归）：

```
chmod -R * 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T05:44:50.463

正如@Ken G 的回答所暗示的，这更有可能是“FTP 服务器支持什么”的问题。

我尝试了 ncftp（在 Win XP 上的 Cygwin 下运行）针对在 Solaris 10 上运行的 Sun FTP（其中`chmod -R`受 o/s 版本的支持`chmod`）。我收到了一个错误：

```
ncftp /work1/jleffler/tmp > chmod -R g+x *
chmod g+x: server said: 'SITE CHMOD -R g+x': command not understood.
chmod *: server said: 'SITE CHMOD -R xx.pl': command not understood.
ncftp /work1/jleffler/tmp > 
```

我的怀疑是很少有系统可以使它变得容易。值得检查一下 NCFTP 服务器是否对您有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T13:35:54.227

我很确定[Filezilla](http://filezilla-project.org/)做到了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T13:42:28.380

`chmod`如果 FTP 服务器支持，[ncftp](http://www.ncftp.com/)将支持该命令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-14T04:43:55.263

```
chmod -R 755 {DIR} 
```

你用 -R 递归

# wpf - WrapPanel 中不需要的剪辑

> ID：317306
> 
> 赞同：0
> 
> 时间：2008-11-25T13:24:23.283
> 
> 标签：wpf, wrappanel

我需要使用 WrapPanel ItemsTemplate 创建一个 ListBox。

我的项目显示为带有小顶部“工具栏”的卡片，在鼠标悬停时动态显示。

[动态。工具栏] [卡片]

除了第一行，一切都运行良好。

我需要让卡片彼此非常接近。因此，项目的高度设置为没有工具栏高度的卡片高度。使用 Margin.Top < 0 创建工具栏。

问题是工具栏被列表框剪裁了。

你知道如何解决这种情况的任何技术吗？

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-05T04:06:55.997

我不确定我是否完全理解您的问题，但是如果您使用负上边距在卡片上方显示工具栏，您不能通过在显示工具栏时在卡片上动态设置正边距来弥补这一点吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-05T14:41:56.353

Xaml 会有所帮助。我发现的一条经验法则是永远不要设置控件的实际高度或宽度属性。尝试取出 height 属性，这应该可以消除剪裁。您应该能够使用 Margin、Padding 或 MinHeight 计算出所需的任何间距。

# perl - 如何在 Perl 中创建多维数组？

> ID：317310
> 
> 赞同：18
> 
> 时间：2008-11-25T13:25:13.360
> 
> 标签：perl, arrays, data-structures, multidimensional-array

我对 Perl 有点陌生，但这是我想做的：

```
my @array2d;
while(<FILE>){
  push(@array2d[$i], $_);
} 
```

它不能编译，因为`@array2d[$i]`它不是数组而是标量值。

我应该如何将@array2d 声明为数组数组？

当然，我不知道我有多少行。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-25T13:34:03.077

要创建数组数组，或者更准确地说是数组引用数组，请尝试以下操作：

```
my @array = ();
foreach my $i ( 0 .. 10 ) {
  foreach my $j ( 0 .. 10 ) {
    push @{ $array[$i] }, $j;
  }
} 
```

它为您将值推送到取消引用的 arrayref 上。您应该能够访问这样的条目：

```
print $array[3][2]; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-25T13:38:45.127

将您的“推”线更改为：

```
push(@{$array2d[$i]}, $_); 
```

您基本上是通过将 $array2d[$i] 包围在 @{}... 周围来制作一个数组...然后您可以将元素推送到这个数组引用数组上。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T13:32:57.463

查看[perlref](http://perldoc.perl.org/perlref.html)和[perldsc](http://perldoc.perl.org/perldsc.html)以了解如何制作嵌套数据结构，例如数组的数组和散列的散列。做 Perl 时非常有用的东西。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T15:13:21.863

你写的和这个真的没有区别：

```
@{$array2d[$i]} = <FILE>; 
```

我只能假设您正在遍历文件。

为避免跟踪计数器，您可以这样做：

```
...
push @array2d, [ <FILE> ];
... 
```

也就是说 1）创建对空数组的引用，2）将所有行存储在 FILE 中，3）将其推送到`@array2d`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T13:53:24.550

另一种简单的方法是使用哈希表并使用两个数组索引来制作哈希键：

```
$two_dimensional_array{"$i $j"} = $val; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-28T03:03:39.407

如果您只是想将文件存储在数组中，您也可以这样做：

```
fopen(FILE,"<somefile.txt");
@array = <FILE>;
close (FILE); 
```

# iphone - 从特定于语言环境的字符串中获取 NSDecimalNumber？

> ID：317311
> 
> 赞同：15
> 
> 时间：2008-11-25T13:25:33.327
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, internationalization

我有一些特定于语言环境的字符串（例如，0.01 或 0,01）。我想将此字符串转换为 NSDecimalNumber。从[到目前为止我在互联网上看到的示例中](http://developer.apple.com/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfNumberFormatting10_4.html)，这是通过使用 NSNumberFormatter 来完成的：

```
NSString *s = @"0.07";

NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
[formatter setGeneratesDecimalNumbers:YES];
NSDecimalNumber *decimalNumber = [formatter numberFromString:s];

NSLog([decimalNumber stringValue]); // prints 0.07000000000000001 
```

我正在使用 10.4 模式（除了根据文档推荐之外，它也是 iPhone 上唯一可用的模式），但向格式化程序指示我想要生成十进制数字。请注意，我已经简化了我的示例（我实际上是在处理货币字符串）。但是，我显然做错了，因为它返回了一个说明浮点数不精确的值。

将特定于语言环境的数字字符串转换为 NSDecimalNumber 的正确方法是什么？

编辑：请注意，我的示例是为了简单起见。我要问的问题也应该与您何时需要获取特定于语言环境的货币字符串并将其转换为 NSDecimalNumber 相关。此外，这可以扩展为特定于区域设置的百分比字符串并将其转换为 NSDecimalNumber。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-05-20T18:34:45.927

多年后：

`+(NSDecimalNumber *)decimalNumberWithString:(NSString *)numericString`在`NSDecimalNumber`.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-26T14:26:25.577

根据 Boaz Stuller 的回答，我为此问题向 Apple 记录了一个错误。在解决这个问题之前，以下是我认为最好的解决方法。这些变通方法仅依赖于将十进制数四舍五入到适当的精度，这是一种可以补充现有代码的简单方法（而不是从格式化程序切换到扫描程序）。

**通用编号**

本质上，我只是根据对我的情况有意义的规则对数字进行四舍五入。因此，YMMV 取决于您支持的精度。

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
[formatter setGeneratesDecimalNumbers:TRUE];

NSString *s = @"0.07";

// Create your desired rounding behavior that is appropriate for your situation
NSDecimalNumberHandler *roundingBehavior = [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:NSRoundPlain scale:2 raiseOnExactness:FALSE raiseOnOverflow:TRUE raiseOnUnderflow:TRUE raiseOnDivideByZero:TRUE]; 

NSDecimalNumber *decimalNumber = [formatter numberFromString:s];
NSDecimalNumber *roundedDecimalNumber = [decimalNumber decimalNumberByRoundingAccordingToBehavior:roundingBehavior];

NSLog([decimalNumber stringValue]); // prints 0.07000000000000001
NSLog([roundedDecimalNumber stringValue]); // prints 0.07 
```

**货币**

处理货币（这是我试图解决的实际问题）只是处理一般数字的轻微变化。关键是舍入行为的比例由区域设置货币使用的最大小数位数决定。

```
NSNumberFormatter *currencyFormatter = [[NSNumberFormatter alloc] init];
[currencyFormatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
[currencyFormatter setGeneratesDecimalNumbers:TRUE];
[currencyFormatter setNumberStyle:NSNumberFormatterCurrencyStyle];

// Here is the key: use the maximum fractional digits of the currency as the scale
int currencyScale = [currencyFormatter maximumFractionDigits];

NSDecimalNumberHandler *roundingBehavior = [NSDecimalNumberHandler decimalNumberHandlerWithRoundingMode:NSRoundPlain scale:currencyScale raiseOnExactness:FALSE raiseOnOverflow:TRUE raiseOnUnderflow:TRUE raiseOnDivideByZero:TRUE]; 

// image s is some locale specific currency string (eg, $0.07 or €0.07)
NSDecimalNumber *decimalNumber = (NSDecimalNumber*)[currencyFormatter numberFromString:s];
NSDecimalNumber *roundedDecimalNumber = [decimalNumber decimalNumberByRoundingAccordingToBehavior:roundingBehavior];

NSLog([decimalNumber stringValue]); // prints 0.07000000000000001
NSLog([roundedDecimalNumber stringValue]); // prints 0.07 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-25T16:23:34.577

这似乎有效：

```
NSString *s = @"0.07";

NSScanner* scanner = [NSScanner localizedScannerWithString:s];
NSDecimal decimal;
[scanner scanDecimal:&decimal];
NSDecimalNumber *decimalNumber = [NSDecimalNumber decimalNumberWithDecimal:decimal];

NSLog([decimalNumber stringValue]); // prints 0.07 
```

另外，请对此提出错误。这绝对不是您在那里看到的正确行为。

编辑：在 Apple 修复此问题（然后每个潜在用户都更新到固定的 OSX 版本）之前，您可能必须使用 NSScanner 滚动自己的解析器或接受输入数字的“仅”双精度。除非您打算在此应用中使用五角大楼的预算，否则我建议您使用后者。实际上，双打精确到小数点后 14 位，因此在任何低于 1 万亿美元的情况下，它们的折扣都不到一分钱。我不得不为一个项目编写基于 NSDateFormatter 的我自己的日期解析例程，并且我花了一个月的时间来处理所有有趣的边缘情况，（比如只有瑞典在其长日期中包含星期几）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T16:32:59.517

另请参阅[在 C++ 中存储货币值的最佳方式](https://stackoverflow.com/questions/149033/best-way-to-store-currency-values-in-c)

处理货币的最佳方法是对货币的最小单位使用整数值，即美分表示美元/欧元等。您将避免代码中出现任何与浮点相关的精度错误。

考虑到这一点，解析包含货币值的字符串的最佳方法是手动进行（使用可配置的小数点字符）。在小数点处拆分字符串，并将第一部分和第二部分解析为整数值。然后使用从这些中构建您的组合价值。

# asp.net - ASP.NET MVC 相对路径

> ID：317315
> 
> 赞同：102
> 
> 时间：2008-11-25T13:27:56.567
> 
> 标签：asp.net, asp.net-mvc

在我的应用程序中，我经常不得不使用相对路径。例如，当我引用 JQuery 时，我通常会这样做：

```
<script type="text/javascript" src="../Scripts/jquery-1.2.6.js"></script> 
```

现在我正在过渡到 MVC，我需要考虑一个页面可能具有的不同路径，相对于根。这当然是过去 URL 重写的一个问题，但我设法通过使用一致的路径来解决它。

我知道标准解决方案是使用绝对路径，例如：

```
<script type="text/javascript" src="/Scripts/jquery-1.2.6.js"></script> 
```

但这对我不起作用，因为在开发周期中，我必须部署到应用程序将在虚拟目录中运行的测试机器上。当根更改时，根相对路径不起作用。此外，出于维护原因，我不能简单地更改部署测试期间的所有路径——这本身就是一场噩梦。

那么最好的解决方案是什么？

编辑：

由于这个问题仍在收到意见和答案，我认为更新它以注意从 Razor V2 开始，支持根相对 url，因此您可以使用

```
<img src="~/Content/MyImage.jpg"> 
```

没有任何服务器端语法，视图引擎会自动将 ~/ 替换为当前站点根目录。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2008-11-25T13:36:49.297

试试这个：

```
<script type="text/javascript" src="<%=Url.Content("~/Scripts/jquery-1.2.6.js")%>"></script> 
```

或者使用[MvcContrib](http://www.codeplex.com/MVCContrib)并执行以下操作：

```
<%=Html.ScriptInclude("~/Content/Script/jquery.1.2.6.js")%> 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-09-17T14:58:20.953

虽然是一篇旧文章，但新读者应该知道 Razor 2 及更高版本（MVC4+ 中的默认设置）完全解决了这个问题。

带有 Razor 1 的旧 MVC3：

```
<a href="@Url.Content("~/Home")">Application home page</a> 
```

带有 Razor 2 及更高版本的新 MVC4：

```
<a href="~/Home">Application home page</a> 
```

没有尴尬的 Razor 函数式语法。没有非标准的标记标签。

在任何 HTML 属性中使用波浪号 ('~') 为路径添加前缀会告诉 Razor 2 通过替换正确的路径来“让它工作”。这很棒。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-04-25T20:13:58.823

## 重大变化 - MVC 5

注意 MVC 5 中的重大变更（来自[MVC 5 发行说明](http://www.asp.net/visual-studio/overview/2012/aspnet-and-web-tools-20131-for-visual-studio-2012)）

> ### 网址重写和波浪号（~）
> 
> 升级到 ASP.NET Razor 3 或 ASP.NET MVC 5 后，如果您使用 URL 重写，波浪号 (~) 表示法可能不再正常工作。URL 重写会影响 HTML 元素（如 `<A/>`、`<SCRIPT/>`、 ）中的波浪号 (~) 符号，`<LINK/>`因此波浪号不再映射到根目录。
> 
> 例如，如果您**将对 asp.net/content**的请求重写为**asp.net**，则其中的 href 属性 `<A href="~/content/"/>`解析为 **/content/content/**而不是**/**。要禁止此更改，您可以在每个网页或 Global.asax 中的 **Application_BeginRequest中将****IIS_WasUrlRewritten**上下文设置为 false 。

 **他们实际上并没有解释如何做到这一点，但后来我找到[了这个答案](https://stackoverflow.com/questions/12099658/how-can-i-use-url-action-and-html-actionlink-when-my-application-is-pointed-some)：

> 如果您在 IIS 7 集成管道模式下运行，请尝试将以下内容放入您的`Global.asax`：

```
 protected void Application_BeginRequest(object sender, EventArgs e)
 {
     Request.ServerVariables.Remove("IIS_WasUrlRewritten");
 } 
```

注意：您可能需要首先检查`Request.ServerVariables`实际包含`IIS_WasUrlRewritten`以确保这是您的问题所在。

* * *

PS。我以为我遇到了这种情况，并且我正在将`src="~/content/..."`URLS 生成到我的 HTML 中 - 但事实证明，当我的代码被编译时，有些东西并没有令人耳目一新。编辑和重新保存布局和页面 cshtml 文件以某种方式触发了某些工作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-25T13:35:48.283

在 ASP.NET 中，我通常使用`<img src='<%= VirtualPathUtility.ToAbsolute("~/images/logo.gif") %>' alt="Our Company Logo"/>`. 我不明白为什么类似的解决方案不应该在 ASP.NET MVC 中工作。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-25T13:38:56.453

```
<script src="<%=ResolveUrl("~/Scripts/jquery-1.2.6.min.js") %>" type="text/javascript"></script> 
```

是我用的。更改路径以匹配您的示例。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-25T14:32:53.723

对于它的价值，我真的很讨厌用服务器标签乱扔我的应用程序只是为了解决路径的想法，所以我做了更多的研究并选择使用我之前尝试过的东西来重写链接 - 响应过滤器。通过这种方式，我可以使用已知前缀为所有绝对路径添加前缀，并在运行时使用 Response.Filter 对象替换它，而不必担心不必要的服务器标签。代码发布在下面，以防它对其他人有所帮助。

```
using System;
using System.IO;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;

namespace Demo
{
    public class PathRewriter : Stream
    {
        Stream filter;
        HttpContext context;
        object writeLock = new object();
        StringBuilder sb = new StringBuilder();

        Regex eofTag = new Regex("</html>", RegexOptions.IgnoreCase | RegexOptions.Compiled);
        Regex rootTag = new Regex("/_AppRoot_", RegexOptions.IgnoreCase | RegexOptions.Compiled);

        public PathRewriter(Stream filter, HttpContext context)
        {
            this.filter = filter;
            this.context = context;
        }

        public override void Write(byte[] buffer, int offset, int count)
        {
            string temp;

            lock (writeLock)
            {
                temp = Encoding.UTF8.GetString(buffer, offset, count);
                sb.Append(temp);

                if (eofTag.IsMatch(temp))
                    RewritePaths();
            }
        }

        public void RewritePaths()
        {
            byte[] buffer;
            string temp;
            string root;

            temp = sb.ToString();
            root = context.Request.ApplicationPath;
            if (root == "/") root = "";

            temp = rootTag.Replace(temp, root);
            buffer = Encoding.UTF8.GetBytes(temp);
            filter.Write(buffer, 0, buffer.Length);
        }

        public override bool CanRead
        {
            get { return true; }
        }

        public override bool CanSeek
        {
            get { return filter.CanSeek; }
        }

        public override bool CanWrite
        {
            get { return true; }
        }

        public override void Flush()
        {
            return;
        }

        public override long Length
        {
            get { return Encoding.UTF8.GetBytes(sb.ToString()).Length; }
        }

        public override long Position
        {
            get { return filter.Position; }
            set { filter.Position = value; }
        }

        public override int Read(byte[] buffer, int offset, int count)
        {
            return filter.Read(buffer, offset, count);
        }

        public override long Seek(long offset, SeekOrigin origin)
        {
            return filter.Seek(offset, origin);
        }

        public override void SetLength(long value)
        {
            throw new NotImplementedException();
        }
    }

    public class PathFilterModule : IHttpModule
    {
        public void Dispose()
        {
            return;
        }

        public void Init(HttpApplication context)
        {
            context.ReleaseRequestState += new EventHandler(context_ReleaseRequestState);
        }

        void context_ReleaseRequestState(object sender, EventArgs e)
        {
            HttpApplication app = sender as HttpApplication;
            if (app.Response.ContentType == "text/html")
                app.Response.Filter = new PathRewriter(app.Response.Filter, app.Context);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-09-21T22:37:17.760

MVC 3 的 Razor 视图引擎使使用在运行时正确解析的虚拟根相对路径变得更加容易和清晰。只需将 Url.Content() 方法放入 href 属性值中，它就会正确解析。

```
<a href="@Url.Content("~/Home")">Application home page</a> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-01T00:04:38.683

像 Chris 一样，我真的不能忍受必须将臃肿的服务器端标签放在我的干净标记中，只是为了告诉愚蠢的事情从根向上查找。这应该是一个非常简单、合理的要求。但我也讨厌必须努力编写任何自定义 C# 类来做这么简单的事情，我为什么要这样做？真是浪费时间。

对我来说，我只是在“完美”上妥协，并在我的路径引用中硬编码了虚拟目录的根路径名。所以像这样：

```
<script type="text/javascript" src="/MyProject/Scripts/jquery-1.2.6.js"></script> 
```

解析 URL 不需要服务器端处理或 C# 代码，这对性能来说是最好的，尽管我知道无论如何它都可以忽略不计。在我漂亮的干净标记中没有臃肿丑陋的服务器端混乱。

我只需要知道这是硬编码的，并且当事物迁移到正确的域而不是[http://MyDevServer/MyProject/时需要将其删除](http://MyDevServer/MyProject/)

干杯

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-16T16:43:58.047

我根据类似的 SO 帖子采用了一些不同的方法，但代码少得多......

[http://a.shinynew.me/post/6042784654/relative-paths-in-asp-net-mvc-javascript](http://a.shinynew.me/post/6042784654/relative-paths-in-asp-net-mvc-javascript)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-03-02T21:06:20.973

游戏迟到了，但[这篇文章](http://www.west-wind.com/weblog/posts/132081.aspx)对处理 ASP.Net 路径有一个非常完整的总结。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-12-02T19:24:42.917

我使用一个简单的辅助方法。您可以轻松地在视图和控制器中使用它。

标记：

```
<a href=@Helper.Root()/about">About Us</a> 
```

辅助方法：

```
public static string Root()
{
    if (HttpContext.Current.Request.Url.Host == "localhost")
    {
        return "";
    }
    else
    {
        return "/productionroot";
    }
} 
```

# sql - 针对树结构的优化 SQL

> ID：317322
> 
> 赞同：36
> 
> 时间：2008-11-25T13:31:46.873
> 
> 标签：sql, sql-server, tree-structure

如何从性能最佳的数据库中获取树状结构数据？例如，假设您在数据库中有一个文件夹层次结构。其中 folder-database-row 有**ID**、**Name**和**ParentID**列。

你会使用一种特殊的算法来一次获取所有数据，最大限度地减少数据库调用的数量并在代码中处理它吗？

或者您会使用对数据库进行多次调用并直接从数据库中完成结构吗？

也许有基于 x 数量的数据库行、层次结构深度或其他什么的不同答案？

**编辑**：我使用 Microsoft SQL Server，但其他角度的答案也很有趣。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-25T13:44:55.427

这实际上取决于您将如何访问树。

一种巧妙的技术是给每个节点一个字符串 id，其中父节点的 id 是子节点的可预测子字符串。例如，父级可能是“01”，子级可能是“0100”、“0101”、“0102”等。这样您可以一次从数据库中选择整个子树：

```
SELECT * FROM treedata WHERE id LIKE '0101%'; 
```

因为条件是初始子字符串，ID 列上的索引会加快查询速度。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-17T20:37:09.300

在 RDMS 中存储树的所有方法中，最常见的是邻接表和嵌套集。嵌套集针对读取进行了优化，并且可以在单个查询中检索整个树。邻接列表针对写入进行了优化，可以在简单的查询中添加。

使用邻接列表，每个节点都具有引用父节点或子节点的列（其他链接也是可能的）。使用它，您可以基于父子关系构建层次结构。不幸的是，除非您限制树的深度，否则您无法在一个查询中提取整个内容，并且读取它通常比更新它要慢。

使用嵌套集模型，反之亦然，读取快速且容易，但更新变得复杂，因为您必须维护编号系统。嵌套集模型通过使用基于前序的编号系统枚举所有节点来对父系和排序顺序进行编码。

我使用了嵌套集模型，虽然它对于读取优化大型层次结构很复杂，但它是值得的。一旦你做了一些练习来绘制树并给节点编号，你应该掌握它的窍门。

我对这种方法的研究始于这篇文章：[Managing Hierarchical Data in MySQL](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-25T14:31:34.333

在我工作的产品中，我们在 SQL Server 中存储了一些树结构，并使用上述技术将节点的层次结构存储在记录中。IE

```
tblTreeNode
TreeID = 1
TreeNodeID = 100
ParentTreeNodeID = 99
Hierarchy = ".33.59.99.100."
[...] (actual data payload for node) 
```

维护层次结构当然是一个棘手的问题，并且会使用触发器。但是在插入/删除/移动时生成它永远不会递归，因为父级或子级的层次结构具有您需要的所有信息。

你可以得到所有节点的后代：

```
SELECT * FROM tblNode WHERE Hierarchy LIKE '%.100.%' 
```

这是插入触发器：

```
--Setup the top level if there is any
UPDATE T 
SET T.TreeNodeHierarchy = '.' + CONVERT(nvarchar(10), T.TreeNodeID) + '.'
FROM tblTreeNode AS T
    INNER JOIN inserted i ON T.TreeNodeID = i.TreeNodeID
WHERE (i.ParentTreeNodeID IS NULL) AND (i.TreeNodeHierarchy IS NULL)

WHILE EXISTS (SELECT * FROM tblTreeNode WHERE TreeNodeHierarchy IS NULL)
    BEGIN
        --Update those items that we have enough information to update - parent has text in Hierarchy
        UPDATE CHILD 
        SET CHILD.TreeNodeHierarchy = PARENT.TreeNodeHierarchy + CONVERT(nvarchar(10),CHILD.TreeNodeID) + '.'
        FROM tblTreeNode AS CHILD 
            INNER JOIN tblTreeNode AS PARENT ON CHILD.ParentTreeNodeID = PARENT.TreeNodeID
        WHERE (CHILD.TreeNodeHierarchy IS NULL) AND (PARENT.TreeNodeHierarchy IS NOT NULL)
    END 
```

这是更新触发器：

```
--Only want to do something if Parent IDs were changed
IF UPDATE(ParentTreeNodeID)
    BEGIN
        --Update the changed items to reflect their new parents
        UPDATE CHILD
        SET CHILD.TreeNodeHierarchy = CASE WHEN PARENT.TreeNodeID IS NULL THEN '.' + CONVERT(nvarchar,CHILD.TreeNodeID) + '.' ELSE PARENT.TreeNodeHierarchy + CONVERT(nvarchar, CHILD.TreeNodeID) + '.' END
        FROM tblTreeNode AS CHILD 
            INNER JOIN inserted AS I ON CHILD.TreeNodeID = I.TreeNodeID
            LEFT JOIN tblTreeNode AS PARENT ON CHILD.ParentTreeNodeID = PARENT.TreeNodeID

        --Now update any sub items of the changed rows if any exist
        IF EXISTS (
                SELECT * 
                FROM tblTreeNode 
                    INNER JOIN deleted ON tblTreeNode.ParentTreeNodeID = deleted.TreeNodeID
            )
            UPDATE CHILD 
            SET CHILD.TreeNodeHierarchy = NEWPARENT.TreeNodeHierarchy + RIGHT(CHILD.TreeNodeHierarchy, LEN(CHILD.TreeNodeHierarchy) - LEN(OLDPARENT.TreeNodeHierarchy))
            FROM tblTreeNode AS CHILD 
                INNER JOIN deleted AS OLDPARENT ON CHILD.TreeNodeHierarchy LIKE (OLDPARENT.TreeNodeHierarchy + '%')
                INNER JOIN tblTreeNode AS NEWPARENT ON OLDPARENT.TreeNodeID = NEWPARENT.TreeNodeID

    END 
```

还有一点，一个检查约束，以防止树节点中的循环引用：

```
ALTER TABLE [dbo].[tblTreeNode]  WITH NOCHECK ADD  CONSTRAINT [CK_tblTreeNode_TreeNodeHierarchy] CHECK  
((charindex(('.' + convert(nvarchar(10),[TreeNodeID]) + '.'),[TreeNodeHierarchy],(charindex(('.' + convert(nvarchar(10),[TreeNodeID]) + '.'),[TreeNodeHierarchy]) + 1)) = 0)) 
```

我还建议使用触发器来防止每棵树有多个根节点（空父节点），并防止相关节点属于不同的 TreeID（但这些比上面的要简单一些。）

您需要检查您的特定情况，以查看此解决方案是否可以接受。希望这可以帮助！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-25T15:15:45.010

Celko 写了这件事（2000 年）：

[http://www.dbmsmag.com/9603d06.html](http://www.dbmsmag.com/9603d06.html)

[http://www.intelligententerprise.com/001020/celko1_1.jhtml;jsessionid=3DFR02341QLDEQSNDLRSKHSCJUNN2JVN?_requestid=32818](http://www.intelligententerprise.com/001020/celko1_1.jhtml;jsessionid=3DFR02341QLDEQSNDLRSKHSCJUNN2JVN?_requestid=32818)

* * *

和其他人问：

[在 oracle 树查询中连接其他表](https://stackoverflow.com/questions/117512/joining-other-tables-in-oracle-tree-queries)

[如何使用 SQL 计算树中值的总和](https://stackoverflow.com/questions/91360/how-to-calculate-the-sum-of-values-in-a-tree-using-sql)

[如何在数据库中存储目录/层次/树结构？](https://stackoverflow.com/questions/144344/how-to-store-directory-hierarchy-tree-structure-in-the-database)

[MYSQL中递归存储过程获取分层数据的性能](https://stackoverflow.com/questions/221194/performance-of-recursive-stored-procedures-in-mysql-to-get-hierarchical-data)

[将平面表解析为树的最有效/优雅的方法是什么？](https://stackoverflow.com/questions/192220/what-is-the-most-efficientelegant-way-to-parse-a-flat-table-into-a-tree)

* * *

最后，您可以查看 rails "acts_as_tree" (read-heavy) 和 "acts_as_nested_set" (write-heavy) 插件。我没有一个很好的链接来比较它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-25T13:46:16.750

针对层次结构的查询有几种常见类型。大多数其他类型的查询都是这些查询的变体。

1.  从父母那里，找到所有孩子。

    一个。到特定深度。例如，给定我的直系父母，深度为 1 的所有孩子都是我的兄弟姐妹。

    湾。到树底。

2.  从一个孩子，找到所有的父母。

    一个。到特定深度。例如，我的直系父母是深度为 1 的父母。

    湾。到无限的深度。

(a) 案例（特定深度）在 SQL 中更容易。特殊情况（深度=1）在 SQL 中是微不足道的。非零深度更难。可以通过有限数量的连接来完成有限但非零的深度。（b）的情况，深度不定（到顶部，到底部），真的很难。

如果您的树**很大**（数百万个节点），那么无论您尝试做什么，您都处于一个受伤的世界。

如果你的树有一百万个节点，只需将它全部提取到内存中并在那里处理它。在 OO 世界中，生活要简单得多。只需获取行并在返回行时构建树。

如果你有一棵**巨大**的树，你有两个选择。

*   用于处理无限获取的递归游标。这意味着结构的维护是 O(1) - 只需更新几个节点就可以了。但是获取是 O(n*log(n)) 因为您必须为每个具有子节点的节点打开一个游标。

*   聪明的“堆编号”算法可以对每个节点的父代进行编码。一旦每个节点都正确编号，一个简单的 SQL SELECT 就可以用于所有四种类型的查询。然而，对树结构的更改需要重新编号节点，与检索成本相比，更改成本相当高。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T13:37:46.610

如果数据库中有很多树，并且只能取出整棵树，我会为数据库中的每个节点存储一个树 ID（或根节点 ID）和父节点 ID，获取所有节点特定的树 ID，以及内存中的进程。

但是，如果要获取子树，则只能获取特定父节点 ID 的子树，因此您需要存储每个节点的所有父节点才能使用上述方法，或者在下降到时执行多个 SQL 查询树（希望树中没有循环！），尽管您可以重用相同的 Prepared Statement（假设节点具有相同的类型并且都存储在单个表中）以防止重新编译 SQL，因此它可能不会更慢，实际上，如果将数据库优化应用于查询，它可能会更可取。可能想要运行一些测试来找出答案。

如果您只存储一棵树，您的问题将成为仅查询子树之一，并应用第二个答案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T13:37:59.963

我喜欢存储与其 parentID 关联的 ID 的简单方法：

```
ID     ParentID
1      null
2      null
3      1
4      2
...    ... 
```

它易于维护，并且非常可扩展。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-25T13:40:08.867

谷歌“物化路径”或“遗传树”......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-25T13:42:47.600

在 Oracle 中有 SELECT ... CONNECT BY 语句来检索树。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-25T13:50:09.830

[这篇文章](http://www.sqlteam.com/article/more-trees-hierarchies-in-sql)很有趣，因为它展示了一些检索方法以及一种将沿袭存储为派生列的方法。沿袭提供了一种无需太多连接即可检索层次结构的快捷方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-13T10:37:59.643

不适用于所有情况，但例如给出评论结构：

```
ID | ParentCommentID 
```

您还可以存储`TopCommentID`代表最多评论的内容：

```
ID | ParentCommentID | TopCommentID 
```

`TopCommentID`和`ParentCommentID`在哪里`null`或`0`何时是最重要的评论。对于子评论，`ParentCommentID`指向其上方的评论，并`TopCommentID`指向最顶层的父评论。

# c# - .NET 和 Java 客户端应用程序之间的 IPC

> ID：317327
> 
> 赞同：7
> 
> 时间：2008-11-25T13:33:14.310
> 
> 标签：c#, java, .net, ipc

我必须在没有任何代理或服务器的情况下获得两个不同的客户端应用程序对话。在 Java 和 .NET 这两个进程之间进行 IPC 的最佳方法是什么？

它必须能够在多用户终端服务器上工作，所以请不要使用套接字。我希望它是轻量级和简单的，即插即用的，所以请不要使用 RMI/WS。

我现在正在考虑使用 JNI 来访问互斥体和命名管道，我会朝着正确的方向前进吗？

欢迎任何想法！

谢谢丹尼斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-10-31T20:07:16.997

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程内桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T15:42:49.527

您可以通过 JNI(Java) 和 PInvoke(C#) 访问 WinAPI。使用以下 WinAPI 函数： CreateEvent SetEvent WaitForSingleObject CreateMutex ReleaseMutex CreateFileMapping（用于共享内存） MapViewOfFile UnmapViewOfFile

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T17:35:59.750

我会使用[protobuf](http://code.google.com/p/protobuf/ "协议缓冲区")。

> 协议缓冲区是一种以高效且可扩展的格式对结构化数据进行编码的方法。Google 几乎所有内部​​ RPC 协议和文件格式都使用协议缓冲区。

# c# - 为什么我不能返回列表 如果被要求提供列表 ?

> ID：317335
> 
> 赞同：7
> 
> 时间：2008-11-25T13:36:22.293
> 
> 标签：c#, generics, interface

我明白，如果`S`是 的子类`T`，则 a`List<S>`不是**的**子类`List<T>`。美好的。但是接口有一个不同的范式：如果`Foo`implements `IFoo`，那么为什么 a`List<Foo>`不是 a （的一个例子）`List<IFoo>`？

由于可能没有实际的类`IFoo`，这是否意味着在公开 a 时我总是必须强制转换列表的每个元素`List<IFoo>`？或者这只是糟糕的设计，我必须定义自己的集合类`ListOfIFoos`才能使用它们？在我看来两者都不合理...

鉴于我正在尝试对接口进行编程，那么公开此类列表的最佳方式是什么？我目前倾向于将我的`List<Foo>`内部实际存储为`List<IFoo>`.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-25T13:45:39.263

`List<Foo>`如果`List<IFoo>`您不能在其中存储对象，那么您不是子类`MyOwnFoo`，这也恰好是一个`IFoo`实现。（[里氏替换原理](http://en.wikipedia.org/wiki/Liskov_substitution_principle)）

`List<IFoo>`存储 a而不是专用的想法`List<Foo>`是可以的。如果您需要将列表的内容转换为它的实现类型，这可能意味着您的接口不合适。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-25T13:57:12.377

这是一个为什么你不能这样做的例子：

```
// Suppose we could do this...
public List<IDisposable> GetDisposables()
{
    return new List<MemoryStream>();
}

// Then we could do this
List<IDisposable> disposables = GetDisposables();
disposables.Add(new Form()); 
```

那时，为保存 MemoryStreams 而创建的列表现在有一个表单。坏的！

所以基本上，存在这个限制是为了维护类型安全。在 C# 4 和 .NET 4.0 中，对此的支持*有限*（称为*variance*），但由于上述原因，它仍然不支持这种特定场景。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-25T13:40:22.597

在您的返回函数中，您必须使列表成为接口列表，并且在创建对象时，将其作为实现它的对象。像这样：

> ```
> function List<IFoo> getList()
> {
>   List<IFoo> r = new List<IFoo>();
>   for(int i=0;i<100;i++)
>       r.Add(new Foo(i+15));
> 
>   return r;
> } 
> ```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-25T13:39:35.360

**大规模编辑** ~~您可以使用 C# 4.0 来完成，但是~~[感谢 Jon]

您可以使用以下方法解决它[`ConvertAll`](http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx)：

```
public List<IFoo> IFoos()
{
    var x = new List<Foo>(); //Foo implements IFoo
    /* .. */
    return x.ConvertAll<IFoo>(f => f); //thanks Marc
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T13:55:21.210

简单的答案是`List<Foo>`与 不同的类型，例如，与不同`List<IFoo>`的方式相同。`DateTime``IPAddress`

但是，您所拥有的事实`IFoo`意味着集合`IFoo`应该包含至少两个`IFoo`( `FooA`,`FooB`等...) 的实现，因为如果您希望只有一个 , 的实现`IFoo`，`Foo`那么该`IFoo`类型是多余的。

因此，如果接口只有一种派生类型，请忘记接口并节省开销。如果接口有两个或多个派生类型，则始终在集合/通用参数中使用接口类型。

如果您发现自己正在编写 thunking 代码，那么某处可能存在设计缺陷。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-03T15:06:24.317

如果在`IList<T>`发明之时，Microsft 已经意识到 .net 的未来版本将支持接口协变和逆变，那么将接口拆分为 , 和继承上述两者将是可能且`IReadableList<out T>`有用`IAppendable<in T>`的`IList<T>`。这样做会给 vb.net 实现者带来少量额外工作（他们必须同时定义索引属性的只读和读写版本，因为出于某种原因 .net 不允许读写属性作为只读属性），但这意味着只需要从列表中读取项目的方法可以`IReadableList<T>`以协变方式接收，而只需要它们可以附加到的集合的方法可以`IAppendable<T>`以逆变方式接收。

不幸的是，今天实现这样的事情的唯一方法是，如果微软提供了一种新接口可以替代旧接口的方法，旧接口的实现会自动使用新接口提供的默认方法。我认为这样的功能（界面可替代性）会非常有帮助，但我不会屏住呼吸等待微软实现它。

鉴于没有办法回适应`IReadableList<T>`，`IList<T>`另一种方法是定义自己的列表相关接口。这样做的一个困难是，所有的实例都必须用其他类型替换，尽管如果要在包含单个字段并定义扩展转换的不同命名空间`System.Collections.Generic.List<T>`中定义结构，则可以最大限度地减少这样做的难度往返于系统类型（使用结构而不是类意味着代码将避免在无需对结构进行装箱的情况下进行强制转换时创建新堆对象的需要）。`List<T>``System.Collections.Generic.List<T>`

# php - 如何在 PHP 中提取字符串的前 100 个字符

> ID：317336
> 
> 赞同：100
> 
> 时间：2008-11-25T13:36:23.523
> 
> 标签：php, string

我正在寻找一种从字符串变量中提取前 100 个字符以放入另一个变量进行打印的方法。

有没有可以轻松做到这一点的功能？

例如：

```
$string1 = "I am looking for a way to pull the first 100 characters from a string variable to put in another variable for printing.";
$string2 = 100charfunction($string1);
print $string2 
```

要得到：

```
I am looking for a way to pull the first 100 characters from a string vari 
```

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2008-11-25T13:38:47.513

```
$small = substr($big, 0, 100); 
```

对于[String Manipulation](http://ca3.php.net/manual/en/ref.strings.php)，这是一个包含许多功能的页面，可能会对您未来的工作有所帮助。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-11-25T13:44:16.550

我猜你可以使用 substr：

```
$string2 = substr($string1, 0, 100); 
```

或 mb_substr 用于多字节字符串：

```
$string2 = mb_substr($string1, 0, 100); 
```

您可以创建一个使用此函数的函数并附加例如`'...'`以表明它已缩短。（我猜这个贴出来的时候已经有一百个类似的回复了……）

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-06-13T19:51:34.243

一个迟到但有用的答案，PHP 有一个专门用于此目的的函数。

[mb_srimwidth](http://www.php.net/manual/en/function.mb-strimwidth.php)

```
$string = mb_strimwidth($string, 0, 100);
$string = mb_strimwidth($string, 0, 97, '...'); //optional characters for end 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-11-25T13:49:48.897

```
$x = '1234567';

echo substr ($x, 0, 3); // 输出 123

echo substr ($x, 1, 1); // 输出 2

echo substr ($x, -2); // 输出 67

echo substr ($x, 1); // 输出 234567

echo substr ($x, -2, 1); // 输出 6

```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-11-25T13:39:11.287

试试这个功能

```
function summary($str, $limit=100, $strip = false) {
    $str = ($strip == true)?strip_tags($str):$str;
    if (strlen ($str) > $limit) {
        $str = substr ($str, 0, $limit - 3);
        return (substr ($str, 0, strrpos ($str, ' ')).'...');
    }
    return trim($str);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-01-30T11:00:45.413

没有php内部函数：

```
function charFunction($myStr, $limit=100) {    
    $result = "";
    for ($i=0; $i<$limit; $i++) {
        $result .= $myStr[$i];
    }
    return $result;    
}

$string1 = "I am looking for a way to pull the first 100 characters from a string variable to put in another variable for printing.";

echo charFunction($string1); 
```

# java - Axis2 WSDL2Java：生成的存根中缺少无参数操作

> ID：317362
> 
> 赞同：0
> 
> 时间：2008-11-25T13:42:34.073
> 
> 标签：java, web-services, wsdl, axis2, wsdl2java

我的网络服务中有一个简单的`public boolean isAlive()`服务。我在我的 WSDL 中定义了它：

```
<wsdl:types>
    <xsd:element name="isAliveResponse" type="xsd:boolean">
    </xsd:element>
</wsdl:types>
<wsdl:message name="isAliveResponse">
    <wsdl:part element="ns:isAliveResponse" name="parameters"/>
</wsdl:message>
<wsdl:portType name="myService">
    <wsdl:operation name="isAlive">
        <wsdl:output message="ns:isAliveResponse"/>
    </wsdl:operation>
</wsdl:portType>
<wsdl:binding name="myServiceSOAP" type="ns:myService">
<soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http" />
    <wsdl:operation name="isAlive">
    <soap:operation soapAction="http://myServiceURL/isAlive" />
    <wsdl:input>
        <soap:body use="literal" />
    </wsdl:input>
    <wsdl:output>
        <soap:body use="literal" />
    </wsdl:output>
</wsdl:operation>
</wsdl:binding> 
```

当我生成服务框架时，方法是生成的，但不在客户端存根中。WSDL 有问题吗？即使该方法没有参数，我是否应该放置一个 wsdl:input（我没有放置整个 WSDL，但所有其他带有“请求”参数的方法都生成得很好）？如果我必须放一个 wsdl:input 它的消息是什么？

**编辑**：在 Eclipse 下验证 WSDL 后，我 `WS-I: (BP2208) wsdl:operation was not a request/response or one-way operation`在搜索后收到警告，我在这里找到了描述：[http](http://www.ws-i.org/Testing/Tools/2005/01/BP11_TAD_1-1.htm#BP2208) ://www.ws-i.org/Testing/Tools/2005/01/BP11_TAD_1-1.htm#BP2208 （似乎锚不起作用）所以我猜错误可能是缺少 wsdl:input。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T15:26:19.327

正如我在编辑中所说，问题是缺少 wsdl:input。通过增加

```
<wsdl:input message="ns:isAliveRequest" /> 
```

和

```
<wsdl:message name="isAliveRequest"></wsdl:message> 
```

然后我原来的问题就解决了......结论，我应该先自己搜索更多，然后再问SO :(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:16:06.707

我不确定这是否是您的问题，但以下行似乎没有结束标记：

```
<wsdl:types>
    <xsd:element name="isAliveResponse" type="xsd:boolean">
</wsdl:types> 
```

它应该是这样的：

```
<wsdl:types>
    <xsd:element name="isAliveResponse" type="xsd:boolean"/>
</wsdl:types> 
```

希望这可以帮助。

# operating-system - 在 Solaris 上查看内存使用情况的综合方法

> ID：317364
> 
> 赞同：22
> 
> 时间：2008-11-25T13:42:45.587
> 
> 标签：operating-system, solaris, sysadmin

在 Linux 上，“top”命令显示了您的内存使用的详细但高级的概述，显示：

总内存、已用内存、可用内存、缓冲区使用情况、缓存使用情况、交换大小和交换使用情况。

我的问题是，有哪些命令可以清晰简单地显示这些内存使用数据？如果它们存在于 Solaris 的“核心”安装中，则会获得奖励积分。'sar' 不算数:)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-05T08:22:13.797

这是基础知识。我不确定这些中的任何一个都算作“清晰和简单”。

**`ps(1)`**

对于进程级视图：

```
$ ps -opid,vsz,rss,osz,args
  PID  VSZ  RSS   SZ COMMAND
 1831 1776 1008  222 ps -opid,vsz,rss,osz,args
 1782 3464 2504  433 -bash
$ 
```

vsz/VSZ：总虚拟进程大小（kb）

rss/RSS：驻留集大小（kb，可能不准确（！），见 man）

osz/SZ：内存中的总大小（页）

从页面计算字节大小：

```
$ sz_pages=$(ps -o osz -p $pid | grep -v SZ )
$ sz_bytes=$(( $sz_pages * $(pagesize) ))
$ sz_mbytes=$(( $sz_bytes / ( 1024 * 1024 ) ))
$ echo "$pid OSZ=$sz_mbytes MB" 
```

**`vmstat(1M)`**

```
$ vmstat 5 5 
 kthr      memory            page            disk          faults      cpu
 r b w   swap  free  re  mf pi po fr de sr rm s3 -- --   in   sy   cs us sy id
 0 0 0 535832 219880  1   2  0  0  0  0  0 -0  0  0  0  402   19   97  0  1 99
 0 0 0 514376 203648  1   4  0  0  0  0  0  0  0  0  0  402   19   96  0  1 99
^C 
```

**`prstat(1M)`**

```
 PID USERNAME  SIZE   RSS STATE  PRI NICE      TIME  CPU PROCESS/NLWP       
  1852 martin   4840K 3600K cpu0    59    0   0:00:00 0.3% prstat/1
  1780 martin   9384K 2920K sleep   59    0   0:00:00 0.0% sshd/1
  ... 
```

**`swap(1)`**

“长列表”和“摘要”模式：

```
$ swap -l
swapfile             dev  swaplo blocks   free
/dev/zvol/dsk/rpool/swap 256,1      16 1048560 1048560
$ swap -s 
total: 42352k bytes allocated + 20192k reserved = 62544k used, 607672k available
$ 
```

**`top(1)`**

Sun 的 Solaris 配套 CD 上提供了旧版本 (3.51)，并声明这是“社区（非 Sun）支持”。可从 sunfreeware.com 或 blastwave.org 获得更多最新的二进制包。

```
load averages:  0.02,  0.00,  0.00;                      up 2+12:31:38                                                                                            08:53:58
31 processes: 30 sleeping, 1 on cpu
CPU states: 98.0% idle,  0.0% user,  2.0% kernel,  0.0% iowait,  0.0% swap
Memory: 1024M phys mem, 197M free mem, 512M total swap, 512M free swap

   PID USERNAME LWP PRI NICE  SIZE   RES STATE    TIME    CPU COMMAND
  1898 martin     1  54    0 3336K 1808K cpu      0:00  0.96% top
     7 root      11  59    0   10M 7912K sleep    0:09  0.02% svc.startd 
```

**`sar(1M)`**

有什么问题`sar`？:)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-27T19:39:52.970

```
# echo ::memstat | mdb -k
Page Summary                Pages                MB  %Tot
------------     ----------------  ----------------  ----
Kernel                       7308                57   23%
Anon                         9055                70   29%
Exec and libs                1968                15    6%
Page cache                   2224                17    7%
Free (cachelist)             6470                50   20%
Free (freelist)              4641                36   15%

Total                       31666               247
Physical                    31256               244 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T13:57:16.790

“top”通常在 Solaris 上可用。

如果没有，则恢复为大多数 UNIX 系统上可用的“vmstat”。

它应该看起来像这样（来自 AIX 框）

```
vmstat

系统配置：lcpu=4 mem=12288MB ent=2.00

kthr 内存页面错误 cpu
----- ----------- ------------ ---------- -- ----------
 rb avm fre re pi po fr sr cy in sy cs us sy id wa pc ec
 2 1 1614644 585722 0 0 1 22 104 0 808 29047 2767 12 8 77 3 0.45 22.3

```

列“avm”和“fre”告诉你总内存和空闲内存。

“man vmstat”应该可以为您提供血腥的细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-01T18:30:35.990

Top 可以从源代码编译或从 sunfreeware.com 下载。如前所述， vmstat 可用（我相信它在核心安装中？）。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-02-04T11:49:40.743

命令`free`很好。需要一点时间来理解“+/- 缓冲区/缓存”，但想法是缓存和缓冲区在评估“空闲”时并不真正计算在内，因为它可以立即转储。因此，要查看您有多少可用（和已用）内存，您需要删除缓存/缓冲区使用情况——这对您来说很方便。

# python - 关于带参数的字符串的新手 Python 问题：“%%s”？

> ID：317368
> 
> 赞同：5
> 
> 时间：2008-11-25T13:43:04.790
> 
> 标签：python, string

我试图弄清楚以下行到底做了什么 - 特别是 %%s 部分？

```
cursor.execute('INSERT INTO mastertickets (%s, %s) VALUES (%%s, %%s)'%sourcedest, (self.tkt.id, n)) 
```

关于字符串格式化和使用 Python 将变量插入字符串的任何好的迷你教程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T13:48:23.157

`%%`成为一个单一的`%`。这段代码本质上是在做两级字符串格式化。首先`%sourcedest`执行将您的代码基本上变成：

```
cursor.execute('INSERT INTO mastertickets (BLAH, FOO) VALUES (%s, %s)', (self.tkt.id, n)) 
```

然后 db 层将参数应用于剩余的插槽。

需要 double-% 才能使 db 的插槽安全地通过第一个字符串格式化操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T14:11:35.293

“但是应该怎么做呢？”

艰难的召唤。问题是他们正在动态地将元数据（特别是列名）插入到 SQL 语句中。我不是这种事情的忠实粉丝。该`sourcedest`变量有两个将要更新的列名。

很可能只有一对（或几对）实际使用的列名。我的偏好是这样做。

```
if situation1:
    stmt= "INSERT INTO mastertickets (this, that) VALUES (?, ?)"
elif situation2:
    stmt= "INSERT INTO mastertickets (foo, bar) VALUES (?, ?)"
else:
    raise Exception( "Bad configuration -- with some explanation" )
cursor.execute( stmt, (self.tkt.id, n) ) 
```

当此类事物有多个有效的列组合时，表明数据模型已将两个实体合并到一个表中，这是一个常见的数据库设计问题。由于您正在使用产品和插件，因此您对数据模型问题无能为力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T14:16:47.420

只要不是用户提供的，使用字符串格式插入列名并没有那么糟糕。这些值应该是查询参数：

```
stmt = "INSERT INTO mastertickets (%s, %s) VALUES (?, ?)" % srcdest
...
cursor.execute( stmt, (self.tkt.id, n) ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T13:44:17.113

%% 变成单个 %

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T14:18:06.373

它做同样的事情：

```
cursor.execute('INSERT INTO mastertickets (%s, %s) VALUES (:%s, :%s)' % \
    tuple(sourcedest + sourcedest), dict(zip(sourcedest, (self.tkt.id, n)))) 
```

永远不要那样做。

# integration - Worldship 批量导入

> ID：317374
> 
> 赞同：2
> 
> 时间：2008-11-25T13:44:39.297
> 
> 标签：integration, shipping, ups, ups-worldship

我正在尝试将包含姓名、地址和邮政编码的 .csv 文件导入 WorldShip。我设置了两个配置文件，定义包裹重量、UPS 服务、账单运输、包裹类型和参考号。

我可以只导入特定配置文件下的姓名、地址和邮政编码以保持其他变量不变吗？还是我必须将这些变量添加到 .csv 文件中？

此外，我希望能够在一天中打印多个“批次”的运输和退货标签，但只有一个日终报告。每批是否会附加到日终报告中？退货送货地址将保持不变。

我有基本的编程能力和相当好的计算机技能，但我想知道我是否太过分了。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-02T20:04:15.377

我认为你可以做你想做的事。我没有玩过 Worldship 很多，但我知道它是基于 Access 的，你可以访问所有表等。但是，我在 Worldship 8 之后没有看到任何东西，但我确实有一个亲戚在工作UPS 为 Worldship 提供支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-28T06:02:28.837

你可以看看shiprush SDK。它对那种事情有好处，并且可以同时进行 UPS 和邮政运输。

（对不起，我没有大量的世界航行经验，但我做过很多航运......）

# sql-server - 用于搜索数据库的where子句中的SQL if语句

> ID：317377
> 
> 赞同：14
> 
> 时间：2008-11-25T13:45:26.033
> 
> 标签：sql-server, tsql, stored-procedures, filtering, if-statement

我正在创建一个存储过程来返回搜索结果，其中某些参数是可选的。

我想在*where*子句中添加“if 语句”，但无法正常工作。*where*子句应仅按非空参数过滤。

这里是sp

```
ALTER PROCEDURE spVillaGet 
-- Add the parameters for the stored procedure here
@accomodationFK int = null,
@regionFK int = null,
@arrivalDate datetime,
@numberOfNights int,
@sleeps int = null,
@priceFloor money = null,
@priceCeil money = null
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

-- Insert statements for procedure here
select tblVillas.*, tblWeeklyPrices.price from tblVillas
INNER JOIN tblWeeklyPrices on tblVillas.villaId = tblWeeklyPrices.villaFK
where 
    If @accomodationFK <> null then
        accomodationTypeFK = @accomodationFK 
     @regionFK <> null Then
        And regionFK = @regionFK 
    IF @sleeps <> null Then
        And sleeps = @sleeps 
    IF @priceFloor <> null Then
        And price >= @priceFloor And price <= @priceCeil

END 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-25T13:48:36.840

```
select tblVillas.*, tblWeeklyPrices.price 
from tblVillas
INNER JOIN tblWeeklyPrices on tblVillas.villaId = tblWeeklyPrices.villaFK
where (@accomodationFK IS null OR accomodationTypeFK = @accomodationFK)
  AND (@regionFK IS null or regionFK = @regionFK)
  AND (@sleeps IS null OR sleeps = @sleeps)
  AND (@priceFloor IS null OR (price BETWEEN @priceFloor And @priceCeil)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T14:16:56.860

过去我们在这里使用了很多`COALESCE`“[动态 WHERE 子句](http://www.sqlteam.com/article/implementing-a-dynamic-where-clause)”，就像你在说的那样。

```
SELECT *
FROM  vehicles
WHERE ([vin]   LIKE COALESCE(@vin, [vin])     + '%' ESCAPE '\')
  AND ([year]  LIKE COALESCE(@year, [year])   + '%' ESCAPE '\')
  AND ([make]  LIKE COALESCE(@make, [make])   + '%' ESCAPE '\')
  AND ([model] LIKE COALESCE(@model, [model]) + '%' ESCAPE '\') 
```

但是，当您想要选择性地过滤一个也可以为空的列时，就会出现一个大问题......如果列中的数据是`null`给定行的，并且用户没有输入任何内容来搜索该列（所以用户输入也是`null`)，那么该行**甚至不会出现在结果**中（如果您的过滤器是可选的，则它是不正确的排除行为）。

为了补偿可空字段，您最终不得不像这样执行看起来更混乱的 SQL：

```
SELECT *
FROM  vehicles
WHERE (([vin]   LIKE COALESCE(@vin, [vin])     + '%' ESCAPE '\')
       OR (@vin IS NULL AND [vin] IS NULL))
  AND (([year]  LIKE COALESCE(@year, [year])   + '%' ESCAPE '\')
       OR (@year IS NULL AND [year] IS NULL))
  AND (([make]  LIKE COALESCE(@make, [make])   + '%' ESCAPE '\')
       OR (@make IS NULL AND [make] IS NULL))
  AND (([model] LIKE COALESCE(@model, [model]) + '%' ESCAPE '\')
       OR (@model IS NULL AND [model] IS NULL)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T13:59:49.687

您还可以使用 IsNull 或 Coalesce 函数

```
Where accomodationTypeFK = IsNull(@accomodationFK, accomodationTypeFK)
    And regionFK = Coalesce(@regionFK,regionFK)
    And sleeps = IsNull(@sleeps,sleeps ) 
    And price Between IsNull(@priceFloor, Price) And IsNull(priceCeil, Price) 
```

这与迈克尔上面的建议相同......

IsNull() 和 Coalesce() 的工作方式或多或少相同，它们返回列表中的第一个非 Null 参数，除了 iSNull 只允许 2 个参数，并且 Coalesce 可以采用任何数字...

[http://blogs.msdn.com/sqltips/archive/2008/06/26/differences-between-isnull-and-coalesce.aspx](http://blogs.msdn.com/sqltips/archive/2008/06/26/differences-between-isnull-and-coalesce.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:35:42.483

正如你所理解的，IF 是 T-SQl 中的程序代码。它不能用于插入/更新/删除/选择语句中，它只能用于确定要运行的两个语句中的哪一个。当你在一个语句中需要不同的可能性时，你可以像上面那样做或使用 CASE 语句。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-12-30T17:54:09.560

尝试将 IF 语句放在整个 SQL 语句周围。这意味着每个条件都有一个 SQL 语句。这对我有用。

# jquery - jQuery 重新绑定悬停事件（助手）

> ID：317378
> 
> 赞同：0
> 
> 时间：2008-11-25T13:45:31.760
> 
> 标签：jquery, binding

页面加载完成后，我调用一个函数，将悬停事件置于 $('a.tooltip') 上。当我想*取消绑定*此事件时，我执行以下操作：

```
 $('a.tooltip').unbind('mouseover mouseout'); 
```

这样可行！但是，当我想重新绑定悬停事件并再次调用在文档就绪时首次加载的函数时，它不会重新绑定悬停助手。我怎样才能重新绑定它？

谢谢，

冰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T14:16:16.657

你确定解绑工作正常吗？以我的经验， .hover() 确实重新绑定正确，但我不得不使用这种取消绑定语法：

```
$(this).unbind('mouseenter').unbind('mouseleave'); 
```

当我尝试将这两个事件放入一个 unbind() 时，它只解绑其中一个。

我想知道这是否发生在你身上？（或者如果`mouseover`vs`mouseenter`等的选择很重要？）

### 更新

根据[quirksmode.org](http://www.quirksmode.org/js/events_mouse.html)，`mouseenter`和`mouseleave`是特定于 IE 的事件，但正如 Jimmy 在评论中指出的那样，jQuery 也为其他浏览器实现了它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:51:40.033

我发现当我使用 bind 方法时，事情可能有点麻烦。您可能想尝试使用 hover(over, out) 函数，如下所示：

```
 $(this).hover( 
    function() {
       if (okayToHover) { dowhatever; } 
    },
    function() {
       if (okayToUnhover) { undowhatever; }
    }); 
```

我知道这似乎有点迂回，但我发现悬停功能让我对正在发生的事情有了更多的控制，而且无论出于何种原因，它似乎都能更好地工作。不过这只是我的经验...

# asp.net-mvc - MVC 新手 | 来自不同来源的视图中的数据

> ID：317381
> 
> 赞同：1
> 
> 时间：2008-11-25T13:46:26.767
> 
> 标签：asp.net-mvc, model-view-controller

好的，所以我一直在看一些 MVC 视频并阅读一些内容。我是整个 MVC 模式的新手，到目前为止，我一直很高兴地沉浸在 Web 表单世界中！

就像有这么多演示一样，这一切看起来都很棒，我相信随着我的前进，我会有很多我不明白的地方，但首先......

我可以看到你可以有一个强类型视图，它从控制器获取数据。如果我想要来自不同对象类型的视图中的数据会发生什么？假设我想展示一个网格的汽车和一个网格的人，它们无论如何都不相关？？

谢谢史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T13:53:22.040

使用这样的两个属性设置您的强类型 ViewData 类

```
public class MyViewData 
{ 
  public IEnumerable<Car> Cars { get; set; }
  public IEnumerable<People> People { get; set; }
} 
```

然后将它们填写在控制器中，抱歉重复。本着良好的 MVC 精神，尽可能使用接口使您的代码更通用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T14:17:22.693

您可以保持然后分开（逻辑上和物理上）然后在视图中将各个部分拉到一起，而不是人为地将模型组合在一起。

查看这篇文章，了解 [link text][1] 的详细解释。

[1]：[http](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/) : //blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/partial-requests

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T13:49:10.580

您可以在 ViewData 哈希表中传递这两个对象，或者创建一个 MyViewViewModel，添加两个属性，然后从您的控制器中设置它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T13:52:25.333

我认为在这种情况下最好的做法是在 Models 文件夹中创建一个类来保存这两种类型。

例子：

```
public class CarsPeopleModel
    {
        public List<Car> Cars { get; set; }
        public List<Person> People { get; set; }
    } 
```

那么你的观点是：

```
public partial class Index : ViewPage<MvcApplication1.Models.CarsPeopleModel>
    {
    } 
```

# jquery - Jquery Rest 与 WCF 3.5 的通信

> ID：317389
> 
> 赞同：4
> 
> 时间：2008-11-25T13:49:27.773
> 
> 标签：jquery, asp.net-mvc, wcf, rest

我正在测试在 asp.net mvc 站点和 WCF 3.5 服务之间交换休息消息的基础知识。该服务是使用 codeplex 上的 WCF REST Starter Kit 中的模板构建的。我想使用 jquery 交换 json 消息。REST Singleton 服务工作正常，它还提供了在 uri 末尾添加帮助参数和所有可能调用的示例。我到达后使用内置的 jquery $.getJSON 执行 GET 请求。我在执行 PUT（用于更新值）和 POST 时遇到问题。

```
$.ajax({
     type: "PUT",
     dataType: "json",
     url: "http://localhost:1045/Service.svc/?format=json",
     data: '{"Value":testvalue}'
 }); 
```

最好的方法是什么？是否可以完全不使用Ajax女士，绕过它是否正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-30T07:03:53.287

还要确保在 ajax 调用中正确设置了**contentType 。**

> `contentType: "application/json"`

*JQuery 默认是*

> `contentType: "application/x-www-form-urlencoded"`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T14:06:38.847

根据jQuery，并非所有浏览器都支持“PUT”和“DELETE”

> 要发出的请求类型（“POST”或“GET”），默认为“GET”。注意：这里也可以使用其他 HTTP 请求方法，例如 PUT 和 DELETE，但并非所有浏览器都支持。

[http://docs.jquery.com/Ajax/jQuery.ajax#options](http://docs.jquery.com/Ajax/jQuery.ajax#options)

虽然我并没有真正理解你的问题。您在执行 PUT 和 POST 或只是 POST 时遇到问题？GET 工作正常吗？

我注意到的一个错误是您的数据，请注意我添加了它没有引号。

```
$.ajax({
     type: "PUT",
     dataType: "json",
     url: "http://localhost:1045/Service.svc/?format=json",
     data: { Value: "testvalue" }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T07:53:47.167

并非在所有服务器上都启用 PUT 和 DELETE 动词。您需要将这些动词放在 X-HTTP-Method-Override 标头中。valeu 取自标头，并在处理请求之前替换为正常的 POST jsut。

jQuery jREST 插件可以帮助您解决这个问题。如果您使用 WCF，您还需要实现 RequestInterceptor（搜索 XHttpMethodOverrideInterceptor 以获取 mroe 详细信息）。

# php - PHP / Apache 中的进程分叉是个好主意吗？

> ID：317392
> 
> 赞同：7
> 
> 时间：2008-11-25T13:51:45.100
> 
> 标签：php, process, fork

我正在用 PHP 编写一个简单的应用程序，它偶尔需要执行一组相当密集的 MySQL 更新。我不特别希望这给用户造成延迟，所以我想知道使用 pcntl_fork()。

我不确定这到底是如何工作的：父进程完成后子进程会继续运行吗？父进程会结束，用户的页面加载会在子进程完成之前完全完成吗？

换句话说，这是让 PHP 脚本（在 Apache 下运行）在不延迟用户的情况下进行一些耗时的更新的安全方法，还是我应该让我的用户忍受一些延迟？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T13:55:30.833

父进程将结束，用户页面将完全加载，子进程将继续，使用不会反馈子进程是否成功完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T13:56:57.913

那里的人可能会详细告诉您，当您在 apache 下调用它时会发生什么，但您可能会得到并不总是正确的答案，具体取决于您使用的 apache 和 php 的版本和组合。您应该使用 ajax 并有两个请求。使用说明您正在做什么的页面响应一次，然后使用 ajax 调用轮询第二个状态请求以及您实际执行工作的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T07:31:15.667

我认为这是个坏主意。我做了类似的事情，apache将父级的输出重定向到它的子级。那是您的浏览器显示来自其中一个子进程的信息。
单击[此](https://stackoverflow.com/a/2038628/1114397)获取更多信息
希望对您有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:57:36.773

如果 PHP 在 Apache 下运行，因为 mod_php 模块分叉根本不起作用，您将收到一条警告，指出函数 *pcntl_fork()* 未定义。在这种情况下，一个好的解决方案是使用*exec()*代替使用命令行运行单独的 php 作业。

# .net - 我需要处理这个 Image 实例吗？

> ID：317400
> 
> 赞同：2
> 
> 时间：2008-11-25T13:53:41.633
> 
> 标签：.net, dispose, visualizer

我正在制作一个简单的 Image Debugger Visualizer。代码如下。我不确定是否需要手动处理 Image 实例？因为我正在制作一个 windows 窗体窗口和里面包含我的动态图像的 PictureBox .. 当窗体终止时我需要添加一些特殊代码来处理这个吗？

这是代码..

```
using System.Diagnostics;
using System.Drawing;
using System.Windows.Forms;
using Microsoft.VisualStudio.DebuggerVisualizers;
using DebuggerVisualizers;

[assembly: DebuggerVisualizer(
    typeof (ImageDebuggerVisualizer),
    typeof (VisualizerObjectSource),
    Target = typeof (Image),
    Description = "Image Visualizer")]

namespace DebuggerVisualizers
{
    public class ImageDebuggerVisualizer : DialogDebuggerVisualizer
    {
        protected override void Show(IDialogVisualizerService windowService, IVisualizerObjectProvider objectProvider)
        {
            Image image = (Image) objectProvider.GetObject();
            Form form = new Form
                           {
                               Text = ("Image Visualizer - " + image.HorizontalResolution + " " + image.VerticalResolution),
                               Width = image.Width,
                               Height = image.Height
                           };

            PictureBox pictureBox = new PictureBox {Image = image, SizeMode = PictureBoxSizeMode.AutoSize};
            form.Controls.Add(pictureBox);
            form.ShowDialog();
        }
    }
} 
```

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T15:03:00.853

将您的 Show 方法更改为：

```
protected override void Show(IDialogVisualizerService windowService,
    IVisualizerObjectProvider objectProvider)        
{            
    Image image = (Image) objectProvider.GetObject();
    using (Form form = new Form())
    {            
        PictureBox pictureBox = new PictureBox();    
        pictureBox.Image = image;        
        form.Controls.Add(pictureBox); 
        form.ShowDialog();
    } 
} 
```

using(){} 块将在关闭后调用表单上的 Dispose，这也将处理表单上的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T13:55:59.147

图片框控件不会处理图像，所以这取决于您，是的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T14:35:34.577

嗯，我要在这里站出来，说你不应该处理它。

我从未创建过可视化工具，我也不完全知道 Visual Studio 会这样做，但在我看来，如果您在可视化工具中处理对象，您可能会破坏正在调试的代码。

这一切都归结为这一行：

```
Image image = (Image) objectProvider.GetObject(); 
```

如果该对象不是克隆，那么您将处置由正在调试的代码创建的对象。代码不会期望该对象会突然被释放，并且 S 会撞到风扇，导致您至少必须重新开始调试。

我会安全地玩它，而不是丢弃它。想想看——你在调试。这不是一个长期存在的过程。如果您确实泄漏了位图句柄，那并不是世界末日...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:45:41.280

我认为你应该处理它。这应该很简单，只需在方法的第一行（围绕 Image image = ... 行）添加 using() 并在 form.ShowDialog() 之后结束它。

我认为处置图像是安全的，因为如果您想更改可视化对象，您必须调用 TransferData/TranferObject/ReplaceDat/ReplaceObject 方法之一将其发回。

# python - 使用 Python 以 minidom 获取元素值

> ID：317413
> 
> 赞同：120
> 
> 时间：2008-11-25T13:57:02.827
> 
> 标签：python, dom, minidom

我正在用 Python 为 Eve Online API 创建一个 GUI 前端。

我已经成功地从他们的服务器中提取了 XML 数据。

我正在尝试从名为“name”的节点中获取值：

```
from xml.dom.minidom import parse
dom = parse("C:\\eve.xml")
name = dom.getElementsByTagName('name')
print name 
```

这似乎找到了节点，但输出如下：

```
[<DOM Element: name at 0x11e6d28>] 
```

我怎样才能让它打印节点的值？

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2008-11-25T13:59:13.823

它应该只是

```
name[0].firstChild.nodeValue 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-11-25T14:21:08.693

如果它是你想要的文本部分，可能是这样的......

```
from xml.dom.minidom import parse
dom = parse("C:\\eve.xml")
name = dom.getElementsByTagName('name')

print " ".join(t.nodeValue for t in name[0].childNodes if t.nodeType == t.TEXT_NODE) 
```

节点的文本部分被认为是一个节点，它本身被放置为您要求的节点的子节点。因此，您将需要遍历其所有子节点并找到所有作为文本节点的子节点。一个节点可以有多个文本节点；例如。

```
<name>
  blabla
  <somestuff>asdf</somestuff>
  znylpx
</name> 
```

你想要'blabla'和'znylpx'；因此“”.join()。您可能想用换行符左右替换空格，或者什么也不替换。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-01-29T07:28:23.907

you can use something like this.It worked out for me

```
doc = parse('C:\\eve.xml')
my_node_list = doc.getElementsByTagName("name")
my_n_node = my_node_list[0]
my_child = my_n_node.firstChild
my_text = my_child.data 
print my_text 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-04-13T00:18:27.940

I know this question is pretty old now, but I thought you might have an easier time with [ElementTree](http://docs.python.org/2/library/xml.etree.elementtree.html)

```
from xml.etree import ElementTree as ET
import datetime

f = ET.XML(data)

for element in f:
    if element.tag == "currentTime":
        # Handle time data was pulled
        currentTime = datetime.datetime.strptime(element.text, "%Y-%m-%d %H:%M:%S")
    if element.tag == "cachedUntil":
        # Handle time until next allowed update
        cachedUntil = datetime.datetime.strptime(element.text, "%Y-%m-%d %H:%M:%S")
    if element.tag == "result":
        # Process list of skills
        pass 
```

I know that's not super specific, but I just discovered it, and so far it's a lot easier to get my head around than the minidom (since so many nodes are essentially white space).

For instance, you have the tag name and the actual text together, just as you'd probably expect:

```
>>> element[0]
<Element currentTime at 40984d0>
>>> element[0].tag
'currentTime'
>>> element[0].text
'2010-04-12 02:45:45'e 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-07-20T12:15:18.943

The above answer is correct, namely:

```
name[0].firstChild.nodeValue 
```

However for me, like others, my value was further down the tree:

```
name[0].firstChild.firstChild.nodeValue 
```

To find this I used the following:

```
def scandown( elements, indent ):
    for el in elements:
        print("   " * indent + "nodeName: " + str(el.nodeName) )
        print("   " * indent + "nodeValue: " + str(el.nodeValue) )
        print("   " * indent + "childNodes: " + str(el.childNodes) )
        scandown(el.childNodes, indent + 1)

scandown( doc.getElementsByTagName('text'), 0 ) 
```

Running this for my simple SVG file created with Inkscape this gave me:

```
nodeName: text
nodeValue: None
childNodes: [<DOM Element: tspan at 0x10392c6d0>]
   nodeName: tspan
   nodeValue: None
   childNodes: [<DOM Text node "'MY STRING'">]
      nodeName: #text
      nodeValue: MY STRING
      childNodes: ()
nodeName: text
nodeValue: None
childNodes: [<DOM Element: tspan at 0x10392c800>]
   nodeName: tspan
   nodeValue: None
   childNodes: [<DOM Text node "'MY WORDS'">]
      nodeName: #text
      nodeValue: MY WORDS
      childNodes: () 
```

I used xml.dom.minidom, the various fields are [explained on this page, MiniDom Python.](https://wiki.python.org/moin/MiniDom)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-10-24T18:51:35.223

Here is a slightly modified answer of Henrik's for multiple nodes (ie. when getElementsByTagName returns more than one instance)

```
images = xml.getElementsByTagName("imageUrl")
for i in images:
    print " ".join(t.nodeValue for t in i.childNodes if t.nodeType == t.TEXT_NODE) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-10-06T03:10:30.693

I had a similar case, what worked for me was:

name.firstChild.childNodes[0].data

XML is supposed to be simple and it really is and I don't know why python's minidom did it so complicated... but it's how it's made

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-04-18T08:52:08.877

The question has been answered, my contribution consists in clarifying one thing that may confuse beginners:

Some of the suggested and correct answers used `firstChild.data` and others used `firstChild.nodeValue` instead. In case you are wondering what is the different between them, you should remember they do the same thing because `nodeValue` is just an alias for `data`.

The reference to my statement can be found as a comment on the [source code of minidom](https://github.com/python/cpython/blob/3.4/Lib/xml/dom/minidom.py):

> #`nodeValue` is an alias for `data`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-04-03T22:37:54.927

It's a tree, and there may be nested elements. Try:

```
def innerText(self, sep=''):
    t = ""
    for curNode in self.childNodes:
        if (curNode.nodeType == Node.TEXT_NODE):
            t += sep + curNode.nodeValue
        elif (curNode.nodeType == Node.ELEMENT_NODE):
            t += sep + curNode.innerText(sep=sep)
    return t 
```

# c++ - 如何调试 .pc 文件？

> ID：317417
> 
> 赞同：3
> 
> 时间：2008-11-25T13:57:17.337
> 
> 标签：c++, debugging, gdb, oracle-pro-c

我正在使用 emacs + gdb 在 unix 中调试一堆 .c 文件——而且它总是运行良好。但我从事的一些项目也有一堆 .pc (Pro*C/C++) 文件。这些文件在编译后会生成 .c 和 .i 相关文件。但是在运行时，我只能看到 gdb 中的 .i 文件——这些文件对调试没有用，而且总是不同步。换句话说，gdb 不会加载我需要的 .c 文件。

与我一起工作的一个人建议在另一个编辑器中打开 .c 文件，并尝试找到 gdb 显示的与 .i 文件一样的行的来源。

还有其他方法吗？如何在 gdb 中加载 .c 文件？如何调试这个 .pc 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T14:23:37.610

首先通过完整调试编译并与调试链接。

对于 ProC 选项，请使用 LINES=YES，因此 ProC 预处理器插入的代码是隐藏的，因此您不必单步执行。

这些是我们在环境中使用的三个重要步骤。

这是 Pro*C[用户指南](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14407/toc.htm)的链接，您可以在其中找到其他有用的信息。

# asp.net - ASP.NET 链接按钮两次引发 onBeforeUnload 事件

> ID：317423
> 
> 赞同：7
> 
> 时间：2008-11-25T13:59:34.837
> 
> 标签：asp.net, javascript

我已经在[这里](https://stackoverflow.com/questions/155739/detecting-unsaved-changes-using-javascript#317246)发布了这个，但认为它本身可能值得一个问题。

我想要做的是显示一个对话框，询问用户如果有未保存的更改，他/她是否想离开页面。这一切都很好。但问题描述如下：

有没有人遇到过 Internet Explorer 两次触发 onbeforeunload 事件的问题？在谷歌搜索时，我发现这与（除其他外）一个 ASP.NET 链接按钮的 HTML 代码是`<a href="javascript: __doPostBack...`.

显然，当 IE 遇到一个没有 的链接时`href="#"`，它会触发 onbeforeunload 事件。然后，当您确认我们正在显示的 javascript 对话框时，该页面将执行“真正的”卸载以导航到另一个页面，并再次引发 onbeforeunload 事件。

Internet 上提供的一种解决方案是设置一个布尔变量并在显示对话框之前对其进行检查。所以第二次，它不会显示。这一切都很好，但是当用户取消时，变量仍然会被设置。所以下次用户想要离开页面时，对话框将不再显示。

希望这有点清楚，我希望有人找到解决方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T14:40:37.903

对 anakata 的反应：是的，但是您希望浏览器使用对话框的结果。所以你可能会认为使用'return bFlag' 可以解决问题（或 event.returnValue = bFlag），但这会给你第二个对话框。[感谢这个页面](http://www.codeproject.com/KB/aspnet/EWSWebPt2.aspx)，我找到了解决方法。其实很简单：

```
var onBeforeUnloadFired = false; 
```

在此处使用此全局变量：

```
if (!onBeforeUnloadFired) {
    onBeforeUnloadFired = true;
    event.returnValue = "You'll lose changes!";
}
window.setTimeout("ResetOnBeforeUnloadFired()", 1000); 
```

然后实现该功能：

```
function ResetOnBeforeUnloadFired() {
    onBeforeUnloadFired = false;
} 
```

因此，实际上，使用该标志，但如果用户单击取消，则将其重置。不完全是我想要的，但还没有找到更好的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T14:21:54.930

我没有遇到过这种情况，但是您肯定可以将标志变量设置为等于对话框的结果吗？如果用户取消该标志，则该标志将因此保持为假。

```
var bFlag = window.confirm('Do you want to leave this page?'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T18:54:21.647

IE supports an event on the document object called onstop. This event fires after the onbeforeunload event, but before the onunload event. This isn't exactly pertinent to your two dialogs question, but its still relevant to other people that might stumble on this thread ( as I did ).

The problem I was having, was that I needed to display a loading message upon the onbeforeunload event firing. This is all fine until the page has some sort of confirm dialog on it. The onbeforeunload event fires even if the user cancel's and remains on the page. The easiest thing for me to do was to move my "loading" display logic into a handler for document.onstop. On top of this, you have to check the readyState property of the document object, which is another IE-only field. If its "loading", it means the user is actually leaving the page. If its "complete", it means the user is staying.

If you are fine with just using IE, then you might be interested in the following.

```
document.onstop = function() 
{
    try
    {
        if( document.readyState != "complete" )
        {
            showLoadingDiv();
        }
    }
    catch( error )
    {
        handleError( error );
    }
} 
```

# mysql - 如何在 ASP 中测试空 SQL 结果

> ID：317424
> 
> 赞同：2
> 
> 时间：2008-11-25T13:59:41.997
> 
> 标签：mysql, asp-classic, ado

我正在使用 MySQL 数据库从 ASP 运行查询，我想根据带有人名（全名）的结果创建一个变量（ssResult），如果记录不存在我想分配文本“N/A”对于变量，下面的代码，我目前为我的数据库连接使用了一个函数 getOther，它传递了列名“fullname”：

```
ssResult = getOtherElse("SELECT fullname FROM table WHERE id=" & inArr(j), "fullname") 
```

下面是函数 getOtherElse 的代码，它仅在返回结果时有效，但在结果为空时无效：

```
Function getOtherElse(inSQL, getColumn)
    Dim conn, rstemp
    Set conn = Server.CreateObject("ADODB.Connection")
    conn.open myDSN
    Set Session("lp_conn") = conn
    Set rstemp = Server.CreateObject("ADODB.Recordset")
    rstemp.Open inSQL, conn 
    if not rstemp.eof then
        rstemp.movefirst
        getOtherElse=rstemp.fields(getColumn)
    else
        getOtherElse="N/A"
    end if
    rstemp.close
    set rstemp=nothing
    conn.close
    set conn=nothing
End Function 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T16:42:08.050

你可以试试换行

```
if not rstemp.eof then 
```

和

```
if rstemp.RecordCount > 0 then 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:11:51.957

为什么不将 SQL 更改为仅提取带有名字的结果，这样“N/A”将适用：

```
sResult = getOtherElse("SELECT fullname FROM table WHERE id=" & inArr(j), "fullname AND fullname<>''")
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:18:54.453

替换此代码块：

```
if not rstemp.eof then
    rstemp.movefirst
    getOtherElse=rstemp.fields(getColumn)
else
    getOtherElse="N/A"
end if 
```

使用这段代码：

```
Dim output
output = "N/A"

If Not rstemp.eof Then
    rstemp.movefirst
    value = rstemp.fields(getColumn)

    If trim(value) = "" Then
        value = "N/A"
    End If
End If

getOtherElse = value 
```

上面的代码始终假定没有返回任何内容，直到连接实际将其设置为返回。然后检查该值是否为空字符串并将该值也设置为“N/A”

# javascript - ASP.NET 2.0 母版页中的 javascript

> ID：317431
> 
> 赞同：0
> 
> 时间：2008-11-25T14:02:27.530
> 
> 标签：javascript, asp.net-2.0

我正在尝试设置一个母版页，其中包含一个可在多个网页中使用的 javascript 弹出子例程。弹出窗口已经在单页环境中工作。我现在想将它迁移到母版页。任何想法将不胜感激。我已经搜索了这个网站并尝试了一些建议，但无济于事。W 小型工作示例会有所帮助。谢谢比尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T14:08:53.757

只需将您在单个页面中的内容放在母版页中即可。真的就是这么简单。:) 然后只需将母版页中的 HTML 主体替换为内容部分，您就可以开始使用了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-28T05:11:27.887

> 我确实发现的一件事是，由于某种原因，派生页面必须与母版页位于同一文件夹中。

很可能是由于母版页引用了适用于母版页的子目录，而不是内部页本身。一种解决方法是使用

```
ScriptManager.RegisterClientScriptInclude(string Key, string URL)
like so:
ScriptManager.RegisterClientScriptInclude("uniqueIdentifier", "~/javascript/myjs.js"); 
```

或者，您可以将文件作为资源嵌入并使用

```
ScriptManager.RegisterClientScriptResource(Page, Type, Key);
like so:
ScriptManager.RegisterClientScriptResource(this.Page, typeOf(Page), "resourceKey"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:07:58.283

[这](http://dev.iceburg.net/jquery/jqModal/)是我目前最喜欢的，似乎是最健壮和灵活的。只需将 js 文件包含在您的主文件中，然后在您的页面上创建一个实例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:10:00.133

一定要使用 scriptmanager 类来添加 javascript

# sql-server-2005 - Sql Server 2005 中的镜像与日志传送

> ID：317438
> 
> 赞同：5
> 
> 时间：2008-11-25T14:04:47.600
> 
> 标签：sql-server-2005, failover, mirroring, log-shipping

我很想听听人们对这种情况下数据库镜像与日志传送的优缺点的看法：我们需要设置一个数据库备份情况，其中只有一个辅助服务器不需要在主服务器出现故障时自动恢复。不过，恢复并从二级开始应该不会花费太长时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T22:47:58.950

**镜像**

*   数据库镜像仅限于两台服务器。
*   使用见证服务器进行镜像可实现高可用性和自动故障转移。
*   您可以将 DSN 字符串配置为在其中包含两个镜像服务器，以便在它们切换时您什么都不会注意到。
*   镜像时，您的镜像数据库无法访问。它处于同步/恢复模式。
*   用 SQL Server 2005 标准版镜像不利于负载均衡（见上句）

**日志运输**

*   您可以将日志发送到多个服务器。
*   日志传送仅与作业运行的频率一样最新。如果您每 15 分钟发送一次日志，辅助服务器可能长达 15 分钟。使它更像是一个温暖的待机。
*   您可以在更新数据库时将其保留为只读模式。适合报告服务器。
*   有利于灾难恢复

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-28T11:03:18.183

出于备份目的，我建议使用镜像：它可以毫不费力地保持数据库的最新副本。如果您不需要自动故障转移，您只需要两台服务器/实例。请注意，高性能模式仅在 Enterprice (sp) 版本中可用！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-26T16:43:29.170

通过日志传送切换到辅助数据库确实需要更长的时间，但这还不错。您必须手动复制所有未复制的备份文件，将事务日志备份应用到辅助数据库，恢复辅助数据库，并将其角色更改为主数据库。如果旧的主数据库可访问，则应在开始之前备份其事务日志。使用镜像进行故障转移稍微简单一些，如果您使用的是高可用性模式，则可以自动完成。即使使用高性能模式，它仍然是单语句操作。

# vba - 如何使用宏根据另一列中的同一月份对一列中的数据求和

> ID：317447
> 
> 赞同：3
> 
> 时间：2008-11-25T14:06:52.310
> 
> 标签：vba, excel

我在 excel 2007 中使用宏来完成我的工作。我正在处理许多数据，我需要根据同一月份对同一列中 2 行或更多行的数据求和。但是，月份列表示为日期。

例如，我有一系列数据

```
A            B
2/10/2008    2
2/10/2008    3
4/10/2008    3
5/11/2008    4
5/11/2008    5 
```

我希望结果显示在 C 和 D 列中，如下所示

```
C            D
Oct/08       8
Nov/08       9 
```

如果有人可以帮助我，我将非常感谢。

问候，

蒂芙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-26T00:59:50.523

```
 A           B       C   D       E       F
1   10/ 1/2008  24106   1   Oct-08  24106   8
2   10/31/2008  24106   7   Nov-08  24107   11
3   11/ 1/2008  24107   8   Dec-08  24108   6
4   11/30/2008  24107   3               
5   12/ 1/2008  24108   2               
6   12/ 2/2008  24108   4               

B1 =MONTH(A1)+YEAR(A1)*12
E1 =MONTH(D1)+YEAR(D1)*12
F1 =SUMIF(B$1:B$6,CONCATENATE("=",E1),C$1:C$6) 
```

我必须克服两个问题来解决这个问题。首先，SUMIF 只能做直接比较，它不能在源位置上运行函数（范围函数除外，日期和时间函数不是），所以我不得不添加 B 列。E 列是可选的，它可以作为 F 中公式的一部分来实现，但为了说明的目的，我将其保留为独立的。其次，SUMIF 采用描述比较的字符串参数，因此我即时构建了必要的字符串（对于 F1，它是“=24106”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-27T00:00:00.893

使用数组函数：C1：

```
=date(2008,small(month($A$1:$A$10),1),1) 
```

C2：

```
=date(2008,small(month($A$1:$A$10),2),1) 
```

右键单击这些单元格并将它们格式化为 mmm/yy

D1：

```
=sum(if(month($C1)=month($A$1:$A$10),($B$1:$B$10),0)) 
```

完成编写此公式后，请确保按 ctrl-shift-enter。然后根据需要复制粘贴下来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T17:22:18.280

This should be possible to do using regular excel formulas:

*   extract the month of the date (some Month-function)
*   then do a conditional sum (function sumwhen (?)) like this:

    = SumWhen(A:B, ReferenceDate, B:B) (with ReferenceDate = C2 C3 etc.)

(All I have is a German excel and the function names got translated as well, so my function names may be off. Maybe someone can check against an English excel and update if necessary.)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:10:35.467

如果您不熟悉 VBA，我会先录制一个宏，同时使用“数据”菜单下的“小计”功能（即通过 Excel 的界面）做您想做的事情。

录制宏后，您可以查看生成的 VBA 代码，并根据需要对其进行修改。

# c++ - 为什么要覆盖 operator()？

> ID：317450
> 
> 赞同：70
> 
> 时间：2008-11-25T14:07:37.847
> 
> 标签：c++, boost, operator-overloading, functor, function-call-operator

在[Boost Signals](http://www.boost.org/doc/html/signals.html "升压信号文档")库中，它们重载了 () 运算符。

这是 C++ 中的约定吗？对于回调等？

我在一位同事的代码中看到了这一点（他恰好是 Boost 的忠实粉丝）。在所有 Boost 的优点中，这只会让我感到困惑。

关于这种超载的原因有什么见解吗？

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2008-11-25T14:29:56.567

重载 operator() 时的主要目标之一是创建一个仿函数。仿函数的行为就像一个函数，但它的优点是它是有状态的，这意味着它可以在调用之间保持数据反映其状态。

这是一个简单的仿函数示例：

```
struct Accumulator
{
    int counter = 0;
    int operator()(int i) { return counter += i; }
}
...
Accumulator acc;
cout << acc(10) << endl; //prints "10"
cout << acc(20) << endl; //prints "30" 
```

函子在泛型编程中大量使用。许多 STL 算法都以非常通用的方式编写，因此您可以将自己的函数/函子插入到算法中。例如，算法 std::for_each 允许您对范围的每个元素应用操作。它可以像这样实现：

```
template <typename InputIterator, typename Functor>
void for_each(InputIterator first, InputIterator last, Functor f)
{
    while (first != last) f(*first++);
} 
```

您会看到该算法非常通用，因为它是由函数参数化的。通过使用 operator()，此函数允许您使用仿函数或函数指针。这是一个显示两种可能性的示例：

```
void print(int i) { std::cout << i << std::endl; }
...    
std::vector<int> vec;
// Fill vec

// Using a functor
Accumulator acc;
std::for_each(vec.begin(), vec.end(), acc);
// acc.counter contains the sum of all elements of the vector

// Using a function pointer
std::for_each(vec.begin(), vec.end(), print); // prints all elements 
```

* * *

关于您关于 operator() 重载的问题，是的，这是可能的。只要您遵守方法重载的基本规则（例如，仅在返回类型上重载是不可能的），您就可以完美地编写一个具有多个括号运算符的仿函数。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-25T14:15:25.270

它允许一个类像一个函数一样工作。我在一个日志类中使用了它，调用应该是一个函数，但我想要这个类的额外好处。

所以是这样的：

```
logger.log("Log this message"); 
```

变成这样：

```
logger("Log this message"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T14:27:06.853

许多人回答说它是一个函子，但没有说明函子比普通旧函数更好的一个重要原因。

答案是函子可以有状态。考虑一个求和函数——它需要保持一个运行总计。

```
class Sum
{
public:
    Sum() : m_total(0)
    {
    }
    void operator()(int value)
    {
        m_total += value;
    }
    int m_total;
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-25T14:14:52.840

您还可以查看[C++ 常见问题解答的矩阵示例](http://www.parashift.com/c++-faq-lite/operator-overloading.html#faq-13.10)。这样做有很好的用途，但这当然取决于您要完成的工作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-25T14:15:20.827

仿函数不是函数，因此不能重载它。
您的同事是正确的，尽管 operator() 的重载用于创建“函子”——可以像函数一样调用的对象。结合期望“类函数”参数的模板，这可能非常强大，因为对象和函数之间的区别变得模糊。

正如其他发帖者所说：函子比普通函数有一个优势，因为它们可以有状态。此状态可用于单次迭代（例如计算容器中所有元素的总和）或多次迭代（例如查找多个容器中满足特定条件的所有元素）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-25T14:16:18.687

开始在你的代码中更频繁地使用`std::for_each`,`std::find_if`等，你就会明白为什么拥有重载 () 运算符的能力很方便。它还允许函子和任务有一个明确的调用方法，不会与派生类中其他方法的名称冲突。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-25T14:34:00.023

在 C++ 中使用 operator() 形成[函子](http://en.wikipedia.org/wiki/Function_object)与[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)范式有关，这些范式通常使用类似的概念：[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-25T14:18:32.287

函子基本上就像函数指针。它们通常旨在可复制（如函数指针）并以与函数指针相同的方式调用。主要的好处是，当您有一个使用模板仿函数的算法时，可以内联对 operator() 的函数调用。但是，函数指针仍然是有效的函子。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-25T14:37:48.020

我可以看到的一个优势，但可以讨论，是 operator() 的签名在不同类型中看起来和行为相同。如果我们有一个类 Reporter，它有一个成员方法 report(..)，然后是另一个类 Writer，它有一个成员方法 write(..)，如果我们想同时使用这两个类，我们将不得不编写适配器某个其他系统的模板组件。它所关心的只是传递字符串或你有什么。如果不使用 operator() 重载或编写特殊类型的适配器，您将无法执行类似的操作

```
T t;
t.write("Hello world"); 
```

因为 T 要求有一个名为 write 的成员函数，它接受任何可隐式转换为 const char*（或者更确切地说是 const char[]）的内容。此示例中的 Reporter 类没有，因此将 T（模板参数）作为 Reporter 将无法编译。

但是，据我所知，这适用于不同的类型

```
T t;
t("Hello world"); 
```

但是，它仍然明确要求类型 T 定义了这样的运算符，因此我们仍然对 T 有要求。就我个人而言，我认为函子并不太奇怪，因为它们很常用，但我宁愿看到其他机制这种行为。在像 C# 这样的语言中，您可以只传递一个委托。我对 C++ 中的成员函数指针不太熟悉，但我可以想象你也可以在那里实现相同的行为。

除了语法糖行为之外，我并没有真正看到运算符重载来执行此类任务的优势。

我敢肯定，有更多明知故犯的人比我有更好的理由，但我想我会提出我的意见，供大家分享。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-25T14:10:59.697

另一位同事指出，这可能是一种将函子对象伪装成函数的方法。例如，这个：

```
my_functor(); 
```

是真的：

```
my_functor.operator()(); 
```

这是否意味着：

```
my_functor(int n, float f){ ... }; 
```

也可以用来重载它吗？

```
my_functor.operator()(int n, float f){ ... }; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-25T15:13:16.997

其他帖子很好地描述了 operator() 的工作原理以及它为什么有用。

我最近一直在使用一些非常广泛地使用 operator() 的代码。重载此运算符的一个缺点是某些 IDE 会因此成为不太有效的工具。在 Visual Studio 中，您通常可以右键单击方法调用以转到方法定义和/或声明。不幸的是，VS 不够聪明，无法索引 operator() 调用。尤其是在复杂的代码中，到处都被覆盖了 operator() 定义，很难弄清楚哪段代码在哪里执行。在某些情况下，我发现我必须运行代码并跟踪它才能找到实际运行的内容。

# c# - Linux 是否有 C# 外观相似？

> ID：317456
> 
> 赞同：6
> 
> 时间：2008-11-25T14:10:43.410
> 
> 标签：c#, linux, compiler-construction

Linux 是否有 C# 外观相似？编译器呢？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-25T14:11:50.177

您实际上可以将 C# 与[Mono](http://www.mono-project.com/)一起使用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-02T23:09:39.733

还有另一种语言叫做[Vala](http://live.gnome.org/Vala)。它并不为人所知，但正如您从页面中看到的那样，已经产生了大量有趣的项目。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T14:12:56.290

如果您不想使用 Mono，我认为 Java 可能是您最接近的选择。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-25T14:13:14.167

看起来像？我假设您的意思是类似的语言？您总是可以将 C# 与[Mono](http://www.mono-project.com/Main_Page)一起使用，Mono是 .Net 框架的多平台端口

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-25T14:40:47.357

在这种情况下，单声道是要走的路。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T15:35:16.373

我发现从 Java 转到 C# 非常容易。也许您可以尝试使用Java？当然，你必须学习一套全新的库，所以有一个学习曲线，但我记得这些语言非常相似（已经有一段时间了）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T14:16:28.420

您总是可以在 Mono 上使用[Boo DSL](http://boo.codehaus.org/)来构建 C# 克隆。但是话又说回来，我想直接在 Mono 本身上使用 C# 可能会更容易；）

# database - 我需要基于 IP 的高性能数据冗余

> ID：317457
> 
> 赞同：0
> 
> 时间：2008-11-25T14:10:56.670
> 
> 标签：database, networking, backup, redundancy

我有一个需要为其提供冗余的数据库。

它是 Codebase，但是使用典型的 SQL 数据库会占用过多的 CPU，并且将数据库放在异地会导致我的流程延迟过多。

我需要一个可行的解决方案来为我的时间批评流程提供异地位置的数据冗余。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T14:49:50.037

如果您有一个主要阅读的场景，您应该查看 memcached，它可能会解决您的部分问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T14:18:51.380

也许一个愚蠢的答案，但你有没有想过一面镜子？

# c# - 一些有助于理解“产量”

> ID：317462
> 
> 赞同：35
> 
> 时间：2008-11-25T14:12:52.907
> 
> 标签：c#, iterator, yield

在我不断追求减少吸吮的过程中，我试图理解“屈服”声明，但我一直遇到同样的错误。

> [someMethod] 的主体不能是迭代器块，因为 'System.Collections.Generic.List<AClass>' 不是迭代器接口类型。

这是我卡住的代码：

```
foreach (XElement header in headersXml.Root.Elements()){
    yield return (ParseHeader(header));                
} 
```

我究竟做错了什么？我不能在迭代器中使用 yield 吗？那有什么意义呢？在此示例中，它表示`List<ProductMixHeader>`不是迭代器接口类型。 `ProductMixHeader`是一个自定义类，但我想`List`是一个迭代器接口类型，不是吗？

**--编辑--**
感谢所有快速回答。
我知道这个问题并不是那么新鲜，而且同样的资源不断涌现。
原来我在想我可以`List<AClass>`作为返回类型返回，但由于`List<T>`不是懒惰，它不能。更改我的返回类型以`IEnumerable<T>`解决问题：D

`IEnumerable<T>`一个有点相关的问题（不值得打开一个新线程）：如果我确定 99% 的情况我都会去 .ToList() 是否值得作为返回类型？性能影响是什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-25T14:16:41.570

使用*yield return*的方法必须声明为返回以下两个接口之一：

```
IEnumerable<SomethingAppropriate>
IEnumerator<SomethingApropriate> 
```

（感谢[Jon](https://stackoverflow.com/users/22656/jon-skeet)和[Marc](https://stackoverflow.com/users/23354/marc-gravell)指出 IEnumerator）

例子：

```
public IEnumerable<AClass> YourMethod()
{
    foreach (XElement header in headersXml.Root.Elements())
    {
        yield return (ParseHeader(header));                
    }
} 
```

yield 是一个懒惰的数据生产者，只有在第一个被检索到后才产生另一个，而返回一个列表将一次性返回所有内容。

所以有区别，需要正确声明方法。

有关更多信息，请[在此处阅读 Jon 的回答](https://stackoverflow.com/questions/317462/some-help-understanding-yield#317502)，其中包含一些非常有用的链接。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-25T14:23:00.733

这是一个棘手的话题。简而言之，这是实现 IEnumerable 及其朋友的简单方法。编译器为您构建一个状态机，将参数和局部变量转换为新类中的实例变量。复杂的东西。

我有这方面的一些资源：

*   [第 6 章深入了解 C#](https://www.manning.com/books/c-sharp-in-depth)（从该页面免费下载）
*   [迭代器、迭代器块和数据管道](http://csharpindepth.com/Articles/Chapter11/StreamingAndIterators.aspx)（文章）
*   [迭代器块实现细节](http://csharpindepth.com/Articles/Chapter6/IteratorBlockImplementation.aspx)（文章）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-25T14:21:10.597

“yield”创建一个迭代器块 - 一个编译器生成的类，可以实现`IEnumerable[<T>]`或`IEnumerator[<T>]`。[Jon Skeet 在C# in Depth](http://manning.com/skeet/)的第 6 章中对此进行了很好的（而且免费的）讨论。

但基本上 - 要使用“yield”，您的方法必须返回一个`IEnumerable[<T>]`or `IEnumerator[<T>]`。在这种情况下：

```
public IEnumerable<AClass> SomeMethod() {
    // ...
    foreach (XElement header in headersXml.Root.Elements()){
        yield return (ParseHeader(header));                
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T14:21:03.857

List 实现了 Ienumerable。

这是一个示例，可能会阐明您正在尝试学习的内容。我写了大约 6 个月

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace YieldReturnTest
{
    public class PrimeFinder
    {
        private Boolean isPrime(int integer)
        {
            if (0 == integer)
                return false;

            if (3 > integer)
                return true;

            for (int i = 2; i < integer; i++)
            {
                if (0 == integer % i)
                    return false;
            }
            return true;
        }

        public IEnumerable<int> FindPrimes()
        {
            int i;

            for (i = 1; i < 2147483647; i++)
            {
                if (isPrime(i))
                {
                    yield return i;
                }
            }
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            PrimeFinder primes = new PrimeFinder();

            foreach (int i in primes.FindPrimes())
            {
                Console.WriteLine(i);
                Console.ReadLine();
            }

            Console.ReadLine();
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T14:27:29.770

我强烈建议使用[Reflector](http://www.red-gate.com/products/reflector/)来看看`yield`实际对你有什么作用。使用 yield 时，您将能够看到编译器为您生成的类的完整代码，而且我发现人们在看到低级结果时会更快地理解这个概念（嗯，中 -我猜的水平）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-17T09:13:20.297

要理解`yield`，您需要了解何时使用`IEnumerator`and `IEnumerable`（因为您必须使用其中任何一个）。以下示例可帮助您了解差异。

首先，看看下面的类，它实现了两个方法——一个返回`IEnumerator<int>`，一个返回`IEnumerable<int>`。我会告诉你在用法上有很大的不同，虽然这两种方法的代码看起来很相似：

```
// 2 iterators, one as IEnumerator, one as IEnumerable
public class Iterator
{
    public static IEnumerator<int> IterateOne(Func<int, bool> condition)
    {
        for(var i=1; condition(i); i++) { yield return i; }     
    }
    public static IEnumerable<int> IterateAll(Func<int, bool> condition)
    {
        for(var i=1; condition(i); i++) { yield return i; }     
    }
} 
```

* * *

现在，如果您正在使用`IterateOne`，您可以执行以下操作：

```
 // 1\. Using IEnumerator allows to get item by item
    var i=Iterator.IterateOne(x => true); // iterate endless
    // 1.a) get item by item
    i.MoveNext(); Console.WriteLine(i.Current);
    i.MoveNext(); Console.WriteLine(i.Current);
    // 1.b) loop until 100
    int j; while (i.MoveNext() && (j=i.Current)<=100) { Console.WriteLine(j); } 
```

1.a) 打印：

`1`
`2`

1.b) 打印：

`3`
`4`
...
`100`

因为它在 1.a) 语句执行后继续计数。

您可以看到您可以使用 逐项推进`MoveNext()`。

* * *

相比之下，允许`IterateAll`您使用**LINQ**语句以获得更大的舒适度：`foreach`

 **```
 // 2\. Using IEnumerable makes looping and LINQ easier   
    var k=Iterator.IterateAll(x => x<100); // limit iterator to 100
    // 2.a) Use a foreach loop
    foreach(var x in k){ Console.WriteLine(x); } // loop
    // 2.b) LINQ: take 101..200 of endless iteration
    var lst=Iterator.IterateAll(x=>true).Skip(100).Take(100).ToList(); // LINQ: take items
    foreach(var x in lst){ Console.WriteLine(x); } // output list 
```

2.a) 打印：

`1`
`2`
...
`99`

2.b) 打印：

`101`
`102`
...
`200`

* * *

**注意：**由于`IEnumerator<T>`和`IEnumerable<T>`是泛型，它们可以与任何类型一起使用。但是，为简单起见，我`int`在示例中使用了 type `T`。

这意味着，您可以使用其中一种返回类型`IEnumerator<ProductMixHeader>`或`IEnumerable<ProductMixHeader>`（您在问题中提到的自定义类）。

该类型`List<ProductMixHeader>`没有实现这些接口中的任何一个，这就是您不能以这种方式使用它的原因。但是**示例 2.b)**展示了如何从中创建列表。

如果您通过附加来创建列表，`.ToList()`则意味着它将创建内存中所有元素的列表，而 an`IEnumerable`允许延迟创建其元素 - 就性能而言，这意味着元素被及时枚举 -尽可能晚，但一旦你使用`.ToList()`，那么所有元素都会在内存中创建。LINQ 试图在幕后以这种方式优化性能。

**[所有示例的 DotNetFiddle](https://dotnetfiddle.net/JnF24U)**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-11T07:42:05.147

@Ian P 的回答对我了解产量以及使用它的原因有很大帮助。yield 的一个（主要）用例是在“in”关键字之后的“foreach”循环中不返回完整的列表。不是一次返回一个完整的列表，而是在每个“foreach”循环中只返回一个项目（下一个项目）。因此，在这种情况下，您将通过收益获得性能。为了更好地理解以下内容，我重写了@Ian P 的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace YieldReturnTest
{
    public class PrimeFinder
    {
        private Boolean isPrime(int integer)
        {
            if (0 == integer)
                return false;

            if (3 > integer)
                return true;

            for (int i = 2; i < integer; i++)
            {
                if (0 == integer % i)
                    return false;
            }
            return true;
        }

        public IEnumerable<int> FindPrimesWithYield()
        {
            int i;

            for (i = 1; i < 2147483647; i++)
            {
                if (isPrime(i))
                {
                    yield return i;
                }
            }
        }

        public IEnumerable<int> FindPrimesWithoutYield()
        {
            var primes = new List<int>();
            int i;
            for (i = 1; i < 2147483647; i++)
            {
                if (isPrime(i))
                {
                    primes.Add(i);
                }
            }
            return primes;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            PrimeFinder primes = new PrimeFinder();

            Console.WriteLine("Finding primes until 7 with yield...very fast...");
            foreach (int i in primes.FindPrimesWithYield()) // FindPrimesWithYield DOES NOT iterate over all integers at once, it returns item by item
            {
                if (i > 7)
                {
                    break;
                }
                Console.WriteLine(i);
                //Console.ReadLine();

            }

            Console.WriteLine("Finding primes until 7 without yield...be patient it will take lonkg time...");
            foreach (int i in primes.FindPrimesWithoutYield()) // FindPrimesWithoutYield DOES iterate over all integers at once, it returns the complete list of primes at once
            {
                if (i > 7)
                {
                    break;
                }
                Console.WriteLine(i);
                //Console.ReadLine();
            }

            Console.ReadLine();
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T14:16:48.420

您使用的方法是什么样的？我不认为这可以单独在一个循环中使用。

例如...

```
public IEnumerable<string> GetValues() {
    foreach(string value in someArray) {
        if (value.StartsWith("A")) { yield return value; }
    }
} 
```

# javascript - 如何将容器 div 的大小调整为其子项的总高度？

> ID：317472
> 
> 赞同：18
> 
> 时间：2008-11-25T14:15:34.803
> 
> 标签：javascript, jquery, dom

我有一个容器元素，我需要在其内容更改时调整它的大小。它包含 2 个绝对定位的 div，它们都可以改变高度。如果我没有指定容器的高度，那么容器之后的任何内容都会消失在内容之下。

目前我正在执行以下操作，但我很高兴找到一个不那么费力的替代方案：

（容器有 position:relative，#main 和 #sidebar 是 position:absolute，#sidebar 的内容没有指定定位）

CSS：

```
div#mapcontainer { position:relative; width:100%; height: 600px;  }
div#main { position:absolute; top: 0; left: 10px; width: 500px; height: 400px; }
div#sidebar { position:absolute; top:10px; right:10px; width: 155px; height: 405px;} 
```

html:

```
<div id="container">
    <div id="main">variable height content here</div>
    <div id="sidebar">
       <div id="foo">...</div>
       <div id="bar">....</div>
       ...
    </div>
<div> 
```

js：

```
fixHeights = function() {   
    var children_height = 0;  
    $('#sidebar'). children().each(function(){children_height += $(this).height();});
    $('#container').height(Math.max(children_height, $('#main').height()));
}; 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-25T14:21:08.740

这是一个非常奇怪的问题，因为 div 的高度始终是其子项的高度。

您是否在容器 div 中浮动内容？当您浮动子内容时，包含 div 的行为不再相同。

如果您的浮动内容超出了容器 div 的底部，请将以下 div 添加到容器 div 子项的最底部：

```
<div style="clear:both;"></div> 
```

这将不允许孩子漂浮在它上面，从而迫使包含 div 成为其最高孩子的高度......

```
<div id="container">
  <div id="dynamic" style="float:left;width:100px;">dynamic content goes here</div>
  <div id="static" style="margin-left:104px;">Lots of static stuff here</div>
  <div style="clear:both;"></div>
</div> 
```

* * *

好的，我不确定您为什么要按照自己的方式进行定位，但是对于必须看起来像桌面应用程序的网站，我已经做了类似的事情。我不相信除了使用 javascript 之外还有其他方法可以做到这一点。Html 文档旨在流动，而不是僵化。如果您想放弃 javascript，则必须放弃定位样式并使用浮动和清除 div。它没有*那么*可怕...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-25T14:26:57.527

如果您浮动容器 div “溢出：自动”也可以神奇地工作，尤其是对于整个 IE hasLayout 崩溃

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T14:28:45.540

您没有指定，但我认为您遇到了浮动元素的问题，并且您希望它们所在的容器至少是最大浮动元素的大小。您应该尝试以下 CSS hack，它会强制浏览器将容器元素的大小重新渲染为浮动元素的大小：

```
#wrapper:after {
    clear:both;
    content:".";
    display:block;
    height:0;
    visibility:hidden;
} 
```

让我知道你想出了什么，如果这有效。根据您的浏览器，还有许多其他黑客可以尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-26T03:58:09.213

我会尝试更改 css 以不使用绝对定位。在 Firefox 中，您需要使用评论中提到的包装技巧来使地图容器具有正确的高度。

div#mapcontainer { clear:both; 宽度：100%；最小高度：600px；}

div#main { 浮动：左；左边距：10px；宽度：500px；高度：400px；}

div#sidebar { 浮动：左；边距顶部：10px；边距右：10px；宽度：155px；高度：405 像素；}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-16T23:14:04.103

`Overflow:visible;` 那是票。 `overflow:auto`如果需要，将创建一个滚动条。

# performance - 您的团队如何脱颖而出？

> ID：317493
> 
> 赞同：3
> 
> 时间：2008-11-25T14:21:05.137
> 
> 标签：performance, lead

在我工作的地方，我们有 2 到 5 人的小团队。作为开发主管，您实施了哪些让您的团队脱颖而出的事情？意思是，它让其他团队说，“这很酷”或“我们为什么没有想到这一点”。只是一些开箱即用的想法，使您的团队非常高效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T14:24:28.840

自动化单元测试和自动化构建系统（如 CruiseControl）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T14:28:08.193

夏威夷衬衫日

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T14:35:06.340

为什么要与其他团队竞争，公司目标应该是一个共同的目标。

我们大致有两个团队（一个致力于“现成”产品，一个致力于定制解决方案）。但我们习惯于互相帮助。在我看来，这就是应该的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:26:04.937

首先也是最重要的——我们按时完成符合完成标准的事情。在我看来，这是最好的做法:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T14:26:06.060

我们目前正在使用 CC.NET 进行单元和功能测试自动化。QA 爱我们。但是，我正在寻找诸如此类的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T14:28:55.977

就其他团队可能感兴趣但与他们的工作没有直接关系的一般主题进行公司内部演示（否则他们应该比你更了解这些问题）。

志愿做有益于每个人的内部项目。（例如 Stylecop 对代码库的介绍、每周的极客午餐等）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T14:45:43.917

写好代码？

* * *

**编辑**：当然这是完全错误的，实际答案应该是：

> 编写糟糕的代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T15:10:09.263

我们仅标准化构建过程。我们不会让我们的 SKILLED 开发人员使用指定给他们的技能。我们让他们随心所欲地编写代码，使用编辑器和命令行，使用 IDE，如果他们愿意，可以使用锤子和凿子。它们仅受构建过程的约束。每个人都受制于相同的构建，在我们的例子中是一个 ant 脚本。

由于自由，开发人员喜欢并在我们的团队中执行。其他限制开发人员的团体无法理解我们是如何做到的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-30T15:23:36.633

我不同意这是公司的目标。因为最终每个人都在寻找自己。让一个团队脱颖而出很重要。原因是多方面的。要脱颖而出，团队必须能够展示自己，团队负责人必须承担责任。这些天开发好的代码还不够，而且还能够呈现它

# c# - 为什么在枚举对象上设置属性不起作用？

> ID：317527
> 
> 赞同：3
> 
> 时间：2008-11-25T14:29:50.547
> 
> 标签：c#, ienumerable

我对 C# 了解很多，但这个让我很困惑，而谷歌也没有帮助。

我有一个 IEnumerable 范围的对象。我想在第一个上设置一个属性。我这样做了，但是当我在修改后枚举对象范围时，我看不到我的变化。

这是一个很好的问题示例：

```
 public static void GenericCollectionModifier()
    {
        // 1, 2, 3, 4... 10
        var range = Enumerable.Range(1, 10);

        // Convert range into SubItem classes
        var items = range.Select(i => new SubItem() {Name = "foo", MagicNumber = i});

        Write(items);  // Expect to output 1,2,3,4,5,6,7,8,9,10

        // Make a change
        items.First().MagicNumber = 42;

        Write(items);  // Expect to output 42,2,3,4,5,6,7,8,9,10
        // Actual output: 1,2,3,4,5,6,7,8,9,10
    }

    public static void Write(IEnumerable<SubItem> items)
    {
        Console.WriteLine(string.Join(", ", items.Select(item => item.MagicNumber.ToString()).ToArray()));
    }

    public class SubItem
    {
       public string Name;
       public int MagicNumber;
    } 
```

C# 的哪个方面阻止了我的“MagicNumber = 42”更改输出？有没有一种方法可以让我的更改“坚持”而无需进行一些时髦的转换为 List<> 或数组？

谢谢！-麦克风

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T14:35:44.577

当您调用 First() 时，它会枚举这段代码的结果：

```
Select(i => new SubItem() {Name = "foo", MagicNumber = i}); 
```

请注意， Select 是一个惰性枚举器，这意味着它仅在您向其中请求项目时才进行选择（并且*每次*您询问时都会这样做）。结果不会存储在任何地方，因此当您调用 items.First() 时，您会得到一个新`SubItem`实例。然后，当您将项目传递给 Write 时，它​​会获得一大堆新`SubItem`实例 - 而不是您之前获得的那个。

如果要存储选择的结果并对其进行修改，则需要执行以下操作：

```
var items = range.Select(i => new SubItem() {Name = "foo", MagicNumber = i}).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:34:15.687

我怀疑在后台发生了什么事。很可能是因为 IEnumerables 只能迭代一次。

如果在分配给“项目”时在调用 Select() 之后添加“ToList()”，它是否有效？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:34:36.823

我唯一能想到的是 items.First() 将 SubItem 的副本传递给您而不是引用，因此当您设置它时，不会进行更改。

我不得不假设它与 IQueryable 只能迭代一次有关。您可能想尝试更改此设置：

```
// Convert range into SubItem classes
var items = range.Select(i => new SubItem() {Name = "foo", MagicNumber = i}); 
```

到

```
// Convert range into SubItem classes
var items = range.Select(i => new SubItem() {Name = "foo", MagicNumber = i}).ToList(); 
```

看看有没有不同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T14:39:34.677

您不能/不应该通过枚举器修改集合。我很惊讶这不会引发异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T14:40:48.123

.First() 是一种方法，而不是属性。它在 Enumerable 的第一个位置返回对象的新实例。

# python - Python：将 IP 地址打包为 ctype.c_ulong() 以与 DLL 一起使用

> ID：317531
> 
> 赞同：3
> 
> 时间：2008-11-25T14:30:37.987
> 
> 标签：python, dll, ip-address, ctypes

给出以下代码：

```
import ctypes    
ip="192.168.1.1"
thisdll = ctypes.cdll['aDLL']
thisdll.functionThatExpectsAnIP(ip) 
```

我怎样才能正确地将它打包为一个期望它作为 c_ulong 数据类型的 DLL？

我试过使用：

```
ip_netFrmt = socket.inet_aton(ip)
ip_netFrmt_c = ctypes.c_ulong(ip_netFrmt) 
```

但是，该`c_ulong()`方法返回错误，因为它需要一个整数。

有没有办法用来`struct.pack`完成这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T14:47:23.380

inet_aton 返回一个字节串。这曾经是 C 语言接口的*通用语言*。

以下是如何将这些字节解压缩为更有用的值。

```
>>> import socket
>>> packed_n= socket.inet_aton("128.0.0.1")
>>> import struct
>>> struct.unpack( "!L", packed_n )
(2147483649L,)
>>> hex(_[0])
'0x80000001L' 
```

这个解压后的值可以与 ctypes 一起使用。十六进制只是为了向您展示解压后的值看起来很像 IP 地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:45:24.977

首先是免责声明：这只是一个有根据的猜测。

一个 IP 地址传统上表示为四个字节 - 即 xxx.xxx.xxx.xxx，但实际上是一个无符号长整数。因此，您应该将表示形式 192.168.1.1 转换为无符号整数。你可以像这样转换它。

```
ip="192.168.1.1"
ip_long = reduce(lambda x,y:x*256+int(y), ip.split('.'), 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T14:46:04.663

可能有更好的方法，但这有效：

```
>>> ip = "192.168.1.1"
>>> struct.unpack('>I', struct.pack('BBBB', *map(int, ip.split('.'))))[0]
3232235777L 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T15:07:11.953

要更彻底地处理 IP（v6、CIDR 风格的东西等），请查看它是如何在[py-radix](http://www.mindrot.org/projects/py-radix/)中完成的，尤其是。[prefix_pton](http://anoncvs.mindrot.org/index.cgi/py-radix/radix.c?revision=1.17&view=markup)。

# database - 从数据库模式创建 Web 表单

> ID：317566
> 
> 赞同：4
> 
> 时间：2008-11-25T14:42:37.073
> 
> 标签：database, configuration, webforms

我想知道是否有任何应用程序，最好是免费软件，可以进行数据库配置，并且尽可能少地创建用于轻松插入数据的 Web 表单。

我发现很难准确地表达我所追求的。也许我可以谈谈我需要什么。

我有一个配置数据库，至少通常它包含关于我们系统中服务器的“真相”。它包含多个表中的区域名称、主机名、不同配置项等内容。现在我们在添加新服务器或其他东西时直接使用简单的 INSERT，我们自己处理密钥和 ID。关键是，他们不希望我们开发一个简单的 Web 表单来处理这个问题，而是他们想要一个可以生成 Web 表单的工具。这有意义吗？

我不确定这样的事情是否存在或是否可靠，但是，我想如果有人知道，那就是这个社区。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T15:00:51.280

正如许多人已经说过的，这取决于您使用的技术：

*   .Net 3.5 - 动态数据或 Subsonic 的脚手架控制
*   .Net 2.0 - Subsonic 的脚手架控制
*   PHP - CakePHP
*   Ruby - Rail 的脚手架组件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-20T20:22:56.647

“尽可能少的麻烦”

你检查过[PHP/MySQL Web Database Application Code Generator 10.02 之](http://www.softpedia.com/get/Internet/WEB-Design/Web-Design-related/ASPPHP-Web-Application-Builder.shtml)类的东西吗？或 phpmyedit ？

在我看来，到目前为止其他人提出的建议都需要大量的编码......

另外，看看**phprunner**。它不是免费的，但看截图，它似乎符合您的要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T14:45:48.330

ASP.NET 有[Dynamic Data](http://www.asp.net/dynamicdata/)，我认为符合您的描述。还有[亚音速](http://www.codeplex.com/subsonic)。两者都是免费和开源的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T14:46:16.817

尝试过[动态数据](http://weblogs.asp.net/scottgu/archive/2007/12/14/new-asp-net-dynamic-data-support.aspx)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T14:50:40.957

除了 ASP.NET[动态数据](http://www.asp.net/dynamicdata/)，你也可以看看[SubSonic](http://subsonicproject.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T14:51:01.267

使用 PHP，如果您能够根据需要命名表和列，您可以尝试[CakePHP](http://www.cakephp.org/)框架，特别是[脚手架](http://book.cakephp.org/view/105/Scaffolding)功能。打开脚手架后，代码将为您从架构创建 CRUD 表单。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-27T07:19:36.000

这是了解 SubSonic & Scaffolding 的链接[http://www.subsonicproject.com/web-forms-controls/the-scaffold/](http://www.subsonicproject.com/web-forms-controls/the-scaffold/) ，享受 ;)

SubSonic 论坛的另一个链接[http://monk.thelonio.us/post/Scaffold-Enhancements-in-SubSonic-21.aspx](http://monk.thelonio.us/post/Scaffold-Enhancements-in-SubSonic-21.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-15T17:05:09.433

你可以试试[管理员编辑器](http://www.adminer.org/en/editor/)

> Adminer Editor 是用 PHP 编写的易于使用且用户友好的数据库编辑工具。它适用于普通用户，因为它提供了高级数据操作。

# vb.net - 如何在 VB.Net 中向 DataGridView 添加记录？

> ID：317567
> 
> 赞同：17
> 
> 时间：2008-11-25T14:43:46.713
> 
> 标签：vb.net, datagridview

如何在 VB.Net 中向 DataGridView 控件添加新记录？

我不使用数据集或数据库绑定。我有一个带有 3 个字段的小表单，当用户单击“确定”时，它们应该作为新行添加到 DataGridView 控件中。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-25T22:01:10.247

如果要将行添加到网格的末尾，请使用Rows 集合的**Add()方法...**

```
DataGridView1.Rows.Add(New String(){Value1, Value2, Value3}) 
```

如果要在特定位置插入行，请使用 Rows 集合的**Insert()**方法（正如 GWLlosa 所说）...

```
DataGridView1.Rows.Insert(rowPosition, New String(){value1, value2, value3}) 
```

我知道您提到您没有进行数据绑定，但是如果您在项目中定义了一个带有单个数据表的强类型数据集，您可以使用它并获得一些很好的强类型方法来完成这些工作，而不是依赖网格方法...

```
DataSet1.DataTable.AddRow(1, "John Doe", true) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T14:47:47.327

我认为你应该在代码中构建一个数据集/数据表并将网格绑定到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T15:01:55.037

您正在寻找的功能是“插入”。它将要插入的索引和用于新行值的值数组作为其参数。典型用法可能包括：

```
myDataGridView.Rows.Insert(4,new object[]{value1,value2,value3}); 
```

或类似的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-01T08:45:11.383

当我尝试从使用 bindingsource 的 datagridview 转换数据源时，错误 accor 无法转换：

- - - - - 解决方案 - - - - - -

'我从绑定源更改了与 datagridview 绑定的转换

'这里的代码

```
Dim dtdata As New DataTable()

dtdata = CType(bndsData.DataSource, DataTable) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-03T02:31:39.917

如果您想使用比哑数组更具描述性的东西而不使用 DataSet，那么以下内容可能会很有用。它仍然不是强类型的，但至少它由编译器检查并且可以很好地处理重构。

```
Dim previousAllowUserToAddRows = dgvHistoricalInfo.AllowUserToAddRows
dgvHistoricalInfo.AllowUserToAddRows = True

Dim newTimeRecord As DataGridViewRow = dgvHistoricalInfo.Rows(dgvHistoricalInfo.NewRowIndex).Clone

With record
    newTimeRecord.Cells(dgvcDate.Index).Value = .Date
    newTimeRecord.Cells(dgvcHours.Index).Value = .Hours
    newTimeRecord.Cells(dgvcRemarks.Index).Value = .Remarks
End With

dgvHistoricalInfo.Rows.Add(newTimeRecord)

dgvHistoricalInfo.AllowUserToAddRows = previousAllowUserToAddRows 
```

值得注意的是，用户必须有`AllowUserToAddRows`权限，否则这将不起作用。这就是为什么我存储现有值，将其设置为 true，完成我的工作，然后将其重置为原来的样子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-08T02:05:11.427

如果您`DataGridView`绑定到 a `DataSet`，则不能只在`DataGridView`显示中添加新行。现在它将正常工作。

相反，您应该使用以下代码添加新行`DataSet`：

```
BindingSource[Name].AddNew() 
```

此代码还将自动在您的`DataGridView`显示中添加一个新行。

# .net - 如何观察文件系统的变化

> ID：317571
> 
> 赞同：3
> 
> 时间：2008-11-25T14:44:43.713
> 
> 标签：.net, filesystems, filesystemwatcher, dropbox

我正在我大学的分布式系统课程中做一个项目。我正计划创建类似于 Dropbox ( getdropbox.com ) 的东西，但带有某种非中心化的点对点扭曲。为此，我需要一些检测目录结构变化的方法。您认为 Dropbox 是如何做到这一点的？他们的实施效果非常好。我想知道他们是否在 windows 上使用来自 win32 api 的 FileSystemWatcher，以及依赖于 Linux 和 Mac 的类似平台。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T14:47:10.607

在 Mac OS X Leopard 下有 FSEvents API，它允许您注册文件系统更改的通知：

[http://googlemac.blogspot.com/2008/03/file-system-change-logger-for-leopard.html](http://googlemac.blogspot.com/2008/03/file-system-change-logger-for-leopard.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T14:54:50.370

在 Linux 方面，有可怕的无证 inotify。如果您不介意使用 glib，则可以使用[GFileMonitor](http://library.gnome.org/devel/gio/stable/GFileMonitor.html)类，它非常易于使用。我不认为它是可移植的，所以它只适用于 Linux。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T15:04:05.580

eduffy 提到了 inotify ....

我不久前看到了这个，基于inotify。称为 incron，它为 incron 添加了类似 cron 的功能。

[http://www.linux.com/feature/144666](http://www.linux.com/feature/144666)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T14:49:10.460

据我所知，DropBox（等）使用 Windows 服务（或 Linux/Mac 端的守护程序）来监视文件系统。在 .Net 中创建此类非常容易，并且此场景通常是 Windows 服务的教科书示例。我相信在 C++ 中做类似的事情也会相当简单。

这是 .Net 简单教程的链接，该教程介绍了如何在 Windows 上创建服务。您需要为您的解决方案做的就是在 Timer.Tick() 事件中添加您的监视器逻辑。

[http://www.developer.com/net/csharp/article.php/2173801](http://www.developer.com/net/csharp/article.php/2173801)

# sql - Oracle - 选择字段具有小写字符的位置

> ID：317576
> 
> 赞同：23
> 
> 时间：2008-11-25T14:45:52.777
> 
> 标签：sql, oracle, select, indexing, case-sensitive

我在 Oracle 9.2.0.6 数据库中有一个表 users。其中两个字段是 varchar - last_name 和 first_name。

当向该表中插入行时，名字和姓氏字段应该全部大写，但是不知何故这两个字段中的某些值是混合大小写的。

我想运行一个查询，它将向我显示表中包含名字或姓氏的所有行，其中包含小写字符。

我在网上搜索并找到了 REGEXP_LIKE，但这一定是针对较新版本的 oracle - 它似乎对我不起作用。

我尝试的另一件事是将“abcde...z”翻译为“$$$$$...$”，然后在我的字段中搜索“$”，但必须有更好的方法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-11-25T14:53:00.437

这个怎么样：

```
select id, first, last from mytable
where first != upper(first) or last != upper(last); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T15:12:44.063

我认为 BQ 的 SQL 和 Justin 的第二个 SQL 会起作用，因为在这种情况下：

```
first_name        last_name
----------        ---------
bob               johnson
Bob               Johnson
BOB               JOHNSON 
```

我希望我的查询返回前 2 行。

我只是想确保这将是一个有效的查询——我的表中有 5 亿行。

当您说upper（first_name）！= first_name时，“first_name”是否总是与oracle正在查看的当前行有关？起初我害怕使用这种方法，因为我担心我最终会将这个表加入到自身中，但是你们俩编写 SQL 的方式似乎是相等检查仅在逐行的基础上运行，这会为我工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-28T13:00:17.177

如果您正在寻找 Oracle 10g 或更高版本，您可以使用以下示例。考虑到您需要找出列中任何字母为小写的行。

```
Column1
.......
MISS
miss
MiSS 
```

在上面的示例中，如果您需要查找值`miss`和`MiSS`，那么您可以使用以下查询

```
SELECT * FROM YOU_TABLE WHERE REGEXP_LIKE(COLUMN1,'[a-z]'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T13:29:14.147

```
 SELECT * 
 FROM mytable 
 WHERE FIRST_NAME IN (SELECT FIRST_NAME 
                      FROM MY_TABLE
                      MINUS 
                      SELECT UPPER(FIRST_NAME) 
                      FROM MY_TABLE ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-28T07:39:51.270

试试这个：

```
SELECT * FROM YOU_TABLE WHERE REGEXP_LIKE(COLUMN1,'[a-z]','c'); => Miss, miss lower text
SELECT * FROM YOU_TABLE WHERE REGEXP_LIKE(COLUMN1,'[A-Z]','c'); => Miss, MISS upper text 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-12-01T11:02:38.267

对于数据库排序规则设置不区分大小写的 SQL 服务器，请使用以下命令：

```
SELECT * FROM tbl_user WHERE LEFT(username,1) COLLATE Latin1_General_CS_AI <> UPPER(LEFT(username,1)) 
```

# networking - 寻找网络链接速度确定算法

> ID：317580
> 
> 赞同：0
> 
> 时间：2008-11-25T14:47:07.983
> 
> 标签：networking, ethernet

我正在寻找解释标准（嗯，标准的）以太网 PHY 寄存器的最佳方法，以确定以太网链路实际运行的速度。（例如 10/100/1000 和全/半双工）

我敢说这可以在 Linux 之类的东西的源代码中找到，我现在就去看看那里，但如果有人有好的参考资料，我会很感兴趣。

我感兴趣的是它是否真的链接以及它链接的内容，而不是每一端一开始就宣传的巨大可能性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T19:55:27.503

感谢你的回答。这是一个与语言和平台无关的问题，因为几乎所有 MII/GMII 以太网 PHY 都具有相同的基本寄存器。我碰巧在一个嵌入式平台上。

但是通过查看 Linux 驱动程序源的各个位，我发现了一个合理的序列，对于我的受限应用程序来说已经足够了 - 它基本上是：

检查基本状态 (0x1) 中的链接 如果链接已启动，则检查基本状态中的协商完成 (0x1) 如果协商完成，则检查 1000M 状态寄存器 (0xa) 中的 1G 如果您还没有有1G，那么你就有100M。（这不是一般规则，但它适用于本应用程序）

也许这真的是一个硬件问题而不是软件问题......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T01:39:07.527

为了帮助您了解 Linux 内核是如何做到的：虽然每个驱动程序都可以做自己的事情，但是当芯片足够严格地遵循标准时，应该使用一个通用版本：[通用媒体独立接口设备支持](http://lxr.linux.no/linux+v2.6.27.7/drivers/net/mii.c)。

# css - CSS导航？

> ID：317587
> 
> 赞同：0
> 
> 时间：2008-11-25T14:48:39.370
> 
> 标签：css

以下站点左侧菜单中的导航使用 CSS 作为鼠标悬停链接。
[聚乙烯醇](http://www.pvh.com/)

当我获取导航代码并将其设置为单独的页面时。然后鼠标悬停链接不起作用。可能是什么原因？
[测试](http://shivanand.in/tmp/navigation.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T14:51:02.610

大概...

```
<script src="menu_1b.js" type="text/javascript">
</script>
<script src="menu_com.js" type="text/javascript"> 
```

对此事有话要说。编辑：一个名为函数 CreateMenuStructureAgain() 的函数会放弃它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T15:05:58.103

您需要“借用”在

```
http://www.pvh.com/menu_1b.js
http://www.pvh.com/menu_com.js 
```

然后使用链接到他们

```
<script src="menu_1b.js" type="text/javascript"></script>
<script src="menu_com.js" type="text/javascript"></script> 
```

你或许可以试试

```
<script src="http://www.pvh.com/menu_1b.js" type="text/javascript"></script>
<script src="http://www.pvh.com/menu_com.js" type="text/javascript"></script> 
```

它会起作用（前提是您有互联网连接，并且他们不修改脚本：D）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T15:33:50.497

如前所述，您还需要获取脚本。我打算为你看看一个解决方案，但后来我打开了你试图使用的 JS 代码。你可以用更少的代码做得更好。尝试查看[此菜单示例](http://htmldog.com/articles/suckerfish/dropdowns/example/vertical.html)和[随附的代码](http://htmldog.com/articles/suckerfish/dropdowns/)。您应该能够准确地完成您需要的操作，而无需大量的 Javascript。

# asp.net - 您如何遍历 web.config 中的自定义键？

> ID：317591
> 
> 赞同：3
> 
> 时间：2008-11-25T14:49:52.363
> 
> 标签：asp.net, web-config, loops

是否可以在 asp.net web.config 文件中创建我自己的自定义键并使用 C# 遍历它们？你是怎么做的（我把钥匙放在哪里？什么格式？）？我有一个内部网应用程序，它根据客户端的 IP 地址执行某些操作。我没有在代码隐藏文件中对它们进行硬编码，而是将它们放在 web.config 中并对其进行迭代。这样我就可以在我的配置文件中添加或删除，而无需重新编译所有内容。

我的钥匙会有名字、IP 地址，也许还有其他信息。

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-03-26T14:55:05.570

我认为这应该为你做...

这是在您的 web.config 中...

```
<configSections>
    <section name="DataBaseKeys" type="System.Configuration.NameValueFileSectionHandler, System, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
</configSections>
<DataBaseKeys>
    <!--Connection Strings for databases (or IP Addresses or whatever)-->
    <add key="dbCon1" value="Data Source=DbServerPath;Integrated Security=True;database=DbName1"/>
    <add key="dbCon2" value="Data Source=DbServerPath;Integrated Security=True;database=DbName1"/>
    <add key="dbCon3" value="Data Source=DbServerPath;Integrated Security=True;database=DbName1"/>
    <add key="dbCon4" value="Data Source=DbServerPath;Integrated Security=True;database=DbName1"/>
    <add key="dbCon5" value="Data Source=DbServerPath;Integrated Security=True;database=DbName1"/>  
</DataBaseKeys> 
```

这是你的代码...

```
using System.Configuration;

using System.Collections.Specialized;

protected void Page_Load(object sender, EventArgs e)
{
    LoadDdls();
}

private void LoadDdls()
{
    NameValueCollection nvcDbKeys = GetDbKeys();

    //Loop through the collection       
    for (int i = 0; i < nvcDbKeys.Count; i++)
    {
        // "Keys" is the "key" - Get(int) is the "value"
        this.DropDownList1.Items.Add(new ListItem(nvcDbKeys.Keys[i], nvcDbKeys.Get(i)));
    }
}

private NameValueCollection GetDbKeys()
{
    //Declare a name value collection to store Database Key List from web.config
    NameValueCollection nvcDatabaseKeyList;
    nvcDatabaseKeyList = (NameValueCollection) ConfigurationManager.GetSection("DataBaseKeys");

    return nvcDatabaseKeyList;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T15:03:42.147

您可以创建[自定义配置部分](http://msdn.microsoft.com/en-us/library/2tw134k3(VS.80).aspx)。这允许您将您的自定义配置放在 web.config 中，并以您认为合适的任何方式访问它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T15:07:14.323

**快速而肮脏的解决方案**：将您的密钥添加到 appSettings 中，并将索引作为后缀，即。“key1”、“key2”等，然后循环，直到你找到一个不存在的键。或者将分隔列表添加到单个键，即。“价值 1；价值 2；价值 3；..”。

**更好的解决方案**：创建自己的自定义部分处理程序，然后您可以在 web.config 的单独部分中以自己的方式添加数据。您需要在 web.config 的顶部定义节和节组，并引用节处理程序类。

```
<configuration>
   <configSections>
      <sectionGroup name="MySectionGroup">
          <section name="MySection" type="[type and full assembly name]"/>

   ...
   <MySectionGroup>
      <MySection>
         [some xml] 
```

接下来创建节处理程序类，它需要实现接口*IConfigurationSectionHandler*，该接口定义了一个*Create*方法。 *Create*将 sectionNode 作为参数，这是一个 XML 节点，您可以以任何您想要的方式解析。返回对象应包含您已解析的数据。要加载节处理程序，请编写：

```
MySectionDataObject myData = ConfigurationManager.GetSection( "MySectionGroup/Section" ) as MySectionDataObject 
```

# javascript - Javascript 访问浏览器上的拼写检查器

> ID：317598
> 
> 赞同：15
> 
> 时间：2008-11-25T14:51:51.093
> 
> 标签：javascript

是否可以通过 Javascript 访问浏览器中包含的用于文本区域的拼写检查器？我希望能够控制我的代码的拼写检查。如今，大多数浏览器（除了 IE）似乎都内置了某种拼写检查器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T15:05:48.117

我所知道的最多访问权限是在字段上禁用或启用拼写检查：[Inline Disabling of Firefox Spellcheck？](https://stackoverflow.com/questions/223940/inline-disabling-of-firefox-spellcheck)

我不知道您可以通过 javascript 直接访问浏览器的拼写检查器的方法。如果您不是特别关注浏览器的拼写检查器，那么有许多用于 javascript 的开源拼写检查器。只需尝试使用谷歌搜索 javascript 拼写检查器。

如果您真的想使用浏览器拼写检查，您可能需要创建一个文本框并将显示设置为无。然后，您可以将每个单词放入文本框中，然后检查它是否带有下划线。我不确定这是否可行，只是一个想法。我的建议是使用 javascript 拼写检查器，而不是尝试破解使用浏览器拼写检查器的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T15:17:59.623

浏览器不提供对其内置专有拼写检查器 API 的访问。我很确定没有 x-plat 方法可以做到这一点，更不用说为每个浏览器单独做的方法了。

最好的办法是与每个浏览器供应商核实，看看他们是否提供任何 javascript 挂钩他们的拼写检查器。

我认为他们最多允许的是Bobo所说的；您可以为文本框启用/禁用它，但我认为它们不允许任何进一步的控制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T15:26:14.207

没有。

如果你想控制拼写检查，你可以用 AJAX 自己做。

（顺便说一下，ieSpell 是一个免费的 IE 拼写检查插件，用户可以很容易地自行安装）

# java - 创建用于 Word 2007 的邮件列表时使用的最佳格式是什么？

> ID：317602
> 
> 赞同：0
> 
> 时间：2008-11-25T14:53:04.150
> 
> 标签：java, ms-word, office-2007, mailmerge

我正在编写一个允许用户选择联系人的网络应用程序（Java）。可以下载联系人详细信息（当前为 CSV 格式）并用于在 Word 2007 中执行邮件合并。

我想使用一种比 CSV 更“稳健”的格式。你们这些非英语领域的人都知道逗号/分号问题！

你会使用哪种格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-26T00:28:04.207

对于这类任务，我更喜欢 TSV（制表符分隔值）。我从未遇到过包含输出中所需的文字选项卡的数据集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:59:34.950

在“非英语”邮件合并方面没有太多经验，以 xlsx 格式导出联系人并将其用作数据源有什么问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-28T14:21:15.677

根据您让用户进行邮件合并的原因，您可以考虑将所有工作转移到服务器端。当用户选择联系人并单击确定时，让服务器进行邮件合并并为用户创建文档并将其发送给他们。[Docmosis](http://www.docmosis.com)或[JODReports](http://jodreports.sourceforge.net/)可以提供这种能力。您还可以允许用户选择不同的模板，或者如果您真的很慷慨，让用户上传自己的模板。

# java - 阿拉伯语和英语的混合导致 JTextArea (Java) 中的问题

> ID：317605
> 
> 赞同：1
> 
> 时间：2008-11-25T14:55:00.510
> 
> 标签：java, swing, internationalization, bidi

我有一个显示阿拉伯语网页的 HTML 的 JTextArea。所以它本质上是英语和阿拉伯语的混合体。在 JTextArea 中，列设置为 30，某些文本只是消失而不是正确换行。奇怪的是，如果我将不可见的文本复制并粘贴到记事本中，那么我可以在记事本中看到它。如果我将列数更改为 40，则一切正常。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T15:41:38.170

请参阅此问题的屏幕截图：

![http://i.stack.imgur.com/lErjB.jpg](https://i.stack.imgur.com/lErjB.jpg)

埃利，感谢您的回复。不确定我是否正确解释了这个问题。屏幕截图的左侧是 JTextArea。右侧是粘贴到记事本中的 JTextArea 中的选择。这现在更有意义了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T15:30:46.413

是不是第 30 个字符正在消失？这可能是由于 JTextArea 无法正确呈现阿拉伯字符的脚本。所以它正确地计算了字符，但没有意识到它们占用了更多空间。对此类字体的支持不是很好，因此您可能希望为您的 JTextArea 编写一个自定义渲染器来处理这个问题（因此您可以手动考虑每个阿拉伯语字符所需的适当空间量并相应地调整换行）。

# c# - 如何在 LinqToSql 中执行 WHERE...IN... 子句？

> ID：317606
> 
> 赞同：2
> 
> 时间：2008-11-25T14:55:43.100
> 
> 标签：c#, sql, linq-to-sql, where-clause

如何使用 WHERE...IN... 类型的子句选择多个元素，如

```
select * from orders where orderid in (1, 4, 5) 
```

在 LinqToSql 中？我不想有 lambda 表达式，因为它们吓到我了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-25T14:57:41.940

LINQ 有“包含”，它类似于“IN”，但反过来表达——一个元素不是“在”一个集合中，一个集合“包含”一个元素。

```
int[] validIds = { 1, 4, 5 };
var query = from order in db.Orders
            where validIds.Contains(order.Id)
            select order 
```

不过，这更简单地用 lambda 表示（IMO）：

```
int[] validIds = { 1, 4, 5 };
var query = db.Orders.Where(order => validIds.Contains(order.Id)); 
```

我意识到 lambdas 是“新的”，因此在某种程度上很可怕，但用双手抓住它们真的很值得。他们很可爱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T14:58:39.117

```
int[] arry = new int[] {1,4,5};

var q = from r in orders
        where Array.IndexOf(array, orderid) != -1
        select r; 
```

或者

```
List<int> lst = new List<int>(new int[] {1,4,5});
var q = from r in orders
        where lst.Contains(orderid);
        select r; 
```

# c# - ASP.NET MVC return a different view

> ID：317611
> 
> 赞同：30
> 
> 时间：2008-11-25T14:58:17.867
> 
> 标签：c#, asp.net-mvc

I have a view which contains a form, the form posts and the data gets processed etc, then I want to return the view Index, so return view("Index");

however this will then complain about my ViewData not existing, I get the feeling that the controller code under Index() isn't being processed which adds the list it requires to the ViewData, anyone know what's wrong?

Thanks

edit: Apparently it's done to prevent recursion.. in which case, I'm lost as to what to do without repeating all my ViewData stuff both Controllers

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-25T15:41:55.987

I think you should have two actions: one that processes the form submission, and another one that collects data for the view. Once the form has been processed, you call `return RedirectToAction("Index")` and you are done. I hope I understood what you meant by this.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-29T01:52:01.967

If your Index method on the controller does a `return View("Index");` then just call the Index method with any parameters it requires. Then the method will populate the ViewData reuired by the Index View.

# java - 如何将位组装成一个 long 以创建唯一 ID？

> ID：317617
> 
> 赞同：1
> 
> 时间：2008-11-25T14:59:47.897
> 
> 标签：java, guid, uuid, bit

我想编写一个实用程序，为我提供 Java 中相对唯一的 ID。一些非常简单的东西，比如时间戳中的 x 位 + 随机数中的 y 位。

那么，我将如何实现以下方法：

```
long getUniqueID()
{
    long timestamp = System.currentTimeMillis();
    long random = some random long

    ...

    return id;
} 
```

奖金

对于我可以用来形成我的身份证的其他容易获得的信息有什么建议吗？

注意：我知道 GUID，我知道 Java 有一个 UUID 类，但我不想要 128 位长的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T15:05:19.057

只需剪辑您不需要的位：

```
return java.util.UUID.randomUUID().getLeastSignificantBits(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T15:05:07.963

您要做的是创建一个[哈希函数](http://en.wikipedia.org/wiki/Hash_function)，将两个长值组合成一个长值。在这种情况下，哈希函数的[一致性](http://en.wikipedia.org/wiki/Hash_function#Uniformity)将至关重要，因为创建的唯一 ID 值中的冲突是不可接受的。但是，如果您可以将散列值与先前创建的标识符进行比较，则可以通过修改散列来解决冲突，直到不发生冲突。

例如，您可以获取时间戳并对随机值执行[异或](http://en.wikipedia.org/wiki/Exclusive_or)（在 Java 中使用插入符号 ^ 运算符）。如果检测到碰撞，则将结果加一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T22:27:56.837

如果在同一个 JVM 中唯一就足够了，那么这样的事情应该可以完成。

```
public class UniqueID {
  static long current= System.currentTimeMillis();
  static public synchronized long get(){
    return current++;
    }
} 
```

# windows - 放弃对 Windows 98 的支持有什么影响？

> ID：317618
> 
> 赞同：1
> 
> 时间：2008-11-25T14:59:52.967
> 
> 标签：windows, windows-98

到目前为止，在我的应用程序中，我一直支持从 Windows 98 到 Windows NT/2000 到 XP 到 Vista 的所有版本的 Windows。

但是因为在我的下一个版本中添加了 Unicode，对 Windows 98 的支持仍然是可能的，但非常困难。

我知道我的一些用户仍然在运行 Windows 98。

我不再支持 Windows 98 的利弊是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-25T15:06:40.457

放弃对 Win98 的支持会打开一整套新的 Win32 API，您可以在软件中使用它们。这将使您能够在较新的操作系统上为大多数客户提供更好的体验。

继续为 Win98 用户提供您的软件的当前版本，但要明确在您的软件的未来版本中将不支持 Win98。

我想大多数 Win98 用户已经开始收到消息，并且很快就会升级。此外，如果他们不愿意为升级他们的计算机/操作系统付费，他们也不太可能愿意为升级您的软件付费；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T15:08:12.387

对您和您的业务的影响将取决于您的用户中有多少百分比仍在运行 Windows 98，以及您在他们上花费的支持时间的百分比。如果这两个变量的比例相同或大致相同，我会继续支持它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T15:14:25.573

我认为 Sherm 在这里一针见血：

> 如果您仍然有运行 Windows 98 的用户，那么放弃支持的一个明显缺点是其中一些将不可避免地拒绝升级。他们要么坚持使用他们已经拥有的软件版本，要么切换到其他版本。

我只想添加一件事——任何使用 Windows 98 的人可能都不会那么热衷于升级*任何东西*。事实上，您所拥有的使用 Win98 的用户很可能正在使用*您的*软件的旧版本。

在任何情况下，支持最少的基于 WinNT 的 Windows 的优势太多了，无法在此一一列举。最好的解决方案是向这些用户提供指向您软件的最后一个正常运行的 Win98 兼容版本的链接，但您不应该竭尽全力迎合仍然热衷于运行 10 年旧操作系统的人.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-25T15:05:30.617

如果您仍然有运行 Windows 98 的用户，那么放弃支持的一个明显缺点是其中一些将不可避免地拒绝升级。他们要么坚持使用他们已经拥有的软件版本，要么切换到其他版本。

另一方面，为这些用户开发和支持的成本可能超过从中获得的额外收入。因此，即使原则上您不想要任何不满意的客户，但实际上让 99% 的客户满意可能更具成本效益。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-25T15:05:53.797

在您的情况下，最常见的做法是让客户使用运行旧版本的 Windows 98。有时你只需要放下过去。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T15:14:36.947

好吧，如果您的一位客户运行 10 年前的操作系统（在大概 10 年前的硬件上），那么有些事情告诉我他们并没有花费太多更新您的软件。

除非它是私人客户，向您支付定制软件的费用，否则我不会担心。

如果是私人客户要求定制软件，也许你应该证明现代机器的价格与你不得不使用这样一个旧系统的溢价。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T15:11:16.377

在 Windows 98 上仍有一些 Unicode 函数可用：

[http://support.microsoft.com/kb/210341](http://support.microsoft.com/kb/210341)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-25T15:10:17.343

根据您使用的路线图和技术 - 可能（但有点痛苦）分支您的代码。使用一个体面的 SCM 系统，您可以在您的“新”分支和反向移植（合并）功能以及与 win98 分支相关的错误修复中进行开发。

这有点工作，但它可以让您继续为所有客户提供新功能，并且不会让您的 win98 用户退出该过程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-25T15:23:01.640

如果客户/用户满足于在 Windows 98 上运行，那么他们将满足于您的软件的过时版本。

只需冻结当前的 Win98 可执行文件并在发行说明中说明更新的功能将仅在 Win2K 或 Vista 版本中可用。

我认为这不会让任何人感到不安（您可能知道不同！），只要您承诺修复错误，客户应该会很高兴。

# c# - yield 在 LINQ 之外有用吗？

> ID：317619
> 
> 赞同：27
> 
> 时间：2008-11-25T15:00:13.263
> 
> 标签：c#, .net, linq, yield

当我认为我可以使用 yield 关键字时，我会后退一步，看看它将如何影响我的项目。我总是最终返回一个集合而不是 yeilding，因为我觉得维护 yeilding 方法状态的开销并没有给我带来太多好处。在我返回集合的几乎所有情况下，我觉得 90% 的时间，调用方法将遍历集合中的所有元素，或者将在整个集合中寻找一系列元素。

我确实理解它在 linq 中的用处，但我觉得只有 linq 团队在编写如此复杂的可查询对象，因此 yield 是有用的。

有没有人写过类似或不喜欢 linq 的东西，其中 yield 有用？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-25T15:05:35.310

请注意，使用 yield 时，您对集合进行了一次迭代，但是当您构建一个列表时，您将对其进行两次迭代。

以过滤迭代器为例：

```
IEnumerator<T>  Filter(this IEnumerator<T> coll, Func<T, bool> func)
{
     foreach(T t in coll)
        if (func(t))  yield return t;
} 
```

现在，您可以将其链接起来：

```
 MyColl.Filter(x=> x.id > 100).Filter(x => x.val < 200).Filter (etc) 
```

您的方法将创建（并折腾）三个列表。我的方法只迭代一次。

此外，当您返回集合时，您会强制用户执行特定的实现。迭代器更通用。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-02T23:51:22.393

> 我确实理解它在 linq 中的用处，但我觉得只有 linq 团队在编写如此复杂的可查询对象，因此 yield 是有用的。

Yield 在 .NET 2.0 中实现后就很有用了，这比任何人都想到 LINQ 还早。

为什么要写这个函数：

```
IList<string> LoadStuff() {
  var ret = new List<string>();
  foreach(var x in SomeExternalResource)
    ret.Add(x);
  return ret;
} 
```

当我可以使用 yield 并节省无缘无故创建临时列表的工作量和复杂性时：

```
IEnumerable<string> LoadStuff() {
  foreach(var x in SomeExternalResource)
    yield return x;
} 
```

它还可以具有巨大的性能优势。如果您的代码恰好使用了集合的前 5 个元素，那么使用 yield 通常会避免加载超过该点的任何内容。如果你建立一个集合然后返回它，你会浪费大量的时间和空间来加载你永远不需要的东西。

我可以继续下去....

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-25T17:04:39.813

我最近不得不以 Expression 类的形式表示数学表达式。在评估表达式时，我必须使用后序树遍历遍历树结构。为了实现这一点，我像这样实现了 IEnumerable<T>：

```
public IEnumerator<Expression<T>> GetEnumerator()
{
    if (IsLeaf)
    {
        yield return this;
    }
    else
    {
        foreach (Expression<T> expr in LeftExpression)
        {
            yield return expr;
        }
        foreach (Expression<T> expr in RightExpression)
        {
            yield return expr;
        }
        yield return this;
    }
} 
```

然后我可以简单地使用 foreach 来遍历表达式。您还可以根据需要添加一个 Property 来更改遍历算法。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-25T15:24:31.060

在以前的公司，我发现自己在编写这样的循环：

```
for (DateTime date = schedule.StartDate; date <= schedule.EndDate; 
     date = date.AddDays(1)) 
```

使用一个非常简单的迭代器块，我可以将其更改为：

```
foreach (DateTime date in schedule.DateRange) 
```

IMO，它使代码更容易阅读。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-25T16:12:53.723

`yield`是为 C#2 开发的（在 C#3 中的 Linq 之前）。

在处理数据访问和大量重复计算时，我们在大型企业 C#2 Web 应用程序中大量使用了它。

每当您有一些要多次点击的元素时，集合都很棒。

但是，在许多数据访问场景中，您拥有大量元素，您不一定需要在一个大集合中传递这些元素。

这本质上就是这样`SqlDataReader`做的 - 它是一个仅向前的自定义枚举器。

让你`yield`做的是用最少的代码快速编写你自己的自定义枚举器。

所做的一切`yield`都可以在 C#1 中完成 - 只需要大量代码即可完成。

Linq 确实最大化了收益行为的价值，但它肯定不是唯一的应用程序。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T15:21:31.520

每当您的函数返回 IEnumerable 时，您都应该使用“yielding”。仅在 .Net > 3.0 中不存在。

.Net 2.0 示例：

```
 public static class FuncUtils
  {
      public delegate T Func<T>();
      public delegate T Func<A0, T>(A0 arg0);
      public delegate T Func<A0, A1, T>(A0 arg0, A1 arg1);
      ... 

      public static IEnumerable<T> Filter<T>(IEnumerable<T> e, Func<T, bool> filterFunc)
      {
          foreach (T el in e)
              if (filterFunc(el)) 
                  yield return el;
      }

      public static IEnumerable<R> Map<T, R>(IEnumerable<T> e, Func<T, R> mapFunc)
      {
          foreach (T el in e) 
              yield return mapFunc(el);
      }
        ... 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-25T15:46:09.160

我不确定 C# 对 yield() 的实现，但在动态语言上，它比创建整个集合要高效得多。在许多情况下，它可以轻松处理比 RAM 大得多的数据集。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-27T15:41:19.993

我是 C# 的一个巨大的产量粉丝。在大型自主开发的框架中尤其如此，其中方法或属性通常返回 List，它是另一个 IEnumerable 的子集。我看到的好处是：

*   使用 yield 的方法的返回值是不可变的
*   你只在列表上迭代一次
*   它是一个延迟或延迟执行变量，这意味着返回值的代码在需要时才会执行（尽管如果您不知道自己在做什么，这可能会咬到您）
*   源列表的更改，您不必调用来获取另一个 IEnumerable，您只需再次迭代 IEnumerable
*   还有很多

收益的另一个巨大好处是当您的方法可能会返回数百万个值时。如此之多，以至于在方法甚至可以返回它之前构建 List 就有可能耗尽内存。使用yield，该方法可以创建和返回数百万个值，只要调用者也不存储每个值。所以它适用于大规模数据处理/聚合操作

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-25T15:15:43.450

就个人而言，我还没有发现我在日常的日常编程中使用了 yield。但是，我最近开始使用 Robotics Studio 示例，发现 yield 在那里被广泛使用，所以我还看到它与 CCR（并发和协调运行时）一起使用，您会遇到异步和并发问题。

无论如何，仍然试图让我的头脑围绕它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-25T15:19:47.653

产量很有用，因为它可以节省空间。编程中的大多数优化都在空间（磁盘、内存、网络）和处理之间进行权衡。Yield 作为一种编程结构，允许您按顺序对集合进行多次迭代，而无需为每次迭代创建单独的集合副本。

考虑这个例子：

```
static IEnumerable<Person> GetAllPeople()
{
    return new List<Person>()
    {
        new Person() { Name = "George", Surname = "Bush", City = "Washington" },
        new Person() { Name = "Abraham", Surname = "Lincoln", City = "Washington" },
        new Person() { Name = "Joe", Surname = "Average", City = "New York" }
    };
}

static IEnumerable<Person> GetPeopleFrom(this IEnumerable<Person> people,  string where)
{
    foreach (var person in people)
    {
        if (person.City == where) yield return person;
    }
    yield break;
}

static IEnumerable<Person> GetPeopleWithInitial(this IEnumerable<Person> people, string initial)
{
    foreach (var person in people)
    {
        if (person.Name.StartsWith(initial)) yield return person;
    }
    yield break;
}

static void Main(string[] args)
{
    var people = GetAllPeople();
    foreach (var p in people.GetPeopleFrom("Washington"))
    {
        // do something with washingtonites
    }

    foreach (var p in people.GetPeopleWithInitial("G"))
    {
        // do something with people with initial G
    }

    foreach (var p in people.GetPeopleWithInitial("P").GetPeopleFrom("New York"))
    {
        // etc
    }
} 
```

（显然，您不需要将 yield 与扩展方法一起使用，它只是创建了一个强大的范式来思考数据。）

如您所见，如果您有很多这些“过滤器”方法（但它可以是任何一种对人员列表执行某些工作的方法），您可以将其中的许多链接在一起，而无需为每个步骤提供额外的存储空间. 这是提高编程语言 (C#) 以更好地表达您的解决方案的一种方法。

yield 的第一个副作用是它会延迟过滤逻辑的执行，直到您真正需要它。因此，如果您创建了一个 IEnumerable<> 类型的变量（带有产量）但从不迭代它，那么您永远不会执行逻辑或消耗空间，这是一种强大且免费的优化。

另一个副作用是 yield 在最低的公共集合接口 (IEnumerable<>) 上运行，它可以创建具有广泛适用性的类库代码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-25T17:21:07.377

请注意，yield 允许您以“懒惰”的方式做事。懒惰是指在实际请求该元素之前，不会对 IEnumberable 中的下一个元素进行评估。这使您有能力做一些不同的事情。一个是您可以生成一个无限长的列表，而无需实际进行无限计算。其次，您可以返回函数应用程序的枚举。仅当您遍历列表时才会应用这些函数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-25T16:03:20.560

我在这样的非 linq 代码中使用了 yeild（假设函数不在同一个类中）：

```
public IEnumerable<string> GetData()
{
    foreach(String name in _someInternalDataCollection)
    {
        yield return name;
    }
}

...

public void DoSomething()
{
    foreach(String value in GetData())
    {
        //... Do something with value that doesn't modify _someInternalDataCollection
    }
} 
```

您必须小心不要无意中修改 GetData() 函数正在迭代的集合，否则会引发异常。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-02T23:32:33.227

一般来说，产量非常有用。它在支持函数式编程的其他语言中使用 ruby​​，因此它就像与 linq 相关联。相反，linq 在风格上是函数式的，所以它使用 yield。

我有一个问题，我的程序在一些后台任务中使用了大量的 cpu。我真正想要的是仍然能够像平常一样编写函数，以便我可以轻松阅读它们（即整个线程与基于事件的参数）。如果它们占用过多的 cpu，仍然能够分解这些功能。产量非常适合这一点。我写了[一篇](http://people.iola.dk/arj/2008/02/15/improving-latency-while-keeping-your-sanity/)关于这个的博客文章，并且所有人都可以使用源代码:)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-09-28T13:19:29.247

System.Linq IEnumerable 扩展很棒，但有时您想要更多。例如，考虑以下扩展：

```
public static class CollectionSampling
{
    public static IEnumerable<T> Sample<T>(this IEnumerable<T> coll, int max)
    {
        var rand = new Random();
        using (var enumerator = coll.GetEnumerator());
        {
            while (enumerator.MoveNext())
            {
                yield return enumerator.Current; 
                int currentSample = rand.Next(max);
                for (int i = 1; i <= currentSample; i++)
                    enumerator.MoveNext();
            }
        }
    }    
} 
```

yielding 的另一个有趣的优点是调用者不能将返回值强制转换为原始集合类型并修改您的内部集合

# vb.net - Windows 窗体上 DataGridView 行内的 VB.NET 控件

> ID：317621
> 
> 赞同：0
> 
> 时间：2008-11-25T15:01:32.027
> 
> 标签：vb.net, winforms

我在 Windows 窗体上的 DataGridView Row 的单元格内有一个 ComboBox。我需要发生以下情况：

1.  单击组合框
2.  选择一个值
3.  重新计算位于 DataGridView 外部的标签内的总和显示。

目前，正在发生以下情况：

1.  单击组合框
2.  再次点击打开CB的下拉列表
3.  选择一个值
4.  单击单元格外部以强制重新计算外部标签。

首先，我想避免必须单击组合两次（一次设置焦点，再次选择值）。其次，我希望在选择一个值后进行实时重新计算。

有没有人有一两个技巧来解决这些问题？

我已经尝试了 DGV 上的大多数事件，但运气不佳。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T15:13:12.940

向 DataGridView 的 CellClick 事件添加一个处理程序，看起来有点像：

```
private void vehicleTypeGridView_CellClick(object sender, DataGridViewCellEventArgs e)
{
    if ( e.RowIndex == - 1 ) return; //Header Cell clicked -> ignore it.
    vehicleTypeGridView.BeginEdit ( true );
    var control = vehicleTypeGridView.EditingControl as DataGridViewComboBoxEditingControl;
    if ( control != null ) control.DroppedDown = true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-01T21:25:32.607

首先，设置你的 datagridview 编辑模式：

```
datagridview.EditMode = Windows.Forms.DataGridViewEditMode.EditOnEnter 
```

接下来，将组合框的发送键设置为 F4：

```
Private Sub datagridview_EditingControlShowing(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs)
        Handles datagridview.EditingControlShowing
    Dim CB As Object = TryCast(e.Control, System.Windows.Forms.ComboBox)
    If CB IsNot Nothing Then
        My.Computer.Keyboard.SendKeys("{F4}")
    End If
End Sub 
```

# algorithm - 网格级最佳遮挡剔除的最有效算法？

> ID：317622
> 
> 赞同：3
> 
> 时间：2008-11-25T15:01:33.680
> 
> 标签：algorithm, search, graphics, 3d

我是挑选新手。乍一看，似乎大多数遮挡剔除算法都是对象级别的，而不是检查单个网格，这对于游戏渲染很实用。

我正在寻找的是一种算法，该算法可以高精度地剔除单个对象内对于给定视点被遮挡的所有网格。它至少需要*O(n log n)*，一个简单的逐个网格比较（*O(n^2)*）太慢了。

我注意到 Blender GUI 会实时为您识别被遮挡的网格，即使您使用超过 10,000 个网格的大型对象也是如此。那里使用什么算法，请告诉我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-10T23:00:18.060

Blender 基于 Bullet 物理库中的动态 AABB 树加速结构执行视锥体剔除和遮挡剔除。遮挡物和对象由它们的边界体积（轴对齐的边界框）表示。

给定一个相机平截头体，视锥体剔除只是遍历 AABB 树。

遮挡剔除基于遮挡缓冲区，这是一种使用非常简单的软件渲染器初始化的深度缓冲区：使用动态 AABB 树加速结构的基本光线追踪器。您可以选择遮挡缓冲区的分辨率来权衡准确性与效率。

另请参阅文档[http://wiki.blender.org/index.php/Dev:Ref/Release_Notes/2.49/Game_Engine#Performance](http://wiki.blender.org/index.php/Dev:Ref/Release_Notes/2.49/Game_Engine#Performance)

Blender 源树中的 Blender 实现： blender\source\gameengine\Physics\Bullet\CcdPhysicsEnvironment.cpp 方法 bool CcdPhysicsEnvironment::cullingTest(PHY_CullingCallback callback, void* userData, PHY__Vector4 *planes, int nplanes, int occlusionRes)

Bullet Physics SDK 在 Bullet/Extras/CDTestFramework 中有一些 C++ 示例代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T15:16:06.570

你有没有研究过八叉树之类[的东西](http://en.wikipedia.org/wiki/Octree)？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T18:18:18.433

不在网格级别进行剔除的原因是网格是一个非常愚蠢的渲染器级别对象，而游戏对象处于场景级别，所有剔除都发生在场景级别。没有网格级别的剔除决定，如果需要渲染对象，它们只是一种批处理具有相似着色器状态的图元的方法。

如果您确实需要在网格级别进行剔除，那么您可能希望为每个网格创建一个对象，然后创建一个包含网格对象的组对象。请注意，您实际上可能会失去性能，因为在网格级别进行剔除通常是不值得的；它可能会中断向硬件传输的数据流。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T17:02:53.937

Usually the first thing you do is see if the meshes have any chance of occluding each other. Often times with a simple bounding primitive (bounding boxes or bounding spheres). If I recall correctly, [Octrees](http://en.wikipedia.org/wiki/Octree) will help with this.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T12:26:00.847

我尝试**了天真的方法**，它实际上对我的应用程序来说足够快。

对于网格中的每个三角形，检查是否被网格中的任何其他三角形遮挡，因此为*O(n2)*。（我仅通过检查每个三角形的中心点是否被遮挡获得了高精度结果，尽管如果准确性很重要，您至少也应该检查三角形角顶点）。

在奔腾 4 机器 (c++) 上，**大约 10,000 个三角形的二进制 STL 对象大约需要 1 分钟才能完成**。

通过首先对三角形进行排序，例如按面积大小或与视点的距离（更有可能被遮挡，因此您可以跳过更多检查），该算法可以优化高达约 40%。

下一个优化步骤是将三角形放入八叉树中，这将大大减少遮挡检查的次数。

# php - phpmyadmin - 将文件保存到磁盘

> ID：317630
> 
> 赞同：2
> 
> 时间：2008-11-25T15:03:49.543
> 
> 标签：php, apache, phpmyadmin

当我将浏览器指向时`http://localhost/phpmyadmin`，它没有显示它的首页，而是显示另存为对话框。

我正在运行：Apache/2.2.3 (Debian) PHP/5.2.0-8+etch13 服务器

我已经重新安装了 apache2 和 php5。重新安装后我没有 httpd.conf 文件，我怎样才能找回它？有没有我可以复制到 /etc/apache2 的标准文件？

我做了一个定位 httpd.conf，我得到的唯一文件是我在 /etc/apache2/ 下创建的空文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T15:26:51.913

您是否配置了 php 扩展以发送 http 标头？

在 httpd.conf 中：AddType application/x-httpd-php .php

编辑
该文件不一定命名为`httpd.conf`，这只是默认名称。尝试在 Apache 目录中搜索其他配置文件 - 扩展名可能是`.conf`，但它可能是其他东西...如果您在 debian 上使用 apt-get 安装 apache2，请尝试`/etc/apache2/apche2.conf`
/EDIT

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-23T08:04:12.153

我在安装 ISPconfig 时也遇到了这个问题。我通过本教程解决了这个问题：http: [//www.howtoforge.com/perfect-server-debian-wheezy-apache2-bind-dovecot-ispconfig-3-p4](http://www.howtoforge.com/perfect-server-debian-wheezy-apache2-bind-dovecot-ispconfig-3-p4)

我认为主要代码是更改 suphp.conf 配置。

```
sudo nano /etc/apache2/mods-available/suphp.conf 
```

注释掉`<FilesMatch "\.ph(p3?|tml)$"> section and add the line AddType application/x-httpd-suphp .php .php3 .php4 .php5 .phtml`- 否则所有 PHP 文件都将由 SuPHP 运行

```
<IfModule mod_suphp.c>
    #<FilesMatch "\.ph(p3?|tml)$">
    #    SetHandler application/x-httpd-suphp
    #</FilesMatch>
        AddType application/x-httpd-suphp .php .php3 .php4 .php5 .phtml
        suPHP_AddHandler application/x-httpd-suphp

    <Directory />
        suPHP_Engine on
    </Directory>

    # By default, disable suPHP for debian packaged web applications as files
    # are owned by root and cannot be executed by suPHP because of min_uid.
    <Directory /usr/share>
        suPHP_Engine off
    </Directory>

# # Use a specific php config file (a dir which contains a php.ini file)
#       suPHP_ConfigPath /etc/php5/cgi/suphp/
# # Tells mod_suphp NOT to handle requests with the type <mime-type>.
#       suPHP_RemoveHandler <mime-type>
</IfModule> 
```

希望我能帮助别人:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T20:12:14.460

我想你只是不知道那个配置文件在哪里。我认为没有 httpd.conf 就无法运行 apache。以下是如何找到您的配置：
`$>locate httpd.conf
/etc/httpd/conf/httpd.conf
$>vim /etc/httpd/conf/httpd.conf`

找到它后，找到其他 AddType 所在的位置并添加
`AddType application/x-httpd-php .php`

您需要做的最后一件事是重新启动您的 httpd，这取决于安装，但这样做`apachectl restart`可以解决问题。您可能必须像使用 httpd.conf 文件一样找到它并输入文件的完整路径。

之后，您的 phpmyadmin 应该会出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T19:17:32.207

我对此一无所知，但是...有人知道在javascript中下载所选文件的方法吗，例如我通过复选框选择2个文件，然后单击一个按钮以下载这2个文件，选择我所在的路线将保存档案

# connection-string - 集中和保护连接字符串的最佳方法是什么？

> ID：317631
> 
> 赞同：13
> 
> 时间：2008-11-25T15:04:00.883
> 
> 标签：connection-string, database-connection

集中和保护应用程序使用的连接字符串的最佳方法是什么？在我的环境中，我们有许多内部应用程序。每个应用程序都需要一个或多个连接字符串才能访问数据库。我们的目标是集中所有这些连接字符串（特别是 SQL 登录名和密码），以便我们可以在一个地方更改密码，而不是在 35 个不同的 .config 文件、注册表项等中更改密码。

目前我们正在使用一个本地组件，它从访问数据库中提取连接字符串信息，这涵盖了集中化要求，但不是特别安全。此外，我们还有用经典 asp、vb6、delphi、c++、.net 等语言编写的应用程序，因此该解决方案需要可供所有这些应用程序使用。

有没有人知道如何更好地做到这一点，或者我们是否需要重新设计我们的整个方法来处理我们的应用程序访问数据库的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T15:22:06.137

我工作的公司通过 SQL Server 数据库使用了类似的情况。我们最终创建了一个兼容 COM 的 .net dll，以简化和保护数据库中的 API，并确保在经典的 asp、.Net 和 DTS 包之间使用相同的逻辑。一年来它对我们来说效果很好，虽然我们很多人都想用它做一些重构项目，但解决服务器迁移或重命名等问题非常棒。

我认为您走在正确的道路上；但是，我建议进行以下更改：

*   尝试迁移到真正的数据库服务器。访问非常适合 MS Office，但不适用于这种规模的东西。
*   构建一个管理控制台，允许审核谁在添加和编辑信息（确保谁也可以访问哪些设置）。
*   构建一个兼容 COM 的 DLL，以便其他系统可以以安全和一致的方式使用它。

编辑：

在这样的系统中工作多年后，我注意到的一点是，它在某些解决方案上稍微束缚了你的手。当连接字符串不再在配置文件中时，许多工具（即 .Net 世界中的 nHibernate、Elmah 等）确实受到限制。许多可以轻松修改以使用您的 API；但是，如果您想使用它，则需要花费更多时间进行调查。仅供参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T16:06:51.723

You can use Windows server to create users that are allowed to access your SQL Server database. Then you can use integrated windows login in connection strings.

BTW Storing passwords in public MDB renders them irelevant. Same as they don't exist.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T15:26:39.217

是否无法在连接字符串中移至 Window Integrated Security，那么您不必担心安全方面的问题（除非您需要保护我猜的连接的实际位置）。

# .net - Silverlight：有没有办法让用户从隔离存储中打开文件？

> ID：317644
> 
> 赞同：1
> 
> 时间：2008-11-25T15:07:46.757
> 
> 标签：.net, silverlight, webdav

我想允许用户通过 Silverlight 在他们自己的客户端应用程序中打开文件。我希望它的工作方式与 WebDAV 类似，因为他们可以将文件读/写回 Silverlight 的隔离存储......

是否可以构造一个指向独立存储文件的 file:// 链接？在具有 silverlight 插件的浏览器中是否有为 silverlight 定义的 uri 方案？

我完全疯了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-25T16:25:27.520

看起来你可以做到这一点，这里有一个[教程](http://blog.paranoidferret.com/index.php/2007/10/12/silverlight-tutorial-using-isolated-storage/)。教程只是关于如何使用隔离存储，但示例是打开用户系统上的文件并将它们存储在隔离存储中。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T18:37:14.917

不幸的是，今天没有直接支持您的要求。但是，随着上个月 Silverlight 3 的发布，您会发现现在有一个 FileSaveDialog。

结合隔离存储、FileOpenDialog 和 FileSaveDialog，您确实可以选择一些选项来创建一个系统来向您的用户提供文件并接收他们的更新。

但是，他们需要启动打开和保存 - 实际隔离的存储文件路径很难发现，并且不建议允许用户直接访问它们。

# registry - 使用程序卸载键中的 EstimatedSize 值在“添加/删除程序”列表中正确显示程序大小

> ID：317647
> 
> 赞同：1
> 
> 时间：2008-11-25T15:09:02.747
> 
> 标签：registry, uninstallation

在为我开发的应用程序创建卸载程序注册表项期间，我尝试使用 EstimatedSize 值，不幸的是，我指定的值没有出现在我的程序条目旁边的“添加/删除程序”列表中。我试图找到使用此值的正确程序，但无济于事。有人对这个问题有任何经验吗？您的帮助将不胜感激。

**Divo**让我走上了正确的道路，所以我想我会发布有关如何正确显示 EstimatedSize 值的分步说明。

1.  创建具有所有相关属性的注册表项，包括 EstimatedSize。此值将复制到注册表中的 ARPCache 键中
2.  在 ARPCache 文件夹中找到注册表项，删除 SlowInfoCache 二进制值，并将 Changed 值设置为 1。
3.  下次打开添加/删除程序列表时，您将看到您在 EstimatedSize 条目中指定的值，而不是 Windows 生成的任意值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T19:49:08.343

我发现改变 EstimatedSize 的值

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{my-guid-value} 
```

没有任何直接影响。此值缓存在以下键中：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Management\ARPCache\{my-guid-value}\SlowInfoCache 
```

只有在我删除（重命名）此*SlowInfoCache*值后，更新后的大小才会出现在*Add or remove programs*下。

问候，迪沃

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-19T19:13:04.640

在 Windows7 上编写任意值对我来说效果很好。

我使用 NSIS，它不会自动填充这个值或写这个键或在这里做任何神奇的事情。但是您可以自己创建注册表项，并使用普通脚本命令自己将任何您想要的内容放入其中。

这是 NSIS *.nsi 脚本，抱歉，只有 3 行有效。我认为您不必了解 NSIS 就可以看到我只是在任意创建密钥并将我选择的值写入其中。我还可以告诉你，当我在那里输入错误的值时，它肯定会出现在添加/删除程序中，和我写的一样糟糕。（我一开始以为该值应该以字节为单位，所以，我的 3.2 MB 应用程序显示为 3.2 GB）

摘自 foo.nsi ：

```
[...]

; ARP = just convenience variable to hold the long reg key path
!define ARP "Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}"

[...]

; Specify a section ID like SEC_01, for obtaining its size in kilobytes later
Section "Install" SEC_01

; [...copy all files here, before SectionGetSize...]

; Obtain the size of the files, in kilobytes, in section SEC_01
SectionGetSize "${SEC_01}" $0

; Create/Write the reg key with the dword value
WriteRegDWORD HKLM "${ARP}" "EstimatedSize" "$0"

[...write the other keys in the same reg path...]

SectionEnd

[...] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T17:12:05.943

你用的是什么安装程序？微星？

Windows Installer 将在安装期间确定并设置此值（请参阅 MSDN：[卸载注册表项](http://msdn.microsoft.com/en-us/library/aa372105.aspx)）

我认为无法手动设置此值。幕后发生了很多事情（一些真正“蹩脚”的东西）（[http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/07/09/178342.aspx)）

问候，迪沃

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-17T15:31:13.407

虽然这个话题已经很老了，但在寻找如何在 Windows XP 的添加/删除程序窗口中显示应用程序大小时，我进行了一次搜索，所以我发布了我发现的内容，以防其他人发现它有用：

只需转到以下应用程序的文件夹：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\\{app_name} 
```

并添加一个名为“InstallLocation”的字母数字值，其值是应用程序的主文件夹。

如果您是手动操作（不是在安装期间），为了使其正常工作，您必须删除文件夹：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Management\ARPCache\\{app_name} 
```

因为它缓存了卸载信息。

# silverlight - 使用 Blend 自定义控件

> ID：317648
> 
> 赞同：4
> 
> 时间：2008-11-25T15:09:27.800
> 
> 标签：silverlight, silverlight-2.0

我正在为我的 Silverlight 2 应用程序构建自定义控件。它在一个 SL 类项目中，它包含两个文件：

*   MyControl 类，继承自 Control，几乎没有 DepedencyProperties
*   主题/generic.xaml，带有可视元素 (ControlTemplate)、VSM 状态和转换

我手动创建了整个 xaml，它可以工作，但想使用 Blend2(SP1) 进行编辑！当我在 Blend 中打开 generic.xaml 并切换到资源选项卡时，我没有任何要编辑的内容。
例如，当我将可视化模板和状态定义放入（我的主 SL 项目的）App.xaml 时，我可以通过资源和状态选项卡访问所有元素和状态，并以可视方式对其进行编辑。

Blend 是否支持从 SL2 类项目编辑 generic.xaml？
构建自定义控件的最佳实践是什么？我不希望我的自定义控件依赖于主 SL2 项目中的任何内容，但希望它们是可换肤的，并且能够动态更改皮肤（主题）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T16:34:35.863

您可以使用 Blend 进行编辑。

1.  在 Blend 中打开您的控件项目。
2.  打开您的 generic.xaml
3.  单击资源选项卡
4.  展开 generic.xaml
5.  双击要编辑的样式资源。
6.  在对象和时间线部分，右键单击样式并选择“编辑控制部件 -> 编辑模板”

现在您可以在 generic.xaml 中编辑模板。听起来您已经通过拥有部件和状态来遵循最佳实践。如果您想要完整的最佳实践，请查看[这篇关于如何处理设计时可扩展性的详细文章](http://silverlight.net/blogs/justinangel/archive/2008/11/17/silverlight-design-time-extensibility.aspx)。在那里，您将了解如何为 Silverlight 执行 Visual Studio 和 Blend 设计时的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-27T10:03:24.670

我重新创建了整个项目，突然可以从资源中编辑我的 generic.xaml。但是不能添加 Blend 中声明的消息，因为我必须去 xaml。

# svn - 当使用 svn cp 或 svn mv 时，如何使 svn diff 生成将应用补丁的文件？

> ID：317649
> 
> 赞同：64
> 
> 时间：2008-11-25T15:09:33.133
> 
> 标签：svn, merge, diff, patch

场景是：

1.  svn cp 或 mv 一些文件
2.  修改那个文件
3.  svn diff > mypatch

在其他机器上（相同的工作副本，但没有更改）：

4.  尝试应用 mypatch。
5.  失败 -> 尝试修改不存在的文件。

在这种情况下，如何使 svn diff 产生适用于补丁的补丁，或者干净地应用由 svn diff 产生的补丁？我不能答应。我想保留mergeinfo（因为明显的解决方法是将文件添加为全新的文件，而不连接到前一个文件）。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-11-26T05:41:33.483

使用 subversion，您可以指定要使用的 diff 二进制文件，以及要传递给它的参数。请参阅svn diff[的手册](http://svnbook.red-bean.com/en/1.1/re09.html)。

您希望从 svn diff 生成一个常规补丁文件，因此您希望 svn diff 看起来像一个普通的 diff。尝试这个：

```
svn diff --diff-cmd /usr/bin/diff -x "-i -b" > mypatch
...
patch -p0 < mypatch 
```

概念证明：

```
echo "newline" >> README.txt
svn diff --diff-cmd /usr/bin/diff -x "-i -b" > mypatch
cp README.txt README.txt.patched
svn revert README.txt
patch -p0 < mypatch
diff README.txt README.txt.patched 
```

打补丁后两个文件没有区别。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-04-26T21:06:58.013

如果你想在你的补丁中去掉 svn 属性，有一个选项：

```
svn diff --patch-compatible > mypatch.diff 
```

`svn help diff`说：

```
 --patch-compatible   : generate diff suitable for generic third-party
                         patch tools; currently the same as
                         --show-copies-as-adds --ignore-properties 
```

以这种方式创建的补丁应该与旧的普通`patch`实用程序兼容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-20T20:17:53.907

您是否尝试过[**svn diff**](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.diff.html)网页上`--show-copies-as-adds`提到并在[**svn 选项**](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.html#svn.ref.svn.sw.show_copies_as_adds)页面上描述的选项？[](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.diff.html)**[](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.html#svn.ref.svn.sw.show_copies_as_adds)**

 ***** * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-10T17:24:58.693

在不了解具体情况的情况下，您正在努力确定您为什么要这样做。我感觉您正在尝试在隔离环境中进行受控更改，以避免影响其他用户/应用程序。

你能通过以下方式解决这个问题吗？

*   为您的代码更改创建一个分支
*   在分支上执行复制/移动和更改
*   让对方切换到这个新的代码分支，继续分享这个分支

当您都同意使用 --reintegrate 参数将更改合并回主干并 rm 分支时？

这将 * 维护合并信息 * 识别版本控制中的复制/移动和更改 * 仍将更改与其他用户隔离 * 将防止第 2 步中的不完整更改成为问题，因为您可以添加更多更改和更新

# c# - C#：向用户询问密码，然后将密码存储在 SecureString 中

> ID：317652
> 
> 赞同：7
> 
> 时间：2008-11-25T15:10:21.870
> 
> 标签：c#, .net, passwords, securestring

在我目前正在为客户开发的小型应用程序中，我需要询问用户他的 Windows 登录用户名、密码和域，然后使用**System.Diagnostics.Process.Start**来启动应用程序。

我有一个带有 UseSystemPasswordChar 的文本框来屏蔽输入的密码。

我需要一个**System.Security.SecureString**将密码提供给**System.Diagnostics.Process.Start**。

如何将输入的文本转换为安全字符串，而不是一个接一个地执行？或者：是否有更好的窗口控件来要求用户输入将输入的文本作为 SecureString 返回的密码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-25T15:15:50.720

尝试查看[SecurePasswordTextBox](http://weblogs.asp.net/pglavich/archive/2006/02/26/439077.aspx)自定义控件。您是否正在尝试执行类似于“运行方式”类型命令的操作，在该命令中您尝试以不同于当前登录的用户身份运行该进程？如果没有，您应该可以调用 Process.Start 并让它获取当前用户的凭据。

另外，请查看以下资源：

*   [CredUIPromptForCredentials](http://msdn.microsoft.com/en-us/library/aa375177.aspx)
*   [CredUIPromptForWindowsCredentials](http://msdn.microsoft.com/en-us/library/aa375178(VS.85).aspx)（Vista 和 Server 2008）
*   [微软支持文章](http://support.microsoft.com/kb/180548)
*   [登录用户功能](http://msdn.microsoft.com/en-us/library/aa378184.aspx)
*   [LogonUserEx 函数](http://msdn.microsoft.com/en-us/library/aa378189(VS.85).aspx)
*   [CreateProcessAsUser](http://msdn.microsoft.com/en-us/library/ms682429(VS.85).aspx)
*   [CreateProcessWithLogonW](http://msdn.microsoft.com/en-us/library/ms682431(VS.85).aspx)
*   [CreateProcessWithTokenW](http://msdn.microsoft.com/en-us/library/ms682434(VS.85).aspx)

最好的选择可能是使用一些互操作 p/inovke 代码调用 CredUIPromptForCredentials 以显示标准 Windows 对话框，然后使用该信息调用 Process.Start，或者更有可能调用 CreateProcessAsUser 函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-25T15:15:50.360

SecureString 想要一次接受一个字符的原因是，否则您将在此之前拥有整个字符串并导致字符串在内存中。因此，在这种情况下使用 SecureString 有点违背了目的。

# jquery - jQuery 跨浏览器性能问题

> ID：317676
> 
> 赞同：0
> 
> 时间：2008-11-25T15:16:51.527
> 
> 标签：jquery, cross-browser

我正在结束一个我第一次使用 jQuery 的项目。我喜欢使用该库，并且认为我理解其中一个好处是跨浏览器兼容性。当我开始在 IE6 和 IE7 中测试该站点时，有一个令人不快的惊喜在等着我，因为在许多情况下，JavaScript（不是非常复杂）不起作用。

任何人都可以从跨浏览器的角度对 jQuery 做什么和不做什么提供一些一般性的评论吗？

在 IE 中调试 jQuery/JS 有什么技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T15:22:49.863

我已经看到跨浏览器的行为差异非常非常少。也就是说，只有在您使用 jQuery 时，jQuery 才是好的——一旦您跳出内置事件处理和 DOM 遍历，无论如何您最终都会遇到浏览器不兼容问题。

VS2008 可以很好地在 IE 中调试 JS；如果没有有关您遇到的各种问题的更多信息，我真的无法提出任何其他建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:14:11.887

这里有几个资源给你：

[IE Web Developer Toolbar](http://www.microsoft.com/downloadS/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038) - 这个实用程序不如[Firebug](http://www.getfirebug.com/)强大、有用或可靠，但它至少可以帮助您查看 IE 上呈现的 DOM。此工具适用于 IE6 和 IE7。

[Firebug Lite](http://getfirebug.com/lite.html) - 说到 Firebug，请检查一下。它试图为 IE 重新创建接近 Firebug 的东西，但它完全是通过 javascript 小[书签](http://en.wikipedia.org/wiki/Bookmarklet)完成的。

最后，正如 Shog9 所建议的，Visual Studio 可以成为在 IE 中调试 Javascript 的好方法。有时。由于它速度慢、仅限 Windows 且价格昂贵（对于某些人来说）......我不会很快推荐它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T15:26:08.373

我遇到的唯一 xbrowser 问题是 keyup/press/down

# c# - 为什么 Visual Studio 在调试时会停止？

> ID：317678
> 
> 赞同：4
> 
> 时间：2008-11-25T15:18:36.517
> 
> 标签：c#, .net, visual-studio, debugging

有时，当我调试 ac# 应用程序时，我会遇到断点，当我尝试继续、单步执行或单步执行时，它什么也不做。突出显示当前行的黄线消失了，但它永远不会到达下一行。该应用程序仍然像我在断点上一样冻结，我只能点击停止调试按钮并重新启动。这不会一直发生，但是一旦它在应用程序上启动，它似乎总是在该应用程序之后发生。我发现在类声明之前添加以下代码“修复”了该应用程序的问题，但我很好奇为什么会发生这种情况。

```
[System.Diagnostics.DebuggerDisplay("Form1")]
```

附加细节：我没有注意到关于特定行在冻结时会做什么的任何模式。我编写的大多数应用程序都使用线程，因此很有可能每次都在线程内发生这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T15:55:36.287

我已经看到调试器试图评估自动/本地窗口中显示的变量的停滞问题。如果评估很复杂，则可能会导致严重的停顿。

您可以通过工具|选项关闭自动评估，它确实有很大的不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T14:48:24.347

我遇到过这种行为，虽然这是我第一次。

我通过两种方式解决了这个问题

1.  您放置此属性的方式 [System.Diagnostics.DebuggerDisplay("Form1")]
2.  关闭工具->选项->调试->常规->启用属性评估和其他隐式函数调用。

我仍在调试我的代码，但在我看来，某些 Autos 评估失败（可能引发异常），这可能会使调试器崩溃。

如果您也遇到这种情况，请告诉我们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T15:27:29.480

你在调试什么样的代码？

当您“介入”时，您是在调用自己的 .NET 代码，还是调用本机库，或者是没有 pdb 文件的外部程序集？这些情况中的任何一种都会导致调试器在执行外部代码时冻结。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T15:31:41.560

**如果**您调试多线程应用程序，您可能会更改线程。您可以在调试时使用“线程窗口”在线程之间切换，以便再次看到调试黄线所在的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T15:53:54.433

我的通灵调试器说您缺少某些符号，并且 VS 正在访问网络试图查找它们。尝试将符号路径设置为 C:\foo 之类的奇怪路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T15:57:28.560

在您的情况下，死锁似乎很可能。按下暂停按钮并在下次发生时查看线程视图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-05T17:01:07.560

当我的数据库非常慢时，我已经看到了这种类型的行为，NHibernate 试图在后台对其进行写入，并且当**数据库被 pegged**时，整个调试器被随机锁定。

# java - 分配和格式化的首选选项是什么？

> ID：317679
> 
> 赞同：4
> 
> 时间：2008-11-25T15:19:27.123
> 
> 标签：java, optimization, refactoring, coding-style

考虑到可读性、内存使用和其他原因，推荐使用哪一个？

**1.**

```
String strSomething1 = someObject.getSomeProperties1();
strSomething1 = doSomeValidation(strSomething1);

String strSomething2 = someObject.getSomeProperties2();
strSomething2 = doSomeValidation(strSomething2);

String strSomeResult = strSomething1 + strSomething2;
someObject.setSomeProperties(strSomeResult); 
```

**2.**

```
someObject.setSomeProperties(doSomeValidation(someObject.getSomeProperties1()) + 
                             doSomeValidation(someObject.getSomeProperties2())); 
```

如果你会以其他方式来做，那会是什么？你为什么要那样做？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-25T15:24:02.950

我会去：

```
String strSomething1 = someObject.getSomeProperties1();
String strSomething2 = someObject.getSomeProperties2();

// clean-up spaces
strSomething1 = removeTrailingSpaces(strSomething1);
strSomething2 = removeTrailingSpaces(strSomething2);

someObject.setSomeProperties(strSomething1 + strSomething2); 
```

我个人的偏好是按行动组织，而不是按顺序组织。我认为它只是读起来更好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-25T15:26:42.757

我可能会介于两者之间：

```
String strSomething1 = doSomeValidation(someObject.getSomeProperties1());
String strSomething2 = doSomeValidation(someObject.getSomeProperties2());
someObject.setSomeProperties(strSomething1 + strSomething2); 
```

选项#2 似乎在一行中要做很多事情。它是可读的，但需要一些努力来解析。在选项#1 中，每一行都非常易读且意图清晰，但是当我复习它时，冗长会减慢我的速度。我会尝试平衡上面的简洁性和清晰性，每一行代表一个简单的代码“句子”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T15:27:17.857

我更喜欢第二种。您可以通过一些格式使其具有可读性，而无需声明额外的中间引用。

```
someObject.setSomeProperties(
    doSomeValidation( someObject.getSomeProperties1() ) + 
    doSomeValidation( someObject.getSomeProperties2() )); 
```

您的方法名称提供了所有需要的解释。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-25T15:25:07.550

**选项 2 的可读性**。如果这些方法只执行其名称所指示的操作，我在这里看不到任何内存问题。不过，我会因连接而异。由于 Java 字符串的不变性，性能肯定会随着字符串连接的增加而有所下降。

只是想知道，您真的编写了自己的 removeTrailingSpaces() 方法还是只是一个示例？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T16:37:28.137

我尝试每行进行一次操作。主要原因是这样的：

```
setX(getX().getY()+getA().getB()) 
```

如果你这里有一个 NPE，哪个方法返回 null？所以我喜欢在一些变量中得到中间结果，在代码落入调试器的强大武器之后我可以看到这些结果，而无需重新启动！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T15:28:13.627

对我来说，这取决于上下文和周围的代码。

*[编辑：没有任何意义，抱歉] 如果它是在像“setSomeObjectProperties()”这样的方法中，我更喜欢变体 2，但也许会创建一个私有方法“getProperty(String name)”，如果删除，它会删除尾随空格空格不是重要的操作[/EDIT]*

如果验证属性是您的方法的一个重要步骤，那么我将调用该方法“setValidatedProperties()”，并且更喜欢您的第一个建议的变体：

```
validatedProp1 = doValidation(someObject.getSomeProperty1());
validatedProp2 = doValidation(someObject.getSomeProperty2());
someObject.setSomeProperties(validatedProp1, validatedProp2); 
```

如果验证不是此方法的重要内容（例如返回未验证的属性没有意义），我会尝试将验证步骤放在“getSomePropertyX（）”中

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T15:23:51.903

就个人而言，我更喜欢第二种。它不那么混乱，我不必跟踪那些临时变量。

不过，使用更复杂的表达式可能很容易改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-25T15:54:06.897

我喜欢 Greg 和 Bill 版本，我想我会更自然地编写像 Greg 那样的代码。中间变量的一个优点：更容易调试（在一般情况下）。

# asp.net-mvc - 确定 ViewData 的结果计数

> ID：317684
> 
> 赞同：1
> 
> 时间：2008-11-25T15:22:03.390
> 
> 标签：asp.net-mvc, model-view-controller, viewdata

嗨，我有几个用户控件的视图，我将 ViewData 传递给所有控件，我想知道您将如何通过指定字符串键来确定元​​素计数。我知道您不能使用与整数的比较，因为 ViewData 是一个对象，但我以这种方式设置它来解释我的问题。我也尝试过 null 但 ViewData 对象永远不会为 null，即使对于 ViewData 中没有填充数据的结果也是如此。IE

在我看来

```
 <%if(ViewData["Test"].Values > 0)
      {
    %>
      <%=Html.RenderPartial("~/Views/UC/Test.ascx", ViewData["Test"])%>
   <%
      }
    %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T15:31:15.103

如果我正确理解了您的问题，您希望从 ViewData 中存储的元素中获取计数。实现此目的的唯一方法是将其强制转换为 IEnumerable 或 IList，然后调用 Count 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T15:00:16.990

为了回答我自己的问题，这是我这样做的途径。在我的控制器操作方法中，我根据在那里检索到的记录数来确定计数，如果它不符合我的要求，则将我的 ViewData 设置为 null。

```
public ActionResult Test(){
   var test = //your query;
   if(test.Count() > 0 )
   {
       ViewData["Test"] = test;
   }
} 
```

现在，如果没有检索到任何内容，它会自动将 ViewData["Test"] 设置为 null，并且在您的视图页面中，您可以执行类似的操作。

```
<% if(ViewData["Test"] == null){
      Html.RenderPartial("~/Views/UC/NoRecords.ascx");
   }
   else
   {
      Html.RenderPartial("~/Views/UC/Awesome.ascx");
   }
%> 
```

如果您想添加多个检查，您必须将它们添加到您的控制器中并使用您的视图页面进行比较。可能还有其他方法可以做到这一点，但我发现这很有效。

# java - 如何将属性值注入使用注释配置的 Spring Bean？

> ID：317687
> 
> 赞同：304
> 
> 时间：2008-11-25T15:22:34.747
> 
> 标签：java, spring, dependency-injection

我有一堆 Spring bean，它们是通过注释从类路径中提取的，例如

```
@Repository("personDao")
public class PersonDaoImpl extends AbstractDaoImpl implements PersonDao {
    // Implementation omitted
} 
```

在 Spring XML 文件中，定义了一个[PropertyPlaceholderConfigurer](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html)：

```
<bean id="propertyConfigurer" 
  class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="/WEB-INF/app.properties" />
</bean> 
```

我想将 app.properites 中的属性之一注入到上面显示的 bean 中。我不能简单地做类似的事情

```
<bean class="com.example.PersonDaoImpl">
    <property name="maxResults" value="${results.max}"/>
</bean> 
```

因为 PersonDaoImpl 在 Spring XML 文件中没有特性（它是通过注释从类路径中提取的）。我有以下几点：

```
@Repository("personDao")
public class PersonDaoImpl extends AbstractDaoImpl implements PersonDao {

    @Resource(name = "propertyConfigurer")
    protected void setProperties(PropertyPlaceholderConfigurer ppc) {
    // Now how do I access results.max? 
    }
} 
```

但我不清楚如何访问我感兴趣的属性`ppc`？

* * *

## 回答 #1

> 赞同：299
> 
> 时间：2008-12-04T07:41:12.197

您可以使用 EL 支持在 Spring 3 中执行此操作。例子：

```
@Value("#{systemProperties.databaseName}")
public void setDatabaseName(String dbName) { ... }

@Value("#{strategyBean.databaseKeyGenerator}")
public void setKeyGenerator(KeyGenerator kg) { ... } 
```

`systemProperties`是一个隐式对象并且`strategyBean`是一个 bean 名称。

再举一个例子，当你想从一个`Properties`对象中获取一个属性时它会起作用。它还表明您可以应用于`@Value`字段：

```
@Value("#{myProperties['github.oauth.clientId']}")
private String githubOauthClientId; 
```

这是我写的[一篇博文](https://web.archive.org/web/20170609134527/http://springinpractice.com/2008/12/02/new-stuff-in-spring-30/)，以获取更多信息。

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2011-10-06T14:02:59.783

[就我个人而言，我喜欢文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/new-in-3.html)中 Spring 3.0 中的这种新方式：

```
private @Value("${propertyName}") String propertyField; 
```

没有吸气剂或二传手！

通过配置加载属性：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
      p:location="classpath:propertyFile.properties" name="propertiesBean"/> 
```

为了让我更加高兴，我什至可以控制点击 IntelliJ 中的 EL 表达式，它会将我带到属性定义！

还有完全**非 xml 版本**：

```
@PropertySource("classpath:propertyFile.properties")
public class AppConfig {

    @Bean
    public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderConfigurer() {
        return new PropertySourcesPlaceholderConfigurer();
    } 
```

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2009-07-28T09:05:41.717

*Spring 3.0.0M3*`@Value`中有一个新的注解。不仅支持表达式，还支持占位符*`@Value``#{...}``${...}`*

 ** * *

## 回答 #4

> 赞同：31
> 
> 时间：2012-10-31T15:19:05.967

`<context:property-placeholder ... />`是与 PropertyPlaceholderConfigurer 等效的 XML。

示例：applicationContext.xml

```
<context:property-placeholder location="classpath:test.properties"/> 
```

组件类

```
 private @Value("${propertyName}") String propertyField; 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-11-25T17:25:27.383

另一种选择是添加如下所示的 appProperties bean：

```
<bean id="propertyConfigurer"   
  class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="/WEB-INF/app.properties" />
</bean> 

<bean id="appProperties" 
          class="org.springframework.beans.factory.config.PropertiesFactoryBean">
        <property name="singleton" value="true"/>

        <property name="properties">
                <props>
                        <prop key="results.max">${results.max}</prop>
                </props>
        </property>
</bean> 
```

当被检索到时，这个 bean 可以被强制转换为一个`java.util.Properties`包含一个名为属性的属性，该属性`results.max`的值是从 中读取的`app.properties`。同样，这个 bean 可以通过 @Resource 注解依赖注入（作为 java.util.Properties 的一个实例）到任何类中。

就个人而言，我更喜欢这个解决方案（相对于我提出的另一个解决方案），因为您可以准确限制 appProperties 公开哪些属性，并且不需要读取 app.properties 两次。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-05-21T03:58:00.743

如前所述`@Value`，这项工作非常灵活，因为您可以在其中安装弹簧 EL。

以下是一些示例，可能会有所帮助：

```
//Build and array from comma separated parameters 
//Like currency.codes.list=10,11,12,13
@Value("#{'${currency.codes.list}'.split(',')}") 
private List<String> currencyTypes; 
```

另一个`set`从一个得到一个`list`

```
//If you have a list of some objects like (List<BranchVO>) 
//and the BranchVO has areaCode,cityCode,...
//You can easily make a set or areaCodes as below
@Value("#{BranchList.![areaCode]}") 
private Set<String> areas; 
```

您还可以设置原始类型的值。

```
@Value("${amount.limit}")
private int amountLimit; 
```

您可以调用静态方法：

```
@Value("#{T(foo.bar).isSecurityEnabled()}")
private boolean securityEnabled; 
```

你可以有逻辑

```
@Value("#{T(foo.bar).isSecurityEnabled() ? '${security.logo.path}' : '${default.logo.path}'}")
private String logoPath; 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-11-26T07:19:32.833

我需要有两个属性文件，一个用于生产，一个用于开发（不会部署）。

要同时拥有一个可以自动装配的 Properties Bean 和一个 PropertyConfigurer，您可以编写：

```
<bean id="appProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
    <property name="singleton" value="true" />

    <property name="ignoreResourceNotFound" value="true" />
    <property name="locations">
        <list>
            <value>classpath:live.properties</value>
            <value>classpath:development.properties</value>
        </list>
    </property>
</bean> 
```

并在 PropertyConfigurer 中引用 Properties Bean

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="properties" ref="appProperties" />
</bean> 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-01-09T20:01:27.893

你也可以注释你的类：

```
@PropertySource("classpath:/com/myProject/config/properties/database.properties") 
```

并有一个像这样的变量：

```
@Autowired
private Environment env; 
```

现在您可以通过这种方式访问​​您的所有属性：

```
env.getProperty("database.connection.driver") 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-02-23T11:08:44.650

在我们获得 Spring 3 之前 - 它允许您使用注释将属性常量直接注入到您的 bean 中 - 我编写了 PropertyPlaceholderConfigurer bean 的一个子类，它做同样的事情。因此，您可以标记您的属性设置器，Spring 会将您的属性自动装配到您的 bean 中，如下所示：

```
@Property(key="property.key", defaultValue="default")
public void setProperty(String property) {
    this.property = property;
} 
```

注释如下：

```
@Retention(RetentionPolicy.RUNTIME) 
@Target({ElementType.METHOD, ElementType.FIELD})
public @interface Property {
    String key();
    String defaultValue() default "";
} 
```

PropertyAnnotationAndPlaceholderConfigurer 如下：

```
public class PropertyAnnotationAndPlaceholderConfigurer extends PropertyPlaceholderConfigurer {

    private static Logger log = Logger.getLogger(PropertyAnnotationAndPlaceholderConfigurer.class);

    @Override
    protected void processProperties(ConfigurableListableBeanFactory beanFactory, Properties properties) throws BeansException {
        super.processProperties(beanFactory, properties);

        for (String name : beanFactory.getBeanDefinitionNames()) {
            MutablePropertyValues mpv = beanFactory.getBeanDefinition(name).getPropertyValues();
            Class clazz = beanFactory.getType(name);

            if(log.isDebugEnabled()) log.debug("Configuring properties for bean="+name+"["+clazz+"]");

            if(clazz != null) {
                for (PropertyDescriptor property : BeanUtils.getPropertyDescriptors(clazz)) {
                    Method setter = property.getWriteMethod();
                    Method getter = property.getReadMethod();
                    Property annotation = null;
                    if(setter != null && setter.isAnnotationPresent(Property.class)) {
                        annotation = setter.getAnnotation(Property.class);
                    } else if(setter != null && getter != null && getter.isAnnotationPresent(Property.class)) {
                        annotation = getter.getAnnotation(Property.class);
                    }
                    if(annotation != null) {
                        String value = resolvePlaceholder(annotation.key(), properties, SYSTEM_PROPERTIES_MODE_FALLBACK);
                        if(StringUtils.isEmpty(value)) {
                            value = annotation.defaultValue();
                        }
                        if(StringUtils.isEmpty(value)) {
                            throw new BeanConfigurationException("No such property=["+annotation.key()+"] found in properties.");
                        }
                        if(log.isDebugEnabled()) log.debug("setting property=["+clazz.getName()+"."+property.getName()+"] value=["+annotation.key()+"="+value+"]");
                        mpv.addPropertyValue(property.getName(), value);
                    }
                }

                for(Field field : clazz.getDeclaredFields()) {
                    if(log.isDebugEnabled()) log.debug("examining field=["+clazz.getName()+"."+field.getName()+"]");
                    if(field.isAnnotationPresent(Property.class)) {
                        Property annotation = field.getAnnotation(Property.class);
                        PropertyDescriptor property = BeanUtils.getPropertyDescriptor(clazz, field.getName());

                        if(property.getWriteMethod() == null) {
                            throw new BeanConfigurationException("setter for property=["+clazz.getName()+"."+field.getName()+"] not available.");
                        }

                        Object value = resolvePlaceholder(annotation.key(), properties, SYSTEM_PROPERTIES_MODE_FALLBACK);
                        if(value == null) {
                            value = annotation.defaultValue();
                        }
                        if(value == null) {
                            throw new BeanConfigurationException("No such property=["+annotation.key()+"] found in properties.");
                        }
                        if(log.isDebugEnabled()) log.debug("setting property=["+clazz.getName()+"."+field.getName()+"] value=["+annotation.key()+"="+value+"]");
                        mpv.addPropertyValue(property.getName(), value);
                    }
                }
            }
        }
    }

} 
```

随意修改口味

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2016-10-25T19:56:09.470

弹簧方式：
`private @Value("${propertyName}") String propertyField;`

是一种使用 Spring 的“PropertyPlaceholderConfigurer”类注入值的新方法。另一种方法是调用

```
java.util.Properties props = System.getProperties().getProperty("propertyName"); 
```

注意：@Value 不能使用**静态**属性字段，只能是非静态的，否则返回 null。为了修复它，为静态字段创建了一个非静态设置器，并在该设置器上方应用了@Value。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-11-25T17:22:27.717

一种可能的解决方案是声明从同一属性文件读取的第二个 bean：

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="/WEB-INF/app.properties" />
</bean> 

<util:properties id="appProperties" location="classpath:/WEB-INF/app.properties"/> 
```

名为“appProperties”的 bean 属于 java.util.Properties 类型，可以使用上面显示的 @Resource 属性进行依赖注入。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-12-17T14:28:28.540

如果您在使用 Spring 2.5 时遇到问题，您可以为每个属性定义一个 bean 并使用限定符注入它们。像这样：

```
 <bean id="someFile" class="java.io.File">
    <constructor-arg value="${someFile}"/>
  </bean> 
```

和

```
@Service
public class Thing
      public Thing(@Qualifier("someFile") File someFile) {
... 
```

它不是超级可读的，但它可以完成工作。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-01-02T12:39:35.360

**将属性值自动装配到 Spring Beans 中：**

大多数人都知道您可以使用@Autowired 来告诉Spring 在加载应用程序上下文时将一个对象注入另一个对象。一个鲜为人知的信息块是您还可以使用 @Value 注释将属性文件中的值注入到 bean 的属性中。有关更多信息，请参阅此帖子...

[Spring 3.0 中的新内容](http://springinpractice.com/2008/12/02/new-stuff-in-spring-30/) || [自动装配 bean 值](http://java.dzone.com/articles/autowiring-property-values) || [春季自动装配属性值](http://www.captaindebug.com/2011/10/autowiring-property-values-into-spring_28.html)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-06-18T04:40:00.170

对我来说，这是@Lucky 的回答，特别是这行

```
AutowiredFakaSource fakeDataSource = ctx.getBean(AutowiredFakaSource.class); 
```

从[船长调试页面](http://www.captaindebug.com/2011/10/autowiring-property-values-into-spring_28.html)

这解决了我的问题。我有一个从命令行运行的基于 ApplicationContext 的应用程序，从 SO 上的一些评论来看，Spring 将这些与基于 MVC 的应用程序不同地连接起来。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-10-20T18:31:47.180

我认为将属性注入bean最方便的方法是setter方法。

例子：

```
package org.some.beans;

public class MyBean {
    Long id;
    String name;

    public void setId(Long id) {
        this.id = id;
    }

    public Long getId() {
        return id;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
} 
```

bean xml定义：

```
<bean id="Bean1" class="org.some.beans.MyBean">
    <property name="id" value="1"/>
    <property name="name" value="MyBean"/>
</bean> 
```

对于每个命名的`property`方法`setProperty(value)`都将被调用。

如果您需要基于一种实现的多个 bean，这种方法特别有用。

例如，如果我们在 xml 中再定义一个 bean：

```
<bean id="Bean2" class="org.some.beans.MyBean">
    <property name="id" value="2"/>
    <property name="name" value="EnotherBean"/>
</bean> 
```

然后这样的代码：

```
MyBean b1 = appContext.getBean("Bean1");
System.out.println("Bean id = " + b1.getId() + " name = " + b1.getName());
MyBean b2 = appContext.getBean("Bean2");
System.out.println("Bean id = " + b2.getId() + " name = " + b2.getName()); 
```

将打印

```
Bean id = 1 name = MyBean
Bean id = 2 name = AnotherBean 
```

因此，在您的情况下，它应该如下所示：

```
@Repository("personDao")
public class PersonDaoImpl extends AbstractDaoImpl implements PersonDao {

    Long maxResults;

    public void setMaxResults(Long maxResults) {
        this.maxResults = maxResults;
    }

    // Now use maxResults value in your code, it will be injected on Bean creation
    public void someMethod(Long results) {
        if (results < maxResults) {
            ...
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-03-13T18:05:50.813

如果您需要更多的配置灵活性，请尝试 Settings4jPlaceholderConfigurer： [http ://settings4j.sourceforge.net/currentrelease/configSpringPlaceholder.html](http://settings4j.sourceforge.net/currentrelease/configSpringPlaceholder.html)

在我们的应用程序中，我们使用：

*   配置 PreProd 和 Prod 系统的首选项
*   “mvn jetty:run”的首选项和 JNDI 环境变量（JNDI 覆盖首选项）
*   UnitTests 的系统属性（@BeforeClass 注释）

首先检查 key-value-Source 的默认顺序在：
[http](http://settings4j.sourceforge.net/currentrelease/configDefault.html)
://settings4j.sourceforge.net/currentrelease/configDefault.html 可以使用 settings4j.xml（精确到 log4j.xml）在您的类路径。

让我知道您的意见：settings4j-user@lists.sourceforge.net

亲切的问候，
哈拉尔

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-06-29T08:11:11.607

Spring 5 中最简单的方法是在`@ConfigurationProperties`这里使用示例 [https://mkyong.com/spring-boot/spring-boot-configurationproperties-example/](https://mkyong.com/spring-boot/spring-boot-configurationproperties-example/)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2014-04-19T16:52:27.497

使用 Spring 的“PropertyPlaceholderConfigurer”类

显示属性文件作为 bean 的属性动态读取的简单示例

```
<bean id="placeholderConfig"
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <list>
            <value>/WEB-INF/classes/config_properties/dev/database.properties</value>
        </list>
    </property> 
</bean>

<bean id="devDataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
    <property name="driverClass" value="${dev.app.jdbc.driver}"/>
    <property name="jdbcUrl" value="${dev.app.jdbc.url}"/>
    <property name="user" value="${dev.app.jdbc.username}"/>
    <property name="password" value="${dev.app.jdbc.password}"/>
    <property name="acquireIncrement" value="3"/>
    <property name="minPoolSize" value="5"/>
    <property name="maxPoolSize" value="10"/>
    <property name="maxStatementsPerConnection" value="11000"/>
    <property name="numHelperThreads" value="8"/>
    <property name="idleConnectionTestPeriod" value="300"/>
    <property name="preferredTestQuery" value="SELECT 0"/>
</bean> 
```

属性文件

dev.app.jdbc.driver=com.mysql.jdbc.Driver

dev.app.jdbc.url=jdbc:mysql://localhost:3306/addvertisement

dev.app.jdbc.username=root

dev.app.jdbc.password=root

# xslt - 如何获取元素的位置

> ID：317701
> 
> 赞同：1
> 
> 时间：2008-11-25T15:26:07.780
> 
> 标签：xslt

如何检索当前 Para 的位置？

```
<xsl:template match="Para">
    <xsl:variable name="PositionInDocument" select="What do I do here?" />
</xsl:template> 
```

这是xml文档：

```
<QuestionStem>Question </QuestionStem>
<Para>This is my paragraph question.</Para>
<Para>Thisis another para for question.</Para>
<AnswerListItem>Answer</AnswerListItem>
<Para>This is my answer paragraph</Para>
<Para>This is another answer paragraph</Para>
<SubAnswerBulleted>Sub Answer Bulleted</SubAnswerBulleted>
<Para>This is a paragraph that is part of a sub answer.</Para>
<SubSubAnswerNumbered>Sub Sub Answer Numbered</SubSubAnswerNumbered>
<Para>This is a paragraph that is part of a sub sub answer.</Para>
<SubSubAnswerNumbered>Sub Sub Answer</SubSubAnswerNumbered>
<SubSubAnswerNumbered>Sub Sub Answer</SubSubAnswerNumbered>
<SubAnswerBulleted>Sub Answer Bulleted</SubAnswerBulleted>
<SubAnswerBulleted>Sub Answer</SubAnswerBulleted> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T15:29:12.797

位置（）

看到[这个](http://www.w3schools.com/xpath/xpath_functions.asp#context)

# c++ - C++ 命名空间问题

> ID：317719
> 
> 赞同：17
> 
> 时间：2008-11-25T15:30:49.177
> 
> 标签：c++, namespaces

我正在编写一些不再与公司合作的同事编写的代码，我发现了以下代码：（我在下面删减了）

```
namespace NsA { namespace NsB { namespace NsC {

    namespace { 
        class A { /*etc*/ };
        class B { /*etc*/ };
    }    

    namespace {
        class C { /*etc*/ };
    }
} } } 
```

我不明白第 3 行和第 8 行命名空间命令的目的。
有人可以解释没有名称的命名空间条目的目的是什么吗？
谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-11-25T15:34:25.097

那是一个“匿名命名空间”——它创建了一个隐藏的命名空间名称，保证每个“翻译单元”（即每个 CPP 文件）都是唯一的。

这实际上意味着该命名空间内的所有项目都隐藏在该编译单元之外。它们只能在同一个文件中使用。另请参阅有关未命名命名空间的[这篇文章](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/topic/com.ibm.xlcpp8l.doc/language/ref/unnamed_namespaces.htm)。

# sql - 对于大量记录来说，动态 sql 存储过程是一件坏事吗？

> ID：317725
> 
> 赞同：7
> 
> 时间：2008-11-25T15:33:17.157
> 
> 标签：sql, sql-server, tsql, stored-procedures

我有一个包含近 800,000 条记录的表，我目前正在使用动态 sql 在后端生成查询。前端是一个包含大约 20 个参数的搜索页面，根据是否选择了一个参数，它会在基本查询中添加一个“AND ...”。我很好奇动态 sql 是否是正确的方法（看起来不像，因为它运行缓慢）。我正在考虑用我的所有数据创建一个非规范化表。这是一个好主意还是我应该一起构建查询而不是使用动态 sql 逐个构建它。最后一件事，有没有办法加快动态sql？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T15:36:29.303

与动态 SQL 相比，您的索引（或缺少索引）更有可能导致速度缓慢。

执行计划是什么样的？在 SSMS 中执行相同的查询是否很慢？当它在存储过程中时呢？

如果你的表是一个未索引的堆，它会随着记录数量的增长而表现不佳——这与查询无关，而动态查询实际上可以随着表性质的变化而表现得更好，因为动态查询更有可能有它的查询计划不在缓存中时重新评估。这通常不是问题（我不会将其归类为动态查询的设计优势），除非在系统的早期阶段 SP 尚未重新编译，但统计信息和查询计划已过时，但数据刚刚发生了翻天覆地的变化。

还不是静态的。我有动态查询，但它没有提供任何优化。如果我用静态查询运行它并给出建议，应用它们会影响动态查询吗？– Xaisoft（41 分钟前）

是的，除非您分析了工作负载文件，否则可能不会分析动态查询（EXEC (@sql)）。– Cade Roux（33 分钟前）

当您在连接的多个表中进行搜索查询时，具有索引的列需要是搜索列以及主键/外键列 - 但这取决于各个表的基数。调谐分析器应该显示这一点。– Cade Roux（22 分钟前）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-25T17:36:06.707

我只想指出，如果您使用这种可选参数样式：

```
AND (@EarliestDate is Null OR PublishedDate < @EarliestDate) 
```

查询优化器在生成查询计划时不知道参数是否存在。我见过优化器在这些情况下做出错误选择的情况。更好的解决方案是构建只使用您需要的参数的 sql。在这些情况下，优化器将制定最有效的执行计划。请务必使用参数化查询，以便它们在计划缓存中可重用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-25T15:47:32.900

作为先前的答案，请检查您的索引和计划。

问题是您是否使用存储过程。从你的措辞来看并不明显。存储过程在运行时会创建一个查询计划，并保留该计划直到重新编译。使用不同的 SQL，您可能会遇到错误的查询计划。你可以做几件事：

1）将 WITH RECOMPILE 添加到 SP 定义中，这将导致每次执行都会生成一个新计划。这包括一些开销，这可能是可以接受的。

2) 根据提供的参数，使用单独的 SP。这将允许更好的查询计划缓存

3) 使用客户端生成的 SQL。这将每次创建一个查询计划。如果您使用参数化查询，这可能允许您使用缓存的查询计划。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T15:39:56.083

“动态”和“静态”SQL 之间的唯一区别是解析/优化阶段。完成这些操作后，查询将以相同的方式运行。

对于简单的查询，这个解析阶段加上网络流量占总事务时间的很大一部分，因此最好尝试减少这些时间。

但是对于大而复杂的查询，与优化器选择的实际路径相比，这种处理总体上是微不足道的。

我将专注于优化查询本身，如果您认为合适的话，可能包括非规范化，尽管我不会在第一次自己动手时这样做。

例如，有时可以在应用程序的“运行时”使用缓存的查找表来完成非规范化，而不是在数据库中维护它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T17:59:23.620

不是动态 Sql 的粉丝，但如果你坚持使用它，你可能应该阅读这篇文章： http: [//www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html) 他真的深入探讨了使用动态 SQL 的最佳方法和问题使用它可以创建。

正如其他人所说，索引是最有可能的罪魁祸首。在索引中，人们经常忘记做的一件事是在 FK 字段上放置索引。由于 PK 会自动创建索引，因此许多人认为 FK 也会这样做。不幸的是，创建 FK 不会创建索引。因此，请确保您加入的任何字段都已编入索引。

可能有更好的方法来创建您的动态 SQL，但是如果没有看到代码就很难说。我至少会看看它是否正在使用子查询并将它们替换为派生表连接。此外，任何使用游标的动态 SQl 都会很慢。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T15:39:13.963

如果参数是可选的，那么经常使用的一个技巧是创建这样的过程：

```
CREATE PROCEDURE GetArticlesByAuthor (
    @AuthorId int,
    @EarliestDate datetime = Null )
AS
   SELECT  * --not in production code!
   FROM Articles
   WHERE AuthorId = @AuthorId
   AND (@EarliestDate is Null OR PublishedDate < @EarliestDate) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T15:56:44.023

这里有一些很好的带有可选搜索条件的查询示例：[如何创建一个可以选择搜索列的存储过程？](https://stackoverflow.com/questions/205526/how-do-i-create-a-stored-procedure-that-will-optionally-search-columns)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-25T17:06:00.840

如前所述，如果您正在执行大规模查询，索引是首先要查看的瓶颈。确保对大量查询的列进行索引。此外，请确保您的查询在检查未索引参数之前检查所有索引参数。这确保了首先使用索引过滤结果，然后仅在必要时才进行慢速线性搜索。因此，如果 col2 已编入索引但 col1 未编入索引，则应如下所示：

```
WHERE col2 = @col2 AND col1 = @col1 
```

您可能也想过度使用索引，但请记住，过多的索引会导致写入缓慢和大量磁盘使用，所以不要太疯狂。

如果可以的话，我会避免动态查询，原因有二。一，他们不保存查询计划，因此每次都会编译语句。另一个是它们难以操纵、测试和排除故障。（他们只是看起来很丑）。

我喜欢上面[戴夫坎普的回答](https://stackoverflow.com/questions/317725/is-a-dynamic-sql-stored-procedure-a-bad-thing-for-lots-of-records#317744)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-21T17:44:30.690

我通过以下逻辑取得了一些成功（在有限的情况下）：

```
CREATE PROCEDURE GetArticlesByAuthor (    
    @AuthorId int,    
    @EarliestDate datetime = Null 
    ) AS   

SELECT SomeColumn
FROM Articles   
WHERE AuthorId = @AuthorId   
AND @EarliestDate is Null
UNION
SELECT SomeColumn
FROM Articles   
WHERE AuthorId = @AuthorId   
AND PublishedDate < @EarliestDate 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-12-13T02:40:22.693

如果您尝试优化到低于 1s 的范围，那么估计解析和编译动态 sql 相对于实际查询执行时间所需的大致时间可能很重要：

```
 SET STATISTICS TIME ON; 
```

然后“静态”执行动态 SQL 字符串并检查“消息”选项卡。我对从 1M 行表中返回两行的 ~10 行动态 sql 查询的这些结果感到惊讶：

```
 SQL Server parse and compile time: 
    CPU time = 199 ms, elapsed time = 199 ms.

 (2 row(s) affected)

 SQL Server Execution Times:
     CPU time = 0 ms,  elapsed time = 4 ms. 
```

索引优化无疑会大大移动 199 毫秒的障碍（可能由于编译时间中包含的一些分析/优化除外）。

但是，如果动态 SQL 使用参数或重复，则编译结果可能会根据以下内容进行缓存：[请参阅缓存查询计划](http://www.sommarskog.se/dynamic_sql.html)，这将消除编译时间。知道缓存条目的生存时间、大小、会话之间共享的时间等会很有趣。

# hardware - CUDA 或 FPGA 用于特殊用途的 3D 图形计算？

> ID：317731
> 
> 赞同：57
> 
> 时间：2008-11-25T15:35:10.070
> 
> 标签：hardware, cuda, fpga

我正在开发一种具有大量 3D 图形计算的产品，**在很大程度上是最近点和范围搜索**。一些硬件优化会很有用。虽然我对此知之甚少，但我的老板（没有软件经验）提倡 FPGA（因为它可以定制），而我们的初级开发人员则提倡 GPGPU 和 CUDA，因为它便宜、热门和开放。虽然我觉得我对这个问题缺乏判断力，但我相信 CUDA 是要走的路，也是因为我担心灵活性，我们的产品仍在强劲发展中。

那么，换个说法，是否有任何理由选择 FPGA？还是有第三种选择？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-02T13:26:35.337

我们在 FPGA 和 CUDA 之间做了一些比较。如果您可以真正以 SIMD 方式制定问题并且可以访问合并的内存，那么 CUDA 会大放异彩。如果内存访问未合并 (1) 或者如果您在不同线程中具有不同的控制流，则 GPU 可能会大幅降低其性能，而 FPGA 可能会超越它。另一件事是当您的操作非常小，但您拥有大量操作时。但是你不能（例如由于同步）没有在一个内核的循环中启动它，那么你对 GPU 内核的调用时间就会超过计算时间。

此外，FPGA 的功能可能会更好（取决于您的应用场景，即 GPU 仅在其一直在计算时更便宜（以瓦特/触发器而言））。

当然 FPGA 也有一些缺点：IO 可以是一个（我们这里有一个应用程序，我们需要 70 GB/s，GPU 没问题，但是要将这么多的数据输入 FPGA，对于传统设计，您需要比可用引脚更多的引脚）。另一个缺点是时间和金钱。FPGA 比最好的 GPU 贵得多，而且开发时间非常长。

(1) 从不同线程同时访问内存必须是顺序地址。这有时真的很难实现。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-11-25T15:48:27.313

我不久前调查了同样的问题。在与从事 FPGA 工作的人聊天后，我得到了以下信息：

*   FPGA 非常适合实时系统，即使是 1ms 的延迟也可能太长。这不适用于您的情况；
*   FPGA 可以非常快，尤其是用于定义明确的数字信号处理用途（例如雷达数据），但好的FPGA 甚至比专业的 GPGPU 更昂贵和专业；
*   FPGA 的编程非常麻烦。由于需要编译硬件配置组件，因此可能需要数小时。它似乎更适合电子工程师（通常是从事 FPGA 工作的人）而不是软件开发人员。

如果你能让 CUDA 为你工作，那它可能是目前最好的选择。它肯定会比 FPGA 更灵活。

其他选项包括来自 ATI 的 Brook，但在发生大事之前，它的采用率不如 CUDA。在那之后，仍然有所有传统的 HPC 选项（x86/PowerPC/Cell 集群），但它们都相当昂贵。

希望有帮助。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-11-25T16:20:56.047

我会选择CUDA。
我从事图像处理工作，多年来一直在尝试硬件附加组件。首先我们有 i860，然后是 Transputer，然后是 DSP，然后是 FPGA 和直接编译到硬件。
不可避免的情况是，当硬件板真正调试并可靠并且代码已经移植到它们时 - 常规 CPU 已经先进到击败它们，或者主机架构发生了变化，我们无法使用旧板，或者董事会的制造商破产了。

通过坚持使用 CUDA 之类的东西，您不会被束缚在一个小型的 FPGA 板专业制造商身上。GPU 的性能比 CPU 提高得更快，并且由游戏玩家资助。这是一项主流技术，因此将来可能会与多核 CPU 合并，从而保护您的投资。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-02-21T17:26:38.787

# FPGA

*   你需要什么：
    *   学习 VHDL/Verilog（相信我你不想）
    *   购买硬件进行测试，购买合成工具的许可证
    *   如果您已经拥有基础设施并且只需要开发您的核心
        *   开发设计（可能需要数年时间）
    *   如果您不这样做：
        *   DMA、硬件驱动程序、超昂贵的综合工具
        *   大量关于总线、内存映射、硬件合成的知识
        *   构建硬件，购买 IP 内核
        *   开发设计
        *   更不用说开发板了
*   例如，带有芯片 Xilinx ZynqUS+ 的平均 FPGA pcie 卡成本超过 3000 美元
*   FPGA 云也很昂贵 2$/h+
*   结果：
    *   这至少需要运营公司的资源。

# GPGPU (CUDA/OpenCL)

*   你已经有了要测试的硬件。
*   与FPGA的东西比较：
    *   一切都有据可查。
    *   一切都很便宜
    *   一切正常
    *   一切都很好地集成到编程语言中
*   还有GPU云。
*   结果：
    *   你只需要下载 sdk 就可以开始了。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-05-05T19:49:57.873

这是一个始于 2008 年的旧线程，但最好回顾一下 FPGA 编程从那时起发生的事情： 1\. FPGA 中的 C 到门是许多公司的主流开发，与 Verilog/SystemVerilog HDL 相比，它节省了大量时间。在 C to gates 中，系统级设计是困难的部分。2\. FPGA 上的 OpenCL 已存在 4 年以上，包括 Microsoft (Asure) 和 Amazon F1 (Ryft API) 的浮点和“云”部署。使用 OpenCL 系统设计相对容易，因为在主机和计算设备之间定义了非常好的内存模型和 API。

软件人员只需要了解一些关于 FPGA 架构的知识，就能够完成 GPU 和 CPU 甚至无法完成的事情，因为它们都是固定硅片并且没有与外界连接的宽带 (100Gb+) 接口。不再可能缩小芯片几何尺寸，也无法在不熔化的情况下从单芯片封装中提取更多热量，因此这看起来像是单封装芯片之路的尽头。我的论点是，未来属于多芯片系统的并行编程，FPGA 有很大的机会领先于游戏。如果您对性能等有疑虑，请查看[http://isfpga.org/ 。](http://isfpga.org/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-24T06:54:06.517

基于 FPGA 的解决方案可能比 CUDA 贵得多。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-08-15T14:42:16.457

显然这是一个复杂的问题。问题还可能包括单元处理器。对于其他相关问题，可能没有一个答案是正确的。

以我的经验，任何以抽象方式完成的实现，即编译的高级语言与机器级实现，都不可避免地会产生性能成本，尤其是在复杂的算法实现中。FPGA 和任何类型的处理器都是如此。专为实现复杂算法而设计的 FPGA 将比其处理元件通用的 FPGA 性能更好，从而使其在输入控制寄存器、数据 I/O 等方面具有一定程度的可编程性。

另一个 FPGA 性能更高的一般示例是在级联进程中，其中进程的输出成为另一个进程的输入，并且它们不能同时完成。FPGA 中的级联进程很简单，并且可以显着降低内存 I/O 要求，而处理器内存将用于有效地级联两个或多个存在数据依赖关系的进程。

GPU和CPU也是如此。在不考虑高速缓存存储器或主存储器系统的固有性能特征的情况下，在 CPU 上执行以 C 语言实现的算法将不会像已实现的那样执行。当然，不考虑这些性能特征会简化实施。但是以性能为代价。

没有直接使用 GPU 的经验，但知道其固有的内存系统性能问题，它也会受到性能问题的影响。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-25T16:02:26.100

CUDA 有一个相当丰富的示例代码库和一个[SDK](http://www.nvidia.com/object/cuda_sdks.html)，包括[一个 BLAS 后端](http://www.nvidia.com/content/cudazone/cuda_sdk/Linear_Algebra.html)。尝试找到一些与您正在做的事情相似的示例，也许还可以查看[GPU Gems](http://www.amazon.com/s/ref=nb_ss_gw?url=search-alias%3Daps&field-keywords=gpu+gems&x=0&y=0)系列书籍，以衡量 CUDA 与您的应用程序的匹配程度。我想说的是，从逻辑的角度来看，CUDA 比任何专业的 FPGA 开发工具包更容易使用，而且便宜得多。

有一次，我确实研究了 CUDA 以进行索赔准备金模拟建模。有相当多的系列讲座链接到网站上供学习。在 Windows 上，您需要确保 CUDA 在没有显示器的卡上运行，因为图形子系统有一个看门狗计时器，它可以对运行超过 5 秒的任何进程进行核对。这在 Linux 上不会发生。

任何带有两个 PCI-e x16 插槽的机器都应该支持这一点。我用的是 HP XW9300，你可以很便宜地从 ebay 上买到它。如果这样做，请确保它有两个 CPU（不是一个双核 CPU），因为 PCI-e 插槽位于单独的 Hypertransport 总线上，并且您需要机器中有两个 CPU 才能使两条总线都处于活动状态。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-10-21T20:26:57.990

你在部署什么？你的客户是谁？在不知道这些问题的答案的情况下，我不会使用 FPGA，除非你正在构建一个实时系统，并且你的团队中有电气/计算机工程师了解硬件描述语言，例如 VHDL 和 Verilog。它有很多东西，它需要与传统编程不同的思维框架。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-11-20T12:47:34.693

我是一名 CUDA 开发人员，在 FPGA:s 方面拥有非常少的经验，但是我一直在尝试找到两者之间的比较。

到目前为止，我得出的结论是：

GPU 具有更高的（可访问的）峰值性能它具有更有利的 FLOP/watt 比率。它更便宜它发展得更快（很快你就会真正拥有一个“真正的”TFLOP 可用）。编程更容易（阅读有关此非个人观点的文章）

请注意，我说的是真实/可访问，以区别于您将在 GPGPU 广告中看到的数字。

但是当您需要对数据进行随机访问时，gpu 并不是更有利。这有望随着具有可选 l1/l2 缓存的新 Nvidia Fermi 架构而改变。

我的 2 美分

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-06-10T19:16:39.983

其他人给出了很好的答案，只是想添加一个不同的观点。这是我在 ACM Computing Surveys 2015 上发表的调查[论文](https://www.academia.edu/6644474/A_Survey_of_Methods_For_Analyzing_and_Improving_GPU_Energy_Efficiency)（其永久链接在[这里](http://dl.acm.org/citation.cfm?doid=2658850.2636342)），它比较了 GPU 与 FPGA 和 CPU 的能效指标。大多数论文报告：FPGA 比 GPU 更节能，而 GPU 又比 CPU 更节能。由于功率预算是固定的（取决于冷却能力），FPGA 的能源效率意味着可以在相同的功率预算内使用 FPGA 进行更多的计算，因此使用 FPGA 可以获得比使用 GPU 更好的性能。当然，正如其他人所提到的，还要考虑 FPGA 的限制。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-07-20T01:44:16.013

FPGA 不会受到那些有软件偏见的人的青睐，因为他们需要学习 HDL 或至少了解 systemC。

对于那些有硬件偏见的人来说，FPGA 将是第一个考虑的选项。

实际上，两者都需要牢牢把握，然后才能做出客观的决定。

OpenCL 旨在同时在 FPGA 和 GPU 上运行，甚至 CUDA 也可以移植到 FPGA。

FPGA 和 GPU 加速器可以一起使用

因此，这不是一个更好或另一个更好的情况。还有关于 CUDA 与 OpenCL 的争论

同样，除非您针对您的特定应用程序进行了优化和基准测试，否则您无法 100% 确定地知道。

由于其商业性质和资源，许多人会选择 CUDA。其他人会选择 openCL，因为它的多功能性。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-01-25T16:44:16.547

*   FPGA 的并行性比 GPU 高三个数量级。虽然好的 GPU 具有数千个内核，但 FPGA 可能有数百万个可编程门。
*   虽然 CUDA 内核必须进行高度相似的计算才能提高生产力，但 FPGA 单元是真正相互独立的。
*   FPGA 可以非常快地处理某些任务组，并且通常用于毫秒已经被视为很长持续时间的情况。
*   GPU 内核比 FPGA 单元更强大，并且更容易编程。它是一个核心，当FPGA单元只能进行相当简单的布尔逻辑时，可以进行除法和乘法运算。
*   由于 GPU 内核是一个*内核*，因此用 C++ 对其进行编程是高效的。即使也可以用 C++ 对 FPGA 进行编程，但效率低下（只是“生产性”）。必须使用诸如 VDHL 或 Verilog 之类的专业语言——它们很难掌握并且具有挑战性。
*   软件工程师的大部分真实和经过尝试的直觉对于 FPGA 都毫无用处。你想要一个带有这些门的*for 循环吗？*你来自哪个星系？您需要转变为电子工程师的思维方式才能了解这个世界。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-03-23T02:15:39.013

在最近的 GTC'13 上，许多 HPC 人都同意 CUDA 将继续存在。FGPA 很麻烦，CUDA 越来越成熟，支持 Python/C/C++/ARM.. 不管怎样，这是一个过时的问题

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2018-04-10T12:12:56.930

在 CUDA 中编程 GPU 绝对更容易。如果您没有任何使用 HDL 编程 FPGA 的经验，那几乎肯定对您来说是一个太大的挑战，但是您仍然可以使用类似于 CUDA 的 OpenCL 对它们进行编程。然而，它比编程 GPU 更难实现，而且可能更昂贵。

**哪个更快？**

GPU 运行速度更快，但 FPGA 可以更高效。

GPU 具有以高于 FPGA 所能达到的速度运行的潜力。但仅适用于特别适合的算法。如果算法不是最优的，GPU 会损失很多性能。

另一方面，FPGA 运行速度要慢得多，但您可以实现特定于问题的硬件，这将非常高效并在更短的时间内完成工作。

这有点像用叉子快速吃汤而不是用勺子慢慢吃汤。

两种设备的性能都基于并行化，但各自的方式略有不同。如果算法可以细化成许多块执行相同的操作（关键字：SIMD），GPU 会更快。如果算法可以实现为长流水线，FPGA 会更快。另外，如果你想使用浮点，FPGA 不会很满意 :)

我已经将我的整个硕士论文都献给了这个主题。 [使用 OpenCL 在 FPGA 上进行算法加速](https://tumde-my.sharepoint.com/:b:/g/personal/jure_zdovc_tum_de/EQJ7I01Sbs5Hn1SeDm4Fd9IBmZ5zxSB5UedGFucxVspl-g?e=XSGjkE)

# bash - 试图在 bash shell 中捕获 javac 输出

> ID：317733
> 
> 赞同：11
> 
> 时间：2008-11-25T15:35:22.787
> 
> 标签：bash, shell, javac

我正在尝试将 java 编译器输出重定向到文件。我以为应该是：

```
javac file.java > log.txt 
```

或者其他的东西。相反，我在终端上看到了所有输出，而 log.txt 中什么也没有！

另外，如果我也想记录错误，我会这样做吗

```
javac file.java 2>&1 > log.txt 
```

?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-25T15:41:53.193

```
javac file.java 2> log.txt 
```

原因是您有*两个*输出文件描述符而不是一个。通常的一个是标准输出，您可以使用 > 重定向它，它应该用于结果输出。第二个，stderr，用于人类可读的输出，如警告、错误、当前状态等，这个用 2> 重定向。

您的第二行使用 2>&1 将 stderr 重定向到 stdout，最后将 stdout 重定向到 log.txt。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-25T15:42:17.500

你有没有尝试过

```
javac -Xstdout log.txt file.java 
```

这会将编译器错误发送到日志文件而不是 stderr。

# c# - 在 UserControl 中使用 Label 或 DrawString

> ID：317736
> 
> 赞同：1
> 
> 时间：2008-11-25T15:37:38.757
> 
> 标签：c#, winforms, user-controls

我正在编写自己的控件，该控件将包含一个带有文本、图像和其他媒体的面板。渲染文本和图像的最佳方式是什么。该控件可能包含长文本和许多图像。
我应该将文本添加为​​标签，将图像添加为 PictureBox，还是应该使用 DrawString 和 DrawImage 方法来呈现文本和图像？
最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T15:42:11.103

如果您使用标签，那么您将免费获得所有标签上的好处。

如果您使用 DrawString，那么它可能会（一点点）更快，但如果您需要处理诸如文本更改之类的事情，它会复杂得多。

OnPaint 处理程序编写起来总是很棘手，而且要有效地使客户区无效也很棘手。

为什么不让标签为您处理这一切？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T15:53:32.797

我会使用 DrawString 和 DrawImage - 您需要担心的资源较少，但会增加复杂性。

一旦你进入它，我认为绘制你自己的字符串和图像并没有那么糟糕。

这是一个很好的介绍：

[https://web.archive.org/web/20150116060854/http://bobpowell.net/](https://web.archive.org/web/20150116060854/http://bobpowell.net/)

# prolog - prolog递归查找最大节点

> ID：317740
> 
> 赞同：1
> 
> 时间：2008-11-25T15:38:13.763
> 
> 标签：prolog, binary-tree

只是一个简单的二叉树，我想找到最大的节点。
示例树：t(t(t(nil,1,nil),2,t(nil,3,nil)),4,t(t(t(nil,8,nil),5,nil),6, t(nil,7,nil)))

```
int L(t,max) {
if(t=null) return max;
if(max<t.root) max = t.root;
LN(t,max);
RN(t,max);
return max;
}
L(tree,tree.root); 
```

我只是不能把它应用到序言中。在这里我显示每个节点。我得到了，但我不明白如何保存最大值并递归地保持它。

```
tree(nil).
tree(t(L,Root,R)) :- 
    tree(L),
    tree(R), 
    write(Root). 
```

编辑：它检查所有叶节点，但忽略 t(nil,8,nil)

```
tree(nil,0).
tree(t(nil,Q,nil),Q) :- !.
tree(t(nil,Q,_),Q).
tree(t(_,Q,nil),Q).
tree(t(L,_,R),Max) :- 
    tree(L, LValue),
    tree(R, RValue), 
    max(LValue,RValue,Max). 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T20:56:58.720

这是[另一个家庭作业](https://stackoverflow.com/questions/315944/prolog-problem-with-recursion)吗？

无论如何，我会尽量让你思考，因为你似乎正在学习 Prolog。更不用说我实际上并没有在我的计算机上运行 Prolog，所以我不能确定我建议的解决方案是否真的有效。

5 是唯一一个只有一个子节点的节点（即它忽略的 8）这一事实应该告诉你一些事情。所有其他节点要么是叶节点，要么有两个子节点。

你认为这两条规则到底是做什么的？

```
tree(t(nil,Q,_),Q).
tree(t(_,Q,nil),Q). 
```

# xslt - 如何选择以下兄弟的位置

> ID：317741
> 
> 赞同：1
> 
> 时间：2008-11-25T15:38:30.877
> 
> 标签：xslt

我需要通过 XSL 选择下一个兄弟的位置。

这不起作用：

```
<xsl:variable name="nextAnswerListItemPos" select="following-sibling::*[local-name() = 'AnswerListItem'][position()]" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T15:48:04.290

```
<xsl:variable name="nextAnswerListItemPos" select="count(following-sibling::*[local-name() = 'AnswerListItem'][1]/preceding-sibling::*) + 1" /> 
```

# pdf - SSRS 报告适合 PDF

> ID：317743
> 
> 赞同：6
> 
> 时间：2008-11-25T15:38:57.897
> 
> 标签：pdf, reporting-services, report

使 SSRS 报告适合 PDF 页面的最佳方法是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-27T15:10:43.163

下次请说明您正在使用的 SSRS 版本...

如果您小心地将画布设计为某些约束，那么您应该没问题。通常，PDF 将模拟 8.5" x 11" 的纸张 - 考虑到边距，您应该将报告的宽度保持在 7" 以下，但我认为 6.5" 是最好的。

您可以通过选择报告本身来执行此操作，BIDS (VS) 中的菜单现在应该有一个报告项目，您可以选择它来显示报告属性。在报告属性中，您可以选择方向以及标准纸张尺寸和边距。根据您的纸张大小和左右边距，您应该能够计算出报告正文的最大宽度。回到报表设计器中，选择报表正文并查看属性。对象下拉列表应该具体说 BODY，在此您要确保您的主体的大小（宽度）不大于报告宽度减去边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-14T12:33:39.480

```
For PDF you have to change page settings while creating report check below steps for that :

if you have large data on page you should choose below option
->Right Click on report 
->Click on Page Setup option
->Change page orientation Portrait to Landscape
->Click on OK

if you don't have large data on page you should reduce size of your table on report design page and change below setting:

->Right Click on report 
->Click on Page Setup option
->Change page orientation Landscape to Portrait
->Click on OK

Now check PDF file. 
```

# c# - 将母版页表单数据传递到另一个 Web 表单

> ID：317749
> 
> 赞同：1
> 
> 时间：2008-11-25T15:40:29.750
> 
> 标签：c#, asp.net, forms, master-pages

我有一个母版页，上面有一个表格。这是一个必须始终可见的搜索表单。单击该表单的按钮时，我希望将表单数据发送到 search.aspx。问题是，我不知道怎么做。我无法将表单操作设置为 search.aspx，因为使用主表单的所有其他页面都将转到 search.aspx。这是我不想要的。

希望有人可以帮助我:)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T15:45:13.047

您可以在单独的表单中创建您的搜索表单，并让它使用 GET 而不是 POST。

要么，要么让主表单处理搜索按钮单击并使用 Server.Transfer 转到搜索表单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T15:45:24.747

我相信你可以在一页中有多个表格。因此，一个表单（您的搜索表单）将其操作设置为 search.aspx，而另一个表单将设置为页面本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T16:21:53.113

为了传递控件“txtSearch”的值，当执行 Server.Transfer 时，您可以做很多事情，包括通过查询字符串变量传递它或设置会话变量，然后在 Page_Load 事件中检查其中任何一个Search.aspx，如果已填充，则调用当用户点击 Search.aspx 页面上的提交按钮时触发的事件。

此外，如果 Search.aspx 文件使用相同的母版页，那么您可以使用 this.Master.FindControl("txtSearch") 来获取控件（在浏览器中生成文件后，您可以查看文件的来源，您会注意到母版页中的控件实际上并不是由它们的 ID 调用的，而是附加了一些东西（即现在可能称为“ctl00_txtSearch”）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T16:20:42.443

ASP.NET Web 表单页面只有一个表单（通常包含在母版页中）。您可以将搜索按钮的回发网址设置到您的搜索页面。

```
<asp:Button ID="btnSearch" runat="server" Text="Search" PostBackUrl="~/search.aspx" /> 
```

..或者只是从母版页中的处理程序重定向到它，如下所示：

```
protected void btnSearch_Click(object sender, EventArgs e)
{
    Response.Redirect(@"~/search.aspx?q=" + Server.UrlEncode(txtSearch.Text)); 
} 
```

..或按照 David Kemp 的建议使用 Server.Transfer。

**注意：**如果您在搜索页面上使用 Request.Query[@"q"] 来获取查询，则不需要使用 Server.UrlDecode() - 它已经为您完成了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T16:29:26.483

我会：

*   向母版页代码隐藏添加一些代码以检测 POST 的来源。
*   一旦我有了 POST 的来源（例如搜索框）。然后我会将其查询传递给搜索表单。

我使用了类似的过程，在母版页上有一个 HTML 登录表单。

[我在这里](https://stackoverflow.com/questions/178396/form-elements-in-aspnet-master-pages-and-content-pages)发布了一个问题和后续解决方案- 看看：

[ASP.NET 母版页和内容页中的表单元素](https://stackoverflow.com/questions/178396/form-elements-in-aspnet-master-pages-and-content-pages)

一旦我了解它，它似乎是一个非常简单且相当优雅的解决方案。

这样做的好处是您可以完全控制如何将数据发送到搜索表单。而且您不需要启用将表单数据传输到搜索表单和所有讨厌的东西，只需向搜索页面创建一个新的 GET 请求并让它做它应该做的事情:)

希望这可以帮助。

### 笔记：

`runat="server"`一个 ASPX 页面上只能有一个表单。**其他表单必须是 HTML 表单**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T18:34:58.320

因为您的搜索表单位于母版页中，所以您可以将其构建为包含 2 个表单。将操作设置为“search.aspx”的搜索表单标记放置在站点其余部分使用的标记之外。

```
<body>
    <form action="search.aspx>
        <!--search box and submit button-->
    </form>
    <form runat="server">
        <!--rest of page inc placeholder-->
    </form>
</body> 
```

如果页面结构无法启用此功能，您可以将提交按钮的 PosbackUrl 设置为指向“search.aspx”。在这种情况下，需要对“search.aspx”进行编码以在 PreviousPage 属性中查找表单数据，或者使用 Request.Form 访问输入。

# c# - 为什么我的 .NET 组件上的索引器并不总是可以从 VBScript 访问？

> ID：317759
> 
> 赞同：7
> 
> 时间：2008-11-25T15:42:49.930
> 
> 标签：c#, .net, vbscript, com-interop

我有一个 .NET 程序集，我通过 COM 互操作从 VBScript（经典 ASP）访问它。一个类有一个索引器（也称为默认属性），我通过向索引器添加以下属性从 VBScript 中得到它：`[DispId(0)]`. 它在大多数情况下都有效，但在作为另一个对象的成员访问该类时无效。

我怎样才能让它使用以下语法：`Parent.Member("key")`其中 Member 有索引器（类似于访问内置`Request.QueryString`:的默认属性`Request.QueryString("key")`）？

在我的例子中，有一个父类`TestRequest`的`QueryString`属性返回一个`IRequestDictionary`，它具有默认索引器。

VBScript 示例：

```
Dim testRequest, testQueryString
Set testRequest = Server.CreateObject("AspObjects.TestRequest")
Set testQueryString = testRequest.QueryString
testQueryString("key") = "value" 
```

以下行导致错误而不是打印“值”。这是我想要使用的语法：

```
Response.Write(testRequest.QueryString("key")) 
```

> Microsoft VBScript 运行时 (0x800A01C2)
> 参数数量错误或属性分配无效：“QueryString”

但是，以下行*确实可以*正常工作并输出预期的“值”（请注意，第一行访问临时变量上的默认索引器）：

```
Response.Write(testQueryString("key"))
Response.Write(testRequest.QueryString.Item("key")) 
```

下面是 C# 2.0 中的简化接口和类。他们已通过以下方式注册`RegAsm.exe /path/to/AspObjects.dll /codebase /tlb`：

```
[InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
public interface IRequest {
    IRequestDictionary QueryString { get; }
}

[ClassInterface(ClassInterfaceType.None)]
public class TestRequest : IRequest {
    private IRequestDictionary _queryString = new RequestDictionary();

    public IRequestDictionary QueryString {
        get { return _queryString; }
    }
}

[InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
public interface IRequestDictionary : IEnumerable {
    [DispId(0)]
    object this[object key] {
        [DispId(0)] get;
        [DispId(0)] set;
    }
}

[ClassInterface(ClassInterfaceType.None)]
public class RequestDictionary : IRequestDictionary {
    private Hashtable _dictionary = new Hashtable();

    public object this[object key] {
        get { return _dictionary[key]; }
        set { _dictionary[key] = value; }
    }
} 
```

我已经尝试研究和尝试各种选项，但还没有找到解决方案。任何帮助都将不胜感激，以找出`testRequest.QueryString("key")`语法不起作用的原因以及如何使其起作用。

注意：这是[通过 COM Interop 公开索引器/默认属性](https://stackoverflow.com/questions/299251/exposing-the-indexer-default-property-via-com-interop)的后续内容。

更新：这是从类型库中生成的一些 IDL（使用[oleview](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)）：

```
[
  uuid(C6EDF8BC-6C8B-3AB2-92AA-BBF4D29C376E),
  version(1.0),
  custom(0F21F359-AB84-41E8-9A78-36D110E6D2F9, AspObjects.IRequest)

]
dispinterface IRequest {
    properties:
    methods:
        [id(0x60020000), propget]
        IRequestDictionary* QueryString();
};

[
  uuid(8A494CF3-1D9E-35AE-AFA7-E7B200465426),
  version(1.0),
  custom(0F21F359-AB84-41E8-9A78-36D110E6D2F9, AspObjects.IRequestDictionary)

]
dispinterface IRequestDictionary {
    properties:
    methods:
        [id(00000000), propget]
        VARIANT Item([in] VARIANT key);
        [id(00000000), propputref]
        void Item(
                        [in] VARIANT key, 
                        [in] VARIANT rhs);
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-11-08T12:58:51.640

我对这个问题的调查结果：

该问题与公共语言运行时在向 COM 公开双接口和分派接口时使用的 IDispatch 实现有关。

VBScript (ASP) 等脚本语言在访问 COM 对象时使用 OLE 自动化 IDispatch 实现。

尽管它似乎有效，但我想将该属性保留为属性并且不想拥有一个功能（上面解释了解决方法）。

您有 2 种可能的解决方案：

1 - 将已弃用的 IDispatchImplAttribute 与 IDispatchImplType.CompatibleImpl 一起使用。

```
 [ClassInterface(ClassInterfaceType.None)]
    [IDispatchImpl(IDispatchImplType.CompatibleImpl)]
    public class TestRequest : IRequest
    {
        private IRequestDictionary _queryString = new RequestDictionary();
        public IRequestDictionary QueryString
        {
            get { return _queryString; }
        }
    } 
```

正如 MSDN 中所说，此属性已被弃用，但仍可与 .Net 2.0、3.0、3.5、4.0 一起使用。您必须决定它“已弃用”的事实是否对您来说是个问题......

2 - 或者在您的类 TesRequest 中将 IReflect 实现为自定义 IDispatch，或者创建一个实现 IReflect 并使您的类继承这个新创建的类的泛型类。

通用类示例（有趣的部分在 InvokeMember 方法中）：

```
[ComVisible(false)]
public class CustomDispatch : IReflect
{
    // Called by CLR to get DISPIDs and names for properties
    PropertyInfo[] IReflect.GetProperties(BindingFlags bindingAttr)
    {
        return this.GetType().GetProperties(bindingAttr);
    }

    // Called by CLR to get DISPIDs and names for fields
    FieldInfo[] IReflect.GetFields(BindingFlags bindingAttr)
    {
        return this.GetType().GetFields(bindingAttr);
    }

    // Called by CLR to get DISPIDs and names for methods
    MethodInfo[] IReflect.GetMethods(BindingFlags bindingAttr)
    {
        return this.GetType().GetMethods(bindingAttr);
    }

    // Called by CLR to invoke a member
    object IReflect.InvokeMember(string name, BindingFlags invokeAttr, Binder binder, object target, object[] args, ParameterModifier[] modifiers, System.Globalization.CultureInfo culture, string[] namedParameters)
    {
        try
        {
            // Test if it is an indexed Property
            if (name != "Item" && (invokeAttr & BindingFlags.GetProperty) == BindingFlags.GetProperty && args.Length > 0 && this.GetType().GetProperty(name) != null)
            {
                object IndexedProperty = this.GetType().InvokeMember(name, invokeAttr, binder, target, null, modifiers, culture, namedParameters);
                return IndexedProperty.GetType().InvokeMember("Item", invokeAttr, binder, IndexedProperty, args, modifiers, culture, namedParameters);
            }
            // default InvokeMember
            return this.GetType().InvokeMember(name, invokeAttr, binder, target, args, modifiers, culture, namedParameters);
        }
        catch (MissingMemberException ex)
        {
            // Well-known HRESULT returned by IDispatch.Invoke:
            const int DISP_E_MEMBERNOTFOUND = unchecked((int)0x80020003);
            throw new COMException(ex.Message, DISP_E_MEMBERNOTFOUND);
        }
    }

    FieldInfo IReflect.GetField(string name, BindingFlags bindingAttr)
    {
        return this.GetType().GetField(name, bindingAttr);
    }

    MemberInfo[] IReflect.GetMember(string name, BindingFlags bindingAttr)
    {
        return this.GetType().GetMember(name, bindingAttr);
    }

    MemberInfo[] IReflect.GetMembers(BindingFlags bindingAttr)
    {
        return this.GetType().GetMembers(bindingAttr);
    }

    MethodInfo IReflect.GetMethod(string name, BindingFlags bindingAttr)
    {
        return this.GetType().GetMethod(name, bindingAttr);
    }

    MethodInfo IReflect.GetMethod(string name, BindingFlags bindingAttr,
    Binder binder, Type[] types, ParameterModifier[] modifiers)
    {
        return this.GetType().GetMethod(name, bindingAttr, binder, types, modifiers);
    }

    PropertyInfo IReflect.GetProperty(string name, BindingFlags bindingAttr,
    Binder binder, Type returnType, Type[] types,
    ParameterModifier[] modifiers)
    {
        return this.GetType().GetProperty(name, bindingAttr, binder,
        returnType, types, modifiers);
    }

    PropertyInfo IReflect.GetProperty(string name, BindingFlags bindingAttr)
    {
        return this.GetType().GetProperty(name, bindingAttr);
    }

    Type IReflect.UnderlyingSystemType
    {
        get { return this.GetType().UnderlyingSystemType; }
    }
} 
```

对于迈克的代码：

```
[ClassInterface(ClassInterfaceType.None)]
public class TestRequest : CustomDispatch, IRequest {
    private IRequestDictionary _queryString = new RequestDictionary();

    public IRequestDictionary QueryString {
        get { return _queryString; }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-08T18:03:50.377

几天前我偶然发现了这个确切的问题。我找不到合理的解释来解释为什么它不起作用。

在花了很长时间尝试不同的解决方法之后，我想我终于找到了一些似乎有效的东西，而且不是那么脏。我所做的是将容器对象中的集合的访问器实现为方法，而不是属性。此方法接收一个参数，即键。如果键是“丢失”或为空，则该方法返回集合（它处理像 VbScript 中的“testRequest.QueryString.Count”这样的表达式）。否则，该方法返回集合中的特定项目。

这种方法的坏处是该方法返回一个对象（因为有时返回引用是集合，有时是集合的一个项目），因此在托管代码中使用它需要在任何地方进行强制转换。为了避免这种情况，我在容器中创建了另一个属性（这次是一个适当的属性）来公开集合。此属性不向 COM 公开。从 C#/托管代码我使用这个属性，从 COM/VbScript/非托管代码我使用这个方法。

这是使用此线程示例的上述解决方法的实现：

```
 [ComVisible(true)]
  [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
  public interface IRequest
  {
    IRequestDictionary ManagedQueryString { get; } // Property to use form managed code
    object QueryString(object key); // Property to use from COM or unmanaged code
  }

  [ComVisible(true)]
  [ClassInterface(ClassInterfaceType.None)]
  public class TestRequest : IRequest
  {
    private IRequestDictionary _queryString = new RequestDictionary();

    public IRequestDictionary ManagedQueryString
    {
      get { return _queryString; }
    }

    public object QueryString(object key)
    {
      if (key is System.Reflection.Missing || key == null)
        return _queryString;
      else
        return _queryString[key];
    }
  }

  [ComVisible(true)]
  [InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]
  public interface IRequestDictionary : IEnumerable
  {
    [DispId(0)]
    object this[object key]
    {
      [DispId(0)]
      get;
      [DispId(0)]
      set;
    }

    int Count { get; }
  }

  [ComVisible(true)]
  [ClassInterface(ClassInterfaceType.None)]
  public class RequestDictionary : IRequestDictionary
  {
    private Hashtable _dictionary = new Hashtable();

    public object this[object key]
    {
      get { return _dictionary[key]; }
      set { _dictionary[key] = value; }
    }

    public int Count { get { return _dictionary.Count; } }

    #region IEnumerable Members

    public IEnumerator GetEnumerator()
    {
      throw new NotImplementedException();
    }

    #endregion
  } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-01T08:33:56.520

我 David Porcher 解决方案对我有用。

但是他发布的代码处理了索引器的 Get 部分，所以我更新了他的代码来处理索引器的 Set 部分

这是更新的代码：

```
 // Called by CLR to invoke a member
    object IReflect.InvokeMember(string name, BindingFlags invokeAttr, Binder binder, object target, object[] args, ParameterModifier[] modifiers, System.Globalization.CultureInfo culture, string[] namedParameters)
    {
        try
        {
            // Test if it is an indexed Property - Getter
            if (name != "Item" && (invokeAttr & BindingFlags.GetProperty) == BindingFlags.GetProperty && args.Length > 0 && this.GetType().GetProperty(name) != null)
            {
                object IndexedProperty = this.GetType().InvokeMember(name, invokeAttr, binder, target, null, modifiers, culture, namedParameters);
                return IndexedProperty.GetType().InvokeMember("Item", invokeAttr, binder, IndexedProperty, args, modifiers, culture, namedParameters);
            }
            // Test if it is an indexed Property - Setter
            // args == 2 : args(0)=Position, args(1)=Vlaue
            if (name != "Item" && (invokeAttr & BindingFlags.PutDispProperty) == BindingFlags.PutDispProperty && (args.Length == 2) && this.GetType().GetProperty(name) != null)
            {
                // Get The indexer Property
                BindingFlags invokeAttr2 = BindingFlags.GetProperty;
                object IndexedProperty = this.GetType().InvokeMember(name, invokeAttr2, binder, target, null, modifiers, culture, namedParameters);

                // Invoke the Setter Property
                return IndexedProperty.GetType().InvokeMember("Item", invokeAttr, binder, IndexedProperty, args, modifiers, culture, namedParameters);
            }

            // default InvokeMember
            return this.GetType().InvokeMember(name, invokeAttr, binder, target, args, modifiers, culture, namedParameters);
        }
        catch (MissingMemberException ex)
        {
            // Well-known HRESULT returned by IDispatch.Invoke:
            const int DISP_E_MEMBERNOTFOUND = unchecked((int)0x80020003);
            throw new COMException(ex.Message, DISP_E_MEMBERNOTFOUND);
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T16:03:01.543

WAG here...您是否使用[oleview](http://www.microsoft.com/downloads/details.aspx?familyid=5233b70d-d9b2-4cb5-aeb6-45664be858b6&displaylang=en)检查了您的程序集以确保您的公共界面具有对 com 消费者可见的索引器？第二个 WAG 是直接使用 get_Item 方法，而不是尝试使用 indexer 属性（CLS 合规性问题）...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-26T15:40:55.723

我发现这`testRequest.QueryString()("key")`行得通，但我想要的是 `testRequest.QueryString("key")`.

我发现了[Eric Lippert](http://blogs.msdn.com/ericlippert/ "精彩的编程冒险")的一篇非常相关的文章（顺便说一下，他有一些关于 VBScript 的非常棒的文章）。文章[VBScript Default Property Semantics](http://blogs.msdn.com/ericlippert/archive/2005/08/30/458051.aspx)讨论了调用默认属性还是仅调用方法的条件。我的代码表现得像一个方法调用，尽管它似乎符合默认属性的条件。

以下是 Eric 文章中的规则：

> IDispatch::Invoke 实施者的规则是，如果以下所有条件都为真：
> 
> *   调用者调用一个属性
> *   调用者传递一个参数列表
> *   该属性实际上并不采用参数列表
> *   该属性返回一个对象
> *   该对象具有默认属性
> *   该默认属性采用参数列表
> 
> 然后使用参数列表调用默认属性。

谁能说出这些条件中的任何一个是否没有得到满足？或者，默认的 .NET 实现是否有可能`IDispatch.Invoke`表现不同？有什么建议么？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-24T12:12:31.143

我花了几天的时间来解决完全相同的问题，尝试使用多种策略来尝试所有可能的变化。这篇文章解决了我的问题：

以下用于生成错误 parentobj.childobj(0) 以前必须做的： parentobj.childobj.item(0)

通过改变：

```
Default Public ReadOnly Property Item(ByVal key As Object) As string
    Get
        Return strSomeVal

    End Get
End Property 
```

到：

```
Public Function Fields(Optional ByVal key As Object = Nothing) As Object

    If key Is Nothing Then
        Return New clsFieldProperties(_dtData.Columns.Count)
    Else
        Return strarray(key)
    End If
End Function 
```

在哪里：

公共类 clsFieldProperties Private _intCount As Integer

```
Sub New(ByVal intCount As Integer)
    _intCount = intCount

End Sub
Public ReadOnly Property Count() As Integer
    Get
        Return _intCount
    End Get
End Property 
```

结束类

# url - 如何从服务器端获取 Url Hash (#)

> ID：317760
> 
> 赞同：138
> 
> 时间：2008-11-25T15:43:16.297
> 
> 标签：url, server-side, fragment-identifier

我知道在客户端（javascript）你可以使用 windows.location.hash 但无论如何都找不到从服务器端访问。我正在使用 asp.net。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-10-18T23:14:26.537

我们遇到过需要在 ASP.Net 回发中保留 URL 哈希的情况。由于浏览器默认情况下不会将哈希发送到服务器，因此唯一的方法是使用一些 Javascript：

1.  当表单提交时，获取散列`window.location.hash`（`urlhash`

2.  **在服务器上**，如果您需要对它做一些事情，您可以使用这个值。如果需要，您甚至可以更改它。

3.  **在客户端**上加载页面时，检查此隐藏字段的值。您将希望通过它包含的 DIV 找到它，因为自动生成的 ID 是未知的。*是的，你可以在这里使用 .ClientID 做一些诡计，但我们发现只使用包装器 DIV 更简单，因为它允许所有这些 Javascript 存在于外部文件中并以通用方式使用。*

4.  如果隐藏的输入字段具有有效值，请将其设置为 URL 哈希 ( `window.location.hash again`) 和/或执行其他操作。

我们使用 jQuery 来简化字段的选择，等等……总而言之，它最终只是几个 jQuery 调用，一个用于保存值，另一个用于恢复它。

**提交前：**

```
$("form").submit(function() {
  $("input", "#urlhash").val(window.location.hash);
}); 
```

**在页面加载时：**

```
var hashVal = $("input", "#urlhash").val();
if (IsHashValid(hashVal)) {
  window.location.hash = hashVal;
} 
```

`IsHashValid()`可以检查“ `undefined`”或其他您不想处理的事情。

另外，当然，请确保您使用`$(document).ready()`得当。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2008-11-25T19:27:15.703

[RFC 2396][1] 第 4.1 节：

> 当使用 URI 引用对已识别资源执行检索操作时，可选的片段标识符（由交叉影线（“#”）字符与 URI 分隔）包含**在检索后由用户代理解释的附加参考信息动作已经顺利完成**。因此，它不是 URI 的一部分，但通常与 URI 结合使用。

（强调添加）[1]：[https ://www.rfc-editor.org/rfc/rfc2396#section-4](https://www.rfc-editor.org/rfc/rfc2396#section-4)

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2008-11-25T15:45:55.370

那是因为浏览器没有将该部分传输到服务器，对不起。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-30T11:16:13.100

可能唯一的选择是在客户端读取它并手动将其传输到服务器（GET/POST/AJAX）。问候阿图尔

[您还可以在 Malcan](http://malcan.com/EN/Lists/Tips%20and%20tricks/DispForm.aspx?ID=13)看到如何使用后退按钮和浏览器历史 记录

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-30T15:13:20.563

只是为了排除您实际上并没有尝试在 GET/POST 上查看片段并且实际上想知道如何访问您在服务器端代码中拥有的那部分 URI 对象的可能性，它位于 Uri.Fragment 下（[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.uri.fragment.aspx)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-09T21:34:02.317

GET 请求的可能解决方案：

新链接格式：`http://example.com/yourDirectory?hash=video01`

向控制器顶部调用此函数或`http://example.com/yourDirectory/index.php`：

```
function redirect()
{
    if (!empty($_GET['hash'])) {
        /** Sanitize & Validate $_GET['hash']
               If valid return string
               If invalid: return empty or false
        ******************************************************/
        $validHash = sanitizeAndValidateHashFunction($_GET['hash']);
        if (!empty($validHash)) {
            $url = './#' . $validHash;
        } else {
            $url = '/your404page.php';
        }
        header("Location: $url");
    }
} 
```

# cvs - 什么是cvs新生文件？

> ID：317762
> 
> 赞同：6
> 
> 时间：2008-11-25T15:43:54.563
> 
> 标签：cvs

我在结帐时收到此错误：

```
cvs checkout: warning: new-born file.java has disappeared
cvs [checkout aborted]: cannot make directory : No such file or directory
cvs status: cannot rewrite CVS/Entries.Backup: Permission denied 
```

我确定我对此文件夹具有适当的权限，即使我尝试签出新文件夹时也会发生这种情况。我也确定这些文件存在于 cvs..

我的结帐命令是：

```
cvs co -d dir -N -r(num) -r(num)... file file... and so on 
```

这个新生的东西是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T16:07:44.703

`new-born`指已被`add`-ed 但尚未`commit`-ted`CVS`的文件，或者在本地写入文件时遇到问题。

我的猜测是存在一个`.cvs`记录一个目录，`add`但该文件已被删除。

您看到的其他错误与结帐目录中的权限有关 - 可能您没有对结帐目录的写入权限、`umask`设置不正确或存在目录权限继承问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-23T08:32:17.137

在我的情况下，这是由指定文件中不存在的标签引起的。尝试从 cmd 行中删除 -r

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-10T16:42:29.233

对于曾经有与我的帐户匹配但不再匹配的 ACL 的文件，我收到了类似的错误消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T22:09:34.097

如果在该目录中的文件上设置了粘性标记，但有问题的文件是新的并且没有被标记，则可能会发生此错误。

# .net - 可同步的CRM系统

> ID：317777
> 
> 赞同：2
> 
> 时间：2008-11-25T15:48:05.817
> 
> 标签：.net, database, synchronization, crm

我需要开发一个 CRM 系统，它允许用户拥有数据库的本地副本，然后可以与主服务器系统同步。这个想法是，销售团队可以前往非互联网区域并仍然使用相对最新的信息进行操作，然后在他们回到办公室时同步。

我以前从未做过这样的事情，有人可以推荐一个同步解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T15:59:58.727

我自己编写了这样一个系统，如果可能的话，我建议避免使用它。用户搞砸这样一个系统的方式有很多种，尤其是当用户是销售团队时。一个名为 Act! 的 CRM 系统！（您可能熟悉）过去曾提供过这样的同步选项，也许他们仍然这样做。每当我的公司向一直使用 Act! 同步系统的公司销售产品时，该公司总是抱怨数据库损坏和错误同步。

如果您真的需要做这样的事情，那么我建议您使用数据库级复制（在我们编写同步应用程序时不可用）。许多数据库都提供复制功能，包括 MS-SQL Server。您可以通过在数据库级别跟踪更改并让数据库负责将这些更改传输到远程数据库来消除我们遇到的许多问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T16:44:33.593

为什么要重新发明轮子？有许多提供此功能的优秀 CRM 应用程序可用。有些甚至是开源的，因此您可以扩展它们。但是，如果您只需要一个具有离线功能和同步功能的客户端数据库，那么许多 CRM 应用程序都可以提供。仅对于客户端数据库[Highrise](http://highrisehq.com)将是完美的，但我认为没有离线/同步功能。也许看看[SugarCRM](http://sugarcrm.com)、[24SevenOffice](http://24SevenOffice.com)或[Salesforce](http://salesforce.com)？

构建同步应用程序很困难，因为数据合并需要解决大量问题。如果您仍然需要这样做，请查看[SyncML](http://en.wikipedia.org/wiki/SyncML)，它是一个开放的同步标准。[Funambol 提供](https://www.forge.funambol.org/download/)了一些准备安装的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T15:51:46.513

您可能想看看[Microsoft 同步框架](http://msdn.microsoft.com/en-us/sync/default.aspx)。我还没有使用它，所以我不能给出个人意见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-13T23:20:59.413

MS CRM 4.0 与 Outlook 结合使用时具有离线功能：

[http://www.microsoft.com/dynamics/crm/product/overview.mspx](http://www.microsoft.com/dynamics/crm/product/overview.mspx)

离线有其自身的一套奇怪之处（确保在离开良好的网络连接**之前**离线），但总的来说它在这里运行良好。不过，移动客户端的东西还没有出来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T00:38:38.510

首先 - 如果 CRM 将成为您销售的产品，那么无论如何都要构建它 - 如果它是供内部使用的，我会说让其他人忍受解决这些问题的痛苦并购买 CRM。

除了我认为不足以解决所有问题的数据库级复制之外，您真的需要“自己动手”。

我加入了一个团队，计划一些类似 CRM 的系统组件，最初他们计划使用数据库复制，因为它看起来很容易——直到你解决了冲突。

最后，我们改为使用 GUID 作为唯一标识符，因为它使用户创建的新记录的处理变得更加简单 - 否则您最终会为每个客户端系统使用这些尴尬的数字 ID 分区方案。地狱之路。

在同步之间进行更改时，没有什么有助于解决冲突，这是一个应用程序级别的问题。数据库可能会从 Bob 那里获得要重播的交易列表，但如果他编辑了与 Alice 相同的内容 - 它应该使用哪个版本？时间戳是不够的，因为如果 Alice 在她走的时候填写了她的时间戳并且有一个较早的时间戳，但是 Bob 等到他吃午饭并得到一个较晚的时间戳。

我真的建议您阅读所有关于同步和冲突解决的文章/博客条目 - 从 10,000 英尺的高度开始同步很简单，您可以全都挥手，但是当您陷入困境时，情况就不同了.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T01:20:21.077

这是我过去推出自己的同步解决方案时的策略。

1.  限制系统离线时可能发生的更改操作的数量。
2.  避免使用自动递增整数作为主键，因为这会导致一个讨厌的问题。过去，我为每个断开连接的客户端分配了一个唯一的 ID，并将该 ID 与自动生成的数字结合使用以形成一个漂亮且可读的主键（如 XXX-YYYYYYYY）。这很容易做到，因为在非并发环境中创建序列号是微不足道的。
3.  保留事务日志，例如您在离线期间执行的每个 DML 操作都可以“重播”到服务器。当您的基本同步需求得到满足时，您可以稍后围绕此日志进行优化。
4.  您必须决定如何在客户端应用程序离线之前准备它们。一个典型的解决方案是强制您的用户按下按钮以触发应用程序进入“离线模式”。我发现这个解决方案非常有问题，尤其是当您的用户粗心和健忘时。在早期阶段，从他们的经理那里得到一个快速的耳光通常就足够了，但您可以选择在以后实施更智能的智能解决方案。
5.  首先从最简单的操作构建我的解决方案，然后再逐步构建更复杂的场景。（单表单记录操作，多表多记录操作，必须充当事务的一系列操作）
6.  制作一个冲突解决方案。确保该方案得到您的用户的批准。

不用说，这是一段痛苦的旅程。如果您可以将痛苦外包给另一方（例如购买可用的 CRM 解决方案），那将是最好的。

# performance - MySQL 高效的“select id else insert”查询

> ID：317780
> 
> 赞同：2
> 
> 时间：2008-11-25T15:49:11.337
> 
> 标签：performance, mysql

我有一个 MySQL 表，包括：

```
CREATE TABLE `url_list` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `crc32` int(10) unsigned NOT NULL,
  `url` varchar(512) NOT NULL,
  PRIMARY KEY  (`id`),
  KEY `crc32` (`crc32`)
); 
```

将数据插入相关表时，我需要从该表中查找主键，并且使用 crc32 确实可以加快速度，同时允许使用小索引。URL 确实需要是唯一的，但我想避免索引多于实际数据。

如果该值不存在，我需要插入它，但是使用`INSERT IGNORE`, 或 ON之类的结构`DUPLICATE KEY`要么需要我在巨大的 varchar 上放置一个唯一值，要么不利用我的索引。

我怎样才能“SELECT id else INSERT”，同时保留表中已经存在的 80-90% 命中的查找速度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T16:14:18.370

我会建议放弃`id`专栏，`crc32`因为它们不是必需的。

您可以使用`MD5()`散列来提供从冗长的 URL 数据计算得出的固定长度、几乎唯一的值，然后使用该散列作为主键。

```
CREATE TABLE `url_list` (
  `url_hash` BINARY(16) NOT NULL PRIMARY KEY
  `url`      VARCHAR(512) NOT NULL
);

DELIM !!
CREATE TRIGGER `url_ins` BEFORE INSERT ON `url_list`
FOR EACH ROW
BEGIN
  SET NEW.`url_hash` = UNHEX( MD5( NEW.`url` ) );
END!! 
```

然后您可以使用，`INSERT..ON DUPLICATE KEY UPDATE`因为与 不同`crc32`，哈希应该有非常低的冲突机会。

**编辑：**见[http://en.wikipedia.org/wiki/Birthday_attack](http://en.wikipedia.org/wiki/Birthday_attack)。如果您在 2,000 年内每天记录 100 万个不同的 URL，那么这些 URL 的 MD5 散列包含冲突的可能性仍然低于您的硬盘存在无法纠正的位错误的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T16:01:49.690

[该网站](http://blogs.msdn.com/miah/archive/2008/02/17/sql-if-exists-update-else-insert.aspx)提供了类似问题的解决方案。

# java - 如何在 TreeSet 的范围内查找单词 使用正则表达式（java）

> ID：317784
> 
> 赞同：1
> 
> 时间：2008-11-25T15:50:10.680
> 
> 标签：java, regex

我正在迭代 TreeSet 并将其打印出来：

```
while (it.hasNext()) {
  System.out.println(it.next());
} 
```

输出：

```
after
explorers
giant
hoping
internet
into
.
.
.
virtual 
world 
```

但是，我*只想*打印出第一个字符在 mz 范围内的那些字符串。我一直在玩 java.util.regex，但没有成功：

```
String pattern = "[^m-z]"; 
```

我在这里有正确的想法吗？或者有没有更简单的方法来做到这一点？我要做的就是确保**只打印出 TreeSet 中第一个字符在 mz 范围内的那些字符串。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T15:52:54.403

首先，你的正则表达式是错误的。你要

```
"^[m-z]" 
```

其次，您没有显示用于匹配的代码。

第三：如果你愿意做一些除了正则表达式和迭代之外的事情，你应该看看SortedSet.tailSet。这可能是你的老师想要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T15:59:38.493

我不知道正则表达式，但你可以很容易地找到那些以 mz 字母开头的元素：

```
wordSet.tailSet("m", true); 
```

通常你会使用 subSet() 的下界和上界的下一个字符，但是因为 z 是最后一个字符，所以不容易做到。

为了让集合从 'b' 到 'y' 你会做

```
wordSet.subSet("b", true, "z", false); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T16:35:50.387

我同意这听起来有点像家庭作业，但我们开始吧......

```
while (it.hasNext()) {
    String element = it.next();
    if (element.toLowerCase().matches("^[m-z].*")) {
        System.out.println(element);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-25T15:52:15.217

看起来像一个家庭作业，但无论如何，“[^mz]”意味着不是 mz

尝试将“^”放在“[]”之外

看看[Pattern](http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html)类和顺便说一句，试试`String.matches()`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-25T18:10:42.193

我知道原发帖人讨论过使用正则表达式，但也许他有一个问题要解决，决定使用正则表达式，现在[有两个问题要解决](http://www.codinghorror.com/blog/archives/001016.html)。

```
while (it.hasNext()) {
    String element = (String) it.next();
    char c = element.charAt(0);
    if (c >= 'm' && c <= 'z') {
        System.out.println(element);
    }
} 
```

这似乎符合他在原始问题中以粗体提出的要求，尽管他的老师可能会要求使用正则表达式。

编辑：我刚才只是费心阅读完整的问题。然而，我仍然认为理解正则表达式不是解决这个问题的唯一方法是很有价值的。

# security - SSL真的值得吗？

> ID：317788
> 
> 赞同：5
> 
> 时间：2008-11-25T15:51:27.200
> 
> 标签：security, ssl

我想知道是否应该在服务器和客户端之间添加 SSL 层。我没有处理任何机密数据，但有人可能想要破解传输以获取情报的可能性很小（顺便说一句，这是一个游戏）。现在与小型网站相比，要处理的数据量相当可观，虽然增加的安全性可能很好，但最有可能的黑客将是用户自己，所以我觉得 SSL 会浪费时间，但想听听别人的经历。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T15:54:55.990

这听起来像是一个优化问题。如果您有您认为有价值的信息，请从 SSL（一种相对容易尝试的安全解决方案）开始。一旦你有工作，对系统进行基准测试。如果您觉得性能损失值得花时间尝试和优化，那就这样做。如果没有，你就完成了！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-25T15:54:57.817

用户是否使用用户名和密码登录？如果是这样，我认为它值得保护。毕竟，用户最终*可能会*使用他们在其他地方用于安全目的的密码。我知道他们不应该，但是...

现在假设有人在窥探您未受保护的对话。他们获取您网站的用户密码，使用它登录敏感网站，然后他们就离开了……

如果您不想加密信息（而且我确实理解持有有效证书等有点痛苦），那么至少值得让用户非常清楚他们的数据是未加密的，并强烈敦促他们不要使用他们在其他地方使用的密码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T16:02:15.243

如果您担心您的客户入侵您的数据传输 ssl，那么您将一无所获。它的通道安全性，如果他们拥有客户端，那么在中间会话中设置一个人，他们可以在其中查看未加密的传输，这是相对微不足道的。如果您担心用户入侵其他用户的数据传输，那么 ssl 是一种很好且相对简单的安全措施。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-25T15:57:57.950

应该使用 SSL，因为您不知道将来会发生什么漏洞或问题。

保密只是考虑您是否需要 SSL 的一种方式，如果您要传输任何个人数据，那么我希望它是安全的。在某些国家/地区，您可能因不使用 SSL 而违反数据保护法。

还有其他方法可以保护您传输的数据，例如在传输之前使用 PGP 密钥加密有效负载并在服务器上解密。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T15:55:36.677

不。如果玩家 X 不在玩家 Y 和服务器之间，他可以通过破解你所说的方式获得的唯一数据是服务器发送给玩家 X 的数据。而且这些数据根本不受保护，因为他的机器无论如何必须能够提取它。您也可以只压缩它而不是使用 SSL：保护级别不会相差太大。相反，只要确保你不向玩家 X 发送任何他不应该拥有的数据。有人不太可能在游戏中使用中间人类型的攻击。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T15:56:43.147

如果这个游戏因为不安全而被认为是不公平的，我担心除了作弊者之外，任何人都不会对它感兴趣。

除了保护数据流之外，是否可以减少您已经发送的内容？还是压缩它？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-25T16:03:52.993

需要更多信息来做出明智的决定，但您不必使用 SSL 来保护您的数据。您总是可以在客户端和服务器之间使用另一种算法和共享密钥，或者公钥/私钥。然后，您可以更好地控制要保护哪些位以及哪些位要保持打开状态。

一般来说，像登录这样的东西应该总是使用 SSL 加密。您可以通过 SSL 通道交换一组新密钥，然后使用密钥切换到非 SSL 以保护敏感数据。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-25T16:06:43.627

有些人认为 SSL 可以解决（几乎）不存在的问题。实际窃听线路并提取未加密信息非常困难。几乎没有人这样做。

如果您查看从在线商店购买的案例，更有可能发生的是他们侵入服务器并下载整个交易数据库。在一个理想的系统中，您甚至永远不会将您的信用卡凭证发送给经销商，而只是信用卡公司的签名证书，表明交易已经被授权。然而在互联网的早期，这被证明是一个很难建立的系统，但它会是更正确的解决方案。最后，他们选择了效率较低但更易于实施的系统。

现在回答你的问题。在您的情况下，我看不到 SSL 提供太多。如果有人想设置一个程序来监控发送到/从网络发送的内容，它仍然可以完成，因为他们可以在数据实际加密之前放置挂钩来捕获数据。如果您担心第三方或他们正在对抗的对手，请嗅探电线以找出他们不应该访问的游戏信息，例如另一支球队的队友之间的聊天。好吧，我想说那里的风险很小，不值得解决。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-25T16:41:56.927

除了有关在传输过程中加密用户名和密码的注释外，SSL 还可以防止[中间人攻击](http://en.wikipedia.org/wiki/Man-in-the-middle_attack)，但会增加每个请求的开销。

问题是您必须有某种方式让客户知道您的特定证书是有效的……或者更准确地说，它是您游戏中唯一有效的证书。

这也带来了一个问题，即在旧证书过期后新证书替换旧证书时如何告诉游戏。

不过说真的，除非这是某种订阅游戏，否则 SSL 可能是矫枉过正。

# .net - Reg-Free COM 不适合我

> ID：317794
> 
> 赞同：1
> 
> 时间：2008-11-25T15:52:46.807
> 
> 标签：.net, com, regfreecom

我正在尝试查看是否可以在我们的 Web 应用程序中使用 Reg-Free COM 来简化遗留 COM 组件的部署。但是，在我开始研究将它用于互操作情况之前，我无法进行简单的测试。这是我所做的：-

1) 创建一个新的 VB ActiveX DLL 项目。除了打开二进制兼容性之外，所有选项都保留为默认值。添加了一个名为“SayHello”的简单方法的类。
2) 在 Vs.NET 2008 (SP1) 中创建一个新的 c# 控制台应用程序。将 CPU 设置为 x86，并添加对我的 COM DLL 的引用。
3) 为参考打开“隔离”
4) 从 c# 控制台应用程序调用我的 SayHello 方法 - 一切正常。
5) 使用 regsvr32 /u 手动取消注册 COM dll
6) 再次尝试运行控制台应用程序。该应用程序失败并出现 COM 错误，因为它找不到 COM 注册信息。我可以确认清单存在（粘贴在下面）

我在 64 位的 Vista 上运行它，如果这有什么不同的话。

感谢您的任何指示。

```
<?xml version="1.0" encoding="utf-8"?>
<assembly xsi:schemaLocation="urn:schemas-microsoft-com:asm.v1 assembly.adaptive.xsd" manifestVersion="1.0" xmlns:asmv1="urn:schemas-microsoft-com:asm.v1" xmlns:asmv2="urn:schemas-microsoft-com:asm.v2" xmlns:asmv3="urn:schemas-microsoft-com:asm.v3" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:co.v1="urn:schemas-microsoft-com:clickonce.v1" xmlns="urn:schemas-microsoft-com:asm.v1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <assemblyIdentity name="TestRegFreeCom.exe" version="1.0.0.0" processorArchitecture="x86" type="win32" />
  <file name="TestProject.dll" asmv2:size="20480">
    <hash xmlns="urn:schemas-microsoft-com:asm.v2">
      <dsig:Transforms>
        <dsig:Transform Algorithm="urn:schemas-microsoft-com:HashTransforms.Identity" />
      </dsig:Transforms>
      <dsig:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
      <dsig:DigestValue>uIK8e9FAnH4SQwk6PRfrjdZHWuw=</dsig:DigestValue>
    </hash>
    <typelib tlbid="{08dcd362-63a1-424a-8c4e-e72dcda2a8e2}" version="1.0" helpdir="" resourceid="0" flags="HASDISKIMAGE" />
    <comClass clsid="{c540c43a-4d80-4c87-9091-dff664df0021}" tlbid="{08dcd362-63a1-424a-8c4e-e72dcda2a8e2}" progid="TestProject.Testy" />
  </file>
</assembly> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T18:24:56.453

您的代码示例似乎是 COM 对象 DLL 的清单。你也有主程序的清单吗？它需要一个将另一个对象列为依赖项的对象。

在[回答有关此主题的较早问题时](https://stackoverflow.com/questions/234726/use-ocx-without-registering-it#235045)，我的测试是一个 C# 程序，它使用了 VB5/VB6 提供的旧 ActiveX 控件。我的主程序的清单如下所示：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" 
  manifestVersion="1.0">
<assemblyIdentity
            type = "win32"
            name = "client"
            version = "1.0.0.0" />
<dependency>
            <dependentAssembly>
                        <assemblyIdentity
                                    type="win32"
                                    name="MSFLXGRD.X"
                                    version="6.1.97.82" />
            </dependentAssembly>
</dependency>
</assembly> 
```

dependentAssembly/assemblyIdentity 元素上的 name 属性应与 COM DLL 清单中的属性匹配。正如您在此处看到的，它不必是实际的文件名。

我看到的另一个可能的问题是清单中没有 comInterfaceExternalProxyStub 元素。MSDN 上的这篇文章中提供了该标记的示例和其他操作的[演练：COM 组件的免注册激活：演练](http://msdn.microsoft.com/en-us/library/ms973913.aspx)。步骤 6 和 7 讨论创建两个清单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T19:54:26.190

如果您在应用程序中引用 .dll，请单击项目中引用下的引用 dll，查看属性并将“隔离”设置为 TRUE。

这将在您的项目中包含 .dll，并且您的应用程序将使用包含在您的项目中的 .dll 的副本。

要在此处查看此外观的工作示例：

[http://archive.msdn.microsoft.com/SEHE](http://archive.msdn.microsoft.com/SEHE)

有问题的 .dll 需要在您构建应用程序的系统上注册才能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-26T15:34:34.597

感谢您的回复。

我添加的清单是从 .NET 控制台应用程序自动生成的。没有为 COM DLL 本身生成清单。我将查看演练，看看是否提供任何答案。

# winapi - Win32：写入文件而不缓冲？

> ID：317801
> 
> 赞同：12
> 
> 时间：2008-11-25T15:54:24.120
> 
> 标签：winapi, file-io, buffering

我需要创建一个新的文件句柄，以便对该句柄的任何写操作立即写入磁盘。

额外信息：句柄将是子进程继承的 STDOUT，因此我需要该进程的任何输出立即写入磁盘。

研究`CreateFile`文档，`FILE_FLAG_WRITE_THROUGH`标志看起来正是我所需要的：

> 写操作不会经过任何中间缓存，它们会直接进入磁盘。

我写了一个非常基本的测试程序，但是它不工作。我在 CreateFile 上使用了标志，然后`WriteFile(myHandle,...)`在一个长循环中使用，在大约 15 秒内写入大约 100MB 的数据。（我添加了一些`Sleep()`）。

然后我建立了一个专业的监控环境，包括在资源管理器中连续点击“F5”。结果：文件保持在 0kB，然后在测试程序结束时跳转到 100MB。

接下来我尝试的是在每次写入后手动刷新文件，使用`FlushFileBuffers(myHandle)`. 正如预期的那样，这使得观察到的文件大小变得良好且稳定。

那么，我的问题是，不应该在**不**手动刷新文件的情况下`FILE_FLAG_WRITE_THROUGH`做到这一点吗？我错过了什么吗？在“真实世界”程序中，我无法刷新文件，因为我无法控制正在使用它的子进程。

 **还有一个`FILE_FLAG_NO_BUFFERING`标志，出于同样的原因，我不能使用它 - 无法控制使用句柄的进程，因此我无法按照该标志的要求手动对齐写入。

编辑：我做了一个单独的项目，专门用于观察文件大小的变化。它使用 .NET[`FileSystemWatcher`](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)类。我也写了更少的数据——总共大约 100kB。

这是输出。查看时间戳中的秒数。

“内置无缓冲区”版本：

```
25.11.2008 7:03:22 PM: 10230 bytes added.
25.11.2008 7:03:31 PM: 10240 bytes added.
25.11.2008 7:03:31 PM: 10240 bytes added.
25.11.2008 7:03:31 PM: 10240 bytes added.
25.11.2008 7:03:31 PM: 10200 bytes added.
25.11.2008 7:03:42 PM: 10240 bytes added.
25.11.2008 7:03:42 PM: 10240 bytes added.
25.11.2008 7:03:42 PM: 10240 bytes added.
25.11.2008 7:03:42 PM: 10240 bytes added.
25.11.2008 7:03:42 PM: 10190 bytes added. 
```

...和“强制（手动）刷新”版本（`FlushFileBuffers()`每约 2.5 秒调用一次）：

```
25.11.2008 7:06:10 PM: 10230 bytes added.
25.11.2008 7:06:12 PM: 10230 bytes added.
25.11.2008 7:06:15 PM: 10230 bytes added.
25.11.2008 7:06:17 PM: 10230 bytes added.
25.11.2008 7:06:19 PM: 10230 bytes added.
25.11.2008 7:06:21 PM: 10230 bytes added.
25.11.2008 7:06:23 PM: 10230 bytes added.
25.11.2008 7:06:25 PM: 10230 bytes added.
25.11.2008 7:06:27 PM: 10230 bytes added.
25.11.2008 7:06:29 PM: 10230 bytes added. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-25T17:27:52.730

在崩溃日志的上下文中，我也被这个所困扰。

`FILE_FLAG_WRITE_THROUGH`只保证您发送的数据在返回之前被发送到*文件系统*`WriteFile`；它不能保证它实际上已发送到物理设备。因此，例如，如果您在带有此标志的句柄上执行 a `ReadFile`after a ，则`WriteFile`可以保证读取将返回您写入的字节，无论它是从文件系统缓存还是从底层设备获取数据。

如果您想保证数据已写入设备，那么您需要`FILE_FLAG_NO_BUFFERING`，以及所有随之而来的额外工作。例如，这些写入必须对齐，因为缓冲区在返回之前一直向下到设备驱动程序。

知识库有一篇关于差异的[简短但内容丰富的文章。](http://support.microsoft.com/kb/99794)

在您的情况下，如果父进程将比子进程更长寿，那么您可以：

1.  使用`CreatePipe`API 创建可继承的匿名管道。
2.  用于`CreateFile`创建带有`FILE_FLAG_NO_BUFFERING`set 的文件。
3.  将管道的可写句柄作为其 STDOUT 提供给子级。
4.  在父进程中，从管道的可读句柄中读取对齐的缓冲区，并将它们写入文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-24T15:38:29.340

这是一个老问题，但我想我可以补充一点。实际上，我认为这里的每个人都是错误的。当您使用 write-through 和 unbuffered-io 写入流时，它会写入磁盘，但不会更新与文件系统关联的元数据（例如资源管理器向您显示的内容）。

你可以在这里找到关于这类东西的很好的参考[http://winntfs.com/2012/11/29/windows-write-caching-part-2-an-overview-for-application-developers/](http://winntfs.com/2012/11/29/windows-write-caching-part-2-an-overview-for-application-developers/)

干杯，

格雷格

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-03T20:09:13.907

也许您可以对以下内容感到满意[`FlushFileBuffers`](http://msdn.microsoft.com/en-us/library/aa364439.aspx)：

> 刷新指定文件的缓冲区并将所有缓冲数据写入文件。
> 
> 通常，**[WriteFile](http://msdn.microsoft.com/en-us/library/aa365747(VS.85).aspx)**和**[WriteFileEx](http://msdn.microsoft.com/en-us/library/aa365748(VS.85).aspx)**函数将数据写入操作系统定期写入磁盘或通信管道的内部缓冲区。**FlushFileBuffers**函数将指定文件的所有缓冲信息写入设备或管道。

他们确实警告说，调用**flush**来大量刷新缓冲区效率低下 - 最好禁用缓存（即 Tim 的[回答](https://stackoverflow.com/questions/317801/win32-write-to-file-without-buffering/318204#318204)）：

> 由于系统内的磁盘缓存交互，在单独执行许多写入时，在每次写入磁盘驱动器设备后使用**FlushFileBuffers函数可能效率低下。**如果应用程序正在对磁盘执行多次写入，并且还需要确保将关键数据写入持久媒体，则应用程序应该使用无缓冲 I/O 而不是频繁调用**FlushFileBuffers**。要为无缓冲 I/O 打开文件，请使用和标志调用**[CreateFile](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)**函数。这可以防止文件内容被缓存，并在每次写入时将元数据刷新到磁盘。有关详细信息，请参阅**[创建文件](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)**。`FILE_FLAG_NO_BUFFERING``FILE_FLAG_WRITE_THROUGH`

如果这不是高性能情况，并且您不会过于频繁地刷新，那么 FlushFileBuffers 可能就足够了（而且更容易）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-27T20:28:34.407

您在资源管理器中查看的大小可能与文件系统对文件的了解并不完全同步，因此这不是衡量它的最佳方法。碰巧 FlushFileBuffers 会导致文件系统更新资源管理器正在查看的信息；关闭它并重新打开可能最终也会做同样的事情。

除了其他人提到的磁盘缓存问题之外，直写正在做你希望它做的事情。只是在目录中执行“dir”可能不会显示最新信息。

建议直写仅将其写入“文件系统”的答案并不完全正确。它确实将其写入文件系统缓存，但也将数据向下发送到磁盘。直写可能意味着从缓存中满足后续读取，但这并不意味着我们跳过了一个步骤并且没有将其写入磁盘。仔细阅读[文章的摘要。](http://support.microsoft.com/kb/99794)这对几乎每个人来说都是一个令人困惑的地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-15T20:40:11.867

也许您想考虑对该文件进行内存映射。一旦您写入内存映射区域，文件就会更新。

[Win API 文件映射](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366556%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396)

# asp.net - ASP.NET Session/Cache + 多核处理器服务器

> ID：317803
> 
> 赞同：1
> 
> 时间：2008-11-25T15:54:54.977
> 
> 标签：asp.net, caching, session-state

我有一个多核服务器托管我的 asp.net 解决方案。在过去使用双核等时，您必须修改您的应用程序以不使用进程内会话状态等。如果它是双核，情况仍然如此吗？

另外，服务器缓存是否在其中起作用？我的会话没有问题，但是当我尝试从代码中清除缓存时，它不起作用，我必须重置 iis 以清除缓存。- 但是，它确实可以在 locallay 上工作（我有一个双核），但不能在服务器上工作（intel pentium D）

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T16:10:32.230

处理中！= 在处理器中。

在多进程机器上使用进程内模型应该没有问题（会话带来的问题除外），因为进程（aspnet_wp.exe 或 w3wp.exe）能够在任何或所有处理器上执行。

[Http缓存？](http://msdn.microsoft.com/en-us/library/system.web.caching.cache_members.aspx)应该通过键值添加和删除项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T20:30:16.590

您需要使用进程外缓存客户端，例如 microsofts velocity，它可以处理进程外缓存和会话。如果您最终拥有一台以上的服务器，这也将向外扩展。

# java - 为什么 Java 中没有字节或短文字？

> ID：317816
> 
> 赞同：54
> 
> 时间：2008-11-25T15:57:29.263
> 
> 标签：java, primitive

我可以通过将 L 附加到值来创建文字 long；为什么我不能以类似的方式创建文字短或字节？为什么我需要使用带有强制转换的 int 文字？

如果答案是“因为 C 中没有短文字”，那么为什么 C 中没有短文字？

这实际上并没有以任何有意义的方式影响我的生活。写（短）0 而不是 0S 之类的东西很容易。但是这种不一致让我很好奇；当你深夜起床时，这是困扰你的事情之一。有人在某个时候做出了设计决定，以使为某些原始类型输入文字成为可能，但并非对所有原始类型都输入文字。为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-25T16:09:44.620

在 C 中，`int`至少意味着具有 CPU 的“自然”字长，并且`long`可能意味着是“更大的自然”字长（在最后一部分中不确定，但它也可以解释为什么`int`并且`long`具有相同的大小在 x86 上）。

现在，我的猜测是：对于`int`和`long`，有一个自然的表示完全适合机器的寄存器。然而，在大多数 CPU 上，较小的类型在使用`byte`之前`short`必须填充到`int`反正。如果是这种情况，您也可以进行演员表。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-25T16:02:26.087

我怀疑这是“除非它真正增加价值，否则不要在语言中添加任何东西”的情况 - 它被视为增加了足够少的价值以至于不值得。正如您所说，很容易绕过，坦率地说，无论如何都很少需要（仅用于消除歧义）。

在 C# 中也是如此，在这两种语言中我从未特别怀念它。我在 Java 中确实想念的是无符号字节类型:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-25T16:04:12.680

另一个原因可能是 JVM 不知道短字节和字节。所有计算和存储都是在 JVM 中使用整数、长整数、浮点数和双精度数完成的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-26T20:23:34.680

有几件事情需要考虑。

1) 如上所述，JVM 没有字节或短类型的概念。通常这些类型不用于 JVM 级别的计算；所以人们可以认为这些文字的使用会更少。

2) 对于 byte 和 short 变量的初始化，如果 int 表达式是常量并且在类型的允许范围内，则它被隐式转换为目标类型。

3）一个人总是可以转换文字，例如**（短）10**

# sql - 使用更改的设定值进行更新

> ID：317822
> 
> 赞同：1
> 
> 时间：2008-11-25T15:58:11.587
> 
> 标签：sql, sql-update

我们如何编写一个更新 sql 语句来更新记录并且“set”值每次都更改？

例如：如果我们有这样的记录

```
SomeNumber SomeV CurCode WhatCodeShouldBe
200802754 432 B08 B09
200802754 432 B08 B09
200802754 432 B08 B09
200808388 714 64B C00
200804119 270 64B C00 
```

我希望更新每个“SomeNumber”记录，以便“CurCode”与“WhatCodeShouldBe”相同

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T16:26:26.443

```
update a
set
  3rdColumn = b.2ndColumn
from
  tableA a
  inner join tableB b
  on a.linkToB = b.linkToA 
```

这是基于[你的新评论](https://stackoverflow.com/questions/317822/update-with-changing-set-value#317942)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T16:00:05.637

`UPDATE yourtable SET CurCode = WhatCodeShouldBe`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T16:00:05.700

```
UPDATE tableName SET CurCode = WhatCodeShouldBe 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T16:14:59.010

假设新代码存储在另一列中，即`WhatCodeShouldBe`，在上面的示例中，则语句类似于：

```
UPDATE table SET CurCode = WhatCodeShouldBe 
```

替换为实际的列名。这实际上告诉 DBMS，“对于每一行，将代码列设置为另一列中的任何值，对于每一行”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T16:21:49.510

我通过形成一些临时表并从不同的表中收集信息来获得这些数据。:( 更新这个临时表不会有帮助...我需要能够将更改转移到原始表。我会尝试给出更好的例子...

表A：200802754 432 B08 200802754 432 B08 200802754 432 B08 200808388 714 64B 200804119 270 64B

表B 432 B09 432 B09 432 B09 714 C00

所以我想让表 A 的第三列与表 B 的第二列相同...加入第 2 列的表。200804119 270 64B C00

# type-conversion - C#中的类型转换

> ID：317825
> 
> 赞同：4
> 
> 时间：2008-11-25T15:59:06.280
> 
> 标签：type-conversion, casting

我正在尝试为类型转换创建一个通用方法，该方法获取一个对象和要转换的对象类型。

通过使用`Convert.ChangeType()`我可以做我想做的事，但是在运行时需要太多时间。制作我想要的通用类的最佳方法是什么。

我的旧代码看起来像这样；

```
public static ConvertTo<T>(object data) where T : struct // yes the worst variable name!
{
  // do some controls...

  return Convert.ChangeType(data, typeof(T));
} 
```

编辑：澄清...

对于前; 我已经执行了我的查询，它返回了一个 DataRow。并且有一列输入为十进制，我想将其转换为长。如果我调用此方法，则将十进制转换为 long 需要花费很多时间。

并且该方法的 T 类型只能是值类型。我的意思是“T：结构”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T20:17:17.460

我仍然怀疑你的表现声称。这里有证据。编译并运行以下程序（在发布模式下）：

```
using System;
using System.Diagnostics;

class Test
{
    const int Iterations = 100000000;

    static void Main()
    {
        Stopwatch sw = Stopwatch.StartNew();
        decimal d = 1.0m;
        long total = 0;
        for (int i=0; i < Iterations; i++)
        {
            long x = ConvertTo<long>(d);
            total += x;
        }
        sw.Stop();
        Console.WriteLine("Time: {0}ms", sw.ElapsedMilliseconds);
        Console.WriteLine("Total: {0}", total);
    }

    public static T ConvertTo<T>(object data) where T : struct
    {
        return (T) Convert.ChangeType(data, typeof(T));
    }
} 
```

在我的笔记本电脑上执行 100,000,000 次迭代需要 20 秒。很难相信在您的计算机上执行 40 次迭代需要 8 秒。

换句话说，我强烈怀疑问题不在你认为的地方。

# xslt - 如何判断 xslt 中的变量是否大于另一个

> ID：317828
> 
> 赞同：24
> 
> 时间：2008-11-25T15:59:31.707
> 
> 标签：xslt

这些变量中的每一个都有一个整数值。但由于某种原因，这种语法无效：

```
<xsl:when test="$nextAnswerListItemPos < $nextQuestionStemPos" > 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-11-25T16:01:35.447

您必须使用`&lt;`instead of`<`和`&gt;`instead of `>`，因为这些是保留字符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-25T18:04:55.697

此外，在 XSLT 2.0 中，您可以使用运算符“gt”（大于）、“lt”（小于）和“eq”（等于）。使用这些而不是实体使您的代码更简洁。

# php - PHP 等价于朋友或内部

> ID：317835
> 
> 赞同：36
> 
> 时间：2008-11-25T16:00:39.507
> 
> 标签：php, oop, friend

php 中是否有“朋友”或“内部”等价物？如果没有，是否有任何模式可以遵循来实现这种行为？

**编辑：** 对不起，但标准的 PHP 不是我要找的。我正在寻找类似于 ringmaster 所做的事情。

我有一些类在后端进行 C 风格的系统调用，而且杂耍已经开始变得很麻烦。我在对象 A 中有函数，这些函数将对象 B 作为参数，并且必须调用对象 B 中的一个方法，并将自身作为参数传递。最终用户可以调用 B 中的方法，系统就会崩溃。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-11-25T16:14:08.107

PHP 不支持任何类似朋友的声明。可以使用 PHP5 的 __get 和 __set 方法来模拟这一点，并仅检查允许的朋友类的回溯，尽管执行此操作的代码有点笨拙。

PHP 网站上有一些[示例代码](http://bugs.php.net/bug.php?id=34044)和关于该主题的讨论：

```
class HasFriends
{
    private $__friends = array('MyFriend', 'OtherFriend');

    public function __get($key)
    {
        $trace = debug_backtrace();
        if(isset($trace[1]['class']) && in_array($trace[1]['class'], $this->__friends)) {
            return $this->$key;
        }

        // normal __get() code here

        trigger_error('Cannot access private property ' . __CLASS__ . '::$' . $key, E_USER_ERROR);
    }

    public function __set($key, $value)
    {
        $trace = debug_backtrace();
        if(isset($trace[1]['class']) && in_array($trace[1]['class'], $this->__friends)) {
            return $this->$key = $value;
        }

        // normal __set() code here

        trigger_error('Cannot access private property ' . __CLASS__ . '::$' . $key, E_USER_ERROR);
    }
} 
```

（代码由 nerdclub dot net[在 bugs.php.net 上](https://bugs.php.net/bug.php?id=34044)的 tsteiner 证明）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-08-08T00:45:50.097

也可以提升权限，也就是选择性地泄漏数据，使用 php >=5.3.3 中的握手和闭包。

基本上，交互是这样的：A 类有一个接受 B 类对象的公共方法，并调用 B->grantAccess（或您的接口定义的任何内容），并传递给它一个闭包。$that=$this的闭包`use($that,$anythingelseyouneed)`，以及确定允许访问哪些属性所需的任何其他内容。闭包有一个参数——要返回的属性；如果它是 $that 上的一个属性并且一切都很酷，则闭包返回该属性。否则，它返回 ''，或者抛出异常，或者可能是默认值。

B->grantAccess 类接受一个可调用对象并将其存储，在其他方法中使用它来提取闭包允许泄漏的私有属性。将 B 类的默认构造函数设为私有。使用带有 A 类参数的静态工厂方法构造 B，以确保发生握手。

要点在这里：[https ://gist.github.com/mcamiano/00592fb400e5043d8acd](https://gist.github.com/mcamiano/00592fb400e5043d8acd)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-31T22:20:42.897

也许这个？只有一个 hack 不是来自 C++ 的真正朋友关键字，在这种情况下仅适用于构造函数......

```
<?php

class FooWithFriend {

    private function guardOnlyFriend(): void 
    {
        if (( is_a($this, BarFriendOfFoo::class) ) === false ) {
         throw new Exception('Only class BarFriendOfFoo he can create me');
        }
    }

    protected function __construct() 
    {
        $this->guardOnlyFriend();
        echo 'Hello friend - ';
    }
}

final class BarFriendOfFoo extends FooWithFriend {
    public function __construct()
    {
        parent::__construct();
    }
}

final class Bar2FriendOfFoo extends FooWithFriend {
    public function __construct()
    {
        parent::__construct();
    }
}

$bar = new BarFriendOfFoo();
$bar = new Bar2FriendOfFoo();
$dummy = new FooWithFriend(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-08T10:11:47.660

对于现在 PHP 有`Class Friendship`选项：

```
class Person
{
    friend HumanResourceReport;

    protected $id;
    protected $firstName;
    protected $lastName;

    public function __construct($id, $firstName, $lastName)
    {
        $this->id = $id;
        $this->firstName = $firstName;
        $this->lastName = $lastName;
    }

    public function makeReport()
    {
        return new HumanResourceReport($this);
    }
}

class HumanResourceReport
{
    private $person;

    public function __construct(Person $person)
    {
        $this->person = $person;
    }

    public function getFullName()
    {
        // HumanResourceReport would not have access to protected 
        // members of Person if not explicitly listed as a friend.
        return $this->person->firstName . ' ' . $this->person->lastName;
    }

    public function getReportIdentifier()
    {
        return "HR_REPORT_ID_{$this->person->id}";
    }
} 
```

更多细节请查看：[PHP RFC：Class Friendship](https://wiki.php.net/rfc/friend-classes)

* * *

## 回答 #5

> 赞同：-19
> 
> 时间：2008-11-25T16:09:55.087

我很确定您要查找的是“受保护”还是“私有”，具体取决于您的用例。

如果你在一个类中定义一个函数，并且你只希望它自己可用，你可以这样定义它：

```
private function foo($arg1, $arg2) { /*function stuff goes here */ } 
```

如果您在一个类中定义一个函数，您希望从该类继承的类可以使用该函数，但不能公开使用，请以这种方式定义：

```
protected function foo($arg1, $arg2) 
```

我很确定在 PHP5 中默认情况下，函数是公共的，这意味着您不必使用以下语法，但它是可选的：

```
public function foo($arg1, $arg2) { /*function stuff goes here */ } 
```

在使用公共函数之前，您仍然必须实例化该对象。因此，我将彻底地告诉您，为了在类中使用函数而不实例化对象，请务必使用以下语法：

```
static function foo($arg1, $arg2) { /*function stuff goes here */ } 
```

这将允许您仅通过引用类来使用该函数，如下所示：

```
MyClass::foo($a1, $a2); 
```

否则，您需要执行以下操作：

```
$myObject = new MyClass();
$myObject->foo($a1, $a2); 
```

# jmx - 对于使用 JMX 监控 JVM，最好使用构建自己的工具还是使用 JConsole 之类的工具？

> ID：317843
> 
> 赞同：1
> 
> 时间：2008-11-25T16:01:53.450
> 
> 标签：jmx, jconsole

我目前的任务是开发一个工具来使用 JMX 来监控 JVM，例如但不限于内存使用、堆大小、线程数。所需的工具是一个可以为每个 jvm 显示许多图表的工具（下面的示例）。

那么问题是最好自己构建吗？使用其他可用的工具？（如果有，是哪一个）或者是否有一个具有许可证的工具，我可以使用它来构建？

示例：（每个 JVM 都有许多可以同时查看的图表，因此您可以查看特定应用程序/服务器/jvm 是否相当容易地运行。

1.  JVM1：PermGen 图、堆大小图、线程图
2.  JVM2：PermGen 图、堆大小图、线程图
3.  JVM3：PermGen 图、堆大小图、线程图

***编辑：“你忘记了第三个选项……买一个。” 有什么特别可以满足这些要求的吗？或者足够可扩展以处理它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-27T07:16:16.910

听起来像 jConsole 和 VisualVM 所做的 - 两者都与 JDK-6 一起分发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-02T22:03:59.347

[Java Mission Control](http://www.oracle.com/technetwork/java/javaseproducts/mission-control/java-mission-control-1998576.html)提供 Java 监控和管理。

[http://www.oracle.com/technetwork/java/javaseproducts/mission-control/java-mission-control-wp-2008279.pdf](http://www.oracle.com/technetwork/java/javaseproducts/mission-control/java-mission-control-wp-2008279.pdf)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-28T18:22:42.533

[Java 管理扩展 (JMX) 代理的 Web 服务连接器](http://jcp.org/en/jsr/detail?id=262)似乎是为 Java 7 计划的，它提供了一种以任何语言实现此类工具的简单方法。它是一个基于 Web 服务/http 的 JMX 代理标准，也可用于从 JVM 请求诊断信息。

实际上我正在用 Delphi 尝试这个，它已经很好用了（使用参考实现 [ws-jmx-connector](https://ws-jmx-connector.dev.java.net/)）。它已经是一个非常类似于 JConsole 的应用程序，但没有图表。

我将尝试在我的库的免费演示应用程序中实现图形监视器视图，该库尚未可供公众下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T01:12:49.723

你看过jmxtrans吗？（[https://github.com/jmxtrans/jmxtrans](https://github.com/jmxtrans/jmxtrans)）。是非常可扩展的，可能有你正在寻找的东西。

# html - 将 word 文本转换为干净 (X)HTML 的最简单方法或最佳工具

> ID：317854
> 
> 赞同：10
> 
> 时间：2008-11-25T16:03:42.527
> 
> 标签：html, xhtml, ms-word

这可能是用另一种方式问的。但是，我不是即时进行的。有时，我们会在 word 文件中获得包含短划线、粗体、斜体文本和块引号的内容片段。有没有一个很好的工具可以将它转换成干净的 html 代码。

否则人们采取什么其他方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T16:37:49.947

**很久**以前，我的任务是获取一个结构合理的多兆字节 word 文档并将其转换为一系列 HTML 页面（大约 20,000 个！）这是通过将 word doc 保存为 RTF（Word 的 Save As HTML output太“脏”了）并通过 Perl 脚本将 RTF 转换为 HTML。转换是一个两遍过程...首先清理常见的格式错误，然后将清理的 RTF 转换为 HTML。

由于文档编辑人员继续维护 Word 文档，因此在第一遍中编写常见的格式错误是值得的，因为即使在修复后错误经常会再次出现。

顺便说一句，这个过程显示了一个非常怀疑的管理人员如何在短短 40 小时（左右）内生成约 20,000 个网页*并*无限期更新，而原作者（他们的时间更有价值）会花费*数百小时*进行转换，此后将被迫手动维护生成的 HTML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T22:03:01.553

我很惊讶没有人提到它，但[HTML Tidy](http://tidy.sourceforge.net/)通常做得很好。我最近没有使用它，但我知道它特别适合清理从 Word 中暴露的 HTML 内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-08T20:38:09.327

我使用 TinyMCE 剥离和转换单个 Word 文档。它是免费的，只要您可以将其上传到您的虚拟主机（假设您有一个）。我保护我的安装以避免垃圾邮件，但您可以在[http://tinymce.moxiecode.com/tryit/full.php](http://tinymce.moxiecode.com/tryit/full.php)使用他们的演示。

它实际上比我尝试过的大多数独立转换程序做得更好，至少在我如何使用它方面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T17:07:36.530

对我来说，最简单快捷的方法是从 Word 中复制所有文本，然后使用*特殊粘贴命令将其粘贴到***Dreamweaver**（从 MX 到 CS3 的任何版本）的所见即所得编辑器中，并选择仅保留文档的结构。如果您的 word 文档不太复杂，它会很好用，如果它真的很复杂，您只需要在代码视图中进行额外的编辑。生成的 html 非常干净。

 *这种方法的唯一问题是您需要 Dreamweaver，它不是免费的。无论如何，您可以使用 DW 的试用版来测试该方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-14T01:46:24.667

几年前，我[为 Microsoft Office Word 2003 (.NET 2.0) 编写了一个名为 CleanXHTML 1.2](http://songhaysystem.com/document/number/55)的工具。这旨在在 Word*内部*工作，并允许您根据文档中突出显示（或选择）的内容导出 XHTML。多年来，我一直在使用 Word 2007 版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-13T00:27:11.917

我编写了一个命令行实用程序来执行此操作：有关详细信息，请参阅此[Doc to HTML converter](http://www.modeltext.com/word/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-05T16:22:39.160

你可以试试这个[Doc To HTML Converter](http://www.doctohtml.com)。它不是免费的，但它确实解决了问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-07T10:39:17.433

死灵术：

在 Word 2013 中打开 Word 文档。
另存为 odt（OpenOffice 文档）。
使用 OpenOffice 打开
要么使用
`"Save As" ==> HTML-Document`
要么使用

```
"File" ==> Export ==> XHTML 
```

导出需要安装 JRE，另存为则不需要。

对于 Word，您可以使用 COM 互操作，也可以使用 Aspose Words。

您也可以直接使用 aspose.words，只需使用 xpath 查询删除“版权”文本；）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-25T16:20:56.250

Word 用自己的编码非常“脏”。根据用户是否使用内置样式（标题 1、标题 2 等）与更改字体大小，它可以有嵌套的粗体标签、空的粗体标签和各种讨厌的东西。任何使用 Word 文档并尝试将其“转换”为 HTML 的内容也将继承相同的标记问题。

最好的办法是在 Word 中记录一个宏，以便对明显的事物执行多个搜索和替换操作，例如 M 破折号、制表符、省略号等。

然后用占位符（如**~** ）替换段落分隔符**^p^p** ，然后用空格替换所有单个分隔符（**^p ），然后用****~**替换以生成 HTML 段落。******`</p>^p</p>`******

 ******然后复制整个文档，将其粘贴到记事本中以删除任何非 ascii 标记，然后将其复制并粘贴到 HTML 编辑器中，并手动标记剩余的 10%，例如粗斜体、不匹配的段落标签等。

没有什么比手工编码更好的了，因此使用这种技术可以完成大部分繁琐的工作，并且您可以从干净的文本开始。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-25T16:46:24.560

转换为 RTF 并使用 XSLT 将富文本转换为 HTML。我建议尝试将所有内容都作为 RTF 而不是 .docx 或任何 Word 格式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-25T16:49:39.033

您可能想试试这个工具：[OpenXML Document Viewer](http://www.codeplex.com/OpenXMLViewer)。

它提供了一个用于将 OpenXML (DOCX) 文档转换为 HTML 的命令行工具。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-25T16:52:32.990

如果您可以安装 Word 2003 或 2007，那么您可以使用新的 OOXML 格式来生成 XML 文件。格式很奇怪……很复杂，但至少您可以使用标准工具对其进行解析。这应该允许您从文件中提取所需的信息。

文件[OfficeXMLMarkupExplained_en.docx](http://www.microsoft.com/downloads/details.aspx?FamilyID=6f264d0b-23e8-43fe-9f82-9ab627e5eaa3&displaylang=en)包含 OOXML 工作原理的介绍和许多细节。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-28T21:19:39.623

也可以试试[http://www.manglebracket.com/](http://www.manglebracket.com/)，它是一个网络应用程序，您可以在其中上传 Word DOC 并将其转换为具有各种（真的太多）选项的 HTML。例如，当您的撰稿人在 Word 中向您发送新闻稿并且您想将其放在网站上时，非常适合临时转换。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-02-01T11:29:57.907

[WordDown](http://code.google.com/p/jischtml5/wiki/WordDown "WordDown")是一个用于将 Microsoft Word 文档转换为 HTML5 的小书签。它不仅改变了文档的语法，还改变了语义和视觉外观。在我的测试用例中，与原始文档相比，视觉结果非常令人愉悦。如果要打印转换后的文档，您应该知道左侧的红色小横幅不包含在打印样式表中。

# bash - 如何通过 AppleScript 打开 Finder 侧边栏文件夹？

> ID：317857
> 
> 赞同：4
> 
> 时间：2008-11-25T16:03:55.083
> 
> 标签：bash, macos, applescript, finder

我有一个 bash 脚本，它将通过 ssh 在 Mac 上运行。该脚本需要已安装特定的网络驱动器。在 Mac 上，我通过在 Finder 中打开该驱动器上的文件夹“JPLemme”来安装该驱动器。这会安装驱动器，直到 Mac 晚上入睡。

显然，Finder 不能通过 ssh 使用，所以我想创建一个 AppleScript 来模拟我通过 GUI 所做的事情。我试过了：

```
tell application "Finder"
activate
open "JPLemme"
end tell 
```

我收到以下错误：

```
execution error: Finder got an error: Can't get "JPLemme". (-1728) 
```

我想我遗漏了一些明显的东西，但谷歌让我失望了。我也愿意接受更好的解决方案，例如直接安装驱动器；我已经避免了这种方法，因为我不希望 Mac 在我以意想不到的方式安装驱动器后再次尝试安装驱动器时窒息。（我不太喜欢 Mac 或 AppleScript ......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T19:39:12.340

您的网络卷应该有一个以某种方式附加到它的域。所以，“JPLemme.domain.com”。我使用以下代码块进入受密码保护的网络卷：

```
 tell application "Finder"
       try
          set theServer to mount volume "smb://path/to/volume" as username "YourUserName" with password "YourPassword" 
--Please note here that this is a plain string without any built-in security. Use at your own risk.
       on error
          set VolumeCount to (get count of disks)
          repeat with x from 1 to VolumeCount
             set thisVolume to disk x
             if name of thisVolume is "JPLemme" then
                set theServer to thisVolume
                exit repeat
             end if
          end repeat
       end try
    end tell 
```

您可以根据需要对其进行清理，但这是它的核心。祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T14:52:06.867

在它的核心，真正需要的是以下内容：

```
Tell Application "Finder"
   Mount Volume "smb://username:password@server/sub/directory"
End Tell 
```

但是使用什么在很大程度上取决于网络环境和返回的错误。

# .net-3.5 - 在 .Net 3.5 中表示层次结构的集合类型

> ID：317860
> 
> 赞同：0
> 
> 时间：2008-11-25T16:04:02.417
> 
> 标签：.net-3.5, collections, hierarchy

我一直在尝试用不同的方法来表示内存中的层次结构，这将允许简单而有效的上下横向发现祖先和后代关系。有人对我的选项有任何建议或示例吗？.Net 3.5 中是否有可以在这里提供帮助的集合类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T16:48:55.197

所以你想要一[棵树](http://en.wikipedia.org/wiki/Tree_%28data_structure%29)？[FGI](http://www.google.co.uk/search?q=c%23+tree&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-GB:official&client=firefox-a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-30T22:24:31.727

让你自己的节点看起来像：

```
 class Node<T> {
    public T Item;
    public LinkedList<T> Children;
  } 
```

然后根据需要递归应用Node

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-30T23:08:23.060

[`System.Web.UI.IHierarchicalEnumerable`](http://msdn.microsoft.com/en-us/library/system.web.ui.ihierarchicalenumerable.aspx)是一个有趣的模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-30T23:12:28.497

恐怕默认情况下什么都没有。做你自己的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T02:05:30.557

我使用 LINQ 遍历从 XML Web 服务加载的层次结构，但我敢打赌 LINQ 会很好地泛化以遍历您的树集合。

-麦克风

PS。我提到这一点是因为 LINQ 也很有趣。

# java - Java中的多态工厂/getInstance()

> ID：317869
> 
> 赞同：11
> 
> 时间：2008-11-25T16:05:59.917
> 
> 标签：java, design-patterns, polymorphism, factory

我的目标是创建一组对象，每个对象都有一个唯一标识符。如果具有该标识符的对象已经存在，我想使用现有对象。否则我想创建一个新的。我尽量不使用 Singleton 这个词，因为我知道这是一个肮脏的词......

我可以使用工厂方法：

```
 // A map of existing nodes, for getInstance.
private static Map<String, MyClass> directory = new HashMap<String, MyClass>();

public static MyClass getInstance(String name) {
    MyClass node = directory.get(name);
    if(node == null) {
       node == new MyClass(name);
    }
    return node;
} 
```

或者同样，我可以有一个单独的 MyClassFactory 方法。

但我本来打算继承 MyClass：

```
public class MySubClass extends MyClass; 
```

如果我不再做，并调用 MySubClass.getInstance()：

```
MyClass subclassObj = MySubClass.getInstance("new name"); 
```

... 那么 subclassObj 将是一个普通的 MyClass，而不是 MySubClass。

然而，在每个子类中覆盖 getInstance() 似乎很老套。

我缺少一个简洁的解决方案吗？

* * *

这是问题的一般化版本。更具体，因为回答者要求他们。

该程序用于生成表示软件片段的节点之间的依赖关系的有向图。子类包括 Java 程序、Web 服务、存储 SQL 过程、消息驱动触发器等。

因此，该网络中的每个类“都是”元素，并且具有导航和修改与其他节点的依赖关系的方法。子类之间的区别在于`populate()`用于从适当的源设置对象的方法的实现。

假设名为“login.java”的节点得知它依赖于“checkpasswd.sqlpl”：

```
this.addDependency( NodeFactory.getInstance("checkpasswd.sqlpl")); 
```

问题是 checkpasswd.sqlpl 对象此时可能已经存在，也可能不存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T16:35:23.290

你看过Guice吗？不确定它是否能完全解决您的问题，但它充当通用工厂和依赖注入容器，并消除了非类型安全的字符串键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T16:12:59.043

静态方法是在父类上定义的，也是静态调用的。因此，无法知道您在子类上调用它的方法。java 编译器甚至可能将调用静态解析为对父类的调用。

因此，您将需要按照您的建议重新实现子类中的静态方法，或者使它们不是静态的，以便您可以继承（在工厂**对象**的层次结构上，而不是类上），或者传递一个参数来表示您想要的类型创造。

查看 EnumSet.noneOf() 方法。它与您有类似的问题，它通过传递 java.lang.Class 方法来解决它。您可以在类上使用 newInstance 。但就个人而言，我只使用工厂对象而不是具有静态方法的类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-27T09:48:16.527

在阅读了您对问题的解释后，我认为您通过在图形构造中进行子分类使自己变得非常困难。我认为如果将依赖图与“程序信息”分开，问题会变得更加简单

使用接口，例如：

```
Public Interface Node<T> {
  public Object<T>    getObject();
  public String       getKey();
  public List<String> getDependencies();
  public void         addDependence(String dep);
} 
```

然后使用工厂来实例化你的节点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T16:36:01.133

Class 类使用它可以创建的实例类型进行参数化。（例如：Class<String> 是 String 实例的工厂。）

我看不出有什么办法可以知道当你在这里使用工厂方法 getOrCreate 时应该创建的实例类型，所以我建议将它传递给方法并参数化正在生成的类型：

```
private static Map<String, MyClass> directory = new HashMap<String, MyClass>();

public static <T extends MyClass> T getInstance(String name, Class<T> generatorClass)
{
  MyClass node = directory.get(name);    
  if(node == null) {
    node = generatorClass.getConstructor(String.class).newInstance(name);
    directory.put(name, node);
  }
  return node;
} 
```

另外，我注意到您实际上并没有将新构建的节点放入目录中 - 我假设这是一个疏忽。您还可以使用另一个不使用生成器并硬编码为默认类型的方法重载此方法：

```
public static MyClass getInstance(String name) {
  return getInstance(name, MyClass.class);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-25T16:44:58.463

你似乎暗示在某个地方你知道如果它不存在它应该是什么类。如果您在工厂中实现该逻辑，您应该获得正确的类。

这样你也不需要知道工厂实际返回了什么类。

如果您正在考虑使用工厂模式，我也可能会将“MyClass”作为接口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T16:17:36.257

该模式似乎是一种[享元](http://exciton.cs.rice.edu/javaresources/DesignPatterns/FlyweightPattern.htm)（结构上，如果不是与意图的完美匹配。）

如上所述，该`populate`方法可以映射到`Template`模式，尽管它不一定解决表达的问题。

我建议对工厂进行概括，对您期望的各种类型使用`create`（而不是，这对我来说确实意味着单例）方法。`getInstance`

```
public static MyClass createJavaNode(String name, <differentiator>);
public static MyClass createSqlPlNode (String name, <differentiator>);
.
.
. 
```

关于 a 如何`name`映射到 a的知识`<differentiator>`实际上是一种实现选择。理想情况下，会有一个多态性`create`，并且区分是按`node`类型。该`create`方法返回`MyClass`，但实际上是返回子类。我强烈考虑使用方法（有）制作`MyClass`接口或抽象类。`abstract` `populate``Template`

从描述来看，确实是类型之间的创建行为不同，而不是子类本身的行为不同，因此重构为`MyClass`接口或抽象类的情况变得更加强大。

套用 RA Heinlein 的话说`TANSTAAFL`- 没有免费午餐这样的东西 -在*某个地方*，如何创建各种类型的知识必须存在于应用程序中。因此，您的选择是将这些知识放在 Factory 类中，正如其他一些答案所表达的那样，或者将创建*什么*实现的决定与其创建*方式*分开。似乎有一种扫描文件系统并从中收集`Node`s 的能力。该代码将（或可以）知道应该创建的（ *what*的答案）的*类型。*`Node`

 *是否以更面向对象的方式实现`switch`还是以更面向对象的方式实现（表驱动调度会很好的时代之一）取决于您。如果这可能有用，我可以在这里扩展。

`MyClass`顺便说一句，如果需要扩展或修改某些子类的核心行为，那么 a`Decorator`可能有用。

* * *

原答案：

您可能会考虑将[装饰器](http://exciton.cs.rice.edu/javaresources/DesignPatterns/DecoratorPattern.htm)或[模板](http://exciton.cs.rice.edu/javaresources/DesignPatterns/TemplatePattern.htm) [设计模式](http://exciton.cs.rice.edu/javaresources/DesignPatterns/default.htm)作为替代方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T18:09:27.577

你可能想要依赖注入。它会概括你正在尝试做的事情。

此外，继承可能也不完全是您所需要的。除非您能通过“is-a”测试，否则切勿使用它。如果您继承的类“Has-a”唯一的字符串标签（本质上就是您的类似乎是什么），这并不意味着它“is-a”......

你可以让一个人握住另一个人。可能有很多解决方案，但是 A）您没有发布整个需求列表，所以我们只能猜测，B）您可能想要的是依赖注入。:)

# c# - 现有的类似于 Parallel.For 的 LINQ 扩展方法？

> ID：317874
> 
> 赞同：14
> 
> 时间：2008-11-25T16:07:03.797
> 
> 标签：c#, linq, extension-methods, iteration

> **可能重复：**
> [LINQ 等效于 IEnumerable<T> 的 foreach](https://stackoverflow.com/questions/200574/linq-equivalent-of-foreach-for-ienumerablet)

用于 ienumerable 的 linq 扩展方法非常方便......但如果您只想对枚举中的每个项目应用一些计算而不返回任何内容，那么它就没有那么有用了。所以我想知道我是否只是错过了正确的方法，或者它是否真的不存在，因为如果它可用的话我宁愿使用内置版本......但我还没有找到一个:-)

我可以发誓在某个地方有一个 .ForEach 方法，但我还没有找到它。与此同时，我确实编写了自己的版本，以防它对其他人有用：

```
using System.Collections;
using System.Collections.Generic;

public delegate void Function<T>(T item);
public delegate void Function(object item);

public static class EnumerableExtensions
{
    public static void For(this IEnumerable enumerable, Function func)
    {
        foreach (object item in enumerable)
        {
            func(item);
        }
    }

    public static void For<T>(this IEnumerable<T> enumerable, Function<T> func)
    {
        foreach (T item in enumerable)
        {
            func(item);
        }
    }
} 
```

用法是：

`myEnumerable.For<MyClass>(delegate(MyClass item) { item.Count++; });`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-25T18:59:50.720

进一步说明原因：

LINQ 本质上是函数式的。用于查询数据并返回结果。LINQ 查询不应该改变应用程序的状态（有一些例外，如缓存）。因为 foreach 不返回任何结果，所以除了您传递给它的内容之外，它没有很多不涉及更改某物状态的用途。如果你需要一个 Foreach() 扩展方法，很*容易*自己动手。

另一方面，如果您想要获取输入并在每个返回结果的项上调用一个函数，则 LINQ 提供了一种通过其 select 方法的方法。

例如，以下代码对列表中的每个项目调用函数委托，如果该项目为正则返回 true：

```
 static void Main(string[] args)
    {
        IEnumerable<int> list = new List<int>() { -5, 3, -2, 1, 2, -7 };
        IEnumerable<bool> isPositiveList = list.Select<int, bool>(i => i > 0);

        foreach (bool isPositive in isPositiveList)
        {
            Console.WriteLine(isPositive);
        }

        Console.ReadKey();        
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-05-07T10:26:21.143

实际上，Microsoft Research 的 Reactive Extensions 框架确实添加了这个功能。在`System.Interactive`程序集中，他们包含了 a`Run()`和 a 的`Do()`扩展`IEnumerable<T>`。

**Do(action)**将对每个元素执行操作并将其返回。这对于将日志记录添加到 linq 查询很有用，例如：

```
var res = GetRandomNumbers(100).Take(10)
      .Do(x => Console.WriteLine("Source  -> {0}", x))
      .Where(x => x % 2 == 0)
      .Do(x => Console.WriteLine("Where   -> {0}", x))
      .OrderBy(x => x)
      .Do(x => Console.WriteLine("OrderBy -> {0}", x))
      .Select(x => x + 1)
      .Do(x => Console.WriteLine("Select  -> {0}", x)); 
```

这将导致：

```
Source  -> 96 
Where   -> 96 
Source  -> 25 
Source  -> 8 
Where   -> 8 
Source  -> 79 
Source  -> 25 
Source  -> 3 
Source  -> 36 
Where   -> 36 
Source  -> 51 
Source  -> 53 
Source  -> 81 
OrderBy -> 8 
Select  -> 9 
9 
OrderBy -> 36 
Select  -> 37 
37 
OrderBy -> 96 
Select  -> 97 
97 
```

**Run(action)**就像一个 foreach 循环，这意味着它折叠执行动作的序列。

您可以在这里阅读更多相关信息：http: [//community.bartdesmet.net/blogs/bart/archive/2009/12/26/more-linq-with-system-interactive-the-ultimate-imperative.aspx](http://community.bartdesmet.net/blogs/bart/archive/2009/12/26/more-linq-with-system-interactive-the-ultimate-imperative.aspx)

Rx 框架可以在这里找到：http: [//msdn.microsoft.com/en-us/devlabs/ee794896.aspx](http://msdn.microsoft.com/en-us/devlabs/ee794896.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T16:15:14.780

ForEach 方法就是`List<T>`这样做的。您可以将您的集合包装在一个列表中，然后使用该调用，但这并不是一件好事。看来你得自己动手了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-25T16:46:50.007

已经在[这里](https://stackoverflow.com/questions/101265/why-is-there-not-a-foreach-extension-method-on-the-ienumerable-interface)和[那里](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2386791&SiteID=1)讨论过了。

我太困了，记不住，但基本上，单线程应用程序中的 .ForEach 方法在功能上等同于已经存在的 foreach 语句。据我了解，主要区别在于 ForEach 可以并行化，但这会很容易引入不需要的行为。

# version-control - crontab 版本控制？

> ID：317878
> 
> 赞同：5
> 
> 时间：2008-11-25T16:08:24.327
> 
> 标签：version-control, cron, crontab

我有几十台 Linux 机器正在运行`cron`，我想将 crontab 放在某种版本控制系统中。对于源代码控制，我使用 Mercurial ( `hg`)，所以这是理想的，但如果有其他更适合此任务的系统，我会考虑它。

我的情况特有的一个方面是所有 crontab 都属于一个普通用户（不是真人，而是占位符“服务”登录）。我希望修订历史记录包括每个更改的实际作者，而不是 cron 作业实际运行的特殊帐户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-25T16:14:22.753

crontab -l 将您的 crontab 转储到标准输出，您可以将其重定向到文件。您可以有一份工作（自然是在 cron 中）将其重定向到一个文件，然后进行差异化，并根据需要推送到源代码控制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T16:10:41.170

[http://joey.kitenet.net/code/etckeeper/](http://joey.kitenet.net/code/etckeeper/)？

从那个网站：

> etckeeper 是一组工具，可让 /etc 存储在 git、mercurial、darcs 或 bzr 存储库中。它与 apt（以及其他包管理器，包括 yum 和 pacman-g2）挂钩，以在包升级期间自动提交对 /etc 所做的更改。它跟踪修订控制系统通常不支持的文件元数据，但这对 /etc 很重要，例如`/etc/shadow`. 它非常模块化和可配置，如果您了解使用修订控制的基础知识，它也很容易使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T16:40:59.643

如果 linux 系统遵循 LFS（linux 文件系统标准，IIRC），那么 /etc 应该只包含配置文件。通过将整个 /etc 导入 CVS，我有很好的经验。

唯一的问题是只有 root 可以提交更改，所以很难看出是谁破坏了某些东西。这可以通过为每个管理员分配一个 3 个字母的短名称并设置每个提交必须以该名称开头的规则来解决。

# web-services - 通过 Web 服务访问 Sharepoint 列表时出现身份验证错误

> ID：317879
> 
> 赞同：6
> 
> 时间：2008-11-25T16:08:44.857
> 
> 标签：web-services, sharepoint, authentication

几个月前，我编写了一个 Windows 服务，它可以使用 _vti_bin/lists.asmx 函数 GetListItemChanges ping 一个 Sharepoint 列表。直到几周前，当我的公司将我们的 Sharepoint 实例升级到 SP1 时，它才能正常工作。
现在，每当我的服务尝试访问 Sharepoint 时，我都会收到 401.1 身份验证错误：

错误：

> 您无权查看此页面
> 您无权使用您提供的凭据查看此目录或页面。
> 请尝试以下方法： 如果您认为应该能够查看此目录或页面，请联系网站管理员。
> HTTP 错误 401.1 - 未经授权：由于凭据无效，访问被拒绝。
> 互联网信息服务 (IIS)

我已经检查过了，我在网站上的权限没有改变。这是我调用列表的代码：

```
Lists listsService = new Lists();
listsService.Credentials = new NetworkCredential("UserName", "Password", "domain");
Result = listsService.GetListItemChanges("List name", null, dTime.ToString(), null); 
```

我还注意到，我们的农场可能已禁用基本身份验证。我不相信我正在使用它，但我可能弄错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-18T14:21:10.947

我刚刚发现了一个非常相似的问题并通过 MS KB 文章解决了它：http: [//support.microsoft.com/kb/896861](http://support.microsoft.com/kb/896861)

您应该尝试的一点是：

> 方法 2：禁用环回检查 请按照下列步骤操作：
> 
> 1.  单击开始，单击运行，键入 regedit，然后单击确定。
> 2.  在注册表编辑器中，找到并单击以下注册表项：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa
> 3.  右键单击 Lsa，指向新建，然后单击 DWORD 值。
> 4.  键入 DisableLoopbackCheck，然后按 Enter。
> 5.  右键单击 DisableLoopbackCheck，然后单击修改。
> 6.  在数值数据框中，键入 1，然后单击确定。
> 7.  退出注册表编辑器，然后重新启动计算机。

这解决了我在所有正常解决方案（将凭据添加到 Web 服务调用）都失败的环境中的相同问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T21:54:03.920

根据提供的信息，我怀疑这是一个编程错误。您能否访问托管 SharePoint 网站的服务器上的 IIS 管理器界面？如果是这样，请检查允许的有效身份验证技术。允许匿名连接吗？是否启用了 Windows 集成身份验证？HTTP 基本身份验证？向您的基础架构/SharePoint 人员询问双跳（代理）的可能性。如果是这样，那也可能有效，但设置起来很痛苦（Kerberos 委托）。NetworkCredentials 类似乎支持 IIS 支持的所有标准身份验证方案（表单除外）：

[http://msdn.microsoft.com/en-us/library/system.net.networkcredential(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.networkcredential(VS.80).aspx)

您可能需要让基础架构人员为 SharePoint Web 前端设置 SPN：

[http://support.microsoft.com/kb/929650](http://support.microsoft.com/kb/929650)

但是，我建议不要通过 IIS 管理器更改任何内容。让您的 SharePoint 管理员通过 SharePoint 管理中心对网站允许的身份验证技术进行更改。

问候，山姆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T22:26:03.300

假设它不是 SSL 或 Basic/Windows 身份验证问题，那么我打赌这个

测试登录到本地服务器并尝试浏览您的站点。如果您无法使用上面给出的用户名/密码成功浏览，但您可以从远程电脑上浏览，那么这篇文章适合您。

[当您浏览使用集成身份验证并托管在 IIS 5.1 或 IIS 6 上的网站时，您会收到错误 401.1](http://support.microsoft.com/default.aspx?scid=kb;en-us;896861)

[http://support.microsoft.com/default.aspx?scid=kb;en-us;896861](http://support.microsoft.com/default.aspx?scid=kb;en-us;896861)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T16:36:08.047

您的内部网络上有代理吗？

我正在考虑双跳，基本身份验证不容易出现这种情况，但 NTLM 是。如果您有代理，那么双跳是一个问题。如果您直接访问机器并且只能计算一跳（服务到 Web 服务），那么这应该不是问题。

# .net - 为什么 global.asax 会改变 sql 连接？

> ID：317891
> 
> 赞同：1
> 
> 时间：2008-11-25T16:11:57.627
> 
> 标签：.net, asp.net, web-config, connection, global-asax

在 asp.net 3.5 中，我有一个问题，如果我将 global.asax 上传到远程 Web 服务器，应用程序开始寻找我的本地 sql 服务器并最终超时。由于 sql server 登录，我对本地和远程使用不同的配置文件。本地是windows auth，远程是sql server auth。但是，这些信息都没有存储在 global.asax 中。global.asax 只有

但是一旦上传，就会导致远程尝试查找本地 web.config 的 sql server 登录名。删除遥控器上的 global.asax 会导致一切正常。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T16:36:03.863

放入将导致使用继承类的 global.asax 文件，继承类中是否有任何代码可能导致更改？

.asax 可能是空白的，但这并不意味着继承的类是空白的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T16:29:42.567

你检查过它继承的类吗？它看起来是从**myapp.Global继承的**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T16:38:47.243

Check to see if the myapp.Global class accesses either the Membership, Role, or Profile providers; the default settings for each use a local SQL server connection.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T16:49:55.320

Ok, in the data access DLL, myapp.DataAccess.Properties has a

```
 [global::System.Configuration.DefaultSettingValueAttribute("Data Source=VISTADEV;Initial Catalog=Fin;Integrated Security=True")]
    public string FinConnectionString {
        get {
            return ((string)(this["FinConnectionString"]));
        }
    } 
```

which is my local box. I see the problem though. In global.asax.cs, rather than doing:

using (DataAccess.FinDBDataContext context = new DataAccess.FinDBDataContext(Configuration.DbConnection))

I was doing

using (DataAccess.FinDBDataContext context = new DataAccess.FinDBDataContext())

which brings back the default rather than the config value. Problem solved. Thanks.

# linq-to-sql - LINQtoSQL 错误：“System.String”类型不支持序列运算符

> ID：317893
> 
> 赞同：8
> 
> 时间：2008-11-25T16:12:21.433
> 
> 标签：linq-to-sql

出于某种原因，我的代码不起作用。

```
 from tan in TANS
    where tan.ID.ToString().Count() != 1
    select tan 
```

我想选择表中所有重复的 ID，所以我使用 count != 1 并收到此错误。

NotSupportedException：“System.String”类型不支持序列运算符

请帮忙？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-25T16:21:00.447

`tan.ID.ToString()`是一个字符串，而不是一个集合，所以你不能应用 Count()。

我相信你想要这样的东西：（这个语法是错误的，但是很接近）

```
from tan in TANS
group tan by tan.ID into dups
where dups.Count() > 1
select dups.Key; 
```

更新（5年后减去5天）：（谷歌一个问题并找到你写的答案有点奇怪..）这个问题的核心是LINQ语句试图构建一个SQL语句，而数据库不知道如何将 Count() 应用于字符串。但是，如果您对内存中的集合使用 LINQ，那么它会将字符串视为 IEnumerable，并且 Count() 可以正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-25T16:29:39.557

詹姆斯的回答接近我认为你想要的，如果你只是想让 ID 本身的价值与他的一致。如果您想要分配 ID 的对象，请尝试此操作。

```
var dupes = (from tan in TANS
             group tan by tan.ID.ToString() into duplicates
             where duplicates.Count() > 1
             select duplicates.Select(d => d)).SelectMany(d => d); 
```

我敢肯定，这不是 LINQ 中最干净的方法。如果我想出一种更清洁的方法，我会在这里进行编辑。SelectMany 很重要，因为它将 IGrouping 中的对象列表展平。

# .net - .Net Framework 3.5 的 SSCLI

> ID：317911
> 
> 赞同：2
> 
> 时间：2008-11-25T16:15:14.780
> 
> 标签：.net, .net-3.5, sscli

.Net Framework 3.5 是否有等效的 SSCLI？可以调试和逐步执行的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T16:18:04.743

如果您使用的是 Visual Studio 2008（尤其是 VS2008 SP1），您应该启用“.NET Framework 源代码步进”调试器选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-04T10:16:36.990

您需要下载 sscli 源代码的补丁，然后您才能通过 VS 2008 构建。

# php - 如何在 PHP 中检查表单输入是否为数字？

> ID：317916
> 
> 赞同：10
> 
> 时间：2008-11-25T16:16:25.730
> 
> 标签：php, validation, numeric

我需要能够查看 PHP 中的表单输入是否为数字。如果它不是数字，则网站应重定向。我试过 is_numeric() 但它似乎不起作用。

代码示例会很好。

我正在开发一个接受整数值作为数量的购物车。我正在尝试这个：

```
if(!is_numeric($quantity)){
                //redirect($data['referurl']."/badinput");
                echo "is not numeric";
        } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-25T16:28:15.020

```
if(!is_numeric($quantity == 0)){
                //redirect($data['referurl']."/badinput");
                echo "is not numeric"; 
```

你在这里有两个嵌套条件。假设 $quantity 为 1。

第一个条件计算 1 == 0 并返回 FALSE。第二个条件检查 FALSE 是否为数字并返回 FALSE，因为 FALSE 不是数字。

写吧：

```
if (!is_numeric($quantity))
{
    echo 'is not numeric';
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-25T16:19:42.790

您可能应该解释“数字”是什么意思 - 积分、浮点、指数符号等？[`is_numeric()`](http://www.php.net/manual/en/function.is-numeric.php)会接受所有这些。

如果你想检查一个字符串除了数字之外什么都没有，那么你可以使用正则表达式，例如

```
/^\d+$/ 
```

如果您要使用实际值，就好像它是一个整数一样，您可能无论如何都希望通过它，如果无法解析该值[`intval()`](http://www.php.net/manual/en/function.intval.php)，它将返回- 如果是一个有效值，那么您可能会有以某种方式处理它，也许通过限制值的较低范围。`0``0`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-25T18:31:37.047

使用 JavaScript 对输入进行一些客户端验证也可能是明智的。

往返服务器和返回的过程很长，可能会造成拼写错误，您可以通过让客户端浏览器事先做一些质量保证来减少服务器开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T16:23:29.570

检查[is_int](http://us3.php.net/manual/en/function.is-int.php)和[is_numeric](http://us3.php.net/manual/en/function.is-numeric.php)。每个链接中都有示例。如果您需要更多帮助，我会发布您遇到问题的数据和代码示例。

编辑：

```
$quantity == 0 
```

将始终是数字，因为它将返回一个布尔值（1 或 0）。正确的做法是：

```
if ( is_numeric( $quantity ) ) {
...
} 
```

或者

```
if ( is_int( $quantity ) ) {
...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-08T17:44:38.523

另一种选择是[`ctype_digit`](http://us2.php.net/manual/en/function.ctype-digit.php). 从文档：

```
Checks if all of the characters in the provided string, text, are numerical. Returns TRUE if every character in the string text is a decimal digit, FALSE otherwise.

<?php
$strings = array('1820.20', '10002', 'wsl!12');
foreach ($strings as $testcase) {
    if (ctype_digit($testcase)) {
        echo "The string $testcase consists of all digits.\n";
    } else {
        echo "The string $testcase does not consist of all digits.\n";
    }
}
?> 
```

> 上面的示例将输出：
> 字符串 1820.20 不包含所有数字。
> 字符串 10002 由所有数字组成。
> 字符串 wsl!12 不包含所有数字。

```
<?php

$numeric_string = '42';
$integer        = 42;

ctype_digit($numeric_string);  // true
ctype_digit($integer);         // false (ASCII 42 is the * character)

is_numeric($numeric_string);   // true
is_numeric($integer);          // true
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-25T16:25:12.530

Rob 所说的，虽然不是使用正则表达式来检查数字，但我会使用[ctype_digit](http://php.net/ctype_digit)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T17:04:42.527

到目前为止，tharkun 给出了最好的答案。如果您要问这样的问题，我猜您还不想开始弄乱 reg-exp。

重新思考你的逻辑。为什么要检查 $quantity==0 是否为数字结果？如果您试图避免错误 b/c，您认为数量可能没有指定值，那么您检查的时间有点晚。这是您的应用程序中一个非常常见（和邪恶）的安全漏洞——如果 $quantity 具有完全从用户输入派生的值，请确保在输入到达执行点之前对其进行清理。作为问题的一小部分，您不需要分配默认值，因为您之前已对输入进行了清理（而清理是您处理“无输入”情况的地方）。

祝你好运！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-08T15:06:53.097

使用正则表达式：`/^\d+$/`应该可以解决问题

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-10T09:33:28.930

试试这个：

```
$numeric = "1"; //true default

$string = trim($_GET['string']);

$chkarray = array("0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "0", ",", ".");

for ($i=0; $i < strlen($string); $i++) { 
    if (!in_array(substr($string, $i, 1), $chkarray)) {
        $numeric = "0";
        break;
    }
} 
```

# asp.net-mvc - 我应该使用 HtmlHelper 还是滚动我自己的控件？

> ID：317921
> 
> 赞同：1
> 
> 时间：2008-11-25T16:16:51.860
> 
> 标签：asp.net-mvc

我刚开始学习 ASP.NET MVC，我遇到了一个问题。我正在尝试确定是否应该使用 HtmlHelper 来创建客户端控件，或者是否应该自己滚动。我的直觉倾向于自己滚动，因为它给了我完全的控制权——并使用 jQuery 来装饰和添加跨浏览器功能。但是随后我可以看到将 HtmlHelper 用于可能涉及分页之类的各种复杂控件的优势。

我正在寻找有关何时使用 HtmlHelper 更好以及何时使用自己的更好的经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T18:25:08.653

它们添加到 HtmlHelper 的次数越多，我最终自己使用它们的次数就越多。

看看 ScottGu 的这些帖子： [MVC Preview 5](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx) 和 [MVC Beta](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx)

如果您不使用输入框的 HtmlHelper 版本，您将无法获得不错的免费验证。

此外，我不确定是什么阻止您使用任何您需要的东西来装饰 HtmlHelper 控件，以使它们可用于 jQuery。

您可以使用 htmlAttributes 重载添加所需的任何属性，如下所示：

```
<%= Html.TextBox("LastName", ViewData.Model.LastName, new { @class = "required" })%> 
```

我正在谈论的有趣部分是您在那里看到的匿名对象（new { @class = "required" }）。

你可以在里面放任何你需要的东西，然后它会被放在控件的属性部分。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T16:50:13.803

对于简单的案例来说，自己滚动非常容易，但你希望它们越“神奇”，它就越难。

幸运的是，您可以随时构建。

然而，提供的 HtmlHelper 控件非常广泛。他们将提供您需要的大部分内容。请小心重载，因为很容易意外地为您的呼叫使用错误的重载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T16:46:22.190

您需要问自己的真正问题是，您是否需要完全控制，您是否只需要一种可以在尽可能快的时间内完成工作的有效控制（这并不意味着您必须牺牲质量）。

如果速度是个问题，请使用 HtmlHelper，如果您想在控制地中玩，请自行滚动。如果您不确定，请使用 HtmlHelper 并保存自制控件以供您在业余时间进行实验。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T22:39:39.963

我为 HTML 创建了一个流畅的界面，我决定在[这里](http://code.google.com/p/mvcfluenthtml/)分享它。也许你会发现它是一个不错的选择。我还写了[一篇](http://lunaverse.wordpress.com/2008/11/24/mvcfluenthtml-fluent-html-interface-for-ms-mvc/)关于它的博客文章。

这是一个预告片：

```
<%=this.TextBox(x => x.FirstName).Class("required").Label("First Name:")%>
<%=this.CheckBox("enabled").LabelAfter("Enabled").Title("Click to enable.").Styles(vertical_align => "middle")%> 
```

欢迎批评和贡献。

# .net - 如何找到没有显式访问修饰符的方法？

> ID：317927
> 
> 赞同：2
> 
> 时间：2008-11-25T16:18:43.167
> 
> 标签：.net, coding-style, fxcop, stylecop

我正在使用 FxCop，我想找到所有没有明确定义访问修饰符的方法或变量。例如：

```
class MyClass
{
   int myInt = 0;

   internal MyClass()
   {
   }
} 
```

我希望 FxCop 警告我，我没有指定将哪个访问修饰符应用于变量“myInt”或类“MyClass”。有没有人这样做过，或者任何人都可以提供从哪里开始的指导？

**更新：**只是为了让大家知道，查找这个的 StyleCop 规则是**SA1400**。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-25T16:24:02.297

FxCop 分析已编译的代码，其中应用了访问修饰符。您需要使用[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)之类的工具来检测编码语法问题，例如未明确声明访问修饰符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-25T16:25:40.500

我相信使用 FxCop 的唯一方法是编写自己的自定义规则。这篇[博文](http://blogs.msdn.com/fxcop/archive/2004/01/09/writing-custom-rules-in-fxcop-amp-fxcop-visual-studio-integration-jeffrey-van-gogh.aspx)是一个很好的起点。

您可能还想看看[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)和[NDepend](http://www.ndepend.com/)。我几乎可以肯定 NDepend 会做到这一点（尽管您可能必须编写一些自定义 CQL），而且我知道 StyleCop 会开箱即用地做到这一点。

# windows-server-2003 - 路由添加失败：当文件已存在时无法创建文件

> ID：317932
> 
> 赞同：-1
> 
> 时间：2008-11-25T16:19:42.993
> 
> 标签：windows-server-2003, add, routes, persistent, rras

使用 c:>route add <route_and_interface_here> 时出现此错误

这发生在具有 PPTP 站点到站点 VPN 设置和按需拨号静态路由的 RRAS 服务器上。此路由显示在 RRAS 路由表中，但未显示在 c:>route 打印表中，这可能是问题的第一个来源。

有人见过这个吗？任何拥有可以在那里阅读建议答案的专家交流帐户的人？

问题可能与在 Win2k3 上应用 SP2 并在此之后从 RTM 磁盘安装 RRAS 有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-20T06:42:55.653

在添加路由时，给 PPtp 适配器一个高路由度量值。

Windows 7 界面指标计算似乎存在问题。

# search - 无需索引即可在文件中搜索字符串的工具

> ID：317944
> 
> 赞同：181
> 
> 时间：2008-11-25T16:21:59.713
> 
> 标签：search, full-text-search, text-files

我必须在一个非常古老的遗留应用程序中更改一些连接字符串，而制作它的程序员认为在整个应用程序中到处都贴上连接字符串是一个好主意。

Visual Studio 的“当前项目”搜索速度非常慢，我不信任 Windows Search。

那么，最好的免费、非索引文本搜索工具是什么？它应该做的就是返回一个列表，其中包含在文件夹及其子文件夹中包含所需字符串的文件。

我正在运行 Windows 2003 服务器。

* * *

## 回答 #1

> 赞同：379
> 
> 时间：2008-11-25T16:24:14.030

我喜欢[Notepad++中的](http://notepad-plus.sourceforge.net/uk/download.php)**Find-In-Files**对话框。*奖励*：它是免费的。

 *![在此处输入图像描述](https://i.stack.imgur.com/nLZrv.png)

* * *

## 回答 #2

> 赞同：184
> 
> 时间：2012-12-10T11:22:59.573

还有一个 Windows 内置程序[`findstr.exe`](https://technet.microsoft.com/en-us/library/bb490907.aspx)，您可以使用它在文件中进行搜索。

```
>findstr /s "provider=sqloledb" *.cs 
```

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2008-11-25T16:34:20.280

**原始答案**

[Windows Grep](http://www.wingrep.com/features.htm)在这方面做得非常好。

**编辑：**开发人员不再维护或提供 Windows Grep。备用下载链接在这里：[Windows Grep - 备用](http://download.cnet.com/Windows-Grep/3000-2351_4-75805915.html)

**当前答案**

[Visual Studio Code](https://code.visualstudio.com/)具有出色的跨文件搜索和替换功能。它非常快，支持正则表达式和替换前的实时预览。

[![在此处输入图像描述](https://i.stack.imgur.com/lH8z3.png)](https://i.stack.imgur.com/lH8z3.png)

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2013-11-05T17:30:46.170

我喜欢 AstroGrep。结果显示在列表中。单击一行可将整行显示为突出显示该命中的预览。它似乎很快，精简而且免费。在 Windows 7、8、10 和 Windows Server 2008 R2 上测试。允许正则表达式。

[![最新的 AstroGrep 截图](https://i.stack.imgur.com/JCujk.png)](https://i.stack.imgur.com/JCujk.png)

> AstroGrep 是一个 Microsoft Windows GUI 文件搜索 (grep) 实用程序。它的功能包括正则表达式、多功能打印选项、存储最近使用的路径并具有非常适合查看源代码的“上下文”功能

参考：[AstroGrep](http://sourceforge.net/projects/astrogrep/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-12-04T22:37:08.780

Visual Studio 在文件夹中的搜索是迄今为止我发现的最快的。

我相信它只智能地搜索文本（非二进制）文件，并且在同一文件夹中的后续搜索非常快，这与其他工具不同（可能文本文件适合 Windows 磁盘缓存）。

VS2010 在普通硬盘驱动器上，没有 SSD，需要 1 分钟才能搜索 20GB 文件夹，其中包含 26k 文件、源代码和二进制文件。搜索了 15k 个文件 - 由于是二进制文件，其余文件可能被跳过。同一文件夹中的后续搜索大约是几秒钟（直到东西被从缓存中清除）。

我为同一个文件夹找到的下一个最接近的是 grepWin。3分钟左右。我排除了大于 2000KB 的文件（默认）。“包括二进制文件”设置似乎对加快搜索没有任何作用，看起来二进制文件仍然被触及（错误？），但它们没有出现在搜索结果中。随后的搜索都需要相同的 3 分钟 - 无法利用硬盘缓存。如果我限制小于 200k 的文件，则初始搜索为 2.5 分钟，随后的搜索大约为秒，大约与缓存中的 VS 一样快。

由于搜索所有内容，包括巨大的数 GB 二进制文件，Agent Ransack 和 FileSeek 在该文件夹上的速度都非常慢，大约需要 20 分钟。根据资源监视器，他们以每秒约 10-20MB 的速度搜索。

更新：可以将 Agent Ransack 设置为搜索特定大小的文件，使用 <200KB 的截止时间，新搜索需要 1:15 分钟，后续搜索需要 5 秒。比 grepWin 快，并且与 VS 整体一样快。如果您想在选项卡中保留多个搜索并且不想污染 VS 最近搜索的文件夹列表，并且想要保留搜索二进制文件的能力，这实际上非常好，而 VS 似乎不想这样做。Agent Ransack 还创建了一个资源管理器上下文菜单条目，因此很容易从文件夹启动。与 grepWin 相同，但 UI 更好，速度更快。

我的新搜索设置是针对内容的 Agent Ransack 和针对文件名的 Everything（很棒的工具，即时结果！）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-02-06T13:13:12.620

如果您不想安装非 Microsoft 工具，请从 Microsoft Sysinternals[下载 STRINGS.EXE](https://docs.microsoft.com/en-us/sysinternals/downloads/strings)并制作如下程序：

```
@echo off
if '%1' == '' goto NOPARAM
if '%2' == '' goto NOPARAM
if not exist %1 goto NOFOLDER

echo ------------------------------------------
echo - %1 : folder
echo - %2 : string to be searched in the folder
echo - PLEASE WAIT FOR THE RESULTS ...
strings -s %1\* | findstr /i %2 > grep.txt
notepad.exe grep.txt

goto END

:NOPARAM rem - input command not correct
echo ====================================
echo Usage of GREP.CMD:
echo   Grep "SearchFolder" SearchString
echo Please specify all parameters
echo ====================================
goto END

:NOFOLDER
echo Folder %1 does not exist
goto END

:END rem - exit 
```

# tortoisesvn - 我应该如何使用 TortoiseSVN 合并工具 (TortoiseMerge)？

> ID：317950
> 
> 赞同：4
> 
> 时间：2008-11-25T16:23:10.660
> 
> 标签：tortoisesvn

我应该如何使用与最新版本的 Tortoise SVN 合并？我是一个老[ClearCase](http://en.wikipedia.org/wiki/IBM_Rational_ClearCase)人，我从来没有理解它。当我将分支合并回主干时，我只需选择修订范围，然后将版本号留空，它就会开始吐出正在合并的各种文件。它基本上看起来像是在添加和修改所有内容。

有趣的是，当合并完成时，唯一真正被触及的文件是我更新的文件，所以看起来一切正常（在运行了一些测试之后，情况似乎就是这样）。我只是对从合并日志中吐出的所有内容感到害怕，它并没有给我任何关于真正发生的事情的迹象。

我应该在版本号框中放一些东西吗？TortoiseSVN 似乎表明这不是必需的。

* * *

所以看起来我缺少的是“修订范围”不应该是空白的事实。为了获得类似于我习惯的功能，我需要放入创建分支 HEAD 的修订版。因此，如果修订版 289 创建了我的分支，那么我需要将 289-HEAD 放入要合并的修订版字段中，结果将符合我的预期。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-25T16:26:40.780

TortoiseSVN 包含两个“合并”概念：

1.  TortoiseMerge 工具，这是 TortoiseSVN 自带的图形化比较工具
2.  合并，如“分支和合并”，这是一个颠覆概念（这就是你所指的）

后者是一个经典的源代码控制概念，在产品之间有所不同。我对 ClearCase 一无所知，所以我无法真正尝试任何转换解释，但我可以指出[Subversion book](http://svnbook.red-bean.com/)的方向，这是一本极好的指南，其中包含对[分支和合并](http://svnbook.red-bean.com/en/1.8/svn.branchmerge.html)如何工作的非常好的解释颠覆世界。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T19:10:34.057

隐藏在文档深处的一件事是重新集成合并的工作原理。

如果您正在执行从分支路径到主干的 TortoiseSVN 重新集成，您的工作副本应该是**主干**的检出，而不是您可能期望的分支路径。重新集成将更改转储到您的工作副本中，然后您将其提交到主干。

# ios - 在 iPhone 上加载数据文件？

> ID：317959
> 
> 赞同：0
> 
> 时间：2008-11-25T16:24:57.147
> 
> 标签：ios, objective-c, iphone, cocoa-touch, cocos2d-iphone

在 iPhone 上加载包含游戏关卡地图的静态数据文件的最佳方式是什么？我见过一些使用 XML 文件，但在我的情况下这似乎有点矫枉过正，因为数据文件仅仅决定了游戏关卡的布局，即障碍物的去向。另外，它们应该存储在哪个项目目录中？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-25T18:26:45.217

如果您的文件真的是静态的，那么您需要将它们存储在您的应用程序包中（只需将它们添加到您的项目中；Xcode 将在构建您的应用程序时将它们复制到 .app 包中）。如果您需要修改并重新保存它们，可能 ~/Documents 是您最好的选择。

Marc 是正确的，NSDictionary 是最简单的方法，尤其是对于较小的文件。如果您有大量数据，加载时可能会变慢，但这意味着 10 秒或 100 千字节。当您对它的内容感到满意时，还可以考虑将您的字典转换为二进制格式，因为这样在设备上加载速度会更快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-25T16:52:55.717

我会将数据放在一个属性列表文件中，您可以将其加载到字典中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T22:50:28.193

我强烈建议使用作为标准 API 一部分的现有 SQLite 功能。

我发现它是在安装过程中包含数据以及存储用户生成数据的最简单方法。

如果您需要如何执行此操作的示例，请查看[http://tetontech.wordpress.com/2008/06/28/iphone-objective-c-sqlite-development/](http://tetontech.wordpress.com/2008/06/28/iphone-objective-c-sqlite-development/)

# python - 用于计算正态分布标准差的标准 C 或 Python 库

> ID：317963
> 
> 赞同：4
> 
> 时间：2008-11-25T16:25:34.573
> 
> 标签：python, c, algorithm, math, probability

假设我们有正态分布 n(x)：mean=0 和 \int_{-a}^{a} n(x) = P。

计算这种分布的标准差的最简单方法是什么？可能有适合该任务的python或C标准库吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-25T21:44:54.413

如果 X 是正态的，均值为 0，标准差为 sigma，它必须保持

```
P = Prob[ -a <= X <= a ] = Prob[ -a/sigma <= N <= a/sigma ]
  = 2 Prob[ 0 <= N <= a/sigma ]
  = 2 ( Prob[ N <= a/sigma ] - 1/2 ) 
```

其中 N 是正常的，平均值为 0，标准差为 1。因此

```
P/2 + 1/2 = Prob[ N <= a/sigma ] = Phi(a/sigma) 
```

其中 Phi 是平均值为 0 且标准偏差为 1 的正态变量的累积分布函数 (cdf)。现在我们需要*逆*正态 cdf（或“百分比点函数”），在 Python 中为 scipy.stats.norm.ppf( ）。示例代码：

```
from scipy.stats import norm
P = 0.3456
a = 3.0

a_sigma = float(norm.ppf(P/2 + 0.5))   # a/sigma
sigma = a/a_sigma   # Here is the standard deviation 
```

例如，我们知道一个 N(0,1) 变量落入区间 [-1.1] 的概率约为 0.682（[该图](http://en.wikipedia.org/wiki/Image:Standard_deviation_diagram.svg)中的深蓝色区域）。如果您设置 P = 0.682 和 a = 1.0，您将获得 sigma ~ 1.0，这确实是标准偏差。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-26T06:05:02.670

Pr(-a < X < a) = P 的均值零高斯分布的标准差为

```
a/(sqrt(2)*inverseErf(P)) 
```

这是您要查找的表达式，其中 inverseErf 是误差函数的倒数（通常称为 erf）。

对于 C，Gnu Scientific Library (GSL) 是一个很好的资源。但是它只有 erf，没有 inverseErf，所以你必须自己反转它（一个简单的二进制搜索就可以了）。或者，这是一种近似 erf 和 inverseErf 的好方法：

[http://homepages.physik.uni-muenchen.de/~Winitzki/erf-approx.pdf](http://homepages.physik.uni-muenchen.de/~Winitzki/erf-approx.pdf)

对于 Python，`erfinv`在 SciPy 库中可以使用 inverseErf，因此以下给出了标准偏差：

```
a/(math.sqrt(2)*erfinv(P)) 
```

PS：Stackoverflow 的 URL 呈现中存在某种错误，它不允许我链接到上面的 GSL： [http](http://www.gnu.org/software/gsl) ://www.gnu.org/software/gsl 。当我使用 pdf 将上面的 URL 设为正确的链接时，它也会呈现错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T16:29:17.060

[SciPy](http://www.scipy.org/)有一个[stats](http://docs.scipy.org/doc/scipy/reference/tutorial/#scipy-organization)子包。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T16:29:05.157

看看[sciPy Project](http://scipy.org/)，它应该有你需要的东西。

# mysql - ENCODE() 和 DECODE() 是在 MySQL 中处理应用程序密码字段的“最佳”方式吗？

> ID：317967
> 
> 赞同：1
> 
> 时间：2008-11-25T16:26:02.997
> 
> 标签：mysql, passwords

我正在 LAMP(erl) 堆栈上进行开发，并且知道几种存储模糊密码的方法。鉴于 MySQL 4.1.1 和 Perl 5.8，我想听听那些认为他们有最佳实践的人的意见，以及它是最佳实践的原因。

我读过的一个选项，使用 MySQL ENCODE() 和 DECODE() 函数，对我来说听起来不错……你的想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T16:30:25.983

通常，我更喜欢将密码保存为无法恢复的哈希值，而不是可以解密的加密项目。

通过从访问者提供的字符串（当然还有一些盐）计算哈希值，我可以判断用户是否两次提供了相同的密码，而没有允许我的应用程序能够解密提供的密码的安全风险，可能是恶意的.

我的感觉是，当您希望数据可恢复时， encode() 和 decode() 可能是很好的解决方案，但不可恢复的哈希（使用 Crypt::MD5）是存储密码的更好方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-25T16:30:58.477

我认为具有适当散列函数（如[SHA-256](http://search.cpan.org/~dido/SHA256-0.01b/SHA256.pod) ）的盐渍散列是最好的。可撤销的密码不如不可撤销的密码安全。如果没有外部 Perl 模块，您可以使用内置的 SHA1() 函数，不如 SHA256，但比 ENCODE/DECODE 更好。

此外，您必须考虑从代码到数据库的路径，该路径可以被嗅探。您可以通过在代码中散列或加密数据库连接来避免这种风险。最好在代码中执行此操作，因为即使在加密连接时，仍然存在配置查询日志的风险，因此将明文存储在某处的日志文件中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-25T16:29:51.600

如果您只需要密码来验证您自己/用户的身份，那么一种存储方式（如 md5）会更好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-25T16:29:35.890

好吧，既然有一个`DECODE()`功能，我会说不，因为您可能希望以散列形式存储密码，以防止任何人获取您的数据库/密码文件随便读​​取密码。

我建议使用经典的盐渍哈希方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-25T16:35:49.217

一些应用程序要求用户的密码是可检索的，这与用户密码被随机重置的系统相反，如果忘记了（因为它无法解密，因为您使用的是哈希）。在这种情况下，编码和解码都可以，但为什么不使用内置的 AES_ENCRYPT 和 AES_DECRYPT 函数呢？

此外，无论您是散列还是加密，都请遵循使用盐值的建议。在这两种情况下都是有益的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-25T16:29:40.413

我不确定这些函数的作用，但对于 LAMP 堆栈网站中的密码，我肯定也会使用盐域。

您的用户表将具有：

*   姓名
*   经过
*   盐

然后在纯文本密码和盐的串联上使用一些编码函数对纯文本密码进行编码。该结果进入通过字段。盐也被储存起来。这样你就可以在用户登录时验证明文密码。盐可以是任何东西，越长越随机越好，但我不认为它那么敏感。

这极大地提高了安全性，因为现在您的用户不再使用 5 个字母的密码，他们使用 5+len(salt) 大小的密码，如果盐足够大，彩虹数据库将永远不会包含您的哈希值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-25T16:43:08.843

如果您可以解密密码，则说明您的安全性存在缺陷。您应该始终使用盐对密码进行散列，MD5 很流行，但也有更好的散列，例如 SHA 和 SHA-256。

# wpf - WPF 依赖属性

> ID：317973
> 
> 赞同：6
> 
> 时间：2008-11-25T16:27:34.210
> 
> 标签：wpf, dependency-properties

我刚刚意识到我一直在强制绑定/依赖属性，并没有真正从根本上理解这个概念。

继承人的依赖属性：

```
public string Problem
{
    get { return (string)GetValue(ProblemProperty); }
    set { SetValue(ProblemProperty, value); }
}

public static readonly DependencyProperty ProblemProperty =
    DependencyProperty.Register(
    "Problem",
    typeof(string),
    typeof(TextBox)); 
```

XAML 是这样的：

```
<TextBlock Text="{Binding Path=Problem}"/> 
```

我`Problem`在对象的构造函数中手动将属性设置为一个值，但它不会`TextBlock`相应地更新 . . . 有任何想法吗？我试过绑定`Mode="OneWay"`，`Mode="TwoWay"`还是不行。

我以为这应该自动工作？还是我从根本上搞错了什么？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-25T16:35:23.243

您遇到的问题肯定与您的 DataContext 有关。{Binding} 扩展需要知道您绑定到的属性所在的位置。它查看的默认位置是元素 DataContext ，默认情况下始终设置为其父元素的 DataContext 。如果您将 DataContext 沿逻辑树向上移动到父窗口，则 DataContext 将为空（因为您的窗口的 DataContext 为空）。因此，您的文本块上的 {Binding} 是说“将我的 Text 属性绑定到我的 DataContext 的问题属性......这是空的。

有几种方法可以解决这个问题。一种方法是像 Jobi 提到的那样做，并将绑定的 Element 属性设置为指向 DependencyProperty 定义如下的窗口：

```
<TextBlock Text="{Binding Path=Problem,ElementName=_window}" /> 
```

另一种选择是将 Window 的 DataContext 设置为指向自身。这样，其内容中包含的所有元素都将具有窗口的 DataContext。

```
<Window ....
        DataContext="{Binding RelativeSource={RelativeSource Self}}"> 
```

现在，只要您需要绑定到窗口中定义的属性（例如您的 Problem 依赖项属性），您就可以这样做：

```
<TextBlock Text="{Binding Problem}" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-25T18:10:38.947

您可以在此处使用 ElementName 绑定，元素将是 Window 本身。

```
<Window x:Class="WpfToolTip.Window1"
x:Name="_window"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <StackPanel>
        <Button Click="OnClick" Content="OK" />
        <Button Click="OnCancel" Content="Cancel" />
        <TextBlock Text="{Binding Path=Problem,ElementName=_window}" />
</StackPanel> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-22T10:07:41.623

尝试`typeof(object)`代替`typeof(string)`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T17:30:14.660

Its a Window this is set in.

```
public partial class Window1 : Window
{
    public string Problem
    {
        get { return (string)GetValue(ProblemProperty); }
        set { SetValue(ProblemProperty, value); }
    }

    public static readonly DependencyProperty ProblemProperty =
                    DependencyProperty.Register(
                    "Problem",
                    typeof(string),
                    typeof(Window1));

    public Window1()
    {
        InitializeComponent();

        Problem = "ifowiof";
    }

    public void OnClick(object sender, EventArgs e)
    {
        Problem = "behl";
    }

    public void OnCancel(object sender, EventArgs e)
    {
       Problem = "eioeopje";
    }
} 
```

XAML:

```
<Window x:Class="WpfToolTip.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <StackPanel>
            <Button Click="OnClick" Content="OK" />
            <Button Click="OnCancel" Content="Cancel" />
            <TextBlock Text="{Binding Path=Problem}" />
    </StackPanel>
</Window> 
```

It works if I set the `RelativeSource` like you said when it loads, but if i change the `Problem` property in code manually (ie. via a button click) it never updates the `TextBlock` with the new value.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-23T21:12:01.877

在您的代码中，您为 TextBox 类注册了依赖属性（最后一行引号）。

> public static readonly DependencyProperty ProblemProperty =
> DependencyProperty.Register(
> "Problem",
> typeof(string),
> typeof(TextBox));

因此，您只能为文本框设置 ProblemProperty 的值，但我在任何代码片段中都找不到任何文本框。您应该为将分配值的类型注册依赖属性，从您的示例中，正确的选择对我来说并不明显。您可以像 Micah 那样将其定义为窗口的 DP，然后在实例化窗口上设置属性。或者您可以将其定义为窗口内的任何命名依赖对象，即某个具有 Name=m_ContentElement 的对象，然后将您的绑定设置为
`{Binding ElementName=m_ContentElement, Path=Problem}`
或更短：
`{Binding Problem, ElementName=m_ContentElement}`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-26T12:57:01.453

有两种方法可以理解您描述的问题的原因。

首先 - 您应该尝试设置属性更改处理程序（在依赖属性声明中）并将断点放在那里。您将看到您的财产是否正在发生变化。

其次 - 您应该检查依赖属性所有者的类型。

您能否显示完整的 xaml 和代码隐藏？

# .net - Castle Windsor 可以在子目录中定位文件吗？

> ID：317981
> 
> 赞同：1
> 
> 时间：2008-11-25T16:29:23.800
> 
> 标签：.net, winforms, castle-windsor

我有一个使用 Castle Windsor 的富客户端应用程序。目前，包括应用程序 exe 在内的所有程序集都在一个文件夹中，但看起来都很不整洁。我想将我的 dll 放在诸如“bin”之类的子文件夹中，但这会阻止 Castle 在调用时定位类型等。事实上，应用程序在启动时崩溃。

有没有办法告诉 Castle 在其他地方寻找文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T16:45:34.250

That depends on how you are configuring the Windsor.

In case you use Castle.MicroKernel.Registration interface, you should load assemblies manually and then register loaded types in the container.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-01T09:36:41.310

Castle 本身不进行任何程序集加载，它只是依靠融合来根据其默认探测行为定位程序集 - 所以这更像是一个一般的 .Net Framework 问题。

一种方法是处理程序集解析失败并将运行时定向到程序集所在的位置 - 实现此目的的一种方法是覆盖程序集解析（有关详细信息，请参阅[msdn](http://msdn.microsoft.com/en-us/library/system.appdomain.assemblyresolve.aspx)），然后编写一些代码来定位和从正确的位置加载适当的程序集。

这显然允许您支持任何类型的目录方案，而不仅仅是二进制子目录（例如，您可以有一个单独的插件目录）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T10:01:35.243

您可以使用自定义 XmlInterpreter 来初始化您的容器。创建一个继承 XmlInterpreter 的类并将以下覆盖放在该类中： 这个类处理当前执行程序集目录中的所有 *.dll.config，可以很容易地重写它以使用某种递归文件查找。

```
public override void ProcessResource( Castle.Core.Resource.IResource source, Castle.MicroKernel.IConfigurationStore store )
{
    base.ProcessResource( source, store );
    var baseDir = Path.GetDirectoryName( Assembly.GetExecutingAssembly().Location );
    foreach( var extraConfig in Directory.GetFiles( baseDir, "*.dll.config" ) )
    {
        try
        {
            var interpreter = new XmlInterpreter( extraConfig ) { Kernel = Kernel };
            interpreter.ProcessResource( interpreter.Source, store );
        }                      
        catch(ConfigurationErrorsException)
        {
            throw;
        }
        catch( Exception ex )
        {
            throw new InvalidOperationException( "Failed to load configuration: " + extraConfig, ex );
        }
    }
} 
```

# asp.net - 服务器控制和 MVC

> ID：317995
> 
> 赞同：3
> 
> 时间：2008-11-25T16:31:57.553
> 
> 标签：asp.net, asp.net-mvc

我一直相信，没有研究，服务器控制在 MVC 模型中被没收。我很想知道这是否属实，如果是这样，如何实现与Repeater控件或任何其他其确切结构取决于模型内容的视图等效的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-28T10:35:48.863

ASP.NET MVC 不支持 ViewState 也不支持回发，因此所有依赖它的 asp.net 控件都不起作用。中继器控件是少数不需要它的控件之一，因此它确实可以工作。

控制的 mvc 等价物是为您生成 html 的 HtmlHelper 类。htmlhelper 的集合相当大，但由于 webforms 和 asp.net mvc 的不同性质，您不会自动找到与常规 webforms 控件等效的控件。

MVCContrib 是 asp.net mvc 的 contrib 项目，因此您还可以在那里找到更多 htmlhelpers [http://www.codeplex.com/MVCContrib](http://www.codeplex.com/MVCContrib)

滚动自己的 htmlhelper 方法也很容易

在这里可以找到 ASP.NET MVC 的一个很好的起点[http://www.asp.net/mvc/](http://www.asp.net/mvc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-25T16:39:09.990

正确，类似 Rails 的 MVC 不完全支持服务器端控件及其所有混乱的视图状态等......您可以使用其中一些，但实际上不应该打扰。您可以通过使用视图组件重用 UI 部分，也可以使用来自 jQuery UI 或 Yahoo UI 的一些不错的客户端小部件来构建丰富的网格等......至于转发器......“foreach”是你的朋友:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-28T10:15:17.127

我不同意，Yuriy，控件没有用。一组数据绑定的 MVC 控件，很容易绑定到 viewdata，没有顽固的 ID 重写，不依赖讨厌的 viewstate 或 postback gunk 以及对模板的完全控制（默认为明智的标记），将是 MVC 框架的一个很好的补充。控件是一个非常强大和有用的概念，它可以显着增加开发时间，不应该仅仅因为它们带有丑陋的旧 webforms 时代的一些情感包袱而被丢弃！:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-25T16:36:41.913

那是不正确的，您**仍然**可以使用服务器控件。解析/处理视图的引擎仍然是 Web 窗体使用的同一个 ASP.NET 运行时。

使用中继器控件的[示例。](http://codebetter.com/blogs/david.hayden/archive/2007/12/27/asp-net-mvc-and-accessing-server-controls-in-codebehind.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-25T16:38:54.013

据我了解，您不需要服务器控件。相反，您将构建一个模型类，然后是一个视图类，负责显示来自该模型的数据。摘自 MSDN：

> 模型。模型管理应用程序域的行为和数据，响应有关其状态信息的请求（通常来自视图），并响应更改状态的指令（通常来自控制器）。
> 
> 看法。视图管理信息的显示。
> 
> 控制器。控制器解释来自用户的鼠标和键盘输入，通知模型和/或视图进行适当的更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-28T10:22:32.480

我想会有某种智能辅助方法，如 html.textbox 或类似方法，它们将根据给定的对象集合绘制表格/网格。
您可以将 html 帮助程序打包在 asp 自定义控件中，并在任何 mvc 应用程序中使用它......
有些人认为它像常规的 asp.net 服务器端控件，但没有视图状态、事件和所有其他与页面生命周期相关的东西。

# delphi - Delphi 在 .dpr 文件中添加 {$R *.res}

> ID：317997
> 
> 赞同：11
> 
> 时间：2008-11-25T16:32:59.143
> 
> 标签：delphi

Delphi 有时会在 .dpr 文件中的单元路径前面添加 {$R *.res} 使用子句，然后在尝试编译时收到重复资源警告。

任何人都知道为什么Delphi会这样做？我正在使用 Delphi 2009，但这是自 Delphi 2007 以来发生的（也可能是 2006 年）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-25T17:52:01.823

这取决于您对 .dpr 文件所做的其他操作。Delphi 期望该文件以某种方式布局，如果您以某种方式对其进行了修改，导致内部 IDE 解析器无法正确找到某些东西，它可能会猜错。最初，.dpr 文件从未打算让用户随意修改，因此它可能会混淆。IFDEFS 是最常见的可混淆 IDE 解析器的罪魁祸首。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-06-10T11:59:29.177

Delphi 向您添加这些“错误”{$R} 和 {$R *.res} 文本的问题隐藏在 DPROJ 文件中。只需使用文本编辑器打开 DPROJ 文件并搜索 $R *.res 并删除这些标签：

```
<DCCReference Include="..\..\..\Core\IF.Common\uTranslation.Types.pas">
  <Form>$R *.res</Form>
</DCCReference> 
```

将其更改为

```
<DCCReference Include="..\..\..\Core\IF.Common\uTranslation.Types.pas"/> 
```

现在您将不会在项目中看到糟糕的文本（直到下次 IDE 无法将此类内容添加到 DPROJ 文件中。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-25T22:08:28.750

也许发布您的 .dpr 将有助于说明您的问题。我的项目文件看起来像这样，没有问题：

```
program Example;

{$R *.res}

uses
  Unit1 in 'Unit1.pas' {frmUnit1};

begin
  Application.Initialize;
  Application.CreateForm(TfrmUnit1, frmUnit1);
  Application.Run;
end. 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-27T18:13:00.097

Delphi 将 {$R *.res} 添加到您的 .dpr 文件中，以将它生成的 .res 文件链接到您的应用程序中。例如，如果您将项目保存为 MyProject.dpr，Delphi 将创建一个文件 MyProject.res，其中包含您在 Delphi 的项目选项中指定的应用程序图标和版本信息。如果没有此 .res 文件，您的 .exe 将没有图标或版本信息。

如果您收到重复资源警告，您的代码中可能还有另一个 {$R} 编译器指令，该指令也链接到 MyProject.res。它可能是 .dpr 文件中的重复 {$R *.res}，或另一个 .pas 文件中的 {$R MyProject.res}。删除另一个编译器指令而不是 Delphi 自动生成的那个，您的项目将编译得很好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-26T07:55:20.670

我已经获得了一些“启发式”来处理 IDE 与 dpr 混淆的事实：

1.  主开始-结束块中没有“复杂”的代码（即带有变量或 ifs 的东西 :-)）。我需要在那里完成的所有事情都被换成了单独的例程。这似乎使 IDE 解析器更快乐。
2.  如果我在uses 子句中需要$IFDEFs，我会创建一个包含$IFDEFed 单元的“代理单元”，并将*其*放在dpr 的uses 子句中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-25T17:49:35.683

这很烦人，没有任何明显的原因发生，并且无法阻止发生 - 据我所知:(

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-06-17T11:38:51.687

.dpr 中的默认 {$R *.res} 应该在 uses 和 var 子句之间。

有时项目文件会损坏..
只需删除源目录中除 *.dpr、*.pas、*.dfm 之外的任何文件
delphi 将重建其他文件，包括 *.res

就是这样********************