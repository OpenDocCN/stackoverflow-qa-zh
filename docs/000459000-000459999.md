# StackOverflow 问答 000459000-000459999

# data-binding - UI 数据绑定：替代方案和未来

> ID：459016
> 
> 赞同：12
> 
> 时间：2009-01-19T20:15:03.597
> 
> 标签：data-binding, language-agnostic

UI 数据绑定也就是将信息/数据从应用程序的 biz 层/数据模型传输到 UI，然后从 UI 传回数据模型，语言和框架设计人员可能会忽略这些接缝。

当今软件系统处理的几乎所有信息都必须在处理链的某个点呈现给人类用户，但我们从编程系统获得的向用户呈现信息的支持主要包括难以维护的传输方法，一些系统使用反射没有编译时验证（“propertychanged”有人吗？），或专有代码生成器。

我的意思是 Erik Meijer、Anders Hejlsberg 和他们的团队已经付出了巨大的努力来解决 DB、XML 和代码之间的阻抗不匹配……但大部分都忽略了 UI。（是的，.net 有数据绑定，但尝试使用它，然后让我们讨论一个真正的解决方案） 重点是：不将数据绑定特别视为语言 fe 的一流特性的原因是什么？为什么今天我们的工具对 MVC/MVP 模式的支持如此有限（或没有）？

请提供评论、提示和指向可用的替代概念，甚至可能在该领域进行中的工作。甚至有什么新的创意和新鲜的想法吗？是否有任何有用的框架、支持数据绑定的语言概念，以及可能帮助您在应用程序或系统中处理数据绑定的工具？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T22:39:25.117

WPF 绑定虽然好但是太复杂了，它结合了 XPath 的特性和普通的 .Net 绑定，超级灵活，但是当它变得复杂时很难调试，而且很冗长——一段代码需要多少个 IValueConverter？

WPF 中的 DependencyObject 非常出色 - 一个可明智地管理内存的属性，内置了更改通知 - 这通常是绑定和属性的良好开端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T20:26:39.237

Cocoa 和 Objective-C 中的数据绑定非常活跃。部分原因是它建立在键值编码和键值观察之上，这些是 Cocoa 中非常可靠且经过深思熟虑的特性。它还很好地集成到了 Apple 正在开发的许多新技术中，例如 Core Data。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-01T00:06:35.393

我处于移植项目的后期阶段，将 AppMaker 生成的代码从基于 C 的 Macintosh GUI 移植到 WPF。

AppMaker 的代码生成风格远远领先于它的时代——15 年前，它使用数据绑定和基于属性的方法生成了基于模型的代码。C 代码的缺点是所有的管道都暴露了。

这个项目令人着迷——将一个具有纯绑定和命令结构（尽管代码丑陋）的体系结构应用于 WPF。实际上，我编写了一个[新的 AppMaker 代码生成器](http://www.aussiedesignedsoftware.com/AppMakerX/AppMakerX.html)来将原始对象模型导出为 XML，并且从那以后一直使用 Ruby 来生成 XAML、C# 和 C++/CLI。

WPF 中的数据绑定模型的工作效果给我留下了深刻的印象，尽管找到在 XAML 与 C# 中放入什么的最佳点很有趣。正如在[最近的 DevJam](http://aussiedesignedsoftware.com/blog/?p=130)演示中所解释的，我们决定采用三层方法

1.  非常精简的 XAML 样式，
2.  C# 用于绑定，
3.  用于 ViewModel 实现的 C++/CLI。

我从前就是一个绑定爱好者——我的 C++ OOFILE 框架首先使用绑定方法来简化数据库与不同 GUI 框架[中的表单的连接，大约在 1997 年。](http://www.oofile.com.au/oofdoc/Manual/pplant.htm)

作为一个兴趣点，我从原来的美国所有者那里获得了 AppMaker，经过多年的合作，我编写了 Windows 代码生成器。西澳大利亚珀斯的一家小公司拥有一个复杂的 AppMaker 生成的 GUI 可移植，这似乎几乎令人难以置信，竟然发现世界上剩下的 AppMaker 专家住在大约 30 英里外！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T20:31:55.297

其他支持数据绑定的框架是 Adob​​e Flex 和 Microsoft 的 WPF。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T00:44:59.653

WPF 中的数据绑定和 UI 模型简直令人惊叹。您可以绑定到对象的方法、异步绑定、单向绑定（从源到目标，反之亦然）或双向绑定，以及绑定到屏幕上的其他 UI 元素。

您可以指定 DataTemplates，它控制特定类型的显示方式。您可以定义触发器，它允许 UI 根据绑定对象（或 UI 中的其他位置）中的更改进行更改。简而言之，如果您觉得缺少 UI/绑定表示的状态，您应该真正查看 WPF。

这是最近的一篇[文章](http://cromwellhaus.com/blogs/ryanc/archive/2008/11/03/the-wpf-mindset.aspx)，它说明了 WPF 的强大功能，其中使用基本构造可以显示带有坐标的地图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-24T13:57:17.053

在 Python 中，您可以为此使用[Enthought Traits](http://code.enthought.com/projects/traits/)。您定义了一个模型，并且该模型已经包含所有知识和逻辑，因此您可以使用一行代码为其创建一个编辑器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-27T17:21:37.293

SWT / JFace，Eclipse 的 UI 层，最近扩展了 UI 数据绑定功能。请参阅[http://wiki.eclipse.org/index.php/JFace_Data_Binding](http://wiki.eclipse.org/index.php/JFace_Data_Binding)

# javascript - 你如何让 window.open 在 Internet Explorer 7 中工作？

> ID：459024
> 
> 赞同：5
> 
> 时间：2009-01-19T20:19:28.580
> 
> 标签：javascript, internet-explorer, internet-explorer-7, popup, window

在过去的 3 个小时里，我一直在尝试让我的 svg 网站打开弹出窗口，而我得到的只是 Internet Explorer 中的“权限被拒绝”错误。我已经尝试了所有可以在谷歌上找到的东西，但没有任何效果。我什至已经到了只调用没有参数的 window.open() 空白的地步，但仍然得到一个权限被拒绝的错误。目前在 Internet Explorer 中打开弹出窗口的公认标准是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-19T20:33:53.777

这是在 IE6 中所做的安全更改的一部分。现在您只能从用户发起的事件中调用“window.open”。例如，您的代码将在元素的 onclick 事件中运行。“ [window.open” MSDN 页面](http://msdn.microsoft.com/en-us/library/ms536651(VS.85).aspx)这样说：

> “此方法必须使用用户启动的操作，例如单击链接或切换到链接并按 Enter 键，以打开弹出窗口。Internet Explorer 6 中的弹出窗口阻止程序功能会阻止在未打开的情况下打开的窗口由用户发起。”

# java - 如何使用 JOD Converter 减少 Open Office Service 的时间响应以打印到 PDF？

> ID：459026
> 
> 赞同：2
> 
> 时间：2009-01-19T20:19:41.997
> 
> 标签：java, networking, pdf-generation, openoffice.org, jodconverter

我们目前正在使用[JOD Converter](http://www.artofsolving.com/opensource/jodconverter)将 word 文档发送到在另一台机器上运行的开放式办公服务。开放式办公室服务托管在一个设施中，如果他们保证 100 Mbps 带宽，我们有三台服务器打印到这台托管开放式办公室服务的服务器。

1.  亚马逊云服务器（暂存）大约需要 31.6 秒来生成一个 pdf 文档。
2.  托管设施（开发）大约需要 29.5 秒来生成 pdf。
3.  与开放式办公服务所在的设施（生产）相同，生成完全相同的 pdf 文档大约需要 5.5 秒。

但是延迟、延迟和带宽在质量方面都很好。我能做些什么来减少这个响应时间。看起来问题出在网络上，但我想有一种方法来衡量它是否是网络，这样我就可以记录这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-14T07:04:11.107

您如何将输入（word）文档提供给 OpenOffice？是否上传到OO服务器？您是否使用网络卷（NFS、SMB）作为放置区？

如果先传输文件，那么您使用的是什么？您的传输可能未优化。如果使用网络卷作为放置区域，那么在随机访问期间（例如 OO 读取输入文件），最轻微的网络延迟都会影响您；更改 NFS/SMB 客户端中的缓存参数可能会有所帮助，就像在转换之前将文件复制到本地卷一样。

# c# - 在 Windows 服务中获取计算机名称？

> ID：459034
> 
> 赞同：12
> 
> 时间：2009-01-19T20:22:47.733
> 
> 标签：c#, .net, windows-services

在 .NET Windows 服务 (C#) 中，如何获取计算机名称？

这是一种可靠的方法，还是应该将其包装在 try/catch 中？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-19T20:25:25.590

查看[环境类](http://msdn.microsoft.com/en-us/library/system.environment_properties(VS.80).aspx)。里面有很多好东西，包括[MachineName](http://msdn.microsoft.com/en-us/library/system.environment.machinename(VS.80).aspx)：

```
string CurrentMachineName = Environment.MachineName; 
```

根据文档，这可能会生成 InvalidOperationException，因此您需要注意这种可能性。不过，风险可能不保证将其包装在 try/catch 中。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-20T06:15:43.213

我认为首先您必须确定“计算机名称”的含义。

正如其他人所说，并且可能在 Windows 上“传统上”，您将使用该[`Environment.MachineName`](http://msdn.microsoft.com/en-us/library/system.environment.machinename.aspx)属性来获取*计算机的名称*，这实际上是机器的 NetBIOS 名称。另一种选择是机器的（完全限定的）DNS 名称。但是请注意，一台机器实际上可能有多个适配器/IP 地址/任何东西，因此有多个 DNS 名称。

考虑到对潜在`InvalidOperationException`的处理[`Environment.MachineName`](http://msdn.microsoft.com/en-us/library/system.environment.machinename.aspx)，我建议考虑一下如果遇到它，您实际上会做什么。如果有什么你可以做的，你可以而且当然应该抓住它。

例如，在我的一些代码中，我需要获取计算机名称（顺便说一句，也在服务中），但我只将它用于诊断目的。如果[`Environment.MachineName`](http://msdn.microsoft.com/en-us/library/system.environment.machinename.aspx)失败，我只`"(unknown)"`在诊断输出中使用一些字符串（并且还记录一次错误）。

如果结果对您的进一步处理至关重要，您可能也应该捕获异常，将事件写入 Windows 事件日志并“死亡”。

# c# - C#、Winforms 和 LINQ to SQL.. 数据上下文生命周期？

> ID：459046
> 
> 赞同：5
> 
> 时间：2009-01-19T20:28:00.827
> 
> 标签：c#, asp.net-mvc, winforms, linq, transactions

我们使用我们编写的企业框架来促进我们所做的各种公司特定工作。

在该框架内，我们提供了一个 LINQ to SQL ORM 以在适当的时候使用。所有这些都基于 Microsoft MVC 框架。在 MVC 方面，我们在基本控制器中新建了一个数据上下文。这为我们提供了完整的数据上下文生命周期，这对于事务非常有用。

我们希望完成的一项任务是提供 Winforms 支持。

但是，我正在努力寻找一种可以以类似方式适用于 Winforms 的方法。

鉴于 MVC 方法非常简单，因为一个页面加载代表一个逻辑事务，因此很难在 Winforms 方面提出解决方案。

有没有人做过类似的事情或有什么建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T21:16:42.193

如果您正在考虑在拥有长期 DataContext（例如作为应用程序中的单例）或拥有短期 DataContext 之间进行选择，我会选择第二个。我会为每个“工作单元”新建（）一个 DataContext，并确保它尽可能短地保持活动状态。创建一个新的 DataContext 不是一个大问题，因为它们无论如何都会缓存元数据。当它开始跟踪许多对象时，拥有一个长期存在的 DataContext 会给您带来一些噩梦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T21:07:37.360

我为我们去年构建的一些小软件做了类似的事情。

我们创建了一个加载表单的应用程序外壳，类似于请求/响应模型。

我用我为 web 和 windows 窗体实现的方法构建了一个`IRenderer`界面。`RenderView()`它允许我对两者使用相同的控制器和模型。在 goodle 上搜索 Model-View-ViewModel (MVVM)，您可能会发现一些关于这种方法的信息。

我认为[这篇文章](http://msdn.microsoft.com/en-us/library/cc707841.aspx)可以帮助你理解我在说什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T21:21:45.477

对所有内容只有一个数据上下文的问题在于，您不能有多个打开的编辑并且只能提交一个。对于许多应用程序模型来说，这是一个非首发。因此，我有一个用于读取的单例数据上下文，并为每个提交操作创建一个。更新函数将要保存的对象从读取的数据上下文中分离出来，并将它们附加到新的提交数据上下文中，然后运行 ​​DC.Submit 更改。

唯一棘手的事情是有一种方法来跟踪对象是否应该在提交时更新或在提交时插入，以及如果你有一个标准的自动 num 主键或在某个集合中管理某个列应该用作检查哪个插入与更新的类，这是很容易克服的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-17T19:09:13.560

我知道这个线程有点老了，但是在 unhaddins 中，我们有一个 Conversation-per-BusinessTransaction 的实现。目前我们只有一个 nhibernate 的实现，但是为 Linq to sql 或实体框架实现它应该很简单。[检查我在这个列表中](http://groups.google.com/group/nhusers/browse_thread/thread/d966815be48a1da1/a54121da177e12f5#a54121da177e12f5)的答案。

# c# - 使用 C# 和 Compact Framework 管理无线网络连接

> ID：459050
> 
> 赞同：3
> 
> 时间：2009-01-19T20:30:03.287
> 
> 标签：c#, compact-framework, wireless, smart-device-framework

标题有点概括——我需要能够以编程方式连接到已知的接入点（SSID 和凭据将在设备配置期间加载）。我知道 Compact Framework SDK 和 OpenNETCF SDK 都提供了一些帮助方法，但我似乎找不到关于如何使用它们的好教程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T20:52:14.647

OpenNETCF 的[智能设备框架](http://www.smartdeviceframework.com)可能是执行此操作的最简单的机制。无线的挑战在于无线电 OEM（无论是否是设备 OEM）可以选择多种方式来宣传接口。可能作为具有专有控件的普通 NDIS 设备（交互起来很痛苦），或者在另一端使用[无线零配置 (WZC)](http://msdn.microsoft.com/en-us/library/aa448301.aspx)。SDF 试图处理任何场景，根据硬件接口的广告提供越来越多的功能。

因此，如果您想使用启用 WZC 的接口添加首选网络（实际上唯一的连接方式是让网络位于首选列表中）并且该网络是开放的（不是 WEP、WPA 等），它是一个很简单的任务。事实上，WPA 甚至 TKIP 都非常简单。您只需调用[AddPreferredNetwork](http://www.opennetcf.com/library/sdf/html/616b978f-5bd6-51bb-62f8-3d2fa9dd681f.htm)。因此，您将调用[NetworkInterface.GetAllNetworkInterfaces](http://www.opennetcf.com/library/sdf/html/2dc21eda-47c6-fde5-e569-1781b1b44feb.htm)，然后迭代结果（或使用 LINQ 过滤）以获得 WirelessZeroConfigNetworkInterface 类型的适配器（是的，长名称），然后使用您的 SSID 和任何添加的信息（如关键材料。

当然，您也可以在没有 SDF 的情况下完成所有这些工作 - 通过 P/Invoke 所需的工作量要高得多。但它仍然以某种形式“记录在案”。我们所做的大部分工作是对 Windows CE 中网络对话框的“翻译”，它是 Platform Builder 中提供的完整源代码。

# javascript - 对于构建 HTML/JavaScript Air Apps 是否有任何好的指南、参考、设计模式或只是好的建议

> ID：459062
> 
> 赞同：1
> 
> 时间：2009-01-19T20:33:18.240
> 
> 标签：javascript, user-interface, air, design-patterns, ria

我目前正在为工作构建一个原型 AIR 应用程序。它允许我们的客户下载和使用他们的数据，然后在稍后与服务器同步。很标准的东西。

我是一位经验丰富的 Web 开发人员，因此我已经相当成功地将这个应用程序置于合理的演示状态，但在不久的将来，我必须让它准备好生产。为此，我需要对此类事情的最佳实践进行一些研究。

您可以提供的任何建议将不胜感激。我想听听

**架构**
我已经将我的应用程序组织成一个大致 MVC 模式，其中包含一个用于对象间通信的基本信号/插槽系统。这工作得很好，但我认为如果项目非常大，它可能会开始吱吱作响。
我有一个与数据库服务器通信的对象，另一个处理本地 SQLite 数据的对象。处理各种视图的对象，包括静态和动态 html。一个用于编组其他对象并处理流程的控制器和一个用于加载、存储和处理配置数据的小型配置对象。
这听起来合理吗？其他人做了什么？有没有好的演示/教程或好的参考资料？

**安全**
性我并没有真正花太多时间在安全性上，因为我们正处于原型阶段，但我全神贯注！我目前正在使用 CSV 来移动数据，但最终它将是 AMF over HTTPS。

 **我在 Linux 中开发的**分发和更新。**打包应用程序时会出现问题吗？Linux 上的 AIR 与 Windows 或 Mac 上的功能一样吗？我能否制作合适的安装程序/徽章？我能否使更新框架正常工作？
不过，总的来说，因为我没有那么远，所以使 .air 文件看起来很简单吗？在我的机器上工作就像一个魅力。**

 **我认为现在就足够了，除非有人发现我遗漏的东西。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T20:56:44.777

我已经非常成功地将 AIR 用于此类事情，并打算在 MVC 抽象级别与您融合。从我的一个 SO 问题中，我的注意力转向了[这个](http://mate.asfusion.com/)。也许你可以看一下，让我知道你的想法。在高层次上，它似乎与您对设计的描述一致。

我正在使用 AMF - 尝试从 JSON 开始，但 AMF 更直接，并且对于我的目的而言功能等效。

我的应用程序被几十个人在随机平台、Windows、Mac 和 Linux 上使用。安装无痛。我发布了一个安装包，Adobe 安装程序会确定所服务的平台需要哪些运行时内容，并确保在我不注意的情况下正确设置。它完全抽象出平台依赖性，并且没有学习曲线。

# php - MySQL/PHP 处理查询帮助

> ID：459065
> 
> 赞同：-1
> 
> 时间：2009-01-19T20:34:54.477
> 
> 标签：php, mysql

好的，我有两个要加入的表并对其进行选择以获取三个字段（时间戳、消息和 articleNum）。现在，这些数据基本上是一篇文章创建和修改时间的日志，我必须编写逻辑来处理我返回的这三个字段。为了弄清楚一篇文章最后创建和/或修改的时间，我需要查看消息并查找关键字（“已添加”表示已创建，“更新”表示已修改）。我将查询的结果返回到一个 assoc 数组中，我最终希望将最终结果放在一个 assoc 数组中，其中 articleNum 是键，两个值数组（创建、修改）是键。有时，并不总是有修改的值，但总会有一个创建的。关于我如何开始这样的问题的任何想法？

**编辑** 据我所知，日期似乎以 Unix 秒为单位存储为 bigint。澄清：创建和修改的值不是表中的字段，我需要从消息字段中弄清楚。总会有一个额外的时间，但有时可能会有 0 条或更多条更新的消息，我需要找出最新的消息。

**编辑 2** 好的，很抱歉问题的措辞。再看这个问题后，我意识到我可以在两个 SQL 语句中完成这一切。为了找到我使用的添加日期：

```
"SELECT MIN(action_logs.time_added), article.number
 FROM action_logs
 JOIN proposal ON action_logs.article_num = article.number
 WHERE action_logs.message LIKE '%added%'
 GROUP BY article.number" 
```

可能对上次修改做同样的事情，除了 MAX。不过感谢您的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T20:49:18.053

这是一个措辞不佳的问题。有点[这个味道](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx "这")

两张表是什么？什么是消息字段？大概是事件？

为什么不在文章表中“创建”和“更新”？

你确定你的设计是合理的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T20:38:19.353

不确定我理解这个问题..

您想查看消息并提取创建时间和修改时间吗？

如果是这样，日期/时间格式是什么？使用正则表达式应该很容易找到该信息。

伊恩

**编辑**-

如果您想从查询得到的消息中提取它们，那么正则表达式可能是完成此任务的候选者。

发布示例消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T20:39:57.493

尝试这样的事情：

```
$articles = array();
while ($row = mysql_fetch_assoc($result)) {
    $articles[$row['articleId']] = array(
        'created'  => $row['created'],
        'modified' => $row['modified']
    );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T20:40:59.037

我在这里做一些假设：

如果您的表为每条消息（添加/更新）存储一行，那么此查询将返回每篇文章一行，其中包含您需要的列（articleNum、Created、Updated）：

```
SELECT 
  A.articleNum, 
  MCreated.Timestamp AS Created, 
  MUpdated.Timestamp Updated
FROM Articles A
JOIN Messages MCreated 
  ON MCreated.articleNum = A.articleNum
  AND MCreated.Message = 'added'
LEFT JOIN Messages MUpdated
  ON MUpdated.articleNum = A.articleNum
  AND MUpdated.Message = 'updated' 
```

# c# - c#如何让我的gif动画在picturebox中循环

> ID：459074
> 
> 赞同：3
> 
> 时间：2009-01-19T20:38:50.633
> 
> 标签：c#, picturebox

我已将动画 GIF 作为资源导入图片框 - 不幸的是，它只播放到结束帧并且从不重复。如果有什么我可以做的让它不断循环。gif 是我的“请稍候忙碌箱”

布拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T21:00:31.867

动画 GIF 有几个不同的设置。通常，文件中嵌入了一些数据，告诉渲染器应该如何显示图像。

该数据表示图像动画的速度，是否应该无限循环，或者应该重复多少次。

有[几个](http://www.jhepple.com/gif_animator.htm)程序[可](http://www.gimp.org/)用于编辑动画 GIF 和更改循环设置。

首先，我会在某个应用程序中打开您的 GIF 以预览它，以查看它是否在尝试更改图像之前循环播放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-03T16:25:25.490

您可以使用[System.Drawing.ImageAnimator](http://msdn.microsoft.com/en-us/library/system.drawing.imageanimator.aspx)类助手。您可以使用 Animate、UpdateFrames 和 StopAnimate 方法来控制循环。

# c# - 如何存储和搜索 IP 地址

> ID：459076
> 
> 赞同：3
> 
> 时间：2009-01-19T20:39:13.610
> 
> 标签：c#, sql-server, data-structures, ip-address

我有 4 个 IP 地址来源，我想将它们存储在 SQL Server 中，并允许按国家/地区在排除列表中创建可以按原始国家代码分类的范围。

为此，我有 2 张桌子。

IPAddressRange 国家代码

我需要知道的是，如果将此数据返回给客户端然后缓存以进行快速查询，那么存储返回的数据以查询范围内的特定 IP 地址的最佳方法是什么。我想知道提供的 IP 地址是否在列表中。

列表在数据库中的原因是为了便于存储。

我想缓存然后使用客户端上的数据的原因是我听说在 trie 结构中搜索 IP 地址更快。所以，我想我需要从 db 中获取列表，并以一种非常快速搜索的结构存储在缓存中。

A) 存储地址的 SQL 结构和 b) 搜索 IP 地址的代码中的任何帮助。

我知道一个代码项目解决方案，它有一个用于搜索的代码算法，不确定如何将它与存储方面混合。

理想情况下不使用第三方库。代码必须在我们自己的服务器上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T21:13:36.583

我已经按照您的描述按国家/地区进行了过滤。

但是，经过一段时间的试验，我发现用 SQL 无法以高性能的方式完成。[这就是为什么像这个](http://www.maxmind.com/app/geolitecity)（我正在使用的）这样的 IP 数据库提供二进制数据库的原因，它的速度**要**快得多，因为它针对这种数据进行了优化。

他们甚至明确地说：

> 请注意，对导入 SQL 数据库的 CSV 数据进行查询可能需要几秒钟。如果性能是一个问题，二进制格式要快得多，并且每秒可以处理数千次查找。

此外，他们甚至为您提供查询此数据库[的代码。](http://www.maxmind.com/app/csharp)

我在流量中等的生产网站中使用它，过滤每个请求，没有性能问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:45:31.977

假设您的 IP 地址是 IPV4，您可以将它们存储在一个整数字段中。创建 2 个字段，一个用于范围的下限，另一个用于上限。然后确保这些字段被索引。搜索值时，只搜索值大于或等于下限，小于或等于上限的地方。在尝试自己编写更复杂的东西之前，我会先尝试这样简单的东西，但这实际上并没有明显更快的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T20:44:36.830

IPv4 地址可以存储为四字节无符号整数（C# 中的 uint）。IPv6 地址可以是八字节无符号整数（C# 中的 ulong）。在 SQL 中创建适当宽度的列，然后检索它们并将它们存储在变量中。然后，您使用简单的整数数学来检查您想要的范围，假设范围实际上是连续的。

一个更复杂的解决方案是创建一个 IPAddress 类，让您可以访问更熟悉的点四边形结构，但在幕后它会做与您在这里完全相同的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T20:45:10.743

我从来没有尝试过这个，所以我的回答要持保留态度，但我认为 trie 实际上并不是你想要的，除非你打算存储你想要阻止的每个 IP（而不是范围或子网/掩码） . 我认为 btree 会更适合，在这种情况下，请继续使用您的常规数据库（许多数据库是使用 btree 或同样好的数据结构实现的）。我会将 IP 的 4 个字节中的每一个存储在一个单独的列中，以帮助按“不关心”值等于 NULL 的 A/B/C 类子网进行搜索，但是没有理由不能存储它作为一个 32 位整数列并计算数字以找出它应该落入的范围（在这种情况下存储屏蔽值会稍微棘手一些）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T21:31:21.853

> IPv6 地址可以是八字节无符号整数（C# 中的 ulong）

IPv6 地址是 128 位（16 字节）而不是建议的 8。我现在正在努力解决 IP 范围的这个问题。

我希望尝试填充或十六进制字符串，然后进行 < 和 > 比较

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T21:49:38.040

只要您将 IPv4 起始地址存储在正确的数据类型中，您就可以有效地做到这一点。varchar（或其他字符串类型）不正确 - 您需要使用 int。

对于 IPv4，将 IP 号码存储在一个足够大的无符号中，然后将其存储为 INET_ATON 格式（这很容易生成；我不确定在 C# 中如何，但并不难）。

然后，您可以通过安排数据库进行范围扫描，轻松有效地查找 IP 地址属于哪个范围。

通过使用 LIMIT（或 MSSQL 中的 SELECT TOP 1），您可以让它在找到记录后停止。

```
SELECT TOP 1 networkidorwhatever, IPNumber, IPNumberUpperBoundOrWhateverYouCallIt 
FROM networks 
WHERE IPNumber <= IPNUMBERTOQUERY ORDER BY IPNumber DESC 
```

应该找到编号最高的网络号 <= IP 号，然后确定该 IP 地址是否在其中是一个简单的检查。

如果在 IPNumber 上有一个常规索引，它应该是有效的。

IPv6的类型不同，但原理是一样的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T02:36:18.647

对于 IPv4，DBA 通常会推荐 4 个 tinyint 字段，但您正在做范围，这更适合以前提供的整数存储解决方案。在这种情况下，您将存储该范围的起始 IP 地址和结束 IP 地址。那么进行比较就很简单了。

# sql-server - SSRS 2005 中矩形的条件可见性和分页符问题

> ID：459078
> 
> 赞同：2
> 
> 时间：2009-01-19T20:39:40.617
> 
> 标签：sql-server, sql-server-2005, reporting-services, conditional, visibility

我正在尝试插入有条件的分页符，实际上我有一份包含 50 页发票的报告，每张发票有 3 页长，所以我需要第二张发票的分页符打印在下一页上，因为我需要整个报告打印回返回，所以我插入了一个分页符，所以这会开始下一张发票，从第 4 页开始，但我希望下一张发票从第 5 页开始，这是一个新页面，如果上一个报告的第 3 页不是，我在那里插入另一个分页符已填写，但如果已填写第 3 页并且发票继续到第 4 页，则我不需要此额外的分页符

我尝试通过取两个矩形来实现这一点——首先是在末尾带有惰性分页符——第二个是矩形2的条件可见性和在开始时带有分页符。并且矩形2可见的条件就像

可见性---隐藏和表达式为--iif(count(第三页表的id字段)>=24,true,false)

即第 3 页最多容纳 24 条记录，如果记录超过 24 条，我不需要另一个分页符，并且只有在记录少于 24 条时我才隐藏矩形 2，我需要另一个分页符，我没有隐藏矩形 2

但能见度不起作用，矩形 2 不起作用。

请在这件事上给予我帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T12:33:00.723

您应该能够向数据源添加一列，例如 InvoiceNumber，您可以将其定义为分页组。然后页面应该在新发票之前和每个矩形的末尾断开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T03:10:03.087

这是 SSRS 2005 的一个已知问题。实际上非常不幸。看看[我的问题在这里](https://stackoverflow.com/questions/8439/conditional-visibility-and-page-breaks-with-sql-server-2005-reporting-services)。

# python - 你如何在 Tkinter 的事件循环中运行你自己的代码？

> ID：459083
> 
> 赞同：144
> 
> 时间：2009-01-19T20:40:39.660
> 
> 标签：python, events, tkinter

我的小弟弟刚刚开始​​编程，为了他的科学博览会项目，他正在模拟天空中的一群鸟。他已经编写了大部分代码，并且运行良好，但是鸟儿需要*每时每刻都*在移动。

然而，Tkinter 为自己的事件循环占用了时间，因此他的代码不会运行。运行`root.mainloop()`，运行，并保持运行，它运行的唯一东西是事件处理程序。

有没有办法让他的代码在主循环旁边运行（没有多线程，这很混乱，应该保持简单），如果是这样，它是什么？

现在，他想出了一个丑陋的技巧，将他的`move()`功能绑定到`<b1-motion>`，这样只要他按住按钮并摆动鼠标，它就可以工作。但必须有更好的方法。

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-01-19T20:55:36.543

在对象上使用`after`方法`Tk`：

```
from tkinter import *

root = Tk()

def task():
    print("hello")
    root.after(2000, task)  # reschedule event in 2 seconds

root.after(2000, task)
root.mainloop() 
```

这是该方法的声明和文档`after`：

```
def after(self, ms, func=None, *args):
    """Call function once after given time.

    MS specifies the time in milliseconds. FUNC gives the
    function which shall be called. Additional parameters
    are given as parameters to the function call.  Return
    identifier to cancel scheduling with after_cancel.""" 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-12-02T18:55:46.127

[Bjorn 发布](https://stackoverflow.com/a/538559/355230)的解决方案导致我的计算机（RedHat Enterprise 5，python 2.6.1）上出现“RuntimeError: Calling Tcl from different appartment”消息。Bjorn 可能没有收到此消息，因为根据[我检查的一个地方](http://www.mail-archive.com/tkinter-discuss@python.org/msg01808.html)，使用 Tkinter 错误处理线程是不可预测的并且依赖于平台。

问题似乎是`app.start()`对 Tk 的引用，因为 app 包含 Tk 元素。我通过用 inside 替换来解决`app.start()`这个`self.start()`问题`__init__`。我还这样做了，以便所有 Tk 引用要么在*调用的函数内，要么在`mainloop()`**被调用*的函数调用的函数内`mainloop()`（这显然对于避免“不同的公寓”错误至关重要）。

最后，我添加了一个带有回调的协议处理程序，因为如果没有这个，当用户关闭 Tk 窗口时程序会退出并出现错误。

修改后的代码如下：

```
# Run tkinter code in another thread

import tkinter as tk
import threading

class App(threading.Thread):

    def __init__(self):
        threading.Thread.__init__(self)
        self.start()

    def callback(self):
        self.root.quit()

    def run(self):
        self.root = tk.Tk()
        self.root.protocol("WM_DELETE_WINDOW", self.callback)

        label = tk.Label(self.root, text="Hello World")
        label.pack()

        self.root.mainloop()

app = App()
print('Now we can continue running code while mainloop runs!')

for i in range(100000):
    print(i) 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2011-01-29T09:35:20.837

在编写自己的循环时，如在模拟中（我假设），您需要调用执行以下操作的`update`函数`mainloop`：使用您的更改更新窗口，但您在循环中执行此操作。

```
def task():
   # do something
   root.update()

while 1:
   task() 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-11T20:14:55.167

另一种选择是让 tkinter 在单独的线程上执行。一种方法是这样的：

```
import Tkinter
import threading

class MyTkApp(threading.Thread):
    def __init__(self):
        self.root=Tkinter.Tk()
        self.s = Tkinter.StringVar()
        self.s.set('Foo')
        l = Tkinter.Label(self.root,textvariable=self.s)
        l.pack()
        threading.Thread.__init__(self)

    def run(self):
        self.root.mainloop()

app = MyTkApp()
app.start()

# Now the app should be running and the value shown on the label
# can be changed by changing the member variable s.
# Like this:
# app.s.set('Bar') 
```

不过要小心，多线程编程很困难，而且很容易让自己陷入困境。例如，当您更改上面示例类的成员变量时必须小心，以免中断 Tkinter 的事件循环。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-10-25T07:12:18.297

这是 GPS 阅读器和数据展示器的第一个工作版本。tkinter 是一个非常脆弱的东西，错误消息太少了。它不会把东西放上去，也不会说明为什么很多时候。来自优秀的 WYSIWYG 表单开发人员非常困难。无论如何，它每秒运行 10 次小程序，并在表单上显示信息。花了一段时间才实现。当我尝试将计时器值设为 0 时，表单从未出现过。我现在头疼！每秒 10 次或更多次对我来说已经足够了。我希望它可以帮助别人。迈克·莫罗

```
import tkinter as tk
import time

def GetDateTime():
  # Get current date and time in ISO8601
  # https://en.wikipedia.org/wiki/ISO_8601 
  # https://xkcd.com/1179/
  return (time.strftime("%Y%m%d", time.gmtime()),
          time.strftime("%H%M%S", time.gmtime()),
          time.strftime("%Y%m%d", time.localtime()),
          time.strftime("%H%M%S", time.localtime()))

class Application(tk.Frame):

  def __init__(self, master):

    fontsize = 12
    textwidth = 9

    tk.Frame.__init__(self, master)
    self.pack()

    tk.Label(self, font=('Helvetica', fontsize), bg = '#be004e', fg = 'white', width = textwidth,
             text='Local Time').grid(row=0, column=0)
    self.LocalDate = tk.StringVar()
    self.LocalDate.set('waiting...')
    tk.Label(self, font=('Helvetica', fontsize), bg = '#be004e', fg = 'white', width = textwidth,
             textvariable=self.LocalDate).grid(row=0, column=1)

    tk.Label(self, font=('Helvetica', fontsize), bg = '#be004e', fg = 'white', width = textwidth,
             text='Local Date').grid(row=1, column=0)
    self.LocalTime = tk.StringVar()
    self.LocalTime.set('waiting...')
    tk.Label(self, font=('Helvetica', fontsize), bg = '#be004e', fg = 'white', width = textwidth,
             textvariable=self.LocalTime).grid(row=1, column=1)

    tk.Label(self, font=('Helvetica', fontsize), bg = '#40CCC0', fg = 'white', width = textwidth,
             text='GMT Time').grid(row=2, column=0)
    self.nowGdate = tk.StringVar()
    self.nowGdate.set('waiting...')
    tk.Label(self, font=('Helvetica', fontsize), bg = '#40CCC0', fg = 'white', width = textwidth,
             textvariable=self.nowGdate).grid(row=2, column=1)

    tk.Label(self, font=('Helvetica', fontsize), bg = '#40CCC0', fg = 'white', width = textwidth,
             text='GMT Date').grid(row=3, column=0)
    self.nowGtime = tk.StringVar()
    self.nowGtime.set('waiting...')
    tk.Label(self, font=('Helvetica', fontsize), bg = '#40CCC0', fg = 'white', width = textwidth,
             textvariable=self.nowGtime).grid(row=3, column=1)

    tk.Button(self, text='Exit', width = 10, bg = '#FF8080', command=root.destroy).grid(row=4, columnspan=2)

    self.gettime()
  pass

  def gettime(self):
    gdt, gtm, ldt, ltm = GetDateTime()
    gdt = gdt[0:4] + '/' + gdt[4:6] + '/' + gdt[6:8]
    gtm = gtm[0:2] + ':' + gtm[2:4] + ':' + gtm[4:6] + ' Z'  
    ldt = ldt[0:4] + '/' + ldt[4:6] + '/' + ldt[6:8]
    ltm = ltm[0:2] + ':' + ltm[2:4] + ':' + ltm[4:6]  
    self.nowGtime.set(gdt)
    self.nowGdate.set(gtm)
    self.LocalTime.set(ldt)
    self.LocalDate.set(ltm)

    self.after(100, self.gettime)
   #print (ltm)  # Prove it is running this and the external code, too.
  pass

root = tk.Tk()
root.wm_title('Temp Converter')
app = Application(master=root)

w = 200 # width for the Tk root
h = 125 # height for the Tk root

# get display screen width and height
ws = root.winfo_screenwidth()  # width of the screen
hs = root.winfo_screenheight() # height of the screen

# calculate x and y coordinates for positioning the Tk root window

#centered
#x = (ws/2) - (w/2)
#y = (hs/2) - (h/2)

#right bottom corner (misfires in Win10 putting it too low. OK in Ubuntu)
x = ws - w
y = hs - h - 35  # -35 fixes it, more or less, for Win10

#set the dimensions of the screen and where it is placed
root.geometry('%dx%d+%d+%d' % (w, h, x, y))

root.mainloop() 
```

# winapi - 可能有一个鼠标点击通过它的窗口？

> ID：459084
> 
> 赞同：1
> 
> 时间：2009-01-19T20:40:52.580
> 
> 标签：winapi

在 Microsoft Windows 上，是否可以单击窗口（所有鼠标单击都将直接通过），类似于 WS_EX_TRANSPARENT，而没有 WS_EX_TRANSPARENT 的重绘问题？

我说的不是分层窗口，而是一个完全不透明的窗口，所有的点击都会进入下面的项目。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T03:38:21.983

处理 WM_NCHITTEST 并返回 HTTRANSPARENT

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T03:47:24.363

此外，SetLayeredAttribute 可以终止鼠标事件。

# asp.net-mvc - 在 ASP.NET MVC 中使用 ASP.NET Web 窗体 UserControl？

> ID：459093
> 
> 赞同：6
> 
> 时间：2009-01-19T20:43:51.310
> 
> 标签：asp.net-mvc

我的任务是制作一个原型 Web 应用程序，我正在争论使用 ASP.NET WebForms 还是新的 ASP.NET MVC。

有一个我想使用的商业 ASP.NET UserControl，它为我提供了我需要的 95% 的功能（并且它以 AJAX-y 方式实现）。但我听说由于 ASP.NET MVC 不使用 ViewState，它无法运行这些基于 WebForms 的控件。

那么，这是真的还是假的？

我真的很想使用这个商业用户控件，但如果可以的话，我想使用 ASP.NET MVC，并且只有在尝试使用基于 WebForms 的控件时 ASP.NET MVC 不会给我带来太多麻烦的情况下。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T21:03:04.670

传统的 WebForms 和 MVC 并不是相互排斥的。您可以在同一个站点中同时运行它们。有关如何实现这一点的解释，请参阅[Scott Hanselman](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)的这篇文章。

因此，例如，您可以创建基于 WebForms 的页面来利用商业控制​​，并将 MVC 用于其他一切。您还可以设置一个简单的测试，以查看控件是否可以在没有 ViewState 的情况下运行（使其可以在 MVC 中使用）并回退到混合方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T20:45:24.723

它可能行不通。没有大多数商业控件以某种方式依赖的视图状态、回发（在 Webforms 意义上）或页面生命周期。

# c# - 在 Linq 2 xml 方面需要一点帮助

> ID：459103
> 
> 赞同：1
> 
> 时间：2009-01-19T20:46:35.267
> 
> 标签：c#, xml, linq-to-xml, xelement

我有一个与此类似的场景：

```
public class TestLinq2Xml
{
  private XElement GenerateSomeXml()
  {
     return XElement.Parse(@"<MyObject>
                                <Properties>
                                   <Name>My object 1</Name>
                                   <Position>0; 0; 0</Position>
                                </Properties>
                             </MyObject>");
  }

public void ExploreXmlNode()
{
  var xmlTree = this.GenerateSomeXml();

  var name = xmlTree.Element("MyObject").Element("Properties").Element("Name").Value;

  Console.WriteLine(name);
} 
```

}

好的，这非常简化。....但它仍然无法正常工作。关于我在这里做错了什么的任何想法？

编辑：

哦，差点忘了。问题是`xmlTree.Element("MyObject")`返回一个空的 linq 序列。即使我清楚地有一个名为“MyObject”的节点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T20:52:35.300

XElement.Parse 返回一个 XElement，它是`<MyObject>`节点。尝试：-

var name = xmlTree.Element("Properties").Element("Name").Value;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T21:11:20.537

除了上一张海报的建议之外，您还可以从 GenerateSomeXml() 函数返回一个 XDocument，以便您的 linq 工作。

```
 private static XDocument GenerateSomeXml()
    {
        return XDocument.Parse(@"<MyObject>
                            <Properties>
                               <Name>My object 1</Name>
                               <Position>0; 0; 0</Position>
                            </Properties>
                         </MyObject>");
    } 
```

# javascript - 将多维javascript数组转换为JSON？

> ID：459105
> 
> 赞同：41
> 
> 时间：2009-01-19T20:47:20.570
> 
> 标签：javascript, arrays, json

将多维 javascript 数组转换为 JSON 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-19T21:01:41.973

大多数流行的 JavaScript 框架都包含 JSON 实用程序函数。例如，jQuery 有一个直接调用 url 并将 JSON 结果作为对象加载的函数：http: [//docs.jquery.com/Getjson](http://docs.jquery.com/Getjson)

[但是，您可以从json 网站](http://www.json.org)获取开源 JSON 解析器和字符串化程序：

[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

然后，只需包含代码并在数组上使用 JSON.stringify() 方法。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-12-28T21:41:28.773

其他海报提供了“最佳”方式。如果您不需要引用库的完整编码功能，而只需要对简单数组进行编码，请尝试以下操作：

```
<!DOCTYPE html>
<html>
<head>
<title>Simple functions for encoding Javascript arrays into JSON</title>
<script type="text/javascript">

window.onload = function() {
  var a = [
    [0, 1, '2', 3],
    ['0', '1', 2],
    [],
    ['mf', 'cb']
  ],
  b = [
    0, '1', '2', 3, 'woohoo!'
  ];
  alert(array2dToJson(a, 'a', '\n'));
  alert(array1dToJson(b, 'b'));
};

function array2dToJson(a, p, nl) {
  var i, j, s = '{"' + p + '":[';
  nl = nl || '';
  for (i = 0; i < a.length; ++i) {
    s += nl + array1dToJson(a[i]);
    if (i < a.length - 1) {
      s += ',';
    }
  }
  s += nl + ']}';
  return s;
}

function array1dToJson(a, p) {
  var i, s = '[';
  for (i = 0; i < a.length; ++i) {
    if (typeof a[i] == 'string') {
      s += '"' + a[i] + '"';
    }
    else { // assume number type
      s += a[i];
    }
    if (i < a.length - 1) {
      s += ',';
    }
  }
  s += ']';
  if (p) {
    return '{"' + p + '":' + s + '}';
  }
  return s;
}

</script>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T17:17:49.970

不确定我是否完全理解您的问题，但如果您尝试将对象转换为 JSON 字符串，那么您可能希望查看所有新浏览器中的原生 JSON 支持。这是 Resig 的[帖子](http://ejohn.org/blog/the-state-of-json/)。对于尚不支持它的浏览器，请尝试[json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)库。JSON.stringify(obj) 会将您的对象转换为 JSON 字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-03T13:50:35.087

这将转换对象内的所有数组组合，反之亦然，包括函数名称：

```
function isArray(a){var g=a.constructor.toString();
   if(g.match(/function Array()/)){return true;}else{return false;}
}
function objtostring(o){var a,k,f,freg=[],txt; if(typeof o!='object'){return false;}
   if(isArray(o)){a={'t1':'[','t2':']','isarray':true}
   }else         {a={'t1':'{','t2':'}','isarray':false}}; txt=a.t1;
   for(k in o){
           if(!a.isarray)txt+="'"+k+"':";
           if(typeof o[k]=='string'){txt+="'"+o[k]+"',";
           }else if(typeof o[k]=='number'||typeof o[k]=='boolean'){txt+=o[k]+",";
           }else if(typeof o[k]=='function'){f=o[k].toString();freg=f.match(/^function\s+(\w+)\s*\(/);
               if(freg){txt+=freg[1]+",";}else{txt+=f+",";};
           }else if(typeof o[k]=='object'){txt+=objtostring(o[k])+",";
           }
   }return txt.substr(0,txt.length-1)+a.t2;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T20:54:59.367

你可以使用[这个库](http://www.devpro.it/JSON/files/JSON-js.html)的编码功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-28T14:21:26.033

我对之前提供的代码进行了一些修改......因为 JSON 具有以下格式：`[{"object":{"property_1":"value_1","property_2":"value_2"}}]`

所以，代码将是......

```
<!DOCTYPE html>
<html>
<head>
    <title>Simple functions for encoding Javascript arrays into JSON</title>
    <script type="text/javascript">

    window.onload = function(){
      var a = [['property_1','value_1'],['property_2', 'value_2']];
      alert("Comienzo..., paso ////"+a+"\\\\\\ a formato JSON");
      var jsonSerialized = array2dToJson(a, 'object');
      alert(jsonSerialized);
    };

    // Estructura de JSON [{"object":{"property_1":"value_1","property_2":"value_2"}}]

    function array2dToJson(a, p, nl) {
      var i, j, s = '[{"' + p + '":{';
      nl = nl || '';
      for (i = 0; i < a.length; ++i) {
        s += nl + array1dToJson(a[i]);
        if (i < a.length - 1) {
          s += ',';
        }
      }
      s += nl + '}}]';
      return s;
    }

    function array1dToJson(a, p) {
      var i, s = '';
      for (i = 0; i < a.length; ++i) {
        if (typeof a[i] == 'string') {
          s += '"' + a[i] + '"';
        }
        else { // assume number type
          s += a[i];
        }
        if (i < a.length - 1) {
          s += ':';
        }
      }
      s += '';
      if (p) {
        return '{"' + p + '":' + s + '}';
      }
      return s;
    }

    </script>
</head>
<body>
    <h1>Convertir un Array a JSON...</h1>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-27T17:14:54.290

```
var t = {}

for(var i=0;i<3;i++) {
    var _main = {};
    var _dis = {}
    var _check = {};

    _main["title"] = 'test';
    _main["category"] = 'testing';
    _dis[0] = '';
    _dis[1] = '';
    _dis[2] = '';
    _dis[3] = '';
    _check[0] = 'checked';
    _check[1] = 'checked';
    _check[2] = 'checked';
    _check[3] = 'checked';
    _main['values'] = _check;
    _main['disabled'] = _dis;
    t[i] = _main;
}

alert(JSON.stringify(t)); 
```

试试这个

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-21T09:29:23.980

使用此代码并非常简单地开发更多两个数组

```
function getJSON(arrayID,arrayText) {    
    var JSON = "[";
    //should arrayID length equal arrayText lenght and both against null
    if (arrayID != null && arrayText != null && arrayID.length == arrayText.length) {
        for (var i = 0; i < arrayID.length; i++) {
            JSON += "{";
            JSON += "text:'" + arrayText[i] + "',";
            JSON += "id:'" + arrayID[i] + "'";
            JSON += "},";
        }
    }
    JSON += "]"
    JSON = Function("return " + JSON + " ;");
    return JSON();
} 
```

和 3 个数组

```
function getJSON(arrayID, arrayText, arrayNumber) {
    var JSON = "[";  
    if (arrayID != null && arrayText != null && arrayNumber!=null && Math.min(arrayNumber.length,arrayID.length)==arrayText.length) {
        for (var i = 0; i < arrayID.length; i++) {
            JSON += "{";
            JSON += "text:'" + arrayText[i] + "',";
            JSON += "id:'" + arrayID[i] + "',";
            JSON += "number:'" + arrayNumber[i] + "'";
            JSON += "},";
        }
    }
    JSON += "]"
    JSON = Function("return " + JSON + " ;");
    return JSON();
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-09-05T22:30:36.480

JavaScript 将正确编码一个对象：

```
var a = new Object;
var a = {}; 
```

JavaScript*不会对**数组*进行编码：

```
var a = new Array();
var a = []; 
```

# .net - .NET 编组速度

> ID：459107
> 
> 赞同：3
> 
> 时间：2009-01-19T20:48:50.690
> 
> 标签：.net, c++, performance, pinvoke, marshalling

我有一个 C++ 方法签名，如下所示：

```
 static extern void ImageProcessing(
        [MarshalAs(UnmanagedType.LPArray)]ushort[] inImage,
        [MarshalAs(UnmanagedType.LPArray)]ushort[] outImage,
        int inYSize, int inXSize); 
```

我已经将该函数包装在内部和外部的计时方法中。在内部，该函数以 0.24s 运行。在外部，该函数运行时间为 2.8 秒，或慢了大约 12 倍。这是怎么回事？编组让我慢了这么多吗？如果是，我该如何解决？我应该去不安全的代码并使用指针还是什么？我对额外的时间成本从何而来感到困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T20:54:47.137

看看[这篇文章](http://community.opennetcf.com/articles/cf/archive/2008/01/31/performance-implications-of-crossing-the-p-invoke-boundary.aspx)。虽然它的重点是紧凑框架，但一般原则也适用于桌面。分析部分的相关引用如下：

> 托管调用不直接调用本机方法。相反，它调用 JITted 存根方法，该方法必须执行一些开销例程，例如调用以确定 GC 抢占状态（以确定 GC 是否处于挂起状态并且我们需要等待）。也有可能一些编组代码也会被 JITted 到存根中。这一切都需要时间。

**编辑**：同样值得一读的是[这篇关于 JITted 代码性能的博客文章](http://blog.opennetcf.com/ctacke/binary/JITtedCodeSpeed.htm)——同样，CF 特定，但仍然相关。还有[一篇文章介绍了调用堆栈深度及其对 perf 的影响](http://blog.opennetcf.com/ctacke/2006/08/25/SpeedOfManagedCodeActII.aspx)，尽管这篇文章可能是特定于 CF 的（未在桌面上测试过）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T21:06:01.483

您是否尝试过将两个数组参数切换为 IntPtr？当编组签名中的所有类型都是 blittable 时，PInvoke 绝对是最快的。这意味着 Pinvoke 可以归结为一个简单的 memcpy 来来回获取数据。

在我的团队中，我们发现管理 PInvoke 层的最高效方法是

1.  保证 Marshall'd 的所有内容都是 blittable
2.  通过根据需要操作 IntPtr 类来为手动编组类型（例如数组）付出代价。这非常简单，因为我们有许多包装方法/类。

与任何“这会更快”的答案一样，您需要分析这是您自己的代码库。我们只是在考虑和分析了几种方法后才得出这个解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T22:55:26.487

可悲的是，答案比这些建议要平凡得多，尽管它们确实有帮助。基本上，我搞砸了我的计时方式。

我使用的计时代码是这样的：

```
Ipp32s timer;
ippGetCpuFreqMhz(&timer);
Ipp64u globalStart = ippGetCpuClocks();
globalStart = ippGetCpuClocks() *2 - globalStart; //use this method to get rid of the overhead of getting clock ticks

      //do some stuff

Ipp64u globalEnd = ippGetCpuClocks(); 
globalEnd = ippGetCpuClocks() *2 - globalEnd;
std::cout << "total runtime: " << ((Ipp64f)globalEnd - (Ipp64f)globalStart)/((Ipp64f)timer *1000000.0f) << " seconds" << std::endl; 
```

此代码特定于英特尔编译器，旨在提供极其精确的时间测量。不幸的是，这种极高的精度意味着每次运行的成本约为 2.5 秒。删除时序代码消除了该时间限制。

不过，运行时间似乎仍然存在延迟——代码将报告 0.24 s 与该计时代码，现在报告大约 0.35 秒的时间，这意味着大约有 50% 的速度成本。

将代码更改为：

```
 static extern void ImageProcessing(
     IntPtr inImage, //[MarshalAs(UnmanagedType.LPArray)]ushort[] inImage,
     IntPtr outImage, //[MarshalAs(UnmanagedType.LPArray)]ushort[] outImage,
     int inYSize, int inXSize); 
```

并称为：

```
 unsafe {
            fixed (ushort* inImagePtr = theInputImage.DataArray){
                fixed (ushort* outImagePtr = theResult){
                    ImageProcessing((IntPtr)inImagePtr,//theInputImage.DataArray,
                        (IntPtr)outImagePtr,//theResult,
                        ysize,
                        xsize);
                }
            }
        } 
```

将可执行时间降至 0.3 秒（三次运行的平均值）。对于我的口味来说仍然太慢了，但是 10 倍的速度提升肯定在我老板可以接受的范围内。

# iphone - 图像上的 Quartz 2D/OpenGLES 几何失真（最好使用 CGImage）

> ID：459108
> 
> 赞同：4
> 
> 时间：2009-01-19T20:49:10.707
> 
> 标签：iphone, image, filter, opengl-es, quartz-graphics

实现捏/鱼眼/等几何扭曲的首选方法是什么？使用 iPhone SDK？我知道 OSX 的核心图像库内置了所有这些类型的过滤器，但不适用于 iPhone SDK。

给定原始源位图数据，我可以在特定位置和半径处创建置换贴图，但我不确定如何将此位图数据应用为我的 CGImage 上的转换。

这不是仿射变换，因为线在失真/等区域周围不再平行。

是否可以使用 CGImage 或者我需要使用 OpenGLES 来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:00:14.740

实际上，Flash 8 的 DisplacementMapFilter 条目描述了给定由像素 component(x,y) 组成的置换贴图的一般置换贴图转换，如下所示：

dstPixel[x, y] = srcPixel[ x + ((componentX(x, y) - 128) * scaleX) / 256, y + ((componentY(x, y) - 128) * scaleY) / 256 ]

# wpf - VB.NET 中的 XDocument 类

> ID：459117
> 
> 赞同：0
> 
> 时间：2009-01-19T20:51:22.200
> 
> 标签：wpf, xml, vb.net, silverlight

我正在自学 Silverlight 和 WPF 以扩展我的编程基础。我正在关注[本教程](http://weblogs.asp.net/scottgu/pages/silverlight-tutorial-part-1-creating-quot-hello-world-quot-with-silverlight-2-and-vs-2008.aspx)，目前我被困在[第 3 部分](http://weblogs.asp.net/scottgu/pages/silverlight-tutorial-part-3-using-networking-to-retrieve-data-and-populate-a-datagrid.aspx)。我已经到了我的应用程序请求并接收来自 Digg 的响应的地步，但我无法弄清楚如何正确`XDocument`标注类（如教程所示）以读取检索到的 xmlcontent。

当然，本教程是用 C# 编写的（我对此知之甚少），但我不明白为什么我不能访问这个类。IntelliSense 建议用 替换`XDocument`，`Document.Run`但这让我无处可去。我还读到这个类是`System.Xml.Linq`命名空间的一部分，但甚至试图将我的变量定义为

> `Dim xS as System.Xml.Linq.XDocument`

什么都不给我。有谁知道我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T20:56:57.680

您使用的是什么版本的 .Net/Visual Studio？XDocument 直到 .Net 3.5 才被添加到框架中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T20:57:20.813

如果我没记错的话，您需要在项目引用中添加 System.Xml.Linq dll。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T08:19:35.053

正如上面的海报所提到的，Linq 是 .Net 3.5 的补充。

我最近尝试在我认为启用 3.5 的应用程序中使用 linq 功能时遇到了一个非常相似的问题，但我的 web.config 来自一个较旧的项目。

如果您知道已安装 3.5，请尝试创建一个新项目并将代码重新添加到其中。

# nhibernate - 从多个实体的集合中级联删除

> ID：459119
> 
> 赞同：1
> 
> 时间：2009-01-19T20:51:30.683
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有三个实体：客户、设备和 LocationTag。

客户有一个 LocationTag 列表（只不过是一个 ID 和一个描述）。他们还有一个设备列表。

设备使用客户 LocationTag 的一个子集进行标记，因此设备也有一个 LocationTag 列表（但仅限于客户的）。

如果我从客户列表中删除 LocationTag，我希望它也从设备中的 LocationTag 列表中级联删除。目前，我让它工作，但在域对象类中使用手动代码，但在我看来违反了 DRY。

**是否可以通过 Fluent NHibernate 映射来实现这一点？**

简化的 Fluent NHib 映射：

**顾客**

```
 public CustomerMap()
    {
        WithTable("Customers");

        Id(x => x.ID)
            .WithUnsavedValue(0)
            .GeneratedBy.Identity();

        Map(x => x.Name);

        HasMany<LocationTag>(t => t.LocationTags).IsInverse();

        HasMany<Device>(d => d.Devices).IsInverse();
    } 
```

**设备**

```
 public DeviceMap()
    {
        WithTable("Devices");

        Id(x => x.ID)
            .WithUnsavedValue(0)
            .GeneratedBy.Identity();

        Map(x => x.Name);

        HasMany<LocationTag>(x => x.LocationTags).IsInverse();
    } 
```

**位置标签**

```
 public LocationTagMap()
    {
        WithTable("LocationTags");

        Id(x => x.ID)
            .WithUnsavedValue(0)
            .GeneratedBy.Identity();

        Map(x => x.Description);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T23:55:39.377

我不确定这是否可以使用标准的 NHibernate。你最好在[NHibernate 用户邮件列表](http://groups.google.com/group/nhusers)上问这个问题，你更有可能在那里得到有用的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T15:33:38.953

您可以在 Customer 和 LocationTags 之间有一个关联类。然后让设备在关联类中使用 FK，而不是直接使用 LocationTag。

```
Customer
- CustomerID (PK)

CustomerLocationTag
- CustomerLocationTagID (PK)
- CustomerID (FK)
- LocationTagID (FK)

LocationTag
- LocationTagID (PK)

Device
- DeviceID (PK)
- CustomerLocationTagID (FK) 
```

# python - 在 SQLAlchemy 中按关系计数过滤

> ID：459125
> 
> 赞同：15
> 
> 时间：2009-01-19T20:53:54.970
> 
> 标签：python, sql, database, sqlalchemy, pylons

我在 Pylons 项目中使用 SQLAlchemy Python ORM。我有一个类“项目”，它与另一个类“条目”具有一对多的关系。我想在 SQLAlchemy 中做一个查询，它为我提供了所有与它们相关联的一个或多个条目的项目。目前我正在做：

```
[project for project in Session.query(Project) if len(project.entries)>0] 
```

我知道这并不理想，但我不知道如何做一个过滤器来满足我的要求（例如 Session.query(Project).filter(Project.entries.exists())）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-19T21:48:24.017

`Session.query(Project).filter(Project.entries.any())`应该管用。

编辑詹姆斯布雷迪评论的信用，一定要给他一些爱。

# c# - C#：如何控制 ComboBox 中显示的当前项索引？

> ID：459126
> 
> 赞同：2
> 
> 时间：2009-01-19T20:53:57.980
> 
> 标签：c#

我在组合框中设置了一个项目列表，但是当我调试应用程序时，我必须从下拉列表中选择一个项目才能默认显示一个项目。有财产吗？您可以设置以便组合框 itemindex 始终从 0 开始，这意味着在应用程序启动时列表中的第一项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T20:56:14.437

```
this.comboBox1.SelectedIndex = 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T21:17:05.813

您将要使用 SelectedIndex 属性。

SelectedItem 属性只能读取。使用 SelectedText 和 SelectedValue 属性将更改文本和值，而不是选择哪个

# performance - Telerik RadGrid 工作示例

> ID：459133
> 
> 赞同：4
> 
> 时间：2009-01-19T20:55:39.193
> 
> 标签：performance, telerik, radgrid

我正在寻找一些当前使用 Telerik Rad Grid 的生产网站示例。除了 Telerik RadGrid 演示之外，我真的很想看到一些真实世界的场景。有谁知道使用它的任何网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T18:33:43.983

他们网站上的这篇[文章](http://www.telerik.com/company/press-center/company-news/microsoft-implements-telerik-controls-in-msdn-technet-and-codeplex.aspx)说，MSDN、TechNet 和 CodePlex 网站正在使用他们的组件。

> “Microsoft 已选择在 Wiki Annotation Editor 中实现 RadEditor……[和]所有项目讨论页面，成为自定义内联编辑器。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-16T23:54:45.043

这是给你的...第一个选项卡使用[RadGrid](http://www.telerik.com/products/aspnet-ajax/grid.aspx)控件，第二个选项卡使用[RadScheduler](http://www.telerik.com/products/aspnet-ajax/scheduler.aspx)控件...

[根据网站所有者的要求编辑链接]
`I will post blog on this later to demonstrate`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T21:38:09.810

大多数类似的控件都用于内部网络应用程序。很难提供面向公众的使用类似 DataGrid 的网站示例（并非不可能，只是很少见），更不用说在一个平台上由一个供应商提供了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T21:05:58.550

他们的网站上有一些案例研究。像[winforms](http://www.telerik.com/products/winforms/success-stories/case-studies.aspx)，[asp.net ajax](http://www.telerik.com/products/aspnet-ajax/success-stories.aspx)等。

# sql-server - 我可以在 SQL Server 2005 中更改分区表吗？

> ID：459146
> 
> 赞同：2
> 
> 时间：2009-01-19T20:59:31.887
> 
> 标签：sql-server, sql-server-2005, partitioning

我正在研究其中包含时间序列数据的表的水平分区。我发现 2005 年的分区比 2000 年要容易得多，但我似乎找不到这个答案：

**我可以添加/删除分区表的列吗？**

是否需要特殊步骤，因为它是分区的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T21:05:17.613

*除了执行涉及分区表的 SWITCH 操作外，ALTER TABLE 还可用于更改分区表的列、约束和触发器的状态，就像它用于非分区表一样。但是，此语句不能用于更改表本身的分区方式。要对分区表进行重新分区，请使用 ALTER PARTITION SCHEME 和 ALTER PARTITION FUNCTION。此外，您不能更改分区表的列的数据类型。*

在此处阅读更多信息： [http ://technet.microsoft.com/en-us/library/ms190273.aspx](http://technet.microsoft.com/en-us/library/ms190273.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T21:41:11.240

我找不到明确的答案（我发现@EJ Brennan 引用的文档有点密集和不清楚）。所以我添加到[这个例子](http://weblogs.sqlteam.com/dmauri/archive/2005/07/18/7147.aspx)中并测试了，**是的，你可以添加/删除列**：

```
USE adventureworks
go

create partition function YearPF(datetime) as range right for values ('20050101');

-- Now we need to add filegroups that will contains partitioned values
alter database adventureworks add filegroup YearFG1;
alter database adventureworks add filegroup YearFG2;

-- Now we need to add file to filegroups
alter database adventureworks add file (name = 'YearF1', filename = 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\AdvWorksF1.ndf') to filegroup YearFG1;
alter database adventureworks add file (name = 'YearF2', filename = 'C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\Data\AdvWorksF2.ndf') to filegroup YearFG2;

-- Here we associate the partition function to 
-- the created filegroup via a Partitioning Scheme
create partition scheme YearPS as partition YearPF to (YearFG1, YearFG2)

-- Now just create a table that uses the particion scheme
create table PartitionedOrders
(
  Id int not null identity(1,1),
  DueDate DateTime not null,
) on YearPS(DueDate)

-- And now we just have to use the table!
insert into PartitionedOrders values('20020101')
insert into PartitionedOrders values('20030101')
insert into PartitionedOrders values('20040101')
insert into PartitionedOrders values('20050101')
insert into PartitionedOrders values('20060101')

-- Now we want to see where our values has falled
select *, $partition.YearPF(DueDate) from PartitionedOrders

-- see if we can add a column
ALTER TABLE PartitionedOrders ADD NewColumn INT NULL

-- add some more records, populating the new column
insert into PartitionedOrders values('20010101', 1)
insert into PartitionedOrders values('20070101', 2)

-- see that they were inserted properly
select *, $partition.YearPF(DueDate) from PartitionedOrders

ALTER TABLE PartitionedOrders DROP COLUMN NewColumn

-- see that the column dropped
select *, $partition.YearPF(DueDate) from PartitionedOrders

/* clean up
drop table PartitionedOrders
drop partition scheme YearPS;
drop partition function YearPF;
alter database adventureworks remove file YearF1;
alter database adventureworks remove file YearF2;
alter database adventureworks remove  filegroup YearFG1;
alter database adventureworks remove filegroup YearFG2;
*/ 
```

# language-agnostic - Win32：是否可以构建一个包含其他应用程序的应用程序？

> ID：459156
> 
> 赞同：3
> 
> 时间：2009-01-19T21:02:58.587
> 
> 标签：language-agnostic, winapi

我想知道，您将如何编写一个基本上包含其他应用程序的应用程序？

我问的原因是我很想构建一个应用程序来“征服”我当前打开窗口的爆炸式增长。我以前使用过虚拟窗口管理器，它们都很好，但我可以用我提到的应用程序做很多事情。

或者，是否有人知道用于将窗口限制在屏幕“区域”的易于使用/直观的应用程序？像 GridMove 之类的东西，但更直观，更少花哨？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:13:18.707

我认为您所描述的通常称为窗口管理器。Windows shell 本身就是窗口管理器的一个（差）示例。您可能想研究一些替代方案。我知道在将 KDE 移植到 Windows 方面取得了一些成功，因此您可能想查看该项目的当前状态。

Microsoft 还提供了一个 PowerToy (IIRC)，可以为您提供虚拟桌面支持，但它真的很糟糕。您是否考虑过只安装第二台显示器（可能还有 MultiMon Taskbar 等实用程序在另一台显示器上安装第二台任务栏）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:44:31.890

您可以创建一个窗口，然后您可以枚举所有具有 style 的窗口`WS_OVERLAPPEDWINDOW`，选择属于您要容纳的应用程序`SetParent`的窗口，然后调用窗口，将父窗口设置为您创建的窗口。您也可以使用`FindWindow`它来按标题查找窗口。

房子里的所有窗户都不能离开房子窗户的边界，但它们仍然遵循所有相同的规则。您仍然可以单击并拖动窗口等。

这里的问题是，如果房屋内的应用程序创建另一个窗口，其父级很可能是桌面窗口，而不是房屋窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-06T20:53:10.937

这是使用 FindWindow / SetParent 创建结合不同应用程序[Jedi Window Dock的选项卡式视图的代码](http://www.anappaday.com/downloads/2006/10/day-22-jedi-window-dock.html)

我还编写了一个应用程序（不是免费的，不是开源的），将这个想法更进一步，称为[WindowTabs](http://www.windowtabs.com)。

我要给你的唯一警告是，并非所有应用程序都喜欢被养育。如果您编写 .NET，那里有一些“陷阱”（这就是 WindowTabs 不使用育儿的原因）。

此外，一般来说，一旦您执行 SetParent，您将在 Win32 级别加入线程，这意味着如果一个挂起，所有线程都是 toast。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T21:09:26.750

[多个文档界面](http://en.wikipedia.org/wiki/Multiple_document_interface)可以帮助您。

尽管有多次反对票，但我坚持这个答案，因为 OP 从未说明“窗户爆炸”的来源。我见过一次打开多个窗口的商业应用程序（或者用户会打开多个实例“以节省时间”），其中 MDI 对他们来说是一个很好的功能。

如果 OP 是一个需要另一个窗口管理器的高级用户，因为他一次运行许多应用程序，那么这真的不适用。这也不是我要解决的问题——它会找到一种减少窗户的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T22:43:09.150

一般来说，总是有一个虚拟机。

根据您要执行的操作的具体情况，这可能是矫枉过正或可能不起作用。但是 VMWare 可以让你在你的虚拟机和本地机器之间复制/粘贴文件和文本，所以它离真正的窗口管理器不远了。考虑到 iTunes + 一个典型的浏览器占用了多少内存，系统要求甚至没有那么离谱。

# django - Django 模板中具有多于一组行的交替行着色

> ID：459161
> 
> 赞同：61
> 
> 时间：2009-01-19T21:05:21.687
> 
> 标签：django, django-templates

Django 模板提供了用于在模板中不同点（或模板中的 for 循环）的多个值之间交替的内置标签，但是当在s 定义`cycle`之外的范围内访问该标签时，该标签不会重置。`cycle`即，如果您的模板中有两个或多个列表，那么您希望使用一些 css 定义的所有行`odd`和`even`，列表的第一行将在最后一个离开的地方，而不是新的迭代从选择 (`odd`和`even`)

例如，在下面的代码中，如果第一个博客有奇数个条目，那么第二个博客中的第一个条目将以 开头`even`，而我希望它以 开头`odd`。

```
{% for blog in blogs %}
  {% for entry in blog.entries %}
    <div class="{% cycle 'odd' 'even' %}" id="{{entry.id}}">
      {{entry.text}}
    </div>
  {% endfor %}
{% endfor %} 
```

我尝试通过修补`resetcycle`此处提供的标签来避免这种情况：

[Django票：循环标签在超出范围后应重置](http://code.djangoproject.com/ticket/5908)

无济于事。（代码对我不起作用。）

我也尝试将我的内部循环移动到自定义标记中，但这也不起作用，可能是因为编译/渲染循环将循环移回了外部循环？（不管为什么，它对我不起作用。）

我怎样才能完成这个简单的任务！？我不希望在我的视图中使用预编译的这些信息创建数据结构；这似乎没有必要。提前致谢。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-01-20T02:15:37.753

最简单的解决方法（在修复并应用 resetcycle 补丁之前）是使用带有 forloop.counter 的内置“divisibleby”过滤器：

```
{% for entry in blog.entries %}
  <div class="{% if forloop.counter|divisibleby:2 %}even{% else %}odd{% endif %}" id="{{ entry.id }}">
    {{ entry.text }}
  </div>
{% endfor %} 
```

有点冗长，但不难理解，而且效果很好。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-06-18T16:45:33.397

[https://docs.djangoproject.com/en/1.8/ref/templates/builtins/#cycle](https://docs.djangoproject.com/en/1.8/ref/templates/builtins/#cycle)

```
{% for o in some_list %}
    <tr class="{% cycle 'row1' 'row2' %}">
        ...
    </tr>
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T21:33:43.017

放弃使用[Jinja2 模板系统](http://jinja.pocoo.org/2/)

我放弃了 django 模板语言，它的用途非常有限。Jinja2 使用与 django 模板相同的语法，但在它之上添加了许多增强功能。

**编辑/注意**（我知道这听起来像是一个小问题的大转变，但实际上我敢打赌你总是发现自己在与 django 中的默认模板系统作斗争，所以它真的很值得，我相信它会让你更有效率从长远来看。）

你可以阅读[它的作者写的这篇文章](http://lucumr.pocoo.org/2008/9/16/why-jinja-is-not-django-and-why-django-should-have-a-look-at-it)，虽然它是技术性的，但他提到了 django 中 {% cycle %} 标签的问题。

Jinja 没有循环标签，它在循环上有一个循环方法：

```
{% for user in users %}
    <li class="{{ loop.cycle('odd', 'even') }}">{{ user }}</li>
{% endfor %} 
```

Jinja2 的一个主要优点是它允许您使用逻辑进行演示，所以如果您有一个图片列表，您可以将它们放在一个表格中，因为您可以在表格中每隔 N 个元素开始一个新行，看，例如，您可以这样做：

```
{% if loop.index is divisibleby(5) %}   
     </tr>
     {% if not loop.last %}
     <tr>
     {% endif %}
{% endif %} 
```

您还可以使用数学表达式：

```
{% if x > 10 %} 
```

并且您可以直接访问您的 python 函数（但需要一些设置来指定应该为模板公开哪些函数）

```
{% for item in normal_python_function_that_returns_a_query_or_a_list() %} 
```

甚至设置变量..

```
{% set variable_name = function_that_returns_an_object_or_something() %} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-20T12:13:09.990

您可以使用标记`cycle`和`resetcycle`（Django 1.11 中的新功能）调用（来自[https://docs.djangoproject.com/en/1.11/ref/templates/builtins/#std:templatetag-resetcycle](https://docs.djangoproject.com/en/1.11/ref/templates/builtins/#std:templatetag-resetcycle)）：

```
{% for blog in blogs %}
  {% cycle 'odd' 'even' as rowcolors silent %}
  {% resetcycle rowcolors %}
  {% for entry in blog.entries %}
    {% cycle rowcolors %}
    <div class="{{ rowcolors }}" id="{{entry.id}}">
      {{ entry.text }}
    </div>
  {% endfor %}
{% endfor %} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-14T08:33:37.373

我最终这样做了，使用 forloop.counter0 - 效果很好！

```
{% for product in products %}

    {% if forloop.counter0|divisibleby:4 %}<div class="clear"></div>{% endif %}

    <div class="product {% if forloop.counter0|divisibleby:4 %}col{% else %}col20{% endif    %}">
        Lorem Ipsum is simply dummy text
    </div>

{% endfor %} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T21:20:03.747

最简单的答案可能是：“放弃并使用 jQuery。” 如果这是可以接受的，那么它可能比与 Django 的模板为如此简单的事情而斗争更容易。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-01-19T23:25:35.727

有一种方法可以在服务器端使用不保留所有条目的同时副本的迭代器：

```
import itertools
return render_to_response('template.html',
  {
    "flattened_entries": itertools.chain(*(blog.entries for blog in blogs)),
  }) 
```

# c++ - 冒充用户访问hives - 各种方法，有哪些实际问题？

> ID：459162
> 
> 赞同：2
> 
> 时间：2009-01-19T21:05:31.000
> 
> 标签：c++, windows, login, impersonation, token

我正在设计一个服务以在 Win2000、XP 和 Vista 上的 LocalSystem 帐户下运行。它需要访问用户注册表配置单元，有时需要长时间访问，无论是在用户登录时还是在用户未登录时（如果配置文件是本地的。如果配置文件是漫游且未加载） ，我不会尝试加载它。）

如果用户已登录，我可以通过各种方式（例如从其资源管理器进程，或通过从服务控制管理器接收登录事件）获取用户访问令牌，然后使用 ImpersonateLoggedOnUser 和 RegOpenCurrentUser 访问用户的配置单元。但是，如果用户在我模拟并打开他的配置单元时从开始菜单中选择注销会有什么影响？是否会阻止注销？我的冒充会被终止吗？

如果用户没有登录，我可以使用RegLoadKey直接打开hive NTUSER.DAT。（对于已登录的用户来说是不可能的）。但是，如果用户决定登录，这意味着什么（我想配置单元将被锁定并且登录要么被阻止，要么可能会遇到困难？）

我将设置一些测试项目来探索这些想法，但是，不管它们的明显结果如何，这些问题都是理论上的，就用户在这些操作期间登录/注销可能或将导致什么类型的问题而言服务。

警告：ImpersonateLoggedOnUser 只能用于登录用户（从进程或 SCM 事件获得的令牌）或我有明文密码来调用 WinLogon 并获取令牌的用户 - TRUE / FALSE？换句话说，虽然我拥有 LocalSystem 的最大权限并且能够更改用户的密码甚至删除用户的帐户，但如果用户没有登录，则完全不可能创建一个新的令牌来冒充用户而没有密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T21:13:44.077

显然，如果用户登录时它已经被另一个进程加载，则存在损坏用户配置文件的风险。在这种情况下，系统将尝试为用户创建一个新的子目录。

# c# - 将 DataBinder.Eval 与包含句点的索引器一起使用

> ID：459168
> 
> 赞同：3
> 
> 时间：2009-01-19T21:07:14.210
> 
> 标签：c#, c#-3.0

如何转义索引器中的点？第一个 DataBinder.Eval 按预期工作。第二个抛出异常。

```
System.ArgumentException: DataBinding: 'dict["a' is not a valid indexed expression.

Dictionary<string, int> dict = new Dictionary<string, int>();
dict.Add("aaa", 111);
dict.Add("bbb", 222);
dict.Add("ccc", 333);
dict.Add("ddd", 444);
dict.Add("a.aa", 555);
var blah = new { dict = dict, date = DateTime.Now };

Console.WriteLine(DataBinder.Eval(blah, "dict[\"aaa\"]")); 
// 111

Console.WriteLine(DataBinder.Eval(blah, "dict[\"a.aa\"]")); 
// System.ArgumentException: DataBinding: 'dict["a' is not a valid indexed expression. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T21:47:28.577

DataBinder.Eval 首先通过一组 char 标记（它在静态构造函数中定义为）按表达式部分拆分字符串：

```
expressionPartSeparator = new char[] { '.' }; 
```

然后，它将这些部分传递给私有 Eval 方法，该方法将根据需要使用 DataBinder.GetPropertyValue 或 DataBinder.GetIndexedPropertyValue 来进一步确定表达式的值。

要绕过这个，只需将 GetIndexedPropertyValue 直接与您的字符串表达式一起使用，如下所示：

```
Console.WriteLine(DataBinder.GetIndexedPropertyValue(blah, "dict[a.aa]" )); 
```

另请注意，您不需要额外的引号......它们太过分了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:39:37.280

请改用此方法：

```
Console.WriteLine(DataBinder.GetIndexedPropertyValue(blah, "dict[\"a.aa\"]")); 
```

# wpf - WPF 在鼠标悬停时播放电影

> ID：459171
> 
> 赞同：3
> 
> 时间：2009-01-19T21:09:00.150
> 
> 标签：wpf, video, mouseover

当用户将鼠标指针放在元素上时，有没有办法使用 WPF 让视频元素开始播放？我想要制作一个交互式数字资源，并希望在鼠标悬停在元素上单击以将它们带到电影部分时播放电影剪辑。任何帮助都会很棒。

这将全部包含在 Windows 应用程序中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:40:03.270

如果您使用 MediaElement 播放视频，只需监听[MouseEntered](http://msdn.microsoft.com/en-us/library/system.windows.uielement.mouseenter.aspx)事件并调用[Play](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.play.aspx) ()。

注意： MediaElement 的 LoadedBehavior 属性必须设置为 Manual 才能以交互方式停止、暂停和播放媒体。

这是一个例子：

在 C# 代码隐藏中：

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
    }

    private void mediaElement1_MouseEnter(object sender, MouseEventArgs e)
    {
        mediaElement1.Play();
    }

    private void mediaElement1_MouseLeave(object sender, MouseEventArgs e)
    {
        mediaElement1.Stop();
    }

    private void mediaElement1_Loaded(object sender, RoutedEventArgs e)
    {
        mediaElement1.Pause();
    }
} 
```

在 XAML 中：

```
<Window x:Class="VideoTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <Grid>
        <MediaElement Margin="12" 
                      Name="mediaElement1" 
                      Source="mediaFile.avi"
                      LoadedBehavior="Manual"                      
                      MouseEnter="mediaElement1_MouseEnter"
                      MouseLeave="mediaElement1_MouseLeave"
                      Loaded="mediaElement1_Loaded"
                      />
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T14:47:50.607

发现问题

```
<MediaElement Margin="12" 
                  Name="mediaElement1" 
                  Source="mediaFile.avi"
                  LoadedBehavior="Manual"                      
                  MouseEnter="mediaElement1_MouseEnter"
                  MouseLeave="mediaElement1_MouseLeave"
                  Loaded="mediaElement1_Loaded"
                  /> 
```

它似乎不喜欢

```
Loaded="mediaElement1_Loaded" 
```

所以我在后面的代码中更改了我的 Initialize 以包含

```
mediaElement1.Pause(); 
```

它工作得很好。

# sql-server - TSQL 常量...使用变量还是文字？

> ID：459173
> 
> 赞同：4
> 
> 时间：2009-01-19T21:09:17.107
> 
> 标签：sql-server, tsql

我只是在阅读我公司的代码指南，它说永远不要将变量视为 sql server 中的常量，而是使用文字。原因是当您在查询中使用变量时，sql server 无法构建好的执行计划。

有人知道这是否仍然是真的吗？我们使用的是 MSSQL 2005，这个文档可能是为 2000 年编写的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T22:14:59.050

对于 SQL Server 2005，这“通常”是正确的，因为它现在尝试为尽可能多的查询预先生成执行计划。您的里程可能会有所不同，因为它取决于您的数据和您的 SARG（测试您的查询计划并查看），但是这个 tecdoc（他们使用的是 SQL Server 2005 的预发布版本）指出：

[http://www.microsoft.com/technet/prodtechnol/sql/2005/qrystats.mspx](http://www.microsoft.com/technet/prodtechnol/sql/2005/qrystats.mspx)

> 避免在查询中使用局部变量
> 
> 如果您在查询谓词中使用局部变量而不是参数或文字，则优化器会采用质量降低的估计，或猜测谓词的选择性。在查询中使用参数或文字而不是局部变量，优化器通常能够选择更好的查询计划。例如，考虑这个使用局部变量的查询：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:17:59.493

我不知道这是否总是正确的，但是使用在执行时间之前无法评估的变量将限制优化器在做出优化决策时使用它收集的有关表的任何统计信息的能力。引用的文章讨论了这一点，并提供了一些提示，说明如何在无法避免的情况下帮助 SQL Server 做出优化决策。

参考：[http ://www.sqlmag.com/Article/ArticleID/42801/sql_server_42801.html](http://www.sqlmag.com/Article/ArticleID/42801/sql_server_42801.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T21:21:03.027

如果使用文字，SQL Server 可以构建更好的执行计划。我看到的一个案例涉及分区视图。如果您从带有变量的分区视图中选择，SQL 将在运行时评估该变量，就好像您使用文字 SQL 紧随基础表之后一样。

话虽如此，您应该在硬编码之前进行测试，如果您有两个仅在字面上有所不同的查询，那将是一种气味。

# html - 文本字段中允许的字符标准是什么

> ID：459175
> 
> 赞同：3
> 
> 时间：2009-01-19T21:10:23.453
> 
> 标签：html, textbox, standards, passwords, character

新用户注册时文本字段中允许的典型字符是什么？有www标准吗？对允许的用户名和密码字符类型特别感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T21:20:42.357

不要限制密码字符。可用的字符越多，密码就越安全。没有充分的理由禁止空格，例如密码中的空格。

对于用户名，这取决于它们的显示位置。如果您打算为那里的用户提供自己的个人资料 URL，那么您会希望限制字符数，如果没有的话。

只是不要忘记在再次输出用户输入时对其进行转义。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T21:18:11.443

我更喜欢能够使用字母、数字和特殊字符来创建我的密码。我真的很讨厌网站拒绝我使用特殊字符，尤其是 !@$*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T21:20:49.987

你有什么理由否认任何角色？您应该只允许所有内容，可能的空字符除外。当您在站点上打印用户名时，您必须对用户名进行编码以避免跨站点脚本问题，但您可能还是应该这样做，即使您为了安全而过滤“危险”字符也是如此。允许所有字符，尤其是密码，极大地提高了可用性（和安全性，在密码的情况下）。另外，请记住，如果某些用户的姓名中有重音符号（或者如果他们使用的是中文或俄语等非拉丁字母），他们可能希望输入 UTF8 字符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T21:23:28.453

如果您确实限制了字符，则**不应**出于安全考虑（例如，防止引号使人们无法插入 SQL）。您的代码应该能够处理输入字符串中的任何字符，只要它们被发送到某个地方就可以正确地转义它们。但是出于商业原因或某些其他实际原因（例如 Zach 的 URL 示例）限制它们是可以的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T21:17:32.037

请允许所有 O'Briens、O'Malleys、O'Reillys 和其他带撇号的名字使用撇号！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T21:26:33.237

您的应用程序会被任何非英语用户使用吗？

至少允许像 á à é è ì 这样的欧洲字符。

当然，如果它必须真正国际化，那么您必须允许使用中文和阿拉伯语等语言中的任何字符。

在我看来，如果您不想让任何人生气，您就无法真正列出允许的字符。

如果您想出于安全目的这样做，我建议您在尝试使用字符串之前转义必要的字符，而不是预先过滤。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-19T21:28:25.633

*   密码字段应该允许*任何字符*（无论如何你都会散列它，对吧？）
*   文本字段不应**仅限**于特定字符（例如 [A-Za-z]）。否则，您将不允许需要（或想要）使用重音字符的人。从数据库/处理方面，您将转义或使用绑定来保存数据。
*   如果您有一个特定的字段，您*知道*只能接受特定的字符集（JW 提到的商业原因等）。例如，仅适用于美国受众的表格可能仅限于数字和邮政编码的破折号。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-19T21:40:01.990

也添加到其他人所说的：密码：任何东西，但要对它们进行哈希处理（当然）

用户名：一切，除了，可能是一个空格......或多个空格（即，单个空格可以，多个空格 = 1 个空格）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-19T21:23:07.127

作为绝对最低限度，密码应允许目标语言环境中键盘上的每个可用字符。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-11-30T04:35:16.263

不要限制任何东西，如果您想为用户提供他们自己的 URL，请使用数字 ID 或要求用户为 URL 命名。永远不要显示用户的用户名，显示他们的显示名（应该限制为除危险的 Unicode 字符之外的任何内容）并在注册后询问。

# ssh - 使用期望将密码传递给 ssh

> ID：459182
> 
> 赞同：41
> 
> 时间：2009-01-19T21:12:20.550
> 
> 标签：ssh, cygwin, expect

如何使用 expect 向 ssh 连接发送密码。

说密码是 p@ssword 并且 ssh 命令是 ssh me@127.0.0.1

当它说时，我会怎么做才能让它输入密码

me@127.0.0.1的密码：
？

使用 SSH 密钥对的正确操作不是一个选项，因为我必须使用 ssh (scp) 将密钥放在服务器上，这会要求输入密码。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-19T21:28:01.983

我总是使用“正确”的解决方案，但我在其他情况下使用了 expect。

[在这里](http://linux-bsd-central.com/index.php/content/view/26/)，我发现了以下建议：

```
#!/usr/local/bin/expect
spawn  sftp  -b cmdFile user@yourserver.com
expect "password:"
send "shhh!\n";
interact 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T21:15:47.330

使用公钥认证和使用没有密码的密钥不是更容易吗？

当源计算机上的用户执行此操作以生成 RSA 密钥

```
ssh-keygen -t rsa 
```

现在将 ~/.ssh/id_rsa.pub 复制到目标机器并将其附加到目标用户的 authorized_keys 文件中

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T21:26:29.227

您最快的前进方式（除非您想成为 Tcl 专家，这在 2009 年将是……不寻常的……）可能是使用`autoexpect`. 这是手册页：

[http://expect.nist.gov/example/autoexpect.man.html](http://expect.nist.gov/example/autoexpect.man.html)

简而言之，启动`autoexpect`，运行你的 ssh 会话，完成你需要做的事情，停止自动预期，然后敲打你的键盘，直到它工作为止:) 我假设你只需要一个快速的 hack把你的钥匙整理好，然后，听起来你已经知道分数了。

还有[这个问题](https://stackoverflow.com/questions/385980/problem-with-an-expect-script)已经包含一个接近你所寻求的例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-05T22:20:49.853

Cygwin 有 autoexpect 只是不在 bin 包中。运行 setup.exe 并搜索 expect 并选中源复选框。您将在 /usr/src 中看到生成的树，其中有一个 expect/expect/examples 目录。里面有一个 autoexpect 脚本的副本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-29T17:18:51.710

密钥解决方案将不起作用......因为密钥只能由运行 ssh 的人读取。在 xp 上，您无法创建具有正确权限的密钥结构。所以 ssh 不会读取它们。这可能已经改变，但最后我检查它仍然无法正常工作。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-19T21:17:34.843

我很确定不可能做你想做的事情。大多数提示输入密码的 *nix 应用程序直接从 TTY 读取，而不是 stdin，因此您无法输入密码。正如其他人所提到的，您可以将 SSH 配置为不提示输入密码，如此[处](http://www.linuxjournal.com/article/8600)所述。

在我无缘无故被否决后，我去对该`expect`命令进行了更多研究，发现它有一个`send_tty`发送到 /dev/tty 而不是 stdin 的命令，它实际上可能会做你想要的......我是以前不知道这个功能。但是，我仍然建议将密钥放在服务器上。

# phone-call - 从服务器拨打电话——那里有哪些服务？

> ID：459189
> 
> 赞同：1
> 
> 时间：2009-01-19T21:14:33.227
> 
> 标签：phone-call, ivr

我希望通过软件拨打电话并让软件向收件人读取消息。我一直在使用 Asterisk，但发现它有点需要维护，而且配置起来很痛苦。我想知道是否有任何服务可以向它发送一段文本和一个电话号码，它会将其读给电话的接收者。

我在加拿大并在加拿大境内拨打电话。该服务不需要接听电话。我正在使用 AMP 服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:53:59.837

看看 Katalina 'VoiceGuide' 一个基于 Windows 的 CTI 系统。它可以处理文本转语音应用程序。见：[www.voiceguide.com](http://www.voiceguide.com)

此外，MS 有一个基于服务器的电话系统。

还有其他人，但我认为以上 2 人是主要候选人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-01T19:09:52.747

[我认为Twilio](http://www.twilio.com)是你最好的选择。查看有关 Dial and Play 的文档。此外，如果这是一次性的并且您不想进行大量编程，请查看 Twilio Labs 中的 Twimlets，特别是[Call Me](http://labs.twilio.com/twimlets/callme)。

# asp.net - 如何使用 Visual Web Development 服务器配置无扩展名 URL？

> ID：459203
> 
> 赞同：2
> 
> 时间：2009-01-19T21:20:13.140
> 
> 标签：asp.net, url, url-rewriting, vwdexpress

我正在使用 Visual Studios 的内置 ASP.NET 开发服务器 (VWD) 在开发过程中测试我的网站。

我希望这个 ASP.NET 网站使用无扩展名 URL（页面不需要 aspx 扩展名）。通常我会在 IIS 中配置一个指向 ASPX 页面的自定义 404。我将如何使用 VWD 做到这一点？

*PS 这不是一个 ASP.NET MVC 网站。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-08T21:23:29.800

这是一个使用 UrlRewritingNet 的 Web.Config 示例。这样做将允许您进行无扩展重写，而无需编写任何 HttpModule 或类似的东西。

（全文[在这里](http://dotnetblogger.com/post/2009/08/05/URL-Rewriting-Made-Easy-Part-2-(Extensionless-URLs-IIS7-and-URLReWritingNet).aspx)）

注意：这需要 IIS7，因为它使用 web.config 的 system.webServer 部分。

```
<configSections>  
    <section name="urlrewritingnet"    
             restartOnExternalChanges="true"    
             requirePermission="false"    
             type="UrlRewritingNet.Configuration.UrlRewriteSection,  UrlRewritingNet.UrlRewriter" />  
</configSections>  

<system.webServer>  
    <modules runAllManagedModulesForAllRequests="true">   
        <add name="UrlRewriteModule" type="UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter" />  
    </modules>  
</system.webServer>  

<urlrewritingnet rewriteOnlyVirtualUrls="true"    
                 contextItemsPrefix="QueryString"    
                 xmlns="http://www.urlrewriting.net/schemas/config/2006/07">   
    <rewrites>  
        <!--Enable HTM(L) Extensions-->  
        <add name="pageHTML"    
             virtualUrl="^~/(.+).htm(.*)"    
             redirectMode="Permanent"  
             rewriteUrlParameter="ExcludeFromClientQueryString"    
             destinationUrl="~/$1.aspx"    
             ignoreCase="true" />  
        <!--Fix the WebResource JS Error-->  
        <add name="WebResourceFix"    
             virtualUrl="^~/WebResource.axd(.*)"  
             rewriteUrlParameter="IncludeQueryStringForRewrite"    
             destinationUrl="~/WebResource.axd$1"    
             ignoreCase="true"/>   
        <!--Fix the ScriptResource JS Error-->  
        <add name="ScriptResource"    
             virtualUrl="^~/ScriptResource.axd(.*)"  
             rewriteUrlParameter="IncludeQueryStringForRewrite"    
             destinationUrl="~/ScriptResource.axd$1"    
             ignoreCase="true"/>   
        <!--Allow Extensionless Page Extensions-->  
        <add name="pageExtensionless"  
             virtualUrl="^~/(.+)$"  
             redirectMode="Permanent"  
             rewriteUrlParameter="ExcludeFromClientQueryString"  
             destinationUrl="~/$1.aspx"  
             ignoreCase="true" />  
    </rewrites>  
</urlrewritingnet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-28T19:35:28.223

您需要做的就是在 web.config 中的两个不同位置添加模块...

```
<system.web>
    <pages theme="Default" />
    <httpModules>
        <add name="UrlRewriteModule" type="UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter" />
    </httpModules>
</system.web>

<system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
        <remove name="UrlRewriteModule"/>
        <add name="UrlRewriteModule" type="UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter" />
    </modules>
</system.webServer> 
```

第一个是将它添加到您的 httpModules 中，它将在您的 VS 开发环境中工作，第二个将用于 IIS7

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T22:19:13.473

你不需要做任何特别的事情。只需从 ASPX 页面文件中删除 .aspx 扩展名，它应该可以与 VWD 一起正常工作。Visual Studio 设计者可能会抱怨没有为扩展 '' 注册构建提供程序，但您可以忽略它。然后你可以引用没有扩展名的页面：

```
http://localhost:2181/Default

<%@ Page Language="C#"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    Hello World
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T22:32:38.907

如果您尝试获取类似[http://localhost:3000/value](http://localhost:3000/value)的内容以访问[http://localhost:3000/page.aspx?tag=value](http://localhost:3000/page.aspx?tag=value)那么您可以使用 HttpModule，这也是一个很好的替代404重定向。我以前也做过同样的事情。

我在上一个问题中发布了一些[示例代码](https://stackoverflow.com/questions/425512/custom-pagehandlerfactory-for-aspx#425553)。

# jquery - 在 $(document).ready() 之外使用 jQuery

> ID：459207
> 
> 赞同：1
> 
> 时间：2009-01-19T21:21:37.927
> 
> 标签：jquery

我在 外部创建了一个函数`$(document).ready()`，但仍在其中使用 jQuery。例如：

```
testFunction(){
  $('#test').hide();
  alert('test');
} 
```

当我`testFunction()`在页面完全加载后调用时，#test 没有隐藏，但我确实看到了警报。

为了在这个函数中使用 jQuery，我必须做什么？谢谢！

**更新：**

很高兴知道在外面工作没有任何限制`$(document).ready()`。

这就是它不起作用的原因：我没有调用`testFunction()`，我是`parent.testFunction()`从 iframe 调用的，而 #test 在父框架中。所以...我想我不能使用 '#test' 作为选择器。我应该使用什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T21:41:33.500

你可以使用 ' `#test`' 作为选择器，你只需要给[jQuery 一些 context](http://docs.jquery.com/Core/jQuery#expressioncontext)，因为它总是假设你在谈论当前文档中的一个 ID，而不是父级：

```
// Selects the test element from the parent
var test = $('#test', parent) 
```

**编辑**
jQuery 是从什么上下文加载的？IFrame 还是父窗口？这可以产生很大的不同。

我会使用`alert()`jQuery 来测试是否找到任何东西。`alert()`使用 jQuery 对象作为参数调用。

```
alert($('#test'));
// or
alert($('#test').get(0));
// also try
alert(document.getElementById('test')); 
```

如果最后一个不起作用（它应该提醒'HTMLElement'，具体取决于浏览器），那么jQuery 不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-22T08:31:10.763

I know it's kinda old thread but here's another solution. Might help others :D .
`jQuery('#test').hide();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T21:25:32.690

页面中是否存在 ID 为 test 的元素？

是否已加载 JQuery？

如果您在加载 DOM 后添加了#test，则需要进行一些调整以将元素重新绑定到 jQuery 正在使用的 DOM。那可能是你的问题。

# flash - 旋转 Flash 影片剪辑

> ID：459210
> 
> 赞同：2
> 
> 时间：2009-01-19T21:23:25.160
> 
> 标签：flash, rotation

我想做一个类似于[这家公司的](http://accuval.net)快闪菜单，我有向下旋转，我只是不知道如何让它旋转到顶部。例如，如果您在他们的菜单上单击“融资”，则融资一词会旋转到顶部。如果有人能告诉我如何做到这一点的理论，那就太棒了。

**编辑：**

我想我遇到的问题是我没有任何 x 和 y 位置来获得差异以旋转它。如果这有意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T04:15:27.620

最简单的方法是找出每个按钮笔直的角度（我的意思是，用手或在纸上）。一个圆圈有 360 度，但是要小心，因为闪光角度的范围是 -180 到 +180 度（而不是像你期望的那样从 0 到 360）。

对于旋转，您需要将所有按钮组合在一个圆形轮子动画剪辑中，然后将该轮子旋转到您在纸上发现的角度。

我为你做了一个快速的 flash 例子，**[你可以在这里看到](http://haroldg.com/tutes/rotation_wheel/)**。它包括一个补间版本，其移动方式与您提供的链接非常相​​似。祝你好运 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T21:37:16.520

您是否尝试对 _rotation 属性使用**负值？**

正角 > 下/右 负角 > 上/左

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T21:38:51.977

您需要两条时间线，一条用于顺时针旋转，一条用于逆时针旋转。从构建电影开始，标记点是每个菜单项都在顶部。根据单击的菜单项是小于（从旋转角度而言）还是大于当前位于顶部的项目，您可以在时间线中播放该位置。

请注意，作者在其中放置了一些减速和弹跳以产生效果或更大的旋转。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T00:37:14.973

查看此页面上关于 ActionScript Math的[最后一个示例。](http://flash-creations.com/notes/asclass_math.php)使用这种方法，您将拥有`OnPress()`for each menu item call `rotation(this._x, this._y)`。

要检查的另一件事是您的旋转点在圆的中间。如果它在拐角处，默认情况下，它不会像轮子一样旋转。

# javascript - 奇怪的 javascript 行为 - 一次有多个活动的 XMLHttpRequests？长时间运行的脚本？

> ID：459212
> 
> 赞同：1
> 
> 时间：2009-01-19T21:23:38.297
> 
> 标签：javascript, ajax

我正在尝试发出两个并发的 AJAX 请求。

第一次调用 (/ajax_test1.php) 需要很长时间才能执行（5 秒左右）。第二个调用 (/ajax_test2.php) 需要很短的时间来执行。

我看到的行为是我 /ajax_test2.php 返回并且处理程序被调用 (updateTwo()) 并使用 /ajax_test2.php 中的内容。

然后，5 秒后，/ajax_test1.php 返回，处理程序被调用 (updateOne())*仍然来自 /ajax_test2.php 的内容！！！*

为什么会这样？

代码在这里：http: [//208.81.124.11/~consolibyte/tmp/ajax.html](http://208.81.124.11/~consolibyte/tmp/ajax.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T21:35:37.880

这一行： -

```
req = new XMLHttpRequest(); 
```

应该：-

```
var req = new XMLHttpRequest(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T08:52:41.697

正如 AnthonyWJones 所说，您的 javascript 正在声明第二个 AJAX 对象，该对象首先覆盖 req 变量（假定为全局变量，因为没有 var），并且您还覆盖了 ajax 变量。

你应该分开你的代码，即：

```
function doOnChange()
{
    var ajax1 = new AJAX('ajax_test1.php', 'one', updateOne);
    var ajax2 = new AJAX('ajax_test2.php', 'two', updateTwo);
}
function AJAX(url, action, handler)
{
    if (typeof XMLHttpRequest == "undefined")
    {
        XMLHttpRequest = function()
        {
            try { return new ActiveXObject("Msxml2.XMLHTTP.6.0") } catch(e) {}
            try { return new ActiveXObject("Msxml2.XMLHTTP.3.0") } catch(e) {}
            try { return new ActiveXObject("Msxml2.XMLHTTP") } catch(e) {}
            try { return new ActiveXObject("Microsoft.XMLHTTP") } catch(e) {}
            throw new Error( "This browser does not support XMLHttpRequest." )
        };
    }

    url = url + '?action=' + action + '&rand=' + Math.random()

    var req = new XMLHttpRequest();
        req.onreadystatechange = function() {
                if (req.readyState == 4)
                {
                    if (req.status == 200) 
                    {
                        alert('' + handler.name + '("' + req.responseText + '") ')
                        handler(req.responseText)
                    }
                }
            }

        req.open("GET", url, true);
        req.send(null);
} 
```

问候

加文

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T13:15:21.167

狄奥迪斯和迈克·罗宾逊：

你们没有完全阅读我的帖子。我*知道*其中一页的执行时间比另一页长。这是每个页面的*预期*行为。

*但是*，如果您阅读了我的原始帖子，问题是*两个页面*的回调最终都只使用*第一页*的 HTML 内容被调用。

安东尼琼斯和加文：

多谢你们！这就像一个魅力！我想我需要复习一下我的 Javascript！

# vb.net - 如何将文件夹与包含.html 的 VB.NET 程序一起发布？

> ID：459213
> 
> 赞同：0
> 
> 时间：2009-01-19T21:23:52.180
> 
> 标签：vb.net, winforms, visual-studio-2005, clickonce

我有一个想要发布的 VB.NET 程序。在代码中，它引用了我创建的 HTML 页面。而不是对 URL 进行硬编码（例如：www.test2.com/folder/index.html）

我想让它相对于编码器的安装位置（例如：/folder/index.html）

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:35:34.670

在 VB.Net 你有

```
Dim lPath As String = Application.ExecutablePath 
```

它为您提供完整路径和 app.name （您可以删除）或

```
Dim lPath As String = Application.StartupPath 
```

这为您提供了应用程序启动的目录..

* * *

不确定我是否知道 clickonce 问题的答案，因为我们在工作中使用自己的部署方法，但如果您：-

1.  通过 Project Explorer 添加文件
2.  右键单击文件，选择属性并将构建操作设置为“内容”
3.  转到项目，您的项目名称属性，然后是发布选项卡，然后是应用程序文件按钮
4.  您应该会看到那里列出的文件，然后设置为 Include(auto)。

....或使用 Internet Explorer 将它们复制并粘贴到项目资源管理器中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T23:49:45.130

如果您的解决方案中引用了该文件，则发布操作应自动包含要发布的文件。

作为参考，如果 html 托管在同一个网站上，那么您可以使用您链接到的页面的相对路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T08:10:03.483

您还可以使用 Server.MapPath("relativepathtofile") 和您正在引用的文件的相对路径来引用代码中的文件。

# .net - iPhone/Windows Mobile 开发平台的长期潜力

> ID：459214
> 
> 赞同：4
> 
> 时间：2009-01-19T21:23:53.943
> 
> 标签：.net, iphone, windows-mobile

到目前为止，Apple 在创建良好的全方位开发者生态系统（SDK、应用程序分发、货币化等）方面似乎走得最远。但是，阅读之前关于移动开发的 SO 问题的评论（例如[this](https://stackoverflow.com/questions/365795/which-mobile-system-is-for-programmers)和[this](https://stackoverflow.com/questions/103480/iphone-programming-impressions-opinions)），似乎会出现某些批评，例如：

*   Objective-C 虽然是一门不错的语言，但并没有真正在 Apple 产品之外使用。
*   开发环境和工具与 Microsoft 提供的 Visual Studio 和 .NET 不匹配。

所以，我想知道苹果生态系统在长期（即 2-4 年）内的可行性。如果 Windows Mobile 7 手机（预计在一年左右发布）获得市场份额，iPhone 开发环境是否能够与 .NET + Visual Studio（加上微软推出的任何“App Store”类型的分发机制）竞争)? 从我所读到的关于 iPhone 开发的内容来看，我的印象是我们可能会看到开发人员逐渐流失到 Windows Mobile，因为大多数人更愿意使用 Microsoft 的工具套件进行开发。

对于在这两个平台上都有经验的开发者，您对这个话题有什么印象？iPhone 平台是否具有超越其拥有更多市场份额的初始优势的长期生存能力（相对于 Windows Mobile）？

==

编辑：关于 App Store 优势的公平点。但我对这两个平台的长期潜力感到好奇，而且微软推出自己的应用商店（例如 SkyMarket）似乎只是时间问题，这使得安装就像在 iPhone 上一样简单。（虽然 iPhone 的应用商店可能会占上风，因为它先来。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T22:22:44.197

我不认为 Windows Mobile 是 iPhone 的竞争对手。据我所知，开发人员现在应该为面向消费者的应用程序考虑四个平台：

*   苹果手机
*   黑莓（带有新的[App Store](http://na.blackberry.com/eng/developers/application_storefront.jsp)）
*   Palm Pré（将获得 App Store）
*   Android（将获得付费应用的 App Store）

其他一切都是非实体。Symbian 和 Windows Mobile 可能会再次变得相关，但截至今天，它们已不再相关。这些设备上的软件没有健康的市场，我不清楚大部分决定购买 Windows Mobile 手机的人是否关心第三方软件。

至于工具和语言，差异是微不足道的。这不是问题。开发人员不会仅仅因为不喜欢这些工具或语言而放弃像 iPhone 这样的市场。

更重要的是，Xcode 已经足够好（有些人更喜欢它而不是 Visual Studio - 我当然认为它的某些方面比他们的 Visual Studio 对应物更好），如果你了解 Java、C++ 或 C#，你将学习 Objective-C最多一周内。它基本上是两三个新概念，语法和引用计数略有不同。如果你已经了解了一些面向对象的语言，那么学习 Objective-C 是没有问题的，如果你不了解，这是一个学习一些新想法和概念的好借口。

真正的区别在于库，我个人更喜欢 Cocoa 而不是 .Net 库，后者通常需要您调用 pre-.Net API。

或许四年后，一切都会不同。也许诺基亚会彻底修复 Symbian 并接管智能手机市场。谁知道？你必须凑合我们今天所拥有的:-)

所以我的观点是：

*   在 Windows Mobile 真正开始成为第三方应用程序的可行平台之前，请忽略它
*   相反，看看 Pré、iPhone、Blackberries 和 Android 手机
*   Objective-C 只是一种编程语言。想太多也没有意义。任何程序员都可以在一周内学会它
*   Xcode 有它的弱点，但它也有它的长处，并不比 Visual Studio 差
*   可可棒棒哒
*   四年很长，谁也不知道到时候会发生什么

为 iPhone 编程非常有趣，如果您从未涉足过 .Net 世界，您将学到很多新东西。只需拿起一本好书，留出一个周末，设定一个小目标（比如一个小游戏，或者一个待办事项应用程序，或类似的东西），然后开始编码。即使你不喜欢 Xcode，即使你最终没有编写任何 iPhone 应用程序，你也会成为一个更好的程序员。

如果 Symbian*真的*赢了，学习为 iPhone 编写代码的经验至少会教会你如何在新平台上启动和运行 :-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T21:34:21.690

您错过了 Apple 工具集 IMO 的重点。

VisualStudio 可能有一个很好的工具集，但 Apple 的工具集已经足够好（而且非常棒，IMO）已经启用了超过 500,000,000 次下载的 15K 应用程序。我会说这对未来来说是个好兆头。

iPhone 的杀手级应用是 AppStore。这是在手机上获取应用程序的唯一方式，并且不在运营商控制系统之外。例如，尝试在 Verizon 手机上安装一个应用程序，您很快就会发现*控制*对无线运营商意味着什么。

Discovery 是基于网络的，因此您可以向某人发送一个应用程序的链接，当他们加载它时，它会转到他们可以安装该应用程序的页面。简单而优雅。

Objective-C 的语言怪癖是一条红鲱鱼。任何有能力的开发人员都会在几周内赶上进度。Cocoa 是一个令人难以置信的框架。

此外，不要低估控制硬件规格的能力。Apple 对硬件规范的控制对开发人员来说是一个福音，因为他们可以指望事情不会变得复杂和分散，因为尽可能完全地交付不符合 iPhone SDK 规范的手机不符合 Apple 的利益。当 OEM 制造符合 Windows Mobile 规范的硬件时，总会有对规范的“解释”，这意味着开发人员只能在手机 a 和手机 b 之间夹带包，为什么我的应用程序不能在两者上运行相同？

这是移动领域经常被忽视的一个重要点。如果硬件规范没有一个所有者，它很容易变成“一次编写，到处调试”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T02:16:35.630

“如果 Windows Mobile 7 手机（预计在一年左右发布）获得市场份额......我们可能会看到开发人员逐渐流失到 Windows Mobile，因为大多数人更愿意使用微软的工具套件进行开发。”

让我们假设 VS 和 CLR 提供了更好的编程体验。即便如此，对 WM 的“逐渐减员”是否会发生也完全不清楚。“编程经验”只是开发者会面临的因素之一；现有的市场份额和认知是另一回事（想想亚马逊和 eBay，或者就此而言，iTunes 的 MP3 商店）。

你说的“长期”是2-4年。到时候，WM7 有机会获得比苹果更大的市场份额吗？不现实。

即使我们把你的时间框架放得更远，面对 WM7 的卓越编程体验，iPhone 开发在 4 年内崩溃是否可行？MS 有什么可以想象成为对抗 iPhone 的平台杀手？C# 4、DLR、VS2K10？这些都不够。可能（*可能*）做的是 Azure。

但我会争辩说，*如果*你认为 Azure 是 iPhone 平台杀手，*那么*你必须对 Google/Android 给予同等重视。

也就是说，从风险管理的角度来看，风险最小的选择显然是 iPhone。如果您想降低出错的风险，请充分考虑您的 Cocoa 程序，以便您可以在 C# 中重新实现它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T21:39:16.797

有趣的是，开发平台的生存能力真的次于交付平台的生存能力。

如果您可以使用该平台制作的产品没有市场，那么世界上最好的开发平台几乎毫无价值。

iPhone/iPod touch 是一种孤立的“专有”产品，但同时它的销量也很多。更重要的是，它向喜欢从 App Store 购买东西的人销售产品。对于许多用户来说，App Store 是一个引人注目的卖点。

因此，基本上，开发平台的生存能力与平台本身的生存能力密切相关。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T21:39:25.003

这真的非常主观，因为我们都没有水晶球。十年来我一直在做移动和嵌入式开发，而且我玩过几乎所有的东西（你忽略了 Symbian 或 RIM，而且曾几何时 Palm 也是一个主要参与者）。

过去几年，我对微软的移动“战略”感到非常失望——他们似乎只关注企业应用程序和开发人员。然而，他们在创建一流工具方面做得很好，Compact Framework 是我见过的从 Redmond 运出的最可靠的产品之一（v1 诚然有限，但对于 v1 来说它非常可靠，从无到有交货）。

iPhone 似乎正在利用这一点，并在消费领域大力击败微软。但你不能真的指望微软（或任何代替他们的企业）在激烈的竞争面前会坐以待毙。我确信他们已经计划好了（尽管我也不知道该计划是什么）。恢复就够了吗？谁知道。

iPhone 就是它所吹捧的一切吗？好吧，我认为它并不像某些人认为的那样开放。你能写的东西是有限的，你销售和分发的方式是有限的。您可以使用的工具和可以运行的目标硬件受到限制。不是最好的环境。但同样，面对可能来自 MS、RIM 甚至谷歌的竞争，他们会保持这种状态吗？很难说，但我敢打赌这不太可能。

那么谁会赢呢？我不会对他们中的任何一个承担风险。我们已经在硬件和学习以及微软的技术上投入了大量资金，所以我们不太可能放弃它。尽管如此，我们已经为 iPhone 的工作做了一些工作和工作招标，因为如果我们把所有的鸡蛋都放在一个篮子里，那就太傻了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T21:51:06.883

如果你正在编写像桌面软件一样的电话软件，那你就错了。Palm 曾经有一些关于如何为他们的掌上电脑进行开发的很好的指导方针，这些建议同样适用于手机。

由于您将不得不进入不同的心态，因此使用稍微不同的语言和不同的工具不会成为大问题。事实上，不同的开发环境可能会帮助您保持不同的心态。

# flash - 无法通过带有组件的 TextField 进行 Tab

> ID：459223
> 
> 赞同：0
> 
> 时间：2009-01-19T21:27:55.557
> 
> 标签：flash, actionscript, actionscript-2

我在舞台上放置了 8 个 TextField。我有一个标签顺序设置，并且能够通过按 Tab 进入下一个字段。在舞台上添加 2 个组件（UIScollBar 和 Button）后，我不知何故失去了这种能力。我怎样才能找回它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T06:45:53.013

您可能需要检查 Flash 文档中的[FocusManager 类](http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00002510.html)。这将指导您如何在组件上设置标签顺序。

所有这些元素（8 个文本字段，两个组件）在舞台上是否松散？还是它们在电影剪辑中分组？

# jquery - jQuery animate() 和浏览器性能

> ID：459224
> 
> 赞同：35
> 
> 时间：2009-01-19T21:27:57.693
> 
> 标签：jquery, performance, animation, cpu-usage

我有一些元素在页面上移动得非常缓慢。本质上，我在 40 秒左右的时间内减少了两个图像的左边距。

从视觉上看，它工作得很好。**但是，我的处理器在动画期间的使用率跃升至 50% 左右。**这也不是特定于任何单一浏览器的——在 Safari3 和 Firefox3 上也是如此。如果我让两个浏览器都运行该页面，我的 CPU 会以大约 95% 的使用率尖叫。

我正在使用 jQuery 1.3。两个动画同时发生。页面上没有 Flash。如果我将代码注释掉（删除动画）并刷新页面，我的处理器会立即恢复正常使用。

我希望我不必求助于 Flash，但即使在 Hulu.com 上观看节目也不会像这样占用我的 CPU。

想法？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2010-12-08T21:43:30.260

我知道这是一个老问题，[蒂姆提供了一个很好的答案](https://stackoverflow.com/questions/459224/jquery-animate-and-browser-performance/2893656#2893656)，但我只是想我应该为任何寻求解决这个问题的人发布更新，因为现在有一种更简单的方法......

从**jQuery 1.4.3**开始，您可以直接通过**[jQuery.fx.interval](http://api.jquery.com/jQuery.fx.interval/)**属性设置 jQuery 的动画使用的间隔。因此，您可以简单地执行以下操作：

```
jQuery.fx.interval = 50; 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-19T21:43:14.200

我认为 jQuery animate() 的工作方式是它使用一个计时器，该计时器定期触发并调用一个更新 DOM 以反映动画状态的函数。通常动画相对较短，它们可能覆盖相当多的屏幕空间，所以我怀疑（没有确认）计时器到期并以相当高的速率重置以生成流畅的动画。由于您的动画需要很长时间，您可以修改 animate 函数，以便可以通过选项设置动画进行的速率。在您的情况下，您只需要每 250 毫秒左右更新一次，因为您大约每秒覆盖大约 3-4 个像素。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-05-23T22:01:30.723

人们提到减慢 jQuery 的刷新率。您可以使用此文件 (jquery.animation-fix.js) 覆盖 jQuery 1.4 中的计时器功能：

```
function now() {
    return (new Date).getTime();
}
jQuery.fx.prototype.custom = function( from, to, unit ) {
    this.startTime = now();
    this.start = from;
    this.end = to;
    this.unit = unit || this.unit || "px";
    this.now = this.start;
    this.pos = this.state = 0;

    var self = this;
    function t( gotoEnd ) {
        return self.step(gotoEnd);
    }

    t.elem = this.elem;

    if ( t() && jQuery.timers.push(t) && !jQuery.fx.prototype.timerId ) {
        //timerId = setInterval(jQuery.fx.tick, 13);
        jQuery.fx.prototype.timerId = setInterval(jQuery.fx.tick, 2050);
    }
} 
```

所以用这个修改行

```
jQuery.fx.prototype.timerId = setInterval(jQuery.fx.tick, 50); 
```

将 50 更改为您想要的任何间隔。以毫秒 (ms) 为单位

如果将此代码保存在不同的文件中，则可以像这样附加它：

```
<script src="/js/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/js/jquery.animation-fix.js" type="text/javascript"></script> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-22T17:29:51.643

jQuery animate 使用 javascript 函数 'setInterval' 每隔几毫秒更新一次对象。不幸的是，jQuery 中的间隔默认为“13 毫秒”。那是每秒 76 次更新。对于这样的慢速和中等动画来说，要多得多了。

13ms 被硬编码到 jQuery 中。所以你只能在jQuery.js中直接改变这个值。如果你只有缓慢的 clowds，你可以达到 100 毫秒。如果你也有一些更快的动画，你应该把它设置为 50。

您可以更改 setInterval() 的参数；在自定义函数中。'jQuery.fx.prototype { ... custom: function() { ... } ... }'

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T21:44:03.950

动画涉及循环操作，无论如何这些都会真正消耗 CPU。

我不知道用 jQuery 做起来有多容易，但需要发生的是动画需要消耗更少的周期。要么你让 ani 更加锯齿（显示不那么流畅），循环需要优化，或者减少 ani 的工作。

40秒？动画是不是有点长？我认为他们应该比这更直接。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T21:47:00.917

我刚刚在 Scriptaculous 下观察了动画的性能，发现了类似的 CPU 峰值：IE 大约为 50%，Firefox 的性能稍好（16-30%）——两者都在 DuoCore PC 上。由于 JQuery 和 Scriptaculous 都是通过更改底层 CSS 来工作的，所以我认为可以肯定地说任何 Javascript 实现在计算上都会很昂贵。

您很可能会被 Flash 卡住。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-16T00:04:40.663

我真的很喜欢 Tim 发布的答案，尽管我需要让这个修复程序在 Drupal 6 生产环境中工作。

我通过使用 jQuery 更新模块安装了 jQuery 1.3.2，所以我使用的和 Tim 的修复程序设计的 jQuery 1.4 之间存在一些差异。

按照蒂姆的指示，我完成了 90% 的工作，我只需要花 10 分钟的时间来想出这段代码。

25 - 33 的计时器值似乎比 13 毫秒的中速动画效果好得多，例如褪色背景图像。

```
var timerId;

function now() {
    return (new Date).getTime();
}

jQuery.fx.prototype.custom = function( from, to, unit ) {
    this.startTime = now();
    this.start = from;
    this.end = to;
    this.unit = unit || this.unit || "px";
    this.now = this.start;
    this.pos = this.state = 0;

    var self = this;
    function t( gotoEnd ) {
        return self.step(gotoEnd);
    }

    t.elem = this.elem;

        if ( t() && jQuery.timers.push(t) && !timerId ) {
    timerId = setInterval(function(){
        var timers = jQuery.timers;

        for ( var i = 0; i < timers.length; i++ )
            if ( !timers[i]() )
                timers.splice(i--, 1);

        if ( !timers.length ) {
            clearInterval( timerId );
            timerId = undefined;
        }
    }, 25);
}
}; 
```

# c# - 资源文件和附属程序集

> ID：459232
> 
> 赞同：2
> 
> 时间：2009-01-19T21:31:14.193
> 
> 标签：c#, resources, satellite-assembly

由于缺乏更好的词，我是本地化和资源文件的新手。我正在尝试本地化我正在处理的应用程序，并且我想使用资源文件和附属程序集来完成它，但我无法弄清楚如何正确地完成它。这是我到目前为止所拥有的：

在我的项目目录中：我创建了文件 LanguageText.resx 和 LanguageText.nl.resx

在我的项目/bin 目录中：我创建了文件夹“nl”

在我的 project/bin/nl 目录中：我使用 ResGen.exe 从 LanguageText.nl.resx 文件创建 LanguageText.nl.resources 文件，然后我使用 AL.exe 创建 project.resources.dll 文件。该 .dll 文件位于 bin/nl 文件夹中。它组装好了，现在我的 project/bin/debug 文件夹中也有 nl/project.resources.dll。

我的问题是我的程序中显然没有嵌入中性语言文件或资源，但我找不到任何关于如何做到这一点的信息。我能找到的有关以这种方式嵌入资源的唯一信息与附属程序集有关。如何嵌入中性语言资源？

任何帮助或方向表示赞赏。

谢谢，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-16T11:12:09.817

您可以在 AssemblyInfo 的帮助下完成此操作。转到 AssemblyInfo.cs 并添加属性

```
[assembly: NeutralResourcesLanguageAttribute("en-US",UltimateResourceFallbackLocation.Satellite)] 
```

确保`using System.Resources;`在顶部添加 using 语句。上一行表明您的程序集的中性资源语言是“en-US”，这是一个卫星程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T22:30:55.383

后备资源应放在 bin 文件夹中的 LanguageText.dll 中。或者，您可以将 System.Resources.NeutralResourcesLanguageAttribute 属性添加到 LanguageText.dll 程序集，并指定在文化不变或给定文化不匹配时使用的默认文化。

生成 nl 程序集，将其命名为 LanguageText.resources.dll，放在 bin/nl 文件夹中。

通过在您的线程上设置文化并使用 ResourceManager 来检索资源来验证这是否有效。

# c - 用 Valgrind 运行单元测试是不是有点矫枉过正？

> ID：459233
> 
> 赞同：36
> 
> 时间：2009-01-19T21:31:19.857
> 
> 标签：c, linux, unit-testing, valgrind, check-framework

就在几天前，我开始研究一个名为 check 的单元测试框架，并打算在 Linux 下在 c 代码上运行测试。

现在检查一下，一些设计良好的代码和一些测试代码可以帮助我验证基本功能是否正确，我的意思是很容易查看变量并返回响应，然后确定函数是否正确。

但是，假设我想测试一个动态内存结构，其中包含大量的 malloc 和 free，结果我可以将数据放入并再次取出正确的数据。但这并不能证明我在这个过程中没有破坏一些内存，假设我忘记释放一半的内存并丢失了指针（经典的 memleak）。该代码可能会通过大部分单元测试。

所以现在的问题是：用 ie Valgrind 运行整个单元测试代码并让他检测任何 malloc/free 问题是个好主意吗？（或者也许编译成电子围栏之类的东西？）

感觉是个好主意，但我不确定我要在这里做什么......

谢谢约翰

* * *

*更新：*感谢道格拉斯和乔纳森，这似乎是个好主意，我应该继续这样做:-)

*更新：* Valgrind 是一个有趣的工具，但是我发现这样做的第一个 memleaks 是在测试框架中，而不是我自己的代码（虽然很有趣）。因此，对其余部分的提示是在颠倒您自己的代码之前验证您正在使用的单元测试框架没有泄漏。在我的案例中，只需要一个空的测试用例，从那时起，除了单元测试框架之外什么都没有运行。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-19T21:42:52.453

我们当然可以 - 对单元测试运行 valgrind 比使用完整程序要容易得多。

此外，任何内存错误都本地化到单元测试正在测试的代码区域，这使得修复更容易。

加上检查您是否已修复它更容易 - 因为您正在运行单元测试而不是针对您的完整程序的更复杂的测试。

如果您以自动化方式运行 valgrind，您可能想要`--error-exitcode=<number> [default: 0]`

> 如果 Valgrind 在运行中报告任何错误，则指定要返回的替代退出代码。当设置为默认值（零）时，Valgrind 的返回值将始终是被模拟过程的返回值。当设置为非零值时，如果 Valgrind 检测到任何错误，则返回该值。这对于将 Valgrind 用作自动化测试套件的一部分很有用，因为它可以很容易地检测 Valgrind 报告错误的测试用例，只需检查返回码。

[http://valgrind.org/docs/manual/manual-core.html#manual-core.erropts](http://valgrind.org/docs/manual/manual-core.html#manual-core.erropts)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-19T22:02:02.883

正如 Douglas Leeder 所说，使用任何您可以动手的诊断软件运行单元测试是非常值得的，这将确保它确实按您的预期工作。这包括不滥用内存，所以使用 valgrind 是个好主意。

您真的希望您的单元测试能够证明您的代码有效。

您不必一直在 valgrind 下运行它们 - 但这样做应该尽可能简单，并且您应该定期这样做（比如在进行重大更改之后）。

# jquery - 是否可以将 SimpleModal 与 ASP.NET MVC 一起使用？

> ID：459236
> 
> 赞同：3
> 
> 时间：2009-01-19T21:31:32.383
> 
> 标签：jquery, asp.net-mvc, simplemodal

是否可以将 SimpleModal（jquery 插件）与 ASP.NET MVC 一起使用？因为里面有回发的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T21:35:34.903

是的你可以

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T22:06:21.330

因为它是一个 jQuery 插件，所以没有任何东西可以将它与 ASP.NET 回发模型联系起来。它与服务器语言无关。如果您喜欢[这里](https://stackoverflow.com/questions/394942/simple-modal-in-jquery)讨论的内容，可以将它与 PHP 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T13:41:15.483

我知道这是旧的，但只是为了记录，在源代码中，您需要从 appendTo('body'); 更改容器创建；appendTo('form');

# javascript - 您何时以及如何使用服务器端 JavaScript？

> ID：459238
> 
> 赞同：78
> 
> 时间：2009-01-19T21:33:42.957
> 
> 标签：javascript, server-side

有时我在搜索一些 JavaScript 帮助时会遇到术语“服务器端 JavaScript”。你什么时候会使用 JavaScript 服务器端？如何？

我对 JavaScript 的体验一直在浏览器中。有没有编译好的JS？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-19T21:43:26.697

它不是 AJAX，除非人们不恰当地使用了这个词。顾名思义，SSJS 是在服务器上运行的 JavaScript，由独立的（即独立于浏览器的）JavaScript 引擎解释，如 SpiderMonkey。

何苦？好吧，我目前看到它未被充分利用的一个领域是数据验证。使用 SSJS，您可以编写一段代码，然后在服务器和客户端上都使用该代码。因此，您可以立即从客户端 JS 获得用户反馈，这些反馈将自动匹配服务器上发生的数据检查。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-19T22:07:21.903

有一个项目[Phobos](https://phobos.java.net/)，它是一个服务器端 JavaScript 框架。

过去，Netscape Web 服务器也提供服务器端 java 脚本。

在这两种情况下，JavaScript 的使用就像您在服务器上使用任何语言一样。通常用于处理 HTTP 请求并生成内容。

[Rhino](http://www.mozilla.org/rhino/)是 Mozilla 的 Java JavaScript 系统，它将 JavaScript 编译成 Java 字节码，JVM 可以选择 JIT。其他系统使用其他方式执行 java 脚本，甚至有些系统正在 JIT 编译他们的 java 脚本内部代码。

我预见到服务器上将会有越来越多的 JavaScript。当您在客户端用 JavaScript 编写“厚”应用程序时，您不妨在服务器上用 JavaScript 编写逻辑，这样就不必从一种语言到另一种语言的认知飞跃。环境会有所不同，但您的大部分代码和知识将是可共享的。

最后，就实现而言，JavaScript 可能是目前投资最多的单一语言。来自 Apple、Mozilla、Google 甚至 Microsoft 以及使其成为更高级语言的努力（即基本上是一个具有 Algol 语法无宏的 Scheme）。

大多数这些实现都隐藏在浏览器中，但这并不是说在服务器端也没有价值。

工具是 JavaScript 最缺乏的地方，尤其是在服务器端，但如果你考虑像 Phobos 这样的东西，你可以在 IDE 中调试服务器端 JavaScript，这是一个很大的进步。

就个人而言，我在我的应用程序中使用 JavaScript，比如白漆。它以非常低的成本提供了廉价的可扩展性，并且是一个很好的推动者。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-09-01T21:25:09.547

## 2013年新闻

**[Node.js](http://nodejs.org/)**（另见[Wikipedia 文章](http://en.wikipedia.org/wiki/Node.js)）是成功的，[它的社区正在成长](https://stackoverflow.com/questions/tagged/node.js)！

[MongoDB](http://docs.mongodb.org/manual/core/server-side-javascript/)（服务器端）、[Chrome](http://en.wikipedia.org/wiki/Google_Chrome)（客户端）和*Node.js*（服务器端）使用 [V8 JavaScript 引擎](http://en.wikipedia.org/wiki/V8_(JavaScript_engine))。

PS：您的所有项目模块只能使用一种语言，Javascript：客户端 API、客户端接口、“服务器集线器”和服务器数据库（例如存储过程）。所有程序员“一次编码”！

* * *

*“ Server* *-Javascript”*和*“Client-Javascript”*语言之间的主要区别在[http://www.commonJS.org/，Server-Javascript](http://www.commonJS.org/)的标准库中进行了解释。

 **CommonJS*自 2009 年以来就存在，今天（2013 年）[是一个成熟的标准](http://en.wikipedia.org/wiki/CommonJS)，用于*MongoDB*和*Node.js。*

* * *

历史注释：*最古老*的活动“客户端+服务器 Javascript”（包括使用 PostgreSQL）打开包还活着！ [Whitebeam](http://www.whitebeam.org/)
于 2001 年发布并从那时起不断发展，是一种成熟的 Javascript（和 DOM）技术。最后一次更新是在 2016 年 1 月。

* * *

## 2016年新闻

[*Node.js*](http://nodejs.org)引擎继续作为基于 Chrome 的*V8 JavaScript*构建的运行时......事实上，现在已经取得了全面的成功！最后一个版本是*v7.0*和*v6.8 LTS*。

[JSON](http://json.org/)作为数据交换格式，在过去几年中的兴趣持续增长，[在 2016 年超过了对 XML 的兴趣](https://www.google.com/trends/explore?q=%2Fm%2F05cntt,%2Fm%2F08745,%2Fm%2F02nvq)（另请参见[2011 年超过的科学上下文](https://www.google.com/trends/explore?q=%2Fm%2F05cntt,%2Fm%2F08745,%2Fm%2F02pd26x&date=all&cat=174#TIMESERIES)）。作为原生 Javascript 格式，它也是一个很好的语言趋势指标。

自 2014 年以来，（更快的）[V8 引擎](https://en.wikipedia.org/wiki/V8_(JavaScript_engine))也是最常用的：在最流行的*客户端*（[桌面上的 Chrome](https://en.wikipedia.org/wiki/Usage_share_of_web_browsers#Summary_tables)和 Android 上的 WebView）和*服务器上*流行——Node.js 作为运行时，PostgreSQL 和[PL/V8](http://pgxn.org/dist/plv8/doc/plv8.html)用于 SQL 和存储过程.

...也许 2016 年最重要的服务器端贡献是对 JSON 和 Javascript 的快速且强大的数据库支持：使用 PostgreSQL 9.1+ (2016-10)，您可以通过简单的方式加载 PL/V8（以及 Coffeshop 等方言）`CREATE EXTENSION`命令; 最重要的是 PostgreSQL 9.5+ (2016-10)，一组完整的正交[JSON 和 JSONb 函数和运算符](https://www.postgresql.org/docs/current/static/functions-json.html)。

因此，事实上，存在一个快速、弹性和可靠的 ***统一 JavaScript 开发堆栈***。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-01-19T21:43:31.453

经典 ASP 能够在服务器上使用 JavaScript，尽管大多数人使用 VBScript。

在服务器上使用 JavaScript 的一个引人注目的用途是作为客户端数据验证的补充。例如，您可能在客户端和服务器上使用相同的 JavaScript 验证库。这可确保您在客户端上使用与服务器上相同的逻辑，但（可能）通过在客户端进行预验证来避免不必要的往返。

[Wikipedia在此处](http://en.wikipedia.org/wiki/Server-side_JavaScript)列出了许多服务器端 JavaScript 实现。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-19T21:37:20.000

它可以指使用 javascript 将消息发布到 Web 服务器而不重新加载页面：换句话说，AJAX。

但更有可能的是，我认为这意味着类似于[Aptana/Jaxer](http://www.aptana.com/)（或者，今天的 Node.js），它使用 javascript 作为服务器端语言。在这种情况下，请记住 javascript 只是一种语言：Web 浏览器中使用的 DOM 是一种 API。服务器端 javascript 引擎将提供自己的 API 对象，适用于数据库和文件系统访问等服务器端任务。

由于客户端验证问题，服务器端 javascript 是一个有趣的想法：您希望在客户端进行验证以避免向服务器发送不必要的请求。这提高了服务器性能并减少了客户端的延迟。但是您*必须*在服务器端进行验证，因为您不能信任客户端。这会导致客户端和服务器之间出现大量重复代码。

理论上，如果您的客户端和服务器语言匹配，您将不再需要相同逻辑的两个实现。实际上，它并不能很好地工作，因为页面请求的客户端和服务器视图是如此不同，并且因为您无法控制客户端使用的 javascript 引擎。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-19T21:43:21.190

这真的取决于您是在谈论 ASP.NET 还是 Classic ASP。如果您使用的是 ASP.NET，那么使用 Javascript 的理由并不多。

ASP Classic 是一个不同的例子。您可以在 ASP 中的服务器端使用 Javascript，就像使用 VBScript 一样。您可以像通过 VBScript 一样访问 Application、Server、Request 和 Response 对象。

在 ASP 的服务器端使用 Javascript 而不是 VBScript 可以带来真正的好处。这意味着您可以在浏览器代码和服务器代码之间共享代码。这也意味着您的开发人员不需要处理两种不同的语言。

不过，ASP 中的服务器端 Javascript 也有一些缺点。首先，在字符串连接时，它似乎不如服务器端的 VBScript 快。它也不如 VBScript 调用 COM 对象好（您只能通过返回值从 COM 调用中获取数据，而不是通过 out/byref 参数）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-19T21:42:10.723

您可能希望在浏览器和服务器中都有一些功能，以实现完全相同的实现。

一个示例是 wiki 语法的渲染器，您在浏览器中运行所见即所得编辑器并在服务器上运行以渲染结果页面。这样你就知道在这两种情况下渲染的结果将完全相同。

显然， [Rhino](http://en.wikipedia.org/wiki/Rhino_(JavaScript_engine))可以将 JavaScript 编译为 Java 类。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-19T21:43:10.470

传统上，Javascript 围绕文档对象模型运行。但是，如果您在一家 Java 商店工作并且想要一个围绕您的自定义对象模型的脚本引擎怎么办？这就是服务器端 Javascript 出现的时候。

[http://en.wikipedia.org/wiki/Server-side_JavaScript](http://en.wikipedia.org/wiki/Server-side_JavaScript)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-19T21:48:50.443

我记得[Cocoon](http://cocoon.apache.org/)（Apache 的 Java/XML/Javascript MVC 框架）我曾经使用服务器端 Javascript，因为有一些东西（我相信 cforms）需要用 Javascript 编写并在服务器上运行，即使我相信你可以用Java编写。

那时我们使用的是 Rhyno，请查看： http: [//peter.michaux.ca/articles/server-side-javascript-with-rhino-and-jetty](http://peter.michaux.ca/articles/server-side-javascript-with-rhino-and-jetty)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-19T21:53:23.087

是的，我刚刚在某个名叫[John](https://stackoverflow.com/users/6524/john-resig) [Resig的人的](http://jquery.com/)[博客](http://ejohn.org/blog/server-side-javascript-with-jaxer/)上阅读了有关 SSJS 的信息。

他描述了一个名为 Jaxer 的引擎，他说它是“想象一下撕掉 Firefox 的可视化渲染部分，并用 Apache 的钩子代替它——粗略地说，这就是 Jaxer。”

对于任何了解 ASP.NET 的人来说，HTML 看起来很熟悉

```
<html>
<head>
  <script src="http://code.jquery.com/jquery.js" runat="both"></script>
  <script>
    jQuery(function($){
      $("form").submit(function(){
        save( $("textarea").val() );
        return false;
      });
    });
  </script>
 <script runat="server">
    function save( text ){
      Jaxer.File.write("tmp.txt", text);
    }
    save.proxy = true;

    function load(){
      $("textarea").val(
        Jaxer.File.exists("tmp.txt") ? Jaxer.File.read("tmp.txt") : "");
    }
  </script>
</head>
<body onserverload="load()">
   <form action="" method="post">
    <textarea></textarea>
    <input type="submit"/>
  </form>
</body>
</html> 
```

注意 runat="sever" 和 runat="both"

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-19T21:56:00.600

[http://steve-yegge.blogspot.com/2007/06/rhino-on-rails.html](http://steve-yegge.blogspot.com/2007/06/rhino-on-rails.html)

查看 Steve Yegge 如何在 Rhino 中使用服务器端 JavaScript 以及为什么。他有很多关于他如何看待 JavaScript 正在兴起和到来的东西。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-07-13T18:40:15.317

使用[ASP，您可以通过](http://aspjavascript.com/)多种方式使用服务器端 JavaScript。我最常用的方法是[在客户端和服务器上执行相同的代码进行验证](https://stackoverflow.com/questions/459238/when-and-how-do-you-use-server-side-javascript/459288#459288)。

`file.js`

```
<!--//--><%

//javascript code
function example(){return "Hello, World!";}

//%> 
```

`file.html`

```
<%@LANGUAGE="javascript"%>
<!-- METADATA TYPE="typelib" 
FILE="C:\Archivos de programa\Archivos comunes\System\ado\msado15.dll" -->
<!--#include file="file.js"-->
<html>
<head>
  <script language="javascript" src="file.js"></script>
</head>
<body>
<%=example();%>
<script language="javascript">alert(example());</script>
</body>
</html> 
```

`file.js`以允许包含相同文件的方式开始和结束。

# c++ - 有什么区别：LoadUserProfile -vs- RegOpenCurrentUser

> ID：459248
> 
> 赞同：4
> 
> 时间：2009-01-19T21:36:12.187
> 
> 标签：c++, windows, impersonation, token, roaming-profile

这两个 API 非常相似，但不清楚它们的区别是什么以及何时应该使用它们（除了指定 LoadUserProfile 用于我没有使用的 CreateProcessAsUser。我只是模拟配置单元访问）。

LoadUserProfile [http://msdn.microsoft.com/en-us/library/bb762281(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb762281(VS.85).aspx)

RegOpenCurrentUser [http://msdn.microsoft.com/en-us/library/ms724894(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724894(VS.85).aspx)

根据服务和注册表文章： http: [//msdn.microsoft.com/en-us/library/ms685145](http://msdn.microsoft.com/en-us/library/ms685145(VS.85).aspx) (VS.85).aspx 我们应该在模拟时使用 RegOpenCurrentUser。

但是，如果用户配置文件正在漫游，RegOpenCurrentUser 应该/应该做什么 - 它应该加载它吗？

据我从这些文档中可以看出，这两个 API 都为线程模拟的用户提供了 HKEY_CURRENT_USER 的句柄。因此，它们都“加载”配置单元，即将其锁定为数据库文件，并为注册表 API 提供一个句柄。

看起来 LoadUserProfile 加载用户配置文件的方式与用户登录时的方式相同，而 RegOpenCurrentUser 没有 - 这是正确的吗？这两个 API 如何安装配置单元的根本区别是什么（如果有的话）？

如果发生的事情之间有什么影响和区别（如果有的话）

1.  当每个模拟句柄都在使用时，用户登录或注销？

2.  调用每个匹配的关闭函数（RegCloseKey 和 UnloadUserProfile）时，用户已经登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-08T04:56:28.920

> 但是，如果用户配置文件正在漫游，RegOpenCurrentUser 应该/应该做什么 - 它应该加载它吗？

它不加载配置文件。可以这样想：如果是这样，您必须`UnloadUserProfile()`在完成处理后以某种方式调用 to `HKEY_CURRENT_USER`。

> 看起来 LoadUserProfile 加载用户配置文件的方式与用户登录时的方式相同，而 RegOpenCurrentUser 没有 - 这是正确的吗？

是的。

> 这两个 API 如何安装配置单元的根本区别是什么（如果有的话）？

没有任何。

> 如果用户登录或注销而这些模拟句柄中的每一个都已在使用中，会发生什么情况之间的含义和区别（如果有）是什么？

他们将获得自己的打开和关闭的句柄（同一个键）。

> 调用每个匹配的关闭函数（RegCloseKey 和 UnloadUserProfile）时，用户已经登录？

同上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-09T16:25:26.980

由于我目前正在尝试完成与您相同的事情，因此我想我会附和过去几天的发现。

我在 Windows XP sp3 环境中工作，并尝试在两种不同的情况下使用 CurrentUser 注册表访问来实现模拟

如果您遇到任何有用的东西，如果您分享您的经验，我将不胜感激。[我的堆栈溢出问题可以在这里找到](https://stackoverflow.com/questions/4392221/c-impersonation-and-currentuser-registry-access)

管理员 > 受限用户和受限用户 > 管理员

到目前为止我注意到的是（在 Windows XP sp3 中）

## 加载用户配置文件（）：

仅当模拟用户启用了 SeRestoreName 和 SeBackupName 权限时才有效（仅仅为有问题的受限用户启用这两个权限是不够的，因为它仍然因访问被拒绝错误而失败 - 有关详细信息，请参阅我的 StackOverflow 问题）。`LoadUserProfile()`到目前为止，我能够成功调用的唯一方法是在开始模拟之前通过管理员帐户进行调用。

## RegOpenCurrentUser():

只有在用户的配置文件已经加载时才能“正常”工作，到目前为止，我所做的每一次尝试都只能获得 S-1-5-18 配置单元的句柄，除非用户配置单元已加载并可在下访问HKEY_USERS 已经

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-29T02:24:42.253

这两个函数在不同的情况下使用。

[`LoadUserProfile`](https://msdn.microsoft.com/en-us/library/bb762281)如果尚未加载用户配置文件，则适用。

[`RegOpenCurrentUser`](https://msdn.microsoft.com/en-us/library/ms724894)如果用户配置文件已经加载，例如，如果您想访问已经交互登录的用户的注册表配置单元，则此选项是合适*的*。

请注意，`LoadUserProfile`通常*在没有*模拟的情况下调用它（因为您必须具有管理员权限才能使用它）但`RegOpenCurrentUser`必须在*模拟*的情况下调用。

# .net - .Net 自定义控件可以在 VB6 形式中使用吗？

> ID：459250
> 
> 赞同：8
> 
> 时间：2009-01-19T21:36:54.540
> 
> 标签：.net, vb6, activex, custom-controls

我正在对 VB6 Windows 应用程序进行一些维护。我有一个想在 VB6 表单上使用的 .Net 自定义控件组件。这可能吗？我知道如何通过为 .Net DLL 生成 COM 类型库来从 VB6 访问非可视 .Net 组件，但是可以像 VB6 中的 .OCX 一样使用 .Net 自定义控件吗？如果是这样，控件是如何在 VB6 中实例化，添加到表单等的。

提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T22:44:48.740

Interop Forms 工具包将为您提供所需的内容：

[http://msdn.microsoft.com/en-us/vbasic/bb419144.aspx](http://msdn.microsoft.com/en-us/vbasic/bb419144.aspx)

它允许您在 VB.net 中创建用户控件，然后您可以将其添加到 VB6。它还允许您从 VB6 代码中显示 .net 表单。

我已经成功地使用它为我的旧 VB6 代码提供了 .net 工具栏 - 更好！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T22:33:58.607

这将引导您逐步完成整个过程。

[http://www.codeproject.com/KB/vb-interop/UsingDotNETControlsInVB6.aspx](http://www.codeproject.com/KB/vb-interop/UsingDotNETControlsInVB6.aspx)

这不是一个完美的选择，所以你将不得不探索这些限制对你的影响有多严重。

# design-patterns - 将 GetObjectColletion 方法放在哪里？

> ID：459259
> 
> 赞同：1
> 
> 时间：2009-01-19T21:38:54.210
> 
> 标签：design-patterns, oop

应用程序有一个 Foo 类，它是一个具体类，所有业务逻辑和行为都正确定义。

也就是说，需要获取在此应用程序中持久保存的所有 Foos 的集合。

这个“IEnumerable GetFoos()”方法应该放在哪里？

不在 Foo 类本身，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:43:25.790

您将需要一个派生自 CollectionBase 的 Foos 类或类似的类来公开您的 Foo 类的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T08:16:23.533

要遵守 SOLID 原则，您应该考虑 Foo 类的真正目的。由于我不知道 Foo 的实施细节和内部运作，我不能说太多。但是这样的设计不是更传统吗？

```
class Foo
{
  IPersistancePresenter persistancePresenter;
  public Foo(IPersistancePresenter persistancePresenter)
  { 
     persistancePresenter = persistancePresenter;
  }
}

interface IPersistancePresenter <T>
{
  IList<T> GetInstancesOf<T>();
} 
```

Foo 不会改变（因为它不应该是 Foo 的责任），如果以后会有另一个类而不是 Foo，它必须被持久化并在运行时收集实例。

# java - Servlet URL 模式以匹配以斜杠 ("/") 结尾的 URL

> ID：459263
> 
> 赞同：8
> 
> 时间：2009-01-19T21:39:23.630
> 
> 标签：java, servlets, web.xml, url-pattern

**我想指定一个 Servlet URL 模式来匹配以斜杠（“/”）结尾且只有斜杠的 URL。**

我明白这种模式

```
    /示例/路径/*
```

将匹配一个 URL

```
    http://example.com/example/path/
```

并且这似乎有效。然而，同样的模式也会匹配

```
    http://example.com/example/path/a/
    http://example.com/example/path/b/
    http://example.com/example/path/c/
```

我只是在寻找一个`[http://example.com/example/path/](http://example.com/example/path/)`只匹配而不匹配的 URL 模式，`[http://example.com/example/path/a/](http://example.com/example/path/a/)`等等。

澄清：不允许以斜杠结尾的 URL 模式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T22:03:49.183

您很可能无法通过在 web.xml 中进行映射来做到这一点。

您可以做的是将 servlet 映射到 /mypath/*，然后通过 request.getPathInto() 检查 /mypath/ 之后的部分。如果是“/”，请运行您的代码。如果不是，则返回 404 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-20T03:32:03.203

在 NetBeans 中，如果我转到 web.xml 文件上的 Servlets 选项卡，IDE 会抱怨“错误：URL 模式不能以斜杠 (/) 结尾”。从[URL 规范](https://www.ietf.org/rfc/rfc1738.txt)中，它读取，

```
httpurl        = "http://" hostport [ "/" hpath [ "?" search ]]
hpath          = hsegment *[ "/" hsegment ] 
```

所以是的，带有结尾斜杠的 URI 是无效的。

# java - JDK文件夹中的类文件在哪里？

> ID：459268
> 
> 赞同：4
> 
> 时间：2009-01-19T21:39:57.263
> 
> 标签：java, jdk1.5

这听起来像是一个愚蠢的问题。Sun 的核心类文件`Button.class`在 JDK 安装文件夹中的什么位置`C:\Program Files\Java\jdk1.5.0_12`？

或者类文件是否驻留在`C:\Program Files\Java\jre1.5.0_12`文件夹中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T21:45:42.883

它们分布在几个罐子之间。看起来 Button 虽然在 jre/lib/rt.jar 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T21:46:02.540

类文件实际上作为 jar 文件驻留在所使用的 Java 发行版中。大多数文件都在 rt.jar（运行时）中。

大多数开发人员机器实际上都安装了两种形式的 Java。JDK（您在开发时经常使用并包含编译器），以及下载的基于 Java 的应用程序使用的 JRE，通常是您的 Web 浏览器。这些通常是两个相互不了解的独立分布。因此，不幸的是，您的问题的答案是“取决于您正在运行的是什么”。更糟糕的是，JDK 可能包含它自己的 JRE 副本......

这就是所谓的类路径地狱的来源之一，因为在运行 java 程序时并不总是清楚自己在使用什么。

如果从命令行运行 java，有时可以检测到正在使用的确切版本。

如果您使用 Eclipse，您可以选择您正在使用的 JDK 版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T21:46:28.407

双方。

它们是两种不同的 JVM 安装。一种用于编译（JDK代表Java Development Kit），另一种是大多数客户机器拥有的Java环境（JRE代表Java Runtime Environment）

在这两个中的任何一个上查找一个名为：

```
rt.jar 
```

平台核心所在的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T17:57:48.793

您可以通过反思检查自己的任何课程。

例如，我在哪里可以找到位于类路径中的 String 类？简单的

```
URL url = String.class.getResource("String.class");
System.out.println(url); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-15T06:55:03.160

JRE中其实也有包含。虽然 JDK 有她的 JRE 副本，所以我们可能会说 JDK 和 JRE，但实际上 java inbuild 类包含在 JRE 中。

# c# - 编写高效的 .Net/SQL Server 代码

> ID：459271
> 
> 赞同：4
> 
> 时间：2009-01-19T21:40:14.800
> 
> 标签：c#, asp.net, sql-server, performance

让我先说我不敲.Net（它帮助我谋生）......

我最近听说一个网站的开发商/所有者吹嘘说他有最少的硬件来支持他的网站 (plentyoffish.com)。该网站在 Alexa 流量方面被列为前 50 名。我正在努力思考如何通过做开发人员/所有者声称的事情来完成类似的事情，一个开发人员编写一个站点（他花了 2 周时间来建立初始站点），使用最少的硬件获得 200 万每小时点击次数（峰值）。较大的公司拥有巨大的网络农场来处理这样的流量......

您如何在硬件资源有限的情况下编写如此高效的代码（他声称他只使用了三个数据库服务器）？有没有人工作或开发过如此高效的网站？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T22:02:50.930

如果您避免所有给 ASP.NET 带来坏名声的拖放垃圾，Microsoft 堆栈将非常快。

*   IIS 是一个很好的 Web 服务器。
*   SQL Server 是一个很好的数据库。
*   C# 编译为快速代码。（这里可能需要资格:)
*   如果正确使用 ASP.NET 可以非常轻量级

这就是整个堆栈。都很好。你可以说出你喜欢微软的哪些方面、它的商业实践和它的消费产品，但他们的开发工具和服务器是一流的。

我对他们的网络堆栈的个人经验包括一个网站，该网站每秒浏览量约为 500 次，并且很少将服务器峰值超过 15%。这对于大多数操作来说已经足够快了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T22:01:31.120

这不仅仅是代码：做这样的事情需要开发人员、DBA 和 IT 的共同努力。团队的每个成员都必须认识到他们的工作对团队其他领域的影响。

当开发人员编写在重型 OLTP 系统上执行表扫描的查询时，他必须了解为什么它无法扩展。当 DBA 看到表扫描时，他必须了解如何在数据库级别或代码级别修复它。当系统管理员看到驱动器上的大量读取活动时，他必须了解它的根本原因（例如表扫描），以便决定是用更好的代码修复它还是投入更多的驱动器。

表现良好的系统是每个人都做得很好，并且与其他团队成员沟通得很好的结果。如果团队中只有一名成员将其他人扔到公共汽车下，那么系统将无法执行。听起来您已经通过将 .NET 和 SQL Server 扔在公共汽车上来做到这一点。;-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T21:51:11.220

对于网站，可以通过缓存完成一些非常了不起的事情。如果您可以有效地缓存内容，那么所使用的语言就不会那么重要了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T21:59:40.313

正如 jle 所说，缓存是关键。此外，它可能只是网站上用户交互的性质。我可能错了，但我认为这个例子，充足的鱼。com，不是一个特别资源/用户密集的网站。*据推测，用户个人资料中*有大量数据，但（根据我有限的经验检查）该网站的目的不是操纵、关联或转换数据，而是简单地返回符合用户标准的个人资料 - - 但并不是真的以任何方式按摩这些数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T21:59:48.223

与替代方案相比，.Net 实际上非常有效。那里还有什么？php？爪哇？红宝石？当然，您可以用 C++ 编写您的 Web 应用程序，但这将是实现和维护的一大难题。此外，正如其他人所提到的，通过适当的缓存、数据库调整和算法，您可以获得非常好的性能。比仅仅选择一种快速的语言和编写未经调整的代码具有更高的性能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T22:00:28.610

这是一个很难回答具体问题的问题，但即使使用相同的语言，软件开发中的所有选择也并非都是平等的。你在某样东西上层层叠加的框架越多，你离“真正重要的事情”就越远，如果“真正重要”的是性能，那么可以在那个“较低级别”编程的人可以做很多事情，比通过拼凑控件来开发程序的人快很多倍。有时，易于开发比原始速度更重要，因此它并不总是正确选择较低级别的正确选择 - 易于维护代码也很重要，有时甚至超过原始性能。

我曾经与另一位试图为一家大型金融服务公司赢得 6 位数合同的顾问正面交锋，我们都在推销 BI/EIS 系统的想法。他使用了臃肿的技术和每一步，但这都是他非常自豪的“新的和闪亮的”技术，并且包含了所有正确的流行语。

我用 asp（asp 经典，.net 尚未推出）编写我的，并使用自定义编写的本地 SQL Server 通信方法，以及所有手动编码的例程来生成报告和其他类似的性能增强决策。他使用报告编写器插件和即插即用控件来构建他的系统。我在 200 英里外的家庭办公室中通过 28.8 拨号线路对我的开发网络服务器进行了整个演示 - 他是针对隔壁房间中通过 100Mbit 以太网连接的更强大的开发服务器完成的，它仍然慢了很多很多倍。

演示结束后，我告诉我的客户我的整个演示都是通过拨号线路完成的（他们认为它是本地的）。由于该系统的大多数用户分散在全国各地，而宽带在当时并不常见，因此最终达成了交易。

# email - 您在电子邮件中使用自动换行吗？

> ID：459281
> 
> 赞同：13
> 
> 时间：2009-01-19T21:42:58.740
> 
> 标签：email, word-wrap

我想知道是否应该在文本电子邮件中应用自动换行？那么 HTML 电子邮件呢？如果是这样，你通常会用什么字符换行？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T21:46:06.237

[RFC 2646](http://www.ietf.org/rfc/rfc2646.txt)说：

> Text/Plain 媒体类型是 Internet 电子邮件的最低公分母，行数不超过 997 个字符（按照惯例，通常不超过 80 个）

另一个流行的标准是在 72 个字符处换行。这可以追溯到许多控制台应用程序（如 EDIT 和许多 BBS 界面），它们在 ASCII“窗口”中显示文本，包括边框和滚动条，允许显示的字符略少于 80 个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T21:56:52.347

通常在 72 处换行（80 也很常见，但这意味着引用时它将超过 80）以处理至少一两个级别的引用。有“text/flowed” MIME 类型，这意味着客户端将在窗口边界处自动包装文本，但没有多少客户端支持它。只需将您的编辑器设置为 72 换行，大多数人都可以安全阅读。

编辑：确切的类型是`text/plain`加上 `format=flowed`这样的：

```
Content-Type: text/plain; format=flowed 
```

有关解释，请参阅[rfc2646](http://www.ietf.org/rfc/rfc2646.txt)。

应该避免使用 HTML 邮件 IMNSHO，并不是每个人都在浏览器中阅读邮件或拥有支持 HTML 的邮件客户端。大多数使用 HTML 的理由（用下划线、粗体等来丰富邮件）都可以模拟。HTML 不需要包装，因为客户端会适应窗口大小。

HTML 的替代方案是“text/enriched”MIME 类型，它为您提供了 HTML 邮件的大部分优点而无需麻烦，但同样，可能并非所有地方都支持。

有关文本/丰富的内容，请参见[此处](http://en.wikipedia.org/wiki/Enriched_text)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-19T21:57:10.770

谷歌说结果 1 - 10 大约...

```
3,160 for +word +wrap +email +"80 characters"
2,820 for +word +wrap +email +"50 characters"
1,790 for +word +wrap +email +"60 characters"
1,720 for +word +wrap +email +"70 characters"
1,540 for +word +wrap +email +"100 characters"
1,250 for +word +wrap +email +"65 characters"
1,120 for +word +wrap +email +"40 characters"
  962 for +word +wrap +email +"75 characters"
  836 for +word +wrap +email +"72 characters" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T01:14:01.450

我经常发现自己开始使用以下电子邮件回复：

```
[Format recovered--see http://www.lemis.com/grog/email/email-format.php] 
```

我从 Greg Lehey 那里得到的。[该页面](http://www.lemis.com/grog/email/email-format.php)的一部分说：

> 显然，必须有某种方式来指定不应包装消息文本。那是文本/纯文本。有允许包装的特殊 MIME 附件类型，尽管我仍然认为这是一个坏主意。如果您指定您的消息可能会被包装，那么您就是在假设接收者的屏幕看起来像什么。即使你在某些时候是对的，你也不可能一直都是对的。例如，一个人可能有一个 200 个字符宽的屏幕，以便能够显示长日志文件条目，但他不希望看到那么长的文本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-17T00:50:06.597

# RFC 5322

[https://www.rfc-editor.org/rfc/rfc5322#section-2.1.1](https://www.rfc-editor.org/rfc/rfc5322#section-2.1.1)

> 2.1.1。行长限制

> 该规范对一行中的字符数有两个限制。每行字符必须不超过 998 个字符，并且应该不超过 78 个字符，不包括 CRLF。

> 998 个字符的限制是由于发送、接收或存储 IMF 消息的许多实现中的限制，这些消息根本无法处理一行中超过 998 个字符。为了健壮性，接收实现可以很好地处理一行中任意大量的字符。然而，有太多的实现（符合 [RFC5321] 的传输要求）不接受包含超过 1000 个字符的消息，包括每行的 CR 和 LF，因此不创建此类消息对实现很重要。

> 更保守的 78 个字符推荐是为了适应显示这些消息的用户界面的许多实现，这些消息可能会截断或灾难性地换行，每行超过 78 个字符的显示，尽管这样的实现不符合本规范的意图（以及 [RFC5321] 的意图，如果它们实际上导致信息丢失）。同样，即使对消息施加了这种限制，为了健壮性，显示消息以处理一行中任意大量字符（当然至少达到 998 个字符的限制）的实现也有责任。

另请参阅：RFC2045、RFC2046、RFC2047、RFC2049、RFC4289 和 RFC6838 以了解 MIME 规范。

阅读 RFC 很有趣。你知道你喜欢它:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T15:38:57.180

像[JavaMail](http://java.sun.com/products/javamail/)这样的优秀邮件 API将为您做到这一点。理想情况下，您不必明确考虑这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T21:47:46.843

一般来说，您应该以 80 或更少的价格换行，以让昏暗的客户在不换行的情况下进行报价。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T21:49:16.433

没有使用换行，直到我切换到 mutt/xterm（从不回头）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-19T21:55:07.873

在第 72 个位置之前的第一个空格字符处换行，如果没有，则在第 72 个位置处换行。在 Eudora 中，当我使用它时，约定是在行尾留一个空格表示它已被换行，因此它会向接收客户端发出信号，根据行的宽度在任何需要的地方重新排列段落客户的窗口。我不确定当前的电子邮件客户端是否属于这种情况。

# c++ - 在命令行上运行的 C++ 代码覆盖率工具

> ID：459287
> 
> 赞同：3
> 
> 时间：2009-01-19T21:43:26.213
> 
> 标签：c++, code-coverage

我使用代码覆盖工具来编写单元测试用例。我有一个代码覆盖工具，但只需要通过它的 GUI 界面来做所有事情。理想情况下，我想要一个能够在单个 .cpp 文件上生成文本输出（.diff 是最好的）的工具。这样的工具存在吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T21:46:17.377

[gcov](http://gcc.gnu.org/onlinedocs/gcc/Gcov.html)可以并且确实会产生文本输出。确保您使用最近的 gcc 来获取共享库的覆盖范围。

我不确定您如何获得覆盖范围的差异输出？

# cocoa - 直接将html代码传入WebKit

> ID：459292
> 
> 赞同：0
> 
> 时间：2009-01-19T21:44:30.687
> 
> 标签：cocoa, webkit

如何将包含在 a 中的 HTML 代码`NSString`直接传递到 WebKit。我正在寻找类似的东西：

```
[aNSTextField setString:@"foo"]; 
```

会像那样简单吗？还是我必须求助于将文本保存到文件然后使用`file://`url 访问它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T22:04:56.293

假设你有一个`WebView`：

```
[[myWebView mainFrame] loadHTMLString:myHTMLString baseURL:myBaseURL]; 
```

# javascript - Cognos Javascript - 如何限制在选择和搜索提示中选择的值的数量

> ID：459295
> 
> 赞同：0
> 
> 时间：2009-01-19T21:45:03.243
> 
> 标签：javascript, cognos

有谁知道如何限制在 Cognos 8 中的多选选择和搜索提示中可以选择的值的数量？目前选项是一个或无限，我想编写一个小 Javascript，将某个提示限制为 5 或 10 个值？有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T21:55:34.737

我不确定 Cognos 使用什么运行，但这里有一个简单的方法来确定`<select>`.

```
<script type="text/javascript">
function selCheck() {
    var sel = document.form1.s1
    var checked = 0
    for(var x=0;x<sel.length;x++) {
        if(sel[x].selected) {
            checked++
        }
    }
    alert(checked)
}
</script>
<form name="form1">
<select multiple style='width:80px;' size=5 name="s1" onclick="selCheck()">
    <option>1</option>
    <option>2</option>
    <option>4</option>
    <option>3</option>
    <option>5</option>
</form> 
```

当用户超过您指定的限制时，您必须取消选中最后一项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T09:22:40.683

为什么不尝试使用单独的查询来提供提示。然后，您可以将提要查询限制为查询过滤器中的最大行数...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T12:30:21.133

谢谢！这是我需要的方向，但并不完全在那里。我不知道如何在多选框中调用选定的值。Cognos 中的多选“选择和搜索”控件允许您从左侧选择值并将它们“插入”到右侧。我只需要计算插入到右侧的那些项目。不幸的是，Cognos 没有提供任何关于如何从 Javascript 调用这些项目的文档。

非常感谢任何其他想法。

# asp.net - ASP .NET 中的 TreeView 控件

> ID：459296
> 
> 赞同：1
> 
> 时间：2009-01-19T21:45:36.503
> 
> 标签：asp.net, treeview

我正在使用一个 asp .net 树视图控件，其“ShowCheckBoxes”属性已设置为“All”。现在，如果用户检查根节点，我希望它下的所有节点都被“检查”。我查看了事件模型，但找不到告诉我检查的节点是根节点还是子节点的事件或属性。

如何确定所选节点是根节点还是子节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T21:51:10.173

用javascript是可能的，看@

[http://geekswithblogs.net/ranganh/archive/2006/03/25/73300.aspx](http://geekswithblogs.net/ranganh/archive/2006/03/25/73300.aspx)

或者

[http://dotnetslackers.com/Community/blogs/kaushalparik/archive/2008/06/17/treeview-automatically-check-all-childnode-checkboxes-on-checking-parentnode-checkbox-using-javascript.aspx](http://dotnetslackers.com/Community/blogs/kaushalparik/archive/2008/06/17/treeview-automatically-check-all-childnode-checkboxes-on-checking-parentnode-checkbox-using-javascript.aspx)

对不起，简短的回答...

:)

//W

# jquery - 跨浏览器的jQuery过渡动画？

> ID：459302
> 
> 赞同：1
> 
> 时间：2009-01-19T21:46:11.790
> 
> 标签：jquery, animation, internet-explorer-7, cross-browser, firefox-3

是否有任何 jQuery 1.3 动画转换在 Firefox 3 和 IE7 中都可以使用？

我有一个包含多个表行（25 或更多）的表，其中一些行开始隐藏（这些行都共享一个公共类；在本例中，它是“.hidden”）。在表头中是一个“显示更多”链接，该链接通过绑定`.click()`到将显示隐藏行的函数，然后将“显示更多”更改为“显示更少”并将其更改为`.click()`执行相反操作的函数。

在每个`.click()`函数中，都有一行像

```
$(this).parents("tbody").children("tr.hidden").show(); 
```

替换`.show()`为`.hide()`“显示更少”功能。

但是，如果我尝试将`.show()`/`.hide()`替换为`.fadeIn()/.fadeOut()`，则 IE 会将其呈现为几乎相同，`.show()/.hide()`只是需要一分钟`.hide()`才能生效。那里没有真正的动画。在 IE 中较差，虽然在 Firefox 中效果很好。

如果我尝试使用`.slideDown()/.slideUp()`，它在 IE 中类似 janky，几乎相同，`.show()/.hide()`只是在完成转换后具有奇怪的脉冲效果。Firefox 3 也对此感到窒息，显然只是忘记了正在显示的表格行的行宽，并使整个事情看起来很糟糕。

那么动画只是在 IE7 中很烂吗？在这种情况下，有什么方法可以在两种浏览器中都可以正常运行吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T23:03:05.880

很多时候，拥有多个并发动画对于 IE 来说是很困难的。Javascript 引擎根本不在 Safari、Firefox 或 Chrome 附近。这适用于 IE6 和 IE7。我还没有使用过 IE8。

可以提供一点帮助的一件事是在您尝试制作动画的元素上设置静态高度。从 CSS/布局的角度来看，这通常并不理想，但是......这允许 jQuery 跳过必须首先计算每个元素的高度的任务，然后才能为元素的高度设置动画。

通常，您可以像处理单反相机一样处理动画。（在这里和我在一起）。如果您想快速拍摄体育赛事的照片，任何摄影师都建议您提前设置焦距、ISO 和快门速度。这样，相机就不必在每次拍摄之间计算所有这些东西，您只需按住快门按钮并点击-点击-点击-点击。A-团队风格。

无论如何，当涉及到动画时，请尝试考虑 javascript 需要计算以使动画发生的事情。不透明度、高度、计算高度（元素宽度 + 边框 + 内边距）、屏幕位置，都是很好的起点。

很多时候，当动画开始时，您实际上可以看到 jQuery 正在向 DOM 添加什么（使用[Firebug](http://www.getfirebug.com/)）。就像，在不透明动画上，您可以看到 style="opacity:1;" 在倒数到 0 开始之前添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:58:01.660

根据[jQuery 的兼容性页面](http://docs.jquery.com/Browser_Compatibility)，这种事情是一个错误，应该报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T05:31:29.310

在谈论跨浏览器的性能时，我不会过于明确。坦率地说，我见过一些沉重的 JS 动画会让 webkit 哭泣，而 FF 和 IE 处理得很好。

您只需要考虑浏览器具有不同的 CSS 和 JS 实现，有时很难指出您表现不佳的罪魁祸首。

以 IE 为例。如果您有一个 4000x4000 的块级元素和一个 2x2 透明 gif 设置为重复，那么每次您移动元素时，上帝保佑，IE 将重绘 2x2 gif 并计算每个 2000 次的 alpha。FF 要么缓存背景，要么有显着不同的重绘，在任何一种情况下，性能都是无与伦比的。手册中并没有说，你只需要小心你做什么和做什么。

# data-binding - 数据绑定到特定记录

> ID：459304
> 
> 赞同：0
> 
> 时间：2009-01-19T21:46:28.170
> 
> 标签：data-binding, datagridview, bindingsource

我有一个绑定到此表的 DataGridView：

```
[Users]
ID Name
-- ----
11 Qwe
22 Asd 
```

网格直接绑定到类型化的数据集表。

我有第二张这样的桌子：

```
[Records]
ID  UserID  Data
--  ------  ----
67  11      ....
68  11      .... 
```

Records.UserID 使用外键连接到用户。

我想要做的是：当用户双击用户 #11 时，我打开一个新网格，绑定到 [Records] 表，但只绑定到 UserID = 11 的行。双击、获取 ID、新网格等这些都可以。如果我这样做与 sprocs 连接，我不会有任何问题，但我希望它被绑定，我根本不知道如何做到这一点。

你能给我一些想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T22:01:19.920

如果您使用的是 DataSets/DataTables，那么您可以执行以下操作来过滤第二个网格的行：

```
string filter = String.Format("UserID = {0}", selectedUserId);
grdRecords.DataSource = ds.Tables["Records"].Select(filter); 
```

我相信您可以编辑返回的数组中的记录，但您将无法向此集合添加/删除新项目。您必须将它们添加到常规表中，然后重新过滤网格。

当然，还有各种其他方法可以做到这一点。如果您使用从 IBindingListView 派生的对象，例如 DataView 类的实例，您应该有权访问 Filter 属性。然后你可以这样做：

```
string filter = String.Format("UserID = {0}", selectedUserId);
DataView myView;
grdRecords.DataSource = myView;
myView.Filter = filter; 
```

您的视图将保持过滤状态，以匹配您放入其中的任何数据。

希望这篇文章足够清晰，让您能够弄清楚细节......我今天有点散漫。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T12:34:18.823

最后我不得不这样做：

1.  创建一个 DB 类，其公共属性 (MyDataSetProperty) 返回 typedDataset

2.  在接受 Id 参数的 DataSet 中创建一个自定义 Fill 函数。

3.  使用此函数填充私有 typedDataset 中的表

    this.myTableAdapter.FillCustom(this.myTypedDataset.MyTable, this.Id);

4.  将 bindingSource 绑定到此公共属性：

    this.bindingSource.DataSource = this.db.MyDataSetProperty;

# wpf - 如何更改 ControlTemplate 中标签的字体大小

> ID：459307
> 
> 赞同：2
> 
> 时间：2009-01-19T21:47:03.600
> 
> 标签：wpf, controltemplate, templatebinding

在我的 WPF ListBox 中，我有一个 ListBoxItem 的 ControlTemplate 样式。在那个 ControlTemplate 里面我定义了一个标签。根据一些细节，我需要更改标签的字体大小。所以从我的代码隐藏中，我需要确定字体应该是什么，然后我需要设置它。

这是我使用 ControlTemplate 的风格（我已经去掉了一些不相关的控件）

```
<Style x:Key="RecordTabList" TargetType="{x:Type ListBoxItem}">
            <Setter Property="Background" Value="{DynamicResource RecordIndexTabBackcolor}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>        
                            <Label
                                x:Name="myLabel" Grid.Column="0" Grid.ColumnSpan="1" Grid.Row="0" Grid.RowSpan="1" Margin="3,-2,0,-2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Foreground="{DynamicResource RecordIndexTabForeground}" 
                                FontSize="10" Height="Auto" BorderThickness="3,0,0,0"
                                Content="{Binding Path=Name}" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T06:27:54.123

如果我理解正确，您可能可以执行类似于以下的操作，只需更改 ListBoxItem 本身的 FontSize 属性；它将自动反映在您的标签上。将其复制到 VS 中并查看它的实际效果！

```
<Window.Resources>
    <Style TargetType="ListBoxItem">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Label Content="{TemplateBinding Content}" FontSize="{TemplateBinding FontSize}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources>
<Grid>
    <ListBox Margin="12">
        <ListBoxItem Content="Test 1" FontSize="14"/>
        <ListBoxItem Content="Test 2" FontSize="18"/>
        <ListBoxItem Content="Test 3" FontSize="22"/>
    </ListBox>
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T22:21:13.780

您可能可以在 FontSize 属性上使用[ValueConverter](http://msdn.microsoft.com/en-us/library/ms771571.aspx) .. 但我不能 100% 确定它们是否在 ControlTemplate 中工作。我似乎记得 Silverlight 有问题，但我不记得它是否在WPF。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T04:17:20.467

如果要在后面的代码中设置 FontSize，则应从 ControlTemplate 中删除 FontSize，然后在代码隐藏中为 ListBoxItem 设置它。如果要为所有 ListBoxItems 设置相同的大小，只需在代码隐藏中设置 ListBox 的 FontSize。

# mysql - 在 phpMyAdmin 中设置外键？

> ID：459312
> 
> 赞同：348
> 
> 时间：2009-01-19T21:48:10.710
> 
> 标签：mysql, phpmyadmin

我正在使用 phpMyAdmin 设置数据库。我有两个表 (`foo`和`bar`)，**索引在它们的主键上**。我正在尝试在它们之间创建一个关系表（`foo_bar`），使用它们的主键作为外键。

我将这些表创建为 MyISAM，但后来将这三个表都更改为 InnoDB，因为我读到 MyISAM 不支持外键。所有`id`字段都是`INT(11)`.

当我选择`foo_bar`表时，单击“关系视图”链接，并尝试将 FK 列设置为`database.foo.id`and `database.bar.id`，它显示**“未定义索引！”** 每列旁边。

我错过了什么？

## 澄清/更新

为了简单起见，我想继续使用 phpMyAdmin。我目前正在使用 XAMPP，它很容易让我专注于 PHP/CSS/Javascript，它带有 phpMyAdmin。

此外，虽然我还不能设置显式外键，但我确实有一个关系表，并且可以执行如下连接：

```
SELECT * 
FROM foo 
INNER JOIN foo_bar 
ON foo.id = foo_bar.foo_id 
INNER JOIN bar
ON foo_bar.bar_id = bar.id; 
```

没有在数据库中明确定义 FK 让我感到不舒服。

* * *

## 回答 #1

> 赞同：378
> 
> 时间：2009-09-25T22:29:44.917

如果你想使用 phpMyAdmin 建立关系，你必须做两件事。首先，您必须在引用表中的外键列上定义一个索引（在您的情况下是 foo_bar.foo_id）。然后，转到关系视图（在引用表中）并选择引用列（在您的情况下为 foo.id）以及 on update 和 on delete 操作。

如果您有多个相互链接的表，我认为外键很有用，特别是如果您正确设置引用选项，您的删除脚本将变得非常短。

编辑：确保两个表都选择了 InnoDB 引擎。

* * *

## 回答 #2

> 赞同：231
> 
> 时间：2011-06-05T18:22:50.467

phpMyAdmin 允许您使用它们的“关系”视图定义外键。但是因为 MySQL 只支持对“INNO DB”表的外部约束，所以第一步是确保你使用的表是那种类型的。

要设置外键，以便名为 CHILD 的表中的 PID 列引用名为 PARENT 的表中的 ID 列，您可以执行以下操作：

1.  对于这两个表，转到操作选项卡并将其类型更改为“INNO DB”
2.  确保 ID 是 PARENT 表的主键（或至少是索引列）。
3.  在 CHILD 表中，为 PID 列定义一个索引。
4.  在查看 CHILD 表的结构选项卡时，单击“添加字段”部分正上方的“关系视图”链接。
5.  您将获得一个表，其中每一行对应于 CLIENT 表中的一个索引列。每行中的第一个下拉列表允许您选择索引列引用的 TABLE->COLUMN。在 PID 行中，从下拉列表中选择 PARENT->ID，然后单击 GO。

通过对 CHILD 表进行导出，您应该会看到已为 PID 列创建了外键约束。

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2012-08-10T01:45:30.940

这是维基百科文章的摘要。它指定了您可以在 PHPmyadmin 中规定的不同类型的关系。我把它放在这里是因为它与@Nathan 关于设置“更新/删除”的外键选项的评论有关，但对于评论来说太大了 - 希望它有所帮助。

**级联**

每当主（引用）表中的行被删除（相应更新）时，具有匹配外键列的子（引用）表的相应行也将被删除（相应更新）。这称为级联删除（resp. update[2]）。

**严格**

当外键表中存在引用被引用表中的值的行时，不能更新或删除该值。同样，只要有外键表中的引用，就不能删除行。

**无动作**

NO ACTION 和 RESTRICT 非常相似。NO ACTION 和 RESTRICT 之间的主要区别在于，使用 NO ACTION 时，参照完整性检查是在尝试更改表后完成的。RESTRICT 在尝试执行 UPDATE 或 DELETE 语句之前进行检查。如果引用完整性检查失败，这两个引用操作的行为相同：UPDATE 或 DELETE 语句将导致错误。

**设置为空**

更新或删除引用行时，引用行中的外键值设置为 NULL。这只有在引用表中的相应列可以为空时才有可能。由于 NULL 的语义，外键列中具有 NULL 的引用行不需要引用行。

**默认设置**

与 SET NULL 类似，当引用行被更新或删除时，引用行中的外键值被设置为列默认值。

* * *

## 回答 #4

> 赞同：72
> 
> 时间：2015-07-28T05:25:19.523

在 phpmyadmin 中，您可以简单地通过其 GUI 分配外键。单击表并转到结构选项卡。在表格的下方找到关系视图（如下图所示）。

[![在此处输入图像描述](https://i.stack.imgur.com/Ks5HL.png)](https://i.stack.imgur.com/Ks5HL.png)

您可以从主键附近的列表框中分配锻造键。（见下图）。并保存

[![在此处输入图像描述](https://i.stack.imgur.com/G2dvy.png)](https://i.stack.imgur.com/G2dvy.png)

相应的 SQL 查询自动生成并执行。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2013-09-06T20:34:54.057

对于那些刚接触数据库的人......并且需要 ALTER 现有的表。很多事情看起来很简单，但在 A 和 B 之间总有一些东西……。

先来看看[这个](http://www.w3schools.com/sql/sql_foreignkey.asp)。

1.  确保您有 P_ID（父表和子表上的父 ID）。
2.  当然，它已经填写在父项中。不一定以真实和最终的方式在孩子身上。因此，例如 P_ID #3（可能在子表中多次指向父表中的原始 P_ID）。
3.  转到 SQL 选项卡（我使用的是 phpMyAdmin，其他的应该类似）并执行以下命令：

    ```
    ALTER TABLE child_table_name    
    ADD FOREIGN KEY (P_ID)   
    REFERENCES parent_table_name (P_ID) 
    ```

4.  单击子表，然后单击结构，最后单击关系视图。在那里完成你的数据库计划。在这之前有一个关于级联，限制等的很好的答案。当然它可以通过命令来完成......

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-11-25T10:56:07.247

***外键是指一个表的非主属性引用另一个的主属性*** **在phpMyAdmin中** 首先设置要设置外键的列作为索引

然后点击关系视图

在那里你可以找到设置外键的选项

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-21T09:07:57.327

InnoDB 允许您使用 ALTER TABLE 向表添加新的外键约束：

```
ALTER TABLE tbl_name
    ADD [CONSTRAINT [symbol]] FOREIGN KEY
    [index_name] (index_col_name, ...)
    REFERENCES tbl_name (index_col_name,...)
    [ON DELETE reference_option]
    [ON UPDATE reference_option] 
```

另一方面，如果 MyISAM 在您的上下文中比 InnoDB 具有优势，那么您为什么要创建外键约束呢？您可以在应用程序的模型级别处理此问题。只需确保对要用作外键的列进行索引！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-12-14T18:08:42.897

不要忘记两列应该具有相同的数据类型。

例如，如果一列是 INT 类型而另一列是 tinyint 类型，您将收到以下错误：

在 [PID 列] 上创建外键时出错（检查数据类型）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-11-06T06:41:59.293

这是旧线程，但回答是因为如果对任何人有用。

**步骤 1**。您的数据库存储引擎设置为**InnoDB**

**步骤 2**。创建主表

这`customer`是主表，`customer_id`是主键

[![在此处输入图像描述](https://i.stack.imgur.com/gXXVv.png)](https://i.stack.imgur.com/gXXVv.png)

**步骤 3**。创建外键表并给出索引

这里我们有`customer_addresses`相关的表并存储客户地址，所以这里`customer_id`有与`customer`表的关系

我们可以在创建表时直接选择索引如下

[![在此处输入图像描述](https://i.stack.imgur.com/yPLhn.png)](https://i.stack.imgur.com/yPLhn.png)

*如果您在创建表时忘记给出索引*，那么您可以从表的**结构**选项卡中给出索引，如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/9ZQWv.png)](https://i.stack.imgur.com/9ZQWv.png)

**第 4 步**。一旦索引给该字段，转到结构选项卡并单击**关系视图**，如下图所示

[![在此处输入图像描述](https://i.stack.imgur.com/OA1wy.png)](https://i.stack.imgur.com/OA1wy.png)

**步骤 5**。现在选择你想要做的ON DELETE和ON UPDATE，从当前表中选择列，选择DB（SAME DB），从该表中选择关系表和主键，如下图所示并**保存**

[![在此处输入图像描述](https://i.stack.imgur.com/0EBXF.png)](https://i.stack.imgur.com/0EBXF.png)

***现在检查关系是否成功，转到外表数据列表并单击外键值，您将重定向到主表记录，然后关系成功。***

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-09-06T09:32:40.500

第 1 步：您必须在 mysql 配置文件（my.cnf 或 my.ini 取决于您的操作系统）的 [mysqld] 部分下添加行：default-storage-engine = InnoDB 并重新启动 mysqld 服务。 [![在此处输入图像描述](https://i.stack.imgur.com/UT4uG.jpg)](https://i.stack.imgur.com/UT4uG.jpg)

第 2 步：现在，当您创建表时，您将看到表的类型是：InnoDB

[![在此处输入图像描述](https://i.stack.imgur.com/ceG8z.jpg)](https://i.stack.imgur.com/ceG8z.jpg)

第 3 步：创建父表和子表。现在打开子表并选择列 U 喜欢有外键：从操作标签中选择索引键，如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/SUn3i.jpg)](https://i.stack.imgur.com/SUn3i.jpg)

第 4 步：现在从底部靠近打印视图的同一子表中打开关系视图，如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/8TqnL.jpg)](https://i.stack.imgur.com/8TqnL.jpg) 第 5 步：选择列 U 喜欢将外键设置为 从下拉列表中选择父列。dbName.TableName.ColumnName

为 ON DELETE 和 ON UPDATE 选择适当的值 [![在此处输入图像描述](https://i.stack.imgur.com/gystc.jpg)](https://i.stack.imgur.com/gystc.jpg)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-07-13T05:55:04.450

确保您已将 mysql 存储引擎选择为**Innodb**而不是**MISAM**，因为 Innodb 存储引擎支持 Mysql 中的外键。

**在 phpmyadmin 中创建外键的步骤：**

1.  点击将具有外键的表的结构。
2.  `INDEX`为要用作外键的列创建。
3.  点击关系视图，位于表格结构下方

[![关系视图](https://i.stack.imgur.com/tYRlY.png)](https://i.stack.imgur.com/tYRlY.png)

4.  在“关系”视图页面中，您可以看到字段前面的选择选项（已成为 INDEX）。

[![设置外键关系](https://i.stack.imgur.com/HP6bI.png)](https://i.stack.imgur.com/HP6bI.png)

**UPDATE CASCADE**指定当被引用的列更新时该列将被更新，

**DELETE CASCADE**指定的行将在引用的行被删除时被删除。

或者，您也可以触发相同的 sql 查询

```
ALTER TABLE table_name
ADD CONSTRAINT fk_foreign_key_name
FOREIGN KEY (foreign_key_name)
REFERENCES target_table(target_key_name); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-10-18T18:54:02.943

首先将存储引擎设置为**InnoDB**

[![首先将存储引擎设置为 InnoDB](https://i.stack.imgur.com/Iz6as.png)](https://i.stack.imgur.com/Iz6as.png)

然后在结构菜单中启用**关系视图**选项

[![然后关系视图选项启用](https://i.stack.imgur.com/ZYhOL.png)](https://i.stack.imgur.com/ZYhOL.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-12-15T00:04:43.907

[来自https://dev.mysql.com/doc/refman/8.0/en/create-table-foreign-keys.html](https://dev.mysql.com/doc/refman/8.0/en/create-table-foreign-keys.html)的官方 MySQL 文档：

> MySQL 需要外键和引用键上的索引，以便外键检查可以快速且不需要表扫描。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-03-31T20:11:59.010

较新版本的 phpMyAdmin 不再具有“**关系视图**”选项，在这种情况下，您必须执行一条语句才能实现相同的目的。例如

```
ALTER TABLE employees
    ADD CONSTRAINT fk_companyid FOREIGN KEY (companyid)
    REFERENCES companies (id)
    ON DELETE CASCADE; 
```

在此示例中，如果删除了公司中的一行，则具有该 companyid 的所有员工也将被删除。

# sql - 数据仓库 - 营业时间

> ID：459316
> 
> 赞同：2
> 
> 时间：2009-01-19T21:49:08.947
> 
> 标签：sql, data-warehouse

我正在开发一个数据仓库，最终需要我根据工作时间创建报告。目前，我的时间维度以小时为单位。我想知道是否应该修改时间维度以包含“营业时间”的位字段，还是应该在分析结束时为其创建某种计算度量？有什么例子会超级壮观吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T22:03:06.610

Use a bit (or even another column) to specify whether an hour is a business hour at the time it is stored. Otherwise when you change the business hours you will become unable to reproduce historical reports.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:57:18.790

您的所有销售数据是否都在同一时区？例如，您是否跟踪不同时区的网点或不同时区的最终用户的销售情况？如果是这样，您可能希望在销售事实表中为“营业时间”创建该位字段，因为对于不同时区的用户和网点而言，动态计算该位字段将非常困难。

另外，您只想计算一次——将销售导入数据仓库时——因为该数据不太可能经常更改。这不像你会说，“这个销售过去是在营业时间，但现在不是了。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T21:59:48.143

营业时间是业务规则，因此它们将来可能会更改

将营业时间表示为基本时间和持续时间，例如 StartTime 0900，Duration 9.5 小时，这样您可以轻松更改间隔，根据不同营业时间做假设场景，并且营业时间可以跨越日期线而无需复杂的查询

当然，所有日期时间都应该是 GMT (UTC)，而*不是*本地时间，以避免夏令时的复杂性

编辑：我想我误解了这个问题，你的数据已经精确到小时......不，我认为我的答案是正确的，但是增加了工作时间间隔的有效开始日期和结束日期。这将允许粒度在未来发生变化，同时仍保留历史

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T21:54:37.063

我不确定这是否有帮助，但我会使用 UCT 来存储所有时间，然后有一个开始和结束时间来指定营业时间。一旦设置好，这将是一个简单的`If (SpecificHour >= BusinessStartingHour) And (SpecificHour <= BusinessEndingHour) Then ...`操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T21:56:30.523

如果您使用 Microsoft PerformancePoint 2007，您可以使用不同的选项进行测试。您可以修改您的维度并在图表、数据透视表、其他报告工具等中输出您的结果。

[http://office.microsoft.com/en-us/performancepoint/FX101680481033.aspx](http://office.microsoft.com/en-us/performancepoint/FX101680481033.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T21:56:41.927

“营业时间”会随着时间而改变吗？我想我是在问每一行是否需要与营业时间标志相关联，或者仅让报告本身（或某些参考）表决定该交易是否在营业时间内发生就足够了。

在其他条件相同的情况下，我可能会让报告为您执行此操作，而不是标记行，但如果营业时间随时间变化，您必须标记行以确保您的历史数据保持正确。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T22:00:44.837

It's a judgement call I think... one that depends on performance testing, system usage, etc. Personally, I'd probably create an indexed field to hold a flag in the interest of dealing with the logic to determine what is and isn't a business hour up-front (i.e. when the data is loaded). If done correctly (and again, depending on the specific usage) I think you might be able to get a performance gain as well.

# macos - OS X 的最佳方案或 LISP 实现是什么？

> ID：459323
> 
> 赞同：87
> 
> 时间：2009-01-19T21:52:34.120
> 
> 标签：macos, lisp, scheme, racket

我正在寻找一个版本的 Scheme 甚至是 LISP，我可以用它来恢复一些丢失的 Lisp 开发技能。一些网络功能会很好，但不是必不可少的。

我看过 Plt 和 MIT 方案，虽然两者看起来都不错，但 Plt 似乎功能更丰富。我还查看了 Lisp 实现，但所有这些似乎都非常昂贵。

我喜欢免费/廉价的实现，因为这很可能只是偶尔的爱好编程。你会有什么建议？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-01-19T22:09:13.523

我会选择Racket。它可能没有 SBCL 快，但它确实具有出色的库和文档，以及旨在让您立即开发和运行 Scheme 程序的集成环境。我真正喜欢 Racket 的 IDE DrRacket 的地方在于，您无需学习 Emacs，您无需学习 SLIME，您不必担心寻找第三者-派对库，因为几乎所有用于 Racket 的库都可以在[packages](http://pkgs.racket-lang.org/)中找到。总而言之，它确实缩短了学习曲线，让您可以专注于手头的实际任务：编写出色的代码。

此外，如果您想制作由 Racket 驱动的网站（我目前正在研究），它还带有一个[Web 服务器。](http://docs.racket-lang.org/web-server/)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-19T22:13:07.917

我对此做了很多实验。

[Clozure Common Lisp](http://www.clozure.com/clozurecl.html)（née Open MCL）是迄今为止最快的；在我的英特尔 Mac Mini 上比下一个竞争对手快 25-30%。

[MIT Scheme](http://www.gnu.org/software/mit-scheme/)在 Mac 上运行得非常好。我想我最终自己编译了它，但是那个站点上有二进制文件。PLT Scheme 也不错，并且可能更好地集成到 Mac 世界中。（PLT 方案现在称为[Racket](http://www.racket-lang.org/)，但更改后我没有尝试过它。）

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-20T02:21:11.160

我是 Clojure、SBCL 和 Clozure CL 的忠实粉丝。它们都很棒，但如果你只想刷新你的 Lisping 排骨，它们也太过分了。它们都需要大量的信息搜索、邮件列表搜索、软件包安装、irc 潜伏等。

Dr Scheme 只是安装并运行。四年半前，我使用 Dr Scheme 完成了 SICP 的前 3 章。没有什么比定义 Scheme 评估器本身更深刻的了。一旦你明白这一点，你就会对工业实力的兄弟们有更多的耐心。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-01-27T10:42:02.820

对于 Scheme，[DrRacket](http://docs.racket-lang.org/drracket/)很棒（包含在[Racket](http://racket-lang.org/)中）。

对于 Common Lisp，[Ready Lisp](https://github.com/jwiegley/ready-lisp)非常棒。带有 SBCL、Aquamacs 和 Slime 的单一 dmg 开箱即用。

从网站：

> Ready Lisp 是几个流行的 Common Lisp 包的结合，特别是用于 Mac OS X，包括：Aquamacs、SBCL 和 SLIME。下载后，您将拥有一个应用程序包，您可以双击它——然后发现自己处于完全配置的 Common Lisp REPL 中。
> 
> 对于想要以最少的麻烦尝试 Common Lisp 之美的 OS X 用户来说，它是理想的选择。教师也可以使用它为他们的 Mac 学生提供一个免费、完整的 Common Lisp 环境，让他们带回家。要求
> 
> Ready Lisp 的当前版本是 20090127，需要 Mac OS X 10.5 (Leopard)。
> 
> 它包括以下组件软件版本：
> 
> ```
> Aquamacs  1.6
> SBCL    1.0.24
> SLIME   2009-01-23
> CL-FAD  0.6.2
> CL-PPCRE    2.0.1
> LOCAL-TIME  0.9.3
> SERIES  2.2.10
> CL HyperSpec    7.0
> paredit.el  20
> redshank.el     1
> cldoc.el    1.16 
> ```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-19T22:33:13.913

我刚开始玩[Clojure](http://clojure.org/)。它显然有一个不错的[web 框架](http://groups.google.com/group/clojure/browse_frm/thread/448865254f9bd293)，并编译为 JVM 字节码。

我也经常使用[DrScheme](http://www.drscheme.org/)。这是一个简单但有用的 IDE。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-19T22:33:26.767

根据您定义“Lisp”的方式，[Clojure](http://clojure.org/)可能符合要求。它在 OS X 上运行良好（它在 JVM 运行的任何地方运行）。它具有网络功能并且是免费的。

它还具有新颖、新鲜和有趣的优点。可能是爱好编程的理想选择。编写 Web 应用程序或 GUI 应用程序（使用 Java 的 Swing 甚至 Qt）很容易。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-19T22:03:27.733

我自己没有使用过，但[Steel Bank Common Lisp](http://www.sbcl.org/ "钢铁银行 Common Lisp")在 reddit 上获得了一些好评。它是开源和免费的，因此价格适合一些爱好编程。

过去，我在我的 macbook pro 上运行过[GNU Common Lisp 。](http://www.gnu.org/software/gcl/ "GNU Common Lisp")

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-27T10:22:15.090

如果您正在寻找 Scheme，可以查看刚刚发布的**JazzScheme**。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-01-07T21:15:25.420

我确实向新手推荐 Racket，因为它为 Scheme 初学者（或者更确切地说，恰好是使用 Scheme 的编程初学者，或者更好的是，通过 HtDP 工作）提供了最好的 IDE 之一。

[http://racket-lang.org/](http://racket-lang.org/)

对于那些对小型 Scheme 系统更感兴趣以便自己修改或阅读其源代码的人来说，另一种选择是 Larceny Scheme，它之所以有趣主要是因为它的 JIT 编译器 Twobit 本身完全在 Scheme 中实现。

[http://www.larcenists.org/](http://www.larcenists.org/)

* * *

更新：另外，Chez Scheme 最近开源了：

[https://github.com/cisco/ChezScheme](https://github.com/cisco/ChezScheme)

（它可能不像 Larceny 那样“小”，但它有一个非常积极的优化编译器。）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-19T22:16:33.680

您可能想查看[Lisp 用户协会](http://alu.org)或[Common Lisp Wiki](http://www.cliki.net/index)上的内容以了解其中的内容。我为自己设置了 Steel Bank Common Lisp 和 Emacs，但到目前为止还没有做任何事情。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-19T22:12:13.067

如果你只是爱好编程，LispWorks 有一个免费的个人版本，它非常强大和复杂。最大的问题是几个小时的运行时间限制。因此，您不会在其中编写任何长时间运行的服务器，但这并不意味着它不是一个有用的工具。

CLISP 可以在大多数东西上运行，实际上非常好，它只是不做线程。（如果您想编写一个实际的服务器，这很重要，但正如 PHP 和 Perl 向我们展示的那样，Apache + [插入语言] 是一个非常可行的平台。）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-04-21T13:10:46.220

[Clozure CL](http://ccl.clozure.com/)可从 mac 商店免费获得！

[http://itunes.apple.com/us/app/clozure-cl/id489900618](http://itunes.apple.com/us/app/clozure-cl/id489900618)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-11-14T02:23:58.877

我发现[Chicken](http://www.call-cc.org/)适用于 Scheme 并且可以通过 homebrew 获得。

```
brew install chicken 
```

SICP 中的大部分代码只需稍作修改即可工作。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-19T19:27:07.033

我最近一直在问自己同样的问题。在 OS X 上使用 DrScheme 后，它将是我在任何平台上的 Scheme 分发的首选。非常好的 IDE、调试功能和一组好的库/框架（包括一个非常好的 GUI 工具包，“即使在 Mac 上也能正常工作”;-)）

然而，我现在正在为 Common Lisp 寻找一个同样舒适的环境。它归结为 CCL (OpenMCL) 与 SBCL。SBCL 似乎是流行的选择，但我在 OS X 上读到不支持线程。（这真的是一个问题吗？）。另一方面，Clozure CL 拥有对原生线程、obj-bridge 等的良好支持……

我发现 CCL 有点奇怪，但我会坚持一段时间 - 它看起来仍然是集成的合乎逻辑的选择。

我使用 Emacs 23（使用 --with-ns 从源代码构建）和 Slime 作为环境，这对我来说效果很好。:-)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-07-02T13:58:47.287

与[球拍](https://racket-lang.org/)一起去。我很高兴！

# vbscript - 是使用子类中的属性来访问父类，还是公开父类更好？

> ID：459326
> 
> 赞同：3
> 
> 时间：2009-01-19T21:53:40.700
> 
> 标签：vbscript, class, parent-child

我有2个班级，一个父母和一个孩子。

```
 Class Test
    Private Test_Text

    Private Sub Class_Initialize()  
        Test_Text = "Hello"
    End Sub  

    Private Sub Class_Terminate()   

    End Sub 

    Public Property Get Text
        Text = Test_Text
    End Property

    Public Property Let Text(ByVal strIn)
        Test_Text = strIn
    End Property
End Class

Class SubTest
    Public SubTest_Test 
    Private SubTest_Interger

    Private Sub Class_Initialize()  
        Set SubTest_Test = New Test
    End Sub  

    Private Sub Class_Terminate()   
        Set SubTest_Test = Nothing
    End Sub

    Public Property Get int
        int = SubTest_Integer
    End Property

    Public Property Let int(ByVal intIn)
        SubTest_Integer = intIn
    End Property    
End Class 
```

因为我已经公开了 SubTest_Test 我可以像这样通过子类访问它

```
 Set MyTest = New SubTest
MsgBox MyTest.SubTest_Test.Text 
```

这是可以接受的还是我应该将 SubTest_Test 设为私有并在子类中写入属性以访问父属性？

编辑：我想问题应该是，直接访问父级是否存在任何安全/可用性问题。
从可用性的角度来看，我越想越多，最好对使用子类的任何人隐藏父级。这样，当您从子类创建对象时，您不必了解父类的任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T21:57:07.277

由于这是`HAS-A`您的两个班级之间的关系，所以我认为您应该保持原样。你不需要为不需要的东西引入封装代码。

这是一个伪代码示例：

```
class Engine
    [method] start()

class Car
    [property] Engine 
```

理想情况下，您希望将其引用`Engine`为如下属性`Car`：

```
Car.Engine.start() 
```

另一种方法是编写额外的代码`Car`以将方法包装在`Engine`. 虽然您可以这样做，但它没有多大意义，因为您将只是编写从`Car`to的传递方法`Engine`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T04:29:49.713

no - this violates the [Law of Demeter](http://en.wikipedia.org/wiki/Law_of_Demeter); rethink the interface - under what circumstances would someone need to access the Text property of the enclosed Test object in a SubTest object? If these situations make sense, you'll need to expose Text as a property in SubTest.

Given the names I would have expected SubTest to inherit from Test and thus automatically expose the Text property, but thankfully I have forgotten VBSCRIPT so I can't remember if it even supports inheritance ;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T21:57:56.620

我会说这取决于您要公开的属性的数量。但是封装始终是一个很好的规则。如果 Text 是您将要访问的唯一属性，我很可能会将 SubTest_Test 设为私有并包装该属性。

# asp.net - 使用母版页获取单选按钮的价值

> ID：459349
> 
> 赞同：0
> 
> 时间：2009-01-19T21:59:16.477
> 
> 标签：asp.net, javascript

我有一个使用母版页的 aspx 页面。在此页面上，我有一组单选按钮。我需要为javascript中单选按钮组中的每个元素获取选中的属性。在将页面转换为使用母版页之前，以下 javascript 代码可以正常工作：

```
if((!f.rblRegUseVehicles[0].checked) && (!f.rblRegUseVehicles[1].checked))
{
    isValid = "false";
} 
```

f 是对表单的引用。这工作得很好。

当页面被更改为使用母版页时，我将 javascript 更改为以下内容：

```
if((!f.<%=rblRegUseVehicles.ClientID%>[0].checked) && (!f.<%=rblRegUseVehicles.ClientID%>[1].checked))
{
    isValid = "false";
} 
```

现在，javascript 失败了，因为它找不到元素。在“查看源代码”中，我有名称为：

```
<input id="ctl00_cphContent_rblRegUseVehicles_0" type="radio" name="ctl00$cphContent$rblRegUseVehicles" value="Yes" />

<input id="ctl00_cphContent_rblRegUseVehicles_1" type="radio" name="ctl00$cphContent$rblRegUseVehicles" value="No" /> 
```

唯一有效的代码是

```
document.<%=Form.ClientID%>.<%=rblRegUseVehicles.ClientID%>_0.checked 
```

我希望 javascript 在页面被转换为使用母版页之前引用数组。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:21:03.313

这是 ASP.NET 的一部分，一直很困难。您需要有引用动态创建的元素 ID 的静态 javascript！

这就是我一直解决问题的方法：

把你包裹`RadioButtonList`在一个`div`或`p`任何你想要的东西中：

```
<div id="yourId">
    <asp:RadioButtonList id="radiolist1" runat="server">
        <!-- ... -->
    </asp:RadioButtonList>
</div> 
```

呈现如下：

```
<div id="yourId">
    <table id="radiolist1" border="0">
        <tr>
            <td>
                <input id="radiolist1_0" type="radio" name="radiolist1" value="Item 1" checked="checked" />
                <label for="radiolist1_0">Item 1</label>
            </td>
        </tr>
        <tr>
            <td>
                <input id="radiolist1_1" type="radio" name="radiolist1" value="Item 2" />
                <label for="radiolist1_1">Item 2</label>
            </td>
        </tr>
    </table>
</div> 
```

这将允许您拥有一个静态的 javascript 函数，该函数的目标`yourId`是`runat="server"`. 然后你的 javascript 看起来像这样：

```
var rbl = document.getElementById("yourId");            
isValid = (!rbl.getElementsByTagName("input")[0].checked 
    && !rbl.getElementsByTagName("input")[1].checked); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T22:09:26.003

如果您想探索使用 jQuery 而不是直接使用 javascript 的想法，这应该可以为您解决问题。

```
if ( $('input[id*=rblRegUseVehicles]:checked').length < 0 ) isValid = "false"; 
```

选择器获取所有选中的 id 包含“rblRegUseVehicles”的单选按钮。

**编辑**

如果您想坚持使用原始脚本，使用 UniqueID 而不是 ClientID 可能会起作用

```
if((!f.<%=rblRegUseVehicles.UniqueID%>[0].checked) && (!f.<%=rblRegUseVehicles.UniqueID%>[1].checked))
{
    isValid = "false";
} 
```

# iphone - 获取 iPhone 当前位置的最简单方法是什么？

> ID：459355
> 
> 赞同：22
> 
> 时间：2009-01-19T22:00:08.643
> 
> 标签：iphone, core-location

我已经知道如何使用 CLLocationManager，所以我可以通过委托和所有其他方式来做这件事。

但是我想要一个方便的方法，它只获取当前位置一次，然后阻塞直到它得到结果。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-20T20:27:16.583

我所做的是实现一个单例类来管理来自核心位置的更新。要访问我当前的位置，我会执行`CLLocation *myLocation = [[LocationManager sharedInstance] currentLocation];` 如果您想阻止主线程，您可以执行以下操作：

```
while ([[LocationManager sharedInstance] locationKnown] == NO){
   //blocking here
   //do stuff here, dont forget to have some kind of timeout to get out of this blocked    //state
} 
```

然而，正如已经指出的那样，阻塞主线程可能不是一个好主意，但是当你正在构建一些东西时，这可能是一个很好的起点。您还会注意到我编写的类检查位置更新的时间戳并忽略任何旧的，以防止从核心位置获取陈旧数据的问题。

这是我写的单例类。请注意，边缘有点粗糙：

```
#import <CoreLocation/CoreLocation.h>
#import <Foundation/Foundation.h>

@interface  LocationController : NSObject <CLLocationManagerDelegate> {
    CLLocationManager *locationManager;
    CLLocation *currentLocation;
}

+ (LocationController *)sharedInstance;

-(void) start;
-(void) stop;
-(BOOL) locationKnown;

@property (nonatomic, retain) CLLocation *currentLocation;

@end
@implementation LocationController

@synthesize currentLocation;

static LocationController *sharedInstance;

+ (LocationController *)sharedInstance {
    @synchronized(self) {
        if (!sharedInstance)
            sharedInstance=[[LocationController alloc] init];       
    }
    return sharedInstance;
}

+(id)alloc {
    @synchronized(self) {
        NSAssert(sharedInstance == nil, @"Attempted to allocate a second instance of a singleton LocationController.");
        sharedInstance = [super alloc];
    }
    return sharedInstance;
}

-(id) init {
    if (self = [super init]) {
        self.currentLocation = [[CLLocation alloc] init];
        locationManager = [[CLLocationManager alloc] init];
        locationManager.delegate = self;
        [self start];
    }
    return self;
}

-(void) start {
    [locationManager startUpdatingLocation];
}

-(void) stop {
    [locationManager stopUpdatingLocation];
}

-(BOOL) locationKnown { 
     if (round(currentLocation.speed) == -1) return NO; else return YES; 
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
    //if the time interval returned from core location is more than two minutes we ignore it because it might be from an old session
    if ( abs([newLocation.timestamp timeIntervalSinceDate: [NSDate date]]) < 120) {     
        self.currentLocation = newLocation;
    }
}

- (void)locationManager:(CLLocationManager *)manager didFailWithError:(NSError *)error {
    UIAlertView *alert;
    alert = [[UIAlertView alloc] initWithTitle:@"Error" message:[error description] delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
    [alert release];
}

-(void) dealloc {
    [locationManager release];
    [currentLocation release];
    [super dealloc];
}

@end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T09:53:38.997

没有这样的便利，您不应该创建自己的。“在得到结果之前一直阻塞”在 iPhone 这样的设备上是**非常糟糕的编程习惯。**检索位置可能需要几秒钟；你永远不应该让你的用户那样等待，并且代表确保他们不会。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T01:15:29.047

除非您自己编写代码，否则没有“方便方法”，但您仍然需要在任何自定义代码中实现委托方法，以使事情变得“方便”。

委托模式的存在是有原因的，因为委托是 Objective-C 的重要组成部分，我建议你熟悉它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-29T03:41:02.303

我感谢布拉德史密斯的回答。实施它我发现他使用的其中一种方法在 iOS6 中已被弃用。要编写适用于 iOS5 和 iOS6 的代码，请使用以下代码：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations {
    if (abs([[locations lastObject] timeIntervalSinceDate:[NSDate date]]) < 120) {
        [self setCurrentLocation:[locations lastObject]];
    }
}

// Backward compatibility with iOS5.
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation {
    NSArray *locations = [NSArray arrayWithObjects:oldLocation, newLocation, nil];
    [self locationManager:manager didUpdateLocations:locations];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-14T08:20:55.580

我简化并组合了多个答案，仅当位置有效时才更新位置。

它也适用于 OSX 和 iOS。

这假设了用户突然需要当前位置的用例。如果在此示例中花费超过 100 毫秒，则将其视为错误。（假设 GPS IC 和| Wifi（Apple 的 Skyhook 克隆）已经启动并且已经有了很好的修复。）

```
#import "LocationManager.h"

// wait up to 100 ms
CLLocation *location = [LocationManager currentLocationByWaitingUpToMilliseconds:100];
if (!location) {
    NSLog(@"no location :(");
    return; 
}
// location is good, yay 
```

[https://gist.github.com/6972228](https://gist.github.com/6972228)

# c++ - 在 QTabWidget 上放置一个关闭按钮

> ID：459372
> 
> 赞同：13
> 
> 时间：2009-01-19T22:05:07.540
> 
> 标签：c++, windows, qt, qtabwidget

我正在使用 a`QTabWidget`在一个窗口中呈现多个文档，并且我想在每个选项卡上绘制一个关闭按钮。我正在使用*Vista*和*Qt4*，因此选项卡小部件是本机 Windows 控件；这可能会影响可行性。

有谁知道是否可以使用`QTabWidget`控件来执行此操作，或者我是否必须创建自定义小部件？如果创建一个新的小部件是唯一的选择，任何指针都将不胜感激；我对 Qt 比较陌生。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-05-10T15:40:47.940

**从 Qt 4.5 开始**。如果您只是调用`setTabsClosable(true)`on `QTabWidget`，您将拥有关闭按钮，但它们不会绑定到操作。
如果您希望按钮执行某些操作，则必须将 tabClos​​eRequested(int) 信号连接到您自己的插槽之一。

```
MainWindow::MainWindow()    
    m_tabs = new QTabWidget();
    m_tabs->setTabsClosable(true);
    connect(m_tabs, SIGNAL(tabCloseRequested(int)), this, SLOT(closeTab(int)));

void MainWindow::closeTab(const int& index)
{
    if (index == -1) {
        return;
    }

    QWidget* tabItem = m_tabs->widget(index);
    // Removes the tab at position index from this stack of widgets.
    // The page widget itself is not deleted.
    m_tabs->removeTab(index); 

    delete(tabItem);
    tabItem = nullptr;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T13:46:44.283

4.5中有功能

```
void setTabsClosable ( bool closeable ) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-19T22:14:42.217

目前没有办法使用现有的 QTabWidget 来做到这一点，但是即将推出的 Qt 4.5（计划于 2009 年 3 月发布）将能够手动或通过设置属性向选项卡[添加关闭按钮。](http://labs.trolltech.com/blogs/2008/07/02/some-qtabbar-qtabwidget-love/)`QTabBar.TabsClosable`

在那之前，获得关闭按钮的唯一方法是子类化`QTabWidget`或`QTabBar`手动添加它（可能，但不是微不足道的）。

# wpf - 自定义 TreeView 以允许多选

> ID：459375
> 
> 赞同：51
> 
> 时间：2009-01-19T22:06:17.600
> 
> 标签：wpf, treeview, multi-select

内置的 WPF TreeView 控件不允许多选，就像 ListBox 一样。如何自定义 TreeView 以允许多选而不重写它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-11T21:33:45.870

我有一个 SoMoS 实现的变体，它使用在基本 TreeView 控件的派生上声明的附加属性来跟踪 TreeViewItems 的选择状态。这将保持对 TreeViewItem 元素本身的选择跟踪，而不是树视图呈现的模型对象。

这是新的 TreeView 类派生。

```
using System.Linq;
using System.Windows;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Shapes;
using System.Windows.Controls;
using System.Collections;
using System.Collections.Generic;

namespace MultiSelectTreeViewDemo
{
    public sealed class MultiSelectTreeView : TreeView
    {
        #region Fields

        // Used in shift selections
        private TreeViewItem _lastItemSelected;

        #endregion Fields
        #region Dependency Properties

        public static readonly DependencyProperty IsItemSelectedProperty =
            DependencyProperty.RegisterAttached("IsItemSelected", typeof(bool), typeof(MultiSelectTreeView));

        public static void SetIsItemSelected(UIElement element, bool value)
        {
            element.SetValue(IsItemSelectedProperty, value);
        }
        public static bool GetIsItemSelected(UIElement element)
        {
            return (bool)element.GetValue(IsItemSelectedProperty);
        }

        #endregion Dependency Properties
        #region Properties

        private static bool IsCtrlPressed
        {
            get { return Keyboard.IsKeyDown(Key.LeftCtrl) || Keyboard.IsKeyDown(Key.RightCtrl); }
        }
        private static bool IsShiftPressed
        {
            get { return Keyboard.IsKeyDown(Key.LeftShift) || Keyboard.IsKeyDown(Key.RightShift); }
        }

        public IList SelectedItems
        {
            get
            {
                var selectedTreeViewItems = GetTreeViewItems(this, true).Where(GetIsItemSelected);
                var selectedModelItems = selectedTreeViewItems.Select(treeViewItem => treeViewItem.Header);

                return selectedModelItems.ToList();
            }
        }

        #endregion Properties
        #region Event Handlers

        protected override void OnPreviewMouseDown(MouseButtonEventArgs e)
        {
            base.OnPreviewMouseDown(e);

            // If clicking on a tree branch expander...
            if (e.OriginalSource is Shape || e.OriginalSource is Grid || e.OriginalSource is Border)
                return;

            var item = GetTreeViewItemClicked((FrameworkElement)e.OriginalSource);
            if (item != null) SelectedItemChangedInternal(item);
        }

        #endregion Event Handlers
        #region Utility Methods

        private void SelectedItemChangedInternal(TreeViewItem tvItem)
        {
            // Clear all previous selected item states if ctrl is NOT being held down
            if (!IsCtrlPressed)
            {
                var items = GetTreeViewItems(this, true);
                foreach (var treeViewItem in items)
                    SetIsItemSelected(treeViewItem, false);
            }

            // Is this an item range selection?
            if (IsShiftPressed && _lastItemSelected != null)
            {
                var items = GetTreeViewItemRange(_lastItemSelected, tvItem);
                if (items.Count > 0)
                {
                    foreach (var treeViewItem in items)
                        SetIsItemSelected(treeViewItem, true);

                    _lastItemSelected = items.Last();
                }
            }
            // Otherwise, individual selection
            else
            {
                SetIsItemSelected(tvItem, true);
                _lastItemSelected = tvItem;
            }
        }
        private static TreeViewItem GetTreeViewItemClicked(DependencyObject sender)
        {
            while (sender != null && !(sender is TreeViewItem))
                sender = VisualTreeHelper.GetParent(sender);
            return sender as TreeViewItem;
        }
        private static List<TreeViewItem> GetTreeViewItems(ItemsControl parentItem, bool includeCollapsedItems, List<TreeViewItem> itemList = null)
        {
            if (itemList == null)
                itemList = new List<TreeViewItem>();

            for (var index = 0; index < parentItem.Items.Count; index++)
            {
                var tvItem = parentItem.ItemContainerGenerator.ContainerFromIndex(index) as TreeViewItem;
                if (tvItem == null) continue;

                itemList.Add(tvItem);
                if (includeCollapsedItems || tvItem.IsExpanded)
                    GetTreeViewItems(tvItem, includeCollapsedItems, itemList);
            }
            return itemList;
        }
        private List<TreeViewItem> GetTreeViewItemRange(TreeViewItem start, TreeViewItem end)
        {
            var items = GetTreeViewItems(this, false);

            var startIndex = items.IndexOf(start);
            var endIndex = items.IndexOf(end);
            var rangeStart = startIndex > endIndex || startIndex == -1 ? endIndex : startIndex;
            var rangeCount = startIndex > endIndex ? startIndex - endIndex + 1 : endIndex - startIndex + 1;

            if (startIndex == -1 && endIndex == -1)
                rangeCount = 0;

            else if (startIndex == -1 || endIndex == -1)
                rangeCount = 1;

            return rangeCount > 0 ? items.GetRange(rangeStart, rangeCount) : new List<TreeViewItem>();
        }

        #endregion Utility Methods
    }
} 
```

这是 XAML。请注意，重要的部分是使用 MultiSelectTreeViewItemStyle 中的新的 'IsItemSelected' 附加属性替换使用单个 'IsSelected' 属性的两个触发器以实现视觉状态。

另请注意，我没有将新的 TreeView 控件聚合到 UserControl 中。

```
<Window 
    x:Class="MultiSelectTreeViewDemo.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:MultiSelectTreeViewDemo"
    Title="MultiSelect TreeView Demo" Height="350" Width="525">

    <Window.Resources>
        <local:DemoViewModel x:Key="ViewModel"/>
        <Style x:Key="TreeViewItemFocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.Static.Checked.Fill" Color="#FF595959"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.Static.Checked.Stroke" Color="#FF262626"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.MouseOver.Stroke" Color="#FF1BBBFA"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.MouseOver.Fill" Color="Transparent"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.MouseOver.Checked.Stroke" Color="#FF262626"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.MouseOver.Checked.Fill" Color="#FF595959"/>
        <PathGeometry x:Key="TreeArrow" Figures="M0,0 L0,6 L6,0 z"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.Static.Fill" Color="Transparent"/>
        <SolidColorBrush x:Key="TreeViewItem.TreeArrow.Static.Stroke" Color="#FF989898"/>
        <Style x:Key="ExpandCollapseToggleStyle" TargetType="{x:Type ToggleButton}">
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Width" Value="16"/>
            <Setter Property="Height" Value="16"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border Background="Transparent" Height="16" Padding="5,5,5,5" Width="16">
                            <Path x:Name="ExpandPath" Data="{StaticResource TreeArrow}" Fill="{StaticResource TreeViewItem.TreeArrow.Static.Fill}" Stroke="{StaticResource TreeViewItem.TreeArrow.Static.Stroke}">
                                <Path.RenderTransform>
                                    <RotateTransform Angle="135" CenterY="3" CenterX="3"/>
                                </Path.RenderTransform>
                            </Path>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="RenderTransform" TargetName="ExpandPath">
                                    <Setter.Value>
                                        <RotateTransform Angle="180" CenterY="3" CenterX="3"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Fill" TargetName="ExpandPath" Value="{StaticResource TreeViewItem.TreeArrow.Static.Checked.Fill}"/>
                                <Setter Property="Stroke" TargetName="ExpandPath" Value="{StaticResource TreeViewItem.TreeArrow.Static.Checked.Stroke}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Stroke" TargetName="ExpandPath" Value="{StaticResource TreeViewItem.TreeArrow.MouseOver.Stroke}"/>
                                <Setter Property="Fill" TargetName="ExpandPath" Value="{StaticResource TreeViewItem.TreeArrow.MouseOver.Fill}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsChecked" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Stroke" TargetName="ExpandPath" Value="{StaticResource TreeViewItem.TreeArrow.MouseOver.Checked.Stroke}"/>
                                <Setter Property="Fill" TargetName="ExpandPath" Value="{StaticResource TreeViewItem.TreeArrow.MouseOver.Checked.Fill}"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="MultiSelectTreeViewItemStyle" TargetType="{x:Type TreeViewItem}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
            <Setter Property="Padding" Value="1,0,0,0"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
            <Setter Property="FocusVisualStyle" Value="{StaticResource TreeViewItemFocusVisual}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeViewItem}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition MinWidth="19" Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <ToggleButton 
                                x:Name="Expander" 
                                ClickMode="Press" 
                                IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}" 
                                Style="{StaticResource ExpandCollapseToggleStyle}"/>
                            <Border 
                                x:Name="Bd" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                Background="{TemplateBinding Background}" 
                                Grid.Column="1" 
                                Padding="{TemplateBinding Padding}" 
                                SnapsToDevicePixels="true">
                                <ContentPresenter 
                                    x:Name="PART_Header" 
                                    ContentSource="Header" 
                                    HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                            </Border>
                            <ItemsPresenter 
                                x:Name="ItemsHost" 
                                Grid.ColumnSpan="2" 
                                Grid.Column="1" 
                                Grid.Row="1"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="false">
                                <Setter Property="Visibility" TargetName="ItemsHost" Value="Collapsed"/>
                            </Trigger>
                            <Trigger Property="HasItems" Value="false">
                                <Setter Property="Visibility" TargetName="Expander" Value="Hidden"/>
                            </Trigger>
                            <!--Trigger Property="IsSelected" Value="true"-->
                            <Trigger Property="local:MultiSelectTreeView.IsItemSelected" Value="true">
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <!--Condition Property="IsSelected" Value="true"/-->
                                    <Condition Property="local:MultiSelectTreeView.IsItemSelected" Value="true"/>
                                    <Condition Property="IsSelectionActive" Value="false"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightTextBrushKey}}"/>
                            </MultiTrigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="VirtualizingPanel.IsVirtualizing" Value="true">
                    <Setter Property="ItemsPanel">
                        <Setter.Value>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel/>
                            </ItemsPanelTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid
        Background="WhiteSmoke"
        DataContext="{DynamicResource ViewModel}">
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <local:MultiSelectTreeView
            x:Name="multiSelectTreeView"
            ItemContainerStyle="{StaticResource MultiSelectTreeViewItemStyle}"
            ItemsSource="{Binding FoodGroups}">
            <local:MultiSelectTreeView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                    <Grid>
                        <TextBlock FontSize="14" Text="{Binding Name}"/>
                    </Grid>
                </HierarchicalDataTemplate>
            </local:MultiSelectTreeView.ItemTemplate>
        </local:MultiSelectTreeView>
        <Button 
            Grid.Row="1" 
            Margin="0,10" 
            Padding="20,2"
            HorizontalAlignment="Center"
            Content="Get Selections" 
            Click="GetSelectionsButton_OnClick"/>
    </Grid>
</Window> 
```

这是一个俗气的视图模型来驱动它（用于演示目的）。

```
using System.Collections.ObjectModel;

namespace MultiSelectTreeViewDemo
{
    public sealed class DemoViewModel
    {
        public ObservableCollection<FoodItem> FoodGroups { get; set; }

        public DemoViewModel()
        {
            var redMeat = new FoodItem { Name = "Reds" };
            redMeat.Add(new FoodItem { Name = "Beef" });
            redMeat.Add(new FoodItem { Name = "Buffalo" });
            redMeat.Add(new FoodItem { Name = "Lamb" });

            var whiteMeat = new FoodItem { Name = "Whites" };
            whiteMeat.Add(new FoodItem { Name = "Chicken" });
            whiteMeat.Add(new FoodItem { Name = "Duck" });
            whiteMeat.Add(new FoodItem { Name = "Pork" });
            var meats = new FoodItem { Name = "Meats", Children = { redMeat, whiteMeat } };

            var veggies = new FoodItem { Name = "Vegetables" };
            veggies.Add(new FoodItem { Name = "Potato" });
            veggies.Add(new FoodItem { Name = "Corn" });
            veggies.Add(new FoodItem { Name = "Spinach" });

            var fruits = new FoodItem { Name = "Fruits" };
            fruits.Add(new FoodItem { Name = "Apple" });
            fruits.Add(new FoodItem { Name = "Orange" });
            fruits.Add(new FoodItem { Name = "Pear" });

            FoodGroups = new ObservableCollection<FoodItem> { meats, veggies, fruits };
        }
    }
    public sealed class FoodItem
    {
        public string Name { get; set; }
        public ObservableCollection<FoodItem> Children { get; set; }

        public FoodItem()
        {
            Children = new ObservableCollection<FoodItem>();
        }
        public void Add(FoodItem item)
        {
            Children.Add(item);
        }
    }
} 
```

这是 MainWindow 代码隐藏上的按钮单击处理程序，它显示了 MessageBox 中的选择。

```
 private void GetSelectionsButton_OnClick(object sender, RoutedEventArgs e)
    {
        var selectedMesg = "";
        var selectedItems = multiSelectTreeView.SelectedItems;

        if (selectedItems.Count > 0)
        {
            selectedMesg = selectedItems.Cast<FoodItem>()
                .Where(modelItem => modelItem != null)
                .Aggregate(selectedMesg, (current, modelItem) => current + modelItem.Name + Environment.NewLine);
        }
        else
            selectedMesg = "No selected items!";

        MessageBox.Show(selectedMesg, "MultiSelect TreeView Demo", MessageBoxButton.OK);
    } 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-02-06T19:51:22.787

当我考虑覆盖控件的基本行为时，比如树视图，我总是喜欢考虑与我的决定相关的可用性和工作量。

在树视图的特定情况下，我发现切换到列表视图并结合零个、一个或多个控件可以提供更有用的解决方案，而且通常更容易实现。

例如，考虑常见的打开对话框或 Windows 资源管理器应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-14T15:42:52.620

我已经简化了这个任务，在每个 treeviewitem 的文本之前添加了一个复选框。

因此，我创建了一个包含 2 个项目的停靠面板：复选框 + 文本块。

所以...

**XAML**

```
<TreeView x:Name="treeViewProcesso" Margin="1,30.351,1,5"  BorderBrush="{x:Null}" MinHeight="250" VerticalContentAlignment="Top" BorderThickness="0" >
  <TreeViewItem Header="Documents" x:Name="treeView" IsExpanded="True" DisplayMemberPath="DocumentsId" >            
  </TreeViewItem>
</TreeView> 
```

**CS**

```
TreeViewItem treeViewItem = new TreeViewItem();
DockPanel dp = new DockPanel();
CheckBox cb = new CheckBox();
TextBlock tb = new TextBlock();
tb.Text = "Item";
dp.Children.Add(cb);
dp.Children.Add(tb);
treeViewItem.Header = dp;
treeViewItem.Selected += new RoutedEventHandler(item_Selected);
treeView.Items.Add(treeViewItem); 
```

然后您可以访问复选框值：

```
void item_Selected(object sender, RoutedEventArgs e)
{
  selectedTVI = ((TreeViewItem)sender);

  CheckBox cb = (Checkbox)((DockPanel)selectedTVI.Header).Children[0];
} 
```

如果您不需要任何复杂的东西，这是一种简单的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T08:19:16.233

我终于结束了编写我自己的包含 TreeView 的 CustomControl 的代码。基于其他人的工作，功能的关键在于使TreeView的Model的所有项目都继承ISelectable接口：

```
public interface ISelectable
{
    public bool IsSelected {get; set}
} 
```

这样，我们将拥有一个与 TreeViewItem IsSelected 无关的新“IsSelected”属性。我们只需要设置树的样式，以便它处理模型 IsSelected 属性。[这里是代码（它使用http://code.google.com/p/gong-wpf-dragdrop/](http://code.google.com/p/gong-wpf-dragdrop/)提供的拖放库）：

XAML

```
<UserControl x:Class="Picis.Wpf.Framework.ExtendedControls.TreeViewEx.TreeViewEx"

         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:DragAndDrop="clr-namespace:Picis.Wpf.Framework.DragAndDrop">

<TreeView ItemsSource="{Binding ItemsSource, RelativeSource={RelativeSource AncestorType=UserControl}}" 
          ItemTemplate="{Binding ItemTemplate, RelativeSource={RelativeSource AncestorType=UserControl}}" 
          ItemContainerStyle="{Binding ItemContainerStyle, RelativeSource={RelativeSource AncestorType=UserControl}}" 
          DragAndDrop:DragDrop.DropHandler ="{Binding DropHandler, RelativeSource={RelativeSource AncestorType=UserControl}}" 
          PreviewMouseDown="TreeViewOnPreviewMouseDown" 
          PreviewMouseUp="TreeViewOnPreviewMouseUp"
          x:FieldModifier="private" x:Name="InnerTreeView" >
    <TreeView.Resources>
        <Style TargetType="TreeViewItem">
            <Style.Resources>
                <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="White" />
                <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="Black" />
                <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="White" />
            </Style.Resources>
        </Style>
    </TreeView.Resources>
</TreeView> 
```

C＃：

```
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Shapes;
using GongSolutions.Wpf.DragDrop;
using DragDrop = GongSolutions.Wpf.DragDrop;

namespace <yournamespace>.TreeViewEx
{
public partial class TreeViewEx : UserControl
{
    #region Attributes

    private TreeViewItem _lastItemSelected; // Used in shift selections
    private TreeViewItem _itemToCheck; // Used when clicking on a selected item to check if we want to deselect it or to drag the current selection
    private bool _isDragEnabled;
    private bool _isDropEnabled;

    #endregion

    #region Dependency Properties

    public static readonly DependencyProperty ItemsSourceProperty = DependencyProperty.Register("ItemsSource", typeof(IEnumerable<ISelectable>), typeof(TreeViewEx));

    public IEnumerable<ISelectable> ItemsSource
    {
        get
        {
            return (IEnumerable<ISelectable>)this.GetValue(TreeViewEx.ItemsSourceProperty);
        }
        set
        {
            this.SetValue(TreeViewEx.ItemsSourceProperty, value);
        }
    }

    public static readonly DependencyProperty ItemTemplateProperty = DependencyProperty.Register("ItemTemplate", typeof(DataTemplate), typeof(TreeViewEx));

    public DataTemplate ItemTemplate
    {
        get
        {
            return (DataTemplate)GetValue(TreeViewEx.ItemTemplateProperty);
        }
        set
        {
            SetValue(TreeViewEx.ItemTemplateProperty, value);
        }
    }

    public static readonly DependencyProperty ItemContainerStyleProperty = DependencyProperty.Register("ItemContainerStyle", typeof(Style), typeof(TreeViewEx));

    public Style ItemContainerStyle
    {
        get
        {
            return (Style)GetValue(TreeViewEx.ItemContainerStyleProperty);
        }
        set
        {
            SetValue(TreeViewEx.ItemContainerStyleProperty, value);
        }
    }

    public static readonly DependencyProperty DropHandlerProperty = DependencyProperty.Register("DropHandler", typeof(IDropTarget), typeof(TreeViewEx));

    public IDropTarget DropHandler
    {
        get
        {
            return (IDropTarget)GetValue(TreeViewEx.DropHandlerProperty);
        }
        set
        {
            SetValue(TreeViewEx.DropHandlerProperty, value);
        }
    }

    #endregion

    #region Properties

    public bool IsDragEnabled
    {
        get
        {
            return _isDragEnabled;
        }
        set
        {
            if (_isDragEnabled != value)
            {
                _isDragEnabled = value;
                DragDrop.SetIsDragSource(this.InnerTreeView, _isDragEnabled);
            }
        }
    }

    public bool IsDropEnabled
    {
        get
        {
            return _isDropEnabled;
        }
        set
        {
            if (_isDropEnabled != value)
            {
                _isDropEnabled = value;
                DragDrop.SetIsDropTarget(this.InnerTreeView, _isDropEnabled);
            }
        }
    }

    #endregion

    #region Public Methods

    public TreeViewEx()
    {
        InitializeComponent();
    }

    #endregion

    #region Event Handlers

    private void TreeViewOnPreviewMouseDown(object sender, MouseButtonEventArgs e)
    {
        if (e.OriginalSource is Shape || e.OriginalSource is Grid || e.OriginalSource is Border) // If clicking on the + of the tree
            return;

        TreeViewItem item = this.GetTreeViewItemClicked((FrameworkElement)e.OriginalSource);

        if (item != null && item.Header != null)
        {
            this.SelectedItemChangedHandler(item);
        }
    }

    // Check done to avoid deselecting everything when clicking to drag
    private void TreeViewOnPreviewMouseUp(object sender, MouseButtonEventArgs e)
    {
        if (_itemToCheck != null)
        {
            TreeViewItem item = this.GetTreeViewItemClicked((FrameworkElement)e.OriginalSource);

            if (item != null && item.Header != null)
            {
                if (!TreeViewEx.IsCtrlPressed)
                {
                    GetTreeViewItems(true).Select(t => t.Header).Cast<ISelectable>().ToList().ForEach(f => f.IsSelected = false);
                    ((ISelectable)_itemToCheck.Header).IsSelected = true;
                    _lastItemSelected = _itemToCheck;
                }
                else
                {
                    ((ISelectable)_itemToCheck.Header).IsSelected = false;
                    _lastItemSelected = null;
                }
            }
        }
    }

    #endregion

    #region Private Methods

    private void SelectedItemChangedHandler(TreeViewItem item)
    {
        ISelectable content = (ISelectable)item.Header;

        _itemToCheck = null;

        if (content.IsSelected)
        {
            // Check it at the mouse up event to avoid deselecting everything when clicking to drag
            _itemToCheck = item;
        }
        else
        {
            if (!TreeViewEx.IsCtrlPressed)
            {
                GetTreeViewItems(true).Select(t => t.Header).Cast<ISelectable>().ToList().ForEach(f => f.IsSelected = false);
            }

            if (TreeViewEx.IsShiftPressed && _lastItemSelected != null)
            {
                foreach (TreeViewItem tempItem in GetTreeViewItemsBetween(_lastItemSelected, item))
                {
                    ((ISelectable)tempItem.Header).IsSelected = true;
                    _lastItemSelected = tempItem;
                }
            }
            else
            {
                content.IsSelected = true;
                _lastItemSelected = item;
            }
        }
    }

    private static bool IsCtrlPressed
    {
        get
        {
            return Keyboard.IsKeyDown(Key.LeftCtrl) || Keyboard.IsKeyDown(Key.RightCtrl);
        }
    }

    private static bool IsShiftPressed
    {
        get
        {
            return Keyboard.IsKeyDown(Key.LeftShift) || Keyboard.IsKeyDown(Key.RightShift);
        }
    }

    private TreeViewItem GetTreeViewItemClicked(UIElement sender)
    {
        Point point = sender.TranslatePoint(new Point(0, 0), this.InnerTreeView);
        DependencyObject visualItem = this.InnerTreeView.InputHitTest(point) as DependencyObject;
        while (visualItem != null && !(visualItem is TreeViewItem))
        {
            visualItem = VisualTreeHelper.GetParent(visualItem);
        }

        return visualItem as TreeViewItem;
    }

    private IEnumerable<TreeViewItem> GetTreeViewItemsBetween(TreeViewItem start, TreeViewItem end)
    {
        List<TreeViewItem> items = this.GetTreeViewItems(false);

        int startIndex = items.IndexOf(start);
        int endIndex = items.IndexOf(end);

        // It's possible that the start element has been removed after it was selected,
        // I don't find a way to happen on the end but I add the code to handle the situation just in case
        if (startIndex == -1 && endIndex == -1)
        {
            return new List<TreeViewItem>();
        }
        else if (startIndex == -1)
        {
            return new List<TreeViewItem>() {end};
        }
        else if (endIndex == -1)
        {
            return new List<TreeViewItem>() { start };
        }
        else
        {
            return startIndex > endIndex ? items.GetRange(endIndex, startIndex - endIndex + 1) : items.GetRange(startIndex, endIndex - startIndex + 1); 
        }
    }

    private List<TreeViewItem> GetTreeViewItems(bool includeCollapsedItems)
    {
        List<TreeViewItem> returnItems = new List<TreeViewItem>();

        for (int index = 0; index < this.InnerTreeView.Items.Count; index++)
        {
            TreeViewItem item = (TreeViewItem)this.InnerTreeView.ItemContainerGenerator.ContainerFromIndex(index);
            returnItems.Add(item);
            if (includeCollapsedItems || item.IsExpanded)
            {
                returnItems.AddRange(GetTreeViewItemItems(item, includeCollapsedItems));                    
            }
        }

        return returnItems;
    }

    private static IEnumerable<TreeViewItem> GetTreeViewItemItems(TreeViewItem treeViewItem, bool includeCollapsedItems)
    {
        List<TreeViewItem> returnItems = new List<TreeViewItem>();

        for (int index = 0; index < treeViewItem.Items.Count; index++)
        {
            TreeViewItem item = (TreeViewItem)treeViewItem.ItemContainerGenerator.ContainerFromIndex(index);
            if (item != null)
            {
                returnItems.Add(item);
                if (includeCollapsedItems || item.IsExpanded)
                {
                    returnItems.AddRange(GetTreeViewItemItems(item, includeCollapsedItems));
                }
            }
        }

        return returnItems;
    }

    #endregion
}
} 
```

# html - 是否可以告诉 Safari 在打印页面上重复表格标题？

> ID：459378
> 
> 赞同：20
> 
> 时间：2009-01-19T22:07:00.860
> 
> 标签：html, safari, html-table

是否可以在每个打印页面上重复 Safari 中的表格标题？

此代码适用于 Firefox，但不适用于 Safari：

```
<table>
  <thead>
    <tr>
      <td>Header1</td>
      <td>Header2</td>
    </tr>
  </thead>

  <!-- lots of rows -->
</table> 
```

**编辑：**

以下内容无法修复它，因此它不能与 IE 具有相同的错误：

```
thead { display:table-header-group; } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T13:34:35.213

回答我自己的问题：

在谷歌搜索并没有得到正确答案后，我认为根本没有办法完成它。也许更高版本的 Safari 会包含它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-29T16:05:21.300

`thead`您可以考虑在下桌时定期重印。如果表格很长，即使在屏幕上查看，这也可能是有益的，因为标题很可能会很快滚动出屏幕。但是，如果您不想在屏幕上显示它，您可以将一个类添加到重新打印的标题中，将它们隐藏在屏幕上，并仅在打印样式表中显示它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T10:40:07.393

您可能需要考虑为页面的打印版本创建 CSS 表。如果您选择该路线，请使用“位置：固定；”。定位为“固定”的元素打印在每个打印页面上。

棘手的部分是任何定位元素（即位置属性不是“静态”）都从文档流中取出。这使得其他（常规流动的）元素与固定元素的对齐变得困难。

根据您问题中的信息，我会将*整个*表格包装在一个固定元素中（或创建一个诸如 .printedTable 之类的类，并将位置属性设置为固定）。这样，表格结构将在每个打印页面上重复。

祝你好运。一种。

# compact-framework - .Net CF 中的调用方法

> ID：459382
> 
> 赞同：0
> 
> 时间：2009-01-19T22:09:17.253
> 
> 标签：compact-framework, stack-trace

我想在 .NET Compact Framework 中执行以下操作。我正在寻找调用方法类型。

[http://www.csharp-examples.net/reflection-calling-method-name/](http://www.csharp-examples.net/reflection-calling-method-name/)

.NET Compact Framework 不支持 StackFrame 类。此外，GetCurrentMethod() 在 MethodBase 类中不可用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T15:38:03.540

尝试抛出异常然后检查它的 StackTrace 属性。

```
try
   {
       throw new Exception();
   }
catch(Exception ex)
   {
       Console.Write(ex.StackTrace);
   } 
```

它会给出类似的东西

> “在 NumericTextBoxControl.NumericalInput..ctor()\r\nat Custom_Numeric_Input.frmTestApplication.InitializeComponent()\r\nat Custom_Numeric_Input.frmTestApplication..ctor()\r\nat Custom_Numeric_Input.Program.Main()\r\n”

您可以对其进行解析、拆分和使用反射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T22:29:54.853

正如您所发现的，Compact Framework 就是这样 - 紧凑。并非完整框架中的所有内容都可用，这就是一个例子。除非您在异常处理程序中并且可以查看那里的调用堆栈，否则根本无法确定调用方法（即使这样获取方法名称也并不像人们希望的那样简单）。

# c++ - C++ 元编程 - 在代码中生成错误

> ID：459386
> 
> 赞同：6
> 
> 时间：2009-01-19T22:09:41.667
> 
> 标签：c++, templates, metaprogramming

有没有一种方法可以创建一个带有`int`模板参数的函数，如果传递给函数的值小于 10，则让该函数给出编译时错误？

以下代码不起作用，但它显示了我想要完成的任务：

```
template <int number1>
void reportErrorIfLessThan10()
{
    #if(number1 < 10)
        #error the number is less than 10
    #endif
}

int maint(int argc, char**argv)
{
   reportErrorIfLessThan10<5>();//report an error!
   reportErrorIfLessThan10<12>();//ok
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T22:20:08.400

如果您不想要[Boost C++ Libraries](http://en.wikipedia.org/wiki/Boost_C%2B%2B_Libraries)的魔力并且想要裸露的骨骼......

```
template<bool> class static_check
{
};

template<> class static_check<false>
{
private: static_check();
};

#define StaticAssert(test) static_check<(test) != 0>() 
```

然后使用静态断言。这对我来说是一个#define，因为我的代码需要在许多 C++ 不适用于模板的环境中运行，我需要将其退回到运行时断言。:(

此外，不是最好的错误消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T22:12:44.187

```
template <int number1>
typename boost::enable_if_c< (number1 >= 10) >::type 
reportErrorIfLessThan10() {
    // ...
} 
```

上面`enable_if`没有 _c 因为我们有一个普通的布尔值，看起来像这样：

```
template<bool C, typename T = void>
struct enable_if {
  typedef T type;
};

template<typename T>
struct enable_if<false, T> { }; 
```

[Boost](http://en.wikipedia.org/wiki/Boost_C%2B%2B_Libraries)不`enable_if`采用纯布尔值，因此它们有另一个附加了 _c 的版本，它采用纯布尔值。您将无法将其称为`number1`< *10。SFINAE*将排除该模板作为可能的候选者，因为如果条件评估为，`enable_if`则不会公开类型。如果您出于某种原因想要在函数中对其进行测试，那么如果您有可用的[C++1x](http://en.wikipedia.org/wiki/C%2B%2B0x)功能，则可以使用：`::type``false``static_assert`

```
template <int number1>
void reportErrorIfLessThan10() {
    static_assert(number >= 10, "number must be >= 10");
} 
```

如果没有，您可以使用 BOOST_STATIC_ASSERT：

```
template <int number1>
void reportErrorIfLessThan10() {
    BOOST_STATIC_ASSERT(number >= 10);
} 
```

不过，显示描述性消息的唯一方法是使用 static_assert。您可以或多或少地模拟这一点，使用具有描述错误条件的名称的类型：

```
namespace detail {
    /* chooses type A if cond == true, chooses type B if cond == false */
    template <bool cond, typename A, typename B>
    struct Condition {
      typedef A type;
    };

    template <typename A, typename B>
    struct Condition<false, A, B> {
      typedef B type;
    };

    struct number1_greater_than_10;
}

template <int number1>
void reportErrorIfLessThan10() {
    // number1 must be greater than 10
    sizeof( typename detail::Condition< (number1 >= 10), 
             char, 
             detail::number1_greater_than_10 
            >::type ); 
} 
```

它在这里打印：

> 错误：“sizeof”对不完整类型“detail::number1_greater_than_10”的无效应用

但我认为第一种方法，使用`enable_if`会做到这一点。您将收到有关未声明的错误消息`reportErrorIfLessThan10`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T22:27:30.413

如果由于某种原因你不能使用 Boost，这个例子可以简单地写成这样：

```
template <int number1>
void reportErrorIfLessThan10()
{
    typedef char number1_gt_10[number1 > 10 ? 1 : -1];
}

int maint(int argc, char**argv)
{
   reportErrorIfLessThan10<5>();//report an error!
   reportErrorIfLessThan10<12>();//ok
   return 0;
} 
```

或者更通用

```
#define static_assert(test, message) typedef char static_assert_at_ ## __LINE__[(test) ? 1 : -1]; 
```

我没有连接错误消息本身，因为我觉得这`static_assert(true, "some message");`比 say 更具可读性`static_assert(true, some_message);`。但是，这确实将用例限制为每行只有一个断言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T22:26:45.330

litb 和 Joe 已经给出了实践中使用的答案。只是为了说明如何通过专门针对有问题的数字（而不是一般的布尔条件）来手动完成此操作：

```
template <int N>
struct helper : helper<N - 1> { };

template <>
struct helper<10> { typedef void type; };

template <>
struct helper<0> { }; // Notice: missing typedef.

template <int N>
typename helper<N>::type error_if_less_than_10() {
}

int main() {
    error_if_less_than_10<10>();
    error_if_less_than_10<9>();
} 
```

函数不能被继承，但类（和结构）可以。因此，此代码还使用了一个结构，该结构自动动态地为除 10 和 0 之外的所有 N 生成 case，它们是硬编码递归的开始。

顺便说一句，上面的代码实际上给出了很好的错误信息：

> ```
> x.cpp:16: error: no matching function for call to 'error_if_less_than_10()' 
> ```

# c# - 将 REST 响应转换为 XDocument 的问题

> ID：459392
> 
> 赞同：2
> 
> 时间：2009-01-19T22:12:05.110
> 
> 标签：c#, xml, rest

我实际上是在玩我通过 REST 调用的[last.FM网络服务 API。](http://www.lastfm.de/api)当我得到响应时，我尝试将结果转换为 XDocument，以便我可以使用 LINQ 来处理它。

但是，当我将结果字符串传递给 XDocumnet 构造函数时，会引发 ArgumentException，告诉我“不能将非空白字符添加到内容中。”。不幸的是，我对 Web 服务和 XML 编程非常陌生，所以我真的不知道如何解释这个异常。

我希望有人能给我一个提示如何解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T22:36:09.320

在我看来，好像您将响应保存在字符串中。如果是这种情况，您可以尝试在 XDocument 上使用 Parse 方法，该方法用于从字符串中解析 XML。

```
string myResult = "<?xml blahblahblah>";
XDocument doc = XDocument.Parse(myResult); 
```

这可能会也可能不会解决您的问题。只是一个值得尝试的建议，看看您是否会得到不同的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T22:38:27.740

这是一个可用于查询服务的示例：

```
class Program
{
    static void Main(string[] args)
    {
        using (WebClient client = new WebClient())
        using (Stream stream = client.OpenRead("http://ws.audioscrobbler.com/2.0/?method=album.getinfo&api_key=b25b959554ed76058ac220b7b2e0a026&artist=Cher&album=Believe"))
        using (TextReader reader = new StreamReader(stream))
        {
            XDocument xdoc = XDocument.Load(reader);
            var summaries = from element in xdoc.Descendants()
                    where element.Name == "summary"
                    select element;
            foreach (var summary in summaries)
            {
                Console.WriteLine(summary.Value);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T22:24:16.207

[http://jamescrisp.org/2008/08/08/simple-rest-client/](http://jamescrisp.org/2008/08/08/simple-rest-client/)发布了一个小的 REST 客户端。也许是你的起点。

# php - WYSIWYG textarea 组件安全性

> ID：459408
> 
> 赞同：1
> 
> 时间：2009-01-19T22:17:47.470
> 
> 标签：php, textarea, wysiwyg, user-input, validation

真的，我的问题更多地与通过 WYSIWYG 表单组件接受的 html 的服务器端清理有关。现在我倾向于使用 htmlpurifier.org 的库。我在其他地方使用 php strip_tags() 函数。有人有建议/偏好/建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:36:51.907

`strip_tags`非常脆弱——你还不如什么都不做。HtmlPurifier 可能与 html-cleansing 一样好。如果您真的很重视安全性，您可能应该完全禁止 html 输入，但我意识到这并不总是一种选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T22:28:00.473

不要忘记擦掉`on*`像`<p onclick="alert('hi!');">`. 这可能会引起一些麻烦。

# linux - 替换csv文件中的一行？

> ID：459411
> 
> 赞同：1
> 
> 时间：2009-01-19T22:18:28.543
> 
> 标签：linux, command-line

我有一组 10 个 CSV 文件，通常有一个此类条目

```
a,b,c,d
d,e,f,g 
```

现在由于这个文件中的一些错误条目已经变成了这种

```
a,b,c,d
d,e,f,g
,,,
h,i,j,k 
```

现在我想删除所有文件中只有逗号的行。这些文件位于 Linux 文件系统上。

您推荐的任何命令都可以替换所有文件中的错误行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T22:28:32.517

这取决于您所说的替换是什么意思。如果您的意思是“删除”，那么@wnoise 解决方案的一个简单变体是：

```
grep -v '^,,,$' old-file.csv > new-file.csv 
```

请注意，这只会删除恰好包含三个逗号的行。如果要删除带有任意数量的逗号（包括零）的格式错误的行 - 并且该行中没有其他字符，则：

```
grep -v '^,*$' ... 
```

正则表达式有无穷无尽的其他变体可以处理其他场景。使用引号内的逗号处理完整的 CSV 数据开始需要正则表达式机器以外的东西。它可以在广泛的范围内完成，尤其是在 PCRE 或 Perl 等更复杂的正则表达式系统中。但这需要更多的工作。

查看[掌握正则表达式](http://regex.info/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T22:21:16.103

```
sed 's/,,,/replacement/' < old-file.csv > new-file.csv 
```

可选地后跟 mv new-file.csv old-file.csv

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T22:27:02.567

替换或删除，您的帖子不清楚...有关替换，请参阅 wnoise 的答案。对于删除，您可以使用

```
awk '$0 !~ /,,,/ {print}' <old-file.csv > new-file.csv 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T22:32:20.590

您想用某些东西替换它们，还是完全删除它们？无论哪种方式，都可以使用`sed`. 删除：

```
sed -i -e '/^,\+$/ D' yourfile1.csv yourfile2.csv ... 
```

要替换：好吧，请参阅 wnoise 的答案，或者如果您不想使用输出创建新文件，

```
sed -i -e '/^,\+$/ s//replacement/' yourfile1.csv yourfile2.csv ... 
```

或者

```
sed -i -e '/^,\+$/ c\
replacement' yourfile1.csv yourfile2.csv ... 
```

（应按原样输入，包括换行符）。当然，您也可以使用`awk`or来执行此操作`perl`，如果您只是删除行，甚至`grep`：

```
egrep -v '^,+$' < oldfile.csv > newfile.csv 
```

我测试了这些以确保它们有效，但我建议您在使用它们之前也这样做（以防万一）。您可以省略`-i`from 选项`sed`，在这种情况下，它会打印出结果（而不是将它们写回文件），或者省略`>newfile.csv`from的输出重定向`grep`。

*编辑：*在评论中指出，这些`sed`命令的某些功能仅适用于 GNU `sed`。据我所知，这些是`-i`选项（可以用 shell 重定向替换`sed ... <infile >outfile`）和`\+`修饰符（可以用 替换`\{1,\}`）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T23:27:22.617

尝试只保留与所需格式匹配的行而不是处理一个异常呢？

如果提供的输入是您真正想要匹配的：

```
grep -E '[a-z],[a-z],[a-z],[a-z]' < oldfile.csv > newfile.csv 
```

如果输入不同，提供它，正则表达式应该不会太难写。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T03:26:10.733

最简单的：

```
$   grep -v ,,,, oldfile > newfile   
$   mv newfile oldfile 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T04:36:43.633

是的，如果您在 linux 平台上工作，awk 或 grep 是非常好的选择。但是，您可以将 perl 正则表达式用于其他平台。使用加入和拆分选项。

# c++ - 在 shared_from_this() 中提升 weak_ptr_cast

> ID：459414
> 
> 赞同：5
> 
> 时间：2009-01-19T22:20:24.267
> 
> 标签：c++, boost

我正在使用 boost 的共享指针，并`enable_shared_from_this`启用返回指向它的共享指针。代码如下所示：

```
class foo : public boost::enable_shared_from_this<foo>
{
  boost::shared_ptr<foo> get()
  {
    return shared_from_this();
  }
} 
```

为什么 shared_from_this 会抛出 weak_ptr_cast 异常？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T22:22:59.347

如果你在堆栈上声明了 foo，那么就没有其他指向 foo 的共享指针了。例如：

```
void bar()
{
  foo fooby;
  fooby.get();
} 
```

foob​​y.get() 会抛出`weak_ptr_cast`异常。

为了解决这个问题，`fooby`在堆上声明：

```
void bar()
{
  boost::shared_ptr<foo> pFooby = boost::shared_ptr<foo>(new foo());
  pFooby->get();
} 
```

另一种可能性是您尝试`shared_from_this`在构造函数完成之前使用，这将再次尝试返回尚不存在的共享指针。

# build-process - 在多个操作系统平台上交付时的内部版本号同步

> ID：459415
> 
> 赞同：1
> 
> 时间：2009-01-19T22:20:42.750
> 
> 标签：build-process

我的组织构建了一个在多个操作系统上运行的 C++ 应用程序。

对于所有平台上的源代码树的给定状态，客户可见的内部版本号是否应该相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:23:58.267

我看不到任何缺点。您希望能够重现构建，因此每个人都应该说明构建是什么。如果它是相同的版本，它应该是相同的版本号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T22:28:34.670

是的，我想是这样。

您可以使用的一种做法是使用更改列表编号，或者您的源代码控制系统会识别您的构建系统为构建您的产品而提取的签入。这样，您始终知道应该提取什么资源来重建它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T08:31:10.913

如果您选择（或不能 - 从构建过程的角度）不为不同平台的构建使用完全相同*的*版本号，您应该准确记录您的*版本号*实际暗示的内容。

如果您不这样做，通常该软件的用户会将整个事情（例如 3.1.0.333 - 其中 333 是内部版本号）视为识别软件的某个版本（因此是代码树）。如果他们在不同的平台上使用您的软件，他们可能会认为 3.1.0.333 和 3.1.0.334 实际上是指产品的*不同版本*（如代码更改），但他们可能不会。

外部“内部版本号”样式也是如此，例如使用某种日期/时间派生的内部版本 ID。

如果您全局管理内部版本号，您可能会考虑添加平台 ID。这样您就可以一个接一个地构建 3.1.0.333-x86 和 3.1.0.333-amd64，但仍然让它们共享相同的“编号”。对于用户来说，缩进/含义也将更加明显。

# vba - 如何将范围复制到临时工作簿并使用 vba 函数返回对它的引用？

> ID：459427
> 
> 赞同：2
> 
> 时间：2009-01-19T22:24:53.087
> 
> 标签：vba, excel

我在“rTemp.Value = vaTemp”行有以下错误。我在这里做错了什么？我在正确的轨道上吗？

```
Function CreateTempRange(rSource As range) As range
    ' Declarations
    Dim rTemp As range
    Dim vaTemp As Variant
    Dim wsTemp As Worksheet
    Dim wbTemp As Workbook

    ' Open temp worksheet
    Set wbTemp = Workbooks.Add
    Set wsTemp = wbTemp.Worksheets.Add

    ' Copy range into it and get a reference to the temp range
    vaTemp = rSource.Value
    Set rTemp = wsTemp.range("A1").Resize(UBound(vaTemp, 1), UBound(vaTemp, 2))
    rTemp.Value = vaTemp

    ' Return the temp range
    Set CreateTempRange = rTemp
End Function 
```

注意：此函数旨在供其他函数使用，而不是直接从单元格调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T06:53:07.337

```
Set rTemp = wsTemp.range("A1").Resize(UBound(vaTemp, 1), UBound(vaTemp, 2) 
```

这里会有类型不匹配......我不确定它是否真的有意义。ubound(a,2) 用于多维数组而不是范围。

我猜你想取指定单元格中的值，然后根据它的值复制它很多次。那是对的吗？

希望下面的内容可以为您提供一个可以使用的示例。如果不编辑您的帖子，我会看看我是否可以提供帮助。

```
Function CreateTempRange(rSource As Range) As Range
    '' Declarations
    Dim rTemp As Range
    Dim vaTemp As Variant

    Dim wsTemp As Worksheet
    Dim wbTemp As Workbook

    '' Open temp worksheet
    Set wbTemp = Workbooks.Add
    Set wsTemp = wbTemp.Worksheets.Add

    '' Copy range into it and get a reference to the temp range
    vaTemp = rSource.Value
    ''Set rTemp = wsTemp.Range("A1").Resize(UBound(vaTemp, 1), UBound(vaTemp, 2))

    Dim iTemp As Integer
    On Error Resume Next
    iTemp = CInt(vaTemp)
    On Error GoTo 0

    If iTemp < 1 Then
      iTemp = 1
    End If
    Set rTemp = wsTemp.Range("A1:A" & iTemp)
    rTemp.Value = vaTemp

    '' Return the temp range
    Set CreateTempRange = rTemp
End Function

Sub test()

  Dim r As Range
  Dim x As Range
  Set r = ActiveSheet.Range("A1")
  Set x = CreateTempRange(r)

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T07:40:59.890

```
vaTemp = rSource.Value 
```

由于您没有`RangeValueDataType`为 Range 对象的 Value 方法指定参数，因此默认情况下`xlRangeValueDefault`，对于非空范围，它将返回一个值数组。因此，`UBound(..., 1)`和`UBound(..., 2)`部分是有意义的。

这会更容易：

```
Function CreateTempRange(rSource As range) As range
    ' Declarations
    Dim rTemp As range
    Dim wsTemp As Worksheet
    Dim wbTemp As Workbook

    ' Open temp worksheet
    Set wbTemp = Workbooks.Add
    Set wsTemp = wbTemp.Worksheets.Add

    ' Create new range on that sheet starting at cell A1
    Set rTemp = wsTemp.Range(Cells(1, 1), Cells(rSource.Rows.Count, _
        rSource.Columns.Count))
    rTemp.Value = rSource.Value

    ' Return the temp range
    Set CreateTempRange = rTemp
End Function 
```

您仍然需要一些代码来处理由多个区域组成的范围（使用该`Areas.Count`属性进行检查）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T16:57:31.950

我会这样做

```
Function CreateTempRange(src As Range) As Range

Dim wbk As Workbook: Set wbk = Workbooks.Add
Dim sht As Worksheet: Set sht = wbk.Worksheets.Add

Call src.Copy(sht.Cells(1, 1))

Set CreateTempRange = Range(rSource.Address).Offset(1 - rSource.Row, 1 - rSource.Column)

End Function 
```

**最后一行代码的解释（根据要求）：-**

`Range(rSource.Address)`- 这是指当前工作表上的范围（包含代码），其本地地址与源范围相同，因此如果源范围是“Sheet X”上的`Range(rSource.Address)`C3:E5，则指当前工作表上的 C3:E5 .

由于我们将复制的范围粘贴到从单元格 A1 而不是单元格 C3 开始的当前工作表中（我假设这是您的要求），因此我们需要相应地偏移此引用。源范围的`.Offset(1 - rSource.Row, 1 - rSource.Column)`行索引 (3) 负 1 和列索引（C 或 3）负 1 负偏移此范围，以便最终生成的引用从单元格 A1 开始并保持与源范围相同的尺寸。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T17:25:42.457

Deano，该代码对我有效。你得到什么错误？

# .net - Logging in to an OpenID site from a .net app

> ID：459428
> 
> 赞同：3
> 
> 时间：2009-01-19T22:25:56.360
> 
> 标签：.net, openid, dotnetopenauth

I have been thinking of maybe writing a little tool that logs into SO and updates my profile info with some topical/current info on a regular basis (eg. my latest blog post or questions I need help on, etc...)

To get this to work I will need to somehow log on to SO from a console app.

Is there a .Net library that streamlines logging on to an openid website using raw http requests?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-08T08:06:55.850

Nope. Or at least, you can't do it in the general case. Because the part where you present your credentials to your OpenID provider could be anything, right? Maybe the provider authenticates through a token or a phone call or voice auth or whatever, that's outside the OpenID spec.

So you've got two options. One is to get SO to provide a more accessible API for editing your profile, using some mechanism better suited to automated calls (e.g. OAuth).

The other is, if you're writing this code for your personal use, you can control which OpenID provider you're using and choose one that's scriptable. In the extreme case, you could run your own provider an then put whatever security you wanted between your script and your provider. Or you could just try writing a script with something like Mechanize that logged in to your current provider. (Just be sure you have it be well-behaved with respect to hidden form elements and cookies. Good OpenID providers can be very picky about that stuff, to protect your account from cross-site request forgery attacks.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T04:18:37.773

As has been said, you can't generally script logging into an OpenID site, but if the site you want to log into for your console app supports (or can be made to support) OAuth, then you absolutely can get what you want done.

See this question which addresses this, and the accepted answer, which explains all the details: [OpenID authentication and API access](https://stackoverflow.com/questions/544388/openid-authentication-and-api-access/555474#555474)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T00:16:51.097

Here's the most likely place to find it:

[http://wiki.openid.net/Libraries](http://wiki.openid.net/Libraries)

There is one called DotNetOpenId, written in C#, on the list, so it looks promising ;-) but I know nothing about .NET so I couldn't tell you if it will work for you specifically.

Also, a [possibly related question](https://stackoverflow.com/questions/16716/openid-authentication-in-asp-net).

# oracle - Oracle 10g - 一个不可见的列？

> ID：459431
> 
> 赞同：1
> 
> 时间：2009-01-19T22:26:35.110
> 
> 标签：oracle

是否可以在 Oracle 10g 数据库中“隐藏”一列，或者完全阻止数据插入？我们希望现有的 INSERT 语句仍然有效，但不为特定列插入信息。此外，列掩码或任何类型的加密都不是首选。

不确定是否可能，但在此先感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T22:43:36.480

如果您需要做的只是停止插入数据，您可以创建一个 BEFORE INSERT FOR EACH ROW 触发器，在保存行之前清除插入到列中的任何值。

您还可以对安全性（也包括视图）执行各种其他操作，以防止在特定情况下来自特定用户的插入/选择，但这些可能不会让现有的插入继续工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T22:34:57.763

使用 Oracle 特性虚拟专用数据库 (VPD)，您可以定义哪些用户可以更改以及哪些用户可以选择一列。虚拟私有数据库也称为细粒度访问控制 (FGAC)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-11T10:28:30.000

我知道如何隐藏该列。

*   您使用

    > 设置为未使用

    将一列或多列标记为未使用的选项。

*   你使用 DROP

    > 未使用的列

    删除标记为未使用的列的选项。

> ALTER TABLE emp
> SET UNUSED (last_name);

和

> ALTER TABLE emp
> 删除未使用的列；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T10:39:14.690

重命名原始表，使用原始表名创建视图，但只选择要显示的列。

引用现有表重新编译代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-31T04:20:56.390

将您的授权设置为您允许更新或插入的每个项目怎么样？

```
grant select on emp to scott;

grant update (column1, column2), insert (column1) on emp to scott 
```

# java - 如何从 java servlet 中的 POST 数据中分离出查询字符串参数

> ID：459441
> 
> 赞同：3
> 
> 时间：2009-01-19T22:28:52.953
> 
> 标签：java, servlets, http-post, http-get

当您在 servlet 中获得 doGet 或 doPost 调用时，您可以`getparameterxxx()`在一个简单的位置获取查询字符串或发布数据。
如果调用是 GET，则从 url/查询字符串中获取数据。
如果调用是 POST，您会得到所有为您解析的帖子数据。

除非事实证明，如果您没有在表单调用中放置“操作”属性。如果您为操作参数指定完全限定或部分限定的 url，一切正常，如果您不这样做，浏览器将调用与上一页提交时相同的 url，并且如果那里恰好有查询字符串数据，您将获得该数据以及 POST 数据，并且无法将它们区分开来。

或者有吗？我正在查看请求对象，我看到了发布数据的来源，我只是想弄清楚 GET 数据的来源，所以我可以在发布调用时擦除 GET 数据并在如果可能，在解析它之前进行 GET 调用。

知道这样做的安全方法是什么吗？

让我猜一下：您从未尝试过不在表单标签中放置操作字段。:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T22:41:25.237

你是对的，我从来没有尝试过不将操作字段放在表单标签中；-) 我不会，因为你在说什么。（另外，我认为它不是有效的 HTML）

我不知道区分 GET 和 POST 参数的任何“干净”方法，但您可以使用 的方法访问原始查询字符串`getQueryString()`，`HttpServletRequest`并且可以使用 的`getInputStream()`方法访问原始 POST 数据`ServletRequest`。（我在这里专门查看 Tomcat API 文档，尽管我认为它们都是标准 Servlet API 的一部分）然后您可以根据需要分别解析 POST 数据和 GET 数据。它们将（或通常应该）都以相同的方式格式化，即

```
name1=value1&name2=value2&... 
```

虽然可能用分号替换了与号（从技术上讲，你可以在 HTTP/1.1 中做到这一点，直到最近我才知道）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T22:49:39.900

在 HTML 中，动作是[REQUIRED](http://www.w3.org/TR/html401/interact/forms.html#h-17.3)，所以我猜客户端的行为会有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T22:40:20.230

HttpServletRequest.getParameterxxx() 方法不区分 GET 和 POST 参数。如果您真的需要区分它们，您需要手动解析它们，使用 getQueryString() 获取 GET 参数，使用 getInputStream()/getReader() 获取 POST 数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T22:45:18.270

我会编写一个 ServletFilter 并装饰请求对象以稍微清理一下（使用上面希尔顿建议的内容）。这是[拦截过滤器中的经典装饰器模式](http://java.sun.com/blueprints/corej2eepatterns/Patterns/InterceptingFilter.html)。

# c# - 从 ASP.NET 插入到 MS Access

> ID：459442
> 
> 赞同：2
> 
> 时间：2009-01-19T22:29:33.747
> 
> 标签：c#, asp.net, sql-server, visual-studio, ms-access

我们正在尝试为 Intranet 构建一个帮助台票务系统。决定使用 Visual Studio 2008 Express 的 ASP .NET (C#)（认为如果需要，我们有一个完整的版本）。没什么特别的，几页抓取 NTLM 信息、系统信息并将其与问题一起存储在数据库中。目标是让它变得简单，但管理员不希望我使用我们的 SQL Server 2000 后端，而是希望我使用 MS Access。我的 GridView 和连接运行顺畅。可以拉选择查询，直到我心满意足。但是，将几个变量与提交按钮上的文本框绑定到一个 INSERT 语句中。我什至不知道从哪里开始使用 MS Access。每个 Internet 示例都在 VB .NET 中，而且似乎是 Visual Studio 已经为我完成的手动编码，只需单击几下。

MS Access 对我们想做的所有事情来说都太难了吗？如果没有，我们从哪里开始简单地将这些数据提交到表中？

编辑：在玩了一堆之后，我们让 OleDB 工作了。它不漂亮，是的，SQL Server 会很棒，但有时你只需要打球。

编辑：任何寻找实际编码答案的人，都在这里。必须有其他人在同一条船上。

```
 string userIP = Request.UserHostAddress.ToString();
    string userDNS = Request.UserHostName.ToString();
    string duser = Request.ServerVariables["LOGON_USER"];  //NTLM Domain\Username
    string computer = System.Environment.MachineName.ToString(); //Computer Name
    string connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\helpdesk.MDB;";

    OleDbConnection conn = new OleDbConnection(connectionString);
    conn.Open();
    OleDbCommand cmd = new OleDbCommand();
    cmd.Connection = conn;
    cmd.CommandText = "INSERT INTO ticketing ([user], [comp], [issue]) VALUES (@duser, @computer, @col3)";
    cmd.Parameters.Add("@duser", OleDbType.VarChar).Value = duser;
    cmd.Parameters.Add("@computer", OleDbType.VarChar).Value = computer;
    cmd.Parameters.Add("@col3", OleDbType.LongVarChar).Value = TextBox1.Text;
    cmd.ExecuteNonQuery();
    conn.Close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T22:31:47.580

管理员疯了。Access 是一个`in-process`数据库，因此不太适合用户将创建或更新记录的网站。

但就创建 INSERT 查询而言，Access 并不比其他任何事情都难。如果您无法为 Access 创建 INSERT 查询，您可能也会遇到 SQL Server 问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T22:53:53.793

我还建议使用 SQL Server，但考虑到您的问题：为 Access 编写 INSERT 查询有什么问题？您应该使用 System.Data.OleDb 命名空间中的类：

*   OleDbConnection
*   OleDbCommand

Quick'n 脏代码（未编译）：

```
OleDbConnection conn = new OleDbConnection (connectionString);

OleDbCommand command = new OleDbCommand();
command.Connection = conn;
command.CommandText= "INSERT INTO myTable (col1, col2) VALUES (@p_col1, @p_col2)";
command.Parameters.Add ("@p_col1", OleDbType.String).Value = textBox1.Text;
...
command.ExecuteNonQUery(); 
```

然而，OleDb 类有一些注意事项（例如，按照它们在 SQL 语句中出现的顺序将参数添加到集合中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T22:37:57.100

不要打扰访问。使用 SQL Server Express。它还有一个管理工具，看起来像完整的 SQL Server 管理工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-11T17:41:52.940

Access 有它的位置，通常可以做的比大多数人认为的要多，但是是的，你想使用 SQL Server 的多种形式（例如 SQL Server Express）或另一个适当的网络“服务器”数据库像这样的应用程序。

# jquery - Jquery wrapInner - 不包括第一个元素

> ID：459447
> 
> 赞同：4
> 
> 时间：2009-01-19T22:31:21.997
> 
> 标签：jquery, wrapper

我正在尝试打开/折叠我网站的部分，这些部分是带有图例标签上的单击事件的字段集。但是，我将需要使用 wrapInner 在字段集中添加一个 div 以隐藏内容……但这也隐藏了图例（我绝对不想这样做）:-)。如何使用 wrapInner 但指定不隐藏图例（或者字段集中包含的第一个元素 - 因为它始终是图例）。

```
$("#mainarea fieldset").wrapInner("<div class='fieldsetWrapper'></div>");

$("#mainarea fieldset:not(:first)").addClass("fsClosed"); // Close all fieldsets within the main area (but not the first one)

$("#mainarea fieldset legend").mousedown(function(){  // When clicking the legend of a fieldset ...
    $("#mainarea fieldset:not(.fsClosed)").addClass("fsClosed");  // If it's already open, close it
    $(this).parent().removeClass("fsClosed");  // If it's closed, remove the closed class from the containing fieldset
    return false;
}); 
```

干杯马克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T01:02:07.560

为了回应您在 Pim 示例中的评论，您需要遍历字段集

```
$('#mainarea fieldset').each(function(){
   $(this).children().not('legend').wrapAll("<div class='fieldsetWrapper'></div>");
}); 
```

您可能可以将其重构为这样的东西；

```
$('#mainarea fieldset').each(function(){
   $(':not(legend)', this).wrapAll("<div class='fieldsetWrapper'></div>");
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T22:36:39.787

```
$('#mainarea fieldset').children(':gt(0)').wrapAll("<div class='fieldsetWrapper'></div>"); 
```

这应该可以解决问题。
关于 wrapAll 函数的信息：http: [//docs.jquery.com/Manipulation/wrapAll#html](http://docs.jquery.com/Manipulation/wrapAll#html) >

**编辑**
可能更好：

```
$('#mainarea fieldset').children().not('legend').wrapAll("<div class='fieldsetWrapper'></div>"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-06T23:53:41.413

我最终使用了以下解决方案：

```
//Wrap everyting in the fieldset tags
$('#mainarea fieldset').wrapInner("<div class='fieldsetWrapper'></div>");

//for each legend tag move it out of the newly created wrapping div 
$('legend').each(function(){
  $(this).insertBefore($(this).parent());
});
```

首先它将所有内容包装在字段集标签内（包括图例），然后它“解包”图例标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T18:09:41.857

```
$(document).ready(function(){
    $("fieldset legend").click(function(){
        $(this).parent().children().not('legend').toggle("slow");
    });
}); 
```

# sql - 什么是存储过程？

> ID：459457
> 
> 赞同：317
> 
> 时间：2009-01-19T22:33:24.520
> 
> 标签：sql, sql-server, tsql, stored-procedures

什么是*“存储过程”*，它们是如何工作的？

存储过程的组成是什么（每个东西都*必须*是存储过程）？

* * *

## 回答 #1

> 赞同：256
> 
> 时间：2009-01-19T22:57:15.237

存储过程是一批可以通过多种方式执行的 SQL 语句。大多数主要的 DBM 都支持存储过程；但是，并非所有人都这样做。您将需要使用特定的 DBMS 帮助文档来验证细节。因为我最熟悉 SQL Server，所以我将使用它作为我的示例。

要创建存储过程，语法相当简单：

```
CREATE PROCEDURE <owner>.<procedure name>

     <Param> <datatype>

AS

     <Body> 
```

例如：

```
CREATE PROCEDURE Users_GetUserInfo

    @login nvarchar(30)=null

AS

    SELECT * from [Users]
    WHERE ISNULL(@login,login)=login 
```

存储过程的一个好处是您可以将数据访问逻辑集中到一个地方，这样 DBA 就可以轻松地对其进行优化。存储过程还具有安全优势，您可以授予存储过程执行权限，但用户不需要对基础表具有读/写权限。这是对抗 SQL 注入的良好第一步。

存储过程确实有缺点，基本上是与基本[CRUD](https://en.wikipedia.org/wiki/Create,_read,_update_and_delete)操作相关的维护。假设对于每个表，您有一个插入、更新、删除和至少一个基于主键的选择，这意味着每个表将有 4 个过程。现在使用一个包含 400 个表的大小合适的数据库，并且您有 1600 个程序！这是假设你没有你可能会有的重复项。

这就是使用[ORM](https://stackoverflow.com/questions/1279613/what-is-an-orm-and-where-can-i-learn-more-about-it)或其他方法自动生成基本 CRUD 操作的优点。

* * *

## 回答 #2

> 赞同：155
> 
> 时间：2013-06-13T10:16:48.417

存储过程是一组用于执行特殊任务的预编译 SQL 语句。

示例：如果我有一张`Employee`桌子

```
Employee ID  Name       Age  Mobile
---------------------------------------
001          Sidheswar  25   9938885469
002          Pritish    32   9178542436 
```

首先，我正在检索`Employee`表：

```
Create Procedure Employee details
As
Begin
    Select * from Employee
End 
```

要在 SQL Server 上运行该过程：

```
Execute   Employee details

--- (Employee details is a user defined name, give a name as you want) 
```

其次，我将值插入到员工表中

```
Create Procedure employee_insert
    (@EmployeeID int, @Name Varchar(30), @Age int, @Mobile int)
As
Begin
    Insert Into Employee
    Values (@EmployeeID, @Name, @Age, @Mobile)
End 
```

要在 SQL Server 上运行参数化过程：

```
Execute employee_insert 003,’xyz’,27,1234567890

  --(Parameter size must be same as declared column size) 
```

例子：`@Name Varchar(30)`

在`Employee`表格中，`Name`列的大小必须为`varchar(30)`。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2014-04-09T12:01:47.650

存储过程是一组已创建并存储在数据库中的 SQL 语句。存储过程将接受输入参数，以便多个客户端可以通过网络使用不同的输入数据来使用单个过程。存储过程将减少网络流量并提高性能。如果我们修改存储过程，所有客户端都将获得更新的存储过程。

创建存储过程的示例

```
CREATE PROCEDURE test_display
AS
    SELECT FirstName, LastName
    FROM tb_test;

EXEC test_display; 
```

使用存储过程的优点

*   存储过程允许模块化编程。

    您可以创建该过程一次，将其存储在数据库中，并在您的程序中多次调用它。

*   存储过程允许更快的执行。

    如果操作需要大量重复执行的 SQL 代码，存储过程可以更快。它们在第一次执行时被解析和优化，存储过程的编译版本保留在内存缓存中供以后使用。这意味着存储过程不需要在每次使用时重新解析和重新优化，从而缩短执行时间。

*   存储过程可以减少网络流量。

    需要数百行 Transact-SQL 代码的操作可以通过在过程中执行代码的单个语句来执行，而不是通过网络发送数百行代码。

*   存储过程为您的数据提供更好的安全性

    用户可以被授予执行存储过程的权限，即使他们没有直接执行过程语句的权限。

    在 SQL Server 中，我们有不同类型的存储过程：

    *   系统存储过程
    *   用户定义的存储过程
    *   扩展存储过程
*   **系统**存储过程存储在主数据库中，并以`sp_`前缀开头。这些过程可用于执行各种任务，以支持 SQL Server 函数在系统表中进行外部应用程序调用

    示例：sp_helptext [StoredProcedure_Name]

*   **用户定义的**存储过程通常存储在用户数据库中，通常旨在完成用户数据库中的任务。在编写这些程序**时不使用**前缀，`sp_`因为如果我们`sp_`先使用前缀，它会检查主数据库，然后是用户定义的数据库。

*   **扩展**存储过程是从 DLL 文件调用函数的过程。如今，不推荐使用扩展存储过程，因为最好避免使用扩展存储过程。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-01-19T22:45:29.970

通常，存储过程是“SQL 函数”。他们有：

```
-- a name
CREATE PROCEDURE spGetPerson
-- parameters
CREATE PROCEDURE spGetPerson(@PersonID int)
-- a body
CREATE PROCEDURE spGetPerson(@PersonID int)
AS
SELECT FirstName, LastName ....
FROM People
WHERE PersonID = @PersonID 
```

这是一个以 T-SQL 为重点的示例。存储过程可以执行大多数 SQL 语句，返回标量和基于表的值，并且被认为更安全，因为它们可以防止 SQL 注入攻击。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2016-05-22T06:13:18.870

想想这样的情况，

*   您有一个包含数据的数据库。
*   访问该中央数据库需要许多不同的应用程序，未来还需要一些新的应用程序。
*   如果您要在每个应用程序的代码中分别插入内联数据库查询以访问中央数据库，那么您可能必须在不同应用程序的代码中一次又一次地复制相同的查询。
*   在这种情况下，您可以使用存储过程 (SP)。使用存储过程，您正在编写许多常见查询（过程）并将它们存储在中央数据库中。
*   现在不再像以前那样重复工作，数据访问和维护将集中完成。

笔记：

*   在上述情况下，您可能想知道“为什么我们不能引入中央数据访问服务器来与所有应用程序交互？是的。这将是一个可能的替代方案。但是，
*   SP 与该方法相比的主要优势在于，与您的数据访问代码具有内联查询不同，SP 是预编译语句，因此它们将执行得更快。并且通信成本（通过网络）将降至最低。
*   与此相反，SP 会给数据库服务器增加一些负载。如果根据情况考虑这将是一个问题，那么具有内联查询的集中式数据访问服务器将是一个更好的选择。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-08-21T10:02:36.567

存储过程主要用于在数据库上执行某些任务。例如

*   从数据的某些业务逻辑中获取数据库结果集。
*   在一次调用中执行多个数据库操作。
*   用于将数据从一个表迁移到另一个表。
*   可以为其他编程语言调用，例如 Java。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-12-28T15:30:07.220

存储过程不过是编译成单个执行计划的一组 SQL 语句。

1.  创建一次并调用它 n 次
2.  它减少了网络流量

示例：创建存储过程

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE GetEmployee
      @EmployeeID int = 0
AS
BEGIN
      SET NOCOUNT ON;

      SELECT FirstName, LastName, BirthDate, City, Country
      FROM Employees 
      WHERE EmployeeID = @EmployeeID
END
GO 
```

更改或修改存储过程：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE GetEmployee
      @EmployeeID int = 0
AS
BEGIN
    SET NOCOUNT ON;

    SELECT FirstName, LastName, BirthDate, City, Country
    FROM Employees 
    WHERE EmployeeID = @EmployeeID
END
GO 
```

删除或删除存储过程：

```
DROP PROCEDURE GetEmployee 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2013-12-19T05:25:56.217

存储过程用于检索数据、修改数据和删除数据库表中的数据。每次要在 SQL 数据库中插入、更新或删除数据时，您都不需要编写完整的 SQL 命令。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-05-31T13:15:15.247

*   存储过程是一组预编译的执行某些特定任务的一个或多个 SQL 语句。

*   存储过程应该使用独立执行`EXEC`

*   一个存储过程可以返回多个参数

*   可以使用存储过程来实现事务

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-08-15T18:34:21.820

“什么是存储过程”已在此处的其他帖子中得到解答。我将发布的是一种鲜为人知的使用存储过程的方法。它是`grouping stored procedures`或`numbering stored procedures`。

**语法参考**

[![在此处输入图像描述](https://i.stack.imgur.com/W3U2d.png)](https://i.stack.imgur.com/W3U2d.png)

`; number`按照[这个](https://docs.microsoft.com/en-us/sql/t-sql/statements/create-procedure-transact-sql)

> 一个可选整数，用于对同名过程进行分组。可以使用一个 DROP PROCEDURE 语句将这些分组过程一起删除

**例子**

```
CREATE Procedure FirstTest 
(
    @InputA INT
)
AS 
BEGIN
    SELECT 'A' + CONVERT(VARCHAR(10),@InputA)
END
GO

CREATE Procedure FirstTest;2
(
    @InputA INT,
    @InputB INT
)
AS 
BEGIN
    SELECT 'A' + CONVERT(VARCHAR(10),@InputA)+ CONVERT(VARCHAR(10),@InputB)
END
GO 
```

**采用**

```
exec FirstTest 10
exec FirstTest;2 20,30 
```

**结果**

[![在此处输入图像描述](https://i.stack.imgur.com/BLVh9.png)](https://i.stack.imgur.com/BLVh9.png)

**另一个尝试**

```
CREATE Procedure SecondTest;2
(
     @InputA INT,
    @InputB INT
)
AS 
BEGIN
    SELECT 'A' + CONVERT(VARCHAR(10),@InputA)+ CONVERT(VARCHAR(10),@InputB)
END
GO 
```

**结果**

> Msg 2730, Level 11, State 1, Procedure SecondTest, Line 1 [Batch Start Line 3] 无法创建组号为 2 的过程“SecondTest”，因为当前不存在具有相同名称和组号 1 的过程数据库。必须先执行 CREATE PROCEDURE 'SecondTest';1。

**参考资料**：

1.  [使用 number 的语法创建过程](https://docs.microsoft.com/en-us/sql/t-sql/statements/create-procedure-transact-sql)
2.  [SQL Server 中的编号存储过程 - techie-friendly.blogspot.com](http://techie-friendly.blogspot.com/2014/05/numbered-stored-procedures-in-sql-server.html)
3.  [分组存储过程 - sqlmag](http://sqlmag.com/database-administration/all-about-stored-procedures)

**警告**

1.  将程序分组后，您不能单独删除它们。
2.  此功能可能会在 Microsoft SQL Server 的未来版本中删除。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-09-08T12:04:55.917

为了简单，

**存储过程**是**存储程序**，存储在数据库中的程序/函数。

每个存储的程序都包含一个由 SQL 语句组成的主体。该语句可能是由分号 (;) 字符分隔的多个语句组成的复合语句。

```
CREATE PROCEDURE dorepeat(p1 INT)
BEGIN
  SET @x = 0;
  REPEAT SET @x = @x + 1; UNTIL @x > p1 END REPEAT;
END; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-08T12:57:52.997

存储过程是 SQL 语句和过程逻辑的命名集合，即编译、验证并存储在服务器数据库中。存储过程通常被视为其他数据库对象，并通过服务器安全机制进行控制。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-08-18T06:37:24.813

在 DBMS 中，存储过程是一组具有指定名称的 SQL 语句，它们以编译的形式存储在数据库中，以便可以由多个程序共享。

使用存储过程有助于

1.  提供对数据的受控访问（最终用户只能输入或更改数据，但不能编写程序）

2.  确保数据完整性（数据将以一致的方式输入）和

3.  提高生产力（存储过程的语句只需要编写一次）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-09-13T07:21:45.643

SQL Server 中的存储过程可以接受输入参数并返回多个输出参数值；在 SQL Server 中，存储过程程序语句在数据库中执行操作并将状态值返回给调用过程或批处理。

在 SQL Server 中使用存储过程的好处

它们允许模块化编程。它们允许更快的执行。它们可以减少网络流量。它们可以用作安全机制。

下面是一个存储过程的例子，它接受一个参数，执行一个查询并返回一个结果。具体来说，存储过程接受 BusinessEntityID 作为参数并使用它来匹配 HumanResources.Employee 表的主键以返回请求的员工。

```
> create procedure HumanResources.uspFindEmployee    `*<<<---Store procedure name`*
@businessEntityID                                     `<<<----parameter`
as
begin
SET NOCOUNT ON;
Select businessEntityId,              <<<----select statement to return one employee row
NationalIdNumber,
LoginID,
JobTitle,
HireData,
From HumanResources.Employee
where businessEntityId =@businessEntityId     <<<---parameter used as criteria
end 
```

我从essential.com 学到的……它非常有用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-07T10:41:05.637

存储过程将帮助您在服务器中编写代码。您可以传递参数并查找输出。

```
create procedure_name (para1 int,para2 decimal)
as
select * from TableName 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-11-28T12:04:07.473

在存储过程中，语句只写一次，减少了客户端和服务器之间的网络流量。我们还可以避免 Sql 注入攻击。

*   如果您在应用程序中使用第三方程序来处理付款，这里的数据库应该只公开它需要的信息和该第三方已被授权的活动，这样我们可以通过使用存储过程设置权限来实现数据机密性。
*   表的更新应该只对它所针对的表进行，而不应该更新任何其他表，通过它我们可以使用事务处理和错误处理来实现数据完整性。
*   如果您想返回一个或多个数据类型的项目，那么最好使用输出参数。
*   在存储过程中，我们将输出参数用于需要返回的任何内容。如果您只想返回一个只有整数数据类型的项目，那么最好使用返回值。实际上返回值只是通知存储过程的成功或失败。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-07-04T11:54:40.947

前言：1992 年，SQL92 标准被创建并被 Firebase DB 推广。本标准引入了“存储过程”。

** 直通查询：一个字符串（通常以编程方式连接），其计算结果为语法正确的 SQL 语句，通常在服务器层生成（使用 PHP、Python、PERL 等语言）。然后将这些语句传递到数据库。**

** 触发器：设计用于响应数据库事件（通常是 DML 事件）而触发的一段代码，通常用于强制执行数据完整性。**

解释什么是存储过程的最好方法是解释执行数据库逻辑的传统方式（即不使用存储过程）。

创建系统的传统方式是使用“直通查询”，并且可能在数据库中有触发器。几乎所有不使用存储过程的人都使用一种叫做“直通查询”的东西

随着存储过程的现代约定，触发器与“直通查询”一起成为传统。

存储过程的优点是：

1.  它们可以被缓存，因为存储过程的物理文本永远不会改变。
2.  他们内置了防止恶意 SQL 注入的机制。
3.  只需要检查参数是否有恶意 SQL 注入，从而节省大量处理器开销。
4.  大多数现代数据库引擎实际上编译存储过程。
5.  它们增加了层之间的抽象程度。
6.  它们发生在与数据库相同的过程中，从而允许更大的优化和吞吐量。
7.  无需客户端代码即可测试后端的整个工作流程。（例如 Transact SQL 中的 Execute 命令或 MySQL 中的 CALL 命令）。
8.  它们可用于增强安全性，因为它们可用于禁止以与系统设计工作方式不一致的方式访问数据库。这是通过数据库用户权限机制完成的。例如，您可以只授予用户执行存储过程的权限，而不是 SELECT、UPDATE 等权限。
9.  不需要与触发器关联的 DML 层。** 使用一个触发器，打开一个处理器密集型的 DML 层 **

总之，当创建一个新的 SQL 数据库系统时，没有很好的理由使用 Passthrough Queries。

还值得注意的是，在已经使用触发器或直通查询的遗留系统中使用存储过程是完全安全的；这意味着从遗留程序迁移到存储过程非常容易，而且这种迁移不需要让系统长时间停机。

# asp.net - asp.net 自定义数据分页器

> ID：459459
> 
> 赞同：2
> 
> 时间：2009-01-19T22:33:39.747
> 
> 标签：asp.net, listview

在我见过的所有数据分页器示例中（使用绑定到 ListView 的 LinqDataSource），对数据库的查询返回完整的记录集。我怎样才能得到我想要显示的行的页面？

例如，如果我有一个包含 100 万行的表，并且我想在第 5 页上查看 10 个结果，我将得到第 51 到 60 行。

我确定我必须实现自定义分页，但我没有找到任何好的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:50:39.103

有很多方法可以做到这一点，但是，我个人喜欢一个基于 SQL 的解决方案，它可以访问数据库并获取结果集。这篇[4GuysFromRolla 文章](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)很好地解释了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T11:20:28.777

我的印象是（来自 Scott Guthie 的博客文章“ [LINQ to SQL（第 9 部分）](http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx) ”）LinqDataSource 在数据库级别为您处理分页：

> 上面要注意的一件很酷的事情是分页和排序仍然可以与我们的 GridView 一起使用——即使我们使用自定义的 Selecting 事件来检索数据。 **这种分页和排序逻辑发生在数据库中**——这意味着我们只需要从数据库中提取 10 个产品，这些产品需要在 GridView 中显示当前页面索引（使其非常高效）。

（原重点）

如果您使用一些自定义分页，您可以在 LINQ to SQL 中执行以下操作：

```
var tagIds = (from t in Tags where tagList.Contains(t.TagText) select t.TagID).Skip(10).Take(10).ToList(); 
```

这告诉 LINQ 在跳过前 10 行之后占用 10 行（相当于 T-SQL“TOP 10”）——显然这些值可以是动态的，基于页面大小和页码，但你明白了。

引用的帖子还谈到了使用带有 LinqDataSource 的自定义表达式。

[Scott 在第 3 部分](http://weblogs.asp.net/scottgu/archive/2007/06/29/linq-to-sql-part-3-querying-our-database.aspx)也有更多关于 Skip/Take 的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T22:48:46.110

如果您使用的是 MSSql2005，请查看这篇[文章](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)。

如您所见，诀窍是使用函数 ROW_NUMBER()，它允许您获取记录集中行的序号。有了它，您可以根据想要在页面中获取的行数简单地启用分页。

# php - 使用 Vim 正确缩进 HTML 和 PHP

> ID：459478
> 
> 赞同：53
> 
> 时间：2009-01-19T22:39:48.843
> 
> 标签：php, html, vim, indentation

我使用 Vim 已经有一段时间了，但我无法在 PHP 文件中获得正确的 HTML 缩进。

例如，我想要的是让每个孩子比它的父母缩进一个标签，如下所示。

```
<?php
if(isset($sports)) {
    //Do something
?>
<div>
    <label>Uniform Size</label>
    <ul>
        <li class="left"><label for="s" class="small">S</label><input type="radio" name="size[]" value="S" id="s" class="radio" /></li>
        <li class="left"><label for="m" class="small">M</label><input type="radio" name="size[]" value="M" id="m" class="radio" /></li>
        <li class="left"><label for="l" class="small">L</label><input type="radio" name="size[]" value="L" id="l" class="radio" /></li>
        <li class="left"><label for="xl" class="small">XL</label><input type="radio" name="size[]" value="XL" id="xl" class="radio" /></li>
    </ul>
</div>
<?php
}
?> 
```

使用[PHP-correct-Indent](http://www.vim.org/scripts/script.php?script_id=1120)脚本，代码的格式如下：

```
<?php
if(isset($sports)) {
    //Do something
?>
<div>
<label>Uniform Size</label>
<ul>
<li class="left"><label for="s" class="small">S</label><input type="radio" name="size[]" value="S" id="s" class="radio" /></li>
<li class="left"><label for="m" class="small">M</label><input type="radio" name="size[]" value="M" id="m" class="radio" /></li>
<li class="left"><label for="l" class="small">L</label><input type="radio" name="size[]" value="L" id="l" class="radio" /></li>
<li class="left"><label for="xl" class="small">XL</label><input type="radio" name="size[]" value="XL" id="xl" class="radio" /></li>
</ul>
</div>
<?php
}
?> 
```

即使使用缩进的 HTML，然后我添加 PHP 代码，缩进也会被忽略，移动 HTML 代码的新行而根本没有任何缩进。

那么，有什么方法可以让我使用 Vim 在 PHP 文件中使用 HTML 获得我想要的缩进格式？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2010-11-03T07:49:30.797

这仍然困扰着我。我*只是*决定最好的解决方法（对我个人而言）是这样的：

```
:set filetype=html 
```

然后突出显示您的文本并点击`=`。繁荣！HTML 格式化成功。（不理想，我知道，但至少它有效。）

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-20T18:44:05.043

Vim Wiki 上有一组 vimrc 指令，称为[Better indent support for PHP with HTML](http://vim.wikia.com/wiki/Better_indent_support_for_php_with_html)，它将根据块使用正确的插件。

还有一个[Vundle/Pathogen 插件](https://jordaneldredge.com/blog/better-indent-support-for-php-in-vim/)使用相同的代码，但更易于安装并保持`.vimrc`清洁。

**病原**

```
cd ~/.vim/bundle
git clone https://github.com/captbaritone/better-indent-support-for-php-with-html.git 
```

**文德尔**

放在 .vimrc 中

```
Bundle 'captbaritone/better-indent-support-for-php-with-html' 
```

在 vim 中运行

```
:BundleInstall 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-05-13T20:31:13.063

在仔细研究了所有解决方案之后，我发现了这个插件：

[http://www.vim.org/scripts/script.php?script_id=604](http://www.vim.org/scripts/script.php?script_id=604)

好像解决了我的问题！！！！

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-11-19T12:45:15.020

对我来说，如果我先做`:set ft=html`然后再做，效果很好`:set syn=php`。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-01-07T13:05:31.097

在 php+html 中，我发现以下内容对我有好处。

```
:set ft=html # Change the file type to html
=G # to indent all lines 
:set ft=phtml # Change the file type to phtml
=G # to indent all php lines 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T01:51:56.383

php-correct-indenting 只关心你的 PHP，并假设 HTML 的可读性是不感兴趣的。XML 缩进器可以很好地定位标签，但不能缩进 <?php> 处理指令的内容以匹配。也许有一个缩进脚本可以理解 PHP 编程语言的类 C 语法和 [X][HT]ML 被模板化的标记语言，但我还没有遇到过 - 抱歉。

尽管如此，即使在 php-correct-indenting 破坏它之前，我还是想摆弄你的例子中的缩进！<div> 元素位于外部 if 语句内，但我无法从缩进中看到这一点。我建议像：

```
<?php if(isset($sports)) { ?>
    <?php
        // Do something
    ?>
    <div>
        <label>Uniform Size</label>
        <ul>
            <li>etc. etc.</li>
        </ul>
    </div>
<?php } ?> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-21T03:10:05.447

我发现这个解决方案要好得多。 [http://www.vim.org/scripts/script.php?script_id=1120](http://www.vim.org/scripts/script.php?script_id=1120)

支持 HEREDOC html 样式。这在我的代码中经常出现。
顺便说一句：它的版本比旧版本多（脚本 id 604，alex 在上面发布）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-28T16:05:26.277

在你的 .vimrc 里面：

```
:function IndentPHPHTML()
:  set ft=html
:  normal gg=G
:  set ft=php
:endfunction 
```

使用 ctrl-shift-L （或其他）缩进

```
nnoremap <C-S-l> :call IndentPHPHTML()<cr> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-30T02:47:51.903

在搜索了几天的解决方案后，没有任何效果，最后这有效，将其添加到您的 vimrc

```
au BufEnter,BufNew *.php :set filetype=html 
```

# java - 什么是 xdoclet？（从 C 程序员的角度来看）

> ID：459479
> 
> 赞同：2
> 
> 时间：2009-01-19T22:39:54.350
> 
> 标签：java, c, java-native-interface, xdoclet

来自一个 C-guy 的问题，他必须使用一些通过 JNI 连接到我的 C 代码的 java 代码。

我必须在构建系统上工作，并且我正在尝试将其从 shell 脚本更改为正确的 makefile。对于 C 部分来说这很容易，但 java 方面不知何故涉及 xdoclet 的东西。

我还没有发现 xdoclet 的全部内容，我想了解这一切。

我做了我的谷歌研究，但我**不**知道那东西是做什么的。对我来说，如果你已经熟悉这个问题并且你有 10 年的 Java 工作经验，你似乎只有机会了解官方文档。

您能否解释一下 xdoclet 的作用？

顺便说一句 - 我也提到了 C。我也喜欢面向对象的编程。无需向我解释类或继承的基础知识（如果需要了解 xdoclet）。

* * *

编辑：大约十年前，我问过这个问题是针对 IT 的。我仍然不知道 xdoclet 是什么，但这个问题获得了超过一千次的浏览量。我想看到一些 Java 人来插话，最后把事情弄清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T22:50:37.527

XDoclet 的 10000 英尺视图是它是一个代码生成引擎。IMO，关于 XDoclet 的有趣之处在于它***如何***做它所做的，而不是它***所做***的。

有一个名为 javadoc 的工具，它在源代码注释中获取注释并使用它生成 html 文档。 这是javadoc 最初旨在生成[的经典示例。](http://java.sun.com/javase/6/docs/api/)为了支持不同的输出格式，javadoc 的作者使其可插入——您可以将“ *doclet* ”那个插件写到 javadoc 引擎中。这允许他们利用相同的源代码解析器，并发出不同的文档输出。

XDoclet 是一个聪明的 hack，它使用这个引擎来进行代码生成而不是文档生成。

一个使用示例是：开发人员手动编写一个包含业务逻辑的类，向 javadoc 添加一些 xdoclet 注释，然后 xdoclet 生成提供事务完整性的附加代码。

**编辑：** 正如[埃里克森](https://stackoverflow.com/users/3474/erickson)所指出的，Java 5 添加了对注释的支持，作为一种可以由编译器直接处理的语言特性。因此，XDoclet 过去提供的功能现在可以直接由 JDK 附带的注释处理工具 (apt) 执行。因为这个 XDoclet 现在通常被认为是过时的。

# equation - 2 变量线性回归方程

> ID：459480
> 
> 赞同：2
> 
> 时间：2009-01-19T22:40:01.683
> 
> 标签：equation, regression, linear-regression

我们正在使用一种没有线性回归函数的编程语言。我们已经实现了一个单变量线性方程：

> y = Ax + B

并使用类似于[此 Stack Overflow 答案](https://stackoverflow.com/questions/364558/find-a-best-fit-equation#364585)的解决方案从数据中简单地计算了 A 和 B 系数。

我知道随着变量的添加，这个问题在几何上变得更加困难，但为了我们的目的，我们只需要再添加一个：

> z = Ax + By + C

在给定 x、y 和 z 的数组的情况下，有没有人有封闭形式的方程或任何语言的代码可以求解 A、B 和 C？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T23:55:04.747

所以你有三个线性方程

```
k = aX1 + bY1 + cZ1
k = aX2 + bY2 + cZ2
k = aX3 + bY3 + cZ3 
```

您可以做的就是将其重写为 matriz

```
| x1 y1 z1 | | a |   | k |
| x2 y2 z2 | | b | = | k |
| x3 y3 y3 | | c |   | k | 
```

算出`[a b c ]`做以下矩阵运算

```
| a |              | x1 y1 z1 |     | k |
| b | =  inverse(  | x2 y2 z2 | )   | k |
| c |              | x3 y3 y3 |     | k | 
```

可以在[此处找到 3x3 矩阵求逆的公式](http://www.dr-lex.be/random/matrix_inv.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T23:27:40.417

[是的，如果您按照Gil Strang](http://videolectures.net/mit18085f07_strang_lec04/)的方式思考，这是一个简单的线性代数问题。 [这](http://www.dm.unibo.it/~regonati/ad0708/strang-FTLA.pdf)是书面解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T23:38:03.437

您可以使用 MatLab 还是必须在您的软件中进行计算？

MatLab 关于[多元回归分析](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/data_analysis/f1-8450.html)的说明。

[将 MatLab 与 C# 集成](http://www.mathworks.com/matlabcentral/fileexchange/12987)。

# winforms - 从 Visual Studio 2008 的 WinForms 工具箱中筛选自定义 .net 控件的选项有哪些？

> ID：459482
> 
> 赞同：1
> 
> 时间：2009-01-19T22:40:42.023
> 
> 标签：winforms, visual-studio-2008, user-controls, designer, toolbox

Visual Studio 2008 在检测控件并将控件从项目添加到工具箱以供表单设计器使用方面做得更好。如果您有一个具有 UserControl 或 DataSet 派生类型的程序集，那么它将自动检测该控件并将其添加到用于设计表单的工具箱中。这比 2005 年的旧系统*稍微*好一点，旧系统使您手动添加控件并且偶尔会忘记它们等。

然而，在我正在处理的遗留的、单一的项目（现在升级到 vs2008）上，这意味着许多我不想要也不需要的控件（并且对这么多遗留代码进行重新设计是没有保证的：（）。我想如果我将某些类型设置为内部或私有，那么它们就不会出现。但是，我需要其中许多保持公开，但不会出现在工具箱中。此外，有这么多控件被添加到工具箱中，打开 winforms 设计器显着减慢。

1.  是否存在阻止工具箱外观的属性或其他机制（否则不会影响功能）？
2.  使用这种机制进行过滤会提高性能，同时仍然自动检测应该在工具箱中的新类型吗？（我知道你可以禁用自动检测，但在很多情况下它很好）
3.  其他人是否在大型解决方案（具有许多 csproj/vbproj 文件）上遇到过这种烦恼？

编辑：谢谢大家！我知道它必须简单（并且可能是一个属性），但这填补了空白。很高兴知道我在不知道 ToolBoxItem(false) 的情况下相处得很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:47:01.043

以下属性应将其从工具箱中隐藏：

```
[ToolboxItem(false)] 
```

如果将其应用于所有不想显示的类型，它仍会显示您创建的没有此属性的任何新类型。请注意，您可能必须手动删除要开始的项目。

此[博客文章](http://www.west-wind.com/Weblog/posts/98947.aspx)显示了您可能想要使用的一些其他属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T22:45:29.690

浏览工具箱并为您看到要隐藏的每个自定义控件，在类上方添加以下属性：

> [工具箱项目（假）]

当然，这是一个编译属性，会影响到每个使用代码的人，所以我只建议对没有拖放意义的控件这样做。否则，你可能会让喜欢这种控制的人非常非常生气。:)

# iphone - iPhone编程：发送短信？访问联系人列表？

> ID：459483
> 
> 赞同：7
> 
> 时间：2009-01-19T22:41:07.470
> 
> 标签：iphone

我还是 API 的新手，我想问：

*   你能以编程方式发送短信吗？
*   您可以以编程方式访问用户联系人列表吗？

我想**没有**。我没有在 API 中看到任何有关文本消息的信息，而且我认为 iPhone 的沙盒功能可以让您远离电话联系人列表。

谢谢大家。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T22:46:03.230

1）恐怕你不能用 iPhone SDK 发送短信，虽然你可以像这样创建一个发送短信的链接：

```
a href="sms:408-555-5555"&gt;408 555 5555&lt;/a&gt; 
```

2) 您可以使用[通讯录 UI 框架访问联系人列表](http://developer.apple.com/iphone/library/documentation/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/100-Introduction/chapter_1_section_1.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-04T12:02:16.277

解决 sms/mms 问题的一种方法是使用外部聚合器，然后您可以在服务器和 iphone 之间利用 http 发送 sms，显然这种方式对开发人员来说是有成本的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-09T12:01:42.513

是的，您可以构建一个应用程序来发送短信。您只需要一个服务器 API，您将通过您的代码调用它来发送短信。我说这个 bcoz 我目前正在研究它。

一旦我完成了我的应用程序，我将分享它。 [http://shishir.com?from=shishir&to=shishir&message=hi&sandbox=false&username=user&password=pass](http://shishir.com?from=shishir&to=shishir&message=hi&sandbox=false&username=user&password=pass)

u hv 通过 URL 传递值。

很快就会深入。

问候希希尔

# cocoa - 监视 Cocoa 应用程序以在 Mac OS X 上执行外部实用程序（例如 ffmpeg）？

> ID：459493
> 
> 赞同：4
> 
> 时间：2009-01-19T22:44:08.010
> 
> 标签：cocoa, debugging, macos, trace, dtrace

有一些 Mac GUI 应用程序为更令人讨厌的命令行工具（通常包含在应用程序包的一部分）提供前端。我想看看这些 GUI 背后发生了什么。

如何“附加”到应用程序，监视它是否调用命令行实用程序并记录这些调用的文件名和命令行参数？

解决方案也可以是记录 Mac OS X 上所有应用程序执行的应用程序（过滤掉最常见的系统调用）。

示例 GUI 前端： http: [//xact.sourceforge.net/](http://xact.sourceforge.net/)（因为它是开源的，所以可以调试它，但 xACT 只是一个示例。假设我们只有一个现成的 *.app 来监控）。

**更新：** dtrace 可以监视 exec 调用并打印调用的命令的名称。这是解决方案的一半，另一半是获取它的命令行参数。这还没有解决（直到有人确认他们有 dtrace 来做这件事）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-10-11T19:07:10.047

DTrace 可以完成这项工作。根据我在此问题其他地方的评论中与 Joey Hagedorn 的讨论，可以改进 10.6 附带的脚本以使用合理数量的参数（50+）。因为该脚本有很多重复，我将在此处包含一个脚本，该脚本输出运行良好的 DTrace 脚本。这个最多可以处理 50 个参数；您可能希望通过更改 for 循环来扩展参数的数量。

```
#!/bin/bash

cat <<HEADER
#!/usr/sbin/dtrace -s
/*
 * newproc.d - snoop new processes as they are executed. DTrace OneLiner.
 *
 * This is a DTrace OneLiner from the DTraceToolkit.
 *
 * 15-May-2005  Brendan Gregg   Created this.
 */

/*
 * Updated to capture arguments in OS X. Unfortunately this isn't straight forward...
 */

#pragma D option quiet

this unsigned long long argv_ptr; /* Wide enough for 64 bit user procs */

proc:::exec-success
{
    print_pid[pid] = 1; /* This pid emerged from an exec, make a note of that. */
}

/*
 * The "this" variables are local to (all) of the following syscall::mmap:return probes,
 * and only those probes. They must be initialized before use in each new firing.
 */
syscall::mmap:return
{
    this->argc = 0; /* Disable argument collection until we notice an exec-success */
}

syscall::mmap:return
/ print_pid[pid] /
{
    print_pid[pid] = 0;

    this->is64Bit = curpsinfo->pr_dmodel == PR_MODEL_ILP32 ? 0 : 1;
    this->wordsize = this->is64Bit ? 8 : 4;

    this->argc = curpsinfo->pr_argc; 
    this->argc = (this->argc < 0) ? 0 : this->argc; /* Safety */

    this->argv_ptr = curpsinfo->pr_argv;

    printf("%d %s ", pid, this->is64Bit ? "64b" : "32b");
}

HEADER

for ((i=0;i<50;++i)); do

cat <<REPEAT
syscall::mmap:return
/ this->argc /
{
    this->here_argv = copyin(this->argv_ptr, this->wordsize);
    this->arg = this->is64Bit ? *(unsigned long long*)(this->here_argv) : *(unsigned long*)(this->here_argv);
    printf("%s ", copyinstr(this->arg));
    this->argv_ptr += this->wordsize;
    this->argc--;
}

REPEAT
done

cat <<FOOTER
syscall::mmap:return
/ this->argv_ptr /
{
    printf("%s\n", this->argc > 0 ? "(...)" : "");
    this->argc = 0;
    this->argv_ptr = 0;
}
FOOTER 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-26T21:16:18.430

`newproc.d`是另一个 dtrace 脚本，**它**也将进程的命令行参数输出到进程名称。运行它很简单：

```
sudo newproc.d 
```

这适用于我在 OS X Mountain Lion 上。旧版本可能存在各种问题；有关 Leopard 和 Snow Leopard 上 newproc.d 的一些讨论，请参阅[此ServerFault 答案的评论线程。](https://serverfault.com/a/204221/107840)

此外，您应该注意一些小的限制。如果你看一下脚本的源代码，它表明它不会显示超过 5 个参数，并且不会显示长度超过 128 个字符的参数：

```
/*
 * Updated to capture arguments in OS X. Unfortunately this isn't straight forward... nor inexpensive ...
 * Bound the size of copyinstr()'s and printf incrementally to prevent "out of scratch space errors"
 * print "(...)" if the length of an argument exceeds COPYINSTRLIMIT.
 * print "<...>" if argc exceeds 5.
 */

inline int COPYINSTRLIMIT = 128; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T22:47:55.520

您可以使用 dtrace 监视 exec*() 系统调用并在调用它们时显示参数。dtrace 记录在这里： [https ://wikis.oracle.com/display/DTrace/Documentation](https://wikis.oracle.com/display/DTrace/Documentation)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T01:21:44.023

Graham：dtrace 在这里会很完美。您（或这里的任何其他人）能否显示一个打印进程命令行的 dtrace 脚本？

这个 oneliner 打印正在执行的进程的名称：

```
dtrace -qn 'syscall::exec*:return { printf("%Y %s\n",walltimestamp,curpsinfo->pr_psargs); }' 
```

但是如何获取/打印他们的命令行参数呢？

# git - 追溯 svn 导入到 git

> ID：459501
> 
> 赞同：10
> 
> 时间：2009-01-19T22:46:44.913
> 
> 标签：git, svn, history

这是我的问题：

1.  我使用了一段时间的 Subversion，直到我切换到 Git。又过了一段时间。
2.  没有将历史从 Subversion 导入到 Git。这是一个严格的结帐，删除 .svn 目录，然后是 git init。不是明智之举。
3.  现在，在数千次 git 提交之后，我找到了第一次 git 提交时创建的 Subversion 存储库的备份。啊哈！

我想将 git repo 回滚到第 0 天，正确导入 svn repo，然后重新应用所有 git 更改，从而更正第一次未完成的操作。

有没有人尝试过这个？我该怎么做呢？这听起来像是所有变基之母。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-19T23:39:40.033

听起来像是 git 移植的工作。这方面的文档有点粗略，但基本上你想要做的是：

1.  在您的 repo 中获取 svn 的 git-svn 副本。最简单的方法是 git svn clone in，然后在现有存储库中获取 svn clone
2.  找出哪个基本提交应该遵循 svn 提交。所以你可能在某个地方有一个 git root（“最后一个 SVN 版本”），它应该遵循最后一个实际的 SVN 版本。这是你刚刚获取的 git-svn clone 的头部
3.  创建一个文件 .git/info/grafts 并将两个 sha 放在一行中。第一个是第一个 git 提交，然后是一个空格，然后是最后一个 svn 提交。这告诉 git git commit 不是没有父级的，但实际上有最后一个 svn 提交作为父级。
4.  您现在可以使用 gitk/gitx/whatever 检查两个存储库是否已连接
5.  要使更改永久化，请运行 git filter-branch。您可能需要先阅读它的联机帮助页。

当然，您也可以为所有分支执行第 3 步。jpalecek 方法的问题是变基会使你的历史变平，所以如果你有任何合并，变基会丢失它们。filter-branch 方法使您的历史记录完好无损。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T23:18:47.423

我从来没有尝试过你想要的，但我正在用 CVS 做类似的事情。

基本上，我建议：

1.  使用来自 svn 的历史创建一个新的 git 存储库
2.  在这个新存储库中，`git fetch`来自 git 存储库的所有内容（不会有共同的提交）
3.  然后，`git branch remote/branch branch-last`和`git rebase --onto svn-last remote/branch-first branch-last`，`remote/branch-first`您导入的 git 存储库的第一次提交在哪里，等等。

如果你有更多的分支，事情就会更复杂。我认为重复第 3 步可能会，但你最好自己尝试一下。如果你的 git 历史中有合并，你可能需要`git rebase -i -p ...`. 请记住，git 的优点是您基本上不会搞砸任何事情（尤其是如果您在单独的存储库中工作）。

# c++ - 如何在我的 C++ 代码中避免 dynamic_cast？

> ID：459503
> 
> 赞同：18
> 
> 时间：2009-01-19T22:47:09.267
> 
> 标签：c++, oop, inheritance, dynamic-cast, car-analogy

假设我有以下类结构：

```
class Car;
class FooCar : public Car;
class BarCar : public Car;

class Engine;
class FooEngine : public Engine;
class BarEngine : public Engine; 
```

让我们也给它`Car`一个句柄`Engine`。A`FooCar`将由 a 创建，`FooEngine*`a`BarCar`将由 a 创建`BarEngine*`。有没有办法安排事情，以便`FooCar`对象可以调用成员函数而`FooEngine`无需向下转换？

这就是为什么类结构按现在的方式布局的原因：

1.  所有`Car`s 都有一个`Engine`. 此外， a`FooCar`只会使用 a `FooEngine`。
2.  所有`Engine`s 共享的数据和算法我宁愿不复制和粘贴。
3.  我可能想编写一个需要`Engine`知道它的函数`Car`。

在编写这段代码时，我一打字`dynamic_cast`就知道我可能做错了什么。有一个更好的方法吗？

更新：

根据目前给出的答案，我倾向于两种可能性：

1.  已经`Car`提供了一个纯虚`getEngine()`函数。这将允许`FooCar`并`BarCar`拥有返回正确类型的`Engine`.
2.  `Engine`将所有功能吸收到`Car`继承树中。 `Engine`出于维护原因（将这些`Engine`东西保存在一个单独的地方）。这是拥有更多小类（小代码行）与拥有更少大类之间的权衡。

社区是否对其中一种解决方案有强烈的偏好？有没有我没有考虑过的第三种选择？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-19T22:58:32.613

我假设 Car 拥有一个 Engine 指针，这就是你发现自己垂头丧气的原因。

将指针从基类中取出，并将其替换为纯虚拟 get_engine() 函数。然后您的 FooCar 和 BarCar 可以保存指向正确引擎类型的指针。

**（编辑）**

为什么这样有效：

由于虚函数`Car::get_engine()`将返回一个**引用或一个指针**，C++ 将允许派生类以**不同的返回类型**来实现这个函数，只要返回类型的区别仅在于是一个更派生的类型。

这称为[协变返回类型](http://en.wikipedia.org/wiki/Covariant_return_type)，并且将允许每种`Car`类型返回正确的`Engine`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-19T22:57:28.247

我只想补充一件事：这个设计对我来说已经很糟糕了，因为我称之为**平行树**。

基本上，如果您最终得到并行的类层次结构（就像 Car 和 Engine 一样），那么您只是在自找麻烦。

我会重新考虑引擎（甚至汽车）是否需要有子类，或者这些子类都只是相同各自基类的不同实例。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-20T01:37:16.567

您还可以将引擎类型模板化如下

```
template<class EngineType>
class Car
{
    protected:
        EngineType* getEngine() {return pEngine;}
    private:
        EngineType* pEngine;
};

class FooCar : public Car<FooEngine>

class BarCar : public Car<BarEngine> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T23:06:55.903

我不明白为什么汽车不能由引擎组成（如果 BarCar 将始终包含 BarEngine）。发动机与汽车的关系非常密切。我会选择：

```
class BarCar:public Car
{
   //.....
   private:
     BarEngine engine;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T22:49:55.767

FooCar 可以使用 BarEngine 吗？

如果没有，您可能希望使用 AbstractFactory 来创建正确的汽车对象和正确的引擎。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T23:02:47.067

您可以将 FooEngine 存储在 FooCar 中，将 BarEngine 存储在 BarCar 中

```
class Car {
public:
  ...
  virtual Engine* getEngine() = 0;
  // maybe add const-variant
};

class FooCar : public Car
{
  FooEngine* engine;
public:
  FooCar(FooEngine* e) : engine(e) {}
  FooEngine* getEngine() { return engine; }
};

// BarCar similarly 
```

这种方法的问题是获取引擎是一个虚拟调用（如果您担心的话），并且*设置*引擎的方法`Car`需要向下转换。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T03:35:54.940

我认为这取决于是否`Engine`仅`Car`由其子对象私人使用，或者您是否还想在其他对象中使用它。

如果`Engine`功能不是特定于`Car`s 的，我会使用`virtual Engine* getEngine()`方法而不是在基类中保留指针。

如果它的逻辑是特定于`Car`s 的，我更愿意将公共`Engine`数据/逻辑放在一个单独的对象中（不一定是多态的），并在它们各自的子类中保留`FooEngine`和实现。`BarEngine``Car`

当实现循环比接口继承更需要时，对象组合通常提供更大的灵活性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T04:24:23.267

微软的 COM 有点笨拙，但它确实有一个新颖的概念——如果你有一个指向对象接口的指针，你可以使用[QueryInterface](http://msdn.microsoft.com/en-us/library/ms682521(VS.85).aspx)函数查询它是否支持任何其他接口。这个想法是将您的 Engine 类分解为多个接口，以便每个接口都可以独立使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-19T22:54:20.733

允许我没有错过任何东西，这应该是微不足道的。

最好的方法是在 Engine 中创建纯虚函数，然后在要实例化的派生类中需要这些函数。

一个额外的解决方案可能是拥有一个名为 IEngine 的接口，您可以将其传递给您的 Car，并且 IEngine 中的每个功能都是纯虚拟的。你可以有一个'BaseEngine'来实现你想要的一些功能（即'shared'），然后有叶子的。

如果您想要“看起来”像引擎的东西，但可能不是（即模拟测试类等），界面会很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-19T22:56:09.310

> 有没有办法安排事情，以便 FooCar 对象可以调用 FooEngine 的成员函数而无需向下转换？

像这样：

```
class Car
{
  Engine* m_engine;
protected:
  Car(Engine* engine)
  : m_engine(engine)
  {}
};

class FooCar : public Car
{
  FooEngine* m_fooEngine;
public:
  FooCar(FooEngine* fooEngine)
  : base(fooEngine)
  , m_fooEngine(fooEngine)
  {}
}; 
```

# loops - 嵌套循环/循环控制教程

> ID：459508
> 
> 赞同：4
> 
> 时间：2009-01-19T22:49:46.717
> 
> 标签：loops

我正在寻找关于编写和设计循环的好教程。我了解循环的基础知识，但嵌套循环给我带来了很多麻烦。为了给你和想法，下面的模式对我来说有点难以理解。

1
12
123
1234
12345
123456

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T23:17:07.490

**循环**

循环是一种使一组指令能够多次执行的结构。有几种循环结构：

*零个或多个*

这些循环在迭代开始时进行检查，因此将执行 0 次或更多次。while 循环就是一个例子。

*一个或多个*

这些循环在迭代结束时进行检查，因此将至少执行一次。do while 循环就是一个例子。

*带计数器的循环*

这些循环有一个计数器，可以从某个数字计数到另一个数字。该数字可以在循环内使用（例如访问数组的字段）。

*带有迭代器的循环*

这些循环使用迭代器来循环某个结构。

*无尽的循环*

这些循环没有尽头。但是当然没有什么是永远的，所以循环通常包含一个隐藏的机制。

**嵌套循环**

如果您了解单循环，嵌套循环可能会很困难。但是您需要一次专注于一个循环。让我们举个例子：

```
1
12
123
1234
12345
123456 
```

好的，让我们先看看线条。

*   第一行有一个 1
*   第二行从 1 数到 2
*   第三行从 1 数到 3
*   ...

通常：第 n 行从 1 到 n 计数。

太好了，不，我们有单独的线路。但是现在让我们看看所有的行。

*   第一个有 n=1
*   第二个有 n=2
*   第三个有 n=3
*   ...

嗯，所以我们可以使用外循环的循环计数器作为内循环的n：

```
for n = 1 to 6
  s = ''
  for i = 1 to n // use the loopcounter of the outer loop
    s = s + char(i)
  end for
  out s
end for 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T23:10:22.137

查看：

*   [http://mathbits.com/mathbits/compsci/looping/nested.htm](http://mathbits.com/mathbits/compsci/looping/nested.htm)
*   [http://tldp.org/LDP/abs/html/nestedloops.html](http://tldp.org/LDP/abs/html/nestedloops.html)
*   [http://www.actionscript.org/resources/articles/5/1/The-power-of-nested-loops/Page1.html](http://www.actionscript.org/resources/articles/5/1/The-power-of-nested-loops/Page1.html)

在一般（语言中立）术语中，基本逻辑非常简单。更复杂的地方是内部循环是否提前终止以及中断的方式。它可能会导致外循环移动到下一个值，或者它也可能完全退出外循环。

学习这一点的最好方法是尝试不同的情况以查看它们的行为，并阅读退出循环的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T23:18:16.537

这些怎么样：

[嵌套循环](http://mathbits.com/mathbits/compsci/looping/nested.htm)

[嵌套循环的力量](http://www.actionscript.org/resources/articles/5/1/The-power-of-nested-loops/Page1.html)

或在 YouTube 上[http://www.youtube.com/watch?v=SmDZaH855qE](http://www.youtube.com/watch?v=SmDZaH855qE)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T22:52:59.130

我不记得在学习编程时看过任何以“循环设计”为中心的教程。如果您刚开始处理不同的问题和算法，您将掌握循环。寻找矩阵问题，例如，您将需要嵌套循环......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T22:53:18.363

我不知道有任何关于这个主题的教程，但我建议你试试谷歌。此外，您能够弄清楚您的示例这一事实可能意味着您不需要教程，而是需要练习。当您第一次遇到嵌套循环时，它们有些令人费解。您可能还想查找与*recursion*相关的参考/教程，这是一个相关概念。记住，熟能生巧！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T22:53:50.080

查看[麻省理工学院课程资料](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/index.htm)。还可以考虑[订阅 Safari](http://my.safaribooksonline.com/)，这是一种获得一些好的学习书籍的廉价方式。

这个[MIT 课程](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-00Fall-2007/Readings/index.htm)指向[Python wiki 上的 Loops](http://en.wikibooks.org/wiki/Python_Programming/Loops)。

我发现在纸上解决它，列出变量有助于了解它是如何工作的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-29T20:30:54.700

```
declare
s varchar2(10);
begin
  for n in 1..5 loop
    s:='';
    for i in 1..n loop
      s:=s||(i);
    end loop;
    dbms_output.put_line(s);
  end loop;
end; 
```

# excel - 为什么我不能将 Application.ReplaceFormat.NumberFormat 设置为某些有效格式？

> ID：459524
> 
> 赞同：3
> 
> 时间：2009-01-19T22:54:57.083
> 
> 标签：excel, excel-2003, vba

我正在尝试使用 Excel 宏重新格式化使用 OLE-Automation 导出的电子表格

以下代码可以正常工作：

```
Application.FindFormat.NumberFormat = "#,##0.0000000"
Application.ReplaceFormat.NumberFormat = "#,##0.00"
Cells.Replace What:="", Replacement:="", LookAt:=xlPart, SearchOrder:= _
    xlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True 
```

如果我将 ReplaceFormat 更改为

```
Application.ReplaceFormat.NumberFormat = "#,##0.0" 
```

要仅显示 1 位小数，我收到错误 1004（应用程序定义或对象定义错误）。“0.0”也失败了。

我可以将单元格格式（Cells.NumberFormat）设置为“#,##0.0”

我只对 Excel-2003 进行了尝试，因为它是我唯一可用的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T04:09:30.490

我找到了部分答案。为此，NumberFormat 必须已存在于工作簿中。

一种解决方法是将单元格的格式设置为“#,##0.0”，然后进行替换：

```
Worksheets("Sheet1").Range("A1").NumberFormat = "#,##0.0" 
Application.FindFormat.NumberFormat = "#,##0.0000000"
Application.ReplaceFormat.NumberFormat = "#,##0.00"
Cells.Replace What:="", Replacement:="", LookAt:=xlPart, SearchOrder:= _
    xlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True 
```

似乎没有任何集合可以让我使用自定义数字格式（[无论如何根据这个网站](http://members.optushome.com.au/anandasim/excel.htm)）。

我在将 Application.FindFormat 设置为新格式​​时发现了这一点，开始抛出错误！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-02T13:18:59.847

> 运行时错误“1004”：应用程序定义的或对象定义的错误

为避免此错误，您必须至少拥有一次同时使用两种格式的现有单元格。我有列名的第一行，因此它们只有字符串值，并且将前两个列名设置为 dateformat 不会对我的工作表数据产生任何明显影响。

```
Sub datum_popravak_rucno()
    ' add find format to cell A1
    ActiveSheet.Range("A1").NumberFormat = "m/d/yyyy"
    ' add replace format to cell B1
    ActiveSheet.Range("B1").NumberFormat = "yyyy-mm-dd hh:mm:ss"
    ' define find format
    Application.FindFormat.NumberFormat = "m/d/yyyy"
    ' define replace format
    Application.ReplaceFormat.NumberFormat = "yyyy-mm-dd hh:mm:ss"
    ' do replace on all cells
    Cells.Replace What:="", Replacement:="", LookAt:=xlPart, SearchOrder:= _
        xlByColumns, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True
End Sub 
```

适用于 Excel 2003、2007、2010！

# objective-c - Objective-C 错误：初始化元素不是常量

> ID：459530
> 
> 赞同：10
> 
> 时间：2009-01-19T22:57:08.670
> 
> 标签：objective-c

为什么编译器在提供的代码上给我以下错误消息：“初始化元素不是常量”。对应的 C/C++ 代码在 gcc 下完美编译。

```
#import <Foundation/Foundation.h>

const float a = 1;
const float b = a + a; // <- error here

int main (int argc, const char * argv[]) {
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    // insert code here...
    NSLog(@"Hello, World!");
    [pool drain];
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T23:27:23.087

`const float`只有当语句出现在文件范围之外的某个地方时，该代码才能正确编译。

显然，它是标准的一部分。重要的是，所有文件范围声明的变量都使用常量表达式初始化，而不是涉及常量变量的表达式。

您正在使用另一个对象的值初始化浮点“b”。任何对象的值，即使它是 const 限定的，也不是 C 中的常量表达式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-30T02:37:25.840

*@dreamlax* is correct, you can't have a const declaration whose initialization depends upon another (const) variable. If you need one to depend on the other, I suggest creating a variable that you can treat as a constant and initialize it only once. See these SO questions for details:

*   [Defining a constant in objective-c](https://stackoverflow.com/questions/1059708/)
*   [Constants in Objective C](https://stackoverflow.com/questions/538996/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T23:27:27.937

我的机器上没有 Xcode，所以我无法尝试我的示例，

但是你能试试吗

```
#define A (1) 
#define B (A + A)

const float a = A;
const float b = B; 
```

# c - 在 Mac OS X 上清除缓冲区缓存

> ID：459537
> 
> 赞同：15
> 
> 时间：2009-01-19T22:58:58.947
> 
> 标签：c, macos, purge

有没有办法以编程方式清除 Mac 上的缓冲区缓存，最好是在 C 中？

基本上，我正在寻找相当于 10.5（及更高版本）`purge`命令的来源。**编辑：**我现在看到这是 CHUD 工具的一部分，它的源似乎不是直接可用的。但是，我仍在寻找一些代码来做同样的事情。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-07T19:29:35.270

我已经`_utilPurgeDiskBuffers`从 CHUD 框架中反汇编了有问题的函数 ( )。该函数似乎不是很复杂，但由于我不是 MacOS 程序员，因此导入和调用的 sys API 对我来说没有多大意义。

API 做的第一件事是调用另一个函数，即`_miscUtilsUserClientConnect_internal`. 这个函数似乎建立了与 CHUD 内核扩展的连接。
为此，它调用which 尝试通过使用从 I/O 工具包导入的`_getCHUDUtilsKextService`所有 kext 枚举所有 kext 来定位 CHUD 内核扩展。`IORegistryCreateIterator`找到 kext 后，通过`_IOServiceOpen`.

在这一点上，我们与 CHUD kext 建立了连接（至少这是我从反汇编列表中的理解）。

最后打了一个电话`IOConnectMethodStructureIStructureO`，我猜这实现了真正的魔力。
在不知道一些内部细节或这个函数的签名的情况下，参数对我来说没有意义。

不过，这是反汇编：

```
__text:4B0157A7 lea     eax, [ebp+var_1C]
__text:4B0157AA mov     dword ptr [esp+14h], 0
__text:4B0157B2 mov     [esp+10h], eax
__text:4B0157B6 mov     [esp+0Ch], eax
__text:4B0157BA mov     dword ptr [esp+8], 0
__text:4B0157C2 mov     dword ptr [esp+4], 0Eh
__text:4B0157CA mov     [esp], edx
__text:4B0157CD call    _IOConnectMethodStructureIStr 
```

请注意，`var_1C`之前已归零。

希望你们中的一些人能从这些系统调用中理解更多。如果您想了解更多信息，请告诉我。

**更新：**
为了让您开始，只需以`AppleSamplePCIClient.c`IO 套件 SDK 中的示例为例。这基本上完成了 CHUD 工具中的清除应用程序所做的事情。
您唯一需要更改的是最终`_IOConnectMethodStructureIStr`调用的参数。从上面的反汇编列表中获取它们。因为我没有 Mac，所以我无法测试所有这些东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-07T18:32:23.933

看起来：

> 您可以使用 usr/bin/purge（在终端中键入 purge）来刷新磁盘缓存（非活动内存），**或者您可以从硬盘执行许多随机读取来执行相同的操作**。

取自用户[guns](http://www.tuaw.com/profile/1791466/)的[评论](http://www.tuaw.com/2008/02/21/ifreemem-2-0-when-you-just-dont-feel-like-rebooting/2)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-07T18:20:52.910

您是否对关闭文件的缓存不感兴趣？根据您要实现的目标，它可能是另一种选择。[很好的总结在这里](http://www.wagerlabs.com/blog/2008/03/hacking-the-uni.html)。

> UBC 可以通过运行“清除”来清除，它分配大量内存以强制清除缓存。
> 
> ```
> fcntl(fd, F_GLOBAL_NOCACHE, 1) 
> ```
> 
> 可用于关闭特定文件的缓存。这可以在任何进程中完成，之后可以关闭文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T23:13:06.610

您可以`sync(2)`多次使用（如众所周知的成语`sync; sync; sync`）。我似乎找不到源代码，但它可能只是[10.5.6 代码中](http://www.opensource.apple.com/darwinsource/10.5.6/)`purge`可用的 man 包的一部分

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-06T02:16:09.070

当您没有想要模拟的工具的源代码时（就像这里的情况），有很多方法可以解决它。

1/ 从您的 C 代码中，只需通过`system()`函数调用来调用该工具。只要没有可见的效果（例如打开图形窗口），它就可以很好地工作。例如，您可以使用`system("/path/to/purge -purgargs >/dev/null 2>&1");`。

2/ 对代码进行逆向工程，看看它实际上是如何做的。这有点棘手，因为它需要了解汇编语言、系统调用和许多其他知识。

3/ 联系开发人员以获取有关如何完成的提示。这不一定是“将代码发送给我，这样我就可以撕掉它并赚钱”的问题。您可以将其表述为“我有兴趣使用 purge 进行开发，但我不确定它到底是做什么的”或“我在运行代码时遇到了安全问题，除非我们知道，否则权力不会让我运行它正是它的作用”。然后你编写你的代码来做同样的事情。

我，如果可能的话，我只会使用选项 1（我天生就是懒惰的 :-)。如果您要编写一个与 purge 竞争的工具（鉴于它是免费的，这将很难），选项 2 可能是最好的选择。

# visual-studio - VisualStudio 的“SVN Blame”插件

> ID：459538
> 
> 赞同：17
> 
> 时间：2009-01-19T22:59:54.997
> 
> 标签：visual-studio, svn, plugins

我发现[了这个](https://stackoverflow.com/questions/423687)问题，但引用的选项没有说明支持“责备”。我正在寻找的是一种综合方式来询问“谁最后编辑了光标下的行？”。

我知道大多数/所有 SVN 客户都以某种形式提供此信息，但我想要一些能让我一时兴起的事情变得足够简单：“嗯，这是谁写的？[点击]哦，他。”

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-20T01:29:48.127

AnkhSVN 2.0 的每日构建具有受 TFS 注释功能启发的全新注释（责备）实现。

[![AnkhSVN 注释预览](https://i.stack.imgur.com/1UBAm.jpg)](https://i.stack.imgur.com/1UBAm.jpg)
[（来源：[qqn.nl](http://b.qqn.nl/f/2009/stackoverflow/20090120-AnkhSVN-Annotate.jpg)）]

在这些屏幕截图中并不真正可见，但它使用 Visual Studio 编辑器进行语法着色等（您可以看到下一张图片右下角的 sizeof() 是蓝色的）。正如您在第二张图片中看到的那样，它还允许在左侧栏中的修订区域上执行多个命令。

它目前没有实现跳转到活动行。但是您可以在其中使用 Visual Studio goto line (Ctrl+G) 命令。（您可能可以在宏中编写脚本）

开始注释的最简单方法是右键单击编辑器->Subversion->Annotate。

[![AnkhSVN 注释命令](https://i.stack.imgur.com/9QXBD.jpg)](https://i.stack.imgur.com/9QXBD.jpg)
[（来源：[qqn.nl](http://b.qqn.nl/f/2009/stackoverflow/20090120-AnkhSVN-Annotate-Detail.jpg)）]

[2009-02-03 更新：此功能现在在新的稳定版本中普遍可用]

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-19T23:15:55.230

我编写了一个 Visual Studio 宏来获取行号信息并将其传递给 tortoiseproc.exe（它是 TortoiseSVN 的一部分）

看一下参数信息： [http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-automation.html)

这是我的宏：

```
 Sub Blame()
  sCurrFileFull = DTE.ActiveDocument.FullName
  Dim activeDoc As Document
  activeDoc = DTE.ActiveDocument
  Dim nLine As Integer
  nLine = activeDoc.Selection.CurrentLine

  sShellCommand = sTorEXE & " /command:blame /startrev:1 /endrev:-1 /path:""" &
                   sCurrFileFull & """ /notempfile /line:" & nLine.ToString()
  Shell(sShellCommand, AppWinStyle.MaximizedFocus, False)
End Sub 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-19T23:13:06.233

我使用一组连接到 TortoiseProc.exe 的外部工具来执行 SVN 操作，如日志、差异、责备、还原、提交、更新等。然后我为这些外部工具创建工具栏快捷方式，以便我可以访问所有基本的 SVN 操作在 IDE 中。

以下是创建一个按钮来对当前文件进行责备的步骤：

1.  转到工具 -> 外部工具，然后单击“添加”
2.  输入您想要的任何标题（例如“Blame”）
3.  对于命令，输入以下内容（如果您将 TortoiseSVN 安装到不同的目录，路径会有所不同）：`c:\Program Files\TortoiseSVN\bin\TortoiseProc.exe`
4.  对于参数，输入以下内容：`/command:blame /path:"$(ItemPath)" /notempfile`
5.  对于初始目录，输入：`$(ItemDir)`

现在，每当您打开文件时，只需转到工具 -> Blame，它应该会在弹出窗口中生成 Blame。您还可以自定义工具栏并为此外部工具创建快捷方式，以使其更加轻松。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T23:03:47.610

在 VisualSVN 中某种程度上支持责备——你可以右键单击一个文件并选择“责备”。但是，它会弹出一个新窗口，它可能不像您想要的那样集成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-25T13:00:36.797

这是[crashmstr](https://stackoverflow.com/users/1441/crashmstr)和[Derek Dahmer](https://stackoverflow.com/users/86024/derek-dahmer)的[宏代码](https://stackoverflow.com/questions/459538/svn-blame-plugin-for-visualstudio/#459569)的工作版本：

```
Sub Blame()
    Dim sCurrFileFull = DTE.ActiveDocument.FullName
    Dim activeDoc = DTE.ActiveDocument
    Dim nLine = activeDoc.Selection.CurrentLine
    Dim sTorEXE = "TortoiseProc.exe"
    ' Add path if you don't have TortoiseSVN on your PATH
    Dim sShellCommand = sTorEXE & " /command:blame /startrev:1 /endrev:-1 /path:""" & sCurrFileFull & """ /notempfile /line:" & nLine.ToString()
    Shell(sShellCommand, AppWinStyle.MaximizedFocus, False)
End Sub 
```

按照[Derek Dahmer](https://stackoverflow.com/users/86024/derek-dahmer)的说明，使用`Tools > Macros > Macro IDE`.

为了方便访问，我将宏添加到我的代码窗口上下文菜单中：

```
Customize > Commands > Context menu > Editor Context Menus | Code Window
Add Command > Macros > Find your macro
Modify Selection > Name: Bla&me 
```

将它放在上下文菜单中可以轻松访问键盘，但您当然也可以为其添加键盘快捷键。我在 Ctrl-Shift-M 上有它，默认情况下它不被任何有用的东西使用:)。

# database-design - 设计用于估算项目投标的工具

> ID：459539
> 
> 赞同：2
> 
> 时间：2009-01-19T23:00:10.923
> 
> 标签：database-design

该工具将用于为客户估算项目成本。这些不一定是软件项目。目前有一个包含多个类别的 Excel 电子表格，每个类别都有单独的任务。其中每一个都涉及某种权重或常数，并部分负责确定最终的出价估算。这些任务中的每一个都有设置时间、设置成本、运行时间和成本等属性。目前没有严格定义的投标方法。

对于每个新的投标，都会制作并修改电子表格的副本，以最准确地描述我们认为该项目的成本和时间。

工具要求：

*   需要能够添加新的类别/任务
*   需要能够保存出价并在必要时调用它
*   需要能够修改当前的权重/常数

目前我可以很容易地设计一个数据库模式和一个 ASP.NET 页面布局来处理这种情况，如果不是因为你可以随时间改变权重/常数。我在想（不是事实）一旦你保存了一个出价，所有的常量/权重/成本都应该以某种方式一起保存。这也带来了显示出价的问题，如果有90个版本的数据运行，我将如何确定如何显示它？

任何想法表示赞赏。

PS：不知道如何标记这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T23:21:41.193

如果您确实想将其扩展为成熟的应用程序，我认为您提出的解决方案很好。我同意您应该保存每次出价的参数。这不是一个真正的问题，可以通过一个默认参数值的“基本”表来实现，该默认参数值可以在每个投标的基础上进行修改。

我会将特定于投标的参数存储在另一个表中（即 BidSettings 或 BidParameters。）通过 Bids 表的外键引用此表中的特定于投标的参数，您就完成了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T00:25:54.747

为了跟踪不断变化的条件，一种方法是实现一个时间数据库来存储数据的完整历史设置。维基百科实际上有我读过的最[简洁的解释之一。](http://en.wikipedia.org/wiki/Temporal_database)

总结这篇文章，假设你有这些 Bid 和 BitT 表：

```
TABLE BidT
   uniqueidentifier Id,
   uniqueidentifier BidId,
   int Version,
   int WeightA,
   int WeightB,
   int WeightC

TABLE Bid
   uniqueidentifier Id,
   int BidNumber,
   ... 
```

在此示例中，未更改或您不需要跟踪的数据保留在 Bid 中。随着时间的推移，您需要跟踪的任何变化都会进入 BidT，T 后缀是 Temporal。这样，您只保留更改内容的副本，而不是复制与每次出价相关的所有数据。

# python - BeautifulSoup 3.1 解析器太容易崩溃了

> ID：459552
> 
> 赞同：4
> 
> 时间：2009-01-19T23:07:02.737
> 
> 标签：python, html, parsing, beautifulsoup

*我在用 BeautifulSoup 解析一些不可靠的 HTML 时遇到了麻烦。结果表明，较新版本中使用的 HTMLParser 比以前使用的 SGMLParser 容错性差。*

* * *

BeautifulSoup 有某种调试模式吗？我正试图弄清楚如何阻止它在我从一个螃蟹网站加载的一些讨厌的 HTML 上运行：

```
<HTML>
    <HEAD>
        <TITLE>Title</TITLE>
        <HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
    </HEAD>
    <BODY>
        ...
        ...
    </BODY>
</HTML> 
```

`<HTTP-EQUIV...>`BeautifulSoup 在标记后放弃

```
In [1]: print BeautifulSoup(c).prettify()
<html>
 <head>
  <title>
   Title
  </title>
 </head>
</html> 
```

问题显然是 HTTP-EQUIV 标签，它确实是一个*非常*畸形的`<META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">`标签。显然，我需要将此指定为自动关闭，但无论我指定什么，我都无法修复它：

```
In [2]: print BeautifulSoup(c,selfClosingTags=['http-equiv',
                            'http-equiv="pragma"']).prettify()
<html>
 <head>
  <title>
   Title
  </title>
 </head>
</html> 
```

是否有一个详细的调试模式，BeautifulSoup 会告诉我它在做什么，所以我可以弄清楚在这种情况下它把什么当作标签名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T13:20:25.427

[Beautiful Soup 3.1.0 有问题吗？](http://www.crummy.com/software/BeautifulSoup/3.1-problems.html)建议使用[html5lib](http://code.google.com/p/html5lib/)的解析器作为解决方法之一。

```
#!/usr/bin/env python
from html5lib import HTMLParser, treebuilders

parser = HTMLParser(tree=treebuilders.getTreeBuilder("beautifulsoup"))

c = """<HTML>
    <HEAD>
        <TITLE>Title</TITLE>
        <HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
    </HEAD>
    <BODY>
        ...
        ...
    </BODY>
</HTML>"""

soup = parser.parse(c)
print soup.prettify() 
```

输出：

```
<html>
 <head>
  <title>
   Title
  </title>
 </head>
 <body>
  <http-equiv="pragma" content="NO-CACHE">
   ...
        ...
  </http-equiv="pragma">
 </body>
</html> 
```

输出显示 html5lib 在这种情况下并没有解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-03T15:40:41.023

尝试[lxml](http://codespeak.net/lxml/)（及其 html 模块）。尽管它的名字，它也用于解析和抓取 HTML。它比 BeautifulSoup 快得多，它甚至比 BeautifulSoup 更好地处理“损坏”的 HTML。如果您不想学习 lxml API，它也有适用于 BeautifulSoup 的兼容性 API。

[Ian Blicking 同意](http://blog.ianbicking.org/2008/12/10/lxml-an-underappreciated-web-scraping-library/)。

没有理由再使用 BeautifulSoup，除非您使用的是 Google App Engine 或其他任何不纯 Python 的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T23:40:08.300

你的问题一定是别的；这对我来说可以：

```
In [1]: import BeautifulSoup

In [2]: c = """<HTML>
   ...:     <HEAD>
   ...:         <TITLE>Title</TITLE>
   ...:         <HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
   ...:     </HEAD>
   ...:     <BODY>
   ...:         ...
   ...:         ...
   ...:     </BODY>
   ...: </HTML>
   ...: """

In [3]: print BeautifulSoup.BeautifulSoup(c).prettify()
<html>
 <head>
  <title>
   Title
  </title>
  <http-equiv>
  </http-equiv>
 </head>
 <body>
  ...
        ...
 </body>
</html>

In [4]: 
```

这是带有 BeautifulSoup 3.0.7a 的 Python 2.5.2 — 也许在旧/新版本中有所不同？这正是 BeautifulSoup 处理得如此漂亮的那种汤，所以我怀疑它是否在某些时候被改变了……你在问题中没有提到的结构还有什么其他的吗？

# delphi - 如何判断我的程序的另一个实例是否已经在运行？

> ID：459554
> 
> 赞同：32
> 
> 时间：2009-01-19T23:07:20.677
> 
> 标签：delphi, persistence, mutex, instance, semaphore

如何判断我的程序的一个实例是否正在运行？我以为我可以用数据文件来做到这一点，但它会很乱:(

我想这样做，因为我只希望在某一时刻打开 1 个实例。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-19T23:20:26.500

正如 Jon 首先建议的那样，您可以尝试创建一个互斥锁。打电话[`CreateMutex`](http://msdn.microsoft.com/en-us/library/ms682411.aspx)。如果你得到一个非空句柄，然后调用[`GetLastError`](http://msdn.microsoft.com/en-us/library/ms679360.aspx). 它会告诉您是否是您创建互斥锁的人，或者互斥锁在 ( `Error_Already_Exists`) 之前是否已经打开。请注意，*不必*获得互斥锁的所有权。互斥锁不用于互斥。它被使用是因为它是一个命名的内核对象。事件或信号量也可以工作。

互斥技术给你一个布尔答案：是的，有另一个实例，或者不，没有。

您经常想知道的不仅仅是这些。例如，您可能想知道另一个实例的主窗口的句柄，以便您可以告诉它在您的另一个实例的位置出现在前台。这就是内存映射文件可以派上用场的地方。它可以保存有关第一个实例的信息，以便以后的实例可以引用它。

选择互斥体的名称时要小心。仔细阅读文档，并记住某些字符（例如反斜杠）在某些操作系统版本中是不允许的，但在其他操作系统版本中某些功能是必需的。

还要记住其他用户的问题。如果您的程序可以通过远程桌面或快速用户切换运行，那么可能有其他用户已经在运行您的程序，您可能并不想限制当前用户运行您的程序。在这种情况下，不要使用全局名称。如果您*确实*想限制所有用户的访问，请确保互斥对象的安全属性使得每个人都能够打开它的句柄。对参数使用空指针`lpSecurityAttributes`是不够的；MSDN 提到的“默认安全描述符”为当前用户提供了完全访问权限，而对其他用户没有访问权限。

您可以编辑程序的 DPR 文件。这通常是做这种事情的好地方。如果您等到`OnCreate`其中一个表单发生事件，那么您的程序已经有一点正常运行的动力，所以在那个时候尝试终止程序是很笨拙的。最好在完成太多 UI 工作之前终止。例如：

```
var
  mutex: THandle;
  mutexName: string;
begin
  mutexName := ConstructMutexName();

  mutex := CreateMutex(nil, False, PChar(mutexName));

  if mutex = 0 then
    RaiseLastOSError; // Couldn't open handle at all.

  if GetLastError = Error_Already_Exists then begin
    // We are not the first instance.
    SendDataToPreviousInstance(...);
    exit;
  end;
  // We are the first instance.

  // Do NOT close the mutex handle here. It must
  // remain open for the duration of your program,
  // or else later instances won't be able to
  // detect this instance.

  Application.Initialize;
  Application.CreateForm(...);
  Application.Run;
end. 
```

存在何时关闭互斥体句柄的问题。您不必关闭它。当您的进程最终终止时（即使它崩溃），操作系统将自动关闭所有未完成的句柄，并且当没有更多句柄打开时，互斥对象将被销毁（从而允许您的程序的另一个实例启动并认为自己成为第一个实例）。

但是你可能还是想关闭句柄。假设您选择实现`SendDataToPreviousInstance`我在代码中提到的功能。如果您想花哨，那么您可以考虑以前的实例已经关闭并且无法接受新数据的情况。然后你不会真的想关闭第二个实例。第一个实例一旦知道它正在关闭就可以关闭互斥锁句柄，实际上成为“跛脚鸭”实例。第二个实例将尝试创建互斥体句柄，成功，并认为自己是真正的第一个实例。前一个实例将不间断地关闭。用于`CloseHandle`关闭互斥锁；例如，从主窗体的`OnClose`事件处理程序或您调用的任何其他位置调用它`Application.Terminate`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-20T08:39:31.520

您可以创建信号量并停止执行（将代码放入您的 *.dpr 文件中）并将正在运行的应用程序带到屏幕上。

```
var
  Semafor: THandle;

begin
  { Don't start twice ... if already running bring this instance to front }
  Semafor := CreateSemaphore(nil, 0, 1, 'MY_APPLICATION_IS_RUNNING');
  if ((Semafor <> 0) and { application is already running }
     (GetLastError = ERROR_ALREADY_EXISTS)) then 
  begin
    RestoreWindow('TMyApplication');
    CloseHandle(Semafor);
    Halt;
  end;

  Application.CreateForm(....);    
  Application.Initialize;
  Application.Run;
  CloseHandle(Semafor);
end; 
```

**编辑**（添加`RestoreWindow`方法）：

这`aFormName`是应用程序中主表单类的名称。

```
procedure RestoreWindow(aFormName: string);
var
  Wnd,
  App: HWND;    
begin
  Wnd := FindWindow(PChar(aFormName), nil);
  if (Wnd <> 0) then 
  begin { Set Window to foreground }
    App := GetWindowLong(Wnd, GWL_HWNDPARENT);
    if IsIconic(App) then 
      ShowWindow(App, SW_RESTORE);

    SetForegroundwindow(App);
  end;
end; 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-01-19T23:18:01.763

[全能的 JVCL](http://jvcl.sourceforge.net/)有一个用于此目的的组件。请参阅“TJvAppInstances”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-19T23:11:19.497

正常的解决方案是创建一个*命名的、系统范围的* **mutex**。

*   如果您设法创建它，那么您就是一个正在运行的应用程序。
*   如果你不这样做，你就知道有一个不同的。

* * *

### 编辑：

我没有提供代码，因为我不了解 Delphi。如果有帮助的话，我可以提供 C# 代码。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-19T23:15:04.093

您创建一个*系统* **互斥体**。

我没有 Delphi 代码，但这里是 C++ 代码：

```
HANDLE Mutex;

const char MutexName[] = "MyUniqueProgramName";

Mutex = OpenMutex(MUTEX_ALL_ACCESS, false, MutexName);

if (Mutex)
     throw Exception("Program is already running.");
else
     Mutex = CreateMutex(NULL, true, MutexName); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T08:02:34.573

我想为[Rob Kennedy 的出色回答](https://stackoverflow.com/questions/459554/how-do-i-tell-if-one-instance-of-my-program-is-running#459587)添加一点（除了最好从他的代码中创建一个函数而不是将所有内容复制到 DPR 文件中。您只需要两个参数，名称互斥量，以及互斥量应该是每个用户还是系统范围的布尔值）。

答案并没有过多考虑互斥体的命名。如果您希望您的程序通过 Inno Setup（可能还有其他安装工具）安装，您应该仔细选择名称，因为互斥锁可用于让安装程序检查应用程序当前是否正在运行，并提醒用户他们应该关闭应用程序的所有实例。**如果您选择允许每个用户使用一个程序实例，您可能还需要创建第二个系统范围的互斥锁，因为该设置可能根本**不需要应用程序的运行实例才能替换文件。用于与 InnoSetup 安装程序同步的名称必须是硬编码的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T23:28:38.357

我想说，您可以采用几种不同的策略。但是最简单的一个（而不是特定于平台的）是您自己建议的那个，即在程序开始时检查是否在一组特定位置创建了锁定文件。如果这个锁文件存在，那么另一个实例已经在运行，如果它不存在，那么没有另一个实例在运行。当您的程序退出时，您将删除锁定文件。

然而，采用这种策略你还有另一个问题，如果你的程序崩溃了怎么办？锁定文件仍然存在，需要处理这种特定情况。

另一种策略是系统范围的互斥锁解决方案，您可以在其中注册您在操作系统中的存在（或者这也可能是自动完成的）。当第二个实例尝试启动时，它会检查是否已经有一个具有特定 ID 的进程处于活动状态。如果它已经存在，则第二个进程选择不启动，并可选择将第一个进程的窗口置于焦点（如果所讨论的进程拥有一个窗口）。

但是，此策略是特定于平台的，并且实施会因平台而异。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-19T23:52:16.310

您可以简单地使用 FindWindow windows api 函数。在delphi窗口的类名与类名相同，可以通过重写CreateParams函数重新定义类名。要检查窗口是否存在，请在创建主窗口之前，在 Application.Initialize 之前添加代码；

```
Program test
var 
  handle :HWND;
begin
  handle := FindWindow('TMySuperApp', nil);

  if IsWindow(handle) then
  begin 
       //app is running
       exit;
  end.

  Application.Initialize;
  Application.CreateForm(TMySuperApp, SuperApp);
  Application.Run;
end; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-23T12:11:11.983

控制应用程序实例的数量：

[http://delphi.about.com/od/windowsshellapi/l/aa100703a.htm](http://delphi.about.com/od/windowsshellapi/l/aa100703a.htm)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-10T16:56:19.243

如果您想同时**停止****执行** 您的应用程序不止一次**（**将代码放入项目的***.dpr 文件**中）。将在第二个应用程序运行后显示一条消息并立即停止它。

 ****```
Forms,
  Unit1 in 'Unit1.pas' {Form1},
// add this units ....
TlHelp32,SysUtils,Windows,Dialogs;

{$R *.res}

function ProcessCount(const ExeName: String): Integer;
var
  ContinueLoop: BOOL;
  FSnapshotHandle: THandle;
  FProcessEntry32: TProcessEntry32;
begin
  FSnapshotHandle:= CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
  FProcessEntry32.dwSize:= SizeOf(FProcessEntry32);
  ContinueLoop:= Process32First(FSnapshotHandle, FProcessEntry32);
  Result:= 0;
  while Integer(ContinueLoop) <> 0 do begin
    if ((UpperCase(ExtractFileName(FProcessEntry32.szExeFile)) =
      UpperCase(ExeName)) or (UpperCase(FProcessEntry32.szExeFile) =
      UpperCase(ExeName))) then Inc(Result);
    ContinueLoop:= Process32Next(FSnapshotHandle, FProcessEntry32);
  end;
  CloseHandle(FSnapshotHandle);
end;

begin
  if ProcessCount(ExtractFileName(Application.ExeName)) > 1 then begin
    MessageDlg('Application is already running!', mtError, [mbOK], 0);
    Application.Terminate;
  end else begin

  Application.Initialize;
  Application.CreateForm(TForm1, Form1);
  Application.Run;
  end;

end. 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T15:13:02.723

见本单元（使用 CreateMutex）： [UiApp](http://romansg.net/index.php?pg=uiapp)

此外，在此页面上，您可以阅读使用不同方法（互斥锁、FindWindows 等）进行这项工作的优缺点。

当检测到这一点时，该单元具有激活应用程序的 previos 实例的解决方案。

我的英语不好，请原谅我。

* * *

Neftalí -Germán Estévez-

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-19T23:37:55.887

过去，我使用套接字来防止多个实例同时运行。如果套接字正在使用中，请不要继续程序，如果可用，则让一切正常运行。

# c# - 在程序集加载时初始化库

> ID：459560
> 
> 赞同：26
> 
> 时间：2009-01-19T23:10:49.030
> 
> 标签：c#, .net, assemblies

我有一个像函数库一样的 .net 库 dll。有一堆静态类型以及静态方法。

我需要运行一些初始化代码来设置库以供使用。

当程序集被加载时，有没有办法确保运行特定的方法？类似于 AppDomain.AssemblyLoad 但从程序集本身自动调用的东西。我在想也许可以使用类似 AssemblyAttribute 的东西？

目前我在静态构造函数中有这个初始化代码，但是由于这是一个有很多入口点的库，所以不能保证会使用这个特定的类型。

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-03-16T14:53:54.327

是的，有——有点。

使用 Einar Egilsson 的[InjectModuleInitializer 提供](https://github.com/einaregilsson/InjectModuleInitializer)的出色的小实用程序。

将此可执行文件作为构建后步骤运行，以创建一个小的 .cctor 函数（模块初始化函数），该函数调用您的不带参数的静态 void 函数。如果编译器让我们能够创建 .cctor() 那就太好了，幸运的是我们很少需要这种能力。

然而，这并不是一个完整的 DllMain 替代品。CLR 仅在程序集中调用任何方法之前调用此 .cctor 函数，而不是在程序集加载时调用。因此，如果您需要在程序集加载时发生某些事情，则需要让加载代码直接调用方法或使用我详细介绍的 hack [https://stackoverflow.com/a/9745422/240845](https://stackoverflow.com/a/9745422/240845)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-01-23T21:21:57.487

仅当您可以控制主执行程序集时，以下解决方案才可能，即它不适合用于分发的独立库

我遇到了类似的问题，并通过使用 Type 参数创建面向程序集的属性“InitializeOnLoad”来解决它。然后，在主可执行文件中，我添加了一个简单的 AppDomain.AssemblyLoaded 处理程序，它扫描新加载的程序集以查找上述属性并在它们上调用 System.Runtime.CompilerServices.RuntimeHelpers.RunClassConstructor()。

```
[AttributeUsage(AttributeTargets.Assembly, AllowMultiple = true)]
public class InitializeOnLoadAttribute : Attribute
{
    Type type;

    public InitializeOnLoadAttribute(Type type) { this.type = type; }

    public Type Type { get { return type; } }
}

// somewhere very early in main exe initialization
AppDomain.CurrentDomain.AssemblyLoad += new AssemblyLoadEventHandler(AssemblyInitializer);

static void AssemblyInitializer(object sender, AssemblyLoadEventArgs args)
{
    // force static constructors in types specified by InitializeOnLoad
    foreach (InitializeOnLoadAttribute attr in args.LoadedAssembly.GetCustomAttributes(typeof(InitializeOnLoadAttribute), false))
        System.Runtime.CompilerServices.RuntimeHelpers.RunClassConstructor(attr.Type.TypeHandle);
} 
```

另外，如果您担心在您挂钩 AssemblyLoad 事件之前可能已经加载了程序集，您可以简单地运行 AppDomain.GetAssemblies() 并为它们调用“初始化程序”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-19T23:13:46.077

为什么您需要在使用*任何*数据之前加载所有数据，而不是仅在使用需要它的第一种类型时加载？

我不相信有任何方法可以从程序集中强制在程序集负载上运行方法。*您可以在每种*类型中放置一个静态构造函数，但坦率地说，我认为拥有一个表示该数据并提供对它的访问的单一类型更有意义 - 并且仅在该类型上放置一个静态构造函数。（如果您有可以独立使用的单独数据位，也许可以为它们创建单独的类型。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-02T18:41:37.640

这是可能的 - 只需向`<Module>`类添加一个静态构造函数。我不知道如何在没有 IL 修改的情况下完成此操作。

# c# - 如何使用 ADO.NET 获取表中列的 SqlDbType？

> ID：459572
> 
> 赞同：8
> 
> 时间：2009-01-19T23:16:01.347
> 
> 标签：c#, .net, sql-server, ado.net

我试图在运行时确定 sql server 表列的 SqlDbType 是什么。

System.Data.SqlClient 中是否有可以做到这一点的类，或者我应该自己进行映射？我可以从

```
SELECT DATA_TYPE, CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
   WHERE TABLE_CATALOG = '{0}' AND TABLE_SCHEMA = '{1}' 
   AND TABLE_NAME = '{2}' AND COLUMN_NAME = '{3}' 
```

编辑：我不能使用 SMO，因为我无法控制执行机器，所以我不能保证它会被安装。（抱歉没有说清楚 rp）。

编辑：作为对 Joel 的回答，我正在尝试创建一个可以调用的函数，当传递一个 SqlConnection、一个表名和一个列名时，它将返回一个 SqlDBType。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-20T00:30:11.353

在 SQL Server 中，您可以使用 FMTONLY 选项。它允许您在不获取任何数据的情况下运行查询，只返回列。

```
SqlCommand cmd = connection.CreateCommand();
cmd.CommandText = "SET FMTONLY ON; select column from table; SET FMTONLY OFF";
SqlDataReader reader = cmd.ExecuteReader();
SqlDbType type = (SqlDbType)(int)reader.GetSchemaTable().Rows[0]["ProviderType"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-27T17:52:24.703

您可以使用枚举 System.Data.CommandBehavior 作为方法 SqlCommand.ExecuteReader(System.Data.CommandBehavior.KeyInfo) 的参数：

```
SqlCommand cmd = connection.CreateCommand();
cmd.CommandText = "select column from table";
SqlDataReader reader = cmd.ExecuteReader(System.Data.CommandBehavior.KeyInfo);
SqlDbType type = (SqlDbType)(int)reader.GetSchemaTable().Rows[0]["ProviderType"]; 
```

这个例子看起来像使用 sql 的例子： SET FMTONLY ON; 将 FMTONLY 设置为关闭。但是您不必使用 SET FMTONLY。在这种情况下，您不会
从表中接收数据。您只收到元数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-13T15:26:12.403

老问题，但是如果您要做的只是从字符串 DATA_TYPE 获取 SqlDbType 枚举，那么原始问题中提出的查询结合一行代码就可以解决问题：

```
string dataType = "nvarchar"; // result of the query in the original question
var sqlType = (SqlDbType)Enum.Parse(typeof(SqlDbType), dataType, true); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T23:23:07.883

对于 SQL Server，使用 SMO（SQL Server 管理对象）。

[http://www.yukonxml.com/articles/smo/](http://www.yukonxml.com/articles/smo/)

例如，您可以使用此代码遍历表的所有列。

```
Server server = new Server();
Database database = new Database( "MyDB" );
Table table = new Table( database, "MyTable" );

foreach ( Column column in table.Columns )
{
        WriteLine( column.Name ); 
} 
```

以下是您可以使用的所有列属性：http: [//msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.column_members.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.column_members.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T01:20:56.460

如果你最终要读取数据，你可以这样做：

```
SqlCommand comm = new SqlCommand("SELECT * FROM Products", connection);
using (SqlDataReader reader = comm.ExecuteReader())
{
    while (reader.Read())
    {
        Type type = reader.GetSqlValue(0).GetType();
        // OR Type type = reader.GetSqlValue("name").GetType();
        // yields type "System.Data.SqlTypes.SqlInt32"
    }
} 
```

# asp.net - 如何部署预编译的 ASP.NET Web 应用程序？

> ID：459573
> 
> 赞同：2
> 
> 时间：2009-01-19T23:16:35.963
> 
> 标签：asp.net, precompiled

我在 ASP.NET 2.0 中实现了一个 Web 服务，并使用 aspnet_compiler 对其进行了预编译。

我现在不知道如何将它部署到 IIS，有人能指出我正确的方向吗？我在 Windows Server 2003 机器上使用 IIS 6.0。

我已将预编译文件放入虚拟目录，当我通过浏览器访问服务时，我收到以下解析器错误消息：

```
解析器错误消息：页面必须有
<%@ webservice class="MyNamespace.MyClass" ... %> 指令。

```

然后我检查了 .asmx 文件中的指令，编译器将其内容更改为：

```
这是预编译工具生成的标记文件，请勿删除！

```

**更新：**当我将未预编译的 web 应用程序放在虚拟目录中时，它工作正常，当我将预编译的 wen 应用程序放在虚拟目录中时，出现上述错误。

有人有想法么！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T23:28:36.843

您可以将输出目录的内容复制到 IIS 上的虚拟目录中，它应该都能正常工作。您将需要设置应用程序池并为 ASP.NET 配置虚拟目录，就像未编译的网站一样。确保从虚拟目录中删除所有内容（如果那里有以前的未编译站点）。

您还可以使用[Web 部署](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)项目，它可以作为 MSI 安装程序的输入。

ASMX 文件内容正确。您确定您已使用应用程序配置了虚拟目录吗？通过右键单击虚拟目录打开属性窗口并确保“应用程序名称”（在“虚拟目录”选项卡上）已设置并可编辑。

是否还在选项卡上选择了正确的 ASP.NET 版本？在属性窗口的“ASP.NET”选项卡上检查这个”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T20:33:07.627

您是否部署了整个 bin 目录？您需要确保由 aspnet_compiled 创建的 .COMPILED 文件位于您的 bin 目录中。

# c# - 如何在 Global.asax 和 Asp.Net 中的页面之间共享密钥

> ID：459574
> 
> 赞同：1
> 
> 时间：2009-01-19T23:16:57.943
> 
> 标签：c#, asp.net, linq-to-sql

我正在使用 linq to sql，因此需要存储我的 DataContext 以供每个线程将来使用（我已阅读这篇文章：[http](http://www.west-wind.com/weblog/posts/246222.aspx) ://www.west-wind.com/weblog/posts/246222.aspx 关于实现共享上下文的方法）。不过，我想知道的是，如何创建一个 global.asax 文件都知道的密钥，而网页也将知道，而无需对其进行硬编码，如果我对其进行硬编码，则该密钥必须针对每个用户。

非常感谢！

冯迪普洛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T10:21:44.200

您是否考虑过 Castle.Windsor 框架中的 IContainerAccessor 之类的东西？

然后你可以做类似的事情

```
 public class GlobalApplication : System.Web.HttpApplication, IContainerAccessor
   {
     private static readonly WindsorContainer _container = new WindsorContainer(new XmlInterpreter(new ConfigResource("castle")));

     public IWindsorContainer Container
     {
         get { return _container; }
     }
   } 
```

随着容器变得可以通过整个应用程序访问，例如

```
 var accessor = HttpContext.Current.ApplicationInstance as IContainerAccessor;
   var controller = accessor.Container.Resolve<IDataContext>("myDataContext"); 
```

这将需要对 Castle Windsor 及其 IoC 功能进行一些研究，但我认为它们对您非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T23:22:53.187

嗯，听起来你想看看`Page.Cache`。这是在应用程序级别可用的集合。它在所有用户的所有会话中都可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T23:25:10.407

将 DataContext 添加到请求范围：

在 global.asax.cs 中：

```
HttpContext.Current.Items["HardcodedKey"] = dataContext; 
```

在页面中：

```
DataContext dc = (DataContext) HttpContext.Current.Items["HardcodedKey"]; 
```

.Items 集合的范围仅限于单个请求，因此对于给定的键，每个请求将引用不同的项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T09:28:53.777

不知道为什么你不能在 Global.asax 中使用 session - 你只需要确保你从正确的地方调用它。

默认情况下，Global.asax 中的内容很少，但是如果需要，您可以实现[许多方法](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.aspx)，并且您可能需要类似于*(tested local)*的方法：

```
void Session_Start(object sender, EventArgs e) 
{
    // Code that runs when a new session is started
    // Pick up your session id here, create a new context and away you go?

    var sessionId = Session.SessionID;

    Session.Add("sessionId", sessionId);
}

void Session_End(object sender, EventArgs e) 
{
    // Code that runs when a session ends. 
    // Note: The Session_End event is raised only when the sessionstate mode
    // is set to InProc in the Web.config file. If session mode is set to StateServer 
    // or SQLServer, the event is not raised.

    // Noting comment above, clean up your context if needs be.
} 
```

然后在您的站点中，您可以使用以下内容：

```
protected void Page_Load(object sender, EventArgs e)
{
    Literal1.Text = Session["sessionId"].ToString();
} 
```

我不确定 Session 是否适合您存储它，并且您需要进行一些性能测试以查看它是否能够处理您期望的各种负载。

# php - 使用 PHP 调用 C# Web 服务

> ID：459580
> 
> 赞同：2
> 
> 时间：2009-01-19T23:18:11.450
> 
> 标签：php

我想用 PHP 调用 C# 服务，有人知道怎么做吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T23:22:49.427

创建一个与 WSDL 匹配的 SOAP XML 文档并通过 HTTP POST 发送它。[有关示例，](http://www.w3schools.com/webservices/tempconvert.asmx?op=CelsiusToFahrenheit)请参见此处。

你发送这个：

```
POST /webservices/tempconvert.asmx HTTP/1.1
Host: www.w3schools.com
Content-Type: application/soap+xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <CelsiusToFahrenheit xmlns="http://tempuri.org/">
      <Celsius>string</Celsius>
    </CelsiusToFahrenheit>
  </soap12:Body>
</soap12:Envelope> 
```

把这个拿回来：

```
HTTP/1.1 200 OK
Content-Type: application/soap+xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <CelsiusToFahrenheitResponse xmlns="http://tempuri.org/">
      <CelsiusToFahrenheitResult>string</CelsiusToFahrenheitResult>
    </CelsiusToFahrenheitResponse>
  </soap12:Body>
</soap12:Envelope> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T23:46:10.677

没有所谓的“C# Web 服务”。您的意思是基于 SOAP 远程调用和 WSDL 进行描述的 XML Web Service。

事实上，所有 SOAP 服务都应该是相互兼容的，无论是 .Net、PHP 还是 Java。但在实践中，小问题会使它变得更加困难。

PHP 有许多不同的 SOAP 库，但用于从 PHP 连接到 ASP.NET XML Web 服务，但[nuSOAP](http://sourceforge.net/projects/nusoap/)为我提供了最好的结果。它基本上是一组使用基于 SOAP 的 Web 服务的 PHP 类。最简单的客户端代码如下所示：

```
<?php
// Pull in the NuSOAP code
require_once('nusoap.php');
// Create the client instance
$client = new soapclient('http://localhost/phphack/helloworld.php');
// Call the SOAP method
$result = $client->call('hello', array('name' => 'Scott'));
// Display the result
print_r($result);
?> 
```

有关更多示例，请参见[http://www.scottnichol.com/nusoapintro.htm](http://www.scottnichol.com/nusoapintro.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T23:29:08.010

我从来没有在 PHP->C# 中做过，我用 C# 调用 PHP webservices，我一直使用 Zend Framework 包装器来处理原生 PHP 类。您应该查看[Zend_Soap_Client ，如果它与 Zend_Soap_Server 类似，它只是一个包装器，其中包含一些围绕](http://framework.zend.com/manual/en/zend.soap.client.html)[PHP SOAP](http://us2.php.net/soap)类的增值内容。

而且，我应该说，它所做的只是将@Josh 所说的话包装成一个很好的类，并自动为你做一些事情。

# vba - 使用 VBA 在 TreeView 中选择一个节点

> ID：459589
> 
> 赞同：5
> 
> 时间：2009-01-19T23:20:39.340
> 
> 标签：vba, excel, treeview

我在Excel中有`TreeView`一个。`UserForm`当从 中选择一个节点时`TreeView`，a`ListBox`将填充数据。
当`ListBox`双击其中的一个项目时，将`UserForm`显示一个单独的项目，允许用户进行填充。
一旦用户返回到`TreeView UserForm`，我希望`Node`突出显示之前选择的 。

问题是它`UserForm`基本上会自行重置，我不知道如何`Node`使用 VBA 选择一个。

我正在争论我是否可以手动触发一个`NodeClick`事件，因为我尝试过的所有其他事情都失败了。

有小费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-26T14:18:13.017

我知道这是一个老问题，但我自己很难找到一个体面的答案，所以我们开始吧。索引或键并不总是可用。在创建时，我将节点的完整路径放在 node.tag 中。双击时我会回忆标签值，稍后我会在树视图节点集合中搜索标签。太多了？效率不高？也许，但它的作品每次都很有魅力，我可以根据树视图的目的在标签中使用我自己的标识符。查找代码：

```
Sub MyTreeview_FindNode(strKey As String)
Dim myNode As Node

   For Each myNode In Me.Treeview.Nodes
       If myNode.Tag = strKey Then
          myNode.Selected = True
          myNode.EnsureVisible
          End If
       Next
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-07T13:52:22.790

在我的 Excel 作品中：

```
TreeView1.Nodes(key).Selected = True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:23:37.793

你有几个选择。首先，当 TreeView 用户窗体显示第二个用户窗体时，您需要：

1.  保存所选节点的 ID（使用表单级或模块级变量）。然后，您需要编写一个方法来在返回表单时选择节点。IIRC，您需要为每个节点元素拥有一个唯一的“键”或 ID，然后将 TreeView.Select 用于从 TreeView.FindNode 返回的节点。 - 或者 -
2.  隐藏 TreeView 用户窗体而不是关闭它 (Me.Hide)。当第二个用户窗体关闭（或按下确定/取消）时，再次显示 TreeView 用户窗体 (TreeViewForm.Show)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-18T10:58:28.063

试试这个：objTreeview.Object.Nodes(KEY_NAME).Selected=TRUE

其中 KEY_NAME 是您用于创建节点的键（字符串）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-18T10:54:24.180

```
Set xTree = Me!tv_bom.Object

xTree.Nodes.Item(Index).Selected = True 
```

# ruby - 包括模块和嵌入模块有什么区别？

> ID：459590
> 
> 赞同：0
> 
> 时间：2009-01-19T23:21:18.387
> 
> 标签：ruby, module, mixins, oop

```
module Superpower

    # instance method
    def turn_invisible
        ...
    end

    # module method
    def Superpower.turn_into_toad
        ...
    end

    module Fly
        def flap_wings
            ...
        end
    end

end

Class Superman
    include Superpower
    ...

    def run_away
        # how to call flap_wings?
        # how to call turn_invisible?
    end

    def see_bad_guys(bad_guy = lex_luthor)
        #is this correct?
        Superpower.turn_into_toad(bad_guy)
    end
end 
```

嗨，我看到了一些我无法理解的 ruby​​ 代码。你如何从超人类中调用flap_wings？是否可以从类中调用实例方法？包含模块和嵌入模块有什么区别？为什么以及何时应该这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T23:29:11.723

我假设当您说嵌入模块时，您的示例中的“Fly”模块嵌入在“Superpower”中。

如果是这样的话，我会称它为嵌套模块。我唯一会使用嵌套模块的时候是嵌套模块专门处理主模块，这样 Fly 中的代码与 Superpower 直接相关，但为了方便和可读性而分开。

您可以使用嵌套模块的方法，只需先包含 superpower，然后再包含 fly，如下所示：

```
Class Superman
    include Superpower
    include Fly
    # ...
end 
```

[详细信息将在此博客](http://rubyonrailswin.wordpress.com/2007/03/08/nested-modules/)中进一步描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T23:28:34.393

您想阅读有关 mixins 的文档，这是一种解决 Ruby 只有单一继承这一事实的方法。通过在 B 类中包含给定模块 A，A 中的所有模块方法都可以使用，就好像它们实际上是 B 类的一部分一样。

这意味着调用`turn_invisible`就像

```
def run_away
  turn_invisible
end 
```

因为`flap_wings`它在另一个命名空间中，所以它可能很简单：

```
def fly_away
  Fly.flap_wings
end 
```

但我还没有尝试完成您的代码并“运行”它。

Mixin 在[这里](http://www.juixe.com/techknow/index.php/2006/06/15/mixins-in-ruby/)和[那里](http://www.rubycentral.com/pickaxe/tut_modules.html)都有解释。

# crystal-reports - 水晶报告：截断前导零（0）？

> ID：459593
> 
> 赞同：2
> 
> 时间：2009-01-19T23:22:02.550
> 
> 标签：crystal-reports

在水晶报表中，如何删除前导零？

我意识到对于数字 0000012313，您可以使用 right(0000012313, 5) 并返回 12313；但是，这是假设这是一个固定长度。

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T23:33:57.673

使用该`VAL()`功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-04T04:27:47.763

使用 cint(00000123)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-18T12:00:41.580

试试这个

```
if isnumeric({your field}) then
 totext(tonumber({yourfield}),0) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-08T12:40:24.660

如果您刚刚搜索并发现这些答案都不适用于 Crystal Reports，您应该尝试以下操作：

```
totext(tonumber(string), '#'); 
```

这也修复了额外的逗号错误

# smtp - SMTP、匿名中继和 Windows 2003

> ID：459594
> 
> 赞同：0
> 
> 时间：2009-01-19T23:22:05.343
> 
> 标签：smtp, windows-server-2003

假设：这是一个内部 Web 服务器

要使 Windows 2003 充当匿名 SMTP 中继服务器，您需要做些什么特别的事情吗？过去我已经配置了许多 Windows 2000 服务器来执行此操作，但从未遇到过问题。

我记得在 Windows 2003 中，Microsoft 在安全性方面做得有点强... 那么是否有任何特殊的注册表项必须删除才能允许这样做？
您必须删除或检查某些政策？

我目前收到此错误：服务器拒绝了一个或多个收件人地址。服务器响应为：550 5.7.1。无法转发 bruno.tyndall@somecompany.com

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T00:14:57.543

在 smtp 虚拟服务器的访问选项卡中，有一个中继按钮，这里有一个选项框，可以选择仅选择以下列表进行中继或除以下列表之外的所有列表。

如果要使其成为开放式中继，则选择除下面列表之外的所有内容并将该框留空。我可能会建议只使用下面的列表，并添加您希望能够中继的计算机的 IP。

还有一个复选框，上面写着允许所有成功通过身份验证的计算机进行中继，无论上面的列表如何，如果您勾选此选项，那么任何成功通过服务器身份验证的人都将能够进行中继。

# sql-server - 用于繁重操作的 SQL CLR 对象

> ID：459607
> 
> 赞同：1
> 
> 时间：2009-01-19T23:25:39.173
> 
> 标签：sql-server, linq, linq-to-sql, sql-server-2008, clr

这是我的场景：

我已经在我的 C# 框架中实现了集合逻辑。集合可以包含大量对象，在最坏的情况下甚至可能多达 100 万个。假设集合只包含称为 Doc 的对象列表。由于潜在的大量对象，我想让开发人员选择如何创建和使用集合。

对于较小的集合，开发人员只需创建一个新集合并将文档对象添加到集合中即可。正常的集合逻辑可用，例如联合、相交等。然后，开发人员可以在任何时候将集合与我的 OR 层一起保存，其中集合将具有分配给它的主 ID。

对于保存在数据库中的非常大的集合，我想绕过从数据库中提取 doc 对象的 ID，然后通过允许在 SQL 2008 CLR 中操作集合来将 ID 保存回集合对象的过程. 我想要一个简单的函数，比如这个签名：

```
public void AddSetMembers(int setID, Expression<Func<Doc, bool>> Where) 
```

这将允许开发人员将任意文档添加到与表达式匹配的集合中，而无需从数据库中提取所有 ID，其唯一目的是将它们添加到集合中。

我的问题是如何最好地在存储过程中处理此实现？我可以以某种方式将 lambda 传递给存储过程吗？我曾考虑过实现一个 IDoc 接口并将其加载到 CLR 中并具有如下签名：

```
public void AddSetMembers(int setID, Expression<Func<IDoc, bool>> Where) 
```

但是我仍然需要将 lambda 传递给 SP。我想让框架足够灵活，以便开发人员可以使用不同的条件来创建集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T23:36:13.973

您可以将 SQL 中的字符串传递给包含 lambda 的 SQL CLR 方法。然后使用框架的编译工具将该字符串编译成函数/方法，然后调用它。

# python - 使用 webpy 线程特定数据

> ID：459608
> 
> 赞同：2
> 
> 时间：2009-01-19T23:26:18.033
> 
> 标签：python, database, multithreading, web.py

我正在用 webpy 编写一个小网络应用程序，我想知道是否有人对我遇到的一个小问题有任何信息。

我写了一个小的 ORM 系统，它似乎工作得很好。理想情况下，我想用 webpy 将它缝合，但似乎只是按原样使用它会导致线程问题（数据库连接是跨线程边界实例化/访问的，或者异常状态）。

有谁知道我如何（在 webpy 中）在与页面处理代码的其余部分相同的线程上创建我的数据库连接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-06T07:59:19.890

我们将 SQLAlchemy 与 web.py 一起使用，并使用钩子来创建和关闭每个请求的数据库连接。SQLAlchemy 处理池，所以不是每个连接都是 tcp 连接。

您要使用的线程本地存储是 web.ctx 即。每次访问 web.ctx 时，您只会看到该线程设置的属性。

我们的代码看起来像这样：

```
def sa_load_hook():
    web.ctx.sadb = Session()

def sa_unload_hook():
    web.ctx.sadb.close()

web.loadhooks['sasession'] = sa_load_hook
web.unloadhooks['sasession'] = sa_unload_hook 
```

将 Session 替换为您的数据库连接功能，它应该适合您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T10:17:25.970

我会试试这个。免责声明：我没有使用 web.py 框架的经验。

我建议您尝试以下方法：

(1) 创建一个全局 threading.local 实例来跟踪您的线程本地对象（在您的情况下，它将只跟踪一个对象，一个数据库会话）。

```
import threading
serving = threading.local() 
```

(2) 在每个请求开始时，创建一个 db 连接/会话并将其保存在 threading.local 实例中。如果我正确理解了[web.py 文档](http://webpy.org/cookbook/application_processors)，您可以执行以下操作：

```
def setup_dbconnection(handler): 
    serving.dbconnection = create_dbconnection(...)
    try:
        return handler()
    finally:
        serving.dbconnection.close() # or similar

app.add_processor(setup_dbconnection) 
```

(3) 在你的控制器方法中（如果它们在 web.py 中被调用？），每当你需要一个 db 连接时，使用 serving.dbconnection。

# perl - 与 Perl 一起使用的最佳密码加密和解密库是什么？

> ID：459614
> 
> 赞同：4
> 
> 时间：2009-01-19T23:27:42.053
> 
> 标签：perl, encryption, passwords, encode

我正在编写一个操作受密码保护的 zip 文件的 perl 脚本。因此，我需要存储和检索密码才能做到这一点。我有三个用于存储密码的选项：

1.  以纯文本形式存储。在你加入之前，我几乎已经排除了这个选项。
2.  使用简单的密码修改器来防止偶然/意外访问（即使是 DBA）
3.  使用适当的加密/解密库，例如 Blowfish 或 AES。

无论我选择什么，都必须在 Perl 中运行，在 Windows 下并且易于使用。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T01:49:21.910

有一些在 Windows 上运行的 Perl 加密包，您可以使用 ActivePerl 包管理器下载 PPM。

您还可以使用这些模块的纯 Perl 版本（查找以 _PP 结尾的名称）。

我在 CPAN 上找到了这些模块：

*   [地穴::河豚](http://search.cpan.org/~dparis/Crypt-Blowfish-2.12/)
*   [地穴::Rijndael](http://search.cpan.org/~bdfoy/Crypt-Rijndael-1.07/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T23:32:16.960

方法 3 的主要问题是，您将包含密码的文件的密钥存储在哪里？您可以将 Base64 用于方法 2，但这很容易“解密”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T23:47:55.353

这里应该没有问题。您必须使用足够强大的加密方案。您被委托处理敏感数据，您必须尽一切可能保护它。

如果您使用的是 Windows，则可以利用 DPAPI 加密 AESkey 并将其存储在注册表中。Perl 具有与 Win32 库交互的模块。

最佳加密是主观的，但截至 2009 年 1 月，AES 128 已经足够强大，可以加密您的数据。

如果用户不完全理解他们在做什么，即使是最好的加密方案也可能被打败。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-30T03:41:20.943

显然，你是对的 #1 出局了。

出于相同的原因，#2 也退出了。它不安全。

至于#3，我可以建议这也出来了。解密密码使其进入更易受攻击的状态以进行比较。但是，如果您要这样做，我建议您使用 Crypt::CBC WITH Crypt::Blowfish 进行[密码块链接](http://searchsecurity.techtarget.com/definition/cipher-block-chaining)。

[推荐] #4：而不是像 #3 那样存储用于检索、解密、然后比较的密码。使用[Authen::Passphrase](http://search.cpan.org/~zefram/Authen-Passphrase-0.008/lib/Authen/Passphrase.pm)一个相当完整和灵活的 Perl 模块，它允许您比较输入的密码而无需解密/解码原始密码。另请参阅[如何在 Perl CGI 程序中加密和解密密码？](https://stackoverflow.com/questions/3675917/how-can-i-encrypt-and-decrypt-passwords-in-a-perl-cgi-program/3676402#3676402)

# java - 如何在 Java 中更改文件的权限和上次修改时间？

> ID：459622
> 
> 赞同：3
> 
> 时间：2009-01-19T23:31:21.017
> 
> 标签：java, file, permissions, cross-platform, last-modified

据我所知，Java 的 File 类不支持更改文件的权限和最后修改日期。有没有合适的方法以跨平台的方式做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-19T23:39:27.070

我正在查看[Java 6 文档](http://java.sun.com/javase/6/docs/api/)，并且有一个`setLastModified()`方法，以及`setReadable(...)`和`setWritable(...)`和`setExecutable(...)`方法（都在`java.io.File`类中）。所以是的，有一种方法......

# java - JSP 作为电子邮件模板

> ID：459624
> 
> 赞同：7
> 
> 时间：2009-01-19T23:32:15.010
> 
> 标签：java, email, jsp

有没有办法发送邮件正文来自 JSP 的 MIME 电子邮件？我需要使用包含表格的 Javamail 发送一封电子邮件，我认为如果我可以使用 JSP 进行所有格式设置和布局会很方便。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T03:56:38.517

在这个线程，[Java 电子邮件模板](https://stackoverflow.com/questions/456148/suggestions-for-java-email-templating)的建议中，朋友 Jack Leow 讲述了他是如何使用 JSP/Servlet 做到这一点的。这可能会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T23:51:43.427

为此，我认为您基本上必须运行 Tomcat（或等效的）服务器，并且在您构建电子邮件时，向服务器发送请求以调用您的 JSP，然后它将发回的内容电子邮件（或电子邮件的 HTML 部分）作为响应。不过，它似乎不是很优雅。

使用单独的模板系统可能会更好。这是一个相关问题的有趣[答案](https://stackoverflow.com/questions/195437/loading-jsp-pages-from-custom-sources#195503)。

（无耻插件：我碰巧喜欢[Clearsilver](http://www.clearsilver.net)作为模板系统，如果你碰巧在 UNIX/Linux 上）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T23:57:09.173

这有点棘手。我建议您改用 Velocity。

它在某种程度上类似于 JSP，但它是为独立运行而构建的。

不幸的是，我没有很多资源可以重定向你。

这可能看起来很有趣：

[http://www.martinfowler.com/bliki/JRubyVelocity.html](http://www.martinfowler.com/bliki/JRubyVelocity.html)

# c# - C# 中的反射会失败吗？

> ID：459634
> 
> 赞同：2
> 
> 时间：2009-01-19T23:37:21.083
> 
> 标签：c#, reflection

我们有一个正在用 C# 开发的应用程序。我们将所有资源存储在一个中央资源 DLL 中，该资源包含我们支持多种文化的图像、图标和字符串。

我们使用以下代码访问解决方案中任何项目的资源；

```
private ResourceManager ResMan;
ResMan = new ResourceManager("libResx.Resource", Assembly.ReflectionOnlyLoad("libResx")); 
```

然后我们使用访问资源的任何元素；

```
btnClose.Text = ResMan.GetString("btnClose"); 
```

除了缺少资源 DLL 之外，还有什么可能导致反射无法找到资源 DLL（程序集）。到目前为止，在测试中它是完美无缺的，当它最终部署到野外时，我们应该注意什么吗？

反思会失败吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T00:16:09.650

它可能会失败。您可以为程序集赋予属性以防止来自同一命名空间之外的另一个程序集的反射。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T23:42:00.090

查看每个 API 的参考文档，以查看每个 API 可以抛出的异常列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T09:22:28.127

反射非常有用，但它也可能由于更实际的原因而失败。

这发生在我最近的一个 MVC Web 应用程序（Castle MVC、Windsor、Brail & Boo）中。当 boo 脚本编译并从 propertybag 访问 List 时，它使用反射来识别 MyModel 的签名，以便它可以引用 View 的属性。

在这种情况下，反射失败的地方是 MyModel 的旧数据库记录不再与新模型同步，因为旧数据对于 MyModel 的某些新属性或属性具有空值。对于在新属性字段中具有值的新记录，这不是问题。

作为一般经验法则，我会将您的程序集注册为依赖项，并将命名空间放在您的 using 子句中。这在编译时为编译器提供了清晰的依赖链。它还使其他开发人员更容易识别特定库所依赖的内容，而不必费力地通过一堆代码来查找对外部 dll 的隐藏 Assembly.Reflection.OnLoad 调用。

此外，如果您希望您的 ResourceManager 发生很大变化，您应该考虑将其完全独立地分离到一个单独的 dll 中。（符合 SOLID OOP 设计原则）。这使您的应用程序更加模块化，如果您需要更新资源程序集，您只需重新编译受影响的库。

[鲍勃叔叔 - OOD 原理 (SOLID)](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T23:52:30.350

根据我的经验，我发现指定完整路径而不是依赖程序集名称更可靠。你可以`Assembly.ReflectionOnlyLoadFrom`改用。

# java - 在 java 中使用 long as ArrayList 索引

> ID：459643
> 
> 赞同：11
> 
> 时间：2009-01-19T23:40:26.210
> 
> 标签：java, arraylist

我正在编写这个 java 程序来使用 Eratosthenes 的 Sieve 查找直到 num 的所有素数，但是当我尝试编译时，它说我不能使用 long var 作为数组索引，并且它需要一个 int var它的位置。但我将处理大量数字，所以我不能使用 int。我能做些什么？

```
import java.util.*;
import java.lang.*;

public class t3{
    public static void main(String[] args){
        long num = 100;

        //declaring list and filling it with numbers
        ArrayList<Long> numlist = new ArrayList<Long>();
        for(long x=2 ; x<num ; x++){
            numlist.add(new Long(x));
        }

        //sieve or eratosthenes
        for(long x=0 ; x<Math.sqrt(num) ; x++){
            for(long y=x+1 ; y<numlist.size() ; y++){
                if(numlist[y]%numlist[x] == 0){
                    numlist.remove(y);
                }
            }
        }

        //print list
        for(Object item : numlist){
            System.out.println((Long)item);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-19T23:46:35.213

我不确定为什么你的代码会开始编译。

您不应该在数组列表中使用 [] 来访问成员。arraylist 只是一个内部存储在数组中的列表。您必须使用列表获取操作（仍然是 O(1)）。写 numlist[index] 意味着你在 numlist 中有一个对象数组。您不能像在 C++ 中那样覆盖 [] 操作。

此外，一个 int 在 Java 中是 32 位的。长度大于 2^32 的数组（因此您需要长索引）是不可能的，我什至不确定规范是否允许。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-19T23:51:57.107

意识到使用 long[] 的 32 位有符号 int 索引，您正在处理 16GB 的 RAM。

如果你真的很想用筛子得到大素数，那么在你当前的 impl 中你不会逃脱一些事情：

*   盒装多头的 ArrayList
*   像 Uri 提到的那样使用 []
*   没有系统地分页到磁盘

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-20T07:09:10.313

[Java 规范](http://java.sun.com/docs/books/jls/third_edition/html/arrays.html)将数组限制为最多 Integer.MAX_VALUE 元素。虽然 a`List`可能包含[更多元素（这](http://java.sun.com/javase/6/docs/api/java/util/List.html#size())[通常](http://java.sun.com/javase/6/docs/api/java/util/Collection.html#size())适用于`Collection`s ），但您只能使用索引[添加/获取/删除/设置它们。](http://java.sun.com/javase/6/docs/api/java/util/List.html#method_summary)`int`

假设您有这么多元素的内存（我认为这不太可能），您可以编写自己的由“连接”数组组成的数据结构。`get()`and`set()`方法将获取一个索引`long`并找出该数组中的相应数组和`int`索引。

另外，我建议使用布尔值来表示每个数字的状态，而不是显式存储/删除每个数字。这会更好，因为 (1) boolean 比 longs 占用更少的空间，并且 (2)`ArrayList`在元素移除期间移动元素（如 中所做的）可能很昂贵。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T23:59:55.203

至少理论上java数组的最大大小是Integer.MAX_VALUE。这是因为数组索引的类型[根据规范](http://java.sun.com/docs/books/jls/second_edition/html/expressions.doc.html#46168)是 int。实际上，这取决于您的记忆力。

因此，如果您的算法真的依赖于拥有如此大的数组，那么您对 ​​java 数组就不走运了。

因为我怀疑您是否需要所有可以编写自己的集合类的空间，该集合类的作用类似于数组，但不需要太多内存。它会折叠地址空间中的整体（可以这么说）。当然，这可能会改变您对算法所期望的运行时行为。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-04-15T13:52:43.453

已经有人提议通过 Project Coin ( [http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/000869.html](http://mail.openjdk.java.net/pipermail/coin-dev/2009-March/000869.html) ) 将长索引数组添加到 Java 中，尽管没有任何内容被接受或安排。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T00:11:34.773

简单的解决方案：考虑到`num`您的代码示例中永远不会大于 100，只需将其类型更改为`int`.

但是其他人提到的关于地址空间的观点也很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T01:16:11.650

jScience 库有一个名为[Float64Vector](http://jscience.org/api/index.html)的大向量。虽然我从未使用过这个类，但它可能适合您的需求。没有保证。

编辑：Zach Scrivena 在评论中指出 Float64Vector 的尺寸为整数。我站得更正了。

# java - 监控 JBoss 的 JVisualVM 问题

> ID：459644
> 
> 赞同：2
> 
> 时间：2009-01-19T23:41:26.207
> 
> 标签：java, jboss, monitoring, jvisualvm

我想使用 JVisualVM 监控在 JBoss 3.2.5 版中运行的应用程序。我已经安装了我的应用程序来运行 ass windows 服务。JVisualVM 看到我的应用程序，但我既看不到线程转储也看不到堆转储。分析也是不可能的。我收到一个带有错误图标但没有文本的错误对话框。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T23:58:15.550

确保同一用户正在运行 JVisualVM 和 JBoss。

另外，我注意到您无法配置远程连接。因此，如果可能，请确保在同一台机器上运行 JVisualVM。

如果你不能在同一台机器上运行 JVisualVM，我读到[Netbeans](http://www.netbeans.org/features/java/profiler.html)有远程分析支持。但我从未亲自使用过它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T04:46:41.583

您的 JBoss 很可能正在运行 Java 5。高级分析和监视功能需要 Java 6。我最近自己测试了这个（使用 Sun Java 5 JVM，而不是 JBoss）。

[JVisualVM 的特征矩阵 http://www.postimage.org/Pq3fZyJ-082d768361c91340a8014cf7ec893896.png](http://www.postimage.org/Pq3fZyJ-082d768361c91340a8014cf7ec893896.png)。

# ruby-on-rails - （Rails）什么是“RJS”？

> ID：459647
> 
> 赞同：35
> 
> 时间：2009-01-19T23:43:42.350
> 
> 标签：ruby-on-rails, ajax, prototypejs, rjs

我在博客文章和教程中看到过“RJS”和“RJS 模板”。我进行了搜索，但我仍然不确定。它是特定于 Rails 的技术，而不是像 JSON 或 YAML 这样的标准吗？

我知道它用于“生成 JavaScript”。它是否生成需要 Prototype 和 Scriptaculous 库的通用 JS 或特定于 Rails 的 JS？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-20T00:26:39.377

[这个 Railscast](http://railscasts.com/episodes/74-complex-forms-part-2)提供了一个很好的例子，使用 RJS 动态添加和删除表单字段，而无需通过 ajax 调用访问服务器。

[这些 RJS 提示](http://railscasts.com/episodes/45-rjs-tips)也可能会有所帮助。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-12-20T06:18:33.813

RJS 是一个生成 JavaScript 的模板（类似于 html.erb 文件），该 JavaScript 由浏览器在 eval 块中执行以响应 AJAX 请求。它有时被用来（不正确地？）描述 Rails 提供的 JavaScript、Prototype 和 Scriptaculous Helpers。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-05-13T00:14:33.343

RJS 是一个“ruby-to-js”模板系统，RJS 在 Rails 生态系统中不再广泛使用。现在首选 SJR（服务器生成的 JavaScript 响应）。

这篇 DHH 的帖子帮助我理解了很多：[https ://signalvnoise.com/posts/3697-server-generated-javascript-responses](https://signalvnoise.com/posts/3697-server-generated-javascript-responses)

2021 年编辑：现在您应该使用 Hotwire.dev

# c++ - 我可以简化一下吗？

> ID：459649
> 
> 赞同：2
> 
> 时间：2009-01-19T23:45:07.213
> 
> 标签：c++, reference, polymorphism, function-pointers

```
typedef void (FunctionSet::* Function)();

class MyFunctionSet : public FunctionSet
{
protected:
    void addFunctions()
    {
        addFunction(Function(&MyFunctionSet::function1));
    }

    void function1()
    {
        // Do something.
    }
}; 
```

addFunction 方法将函数添加到基类中的列表中，
然后可以枚举该列表以调用所有函数。

有什么方法可以简化（减少打字工作）添加功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T23:52:01.133

你能解释一下你想通过这样做来实现什么吗？

这似乎是一个相当糟糕的设计，难道你不能有一个抽象类（“c++ 接口”），例如“Computable”，它有一个纯虚函数1，每个实现的子类 Computable，然后让 MyFunctionSet 维护一组 Computable？

您使用函数指针是否有特定原因？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T00:24:06.840

看起来您将一个指向派生类函数的成员函数指针分配给一个指向基类函数的成员函数指针。好吧，这是被禁止的，因为它在类型系统中打开了一个漏洞。这是一个惊喜（至少对我来说，这是我第一次听说）。阅读[此答案](https://stackoverflow.com/questions/420726/how-to-cast-member-variable-pointer-to-generic-type-in-c#420804)以了解原因。

要回答您的实际问题 - 我会制作`addFunction`一个模板：

```
void addFunctions() {
    addFunction(&MyFunctionSet::function1);
} 
```

`addFunction`将基类更改为此：

```
template<typename Derived>
void addFunction(void(Derived::*f)()) {
    myFunctions.push_back(static_cast<Function>(f));
} 
```

更好地使用`static_cast`，因为它会告诉你是否`Derived`实际上不是从`FunctionSet`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T00:53:05.517

所以，我倾向于在某种程度上不同意 Uri。

如果你正在实现观察者模式，你想要的是能够说：

“当对象 X 执行 Y 时，我想执行代码 Z”。

采用纯粹基于抽象类的方法并不是最好的方法。为每个事件处理程序要求一个单独的类（尤其是在 C++ 中）是多余的。如果您来自 Java，那么他们就是这样做的。然而，Java 有 2 个特性使这有点烦人：匿名类和“实例”成员类。这允许您为同一类中的多个事件定义多个处理程序。您必须在方法前面加上“class {”，但您可以这样做。

C++ 没有匿名类或“实例”成员类。如果您有多个需要共享状态的处理程序，这使得为事件使用抽象类变得更加麻烦。您必须手动执行相当于生成闭包的操作，这很快就会变得非常烦人。

.NET 使用委托进行事件处理，这基本上是类型安全的函数指针。它们使处理事件的代码非常直接。然而，与 C++ 中的函数指针不同，委托统一了成员函数指针和静态函数指针。基本上它可以curry任何成员函数的“this”参数，留下一个看起来就像一个静态函数指针的函数指针。这意味着处理事件的对象类型不是事件“接口”的一部分。这使得它非常灵活。

您不能直接使用 C++ 成员函数指针来执行此操作，因为“this”类型最终成为函数指针类型的一部分，从而将处理程序限制为仅出现在当前类中。

C++ 的最佳解决方案是两者的混合。你想要的是一个像这样的通用接口：

```
class EventHandler
{
public:
    virtual void Handle() = 0;
}; 
```

然后是这样的成员函数的实现

```
template <class T>
class MemberFuncEventHandler : public EventHandler
{
public:

    MemberFuncEventHandler(T * pThis, void (T::*pFunc)()) : m_pThis(pThis), m_pFunc(pFunc)
    {
    }

    void Handle()
    {
        (m_pThis->*m_pFunc)();
    } 
private:
    T* m_pThis;
    void (T::*m_pFunc)();
};

template <class T>
EventHandler * Handler(T * pThis, void (T::*pFunc)())
{
    return new MemberFuncEventHandler<T>(pThis, pFunc);
} 
```

您也可以类似地为静态方法定义一个处理程序类。然后你可以做这样的事情：

```
Handlers += Handler(obj, &(c1::foo));
Handlers += Handler(obj, &(c2::bar));
Handlers += Handler(blaa); // for static methods... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T23:48:55.023

我想你可以重载加法运算符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T01:04:39.863

如果您正在尝试制作回调系统或其他东西，我会推荐 Boost.Signals 库。基本上，它聚合函数并根据命令调用函数组（就像任何其他信号库一样），但它也被设计为与 Boost.Bind 和 Boost.Function 一起使用，它们很棒。

例子：

```
using boost::function
using boost::bind
using boost::signal

void some_other_func();    

Foo a;
Bar b;

signal<void()> sig;

sig.connect(bind(&Foo::foo,&a));
sig.connect(bind(&Bar::bar,&b));
sig.connect(some_other_func);

sig(); // calls -> a.foo(), b.bar(), some_other_func() 
```

还支持阻塞、复杂的连接管理和其他简洁的东西。

# c# - 为什么 C# 集合初始化器以这种方式工作？

> ID：459652
> 
> 赞同：58
> 
> 时间：2009-01-19T23:47:16.977
> 
> 标签：c#, collections

我正在查看 C# 集合初始化程序，发现该实现非常实用，但也与 C# 中的其他任何东西都非常不同

我能够创建这样的代码：

```
using System;
using System.Collections;

class Program
{
    static void Main()
    {
        Test test = new Test { 1, 2, 3 };
    }
}

class Test : IEnumerable
{
    public IEnumerator GetEnumerator()
    {
        throw new NotImplementedException();
    }

    public void Add(int i) { }
} 
```

由于我已经满足了编译器的最低要求（已实现`IEnumerable`和 a `public void Add`），因此它可以工作，但显然没有任何价值。

我想知道是什么阻止了 C# 团队创建一组更严格的要求？换句话说，为什么为了编译这个语法，编译器不要求类型实现`ICollection`？这似乎更符合其他 C# 功能的精神。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-01-20T00:11:29.860

您的观察是正确的 - 事实上，它反映了由 Microsoft C# 语言 PM 的 Mads Torgersen 所做的观察。

Mads 在 2006 年 10 月就这个主题发表了一篇题为“*[什么是收藏？](http://blogs.msdn.com/madst/archive/2006/10/10/What-is-a-collection_3F00_.aspx)*他在其中写道：

> 承认，我们在框架的第一个版本中用 System.Collections.ICollection 搞砸了，这几乎没用。但是当泛型出现在 .NET 框架 2.0 中时，我们很好地修复了它： System.Collections.Generic.ICollection<T> 允许您添加和删除元素、枚举它们、计算它们并检查成员资格。
> 
> 显然从那时起，每个人都会在每次收集时都实现 ICollection<T> ，对吧？不是这样。以下是我们如何使用 LINQ 了解集合的真正含义，以及这如何使我们改变了 C# 3.0 中的语言设计。

事实证明，`ICollection<T>`框架中只有 14 个实现，但有 189 个类实现`IEnumerable`并具有公共`Add()`方法。

这种方法有一个隐藏的好处——如果他们基于`ICollection<T>`界面，就会有一个受支持的`Add()`方法。

相反，他们确实采用的方法意味着集合的初始化器只是形成`Add()`方法的参数集。

为了说明，让我们稍微扩展您的代码：

```
class Test : IEnumerable
{
    public IEnumerator GetEnumerator()
    {
        throw new NotImplementedException();
    }

    public void Add(int i) { }

    public void Add(int i, string s) { }
} 
```

你现在可以这样写：

```
class Program
{
    static void Main()
    {
        Test test 
            = new Test 
            {
                1, 
                { 2, "two" },
                3 
            };
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T00:26:14.697

这个我也想过，最让我满意的答案是ICollection除了Add之外还有很多方法，比如：Clear、Contains、CopyTo、Remove。删除元素或清除与是否能够支持对象初始化器语法无关，您所需要的只是一个 Add()。

如果框架设计得足够细致，并且有一个 ICollectionAdd 接口，那么它就会有一个“完美”的设计。但老实说，我认为每个接口都有一个方法不会增加太多价值。IEnumerable + Add 似乎是一种 hackish 方法，但是当您考虑它时，它是一个更好的选择。

编辑：这不是 C# 唯一一次使用这种类型的解决方案来解决问题。从 .NET 1.1 开始，foreach 使用鸭子类型来枚举集合，您的类需要实现的只是 GetEnumerator、MoveNext 和 Current。Kirill Osenkov 有一个[帖子](http://kirillosenkov.blogspot.com/2007/09/c-30-collection-initializers-duck.html)也问了你的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T12:02:30.460

（我知道我迟到了 3 年，但我对现有的答案并不满意。）

> 为什么，为了编译这个语法，编译器不要求类型实现 ICollection？

我会颠倒你的问题：如果编译器有一些并不真正需要的要求，那有什么用？

非`ICollection`类也可以从集合初始化语法中受益。考虑允许向其中添加数据但不允许访问先前添加的数据的类。

就个人而言，我喜欢使用`new Data { { ..., ... }, ... }`语法为我的单元测试代码添加一种轻量级的、类似 DSL 的外观。

实际上，我宁愿弱化这个要求，这样我就可以使用好看的语法，甚至不必费心去实现`IEnumerable`. 集合初始化器是 Add() 的纯语法糖，它们不应该需要任何其他东西。

# devexpress - 我可以更改 Visual Studio 免费版 CodeRush Express 的键绑定吗？

> ID：459656
> 
> 赞同：6
> 
> 时间：2009-01-19T23:49:02.293
> 
> 标签：devexpress, coderush

注意：我已经尝试在 coderush/devexpress 论坛上发帖，并且像往常一样，没有收到任何回复。希望一些 SO 用户使用 coderush express 并可能提供帮助？

你好。我刚刚安装了免费的 CodeRush XPress 插件，它看起来不错，但是我不知道如何更改键绑定！我发现 Ctrl+Alt+F 很难按，而且 Shift+Enter 与我在过去 3 年中设置的现有键绑定冲突，所以我真的抵制 CodeRush 覆盖它。

我只是愚蠢并且遗漏了一些非常明显的东西，还是“更改键绑定”不是免费版本的功能？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T00:25:24.357

DevExpress 的人做出了回应。Ctrl+Shift+Alt+O 调出选项。杰出的

# apache - 如何使用 mod_rewrite 和 Apache 对特殊字符进行编码？

> ID：459667
> 
> 赞同：31
> 
> 时间：2009-01-19T23:54:22.423
> 
> 标签：apache, mod-rewrite, escaping

我想为我的标记系统提供漂亮的 URL 以及所有特殊字符：`+`、`&`、`#`、`%`和`=`。有没有办法用 mod_rewrite 做到这一点而不必对链接进行双重编码？

我注意到delicious.com 和stackoverflow 似乎能够处理单独编码的特殊字符。什么是神奇公式？

这是我想要发生的一个例子：

```
http://www.example.com/tag/c%2b%2b 
```

将触发以下 RewriteRule：

```
RewriteRule ^tag/(.*)   script.php?tag=$1 
```

并且标签的值是“c++”

apache/mod_rewrite 的正常操作不是这样工作的，因为它似乎把加号变成了空格。 **如果我将加号双重编码为​​“%252B”，那么我会得到想要的结果**——但是它会导致 URLS 混乱，而且对我来说似乎很糟糕。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-20T01:36:37.490

> apache/mod_rewrite 的正常操作不是这样工作的，因为它似乎把加号变成了空格。

我不认为这是正在发生的事情。Apache 正在将路径部分中的 %2Bs 解码为 +s，因为 + 在那里是一个有效字符。它在让 mod_rewrite 查看请求之前执行此操作。

那么 mod_rewrite 将您的请求 '/tag/c++' 更改为 'script.php?tag=c++'。但是在 application/x-www-form-encoded 格式的查询字符串组件中，转义规则与应用于路径部分的规则略有不同。特别是，'+' 是空格的简写（它也可以编码为 '%20'，但这是我们现在永远无法改变的旧行为）。

因此，PHP 的表单阅读代码接收“c++”并将其作为 C-space-space 转储到您的 _GET 中。

看起来解决这个问题的方法是使用重写标志“B”。请参阅[http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteflags](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteflags) - 奇怪的是它使用或多或少相同的例子！

```
RewriteRule ^tag/(.*)$ /script.php?tag=$1 [B] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T00:11:26.617

我不确定我是否理解您的要求，但是您可能会对`NE`Apache 指令的 (noescape) 标志感兴趣。`RewriteRule`基本上，它可以防止`mod_rewrite`在您提供的替换模式中自动转义特殊字符。Apache 2.2 文档中给出的示例是

```
RewriteRule /foo/(.*) /bar/arg=P1\%3d$1 [R,NE] 
```

例如，这将变成`/foo/zed`重定向到`/bar/arg=P1%3dzed`，这样脚本`/bar`就会看到一个以`arg`value命名的查询参数`P1=zed`，如果它在其中查找`PATH_INFO`（好吧，这不是*真正的*查询参数，所以起诉我 ;-P）。

至少，我认为它是这样工作的。. . 我自己从来没有使用过那个特殊的标志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-29T09:26:40.380

我终于在 RewriteMap 的帮助下让它工作了。

在 httpd.conf 文件中添加了转义映射 RewriteMap es int:escape

并在重写规则中使用它

```
RewriteRule ([^?.]*) /abc?arg1=${es:$1}&country_sniff=true [L] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-15T09:13:00.667

根本问题是您正在从具有一种编码（特别是加号是加号）的请求转移到具有不同编码的请求（加号表示空格）。解决方案是绕过 mod_rewrite 所做的解码，并将您的路径直接从原始请求转换为查询字符串。

为了绕过重写规则的正常流程，我们将原始请求字符串直接加载到环境变量中，并修改环境变量而不是正常的重写路径。它已经被编码了，所以当我们将它移动到查询字符串时，我们通常不需要担心编码它。然而，我们真正想要的是对加号进行百分比编码，以便将它们正确地转为加号而不是空格。

规则非常简单：

```
RewriteEngine On

RewriteRule ^script.php$ - [L]

# Move the path from the raw request into _rq
RewriteCond %{ENV:_rq} =""
RewriteCond %{THE_REQUEST} "^[^ ]+ (/path/[^/]+/[^? ]+)"
RewriteRule .* - [E=_rq:%1]

# encode the plus signs (%2B)  (Loop with [N])
RewriteCond %{ENV:_rq} "/path/([^/]+)/(.*)\+(.*)$"
RewriteRule .* - [E=_rq:/path/%1/%2\%2B%3,N]

# finally, move it from the path to the query string
# ([NE] says to not re-code it)
RewriteCond %{ENV:_rq} "/path/([^/]+)/(.*)$"
RewriteRule .* /path/script.php?%1=%2 [NE] 
```

这个简单的 script.php 确认它可以工作：

```
<input readonly type="text" value="<?php echo $_GET['tag']; ?>" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-01T13:18:15.130

我在使用 + 登录 url 时遇到了 mod_rewrite 的类似问题。场景如下：

我们有一个带有 + 号的 url 需要重写`http://deskdomain/2013/08/09/a+b+c.html`

`RewriteRule ^/(.*) http://mobiledomain/do/urlRedirect?url=http://%{HTTP_HOST}/$1`

struts 操作 urlRedirect 获取 url 参数，做一些更改并使用 url 进行另一个重定向。但是在 req.getParameter("url") 中 + 号变为空，参数 url 内容为 `http://deskdomain/2013/08/09/a b c.html`，导致找不到重定向 404。为了解决它（从先前的答案中获得帮助）我们使用重写标志 B（转义反向引用）和 NE（noescape）

`RewriteRule ^/(.*) http://mobiledomain/do/urlRedirect?url=http://%{HTTP_HOST}/$1 [B,NE]`

B 将转义 + 到 %2B ，NE 将阻止 mod_write 转义 %2B 到 %252B （双转义 + 符号），所以在`req.getParameter("url")=http://deskdomain/2013/08/09/a+b+c.html`

我认为原因是 req.getParameter("url") 会为我们做一个转义，+ 号可以转义为空。您可以尝试 unescape %2B 一次到 + ，然后再 unescape + 到空。

`"%2B" unescape-> "+" unescape-> " "`

# string - Perl 中是否有内置的“hash to string”？

> ID：459668
> 
> 赞同：16
> 
> 时间：2009-01-19T23:54:34.903
> 
> 标签：string, perl, hash

我将从 Python 背景中学习 Perl，其中内置了以下哈希到字符串的转换：

```
>>> d = {'a': 1, 'b': 2, 'c': 3}
>>> str(d)
"{'a': 1, 'c': 3, 'b': 2}" 
```

是否有一个内置和/或模块有一个子例程，其输出如下：

```
"('a' => 1, 'b' => 2, 'c' => 3)" 
```

奇怪的是，网络搜索`perl "hash to string"`并没有出现我正在寻找的任何内容。谢谢！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-20T00:06:53.193

```
use Data::Dumper;
local $Data::Dumper::Terse = 1;
my $str = Dumper({a => 1, b => 2, c => 3}); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-20T00:44:54.787

另请参阅[JSON](https://metacpan.org/pod/JSON)：

```
#!/usr/bin/perl
use warnings; use strict;
use JSON;

my $data = {a => 1, b=> 2, c => 3};

print to_json($data); 
```

这会产生：

```
{"c":3,"a":1,"b":2} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-20T00:00:49.990

有[`Data::Dumper`](http://search.cpan.org/dist/Data-Dumper/)一种方法可以进行这种转换的模块。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-20T13:22:47.220

使用[Data::Dump](http://search.cpan.org/dist/Data-Dump/)而不是 Data::Dumper。它基本上是一样的，除了没有那个烦人的`$VAR1 = ...`东西：

```
use Data::Dump "pp";
print pp({a => 1, b => 2, c => 3}); 
```

产生：

```
{ a => 1, b => 2, c => 3 } 
```

如果你在 Windows 上，Data::Dump从 5.8 版开始就预装了[ActivePerl 。](http://aspn.activestate.com/ASPN/Downloads/ActivePerl/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T13:53:36.317

另一个燕子解决方案：

```
sub pp {
  my $h = shift();
  qq[{${\(join',',map"$_=>$h->{$_}",keys%$h)}}]
}
print pp({a => 1, b => 2, c => 3}); 
```

但[`Data::Dumper`](http://search.cpan.org/dist/Data-Dumper/Dumper.pm)改为使用。

对于非常精美的输出，您还可以使用：

```
use Data::Dumper;
use Perl::Tidy;
sub pp {
        local $Data::Dumper::Terse    = 1;
        local $Data::Dumper::Indent   = 0;
        my $source = Dumper(@_);
        my $result;
        Perl::Tidy::perltidy(
                source      => \$source,
                destination => \$result,
                argv        => [qw(-pbp -nst)]
        );
        return $result;
} 
```

如果您更喜欢某些键应该是第一个而不是您可以使用这种方法（我想要`type`第一个和`position`第二个）：

```
 local $Data::Dumper::Sortkeys = sub {
            [   sort {
                            if    ( $b eq 'type' )     {1}
                            elsif ( $a eq 'type' )     {-1}
                            elsif ( $b eq 'position' ) {1}
                            elsif ( $a eq 'position' ) {-1}
                            else                       { $a cmp $b }
                            } keys %{ $_[0] }
            ];
    }; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-02T22:13:43.507

如果您有可能使用多级结构，则上述几种解决方案都会出现问题。

特别是这个标志：

```
$Data::Dumper::Terse    = 1; 
```

如 Data::Dumper 的 perldoc 页面所述，“简洁”标志可能会生成非 perl 可解析输出。

如果您可能会有多深度结构，那么正确的做法是使用：

```
$Data::Dumper::Indent = 0; 
```

eval 保证 perl 可解析，这使得序列化为纯文本提供了一种非常简单的方法......

# mysql - 您只更新更改的字段还是所有字段？

> ID：459669
> 
> 赞同：10
> 
> 时间：2009-01-19T23:54:48.147
> 
> 标签：mysql, sql-update, changelog

我想知道在更新记录以检索现有记录时是否值得服务器时间，循环检查更改的字段并仅将更改的字段放入更新查询中？（我正在使用 MySQL 和 PHP。）

这样做的主要原因是为了减少更新查询的大小以用于更改日志。通常查询可能有 15 个字段，但实际上只有 2 个字段被更改。这个查询也可以用于记录，因为它只包含更改的字段，因此更容易解析。

我担心的是检索现有记录所需的时间。

或者有没有办法从 MySQL 中检索它更新了哪些字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T00:06:05.893

我认为值得改变 - 但可能不值得在插入之前进行选择。

我只更新已更改的字段，它是我的 DbEntity 类操作的一部分，它遵循 activerecord 模式。这样做几乎不需要额外的费用，因为我持有当前记录和原始记录 - 只需在加载记录时进行复制。

原因很简单——不是真正的表现。您还可以通过在更新字段的旧值上添加 where 子句来检查并发修改并引发相应的错误。

在写入/更新方法中：

```
$s1 = "";

foreach ($this->record as $key => $value)
{
    // only update fields that have been changed
    if ($value != $this->orig_record[$key])
    {
        $s1 .= $comma."`$key`='".mysql_real_escape_string($value)."'";
        $comma = ", ";
    }
}

$query = "UPDATE ".$this->table." SET $s1 where {$this->id_field}='".$this->get_keyfield()."'";
$query .= $this->extra_sql_update;
mysql_query($query);

$ar = mysql_affected_rows();
//
// the number of affected rows is actually those changed by the update operation, which will 
// either be zero, or 1\. If the query affects more than one row then we have a problem.
if ($ar < 0 || $ar > 1)
{
    cbf_error("cbf_dbentity: {$this->table} :: only one row (not $ar) must be affected by an insert operation. $query",
      E_USER_ERROR);
}
else
{
    $new_id = $this->get_keyfield();

    GlobalEventBus::notify_all(new AuditLogSQL($this->table, "update", $query));

}

$this->orig_record = Array();

foreach ($this->record as $key => $value)
    $this->orig_record[$key] = $value;

//
// sanity check - ensure that what we have just written is actually there.

$this->load($new_id);

foreach ($this->orig_record as $key => $value)
    if (trim($this->record[$key]) != trim($value) 
        && (!$this->record[$key] == "0" && $value=""))
        cbf_error("cbf_dbentity: {$this->table} :: record differs during write after reload: field $key was \"$value\", after write it is now \"".
              $this->record[$key]."\"",E_USER_ERROR); 
```

在加载方法中

```
$this->orig_record = Array();
foreach ($this->record as $key => $value)
    $this->orig_record[$key] = $value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T00:37:30.353

在最基本的层面上，如果我没看错你的问题，你通常不想盲目地更新整个记录，以防另一个用户已经更新了你实际上没有更改的记录的部分。您会盲目且不必要地恢复他们的更新。

我相信您当前的算法可能会导致脏写，如果您要读取当前一次进行更新，请允许在内存中进行更新，然后再次读取记录以让您确定哪些字段已更新。如果另一个用户在您背后更新了该记录，导致您的算法相信*您*是更新该字段的人，会发生什么？但首先，您不必为了执行一次更新而读取每条记录两次。

如果您的数据不经常导致冲突，您可能会从阅读乐观锁定中受益，即使您不选择实现它。

我们在这里实现了一种方法，您可以将更新时间戳或增量更新编号列添加到表中。然后在您的沙箱/内存中，您可以跟踪您修改了哪些字段（旧值/新值），并且您可以自由地为这些字段的该记录发出更新 SQL，“UPDATE...WHERE UPDATENUM=the-original-number "（或 WHERE UPDATETS=the-original-timestamp），确保您的更新 SQL 也酌情增加 UPDATENUM 或 UPDATETS。如果受该更新 SQL 影响的记录为 0，则您知道其他人已经在后台修改了该记录，并且您现在有冲突。但至少您没有覆盖其他人的更改，然后您可以重新读取新数据或让您的用户解决冲突。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:04:46.833

应用程序中最慢的点总是数据库访问，所以如果你能加快速度，这是个好主意。也就是说，这实际上取决于您的数据库和记录有多大，以及它们可能增长到多大，是否值得以编程方式检查项目是否已更新。如果您的数据库很小并且访问速度已经很快，那么可能不值得花时间。但是，如果可以提高速度，并为您的日志记录带来额外的好处，那就去吧。

# php - 绑定布尔值的bind_param问题

> ID：459674
> 
> 赞同：9
> 
> 时间：2009-01-19T23:57:59.077
> 
> 标签：php, mysqli, boolean, prepared-statement, bindparam

我`mysqli_stmt::bind_param`在 PHP5 中使用绑定布尔值时遇到问题。

SQL 查询如下：

```
insert into `nvp_notes` (subject,messageid,receivedate,read) values (?,?,?,?) 
```

'read' 是一个 tinyint，0 或 1，因为我在使用 mysqli 时遇到了一些问题。所以我在 bind_param 中列出的类型是：

```
$stmt->bind_param('sdsd', ...); 
```

我也尝试过 'sdsb' 和 'sdss' 但似乎没有任何效果，而且我总是收到以下信息：

> 警告：mysqli_stmt::bind_param()：变量数与准备语句中的参数数不匹配

当我删除语句中的读取字段时，一切正常。我已经没有这个想法了。当然 bind_param 与布尔值一起使用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-20T00:06:12.087

[您可以使用intval()](http://php.net/intval)将布尔值转换为 1 或 0 （或使用*(int)*或*(integer)*进行转换）。根据[mysqli_stmt::bind_param() 的文档](http://ca.php.net/manual/en/mysqli-stmt.bind-param.php)，您可以绑定的唯一类型是整数、双精度、字符串和 blob。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T11:33:26.893

感谢您的回答，我终于设法解决了这个问题（在尝试了类型转换之后，甚至通过在查询中将其修复为 1 或 0 将其排除在 bind_param 之外）。无论如何，'read' 是 MySQL 中的保留列名，所以我只是更改了列名，它工作正常。但是对于此类问题，收到该特定错误消息似乎很奇怪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-12T11:16:36.963

因为你需要绑定的实际上是一个整数，所以我会用 'i' 来切换 'd'(double)：

> $stmt->bind_param('sisi', ...);

# c# - C#，一个字符串的 Split() 方法

> ID：459677
> 
> 赞同：19
> 
> 时间：2009-01-19T23:58:35.003
> 
> 标签：c#, arrays, collections, split, arraylist

C#，一个 String 的 Split() 方法，我如何将生成的 string[] 放入 ArrayList 或 Stack？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-20T00:00:13.097

`List<T>`您可以使用数组（或任何其他实现的对象）初始化 a `IEnumerable`。您应该更喜欢强类型`List<T>`而不是`ArrayList`.

```
var myList = new List<string>(myString.Split(',')); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T00:12:39.500

如果你想要一个可重用的方法，你可以编写一个扩展方法。

```
public static ArrayList ToArrayList(this IEnumerable enumerable) {  
  var list = new ArrayList;
  for ( var cur in enumerable ) {
    list.Add(cur);
  }
  return list;
}

public static Stack ToStack(this IEnumerable enumerable) {
  return new Stack(enumerable.ToArrayList());
}

var list = "hello wolrld".Split(' ').ToArrayList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T00:05:06.113

```
string[] strs = "Hello,You".Split(',');
ArrayList al = new ArrayList();
al.AddRange(strs); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T00:07:22.863

或者，如果您坚持使用 ArrayList 或 Stack

```
string myString = "1,2,3,4,5";
ArrayList al = new ArrayList(myString.Split(','));
Stack st = new Stack(myString.Split(',')); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-17T06:30:29.870

受保护的无效Button1_Click（对象发送者，EventArgs e）{

```
 TextBox1.Text = "Nitin Luhar";
            Array name=TextBox1.Text.Split(' ');
            foreach (string item in name)
            {
                for (int i = 0; i < item.Length; i++)
                {
                    if (i == 0)
                    {
                        Label1.Text = name.GetValue(0).ToString();
                    }
                    if (i == 1)
                    {
                        Label2.Text = name.GetValue(1).ToString();
                    }
                    if (i == 2)
                    {
                        Label3.Text = name.GetValue(2).ToString();
                    }

                }
            }

} 
```

# c - C中的最佳计时方法？

> ID：459691
> 
> 赞同：84
> 
> 时间：2009-01-20T00:06:29.903
> 
> 标签：c, performance, timer, timing

对具有高分辨率和可移植性的代码段进行计时的最佳方法是什么？

```
/* Time from here */
ProcessIntenseFunction();
/* to here. */

printf("Time taken %d seconds %d milliseconds", sec, msec); 
```

是否有具有跨平台解决方案的标准库？

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-01-20T00:15:52.037

我认为这应该有效：

```
#include <time.h>

clock_t start = clock(), diff;
ProcessIntenseFunction();
diff = clock() - start;

int msec = diff * 1000 / CLOCKS_PER_SEC;
printf("Time taken %d seconds %d milliseconds", msec/1000, msec%1000); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-20T01:26:05.670

gettimeofday() 可能会做你想做的事。

如果您使用的是 Intel 硬件，以下是读取 CPU 实时指令计数器的方法。它会告诉您自处理器启动以来执行的 CPU 周期数。这可能是您可以获得的用于性能测量的最细粒度、最低开销的计数器。

请注意，这是 CPU 周期数。在 linux 上，您可以从 /proc/cpuinfo 获取 CPU 速度，然后除以获取秒数。将其转换为双精度非常方便。

当我在我的盒子上运行它时，我得到

```
11867927879484732
11867927879692217
调用 printf 花了这么长时间：207485

```

这是提供大量详细信息的[英特尔开发人员指南。](http://cs.smu.ca/~jamuir/rdtscpm1.pdf)

```
#include <stdio.h>
#include <stdint.h>

inline uint64_t rdtsc() {
    uint32_t lo, hi;
    __asm__ __volatile__ (
      "xorl %%eax, %%eax\n"
      "cpuid\n"
      "rdtsc\n"
      : "=a" (lo), "=d" (hi)
      :
      : "%ebx", "%ecx");
    return (uint64_t)hi << 32 | lo;
}

main()
{
    unsigned long long x;
    unsigned long long y;
    x = rdtsc();
    printf("%lld\n",x);
    y = rdtsc();
    printf("%lld\n",y);
    printf("it took this long to call printf: %lld\n",y-x);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-20T00:16:38.743

[gettimeofday](http://www.opengroup.org/onlinepubs/000095399/functions/gettimeofday.html)将在系统时钟的分辨率内返回精确到微秒的时间。您可能还想查看 SourceForge 上的[高分辨率计时器](http://sourceforge.net/projects/high-res-timers/)项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T00:15:10.320

我使用[SDL 库](http://www.libsdl.org/)中的[SDL_GetTicks](http://www.libsdl.org/cgi/docwiki.cgi/SDL_GetTicks)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-08T04:54:51.890

如果您不想要 CPU 时间，那么我认为您正在寻找的是 timeval 结构。

我使用以下计算执行时间：

```
int timeval_subtract(struct timeval *result,                                                                                                                                        
                     struct timeval end,                                                                                                                                                 
                     struct timeval start)                                                                                                                                               
{                                                                                                                                                                                   
        if (start.tv_usec < end.tv_usec) {                                                                                                                                          
                int nsec = (end.tv_usec - start.tv_usec) / 1000000 + 1;                                                                                                             
                end.tv_usec -= 1000000 * nsec;                                                                                                                                      
                end.tv_sec += nsec;                                                                                                                                                 
        }                                                                                                                                                                           
        if (start.tv_usec - end.tv_usec > 1000000) {                                                                                                                                
                int nsec = (end.tv_usec - start.tv_usec) / 1000000;                                                                                                                 
                end.tv_usec += 1000000 * nsec;                                                                                                                                      
                end.tv_sec -= nsec;                                                                                                                                                 
        }                                                                                                                                                                           

        result->tv_sec = end.tv_sec - start.tv_sec;                                                                                                                                 
        result->tv_usec = end.tv_usec - start.tv_usec;                                                                                                                              

        return end.tv_sec < start.tv_sec;                                                                                                                                           
}                                                                                                                                                                                   

void set_exec_time(int end)                                                                                                                                                         
{                                                                                                                                                                                   
        static struct timeval time_start;                                                                                                                                           
        struct timeval time_end;                                                                                                                                                    
        struct timeval time_diff;                                                                                                                                                   

        if (end) {                                                                                                                                                                  
                gettimeofday(&time_end, NULL);                                                                                                                                      
                if (timeval_subtract(&time_diff, time_end, time_start) == 0) {                                                                                                      
                        if (end == 1)                                                                                                                                               
                                printf("\nexec time: %1.2fs\n",                                                                                                                     
                                        time_diff.tv_sec + (time_diff.tv_usec / 1000000.0f));                                                                                       
                        else if (end == 2)                                                                                                                                          
                                printf("%1.2fs",                                                                                                                                    
                                        time_diff.tv_sec + (time_diff.tv_usec / 1000000.0f));                                                                                       
                }                                                                                                                                                                   
                return;                                                                                                                                                             
        }                                                                                                                                                                           
        gettimeofday(&time_start, NULL);                                                                                                                                            
}                                                                                                                                                                                   

void start_exec_timer()                                                                                                                                                             
{                                                                                                                                                                                   
        set_exec_time(0);                                                                                                                                                           
}                                                                                                                                                                                   

void print_exec_timer()                                                                                                                                                             
{                                                                                                                                                                                   
        set_exec_time(1);                                                                                                                                                           
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T13:21:42.387

高分辨率是相对的......我正在查看示例，它们主要满足毫秒级的需求。但是对我来说，测量微秒很重要。我还没有看到微秒级独立于平台的解决方案，我认为下面的代码会很有用。我暂时只在 Windows 上计时，并且在 AIX/Linux 上执行相同操作时很可能会添加一个 gettimeofday() 实现。

```
 #ifdef WIN32
      #ifndef PERFTIME
        #include <windows.h>
        #include <winbase.h>
        #define PERFTIME_INIT unsigned __int64 freq;  QueryPerformanceFrequency((LARGE_INTEGER*)&freq); double timerFrequency = (1.0/freq);  unsigned __int64 startTime;  unsigned __int64 endTime;  double timeDifferenceInMilliseconds;
        #define PERFTIME_START QueryPerformanceCounter((LARGE_INTEGER *)&startTime);
        #define PERFTIME_END QueryPerformanceCounter((LARGE_INTEGER *)&endTime); timeDifferenceInMilliseconds = ((endTime-startTime) * timerFrequency);  printf("Timing %fms\n",timeDifferenceInMilliseconds);
    #define PERFTIME(funct) {unsigned __int64 freq;  QueryPerformanceFrequency((LARGE_INTEGER*)&freq);  double timerFrequency = (1.0/freq);  unsigned __int64 startTime;  QueryPerformanceCounter((LARGE_INTEGER *)&startTime);  unsigned __int64 endTime;  funct; QueryPerformanceCounter((LARGE_INTEGER *)&endTime);  double timeDifferenceInMilliseconds = ((endTime-startTime) * timerFrequency);  printf("Timing %fms\n",timeDifferenceInMilliseconds);}
      #endif
    #else
      //AIX/Linux gettimeofday() implementation here
    #endif 
```

用法：

```
PERFTIME(ProcessIntenseFunction());

or

PERFTIME_INIT
PERFTIME_START
ProcessIntenseFunction()
PERFTIME_END 
```

# c# - 是否有工具可以在 Visual Studio 中选择一些代码并让它显示相应的 MSIL？

> ID：459701
> 
> 赞同：6
> 
> 时间：2009-01-20T00:12:54.133
> 
> 标签：c#, .net, visual-studio, cil

最近我发现自己经常运行 ILDASM 来研究我的程序的 MSIL 输出。

是否有任何实用程序可以简化此操作？理想情况下，最好选择一些源代码并让它在 MSIL 中编译、反汇编和发出选定的 C# 代码。

有人知道这样的事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T00:16:26.013

[.NET 反射器](http://www.red-gate.com/products/reflector/)

我认为[RedGate](http://www.red-gate.com/)现在已经购买了这个工具的 IP。我相当确定有一个集成到它的 VS 插件，允许您从 vs. 运行它。

[.Net Reflector 插件](http://www.testdriven.net/reflector/) [（来源：][[mutantdesign.co.uk](http://www.mutantdesign.co.uk/reflector/TestWithReflector.gif)][）][![替代文字](https://i.stack.imgur.com/RJ7yT.gif)](https://i.stack.imgur.com/RJ7yT.gif)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T00:49:07.257

您可以使用[testdriven.net](http://www.testdriven.net/)一个很棒的单元测试插件，它使您能够右键单击任何成员并在反射器中查看它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:17:33.780

在反射器中打开.dll，选择任意类中的任意函数，选择IL作为反编译语言。我不认为您正在寻找比这更精细的级别。

# xml - DTD 问题（一个或另一个 [或两者]）

> ID：459707
> 
> 赞同：0
> 
> 时间：2009-01-20T00:16:37.400
> 
> 标签：xml, xsd, dtd

在我的任务中，我被分配了创建一个 DTD 来表示虚拟地理藏宝游戏的任务。

我在表示可以是 gps 或 wifi 或两者的位置时遇到问题，但不能超过一个。我将如何表示这一点？下面列出了我能想到的最接近的。

```
<!ELEMENT location ((gps|wifi)+)> 
```

完整的 DTD 在这里。

```
<!ELEMENT game (information, caches)>
    <!ELEMENT information (gameID, gameName, gameDescription, date, author)>
        <!ELEMENT gameID (#PCDATA)>
        <!ELEMENT gameName (#PCDATA)>
        <!ELEMENT gameDescription (#PCDATA)>
        <!ELEMENT date (#PCDATA)>
        <!ELEMENT author (#PCDATA)>
    <!ELEMENT caches (cache+)>
        <!ELEMENT cache (cacheID, cacheName, location, value)>
            <!ELEMENT cacheID (#PCDATA)>
            <!ELEMENT cacheName (#PCDATA)>
            <!ELEMENT location ((gps|wifi)+)>
                <!ELEMENT gps (longitude, latitude)>
                    <!ELEMENT latitude (#PCDATA)>
                    <!ELEMENT longitude (#PCDATA)>
                <!ELEMENT wifi (#PCDATA)>
            <!ELEMENT value (#PCDATA)> 
```

每个游戏都包含一些关于它的信息和一些缓存。

提前喝彩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T00:19:16.333

试试这个：

```
<!ELEMENT location ((gps|wifi|(gps,wifi)|(wifi,gps)))> 
```

# ruby - 无效的宝石格式

> ID：459709
> 
> 赞同：2
> 
> 时间：2009-01-20T00:16:45.857
> 
> 标签：ruby, rubygems, passenger, merb

在 Ruby Enterprise Edition (OS X) 上安装 Merb 会引发此错误，有什么想法吗？

```
sudo gem install merb

ERROR:  Error installing merb:
invalid gem format for /opt/ruby-enterprise-1.8.6-20090113/lib/ruby/gems/1.8/cache/ParseTree-3.0.2.gem 
```

删除了 gem 缓存，但问题仍然存在。它似乎设法安装了一些宝石。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T00:44:30.230

删除缓存（ruby-enterprise-1.8.6-20090113/lib/ruby/gems/1.8/cache/*）和有问题的gem文件夹似乎暂时有效，尽管现在我遇到了另一个依赖merb-action-args的问题。 .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-03T20:58:51.567

在我们的案例中，问题是宝石的 URL 被我们公司的 Web 内容过滤器 (Websense) 阻止。我在文本编辑器上打开 gem 文件，发现一个阻止页面消息而不是实际内容，所以我必须取消阻止 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-03T04:03:22.950

我找到了解决方案。基本上，每当安装/更新新的 gem 时，系统都会从 github 下载然后安装它。我们知道，在 github 上，gems 的工作始终在进行中。所以无论如何，格式不正确的 gem 都会被更新。

所以我的解决方案是从运行 rails 应用程序的任何服务器/系统下载 gem，然后安装它。

# asp.net - 重定向 w., ww., wwww. 到 -> www

> ID：459711
> 
> 赞同：2
> 
> 时间：2009-01-20T00:17:24.497
> 
> 标签：asp.net, http-status-code-301, global-asax, canonical-name

我正在尝试将 site.com w.site.com ww.site.com 和 wwww.site.com 重定向到 www.site.com。

我的老板想确保拼写错误也能出现在网站上。

他们重定向很好。我正在使用 ASP.Net 并使用正则表达式将 301 重定向返回，但是，当我尝试时， [http://www.seoconsultants.com/tools/headers.asp](http://www.seoconsultants.com/tools/headers.asp)等工具似乎没有显示正确的重定向使用 w.site.com ww。等等

我试图弄清楚谷歌看到了什么，但我不确定在哪里检查。

它会“出现”萤火虫将其报告为 301，但我无法弄清楚为什么这些工具会报告错误信息。我的老板正在使用网络工具来查看这些是否有效，所以有没有人知道一种方法来证明 301 被正确发送回来。或者任何人都可以推荐一种我可以检查自己是否返回正确的 301 的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T03:42:43.880

将*** A 记录**添加到您的 dns 条目。是的，这是一个星号。这将导致任何未明确定义的内容转到该 IP。

例如：*.site.com

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T01:01:49.447

如果您有权访问您的域注册商，则可以更改 CNAME 记录以指向正确的域。这与使用 DNS 设置子域相同，但在这种情况下 wwww 或 w 都指向您网站上的 www。从设计的角度来看，您还将重定向工作卸载到另一台服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T03:34:41.120

尝试使用 Firefox 的[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829)插件来检查服务器发回给您的标头。如果[Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829)报告 301 重定向，请尝试在服务器端捕获用户代理并[更改您的 Firefox 以使用该用户代理](https://addons.mozilla.org/en-US/firefox/addon/59)。如果您仍然收到 301 重定向，则必须更仔细地检查服务器，以查看来自 [SEO 顾问](http://www.seoconsultants.com/tools/headers.asp)的请求是否到达重定向周围的代码。

您也可以尝试使用 IIS 并添加一堆响应 w、ww 和 wwww 子域的重定向网站，而不是使用 global.asax 和重定向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T00:20:56.143

如果您有权访问 Unix 类型的框，则可以键入以下内容以查看返回的标题：

```
curl -I ww.site.com 
```

但如果我是你，我会相信 Firebug。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T00:44:55.037

可能会尝试使用[IIS](http://www.mcanerin.com/EN/articles/301-redirect-IIS.asp)来查看这是否会抑制 SEO 工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T01:57:05.390

使用[Fiddler](http://www.fiddlertool.com/fiddler/)直接查看从 Web 服务器发回的标头（还有更多 - Fiddler 是每个 Web 开发人员都应该拥有的工具，而且它是免费的）。

[Google 网站管理员工具](http://www.google.com/webmasters/tools/)将报告 Google 在抓取您的网站时遇到的 404 错误和其他错误。您还可以设置首选的规范域名格式（www.site.com 与 site.com）。

如果格式错误的链接实际上存在于 Google 会尝试抓取的某个位置，Google 只会“看到”您从格式错误的 URL （例如从 w.site.com 到 www.site.com）的重定向之一。我想你可以把一些测试链接放在你网站上不显眼的地方，检查谷歌网站管理员工具，看看谷歌在抓取这些测试链接时做了什么，然后当你对结果满意时删除测试链接。Google 的抓取是不确定的，因此您可能需要等待数周才能让 Google 抓取这些测试链接。

# ruby - 用于从字符串解析标签的正则表达式.. Flickr 风格

> ID：459713
> 
> 赞同：3
> 
> 时间：2009-01-20T00:17:38.100
> 
> 标签：ruby, regex, tagging

我想知道是否有人可以为我提供解析字符串所需的正则表达式，例如：

'foo bar "多字标签"'

进入标签数组，如：

["foo","bar","多字标签"]

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T01:19:58.083

在红宝石中

```
scan(/\"([\w ]+)\"|(\w+)/).flatten.compact 
```

例如

```
"foo bar \"multiple words\" party_like_1999".scan(/\"([\w ]+)\"|(\w+)/).flatten.compact
=> ["foo", "bar", "multiple words", "party_like_1999"] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T00:43:42.197

您可以实施扫描仪来执行此操作。例如，在 Python 中，它看起来像这样：

```
import re
scanner = re.Scanner([
    (r"[a-zA-Z_]\w*", lambda s,t:t),       # regular tag
    (r"\".*?\"",      lambda s,t:t[1:-1]), # multi-word-tag
    (r"\s+",          None),               # whitespace not in multi-word-tag
    ])
tags, _ = scanner.scan('foo bar "multiple word tag"')
print tags
# ['foo', 'bar', 'multiple word tag'] 
```

这称为词法分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T00:48:00.550

首先，我建议使用`split()`方法/函数而不是正则表达式来执行此操作。大多数语言都有这样的东西，您可以调用它来将字符串拆分为单词（由空格分隔），并且您通常可以指定要将其拆分为多少部分的上限。所以一般来说，

```
split('foo bar "multiple word tag"', ' ', 3) 
```

其中 3 表示不超过 3 个部分，适用于您的示例。您可以使用`trim()`or`strip()`方法/函数（或编写一个）来删除任何前导和尾随引号。

如果你打算用正则表达式来做，也许是因为每一行可能有可变数量的标签，在某种程度上它取决于你到底用什么来做解析，因为不同的正则表达式引擎有时有不同的方式代表相同的事物。而且我认为它不能仅用一个普通的旧正则表达式来完成。你需要一些代码来配合它。例如，这是一个使用 Perl 兼容的正则表达式（或类似的东西，无论如何）的（伪？）伪代码解决方案：

```
pos = 0;
while pos < length(string):
    # match(regular expression, string to search, starting position for the search)
    m = match(/\s*(".+?"|\S+)?\s*/, string, pos);
    tag = m.group(1).strip('"');
    # process the tag 
```

对于它的价值，我可能会使用 DFA（离散有限自动机）来执行此操作，它逐个字符地遍历字符串，将每个字符附加到缓冲区并在到达标记末尾时刷新缓冲区（或者是因为空格或右引号）。也许只有我一个人，但我觉得这是一个非常简单的解析任务，就 DFA 状态而言（在我看来）会更容易理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T00:49:40.190

适用于任何 match->array 函数的通用正则表达式：

```
(?<=")[^"]+|\w+ 
```

（如果不只允许使用字母数字和引号，使用`\S+`而不是`\w+`可能有意义。）

**红宝石示例：**

```
myarray = mystring.scan(/(?<=\")[^\"]+|\w+/) 
```

（未经测试）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T01:06:33.963

我们开始（Perl 风格）：

```
^(?:"([^"]*?)"|(\S+?)|\s*?)*$ 
```

解释：

```
^                    // from begginning                 
 (?:                  // non-capturing group of three alternatives
    "([^"]*?)"   // capture "tag"                                               "
 |
    (\S+?)        // capture tag
 |
    \s*?            // ignore whitespace
 )*                  
$                    // until the end of the line 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-20T00:35:59.203

正则表达式几乎肯定不会是您在这里寻找的解决方案。正则表达式可用于从较大的字符串中解析一组匹配的输入。例如，如果我只想从电子邮件地址中获取用户名，我可以使用以下正则表达式来获取数据

```
"^(?<username>[\w\d]+)@.*$" 
```

该名称将出现在名称组“用户名”中

在您的情况下，您并没有尝试获取输入字符串的子集。您正在尝试匹配整个字符串的元素。在一天结束时，正则表达式只会说“是的，它匹配”或“不，它不匹配”。为了获取内容，您需要实际解析出字符串。

# asp.net - 将多个电子邮件地址与 ASP.NET MembershipProvider 帐户相关联

> ID：459722
> 
> 赞同：1
> 
> 时间：2009-01-20T00:22:23.787
> 
> 标签：asp.net, email, asp.net-membership, membership-provider

对于我目前正在进行的一个项目，我有兴趣允许用户提供多个电子邮件地址，既用于联系目的，也可以提供基于地址簿的社交匹配。我计划编写一个自定义会员提供程序（aspnet_Membership 表对我来说太重了），但是 MembershipProvider 系统只允许每个帐户一个电子邮件地址。

使用会员提供商系统但允许每个用户有多个电子邮件地址的最佳想法是什么？还是我应该完全避免 MembershipProvider 并推出自己的系统？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T02:23:43.463

你当然可以做到这一点。除了编写自定义 MembershipProvider 类之外，您还需要从[MembershipUser](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx)创建一个派生类来保存额外的电子邮件地址字段。[此处提供了](http://msdn.microsoft.com/en-us/library/ms366730(VS.80).aspx)有关如何执行此操作的说明。

# haskell - 如何减少 Haskell 应用程序中的内存使用量？

> ID：459725
> 
> 赞同：34
> 
> 时间：2009-01-20T00:23:50.007
> 
> 标签：haskell, functional-programming, garbage-collection, memory-management, lazy-evaluation

我是函数式编程的新手，现在学习 Haskell。作为练习，我决定为一维线性扩散方程实施显式欧拉方法。虽然下面的代码可以正常工作，但我对它的性能并不满意。事实上，我关心的是内存消耗。我相信它与惰性评估有关，但无法弄清楚如何减少它的内存使用量。

该算法的思想非常简单，用命令式的术语来说清楚：它需要一个“数组”，并为每个内部点添加一个值，该值是由点本身和它的值的组合计算得出的。邻居。边界点是特殊情况。

所以，这是我的 Euler1D.hs 模块：

```
module Euler1D
( stepEuler
, makeu0
) where

-- impose zero flux condition
zeroflux :: (Floating a) => a -> [a] -> [a]
zeroflux mu (boundary:inner:xs) = [boundary+mu*2*(inner-boundary)]

-- one step of integration
stepEuler :: (Floating a) => a -> [a] -> [a]
stepEuler mu u@(x:xs) = (applyBC . (diffused mu)) u
    where
          diffused mu (left:x:[]) = []    -- ignore outer points
          diffused mu (left:x:right:xs) = -- integrate inner points
                   (x+mu*(left+right-2*x)) : diffused mu (x:right:xs)
          applyBC inner = (lbc u') ++ inner ++ (rbc u') -- boundary conditions
               where u' = [head u] ++ inner ++ [last u]
                     lbc = zeroflux mu             -- left boundary
                     rbc = (zeroflux mu) . reverse -- right boundary

-- initial condition
makeu0 :: Int -> [Double]
makeu0 n = [ ((^2) . sin . (pi*) . xi) x | x <- [0..n]]
    where xi x = fromIntegral x / fromIntegral n 
```

还有一个简单的 Main.hs：

```
module Main where

import System ( getArgs )
import Euler1D

main = do
      args <- getArgs
      let n = read $ head args :: Int
      let u0 = makeu0 n
      let un = stepEuler 0.5 u0
      putStrLn $ show $ sum un 
```

为了比较，我还写[了一个纯 C 实现](http://pastebin.com/f741f87c9)。

现在，如果我尝试为足够大的数组运行 Haskell 实现`n`，我有：

```
$ time ./eulerhs 200000
100000.00000000112

real    0m3.552s
user    0m3.304s
sys     0m0.128s 
```

相比之下，C 版本快了近两个数量级：

```
$ time ./eulerc 200000
100000

real    0m0.088s
user    0m0.048s
sys     0m0.008s 
```

> *编辑*：这种比较并不公平，因为 Haskell 版本是使用分析标志编译的，而 C 不是。如果我编译两个程序都带有`-O2`和不带分析标志，我可以增加`n`. 在这种情况下`time ./eulerhs 1000000`需要 0m2.236s，而`time ./eulerc 1000000`只需要 0m0.293s。所以问题仍然存在于所有优化中并且没有分析，它只是偏移。
> 
> 我还想指出，Haskell 程序的内存分配似乎与`n`. 这可能没问题。

但最糟糕的是内存要求。我的 Haskell 版本需要**超过 100MB**（我估计 C 中的最低限度是**4MB**）。我认为这可能是问题的根源。根据分析报告，该程序在 GC 上花费了 85% 的时间，并且

```
 total time  =        0.36 secs   (18 ticks @ 20 ms)
        total alloc = 116,835,180 bytes  (excludes profiling overheads)

COST CENTRE                    MODULE               %time %alloc

makeu0                         Euler1D               61.1   34.9
stepEuler                      Euler1D               33.3   59.6
CAF:sum                        Main                   5.6    5.5 
```

看到这么贵，我*很*`makeu0`惊讶。我认为这是由于它的惰性评估（如果它的 thunk 保留在内存中直到结束）。*`stepEuler`*

 *我尝试了以下更改`Main.hs`：

```
 let un = u0 `seq` stepEuler 0.5 u0 
```

但没有注意到任何区别。我不知道如何减少`stepEuler`. 所以，我的问题是：

1.  Haskell 有没有办法严格地构建列表/做列表推导？在这种情况下，让它保持懒惰没有任何好处。
2.  在这种情况下，如何减少总体内存使用量？我想，我必须做一些严格的事情，但看不到是什么。换句话说，如果我必须放一些`seq`s和刘海，在哪里以及为什么？
3.  最后，最重要的是，识别这种昂贵结构的最佳策略是什么？

[我确实在Real World Haskell](http://book.realworldhaskell.org/read/profiling-and-optimization.html)中阅读了有关分析和优化的一章，但目前尚不清楚我如何准确地决定什么应该严格，什么不应该。

请原谅我这么长的帖子。

> *EDIT2*：正如 A. Rex 在评论中所建议的那样，我尝试在 valgrind 中运行这两个程序。这就是我观察到的。对于 Haskell 程序（`n`=200000），它发现：
> 
> > malloc/free：33 次分配，30 次释放，分配了 84,109 字节。...检查了 55,712,980 个字节。
> 
> 对于 C 程序（经过小修复）：
> 
> > malloc/free：2 次分配，2 次释放，分配了 3,200,000 字节。
> 
> 因此，看起来虽然 Haskell 分配了小得多的内存块，但它经常这样做，并且由于垃圾收集的延迟，它们会累积并保留在内存中。所以，我还有一个问题：
> 
> *   是否有可能在 Haskell 中避免大量的小分配？基本上，要声明，我需要处理整个数据结构，而不仅仅是按需处理它的片段。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-22T09:38:18.513

1.  列表不是此类代码的最佳数据结构（有很多 (++) 和 (last)）。你会浪费很多时间来构建和解构列表。我会使用 Data.Sequence 或数组，就像在 C 版本中一样。

2.  没有机会对 makeu0 的 thunk 进行垃圾收集，因为您需要一直保留所有这些（准确地说，是“扩散”的所有结果）直到计算结束才能成为能够在 applyBC 中做“反向”。这是非常昂贵的事情，考虑到您的“zeroflux”只需要列表尾部的两个项目。

这是您的代码的快速破解，它试图实现更好的列表融合并减少列表（de）构造：

```
module Euler1D
( stepEuler
) where

-- impose zero flux condition
zeroflux mu (boundary:inner:xs) = boundary+mu*2*(inner-boundary)

-- one step of integration
stepEuler mu n = (applyBC . (diffused mu)) $ makeu0 n
    where
          diffused mu (left:x:[]) = []    -- ignore outer points
          diffused mu (left:x:right:xs) = -- integrate inner points
                   let y = (x+mu*(left+right-2*x))
                       in y `seq` y : diffused mu (x:right:xs)
          applyBC inner = lbc + sum inner + rbc -- boundary conditions
               where
                     lbc = zeroflux mu ((f 0 n):inner)             -- left boundary
                     rbc = zeroflux mu ((f n n):(take 2 $ reverse inner)) -- right boundary

-- initial condition
makeu0 n = [ f x n | x <- [0..n]]

f x n = ((^2) . sin . (pi*) . xi) x
    where xi x = fromIntegral x / fromIntegral n 
```

对于 200000 点，它在 0.8 秒内完成，而初始版本为 3.8 秒

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-06T08:44:15.107

在我的 32 位 x86 系统上，您的程序仅使用大约 40 MB 的内存。

您是否可能将分析输出中的“total alloc = 116,835,180 字节”行与程序在任何时候实际使用的内存量混淆了？total alloc 是在整个程序运行过程中分配了多少内存；随着您的进行，垃圾收集器会释放其中的大部分内容。你可以期望这个数字在 Haskell 程序中会变得非常大。我有一些程序在整个运行过程中分配了许多 TB 的内存，尽管它们实际上最大的虚拟内存大小为 100 MB 左右。

我不会太担心程序运行过程中的大量总分配；这是纯语言的本质，而 GHC 的运行时有一个非常好的垃圾收集器来帮助弥补这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-31T15:41:37.263

[更一般地说，您可以使用GHC 的堆分析工具](https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html)找出内存的去向。以我的经验，他们不一定会告诉您数据泄露的原因，但至少可以缩小潜在原因的范围。

您还可能会发现这篇[由 Don Stewart 撰写的](https://donsbot.wordpress.com/2008/05/06/write-haskell-as-fast-as-c-exploiting-strictness-laziness-and-recursion/)关于理解严格性、它如何与垃圾收集交互以及如何诊断和修复问题的优秀博文对您有所启发。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T06:08:13.073

是否使用 $! 强制“不懒惰”？帮助？按照[这个答案](https://stackoverflow.com/questions/412919/how-haskell-tail-recursion-works)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T06:29:39.597

根据 Harleqin 的要求：您是否尝试过设置优化标志？例如，使用 ghc，您可以像使用 gcc 一样使用添加“-O2”。（虽然我不确定 ghc 中存在哪些优化级别；手册页并没有准确地说......）

根据我过去的经验，设置此标志会产生*巨大*的影响。据我所知，`runhugs`未优化`ghc`使用 Haskell 最基本、最明显的实现；不幸的是，这有时效率不高。

但这只是一个猜测。正如我在评论中所说，我希望有人能很好地回答你的问题。我经常在分析和修复 Haskell 的内存使用时遇到问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T13:27:57.383

也使用开关`-fvia-C`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T09:40:45.017

现在让我眼前一亮的一件事是 Haskell 输出是浮点数，而 C 输出似乎是整数。我还没有掌握 Haskell 代码，但也许有一些地方你在 Haskell 中有浮点运算，而 C 使用整数？

# android - 如何在 Android 的 ListView 中显示图像列表？

> ID：459729
> 
> 赞同：69
> 
> 时间：2009-01-20T00:24:56.683
> 
> 标签：android, listview, android-image

如何使用 ListView 显示图像列表？我在运行时下载图像。图像的总数不固定。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-20T11:36:34.440

我会从这样的事情开始（如果我的代码有问题，我当然会感谢任何评论）：

```
public class ItemsList extends ListActivity {

private ItemsAdapter adapter;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.items_list);

    this.adapter = new ItemsAdapter(this, R.layout.items_list_item, ItemManager.getLoadedItems());
    setListAdapter(this.adapter);
}

private class ItemsAdapter extends ArrayAdapter<Item> {

    private Item[] items;

    public ItemsAdapter(Context context, int textViewResourceId, Item[] items) {
        super(context, textViewResourceId, items);
        this.items = items;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.items_list_item, null);
        }

        Item it = items[position];
        if (it != null) {
            ImageView iv = (ImageView) v.findViewById(R.id.list_item_image);
            if (iv != null) {
                iv.setImageDrawable(it.getImage());
            }
        }

        return v;
    }
}

@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    this.adapter.getItem(position).click(this.getApplicationContext());
}
} 
```

例如，使用自己的 Items 类型（保存有关您的图片的信息）和重写`getView()`方法扩展 ArrayAdapter，为列表中的项目准备视图。ArrayAdapter 上还有一种方法`add()`可以将项目添加到列表的末尾。

`R.layout.items_list`是简单的布局`ListView`

`R.layout.items_list_item`是表示列表中一项的布局

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-04T11:46:58.670

```
 package studRecords.one;

 import java.util.List;
 import java.util.Vector;

 import android.app.Activity;
 import android.app.ListActivity;
 import android.content.Context;
 import android.content.Intent;
 import android.net.ParseException;
 import android.os.Bundle;
 import android.view.LayoutInflater;
 import android.view.View;
 import android.view.ViewGroup;
 import android.widget.ArrayAdapter;
 import android.widget.ImageView;
 import android.widget.ListView;
 import android.widget.TextView;

public class studRecords extends ListActivity 
{
static String listName = "";
static String listUsn = "";
static Integer images;
private LayoutInflater layoutx;
private Vector<RowData> listValue;
RowData rd;

static final String[] names = new String[]
{
      "Name (Stud1)", "Name (Stud2)",   
      "Name (Stud3)","Name (Stud4)" 
};

static final String[] usn = new String[]
{
      "1PI08CS016","1PI08CS007","1PI08CS017","1PI08CS047"
};

private Integer[] imgid = 
{
  R.drawable.stud1,R.drawable.stud2,R.drawable.stud3,
  R.drawable.stud4
};

public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mainlist);

    layoutx = (LayoutInflater) getSystemService(
    Activity.LAYOUT_INFLATER_SERVICE);
    listValue = new Vector<RowData>();
    for(int i=0;i<names.length;i++)
    {
        try
        {
            rd = new RowData(names[i],usn[i],i);
        } 
        catch (ParseException e) 
        {
            e.printStackTrace();
        }
        listValue.add(rd);
    }

   CustomAdapter adapter = new CustomAdapter(this, R.layout.list,
                                     R.id.detail, listValue);
   setListAdapter(adapter);
   getListView().setTextFilterEnabled(true);
}
   public void onListItemClick(ListView parent, View v, int position,long id)
   {            

       listName = names[position];
       listUsn = usn[position];
       images = imgid[position];

       Intent myIntent = new Intent();
       Intent setClassName = myIntent.setClassName("studRecords.one","studRecords.one.nextList");
       startActivity(myIntent);

   }
   private class RowData
   {

       protected String mNames;
       protected String mUsn;
       protected int mId;
       RowData(String title,String detail,int id){
       mId=id;
       mNames = title;
       mUsn = detail;
    }
       @Override
    public String toString()
       {
               return mNames+" "+mUsn+" "+mId;
       }
  }

              private class CustomAdapter extends ArrayAdapter<RowData> 
          {
      public CustomAdapter(Context context, int resource,
      int textViewResourceId, List<RowData> objects)
      {               
            super(context, resource, textViewResourceId, objects);
      }
      @Override
      public View getView(int position, View convertView, ViewGroup parent)
      {   
           ViewHolder holder = null;
           TextView title = null;
           TextView detail = null;
           ImageView i11=null;
           RowData rowData= getItem(position);
           if(null == convertView)
           {
                convertView = layoutx.inflate(R.layout.list, null);
                holder = new ViewHolder(convertView);
                convertView.setTag(holder);
           }
         holder = (ViewHolder) convertView.getTag();
         i11=holder.getImage();
         i11.setImageResource(imgid[rowData.mId]);
         title = holder.gettitle();
         title.setText(rowData.mNames);
         detail = holder.getdetail();
         detail.setText(rowData.mUsn);                                                     

         return convertView;
      }

        private class ViewHolder 
        {
            private View mRow;
            private TextView title = null;
            private TextView detail = null;
            private ImageView i11=null; 
            public ViewHolder(View row)
            {
                    mRow = row;
            }
            public TextView gettitle()
            {
                 if(null == title)
                 {
                     title = (TextView) mRow.findViewById(R.id.title);
                 }
                 return title;
            }     
            public TextView getdetail()
            {
                if(null == detail)
                {
                    detail = (TextView) mRow.findViewById(R.id.detail);
                }
                return detail;
            }
            public ImageView getImage()
            {
                    if(null == i11)
                    {
                        i11 = (ImageView) mRow.findViewById(R.id.img);
                    }
                    return i11;
            }   
        }
   } 
 } 
```

//mainlist.xml

```
 <?xml version="1.0" encoding="utf-8"?>
             <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                 android:orientation="horizontal"
                 android:layout_width="fill_parent"
                 android:layout_height="fill_parent"
             >
             <ListView
                 android:id="@android:id/list"
                 android:layout_width="fill_parent"
                 android:layout_height="wrap_content"
              />
             </LinearLayout> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-11T13:52:34.907

这是带有不同图像的简单 ListView。首先，您必须复制不同类型的图像并将其粘贴到项目中的 res/drawable-hdpi 中。图片应为 (.png) 文件格式。然后复制此代码。

在 main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
   xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:orientation="vertical" >

  <TextView
      android:id="@+id/textview"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content" />

 <ListView
     android:id="@+id/listview"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content" /> 
```

创建 listview_layout.xml 并粘贴此代码

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

   <ImageView
      android:id="@+id/flag"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:contentDescription="@string/hello"
      android:paddingTop="10dp"
      android:paddingRight="10dp"
      android:paddingBottom="10dp" />

   <LinearLayout
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:orientation="vertical" >

     <TextView
        android:id="@+id/txt"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="15dp"
        android:text="TextView1" />

    <TextView
        android:id="@+id/cur"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="10dp"
        android:text="TextView2" />
   </LinearLayout> 
```

在您的活动中

```
package com.test;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import android.app.Activity;
import android.os.Bundle;
import android.widget.ListView;
import android.widget.SimpleAdapter;

public class SimpleListImageActivity extends Activity {

    // Array of strings storing country names
    String[] countries = new String[] {
        "India",
        "Pakistan",
        "Sri Lanka",
        "China",
        "Bangladesh",
        "Nepal",
        "Afghanistan",
        "North Korea",
        "South Korea",
        "Japan"
    };

    // Array of integers points to images stored in /res/drawable-hdpi/

   //here you have to give image name which you already pasted it in /res/drawable-hdpi/

     int[] flags = new int[]{
        R.drawable.image1,
        R.drawable.image2,   
        R.drawable.image3,
        R.drawable.image4,
        R.drawable.image5,
        R.drawable.image6,
        R.drawable.image7,
        R.drawable.image8,
        R.drawable.image9,
        R.drawable.image10,
    };

    // Array of strings to store currencies
    String[] currency = new String[]{
        "Indian Rupee",
        "Pakistani Rupee",
        "Sri Lankan Rupee",
        "Renminbi",
        "Bangladeshi Taka",
        "Nepalese Rupee",
        "Afghani",
        "North Korean Won",
        "South Korean Won",
        "Japanese Yen"
    };

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // Each row in the list stores country name, currency and flag
        List<HashMap<String,String>> aList = new ArrayList<HashMap<String,String>>();

        for(int i=0;i<10;i++){
            HashMap<String, String> hm = new HashMap<String,String>();
            hm.put("txt", "Country : " + countries[i]);
            hm.put("cur","Currency : " + currency[i]);
            hm.put("flag", Integer.toString(flags[i]) );
            aList.add(hm);
        }

        // Keys used in Hashmap
        String[] from = { "flag","txt","cur" };

        // Ids of views in listview_layout
        int[] to = { R.id.flag,R.id.txt,R.id.cur};

        // Instantiating an adapter to store each items
        // R.layout.listview_layout defines the layout of each item
        SimpleAdapter adapter = new SimpleAdapter(getBaseContext(), aList, R.layout.listview_layout, from, to);

        // Getting a reference to listview of main.xml layout file
        ListView listView = ( ListView ) findViewById(R.id.listview);

        // Setting the adapter to the listView
        listView.setAdapter(adapter);
    }
} 
```

这是完整的代码。您可以根据需要进行更改...欢迎评论

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-16T09:40:34.800

六年过去了，这仍然是一些搜索的顶部。从那以后，情况发生了很大变化。现在，事实上的标准或多或少是使用 [Volley](https://developer.android.com/training/volley/)和 NetworkImageView 来为您处理繁重的工作。

假设您已经正确设置了 Apaters、Loaders 和 ListFragments，这个[谷歌官方教程](https://developer.android.com/training/volley/request.html)解释了如何使用 NetworkImageView 来加载图像。图像在后台线程中自动加载，视图在 UI 线程中更新。它甚至支持缓存。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-11T13:27:30.330

我想出了一个我称之为“BatchImageDownloader”的解决方案，效果很好。以下是如何使用它的快速摘要：

*   保留一个全局 HashMap（最好在您的 Application 对象中）用作可绘制对象的缓存

*   在 List Adapter 的 getView() 方法中，使用缓存中的 drawable 来填充列表项中的 ImageView。

*   创建 BatchImageDownloader 的实例，传入您的 ListView 适配器

*   为需要获取/显示的每个图像调用 addUrl()

*   完成后，调用execute()。这会触发一个获取所有图像的 AsyncTask，并且随着每个图像被获取并添加到缓存中，它会刷新您的 ListView（通过调用 notifyDataSetChanged()）

该方法具有以下优点：

*   单个工作线程用于获取所有图像，而不是每个图像/视图的单独线程
*   获取图像后，所有使用它的列表项都会立即更新
*   代码不会直接访问列表项中的图像视图——而是通过在列表适配器上调用 notifyDataSetChanged() 来触发列表视图刷新，而 getView() 实现只是从缓存中提取可绘制对象并显示它。这避免了与 ListViews 中使用的回收 View 对象相关的问题。

这是 BatchImageDownloader 的源代码：

```
package com.mobrite.androidutils;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.graphics.drawable.Drawable;
import android.os.AsyncTask;
import android.widget.BaseAdapter;

public class BatchImageDownloader extends AsyncTask<Void, Void, Void> {

    List<String> imgUrls = new ArrayList<String>();
    BaseAdapter adapter;
    HashMap<String, Drawable> imageCache;

    public BatchImageDownloader(BaseAdapter adapter,
            HashMap<String, Drawable> imageCache) {
        this.adapter = adapter;
        this.imageCache = imageCache;
    }

    public void addUrl(String url) {
        imgUrls.add(url);
    }

    @Override
    protected Void doInBackground(Void... params) {
        for (String url : imgUrls) {
            if (!imageCache.containsKey(url)) {
                Drawable bm = downloadImage(url);
                if (null != bm) {
                    imageCache.put(url, bm);
                    publishProgress();
                }
            }
        }
        return null;
    }

    @Override
    protected void onProgressUpdate(Void... values) {
        adapter.notifyDataSetChanged();
    }

    @Override
    protected void onPostExecute(Void result) {
        adapter.notifyDataSetChanged();
    }

    public Drawable downloadImage(String url) {

        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpGet request = new HttpGet(url);
        try {
            HttpResponse response = httpClient.execute(request);
            InputStream stream = response.getEntity().getContent();
            Drawable drawable = Drawable.createFromStream(stream, "src");
            return drawable;
        } catch (ClientProtocolException e) {
            e.printStackTrace();
            return null;
        } catch (IllegalStateException e) {
            e.printStackTrace();
            return null;
        } catch (IOException e) {
            e.printStackTrace();
            return null;
        }

    }

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-29T12:17:38.250

要从数据库中获取数据，您可以使用`SimpleCursorAdapter`.

我认为您可以直接将 绑定`SimpleCursorAdapter`到- 如果没有，您可以创建一个自定义适配器类，该适配器类使用覆盖`ListView`的自定义扩展 SimpleCursorAdapter 。[`ViewBinder`](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.ViewBinder.html)`setViewValue`

查看[记事本](http://developer.android.com/guide/tutorials/notepad/index.html)教程以了解如何使用`SimpleCursorAdapter`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-24T21:33:34.757

文件名应与布局 id 匹配，在此示例中为：应用程序布局文件夹中的 items_list_item.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    >  

<ImageView android:id="@+id/R.id.list_item_image"
  android:layout_width="100dip"
  android:layout_height="wrap_content" />  
</LinearLayout> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-22T05:12:05.383

我们需要实现两种布局。一个保存列表视图，另一个保存列表视图的行项。实现您自己的自定义适配器。想法是包括一个文本视图和一个图像视图。

```
public View getView(int position, View convertView, ViewGroup parent) {
 // TODO Auto-generated method stub
 LayoutInflater inflater = (LayoutInflater) context
 .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
 View single_row = inflater.inflate(R.layout.list_row, null,
 true);
 TextView textView = (TextView) single_row.findViewById(R.id.textView);
 ImageView imageView = (ImageView) single_row.findViewById(R.id.imageView);
 textView.setText(color_names[position]);
 imageView.setImageResource(image_id[position]);
 return single_row; 
 } 
```

接下来，我们在主要活动中实现功能，以在运行时动态包含图像和文本数据。您可以将动态创建的文本数组和图像 id 数组传递给自定义适配器的构造函数。

```
Customlistadapter adapter = new Customlistadapter(this, image_id, text_name); 
```

# windows - 有没有办法在 Windows 中制作可自我更新的可执行文件？

> ID：459734
> 
> 赞同：5
> 
> 时间：2009-01-20T00:26:19.253
> 
> 标签：windows

我想生成一个可执行文件，它可以在加载之前进行更新验证，然后，如果有一些更新，我希望它替换它的文件，然后重新加载。

我认为这比分离“更新程序”exe更好，因为如果必须更新更新程序怎么办？

我不可能在网络中拥有共享文件夹。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T00:39:56.183

可执行文件无法替换自己的文件，但它可以将新的 Exe 下载到同一目录中的已知位置或文件名，然后在退出时启动切换文件的进程，以便*下次*更新时运行。

如果您考虑一下，无论如何这是一种更好的方法，因为您无法确定文件下载是否会完成。即使可以，您真的想让用户等到下载完成吗？不...最好让下载在后台运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T01:31:41.320

[https://stackoverflow.com/questions/264788/can-i-update-a-exe-that-is-running-closed](https://stackoverflow.com/questions/264788/can-i-update-a-exe-that-is-running-closed)

是的，您可以让 exe 文件自行下载。只需将正在运行的 exe 重命名为 .bak，将新的 exe 下载为 .exe，然后重新启动应用程序。

这里的关键是你不能在程序运行时下载新版本而不是旧版本，解决方法是你可以重命名正在运行的exe，然后下载与重命名之前运行的exe同名的新版本. 然后它只是对下载的 exe:s 大小的验证和程序的重新启动，您就可以启动并运行了！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:39:15.843

如果您正在做一个 .NET 应用程序并且需要一些简单的东西。微软一[键部署](http://msdn.microsoft.com/en-us/library/t71a733d(VS.80).aspx)这可以满足您的需求。在使用 ClickOnce 部署之前，我开发了一个基本的更新程序。执行发生了，当程序启动时，它在后台线程上检查文件的新版本。如果有可用的更新，它将在该后台线程上下载。如果更新是针对更新程序可执行文件的，那么我将替换该可执行文件。否则，我会通知用户已准备好安装更新。他们将保存他们的工作并单击更新按钮。这将运行替换文件并重新启动程序的更新程序可执行文件。它非常简单，但没有很好地进行增量更新或版本控制。我还提供了回滚功能，以便保留被替换的文件，以防用户想要回滚到以前的版本。我没有保留版本的历史记录。相反，我认为最后一个版本是一个好版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T00:40:14.997

如果您使用的是 .NET Framework，我强烈推荐 ClickOnce。它可以设置为在每次执行时执行更新。

可以说，有几种方法可以让 ClickOnce 更新更新。这些天我会写一篇关于它的博客文章。我们的想法是让更新正常运行，但是当您的应用程序启动时会显示一个更新已更改的对话框，然后将用户重定向到下载并再次安装 exe。发送关键命令可以使该过程自动化。

# javascript - RoR：单个：onclick 上的多个 remote_function 调用

> ID：459737
> 
> 赞同：2
> 
> 时间：2009-01-20T00:27:30.343
> 
> 标签：javascript, ruby-on-rails, ajax, rjs

当用户单击按钮时，我想执行两种不同的方法。我让它们分开工作，但是当我尝试将两者结合起来时，我得到了错误。我目前拥有的两个是

```
 <%= image_tag('go_button.png',
                :id => "search_go_button",
                :class => "search_go_button",
                :onmouseover => "this.style.cursor='pointer';",
                :onmouseout => "this.style.cursor='default';",
                :onclick => "if ($(\"input_search_field\").value!=\"\" && $(\"input_search_field\").value!=\"Search Places\") {#{
                remote_function(:update => "right_nav;",
                :url => { :action => :search_places },
                :with => "'search_text='+$('input_search_field').value+'&search_radius='+$('radius').innerHTML",
                :before => "Element.show('search_spinner'); Element.hide('search_go_button');",
                :success => "Element.hide('search_spinner'); Element.show('search_go_button');")
                }}") %> 
```

和

```
 :onclick => "collapse_reset(this); new Ajax.Request('/places/search/#{cat.id}?search_radius='+$('radius').innerHTML,{asynchronous:true, evalScripts:true}); {#{remote_function(
              :update => "localads;", 
              :url => { :action => :get_ads, 
                        :id => cat.id }, 
              :before => "Element.show('ad_search_spinner'); Element.show('ad_search_spinner1'); Element.show('ad_search_spinner2'); Element.hide('ad1'); Element.hide('ad2'); Element.hide('ad3'); if($('ad1_slide_down_wrap').style.display != 'none'){$('ad1_slide_down_wrap').style.display = 'none';} if($('ad2_slide_down_wrap').style.display != 'none'){$('ad2_slide_down_wrap').style.display = 'none';} if($('ad3_slide_down_wrap').style.display != 'none'){$('ad3_slide_down_wrap').style.display = 'none';}", 
              :success => "Element.hide('ad_search_spinner'); Element.hide('ad_search_spinner1'); Element.hide('ad_search_spinner2'); Element.show('ad1'); Element.show('ad2'); Element.show('ad3');") }}", 
              :href => "/places/navigate/#{cat.id}" } %> 
```

我基本上想将功能从底部添加到顶部。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T02:23:11.640

本着 UJS 的精神（即使您在这里没有提供非 javascript 功能，您也可以从 erb 中分离 javascript 中受益），我会使用[Low Pro](http://www.danwebb.net/2006/9/3/low-pro-unobtrusive-scripting-for-prototype)并将这些设置为行为。您需要先下载并包含 lowpro.js 文件。

在您的 .erb 中，您只需拥有图像标签：

```
<%= image_tag('go_button.png', 
              :id => "search_go_button", 
              :class => "search_go_button") %> 
```

在包含的 .js 文件中，您可能有如下内容：

```
Event.addBehavior({
  '#search_go_button:click' : function(e) {
    // stuff you want to have happen in response to a click
  },

  '#search_go_button:mouseover' : function(e) {
    // stuff you want to have happen in response to a mouseover
  },

  '#search_go_button:mouseout' : function(e) {
    // stuff you want to have happen in response to a mouseout
  }

}); 
```

我们将它用于我们的所有行为，它使代码更易于使用和管理。

如果您需要帮助整理 AJAX 调用，请发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T09:52:15.677

一种（快速）方法是尝试封装这样的函数：

```
<script type="text/javascript">
function f1() {
if ($(\"input_search_field\").value!=\"\" && $(\"input_search_field\").value!=\"Search Places\") {#{
            <%= remote_function(:update => "right_nav;",
            :url => { :action => :search_places },
            :with => "'search_text='+$('input_search_field').value+'&search_radius='+$('radius').innerHTML",
            :before => "Element.show('search_spinner'); Element.hide('search_go_button');",
            :success => "Element.hide('search_spinner'); Element.show('search_go_button');")
            }} %>

}
function f2() {
    collapse_reset(this); new Ajax.Request('/places/search/#{cat.id}?search_radius='+$('radius').innerHTML,{asynchronous:true, evalScripts:true}); {#{ <%= remote_function(
          :update => "localads;", 
          :url => { :action => :get_ads, 
                    :id => cat.id }, 
          :before => "Element.show('ad_search_spinner'); Element.show('ad_search_spinner1'); Element.show('ad_search_spinner2'); Element.hide('ad1'); Element.hide('ad2'); Element.hide('ad3'); if($('ad1_slide_down_wrap').style.display != 'none'){$('ad1_slide_down_wrap').style.display = 'none';} if($('ad2_slide_down_wrap').style.display != 'none'){$('ad2_slide_down_wrap').style.display = 'none';} if($('ad3_slide_down_wrap').style.display != 'none'){$('ad3_slide_down_wrap').style.display = 'none';}", 
          :success => "Element.hide('ad_search_spinner'); Element.hide('ad_search_spinner1'); Element.hide('ad_search_spinner2'); Element.show('ad1'); Element.show('ad2'); Element.show('ad3');") }}", 
          :href => "/places/navigate/#{cat.id}" } %>
</script> 
```

和：

```
 <%= image_tag('go_button.png',
            :id => "search_go_button",
            :class => "search_go_button",
            :onmouseover => "this.style.cursor='pointer';",
            :onmouseout => "this.style.cursor='default';",
            :onclick => "f1();f2();" %> 
```

也许您需要将变量传递给函数，但这应该可以

# wpf - WPF 线程 - 有人可以解释这里发生了什么吗？

> ID：459739
> 
> 赞同：1
> 
> 时间：2009-01-20T00:29:21.760
> 
> 标签：wpf, multithreading

免责声明：以下代码不是我在实际应用程序中使用过的。我偶然发现了这个问题，并想知道幕后发生了什么。

让我们假设出于某种疯狂的原因，我们有以下代码......

```
using (System.Net.WebClient webClient = new System.Net.WebClient())
{
    bool done = false;
    webClient.UploadFileCompleted += (s, e) => done = true;

    string uploadUri = "ftp://www.notarealurl.com/";
    string file = @"temp.txt";

    webClient.UploadFileAsync(
        new Uri("ftp://www.notarealurl.com/"), "temp.txt");

    while (!done)
    {
        System.Threading.Thread.Sleep(100);
    }
} 
```

此代码在简单的控制台应用程序中按预期工作。但是，将其移至 WPF 应用程序，它永远不会退出“while”循环。这通过我循环了一段时间，直到我意识到这可能是事件被丢弃在消息泵中并且因此未被处理的问题。为了测试这一点，我修改了这样的“while”循环......

```
while (!done)
{
    System.Threading.Thread.Sleep(100);

    // Processes all messages currently in the message queue
    Dispatcher.Invoke(
        DispatcherPriority.Background, new ThreadStart(delegate { }));
} 
```

果然，这解决了它。那么，关于这个问题...

这里发生了什么？当我在控制台应用程序中运行此代码时，事件处理程序在工作线程上执行。为什么/如何将它放在 WPF 的主线程上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T00:45:23.723

我认为在 WPF 中，它会尝试将所有回调放在它们来自的线程上。这称为线程的“亲和力”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T13:57:09.820

Iמ WPF（以及在 WinForms、Win32 和我曾经使用过的任何其他 UI 库中）您只能从创建它的同一线程访问 UI 对象。

此外，在任何 GUI Windows 程序中，您都有消息循环和消息调度，而在控制台应用程序中则没有。

所以它看起来像

1.  WebClient 检测到它正在 GUI 应用程序中运行，并尝试通过在激活它的同一线程中引发事件来提供帮助。

或者

2.  WebClient 在内部使用消息调度并仅在控制台应用程序中回退到工作线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T16:34:47.973

好的，我用 Reflector 做了一点反编译，我已经弄清楚了引擎盖下发生了什么。Web 客户端使用 SynchronizationContext 类来处理将回调放在原始线程上。我不熟悉 SynchronizationContext 类，但这里有一篇关于它的非常好的文章......

[http://www.codeproject.com/KB/cpp/SyncContextTutorial.aspx](http://www.codeproject.com/KB/cpp/SyncContextTutorial.aspx)

# wpf - 如何为 WPF 中的自定义控件提供两个默认模板？

> ID：459740
> 
> 赞同：0
> 
> 时间：2009-01-20T00:29:23.663
> 
> 标签：wpf, xaml, custom-controls

在 2007 年 1 月版 MSDN 杂志 ( [http://msdn.microsoft.com/en-us/magazine/cc163497.aspx](http://msdn.microsoft.com/en-us/magazine/cc163497.aspx) ) 上的 Charles Petzold 的“使用模板自定义 WPF 控件”一文中，他说，

> ProgressBar 控件实际上有两个用于两个方向的默认模板。（ScrollBar 和 Slider 也是如此。）如果您希望新的 ProgressBar 支持两种方向，您应该编写两个单独的模板并在您也为 ProgressBar 定义的 Style 元素的 Triggers 部分中选择它们。

我目前正在编写一个需要此功能的自定义控件，但无法按照他所说的那样做 - 无论如何都不是有效的。有人有这个样本吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T14:02:21.353

[您可以在滚动条示例控件模板http://msdn.microsoft.com/en-us/library/ms742173.aspx](http://msdn.microsoft.com/en-us/library/ms742173.aspx)中看到它是如何完成的

我在这里只复制了样本的相关部分。

简而言之，资源字典中有两个模板：

```
<ControlTemplate x:Key="VerticalScrollBar" TargetType="{x:Type ScrollBar}"> ...

<ControlTemplate x:Key="HorizontalScrollBar" TargetType="{x:Type ScrollBar}"> ... 
```

以及在它们之间切换的样式触发器：

```
<Style x:Key="{x:Type ScrollBar}" TargetType="{x:Type ScrollBar}">
  <Style.Triggers>
    <Trigger Property="Orientation" Value="Horizontal">
      <Setter Property="Template" Value="{StaticResource HorizontalScrollBar}" />
    </Trigger>
    <Trigger Property="Orientation" Value="Vertical">
      <Setter Property="Template" Value="{StaticResource VerticalScrollBar}" />
    </Trigger>
  </Style.Triggers>
</Style> 
```

# c - NULL 总是假的吗？

> ID：459743
> 
> 赞同：76
> 
> 时间：2009-01-20T00:31:46.747
> 
> 标签：c, null, pointers

假设`NULL`在 C 中总是转换为 false 是否安全？

```
void *somePtr = NULL;

if (!somePtr) {
  /* This will always be executed? */
} 
```

还是应该对 的值进行明确的检查`NULL`？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-01-20T00:38:18.120

是的。NULL 的计算结果为假，因为 C 认为任何非零值为真，任何零值为假。NULL 本质上是`zero`地址，并且在比较中被视为这样，我相信会被提升为 int 以进行布尔检查。我希望任何熟悉 C 的人都可以阅读您的代码，尽管我可能会明确地进行检查。

> 在 C 和 C++ 编程中，保证两个空指针比较相等；ANSI C 保证任何空指针在与整数类型比较时都等于 0；此外，宏 NULL 被定义为空指针常量，即值为 0（作为整数类型或转换为指向 void 的指针），因此空指针将与 NULL 比较。

参考：[http ://en.wikipedia.org/wiki/Null_pointer#Null_pointer](http://en.wikipedia.org/wiki/Null_pointer#Null_pointer)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-20T00:56:59.597

'C' 语言可以追溯到 (void*)0 实际上可以是有效指针的时代。不久前，8080 和 Z80 微处理器在地址 0 处有一个中断向量。面对这样的架构选择，它只能让头文件声明 NULL 的值。那里有一些编译器，现在早已被遗忘，其中 NULL 不等于 (void*)0 （0xffff 是下一个替代方案），从而使您的 if() 语句具有未定义的行为。

C++ 仁慈地结束了这一点，空指针可以从 0 分配和测试。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-01-20T00:34:24.777

假设任何事情都不安全。

显式检查也更清楚您正在测试什么。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-20T01:24:33.520

是（至少对于任何符合标准的 C 编译器！）

从[comp.lang.c 常见问题解答](http://c-faq.com/null/ptrtest.html)：

> 问：用于测试非空指针的缩写指针比较“if(p)”是否有效？如果空指针的内部表示不为零怎么办？
> 
> 答：总是有效的。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-11-25T14:49:24.907

我的 ISO/IEC 9899:TC3（委员会草案 — 2007 年 9 月 7 日）副本说：

> 6.3 转换
> 
> 1 几个运算符自动将操作数值从一种类型转换为另一种类型。
> 
> 6.3.2.3 指针
> 
> 3 值为 0 [...] 的整数常量表达式称为空指针常量。如果将空指针常量转换为指针类型，则生成的指针（称为空指针）保证与指向任何对象或函数的指针不相等。

到目前为止，`ptr!=0`对于每个 non-null 都是 true (1) `ptr`，但它仍然是开放的，两个空指针如何比较。

> 6.5.9 等式运算符
> 
> 5 [...] 如果一个操作数是指针而另一个是空指针常量，则空指针常量将转换为指针的类型。
> 
> 6 两个指针比较相等当且仅当两者都是空指针时，两者都是 [...]

因此，`ptr==0`是 1（并且`ptr!=0`是 0），当且仅当`ptr`是一个空指针。

> 6.5.3.3 一元算术运算符
> 
> 5 逻辑否定运算符的结果！如果其操作数的值比较不等于 0，则为 0，如果其操作数的值比较等于 0，则为 1。结果的类型为 int。表达式 !E 等价于 (0==E)。

所以同样适用于`!ptr`。

> 6.8.4.1 if 语句
> 
> 1 if 语句的控制表达式应具有标量类型。
> 
> 2 在这两种形式中，如果表达式比较不等于 0，则执行第一个子语句。

注意，*标量类型*是*算术类型*或*指针类型*（参见“6.2.5 类型”，第 21 节）。放在一起，我们有：

*   `if (ptr)`成功 ⇔`ptr!=0`是 1 ⇔`ptr`不是空指针。
*   `if (!ptr)`成功 ⇔`ptr==0`是 1 ⇔`ptr`是空指针。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-11-22T15:21:16.417

是的，`if(!p)`有效并保证有效。

> 值为 0 的整型常量表达式或转换为 void * 类型的表达式称为空指针常量。如果将空指针常量转换为指针类型，则生成的指针（称为空指针）保证与指向任何对象或函数的指针不相等。

[https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p3](https://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p3)

这意味着这`(void*)0`是一个空指针。这也意味着 if`p`是一个指针，then`p==0`等价于`p==(void*)0`.

这也意味着如果`p`不是一个空指针，那么`p==(void*)0`将评估为`0`。

到现在为止还挺好。

> 将空指针转换为另一种指针类型会产生该类型的空指针。任何两个空指针应该比较相等。

[http://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p4](http://port70.net/~nsz/c/c11/n1570.html#6.3.2.3p4)

请注意，*“任何两个空指针都应比较相等。”* 这意味着如果`p`是一个空指针，那么`p==0`将评估为真，因为`0`将提升到`(void*)0`哪个是空指针。这也意味着没有非空指针可以等于空指针。

让我们看一下否定运算符。

> 逻辑否定运算符的结果！如果其操作数的值比较不等于 0，则为 0，如果其操作数的值比较等于 0，则为 1。结果的类型为 int。表达式 !E 等价于 (0==E)。

[http://port70.net/~nsz/c/c11/n1570.html#6.5.3.3p5](http://port70.net/~nsz/c/c11/n1570.html#6.5.3.3p5)

这告诉我们，`!p`与`p==0`定义相同，`p==(void*)0`与上面提到的相同。

考虑到所有空指针都相等这一事实，这意味着如果是空​​指针，`p==(void*)0`则只能评估为真，如果`p`不是空指针，则只能评估为假`p`。

所以是的，这是检查是否为空指针`if(!p)`的一种非常安全的方法。`p`

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-20T03:56:29.407

NULL 只是一个预处理器定义。它在 stdio.h 中。通常，只有疯子才会重新定义它，但这是可能的。一个例子：

```
#include <stdio.h>
#ifdef NULL
#undef NULL
#endif
#define NULL 1

void main()
{

        if (NULL)
                printf("NULL is true\n");
        else
                printf("NULL is false\n");
} 
```

此代码将打印“NULL 为真”。如果您不相信我，请尝试一下。您的编译器甚至可能不会警告您您正在做一些奇怪的事情。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-11-29T18:44:44.837

## 什么是空值？

> 宏 NULL 在 <stddef.h> （和其他头文件）中定义为**空指针常量**；

## 空指针常量的值是多少？

> 值为**0**的整数常量表达式，或转换为 void * 类型的此类表达式称为空指针常量。

*示例定义：*

```
#define NULL ((void*)0) 
```

## 评估 if(NULL)

> if ( 表达式 ) 语句
> 
> if ( 表达式 ) 语句 else 语句
> 
> 在这两种形式中，如果表达式比较不等于 0，则执行第一个子语句。在 else 形式中，如果表达式比较相等，则执行第二个子语句 §6.8.4.1 语言 133 ISO/IEC 9899:TC3 委员会草案 — 9 月 7 日， 2007 WG14/N1256 为 0。如果通过标签到达第一个子语句，则不执行第二个子语句。

所以是的，如果编译器符合 ISO C99，您可以假设下面的语句将始终执行。

```
if (!NULL) { statement; } 
```

以上引用来自 ISO/IEC 9899:1999 (C99)。你可以在[这里](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1256.pdf)阅读。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-11-29T19:30:45.610

是的，它：

C 标准 6.3.2.3

> 值为 0 的整型常量表达式或转换为 void * 类型的表达式称为空指针常量。如果将空指针常量转换为指针类型，则生成的指针（称为空指针）保证比较不等于指向任何对象或函数的指针。

和 6.3.2.6

> 任何指针类型都可以转换为整数类型。除非前面指定，结果是实现定义的。如果结果不能以整数类型表示，则行为未定义。结果不必在任何整数类型的值范围内。

-

> 当任何标量值转换为 _Bool 时，如果该值比较等于 0，则结​​果为 0；否则，结果为 1

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T00:35:18.643

`NULL`被定义为一个常量指针，它保证指向内存中一个无用/不存在的地方。的大多数实现`NULL`是，`((void *)0)`但这不是强制性的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-11-30T06:52:12.103

在我看来，假设这一点并不总是安全的。因为，根据程序中包含的头文件，它可以被重新定义。但是按照标准，空指针常量保证不指向任何真实对象，并且有一个类型`void *`。

在我们的例子中，声明`void *somePtr = NULL`也可以`void *somePtr = 0`是`0`空指针。

> “值为 0 的整型常量表达式，或这种类型转换为 void * 的表达式，称为空指针常量。如果将空指针常量转换为指针类型，则生成的指针（称为空指针）保证与指向任何对象或函数的指针不相等。” [https://www.geeksforgeeks.org/few-bytes-on-null-pointer-in-c/](https://www.geeksforgeeks.org/few-bytes-on-null-pointer-in-c/)

这只是意味着，`*somePtr`在该特定点进行评估可能会导致错误。

另一个参考可以是[https://www.gnu.org/software/libc/manual/pdf/libc.pdf](https://www.gnu.org/software/libc/manual/pdf/libc.pdf)在第 944 A.3 页关于 NULL 指针常量

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-01-20T00:58:06.037

是的，主要是。

首先，NULL 是一个 typedef。我可以通过在以前包含的标题中说出来来把你搞砸

```
#define NULL 1
```

这可能没有多大意义，但是从什么时候开始，其他人的代码才有意义呢？:)

此外，虽然它在语法上可能是安全的，但在语义上并不正确。NULL 表示“无”，既不是真或假，也不是布尔值、int 或字符串。它的意思是“一无所有的象征”。所以测试 NULL 更像是一个哲学问题：如果一棵树倒在森林里，并且`if(listener)`，它会发出声音吗？

帮大家一个忙，并明确针对 NULL 进行测试。

* * *

## 回答 #13

> 赞同：-6
> 
> 时间：2009-01-20T00:35:49.030

*NULL 始终以 0x00L 为目标。您可以认为这是错误的，但要确保始终进行明确的检查。

# c++ - C++ I/O 在 EOF 之后重新读取文件（原为：解析逗号分隔的文本文件）

> ID：459744
> 
> 赞同：0
> 
> 时间：2009-01-20T00:32:00.990
> 
> 标签：c++, io

让我们看一下代码：

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstdio>
#include <cstdlib>

using namespace std;

int main()
{
    string usrFileStr,
    fileStr = "airNames.txt",  // declaring string literal
    sLine;                        // declaring a string obj

    fstream inFile;                  // declaring a fstream obj
    char ch;

    cout << "Enter a file: ";
    cin >> usrFileStr;

    inFile.open( usrFileStr.c_str(), ios::in ); 
    // at this point the file is open and we may parse the contents of it

    while ( !inFile.eof() )
    {
          getline ( inFile, sLine ); // store contents of txt file into str Obj
          for ( int x = 0; x < sLine.length(); x++ )
          {         
              if ( sLine[ x ] == ',' )break; // when we hit a comma stop reading 
              //cout << sLine[ x ];
          }
          cout << endl;
    }      

        while ( !inFile.eof() )  //read the file again until we reach end of file
        {
                // we will always want to start at this current postion;
              inFile.seekp( 6L, ios::cur );

              getline( inFile, sLine ); // overwrite the contents of sLine
              for ( int y = 0; y < sLine.length(); y++ )
              {
                  if ( sLine[ y ] == ',' )break; // hit a comma then goto seekp until eof
                  cout << sLine[ y ];
              }
              cout << endl;
        }

    inFile.clear();
    inFile.close();

    fgetc( stdin );
    return 0;
} 
```

我的文本文件格式类似于：

```
string, string andthenspace, numbers, morenumbers 
```

看起来我无法读取该文件两次。`EOF`每次检查..

第一个while条件有效，它给了我我需要的东西，逗号前的第一个字段，不包括逗号。

所以我第二次想，好的，只是在`seekp(X, ios::cur)`第二次的每次迭代中从那里开始的函数......

不幸的是，它没有第二次读取文件..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T00:36:48.280

第一次读取 EOF 后，您可能需要清除流上的错误位。也就是说，以及进行查找操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T09:56:50.037

**首先，永远不要在你的while循环中测试eof，在你到达文件末尾之后**，标志将是真的，即太晚了，测试必须在读取之后，在使用你期望读取的内容之前完成。->

```
while (std::getline(......)) 
```

然后，Jonathan Leffler 给了你[解决方案](https://stackoverflow.com/questions/459744/c-i-o-rereading-a-file-after-eof-was-parsing-a-comma-delimited-text-file#459752)，在调用 seekg 之前清除状态位。[但是，正如Jamie 指出的那样](https://stackoverflow.com/questions/459744/c-i-o-rereading-a-file-after-eof-was-parsing-a-comma-delimited-text-file#459761)，您的方法似乎有些复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:40:46.527

你似乎走错了路：

```
FILE * file;
file = fopen ("file.txt","r");

if (file!=NULL){
        while (!feof(file)) {           
                fscanf(file,"%s ,%s ,%s ,%s",str1,str2,str3,str4);
        }
        fclose (file);
}; 
```

您显然可以扩展上面的示例，我没有时间检查它应该可以工作。

# c - 将行从标准输入复制到字符指针数组

> ID：459751
> 
> 赞同：1
> 
> 时间：2009-01-20T00:36:21.823
> 
> 标签：c, arrays, pointers

我想将行从标准输入复制到字符指针数组。例如，如果用户输入以下“the\nquick\nbrown\nfox”，那么我想要一个看起来像

> arr[0] = "the" arr[1] = "quick" arr[2] = "棕色" arr[3] = "fox"

任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T00:45:52.973

在循环中使用 getchar() 逐个字符地获取输入。将字符追加到循环中的当前字符串，当当前字符为换行符'\n'时，开始一个新字符串而不是追加字符。

我会让你自己解决剩下的问题，然后如果你对这个问题有更具体的问题，问它。

> 任何指针？

[0x3A28213A、0x6339392C、0x7363682E。](http://xkcd.com/138/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T00:46:37.480

请参阅[fgets()](http://www.opengroup.org/onlinepubs/009695399/functions/fgets.html)和[malloc()](http://www.opengroup.org/onlinepubs/009695399/functions/malloc.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T00:48:55.183

您需要确保不仅分配了一个指针数组，而且还为每个元素分配了空间。我没有像你应该那样检查 NULL 指针，但这应该让你开始。

```
char **arr;
int maxWords = 3;
int i;

arr = malloc (sizeof (char *) * maxWords);

for (i = 0; i < maxWords; i++)
{
    arr[i] = malloc (100);
    fgets (arr[i], 99, stdin);
} 
```

之后，您还需要释放该内存：

```
for (i = 0; i < maxWords; i++)
{
    free (arr[i])
}
free (arr); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T00:52:23.320

您需要一个字符指针数组和一些空间供它们指向 - 也就是说，一个或多个字符数组也是如此。如何做到这一点有多种可能性，从动态分配到静态分配的数组。线必须有多长？这取决于你的环境是什么。（我不得不修复我的一个程序中的一个错误，因为当我使用 4096 字节缓冲区作为行长时它失败了，但至少有一个输入行中有超过 5000 个字节。失败是因为我数了数数据中的换行符，并在答案为零时退出循环 - 不是因为缓冲区溢出！）

一种选择，其他解决方案中未提及（到目前为止）：

*   使用 mmap() 在内存中创建文件的私有映射。
*   扫描映射的内存以放置一个空值来代替每个换行符。
*   确保您有指向字符串开头的指针，并且紧跟在每个作为换行符但现在为空的字符之后。

# sql-server - 如何备份 SQL 数据库中数据的逻辑子集？

> ID：459756
> 
> 赞同：2
> 
> 时间：2009-01-20T00:38:08.153
> 
> 标签：sql-server, backup

我们的客户出于无可争辩的原因不能使用 SQL Server 的内置备份功能，因为它备份了整个数据库。这些客户需要将数据库拆分并备份到拥有数据的人的子集中，以便相关方可以根据自己的规则备份自己的数据。我的问题有两个：

1.  我该怎么做这样的事情？
2.  您是否曾被要求像这样对备份进行分区？如果没有，您是否曾被要求做一些看似违背行业标准的事情？我们公司的人建议我们/我应该简单地“推出我们自己的”备份过程，只备份所需的数据子集。当然，这意味着我们/我应该简单地“推出我们自己的”恢复过程。当我认为这是重新发明轮子的定义以及我们首先选择 SQL Server 的部分原因时，我感觉到他们认为我是一个技术势利小人和/或懒惰的人。

我怀疑他们的意见是基于对另一个基于 Access 的产品的经验，并将每个逻辑单元存储在一个单独的数据库中，可以简单地复制。

**更新：**我终于通过使用 SMO 备份“完整”数据库、恢复备份以及从备份中删除不属于子集的记录来实现这一点。我很失望地发现这导致事务日志在 5 分钟内增长到 5GB 以上。似乎创建一个空数据库并插入会更容易，但是如何在没有更新数据库时需要更新的静态脚本的情况下复制模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T00:52:52.320

我明白为什么要这样做，这是一种为高级客户**打开数据库**并让客户只工作和处理自己的数据的简单方法。他们可以使用它来创建自己的报告**，并直接访问数据源**并使用它做任何他们想做的事情。

我称之为数据的“导出”和“导入”，而不是“备份”。但它是在玩文字游戏。在我们的一些系统中，我们经常进行这种导出。

在“如何”上，我必须了解更多信息，他们是否希望将其导出到另一台服务器、相同的服务器但另一个数据库或其他什么？

它可以通过夜间运行的作业或推送数据的服务来完成。为此也存在其他工具。也许使用在夜间运行或触发的 DTE 包。或者让一个程序在请求时获取数据。

**编辑：回答评论：**
在大多数情况下，我们删除现有的子集数据库，然后恢复一个空数据库并用过滤后的数据填充它。另一种方法是完全备份，恢复为新数据库并删除不属于子集的行。

我认为subsetdb更像是一个带有统计数据的“只读”-db，所以你不必担心重写更改等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T01:05:03.887

我完全可以理解公司为什么要这样做，特别是如果他们提供托管解决方案并在多个客户之间共享单个数据库或类似的东西。似乎通过 customerId 字段过滤记录并将它们放到文件中就可以了，这就是它的结束......但是，他们在这个问题上搞砸了。

如果不查看有问题的数据库，就很难指出为什么这是一个坏主意。但有几个立刻浮现在脑海：

1.  事务日志备份丢失。

2.  自动递增 ID 不适合手动插入“丢失”记录，并且在插入期间关闭 IDENT 功能和/或约束只是询问参照完整性问题。

3.  共享数据呢？是否有多个客户正在使用任何表格？当数据随时间变化时会发生什么……您将在哪里检索该数据的最新备份？它将如何影响生活在同一数据库中的其他客户？

4.  外键...您必须分析所有表并确保首先插入没有外键的表。这不是不可能的，但有相当多的错误空间。

5.  当架构改变时会发生什么？如果您将所有这些数据作为单独的插入进行备份，那么如果不匹配备份的模式，它们将不再按原样工作。

有各种各样的事情要考虑。就个人而言，如果我是他们，我会从整个数据库的单个 SQL Server 备份开始（更好的是，将他们的客户分开到不同的数据库中，而不是让他们都共享一个大数据库），每天创建差异（或任何最好的时间表符合他们的需求）。然后，作为一项附加服务，他们可以提供一些导出和导入数据的方法，无论是通过 XML、CSV 还是其他方式。允许客户通过导出对他们的数据进行备份，如果需要，他们可以随时重新导入，允许重复检查等。

使用这种方法，您始终可以保证您有一种恢复符合 Microsoft 标准的备份的方法。数据不是玩具，SQL Server 也不是一无是处的野兽……当涉及到 SQL Server 的备份过程时，不仅仅是从数据库中提取数据并将其扔到某处。整个公司可能会因为未能正确保护他们的数据而陷入困境，最糟糕的是，他们中的大多数人直到最后一刻才意识到他们的自定义备份过程在恢复时不起作用......*哎哟*

最后但并非最不重要的一点是，可能会有适合这项工作的工具。Red Gate 提供了许多出色的 SQL Server 工具，例如 SQL Server Compare、Data Compare 和他们自己的自定义备份应用程序。无论如何，我会把它们作为最后的手段......

[http://www.red-gate.com/](http://www.red-gate.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T02:14:35.463

简短的回答是没有本地方法来处理这个问题。

更长的答案是，如果您只使用架构创建了一个新数据库，然后从主数据库加载客户数据，您可以将较小的数据库备份到单个备份文件中并将其提供给他们。

SSIS 可能是您最好的选择，因为您可以使用它的本机任务来获取所有表模式并将它们创建为空，然后为客户特定的表定义转换，然后遍历查找表，复制所有这些表的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T02:19:36.047

您可以选择创建多个数据库吗？您可能能够得出一个解决方案，其中一个“中央”数据库包含有效地将其他数据库的表联合在一起的视图。我知道一些网络过滤应用程序会这样做，当然，他们不会以这种方式进行更新。但它可能是可行的。在这种情况下，每个数据库都可以使用本地方式进行备份。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T11:06:58.133

好吧，如果您真的必须做这样的事情，那么可能最安全的方法是将子集 od 数据的某种数据传输（复制、服务代理等）到他们自己的数据库中（每个可备份子集 1 db）。然后您可以备份这些数据库。

因为您只处理子集，所以我会为此使用服务代理，因为它保证不会丢失数据。

# ruby-on-rails - 新手：在 Debian 上安装 Rails（Gem Fetch 错误？）

> ID：459764
> 
> 赞同：1
> 
> 时间：2009-01-20T00:41:41.593
> 
> 标签：ruby-on-rails, rubygems

我在安装 Ruby on Rails 时遇到了很大的麻烦。

我用 apt-get 安装了 Ruby 当我尝试安装 Ruby Gems 时，安装程​​序一直无限期地挂在安装 ri 上，所以我尝试从源代码安装 Ruby。我遇到了同样的问题，所以我安装了没有 ri 或 RDoc 的 Ruby Gems。我不知道这是否与以下问题有关。

当我继续尝试通过 Gems 安装 Rails 时，我首先收到 Ruby 找不到 zlib.so 的错误...所以我将 zlib.so 复制到 Ruby 期望的位置。

从 strace 的输出来看，看起来 Ruby 正在查看

> /usr/local/lib/ruby/1.8/x86_64-linux/zlib.so

但 zlib.so 仅位于

> /usr/lib/ruby/1.8/x86_64-linux/zlib.so

现在我收到一个新错误：

```
    错误：执行 gem 时...（Gem::RemoteFetcher::FetchError）
        SocketError：getaddrinfo：名称或服务未知 (http://gems.rubyforge.org/gems/actionmailer-2.2.2.gem)

```

我有一种感觉，正在发生严重的错误。我能做些什么来改善这个错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T11:50:33.507

我自己也遇到了这个问题，发现了这个网站： [http ://www.typeoneerror.com/articles/post/updating-rails-error](http://www.typeoneerror.com/articles/post/updating-rails-error)

建议使用 -p 开关（它对我`install`和`update`命令都有效）。

我不明白如何或为什么（也许其他人可以解释它？），但它确实对我有用。有时，如果它失败了，只需尝试再次运行它，它似乎在第二次尝试特定的 gem 后就可以通过它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T00:56:21.423

关于`getaddrinfo`错误，这可能意味着您的机器无法解析 localhost 或其主机名。可能值得检查您的`/etc/hosts`文件是否完成。如果我的机器的主机名是`bob`并且我的完全限定域名是`example.com`，我将检查以下条目：

```
127.0.0.1    example.com bob 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T08:15:02.823

这是为我解决问题的方法：

`gem update --system`-> 得到一个 NoMethodError

然后`gem update`->现在工作正常。

# ruby-on-rails - if/then/else/RETURN/end 的声明式 ruby 编程替换？

> ID：459777
> 
> 赞同：4
> 
> 时间：2009-01-20T00:45:57.093
> 
> 标签：ruby-on-rails, ruby, controller, methods, declarative

我的控制器中到处都是这个：

```
if not session[:admin]
  flash[:notice] = "You don't have the rights to do #{:action}."
  redirect_to :action=>:index
  return
end 
```

及其兄弟：

```
if not session[:user] and not session[:admin]
  flash[:notice] = "You don't have the rights to do #{:action}."
  redirect_to :action=>:index
  return
end 
```

当我想在一个方法中使用它时，我想把它减少到一个声明行：

```
def action_which_requires_rights
    require_rights :admin
    #or:
    #:require_rights :user_or_admin
end 
```

显然，如果 require_rights 失败，我不希望执行该方法的其余部分。我发誓有办法做到这一点，但我找不到我在哪里读到它。这是我想象的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T00:59:44.663

首先你可以这样做：`unless session[:admin]`而不是`if not ...`

然后你可以有一个调用你的方法的前置过滤器，这个方法会做你的redirect_to“url”并返回。

我有一个问题，我希望您不只是将管理员的 ID 存储在会话中作为您唯一的身份验证方式，在您的用户模型上拥有一个属性并进行查询，这可能是一个更安全的选择。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T10:08:26.927

正如其他人所说， before_filter 在这里似乎是正确的工具。但我会解决你所询问的实际模式。

不幸的是，一个方法不能导致它的调用方法返回。与您正在寻找的模式最接近的两个匹配项：

一个块：

```
def require_rights(rights)
  if session[rights]
    yield
  else
    flash[:notice] = "You don't have the rights to do #{:action}."
    redirect_to :action=>:index
  end
end 
```

所以你会这样做：

```
def action_which_requires_rights
  require_rights :admin do
    #do whatever here
  end
end 
```

或返回值：

```
def require_rights(rights)
  return true if session[rights]
  flash[:notice] = "You don't have the rights to do #{:action}."
  redirect_to :action=>:index
  false
end 
```

所以你会这样做：

```
def action_which_requires_rights
  require_rights :admin or return
  #do whatever here
end 
```

我更喜欢这个块，因为它适合类似的方法，让调用者做`or return`对我来说有点不自然。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T01:27:37.710

看看 before_filter。它们可以停止执行，并且可以限制为某些操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T09:08:18.327

如果不允许用户执行此操作，我不会向用户显示操作（我会使用助手来完成此操作）

在控制器中，正如其他答案中提到的，恕我直言，最好的方法是使用过滤器来控制访问权限。

我还建议使用 RESTful 身份验证插件来管理用户角色。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T09:29:55.367

你可以尝试一些引发异常的东西。

```
def action_for_admins
  require_rights :admin
end

begin 
  action_for_admins
rescue
  <%= You don't have the rights to do that %>
end 
```

然后 require_rights 应该看起来像这样

```
def require_rights(*rights)
  rights.each do |right|
    raise "Missing right #{right.to_s}" if not user.has_right?(right)
  end
end 
```

请注意，我是 Ruby 或 Rails 的初学者，所以可能不是*这样*。

# winforms - System.Windows.Forms 中的单元测试数据绑定

> ID：459779
> 
> 赞同：0
> 
> 时间：2009-01-20T00:46:09.433
> 
> 标签：winforms, unit-testing, data-binding

我在对表单进行单元测试时遇到问题。

问题是当表单不可见时，数据绑定根本不起作用。

这是一些示例代码：

```
Data = new Data();
EdtText.DataBindings.Add(
    new Binding("Text", Data, "Text", false, 
        DataSourceUpdateMode.OnPropertyChanged)); 
```

后来：

```
Form2 f = new Form2();
f.Data.Text = "Test 1";
f.EdtText.Text = "Test 2";
f.Data.Text = "Test 3"; 
```

最后，组件的值是 f.EdtText.Text = "Test 2" 和 f.Data.Text = "Test 3"，但预期值应该都是 "Test 3"。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T03:23:24.170

我想你回答了你自己的问题——为了让属性更改事件 ( `TextChanged`) 发生，必须显示控件。你的单元测试可以做这样的事情：

```
Form2 f = new Form2();
f.Show();
Thread.Sleep(2000); // give the Form time to open
f.Data.Text = "Test 1";
Assert.AreEqual("Test 1", f.EditText.Text);
f.Close(); 
```

您可能希望使用[NUnitForms](http://nunitforms.sourceforge.net/)来获取 Form 控件，而不是公开 Form 组件：

```
TextBoxTester tb = new TextBoxTester("EditText1");
Assert.AreEqual("Test 1", tb["Text"]); 
```

# xml - 在 XML 中存储条件逻辑（逻辑结构）

> ID：459783
> 
> 赞同：1
> 
> 时间：2009-01-20T00:46:54.907
> 
> 标签：xml, vb.net, conditional

我需要将简单的条件表达为程序输入。输入必须是人类可读的。

XML 适合这个吗？

例如，我有以下条件语句：

```
If AnimalType = Leopard And (SourceCountry = Kenya Or TargetCountry = Kenya) Then
    ZooKeeper=Jack
Else
    ZooKeeper=Jill
End If 
```

用 XML 表达上述内容可能如下所示：

```
<If>                
    <Conditional>           
        <And>       
            <AnimalType>Leopard<AnimalType> 
            <Or>    
                <SourceCountry>Kenya</SourceCountry>
                <TargetCountry>Kenya</TargetCountry>
            </Or>   
        </And>      
    </Conditional>  
    <True>  
        <ZooKeeper>Jack</ZooKeeper>
    </True> 
    <False> 
        <ZooKeeper>Jill</ZooKeeper>
    <False> 
</If> 
```

关于如何最好地在 XML 中表示条件语句的任何想法？

我还没有探索过使用属性。我目前不需要嵌套的“If”语句或“Else If”子句，但无论如何我都会尝试使用它们。

在这种情况下，也许 VB 代码比 XML 更“可读”，我应该创建一个自定义的平面文件格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T00:55:33.937

XML 对此没有任何问题，但您可以使用更轻的语法（如 LISP 样式列表）为自己节省一些开销：

```
(if
    (and
         (AnimalType Leopard)
         (or
             (SourceCountry Kenya)
             (TargetCountry Kenya)
         )
     )
     (ZooKeeper Jack)
     (ZooKeeper Jill)
 ) 
```

您可以使用 if 中的项目排序，而不是显式声明条件 true、false。您将拥有的基本要求是保留正确的语法树。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T01:49:41.003

也许您听说过或看过[RuleML](http://www.ruleml.org/)？

这似乎是您正在寻找的。有一个开源规则引擎，它使用我在 C# 中使用的 RuleML for .NET：[NxBRE](http://sourceforge.net/projects/nxbre/)

NxBRE 还有一个 Visio 模板，可以让其他人更容易理解规则。他们还尝试了一种人类可读的格式，但我不确定这是否仍在进行中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T01:45:56.253

您说您希望它是人类可读的，然后您提供了一个几乎难以理解的 XML 示例。我不确定 XML 在这里给你买了什么。一个真正人类可读的语言的简单解析器可能是您时间的一项很好的投资。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T17:04:45.167

由于在这种情况下 XML 很方便，而 VB 非常“人类可读”，我想我会使用这样的东西：

```
 <Conditional>
        If AnimalType = Leopard And (SourceCountry = Kenya Or TargetCountry = Kenya) Then
            ZooKeeper=Jack
        Else
            ZooKeeper=Jill
        End If
    </Conditional> 
```

# graphics - 有人知道好的图形变形代码或算法吗？

> ID：459793
> 
> 赞同：3
> 
> 时间：2009-01-20T00:49:56.600
> 
> 标签：graphics

我正在构建一个小应用程序，我需要能够将一个图像变形为另一个图像。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T03:21:46.340

如果你还记得 Michael Jackson 的黑白视频，他们使用了 Beier-Neely 算法。作为一名本科生，我做了一个项目，将该算法用于图形类，并发现它非常易于使用。

如果您只需要一些东西来执行变形，那么可能有一个您可以使用的实现。

如果您需要构建一些东西并将其包含在您的应用程序中，这可能会帮助您入门：

[http://www.hammerhead.com/thad/morph.html](http://www.hammerhead.com/thad/morph.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T15:49:00.060

感谢这些指点！我想我需要在客户端上用 Flex/Flash 变形图像。我目前的想法是我将解释我发现的家庭作业：

[http://cns-web.bu.edu/~oph/cs580_assign1/p1.html](http://cns-web.bu.edu/~oph/cs580_assign1/p1.html)

进入 ActionScript 并围绕它构建一个 UI。它使用了 nickspilman 提到的 Beier-Neely 算法。我会让你们知道结果如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T04:10:56.383

[有xmorph](http://xmorph.sourceforge.net/home/gourlay/public_html/Xmorph/)和[tkmorph/gtkmorph](http://xmorph.sourceforge.net/)使用的 libmorph（GPLv2，C api）。GIMP 曾经也有一个插件，但我知道它已经坏了一段时间；不知道有没有更新

您提供源图像和目标图像，每个图像都有一个网格来识别对应的点，它将输出它们之间的插值（或动画转换）。

# c++ - 为什么 SDL_Mixer 不能播放某些 mp3 的音乐？

> ID：459794
> 
> 赞同：2
> 
> 时间：2009-01-20T00:52:04.037
> 
> 标签：c++, audio, sdl, sdl-mixer

为什么 SDL_Mixer 不能播放某些 mp3 的音乐？

我正在创建的应用程序中使用 SDL_Mixer 播放音乐。在某些歌曲（实际上是整张专辑）上，音乐根本不会播放而不会返回任何错误。音乐数据使用 Mix_LoadMUS 成功加载，当使用该数据执行 Mix_PlayMusic 时，它奇怪地返回 0 表示成功但不播放音乐。我还尝试阅读 Mix_GetError() 和 SDL_GetError() （我相信它们是相同的），看看它是否会引发错误，但没有这样的运气。

我的问题是，SDL_mixer 无法播放特定 mp3 的其他原因是什么？

我知道 mp3 的功能很强大，因为我可以在其他音乐播放器中播放它们。由于 Mix_PlayingMusic 返回 0，我还知道他们没有在播放（与音量可能被调低相反）。

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:13:18.443

这实际上是该特定计算机的一个声音问题。在另一台机器上尝试相同的测试时，声音完美无缺。只是一个快速说明，以防其他人遇到此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T01:20:39.987

MP3 算法的不同实现允许对格式的不同级别的一致性。大多数音乐播放器都非常宽容，因为大多数用户宁愿听到断断续续的声音也不愿听到什么，但常见的播放库容忍度要低得多。

我建议在[Audacity](http://audacity.sourceforge.net/)等音频样本编辑器中打开有问题的（或全部）mp3 ，然后重新导出 mp3。由于 mp3 压缩本质上是有损的，因此您可能会损失一点质量，但它可能会解决播放问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-31T15:44:46.913

我遇到了同样的问题，大胆地重新导出 mp3 文件并没有帮助，但是通过执行以下操作：如果 (Mix_PlayingMusic() == 0) Mix_PlayMusic() 在事件循环中，音乐在 2 或 3 次尝试后播放（每次我运行程序时都不一样）。另一种解决方案是将音乐转换为 .ogg 文件。

# php - 仅使用 php 备份和恢复 mysql 转储的最佳方法是什么？

> ID：459796
> 
> 赞同：3
> 
> 时间：2009-01-20T00:52:49.340
> 
> 标签：php, mysql

我知道您是如何从控制台执行此操作的，并且我知道您可以使用 php 执行控制台命令，但是是否有一种方法可以递归地将数据库转储到文件中，然后稍后从该文件中恢复它，只使用 php？我希望它能够在 windows 和 nix 服务器上工作。

我猜它需要遍历表和行，但我将如何获得这些列表？或者甚至可以做到吗？如果 db 大小合适，似乎会占用大量内存。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T01:09:23.300

```
mysql_query("SELECT * INTO OUTFILE 'sql/backup.sql' FROM my_table");
mysql_query("LOAD DATA INFILE 'sql/backup.sql' INTO TABLE my_table"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T01:18:14.967

您可以使用该`exec()`函数调用mysqldump。这会将 mysqldump（数据库导出）的输出通过管道传回您的 PHP 脚本，您可以在那里处理它，但这是必要的。这可用于导出单个表或整个数据库。该工具可以安装在客户端机器上，或者 PHP 脚本可以在 MySQL 服务器上运行。

```
/path/to/mysqldump --host=[svr] --user=[user] --password=[passwd] [db] 
```

确保传递给 MySQL 的用户对要备份的每个数据库具有`SELECT`和权限。`LOCK TABLE`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T01:13:48.253

运行显示表；询问。遍历结果并运行 deizel 为每个表列出的查询。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T01:49:58.773

[这](http://dev.mysql.com/doc/refman/5.0/en/show-create-table.html)可能有助于主键

```
SHOW CREATE TABLE my_table 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-20T01:24:10.463

查看mysql数据库。

# subgraph - 子图同构和子图单态有什么区别？

> ID：459799
> 
> 赞同：12
> 
> 时间：2009-01-20T00:53:24.487
> 
> 标签：subgraph, isomorphism, monomorphism

在我从事的一个项目中，出现了[同构与单态](http://depth-first.com/articles/2008/11/13/one-of-these-things-is-not-like-the-other)的主题。

一点背景知识：我不是图论专家，也没有接受过正规培训。但是这个主题在化学中非常重要，化学家期望在他们使用的结构搜索系统中发生一种特定类型的子图匹配。

如果目标图 A 有 n 个节点和 m 条边，那么化学家将接受子图匹配，其中查询图 B 有 n 个节点和 m-1 条边。唯一的要求是 B 中的每条边都应该出现在 A 中。例如，6 个节点的线性链应该匹配 6 个节点的循环。

这种匹配同构还是单态？也许完全是别的东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-20T01:45:34.007

令 G1、G2 分别是由顶点集和边集 V1、V2 和 E1、E2 组成的图。

G2 同构于 G1 的子图，当且仅当 V2 的每个顶点与 V1 中的顶点之间，以及 E2 中的每条边与 E1 中的某个边之间存在一对一映射。因此，要实现同构，您需要进行完全匹配，包括图形是否在节点之间包含多个边。

G2 是*单态*的，如果顶点之间存在这样的映射，并且在 V2 中的所有顶点之间存在一条边，并且在 V1 中存在对应的边。但只要至少存在一个边缘，这就足够了。

[这是来自comp.lang.python](http://groups.google.com/group/comp.lang.python/browse_thread/thread/36cedda25f330946/508b102eaf66b408?lnk=st&q=graph+edge+python&rnum=1&pli=1)的一个很好的包描述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T01:45:49.123

单态。

从一个图（“B”）到另一个图（“A”）的单态等价于从 B 到 A 的子图的同构。

该示例是说任何 n 顶点路径（“链”）对于 n 顶点循环都是单态的。对于 n+1 个顶点循环，它也是单态的，或者对于任何 k 都是 n+k。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T03:24:20.663

当顶点上的 h 是单射函数时，无向图同态 h: H -> G 被称为单态。作为图同态 h 当然将边映射到边，但不要求边 h(v0)-h(v1) 反映在 H 中。

有向图的情况类似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-17T08:45:16.163

这里的数学和 CS 术语之间存在差异。从数学中你得到两个术语：

1.  子图同构：设 H = (VH, EH) 和 G = (V, E) 是图。f : VH → V 是一个子图同构如果 (u, v) ∈ EH, 那么 (f(u), f(v)) ∈ E. H 同构于 G 的一个子图

2.  诱导子图同构：设 H = (VH, EH) 和 G = (V, E) 是图。f : VH → V 是一个诱导子图同构如果 (u, v) ∈ EH, 那么 (f(u), f(v)) ∈ E. 如果 (u, v) 不是 EH 的元素，那么 ( f(u), f(v)) 不是 E 的元素。H 与 G 的诱导子图同构

来自[http://theory.stanford.edu/~virgi/cs267/lecture1.pdf](http://theory.stanford.edu/~virgi/cs267/lecture1.pdf)的定义。它们等同于我在“图论第一课”中找到的内容。

请注意，这两者都是图之间的单射同态，也就是图单态。

转向 CS，特别是子图同构问题。据我所知，子图同构算法从上面确定是否存在满足（2）的函数。

图单态匹配 (1)。

CS定义来自VF2算法，我不知道这种用法有多普遍。在为项目搜索正确算法时，似乎仍然存在一些歧义，并且并非所有项目都使用相同的定义。

用一粒盐来回答这个问题[http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.101.5342&rep=rep1&type=pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.101.5342&rep=rep1&type=pdf) 在介绍中将单态性与图子图同构性分开，但在第 2 节将图子图同构定义为在概念上与 (1) 相同，这表明我遗漏了一些东西。

# wcf - 在工作组模式下配置 WCF MSMQ

> ID：459815
> 
> 赞同：2
> 
> 时间：2009-01-20T01:06:00.327
> 
> 标签：wcf, msmq, configuration-files

在尝试部署服务时，我发现它不会启动，因为 MSMQ 处于工作组模式。我创建了一个私有队列，并更改了配置文件以引用它，但 WCF 服务主机拒绝从以下消息开始：

> 绑定验证失败，因为绑定的 MsmqAuthenticationMode 属性设置为 WindowsDomain，但安装 MSMQ 时禁用了 Active Directory 集成。

谁能告诉我如何在配置文件中指定工作组模式？我在 MSDN 中找到的信息都是关于修改代码中的设置，并没有提到如何在配置文件中指定它。

在我拥有的配置文件中，绑定标记为空（`<bindings />`）但服务端点指定`binding="netMsmqBinding"`了我想这意味着默认配置正在使用中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-15T04:21:04.353

当我们 `<security mode="None">`在测试环境中遇到问题时。

在最终交付期间，即使那样也没有用..最后这个工作了

```
<security>
<transport
msmqAuthenticationMode="None"
msmqProtectionLevel="None"/>
</security> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T21:24:37.590

您应该在队列上设置匿名集成身份验证。[看看这个 kb 为什么和如何](http://support.microsoft.com/default.aspx?scid=kb;EN-US;952570)。

在[msdn 中有一个](http://msdn.microsoft.com/en-us/library/ms789008.aspx)使用工作组模式的好例子。请注意，该示例使用事务队列。因此，您必须使队列具有事务性。这只能在创建队列时完成。

发布您的代码和配置，以便我们对其发表评论。

# objective-c - 我应该明确释放吗？

> ID：459820
> 
> 赞同：1
> 
> 时间：2009-01-20T01:09:25.127
> 
> 标签：objective-c, cocoa

我目前有一个字符串数组，我通过调用该`-componentsJoinedByString:`方法从这个数组中获取一个 NSString 对象。例子：

```
NSString *someString = [[NSString alloc] initWithString: [myStrings componentsJoinedByString:@","]; 
```

由于`-componentsJoinedByString:`返回给我一个 NSString，我假设它不是我“拥有”的，因此我刚才所做的应该没问题吗？还是我必须这样做：

```
NSString *toDelete = [myStrings componentsJoinedByString:@","];

NSString *someString = [[NSString alloc] initWithString:toDelete];
[toDelete release]; 
```

非常感谢您帮助澄清这一点！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T01:26:28.930

你写的第一个例子是正确的，虽然在实践中写起来会更清楚`NSString *someString = [[myStrings componentsJoinedByString:@","] copy];`（注意这将被保留，所以你必须在将来的某个时候发布它。

如果您在内存管理方面遇到问题，[此页面](http://www.cocoadev.com/index.pl?MemoryManagement)可能会有所帮助。学习规则并不难，但在你学会之前你会遇到很多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T16:14:40.743

您是否需要稍后在此方法之外使用此字符串？如果是这样，您可能希望将其分配给实例变量，请执行以下操作：

```
someStringIVar = [[myStrings componentsJoinedByString:@","] copy]; 
```

否则，如果它仅在方法内临时使用，请执行以下操作：

```
NSString *someString = [myStrings componentsJoinedByString:@","]; 
```

无论哪种方式，都绝对不需要人们似乎过于热衷的荒谬`-initWithString:`和呼吁。`+stringWithString:`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T01:13:35.243

`componentsJoinedByString:`如果它将在当前方法的范围之外使用，您只需要保留它返回的字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T01:35:19.193

马克在我打字的时候回答了第一部分。

您拥有的第二组表达式不是必需的，并且是不好的做法；您正在向您不拥有`release`的字符串发送消息。`toDelete`您正在声明指向字符串的指针，但没有指向字符串`alloc`的内存（也没有调用`retain`它），因此您不拥有`toDelete`指向的对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-12T10:21:10.557

您可能不需要更多：

```
NSString *someString = [myStrings componentsJoinedByString:@","]; 
```

componentsJoinedByString：返回一个你不拥有的对象，但你至少可以在方法的其余部分使用它，所以它对局部变量很有用。

```
NSString *someString = [[NSString alloc] initWithString: [myStrings componentsJoinedByString:@","]];
NSString *someString = [[myStrings componentsJoinedByString:@","] copy]; 
```

这两者大致相当。你是正确的，你不需要释放 componentsJoinedByString: 的返回值，所以你不需要保留对它的引用足够长的时间来这样做。你可以得到它并在同样的表达式中使用它。Objective C 的内存管理模式可以帮助你编写漂亮的代码，而不必为了内存管理而声明大量额外的局部变量和编写大量代码行。

但这些都不是很有用。没有其他代码可以访问从 componentsJoinedByString: 返回的对象，因此没有理由制作私有副本。执行上述操作的唯一原因是如果您想拥有该对象，在这种情况下，获得它的所有权的更简单方法是向它发送一条保留消息。

```
NSString *someString = [[myStrings componentsJoinedByString:@","] retain]; 
```

或者

```
NSString *someString = [myStrings componentsJoinedByString:@","];
[someString retain]; 
```

如果您想将对象保留更长时间，您会这样做，但通常只有将其直接分配给实例变量。如果将其分配给属性，则大多数属性都被声明为保留，这意味着它们会为您保留。

# java - 从 C 源代码到 Java 字节码？

> ID：459822
> 
> 赞同：10
> 
> 时间：2009-01-20T01:10:51.550
> 
> 标签：java, c, bytecode, cross-compiling

我正在寻找一种将 C 源代码编译成高性能 Java 字节码的方法。我已经成功使用[了 NestedVM](http://wiki.brianweb.net/NestedVM/NestedVM)，但是对于我正在处理的项目来说，性能损失是不可接受的。我还看到了针对这个问题的各种开源项目和一些商业产品。 [这个 SO question](https://stackoverflow.com/questions/46758/tools-for-converting-non-java-into-java-source)处理将非 Java 转换为 Java 源的一般问题，但我只想从 C 到 Java 字节码。

将 C 源代码编译为高性能、纯 Java 字节码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-22T13:35:37.027

Being the author of [Cibyl](http://code.google.com/p/cibyl/wiki/Cibyl), I might be biased here. Anyway, I've looked at the java bytecode generated by the axiomatic C compiler, and it is not efficient. NestedVM and Cibyl both works by compiling MIPS binaries and then translating the binary into Java bytecode. It's surprisingly efficient, with the main problem being memory access of 8- and 16-byte values (which needs to be done in multiple steps).

NestedVM and Cibyl have slightly different performance characteristics, with Cibyl typically being faster for integer-heavy workloads whereas NestedVM handles floats and doubles better. This is because Cibyl uses GCC soft-float support (though using "real" Java bytecode floating point instructions) while NestedVM translates MIPS FPU instructions.

Cibyl is also more targeted to J2ME environments, although it's definately useable on other platforms as well. My guess is that you would have more luck with either of them than with the Axiomatic C compiler.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T01:37:26.693

这并不完全符合您的要求，但[Cibyl](http://spel.bth.se/index.php/Cibyl)将已*编译*的C 程序转换为 JVM 字节码。这与 NestedVM（您提到的）的想法相同，但对于您的任务来说可能更快，因为它是一个独立的实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T01:39:17.640

我相信有些项目已经尝试过这个，但是没有办法处理指针，而不会对什么可以访问什么有一些非常严格的限制（基本上它们必须转换为数组索引和分配的数组而不是内存）

如果你有 C 而不过多依赖指针，并且你希望它进入 JVM，你可能只是将它转换为 Java——应该很容易并且性能应该不会太差。在大多数领域，C 仍然比 Java 高出大约 2 倍，有些领域更差，在少数领域，Java 实际上胜过 C（堆内存管理，例如），但与大多数其他语言（至少是解释型语言）相比，java 和 c 是快 100 倍，所以从这个角度来看，它们之间的区别是毫无意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-12T08:45:32.423

试试 C2J 软件......

在谷歌中输入 c 到 java 翻译器。你会得到下载链接

# sql - SQL - 默认列

> ID：459824
> 
> 赞同：0
> 
> 时间：2009-01-20T01:12:00.317
> 
> 标签：sql

我有以下 SQL 语句

```
SELECT table1.col1, table2.col2 FROM table1, table2 WHERE table1.t_id = table2.t_id
UNION
SELECT table1.col1 FROM table1 WHERE table1.col4 = null 
```

问题是，我这个语法是无效的，因为第二条语句不包含与第一条语句相同的列数。

我不能在第二个语句中包含 table2.col2 因为我不需要它。

无论如何，我是否可以在第二条语句中包含一个默认的第二列，以便我可以让这个查询工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T01:13:45.850

是的，只需使用常数，例如 1 或 ''。

```
SELECT table1.col1, table2.col2 FROM table1, table2 WHERE table1.t_id = table2.t_id
UNION
SELECT table1.col1, '' as col2 FROM table1 WHERE table1.col4 = null 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T01:14:18.407

也许这就是你要找的？您不必从表格中提取值......您总是可以凭空创造它们。:)

```
SELECT table1.col1, table2.col2 FROM table1, table2 WHERE table1.t_id = table2.t_id
UNION
SELECT table1.col1, 'whatever' FROM table1 WHERE table1.col4 is null 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T01:54:52.757

我通常使用`NULL`（应该强制转换为任何类型）：

```
SELECT table1.col1, table2.col2 FROM table1, table2 WHERE table1.t_id = table2.t_id
UNION
SELECT table1.col1, NULL AS col2 FROM table1 WHERE table1.col4 = null 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T01:54:58.683

对虚拟列使用 null 可能是最好的，因此它更像是一个外部连接（除非您有特定的需要，即该列具有特定的值）。

 `````
SELECT table1.col1, table2.col2 
    FROM table1, table2 WHERE table1.t_id = table2.t_id
UNION
SELECT table1.col1, null 
    FROM table1 WHERE table1.col4 = null 
````  `* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T02:28:54.390

进行联合或联合时，所有列数必须匹配。您需要硬编码一个值以放入该列，或者查询 sys.columns 目录视图并获取要插入的列的默认值，并在那里使用该值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T01:16:41.337

只需在列列表中为第二个 SQL 语句中不需要的列使用空 ('') 引号。

# iphone - 哪些开源许可证与 Apple 的 iPhone 及其官方 App Store 兼容？

> ID：459833
> 
> 赞同：66
> 
> 时间：2009-01-20T01:15:13.057
> 
> 标签：iphone, app-store, licensing

我正在编写一个 iPhone 应用程序，我想使用 3rd 方库来实现其部分功能。我打算通过 App Store 出售它，我的代码不会开源。哪些开源许可允许在苹果自己的条件下制作衍生作品并发布？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-01-30T21:03:21.543

简而言之/TL；DR：

LGPL 和应用商店有一些不兼容的地方，这意味着您无权在支持 DRM 的 AppStore 或锁定的设备上分发 LGPL 代码。

最好在其他更宽松的许可证（如 Apache 2 许可证、微软公共许可证或 MIT X11 许可证）下寻找库的替代实现。

更长：

LGPL 规定：

> 此要求可能会与通常不伴随操作系统的其他专有库的许可限制相矛盾。这种矛盾意味着您不能在分发的可执行文件中同时使用它们和库。

将 LGPL 代码与专有代码静态链接的权利来自 LGPL 第 6 节。除了授予该部分的权利之外，该部分还处理您对代码的下游接收者的要求。

您应该详细阅读本节。

# 开发付费与 LGPL 之间的冲突

要求用户付费进入程序并获取密钥证书、配置文件和工具以部署到设备的应用商店与 LGPL 直接矛盾。

LGPL 要求最终用户能够获取您的目标文件以及开源库（以及工具，请参阅下面的部分）并生成一些有效的代码。没有空间让下游接收者必须与苹果、微软、亚马逊或谷歌签订单独的协议才能在他自己的硬件上部署代码的工作版本。

特别是本节是相关的：

> 您不得对接收者行使此处授予的权利施加任何进一步的限制。您不负责强制第三方遵守本许可证。

您不需要授予用户在 AppStore 上重新发布您的应用程序的权利，但您需要授予用户在他们自己的设备上使用修改后的 LGPL 代码版本部署您的应用程序的权利，因此任何需要的开发人员程序或设备部署的额外费用与 LGPL 相冲突。

# 目标文件的分发

您必须确保生成的可执行文件的条款允许接收者更改 LGPL 代码并从中生成新的工作代码。这实际上意味着您需要分发程序的目标文件，以便第三方可以将您的应用程序与库的修改版本重新链接，可能修复错误，以某种方式改进它，或提供他们自己的功能。

您可以通过在您的网站上发布目标文件并提供一个项目以便第三方可以重新链接该应用程序来解决这个问题。不这样做会撤销您对 LGPL 的许可。

# 逆向工程的权利

这是第 6 节的另一个要求。

这可能与各种应用商店的条款直接冲突，但您需要与您正在使用的应用商店（Apple、Amazon、Android 或其他第三方）核实确切的条款。

# 通知和广告

作为 LGPL 代码要求的一部分，交付给下游用户的应用程序必须附带 LGPL 许可证，并在显示任何版权声明的应用程序的任何位置指向此许可证。一些应用程序商店将其发布在应用程序商店网站上，而其他应用程序商店可能在可执行文件本身上拥有版权信息。

# 修改后的 LGPL 代码的分发

这很容易遵守，您只需要在您的网站上分发 LGPL 代码的副本（许可证上有一些额外的细节，关于您需要保持代码可用的时间长度）。

# 您无法满足的要求

LGPL 和在通过应用程序商店分发的应用程序中使用静态库的主要问题之一是要求您分发最终用户重建软件所需的工具和脚本。

对于某些嵌入式系统场景，您会要求嵌入式系统供应商向任何最终用户披露其开发工具和 API，这可能是不可能的。目前尚不清楚是否可以自由重新分发 iPhone 或 Windows SDK 之类的东西以履行本案中的义务，您可能需要与您的律师讨论并了解您对这些要求的公开程度有多满意。

# 你可以做什么

如果您绝对需要在应用商店或嵌入式系统中使用某些 LGPL 代码，您可以随时联系代码的原始作者，并要求他们根据不同的条款授予您对代码的许可。

或者，您可以在其他更宽松的许可证（如 Apache 2 许可证、Microsoft 公共许可证或 MIT X11 许可证）下寻找库的替代实现。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-10-25T18:04:52.007

Apple App Store 与 GPL 和 LGPL 以及 Affero GPL 的所有版本中都存在的 FSF 的 copyleft 理念不兼容。Apple App Store 不允许用户获取免费软件，对其进行修改，然后在自己的设备上自由运行。他们要求您使用 DRM，每年支付 100 美元，同意他们的附加条款等。这里有一篇很好的文章：http: [//michelf.com/weblog/2011/gpl-ios-app-店铺/](http://michelf.com/weblog/2011/gpl-ios-app-store/)

在 App Store 之外分发适用于 iOS 的 GPL/LGPL 软件是完全合法的，问题在于 Apple App Store。所以我建议游说苹果改变他们的限制。Mac OS X 和 iOS 甚至从根本上依赖 GPL/LGPL 软件（例如 gcc 等等），因此 Apple 享受着自由，但它却剥夺了用户同样的自由。

至于 App Store 兼容的许可证，您需要使用非常宽松的许可证，例如 BSD、MIT、Apache 或公共域。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-08-24T10:51:11.373

关于 LGPL，我认为 St3fan 是不正确的，但 Louis Gerbarg 是正确的：可以在闭源 iPhone 应用程序中使用 LGPL 库，但有限制。

如果您查看[http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License](http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License)，您可以阅读“或者，如果提供了源代码或可链接目标文件，则允许使用静态链接库。”

因此，正如 Louis Gerbarg 所提到的，如果您使用 LGPL 库，则只要您免费提供客户获取您的应用程序所需的对象（例如 *.o）文件，就可以让您的应用程序保持封闭源代码，并且链接它。

我在这里深入探讨了[iPhone 和 LGPL 兼容性](http://huyzing.com/2009/08/24/compatibility-between-the-iphone-app-store-and-the-lgpl/)的主题。

* * *

库的 LGPL 许可证对您的应用程序的详细要求：

d) 执行以下操作之一：

0) 根据本许可证的条款，以适合并在允许用户将应用程序与链接版本的修改版本重新组合或重新链接的形式传送相应的应用程序代码，以产生一个修改的组合工作，以 GNU GPL 第 6 节指定的方式传送相应的源代码。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-20T02:00:40.437

我认为 LGPL 不适用于 iPhone 应用程序。

问题是 iPhone 运行时不允许您将共享库（或框架）与您的应用程序捆绑在一起。只允许单个二进制应用程序。LGPL 基于您将共享库与应用程序捆绑在一起的假设。仍然禁止直接链接。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-20T01:18:14.623

这不是法律建议，我不是律师，但听起来您需要一个具有 BSD 或 Apache 许可证的库。如果您正在开发使用开源库的专有桌面程序，就会出现这种情况。我不知道苹果是否对 iPhone 应用程序有任何进一步的限制。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-02T20:50:19.247

（我不是律师。）

静态目标文件链接可以解决如何允许使用 LGPL 许可代码的应用程序可用而不分发其源代码的非 LGPL 部分的问题。

但似乎 LGPL 作为 GPL 的一个变体，给 iPhone 应用程序开发带来了一个更大的无法克服的问题，因为创建和分发任何 iPhone 应用程序所需的开发工具只能根据与 GPL 不兼容的 Apple 条款提供。IE。每年收取 100 美元的费用，并且有许多关于使用不属于 GPL 许可的工具的条款和条件。Apple 的 iPhone 开发工具的许可条款似乎与 GPL 的精神，或许也与 GPL 的文字不兼容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-01-31T03:02:38.793

当我尝试将[Fuego 移植到 iPhone 上时，我在](http://ho.race.hk/blog/?p=365)[fuego 邮件列表](http://sourceforge.net/mailarchive/forum.php?forum_name=fuego-devel)上问了一个类似的问题。到目前为止，我的理解是“LGPL与 AppStore*不*兼容”。上一个[问题](https://stackoverflow.com/questions/3314122/what-files-do-i-need-to-distribute-if-requested-to-comply-with-lgpl-in-an-iphone)也得到了答案：否。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-04-12T23:40:29.600

一个很好的例子是 Wunderradio。他们使用 ffmpeg 和其他 LGPLv2 许可框架，并在其网站上提供 .o 文件。

奇怪的是，他们还为他们的应用程序提供了完整的源代码。

[http://wunderradio.com/code.html](http://wunderradio.com/code.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-02T21:18:46.600

如果您不发布源代码，则不能使用任何严格的 copyleft 许可证。在任何情况下，您都不能使用任何基于 GPLv3 的许可证，因为 iPhone 分发与 no-Tivoization 条款冲突。

如果您使用 LGPLv2，则必须以可链接格式提供您的程序，这可能是可接受的，也可能是不可接受的（至少它不是源代码），这可能是您不想处理的事情，除非图书馆提供了很多好处。

如果图书馆有一个版权所有者，您可以随时查看是否可以获得许可例外。

你不会对典型的 BSD/MIT/Boost/任何许可许可证有任何问题。那里有很多开源/自由软件许可证，其余的你必须阅读它们并查看。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-23T00:42:23.750

那些认为 App Store 服务条款存在问题的人，尤其是每年 100 美元的 Apple Dev 计划费用，是错误的。那 100 美元甚至还不算大卖。开发人员通常会花费大量时间来担心这类事情；0) 数千年来，律师一直在处理合同条款，这些条款几乎不值得为此浪费任何时间。

先决条件：从可通过应用程序中的链接访问的 Web 位置提供目标文件和基本项目文件。

选项 1，对于牛仔：越狱是正式合法的（并且免费）。仅此一项就消除了对 LGPL 和 App Store 条款之间兼容性的任何担忧。LPGL 在哪里指定特定的分销渠道？无处。您想在通过应用商店下载的应用中升级静态链接库吗？接受它，阿尔法开发和越狱你的手机！仅仅因为 Apple 在操场上是个恶霸并不能强迫你继续他们的旋转木马。因此，有进取心的开发人员可以在下一次聚会上获得宝贵的吹牛权。再加上您为了升级 LPGL 库而越狱了您的手机，这让您可以访问 Richard Stallman 地下室的酒桶室！

合法且善意地绕过它的选项 2：LGPL v2.1 的第 1 节（和 GPL v3 的第 4 节）允许开发人员对复制库的实际行为收取费用。这为开发人员提供了一种机制，可以将该费用重新分配到 99 美元的 Apple Dev 订阅费中。

100 台设备的限制呢？希望升级其二进制文件的最终用户正在升级商业应用程序，因此应用程序开发人员自己的许可条款开始发挥作用。将 100 台设备限制添加到自定义许可协议中很简单。有多少人拥有超过 100 台 iOS 设备？就连乔布斯也没有那么多！这几乎不是一个不合理的限制。鉴于没有要求最终用户被允许将他们自己的修改版原始商业应用程序发布到野外，因此当它无法加载到修改者的第 101 位朋友的设备上时，将没有任何投诉的依据。

LGPL 没有要求最终用户必须有一个舒适、无风险甚至是显而易见的选择。他们只需要有一个选择，而且有两个非常好的选择。

# javascript - 可以防止我们的网站在另一个域的框架集或 IFrame 中运行吗？

> ID：459835
> 
> 赞同：6
> 
> 时间：2009-01-20T01:15:42.413
> 
> 标签：javascript, dns, frame, frameset-iframe

我们最近遇到了一个问题，即其他网站在一个框架集中运行我们的电子商务网站，而我们的网站（带有违规者附属 ID）是单个全宽框架中的唯一内容。所以本质上它看起来和感觉就像我们的网站，他们的 URL 在顶部。我们可以切断他们的会员 ID，这会使他们这样做毫无意义，但这并不能阻止未来的罪犯在我们发现之前做同样的事情。

有没有一种通用的方法（通过可能出现在每个页面上的 JavaScript？）来防止这种情况发生？请注意，向所有链接添加目标是不可行的，但是向所有页面添加一个 JS 片段是可行的，因为页眉和页脚部分是从单一来源在站点范围内共享的。

另一种可能性是在 Apache 级别（如果我们可以在服务器端做任何事情），因为我们确实通过 mod-rewrite 传递所有请求。

请注意，如果父页面源自我们的域，则必须允许页面在 IFrame 中加载，因为我们有效地使用了 IFrame

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T01:27:32.890

我听说这个问题的解决方案被称为“框架弹出脚本”。一个快速的谷歌提出了[这个线程](http://www.webmasterworld.com/google/3226698.htm)。看起来这是最简单的一种：

```
if (window != top) top.location.href = location.href; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-20T15:21:02.077

我相信实现这一点的正确现代方法是使用[X-Frame-Options 响应标头](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)。

来自 MDN：

> X-Frame-Options HTTP 响应标头可用于指示是否应允许浏览器在框架或 iframe 中呈现页面。网站可以使用它来避免点击劫持攻击，方法是确保其内容不会嵌入到其他网站中。

看看：[如何防止 IFRAME 重定向顶级窗口](https://stackoverflow.com/questions/369498/how-to-prevent-iframe-from-redirecting-top-level-window?rq=1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T01:21:31.247

看看这篇文章。它提供了一个相当简单的解决方案来检测帧并打破它们。

[如何使用 JavaScript 打破框架](http://www.thesitewizard.com/archive/framebreak.shtml)

此外，我会更进一步。每当您检测到框架时，获取违规站点框架的附属 ID，然后使用 AJAX 将其连同他们使用的 URL 一起推送到服务器。然后，无论是自动还是手动，您都可以验证他们是否在构建您的网站，并一次取消他们的会员代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T01:20:39.020

只是在这里猜测......但是如果你使用 javascript 调用你的父窗口来访问它的文档对象呢？你可以检查它是否不为空，如果有一个父窗口（意味着一个框架加载了你的网站），你可以通过 javascript 隐藏你所有的 html...

# asp.net-mvc - MVC asp.net：提交多个表单

> ID：459861
> 
> 赞同：5
> 
> 时间：2009-01-20T01:32:05.907
> 
> 标签：asp.net-mvc, forms

从视图提交一个表单时，我如何在同一页面中读取或让控制器读取另一个表单中的数据？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T01:42:10.177

当您使用浏览器提交表单时，它只会发送该 <form></form> 中的字段的数据。无论您使用哪种后端技术，无论是 ASP.net、MVC.net、PHP、Python 等，都是如此。

我能真正想到的唯一两个选择是：

1.  像 WebForms 一样，在整个页面周围放置一个 <form>，然后根据按下的按钮对结果进行排序。
2.  使用 Javascript/AJAX 收集您喜欢的任何数据，并以您喜欢的任何方式推送它。您甚至可以实时执行其中的一些操作（例如选中复选框时），而不会导致页面回发。

当然，各有利弊，但这就是野兽的本性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T01:43:04.763

您可以结合 Ajax 和 Javascript 在客户端执行此操作...

```
<SCRIPT language="JavaScript">
function submitforms()
{
        new Ajax.Request(formUrl,
        {
            parameters: $H({param1:value,param2:value}).toQueryString(),
            method: 'post',
            onSuccess: function(transport) {
               document.myform.submit();
            }
        }
}
</SCRIPT> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T01:34:49.803

你不能。如果您在要提交的页面上有信息，则必须将其包含在提交的表单中。不过，您可以在提交时使用 JavaScript 将信息从一个表单复制到下一个表单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-26T15:53:45.600

```
 var formData1 = $("#form1").serializeObject();
        var formData2 = $("#form2").serializeObject();
        $.extend(formData1, formData2);
        var formData = JSON.stringify(formData1);

        $.ajax({
            type: "POST",
            url: "@Url.Action("MyAction", "MyController")",
            data: formData,
            dataType: "json",
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                ...Do something with the data
            },
            error: function(result) {
                ...Handle the error
            }
        }); 
```

然后在您的控制器端（我正在使用 MVC，但 WebAPI 可能会工作相同），您可以声明两个与您的客户端模型匹配的单独参数，并且一切都会为您整理好，假设您没有重叠属性名称！当魔法发生时一定会爱上它！

```
public ActionResult MyAction(FormDataModel1 formData1, FormDataModel2 formData2) 
```

归功于[https://github.com/macek/jquery-serialize-object](https://github.com/macek/jquery-serialize-object)的 serializeObject 代码。

# asp.net - 将 ASP.NET 验证与 JQuery 相结合的优雅方式

> ID：459871
> 
> 赞同：12
> 
> 时间：2009-01-20T01:39:00.120
> 
> 标签：asp.net, jquery

如何最好地将 JQuery 与 ASP.NET 客户端验证模型结合起来？

我通常避免实现 ASP.NET 验证模型，因为它似乎总是对我正在做的事情来说太过分了。对于我现在正在处理的网站，我只是收集非关键用户数据，只需要一些基本的验证。我不希望消息出现在 DOM 或类似的东西中。无论如何，我总是发现很难让它看起来正确。

但我现在需要实现一些更优雅的东西。我想在 JQuery 中利用的是聪明的搜索表达式，例如“告诉我是否至少选中了一个复选框”。我是 JQuery 的新手，但我认为这大约是 1 行 JQuery，在传统的 ASP.NET 模型中要复杂得多。

所以我想充分利用 JQuery 的能力，但又不想完全否定 ASP.NET 的验证模型。

到目前为止，我最好的方法是这样的（这几乎是在 ASP.NET 的背后）：

```
$('#<%=btnJoinMailingList.ClientID %>').bind('click', function(event) {

   if (...) {
       alert("You must enter a name");
       return false;
   }     
   return true;
}); 
```

这里有什么更好的方法？有没有推荐的 JQuery 插件？

PS。我不想使用 MVC 模型。我正在尝试创建一个非常“RAD”的网站，但还没有时间深入研究那些有趣的新东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-21T15:02:15.943

ASP.NET 有许多验证控件，其中之一是[`CustomValidator`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx).
您可以给它一个自定义的 JavaScript 函数，该函数使用 jQuery 并返回`true`或`false`通过参数。您可以使用此控件自动显示错误消息，或者只运行 jQuery 代码并手动处理显示。

ASP:

```
<asp:CustomValidator ID="CustomValidator1" runat="server" Display="None"
                     ClientValidationFunction="checkTextareaLengths">
</asp:CustomValidator> 
```

JavaScript：

```
function checkTextareaLengths(source, args){
  args.IsValid = true;
  $('textarea').each(function(){
    if($(this).text().lenght > 400)
      args.IsValid = false;
  });
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T02:17:38.797

ASP.NET webforms 和 jQuery 的验证模型非常非常相似，恕我直言，两者都是客户端，实现其中一个不一定会破坏另一个。唯一真正的区别是，在幕后，`Page.Validate()`如果您有一个未验证的字段，ASP.NET 验证器将导致该方法返回 false。

您可以选择手动滚动您自己的验证控件，然后导致相同的行为，但正如您自己所说，这可能是矫枉过正。

jQuery 也有它自己的 Validator 插件，你可能想看看：[http](http://docs.jquery.com/Plugins/Validation/Validator) ://docs.jquery.com/Plugins/Validation/Validator 。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-24T12:41:54.913

ASP.NET 验证器是一个带有附加属性的跨度。使用 jquery，您可以访问页面上的所有验证器或按 jquery 支持的任何条件过滤它们。要通过 javascript 调用 ValidatorValidate 函数强制验证。例如：

```
function validate_step(step_element) {
        // find all validators on step_element and force validation
        var validators = $(step_element).find("span[controltovalidate]");
        var stepIsValid = true;
        validators.each( function() {
           ValidatorValidate(this); stepIsValid &= this.isvalid;
        });
        return stepIsValid;
    } 
```

# email - 对事后进行电子邮件分析（Exchange 或 IMAP）

> ID：459876
> 
> 赞同：1
> 
> 时间：2009-01-20T01:45:07.690
> 
> 标签：email, outlook, imap, analysis

我最终在工作中做了一些紧急 PM 的事情，我想对我的电子邮件进行死后检查，看看我在和谁说话，我做错了什么。我正在寻找有关工具的建议，这些工具可以让我查看我发送/接收的电子邮件数量，也许还可以查看各种统计数据等。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T01:59:24.213

由于您使用的是 Outlook，请尝试使用[Xobni](http://www.xobni.com/)，它提供基于每个用户的电子邮件统计信息。

# data-dictionary - 有没有每个单词由音节分隔的英语单词词典或数据库？

> ID：459877
> 
> 赞同：10
> 
> 时间：2009-01-20T01:45:20.577
> 
> 标签：data-dictionary

我正在寻找一个现有的英语单词数据库，每个单词由音节分隔。我的目的是根据音节的分离进一步编辑任何选定文章中的每个单词。

有谁知道可以帮助我实现这个过程的现有产品或方法？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-11-05T01:57:44.233

该站点有一个包含 44K 单词的文件，其中包含音节，而不仅仅是连字符。

[http://www.delphiforfun.org/programs/Syllables.htm](http://www.delphiforfun.org/programs/Syllables.htm)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T01:52:48.750

我不确定这是否是您要查找的内容，但 CMU 有一个发音词典，可以清楚地显示每个音节：

[http://www.speech.cs.cmu.edu/cgi-bin/cmudict](http://www.speech.cs.cmu.edu/cgi-bin/cmudict)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T03:21:55.857

也许一个标准的单词列表，加上一个好的[断字算法](http://nedbatchelder.com/code/modules/hyphenate.html)就可以了？

# html - HTML/CSS：表格脱离单元格。正常吗？怎么修？

> ID：459889
> 
> 赞同：1
> 
> 时间：2009-01-20T01:51:00.533
> 
> 标签：html, css, html-table

我在单元格中有一个表格，该表格正在“离开”单元格，如以下屏幕截图所示：

[替代文字 http://img.skitch.com/20090120-pe4iykdqpymqaxr96tpubiqn7j.png](http://img.skitch.com/20090120-pe4iykdqpymqaxr96tpubiqn7j.png)

我在 Firefox 上看到了这个。这是“正常”吗？我怎样才能解决这个问题？

编码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <body>
        <table border="1">
            <tr>
                <td>
                    <table border="1" style="margin-left: 3em; width: 100%">
                        <tr>
                            <td>gaga</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T01:58:35.510

内表被告知与其容器一样宽（`width: 100%`），然后从左边缘移动 3ems：（`margin-left: 3em`）

将最里面的 TD 切换到`padding-left`可能有帮助的位置。

但这里的标准反应是：“哦，天哪，你为什么要做嵌套表，你这个坏坏人！！11”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T01:54:11.540

未经测试：取出 'margin-left' 并改用 'padding-left'。

或者

您可以在不使用嵌套表的情况下缩进单元格值，方法是将 padding-left 添加到父表“td”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T01:59:56.507

发生这种情况是因为您正在设置“margin-left：3em”，并且它正在向外推动子表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T02:35:36.497

尝试这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <body>

        <table border="1">
            <tr>
                <td style="padding-left: 3em;">
                    <table border="1" style="width: 100%;">
                        <tr>
                            <td>gaga</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

        <table border="1">
            <tr>
                <td>
                    <table border="1" style="margin-left: 3em; width: 100%">
                        <tr>
                            <td>gaga</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>

    </body>
</html> 
```

在父 TD 上将 margin-left 从 TABLE 元素更改为 padding-left （就像**Jobo**说的）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T03:18:09.983

只需删除该表的“宽度”属性，您应该会看到它会保留在单元格内，即使是长文本也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T01:56:09.103

这是因为您将表格宽度设为 100%。它将边距添加到此元素上，以使元素具有> 100％的宽度。如果您想解决这个问题，请在嵌套表格上方添加一个 div 或其他内容，边距为：3em，您可以将表格的宽度保留为 100%。

编辑：为了回应乔博对他的回答的评论，tds 不支持边距；但是， padding-left: 3em 应该可以代替。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-20T01:57:16.900

这不是攻击，而是帮助您成为更好的开发人员：

1.  **永远**不需要有子表。
2.  如果您要使用 CSS，那么就使用一个或多个外部文件。
3.  这将帮助您作为 Web 开发人员进行开发 - 考虑您希望如何构建页面，然后使用正确的标记来生成该结构 - 一旦标记有效，您**就**可以担心样式。

# svn - 是什么让一些版本控制系统更擅长合并？

> ID：459891
> 
> 赞同：29
> 
> 时间：2009-01-20T01:52:26.350
> 
> 标签：svn, git, version-control, mercurial, merge

我听说许多分布式 VCS（git、mercurial 等）比 Subversion 等传统 VCS 更擅长合并。这是什么意思？他们做了哪些事情来让合并变得更好？这些事情可以在传统的 VCS 中完成吗？

额外的问题：SVN 1.5 的合并跟踪是否完全符合竞争环境？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-20T18:04:59.367

SVN 的合并能力不错，简单的合并场景也能正常工作——例如发布分支和主干，其中主干跟踪 RB 上的提交。

更复杂的场景会很快变得复杂。例如，让我们从一个稳定的分支 ( `stable`) 和`trunk`.

你想演示一个新特性，并且更喜欢基于它`stable`，嗯，比 更稳定`trunk`，但是你希望你的所有提交也被传播到`trunk`，而其他开发人员仍在修复`stable`和开发东西上`trunk`。

因此，您创建了一个`demo`分支，合并图如下所示：

*   `stable -> demo -> trunk`（你）
*   `stable -> trunk`（其他开发者）

但是，当您将更改从`stable`into`demo`合并，然后再合并`demo`到`trunk`，而其他开发人员也一直在合并`stable`到时，会发生`trunk`什么？SVN 与`stable`两次合并到`trunk`.

有一些方法可以解决这个问题，但是对于 git/Bazaar/Mercurial，这根本不会发生 - 他们意识到提交是否已经被合并，因为他们在它所采用的合并路径中标识了每个提交。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-27T21:07:11.840

*大多数答案似乎是关于 Subversion 的，所以这里有一个关于 Git（和其他 DVCS）的答案。*

在分布式版本控制系统中，当您将一个分支合并到另一个分支时，您会创建新的**合并提交**，它会记住您如何解决合并，并**记住合并的所有父级**。在 1.5 版之前的 Subversion 中根本就缺少这些信息；为此，您必须使用其他工具，例如 SVK 或 svnmerge。在进行重复合并时，此信息非常重要。

多亏了这些信息，分布式版本控制系统 (DVCS) 可以**自动**为任何两个分支找到共同祖先（或共同祖先），也称为合并基础。看看下面的 ASCII-art 修订图（我希望它没有被严重破坏），

```
---O---*---*----M---*---*---1
     \ /
       \ - -* - -A2

```

如果我们想将分支“2”合并到分​​支“1”，我们想要用来生成合并的共同祖先将是标记为“A”的版本（提交）。但是，如果版本控制系统没有记录有关合并父级的信息（“M”是相同分支的先前合并），它将无法找到提交“A”，它会找到提交“O”作为共同的祖先（合并基础）......这将重复已经包含的更改并导致大的合并冲突。

分布式版本控制系统必须从一开始就做对，即他们必须使合并非常容易（无需标记/标记合并父级，并手动提供合并信息），因为让其他人获取代码的方式into project 不是给他/她提交访问权限，而是从他/她的存储库中提取：从另一个存储库获取提交并执行合并。

您可以在 Subversion 1.5 中找到有关合并的信息。在[Subversion 1.5 发行说明](http://subversion.tigris.org/svn_1.5_releasenotes.html#merge-tracking "Subversion 1.5 中的新功能：合并跟踪（基础）")中。注意问题：您需要*不同*的（！）选项将分支合并到主干而不是将主干合并到分支，也就是。并非所有分支都是平等的（在分布式版本控制系统中，它们[通常]在技术上是等效的）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T02:12:03.423

1.5 中的合并跟踪比没有合并跟踪要好，但它仍然是一个非常手动的过程。我确实喜欢它记录哪些 rev 合并和未合并的方式，但它远非完美。

Merge 在 1.5 中有一个不错的对话框。您可以选择要单独合并的修订版或整个分支。然后，您触发在本地发生的合并（并且永远持续），然后为您提供一堆文件供您阅读。您需要从逻辑上检查每个文件的正确行为（最好通过对文件的单元测试运行），如果有冲突，则必须解决它们。一旦您感到高兴，您就可以提交您的更改，此时分支被认为是合并的。

如果你分片做，SVN会记住你之前说的你已经合并了，允许你合并。我发现一些合并的过程和结果至少可以说很奇怪......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T04:34:25.960

这些版本控制系统可以做得更好，因为它们有更多的信息。

SVN pre-1.5，以及最新一代之前的大多数 VCS，实际上并不记得您在任何地方合并了两个提交。它记得这两个分支在第一次分支时共享一个共同的祖先，但它不知道任何可以用作共同点的最近合并。

我对 SVN post 1.5 一无所知，所以也许他们对此有所改进。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T02:03:26.047

轻率的回答：为什么有些编程语言在文本/数学方面比其他语言更好？

真正的答案：因为他们必须是。分布式 VCS 进行大部分合并时，冲突代码的作者都无法手动调整合并，因为合并是由第三方完成的。结果，合并工具*在*大多数情况下都必须正确处理。

与 SVN 签订合同，如果你最终合并了一些你没有写过一侧或另一侧的东西，那么你正在做一些时髦的事情（而且是错误的？）。

IIRC 大多数 VCS 可以根据您要求他们使用的任何内容进行合并，因此（理论上）没有什么可以阻止 SVN 使用 GIT/mercurial 合并引擎。YMMV

# sql-server-2005 - 如何指定计算的 varchar 列的宽度？

> ID：459893
> 
> 赞同：1
> 
> 时间：2009-01-20T01:53:45.363
> 
> 标签：sql-server-2005, tsql

我想在一个表中创建一个持久计算列，以便我可以将它用作与另一个表的外键关系的一部分。

我有这些表：

Events (EventID uniqueidentifier, EventCode varchar(8)) -- EventCode 是一个鉴别器列

各方（EventID 唯一标识符）

...并且我想将 EventCode 列添加到“Parties”，以便外键约束可以包含这两列。

我试过这个：

```
ALTER TABLE Parties ADD EventCode AS 'PARTY' PERSISTED 
```

但这会将列添加为，我不知道，char(5) 或其他内容（因为列的类型是从表达式中推断出来的）。所以我不能将它与 Events.EventCode 联系起来，因为这两列的宽度不同。

有没有办法指定计算列的宽度，或者我必须这样做（这看起来很难看，但我认为会起作用）？

```
ALTER TABLE Parties ADD EventCode AS CAST('PARTY' AS varchar(8)) PERSISTED 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T02:32:53.833

您需要将值转换为所需的大小和数据类型。放入静态字符串将使 SQL Server 使用 CHAR，因为这比 VARCHAR 更具成本效益。

如果您想在定义中没有 CAST 的情况下执行此操作，则需要将该值填充为 8 个字符“PARTY”，然后在进行连接时将其转换为 VARCHAR（这会降低数据库性能）。

# iphone - 事件的 Cocoa Touch 行为

> ID：459898
> 
> 赞同：0
> 
> 时间：2009-01-20T01:56:01.490
> 
> 标签：iphone, cocoa-touch

关于在应用程序中调用事件方法时的行为，我已经多次阅读 iPhone 编程指南。

根据指南所说：当手指第一次触摸屏幕时调用 touchesBegan。

当屏幕上的手指移动时调用 touchesMoved。

当手指离开屏幕时调用 touchesEnded。

涉及多个手指的问题变得有点模糊：

即使 Multi-touch Interaction 标志设置为 NO，应用程序仍会继续调用当前正在跟踪另一个触摸的视图的 touchesBegan 方法。这对我来说似乎违反直觉。

这是正确的行为吗？我认为新的 UITouch（甚至添加到正在跟踪的当前事件）不会触发 touchesBegan 方法。

值得注意的是，我在 IB 中以及以编程方式设置了这个标志，以确保我没有遗漏任何东西。

谢谢，科里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T02:04:18.370

是的，我相信这是正确的行为。您可以跟踪每个触摸事件的位置，因此我认为您只需要构建逻辑以便处理：

```
UITouch *touch = [[allTouches allObjects] objectAtIndex:0]; 
```

第一次接触，第二次接触 objectAtIndex:1。我认为它上升到四五个（不确定，请参阅文档）。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T04:30:28.387

我发现了我的问题，但首先要澄清多次触摸的正确功能：

如果您的视图的 multipleTouchEnabled 标志设置为 NO，则该视图的 touchesBegan 方法不应在第二次触摸应用于屏幕时触发。

有了这个，我的问题的解决方案：

我的视图包含几个子视图。视图负责处理自己和子视图的触摸。

当我的代码无法正常运行时，我有子视图的 userInteractionEnabled = YES。这意味着当子视图被触摸时，它会将触摸转发到父视图，而不管父视图是否正在跟踪另一个触摸。

换句话说，尽管 UIApplication 尊重视图的 multiTouchEnabled 标志，但响应者链中的其他视图却没有。

# c++ - opengl 的窗口处理程序

> ID：459901
> 
> 赞同：2
> 
> 时间：2009-01-20T01:56:54.280
> 
> 标签：c++, opengl, graphics, 3d, glut

我一直在使用 glut 作为我的窗口处理程序来编写 opengl，最近我一直在考虑切换到备用窗口处理程序（如 wxWidgets 或 qt）是否有任何优势。

是否有任何重大差异，或者只是口味问题？由于 glut 为 opengl 编程提供了窗口处理功能之外的一些额外功能，将额外的工具包与 glut 相结合是否有意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T02:03:36.640

我只能从使用 QT 的经验说：

一旦你设置了基本结构，那么它就是一个做你一直在做的事情的简单案例：例如，我目前正在处理的项目在窗口中嵌入了一个打开的 gl 小部件。

此小部件具有诸如 initializeGL、resize...paintGL 等功能。优点包括能够将变量从其他窗口/小部件等传递给 an东西需要一些更复杂的数学）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T03:05:13.333

一旦您想要更复杂的控件和对话框等，您就需要摆脱过剩。

QT 有一个出色的[openGL 小部件](http://doc.trolltech.com/4.4/qglwidget.html)，在时事通讯中还有一篇有趣的文章，关于[在 GL 上绘制控件](http://doc.trolltech.com/qq/qq26-openglcanvas.html)以提供酷炫的 WPF 样式效果。

wxWidgets 还附带了一个[opengl 示例](http://www.wxwidgets.org/docs/tutorials/opengl.htm) ，但我没有太多经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T02:07:23.637

好吧 - 过剩是可以让原型运行的。

这取决于操作系统，但稍后您可能想要阻止屏幕保护程序启动，您可能想要禁用任务开关（虽然只有坏人这样做），您可能想要对断电事件做出反应。您可能会发现 glut 无法处理一个或另一个操作系统上的死键，或者，或者，或者......您可能想要摆脱它的原因有上千种。

它是一个框架，旨在使开始变得容易并完成您需要的 90% 的日常工作，但它永远无法做到 100%。您总是可以让自己陷入过剩或取消初始化代码，但有一天您会发现从头开始重新设计初始化代码并根据您的任务进行调整会更容易。

打开一个窗口并初始化 OpenGL 不是火箭科学。只要它对你有用，就使用过剩，但一旦它产生问题就摆脱它。它只需要你几个小时的时间，所以你不会失去太多。

对于一个玩具项目来说，过剩是要走的路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T10:19:31.437

[SDL](http://www.libsdl.org/)虽然不仅仅是一个窗口处理程序，但它会使 OpenGL 比原始 Win32 代码更容易使用。但是，我在 Qt、GTK 和 wxWidgets 方面的经验并不算太差……当然不会比 Win32 好多少，在这些情况下可能只是个人喜好问题。

如果您想对窗口和资源进行精细控制，我建议您避免使用像 GLUT 这样的小部件和包装器，但如果您只是在寻找开发速度，那么这些工具是理想的选择。

# asp.net - 具有 SQL 架构的 ASP.NET 成员资格提供程序

> ID：459910
> 
> 赞同：2
> 
> 时间：2009-01-20T02:01:11.263
> 
> 标签：asp.net, sql-server, asp.net-membership, schema, membership-provider

我想使用 ASP.NET Membership Provider 安全框架，但希望它使用 SQL Server 架构。因此，与其拥有像 aspnet_Membership 这样的表，我更希望它是像 sec.Membership 这样的表。有没有人试过这个并让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T02:06:39.660

我相信表名被硬编码到 ASP.NET 的默认 SQL 提供程序中。您必须实现自定义提供程序以执行与默认提供程序相同的操作，但使用备用表名。[本文](http://www.devx.com/asp/Article/29256)可以帮助您弄清楚如何编写自定义提供程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T03:57:25.897

已经有一段时间了，但是当您在数据库中创建 ASPNET Membership 提供程序时，它不会创建一大堆供提供程序自己使用的存储过程吗？如果是这样，您可以编辑表名，并根据需要更新存储过程。存储的过程名称必须保持为生成的状态......

按照建议制作自定义提供程序可能更容易，但它可能是另一种选择......

# cocoa - 如何在可可应用程序中将淡入淡出的文本交叉到 NSTextView 和图像到 NSImageView？

> ID：459918
> 
> 赞同：2
> 
> 时间：2009-01-20T02:09:02.947
> 
> 标签：cocoa, animation, fade, transition

我有一个我正在编写的 Cocoa 应用程序，它有一个带有 TextView 的 ImageView 作为位于 ImageView 顶部的子视图。我有两个函数，一个更新 ImageView 中的图像，一个更新 TextView 中的文本。这两个功能都可以正常工作，但我希望新文本从旧文本淡入或交叉淡入淡出。以同样的方式，我想在新图像中交叉淡入淡出。

我已经为 ImageView 尝试了 [[self animator] setImage:image]，但这似乎没有任何作用。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T10:43:13.393

我不确定这是最好的选择，因为这意味着在几秒钟内将内存使用量翻倍，但是您可以（意思是，不一定应该）创建一个新的 ImageView 和一个新的 TextView，每个不透明度为零，并且相同到原件（当然是新的文本和图像），然后淡出旧的并淡入新的。动画完成后，释放原件

# php - Zend_Form -> 很好地改变 setRequired() 验证消息

> ID：459921
> 
> 赞同：26
> 
> 时间：2009-01-20T02:10:28.857
> 
> 标签：php, zend-framework, zend-form

假设我创建了一个这样的文本元素：

```
$firstName = new Zend_Form_Element_Text('firstName');
$firstName->setRequired(true); 
```

**什么是更改默认错误消息的最佳方法：**

> 值为空，但需要非空值

到自定义消息？我在某处读到替换消息，只需使用 addValidator(...,*而不是 (NO setRequired)*，如下所示：

```
$firstName = new Zend_Form_Element_Text('firstName');
$firstName->addValidator('NotEmpty', false, array('messages'=>'Cannot be empty')); 
```

但在我的测试中，这不起作用 - 它根本不验证 -*它会通过一个空的文本字段。*同时使用两者 (addValidator('NotEmp.. + setRequired(true))*也不起作用 - 它双重验证*，给出*两条*错误消息。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-20T18:25:25.393

设置此“站点范围”的更简单方法是可能在引导程序或基础 zend_controller 中执行以下操作：

```
<?php    
$translateValidators = array(
                        Zend_Validate_NotEmpty::IS_EMPTY => 'Value must be entered',
                        Zend_Validate_Regex::NOT_MATCH => 'Invalid value entered',
                        Zend_Validate_StringLength::TOO_SHORT => 'Value cannot be less than %min% characters',
                        Zend_Validate_StringLength::TOO_LONG => 'Value cannot be longer than %max% characters',
                        Zend_Validate_EmailAddress::INVALID => 'Invalid e-mail address'
                    );
    $translator = new Zend_Translate('array', $translateValidators);
    Zend_Validate_Abstract::setDefaultTranslator($translator);
?> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-20T02:30:28.317

试一试：

```
$firstName = new Zend_Form_Element_Text('firstName');
$firstName->setLabel('First Name')
          ->setRequired(true)
          ->addValidator('NotEmpty', true)
          ->addErrorMessage('Value is empty, but a non-empty value is required.'); 
```

关键是验证器上的“真”，如果你将它设置为真，它会杀死它之后的其他验证。如果您添加了多个验证方法，但将其设置为 false，它将验证所有方法。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-14T04:58:10.700

Zend_Form 将所需的验证错误设置为 'isEmpty'，因此您可以使用 setErrorMessages() 覆盖它的消息。例如：

```
//Your Required Element
$element->setRequired(true)->setErrorMessages(array(
'isEmpty'=>'Please fill this field'
)); 
```

它对我有用，使用 ZF 1.11

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-20T02:58:32.783

尝试

```
->addValidator('Digits', false); 
```

或者

```
->addValidator('Digits'); 
```

您假设要检查 Digits 无论如何都必须具有字符串长度。

另外，我喜欢做一些这样的自定义错误消息：

```
$firstName->getValidator('NotEmpty')->setMessage('Please enter your first name'); 
```

这允许您“获取”验证器，然后“设置”它的属性。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-08-12T09:33:35.700

试试下面的。

```
$subjectElement->setRequired(true)->addErrorMessage('Please enter a subject for your message'); 
```

这对我有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T18:20:41.863

但是试试这个：

```
$firstName->setRequired(true)
          ->addValidator('NotEmpty', false, array('messages' => 'bar'))
          ->addValidator('Alpha', false, array('messages'=>'Must contain only letters')); 
```

如果留空并提交，它将给出两条消息*bar* & ' *' is an empty string*。它来自 setRequired(true) 的第二条消息就是问题所在

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-11T13:30:15.913

如果你把：

```
$element->setRequired(false); 
```

验证根本不起作用，您必须定义：

```
$element->setAllowEmpty(false); 
```

为了获得正确的验证行为。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-26T04:07:06.150

尝试这个..

```
$ausPostcode = new Zend_Form_Element_Text('aus_postcode'); $ausPostcode->setLabel('Australian Postcode')
->setRequired(true)
->addValidator('StringLength', false, array(4, 4))
->addValidator(new Zend_Validate_Digits(), false)
->getValidator('digits')->setMessage('Postcode can only contain digits'); 
```

这仅为 Digits 验证器设置自定义错误消息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-20T02:49:29.527

一个小问题。这段代码：

```
$zipCode->setLabel('Postal Code')
        ->addValidator('StringLength', true, array( 5, 5 ) )
        ->addErrorMessage('More than 5')
        ->addValidator('Digits', true)
        ->addErrorMessage('Not a digit'); 
```

如果任一验证失败，将生成两条错误消息。第一次失败后不应该停止吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-03-22T12:03:40.330

使用带有**zend_validate.php**的zend 翻译器

`ZendFramework-1.11.3\resources\languages\en\Zend_Validate.php and then modify this file how you need`

然后根据您的需要进行相应修改

# .net - 功能级别的源代码共享/控制？

> ID：459935
> 
> 赞同：0
> 
> 时间：2009-01-20T02:19:33.783
> 
> 标签：.net, version-control

是否有任何源代码共享系统可让您在功能级别签入/签出代码？

如果能够只检查一个函数或一个子例程或一个要使用的属性，并且仍然让其他开发人员使用其余部分，那就太好了。

我知道使用主要与合并一起工作的 sorce-control-systems 有点让我这样做，但我喜欢签入/签出系统，但希望它不仅仅适用于整个文件，我希望它适用于函数、对象和较低的代码级别。

之前必须有人对此有所了解，也许有什么东西可以做到这一点？

也许还能够签出#Region 会很好。

我不知道，只是在我看来，我不使用文件，我使用的是我制作的系统的一部分，类、区域、对象、函数的一部分，并且希望 Visual Studio 和我的源代码控制也这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T02:26:59.010

制作您想要的最大代码量，检查您放入每个文件中的最大代码量，然后您就可以设置...！

我认为功能级别上没有任何源代码控制交易。想一想它需要了解多少才能使该功能正常工作所需的每种晦涩的编程语言？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T03:19:08.717

没有版本控制系统可以做到这一点。你最好的选择是确保你的代码被分成许多小文件。例如，如果您使用 Java，请确保每个文件只有一个类。但这确实有限制，在 C 中只为每个头文件放置一个函数是没有意义的。确保在签出注释中解释了为什么要签出代码。如果您要使用独家签出模型，请确保您不会长时间保留任何代码。如果您必须长时间检查代码，请确保团队知道您为什么要这样做，以便他们可以从事其他工作。如果您使用的结帐系统可以让多人签出同一个文件，请确保在结帐注释中提及您正在编辑的功能，这样其他人就不会更改该功能并导致合并冲突。

# c++ - 在 C++ 中定义类字符串常量？

> ID：459942
> 
> 赞同：41
> 
> 时间：2009-01-20T02:23:23.933
> 
> 标签：c++

我看过这两种风格的代码，我不确定一种是否比另一种更好（这只是风格问题）？你有什么建议为什么你会选择一个而不是另一个。

```
 //Example1
 class Test {

    private:
        static const char* const str;

};

const char* const Test::str = "mystr";

//Example2
class Test {

     private:
         static const std::string str;

};

const std::string Test::str ="mystr"; 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-20T02:41:08.483

通常你应该更喜欢`std::string`普通的 char 指针。然而，在这里，用字符串字面量初始化的 char 指针有一个显着的好处。

静态数据有两种初始化。一种叫静态初始化，一种叫动态初始化。对于那些使用常量表达式初始化并且是 POD（如指针）的对象，C++ 要求它们的初始化在一开始就发生，在动态初始化发生之前。初始化这样的 std::string 将动态完成。

如果您有一个类的对象是某个文件中的静态对象，并且在其初始化期间需要访问该字符串，则您可以依赖它在使用`const char* const`版本时已经设置好，而在使用`std::string`版本时，没有静态初始化，您不知道字符串是否已经初始化 - 因为未定义跨翻译单元边界的对象初始化顺序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T02:27:27.107

嗯，std::string 与 const char * 不同。我通常在使用 std::string 方面犯错，因为它是一个具有许多附加功能的类，使其更易于使用。

如果性能是最重要的，并且您使用 const char * 来提高效率，那就这样吧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T02:58:10.600

在做 C++ 时，我倾向于使用 std::string 而不是 char *。我更喜欢 std::string 主要是因为它的内置功能以及不必处理指针的便利性和安全性。

但是，正如其他人所提到的，如果您过度关注性能，则 const char * 版本可能是有利的。我似乎记得曾经有一个聪明人说过，过早的优化是万恶之源（或类似的根源）。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T02:28:49.910

第一个示例需要较少的管理字符串的开销（即，只是指向 TEXT 部分的指针）。此外，第二种方法可能还需要堆分配以将字符串文字复制到 std:string 类缓冲区。因此，您最终会得到两个数据副本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T03:28:07.747

在涉及具有不同编译器和库的多个平台、许多团队和许多人的大型项目中，我们反复遇到静态 std::strings 的问题。在某些平台上，std:string 实现不是线程安全的。在一个平台上，编译器优化的代码跳过了从全局静态常量初始化本地 std:string。在解决了其中一些问题之后，我们只允许内置类型使用全局静态常量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T02:28:51.020

第二个版本的优点是它带有预先计算的长度和充实的字符串类的其他好处。第一个的优点是唯一的初始化只是分配一个指向已加载到可执行映像中的静态数据的指针，而第二个必须从同一个指针初始化字符串。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T03:37:49.133

首先，如果不使用 char*. 如果你想要一个 ASCIIZ 字符串，直接定义其中一个：

`const char Test::str[] = "mystr";`

在大多数情况下，这就是我会使用的。为什么要为字符串类的开销浪费时间和内存。

请注意，“sizeof(Test::str)”会准确地为您提供数组的长度，即字符串的长度，包括终止的 NUL (strlen(str)+1)。

# flot - 如何控制 flot 中的刻度标签大小

> ID：459947
> 
> 赞同：10
> 
> 时间：2009-01-20T02:26:37.810
> 
> 标签：flot, graphing

我有一个基本条形图，我在 flot 中展示（5 个条形图，显示每个状态的百分比）。

```
$.plot($("#placeholder"), [
    {
        label: 'Failed',
        data: [[0,10]],
        bars: { show: true }
    },
    {
        label: 'Passed',
        data: [[1,15]],
        bars: { show: true }
    },
    {
        label: 'Not Run',
        data: [[2,30]],
        bars: { show: true }
    },
    {
        label: 'Blocked',
        data: [[3,5]],
        bars: { show: true }
    },
    {
        label: 'In Progress',
        data: [[4,40]],
        bars: { show: true }
    }
],
{
    xaxis: {
        ticks: [[0.5, "Failed"], [1.5, "Passed"], [2.5, "Not Run"], [3.5, "Blocked"], [4.5, "In Progress"]]
    },
    legend: {
        show: false
    }
}); 
```

我发现用于 x 轴上刻度值的字体有点太大，尤其是当图表以小尺寸显示时，即。240x100。我已阅读 API 文档，但找不到如何控制刻度标签大小。

这可能是OOTB吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-20T14:52:42.250

您似乎无法通过 API 设置字体大小，但您可以使用 css 设置刻度标签的大小。

```
.tickLabel { font-size: 80% } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-12T21:17:30.320

这是直接来自 API 的示例：

```
xaxis:{
   font:{
      size:11,
      style:"italic",
      weight:"bold",
      family:"sans-serif",
      variant:"small-caps"
   }
} 
```

[http://flot.googlecode.com/svn/trunk/API.txt](http://flot.googlecode.com/svn/trunk/API.txt)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-08T12:13:29.330

上述两个答案不适用于最新版本的 flot，因为它们不再使用“真实”文本（而是绘制文本）。而是指定以下选项：

`{xaxis: {font: size: some_number}, yaxis: {font: size: some_number}}`

（替换`some_number`为所需的大小，以磅为单位）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-13T06:15:39.720

我使用了以下内容：

**CSS 文件/SCSS 文件**

```
#graph_label .tickLabel{

     font-size: 50%;
  } 
```

**Index.html 或您要绘制图形区域的位置**

```
$.plot($("graph_label"), [dataArrayReference], options); 
```

*参考：@BrentM 上面的回答*

**PS：我使用的是 0.8.1 之前的 Flot 版本，所以我不知道最新版本的工作原理**

# c# - 制作 Autorun 应用程序的最佳解决方案？

> ID：459955
> 
> 赞同：6
> 
> 时间：2009-01-20T02:30:39.457
> 
> 标签：c#, .net, windows, windows-vista, autorun

对于我的工作，我需要为我们的客户创建一个用于 CD 的 Autorun 应用程序。问题在于我是一名 C# 程序员，而 .NET 并不能实现最佳的自动运行，因为并非所有计算机都安装了 .NET。

什么是适用于 Win98-Vista 计算机的好的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T02:37:37.523

这个问题的答案确实是一种偏好。从技术上讲，可以指示任何东西作为自动运行打开。autorun.inf 文件只是一个指令文件，Windows 知道如何读取它以确定插入 CD 时它应该做什么。这可能是一个应用程序（以您选择的任何语言编写）、一个PowerPoint演示文稿、打开一个网站的链接等。只要您遵循 autorun.inf 文件的规则：

[http://autorun.moonvalley.com/autoruninf.htm](http://autorun.moonvalley.com/autoruninf.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T02:37:19.537

有许多可配置的小型 autorun-utils（有些是免费的）。我会去其中之一。

[http://www.ezau.com/latest/articles/083.shtml](http://www.ezau.com/latest/articles/083.shtml)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T02:44:23.390

你需要两件事：

*   请按照以下步骤操作（[http://support.microsoft.com/kb/324733](http://support.microsoft.com/kb/324733)或[http://support.microsoft.com/kb/888469](http://support.microsoft.com/kb/888469)）

*   当您的应用程序准备就绪（使用引导程序）时，您必须在 CD 根路径上创建一个 autorun.inf 文件。在您最喜欢的搜索引擎上搜索“autorun.inf create”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T03:13:30.680

可以使用 Mono 的捆绑功能：

“生成的可执行文件是自包含的，不需要安装 Mono 运行时即可运行。”

Mono 是一个开源 .Net 克隆，*应该*能够运行大多数 .Net 应用程序。请参阅此处的“捆绑包”部分：http://www.mono-project.com/Guide: [Running_Mono_Applications](http://www.mono-project.com/Guide:Running_Mono_Applications)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T03:43:58.480

您可以使用 CD 上的 .hta 文件作为启动页面启动，并从那里检测是否安装了 .NET（使用 HTA 文件中的 COM），然后运行您的自定义可执行文件。

.hta 文件是 Microsoft SQL Server（以及其他大多数）安装光盘从内存中使用的文件，很容易使它们看起来非常专业（基本上只是后台的 html）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T02:36:37.650

您可以在 CD 中包含运行时，但您必须在运行应用程序之前安装它。您可能会考虑从 CD 中弹出一个 html 文件。

否则，您可以考虑编写一个小型本机程序，如果运行时不存在，它会提示安装它，或者如果存在，则运行您的 .NET 应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T03:32:47.863

试试德尔福；这是迄今为止创建本机 win32 应用程序的最佳方式。

它创建具有丰富 GUI 的光滑独立 .exe 文件，不需要任何运行时库或其他烦人的依赖项。适用于任何 Windows 机器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T04:10:22.873

Macrovision 有一个名为“Demoshield”的程序在当时运行良好。我不确定它是否可用，但它是一个用于创建自动运行程序的好程序。

# git - 我已经推送成功了，但是我在 git 中收到一条错误消息“error: failed to push...”

> ID：459957
> 
> 赞同：2
> 
> 时间：2009-01-20T02:32:49.637
> 
> 标签：git, message, push

我已经成功推送了许多提交，但是每次 git-push 都会收到一条错误消息“错误：无法推送一些参考”。我不知道这个消息。有人能告诉我发生了什么吗？我该如何解决这个问题？

谢谢！

以下是我的 git-push 的日志。

[jinuu@foonlean 来源]$ git push
foonlean@172.16.12.17 的密码：
计数对象：15，完成。
压缩对象：100% (8/8)，完成。
写入对象：100% (8/8)，908 字节，完成。
总共 8 个（增量 6），重用 0 个（增量 0）
到 foonlean@172.16.12.17:Repository/source
ab5be38..d2f8993 master -> master
错误：未能将一些 refs 推送到 'foonlean@172.16.12.17:Repository/source'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T02:35:57.807

你必须先拉。然后推。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T20:53:15.590

强制推送：

```
git push --force 
```

您不必合并差异，但您可能会丢失本地提交的一些历史记录。

# sql-server - 打印图表时 SQL Server 重新分页

> ID：459962
> 
> 赞同：1
> 
> 时间：2009-01-20T02:35:17.573
> 
> 标签：sql-server

在 SQL Server（2000 和 2005）中布置我的架构图后，我想将副本打印到纸上。当我去打印时，SQL 似乎打算重新计算分页（并且弄错了）。

我只是打印到默认打印机 - HP Officejet。我尝试在手动调整之前强制重新分页。打印前保存并重新打开图表。

我查看了其他外部解决方案——屏幕捕获、Visio、MS Access——但它们都有其他复杂性。我喜欢 SQL Server 中布局图表的功能，它非常适合我，除非我需要硬拷贝打印输出。

SQL Server 的这个非常无用的“功能”是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T02:37:38.897

打印 SQL 图表的能力一直是个问题。这是我能给你的最好答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T10:47:53.477

我必须承认我在打印 SQL 服务器架构图时使用了 PrintScreen 和 Paint。到目前为止，这是唯一对我有用的东西。最近我一直在使用[Dia](http://projects.gnome.org/dia/)创建实体关系图。正如[StackOverflow](https://stackoverflow.com/questions/37672/create-db-in-sql-server-based-on-visio-data-model)中提到的，您可以使用 Dia 根据图表创建 SQL 脚本。

# visual-studio - 带有远程服务器的 Visual Studio

> ID：459979
> 
> 赞同：0
> 
> 时间：2009-01-20T02:51:41.567
> 
> 标签：visual-studio, remote-access

我正在处理的站点位于远程服务器上。我想在本地工作。有没有比 Visual Studio 中更好的工具来处理远程网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T03:09:09.720

与其处理 VS 远程处理的怪异问题，不如使用远程桌面在目标本地计算机上驱动 VS（例如在 VPN 之后）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T03:09:52.870

如果您可以在远程站点上设置颠覆服务器，您可以使用它来同步位置之间的更改。这在其他领域也非常有用，例如允许多人弄乱您的代码并跟踪您所做的每一个更改。它也将是性能领域中最好的。

如果它是 Windows 共享，只需在当前位置设置存储库，然后使用：

svn checkout file:///project/trunk

或者，如果它通过 Web 服务器，您也可以设置 SVN 以提供服务。

有很多免费/非免费的 VS 插件可以让使用 SVN 变得非常容易。

# python - BeautifulSoup - 修改一段 HTML 中的所有链接？

> ID：459981
> 
> 赞同：24
> 
> 时间：2009-01-20T02:52:19.973
> 
> 标签：python, beautifulsoup

我需要能够修改 HTML 文档中的每个链接。我知道我需要使用它，`SoupStrainer`但我对如何实现它并不是 100% 肯定。如果有人可以指导我找到一个好的资源或提供一个代码示例，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-20T03:02:34.150

也许这样的事情会起作用？（不幸的是，我面前没有 Python 解释器）

```
from bs4 import BeautifulSoup
soup = BeautifulSoup('<p>Blah blah blah <a href="http://google.com">Google</a></p>')
for a in soup.findAll('a'):
  a['href'] = a['href'].replace("google", "mysite")

result = str(soup) 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-01-20T03:09:49.097

```
from BeautifulSoup import BeautifulSoup
soup = BeautifulSoup('<p>Blah blah blah <a href="http://google.com">Google</a></p>')
for a in soup.findAll('a'):
    a['href'] = a['href'].replace("google", "mysite")
print str(soup) 
```

这是 Lusid 的解决方案，但由于他面前没有 Python 解释器，他无法对其进行测试，并且出现了一些错误。我只是想发布工作条件。谢谢卢西德！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-03-22T00:03:17.017

我试过这个并且它有效，避免使用正则表达式来匹配每个更容易`'href'`：

```
from bs4 import BeautifulSoup as bs
soup = bs(htmltext)
for a in soup.findAll('a'):
    a['href'] = "mysite" 
```

[在bs4 docs](http://beautiful-soup-4.readthedocs.org/en/latest/#modifying-the-tree)上检查一下。

# c# - AuthSub/OAuth、ASP.NET 和 Google API

> ID：459988
> 
> 赞同：0
> 
> 时间：2009-01-20T03:01:22.543
> 
> 标签：c#, asp.net, authentication, authsub

我有一个简单的 web 应用程序的想法，它将信息从 Evernote 交叉链接到 Google 日历。我能够找到一个好的[Evernote 快速入门项目](http://macrolinz.com/macrolinz/index.php/2008/12/26/get-it-while-its-hot-evernote-web-quickstart-for-c/)，但我现在正在寻找可以开始访问日历的东西。请告知您是否知道任何带有代码示例的好资源，这些资源将向我展示如何进行肮脏的工作（我的意思是通过 OAuth/AuthSub 进行身份验证）。

从我读到的关于在 Google 中使用 OAuth 的内容来看，您似乎必须拥有一个注册域 - 我需要能够从我的笔记本电脑的开发服务器访问该服务，所以我想我必须坚持使用 AuthSub。

当我“搜索”这个主题时，我发现了许多与我相似的问题，但没有一个问题得到令人满意的回答。

预先感谢您的帮助。

更新：我开始认为要么我遗漏了什么，要么没有人在 ASP.NET 中使用 AuthSub ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-12-15T09:26:43.607

我最近创建了一个示例，如何使用 Dotnet OpenAuth 库在 ASP.NET 和 Google 中使用 Google OAuth：

[在 asp.net 中使用 Google OAuth](http://www.dominikamon.com/articles/2918/using-google-oauth-in-aspnet.html)

我希望这个样本有帮助:) Dominik

**2015 年 3 月更新**

到 4 月 20 日，Google 将不再支持此 api - 因此我需要迁移到 OIDC。在此处查看我最近的文章： [asp.net 的 OIDC 轻量级库](http://www.dominikamon.com/articles/3091/oidc-lightweight-library-for-aspnet.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T18:28:38.907

要使用 OAuth，您必须在以下页面向 Google 注册您的域：https: [//www.google.com/accounts/ManageDomains](https://www.google.com/accounts/ManageDomains)。此注册将为您提供签署 OAuth 请求所需的凭据。但是，您仍然可以在用户授权 url 中指定不同的 oauth_callback url。所以注册的域与oauth_callback无关。

# bug-tracking - 是否有任何 GTD 应用程序与任何常见的错误跟踪应用程序同步？

> ID：459999
> 
> 赞同：6
> 
> 时间：2009-01-20T03:08:57.367
> 
> 标签：bug-tracking, gtd

我正在尝试决定使用 GTD 应用程序。有谁知道自动与[Trac](http://trac.edgewall.org/)或更好的是[FogBugz](http://www.fogcreek.com/FogBUGZ)同步的一个？

我的怀疑是没有人这样做。这让我不得不编写一个为我完成它的脚本。

*   [Things](http://culturedcode.com/things/)将其数据存储在 XML 中，但标签的内容都是二进制的，这使得编写脚本几乎是不可能的。

*   [OmniFocus](http://www.omnigroup.com/applications/omnifocus/)将其数据存储在 XML 中，内容是文字文本。插件或脚本是可能的。

*   [命中列表](http://www.potionfactory.com/blog/archives/hit-list)将其数据存储在 sqlite3 数据库中。可能比 XML 更容易，但我还不确定。缺点是 THL 不支持重复任务，这使得它作为 GTD 应用程序不太有用。

有没有人试过这个？我错过了一个明显的应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T03:22:22.253

ThinkingRock - Java 应用程序，纯文本 XML 数据格式，支持重复任务。据我所知，还没有构建自动集成，但脚本的另一个可能选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-06T00:24:12.733

Tomboy 具有一定程度的 Bugzilla 集成，但并不复杂。或者，同步一些基于纯文本的东西，比如 Vimoutliner（IMO：可能是有史以来最好的 GTD 应用程序）或 Taskpaper，这将是相当简单的。

可能就易用性而言：纯文本 > XML > 数据库 > 二进制格式 X

您可以只使用 wget 和/或简单的 perl 脚本来下载任务，然后运行一些正则表达式以使其格式正确，例如

```
<li> ... </li> -> [ ] ... 
```

或在代码中：

```
s!<li>(.*)</li>![ ] $1!g 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T03:26:46.207

为什么不使用您正在查看的错误跟踪系统的任务功能作为您的 GTD 工具？你也看过（任务教练）[ [http://en.wikipedia.org/wiki/Task_Coach]](http://en.wikipedia.org/wiki/Task_Coach])它以 XML 格式存储所有信息。``********