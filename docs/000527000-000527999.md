# StackOverflow 问答 000527000-000527999

# apache-flex - 获取 VideoDisplay 控件的实时流的状态

> ID：527001
> 
> 赞同：0
> 
> 时间：2009-02-09T02:41:11.543
> 
> 标签：apache-flex, flash, actionscript-3, actionscript, adobe

我正在寻找一种通过 VideoDisplay（或任何其他方法）来查找实时流状态的方法。我很想知道流当前是否正在发布或发布者是否已停止。这适用于 Flex/Flash ActionScript 3 项目。

有没有办法做到这一点，或者这是 adobe 的另一个疏忽？

flex flash adobe adobe-flex actionscript

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T06:24:28.620

我只找到了一种解决方案，那就是将 NetStream 对象与视频控件结合使用。

视频控件必须手动添加到

```
nsListen = new NetStream(nc);
nsListen.addEventListener(NetStatusEvent.NET_STATUS, nsListenHandler);
nsListen.play(streamname);

var v:Video = new Video();
v.attachStream(nsListen);
uicontrol.add(v); 
```

最后在 nsListenHandler 中返回事件状态：

```
private function nsListenHandler(e:Event):void
{
    if(e is NetStatusEvent)
    {
        var nse:NetStatusEvent = NetStatusEvent(e);
        if(nse.info.code == "NetStream.Play.Failed")
        {
            // Big error.

        }
        if(nse.info.code == "NetStream.Play.PublishNotify")
        {
            // Stream has just been published

        }
        if(nse.info.code == "NetStream.Play.UnpublishNotify")
        {
            // Stream has just been unpublished

        }
        trace(NetStatusEvent(e).info.code);
        trace(NetStatusEvent(e).info.description);
    }
} 
```

只有此代码不会告诉您流是否已成功发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T16:00:32.807

您可以深入研究 NetStatusEvent 事件。

检查此[实时文档](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/NetStatusEvent.html)

# c# - 从任何域中提取域名的正则表达式

> ID：527008
> 
> 赞同：2
> 
> 时间：2009-02-09T02:44:21.147
> 
> 标签：c#, regex

我正在尝试从 C# 中的字符串中提取域名。您不一定必须使用 RegEx，但我们应该能够`yourdomain.com`从以下所有内容中提取：

```
yourdomain.com
www.yourdomain.com
http://www.yourdomain.com
http://www.yourdomain.com/
store.yourdomain.com
http://store.yourdomain.com
whatever.youdomain.com
*.yourdomain.com 
```

此外，任何 TLD 都是可接受的，因此将以上所有内容替换为`.net`、`.org`、`'co'uk`等。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-09T03:41:38.717

1.  如果不存在方案（字符串中没有冒号），请在前面加上“http://”以使其成为有效的 URL。

2.  将字符串传递给[Uri 构造函数](http://msdn.microsoft.com/en-us/library/z6c2z492.aspx)。

3.  访问 Uri 的[Host 属性](http://msdn.microsoft.com/en-us/library/system.uri.host.aspx)。

现在你有了主机名。您究竟认为给定主机名的“域名”是一个值得商榷的点。我猜你不仅仅指第一个点之后的所有内容。

仅从字符串中就无法区分诸如“whatever.youdomain.com”之类的主机名与诸如“warwick.ac.uk”之类的域中的域。事实上，考虑到一些注册商努力开拓自己的利基市场，关于什么是公共 SLD，什么不是公共 SLD，甚至存在一些灰色地带。

一种常见的方法是维护大量 SLD 和不相关实体使用的其他后缀的列表。这是网络浏览器阻止不需要的公共 cookie 共享的方法。找到公共后缀后，您可以在主机名中添加一个最近的前缀，用点分隔以获得负责给定主机名的最高级别实体，如果这是您想要的。后缀列表很难维护，但您可以借助[其他人的努力](http://publicsuffix.org/)。

或者，如果您的应用程序有时间和网络连接来执行此操作，它可以开始嗅探主机名信息。例如。它可以对主机名进行 whois 查询，并继续查看每个父级，直到得到结果，这将是负责给定主机名的最低级别实体的域名。

或者，如果这些工作量太大，您可以尝试将任何前导的“www”去掉。展示！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T02:49:47.530

我建议您自己尝试一下。使用调节器和正则表达式备忘单。

[http://sourceforge.net/projects/regulator/](http://sourceforge.net/projects/regulator/)

[http://regexlib.com/CheatSheet.aspx](http://regexlib.com/CheatSheet.aspx)

[还可以在编码恐怖](http://www.codinghorror.com/blog/archives/001016.html)中找到一些关于正则表达式的好信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T02:51:20.130

正则表达式并不真正符合您对“*任何*T​​LD”的要求，因为 TLD 的格式和数量非常大并且不断变化。如果您将范围限制为：

```
(?<domain>[^\.]+\.([A-Z]+$|co\.[A-Z]$)) 
```

你会抓住 .anything 和 .co.anything，我想它们涵盖了最现实的情况......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T02:59:06.993

看看这个[其他答案](https://stackoverflow.com/questions/399250/going-where-php-parseurl-doesnt-parsing-only-the-domain/399316#399316)。它适用于 PHP，但您可以轻松地从 PHP 的 4-5 行中获取正则表达式，并且您可以从随后的讨论中受益（参见[Alnitak 的回答](https://stackoverflow.com/questions/399250/going-where-php-parseurl-doesnt-parsing-only-the-domain/401456#401456)）。

# pipe - 使用同步 NamedPipes 同步读写

> ID：527012
> 
> 赞同：1
> 
> 时间：2009-02-09T02:46:28.753
> 
> 标签：pipe, named-pipes

命名管道服务器是用

```
hPipe = CreateNamedPipe( zPipePath,
                         PIPE_ACCESS_DUPLEX,
                         PIPE_TYPE_BYTE | PIPE_WAIT | PIPE_READMODE_BYTE,
                         PIPE_UNLIMITED_INSTANCES,
                         8192, 8192, NMPWAIT_USE_DEFAULT_WAIT, NULL) 
```

然后我们立即调用：

```
ConnectNamedPipe( hPipe, BYVAL %NULL ) 
```

在客户端连接之前阻塞。

然后我们直接进入 ReadFile( hPipe, ...

问题是客户端需要有限的时间来准备和写入所有 fcgi 请求参数。这通常在 Pipe Server 执行其 ReadFile() 之前尚未完成。因此，读取文件操作在管道中找不到任何数据，并且该过程失败。

在客户端连接到 NamedPipe 后，是否有一种机制来判断 Write() 何时发生/完成？

如果我可以控制客户端进程，我可以使用一个普通的互斥锁，但我没有，我真的不想为了解决这个问题而进入 I/O 完成端口！

我当然可以使用一个简单的计时器来等待 60m/s 左右，这通常是足够的时间来完成写入，但这是一个可怕的 hack。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T04:04:26.680

我不确定您使用的是什么语言 - 我不认识这样的表达

```
PIPE_TYPE_BYTE OR %PIPE_WAIT OR %PIPE_READMODE_BYTE 
```

但在我看来，服务器的 ReadFile() 应该阻塞，直到客户端写入数据。

看起来不正确（但不应该伤害任何东西）的一件事是使用`NMPWAIT_USE_DEFAULT_WAIT`- 该值是供客户在调用时使用的`WaitNamedPipe()`。

你能看看这 2 个 C++ 程序是否像你期望的那样交互（即，服务器阻塞直到客户端写东西）？我从 Jones/Ohlund 的“Windows 网络编程”一书中获取了这些程序。服务器`ReadFile()`按预期阻止了我的调用：

## - 服务器.cpp

```
// Server.cpp

#include <windows.h>
#include <stdio.h>

void main(void)
{
    HANDLE PipeHandle;
    DWORD BytesRead;
    CHAR buffer[256];
    if ((PipeHandle = CreateNamedPipe("\\\\.\\Pipe\\Jim",
        PIPE_ACCESS_DUPLEX, PIPE_TYPE_BYTE | PIPE_READMODE_BYTE, 1,
        0, 0, 1000, NULL)) == INVALID_HANDLE_VALUE)
    {
        printf("CreateNamedPipe failed with error %d\n",
            GetLastError());
        return;
    }

    printf("Server is now running\n");

    if (ConnectNamedPipe(PipeHandle, NULL) == 0)
    {
        printf("ConnectNamedPipe failed with error %d\n",
            GetLastError());
        CloseHandle(PipeHandle);
        return;
    }

    if (ReadFile(PipeHandle, buffer, sizeof(buffer),
        &BytesRead,  NULL) <= 0)
    {
        printf("ReadFile failed with error %d\n", GetLastError());
        CloseHandle(PipeHandle);
        return;
    }

    printf("%.*s\n", BytesRead, buffer);

    if (DisconnectNamedPipe(PipeHandle) == 0)
    {
        printf("DisconnectNamedPipe failed with error %d\n",
            GetLastError());
        return;
    }

    CloseHandle(PipeHandle);
} 
```

## - 客户端.cpp

```
// Client.cpp

#include <windows.h>
#include <stdio.h>

#define PIPE_NAME "\\\\.\\Pipe\\jim"

void main(void)
{
    HANDLE PipeHandle;
    DWORD BytesWritten;

    if (WaitNamedPipe(PIPE_NAME, NMPWAIT_WAIT_FOREVER) == 0)
    {
        printf("WaitNamedPipe failed with error %d\n",
            GetLastError());
        return;
    }

    // Create the named pipe file handle
    if ((PipeHandle = CreateFile(PIPE_NAME,
        GENERIC_READ | GENERIC_WRITE, 0,
        (LPSECURITY_ATTRIBUTES) NULL, OPEN_EXISTING,
        FILE_ATTRIBUTE_NORMAL,
        (HANDLE) NULL)) == INVALID_HANDLE_VALUE)
    {
        printf("CreateFile failed with error %d\n", GetLastError());
        return;
    }

    if (WriteFile(PipeHandle, "This is a test", 14, &BytesWritten, 
        NULL) == 0)
    {
        printf("WriteFile failed with error %d\n", GetLastError());
        CloseHandle(PipeHandle);
        return;
    }

    printf("Wrote %d bytes", BytesWritten);

    CloseHandle(PipeHandle);
} 
```

# python - postgresql 中的动态数据

> ID：527013
> 
> 赞同：1
> 
> 时间：2009-02-09T02:46:33.043
> 
> 标签：python, postgresql, performance, dynamic-data, vacuum

我打算让一个 python 脚本每秒在 2,433,000 行上执行许多更新。我目前正在尝试将 python 中的动态列作为 python dict 中的值。然而，让我的 python dict 与其他列中的更改保持同步变得越来越困难或不可行。

我知道我可以将 autovacuum 置于超速状态，但我想知道这是否足以赶上大量的更新。如果我能将一个 python 变量关联到每一行就好了……

我担心 VACUUM 和磁盘写入开销会杀死我的服务器？

关于如何将极其动态的变量与行/键关联的任何建议？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T06:04:10.837

PostgreSQL 支持使用[LISTEN](http://www.postgresql.org/docs/8.3/static/sql-listen.html)和[NOTIFY](http://www.postgresql.org/docs/8.1/static/sql-notify.html)命令的异步通知。应用程序（客户端）使用通知名称（例如“table_updated”）监听通知。数据库本身可以手动发出通知，即在执行插入或修改的代码中（在进行大量更新时很有用，允许批量通知）或在行更新[TRIGGER](http://www.postgresql.org/docs/8.3/static/sql-createtrigger.html)中自动发出通知。

您可以使用此类通知来使您的数据结构保持最新。

或者（或者您可以将其与上述结合使用），您可以通过覆盖`__getitem__()`、`has_key()`、`contains()`方法来自定义 Python 字典，并让它们根据需要执行查找，允许您使用超时等缓存结果。

# java - web.xml 无法在某些环境中工作

> ID：527017
> 
> 赞同：0
> 
> 时间：2009-02-09T02:51:06.653
> 
> 标签：java, web-applications, ssl, https

我在 web.xml 中添加了这个传输保证标签，这意味着某些页面只能通过 https 访问。但是，这对于具有 Web 服务器和负载平衡器的环境存在问题。

显然它不会重定向到带有 ssl 端口的应用程序。

看起来像防火墙限制。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T02:57:04.487

你用的是哪个容器？我相信某些容器确实允许您在配置中指定“前端”（即 Web 服务器、负载平衡器等）SSL 端口。

我已经为 WebLogic 完成了这项工作，但我不确定 Java EE 规范中是否明确规定了此要求，或者是否所有容器都支持它。

# c# - Open XML SDK 2.0 - 如何更新电子表格中的单元格？

> ID：527028
> 
> 赞同：44
> 
> 时间：2009-02-09T02:55:15.550
> 
> 标签：c#, xml, excel, sdk

我想使用 Open XML SDK 2.0 (CTP) 更新图表使用的电子表格中的单元格。我发现的所有代码示例都插入了新的单元格。我正在努力检索正确的工作表。

```
public static void InsertText(string docName, string text, uint rowIndex, 
  string columnName)
{
  // Open the document for editing.
  using (SpreadsheetDocument spreadSheet = 
    SpreadsheetDocument.Open(docName, true))
  {
    Workbook workBook = spreadSheet.WorkbookPart.Workbook;

    WorksheetPart worksheetPart = workBook.WorkbookPart.
      WorksheetParts.First();

    SheetData sheetData = worksheetPart.Worksheet.
      GetFirstChild<SheetData>();

    // If the worksheet does not contain a row with the specified
    // row index, insert one.
    Row row;

    if (sheetData.Elements<Row>().Where(
      r => r.RowIndex == rowIndex).Count() != 0)
      // At this point I am expecting a match for a row that exists
      // in sheet1 but I am not getting one 
```

当我在 Visual Studio 中导航树时，我看到了三张工作表，但没有一张有任何孩子。我错过了什么？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-09T16:00:18.550

这是工作代码。这是一个原型。对于大量更改，可能只打开一次文档。此外，还有一些硬编码的东西，如工作表名称和单元格类型，必须先进行参数化，然后才能称为生产就绪。 [http://openxmldeveloper.org/forums/4005/ShowThread.aspx](http://openxmldeveloper.org/forums/4005/ShowThread.aspx)非常有帮助。

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Text;
using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Spreadsheet;
using System.Xml;
using System.IO;
using System.Diagnostics;

namespace OpenXMLWindowsApp
{
    public class OpenXMLWindowsApp
    {
        public void UpdateSheet()
        {
            UpdateCell("Chart.xlsx", "20", 2, "B");
            UpdateCell("Chart.xlsx", "80", 3, "B");
            UpdateCell("Chart.xlsx", "80", 2, "C");
            UpdateCell("Chart.xlsx", "20", 3, "C");

            ProcessStartInfo startInfo = new ProcessStartInfo("Chart.xlsx");
            startInfo.WindowStyle = ProcessWindowStyle.Normal;
            Process.Start(startInfo);
        }

        public static void UpdateCell(string docName, string text,
            uint rowIndex, string columnName)
        {
            // Open the document for editing.
            using (SpreadsheetDocument spreadSheet = 
                     SpreadsheetDocument.Open(docName, true))
            {
                WorksheetPart worksheetPart = 
                      GetWorksheetPartByName(spreadSheet, "Sheet1");

                if (worksheetPart != null)
                {
                    Cell cell = GetCell(worksheetPart.Worksheet, 
                                             columnName, rowIndex);

                    cell.CellValue = new CellValue(text);
                    cell.DataType = 
                        new EnumValue<CellValues>(CellValues.Number);

                    // Save the worksheet.
                    worksheetPart.Worksheet.Save();
                }
            }

        }

        private static WorksheetPart 
             GetWorksheetPartByName(SpreadsheetDocument document, 
             string sheetName)
        {
            IEnumerable<Sheet> sheets =
               document.WorkbookPart.Workbook.GetFirstChild<Sheets>().
               Elements<Sheet>().Where(s => s.Name == sheetName);

            if (sheets.Count() == 0)
            {
                // The specified worksheet does not exist.

                return null;
            }

            string relationshipId = sheets.First().Id.Value;
            WorksheetPart worksheetPart = (WorksheetPart)
                 document.WorkbookPart.GetPartById(relationshipId);
            return worksheetPart;

        }

        // Given a worksheet, a column name, and a row index, 
        // gets the cell at the specified column and 
        private static Cell GetCell(Worksheet worksheet, 
                  string columnName, uint rowIndex)
        {
            Row row = GetRow(worksheet, rowIndex);

            if (row == null)
                return null;

            return row.Elements<Cell>().Where(c => string.Compare
                   (c.CellReference.Value, columnName + 
                   rowIndex, true) == 0).First();
        }

        // Given a worksheet and a row index, return the row.
        private static Row GetRow(Worksheet worksheet, uint rowIndex)
        {
            return worksheet.GetFirstChild<SheetData>().
              Elements<Row>().Where(r => r.RowIndex == rowIndex).First();
        } 
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-07-02T20:50:40.650

我一直在使用 excel，发现这个帮助程序库很有帮助（我已经创建了自己的 word 帮助程序，如果我知道这一点，至少可以节省 2 周时间）： [https://www.nuget .org/packages/SimpleOOXML/](https://www.nuget.org/packages/SimpleOOXML/)

这是更新单元格 (writer.PasteText(...)) 所需要的：

```
MemoryStream stream = SpreadsheetReader.Create();
SpreadsheetDocument doc = SpreadsheetDocument.Open(stream, true);
WorksheetPart worksheetPart = SpreadsheetReader.GetWorksheetPartByName(doc, "Sheet1");
WorksheetWriter writer = new WorksheetWriter(doc, worksheetPart);

writer.PasteText("B2", "Hello World");

//Save to the memory stream
SpreadsheetWriter.Save(doc);

byte[] result = stream.ToArray();
FileStream file = new FileStream(@"D:\x1.xlsx", FileMode.Create);
file.Write(result, 0, result.Length);
file.Close(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-11T12:57:48.983

@CDonner 发布的代码引发了一些异常，我添加了一些将处理代码的代码，这些代码会引发异常，这里是

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Text;
using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Spreadsheet;
using System.Xml;
using System.IO;
using System.Diagnostics;

namespace Application.Model{
public class TempCode
{
    public TempCode()
    {
        UpdateCell("E:/Visual Studio Code/Book1.xlsx", "120", 1, "A");
        UpdateCell("E:/Visual Studio Code/Book1.xlsx", "220", 2, "B");
        UpdateCell("E:/Visual Studio Code/Book1.xlsx", "320", 3, "C");
        UpdateCell("E:/Visual Studio Code/Book1.xlsx", "420", 4, "D");
        UpdateCell("E:/Visual Studio Code/Book1.xlsx", "520", 5, "E");

        ProcessStartInfo startInfo = new ProcessStartInfo("E:/Visual Studio Code/Book1.xlsx");
        startInfo.WindowStyle = ProcessWindowStyle.Normal;
        Process.Start(startInfo);

    }

    public static void UpdateCell(string docName, string text,uint rowIndex, string columnName){
        // Open the document for editing.
        using (SpreadsheetDocument spreadSheet = SpreadsheetDocument.Open(docName, true))
        {
            WorksheetPart worksheetPart = GetWorksheetPartByName(spreadSheet, "Sheet2");
            if (worksheetPart != null)
            {
                Cell cell = GetCell(worksheetPart.Worksheet, columnName, rowIndex);
                cell.CellValue = new CellValue(text);
                cell.DataType = new EnumValue<CellValues>(CellValues.Number);
                // Save the worksheet.
                worksheetPart.Worksheet.Save();
            }
        }

    }

    private static WorksheetPart GetWorksheetPartByName(SpreadsheetDocument document, string sheetName){
        IEnumerable<Sheet> sheets =document.WorkbookPart.Workbook.GetFirstChild<Sheets>().
                        Elements<Sheet>().Where(s => s.Name == sheetName);
        if (sheets.Count() == 0){
            return null;
        }
        string relationshipId = sheets.First().Id.Value;
        WorksheetPart worksheetPart = (WorksheetPart)document.WorkbookPart.GetPartById(relationshipId);
        return worksheetPart;
    }

    private static Cell GetCell(Worksheet worksheet, string columnName, uint rowIndex)
    {
        Row row;
        string cellReference = columnName + rowIndex;
        if (worksheet.Elements<Row>().Where(r => r.RowIndex == rowIndex).Count() != 0)
            row = worksheet.GetFirstChild<SheetData>().Elements<Row>().Where(r => r.RowIndex == rowIndex).FirstOrDefault();
        else{
            row = new Row() { RowIndex = rowIndex };
            worksheet.Append(row);
        }

        if (row == null)
            return null;

        if (row.Elements<Cell>().Where(c => c.CellReference.Value == cellReference).Count() > 0) {
            return row.Elements<Cell>().Where(c => c.CellReference.Value == cellReference).First();
        }
        else{
            Cell refCell = null;
            foreach (Cell cell in row.Elements<Cell>()){
                if (string.Compare(cell.CellReference.Value, cellReference, true) > 0){
                    refCell = cell;
                    break;
                }
            }
            Cell newCell = new Cell() {
                CellReference = cellReference, 
                StyleIndex = (UInt32Value)1U

            };
            row.InsertBefore(newCell, refCell);
            worksheet.Save();
            return newCell;
        }
    }
} 
```

}

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-14T15:00:22.223

这是 SDK 2.5，但是，在这里找到非常有用的代码：http: [//fczaja.blogspot.dk/2013/05/how-to-read-and-write-excel-cells-with.html](http://fczaja.blogspot.dk/2013/05/how-to-read-and-write-excel-cells-with.html)

需要对文本值进行轻微修改才能将它们添加到`SharedStringTablePart`.

```
// Given text and a SharedStringTablePart, creates a SharedStringItem with the specified text 
// and inserts it into the SharedStringTablePart. If the item already exists, returns its index.
private static int InsertSharedStringItem(string text, SharedStringTablePart shareStringPart)
{
    // If the part does not contain a SharedStringTable, create one.
    if (shareStringPart.SharedStringTable == null)
    {
        shareStringPart.SharedStringTable = new SharedStringTable();
    }

    int i = 0;

    // Iterate through all the items in the SharedStringTable. If the text already exists, return its index.
    foreach (SharedStringItem item in shareStringPart.SharedStringTable.Elements<SharedStringItem>())
    {
        if (item.InnerText == text)
        {
            return i;
        }

        i++;
    }

    // The text does not exist in the part. Create the SharedStringItem and return its index.
    shareStringPart.SharedStringTable.AppendChild(new SharedStringItem(new Text(text)));
    shareStringPart.SharedStringTable.Save();

    return i;
} 
```

并像这样使用它：

```
SharedStringTablePart shareStringPart = GetSharedStringTablePart(excelDoc);

// Insert the text into the SharedStringTablePart.
int index = InsertSharedStringItem(cellValue, shareStringPart);

// Set the value of cell A1.
cell.CellValue = new CellValue(index.ToString());
cell.DataType = new EnumValue<CellValues>(CellValues.SharedString); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-03T16:13:34.907

我对@AZ 代码做了一些更改。

首先，GetCell 函数在选择当前行时出现问题。只是改变：

```
if (worksheet.GetFirstChild<SheetData>().Elements<Row>().Where(r => r.RowIndex == rowIndex).Count() != 0) 
```

代替：

```
if (worksheet.Elements<Row>().Where(r => r.RowIndex == rowIndex).Count() != 0) 
```

在该部分：

```
if (string.Compare(cell.CellReference.Value, cellReference, true) > 0) 
```

如果您使用 Z 列之上的列（例如 AA 列）将无法正常工作。对此，我使用列号来确定插入单元格的位置。

为此，我创建了一个函数 ColumnIndex，将列字母转换为数字：

```
private static int ColumnIndex(string reference)
    {
        int ci = 0;
        reference = reference.ToUpper();
        for (int ix = 0; ix < reference.Length && reference[ix] >= 'A'; ix++)
            ci = (ci * 26) + ((int)reference[ix] - 64);
        return ci;
    } 
```

所以我为此更改了字符串比较函数：

```
string columnNew = new String(cellReference.Where(c => c != '-' && (c < '0' || c > '9')).ToArray());
            foreach (Cell cell in row.Elements<Cell>())
            {
                string columnBase = new String(cell.CellReference.Value.Where(c => c != '-' && (c < '0' || c > '9')).ToArray());

                if (ColumnIndex(columnBase) > ColumnIndex(columnNew))
                {
                    refCell = cell;
                    break;
                }
            } 
```

最好的祝福。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-09-18T13:24:41.860

```
var sheetData = new SheetData();
var row = UpdateCell("A","Hello World", 5);
sheetData.Append(row);
worksheet.Append(sheetData);

private static Row UpdateCell(string columnName, string value, int rowIndex)
{
       Row row = new Row { RowIndex = (uint)rowIndex };
       Cell  c1 = new TextCell(columnName, value, rowIndex);
       row.Append(c1);
       return row;            
}

public class TextCell : Cell
{
    public TextCell(string header, string text, int index)
    {
        this.DataType = CellValues.InlineString;
        this.CellReference = header + index;
        //Add text to the text cell.
        this.InlineString = new InlineString { Text = new Text { Text = text } };
    }
} 
```

# django - 您将如何根据另一个字段填充一个字段

> ID：527032
> 
> 赞同：4
> 
> 时间：2009-02-09T02:58:41.940
> 
> 标签：django, django-models, django-admin

在管理面板中，我想根据某个文本字段填充一个 slug 字段

例如。

标题：我的真棒页面

会自动填充

蛞蝓：my_awesome_page

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T03:13:59.093

SlugField 曾经有一个 prepoulate_from 选项，最高可达 0.96。之后它成为了一个管理员选项。[请参阅此处](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#prepopulated-fields)以供参考。

或者，您可以覆盖模型的 save 方法来计算 save() 上 slug 字段的值。

[这个问题](https://stackoverflow.com/questions/170337/django-signals-vs-overriding-save-method)也可能有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-09T22:52:37.173

还有一个名为 django-autoslug 的应用程序，它提供了一个字段类型 AutoSlugField。使用它，您可以：

```
class Something(models.Model):
    title = models.CharField(max_lenght=200)
    slug = AutoSlugField(populate_from='title')
    ... 
```

这个 AutoSlugField 有许多不错的功能，例如生成一个 slug，以便它在全局范围内是唯一的，或者与其他一些字段（可能是 DateTimeField 的类别或年份部分）结合使用。

有关详细信息，请参阅[http://pypi.python.org/pypi/django-autoslug](http://pypi.python.org/pypi/django-autoslug)。

# cruisecontrol.net - Cruisecontrol.net 的结果与非 cc.net 不同

> ID：527035
> 
> 赞同：0
> 
> 时间：2009-02-09T03:01:40.310
> 
> 标签：cruisecontrol.net, nant, nantcontrib

我有一个构建 VS2008 解决方案的 nant 脚本。当我通过在命令行中键入“nant”自己运行它时，所有正确的 DLL 都会复制到相应的 bin 目录中。但是当 Cruisecontrol 执行 CI 构建时，不会将 DLL 复制到 bin 目录中。

任何想法是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T13:32:04.130

亲爱的 Flibble 先生，您的问题是您在 cc.net 配置中指定了“test”作为目标，该目标覆盖了从命令行执行 nant 时执行的默认目标（构建）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T03:03:32.083

很可能您的环境中有一些东西不在 Cruise Control 环境中。在 CruiseControl 构建中添加一些内容（例如在 nant 上设置详细信息）并确认您设置了相同的路径。

# svn - git-svn 不是 git 命令？

> ID：527037
> 
> 赞同：118
> 
> 时间：2009-02-09T03:04:33.250
> 
> 标签：svn, git, git-svn

在尝试在 git 控制下获取项目的旧 svn 转储时，我遇到了一个有趣的问题。每当我运行`git svn`时，我都会收到一条错误消息，说它不是 git 命令，但有文档可以使用`git help`. 我的安装有问题，还是我在这里遗漏了什么？

编辑：我可能还应该提到我在 Windows XP 下运行 msysGit 版本 1.6.1.9.g97c34，我得到的错误是：

```
$ git svn
git：'svn' 不是
git 命令。请参阅“git --help”。

你的意思是其中之一吗？
        fsck
        显示
```

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2009-02-09T03:11:01.690

我只是检查了我新安装的 ubuntu 盒子，即使安装了 git-core 也没有安装。一个简单的：

```
sudo apt-get install git-svn 
```

或者您的发行版等效项应该修复它。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-02-03T19:39:03.090

在 Ubuntu 上：

```
sudo add-apt-repository ppa:git-core/ppa
apt-get update
sudo apt-get install git-svn 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-09T08:00:33.617

我不确定[git svn 是否曾](http://osdir.com/ml/version-control.msysgit/2008-01/msg00225.html)与最近的 Git Windows 发行版（1.5.6 后）一起使用。

[之前已经报告了](http://article.gmane.org/gmane.comp.version-control.msysgit/2433)许多问题，因此`git svn`可能不会包含在当前的 msysGit 版本中。

另一个当前活跃的“Windows 上的 Git”开发[mingw.git](http://repo.or.cz/w/git/mingw.git)确实在其[README](http://repo.or.cz/w/git/mingw.git?a=blob_plain;f=README.MinGW;hb=master)中声明 svn 不起作用。

[Msysgit 的](http://code.google.com/p/msysgit/issues/detail?id=174#c8)这个线程确实表明 git svn 可能会在某些时候重新集成，但进展仍然缓慢。

* * *

更新：从 MSysGit1.6.2（2009 年 3 月上旬）开始，**`git-svn`再次工作**。请参阅这个[SO 问题](https://stackoverflow.com/questions/623518/msysgit-on-windows-what-should-i-be-aware-of-if-any/647601#647601)。

* * *

更新：已经包含[了适用于 Windows 2.x 的现代 (2017) Git](https://github.com/git-for-windows/git/releases)。 不需要，这只能在[WSL（Linux 的 Windows 子系统）shell 会话中实现](https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux)。`git svn`
`sudo apt-get install git-svn`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-09T03:10:50.787

在我的系统下，我遇到了这个麻烦：

```
$ git svn
Can't locate SVN/Core.pm in @INC (@INC contains: /usr/lib/perl5/site_perl/5.10.0
/usr/lib/perl5/5.10.0/i486-linux-thread-multi
/usr/lib/perl5/5.10.0
/usr/lib/perl5/site_perl/5.10.0/i486-linux-thread-multi
/usr/lib/perl5/site_perl/5.8.8
/usr/lib/perl5/site_perl
/usr/lib/perl5/vendor_perl/5.10.0/i486-linux-thread-multi
/usr/lib/perl5/vendor_perl/5.10.0
/usr/lib/perl5/vendor_perl/5.8.8
/usr/lib/perl5/vendor_perl .) at
/usr/libexec/git-core/git-svn line 29. 
```

因为我没有安装 Subversion Perl 绑定。尝试安装它们并再次运行该命令。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-12-22T09:34:40.647

为了后代：在 CentOS 7 上，只需运行`sudo yum install git-svn`.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-11-08T18:39:46.970

它没有安装在我在 WSL 上全新安装的 Ubuntu 上 -

```
sudo apt install git-svn 
```

排序：

```
❯ git svn
git-svn - bidirectional operations between a single Subversion tree and git
... 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-21T22:17:17.257

我在 Cygwin 1.7 下遇到了同样的错误。通过安装带有 Cygwin 设置的 git-svn 包解决了这个问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-12-11T09:17:33.527

在 Gentoo 上，你应该使用 USE="subversion" 构建 git

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-24T01:04:10.910

MacPorts 版本：

```
port install git +svn 
```

（注意：您可能需要`port deactivate git`先）

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-10-26T20:55:59.460

在我使用的 CentOS 上

```
sudo yum install git-svn 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-03-02T03:29:33.217

在 RHEL6 上有类似的问题，即

> 无法在 @INC 中找到 Git/SVN.pm（@INC 包含：/usr/local/share/perl5 /usr/local/lib64/perl5 /usr/lib64/perl5/vendor_perl /usr/share/perl5/vendor_perl / usr/lib64/perl5 /usr/share/perl5 .) 在 /usr/local/libexec/git-core/git-svn 第 25 行。

我的解决方案：

```
sudo yum install subversion-perl
chmod 755  /usr/local/share/perl5/ (and sub dirs, as they were only readable by root) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-01T14:57:54.527

如果 git-svn 不是 mSysGit 的一部分，我建议使用小型 UNIX 服务器来托管克隆 svn 存储库的网关存储库，然后将该存储库克隆到 Windows 机器上。这是我用于从 git 与 CVS 交互的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-07-03T05:34:45.587

在 Fedora 上，我必须安装它

```
sudo dnf install -y git-svn 
```

# .net - ASP.NET Web 应用程序架构设计建议

> ID：527052
> 
> 赞同：2
> 
> 时间：2009-02-09T03:14:29.983
> 
> 标签：.net, asp.net, architecture, service, n-tier-architecture

以前我的 ASP.NET Web 应用程序使用 ADO.NET 直接连接到数据库。现在我想把它改成3层，ASP.NET层，中间Web服务层和后端数据库层。我认为我可以将数据源抽象到 ASP.NET 前端层，松散耦合并减少潜在的安全风险，让外部暴露的 ASP.Net Web 应用程序能够直接访问数据库等的好处。

与 2 层架构和 3 层架构相比，我遇到了 2 个主要问题。

1.  额外的中间 Web 服务层会产生更多的流量，例如 ASP.NET 不直接与数据库对话，而是与 Web 服务对话，而 Web 服务与数据库对话，会产生更多的流量。会不会是瓶颈？如果它是一个瓶颈，任何一般的建议来解决这个问题？

2.  由于 ASP.NET 不能连接到数据库而是连接到 Web 服务，所以它不能轻易获得 DataSet/DataTable 对象。很难将表格数据呈现给数据绑定控件。有什么想法可以让 ASP.NET 中的表示层更容易编码吗？

问候，
乔治

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T03:18:57.523

如果你只*认为*有好处，你就不应该这样做。您正在谈论以牺牲性能、代码简单性和架构简单性为代价增加大量复杂性和为自己工作，因为……什么？你得到了什么值得这些成本？

你：

*   有紧急的安全相关需求，需要断开 Web 前端与数据库服务器的连接（不，不是假设的“我打赌这会更安全”，而是可证明的、**具体的安全问题，这些问题无法通过聪明地了解您的数据库权限来解决授予**您的 ASP.NET 应用程序）

*   期望在未来某个时候（可能会重复）完全交换您的数据层，因此**需要将您的 Web 代码库与激进的 DB 更改隔离开来**？

在几乎所有情况下，这些问题的答案是否定的。这样做只会给你自己和任何可能接触到这个应用程序的人增加痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T03:38:56.443

关于您的问题 #2 - 您肯定可以从 Web 服务返回一个 DataSet。[http://tinyurl.com/ah58xc](http://tinyurl.com/ah58xc)

但是，也许更好的选择是简单地**重构**您的应用程序，而不是将其变成多层。例如，将“数据访问”分离到您从 ASP.NET 项目中引用的单独的类库项目中。这可以使事情更有条理，并可能完成一些你想要用多层架构做的事情。

顺便说一句，在您可能不一定需要多层时创建多层的最大危险是您最终会创建“代理”代码，因为没有更好的术语。也就是说，除了调用具有相同参数的“真实”后端方法之外没有其他用途的方法。一开始感觉更好，因为你有一个干净的层分离，但会导致维护问题，因为例如，要向方法添加参数，你必须添加 3 次（后端、代理层和表示层）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T03:44:22.500

我的第一个问题是：为什么中间有一个 Web 服务？如果这一切都将在同一台物理机器上运行，那么您可能需要重构一个中间层，该中间层通过一组接口使用并使用直接方法调用。

我正在研究一个与中间层 Web 服务分离的架构，但它包含所有公司的关键业务逻辑，并且不会直接暴露在互联网上。就像是：

{互联网} -> |DMZ| -> Web 服务器 -> |防火墙局域网| -> 应用服务器 -> 数据库服务器

在这种情况下，我确实认为它增加了一层安全性，因为关键任务的东西不在 DMZ 上。当然，它在技术上仍然违反了一些安全问题，因为 Web 服务器可以联系应用服务器，但是通过单个端口将应用服务器暴露给 DMZ 中的特定 IP 比将其暴露在互联网上要好。

如果您打算使用 WCF 在服务器之间进行通信，我建议您使用 TCP 上的二进制序列化之类的东西，而不是 SOAP。那应该表现得更好（随意设置一个快速测试）。我自己没有尝试过，但 WCF 可能能够通过网络对数据集或表进行序列化。见[这里](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/010c655e-2548-4f7a-91bb-da95de6b9193/)。

# java - MySql 连接器/J 中的 autoReconnect 和 autoReconnectForPools 有什么区别？

> ID：527061
> 
> 赞同：19
> 
> 时间：2009-02-09T03:28:54.207
> 
> 标签：java, mysql, jdbc, apache-commons-dbcp

在 MySql 的[连接器 J 驱动程序的配置参考中，对使用](http://dev.mysql.com/doc/refman/5.0/en/connector-j-reference-configuration-properties.html)**autoReconnect**属性发出警告购买者。我按照说明增加了服务器的*wait_timeout*。由于我使用的是 DBCP（在阅读了有关 Stackoverflow 击落 DBCP 的几篇文章后，我正在考虑转移到 c3po），可以使用**autoReconnectForPools**属性吗？在 DBCP 或任何连接池下启用它实际上会做什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-02T14:34:31.893

autoReconnect 将向客户端抛出 SQLException，但会尝试重新建立连接。

autoReconnectForPools 将在每次 SQL 执行之前尝试 ping 服务器。

过去我在使用 dbcp 时遇到过很多问题，尤其是断开连接。大多数都通过转移到[c3p0](http://c3p0.sourceforge.net/)得到解决。请注意，mysql 驱动程序具有 c3p0 (com.mysql.jdbc.integration.c3p0.MysqlConnectionTester) 的连接测试器。

此外，您可能需要查看：[使用 JDBC 的连接池选项：DBCP vs C3P0](https://stackoverflow.com/questions/520585/connection-pooling-options-with-jdbc-dbcp-vs-c3p0)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-04-06T19:07:15.790

MySQL 的`autoReconnect`功能已被弃用，因为它有很多问题（参考：官方[文档](http://dev.mysql.com/doc/connector-j/en/connector-j-reference-configuration-properties.html)）。

`autoReconnectForPools`与 几乎没有关系`autoReconnect`，更多的是与`autoCommit`-`reconnectAtTxEnd`当所有 3 个都是时`true`，它将在每个事务结束时 ping 服务器，并在需要时自动重新连接。

DBCP 的连接验证是不完善的——即使`testOnBorrow`设置了它，它有时也会从池中返回断开的连接（更不用说在每次借用之前测试连接是非常低效的）。

根据[这篇文章](https://github.com/brettwooldridge/HikariCP/wiki/Bad-Behavior:-Handling-Database-Down)，HikariCP 似乎是一个更好的池实现，因为它能够使用`isValid()`比运行测试查询快得多的 JDBC4 API，并且专门设计为永远不会向客户端应用程序返回断开的连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T05:32:42.823

您确定您正确使用 DBCP 吗？

根据[简短的配置说明](http://commons.apache.org/dbcp/configuration.html)，它应该可以很好地处理超时，这要归功于默认值`testOnBorrow=true`（在使用之前测试连接，如果连接失败，它将从池中删除，我们尝试获取一个新连接）。

*您唯一需要做*的就是确保将`validationQuery`属性配置为非空字符串，例如 MySQL 数据库的“SELECT 0”（[这里](https://stackoverflow.com/questions/10684244/dbcp-validationquery-for-different-databases)是关于每个使用的 DB 的不同 validationQuery 值的帖子）。

# mysql - 为什么一旦我将主机从“localhost”更新为“mydomain.com”，Wordpress 会突然连接到 MySQL 数据库服务器？

> ID：527065
> 
> 赞同：1
> 
> 时间：2009-02-09T03:32:40.373
> 
> 标签：mysql, apache, wordpress, virtualhost

这是“无法连接”问题的特定变体。就我而言，我刚刚在我的 httpd.conf 中设置了两个虚拟主机，监听端口 80。声明如下所示：

```
名称虚拟主机 *:80

<虚拟主机 *:80>
    服务器名称 site1.dev
    DocumentRoot /www/site1
</虚拟主机>

<虚拟主机 *:80>
    服务器名称 site2.dev
    DocumentRoot /www/site2
</虚拟主机>

```

所以据我了解，[http://localhost](http://localhost)和[http://site1.dev](http://site1.dev)现在都映射到“/www/site1/”，当然[http://site2.dev](http://site2.dev)映射到它的目录。

这一切都很好。我有一个我正在使用的 Wordpress 安装，目前在 site2.dev 域下。我正在尝试将其配置为与我刚刚设置的 MySQL 数据库一起使用，该数据库具有用于“localhost”的帐户“mysql”。因此，在 Wordpress 的配置中，我将该用户名和主机名输入为“localhost”。这不起作用，所以在玩了一段时间后，我尝试将主机名更改为“site2.dev”，突然它就可以正常工作了。

这里发生了什么？我知道我的虚拟主机已设置好，但我认为它们正在侦听端口 80，而不是端口 3306，这是 MySQL 使用的，那么这有什么关系呢？我相信有一个简单的解释，所以希望有人能启发我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T03:40:54.660

一个可能的嫌疑人是您的 MySQL 访问控制配置。yourhost.foo 和 localhost 是完全不同的，就它而言，它总是在咬人。如果 WP 的 MySQL 用户表条目存在且主机键控为`yourhost.foo`但不是`localhost`，那么这就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T03:34:39.823

您是否在设置虚拟主机时编辑了 /etc/hosts 文件？您可能意外删除了“localhost”条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T04:03:58.177

因为您的数据库没有在环回接口（本地主机）上侦听。

# jquery - $.request 和 $.fn.redirect 和 $.redirect 在 jQ 中是什么意思？

> ID：527088
> 
> 赞同：0
> 
> 时间：2009-02-09T04:00:29.683
> 
> 标签：jquery

我正在查看这个 .js 文件，jquery 看起来像：

```
$.fn.redirect
$.redirect
$.request 
```

或者

```
(function($){$.log=function(message){if(window.console){if(window.console.debug)
window.console.debug(message);else if(window.console.log)
window.console.log(message);}
else
alert(message);}; 
```

这些是内置的 jQuery 方法还是自定义的？只是试图理解这个符号。

(function($){}; 是一种启动 .js 文件的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T04:42:54.870

```
(function($){
    // code
})(jQuery); 
```

是一种常用的习惯用法，因此可以以本地化方式使用 $ 别名，而不会影响可能使用其他库（例如 Prototype（带有自己的 $））的页面的其余部分。

[jQuery in Action](http://www.manning.com/bibeault/)解释了这个习语的工作原理：*“通过将 jQuery 传递给将参数定义为 $ 的函数，$ 可以保证在函数体中引用 jQuery。”*

请正确格式化第二个块中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T04:41:34.967

`(function(){ /* your code here */ })();`是一个自执行函数和一个闭包。它用于封装 var 和函数，因此它们不会与未知的全局 var 冲突。它也可以在循环中使用，以确保以正确的值立即执行某些操作`i`。简而言之，它是 JS 开发中非常有价值的工具。

`$.fn.someFunctionName = function() { /* your code here * /}`是一种扩展jQuery的方法。查看 jQuery 的[扩展文档](http://docs.jquery.com/Plugins/Authoring)。

# jquery - 是否可以在 jQuery 中创建命名空间？

> ID：527089
> 
> 赞同：52
> 
> 时间：2009-02-09T04:01:35.923
> 
> 标签：jquery

YUI 有一种很好的方式来为您的方法等在 javascript 中创建命名空间。

jQuery有类似的东西吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-09T04:19:16.863

[lpfavreau](https://stackoverflow.com/users/35935/lpfavreau)提供了使用您自己的方法*扩展*jQuery 对象的解决方案（以便它们的功能适用于实际的 jQuery 对象上下文）。

如果你只想命名你的代码，你可以像这样使用美元符号：

```
$.myNamespace = { .. }; 
```

或“jQuery”：

```
jQuery.myNamespace = { .. }; 
```

请注意您选择的命名空间，因为这可能会覆盖现有的 jQuery 方法（我建议先在 jQuery 代码中搜索，以免您不要这样做）。

您可以点击此链接：[http ://www.zachleat.com/web/2007/08/28/namespacing-outside-of-the-yahoo-namespace/](http://www.zachleat.com/web/2007/08/28/namespacing-outside-of-the-yahoo-namespace/)

看看创建自己的函数来复制 YUI 所做的事情是多么容易：

```
// include jQuery first.
jQuery.namespace = function() {
    var a=arguments, o=null, i, j, d;
    for (i=0; i<a.length; i=i+1) {
        d=a[i].split(".");
        o=window;
        for (j=0; j<d.length; j=j+1) {
            o[d[j]]=o[d[j]] || {};
            o=o[d[j]];
        }
    }
    return o;
};

// definition
jQuery.namespace( 'jQuery.debug' );
jQuery.debug.test1 = function()
{
    alert( 'test1 function' );
};
jQuery.debug.test2 = function()
{
    alert( 'test2 function' );
};
// usage
jQuery.debug.test1();
jQuery.debug.test2(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-30T12:16:58.820

这就是我为插件创建命名空间的方式：

```
(function ($) {
    // do not overwrite the namespace, if it already exists
    $.MyNamespace = $.MyNamespace || {};
    $.MyNamespace.MyPlugin = function () {/*here's the logic*/}
})($); 
```

接着：

```
$.MyNamespace.MyPlugin (); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T04:05:08.113

jQuery 有一堆扩展基本功能的插件。有[这个插件](http://plugins.jquery.com/project/jQueryNameSpace)可以轻松命名空间。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-12-18T21:20:29.823

命名*空间*插件**完全不需要！** 世界上最古老的技巧，使用 arguments.callee、Function.prototype 然后调用新的 Function 实例，允许您使用 $.fn.extend 创建嵌套命名空间！

这是一个简单明了的例子：

```
 ;(function($){
    var options= {
        root: function(){ //you don't have to call it 'root', of course :)
            //identify the function from within itself with arguments.callee
            var fn= arguments.callee;

            //'this' at this level is the jquery object list matching your given selector
            //we equate fn.prototype to this 
            //thus when we call a new instance of root, we are returned 'this'
            fn.prototype= this;

            fn.value= function(){
                //Note: "new this" will work in the below line of code as well,
                //because in the current context, 'this' is fn;
                //I use fn to make the code more intuitive to understand;
                var context= new fn; 

                console.log(context, fn.prototype); //test
                return context.html(); //test
            }

            return this;
        }
    }

    //you can obviously append additional nested properties in this manner as well
    options.root.position= function(){
        var context= new this; //in this context, fn is undefined, so we leverage 'this'

        console.log(context, this.prototype); //test
        return context.offset(); //test
    }

    //don't forget to extend in the end :)
    $.fn.extend(options);

})(jQuery);

;$(function(){
    var div= $('div#div')
        .root();

    console.log(div.root.value());
    console.log(div.root.position());
}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-09-21T01:55:43.770

If you want to use jQuery in this manner:

```
$("*").namespace.do(); 
```

then currently there're no plugins doing that. (I can't find neither John Resig's jquery.space plugin which apparently stopped working in jQuery 1.4, nor Gilberto Saraiva plugin that apparently didn't work as expected). I would gladly take a look at John's function to see why it stopped working, and what can be done to make it work and quite frankly, it would be the best approach of creating uncluttered namespaces.

As per [http://malnotna.wordpress.com/2009/01/12/jquery-namespace-support/](http://malnotna.wordpress.com/2009/01/12/jquery-namespace-support/) another approach is to do namespacing as (using jQuery.Modularize by Ariel Flesler):

```
$("*").namespace().do() 
```

but such syntax isn't "pretty". We're also passing results from one function to another.

My approach to creating namespaces is not putting namespaces in the end, but at the beginning of $, so our $('*').namespace syntax becomes:

```
$.namespace("*").do() 
```

Weirdly, I don't know why such approach isn't mentioned, as it easily allows you to create unclattered namespaces without overwriting already existing functions (by using $.sub()). Also, making it work doesn't require anything. So:

```
(function($){
    $.namespace = $.sub();
    $.fn.test = function(){ return 1 };              
    $.namespace.fn.test = function() { return 2};
})(jQuery);

console.log($('*').test(), $.namespace('*').test()); 
```

And you're ready to go.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-06-10T09:33:48.763

看看这个博客：http: [//javascriptweblog.wordpress.com/2010/12/07/namespacing-in-javascript/](http://javascriptweblog.wordpress.com/2010/12/07/namespacing-in-javascript/)

自调用动态命名空间是我以前使用过的：

```
var myApp = {};
(function(context) {
    var id = 0;

    context.next = function() {
        return id++;
    };

    context.reset = function() {
        id = 0;
    } 
})(myApp); 

window.console && console.log(
    myApp.next(),
    myApp.next(),
    myApp.reset(),
    myApp.next()
); //0, 1, undefined, 0 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T06:32:11.393

根据您尝试做的事情，jQuery 的插件架构可能是您正在寻找的：

```
$.fn.myPlugin = function() {
  return $(this).each(function() {
    // do stuff
  });
}; 
```

或者 ...

```
$.fn.myPlugin = function() {
  var myNamespace = {
    // your stuff
  };
}; 
```

真的，这取决于你想要做什么。

[http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-23T20:46:58.940

感谢@Diego Fluery，我刚刚拿了他的幻灯片并制作了一个可运行的代码原型，但如果你走这条路，它可能会为你节省几分钟：

```
<!DOCTYPE html>
<html>
<head>
<script type="application/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script type="application/javascript">

    $(document).ready(function() {
        (function () {
            $.fn.AppRedirect = function() {
                this.sendRequest = parts.sendRequest;
                this.doRedirect = parts.doRedirect;

                return this;
            }

            var parts = {

                doRedirect: function() {
                    console.log('doRedirect');
                },

                sendRequest: function() {
                    console.log('sendRequest');
                }

            };
        })();

        $("body").AppRedirect().sendRequest();
        $("body").AppRedirect().doRedirect();
    });     

</script>
</head>
<body>
</body>
</html> 
```

# image - Jython，图像信息

> ID：527099
> 
> 赞同：1
> 
> 时间：2009-02-09T04:09:45.137
> 
> 标签：image, jython

我尝试使用 ImageInfo 和 Jython 从硬盘上的图像中获取信息。

我已经很好地导入了模块，但不断收到此错误：

```
TypeError: setInput(): expected 2 args; got 1 
```

这是我尝试使用的代码：

```
filename = "C:\\image.jpg"
img = ImageInfo.setInput(filename) 
```

谁能指出我做错了什么。

干杯

伊夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T05:21:16.980

Jython 抱怨的缺失参数是 ImageInfo 对象本身，它还不存在。您必须先构建它。所以：

```
filename = "C:\\image.jpg"
ii = ImageInfo()
img = ii.setInput(filename) 
```

或者

```
filename = "C:\\image.jpg"
img = ImageInfo().setInput(filename) 
```

也可以工作。

# javascript - 如何使用 SpiderMonkey API 实现闭包？

> ID：527100
> 
> 赞同：1
> 
> 时间：2009-02-09T04:14:24.953
> 
> 标签：javascript, c, spidermonkey

我一直在使用 SpiderMonkey C API，并希望使用他们的 API 在 C 中实现闭包。我想实现的一个相当复杂，但我什至不知道如何做一个简单的，例如：

```
function x() {
   var i = 0;
   return function() { i++; print(i); };

}

var y = x();
y(); //1
y(); //2
y(); //3 
```

我想知道是否有人知道我会如何做到这一点。我找到了 JS_NewFunction 方法，但我实际上不知道这是否是朝着正确方向迈出的一步。任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T05:41:27.647

我不知道是否有一种纯 C 方法来进行闭包。不过，如果可以的话，我建议您只在 javascript 中实现您需要的功能，并在 JSAPI 中简单地评估 javascript 文本。从那里，使用 JSAPI 获取实现主机功能所需的任何句柄/变量。使用 JSAPI 做 javascripty 的事情真的很麻烦，如果可以的话，尽量避免。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-13T20:03:37.593

叙述好像你可能仍然感兴趣，一年后。

[我在JS_GetParent](https://developer.mozilla.org/en/JS_GetParent)的文档中疯狂地皱起眉头，我明白了

> 对于某些函数，它用于实现词法作用域（但这是一个实现细节）。

然后，连同创建函数的 API 函数列表，

> 其中一些函数允许应用程序指定父对象。如果创建对象的 JSAPI 函数有一个 parent 参数，并且应用程序将一个非空值传递给它，那么该对象将成为新对象的父级。否则，如果上下文正在运行任何脚本或函数，则会根据这些选择默认父对象。

我稍后可能会对此进行试验，但似乎您可以通过（仅）在执行您希望它具有范围的函数期间在 API 中创建函数来做到这一点。

[否则，您可能可以使用JS_SetParent](https://developer.mozilla.org/en/SpiderMonkey/JSAPI_Reference/JS_SetParent)手动将函数的词法范围设置为某个对象，但文档一直不祥地称这种使用父级“内部”。

```
</necro> 
```

# webpage - How run exe game inside a webpage

> ID：527121
> 
> 赞同：1
> 
> 时间：2009-02-09T04:39:28.170
> 
> 标签：webpage

is possible and how to use activex control or applet or flash or silverlight to run a exe game inside web browser, i mean like u embed flash game, or java game to web page.

thanks

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T04:59:04.753

When you say "exe game", I assume you mean an executable that will run on the client machine like a normal game, except that it is downloaded when the user visits a webpage? You could find the web browser process and get its window position and position your game window over the top of that I suppose.

Seriously though, things like flash and silverlight exist for a reason: They provide a sandbox where "active" content can be executed without all the (potentially dangerous) functionality that a proper executable has.

What are you trying to do?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-28T19:07:22.477

Have a look at [http://www.xenocode.com/](http://www.xenocode.com/)

After installing a small Browser-Plugin webusers can run prepared applications normally written for desktop-usage on the web in a sort of sandbox.

That solution should come as close as possible to your intended usage, I think.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T05:52:10.523

If you want to do what I *think* you want then it isn't possible. :)

As geofftnz mentioned the user have to download the complete program before he can start / use the program. But otherwise you could offer a simple download-link to do so. To run the program / game with all files on the server and to show the user only the output (and perhaps offer some options for input) isn't possible, either - most programs are designed as single-user applications, so you would have to start a new instance of the program for every user visiting the site. Irrespective the ressources you server need therefor, some programs allow only one instance running coexistent.

So, embedding a foreign / 3rd party program into a website isn't possible, I fear. When using your own program you can create it with Flash or Silverlight, if essential even as a ActiveX (more possibilities but also more security risks for the users). Such applications only load the main functionality on initial load and can reload missing components or data when needed (e.g. for games: the actual part of the worldmap, new levels, items, ...). But 3rd party programs, not construed for running as a server you can control with a API, have to be rewritten. By yourself or by the original publisher (unlikely ;) ).

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T06:04:37.390

Google is working on this, [http://google-code-updates.blogspot.com/2008/12/native-client-technology-for-running.html](http://google-code-updates.blogspot.com/2008/12/native-client-technology-for-running.html) a way to run x86 code natively in a browser.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-16T17:23:07.550

You would have to create you own client browser as they have at the link you provided.. [http://unity3d.com/gallery/live-demos/tropical-paradise](http://unity3d.com/gallery/live-demos/tropical-paradise)

the only thing is you would need premission from the creators to allow them to be played or hosted on your site.. and you would need the programming knowledge to create the client to do so.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T05:27:31.067

Asking your visitor to run a executable is sure to attract only the fools who will trust you and also, he will need to run MS Windows.

You might want to look at alternatives suggested above.

# javascript - 如果一个 被点击，隐藏内部div

> ID：527122
> 
> 赞同：1
> 
> 时间：2009-02-09T04:39:44.660
> 
> 标签：javascript, jquery

我的 DOM 看起来像这样：

```
<li id="li1">
         <div class="c1"></div>
</li>
<li id="li2">
         <div class="c1"></div>
</li> 
```

使用 jQuery，如果`<li>`单击第一个，我希望`<div></div>`隐藏内部。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T04:45:18.547

```
$("li:first").click(function() {
    $(this).children("div").hide();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T04:41:57.977

当将 2 个列表项标识为相同的 ID 时，您会遇到问题。如果您希望将相同的 CSS 应用于两者，请改用类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T04:48:32.597

这可能对你有用：

注意：确保包含 jquery.js，我很懒，没有把它放在这里。

```
<html>
<head>
<script type="text/javascript" language="javascript">
$(document).ready(function(){

    $(".clickableLI").click(function(){
        $(this).find("div").hide();    
    });

});
</script>

</head>
<body>
    <ul>
        <li class="clickableLI">
             <div class="c1"></div>
        </li>
        <li class="clickableLI">
             <div class="c1"></div>
        </li>
    <ul>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T04:47:37.933

拥有两个相同的 ID 是无效的 xHTML

不确定确切的 jQuery 语法

但在 sudo 代码中会是这样的：

li1 addEvent('click')
{

获取 li1 的子级，按 c1 类过滤
设置子级样式（显示，无）
}

# .net - 如何在分布式架构中使用 NHibernate？

> ID：527123
> 
> 赞同：2
> 
> 时间：2009-02-09T04:41:09.197
> 
> 标签：.net, nhibernate, architecture

我开始构建一个分布式架构的系统，所有应用程序将通过 REST 服务进行通信以公开一些数据（DTO）或调用一些更新。我想知道如何使用 NHibernate 来帮助管理域对象，因为它们位于不同的应用程序中。NHibernate 如何识别哪些对象是新的用于插入和旧的用于更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T06:27:35.120

如果您想快速了解 NHibernate 的工作原理，请观看 Stephan Bohlen 的精彩视频系列，名为[Summer of NHibernate](http://www.summerofnhibernate.com/)。

他展示了从非常简单的 NHibernate 设置到在复杂环境中使用 NHibernate 的所有内容。

NHibernate 跟踪它在“会话”中查询的对象，这就是它知道对象是否已更改的方式。此外，您很可能会在您的对象上定义一个主键并定义一个值，向 NHibernate 发出信号，表明这是一个从未保存到数据库中的新对象（例如，在 ID 字段中具有“0”可能表示--> 这是一个新对象）。

所有这些都在 NHibernate 之夏系列中得到了详细的展示和解释——值得一看！

马克

# jquery - 是否有内置的方式来显示/隐藏 jQuery 中的元素？

> ID：527129
> 
> 赞同：1
> 
> 时间：2009-02-09T04:43:32.733
> 
> 标签：jquery

我知道如何在 jquery 中显示/隐藏或淡入/淡出，但是是否有内置方法可以在显示/隐藏或淡入/淡出之间切换，或者我是否首先查看元素是否显示：无，如果是则显示否则隐藏？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T04:51:20.733

您可以使用 toggle() 函数。

[http://docs.jquery.com/Effects/toggle](http://docs.jquery.com/Effects/toggle)

或者

[http://docs.jquery.com/Effects/slideToggle](http://docs.jquery.com/Effects/slideToggle)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T05:17:46.130

```
$(element).toggle() 
```

切换显示每组匹配元素。如果它们被显示，toggle 使它们隐藏（使用 hide 方法）。如果它们被隐藏，则切换使它们显示（使用 show 方法）。

[http://docs.jquery.com/Effects/toggle](http://docs.jquery.com/Effects/toggle)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T05:28:21.923

看看循环插件，很棒。可能不是您正在寻找的东西，但它有一些非常好的功能。

[http://www.malsup.com/jquery/cycle/](http://www.malsup.com/jquery/cycle/)

# java - Java POI - 任何人都能够从公式单元格中提取数字？

> ID：527140
> 
> 赞同：1
> 
> 时间：2009-02-09T04:51:51.073
> 
> 标签：java, spreadsheet, apache-poi

我已经使用Java POI有一段时间了，但是遇到了一个新问题，我想知道是否有人找到了解决方案。

阅读电子表格时，您需要知道单元格的类型才能使用正确的阅读方法。

所以你得到单元格类型，然后调用适当的读取方法来获取单元格的内容。

这适用于除 FORMULA 单元格之外的所有单元格，其中值是数字。如果是文本，您可以阅读它。但是如果结果值是一个数字，那么你从单元格中得到的只是一个空白字符串。

我已经阅读了 POI 的 javadocs，并且正在使用正确的数据类型（HSSFRichTextString），但仍然没有乐趣。

有人有解决方案吗？

PS POI 的这种行为确实让我感到困惑，因为应该有一个默认的 cell.toString() 方法，该方法将返回任何单元格类型的字符串表示，例如默认为单元格的 value 属性。（有点像可以选择“值”的特殊粘贴）。

PPS：正如所问 - 我正在使用 Java 6 (1.6.0_06) 和 poi-3.0.2-FINAL-20080204.jar

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T05:03:13.933

```
 FileInputStream fis = new FileInputStream("c:/temp/test.xls");
    Workbook wb = new HSSFWorkbook(fis); //or new XSSFWorkbook("c:/temp/test.xls")
    Sheet sheet = wb.getSheetAt(0);
    FormulaEvaluator evaluator = wb.getCreationHelper().createFormulaEvaluator();

    // suppose your formula is in B3
    CellReference cellReference = new CellReference("B3"); 
    Row row = sheet.getRow(cellReference.getRow());
    Cell cell = row.getCell(cellReference.getCol()); 

    CellValue cellValue = evaluator.evaluate(cell);

    switch (cellValue.getCellType()) {
        case Cell.CELL_TYPE_BOOLEAN:
            System.out.println(cellValue.getBooleanValue());
            break;
        case Cell.CELL_TYPE_NUMERIC:
            System.out.println(cellValue.getNumberValue());
            break;
        case Cell.CELL_TYPE_STRING:
            System.out.println(cellValue.getStringValue());
            break;
        case Cell.CELL_TYPE_BLANK:
            break;
        case Cell.CELL_TYPE_ERROR:
            break;

        // CELL_TYPE_FORMULA will never happen
        case Cell.CELL_TYPE_FORMULA: 
            break;
    } 
```

[从这里](http://poi.apache.org/spreadsheet/eval.html)无耻地复制

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-12T18:34:14.887

只需将该单元格转换为文本..使用复制-“特殊粘贴”...我按如下方式进行...

**从第 2 点阅读：**

[http://www.asif-shahzad.com/2010/12/how-to-read-numbers-as-string-value-in.html](http://www.asif-shahzad.com/2010/12/how-to-read-numbers-as-string-value-in.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-13T16:44:15.617

使用 createFormulaEvaluator 的替代方法是使用 SetCellType(CellType.STRING)，然后访问 StringCellValue。当它包含 WORKDAY() 函数时，我在使用公式评估器（使用 NPOI）时遇到了问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T10:57:58.650

如果 POI 不适合您，请尝试[Andy Khan 的 JExcel](http://andykhan.com/jexcelapi/index.html)。我更喜欢它。

# macos - 用于在 Mac OS X 浏览器中激活代码完成风格功能的安全键盘快捷键

> ID：527143
> 
> 赞同：1
> 
> 时间：2009-02-09T04:53:38.417
> 
> 标签：macos, browser, keyboard-shortcuts

我正在为 Web 应用程序中的文本区域和输入构建一些代码完成样式的文本扩展功能。我正在尝试为在 Mac OS X 上运行的浏览器调用完成建议制定一个安全的键盘快捷键。

我已经淘汰了一些潜在的候选人：

*   `Command`+ `Space`- 激活 Spotlight 搜索字段
*   `Control`+ `Space`- 在 Firefox 中激活上下文菜单
*   `Esc`- 取消 Firefox 中的任何背景 XMLHttpRequests

留下`Option`+ `Space`。我知道这可能会与[Ubiquity](http://ubiquity.mozilla.com/)之类的工具发生冲突，但我们不希望我们的观众会使用这些工具。

**Option+Space 是否存在我可能遗漏的任何冲突？或者您对键盘快捷键有更好的想法，为什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T19:04:50.010

许多 Mac OS X 应用程序使用`Option`+`Esc`来完成代码或代码提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T07:26:17.257

我记得，Visual Studio 和 TextMate 都使用 tab 来完成代码。在 Visual Studio 中，当您开始键入时会弹出一个智能感知菜单，并且选项卡用作选择确认。

在 TextMate 中，您开始键入命令的一部分，然后单击选项卡以激活所述命令的关联“捆绑包”。关联的包通常会生成一个代码片段，并在您键入时填充该片段的任何动态部分。

想一想，大多数命令行也以这种方式工作，在键入几个字符后按下制表符时自动完成文件名和路径。

**编辑：**您说 Web 界面中的字段切换需要选项卡，但您可能想尝试拦截文本字段中的键盘事件，并检查它们是否开始输入宏。如果有，则通过返回 false 自动完成并吞下密钥；如果没有，只需让命令冒泡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T15:46:14.993

某种选项卡快捷方式听起来像是最好和最直观的方法——用户应该习惯于“类型-选项卡-类型-选项卡”工作流程——如果它只是可选的，可以将其与修饰符结合使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T10:36:10.870

我与我们的设计团队讨论了这些想法。其中一位建议使用`Control`+ `Enter`，这是我们决定使用的。这会导致仅包含单个输入字段的表单在 Firefox 中自动提交，但我们通过防止由事件引起的默认操作来处理这个问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-09T15:36:22.087

我将 Spotlight 命令重新分配给`Command`++ 。这可以通过 Prefrences.App 轻松完成`Shift``Space`

# c# - C#: windows 应用程序 Caspol

> ID：527144
> 
> 赞同：0
> 
> 时间：2009-02-09T04:53:51.320
> 
> 标签：c#, windows, caspol

我有一个 Windows 应用程序......它将在非常受限的环境中运行...... Windows 应用程序查询事件日志和性能计数器......它需要这些权限......登录帐户被限制不允许访问事件日志和性能日志。 ..我无法对Windows应用程序进行任何更改...我正在寻找一种授予程序集访问事件日志+性能计数器的权限。或者最坏的情况是使程序集完全信任...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T05:07:29.493

如果我理解您的问题，该应用程序将在无权访问事件日志和性能计数器的帐户的凭据下运行。如果是这种情况，无论您如何使用 CAS 策略，应用程序都不会执行您想要的操作。

CAS 策略不能授予帐户没有的权限 - 因此即使应用程序完全信任，它也不会访问帐户无权访问的任何对象。

# apache-flex - S3 是否可以通过浏览器在 Flex 中使用？

> ID：527148
> 
> 赞同：0
> 
> 时间：2009-02-09T04:54:49.193
> 
> 标签：apache-flex, actionscript-3, browser, amazon-s3

我知道 Amazon S3 可以通过 AIR 应用程序在 Flex 中使用（[你可以通过 Flex 使用 Amazon S3 吗？](https://stackoverflow.com/questions/186768/can-you-use-amazon-s3-via-flex)），但很好奇它是否适用于 Flex 源代码的浏览器 (swf) 编译。

在[http://code.google.com/p/as3awss3lib/](http://code.google.com/p/as3awss3lib/)它声明：

“由于浏览器播放器的限制，它只能在 Apollo 中使用。” （Apollo 是现在称为 AIR 的代号 - 桌面运行时。）

有没有人有这方面的经验并且可以另外确认？

谢谢你。

编辑：没有人尝试过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T20:26:47.140

这是因为在浏览器中运行的 Flash Player 无权访问响应标头。Amazon S3 可能在响应标头中发送重要信息。这是之前讨论过的：

[访问 flash.net.URLLoader 对象的 HTTP 响应标头？](https://stackoverflow.com/questions/185761/access-http-response-headers-in-for-flash-net-urlloader-object)

您可以尝试使用名为 as3httpclientlib 的第三方库，代码示例位于[http://code.google.com/p/as3httpclientlib/wiki/Examples](http://code.google.com/p/as3httpclientlib/wiki/Examples)

# .net - 安装基于 SQL Compact 的 .NET 应用程序

> ID：527157
> 
> 赞同：0
> 
> 时间：2009-02-09T05:01:32.953
> 
> 标签：.net, installation, sql-server-ce

有没有办法让应用程序访问 SQL Compact 数据库文件而无需安装 SQL Compact 安装程序？当用户安装我的程序时，我不想运行单独的安装程序。我可以在我的应用程序文件夹中只使用一些放置良好的 DLL 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T07:55:57.450

可以在您的应用程序中私有部署运行时，并且无需管理员权限。

这是[3.5](http://msdn.microsoft.com/en-us/library/aa983326.aspx)和[以前版本](http://msdn.microsoft.com/en-us/library/aa983326(VS.80).aspx)的文档，因为它们有些不同。

# date - 在移动网站上选择日期

> ID：527160
> 
> 赞同：1
> 
> 时间：2009-02-09T05:04:41.573
> 
> 标签：date, mobile, user-input

我正在开发一个网站，其中包括在移动网站上创建约会。我必须让它在 IE Mobile 上运行。

最大的挑战是想出一种在移动网站上进行日期选择的方法：

*   足够紧凑，不会永远加载到有限带宽的蜂窝网络上。
*   适用于 Windows Mobile 6
*   阻止用户输入任何值（自由格式的文本框是不可能的）

到目前为止，我提出的选项是：

*   年、月、日的下拉列表（以及客户端或服务器验证以确保选择的有效性，即不允许 2 月 31 日）
*   使用 jQuery 插件并希望 jQuery 可以在我的目标设备上运行（IE Mobile、Blackberry、iPhone）
*   编写某种复杂的 IFrame AJAX 灯箱，其中包含一个基本的日历选择器（即不依赖于 jQuery），类似于 Google 在其移动日历网站上所做的。

由于我似乎无法想出任何真正可靠的想法，我想看看 SO 社区可以想出什么作为移动日期输入的体面解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T23:55:37.997

我会选择你的第一个选择

*   年、月、日的下拉列表（以及客户端或服务器验证以确保选择的有效性，即不允许 2 月 31 日）

所有其他选项*可能*适用于特定的手机，但你会不断遇到嘿......它在我的手机上不起作用的问题。

我非常希望 JavaScript 在手机上变得标准化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T05:09:25.773

您是否考虑过屏蔽输入？我不确定它是否能满足您的需求，但值得一试。这是一个jQuery实现：

[http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

编辑：在考虑了更多之后，我可能会选择您拥有的灯箱日历创意或下拉菜单。下拉菜单的好处是您可以为拥有更好 Javascript 支持的用户增强输入法。例如，您可以隐藏下拉菜单并提供一个虚拟弹出日历，在使用该日历时，会将值填充到下拉菜单中。

请记住，您应该始终在服务器上进行验证。如果您也可以在客户端执行此操作（或至少限制输入），那么这是增加可用性的一个奖励功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T06:56:53.537

您正在使用 ASP.NET 吗？如果是，请查看以下链接：

*   ~~[ASP.NET 移动](http://www.asp.net/mobile/overview/)~~
*   ~~[使用 ASP.NET 进行移动 Web 开发](http://blogs.msdn.com/trobbins/archive/2007/07/13/mobile-web-development-with-asp-net-2-0.aspx)~~

可以使用日历控件，虽然我自己没有测试过，但它应该可以在移动 IE 上正常工作。

# c++ - 使用变换创建新向量

> ID：527166
> 
> 赞同：19
> 
> 时间：2009-02-09T05:10:42.963
> 
> 标签：c++, stl

我有一个整数向量，我想将它转换为对向量（对由 bool 和 int 组成）。我当前的代码很简单，如下所示：

```
 std::vector<int> a;
    std::vector<std::pair<bool,int> > b;

    a.push_back(1);
    a.push_back(2);
    a.push_back(3);

    for(int i = 0; i < a.size(); ++i)
    {
        b.push_back(std::make_pair(false, a[i]));
    } 
```

有没有办法在不自己编写循环的情况下做到这一点？可能使用一些算法？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-09T05:21:38.240

**1.**你可以制作一个仿函数并且`std::for_each`：

```
struct F {
    F(std::vector<std::pair<bool,int> > &b) : m_b(b){
    }

    void operator()(int x) {
        m_b.push_back(std::make_pair(false, x));
    }

    std::vector<std::pair<bool,int> > &m_b;
};

std::for_each(a.begin(), a.end(), F(b)); 
```

尽管这可能被证明是比它的价值更多的麻烦。但至少它可以重复使用:)。

也许有什么可以做的`boost::bind`。

**2.**编辑：我在想你也许可以将绑定与后插入器和转换一起使用。像这样的东西：

```
std::transform(a.begin(), a.end(), std::back_inserter(b), boost::bind(std::make_pair<bool, int>, false, _1)); 
```

我试过这个`std::bind1st`，我认为它应该有效，但我只能让它成功`boost::bind`。我会继续努力...

**3.**编辑：这是一个非增强解决方案：

```
std::transform(a.begin(), a.end(), std::back_inserter(b), std::bind1st(std::ptr_fun(std::make_pair<bool, int>), false)); 
```

**4.**编辑：这是一个 C++11 解决方案（这是我目前最喜欢的）：

```
std::for_each(begin(a), end(a), [&b](int v) {
    b.emplace_back(false, v);
}); 
```

甚至更简单：

```
for(int v : a) {
    b.emplace_back(false, v);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-31T17:39:21.877

没有什么花哨。只是我喜欢的两行解决方案：

```
#include <algorithm>
#include <iostream>
#include <vector>

int main()
{
    std::vector<int>                  a{1,2,3,4,15};
    std::vector<std::pair<bool, int>> b;

    auto it = a.begin();
    std::generate_n(std::back_inserter(b), a.size(), [&it]() { return std::make_pair(false, *it++); });

    for(auto c : b) {
        std::cout << std::boolalpha << c.first << " " << c.second << "\n";
    }
} 
```

`[Demo](http://coliru.stacked-crooked.com/a/a40496108780b802)`

# c# - 使用 LINQ 在 ASP.NET MVC 中传递数据 - 疯狂

> ID：527187
> 
> 赞同：3
> 
> 时间：2009-02-09T05:28:23.857
> 
> 标签：c#, .net, asp.net-mvc, linq, linq-to-sql

请允许我开始：我是 ASP.NET MVC 上的 n00b。我喜欢它，但我是一个n00b。

我正在尝试从 LINQ 查询传回“复杂”数据。我了解如何使用数据上下文，然后在我发回数据时将其转换，但是当我执行返回匿名类型的更复杂的 LINQ 查询时，事情就崩溃了。

我看到有人问了一个类似的问题（[MVC LINQ to SQL Table Join Record Display](https://stackoverflow.com/questions/278941/mvc-linq-to-sql-table-join-record-display)），答案似乎是创建一个新的数据类型来捕获来自 LINQ 查询的数据。我不知道我可以在控制器中创建一个 var 类型，并访问控制器中的成员字段，但是如果我想将该 var 传递回我的视图，我需要为此创建一个全新的类。

这是我的控制器代码：

```
var vrGoodResults1 = from records in db.Words
                      group records by records.word1 into g
                      select new
                      {
                          strWord = g.Key,
                          intWordCount = g.Count()
                      };
            ViewData["GoodWords"] = vrGoodResults1;
            return View(); 
```

视图如下所示：

```
<% foreach (var kvp in (IEnumerable)ViewData["GoodWords"]) %>
<% { %>
        <%= String.Format("{0} was used times", kvp) %> <br />
<% } %> 
```

哪个输出：

```
{strWord = cool, intWordCount = 2 } was used times
{strWord = educated, intWordCount = 1 } was used times
{strWord = great, intWordCount = 1 } was used times
{strWord = smart, intWordCount = 6 } was used times
{strWord = strong, intWordCount = 2 } was used times
{strWord = super smart, intWordCount = 2 } was used times 
```

所以数据正在进入视图，但我无法通过我在 LINQ 查询中分配的字段名称来引用数据。当我尝试转储 kvp.GetType() 时，我得到：

```
<>f__AnonymousType1`2[System.String,System.Int32] 
```

我想要做的只是一些类似的事情：

```
<%= String.Format("{0} was used {1} times", kvp.strWord, kvp.intWordCount) %> <br /> 
```

但是我在 kvp.strWord 上遇到了编译错误。

```
error CS1061: 'object' does not contain a definition for 'strWord' and no extension method 'strWord' accepting a first argument of type 'object' could be found (are you missing a using directive or an assembly reference?) 
```

如果我将以下代码插入到我的控制器中：

```
foreach (var kvp in vrGoodResults1)
{
     string strNew = kvp.strWord;
} 
```

我可以引用我的变量 kvp 的字段而不会出现编译错误。所以当从控制器传递到视图时，有些东西会丢失。我是否忘记在某处包含某些内容？也许是“使用”或在“<@ Page”指令中，我是否忘记继承某些东西？

当您将 LINQ 用于明确的数据上下文时，您只需设置 IEnumerable<”datatype”> 其中“datatype” = 您的数据上下文类型，一切都很好。当您在 LINQ 中将数据集缩减为新的东西时，我无法相信最好的答案是创建一个新类以便我可以在我的视图中使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T05:32:47.903

`var`是用于在当前范围内声明类型的编译器快捷方式。它不会向 .NET 运行时添加任何动态功能，因此范围之外的代码将对象视为“System.Object”，因为这是视图代码知道的继承链中最具体的类型。

如果你想传递元组对象，你应该创建一个真正的类；那是你以前必须做`var`的，所以现在做这件事不会让你失去任何东西:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T05:31:57.373

这里最好的答案*就是*创建一个新类型。`object`你可以从（[见这里](http://msmvps.com/blogs/jon_skeet/archive/2009/01/09/horrible-grotty-hack-returning-an-anonymous-type-instance.aspx)）取回匿名类型，但它既丑陋又脆弱。不要这样做！

您可以使用反射 ( `kvp.GetType().GetProperty("strWord").GetValue(kvp, null)`) - 但这也不是一个好主意。

在这种情况下 - 也许使用`KeyValuePair<string,int>`原始选择中的现有？还是你自己的`Tuple<T1,T2>`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T13:34:53.563

不要害怕新类型。它们也提供了许多其他好处，尤其是在测试时。使用新的属性语法，你的类将只有你有属性的行数。你也可以失去那个可怕的匈牙利符号。Int 和 str - yuk

# asp.net-mvc - 在 ASP.NET MVC 应用程序中测试最重要的事情是什么？

> ID：527196
> 
> 赞同：9
> 
> 时间：2009-02-09T05:42:33.043
> 
> 标签：asp.net-mvc, unit-testing

大多数关于 ASP.NET MVC 单元测试的 stackoverflow 帖子都讨论了特定问题或要测试的特定事物，例如[测试 HtmlHelpers](https://stackoverflow.com/questions/271699/testing-htmlhelpers-in-asp-net-mvc)。其他关于最佳实践主题的[答案出乎意料地少](https://stackoverflow.com/questions/358210/best-practices-to-test-asp-net-mvc-applications)。在我看来，我看过的可用视频[完全没用](http://www.asp.net/learn/mvc-videos/video-405.aspx)——而且脑洞非常[长](http://www.asp.net/learn/mvc-videos/video-409.aspx)（当你看了 1.5 小时并且什么都没学到的时候）。

我想从实际上一直在做这件事的人那里知道：

*   首先要测试的最重要的事情是什么
*   什么不需要测试（我这么说很震惊，但我不是在 100% 之后）
*   什么是**难以**测试的，你是如何克服难以测试的。
*   测试无法捕捉到的重构中会出现哪些问题。

我对如何进行单元测试并不陌生——但我对实际始终如一地进行测试还是很陌生。我真的很感谢从单元测试 ASP.NET MVC 方面的专家那里学到的经验教训。

我真的在寻找特定的东西，你可能只有在尝试过之后才会发现——而不是像“使用接口”这样的一般建议——尽管当然欢迎任何建议。

哦，假设我决定使用微软的单元测试——只是因为它已经在那里了。我认为所有答案都适用于所有测试框架。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T14:45:07.920

*   **测试你的路由。**当你在你的视图中生成一个 URL 时，你应该使用 RouteLink 来消除歧义，但是当你提交一个 URL 时，你依赖于路由系统来选择正确的路由。因此，请测试您支持的 URL 模式是否确实返回了正确的路由。
*   测试你的控制器动作。使用模拟存储库，并测试手动调用每个操作是否具有您期望的结果。
*   测试模型中的所有业务逻辑。这是显而易见的，与非 MVC 应用程序几乎没有区别。
*   测试您编写的任何自定义视图助手。虽然我一般不会对视图进行单元测试，但视图助手是不同的。
*   测试你的 JavaScript。有针对此的单元测试框架，测试 JavaScript 非常容易，以至于几乎不需要这样的框架。但是测试 JavaScript 非常重要，因为该语言倾向于向您隐藏错误。
*   如果您编写了任何自定义模型绑定器，则需要特别注意它们。一方面，通过单元测试调试模型绑定器比在应用程序中“实时”调试模型绑定器要容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-15T13:25:25.033

我想详细说明测试控制器操作：

*   验证您获得了正确的`ActionResult`. 重定向不同于视图。
*   还要验证预期的视图名称。如果您依赖默认视图，它应该是空的。
*   验证您获得了正确的视图模型。
*   验证您的操作中的所有分支。将它们保持在最低限度，并在它们增长过多时将它们转移到帮助器/服务中。

简而言之，验证`ActionResult`您将使用的任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T07:10:49.103

我不认为答案必须特定于 ASP.NET MVC。与任何其他应用程序一样，您必须测试的最重要的事情是您的核心逻辑。也就是说，您的模型代码和您的控制器操作。

# python - 在运行时拦截子进程的标准输出

> ID：527197
> 
> 赞同：25
> 
> 时间：2009-02-09T05:43:35.583
> 
> 标签：python, process, subprocess, stdout, popen

如果这是我的子流程：

```
import time, sys
for i in range(200):
    sys.stdout.write( 'reading %i\n'%i )
    time.sleep(.02) 
```

这是控制和修改子进程输出的脚本：

```
import subprocess, time, sys

print 'starting'

proc = subprocess.Popen(
    'c:/test_apps/testcr.py',
    shell=True,
    stdin=subprocess.PIPE,
    stdout=subprocess.PIPE  )

print 'process created'

while True:
    #next_line = proc.communicate()[0]
    next_line = proc.stdout.readline()
    if next_line == '' and proc.poll() != None:
        break
    sys.stdout.write(next_line)
    sys.stdout.flush()

print 'done' 
```

为什么要等到进程完成运行`readline`？`communicate`有没有一种简单的方法来实时传递（和修改）子进程的标准输出？

我在 Windows XP 上。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-09T06:12:49.583

正如查尔斯已经提到的，问题在于缓冲。我在为 SNMPd 编写一些模块时遇到了类似的问题，并通过将 stdout 替换为自动刷新版本来解决它。

我使用了以下代码，灵感来自 ActiveState 上的一些帖子：

```
class FlushFile(object):
    """Write-only flushing wrapper for file-type objects."""
    def __init__(self, f):
        self.f = f
    def write(self, x):
        self.f.write(x)
        self.f.flush()

# Replace stdout with an automatically flushing version
sys.stdout = FlushFile(sys.__stdout__) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-09T05:49:20.717

过程输出被缓冲。在更多的 UNIXy 操作系统（或 Cygwin）上，可以使用[pexpect](http://www.noah.org/wiki/Pexpect)模块，它背诵所有必要的咒语以避免与缓冲相关的问题。但是，这些咒语需要一个有效的[pty 模块](http://docs.python.org/library/pty.html)，这在本机（非 cygwin）win32 Python 版本上不可用。

在您控制子流程的示例情况下，您可以`sys.stdout.flush()`在必要时调用它——但对于任意子流程，该选项不可用。

另请参阅[问题“为什么不只使用管道 (popen())？”](http://www.noah.org/wiki/Pexpect#Q:_Why_not_just_use_a_pipe_.28popen.28.29.29.3F) 在预期的常见问题解答中。

# .net - 不可能（我多么讨厌使用这个词）交叉线程错误？

> ID：527198
> 
> 赞同：6
> 
> 时间：2009-02-09T05:43:51.450
> 
> 标签：.net, multithreading

谁能解释一下这怎么可能发生？

我完全意识到考虑到线程安全的编程，正如你所看到的，我正在通过 InvokeRequired 检查这里的表单来满足 UI 更新，一切工作正常，没有任何改变可以打破我知道的这一点，现在突然就像我正在编写应用程序的其他部分（可能在某个阶段添加到此方法中？我只是不记得了）我很亲密地收到此错误：

![替代文字](https://dl.getdropbox.com/u/477279/Stackoverflow/invokeIssue.gif)

首先，如果 InvokeRequired = true，这应该意味着 BeginInvoke() 已执行，方法是 [queued] 被重新调用并且 InvokeRequired 应该等于 false？

我不应该收到这个例外，因为它应该得到满足？

希望听到一些多线程专家的意见:)

格雷厄姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T06:20:20.987

我怀疑 InvokedRevoked 可能在骗你。WinForm 控件推迟创建控件的底层 Win32 HWND，直到方法调用实际需要它。如果尚未创建 HWND，则 InvokeRequired 将返回 false。

详细解释见：[**《神秘的Hang or The Great Deception of InvokeRequired》**](http://ikriv.com:8765/en/prog/info/dotnet/MysteriousHang.html)

如果您的后台线程在 UI 线程导致控件延迟创建其 HWND*之前*查询 InvokeRequired ，则 InvokeRequired 将（错误地）告诉您的后台线程它不需要使用 Invoke() 将控制权传递回 UI 线程。当后台线程然后访问控件时，BAM！*“InvalidOperationException：跨线程操作无效！”*

UI 线程可以手动强制 Control 创建其 HWND 句柄，以便 Control.InvokeRequired 知道 UI 线程是 Control 的所有者：

```
Control control = new Control();
IntPtr handle = control.Handle; // if you ask for HWND, it will be created 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T05:54:02.190

大多数人看到该错误并看到一件事，“您没有从主 UI 线程访问此控件。” 实际上，如果需要，您可以拥有 100 个 UI 线程（此行为未定义，但受支持）。有可能 panelMain 是在与 (this) 不同的线程上创建的；我看不到代码 - 但看起来你是在你的工作线程/线程中创建它。

要确认该行为，请尝试以下操作：

```
Action addAction = new Action (
   new delegate { panelMain.Controls.Add(UCLoadingScreen); } )
if(panelMain.InvokeRequired)
{
   panelMain.Invoke(addAction); // Breakpoint here.
}
else
{
   addAction();
} 
```

为不同的错误做好准备（与父级不同的线程上的子控件，不确定你会得到什么错误，但我很确定你会）。这不是解决办法。

但是，工厂将解决此问题：

```
public void CreateControl<T>() where T : new()
{
    if(InvokeRequired)
    {
        return (T)Invoke(new Func<T>(CreateControl<T>()));
    }
    return new T();
} 
```

编辑：panelMain 可能不是线程“违规者”，正如我所说，来自不同线程的父控件会导致高度未定义的行为。确保所有控件都是在主窗体线程的上下文中创建的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T06:29:49.763

没有不可能的交叉线程错误！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T19:04:49.013

我希望这对你有用。我假设你的 gui 东西在一个线程上。只需初始化此单例并在您想调用 Control.InvokeRequired 属性时依赖它。

干杯，

-格雷格

```
public sealed class UiThread
{
  #region Singleton
  // Singleton pattern implementation taken from Jon Skeet's C# and .NET article www.yoda.arachsys.com/csharp/singleton.html

  UiThread() { }

  public static UiThread Instance { get { return Nested.instance; } }

  class Nested
  {
     // Explicit static constructor to tell C# compiler
     // not to mark type as beforefieldinit
     static Nested() { }

     internal static readonly UiThread instance = new UiThread();
  }
  #endregion

  int _uiThreadId = 0;

  public void SetUiThread(Thread thread)
  {
     if (_uiThreadId != 0)
        throw new ApplicationException("UI Thread has already been established!");

     if (thread.ManagedThreadId == 0)
        throw new ArgumentException("Unexpected thread id value of 0!");

     if (thread.IsBackground)
        throw new ArgumentException("Supplied thread should not be a background thread!");

     if (thread.IsThreadPoolThread)
        throw new ArgumentException("Supplied thread should not be a thread pool thread!");

     _uiThreadId = thread.ManagedThreadId;
  }

  /// <summary>
  /// It's possible for InvokeRequired to return false when running in background thread.
  /// This happens when unmanaged control handle has not yet been created.
  /// We second-guess Microsoft's implementation in this case, checking against foreground thread's Id.
  /// </summary>
  /// <param name="control">Control to check against.</param>
  public bool InvokeRequired(Control control)
  {
     if (control.InvokeRequired)
        return true;

     IntPtr unmanagedHandle = control.Handle;
     bool newResult = control.InvokeRequired;

     if (unmanagedHandle == IntPtr.Zero)
     {
        // Trace.WriteLine() call here forces unmanagedHandle's initialization, 
        //  even with optimizing compiler.
        Trace.WriteLine(string.Format("Control handle could not be established! Control was {0}.", control.ToString()));
     }

     bool retVal = InvokeRequired();

     // Break whenever the result of our check does not match theirs.
     Debug.Assert(retVal == newResult);

     // Return our InvokeRequired result over theirs 
     //   to keep with the tradition of updating controls from foreground only.
     return retVal;
  }

  /// <summary>
  /// Prefer to use overload with Control argument if at all possible.
  /// It's possible for InvokeRequired to return false when running in background thread.
  /// This happens when unmanaged control handle has not yet been created.
  /// We second-guess Microsoft's implementation in this case, checking against foreground thread's Id.
  /// </summary>
  public bool InvokeRequired()
  {
     if (_uiThreadId == 0)
        throw new ApplicationException("UI Thread has not been established!");

     return (Thread.CurrentThread.ManagedThreadId != _uiThreadId);
  } 
```

}

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-09T05:52:30.570

采用

```
if (InvokeRequired)
{
  //invoke
}
else
{
  //do
} 
```

# sharepoint - Sharepoint 中文档库的全局自定义视图

> ID：527209
> 
> 赞同：3
> 
> 时间：2009-02-09T05:53:00.367
> 
> 标签：sharepoint

在 Sharepoint 文档库中，当我们创建一个新的文档库时，默认视图是“所有文档”。这个：

![替代文字](https://i592.photobucket.com/albums/tt5/astri_kusumawardani/crm/docLib_allDOcView_500.jpg)

我们可以从**视图 > 创建视图**（在文档库视图的右上角）创建一个自定义视图。我创建了一个新的标准视图并将其命名为“Chromed View”。我对其进行了编辑，然后我看到此视图仅适用于当前文档库：

![替代文字](https://i592.photobucket.com/albums/tt5/astri_kusumawardani/crm/docLib_chromedView_500.jpg)

其他文档库无法使用此视图。

我开发了一个从 CRM 触发文档库创建的系统（来自 CRM Iframe 的文档库视图正在使用该镀铬视图）。创建本身很顺利，我可以使用 Sharepoint Web 服务创建文档库。但我仍然无法为新创建的文档库自动应用自定义视图。

我的问题是，我们能否制作一个全局视图（不仅在一个文档库中），以便我们可以将该全局视图用于任何文档库。

感谢b4的任何意见:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T08:07:10.513

您还可以创建一个新的自定义文档库类型，其中嵌入了视图。每当从新的 doc lib 类型创建新库时，它将获得新视图。

这仍然不是真正的“全局”视图，如果视图发生更改，您可能会遇到同样的问题（视图不会在使用以前版本的视图创建的文档库上更新）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T06:09:12.497

一种方法是使用事件接收器创建功能。当用户创建列表时，您可以检查列表是否属于正确的类型 (101)，然后向其中添加新视图。该功能还可以在激活时将此视图添加到现有文档库中。不应该太费力。这种观点并不是真正的全球性的。由于每个实例的列表定义都是重复的，因此 WSS 中没有全局视图 (afaik) 这样的东西。我们都希望视图在下一个版本中成为内容类型的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T13:50:56.690

要全局更改所有文档库并更改所有现有库，您需要编辑位于 layouts/templates 中 XSL 文件夹中的 XSLT 文件

那里有几个，但这些是所有库的生成方式，你基本上可以指定默认“”库的外观。不过，请确保为这些文件进行备份。同样创建一个新的内容类型并将这些 xlts 复制到不同的文件名，然后将您的内容类型链接到这些也可能是一种解决方案，因此当用户使用您的内容类型创建新库时，您可以确保它们是在一种你想要的方式。

# c# - 如何使用 System.Net.Mail 向电子邮件添加附件？

> ID：527214
> 
> 赞同：21
> 
> 时间：2009-02-09T05:56:36.317
> 
> 标签：c#, email, binary, attachment, system.net.mail

我有一个表示为 byte[] 的 excel 文档，我想将它作为电子邮件的附件发送。

我在构建附件时遇到了一些麻烦。

我可以创建一个具有以下构造函数的附件：

```
(Stream contentStream, ContentType contentType)
(Stream contentStream, string name)
(Stream contentStream, string name, string mediaType) 
```

我目前的想法是从 byte[] 创建一个 MemoryStream 并将其传递给创建附件的方法。

不幸的是，我看不到从 MemoryStream 获取预期文件名和内容类型的方法，我也看不到如何提供正确的内容类型。有纯文本、Pdf、Rtf 等选项，但没有一个我可以立即跳出来作为我应该用于 Excel 文档的选项。

我能找到的最接近的是[MediaTypeNames.Application.Octet](http://msdn.microsoft.com/en-us/library/system.net.mime.mediatypenames.application.octet.aspx)，它指出：

> Octet 成员指定附件包含通用二进制数据。

但是，即使这是要使用的，除非它可以作为 Stream 的属性传递，否则我发送电子邮件的方法将只能将 byte[] 作为 Excel 文档发送......

是否有其他类型的 Stream 我可以使用？或者我是否必须创建自己的 Stream 类型，其中包含我需要的详细信息。

肯定有人以前做过这件事，而且微软肯定会考虑到这个程度......

任何帮助将非常感激。

**更新：** 请不要投票给任何使用将文件名作为字符串的构造函数的答案。我真的需要帮助使用带流的那些......我想避免将文件写入磁盘，通过电子邮件发送，然后立即删除它。因为有一种方法可以让我做到这一点，所以我想尽可能使用那个方法。

**解决方案更新**

康拉德设法找到了我要找的东西！谢谢大佬！

我将仅记录建议的解决方案，以防提供的链接中的内容发生问题。

此解决方案的[功劳归于 www.systemnetmail.com](http://www.systemnetmail.com/faq/3.4.2.aspx)

```
static void AttachmentFromStream()
{

//create the mail message
MailMessage mail = new MailMessage();

//set the addresses
mail.From = new MailAddress("me@mycompany.com");
mail.To.Add("you@yourcompany.com");

//set the content
mail.Subject = "This is an email";
mail.Body = "this content is in the body";

//Get some binary data
byte[] data = GetData();

//save the data to a memory stream
MemoryStream ms = new MemoryStream(data);

//create the attachment from a stream. Be sure to name the data 
//with a file and 
//media type that is respective of the data
mail.Attachments.Add( new Attachment( ms, "example.txt", "text/plain" ));

SmtpClient smtp = new SmtpClient("127.0.0.1");
smtp.Send(mail);
} 
```

就我而言，这只是意味着我必须更改我的方法以将文件名和文件格式作为字符串。我会尝试使用 Octet 的……但如果失败了，我只会传入官方的 MIME 类型。

考虑到所有因素，这是一个非常明显的解决方案……但我确实感谢解决它的帮助……而且好消息是这个解决方案将记录在案，以供未来遇到同样问题的程序员使用。

再次感谢大家的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T07:01:36.613

附件构造函数确实有一个构造函数可以满足您的需要。我假设您正在使用 .NET Framework 2 中的 System.Net.MailMessage 类。如果是这样，[请阅读此链接](http://www.systemnetmail.com/faq/3.4.2.aspx)以获取您需要的一些示例代码

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-07-24T17:47:15.143

由于已接受答案的链接[消失](https://stackoverflow.com/a/527309/1037948)[了](http://www.systemnetmail.com/faq/3.4.2.aspx)，这里是来自[Wayback Machine](https://web.archive.org/web/20161231192915/http://www.systemnetmail.com/faq/3.4.2.aspx)

**TL;博士：** `mail.Attachments.Add(new Attachment(contentStream, "yourfilename.txt", "text/plain"));`

**满的：**

```
static void AttachmentFromStream()
{

    //create the mail message
    MailMessage mail = new MailMessage();

    //set the addresses
    mail.From = new MailAddress("me@mycompany.com");
    mail.To.Add("you@yourcompany.com");

    //set the content
    mail.Subject = "This is an email";
    mail.Body = "this content is in the body";

    //Get some binary data
    byte[] data = GetData();

    //save the data to a memory stream
    MemoryStream ms = new MemoryStream(data);

    //create the attachment from a stream. Be sure to name the data with a file and 
    //media type that is respective of the data
    mail.Attachments.Add(new Attachment(ms, "example.txt", "text/plain"));

    //send the message
    SmtpClient smtp = new SmtpClient("127.0.0.1");
    smtp.Send(mail);
}
static byte[] GetData()
{
    //this method just returns some binary data.
    //it could come from anywhere, such as Sql Server
    string s = "this is some text";
    byte[] data = Encoding.ASCII.GetBytes(s);
    return data;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-03T15:07:05.923

从 Microsoft 文档中得到了这个答案：

```
public static void CreateMessageWithAttachment(string server)
{
    // Specify the file to be attached and sent.
    // This example assumes that a file named Data.xls exists in the
    // current working directory.
    string file = "data.xls";
    // Create a message and set up the recipients.
    MailMessage message = new MailMessage(
        "jane@contoso.com",
        "ben@contoso.com",
        "Quarterly data report.",
        "See the attached spreadsheet.");

    // Create  the file attachment for this email message.
    Attachment data = new Attachment(file, MediaTypeNames.Application.Octet);
    // Add time stamp information for the file.
    ContentDisposition disposition = data.ContentDisposition;
    disposition.CreationDate = System.IO.File.GetCreationTime(file);
    disposition.ModificationDate = System.IO.File.GetLastWriteTime(file);
    disposition.ReadDate = System.IO.File.GetLastAccessTime(file);
    // Add the file attachment to this email message.
    message.Attachments.Add(data);

    //Send the message.
    SmtpClient client = new SmtpClient(server);
    // Add credentials if the SMTP server requires them.
    client.Credentials = CredentialCache.DefaultNetworkCredentials;

    try
    {
        client.Send(message);
    }
    catch (Exception ex)
    {
        Console.WriteLine("Exception caught in CreateMessageWithAttachment(): {0}",
            ex.ToString());
    }
    // Display the values in the ContentDisposition for the attachment.
    ContentDisposition cd = data.ContentDisposition;
    Console.WriteLine("Content disposition");
    Console.WriteLine(cd.ToString());
    Console.WriteLine("File {0}", cd.FileName);
    Console.WriteLine("Size {0}", cd.Size);
    Console.WriteLine("Creation {0}", cd.CreationDate);
    Console.WriteLine("Modification {0}", cd.ModificationDate);
    Console.WriteLine("Read {0}", cd.ReadDate);
    Console.WriteLine("Inline {0}", cd.Inline);
    Console.WriteLine("Parameters: {0}", cd.Parameters.Count);
    foreach (DictionaryEntry d in cd.Parameters)
    {
        Console.WriteLine("{0} = {1}", d.Key, d.Value);
    }
    data.Dispose();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T06:05:06.890

--------------- 我想我错了，这是如果你有一个文件要附加 ---------------

看起来这里有一个发送带有附件的邮件的示例：

[http://www.aspnettutorials.com/tutorials/email/email-attach-aspnet2-csharp.aspx](http://www.aspnettutorials.com/tutorials/email/email-attach-aspnet2-csharp.aspx)

我希望这就是你要找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T06:56:58.963

Attachment 构造函数中的 name 参数是将在收件人电子邮件中显示的附件名称。

因此，您可以自由选择名称参数（首选扩展名为 .xls），并将 mediaType 参数设置为“application/vnd.ms-excel”，这是为 excel 文件定义的[MIME 类型](http://www.w3schools.com/media/media_mimeref.asp)。

# c# - 如何将 const int * const buffer[] 导入 C#？

> ID：527215
> 
> 赞同：0
> 
> 时间：2009-02-09T05:56:51.200
> 
> 标签：c#, pointers, pinvoke

这对我来说很棘手。

```
const int * const buffer[] 
```

目前，我将其翻译如下：

```
byte[] buffer 
```

问题是当 DLL 使用上述参数调用函数时，我遇到了 AccessViolation 异常。

感谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T06:05:30.663

有了**两个** `const`肯定应该足以表明您不允许更改它:-)。但是，严肃地说，其中一种状态是指针不应该改变，另一种状态是指针指向的数据不应该改变。

这就是您遇到访问冲突的原因。

您需要做的是将数据**复制**（而不仅仅是强制转换）到另一个缓冲区，该缓冲区的 const 稍微少一些。提示：Buffer.BlockCopy 是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T06:29:22.510

不是`sizeof(int) > sizeof(byte)`吗？如果是这样，那么您肯定会遇到问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T08:53:50.180

const 修饰符不会影响 PInvoke 签名，尽管它们可能会影响您处理数据的方式。由于 buffer 参数是一个指向整数的指针数组，因此正确的翻译应该是：

```
IntPtr[] buffer; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T15:23:22.833

编辑：它现在可以工作，没有 AccessViolation 异常，但我不知道如何从这样的数组中正确检索数据。

示例文件正在使用这种类型的访问：

```
buffer[0][i]
buffer[1][i] 
```

但我在缓冲区 [] 中只有 1 个指针。该指针是指向二维数组的指针吗？然后如何将其编组到.NET？谢谢！

# android - 如何在android中以编程方式删除联系人

> ID：527216
> 
> 赞同：27
> 
> 时间：2009-02-09T06:01:33.700
> 
> 标签：android, android-contacts, android-contentresolver

我尝试使用以下代码删除具有指定号码的联系人：

```
private void removeContact(Context context, String phone) {
    //context.getContentResolver().delete(Contacts.Phones.CONTENT_URI, phone, null);
    context.getContentResolver().delete(Contacts.Phones.CONTENT_URI,
          Contacts.PhonesColumns.NUMBER+"=?", new String[] {phone});
} 
```

但我得到了这个例外：

```
java.lang.UnsupportedOperationException: Cannot delete that URL: content://contacts/phones
    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:130)
    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:110)
    at android.content.ContentProviderProxy.delete(ContentProviderNative.java:362)
    at android.content.ContentResolver.delete(ContentResolver.java:386) 
```

你能告诉我如何解决我的问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-11-22T10:59:49.783

要删除所有联系人，请使用以下代码：

```
ContentResolver cr = getContentResolver();
    Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI,
            null, null, null, null);
    while (cur.moveToNext()) {
        try{
            String lookupKey = cur.getString(cur.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY));
            Uri uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_LOOKUP_URI, lookupKey);
            System.out.println("The uri is " + uri.toString());
            cr.delete(uri, null, null);
        }
        catch(Exception e)
        {
            System.out.println(e.getStackTrace());
        }
    } 
```

要删除任何特定联系人，请修改查询

```
cr.delete(uri, null, null); 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-04-07T22:09:29.890

这就是我们所需要的。删除带有电话号码和姓名的联系人

```
public static boolean deleteContact(Context ctx, String phone, String name) {
    Uri contactUri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(phone));
    Cursor cur = ctx.getContentResolver().query(contactUri, null, null, null, null);
    try {
        if (cur.moveToFirst()) {
            do {
                if (cur.getString(cur.getColumnIndex(PhoneLookup.DISPLAY_NAME)).equalsIgnoreCase(name)) {
                    String lookupKey = cur.getString(cur.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY));
                    Uri uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_LOOKUP_URI, lookupKey);
                    ctx.getContentResolver().delete(uri, null, null);
                    return true;
                }

            } while (cur.moveToNext());
        }

    } catch (Exception e) {
        System.out.println(e.getStackTrace());
    } finally {
        cur.close();
    }
    return false;
} 
```

并提醒添加读/写联系人权限

```
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" /> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-09T08:59:41.150

您是否在清单中声明了适当的权限？

在 Android 让你弄乱联系人提供程序之前，你需要`android.permission.READ_CONTACTS`和uses-permission 标签：`android.permission.WRITE_CONTACTS`

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.android.app.myapp" >

  <uses-permission android:name="android.permission.READ_CONTACTS" />
  <uses-permission android:name="android.permission.WRITE_CONTACTS" />

</manifest> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-25T17:51:46.163

一个迟到的答案，但无论如何它可能会有所帮助：

如果您查看[ContactsProvider 的源代码](http://github.com/android/platform_packages_providers_contactsprovider/raw/d463e03b381c5e45cecc30074cea24d93d90e8a6/src/com/android/providers/contacts/ContactsProvider.java)并搜索“matcher.addURI”（*如果它在中间停止加载，请不要感到惊讶......它会在一两分钟后恢复加载*），然后您会看到它有一个它可以处理的有限 URI 方案集。它有一个“phones/#”的处理程序，但没有“phones”的处理程序，这是你需要的。

这意味着，没有删除所有电话号码的代码，您必须先获取所有号码的 ID，然后一次删除每个号码。当然，这需要更多的 CPU 和内存资源，但至少它可以工作。

下面的代码删除了一个特定的数字。请注意，我没有测试此代码，但它与我用来删除给定人员的所有号码的代码有 90% 相同，这需要类似的处理，因为 Android 无法删除“people/#/phones”但“人/#/电话/#"

**编辑：** *我刚刚意识到我误解了这个问题。我以为你想删除我的代码所做的电话号码。但现在我看到你想删除联系人。*

```
private void deletePhoneNumber(Uri peopleUri, String numberToDelete) {

    Uri.Builder builder = peopleUri.buildUpon();
    builder.appendEncodedPath(People.Phones.CONTENT_DIRECTORY);
    Uri phoneNumbersUri = builder.build();

    String[] mPhoneNumberProjection = { People.Phones._ID, People.Phones.NUMBER };
    Cursor cur = resolver.query(phoneNumbersUri, mPhoneNumberProjection,
            null, null, null);

    ArrayList<String> idsToDelete = new ArrayList<String>();

    if (cur.moveToFirst()) {
        final int colId = cur.getColumnIndex(People.Phones._ID);
        final int colNumber = cur.getColumnIndex(People.Phones.NUMBER);

        do {
            String id = cur.getString(colId);
            String number = cur.getString(colNumber);
            if(number.equals(numberToDelete))
                idsToDelete.add(id);
        } while (cur.moveToNext());
    }
    cur.close();

    for (String id : idsToDelete) {
        builder.encodedPath(People.Phones.CONTENT_DIRECTORY + "/" + id);
        phoneNumbersUri = builder.build();
        resolver.delete(phoneNumbersUri, "1 = 1", null);
    }
} 
```

代码有点冗长，因为它做了两个假设：

*   可能有多行要删除（例如，数字被存储两次）
*   获取游标、删除行并继续使用游标可能不安全

这两个假设都是通过首先存储`idsToDelete`在一个中`ArrayList`然后删除来处理的。

您也可以考虑规范化您搜索的数字，并改用 Column `People.Phones.NUMBER_KEY`，因为它包含规范化形式的数字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-23T10:57:04.870

删除联系人的更好方法是使用联系人 ID 删除所有原始联系人

```
 final ArrayList ops = new ArrayList();
    final ContentResolver cr = getContentResolver();
    ops.add(ContentProviderOperation
            .newDelete(ContactsContract.RawContacts.CONTENT_URI)
            .withSelection(
                    ContactsContract.RawContacts.CONTACT_ID
                            + " = ?",
                    new String[] { allId.get(i) })
            .build());

        try {
            cr.applyBatch(ContactsContract.AUTHORITY, ops);
            int deletecontact = serialList.get(allId.get(i));

        } catch (RemoteException e) {
            e.printStackTrace();
        } catch (OperationApplicationException e) {
            e.printStackTrace();
        }
        //background_process();
        ops.clear();
    } 
```

并且不要忘记添加权限

```
 <uses-permission android:name="android.permission.READ_CONTACTS"/>
        <uses-permission android:name="android.permission.WRITE_CONTACTS"/> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-23T14:01:47.400

此代码非常适合我从其标识符中删除联系人（**ContactsContract.Contacts._ID**）

必须单独删除该联系人所有号码的电话注册

```
 fun deleteContactById(id: String) {
      val cr = context.contentResolver
      val cur = cr.query(ContactsContract.Contacts.CONTENT_URI,
                    null, null, null, null)
      cur?.let {
          try {
                    if (it.moveToFirst()) {
                        do {
                            if (cur.getString(cur.getColumnIndex(ContactsContract.PhoneLookup._ID)) == id) {
                                val lookupKey = cur.getString(cur.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY))
                                val uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_LOOKUP_URI, lookupKey)
                                cr.delete(uri, null, null)
                                break
                            }

                        } while (it.moveToNext())
                    }

                } catch (e: Exception) {
                    println(e.stackTrace)
                } finally {
                    it.close()
                }
            }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-07T11:26:25.783

```
ContentResolver cr = getContentResolver();
Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI,
        null, null, null, null);
while (cur.moveToNext()) {
    try{
        String lookupKey = cur.getString(cur.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY));
        Uri uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_LOOKUP_URI, lookupKey);
        System.out.println("The uri is " + uri.toString());
        cr.delete(uri, null, null);
    }
    catch(Exception e)
    {
        System.out.println(e.getStackTrace());
    }
} 
```

我已使用此代码删除联系人。它将删除 sim 联系人以及手机联系人或仅存储在手机存储中的联系人。

# deployment - 我应该在哪里部署我的应用程序？

> ID：527218
> 
> 赞同：2
> 
> 时间：2009-02-09T06:03:18.813
> 
> 标签：deployment, installation, uac

在 Windows Vista（2008 和 7）下，应用程序无法写入 Program Files 文件夹。我知道 UAC 是负责任的，但它会阻止我的应用程序自我更新。是否有某个文件夹（在 Windows XP、Vista（和所有其他版本）中可用）允许我部署我的应用程序并让它自我更新而不必使其“*提升*”？

我想到了 ClickOnce，但我不能使用，因为我不想支付昂贵的证书（签署代码、安装程序等）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T06:37:16.937

无论如何，您可能应该在更新应用程序之前征求许可。尝试写入`C:\Program Files`本质上是用户应授权的危险操作。所以我只想告诉用户你在做什么，让她允许更新程序完成它的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T08:07:08.513

我个人厌恶这个想法，但有几个应用程序走上了这条路：不是将应用程序安装到 Program Files 目录中，而是安装到 AppData 目录中。

我首先在 Microsoft 的 SyncToy PowerToy 中看到了这一点，然后是在巫妖王之怒发布之前的魔兽世界补丁集。最近，我看到 Google Chrome 也安装到了 AppData 目录中。

我讨厌这个想法的原因是，为了不得到安装或修补提示的小方便，我现在有潜在的恶意软件悄悄修改和安装到 AppData 中的应用程序的二进制文件的风险。

# apache-flex - 将 flex 与 struts 一起使用

> ID：527225
> 
> 赞同：2
> 
> 时间：2009-02-09T06:08:29.330
> 
> 标签：apache-flex, struts

我管理着一个旧的（大约 5 年）企业应用程序。最近，我们开始使用 flex 来美化 UI。请记住，我们想在 struts 中使用当前代码库（这是一个相当大的应用程序），正如我所见，我有三个选择：

1.  [Flex BlazeDS](http://opensource.adobe.com/wiki/display/blazeds/BlazeDS/)
2.  [弹性标签库](http://labs.adobe.com/wiki/index.php/Flex_2_Tag_Library_for_JSP)
3.  [FxStruts](http://code.google.com/p/fxstruts/)

BlazeDS 是一个开源且非常有效的选择，当我们的整个应用程序都处于 flex 状态并且我们使用后端应用程序只是为了提供服务时。但是由于应用程序很大，因此很难将所有内容都转换为 flex。

Flex Tag Library 也是一个开源的，但只是为 Flex 2 开发的，没有为 Flex 3 提供升级。如果使用不当（或者我读过），它也会产生一些性能问题

FxStruts 也是开源的，可以与任何 flex 版本一起使用。最大的优势是我们不必更改我们的服务器部分，我们仍然可以使用丰富的 flex UI，并且我们仍然可以为可能不使用 flex 的外部客户端维护我们的传统 UI。它基本上是一个组合 flex http 服务和 blazeds 序列化。

哪一个可能更好？还有其他方法吗？最终，我们也希望转向 spring/mvc 或其他框架。我不想因为在这里做出错误的选择而被咬。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T10:33:59.240

使用 BlazeDS，您可以通过在服务器上配置一个 xml 文件轻松地将现有的 java 服务公开给 Flex 客户端。您可以通过 RMI 和 JMS 发送和接收强类型对象（从 ActionsScript 到 Java，反之亦然）。只需确保您的 AS 和 Java 类具有相同的属性名称和类型，在客户端上注册一个类别名，Flash Player 将完成剩下的工作。

假设您使用的是 Spring，当您使用[Spring BlazeDS Integration](http://blog.springsource.com/2008/12/17/using-spring-blazeds-integration-m1/)时，使用 Flex 和 BlazeDS 会更加简单。

您还可以在 Flex 客户端中使用[Spring ActionScript](http://www.pranaframework.org)框架进行依赖注入和 MVCS 架构。更多信息：[http](http://www.herrodius.com/blog/160) ://www.herrodius.com/blog/160 （无耻插件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-10T01:49:27.933

这取决于您的服务器端实现是什么。如果您有一个 Struts 实现，我不会冒险重新实现它，因为迁移到 Flex 将通过切换传统 MVC 中的视图来改善用户体验。由于 struts 是一个 MVC 框架，您可以轻松地将视图替换为 Flex。有关使用 maven 作为构建工具和 XSL 结果类型在 Struts 2.0 框架中集成 flex、Struts 2.0 的信息，请参阅此博客文章。

[Flex 与 Struts 2.0 的集成](http://javaarch.blogspot.com/2009/08/adobe-flex-programming-with-struts-20.html)

希望这可以帮助。

谢谢

克里希纳

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T09:54:36.183

我想你想在你现有的应用程序中使用 Flex 作为 UI。

自去年 1.5 年以来，我一直在从事 flex 工作，根据我迄今为止的经验，我可以给 ua 建议以继续使用 BlazeDs。您不需要将您的整个应用程序转换为 flex。您仍然可以将您的 html/JSP 部分与 flex 一起保留。

可能您可以在 flex 中使用 Cairngorm 框架作为其在 Flex 中的 MVC 实现。如果您只将“视图”部分切换到 Flex，您将不会发现更多困难。

建议：尝试[merapi](http://www.merapiproject.net/)在 java n flex 之间的一个很酷的接口

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T12:51:48.557

使用 Flex-BlazeDS 选项。通过删除 Action servlet、action 类和 JSP 来简化体系结构，这些 JSP 使用一个简单的 POJO 返回演示文稿，该 POJO 只返回要在您决定转换为 Flex 的 Wen 页面中显示的数据（不必全部-or-nothing - 您可以保留我们现在的大部分应用程序，逐渐将 Flex 部分引入其中）。

需要注意的事项：

1.  可扩展性。如果您的应用程序有超过 500 个并发用户，您将需要进行一些高级编码以保持服务器正常运行。

2.  考虑更改应用程序设计，以将您将在 Flex 中重写的所有部分的状态保留在客户端上。

3.  想想在旧 (JSP) 和新 (Flex-BlazeDS) 模块之间交换服务器端用户会话信息的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-23T16:30:20.727

Adobe flex 与 struts2 动作（JSON）集成。

例子在[这里](http://www.kidslovepc.com/j2ee_bbs/viewforum.php?f=7)

# php - 帮助在 php 中使用 xmlreader 读取嵌套的 xml

> ID：527230
> 
> 赞同：1
> 
> 时间：2009-02-09T06:15:23.243
> 
> 标签：php, xmlreader

```
<root>
  <thing>
    <specs>
      <spec1 />
      <spec3 />
      <spec2 />
    </specs>
    <details />
    <more_info>
      <info1 />
      <info2 />
    </more_info>
  </thing>
</root> 
```

okeee 所以我得到了这个示例 xml，问题是我似乎无法获取 innerxml 的值，
当我使用`$reader->readInnerXML()`它时，它返回整个字符串，尽管我确定我的 xml 是有效
的我想要的是获取 spec1、spec2 的值, spec3 分开

代码很长，所以我把它贴在[这里](http://pastebin.com/f48b9bd38)
我已经坚持了 3 天了 T_T 可怜的我，我很乐意接受任何更正

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T18:00:33.907

这取决于您所说的“价值”。如果你有类似的东西

```
<spec3 />Value</spec3> 
```

那么 readInnerXML 应该会给你你的价值。

如果您的值在属性中，

```
<spec1 foo="my attribute" /> 
```

您需要使用 XMLReader 对象的 getAttribute 方法，或者明确告诉读者开始解析属性。请参阅下面的代码示例，了解实现此目的的几种方法。

最后，如果节点包含更多嵌套的 XML，

```
<spec2><foo><baz thing="la de da">Value</baz></foo></spec2> 
```

在那一刻，读者没有直接的方法来理解其中的价值/元素。您需要执行以下操作之一

1.  更改您的阅读器解析代码以挂钩那些深度的元素
2.  从 readInnerXML 中获取 XML 块并使用第二个 XMLReader 实例开始解析它，
3.  从 readInnerXML 中获取 XML 块并开始使用另一个 XML 解析库对其进行解析。

这是一些用于解析属性的示例代码

```
$reader = new XMLReader();
$reader->xml(trim('
<root>
  <thing>
    <specs>
      <spec1 foo="my attribute">Value</spec1>
      <spec3>
      My Text
      </spec3>
      <spec2 foo="foo again" bar="another attribute" baz="yet another attribute" />
    </specs>
    <details />
    <more_info>
      <info1 />
      <info2 />
    </more_info>
  </thing>
</root> 
'));

$last_node_at_depth = array();
$already_processed  = array();
while($reader->read()){
    $last_node_at_depth[$reader->depth] = $reader->localName;
    if(
    $reader->depth > 0 && 
    $reader->localName != '#text' &&   
    $last_node_at_depth[($reader->depth-1)] == 'specs' &&
    !in_array ($reader->localName,$already_processed)
    ){          
        echo "\n".'Processing ' . $reader->localName . "\n";
        $already_processed[] = $reader->localName;
        echo '--------------------------------------------------'."\n";
        echo 'The Value for the inner node ';           
        echo ' is [';
        echo trim($reader->readInnerXML());
        echo ']'."\n";

        if($reader->attributeCount > 0){
            echo 'This node has attributes, lets process them' . "\n";

            //grab attribute by name
            echo '    Value of attribute foo: ' . $reader->getAttribute('foo') . "\n";

            //or use the reader to itterate through all the attributes
            $length = $reader->attributeCount;
            for($i=0;$i<$length;$i++){
                //now the reader is pointing at attributes instead of nodes
                $reader->moveToAttributeNo($i);
                echo '    Value of attribute ' . $reader->localName;
                echo ': ';
                echo $reader->value;
                echo "\n";
            }
        }
        //echo $reader->localName . "\n";        
    }        
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T09:29:31.250

这[就像宣传](http://www.php.net/manual/en/xmlreader.readinnerxml.php)的那样工作：

> **读取InnerXML**
> 
> 读取当前节点的内容，包括子节点和标记。

我认为您的混淆可能在节点和属性之间。`<spec1 />`不是属性 - 它是一个没有任何子节点的节点。写作`<spec1 />`只是`<spec1></spec1>`. 所以你需要的是使用实际属性：

```
<root>
  <thing>
    <specs spec1="" spec3="" spec2="" />
    <details />
    <more_info info1="" info2="" />
  </thing>
</root> 
```

或读取这些节点。

反正。我不确定这是否只是因为您向我们展示了一些示例代码，但是命名节点`spec1`，`spec2`等`spec3`可能不是一个好主意。节点名称在 XML 中不需要是唯一的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T11:08:27.270

不确定这是否是您要问的，但 simplexml 可用于读取 xml 数据（每个元素的值，而不是属性）。对于您的事物/规格示例，请执行以下操作：

```
$xmlobj = simplexml_load_file($xmlfile);
$extracteddata = $xmlobj->thing->specs->spec1; 
```

会给你 spec1 元素的内容。

例如：如果元素是`<spec1>1234</spec1>`上面的代码将返回“1234”

# rdbms - 在数据库表中，主键的最大数量是多少？

> ID：527234
> 
> 赞同：0
> 
> 时间：2009-02-09T06:17:12.710
> 
> 标签：rdbms

在数据库表中，主键的最大数量是多少？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T06:20:16.167

您只有一个主键（或者可能没有，尽管这会使各种事情变得棘手），但该键*可以*包含多于一列。

就个人而言，我发现复合主键（具有多列的主键）在我使用它们时一直很痛苦，但这可能是由于我的无能。即便如此，在某些情况下，使用复合键是合乎逻辑的，我可能不会更改设计。（我认为这更像是 Hibernate 在当时与复合键一起使用时稍微棘手的情况。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T07:15:33.850

在数据库理论中，表上最关键的约束称为*候选键*。候选键的列中的值唯一地确定存储在表的一行中的其他列中的值——这是一个*函数依赖*，也是规范化理论的一个关键方面。（严格来说，*连接依赖*是关键；功能依赖是连接依赖的一种特殊情况。）一个表可能有多个候选键。在这些候选键中，最多可以指定一个作为“主键”；其他的成为“备用”键（但由于某种原因，不是“辅助键”，尽管这对它们来说似乎是一个明显的名称）。

我最喜欢的多个候选键的说明是来自化学和物理的“[元素表](http://www.webelements.com/)”（它被称为“表”这一事实很好）：

```
CREATE TABLE elements
(
    atomic_number   INTEGER NOT NULL UNIQUE
                    CHECK (atomic_number > 0 AND atomic_number < 120),
    symbol          CHAR(3) NOT NULL UNIQUE,
    name            CHAR(20) NOT NULL UNIQUE,
    atomic_weight   DECIMAL(8,4) NOT NULL,
    stable          CHAR(1) DEFAULT 'Y' NOT NULL
                    CHECK (stable IN ('Y', 'N'))
); 
```

它有 3 个候选键 - 原子序数、符号和名称（根据经验，您可能会使用原子量作为第四个键，但它与其他三个键不同）。其中任何一个都可以指定为主键，但通常会使用原子序数或符号。其中哪一个是首选在很大程度上取决于您是在处理化学（在这种情况下，符号是毫无疑问的赢家）还是（亚）核物理，在这种情况下，原子序数可能更重要。您的辅助表就像[同位素表](http://ie.lbl.gov/education/isotopes.htm)将交叉引用原子序数；您与化合物相关的辅助表更有可能交叉引用该符号。（顺便说一句，你知道原子序数超过 100 的“尚未分离”的元素有 3 个字符的缩写吗？）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T06:21:47.160

好吧，如果您要问可以*组成主键的最大**列数是多少*，对于 SQL Server，它是 16。

 *参考：[SQL Server 的最大容量规范](http://msdn.microsoft.com/en-us/library/ms143432.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-23T18:08:47.243

只有一个主键，因为关系数据库是 Edgar Codd 的 12 条关系模型规则的软件表达式，一组 13 条规则在数学上保证完整性、一致性和原子性，因此具有多个主键的对象不是一个数据库表，因为它违反了 codd 的规则。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T06:19:00.553

你只能拥有一个。它必须位于一个或多个不能接受 NUL 的列上，并且该列（或列的组合）必须是唯一的。

您可以拥有一列或多列的其他唯一索引，但不能将它们指定为 PK。（但他们的行为将与他们的行为相同，所以说你只能拥有一个只是语义。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T07:23:14.347

我认为 Madheena 可能实际上想知道使用自动递增主键的表可以有多少行......如果是这样，这取决于您使用的 DBMS 以及您如何创建表（哪种数据类型主键是），所以你必须在你的解释中更详细。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T06:20:20.923

您最多只能有 1 个主键，但它可以是复合的（该键中有多个列）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T06:20:48.113

主键始终是一个表。主要可以是单列或多列的组合，它们唯一地表示每一行。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T08:12:03.510

一张表只能定义一个主键。

表可以容纳的行数/记录数取决于跨越您的 PK 的列数，以及为这些列选择的数据类型。此外，您使用的 RDBMS 也很重要，因为 DBMS 定义了数据类型的大小。

例如，具有一个整数列作为主键的 SQL Server 表可以包含 4,294,967,295 条记录（PK 值从 -2,147,483,648 到 2,147,483,647）。

# django - Flup 中未处理的异常

> ID：527237
> 
> 赞同：6
> 
> 时间：2009-02-09T06:19:05.077
> 
> 标签：django, error-handling, middleware, fastcgi, flup

我正面临着 Flup 提出的可怕的“未处理异常”。可悲的是它是在网络服务器（lighttpd+flup）级别而不是在应用程序级别（Django）提出的。因此，不会就问题所在提出 500 封电子邮件。

我们整个团队都在努力清理代码库，以防有任何模棱两可的导入和类似的情况，只是为了消除由于模棱两可的导入而引发错误的机会。我们清理了代码中的许多内容。还是一样的例外。

坦率地说，我对 Flup 的错误处理感到非常沮丧。它什么也没告诉你。最糟糕的是，它向用户显示相同的“未处理异常”。我如何通过这个？

我检查了 lighttpd 日志。我所看到的只是“接口错误/连接已关闭”。它仅在我的应用程序在 FCGI 模式下运行时发生。所以问题在于flup实际上是如何处理我的代码（应用程序）的。我如何通过这个？

我检查了flup的替代方案，但Django明确地依赖flup（这是另一个限制，让我感到困惑）（参考：django_src/django/core/servers/fastcgi.py line:100 / 131）

我如何调试（至少）这种情况并解决问题？请帮帮我。该应用程序已关闭 3 天。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T15:26:13.747

这表明在 Django 开始处理请求之前就出现了错误，例如设置模块中的语法错误。调试此类问题的最快方法是打开 FastCGI 调试。这是第 128 行`django/core/servers/fastcgi.py`：

```
wsgi_opts['debug'] = False # Turn off flup tracebacks 
```

然后使用经过修改的 Django 运行应用程序，您将看到 Flup 回溯的全部荣耀。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-07T22:58:55.470

我遇到了类似的事情——我们让 Django 支持 NGINX，我们允许 Django 处理 500 次——这在 99.9% 的时间里都有效，但是当我们进行升级时，有时这些“未处理的异常”会漏掉。

Django 不会覆盖 Flup 的处理错误的钩子，所以我们需要自己做，让 Django 处理这些错误。

[`flup.server.BaseFCGIServer.error`](http://trac.saddi.com/flup/browser/flup/server/fcgi_base.py#L1210)首先通过 Django覆盖错误。然后我们将告诉 Django 使用我们的修改`BaseFCGIServer`来查看这些错误。

由于 Python 非常棒，我们将作弊并在一个地方对整个事情进行猴子补丁，[`django.core.servers.fastcgi.py`](http://code.djangoproject.com/browser/django/trunk/django/core/servers/fastcgi.py). 开始了：

```
# django.core.servers.fastcgi.py

def runfastcgi(argset=[], **kwargs):
    # ...

    # Paste his hack right after the `module` try/catch.

    # Override BaseFCGIServer.error to use Django error handling.
    # http://trac.saddi.com/flup/browser/flup/server/fcgi_base.py#L1210
    def patch_error(self, req):
        import sys
        from django.conf import settings
        from django.core import urlresolvers
        from django.core.handlers.wsgi import WSGIRequest

        urlconf = settings.ROOT_URLCONF
        urlresolvers.set_urlconf(urlconf)
        resolver = urlresolvers.RegexURLResolver(r'^/', urlconf)

        # No access to 'environ' so rebuild WSGIRequest.
        # http://trac.saddi.com/flup/browser/flup/server/fcgi_base.py#L1077
        environ = req.params
        environ.update(self.environ)
        environ['wsgi.version'] = (1,0)
        environ['wsgi.input'] = req.stdin
        self._sanitizeEnv(environ)        
        wsgireq = WSGIRequest(environ)

        # http://code.djangoproject.com/browser/django/trunk/django/core/handlers/base.py#L177    
        response = self.application.handle_uncaught_exception(wsgireq, resolver, sys.exc_info())

        # TODO: NGINX figures this out, but other servers might not.
        # http://trac.saddi.com/flup/browser/flup/server/fcgi_base.py#L1104
        req.stdout.write('Status: 500\r\n')
        req.stdout.write('Content-Type: text/html\r\n\r\n' + response.content)    

    WSGIServer.error = patch_error 
```

现在你可以享受 Django 堆栈跟踪，即使是 Flup 级别的错误！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T08:30:03.123

我不使用 lighttpd 或 Flup，所以这不是一个答案，而是提示。

我首先尝试在您的应用程序文件中运行 PDB，或者至少在您调用 Flup 服务器 .run() 方法之前写入日志文件。这样您就可以将问题识别为 fastcgi 或 Flup 中的问题。请参阅mod_wsgi wiki 中名为[Python 交互式调试器的部分。](http://code.google.com/p/modwsgi/wiki/DebuggingTechniques)这可能会给你一些想法，让你知道如何用 lighttpd 和 Flup 做同样的事情。

然后，如果问题是 Flup，您将在 pdb 中捕获异常并可以从那里进行调试。

如果问题是 lighttpd，那么您的配置文件中可能存在某种问题，或者可能是 lighttpd 的构建方式存在问题。也许 lighttp 和它的 fastcgi 模块之间存在系统库不匹配？

尝试在 nginx+fastcgi 下运行你的应用程序，看看它是否有效，或者至少会给你更好的错误消息。

顺便说一句，flup 的作者[讨厌 FCGI，甚至不再使用 flup](http://www.saddi.com/software/news/archives/58-flup-1.0-released.html) ... 我建议切换到 nginx 或 apache+mod_wsgi。

# data-structures - 需要基于磁盘的优先级队列库，最好用于 C

> ID：527238
> 
> 赞同：2
> 
> 时间：2009-02-09T06:20:02.110
> 
> 标签：data-structures, priority-queue

我在 Unix 上的 C 中有一个排队机制。它接受 XML 事务。一些事务包含要存储的记录。其他事务请求这些事务。事务存储在一个文件中，该文件是一个本地队列。先进先出，非常简单。文件开头的标题区域，跟踪要读取的下一个位置和要写入的下一个位置。我们使用文件锁定，但不使用信号量，因为检索是从远程系统轮询的。并且只有一个程序可以访问队列。它在 C 中。多年来一直工作良好。

现在我们必须扩展系统。交易将包含一个额外的 XML 标记。我们必须根据该标签的值有选择地检索。我们将从一个简单的队列变成一个优先级队列。标签中可以有许多不同的值。说 AX、BX、CX、FL 和 TS。事务按接收顺序添加到队列中。我们需要能够按接收顺序检索它们，或者检索标签为 FL 的下一个事务。或 TS。或（CS 或 FL）。或者不是 AX。

如何最好地做到这一点？

简单快速是我们所需要的。我想到了几个选项：

1.  使用 Berkely DB 之类的东西将队列变成各种数据库。
2.  进入 PostgreSQL 数据库，创建一个可用作优先级队列的表。
3.  找到一个可以满足我们需求的 C 库。
4.  编写我们自己的基于磁盘的优先级队列。

我们有一些限制。时间在流逝，这需要在几周内完成。C 用于快速插入系统。如果我们能够以足够快的速度来转换访问队列的程序中的所有其他业务逻辑，那么可能是 Python。最好不要使用 PostgreSQL，因为我们无法控制数据库系统，而且 DBA 对他认为是“他的”的东西有不良习惯，即使这是一个关键系统，我们也没有正常运行时间的可靠性。政治啊！！DBA 还表示，使用 PostgreSQL 表并不是一种有效的方法。我们更喜欢本地化的东西，以便我们可以控制它。必须以闪电般的速度每分钟处理大量交易。

我对任何建议持开放态度，即使是遥远的建议。建议越多越好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T06:29:55.723

听起来您真正需要的是；

1.  一种在检查标签时迭代记录的方法。
2.  一种将记录标记为 NULL 的方法，因此通过常规处理跳过乱序选择的记录。

我建议最快的更改是让每条记录在包含此信息的文件中包含一个小标题（记录长度、isValid、标签信息等）。然后，您照常从第一条记录开始并遍历所有记录，直到遇到带有标签的记录，当您将此记录标记为无效时，常规处理将忽略它。

从长远来看，您可能需要考虑免费提供类似 sqllite 的东西，它可以与常规文件一起使用，并且可以编译到您的可执行文件中。对于大多数类型的记录搜索，它可能比你自己快速滚动的东西要快，而且更灵活:)

因此，我现在会进行快速更改，并考虑在不久的将来重新设计您的数据格式，无论是使用 sqllite 还是其他方式。听起来您对队列的要求变得越来越复杂，所以现在是时候考虑一​​些可以在未来进一步扩展的东西了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-09T06:42:27.720

我想到的第一件事是采用一些基于内存的优先级队列实现（应该很多），并将其放在您自己的内存分配例程之上，这些例程使用 mmap'd 文件作为其内存池。

# jquery - 使用 jquery 删除没有孩子的 div

> ID：527246
> 
> 赞同：17
> 
> 时间：2009-02-09T06:21:16.943
> 
> 标签：jquery, css

如何使用 jquery 删除没有孩子的特定 div（至少没有不是空格的孩子）。例如

```
<div id="outer">
    some content
    <div id="removeme"> 

    </div>
    some more content
</div> 
```

想要完全删除 id="removeme" 的 div。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-09T06:29:54.397

要删除`id`等于的元素`removeme`：

```
$("#removeme").remove(); 
```

仅当元素为空时才删除`id`等于的元素：`removeme`

```
$("#removeme:empty").remove(); 
```

要删除所有空`<div>`的 s：

```
$("div:empty").remove(); 
```

**编辑：**如果它不是空的，但有空格：

```
if($.trim($("#removeme").text()) == "") {
  $("#removeme").remove();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-06-03T14:36:55.363

我去了：

```
$('#outer > div').filter(function (index) { 
    return $(this).children().length < 1; 
}).remove(); 
```

这说：

*   给我#outer 的所有 div 子级
*   使用过滤器摆脱任何有子节点
*   删除我们仍然选择的任何内容

可悲的是，如果 div 包含文本，这将删除它，这可能不是原始海报想要的。纯文本不算作儿童。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T06:28:10.953

您还可以使用：

$('div:empty').remove();

[http://docs.jquery.com/Selectors/empty](http://docs.jquery.com/Selectors/empty)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T06:23:44.737

我找不到忽略文本节点的选择器，所以这是我能想到的最快/最脏的代码片段。

```
$("#header").each(function() { 
    if($(this).children().length < 1) 
        $(this).remove() 
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T06:32:27.213

我想你想要这个：

```
$('div#outer div:empty').remove(); 
```

它将删除 div#outer 节点内的所有空 div

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T09:54:58.743

这里是如果有孩子是空的，那么你可以指向孩子然后删除一个父母，这不看空格它只是删除如果为空

太喜欢了；如果 li 为空，则会删除 #removeme

```
if (!$("#tabs ul li").length) $('#tabs').remove(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-21T19:20:35.563

如果没有特定班级的孩子，则删除父母

```
$('.parentClass:not(:has(.childClass))').remove(); 
```

# sql-server - 如何使用标量函数的输出参数调用内联表函数？

> ID：527250
> 
> 赞同：1
> 
> 时间：2009-02-09T06:23:48.763
> 
> 标签：sql-server, function, sql-server-2000

我想知道是否可以使用标量函数的输出参数调用内联函数？

例如：我的内联函数叫做test_1（输入参数格式bigint），下面的例子效果很好：

**SELECT * FROM MM.test_1(4679)**

但是现在我想将它与一个名为 dbo.test_2(output parameter format bigint) 的标量函数的输出参数一起使用，以使其更加动态，但它不起作用？

**SELECT (SELECT * FROM MM.test_1(dbo.test_2(kp.id))) FROM kp kp WHERE id = 4679**

我收到以下错误消息：
**“函数参数列表中的错误：'。' 无法识别。参数列表不完整。缺少 FROM 子句。无法解析查询文本。”**

有什么建议么？

任何帮助将不胜感激！

Thx 前锋，最好的问候安德烈亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T10:56:07.720

我可以用两种不同的方式解释你想要做什么。

### 场景一：

您想先从**kp表中获取****单个值**，然后通过静态函数运行它，然后将结果提供给内联函数并获取表。

 **在这种情况下，您可以执行以下操作：

```
declare @foo int;
set @foo = (select kp.id from kp where blahblahblah);
select * from MM.test_1(dbo.test_2(@foo)) 
```

### 场景二：

更有可能的是，对于**kp表中的****每条记录**，您都希望对其 id 做所有这些讨厌的事情并**合并**结果表。

 ****In this case, the best I can suggest would be some dynamic SQL that goes through your id values, using a **cursor**, computes the partial results, then UNIONs it all together. Google for using cursors to loop through tables and you'll find enough to get you going (like [this post](http://justgeeks.blogspot.com/2008/08/using-t-sql-cursor-in-sql-server.html)). You must think of your table-valued function like a (surprise...) table. You cannot use it as a column in a SELECT statement in the same way you could use a static function and also you cannot feed the fields of a query back to themselves.

If you are calling this SQL from an application you should seriously think about doing this in code instead.

Good luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T08:35:25.343

```
SELECT * FROM MM.test_1(dbo.test_2(4679)) 
```

如果您有一个表值函数**test_1**和一个标量函数**test_2** ，这部分应该可以正常工作。我现在只能在 MSSQL 2008 中进行测试，但据我所知 MSSQL 2000 也应该喜欢它。

How-eeever .. 你希望你的示例查询做什么？据我所知，您正在*从***kp中选择****MM.test_1** 的输出……这没有意义。

 ***# database - DBMS 中的空值代表什么？

> ID：527256
> 
> 赞同：2
> 
> 时间：2009-02-09T06:25:04.407
> 
> 标签：database

DBMS 中的空值代表什么？

是`unassigned`或`inapplicable`还是`zero`或`blank space`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-09T06:27:45.120

Null 是 SQL 中使用的特殊标记，用于指示数据库中不存在数据值。由关系数据库模型的创建者 EF Codd 引入，SQL Null 用于满足所有真正的 RDBMS 支持[缺失信息和/或不适用信息的表示的要求](http://www.scs.carleton.ca/~bertossi/integra08/material/Codd12Rules.txt)

更多信息[在这里](http://en.wikipedia.org/wiki/Null_(SQL))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-24T18:12:28.850

我是一名学生，现在也在为 OCA 做准备。就 null 而言，首先要记住的是**null 不是一个值**。在 DBMS 的世界中，只有两件事，要么它有一个值，要么它有一个空值。关于 null 有几点：-

*   null 不是一个值。
*   它不与任何值进行比较。
*   它不占用任何空间。
*   当我们在查询中使用 null 时，我们必须将其关联为“is & as”。

例如：-

```
select * from employee 
where 
salary is null 
```

注意：-我们不能编写查询，例如，

```
select * from employee
where 
salary=null: 
```

（这里“=”不起作用）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-17T15:00:34.460

SQL 支持的特殊值称为 null，用于表示未知或不适用于该特定行的属性值

例如，特定学生的年龄在学生表的年龄列中不可用，则表示为空但不为零。重要的是要知道空值始终不同于零值空值用于表示以下内容不同的解释

值未知（值存在但未知）

值不可用（存在但故意隐藏）

属性不适用（该行未定义）

# database - 子查询

> ID：527283
> 
> 赞同：0
> 
> 时间：2009-02-09T06:37:59.680
> 
> 标签：database

您如何表示 SELECT 和 WHERE 子句中的子查询？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T06:42:32.227

包含子查询的语句通常采用以下格式之一：

*   WHERE 表达式 [NOT] IN（子查询）
*   WHERE 表达式 compare_operator [ANY | ALL]（子查询）
*   WHERE [NOT] EXISTS（子查询）

[子查询基础](http://msdn.microsoft.com/en-us/library/ms189575.aspx) *（SQL Server 2008 联机丛书，2009 年 1 月）*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T06:45:22.987

您可以在 SELECT 和 WHERE 子句中使用子查询，如下所示：

```
select
  c.customerid,
  (
    select sum(i.amount) as totalspent
    from item i
    where i.customerid = c.customerid
  ) as totalspent
from customer c
where exists
(
  select *
  from purchase p
  where p.customerid = c.customerid
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T07:14:40.170

您已经获得了一些不错的答案，但请尝试查看是否可以更改您的逻辑，以便子查询发生在 from 子句中，以便它只运行一次，而不是对主查询返回的每一行运行一次。

子查询确实会影响系统的性能。

# delphi - Displaying unicode text in Rave Reports on Delphi 2009

> ID：527287
> 
> 赞同：2
> 
> 时间：2009-02-09T06:41:04.603
> 
> 标签：delphi, unicode, reporting, delphi-2009, rave-reports

I am in the process of porting a Delphi 2006 app to Delphi 2009\. Out of the box support for unicode has been easy - almost no work required. Most 3rd party controls already have Delphi 2009 updates available.

Rave Reports (latest version 7.6.1, available [here](http://cc.codegear.com/item/26089)) has also been updated, but I cannot seem to get it to correctly display RTF text containing Japanese characters. In Delphi 2006, I loaded RTF to the DataMemo component in a RVCustomConnection's OnGetRow event by reading the RTF from a screen control (TLMDRichEdit) using streams and then doing a CustomConnection.WriteBlobData.

In the report output, any RTF text now shows up as a series of rectanges and % signs. No readable text. All other text (displayed using Text and DataText components) displays correctly.

Does anyone have any experience on how to get RTF containing unicode to display correctly? Is it even supported?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-02-27T15:52:08.887

I used this...it seemed to work with Dephi XE's built in RAVE package...

```
Procedure TfrmMain.RaveCustomConnectionGetRow                  (         Connection: TRvCustomConnection);
Var
  MemoString : String;
  Index      : Integer;
  Size       : Integer;
  Buffer     : PAnsiChar;

Begin

  { Init MemoString }
  MemoString := '';

  For Index := 0 To DataList.Count - 1 Do Begin
    MemoString := MemoString + DataList.Strings [Index] + #13#10;
  End; { For }

  { Set the Size (Unicode) and Buffer }
  Size := Length (MemoString) * 2;
  Buffer := PAnsiChar (MemoString);

  { Send the data over as a Blob object to RAVE }
  Connection.WriteBlobData (Buffer^, Size);

End; { RaveCustomConnectionGetRow Procedure } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-13T04:21:50.387

Unless someone from Nevrona cares to comment, I am concluding that it is not (yet) possible.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:50:09.023

Even without unicode the RTF printing in Rave reports is broken (adds rectangles at the end of the lines). New version 7.6.2 has not fixed this,,,

F&^%ing pathetic from Codegear (or what is it called now) and Nevrona...

# python - 如何用python调试死锁？

> ID：527296
> 
> 赞同：6
> 
> 时间：2009-02-09T06:49:07.203
> 
> 标签：python, multithreading, debugging, deadlock

我正在开发一个多线程应用程序，这是死锁。

我正在使用 Visual C++ Express 2008 来跟踪程序。一旦发生死锁，我只是暂停程序并跟踪。我发现当死锁发生时，我的 C++ 扩展中会有两个名为 python 的线程。

他们都在python代码中使用了Queue，所以我猜死锁可能是由Queue引起的。但是，一旦扩展进入 python 代码，我只能从 VC++ 调试器中看到 asm 代码和二进制文件。

我想知道暂停程序后有什么方法可以转储python代码的调用堆栈吗？我怎么知道线程中有什么锁导致了死锁？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T07:33:28.300

如果您可以使用 gcc 编译您的扩展模块（例如，通过使用[Cygwin](http://cygwin.com/)），您可以在这种情况下使用 gdb 和[pystack](http://wiki.python.org/moin/DebuggingWithGdb) gdb 宏来获取 Python 堆栈。我不知道是否有可能在 Visual C++ Express 中做与 pystack 等效的事情，但无论如何你可能会从 pystack 宏实现中得到一些想法。

由于您提到您只能在 VC++ 调试器中看到 asm/binary，因此您应该确保使用调试符号编译 Python。如果 VC++ 仍然显示 asm，则可能是您需要告诉 VC++ 源文件在哪里（抱歉，多年来没有使用 VC++，所以我不知道在这种情况下您可能需要做什么） .

您还可以通过在代码中添加大量日志调用来获得一些重要信息，包括 Python 端和 C++ 扩展。

无论如何，我几乎可以肯定死锁不是由于队列，而是您自己的代码。

# css - 我应该为它需要的自定义 css '命名我的页面'吗？

> ID：527301
> 
> 赞同：0
> 
> 时间：2009-02-09T06:54:30.500
> 
> 标签：css

在 css 中，我应该在顶层“命名”我的页面 - 像这样：

```
<div class="page_products"> 
```

为了像这样编写特定于该页面的css：

```
.page_products h3 {
   font-color: red;
} 
```

注意：这是一个完全随机且可能没有用的样式覆盖。H3是第一个进入我脑海的东西。我只是想描述一下这种做法。

我见过一些描述这种做法的地方 - 包括[对我的其他帖子之一的一个答案，](https://stackoverflow.com/questions/510268/best-strategy-to-style-the-same-html-when-it-appears-on-multiple-pages/510466#510466)我觉得它有点可怕。我宁愿在`<style>`页面顶部的标签中覆盖或创建第二个 .css 文件（不太可能）。但是，如果我以另一种方式看待它，它会非常吸引人，我很想使用它。

其他人如何看待这种做法。对我来说，它看起来非常难以维护。有什么优点或缺点？

**附加点：**我也可能正在尝试编写一个特定于“iPhone”版本的 .css 文件 - 并且有点担心多个 css 文件可能会变得非常笨拙管理。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-09T06:58:30.693

`body`我发现提供类似于您的示例的 ID 或类属性而不是一堆一次性的 CSS 文件，每个文件中都有 1 或 2 条规则。最终，实用主义应该获胜。简单在不同的尺度上意味着不同的东西——如果每个页面都有大量的 CSS 更改，那么维护不同的 CSS 文件和交换包含语句会突然变得简单得多。但是只有少数规则，也许只有几个边缘案例页面，将所有规则包含在主样式表中会更容易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T07:03:07.793

我通常倾向于指定额外的 CSS 文件。但是，它会导致额外的 HTTP 请求并减慢加载时间。 `<style>`html 头中的标签从长远来看是不可维护的。

如果您在某些情况下为特定页面的少数项目覆盖样式，那么这种方法是合理的。

使用 body 而不是 div 来应用类或 id 会更好。它更清洁，更容易发现以备将来维护。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T07:56:15.327

有时您别无选择，您必须为某些页面设置特定的 css。

我通常会在每个页面的正文中添加一个唯一的 ID - 然后不需要额外的 div。

```
<body id="page-x">
    <h3>Page Title</h3>
</body> 
```

然后如果有必要，我会尽可能少地添加到主样式表中（以防止额外的 http 请求）

```
#page-x h3 {
    custom css...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T07:24:49.803

当人们想使用像 Greasemonkey 这样的工具来弄乱你的渲染时，给元素命名会让事情变得简单而轻松。他们可能只想“修复”您的“page_products”标签。

例如，有一个我是会员的 torrent 网站，它显示了大量的复选框，当我列出新的 torrent 时，我不想查看这些复选框。使用 Greasemonkey，我能够将一些 display:none CSS 应用到命名元素，使其每次去那里时都不可见。

# python - 如何使用 MEL 或 Python 修改 Maya 中的现有面板？

> ID：527314
> 
> 赞同：1
> 
> 时间：2009-02-09T07:05:27.367
> 
> 标签：python, user-interface, maya, panels, mel

多年来，我一直在使用 MEL 和 Python 在 Maya 中编写工具。除了一个领域外，我认为自己是 Maya 自定义窗口/gui 设计方面的专家；修改现有的面板和编辑器。

通常，我正在构建需要完全自定义 UI 的工具，因此我习惯于从头开始构建它们。但是，最近我发现自己想在 Maya 的图层编辑器中添加一些额外的功能。我看过解释如何做到这一点的教程，但现在我想做，我找不到。

链接到教程或简短的代码片段让我开始会很棒。我只需要知道如何找到图层编辑器/面板，例如，向其中添加按钮或文本字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T21:30:04.167

简单的方法可以修改现有的 Maya 代码并将其放入您的用户/脚本中。您可以使用 whatIs 来获取脚本名称。比如说：

```
whatIs "layerEditor"; 
```

结果是`./scripts/others/layerEditor.mel //`。但是现在您也可以使用 PyQt 的包装实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-28T20:18:21.097

旧帖子，但也许有人仍然想找出答案。

我至少在 30 年前写了这个脚本：[http ://www.creativecrash.com/maya/downloads/scripts-plugins/interface-display/c/guihelper](http://www.creativecrash.com/maya/downloads/scripts-plugins/interface-display/c/guihelper)

它的脚本编写很糟糕，但对于修改 Maya 的 Gui 非常有用。您可以使用项目名称、打印层次结构等命令向所有 gui 项目添加弹出菜单；您可以加载一个显示 gui 控件层次结构的窗口。

通常，诀窍是识别具有特定名称的 gui 控件，例如 TimeSliderForm，然后通过查询控件命令、帮助文本、标签文本等来遍历层次结构到您想要去的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T16:03:11.997

您是否尝试过在 Maya 安装目录下的 MEL 文件中搜索 ui 项名称？它应该是包含的 MEL 脚本之一，您可以从那里修改它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-25T19:33:59.050

刚刚偶然发现您的问题，您是否尝试过 Digital Tutors Artists Guide to MEL？第 19-22 章逐步描述了如何在 Maya 中创建自己的自定义 GUI 和窗口，链接如下： [http ://www.digitaltutors.com/store/home.php?cat=82](http://www.digitaltutors.com/store/home.php?cat=82)

玩得开心。

# cocoa - 将 NSTextField 绑定到 NSNumber

> ID：527322
> 
> 赞同：5
> 
> 时间：2009-02-09T07:11:50.940
> 
> 标签：cocoa, interface-builder

我正在尝试使用 NSTextField 进行整数用户输入。文本字段绑定到 NSNumber 属性，在 setter 方法中我清理输入值（确保它是 int）并在必要时设置属性。我发送 willChangeValueForKey: 和 didChangeValueForKey:，但是当该文本字段仍处于活动状态时，UI 不会更新为新值。

因此，例如，我可以在 setter 方法清理到“12”的文本字段中键入“12abc”，但文本字段仍显示“12abc”。

我在界面生成器中选中了“持续更新值”。

（我还注意到 setter 方法接收的是 NSString，而不是 NSNumber。这正常吗？）

将 NSTextField 连接到 NSNumber 的正确方法是什么？属性的 setter 方法是什么样的？如何防止非数值出现在文本字段中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T09:03:23.623

> 我发送 willChangeValueForKey: 和 didChangeValueForKey:，但是当该文本字段仍处于活动状态时，UI 不会更新为新值。

发送这些消息的理由很少。通常，您可以通过实现和使用访问器（或者更好的是属性）来更好、更干净地完成相同的工作。当您这样做时，KVO 会为您发送通知。

在您的情况下，您想要拒绝或过滤虚假输入（如“12abc”）。此任务的正确工具是键值验证。

要启用此功能，请选中 IB 中绑定上的“立即验证”框，并实施验证方法。

过滤：

```
- (BOOL) validateMyValue:(inout NSString **)newValue error:(out NSError **)outError {
    NSString *salvagedNumericPart;
    //Determine whether you can salvage a numeric part from the string; in your example, that would be “12”, chopping off the “abc”.
    *newValue = salvagedNumericPart; //@"12"
    return (salvagedNumericPart != nil);
} 
```

拒绝：

```
- (BOOL) validateMyValue:(inout NSString **)newValue error:(out NSError **)outError {
    BOOL isEntirelyNumeric;
    //Determine whether the whole string (perhaps after stripping whitespace) is a number. If not, reject it outright.
    if (isEntirelyNumeric) {
        //The input was @"12", or it was @" 12 " or something and you stripped the whitespace from it, so *newValue is @"12".
        return YES;
    } else {
        if (outError) {
            *outError = [NSError errorWithDomain:NSCocoaErrorDomain code: NSKeyValueValidationError userInfo:nil];
        }
        //Note: No need to set *newValue here.
        return NO;
    }
} 
```

> （我还注意到 setter 方法接收的是 NSString，而不是 NSNumber。这正常吗？）

是的，除非您使用将字符串转换为数字的值转换器，将数字格式化程序连接到`formatter`插座，或在验证方法中用 NSNumber 替换 NSString。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T19:44:48.327

关于彼得·霍西（Peter Hosey）的出色回答有一个重要的评论，我想将其提升到最高水平（因为我在第一次通过时错过了它）。

如果您想在每次输入字符时验证/修改 NSTextField，而不是仅在用户提交字段时验证/修改，那么您无法仅从绑定中获得所需的内容。您需要为文本字段分配一个委托，然后`- (void)controlTextDidChange:(NSNotification *)aNotification`在委托中实现。每次文本更改时都会调用它。如果需要，您可以在 中调用值验证器`controlTextDidChange`。

例如：

```
- (void)controlTextDidChange:(NSNotification *)aNotification
{
    NSError *outError;
    NSControl *textField = [aNotification object];
    NSString *myText = [textField stringValue];

    // myObject is the model object that owns the text in question
    // the validator can modify myText by reference
    [myObject validateValue:&myText error:&outError]];

    // update the NSNextField with the validated text
    [postingObject setStringValue:myText];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T08:31:42.810

就像 Ben 提到的那样，一种方法是将 NSNumberFormatter 附加到您的文本字段，这在界面构建器中设置非常简单，并且很可能是 Just Work™。

如果您不喜欢 NSNumberFormatter 在用户输入非数字值时向他们抛出的模态对话框，您可以将 NSNumberFormatter 子类化以实现不同的“更宽容”的格式化行为。我认为覆盖 - numberFromString: 在调用 super 的实现之前去除非数字字符应该可以解决问题。

另一种方法是创建并注册您自己的 NSValueTransformer 子类以将字符串解析为 NSNumbers 并返回，但我会先尝试使用 NSNumberFormatter，因为它很明显是为此目的而设计的类。

[有关价值转换器的更多信息](http://www.cocoadev.com/index.pl?NSValueTransformer)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T07:23:56.637

我认为您需要为您的`NSTextField`.

在 Apple 的网站上阅读有关格式化程序的信息：[应用格式化](http://developer.apple.com/documentation/developertools/Conceptual/IB_UserGuide/ObjectAttributes/chapter_6_section_4.html)程序。

# sql-server - 如何将 SQL Server 数据库图表迁移到另一个数据库？

> ID：527327
> 
> 赞同：28
> 
> 时间：2009-02-09T07:16:09.450
> 
> 标签：sql-server, database, sql-server-2005

我的团队最近使用 TFS 源文件从头开始重建了他们的 SQL Server 2005 开发数据库。

之后，我们有了一个非常干净的数据库，与我们的测试和生产环境更加匹配。但是，我们也丢失了在旧开发数据库中几个月来创建的数据库图表。

有谁知道将 SQL Server 2005 数据库图表从一个数据库导出到另一个包含相同表和架构对象的方法？

更新：

以下 Valentin 和 CMS 的答案都应该可以正常工作。我接受了 Valentin's，因为它是第一个并且我已经开始使用它。

我最终创建了一个名为“robsysdiagrams”的临时表，并将所有数据复制到该表中，并使用[Microsoft SQL Server 数据库发布向导](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)将数据插入到磁盘中。然后我在脚本中将 robsysdiagrams 重命名为 sysdiagrams 并在目标数据库上运行它。一切正常。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-09-28T07:30:04.557

我在寻求解决同一问题时遇到了一个古老但优雅的答案：`bcp`

提取：

```
bcp YOUR_DATABASE..sysdiagrams out YOUR_DIAGRAM_NAME.bcp -c -T -S SERVERNAME 
```

要导入：

```
(cd to the directory the diagram is in)
bcp YOUR_DATABASE..sysdiagrams in YOUR_DIAGRAM_NAME.bcp -c -T -S SERVERNAME 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-09T07:46:53.323

假设您可以访问 SQL Server 实例中的两个数据库。

**在新数据库中启用图表：**

在新数据库中，单击“Database Diagrams”文件夹。Sql Server Management Studio 将提示您启用图表。如果你确定这一步，你将在数据库中有一个 sysdiagrams 表。

**然后执行以下命令：**

```
INSERT INTO newdb.dbo.sysdiagrams 
     SELECT name, principal_id,[version], [definition]
       FROM olddb.dbo.sysdiagrams 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-09T07:23:08.793

Rob，有一个表 'sysdiagrams' 包含图表定义。尝试创建表并插入旧数据库中的数据。它应该工作。

高温高压

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-09T07:26:16.227

您可以[将图表](http://www.codeproject.com/KB/database/ScriptDiagram2005.aspx)（[存档链接）](https://web.archive.org/web/20170614083407/https://www.codeproject.com/Articles/15080/Script-SQL-Server-diagrams-to-a-file)[*脚本*](http://www.codeproject.com/KB/database/ScriptDiagram2005.aspx)写入 .sql 文件...

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-10-31T05:06:18.680

我认为这是更好的方法：

```
USE DestinationDatabase

DELETE  sysDiagrams
WHERE   name IN ( SELECT    name
              FROM      SourceDatabase.dbo.sysDiagrams )

SET IDENTITY_INSERT sysDiagrams ON

INSERT  sysDiagrams
    ( name ,
      principal_id ,
      diagram_id ,
      version ,
      definition
    )
    SELECT  name ,
            principal_id ,
            diagram_id ,
            version ,
            definition
    FROM    SourceDatabase.dbo.sysDiagrams

SET IDENTITY_INSERT sysDiagrams OFF 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-02T10:17:29.097

如果您有链接服务器或仍在同一台机器上，这很容易：

```
USE newDB;

SET IDENTITY_INSERT sysdiagrams ON;

INSERT INTO sysdiagrams(name,principal_id,diagram_id,version,definition)
SELECT name,principal_id,diagram_id,version,definition
FROM oldDB..sysdiagrams;

SET IDENTITY_INSERT sysdiagrams OFF; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-30T10:08:59.717

我的问题是有时我需要删除我的数据库并重新创建它。我有一个完整的生成脚本，可以创建除图表之外的所有内容。

我的解决方法是将图表临时复制到另一个数据库，并在我的数据库重新生成后将其复制回来。

有趣的是，不应该尝试打开复制图，因为它所在的其他数据库没有我的数据库的表结构，所以 SQL 服务器在打开时会自动清除图中的所有表 q-：

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-12T04:50:11.780

我使用 MSSMS 的导出数据功能做到了这一点。

*   右键单击数据库。
*   选择任务 > 导出数据，这将启动一个向导。
*   设置两个数据源。我使用了 SQL Server Native Client 11，但其他人可能会工作。点击下一步。
*   选择从一个或多个表或视图复制数据（默认）
*   从列表中选择 sysdiagrams 表。
*   选择编辑映射。确保选中“启用身份插入”。点击确定。
*   单击下一步，然后单击完成执行。

像魅力一样工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-12T10:21:59.413

您可以按照之前的回答直接复制。如果您只想“备份”您可以执行的图表，请参阅我对其他问题的回答。

[https://stackoverflow.com/a/26884146/951001](https://stackoverflow.com/a/26884146/951001)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-19T21:56:02.313

更安全的方法：

```
merge into TcsDev1..sysdiagrams as Trg
using TcsDev2..sysdiagrams as Src
on Trg.name = Src.Name
when not matched by target then
insert (name, principal_id, [version], [definition]) 
values (src.name, src.[principal_id],  src.[version], src.[definition] ); 
```

# java - 在jsf中使用ArrayDataModel向数据表添加一行？

> ID：527335
> 
> 赞同：3
> 
> 时间：2009-02-09T07:23:19.853
> 
> 标签：java, jsf

如何向数据表添加一行并使用 ArrayDataModel 向表中添加新数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T09:56:01.577

您可以在托管 bean 中执行此操作：

```
public class ArrayDataBean {

    private Object[] rows = { "One", "Two", "Three" };

    private final DataModel dataModel = new ArrayDataModel(rows);

    /** Bind to dataTable value */
    public DataModel getDataModel() {
        return dataModel;
    }

    /** Bind to command control action */
    public String addRow() {
        Object[] newArray = new Object[rows.length + 1];
        System.arraycopy(rows, 0, newArray, 0, rows.length);
        newArray[rows.length] = "NewRow" + System.currentTimeMillis();

        rows = newArray;
        dataModel.setWrappedData(rows);

        // return navigation rule, if any
        return null;
    }

} 
```

# css - 制作 CSS 精灵的工具？

> ID：527336
> 
> 赞同：127
> 
> 时间：2009-02-09T07:23:48.167
> 
> 标签：css, css-sprites, web-performance

有没有制作css sprites的好工具？

理想情况下，我想给它一个图像目录和一个引用这些图像的现有 .css 文件，并让它创建一个用所有小图像优化的大图像，并更改我的 .css 文件以引用这些图像。

至少我希望它获取一个图像目录并生成一个大精灵和将每个图像用作背景所需的 .css。

是否有任何好的 Photoshop 插件或完全成熟的应用程序可以做到这一点？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2010-11-15T14:56:50.627

[Instant Sprite](http://instantsprite.com)是我正在开发的浏览器内 CSS sprite 生成器。它真的很快，但没有其他一些功能那么多。它目前仅适用于 Firefox 或 Chrome，因为它使用 JavaScript FileReader 和 HTML Canvas 在 Web 浏览器中生成精灵而无需上传。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-02-09T07:29:22.553

这将为您完成 90% 的工作：[CSS Sprite Generator](http://spritegen.website-performance.org/)。您仍然需要自己编辑规则，但该工具将为您提供新 CSS 文件所需的代码片段。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-10-21T10:59:35.490

现在有 Steve Souders 的 Sprite Me。只是尝试一下，它似乎工作得很好。

这是链接[http://spriteme.org/](http://spriteme.org/)，这是宣布它的博客文章。

[http://www.stevesouders.com/blog/2009/09/14/spriteme/](http://www.stevesouders.com/blog/2009/09/14/spriteme/)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-02-15T20:27:44.547

这看起来很有希望：

[http://csssprites.org/](http://csssprites.org/)

我还发现[这篇文章](http://mezzoblue.com/archives/2009/01/27/sprite_optim/)有一些有用的信息，甚至还有一些值得一读的读者评论。

显然谷歌网络工具包也有一些东西 - 所以如果你正在使用它可能值得一试。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-08-28T16:56:29.220

试试这个：

[http://spritepad.wearekiss.com/](http://spritepad.wearekiss.com/)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-05-04T03:11:59.910

[ZeroSprites](http://zerosprites.com/)是一个 CSS 精灵生成器，旨在使用 VLSI 平面布局算法最小化区域。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-09T07:28:23.180

[发现这个非常快](http://spritegen.website-performance.org/section/tool-help)，但 500K 的上传限制可能会很痛苦。源代码可[在此处获得](https://launchpad.net/css-sprite-generator/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-05-25T02:24:05.637

[Tonttu](http://collamo.jp/Tonttu/) 是基于 Adob​​e AIR 的应用程序，它为创建强大的 CSS Sprites 图像提供了简单的界面。您可以指定 FiledWidth 和 FieldHeight 或对图像进行排序。
[使用 Tonttu 桌面工具创建 CSS Sprites 图像](http://www.blogsdna.com/5375/create-css-sprites-images-with-tonttu-desktop-tools.htm)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-02-23T21:33:28.160

目前尚不清楚它是否会成为核心 ASP.NET 框架，但这里有一个用于 csssprites 的 Microsoft codeplex 项目：

[http://aspnet.codeplex.com/releases/view/50869](http://aspnet.codeplex.com/releases/view/50869)

如果你喜欢它 - 使用它 - 或者只是喜欢这个想法然后添加评论。我认为这将是 ASP.NET 框架中的一件好事。没有亲自使用它（我不得不自己发明轮子），但它得到了很好的评价。

* * *

它包括以下组件：

*   用于自动生成精灵和内联图像的 API
*   提供调用 API 的便捷方式的控件和助手

第二版中添加的功能：

*   Web 窗体的 CSS 链接控件（为用户的浏览器选择正确的 CSS 文件，但不显示图像）
*   使用 App_Sprites 以外的自定义文件夹路径
*   更改精灵图像的平铺方向
*   将生成的 CSS 与用户自己的 CSS 合并

未来版本正在考虑的功能：

*   自动选择最有效的精灵背景颜色
*   自动缩小呈现的 CSS
*   针对 .NET 3.5 编译

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-11-15T15:17:37.410

只需使用[http://sprites.scherpontwikkeling.nl/](http://sprites.scherpontwikkeling.nl/)它也可以从网站 URL 生成精灵……您可以在开发网站后集成您的精灵。它非常易于使用；）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-12T23:57:53.360

不是直接的答案，但对于我的开发人员和网络集成商，考虑简单地将每个精灵与 2 的幂对齐；例如 16 像素或 32 像素的网格。它使计算 CSS 文件中的偏移量变得更加容易。之间的所有空白都无关紧要，因为 gifd 和 png 格式可以很好地压缩它们。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-11-13T03:20:41.890

Compass CSS 框架具有[自动精灵生成](http://compass-style.org/help/tutorials/spriting/)功能。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-09T14:17:27.533

如果你喜欢 Java，那么你可以使用 GWT 1.5+，它带有一个叫做“ [ImageBundle](http://code.google.com/intl/en/docreader/#p=google-web-toolkit-doc-1-5&s=google-web-toolkit-doc-1-5&t=DevGuideImageBundles) ”的东西。GWT 编译器将为您处理所有令人讨厌的细节。您甚至不必编写任何 JavaScript 代码或编写任何 CSS。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-07-07T19:23:37.910

这是一个[通过 Photoshop 脚本将图像组合成 CSS sprites 的脚本](http://www.interactivellama.com/blog/archives/photoshop-script-combine-two-images-css-hover-css-sprite/)。它不会按照您的要求制作精灵图，但如果它们的大小相同，它将以两个（2、4、8）的倍数组合图像。我更喜欢组合相似的图像（正常、悬停、选定、选定的父级），而不是将所有图像放在一个文件中。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-11-30T04:02:47.343

如果你在 rails 上使用 ruby​​，有一个易于安装的库来生成 css sprites。

[http://github.com/aberant/spittle](http://github.com/aberant/spittle)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-03-03T15:03:59.013

有一个名为 ActiveSprites 的新工具，它是 active_assets gem 的一部分。

Github：[http ://bitly.com/eRTwU4](http://bitly.com/eRTwU4)

您使用 ruby​​ dsl 来定义您的精灵，然后执行“rake sprites”并生成精灵和相应的样式表。

这是拉德！

这是一些示例代码，

```
# config/sprites.rb
Rails.application.sprites do
  sprite 'sprites/sprite1.png' => 'sprites/sprite1.css' do
    _'sprite_images/sprite1/1.png' => 'a.one'
    _'sprite_images/sprite1/2.png' => 'span.two'
  end
end 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-11-11T15:52:06.057

[https://github.com/northpoint/SpeedySprite](https://github.com/northpoint/SpeedySprite)

该工具采用了一种新颖的方法，它将您请求的图像即时组装为 http 服务。这使得整个过程非常简单（无需预处理，随时更改图像）：您启动服务，然后在 HTML 中引用您想要的任何图像：

```
<link href="css/my-images-dir/" rel="stylesheet">
<div class="my-image-name-here" /> 
```

因为它是动态的，您甚至可以从一组动态图像（例如缩略图页面）中制作精灵。虽然不支持 JPEG，但 PNG 和 GIF 可以正常工作。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-01-26T21:47:05.013

我建议你使用[Sprite Master Web](http://www.mobinodo.com/spritemasterweb)。我会自动生成精灵表并为您导出 CSS 代码。它总是尝试使用高级算法生成最小的精灵表。

这是截图和[youtube视频](http://www.youtube.com/watch?v=458Qx7JW5PI)

![在此处输入图像描述](https://i.stack.imgur.com/yU2sz.png)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2012-11-08T02:30:49.093

这些工具都不符合我的要求，所以我编写了一个使用 Mark Tylers 的微型图像库 mtpixel（现在是[mtcelledit](http://code.google.com/p/mtcelledit/)的一部分）的工具、旋转、锐化、量化、分色、翻转（垂直和水平）、变换、rgb->indexed、indexed->rgb、边缘检测、浮雕、绘制多边形、文本等。

您所做的只是将一组图像作为 args 传递给它（支持 png、gif 和 jpeg），它会输出一个名为 sprite.png 的 rgb png 以及有用的图像切片数据到 stdout。我在 bash 脚本中使用它来拆分整个图像目录并输出切片数据以自动生成 css（希望最终使其能够用一些创造性的 sed/awk 自动替换现有的 img 标签）

小狗 linux 的二进制包将在这里：

[http://murga-linux.com/puppy/viewtopic.php?t=82009](http://murga-linux.com/puppy/viewtopic.php?t=82009)

我的用例只需要将图像垂直拼接成一个新的 png，这就是它所做的一切，但我的源代码是公共领域的，mtcelledit 库是 gpl3。使用 mtpixel 静态链接，二进制文件 <100kb（动态链接时只有几 kb），唯一的其他依赖项是 libpng、libjpeg 和 libgif（以及使用官方 mtpixel 的 freetype，但我不需要文本支持，所以我注释掉静态构建中的 freetype 位）

随意修改为您自己的需要：

```
#include <stdlib.h> 
#include <stdio.h> 
#include <string.h> 
#include <mtpixel.h> 

int main( int argc, char *argv[] ){ 
int i=0,height=0,width=0,y=0; 
mtpixel_init(); 
mtImage *imglist[argc]; 
argc--; 
do{   imglist[i] = mtpixel_image_load( argv[i+1] ); 
   height+=imglist[i]->height; 
   if (imglist[i]->width > width) width=imglist[i]->width; 
} while (++i < argc); 
imglist[argc]=mtpixel_image_new_rgb(width,height); 
imglist[argc]->palette.trans=0; 
i=0; 
do{   if (imglist[i]->type == MTPIXEL_IMAGE_INDEXED) 
      mtpixel_image_paste(imglist[argc],mtpixel_image_to_rgb(imglist[i]),mtpixel_brush_new(),0 ,y); 
   else mtpixel_image_paste(imglist[argc],imglist[i],mtpixel_brush_new(),0 ,y); 
   printf("name=%s;width=%d;height=%d;y_offset=%d\n",argv[i+1],imglist[i]->height,imglist[i]->width,y); 
   y+=imglist[i]->height; 
   mtpixel_image_destroy( imglist[i] ); 
}while (++i < argc); 
   mtpixel_image_save( imglist[argc], "sprite.png", MTPIXEL_FILE_TYPE_PNG, 5 ); 
mtpixel_quit(); 
return 0; 
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-09-11T06:50:08.210

如果您使用的是 .net，请查看[http://www.RequestReduce.com](http://www.RequestReduce.com)。它不仅自动创建 sprite 文件，而且还通过 HttpModule 以及合并和缩小所有 CSS 即时完成。它还使用量化和无损压缩优化 sprite 图像，并使用 ETags 和 Expires 标头处理生成文件的服务，以确保最佳浏览器缓存。设置很简单，只涉及一个简单的 web.config 更改。请参阅我的[博客文章](http://www.mattwrock.com/post/2011/09/10/Adopt-RequestReduce-and-see-immediate-Yslow-and-Google-Page-Speed-score-improvements-not-to-mention-a-faster-site!.aspx)，了解 Microsoft Visual Studio 和 MSDN 示例库对它的采用。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-01-20T14:43:45.500

我最近发现了这个工具：SpriteRight [http://spriterightapp.com/](http://spriterightapp.com/)

*SpriteRight 是一个用于 Mac 的 CSS spritesheet 生成器，可让您导入现有的图像或样式表。使您的网站加载速度更快，降低带宽成本并节省时间。SpriteRight 甚至可以即时生成 CSS 代码。*

# security - 在不使用明文密码的情况下从 Weblogic 获取 IntialContext

> ID：527360
> 
> 赞同：3
> 
> 时间：2009-02-09T07:39:58.753
> 
> 标签：security, weblogic, jndi

我可以使用以下属性作为 InitialContext 的环境参数从 JNDI 客户端获取 Weblogic InitialContext

```
Hashtable jndiProps = new Hashtable();
jndiProps.put("java.naming.factory.initial", "t3://localhost:7001");
jndiProps.put("java.naming.provider.url", "weblogic.jndi.WLInitialContextFactory");
jndiProps.put("java.naming.security.principal", "weblogic");
jndiProps.put("java.naming.security.credentials", "weblogic");

InitialContext ctx = new InitialContext(jndiProps); 
```

问题是，有没有办法获得 InitialContext 而不将 security.credentials 指定为明文但可能作为散列值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:56:20.637

您可以使用对称加密，加密密码值并将其存储在属性文件中。然后在创建初始上下文之前读取属性值，解密并更新属性，然后将 jndiProps 对象传递给 InitialContext 构造函数。

加密密钥仍会在客户端上，但它会阻止有人随便读取属性文件以找出密码。

使用 SSL 也是保护在客户端和服务器之间传输的密码的好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T06:43:23.703

简单地散列密码并没有真正增加安全价值。由于您的密码无论如何都驻留在客户端上。

最大的收获是首先使用 t3s 在您的频道上使用 SSL 加密，其次是使用权限最少的用户而不是管理员用户“weblogic”。

# html - 日本手机网站开发的细节；测试？

> ID：527362
> 
> 赞同：6
> 
> 时间：2009-02-09T07:42:04.987
> 
> 标签：html, mobile, internationalization

关于专门为日本手机开发网站有什么好的建议吗？正如我目前所看到的，该站点基本上必须是简单的 HTML，如果需要的话，主要是`<p>`s 和`<br>`s 以及微小的压缩邮票图形。还有一些用于[预定义图形的](http://creation.mb.softbank.jp/web/web_pic_01.html)UTF-8 代码。是否还有其他应注意的约定？

另外，测试移动网站的好方法是什么？我使用 Opera 的“移动视图”模拟器，但仅此而已。手机军团提供了一些[模拟器，但是它们要么非常过时，要么无法在我的英语测试系统上安装或生成](http://www.nttdocomo.co.jp/service/imode/make/content/html/tool2/)[mojibake](http://en.wikipedia.org/wiki/Mojibake)（而且我现在没有勇气安装另一个操作系统）。实际的电话在开发过程中不起作用，因为它不在 Intranet 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T10:58:58.730

如今，所有 JP 手机都配备了支持 CSS 的完整浏览器（如 iPhone 上的 safari）。

然而，大多数用户通过其提供商的专有平台访问内容。对于在 JP 工作的网站（我的意思是商业上的），您将希望在他们的“批准网站”目录中列出。

有三个主要平台，每个主要提供商一个：

*   [适用于NTT DoCoMo](http://www.nttdocomo.co.jp/)订阅者的 Imode （[此处链接至 NTT 开发指南](http://www.nttdocomo.co.jp/service/imode/make/index.html)）
*   雅虎！[面向软银](http://mb.softbank.jp/mb/)（前沃达丰）用户的 Ketai （[链接到软银开发指南](http://creation.mb.softbank.jp/)）
*   [用于au KDDI](http://www.au.kddi.com/)订阅者的 EZweb （[链接到 AU KDDI 开发指南](http://www.au.kddi.com/ezfactory/index.html)）

由于已经为 JP 移动市场（我在 JP 工作和生活）做过多个站点，我建议使用每个提供商提供的开发工具包进行测试。您的站点需要满足每个供应商的独特质量标准，并由该公司的 QA 人员进行验证。

另外，根据经验，我可以告诉你，NTT 和 Softbank 标准很容易通过，而 AU 会让你很难处理最细微的细节。在我的上一个项目中，自 2000 年以来，我不得不亲自前往 AU KDDI 中心在每部手机上测试我的网站（他们有一个专门的测试室）。

哦，是的，我还建议在您的 PC 上添加亚洲语言支持。在 XP 上，您可以通过转到控制面板 > 区域语言选项 > 高级来执行此操作。将“非Unicode程序的语言”设置为日语，然后tadaa！你可以运行日文软件。

干杯！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T07:55:08.007

我是 mobalean 的创始人，[mobalean](http://www.mobalean.com)是一家专门从事日本移动开发的软件开发咨询公司。我们为日本的移动开发人员创建了一个包含英语语言信息的[wiki 。](http://wiki.mobalean.com)wiki 仍处于起步阶段，但希望您能在那里找到对您有所帮助的东西。

至于测试，一种快速简便的方法是使用[FireMobileSimulator](http://firemobilesimulator.org/)，这是一个 firefox 插件，可以根据所选手机对页面进行一些简单的重新格式化。它当然不能取代手机上的测试，但如果您没有在 Windows 机器上开发，因此无法访问模拟器，它会特别有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:50:11.983

可能值得了解 iMode 设备在日本的盛行——它们运行在 cHTML 上。[这里](http://eurotechnology.com/market_reports/imode/faq-dev.shtml)有一些关于为 iMode 开发的有用说明。

为了获得最大的兼容性，您可以考虑使用诸如[WALL](http://wurfl.sourceforge.net/java/wall.php)之类的渲染库，它会自动为正在查看它的设备定制标记。[我在去年 7 月的 php|architect 杂志上](http://pointbeing.net/weblog/2008/07/php-tools-for-mobile-web-development-published.html)写过类似的过程，但 PHP 可能与您的需求无关。

关于测试，您可能需要查看[DeviceAnywhere](http://www.deviceanywhere.com/)，它允许您“远程控制”大量设备以进行测试。它不是免费的（使用起来有点笨拙），但它确实支持日本手机，并且有免费试用版。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T18:00:27.230

无论您为日本市场开发什么，都可能不像看起来那么简单。我听到一些评论说日本人的心态完全不同，这就是为什么他们为美国/欧洲市场设计用户界面的尝试并不那么成功。我想反之亦然。尝试查看现有的日本网站，了解可能有什么不同。UI 组件的排列、产品的分类、菜单元素并不完全符合逻辑。如果您仍在此过程中，在继续之前暂停并环顾四周可能会更好。

我听说的另一件事是，日本人对手机有点上瘾，大部分时间都随身携带和玩弄手机。如果这是真的，你可能会重新考虑如何提高你所做的任何事情的效率，因为你知道这个特性。

至于测试，我们都知道移动设备的渲染不兼容远远大于我们方便的桌面浏览器。我想，最后你会想在一些真实的设备上检查你的网站。

好吧，只是我的想法...... :)

# wpf - 从列表框中删除项目会使列表框没有选定的项目

> ID：527364
> 
> 赞同：0
> 
> 时间：2009-02-09T07:45:01.017
> 
> 标签：wpf, listbox, wpf-controls

我有一个 WPF 列表框，里面有一些自定义项。

当用户想要删除该项目时，发生的情况是他必须在删除后手动重新选择列表，因为列表“似乎”失去焦点或不存在选定的项目。

任何想法 ？

谢谢乔纳森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T07:48:30.853

我们总是通过在代码中设置所选项目来处理这个问题。如果它是列表中的最后一项，则将所选索引设为最后一项。否则，我们将其设置为已删除的后一个。

```
if (SnippetsList.Items.Count > index) 
    SnippetsList.SelectedIndex = index;
else 
    SnippetsList.SelectedIndex = SnippetsList.Items.Count - 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T23:09:08.077

我也在努力解决这个问题（因此进行了此编辑）。解决方案是存储已删除的索引并保存以备后用。有点hack，但到目前为止我发现的最好的：

```
<Window x:Class="KeepFocusAfterDelete.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="200" Width="200">
    <Grid>
        <ListBox KeyUp="ListBox_KeyUp">
            <ListBoxItem>1</ListBoxItem>
            <ListBoxItem>2</ListBoxItem>
            <ListBoxItem>3</ListBoxItem>
            <ListBoxItem>4</ListBoxItem>
        </ListBox>
    </Grid>
</Window> 
```

代码是

```
using System;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
namespace KeepFocusAfterDelete
{
    public partial class MainWindow : Window
    {
        int prev = -1;
        public MainWindow() { InitializeComponent(); }
        private void ListBox_KeyUp(object sender, KeyEventArgs e)
        {
            var list = sender as ListBox;
            switch (e.Key)
            {
                case Key.Delete:
                    prev = list.SelectedIndex;
                    var items = list.SelectedItems.Cast<object>().ToList();
                    foreach (var item in items) list.Items.Remove(item);
                    prev = list.Items.Count > prev ? prev : list.Items.Count - 1;
                    list.SelectedIndex = prev;
                    break;
                case Key.Up:
                    if (-1 != prev)
                    {
                        list.SelectedIndex = prev - 1;
                        prev = -1;
                    }
                    break;
                case Key.Down:
                    if (-1 != prev)
                    {
                        prev = list.Items.Count > prev + 1 ? prev + 1: list.Items.Count - 1; 
                        list.SelectedIndex = prev;
                        prev = -1;
                    }
                    break;
            }
        }
    }
} 
```

选择项目“2”，按 Delete，然后按向下箭头。所选项目从项目“1”快速更改为项目“4”。

谢谢，-Ole

# resources - 我在哪里可以找到人们在软件项目上进行协作？

> ID：527367
> 
> 赞同：6
> 
> 时间：2009-02-09T07:48:14.723
> 
> 标签：resources, collaboration

我的意思不是开源，而是构建和销售的软件。

他们不一定是程序员，他们也可以是有想法或有营销背景的人。

有没有什么好的互联网平台呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T08:07:41.370

试试[FairSoftware](http://www.fairsoftware.net/home)或更具体地说[FairSoftware/TeamUp](http://www.fairsoftware.net/teamup)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-08T18:19:56.780

[builditwith.me](http://builditwith.me)

[更好的代码.org](http://bettercodes.org)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T07:54:40.620

[专业的社交网络 LinkedIn](http://www.linkedin.com/)是一个很好的起点。你可以加入志趣相投的团体，找人开始一个项目，找雇主等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T07:54:57.420

你可以试试[WhyNot？思想交流](http://www.whynot.net/)。这是一个通用的思想交流论坛。其中一些想法与软件相关。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T07:56:51.597

有几十个。首先，请查看 37signals [Gig Board](http://gigs.37signals.com/)和[RentACoder](http://www.rentacoder.com/RentACoder/DotNet/default.aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-08T18:38:06.270

[Craigslist](http://www.craigslist.org/about/sites)的 gigs 部分不时有这方面的要求。当然，买者自负。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2015-04-03T07:14:15.733

collabfinder 或 behance ..... 我会用它们来启动一个项目并结识感兴趣的人。

资金当然是kickstarter...

您自己的网页来推广项目和接受申请或签订保密协议...例如我在我的网站上的草稿 [http://www.pajamajunctionproduction.com/?page_id=23](http://www.pajamajunctionproduction.com/?page_id=23) 我还在注册页面上设置了保密...这是为了保护项目...

协作软件...有很多...我什至不会费心列出这些...但是我确实喜欢与写作相关的任何内容的盗版垫...团队演讲频道或Skype也非常有用... .

我很少遇到对任何特定网站上的项目感兴趣的人......我有，但他们很少愿意留下来......很多人会来来往往试图窃取想法或爱管闲事......通常最乐于助人的人只是在互联网上玩游戏......甚至无法表达有多少开发人员、程序员和艺术家在网上玩电子游戏......这似乎是寻找无聊的人寻找真实项目的最佳场所...... .

我可以根据我的经验给出最好的建议......

# asp.net-mvc - 一种形式的 ASP.NET MVC 多个控制器操作

> ID：527368
> 
> 赞同：1
> 
> 时间：2009-02-09T07:48:14.847
> 
> 标签：asp.net-mvc

我可能走错了方向，所以请帮忙。

我的 ASP.NET MVC 应用程序中有一个显示评论的页面。这些评论来自“评论”控制器的“索引”操作。在页面底部，我有一个用于添加新评论的表单。这种形式应该调用

```
[AcceptVerbs(HttpVerbs.Get)] 
public ActionResult AddComment(); 
```

将表单呈现给用户时的操作和

```
[AcceptVerbs(HttpVerbs.Post)] 
public ActionResult AddComment(Comment c); 
```

向服务器发布新评论时的操作。

我认为“评论”页面应该调用三个操作方法（Index、AddComment[Get]、AddComment[Post]）。但是 AddComment[Get] 永远不会被调用。

请指出我正确的方向。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T08:01:20.650

如果表单提交对评论页面做了一个POST（提交）（即有评论页面的动作，有POST的方法），那么确实是使用的POST版本。如果您（例如）使用标准锚点/链接来显示独立评论页面（或在向该地址发出 AJAX“获取”时），则将使用 GET 版本。

您目前如何访问页面？目前听起来您的索引页面正在手动添加表单 - 因此没有使用 GET 评论的地方，除非您通过 AJAX 添加表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T09:16:46.227

添加对[MVC Futures](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=22359)程序集的引用，并使用**Html.RenderAction**帮助器方法将另一个操作的结果包含在您的页面视图中。

# installation - 如何在编译脚本时调用 NSIS 中的函数？

> ID：527371
> 
> 赞同：1
> 
> 时间：2009-02-09T07:48:41.023
> 
> 标签：installation, nsis

我想在我的 NSIS 脚本编译时调用一个函数（它计算我的版本号），而不是在它执行时。这可能吗？它使用`nsExec`和基本的字符串操作函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T08:07:06.660

你可以这样做：

```
!system '"calculate_version.exe" "tempfile.tmp"'
!searchparse /file "tempfile.tmp" `APP_VERSION=` APPVERSION 
```

这是做什么的：调用calculate_version.exe（这可能是一个简单的NSIS脚本，它调用你的函数）。此可执行文件应将版本号输出到 tempfile.tmp。版本的格式无关紧要；在此示例中，我选择了“APP_VERSION=something”（可以使用 来编写`WriteINIStr`）。

在下一行中，我们打开临时文件并在其中搜索我们编写的行；然后我们将 ${APPVERSION} 设置为我们在那里找到的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T08:06:37.893

甜的！这是可能的：见[http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time](http://nsis.sourceforge.net/Invoking_NSIS_run-time_commands_on_compile-time)

基本思想是：

1.  编译生成可执行文件的*单独脚本*
2.  在您的主脚本中运行可执行文件（通过`!system`，在编译时） - 这会生成一个文本文件（这`!define`是您需要的任何内容）
3.  `!include`主脚本中的文本文件

快！您的脚本在编译时生成了一些东西。

# java - 什么是 J2ME 兼容的 WebDAV 库？

> ID：527391
> 
> 赞同：4
> 
> 时间：2009-02-09T08:07:20.807
> 
> 标签：java, blackberry, java-me, webdav

我需要一个可以在 BlackBerry 上运行的 WebDAV 库，因此需要 J2ME。拥有类似 BSD 的许可证（或允许在专有应用程序中使用的其他许可证）将是理想的，但如果不能免费获得，那么专有的付费许可证也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T17:07:58.350

您可以像我一样尝试使用套接字连接： [StackOverflow: WebDAV with J2ME](https://stackoverflow.com/questions/716686/webdav-with-j2me)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T09:48:06.470

我在 J2ME 中没有使用 WebDAV 的经验，但是通过 Google 快速搜索发现了一个名为[PaderSyncDAV的产品](http://www.pader-sync.com/products.html?mobile_webdav_client)

# dns - Any idea how to let S3 serve "maintenance mode" page?

> ID：527395
> 
> 赞同：0
> 
> 时间：2009-02-09T08:08:31.787
> 
> 标签：dns, amazon-s3, amazon-ec2, amazon, maintenance

Say, you have a Rails (or actually any other kind) application running on Amazon EC2, and whenever you perform some maintenance, which **might** include shutting down or re-creating your instances, you might want S3 to display your "maintenance mode" page instead of your app.

So, basically, that might mean:

1.  Uploading text saying when you're going to be back online to S3
2.  ???
3.  S3 serving this page to any request to your domain while you perform upgrades/re-instantiating instances, etc.
4.  ???
5.  EC2 instances are back serving your customers

I understand that most probably it is not possible — at least I have no idea how to do this. Just want to make sure it is not possible.

Anyway. Any ideas? :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T08:12:11.873

I don't think it is possible with plain S3.

You can always run an EC2 instance with a minimal web server on it. It'll just cost you a few cents, assuming you're only down for a few hours. Using Elastic IPs, you don't even have to have any downtime – just switch your IP to point to the "downtime page" node, then swap it back when everything's back up and running.

# .net - .NET 3.5 SP1 作为要求（或者我应该尝试 3.5 w/o SP1）？

> ID：527406
> 
> 赞同：3
> 
> 时间：2009-02-09T08:16:05.687
> 
> 标签：.net, wpf

我们正在创建一个针对 .NET 3.5 的 WPF 自定义控件。在绑定中使用 StringFormat 属性非常引人注目，但这只是在 SP1 中添加的。

所以问题是：通过将需求从 .NET 3.5 更改为 .NET 3.5 SP1，我们将切断多少潜在用户？或者可以安全地假设每个拥有 .NET 3.5 的用户或多或少都已经拥有 SP1（或者将在不远的将来拥有它）？

非常感谢您的意见。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T08:28:47.887

对于大公司来说，SP1 部署到台式机上的速度可能仍然很慢——只是因为它需要进行大量的测试等，除非你有充分的理由这样做，否则你会很想不这样做。

而对于个人来说——它可能是一个很大的下载，除非你有一个胖管道（不是每个人都这样做）。

例如，在我的工作中，我们已经部署到网络服务器（因为他们需要它），但没有部署到用户桌面。如果我需要推动 SP1，我会的，但在那之前我看不到太多意义。

您可能还想看看您的代码是否会在客户端配置文件上运行？那么这只是一个 <30MB 的安装距离......虽然我从未真正看到有人在愤怒中使用客户端配置文件（如果你必须进行部署，见鬼：推大的......）。

所以这真的取决于：这个应用程序的用户是谁？你能强力武装他们升级吗？或者至少“鼓励”他们；-p

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T08:54:00.213

您如何部署 WPF 应用程序？如果通过安装程序，那么您是否可以不只是添加 SP1 作为先决条件并让安装程序整理其余部分？

您应该能够将 SP1 与您的安装程序捆绑在一起（如果您要发送传统媒体），或者允许下载它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T10:49:27.540

.net 3.5 sp1 将为安装了 .net 的每个人提供 Windows 更新，所以除非它是一家部署策略非常缓慢的大公司，否则我会说这应该不是问题。

此外，在这样一个有这些部署策略的公司中，我根本不希望找到 .net 3.5。

我个人几乎在 .net 3.0 发布的那一刻就开始销售 WPF 应用程序，每个人都在谈论大下载量，但我从来没有从真正的潜在用户那里收到过抱怨，只有来自论坛上的其他开发人员或 IT 人员。（如果您的目标受众有很多人仍在使用拨号，那么您会遇到不同的问题，并且可能也没有 .net 3.5）

# objective-c - 编译器警告“来自不同目标 c 类型的赋值”

> ID：527411
> 
> 赞同：0
> 
> 时间：2009-02-09T08:26:02.730
> 
> 标签：objective-c, xcode, macos

我正在学习objective-c，通过Aaron Hillegass 的书“Mac OS X 的Cocoa 编程-第三版”工作。我正在 Xcode 中开发一些示例代码，并在此方法的最后一行不断收到编译器警告：

```
- (void) setEntryDate:(NSCalendarDate *) date {
    [date retain];
    [entryDate release];
    entryDate = date;
} 
```

警告内容为“警告：来自不同的 Objective-C 类型的分配”。是什么导致了这个警告？如何防止它再次发生？

它似乎不影响程序的执行，但我不明白问题是什么，或者即使真的有问题（这可能只是一个偏执的编译器吗？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T08:46:35.083

NSCalendar 和 NSCalendarDate 确实是不同的类型。您应该决定您希望 entryDate 是哪一个（可能是 NSCalendarDate，根据“日期”的事情来判断）。

# c++ - boost::function 和 boost::bind 是如何工作的

> ID：527413
> 
> 赞同：84
> 
> 时间：2009-02-09T08:28:45.063
> 
> 标签：c++, boost, boost-bind, boost-function

我不喜欢魔术盒散布在我的代码中......这两个类究竟如何工作以允许基本上任何函数映射到函数对象，即使函数<>具有与传递给的那个完全不同的参数集`boost::bind`

它甚至可以使用不同的调用约定（即成员方法`__thiscall`在 VC 下，但“普通”函数通常是`__cdecl`或`__stdcall`用于那些需要与 C 兼容的函数。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-02-09T12:40:47.390

`boost::function`允许将`operator()`具有正确签名的任何东西绑定为参数，并且可以使用参数调用绑定的结果`int`，因此可以将其绑定到`function<void(int)>`.

这就是它的工作原理（此描述同样适用于`std::function`）：

`boost::bind(&klass::member, instance, 0, _1)`返回一个像这样的对象

```
struct unspecified_type
{
  ... some members ...
  return_type operator()(int i) const { return instance->*&klass::member(0, i);
} 
```

其中`return_type`and`int`是从 的签名中推断出来的`klass::member`，而函数指针和绑定参数实际上存储在对象中，但这并不重要

现在，`boost::function`不进行任何类型检查：它将获取您在其模板参数中提供的任何对象和任何签名，并创建一个可根据您的签名调用的对象并调用该对象。如果这是不可能的，那就是编译错误。

`boost::function`实际上是这样的对象：

```
template <class Sig>
class function
{
  function_impl<Sig>* f;
public:
  return_type operator()(argument_type arg0) const { return (*f)(arg0); }
}; 
```

其中`return_type`and`argument_type`是从 中提取的`Sig`，并且`f`是在堆上动态分配的。这是允许具有不同大小的完全不相关的对象绑定到`boost::function`.

`function_impl`只是一个抽象类

```
template <class Sig>
class function_impl
{
public:
  virtual return_type operator()(argument_type arg0) const=0;
}; 
```

完成所有工作的类是派生自`boost::function`. 您分配给的每种类型的对象都有一个`boost::function`

```
template <class Sig, class Object>
class function_impl_concrete : public function_impl<Sig>
{
  Object o
public:
  virtual return_type operator()(argument_type arg0) const=0 { return o(arg0); }
}; 
```

这意味着在您的情况下，分配给 boost 功能：

1.  实例化一个类型`function_impl_concrete<void(int), unspecified_type>`（当然是编译时间）
2.  在堆上创建该类型的新对象
3.  将此对象分配给 boost::function 的 f 成员

当您调用函数对象时，它会调用其实现对象的虚函数，这会将调用定向到您的原始函数。

免责声明：请注意，此解释中的名称是故意编造的。任何与真实人物或角色的相似之处......你知道的。目的是说明原理。

# c# - 在 C# 中以编程方式检查 XML 文件格式良好的最快方法是什么？

> ID：527415
> 
> 赞同：6
> 
> 时间：2009-02-09T08:29:10.817
> 
> 标签：c#, xml, well-formed

我有大量手动更新的 XHTML 文件。在更新的审查阶段，我想以编程方式检查文件的格式是否正确。我目前正在使用**XmlReader**，但平均 CPU 所需的时间比我预期的要长得多。

XHTML 文件的大小从 4KB 到 40KB 不等，每个文件的验证需要几秒钟的时间。检查是必不可少的，但我希望尽可能缩短时间，因为在将文件读入下一个流程步骤时执行检查。

有没有一种更快的方法来进行简单的 XML 格式良好检查？也许使用外部 XML 库？

* * *

我可以确认使用 XmlReader 验证“常规”基于 XML 的内容非常快，并且正如建议的那样，问题似乎与每次验证文件时都会读取 XHTML DTD 的事实有关。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

请注意，除了 DTD 之外，还会下载相应的 .ent 文件（xhtml-lat1.ent、xhtml-symbol.ent、xhtml-special.ent）。

因为完全忽略 DTD 对于 XHTML 来说并不是一个真正的选择，因为格式正确与允许的 HTML 实体密切相关（例如，当我们忽略 DTD 时，  会立即引入验证错误）。

* * *

该问题通过按照建议使用**自定义 XmlResolver**并结合 DTD 和实体文件的本地（嵌入）副本来解决。

清理代码后，我将在此处发布解决方案

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T08:34:59.010

我希望这`XmlReader`将`while(reader.Read)() {}`是最快的*管理*方法。读取 40KB肯定不需要**几秒钟**...您使用的输入方法是什么？

您是否有一些外部（模式等）实体需要解决？如果是这样，您也许可以编写一个使用本地缓存模式而不是远程获取的自定义`XmlResolver`（通过设置）...`XmlReaderSettings`

以下内容几乎立即执行约 300KB：

```
 using(MemoryStream ms = new MemoryStream()) {
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.CloseOutput = false;
        using (XmlWriter writer = XmlWriter.Create(ms, settings))
        {
            writer.WriteStartElement("xml");
            for (int i = 0; i < 15000; i++)
            {
                writer.WriteElementString("value", i.ToString());
            }
            writer.WriteEndElement();
        }
        Console.WriteLine(ms.Length + " bytes");
        ms.Position = 0;
        int nodes = 0;
        Stopwatch watch = Stopwatch.StartNew();
        using (XmlReader reader = XmlReader.Create(ms))
        {
            while (reader.Read()) { nodes++; }
        }
        watch.Stop();
        Console.WriteLine("{0} nodes in {1}ms", nodes,
            watch.ElapsedMilliseconds);
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T08:40:35.797

`XmlReader`通过传入`XmlReaderSettings`具有`ConformanceLevel.Document`.

这将验证格式良好。

这个[MSDN 文章](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmlreadersettings.conformancelevel)应该解释细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T11:30:34.580

在我相当普通的笔记本电脑上，从头到尾读取一个 250K 的 XML 文档`XmlReader`需要 6 毫秒。除了解析 XML 之外，还有其他东西是罪魁祸首。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-11T02:35:41.117

我知道我在发帖，但我认为这可能是一个解决方案

1.  使用 HTML Tidy 清除您的 xml。设置删除文档类型的选项
2.  然后从 tidy 中读取生成的 xhtml/xml。

这是相同的代码

```
public void GetDocumentStructure(int documentID)
    {
        string scmRepoPath = ConfigurationManager.AppSettings["SCMRepositoryFolder"];
        string docFilePath = scmRepoPath + "\\" + documentID.ToString() + ".xml";

        string docFilePath2 = scmRepoPath + "\\" + documentID.ToString() + "_clean.xml";

        Tidy tidy = new Tidy();
        tidy.Options.MakeClean = true;
        tidy.Options.NumEntities = true;
        tidy.Options.Xhtml = true;
        // this option removes the DTD on the generated output of Tidy
        tidy.Options.DocType = DocType.Omit;

        FileStream input = new FileStream(docFilePath, FileMode.Open);            
        MemoryStream output = new MemoryStream();
        TidyMessageCollection msgs = new TidyMessageCollection();
        tidy.Parse(input, output, msgs);            
        output.Seek(0, SeekOrigin.Begin);

        XmlReader rd = XmlReader.Create(output);            
        int node = 0;

        System.Diagnostics.Stopwatch watch = System.Diagnostics.Stopwatch.StartNew();
        while (rd.Read())
        {                
            ++node;                
        }
        watch.Stop();

        Console.WriteLine("Duration was : " + watch.Elapsed.ToString());
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T15:52:01.690

正如其他人所提到的，瓶颈很可能不是 XmlReader。

检查您是否不会碰巧在没有字符串生成器的情况下进行大量字符串连接。

这真的可以摧毁你的表现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T04:40:14.650

就个人而言，我很懒……所以我寻找已经解决问题的 .NET 库。尝试使用该`DataSet.ReadXML()`函数并捕获异常。它在解释 XML 格式错误方面做得非常出色。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-15T20:14:54.613

我正在使用这个函数来验证字符串/片段

```
<Runtime.CompilerServices.Extension()>
Public Function IsValidXMLFragment(ByVal xmlFragment As String, Optional Strict As Boolean = False) As Boolean
    IsValidXMLFragment = True

    Dim NameTable As New Xml.NameTable

    Dim XmlNamespaceManager As New Xml.XmlNamespaceManager(NameTable)
    XmlNamespaceManager.AddNamespace("xsd", "http://www.w3.org/2001/XMLSchema")
    XmlNamespaceManager.AddNamespace("xsi", "http://www.w3.org/2001/XMLSchema-instance")

    Dim XmlParserContext As New Xml.XmlParserContext(Nothing, XmlNamespaceManager, Nothing, Xml.XmlSpace.None)

    Dim XmlReaderSettings As New Xml.XmlReaderSettings
    XmlReaderSettings.ConformanceLevel = Xml.ConformanceLevel.Fragment
    XmlReaderSettings.ValidationType = Xml.ValidationType.Schema
    If Strict Then
        XmlReaderSettings.ValidationFlags = (XmlReaderSettings.ValidationFlags Or XmlSchemaValidationFlags.ProcessInlineSchema)
        XmlReaderSettings.ValidationFlags = (XmlReaderSettings.ValidationFlags Or XmlSchemaValidationFlags.ReportValidationWarnings)
    Else
        XmlReaderSettings.ValidationFlags = XmlSchemaValidationFlags.None
        XmlReaderSettings.ValidationFlags = (XmlReaderSettings.ValidationFlags Or XmlSchemaValidationFlags.AllowXmlAttributes)
    End If

    AddHandler XmlReaderSettings.ValidationEventHandler, Sub() IsValidXMLFragment = False
    AddHandler XmlReaderSettings.ValidationEventHandler, AddressOf XMLValidationCallBack

    Dim XmlReader As Xml.XmlReader = Xml.XmlReader.Create(New IO.StringReader(xmlFragment), XmlReaderSettings, XmlParserContext)
    While XmlReader.Read
        'Read entire XML
    End While
End Function 
```

我正在使用此功能来验证文件：

```
Public Function IsValidXMLDocument(ByVal Path As String, Optional Strict As Boolean = False) As Boolean
    IsValidXMLDocument = IO.File.Exists(Path)
    If Not IsValidXMLDocument Then Exit Function

    Dim XmlReaderSettings As New Xml.XmlReaderSettings
    XmlReaderSettings.ConformanceLevel = Xml.ConformanceLevel.Document
    XmlReaderSettings.ValidationType = Xml.ValidationType.Schema
    If Strict Then
        XmlReaderSettings.ValidationFlags = (XmlReaderSettings.ValidationFlags Or XmlSchemaValidationFlags.ProcessInlineSchema)
        XmlReaderSettings.ValidationFlags = (XmlReaderSettings.ValidationFlags Or XmlSchemaValidationFlags.ReportValidationWarnings)
    Else
        XmlReaderSettings.ValidationFlags = XmlSchemaValidationFlags.None
        XmlReaderSettings.ValidationFlags = (XmlReaderSettings.ValidationFlags Or XmlSchemaValidationFlags.AllowXmlAttributes)
    End If
    XmlReaderSettings.CloseInput = True

    AddHandler XmlReaderSettings.ValidationEventHandler, Sub() IsValidXMLDocument = False
    AddHandler XmlReaderSettings.ValidationEventHandler, AddressOf XMLValidationCallBack

    Using FileStream As New IO.FileStream(Path, IO.FileMode.Open)
        Using XmlReader As Xml.XmlReader = Xml.XmlReader.Create(FileStream, XmlReaderSettings)
            While XmlReader.Read
                'Read entire XML
            End While
        End Using
    End Using
End Function 
```

# python - 输入和线程问题，python

> ID：527420
> 
> 赞同：0
> 
> 时间：2009-02-09T08:34:41.367
> 
> 标签：python, multithreading

我在 python 中做这样的事情

```
class MyThread ( threading.Thread ):
    def run (s):
        try:
            s.wantQuit = 0
            while(not s.wantQuit):
                button = raw_input()
                if button == "q":
                    s.wantQuit=1
        except KeyboardInterrupt:
            s.wantQuit = 1

myThread = MyThread ()
myThread.start()

a=5
while not myThread.wantQuit:
    print "hey"
    if (a == 0):
        break;
    a = a-1;
    time.sleep(1)
#"""
sys.exit() 
```

发生的情况是我的应用程序锁定 5 秒打印“嘿”（5 次）然后我得到 raw_input 对话框。我怎样才能显示对话框，以便我可以随时退出，而不是在循环用完时退出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T08:51:08.177

你的意思是while循环在线程之前运行？好吧，除非您同步它，否则您无法预测这一点。没有人保证线程会在该 while 循环之前或之后运行。但是如果它被阻塞了 5 秒，那就太糟糕了 - 到那时，线程应该已经被抢占了。

此外，由于您第一次使用 wantToQuit 是在 run() 方法中，所以当您检查它的 wantToQuit 属性时，没有人保证线程已经启动`while not myThread.wantToQuit`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T08:54:56.607

这里的行为不是你所描述的。看看我得到的那些示例输出：

`q<ENTER>`第一：尽可能快地按下：

```
hey
q 
```

第二：在按下之前稍等一下`q<ENTER>`：

```
hey
hey
hey
q 
```

第三：不要触摸键盘：

```
hey
hey
hey
hey
hey
hey
# Application locks because main thread is over but 
# there are other threads running. add myThread.wantQuit = 1
# to prevent that if you want 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T08:49:10.207

只是尝试了代码以确保，但这确实做了它应该做的事情......你可以输入 q 并进入控制台并使应用程序在 a=0 之前退出（所以它说嘿少于 5 次）

我不知道 raw_input 对话框是什么意思，raw_input 通常只从标准输入获取信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T14:09:03.030

huperboreean 有你的答案。执行 for 循环时，线程仍在启动中。

您想在进入循环之前检查线程是否已启动。您可以简化线程以监视 raw_input，并在输入“q”时返回。这将杀死线程。

您的 main for 循环可以检查线程是否处于活动状态。

# flash - Flash Player 信任文件不适用于 Linux 上的嵌入式浏览器

> ID：527425
> 
> 赞同：0
> 
> 时间：2009-02-09T08:43:30.470
> 
> 标签：flash, browser, xulrunner, trust

我有一个嵌入基于 xulrunner 的浏览器的应用程序。我必须在这个浏览器中加载一些 Flash 内容。在某些时间点，Flash 会更改我的 URL 和页面标题，以反映我所在的 Flash 文件中的位置。当我将信任文件放在 /etc/FlashPlayerTrust 文件夹中，其中包含目录条目和我想要信任的 swf 文件时，这在 Firefox 浏览器中运行良好。（根据 Flash 安全指南[http://www.adobe.com/ devnet/flashplayer/articles/flash_player_admin_guide/flash_player_admin_guide.pdf](http://www.adobe.com/devnet/flashplayer/articles/flash_player_admin_guide/flash_player_admin_guide.pdf) 全局信任文件应与包含 mms.cfg 文件的目录处于同一级别）。

但是当我从我的嵌入式浏览器加载 Flash 内容时，页面标题等不会得到更新。我也将我的应用程序名称添加到了 Flash Player 信任文件中。我尝试将我的内容放在服务器中并远程访问它，它在我的嵌入式浏览器中运行良好。只有当 Flash 内容在本地存在时，URL 和页面标题才不会更新。这让我相信问题出在 Flash 播放器信任文件上。我的信任文件内容如下：

/home/shivu/activitytest/index.html

/home/shivu/activitytest/gettingstarted.swf

/home/shivu/activitytest/

/home/shivu/app/lv71

这里 lv71 是具有嵌入式浏览器的应用程序的名称。我对全局和用户信任文件都进行了尝试，但它不起作用。有没有人知道可能出了什么问题以及我如何能够调试它。

感谢 jbsp72

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-16T16:48:48.630

对于安卓系统，路径为：

`/data/data/com.android.browser/app_plugins/com.adobe.flashplayer/.macromedia/Flash_Player/#Security/FlashPlayerTrust/yourfile`

我不得不手动创建`"#Security/FlashPlayerTrust"`路径的一部分。

**文件“yourfile”**的名称（包括扩展名）无关紧要。

这是其内容的示例行：

`/sdcard/html`

更新：叹息，这个技巧不再起作用，至少在 Android 2.2 上。使用 Flash Player 11.1.111.5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-20T16:19:36.497

我有同样的问题。在对 Adob​​e 痛哭、咬牙切齿和咒骂之后：解决方案。

对于后代，信任文件的正确位置是：

```
~/.macromedia/Flash_Player/#Security/FlashPlayerTrust/yourfile.cfg 
```

该文件中条目的格式为：

```
file:////path/to/swf/directory 
```

如果您愿意，当然也可以选择使用上述方案信任单个 .swf 文件。

谢谢：[http ://blog.vivoid.com/2009/03/flashplayertrust-not-working-try-adding-a-protocol-prefix/](http://blog.vivoid.com/2009/03/flashplayertrust-not-working-try-adding-a-protocol-prefix/)

不，谢谢：Adobe。

*后记：Adobe 文档省略了上述路径中的“Flash_Player”目录。作为参考，我使用的是全新安装的 Ubuntu 10.10，以及来自存储库的 flashplugin-nonfree v10.1.102.65ubuntu0.10.10.1。在 Web 上找到的相互矛盾的信息可能是由于不同发行版上的 Flash Player 包的差异引起的？*

# linq - Linq 是否包含在 .net 2010 中

> ID：527431
> 
> 赞同：1
> 
> 时间：2009-02-09T08:48:42.613
> 
> 标签：linq, visual-studio-2010, .net-4.0

Linq 是否包含在 .net 2010 中，即 .NET 4.0

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T08:52:55.317

是的。Visual Studio 2010 面向 .NET Framework 版本 4、3.5 和 2.0。LINQ 包含在针对 3.5 和 4 的项目中，没有理由认为它会在任何即将发布的版本中被删除。

可能令人困惑的是，LINQ to SQL 将来不会被积极开发。相反，微软鼓励开发人员使用实体框架。但是，LINQ to SQL 仍将是框架的一部分——它只是没有任何新功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T08:52:02.353

LINQ 包含在 2007 年 11 月 19 日发布的 .NET 3.5 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T08:52:45.160

那当然是。有太多的特性\技术与 Linq 紧密集成（ADO.NET 实体框架、Linq to SQL 等等）。Linq 是微软的一个主要方向，在如此积极地推动 Linq 前进之后，放弃 Linq 至少对他们来说是“奇怪的”。

# apache-flex - FLEX 中的重新调度事件

> ID：527438
> 
> 赞同：12
> 
> 时间：2009-02-09T08:51:18.127
> 
> 标签：apache-flex, actionscript-3, events, actionscript

在 FLEX 应用程序中，我试图“重新调度”自定义事件。即component1 执行dispatchEvnet(event)，component2 为该事件注册一个处理程序，该处理程序的唯一功能再次是dispatch(event)。最后，component3 监听来自 component2 的事件。我正在尝试做的类似于“重新抛出”异常的概念（并且出于类似的原因）。不同之处在于重新分派似乎在 AS3 (Flash 10) 中不起作用。在 IE 中，什么都没有发生，而在 FF3 中，有一个异常说类型转换失败，同时在 component3 中调用处理程序时尝试将 Event 类型强制转换为我的 CustomEvent。调试器中的跟踪代码显示，在调用 component3 时，该事件确实是一个通用事件，我的所有自定义内容都丢失了。应该是这样吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-09T09:01:47.323

您遇到的问题是由于未覆盖自定义事件中的[clone()事件引起的。](http://livedocs.adobe.com/flex/3/langref/flash/events/Event.html)

当事件被重新调度时，它们被克隆和修改。如果你不覆盖 clone()，你会得到 clone() 的基本实现，它返回一个事件。因为无法将 Event 转换为您的自定义事件类型，所以会引发运行时错误。

从文档中：

> 创建您自己的自定义 Event 类时，您必须重写继承的 Event.clone() 方法，以便它复制您的自定义类的属性。如果您没有设置在事件子类中添加的所有属性，那么当侦听器处理重新调度的事件时，这些属性将不会具有正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T06:21:43.533

更多见：[http ://casario.blogs.com/mmworld/2006/08/the_clone_metho.html](http://casario.blogs.com/mmworld/2006/08/the_clone_metho.html)

# iphone - 在iphone中查找本地IP地址

> ID：527439
> 
> 赞同：1
> 
> 时间：2009-02-09T08:51:21.263
> 
> 标签：iphone

> **可能重复：**
> [如何查询 iPhone 当前的 IP 地址？](https://stackoverflow.com/questions/260484/how-do-i-query-the-iphones-current-ip-address)

我正在尝试使用 gethostname/gethostbyname 查找本地 IP 地址，但这样做时我总是得到“无法解析”。

为什么会失败？有没有其他方法可以在 iphone 中获取本地 IP 地址？

多谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T11:23:38.090

```
 -(NSString*)getAddress {
          char iphone_ip[255];
          strcpy(iphone_ip,"127.0.0.1"); // if everything fails
          NSHost* myhost =[NSHost currentHost];
          if (myhost)
          {
              NSString *ad = [myhost address];
              if (ad)
                  strcpy(iphone_ip,[ad cStringUsingEncoding: NSISOLatin1StringEncoding]);
          }

          return [NSString stringWithFormat:@"%s",iphone_ip]; 
     } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T17:19:21.323

除了这里的其他答案，我建议查看 ADC 站点上的可达性示例代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T12:41:15.547

我在 Erica Sadun 书中找到了使用 gethostname/gethostbyname 的解决方案。诀窍是在调用 gethostbyname 之前将“.local”后缀附加到主机名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T12:19:14.673

值得注意的是，许多运营商（尤其是“第一世界”之外的运营商）分发 RFC1918（通常是 10.0.0.0/8）地址，因此向其中一个服务发出 HTTP 请求可能会更好（当然，除了许多运营商，出于必要，对大型 NAT 池使用多个公共地址）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T07:36:09.320

NSHost 在 iPhone OS 库中找不到，它存在于 Mac OS 核心库中。

我收到 2 个警告

“警告：找不到'+currentHost'方法”“警告：找不到'-address'方法”

有什么办法可以消除这些警告？？？

# html - 如何判断字符串是否为网址？

> ID：527446
> 
> 赞同：2
> 
> 时间：2009-02-09T08:55:36.980
> 
> 标签：html, url

确定字符串是否代表网址的最佳方法是什么？我需要让用户在表单中输入网址，但如何验证输入？应该允许用户输入诸如“ [http://www.google.com](http://www.google.com) ”或“www.vg.no”之类的字符串，但不应要求他输入“http://”。此外，还有一些像“tv2.no”这样的网页更难验证。如果我检查字符串是否包含“www”或“http://”，我有一个强有力的线索，但我仍然不能 100% 确定。我能百分百确定吗？我不这么认为，但也许这里的一些优秀思想可以启发我？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T09:14:05.967

为随后的表达道歉，但它似乎涵盖了大多数（如果不是全部）案例：

```
^(?#Protocol)(?:(?:ht|f)tp(?:s?)\:\/\/|~/|/)?(?#Username:Password)(?:\w+:\w­+@)?
(?#Subdomains)(?:(?:[-\w]+\.)+(?#TopLevel Domains)
(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum|travel|[­a-z]{2}))(?#Port)
(?::[\d]{1,5})?(?#Directories)(?:(?:(?:/(?:[-\w~!$+|.,=]|%­[a-f\d]{2})+)+|/)+|\?|#)?
(?#Query)(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(­?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)
(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=(?:[-\w­~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?#Anchor)
(?:#(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})+­)?(?#What not to end in)[^.!,:;?]$ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T09:07:37.620

首先，尝试使用正则表达式验证输入文本是否是格式正确的 URL。如果检查正常，请尝试 DNS 查找以验证主机是否已知。不要忘记 localhost 或 127.0.0.1 的特殊情况。还要注意由 IP 地址指定的主机。如果这些检查正常，您可能需要尝试实际连接。

如果这些检查失败，您可以修改输入文本并再次检查。可能的修改包括：

*   前置`http://`
*   前置`www.`
*   附加`.com`, `.org`, `.net`, 不管
*   附加`:8080`, `:8888`, 随便
*   混合上述任何解决方案
*   尝试也预先`file:///`准备本地访问

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T09:09:11.127

请注意，以下两个也是有效的网址。你想允许他们吗？

*   `localhost`
*   `208.77.188.166`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T09:35:58.940

My recommendation would be to not validate exactly at all. Instead, use a regular expression based approach, and if that doesn't match you can give a soft warning: "what you wrote doesn't look like a valid address. are you sure this is what you want to write?".

Definitely do not follow the idea of trying to connect to the address. That would open you up for all kinds of nasty security problems, including having your web site used for denial-of-service attacks against other web sites. That would land you in legal trouble.

Doing a DNS lookup is costly, but viable if you deem it's worth the cost.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T08:57:19.190

使用[正则表达式](http://immike.net/blog/2007/04/06/5-regular-expressions-every-web-programmer-should-know/)怎么样？

确切的实施方式将取决于您使用的语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T08:58:26.207

合理确定的最简单方法是使用正则表达式，以确保您至少拥有域名的两个组成部分。这样你就可以处理最糟糕的情况。它应该看起来像这样：

```
/^(http:\/\/)?(\w+)(\.\w+)+$/ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T08:59:44.347

如果您不打算将其强制为有效的 URI（即您将方案设为可选），那么唯一真正的选择是尝试通过 HTTP 连接到它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-09T09:09:50.017

您能否从您的应用程序中进行 DNS 查找，这将绕过任何“我不确定它是否是真实地址”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-09T09:13:04.847

您可以使用[Zend_Uri的验证功能](http://framework.zend.com/manual/en/zend.uri.html#zend.uri.validation)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-09T08:59:42.740

如果您不想要求他们输入 http://（或 https://），那么您真正可以继续的唯一事情是字符串是否包含“。” （我假设您不需要处理“内部”服务器？）。您还可以针对已知域进行验证并检查无效字符，但除此之外几乎所有事情都可以进行。

至于实际实施，如果您能忍受，正则表达式将是您的最佳选择。毫无疑问，如果您使用 Google 来验证 URL，那么您将有无数的例子。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T09:06:06.580

我认为最快的方法是通过正则表达式测试。然而，这并不能证明它是否是一个有效的 URL

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T09:09:02.080

请参阅CPAN 上的[Regexp::Common](http://search.cpan.org/~abigail/Regexp-Common-2.122/lib/Regexp/Common.pm)，尤其是[R::C::URI](http://search.cpan.org/~abigail/Regexp-Common-2.122/lib/Regexp/Common/URI.pm)和[R::C::URI::http](http://search.cpan.org/~abigail/Regexp-Common-2.122/lib/Regexp/Common/URI/http.pm)。即使您不能使用模块本身，源代码中也有正则表达式。这是一个好的开始。

# c# - 将对象转换为十进制？（可为空的小数）

> ID：527453
> 
> 赞同：34
> 
> 时间：2009-02-09T08:59:40.103
> 
> 标签：c#, .net, casting, nullable

如果在属性的设置器中有这个：

```
decimal? temp = value as decimal?; 
```

值 = "90"

但是在演员表之后， temp 为**空**......

做这个演员的正确方法是什么？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-09T09:02:23.967

仅当类型相同时，拆箱才有效！您不能将`object`不包含目标值的内容拆箱。你需要的是类似的东西

```
decimal tmpvalue;
decimal? result = decimal.TryParse((string)value, out tmpvalue) ?
                  tmpvalue : (decimal?)null; 
```

这将查看该值是否可解析为`decimal`. 如果是，则将其分配给`result`; 否则分配`null`. 以下代码的作用大致相同，对于不熟悉条件运算符的人来说可能更容易理解`?:`：

```
decimal tmpvalue;
decimal? result = null;
if (decimal.TryParse((string)value, out tmpvalue))
    result = tmpvalue; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T09:06:27.093

你应该解析小数。但是，如果您希望您的小数在字符串不正确时为空，请使用 TryParse ：

```
decimal parsedValue;
decimal? temp = decimal.TryParse(value, out parsedValue)
                ? value
                : (decimal?)null; 
```

这样，您将在解析格式错误的字符串时避免异常。

几乎所有原始类型都提供了 Parse 和 TryParse 方法来从字符串转换。

还建议将提供程序参数的区域性传递给方法，以避免小数分隔符出现问题。如果您从另一个系统读取，CultureInfo.InvariantCulture 可能是要走的路（但它不是默认的）。

```
bool TryParse(string s, NumberStyles style,
  IFormatProvider provider, out decimal result) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-28T09:46:46.583

如果您不想解析字符串，但想确保接收到`null`a`decimal`或 nullable `decimal`，那么您可以执行以下操作：

```
public static Nullable<T> Convert<T>(object input) 
    where T : struct
{
    if (input == null)
        return null;
    if (input is Nullable<T> || input is T)
        return (Nullable<T>)input;
    throw new InvalidCastException();
} 
```

如果您希望避免异常，您可以让它在最后一行返回 null，尽管这不会区分真正的 null 值和错误的强制转换。

请注意，您必须使用“is”运算符，因为“as”运算符不适用于值类型，并且未经检查的强制转换可能会引发 InvalidCastException。

您也可以将其设为扩展方法：

```
public static class ObjectExtensions
{
    public static Nullable<T> ToNullable<T>(this object input)
        where T : struct
    {
        if (input == null)
            return null;
        if (input is Nullable<T> || input is T)
            return (Nullable<T>)input;
        throw new InvalidCastException();
    }
} 
```

并像这样使用它：

```
object value = 123.45m;
decimal? dec = value.ToNullable<decimal>(); 
```

这将有助于避免有关取消装箱空引用的代码合同警告。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T09:02:43.013

如果你使用`decimal? temp = (decimal?)value;`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-08-12T02:00:58.717

令人惊讶的是，但好的旧`System.Convert.ToDecimal(myNullableDoubleBoxedInObject)`作品完美无缺：

```
decimal? myNullableDecimal = 0.15m;
object myNullableDoubleBoxedInObject = myNullableDouble ;
decimal myDecimal = System.Convert.ToDouble(myNullableDoubleBoxedInObject); 
```

# jquery - jQuery 中的 SimpleModal

> ID：527457
> 
> 赞同：0
> 
> 时间：2009-02-09T09:00:42.740
> 
> 标签：jquery, redirect, simplemodal

我在 jQuery 中使用 SimpleModal，并使用 Ajax 来显示单选按钮。它应该列出单选按钮和值。单击单选按钮后，页面将被重定向到 page2。

当我在 localhost 上测试它时，一切都很好。但它不会重定向 Web 服务器上的页面。

我应该做些什么改变？

我的代码：

```
..............
$.ajax({
    url: 'test.php',
    cache: false,
    success: function(data) {
        $('#resp').modal({
            close: false,
            position: ["4%",],
            overlayId: 'confirmRespOverlay',
            containerId: 'confirmRespContainer',
            onShow: function (second) {
                second.data.find(".buttons .yes").hide();
                var resp = $("<div/>").append(data);
                var title = resp.find("#title").html(),
                message = resp.find("#message").html();
                second.data.find(".header span").html(title);
                second.data.find('.info').append(message);
                second.data.find('.yes').click(function () {
                });
            }//onShow
        }); //Resp

        $("input:radio").click(function() {
            var url="http://page2"
            window.location.replace(url);
        }); //input
    }//success
}); //ajax 
```

test.php 返回以下

```
echo "<tr><td><input type=\"radio\" name=\"value_\" onClick=\"showUser(this.value)\" value=".$id1.">".$val1."</td><td>".$name."</td></tr>";

echo "<tr><td><input type=\"radio\" name=\"value_\" onClick=\"showUser(this.value)\" value=".$id2.">".$val2."</td><td>".$name."</td></tr>"; 
```

单击单选按钮后页面停止并且不会移动到下一页。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T20:27:37.703

在我看来，您在注册事件时尚未添加您的输入。

有两种选择，一种是在显示之前将您的数据加载到模态中（即绕过您的 onshow 方法）

```
$.ajax({ 
   url: 'test.php', 
   cache: false, 
   success: function(data) { 
       var second = $('#resp');
       second.data.find(".buttons .yes").hide();
       var resp = $("<div/>").append(data);
       var title = resp.find("#title").html();
       message = resp.find("#message").html();
       second.data.find(".header span").html(title);
       second.data.find('.info').append(message);
       second.data.find('.yes').click(function () {
       }); // click

       $('#resp').modal({
          close:false,
          position: ["4%",],
          overlayId:'confirmRespOverlay',
          containerId:'confirmRespContainer'
        }); //Resp

       $("input:radio").click(function() {
            var url="http://page2"
            window.location.replace(url);
       }); //input 

  }//success 

}); //ajax 
```

或者在 onshow 方法中注册你的事件

```
$.ajax({ 
   url: 'test.php', 
   cache: false, 
   success: function(data) { 

       $('#resp').modal({
          close:false,
          position: ["4%",],
          overlayId:'confirmRespOverlay',
          containerId:'confirmRespContainer', 
          onShow: function (second) { 
                    second.data.find(".buttons .yes").hide();
                    var resp = $("<div/>").append(data);
                    var title = resp.find("#title").html();
                    message = resp.find("#message").html();
                    second.data.find(".header span").html(title);
                    second.data.find('.info').append(message);
                    second.data.find('.yes').click(function () {
                     });

                    $("input:radio").click(function() {
                      var url="http://page2"
                      window.location.replace(url);
                    }); //input 
          }//onShow

        }); //Resp

  }//success 

}); //ajax 
```

# asp.net-mvc - 如何使用 Asp.net MVC 和 javascript 在页面加载中获取 ViewData

> ID：527462
> 
> 赞同：1
> 
> 时间：2009-02-09T09:02:04.873
> 
> 标签：asp.net-mvc

如何使用 Asp.net MVC 和 javascript 在加载的页面中获取 ViewData？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:15:56.447

您不需要 ASP.NET MVC 中的页面加载方法。视图数据和模型都可以`ViewPage`直接通过`ViewData`属性在 MVC 中访问，因为`Controller`馈送视图页面的`ViewData`.

假设您`MyController`参与`MyProject/Controllers/MyController`了以下操作：

```
public ActionResult Do() {
    ViewData["MyInt"] = 64;
    ViewData["MyString"] = "MyString";
    return View();
} 
```

在您的`Do`视图中，`MyProject/Views/My/Do.aspx`您可以直接访问视图数据：

```
<%= ViewData["MyInt"] %>
<%= ViewData["MyString"] %> 
```

您也可以在代码隐藏文件中访问它们，因为 viewpage 继承自`System.Web.Mvc.ViewPage`该`ViewData`属性。[你可以在这里](http://www.asp.net/learn/mvc/tutorial-04-cs.aspx)阅读更多关于它的信息。

# javascript - jQuery 手动调整大小的 DIV

> ID：527468
> 
> 赞同：4
> 
> 时间：2009-02-09T09:03:44.697
> 
> 标签：javascript, jquery, resize

我正在尝试在不使用 jQuery 的界面库的情况下创建一个可调整大小的 div。

```
var myY = 0;
var mouseDown = false;
var originalHeight = 0; 

function resize(e){
    if(mouseDown == true){
        $("#cooldiv").height(originalHeight+e.pageY-myY);
    }
} 

$(document).ready(function(){
    $().mouseup(function(e){
        myY = 0;
        mouseDown = false;
        originalHeight = 0;
        $().unbind("mousemove", resize);
    });

    $("#resizeBar").mousedown(function(e){
        myY = e.pageY;
        originalHeight = $("#cooldiv").height();
        mouseDown = true;
        $().bind("mousemove", resize);
    });
}); 
```

...

```
<div id="cooldiv" style="width: 500px; height: 300px; background-color: #cccccc; position: relative;">
<div id="resizeBar" style="height: 10px; width: 500px; background-color: #aaaaaa; position: absolute; bottom: 0;"></div>
</div> 
```

第一次调整大小可以正常工作（即 mousedown、mousemove 然后 mouseup），但在随后的 (mousedown+mousemove) 上，浏览器会尝试拖动整个 resizeBar div，而不是正确调整其父容器的大小。在 mouseup 上，div 然后开始在 mousemove 上调整“cooldiv”的大小，而不需要任何 mousedown，直到再次单击鼠标。

这些问题不会出现在 Internet Explorer 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T19:18:25.537

尝试添加

```
$("#cooldiv").focus(); 
```

到 mouseup 函数的末尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-20T06:36:36.253

这是一个使用“hr”标签作为分隔符的示例（在 2 个 div 之间）：

```
<div>Text here</div>
<hr />
<div>Other text</div> 
```

Javascript：（使用 JQuery）：

```
var hr = null;
$("hr").mousedown(function(e) {
    hr = {
        y : e.pageY,
        p : $(this).prev(),
        n : $(this).next(),
        ph: $(this).prev().height(),
        nh: $(this).next().height()
    };
    e.preventDefault();
});
$(document).mousemove(function(e) {
    if(hr) {
        hr.p.height(hr.ph+(e.pageY - hr.y));
        hr.n.height(hr.nh-(e.pageY - hr.y));
    }
    e.preventDefault();
}).mouseup(function(e) {
    hr = null;
    e.preventDefault();
}); 
```

CSS（可选）：

```
hr {
    background-color: #DDD;
    border: 1px solid #AAA;
    cursor: n-resize;
    height: 10px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-09T16:02:30.763

我偶尔能够打破调整大小的功能，在那里我会得到“不允许”光标并且框不会动态调整大小，尽管当我放开鼠标时它会适当地调整大小并保持这种状态。

添加`return false;`到`resize`函数的末尾似乎可以阻止浏览器尝试选择/拖动调整大小栏。我在有限的环境中工作，所以我只能使用 ie8（以及 ie7 模式下的 ie8）进行测试。

我不得不将您的电话替换为`$()`以`$(document)`使其正常工作。我还建议将`mousemove`绑定移出`mousedown`处理程序，并删除解除绑定调用。

# iphone - 在 iPhone 应用程序中使用 xcode 读取 Cookie

> ID：527470
> 
> 赞同：0
> 
> 时间：2009-02-09T09:04:25.070
> 
> 标签：iphone, xcode

我的应用程序需要能够读取 UIWebView 中加载的页面存储的 cookie。我需要能够使用 xcode 读取 cookie，以便可以在应用程序设置中存储一些值。有谁知道是否可以使用 xcode 读取 cookie？非常感谢您的帮助。多年来一直坚持这一点。托尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:26:27.683

您可以使用[NSHTTPCookieStorage](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSHTTPCookieStorage_Class/)来读取/修改 cookie。`UIWebView`正在使用此存储。

# c# - 生成日期时间（exp：09.02.2009）到字符串日期（exp：星期一）

> ID：527474
> 
> 赞同：1
> 
> 时间：2009-02-09T09:06:13.490
> 
> 标签：c#, .net, datetime, date

我正在尝试学习或生成任何代码来学习字符串`day("26.02.2009")`---> 给我“星期三”

我需要 C# 中的静态日期函数。

例如：

```
datetime Str_day= Returnstringdate("09.02.2009");  ---->Str_day="Monday";

Returnstringdate("09.02.2009")

{
     it must return Monday!!!
} 
```

或者

```
Returnstringdate("09.02.2009 12:30:32")

{
     it must return Monday!!!
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T09:08:42.283

[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)允许您指定要解析的日期的确切格式。然后，您可以使用`ToString("dddd")`以字符串形式返回星期几。

```
DateTime date = DateTime.ParseExact("09.02.2009", "dd.MM.yyyy", 
    CultureInfo.InvariantCulture);

string dayOfWeek = date.ToString("dddd"); 
```

或者，您可以使用[`DayOfWeek`](http://msdn.microsoft.com/en-us/library/system.datetime.dayofweek.aspx)返回[`System.DayOfWeek`](http://msdn.microsoft.com/en-us/library/system.dayofweek.aspx)枚举值的属性。

```
DateTime date = DateTime.ParseExact("09.02.2009", "dd.MM.yyyy", 
    CultureInfo.InvariantCulture);

DayOfWeek day = date.DayOfWeek;
string dayString = day.ToString("G"); 
```

尽管第二个选项会将星期几作为未本地化的（英语）字符串生成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T09:09:11.097

```
 DayOfWeek day = DateTime.ParseExact(
        "26.02.2009", "dd.MM.yyyy", CultureInfo.InvariantCulture).DayOfWeek;
    string dayString = day.ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:12:27.687

使用`DateTime.DayOfWeek`DateTime 对象上的属性。

另请参阅[此线程](https://stackoverflow.com/questions/520163/learning-days-c)。

# xml - 如何使用 XML 创建日历

> ID：527477
> 
> 赞同：-2
> 
> 时间：2009-02-09T09:07:15.313
> 
> 标签：xml

如何使用 XML 创建日历

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:26:54.407

“使用 xml”创建日历的一种方法是使用**配置 xml 文件**，例如这个[flash Calendar](http://www.flashcomponents.net/component/flash_calendar_xml.html?ref=phils)，其中所有图像和文本都是从易于编辑的 XML 文件加载的。

然而，简单的 ini 文件可能同样有效，并且更易于编辑；）

您可能会想到一些表示日历的 xml 格式，知道[XSD 可能会将其](http://www.stylusstudio.com/xsllist/200408/post70290.html)转换为日历，但为此，我们应该更多地了解您预期的输出格式。

例如，Microsoft 确实有一个[Calendar 元素，当您以 XML 格式保存项目时，它表示日历数据。](http://msdn.microsoft.com/en-us/library/bb968563.aspx)
这可以为您提供此类数据的 xml 格式的一个很好的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-25T06:51:09.207

```
I tried this code

    <CalendarView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:id="@+id/calendarView"
        android:layout_weight="1" /> 
```

# open-source - 开源应用演示层架构

> ID：527480
> 
> 赞同：3
> 
> 时间：2009-02-09T09:08:48.523
> 
> 标签：open-source

你们中的许多人都会同意，从开源项目中学习是提高编程技能的另一种方式。我能否列出最能展示层架构使用的开源应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T09:15:27.773

我猜[JBoss](http://www.jboss.com/products/jbossas/architecture)是多层架构的一个很好的例子......

[![替代文字](https://i.stack.imgur.com/ovJ5n.gif)](https://i.stack.imgur.com/ovJ5n.gif)
[（来源：[jboss.com](http://www.jboss.com/images/appInstrumentation.gif)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T09:23:52.903

我不确定它是否完全符合您的需求，但 Ignite Realtime 的[Openfire Server](http://www.igniterealtime.org/projects/openfire/index.jsp)的源代码组织得非常好。很高兴根据我几年前工作的公司的需要修改它的来源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:25:21.353

这取决于您希望看到什么样的应用程序。如果我们谈论 Web 应用程序，我发现 Kigg 是分层架构的一个很好的例子。它是用 asp.net mvc 编写的，并且很好地分离了关注点\职责。

# javascript - DHTML 菜单不显示

> ID：527484
> 
> 赞同：1
> 
> 时间：2009-02-09T09:09:17.290
> 
> 标签：javascript, dhtml

我正在尝试使用 DHTML 显示菜单，但出现 JavaScript 错误并且菜单未显示。

```
<script language="JavaScript" 
    vqp_datafile0="Welcome to Epicenter Fitness_files/epicenter_nav.js"
    vqp_uid0="61625" 
    vqptag="doc_level_settings">
    cdd__codebase = "Welcome to Epicenter Fitness_files/";
    cdd__codebase61625 = "Welcome to Epicenter Fitness_files/";
</script>

<script language="JavaScript"  
        src="Welcome to Epicenter Fitness_files/epicenter_nav.js" 
        vqptag="datafile"> 
</script>

<script language="JavaScript"  
        vqp_menuid="61625"  
        vqptag="placement">
    create_menu(61625)
</script> 
```

当我查看 Firefox 时，它说`create_menu`找不到该功能。

是`create_menu`内置的 DHTML 功能吗？

我的所有 JS 文件，包括`epicenter_nav.js`文件（包含显示菜单和子菜单的代码）都保存在文件夹下`D:\Welcome to Epicenter Fitness_files`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T09:18:59.467

该文件是否位于 D:\ 的根目录下？因为路径`"Welcome to Epicenter Fitness_files/epicenter_nav.js"`是相对于当前文件的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T09:34:06.527

您的服务器可能无法处理 url 中的空格 - 尝试将您的目录（和引用）重命名为 Welcome_to_Epicenter_Fitness_files

**编辑：**另外，这看起来像用 IE 或 Firefox 保存的网页的目录结构（另存为完整网页）。我不确定所有 JS 都以这种方式保存。包含文件肯定不会保存，所以请仔细检查您的 JS 文件是否包含上述功能。

# c# - C#：Enum.IsDefined 在组合标志上

> ID：527486
> 
> 赞同：19
> 
> 时间：2009-02-09T09:09:58.817
> 
> 标签：c#, enums, constraints

我有这个枚举：

```
[Flags]
public enum ExportFormat
{
    None = 0,
    Csv = 1,
    Tsv = 2,
    Excel = 4,
    All = Excel | Csv | Tsv
} 
```

我正在尝试对此（或任何真正的）枚举进行包装，以通知更改。目前它看起来像这样：

```
public class NotifyingEnum<T> : INotifyPropertyChanged
    where T : struct
{
    private T value;

    public event PropertyChangedEventHandler PropertyChanged;

    public NotifyingEnum()
    {
        if (!typeof (T).IsEnum)
            throw new ArgumentException("Type T must be an Enum");
    }

    public T Value
    {
        get { return value; }
        set
        {
            if (!Enum.IsDefined(typeof (T), value))
                throw new ArgumentOutOfRangeException("value", value, "Value not defined in enum, " + typeof (T).Name);

            if (!this.value.Equals(value))
            {
                this.value = value;

                PropertyChangedEventHandler handler = PropertyChanged;
                if (handler != null)
                    handler(this, new PropertyChangedEventArgs("Value"));
            }
        }
    }
} 
```

由于实际上可以为枚举分配任何值，因此我想检查给定的值是否已定义。但是我发现了一个问题。如果我在这里给它一个由例如组成的枚举`Csv | Excel`，那么`Enum.IsDefined`将返回`false`。显然是因为我没有定义任何由这两个组成的枚举。我想这在某种程度上是合乎逻辑的，但是我应该如何检查给定值是否有效？换句话说，要让它工作，我需要用什么交换下面的行？

```
if (!Enum.IsDefined(typeof (T), value)) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-01-12T00:01:49.683

我们知道转换为字符串的枚举值永远不会以数字开头，但具有无效值的枚举值总是会。这是最简单的解决方案：

```
public static bool IsDefinedEx(this Enum yourEnum)
{
    char firstDigit = yourEnum.ToString()[0];
    if (Char.IsDigit(firstDigit) || firstDigit == '-')  // Account for signed enums too..
        return false;

    return true;
} 
```

使用该扩展方法而不是股票 IsDefined 应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-09T09:22:06.073

使用基于标志的枚举，它是关于是否设置位。因此对于“ExportFormat”，如果设置了第 1 位，则它是 CSV 格式，即使可能设置了更多位。位 1 和 2 是否设置了无效值？这是主观的：从作为一个组的值的角度来看，它是无效的（没有为第 1 位和第 2 位设置定义位模式）但是，由于每个值都是一个位，单独查看它们，可能是设置了位 1 和 2 的值是有效的。

如果传入值 0011111011，这是一个有效值吗？好吧，这取决于您要查找的内容：如果您正在查看整个值，那么它是一个无效值，但如果您正在查看单个位，这是一个好的值：它设置了未设置的位已定义，但这没关系，因为基于标志的枚举是“按位”检查的：您不是在将它们与一个值进行比较，而是在检查是否设置了一个位。

因此，由于您的逻辑将检查设置了哪些位以选择要选择的格式，因此实际上没有必要检查枚举值是否已定义：您有 3 种格式：如果设置了相应格式的位，则格式为选择。这就是你应该写的逻辑。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T09:22:08.287

我将在位级别上进行操作，并检查新值中设置的所有位是否都设置在您的`All`值中：

```
if ( ! (All & NewValue) == NewValue ) 
```

您将不得不看看自己如何最好地做到这一点，也许您需要将所有值转换为 int 然后进行按位比较。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-12T00:22:15.477

[这](http://blogs.microsoft.co.il/blogs/shimmy/archive/2012/01/12/enum-isdefined-for-combined-values-not-declared-in-the-enum-body.aspx "Enum.IsDefined 用于未在枚举主体中声明的组合值")是一个有效的小扩展方法。

```
static void Main(string[] args)
{
  var x = ExportFormat.Csv | ExportFormat.Excel;
  var y = ExportFormat.Csv | ExportFormat.Word;
  var z = (ExportFormat)16; //undefined value

  var xx = x.IsDefined();  //true
  var yy = y.IsDefined();  //false
  var zz = z.IsDefined();  //false
}

public static bool IsDefined(this Enum value)
{
  if (value == null) return false;
  foreach (Enum item in Enum.GetValues(value.GetType()))
    if (item.HasFlag(value)) return true;
  return false;
}

[Flags]
public enum ExportFormat                                      
{
  None = 0,
  Csv = 1,
  Tsv = 2,
  Excel = 4,
  Word = 8,
  All = Excel | Csv | Tsv
} 
```

以下方法适用于未在枚举中分组的按代码组合的项目：

```
static void Main(string[] args)
{
  var x = ExportFormat.Csv | ExportFormat.Excel;
  var y = ExportFormat.Csv | ExportFormat.Word;
  var z = (ExportFormat)16; //undefined value

  var xx = x.IsDefined();  //true
  var yy = y.IsDefined();  //true
  var zz = z.IsDefined();  //false
}

public static bool IsDefined(this ExportFormat value)
{
  var max = Enum.GetValues(typeof(ExportFormat)).Cast<ExportFormat>()
    .Aggregate((e1,e2) =>  e1 | e2);
  return (max & value) == value;
} 
```

如果您使用的是支持 DLR 的 C# 4.0，您可以使用以下很酷的不可知扩展方法：

```
public static bool IsDefined(this Enum value)
{
  dynamic dyn = value;
  var max = Enum.GetValues(value.GetType()).Cast<dynamic>().
    Aggregate((e1,e2) =>  e1 | e2);
  return (max & dyn) == dyn;
} 
```

注意 - 必须这样做，因为：

1.  运算符`|`and`&`不能应用于类型`Enum`和的操作数`Enum`
2.  这些运算符是在编译器中定义的并且没有被反射，所以没有办法用反射/Linq 表达式来检索它们，相信我 - 我已经尝试了这一切......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-12-03T13:58:16.000

```
[Flags] enum E { None = 0, A = '1', B = '2', C = '4' }

public static bool IsDefined<T>(T value) where T : Enum
{
    var values = Enum.GetValues(typeof(T)).OfType<dynamic>().Aggregate((e1, e2) => (e1 | e2));

    return (values & value) == value;
}

// IsDefined(ExportFormat.Csv); // => True
// IsDefined(ExportFormat.All); // => True
// IsDefined(ExportFormat.All | ExportFormat.None); // => True
// IsDefined(ExportFormat.All | ExportFormat.Csv); // => True
// IsDefined((ExportFormat)16); // => False
// IsDefined((ExportFormat)int.MaxValue); // => False

// IsDefined(E.A); // => True
// IsDefined(E.A | E.B); // => True
// IsDefined((E)('1' | '2')); // => True
// IsDefined((E)('5')); // => True
// IsDefined((E)5); // => True
// IsDefined((E)8); // => False
// IsDefined((E)int.MaxValue); // => False 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-12-03T11:12:06.143

枚举值的任何有效组合都会产生一个非数字值：

```
public static class EnumExtensions
{
    public static bool IsDefined(this Enum value) => !ulong.TryParse(value.ToString(), out _);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T10:50:00.947

也许尝试用解析捕获？
您不想传递哪些值？

```
 public T Value
    {
        get { return value; }
        set
        {
            try
            {
                Enum.Parse(typeof(T), value.ToString());
            }
            catch 
            {
                throw new ArgumentOutOfRangeException("value", value, "Value not defined in enum, " + typeof(T).Name);
            }
            if (!this.value.Equals(value))
            {
                this.value = value;

                PropertyChangedEventHandler handler = PropertyChanged;
                if (handler != null)
                    handler(this, new PropertyChangedEventArgs("Value"));
            }
        }
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-11T17:54:21.700

我知道这个帖子已经有一段时间没有得到回答了，但我认为使用内置函数回答它对于那些在我之后访问它的人来说是件好事。

使用 OP 的原始枚举，您可以使用以下代码解析位掩码值。

```
 ExportFormat format;
    if (!Enum.TryParse<ExportFormat>(value.ToString(), out format))
    {
      // Could not parse
    } 
```

希望有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-03-19T14:32:07.400

这是一种方法（使用Linq）：

```
 private static bool IsDefined<T>(long value) where T : struct
    {
        var max = Enum.GetValues(typeof(T)).Cast<T>()
            .Select(v => Convert.ToInt64(v)).
            Aggregate((e1, e2) => e1 | e2);
        return (max & value) == value;
    } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-11-22T10:27:46.177

看一下[Enums.NET](https://github.com/TylerBrinkley/Enums.NET)库的[IsValid](https://github.com/TylerBrinkley/Enums.NET/blob/master/Src/Enums.NET/Enums.cs#L554)方法：

```
var validExportFormat = ExportFormat.Excel | ExportFormat.Csv;
validExportFormat.IsValid(EnumValidation.IsValidFlagCombination); // => true

var invalidExportFormat = (ExportFormat)100;
invalidExportFormat.IsValid(EnumValidation.IsValidFlagCombination); // => false 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T09:15:46.120

见[这里](http://www.codeproject.com/KB/cs/ExtendEnum.aspx)。相当多的代码。

# c# - 代表如何工作（在后台）？

> ID：527489
> 
> 赞同：8
> 
> 时间：2009-02-09T09:11:34.553
> 
> 标签：c#, delegates

委托在 C# 中是如何在幕后工作的以及如何有效地使用它们？

编辑：我知道它们在表面上是如何工作的（它们基本上是函数指针，并允许使用它们的地址调用具有某些签名的回调方法）。我需要知道的是 CLR 如何在内部实际实现它们。当您定义委托以及使用委托对象调用回调方法时，幕后究竟发生了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T09:18:05.397

重新效率 - 不清楚你的意思，但它们可用于通过避免昂贵的反射来*实现*效率。例如，通过使用`Delegate.CreateDelegate`为动态/查找方法创建（类型化的）预检查委托，而不是使用 (slower) `MethodInfo.Invoke`。

对于一个简单的例子（访问一个类型的静态`T Parse(string)`模式），见下文。请注意，它只使用一次反射（每种类型），而不是很多次。这应该胜过反射或典型`TypeConverter`用法：

```
using System;
using System.Reflection;
static class Program { // formatted for space
    static void Main() {
        // do this in a loop to see benefit...
        int i = Test<int>.Parse("123");
        float f = Test<float>.Parse("123.45");
    }
}
static class Test<T> {
    public static T Parse(string text) { return parse(text); }
    static readonly Func<string, T> parse;
    static Test() {
        try {
            MethodInfo method = typeof(T).GetMethod("Parse",
                BindingFlags.Public | BindingFlags.Static,
                null, new Type[] { typeof(string) }, null);
            parse = (Func<string, T>) Delegate.CreateDelegate(
                typeof(Func<string, T>), method);
        } catch (Exception ex) {
            string msg = ex.Message;
            parse = delegate { throw new NotSupportedException(msg); };
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T09:14:51.113

问题的第一部分相对简单：委托存储函数指针列表。如果您调用委托，它会调用该内部列表中的所有函数指针。添加和删​​除接收器（通过[`Delegate.Combine`](http://msdn.microsoft.com/en-us/library/system.delegate.combine(VS.80).aspx)和[`Delegate.Remove`](http://msdn.microsoft.com/en-us/library/system.delegate.remove(VS.80).aspx)）相当于添加到该列表和从该列表中删除。

有关更多底层信息，请参阅[ECMA-335](http://www.ecma-international.org/publications/standards/Ecma-335.htm)（CLI 标准）、第 II.14.5 节（方法指针）和 II.14.6（委托）。特别要注意，委托由实例指针（类型`System.Object`）和方法指针（类型`System.IntPtr`）组成。可以通过`ldftn`or `ldvirtftn`（对于虚函数调用）指令（在 CIL 中）获得方法指针。

这两条信息标识了任何方法。

> 如何有效地使用它们？

你是什​​么意思？您了解事件还是您的问题更专业？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-28T11:08:07.437

当你定义你的委托时

```
internal delegate void Feedback(Int32 value); 
```

编译器实际上定义了一个完整的类，看起来像这样：

```
internal class Feedback : System.MulticastDelegate {  
   // Constructor  
   public Feedback(Object object, IntPtr method);  

   // Method with same prototype as specified by the source code  
   public virtual void Invoke(Int32 value);  

   // Methods allowing the callback to be called asynchronously  
   public virtual IAsyncResult BeginInvoke(Int32 value,  AsyncCallback callback, Object object);  

   public virtual void EndInvoke(IAsyncResult result);  
} 
```

资料来源：[Jeffrey Richter - CLR 通过 C#](http://shop.oreilly.com/product/9780735627048.do)，第 17 章

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T09:18:20.980

C# 中的委托是方法指针的列表。即它们存储对代码的引用，您可以通过指针调用方法。这在很多情况下都很有用。常见的例子是使用委托来实现发布者/订阅者模式的事件处理程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T09:20:00.510

当您创建委托时，C# 编译器会生成一个完整的类。正如 Konrad 所提到的，这个类包含一个函数引用列表。委托的好处在于，它们为您提供了一种简单的方法来通过通知回调异步执行任务。这意味着您可以在后台操作完成时收到通知。线程池不提供此功能。代表是一个广泛的话题，我发现 Jeff Richter（通过 C# 的 CLR）和 Albahari (C#3) 的书籍特别有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T09:25:01.963

C# 委托是封装对对象和方法指针的引用的对象（检查 System.Delegate 类）。它们还可以对对象有一个空引用来表示对静态方法的调用。

当使用参数调用委托时，委托会使用指定的参数对被引用对象上的被引用方法进行调用。

编译的委托 Invoke 方法由运行时直接处理（与反射器可见）：

```
[MethodImpl(0, MethodCodeType=MethodCodeType.Runtime)]
public virtual void Invoke(T obj); 
```

运行时使用内部的所有信息来编译对引用方法的标准方法调用。

# sharepoint - “NewWeb”和“Blank”配置在 WSS 站点定义中有什么意义

> ID：527493
> 
> 赞同：3
> 
> 时间：2009-02-09T09:12:27.813
> 
> 标签：sharepoint, wss-3.0

我通过调整其中一个内置定义来自定义 WSS 站点定义。在检查 sts 定义时，我看到它有一个 ID 为 -1 的配置“NewWeb”，以及 ID 为 1 的“Blank”。在 sps 定义中，这些定义如下：

```
<Configuration ID="-1" Name="NewWeb"/>
<Configuration ID="1" Name="Blank">
  <ExecuteUrl Url="_layouts/[%=Web.Language%]/settings.aspx" />
</Configuration> 
```

有谁知道这些有什么意义？我应该将它们包含在我的自定义定义中，还是可以安全地忽略它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:32:41.837

NewWeb 是没有与之关联的模板的 Web。本质上，只是一个预配置的 URL。

BlankWeb 是一个没有指定列表或库的模板

# project-management - 一个项目应该在向后兼容性上花费多少时间和精力？

> ID：527499
> 
> 赞同：8
> 
> 时间：2009-02-09T09:15:28.570
> 
> 标签：project-management, backwards-compatibility

鉴于每个软件项目只有这么多的程序员时间专门用于它，你会花多少钱来确保产品与以前的版本向后兼容？其实有几点需要考虑：

*   软件的年龄会影响您的决定吗？当程序更新时，您会在向后兼容性上投入更少的时间吗？
*   该决定是否仅基于已安装副本的客户端数量？
*   您是否积极努力生成支持未来更改的代码和文件格式？
*   当您开发 v1.0 时，您是否尝试构建以使 v2.0 更容易向后兼容 v1.0？（留下“保留”字段就是一个例子。）
*   您如何决定在功能上“不，我们将不再支持它”？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T09:33:58.197

客户群是决定您是否应该支持大的向后兼容性问题的关键。

基本上，您需要像您需要实现的任何其他**非功能性需求**一样评估它，并且您需要仔细指定[“向后兼容性”功能](http://www.onlamp.com/pub/a/onlamp/2005/02/17/backwardscompatibility.html)中包含的内容：

*   **API 兼容性**。这意味着库的后续版本提供与之前版本相同的 API，因此针对之前版本编写的程序仍然能够使用新版本编译和运行。除了实际上保留相同的功能外，这还意味着这些功能在新版本中的作用与在旧版本中所做的相同
*   **应用程序二进制接口或 ABI 兼容性**。这意味着在编译库时生成的二进制目标代码级别保留了向后兼容性。
    API 和 ABI 兼容性之间通常有一些重叠，但也有重要的区别。为了保持 ABI 兼容性，您所要做的就是确保您的程序导出所有相同的符号。
    这意味着所有相同的功能和全局可访问的对象都需要在那里，以便与先前版本链接的程序仍然能够与新版本一起运行。
    *在破坏 API 兼容性的同时保持 ABI 兼容性是可能的*. 在 C 代码中，将符号保留在 C 文件中，但从公共头文件中删除它们，因此尝试访问符号的新代码将无法编译，而用户针对先前版本编译的旧代码将继续运行
*   **客户端-服务器协议兼容性**。这意味着使用较旧版本中提供的网络协议版本的客户端在面对较新的服务器时将继续运行，而较新的客户端程序将继续与较旧的服务器一起使用。
*   **数据格式兼容性**。新版本的代码需要能够处理旧版本写出的数据文件，反之亦然。理想情况下，您还应该能够为数据格式构建一些前向兼容性。如果您的文件处理例程可以忽略并保留无法识别的字段，那么新功能可以以不破坏旧版本的方式修改数据格式。这是最关键的兼容性之一，因为用户在安装新版本的程序时会变得非常不安，突然无法访问他们的旧数据。

如果您将先前的标准（向后兼容性的性质）与您的客户群的性质结合起来，您可以决定：

*   如果您的客户是公司内部的，则需求会降低，并且 2.0 可能会破坏重要功能。

*   如果您的客户是外部客户，2.0 版可能仍会破坏，但您可能需要[提供迁移指南](http://www.eclipse.org/eclipse/development/eclipse_project_plan_3_4.html#Compatibility)

*   在极端情况下，如果您的客户是全世界，正如我在这个**[关于 java 的 SO 问题](https://stackoverflow.com/questions/314540)**中已经提到的那样，您最终可能会提供新功能而不会弃用旧功能！甚至**[保留旧产品](http://ianmurdock.com/2007/01/14/on-the-importance-of-backward-compatibility/)**的错误，因为客户的应用程序取决于这些错误！

* * *

*   软件的年龄会影响您的决定吗？当程序更新时，您会在向后兼容性上投入更少的时间吗？
    我相信这与已经部署的内容有关：与大约 20 年前的程序相比，最近的程序必须处理更少的向后兼容性需求。

*   该决定是否仅基于已安装副本的客户端数量？
    它应该基于业务案例：您的迁移（如果由于缺乏向后兼容性而需要）是否能够有效地“出售”给您的客户（因为它带来了所有新的闪亮功能？）

*   您是否积极努力生成支持未来更改的代码和文件格式？
    试图预测“未来的变化”可能会适得其反，并且很快就会接近 YAGNI（你不需要它）：一套好的迁移工具可能会更有效。

*   当您开发 v1.0 时，您是否尝试构建以使 v2.0 更容易向后兼容 v1.0？（留下“保留”字段就是一个例子。）
    对于我工作过的*内部应用程序，没有。*[并行运行](http://wiki.answers.com/Q/What_is_parallel_run_of_a_software)是我们确保“功能性”向后兼容性的方法。但这不是一个普遍的解决方案。

*   您如何决定在功能上“不，我们将不再支持它”？
    同样，对于*内部*应用程序，决策过程可能与外部部署的决策过程非常不同。如果某项功能没有为业务带来任何附加值，则设置一个内部“一致性”任务来与每个其他内部应用程序检查其迁移成本（即“不再使用此功能”）。与组织外部的客户执行相同的任务要困难得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T09:40:46.793

您的系统每天使用的越多，您就越应该关注它。

您的系统越深入地嵌入客户的核心流程中，您就越应该关注它。

您的系统拥有的竞争对手越多，您就越应该关注它。

使用旧版本的用户越多，您就越应该关注它。

客户对您的系统的购买越复杂，越深入，就您的软件对其业务的影响而言，您应该越关注向后兼容性。

如果您无法通过有吸引力的定价等方式帮助他们升级到新版本，那么可能值得考虑强迫所有人升级的风险。

像 Vista 或 Office 2007。这些对我到 Apple 的帮助非常好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T09:31:04.990

我对软件向后兼容性的看法：

1.）如果它已经被许多客户广泛​​使用，那么我会确保该产品的新版本仍然使用相同的“基本代码”（实现正在开发的应用程序的基本功能的代码）。新功能应纳入此代码库或构建在此代码库之上，并且在此应用程序的执行环境中需要尽可能少的更改。您不想让现有用户在其现有安装中执行大量更改。因此，它需要在支持新功能和改进客户现有设置和使用过程之间进行权衡。

2.)在新产品中，如果可能的话，甚至在 v1.0 发布之前，一开始就确定该应用程序的所有可能功能。确定您将在 v1.0 中发布哪些功能。以及哪些将保留以供以后发布。在设计、代码实现、最终确定应用程序的输出以适应未来版本的功能时，请尽可能记住这些“后期功能”。例如，在您的数据结构中保留额外的元素/位字段。

-广告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T09:36:30.813

很多。如果您不想惹恼您的每一位忠实客户！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-25T02:28:10.430

我的经验是使用相对较少（100 - 5000）用户的复杂收缩包装系统。
市场营销人员通常对向后兼容性持有一种态度，而没有充分了解生命周期成本。例如，为当前用户群维护系统中的错误所节省的费用很容易与系统生命周期内新用户的支持成本相比相形见绌。

# asp.net-mvc - 类型存在于两个库中

> ID：527500
> 
> 赞同：0
> 
> 时间：2009-02-09T09:15:44.623
> 
> 标签：asp.net-mvc, namespaces, linq-to-lucene, pagedlist

我正在尝试将[Linq 与 Lucene](http://www.codeplex.com/linqtolucene)合并到我的 Asp.net-mvc 项目中。
与大多数 Web 项目一样，我使用放在我的个人帮助程序库中的[PagedList类型并在所有地方使用它。](http://www.squaredroot.com/post/2008/07/08/PagedList-Strikes-Back.aspx)
但是 Linq to Lucene 也是如此......由于我的库和 L2L 库都希望将 PagedList 类型添加到 System.Collections.Generic 命名空间，因此我收到一条冲突消息。

有没有办法解决这个冲突而不必重写我的项目或 L2L 项目？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:21:52.627

将类型添加到 .NET BCL 命名空间通常不是一个好主意，因为它不会给您带来任何好处，并且从长远来看会导致重大麻烦。所以建议可能是将你的帮助类移出`System.Collections.Generic`命名空间。

# python - 如何部署以库为源的 Python 应用程序而没有进一步的依赖关系？

> ID：527510
> 
> 赞同：13
> 
> 时间：2009-02-09T09:20:17.030
> 
> 标签：python, deployment, layout, bootstrapping

**背景**：我有一个小型 Python 应用程序，它使在我们公司发布软件的开发人员的生活变得更加轻松。我使用 py2exe 为 Windows 构建了一个可执行文件。应用程序和二进制文件被检入 Subversion。分发是由人们从 SVN 中签出目录进行的。该程序有大约 6 个不同的 Python 库依赖项（例如 ElementTree、Mako）

**情况**：开发人员希望破解此工具的源代码，然后运行它而无需构建二进制文件。目前这意味着他们需要一个 python 2.6 解释器（这很好）并且还使用 easy_install 在本地安装了 6 个库。

**问题**

*   这不是一个公共的、经典的开源环境：我在一个公司网络中，该工具永远不会离开“围墙花园”，而且我们在访问外部互联网时遇到了严重不便的障碍（NTLM 身份验证代理和/或机器没有直接上网）。
*   我希望开始破解这个工具的障碍最小：没有人应该在正确的版本中寻找正确的依赖项，他们应该执行尽可能少的设置。最好的先决条件是安装 Python 并从 Subversion 中检出程序。

**轶事**：过程越独立，就越容易重复。我把我的机器换​​成了一台新机器，然后经历了一个令人不快的过程，不得不对依赖项进行逆向工程，重新安装 distutils，在线搜索库并让它们安装（参见上面的公司互联网限制）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T09:28:04.793

只需使用[virtualenv](http://pypi.python.org/pypi/virtualenv) - 它是创建隔离 Python 环境的工具。如果需要，您可以创建一个设置脚本并分发整个脚本。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-09T12:01:16.050

“我不喜欢这样一个事实，即开发人员（或者我从一台干净的新机器上开始）必须跳过 distutils 的束缚，在他们开始之前必须在本地安装库”

为什么？

什么 - 具体来说 - 这有什么问题？

您这样做是为了创建项目。你的项目很受欢迎，其他人也想做同样的事情。

我看不出有什么问题。请用您需要解决的具体问题更新您的问题。不喜欢开源的分发方式不是问题——这是开源的工作方式。

**编辑**. “围墙花园”并不重要。

选择 1。顺便说一句，您可以为他们构建一个运行 easy_install 6 次的“安装程序”。

选择 2。您可以保存 easy_install 将使用的所有安装工具包。然后，您可以提供一个脚本，`python setup.py install`对所有六个进行解压缩和一个。

选择 3。您可以提供压缩版本的`site-packages`. 安装 Python 后，他们会将您的站点包目录解压缩到“C:\Python2.5\lib\site-packages”。

选择 4。您可以为自己的 Python 环境构建自己的 MSI 安装程序工具包。

选择 5。您可以托管自己的类似 pypi 的服务器，并提供一个 easy_install 来首先检查您的服务器。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T13:05:46.567

我有时会使用我在下面描述的方法，原因与@Boris 所说的完全相同：我希望使用一些代码就像 a) svn checkout/update - b) go 一样简单。

但为了记录：

*   我大部分时间都使用 virtualenv/easy_install。
*   我在一定程度上同意@Ali A 和@S.Lott 的批评

无论如何，我使用的方法取决于修改 sys.path，并且工作方式如下：

*   在将使用您的软件的所有计算机上都需要 python 和 setuptools（以启用从鸡蛋中加载代码）。
*   组织你的目录结构：

```
项目/
    *.py
    脚本customize.py
    文件.pth

    第三方/
        蛋/
            mako-vNNN.egg
            ... 。蛋
        代码/
            元素树\
                *.py
            ...

```

*   在您的顶级脚本中，在顶部包含以下代码：

```
从脚本自定义导入 apply_pth_files
apply_pth_files(__file__)

```

*   将 scriptcustomize.py 添加到您的项目文件夹中：

```
导入操作系统
从全局导入全局
导入文件输入
导入系统

def apply_pth_files(scriptfilename, at_beginning=False):
    """在脚本的顶部：
    从脚本自定义导入 apply_pth_files
    apply_pth_files(__file__)

    """
    目录 = os.path.dirname（脚本文件名）
    文件 = glob（os.path.join（目录，'*.pth'））
    如果不是文件：
        返回
    对于 fileinput.input(files) 中的行：
        line = line.strip()
        如果 line 和 line[0] != '#':
            路径 = os.path.join（目录，行）
            如果在_beginning：
                sys.path.insert(0, 路径)
            别的：
                sys.path.append(路径)

```

*   将一个或多个 *.pth 文件添加到您的项目文件夹中。在每一行，放置一个对包含包的目录的引用。例如：

```
# *.pth 文件的内容
第三方/代码
第三方/eggs/mako-vNNN.egg

```

*   我“有点”喜欢这种方法。我喜欢什么：它类似于 *.pth 文件的工作方式，但适用于单个程序而不是整个站点包。我不喜欢的是：必须在顶级脚本的开头添加两行。
*   再说一遍：我大部分时间都使用 virtualenv。但我倾向于将 virtualenv 用于我严格控制部署场景的项目。在我没有严格控制的情况下，我倾向于使用我上面描述的方法。它使得将项目打包为 zip 并让最终用户“安装”它（通过解压缩）变得非常容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T12:24:30.020

我同意 Nosklo 和 S.Lott 的回答。（+1 两者）

我可以补充一点，您想要做的实际上是一个**糟糕的主意**。

如果您真的希望人们破解您的代码，他们将需要了解所涉及的库、它们是如何工作的、它们是什么、它们来自哪里、每个文件的文档等。当然要为他们提供引导脚本，但不限于此你会溺爱到他们毫无头绪的地步。

然后是一些具体的问题，例如“如果一个用户想要安装不同版本或库的实现怎么办？”，这里一个明显的例子是 ElementTree，因为它有许多实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T01:01:51.540

我并不是说这是一个好主意，但通常我在这种情况下所做的是我有一个 Makefile，检查到 subversion，其中包含获取所有依赖库并安装它们的 make 规则。makefile 可以足够智能，仅在依赖库不存在时才应用它们，因此这可能相对较快。

该项目的新开发人员只需从 subversion 中签出，然后键入“make”。

这种方法可能对你很有效，因为你的听众已经习惯了在他们的获取过程中使用 subversion checkout 的想法。此外，它还具有很好的特性，即有关您的程序的所有知识，包括其外部依赖项，都可以在源代码存储库中捕获。

# linq - 在数据库中查询邮政编码 n 英里内的记录的最佳方法是什么？

> ID：527512
> 
> 赞同：6
> 
> 时间：2009-02-09T09:21:29.320
> 
> 标签：linq, sql-server-2008, zipcode, spatial-query

我的数据库中有一个记录列表，每条记录都与一个邮政编码相关联。

查询数据库中的所有记录以查找另一个邮政编码 n 英里范围内的所有条目的“最佳实践”是什么？

每个邮政编码在数据库中都有一个与之关联的纬度/经度，所以我知道我必须使用它。但是，我无法想象在每对邮政编码上运行任何类型的距离公式，转换为英里并拒绝那些不在我半径范围内的。

对于这样一个常见的查询，这似乎在计算上非常昂贵。

我也考虑过进行全对预计算，但它似乎也太大而无法考虑。美国大约有 40,000 个邮政编码。因此，每个邮政编码的所有配对数据库将是 (40,000)^2，即 16 亿个条目。

我知道这是网站上的一个常见问题，所以希望有人可以为我指明正确的方向以找到最佳方法。我正在使用**SQL Server 2008**，如果有预构建的解决方案，那就太好了，因为我真的**不想**在这种情况下重新发明轮子。

* * *

相关问题：[获取半径内的所有邮政编码](https://stackoverflow.com/questions/326991/getting-all-zip-codes-within-an-n-mile-radius)（这对我没有帮助）
另外，我知道这个[SourceForge](http://sourceforge.net/projects/zips/)项目，但它已被遗弃且不再使用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T10:04:21.680

我将运行一个查询，返回包含在包含径向搜索圈的方形信封中的所有记录（minlat < lat < maxlat 和 minlong < long < maxlong），然后对其进行后处理以仅返回半径圈内的点本身。（确保您的 lat 和 long 字段已编入索引）。

如果你想花点心思，SQL Server 支持[空间索引](http://technet.microsoft.com/en-us/library/bb964712.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T20:21:30.543

我运行[一个站点，该站点需要每个用户每秒运行一次此查询](http://www.blogabond.com/WorldBrowser.aspx)，这就是我所学到的：

首先，确保您的位置表具有纬度和经度的索引。如果您有数百万条记录，这就是 20 毫秒和 15 秒响应时间之间的差异。

从边界框查询开始，以获得一组可使用的位置。然后计算这些距离，排序，如果你对准确性很挑剔，过滤掉一些。

坦率地说，我不会担心预先计算任何东西。就像我说的，我对一个有 6,000,000 个条目的位置表运行这种类型的查询，它通常会在 <50 毫秒内返回结果。根据您的需要，这确实足够快。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:27:05.157

这实际上是一个非常难以解决的问题。我建议您通过预先创建数据库来进行一些作弊。创建一个您需要找到的任何类型的网格，例如，在每个方向上每 10 英里，为该网格点和距离的每个 zip 添加一个条目到数据库中，然后当查询进来时，您首先将查询点转换为您的一个网格点。现在你可以很容易地查看距离。

这种解决方案基本上意味着以空间换时间，因此您可以快速获得一个相当大的数据库。好消息是：索引数据非常容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T20:38:17.353

您应该查看[GeoNames.org](http://www.geonames.org)。您可以查询他们的网络服务以[查找](http://www.geonames.org/export/web-services.html)您要查找的内容，或者您​​可以访问他们的数据库。

# c# - 使用命令行参数从 C# 执行 PowerShell 脚本

> ID：527513
> 
> 赞同：120
> 
> 时间：2009-02-09T09:21:33.517
> 
> 标签：c#, command-line, powershell, scripting, arguments

我需要从 C# 中执行 PowerShell 脚本。该脚本需要命令行参数。

这是我到目前为止所做的：

```
RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
runspace.Open();

RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);

Pipeline pipeline = runspace.CreatePipeline();
pipeline.Commands.Add(scriptFile);

// Execute PowerShell script
results = pipeline.Invoke(); 
```

scriptFile 包含类似“C:\Program Files\MyProgram\Whatever.ps1”的内容。

该脚本使用命令行参数，例如“-key Value”，而 Value 可以是也可能包含空格的路径。

我不让这个工作。有谁知道如何从 C# 中将命令行参数传递给 PowerShell 脚本并确保空格没有问题？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-02-09T10:15:06.133

尝试将脚本文件创建为单独的命令：

```
Command myCommand = new Command(scriptfile); 
```

然后你可以添加参数

```
CommandParameter testParam = new CommandParameter("key","value");
myCommand.Parameters.Add(testParam); 
```

最后

```
pipeline.Commands.Add(myCommand); 
```

* * *

***这是完整的编辑代码：***

```
RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
runspace.Open();

Pipeline pipeline = runspace.CreatePipeline();

//Here's how you add a new script with arguments
Command myCommand = new Command(scriptfile);
CommandParameter testParam = new CommandParameter("key","value");
myCommand.Parameters.Add(testParam);

pipeline.Commands.Add(myCommand);

// Execute PowerShell script
results = pipeline.Invoke(); 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2010-12-23T16:43:03.587

我有另一个解决方案。我只想测试执行 PowerShell 脚本是否成功，因为也许有人可能会更改策略。作为参数，我只是指定要执行的脚本的路径。

```
ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.FileName = @"powershell.exe";
startInfo.Arguments = @"& 'c:\Scripts\test.ps1'";
startInfo.RedirectStandardOutput = true;
startInfo.RedirectStandardError = true;
startInfo.UseShellExecute = false;
startInfo.CreateNoWindow = true;
Process process = new Process();
process.StartInfo = startInfo;
process.Start();

string output = process.StandardOutput.ReadToEnd();
Assert.IsTrue(output.Contains("StringToBeVerifiedInAUnitTest"));

string errors = process.StandardError.ReadToEnd();
Assert.IsTrue(string.IsNullOrEmpty(errors)); 
```

脚本的内容是：

```
$someVariable = "StringToBeVerifiedInAUnitTest"
$someVariable 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-12-10T21:03:05.807

我在将参数传递给 Commands.AddScript 方法时遇到了麻烦。

```
C:\Foo1.PS1 Hello World Hunger
C:\Foo2.PS1 Hello World

scriptFile = "C:\Foo1.PS1"

parameters = "parm1 parm2 parm3" ... variable length of params 
```

我通过将`null`名称和参数作为值传递给一个集合来解决这个问题`CommandParameters`

这是我的功能：

```
private static void RunPowershellScript(string scriptFile, string scriptParameters)
{
    RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();
    Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
    runspace.Open();
    RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);
    Pipeline pipeline = runspace.CreatePipeline();
    Command scriptCommand = new Command(scriptFile);
    Collection<CommandParameter> commandParameters = new Collection<CommandParameter>();
    foreach (string scriptParameter in scriptParameters.Split(' '))
    {
        CommandParameter commandParm = new CommandParameter(null, scriptParameter);
        commandParameters.Add(commandParm);
        scriptCommand.Parameters.Add(commandParm);
    }
    pipeline.Commands.Add(scriptCommand);
    Collection<PSObject> psObjects;
    psObjects = pipeline.Invoke();
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-09-11T15:43:56.667

我的更小更简单：

```
/// <summary>
/// Runs a PowerShell script taking it's path and parameters.
/// </summary>
/// <param name="scriptFullPath">The full file path for the .ps1 file.</param>
/// <param name="parameters">The parameters for the script, can be null.</param>
/// <returns>The output from the PowerShell execution.</returns>
public static ICollection<PSObject> RunScript(string scriptFullPath, ICollection<CommandParameter> parameters = null)
{
    var runspace = RunspaceFactory.CreateRunspace();
    runspace.Open();
    var pipeline = runspace.CreatePipeline();
    var cmd = new Command(scriptFullPath);
    if (parameters != null)
    {
        foreach (var p in parameters)
        {
            cmd.Parameters.Add(p);
        }
    }
    pipeline.Commands.Add(cmd);
    var results = pipeline.Invoke();
    pipeline.Dispose();
    runspace.Dispose();
    return results;
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-09T22:48:13.123

您也可以只使用带有 AddScript 方法的管道：

```
string cmdArg = ".\script.ps1 -foo bar"            
Collection<PSObject> psresults;
using (Pipeline pipeline = _runspace.CreatePipeline())
            {
                pipeline.Commands.AddScript(cmdArg);
                pipeline.Commands[0].MergeMyResults(PipelineResultTypes.Error, PipelineResultTypes.Output);
                psresults = pipeline.Invoke();
            }
return psresults; 
```

它将接受一个字符串，以及您传递给它的任何参数。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-07-09T13:48:32.190

对我来说，从 C# 运行 PowerShell 脚本最灵活的方法是使用`PowerShell.Create().AddScript()`

代码片段是

```
string scriptDirectory = Path.GetDirectoryName(
    ConfigurationManager.AppSettings["PathToTechOpsTooling"]);

var script =    
    "Set-Location " + scriptDirectory + Environment.NewLine +
    "Import-Module .\\script.psd1" + Environment.NewLine +
    "$data = Import-Csv -Path " + tempCsvFile + " -Encoding UTF8" + 
        Environment.NewLine +
    "New-Registration -server " + dbServer + " -DBName " + dbName + 
       " -Username \"" + user.Username + "\" + -Users $userData";

_powershell = PowerShell.Create().AddScript(script);
_powershell.Invoke<User>();
foreach (var errorRecord in _powershell.Streams.Error)
    Console.WriteLine(errorRecord); 
```

您可以通过检查 Streams.Error 来检查是否有任何错误。检查收藏真的很方便。用户是 PowerShell 脚本返回的对象类型。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-12-01T10:01:58.920

如果您使用，这是一种将参数添加到脚本的方法

```
pipeline.Commands.AddScript(Script); 
```

这是使用 HashMap 作为参数，键是脚本中变量的名称，值是变量的值。

```
pipeline.Commands.AddScript(script));
FillVariables(pipeline, scriptParameter);
Collection<PSObject> results = pipeline.Invoke(); 
```

而填充变量的方法是：

```
private static void FillVariables(Pipeline pipeline, Hashtable scriptParameters)
{
  // Add additional variables to PowerShell
  if (scriptParameters != null)
  {
    foreach (DictionaryEntry entry in scriptParameters)
    {
      CommandParameter Param = new CommandParameter(entry.Key as String, entry.Value);
      pipeline.Commands[0].Parameters.Add(Param);
    }
  }
} 
```

这样您就可以轻松地将多个参数添加到脚本中。我还注意到，如果您想从脚本中的变量中获取值，如下所示：

```
Object resultcollection = runspace.SessionStateProxy.GetVariable("results"); 
```

//结果是v的名字

您必须按照我展示的方式进行操作，因为出于某种原因，如果您按照 Kosi2801 建议的脚本变量列表不会填充您自己的变量的方式进行操作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-12T18:38:53.873

这对我有用，包括参数包含空格的情况：

```
using (PowerShell PowerShellInst = PowerShell.Create())
        {

            PowerShell ps = PowerShell.Create();

            string param1= "my param";
            string param2= "another param";
            string scriptPath = <path to script>;

            ps.AddScript(File.ReadAllText(scriptPath));

            ps.AddArgument(param1);
            ps.AddArgument(param2);

            ps.Invoke();

        } 
```

我发现这种方法非常容易理解并且非常清晰。

# strong-typing - 你封装标量吗？

> ID：527525
> 
> 赞同：2
> 
> 时间：2009-02-09T09:25:43.070
> 
> 标签：strong-typing, granularity

我发现自己定义了如下类：

```
struct AngleSize {
    explicit AngleSize(double radians) : size(radians) {}
    double size;
}; 
```

与将角度尺寸存储为普通双精度数相比，这具有许多优势。

**优点 1**，它可以定义这 2 个不同的构造函数：

```
Vec2::Vec2(double x, double y);
Vec2::Vec2(double length, AngleSize direction); 
```

...后一个明确称为`Vec2(1, AngleSize(5));`
（尽管在这种情况下，静态工厂函数`Vec2::fromPolar(1, 5)`可能同样好？）

**优点 2**，它更类型安全，捕获以下错误：

```
double temperature = air.getTemperature();
Vec2 v(someLength, temperature); 
```

然而一切都不是很好。

**缺点1**、冗长且出人意料的语法

```
Vec2::Vec2(double length, AngleSize direction) {
    x = length * cos(direction.size);
    y = length * sin(direction.size);
} 
```

呃，这真的应该说`cos(direction)`在不允许不安全的隐式转换的情况下，我需要详细地访问实际值。

**缺点2**，*每件事的课程太多*，你在哪里画线？

```
struct Direction { // angle between line and horizontal axis
    explicit Direction(AngleSize angleSize);
    AngleSize angleSize;
};

struct Angle { // defined by "starting and ending angle" unlike AngleSize
    Angle(Direction startingDir, Direction endingDir);
    Angle(Direction startingDir, AngleSize size);
    Angle(Line line1, Line line2);
};

struct PositionedAngle {
    // angle defined by two rays. this is getting just silly
    PositionedAngle(Ray firstRay, AngleSize angle);
    PositionedAngle(Point center, AngleSize fromAngle, AngleSize toAngle);
    // and so on, and so forth.
};
// each of those being a legit math concept with
// distinct operations possible on it. 
```

**在这种情况下，你自己会怎么做？**

另外，我在哪里可以阅读有关此问题的信息？我想`boost`可能有什么相关的？

请注意，这不仅仅是几何，它适用于任何地方。想想posix socklen_t ...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T09:41:38.210

只要有意义，我就会这样做。与[如何使错误的代码看起来不正确？您使用什么模式来避免语义错误？](https://stackoverflow.com/questions/26086/how-do-you-make-wrong-code-look-wrong-what-patterns-do-you-use-to-avoid-semantic/26174#26174).

在 Joel 的文章示例中，他讨论了两种情况：

*   需要在输出前清理字符串的 Web 应用程序的情况。他提出类型前缀来区分类型。但是，我认为简单地定义两种不同的字符串类型要好得多。最简单的方法就是引入一个`SafeString`类型。只有这种类型可以直接发送给客户端。必须转换正常的字符串类型（显式或隐式转换；在这种情况下无关紧要，因为隐式转换仍然可以清理字符串）。

*   程序员需要区分屏幕坐标和文档坐标的 Microsoft Word 示例。这是两个不同类型提供很多优势的经典案例，即使这些类型几乎相同（它们都描述了 2D 点）。

为了解决你的缺点：

> 缺点1、冗长且出人意料的语法

大多数语言实际上允许以使类使用预期语法的方式重载函数/运算符。在 C++ 中，这甚至是最佳实践：“让你自己的类型表现得像`int`s”。通常，这不需要在存在适当重载的情况下进行隐式强制转换。

> 缺点2，每件事的课程太多，你在哪里画线？

根据需要制作尽可能多的自定义类型（但不是更多）。一些语言，例如 Haskell，实际上鼓励类型的扩散。唯一让我们对像 C++ 这样的语言犹豫不决的是懒惰，因为我们必须编写大量样板代码。C++0x 通过引入类型安全的类型别名使这变得稍微容易一些。

当然，总是需要权衡取舍。但是，我相信只要有任何一个优势适用于您，这个劣势就可以简单地平衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T09:34:22.597

我不这样做，因为它带来的微小优势，我会发现它过于冗长和复杂。我有时会做一个简单`typedef`的事情来使事情更容易阅读，但仅此而已。

# php - Linux下如何处理重复代码？

> ID：527526
> 
> 赞同：5
> 
> 时间：2009-02-09T09:25:50.603
> 
> 标签：php, linux, copy-paste, code-duplication

我正在寻找处理具有大约 150k 行代码的遗留 PHP 项目中重复代码的最佳方法。

这是最好的手动方法还是有独立的重复代码检测器可以减轻痛苦？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T12:11:14.357

正如其他答案已经提到的那样，这应该手动处理，因为您可能希望在进行过程中更改其他内容以使代码库更清晰。也许实际的调用已经是多余的，或者可以组合类似的片段。

此外，在实践中，人们通常会稍微更改复制的代码，因此通常不会有直接的重复，而是紧密的变体。我担心自动 c&p 检测通常会让你失败。

但是，有一些重构工具可以帮助您准确地执行更改（有时还可以帮助您找到可能的候选者）。谷歌的“php 重构”，有很多可用的工具，包括独立的和作为 IDE 的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-23T05:40:49.763

CloneDR在大型源系统[中](http://www.semanticdesigns.com/Products/Clone)查找重复的代码，包括精确的副本和接近未命中的代码，由语言语法参数化。对于每个检测到的克隆集，它甚至会提出可用于替换克隆的抽象代码草图。

它适用于多种语言，包括 PHP 系统。可以在链接中找到 Joomla（一个 PHP 框架）的示例 PHP 克隆检测报告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T12:20:00.637

还请考虑导致此代码重复**的过程！**

如果您必须更改代码，大多数情况下复制代码比重构代码要快，以便它可以用于您的新用途和旧用途。

所以你必须让人们相信重构比简单的复制更好，因为从*长远来看*，它可以节省时间，而不是短期。

否则，您会发现自己在两年内搜索到您在此处发布的同一个问题！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T09:52:03.817

也许这个[grep 线程](http://www.mail-archive.com/bbedit-talk@barebones.com/msg02106.html)可以帮助你？

# php - 图像调整大小的合理 PHP memory_limit

> ID：527532
> 
> 赞同：0
> 
> 时间：2009-02-09T09:28:21.317
> 
> 标签：php, image, gd

我想让我网站上的用户能够将图像上传到他们的帐户。图像被调整为整个站点所需的 4 种不同尺寸。

我一直在使用 Pear Image_Transform，但在某些类型的 jpg 文件（所有文件都在 2mb 以下）上一直出现“字节耗尽”致命错误。所以我搬到了一台配备奔腾双核 E5200 @ 2.50GHz 和 2GB 内存的专用服务器。上传了相同的图像大小调整代码 - 同样的错误。我将 php.ini 中的 RAM 增加到 64M，但网站在某些类型的 jpg 上遇到了同样的问题。还尝试了wideimage类-相同的错误（错误总是与imagecreatefromjpeg（）有关）。（使用 GD2）。在我的 Mac 上本地一切正常。

这真的是内存问题吗，我的设置 + 图像调整大小的合理 memory_limit 是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T12:13:15.240

可以这样计算您需要多少内存的粗略指南

```
$imageInfo = getimagesize( $sourceImagePath );

// a check to make sure we have enough memory to hold this image
$requiredMemoryMB = ( $imageInfo[0] * $imageInfo[1] * ($imageInfo['bits'] / 8) * $imageInfo['channels'] * 2.5 ) / 1024; 
```

这是相当粗略的，包括一个软糖因子 2.5，您可能想尝试一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T12:47:59.457

如果图像大小可能是任意大小，则没有安全的方法可以为 PHP 设置足够的（或安全的、不崩溃的）内存限制以调整图像大小。

最好的解决方案是通过命令行 PHP CLI 通过已安装的 ImageMagic 调整大小 - 这样不使用 PHP 内存，而是使用操作系统内存。

请参阅 CLI 转换命令：

[http://www.imagemagick.org/script/convert.php](http://www.imagemagick.org/script/convert.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T10:00:38.413

似乎 ini_set("memory_limit","256M"); 已经覆盖了它。此外，使用 memory_get_peak_usage() 我发现我的图像调整大小（有问题 jpgs）在 90mb 区域内使用 1.8mb 图像。

同样有趣的是[http://uk.php.net/manual/en/function.imagecreatefromjpeg.php#64155](http://uk.php.net/manual/en/function.imagecreatefromjpeg.php#64155)用于动态分配内存限制的方法（我还没有尝试过）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T10:22:25.147

1-2 Mb jpeg 的 90 Mb 内存似乎很奇怪。我还没有看到你的代码，但也许你为每个大小实例多次打开文件？尝试打开文件一次，（调整大小，保存）X 4，然后关闭它。

我目前有一个用户上传图片的网站，并且没有遇到错误，我的 PHP 脚本设置为 16Mb，文件上传限制为 2Mb，我使用[这个库](http://github.com/marioprudhomme/fractalphp/blob/f7dfe2a3468585f9163a31fe8699aeeb332e901f/public/core/library/image.php)而不是 pear

代码示例

```
$image
->open('uploaded.jpg')
->resize(500, 500)
->save('large.jpg')
->resize(100, 100)
->save('medium.jpg')
->resize(25, 25)
->save('small.jpg')
->close(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-12T15:17:05.707

[http://www.dotsamazing.com/en/labs/phpmemorylimit](http://www.dotsamazing.com/en/labs/phpmemorylimit)

这是一个计算所需内存的好工具。即使对于我非常低效的编码，它也能完美地工作..

它还有一些关于如何分配更多内存的提示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-06T09:34:25.383

该`Image_Transform`库错过了 ImageMagick 和`libjpeg`. 您可以通过在读取之前指定大小来有效地调整 JPEG 的大小，例如在这个答案中：

[PHP 中高效的 JPEG 图像大小调整](https://stackoverflow.com/questions/12661/efficient-jpeg-image-resizing-in-php/4613341#4613341)

# sql - 将重复记录合并到 1 个字段中

> ID：527533
> 
> 赞同：2
> 
> 时间：2009-02-09T09:28:34.623
> 
> 标签：sql, sql-server, tsql

我有一个包含联系人列表的数据库表，其中一些联系人可能有多个记录，例如

```
CustomerID, CustomerName, Vehicle
1, Dan, Mazda
1, Dan, Suzuki
2, John, Ford
3, Dasha, Volvo
3, Dasha, Ford 
```

我可以编写一个选择查询来返回不同的客户 ID 和客户名称，以及 1 条记录中的车辆列表吗？IE

```
1, Dan, Mazda+Suzuki
2, John, Ford
3, Dasha, Volvo+Ford 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:36:39.267

关于另一个问题，这个问题有一些[很好的答案](https://stackoverflow.com/questions/451415/simulating-groupconcat-mysql-function-in-ms-sql-server-2005)。

根据[链接的文章](http://blog.shlomoid.com/2008/11/emulating-mysqls-groupconcat-function.html)，由于使用了 XML 函数，这仅适用于 SQL Server 2005 及更高版本。从文章 -

```
SELECT table_name, 
       LEFT(column_names,LEN(column_names) - 1)   AS column_names 
FROM   (SELECT table_name, 
               (SELECT column_name + ',' AS [text()] 
                FROM   information_schema.columns AS internal 
                WHERE  internal.table_name = table_names.table_name 
                FOR xml PATH ('') 
               ) AS column_names 
        FROM   (SELECT   table_name 
                FROM     information_schema.columns 
                GROUP BY table_name) AS table_names) AS pre_trimmed; 
```

> 第二个版本（诚然受到 [这篇文章的](http://anthony-yio.blogspot.com/2007/12/mssql-groupconcat.html)启发，我在写完第一个版本后偶然发现）：

```
SELECT table_name, 
       LEFT(column_names,LEN(column_names) - 1)   AS column_names 
FROM   information_schema.columns AS extern 
       CROSS APPLY (SELECT column_name + ',' 
                    FROM   information_schema.columns AS intern 
                    WHERE  extern.table_name = intern.table_name 
                    FOR XML PATH('') 
                   ) pre_trimmed (column_names) 
GROUP BY table_name,column_names; 
```

> 根据执行计划，第二个 CROSS APPLY 版本应该更慢，但我根本没有进行任何基准测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T09:32:35.393

我不确定它是否可以通过单个 sql 完成。但是，上次我在 sybase 的 tsql 中尝试此操作时，我使用了临时表和游标。因此，至少可以使用该路线完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:51:50.370

我很确定你不能通过单个 SQL 查询来做到这一点。

如果这是常规要求，则应为每个客户 ID 调用一个函数。

```
SELECT   abc.CustomerID,
         dbo.udf_getCSVCustomerVehicles(abc.customerID)
FROM     (SELECT DISTINCT CustomerID
          FROM   TABLE) abc
ORDER BY abc.CustomerID 
```

然后只需创建一个标量函数，将值合并成一个变量并返回结果。

# php - 开发 PHP 数据导入框架的最佳实践是什么？

> ID：527540
> 
> 赞同：3
> 
> 时间：2009-02-09T09:31:41.493
> 
> 标签：php, frameworks, import, etl

在我们作为一家气象公司的 Web 开发人员工作期间，我们一遍又一遍地面临着同样的任务：从某个地方（FTP/Web/目录/邮件）获取一些文件并将包含的数据导入数据库。

当然，文件格式永远不会相同，数据库总是设计不同，必须处理无数特殊情况等等。

所以现在我正在为这种工作计划一个导入框架。由于我们都是经验丰富的 PHP 开发人员，并且当前的脚本是 PHP 或 Perl，我们将坚持使用 PHP 作为脚本语言。

*   数据获取器将从源中获取文件，将其打开并将内容存储到字符串变量中。（别担心，PHP 会从我们这里获得足够的内存。）
*   数据处理程序将完成复杂的工作以将字符串转换为某种数组。
*   该数组将被保存到数据库或写入新文件或我们应该对它执行的任何操作。

除了这个功能之外，还有一些常见的错误处理、日志写入和电子邮件报告。

这个想法是使用类的集合（一些 getter 类，许多专门的处理程序，一些 writer 类）。

**我的问题：**我如何在工作脚本中实际组织这些课程？我是否发明了某种将被解释的元语言并相应地调用类？或者只是提供这些类必须实现的一些简单接口，而我的用户（就像我说的：经验丰富的 PHP 开发人员）会编写加载这些类的小型 PHP 脚本？

第二个版本几乎可以肯定提供最大的灵活性和可扩展性。

对于这样的事业，您还有其他想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T09:49:52.513

我建议借鉴[数据转换服务](http://en.wikipedia.org/wiki/Data_Transformation_Services)(DTS) 的概念。您可以拥有数据源和数据接收器、导入任务、转换任务等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T10:30:54.567

在需要导入和导出的数十种不同外部数据格式的类似环境中工作，我可以建议至少*尝试*让它们统一数据格式。我们开发了一些工具来帮助我们公司以外的其他人将他们的数据转换为我们的格式，从而取得了一些成功。我们还免费为他们提供了源代码。

其他一些人现在正在使用我们的工具为我们转换他们的数据，如果他们改变了格式，就是*他们*改变了转换工具。对我们来说，头痛的原因之一少了。

在一种情况下，它甚至会导致另一家公司切换到我们系统内部使用的文件格式。当然，这只是一个案例，但我认为这是漫长道路上的第一步；-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T10:34:54.120

定义标准 Web 服务在这里不起作用是有原因的吗？然后，您可以提供标准格式的数据，如果出现错误，则返回 SOAP 错误（可能由输入文档中的字段填充）。

它可能比 Pavel 的建议更有限（或者需要更多的前期设计），但可能值得考虑。

# c# - C# 的动态二维结构

> ID：527553
> 
> 赞同：2
> 
> 时间：2009-02-09T09:36:48.223
> 
> 标签：c#, dynamic-data

我正在研究一个存储类的二维数组的类`MyType`，并希望它使用动态数据类型。即不是`MyType[,]`

问题`MyType[,]`是该类不提前知道数组的大小，如果在 .NET Frameworks 的其他地方已经完成，我不想麻烦管理数组的大小调整。

该类在任何给定时刻都不知道最大数组大小，但数组将是密集的。我知道我可以使用静态数组，并根据需要重新分配内存，但如果可能的话，我更喜欢使用内置实现。

有什么比`List<List<MyType>>`这个目的更好的吗？

编辑1：指定数组是密集的；

编辑 2 和 3：指定问题`MyType[,]`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T09:41:54.480

创建自己的`List<List<T>>`封装，如：

```
public class Matrix<T>
{
   List<List<T>> matrix;

   public void Add(IEnumerable<T> row)
   {
      List<T> newRow = new List<T>(row);
      matrix.Add(newRow);
   }

   public T this[int x, int y]
   {
      get  { return matrix[y][x]; }
   }
   ....
} 
```

定义你自己的一套操作就可以了！自由！

**通过封装它，如果还不够，您可以决定稍后再进行更优化的实现。**

```
 ICollection<T> rowOne = (ICollection<T>)new List<Int64>();
        rowOne.Add(1);
        rowOneList.Add(2);
        rowOne.Add(3);

        ICollection<T> rowTwo = (ICollection<T>)new List<Int64>();
        rowTwo .Add(4);
        rowTwo .Add(5);
        rowTwo .Add(6); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T09:40:44.437

这取决于你的结构有多稀疏。例如，如果您的条目类似于`myTypes[0, 1]`and `myTypes[134, 544]`，则最好使用[sparse matrix](http://en.wikipedia.org/wiki/Sparse_matrix)。否则，`List<List<MyType>>`会做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T09:52:09.480

对于密集的二维矩阵，矩形阵列是理想的。你有什么问题`SomeType[,]`？请注意，您可以使用`Array.CreateInstance(type, dim0Size, dim1Size)`或使用泛型创建动态数组：

```
void DoWork<T>(...) {
   T[,] data = ...
}
DoWork<Foo>(...);
DoWork<Bar>(...); 
```

（`MakeGenericMethod`如果你想使用 ad-hoc 类型，可能会使用）

# c# - 在C#中将一个arraylist数据移动到另一个arraylist

> ID：527561
> 
> 赞同：7
> 
> 时间：2009-02-09T09:40:49.350
> 
> 标签：c#, arraylist

如何将一个 Arraylist 数据移动到另一个 Arraylist。我尝试了很多选项，但输出的形式是数组而不是数组列表

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-09T09:46:29.807

首先 - 除非你在 .NET 1.1 上，否则你应该避免`ArrayList`- 喜欢类型化的集合，例如`List<T>`.

当您说“复制”时-您是要*替换*、*附加*还是*创建新的*？

对于追加（使用`List<T>`）：

```
 List<int> foo = new List<int> { 1, 2, 3, 4, 5 };
    List<int> bar = new List<int> { 6, 7, 8, 9, 10 };
    foo.AddRange(bar); 
```

要替换，`foo.Clear();`请在`AddRange`. 当然，如果你知道第二个列表足够长，你可以在索引器上循环：

```
 for(int i = 0 ; i < bar.Count ; i++) {
        foo[i] = bar[i];
    } 
```

要创建新的：

```
 List<int> bar = new List<int>(foo); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T09:44:32.883

```
 ArrayList model = new ArrayList();
        ArrayList copy = new ArrayList(model); 
```

?

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-09T09:44:52.943

使用以 ICollection 作为参数的 ArrayList 的构造函数。大多数集合都有这个构造函数。

```
ArrayList newList = new ArrayList(oldList); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-09T09:43:18.830

```
ArrayList l1=new ArrayList();
l1.Add("1");
l1.Add("2");
ArrayList l2=new ArrayList(l1); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T09:51:40.120

[http://msdn.microsoft.com/en-us/library/system.collections.arraylist.addrange.aspx](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.addrange.aspx)

从上面的链接无耻地复制/粘贴

```
 // Creates and initializes a new ArrayList.
  ArrayList myAL = new ArrayList();
  myAL.Add( "The" );
  myAL.Add( "quick" );
  myAL.Add( "brown" );
  myAL.Add( "fox" );

  // Creates and initializes a new Queue.
  Queue myQueue = new Queue();
  myQueue.Enqueue( "jumped" );
  myQueue.Enqueue( "over" );
  myQueue.Enqueue( "the" );
  myQueue.Enqueue( "lazy" );
  myQueue.Enqueue( "dog" );

  // Displays the ArrayList and the Queue.
  Console.WriteLine( "The ArrayList initially contains the following:" );
  PrintValues( myAL, '\t' );
  Console.WriteLine( "The Queue initially contains the following:" );
  PrintValues( myQueue, '\t' );

  // Copies the Queue elements to the end of the ArrayList.
  myAL.AddRange( myQueue );

  // Displays the ArrayList.
  Console.WriteLine( "The ArrayList now contains the following:" );
  PrintValues( myAL, '\t' ); 
```

除此之外，我认为[Marc Gravell](https://stackoverflow.com/questions/527561/move-one-arraylist-data-to-another-arraylist-in-c/527577#527577)是正确的；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T09:57:53.477

我找到了向上移动数据的答案，例如：

```
Firstarray.AddRange(SecondArrary); 
```

# apache-flex - 如何限制我的 AIR 分发？

> ID：527566
> 
> 赞同：2
> 
> 时间：2009-02-09T09:42:46.820
> 
> 标签：apache-flex, air, software-distribution, restriction

有什么方法可以限制我的 AIR 应用程序进一步分发？

假设我制作了一个 AIR 应用程序，并将这个应用程序提供给我的朋友。有什么办法可以让他不能将这个应用程序重新分发给任何新人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T09:52:09.823

没有内置的东西可以帮助你解决这个问题，但我想到了两个想法。

一种选择是在首次启动时要求提供序列号。使用 HTTPS 针对服务器验证序列号，然后将其加密存储在本地存储中。然后，您可以在服务器上验证该机器对串行的使用，或者通过使用机器独有的东西来加密本地存储。

您还可以使用需要安装在用户计算机上的客户端证书。然后，应用程序可以在启动时根据证书进行验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T02:29:01.923

这是一个很好的问题。一个可能的解决方案是认证。但是我在这里有一个疑问。您是否希望您的朋友不要分发此应用程序 + 无法进行二次安装。

二次安装意味着如果您的朋友希望他的系统格式化并重新安装该应用程序。你想支持这个吗？

如果没有，那么解决方案很容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T09:53:12.380

如果您限制您的 AIR 应用程序的分发，那您是否无法将应用程序提供给您的朋友？我能看到的唯一与语言无关的方法是让你的朋友过来看看你的电脑。

如果您热衷于使 AIR 应用程序成为“您的”应用程序，您可以尝试[对其进行数字签名，](http://www.adobe.com/devnet/air/articles/signing_air_applications_print.html)但获得证书需要花费大量金钱。

# fluent-nhibernate - Fluent-NHibernate 映射

> ID：527571
> 
> 赞同：0
> 
> 时间：2009-02-09T09:44:23.460
> 
> 标签：fluent-nhibernate

在我的数据库中，我有一个包含逗号分隔的电子邮件列表的字段。我如何将它映射到`IList<string>`我的模型中的 a ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T11:18:04.157

您应该实现一个`IUserCollection`，它将您的 CSV 列映射到实际的电子邮件列表，然后在保存时将其序列化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T09:49:37.053

有问题的表格甚至不是第一范式，这很糟糕。

您可以做到这一点的唯一方法是遵循以下原则：

```
class Foo
{       
    private List<string> emails = new List<string>();       

    public string _Emails 
    { 
        get { return string.Join(",", emails.ToArray()); }
        set { emails = new List<string>(value.Split(',')); }
    }       

    public IList<string> Emails
    { 
        get { return emails; }          
    }
} 
```

和地图`_Emails`属性。

**编辑**

另一种解决方案是实现您自己的`IUserType`或`IUserCollection`. 因此，您的模型会更漂亮。

# html - 如何使 WordPress 主题适应 BlogEngine.net

> ID：527572
> 
> 赞同：6
> 
> 时间：2009-02-09T09:44:32.167
> 
> 标签：html, themes, wordpress-theming, blogengine.net

您知道有关如何创建具有 WordPress[主题](http://wordpress.org/extend/themes/strange-little-town)源代码的新[BlogEngine.net](http://www.dotnetblogengine.net/)主题的任何指南吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T10:15:21.937

你必须自己转换它。只需下载[BlogEngine](http://www.codeplex.com/blogengine/Release/ProjectReleases.aspx?ReleaseId=14988)源代码并创建一个新主题，他们在[codeplex](http://www.codeplex.com/blogengine/Release/ProjectReleases.aspx?ReleaseId=14988)上有 13 个以上的示例。

颠覆网址：[https ://blogengine.svn.codeplex.com/svn](https://blogengine.svn.codeplex.com/svn)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-29T19:06:07.310

看看[这篇文章](http://rtur.net/blog/post/2008/04/30/Porting-WordPress-theme-to-BlogEngine.aspx)- 它详细解释了如何将 WordPress 主题移植到 BlogEngine

# c# - 在 UserControl 中设置数据绑定路径

> ID：527576
> 
> 赞同：1
> 
> 时间：2009-02-09T09:45:12.727
> 
> 标签：c#, wpf, data-binding, dependency-properties

我不知道如何基于 a`Path`在内部设置 a ：`UserControl``Parameter`

用户控制：

```
<UserControl x:Class="WpfApplication3.TestControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:diagnostics="clr-namespace:System.Diagnostics;assembly=WindowsBase">
    <Grid>
        <TextBox Text="{Binding Path=MyPath}"/>
    </Grid>
</UserControl> 
```

后面的代码：

```
 public partial class TestControl : UserControl
    {
        public string MyPath
        {
            get { return (string)GetValue(MyPathProperty); }
            set { SetValue(MyPathProperty, value); }
        }
        public static readonly DependencyProperty MyPathProperty =
            DependencyProperty.Register("MyPath", typeof(string), typeof(TestControl), new UIPropertyMetadata(""));
    } 
```

以及我打算如何使用它：

```
<local:TestControl MyPath="FirstName"></local:TestControl> 
```

`DataContext`将从父对象中获取，并包含一个类，里面`User`有一个`FirstName`属性。

目标是拥有一个可以绑定到任何路径的用户控件。我知道这一定非常简单，但我对这项技术很陌生，我找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T15:03:26.643

我终于设法做到了，在代码中：

```
private static void MyPathChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    TestControl tc = d as TestControl;
    Binding myBinding = new Binding("MyDataProperty");
    myBinding.Mode = BindingMode.TwoWay;
    myBinding.Path = new PropertyPath(tc.MyPath);
    tc.txtBox.SetBinding(TextBox.TextProperty, myBinding);
}

public static readonly DependencyProperty MyPathProperty =
    DependencyProperty.Register("MyPath",
        typeof(string),
        typeof(TestControl),
        new PropertyMetadata("", MyPathChanged)); 
```

用户控件现在有一个没有绑定的文本框：

```
 <TextBox x:Name="txtBox"></TextBox> 
```

就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-01T17:04:37.040

当您在 XAML 中编写时：

```
<TextBox Text="{Binding Path=MyPath}"/> 
```

这试图将您绑定到控件的*DataContext的 MyPath 属性。*

要绑定到控件自己的属性，我想你应该这样写：

```
<TextBox Text="{Binding Path=MyPath, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}}"/> 
```

附近有[一张备忘单](https://stackoverflow.com/questions/491312/is-there-a-wpf-cheat-sheet-outhere)，以防万一；）

# soa - 有多少组织使用供应商提供的 SOA 堆栈？

> ID：527578
> 
> 赞同：0
> 
> 时间：2009-02-09T09:48:08.040
> 
> 标签：soa

我的工作场所最近启动了一项 SOA 计划。在对最大的供应商（IBM 和 Oracle）进行了长达一年的检查之后，他们已经决定使用哪一个，并且现在在整个 SOA 堆栈（应用程序服务器、BAM、流程服务器、ESB、类似 UDDI 的解决方案等）。

有多少组织真正在使用成熟的 SOA 堆栈？这项技术是否显示出任何更好的证据？我害怕“银弹”综合症。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T10:14:49.177

我在一家 SOA 商店工作（我们出售自己的堆栈……也许你买了我们的！），它确实可以帮助企业变得更加敏捷……如果做得好的话。

问题出现时：

*   人们开始将所有东西都变成服务，最终得到的互连和接口与插入 ESB 之前一样多。这使得改变非常困难。

*   如果您将 BPM 与人机界面一起使用：人们不会“获取”portlet。它们不是让各个 portlet 各自做一项任务，而是让它们做很多事情，这违背了 BPM 的目标。如有必要，我可以扩展此地段，但这可能与您无关。

*   这一切都是一次实施的。这是一个巨大的系统更改，因此请尝试逐个进行。（例如：只需在现有系统前面使用 Web 服务，并在其上构建新的 UI。然后逐渐用对新系统的 UI 调用替换旧系统的 UI 调用。）这将有助于用户接受以及一种更安全的做事方式。管理层可能不想要这种方法（它更难管理），但强调好处。很多。

*   它作为无代码开发出售。这不存在，而且可能永远不会存在。即使您不必编写任何代码，但如果您不知道*代码是如何工作*的，那么您的代码将是不完整的、考虑不周的或无法维护的。

从我所见，如果 SOA 做得好，那么您的业务就可以打开六便士，这很酷。如果它做得不好，那么它可能不会比你的遗留系统更糟，但它不会更好，而且你将在两者之间度过一段昂贵而痛苦的时光。

我可以给你一个客户名单，但我不知道是否应该，所以我会留下它。可以说我们有一些庞大的日常品牌使用我们的端到端堆栈。

# java - 如何将连接的字符串拆分为多个浮点值？

> ID：527595
> 
> 赞同：0
> 
> 时间：2009-02-09T09:55:49.643
> 
> 标签：java, core

我是java的初学者我有

```
packet=090209153038020734.0090209153039020734.0 
```

像这样我想拆分这个字符串并存储到一个像两个字符串一样的数组中：

```
1) 090209153038020734.0
2) 090209153039020734.0 
```

我已经这样做了：

```
String packetArray[] = packets.split(packets,Constants.SF); 
```

其中：常量.SF=0x01。

但它不会起作用。

请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T10:11:41.477

我会三思而后行，因为这些显然是固定宽度的字段。

我以前在这里的另一个问题上见过他们（实际上有几个，所以我猜这可能是家庭作业（或流行的数据收集设备:-)），很明显协议是：

*   STX (0x01)。
*   0x0f。
*   日期（YYMMDD 或 DDMMYY）。
*   时间（HHMMSS）。
*   0x02。
*   值（XXXXXX.X）。
*   0x03。
*   0x04。

而且，鉴于它们的宽度是固定的，您可能应该只使用子字符串来获取信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T14:05:57.733

```
String packetArray[] = packets.split("\u0001"); 
```

应该管用。您正在使用

```
public String[] split(String regex, int limit) 
```

它正在做其他事情：它确保`split()`返回一个最多包含成员的数组`limit`（在这种情况下为 1，所以你得到你想要的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T10:07:07.883

String 的 JavaDoc 在这里很有帮助：http: [//java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/String.html)

你有你的字符串数据包；

`String.indexOf(String)`给你一个特殊子串的位置。你对“。”感兴趣 符号。所以你写

```
int position = packet.indexOf(".")+1 
```

+1，因为您也想要尾随小数。它将返回 20-ish 并且将是第一个数字的最后一个位置。

然后我们使用子字符串

`String first = packet.substring(0,position)`将为您提供直到“.0”的 `String second = packet.substring(position-1)`所有内容应该为您提供从“.0”之后开始到字符串末尾的所有内容。

现在，如果您希望它们明确地放入一个数组中，您可以将它们放在那里。整个代码 - 我可能有一些“一个” -错误。

```
int position = packet.indexOf(".")+1 
String first = packet.substring(0,position)
String second = packet.substring(position-1)
String[] packetArray = new String[2];
packetArray[0] = first;
packetArray[1] = second; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T16:54:28.577

您需要阅读[String.split() 方法的 Javadocs](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html) ...您正在调用采用正则表达式和限制的 String.split() 版本，但是**您将字符串本身作为第一个参数传递**，真的没有意义。

正如 Aaron Digulla 提到的，使用其他版本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T10:04:24.647

你没有说你想怎么做分裂。它可以基于固定长度（字符数），或者您想要一位小数。

如果前者你可以做 packetArray = new String[]{packet.substring(0, 20), packet.substring(21)};

```
int dotIndex = packets.indexOf('.');
packetArray = new String[]{packet.substring(0, dotIndex+2), packet.substring(dotIndex+2)}; 
```

您的解决方案将正则表达式与字符串混淆。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T10:06:34.280

split 使用[此处](http://java.sun.com/javase/6/docs/api/java/lang/String.html)记录的[正则表达式](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html#sum)。您的代码似乎试图匹配整个字符串 Constants.SF = 0x01 次，这没有多大意义。如果您知道盒子是什么字符，那么您可以使用 {[^c]+cc} 之类的东西，其中 c 是盒子的字符（我猜这是 0x01）来匹配每个“数据包”。

我认为您正在尝试像 .net String.Split(...) 函数一样使用它？

# c# - 自动 INotifyPropertyChanged

> ID：527602
> 
> 赞同：63
> 
> 时间：2009-02-09T09:59:10.710
> 
> 标签：c#, inotifypropertychanged

有没有办法自动获得类中属性更改的通知，而不必在每个 setter 中编写 OnPropertyChanged？（我有数百个属性，我想知道它们是否已更改）。

* * *

Anton 建议使用[动态代理](http://www.nablasoft.com/alkampfer/index.php/2008/08/04/implement-inotifypropertychanged-with-castledynamicproxy/)。实际上，我过去曾将“Castle”库用于类似的东西，虽然它确实减少了我必须编写的代码量，但它使我的程序启动时间（ymmv）增加了大约 30 秒——因为它是一个运行时解决方案。

我想知道是否有编译时解决方案，也许使用编译时属性......

* * *

Slashene 和 TcKs 给出了生成重复代码的建议 - 不幸的是，并非我的所有属性都是 m_Value = value 的简单案例 - 它们中的许多在设置器中都有自定义代码，因此来自片段和 xml 的千篇一律的代码对于我的项目也是。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2011-11-01T09:00:34.473

**编辑：** NotifyPropertyWeaver 的作者已弃用该工具，转而支持更通用的[Fody](https://github.com/Fody/Fody#readme)。（提供从编织者迁移到 fody 的人们的[迁移指南。）](https://github.com/Fody/PropertyChanged/wiki/ConvertingFromNotifyPropertyWeaver)

* * *

我在项目中使用的一个非常方便的工具是~~[Notify Property Weaver](https://github.com/SimonCropp/NotifyPropertyWeaver/wiki)~~ [Fody](https://github.com/Fody/PropertyChanged#readme)。

它作为构建步骤安装在您的项目中，并在编译期间注入引发`PropertyChanged`事件的代码。

使属性引发 PropertyChanged 是通过在它们上放置[特殊属性](https://github.com/Fody/PropertyChanged/wiki/Attributes)来完成的：

```
[ImplementPropertyChanged]
public string MyProperty { get; set; } 
```

作为奖励，您还可以为依赖于其他属性的属性指定关系

```
[ImplementPropertyChanged]
public double Radius { get; set; }

[DependsOn("Radius")]
public double Area 
{
    get { return Radius * Radius * Math.PI; }
} 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-02-09T11:48:04.320

## nameof 运算符于 2015 年 7 月在 C# 6.0 和 .NET 4.6 和 VS2015 中实现。以下对于 C# < 6.0 仍然有效

我们使用下面的代码（来自[http://www.ingebrigtsen.info/post/2008/12/11/INotifyPropertyChanged-revisited.aspx](http://www.ingebrigtsen.info/post/2008/12/11/INotifyPropertyChanged-revisited.aspx)）。效果很好:)

```
public static class NotificationExtensions
{
    #region Delegates

    /// <summary>
    /// A property changed handler without the property name.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="sender">The object that raised the event.</param>
    public delegate void PropertyChangedHandler<TSender>(TSender sender);

    #endregion

    /// <summary>
    /// Notifies listeners about a change.
    /// </summary>
    /// <param name="EventHandler">The event to raise.</param>
    /// <param name="Property">The property that changed.</param>
    public static void Notify(this PropertyChangedEventHandler EventHandler, Expression<Func<object>> Property)
    {
        // Check for null
        if (EventHandler == null)
            return;

        // Get property name
        var lambda = Property as LambdaExpression;
        MemberExpression memberExpression;
        if (lambda.Body is UnaryExpression)
        {
            var unaryExpression = lambda.Body as UnaryExpression;
            memberExpression = unaryExpression.Operand as MemberExpression;
        }
        else
        {
            memberExpression = lambda.Body as MemberExpression;
        }

        ConstantExpression constantExpression;
        if (memberExpression.Expression is UnaryExpression)
        {
            var unaryExpression = memberExpression.Expression as UnaryExpression;
            constantExpression = unaryExpression.Operand as ConstantExpression;
        }
        else
        {
            constantExpression = memberExpression.Expression as ConstantExpression;
        }

        var propertyInfo = memberExpression.Member as PropertyInfo;

        // Invoke event
        foreach (Delegate del in EventHandler.GetInvocationList())
        {
            del.DynamicInvoke(new[]
            {
                constantExpression.Value, new PropertyChangedEventArgs(propertyInfo.Name)
            });
        }
    }

    /// <summary>
    /// Subscribe to changes in an object implementing INotifiyPropertyChanged.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="ObjectThatNotifies">The object you are interested in.</param>
    /// <param name="Property">The property you are interested in.</param>
    /// <param name="Handler">The delegate that will handle the event.</param>
    public static void SubscribeToChange<T>(this T ObjectThatNotifies, Expression<Func<object>> Property, PropertyChangedHandler<T> Handler) where T : INotifyPropertyChanged
    {
        // Add a new PropertyChangedEventHandler
        ObjectThatNotifies.PropertyChanged += (s, e) =>
            {
                // Get name of Property
                var lambda = Property as LambdaExpression;
                MemberExpression memberExpression;
                if (lambda.Body is UnaryExpression)
                {
                    var unaryExpression = lambda.Body as UnaryExpression;
                    memberExpression = unaryExpression.Operand as MemberExpression;
                }
                else
                {
                    memberExpression = lambda.Body as MemberExpression;
                }
                var propertyInfo = memberExpression.Member as PropertyInfo;

                // Notify handler if PropertyName is the one we were interested in
                if (e.PropertyName.Equals(propertyInfo.Name))
                {
                    Handler(ObjectThatNotifies);
                }
            };
    }
} 
```

例如以这种方式使用：

```
public class Employee : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    private string _firstName;
    public string FirstName
    {
        get { return this._firstName; }
        set
        {
            this._firstName = value;
            this.PropertyChanged.Notify(()=>this.FirstName);
        }
    }
}

private void firstName_PropertyChanged(Employee sender)
{
    Console.WriteLine(sender.FirstName);
}

employee = new Employee();
employee.SubscribeToChange(() => employee.FirstName, firstName_PropertyChanged); 
```

示例中可能存在一些语法错误。没有测试它。但是你至少应该有这个概念:)

**编辑：**我现在看到你可能想要更少的工作，但是是的......上面的东西至少让它变得容易多了。并且您可以防止使用字符串引用属性的所有可怕问题。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2012-09-13T14:25:17.363

Framework 4.5 为我们提供了[`CallerMemberNameAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.callermembernameattribute.aspx)，这使得将属性名称作为字符串传递是不必要的：

```
private string m_myProperty;
public string MyProperty
{
    get { return m_myProperty; }
    set
    {
        m_myProperty = value;
        OnPropertyChanged();
    }
}

private void OnPropertyChanged([CallerMemberName] string propertyName = "none passed")
{
    // ... do stuff here ...
} 
```

与 Svish 的解决方案类似，只是用无聊的框架功能替换了 lambda awesomeness ;-)

如果您正在使用安装了 KB2468871 的 Framework 4.0，[则](https://www.nuget.org/packages/Microsoft.Bcl/)可以通过[nuget](https://support.microsoft.com/en-us/kb/2468871)安装*Microsoft BCL 兼容包*，它也提供此属性。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-05-30T10:22:06.273

您可以在 PropertyChanged 委托上有扩展方法并像这样使用它：

```
public string Name
{
    get { return name; }
    set
    {
        name = value;
        PropertyChanged.Raise(() => Name);
    }
} 
```

订阅特定属性更改：

```
var obj = new Employee();

var handler = obj.SubscribeToPropertyChanged(
    o => o.FirstName, 
    o => Console.WriteLine("FirstName is now '{0}'", o.FirstName));

obj.FirstName = "abc";

// Unsubscribe when required
obj.PropertyChanged -= handler; 
```

扩展方法能够通过检查 lambda 表达式树来确定发送者和属性名称，并且*不会对性能产生重大影响*：

```
public static class PropertyChangedExtensions
{
    public static void Raise<TProperty>(
        this PropertyChangedEventHandler handler, Expression<Func<TProperty>> property)
    {
        if (handler == null)
            return;

        var memberExpr = (MemberExpression)property.Body;
        var propertyName = memberExpr.Member.Name;
        var sender = ((ConstantExpression)memberExpr.Expression).Value;
        handler.Invoke(sender, new PropertyChangedEventArgs(propertyName));
    }

    public static PropertyChangedEventHandler SubscribeToPropertyChanged<T, TProperty>(
        this T obj, Expression<Func<T, TProperty>> property, Action<T> handler)
        where T : INotifyPropertyChanged
    {
        if (handler == null)
            return null;

        var memberExpr = (MemberExpression)property.Body;
        var propertyName = memberExpr.Member.Name;

        PropertyChangedEventHandler subscription = (sender, eventArgs) =>
        {
            if (propertyName == eventArgs.PropertyName)
                handler(obj);
        };

        obj.PropertyChanged += subscription;

        return subscription;
    }
} 
```

如果`PropertyChanged`在基类型中声明事件，则它不会作为派生类中的委托字段可见。在这种情况下，一种解决方法是声明一个受保护的类型字段`PropertyChangedEventHandler`并显式实现事件`add`和`remove`访问器：

```
public class Base : INotifyPropertyChanged
{
    protected PropertyChangedEventHandler propertyChanged;
    public event PropertyChangedEventHandler PropertyChanged
    {
        add { propertyChanged += value; }
        remove { propertyChanged -= value; }
    }
}

public class Derived : Base
{
    string name;

    public string Name
    {
        get { return name; }
        set
        {
            name = value;
            propertyChanged.Raise(() => Name);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-09T10:21:51.780

实现类型安全`INotifyPropertyChanged`：[见这里](http://blogs.microsoft.co.il/dorony/2007/08/31/wpf-binding-inotifypropertychanged-and-linq/)

然后制作自己的代码片段：

```
private $Type$ _$PropertyName$;
public $Type$ $PropertyName$
{
    get
    {
        return _$PropertyName$;
    }
    set
    {
        if(value != _$PropertyName$)
        {
            _$PropertyName$ = value;
            OnPropertyChanged(o => o.$PropertyName$);               
        }
    }
} 
```

使用[代码片段设计器](http://www.codeplex.com/SnippetDesigner)，您就完成了！构建您的`INotifyPropertyChanged`.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-09T10:13:13.657

我不知道没有标准方法，但我知道两种解决方法：

1) [PostSharp](http://www.postsharp.org/)可以在编译后为你做。它非常有用，但每次构建都需要一些时间。

2) 自定义工具 i Visual Studio。您可以将其与“部分课程”结合使用。然后您可以为您的 XML 创建自定义工具，并可以从 xml 生成源代码。

例如这个xml：

```
<type scope="public" type="class" name="MyClass">
    <property scope="public" type="string" modifier="virtual" name="Text" notify="true" />
</type> 
```

可以是此代码的来源：

```
public partial class MyClass {
    private string _text;
    public virtual string Text {
        get { return this._Text; }
        set {
            this.OnPropertyChanging( "Text" );
            this._Text = value;
            this.OnPropertyChanged( "Text" );
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-05-17T13:33:47.367

您可能希望将面向方面的编程作为一个整体来研究

框架 => 你可以看看[linfu](https://github.com/philiplaureano/LinFu)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-09T11:33:30.890

您可以查看 Castle 或 Spring.NET 并实现拦截器功能？

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-06-01T11:35:22.600

我刚刚找到[ActiveSharp - Automatic INotifyPropertyChanged](http://activesharp.codeplex.com/)，我还没有使用它，但它看起来不错。

引用它的网站...

* * *

> 发送属性更改通知而不将属性名称指定为字符串。

相反，编写如下属性：

```
public int Foo
{
    get { return _foo; }
    set { SetValue(ref _foo, value); }  // <-- no property name here
} 
```

请注意，无需将属性名称包含为字符串。ActiveSharp 可靠且正确地为自己解决了这个问题。它的工作原理是您的属性实现通过 ref 传递支持字段 (_foo)。（ActiveSharp 使用“by ref”调用来识别传递了哪个支持字段，并从该字段中识别属性）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-06-04T13:48:40.690

没有单一的 Property Changed 实现可以处理人们想要使用它的所有方式。最好的办法是生成一个帮助类来为你完成工作这是我使用的一个例子

```
/// <summary>
/// Helper Class that automates most of the actions required to implement INotifyPropertyChanged
/// </summary>
public static class HPropertyChanged
{
    private static Dictionary<string, PropertyChangedEventArgs> argslookup = new Dictionary<string, PropertyChangedEventArgs>();
    public static string ThisPropertyName([CallerMemberName]string name = "")
    {
        return name;
    }

    public static string GetPropertyName<T>(Expression<Func<T>> exp)
    {
        string rtn = "";
        MemberExpression mex = exp.Body as MemberExpression;
        if(mex!=null)
            rtn = mex.Member.Name;
        return rtn;
    }

    public static void SetValue<T>(ref T target, T newVal, object sender, PropertyChangedEventHandler handler, params string[] changed)
    {
        if (!target.Equals(newVal))
        {
            target = newVal;
            PropertyChanged(sender, handler, changed);
        }
    }
    public static void SetValue<T>(ref T target, T newVal, Action<PropertyChangedEventArgs> handler, params string[] changed)
    {
        if (!target.Equals(newVal))
        {
            target = newVal;
            foreach (var item in changed)
            {
                handler(GetArg(item));
            }
        }
    }

    public static void PropertyChanged(object sender,PropertyChangedEventHandler handler,params string[] changed)
    {
        if (handler!=null)
        {
            foreach (var prop in changed)
            {
                handler(sender, GetArg(prop));
            }
        }
    }
    public static PropertyChangedEventArgs GetArg(string name)
    {
        if (!argslookup.ContainsKey(name)) argslookup.Add(name, new PropertyChangedEventArgs(name));
        return argslookup[name];
    }
} 
```

编辑：有人建议我从一个帮助类转换为一个值包装器，从那以后我一直在使用这个，我发现它工作得很好

```
public class NotifyValue<T>
{
    public static implicit operator T(NotifyValue<T> item)
    {
        return item.Value;
    }

    public NotifyValue(object parent, T value = default(T), PropertyChangingEventHandler changing = null, PropertyChangedEventHandler changed = null, params object[] dependenies)
    {
        _parent = parent;
        _propertyChanged = changed;
        _propertyChanging = changing;

        if (_propertyChanged != null)
        {
            _propertyChangedArg =
                dependenies.OfType<PropertyChangedEventArgs>()
                .Union(
                    from d in dependenies.OfType<string>()
                    select new PropertyChangedEventArgs(d)
                );

        }
        if (_propertyChanging != null)
        {
            _propertyChangingArg =
                dependenies.OfType<PropertyChangingEventArgs>()
                .Union(
                    from d in dependenies.OfType<string>()
                    select new PropertyChangingEventArgs(d)
                );
        }
        _PostChangeActions = dependenies.OfType<Action>();

    }

    private T _Value;

    public T Value
    {
        get { return _Value; }
        set
        {
            SetValue(value);
        }
    }

    public bool SetValue(T value)
    {
        if (!EqualityComparer<T>.Default.Equals(_Value, value))
        {
            OnPropertyChnaging();
            _Value = value;
            OnPropertyChnaged();
            foreach (var action in _PostChangeActions)
            {
                action();
            }
            return true;
        }
        else
            return false;
    }

    private void OnPropertyChnaged()
    {
        var handler = _propertyChanged;
        if (handler != null)
        {
            foreach (var arg in _propertyChangedArg)
            {
                handler(_parent, arg);
            }           
        }
    }

    private void OnPropertyChnaging()
    {
        var handler = _propertyChanging;
        if(handler!=null)
        {
            foreach (var arg in _propertyChangingArg)
            {
                handler(_parent, arg);
            }
        }
    }

    private object _parent;
    private PropertyChangedEventHandler _propertyChanged;
    private PropertyChangingEventHandler _propertyChanging;
    private IEnumerable<PropertyChangedEventArgs> _propertyChangedArg;
    private IEnumerable<PropertyChangingEventArgs> _propertyChangingArg;
    private IEnumerable<Action> _PostChangeActions;
} 
```

使用示例

```
private NotifyValue<int> _val;
public const string ValueProperty = "Value";
public int Value
{
    get { return _val.Value; }
    set { _val.Value = value; }
} 
```

然后在构造函数中你做

```
_val = new NotifyValue<int>(this,0,PropertyChanged,PropertyChanging,ValueProperty ); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-05-27T09:15:29.980

改善儿童班的呼叫事件：

感谢调用：this.NotifyPropertyChange(() => PageIndex);

在 NotificationExtensions 类中添加：

```
 /// <summary>
    /// <para>Lève l'évènement de changement de valeur sur l'objet <paramref name="sender"/>
    /// pour la propriété utilisée dans la lambda <paramref name="property"/>.</para>
    /// </summary>
    /// <param name="sender">L'objet portant la propriété et l'évènement.</param>
    /// <param name="property">Une expression lambda utilisant la propriété subissant la modification.</param>
    public static void NotifyPropertyChange(this INotifyPropertyChanged sender, Expression<Func<Object>> property)
    {
        if (sender == null)
            return;

        // Récupère le nom de la propriété utilisée dans la lambda en argument
        LambdaExpression lambda = property as LambdaExpression;
        MemberExpression memberExpression;
        if (lambda.Body is UnaryExpression)
        {
            UnaryExpression unaryExpression = lambda.Body as UnaryExpression;
            memberExpression = unaryExpression.Operand as MemberExpression;
        }
        else
        {
            memberExpression = lambda.Body as MemberExpression;
        }
        ConstantExpression constantExpression = memberExpression.Expression as ConstantExpression;
        PropertyInfo propertyInfo = memberExpression.Member as PropertyInfo;

        // il faut remonter la hierarchie, car meme public, un event n est pas visible dans les enfants
        FieldInfo eventField;
        Type baseType = sender.GetType();
        do
        {
            eventField = baseType.GetField(INotifyPropertyChangedEventFieldName, BindingFlags.Instance | BindingFlags.NonPublic);
            baseType = baseType.BaseType;
        } while (eventField == null);

        // on a trouvé l'event, on peut invoquer tt les delegates liés
        MulticastDelegate eventDelegate = eventField.GetValue(sender) as MulticastDelegate;
        if (eventDelegate == null) return; // l'event n'est bindé à aucun delegate
        foreach (Delegate handler in eventDelegate.GetInvocationList())
        {
            handler.Method.Invoke(handler.Target, new Object[] { sender, new PropertyChangedEventArgs(propertyInfo.Name) });
        }
    } 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-05-07T18:09:39.703

只是为了使实施**更快**，您可以使用*代码片段*

来自[http://aaron-hoffman.blogspot.it/2010/09/visual-studio-code-snippet-for-notify.html](http://aaron-hoffman.blogspot.it/2010/09/visual-studio-code-snippet-for-notify.html)

> 遵循 MV-VM 模式的项目的 ViewModel 类通常需要从属性的设置器中引发“PropertyChanged”事件（以协助 INotifyPropertyChanged 接口实现）。这是一项乏味的任务，希望有朝一日可以通过使用编译器即服务来解决......

片段核心（**完全归功于**作者，不是我）如下

```
 <Code Language= "csharp "> 
    <![CDATA[public $type$ $property$ 
{ 
    get { return _$property$; } 
    set 
    { 
        if (_$property$ != value) 
        { 
            _$property$ = value; 
            OnPropertyChanged($property$PropertyName); 
        } 
    } 
} 
private $type$ _$property$; 
public const string $property$PropertyName = "$property$";$end$]]> 
</Code> 
```

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2013-01-23T10:20:35.510

只需在您的自动属性声明上方使用此***属性***

```
[NotifyParentProperty(true)]
public object YourProperty { get; set; } 
```

# java - 如何从 Java 密钥库创建 PFX 文件？

> ID：527610
> 
> 赞同：35
> 
> 时间：2009-02-09T10:02:59.640
> 
> 标签：java, .net, certificate, pfx, jks

我有一个持有单个证书的 Java 密钥库（.jks 文件）。如何从此密钥库创建 .pfx 文件？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-01-12T16:44:33.527

从 Java 6 开始，`keytool`有一个`-importkeystore`选项，它应该能够将 JKS 存储转换为 PKCS#12 存储 (.p12/.pfx)：

```
keytool -importkeystore -srckeystore thekeystore.jks \
            -srcstoretype JKS \
            -destkeystore thekeystore.pfx \
            -deststoretype PKCS12 
```

它会要求您输入源和目标（jks、pfx）文件的密码

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-05-13T07:58:23.757

[在http://teddyhai.blogspot.com/2009/06/how-to-convert-java-jks-keystore-to.html](http://teddyhai.blogspot.com/2009/06/how-to-convert-java-jks-keystore-to.html)查看指南

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T12:07:57.250

这家伙（）似乎已经编写了一个小的 Java 类和批处理文件，并在此处提供了很好的说明：[http ://www.crionics.com/products/opensource/faq/signFree.htm#DownloadTools](http://www.crionics.com/products/opensource/faq/signFree.htm#DownloadTools)

如果你想自己做，.bat 文件中的关键行似乎是使用

```
keytool -export -rfc -keystore %KEYSTORE% -storepass %PASSWORD% -alias %ALIAS% > %CERT_64%
java -classpath %JAVACLASSPATH% ExportPrvKey %KEYSTORE% %PASSWORD% %ALIAS% > %PKEY_8%
openssl enc -in %PKEY_8% -a >> %PKEY_64%
openssl pkcs12 -inkey %PKEY_64% -in %CERT_64% -out %CERT_P12% -export 
```

其中 ExportPrvKey 执行从密钥库中提取私钥的步骤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-20T14:33:11.607

`keytool -importkeystore -srckeystore [MY_KEYSTORE.jks] -destkeystore [MY_FILE.p12] -srcstoretype JKS -deststoretype PKCS12`

然后它会请求你的密码和 BAM - 很好，昨晚刚试过，效果很好。

您可能必须先将 dir 更改为您的 java jdk 或 jre bin 文件夹，然后包含当前 Keystore 的完整路径和 dest .p12 文件。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-10-13T20:33:42.657

您可以使用以下命令导出包含私钥的 PFX 文件：

```
keytool -importkeystore -deststorepass secret -destkeypass secret -destkeystore KEYSTOREFILE.jks -srckeystore PFXFILE.pfx -srcstoretype PKCS12 -srcstorepass secret 
```

# vb.net - VB.NET 自定义控件（自 定义绘图）刷新问题

> ID：527611
> 
> 赞同：2
> 
> 时间：2009-02-09T10:03:58.873
> 
> 标签：vb.net, controls, gdi+

我用 2 个项目创建了一个简单的解决方案。第一个项目（类库）包含一个名为 Container 的自定义控件，它使用圆角绘制自身。第二个项目（Windows 窗体）是一个测试应用程序。

如果我在第二个项目的主窗体中添加一个容器实例，它会很好地显示圆角。此外，当我运行第二个项目时，我可以看到容器。

但是，当我开始移动表单（单击并按住标题栏）时，尤其是当我快速移动它时，所有的绘图都搞砸了，一遍又一遍地绘制，但没有先清除它的表面......

我可以在 Form1.Move 事件中调用 Container1.Refresh()，但我不想每次都设置它，因为这也意味着我必须在`Form1.Resize`事件中调用 Container1.Refresh() 并且谁知道其他事件.. .

Container（控件）类本身是否存在我应该调用 Me.Refresh() 或 Me.Update() 或 Me.Invalidate() 的事件？

供参考（Form1.vb）

```
Public Class Form1

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

End Sub

Private Sub Form1_Move(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Move
    Me.Container1.Refresh()
End Sub
End Class 
```

供参考（Container.vb）：

```
Imports System.Windows.Forms
Imports System.Drawing
Imports System.Drawing.Drawing2D

Public Class Container : Inherits Control
    Private _Gp As GraphicsPath

    Private Sub Container_Paint(ByVal sender As Object, ByVal e As System.Windows.Forms.PaintEventArgs) Handles Me.Paint

        Dim r As Rectangle = e.ClipRectangle
        Dim gp As New GraphicsPath
        Dim cs As Integer = 25 'CornerSize'

        r.Inflate(-5, -5)

        gp.AddArc(r.X, r.Y, cs, cs, 180, 90)
        gp.AddArc(r.X + r.Width - cs, r.Y, cs, cs, 270, 90)
        gp.AddArc(r.X + r.Width - cs, r.Y + r.Height - cs, cs, cs, 0, 90)
        gp.AddArc(r.X, r.Y + r.Height - cs, cs, cs, 90, 90)

        Dim t As Single = cs / 2 + r.Y
        gp.AddLine(r.X, r.Y + r.Height - cs, r.X, t)

        e.Graphics.SmoothingMode = Drawing.Drawing2D.SmoothingMode.AntiAlias
        e.Graphics.DrawPath(Pens.Black, gp)
    End Sub

End Class 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T17:44:26.007

这是你的问题：

```
Dim r As Rectangle = e.ClipRectangle 
```

将其更改为：

```
Dim r As Rectangle = Me.ClientRectangle 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T10:20:27.227

在我看来，您的`Container`班级似乎并未绘制其整个区域 - 通常一个控件负责绘制其*整个*矩形。

为了拥有一个不这样做的控件 - 具有透明区域（如您的圆角） - 您需要为您的控件提供`WS_EX_TRANSPARENT`属性。请注意，这是一个 Windows API 主题，而不是 .NET 主题，因此您正朝着一些小巫术的方向前进。

虽然它是用 C# 编写的，但 CodeProject 文章[使用 C# 和 .NET 3.5 制作透明控件](http://www.codeproject.com/KB/miscctrl/transparent_controls.aspx)似乎与您要实现的目标直接相关。

要引用那篇文章，您首先需要覆盖 UserControl 的构造函数并配置背景：

```
public TranspControl()
{
     SetStyle(ControlStyles.SupportsTransparentBackColor, true);
     SetStyle(ControlStyles.Opaque, true);
     this.BackColor = Color.Transparent;
} 
```

然后，您需要重写`CreateParams()`设置控件样式的方法`WS_EX_TRANSPARENT`：

```
protected override CreateParams CreateParams
{
    get
    {
        CreateParams cp = base.CreateParams;
        cp.ExStyle |= 0x20;
        return cp;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T10:07:57.367

不必在此处强制重绘（在正常情况下），因为一旦您的控件被轻推，重绘就会自动强制执行。

但是，您*需要*做的是在绘制任何其他内容之前清除控件的背景：否则，您的绘制操作将与之前的绘制过程混合。只需添加一个

```
e.Graphics.Clear(BackColor) 
```

在`Paint`事件处理程序中的其他绘图操作之前。此外，请考虑使用`OnPaint`方法而不是`Paint`事件，因为您将控件子类化并且*不需要*求助于`Paint`事件处理程序。

为了记录，`Refresh`强制进行通常不需要的同步重绘。相反，使用`Invalidate`which 将重绘请求排入默认窗口消息队列。

# xml - DataContractSerializer：保留引用

> ID：527617
> 
> 赞同：3
> 
> 时间：2009-02-09T10:06:00.727
> 
> 标签：xml, wcf, serialization

只是好奇的问题。当我在使用 DataContractSerializer 序列化对象图时保留对象引用时，在有引用的地方发出的 xml 如下所示：

```
<test z:Ref="1" and i:nil="true" /> 
```

谁能告诉我为什么这里说 i:nil="true" ？为什么不只是参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-13T02:03:49.637

这是因为`test`元素的内容是空的。`i:nil="true"`是必要的，以便内容将验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-02T16:28:49.890

这是对您的元素的引用。您必须事先在文档中定义您的元素，如下所示：

```
<test z:Id="1">
    ...
</test> 
```

# c# - Web服务和配置

> ID：527624
> 
> 赞同：0
> 
> 时间：2009-02-09T10:07:46.963
> 
> 标签：c#, .net, web-services, configuration, .net-2.0

我使用 .NET 2.0 框架创建了一个 WebService，这是一个基于具有 WebServiceAttribute 的接口并使用 IIS 和一个 ASMX 文件托管它的类。WebService 当前从一个 XML 文件加载其配置。

我想创建这个服务的多个实例，每个实例都加载它自己的配置。

通过处理 ASMX 文件，我可以使用不同的名称创建 Web 服务的克隆，这将基于完全相同的实现。但它也加载了完全相同的配置文件，这使得它相当无用。

所以我的问题是：*创建任意数量的基于一个类的 Web 服务的最佳方法是什么，它们位于一个 IIS 虚拟目录中，每个目录都加载不同的配置文件？*

### 解决方案

在 Pavel Chuchuva 的回答的帮助下，我创建了以下代码来处理配置的加载：

```
public class WebConfigManager
{
    public static T Load<T>() where T: new()
    {
        string location = 
            HttpContext.Current.Request.PhysicalPath + ".config";

        if (HttpContext.Current.Cache[location] is T)
        {
            return (T)HttpContext.Current.Cache[location];
        }

        using (Stream s = 
            new FileStream(location, FileMode.Open, FileAccess.Read))
        {                
            return (T)(HttpContext.Current.Cache[location] = 
                new XmlSerializer(typeof(T)).Deserialize(s));                
        }
    }
}

// example of the usage of WebConfigManager
public class MyWebService : IMyWebService 
{
    Config config = WebConfigManager.Load<Config>();
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T10:21:40.627

我建议将 asmx 放在不同的文件夹中，并在每个文件夹中放置一个 web.config，并使用该特定 Web 服务实例的设置。这是简单快捷的方法

或者

您可以使用 Web Service Enhancements 3.0 并创建 WSE 路由器，将调用重定向到 ASMX 到该路由器，并让路由器将调用转发到正确的 Web 服务实例并传递额外的配置。这是一种更复杂的方法，但它使您能够使用 Web 服务的单个实例，该实例根据路由器传递的参数选择正确的配置。有关 WSE3.0 的更多信息，请参阅 MSDN。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T10:35:58.377

复制并粘贴 .asmx 文件以创建 Web 服务的多个实例（例如 Service1.asmx、Service2.asmx 等）。

根据 Context.Request.FilePath 值加载配置文件：

```
public string LoadConfig()
{
   string configPath = Server.MapPath(this.Context.Request.FilePath + ".xml");
   using (XmlReader reader = XmlReader.Create(configPath))
   {
      // Will read Service1.asmx.xml, Service2.asmx.xml and so on
   }
} 
```

# asp.net-mvc - Silverlight 2 从 MVC 应用程序获取成员/身份信息

> ID：527628
> 
> 赞同：1
> 
> 时间：2009-02-09T10:09:03.650
> 
> 标签：asp.net-mvc, silverlight-2.0

我有一个 MVC 应用程序，其中包含一个小的 Silverlight 菜单，该菜单显示为大多数页面中使用的 .Master 页面的一部分。

我还编写了一个 MembershipProvider（和一个角色提供者），它使用我的应用程序的数据库对用户进行身份验证和授权。工作正常。

但是，如果用户是管理员角色，我希望 Silverlight 菜单包含一些额外的项目。当然，一种可能性是制作两个 Silverlight 菜单应用程序，并根据母版页中的用户选择显示哪一个。但这对我来说有丑陋的一面。

如果 Silverlight 应用程序能够确定登录用户的身份并使用它来配置自身以显示管理选项，则更好的选择是。

有没有一种简单的方法来做这样的事情？MVC 应用程序和 Silverlight 应用程序部署在同一 IIS7 服务器上，并且是同一解决方案的一部分。

到目前为止，我在 Web 上找到的解决方案要么提示用户在 Silverlight 应用程序中单独登录，要么使用 WCF 服务进行大量工作。如果必须，我会走那条路，但我觉得应该有一种优雅、简单的方法来做到这一点。

我坚信 KISS 原则，因此高度赞赏简单！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T10:58:53.267

我非常确信您的 Silverlight 菜单不必知道用户是否是管理员。

如果您有一个可以显示任意数量项目的“通用样式”菜单控件，那么我认为应该传达这些项目。然后主视图应该决定要显示的项目。更好的是，控制器应该根据用户的状态返回要显示的项目，而主视图应该只呈现它们。

如果您有一个专门为适合您的 Web 应用程序而设计的菜单控件，但实际上并没有显示任何数量的项目，那么主视图应该只设置一个属性或其他东西来传达这一事实。

你的问题的其余部分让我有点困惑，但我相信你的 silverlight 组件本身并不是一个完整的“应用程序”，只是演示文稿的一部分。

# python - 如何使用 Beautifulsoup 在一些文本中嵌入 p 标签？

> ID：527629
> 
> 赞同：2
> 
> 时间：2009-02-09T10:09:05.773
> 
> 标签：python, beautifulsoup

我想 `<p`在有 \r\n\r\n 的地方嵌入 > 标签。

u“终于斯里兰卡出现了，阻止了他们的第一个 5-0 系列粉饰，并在连续 9 场 ODI 胜利中阻止了印度。\r\n\r\nYuvraj Singh 打了 62 球，打出了梦幻般的击球，让印度保持在比赛中尽管三柱门落在他周围。\r\n\r\n也许抛掷起了很大的作用。这只是 Mahela Jayawardene 在过去 11 次中第二次用硬币击败 Mahendra Singh Dhoni。\r\n\r\n它是 Jayasuriya 为斯里兰卡提供了跳板。\r\n\r\n在 Jayasuriya 被解雇后，烟火可能已经停止，但奔跑仍在以公平的速度进行。”

我尝试使用 BeautifulSoup 解决这个问题，但找不到解决方法。任何人都可以对此有所了解。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T10:15:15.477

```
''.join('<p>%s</p>' % line for line in text.split('\r\n\r\n'))
# Results:
u"<p>Finally Sri Lanka showed up, prevented their first 5-0
series whitewash, and stopped India at nine ODI wins in a row. </p>
<p>For 62 balls Yuvraj Singh played a dream knock, keeping India in the 
game despite wickets falling around him. </p><p>Perhaps the toss played
a big part. This was only the second time Mahela Jayawardene beat Mahendra
Singh Dhoni with the coin in the last 11 occasions. </p>
<p>It was Jayasuriya who provided Sri Lanka with the springboard. </p>
<p>The pyrotechnics may have stopped upon Jayasuriya's dismissal, but 
the runs kept coming at a fair pace.</p>" 
```

# javascript - 如何添加带参数的外部js文件

> ID：527633
> 
> 赞同：1
> 
> 时间：2009-02-09T10:10:21.463
> 
> 标签：javascript, load

我想给随机网站一个最小的 js 代码，以便他们可以添加一个小部件。

代码需要在主页加载后运行，并包含一个带有域名的参数。（我不想硬编码）

一种选择是在之前添加此代码`</body>`（因此它将在页面加载后运行）：

```
<script type="text/javascript" id="widget_script">  
    document.getElementById('widget_script').src=location.protocol.toLowerCase()+"//mywebsite.com/?u="+encodeURIComponent(window.location.host);        
</script> 
```

这适用于 IE，但不适用于 Firefox。我在 Firebug 中看到 src 属性已正确创建，但我的站点中的脚本未加载。

我的问题是：最好的方法是什么？（最好在标题部分放置最少的行。）

为了进一步澄清这个问题：如果我在标题部分放了一个脚本，我如何让它在加载并加载主页后运行？如果我在脚本中使用 onload 事件，我可能会错过它，因为它可能会在 onload 事件触发后加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T10:27:38.973

您可以尝试使用 document.write 静态包含脚本（这是一种较旧的技术，不建议使用，因为它可能会导致更现代的库出现问题）：

```
var url = location.protocol.toLowerCase() + 
    "//mywebsite.com/?u="+encodeURIComponent(window.location.host);
document.write('<script src="', url, '" type="text/javascript"><\/script>'); 
```

或者使用动态创建的 DOM 元素：

```
var dynamicInclude = document.createElement("script");
dynamicInclude.src = url;
dynamicInclude.type = "text/javascript";
document.getElementsByTagName("head")[0].appendChild(dynamicInclude); 
```

后期编辑：

为了确保脚本在 onload 之后运行，可以使用：

```
var oldWindowOnload = window.onload; 
window.onload = function() {
    oldWindowOnload(); 
    var url = location.protocol.toLowerCase() + 
        "//mywebsite.com/?u="+encodeURIComponent(window.location.host);
    var dynamicInclude = document.createElement("script");
    dynamicInclude.src = url;
    dynamicInclude.type = "text/javascript";
    document.getElementsByTagName("head")[0].appendChild(dynamicInclude); 
} 
```

I do not believe it can be shorter than this, apart from shorter variable names :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T10:23:08.017

为什么不使用 jQuery 的[getScript](http://docs.jquery.com/Ajax/jQuery.getScript#urlcallback)方法来进行加载呢？如果你不想依赖 jQuery，你可以[通过源代码](http://dev.jquery.com/browser/trunk/jquery/src/ajax.js#L115)来了解他们是如何解决它的。

查看广泛使用的库总是会向您展示您不知道自己遇到的问题的解决方案。例如，您可以看到 jQuery 如何在脚本加载时生成回调，以及它如何避免 IE 中所谓的内存泄漏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T10:18:20.557

您可能想要实现**非阻塞脚本技术**。本质上，您将创建并附加一个全新的脚本元素，而不是修改脚本的 src。

[在这里](http://www.artzstudio.com/2008/07/beating-blocking-javascript-asynchronous-js/)写得很好，在 YUI 和 jQuery 中有标准的方法可以做到这一点。这很简单，只有一个很好理解的问题（并在该链接中记录）。

哦，还有这个：

> 一种选择是在之前添加此代码`</body>`（因此它将在页面加载后运行）：

...在技术上并不正确：您只是将脚本放在加载顺序中的最后一件事。

# iis - I cannot access files in IIS 6

> ID：527636
> 
> 赞同：1
> 
> 时间：2009-02-09T10:11:44.690
> 
> 标签：iis

I have a default IIS 6 install and I can access only .html files. If I create a html file I can see it on the browser. Any other files like ini for example are not visible (404). Any idea on what can be the issue?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T10:40:54.090

This may help :

[IIS & ASP.NET blocking file](https://stackoverflow.com/questions/506744/iis-asp-net-blocking-file)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T10:41:26.320

1.  Check the web service extensions are enabled (in IIS below the websites is a folder for them) for the content you are trying to share.
2.  Check that the handler mappings is setup correctly (on the website properties)

# asp.net - 获取客户端 IP 地址：REMOTE_ADDR、HTTP_X_FORWARDED_FOR，还有什么有用的？

> ID：527638
> 
> 赞同：63
> 
> 时间：2009-02-09T10:12:29.697
> 
> 标签：asp.net, http, http-headers, ip, ip-address

我知道查看这两个变量是一种标准做法。当然，它们很容易被欺骗。我很好奇您多久可以期望这些值（尤其是`HTTP_X_FORWARDED_FOR`）包含真实信息，而不仅仅是被打乱或剥夺它们的值？

有这方面的经验或统计数据的人吗？

对于获取客户端 IP 地址的任务，还有什么其他有用的东西吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-27T14:47:55.050

除此之外`REMOTE_ADDR`，`HTTP_X_FORWARDED_FOR`还有一些其他的标头可以设置，例如：

*   `HTTP_CLIENT_IP`
*   `HTTP_X_FORWARDED_FOR`可以是逗号分隔的 IP 列表
*   `HTTP_X_FORWARDED`
*   `HTTP_X_CLUSTER_CLIENT_IP`
*   `HTTP_FORWARDED_FOR`
*   `HTTP_FORWARDED`

我发现以下站点上的代码很有用：
[http ://www.grantburton.com/?p=97](http://www.grantburton.com/?p=97)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-09T10:41:38.830

这取决于您网站的性质。

我碰巧在一些软件上工作，其中 IP 跟踪很重要，在合作伙伴网站使用的字段中，我猜大约 20% - 40% 的请求是可检测到的欺骗 IP 或标头空白，具体取决于时间日期和他们来自哪里。对于一个获得自然流量（即不是通过合作伙伴）的网站，我希望好的 IP 比例更高。

正如 Kosi 所说，要小心你在做什么 - IP 绝不是识别唯一访问者的可靠方法。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-03-27T04:38:33.523

我已将 Grant Burton 的 PHP 代码移植到可针对 HttpRequestBase 调用的 ASP.Net 静态方法。它可以选择跳过任何私有 IP 范围。

```
public static class ClientIP
{
    // based on http://www.grantburton.com/2008/11/30/fix-for-incorrect-ip-addresses-in-wordpress-comments/
    public static string ClientIPFromRequest(this HttpRequestBase request, bool skipPrivate)
    {
        foreach (var item in s_HeaderItems)
        {
            var ipString = request.Headers[item.Key];

        if (String.IsNullOrEmpty(ipString))
            continue;

        if (item.Split)
        {
            foreach (var ip in ipString.Split(','))
                if (ValidIP(ip, skipPrivate))
                    return ip;
        }
        else
        {
            if (ValidIP(ipString, skipPrivate))
                return ipString;
        }
    }

    return request.UserHostAddress;
}

private static bool ValidIP(string ip, bool skipPrivate)
{
    IPAddress ipAddr;

    ip = ip == null ? String.Empty : ip.Trim();

    if (0 == ip.Length
        || false == IPAddress.TryParse(ip, out ipAddr)
        || (ipAddr.AddressFamily != AddressFamily.InterNetwork
            && ipAddr.AddressFamily != AddressFamily.InterNetworkV6))
        return false;

    if (skipPrivate && ipAddr.AddressFamily == AddressFamily.InterNetwork)
    {
        var addr = IpRange.AddrToUInt64(ipAddr);
        foreach (var range in s_PrivateRanges)
        {
            if (range.Encompasses(addr))
                return false;
        }
    }

    return true;
}

/// <summary>
/// Provides a simple class that understands how to parse and
/// compare IP addresses (IPV4) ranges.
/// </summary>
private sealed class IpRange
{
    private readonly UInt64 _start;
    private readonly UInt64 _end;

    public IpRange(string startStr, string endStr)
    {
        _start = ParseToUInt64(startStr);
        _end = ParseToUInt64(endStr);
    }

    public static UInt64 AddrToUInt64(IPAddress ip)
    {
        var ipBytes = ip.GetAddressBytes();
        UInt64 value = 0;

        foreach (var abyte in ipBytes)
        {
            value <<= 8;    // shift
            value += abyte;
        }

        return value;
    }

    public static UInt64 ParseToUInt64(string ipStr)
    {
        var ip = IPAddress.Parse(ipStr);
        return AddrToUInt64(ip);
    }

    public bool Encompasses(UInt64 addrValue)
    {
        return _start <= addrValue && addrValue <= _end;
    }

    public bool Encompasses(IPAddress addr)
    {
        var value = AddrToUInt64(addr);
        return Encompasses(value);
    }
};

private static readonly IpRange[] s_PrivateRanges =
    new IpRange[] { 
            new IpRange("0.0.0.0","2.255.255.255"),
            new IpRange("10.0.0.0","10.255.255.255"),
            new IpRange("127.0.0.0","127.255.255.255"),
            new IpRange("169.254.0.0","169.254.255.255"),
            new IpRange("172.16.0.0","172.31.255.255"),
            new IpRange("192.0.2.0","192.0.2.255"),
            new IpRange("192.168.0.0","192.168.255.255"),
            new IpRange("255.255.255.0","255.255.255.255")
    };

/// <summary>
/// Describes a header item (key) and if it is expected to be 
/// a comma-delimited string
/// </summary>
private sealed class HeaderItem
{
    public readonly string Key;
    public readonly bool Split;

    public HeaderItem(string key, bool split)
    {
        Key = key;
        Split = split;
    }
}

// order is in trust/use order top to bottom
private static readonly HeaderItem[] s_HeaderItems =
    new HeaderItem[] { 
            new HeaderItem("HTTP_CLIENT_IP",false),
            new HeaderItem("HTTP_X_FORWARDED_FOR",true),
            new HeaderItem("HTTP_X_FORWARDED",false),
            new HeaderItem("HTTP_X_CLUSTER_CLIENT_IP",false),
            new HeaderItem("HTTP_FORWARDED_FOR",false),
            new HeaderItem("HTTP_FORWARDED",false),
            new HeaderItem("HTTP_VIA",false),
            new HeaderItem("REMOTE_ADDR",false)
    };
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-09T10:28:04.137

您的问题没有真正的答案，但是：
在我看来，通常依赖客户端 IP 地址不是一个好习惯，因为它无法以独特的方式识别客户端。

路上的问题是，有很多情况下 IP 并没有真正与客户端对齐：

*   代理/Webfilter (mangle 几乎所有东西)
*   匿名网络（这里也没有机会）
*   NAT（内部 IP 对您不是很有用）
*   ...

我无法提供任何*关于平均*有多少 IP 地址是可靠的统计数据，但我可以告诉你的是，几乎不可能判断给定的 IP 地址是否是真实的客户端地址。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T12:02:05.033

IP +“用户代理”可能更适合唯一访问者。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-01T19:26:11.640

如果您使用代理，您应该使用`X-Forwarded-For`：[http ://en.wikipedia.org/wiki/X-Forwarded-For](http://en.wikipedia.org/wiki/X-Forwarded-For)

它是一个得到广泛支持的[IETF 草案标准：](https://datatracker.ietf.org/doc/html/draft-ietf-appsawg-http-forwarded)

> 大多数代理服务器都支持 X-Forwarded-For 字段，包括 Squid、Apache mod_proxy、Pound、HAProxy、Varnish 缓存、IronPort Web Security Appliance、AVANU WebMux、ArrayNetworks、Radware 的 AppDirector 和 Alteon ADC、ADC-VX 和 ADC- VA、F5 Big-IP、Blue Coat ProxySG、Cisco Cache Engine、McAfee Web Gateway、Phion Airlock、Finjan 的 Vital Security、NetApp NetCache、jetNEXUS、Crescendo Networks 的 Maestro、Web Adjuster 和 Websense Web Security Gateway。

如果没有，这里有几个我见过的其他常见标题：

*   X-Client-IP ( [Apache](http://httpd.apache.org/docs/trunk/mod/mod_remoteip.html) )
*   X-Real-IP ( [Nginx](http://nginx.org/en/docs/http/ngx_http_realip_module.html#real_ip_header) )

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-22T10:26:09.127

从您的 JS 文件中调用以下操作方法（获取 ipv4 ip 地址）。

```
 [HttpGet]
    public string GetIP()
    {
        IPAddress[] ipv4Addresses = Array.FindAll(
            Dns.GetHostEntry(string.Empty).AddressList,
            a => a.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork);
        return ipv4Addresses.ToString();
    } 
```

保留断点后检查，并根据您的要求使用。它对我来说工作正常。

# c# - 设置 XslCompiledTransform 输出设置

> ID：527641
> 
> 赞同：1
> 
> 时间：2009-02-09T10:14:16.057
> 
> 标签：c#, .net, xslcompiledtransform

我正在编写一些依赖于一个子模块的 XslTransformation 的代码。

由于 XslTransformation 公开了一个名为 Outputsettings 的 XmlWriterSettings 字段，我认为在我的类中公开 XmlWriterSettings 字段也很酷，因此我可以使用我的 IoC 容器通过配置来配置 XmlWriterSettings。

但事实证明，Outputsettings 是一个只读字段，我找不到如何将一个传递给 Transform 的方法（没有 ctor 重载等）。

我是否遗漏了什么，或者是否有一些工厂方法可以使用给定的 XmlWriterSetting 创建 XslCompiledTransform？

问候丹尼尔/蒂格莱尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T13:15:42.520

请参阅[https://blogs.msdn.com/eriksalt/archive/2005/07/27/OutputSettings.aspx](https://blogs.msdn.com/eriksalt/archive/2005/07/27/OutputSettings.aspx)

# c++ - 优化迭代器定义

> ID：527663
> 
> 赞同：2
> 
> 时间：2009-02-09T10:24:46.047
> 
> 标签：c++, optimization, stl, iterator

这是一个（希望如此）非常简单的问题——最近有人告诉我，使用 C++ 风格的初始化比传统的（更常见的）赋值要好。

所以这段代码：

```
std::SomeSTLContainer::const_iterator it = container.begin();
std::SomeSTLContainer::const_iterator itEnd = container.end(); 
```

将比以下“慢”或效率低：

```
std::SomeSTLContainer::const_iterator it ( container.begin() );
std::SomeSTLContainer::const_iterator itEnd ( container.end() ); 
```

我理解这样做的原因 - 第一个示例导致默认构造和初始化，然后是后续分配，而不是第二个示例中的特定构造和直接分配。但是，在现代处理器/编译器上，它真的有什么不同吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T10:29:06.163

> 最近有人告诉我，使用 C++ 风格的初始化比传统的（和更常见的）赋值要好。

这是完全错误的。

> 我理解这样做的原因 - 第一个示例导致默认构造和初始化，然后是后续分配，而不是第二个示例中的特定构造和直接分配。但是，在现代处理器/编译器上，它真的有什么不同吗？

不，这没有什么区别。C++ 标准明确允许在这种情况下省略赋值，以便生成相同的代码。实际上，*所有*现代 C++ 编译器都这样做。

此外，Charles 是对的：这永远不会调用赋值运算符，而是调用复制构造函数。但正如我所说，即使这样也不会发生。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T10:29:44.240

你的推理不太正确。在定义中使用“=”不会导致默认构造和赋值。在“最坏”的情况下，它使用从“=”右侧生成的临时的复制构造函数。

如果右侧的类型是（除了常量/易失性）相同类型或被初始化对象的派生类型，那么这两种构造形式是等价的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T10:31:02.350

不，通常。这是因为迭代器被编码为非常薄的包装器，而优化器在涉及到薄包装器时非常激进。例如，普通的迭代器方法只是一个简单的指针操作，函数体可以从头文件中获得。这使得它可以简单地内联。在这种情况下，迭代器副本在幕后可能只是一个指针副本，所以同样成立。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T10:31:23.567

这实际上取决于具体情况，应该应用一般的经验法则：**measure**。

如果这些迭代器有很多实例化（可能在嵌套和排序循环中，那些较短的构造函数很容易产生影响）。尽管正如您所建议的那样，许多编译器已经可以自己优化它们。

要真正确定您的编译器是否这样做，只有一种方法：**测量**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T12:08:18.543

```
A a = A( arg1, arg2, ... ); 
```

正如鲁道夫所说，这个赋值可以用一个简单的结构代替：它是一个结构。事实上，它会被编译成更简洁的等价物

```
A a( arg1, arg2, ...); 
```

这主要是一个样式问题，但我不喜欢将“分配样式”结构与“初始化器样式”结构混合在一起。通过这种方式，我可以在整个代码中引入一致性。这归结为：始终使用初始化程序样式构造:)。

# .net - 在 .NET 远程调用期间识别客户端

> ID：527676
> 
> 赞同：9
> 
> 时间：2009-02-09T10:31:23.130
> 
> 标签：.net, multithreading, remoting

鉴于此 MarshalByRef 类：

```
public class MyRemotedClass : MarshalByRef
{
  public void DoThis()
  {
     ...
  }
  public void DoThat()
  {
     ...
  }
} 
```

客户端代码：

```
MyRemotedClass m = GetSomehowMyRemotedClass();
m.DoThis();
m.DoThat(); 
```

我可以让几个客户同时做同样的事情。我想区分客户。**如何在远程访问的方法中识别远程调用是由谁执行的？** 例如，我可以记录谁做了什么。（实际上，我不需要追溯真实的客户信息，我只是希望能够对客户的调用进行分组。）

[编辑添加更多背景信息]

我有大量的代码要覆盖，包括属性。因此，扩展输入参数列表不是一种选择。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-09T11:13:27.210

您可以做的一件事是通过实现一个`IServerChannelSinkProvider`.

将此类添加到您的远程主机项目中：

`ClientIPServerSinkProvider.cs`

```
using System;
using System.Collections;
using System.IO;
using System.Runtime.Remoting;
using System.Runtime.Remoting.Messaging;
using System.Runtime.Remoting.Channels;
using System.Threading;
using System.Net;

namespace MyRemotingEnvironment
{
    public class ClientIPServerSinkProvider : 
        IServerChannelSinkProvider
    {
        private IServerChannelSinkProvider _nextProvider = null;

        public ClientIPServerSinkProvider()
        {
        }

        public ClientIPServerSinkProvider(
            IDictionary properties, 
            ICollection providerData)
        {
        }

        public IServerChannelSinkProvider Next
        {
            get { return _nextProvider; }
            set { _nextProvider = value; }
        }

        public IServerChannelSink CreateSink(IChannelReceiver channel)
        {
            IServerChannelSink nextSink = null;

            if (_nextProvider != null)
            {
                nextSink = _nextProvider.CreateSink(channel);
            }
            return new ClientIPServerSink(nextSink);
        }

        public void GetChannelData(IChannelDataStore channelData)
        {
        }
    }

    public class ClientIPServerSink : 
        BaseChannelObjectWithProperties, 
        IServerChannelSink, 
        IChannelSinkBase
    {

        private IServerChannelSink _nextSink;

        public ClientIPServerSink(IServerChannelSink next)
        {
            _nextSink = next;
        }

        public IServerChannelSink NextChannelSink
        {
            get { return _nextSink; }
            set { _nextSink = value; }
        }

        public void AsyncProcessResponse(
            IServerResponseChannelSinkStack sinkStack, 
            Object state, 
            IMessage message, 
            ITransportHeaders headers, 
            Stream stream)
        {
            IPAddress ip = headers[CommonTransportKeys.IPAddress] as IPAddress;
            CallContext.SetData("ClientIPAddress", ip);
            sinkStack.AsyncProcessResponse(message, headers, stream);
        }

        public Stream GetResponseStream(
            IServerResponseChannelSinkStack sinkStack, 
            Object state, 
            IMessage message, 
            ITransportHeaders headers)
        {

            return null;

        }

        public ServerProcessing ProcessMessage(
            IServerChannelSinkStack sinkStack, 
            IMessage requestMsg, 
            ITransportHeaders requestHeaders, 
            Stream requestStream, 
            out IMessage responseMsg, 
            out ITransportHeaders responseHeaders, 
            out Stream responseStream)
        {
            if (_nextSink != null)
            {
                IPAddress ip = 
                    requestHeaders[CommonTransportKeys.IPAddress] as IPAddress;
                CallContext.SetData("ClientIPAddress", ip);
                ServerProcessing spres = _nextSink.ProcessMessage(
                    sinkStack, 
                    requestMsg, 
                    requestHeaders, 
                    requestStream, 
                    out responseMsg, 
                    out responseHeaders, 
                    out responseStream);
                return spres;
            }
            else
            {
                responseMsg = null;
                responseHeaders = null;
                responseStream = null;
                return new ServerProcessing();
            }
        }

    }
} 
```

然后，当您启动远程主机时，请执行以下操作：

```
BinaryServerFormatterSinkProvider bp = new BinaryServerFormatterSinkProvider();
ClientIPServerSinkProvider csp = new ClientIPServerSinkProvider();
csp.Next = bp;
Hashtable ht = new Hashtable();
ht.Add("port", "1234"); // Your remoting port number
TcpChannel channel = new TcpChannel(ht, null, csp);
ChannelServices.RegisterChannel(channel, false);

RemotingConfiguration.RegisterWellKnownServiceType(
    typeof(MyRemotedClass), 
    "MyRemotedClass.rem", 
    WellKnownObjectMode.SingleCall); 
```

在您的方法调用中，您可以通过以下方式访问客户端的 IP 地址：

```
public class MyRemotedClass : MarshalByref
{
    public void DoThis()
    {
        string clientIP = CallContext.GetData("ClientIPAddress").ToString();
    }
} 
```

# asp.net - 在 aspx.vb 中使用 Gridview（代码隐藏）

> ID：527684
> 
> 赞同：2
> 
> 时间：2009-02-09T10:38:38.370
> 
> 标签：asp.net, gridview, code-behind

我需要基于 2 个不同的数据源创建一个网格视图：主类和子类。我需要像下面这样列出它们：

```
产品信息
   子产品 1
   子产品 2

产品信息
   子产品 1
   子产品 2
   子产品 3
   子产品 4

```

等等......问题是“产品信息”和“子产品”都是动态的，因为两者的数量都可以变化，所以我必须在网格视图中创建一个网格视图，加上必要的过滤器。

出于这个原因，我认为最好在代码隐藏中完成所有操作，但我无法理解如何在代码隐藏中使用 gridview-class 并绑定它，以便它实际上在主 aspx 页面中显示某些内容。

基本上我要的是一个简单的例子，当你在 aspx -page 中除了 <asp:GridView/> 什么都没有时，你可以从代码隐藏（vb）中添加组件并显示它吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-18T13:17:03.727

VB代码：

```
Dim mydatatable As New DataTable
' Create columns
mydatatable.Columns.Add("field_a", Type.GetType("System.String"))
mydatatable.Columns.Add("field_b", Type.GetType("System.String"))
' Declare row
Dim myrow As DataRow
' create new row
myrow = mydatatable.NewRow
myrow("field_a") = "filed a row 1"
myrow("field_b") = "filed b row 1"
mydatatable.Rows.Add(myrow)

GridView1.datasource = mydatatable
gridview1.databind() 
```

asp代码：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="true" EmptyDataText="if im not at my desk im at the balcony contemplating suicide" >
<Columns></Columns>
</asp:GridView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T22:15:46.850

希望您已经弄清楚了这一点，但是为了其他人的利益，这就是我发现的。

首先，如果没有任何数据，ASP.NET 根本不会呈现 gridview……很烦人，但你能做什么。（实际上，您可能可以做一些事情，但我不知道它是什么！）。向您的数据表添加一个新行，您将更近一步。

其次，您正在为***datatable***指定列，而不是***gridview***，因此您希望`AutoGenerateColumns="True"`gridview 在生成列时从表中提取列名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T11:44:47.133

我不确定我是否理解你的问题？..但你只是想对你的网格进行数据绑定吗？

我会像这样在代码隐藏中正确创建gridview：

```
Dim gw As GridView = New GridView() 
```

或者您需要向您的 asp:GridView 添加一个 Id 和 runat="server" 以便能够在代码隐藏中使用它。

当您需要将组件放入您的gridview 时，您需要绑定一个数据源，例如一个通用列表。

```
Dim list As List(Of String) = New List(Of String)
gw.DataSource = list
gw.DataBind() 
```

如果你想让你的主要和次要像你展示的那样排列，我会使用 2 个网格？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-28T19:23:31.937

面对类似的问题，我发现这些文章非常有帮助：

1.  [ASP.NET 中的 GridView 不显示有或没有数据](https://stackoverflow.com/questions/10288800/gridview-in-asp-net-is-not-displaying-with-or-without-data)
2.  [在 ASP.Net 中动态创建 DataTable 并绑定到 GridView](http://www.aspsnippets.com/Articles/Create-DataTable-dynamically-and-bind-to-GridView-in-ASPNet.aspx "在 ASP.Net 中动态创建 DataTable 并绑定到 GridView")

根据我所学到的，以下步骤对我有用：

*   `Page_Load`在代码隐藏事件期间将您的 GridView 绑定到 DataTable
*   `IsPostBack`如果您只想在第一页加载时绑定，请检查属性
*   在 GridView 属性中，设置`AutoGenerateColumns="True"`

# c# - 匿名类型 VS 局部变量，什么时候应该使用？

> ID：527685
> 
> 赞同：4
> 
> 时间：2009-02-09T10:39:32.407
> 
> 标签：c#, .net

我不确定何时应该在 C# 中使用*匿名类型*而不是*局部变量。*

我有：

```
string  fullMessage // This is the full message including sender and recipient names

string sender = GetMessagePart(fullMessage, "from");
string recipient = GetMessagePart(fullMessage, "to");

//do some stuff and deliver the message 
```

我应该使用：

```
var msg = new { 
sender = GetMessagePart(fullMessage, "from")
recipient = GetMessagePart(fullMessage, "to")
}; 
```

反而？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T10:41:43.667

~~你的意思是静态类型的变量吗？请注意，匿名类型*是*静态类型的......~~（由于问题编辑而删除）

C#匿名类型有两个问题：

*   您不能通过方法 API 公开它们
*   你不能改变它们（成员是只读的）

如果您只需要了解单个方法中的数据，并且它是只读的，那么匿名类型就很方便（实际上这涵盖了很多情况）。

如果您需要改变数据或将其传递给调用者，则使用定制类或简单变量（等）。

在给定的情况下，我看不出使用匿名类型的理由；如果您只想要这些值，请使用单独的变量方法。如果“消息”具有定义的含义，请声明一个`Message`类并填充它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T11:20:04.323

在此方法之外将发件人和收件人分组在一起是否有意义？如果是这样，请考虑为他们创建一个类。如果不是，我*通常会*使用单独的局部变量，但我怀疑这主要是出于习惯。

我怀疑我们这里得到的是一对在概念上相关的局部变量。这种关系可能不够牢固，不值得一个完整的类型，但它在方法中是有意义的。在某些方面，使用匿名类型是一种非常巧妙的方法，可以使这种配对变得明显。另一方面，如果你的方法足够长以至于它确实需要额外的清晰度，也许你还是应该打破它。

请注意，使用匿名类型会使一些重构技术变得更加困难，因为该类型仅在方法中可用（没有一点hackery）。

我意识到这是一个空想的答案，但它确实让我觉得整体想法有一些优点 - 这有点像在函数式语言中使用元组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T10:48:24.057

在这种情况下使用局部变量（我认为这就是你的意思）。

匿名类型应该用于您需要标准名称类型但仅用于方法内部的实现目的的地方。它消除了创建新类型定义的繁琐工作。

这里不需要类型，所以不要使用匿名类型。

# delphi - Delphi 2009 软件包的 LIB 文件输出位置

> ID：527692
> 
> 赞同：1
> 
> 时间：2009-02-09T10:48:13.213
> 
> 标签：delphi, delphi-2009, packages, c++builder

在构建 Delphi 2009 组件包时，如何指定哪个目录应包含 C++ Builder 用户所需的生成的 .hpp 和 .lib 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T20:52:04.573

在 Project|Options|Delphi Compiler|Linking 页面上，前两项是 C++Builder .hpp 输出目录和 C++Buidler .obj 输出目录应该做你想做的事。.lib 和 .bpi 文件。但是，这些选项如何传递给编译器似乎存在一些错误......我将与负责它的工程师交谈。

在命令行 DCC32 中，您可以使用以下命令来控制放置这些项目的位置：

```
-N0<path> = unit .dcu output directory
-NH<path> = unit .hpp output directory
-NO<path> = unit .obj output directory
-NB<path> = unit .bpi output directory 
```

请注意，-NB 开关 AFAICR 还控制 .lib 文件的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T00:46:08.190

有一个已知的错误： http://qc.embarcadero.com/wc/qcmain.aspx?d= [67513](http://qc.embarcadero.com/wc/qcmain.aspx?d=67513) 这是 /expected/ 将在即将到来的更新 3 中修复。（不要担心构建中解决的 10.0编号，这是一个错误，将在更新 3 发布并且所有错误修复同步回 QC 时更正）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T14:35:41.140

据我所知，你不能。似乎没有一个目录选项可以控制它。但是，您可能会定义一个构建后事件（项目->选项->构建事件），它将文件复制到您想要的位置。

# html - IE7：textarea 的表单余量过大

> ID：527695
> 
> 赞同：6
> 
> 时间：2009-02-09T10:49:58.593
> 
> 标签：html, css, internet-explorer-7, margin

我正在尝试处理我的应用程序中的 IE7 错误。这是 HTML/CSS 代码

```
<div style="margin-left: 320px">
    <form method="post" action=""><fieldset>
        <textarea name="prj_comment" id="prj_comment" rows="5" cols="50" 
                  style="margin: 0; padding: 0"></textarea>
    </fieldset></form>
</div> 
```

在 Firefox/Opera/Webkit/IE6 中没问题，但在 IE7 中，textarea 有 100px 的左边距。如果有人有提示来纠正这个问题，非常感谢！

这是显示此示例 HTML 的 IE7 屏幕截图：

[http://daneel.net/pub/img/ie7_bug_decalage.jpg](http://daneel.net/pub/img/ie7_bug_decalage.jpg)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T16:52:12.420

这看起来像继承的边距错误（类似于但不同于带有浮动的双边距错误）。textarea 继承了表单周围 div 的边距。[Position Is Everything 更详细地描述了它](http://www.positioniseverything.net/explorer/inherited_margin.html)。

实际的解决方法是：

*   给 textarea 一个负的左边距 -320px （显然，仅适用于 IE）。
*   在文本区域之前放置一个内联元素，但在字段集中。看起来您可以将样式设置为 display:none，但元素不能为空。
*   将 textarea 包装在 div/span/any-other-tag 中，只要它没有任何为其提供布局的样式规则（我实际上会认为表单或字段集会修复它，但显然他们没有） .

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T11:10:56.357

完全奇怪。我实际上在 ie7 中得到了 320px（=父 div 边距）。

您可以只用 ie7 负边距覆盖，但这太糟糕了......

**编辑：** 好的，我不知道这为什么有效，但它有效。这绝对是一个错误：

```
<div style="margin-left: 320px; display:inline-block;">
    <form method="post" action=""><fieldset>
        <textarea name="prj_comment" id="prj_comment" rows="5" cols="50" 
                  style="margin: 0; padding: 0"></textarea>
    </fieldset></form>
</div> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T15:09:30.777

似乎是 IE 对 <fieldset> 的默认样式的错误。我的猜测是，在内部，IE 正在使用`float`代码设置字段集的样式并触发臭名昭著的[Double-margin bug](http://www.positioniseverything.net/explorer/doubled-margin.html)。

我设法通过将包装器 <div> 直接放在 <fieldset> 中来解决这个错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-02T10:39:50.877

另一个（也很糟糕）的解决方案是`&nbsp;`在前面添加`<textarea>`...但是恕我直言，我可以用干涩的解决方案来对抗肮脏的 IE 错误...如果你愿意的话... ;)

# coldfusion - 将 ColdFusion 5 基于标签的代码重构为 CFC

> ID：527697
> 
> 赞同：2
> 
> 时间：2009-02-09T10:50:50.273
> 
> 标签：coldfusion, refactoring, cfc, coldspring, transfer-orm

我觉得有必要将基于 CF5 的旧代码重构为 CFC。我们已经在 ColdSpring 和 Transfer 中有一些代码，但感觉对 ColdSpring 和 Transfer 进行大量重写是没有意义的。

我会遇到什么技巧、方法和陷阱。

我怎样才能让这变得容易？

我不介意将 ColdSpring 加入其中，但 Transfer 是我对项目规模感到害怕的一点。

编辑：我的代码库已经使用了 7-8 年并且非常庞大。描述它会很困难，但是我正在寻找关于方法的通用建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T13:07:59.727

如果它基本上可以工作，仅仅为了它而改变整个代码库会给你的系统带来很多潜在的错误。我不认为有一个简单的方法可以做到这一点。

如果您查看您网站的区域，即 1：最有可能改变和 2：执行最多，您可能能够定位一些可以从改变中受益的区域，并了解它们在基于 CFC 的框架中的适应程度，以及有什么好处。但是对于大多数代码来说，如果它工作正常，则可能没有迫切需要更改。

但是，当您需要对系统的一部分进行重大更改时，可能值得从 OO 的角度进行查看，并在适用的情况下将现有代码移过来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T13:03:47.897

在我正在进行的一个项目中（几乎相同的情况，甚至更多——大多数代码都非常糟糕），我正在使用我称之为“波浪式”的技术。我使用的一般想法如下：

1.  从输出中分离处理。我不能在这里实现真正的 MVC，但至少我可以将视图移动到单独的模板中（有时重复使用它们）并在基本（模型）模板中准备所有数据。
2.  将所有重复的代码移动到组件中——这是最重要的技巧之一。
3.  将相关功能分组到组件中。比如说，所有与客户相关的信息都归入 CustomerManager.cfc，发票归入 InvoiceManager.cfc 等。

为什么是“波”？在一个大项目中，我不能坐下来重写所有与客户相关的代码。所以我一步一步做到了。例如，我必须处理客户注册，用一些属性对其进行扩展。我已经创建了基本组件，将验证表单的方法移到那里（检查登录、电子邮件等）并添加客户 - 所以这个页面以新的风格工作。后来我需要改进发票页面，我需要在其中获取发票所有者的详细信息：我只是将方法添加到客户经理中并摆脱直接查询。稍后编辑客户页面......也可以称为“按需重构”或smth。

根据您当前的项目状态，可能还有其他内容。但这对我帮助很大。希望您会发现这些提示很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T14:50:31.150

在您更改任何内容之前：**创建一整套回归测试！**

重构时，目标必须是首先保留功能，这样您就不会直接影响您的客户。

我也同意 Sergii 的波浪式重构——这使您可以将事情分解成可管理的块，而不是一次性完成所有事情。

但是无论你有什么方法，你可以创建的回归测试越多越好——这确实是你可以确认你没有无意中改变某些东西的唯一方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T10:58:15.000

在不知道您的任何代码的情况下，这是非常难以回答的（几乎是不可能的）。

这个问题有点像“我想拆解我的旧大众汽车并从零件中建造一个新的，我应该考虑什么？” :-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T14:32:59.430

我的建议是首先将您的业务逻辑封装到 CFC 中，而不是担心您网站的整个表示层。

通过只专注于业务逻辑，您将能够将最重要的功能引入 CFC 并减轻维护噩梦。将这些 CFC 直接“放入”您现有的站点也不会太难。

在将尽可能多的业务逻辑添加到 CFC 中之后，您会注意到这个巨大的怪物已经被缩小了。此时，您现在可以决定要对站点的表示层做什么。您现在可以从众多可用的框架（CFWheels、FuseBox、ColdBox、Mode-Glue）中自由选择以移植到表示层上。

或者你可以说“见鬼”，然后从一开始就在 CFWheels 中重写整个内容:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-20T20:40:04.240

如果您不使用版本控制，请在执行其他任何操作之前进行设置。能够退出中断的重构是一个重要的救生员。之后，我同意发布的内容。您将希望一次处理小块 - 分而治之。

# c# - 比较同一 URI 的不同表示

> ID：527698
> 
> 赞同：2
> 
> 时间：2009-02-09T10:51:35.703
> 
> 标签：c#, web-services, ip-address

我们有以下情况：

客户端通过 Web 服务向服务器发送事件/消息。服务器可以根据“Sender URI”识别客户端。服务器现在必须将消息分发给“感兴趣的听众”。

现在可能是客户端说它是例如[http://127.0.0.1:8000/](http://127.0.0.1:8000/)在该客户端配置为[http://localhost:8000](http://localhost:8000)的服务器上。Uri.Compare( ) 和 Uri.Equals 都返回 false。

有谁知道可以识别 URI 及其所有表示的算法？我的意思是 Localhost == 127.0.0.1 == "Real IP" == "DNS-Name" ？

谢谢托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T13:53:38.687

因为还没有人发布答案，所以我将继续使用我自己制作的“算法”/方法，它试图比较所有不同的表示。

我发现了什么：在服务器上，不可能在所有情况下都确定远程 URL。可能是用户帐户或服务器所在的子网没有足够的权限来确定例如哪个 IP 在 Active Directory 名称后面。

所以总会有服务器需要一个手动填充的文件左右的问题，它用它作为基础来确定它是否知道sender-URI。

# jquery - jQuery 通过链接快速选择产品

> ID：527699
> 
> 赞同：0
> 
> 时间：2009-02-09T10:52:19.210
> 
> 标签：jquery

这将很难解释，但我会尽力而为。

我有一个包含 3 个 div 的页面，每个 div 包含每个产品的信息和一个订单按钮。访问者可以点击产品图片，它基本上会隐藏所有的 div，然后显示与他们点击的图片相关的一个。

我有一个侧边栏，它在网站的所有页面上全局运行，每个产品都有“快速链接”。我想知道是否有一种方法可以将这些链接到产品页面，以便人们可以从站点的任何页面单击它们，它将打开产品页面，其中他们单击的产品已经被选中并可见。

我认为可以通过在产品页面链接末尾使用#product1、#product2 等来完成，但我不太确定如何实现。有没有人有任何想法？

PS：在产品页面上，仅通过检测产品图像上的点击然后隐藏和显示一个单一的 DIV 来选择产品（而不是通过使用 # 链接锚点）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T11:11:11.460

你想使用锚。

因此，您在 DIV 中命名了一个锚点。

```
<div id="product1">
<a name="product1">
</div> 
```

然后你用你描述的'#'链接到那个。如果您从另一个页面链接，请使用完整路径，如果您从同一页面链接，请使用#product1。

```
<a href="/path/to/page/#product1"> 
```

现在，您发现的棘手之处在于 jQuery 意识到您在页面加载时请求了一个锚点。这段代码确实依赖于像上面这样的结构，其中 div 的 id 与锚点同名。这里有一小段示例代码来调用 div 上的 show() 方法，该方法与传递到 URI 中的锚点同名。

```
$(document).ready(function() {
    var uri = document.location.toString();
    if (uri.match("#")) {
        anchor = uri.split("#")[1];
        $('#' + anchor).show();
    }
}); 
```

# c# - 对于 Web 开发人员来说，学习什么好的桌面编程语言是什么？

> ID：527700
> 
> 赞同：16
> 
> 时间：2009-02-09T10:52:58.973
> 
> 标签：c#, c++, c, programming-languages

我想学习一种桌面编程语言，最好是 C、C++ 或 C#。我是一名 PHP/HTML/CSS 程序员，我想进入桌面应用程序。我需要一些非常强大的东西，我希望能够使用 Windows GUI 创建应用程序。

Stack Overflow 社区会推荐什么？在深入研究这些语言之前，我应该具备什么知识吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-02-09T11:06:44.497

编辑：

一个**web 程序员**想要创建**Windows 应用程序**，你推荐 C?

## 你们这些人怎么了？！

/编辑

### 显然是 C#。

C# 将更容易进入，并允许您使用 WinForms 或 WPF 以及 .NET 中的所有新 Microsoft 工具构建 Windows 应用程序。如果您熟悉 PHP，那么您应该已经熟悉语法、面向对象的概念、异常处理等。

如果你只想创建 Windows GUI，我建议你不要用 C 来复杂化你的生活，绝对不要用 C++。它们确实提供了良好的教育体验，并且对于更高级的事情（例如使用其他工具包的跨平台开发）很有用，但代价是学习曲线更陡峭并降低了生产力。

此外，如果您是**Web 开发人员**，C# 是您可以（实际上，呵呵）用于 Web 的 3 个选项中**唯一的语言。**ASP.NET 不是一个糟糕的框架，也可能值得研究。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-09T10:53:58.193

先简单看一下C，到写几个教程程序的水平。C 很小，定义明确，明确的语言定义（Kernighan & Ritchie - The C Programming Language）只有几百页长。尽管了解指针和递归可能是一个挑战，但语言本身足够小，可以完全了解该语言。编写 C 语言的乐趣之一是，达到无需不断参考文档以了解如何使用鲜为人知的特性 x 或库函数 y 即可编写代码的水平并不难。将学习 C 视为奠定基础。

但是，要真正编写有用的应用程序，您需要使用 C++ 或 C#。这取决于你想写什么。由于垃圾收集和一般易用性，C# 可能会在大多数面向业务的情况下得分，但 C++ 会在高性能、低级别或游戏领域得分。还有大量可用的 C++ 库代码，可以相对轻松地利用（以及易于调整的纯 C 代码）。如果你的目标是写一些有特定问题的东西，那么这种可用性很可能会抵消 C++ 在完成任务时的更高开销。

作为示例，我在 Sourceforge 上对“图像”进行了过滤搜索，并返回了以下项目计数

C#：139
C++：569

即使有一些故意更面向业务的 C++ 仍然得分更高 - “财务”

C#：12
C++：32

对于任何数学或技术，分数都非常依赖于 C# - '分形'

C#：4
C++：44
C：24 <--（C++ 明确排除）

这当然是一个非常粗略的分析，但例如，如果我的目标是编写一个桌面分形生成器程序，那么我会选择 C++ 而不是 C#，因为在 C++ 中处理 UI 所涉及的额外工作很容易被过多的C++ 中可用的示例代码。OTOH，如果我正在编写一个业务应用程序，而拥有示例代码和大量 UI 来处理并没有太大优势，那么我会选择 C#。

事后编辑：至少首先熟悉 C 的另一个原因是，在 Mac 和 iPhone 上也有 Objective-C 作为主要开发环境。Objective-C 是具有非常薄的包装器的 C，并且只是 C++ 的第一个表亲，所以如果您设想您可能处于想要将代码移植到 Mac 或直接在 Mac 上开发的位置，那么我认为您会如果您至少对 C++（或 C#）如何在 C 上构建而不是必须“侧身”跨过树有一些感觉，就会发现它不那么令人困惑。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-09T10:54:50.173

“我需要一些非常强大的东西，我希望能够使用 Windows GUI 创建应用程序。”

对于丰富的 Windows GUI，我很想看看“xaml”变体：WPF（完整桌面）和 Silverlight（如 Flash）——这将为您提供最新的工具等，以及大量的样式功能。

为此，C# 将是首选。托管 C++ 是一种选择，但它的工作量更大。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-09T10:56:20.510

C# 与其他人确实解决了完全不同的事情，但考虑到您的网络背景和快速开发方法，我*肯定会*选择 C#

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-09T11:54:28.750

我的建议是学习 C++。C# 很好，但它会阻止您编写可移植的代码。如果你学习 C++，你有很多选择。在 Windows 中，您可以使用带有 .NET 框架的 Windows 窗体应用程序或 WPF。MFC 是另一个不错的选择。QT 是在多个平台上工作的另一种选择。因此，通过学习一种语言，您可以为多个平台编写代码，并且您可以获得各种 GUI。学完C++，再学C#就小菜一碟了。

祝一切顺利

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-09T10:55:54.147

C# 是其中最高级别的语言，这意味着它是完成您想要的最简单的语言。

Windows GUI 肯定可以用 C++ 甚至 C 制作，但更难。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-09T11:08:18.377

绝对首先要了解基础知识：学习 C。

然后去你真正的目标。如果您想放弃任何使用多平台 C# 的机会。你会想要使用 C++ 和 Qt 或 wxWindows。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-09T11:02:40.417

在我看来，你应该开始学习 C，以对内存、文件访问等方面有一个基本的了解。C 是一种低级语言，这意味着您可以更好地控制访问操作系统的方式，但是要创建 Windows 应用程序，您必须编写大量代码行。出于这个原因，在用 C 做一些事情之后，我应该从 C# 和 Visual Studio 2008 开始。.Net 框架带有大量的类，让你的生活更轻松。

希望能帮助到你。亲切的问候。何塞马。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-09T11:11:08.683

C/C++ 都允许低级编程。这意味着一切皆有可能，但即使是简单的事情也可能很难。如果这就是你说你想要一些强大的东西时的意思，那么你可能应该从 C++ 开始。它至少为您提供了一些不错的 GUI 库（带有 gtkmm 或 qt 的 gtk+），而使用 C 进行 GUI 编程很痛苦。

另一方面，如果您想快速开发应用程序（这就是您所说的强大的意思），那么 C# 可能是要走的路。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-09T10:56:49.607

我会推荐 C#。它不如其他两个强大，但对于您的需要，我相信 C# 将是最不痛苦的。C 和 C++ 是低级语言，所以我认为它们对于 GUI 和其他东西会做很多工作。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-09T10:59:16.837

保存 C。对于那些建议学习 C 的人，请为此提供论据。我声称学习 C 而不是 C++ 绝对没有任何好处。与他们不同，我有[论据](https://stackoverflow.com/questions/48496/how-to-teach-a-crash-course-on-c/48508#48508)来[支持这一主张](https://stackoverflow.com/questions/496804/should-i-start-learning-c-or-c/496893#496893)。

简而言之：从所有意图和目的来看，C 已经是 C++ 的一个子集，但它远非最有趣的子集。它只提供了对新编程范式的非常有限的洞察力。另一方面，C++ 定义了一些*非常*有趣的新范式，此外，这些范式是对 C 必须提供的所有内容的概括（即迭代器，它是指针的概括）。

重申一下：*如果*在 C 和 C++ 之间进行选择，请选择 C++。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-09T11:16:32.227

尽管我同意 C 是“有用的”，但知道它对于大多数程序员来说肯定不再重要。这些天对我来说，它的主要功能是让我了解底层硬件如何影响程序性能和行为，但这就是它的结束。在过去的 9 年里，我没有在开发工作中使用过它。

关于掌握面向对象的开发，我觉得 C# 和 C++ 都会为您提供坚实的基础，但 C++ 更加灵活（并且更难正确使用），而 C# 更加一致，如果您是打算进入.NET开发。因此，我建议学习 C# 和一种“新”的 .NET 演示技术，如 Windows Presentation Foundation 或 Silverlight。或者，先学习 Windows 窗体，但它有点缺乏演示。

我推荐 C 的唯一情况是，如果您要使用相当低级的东西，例如设备驱动程序、嵌入式控制器或类似的东西，但在大多数情况下，您仍然可以使用 C++。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-09T12:01:07.593

再次，对 C# 和对 C 的另一票投反对票。从技术角度来看，C 确实很有趣，并且会教你所有的细节，但事实是，你不需要知道所有的细节来制作应用程序。如果您的目标是让某件事情发挥作用（听起来确实如此），那就是 C#。C# 是三者中的最高级别，这意味着更少的时间与语言抗争，更多的时间让东西工作。

在我看来，大多数人都在建议您学习 C，以便您最终可以制作更好的 C# 程序。何必等呢，直接去 C# 学习吧。我确实认为 C++ 是一门绝对优秀的语言，总有一天你应该学习它，但是如果你从未学习过 C 或 C++，你没有理由不能制作一门高质量的 C# 语言——很多人每天都这样做！

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-09T12:52:02.510

通过各种语言，首先是 Unix 上的 C，然后是带有 MFC 的 C++，然后是 C#（从 1.0 开始），我认为回到该语言的早期版本有点像学习拉丁语。哦，可能只是从那里偷了保罗格雷厄姆的东西，但我同意。

如果你必须有一个最小的目标代码大小，C 是非常好的，非常适合嵌入的东西，它是汇编语言的一个步骤。我正在考虑诸如 Microchip PIC 之类的东西，您可能只有 1K 字的程序空间。

如果您可以拥有更大的对象大小但仍需要能够直接锤击金属，那么 C++ 非常好——因此诸如设备驱动程序、网络堆栈等之类的东西。这种胶水程序位于一切之下。

一个操作系统可能最终出现在这两种情况中——或者更可能是两者的混合，这取决于程序员、代码的年龄、它需要与之交互的内容、外面的雪的深度（再运行一次，然后我'会写那个方法！）

C# 非常擅长更高级别的以业务为中心的用户层应用程序。它们可以是基于网络的、基于客户端的、两者的混合——这并不重要。.net 家族的好处是你有一个丰富的库，这对这一层很重要，而且它一直在被大力开发以变得更丰富。

随着计算机变得越来越强大，开发人员的成本超过了处理器或内存的成本。

使用 C#，忽略 C 和 C++。当您对 C# 感到满意时，您将不再需要使用较低级别的语言进行编程以提高速度。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-09T10:56:04.413

你从哪种语言开始并不重要，但如果我是你，我会这样做：

从 C 的基础开始（可能很难理解） 迁移到 C++ 最后是 C#

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-09T11:00:47.707

我建议你从 C# 开始，但很快就进入 C++，因为一旦你学会了一般的编码，你应该回到你的根。我目前正在学习电子学，因为我要回到更远的地方。您对如何以及为什么知道得越多，您就越能了解如何最好地到达您需要去的地方。我认为一个不知道任何低级语言的 C# 程序员会编写相当次优的代码，但是一个学习 C# 的低级程序员会对所有托管的东西过于谨慎。因此，无论您选择什么，从长远来看，您都应该考虑两者兼而有之。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-09T11:11:17.357

我会选择 C#。

我已经和其他 2 人一起度过了我的时间（很多时间），并找到了 C# 'cleaner'。您还可以获得 .Net 中包含的各种函数的丰富库。我假设您对开发其他非 Windows 平台不感兴趣，这可能是选择 C ​​或 C++ 的理由。我还假设您不需要从系统中挤出最后一滴性能，而 C 可能会给您带来轻微的优势。

对于那些说你应该学习 C 才能理解编程的真正工作原理的人，我想说你应该学习汇编程序才能理解 C 的工作原理。我做到了，它确实有帮助，但它真的值得痛苦吗？要成为一名程序员，你必须打开你的大脑。想想你在做什么并理解你的工具！

我的投票：C#

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-09T11:28:09.577

学习 C#。

从基础开始很好，但比从 CI 开始更好的是从 C# 的基础开始。这将为您提供 C# 基础知识的坚实基础，并且在您可以转向更高级的主题之后。

例如，您可以在[此处](http://www.charlespetzold.com/dotnet/index.html)查看 Charles Petzold “.NET Book Zero” 。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-09T12:34:03.757

我建议：：

首先进入C。花一些时间习惯它（但不要太多）

然后进入C#。这就是您可以更轻松地处理 GUI 事物的方式。像 VisualStudio 这样的 IDE 可以帮助您处理 GUI。

如果你想成为一个真正优秀的 C/C++/C# 程序员，那可能不是好方法，但我认为你对成为 Guru 或类似的东西不感兴趣 :)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-09T19:07:06.493

用 C# 开发 Windows 应用程序的工作比 C 或 C++ 多得多。学习 C#。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-09T21:58:28.440

C# 是一个很好的起点。您可以免费获得它，并且可以使用 XNA studio（也是免费的）制作一些有趣的图形。

如果您有特定的理由，我只会学习 C++。

如果您正在进行 Windows 编程，我建议您阅读[Petzold 的 Programming Windows](http://www.charlespetzold.com/pw5/)书籍的前几章。它将使您对 C 以及 Windows 如何在裸机级别上工作有一个基本的了解。您实际上并不需要学习 C。Charles Petzold 握着您的手，让您在基本的 C Windows 程序中启动并运行。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-12T14:29:31.243

学习 C#...如果您想开发桌面应用程序。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-09T10:58:23.220

没有 C/C++/C# 经验的从 C 开始。编辑：好的，直接从 C# 或 C++ 开始不要浪费时间。您不能再用 C 认真地编写 Windows 桌面应用程序了，这太痛苦了。

然后转向面向对象的语言以获得更强大的东西。

如果您不想远离 windows 平台，C# 不是更好的选择，或者查看 Mono 平台。

IMO，C# 比 C 和 C++ 先进得多，您将更快地构建大型应用程序。WPF 库将为您提供没有 Windows 样式的漂亮 UI（但仅在 Windows 系统上......）

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-09T11:36:34.283

使用标准 C++ 中的适当库集，内存可以变得像托管（智能指针）一样简单。一些 C++ 小部件库与 C#.NET 一样易于使用。然而，由于有几个抽象层，它的性能可能会比 C# 差。使用 C++，您需要学习非标准库。使用 .NET，您需要的大多数组件都是标准的。

C是古老的，没有STL。它要求你聪明，但我怀疑它的优点。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-02-09T11:49:35.673

> 我需要一些非常强大的东西，我希望能够使用 Windows GUI 创建应用程序。

好吧，C 非常强大，因此可以处理该标准，但是如果您的目标是 GUI 应用程序，C# 和 WPF 之类的东西会让生活变得如此简单。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-02-09T16:11:05.963

您是否打算为 Windows 制作基于 gui 的应用程序？取决于什么，我推荐VB。但是，鉴于您的选择，我会选择 C#。

# java - 如何使用 Google Finance API 获取股票报价？

> ID：527703
> 
> 赞同：123
> 
> 时间：2009-02-09T10:54:10.143
> 
> 标签：java, php, javascript, google-api, google-finance

我正在寻找对来自 Google 服务的财务数据的访问权限。

我找到了获取 Microsoft 股票数据的[这个 URL 。](http://finance.google.com/finance/info?client=ig&q=NASDAQ:MSFT)

Google 允许此类 HTTP 请求的所有可能参数是什么？我想看看我能得到的所有不同的信息。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2011-04-15T01:48:00.777

[Google Finance Gadget API](https://web.archive.org/web/20111209142224/http://code.google.com/apis/finance/docs/finance-gadgets.html)自 2012年10 月起正式[弃用](http://googlecode.blogspot.com/2011/05/spring-cleaning-for-some-of-our-apis.html)，但截至 2014 年 4 月，它仍然有效：

~~[http://www.google.com/finance/info?q=NASDAQ:GOOG](http://www.google.com/finance/info?q=NASDAQ:GOOG)
[http://www.google.com/finance/info?q=CURRENCY:GBPUSD](http://www.google.com/finance/info?q=CURRENCY:GBPUSD)
[http://finance.google.com/finance/ info?client=ig&q=AAPL,YHOO](http://finance.google.com/finance/info?client=ig&q=AAPL,YHOO)~~

您还可以获取图表：[https ://www.google.com/finance/getchart?q=YELP](https://www.google.com/finance/getchart?q=YELP)

**请注意，如果您的应用程序是供[公众使用的，那么使用 Google Finance API 将违反 Google 的服务条款](https://groups.google.com/d/msg/google-finance-apis/O8fjsgnamHE/-ZKSjif4yDIJ)。**

检查[google-finance-get-stock-quote-realtime](http://digitalpbk.com/stock/google-finance-get-stock-quote-realtime)以获取 python 中的完整代码

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-02-09T11:25:00.177

有一个用于管理投资组合的完整 API。*链接已删除。Google 不再为此提供开发者 API。

获取股票报价有点困难。我发现一篇文章有​​人使用 Google 电子表格获取股票报价。

您也可以使用这些[小工具](http://googlefinanceblog.blogspot.com/2007/10/api-gadgets-and-tabs-oh-my.html)，但我想这不是您想要的。

您提到的 API 很有趣，但似乎没有记录（据我无论如何都能找到）。

以下是一些[历史价格](http://computerprogramming.suite101.com/article.cfm/an_introduction_to_google_finance)信息，仅供参考。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-09-21T16:13:26.767

我发现这个网站很有帮助。

[http://benjisimon.blogspot.com/2009/01/truly-simple-stock-api.html](http://benjisimon.blogspot.com/2009/01/truly-simple-stock-api.html)

它链接到一个 yahoo 似乎提供的非常简单和有用的 API。

例如：

[http://finance.yahoo.com/d/quotes.csv?s=GOOG+AAPL&f=snl1](http://finance.yahoo.com/d/quotes.csv?s=GOOG+AAPL&f=snl1)

完整的细节在这里：

[http://www.gummy-stuff.org/Yahoo-data.htm](http://www.gummy-stuff.org/Yahoo-data.htm)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-03-03T14:37:43.033

编辑： api 调用已被谷歌删除。所以它不再起作用。

同意 Pareshkumar 的回答。现在有一个用于 url 调用的 python 包装器[googlefinance 。](https://pypi.python.org/pypi/googlefinance/0.4 "谷歌财经")

安装 googlefinance

```
$pip install googlefinance 
```

很容易得到当前的股票价格：

```
>>> from googlefinance import getQuotes
>>> import json
>>> print json.dumps(getQuotes('AAPL'), indent=2)
[
  {
    "Index": "NASDAQ", 
    "LastTradeWithCurrency": "129.09", 
    "LastTradeDateTime": "2015-03-02T16:04:29Z", 
    "LastTradePrice": "129.09", 
    "Yield": "1.46", 
    "LastTradeTime": "4:04PM EST", 
    "LastTradeDateTimeLong": "Mar 2, 4:04PM EST", 
    "Dividend": "0.47", 
    "StockSymbol": "AAPL", 
    "ID": "22144"
  }
] 
```

谷歌财经是提供实时股票数据的来源。还有来自 yahoo 的其他 API，例如[yahoo-finance](https://github.com/lukaszbanasiak/yahoo-finance)，但它们对 NYSE 和 NASDAQ 股票延迟了 15 分钟。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-01T17:30:52.347

雅虎和谷歌数据的问题在于，如果您将其用于商业用途，则会违反服务条款。当您的网站/应用程序仍然很小时，它并不是什么大不了的，但是一旦您长大一点，您就会开始停止并停止交换。获得许可的解决方案示例是 FinancialContent：[http](http://www.financialcontent.com/json.php) ://www.financialcontent.com/json.php 或[Xignite](http://www.xignite.com)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-09T11:28:16.520

也许有趣的是，Google Finance API 文档包含[一个详细说明如何通过 JavaScript 访问不同参数的部分](http://code.google.com/apis/finance/docs/finance-gadgets.html#Raw_Data)。

我想 JavaScript API 可能是您上面提到的 JSON 请求的包装器......也许您可以检查正在发送哪些 HTTP 请求。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-12-15T15:50:31.857

建立在巨人的肩膀上......这是我写的一个单行代码，用于将所有谷歌当前的股票数据转换为本地 Bash shell 变量：

```
stock=$1 

# Fetch from Google Finance API, put into local variables
eval $(curl -s "http://www.google.com/ig/api?stock=$stock"|sed 's/</\n</g' |sed '/data=/!d; s/ data=/=/g; s/\/>/; /g; s/</GF_/g' |tee /tmp/stockprice.tmp.log)

echo "$stock,$(date +%Y-%m-%d),$GF_open,$GF_high,$GF_low,$GF_last,$GF_volume" 
```

然后，您将拥有 $GF_last $GF_open $GF_volume 等变量。运行 env 或查看 /tmp/stockprice.tmp.log 内部

```
http://www.google.com/ig/api?stock=TVIX&output=csv by itself returns:

<?xml version="1.0"?>
<xml_api_reply version="1">
<finance module_id="0" tab_id="0" mobile_row="0" mobile_zipped="1" row="0" section="0" >
<symbol data="TVIX"/>
<pretty_symbol data="TVIX"/>
<symbol_lookup_url data="/finance?client=ig&amp;q=TVIX"/>
<company data="VelocityShares Daily 2x VIX Short Term ETN"/>
<exchange data="AMEX"/>
<exchange_timezone data="ET"/>
<exchange_utc_offset data="+05:00"/>
<exchange_closing data="960"/>
<divisor data="2"/>
<currency data="USD"/>
<last data="57.45"/>
<high data="59.70"/>
<low data="56.85"/>

etc. 
```

因此，对于`stock="FBM"` **/tmp/stockprice.tmp.log** （和您的环境）将包含：

```
GF_symbol="FBM"; 
GF_pretty_symbol="FBM"; 
GF_symbol_lookup_url="/finance?client=ig&amp;q=FBM"; 
GF_company="Focus Morningstar Basic Materials Index ETF"; 
GF_exchange="NYSEARCA"; 
GF_exchange_timezone=""; 
GF_exchange_utc_offset=""; 
GF_exchange_closing=""; 
GF_divisor="2"; 
GF_currency="USD"; 
GF_last="22.82"; 
GF_high="22.82"; 
GF_low="22.82"; 
GF_volume="100"; 
GF_avg_volume=""; 
GF_market_cap="4.56"; 
GF_open="22.82"; 
GF_y_close="22.80"; 
GF_change="+0.02"; 
GF_perc_change="0.09"; 
GF_delay="0"; 
GF_trade_timestamp="8 hours ago"; 
GF_trade_date_utc="20120228"; 
GF_trade_time_utc="184541"; 
GF_current_date_utc="20120229"; 
GF_current_time_utc="033534"; 
GF_symbol_url="/finance?client=ig&amp;q=FBM"; 
GF_chart_url="/finance/chart?q=NYSEARCA:FBM&amp;tlf=12"; 
GF_disclaimer_url="/help/stock_disclaimer.html"; 
GF_ecn_url=""; 
GF_isld_last=""; 
GF_isld_trade_date_utc=""; 
GF_isld_trade_time_utc=""; 
GF_brut_last=""; 
GF_brut_trade_date_utc=""; 
GF_brut_trade_time_utc=""; 
GF_daylight_savings="false"; 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-04-13T16:49:45.817

这不再是谷歌的活跃 API，你可以试试 Xignite，虽然他们收费：[http ://www.xignite.com](http://www.xignite.com)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-03-04T16:26:10.833

这是您可以使用的示例。还没有获得谷歌财经，但这里是雅虎的例子。您将需要[HTMLAgilityPack](http://htmlagilitypack.codeplex.com/)，这太棒了。快乐的符号狩猎。

通过使用调用该过程`YahooStockRequest(string Symbols);`

其中 Symbols = 逗号分隔的符号字符串，或只有一个符号

```
public string YahooStockRequest(string Symbols,bool UseYahoo=true)
        {
            {
                string StockQuoteUrl = string.Empty;

                try
                {
                    // Use Yahoo finance service to download stock data from Yahoo
                    if (UseYahoo)
                    {
                        string YahooSymbolString = Symbols.Replace(",","+");
                        StockQuoteUrl = @"http://finance.yahoo.com/q?s=" + YahooSymbolString + "&ql=1";
                    }
                    else
                    {
                        //Going to Put Google Finance here when I Figure it out.
                    }

                    // Initialize a new WebRequest.
                    HttpWebRequest webreq = (HttpWebRequest)WebRequest.Create(StockQuoteUrl);
                    // Get the response from the Internet resource.
                    HttpWebResponse webresp = (HttpWebResponse)webreq.GetResponse();
                    // Read the body of the response from the server.

                    HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
                    string pageSource;
                    using (StreamReader sr = new StreamReader(webresp.GetResponseStream()))
                    {
                        pageSource = sr.ReadToEnd();
                    }
                    doc.LoadHtml(pageSource.ToString());
                    if (UseYahoo)
                    {
                        string Results=string.Empty;
                        //loop through each Symbol that you provided with a "," delimiter
                        foreach (string SplitSymbol in Symbols.Split(new char[] { ',' }))
                        {
                            Results+=SplitSymbol + " : " + doc.GetElementbyId("yfs_l10_" + SplitSymbol).InnerText + Environment.NewLine;
                        }
                        return (Results);
                    }
                    else
                    {
                        return (doc.GetElementbyId("ref_14135_l").InnerText);
                    }

                }
                catch (WebException Webex)
                {
                    return("SYSTEM ERROR DOWNLOADING SYMBOL: " + Webex.ToString());

                }

            }
        } 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-08-23T12:49:01.223

正如您所解释的，最简单的方法是此[链接](https://www.google.com/finance?q=INDEXDJX:.DJI)，这是针对“道琼斯工业平均指数”的

[链接 2](https://www.google.com/finance?q=INDEXNASDAQ:NDX)用于“纳斯达克 100”

以及所有与纳斯达克相关的[链接 3](https://www.google.com/finance?q=NASDAQ)

我认为应该是这样，否则您希望在 JSON 符号中与 Microsoft 相同

请参考这个[旧帖子](https://stackoverflow.com/questions/6335121/google-finance-how-to-get-the-json-data-streamed)，我认为这会有所帮助，

更新：

要了解卷的详细信息和其他详细信息，我创建了一个 vbscript，它使用 IE 对象从链接中获取详细信息，并提醒特定 id 中的内容（创建一个 .vbs 文件并运行它..

```
Set IE = CreateObject("InternetExplorer.Application")
while IE.readyState = 4: WScript.Sleep 10: wend
IE.Navigate "https://www.google.com/finance?q=INDEXNASDAQ%3ANDX&sq=NASDAQ&sp=2&ei=B3UoUsiIH5DIlgPEsQE"
IE.visible = true
while IE.readyState = 4: WScript.Sleep 10: wend
dim ht
ht= IE.document.getElementById("market-data-div").innerText
msgBox ht
IE.quit 
```

这将像这样提醒页面中的值

```
3,124.54 0.00 (0.00%)
Sep 4 - Close
INDEXNASDAQ real-time data - Disclaimer
Range       -
52 week 2,494.38 - 3,149.24
Open        -
Vol.    0.00 
```

我相信这会有所帮助..

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-11-13T02:15:52.907

谷歌股票报价 API 已经消失。但是，[Investor's Exchange 提供了一个](https://iextrading.com/developer/docs/)非常易于用于报价数据的 API。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-23T06:29:31.343

要使用谷歌的金融数据API查找图表数据，只需像寻找搜索词一样去谷歌，在搜索引擎中输入金融，就会出现一个谷歌金融的链接。在 Google 金融搜索引擎中，将股票代码名称输入到金融数据 API 引擎中，结果将显示出来。不过需要注意的是，所有谷歌金融图表都有15分钟的延迟，最多可以用来更好地了解股票过去的历史，而不是当前的价格。

图表信息延迟的解决方案是获取实时金融数据API。一个例子是 barchartondemand 界面，它具有实时报价信息，以及其他详细功能，可以更轻松地找到您正在寻找的确切图表。barchartondemand 的工具具有完全可定制的功能，以及针对您需要的精确交易信息的特定编程工具，远远超过了 Google 金融。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2014-12-08T05:41:07.760

试试这个： http: [//finance.google.com/finance/info?client=ig &q=NASDAQ:GOOGL](http://finance.google.com/finance/info?client=ig&q=NASDAQ:GOOGL)

它将返回有关上述股票的所有可用详细信息。

例如，输出如下所示：

```
// [ {
"id": "694653"
,"t" : "GOOGL"
,"e" : "NASDAQ"
,"l" : "528.08"
,"l_fix" : "528.08"
,"l_cur" : "528.08"
,"s": "0"
,"ltt":"4:00PM EST"
,"lt" : "Dec 5, 4:00PM EST"
,"lt_dts" : "2014-12-05T16:00:14Z"
,"c" : "-14.50"
,"c_fix" : "-14.50"
,"cp" : "-2.67"
,"cp_fix" : "-2.67"
,"ccol" : "chr"
,"pcls_fix" : "542.58"
}
] 
```

您可以在此 URL 的末尾添加您的公司股票代码以获取其详细信息：

```
http://finance.google.com/finance/info?client=ig&q=<YOUR COMPANY STOCK SYMBOL> 
```

# c++ - Borland C++ Builder 中的 Windows 子类化

> ID：527706
> 
> 赞同：2
> 
> 时间：2009-02-09T10:55:04.680
> 
> 标签：c++, subclass, c++builder

我们正在尝试将一段使用 CWnd.SubclassWindow 方法在 MFC 中编写的 C++ 代码转换为 Borland C++ Builder 代码。有谁知道如何进行子类化（使用 TForm 对象进行子类化） - 我们完全陷入困境。任何指针将不胜感激！蒂亚！

规格：

我们有一个现有的用 Borland C++ 编写的基类，它继承自 TForm，它用于为从它继承的所有表单赋予某种外观和感觉（例如，它处理 WM_NCPAINT 和 WM_NCHITTESTheavily）。

现在我们想使用此代码为用其他语言（准确地说是 MSVC++/MFC 和 C#）编写的表单提供相同的外观和感觉。

我们认为使用 Windows 子类化将是一个好主意，而不是重写所有代码。然后我们可以将所有现有的和测试过的代码填充到一个 DLL 中，然后只需使用 hWnd 调用它，该窗口就会自动获得新的外观和感觉。

究竟为什么这是不可能的，我真的不能说——我自己不使用 Borland C++ 编写代码。我只用了几分钟就在 MFC 中编写了一个存根，向 Borland C++ 开发人员展示了我想要什么，他们花了几天时间试图模仿 MFC 的 CWnd::SubclassWindow 方法，但没有成功。

据我了解，问题在于当您执行“new TForm()”时，会在您有机会停止之前自动创建一个新窗口。所以替换然后 WindowProc*工作*但不需要的 TForm 窗口在屏幕上浮动，没有用！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T21:18:36.943

查看[Codegear Online Docs](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/Controls_TControl_WindowProc.html)，它描述了 WindowProc 子类化机制。

C++Builder 使用底层的 Delphi VCL，因此搜索“Delphi Window subclassing”将比试图找到专门的 C++ 更有成效。C++Builder 程序员必须至少能够阅读 Delphi 代码，即使他们不必编写任何代码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:40:08.873

我假设你的意思是 VCL。您可以将 TControl 对象的 WindowProc 属性设置为您自己的窗口过程或另一个控件的 WindowProc。

**编辑：更多答案，基于更多细节**

为了防止`new TForm`创建一个窗口在屏幕上无用地浮动，您只需要将其 Visible 属性设置为 false。或者，您可以覆盖 CreateParams 以从窗口中删除 WS_VISIBLE 样式：

```
void __fastcall TBlahForm::CreateParams(TCreateParams &Params)
{
    TForm::CreateParams(Params);
    Params.Style&=~WS_VISIBLE;
}
//--------------------------------------------------------------------------- 
```

仍然会创建一个不可见的窗口，但据我了解用例，这应该没什么大不了的。

覆盖`TCustomForm::CreateWnd`可能是解决相同问题的另一种方法。

我的另一个建议是将代码从 BCB 移植到 VC++。如果它做了很多乱七八糟的事情`WM_NCPAINT`，`WM_NCHITTEST`那么听起来不太可能有很多 VCL 特定的东西在里面 - 它可能只是直接敲击 Win32 API？如果那里没有任何 VCL，那么在 VC++ 中编译应该几乎可以神奇地工作。

无论如何：这几乎肯定是可能的。我有一个用 BCB5（早于 WinXP）构建的应用程序，通过巧妙地使用窗口挂钩、子类化等（其中大部分不是我自己的）仍然非常乐意处理 XP 甚至 Aero（这不是说维护并不痛苦）。如果这是可能的，你的应用程序当然应该是。VCL 遵循与 MFC 不同的范式，但它仍然很灵活。

# javascript - 复制 HTML 子节点数组的一半

> ID：527714
> 
> 赞同：0
> 
> 时间：2009-02-09T10:57:36.920
> 
> 标签：javascript, html

我有一个 HTML 元素（假设是一个`div`ision），其中包含一组标题（`h2`）和段落（`p`），其中包含其他元素（例如，一些链接`a`）。

我的**目标**是将我的 HTML 元素切割成 2 个相同大小的元素。

**约束：**不应剪切段落、标题和块

我的想法是浏览子节点列表和`childNodes`每个段落的副本。

每次我复制一个段落时，我都会计算大小，以便知道我是否达到了除法的一半。

这是一些解释它的代码：

```
var elm = document.getElementById('article_colonnes'); // I want to cut this into 2 parts
var paragraphesNumber = paragraphes.length;
var halfSize = elm.innerHTML.length / 2 ;
var col1 = document.getElementById('col1');
var col2 = document.getElementById('col2');
var i=0;
do {
  var node = createNodeFromParagraphe(paragraphes[i]);
  if(node) {
    col1.appendChild(node);
    // update the size of the 1st column by updating inner HTML
    col1String = col1String + paragraphes[i].innerHTML;
  }
  i++;
  // compute the size of the 1st column
  col1Size = col1String.length;
}
while(col1Size < halfSize  || i < paragraphesNumber) ; 
```

我对第二列也这样做。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T11:32:46.820

如果您尝试进行自动两列布局；看看[多列列表](http://www.alistapart.com/articles/multicolumnlists)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T13:30:45.257

要获得真正的两列布局，您需要段落的高度（而不是其中的字符）。这里的问题：获取高度的唯一方法是等待浏览器布局页面*，除非*您指定每个元素的宽度。否则，用户会看到难看的闪烁。

所以我建议试试这个：

1.  使用大多数浏览器支持的多列布局。如果浏览器不是 IE <= 7，你就完成了。

2.  对于 IE 7 及更低版本，为所有元素设置固定宽度。等待浏览器布局页面（在 body.onload 或页面末尾的脚本标记中运行此代码就足够了）。将所有元素放入 id 为“col1”的 div 中。

3.  使用 JavaScript 在 div "col1" 的一半高度处查找元素。（[见这里](http://txt.binnyva.com/2007/06/find-elements-position-using-javascript/)）

4.  如果此元素是标题，则跳过一个元素。

5.  将下一个元素（以及所有其他元素）移动到 div“col2”中。

这应该给你一个更长的 col1 和一个更短的 col2。

如果移动不起作用，请在确定分割点后插入一个不可见字符，获取 col1.innerHtml，在分割字符处将其分割，并将生成的两个字符串用作 col1 和 col2 的 innerHtml。

如果闪烁很多，请尝试在脚本运行时隐藏 col1 和 col2 (display='None')。

# java - 如何在 JLabel 中添加超链接？

> ID：527719
> 
> 赞同：94
> 
> 时间：2009-02-09T10:58:36.857
> 
> 标签：java, swing, hyperlink, jlabel

在 JLabel 中添加超链接的最佳方法是什么？我可以使用 html 标签获取视图，但是当用户点击它时如何打开浏览器？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-02-09T12:03:05.140

您可以使用 a 来执行此操作`JLabel`，但另一种方法是设置 a 样式[`JButton`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JButton.html)。这样，您不必担心[可访问性](http://en.wikipedia.org/wiki/Computer_accessibility)，只需使用[`ActionListener`](http://docs.oracle.com/javase/7/docs/api/java/awt/event/ActionListener.html).

```
 public static void main(String[] args) throws URISyntaxException {
    final URI uri = new URI("http://java.sun.com");
    class OpenUrlAction implements ActionListener {
      @Override public void actionPerformed(ActionEvent e) {
        open(uri);
      }
    }
    JFrame frame = new JFrame("Links");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(100, 400);
    Container container = frame.getContentPane();
    container.setLayout(new GridBagLayout());
    JButton button = new JButton();
    button.setText("<HTML>Click the <FONT color=\"#000099\"><U>link</U></FONT>"
        + " to go to the Java website.</HTML>");
    button.setHorizontalAlignment(SwingConstants.LEFT);
    button.setBorderPainted(false);
    button.setOpaque(false);
    button.setBackground(Color.WHITE);
    button.setToolTipText(uri.toString());
    button.addActionListener(new OpenUrlAction());
    container.add(button);
    frame.setVisible(true);
  }

  private static void open(URI uri) {
    if (Desktop.isDesktopSupported()) {
      try {
        Desktop.getDesktop().browse(uri);
      } catch (IOException e) { /* TODO: error handling */ }
    } else { /* TODO: error handling */ }
  } 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-12-05T15:01:14.333

我想提供另一种解决方案。它类似于已经提出的那些，因为它在 JLabel 中使用 HTML 代码，并在其上注册了一个 MouseListener，但是当您将鼠标移到链接上时它还会显示一个 HandCursor，因此外观就像大多数用户所期望的那样. 如果平台不支持浏览，则不会创建可能误导用户的蓝色下划线 HTML 链接。相反，该链接仅以纯文本形式呈现。这可以与@dimo414 提出的 SwingLink 类结合使用。

```
public class JLabelLink extends JFrame {

private static final String LABEL_TEXT = "For further information visit:";
private static final String A_VALID_LINK = "http://stackoverflow.com";
private static final String A_HREF = "<a href=\"";
private static final String HREF_CLOSED = "\">";
private static final String HREF_END = "</a>";
private static final String HTML = "<html>";
private static final String HTML_END = "</html>";

public JLabelLink() {
    setTitle("HTML link via a JLabel");
    setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

    Container contentPane = getContentPane();
    contentPane.setLayout(new FlowLayout(FlowLayout.LEFT));

    JLabel label = new JLabel(LABEL_TEXT);
    contentPane.add(label);

    label = new JLabel(A_VALID_LINK);
    contentPane.add(label);
    if (isBrowsingSupported()) {
        makeLinkable(label, new LinkMouseListener());
    }

    pack();
}

private static void makeLinkable(JLabel c, MouseListener ml) {
    assert ml != null;
    c.setText(htmlIfy(linkIfy(c.getText())));
    c.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
    c.addMouseListener(ml);
}

private static boolean isBrowsingSupported() {
    if (!Desktop.isDesktopSupported()) {
        return false;
    }
    boolean result = false;
    Desktop desktop = java.awt.Desktop.getDesktop();
    if (desktop.isSupported(Desktop.Action.BROWSE)) {
        result = true;
    }
    return result;

}

private static class LinkMouseListener extends MouseAdapter {

    @Override
    public void mouseClicked(java.awt.event.MouseEvent evt) {
        JLabel l = (JLabel) evt.getSource();
        try {
            URI uri = new java.net.URI(JLabelLink.getPlainLink(l.getText()));
            (new LinkRunner(uri)).execute();
        } catch (URISyntaxException use) {
            throw new AssertionError(use + ": " + l.getText()); //NOI18N
        }
    }
}

private static class LinkRunner extends SwingWorker<Void, Void> {

    private final URI uri;

    private LinkRunner(URI u) {
        if (u == null) {
            throw new NullPointerException();
        }
        uri = u;
    }

    @Override
    protected Void doInBackground() throws Exception {
        Desktop desktop = java.awt.Desktop.getDesktop();
        desktop.browse(uri);
        return null;
    }

    @Override
    protected void done() {
        try {
            get();
        } catch (ExecutionException ee) {
            handleException(uri, ee);
        } catch (InterruptedException ie) {
            handleException(uri, ie);
        }
    }

    private static void handleException(URI u, Exception e) {
        JOptionPane.showMessageDialog(null, "Sorry, a problem occurred while trying to open this link in your system's standard browser.", "A problem occured", JOptionPane.ERROR_MESSAGE);
    }
}

private static String getPlainLink(String s) {
    return s.substring(s.indexOf(A_HREF) + A_HREF.length(), s.indexOf(HREF_CLOSED));
}

//WARNING
//This method requires that s is a plain string that requires
//no further escaping
private static String linkIfy(String s) {
    return A_HREF.concat(s).concat(HREF_CLOSED).concat(s).concat(HREF_END);
}

//WARNING
//This method requires that s is a plain string that requires
//no further escaping
private static String htmlIfy(String s) {
    return HTML.concat(s).concat(HTML_END);
}

/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            new JLabelLink().setVisible(true);
        }
    });
}
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-09-02T12:52:04.087

我写了一篇关于如何在 jLabel 上设置超链接或 mailto 的文章。

所以试试[吧](https://sites.google.com/site/ibrabel/jlabel-hyperlink-mailto)：

我认为这正是您正在寻找的。

这是完整的代码示例：

```
/**
 * Example of a jLabel Hyperlink and a jLabel Mailto
 */

import java.awt.Cursor;
import java.awt.Desktop;
import java.awt.EventQueue;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

/**
 *
 * @author ibrabelware
 */
public class JLabelLink extends JFrame {
    private JPanel pan;
    private JLabel contact;
        private JLabel website;
    /**
     * Creates new form JLabelLink
     */
    public JLabelLink() {
        this.setTitle("jLabelLinkExample");
        this.setSize(300, 100);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setLocationRelativeTo(null);

        pan = new JPanel();
        contact = new JLabel();
        website = new JLabel();

        contact.setText("<html> contact : <a href=\"\">YourEmailAddress@gmail.com</a></html>");
        contact.setCursor(new Cursor(Cursor.HAND_CURSOR));

        website.setText("<html> Website : <a href=\"\">http://www.google.com/</a></html>");
        website.setCursor(new Cursor(Cursor.HAND_CURSOR));

    pan.add(contact);
    pan.add(website);
        this.setContentPane(pan);
        this.setVisible(true);
        sendMail(contact);
        goWebsite(website);
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /*
         * Create and display the form
         */
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new JLabelLink().setVisible(true);
            }
        });
    }

    private void goWebsite(JLabel website) {
        website.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                try {
                    Desktop.getDesktop().browse(new URI("http://www.google.com/webhp?nomo=1&hl=fr"));
                } catch (URISyntaxException | IOException ex) {
                    //It looks like there's a problem
                }
            }
        });
    }

    private void sendMail(JLabel contact) {
        contact.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                try {
                    Desktop.getDesktop().mail(new URI("mailto:YourEmailAddress@gmail.com?subject=TEST"));
                } catch (URISyntaxException | IOException ex) {
                    //It looks like there's a problem
                }
            }
        });
    }
} 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-12-23T11:53:06.800

**更新**我`SwingLink`进一步整理了课程并添加了更多功能；可以在此处找到它的最新副本：[https ://bitbucket.org/dimo414/jgrep/src/tip/src/grep/SwingLink.java](https://bitbucket.org/dimo414/jgrep/src/tip/src/grep/SwingLink.java)

* * *

@McDowell 的回答很棒，但是有几件事可以改进。值得注意的是，超链接以外的文本是可点击的，即使某些样式已更改/隐藏，它仍然看起来像一个按钮。虽然可访问性很重要，但连贯的 UI 也很重要。

所以我根据 McDowell 的代码整理了一个扩展 JLabel 的类。它是独立的，可以正确处理错误，感觉更像是一个链接：

```
public class SwingLink extends JLabel {
  private static final long serialVersionUID = 8273875024682878518L;
  private String text;
  private URI uri;

  public SwingLink(String text, URI uri){
    super();
    setup(text,uri);
  }

  public SwingLink(String text, String uri){
    super();
    setup(text,URI.create(uri));
  }

  public void setup(String t, URI u){
    text = t;
    uri = u;
    setText(text);
    setToolTipText(uri.toString());
    addMouseListener(new MouseAdapter() {
      public void mouseClicked(MouseEvent e) {
        open(uri);
      }
      public void mouseEntered(MouseEvent e) {
        setText(text,false);
      }
      public void mouseExited(MouseEvent e) {
        setText(text,true);
      }
    });
  }

  @Override
  public void setText(String text){
    setText(text,true);
  }

  public void setText(String text, boolean ul){
    String link = ul ? "<u>"+text+"</u>" : text;
    super.setText("<html><span style=\"color: #000099;\">"+
    link+"</span></html>");
    this.text = text;
  }

  public String getRawText(){
    return text;
  }

  private static void open(URI uri) {
    if (Desktop.isDesktopSupported()) {
      Desktop desktop = Desktop.getDesktop();
      try {
        desktop.browse(uri);
      } catch (IOException e) {
        JOptionPane.showMessageDialog(null,
            "Failed to launch the link, your computer is likely misconfigured.",
            "Cannot Launch Link",JOptionPane.WARNING_MESSAGE);
      }
    } else {
      JOptionPane.showMessageDialog(null,
          "Java is not able to launch links on your computer.",
          "Cannot Launch Link", JOptionPane.WARNING_MESSAGE);
    }
  }
} 
```

例如，您还可以在单​​击后将链接颜色更改为紫色，如果这看起来有用的话。这一切都是独立的，您只需调用：

```
SwingLink link = new SwingLink("Java", "http://java.sun.com");
mainPanel.add(link); 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-02-09T11:54:53.693

也许使用`JXHyperlink`SwingX[代替](https://java.net/projects/swinglabs/)。它延伸`JButton`. 一些有用的链接：

*   [类 JXHyperlink](https://pirlwww.lpl.arizona.edu/resources/guide/software/SwingX/org/jdesktop/swingx/JXHyperlink.html)
*   [SwingX：考虑将 JXHyperlink 作为按钮的替代品](http://www.javalobby.org/java/forums/t18617.html)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2011-10-21T20:49:24.643

您可以尝试使用 JEditorPane 而不是 JLabel。这了解基本的 HTML，并将向您在 JEditPane 中注册的 HyperlinkListener 发送一个 HyperlinkEvent 事件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-09T11:05:43.327

如果 <a href="link"> 不起作用，则：

1.  创建一个 JLabel 并添加一个 MouseListener（将标签装饰成超链接）
2.  实现[mouseClicked()](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/event/MouseListener.html#mouseClicked(java.awt.event.MouseEvent))事件
3.  在 mouseClicked() 事件的实现中，执行你的动作

查看使用默认浏览器打开链接的[java.awt.Desktop](http://java.sun.com/javase/6/docs/api/java/awt/Desktop.html#browse(java.net.URI)) API（此 API 仅适用于 Java6）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-12-15T19:09:22.420

我知道我参加聚会有点晚了，但我做了一些其他人可能会觉得很酷/有用的方法。

```
public static JLabel linkify(final String text, String URL, String toolTip)
{
    URI temp = null;
    try
    {
        temp = new URI(URL);
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
    final URI uri = temp;
    final JLabel link = new JLabel();
    link.setText("<HTML><FONT color=\"#000099\">"+text+"</FONT></HTML>");
    if(!toolTip.equals(""))
        link.setToolTipText(toolTip);
    link.setCursor(new Cursor(Cursor.HAND_CURSOR));
    link.addMouseListener(new MouseListener()
    {
        public void mouseExited(MouseEvent arg0)
        {
            link.setText("<HTML><FONT color=\"#000099\">"+text+"</FONT></HTML>");
        }

        public void mouseEntered(MouseEvent arg0)
        {
            link.setText("<HTML><FONT color=\"#000099\"><U>"+text+"</U></FONT></HTML>");
        }

        public void mouseClicked(MouseEvent arg0)
        {
            if (Desktop.isDesktopSupported())
            {
                try
                {
                    Desktop.getDesktop().browse(uri);
                }
                catch (Exception e)
                {
                    e.printStackTrace();
                }
            }
            else
            {
                JOptionPane pane = new JOptionPane("Could not open link.");
                JDialog dialog = pane.createDialog(new JFrame(), "");
                dialog.setVisible(true);
            }
        }

        public void mousePressed(MouseEvent e)
        {
        }

        public void mouseReleased(MouseEvent e)
        {
        }
    });
    return link;
} 
```

它会给你一个 JLabel，就像一个正确的链接。

在行动：

```
public static void main(String[] args)
{
    JFrame frame = new JFrame("Linkify Test");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(400, 100);
    frame.setLocationRelativeTo(null);
    Container container = frame.getContentPane();
    container.setLayout(new GridBagLayout());
    container.add(new JLabel("Click "));
    container.add(linkify("this", "http://facebook.com", "Facebook"));
    container.add(new JLabel(" link to open Facebook."));
    frame.setVisible(true);
} 
```

如果您不想要工具提示，只需发送一个空值。

希望有人觉得这很有用！（如果你这样做，一定要让我知道，我很乐意听到。）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-12-10T08:06:29.417

将 a`JEditorPane`与 a 一起使用`HyperlinkListener`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-02-19T15:16:45.700

只是说`window.open(website url)`，它每次都有效。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-04-30T09:09:47.267

以下代码需要[`JHyperLink`](http://sourceforge.net/projects/jhyperlink/)添加到您的构建路径中。

```
JHyperlink stackOverflow = new JHyperlink("Click HERE!",
                "https://www.stackoverflow.com/");

JComponent[] messageComponents = new JComponent[] { stackOverflow };

JOptionPane.showMessageDialog(null, messageComponents, "StackOverflow",
                JOptionPane.PLAIN_MESSAGE); 
```

请注意，您可以使用更多组件填充`JComponent`数组。`Swing`

结果：

![](https://i.stack.imgur.com/BMcTS.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-12-25T22:02:26.933

您可以在

```
actionListener ->  Runtime.getRuntime().exec("cmd.exe /c start chrome www.google.com")` 
```

或者如果您想使用 Internet Explorer 或 Firefox 替换`chrome`为`iexplore`或`firefox`

# c# - 检测实体是否附加到数据上下文

> ID：527724
> 
> 赞同：15
> 
> 时间：2009-02-09T11:00:58.333
> 
> 标签：c#, linq-to-sql

我有一个需要保存实体对象的过程。问题是我不知道这个实体是否附加到我的数据上下文中。为了解决这个问题，我使用以下代码：

```
try
{
    db.ClientUsers.Attach(clientUser);
    db.Refresh(RefreshMode.KeepCurrentValues, clientUser);
}
catch { }

db.SubmitChanges(); 
```

我正在寻找一种更好的方法来检测一个实体是否属于一个上下文，并测试一个实体是否附加到一个特定的上下文。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-09T11:06:24.373

我想知道......[`GetOriginalEntityState`](http://msdn.microsoft.com/en-us/library/bb548700.aspx)非附加对象会返回什么？即使它抛出异常，它也可能比刷新更快......

（更新） - 测试显示它返回 null：

```
 Customer cust = new Customer();
        Customer orig = ctx.Customers.GetOriginalEntityState(cust);
        Assert.IsNull(orig);

        cust = new Customer();
        ctx.Customers.Attach(cust);
        orig = ctx.Customers.GetOriginalEntityState(cust);
        Assert.IsNotNull(orig);
        Assert.AreNotSame(cust,orig); 
```

所以也许使用`GetOriginalEntityState`并检查空返回值......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-07-12T14:55:00.323

我认为更好的解决方案是：

```
ObjectStateEntry stateEntry = null;
if (context.ObjectStateManager.TryGetObjectStateEntry(entity, out stateEntry))
{
    //you know you are attached!
} 
```

[在http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/49e97c25-7325-457a-891b-8fd58c726f3e](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/49e97c25-7325-457a-891b-8fd58c726f3e)上找到。

# xml - 将配置文件转换为 XML

> ID：527727
> 
> 赞同：2
> 
> 时间：2009-02-09T11:02:06.160
> 
> 标签：xml, converter

我们有大量的遗留配置文件，各种格式通常类似于 KEYWORD DATA KEYWORD DATA KEYWORD DATA。

数据本身的格式在每个配置文件中都是唯一的。

我们想做的是以某种方式定义文件数据格式，然后使用它来允许应用程序检查配置文件是否符合定义的文件格式。

我们曾考虑将它们定义为 BNF 并使用 YACC 或等效的，但令人讨厌的感觉是，必须使用 XML 来做这件事。

需要的是一种定义配置文件数据格式的方法，最好是 XML 格式，然后使用该文件将遗留文件转换为有效的 XML。将 XML 文件转换回旧文件格式的首选方法会很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T12:03:24.033

对于转换 XML->legacy 文件，[XSLT](http://en.wikipedia.org/wiki/XSL_Transformations)可能会正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-19T22:38:06.370

这正是[明胶](http://wiki.github.com/knipknap/Gelatin/)设计的问题类型。（另外，自我宣传警告。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T11:36:18.340

看看 Altova-Tools，尤其是 Mapforce。AFAIR 他们可以从/到用户文件格式转换，并且映射可以在屏幕上很自然地完成。（Altova Tools 也可以生成 XSD 进行检查。）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-09T13:14:02.240

尝试使用像 awk（或 gawk）这样的简单文本处理器来生成 XML。图案看起来像这样。

```
BEGIN { 
    print "<?xml version=\"1.0\" encoding=\"utf-8\"?>";
    print "<config-type>"; 
}
 { print "    <" $1 ">" $2 "</" $1 ">"; }
END { print "</config-type>"; } 
```

确保编码正确。对于英文的配置文件，“ASCII”就足够了。

之后，您可以使用多种工具来处理该 XML。我建议使用这种格式，因为它最容易创建和处理：

```
<config-type>
    <KEYWORD1>DATA1</KEYWORD1>
    <KEYWORD2>DATA2</KEYWORD2>
    <KEYWORD3>DATA3</KEYWORD3>
</config-type> 
```

为您拥有的每种类型的配置文件使用不同的“config-type”名称，以便于区分。

要检查 XML 的格式，最简单的方法是为其定义一个 DTD。许多 XML 编辑器可以读取现有的 XML 文件并为其创建 DTD。该DTD 并不完美，但它将是一个非常好的起点。

然后，您可以在 XML 标头中指定 DTD 的名称，并告诉 XML 解析器验证结构（但不是数据）。

要检查数据，您可以使用 XML 模式，但 XML 模式非常复杂，而且常常是矫枉过正。

# .net - .NET 已经是小型应用程序开发的正确方式了吗？

> ID：527730
> 
> 赞同：1
> 
> 时间：2009-02-09T11:03:14.690
> 
> 标签：.net

我正在开发一个小型 Windows 应用程序，但在决定是否使用 .NET 时遇到了一些麻烦。作为一名编码员，我想使用 .NET 库。另一方面，要求我的用户下载庞大的 .NET 运行时似乎是一个可怕的决定。

对于 Visual Studio 规模的软件来说，100 兆的先决条件可能没问题，但我觉得这对于快速的轻量级工具（例如，Notepad++）来说将是一个交易破坏者。未来，.NET 运行时可能会变得足够广泛，足以根除该问题，但在短期内，我感到不安。

在您的意见/经验中，2009 年对于小型应用程序使用 .NET 是否为时过早？我应该等待更大的玩家铺平道路吗？

*编辑：XP SP2 和 Vista 默认提供哪些版本（如果有）？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T11:10:40.790

.NET 随任何最新版本的 Windows 一起提供，因此我怀疑使用 .NET 会严重限制您。

您需要支持 Windows 2000 吗？如果您对 2003 和 Vista 感到满意，那么您应该没有问题。

请记住，并不是每个人都会在 .NET 3.5 (SP1) 上遇到困难，但如果您不使用其中任何一个，那也没问题。

编辑：似乎我对 XP SP2 有误解。.NET 2.0 不包含在 XP 的 Service Pack 2 中。根据[维基百科](http://en.wikipedia.org/wiki/.NET_Framework)，W2003R2 是第一个包含 .NET 2.0 的版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T11:11:38.713

.net 的可再发行包有 cca​​ 25MB。如今，当用户在 youtube 上观看视频时，25 MB 已不再是障碍。例如 .NET 2.0 是 Win XP SP 2 的一部分，而 .NET 3.5 应该是 windows 更新的一部分。

尽管如此，用户只需要下载一次.NET。然后你可以只分发你的应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T11:13:02.827

您可能想看看[Scott Hanselman 的网站](http://www.hanselman.com/smallestdotnet/)。它消除了 .NET 框架下载大小为数百兆的普遍错觉。那只是可再发行组件。最终用户不需要下载该版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T11:12:54.433

为什么不在做出假设之前查看 .NET 运行时的“真实”大小？

[http://www.smallestdotnet.com](http://www.smallestdotnet.com)

下载量并不总是 80 兆。大多数时候它会花费更少的时间，因为一些位已经存在等等。

另请注意，Jan .NET 3.5 SP1 在 Windows 更新中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T11:17:07.450

嗯，取决于您的目标是哪个 .NET 平台。说 .net 2.0，那么您将可以自由地为所有 windows xp 和更高版本的操作系统进行开发，并且不需要框架安装作为先决条件。然后在我看来不值得以 3.0 为目标，而是直接进入 3.5，因为它包含了很多新东西，可以让你的开发变得更容易使用 3.5，你不需要安装完整的框架，我最近一直在构建 . net 3.5 sp1 应用程序适用于 windows xp 及更高版本，我使用 Microsoft 的一个非常非常好的客户端配置文件工具来为我的应用程序提供先决条件。

以下是详细信息：[客户资料](http://download.microsoft.com/download/5/a/a/5aa86d6c-969b-42d8-bc6b-30e02bfeccf0/NETFXClientProfile_DeploymentGuide.htm)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T11:31:15.607

这真的取决于每个项目。

1.  为项目使用 .NET 将为您节省多少时间/金钱？（有些事情在没有 .NET 的情况下很容易做到，而有些事情则不然。）
2.  使用 .NET 将在多大程度上提高您修复错误/添加功能的能力？（难以维护的代码过时了，人们对产品失去了兴趣。）
3.  您的目标受众已经安装了框架的可能性有多大，或者至少足够熟练地获得它？
4.  人们不会因为 .NET 要求而“关闭”产品，这对您来说有多重要？（显然使用你的应用的人越多越好，但这与前两点相比有多重要？你宁愿拥有更好的应用但用户更少吗？）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-23T16:53:39.260

You are right that .NET applications are bloated by needing the framework. If you're creating a mega-application that everyone will use, then it might be worth the effort to write it in the native language. For anything much else then the time you can save by using something like .NET outweighs the runtime cost.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T11:09:35.707

如果您的用户拥有 win xp sp2 或 vista，那么他们已经安装了框架。

因此，如果您正在考虑是否应该开始在 .NET 中开发应用程序，那么应该。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T11:09:54.940

您说得对，.NET 应用程序因需要框架而变得臃肿。如果您正在创建一个每个人都会使用的大型应用程序，那么用母语编写它可能是值得的。对于其他任何事情，使用 .NET 之类的东西可以节省的时间超过了运行时成本。

除非您需要最新和最强大的功能，否则请坚持使用旧版本的 .NET，您不必太担心。采用您想要定位的最旧的操作系统。所以我猜那是Windows XP。无论如何，最新的服务包都安装了 .NET 框架。如果用户缺少 .NET，最好显示一个明智的警告，否则您不必担心。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-09T11:10:12.943

这些当然是主观的东西，但我更喜欢 JDK/JRE；它更成熟，而且它的平台独立性是真实的，而不仅仅是纸上的东西（.NET 的 Mono 项目实际上还没有。）

如果您确定 Windows 是您想要使用的全部，请使用 .NET。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T11:11:27.417

取决于目标受众。想象一下您的典型用户。现在尝试猜测他的互联网带宽和技术技能。

如果您使用 56kbit 调制解调器为“奶奶”开发一些东西并且没有技术知识，请不要使用它。

如果您为有宽带的人开发并且不担心自己安装软件，那么您应该使用 .NET。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T13:34:11.177

我发现[这篇 2005 年的博](http://blogs.msdn.com/brada/archive/2005/01/14/352967.aspx)文表明 85% 的新消费 PC 和 58% 的新商务 PC 安装了 .NET Framework（我假设是 .NET 1.1）。您的目标人群可能会有所不同，但我认为很多潜在客户已经安装了它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-09T13:49:47.567

是的，对于快速的小型工具来说，这将是一个破坏者。这就是德尔福的用武之地。

但是你应该好好看看你的市场。不升级的人也不太可能购买太多软件，因此除非您的目标市场在那里，否则可能无关紧要。

还有另一个权衡，您可以使用 .net 在更短的时间内提供更多功能。

您在这里得到的答案可能有点偏向 .net 开发。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-12-09T19:09:09.187

One other light to shine in on this subject, with the advent of Mono, you may find that you are able to support more platforms (windows, linux, macos, iOS, android, etc.) without needing to re-write the complete client for each platform.

I am starting to work on an enterprise-level application that we want to target multiple platforms, and after looking around, and considering writing in c++ even, the to-market cost still seems to be steering us toward .Net in the Mono sense.

Just my $0.02 on the subject. YMMV, IANAL, etc. :)

# c++ - 为原始类型重载 operator<<。那可能吗？

> ID：527742
> 
> 赞同：3
> 
> 时间：2009-02-09T11:09:53.333
> 
> 标签：c++, stl, operator-overloading

嘿。是否可以为原始类型重载 operator<< ？Fx 可以说我想写一个 std::endl 每次想写一个 int。我可以为 int 重载 operator<<，以便它自动将 std::endl 放到输出中吗？我试过这个，

```
std::ostream& operator<<(std::ostream& strm, int & i)
{
   strm << i << std::endl;
   return strm;
} 
```

但它不起作用。我不记得编译器错误消息，但我认为我让运算符重载所有错误的方式。我尝试以这种方式调用上面的重载运算符<<，

```
int main()
{
   int i = 2;
   std::out<<"Here is an int " << i;

   return 0;
} 
```

但它根本不起作用。也许我不能重载 POD 类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T11:20:15.837

请记住，这里您不仅在 int 上而且在 ostream 上使用 << 运算符。您可以从 ostream 派生并在自己的派生类中实现它，但我建议制作一个简单的宏，例如

```
#define EL(i) (i)<<std::endl 
```

或者，您可以创建盒装 int 类并覆盖标准 ostream 和盒装 int 的 <<（如 Iraimbilanja 的回答）类。听起来有点矫枉过正，但可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T11:28:24.380

正如 zabzonk 所说，标准库提供了 (ostream&, int) 重载，因此您无法定义另一个。

模拟您正在做的事情（尽管以目前的形式完全没有意义:)：

```
class EndlinedInteger {
public:
    EndlinedInteger(int i) : i(i) { }
    friend ostream& operator<<(ostream&, EndlinedInteger const&);
private:
    int i;
};

ostream& operator<<(ostream& out, EndlinedInteger const& ei) {
    out << ei.i << endl;
    return out;
}

int main()
{
   EndlinedInteger i = 2;
   std::cout<<"Here is an int " << i;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T11:21:24.773

您的问题是operator << (ostream &, int)*已经*存在重载，该重载由 C++ 标准库提供。如果您删除重载定义并使用：

```
#include <iostream>
int main()
{
   int i = 2;
   std::out<<"Here is an int " << i;

   return 0;
} 
```

事情按预期工作。

顺便说一句，编译器错误消息很重要，因此最好记住它们并在提问时在帖子中引用它们。

编辑 - 上面的 std::out 应该是 std::cout

# ruby-on-rails - 使用重定向会很慢，因为它会导致额外的请求吗？

> ID：527753
> 
> 赞同：4
> 
> 时间：2009-02-09T11:12:40.380
> 
> 标签：ruby-on-rails, ruby

在 Rails 应用程序中，有时您会在操作中使用重定向...

```
redirect_to :controller => 'sessions', :action => 'new' 
```

我想知道这是否很糟糕，因为它会将 302 状态发送回浏览器，然后浏览器会发出一个全新的请求。这是一个额外的来回。

只渲染一个模板会更好吗？

```
render :template => 'users/new' 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T11:29:36.813

使用重定向而不是渲染的主要原因是为了确保幂等不变性。这基本上意味着如果您从 POST 或 DELETE 修改某些内容，那么您应该重定向到下一页。否则，如果有人尝试更新，他们可能会重做变异操作。它还使用户更容易，因为他们总是可以为特定页面添加书签。如果您使用 POST 到达当前位置，则不一定如此。

但是，是的，它的效率会稍低一些——尽管在这种情况下，我会更关心应用程序的可用性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-09T14:51:08.933

此外，它的效率也不会低很多，因为 HTTP 1.1 keep-alives 应该*确保*浏览器可以重复使用相同的连接来发出第二个请求，而不必重新启动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T19:08:15.070

就像一个附录。对于移动设备，减少请求的数量是巨大的。每个请求都会增加开销，可能是因为设备每次发出请求时都会启动无线通信堆栈，以节省电池电量。所以每一件小事都有帮助。

我正在开发一个大型 Web 应用程序。一旦我们开始使用[CSS Spriting](http://www.alistapart.com/articles/sprites/)，我们就看到了加载速度的巨大提升。速度增益比我们想象的要大得多。

# python - 我可以从超类实例化一个子类对象吗

> ID：527757
> 
> 赞同：4
> 
> 时间：2009-02-09T11:13:30.907
> 
> 标签：python, oop

我有以下示例代码：

```
class A(object):
    def __init__(self, id):
        self.myid = id
    def foo(self, x):
        print 'foo', self.myid*x

class B(A):
    def __init__(self, id):
        self.myid = id
        self.mybid = id*2
    def bar(self, x):
        print 'bar', self.myid, self.mybid, x 
```

使用时，可能会生成以下内容：

```
>>> a = A(2)
>>> a.foo(10)
foo 20
>>> 
>>> b = B(3)
>>> b.foo(10)
foo 30
>>> b.bar(12)
bar 3 6 12 
```

现在假设我有更多的子类`class C(A):`和`class D(A):`. 我也知道 id 将始终适合 B、C 或 D，但绝不会同时适合其中 2 个。

现在我想调用 A(23) 并获取正确子类的对象。像这样的东西：

> ```
> >>> type(A(2))
> <class '__main__.B'>
> >>> type(A(22))
> <class '__main__.D'>
> >>> type(A(31))
> <class '__main__.C'>
> >>> type(A(12))
> <class '__main__.B'> 
> ```

这是不可能的，还是可能但只是糟糕的设计？这样的问题应该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T11:29:00.090

您应该实现 [Abstract Factory 模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)，然后您的工厂将根据提供的参数构建您喜欢的任何对象。这样你的代码将保持干净和可扩展。

当您升级解释器版本时，您可以直接使用的任何 hack 都可以被删除，因为没有人期望向后兼容来保留这些东西。

编辑：一段时间后，我不确定您是否应该使用 Abstract Factory 或[Factory Method pattern](http://en.wikipedia.org/wiki/Factory_method_pattern)。这取决于您的代码的详细信息，因此适合您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T11:31:04.953

通常，当超类对子类有任何了解时，这不是一个好主意。

从 OO 的角度考虑您想要做什么。

超类为该类型的所有对象提供通用行为，例如 Animal。然后子类提供行为的特化，例如Dog。

用“isa”关系来考虑它，即狗是动物。

动物是狗并没有真正的意义。

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T11:32:35.917

我不认为您可以更改对象的类型，但您可以创建另一个类，该类将像子类的工厂一样工作。像这样的东西：

```
class LetterFactory(object):
    @staticmethod
    def getLetterObject(n):
        if n == 1:
            return A(n)
        elif n == 2:
            return B(n)
        else:
            return C(n)

a = LetterFactory.getLetterObject(1)
b = LetterFactory.getLetterObject(2)
... 
```

# c# - 在 C# 4.0 中，为什么方法中的 out 参数不能是协变的？

> ID：527758
> 
> 赞同：16
> 
> 时间：2009-02-09T11:14:28.143
> 
> 标签：c#, c#-4.0, covariance, out

鉴于这个神奇的界面：

```
public interface IHat<out TRabbit>
{
    TRabbit Take();
} 
```

而这个类层次结构：

```
public class Rabbit { }

public class WhiteRabbit : Rabbit { } 
```

我现在可以编译这个：

```
IHat<WhiteRabbit> hat1 = null;
IHat<Rabbit> hat2 = hat1; 
```

这是伟大的。但是如果我以不同的方式定义接口怎么办：

```
public interface IHat<out TRabbit>
{
    bool Take(out TRabbit r);
} 
```

我表示帽子可能是空的，使用单独的布尔返回值（以前的版本可能会从空帽子返回空兔子）。但我仍然只输出一只兔子，所以没有做任何与以前版本在逻辑上不同的事情。

CTP 中的 C# 4.0 编译器在接口定义中给出错误 - 它要求“out”方法参数为不变类型。是否有一个明确的理由为什么不允许这样做，或者它可能会在未来的版本中解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T11:22:21.230

有趣的。但是，在 CLI 级别没有“out”之类的东西——只有“ref”；有一个属性可以帮助编译器（用于明确分配），它说“你不需要传递它”。

也许这个限制是因为 CLI 没有“out”，只有“ref”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-18T22:27:43.767

虽然有点麻烦，但您可以使用协方差包装器：

```
public class CovariantListWrapper<TOut, TIn> : IList<TOut> where TIn : TOut
{
    IList<TIn> list;

    public CovariantListWrapper(IList<TIn> list)
    {
        this.list = list;
    }

    public int IndexOf(TOut item)
    {
        // (not covariant but permitted)
        return item is TIn ? list.IndexOf((TIn)item) : -1;
    }

    public TOut this[int index]
    {
        get { return list[index]; }
        set { throw new InvalidOperationException(); }
    }

    public bool Contains(TOut item)
    {
        // (not covariant but permitted)
        return item is TIn && list.Contains((TIn)item);
    }

    public void CopyTo(TOut[] array, int arrayIndex)
    {
        foreach (TOut t in this)
            array[arrayIndex++] = t;
    }

    public int Count { get { return list.Count; } }

    public bool IsReadOnly { get { return true; } }

    public IEnumerator<TOut> GetEnumerator()
    {
        foreach (TIn t in list)
            yield return t;
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public void Insert(int index, TOut item) { throw new InvalidOperationException(); }
    public void RemoveAt(int index) { throw new InvalidOperationException(); }
    public void Add(TOut item) { throw new InvalidOperationException(); }
    public void Clear() { throw new InvalidOperationException(); }
    public bool Remove(TOut item) { throw new InvalidOperationException(); }
} 
```

这使您可以将集合保留为最初键入的内容，并以协变方式引用它，而无需创建分离的副本，以便在协变使用中看到对原始集合的更新。例子：

```
class CovarianceWrapperExample
{
    class Person { }
    class Employee : Person { }

    void ProcessPeople(IList<Person> people) { /* ... */ }

    void Foo()
    {
        List<Employee> employees = new List<Employee>();

        // cannot do:
        ProcessPeople(employees);

        // can do:
        ProcessPeople(new CovariantListWrapper<Person, Employee>(employees));
    }
} 
```

# c# - 缓存与 SQL 依赖关系？

> ID：527761
> 
> 赞同：1
> 
> 时间：2009-02-09T11:17:29.680
> 
> 标签：c#, .net, caching, distributed-caching

我知道[NCache为](http://www.alachisoft.com/ncache/)[Microsoft SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)和[Oracle](http://en.wikipedia.org/wiki/Oracle_Database)（10G R4 及更高版本）提供 SQL 依赖项。我很想知道还有哪些其他可用的缓存解决方案，这些解决方案依赖于 Oracle？

[当数据库发生变化时， Velocity](http://en.wikipedia.org/wiki/Microsoft_codename_%22Velocity%22)、[memcached](http://en.wikipedia.org/wiki/Memcached)等是否支持 SQL 依赖来自动接收通知/更新缓存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T20:52:58.013

有一些支持 SqlDependency 的 memcache 和 NVelocity 实现，但我知道的都是付费解决方案。您还需要记住，生成 SqlDependency 将使用仅用于此目的的过程和表填充您的数据库......我开始使用[http://www.alachisoft.com/](http://www.alachisoft.com/)进行内存缓存。免费版本有文件依赖，这真的很酷！至于性能，我的公司从头开始构建我现在使用的实现。

希望这有帮助。:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-09T11:31:02.643

如果您使用的是 .NET，我建议您查看[`System.Web.Caching`](http://msdn.microsoft.com/en-us/library/system.web.caching.aspx)命名空间，尤其是 class [`CacheDependency`](http://msdn.microsoft.com/en-us/library/system.web.caching.cachedependency.aspx)。我知道它目前不依赖 Oracle，你。

# c# - C#泛型中Java通配符的等价物是什么

> ID：527766
> 
> 赞同：21
> 
> 时间：2009-02-09T11:19:40.847
> 
> 标签：c#, generics, wildcard

我正在开发一个应用程序，我需要调用泛型类的方法并且我不关心实例的实际类型。类似于以下 Java 代码：

```
public class Item<T>{
  private T item;

  public doSomething(){...}
}

...
public void processItems(Item<?>[] items){
 for(Item<?> item : items)
   item.doSomething();
} 
```

当时我很着急，所以我通过定义一个带有我需要调用的方法的接口并让泛型类实现它来解决我的问题。

```
public interface IItem  
{
   void doSomething();
}

public class Item<T> : IItem {
  private T item;

  public void doSomething(){...}
}

...
public void processItems(IItem[] items)
{
 foreach(IItem item in items)
   item.doSomething();
} 
```

这种解决方法效果很好，但我想知道实现相同行为的正确方法是什么。

**编辑：**

我忘了提到调用者`processItems`不知道实际类型。实际上这个想法是作为参数传递给的数组`processItems`可以包含混合类型。由于在 .Net 中不可能有这样的数组，因此使用非泛型基类或接口似乎是唯一的方法。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-09T11:24:34.983

执行此操作的正常方法是使方法通用：

```
public void ProcessItems<T>(Item<T>[] items) {
  foreach(Item<T> item in items)
    item.DoSomething();
} 
```

假设*调用者*知道类型，类型推断应该意味着他们不必显式指定它。例如：

```
Item<int> items = new Item<int>(); // And then populate...
processor.ProcessItems(items); 
```

话虽如此，创建一个指定与类型无关的操作的非泛型接口也很有用。这在很大程度上取决于您的确切用例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T14:53:11.473

我看到你只想调用一些没有参数的方法......已经有一个合同：`Action`。

```
public void processItems(IEnumerable<Action> actions)
{
  foreach(Action t in actions)
    t();
} 
```

客户：

```
List<Animal> zoo = GetZoo();
List<Action> thingsToDo = new List<Action>();
//
thingsToDo.AddRange(zoo
  .OfType<Elephant>()
  .Select<Elephant, Action>(e => e.Trumpet));
thingsToDo.AddRange(zoo
  .OfType<Lion>()
  .Select<Lion, Action>(l => l.Roar));
thingsToDo.AddRange(zoo
  .OfType<Monkey>()
  .Select<Monkey, Action>(m => m.ThrowPoo));
//
processItems(thingsToDo); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T11:22:45.020

在 .NET 通用实现中，您无法省略类型参数；这是设计使然。事实上，这只能在 Java 中实现，因为它是基于类型擦除的实现。

您只能使用基本的非通用接口（think `IEnumerable<T>`and `IEnumerable`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T11:34:33.150

继乔恩的帖子。使方法通用（模板）否定了对这种功能的要求（使用 <?>）。您始终可以将类型提供给泛型类/函数，并且对于您不知道需要什么类型的情况，您也可以将有问题的方法/类设为泛型......最终用户必须在调用时提供类型这样的函数或使用泛型类，以使代码能够编译......否则你会得到一些编译器错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-30T16:57:35.850

在从 Java 移植东西时，我一直在为同样的问题苦苦挣扎，因为我有类似的结构

```
if (o instanceof Collection<?>) doSoemthing((Collection<?>)o); 
```

幸运的是，泛型 ICollection 也是非泛型 ICollection，如果有人需要将其中的元素视为纯对象，它仍然是可能的：

```
if (o is ICollection) DoSomething((ICollection)o); 
```

这样，由于我们不关心集合中元素的实际类型，所以我们在这里得到的只是对象。此处需要注意：如果集合包含原始类型（例如 int 或 byte），则自动装箱可能会引入性能损失。

# security - 为什么在生产中使用使用 MakeCert 工具制作的证书不好？

> ID：527768
> 
> 赞同：12
> 
> 时间：2009-02-09T11:20:06.117
> 
> 标签：security, ssl, certificate, saml, certificate-authority

我目前正在开展一个项目，在该项目中我创建了一个 CA 证书和几个子证书到该 CA 证书。这些证书将用于保护 SAMLV2 设置中的服务器间通信，因此我将拥有一个用于身份提供者的证书和一个用于服务提供者的证书。用户/浏览器不会验证证书，因此只有服务器需要信任我的自定义 CA。我的证书树看起来像这样：

*   CustomRootCACert
    *   CustomIdentityProviderCert
    *   CustomServiceProviderCert

现在，我听到很多人说在生产中使用自制证书不好。但是当我问为什么时，人们通常只是在安全方面喃喃自语，但从不深入细节。是否有任何技术原因不在生产中使用我自己的证书？我想不出……当然，我意识到如果我失去对根证书的控制权，任何人都可以开始创建各种证书。但在这种情况下，他们还必须在我的服务器上安装证书并配置 saml 应用程序以使用它们。只有这样他们才能开始生成虚假的 saml 请求和对我的应用程序的响应。

如果这是唯一的问题，那么这个解决方案（在生产中使用自制证书）仍然会比我们今天的登录设置更好。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-09T11:31:13.860

问问自己证书证明了什么。

如果您获得由信誉良好的 CA 颁发的证书，则证明证书持有者已向该 CA 验证了他们的身份，符合他们的证明标准。

如果您获得了由 ad-hoc CA 颁发的证书，则证明有人知道如何制作证书。

如果您控制对话的两端，我认为拥有自己的私有 CA 就可以了。您会信任自己的 CA。您可能确实可以使这非常安全（通过将 CA 私钥保存在离线的安全位置，并进行签名运动网络练习）。

如果您需要说服其他人信任您的 CA，则困难在于。他们为什么要这样做？您需要说服他们这样做是安全的，并且他们将承担将您的 CA 证书添加到他们的客户端的管理开销。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-19T08:00:14.323

由于您仅使用证书来保护网络流量而不是对用户/计算机进行身份验证，因此听起来您可以合法地使用 MakeCert.exe。

我觉得有一点值得一提。在您花费一些时间使用 MakeCert.exe 界面后，您可能会考虑使用独立的根证书服务器。

考虑以下几点：

*   （几乎）所有版本的 Windows Server 都包含免费的证书服务器服务
*   Windows Stand-Alone CA Server 的安装和配置非常简单
*   Windows Stand-Alone CA Server 可以安装在虚拟机上，并在您需要颁发附加证书时打开/关闭
*   可以使用非常少的内存（例如 256mb）运行基于 VM 的 Windows Stand-Alone CA Server
*   Windows Stand-Alone CA Server 包含一个漂亮而干净的基于 Web 的注册界面，以简化请求证书的过程。
*   可以使用或不使用 CRL 检查，具体取决于您的需要。

过去，我首先从 selfssl.exe 开始，最终转到 MakeCert.exe 以生成根证书，然后颁发我的客户端证书。但是在与语法作斗争并且总是不得不记住我将根证书放在哪里之后，我切换到在虚拟机中使用独立根 CA。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T11:36:29.323

如果证书仅在您自己的服务器之间在内部传递（并且不被客户端使用，一种或另一种方式） - 那么使用您自己的内部 CA 是完全可以接受的。
但是，一个建议 - 不要让您的根 CA 颁发您的提供商证书。相反，使用您的根 CA 创建一个中间 CA - 然后使用它来颁发提供者证书。当您必须开始管理证书过期、扩展系统/基础设施、吊销列表等时，这将有助于您的长期发展。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-09T11:31:41.660

在私人使用中使用自签名证书没有真正的问题，即当您控制所有需要信任自制根证书的系统时使用。

您手动将根证书安装到需要信任它的每个系统上。

您可以在生产中执行此操作，也可以在浏览器使用中执行此操作 - 例如，在可以通过软件分发方法推出根 ca 的组织内 - 没有理由去支付 Microsoft 碰巧信任的证书颁发机构的费用。

[编辑]就安全性而言，问题在于包含根证书的私钥，只要您可以确保保持私有，那么您就可以验证该根证书的任何证书。

# regex - 如何忽略存储在 PowerShell 字符串变量中的转义序列？

> ID：527772
> 
> 赞同：22
> 
> 时间：2009-02-09T11:21:24.600
> 
> 标签：regex, powershell, escaping

在我的 PowerShell 脚本中，我在多个文件上运行 Select-String，寻找通过变量 ($id) 传递给它的字符串：

```
foreach ($file in (ls "path\to\files")) {
    $found = $false
    $found = Select-String -Path $file $id -Quiet
    if ($found) {
        break
    }
} 
```

不幸的是，$id 变量有时类似于“\C”或“\T”，Select-String 试图将其解释为转义序列。这些不是有效的转义序列，因此 Select-String 会引发错误。它们不是转义序列（例如，它可能是文件路径的一部分，例如“C:\Test”），那么如何防止 PowerShell/Select-String 将它们解释为这样呢？我试过在 $id 周围使用括号，但没有成功。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-09T12:11:36.227

使用静态`escape()`方法，它指示正则表达式引擎按字面意思解释这些字符而不是元字符：

```
$id = [regex]::escape($id) 
```

您还可以将命令转换为单行（`-path`可以获取文件集合）：

```
Select-String -Path path\to\files\\* -Pattern ([regex]::escape($id)) -Quiet 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-23T19:07:39.997

Select-String 有一个`-SimpleMatch`参数，该参数将导致 cmdlet 进行简单的字符串匹配而不是正则表达式。如果您将脚本更改为：

```
 $found = Select-String -Path $file $id -Quiet -SimpleMatch 
```

它应该按需要工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T12:32:51.513

如果 $id 字符串在传递给您时已经包含类似 TAB 的内容，那么我不知道有内置方法可以安全地将其转义回“\t”。您首先需要确保您的脚本传递了正确的字符串。即它需要传递 0x5C74 (\t) 而不是 0x09 (TAB)。所以在第一次定义搜索字符串时需要进行转义。

Regex.Escape 将转义 TAB -> \t 但也会转义任何在正则表达式中有意义的字符：

\、*、+、?、|、{、[、(,)、^、$、.、# 和空格

例如。-> \。

# php - PHP是否在MySQL中存储图像？

> ID：527801
> 
> 赞同：31
> 
> 时间：2009-02-09T11:33:16.350
> 
> 标签：php, mysql, image

我在 PHP 中构建了一个小型 Web 应用程序，用户必须首先登录。一旦他们登录，我打算在他们的“个人资料”中显示一个小缩略图。

我必须确保图像低于特定尺寸以节省空间，或确保它具有特定分辨率，或两者兼而有之，甚至可能使用图像魔术之类的东西来缩小它。
不确定什么是最好的方法，欢迎任何想法。

另外，我一直在尝试将图像存储在`users`MySQL 的表中作为 blob 更好，或者可能是`images`具有唯一 ID 的单独表，并将适当的图像 ID 存储在`users`表中，或者只是保存在服务器上上传的文件（也通过上传页面）并将文件另存为`theUsersUniqueUsername.jpg`. 最佳选择？

我在这里找到了将图像保存到 mysql 的教程： [http ://www.phpriot.com/articles/images-in-mysql](http://www.phpriot.com/articles/images-in-mysql)

我只是一个爱好程序员，以前从未做过这样的事情，因此非常感谢示例和/或很多细节。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-09T11:39:58.300

总是取决于上下文，但通常，我将用户图像存储在文件系统上的一个名为的文件夹中`/content/user/{user_id}.jpg`，并尝试尽可能少地打扰数据库。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-09T11:35:19.513

我建议将图像存储为文件，然后将文件 URI 保存在数据库中。如果您将所有图像存储在数据库中，您可能会在以后缩放时遇到一些问题。

也看看[这个答案](https://stackoverflow.com/questions/522957/what-is-the-best-format-to-store-images-in-a-database/522983#522983)：

> Microsoft 对 SQL Server 的建议曾经是，出于速度和大小的考虑，将图像存储在文件系统中，并在数据库中提供链接。我认为他们已经稍微缓和了他们的偏好，但我仍然认为它肯定是一个更好的主意，因为它不会占用数据库中的空间。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-12-19T14:41:34.253

使用 BLOB 的开销比大多数人想象的要少得多，尤其是如果你设置正确的话。如果您使用仅运行数据库的单独服务器来存储二进制文件，那么您实际上可以完全不使用文件系统并避免文件系统的任何开销

也就是说，除非您自己拥有几台服务器，否则最简单/最好的方法是将它们存储在文件系统中

*   不要将文件的绝对 URL 存储在您的数据库中，只存储唯一的部分（可能是一个或两个文件夹），例如`2009/uniqueImageName.jpg`或只是`uniqueImageName.jpg`. 然后在您的页面中，只需将主机和其他文件夹添加到前面，这样您就可以灵活地移动图像 - 您需要更改的只是 PHP/ASP.NET 页面中的一两行。

*   出于安全考虑，无需存储在文档根目录之外 -`.htaccess`带有 DENY FROM ALL 的文件将具有相同的工作方式并提供更大的灵活性

*   为了安全起见，无需过多地“分流”图像，只需有一个`getImage.php`页面或其他东西，然后不要在 . 中插入实际 URL，`src`而是`image`使用`getImage.php?file=uniqueImageName.jpg`. 然后`getImage.php`文件可以检查用户是否被授权并抓取图像（或没有）。

*   存储时使用保证唯一的名称（最好是整数，即主键），某些文件系统（即 Windows）不区分大小写，因此对于数据库`JoeBloggs.jpg`来说`joebloggs.jpg`是唯一的，但对于文件系统来说不是唯一的将覆盖另一个。

*   为图像使用单独的表，并将图像的主键存储在 users 表中。如果您将来想添加更多字段或进行更改，这将更容易 - 这也是一种很好的做法。

如果您担心 SEO 和类似的事情，请在上传时将图像的原始文件名存储在另一个字段中，然后您可以在输出中使用它（例如在`alt`标签中）。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-01-19T20:03:36.793

## 挑战传统智慧！

当然它是上下文相关的，但是我有一个非常大的应用程序，在 MySQL 数据库中存储了数千个图像和文档作为 BLOBS（平均大小 = 2MB），并且该应用程序在具有 256MB 内存的服务器上运行良好。秘诀是正确的数据库结构。始终保留两个单独的表，其中一个存储有关文件的基本信息，另一个表应仅包含 blob 和用于访问它的主键。所有基本查询都将针对 details 表运行，而另一个表仅在实际需要文件时才访问，并且使用索引键访问，因此性能非常好。

将文件存储在数据库中的优点是多方面的：

1.  需要更简单的备份系统，因为您不需要备份文件系统
2.  控制文件安全性要容易得多，因为您可以在发布二进制文件之前进行验证（是的，您可以将文件存储在非公共目录中并让脚本读取并反刍文件，但性能不会明显更快。
3.  （与 #1 类似）它干净地将“用户内容”和“系统内容”分开，使迁移和克隆更容易。
4.  更容易管理文件、跟踪/存储版本更改等，因为您需要更少的脚本修改来添加版本控制。

如果性能是一个大问题并且安全性和备份不是（或者如果你有一个好的 fs 备份系统）那么你可以将它存储在 FS 中，但即使那样我也经常将文件（在图像的情况下）存储在数据库中并构建一个缓存脚本，在第一次使用图像后将其写入缓存文件夹（是的，这会使用更多的 HD 空间，但这几乎从来都不是限制因素）。

无论如何，显然 FS 在许多情况下都运行良好，但我个人发现数据库管理更容易和更灵活，如果写得好，性能损失非常小。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-09T11:44:14.640

我们创建了一个在数据库中存储图像的商店。它在开发过程中运行良好，但是一旦我们在生产服务器上对其进行测试，页面加载时间就太长了，并且给数据库服务器增加了不必要的负载。

虽然将二进制文件存储在数据库中似乎很有吸引力，但获取和操作它们会增加额外的复杂性，只需将文件保存在文件系统上并将路径/元数据存储在数据库中即可避免这种复杂性。

这是那些永恒的争论之一，双方都有很好的论据，但为了我的钱，我会让图像远离数据库。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-09T11:40:22.463

我最近看到了这个提示列表：[http ://www.ajaxline.com/32-tips-to-speed-up-your-mysql-queries](http://www.ajaxline.com/32-tips-to-speed-up-your-mysql-queries)

提示 17：对于您的 Web 应用程序，图像和其他二进制资产通常应存储为文件。也就是说，只在数据库中存储对文件的引用而不是文件本身。

所以只需将文件路径保存到图像:)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-02-08T18:36:16.040

我在以前的项目中实现了这两种解决方案（文件系统和数据库持久化图像）。在我看来，您应该将图像存储在数据库中。原因如下：

1.  当您的应用服务器集群时，文件系统存储会更加复杂。您必须拥有共享存储空间。即使您当前的环境不是集群的，这也会使您在需要时更难以扩展。
2.  无论如何，您应该为您的静态内容使用 CDN，并将您的应用设置为源。这意味着您的应用程序只会针对给定图像点击一次，然后将其缓存在 CDN 上。CloudFront 非常便宜且易于设置……没有理由不使用它。为您的动态内容节省带宽。
3.  开发数据库持久化图像要快得多（因此更便宜）
4.  您可以通过数据库持久化图像获得参照完整性。如果您在文件系统上存储图像，您将不可避免地有没有匹配数据库记录的孤立文件，或者您将有文件链接断开的数据库记录。这将会发生……这只是时间问题。你必须写一些东西来清理这些。

无论如何，我的两分钱。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-01T23:35:54.890

1.  无论如何，如果不是用于存储文件，那么 blob 数据类型是什么？
2.  如果您的应用程序在访问文件之前涉及授权，则更改是您 a）将文件存储在 DOCUMENT_ROOT 之外（因此无法直接访问它们；并且可能 b）通过应用程序发送文件的全部内容（当然，也许您正在做某种临时移动到散列但可公开访问的文件名的事情）。所以无论如何内存开销是存在的，你还不如从数据库中检索数据。
3.  如果您必须将文件存储在文件系统中，请按照 Andreas 上面的建议进行操作，并使用您已经知道的名称（即相关表的主键）命名它们。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-09T11:41:29.343

我认为大多数数据库引擎已经如此先进，以至于存储 BLOB 数据不会产生任何缺点（膨胀的数据库等）。一个优点是当图像已经在数据库中时，您没有任何断开的链接。话虽如此，我自己总是这样做，以便将文件存储在磁盘上并将 URI 提供给数据库。这取决于使用情况。如果页面非常动态并且经常更改 - 没有命名空间 - 问题，则处理 img-in-db 可能会更容易。我不得不说它最终取决于您的喜好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-09T13:12:42.290

我建议您不要将图像存储在您的数据库中。相反，由于每个用户都将在数据库中拥有与他/她的个人资料相关联的唯一 ID，因此请使用该 ID 将图像物理存储在服务器上。

例如，如果用户的 id 为 23，您可以将图像存储在 www.yourname.com/users/profile_images/23.jpg 中。然后显示，您可以检查图像是否存在，并相应地显示它，否则显示您的通用图标。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-09T14:36:10.653

正如其他人建议的那样：

*   将图像存储在文件系统中
*   不要费心存储文件名，只需使用用户 ID（或“您已经知道”的任何其他内容）
*   将静态数据放在不同的服务器上（即使您只是使用“static.yourdomain.com”作为普通服务器的别名）

为什么 ？

您的数据库越大，速度就越慢。将图像存储在数据库中会增加数据库大小。存储文件名会增加您的数据库大小。

将静态数据放在不同的服务器上（别名）：

*   使扩展更容易
*   大多数浏览器不会向同一个服务器发送两个以上的请求，通过将静态数据放在“第二个”服务器上可以加快加载速度

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-02-15T16:28:01.110

经过几天的研究，我制作了一个在数据库中存储图像和二进制文件的系统。

真是太棒了。我现在对文件有 100% 的控制权，例如访问控制、图像大小（当然，我不会动态缩放图像）、统计、备份和维护。

在我的速度测试中，系统现在慢了 10 倍。但是，它还没有投入生产，我将实施系统缓存和其他优化。

使用 MVC 在共享主机上检查这个仍在开发中的真实示例： [http ://www.gt8.com.br/salaodocalcado/calcados/meia-pata/](http://www.gt8.com.br/salaodocalcado/calcados/meia-pata/)

在此示例中，如果用户登录，他可以看到不同的图像。所有产品图像和其他二进制文件都在数据库中，不缓存，不在 FS 中。

我在专用服务器上进行了一些测试，结果远远超出预期。

所以，在我个人看来，虽然它需要付出很大的努力来实现它，但将图像存储在数据库中是值得的，而且好处比坏处要多得多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T22:10:01.250

正如其他人告诉你的那样，永远不要将图像存储在数据库中。文件系统用于存储文件->图像是文件->将它们存储在文件系统中:-)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-03-31T02:41:23.950

刚刚测试了我的img作为blob，所以。此解决方案的工作速度比服务器上的图像作为文件慢。加载时间应该与来自 DB 或 http 的图像相同，但不是。为什么？我敢肯定，当图像是服务器上的文件时，浏览器可以缓存它并只加载一次，第一次。当图像离开数据库时，每次都会重新加载。这是我的意见。也许我对浏览器缓存有误，但工作速度较慢（blob）。对不起我的英语，无论如何;P

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-01-29T08:37:37.693

这些是两种解决方案的优点

**在斑点中：**

1) 优点：管理集群很容易，因为您不必处理服务器之间的文件同步等棘手问题

2）数据库备份也将是详尽的

**在文件中**

1）本地缓存方便（这是以前评论的缺失点，刷新和标题，您不必在数据库中重新设计（默认情况下，数据库不处理最后修改时间）

2）以后调整大小的容易性

3）易于审核（只需检查您的文件夹以检查一切是否正确）

由于所有这些原因，并且由于数据库的两个优点更容易在文件系统上复制，我强烈推荐文件！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-06-08T16:16:36.923

就我而言，我将文件存储在**文件系统中**。在我的图像文件夹中，我为基于项目 ID 命名的每个项目（来自 db 的行）创建新文件夹。并按从 0 开始的顺序命名图像。因此，如果我有一个名为 Items 的表，如下所示：

```
 Items      
|-----|------|-----|
| ID  | Name | Date|
|-----|------|-----|
| 29  | Test1| 2014|
|-----|------|-----|
| 30  | Test2| 2015|
|-----|------|-----|
| 31  | Test3| 2016|
|-----|------|-----| 
```

我的图像目录看起来像：

```
images/
      29/
      30/
      31/

images/29/0.png
images/29/1.jpeg
images/29/2.gif 
```

等等

# regex - Perl中正则表达式的双重插值

> ID：527803
> 
> 赞同：7
> 
> 时间：2009-02-09T11:33:27.600
> 
> 标签：regex, perl, interpolation

我有一个将正则表达式存储在配置文件中的 Perl 程序。它们采用以下形式：

```
regex = ^/d+$ 
```

在其他地方，正则表达式从文件中解析并存储在变量 -`$regex`中。然后我在检查正则表达式时使用该变量，例如

```
$lValid = ($valuetocheck =~ /$regex/); 
```

我希望能够在配置文件中包含 perl 变量，例如

```
regex = ^\d+$stored_regex$ 
```

但我不知道该怎么做。

当 Perl 解析正则表达式时，它们会被解释两次。首先展开变量，然后解析正则表达式本身。

我需要的是一个三阶段的过程：首先 interpolate `$regex`，然后插入它包含的变量，然后解析生成的正则表达式。前两个插值都需要“正则表达式感知”。例如，他们应该知道字符串包含`$`作为锚点等...

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T12:53:49.137

您可以像这样在配置文件中定义正则表达式：

```
regex = ^\d+(??{$stored_regex})$ 
```

但是您需要通过在 Perl 程序中执行此操作来禁用正在使用正则表达式的块中的安全检查：

```
use re 'eval'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T11:48:15.567

在这里使用[eval](http://perldoc.perl.org/functions/eval.html)可以为您提供帮助。看看下面的代码，它可以预编译一个可以在后面使用的正则表达式：

```
my $compiled_regexp;
my $regexp = '^\d+$stored_regexp$';
my $stored_regexp = 'a';

eval "\$compiled_regexp = qr/$regexp/;";
print "$compiled_regexp\n"; 
```

运算符 qr// 可用于预编译正则表达式。它允许您构建它但尚未执行它。您可以先用它构建您的正则表达式，然后再使用它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T11:48:53.287

您的 Perl 变量不在配置文件的范围内，我认为这是一件好事。评估是可怕的。

你最好实现自己的模板。

所以在配置文件中：

```
regex = ^\d+__TEMPLATE_FIELD__$ 
```

在配置文件阅读器中：

```
# something like this for every template field you need
$regex =~ s/__TEMPLATE_FIELD__/$stored_regex/g; 
```

使用时：

```
$lValid = ($valuetocheck =~ m/$regex/) 
```

根据您希望在什么时候应用模板替换来移动这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-09T21:19:04.190

一个与切线相关的问题：如果您内联进行双插值，并且在变量中也有替换字符串，请考虑：

```
# the concat with doublequotes in the replacement string 
#  are to make them PART OF THE STRING, NOT THE STRING DELIMITERS,
#  in other words, so the 2nd interpolation sees a double quoted string :
#     eval eval $replace -> eval $1 hello world -> syntax error 
#     eval eval $replace -> eval "$1 hellow world"  -> works ok 
# see: http://www.perlmonks.org?node_id=687031  

if($line =~ s/$search/'"' . $replace . '"'/ee) {
     # STUFF... 
} 
```

# mobile - 手机/PDA + SQL Server 数据同步

> ID：527805
> 
> 赞同：2
> 
> 时间：2009-02-09T11:33:47.630
> 
> 标签：mobile, synchronization, replication, sql-server-ce

在这里需要一点建议。我们在移动设备上使用 .NET Compact 框架和 SQL CE 以及客户办公室的中央 SQL 2005 数据库进行一些 Windows Mobile 开发。目前我们使用合并复制技术来同步数据。

最近我们遇到了一些烦人的同步抛出错误问题，而且通常有点不可靠。更复杂的是，关于复制问题的信息似乎有限。这向我表明它不是一种常用的技术。

所以，我只是想知道复制是同步数据的方法还是有更可靠的方法？我在想可能是网络服务或类似的东西。你们用什么来实现这个解决方案？

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T14:33:49.803

我没有大量使用复制，但我已经使用它并且我没有遇到任何问题。问题是，您需要仔细设置。无论您使用哪种方法，您都需要决定管理所有各种可能情况的规则 - 两个数据库的更改等。

如果您对“通常有点不可靠”更具体，那么也许您会得到更多有用的建议。我只能说，我没有遇到任何问题。

编辑：鉴于您在下面的回答，我只想说您当然可以使用使用 SSIS 或其他方法的自定义复制，但肯定有商店在生产环境中成功使用复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T16:07:15.163

好吧，我们已经发生了两次错误，这是一个真正的痛苦修复：-

*插入失败。它与数据库“egScheduler”、复制表“dbo.tblServiceEvent”、列“serviceEventID”中的标识范围检查约束冲突。如果标识列由复制自动管理，则更新范围如下：对于发布者，执行 sp_adjustpublisheridentityrange；对于订阅服务器，运行分发代理或合并代理。*

当我们尝试运行存储过程时，它会弄乱身份，所以现在当我们尝试同步时，它会在复制监视器中引发以下错误。

*由于违反完整性，无法重新应用行操作。检查发布过滤器。[,,,Table,Operation,RowGuid]（来源：MSSQLServer，错误号：28549）*

我们还遇到了一些问题，即快照无效，但这些问题相对容易修复。然而，这一切让我想知道复制是否是我们在这里尝试做的最好的方法，或者是否有更简单的方法。这就是引发我最初的问题的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:01:19.897

我们正在处理类似的情况，但我们正在编写一个在断开连接的模型中工作并在 Windows 桌面上运行的工具......我们使用 SQL Server Compact Edition 客户端和 Microsoft SQL Server 2005服务器解决方案的 Web 服务。

为了启用同步服务，我们最初是从构建自己的同步框架开始的，但是在保持该框架与系统其余部分同步的许多问题之后，我们选择使用 Microsoft 同步框架。（[http://msdn.microsoft.com/en-us/sync/default.aspx](http://msdn.microsoft.com/en-us/sync/default.aspx)供参考）。我们最初的要求是让应用程序像安装其他软件包（如 Intuit QuickBooks）一样易于使用，我认为我们已经取得了巨大的成功。

Microsoft 的同步框架有其起起落落，但在这一点上我可以说的唯一坏事是文档太可怕了。

我们现在正在讨论决定是继续使用它还是回去维护我们自己的同步子系统。YMMV，但对我们来说，这是一个快速解决问题的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T22:14:03.003

你肯定在推动 CE 的稳定性，不是吗？

完成此操作后，我发现有必要添加相当多的冲突容忍度，而不是将同步视为同步异步数据收集，间歇性相互更新和/或刷新。特别是，我一直避免将身份列用于任何事情。如果您可以严格遵守基于真实（非代理）数据的真正主键，它会使事情变得更容易。有时，包含 SourceUnitNumber 和时间戳的 PK 效果很好。

If you can, view the remotely collected data as a simple timestamped, sourceided, userided log of cumulative chronologically ordered transactions. Going the other way, the host provides static validation info which never needs to go back - send back the CRUD transactions instead.

Post back how this turns out. I'm interested in seeing any kind of reliable Microsoft technology that helps with this.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T09:41:59.653

TomH & le dorfier - I think that part of our problem is that we're allowing the customer to insert a large number of rows into one of the replicated table with an identity field. Its a scheduling application which can automatically multiple tasks up to a specified month/year. One of the times that it failed was around the time they entered 15000 rows into the table. We'll look into increasing the identity range.

同步框架听起来很有趣，但听起来它遇到了与复制文档质量差的问题类似的问题。试图在复制上寻求帮助有点像噩梦，我不确定我是否希望我们转向有类似问题的东西。希望 M'soft 停止发布似乎支持 beta s'ware 的东西！

# css - css垂直居中

> ID：527811
> 
> 赞同：24
> 
> 时间：2009-02-09T11:35:40.340
> 
> 标签：css

我怎么能在 a`<div>`中垂直居中 a `<div>`？

到目前为止我的代码：

```
<div style="height:322px;overflow:auto;">
    <div style="border: Solid 1px #999999;padding:5px;">
    </div>
</div> 
```

我试过“top:50%;” 和“垂直对齐：中间；” 没有成功

**编辑：**好的，所以已经讨论了很多。我可能已经开始了另一场迷你火焰战争。但为了争论，那我怎么用桌子做呢？到目前为止，我已经将 css 用于其他所有内容，所以这不像我没有尝试采用“良好做法”。

**编辑：**内部 div 没有固定高度

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-09T11:40:46.973

简而言之，你吃饱了。在我最近提出的一个问题中对此有更多详细信息，[您可以在不使用表格的情况下进行此 HTML 布局吗？](https://stackoverflow.com/questions/522928/can-you-do-this-html-layout-without-using-tables) 基本上，CSS 狂热者需要掌握并意识到有些事情没有表格就不能做（或做不好）。

这种反桌子的歇斯底里简直是荒谬的。

表格单元格处理垂直居中非常好，并且在您可能关心的范围内向后兼容。它们还比浮动、相对/绝对定位或任何其他 CSS 类型方法更好地处理并排内容。

[Joel 在Don't Let Architecture Astronauts Scare You](http://www.joelonsoftware.com/articles/fog0000000018.html)中创造了（或至少普及了）“建筑师宇航员”一词。好吧，同样地，我认为“CSS Astronaut”（或“CSS Space Cadet”）这个词同样合适。

CSS 是一个非常有用的工具，但它也有一些非常严重的局限性。我最喜欢的 ishow 编号列表可能只显示为“3”。但不是“3)”或“(3)”（至少在 CSS3 生成内容之前——或者它是 CSS2.1？无论哪种方式都没有得到广泛支持）。多么疏忽。

但比这更大的是垂直居中和并排布局。这两个领域对于纯 CSS 来说仍然是一个巨大的问题。另一位发帖人认为相对定位与负边距高度相结合是可行的方法。这有什么比：

```
<html>
<head>
  <title>Layout</title>
  <style type="text/css">
    #outer { height: 200px; border: 1px solid black; width: 600px; background-color: #DDD; }
    #inner { width: 150px;  border: 1px solid red; background: yellow; margin: auto; line-height: 100%;  }
  </style>
</head>
<body>
<table>
<tr>
<td id="outer">
  <div id="inner">Inner</div>
</td>
</tr>
</table>
</body>
</html> 
```

这将随时随地工作。

这是[一篇关于 CSS 中的垂直居中](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)的文章。为了达到类似的效果，他们使用**了三个嵌套的 div**，具有相对+绝对+相对定位**，只是为了获得垂直居中**。我很抱歉，但无论是谁写的——以及任何认为这是一个好死的人——都只是失去了情节。

[在Tables vs CSS: CSS Trolls begone](http://iamelgringo.blogspot.com/2009/02/tables-vs-css-css-trolls-begone.html)中给出了一个反驳。证据确实在布丁中。前 20 名 (Alexa) 网站中的绝大多数仍然使用表格进行布局。 **有充分的理由。**

因此，请自行决定：您是否希望您的网站正常运行并花更少的时间让它正常运行？或者你想成为一名 CSS 宇航员？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-09T11:39:27.333

这不是微不足道的，可能有一些警告，而且 CSS 目前还不能很好地处理它。

然而，它*被*广泛讨论和[搜索](http://www.google.com/cse?q=%2Bvertical+%2Bcenter+%2Bcss)。[这](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)是一个很好的例子。

无论您做什么，请不要退回到表格。

* * *

编辑：这太荒谬了，以下内容在严格的文档中非常有效，而无需使用表格标记：

```
<style type="text/css">
.outer {height: 322px; overflow: hidden; position: relative;}
*|html .outer {display: table; position: static;}

.middle {position: absolute; top: 50%;}
*|html .middle {display: table-cell; vertical-align: middle; position: static;}

.inner {position: relative; top: -50%; overflow: auto;}
*|html .inner {position: static; max-height: 322px;}
</style>
<!--[if IE]>
<style>
.inner {height: expression(Math.min(this.scrollHeight,322)+'px'); width: 100%;} /* for explorer only */
</style>
<![endif]-->

<div class="outer">
    <div class="middle">
        <div class="inner">
          Any text any height
        </div>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-08T22:41:54.640

我最喜欢[这个解决方案](http://css-tricks.com/centering-in-the-unknown/)。它适用于IE8+，易于理解。

```
<style>
/* Can be any width and height */
.block {
  height:500px;
  text-align: center;
}

/* The ghost, nudged to maintain perfect centering */
.block:before {
  content: '';
  display: inline-block;
  height: 100%;
  vertical-align: middle;
  margin-right: -0.25em; /* Adjusts for spacing */
}

/* The element to be centered, can be any width or height */ 
.centered {
  display: inline-block;
  vertical-align: middle;
  width: 300px;
}
</style>

<div class="block"><div class="centered">Centered Content</div></div> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-09T11:48:20.230

最高：50%；应该管用。您需要将 margin-top 设置为高度的负一半，否则它将从中间开始。因此，您需要内部 div 的高度。您可能还需要 position:relative;

像这样的东西适合你的内部 div。

```
position:relative;
top: 50%;
height:80px;
margin-top: -40px; /*set to a negative number 1/2 of your height*/ 
```

使用负尺寸不是很整洁（这甚至意味着什么？）但也许是最简单的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T12:09:23.720

```
<div style="display: table; height: 400px; #position: relative; overflow: hidden;">
  <div style=" #position: absolute; #top: 50%;display: table-cell; vertical-align: middle;">
    <div style=" #position: relative; #top: -50%">
    vertically centered
    </div>
  </div>
</div> 
```

更多[信息](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-19T14:12:48.403

# 多种技术中的两种

以下浏览器兼容性仅在 IE 中进行了测试。现代浏览器应该可以处理这些问题。

## #1 - 绝对和自动保证金

**兼容性：** IE 8 +

*   top、right、bottom、left 的组合，`margin: auto`将 div 垂直和水平居中。

*   宽度和高度是必需的，但**可以是百分比**

也可以应用于带有父集的内部 div`position: relative`

**注意：** IE 9 + 可以用A`max-width`和`max-height`代替高度百分比。IE 8 需要一个`height`.

```
html,
body {
  height: 100%;
}
.outer {
  background: #ff8f00;
  height: 50%;
  width: 50%;
  margin: auto;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}
```

```
<div class="outer"></div>
```

* * *

## #2 - 弹性盒

**兼容性：** IE 11。有关[其他浏览器支持，请参见此处](http://caniuse.com)。

使用[Flexbox](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Flexible_boxes)和弹性[`vw`和`vh`长度](https://developer.mozilla.org/en/docs/Web/CSS/length#Viewport-percentage_lengths)

```
body {
  margin: 0;
}

.outer {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
}
.inner {
  width: 50vw;
  height: 50vh;
  background: #ff8f00;
}
```

```
<div class="outer">
  <div class="inner">

  </div>
</div>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T11:48:39.637

你绝对需要用css做这个吗？上面的链接看起来不错，但是您可以使用 javasctipt/jquery 获得结果 - 确定内部 div 的高度并相应地调整 margin.padding。类似于：（jquery *）*

```
var gap = ( $('the-outer-div').height() - $('the-inner-div').height() ) /2;
$('the-inner-div').css( "margin-top" , gap ); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-15T02:16:47.147

如果您愿意使用 flexbox 显示模型，则不需要表格。

例如

```
<div style="height: 322px; width: 200px; display: flex; background: gray;">
    <div style="border: Solid 1px #999999; padding:5px; margin: auto;">
      This text would be both vertically AND horizontally centered, if it's inner height and width were less than the parent's height and width.
    </div>
</div> 
```

如果您只想垂直居中，请使用规则“margin: auto 0;” 在子分区中。

ps 如果你想要跨浏览器的兼容性，你必须在你使用的 flexbox 前面加上前缀（例如“display: -webkit-flexbox;”）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-25T14:03:07.153

该`display: flex`属性特别适用于垂直和水平居中。对于垂直居中，将属性`display: flex`和添加`justify-content: center`到容器中。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2009-02-09T11:41:21.200

尝试行高

# sharepoint - 如何在 Internet 上发布 SharePoint 网站

> ID：527818
> 
> 赞同：1
> 
> 时间：2009-02-09T11:37:18.260
> 
> 标签：sharepoint, sharepoint-2007, shared-hosting

我有一个 WSS SharePoint 站点，我需要将其部署和发布到该站点，用户将能够通过 Internet 访问它。我知道这是可能的，但我该怎么做呢？有没有人有一些好的文章？

亲切的问候艾蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T20:09:49.543

来自[Microsoft Team Blog](http://blogs.msdn.com/sharepoint/archive/2006/08/08/planning-designing-amp-securing-an-extranet-and-internet-facing-wssv3-and-sharepoint-server-2007-environments.aspx)，本质上是一个链接到相关文章的页面。

您还可以下载[SharePoint 规划服务入门工具包](https://iwsolve.partners.extranet.microsoft.com/SDPS/ProgramOverview.htm#StarterKit)

# c# - Linq 子选择

> ID：527819
> 
> 赞同：14
> 
> 时间：2009-02-09T11:37:22.580
> 
> 标签：c#, linq, outer-join

如何在 LINQ 中编写子选择。

如果我有一个客户列表和一个订单列表，我想要所有没有订单的客户。

这是我的伪代码尝试：

```
 var  res = from c in customers 
where c.CustomerID ! in (from o in orders select o.CustomerID) 
select c 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-09T11:45:21.267

怎么样：

```
var res = from c in customers 
          where !orders.Select(o => o.CustomerID).Contains(c.CustomerID)
          select c; 
```

另一种选择是使用：

```
var res = from c in customers
          join o in orders 
               on c.CustomerID equals o.customerID 
               into customerOrders
          where customerOrders.Count() == 0
          select c; 
```

顺便说一句，您使用的是 LINQ to SQL 还是其他东西？不同的口味可能有不同的“最佳”方式

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-09T11:44:55.543

如果这是数据库支持的，请尝试使用导航属性（如果您定义了它们）：

```
var res = from c in customers
          where !c.Orders.Any()
          select c; 
```

在 Northwind 上，这会生成 TSQL：

```
SELECT /* columns snipped */
FROM [dbo].[Customers] AS [t0]
WHERE NOT (EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [dbo].[Orders] AS [t1]
    WHERE [t1].[CustomerID] = [t0].[CustomerID]
    )) 
```

哪个做得很好。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-02-25T13:23:32.440

```
 var result = (from planinfo in db.mst_pointplan_info
                                                           join entityType in db.mst_entity_type
                                                           on planinfo.entityId equals entityType.id
                                                           where planinfo.entityId == entityId
                                                           && planinfo.is_deleted != true
                                                           && planinfo.system_id == systemId
                                                           && entityType.enity_enum_id == entityId
                                                           group planinfo by planinfo.package_id into gplan
                                                           select new PackagePointRangeConfigurationResult
                                                           {
                                                               Result = (from planinfo in gplan
                                                                         select new PackagePointRangeResult
                                                                         {
                                                                             PackageId = planinfo.package_id,
                                                                             PointPlanInfo = (from pointPlanInfo in gplan
                                                                                              select new PointPlanInfo
                                                                                              {
                                                                                                  StartRange = planinfo.start_range,
                                                                                                  EndRange = planinfo.end_range,
                                                                                                  IsDiscountAndChargeInPer = planinfo.is_discount_and_charge_in_per,
                                                                                                  Discount = planinfo.discount,
                                                                                                  ServiceCharge = planinfo.servicecharge,
                                                                                                  AtonMerchantShare = planinfo.aton_merchant_share,
                                                                                                  CommunityShare = planinfo.community_share
                                                                                              }).ToList()
                                                                         }).ToList()
                                                           }).FirstOrDefault(); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-09T11:45:02.360

```
var  res = (from c in orders where c.CustomerID == null
               select c.Customers).ToList(); 
```

或使除外（）

# javascript - Textpattern 的 hak_tinymce 插件在 IE 中不起作用

> ID：527821
> 
> 赞同：0
> 
> 时间：2009-02-09T11:37:48.977
> 
> 标签：javascript, tinymce, textpattern

我在我运行的网站上设置了 Textpattern 的 hak_tinymce 插件，它在 Firefox、Chrome、Safari 和 Opera 中运行良好。但是，在 IE 中，内容区域是灰色的（例如，它不存在），并且 Javascript 失败并出现以下错误：

```
Webpage error details

User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; 
    SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; 
    Media Center PC 6.0)
Timestamp: Mon, 9 Feb 2009 11:35:09 UTC

Message: Invalid argument.
Line: 510
Char: 2
Code: 0
URI: http://www.example.com/textpattern/tinymce/tiny_mce.js 
```

Firebug 没有给出错误。

我正在使用 tiny_mce.js 的非混淆版本，修订版 1.158：

```
// Must have a src element in MSIE HTTPs breaks aswell as absoute URLs
if (tinyMCE.isMSIE)
    iframe.setAttribute("src", this.settings['default_document']);

iframe.style.width = tinyMCE.settings['area_width'];
iframe.style.height = tinyMCE.settings['area_height']; // ** THIS LINE! **

// MSIE 5.0 issue
if (tinyMCE.isMSIE)
    replace_element.outerHTML = iframe.outerHTML;
else
    replace_element.parentNode.replaceChild(iframe, replace_element); 
```

我不知道这是什么。我可以在网上找到的唯一解释表明，这与未在用于访问编辑器的 URL 中使用 www 前缀有关，但这似乎无关紧要。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T13:13:06.393

好吧，您可以尝试[启用 MS 脚本调试器](http://blogs.msdn.com/ie/archive/2004/10/26/247912.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T07:49:29.470

答案原来是 hak_tinymce 中的一个错误，而不是 tinyMCE 本身。hak_tinymce 使用值周围的引号指定 Javascript 数组中文本区域的高度，如下所示：

```
somesetting: "somevalue",
height:"420", 
```

当 tinyMCE 尝试对高度值进行算术运算时，它会以某种方式变成一个字符串，而它本应被视为整数。脚本调试器显示高度设置为“420-42”，我不知道如何。

但是，在 hak_tinymce 中，在第 276 行和第 277 行之间添加以下内容是可行的：

```
EOF;
$js = preg_replace('/height:\"(\d+)\"/i', 'height:$1', $js); // added line
return $js; 
```

这解决了正文和摘录文本区域的问题。

# css - Chrome/Safari 忽略了我的重置规则？

> ID：527822
> 
> 赞同：6
> 
> 时间：2009-02-09T11:38:36.447
> 
> 标签：css, safari, google-chrome

[链接文本](http://tinyurl.com/bt5n4c)

在 Safari/Chrome 中，它在 ol's、blockquotes 和其他元素的左侧/顶部有额外的间距。

我无法隔离这一点，但是当我查看 Safari 中的网络检查器时，它会在某些元素上拾取一个 margin-left: 26px。我没有指定任何此类规则，所以这是 Web 检查器中的错误吗？

有人能告诉我为什么会出现这些额外的间距问题吗？谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T14:44:25.860

那个 margin-left:26px 是你的样式 margin-left:2em 的“计算样式”。因此，为什么它位于 Safari 的 Web Inspector 的 Computed Style 部分。因此，如果您将 margin-left 更改为其他一些值，则计算样式的像素值也会发生变化。

无论如何，确实有额外的填充！它是由用户代理样式表（-webkit-padding-start:40px）引起的。通过在您的 ol 和您想要的任何其他元素上设置 padding:0 来重置此样式。

防止此问题再次发生并放心开发的一个好方法是重置您的 css。基本重置将是：

```
* { margin:0; padding:0; } 
```

# git - 如何配置git避免意外git push

> ID：527833
> 
> 赞同：34
> 
> 时间：2009-02-09T11:44:40.100
> 
> 标签：git

在 git clone 之后，新仓库中的配置如下所示：

```
remote.origin.url=<some url>
remote.origin.fetch=+refs/heads/*:refs/remotes/origin/*
branch.master.remote=origin
branch.master.merge=refs/heads/master 
```

然后，我可以执行“git pull”和“git push”。但我只对“git pull”感兴趣，因为我想推进另一个回购。

我能做的一件事是：

```
git add remote repo-for-push <some other url>
git push repo-for-push master 
```

但我想将 git 配置为使用默认和不同的存储库进行拉取和推送，即：

```
git pull # pulls from origin
git push # pushes into repo-for-push, avoiding accidental push into the origin 
```

如何配置？提前致谢。

编辑：
基本上，我想将默认推送存储库设置为与默认获取/拉取存储库不同。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-03T15:46:18.387

好像

```
git config remote.origin.receivepack /bin/false 
```

使推送到远程源失败。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-09-09T02:25:04.870

在[1.6.4](http://www.kernel.org/pub/software/scm/git/docs/RelNotes-1.6.4.txt)`remote.name.pushurl`版本中，Git 获得了使用配置设置从一个 URL 远程拉取并推送到另一个 URL 的能力。如果 push-repository 不跟踪 pull-repository，我可以想象奇怪的行为，但我怀疑 Git 只会尝试从 current/tracking/matching 分支快进 push-repository，而不考虑它是什么当它询问同名遥控器时将拉动。

例如，如果你想通过匿名 git 协议拉取，但通过 SSH 推送（也许你需要一个 SecurID 令牌的值或其他东西来进行身份验证）：

```
[remote "myremote"]
    url = git://server/path
    pushurl = user@server:/path 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-09T19:55:08.283

我不确定你今天真的可以在 git 中做到这一点。git-fetch（在 builtin-fetch.c 中）和 git-push（在 builtin-push.c 中）的实现都调用内部函数 remote_get(NULL) 来识别要从/推送到的默认存储库。

一种选择是创建一个别名来指定您所需的存储库。例如：

```
git config --add alias.mypush "push repo-for-push" 
```

然后你可以：

```
git mypush 
```

推送到您想要的仓库。当然，不完全是你想要的。（您也可以考虑使用 --repo 参数进行推送；请参阅[http://kerneltrap.org/mailarchive/git/2008/10/7/3537694](http://kerneltrap.org/mailarchive/git/2008/10/7/3537694)了解最近澄清 --repo 参数的文档更新。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:25:28.333

如果您可以从另一个分支完成所有推送，我认为您可以将该分支配置为拥有自己的单独存储库以推送到：

```
git checkout master
git branch outbound
git remote add destination <some url>
git config branch.outbound.remote destination 
```

我还没有尝试过，你可能需要做更多的工作来创建一个完整的解决方案。如果您必须从主人那里推动，它也可能对您不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-15T21:15:44.807

将“git”命令包装在吃 push 参数的东西中。在我的脑海中，我写了这个：

```
~$ 猫 /usr/local/bin/git
#!/bin/bash

# git 包装器
# 防止推送到存储库

声明 -a 参数
声明味精=''
而 [ $# -gt 0 ]
做
    如果 [ "$1" != '推' ]; 然后
        args=( "${args[@]}" "$1" )
    别的
        msg="不推送"
    菲
   转移
完毕

如果 [ ${#msg} -gt 0 ]; 然后
    回声“$味精”
菲
/usr/bin/git "${args[@]}"  

```

只需确保在“真正的” git 命令之前在路径中包含包装的命令。

# wordpress - 升级 Wordpress 后，出现致命错误“调用未定义函数 require_wp_db()”

> ID：527838
> 
> 赞同：0
> 
> 时间：2009-02-09T11:45:35.183
> 
> 标签：wordpress, upgrade

我按照 Wordpress 中提到的说明进行操作，但我仍然收到错误并转介 Google，我很震惊地看到许多博客都有相同的问题，并且尚未修复，这些博客已在 Google 中编入索引，请尝试搜索“调用未定义函数require_wp_db()" 或在这里找到

[谷歌搜索结果](http://www.google.com/search?hl=en&rls=GGLG,GGLG:2006-38,GGLG:en&q=Call+to+undefined+function+require_wp_db()&start=10&sa=N)

任何建议如何解决？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-13T02:52:57.557

如果您不上传 wp-config.php 或所有其他版本之间已更改的文件，则偶尔会发生这种情况。

1.  [从WP Release Archive](http://wordpress.org/download/release-archive/)下载您尝试升级的 WP 版本的干净副本。

2.  使用您的数据库详细信息、密钥等更新 wp-config.php。

3.  删除服务器上*除*/wp-content 之外的所有文件（希望您已按照他们的建议将所有自定义增强功能降级到 /wp-content/themes 目录 - 否则您将不得不针对每个单独的文件进行比较，除非您已经跟踪您的更改）。

4.  上传除 /wp-content 目录之外的所有干净文件

5.  运行 /wp-admin/upgrade.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T21:32:59.697

这个问题可能在这个网站上放错了地方，但这个错误的原因可能是一般的编程错误。

您的问题可能源于不明确的包含路径。使用 include / require / include_once / etc 时...如果文件路径不是绝对的，则包含的文件可能不是预期的文件。[在这里](https://stackoverflow.com/a/1031506/445295)阅读为什么。要修复不明确的包含指令，请在相对路径前加上`dirname(__FILE__).'/'`.

一个插件甚至你的主题可能是罪魁祸首。像这样的正则表达式可以帮助您找到这种情况：`(include|require)(\_once)?\s*\(?\s['"][^\/]`

### 例子

我有一个用于多站点安装的 Wordpress 主题，其中包含如下文件： `require_once('sites.php');` 因为 sites.php 是同一目录中的文件（并且因为服务器的包含路径包含“.” - 当前目录），所以它可以工作。

但是，由于sites.php 也存在于/wp-admin/network/sites.php 中，因此在尝试访问网络仪表板时，此行会导致以下错误：

> 致命错误：在第 19 行的 /www/OCE/WEBEDITOR2/wp-admin/network/sites.php 中调用未定义函数 _get_list_table()

在尝试其他答案中的说明无济于事后，我通过查找并将此行更改为： `require_once( dirname(__FILE__).'/sites.php' );`

**注意：**在大多数情况下，如果只是为了消除其他可能的问题，应首先使用[Mark 建议的解决方案来尝试在升级 Wordpress 后修复此错误。](https://stackoverflow.com/a/544559/445295)

# ssis - SSIS 包在执行“集成服务评估期已过期”时失败

> ID：527839
> 
> 赞同：1
> 
> 时间：2009-02-09T11:46:21.530
> 
> 标签：ssis, evaluation

我在通过 Microsoft.SqlServer.Dts.Runtime 的 API 执行包时遇到问题。我有 4 个 SQL 服务器，它们可能会在 2 个集群中执行我的包。在每个集群中的被动节点上，执行失败 - 报告的错误是 SSIS 评估期已过期。在活动节点上，它工作正常。我不认为它与集群有关，更多的是 SSIS 本身最初并没有安装在活动节点上。我们后来安装了它。周五，我们在被动节点上卸载并重新安装了 SSIS，确保我们使用了正确的安装介质，但没有任何改变。我们还尝试故障转移并再次运行，结果相同（在现在活动的节点上失败）有趣的是，我可以使用问题节点上的执行包实用程序从 SSMS 运行包。但是从 .net API 调用它不起作用。有任何想法吗？我什么也找不到！下面的 API 调用代码...

谢谢！

本

```
Package pck;

DTSExecResult execResult;

Application app = new Application();

//Load package from SQL Server

pck = app.LoadFromSqlServer(jobParams.SSISPackagePath, jobParams.ServerName, null, null, null);

//Assign values to the package variables

pck.Variables["FlatFileInputPath"].Value = destinationFilePath;

//Execute the package

logger.WriteInfo("Started executing SSIS package...");

execResult = pck.Execute(null, null, new SSISEventsSink(logger), null, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T14:58:52.690

检查您默认使用的 DTEXEC 版本（开始运行：cmd、dtexec）。不久前，当我在其中一台服务器上安装 ServicePacks 时，我遇到了一个错误。然后我安装了几个版本的 dtexec.exe。一个是从 cmd.exe 执行时的默认设置，一个是从 API 运行时的默认设置。在搜索服务器时，您发现了多少个不同的“dtexec.exe”文件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T14:17:12.523

答对了; SSIS 通过查看注册表项来判断它是哪个版本

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\90 
```

我们的服务器加固过程删除了用户组对该密钥的读取权限的继承权限。它没有给出无法读取此密钥的错误，而是认为它是一个评估副本，因为我们在安装 180 天后拥有它，它已经过期。

恢复特定帐户的权限可解决此问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:45:44.313

如果我以本地管理员身份运行该过程，这运行良好！

因此，如果我以本地管理员身份运行，我不会得到“评估期已过” - 奇怪。

# java - Emma 不提供跨项目的代码覆盖率

> ID：527846
> 
> 赞同：2
> 
> 时间：2009-02-09T11:49:10.837
> 
> 标签：java, ant, code-coverage, emma

我想知道你们中是否有任何 EMMA 用户遇到过这个问题。

基本上我有多个项目，每个项目都有不同的 build.xml ANT 脚本，这些脚本都是从一个主 ANT 脚本单独调用的。代码被适当地覆盖，但是当 JUnit 方法调用不同项目中的另一个方法时，EMMA 不会覆盖该外部方法调用。

有没有人遇到过这个问题？任何人都可以提供任何建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T12:02:44.737

您确定将单元测试指向外部方法调用的检测类吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-21T09:32:57.520

Can't help you with Emma. But what you need is a code coverage tool that can combine test coverage data from multiple projects into a coherent whole.

SD's test coverage tools (including the one for Java) can do this out of the box. This allows one to keep lots of "projects" that each make up a significant part of a much larger (meta)project (e.g., Eclipse!), and get a picture of coverage of the metaproject. We've uses this to handle systems with 45,000 compileable Java programs. They can also combine data from multiple test coverage runs on a single project into coherent information for that project.

See [http://www.semanticdesigns.com/Products/TestCoverage/index.html](http://www.semanticdesigns.com/Products/TestCoverage/index.html)

(Hi Kurt).

# javascript - ASP 表单问题

> ID：527849
> 
> 赞同：2
> 
> 时间：2009-02-09T11:51:06.247
> 
> 标签：javascript, forms, validation, asp-classic

我有一个带有复选框和下拉菜单的 asp 表单。如果未选中复选框，则我需要确保未选中或禁用下拉列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T11:54:25.833

您需要在检查更改事件上回发或使用 JavaScript 禁用它

在您的复选框上添加 onchange="checkChanged()"

然后你需要添加javascript函数

```
function checkChanged()
{
    if(Document.GetElementById('mycheckBox').Checked)
        Document.GetElementById('myDropdown').disabled = true;
    else
         Document.GetElementById('myDropdown').disabled = false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T11:58:27.150

您应该制作一个javascript来检查复选框是否被选中，然后启用/禁用下拉菜单？
您可以使用 jQuery 做到这一点，您需要包装一个被称为 arround 的函数：

```
if ($("#checkbox").attr("checked")) {
    $("#dropdown").attr("disabled", true);
}
else
{
    $("#dropdown").attr("disabled", false);
} 
```

# delphi - 消息框的一般问题

> ID：527851
> 
> 赞同：0
> 
> 时间：2009-02-09T11:53:34.260
> 
> 标签：delphi, messagebox

messagebox (handle, '你真的要退出吗？', '你确定吗？', 1);

在这个按钮中有两件事，用户可以做什么。好的并取消。我必须编写什么代码，按钮在“ok”时关闭程序并在按下取消时结束对话框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T12:06:14.960

首先，确保消息框中的按钮与文本匹配。所以如果文本是“你真的要退出吗？” 那么按钮应该是“是”和“否”。

其次，使用适当的常量，以便以后更容易阅读您的代码。那将是：

```
var
  Res: integer;

Res := Application.MessageBox('Do you really want to exit?', 'Are you sure?',
  MB_ICONQUESTION or MB_YESNO); 
```

结果将是 IDYES 或 IDNO。因此，假设调用在主窗体的方法中，您可以像这样使用它：

```
if Res = IDYES then
  Close; 
```

如果你从另一个地方打电话，你也可以打电话

```
if Res = IDYES then
  Application.Terminate; 
```

**编辑：**请同时查看[对话框中的 Vista 用户界面指南，](http://msdn.microsoft.com/en-us/library/aa511273.aspx)其中指出：

> 不必要的确认很烦人

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T12:19:55.850

Delphi 为显示消息框提供了更好的解决方案。我应该使用 MessageDlg 函数。MessageDlg（和MessageBox）函数的返回值表明了用户的选择。因此，当您在 MessageDlg 上放置一个 yes 按钮时，当用户按下 Yes 按钮时，返回值将是 mrYes。所以你的代码会是这样的：

```
var
  ShouldClose: Boolean;
begin
  if MessageDlg('Do you really want to quit?', mtConfirmation, 
      [mbYes, mbNo], 0) = mrYes then
    ShouldClose := True
  else
    ShouldClose := False;
end; 
```

如果用户选择是，您还想关闭您的应用程序。当您有一个普通的 Delphi VCL 应用程序时，您可以实现主窗体的 CloseQuery 事件，当您尝试关闭主窗体（如单击关闭按钮）并具有变量 CanClose 时，将执行 CloseQuery 事件。将 CanClose 设置为 True 意味着 MainForm 可以关闭，将其设置为 false 将阻止您的 mainform 关闭：

```
procedure TForm1.FormCloseQuery(Sender: TObject; var CanClose: Boolean);
begin
  CanClose := MessageDlg('Do you really want to quit?', mtConfirmation, 
    [mbYes, mbNo], 0) = mrYes;
end; 
```

# sql-server - Sql Server 中的嵌套事务

> ID：527855
> 
> 赞同：43
> 
> 时间：2009-02-09T11:54:36.613
> 
> 标签：sql-server, transactions

想象以下场景：

我正在使用 SQL Server 2005。我有一个事务正在调用除其他 SQL 语句之外的一个存储过程，该存储过程内部也有一个事务。外部事务有时会失败，并在存储过程被调用并成功提交后回滚。

我的问题是，存储过程的事务是否也回滚？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-09T12:04:56.633

对于嵌套事务，提交不会将任何更改写入磁盘，除了顶级事务。然而，回滚不管事务的级别如何都有效，所以是的，它将回滚内部事务。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-09T12:56:29.850

绝对是的，顶级事务将拥有所有数据更改，直到它被提交或回滚。

但是，我鼓励您仔细考虑事务模型。您的系统中存在的此类场景越多，您面临的锁定问题就越大。该过程的计算费用也增加了。

值得注意的是，在合理化 SQL 时，我发现事务已经在不需要的地方实现了。我鼓励您（以及任何处理交易的人）仔细考虑为什么您在每种情况下都使用它们，以及如果交易未实施会发生什么。只是我的2c值！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T12:04:02.877

是的，存储过程将被回滚。

这是您的代码的整体流程：

```
BEGIN TRY

    BEGIN TRANSACTION

    EXEC SotredProcedureName

    --Do some other activity

    COMMIT TRANSACTION
END TRY
BEGIN CATCH

    --IF an error occurs then rollback the current transaction, which includes the stored procedure code.
    ROLLBACK TRANSACTION

END CATCH 
```

干杯，约翰

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-04T11:33:43.230

我已经尝试在存储过程中使用 begin tran 并提交，比如 usp_test。
使用以下其他查询执行这些 sp

```
update x set name='xxx'
select * from x---contains 'xxx'
begin tran
update x set name='yyy'
select * from x---contains 'yyy'
exec usp_test
select * from x---contains 'zzz' inside the sp
rollback tran 
```

在 x 表中执行上述查询时，名称必须是“xxx”而不是“zzz”，因为第一次 begin tran 回滚甚至 sp tran 提交。
因此，首先开始传输自己的数据更改。

# visual-studio-2008 - Visual Studio 2008 (C# @ Verbatim) 字体和颜色选项

> ID：527858
> 
> 赞同：1
> 
> 时间：2009-02-09T11:55:28.280
> 
> 标签：visual-studio-2008, fonts, colors, settings

我刚刚在 6 分钟内阅读**[了 secretGeek关于](https://stackoverflow.com/users/241/secretgeek)****[成为更好程序员的 8 种方法](http://www.secretgeek.net/6min_program.asp "在 6 分钟内成为更好的程序员的 8 种方法")**的有趣帖子，并且非常喜欢使**硬编码字符串看起来难看**的技巧。

当我尝试在我的 Visual Studio 2008 Professional 副本中更改**字体和颜色**设置以执行此操作时，我发现**字符串 (C# @ Verbatim)**选项不在**显示项目**列表中。该选项在 Visual C# Express 2008*中*列出。

有谁知道如何解决这一问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T13:39:03.180

好的，经过一些实验，这对我有用。

SysInternals [regmon](http://technet.microsoft.com/en-us/sysinternals/bb896652.aspx "SysInternals regmon 的下载站点")显示 VS2008 Pro 的**字体和颜色**选项存储在注册表项中：

```
HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0\FontAndColors 
```

删除它并重新启动 Visual Studio 会导致密钥被重建并恢复**String (C# @ Verbatim)**选项。

VS2005 Pro 密钥中也缺少该选项，所以也许这就是它在 2008 年从未出现过的原因。

青柠上的洋红色是不是太自虐了？

# asp.net - 如何在 ASP.NET 中使用 Javascript 更新 Multiview 的索引？

> ID：527859
> 
> 赞同：0
> 
> 时间：2009-02-09T11:55:47.717
> 
> 标签：asp.net, asp.net-2.0

我正在尝试创建一个包含 3 个视图的 ASP:Multiview。

我想使用 Java 脚本更改索引值，因为如果我制作任何 ASP:Button 它将刷新我的页面，所以我不想刷新我的页面并更改 Multiview 的索引值。谢谢但我想要它在javascript中，因为当我点击它时它会改变，我的按钮是输入类型=按钮所以请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T12:14:35.737

通常，当活动视图索引更改时，还应该显示一个新面板。因此，您可能可以使用 AJAX 实现相同的目标。使用 AJAX，您的整个页面不会刷新。因为，您使用的是 ASP.NET 2.0。您可以使用 AJAX 工具包。

[以下](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/)是您可以使用 AJAX 实现的目标的列表。

# c# - 在 C# 中计算比率

> ID：527860
> 
> 赞同：18
> 
> 时间：2009-02-09T11:57:01.567
> 
> 标签：c#, string-formatting

我认为这很简单，但搜索谷歌似乎没有帮助。

我基本上是在尝试编写一个函数，当提供两个整数（例如 800 和 600）时，它将以字符串形式返回比率（例如 4:3）。

```
string GetRatio(Int A, Int B) {
    // Code I'm looking for
    return Ratio;
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-09T12:01:27.110

您可以通过将分子和分母除以它们的[GCD](http://en.wikipedia.org/wiki/Greatest_common_divisor)来简化分数：

```
var gcd = GCD(A, B);
return string.Format("{0}:{1}", A / gcd, B / gcd) 
```

还有一个非常基本的函数，用于计算 GCD，使用[欧几里得算法](http://en.wikipedia.org/wiki/Euclidean_algorithm)：

```
static int GCD(int a, int b) {
    return b == 0 ? Math.Abs(a) : GCD(b, a % b);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T12:01:08.437

您是否基本上试图获得两个数字的最大公分母 - GCD，然后将它们除以得到您的字符串？

即：800：600；最大公分母 = 200 因此 4:3。

这将能够处理所有整数。很抱歉没有发送代码，但我认为从这里开始应该很简单。

```
public int GCD(int a, int b)

{
    while (a != 0 && b != 0)
    {
         if (a > b)
            a %= b;
         else
            b %= a;
    }
     if (a == 0)
         return b;
     else
         return a;
}

// Using Konrad's code: 

var gcd = GCD(A, B);
return string.Format("{0}:{1}", A / gcd, B / gcd) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T12:23:03.657

在过去玩过这样的事情后，我将补充一点，处理带符号的值会变得很难看。让我建议处理有符号值的最简单方法是将 Konrad 的方法应用于原始数字的*绝对值*，然后如果原始值具有不同的符号，则在结果字符串前面加上一个“-”。

使用这种方法，-100 和 -35 的最大公约数是 5，比率为 20:7。如果原始输入是（-100 和 35）或（100 和 -35）对中的任何一个，您仍然会得到 5 的 GCD，初始结果为 20:7，但最终答案将是 - 20:7（即无论哪个输入为负的标准化形式，就像 -6/2 和 6/-2 = -3）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T12:10:15.390

其他评论员对整数给出了很好的解决方案；但是，如果您真的必须处理浮点值，则需要其他东西。一般来说，两个实数不会有一个可以漂亮打印的干净比率；你想要的是最接近的有理近似值。可能最好的方法*就是*计算商的连分数展开；[Mark Dominus在他的博客上](http://blog.plover.com/math/age-fraction.html)对这些人做了很好的介绍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-26T13:20:24.760

使用以下 2 个函数，您将能够在不使用除法运算的情况下获得两个数字的比率。

```
static int GCD(int p, int q)//find greatest common divisor
{
    if (q == 0)
    {
        return p;
    }

    int r = p % q;

    return GCD(q, r);
}
static string  FindRatio(int num1, int num2)
{

    string oran = "";
    int gcd;
    int quotient = 0;
    while (num1 >= num2)
    {
        num1 = num1 - num2;
        quotient++;
    }

    gcd = GCD(num1, num2);

    //without using division finding ration of num1 i1
    int i1 = 1;
    while (gcd*i1 != num1)
    {
        i1++;
    }
    //without using division finding ration of num1 i2
    int i2 = 1;
    while (gcd * i2 != num2)
    {
        i2++;
    }

    oran = string.Concat(quotient, " ", i1,"/",i2);
    return oran;
} 
```

输出如下：
coff num1 / num2

# css - CSS的值计算

> ID：527861
> 
> 赞同：20
> 
> 时间：2009-02-09T11:57:07.900
> 
> 标签：css

作为一名 Web 开发人员，您经常会遇到一些问题，如果有类似价值计算之类的东西，这些问题可能会很容易解决。

我经常想知道为什么不能在 CSS 中做这样的事情：

```
line-height: (height / 2)px; 
```

例如，当您想要垂直对齐元素时，这将解决您遇到的一些问题。现在很难使用 CSS 垂直对齐元素，并且会产生相当多的开销。

如果您知道元素的固定高度，则不需要它。但是一旦高度发生变化（更长的文本等），您就会知道元素的总高度。

使用额外的JS很容易解决这个问题，但这对于普通网站来说是不可能的。那么为什么我们不在 CSS 中添加引用当前值并使用它们的能力呢？

如果您研究这样的问题，您就会知道我的意思是什么：

*   [你能在不使用表格的情况下做这个 html 布局吗](https://stackoverflow.com/questions/522928/can-you-do-this-html-layout-without-using-tables)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T14:35:49.330

> 为什么不能在 CSS 中做这样的事情： line-height: (height / 2)px;

因为这样可以很容易地引入逻辑循环。

在这个例子中，除非你显式设置'height'（在这种情况下，显式设置'line-height'也很容易），元素的高度取决于其内容文本的行高，这取决于在高度...

IE 试图用 'expression()' 语法来提供它，但它并没有真正起作用。IE 的方法是让它一步一步地重新计算，所以如果你有一个不确定的表达式，它可以随着表达式的值的变化不断地重绘你的元素。有关如何出错的示例，请尝试：

```
<div id="q" style="background: yellow; line-height: expression(document.getElementById('q').offsetHeight/2+'px');">
    Lorem ipsum fiddly boing bum dfg dsfgasdf fg asdfas.
    Lorem ipsum fiddly boing bum dfg dsfgasdf fg asdfas.
    Lorem ipsum fiddly boing bum dfg dsfgasdf fg asdfas.
</div> 
```

当您调整浏览器窗口的大小时，行高以及 offsetHeight 会发生变化，从而导致布局不一致。在一定大小时，高度会爆炸。

有一种情况允许只包含常量的简单表达式，例如：

```
line-height: (1em+4px); 
```

但是任何涉及动态计算属性的东西都注定要失败，就像 IE 臭名昭著的“表达式（）”语法一样。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-03-26T22:21:58.373

CSS3.1 定义了 calc() - 它完全符合您的要求。[http://www.w3.org/TR/css3-values/#calc](http://www.w3.org/TR/css3-values/#calc)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T13:00:48.857

我会说这是因为 CSS 只是定义了浏览器如何显示某些内容。没有信息流回样式表，或者换句话说：CSS 不是动态的。

如果您知道元素的高度并希望在每次显示页面时更改它，您可以使用 PHP 或其他语言生成样式表。然后你也知道什么是高度的一半并且也可以设置它。

如果您不知道高度，那将是动态变化。浏览器必须首先渲染页面，然后确定元素的高度并将其发送回 CSS。在呈现的页面中计算和更改行高。但也许因此元素的整体高度也会发生变化。现在浏览器不得不再次回到 CSS 等等......

只是行不通。CSS 用于静态定义页面的外观。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-07-26T04:33:34.777

您可能对编译为 CSS 的语言感兴趣，例如[SASS](http://sass-lang.com/)、[LESS](http://lesscss.org/)或[Stylus](http://learnboost.github.com/stylus/)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-04T15:44:46.250

这方面已经有了发展。仍然没有 100% 准备好，但它很有趣。我希望这对将来访问此页面的任何人有所帮助！

[https://developer.mozilla.org/en-US/docs/CSS/calc](https://developer.mozilla.org/en-US/docs/CSS/calc)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T13:01:02.927

为什么它“对于普通网站来说是不可能的”？jQuery 可以很容易地完成很多这样的事情......

IE 确实支持样式计算，但不建议这样做，表现得像狗一样，并且与其他所有内容完全不兼容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-01T15:10:09.130

您可以使用**SASS**和**LESS**。如果您对它们一无所知，请[谷歌](http://www.Google.Com)它们：

# javascript - 如何使用 JavaScript 在 IE6 中检索 iframe 顶部位置？

> ID：527862
> 
> 赞同：1
> 
> 时间：2009-02-09T11:57:21.393
> 
> 标签：javascript, iframe, internet-explorer-6, position

有谁知道如何使用 JavaScript 在 IE6 页面中检索 iframe 顶部位置？

以下代码适用于 IE7：window.frames(0).screenTop

但是 IE6 中的相同代码检索到错误的值（太高了）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T14:46:49.880

> 有谁知道如何使用 JavaScript 在 IE6 页面中检索 iframe 顶部位置？

与任何其他元素相同的方式，使用 offsetTop（并从任何 offsetParent 祖先添加 offsetTop）。它是一个 <iframe> 元素并不重要。

```
var el= document.getElementsByTagName('iframe')[0];
var top= 0;
while (el && el.nodeType==1 && el!==document.documentElement) {
    top+= el.offsetTop;
    el= el.offsetParent;
} 
```

> 以下代码适用于 IE7：window.frames(0).screenTop

我怀疑这行得通。screenTop 是错误的，它是屏幕上的坐标不在页面上。无论如何，它必须是方括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T14:10:33.413

您可能希望使用`offsetTop`. 当然，您必须循环，添加`offsetParent`'`offsetTop`直到`offsetParent`为空。

[jQuery](http://docs.jquery.com/CSS/offset)和[Prototype 都可](http://prototypejs.org/api/element/positionedoffset)以为你做这件事。

事实上，这是 Prototype 的代码：

```
 positionedOffset: function(element) {
    var valueT = 0, valueL = 0;
    do {
      valueT += element.offsetTop  || 0;
      valueL += element.offsetLeft || 0;
      element = element.offsetParent;
      if (element) {
        if (element.tagName.toUpperCase() == 'BODY') break;
        var p = Element.getStyle(element, 'position');
        if (p !== 'static') break;
      }
    } while (element);
    return Element._returnOffset(valueL, valueT);
  }
  //Element.getStyle returns the style or its default if not defined.
  //Element._returnOffset returns the left and top as a single object 
```

# php - 寻找开源用户管理和计费PHP网站代码

> ID：527863
> 
> 赞同：1
> 
> 时间：2009-02-09T11:57:45.153
> 
> 标签：php, open-source, user-management, login-script

我需要创建一个网站，用户可以在其中登录、查看某些报告、自定义、支付（通过贝宝和信用卡）等。其中 80% 类似于许多网站（包括 stackoverflow）

你知道我可以使用一个用户管理代码 (PHP) 作为起点来节省时间吗？

Drupal 似乎能够提供我想要的东西，但我想要更轻的东西，我可以很容易地改变和皮肤。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T12:08:45.610

Drupal 实际上并没有那么重，并且有现成的模块来做你想做的事情（以及更多）。

或者，您可以在 CakePHP、CodeIgniter、Zend 或类似框架之上构建自己的解决方案，其中包含大量现成的东西，因此您无需完全重新发明轮子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-27T17:57:46.187

我发现了这个：http: [//jplpinto.com/apis/test/filemanager/homepage/homepage.php](http://jplpinto.com/apis/test/filemanager/homepage/homepage.php) 您可以将它与一些用户脚本集成（例如[http://www.html-form-guide.com/php- form/php-login-form.html](http://www.html-form-guide.com/php-form/php-login-form.html)）并对其进行编辑，以便您对其进行计费。

# javascript - Why is ContentEditable removing “ID” from div

> ID：527866
> 
> 赞同：1
> 
> 时间：2009-02-09T11:59:37.380
> 
> 标签：javascript, html, internet-explorer, internet-explorer-6

I am having problems with getting a HTML editor working. We are using “contentEditable” to implement it, however when any paragraph formatting option is done without contents selected, IE removes the ID from one of the divs in the page.

The problem repeats for me with the HTML,

1.  just save it to a file,
2.  then open it in IE
3.  enable jscript when asked
4.  push the button
5.  check you get two message boxes
    2.  first one says “MainContents = object”</li>
    3.  second one says “MainContents = NULL”</li>

I am using IE 6.0.2900.5512 with XP SP3

**So does this repeat for you?**

**What is going on?**

```
<html>
<head>

</head>

<body id="BODY">
<div contentEditable="true" id="EDITBOX"> 
</div>

<div id="MAINCONTENTS" unselectable="on">
<button title="Ordered List" unselectable="on"
    onclick='alert("MainContents = " + document.getElementById("MAINCONTENTS")); 
    document.execCommand("InsertOrderedList");
    alert("MainContents = " + document.getElementById("MAINCONTENTS"));
                     '>
    Push Me
</button>
</div>

</body>
</html>

<script type="text/javascript">
    document.getElementById("EDITBOX").focus();
</script> 
```

* * *

**Background** I work for an ISV that sell software to corporations, at present all our customers use IE and there is no market depend to support other browsers. I have been told to implement an HTML editor using contentEditable. All the formatting options are based on document.execCommand(), e.g. document.execCommand(“bold”);

Due to licensing restrictions (LGPL is not liked) and/or cost it is very hard to get approval to use a 3rd party HTML editor. It took us a log time just to be allowed to use jquery.

I have the editor working apart from the case of paragraph formatting commands when the user does not have any items selected. The HTML I posted is a small bit of HTML I wrote to reproduce the problem I am having.

see also [http://www.maconstateit.net/tutorials/JSDHTML/JSDHTML12/jsdhtml12-02.htm](http://www.maconstateit.net/tutorials/JSDHTML/JSDHTML12/jsdhtml12-02.htm) and [Risk of using contentEditable in IE](https://stackoverflow.com/questions/491790/risk-of-using-contenteditable-in-ie)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T12:34:10.933

The first issue, as [Gary](https://stackoverflow.com/questions/527866/why-is-contenteditable-removing-id-from-div/527925#527925) pointed out is the inconsistency in case although it won't affect IE as explorer getElementById goes against W3 specs and is not case sensitive.

Changing the exec command to be: `document.execCommand("insertOrderedList",true,"");` seems to get be objects for both alerts and also makes the code work a bit better in firefox (which wasn't working at all).

I guess my first question would be, do you really need to do this using execCommand? I know you're probably trying to do more than just insert an ordered list, but I'd hazard a guess that implementing what you're trying to do with the DOM would likely be a cleaner way to do it.

I'm adding an edit to this reply, because the more I play with your test code the more inconsistent my results are becoming. I get different results the first time I run it in different browsers and I get different results after running it a few times and then restarting the browser. To be perfectly honest this is exactly the kind of stuff you desperately want to avoid when doing javascript development so I'll reiterate my initial question. Do you *really* need to use this technique to achieve your goals. There are better and easier ways to do insertion into the DOM.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T13:14:45.607

Try this;

```
<html>
<head>
<title></title>
<script type="text/javascript">
function addToList(text) {
        var list = document.getElementById('list');
        list.innerHTML += '<li>'+text+'</li>';
}
</script>
</head>
<body>

<div contentEditable="true" id="editBox" style="width: 300px; height: 100px; border:1px solid #ff0000;"> </div>
<ol id="list"></ol>

<button title="Ordered List" unselectable="on" onclick="addToList(document.getElementById('editBox').innerHTML)">Push me</button>

</body>
</html> 
```

The above should give reliable results in most browsers. I've tested the above in FF3 and IE6.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T14:07:42.330

Thanks for everyone’s help, anyone thinking of using “contentEditable” should read the other answers to my question and then think **very hard** before using “contentEditable”.

I have found that if I use an iframe e.g.

```
<iframe id=EditorIFrame >
</iframe> 
```

And create the div that is editable in the iframe eg

```
theEditorIFrame = document.getElementById('EditorIFrame');  
theEditorDoc = theEditorIFrame.contentWindow.document;  
theEditorDoc.body.innerHTML = '<body><div contentEditable="true" id="EDITBOX"></div></body>';
theEditorDiv = theEditorDoc.getElementById("EDITBOX") 
theEditorDiv.focus();

theEditorDoc.execCommand("InsertOrderedList") 
```

It seems to all work for me, at present until I get the next nasty surprise from “contentEditable” and “execCommand”</p>

*Ps How do I get the first line of my code to lineup with the rest?*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T12:20:23.400

IDs are case sensitive. Try MAINCONTENTS instead of MainContents.

# c++ - C/C++ 优化数据结构、数组数组或只是数组

> ID：527887
> 
> 赞同：4
> 
> 时间：2009-02-09T12:06:28.487
> 
> 标签：c++, c, arrays

使用使用 16 字节 4v4 单字节矩阵的程序：

```
unsigned char matrix[4][4]; 
```

和几个 256bytes 16v16 一字节矩阵：

```
unsigned char bigMatrix[16][16]; 
```

很多时候，由于数据操作，我被迫在程序中循环列，导致缓存未命中。

如果我改用数组，性能会提高吗，即

```
unsigned char matrix[16];
unsigned char matrix[256]; 
```

并通过使用一些变量来检索元素来访问元素，即

```
matrix[variableA*variableB + i]; 
```

每次我想访问一个元素时，都需要重新计算 variableA*variableB+i 。

我只想要速度优化，内存没问题。这是否会有所帮助，例如给性能带来一些损失或损失，或者差异太小以至于无法在意？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-09T12:09:33.800

没有什么不同的。在任何一种情况下，数据都以完全相同的方式布局，并且也以相同的方式访问。即使它没有生成完全相同的程序集，我也会感到惊讶。

但是，对于 256 字节的表，在任何情况下都不太可能出现缓存未命中。CPU 的 L1 缓存通常在 32 到 128KB 之间，所以我怀疑在任何情况下您都会遇到很多缓存未命中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-09T12:25:16.040

jalf 基本上是对的。L1 缓存被分成块，块的大小取决于处理器，但在 32 字节左右。因此，如果您一次遍历一个字节的内存，则每 32 个字节（或任何块大小）都会出现一次缓存未命中。现在，英特尔芯片在这里非常聪明，可以检测顺序读取并预取数据，从而减少缓存未命中的影响。

4x4 矩阵很可能驻留在单个 L1 块（或高速缓存行）中，因此按行或按列访问它几乎没有区别。当然，您不想将矩阵拆分到两条高速缓存行，因此对齐良好的内存很重要。

但是，16x16 矩阵不适合缓存行。因此，如果您跳过数组处理列，您将获得大量缓存未命中。正如 jalf 所说，索引的计算几乎没有什么区别，因为 CPU 和内存之间的比率很高（即，您可以为每次缓存未命中做大量 CPU 工作）。

现在，如果您主要以面向列的方式处理矩阵，那么您最好的选择是转置所有矩阵（将行与列交换），因此您的内存访问将更加连续，并且缓存未命中的数量将减少并且CPU 将能够更好地预取数据。因此，不要像这样组织矩阵：

```
 0   1   2 .... 15
 16  17  18 .... 31
....
240 241 242 .... 255 
```

其中数字是从矩阵开始的内存偏移量，组织如下：

```
 0 16 32 ... 240
 1 17 33 ... 241
 ...
15 31 47 ... 255 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T12:18:58.893

虽然编译后的代码会表现得同样快，但存在一些设计问题：索引代码的重用可以最大化。

恕我直言，最好的方法是将其包装在一个知道如何以最快的方式循环其元素的容器中。他们为此得到了一个名称：“内部迭代器”，如 GoF 设计模式“迭代器”模式中所述。

一个简单的例子：

```
 template< int N >
 struct CNxN { 
     typedef int t_row[N];
     typedef t_row t_matrix[N];
     t_matrix m_Contents; 

     template< typename Functor >
     void each( Functor & f ) {
         for( int col = 0; col != N; ++col )
             for( int row = 0; row != N; ++row )
                 f( m_Contents[row][col] );
     }
 };

 // client code
 CNxN<3> matrix = { { {1,1,1},{1,1,1},{1,1,1} } };

 struct sum { 
      long result; 
      sum():result(0){} 
      void operator()( int i ){ result +=i; } 
 };
 matrix.each( sum );
 assert(sum.result==0); 
 assert(has_performed_in_the_fastest_possible_way);//;) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T12:16:57.183

您说`variableA*variableB+i`每次访问元素时都需要重新计算，即使在使用多维数组时也会发生这种情况。唯一的区别是，在多维数组中，编译器会发出此代码，因此您看不到它，而在一维数组中，您会看到源代码中的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T12:27:33.303

当我在学校的时候，我的一位 CS 老师坚持认为，如果你为单维制作阵列，它会更快。那天我很生气...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T12:18:15.947

如果您对数组进行顺序访问，大线性数组可能会稍微快一些，因为您在每个索引处保存了乘法运算。如果您按列循环，那么您将按顺序访问；至少在 [row][col] 表示法中，这是我曾经与之交谈过的每个人的“标准”。

我怀疑您的 256 元素数组会导致现代硬件上的缓存未命中，但我愿意被证明是错误的。cachegrind 告诉你什么？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T12:28:23.783

> 很多时候，由于数据操作，我被迫按列循环 [...]

你不能同时拥有它：如果矩阵“足够大”，那么按行或按列循环都会导致缓存未命中（请参阅[Skizz 的答案](https://stackoverflow.com/questions/527887/c-c-optimize-data-structures-array-or-arrays-or-just-array/527937#527937)）。优化执行更频繁的循环类型。

如果内存消耗不是问题，您还可以考虑保存矩阵及其转置。

# mootools - 使用 mootools 进行简单的 Div Opacity Fade on Focus

> ID：527890
> 
> 赞同：2
> 
> 时间：2009-02-09T12:07:04.897
> 
> 标签：mootools, mouseover, opacity, fade

我在一个包含简单 HTML 和图像的页面中有几个 div。每个 div 都有唯一的 id。

我希望这样当页面加载 div 的内容时说 60% 但在鼠标悬停时淡入为 100%。在 mouseout 时，他们会回到 60%。

该站点是在**Joomla 1.5.x**中构建的，因此已经加载了**mootools 1.11**库。我在网上寻找示例代码，并找到了很多关于使用 jQuery 淡化图像不透明度的参考资料，但对于 mootools 来说并没有那么多。

任何指针将不胜感激:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T12:15:26.000

您也许可以将图像包装成一个 div 并使用这样的东西来淡化？

```
Fx.Style("div1", "opacity").start(1.0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T15:54:46.970

找到了解决方案，很好。它适用于 mootools 1.2.1。我已经调整了代码以淡化 div 而不是 img。

我把这个放在我的脑海里：

```
<script type="text/javascript"  src="mootools-1.2.1-core-yc.js"></script>  
<script type="text/javascript">

    var fade_in = 1;
    var fade_out = 0.5;

</script>
</head>
<body onload="$$('div.box_panel').fade(0.5);"> 
```

然后在我的 div 上。

```
<div id="box1" class="box_panel" onmouseover="this.fade(fade_in);" onmouseout="this.fade(fade_out);">
        <h2>Box One</h2>
        <p>This is a content box and some sample content to pad it out.</p>
</div> 
```

现在的问题是我不确定如何在 1.11 中获得同样的效果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-13T11:34:19.903

为此请使用 CSS3 过渡。这要简单得多。见（[http://www.w3schools.com/css/css3_transitions.asp](http://www.w3schools.com/css/css3_transitions.asp)）

```
div.box_panel {
    opacity: 0.6;
    filter: alpha(opacity=60);
    -webkit-transition: opacity .5s linear;
    -moz-transition: opacity .5s linear;
    -ms-transition: opacity .5s linear;
    -o-transition: opacity .5s linear;
    transition: opacity .5s linear;
}

div.box_panel:hover {
    opacity: 1;
    filter: alpha(opacity=100);
} 
```

# c# - C# Xml-使用 IXmlSerializable 序列化派生类

> ID：527902
> 
> 赞同：7
> 
> 时间：2009-02-09T12:11:42.937
> 
> 标签：c#, xml, serialization

我有一个与 XML 序列化兼容的基类和一个实现 IXmlSerializable 的派生类。

在此示例中，基类确实实现了 IXmlSerializable：

```
 using System.Diagnostics;
using System.Text;
using System.Xml;
using System.Xml.Schema;
using System.Xml.Serialization;

namespace XmlSerializationDerived
{
    public class Foo
    {
        public int fooProp;

        public XmlSchema GetSchema()
        {
            return null;
        }

        public void ReadXml(XmlReader reader)
        {
            fooProp = int.Parse (reader.ReadElementString ("fooProp"));
        }

        public void WriteXml(XmlWriter writer)
        {
            writer.WriteElementString ("fooProp", fooProp.ToString ());
        }
    }

    public class Bar : Foo, IXmlSerializable
    {
        public new void ReadXml(XmlReader reader)
        {
            base.ReadXml (reader);
        }

        public new void WriteXml(XmlWriter writer)
        {
            base.WriteXml (writer);
        }

        static void Main(string[] args)
        {
            StringBuilder sb = new StringBuilder ();
            XmlWriter writer = XmlWriter.Create (sb);

            Bar bar = new Bar ();
            bar.fooProp = 42;

            XmlSerializer serializer = new XmlSerializer (typeof (Bar));
            serializer.Serialize (writer, bar);

            Debug.WriteLine (sb.ToString ());
        }
    }
} 
```

这会产生以下输出：

```
<?xml version="1.0" encoding="utf-16"?><Bar><fooProp>42</fooProp></Bar> 
```

但是，我想使用一个**不**实现 IXmlSerializable 的基类。这可以防止使用`base.Read/WriteXml`. 结果将是：

```
<?xml version="1.0" encoding="utf-16"?><Bar /> 
```

有没有办法仍然得到想要的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T12:56:33.587

改进mtlung的答案，你为什么不使用XmlSerializer？您可以使用属性调整您的类，以便可以按照您想要的方式对其进行序列化，这非常简单。

```
using System.Xml.Serialization;

...

[XmlRoot("someclass")]
public class SomeClass
{
    [XmlAttribute("p01")]
    public int MyProperty01
    {
        get { ... }
    }

    [XmlArray("sometypes")]
    public SomeType[] MyProperty02
    {
        get { ... }
    }

    [XmlText]
    public int MyProperty03
    {
        get { ... }
    }

    public SomeClass()
    {
    }
} 
```

然后，序列化和反序列化将非常简单：

```
void Save(SomeClass obj)
{
    XmlSerializer xs = new XmlSerializer(typeof(SomeClass));
    using (FileStream fs = new FileStream("c:\\test.xml", ...))
    {
        xs.Serialize(fs, obj);
    }
}

void Load(out SomeClass obj)
{
    XmlSerializer xs = new XmlSerializer(typeof(SomeClass));
    using (FileStream fs = new FileStream("c:\\test.xml", ...))
    {
        obj = xs.Deserialize(fs);
    }
} 
```

生成的 XML 将是这样的：

```
<someclass p01="...">
  <sometype>
    <!-- SomeType serialized objects as child elements -->
  </sometype>
  # value of "MyProperty03" as text #
</someclass> 
```

这种方法更适用于“POCO”类，而且简单干净。您甚至不必使用属性，它们可以帮助您自定义序列化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T12:18:14.417

“这会阻止使用 base.Read/WriteXml。”

通常，如果实现了基类`IXmlSerializable`，您可以将其设为`virtual`方法以便使用具体版本。通常，您还会使用显式实现（而不是公共属性）——也许使用一些`protected virtual`方法来实现细节（尽管跟踪不同类中读取器/写入器的位置将是一场噩梦）。

AFAIK，当您添加*派生*位时，无法重复使用`XmlSerializer`写入*基本*位。是全有或全无。*`IXmlSerializable`*

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T09:18:11.653

为什么不在你的读/写函数中简单地使用 XmlSerializer 呢？

```
XmlSerializer s = new XmlSerializer(typeof(Foo));
s.Serialize(writer, base); 
```

# php - 在 JavaScript 和 PHP 中使用欧元符号

> ID：527910
> 
> 赞同：0
> 
> 时间：2009-02-09T12:14:53.427
> 
> 标签：php, javascript, currency

我在 JavaScript中使用[欧元的价格：](http://en.wikipedia.org/wiki/Euro)

```
var currency = '\u20AC';
Total Sum = Sum in Euro 
```

当我尝试在 PHP 邮件中使用时，欧元符号的显示方式有所不同。我使用了以下命令：

```
$mail_body_reply=Sum from Javascript
mail($email, $subject_reply, $mail_body_reply, $header_reply); 
```

使它在 PHP 和 JavaScript 中的行为相同的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T12:19:58.610

您必须向邮件标头添加编码，如[函数 mail() 文档的注释中](http://www.php.net/manual/en/book.mail.php#86537)所述。

正确的编码可能是[ISO/IEC 8859-15](http://en.wikipedia.org/wiki/ISO/IEC_8859-15)。

# apache-flex - 弹性加载策略文件 crossdomain.xml

> ID：527911
> 
> 赞同：2
> 
> 时间：2009-02-09T12:15:25.970
> 
> 标签：apache-flex, crossdomain.xml

我想将我的 crossdomain.xml 文件放在与根目录不同的位置，因为它只会产生很多依赖问题。

我如何告诉 flex 从我的 crossdomain.xml 文件中查找根目录以外的其他位置？我是否将 loadPolicy 代码添加到我的 flex 应用程序的 init 方法中？

有人有这方面的好样品吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T12:23:15.030

从[文档](http://livedocs.adobe.com/flex/3/langref/flash/system/Security.html#loadPolicyFile())：

> **`loadPolicyFile()`方法**
> 
> 在 url 参数指定的位置查找策略文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T12:25:03.247

还有另一种选择。如果未指定跨域策略文件，则 Flex 将发送 "" 到套接字服务器。然后服务器可以将跨域策略文件的内容写入套接字。Flex 将关闭连接，如果一切正常，则重新连接。

这种方法的缺点是，从最初在 Flex 端建立连接到获得完整的工作连接大约需要 1-2 秒（`flash.events.Event.CONNECT`不过，一旦连接完全建立，就会发送事件）。如果这不可接受，则将跨域策略文件放在根目录中可能是您​​的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-01T10:51:26.063

Security.allowDomain("*"); Security.loadPolicyFile(" [https://play2beatme.com/crossdomain.xml](https://play2beatme.com/crossdomain.xml) "); 在您的 init() 方法中使用此代码...我希望这会对您有所帮助

# python - 如何正确组织包/模块依赖树？

> ID：527919
> 
> 赞同：3
> 
> 时间：2009-02-09T12:19:02.433
> 
> 标签：python

早上好，

我目前正在编写一个 python 库。目前，模块和类以无组织的方式部署，没有合理的设计。随着我接近更正式的版本，我想重新组织类和模块，以便它们具有更好的整体设计。我画了一个导入依赖关系图，并计划按层级聚合类。另外，我正在考虑对类进行一些修改，以减少这些依赖关系。

对于一个潜在复杂且正在开发中的 python 库的良好整体设计，你的策略是什么？你有什么有趣的建议吗？

谢谢

**更新：**

我确实在寻找经验法则。例如，假设发生这种情况（为清楚起见删除了**init .py）**

```
foo/bar/a.py
foo/bar/b.py
foo/hello/c.py
foo/hello/d.py 
```

现在，如果你碰巧有 d.py 导入 bar.b 和 a.py 导入 hello.c，我会认为这是一个糟糕的设置。另一种情况是

```
foo/bar/a.py
foo/bar/baz/b.py
foo/bar/baz/c.py 
```

假设 a.py 和 b.py 都导入 c。你有三个解决方案：1）b 导入 c，a 导入 baz.c 2）你在 foo/bar 中移动 c。a.py 导入 c，b.py 导入 .c 3) 你将 c 移到其他地方（比如 foo/cpackage/c.py），然后 a 和 b 都导入 cpackage.c

我倾向于选择 3)，但是如果 c.py 作为独立模块没有意义，例如因为你想将它“私有”到 bar 包中，我会优先选择 1)。

类似的案例还有很多。我的经验法则是至少减少依赖和交叉的数量，以防止高度分支、高度交织的设置，但我可能是错的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T12:34:30.807

**“我画了一个导入依赖关系图，我打算按层级聚合类。”**

Python 必须像英语（或任何其他自然语言）一样阅读。

导入是应该具有真正意义的一流语句。按“层级”（无论是什么）组织事物应该是清晰、有意义和明显的。

不要将任意的类技术组合成模块，将模块组合成包。

使模块和包明显且合乎逻辑，以便导入列表明显、简单且合乎逻辑。

**“另外，我正在考虑对这些类进行一些修改，以减少这些依赖关系。”**

减少依赖听起来是技术性的和武断的。可能不是，但听起来是这样。没有实际的例子，这是不可能的。

你的目标是清晰。

此外，模块和包是独立的重用单元。（不是类；一个类，但它本身通常不能重用。）您的依赖关系树应该反映这一点。您的目标是可以整齐干净地导入您的应用程序的模块。

如果您有许多密切相关的模块（或替代实现），则可以使用包，但要谨慎使用。Python 库相对扁平；这里面有一些智慧。

* * *

**编辑**

层之间的单向依赖是一个基本特征。这更多是关于正确的软件设计，而不是关于 Python。您应该 (1) 分层设计，(2) 设计使层之间的依赖关系非常严格，然后 (3) 在 Python 中实现它。

这些包可能不一定完全适合您的分层。这些包在物理上可能是一个平面目录列表，其依赖关系仅通过`import`语句表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T12:27:56.127

这个问题非常模糊。

您可以通过从库的其余部分中不导入任何内容的基本/核心内容以及从此处导入的具体实现来实现这一点。除了“在导入时没有两个模块相互导入”之外，你应该没问题。

模块1.py：

```
import module2 
```

模块2.py：

```
import module1 
```

这行不通！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T14:30:34.460

这取决于项目，对吧？例如，如果您使用的是模型-视图-控制器设计，那么您的包的结构将使得 3 组代码独立。

如果您需要一些想法，请打开您的站点包目录，并查看这些模块中的一些代码以了解它们是如何设置的。

不了解模块就没有正确的方法；正如阿里所说，这是一个模糊的问题。你真的只需要分析你面前的东西，并找出可能更好的方法。

# c# - 如何制作一个点击和透视的“始终在顶部”窗口

> ID：527933
> 
> 赞同：3
> 
> 时间：2009-02-09T12:23:35.840
> 
> 标签：c#, delphi, always-on-top

我想显示一个带有一些信息的半透明始终在顶部的窗口，但我不希望这个窗口接受输入或接收焦点。所有鼠标单击都应转到底层窗口。

我记得几年前在一个外壳替换应用程序中看到过这个，但我不记得女巫了。

任何想法如何用delphi或c#实现这种效果？

更新：

我不能完全得到建议的解决方案来使用 delphi。为 NCHITTEST 消息返回 HTTRANSPARENT 将阻止所有鼠标消息到达表单，但它希望将其传递到 z 顺序中的下一个窗口。这种方法是跨进程工作，还是只对特定窗口的子元素起作用？

但是，如果我设置了 ExStyle 标志 WS_EX_TRANSPARENT，所有的鼠标点击都将进入下一个窗口，但我根本不会收到 NCHITTEST 消息，并且无法控制窗口应该点击的位置。 ..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T12:27:26.033

[这个 StackOverflow 线程](https://stackoverflow.com/questions/112224/click-through-transparency-for-visual-c-window-forms)应该有望回答您的问题。

# delphi - Class Completion 将其结果按什么顺序排列？

> ID：527938
> 
> 赞同：4
> 
> 时间：2009-02-09T12:25:23.310
> 
> 标签：delphi, ide, class-completion

示例：我创建了一个新单元，按顺序声明了一个包含多个方法（如构造函数、析构函数、method1、method2、method3）的类，然后按 Ctrl-Shift-C。IDE 会自动创建所有方法主体，但顺序是混淆的，而不是在接口部分中声明的那样。

现在，这不是问题，而是有原因。混合起来似乎比仅仅按照声明的顺序来做更难。

还是有一些我看不到的有意义的规则？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T20:25:07.307

回答起来有点复杂，因为它取决于您的方法是如何安排的。

如果它们已经按字母顺序实现，它将尝试并保持它。如果 IDE 无法推断出任何类型的顺序，它会求助于将它们放在文件末尾。

还有另一个问题，按照惯例，如果您在表单中包含注释： { <ClassName> } 在实现方法的第一个块之前，然后使用该注释来描述所有后续类实现，它将尝试保持方法分组一起。

字母顺序遵循上述相同的规则，除了它可以将新方法注入到由指示的注释描述的逻辑块中。

如果您将 class-completion 与全新的类一起使用，您会注意到 IDE 将自动生成该描述性注释。

如果您让类完成自动排列方法并且只使用`Ctrl`++键在方法的实现`Shift`和`UpAr`声明之间导航，那么顺序应该不太重要。

通常，我会使用上面的键序列跳转到类 decl，然后使用箭头键转到我想要的 decl 中的方法，然后再次使用该键序列快速找到它。

另一个不错的键序列是`Ctrl`++或`Alt`++ ，它将按文件顺序快速从方法impl跳转到方法 impl。`UpAr``Ctrl``Alt``DnAr`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T12:34:08.687

默认情况下，我很确定它会尝试按方法名称的字母顺序创建它们，然后在之后使用相同的方法添加更多方法时尝试保持这种状态。最终结果可能是排序时的随机组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T12:34:11.570

根据我的经验，我发现 IDE 有时会按字母顺序创建方法，但有时它只是将新方法附加到文件末尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T16:56:51.613

IDE 尝试按字母顺序创建所有内容。但是，如果方法变得乱序（例如，您重命名一个方法），它就会陷入混乱。确切的行为似乎取决于版本。旧版本会简单地将新方法以任意顺序附加到文件末尾。较新的版本似乎更聪明一些，但我还没有弄清楚到底是怎么回事。

# java - 通过 Java ORM 批量删除/清除记录

> ID：527945
> 
> 赞同：6
> 
> 时间：2009-02-09T12:28:39.977
> 
> 标签：java, batch-file, jpa, purge

对 - 我想从数据库中删除（例如）1,000,000 条记录。这需要很长时间 -> 事务超时并失败。所以 - 我分批删除它们，说每笔交易有 25000 条记录。在 MySQL 上使用 limit 子句或在 Oracle 上使用 ROWNUM。太好了，这很有效。

我想以独立于数据库的方式执行此操作。并且来自使用 JPA/Hibernate 的现有 Java 代码库。

运气不好。JPA Query.setMaxResults 和 setFirstResult 对写入“查询”（例如删除）没有影响。我会说，将许多实体选择到内存中以单独删除它们是非常缓慢和愚蠢的。

所以我使用本机查询并管理应用程序代码中的“限制”子句。将此子句封装在 orm.xml 中会很好，但是……“Hibernate Annotations 3.2 不支持使用本机查询进行批量更新/删除。” - [http://opensource.atlassian.com/projects/hibernate/browse/ANN-469](http://opensource.atlassian.com/projects/hibernate/browse/ANN-469)。

我想这是一个普遍的问题。有人有更好的数据库独立解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T12:51:52.950

我讨厌给出一个非建设性的答案，但 ORM 并不真正意味着对数据库进行批量操作。因此，看起来您的本机查询可能是这些操作的最佳选择。

您还应该确保更新您的 ORM 以反映数据库的新状态，否则您可能会发生一些奇怪的事情。

ORM 是将对象映射到数据库的好工具，但它们通常不是通用的数据库接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T22:05:55.130

我相信您可以使用 HQL (JPA QL) 直接 DML 操作，它将绕过持久性上下文和缓存，并直接执行（生成的 SQL）语句：

```
Query q = session.createQuery("delete YourEntity ye where ye.something like :param");
q.setParameter("param", "anything");
int deletedEntities = q.executeUpdate(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T12:46:06.550

查询限制是数据库特定的功能，没有 SQL 标准（我同意应该有）。

适用于大多数数据库的解决方案是使用视图将多个表组合为一个。每个表都包含数据的一个子集（比如一天）。这允许您一次删除整个子集。也就是说，许多数据库在此类视图上运行 UPDATE 和 INSERT 时存在问题。

您通常可以通过为 INSERT/UPDATE（指向单个表；“当前”表）和用于搜索的分组视图创建视图或别名来解决此问题。

一些数据库还提供基本相同的分区，除了您可以定义一个列，该列指定一行应该进入哪个基础表（在 INSERT 上）。当您需要删除一个子集时，您可以删除/截断其中一个基础表。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2010-11-19T09:16:22.870

`q.setMaxResults(int)`

...索尼

# c# - 使用 InvokeRequired 与 control.InvokeRequired

> ID：527947
> 
> 赞同：10
> 
> 时间：2009-02-09T12:28:53.767
> 
> 标签：c#

`InvokeRequired`和 和有什么不一样`somecontrol.InvokeRequired`？

像这样，

```
delegate void valueDelegate(string value);

private void SetValue(string value)
{
   if (InvokeRequired)
   {
       BeginInvoke(new valueDelegate(SetValue),value);
   }
   else
   {
       someControl.Text = value;
   }
} 
```

和

```
delegate void valueDelegate(string value);

private void SetValue(string value)
{   
    if (someControl.InvokeRequired)
    {
        someControl.Invoke(new valueDelegate(SetValue),value);
    }
    else
    {
        someControl.Text = value;
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-09T12:34:51.943

第一个版本检查负责*此*控件的线程。第二个版本检查负责的线程`someControl`。（然后他们将调用委托给哪个控件的线程也是如此。）

它们可能会有所不同——尽管如果两个控件位于同一个顶级窗口中，它们确实*不应该如此。*（一个窗口中的所有控件都应该在同一个线程上运行。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T12:35:09.510

不同之处在于您访问该属性的控件。如果您从表单上的方法中访问 InvokeRequired，那么您将有效地访问表单的 InvokeRequired 属性。

如果表单和 someControl 是在同一个线程中创建的，那么它们将返回相同的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T12:37:14.357

在第一个示例中，您似乎在控件的范围内，而在第二个示例中，您不在。主窗体和其他控件一样是控件。如果 someControl 被添加到主控件的 Control 集合中，您可以使用其中任何一个。

# visual-studio - FxCop on build (Visual Studio 2008 Professional)

> ID：527948
> 
> 赞同：2
> 
> 时间：2009-02-09T12:29:06.280
> 
> 标签：visual-studio, msbuild, fxcop

我刚刚学会了如何将 StyleCop 集成到 Visual Studio 中。现在它运行每个构建并且它的错误显示为警告。好极了！

现在我只想对 FxCop 做同样的事情，甚至安装 MSBuild 社区任务并添加到 proj 文件中：

```
 <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/> 
```

不会的。我还需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T12:43:45.293

试着把它放在`</Project>`你的 csproj/vbproj 文件之前：

```
<PropertyGroup>
    <PostBuildEvent>"%25ProgramFiles%25\Microsoft FxCop 1.36\FxCopCmd.exe" /file:"$(TargetPath)" /console /searchgac</PostBuildEvent>
</PropertyGroup> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T13:05:56.520

要在构建后执行 Fxcop，请使用 AfterBuild 目标中 MSBuildCommunityTasks 的 Fxcop 任务：

```
<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>

<Target Name="AfterBuild">

  <FxCop TargetAssemblies="@(OutputAssemblies)"
         RuleLibraries="@(FxCopRuleAssemblies)" 
         DependencyDirectories="$(MSBuildCommunityTasksPath)"
         FailOnError="False"
         ApplyOutXsl="True"
         OutputXslFileName="C:\Program Files\Microsoft FxCop 1.32\Xml\FxCopReport.xsl"
         DirectOutputToConsole="true"/>

</Target> 
```

输出将显示在控制台中。

# c# - 如何制作“始终在底部”窗口

> ID：527950
> 
> 赞同：8
> 
> 时间：2009-02-09T12:29:44.077
> 
> 标签：c#, delphi

有谁知道如何制作一个“始终在底部”的窗口，或者一个固定在桌面上的窗口？它应该接收焦点和鼠标点击，但应该保持在 Z 顺序的底部。即使用户进行最小化全部或显示桌面操作，它也能留在桌面上也很棒。

delphi 和 c# 解决方案（或部分解决方案/提示）都会很棒。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T13:35:00.613

**警告**建议您可以通过调用 SetParent 并将窗口设置为桌面的子窗口来完成此操作。如果这样做，您会导致 Win32 窗口管理器将桌面的输入队列合并到您的子窗口，这是一件*坏事*- [Raymond Chen 解释了原因。](http://blogs.msdn.com/oldnewthing/archive/2004/02/24/79212.aspx)

另外，请记住，使用 HWND_BOTTOM 调用 SetWindowPos 是不完整的。每当您的窗口更改 zorder 时，您都需要执行此操作。处理 WM_WINDOWPOSCHANGING 事件，查看 SWP_NOZORDER 了解更多信息。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-09T12:41:53.207

SetWindowPos 可以使窗口 AlwaysOnTop。它很可能会给出相反的结果。尝试以下方式：

```
[DllImport("user32.dll")]
static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X,
   int Y, int cx, int cy, uint uFlags);

 public const uint SWP_NOSIZE          = 0x0001;
 public const uint SWP_NOMOVE          = 0x0002;
 public const uint SWP_NOACTIVATE      = 0x0010;
 public const int HWND_BOTTOM = 1;

SetWindowPos(hWnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE); 
```

笔记：

*   尚未测试此方法（用于使窗口始终位于底部）
*   如果它碰巧工作，那么很可能显示桌面操作将隐藏窗口。所以也许你应该更深入地了解这个“不错”的 API。

编辑：按照这些思路进行了一些搜索，以确认它是否会成功并发现一些有趣[的东西 - 重复](https://stackoverflow.com/questions/365094/window-on-desktop)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-25T05:30:49.977

这是 ATL 窗口的解决方案。如果你能申请c#，它会对你有所帮助。

* * *

```
BEGIN_MSG_MAP(...)
   ...
   MESSAGE_HANDLER(WM_WINDOWPOSCHANGING, OnWindowPosChanging)
   ...
END_MSG_MAP()

LRESULT OnWindowPosChanging(UINT uMsg, WPARAM wParam, LPARAM lParam, BOOL& bHandled)

{

    if (_bStayOnBottom)
    {
        auto pwpos = (WINDOWPOS*)lParam;

        pwpos->hwndInsertAfter = HWND_BOTTOM;

        pwpos->flags &= (~SWP_NOZORDER);

    }
    return 0;
} 
```

# c# - C# out 参数性能

> ID：527953
> 
> 赞同：25
> 
> 时间：2009-02-09T12:31:28.287
> 
> 标签：c#, parameters, out

**C#中的****out**参数是否对我应该了解的任何性能影响？（如例外）

 **`out`我的意思是，在一个每秒运行几百万次的循环中有一个带有参数的方法是个好主意吗？

我知道它很难看，但我使用它的方式与`Int32.TryParse`使用它们的方式相同——返回 a`bool`以告知某些验证是否成功，如果成功，则有一个`out`包含一些附加数据的参数。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-09T12:58:17.613

我怀疑您会发现使用`out`参数会导致任何显着的性能损失。您必须以某种方式将信息返回给呼叫者 -`out`只是一种不同的方式。如果您在方法中广泛使用 out 参数，您可能会发现会有*一些*损失，因为这很可能意味着每次访问都需要额外的重定向级别。但是，我不认为它会很重要。像往常一样，编写最易读的代码并[测试性能是否已经足够好，](http://blogs.msdn.com/ericlippert/archive/2009/02/06/santalic-tailfans-part-two.aspx)然后再尝试进一步优化。

编辑：其余的内容是有效的。它只与大值类型真正相关，通常应该避免这种情况:)

不过，我不同意 Konrad 关于“所有类型 > 32 位的返回值的处理方式与机器级别的输出参数相似或相同”的断言。这是一个小测试应用程序：

```
using System;
using System.Diagnostics;
using System.Runtime.CompilerServices;

struct BigStruct
{
    public Guid guid1, guid2, guid3, guid4;
    public decimal dec1, dec2, dec3, dec4;
}

class Test
{
    const int Iterations = 100000000;

    static void Main()
    {
        decimal total = 0m;
        // JIT first
        ReturnValue();
        BigStruct tmp;
        OutParameter(out tmp);

        Stopwatch sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            BigStruct bs = ReturnValue();
            total += bs.dec1;
        }
        sw.Stop();
        Console.WriteLine("Using return value: {0}",
                          sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            BigStruct bs;
            OutParameter(out bs);
            total += bs.dec1;
        }
        Console.WriteLine("Using out parameter: {0}",
                          sw.ElapsedMilliseconds);
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public static BigStruct ReturnValue()
    {
        return new BigStruct();
    }

    [MethodImpl(MethodImplOptions.NoInlining)]
    public static void OutParameter(out BigStruct x)
    {
        x = new BigStruct();
    }
} 
```

结果：

```
Using return value: 11316
Using out parameter: 7461 
```

基本上通过使用 out 参数，我们将数据直接写入最终目的地，而不是将其写入小方法的堆栈帧，然后将其复制回 Main 方法的堆栈帧。

不过，请随意批评基准应用程序 - 我可能错过了一些东西！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T12:35:10.057

没有性能影响。`out`从技术角度来看，与任何旧的参数传递基本相同。虽然复制大量数据（例如对于大型结构）听起来似乎是合理的，但这实际上与返回值相同。

事实上，所有大于 32 位的类型的返回值的处理方式都类似于**机器级别**`out`的参数。

 **请注意，最后一条语句并不建议`out`在 .NET 中返回 value == 参数。Jon 的基准测试表明，显然（并且令人遗憾地）情况并非如此。事实上，为了使其相同，在 C++ 编译器中使用了[命名返回值优化。](http://blogs.msdn.com/slippman/archive/2004/02/03/66739.aspx)在 JIT 的未来版本中可能会执行类似的操作，以提高返回大型结构的性能（但是，由于大型结构在 .NET 中非常罕见，这可能是不必要的优化）。

*但是*，（而且我对 x86 汇编的了解非常有限），从函数调用返回对象通常需要在调用站点分配足够的空间，将地址压入堆栈并通过将返回值复制到其中来填充它。这基本上是一样的`out`，只是省略了值的不必要的临时副本，因为可以直接访问目标内存位置。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T12:56:28.773

不是性能问题，而是较早出现的问题 -[你不能在 C# 4.0 中使用它们](https://stackoverflow.com/questions/527758/in-c-4-0-why-cant-an-out-parameter-in-a-method-be-covariant)。

就个人而言，我倾向于在我的**私有**`out`代码中大量使用参数（即在一个类中，有一个方法可以返回多个值而不使用单独的类型）——但我倾向于在公共 API 上避免使用它们，模式除外。**`bool Try{Something}(out result)`**

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T12:35:22.473

避免输出参数的主要原因是代码可读性，而不是性能。

对于值类型，无论如何都没有真正的区别（它们总是复制），对于引用类型，它基本上与通过 ref 传递相同。

十有八九你最好创建自己的哑记录类，而不是使用 out 参数 - 当你稍后返回代码时，这更容易阅读和理解。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T12:36:25.857

Out 参数由 ref 传递。所以只有一个指针在堆栈上传递。

如果您的值类型很大，则副本较少，但是您必须取消引用每个变量使用的指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T12:38:40.407

使用 out 参数不会损害性能。Out 参数基本上是一个引用参数，因此调用者和被调用者都指向同一块内存。

# cocoa-touch - 如何生成图形（图表）报告？

> ID：527954
> 
> 赞同：1
> 
> 时间：2009-02-09T12:32:13.230
> 
> 标签：cocoa-touch, sqlite

我正在使用 Cocoa Touch 和 SQLite 开发一个 iPhone 应用程序。我想生成一个图形（图表）报告。如何生成图形图表报告？是否有任何工具可以轻松生成图形报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T12:54:08.963

我不知道任何预制的图表组件。你必须继承 UIView 并编写 Quartz2d 代码来绘制你想要的任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T13:52:46.063

现在，您最好的选择是按照 U62 的建议，通过 Quartz 在自定义 UIView 的 drawRect: 方法中绘制您自己的自定义图表。

但是，有一个快速发展的 BSD 许可开源框架，称为[Core Plot](http://code.google.com/p/core-plot/)（[邮件列表](http://groups.google.com/group/coreplot-discuss?hl=en)），它将能够绘制多种类型的图和图表。该框架的 UI 类基于 Core Animation CALayers 以便跨平台（支持具有相同代码库的 Mac 和 iPhone）。正如我所说，它还处于早期阶段，但该项目有许多贡献者，而且似乎进展很快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T15:24:16.233

另一种选择是使用 CSS/HTML 图形在 Javascript 中开发图表代码，并将其显示在 webView 中。您可以使用 webView 的 loadHTMLString 在 webview 中插入图表代码（而不是加载外部 URL），并使用 stringByEvaluatingJavaScriptFromString 与之交互，向其发送图表参数等。

这是一个迂回的解决方案，可能无法生成看起来像使用原生图形那样光滑的图表，但是网络上有很多免费的 Javascript/CSS 图表解决方案，因此这种方法可能会缩短开发时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-02T13:01:48.000

如果有人仍然感兴趣，我遇到了这个列表：

1.  忍者控制
2.  www.threedgraphics.com
3.  iPhone Objective-C 的 iPhone 图表库
4.  www.nchart3d.com

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T23:31:50.867

另一种选择 - 我自己没有尝试过，但没有明显的原因为什么它不起作用：

移动 Safari（以及 UIWebView）支持 SVG。您可以在内存中创建 SVG，然后将其传递给

```
- (void)loadData:(NSData *)data 
        MIMEType:(NSString *)MIMEType 
textEncodingName:(NSString *)encodingName 
         baseURL:(NSURL *)baseURL 
```

请记住设置正确的 MIME 类型。

# asp.net - 如何在没有回发的情况下使用 JavaScript 上传文件？

> ID：527955
> 
> 赞同：1
> 
> 时间：2009-02-09T12:32:20.623
> 
> 标签：asp.net, javascript, upload

我正在处理 ASP.NET 中的文件上传。`<input type=file id=upload>`我用过`<input type=button id="btnupload" value="File Upload">`

我想用 JavaScript 上传文件。更新面板不起作用，我不希望它回发并刷新页面。

谢谢，但如果您有与 javascript 中的 fileUpload 相关的代码，请发送给我。请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T12:48:04.813

您可以使用 jQuery 和[jQuery 表单插件](http://malsup.com/jquery/form/)。我在几个项目中使用了这个组合，我没有问题，即使是大文件（10mb）

```
<form action="form.asp" method="post">
.......
</form>
$('form').submit(function(){
 $(this).ajaxSubmit(function(data){
  $('#updateDiv').html(data); // or append/prepend/whatever
 })
 return false
}) 
```

当然，表单的操作将返回您需要更新的内容。您可能想要添加一些额外的函数来处理错误，但这应该可以正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T12:46:24.370

使用 jquery 表单插件来实现上传功能 ( [http://www.malsup.com/jquery/form/](http://www.malsup.com/jquery/form/) ) 使用 ( [http://www.fyneworks.com/jquery/multiple-file-upload/](http://www.fyneworks.com/jquery/multiple-file-upload/) ) 来指定多个文件上传

这就是它的工作原理，表单插件可让您将数据发布到页面而无需刷新，多文件插件可让您通过浏览来指定多个文件。

```
<form id="uploadForm" enctype="multipart/form-data" method="post" action="FileHandler.ashx">
<input type="hidden" value="100000" name="MAX_FILE_SIZE"/>
File:
<input type="file" name="file"/>
<input type="submit" value="Submit"/>
</form> 
```

所以基本上上面的小 html 提交到 FileHandler.ashx，无论输入框中的内容（希望如此），在你的 asp 项目中添加一个 HTTP 处理程序，下面的小代码

```
<%@ WebHandler Language="C#" Class="FileHandler" %>

using System;
using System.Web;
using System.IO;

public class FileHandler : IHttpHandler
{

public void ProcessRequest(HttpContext context)
{
string strFileName = Path.GetFileName(context.Request.Files[0].FileName);
string strExtension = Path.GetExtension(context.Request.Files[0].FileName).ToLower();
string strSaveLocation = context.Server.MapPath("Upload") + "" + strFileName;
context.Request.Files[0].SaveAs(strSaveLocation);

context.Response.ContentType = "text/plain";
context.Response.Write("success");
}

public bool IsReusable
{
get
{
return false;
}
}
} 
```

这里缺少的只是包括你的aspx页面上的js脚本，我想:)祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T12:45:34.710

如果您使用的是 Visual Studio 2008（或在 05 中安装了 ajax），则在您的输入字段周围包装一个更新面板，这将使用 javascript (ajax) 异步回发。

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
<ContentTemplate>
    <asp:FileUpload ID="FileUpload1" runat="server" />
    <asp:Button ID="Button1" runat="server" Text="Button" />
</ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T13:50:35.803

我不确定使用 ASP.NET 执行此操作的“正确”方式，但通常您需要表单以及表单发布到的隐藏 iframe：

```
<script type="text/javascript">
    function handleUploadResponse(...) {
        // do something...
    }
</script>
<form method="post" action="upload.aspx" target="hiddenframe" enctype="multipart/form-data"></form>
<iframe id="hiddenframe" name="hiddenframe" style="display:none"></iframe> 
```

当您提交表单时，这将发布到任何脚本将处理隐藏框架中的上传。完成后，隐藏框架的页面调用`window.parent.handleUploadResponse(...);`它调用`handleUploadResponse()`父页面上启动上传的函数。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-09T12:41:03.410

如果要阻止页面刷新，请发送`204 No Content`HTTP 标头。

# .net-2.0 - 找出自Windows启动以来经过的时间的正确功能？

> ID：527972
> 
> 赞同：0
> 
> 时间：2009-02-09T12:36:44.840
> 
> 标签：.net-2.0

我知道[Environment.TickCount](http://msdn.microsoft.com/en-us/library/system.environment.tickcount.aspx)存在，但我有一个大问题，它仅限于 25 天。

什么是不需要外部模块/dll并且可以在Windows Server 2003的香草安装中工作的好选择？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T12:41:22.367

有很多选择。

```
public TimeSpan SystemUpTime()
{
    PerformanceCounter upTime = 
        new PerformanceCounter("System", "System Up Time");

    // You've got to call this twice. First time it returns 0 
    // and the second time it returns the real info.
    upTime.NextValue();   
    return TimeSpan.FromSeconds(upTime.NextValue());
} 
```

但是，如果您没有足够的权限，这将不会运行。

您还可以使用[WMI](http://blogs.clearscreen.com/dtax/archive/2007/01/19/5985.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T12:41:22.740

您可以`WMI`使用[`WIN32_OperatingSystem.LastBootUpTime`](http://msdn.microsoft.com/en-us/library/aa394239(VS.85).aspx).

# c - ubuntu 上的堆栈执行保护和随机化

> ID：527973
> 
> 赞同：5
> 
> 时间：2009-02-09T12:37:02.703
> 
> 标签：c, security, stack-overflow, buffer-overflow

作为课程作业的一部分，我需要编写一个利用代码来导致缓冲区溢出并执行堆栈上存在的代码。

我已经通过以下命令关闭了堆栈随机化： sysctl -w kernel.randomize_va_space=0 但是，我无法找到关闭堆栈执行保护的方法。我不确定 ubuntu 中是否有一些堆栈 exec 保护......所以我的第一个问题是 ubuntu 8.10 中是否有类似 red hat 的 exec-shield 的东西，如果有，我们如何将其关闭。

我一直试图导致缓冲区溢出并从堆栈执行指令，但是每当我尝试这样做时，它都会给我一个段错误。

我有 ubuntu 8.10 64 位，但是，即时调试程序是在 i386 机器上编译的，堆栈保护关闭。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-04T02:00:31.257

您可能希望`-z execstack`在 GCC 编译中使用标志进行编译，以及`-fno-stack-protector`（禁用 GCC 的 SSP/Propolice 堆栈保护），即：

```
gcc -fno-stack-protector -z execstack -o vuln vuln.c 
```

在此之后，一切都可能变成杰克。请注意，这`sysctl -w kernel.randomize_va_space=0`只是地址空间随机化，而不是堆栈保护本身；这可能会被强制使用各种技术。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:58:39.683

这些程序通常可以在没有可执行堆栈的情况下被利用。如果受害者是在没有可执行堆栈的情况下编译的，则将面向返回的编程视为一种利用技术。

[http://en.wikipedia.org/wiki/Return-oriented_programming](http://en.wikipedia.org/wiki/Return-oriented_programming)

# asp.net-mvc - 当升级到 MVC beta 到 RC1 时，应用程序突然崩溃，它不应该崩溃

> ID：527981
> 
> 赞同：0
> 
> 时间：2009-02-09T12:39:36.533
> 
> 标签：asp.net-mvc, viewdata

当我们将 MVC beta 升级到 MVC RC1 时，Visual Studio 的开发网络服务器在应用程序的某个时刻突然崩溃了。经过一番搜索，我将错误缩小到这个简单的行：

```
if (!helper.ViewData.ContainsKey("SomeString")) 
```

SomeString 在那一刻出现在 viewData 中，所以 if 语句应该返回 false

执行该行时，网络服务器崩溃，程序中没有异常。我们看到似乎来自方法 ContainsKey 的崩溃。有人遇到过同样的问题吗？我们应该回滚到 MVC beta 的安装吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T14:21:58.270

我不知道答案，但我可以告诉你如何找到它。我的经验是，当开发 Web 服务器崩溃时，通常是因为您的代码（或者显然是您正在调用的框架中的代码）中的堆栈溢出。您当然可以从 CodePlex 获取 MVC 源代码。您应该下载它，并将其添加到您的解决方案中。追踪到 ContainsKey。如果需要，使用 Visual Studio 选项跟踪到 .NET 框架源代码。在某些时候，您应该弄清楚代码为什么会反转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T18:52:09.557

如果没有看到您的错误，我无法给您明确的答案，但我猜这是因为 ViewData.Model 变成了 Model。

请参阅：[http](http://blog.benhall.me.uk/2009/01/aspnet-mvc-rc1-viewdatamodel-becomes.html) ://blog.benhall.me.uk/2009/01/aspnet-mvc-rc1-viewdatamodel-becomes.html或[http://weblogs.asp.net/scottgu/archive/2009/01/27/ asp-net-mvc-1-0-release-candidate-now-available.aspx](http://weblogs.asp.net/scottgu/archive/2009/01/27/asp-net-mvc-1-0-release-candidate-now-available.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T18:56:02.840

您在 Windows 的事件管理器中看到什么异常？那里有一些有用的信息，我认为应用程序名称是 Casini

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T08:57:28.433

我发现了问题。执行 ContainsKey 方法的代码位于外部库中。当我们将开发机器升级到 RC1 时，我们忘记将构建服务器升级到 RC1。所以我们引用的库是参考 mvc beta 构建的。我仍然觉得奇怪的是会发生这些错误，但这就是问题所在。

当我们升级我们的构建服务器时，错误消失了。

# oracle - 只允许 Oracle 用户从一个 IP 地址连接

> ID：527991
> 
> 赞同：2
> 
> 时间：2009-02-09T12:42:03.767
> 
> 标签：oracle

出于安全原因，我们希望限制 oracle 用户只能从特定 IP 地址进行连接。这可能吗？

如果是这样，我们该如何配置呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-09T13:23:01.250

放一个：

```
SELECT SYS_CONTEXT('USERENV', 'IP_ADDRESS') FROM dual; 
```

进入您的`AFTER LOGON`触发器并在不允许时抛出异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T12:45:34.447

我建议您为此目的使用防火墙。如果您在 Linux 上，应该可以使用 iptables 设置规则，以便只有一个特定的 IP 地址可以访问 Oracle 正在侦听的端口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T17:13:55.067

Oracle Connection Manager 应该可以从您的安装中使用，并充当 SQL*Net 的代理服务器 - 您可以配置类似防火墙的规则来与它进行连接。

# wmi - 如何远程查询终端服务活动？

> ID：527997
> 
> 赞同：0
> 
> 时间：2009-02-09T12:43:25.137
> 
> 标签：wmi, terminal-services

我想查询我们的服务器以查看是否有断开/空闲会话。我知道我可以使用“query.exe”，但我更喜欢从代码中更容易使用的东西。

WMI 将是我的首选。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T12:47:51.600

要查找内容/生成 WMI 代码和查询，请获取[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)。它将生成测试存根（C#、VB.NET、VBScript）并让您测试查询以确保它们返回您想要的信息。

Win32_Terminal* 和 Win32_TS* 类下的终端服务内容（其中有一些，不确定哪一个可以满足您的需求。）。

我还使用这个帮助类（需要一些重构，多年未接触它）来获取管理对象和执行方法。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Management;

namespace MyWMI
{
    public class WmiHelper
    {
        public static ManagementObjectCollection GetManagementObjectCollection(string ServerName, string WMIQuery)
        {
            //determine where the WMI root is that we will connect to. 
            string strNameSpace = "\\\\";

            ConnectionOptions connectionOptions = new ConnectionOptions();
            TimeSpan tsTimeout = new TimeSpan(0,0,5);
            connectionOptions.Timeout = tsTimeout;

            //if its not a local machine connection
            if (ServerName.Trim().ToUpper() != Globals.HostName)
            {
                strNameSpace += ServerName;
                connectionOptions.Username = Globals.WMIUserDomain + "\\" + Globals.WMIUserName;
                connectionOptions.Password = Globals.WMIUserPass;
            }
            else
            { //we are connecting to the local machine
                strNameSpace += ".";
            }

            strNameSpace += "\\root\\cimv2";

            //create the scope and search
            ManagementScope managementScope = new ManagementScope(strNameSpace, connectionOptions);
            ObjectQuery objectQuery = new ObjectQuery(WMIQuery);
            ManagementObjectSearcher searcher = new ManagementObjectSearcher(managementScope, objectQuery);
            ManagementObjectCollection returnCollection;
            try
            {
                returnCollection = searcher.Get();
            }
            catch (ManagementException ex)
            {
                throw new SystemException("There was an error executing WMI Query. Source: " + ex.Source.ToString() + " Message: " + ex.Message);
            }

            //return the collection
            return returnCollection;

        } //eng GetManagementObjectCollection

        public static bool InvokeWMIMethod(string ServerName, string WMIQueryToIsolateTheObject, string MethodName, object[] MethodParams)
        {

            //determine where the WMI root is that we will connect to. 
            string strNameSpace = "\\\\";

            ConnectionOptions connectionOptions = new ConnectionOptions();
            TimeSpan tsTimeout = new TimeSpan(0, 0, 5);
            connectionOptions.Timeout = tsTimeout;

            if (ServerName.Trim().ToUpper() != Globals.HostName)
            {
                strNameSpace += ServerName;
                connectionOptions.Username = Globals.WMIUserDomain + "\\" + Globals.WMIUserName;
                connectionOptions.Password = Globals.WMIUserPass;
            }
            else
            { //we are connecting to the local machine
                strNameSpace += ".";
            }

            strNameSpace += "\\root\\cimv2";

            ManagementScope managementScope = new ManagementScope(strNameSpace, connectionOptions);
            ObjectQuery objectQuery = new ObjectQuery(WMIQueryToIsolateTheObject);
            ManagementObjectSearcher searcher = new ManagementObjectSearcher(managementScope, objectQuery);
            ManagementObjectCollection returnCollection = searcher.Get();

            if (returnCollection.Count != 1)
            {
                return false;
            }

            foreach (ManagementObject managementobject in returnCollection)
            {
                try
                {
                    managementobject.InvokeMethod(MethodName, MethodParams);
                }
                catch
                {
                    return false;
                }

            } //end foreach 
            return true;
        } //end public static bool InvokeWMIMethod(string ServerName, string WMIQueryToGetTheObject, string MethodName, object[] MethodParams)
    }
} 
```

**@First评论：** Ick ...显然这*比*最初想象的要复杂。查看这篇文章 ( [http://www.codeproject.com/KB/system/logonsessions.aspx](http://www.codeproject.com/KB/system/logonsessions.aspx) )，在标题为“*内置 WMI 功能怎么样？* ”的部分。如果使用 XP，则需要进行一些特殊处理，因为它具有不同的 WMI 提供程序类（将 WMI 代码创建者更改为指向远程计算机 - 例如 Win2K3 服务器），并且在任何一种情况下，您都需要“加入”来自所有的会话类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T02:54:31.493

如果您使用的是 .NET 语言，则可以尝试[Cassia](http://cassia.googlecode.com/)。在 C# 中，代码为：

```
using System;
using Cassia;

namespace CassiaSample
{
    public static class Program
    {
        public static void Main(string[] args)
        {
            ITerminalServicesManager manager = new TerminalServicesManager();
            using (ITerminalServer server = manager.GetRemoteServer("server-name"))
            {
                server.Open();
                foreach (ITerminalServicesSession session in server.GetSessions())
                {
                    if ((session.ConnectionState == ConnectionState.Disconnected)
                        ||
                        (session.ConnectionState == ConnectionState.Active)
                        && (session.IdleTime > TimeSpan.FromMinutes(1)))
                    {
                        Console.WriteLine("Session {0} (User {1})", session.SessionId, session.UserName);
                    }
                }
            }
        }
    }
} 
```

编辑：更新了 Cassia 2.0 的示例代码。

# c++ - 可以对内置类型使用 C 样式转换吗？

> ID：527999
> 
> 赞同：17
> 
> 时间：2009-02-09T12:43:53.077
> 
> 标签：c++, casting

在阅读了很多关于 C++ 中 C 风格转换的答案之后，我还有一个小问题。我可以对内置类型使用 C 风格的转换，`long x=(long)y;`或者它仍然被认为是坏的和危险的吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-09T12:47:14.443

> 我可以对像 long x=(long)y; 这样的内置类型使用 C 风格的转换吗？或者它仍然被认为是坏的和危险的？

永远不要使用它们。反对使用它们的原因也适用于此。基本上，一旦你使用它们，所有的赌注都没有了，因为编译器将不再帮助你。虽然这对指针来说比其他类型更危险，但它*仍然*可能很危险，并且在出现错误时会给出糟糕的编译器诊断，而新样式转换提供更丰富的错误消息，因为它们的使用受到更多限制：Meyers 引用了 cast away `const`ness的例子: 使用除`const_cast`不会编译之外的任何强制转换，从而清楚地说明这里发生了*什么*。

此外，无论类型如何，其他一些缺点都适用，即句法考虑： C 风格的强制转换非常不显眼。这不好：C++ 强制转换在代码中很明显，并指向潜在的危险代码。它们也可以在 IDE 和文本编辑器中轻松搜索。尝试在大型代码中搜索 C 风格的转换，您会发现这有多难。

另一方面，与 C++ 类型转换相比，C 风格的转换没有任何优势，因此甚至不需要考虑权衡。

更一般地说，Scott Meyers 建议在 Effective C++（第 27 条）中“最小化类型转换”，因为“类型转换颠覆了类型系统”。</p>

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-09T17:11:56.270

我不会，原因如下：

*   演员阵容很丑陋，应该丑陋并在您的代码中脱颖而出，并且可以使用 grep 和类似工具找到。
*   “始终使用 C++ 类型转换”是一个简单的规则，比“对用户定义的类型使用 C++ 类型转换，但可以在内置类型上使用 C 风格类型转换”更容易被记住和遵循。
*   C++ 样式转换为其他开发人员提供了有关为什么需要转换的更多信息。
*   C-style casts 可能让你做你不想要的转换——如果你有一个接受 (int*) 的接口，并且你正在使用 c-style casts 向它传递一个 const int*，并且接口更改为在很长一段时间内，您使用 c 样式转换的代码将继续工作，即使它不是您想要的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-07T16:17:19.867

如果您*要从*数字类型*转换为*另一种数字类型，那么我认为 C 样式转换**比**`*_cast`. 每个`*_cast`运算符都有一个特定的理由不在数字类型上使用它：

*   `reinterpret_cast`，当应用于数字类型时，会进行正常的数字转换而不是重新解释位，即写入`reinterpret_cast<uint64_t>(3.14159)` *不会*产生与浮点常量具有相同位表示的整数。这与直觉相反。
*   `const_cast`*在数值*上从来不需要，如果应用于数值*变量*（而不是指针或对数字的引用），则表明该变量的类型不正确。
*   `dynamic_cast`just plain 对数字没有意义，因为数字从来没有动态类型。
*   `static_cast`通常用于类类型。因此，应用于一个数字*看起来很奇怪；*`static_cast`你的读者会摸不着头脑，想知道是否有什么他们不知道的东西`static_cast`使它*不同于*C 风格的演员应用于数字时。（事实上​​，它们是相同的，但我不得不多次阅读相关的 C++ 规范部分以*确保*它们是相同的，而且我仍然有“这里肯定发生了一些奇怪的事情”的反应。）

还有一个额外的文体理由来避免它们：

*   如果你需要在数字类型之间进行转换，你可能需要在一个集群中进行其中的几个；正因为如此，C 风格转换的简洁性很重要。例如，我现在正在编写的程序有一大堆这样的事情：

    ```
    uint32_t n = ((uint32_t(buf[0]) << 24) |
                  (uint32_t(buf[1]) << 16) |
                  (uint32_t(buf[2]) <<  8) |
                  (uint32_t(buf[3])      )); 
    ```

    在这里使用`static_cast`会掩盖算术，这是重要的。（注意`sizeof(uint32_t) <= sizeof(unsigned int)`：只有*当*`be32_to_cpu`.)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-08T11:18:35.227

我可以想到 C 风格转换的一种合法用途：

```
// cast away return value to shut up pedantic compiler warnings
(void)printf("foo\n"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-06-29T23:28:57.280

在我看来，在使用标准库函数和 STL 时对内置类型进行 C 样式转换是可以的，并且可以使代码更易于阅读。

在我工作的公司中，我们使用最大（4 级）警告进行编译，因此我们会收到有关每个小类型转换等的警告......所以我在这些中使用 c 样式转换，因为它们很小，不那么冗长且有意义.

```
for (int i = 0; i < (int)myvec.size(); i++)
{
  // do something int-related with i
}
float val = (float)atof(input_string); 
```

ETC....

但是如果它的 on（例如库）代码可能会改变，那么 static_cast<>() 会更好，因为如果类型改变并且强制转换不再有意义，您可以确保编译器会出错。此外，如果您只使用 c 样式，则不可能在代码中搜索强制转换。" `static_cast<mytype>(`" 很容易搜索。:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-13T23:17:35.943

考虑到上下文，我认为这可能没问题。例子：

```
/* Convert -1..1 to -32768..32767 */
short float_to_short(float f)
{
    return (short)(max(-32768.f, min(32767.f, f * 32767.f)));
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T14:14:15.497

如果您发现需要进行 C 风格的转换（或 reinterpret_cast），那么请非常仔细地查看您的代码，可以 99.99% 确定它有问题。这两种转换几乎都不可避免地导致了特定于实现的（并且通常是未定义的）行为。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T18:26:07.887

为什么你需要那个特定的演员？任何数字类型都可以在没有强制转换的情况下转换为 long（可能会丢失精度），因此强制转换不会让编译器做任何它已经不能做的事情。通过强制转换，您所做的只是消除编译器在存在潜在问题时发出警告的能力。如果您将其他一些基本类型（如指针）转换为 long，我真的很想看到 reinterpret_cast<> 而不是 C 类型转换，所以如果结果是我可以很容易地找到发生了什么成为一个问题。

我不会无缘无故地赞成演员，我当然也不会无缘无故地赞成 C 型演员。我看不出在大多数内置类型之间进行转换的理由，如果有的话，我希望能够通过文本搜索轻松找到它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-11T14:41:07.140

我更喜欢传统 C 转换的一种情况是将字节缓冲区转换为不同的符号。许多 API 有不同的约定，实际上并没有“正确答案”，并且转换在它完成的上下文中并不危险，其中代码只需要与所使用的库的组合一样与平台无关。

我的意思是一个具体的例子，我认为这很好：

```
unsigned char foo[16];
lib1_load_foo(key);
lib2_use_foo((char*)key); 
```

但对于其他任何事情，如果需要强制转换，它会产生潜在的副作用，这应该很突出，使用 C++ 风格（可以说是丑陋的）强制转换是正确的选择。如果不需要演员表，则不要使用演员表。*****************