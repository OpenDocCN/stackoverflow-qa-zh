# StackOverflow 问答 11511000-11511999

# sql - SQL Group By 与可能的子查询？

> ID：11511004
> 
> 赞同：0
> 
> 时间：2012-07-16T19:16:06.613
> 
> 标签：sql, select, group-by

我有一个用户表，其中有很多记录到 1 个用户关系。我想查找所有用户 ID 相同且用户名不同的记录。

例如我试过：

```
SELECT UserId, UserName, count(*) FROM tblUser
GROUP BY UserId, UserName 
```

这只是给了我一个用户列表，以及他们有多少次拥有 UserId 和 UserName 的独特组合

所以我想要的输出是

```
UserId    | UserName
----------+-----------
1111      | Bob
1111      | JoeBob
2222      | Jimmy
2222      | ILikeTurtles 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:22:26.883

```
select *
from tblUser t1
inner join (
  SELECT UserId
  FROM tblUser 
  GROUP BY UserId
  having count(distinct UserName) > 1
) t2
  on t1.UserID = t2.UserID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:23:28.433

我将您所说的解释为：“并且用户名与主要名称不同”。

所以，问题是找到最常见的名称，然后找到除该名称之外的所有其他行。

```
with tgrp as (select tu.userid, tu.username, count(*) as cnt
              from tblUser tu
              group by tu.userid, tu.username
             ),
     tmax as (select tu.userid, tu.username, cnt
              from tgrp join
                   (select tu.userid, max(cnt) as maxcnt
                    from tgrp
                    group by tu.userid
                   ) t1
                   on tgrp.userid = t1.userid and tgrp.cnt = t1.maxcnt
             )
select *
from tblUser tu left outer join
     tmax
     on tu.userid = tmax.userid and tu.username = tmax.username
where tmax.userid is null 
```

这个查询是一步一步完成的。查找 id 和 name 的所有组合的计数。然后找到最大组合。然后找到不是最大组合的所有内容。

如果您只想要具有多个名称的用户标识，您可以使用：

```
select userid
from tblUser tu
group by userid
having count(distinct username) > 1 
```

要获取完整记录，请将其连接回原始表：

```
select *
from tbl_user tu
where tu.userid in (select userid
                    from tblUser tu
                    group by userid
                    having count(distinct username) > 1
                   ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:44:23.887

```
select t.userid, t.username
from tbluser t
where exists(select 1 
             from tbluser t2
             where t.userid = t2.userid
               and t.username <> t2.username) 
```

# objective-c - 用属性声明实例变量或不声明有什么区别？

> ID：11511005
> 
> 赞同：1
> 
> 时间：2012-07-16T19:16:06.867
> 
> 标签：objective-c, ios

> **可能重复：**
> [Objective-C 2.0 中的属性和实例变量](https://stackoverflow.com/questions/3074248/properties-and-instance-variables-in-objective-c-2-0)

当我在第一种情况下使用@property 和@synthesize 以及@property 和@synthesize 并声明相同的实例变量时有什么区别？因为两者似乎都有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:18:21.947

没有区别：您声明的实例变量将被使用，并且它的 ARC 属性将被您声明的`@property`.

> 属性的指定所有权保留在其元数据中，但除非属性是综合的，否则其含义纯粹是传统的。如果一个属性是合成的，那么关联的实例变量是由@synthesize 声明可能隐含地命名的实例变量。**如果关联的实例变量已经存在，则其所有权资格必须等于属性的所有权；否则，将使用该所有权资格创建实例变量。**

`@synthesize`最好避免为您打算使用的属性声明实例变量。如果您更喜欢具有*不同*名称的实例变量，则可以使用带有 ivar 名称的 synthesize 语法：

```
@synthesize myproperty = _myivar; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:19:06.523

两者都可以工作 - 但是，在较新的架构上，如果您声明一个属性，则不需要专门声明 iVar，因为它是为您完成的。

实际上，这是首选 - 但是，请确保如果您同时声明两者，您会意识到当您直接访问 iVar 或通过 getter 和 setter 时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:48:03.987

这是个人喜好问题，但我建议不要明确声明 ivars。我在 SO 上看到过人们做过以下事情的情况：

```
@interface MyClass
{
    NSString *var;
}
@property (nonatomic, strong) NSString *var;
@end 
```

进而

```
@implementation MyClass
@synthesize var = _var; 
```

因此，用户显式声明了同名的属性和 ivar，但随后合成了生成另一个 ivar 的属性（在此示例中，名称中带有前面的下划线），导致生成了两个 ivar。然后他们想知道为什么他们明确声明的 ivar 不起作用。如果您不显式声明您的 ivar，则不会遇到意外以两个 ivar 结束的问题，因为您碰巧在 ivar 显式声明或`@synthesize`语句中输入了错误的名称。

只需声明属性，然后使用另一个名称（通常使用前面的下划线）声明 ivar，并且它是明确的（即，如果您忘记将属性正确`@synthesize`引用为 ，您不太可能意外引用您的 ivar ）并且您永远不必担心，例如：`var``self.var`

```
@interface MyClass
@property (nonatomic, strong) NSString *var;
@end 
```

进而

```
@implementation MyClass
@synthesize var = _var; 
```

# jquery - 使用事件监听器提示 .load 事件

> ID：11511006
> 
> 赞同：1
> 
> 时间：2012-07-16T19:16:09.020
> 
> 标签：jquery, event-listener

我有一个 .load 事件，我正在尝试使用事件侦听器触发。我有一个向下滑动的叠加层，当它完成动画时，我尝试使用 jquery .load 将 url [http://www.klossal.com/portfolio/space_fullscreen.html](http://www.klossal.com/portfolio/space_fullscreen.html)的内容加载到叠加层 div . 我有一个 jfiddle 设置，但我似乎无法让它工作，我非常感谢我能得到的任何帮助，谢谢。

这是小提琴：http: [//jsfiddle.net/rGhkH/6/](http://jsfiddle.net/rGhkH/6/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:32:16.217

修复 extra 后`)`，您的代码会根据代码的功能运行。

```
var mybutton = document.getElementById("fullscreen_launch");
var fullscreen = document.getElementById("fullscreen");

mybutton.onclick = function() {
    fullscreen.addEventListener("webkitTransitionEnd", function() {
        $('#fullscreen')
           .html('<img src="http://www.klossal.com/loader.gif"/>')
           .load('http://www.klossal.com/portfolio/space_fullscreen.html');
    });
    fullscreen.className = ' fullscreen_show';
}; 
```

由于`http://jsfiddle.net`与 不是同一个域`http://www.klossal.com`，因此浏览器会限制 javascript 检索来自`http://www.klossal.com`同源策略的任何信息。如果运行此脚本，`http://www.klossal.com`它将起作用。

# java - libsox 或 libsndfile 是否有 javax.sound 接口？

> ID：11511012
> 
> 赞同：0
> 
> 时间：2012-07-16T19:16:50.483
> 
> 标签：java, audio, caf, libsndfile

我正在寻找从已经使用 javax.sound 完成其工作的 Java 应用程序打开/操作 CAF（核心音频格式）文件。有谁知道 libsox 或 libsndfile 的 javax.sound 包装器，每个都本机支持 CAF？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-17T19:34:26.440

很确定那些东西不存在。不过，也许这会起作用：http: [//jffmpeg.sourceforge.net/](http://jffmpeg.sourceforge.net/)

# php - PHP：使用自动加载器导致我的数据库类失败

> ID：11511016
> 
> 赞同：0
> 
> 时间：2012-07-16T19:16:57.393
> 
> 标签：php, mysqli, spl-autoload-register

我有一个通过`spl_autoload_register`. 它很好地包含和初始化类，但是当涉及到我的数据库类时存在问题。

这是连接类（DbConnect.php）：

```
 static $db_host =  '';
   static $db_user =  '';
   static $db_pswd =  '';
   static $db_name =  '';

   class database_DbConnect
     {
        private static $instance;
        public $db;

        /* Singleton */
        public static function singleton(){ 
            if (!isset(self::$instance)){ 
                $c              = __CLASS__; 
                self::$instance = new $c; 
            } 
            return self::$instance; 
        } 

        public function __clone() { trigger_error('Cloning not allowed.', E_USER_ERROR); }         
        public function __wakeup() { trigger_error('Unserializing is not allowed.', E_USER_ERROR); }

        /* Database initialisation */
        private function __construct()
        { 
            global $db_host, $db_user, $db_pswd, $db_name; 

            try { 
                @$this->db = new mysqli($db_host, $db_user, $db_pswd, $db_name); 

                if(mysqli_connect_error()){ 
                    throw new Exception('Database error:' . mysqli_connect_error()); 
                }
            } 
            catch( Exception $e ) { 
                print $e->getMessage(); 
            } 

            $this->db->set_charset('utf8'); 
        } 

        function __destruct() { $this->db->close(); } 

     } 
```

和数据库类（Db.php）：

```
 require_once('DbConnect.php');

   class database_Db
     {
         public $db;
         public $stmt = NULL;
         public $error;

         public function __construct(){
            $DB_connect       = database_DbConnect::singleton();
            $this->db = $DB_connect->db;
         }

         function __destruct(){
            if($this->stmt != NULL) $this->stmt->close();
         }

         function __call($func, $arg_array){

            switch($func){
                case 'num_rows':
                    if($arg_array != NULL){
                        $this->execute_query($arg_array);
                        $num_rows = $this->execute_result_info();

                        return $num_rows['num_rows'];
                    }

                    $result = $this->execute_num_rows();
                    return $result;
                break;
                case 'insert_id':
                    if($arg_array != NULL){
                        $this->execute_query($arg_array);
                        $num_rows = $this->execute_result_info();

                        return $num_rows['insert_id'];
                    }

                    $result = $this->execute_num_rows();
                    return $result;
                break;
                case 'query':
                    $this->execute_query($arg_array);
                    $result = $this->execute_result_array();
                    return $result;
                break;
            }

         }

         function __get($v){
            $num_rows = $this->execute_result_info();
            return $num_rows[$v];
         }

         private function execute_query($arg_array = NULL){
            //determine the types of arguments 

            $sql_query=array_shift($arg_array); // the first element is returned to sql_query and then removed 

            $types = null;

            foreach ($arg_array as $v) 
                { 
                switch ($v) 
                    { 
                    case is_string($v): 
                        $types.='s'; 

                        break; 

                    case is_int($v): 
                        $types.='i'; 

                        break; 

                    case is_double($v): 
                        $types.='d'; 

                        break; 
                    } 
                } 

            // prepare the query 
            print mysqli_connect_error(); 
            $this->stmt = $this->db->prepare($sql_query);

            // binding parameters if has any 
            try 
                { 

                $bind = null;

                if (isset($arg_array[0])) 
                    { 
                    array_unshift($arg_array, $types); 
                    $bind= call_user_func_array(array($this->stmt,'bind_param'),$this->makeValuesReferenced($arg_array)); 
                    }
                    else {
                        $this->has_arguments = false;
                    } 

                if ($bind) 
                    { 
                    $time_start=microtime(true); 
                    $this->stmt->execute(); 
                    $this->stmt->store_result(); 
                    $time_end=microtime(true); 
                    $time    =$time_end - $time_start; 
                    /*$this->log[]=array 
                        ( 
                        "query" => $sql_query, 
                        "time"  => $time 
                        ); */
                    } 
                else 
                    { 
                    throw new Exception('Binding error:' . $this->db->error); 
                    } 
                } 
            catch( Exception $e ) 
                { 
                print $e->getMessage(); 
                } 
            } 

        private function execute_result_info() 
            { 
            if ($this->stmt->affected_rows > 0) 
                { 
                $num_rows=$this->stmt->affected_rows; 
                } 
            else 
                { 
                $num_rows=$this->stmt->num_rows(); 
                } 

            $result['num_rows'] =$num_rows; 
            $result['insert_id']=$this->stmt->insert_id; 

            return $result; 
            } 

        private function execute_result_array() 
            {

            $result_fields  =   array();
            $result         =   array();

            try 
                { 
                if ($this->stmt->error) 
                    { 
                    throw new Exception('MySQLi STMT error:' . $this->stmt->error); 
                    } 

                $result_metadata=@$this->stmt->result_metadata(); 
                } 
            catch( Exception $e ) 
                { 
                print $e->getMessage(); 
                } 

            if (is_object($result_metadata)) 
                { 
                while ($field=$result_metadata->fetch_field()) 
                    { 
                    array_unshift($result_fields, $field->name); 
                    $params[]=&$row[$field->name]; 
                    } 

                call_user_func_array(array($this->stmt,'bind_result'),$params); 

                while ($this->stmt->fetch()) 
                    { 
                    $c = array();
                    foreach ($row as $key => $val) 
                        { 
                        $c[$key]=$val; 

                        } 

                    $result[]=$c; 
                    } 

                return $result; 
                } 
            elseif ($this->stmt->errno == 0) 
                { 
                return true; 
                } 
            else 
                { 
                return $this->stmt->errno; 
                } 
            }

        private function makeValuesReferenced($arr){
            $refs = array();
            foreach($arr as $key => $value)
                $refs[$key] = &$arr[$key];
            return $refs;
        }

     } 
```

初始化类工作正常，但每当我进行数据库查询时，它都会失败：

```
$markerQuery = "SELECT ID, lat, lng, title FROM profiles WHERE lat <> ? AND lng <> ? ";
$markerResult = $Database->query($markerQuery,'',''); 
```

我收到以下错误：

> 警告：call_user_func_array() 期望参数 1 是有效的回调，第一个数组成员不是 Db.php 第 114 行中的有效类名或对象
> 
> 绑定错误：未选择数据库
> 
> 注意：尝试在第 169 行获取 Db.php 中非对象的属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:52:23.707

该错误非常明确。在

```
call_user_func_array(array($this->stmt,'bind_result'),$params); 
```

该变量`$this->stmt`不是有效的回调（这意味着它不是一个类）。做一个`var_dump()`或那个变量，你会发现原因。

# javascript - 在页面加载时显示随机 div

> ID：11511018
> 
> 赞同：-1
> 
> 时间：2012-07-16T19:17:07.833
> 
> 标签：javascript, jquery, html

我一直在努力在点击链接时显示/隐藏一些 div：

[我的小提琴](http://jsfiddle.net/ultraloveninja/jBmH9/4/)

但是现在我正在尝试获取它，以便在加载页面时显示其中一个随机的 div。

我试着添加这个：

```
var $reviews = $(.hider ').hide();
$reviews.eq(Math.random()*$reviews.length).show();​ 
```

但是，它似乎打破了我之前所做的工作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:34:53.830

这是代码和[演示](http://jsfiddle.net/jBmH9/10/)：

```
<div id="brother-gallery" class="hider">Brother Content</div>
<div id="mitsu-gallery" class="hidden hider">Mitsu Content</div>
<div id="taki-gallery" class="hidden hider">Taki Content</div>

<br /><br />
<div id="brother-tag" class="hider">Brother Tagline</div>
<div id="mitsu-tag" class="hidden hider">Mitsu Tagline</div>
<div id="taki-tag" class="hidden hider">Taki Tagline</div>

<br /><br />
<p><a href="#" class="control" data-field="brother">Brother Link</a></p>
<p><a href="#" class="control" data-field="mitsu">Mitsu Link</a></p>
<p><a href="#" class="control" data-field="taki">Taki Link</a></p>
<p><a href="#" class="random">Random</a></p>

​

$('.control').on('click', function(e) {
    e.preventDefault();
    var field = $(this).data('field');
    $('.hider:visible').fadeOut("slow", function() {
        $('#' + field + '-gallery, #' + field + '-tag').fadeIn("slow");
    });
});

$('.random').on('click',function(e){
    var randomIndex = Math.floor((Math.random()*100)+1)%3;
    console.log(randomIndex);
    var field = $($('a').get(randomIndex)).data('field');
    $('.hider:visible').fadeOut("slow", function() {
        $('#' + field + '-gallery, #' + field + '-tag').fadeIn("slow");
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:37:09.820

尝试：

```
var reviews = $('.hider');
reviews.hide();
var index = Math.floor(Math.random * reviews.length);
reviews.eq(index).show(); 
```

您需要确保将整数值传递给 eq() 调用。

# javascript - HTML 5 倾斜代码

> ID：11511025
> 
> 赞同：5
> 
> 时间：2012-07-16T19:17:56.650
> 
> 标签：javascript, html

我需要使用 Javascript 模拟倾斜图像的效果，例如 Photoshop。你们知道如何在Javascript中做到这一点吗？

什么样的几何计算应用于`<canvas>`上下文？**我不能为此使用 CSS**，因为它必须动态修改。

![在此处输入图像描述](../Images/2a859a4d8cfcce56cad40b6f777e50f3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:25:58.320

CSS`transform: skew();`将在没有 Javascript 的情况下为您完成这项工作。

**演示：http:** [//jsfiddle.net/ThinkingStiff/MtWBy/](http://jsfiddle.net/ThinkingStiff/MtWBy/)

### 输出

![小猫](../Images/adade05283e16eeec757b40efa8df3be.png)

### CSS

```
#original {
    margin: 55px 10px 0 10px;
}

#vertical {
    margin: 30px 20px 0 0;
    transform:             skew( 0, -30deg );
        -ms-transform:     skew( 0, -30deg );
        -moz-transform:    skew( 0, -30deg );
        -o-transform:      skew( 0, -30deg );
        -webkit-transform: skew( 0, -30deg );
}

#horizontal {
    margin: 55px 0 0 0;
    transform:             skew( -30deg, 0 );
        -ms-transform:     skew( -30deg, 0 );
        -moz-transform:    skew( -30deg, 0 );
        -o-transform:      skew( -30deg, 0 );
        -webkit-transform: skew( -30deg, 0 );
}

.image {
    background-image: url( 'http://placekitten.com/100' );  
    border: 1px solid black;
    display: inline-block;
    height: 100px;
    margin-right: 20px; 
    vertical-align: top;
    width: 100px;  
} 
```

### HTML

```
<div id="original" class="image"></div>
<div id="vertical" class="image"></div>
<div id="horizontal" class="image"></div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:26:25.357

仅使用 CSS3 就可以做到这一点：

```
img {
  -webkit-transform: skew(45deg);
} 
```

**[现场示例](http://dabblet.com/gist/3124509)**

请注意，我只使用了 webkit，但对于所有其他现代浏览器都是一样的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T20:50:50.323

我找到了解决方案：[http ://www.w3schools.com/html5/playcanvas.asp?filename=playcanvas_transformb&preval=1,0,0,1,0,0](http://www.w3schools.com/html5/playcanvas.asp?filename=playcanvas_transformb&preval=1,0,0,1,0,0)

# javascript - 在 PyroCMS 中使用 jQuery 更新下拉列表的选定值

> ID：11511037
> 
> 赞同：1
> 
> 时间：2012-07-16T19:18:31.220
> 
> 标签：javascript, select, jquery-chosen, pyrocms

我在开发**PyroCMS**模块时遇到了一个小问题。

我想使用 jQuery 动态更新下拉列表。我想设置选定的选项，但它似乎不起作用，因为下拉列表不是浏览器的默认选项。

我试过这个：

```
$('select[name=item-type] option[value='+type+']').attr('selected', 'selected'); 
```

但用户界面没有更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T19:34:19.427

最后我找到了解决方案。

下拉自定义 UI 由一个名为[**Chosen**](http://harvesthq.github.io/chosen)的插件提供支持。

编辑 DOM 元素不会更新*Chosen 下拉 UI*，因为此插件不会动态监视其附加的`<select>`. 你需要明确地告诉 Chosen 你刚刚通过触发一个事件更新了 DOM。

直到版本`2.3`PyroCMS 使用 Chosen `0.9`，所以你可以触发这样的事件：

```
$('select.any-selector').trigger("liszt:updated"); 
```

* * *

要完整，选择`1.0`事件已更改，您必须使用：

```
$("select.any-selector").trigger("chosen:updated"); 
```

* * *

参考：

*   [https://forum.pyrocms.com/discussion/19059](https://forum.pyrocms.com/discussion/19059)
*   选择网站：[http ://harvesthq.github.io/chosen/](http://harvesthq.github.io/chosen/)
*   选择 Github 仓库：[https ://github.com/harvesthq/chosen](https://github.com/harvesthq/chosen)
*   Github [system/cms/themes/pyrocms/js/plugins.js上的 PyroCMS plugin.js](https://github.com/pyrocms/pyrocms/blob/2.3/develop/system/cms/themes/pyrocms/js/plugins.js#L331)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T11:11:52.003

我有解决方案

需要进行两项更改

采用

```
$('.selector').chosen().change(function() { 
}); 
```

代替

```
$('.selector').change(function() { 
}); 
```

当您想更新下拉菜单时，请使用

```
$('.selector').trigger("liszt:updated"); 
```

在这里你去......玩得开心！

# jquery - Ajax加载页面中的Jquery不起作用

> ID：11511040
> 
> 赞同：1
> 
> 时间：2012-07-16T19:18:50.723
> 
> 标签：jquery, ajax, load

我有一个使用 AJAX 加载不同页面的网站。加载工作正常，但一旦加载页面内的任何 Jquery 都不起作用。当用户单击导航按钮时，它应该在 div 中加载页面。我最初使用 HTML 标签创建了页面，并且只在页面内加载了特定标签，但我从加载的页面中删除了 html 和 body 标签，但仍然无法正常工作。

这是HTML

```
 <!DOCTYPE HTML>
    <html lang="en">
    <head>
    <meta charset="UTF-8">
    <title>Santex Group</title>
    <link href="_css/main_15.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="http://use.typekit.com/dcn6whd.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script src="js/jquery.scrollTo-min.js" type="text/javascript"></script>
    <script src="js/jquery.localscroll-min.js" type="text/javascript"></script>
    <script src="js/init.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/chili-1.7.pack.js"></script>
    <script type="text/javascript" src="js/jquery.easing.js"></script>
    <script type="text/javascript" src="js/jquery.dimensions.js"></script>
    <script type="text/javascript" src="js/jquery.infinite_carousel.js"></script>
    <script type="text/javascript">// <![CDATA[

        $(document).ready(function()
            {
                $('li#toServices').click(function()
                {
                $('#services').load('services.html #services-container');

                });
                $('ul#siteNav li#toServices').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: -140},
                   queue:true //one axis at a time
                });
            }); 

            $(document).ready(function()
            {
                $('li#toHow').click(function()

                {
                $('#how').load('how.html #how-container');

                });
                $('ul#siteNav li#toHow').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: -140},
                   queue:true //one axis at a time
                });
            }); 
            $(document).ready(function()
            {
                $('li#toWhy').click(function()

                {
                $('#why').load('why.html #why-container');

                });
                // Scroll the whole document
                $('ul#siteNav li#toWhy').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: -140},
                   queue:true //one axis at a time
                });
            }); 
            $(document).ready(function()
            {

            $('li#toClients').live('click', function()

                {
                $('#clients').load('clients.html');
            });
                $('ul#siteNav li#toClients').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: -140},
                   queue:true //one axis at a time
                });
            }); 
            $(document).ready(function()
            {
                // Scroll the whole document
                $('ul#siteNav li#toContact').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: 0},
                   queue:true //one axis at a time
                });
            }); 
            $(document).ready(function()
            {
                // Scroll the whole document
                $('ul#siteNav li#toCareers').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: -150},
                   queue:true //one axis at a time
                });
            }); 
                    $(document).ready(function()
            {
                // Scroll the whole document
                $('ul#siteNav li#toExtra').localScroll({
                   target:'body',
                   axis:'x',
                   offset: {left: -150},
                   queue:true //one axis at a time
                });
            }); 
    // ]]></script>  
    </head>
    <body>
    <header id="mainHeader">
       <div id="mainNav">
        <div id="logo">
        <a title="Home" href="#mainHeader"></a>
        </div>
        <div id="navWrapper">

        <ul id="phone-login">
          <li><a href="#">Call Us Toll Free (888) 622-7098</a></li>
          <li><a href="#">CLIENT LOGIN</a></li>

        </ul>

        <ul id="siteNav">
              <li id="toServices"><a class="star" href="#services">Services</a></li>
              <li id="toHow"><a href="#how">How</a></li>
              <li id="toWhy"><a href="#why">Why</a></li>
              <li id="toClients"><a href="#clients">Clients</a></li>      
              <li id="toContact"><a href="#contact">Contact</a></li> 
              <li id="toCareers"><a href="#careers">Careers</a></li> 

            </ul>
        </div>

      </div>
    <div class="header-writeup">
          <hgroup>
          <h1>Innovate. Create. Experience</h1>
            <h2>We embrace technology to empower people.</h2>
            <h3>We are driven by technology, focused on making better products and interfaces.  We are a full-service Global digital company that emphasized the importance of emerging technoloy solution sfor all types of clients.</h3>
          </hgroup>
       </div>
    </header>

    <div id="wrapper">
      <section id="services" class="scrolling-content">

      </section>
      <section id="how" class="scrolling-content"> </section>
      <section id="why" class="scrolling-content"> </section>
      <section id="clients" class="scrolling-content"> </section>
    <section id="contact" class="scrolling-content">

    </section>
    <section id="careers" class="scrolling-content">
        </section>
    </div>
    <footer id="pageFooter">
    </footer>

    </body>
    </html> 
```

这是我尝试加载的页面之一，它有一个加载时不起作用的 jquery 滚动条

```
 <div id="clients-container">
        <h1 class="section-heading">Clients</h1>
        <div class="section_container">

                <div class="infiniteCarousel">
                  <div class="wrapper">
                     <ul>
                      <li><img src="_images/clientlogos1.gif" height="146" width="950" alt="Clients and Relationships" /></li>
                       <li><img src="_images/clientlogos2.gif" height="146" width="950" alt="Clients and Relationships" /></li>
                     </ul> 
                  </div>
               </div>

               <div class="view-our-work-link">
                        <a class="button float-left" href="../content/our-work">View Our Work</a>    
               </div>
        </div>
    </div> 
```

这是现场直播：

[http://ernestosillas.com/santexgroupAJAX/index16.html](http://ernestosillas.com/santexgroupAJAX/index16.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-13T10:36:20.847

使用委托方式来解决这个问题。

这是因为您正在将事件绑定到文档准备就绪。您必须使用委托才能使其正常工作。喜欢上。这是因为您通过ajax加载的内容在加载时不在页面上。所以没有附加任何事件。

您的代码应该看起来像这样：

```
$('body').on('click','#clients-container',function(){
 alert("hello");
}); 
```

它不必是正文，而是在文档准备好后未加载的元素，它是#clients-container 的父元素

你有

```
<div id="clients-container">
</div> 
```

在主页面使用容器的父级使用委托方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T00:07:07.500

我遇到了类似的问题，这对我有用：

1.  确保脚本在服务器上运行或`.load()`函数不起作用

2.  试试看`$(document).ready( function()`，有时候这就是问题

3.  如果您想在通过函数`$.getScript`加载的外部页面上使用 jQuery，请尝试函数`.load`

4.  finally 使用`return(false)`jQuery 脚本末尾的函数，否则该脚本可能无法在 Opera、chrome 和 safari 中运行

5.  从您尝试加载的外部页面中删除任何 HTML、正文、头部标签等

希望这可以帮助任何有类似问题的人，这应该可以为您节省大量研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:28:00.457

尝试使用`on`而不是使用`click`，因为我可以看到您使用的是较新版本的 Jquery

```
$('li#toServices').on('body','click',function(){

// your code

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:26:25.307

如果您不受限制，请加载 jQuery 1.7.xx（只需在[http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js)中编写 1.7 而不是 1.3.2 ）并使用[jQuery.on()](http://api.jquery.com/on/)用于您的绑定，live() 非常[缓慢](http://jsperf.com/jquery-live-vs-delegate-vs-on/4)且[已弃用](http://api.jquery.com/live/)。

# c++ - 如何在 VS2010 中将 lambda 降级为函数指针？

> ID：11511046
> 
> 赞同：2
> 
> 时间：2012-07-16T19:19:32.157
> 
> 标签：c++, visual-studio-2010, visual-c++, c++11

这是我失败的尝试：

```
#define decltype(...) std::identity<decltype(__VA_ARGS__)>::type

template<typename T>
auto* degrade(const T& f) -> decltype(&T::operator())
{
    return &T::operator();
} 

int main()
{
    std::array<void(int), 1> stuff =
    {
        degrade([](int){})
    };
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:34:46.730

在你说的评论中，

> VS2010 不支持。- 我正在使用的库 Nawaz 有一个采用函数指针的方法，使用 lambda 会稍微干净一些（这没什么大不了的，但我想看看在 VS2010 中是否可行）

在这种情况下，您可以使用本地结构并在其中定义一个静态函数。[像这样的东西（如果它对你有帮助的话）](http://ideone.com/VT66v)：

```
#include <iostream>

void call(void (*f)(int))
{
    for(int i = 0 ; i < 10 ; i++)
         f(10 * i);
}

int main() 
{
    struct local
    {
        static void print(int i) { std::cout << i << std::endl; }
    };
    call(&local::print);
} 
```

它很方便 - 或多或少像 C++11 lambda。*您可以在本地*定义静态成员函数，并将其传递给其他函数。

# python - 使用 python 从服务器迭代一个 20+ gb 的大文件

> ID：11511047
> 
> 赞同：6
> 
> 时间：2012-07-16T19:19:37.720
> 
> 标签：python, paramiko, linux-mint

嗨，我在服务器上有大约 16 个 20+ gb 文件，我需要从中读取特定条目，如果我的计算机上保存了其中一个文件，我的代码可以以正确的顺序读取文件

```
f = open('biodayk1.H2009', 'rb')

lbl = array.array('f')

bio = 0 for day in range(iday):
    f.seek(nx*ny*km*bio*4, 1)
    lbl.read(f, nx*ny*km)    #reads the desired ibio
    f.seek(nx*ny*km*(10 - bio)*4, 1) #skips the next ibios 
f.close() 
```

现在我需要从服务器读取文件而不下载每个文件。我正在研究 paramiko 并能够连接到服务器，但我不太确定如何遍历文件并返回我想要的内容。如果您需要更多信息或需要我回答任何问题，请提出。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:23:57.273

你……在痛苦中。我建议您遵循 rsync 路线并编写一个在服务器上运行的脚本，该脚本提供您感兴趣的字节。您可以通过 paramiko 创建的文本通道与其通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-17T10:17:52.477

我建议`execnet`远程运行一些 Python（本地函数或模块）。

无需设置。

# javascript - jQuery UI Multi Date Picker 停止在日期选择上旋转月份

> ID：11511051
> 
> 赞同：0
> 
> 时间：2012-07-16T19:19:48.310
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-datepicker

请检查下面的小提琴。当在任何日历上选择日期时，接受第一个，控件旋转以使该日历成为第一个。我想停止这种行为。

[http://jsfiddle.net/URcqn/8/](http://jsfiddle.net/URcqn/8/)

我正在使用一个名为 Multi Date Picker 的插件，但它基本上是 jQuery Date Picker。当您选择第 2 个月或第 3 个月的日期时，控件会旋转月份以使我在第一个日历上选择日期。我怎样才能阻止这种行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:28:05.600

尝试使用具有您要求的功能的[Jquery Datepicker 。](http://keith-wood.name/datepick.html)就个人而言，我不喜欢 UI，但你可以用 Jquery-UI 替换它。

此外，该页面上的导航是：您将看到一些 n 个选项卡，选择“月份”选项卡并查看最后一个示例，它具有多日期选择器，具有停止月份轮换的行为。

代码可用... Njoy !!!

# java - 检查超类/接口方法和重写方法是否相等

> ID：11511055
> 
> 赞同：2
> 
> 时间：2012-07-16T19:19:56.817
> 
> 标签：java, reflection

我遇到过一种情况，我有一个`Method`来自接口定义的`Method`实例和一个来自实现类的相同方法的实例。

例如：

```
public interface Foo {
    void bar();
}

public class FooImpl implements Foo {
    public void bar() {
        System.out.println("foobar");
    }
} 
```

使用反射，我从接口获得了一个`Method`实例，并从. 本质上，我需要考虑这些相等，但显然该方法表明它们不相等。`bar``Foo``FooImpl``Methods``equals`

具体来说，我需要一种方法来确定`Method`通过反射获得的给定是否覆盖了超类/接口`Method`。

我目前正在使用一种解决方法，通过从给定类中找到“最少派生”方法来完全避免这种情况，但我想知道是否有更优雅的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:41:54.423

我没有在 equals 方法中考虑修饰符，但如果你想使用这个算法，这应该会让你相当接近：

```
package test;

import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.List;

public class TestFooBar {
@SuppressWarnings("rawtypes")
public static void main(String[] args) {
    try {
        // Get the class of interest
        Class fooImpl = Class.forName("test.FooImpl");

        // Test all the methods
        for(Method m : fooImpl.getMethods()) {
            boolean overriden = false;
            List<Class> parents = new ArrayList<Class>();
            for(Class c : fooImpl.getInterfaces()) {
                parents.add(c);
            }
            if(fooImpl.getSuperclass() != null) parents.add(fooImpl.getSuperclass());
            for(Class c : fooImpl.getInterfaces()) {
                for(Method sm : c.getMethods()) {
                    if(equals(sm, m)) {
                        overriden = true;
                        break;
                    }
                }
                if(overriden) break;
            }
            System.out.println(m+": "+(overriden ? "Overriden" : "Not overriden"));
        }
    }
    catch(Exception e) {
        e.printStackTrace();
    }
}

private static boolean equals(Method m1, Method m2) {
    if(!m1.getName().equals(m2.getName())) return false;
    String t1 = "";
    for(Class c : m1.getParameterTypes()) {
        t1+=c.getName()+"/";
    }
    String t2 = "";
    for(Class c : m2.getParameterTypes()) {
        t2+=c.getName()+"/";
    }
    if(!t1.equals(t2)) return false;

    return true;
}
} 
```

# android - 从 ADB/Shell 命令模拟强制停止

> ID：11511056
> 
> 赞同：13
> 
> 时间：2012-07-16T19:19:57.400
> 
> 标签：android, shell, adb

有没有办法使用当前的命令行工具（`adb`, `am`, `pm`）来模拟用户从设置应用程序中按下强制停止？从 shell调用`kill <pid>`只能很好地模拟系统终止进程时发生的情况，但强制停止通过删除`ActivityRecord`Android 保存的实例来删除应用程序的内存。

有没有我们可以调用的 shell 命令来模拟同样的行为？

干杯。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-16T19:26:35.573

使用**am**：

```
am force-stop: force stop everything associated with <PACKAGE>.

am kill: Kill all processes associated with <PACKAGE>.  Only kills.
  processes that are safe to kill -- that is, will not impact the user
  experience. 
```

例如：

```
adb shell am force-stop <PACKAGE> 
```

# ruby-on-rails - 服务器端设备检测

> ID：11511061
> 
> 赞同：1
> 
> 时间：2012-07-16T19:20:10.770
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1

Rails 开发人员在做些什么来检测服务器上的设备详细信息？似乎有一些旧的 WURFL 库，但最近没有。

我正在使用响应式设计，并且希望避免发送无论如何都会隐藏的图像，因为浏览器会显示它们。（有一些客户端解决方法，例如使用背景图像，但它们使客户端变得不必要地复杂。）

检测宽度特别有用，因为它对应于 Bootstrap 和类似的响应式框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:23:08.900

看看开源（最后一个标签是 rails 示例）。[http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T13:42:21.083

在这里聚会有点晚了，但我们确实有一个 Ruby 中的 WURFL 云客户端，可以满足您的需求。 [http://www.scientiamobile.com/cloud](http://www.scientiamobile.com/cloud)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T11:14:31.227

您可能想要查看的另一个开源检测软件是[51Degrees.mobi](http://51degrees.mobi?CATReferrer=1765)。他们有 PHP、C 和其他一些你可能会觉得有用的实现。

# php - 通过字符串 php 解析并替换子字符串

> ID：11511064
> 
> 赞同：2
> 
> 时间：2012-07-16T19:20:24.297
> 
> 标签：php, regex

我有一个字符串，在 PHP 中，该字符串出现了该模式`%%abc%%(some substring)%%xyz%%`

在主字符串中多次出现此类子字符串。这些事件中的每一个都需要用数组中的字符串替换， `array('substring1','substring2','substring3','substring4')`具体取决于 a 的响应，`function()`它返回一个 1 到 4 之间的整数。

我无法找到一种有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T19:27:34.387

这种情况需要[`preg_replace_callback`](http://php.net/manual/en/function.preg-replace-callback.php)：

```
// Assume this already exists
function mapSubstringToInteger($str) {
    return (strlen($str) % 4) + 1;
}

// So you can now write this:
$pattern = '/%%abc%%(.*?)%%xyz%%/';
$replacements = array('r1', 'r2', 'r3', 'r4');
$callback = function($matches) use ($replacements) {
    return $replacements[mapSubstringToInteger($matches[1])];
};

preg_replace_callback($pattern, $callback, $input); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:24:57.670

使用[`preg_replace_callback()`](http://php.net/preg_replace_callback)，像这样：

```
preg_replace_callback( '#%%abc%%(.*?)%%xyz%%#', function( $match) {
    // Do some logic (with $match) to determine what to replace it with
    return 'replacement';
}, $master_string); 
```

# asp.net-mvc - 在 ASP.NET MVC 3 中返回基于平台的不同视图

> ID：11511065
> 
> 赞同：0
> 
> 时间：2012-07-16T19:20:25.003
> 
> 标签：asp.net-mvc

我正在尝试让我的 Action 针对不同的平台返回不同的视图，同时尊重路由配置。有内置的东西可以处理这个吗？还是我需要创建一个自定义 ViewResult 来处理这个？我并不像渲染视图那样关心平台的实际检测。

例如：HomeController.About 操作将在计算机上显示 View\Home\About.cshtml，在平板电脑上显示 View\Home\AboutTablet.cshtml，在手机上显示 View\Home\AboutMobile.cshtml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:24:03.083

您需要编写自己的 ViewResult 以包含视图的映射（命名约定将使您的生活更轻松）。

另一种可能对您有用也可能不适用的想法。您可以将用户踢到[http://yoursite.com/tablet](http://yoursite.com/tablet)或[http://yoursite.com/mobile](http://yoursite.com/mobile)之类的地方，然后对所有页面使用不同的布局。

# python - 检查 Google App Engine 数据存储实体是否具有特定属性

> ID：11511070
> 
> 赞同：4
> 
> 时间：2012-07-16T19:21:14.667
> 
> 标签：python, database, google-app-engine, google-cloud-datastore, gql

我是使用 Google App Engine 开发网络应用程序的新手。

我想检查我的数据存储**中是否为列表属性**( `db.ListProperty`) 设置了空值的实体。但是，当我尝试根据`entity.list`GAE 检查任何内容时，会出现错误：

`'super' object has no attribute 'list'`.

经过一番搜索后，我在[这个 SO question](https://stackoverflow.com/questions/598605/appengine-query-datastore-for-records-with-missing-value)中看到，为 GAE 数据存储实体的列表属性设置一个空值等同于根本不设置该属性。这解释了我的错误。

所以我需要匹配数据存储中根本没有`list`设置任何属性的实体。查看 GAE 文档，我仍然没有找到任何方法可以让我检查实体是否具有特定的属性集。

**注意：**我不必对 GQL 执行此操作。我可以使用 GQL 检索所有实体，然后使用 python 检查。但是 GQL 解决方案也很好。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-16T19:50:46.617

我可以想到三种方法来解决这个问题。

您可能会遇到这种情况，因为最初您的模型没有“列表”属性，而您后来添加了一个，因此数据存储区中可能有较旧的实例而没有“列表”属性。您可以编写一个 mapreduce 函数来遍历您的数据存储并确保所有实体都具有“列表”元素。

否则，您可以使用 python hasattr 函数

```
if hasattr(entity, 'list'):
    a = entity.list[0] # or whatever operation you want 
```

第三，您可以使用异常处理程序来捕获错误情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T08:12:30.427

在 GQL 中没有办法做到这一点，它只能过滤现有值。相反，您应该使用某种形式的计算属性。NDB 支持这些，或者您可以覆盖 _pre_put 挂钩以将其他一些属性设置为，例如，列表的长度。这将允许您查询这个新属性 == 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T13:53:51.273

@dragonx 写的完全没问题。根据我的经验，最好使用 try-except 语句：

```
for q in query:
    try:
        q.someattribute
    except AttributeError:
        setattr(q, 'someattribute', True)  # or whatever operation you need 
```

# jquery - JQuery .validate 在一个while循环中

> ID：11511071
> 
> 赞同：1
> 
> 时间：2012-07-16T19:21:17.577
> 
> 标签：jquery, loops, while-loop

我遇到了一个问题，我在 while 循环中有表单，我正在尝试使用 JQuery 提交它们以从 mysql 数据库中删除条目。问题是当我按下删除时，无论我按下哪个删除按钮，它都会发送相同的 ID。

```
$("#deletePost").validate({
        debug: false,
        rules: {        
        },
        //If the rules are not met, the following messages are displayed beside the input field.
        messages: {
        },
        // do other stuff for a valid form
        submitHandler: function(form) {
            $.post('bin/Profile.php', $("#deletePost").serialize(), function(data) {
                $('#ProfileWall').prepend( data );
            });
        }
    });
}); 

            <div id='ProfileWall'>
            <?php 

                $WallRequest = mysql_query("SELECT * from WallPost where WallOf = '".$sn."' group by TimeAndDate DESC;")or die(mysql_error());
                while($WallInformation = mysql_fetch_array($WallRequest))
                {
                    $PostedBy =  mysql_fetch_array(mysql_query("SELECT * from members where ServiceNumber = '".$WallInformation['PostedBy']."';")); 
            ?>      

                        <div id = "post_<?php echo $WallInformation["id"]; ?>" >    
                        <form name = 'deletePost' id = 'deletePost' method = 'post'>
                        <table border = '0' width = '550' height = '60' valign = 'top'    align = 'center'>
                            <tr valign = 'center'>
                                <td width = '10' valign = 'center'>
                                    <input type = "hidden" name = "id" id = "id" value = "<?php echo $WallInformation['id']; ?>" >
                                    <input type = "hidden" name = "sn" id = "sn" value = "<?php echo $sn; ?>" >
                                    <input type = "submit" name="Delete" id = "Delete" value="Delete" class="delete" />
                                </td>
                            </tr>
                        </table>
                        </form>
                        </div>

          <?php } ?>
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:45:13.480

问题是您总是在您的 submitHandler 中序列化相同的表单。您可以考虑在标记 ( >)`$('#deletePost')`中为每个条目提供具有相同类的唯一ID，而不是按 ID进行选择，然后使用仅选择要在 submitHandler 中提交的 .deletePost 实例。`<form id="$generate_a_unique_id_and_put_it_here" class="deletePost"``$(this)`

# c# - 强制视觉样式

> ID：11511074
> 
> 赞同：0
> 
> 时间：2012-07-16T19:21:24.037
> 
> 标签：c#, winforms

我有一个要使用视觉样式的应用程序，并且我有 Application.EnableVisualStyles(); 在程序中，但我有一些客户使用带有经典 Windows 主题的 Windows XP，因此这些机器上不会显示视觉样式。无论 Windows 主题是什么，有什么方法可以“强制”视觉样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:33:18.360

这是由 RenderWithVisualStyles 属性检测到的 - 而这又由列出的各种因素控制 - 请参阅[文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.renderwithvisualstyles.aspx)。

如果你想强制你的风格，你可以考虑[覆盖](http://support.microsoft.com/kb/830033)一些主题行为。

# android - Android-屏幕链接不起作用

> ID：11511076
> 
> 赞同：0
> 
> 时间：2012-07-16T19:21:30.533
> 
> 标签：android, button, imagebutton

我正在创建的应用程序在主屏幕上有两个按钮，然后链接到另一个屏幕。但是，当我链接到另一个屏幕时，我确实显示了 xml 文件，但与该文件关联的类似乎不起作用。就像我在另一个屏幕上的按钮没有做他们应该做的事情（我有一个不返回主页的后退按钮，以及一个不链接到 video.xml 屏幕的图像按钮）。

有谁知道这个问题？

Main_Activity.java

```
 import android.app.Activity;
    import android.content.Intent;

    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;

    import android.widget.Button;

    public class MainActivity extends Activity {

    @Override
        public void onCreate(Bundle savedInstanceState) 
    {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);

    final Button videoNext = (Button) findViewById(R.id.videoButton) ; 

    videoNext.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

Intent myIntent = new Intent(MainActivity.this, Screen2.class);
        MainActivity.this.startActivity(myIntent);
        //setContentView(R.layout.screen2xml);
        }
    });

    Button newsNext = (Button) findViewById(R.id.newsButton);
    newsNext.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

         Intent myIntent = new Intent(MainActivity.this, Screen1.class);
        MainActivity.this.startActivity(myIntent);
        //setContentView(R.layout.screen2xml);
        }
    });
    }

    } 
```

画面2.java

```
import android.os.Bundle;

import android.app.Activity;

import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageButton;

public class Screen2 extends Activity {

  public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.screen2xml);

    Button back = (Button)this.findViewById(R.id.backButton);
    back.setBackgroundColor(5);
    back.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
        setContentView(R.layout.activity_main);
        //finish();

            //Intent intent = new Intent(SImpleRssReader2Activity.this, rahul.SRR2.SimpleRssReader2.Screen1.class); 
        //startActivity(intent);

        }
    });

    ImageButton vid1 = (ImageButton)this.findViewById(R.id.imageButton1);
    vid1.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
        setContentView(R.layout.video);

        //finish();

            //Intent intent = new Intent(SImpleRssReader2Activity.this, rahul.SRR2.SimpleRssReader2.Screen1.class); 
        //startActivity(intent);

        }
    });

    }
} 
```

screen2xml.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:paddingBottom="2dp"
    android:paddingLeft="2dp"
    android:paddingRight="2dp"
    android:paddingTop="2dp" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/backButton" />

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:ems="10"
        android:inputType="textMultiLine" />

    <EditText
        android:id="@+id/editText3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText1"
        android:layout_alignParentBottom="true"
        android:layout_marginBottom="120dp"
        android:ems="10"
        android:inputType="textMultiLine" >

        <requestFocus />
    </EditText>

    <ImageButton
        android:id="@+id/imageButton1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/button1"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="23dp"
        android:background="@drawable/ic_button1"
        android:src="@drawable/ic_button1" android:contentDescription="TODO"/>

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText1"
        android:layout_below="@+id/imageButton1"
        android:layout_marginTop="81dp"
        android:ems="10"
        android:inputType="textMultiLine"
        android:text="@string/text" />

</RelativeLayout> 
```

Video1.java

```
import java.io.File;

import android.net.Uri;

import android.os.Bundle;
import android.os.Environment;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.graphics.PixelFormat;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.MediaController;
import android.widget.VideoView;

import android.media.AudioManager;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnPreparedListener;

public class Video1 extends Activity {

    VideoView videoView;
    @Override
public void onCreate(Bundle savedInstanceState) 
    {
    super.onCreate(savedInstanceState);

    videoView = (VideoView) findViewById(R.id.videoView1);
    MediaController mediaController = new MediaController(this);
    mediaController.setAnchorView(videoView);
//Set video link (mp4 format )
    Uri video = Uri.parse("http://vimeo.com/15615625");
    videoView.setMediaController(mediaController);
    videoView.setVideoURI(video);

     videoView.start();
     setContentView(R.layout.video);

    }
@SuppressLint("ParserError") @Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

} 
```

视频.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

</LinearLayout> 
```

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.wunapp.newsvideoapp"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="12"
        android:targetSdkVersion="15" />
<uses-permission android:name="android.permission.INTERNET"></uses-permission>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Screen1">

        </activity>
        <activity
            android:name=".Screen2">

        </activity>

        <activity
            android:name=".video">

        </activity>
        </application>

</manifest> 
```

我也收到了这个 logcat 错误（在实现了评论中所做的更改之后）

07-16 15:46:01.259: E/AndroidRuntime(15421): 致命异常: main 07-16 15:46:01.259: E/AndroidRuntime(15421): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com. wunapp.newsvideoapp/com.wunapp.newsvideoapp.Screen2}: java.lang.NullPointerException 07-16 15:46:01.259: E/AndroidRuntime(15421): at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2205) 07 -16 15:46:01.259: E/AndroidRuntime(15421): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2240) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在 android.app .ActivityThread.access$600(ActivityThread.java:139) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1262) 07-16 15: 46:01.259: E/AndroidRuntime(15421): 在 android.os.Handler.dispatchMessage(Handler.java:99) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在 android.os.Looper.loop(Looper.java:154) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在android.app.ActivityThread.main(ActivityThread.java:4977) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在 java.lang.reflect.Method.invokeNative(Native Method) 07-16 15:46 :01.259: E/AndroidRuntime(15421): at java.lang.reflect.Method.invoke(Method.java:511) 07-16 15:46:01.259: E/AndroidRuntime(15421): at com.android.internal。 os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 07-16 15:46:01.259: E/AndroidRuntime(15421): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551) 07 -16 15:46:01.259: E/AndroidRuntime(15421): at dalvik.system.NativeStart.main(Native Method) 07-16 15:46:01.259: E/AndroidRuntime(15421): Caused by: java.lang. NullPointerException 07-16 15:46:01.259:E/AndroidRuntime(15421): 在 com.wunapp.newsvideoapp.Screen2.onCreate(Screen2.java:30) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在 android.app.Activity.performCreate(Activity .java:4538) 07-16 15:46:01.259: E/AndroidRuntime(15421): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1071) 07-16 15:46:01.259: E/AndroidRuntime(15421 ): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2161) 07-16 15:46:01.259: E/AndroidRuntime(15421): ... 11 更多E/AndroidRuntime(15421): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2161) 07-16 15:46:01.259: E/AndroidRuntime(15421): ... 11 更多E/AndroidRuntime(15421): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2161) 07-16 15:46:01.259: E/AndroidRuntime(15421): ... 11 更多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:30:18.930

当您单击 videoNext 时，您只是将 screen2 的 xml 加载到 MainActivity 中。

```
setContentView(R.layout.screen2xml); 
```

如果您想加载 Screen2 活动，则需要以您已注释掉的意图启动它。这样，将显示第二个活动并正确使用 screen2 的 xml。像这样：

```
Intent myIntent = new Intent(MainActivity.this, Screen2.class);
MainActivity.this.startActivity(myIntent); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:25:41.003

而不是下面的代码

```
videoNext.setOnClickListener(new OnClickListener() { 
```

利用`videoNext.setOnClickListener(new View.OnClickListener() {`

它需要 View.onclickListener。

和

而不是打电话

```
setContentView(R.layout.screen2xml); 
```

你应该通过 startActivity(intent) 开始一个新的活动；方法，并在此活动中显示此布局。不建议多次使用 setContentView。

# python - 如何将数学运算应用于python列表中的每个数字？

> ID：11511080
> 
> 赞同：12
> 
> 时间：2012-07-16T19:21:55.387
> 
> 标签：python, python-3.x

我是python的初学者（一周）。在这里，我正在尝试打印 60 的所有主要因子的列表。但是对于第 19 行，我收到以下错误： *TypeError: unsupported operand type(s) for %: 'float' and 'list'*

编码：

```
whylist = []
factor = []
boom = []
primefactor = []
n = 60
j = (list(range(1, n, 1)))

for numbers in j:
    if n%numbers == 0:
        whylist.append(numbers)
        for everynumber in whylist:
            factor.append(everynumber)

for things in factor:
    u = (list(range(1, things, 1)))
    d = float(things)
    if d%u == 0:
        boom.append(things)
    if len(boom) == 1:
        for every in boom:
            primefactor.append(every)
print(primefactor) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-16T19:24:49.223

要将数学运算应用于列表中的每个元素，您可以使用列表理解：

```
new_list = [ x%num for x in old_list] 
```

还有其他方法可以做到这一点。有时人们会使用`map`

```
new_list = map(lambda x: x%num, old_list) 
```

但是大多数人更喜欢第一种形式，它通常比使用更有效和更清晰`lambda`（当你刚开始学习 python 时可能会有点混乱）。

**编辑**

这是您尝试的递归实现：

```
def factorize(n):
    out=[]
    for i in range(2,n):
        if(n%i == 0): #first thing to hit this is always prime
            out.append(i) #add it to the list
            out+=factorize(n/i)  #get the list of primes from the other factor and append to this list.
            return out
        else:
            return [n] # n%i was never 0, must be prime.

print factorize(2000) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:32:31.717

另一种选择是使用 numpy 数组而不是列表。

```
import numpy as np
j = np.arange(1,n,1)
rem = np.mod(j,num) 
```

numpy 将为您处理广播操作。它也应该比列表推导或地图更快。

# python - Kodos & “不能指代开放组”

> ID：11511083
> 
> 赞同：4
> 
> 时间：2012-07-16T19:22:09.747
> 
> 标签：python, regex, regex-group

我只想匹配 1010 或 0101，但既不匹配 1111 也不匹配 0000。我使用以下正则表达式：

```
\b((1|0)(?!\2))+ 
```

它在 Kodos 中运行良好，但由于 group()，我也想要匹配的序列。我试过了 ：

```
\b(((1|0)(?!\2))+) 
```

但是 Kodos 中显示“无法引用开放组*”，我不明白为什么它不起作用。

请问你能帮我吗？

编辑：适当的正则表达式是`(\b(((1|0)(?!\3))+)`.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T19:43:02.663

我认为问题在于您的第二个代码行中有三个单独的组。它们根据左括号的顺序进行编号。

```
Group 1: ((1|0)(?!\2))+
Group 2: (1|0)(?!\2)
Group 3: 1|0 
```

如您所见，组 2 包含对其自身的引用，但在解析时它仍然是打开的。

# jquery - 当孩子悬停时，悬停事件触发两次

> ID：11511085
> 
> 赞同：3
> 
> 时间：2012-07-16T19:22:10.520
> 
> 标签：jquery, html, css

我正在模拟一个简单的多级下拉框，并且无法弄清楚如何在 a 悬停时仅触发一次悬停事件`li`。`a`当列表项内的标签悬停时，悬停事件会触发两次。

这是一个演示问题的 jsFiddle。我在`a`标签周围添加了额外的填充，以显示事件如何被触发两次。如果只是悬停填充，事件将触发一次，但一旦`a`标签悬停，它将再次触发。

HTML：

```
<ul class="dropit">
    <li><a href="#">Thing 1</a></li>
    <li><a href="#">Thing 2</a></li>
    <li><a href="#">Thing 3</a>
      <ul>
        <li><a href="#">Sub-thing 1</a></li>
        <li><a href="#">Sub-thing 2</a>
           <ul class='sub-menu'>
            <li><a href="#">Sub-sub-thing 1</a></li>
            <li><a href="#">Sub-sub-thing 2</a></li>
          </ul>
        </li>
      </ul>
    </li>
</ul> 
```

jQuery：

```
$(document).ready(function(e) {
    $('ul.dropit li').on('mouseover', function(event) {
        $target = $(event.currentTarget);
        $sub = $target.children('ul').first();
        $sub.slideToggle();
    }).on('mouseout', function(event) {
        $target = $(event.currentTarget);
        $target.children('ul').first().slideToggle();
    });
}); 
```

[jsFiddle 演示](http://jsfiddle.net/5ENy4/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T19:29:19.027

使用`mouseenter`and`mouseleave`代替`mouseover`and`mouseout`

[小提琴](http://jsfiddle.net/5ENy4/1/)

```
$(document).ready(function(e) {
    $('ul.dropit li').on('mouseenter', function(event) {
        $target = $(event.currentTarget);
        $sub = $target.children('ul').first();
        $sub.slideToggle();
    }).on('mouseleave', function(event) {
        $target = $(event.currentTarget);
        $target.children('ul').first().slideToggle();
    });
});​ 
```

`mouseover`当您将鼠标悬停在子元素上时将触发。

`mouseenter`无论有多少孩子悬停，都只会触发一次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T19:34:45.357

***[jsFiddle 演示](http://jsfiddle.net/3dUpN/4/)***

只需使用`.hover()`

此外，为了防止重复悬停运动**时出现难看的幻灯片堆积，请使用：**`.stop()`

```
$('.dropit li:has("ul")').hover(function() {
    $('>ul', this).stop().slideToggle();
}); 
```

# php - 在不影响应用程序的情况下“更改”MySQL 中所有现有的和新的行 ID

> ID：11511087
> 
> 赞同：2
> 
> 时间：2012-07-16T19:22:16.087
> 
> 标签：php, mysql, php-5.3

我的数据库有大约 100 个表，每个表有 1,000 到 20,000 行。每个表都有一个名为 id 的主键 - 例如，在引用表中的行时，我只是使用 id`www.domain.com/viewuser.php?id=3`

我很确定我的代码中没有对行 ID 的硬编码引用，它们都引用了用户登录时设置的 POST 值或会话 ID。

是否可以轻松地将所有现有表的 id 从自动递增整数更改为唯一的字母数字 id，而不会导致大量重新编码或更改现有查询等？如果是这样，我会怎么做？

我的想法是手动更新我所有的表，但这也需要更改每个插入？我可以对介于两者之间的 unique_id 表做些什么，尽管我认为这可能需要更新所有查询？希望有一个简单的方法来做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:38:25.050

在数据库中随机化 id 值（将它们从 auto_increment 整数更改为字母数字）并不能真正解决根本问题。

即使您设法随机化和混淆 id 值，用户仍然可以通过 URL 操作访问其他用户的数据。您要做的就是让任何特定的 URL 操作尝试成功返回被禁止的数据“不太可能”。

如果您的应用程序需要阻止某些用户看到某些数据，那么您的应用程序需要提供一个真正的机制来做到这一点。

混淆 ID 值将是一大堆工作，最终，它不会完成*真正*需要做的事情。

（请参阅 Sabeen Malik、draw010、Justin Swartsel 的评论，他们都“正确”。）

* * *

如果您的应用程序已经实现了防止访问禁止数据的机制，则不需要对 ID 值进行混淆。

这些 ID 值真正需要混淆的唯一地方是在 URL（或 POST）中，并且可以在不更改现有数据库的情况下实现。（请参阅 Sabeen Malik 的评论；可以加密/解密发送到浏览器/从浏览器发送的 id 值......如果浏览器中运行的 javascript 取决于 id 值是“可订购的”，则存在的大问题.. .)

* * *

我知道这可能不是您在原始问题中寻找的答案。`id INT AUTO_INCREMENT`但如果没有充分的理由，我不会努力改变价值观。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:32:47.753

如果没有深入了解您的应用程序，这实际上是不可能准确回答的。我可以告诉你的是，一切都可以完成，但这取决于你的代码结构。您使用的是良好的 MVC 布局还是廉价的毯子样式代码？

我真诚地希望你有一个类似 MVC 的系统，你的模型都集中在几个文件中，否则维护起来会变得很糟糕，并确保你得到了应用程序的所有位置。

# java - 使用各种字段递归解析字符串的最佳方法

> ID：11511092
> 
> 赞同：0
> 
> 时间：2012-07-16T19:22:27.850
> 
> 标签：java, parsing, recursion

我需要解析每个值的输入。输入大小不是静态的

```
{"ruleId": 1000000,  "Group": "foo",  "Formula":    {"Aggregate": "foo",    "fields": 
    ["foo", "foo"],    "Children": 
    {"child": 
      []
    }   } } 
```

其中每个**孩子**可以包含一个**公式**列表，每个**公式**可以有一个**孩子**

解析这个的最佳方法是什么，以便我可以获得每个值并在需要时递归地挖掘“孩子”？

拆分、正则表达式、分词器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:32:05.810

不要自己解析它使用现有的库，如：

谷歌 Gson：[http ://code.google.com/p/google-gson/](http://code.google.com/p/google-gson/)

您可以在此处阅读有关 java 的不同 json 解析器的更多信息： [https ://stackoverflow.com/questions/338586/a-better-java-json-library](https://stackoverflow.com/questions/338586/a-better-java-json-library)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:32:40.817

您显示的数据采用 JSON 格式。您可以使用[java JSON 解析器](http://www.json.org/java/)，它将返回包含终端数据字段（JSON 对象）或父数据字段（JSON 数组）的提取数据对象。查看[此](http://www.androidhive.info/2012/01/android-json-parsing-tutorial/)示例的第 2 步，了解如何执行此操作。

[此外，您可以在此处](http://www.docjar.com/jar_detail/json-org.jar.html)下载 .jar 库进行解析

# java - Java InputStream.skip() 在文件末尾附近返回值

> ID：11511093
> 
> 赞同：1
> 
> 时间：2012-07-16T19:22:30.800
> 
> 标签：java, inputstream

我正在运行以下代码：

```
public class SkipTest {
    public static void main(String[] args) throws IOException {
        FileOutputStream fileout = new FileOutputStream("./foo");
        DataOutputStream output = new DataOutputStream( fileout );
        output.writeLong(12345678L);
        output.writeLong(87654321L);
        output.writeInt(1234);
        output.flush();
        output.close();

        FileInputStream input = new FileInputStream("./foo");
        DataInputStream datain = new DataInputStream(input);

        System.out.println(datain.readLong());
        System.out.println(datain.readLong());

        long skipped = datain.skip(8);
        System.out.printf("Attempting to skip 8 bytes, actually skipped %d.\n", skipped);

        datain.close();
    }
} 
```

根据文档，返回值`.skip()`是实际跳过的字节数，可能小于请求的数量。我已经验证该文件在外部只有 20 个字节，但是当我运行上面的代码时，我得到以下输出：

```
12345678
87654321
Attempting to skip 8 bytes, actually skipped 8. 
```

那么这是一个错误还是我做错了什么？当文件中只剩下 4 个字节时，它如何跳过 8 个字节？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:37:03.757

DataInputStream 正在通过 FileInputStream 向下传递，该 FileInputStream 声明其跳过的实现如下：

“此方法可能会跳过比支持文件中剩余的字节更多的字节。这不会产生异常，并且跳过的字节数可能包括超出支持文件的 EOF 的一些字节数。尝试在跳过后从流中读取过去end 将导致 -1 指示文件的结尾。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:35:53.930

您可以跳过 a 中任意数量的字节`FileInputStream`，显然无需读取任何内容。它只会重新定位光标，然后下一次读取将失败。试试`datain.skip(Integer.MAX_VALUE)`。

# cygwin - 在 Cygwin 下运行的程序创建的 *.stackdump 文件在哪里？

> ID：11511094
> 
> 赞同：1
> 
> 时间：2012-07-16T19:22:32.140
> 
> 标签：cygwin, stack-dump

我运行一个自动测试系统，它使用一些外部工具来进行测试。如果其中一个崩溃 - 尽管该工具本身不是我正在测试的 - 我想保存`foo.exe.stackdump`创建的文件。但是，我一直无法找到关于创建此文件的位置的明确答案。我的假设是它会在工作目录中（但我无法验证，因为该目录会在测试之间自动清除）并且我无法在线找到明确的答案。我在 Windows 7 上使用 Cygwin 1.7.7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T11:46:11.697

根据我的经验，它们是在工作目录中创建的。

也就是说，您是否尝试过禁用自动清除并看看会发生什么？这将为您提供针对您的具体情况的即时且可验证的结果。

# magento - Magento 小部件 - 新的小部件实例块参考错误

> ID：11511096
> 
> 赞同：4
> 
> 时间：2012-07-16T19:22:42.000
> 
> 标签：magento

如果我的目标是在布局句柄以外的任何内容中引用的块，则`default`新小部件实例页面（CMS > 小部件 > 创建新小部件实例）中的“块引用”选择框只能通过 ajax 控制器获取这些块当“页面”选择框更改时被触发。

因此，如果我有一个引用 cms_index_index 布局句柄的块，并且我创建了一个新的小部件实例，该实例将一个小部件放置在此块中，那么每次我在管理员中单击该小部件实例时，块引用下拉列表就会失去它的价值。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T07:41:39.590

看起来这是 Varien JS 库中的一个错误。

我们通过扩展`Varien_Data_Form_Element_Editor`和应用修复（在方法的行尾添加斜杠（`widget_target_id/` 而不是`widget_target_id`）来修复它`_getPluginButtonsHtml()`。请参阅下面的固定行；

`'onclick' => "widgetTools.openDialog('" . $this->getConfig('widget_window_url') . "widget_target_id/"`

# java - 字节类在 java 的泛型中不起作用

> ID：11511097
> 
> 赞同：2
> 
> 时间：2012-07-16T19:22:48.477
> 
> 标签：java

我的代码是：-

```
class abc<T> {
    T a, b;
    abc(T p, T q) {
        a = p;
        b = q;
    }
    void disp() {
        System.out.println("\na = " + a);
        System.out.println("b = " + b);
        System.out.println("a/b is of class type : " + a.getClass().getName());
    }
}

class temp {
    public static void main(String...args) {
        abc<Integer> a1;
        a1 = new abc <Integer>(11, 22);
        abc<Byte> a2 = new abc <Byte>(50,5);
        a1.disp();
        a2.disp();
    }
} 
```

输出：-

```
temp.java:23: cannot find symbol
symbol  : constructor abc(int,int)
location: class abc<java.lang.Byte>
            abc <Byte> a2 = new abc <Byte> (50,5);
                            ^
1 error 
```

请帮我解决这个问题。我是java新手，所以学习泛型。

在这段代码中，我使用了 Integer、Float、Double、String 都可以正常工作，但是当我进入 Byte 类时，编译器会抛出错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:24:51.253

这个怎么样？

```
abc <Byte> a2 = new abc <Byte> ((byte)50, (byte)5); 
```

您作为数字文字提供的参数是整数类型，并且这些参数会自动装箱到 java.lang.Integer，这就是为什么最初找不到相应方法的原因，除非您明确说明您的文字是字节类型。

# javascript - $("input[type=username]").val() 返回未定义

> ID：11511099
> 
> 赞同：2
> 
> 时间：2012-07-16T19:22:50.470
> 
> 标签：javascript, jquery, html, ajax

我正在为我的网站创建一个 AJAX 登录表单；但是，我遇到了一些我认为是 jQuery 中的错误。

代码示例：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Log In</title>
    </head>
    <body>
        <div class="errors"></div>
        <input type="username" placeholder="username">
        <input type="password" placeholder="password">
        <input type="submit" value="Log In">
    </body>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
    <script>
        $('input[type=submit]').click(function(){
            $(".errors").load(window.location.protocol + "//" + window.location.host + "?username=" + $("input[type=username]").val() + "&password=" + $("input[type=password]").val());
            return false;
    });
    </script>
</html> 
```

我知道这不是服务器端问题。的返回值`$("input[type=username]").val()`是`undefined`，而 的返回值`$("input[type=password]").val()`是输入的值。谢谢大家！:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T19:24:17.490

`username`不是有效的`type`属性值。我猜你想要`text`的是，这就是浏览器在遇到无法识别的类型时默认设置的内容。因此，当您的代码运行时，`input`实际的类型是`text`，而不是`username`。

请参阅[规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-input-element.html#attr-input-type)`type`以获取有效属性值的完整列表。

* * *

旁注 - 将您的 jQuery 版本升级到 1.3.2 或（最好）以上将解决这个问题。我会尽快离开您目前使用的古老的 1.2.6！

在此处查看[工作版本（jQuery 1.7.2）](http://jsfiddle.net/jamesallardice/t8NEr/)。`undefined`正如您在问题中所说，将包含的 jQuery 版本更改为 1.2.6 并且它将记录。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T19:24:28.413

`"username"`不是有效的`type`，它将被视为`"text"`

使用`name="username"`and`$("input[name=username]")`代替

[这是有效类型的列表](https://developer.mozilla.org/en/HTML/Element/Input#attr-type)

# c - 在 C 中制作函数树

> ID：11511100
> 
> 赞同：1
> 
> 时间：2012-07-16T19:22:54.050
> 
> 标签：c, tree, evolutionary-algorithm, genetic

我想在 C 中创建一个函数树，如下所示： [http ://scr.hu/5rq/vdja0](http://scr.hu/5rq/vdja0)

所以基本上我希望结果是这样的：[http ://scr.hu/5rq/f04uu](http://scr.hu/5rq/f04uu)

where`x`是我可以提供的变量（浮点数）。F0 到 F6 是带有两个参数的随机函数（例如乘法、加法或给出随机数的函数）。所以我的确切问题是：我怎么能做到这一点？我知道可以通过将每个函数给出的精确值存储在数组中来轻松完成。但是，当涉及到获得不同的“x”值时，它就变得复杂了。我最初的想法是创建一个函数，将随机函数附加到树中的每个节点，但是，我不确定应该如何完成构建该树的结构，

```
typedef struct drzewo typ;

struct drzewo {
    typ *right;
    typ *left;
    typ *up;
    float *value; //what to do with this ?
}; 
```

我想以某种方式更改行“float *value;” 放入可以存储类似`Function1(left->value,right->value);`但未运行的函数的东西，而不是具有给定参数的函数的确切值，以及 where `Function1()`or`Function2()`表示将两个参数相除或相乘的函数等等。

不，这不是为了学校，是的，这是我使用基因编程的悲惨尝试。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:28:49.083

要创建指向函数的类型，请使用函数原型并将函数名称替换为`(*<typename>)`. 所以如果你有一个`foo`看起来像这样的函数：

```
float foo( int arg1, char *arg2 ); 
```

您可以使用以下方法创建一个类型“foo_fn”，它是指向像 foo 这样的函数的指针：

```
typedef float (*foo_fn)( int, char * ); 
```

然后将其存储在您的结构中，例如：

```
typedef struct drzewo typ;
struct drzewo {
    typ *right;
    typ *left;
    typ *up;
    foo_fn fn_ptr;
}; 
```

如果您想拥有一个包含各种类型函数的结构（可能具有不同的返回类型或采用不同的参数），您可能只想将它们存储为`void *`并在您想要调用它们时将它们转换为正确的函数指针类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:14:58.137

您可以从以下内容开始：

```
typedef enum Operation
{
    VALUE,                                      // 0 argument (uses value)
    NOT, SIN, COS, TAN                          // 1 argument
    ADD, SUB, DIV, MUL, POW, LOG, AND, OR, XOR, // 2 argument
    SENTINEL;                                   // the last element
}
Operation;

typedef struct ExprNode
{
    Operation op;
    struct ExprNode * left;
    struct ExprNode * right;
    float value;
}
ExprNode;

typedef float (* EvalFunc)(ExprNode *);

EvalFunc eval_array[SENTINEL]; // array size is number of operations in enum 
```

然后您可以将其放入某种通用包装函数中，并从您将在一分钟内编写的专用 EvalFunc 函数中调用该包装器：

```
float EVAL(ExprNode * node)
{
    return eval_array[node->op](node);
}

// for bonus points, use a #define
// #define EVAL(node) eval_array[node->op](node) 
```

从那里，您将需要一堆具有与 EvalFunc 匹配的签名的函数，例如这个最简单的函数，它适合与 VALUE 说明符一起使用：

```
float Eval_Value(ExprNode * node)
{
    return node->value;
} 
```

或者这个稍微更深入（但仍然很简单）的一个，它确实增加了：

```
float Eval_Add(ExprNode * node)
{
    return EVAL(node->left) + EVAL(node->right);
} 
```

您现在可以将所有这些函数放入`eval_array`数组中，以便通过索引查找快速调用它们，如下所示：

```
eval_array[VALUE] = &Eval_Value;
eval_array[ADD]   = &Eval_Add;
// etc 
```

您可能希望为 ExprNodes 包含某种初始化函数，以消除初始化它们的乏味：

```
ExprNode_init(ExprNode * node, Operation _op, float _value, ExprNode * _left, ExprNode * _right)
{
    node->op    = _op;
    node->left  = _left;
    node->right = _right;
    node->value = _value;
} 
```

然后，您将所有原型复制到某个头文件中，并在需要的任何地方#include 它。您将能够构建表达式链并以下列方式评估它们：

```
ExprNode n1, n2, n3, X, Y, Z;
ExprNode_init(&n1, SUM,   0, &n2,  &n3 ); // expression nodes: value is ignored
ExprNode_init(&n2, MUL,   0, &X,   &Y  ); // some functions only require 1 arg
ExprNode_init(&n3, DIV,   0, &Z,   &Y  ); // right can be omitted for these

ExprNode_init(&X,  VALUE, 3, NULL, NULL); // value nodes: value is not ignored
ExprNode_init(&Y,  VALUE, 4, NULL, NULL); // left and right are both ignored
ExprNode_init(&Z,  VALUE, 6, NULL, NULL); // both can be null

float result = EVAL(n1); // X*Y + Z/Y : X=3, Y=4, Z=6; should be 13.5 
```

# button - 一键设置多个 div 的可见性

> ID：11511110
> 
> 赞同：1
> 
> 时间：2012-07-16T19:23:26.150
> 
> 标签：button, html, visibility

我试图用一个按钮显示/隐藏多个 div，但我对如何去做感到困惑。该按钮仅用于设置一个 div 的可见性，但我不能让它与多个一起使用。

```
<html>
<head>
<title>| Bali Thai Imports |</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="Description" content="Wholesale fashion accessories, discount designer handbags, vases, wall hangings, decorative bird cages, musical instruments, lanterns and offered by Bali Thai Imports." />
<meta name="Keywords" content="wholesale fashion accessories, discount designer handbags, decorative bird cages, decorative vases, online musical instruments, decorative lanterns, wholesale keychains, discount vases, decorative pillow covers, wind chimes for sale, decorative wall hanging, decorative wall hangings, kites" />
<meta name="robots" content="Index,ALL" />
<meta name="revisit-after" content="7 Days" />
<meta name="rating" content="General" />
<meta name="language" content="en" />
<meta name="distribution" content="Global" />

<link href="stylesheet.css" rel="stylesheet" type="text/css">
<script language="JavaScript">
function setVisibility(id) {
if(document.getElementById('bt1').value=='Hide Layer'){
document.getElementById('bt1').value = 'Show Layer';
document.getElementById(id).style.display = 'none';
}else{
document.getElementById('bt1').value = 'Hide Layer';
document.getElementById(id).style.display = 'inline';
}
}

</script>

<script type="text/javascript">

    var activeMenuItem = new Array();

    function isUlInArray(inputObj,ulObj){
        while(inputObj && inputObj.id!='dhtmlgoodies_listMenu'){
            if(inputObj==ulObj)return true;
            inputObj = inputObj.parentNode;         
        }       
        return false;
    }

    function showHideSub(e,inputObj)
    {

        if(!inputObj)inputObj=this;
        var parentObj = inputObj.parentNode;
        var ul = parentObj.getElementsByTagName('UL')[0];
        if(activeMenuItem.length>0){
            for(var no=0;no<activeMenuItem.length;no++){
                if(!isUlInArray(ul,activeMenuItem[0]) && !isUlInArray(activeMenuItem[0],ul)){
                    activeMenuItem[no].style.display='none';
                    activeMenuItem.splice(no,1);
                    no--;
                }
            }           
        }
        if(ul.offsetHeight == 0){
            ul.style.display='block';
            activeMenuItem.push(ul);
        }else{
            ul.style.display='none';
        }
    }

    function showHidePath(inputObj)
    {
        var startTag = inputObj;
        showHideSub(false,inputObj);
        inputObj = inputObj.parentNode;
        while(inputObj){            
            inputObj = inputObj.parentNode;
            if(inputObj.tagName=='LI')showHideSub(false,inputObj.getElementsByTagName('A')[0]);
            if(inputObj.id=='dhtmlgoodies_listMenu')inputObj=false; 
        }       
    }

    function initMenu()
    {
        var obj = document.getElementById('dhtmlgoodies_listMenu');
        var linkCounter=0;
        var aTags = obj.getElementsByTagName('A');
        var activeMenuItem = false;
        var activeMenuLink = false;
        var thisLocationArray = location.href.split(/\//);
        var fileNameThis = thisLocationArray[thisLocationArray.length-1];
        if(fileNameThis.indexOf('?')>0)fileNameThis = fileNameThis.substr(0,fileNameThis.indexOf('?'));
        if(fileNameThis.indexOf('#')>0)fileNameThis = fileNameThis.substr(0,fileNameThis.indexOf('#'));

        for(var no=0;no<aTags.length;no++){
            var parent = aTags[no].parentNode;
            var subs = parent.getElementsByTagName('UL');
            if(subs.length>0){
                aTags[no].onclick = showHideSub;    
                linkCounter++;
                aTags[no].id = 'aLink' + linkCounter;
            }   

            if(aTags[no].href.indexOf(fileNameThis)>=0 && aTags[no].href.charAt(aTags[no].href.length-1)!='#'){             
                if(aTags[no].parentNode.parentNode){                                
                    var parentObj = aTags[no].parentNode.parentNode.parentNode;
                    var a = parentObj.getElementsByTagName('A')[0];
                    if(a.id && !activeMenuLink){

                        activeMenuLink = aTags[no];
                        activeMenuItem = a.id;
                    }
                }
            }       
        }       

        if(activeMenuLink){
            activeMenuLink.className='activeMenuLink';
        }
        if(activeMenuItem){
            if(document.getElementById(activeMenuItem))showHidePath(document.getElementById(activeMenuItem));   
        }
    }
    window.onload = initMenu;
    </script>
<style type="text/css">
<!--
body {
    background-color: #cc5302;
}
-->
</style>
</head>
<body>
<div id="title"><img src="images/title2.png" alt=""></div>
<div id="topBanner">LIKE US ON FACEBOOK FOR A 10% DISCOUNT!</div>
<div id="productsTitle"><span style="color:white;font-weight=bold;"><span style="color:black;">| </span>&nbsp;    PRODUCTS    &nbsp;<span style="color:black;"> |</span></span></div>
<div id="topNav"><ul class="topnavigation">
        |
        <li><a href="index.htm">HOME</a></li>  
        |
        <li><a href="http://balithaiimports.3dcartstores.com/view_cart.asp">VIEW CART</a></li>  
        |
        <li><a href="http://balithaiimports.3dcartstores.com/">PRODUCTS</a></li>  
        | 
        <li><a href="http://balithaiimports.3dcartstores.com/About-Us_ep_7.html">ABOUT US</a></li>  
        |  
        <li><a href="https://balithaiimports.3dcartstores.com/myaccount.asp?">MY ACCOUNT</a></li>  
        |  
        <li><a href="https://balithaiimports.3dcartstores.com/crm.asp?action=contactus">CONTACT US</a></li>
        |
        </ul> 
</div>
<div id="centerRotator">
    <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="650" height="457">
        <param name="movie" value="Flash/center_rotator.swf">
        <param name="quality" value="high">
        <embed src="Flash/center_rotator.swf" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="650" height="457"></embed>
        </object>
</div>
<!--<div id="socialNetworking">Social Networking</div>-->
<div id="facebook"><a href="https://www.facebook.com/pages/Bali-Thai-Imports/184255874965768"><img src="images/Facebook.png" width="40" height="40" align="middle" alt="Like us On Facebook" /></a> </div>
<div id="twitter"><a href="https://twitter.com/BaliThaiImports"><img src="http://a0.twimg.com/a/1341848431/images/resources/twitter-bird-light-bgs.png" width="80" height="80" align="middle" alt="Follow us on Twitter" /></a> </div>
<div id="pinterest"><a href="http://pinterest.com/balithaiimports/"><img src="http://passets-ec.pinterest.com/images/about/buttons/pinterest-button.png" width="80" height="28" alt="Follow Us on Pinterest" /></a></div>
<div id="manta"><a href="http://www.manta.com/c/mxcpctc/bali-thai-imports"><img src="images/mantaBadge_lg.png" width="80" height="40" alt="Follow Us on Manta" /></a></div>
<div id="logo"><img src="images/Logo.jpg" width="155" height="220" alt=""></div>
<div id="products">
<ul id="dhtmlgoodies_listMenu">
            <li><a href="http://balithaiimports.3dcartstores.com/Jewelry_c_39.html">Jewelry</a>

            <li><a href="http://balithaiimports.3dcartstores.com/Pottery_c_150.html">Pottery</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Toys_c_160.html">Toys</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Lanterns_c_98.html">Lanterns</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Bags_c_95.html">Handbags</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Batik-Shoulder-Bags_c_138.html">Batik Shoulder Bag</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Hats_c_183.html">Hats</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Incense_c_69.html">Incense</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Mobiles_c_180.html">Mobiles</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Childrens-Bags_c_181.html">Children's Backpacks</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Birdcage-Decoration_c_205.html">Decorative Birdcages</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Musical-Instruments_c_158.html">Musical Instruments</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Hand-Painted-Containers_c_111.html">Hand Painted Containers</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Windchimes_c_99.html">Windchimes</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Wood-Carvings_c_156.html">Wood Carvings</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Story-Boards_c_167.html">Storyboards</a></li>
            <li><a href="#">Gift Items</a>
                <ul>
                    <li><a href="http://balithaiimports.3dcartstores.com/Coconut-Shells_c_202.html">Coconut Shells</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Bells_c_217.html">Gongs & Bells</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Statues_c_211.html">Statues</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Napkin-Rings_c_106.html">Napkin Rings</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Bowls_c_125.html">Wooden Bowls</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Trays_c_201.html">Trays</a></li>
                </ul>           
            </li>
            <li><a href="http://balithaiimports.3dcartstores.com/Wall-Hangings_c_124.html">Wall Hangings</a></li>
            <li><a href="#">Clothing</a>
                <ul>
                    <li><a href="http://balithaiimports.3dcartstores.com/Sandals_c_172.html">Sandals</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Sarong-Buckles_c_152.html">Sarong Buckles</a></li>
                    <li><a href="http://balithaiimports.3dcartstores.com/Scarves_c_194.html">Silk Scarves</a></li>
                </ul>           
            </li>
            <li><a href="http://balithaiimports.3dcartstores.com/Umbrellas_c_121.html">Umbrellas</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Backpacks_c_139.html">Backpacks</a></li>
            <li><a href="http://balithaiimports.3dcartstores.com/Vases_c_47.html">Vases</a></li>
        <li><a href="http://balithaiimports.3dcartstores.com/Sarongs_c_187.html">Sarongs</a></li>
        </ul>
</div>
<div id="footer"><span class="footer">Bali Thai Imports LLC - 2011 All Rights Reserved</span></div>
<div id="pictureOne"><img src="images/dscn0062.jpg" alt=""></div>
<div id="pictureTwo"><img src="images/jsr-03.jpg" alt=""></div>
<div id="pictureThree"><img src="images/snr0.jpg" alt=""></div>
<div id="pictureFour"><img src="images/brb050.jpg" alt=""></div>
<div id="pictureFive"><img src="images/cipa-02h.jpg" alt=""></div>
<div id="pictureSix"><img src="images/21840499b_2.jpg" alt=""></div>
<div id="pictureSeven"><img src="images/gd-02.jpg" alt=""></div>
<div id="pictureEight"><img src="images/sst-098.jpg" alt=""></div>
<div id="productsBackground"><img src="images/productsBackground.png" alt=""></div>
<div id="divider1"><img src="images/divider.png" alt=""></div>
<div id="divider2"><img src="images/divider.png" alt=""></div>
<input type=button name=type id='bt1' onclick="setVisibility('products');";> 

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:09:20.250

您需要做的是向您需要显示/隐藏的 div 添加一个类，比如说：`toggleVisible`. 所以这些 div 的 html 看起来像这样：

```
<div id="productsTitle" class="toggleVisible"> ... </div>

<div id="products" class="toggleVisible"> ... </div>

<div id="productsBackground" class="toggleVisible"> ... </div> 
```

然后你的`setVisibility`函数，而不是接收一个 id 作为参数，它将接收一个类名，所以在你的函数中，你将获得所有具有此类名的元素，并更改其可见性：

```
function setVisibility(className) {
    var elems = document.getElementsByClassName(className);
    var displayVal;

    if(document.getElementById('bt1').value=='Hide Layer'){
        document.getElementById('bt1').value = 'Show Layer';
        displayVal = 'none';
    }else{
        document.getElementById('bt1').value = 'Hide Layer';
        displayVal = 'inline';
    }

    for (var i = 0; i < elems.length; i++) {
        elems[i].style.display = displayVal;
    }   
} 
```

最后，您的按钮代码将作为类名调用`setVisibility`传递：`toggleVisible`

```
<input type=button name=type id='bt1' onclick="setVisibility('toggleVisible');";> 
```

# c++ - 幕后 STL：在没有新向量的情况下将 std::vector 连接到自身

> ID：11511115
> 
> 赞同：2
> 
> 时间：2012-07-16T19:23:37.913
> 
> 标签：c++, stl, vector

我有一个存储矩阵对角线的 STL 向量。我正在实施的某个数学规则告诉我，我可以简单地通过获取原始向量并将该向量的副本连接到自身来生成张量积对角线的新矩阵（它的大小加倍，并且值在 1/ 之后重复） 2 * 大小（））。

我写了以下代码：

```
std::vector<int> aVec;

for (int k = 0; k < aVec.size(); k++) aVec.insert(aVec.end(), aVec[k]); 
```

但是当我尝试这个时，我得到了段错误。如果我创建 aVec 的副本并将其用作插入“值”，并将其用于循环参数中的 size()，它将起作用，但我必须做**这两**件事（否则我仍然会得到段错误）。

任何人都可以解释导致此实现不起作用的原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:31:15.087

使用基于迭代器的操作：

```
vec.reserve(vec.size() * 2);
vec.insert(vec.end(), vec.begin(), vec.end()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T19:29:55.087

您将无限期地复制项目。注意要预先复制多少：

```
size_t n = aVec.size();
for (int k = 0; k != n; ++k)
  aVec.push_back(aVec[k]); 
```

虽然许多 C++ 算法使用`begin()`和`end()`迭代器可以更好地表达，但在这种情况下，通过索引的访问更为优越，因为修改容器可能会使迭代器无效，但元素访问将保持有效。但是，您可以使用`reserve`来避免这种失效：

```
aVec.reserve(2*aVec.size());
std::copy(aVec.begin(), aVec.end(), std::back_inserter(aVec)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:29:31.567

在开始向 aVec 添加元素*之前*，您应该读取一次 aVec.size() 的值。

# c# - 如何在 C# 中将两个表单附加在一起？

> ID：11511118
> 
> 赞同：2
> 
> 时间：2012-07-16T19:23:41.813
> 
> 标签：c#, winforms

> **可能重复：**
> [如何“停靠”/附加 winforms 表单](https://stackoverflow.com/questions/1238503/how-to-dock-attach-winforms-forms)

我有两种形式：MainForm 和 PanelForm。

我已经对其进行了设置，以便通过覆盖 MainForm 的 OnMove 将 PanelForm 附加到 MainForm，以便 PanelForm 与 MainForm 一起移动。这是为了模拟 PanelForm 是 MainForm 的面板。

我可以从 MainForm 停靠和取消停靠 PanelForm，也可以折叠它。

问题是当我最小化 MainForm 或者它失去对其他应用程序的关注时，当我返回 MainForm 时，我必须手动 Alt-Tab PanelForm。

有没有办法将 PanelForm 附加到 MainForm，而不覆盖 OnMove 或其他东西来模拟它已附加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:48:55.323

您不能同时拥有两个“活动”表单/窗口。但是，您可以通过激活主窗口将一个或多个窗口置于前台。为此，请使用`Form.Show(ownerForm)`覆盖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:44:48.847

听起来你正在体验形式的本质。它们本质上是独立的。当您希望它们在先前隐藏之后（最小化/前面的另一个窗口）时，您应该做以确保两个表单都可见，您应该做的是连续将焦点设置为它们

**编辑** 看起来你已经找到了答案，但这也可以工作。虽然不如公认的答案漂亮。只需在两种形式上进行即可。

```
Timer timer;
bool resetting = false;
Form2 frm2;
public Form1()
{
    InitializeComponent();
    frm2 = new Form2();
    frm2.Show();
    timer = new Timer();
    timer.Interval = 50;
    timer.Tick+=new EventHandler(timer_Tick);
}
private void timer_Tick(object sender, EventArgs e)
{
    timer.Stop();
    resetting = false;
}

private void Form1_Activated(object sender, EventArgs e)
{
    if (!resetting)
    {
        timer.Start();
        frm2.Focus();
        this.Focus();
        resetting = true;
    }
} 
```

# c++ - linux下的firefox插件开发

> ID：11511121
> 
> 赞同：1
> 
> 时间：2012-07-16T19:24:01.907
> 
> 标签：c++, voip, npapi, browser-plugin

> **可能重复：**
> [如何编写浏览器插件？](https://stackoverflow.com/questions/2649056/how-to-write-a-browser-plugin)

我正在做我的硕士论文，我的主题是在 linux 平台上为 MiniSIP 应用程序（它是一个开源的 VOIP 应用程序）开发一个 firefox 插件。基本上我需要为我的开发使用 MiniSIP 源代码的 sip 堆栈。我需要为该插件开发一个新的基于 firefox 插件的 VOIP 应用程序以及一个新的基于 Web 的 GUI。MiniSIP 源代码是用 C++ 编写的。是否有任何好的 Firefox 插件开发教程或任何插件开发工具可以帮助我的开发。我以前从未开发过插件，所以如果有人提出一些可以推进的想法会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:04:38.943

看看[Mozilla 插件开发页面](https://developer.mozilla.org/en/Plugins)。[这些工具](https://developer.mozilla.org/en/Plugins/External_resources_for_plugin_creation)可能会帮助您完成任务。

您还可以查看[此参考页面](http://colonelpanic.net/2009/03/building-a-firefox-plugin-part-one/)了解详细信息。

# visual-c++ - Visual C++ 中的 ZedGraph

> ID：11511124
> 
> 赞同：1
> 
> 时间：2012-07-16T19:24:07.447
> 
> 标签：visual-c++, zedgraph

我希望有一个人可以帮助我。

我正在尝试在图表上创建一个包含用户信息的文本框。

我有：

```
GraphPane^ myPaneTemp = zedGraphTeP->GraphPane;
TextObj text = gcnew TextObj(
                "Zoom: left mouse & drag\nPan: middle mouse & drag\nContext Menu: right mouse", 0.72f, 0.13f, CoordType::PaneFraction, AlignH::Left, AlignV::Bottom); 
```

text.FontSpec->StringAlignment = StringAlignment::Near;

现在我想添加到图表：

```
myPaneTemp->GraphObjList->Add(text); 
```

但我收到一条错误消息：

> 错误 C2664：“System::Collections::Generic::List::Add”：无法将参数 1 从“ZedGraph::TextObj”转换为“ZedGraph::GraphObj ^”

我怎么解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T08:21:29.247

将我的评论总结为答案以供将来参考：

`gcnew TextObj`给你一个句柄，所以你需要改变`TextObj text`to`TextObj^ text`和`text.FontSpec`to`text->FontSpec`

# c++ - 提升灵气多重启动规则

> ID：11511126
> 
> 赞同：1
> 
> 时间：2012-07-16T19:24:12.283
> 
> 标签：c++, boost-spirit, boost-spirit-qi

如何定义一个可以有多个起始规则的灵气语法？我正在研究一种 XML 语法，我希望有 4 个可能的起始规则。

因此，如果我有一个名为的语法`xml_grammar`并且 base_type 是`(A, "A")`. 我还想要一些其他的起始规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:33:14.087

所有形式语法都有一个起始符号。如果您正在考虑多个起始符号（例如 A、B、C 和 D），您可以使用如下规则将它们转换为单个人工起始符号 S：

```
S = A | B | C | D 
```

# javascript - 使用 javascript 显示和隐藏

> ID：11511130
> 
> 赞同：0
> 
> 时间：2012-07-16T19:24:25.937
> 
> 标签：javascript

```
 <body>
    <input type="textbox" id="fname"></input>
    <button type="button" onclick="javascript:show('select'); return false;">Click</button></br>
    <input type="radio" id="select" style="display:none;"></input>
</body> 
```

我编写的代码似乎是合乎逻辑的，但是在这种情况下，当我单击按钮时，它似乎不起作用..任何人都告诉我我哪里出错了

提前致谢。

```
 <head>
    <title>show and hide javascript</title>
    <script type="text/javascript">
        function show(id) {
            //alert("Its working");
            var myId = document.getElementById.id;
            if (myId.style.display = 'none') {
                myId.style.display = 'block';
            } else {
                myId.style.display = 'none';
            }

        }
    </script>
</head> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:28:50.270

我发现您的功能存在三个问题：

**1）**更正此行`=`中的 a `==`：

```
if (myId.style.display == 'none') { 
```

**2）**改变这个：

```
document.getElementById.id; 
```

为此使其成为实际的函数调用：

```
document.getElementById(id); 
```

**3)**使用跨浏览器`getStyle()`功能，这样您的样式值将包括 CSS 设置，而不仅仅是直接在对象上设置的内容。直接从对象中读取样式属性，只获取对象上直接设置的样式值，不获取默认值。它也不会反映通过 CSS 设置的内容。您可以实现一个跨浏览器功能来获取样式属性，包括通过 CSS 设置的内容，[如下文所示](http://www.javascriptkit.com/dhtmltutors/dhtmlcascade4.shtml)：

```
function getStyle(el, cssprop){
    if (el.currentStyle) //IE
        return el.currentStyle[cssprop]
    else if (document.defaultView && document.defaultView.getComputedStyle) //Firefox
        return document.defaultView.getComputedStyle(el, "")[cssprop]
    else //try and get inline style
        return el.style[cssprop]
} 
```

然后，您可以像这样实现您的功能：

```
 function show(id) {
        //alert("Its working");
        var myId = document.getElementById(id)
        if (getStyle(myId, "display") === "none") {
            myId.style.display = 'block';
        } else {
            myId.style.display = 'none';
        }
    } 
```

另外，由于您的功能实际上是一个切换，而不仅仅是一个节目，我建议将其重命名为`toggle()`. 您可能还想知道，这只适用于块元素。如果你在一个内联元素上尝试它，它会隐藏它，但是当它显示它时，它会将内联元素变成一个块元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:30:05.437

```
document.getElementById(id)  // without the dot before parens 
```

在没有建议的双 == 的情况下，此代码似乎可以正常工作。在更改 (id) 并删除点之前，它不会起作用。

```
<html><head><title>test</title></head>
<body>

<script type="text/javascript">
        function show(id){
            //alert("Its working");
            var myId=document.getElementById(id);
            if(myId.style.display=='none'){
                myId.style.display='block';
            }
            else{
                myId.style.display='none';
            }

        }
    </script>

<h1>Test</h1>

<input type="textbox" id="fname"></input>
    <button type="button" onclick="javascript:show('select'); return false;">Click</button></br>
    <input type="radio" id="select" style="display:none;" />

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:31:11.563

```
 function show(id) {
        //alert("Its working");
        var myId = document.getElementById(id);
        if (myId.style.display == 'none') {
            myId.style.display = 'block';
        } else {
            myId.style.display = 'none';
        }

    } 
```

FTFY

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-16T19:26:39.667

更改此行： if(myId.style.display='none'){

至：

```
if(myId.style.display==='none'){ 
```

# c# - 如何在 .Net/HTML5 中创建交互式数字行

> ID：11511133
> 
> 赞同：1
> 
> 时间：2012-07-16T19:24:34.017
> 
> 标签：c#, .net, html

我正在尝试创建一个交互式[数字行](http://en.wikipedia.org/wiki/Number_line)，以帮助使用 HTML5 和 .NET 的数学学生进行基本的加法/减法学习。我试图弄清楚如何创建一个交互式数字线，用户可以将线上的标记拖到不同的数字上并查看加法/减法结果。

从我目前的研究来看，HTML5 中的[滑块](http://webhole.net/2010/04/24/html-5-slider-input-tutorial/)可能是解决方案，但我不确定它是否可以处理范围。

那里有大师的起点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:33:37.003

有许多提供 Range Slider 的 HTML UI 工具包，我认为它几乎可以完全满足您的需求。

您应该查看 JQuery UI 的范围滑块以帮助您入门：http: [//jqueryui.com/demos/slider/#range](http://jqueryui.com/demos/slider/#range)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:37:26.813

我认为您不想在其中包含 .net。HTML5 可以在 javascript 中完全在客户端处理这个用例。我正在使用 Canvas API 制作一个，但后来我遇到了[这个问题](https://stackoverflow.com/questions/4182494/how-to-draw-number-lines-using-html)，它基本上为您提供了制作数字线所需的知识，您只需要获取点击事件并创建一个显示添加的点结果。这应该很容易，除非你是一个认真的 Canvas 初学者，如果你知道你的具体问题，我会看看我是否可以扩展这篇文章。

关于 sblom 的回答，JQuery 也可以很好地解决这个问题。但我不会涉及 .net 技术，除非你真的需要某种服务器端处理技术，而你在这里不需要。

# python - 显示已删除的子框架（wxPython）

> ID：11511139
> 
> 赞同：2
> 
> 时间：2012-07-16T19:25:02.253
> 
> 标签：python, wxpython

我有一个按钮，可以创建一个新的子框架或显示已经创建的子框架。当我尝试单独使用 Show() 时遇到了一个问题——如果用户退出了子框架，我会收到一个错误，因为我正在访问一个不再存在的框架。我目前正在使用 try/except 来解决这个问题，但是有更好的方法吗？也许是一个类似 Raise() 的函数来处理这个问题，或者是一种检查框架是否存在的方法？

代码：

```
#!/usr/bin/env python

import wx

class LogWindow(wx.Frame):
    def __init__(self, parent):
        wx.Frame.__init__(self, parent)
        self.logger = wx.TextCtrl(self, style=wx.TE_MULTILINE | wx.TE_READONLY)

    def Print(self):
        self.Raise()
        self.logger.AppendText("Hello, world\n")

class MainWindow(wx.Frame):
    def __init__(self, parent, id, title):
        wx.Frame.__init__(self, parent, id, title)
        panel=wx.Panel(self)

        label = wx.StaticText(panel, -1, "Log this message:", pos=(10,10))
        goButton = wx.Button(panel, label="Log", pos=(10,50))
        self.Bind(wx.EVT_BUTTON, self.OnClick, goButton)
        self.logWin = LogWindow(self)

    #++++++++++++++++++++++++++
    def OnClick(self, event):
        try:
            self.logWin.Show()
        except:
            self.logWin = LogWindow(self)
            self.logWin.Show()

        self.logWin.Print()
    #++++++++++++++++++++++++++

class MyApp(wx.App):
    def OnInit(self):
        frame = MainWindow(None, -1, "MyApp")
        frame.Show(True)
        self.SetTopWindow(frame)
        return True

#************************************************

if __name__ == "__main__":
    app = MyApp(0)
    app.MainLoop() 
```

我收到的错误 `self.logWin.Show()` 没有 try/except 是

`wx._core.PyDeadObjectError: The C++ part of the LogWindow object has been deleted, attribute access no longer allowed.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:46:17.290

您可以使用 isinstance 检查它是否仍然存在。有关更多信息，请参阅此线程：[https ://groups.google.com/forum/?fromgroups#!topic/wxpython-users/lMAylDnC7vM](https://groups.google.com/forum/?fromgroups#!topic/wxpython-users/lMAylDnC7vM)

或者你可以试试：

```
if self.logWin:
    self.logWin.Show() 
```

[http://wxpython-users.1045709.n5.nabble.com/is-there-a-method-to-test-if-an-wx-object-exists-td2356531.html](http://wxpython-users.1045709.n5.nabble.com/is-there-a-method-to-test-if-an-wx-object-exists-td2356531.html)

# python - 未在 MSScriptControl 中创建 Python 脚本引擎

> ID：11511143
> 
> 赞同：1
> 
> 时间：2012-07-16T19:25:31.723
> 
> 标签：python, excel, msscriptcontrol

我正在尝试通过 MSScriptControl 使用 Excel 2003 中的 Python。如此处和其他地方的各种主题所示，我遵循了所有必需的步骤，例如：

1.  安装 ActivePython
2.  在 Excel 中向 VBA 添加引用“MSScriptControl 1.0”
3.  通过启动脚本**C:\Python27\Lib\site-packages\win32comext\axscript\client\pyscript.py注册 Python**

但我无法让我的代码在一台 PC 上运行（同时在另一台 PC 上运行，我遵循与上述相同的步骤）。

这是VBA中的代码：

```
Global sc As New MSScriptControl.ScriptControl

Public Function calibrate()

 sc.Language = "python"

 sc.ExecuteStatement ("import SABRSolver")

End Function 
```

当我执行该函数时，它停止`sc.Language`告诉我“无法创建指定语言的脚本引擎（错误 380）”

这真的让我发疯，因为如前所述，它正在其他具有相同设置的机器上工作。

我还缺少其他东西吗？

# javascript - 如何使用 Enyo 2.0 WebService 对象

> ID：11511144
> 
> 赞同：1
> 
> 时间：2012-07-16T19:25:33.563
> 
> 标签：javascript, web-services, chromium, enyo

我正在构建一个 Campfire 客户端，它将在 WebOS 中运行并作为 Chrome 桌面网络应用程序运行。我有以下代码：

```
logIn: function(){
    this.apiToken = this.$.loginScreen.$.apiToken.getValue();
    this.subdomain = this.$.loginScreen.$.subdomain.getValue();
    this.fullURL = 'https://' + this.subdomain + '.campfirenow.com/';
    this.$.roomService.url = this.fullURL + 'rooms.json';
    var response = this.$.roomService.send({'Authorization': "Bearer " + this.apiToken, 'Access-Control-Allow-Origin': this.subdomain + '.campfirenow.com'}); 
```

'roomService' 是这样的：

```
{name: "roomService", kind: "enyo.WebService", url: null, onResponse: "successfulAlert", onError: "someFailure"} 
```

在 Chromium 中，我不断收到以下 XMLHttpRequest 错误：

```
Origin null is not allowed by Access-Control-Allow-Origin. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T16:02:14.417

您可能想看看这个 StackOverflow 问题：

[XmlHttpRequest 错误：Access-Control-Allow-Origin 不允许 Origin null](https://stackoverflow.com/questions/3595515/xmlhttprequest-error-origin-null-is-not-allowed-by-access-control-allow-origin)

您试图从 file:// URL 运行它而被阻止。

# ios - XCode 3.2.5 使用的 SVN 版本 - 不支持的工作副本格式

> ID：11511148
> 
> 赞同：2
> 
> 时间：2012-07-16T19:25:44.683
> 
> 标签：ios, xcode, macos, svn

我正在运行一个 SVN 1.6.11 服务器，我最初在服务器上导入了一个 XCode 项目（即 svn 1.6.11）。

我有一个使用 XCode 3.2.5 的开发人员。他似乎已经成功地进行了初始结帐，但在尝试再次签入时，他收到以下错误：

> 错误：155021（不支持的工作副本格式） 描述：此客户端太旧，无法使用工作副本“/Users/mac2/Desktop/WhatItTakesREPO”。您需要获得更新的 Subversion 客户端，或降级此工作副本。有关详细信息，请参阅 [http://subversion.tigris.org/faq.html#working-copy-format-change](http://subversion.tigris.org/faq.html#working-copy-format-change)。

在我看来，他使用的 SVN 版本太旧，无法与我的服务器一起使用。

我的问题是，如何找出正在使用的 SVN XCode 版本？（据我了解，它可能使用与其他安装的 SVN 不同的二进制文件）

其次，将服务器降级到同等版本会解决这个问题吗？

我知道降级服务器不是最好的解决方案，但由于各种原因，升级到 XCode 4.2 甚至升级开发人员机器上的 SVN 是不可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:34:14.937

不要降级服务器...您可能会破坏所有这些

尝试在家伙的 Mac 上安装单独的 svn 客户端（使用 brew，macports，编译它？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:33:58.457

开发人员最好的办法是使用最新的命令行 SVN 客户端。由于开发人员收到`client is too old to work with working copy`错误消息，因此他肯定已经使用新的 SVN 客户端安装了命令行工具；Xcode 集成只是一种便利，而不是要求。

[您可以使用此答案](https://stackoverflow.com/a/8425673/335858)与最新的 SVN 集成，但它使用了将 SVN 与 XCode 集成的后门方式，并且不保证可以正常工作。

# javascript - JavaScript 中最大长度的正则表达式

> ID：11511154
> 
> 赞同：27
> 
> 时间：2012-07-16T19:26:15.183
> 
> 标签：javascript, regex, maxlength

如何限制与 RegEx 匹配的字符串的长度

我认为这`var sixCharsRegEx = /^.{6,7}/`只会匹配长度为 6 或 7 的字符串

但没有：http: [//jsfiddle.net/FEXbB/](http://jsfiddle.net/FEXbB/)

我错过了什么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-16T19:27:39.447

你最后错过了收盘价。正确的一种是：`/^.{6,7}$/`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-16T19:27:47.493

匹配开始和结束。

```
var sixCharsRegEx = /^.{6,7}$/; 
```

**[你改进的例子](http://jsfiddle.net/FEXbB/1/)**

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-16T19:28:46.977

您必须使用字符串结束符号`$`

像这样`^.{6,7}$`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-16T19:28:07.910

您缺少末端锚：

```
var sixCharsRegEx = /^.{6,7}$/ 
```

# javascript - 与cherrypy和Mako一起使用的Python Javascript框架

> ID：11511155
> 
> 赞同：0
> 
> 时间：2012-07-16T19:26:20.380
> 
> 标签：javascript, jquery, python, mako

我只是在学习 python 和 python 网络应用程序，所以请原谅我缺乏知识。

我正在用cherrypy + mako（+ html）在python中编写一个网络应用程序，现在我正在深入研究它的javascript部分。老实说，剩下的已经足够学习了……所以我想知道如何使用 python 框架从我那里抽象出 javascript 语法。（我主要是 ac* 开发者，python 已经足够让我忙碌了）

我（还）不需要任何花哨的 javascript，虽然我已经开始使用 jquery 和 jquery-ui，但我对语法的理解不够好，做任何事情都需要很长时间......（例如我还没有找到如何让 javascript 和 mako 以客户端服务器的方式相互交互。）

我已经了解了睡衣和其他框架。你会推荐什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:04:02.407

这完全取决于您需要服务器和客户端进行通信的内容。如果您给我们一个具体的问题，我们可以给出更具体的答案。

这是一个 javascript ajax 调用。它是直接的 javascript（无框架），你称之为“不花哨”。

```
function AddToCart_Clicked(SKU, Quantity)
{
    // code for IE7+, Firefox, Chrome, Opera, Safari
    if(window.XMLHttpRequest)
        xmlhttp=new XMLHttpRequest();
    else// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById('HeaderShoppingCartlink').innerHTML = 'Shopping Cart (' + xmlhttp.responseText + ')';
        }
    }

    xmlhttp.open("GET","/ProductNavigation/AddToCartJS?SKU=" + SKU + "&Quantity=" + Quantity, true);
    xmlhttp.send();
    } 
```

此功能将商品添加到用户的购物车。该函数使用变量 SKU 和 Quantity 向 ProductNavigation 类中的 Cherrypy 函数 AddToCartJS 发送 GET 请求。CherryPy 函数如下所示。

```
@cherrypy.expose
def AddToCartJS(self, SKU, Quantity):
    CurrentShoppingCart = ShoppingCart()
    CartID = CurrentShoppingCart.AddToCart(SKU, Quantity)
    return CurrentShoppingCart.GetCartCount() 
```

希望这可以帮助。

安德鲁

# android - Android中网络运营商的地名

> ID：11511166
> 
> 赞同：0
> 
> 时间：2012-07-16T19:27:14.010
> 
> 标签：android

如何从 Android 中网络运营商的“小区信息”中获取地名（我们经常在小区信息中获取最近塔的地名，对吗？？）我希望这个地名作为字符串显示在一个文本视图控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:08:53.773

也许您应该查看[GSM 位置](http://developer.android.com/reference/android/telephony/gsm/GsmCellLocation.html)文档和本[教程](http://android-coding.blogspot.dk/2011/06/get-cell-location-on-gsm-phone.html)，看看它是否能回答您的问题。看起来有一个您可以使用的界面。

# magento - Magento 的新手站在现有网站上，不包括类别页面

> ID：11511167
> 
> 赞同：0
> 
> 时间：2012-07-16T19:27:30.890
> 
> 标签：magento, categories, product

我是 Magento 的新手。我已收到安装 Magento 和设置数据库的文件。现在我试图在我的开发盒上复制现有网站，我注意到当我转到类别页面时出现 404 错误。当我扫描现有网站时，我注意到有 html 页面。如果我获取 html 页面并将其设置在正确的目录中，那么我可以转到该页面，这是预期的。

这样做的问题是，如果我继续抓取活动服务器的 HTML 文件，那么每个类别都会有旧的 url，而不是我当前的开发环境 url。

我想知道 Magento 有没有办法生成 html 页面？还是我必须单独创建它们？

# python - 用python匹配fasta文件中的头文件

> ID：11511170
> 
> 赞同：1
> 
> 时间：2012-07-16T19:27:44.543
> 
> 标签：python, string, pattern-matching, biopython

我有两个文件：第一个是带有标题和序列的 fasta 文件，第二个仅由标题组成。

文件_1：

```
>DF94KKQ1|265|D0M1LACXX|3|2103|4637|10742|1|N|0|TGACCA
TTCCAAAGAAACATGGAAGACCCAGGACTTGGAGGCACCAGGCACCAGCACACAGGGGTA
GGCACATGGCATGGTGTTGGTTGAAGTCTACTTTTCCCACC
>DF94KKQ1|265|D0M1LACXX|3|2103|4565|10742|1|N|0|TGACCA
TTAATTTTTTCAGGCAAGTTTTGTGGATTTCAGTGTGTAAGTCTTTCACCTCTTTGGTTA
AATTTATTCCTATGTATTTTATTCCTTTAGATGCTATTATG
>DF94KKQ1|265|D0M1LACXX|3|2103|4565|10742|2|N|0|TGACCA
TTAATTTTTTCAGGCAAGTTTTGTGGATTTCAGTGTGTAAGTCTTTCACCTCTTTGGTTA
AATTTATTCCTATGTATTTTATTCCTTTAGATGCTATTATG 
```

文件_2：

```
>DF94KKQ1|265|D0M1LACXX|3|2103|4565|10742|2|N|0|TGACCA
>DF94KKQ1|265|D0M1LACXX|3|2103|4668|10746|1|N|0|TGACCA
>DF94KKQ1|265|D0M1LACXX|3|2103|4668|10746|2|N|0|TGACCA
>DF94KKQ1|265|D0M1LACXX|1|2207|10852|3331|2|N|0|TGACCA 
```

我想将 File_2 中的标头与 File_1 中直到第 7 个“|”之前具有相同确切字符的任何内容相匹配。

我拆分了 File_1 中的项目（标题的每个部分都被索引到一个列表中）。任何以 '>' 开头的行都被放入一个变量中：

```
#!/usr/bin/env python
import sys
from Bio import SeqIO

#Function, split header line into a list
def getHeaderInfo(blastLine):
   myFields = blastLine.strip("\n").split("|") 
   HeaderInfo = myFields[:6]
   return HeaderInfo

input_file = sys.argv[1]

#Get input file from the command line
inFileName = sys.argv[1]

#open the input file
inFileHandle = open(inFileName)

#loop over the input file line by line
for thisLine in inFileHandle.readlines():
    if thisLine [0] == '>': 
       print getHeaderInfo(thisLine)
       HeaderInfo = getHeaderInfo(thisLine) 
```

我一直在尝试找到一种方法，可以在其中比较 File_2 中的这些相同索引以返回以下输出：

```
>DF94KKQ1|265|D0M1LACXX|3|2103|4565|10742|1|N|0|TGACCA
TTAATTTTTTCAGGCAAGTTTTGTGGATTTCAGTGTGTAAGTCTTTCACCTCTTTGGTTA
AATTTATTCCTATGTATTTTATTCCTTTAGATGCTATTATG
>DF94KKQ1|265|D0M1LACXX|3|2103|4565|10742|2|N|0|TGACCA
TTAATTTTTTCAGGCAAGTTTTGTGGATTTCAGTGTGTAAGTCTTTCACCTCTTTGGTTA
AATTTATTCCTATGTATTTTATTCCTTTAGATGCTATTATG 
```

我尝试过的几种方法都使用索引，但是，我的键不是唯一的。如何获取前六个元素并将它们作为我的关键，或者有没有比我正在尝试的当前方法更好的方法？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:28:12.383

这是做你想做的吗？

```
def make_key(line):
    return "|".join(line.split("|", 7)[ : 7]) + "|"

header_set = set()
with open("file_2.txt") as in_f:
    for line in in_f:
        header_set.add(make_key(line))

with open("file_1.txt") as in_f, open("file_3.txt", "w") as out_f:
    accept = False
    for line in in_f:
        if line.startswith(">"):
            key = make_key(line)
            accept = key in header_set

        if accept:
            out_f.write(line) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:05:55.323

这种方法涉及内存映射 file_1.txt，通过它运行 re.finditer 以将行加载到由 header 键入的 defaultdict

```
import re
import mmap
from collections import defaultdict
pat = re.compile('>.+?(?=(>|$))', re.DOTALL)
with open('file_1.txt') as f:
    map = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)

line_1 = defaultdict(list)
for line in pat.finditer(map):
    fields = line.group().split('|')
    key = '|'.join(fields[:6])
    line_1[key].append(line.group())

map.close()
line_2 = []
with open('file_2.txt') as f:
    for line in f:
      fields = line.split('|')
      key = '|'.join(fields[:6])
      line_2.append(key)

line_2 = set(line_2)
for key in line_2.intersection(line_1.keys()):
    print "".join(line_1[key]) 
```

# sql - 数据库设计：存储信用卡信息

> ID：11511175
> 
> 赞同：0
> 
> 时间：2012-07-16T19:28:13.700
> 
> 标签：sql, database-design, normalization

好的，到目前为止，我有一个存储收据信息的表。

例如：

```
TABLE receipt
receipt_ID (int)(primary key)
creditcard (int) //Last 4 digits of credit card.
purhcaseAmount (int)
transactionTypeID (int)
remainingBalance (int) 
```

信用卡栏有 4 位数字的限制，因为大多数收据只显示信用卡号的最后 4 位数字。

但是，有些银行会显示前 2 位数字和后 2 位数字，我想将此信息保留到数据库中。

您将如何修改您的数据库设计以适应此业务需求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:33:18.253

您可能想要存储有关信用卡的多条信息，例如姓名、卡类型等。对于数字本身，为什么要聪明呢？只需将其设置为 a`varchar(19)`并将其存储为`12****************34`您选择的任何其他格式即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:33:20.203

即使是最后 4 位，我也不会使用 int。根据经验，如果您存储的数字加起来没有意义，请将其存储为字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:37:42.953

如果您的业务要求是存储 4 位数字，那么它们在字符串中的位置是否重要？这些信息将用于什么目的？

如果没关系，只需使用正则表达式获取数字，忽略不是数字的内容，然后将数字填充到表格列中。

# css - 使用 CSS 在 MVC 母版页中创建三栏布局

> ID：11511182
> 
> 赞同：1
> 
> 时间：2012-07-16T19:28:44.557
> 
> 标签：css, asp.net-mvc, asp.net-mvc-2, master-pages

ASP.NET MVC 2 项目。

我想创建一个具有三列布局的母版页。我现在用桌子。

```
<table>
    <tr>
        <td>
            <asp:ContentPlaceHolder ID="ContentPlaceHolder1" runat="server">
            </asp:ContentPlaceHolder>
        </td>
        <td>
            <asp:ContentPlaceHolder ID="MainContent" runat="server">
            </asp:ContentPlaceHolder>
        </td>
        <td>
            <asp:ContentPlaceHolder ID="ContentPlaceHolder2" runat="server">
            </asp:ContentPlaceHolder>
        </td>
    </tr>
</table> 
```

然后是这样的：

```
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">
    <h2>
        Custom Master Demo</h2>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="head" runat="server">
    <meta name="description" content="Here are some keywords for our     page description.">
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div style="width: 200px; height: 200px; border: 1px solid #ff0000;">
        <ul>
            <li>Home</li>
            <li>Contact Us</li>
            <li>About Us</li>
        </ul>
    </div>
</asp:Content>
<asp:Content ID="Content" ContentPlaceHolderID="ContentPlaceHolder2" runat="server">
    <div style="width: 200px; height: 200px; border: 1px solid #000000;">
        <b>News</b><br />
        Here is a blurb of text on the right!
    </div>
</asp:Content> 
```

布局喜欢： ![母版页](../Images/acc017d7d11a95c76db7cb3c46ac7285.png)

但是使用 table 可能很愚蠢，有没有办法用 CSS 来实现它？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:30:16.803

看看这个： http: [//matthewjamestaylor.com/blog/perfect-3-column.htm](http://matthewjamestaylor.com/blog/perfect-3-column.htm)

网上有很多关于这方面的资料。

# node.js - 如何使用 Google API JSON 数据，特别是 Google 产品

> ID：11511190
> 
> 赞同：0
> 
> 时间：2012-07-16T19:29:20.143
> 
> 标签：node.js, google-api

我在解析从 Query for products in Google Product 收到的数据时遇到问题。如果我运行类似于...的查询

```
curl --header "Authorization:GoogleLogin Auth=<AuthKey>" --header "Content-Type:application/atom+xml" https://content.googleapis.com/content/v1/8076653/items/products/generic?alt=json 
```

我收到一个 JSON(ish?) 文档，类似于以下内容

```
{
  "version":"1.0",
  "encoding":"UTF-8",
  "feed":{
  ...
  }
} 
```

但是当我运行以下

```
res.on('end', function() {
  console.log(res.body.feed);
  mainRes.send(res.body);
}); 
```

控制台显示未定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:40:40.540

应该...

```
res.on('end', function() {
  console.log(JSON.parse(res.body).feed);
  mainRes.send(res.body);
}); 
```

# python - 设置自定义轴值pyplot

> ID：11511191
> 
> 赞同：3
> 
> 时间：2012-07-16T19:29:21.453
> 
> 标签：python, matplotlib, tkinter, python-2.7

我在 tkinter.Toplevel 窗口中有一个绘图，我想让它使用自定义间隔的 x 轴。目前它被设置为默认值，因此数字是均匀分布的（0、5、10、15...等）。我想为我拥有的每个数据点加上一个刻度线（例如 2、6、15、30）。我确信它只是某个标题下的某个关键词，但我无法弄清楚它是哪一个。下面是它将进入的代码示例。

```
import matplotlib
matplotlib.use('TkAgg')
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
from matplotlib.backends.backend_tkagg import NavigationToolbar2TkAgg
from matplotlib.figure import Figure
import Tkinter as tk

root = tk.Toplevel(width=2000)
f = Figure()
ax = f.add_subplot(111)
zeroy = [0,25]
zerox = [0, 35]
p3 = ax.plot(zerox, zeroy, 'k-')
canvas = FigureCanvasTkAgg(f, master=root)
canvas.show()
canvas.get_tk_widget().grid(row=0)

toolbar = NavigationToolbar2TkAgg(canvas, root)
toolbar.grid(row=1, sticky=tk.W) 
toolbar.update() 
button = tk.Button(root, text='Quit', command = root.destroy)
button.grid(row=2)
root.mainloop() 
```

我曾尝试使用`ax.xticks(...)`，`f.add_axes(xticks=[1,2,5,7]`但这些都不起作用。我还尝试了其他各种弱尝试，但均未成功。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:00:50.180

```
ax.set_xticks(ticks=[0,2,4,5,30,50]) 
```

在弄乱了我的代码之后发现了这一点。

# c# - 使用 Filehelpers 处理 DelimitedRecord 中的 NEWLINE

> ID：11511192
> 
> 赞同：4
> 
> 时间：2012-07-16T19:29:23.360
> 
> 标签：c#, parsing, csv, newline, filehelpers

我正在使用出色的 FileHelpers 库来解析许多不同的文件。其中一个文件有（一些）行看起来像这样

```
id|name|comments|date
01|edov|bla bla bla bla|2012-01-01
02|john|bla bla bla bla|2012-01-02
03|Pete|bla bla <NEWLINE>
bla bla|2012-03-01
04|Mary|bla bla bla bla|2012-01-01 
```

请注意，id 为 3 的行在文本中有一个换行符。另请注意，评论没有被引号包围，所以`[FieldQuoted('"', MultilineMode.AllowForRead)]`不会救我。

Filehelpers 在第 4 行抛出异常：

> 分隔符“|” 在字段“评论”之后找不到（记录的字段较少，分隔符错误或下一个字段必须标记为可选）。

无论如何我可以用 FileHelpers 解析这个文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T11:26:20.257

在将输入传递给 FileHelpers 引擎之前，您必须通过在第三个字段中添加引号来更正输入。使用 LINQ 很容易，如以下程序所示。

```
[DelimitedRecord("|")]
[IgnoreFirst(1)]
public class ImportRecord
{
    public string Id;
    public string Name;
    [FieldQuoted(QuoteMode.AlwaysQuoted, MultilineMode.AllowForRead)]
    public string Comments;
    public string Date;
}

class Program
{
    static void Main(string[] args)
    {
        var engine = new FileHelperEngine<ImportRecord>();

        string input = "id|name|comments|date" + Environment.NewLine +
                              "01|edov|bla bla bla bla|2012-01-01" + Environment.NewLine +
                              "02|john|bla bla bla bla|2012-01-02" + Environment.NewLine +
                              "03|Pete|bla bla" + Environment.NewLine +
                              "bla bla|2012-03-01" + Environment.NewLine +
                              "04|Mary|bla bla bla bla|2012-01-01";

        // Modify import to add quotes to multiline fields
        var inputSplitAtSeparator = input.Split('|');
        // Add quotes around the field after every third '|'
        var inputWithQuotesAroundCommentsField = inputSplitAtSeparator.Select((x, i) => (i % 3 == 2) ? "\"" + x + "\"" : x);
        var inputJoinedBackTogether = String.Join("|", inputWithQuotesAroundCommentsField);

        ImportRecord[] validRecords = engine.ReadString(inputJoinedBackTogether);

        // Check the third record
        Assert.AreEqual("03", validRecords[2].Id);
        Assert.AreEqual("Pete", validRecords[2].Name);
        Assert.AreEqual("bla bla" + Environment.NewLine + "bla bla", validRecords[2].Comments);
        Assert.AreEqual("2012-03-01", validRecords[2].Date);

        Console.WriteLine("All assertions passed");
        Console.ReadKey();
    }
} 
```

# c# - 在以下场景中如何使用面向对象的原则？

> ID：11511195
> 
> 赞同：1
> 
> 时间：2012-07-16T19:29:32.753
> 
> 标签：c#, oop

我有 3 家汽车租赁公司。每个机构都需要 XML 格式的数据，但格式不同，例如：

机构 1

```
<Rental>
<Customer>
<FirstName>test</FirstName>
<LastName>test</LastName>
</Customer>
<Pickup date="07/20/2012"/>
<Dropoff date="07/25/2012"/>
<Deposit cost="100"/>
</Rental> 
```

机构 2

```
<Rental>
<Customer>
<FirstName>test</FirstName>
<LastName>test</LastName>
</Customer>
<Pickup>07/20/2012</Pickup>
<Dropoff>07/25/2012</Dropoff>
<Deposit>100</Deposit>
</Rental> 
```

机构 3

```
<Rental pickup="07/20/2012" dropoff="07/25/2012" deposit="100">
<Customer>
<FirstName>test</FirstName>
<LastName>test</LastName>
</Customer>
</Rental> 
```

正如你从上面看到的，所有 3 个基本上都包含相同的信息，尽管不一定是这种情况（有些可能包含或多或少的信息），但它的结构不同，所以我访问它的方式不同。最好的方法是什么，以便我可以编写最少的代码，但能够适应具有不同结构的新租赁机构？

现在，我正在做这样的事情：

```
public class Agency1
{
SubmitRental()
{
//Parse XML for Agency 1
}

//Other methods for agency 1
}

public class Agency2
{
SubmitRental()
{
//Parse XML for Agency 2
}

 //Other methods for agency 2
}

public class Agency3
{
SubmitRental()
{
//Parse XML for Agency 3
}

//Other methods for agency 3
} 
```

在上面，类包含相同的方法，但它们的实现方式不同。有些类中有一些方法、属性等，而另一些类中没有。接口是解决这个问题的最佳方法吗？如果是这样，是否应该将所有内容都设为接口？

在上面的 XML 示例中，数据是相同的，但格式不同，这导致一些人提出将所有不同的格式映射到一组通用类，但是不只是格式不同的场景呢，但数据也不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:39:44.067

我通常会将解析与数据表示分开，例如：

```
public class Rental
{
    public string CustomerFirstName { get; set; }
    public DateTime Pickup { get; set; }
    // ... etc ...
} 
```

和一组数据解析器：

```
public interface IAgencyRentalParser
{
    XmlDocument ToXml(Rental rental);
    Rental FromXml(XmlDocument xml);
}

public class Agency1RentalParser : IAgencyRentalParser { ... }

public class Agency2RentalParser : IAgencyRentalParser { ... }

public class Agency3RentalParser : IAgencyRentalParser { ... } 
```

以及其他一些用于确定使用哪个解析器的机制。就像返回适当解析器的工厂模式一样......

```
public class AgencyRentalParserFactory
{
    public IAgencyRentalParser GetParserFor(XmlDocument xml)
    {
        // create and return one of the parsers...
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:36:04.413

继承和多态

```
public class Agency
{
    public virtual void SubmitRental()
    {
        //can leave empty, or provide default behavior
    }

    // methods and properties/fields common to all Agencies.  
}

public class Agency1 : Agency
{
    public override void SubmitRental()
    {
        //insert submit logic here
    }
    //methods and properties/fields specific to Agency1
} 
```

如果它们的实现方式完全不同，您可以使用接口

[http://msdn.microsoft.com/en-us/library/ms173156.aspx](http://msdn.microsoft.com/en-us/library/ms173156.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:39:20.070

只需创建一个基本抽象类，它将包含每个机构通用的所有信息和标记为虚拟的所有方法。而不是为每个机构创建具体的课程。

```
public abstract class AgencyBase
{
    private string _customer;
    // other fields that every agency have.

    public abstract void SubmitRental();

//Other methods for agency
}

public class Agency1 : AgencyBase
{
    // Agency specific fields.

    public override void SubmitRental()
    {
        // Your implementation.
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:40:18.277

一种可能的方法是创建一个抽象基类 Agency，您将在其中保存公共数据。此类有一个名为 submitRental() 的抽象方法，例如：

```
public abstract class Agency {
  public abstract void SubmitRental();

  //Other methods for agency ...
}

public class AgencyOne : Agency {
  public void SubmitRental() {
    // agency one specific code...
  }
} 
```

另一种方法是创建一个接口，其中包含方法 SubmitRental()。对于每个代理，您继承您的接口并为该代理格式编写特定的解析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:40:55.707

如果我是设计它的人，那么我会以简单的方式看待它：

1) 代理对象：

```
ID (string to identify 'Agency 1','Agency 2' and so on.)
Customer (Reference to Person Object)
Shipping (Reference to Shipping Object) 
```

SubmitRental 方法 - 应包含基于 ID 字段和其他数据的自定义

2）人对象：

```
FirstName
LastName 
```

3) 出租对象：

```
Pickup Date
Dropoff Date
Deposit 
```

当然，把你可以放在上面的所有其他字段/获取/设置方法放在上面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T20:24:52.480

通过创建 BaseAgencyClass 和/或 AbstractAgencyClass 和/或 IAgency 接口，您只是在准备自己进行单个代理功能的多个实现（这是您想要避免的）。如果使用得当，基类和抽象类和接口 [非常] 合适，但它们不会解决您想要做的事情。相反，请使用解析器解决问题。

为所有代理创建一个类 [Agency]（如果适合您的解决方案，请使用接口和/或基类）和一个*通用*解析器。您希望尽快将各种格式的 XML 放入一个通用的 Agency 对象中。不要将 XML 的差异保留到您的代理实现中。

对于您的解析器（它可以是 Agency 上的一个方法，或者内置于 Agency 的构造函数中，或者其他负责解析的对象，等等），只需以动态方式解析 XML。所有的 XML 只是一系列 PARENT/CHILD 关系。对于 XML，总有一个 ROOT 元素，因此您总是可以从 ELEMENT 开始。然后要找到应该是下一个的孩子，首先检查元素的属性。如果找不到，请检查 ELEMENT 的 CHILDREN（嵌套元素）。如果你没有找到它，那么检查 ELEMENT 的 VALUE（包含在 ELEMENT 中的文本）。

您应该能够以这种方式仔细阅读您的 XML，并将所有组合解析为一个 COMMON 代理对象。无需重复代码或多次实现。祝你好运！

**编辑：** 这是编写“通用解析器”的示例。这不是**生产代码**，而只是使用您的 3 个 XML 示例的快速而肮脏的示例：

```
class Program
{
    static void Main(string[] args)
    {
        IList<XDocument> xmls = new List<XDocument>()
                                    {
                                        XDocument.Load("XMLFile1.xml"),
                                        XDocument.Load("XMLFile2.xml"),
                                        XDocument.Load("XMLFile3.xml")
                                    };
        Agency agency = new Agency();

        foreach (var xml in xmls)
        {
            var rental = new Rental();
            #region Pickup Date
            if (xml.Root.Attribute("pickup") != null)
                rental.Pickup = DateTime.Parse(xml.Root.Attribute("pickup").Value);
            else if (xml.Root.Element("Pickup") != null)
            {
                var pickupElement = xml.Root.Element("Pickup");
                rental.Pickup = DateTime.Parse(pickupElement.Attribute("date") != null ? pickupElement.Attribute("date").Value : pickupElement.Value);
            }
            // else there's no pickup date defined
            #endregion
            agency.rentals.Add(rental);
        }
    }
}

public class Agency
{
    public IList<Rental> rentals = new List<Rental>();
}

public class Rental
{
    public DateTime Pickup;
} 
```

例如，这只解析出“提货日期”并将其填充到单个代理对象中。它处理可能会出现“提货日期”的 3 种情况。就像我说的，这不是**生产代码**，因此您希望以更安全、更合适的方式编写它。例如，XML 区分大小写，因此在解析之前将您的 XML 转换为全部 UPPER 或 LOWER（如果可能）可能是个好主意。或者，如果这很重要，您也可以使用 Regex 仅将 ELEMENT & ATTRIBUTE 名称转换为 UPPER 但不影响实际值。

如果您所说的是数据可能以完全*未知*的XML 布局出现，那么这可能行不通。但这至少可以解决您*已知*的布局，而有效的 XML 只能以多种方式排列！希望这可以帮助！

# html - IE7 CSS 头疼

> ID：11511200
> 
> 赞同：0
> 
> 时间：2012-07-16T19:29:48.083
> 
> 标签：html, css, internet-explorer-7

我现在正在建立一个网站，而联系页面在 IE7 中被破坏了。我已经尝试了一切来修复它，但没有任何效果。

链接是，

[http://www-magnificent-7-co-uk.consultcreatecommunicate.com](http://www-magnificent-7-co-uk.consultcreatecommunicate.com)

任何想法，基本上表格的右侧应该在2列中......每列的布局应该标记输入标签输入。

# javascript - mongodb评论教程

> ID：11511205
> 
> 赞同：2
> 
> 时间：2012-07-16T19:30:09.580
> 
> 标签：javascript, html, mongodb, comments

我目前正在做关于“存储评论”的 mongoDB 教程......尝试使用“每个评论一个文档”的概念。

[http://docs.mongodb.org/manual/use-cases/storing-comments/](http://docs.mongodb.org/manual/use-cases/storing-comments/)

我将以下文档添加到我的数据库中：

```
a = {'discussion_id': 55, slug: '34db', full_slug: '2012.02.08.12.21.08:34db',     text:'1'}
b = {'discussion_id': 66, slug: '34db/8bda', full_slug: '2012.02.08.12.21.08:34db/2012.02.09.22.19.16:8bda', text:'1.1'}
c = {'discussion_id': 77, slug: '88uz', full_slug: '2012.03.08.12.21.08:34db', text:'2'} 
```

在我的 db.test 中保存所有文档并执行：

```
db.test.find().sort('full_slug':1) 
```

正如文档中所说：“......您可以在 full_slug 字段上使用简单的排序来检索线程视图”我想知道该输出应该是什么样子......

我只让 JSON 看起来像：

```
{}
{}
{} 
```

当我期待更多“线程/嵌套”的东西时......

```
{
{}
}
{} 
```

你能告诉我是我的输入有问题还是我有错误的期望？

如果这个输出很好：如何将信息呈现为线程 html 输出？（订单似乎不错，但如何从中获取缩进信息？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:39:42.460

这是你的期望。Mongo 将返回数组中的所有文档。任何关系或条件逻辑/实现都需要在代码中处理（插入之前或选择之后）。例如：

1.  在插入 mongo 之前，计算正确的缩进级别并在文档上添加另一个属性来存储计算的值。

2.  检索文档后，使用每个文档中的上下文元素（即时）计算正确的缩进级别。

# java - 在java程序中使用android aapt

> ID：11511206
> 
> 赞同：0
> 
> 时间：2012-07-16T19:30:11.880
> 
> 标签：java, android, linux, runtime.exec, aapt

很长一段时间以来，我一直在尝试通过 java 程序执行 aapt 命令。我的预感是我应该使用`runtime.exec()`命令来实现这一点。但是，我查看了其他问题和答案，但似乎没有一个对我有用。命令是：

```
 aapt package -u -f -F "/home/jay/testing_FILES.apk" "/home/jay/testing_FILES" 
```

其中`/home/jay/testing_FILES`是原始文件夹，`/home/jay/testing_FILES.apk`是最终 apk 的打包名称和位置。谁能向我解释如何使用 aapt 和 java 使该命令正确运行`runtime.exec()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T05:19:11.353

老问题，我知道，但试试这个：

```
String[] cmd = {"aapt", "package", "-u", "-f", "-F", "/"//home//jay//testing_FILES.apk/"", "/"//home//jay//testing_FILES/""};

Runtime run = Runtime.getRuntime();
Process pr = null;
try {
    pr = run.exec(cmd);
    pr.waitFor();
} catch (IOException e) {
    e.printStackTrace();
} catch (InterruptedException e) {
    e.printStackTrace();
} finally {
    if(pr != null){
        close(pr.getOutputStream());
        close(pr.getInputStream());
        close(pr.getErrorStream());
        pr.destroy();
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T19:53:16.777

我不知道您是否尝试过以下格式，但以防万一：

```
aapt  package -f -M ${manifest.file} -F ${packaged.resource.file} -I ${path.to.android-jar.library} -S ${android-resource-directory} [-m -J ${folder.to.output.the.R.java}] 
```

另外以防万一你还没有看过这个网站：[how to build Android application](http://asantoso.wordpress.com/2009/09/15/how-to-build-android-application-package-apk-from-the-command-line-using-the-sdk-tools-continuously-integrated-using-cruisecontrol/)

希望有帮助。

# python - Django 单元测试缺少数据库列

> ID：11511209
> 
> 赞同：3
> 
> 时间：2012-07-16T19:30:23.810
> 
> 标签：python, database, django, unit-testing, django-south

我在 Django 上创建了一个单元测试来创建用户帐户并发送验证电子邮件。用户已创建，但电子邮件发送失败。电子邮件的默认内容应该在创建用户时作为用户中的一个字段创建，但出于某种原因，Django 声称 -

```
DatabaseError: no such column: app_userprofile.default_email_header 
```

手动创建帐户时它工作正常，但由于某种原因，它在从单元测试完成时无法在数据库中创建该列。有什么建议可以解决这个问题吗？

注意： South 用于迁移 models.py 中的更改 - 这可能是问题吗？

# android - Eclipse中的Android数据文件夹为空

> ID：11511219
> 
> 赞同：0
> 
> 时间：2012-07-16T19:30:57.927
> 
> 标签：android, eclipse

有时我可以访问 Eclipse 中的数据文件夹，有时不能。大多数情况下，数据文件夹是不受限制的。

我怀疑这与我将手机连接到电脑的方式有关。调试时我必须使用互联网直通选项。有趣的是，这并没有让手机上网，但确实允许进行一些调试。（如果它不需要互联网访问）当测试我的应用程序的互联网功能时，我必须关闭互联网传递。并通过连接。无线。现在。返回“互联网直通”时，我无权访问数据文件夹。我必须重新启动我的电脑。我只是惊呆了 FUB infinity android 开发有时是多么惊人。有没有人围绕android调试开发任何有用的工作流程，在连接到互联网时访问文件？任何有用的文件访问工具将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:32:37.520

您只能在手机上查看数据文件夹，前提是它已植根

# android - 使用 StringBuilder 附加字符串时 Dalvik-vm 内存不足

> ID：11511220
> 
> 赞同：0
> 
> 时间：2012-07-16T19:31:08.300
> 
> 标签：android

我的应用程序从服务器接收图像数据作为 XML。在解析 XML 期间，我使用 StringBuilder 附加数据，解码图像数据，然后显示图像。如果图像大小大于 1MB，我会得到 Dalvik-vm “Out Of Memory” 异常，如下所示：

```
07-16 19:23:35.376: E/dalvikvm-heap(374): Out of memory on a 10501076-byte allocation.
07-16 19:23:35.376: I/dalvikvm(374): "AsyncTask #2" prio=5 tid=10 RUNNABLE
07-16 19:23:35.376: I/dalvikvm(374):   | group="main" sCount=0 dsCount=0 obj=0x405e3238 self=0x38ff88
07-16 19:23:35.376: I/dalvikvm(374):   | sysTid=434 nice=10 sched=0/0 cgrp=bg_non_interactive handle=3735744
07-16 19:23:35.376: I/dalvikvm(374):   | schedstat=( 3989536323 3728953745 437 )
07-16 19:23:35.376: I/dalvikvm(374):   at java.lang.AbstractStringBuilder.enlargeBuffer(AbstractStringBuilder.java:~95)
07-16 19:23:35.376: I/dalvikvm(374):   at java.lang.AbstractStringBuilder.append0(AbstractStringBuilder.java:153)
07-16 19:23:35.376: I/dalvikvm(374):   at java.lang.StringBuilder.append(StringBuilder.java:217)
07-16 19:23:35.376: I/dalvikvm(374):   at os.android.lib.asgsuitesdk.XmlReader.characters(XmlReader.java:121)
07-16 19:23:35.376: I/dalvikvm(374):   at org.apache.harmony.xml.ExpatParser.text(ExpatParser.java:165)
07-16 19:23:35.376: I/dalvikvm(374):   at org.apache.harmony.xml.ExpatParser.appendBytes(Native Method)
07-16 19:23:35.376: I/dalvikvm(374):   at org.apache.harmony.xml.ExpatParser.parseFragment(ExpatParser.java:518)
07-16 19:23:35.376: I/dalvikvm(374):   at org.apache.harmony.xml.ExpatParser.parseDocument(ExpatParser.java:479)
07-16 19:23:35.376: I/dalvikvm(374):   at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:318)
07-16 19:23:35.376: I/dalvikvm(374):   at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:275)
07-16 19:23:35.376: I/dalvikvm(374):   at javax.xml.parsers.SAXParser.parse(SAXParser.java:390) 
```

无论如何，我可以摆脱这个异常吗？我知道，取决于设备，为 Android 应用程序分配的堆内存至少为 16MB。在我的情况下，图像大小在 1MB ~ 2MB 之间，它会崩溃。非常感谢任何帮助。

谢谢， DK

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-16T20:05:26.197

您必须对图像进行下采样。请记住，图像将使用大约`H x W x 4 bytes`内存来显示，因此“文件大小”并不能真正反映内存中的实际大小。您必须对图像进行下采样，使其大小达到适合屏幕所需的大小。

看到[这个以前的答案](https://stackoverflow.com/questions/10012548/view-paging-with-lots-of-images-can-it-even-work/10013071#10013071)

# azure - 从 Web Deploy 或 SDK 部署 Azure 云服务

> ID：11511225
> 
> 赞同：1
> 
> 时间：2012-07-16T19:31:32.783
> 
> 标签：azure, web-deployment

我在玩Azure。

我[在 Windows Azure 中找到了关于云应用程序持续交付的](https://www.windowsazure.com/en-us/develop/net/common-tasks/continuous-delivery)指南，我想是否有办法使用 Web Deploy 或 Azure SDK 来进行实际部署，而不是 Powershell？

我想部署与云服务相同的包。云服务可能不存在，因此需要创建它。如果存在，它应该只更新包。

**更新**
我想从我已经拥有的 Windows 服务中执行此操作（当前部署到本地 IIS）。可以从某种编程接口完成它很重要，但如果 Powershell 是唯一的选择，那就这样吧。

这可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:26:30.273

我发现powershell是过去制作云包的唯一方法。powershell 脚本使用 SDK，因此理论上您可以编写一个命令行程序来执行与 powershell 相同的操作，但我不知道这必然会为您带来什么。您是否需要一个 powershell 示例来执行此操作，或者您只是不想运行 powershell？这是我发现的有关如何执行此操作的帖子： [http](http://adambird.com/automating-azure-deployment-with-windows-powe) : //adambird.com/automating-azure-deployment-with-windows-powe 此处还有 cmdlet 上的文档。

[http://wappowershell.codeplex.com/documentation](http://wappowershell.codeplex.com/documentation)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:52:30.373

如果您不想使用 PowerShell，还有其他方法可以部署，即 VS2010/AzureSDK。

[由于一些严重的限制，Web Deploy 不是将包部署到 Windows Azure 的建议方法，但是您可以在此处](http://blogs.msdn.com/b/cloud/archive/2011/04/19/enabling-web-deploy-for-windows-azure-web-roles-with-visual-studio.aspx)查看如何配置它。

如果您想使用 Windows Azure SDK 进行部署，您肯定会使用 VS2010，您可以使用 VS2010 发布选项直接部署您的应用程序。这是非常直接的，并[在此处](http://msdn.microsoft.com/en-us/library/windowsazure/hh420322)进行了描述。

# internet-explorer-7 - @font-face 无法在 IE7 中加载字体

> ID：11511226
> 
> 赞同：3
> 
> 时间：2012-07-16T19:31:34.903
> 
> 标签：internet-explorer-7, font-face, font-awesome

我搜索了类似的问题，但仍未找到解决我的@font-face 规则为何在 IE7 中不起作用的解决方案。这是我的演示的实时链接：

[http://www.staging.jungledragon.com/experiments/v3_02/](http://www.staging.jungledragon.com/experiments/v3_02/)

当您在现代浏览器中打开此站点时，您会注意到全局导航具有补充导航标签的图标。这些图标来自一种名为“FontAwesome”的字体。

根据许多地方推荐的最佳实践，我声明我的@font-face 规则如下：

```
@font-face {
    font-family: 'FontAwesome';
    src: url('../type/fontawesome-webfont.eot');
    src: url('../type/fontawesome-webfont.eot?#iefix') format('embedded-opentype'),
        url('../type/fontawesome-webfont.svg#FontAwesomeRegular') format('svg'),
        url('../type/fontawesome-webfont.woff') format('woff'),
        url('../type/fontawesome-webfont.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

如前所述，它在 IE7 中不起作用，甚至似乎根本没有加载字体。我已经在 IE7 模式下使用 IE9 在 Windows 7 上进行了测试，也已经在使用本机 IE7 的 XP 机器上进行了测试。我也尝试过使用字体文件的绝对路径，但这没有区别。

当我在整个设计中使用这些字体图标时，我希望它能够在 IE7 中工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:56:50.590

尝试向您的页面添加条件链接，链接到`font-awesome-ie7.css`Font Awesome 提供的单独链接。

```
<!--[if IE 7]>
  <link rel="stylesheet" href="css/font-awesome-ie7.css">
<![endif]--> 
```

有关详细信息，请参阅[问题 #38 。](https://github.com/FortAwesome/Font-Awesome/issues/38)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T22:34:57.737

如果您添加以下信息： - 您使用的是什么版本的引导程序 - 您使用的是什么版本的 font-awesome？

FontAwesome 最近才添加了对 IE7 的支持，但它需要 bootstrap 2.0.3 或更高版本。除此之外，当您编译它时，您必须确保并专门添加 .less 文件（或 css）。

他们的安装说明页没有提到，但是如果你想要ie7支持，除了他们说明页指定的font-awesome.less之外，你还需要添加要编译的**font-awesome-ie7.less文件。**

我让它在 ie7 中工作得很好，因为我们仍然需要在这里支持它。:(

根据不使用引导程序进行编辑： - 如果您使用 LESS，则需要编译上述两个 LESS 文件。- 如果使用 CSS，那么您需要复制两个 CSS 文件。**font-awesome-ie7.css**和 font-awesome.css 进入你的项目目录。（以及您已经拥有并在此处描述的所有其他内容：http: [//fortawesome.github.com/Font-Awesome/#integration](http://fortawesome.github.com/Font-Awesome/#integration)在“不使用引导程序”标题下。

# c++ - C++ 箭头运算符等价

> ID：11511227
> 
> 赞同：4
> 
> 时间：2012-07-16T19:31:44.577
> 
> 标签：c++, pointers

帖子[我可以使用什么来代替箭头运算符`->`？](https://stackoverflow.com/questions/221346/what-can-i-use-instead-of-the-arrow-operator) 和箭头运算符 (->) 在 C 状态下[的用法](https://stackoverflow.com/questions/2575048/arrow-operator-usage-in-c)

> 以下两个表达式是等价的：
> 
> ```
> x->y
> (*x).y 
> ```

但是，当被视为数学等价时，这似乎并不总是正确的。

为什么g++替换的时候会报错

```
a->b->c 
```

和

```
a->(*b).c 
```

?

似乎上述等价并不*总是*可以替换的。因此，我认为“等效”一词有点误导。

另外，在这个问题中，我并不是指任何类型的重载。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-16T19:33:07.650

您的关联规则错误。`a->b->c`是`(a->b)->c`，不是`a->(b->c)`，所以它变成`(*(a->b)).c`（然后`(*((*a).b)).c`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-16T19:33:20.653

因为您没有正确替换运算符。它应该是：

```
(*(a->b)).c 
```

你把你的表达`a->(b->c)`当你应该把它当做`(a->b)->c`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T19:36:36.627

您正在错误地进行替换。

`a->b->c`相当于`(*(a->b)).c`。

`a->(*b).c`由于多种原因没有意义。`b`不是可以取消引用的指针（指针是`a->b`）。此外，即使是这样，在字段的上下文中使用取消引用的指针`a`也没有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T19:51:02.950

您看到的问题是不同运算符的优先级问题，您应该使用：（`(*(x->y)).z`第二个操作数`->`是`(x->y)`and `z`）。但这之前已经回答过了。

然而，重要的是要注意，等价仅适用于*指针*，并且两个运算符在重载时的属性完全不同。语言中的`operator->`语义非常奇怪，从某种意义上说，它不代表单个操作，而是可以代表多个应用程序，`operator->`直到重载的运算符产生一个原始指针，此时它将执行一个等效于取消引用的最后一个应用程序加访问（即仅用于最后一个应用程序，`a->b`相当于`(*a)->b`。）

# c# - 用sharpziplib解压两个不同的zip文件到同一个目录

> ID：11511229
> 
> 赞同：0
> 
> 时间：2012-07-16T19:31:51.017
> 
> 标签：c#, file, unzip, sharpziplib

我环顾四周，似乎没有任何关于使用 sharpziplib 将多个 zip 文件提取到同一目录的信息。我正在使用 Telerik 控件 RadUpload 上传两个不同的 zip 文件夹，上传后它们会自动解压缩到与 zip 同名的文件夹中到同一目录。

例如：我有 autocorrect.zip 和 entertainment.zip。自动更正提取到名为“自动更正”的文件夹，娱乐提取到名为“娱乐”的文件夹。自动更正位于第一个框中，而娱乐位于第二个框中。

但在提取文件夹中只出现“娱乐”。现在我认为这是因为我当前设置解压缩方法的方​​式是它采用第一个值“自动更正”，然后它也将“娱乐”作为第一个值，因此不再列出“自动更正”以进行提取.

这是我解压缩方法的代码，如果您认为我的代码的其他部分会有所帮助，请说，我会发布更多信息：

```
public static void UnZip(string sourcePath, string targetPath)
{
    //Creates instance of fastzip from library ICSharpCode
    ICSharpCode.SharpZipLib.Zip.FastZip fz = new FastZip();
    //Extracts zip from sourcePath to target path which is chosen in the button click methods
    fz.ExtractZip(sourcePath, targetPath, "");
} 
```

编辑：这是使用 zip 文件的保存路径和提取的 zip 的保存路径调用解压缩的按钮方法（忘了说它适用于一个 zip，但不适用于多个 zip）

```
 protected void SubmitButton_Click(object sender, EventArgs e)
    {
        //Gets the name of the file being uploaded
        foreach (UploadedFile file in RadUpload1.UploadedFiles)
        {
            fileName = file.GetName();
        }
        //Path where zip files are uploaded
        String savePath = @"C:\Users\James\Documents\Visual Studio 2012\WebSites\CourseImport\CourseTelerik\";
        //Adds name of uploaded file onto end of saved path
        savePath += fileName;
        //Path where the extracted files from the uploaded zip are placed
        String unZipPath = @"C:\Users\James\Documents\Visual Studio 2012\WebSites\CourseImport\CourseTelerikExtract\";
        unZipPath += fileName;
        //Runs unzipping method
        UnZip(savePath, unZipPath); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:57:10.653

您的方法只是获取最后一个文件名并仅调用一次 UnZip

所以下面的代码将调用 RadUpload1.UploadedFiles 中可用的文件名总数

```
protected void SubmitButton_Click(object sender, EventArgs e)
{

String savePath = @"C:\Users\James\Documents\Visual Studio 2012\WebSites\CourseImport\CourseTelerik\";

String unZipPath = @"C:\Users\James\Documents\Visual Studio 2012\WebSites\CourseImport\CourseTelerikExtract\";

foreach (UploadedFile file in RadUpload1.UploadedFiles)
{
   string fileName = file.GetName();

   UnZip((savePath + fileName),  (unZipPath + fileName) );
}

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:49:04.360

看看这个并尝试使用这个例子::

[http://wiki.sharpdevelop.net/SharpZipLib-Zip-Samples.ashx](http://wiki.sharpdevelop.net/SharpZipLib-Zip-Samples.ashx)

检查一下并尝试使用以下示例： **Unpack a Zip with full control over the operation**

# sql - 当不存在时，如何使此查询返回结果？

> ID：11511232
> 
> 赞同：0
> 
> 时间：2012-07-16T19:31:55.577
> 
> 标签：sql, postgresql, join, postgis

Poly1 是一个边界框，用于计算 f1 和 f2 在其边界内的面积。如果 f1 存在，但 f2 不存在，如何使此查询返回结果？现在，如果边界框内只有 f1，则查询不会返回任何结果。

```
SELECT ST_Transform(poly1.the_geom,3857) AS the_geom_webmercator, 
       ST_AREA(ST_Union(ST_Transform(ST_Intersection(f1.the_geom,poly1.the_geom),3857)))*.000247105381 AS acreage_of_1,
       ST_AREA(ST_Union(ST_Transform(ST_Intersection(f2.the_geom,poly1.the_geom),3857)))*.000247105381 AS acreage_of_2
            FROM poly1 JOIN farmland f1 ON f1.polygon_type = 'A' AND
                                           st_intersects(f1.the_geom,poly1.the_geom)
                       JOIN farmland f2 ON f2.polygon_type = 'B'
            GROUP BY poly1.the_geom 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:40:52.973

您希望在“farmland f2”语句之前有一个左外连接。左外连接将保留所有行，即使 f2 中没有匹配项：

```
Select ST_Transform(poly1.the_geom,3857) as the_geom_webmercator, 
       ST_AREA(ST_Union(ST_Transform(ST_Intersection(f1.the_geom,poly1.the_geom),3857)))*.000247105381 AS acreage_of_1,
       ST_AREA(ST_Union(ST_Transform(ST_Intersection(f2.the_geom,poly1.the_geom),3857)))*.000247105381 AS acreage_of_2
FROM poly1 JOIN
     farmland f1
     ON f1.polygon_type = 'A' AND st_intersects(fp.the_geom,poly1.the_geom) **LEFT OUTER** JOIN
     farmland f2
     ON f2.polygon_type = 'B'
 group by poly1.the_geom 
```

# android - 从 ListView 中删除列表元素

> ID：11511239
> 
> 赞同：0
> 
> 时间：2012-07-16T19:32:27.037
> 
> 标签：android, android-listview

我有一个`ListView`使用网络服务填充的。我想从`ListView`For 中删除一个特定条目，我需要获取一个 ID（一个 texview 字段），它是其中的一个元素`ListView`并将其传递给数据库。`ImageView`对于需要单击以删除该条目的每个列表元素，我都有一个（红十字）。我只想在单击同一列表元素的删除图像时获取文本字段的值。我使用`android:onClick`xml 属性来调用函数`deleteEntry`。但我不确定如何获取与删除图像位于同一列表元素中的特定 ID 值。我怎样才能做到这一点？

**编辑**

这是我的适配器：

```
public class MyCustomAdapterWorkEntry extends ArrayAdapter<ViewWorkEntryBean> {

Context context;
int layoutResourceId;
ViewWorkEntryBean currentMRB;
Vector<ViewWorkEntryBean> data;

public MyCustomAdapterWorkEntry(Context context, int layoutResourceId, Vector<ViewWorkEntryBean> data) 
{
    super(context,layoutResourceId,data);
    this.layoutResourceId = layoutResourceId;
    this.context=context;
    this.data = data;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View row = convertView;
    MyStringReaderHolder holder;

    if(row==null)
    {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent,false);

        holder= new MyStringReaderHolder();

        holder.workLogID = (TextView)row.findViewById(R.id.worklog_id);

        holder.delete = (ImageView) row.findViewById(R.id.delete);

        row.setTag(holder);
    }
    else
    {
        holder=(MyStringReaderHolder) row.getTag();
    }

    ViewWorkEntryBean mrb = data.elementAt(position);

    holder.workLogID.setText(mrb.workLogID);

    holder.delete.setTag(mrb.workLogID);
    return row;
}

static class MyStringReaderHolder
{
TextView workLogID;
ImageView delete;

}
} 
```

这是删除功能：

```
public void DeleteWorkEntryClick(View v) {

    String workLogID = null;        

    workLogID = (String) v.getTag();

    deleteWorkEntry(workLogID);

} 
```

它仍然不起作用！workLogID 为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:36:44.663

> 我只想在单击同一列表元素的删除图像时获取文本字段的值。

发布一些相关代码会有所帮助，但这是一种通用方法。

假设您的行布局如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

我们可以为读取 TextView 文本的 Button 设置一个 OnClickListener，如下所示：

```
Button button = (Button) findViewById(R.id.button);
button.setOnClickListener(new OnClickListener() {
    public void onClick(View view) {
        LinearLayout parent = (LinearLayout) view.getParent();
        TextView textView = (TextView) parent.getChildAt(0);
        String text = textView.getText().toString();
        // text has what you want
    }
}); 
```

如果您想要一种更具前瞻性但劳动密集型的方法，请使用：

```
TextView text = (TextView) parent.findViewById(R.id.text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:03:39.033

使用 将需要传递给函数的特定 ID 值设置为列表中每个“X”按钮的标记值`setTag()`。这样，当单击的视图传递给您的`onClick()`方法时，您可以再次调用`view.getTag()`以获取该数字并将其传递给您的数据库函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:24:06.327

我假设您正在使用适配器来构建您的 ListView，无论是标准的还是自定义的，这并不重要。

也就是说，从 ListView 中删除列表项由适配器负责，基本上您的适配器必须有一个 removeItem 方法，该方法将从列表中删除该项目并通知数据集已更改。

我不知道你的代码的结构，但它应该是这样的：

```
public class YourAdapter extends BaseAdapter {

...

List<YourDataClass> list;

...

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    ...
}

...

public void removeItem(YourDataClass instance) {
    list.remove(instance);
    notifyDataSetChanged();
}

...
}

public class YourActivity extends Activity {

...

private ListView listView;
private YourAdapter yourAdapter;

...

private final OnItemClickListener listItemOnClickListener = new OnItemClickListener()     {
    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            YourDataClass itemToRemove = yourAdapter.getItem(position);
            yourAdapter.removeItem(itemToRemove);
    }
};

...

@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    list.setOnItemClickListener(listItemOnClickListener);
    ...
}

...

} 
```

关键是 yourDataClass 必须覆盖：

```
public YourDataClass {

    ...

    @Override
    public boolean equals(Object obj) {...}

    @Override
    public int hashCode() {...}

    ...
} 
```

在不知道您的代码的情况下，我假设您以某种方式构建您的代码，希望它会有所帮助！

附言。我使用项目单击侦听器构建了示例，如果您希望列表项的子视图可单击并执行删除，那么您需要将逻辑移动到适配器中的 getView 方法。

# java - 我如何从 html 中获取细节？

> ID：11511240
> 
> 赞同：1
> 
> 时间：2012-07-16T19:32:29.893
> 
> 标签：java, html, urlconnection

我有一些 java 代码可以从我选择的网站打印出 html。我希望它只打印出 HTML 代码中的特定日期，如下所示：

```
<tr class="bgWhite">
  <td align="center" width="50"><nobr>GD&#160;</nobr></td>
  <td align="center">Q3&#160;2012</td>

  <td align="left" width="*">Q3 2012 General Dynamics Earnings Release</td>
  <td align="center">$ 1.83&#160;</td>
  <td align="center">n/a&#160;</td>
  <td align="center">$ 1.83&#160;</td>
  <td align="center"><nobr>24-Oct-12</nobr></td>
</tr>
<tr class="bgWhite">
  <td align="center" width="50"><nobr>GD&#160;</nobr></td>
  <td align="center">Q2&#160;2012</td>

  <td align="left" width="*">Q2 2012 General Dynamics Earnings Release</td>
  <td align="center">$ 1.75&#160;</td>
  <td align="center">n/a&#160;</td>
  <td align="center">$ 1.79&#160;</td>
  <td align="center"><nobr>25-Jul-12 BMO</nobr></td>
</tr> 
```

所以我只希望它打印出来：24-Oct-12 25-Jul-12

我怎么做？

这是我拥有的代码：

```
String nextLine;
URL url = null;
URLConnection urlConn = null;
InputStreamReader  inStream = null;
BufferedReader buff = null;

try{
    // Create the URL obect that points
    // at the default file index.html
    url  = new URL("http://www.earnings.com/company.asp?client=cb&ticker=gd");
    urlConn = url.openConnection();
    inStream = new InputStreamReader( 
                       urlConn.getInputStream());
    buff= new BufferedReader(inStream);

    // Read and print the lines from index.html
    while (true){
        nextLine =buff.readLine();  
        if (nextLine !=null){
            System.out.println(nextLine); 
        }
        else{
           break;
        } 
    }
 } catch(MalformedURLException e){
   System.out.println("Please check the URL:" + 
                                       e.toString() );
 } catch(IOException  e1){
  System.out.println("Can't read  from the Internet: "+ 
                                      e1.toString() ); 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:43:35.590

使用一个完整的 HTML 解析器来完成这项工作比低级更容易`java.net.URLConnection`。然而，由于目标网站生成绝对非语义的 HTML（一个和所有没有任何语义标识符/类的表，就像 90 年代的平均网站看起来如何（恶心）），即使是一个像样的 HTML 解析器也很难正确解析它。但无论如何，这是一个使用[Jsoup](http://jsoup.org)的完整启动示例，它可以准确打印您需要的信息：

```
Document document = Jsoup.connect("http://www.earnings.com/company.asp?client=cb&ticker=gd").get();
Elements dateColumn = document.select("table:eq(0) tr:eq(0) table:eq(7) tr:eq(2) table:eq(4) td:eq(6):not(.dataHdrText02)");

for (Element dateCell : dateColumn) {
    System.out.println(dateCell.text());
} 
```

就这样。无需为低级`java.net.URLConnection`或冗长的 SAX 解析器而烦恼。

### 也可以看看：

*   [领先的 Java HTML 解析器的优缺点是什么？](https://stackoverflow.com/questions/3152138/what-are-the-pros-and-cons-of-the-leading-java-html-parsers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:37:24.770

我认为这是 SAX 解析器的标准 UC。您不应该逐行进行（您不能期望 html 文档总是按照当前的方式组织，因此使用 SAX 解析器将是一种更灵活的解决方案）。

如果你有关于文档大小的信息并且你知道它不会增长太多，你也可以使用 DOM 解析器。但是从这个角度来看，SAX 解析器也更好。

# javascript - 在javascript中分配之前的变量阴影和测试是否存在

> ID：11511242
> 
> 赞同：4
> 
> 时间：2012-07-16T19:32:31.753
> 
> 标签：javascript, shadowing

在下面的代码片段中，我声明了一个全局变量，然后检查它是否存在于函数中。

```
<script>
x = 5;
$(function() {
   var x = x || 3;
   console.log(x); // prints 3
});
</script> 
```

这表现不同：

```
<script>
x = 5;
$(function() {
   var y = x || 3;
   console.log(y); // prints 5
});
</script> 
```

我希望在第一个示例中，内部作用域中的变量声明将检测到 x 已经存在于全局作用域中，并取其值。为什么第一个例子3？

具体来说，我最近编写了一些代码来检查`var _gaq = _gaq || []`jQuery 就绪范围，并且当没有任何内容发布到 Analytics 时感到困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:41:35.510

你`x`在错误的范围内寻找。由于变量提升，实际上在您的检查发生之前定义了一个值为 的`var x`局部变量：`x``undefined``x || 3`

```
var x = x || 3; 
```

实际上是：

```
var x = undefined;
x = x || 3; 
```

只需将其更改为`x`在`window`对象上查找：

```
var x = window.x || 3; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:43:50.610

第一个示例记录 3 因为 `any variable that is initialized inside a function using the var keyword will have a local scope. If a variable is initialized inside a function without var, it will have a global scope.`

所以在第一种情况下，当局部`x`被分配时，由于它未初始化，它被分配 3。

而在第二种情况下，`x`指的是全局变量，因为函数内部`x`没有声明。`x`

相反，如果你尝试这个

```
<script>
x = 5;
$(function() {
   x = x || 3;
   console.log(x);
});
</script> 
```

**或者**

```
<script>
x = 5;
$(function() {
   var x = window.x || 3;
   console.log(x);
});
</script> 
```

你会得到预期的结果`5`。

此外，与 C 及其家族（具有**块级作用域**）不同，JavaScript 具有**函数级作用域**。块，例如 if 语句，不会创建新范围。只有函数会创建新范围。

所以如果我要写类似的东西

```
#include <stdio.h>
int main() {
    int x = 1;
    printf("%d, ", x); // 1
    if (1) {
        int x = 2;
        printf("%d, ", x); // 2
    }
    printf("%d\n", x); // 1
} 
```

输出：**1,2,1**

相比于

```
var x = 1;
console.log(x); // 1
if (true) {
    var x = 2;
    console.log(x); // 2
}
console.log(x); // 2 
```

输出：**1,2,2**

[阅读这篇关于JavaScript 作用域和提升](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)的优秀博客文章，以更好地理解它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:38:56.493

`var x`in 函数声明 x 是函数的局部变量，因此 in x`x || 3`不是全局 x ，因此未定义，因为它尚未初始化。

在`var y = x || 3;`x 中是全局 x，因为没有 x 局部函数。

# java - 如何避免两个函数中的相同逻辑。

> ID：11511243
> 
> 赞同：0
> 
> 时间：2012-07-16T19:32:33.857
> 
> 标签：java

我不想重复一段特定的代码，并且需要关于如何更好地构建它的建议

```
public static final int TAB_A= 0;
public static final int TAB_B= 2;
public static final int TAB_C= 3;
public static final int NO_TAB = -1;

public String getTabName() {
    switch (getTabId()) {
        case TAB_A:
            return "TA";
        case TAB_B:
            return "TB";
        case TAB_C:
            return "TC";
        default:
            return "NT";
    }
}

public string execute() {  
  setResults(getTabName());
}

public int getUserCount() {
    SomeVO vo = (SomeVO) getFirstResultSet().get(0);
    switch (getTabId()) {
        case TAB_A:
            return vo.getTabAResults();
        case TAB_B:
            return vo.getTabBResults();
        case TAB_C:
            return vo.getTabCResults();
        default:
            return vo.getSomeStuff();
    }        
} 
```

我希望能够整合`getTabName()`和`getUserCount()`方法中的逻辑。

让 switch 语句检查相同的东西似乎效率不高，但它们返回了两种不同的东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:50:55.567

我能想到的唯一解决方案是在简单和不过度设计之间取得平衡（正如其中一条评论中强调的那样）是：

```
private <T> T mapFromTabId(T a, T b, T c, T def) {
    switch (getTabId()) {
        case TAB_A:
            return a;
        case TAB_B:
            return b;
        case TAB_C:
            return c;
        default:
            return def;
    }
} 
```

你像这样使用它：

```
public String getTabName() {
    return mapFromTabId("TA", "TB", "TC", "NT");
}

public int getUserCount() {
    return mapFromTabId(vo.getTabAResults(), vo.getTabBResults(), vo.getTabCResults(), vo.getSomeStuff());
} 
```

这种方法的唯一问题是所有参数都被急切地评估，这在你的情况下不是问题，但在其他情况下可能是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:01:28.667

下面是一个使用 enum 做脏活的例子：

```
import java.lang.reflect.Method;

public class Test {

    public enum TABS {
        TAB_A("TA", "getTabAResults"),
        TAB_B("TB", "getTabBResults"),
        TAB_C("TC", "getTabCResults"),
        NO_TAB("NT", "getSomeStuff");

        private String name, method;

        private TABS(String name, String method) {
            this.name = name;
            this.method = method;
        }

        public String getName() {
            return name;
        }

        public int getResults(SomeVO vo) {
            int result = -1;
            try {
                Method m = vo.getClass().getMethod(method);
                result = (Integer) m.invoke(vo, (Object[]) null);
            } catch (Exception ex) {
                ex.printStackTrace();
            }
            return result;
        }
    }

    static class SomeVO {
        public int getTabAResults() {
            return 1;
        }

        public int getTabBResults() {
            return 2;
        }

        public int getTabCResults() {
            return 3;
        }

        public int getSomeStuff() {
            return 4;
        }
    }

    public static void main(String[] args) {
        SomeVO someVO = new SomeVO();
        System.out.println(TABS.TAB_A.getName() + " is "
                + TABS.TAB_A.getResults(someVO));
        System.out.println(TABS.TAB_B.getName() + " is "
                + TABS.TAB_B.getResults(someVO));
        System.out.println(TABS.TAB_C.getName() + " is "
                + TABS.TAB_C.getResults(someVO));
        System.out.println(TABS.NO_TAB.getName() + " is "
                + TABS.NO_TAB.getResults(someVO));
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:50:23.790

我会使用 Java`enum`而不是`static int`s 和`switch`子句。枚举的好处是您可以将值限制为您声明的值。

```
public enum AnEnum {
    VAL_A {
        public String getName() { return "A"; }
        public int getResult(Thing t) { return t.getResultsA(); }
    };

    public abstract String getName();
    public abstract int getResult(Thing t);
} 
```

还值得一看[Oracle的枚举文档](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T21:06:11.687

为选项卡的公共方面创建一个接口或抽象类，然后为每个方面使用实现类。在伪代码中：

```
public abstract class Tab {
    public abstract String getTabName();
    public abstract int getUserCount();

    // ...
}

public final class TabA extends Tab {
    private static final String NAME = "TA";

    // ...

    @Override
    public String getTabName() {
        return NAME;
    }

    @Override
    public int getUserCount() {
      SomeVO vo = (SomeVO)getFirstResultSet().get(0);
      return vo.getResults();
    }
} 
```

您可以使用枚举来维护它们的列表，但要小心将实现逻辑放入枚举中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T19:53:05.707

像这样使用枚举：

```
public static enum TableType {

    TAB_A(0, "TA"){
        private int _getUserCound(SomeVO vo){
            return vo.getTabAResults();
        }
    },
    TAB_B(2, "TB"){
        private int _getUserCound(SomeVO vo){
            return vo.getTabBResults();
        }
    },
    TAB_C(3, "TC"){
        private int _getUserCound(SomeVO vo){
            return vo.getTabCResults();
        }
    },
    NO_TAB(-1, "NT"){
        private int _getUserCound(SomeVO vo){
            return vo.getSomeStuff();
        }
    };

    int id;
    String name;
    private TableType(int id, String name) {
        this.id = id;
        this.name = name;
    }

    public int getId() {
        return id;
    }

    public String getName() {
        return name;
    }

    private abstract int _getUserCound(SomeVO vo);

    public int getUserCount(){
        SomeVO vo = (SomeVO) getFirstResultSet().get(0);
        return _getUserCound(vo);
    }

    public static TableType fromId(int id){
        for (TableType v : values()){
            if (v.getId() == id) return v;
        }
        return NO_TAB;
    }

}

public String getTabName() {
    return TableType.fromId(getTabId()).getName();
}

public string execute() {
    setResults(getTabName());
}

public int getUserCount() {
    return TableType.fromId(getTabId()).getUserCount();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T19:45:46.750

使用枚举作为其每个值的 CTOR 获取您需要的值（如“TA”，...），将其存储在 CTOR 中，并使用方法返回此值。

这样你就不需要使用开关了。

链接： [http ://docs.oracle.com/javase/tutorial/java/javaOO/enum.html](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-16T20:45:53.883

最好使用 bean 类并添加属性/操作以对该类进行访问和变异。您可以进行构造函数注入或 Setter 注入，我更喜欢 Setter 注入，它将我的代码与 bean 分离。

并编写一个返回 Bean 的方法，在 switch 中设置 bean 中的值并返回 bean。通过它，您实际上是在一个地方维护您的代码并将所有数据保存在一起。在我看来，这是最简单的解决方案。希望这对您有所帮助。

# javascript - 如何在 textarea 中使用 keydown 事件？

> ID：11511250
> 
> 赞同：3
> 
> 时间：2012-07-16T19:33:03.620
> 
> 标签：javascript, greasemonkey

我不太习惯使用 javascript，但我已经厌倦了在工作中手动重复品尝。当我在论坛上写作时，我需要一个快速的简短命令，例如 Ctrl-Alt-z，将一些文本插入到 textarea 对象中。

我已经编写了一个在文本光标 insertAtCursor(text) 处插入文本的函数。文本区域的 ID 是“内容”。

我知道如何解决检查组合键的问题。我遇到的问题基本上是检查任何键盘输入。

我尝试了以下方法：

```
document.keydown(function(event){
  alert("Test");
}); 
```

但是，它不起作用。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T19:36:18.863

如果您正在寻找跨浏览器解决方案，我认为您将遇到困难。这里有一些可以帮助你的东西：[http ://www.quirksmode.org/dom/events/keys.html](http://www.quirksmode.org/dom/events/keys.html)

基本上，你会想要这样的东西：

```
document.getElementById('content').addEventListener('keydown', function (e){
    // Do your key combination detection
}, false); 
```

[MDN 关于事件。可能更有帮助](https://developer.mozilla.org/en/DOM/KeyboardEvent)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T19:40:45.447

```
var textarea = document.getElementById('textarea');

textarea.onkeydown = function ()
{
   alert("Test");
}; 
```

使用 jQuery（[委托](http://api.jquery.com/delegate/)）。

```
$("body").delegate("textarea", "keydown",function(e){
        alert("Test");
        //code logic goes here
        //if(e.which == 13){
        //Enter key down    
    }
}); 
```

或者

```
$('textarea').live("keydown", function(e) {
    alert("Test");
    // e.which is which key, e.g. 13 == enter
}); 
```

[在线](http://api.jquery.com/live/)文档。[事件](http://api.jquery.com/category/events/event-object/)文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-18T13:24:17.093

```
document.querySelector('textarea') // find a DOM element (by tag name at this case)
  .addEventListener('keydown', // bind an event listener for "keydown" event
    e => { // declare a callback function when that event happens
      console.log(e.target.value) // print the target node value (<Textarea>)
    })
```

```
<textarea></textarea>
```

# iphone - 如何使用 xcode 中的按钮移动字符/对象

> ID：11511255
> 
> 赞同：-2
> 
> 时间：2012-07-16T19:33:12.137
> 
> 标签：iphone, objective-c, ios

我在 xcode 工作并开发类似街机的游戏。当按下标记为右的按钮时，我似乎无法弄清楚如何仅在 x 轴上向右移动我的角色。我已经想出了几乎所有其他方法来让角色移动，但是有一个按钮，这让这更加令人沮丧，对你们大多数人来说，这可能是一个非常简单的答案。我正在用objective-c写。如果您能向我展示代码，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:40:00.277

好吧，如果您有一个正在 UIImageView、UIView 或 UIView 的其他子类中显示的角色，您只需将框架更新为您希望角色移动的距离。

```
- (IBAction)move {

int distanceRight = 5.0;

theView.frame = CGRectMake(theView.frame.origin.x + distanceRight, theView.frame.origin.y, theView.frame.size.width, theView.frame.size.height);

} 
```

不，您可以将 View.frame 调用包装在 UIView 动画块中，以使其动画到新位置，而不仅仅是跳跃。

```
[UIView animateWithDuration:1.0f
                 animations:^{
                        theView.frame = CGRectMake(theView.frame.origin.x + distanceRight, theView.frame.origin.y, theView.frame.size.width, theView.frame.size.height);
                     }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:36:52.607

我假设这只是使用常规框架而不是 cocos2d 之类的东西。您需要更新对象的框架或中心！

```
-(void)buttonPressed:(id)sender {
    CGRect frame = self.myObject.frame;
    frame.origin.x += 20; //however many pixels to the right..
    self.myObject.frame = frame;
} 
```

# java - JavaFX FXML - 如何在带有分页的 GridPane 中显示集合？

> ID：11511262
> 
> 赞同：0
> 
> 时间：2012-07-16T19:33:31.037
> 
> 标签：java, javafx, fxml

我在 FXML 中有以下 GridPane：

（此代码由 JavaFX Scene Builder 生成）

```
<GridPane fx:id="gridUsers" alignment="TOP_CENTER" layoutX="13.0" layoutY="161.0" prefWidth="763.0">
  <children>
    <Label fx:id="codigoUsuarioLabel" text="Code" GridPane.columnIndex="0" GridPane.rowIndex="0">
      <font>
        <Font name="System Bold" size="18.0" fx:id="x2" />
      </font>
    </Label>
    <Label fx:id="userNameLabel" font="$x2" text="Name" GridPane.columnIndex="1" GridPane.rowIndex="0" />
    <Label fx:id="loginUserLabel" font="$x2" text="Login" GridPane.columnIndex="2" GridPane.rowIndex="0" />
    <Label fx:id="userOptionsLabel" font="$x2" text="Options" GridPane.columnIndex="3" GridPane.rowIndex="0" />
  </children>
  <columnConstraints>
    <ColumnConstraints hgrow="SOMETIMES" maxWidth="308.0" minWidth="10.0" prefWidth="102.0" />
    <ColumnConstraints hgrow="SOMETIMES" maxWidth="482.0" minWidth="0.0" prefWidth="318.0" />
    <ColumnConstraints hgrow="SOMETIMES" maxWidth="244.0" minWidth="10.0" prefWidth="244.0" />
    <ColumnConstraints hgrow="SOMETIMES" maxWidth="100.0" minWidth="10.0" prefWidth="100.0" />
  </columnConstraints>
  <rowConstraints>
    <RowConstraints maxHeight="30.0" minHeight="10.0" prefHeight="30.0" vgrow="SOMETIMES" />
    <RowConstraints maxHeight="30.0" minHeight="10.0" prefHeight="30.0" vgrow="SOMETIMES" />
  </rowConstraints>
</GridPane> 
```

在我的 UserController 中，我有一个包含 User 对象的集合。我想将此集合从 Controller 传递到 GridPane 并列出对象，最好使用分页。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:55:48.280

如果你可以使用[JavaFX 2.2+](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)，这个版本的JavaFX有一个内置的分页控件可以提供。否则，您将需要自己编写这样的功能或将控件从[2.2 开源存储库](http://hg.openjdk.java.net/openjfx/2.2/master/rt)反向移植到您的代码中。

# wpf - 数据输入布局 (XAML)

> ID：11511264
> 
> 赞同：0
> 
> 时间：2012-07-16T19:33:46.793
> 
> 标签：wpf, xaml

我对 WPF 很陌生，我想创建一个模式弹出设置管理器。我的客户可以以不同的分辨率使用我的应用程序。我还想稍后扩展我的设置管理器并添加更多字段（文本框等）。我已经创建了它的基本版本，但我不确定我是否在设计布局时遵循了所有最佳实践（面板类型、元素的宽度/高度等）。我附上了我正在尝试实现的屏幕截图，并且我还附上了 XAML 与这篇文章。如果我可以做任何更改来改进布局，我将非常感谢您的反馈（以使其更易于维护，因为我将很快添加更多这样的表单）。

注意：我知道我现在已经硬编码文本（不支持本地化等），但现在我只关心布局。我真的很感谢你的帮助。

```
<Window.Resources>

</Window.Resources>
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <TextBlock Width="350" VerticalAlignment="Top" Grid.Row="0" FontFamily="Microsoft Sans Serif" FontSize="11" Foreground="#FFFEFFFC" Text="This is the header containing information related to my dialogbox. It can be multiple lines aswell." Background="{StaticResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" TextWrapping="Wrap" Grid.ColumnSpan="3" Padding="5" />

    <GroupBox Grid.Row="1" Header="My Group Box" Margin="5" Padding="5">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"></RowDefinition>
                <RowDefinition Height="auto"></RowDefinition>
                <RowDefinition Height="auto"></RowDefinition>
                <RowDefinition Height="auto"></RowDefinition>
            </Grid.RowDefinitions>

            <StackPanel  Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left">
                <TextBlock VerticalAlignment="Center" Text="My Label1" />
                <Label DockPanel.Dock="Right" VerticalAlignment="Center" Foreground="Crimson" Content="*" />
            </StackPanel>

            <StackPanel Grid.Row="1" Orientation="Vertical">
                <TextBox TextWrapping="Wrap" Margin="0,0,0,0" MaxLength="255" />
                <TextBlock TextWrapping="Wrap" Visibility="Visible"  Margin="0,2,0,0" Name="labelError1" VerticalAlignment="Top" FontSize="10" Foreground="#FFD80000" Text="Error Message for my textbox1" MaxWidth="455"/>
            </StackPanel>

            <StackPanel  Grid.Row="2"  Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,0">
                <TextBlock VerticalAlignment="Center" Text="My Label 2" />
                <Label DockPanel.Dock="Right" VerticalAlignment="Center" Foreground="Crimson" Content="*"/>
            </StackPanel>
            <StackPanel Grid.Row="3" Orientation="Vertical">
                <TextBox TextWrapping="Wrap" Margin="0,0,0,0" MaxLength="255" />
                <TextBlock TextWrapping="Wrap" Visibility="Visible"  Margin="0,2,0,0" Name="label1" VerticalAlignment="Top" FontSize="10" Foreground="#FFD80000" Text="Error Message for my textbox2" MaxWidth="455"/>
            </StackPanel>

        </Grid>
    </GroupBox>

    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,10,10" HorizontalAlignment="Right" >
        <Button Name="OkButton" Width="88" Height="28"  IsDefault="True" Content="OK"  Command="{Binding Path=OkCommand, Mode=OneWay}" HorizontalAlignment="Right"  Margin="0,0,6,0"/>
        <Button Name="CancelButton" Width="88" Height="28" IsCancel="True" Content="Cancel" HorizontalAlignment="Left" Margin="0"/>
    </StackPanel>
</Grid> 
```

* * *

```
<Window xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"  
        x:Class="WpfApplication1.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="My Settings Manager" 
        SizeToContent="Height"
        Background="#ffe6e6e6"
        MinWidth="350"
        MinHeight="290"
        Width="350"
        >

    <Window.Resources>

    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TextBlock VerticalAlignment="Top" Grid.Row="0" FontFamily="Microsoft Sans Serif" FontSize="11" Foreground="#FFFEFFFC" Text="This is the header containing information related to my dialogbox. It can be multiple lines aswell." Background="{StaticResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" TextWrapping="Wrap" Grid.ColumnSpan="3" Padding="5" />

        <GroupBox Grid.Row="1" Header="My Group Box" Margin="5" Padding="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="10"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="auto"></RowDefinition>
                    <RowDefinition Height="*"></RowDefinition>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Text="My Label1" />
                <TextBlock Grid.Row="0" Grid.Column="1" Foreground="Crimson" Text="*" Margin="4,2,0,0"/>
                <TextBox Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" TextWrapping="Wrap" Margin="0,0,0,0" MaxLength="255" />
                <TextBlock Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,2,0,0" Name="labelError1" VerticalAlignment="Top" FontSize="10" Foreground="#FFD80000" Text="Error Message for my textbox1" />

                <TextBlock Grid.Row="4" Grid.Column="0" VerticalAlignment="Center" Text="My Label1"  />
                <TextBlock Grid.Row="4" Grid.Column="1" Foreground="Crimson" Text="*" Margin="4,2,0,0"/>
                <TextBox Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2" TextWrapping="Wrap" Margin="0,0,0,0" MaxLength="255" />
                <TextBlock Grid.Row="6" Grid.Column="0" Grid.ColumnSpan="2" Margin="0,2,0,0" Name="labelError2" VerticalAlignment="Top" FontSize="10" Foreground="#FFD80000" Text="Error Message for my textbox1" />
            </Grid>
        </GroupBox>

    <Button Grid.Row="2" Name="OkButton" Width="88"   IsDefault="True" Content="OK" Padding="0,3,0,3" Margin="0,5,5,5" HorizontalAlignment="Right"/>
    <Button Grid.Row="2" Name="CancelButton" Width="88" IsCancel="True" Content="Cancel"  Margin="0,5,100,5" Padding="0,3,0,3" HorizontalAlignment="Right"/>

    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:09:48.003

有几件事对我来说很突出......

*   UI 对象的通用名称。我讨厌看到名为`label1`,`textbox1`等的东西。要么给它们命名为描述性的，要么根本不为它们指定名称。通常我不会命名任何东西，除非我需要在代码中的某处引用它。

*   您将 a`Grid`用于行，然后将 Horizo​​ntal StackPanels 用于列。你为什么不使用`Grid`你的行和列？这样一来，您的 UI 树中的对象就会减少，并且您的列将排列整齐

*   你不需要设置很多默认的东西。例如，控件是`Visible`默认的，所以`Visibility="Visible"`看起来没有必要，只会让代码更难阅读

*   一些通用的东西可以放在 Style 中，而不是放在 中，`<Tag>`以便更容易阅读 XAML。通常，我会尝试将所有样式属性（`Margin`、`Height`、`Alignment`等）放在`<Style>`标签中，并且只在 XAML 的正文中保留相关的布局属性（例如`DockPanel.Dock`or `Grid.Column`）和数据（`Text`、`Tooltip`、`Command`等）。

# c - 无法检测到以下代码未矢量化的原因

> ID：11511272
> 
> 赞同：11
> 
> 时间：2012-07-16T19:34:38.033
> 
> 标签：c, sse, vectorization, icc, stencils

一段时间以来，我一直在努力对特定应用程序进行矢量化，并且我已经尝试了所有方法。从自动矢量化到手动编码的 SSE 内在函数。但不知何故，我无法在基于模板的应用程序上获得加速。

以下是我当前代码的片段，我使用 SSE 内在函数对其进行了矢量化。当我使用 -vec-report3 编译（英特尔 icc）它时，我不断收到此消息：
***备注：循环未矢量化：语句无法矢量化。***

```
 #pragma ivdep
  for ( i = STENCIL; i < z - STENCIL; i+=4 )
  {
    it = it2 + i;

    __m128 tmp2i = _mm_mul_ps(_mm_add_ps(_mm_load_ps(&p2[i+j*it_j-it_j4+k*it_k]),_mm_load_ps(&p2[i+j*it_j+it_j4+k*it_k])),X4_i); //loop was not vectorized: statement cannot be vectorized
    __m128 tmp3 = _mm_mul_ps(_mm_add_ps(_mm_load_ps(&p2[i+j*it_j-it_j3+k*it_k]),_mm_load_ps(&p2[i+j*it_j+it_j3+k*it_k])),X3_i);
    __m128 tmp4 = _mm_mul_ps(_mm_add_ps(_mm_load_ps(&p2[i+j*it_j-it_j2+k*it_k]),_mm_load_ps(&p2[i+j*it_j+it_j2+k*it_k])),X2_i);
    __m128 tmp5 = _mm_mul_ps(_mm_add_ps(_mm_load_ps(&p2[i+j*it_j-it_j +k*it_k]),_mm_load_ps(&p2[i+j*it_j+it_j +k*it_k])),X1_i);

    __m128 tmp6 = _mm_add_ps(_mm_add_ps(_mm_add_ps(tmp2i,tmp3),_mm_add_ps(tmp4,tmp5)), _mm_mul_ps(_mm_load_ps(&p2[it]),C00_i));

    _mm_store_ps(&tmp2[i],tmp6);

   } 
```

我错过了一些重要的东西吗？由于该消息没有详细说明为什么它不能被矢量化，我发现很难确定瓶颈。

**更新：** 在仔细考虑建议后，我按以下方式调整了代码。我认为最好将其进一步分解，以确定实际上导致向量依赖的语句。

```
//#pragma ivdep
  for ( i = STENCIL; i < z - STENCIL; i+=4 )
  {
    it = it2 + i;
    __m128 center = _mm_mul_ps(_mm_load_ps(&p2[it]),C00_i);

    u_j4 = _mm_load_ps(&p2[i+j*it_j-it_j4+k*it_k]); //Line 180
    u_j3 = _mm_load_ps(&p2[i+j*it_j-it_j3+k*it_k]);
    u_j2 = _mm_load_ps(&p2[i+j*it_j-it_j2+k*it_k]);
    u_j1 = _mm_load_ps(&p2[i+j*it_j-it_j +k*it_k]);
    u_j8 = _mm_load_ps(&p2[i+j*it_j+it_j4+k*it_k]);
    u_j7 = _mm_load_ps(&p2[i+j*it_j+it_j3+k*it_k]);
    u_j6 = _mm_load_ps(&p2[i+j*it_j+it_j2+k*it_k]);
    u_j5 = _mm_load_ps(&p2[i+j*it_j+it_j +k*it_k]);

    __m128 tmp2i = _mm_mul_ps(_mm_add_ps(u_j4,u_j8),X4_i);
    __m128 tmp3 = _mm_mul_ps(_mm_add_ps(u_j3,u_j7),X3_i);
    __m128 tmp4 = _mm_mul_ps(_mm_add_ps(u_j2,u_j6),X2_i);
    __m128 tmp5 = _mm_mul_ps(_mm_add_ps(u_j1,u_j5),X1_i);

    __m128 tmp6 = _mm_add_ps(_mm_add_ps(tmp2i,tmp3),_mm_add_ps(tmp4,tmp5));
    __m128 tmp7 = _mm_add_ps(tmp6,center);

    _mm_store_ps(&tmp2[i],tmp7);  //Line 196

   } 
```

当我编译（icc）上面的代码时没有`#pragma ivdep`收到以下消息：

```
remark: loop was not vectorized: existence of vector dependence.
vector dependence: assumed FLOW dependence between tmp2 line 196 and tmp2 line 196.
vector dependence: assumed ANTI dependence between tmp2 line 196 and tmp2 line 196. 
```

当我用 编译（icc）它时`#pragma ivdep`，我收到以下消息：

```
remark: loop was not vectorized: unsupported data type. //Line 180 
```

为什么建议对第 196 行有依赖关系？如何消除建议的向量依赖性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T01:51:08.197

问题是您正在尝试将自动矢量化与手动矢量化代码一起使用。编译器说该行不能向量化，因为你不能向量化向量函数。

要么让编译器自动矢量化它，要么禁用自动矢量化并手动矢量化你的代码。正如已经评论过的，自动矢量化器将计算矢量化盈利能力：它检查是否值得矢量化您的代码。

# ios - 使用 CGContextStrokePath 绘制的路线随着航向的旋转而旋转

> ID：11511281
> 
> 赞同：0
> 
> 时间：2012-07-16T19:35:22.853
> 
> 标签：ios, mkmapview, mapkit

我创建了一个地图应用程序，它可以在两个位置之间绘制路线。假设用户的位置和目的地。

为了向用户显示目的地的方向，相对于他们的位置，我实现了：

```
setUserTrackingMode:MKUserTrackingModeFollowWithHeading 
```

路线是使用绘制`CGContextStrokePath`的，路径是用`UIImageView`.

每次`regionDidChangeAnimated`调用我都会刷新路径。但是在它被调用之前，路线会随着“前照灯”旋转（如果你知道我的意思）？

因此，当我尝试将手机指向目的地时，地图会旋转，我刚刚划过的路线也会旋转。直到用户触摸屏幕并重新绘制路径。

我的问题是：
我怎样才能阻止我绘制的路线用头灯转弯？

# object - 在错误类型的对象上找不到属性？

> ID：11511282
> 
> 赞同：1
> 
> 时间：2012-07-16T19:35:27.690
> 
> 标签：object, properties

```
DetailViewController *dvController = [[DetailViewController alloc] initWithNibName:@"DetailView" bundle:[NSBundle mainBundle]];
dvController.selectedCollege = selectedCollege;
[self.navigationController pushViewController:dvController animated:YES];
[dvController release];
dvController = nil; 
```

我收到错误

> 在第 3 行的“DetailViewController”类型的对象上找不到属性“selectedCollege”。

# c# - 在 DataTemplate.Triggers 中设置 DataTemplate.VisualTree

> ID：11511285
> 
> 赞同：2
> 
> 时间：2012-07-16T19:35:39.803
> 
> 标签：c#, wpf, mvvm

大家好，我正在尝试更改我的 dataGrid 中列的模板，但我找不到在 XAML 中执行此操作的方法。我试图通过这种方式做到这一点

```
<DataTemplate>
    <DataTemplate.Triggers>
        <Trigger Property="{Binding ElementName=isComboBox, Path=IsChecked}"
                 Value="True">
            <Setter Property="VisualTree">
                <Setter.Value>
                    <ComboBox ItemsSource="{Binding elementos}"/>                
                </Setter.Value>
            </Setter>
        </Trigger>
    </DataTemplate.Triggers>
</DataTemplate> 
```

但是一个错误告诉我，有`The property VisualTree cannot be set as a property element on template. Only Triggers and Storyboards are allowed as property elements`没有人知道根据另一个控件在 DataGridCell 中更改模板的不同方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:59:12.213

您不会在模板*中更改模板*，这不是它的工作方式。

有很多方法可以做到这一点。取决于您的应用程序的配置方式。最常用的方法是

1.  ContentControl 或 ItemsControl 绑定到属性/集合
2.  集合包含一个或多个不同类型的实例
3.  您在应用程序的资源中定义 DataTemplates，其 DataType 与您的实例类型匹配

例如，您的应用程序中有几个模型

```
public sealed class Foo
{
    public string Text {get;set;}
}

public sealed class Bar
{
    public bool Checked {get;set;}
} 
```

您的应用程序公开了一个包含一个或多个这些实例的属性

```
public partial class MainWindow : Window
{
    //INotifyPropertyChanged/DependencyObject stuff left out!
    public object FooOrBar {get;set;} 

    //snip
} 
```

在您的 XAML 中，您有一个 UIElement 类型，它扩展了[ItemsControl](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector%28v=vs.100%29.aspx)或[ContentControl](http://msdn.microsoft.com/en-us/library/system.windows.controls.contentcontrol.contenttemplateselector%28v=vs.100%29.aspx)或类似的可以绑定到该属性的类型。

```
<Window 
    x:Name="root"
    xmlns:t="clr-namespace:MyApplicationWhereFooAndBarLive"
    SkipAllThatXmlnsDefinitionNonsenseForSpaceSavingsInThisExample="true"/>  
    <!-- see Resources below --> 
    <ConentControl Content="{Binding FooOrBar, ElementName=root}" />
</Window> 
```

最后，在应用程序的资源中为每种类型定义 DataTemplates

```
<Window.Resources>
    <DataTemplate DataType="{x:Type t:Foo}">
        <TextBox Text="{Binding Text}" />
    </DataTemplate >
    <DataTemplate DataType="{x:Type t:Bar}">
        <CheckBox Checked="{Binding Checked}" />
    </DataTemplate >
</Window.Resources> 
```

DataTemplate 选择的过程是这样的：

1.  有人在某个地方设置（我们将在这个例子中说）`FooOrBar = new Foo();`
2.  ContentControl 的内容绑定更新（通过 INPC 或 DependencyProperty）
3.  ContentControl 查找其[DataTemplateSelector](http://msdn.microsoft.com/en-us/library/system.windows.controls.datatemplateselector.aspx)，发现没有配置并使用默认实现。
4.  默认的 DataTemplateSelector 获取绑定到 Content 属性的对象的类型。
5.  DataTemplateSelector（本质上）在[逻辑树](http://msdn.microsoft.com/en-us/library/ms753391.aspx)中查找作为 DataTemplate 并且具有与步骤 4 中标识的实例类型匹配的类型的键的资源。
6.  找到 DataTemplate，并将其传递给 ConentControl
7.  ContentControl 通过该[`LoadContent()`](http://msdn.microsoft.com/en-us/library/system.windows.frameworktemplate.loadcontent.aspx)方法加载可视化树。
8.  ContentControl 将此可视化树根的 DataContext 设置为 Content 属性中的值（在我们的例子中，是 的新实例`Foo`）
9.  此可视化树 (IIRC) 添加为 ConentControl 的子项，现在在 UI 中可见。

ItemsControl 的情况大致相同，只是添加了一个中介（即，ListBox 使用 ListBoxItem 作为中介，而 LBI 是一个 ContentControl）。

# asp.net - 在 ASP.net 中运行远程 VBScript 的最佳方式？WMI 还是 PsExec？

> ID：11511288
> 
> 赞同：0
> 
> 时间：2012-07-16T19:35:49.280
> 
> 标签：asp.net, vb.net, wmi, psexec

我正在做一些研究，以找出最好和最有效的方法。我将需要在许多窗口服务器/计算机上执行远程脚本（在我们构建它们时）。

我有一个要自动执行此任务的 Web 应用程序，目前我的原型正在使用 PsExec 执行远程脚本。这需要在系统上安装 PsExec。一位同事建议我应该为此使用 WMI。

我在 WMI 中做了一些研究，但找不到我要找的东西。我想要么将脚本上传到服务器并执行它并读取结果，要么已经在服务器上拥有脚本并执行它并读取结果。不过我更喜欢第一个选项！

PsExec 和 WMI 哪个更理想？

作为参考，这是我的原型 PsExec 代码。此脚本仅执行一个小脚本来获取 Windows 操作系统和服务包信息。

```
Protected Sub windowsScript(ByVal COMPUTERNAME As String)
        ' Create an array to store VBScript results
        Dim winVariables(2) As String
        nameLabel.Text = Name.Text
        ' Use PsExec to execute remote scripts
        Dim Proc As New System.Diagnostics.Process
        ' Run PsExec locally
        Proc.StartInfo = New ProcessStartInfo("C:\Windows\psexec.exe")

        ' Pass in following arguments to PsExec
        Proc.StartInfo.Arguments = COMPUTERNAME & " -s cmd /C c:\systemInfo.vbs"
        Proc.StartInfo.RedirectStandardInput = True
        Proc.StartInfo.RedirectStandardOutput = True
        Proc.StartInfo.UseShellExecute = False
        Proc.Start()
        ' Pause for script to run
        System.Threading.Thread.Sleep(1500)
        Proc.Close()

        System.Threading.Thread.Sleep(2500) 'Allows the system a chance to finish with the process.
        Dim filePath As String = COMPUTERNAME & "\TTO\somefile.txt"
        'Download file created by script on Remote system to local system
        My.Computer.Network.DownloadFile(filePath, "C:\somefile.txt")
        System.Threading.Thread.Sleep(1000) ' Pause so file gets downloaded
        ''Import data from text file into variables
        textRead("C:\somefile.txt", winVariables)
        WindowsOSLbl.Text = winVariables(0).ToString()
        SvcPckLbl.Text = winVariables(1).ToString()
        System.Threading.Thread.Sleep(1000)
        ' ''Delete the file on server - we don't need it anymore
        Dim Proc2 As New System.Diagnostics.Process
        Proc2.StartInfo = New ProcessStartInfo("C:\Windows\psexec.exe")
        Proc2.StartInfo.Arguments = COMPUTERNAME & " -s cmd /C del c:\somefile.txt"
        Proc2.StartInfo.RedirectStandardInput = True
        Proc2.StartInfo.RedirectStandardOutput = True
        Proc2.StartInfo.UseShellExecute = False
        Proc2.Start()
        System.Threading.Thread.Sleep(500)
        Proc2.Close()
        ' Delete file locally
        File.Delete("C:\somefile.txt")
 End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T20:14:05.070

从额外的研究来看，对于这种类型的项目，看起来 PsExec 是最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T21:37:15.340

是的，PsExec 是迄今为止最好的方法。PsExec 使用 RPC 访问 ADMIN$ 共享。但是，如果 RPC 被禁用，就像在默认 Win7 中一样，并且 WMI 被启用，*并且*您的帐户有一个具有读/写访问权限的共享文件夹，那么您可以使用 Frank White 几个月前使用此创建的解决方法“ cmd /c echo ..." 方法：

strCommand = "cmd /c echo myTextCommands > c:\temp\testscript.txt"

要查看完整的 VBScript，请[在​​此处查看我的解决方案](https://stackoverflow.com/a/11948096/1569434)

# ipad - 用于 Flex 的 FlexPad 库在 iPad 上运行缓慢

> ID：11511290
> 
> 赞同：0
> 
> 时间：2012-07-16T19:36:03.470
> 
> 标签：ipad, apache-flex, mobile, flexbuilder

我在 Flex 中有一个测试移动项目应用程序，它仅由一个 TabbedViewNavigatorApplication 和两个选项卡组成 - 在一个选项卡上我什么都没有，在另一个选项卡上我有一个带有内联 ArrayCollection 的 flexpad:List 仅用于测试 - 我有大约 50 个项目只有一个标签的列表。加载带有此列表的选项卡需要很长时间，并且滚动列表非常缓慢和跳跃。在这个应用程序中启动这么少，我在想我可能做错了什么来获得这个真正令人敬畏的表现。任何线索该怎么做？我正在使用最新的 AIR，Flex SDK 4.6，所有系统都是最新的。

这是看起来很慢的选项卡：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark" xmlns:flexpad="http://code.google.com/p/flexpad/" title="Tab 2">
    <flexpad:List width="300" height="200">
        <s:ArrayCollection>
            <fx:Object label="Label One"></fx:Object>
            <fx:Object label="Label Two"></fx:Object>
            <fx:Object label="Label Three"></fx:Object>
            <fx:Object label="Label Four"></fx:Object>
            <fx:Object label="Label Five"></fx:Object>
            <fx:Object label="Label One"></fx:Object>
            <fx:Object label="Label Two"></fx:Object>
            <fx:Object label="Label Three"></fx:Object>
            <fx:Object label="Label Four"></fx:Object>
            <fx:Object label="Label Five"></fx:Object>
            <fx:Object label="Label One"></fx:Object>
            <fx:Object label="Label Two"></fx:Object>
            <fx:Object label="Label Three"></fx:Object>
            <fx:Object label="Label Four"></fx:Object>
            <fx:Object label="Label Five"></fx:Object>
            <fx:Object label="Label One"></fx:Object>
            <fx:Object label="Label Two"></fx:Object>
            <fx:Object label="Label Three"></fx:Object>
            <fx:Object label="Label Four"></fx:Object>
            <fx:Object label="Label Five"></fx:Object>
            <fx:Object label="Label One"></fx:Object>
            <fx:Object label="Label Two"></fx:Object>
            <fx:Object label="Label Three"></fx:Object>
            <fx:Object label="Label Four"></fx:Object>
            <fx:Object label="Label Five"></fx:Object>
            <fx:Object label="Label One"></fx:Object>
            <fx:Object label="Label Two"></fx:Object>
            <fx:Object label="Label Three"></fx:Object>
            <fx:Object label="Label Four"></fx:Object>
            <fx:Object label="Label Five"></fx:Object>
        </s:ArrayCollection>
    </flexpad:List>
</s:View> 
```

# ruby - 将 nil 转换为字符串 Ruby POST

> ID：11511295
> 
> 赞同：0
> 
> 时间：2012-07-16T19:36:12.073
> 
> 标签：ruby, ruby-on-rails-3, null

我遇到了一个 Ruby on Rails POST 的问题，它具有以下输出：

```
Started POST "/550-674-359/pictures" for 127.0.0.1 at 2012-07-16 15:30:53 -0400

Processing by PicturesController#create as JSON
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"S33+XBxaGA7J+VWrr59CXKsZDk6lsI0/rBfHoYsCUUw=", "expiration_date"=>"1", "alignment"=>"center", "picture"=>{"image"=>[#<ActionDispatch::Http::UploadedFile:0x000001009a7a08 @original_filename="Sunflower.gif", @content_type="image/gif", @headers="Content-Disposition: form-data; name=\"picture[image][]\"; filename=\"Sunflower.gif\"\r\nContent-Type: image/gif\r\n", @tempfile=#<File:/var/folders/zZ/zZurKpTZFDm2y34FYgB3PLtShpg/-Tmp-/RackMultipart20120716-21348-j6977v>>]}, "url_id"=>"550-674-359"}
  Gallery Load (0.3ms)  SELECT "galleries".* FROM "galleries" WHERE "galleries"."url_id" = '550-674-359' LIMIT 1
   (0.1ms)  begin transaction
Binary data inserted for `string` type on column `image`
  SQL (0.7ms)  INSERT INTO "pictures" ("created_at", "description", "gallery_id", "gallery_url_id", "image", "order_number", "original_filename", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?)  [["created_at", Mon, 16 Jul 2012 19:30:53 UTC +00:00], ["description", nil], ["gallery_id", 28], ["gallery_url_id", "550-674-359"], ["image", "d2792dbf99.gif"], ["order_number", nil], ["original_filename", "Sunflower.gif"], ["updated_at", Mon, 16 Jul 2012 19:30:53 UTC +00:00]]
   (0.6ms)  rollback transaction
Completed 500 Internal Server Error in 24ms

TypeError (can't convert nil into String):
  app/controllers/pictures_controller.rb:60:in `create' 
```

这是明确标记第 60 行的 create 方法：

```
 # POST /pictures
  # POST /pictures.json
  def create
    # Creates a picture class instance based on the json objects being passed in from 
    # Carrierwave
    p_attr = params[:picture]
    p_attr[:image] = params[:picture][:image].first if params[:picture][:image].class == Array

    # Gets the gallery vai the uuid gallery url
    @gallery = Gallery.where(:url_id => params[:url_id]).first
    # Builds the picture based on the attributes passed in above from the json
    @picture = @gallery.pictures.build(p_attr)
    # Assigns the gallery_url_id attribute
    @picture.gallery_url_id = @gallery.url_id

    # Handle the picture save according to success or not
    **LINE 60 ->**if @picture.save
      puts @picture.inspect
      respond_to do |format|
        format.html {
          # Calls the method in the model to format the json repsonse
          render :json => [@picture.to_jq_upload].to_json,
          :content_type => 'text/html',
          :layout => false
        }
        format.json {
          render :json => [@picture.to_jq_upload].to_json
        }
      end
    else
      render :json => [{:error => "custom_failure"}], :status => 304
    end
  end 
```

以及我试图确保没有尝试将 nil 推入数据库的模型：

```
 class Picture < ActiveRecord::Base

  # The attributes accesible via an @picture
  attr_accessible :gallery_id, :description, :image, :gallery_url_id, :original_filename, :order_number
  belongs_to :gallery

  # Attatches the carrierwave uploader to the picture class
  mount_uploader :image, ImageUploader

  # Referenced when each picture is created, the json is formatted as the following form
  def to_jq_upload
    {

      "name" => read_attribute(:image),
      "size" => image.size,
      "url" => image.url,
      "thumbnail_url" => image.thumb.url,
      "delete_url" => id,
      "picture_id" => id,
      "delete_type" => "DELETE",
      "url_id" => read_attribute(:gallery_url_id),
      "original_filename" => read_attribute(:original_filename),
      "order_number" => testParams(read_attribute(:order_number)),
      "description" => testParams(read_attribute(:description))
    }
  end

  def testParams(id)
    if id == nil
        return ""
    else
      return id
    end

  end

end 
```

据我所知，似乎 order_number 或 description 是此问题的根源。我认为我创建的名为 testParams 的方法会检查并相应地处理，但我想它不会。我怎样才能解决这个问题？

编辑：这里的完整堆栈跟踪...

```
fog (1.0.0) lib/fog/core/hmac.rb:23:in `digest'
fog (1.0.0) lib/fog/core/hmac.rb:23:in `block in setup_sha1'
fog (1.0.0) lib/fog/core/hmac.rb:15:in `call'
fog (1.0.0) lib/fog/core/hmac.rb:15:in `sign'
fog (1.0.0) lib/fog/aws/storage.rb:352:in `signature'
fog (1.0.0) lib/fog/aws/storage.rb:360:in `request'
fog (1.0.0) lib/fog/aws/requests/storage/put_object.rb:43:in `put_object'
fog (1.0.0) lib/fog/aws/models/storage/file.rb:119:in `save'
fog (1.0.0) lib/fog/core/collection.rb:50:in `create'
carrierwave (0.6.2) lib/carrierwave/storage/fog.rb:250:in `store'
carrierwave (0.6.2) lib/carrierwave/storage/fog.rb:84:in `store!'
carrierwave (0.6.2) lib/carrierwave/uploader/store.rb:59:in `block in store!'
carrierwave (0.6.2) lib/carrierwave/uploader/callbacks.rb:17:in `with_callbacks'
carrierwave (0.6.2) lib/carrierwave/uploader/store.rb:58:in `store!'
carrierwave (0.6.2) lib/carrierwave/mount.rb:345:in `store!'
carrierwave (0.6.2) lib/carrierwave/mount.rb:217:in `store_image!'
activesupport (3.2.6) lib/active_support/callbacks.rb:427:in `_run__2057521342514191385__save__4069718005166547559__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_save_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
activerecord (3.2.6) lib/active_record/callbacks.rb:264:in `create_or_update'
activerecord (3.2.6) lib/active_record/persistence.rb:84:in `save'
activerecord (3.2.6) lib/active_record/validations.rb:50:in `save'
activerecord (3.2.6) lib/active_record/attribute_methods/dirty.rb:22:in `save'
activerecord (3.2.6) lib/active_record/transactions.rb:241:in `block (2 levels) in save'
activerecord (3.2.6) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
activerecord (3.2.6) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.2.6) lib/active_record/transactions.rb:208:in `transaction'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/method_tracer.rb:491:in `block in transaction_with_trace_ActiveRecord_self_name_transaction'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/method_tracer.rb:242:in `trace_execution_scoped'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/method_tracer.rb:486:in `transaction_with_trace_ActiveRecord_self_name_transaction'
activerecord (3.2.6) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
activerecord (3.2.6) lib/active_record/transactions.rb:241:in `block in save'
activerecord (3.2.6) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
activerecord (3.2.6) lib/active_record/transactions.rb:240:in `save'
app/controllers/pictures_controller.rb:60:in `create'
actionpack (3.2.6) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.6) lib/active_support/callbacks.rb:414:in `_run__3078682991788211307__process_action__1687541676864999030__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.6) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.6) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.6) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.6) lib/action_controller/metal/params_wrapper.rb:206:in `process_action'
activerecord (3.2.6) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/instrumentation/rails3/action_controller.rb:34:in `block in process_action'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/instrumentation/controller_instrumentation.rb:257:in `block in perform_action_with_newrelic_trace'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/method_tracer.rb:242:in `trace_execution_scoped'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/instrumentation/controller_instrumentation.rb:252:in `perform_action_with_newrelic_trace'
newrelic_rpm (3.4.0.1) lib/new_relic/agent/instrumentation/rails3/action_controller.rb:33:in `process_action'
actionpack (3.2.6) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.6) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.6) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.6) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.6) lib/action_dispatch/routing/route_set.rb:600:in `call'
newrelic_rpm (3.4.0.1) lib/new_relic/rack/browser_monitoring.rb:12:in `call'
newrelic_rpm (3.4.0.1) lib/new_relic/rack/developer_mode.rb:24:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.6) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.6) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `_run__3679119317333771623__call__4069718005166547559__callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.6) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.6) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.6) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.6) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.6) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.6) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.6) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.6) lib/rails/engine.rb:479:in `call'
railties (3.2.6) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.6) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/Users/daniel.flynn/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/Users/daniel.flynn/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/Users/daniel.flynn/.rvm/rubies/ruby-1.9.3-p0/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:58:25.933

在调用保存操作之前，我最终手动设置了这两个字段。这不是推荐的解决方案，但实际上这确实确保了这些参数中存在某些内容，并且在保存到数据库时不为零。

# php - php将值从类过滤器函数传递给函数

> ID：11511296
> 
> 赞同：0
> 
> 时间：2012-07-16T19:36:17.463
> 
> 标签：php, class, function, variables, functional-programming

我有以下内容，但我不知道如何将 $type 变量传递给第二个 checkUkPhone 函数或弄清楚如何引用它。有任何想法吗？

```
 public function isValidUkPhone($fieldName, $type) {
    //Set the filter options
    $this -> _filterArgs[$fieldName] = array('filter' => FILTER_CALLBACK, 'options' =>   array($this, 'checkUkPhone'));   
}

public function checkUkPhone($type) {
        $this -> _errors[$fieldName] = $FieldName.':Phone must begin with 07';   
}    

    // Apply the validation tests using filter_input_array()
    $this->_filtered = filter_var_array($data, $this->_filterArgs);
    foreach ($this->_filtered as $key => $value) {
        // Skip items that used the isBool() method or that are either missing or not required
        if (in_array($key, $this->_booleans) || in_array($key, $this->_missing) || !in_array($key, $this->_required)) {
            if (in_array($key, $this->_missing)){
                $this->_errors[$key] = $key . ':Required';
            }
            continue;

        } elseif ($value === false) {
            // If the filtered value is a boolean false, it failed validation,
            // so add it to the $errors array
            $this->_errors[$key] = $key . ':Invalid data supplied';
        }
    }
    // Return the validated input as an array
    return $this->_filtered; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:01:10.423

假设您使用的是 PHP 5.3 或更高版本，您可以使用闭包。它稍微复杂一些，因为你想使用魔法变量`$this`，但不是太难：

```
public function isValidUkPhone($fieldName, $type) {
  //Set the filter options
  $that = $this;
  $this->_filterArgs[$fieldName] = array(
    'filter' => FILTER_CALLBACK,
    'options' => function($val) use($fieldName, $type, $that) {
      $that->checkUkPhone($val, $fieldName, $type);
    }
  );
}
public function checkUkPhone($val, $fieldName, $type) {
  switch ($type) {
    case 'mobile':
      // Mobile numbers are a very rigid format
      // Some numbers matched by this technically are special services, but are
      // charged at around mobile rates
      // In case you're wondering, I come from a telephony background
      if (!preg_match('/^07[0-9]{9}$/', $val)) {
        $this->_errors[$fieldName] = $fieldName.':Phone must begin with 07 and be 11 digits';
      }
      break;
    case 'geographic':
      // There are still a few 10 digit 01 numbers floating about
      if (!preg_match('/^(?:01[0-9]{8,9}|0[23][0-9]{9})$/', $val)) {
        $this->_errors[$fieldName] = $fieldName.':Phone must begin with 01, 02 or 03';
      }
      break;
    case 'non-geographic':
      // Due to some weird exceptions to the rules (e.g. ChildLine), it's not as
      // easy as above to write a nice simple validation regex for UK non-geos.
      // I'll leave that in your hands...
      break;
  }
} 
```

# iphone - 如何以编程方式移动到另一个 UIViewController

> ID：11511298
> 
> 赞同：1
> 
> 时间：2012-07-16T19:36:19.943
> 
> 标签：iphone, ios5

我正在使用带有 Xcode 4.3.3 的故事板

`UIViewControllers`我想根据`if`条件结果移动到两个之一。有什么办法可以做到这一点，因为我尝试了一些代码，但它不起作用并且没有显示错误。

例如：

```
[self performSegueWithIdentifier:@"You identifier" sender:self]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:43:18.160

按住控件并从初始视图控制器拖动到每个目的地，一次一个。每次选择要使用的转场类型（除非初始控制器嵌入在 UINavigationController 中，否则推送转场将不起作用）。然后单击 each segue，打开属性检查器，并为每个 segue 指定一个唯一名称。然后做类似的事情

```
if (condition) {
    [self performSegueWithIdentifier:@"Segue1" sender:self];
}

else {
    [self performSegueWithIdentifier:@"Segue2" sender:self];
} 
```

# python - Pygame 中的 Hangman 问题

> ID：11511300
> 
> 赞同：-1
> 
> 时间：2012-07-16T19:36:22.820
> 
> 标签：python, python-3.x, pygame

我试图找出以下代码有什么问题：

```
import pygame, sys, random, linecache
from pygame.locals import *

#Start Pygame, define Pygame objects
pygame.init()
hangmanSurfaceObj = pygame.display.set_mode((640,480), 0)
clock = pygame.time.Clock()

#Define colors
redColor = pygame.Color(255,0,0)
greenColor = pygame.Color(0,255,0)
blueColor = pygame.Color(0,0,255)
whiteColor = pygame.Color(255,255,255)
blackColor = pygame.Color(0,0,0)
tardisBlueColor = pygame.Color(16,35,114)
bgColor = whiteColor

#Import Images
hangmanImage = pygame.image.load('hangmanResources/hangman.png')

#Import sounds
sadTromboneSound = pygame.mixer.music.load('hangmanResources/sadTrombone.mp3')

#Import Font
fontObj = pygame.font.Font('hangmanResources/Avenir_95_Black.ttf', 18)

#Define global variables
currentWord = 0
usrWord = ''
screenWord = []
i = 0
currentChar = ''
guesses = 0

def terminate():
    pygame.quit()
    sys.exit()

def drawRects(tries):

    if tries<=0:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(242,65,65,65))
    if tries<=1:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(257,90,35,4))
    if tries<=2:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(261,110,27,1))
    if tries<=3:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(274,130,1,114))
    if tries<=4:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(198,160,76,1))
    if tries<=5:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(275,160,75,1))
    if tries<=6:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(210,244,64,85))
    if tries<=7:
        hangmanSurfaceObj.fill(bgColor, pygame.Rect(274,244,51,87))

def newGame(players):
    if players == 1:
        line_number = random.randint(0, 2283)
        usrWord = linecache.getline('hangmanResources/words.txt', line_number)
        usrWord = list(usrWord)
        del usrWord[-1]
        print(usrWord)
        screenWord = ['_']*len(usrWord)
        print(screenWord)

def checkChar(usrWord):
    print('hi')
    i=0
    addGuess = 1
    print(len(usrWord))
    while i <= (len(usrWord)-1):
        print('hi2')
        if currentChar.lower == usrWord[i]:
            print('hi3')
            screenWord[i] = currentChar
            addGuess = 0

    return addGuess

newGame(1)

while True:
    gameRunning = 1
    while gameRunning==1:

        for event in pygame.event.get(QUIT):
            terminate()

        for event in pygame.event.get(KEYDOWN):
            if event.key==K_ESCAPE:
                terminate()
            else:
                currentChar = event.unicode
                guesses +=checkChar(usrWord)
                print(currentChar)
                print(screenWord)
                msg = ''.join(screenWord)

                msgSurfaceObj = fontObj.render(msg, False, blackColor)
                msgRectObj = msgSurfaceObj.get_rect()
                msgRectObj.topleft = (10, 20)
                hangmanSurfaceObj.blit(msgSurfaceObj, msgRectObj)

        hangmanSurfaceObj.fill(bgColor)
        hangmanSurfaceObj.fill(blueColor, pygame.Rect(400,0,640,480))

        hangmanSurfaceObj.blit(hangmanImage, (0,0))

        if guesses<=7:
            drawRects(guesses)

        else:
            won=0
            gameRunning = 0

        pygame.display.update()
        clock.tick(30)

    newGame(1) 
```

它应该是一个刽子手游戏，有一个悬挂柱，显示字母空白，右侧有一个蓝色矩形（游戏控件最终会去的地方）。

运行的时候出现了挂柱，左边的蓝色矩形出现了，虽然没有弹出错误，但是字母空白没有出现，蓝色矩形的一角连接着一个奇怪的蓝色框. 不过，更重要的是，我遇到的问题是，一旦您输入了一个字符，保存最终屏幕输出数据的字符串就不会改变。例如，如果猜测词是“Turtle”并且我输入“t”，那么它应该从`['_','_','_','_','_','_']`变为`['t','_','_','t','_','_']`，但事实并非如此。

我使用 Python 3.1.3 和 Pygame 1.9.1。

我在 Python 和 Pygame 文档中搜索了我正在使用的函数，但不幸的是我找不到资源。

[可以在此处](http://sourceforge.net/projects/hangman4pygame/files/ "SourceForge 上 Pygame 的刽子手")找到原始文件以及资源。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T03:21:35.003

您仅在 keydown 期间对短语进行 blitting，然后在您清洁屏幕的每一帧中。在 30 fps 时，如果您看到该短语的闪烁，您就很幸运了。您应该在键下检查帧，但在每一帧上都对帧进行 blit。

```
 ...
     for event in pygame.event.get(KEYDOWN):
        if event.key==K_ESCAPE:
            terminate()
        else:
            currentChar = event.unicode
            guesses +=checkChar(usrWord)
            print(currentChar)
            print(screenWord)
            msg = ''.join(screenWord)

    # Clean background
    hangmanSurfaceObj.fill(bgColor)

    # Then blit message
    msgSurfaceObj = fontObj.render(msg, False, blackColor)
    msgRectObj = msgSurfaceObj.get_rect()
    msgRectObj.topleft = (10, 20)
    hangmanSurfaceObj.blit(msgSurfaceObj, msgRectObj)

    ... 
```

**编辑**

关于附加到控制框的蓝色矩形，这是因为您将控制框设置为 200px 宽，然后用您的 drawRects() 例程覆盖前 100px。

您可以将控制框设为 100px 宽：

```
hangmanSurfaceObj.fill(blueColor, pygame.Rect(400,0,640,480)) 
```

或修改 drawRects() 例程，使矩形不与控制框重叠。

# javascript - 制作 200 毫秒内无法点击

> ID：11511301
> 
> 赞同：1
> 
> 时间：2012-07-16T19:36:25.747
> 
> 标签：javascript, jquery, html, css

我希望这个框像我做的那样上下移动，但是我不希望人们能够点击它一百万次然后看着它上下移动，因为你可以点击它比它发生的速度快得多。所以我的问题是......**我如何在点击上设置 200 毫秒的延迟，或者让它在这 200 毫秒内无法点击？**

这是jsfiddle：http: [//jsfiddle.net/QwwUD/4/](http://jsfiddle.net/QwwUD/4/)

```
 <html>   

<style>
div { 
position:absolute; 
background-color:#abc; 
left:50px;
width:90px; 
height:90px;
top:100px;
margin:5px; 
}
</style>

<div class="block" id='up' disabled='true'></div>

<script>

$('.block').click(function(){

    if($('.block').attr('id') == 'up'){
        $('.block').animate({'top': '-=50px'}, 200);
        $('.block').attr('id', 'down');
    }else{
        $('.block').animate({'top': '+=50px'}, 200);
        $('.block').attr('id', 'up');
    }
    }
    ); 

</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:39:16.440

试一下[`.stop`](http://api.jquery.com/stop/)动画：

[http://jsfiddle.net/QwwUD/1/](http://jsfiddle.net/QwwUD/1/)

```
$('.block').click(function() {

    var btn = $('.block');
    btn.prop('disabled', true);
    window.setTimeout(function() {
        btn.prop('disabled', false);
    }, 600);

    if ($('.block').attr('id') == 'up') {
        $('.block').stop(true,true).animate({
            'top': '-=50px'
        }, 200);
        $('.block').attr('id', 'down');
    } else {
        $('.block').stop(true,true).animate({
            'top': '+=50px'
        }, 200);
        $('.block').attr('id', 'up');
    }
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:45:25.820

如果当前正在使用动画，您可以停止单击事件：

```
$('.block').click(function(){
    if ( $(this).is(":animated") ) return false;
    ... rest of your code ...
}); 
```

但是，我更喜欢按照 Esailija 的建议停止动画。

# .net - 用于实时消息传递的 BizTalk

> ID：11511315
> 
> 赞同：2
> 
> 时间：2012-07-16T19:37:13.780
> 
> 标签：.net, biztalk, biztalk-2010

我的公司正在探索将 BizTalk 用于我们的消息传递基础架构，我只是好奇它是否会是一个好的候选者。

首先，我们是一家 .NET 商店，负责处理医疗事务处理。目前，我们所有的产品都是为了实现它们的目的而编写的，实际上没有通用代码。这些事务中的大多数来自标准 TCP 套接字（想想使用 MLLP 作为模型的 HL7）。然后我们处理这些并可能将它们发送给一个或多个第 3 方以通过套接字进行处理。最后，我们将交易响应发送回客户。我们有很多像这样运行的应用程序，我们希望将其放在一个统一的平台上。

我们需要它以非常快的速度运行（在某些情况下小于 6 秒），并且在扩展时具有非常高的容错能力。有人告诉我，这是 BizTalk 擅长的地方。

我的问题是给你们 BizTalk 专家，这听起来像是 BizTalk 可以做得很好吗？对于这样的迁移，您还有什么其他建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T04:15:49.347

FWIW，我的看法：

**Biztalk 优势 wrt 您的要求**

*   消息映射很简单，您可以选择可视映射或 xslt。
*   开发的统一性——一旦你的开发团队克服了学习曲线，它就可以为大多数类型的 EAI 工作提供一个集中的平台（即你可以不断地向你的 Biztalk 服务器添加新的应用程序，这可以利用现有的消息和流程）。
*   事务可靠性 - 您几乎可以拔掉 BizTalk 的插头，它在恢复状态方面做得很好，而不会丢失数据。
*   协议不可知论 - 内部一切都是 XML 到 Biztalk。您可以使用开箱即用的各种适配器来处理“特殊需求”客户，而无需重写您的应用程序。
*   低维护操作——一旦您部署和调试了您的应用程序，调整了您的生产环境，并设置了 SQL 和监控（例如 SCOM）维护任务，BizTalk 就可以像一个设备一样运行。
*   可扩展性（有代价）- BizTalk 有很多用于扩展的旋钮，并且可以添加多个服务器以进行扩展。但是，在大多数情况下，我们通常发现瓶颈是底层 SQL Server。

**弱点**

*   保证延迟/最大处理时间将面临一些挑战。例如，当 BizTalk 处于极端负载下时，需要认真考虑以避免可能导致消息积压排队的节流状态。
*   动态路由在某些协议/适配器上有点不完整 - 如果您使用过滤器管理大量静态发送端口变得笨拙，您通常需要混合一些自己的代码。例如，如果您有 100 个第三方目的地 [比如资金] - 和 10 000 个客户 - [比如医生/医院]，那么将源自资金的消息流路由到医生不会很有趣。如果您可以保持消息流源自“多”端，并使用同步协议，则可以避免路由问题。

FWIW 我在医疗环境中使用过 BizTalk（但在基金方面，不是交换机），没有太多挑战（也就是说，我们只需要路由到 3 个不同的交换机）。我猜您的 <6 秒要求是实时药房身份验证等。我要做的一件事是将实时处理和批处理（例如索赔批次）拆分到不同的进程主机，甚至完全不同的服务器上。这应该避免由于可能不具有相同的低延迟要求的大批量（例如索赔）的到达而导致同步处理（例如药品身份验证）延迟的可能性。

# drupal-6 - 将注册用户与 drupal 6 中的特定内容相关联

> ID：11511317
> 
> 赞同：0
> 
> 时间：2012-07-16T19:37:17.827
> 
> 标签：drupal-6

我在用户注册页面上有一个带有“主题”名称的可选字段。在我的特定内容类型上还有一个“主题”可选文件。

我希望我的用户只能看到我们的“主题”内容

请注意，只有管理员才能创建内容。用户只能看到内容，不能发布内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T12:49:52.540

创建您的“主题”名称作为角色和内容类型。在用户注册表单中将角色显示为下拉列表。然后使用 Content_access 模块 ( [http://drupal.org/project/content_access](http://drupal.org/project/content_access) ) 根据用户角色限制对内容类型的访问。

# lisp - 如何检查一个项目是否是 Common Lisp 中列表的成员？

> ID：11511318
> 
> 赞同：1
> 
> 时间：2012-07-16T19:37:21.163
> 
> 标签：lisp, common-lisp

我已经实现了这个功能。它应该检查我们给它的输入，如果在列表中找到它，屏幕上将显示“True”。但是，它只适用于数字，如果我给它一个字符，我会收到一个错误。

```
(defun element (x lst)
  (dolist (item lst) 
    (if (= item x) (return t)))) 
```

我如何修改它以便它也可以查找给它的任何字符？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:26:34.287

有几个比较运算符。一般的有`eq`, `eql`,`equal`和`equalp`。在 hyperspec 中查找它们。

对于特定类型的对象，通常有专门的比较器，例如`string=`和`char=`。

最后，对于列表操作，还有类似的函数`member`，可以让你从手工编写循环中解放出来。它们带有一个可选`test`参数，您可以通过该参数传递比较函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:22:05.600

很简单，使用#'eq 代替#'=，因此第3 行变为：`(if (eq item x) ...`

或者，您可以使用内置的[#'intersection](http://clhs.lisp.se/Body/f_isec_.htm)检查列表中是否有任何给定项目，因此：`(if (not (eq (intersection lst '(x)) nil)))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:23:15.333

正如您所发现的，[该`=`函数](http://www.lispworks.com/documentation/HyperSpec/Body/f_eq_sle.htm)仅适用于数字。

如果您尝试基于您的函数[`find`](http://www.lispworks.com/documentation/HyperSpec/Body/f_find_.htm)，您可能会发现它默认使用[该`eql`函数](http://www.lispworks.com/documentation/HyperSpec/Body/f_eql.htm)作为其*测试*提供了您寻求的行为：

```
(defun element (needle haystack)
  (not (null (find needle haystack)))) 
```

作为 的替代品`find`，您还应该研究它的兄弟姐妹[`member`](http://www.lispworks.com/documentation/HyperSpec/Body/f_mem_m.htm)和[`position`](http://www.lispworks.com/documentation/HyperSpec/Body/f_pos_p.htm#position). 在您的情况下，由于您只想区分是否已找到该项目，因此您应该选择工作最少的功能。我的猜测是这里的loss和`position`that是等价的；返回它从中提取 的列表，而返回. 在这两个函数中，都需要提取.`member``find``member``car``find``car``car`

# android - 为 Android 排序 ArrayAdapter

> ID：11511319
> 
> 赞同：6
> 
> 时间：2012-07-16T19:37:23.780
> 
> 标签：android, sorting, drop-down-menu, android-arrayadapter

我有一个 MultiAutoCompleteTextView，它可以让您输入多个条目并向您显示自动完成建议。当我提交我的数据时，我的问题就出现了。我将任何输入的字符串添加到下拉列表中，但我尝试对数据进行排序失败。提交时执行的代码：

```
final private Comparator<String> comp = new Comparator<String>() {
    public int compare(String e1, String e2) {
        return e1.toString().compareTo(e2.toString());
    }
};

((ArrayAdapter<String>) autoCompleteView.getAdapter()).add(getString());                    
((ArrayAdapter<String>) autoCompleteView.getAdapter()).sort(comp); 
```

单击 autoCompleteView 时发生的情况的代码：

```
 view.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                adapter.getFilter().filter(null);
                //adapter.sort(comp);
                view.showDropDown();
            }
        }); 
```

任何人都可以发现我正在做的事情有什么问题吗？

编辑：在合并@Sam 的更改后获得更多信息

```
private ArrayList<String> array = new ArrayList<String>();
private ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_dropdown_item_1line,
        array);

private void setUpAutoComplete(final MultiAutoCompleteTextView view)
{
    array.add("test string");   // this is successfully added to the drop down list
    Collections.sort(array, comp);
    adapter.notifyDataSetChanged();
}

private void onSubmit()
{
    array.add(getString()); // this fails to add
    adapter.notifyDataSetChanged();
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T20:30:29.903

> 但我对数据进行排序的尝试失败了

这有点模糊。但我会猜测一下。

首先你做一些多余的事情：

```
return e1.toString().compareTo(e2.toString()); 
```

由于`e1`and`e2`已经是字符串，因此您无需调用`String#toString()`. 这个基本的字符串比较器也已经存在。所以你不需要这些。

更好的技术是对 List 进行排序，而不是对适配器进行排序。只需使用 Collections 的排序方法：

```
List<String> list = new ArrayList<String>();
list.add(getString());
...

Collections.sort(list);
adapter.notifyDataSetChanged(); 
```

请注意，我更改`adapter.add()`为`list.add()`. 我这样做是因为`adapter.add()`调用`list.add()` *，* `adapter.notifyDataSetChanged()`但适配器不应该更新，直到新列表排序*之后。*

# c# - 正则表达式使所有新行相同

> ID：11511322
> 
> 赞同：1
> 
> 时间：2012-07-16T19:37:38.873
> 
> 标签：c#, regex, newline, linefeed

我必须格式化几个人倾倒的编程代码。所以我必须确保没有双空格，所有类都有注释等。无论如何，我很难创建这个查找和替换，因为新线......换句话说，一些块有：

```
 // this is some comment \r\n
   // some other line \r\n 
```

其他块只有：

```
 // bla bla bla \n
  // bla bla bla \n 
```

其他块

```
 // bla bla bla \r
 // bla bla bla \r 
```

最后其他块有

```
 // bla bla \n\r
 // bla bla \n\r 
```

由于这种差异，我很难创建正则表达式。

**所以我的问题是如何将所有可能性 ( `\r\n`, `\n`, `\r`, `\n\r`) 替换为 \r\n？以便：**

```
 var a = "\n\r\n\rHelloWorld";
        var b = "\r\n\n\rHelloWorld";
        var c = "\r\rHelloWorld";
        var d = "\n\nHelloWorld"; 
```

**结果是： `"\r\n\r\nHelloWorld"`**

请注意，所有变量 a、b、c 和 d =

```
->
->
-> HelloWorld 
```

他们在视觉工作室看起来都一样......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:53:57.643

我认为您需要做的是替换 CR 可能后跟 LF，或者 LF 可能后跟 CR：

搜索：`\r\n?|\n\r?`

代替：`\r\n`

# php - PHP preg_replace：如果超链接包含“youtube.com”，则需要修改超链接文本

> ID：11511324
> 
> 赞同：0
> 
> 时间：2012-07-16T19:37:44.787
> 
> 标签：php, preg-replace

我快到了！

这是我要调整的字符串，以及我的 preg_replace 尝试。

`$description_string = '<p>Here is the test link: <a href="http://www.youtube.com/watch?v=2MFn8L9tIrg" target="_blank">“Man or Muppet”&lt;/a> with other text afterwards.</p>';`

`$description = preg_replace( '/(<a[^>]+youtube[^>]*>)+[^"]*(<\/a>)+/', '$0Watch This Video$2', $description );`

我得到的结果不正确：

这是测试链接：“Man or Muppet”之后观看此视频和其他文字。

任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:25:18.293

好吧，不确定您是否要在其中获取实际标题。但这是我想出的：

```
<?php
$description_string = '<p>Here is the test link: <a href="http://www.youtube.com/watch?v=2MFn8L9tIrg" target="_blank">\'Man or Muppet\'</a> with other text afterwards.</p>';

$description = preg_replace( '/(<a[^>]+youtube[^>]*>)+[^"]*(<\/a>)+/', '$1Watch This Video$2', $description_string );

echo $description;
?> 
```

结果：

```
<p>Here is the test link: <a href="http://www.youtube.com/watch?v=2MFn8L9tIrg" target="_blank">Watch This Video</a> with other text afterwards.</p> 
```

您最大的问题是标题中的引号（“）。它切断了锚标签。使用 $0 也是不正确的。您需要使用 $1。

这可能不是您所需要的，但它对您来说是一个快速的猴子补丁。

# mysql - 如何将版本从 bugzilla 迁移到 redmine 中的新自定义“源版本”字段（我需要什么 SQL 语法）？

> ID：11511331
> 
> 赞同：2
> 
> 时间：2012-07-16T19:38:11.197
> 
> 标签：mysql, migration, redmine, bugzilla

我正在将 bugzilla 安装迁移到 redmine。

在 bugzilla 中，总是针对导致问题出现的软件版本记录错误。

由于 redmine 支持路线图，我想做一些迁移的事情。我想做的第一部分是将所有当前版本设置移至新的自定义“源版本”字段。

我尝试创建一个名为“源版本”的新自定义字段并手动更改一些错误报告以使用该字段。一些有限的测试表明，为该字段指定的每个值都会在`custom_values`表中获得一个新条目。下面显示了三个错误，其中两个具有相同的自定义版本值 1.2060：

```
--------------
SELECT * FROM custom_values WHERE custom_field_id=4
--------------

+------+-----------------+---------------+-----------------+--------+
| id   | customized_type | customized_id | custom_field_id | value  |
+------+-----------------+---------------+-----------------+--------+
| 4821 | Issue           |           765 |               4 | 1.1098 |
| 4822 | Issue           |           802 |               4 | 1.2060 |
| 4823 | Issue           |           801 |               4 | 1.2060 |
+------+-----------------+---------------+-----------------+--------+ 
```

... custom_field_id 与我添加的新“源版本”字段相关。

因此，我认为要填充表格，我需要为需要从当前版本复制的每个问题创建一个新条目。

如果有帮助，版本表具有以下结构：

```
--------------
SHOW COLUMNS FROM versions
--------------

+-----------------+--------------+------+-----+---------+----------------+
| Field           | Type         | Null | Key | Default | Extra          |
+-----------------+--------------+------+-----+---------+----------------+
| id              | int(11)      | NO   | PRI | NULL    | auto_increment |
| project_id      | int(11)      | NO   | MUL | 0       |                |
| name            | varchar(255) | NO   |     |         |                |
| description     | varchar(255) | YES  |     |         |                |
| effective_date  | date         | YES  |     | NULL    |                |
| created_on      | datetime     | YES  |     | NULL    |                |
| updated_on      | datetime     | YES  |     | NULL    |                |
| wiki_page_title | varchar(255) | YES  |     | NULL    |                |
| status          | varchar(255) | YES  |     | open    |                |
| sharing         | varchar(255) | NO   | MUL | none    |                |
+-----------------+--------------+------+-----+---------+----------------+ 
```

...并且问题表具有以下结构：

```
--------------
SHOW COLUMNS FROM issues
--------------

+------------------+--------------+------+-----+---------+----------------+
| Field            | Type         | Null | Key | Default | Extra          |
+------------------+--------------+------+-----+---------+----------------+
| id               | int(11)      | NO   | PRI | NULL    | auto_increment |
| tracker_id       | int(11)      | NO   | MUL | 0       |                |
| project_id       | int(11)      | NO   | MUL | 0       |                |
| subject          | varchar(255) | NO   |     |         |                |
| description      | text         | YES  |     | NULL    |                |
| due_date         | date         | YES  |     | NULL    |                |
| category_id      | int(11)      | YES  | MUL | NULL    |                |
| status_id        | int(11)      | NO   | MUL | 0       |                |
| assigned_to_id   | int(11)      | YES  | MUL | NULL    |                |
| priority_id      | int(11)      | NO   | MUL | 0       |                |
| fixed_version_id | int(11)      | YES  | MUL | NULL    |                |
| author_id        | int(11)      | NO   | MUL | 0       |                |
| lock_version     | int(11)      | NO   |     | 0       |                |
| created_on       | datetime     | YES  | MUL | NULL    |                |
| updated_on       | datetime     | YES  |     | NULL    |                |
| start_date       | date         | YES  |     | NULL    |                |
| done_ratio       | int(11)      | NO   |     | 0       |                |
| estimated_hours  | float        | YES  |     | NULL    |                |
| parent_id        | int(11)      | YES  |     | NULL    |                |
| root_id          | int(11)      | YES  | MUL | NULL    |                |
| lft              | int(11)      | YES  |     | NULL    |                |
| rgt              | int(11)      | YES  |     | NULL    |                |
| is_private       | tinyint(1)   | NO   |     | 0       |                |
+------------------+--------------+------+-----+---------+----------------+ 
```

问题是，我需要执行什么神奇的 SQL 查询才能将版本复制到新字段并进行清理？我从来都不是 SQL 高手，因此我将不胜感激地收到任何帮助！

**编辑**- 我尝试了以下方法：

```
INSERT INTO custom_values
(Issue, issues.id, 4, versions.name)
SELECT * FROM issues INNER JOIN versions ON issues.fixed_version_id=versions.id; 
```

...但它给了我一个错误：

```
--------------
INSERT INTO custom_values (Issue, issues.id, 4, versions.name) SELECT * FROM issues INNER JOIN versions ON issues.fixed_version_id=versions.id
--------------

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '4, versions.name) SELECT * FROM issues INNER JOIN versions ON issues.fixed_version_id=ve' at line 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T22:26:49.430

您的查询

```
INSERT INTO custom_values
(Issue, issues.id, 4, versions.name)
SELECT * FROM issues INNER JOIN versions ON issues.fixed_version_id=versions.id; 
```

应该修改成这个

```
INSERT INTO custom_values
(customized_type, customized_id, custom_field_id, value)
SELECT 'Issue', issues.id, 4, versions.name
FROM issues INNER JOIN versions ON issues.fixed_version_id=versions.id; 
```

为了成为有效的SQL。

但无论如何我都会备份数据库...... :-)

# c# - 将 C++ 结构转换为 C#

> ID：11511333
> 
> 赞同：0
> 
> 时间：2012-07-16T19:38:20.213
> 
> 标签：c#, .net, c, pinvoke

我正在编写一个与旧 C DLL 通信的 C# 应用程序。我查看了 C DLL 的标头并看到了需要在 C# 中创建的 2 个结构：

```
typedef struct
{
    char    user_field_name[MAXLENGTH];
    WORD    user_field_length;
    char    user_field_contents[80];
    char    user_field_requested[1];
    char    user_field_clear[1];
    char    user_field_attribute[1];
} U_FIELD_STRUCT;
typedef U_FIELD_STRUCT FAR * P_U_FIELD_STRUCT;

typedef struct
{
    char                user_begin_literal[7];
    char                user_screen_name[MNFRMSCRNAMELENGTH];
    char                key_to_be_sent[256]; 
    WORD                num_of_user_fields;
    U_FIELD_STRUCT      user_field[MAXFIELDCOUNT];
    char                user_end_literal[7];
} USER_FIELD_STRUCT; 
```

在我的 C# 类中，我将它们编写如下：

```
 public const Int32 MAXLENGTH = 51;
    public const Int32 MAXTAGLENGTH = 80;
    public const Int32 MNFRMSCRNAMELENGTH = 5;
    public const Int32 MAXFIELDCOUNT = 100;
    public const Int32 MAXTAGCOUNT = 40;
    public const Int32 MAXSCREENCOUNT = 150;

    public const Int32 NO_SCREEN_DATA = 99;

    [StructLayout(LayoutKind.Sequential, Pack=4, CharSet=CharSet.Ansi)]
    public struct U_FIELD_STRUCT
    {
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=MAXLENGTH)]
        public char [] user_field_name;
        public short user_field_length;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=80)]
        public char [] user_field_contents;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=1)]
        public char [] user_field_requested;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=1)]
        public char [] user_field_clear;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=1)]
        public char [] user_field_attribute;
    };

    [StructLayout(LayoutKind.Sequential, Pack = 4, CharSet = CharSet.Ansi)]
    public struct USER_FIELD_STRUCT
    {
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=7)]
        public char [] user_begin_literal;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=MNFRMSCRNAMELENGTH)]
        public char [] user_screen_name;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=256)]
        public char [] key_to_be_sent;
        public short num_of_user_fields;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=MAXFIELDCOUNT)]
        public U_FIELD_STRUCT [] user_field;
        [ MarshalAs( UnmanagedType.ByValArray, SizeConst=7)]
        public char [] user_end_literal;
    }; 
```

当我在 C# 中初始化结构时，我执行如下操作：

```
 USER_FIELD_STRUCT UserFieldsData = new USER_FIELD_STRUCT();
        UserFieldsData.user_begin_literal = new char[7];
        UserFieldsData.user_screen_name = new char[MNFRMSCRNAMELENGTH];
        UserFieldsData.key_to_be_sent = new char[256];
        UserFieldsData.user_field = new U_FIELD_STRUCT[MAXFIELDCOUNT];
        UserFieldsData.user_end_literal = new char[7];
        for (int i = 0; i < MAXFIELDCOUNT; i++)
        {
            UserFieldsData.user_field[i].user_field_name = new char[MAXLENGTH];
            UserFieldsData.user_field[i].user_field_contents = new char[80];
            UserFieldsData.user_field[i].user_field_requested = new char[1];
            UserFieldsData.user_field[i].user_field_clear = new char[1];
            UserFieldsData.user_field[i].user_field_attribute = new char[1];
        } 
```

问题是，当我调用我的方法时，我收到一条错误消息（基本上 DLL 必须验证字符串，它会发送一条消息，指出字符串不是它们应该是的）。所以我安装了 VS6 并在调试模式下运行 DLL。我查看了我正在发送的结构，字符串确实包含我放入其中的数据（一些 char[] 没有数据，而另一些则组合了 2 个字段。）

例如，如果我这样设置字段，则字段：

```
user_begin_literal=”T0k0a10”
user_end_literal=”T0k0b10”
user_screen_name=”SC00” 
```

当我在 VS6 中查看对象时：

```
user_begin_literal=” T0k0a10”
user_end_literal=””
user_screen_name=”SC00” 
```

我搞砸了我的结构设计吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:45:02.373

在 C 中，一个 char 只有 1 个字节，但在 C# 中是 2 个字节。

在 C#`sbyte`中，用于映射到 C `char`（都是有符号的 8 位值）和`ushort`映射到 C `WORD`（都是无符号的 16 位值）。

如果要将字符串值分配给结构的缓冲区之一，则应将其转换为 ASCII（或 UTF8，如果本机代码可以处理），然后将字节复制到字段：

```
void CopyStringToField(string value, sbyte[] field)
{
    int maxLength = field.Length;  // or field.Length - 1 if you need room for null terminator

    byte[] fieldValue = Encoding.ASCII.GetBytes(value);
    if (fieldValue.Length > maxLength)
        throw new ArgumentException("string too long for field.");

    int length = Math.Min(fieldValue.Length, maxLength);
    Array.Copy(fieldValue, 0, field, 0, length);

    // zero fill remaining bytes
    for (int i = length; i < field.Length; i++)
    {
        field[i] = 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:47:26.750

您需要将 C# 重组`char`为`byte`. 此外，您需要将`byte`数组声明为 a`fixed byte`才能成功地将其传递给您的 DLL。

`WORD`应标记为`ushort`C [#](https://stackoverflow.com/a/5490439/195488)。

还不清楚您`struct`在 DLL 中的排序方式，但您可以将排序设置为

`[StructLayout(LayoutKind.Sequential)]`

我们没有您提供的有关字节填充的信息。

另请参阅此[问题](https://stackoverflow.com/questions/2372061/c-sharp-struct-no-parameterless-constructor-see-what-i-need-to-accomplish)。

# python - Python Mechanize 如何使用缓存密码？

> ID：11511335
> 
> 赞同：1
> 
> 时间：2012-07-16T19:38:32.413
> 
> 标签：python, forms, login, mechanize

我正在尝试使用网络自动化来优化我的职责。我正在尝试访问一个网站，但我一直在访问

```
"httperror_seek_wrapper: HTTP Error 401: Unauthorized". 
```

我相信该站点正在使用位于控制面板-> 用户帐户-> 托管密码中的缓存密码。有人知道如何设置 python 以使用我的缓存凭据登录吗？或者可能是存储在其他地方的缓存密码，因为一旦我登录到我的电脑，我就可以自动访问所有与工作相关的网站。我正在通过代理，但我正确配置并使用 google.ca 进行了测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:44:17.507

Mechanize 无法读取这些存储的密码。但是，如果您要查看 Selenium，您可以利用真正的浏览器，然后编写出您在 Selenium 中所需的功能，从而通过存储的配置文件利用您存储的密码。

这个答案将为您提供一些关于如何完成您正在寻找的指南：[如何使用 Selenium 登录需要用户名和密码的网站？](https://stackoverflow.com/questions/5577065/how-do-i-use-selenium-to-login-to-sites-that-require-username-and-password)

# python - 在 with 语句中覆盖文件引用变量

> ID：11511337
> 
> 赞同：2
> 
> 时间：2012-07-16T19:38:40.240
> 
> 标签：python, scope, with-statement

我很好奇这是否会导致任何不良行为。我运行了一个测试用例并且没有错误，所以我认为它没问题（尽管可能不是好的做法）。只是想知道 python 如何处理我认为应该存在的问题？

```
with open("somefile.txt","r") as fileinfo:
    fileinfo = fileinfo.readlines()

print fileinfo 
```

我认为覆盖“fileinfo”会导致退出 with 语句的问题（引发一些关于无法 .close() 列表的错误）。with 语句是否保留文件引用的本地副本？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:46:21.623

当然，Python 保留了对`with`语句中使用的对象的内部引用。否则当您不使用该`as`子句时它将如何工作？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:57:52.490

with 语句确实存储了对文件对象的本地引用（尽管我不确定 self.gen 中存储的内容）

研究了该主题，专门研究了上下文管理器，发现这为感兴趣的人提供了更多细节。

```
class GeneratorContextManager(object):
    def __init__(self, gen):
        # Store local copy of "file reference"
        self.gen = gen

        def __enter__(self):
            try:
                return self.gen.next()
            except StopIteration:
                raise RuntimeError("generator didn't yield")

        def __exit__(self, type, value, traceback):
            if type is None:
                try:
                    self.gen.next()
                except StopIteration:
                    return
                else:
                    raise RuntimeError("generator didn't stop")
            else:
                try:
                    self.gen.throw(type, value, traceback)
                    raise RuntimeError("generator didn't stop after throw()")
                except StopIteration:
                    return True
                except:
                    # only re-raise if it's *not* the exception that was
                    # passed to throw(), because __exit__() must not raise
                    # an exception unless __exit__() itself failed.  But
                    # throw() has to raise the exception to signal
                    # propagation, so this fixes the impedance mismatch 
                    # between the throw() protocol and the __exit__()
                    # protocol.
                    #
                    if sys.exc_info()[1] is not value:
                        raise

def contextmanager(func):
    def helper(*args, **kwds):
        return GeneratorContextManager(func(*args, **kwds))
           return helper 
```

# ruby-on-rails - 动作控制器::路由错误：

> ID：11511338
> 
> 赞同：0
> 
> 时间：2012-07-16T19:38:47.330
> 
> 标签：ruby-on-rails, rspec, routing

我从我的测试中不明白这个错误 `Failure/Error: get "new" ActionController::RoutingError: No route matches {:action=>"new", :controller=>"user"}`

我的路线文件

`Station::Application.routes.draw do devise_for :users, :controllers => { :new => "new" }`

这是我的测试

```
require 'spec_helper'
describe UserController do

    it "should registrer new user" do
        get "new"
        fill_in "Email",                 :with => "abc@example.com"
        fill_in "Password",              :with => "abc123"
        click_button "Sign up"
        response.should have_content("Welcome! You have registrered successfully.")
    end 
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:48:44.883

您的控制器哈希不正确。你有`:controllers => { :new => "new" }`，这就是说你希望你的“用户”模型通过一个名为“新”的控制器来处理。这应该更改为，例如`:controllers => { :registrations => "registrations" }`，假设您的控制器的名称是“注册”

# c - 带有 BSD/POSIX 套接字的可移植 IPv6 连接

> ID：11511339
> 
> 赞同：0
> 
> 时间：2012-07-16T19:38:49.760
> 
> 标签：c, sockets, unix, ipv6, berkeley-sockets

我需要连接到 IPv6 地址。这不是硬编码的。我将以字节形式（char *）获取 IPv6 地址，并且不会使用 DNS 检索它们（getaddrinfo 不走运）。问题是，我应该填写的 sockaddr_in6 结构在不同的平台上是完全不同的。

如果有一种很好的便携方式可以从原始地址字节连接到 IPv6 地址？

我还应该提到我也在使用 libevent。

# javascript - 如何仅在尚未包含 Javascript 和 css 文件的情况下包含它们？

> ID：11511345
> 
> 赞同：0
> 
> 时间：2012-07-16T19:39:12.270
> 
> 标签：javascript, css

我有一个很大的遗留 Web 应用程序。我在其中添加了一些 JavaScript，这些 JavaScript 依赖于一些 js 文件和一个 css 文件。这些文件可能已包含在我添加新 JavaScript 的页面中，也可能尚未包含。

有没有一种方法可以仅在未添加这些 Javascript 和 css 文件的情况下将它们包含到页面中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:43:06.727

检查库是否存在并在不存在*且*必要时加载它：

```
if (!window.jQuery) {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "jquery-1.7.min.js";
    document.getElementsByTagName('HEAD')[0].appendChild(script);
}

... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:43:27.870

您可以编写 Javascript 来搜索 script 标签，并分别为 JS 和 CSS 搜索 link 标签。如果没有找到，您可以将标签插入到您的 HTML 中。

如何插入标签： [我可以通过 jQuery 创建脚本标签吗？](https://stackoverflow.com/questions/1199676/can-i-create-script-tag-by-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:44:27.147

当然。查看[`document.createElement`](https://developer.mozilla.org/en/DOM/KeyboardEvent)并相应地设置它们的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:14:47.927

你有几个选择：

**JavaScript**

检查特定方法是否未定义，然后将脚本附加到`head`.

```
if (typeof method === 'undefined') {
  var script = document.createElement('script'),
      head = document.getElementsByTagName('head')[0];
  script.type = 'text/javascript';
  script.src = 'path/to/js/file.js';
  head.appendChild(script);
} 
```

或者，您可以遍历每个`script`元素以检查是否`src`等于您需要添加的内容：

使用[Mozilla 的`indexOf`扩展程序](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf)来搜索您想要包含的 JS 文件`sourceArr`。`src`

```
if (!Array.prototype.indexOf) {
  Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {
    "use strict";
    if (this == null) {
      throw new TypeError();
    }
    var t = Object(this);
    var len = t.length >>> 0;
    if (len === 0) {
      return -1;
    }
    var n = 0;
    if (arguments.length > 0) {
      n = Number(arguments[1]);
      if (n != n) { // shortcut for verifying if it's NaN
        n = 0;
      } else if (n != 0 && n != Infinity && n != -Infinity) {
        n = (n > 0 || -1) * Math.floor(Math.abs(n));
      }
    }
    if (n >= len) {
      return -1;
    }
    var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);
    for (; k < len; k++) {
      if (k in t && t[k] === searchElement) {
        return k;
      }
    }
    return -1;
  }
} 
```

要使用它，请执行以下操作：

```
var scripts = document.getElementsByTagName('script'),
    sourceArr = [],
    i = 0;
for (i = scripts.length; i--;) {
  var source = scripts[i].src;
  sourceArr.push(source);
}
if (sourceArr.indexOf('path/to/js/file.js') === -1) {
  var script = document.createElement('script'),
      head = document.getElementsByTagName('head')[0];
  script.type = 'text/javascript';
  script.src = 'path/to/js/file.js';
  head.appendChild(script);
} 
```

您也可以将上述内容用于您的 CSS 文件。只需遍历每个`link`元素并设置`cssFile.type = 'text/css'`和添加`cssFile.rel = 'stylesheet'`.

# php - 在 PHP foreach 循环中考虑丢失的数组键

> ID：11511346
> 
> 赞同：1
> 
> 时间：2012-07-16T19:39:14.177
> 
> 标签：php, arrays, foreach

我正在使用 PHP 和 Xpath 为几个不同的值解析文档。我将 Xpath 查询的结果/匹配项放入数组中。因此，例如，我`$prices array`像这样构建我的：

```
$prices = array();
$result = $xpath->query("//div[@class='the-price']");
foreach ($result as $object) {
$prices[] = $object->nodeValue; } 
```

一旦我建立了我的数组，我就会循环并将这些值放入一些 HTML 中，如下所示：

```
$i = 0;
foreach ($links as $link) {
    echo <<<EOF
<div class="the-product">
    <div class="the-name"><a title="{$names[$i]}" href="{$link}" target="blank">{$names[$i]}</a></div>
    <br />
    <div class="the-image"><a title="{$names[$i]}" href="{$link}" target="blank"><img src="{$images[$i]}" /></a></div>
    <br />
    <div class="the-current-price">Price is: <br> {$prices[$i]}</div>
</div>
EOF;
    $i++; } 
```

问题是，我正在解析的原始文档中的某些项目没有价格，例如，它们甚至不包含`<div class='the-price'>`，所以我的 Xpath 没有找到值，也没有将值插入`$prices array`. _ 我最终返回了**20 个**产品和一个仅包含**17 个**键/值的数组，导致`Notice: Undefined offset`整个地方出现错误。

所以我的问题是，我该如何解释缺少键值并丢弃我的数组的项目？我可以在这些项目的数组中插入虚拟值吗？我已经尝试了尽可能多的不同解决方案。主要是我的 foreach 循环中的 IF 语句，但似乎没有任何效果。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:58:30.933

使用显示的代码很难理解 $links 和 $prices 之间的关系。由于您正在构建与 $links 数组没有任何关系的 $prices 数组，因此我不知道您将如何执行此操作。

$links 也是通过 xpath 构建的吗？如果是这样，'the-price' div 是否总是嵌套在用于填充 $links 的 DOM 元素中？

如果是，您可以嵌套您的 xpath 查询以在用于查找链接的查询中查找价格，并使用计数器来匹配两者。

IE

```
$links_result = $xpath->query('path-to-link')
$i = 0
foreach ($links_result as $link_object) {
    $links[$i] = $link_object->nodeValue;
    // pass $link_object as context reference to xpath query looking for price
    $price_result = $xpath->query('path-to-price-within-link-node', $link_object);
    if (false !== $price_result) {
        $prices[$i] = $price_result->nodeValue;
    } else {
        $prices[$i] = 0; // or whatever value you want to show to indicate that no price was available.
    }
    $i++;
} 
```

显然，那里可能有额外的处理来验证每个链接节点只存在一个价格值等等，但这是基本思想。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:45:07.743

我建议你在你的 html 中寻找一个元素，它总是出现在你的“价格”循环中。找到此对象后，您开始寻找“价格”元素，如果没有，则将空字符串等插入数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:47:43.170

如果您不想显示没有附加价格的产品，您可以检查是否`$prices[$i]`先设置。

```
foreach($links AS $link){
    if(isset($prices[$i])){
        // echo content
    }
} 
```

或者，如果您想填充它，您可以说是虚拟值

```
$prices = array_merge($prices,
              array_fill(count($prices), count($links)-count($prices),0)); 
```

这将`0`作为任何剩余值的虚拟值插入。`array_fill`首先获取数组的第一个索引（所以我们在键的数量之后开始一个`$prices`），然后我们需要填充多少，所以我们从有多少中减去有多少`$prices`，`$links`然后我们用虚拟值 0。

或者，您可以在第一个示例中使用相同的逻辑，然后通过说来应用它：

```
echo isset($prices[$i]) ? $prices[$i] : '0'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:46:23.263

与其直接查找`the-price`元素，不如查找包含的`the-product`. 循环这些，然后使用这些节点作为起始上下文进行子查询。这样您就可以获得所有`the-product`节点，以及拥有它们的节点的价格。

例如

```
$products = array();
$products = $xpath->query("//div[@class='the-product']");
$found = 0 ;
foreach ($products as $product) {
   $products[$found] = array();
   $price = $xpath->query("//div[@class='the-price']", $product);
   if ($price->length > 0) {
       $products[$found] = $price->item(0)->nodeValue;
   }
   $found++;
} 
```

# c# - 设置 ItemSource ComboBox 属性时出现 NullReferenceException

> ID：11511350
> 
> 赞同：2
> 
> 时间：2012-07-16T19:39:28.443
> 
> 标签：c#, wpf, combobox, nullreferenceexception, itemssource

> **可能重复：**
> [.NET 中的 NullReferenceException 是什么？](https://stackoverflow.com/questions/4660142/what-is-a-nullreferenceexception-in-net)

我有两个 ComboBox，一个是公司，另一个是区域（意味着每个公司都有一组区域），我想根据 ComboBox_Company 中设置的公司更改 ComboBox_Region 的 ItemSource。

我有两个类，代表公司和地区，以及一个返回确定公司地区列表的地区类方法（作为参数传递）。

当 ComboBox_Company 所选项目发生更改时，我还触发了一个事件，应该重新加载 ComboBox_Region 源。见下文

```
private void ComboBox_Company_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
   Company selected_company= (Company)ComboBox_Company.SelectedValue;
   Dictionary<int, string> regions = Region.GetLookupListByCompanyID(null, selected_company.ID, false);
   ComboBox_Region.ItemsSource = regions.Values;
} 
```

尽管如此，我得到了一个 NullReferenceException 错误，我不知道如何解决它。

XAML 代码如下：

```
<TextBlock Grid.Row="0" Grid.Column="0" Text="{x:Static props:ResourcesWPF.Company}" />
<ComboBox Name="ComboBox_Company" Grid.Row="0" Grid.Column="1" DisplayMemberPath="Name" SelectedItem="ID" Initialized="ComboBox_Company_Initialized"  SelectionChanged="ComboBox_Company_SelectionChanged" />

<TextBlock Grid.Row="1" Grid.Column="0" Text="{x:Static props:ResourcesWPF.Region}" />
<ComboBox Name="ComboBox_Region" Grid.Row="1" Grid.Column="1" DisplayMemberPath="Name" SelectedItem="ID" Initialized="ComboBox_Region_Initialized" SelectionChanged="ComboBox_Region_SelectionChanged" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:54:23.977

以下变量之一为空

```
ComboBox_Company
Region
selected_company
selected_company.ID
ComboBox_Region
regions 
```

并且`null`您传递给它的方法可能不期望该符号。

你可以使用调试器看看。当抛出异常时，调试器通常会自动启动。在屏幕底部，有 2 个小标签。 `locals`和`watch`。您可以使用它们来查看变量中的值，并查看其中一个是否为空。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:59:37.047

你得到那个异常是因为它是真的......你正在访问一个 NULL 的东西。很可能是 selected_company.ID。

以下是您的问题的一些帮助：

每次您的 ComboBox 的 SelectedValue 发生变化时，您的事件都会触发多次。这包括 SelectedValue 从旧值变为 [empty] 的时间（在变为新值之前）。解决此问题的一种方法是检查您的逻辑是否仅在设置*新值*时运行。将您的逻辑包装在 if 周围：

```
if (e.AddedItems.Count > 0)
{
    //your logic
} 
```

虽然，实现您所说的更好的方法是不使用*SelectionChanged*事件侦听器，而是利用 WPF 的 {Binding} 引擎。将第二个 ComboBox 的 ItemsSource 绑定到第一个 ComboBox 的 SelectedItem 的属性。

# html - CSS 适用于某些浏览器而不适用于其他浏览器（网站不适用于 Firefox 和 chrome ）

> ID：11511364
> 
> 赞同：1
> 
> 时间：2012-07-16T19:40:09.083
> 
> 标签：html, css

我目前正在使用的网站存在问题。基本上，该网站不适用于所有浏览器。例如，我使用 Firefox 13.0 但不适用于 FF7.0，使用 Chrome 18.0 但不适用于旧版本。与 IE 9.0 相同的场景，但在 IE 6.0 上没有。这里是网站：http://www.microboticsinc.com/Test/home.html。目前它只在公司的 3 台机器上工作。所以要恢复，我目前只有两个主要问题。1-调整大小：当我放大/缩小时。它基本上将背景图像放在所有地方。可能我需要在我的 CSS 代码上添加一个规范。2-并非所有浏览器都兼容的事实。

这是我的背景 mcb.css：

```
.outerDiv {    
    border:solid 3px transparent;
    width:1070px;
    height:1000px;
    position:relative;
    color:black;
    font-family:verdana;
    font-weight:bold;
    font-size:11px;
    text-align:left;
    margin: 0 auto; 
}

.nestedDivTL {
    background-color:transparent;
    width: 175px;
    position: absolute;
    top: 165px;
    left: 10px;
    bottom: 596px;
}

.nestedDivTR {
     background-color:transparent;
     position:absolute;
     top:50px;
     right:400px;
}

.nestedDivBL {
     background-color:transparent;
     width:400px;
     height:300px; 
     position:absolute;
     top:200px;
     right:25px;
}

.nestedDivBR {
     background-color:transparent;
     width:400px;
     position:absolute;
     top:200px;
     right:450px;
}

.nestedDivBG {
    background-color:transparent;
    width:Auto;
    height:Auto;
    position:absolute;
    top:0px;
    left:0px;
}

.nestedDivSC {
    background-color: transparent;
    position: absolute;
    top: 176px;
    left: 202px;
}

.nestedDivnf {
    background-color:transparent;       
    position:absolute;
    top:420px;
    left:15px;
    width: 160px;
    height:568px;
    bottom: 12px;
    overflow:hidden;
}

a:hover{text-decoration: underline; color:green} 

* { margin: 0; padding: 0; }

.transparent {
    /* Required for IE 5, 6, 7 */        
    width: 100%; 
    /* Theoretically for IE 8 & 9 (more valid) */
    /* ...but not required as filter works too */
    /* should come BEFORE filter */
    -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";
    /* This works in IE 8 & 9 too */
    /* ... but also 5, 6, 7 */
    filter: alpha(opacity=50);
    /* Older than Firefox 0.9 */
    -moz-opacity:0.5;
    /* Safari 1.x (pre WebKit!) */
    -khtml-opacity: 0.5;
    /* Modern!
    /* Firefox 0.9+, Safari 2?, Chrome any?
    /* Opera 9+, IE 9+ */
    opacity: 0.5;
}    

body {
    background-image: url("Resources/Web Page Parts/Misc/Map.gif"); 
    background-repeat:no-repeat center center-fixed;
}

html { 
    background:transparent url("Resources/Web Page Parts/Back Drops/carb.jpg") no-repeat center center fixed; 
    display: block;                       
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
} 
```

我在 w3c.org 上使用验证器测试了 css，并解决了他们向我展示的错误。有人可以知道我遗漏了什么或如何找到我的错误吗？我已经没有如何解决这些问题的想法了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:51:14.773

我猜这里的问题在于这一点：

```
-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size: cover; 
```

这是我发现的一个图表，描述了背景封面的浏览器兼容性。它朝向底部。

[http://www.quirksmode.org/css/background.html](http://www.quirksmode.org/css/background.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:56:14.180

如果您需要背景图像来覆盖元素，请尝试以下操作：

```
.bg {
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
  z-index: 5000;
} 
```

此链接包含代码示例和可调整大小的完整背景图像的演示。你可以把它放在一个 div 或段落上，任何东西。

代码：

```
#img.source-image {
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
} 
```

关联：

[http://css-tricks.com/how-to-resizeable-background-image/](http://css-tricks.com/how-to-resizeable-background-image/)

# php - 文件上传（Yii）

> ID：11511365
> 
> 赞同：0
> 
> 时间：2012-07-16T19:40:14.057
> 
> 标签：php, upload, yii

我正在实现一些文件上传字段，但我遇到了一些困难。我一直在关注这篇[文章](http://www.yiiframework.com/wiki/2/)，一切都很完美，直到我尝试更新我的模型。如果我没有填写文件字段，则保存后将其清除。我在谷歌上搜索并找到了这个[主题](http://www.yiiframework.com/forum/index.php/topic/5419-optional-upload-file-when-update-a-record/)。我已经修改了我的代码，但是现在，当我尝试修改另一个字段时，它不会保存，除非我也修改了图像字段。问题出在哪里？我的型号代码：

```
 public function actionUpdate($id)
    {
        $model=$this->loadModel($id);

        // Uncomment the following line if AJAX validation is needed
        // $this->performAjaxValidation($model);

        if(isset($_POST['Company']))
        {
            $model->attributes=$_POST['Company'];
            $the_image = CUploadedFile::getInstance($model,'image');
            if (is_object($the_image) && get_class($the_image)==='CUploadedFile')
              $model->image = $the_image;
            if($model->save())
                if (is_object($the_image))
                $model->image->saveAs(Yii::getPathOfAlias('webroot') . '/upload/' . $model->image);
                $this->redirect(array('view','id'=>$model->id));
        }

        $this->render('update',array(
            'model'=>$model,
    } 
```

这些是我模型中的规则：

```
 array('name', 'required'),
            array('type, number, rating, user_id', 'numerical', 'integerOnly'=>true),
            array('name, image, address, site, mail', 'length', 'max'=>1000),
            array('text', 'safe'),
            array('image', 'file', 'types'=>'jpg, gif, png'),
            array('image', 'unsafe'),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('id, type, name, text, address, site, mail, number, rating, user_id', 'safe', 'on'=>'search'), 
```

请帮我。我不知道为什么它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:47:16.010

尝试在更新[场景中](http://www.yiiframework.com/wiki/266/understanding-scenarios/)`image`修改属性规则，如下所示：

```
array('image', 'file', 'types'=>'jpg, gif, png','allowEmpty' => true, 'on'=>'update'), 
```

[我在这里](http://www.yiichina.net/forum/index.php/topic/19924-update-image/)找到了这个技巧，希望它对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-12T13:45:43.450

```
public function uploadMultifile ($model,$attr,$path)
        {
            if($sfile=CUploadedFile::getInstances($model, $attr)){
              foreach ($sfile as $i=>$file){  
                 $formatName=time().$i.'.'.$file->getExtensionName();
                 $file->saveAs(Yii::app()->basePath  .DIRECTORY_SEPARATOR.'..'. $path.$formatName);
                     //  $model->image->saveAs(Yii::app()->basePath . '/../studentimage/' . $date . $model->image);
                 $ffile[$i]=$formatName;
                 }
                return ($ffile);
             }
         }

public function actionCreate()
{
    $model=new Subject;
    // $model->date_erected = date('Y-m-d');
    // Uncomment the following line if AJAX validation is needed
    // $this->performAjaxValidation($model);

    if(isset($_POST['Subject']))
    {
        $model->attributes=$_POST['Subject'];
                    if($filez=$this->uploadMultifile($model,'imagea','/../images/views/'))
                {
                    $model->documents=implode(",", $filez);
                }
        if($model->save())
            $this->redirect(array('view','id'=>$model->id));
    }

    $this->render('create',array(
        'model'=>$model,
    ));
} 
```

# windows-phone-7 - 找不到 Windows Phone 的特定列表框

> ID：11511372
> 
> 赞同：1
> 
> 时间：2012-07-16T19:40:50.647
> 
> 标签：windows-phone-7

我现在正在寻找一种方法让用户打开一个列表框，选择一个选项，然后程序继续运行，考虑到所需的选项。我最好的选择是使用我在手机的“设置”部分找到的列表框。

我没有办法完全解释这个控件，所以我将使用一个示例。如果您进入手机的地区和语言部分，然后点击地区，您会注意到一个列表弹出。选择铃声时会打开相同的列表框。这正是我的应用程序所需要的。唯一的问题是，我不知道它叫什么。帮助！

我包括了两张图片

![区域和显示（打开同一个列表）](../Images/c1018403bf94119d257802424de9cfb4.png)

![正是我需要的（点击区域格式）](../Images/2e319f7b36f43635741cc49a889eeae2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:00:08.077

那个控件不叫a `ListBox`，Windows Phone叫它`ListPicker`。[这](https://blogs.msdn.com/b/delay/archive/2010/11/03/listpicker-i-hardly-even-know-er-a-detailed-overview-of-the-windows-phone-toolkit-s-listpicker-control.aspx?Redirected=true)是一篇解释如何使用它的文章。

该控件包含在[Silverlight Toolkit](https://silverlight.codeplex.com/) for Windows Phone 中。

请注意，这篇文章很旧，并且在最新版本的工具包中，控件的一些属性已被重命名/设为只读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:07:12.697

您需要的是来自[Windows Phone Toolkit](http://silverlight.codeplex.com/releases/view/75888)的 ListPicker 。您需要自己处理更改任何设置。这可以通过绑定到被更改的属性或通过您编写的代码来完成。

```
<toolkit:ListPicker Header="Language" SelectedItem="{Binding SelectedLanguage, Mode=TwoWay}" 
                    FullModeHeader="LANGUAGES" ExpansionMode="FullScreenOnly"
                    SelectionChanged="ListPicker_SelectionChanged">
    <sys:String>English</sys:String>
    <sys:String>Spanish</sys:String>
    <sys:String>French</sys:String>
</toolkit:ListPicker> 
```

如果您需要处理更改：

```
private void ListPicker_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    // handle any changes that are needed
} 
```

# php - 在刷新时保持下拉列表选定的值

> ID：11511379
> 
> 赞同：0
> 
> 时间：2012-07-16T19:41:20.253
> 
> 标签：php, ajax, drop-down-menu

我正在使用 CakePHP 1.2.4，并且我在搜索表单中有两个搜索过滤器，它们以这种方式交互：一个下拉列表填充了国家，另一个 ddl 填充了第一个 ddl 中选择的国家/地区的州。

这是用ajax完成的

当在搜索表单中使用它们时刷新页面时，我需要调用 ajax 函数，否则不会再次填充状态 ddl。

这些下拉列表也用于其他类型的视图。例如，在 edit_address.ctp 页面上，打开页面时选择的值将是保存在数据库中的值。

但是，在 edit_address.ctp 页面上，我不需要更新刷新（或 onload）时的值，因为除非用户手动更改国家/地区，否则我不希望更新状态。

```
 $('.ajaxSelect').each(function(){
    $(this).change(function(){
        updateSelect($(this));
    });
    //call function on load only for filters in a search form
    if($(this).closest('.frmSearch').length > 0){
        if($(".ajaxSelect option:selected").text() != ""){
            $(this).change(updateSelect($(this))).change();
        }
    }
}) 
```

它可以很好地使用此功能，但是在 edit_address.ctp 中，如果用户更改国家/地区（不保存）并刷新页面，状态将重置为与默认国家/地区匹配，但所选国家/地区仍然是刷新前选择的国家/地区，因此州不再与国家匹配。

这是国家过滤器的示例

```
<select id="AddressCountryId" class="ajaxSelect" linked="AddressRegionId" method="getRegion" name="data[Address][country_id]"> 
```

状态过滤器

```
<select id="AddressRegionId" name="data[Address][region_id]"> 
```

var_dump($_POST) 刷新时为空，因此我无法在地址控制器中以这种方式访问​​选定的值。

我能想到的另一件事是，在上面的 ajax 函数中，通过调用模型中的方法来检查视图中选定的状态是否与选定的国家/地区匹配。这是正确的方法吗？我应该在 ajax 控制器中创建一个新函数来访问模型函数吗？

简而言之，只要选择的值不是来自数据库（除非用户手动选择另一个国家/地区），如果有意义的话，我希望使用 ajax 更新状态列表

我可能缺少一些关键概念。请随意询问精度，因为它可能会令人困惑，谢谢

* * *

编辑：我猜这可能不是何时进行ajax调用的问题，而是如何在刷新后保留下拉列表值及其选择的值（也编辑了标题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T21:42:26.243

HTTP 是**无状态**的。因此，当您刷新浏览器时，它是一个新的 HTTP 请求，它不知道下拉列表中选择的项目是什么。

一种可能的解决方法是将状态存储在某个持久性介质中。会话变量，数据库是您可以想到的两个选项。

# c++ - C++ STL 对象的内存分配

> ID：11511381
> 
> 赞同：0
> 
> 时间：2012-07-16T19:41:21.273
> 
> 标签：c++

假设我正在 C++ 中创建一个 STL 映射对象，即`map<string,char>mymap``$`. 现在，我想知道内存是如何分配给这个对象的？我的困惑是没有动态分配，我们事先不知道容器的大小。那么，从哪里以及如何将内存分配给对象**mymap**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:43:11.863

> 没有动态分配

当然有，但它在引擎盖下。`std::map`通常存储为树，因此每当插入新对象时都会分配一个新节点。动态地。仅仅因为您没有明确地 write `new`，并不意味着它不会在幕后发生。

在 的析构函数上`std::map`，节点被自动删除。但是请注意，如果节点包含动态分配的对象，则映射不会删除这些对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:43:02.763

> 那么，内存是从哪里以及如何分配给对象 mymap 的呢？

所有标准容器的默认分配器是[`std::allocator`](http://en.cppreference.com/w/cpp/memory/allocator)，您的容器从哪里获取内存并释放到它用完内存。您可以使用自定义分配器，然后根据需要跟踪所有分配和解除分配。

# database - Rails 3建立与另一个数据库的连接仅适用于一个查询

> ID：11511383
> 
> 赞同：2
> 
> 时间：2012-07-16T19:41:25.720
> 
> 标签：database, ruby-on-rails-3

我有两个数据库：一个叫 db1，另一个叫 db2。我有两个模型，`School`和`SchoolProd`。我想`SchoolProd`连接到 db2，但也想将“学校”识别为它的关联表。我通过这样做来实现这一点

```
establish_connection :db2
set_table_name 'schools' 
```

当我运行 rails 控制台并询问时`SchoolProd.all`，它给了我 db2 中学校表中的所有对象，但是当我`SchoolProd.all`再次尝试时，它给了我 db1 中学校表中的所有对象，而不是 db2。为什么会这样？我做的第一个查询的行为符合预期，但其余的都是在 db1 中完成的。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T19:05:48.950

好的，我发现了我收到此错误的原因。原来`ar-octopus`我的 Gemfile 中有 gem。这个 gem 在 ActiveRecord 中提供数据库分片。我决定不使用它，但忘记从我的 Gemfile 中删除它。一旦我删除它，一切都很好

# git - Jenkins Git 插件分离 HEAD

> ID：11511390
> 
> 赞同：83
> 
> 时间：2012-07-16T19:41:46.157
> 
> 标签：git, jenkins

我是 Git 的新手，也是 Jenkins 的新手。我的问题是我无法让 Jenkins Maven 发布插件工作。

当我使用 Jenkins 构建一个通用的 Maven 构建时，它运行良好，但是当我尝试使用 Maven 发布插件执行发布时，我得到以下堆栈跟踪：

```
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.maven.plugins:maven-release-plugin:2.3.2:prepare (default-cli) on project parent: An error is occurred in the checkin process: Exception while executing SCM command.
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.jvnet.hudson.maven3.launcher.Maven3Launcher.main(Maven3Launcher.java:79)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchStandard(Launcher.java:329)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:239)
    at org.jvnet.hudson.maven3.agent.Maven3Main.launch(Maven3Main.java:158)
    at hudson.maven.Maven3Builder.call(Maven3Builder.java:98)
    at hudson.maven.Maven3Builder.call(Maven3Builder.java:64)
    at hudson.remoting.UserRequest.perform(UserRequest.java:118)
    at hudson.remoting.UserRequest.perform(UserRequest.java:48)
    at hudson.remoting.Request$2.run(Request.java:326)
    at hudson.remoting.InterceptingExecutorService$1.call(InterceptingExecutorService.java:72)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.apache.maven.plugin.MojoExecutionException: An error is occurred in the checkin process: Exception while executing SCM command.
    at org.apache.maven.plugins.release.PrepareReleaseMojo.prepareRelease(PrepareReleaseMojo.java:295)
    at org.apache.maven.plugins.release.PrepareReleaseMojo.execute(PrepareReleaseMojo.java:247)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    ... 27 more
Caused by: org.apache.maven.shared.release.ReleaseExecutionException: An error is occurred in the checkin process: Exception while executing SCM command.
    at org.apache.maven.shared.release.phase.AbstractScmCommitPhase.checkin(AbstractScmCommitPhase.java:160)
    at org.apache.maven.shared.release.phase.AbstractScmCommitPhase.performCheckins(AbstractScmCommitPhase.java:145)
    at org.apache.maven.shared.release.phase.ScmCommitPreparationPhase.runLogic(ScmCommitPreparationPhase.java:76)
    at org.apache.maven.shared.release.phase.AbstractScmCommitPhase.execute(AbstractScmCommitPhase.java:78)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:234)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:169)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:146)
    at org.apache.maven.shared.release.DefaultReleaseManager.prepare(DefaultReleaseManager.java:107)
    at org.apache.maven.plugins.release.PrepareReleaseMojo.prepareRelease(PrepareReleaseMojo.java:291)
    ... 30 more
Caused by: org.apache.maven.scm.ScmException: Exception while executing SCM command.
    at org.apache.maven.scm.command.AbstractCommand.execute(AbstractCommand.java:63)
    at org.apache.maven.scm.provider.git.AbstractGitScmProvider.executeCommand(AbstractGitScmProvider.java:291)
    at org.apache.maven.scm.provider.git.AbstractGitScmProvider.checkin(AbstractGitScmProvider.java:217)
    at org.apache.maven.scm.provider.AbstractScmProvider.checkIn(AbstractScmProvider.java:410)
    at org.apache.maven.shared.release.phase.AbstractScmCommitPhase.checkin(AbstractScmCommitPhase.java:156)
    ... 38 more
Caused by: org.apache.maven.scm.ScmException: Detecting the current branch failed: fatal: ref HEAD is not a symbolic ref
    at org.apache.maven.scm.provider.git.gitexe.command.branch.GitBranchCommand.getCurrentBranch(GitBranchCommand.java:147)
    at org.apache.maven.scm.provider.git.gitexe.command.checkin.GitCheckInCommand.createPushCommandLine(GitCheckInCommand.java:192)
    at org.apache.maven.scm.provider.git.gitexe.command.checkin.GitCheckInCommand.executeCheckInCommand(GitCheckInCommand.java:132)
    at org.apache.maven.scm.command.checkin.AbstractCheckInCommand.executeCommand(AbstractCheckInCommand.java:54)
    at org.apache.maven.scm.command.AbstractCommand.execute(AbstractCommand.java:59)
    ... 42 more
channel stopped
Finished: FAILURE 
```

失败的命令和错误消息是：

```
[INFO] Executing: /bin/sh -c cd
/var/lib/jenkins/workspace/test_maven/parent && git symbolic-ref HEAD
[INFO]  Working directory:
/var/lib/jenkins/workspace/test_maven/parent  mojoFailed
org.apache.maven.plugins:maven-release-plugin:2.3.2(default-cli)
projectFailed ch.apkern.achilles:parent:1.0-SNAPSHOT  sessionEnded 
```

我发现 Jenkins Git 插件创建了一个分离的 HEAD ref“（无分支）”，这会导致问题，我想。但我完全不知道为什么会创建这个 ref 或如何解决这个问题。

如果有任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2014-04-17T10:56:54.300

在 Git 插件的当前 (2.2.1) 版本中，Checkout/merge to local branch (optional) 字段已消失*。*

它已移至*其他行为*→*签出到特定的本地分支*：

![Jenkins 设置选项截图](../Images/16298835e811238e67ec7bcd6be9b534.png)

将该值设置为*master*让我得到了一个签出的分支，而不是一个分离的头。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-04-05T09:11:41.127

无需创建手动步骤，其他答案的 Jenkins 配置均不适合我。确实有效的方法很简单：

```
Repository URL: <repo>
Branches to build: master
Checkout/merge to local branch (optional): master 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2012-11-28T05:35:31.207

更新（2015 年 11 月）：请注意，此解决方案是针对特定版本的 Git 插件（1.1.26）给出的。在以后的版本中，插件进行了更新，使配置更容易。

对于 Jenkins Git 插件版本 1.1.26 试试这个：

转到作业配置。向下滚动到 Git 部分，然后单击“存储库”下的“高级...”按钮。然后设置：

```
Name: origin
Refspec: +refs/heads/branch-0.1:refs/remotes/origin/localbranchname 
```

然后单击另一个“高级...”按钮并设置：

```
Checkout/merge to local branch (optional): localbranchname 
```

您可以随意命名本地分支，但 Refspec 中的目标必须与该可选字段中的本地分支名称匹配（在本例中为“localbranchname”）。这会将 HEAD 附加到 localbranchname，如下所示：

```
HEAD -> refs/heads/localbranchname -> 7a698457751bdc043cfda631b81e3812c5361790 
```

Maven Release 现在应该在 Jenkins 中通过。

顺便说一句，这适用于 Jenkins 1.492 和 Jenkins Git 插件版本 1.1.26。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-07-16T22:10:48.200

在 Git 中，当您签出一个分支时，例如 master 或 dev 或任何其他本地分支，您的 HEAD（.git 文件夹中的文件）将包含对相应分支的引用。因此它是“附加的”。

当您执行一些操作，如变基、合并或当您检查特定提交时，即任何时候您看到“无分支”时，您的 HEAD 没有对任何本地分支的引用，而是直接指向提交，即它里面有实际的 SHA-1。这意味着它是分离的 - 与任何分支分离。没有创建新的参考“无分支”。

该命令`git symbolic-ref HEAD`检查 HEAD 内容是引用还是 SHA-1 并将其打印出来。

您可以通过以下方式看到：

```
git checkout master
git symbolic-ref HEAD
git checkout HEAD~2 # going two commits back
git symbolic-ref HEAD
git checkout master # coming back 
```

现在，大部分时间 Jenkins 中的 Git 插件都在分离 HEAD 状态下处理代码。我不确定 Maven 发布插件是如何工作的，但我 99% 确定它需要您从特定分支发布。为了解决这个问题，我建议指定如下内容作为预构建步骤或 shell 命令：

```
git checkout master; git pull origin master 
```

我希望这将解决问题；）

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-04-19T08:45:20.230

我想建立几个分支，并检查其名称下的每个分支。我正在使用 Git 插件 2.4.0。

[Matthias Braun](https://stackoverflow.com/a/23131277/282229)的答案为您提供了一个命名分支，但它不是以远程分支命名的。

不要将本地分支设置为`master`，而是将本地分支**设置为`$GIT_BRANCH`**。

我在[此错误报告](https://issues.jenkins-ci.org/browse/JENKINS-6856)中找到了该解决方案。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-07-12T16:45:31.203

在尝试使用 maven-release-plugin:2.5.3 和 maven-scm-provider-jgit:1.9.5 从分支进行参数化发布构建时，我遇到了同样的问题。

我希望能够为“参数化发布版本”选择分支。这不起作用，当我选择“结帐/合并到本地分支（可选）”时它起作用了，但我最终在远程（重复来源）中得到了一个分支“origin/origin/mybranch”。

所以：

*   将“Git Parameter”添加到“This project is parameterized”
    名称：branch
    ParameterType：Branch
    Click Advanced：
    Branch Filter:origin/(.*)
    （这是诀窍！）

*   Git 存储库：
    要构建的分支：refs/remotes/origin/${branch}

*   其他行为：-> 签出到特定的本地分支
    分支名称：${branch}

玩得开心 ：-）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-31T18:57:57.950

我遇到了同样的问题。@Eugene 解决方案只工作了一次。

第二次尝试出现错误：“无法从存储库中删除 HEAD”或类似的东西。

我发现了这个（[来源](http://permalink.gmane.org/gmane.comp.java.hudson.user/41902)）：

> 和 m2 额外步骤（预构建）
> 
> git 结帐大师 || git checkout -b 大师
> 
> git reset --hard origin/master

现在我认为没关系。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-07T10:15:32.957

我有同样的问题。我尝试了康斯坦丁的解决方案，效果很好，但标签和提交被推送到“localbranchname”远程存储库。

所以我做了同样的事情，但是是手动的。

首先，添加一个 pre-steps shell 脚本：

```
git branch -f localJenkins
git checkout localJenkins 
```

然后是一个 post-steps shell 脚本：

```
git checkout master
git rebase localJenkins
git branch -D localJenkins
git push origin master
git push --tag 
```

这行得通！这样，您就没有 jenkins 远程分支，提交和标记将位于主（或其他）分支上。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-17T15:38:21.453

添加到 Maven 命令行以进行发布准备：`-DpushChanges=false -DlocalCheckout=true`

这意味着 maven 将使用 jenkins 在工作目录中获得的内容`.git`，并且既不会克隆远程也不会推送到远程。

我建议将完全限定配置`refs/remotes/origin/develop`为您的 Git“要构建的分支”。这种方式对我来说似乎更容易理解。

在这种情况下，您的 $GIT_BRANCH 会被 Jenkins 神奇地设置为`origin/develop`

然后，不要使用过于复杂（但可移植）的 GitPublisher，只需添加一个构建后步骤“Execute Shell”：

```
echo Remote branch is $GIT_BRANCH, replacing origin with refs/heads.
git push --follow-tags "$GIT_URL" "+HEAD:${GIT_BRANCH/#origin\//refs/heads/}" 
```

这会推动任何 maven 更改，例如 pom.xml 和标签。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-20T23:58:37.613

上面的大多数答案都建议使用*Check out to specific local branch*作为上述问题的解决方案。不幸的是，这不是最好的选择，因为它会检查到在管道配置中手动定义的本地分支。

很多时候 Jenkins 设置为在 Multibranch Pipeline 模式下工作，这意味着可以从不同的 git 分支构建项目。

在这样的解决方案中，远程分支与本地分支不匹配。

## 解决方案

对于这些情况，最好和安全的解决方案是检查匹配的本地分支。前任 如果管道正在开发分支上工作，它将在本地签出到开发分支。

**要实现这样的结果，请在Branch Sources**部分添加其他属性，名为：**Check out to match local branch**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-07T11:03:16.717

如果您正在使用来自 SCM 的管道脚本，这是实现[另一个答案](https://stackoverflow.com/a/23131277/5134722)中以图形方式显示的内容所需的语法：

```
extensions: [[$class: 'LocalBranch', localBranch: 'BRANCH_NAME']] 
```

因此，例如，如果您的远程分支是`develop`并且您想要签出一个也调用`develop`来跟踪它的本地分支，那么这是一个在上下文中显示本地分支扩展的最小示例：

```
checkout([$class: 'GitSCM', branches: [[name: '*/develop']], extensions: [[$class: 'LocalBranch', localBranch: 'develop']], userRemoteConfigs: [[credentialsId: 'xxx', url: 'yyy']]]) 
```

分别替换为您自己的凭据 ID 和 URL 的位置`xxx`。`yyy`

您还可以使用图形语法生成器自己生成管道语法。看到[这个答案](https://stackoverflow.com/a/66270978/5134722)。

# php - 无法从查询中获取值

> ID：11511394
> 
> 赞同：1
> 
> 时间：2012-07-16T19:41:57.513
> 
> 标签：php, mysql, sql

我在下面的代码中运行它，但它返回一个错误：`"undefined index: value"`

```
$two_tier= mysql_query("
    SELECT Count(1)
    FROM(
        SELECT `login_id`
        FROM `data`
        WHERE Year(`start_at`) = Year(Date_sub(Now(), INTERVAL 1 month))
        AND Month(`start_at`) = Month(Date_sub(Now(), INTERVAL 1 month)) 
        AND end_at > Date_add(start_at, INTERVAL 5 minute) 
        GROUP  BY `login_id`
        HAVING Count(`login_id`) > 1
    ) AS Value
");

$two_cnt = mysql_fetch_assoc($two_tier);
echo $two_cnt['value']; 
```

我试图获得“价值”。一点帮助，请。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:46:25.383

```
SELECT Count(1) as my_value
FROM   (SELECT `login_id` 
        FROM   `data` 
        WHERE  ( Year(`start_at`) = Year(Date_sub(Now(), INTERVAL 1 month)) 
                 AND Month(`start_at`) = Month(Date_sub(Now(), INTERVAL 1 month) 
                                         ) ) 
               AND ( end_at > Date_add(start_at, INTERVAL 5 minute) ) 
        GROUP  BY `login_id` 
        HAVING Count(`login_id`) > 1) AS Value

$two_cnt = mysql_fetch_assoc($two_tier);
echo $two_cnt['my_value']; 
```

您选择 FROM 作为值，但第一次选择的结果不在该值中，您还需要一个 AS

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T19:47:02.927

`SELECT`由于语句中最外部的值是`SELECT Count(1)`，所以您实际上是在获取`Count(1)`as`Count(1)`而不是`value`。要将其作为值获取，您需要执行以下操作：

```
SELECT Count(1) AS value .... 
```

然后代码将正常工作。因此，最终声明将是：

```
$two_tier= mysql_query("
    SELECT Count(1) AS value
    FROM(
        SELECT `login_id`
        FROM `data`
        WHERE Year(`start_at`) = Year(Date_sub(Now(), INTERVAL 1 month))
        AND Month(`start_at`) = Month(Date_sub(Now(), INTERVAL 1 month)) 
        AND end_at > Date_add(start_at, INTERVAL 5 minute) 
        GROUP  BY `login_id`
        HAVING Count(`login_id`) > 1
    ) AS Value
"); 
```

# java - 如何在 Java 中存储国家/地区列表

> ID：11511399
> 
> 赞同：-3
> 
> 时间：2012-07-16T19:42:13.517
> 
> 标签：java

我需要一个可以存储所有国家/地区列表的 Java 结构。你会推荐哪种 Java 数据结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:43:58.927

您可以使用避免重复的`Set`集合实现（如果只是名称）。`HashSet`如果要保留国家代码和名称，则可以`Map`收藏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T19:47:59.570

你要遍历集合吗？如果是这样，java.util.ArrayList。

你打算用它来做某种查找吗？就像“这是否存在”场景？如果是这样，java.util.HashSet

您是否需要为每个国家/地区附加附加信息？如果是这样，java.util.HashMap

您需要查找和有序迭代吗？如果是这样，java.util.TreeSet。

还有并发需要关注，但我没有看到任何提及它，所以我将离开那些人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:49:17.980

我认为 HashSet 应该是合适的，只要你不希望有重复。HashSet 提供恒定时间查找，这将加快搜索速度。如果您希望数据结构由多个线程访问和修改，您可以考虑其他线程安全变体，例如 Collections.SynchronizedSet 或 CopyOnWriteArrayList。您需要提供有关用例的更多详细信息以缩小您的选择范围

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:46:07.527

您应该使用 HashSet 来提供集合中元素的唯一性和关键字搜索的恒定时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:46:50.627

尝试使用`Dictionary<k,v>`，我推荐它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T19:52:22.033

我最近做了非常相似的事情，因为我的应用程序中有一个语言列表。我只是使用枚举来做到这一点。国家/地区列表相当稳定，因此您不需要经常重新编译此类；）

# git - 如何反转克隆存储库与其源之间的关系？

> ID：11511400
> 
> 赞同：0
> 
> 时间：2012-07-16T19:42:22.083
> 
> 标签：git

我在笔记本电脑上创建了一个小型本地 Git 存储库来开始一些工作。一段时间后，我决定与朋友分享；所以我将它克隆到了一个 USB 密钥。当我的朋友从 USB 密钥克隆时，他们的本地存储库将 USB 密钥显示为他们的来源。所以他们的推送会去那里（假设他们已经安装了密钥）。但是当我运行“git remote -v”时我的副本什么也没有显示，因为我没有通过克隆创建我的副本，我使用了 init。

如何修改我的本地存储库以将 USB 密钥视为“新来源”？我是 Git 的新手，所以我仍在学习“思考 Git”。我有一些猜测，这通常是如何完成的。

1.  删除我的本地存储库并将其从 USB 密钥克隆回来。
2.  调用“git remote add”的一些咒语，将 USB 密钥存储库添加回我的本地作为“原点”。

这是一个常见的用例吗？还是通常会做其他事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:45:27.240

您应该能够从原始存储库中执行以下操作：

```
git remote add origin /path/to/usbkey/repo 
```

这应该将名称为 origin 的远程添加到当前存储库。

这是文档的链接：

[远程git](https://git-scm.com/docs/git-remote)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:45:57.630

```
git remote add origin /path/to/sdcard 
```

您甚至不需要从 sdcard 中删除远程：一个存储库可以拥有任意数量的远程，并且两个存储库可以将彼此作为远程。

（旁注：`origin`只是与本地存储库关联的远程存储库的名称。按照约定，它是默认远程存储库）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:47:47.200

与传统（非分布式）版本控制系统不同，Git 并没有真正的“主”存储库......所有存储库都是平等的合作伙伴......

您可以使用 git remote add 指向其他存储库...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:44:57.093

一种方法是将所有内容推送到 USB 密钥，删除您的本地存储库，然后从 USB 密钥克隆一个新的本地存储库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:45:52.767

另一种方法是查看您朋友的文件，`.git/config`然后将相关部分复制到您的`.git/config`.

# supervisord - 如何在 Supervisord 的 [supervisord] 配置部分中使用环境变量？

> ID：11511403
> 
> 赞同：14
> 
> 时间：2012-07-16T19:42:38.137
> 
> 标签：supervisord

我在 Supervisord 的程序部分使用环境变量，它们工作得很好：

```
[program:some_prog]
command=%(ENV_env_var_name)s/... 
```

我不知道如何在 [supervisord] 部分中做同样的事情。我尝试使用带和不带 ENV_ 前缀的相同语法，但出现以下错误：

```
Traceback (most recent call last):
  File "/usr/local/bin/supervisord", line 9, in <module>
    load_entry_point('supervisor==3.0a12', 'console_scripts', 'supervisord')()
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/supervisord.py", line 356, in main
    options.realize(args, doc=__doc__)
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/options.py", line 419, in realize
    Options.realize(self, *arg, **kw)
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/options.py", line 284, in realize
    self.process_config_file()
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/options.py", line 478, in process_config_file
    Options.process_config_file(self, do_usage=do_usage)
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/options.py", line 292, in process_config_file
    self.read_config(self.configfile)
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/options.py", line 527, in read_config
    section.directory = existing_directory(directory)
  File "/usr/local/lib/python2.7/dist-packages/supervisor-3.0a12-py2.7.egg/supervisor/datatypes.py", line 336, in existing_directory
    nv = v % {'here':here}
KeyError: 'var_name' 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T07:58:55.253

Supervisor 仅支持在有限数量的位置使用环境变量进行扩展，每个位置都记录在[配置文档](http://supervisord.org/configuration.html)中。

不幸的是，该`[supervisord]` `directory`选项不是其中之一。它只支持`%(here)`变量，没有别的。

如果这对您来说是一个重要问题，您可以在[supervisord 问题跟踪器](https://github.com/Supervisor/supervisor/issues)中提交一个功能请求。

在我的项目中，我们通常使用[zc.buildout](http://www.buildout.org/)来使部署和开发环境设置可预测和可重复，并从模板生成主管配置。有一个[专门的构建配方](https://pypi.python.org/pypi/collective.recipe.supervisor/)可以使这项任务更容易。

# jquery - 如何设置 Jquery Mobile 页面 data-url 属性？

> ID：11511404
> 
> 赞同：0
> 
> 时间：2012-07-16T19:42:40.053
> 
> 标签：jquery, events, url, jquery-mobile

从 page1 转到 page2 时，尝试手动设置页面上的 data-url 属性时，我遇到了奇怪的效果。

我想将页面 data-url 属性设置为 URL 路径名，如下所示：

```
 page.attr({ 'data-url' : $.mobile.path.parseUrl( window.location.href ).pathname }); 
```

现在我正在 pagebeforeshow 上执行此操作。问题是，如果我不等待至少 400 毫秒，则 data-url 将始终设置为上一页 url。所以我正在这样做，我认为这真的很糟糕......

```
window.setTimeout(function () {
    page.attr({
        'data-url': $.mobile.path.parseUrl(window.location.href).pathname
    });
}, 400) 
```

**问题**：
这可能是因为我在听 pagebeforeshow 和 pageshow 吗？如何确保在没有超时的情况下将新页面拉入 DOM 不会获得先前访问过的页面的路径名（这会导致一些混乱的导航......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T05:38:30.557

问题是 pushstate 隐藏了实际发生的事情。

如果您在 Jquery Mobile 中从*www.site.com/folder/page1.html*转到*page2.html*，您的 none pushstate Url 如下所示：

```
 www.site.com/folder/page1.html/#/folder/page2.html 
```

将状态掩码推入

```
 www.site.com/folder/page2.html 
```

但是如果你使用 parseURl.pathname，路径仍然是

```
 www.site.com/folder/page1.html 
```

因此，将 data-url 设置为*路径*名将始终将其设置为

```
 www.site.com/folder/page1.html 
```

因为那是……路径名。Pushstate 只是没有显示它。我现在正在这样做，它可以在没有超时的情况下正常工作：

```
 setPage = $.mobile.path.parseUrl( window.location.href );
   setPageUrl = setPage.hash == "" ? setPage.pathname : setPage.hash.replace('#','');
   page.attr({ 'data-url' : setPageUrl }); 
```

# aes - GCM、CCM 或 CBC-MAC 模式下的 AES 密码？

> ID：11511410
> 
> 赞同：3
> 
> 时间：2012-07-16T19:43:05.510
> 
> 标签：aes, encryption-symmetric, aes-gcm, cbc-mac

我一直在寻找一篇用外行术语描述这些模式的文章，但还没有发现任何有用的东西。那么，每种模式的优缺点是什么？谢谢

GCM

CCM

CBC-MAC

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:38:40.613

`CCM`- 此模式接受从 32 位到 128 位的可变长度身份验证标签，因此它实际上允许对未经授权的修改提供不同程度的保护，缺点：

*   CCM 模式不提供仅保密的服务。在某些情况下，它使用来自外部的数据真实性机制。

`GCM`- GCM 的加密和认证对选择明文攻击是安全的，并且 GCM 在使用 AES 分组密码时也是安全的。但：

*   重用IV时存在安全问题

对于两者`GCM`，`CCM`您都必须使用时间戳，否则可能会发生重放攻击，当然您需要适当的标签长度​​。

因为`CBC-MAC`这取决于您用于`CBC`创建 MAC，而 CBC 提供串行加密和并行解密，但是块中一位的更改会更改加密之后的所有内容，但不会影响解密。如果您使用 CBC 模式，那么在这种情况下，一个已知问题`CBC-MAC`是使用相同的密钥进行加密和身份验证，因此最后一个块将是 MAC。

只为微笑 -[密码学](http://xkcd.com/153/)

*这里要提到我使用的来源之一来自德国大学的研究。

**编辑：**找到它的名字：ruhr-universität-bochum。

# jquery - jQuery Cycle.js 错误下一个未定义

> ID：11511416
> 
> 赞同：1
> 
> 时间：2012-07-16T19:43:15.423
> 
> 标签：jquery, joomla

我在很多项目上都使用过循环，但这个真的让我很震惊。我正在一个有循环的网站上工作，它在我的平面模型中运行良好：[http ://www.meltingpotdesign.co.uk/momo5/](http://www.meltingpotdesign.co.uk/momo5/)

现在我把它变成了一个 Joomla 1.5 模板，它抛出了一个错误`next is undefined`——虽然它仍然有效：[http ://www.meltingpotdesign.co.uk/momosaics/](http://www.meltingpotdesign.co.uk/momosaics/)

为什么？我已经尝试禁用 Mootools 并没有什么区别，所以它似乎不是图书馆冲突。有任何想法吗？

# ios - sqlite_3 最后插入 rowid

> ID：11511424
> 
> 赞同：0
> 
> 时间：2012-07-16T19:43:48.957
> 
> 标签：ios, sqlite

我正在使用 iOS 上的 SQLite 数据库，但我无法弄清楚如何获取最后插入的行 ID。sqlite3_last_insert_rowid() 函数只适用于当前连接，所以如果我刚刚打开数据库，它是没用的。

在 C# 中，我习惯于使用`ExecuteScalar()`SQL 查询来调用`SELECT last_insert_rowid()`。有没有办法使用 sqlite3 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:58:12.643

不，抱歉，您只能在同一个数据库连接上使用它：

[http://www.sqlite.org/c3ref/last_insert_rowid.html](http://www.sqlite.org/c3ref/last_insert_rowid.html)

# windows - 如何让远程桌面客户端显示 Web 应用程序图像的所有颜色？

> ID：11511427
> 
> 赞同：0
> 
> 时间：2012-07-16T19:43:59.433
> 
> 标签：windows, colors, remote-desktop

我构建了一个 Web 应用程序，我有一个边框颜色 #888 和标题背景颜色 #eee 的表格。

我也有一个漂亮的渐变背景图像。

在我的 Windows XP 机器上看起来很棒。根据桌面 > 属性 > 设置，“颜色质量”是“最高（32 位）”。

我必须使用在 Windows 7 上运行的远程桌面客户端从会议室演示我的应用程序。当我这样做时，我还将远程桌面客户端设置设置为“最高 32 位”。

但是我的网络应用看起来很糟糕——#eee 背景颜色看起来是白色的，渐变背景图像具有逐渐变暗的粗线，而不是平滑的渐变。

关于如何让我的 Web 应用程序通过远程桌面客户端看起来正确的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:03:52.110

RD 会话的颜色深度取决于客户端和服务器上的设置。在这种情况下，听起来您的客户端设置正确，但您可能需要使用组策略配置 Windows XP 计算机，[如此 MSKB 文章](http://support.microsoft.com/kb/278502)中所述。

# javascript - 选择的harveshq的jquery插件问题

> ID：11511433
> 
> 赞同：0
> 
> 时间：2012-07-16T19:44:27.840
> 
> 标签：javascript, regex, jquery-chosen

我正在使用这个插件

[http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

当我搜索一些带有空格的选项时，我遇到了一个特定的问题。例如，如果我输入，我有一个选项 tha 是“Antigua y barbuda”：

1.  安提瓜和巴布达 -> 好的
2.  安提瓜 y -> 好的
3.  巴布达 -> 好的
4.  y -> 好的
5.  y巴布达->失败

只有当我开始写不是第一个单词时它才会失败（仅在有空格的情况下）

正则表达式：

```
regex = new RegExp(regexAnchor + searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&"), 'i');
zregex = new RegExp(searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&"), 'i'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T21:22:35.433

这可能是一个选择的问题。尝试使用源自 Chosen 的[Select2插件，它的效果要好得多。](http://ivaynberg.github.com/select2/)此外，它还允许自定义匹配器功能，因此您可以手动解决问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T08:21:45.357

您不需要删除 \s 只需设置 search_contains: true

```
$(".chzn-select").chosen({search_contains: true}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T12:34:48.467

解决了它删除“\ s”

```
zregex = new RegExp(searchText.replace(/[-[\]{}()*+?.,\\^$|#]/g, "\\$&"), 'i'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-29T11:55:55.850

对于有类似问题的 Joomla 开发人员：

```
JHtml::_('formbehavior.chosen', 'select', null, array('search_contains' => true)); 
```

# jquery - 已经在可放置空间中时如何默认拖动项目

> ID：11511434
> 
> 赞同：1
> 
> 时间：2012-07-16T19:44:29.580
> 
> 标签：jquery, jquery-ui, draggable, droppable

我刚刚开始这样做，但我想知道如何采用下面非常简单的示例并进行修改，以便如果可拖动的 div 已经放置在可放置的 div 上，它不会触发警报。

```
 <script type="text/javascript">
          $(function () {
              $("#draggable-1").draggable();
              $("#draggable-2").draggable();

              $("#droppable").droppable({
                  drop: function (event, ui) {
                      var currentId = $(ui.draggable).attr('id');

                      if (currentId == "draggable-1") {
                          $(this)

                          // would like to prevent this if draggable is already dropped!
                          alert("Adding Item #1.")

                      } else {
                          $(this)
                          alert("Adding Item #2.")
                      }
                  }
              });
          });
      </script>
    <table width="100%"><tr><th>Draggable</th><th>Order Section</th><tr><td>
    <div id="draggable-1">
        <p>Item #1</p>
    </div>

    <div id="draggable-2">
        <p>Item #2.</p>
    </div>

    <div id="droppable">
        <p>Add Your Item</p>  
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:45:08.857

一种对我有用的解决方案：

```
var wasInDrop = false;
var finishInDrop = false;
$("#draggable_1").draggable({
    start:  function(event, ui){
            if (! finishInDrop){
                wasInDrop = false;
            }
            finishInDrop = false; //will be set to true if landing in drop.
        },
    stop:     function(event, ui){
            if (finishInDrop && !wasInDrop){
                          alert("Adding Item #1.");
            }
            if (finishInDrop){ wasInDrop=true;}

        }
    });

$("#droppable").droppable({
    drop: function (event, ui) {
        $(this)
        var currentId = $(ui.draggable).attr('id');
        if (currentId == "draggable_1") {
            finishInDrop = true; //for this time.
        }
    }); 
```

等等。这个想法是可拖动的会触发警报，如果：

1.  它在 droppable 内完成。
2.  它不是在 droppable 内部开始的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:47:52.323

检查这个小提琴：http: [//jsfiddle.net/100thGear/XfUvS/](http://jsfiddle.net/100thGear/XfUvS/)

位置有点问题，但达到了预期的效果。让我知道这是否有帮助！

# symfony - 在欢迎页面中获取空白页面

> ID：11511440
> 
> 赞同：0
> 
> 时间：2012-07-16T19:44:43.297
> 
> 标签：symfony

安装后，修复了所有警告+主要问题，我进入 Symfony 的“欢迎”页面，运气不好，页面是空的。

我做错什么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:46:38.613

在解决了 Symfony 抱怨的问题并在修复它们时变得疯狂之后，我删除了 vendor 文件夹来修复它，只需运行：

```
php bin/vendors install 
```

你已经准备好进行一些严肃的编程了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T09:31:23.510

我也有这个问题......你可以在开发模式下尝试它，比如你的虚拟主机，然后是 /app_dev.php。

例如：

```
symfony2demo.com/app_dev.php 
```

我认为这应该对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-18T07:25:35.177

空白页通常意味着 php 错误。这可能有很多原因，从损坏的安装到错误的文件权限。甚至更简单的事情，例如不遵循所有安装步骤。好消息是您的 Web 服务器和/或 php 日志文件中的某处应该有线索。

我遇到的唯一一个从日志文件中不一定清楚的问题是`php.ini`. `memory_limit = 32M`. 从一开始就不太可能出现问题，但仍然值得将其更改为 128M 或 256M 以避免将来出现问题。

# image - 在lwuit中旋转非方形图像

> ID：11511449
> 
> 赞同：0
> 
> 时间：2012-07-16T19:45:18.880
> 
> 标签：image, rotation, lwuit

我正在尝试旋转 lwuit 图像。问题是图像尺寸为 400x300，所以当我旋转它时，它会被剪切。Lwuit 文档说 rotate 方法假定一个正方形图像，这就是问题所在。还有其他方法可以旋转图像吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:15:43.003

我找到了解决方案：

```
javax.microedition.lcdui.Image lcduiImage=(javax.microedition.lcdui.Image) imagen.getImage();
javax.microedition.lcdui.Image lcduiImageRotada=javax.microedition.lcdui.Image.createImage(lcduiImage, 0, 0, lcduiImage.getWidth(), lcduiImage.getHeight(), Sprite.TRANS_ROT90);
imagen=Image.createImage(lcduiImageRotada); 
```

# iphone - 如果蓝牙设备不在 MFi 程序中，它应该支持哪些配置文件以便 iPhone 应用程序可以检查它的 MAC 或名称？

> ID：11511452
> 
> 赞同：0
> 
> 时间：2012-07-16T19:45:31.007
> 
> 标签：iphone, bluetooth, profile, mfi

我想构建一个 iPhone 应用程序，它应该通过名称或 MAC 检查 BT 设备的身份。

如果设备不是 MFI 程序的一部分，设备应该支持哪些配置文件才能让 iPhone 应用程序连接到它并验证其 MAC 或名称？

干杯，Ionut

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T00:00:55.510

我不确定您是否需要连接到某个东西才能获得 MAC 地址或名称。我同事的 iphone 似乎可以看到我们工作区域中的所有其他蓝牙设备并显示名称，只是无法连接到它们。而且我确信它会在获得名称之前获得 MAC，但会避免向用户显示它，因为名称更加友好。

我确实知道，对于 android 和 blackberry，您实际上使用 MAC 地址作为您的基本内部标识符，并且只有在您想向用户识别您的远程设备时才提取名称。

如果您确实需要从 iOS 连接到非 MFi 蓝牙收音机，高级音频分配配置文件 (A2DP) 可以满足您的需求。我见过一款产品是蓝牙控制的电源板，它使用通过 A2DP 传输的音频脉冲来绕过 MFi 要求。尽管您应该重新考虑这种方法，因为非音频设备宣传音频配置文件是有问题的。这个假音频设备会被更多的人看到，而不是你的应用程序。

如果您很高兴只使用 iphone 4s 及更高版本，我还听说过蓝牙 LE（4.0？）设备不需要苹果验证芯片的传言……但还没有真正研究过

# android - Android 有时我会收到 android.app.RemoteServiceException: Bad notification posted from package。为什么？

> ID：11511458
> 
> 赞同：9
> 
> 时间：2012-07-16T19:45:51.263
> 
> 标签：android, exception, notifications

我的通知有严重问题。

有时，当我的应用发布相同的自定义通知时，我会收到此错误：

```
android.app.RemoteServiceException: Bad notification posted from package  com.packagename: Couldn't expand RemoteViews for: ClassName(package=com.packagename id=0     tag=null notification=Notification(vibrate=null,sound=null,defaults=0x0,flags=0x22))
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1093)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3906)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:840)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:598)
at dalvik.system.NativeStart.main(Native Method) 
```

我必须做什么？

该通知仅包含 LinearLayout、TextViews 和 ImageViews，并且在大多数情况下都能完美运行。

有一种方法可以用 try/catch 来解决这个错误，这样 android 就不会停止我的应用程序吗？

非常感谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T21:09:43.943

1) [http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/ActivityThread.java#ActivityThread](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/ActivityThread.java#ActivityThread)

从这里我们可以看到，这个错误只会在一种情况下出现：

```
case SCHEDULE_CRASH:
throw new RemoteServiceException((String)msg.obj); 
```

2) [http://openstorage.gunadarma.ac.id/android/sdk/sdk_310712/sources/android-15/android/app/ApplicationThreadNative.java](http://openstorage.gunadarma.ac.id/android/sdk/sdk_310712/sources/android-15/android/app/ApplicationThreadNative.java)

```
case SCHEDULE_CRASH_TRANSACTION:
        {
            data.enforceInterface(IApplicationThread.descriptor);
            String msg = data.readString();
            scheduleCrash(msg);
            return true;
        } 
```

所以这个错误来自`ApplicationThreadNative`

您可以尝试提前跟踪，也许您会找到导致此错误的原因。

# c# - 创建新的事件日志源

> ID：11511471
> 
> 赞同：0
> 
> 时间：2012-07-16T19:46:39.487
> 
> 标签：c#, .net, security, registry, event-log

我的应用程序调用了一个库（我无法控制它），它创建一个新的 EventLog 源并使用 EventLog.SourceExists。它抛出`System.Security.SecurityException: The source was not found, but some or all event logs could not be searched. Inaccessible logs: Security.`

该应用程序需要对`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\eventlog\Security`. 如何向注册表授予网络服务权限（以编程方式）？

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:56:49.140

您收到此错误消息是因为您的“新源”未注册，因此您需要管理权限。尝试在控制台中以“管理员”身份运行您的 APP。

我曾经通过自己添加“源”来入侵“注册表”，但这可能是不明智的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T15:28:27.360

我今天遇到了同样的问题，WinForms 或 ASPX 的答案似乎都不适合我的情况（非安装计划任务 exe）。所以我这样做了： -

```
 protected void prog_Load(object sender, EventArgs e)
    {
        boolean setupComplete = false;
        try // setting an Event log entry, just to see if we can
        {
            logEvent = "prog started";
            EventLog.WriteEntry(logSource, logEvent, EventLogEntryType.Information, 0);
            setupComplete = true;
        }
        catch (Exception eLog1) // we can't, so try to fix
        {
            try
            {
                EventLog.CreateEventSource(logSource, logLog);
                logEvent = "prog registered for Event Logging";
                EventLog.WriteEntry(logSource, logEvent, EventLogEntryType.Information, 0);
            }
            catch (Exception eLog2) // aha!  we probably lack admin rights to set the registry key
            {
                MessageBox.Show("prog needs admin rights the first time it runs", "prog Setup", MessageBoxButtons.OK, MessageBoxIcon.Warning);
            }
        }

        // run
        if (setupComplete == true)
        {
            DoTheWork();
        }

        // exit
        this.Close();
    } 
```

# c - 嵌入式 C 将字符串传递给函数

> ID：11511473
> 
> 赞同：1
> 
> 时间：2012-07-16T19:46:50.057
> 
> 标签：c, string, winavr

我正在尝试将 C 中的字符数组逐字节发送到微控制器的输出。我正在使用以下代码：

```
int main() {
...
   LogOutput("Hello World!");
}

void LogOutput(char *msg) {

    int i;
    for (i = 0; i < sizeof(msg); i++) {
        USART0_TX(msg[i]);              // transmit byte
    }
} 
```

然而，这只发送前两个字母“他”——有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:47:56.930

您正在使用`sizeof`运算符，并获取*datatype*的大小，而不是字符串的长度。用于`strlen`获取字符串的长度（包括`string.h`for`strlen`和其他字符串操作函数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:51:51.653

```
int main() {
...
   LogOutput("Hello World!");
}

void LogOutput(char *msg) {

    int i;
    for (i = 0; i < strlen(msg); i++) {
        USART0_TX(msg[i]);              // transmit byte
    }
} 
```

# android - 具有有效访问令牌的 Android Facebook Oauhexception

> ID：11511474
> 
> 赞同：1
> 
> 时间：2012-07-16T19:46:54.457
> 
> 标签：android, facebook-graph-api

我正在尝试与 Facebook 进行简单的交流。目前，我可以让用户登录并以他们的身份发布到他们的墙上。但无论出于何种原因，我似乎无法访问他们的姓名等公共信息。我一直收到此错误：

{"error":{"message":"语法错误 \"预期字符串结尾而不是 \"?\".\" 在字符 4: name?access_token=MYACCESSTOKEN","type":"OAuthException","code ":2500}}

这是电话：

```
SampleRequestListener srl = new SampleRequestListener();
AsyncFacebookRunner afr = new AsyncFacebookRunner(facebook);
afr.request("http://graph.facebook.com/me?fields=name", (RequestListener)srl); 
```

该调用是在经过验证的会话中进行的（在 .Authorize 的 DialogListener 的 onComplete 部分中）。使用我的 access_token 和与上面完全相同的字符串，我可以让请求在[http://developers.facebook.com/tools/explorer/上正常工作](http://developers.facebook.com/tools/explorer/)

解析 RequestListener.onComplete 中的响应时发生错误

```
JSONObject json = Util.parseJson(response);
final String name = json.getString("name");
System.out.println("Hi, my name is " + name); 
```

感谢您的时间。欢迎所有输入。

***更新 ****

有两件事正在发生。在 facebook API 中，Util.openUrl 附加了一个“？” 在字段名称和 access_token 之间（正如下面的答案所指出的）。这似乎很奇怪。我想知道我是否提取了旧版本的 API 之类的。你会认为这将被正确设置。

另外，我错误地调用了该方法：这个：

```
afr.request("http://graph.facebook.com/me?fields=name", (RequestListener)srl); 
```

应该：

```
afr.request("me?fields=name", (RequestListener)srl); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-27T23:01:05.787

如果您使用的是 com.facebook.Request 类，那么只需使用以下形式的构造函数：Request(Session session, String graphPath, Bundle parameters, HttpMethod httpMethod, Callback callback) 并在“parameters”参数中传递您的参数。

就像：

```
if (GlobalApplication.accessToken != null && !GlobalApplication.accessToken.isExpired()) {
                    /* make the API call */
                    Bundle b = new Bundle();
                    b.putString("fields", "id,created_time,description,embed_html,name,source,picture");
                    new GraphRequest(GlobalApplication.accessToken, "/me/videos",
                            b, HttpMethod.GET, new GraphRequest.Callback() {
                        @Override
                        public void onCompleted(GraphResponse response) {
                            /* handle the result */
                            Log.i("", "");
                            String string = response.toString();

                            JSONObject object = response.getJSONObject();
                            JSONArray array = response.getJSONArray();
                            Log.i("", "");
                        }
                    }).executeAsync(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:18:43.740

看起来正在发送的实际请求类似于

```
/me?fields=name?access_token=MYACCESSTOKEN 
```

这当然是错误的；它应该是第二个参数之前的和号，而不是问号。

您必须在代码中查找将访问令牌添加为参数的位置。此时应该在附加 access_token 参数之前检查此 URL 是否已包含问号。

# javascript - google's soa architecture - 为 google 的 web 用户界面聚合内容

> ID：11511480
> 
> 赞同：8
> 
> 时间：2012-07-16T19:47:11.680
> 
> 标签：javascript, design-patterns, architecture, soa

登录到 Google 后，Google 主页会链接到多个其他服务（例如 Gmail、Play、Drive）。

Q1) 是否有一种 SOA 模式描述了它们松散耦合每个服务的 UI 的方式，但同时还提供标准菜单栏、标准外观和跨应用程序的单点登录？

Q2) 是否有任何可用的文档来描述他们用于链接 UI 内容的架构？

**编辑**

我查看了 Firebug，似乎菜单栏和应用程序之间存在双向关系。菜单栏有一个指向每个应用程序的链接，但每个应用程序也包含菜单栏。

我可以将其与[eclipse](http://www.eclipse.org/) UI 联系起来，其中应用程序可以为应用程序菜单做出贡献，但每个菜单都存在于 eclipse 应用程序的上下文中，该应用程序聚合了所有单独的 UI 插件。

那么谷歌是如何在他们的用户界面中做到这一点的呢？看起来有一些 javascript 魔法正在进行，菜单栏被注入到每个应用程序中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T12:23:32.790

Google为 UI 部分使用了自己的[Closure 库：](https://developers.google.com/closure/library/?hl=en)

> **什么是闭包库？**
> 
> 闭包库是一个广泛的、经过良好测试的、模块化的、跨浏览器的 JavaScript 库。您可以从大量可重用的 UI 小部件和控件以及用于 DOM 操作、服务器通信、动画、数据结构、单元测试、富文本编辑等的低级实用程序中提取所需的内容。
> 
> [...]
> 
> **谁使用闭包库？**
> 
> 搜索、Gmail、地图、文档、网站、图书、阅读器、Blogger、日历、Google+、照片

[https://developers.google.com/closure/library/?hl=en](https://developers.google.com/closure/library/?hl=en)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-25T13:57:48.323

hawt.io 项目有一个有趣的方法：

> hawtio 是高度模块化的，因此它可以准确地发现 JVM 中的服务，并动态更新控制台以向它们提供接口。

链接在[这里](http://hawt.io)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-20T12:17:46.720

我不知道谷歌，但我曾在做类似事情的网站上工作过。例如，它是一家大型房地产机构的网站，该机构在世界各地设有办事处，主页（和其他页面）包括一个显示特定国家/地区内容的轮播，所有办事处都使用相同 CMS 的不同实例管理自己的内容。

发生的情况是 CMS（基于 .NET）使用自定义和用户控件 (.ascx) 文件来呈现最终的 aspx 页面。这些 ascx 文件（用于页眉、页脚和轮播）、与这些文件相关的所有样式和 javascript（按照我们的约定放在一个无法操作的名为 _CSS 和 _JS 的文件夹中）集中维护，然后复制到所有本地网站.

CMS 实例 - 特定于一个国家办事处 - 然后将创建自己的页面，但它们都使用中央应用程序提供的这些通用页眉和页脚。

最后一张图是让所有这些保持同步，您需要某种代理或服务将这些公共组件传播到所有服务器和 CMS 实例，以确保它们都使用相同的控件、样式和javascript（可以集中引用样式和 javascript，但自定义用户控件需要存在于特定 CMS 的应用程序域中，至少对于 .NET）。我们将 Repliweb 用于此类任务，但我对它的细节不是很熟悉。

从架构的角度来看，我认为它是一种用于 UI 的插件架构，因此将其与 Eclipse 架构联系起来是正确的。中央 CMS 是一种抽象类型，提供特定站点实例必须遵守并实现它的接口。

```
abstract class GoogleSite
{
    Control Header { get; set; }
    Control Footer { get; set; }

    public string Title { get { return "Default title"; } }

    public abstract void ProvideContents();
}

class Gmail: GoogleSite
{
    //still using same header and footer but Title is different
    override public string Title { get { return "Gmail"; } }

    public override void ProvideContents()
    {

    }
}

class GPlus: CentralCMS
{
    //Another CMS not overriding the title but Providing different contents
    public override void ProvideContents()
    {

    }
} 
```

# asp.net - 如何避免在回发时从 asp.net 重复输入？

> ID：11511481
> 
> 赞同：2
> 
> 时间：2012-07-16T19:47:20.790
> 
> 标签：asp.net, refresh, postback

我有一个从模板表中提取数据的下拉列表。我有一个添加按钮来插入新模板。添加按钮将弹出 jQuery 弹出窗口以插入新值。将有一个保存按钮来保存新数据。On_Save_Click 我输入新数据并关闭弹出窗口。

**这是问题：** 当我刷新页面时，页面再次输入值。所以，我得到重复的条目！

**问题：** 我怎样才能避免这个问题？我查看了 Satckoverflow 和 Google，他们都建议重定向到另一个页面。我不想将用户重定向到另一个页面。我怎样才能使用相同的表格来避免这个问题？请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:04:17.103

您可以使用 viewstate 或 session 来指示数据是否已插入（按下按钮）。

像这样的东西：

```
private void OnbuttonAdd_click()
{
   if(ViewState["DataInserted"] != "1")
   {
      ...
      // Add new entry...
      ...
      if(data inserted successfully)
      {
         ViewState["DataInserted"] = "1";
      }
   }
} 
```

**编辑：**

```
public bool DataInserted
{
    get
    {
        if (HttpContext.Current.Session["DataInserted"] == null)
        {
            HttpContext.Current.Session["DataInserted"] = false;
        }
        bool? dataInserted = HttpContext.Current.Session["DataInserted"] as bool?;

        return dataInserted.Value;
    }
    set
    {
        HttpContext.Current.Session["DataInserted"] = value;
    }
}

...

private void OnbuttonAdd_click()
{
   if(!DataInserted)
   {
      ...
      // Add new entry...
      ...
      if(data inserted successfully)
      {
         DataInserted = true;
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:09:12.730

最简单的方法是使用[post/redirect/get 模式](http://en.wikipedia.org/wiki/Post/Redirect/Get)。

基本上，使用 post 构建页面的刷新操作需要重新发布数据。使用此模式，您将重新加载整个页面。

使用 ASP.Net，您有一个简单的替代方案，使用[`UpdatePanel`](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.aspx). 这将使用 AJAX 仅刷新页面的一部分。由于页面本身仍然是 GET 请求的结果，因此您可以刷新页面。当您使用 ASP.Net 时，它很容易集成。

最后，您可以使用自制的 AJAX 刷新。jQuery、KnockOut 和 rest 服务的组合（例如）可以帮助您避免刷新整个页面，从而受益于 ajax 调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-12T13:13:53.937

这样做非常简单有效

不要在页面load()中给出IsPostBack，请在按钮内提供点击（发送或插入数据）

## 重置所有输入值后再次调用同一页面

```
 protected void Btn_Reg_Click1(object sender, EventArgs e)
    {
        try
        {
            if (IsPostBack)
            {
                Registration_Save();
                Send_Mail();
                txtEmail.Text = "";
                txtname.Text = "";
                Response.Redirect("~/index.aspx");
            }

        }
        catch (Exception) { }

    } 
```

* * *

刷新页面后您将看不到任何服务器消息..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-02T09:05:35.523

有一些经验：

1.  单击时禁用提交按钮（通过 JavaScript 在客户端）。
2.  在服务器端保存操作时更改 Session['issaved'] = true 并将新操作更改为 false。
3.  使用视图状态传递参数，如 RecordId（而不是 QueryString）以在刷新页面上清除。我总是将带有 Session 的参数传递给新页面，然后在页面加载时设置 ViewState['aaa']=Session['aaa'] 并清除 Sessions。

...我希望有用...

# sql - 数据库设计 - 何时拆分表？

> ID：11511482
> 
> 赞同：6
> 
> 时间：2012-07-16T19:47:21.820
> 
> 标签：sql, database, database-design

有时创建一个单独的表会产生更多的工作，我是否应该拆分它？

**例如：**在我的项目中，我有一张客户表，**每个客户对每种产品都有自己的特价**（只有 5 种产品，未来没有计划更多产品），每个客户在一周中也有独特的日子公司将产品交付给他。

当天数和产品价格是客户表中的列而不是单独的表时，诸如更改客户的天数/价格或显示所有客户的天数和价格之类的许多操作会容易得多，因此仅创建一个大客户是否被驳斥在这种情况下的表？有什么缺点？

**更新：**他们刚刚告诉我，大约一年后他们有机会添加更多产品，他们说他们的业务无论如何都不会超过 20-30 种产品。我仍然不明白为什么在这种情况下，当产品的价格没有关系（每个客户都有自己的特价）时，在 Products 表中添加行比在 Customers 表中添加列更好？我能想到的唯一好处是只有 5 个产品的客户不必“携带”20 个可空产品（节省服务器空间）？我没有太多经验，所以也许我错过了显而易见的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:50:39.330

显然，仅仅说应该*始终*规范化是不切实际的。没有任何建议总是正确的。

如果您可以肯定地说 5 个“项目”在很长一段时间内就足够了，我认为如果可以节省您的工作，将它们存储为列是完全可以的。

如果您的预测失败并且需要存储第 6 个项目，您可以添加一个新列。只要列数不会以很高的概率失控，这应该不是问题。

小心这种策略，因为**许多程序员预测未来的能力非常有限。**

最后，只有一件事很重要：以最低的成本提供所需的解决方案。代码的纯度不是目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T11:47:41.270

规范化完全是关于数据完整性（一致性），仅此而已；与难、易、快、慢、高效和其他模糊属性无关。当前的设计几乎可以肯定允许数据异常。如果不是现在，当您尝试跟踪价格变化、发票、订单等时，它就是死路一条。

# php - 从 Drupal 7 中的模块修改链接

> ID：11511485
> 
> 赞同：0
> 
> 时间：2012-07-16T19:47:30.150
> 
> 标签：php, drupal

在我的 drupal 站点上，有一个带有一些模块化块的页面，它们输出一组链接。在我的模块中，我需要能够将一些 GET 参数附加到这些链接。我应该如何处理这个？

附加必须在模块中完成，因为我在那里有生成参数的 PHP 代码。

谢谢

编辑：经过一番调查，我发现了创建链接的原因。我相信这是一个现场收藏。链接本身是一个字段值。我尝试通过执行以下操作直接在 field--field_modular_box.tpl.php 中修改它：

```
foreach ($items as $delta => $item): 
  $item['entity']['field_collection_item'][$key]['field_mod_box_logo']['field_mod_box_call']['und'][0]['display_url'] .= "&" . generate_token();
endforeach; 
```

但这实际上并没有改变显示的链接。我已经检查过了，这是生成链接的正确模板。

# c# - 在 C# 中通过 ActiveX 下载文件

> ID：11511487
> 
> 赞同：0
> 
> 时间：2012-07-16T19:47:34.700
> 
> 标签：c#, .net, html, download, activex

我有启动 ActiveX 以下载文件的 html。

我希望通过 C#/.NET 完成，而不是使用 Internet Explorer 下载文件

HTML 如下所示：

```
<HTML>
    <HEAD>
        <META http-equiv="Content-Type" content="text/html; charset=utf-8">
        <OBJECT ID="o" CLASSID="CLSID:XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX" CODEBASE="https://YYYYYY/grTransferCtrl.cab#version=5,0,0,32">
        </OBJECT>
        <SCRIPT LANGUAGE=VBScript FOR=window EVENT="onLoad()">

            On Error Resume Next

            o.Persist "AAA"
            o.Persist "BBB"
            o.Persist "CCC"

            bRetVal = o.Launch()
            If(Err.Number > 0 Or bRetVal = False) Then 
            msgbox "There was an error launching File Transfer Manager.",0,""
            End if

        </SCRIPT>
    </HEAD>
<BODY></BODY> 
```

如何直接从我的 C# 应用程序启动下载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:55:25.190

您要查找的关键字是 ` [WebRequest](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx) '

以下将大致完成您想要的操作：

```
var request = WebRequest.Create("https://YYYYYY/grTransferCtrl.cab#version=5,0,0,32");

//This is where you may need to add cookies and other header data for this to work.
//I would use fiddler to try and inspect the http requests sent by the control for this
//information
request.UseDefaultCredentials = true;
var response = request.GetResponse();

using (var file= response.GetResponseStream())
{
    //do something with the stream? save it?
}   
response.Close(); 
```

作为替代方案，您可以在应用程序中创建 ActiveX 控件并直接使用它。Web 上有大量资源可用于将 ActiveX 控件添加到 .NET 表单应用程序，只是不知道此特定控件对其环境做出的哪些假设可能会阻止这种情况发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:10:18.503

您可以通过使用 System.Net.WebClient 来实现这一点

```
Example:

public class Downloader
{
  public void DownloadFile()
  {
     using(WebClient webClient = new WebClient())
     {
         webClient.DownloadFile("http://www.stackoverflow.com/stacks.txt", @"c:\stacks.txt");
     }
  }
} 
```

# json - 将 JSON 解析为 TListBox

> ID：11511488
> 
> 赞同：8
> 
> 时间：2012-07-16T19:47:36.397
> 
> 标签：json, delphi, delphi-xe2, firemonkey, cloudflare

晚上好，伙计们！

我目前正在尝试`CloudFlare`为桌面组装一个客户端。我已连接到他们的 API 并通过 POST 请求成功检索了 JSON 结果（其结果已输出到`TMemo`. 我现在想将这些结果解析成一个`TListBox`（例如，参见粗体区域）。该项目正在设计中`Firemonkey`。

这是带有一些示例内容的响应的格式化布局；

```
{
 - response: {
   |- ips: [
      |- {
         ip: "xxx.xxx.xxx.xxx",
         classification: "threat",
         hits: xx,
         latitude: null,
         longitude: null,
         zone_name: "domain-example1"
         },
       - {
         ip: "yyy.yyy.yyy.yyy",
         classification: "robot",
         hits: yy,
         latitude: null,
         longitude: null,
         zone_name: "domain-example2"
         }
       ]
   }
  result : "success",
  msg: null
} 
```

我尝试了几种不同的组件[——SuperObject](http://code.google.com/p/superobject)、[Paweł Głowacki 的 JSON Designtime Parser](http://edn.embarcadero.com/article/40882)、[Tiny-JSON](http://code.google.com/p/tiny-json/)、[LKJSON](http://lkjson.sourceforge.net)和内置的 DBXJSON。但是，我根本没有使用 JSON 的经验，而且我似乎找不到可以开始使用的最基本的示例。其中许多显示了示例数据，但我尝试过的所有数据似乎都没有按我的预期工作，很可能是因为我误解了它们。我假设这些组件可以工作，所以我需要入门指导。

“数组”中有数百个，通常是数千个结果`ips`（如果这不正确，我深表歉意，我假设它被称为数组，但同样，我对 JSON 完全陌生）。

我真正在寻找的是某种非常基本的示例代码，我可以从中构建（以及它用于解析的组件等）。

**例如，如果我想`ip`从 JSON 结果中获取每一项，并将每一项作为单独的项目放入`TListBox`（使用`TListBox.add`方法）中，我将如何实现这一点？**

当我说 时`ip`，我的意思是值（在上面的格式化布局中，这将是`xxx.xxx.xxx.xxx`or `yyy.yyy.yyy.yyy`）。

此外，如果我想通过它的 IP 从 JSON 结果中找到“记录”（？）并将数据输出到 delphi 数组 - 例如；

```
Result : Array of String = ['"xxx.xxx.xxx.xxx"','"threat"','xx','null','null','"domain-example1"']; 
```

JSON可以吗？（如果这被视为一个单独的问题或太不相关，请随时编辑它而不是关闭整个问题）。

我得到的最接近的不仅是ip，而且是单独的所有其他数据（`TListItem`即`response`，，，，`ips`以及其他所有内容都有它自己的项目`ip`，以及每个非空项目之间的几个空项目）。`classification``xxx.xxx.xxx.xxx`

我确信这非常简单，但是关于 JSON 的信息太多了，对于刚接触这种格式的人来说有点不知所措。

最好的问候，斯科特·普里查德。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T23:01:38.357

一旦您了解了基本概念，JSON 非常简单且易于理解。看看[http://json.org](http://json.org)，它解释了一些事情。

JSON中有4个基本概念：

值是任何 JSON 元素：基本字符串或*数字*、数组或对象。（除了一*对*之外的任何东西。）

*数组*应该是一个熟悉的概念：值的有序列表。与 Delphi 数组的主要区别在于 JSON 数组没有定义元素的类型。它们只是“一组 JSON 值”。

一*对*是键值对。键可以是字符串或数字，值可以是任何 JSON 值。

*对象*是 JSON 对的关联映射。您可以在概念上将其视为`TDictionary<string, JSON value>`.

因此，如果我想获取这样的 JSON 数据数组，并将其放入 TListBox，我会做这样的事情（DBXJSON 示例，警告：未测试）：

```
procedure TMyForm.LoadListBox(response: TJSONObject);
var
  i: integer;
  ips: TJSONArray;
  ip: TJSONObject;
  pair: TJSONPair;
begin
  ListBox.Clear;
  pair := response.Get('ips');
  if pair = nil then
    Exit;
  ips := pair.value as TJSONArray;
  for i := 0 to ips.size - 1 do
  begin
    ip := ips.Get(i) as TJSONObject;
    pair := ip.Get('ip');
    if pair = nil then
      ListBox.AddItem('???', ip.Clone)
    else ListBox.AddItem(pair.JsonString, ip.Clone);
  end;
end; 
```

然后，您有一个 IP 地址列表，以及包含完整记录的关联对象，如果用户选择一个，您可以获得这些记录。（如果您想将每条记录的全部内容放入列表控件中，请查看`TListView`。它比这样做更好`TListBox`。）

如果您想构建一个包含所有值的字符串数组，请执行以下操作：

```
function JsonObjToStringArray(obj: TJsonObject): TArray<string>;
var
  i: integer;
begin
  SetLength(result, obj.Size);
  for i := 0 to obj.Size - 1 do
    result[i] := obj.Get(i).JsonValue.ToString;
end; 
```

当然，这只是示例代码，但它应该为您提供一些构建基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T17:55:14.580

**EDIT2：** AV 非常轻松地修复。

**编辑：**在进一步检查我自己的代码后，我意识到它会导致大量的内存泄漏。但是，我已经切换到`SuperObject`并发现可以在 2 行代码中实现相同的结果，只有 2 个变量并且没有内存泄漏；

```
Procedure ParseIPs;
  ISO : ISuperObject;
  MyItem : ISuperObject;
begin
  ISO := SO(RetrievedJSON);
  for MyItem in ISO['response.ips'] do Memo2.Lines.Add(MyItem.S['ip']);
end; 
```

`RetrievedJSON`只是一个`string`包含未解析的纯文本 JSON（即不是一个`JSONString`而是一个实际的字符串）。

为了连续性，我将原始代码留在了下面。

* * *

在 Mason Wheeler 较早的回答中以及“teran”在[问题 9608794](https://stackoverflow.com/questions/9608794/delphi-accessing-json-objects-within-a-json-array)上提供的回答的帮助下，我成功构建了以下内容以解析到我需要访问的实际级别（即包含数据的“数组”） ，然后将具有特定的所有项目输出`JSONString.Value`到列表框中（在下面的示例中命名`LB1`）；

```
Procedure ParseIP;
var
  o, Jso, OriginalObject : TJSONObject;
  ThePair, JsPair : TJSONPair;
  TheVal, jsv : TJSONValue;
  jsArr : TJsonArray;
  StrL1 : String;
  i, num : Integer;
begin
  num := 0;
  o := TJSONObject.ParseJSONValue(TEncoding.ASCII.GetBytes(Memo1.Text), 0) as TJSONObject;
  ThePair := o.Get('response');
  TheVal := ThePair.JsonValue;
  STRL1 := TheVal.ToString;
  JSV := TJSONObject.ParseJSONValue(STRL1);
  OriginalObject := JSV as TJSONObject;
  JSPair := OriginalObject.Get('ips');
  JSARR := JSPair.JsonValue as TJSONArray;
  for i := 0 to JsArr.Size-1 do
    begin
      JSO := JSArr.Get(i) as TJSONObject;
      for JSPAIR in JSO do
        begin
        num := num+1;
          if JSPAIR.JsonString.Value = 'ip' then
          begin
            LB1.Items.Add(JSPair.JsonValue.Value);
          end
          else null;
        end;
    end;
    ShowMessage('Items in listbox: ' + IntToStr(LB1.Items.Count));
    ShowMessage('Items in JSON: ' + IntToStr(num div JSO.Size));
    Jsv.Free;
end; 
```

虽然这是一种非常迂回的方法，但它允许我查看每个单独的步骤，并非常轻松地查看它在 JSON 中向下迭代的位置，并将其更改为我可以输出任何片段的函数或数据范围作为基于多个标准之一的结果。为了验证我得到了正确数量的项目，我`ShowMessage`在最后添加了 2 个例程；一个用于列表框中的项目，一个用于我正在解析的“ip”数据实例的数量。

此代码在 Firemonkey 中使用 CloudFlare API JSON 结果进行了专门测试，这些结果与`TMemo`检索到的结果完全相同（在`&calls_left&a=zone_ips&class=t&geo=1`API 调用中，当然还有您的`zone`,`token`并`email`附加）。修改它以使用来自众多其他 API 调用的其他结果也应该相对容易。

为了澄清，我确实尝试了 Mason 的代码，但不幸的是我无法让它工作。但是，我暂时接受了他的回答，因为他对基础知识的解释是值得的，并帮助我找到了最终解决方案，并提出了一些我可以从中构建和自学的东西。

# json - 如何在extjs中读取具有多个根的嵌套json文件

> ID：11511492
> 
> 赞同：1
> 
> 时间：2012-07-16T19:47:48.637
> 
> 标签：json, extjs4

如何读取以下 json 文件并在 extjs 网格列中显示？

```
{
    "users": [
        {
            "id": 123,
            "name": "Ed",
            "orders": [
                {
                    "id": 50,
                    "total": 100,
                }
            ]
        }
    ]
} 
```

有人可以解释如何读取 json 中的嵌套数据吗？我尝试了很多选项，例如渲染器功能，使用“。” 财产等

编辑：我想读取“订单”中的数据，即“id”和“total”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T19:49:46.053

您正在尝试读取嵌套在嵌套在数组中的对象中的数组。

所以你的根必须是 users[0].orders

这真的是你想要做的吗？

工作代码：

[http://jsfiddle.net/el_chief/s6Ynp/1/](http://jsfiddle.net/el_chief/s6Ynp/1/)

为什么你的代码是这样嵌套的？

# database - 如何检查Access数据库中是否存在记录

> ID：11511493
> 
> 赞同：1
> 
> 时间：2012-07-16T19:47:53.380
> 
> 标签：database, vb.net, ms-access, login, oledb

我正在为我正在从事的项目尝试一种新方法，并且我刚刚开始了解 Access 数据库。我使用**VB.net**，我的问题是：如何查看数据库表中是否存在记录。我以为我明白了，但事实并非如此。我正在创建一个登录名，我希望它在尝试将您输入的内容与数据库中的内容进行比较之前检查他们输入的用户名是否存在。我看到很多关于如何做到这一点的问题......但不适用于 VB.net*和*MS Access

这是我的代码：

```
Imports System.Data.OleDb
Public Class LoginForm1
    Dim provider As String
    Dim dataFile As String
    Dim connString As String
    Public myConnection As OleDbConnection = New OleDbConnection
    Public dr As OleDbDataReader
    Dim Errors As String
    Public Sub AccessAccountDatabase()
        provider = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source ="
        dataFile = "C:\Users\Richard\Documents\Visual Studio 2010\Projects\CybSol Journal Database\CybSol Journal Database\cgi-bin\Data.mdb"
        connString = provider & dataFile
        myConnection.ConnectionString = connString
        Errors = ""
        Try
            myConnection.Open()
            Dim str As String
            str = "SELECT * FROM Accounts WHERE Username='" & UsernameTxt.Text & "' AND Password='" & PasswordTxt.Text & "'"
            Dim cmd As OleDbCommand = New OleDbCommand(str, myConnection)
            dr = cmd.ExecuteReader
            dr.Read()

            If UsernameTxt.Text = dr("Username").ToString AndAlso PasswordTxt.Text = dr("Password").ToString Then
                Dim Welcome As String = "SELECT * FROM Accounts WHERE Real_Name=" & "Username"
                MsgBox("Welcome back " & dr("Real_Name") & "!")
            Else
                MsgBox("Login Failure")
            End If
            myConnection.Close()
        Catch ex As Exception
            MsgBox(ex.ToString)
        End Try
    End Sub

    Private Sub OkayBtn_Click(sender As System.Object, e As System.EventArgs) Handles OkayBtn.Click
        AccessAccountDatabase()
    End Sub
End Class 
```

所以现在我的问题是......你如何得到它来检查数据库中是否存在记录，因为当你输入正确的信息（数据库中存在的正确用户名和密码）时，它会说欢迎和所有。但是，当您输入错误的用户名和/或密码时，它就不起作用了。如果没有“Try Catch”语句，程序就会冻结。通过 try catch 它说明了这一点：

```
System.InvalidOperationException: No data exists for the row/column.
   at System.Data.OleDb.OleDbDataReader.DoValueCheck(Int32 ordinal)
   at System.Data.OleDb.OleDbDataReader.GetValue(Int32 ordinal)
   at System.Data.OleDb.OleDbDataReader.get_Item(String name)
   at CybSol_Journal_Database.LoginForm1.AccessAccountDatabase() in c:\users\richard\documents\visual studio 2010\Projects\CybSol Journal Database\CybSol Journal Database\LoginForm1.vb:line 36 
```

添加信息：第36行是这样的：`If UsernameTxt.Text = dr("Username").ToString AndAlso PasswordTxt.Text = dr("Password").ToString Then`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T20:02:50.127

第一个问题：

[PASSWORD 是 Access 中的保留关键字](http://support.microsoft.com/kb/321266)。您应该封装在方括号中：

```
"SELECT * FROM Accounts WHERE Username='" & UsernameTxt.Text & _
"' AND [Password]='" & PasswordTxt.Text & "'" 
```

第二个问题：

切勿使用字符串连接来创建 sql 文本。总是使用参数

```
 str = "SELECT * FROM Accounts WHERE Username=? AND [Password]=?"   
 Dim cmd As OleDbCommand = New OleDbCommand(str, myConnection)   
 cmd.Parameters.AddWithValue("user", UserNameTxt.Text)
 cmd.Parameters.AddWithValue("pass", PasswordTxt.Text)
 dr = cmd.ExecuteReader 
```

为什么？[看看这里](http://xkcd.com/327/)如果你连接来自用户输入的字符串会发生什么

第三个问题：测试你的命令是否返回行

```
 If dr.Read() Then
    ......

 End if 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:03:50.830

我添加了一些`Using`语句，因此您不必手动关闭连接。另外，我将 SQL 语句参数化以防止 SQL 注入。

```
 Public Class LoginForm1
      Dim provider As String
      Dim dataFile As String
      Dim connString As String
      'Public myConnection As OleDbConnection = New OleDbConnection
      'Public dr As OleDbDataReader
      Dim Errors As String
      Public Sub AccessAccountDatabase()
        provider = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source ="
        dataFile = "C:\Users\Richard\Documents\Visual Studio 2010\Projects\CybSol Journal Database\CybSol Journal Database\cgi-bin\Data.mdb"
        connString = provider & dataFile
        myConnection.ConnectionString = connString
        Errors = ""
        Try
          Using myConnection As OleDbConnection = New OleDbConnection(connString)
            myConnection.Open()
            Dim str As String
            str = "SELECT * FROM Accounts WHERE Username=@USER AND [Password]=@PWD "
            Using cmd As OleDbCommand = New OleDbCommand(str, myConnection)
              cmd.Parameters.AddWithValue("@USER", UsernameTxt.Text)
              cmd.Parameters.AddWithValue("@PWD", PasswordTxt.Text)
              Using dr As OleDbDataReader = cmd.ExecuteReader
                If dr.HasRows Then
                  dr.Read()
                  If UsernameTxt.Text = dr("Username").ToString AndAlso PasswordTxt.Text = dr("Password").ToString Then
                    Dim Welcome As String = "SELECT * FROM Accounts WHERE Real_Name=" & "Username"
                    MsgBox("Welcome back " & dr("Real_Name") & "!")
                  Else
                    MsgBox("Login Failure")
                  End If
                Else
                  MsgBox("Login Failure")
                End If
              End Using
            End Using
          End Using
        Catch ex As Exception
          MsgBox(ex.ToString)
        End Try

      End Sub

      Private Sub OkayBtn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OkayBtn.Click
        AccessAccountDatabase()
      End Sub
    End Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:03:17.627

你在正确的轨道上。返回一个布尔值，`OleDbDataReader.Read`指示它是否成功读取现有行。`True`因此，您可以在尝试读取记录之前检查它是否返回。例如：

```
If dr.Read() Then
    If UsernameTxt.Text = dr("Username").ToString AndAlso PasswordTxt.Text = dr("Password").ToString Then
    Dim Welcome As String = "SELECT * FROM Accounts WHERE Real_Name=" & "Username"
        MsgBox("Welcome back " & dr("Real_Name") & "!")
    Else
        MsgBox("Login Failure")
    End If
End If 
```

另外，我觉得我至少应该提一下，以纯文本形式存储密码绝不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:59:53.077

您不必再次检查代码中的用户名和密码，因为如果在数据库中不匹配，则不会返回任何行。

你可以简单地做

```
dr = cmd.ExecuteReader
If dr.HasRows Then
   //it matched
Else
   //it didn't match. could not log in
End If 
```

如果您仍想保留它，您的方法如下，但没有必要

```
dr = cmd.ExecuteReader
If dr.HasRows Then

    dr.Read()

    If UsernameTxt.Text = dr("Username").ToString AndAlso PasswordTxt.Text = dr("Password").ToString Then

    Else

    End If

End If 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-21T01:28:59.900

在 DataReader 上使用 Read() 方法（请注意，这会使您与数据库的连接保持打开状态，并且当 DataReader 仍在读取时，您将无法在数据库上执行任何其他命令。

```
If String.Compare(dr("Username").ToString(), UsernameTxt.Text, true) AndAlso String.Compare(dr("Password").ToString(), PasswordTxt.Text.ToString() Then
    ' The username and password for the record match
    ' the input from the login form
    ProcessLogin()
Else
    ' Invalid username or password, send an error
End If 
```

# php - 继承在 PHP 中不起作用

> ID：11511496
> 
> 赞同：0
> 
> 时间：2012-07-16T19:48:01.507
> 
> 标签：php, class, inheritance, abstract

我有这个结构：

```
abstract class Android {
    public function __construct() {

    }

    public abstract function cost();

    public function get_model(){
        return "unkown model";
    }
}

class HTC extends Android {

    public function __construct() {
        parent::__construct();
        $this->model= "HTC";
    }

    public function get_model() {
        return $this->model;
    }

    public function cost() {
        return 500;
    }
}

abstract class FeaturesDecorator extends Android {
    public function __construct() {
        parent::__construct();
    }

    public abstract function get_description();
}

class VideoCamera extends FeaturesDecorator {
    private $android;

    public function __construct($android) {
        parent::__construct();
        $this->android=$android;
    }

    public function get_description() {
         return $this->android->get_model()." plus a video camera, ";
    }

    public function cost() {
        return 200 + $this->android->cost();
    }
}

class BigScreenSize extends FeaturesDecorator {
    private $android;

    public function __construct($android) {
        parent::__construct();
        $this->android=$android;
    }

    public function get_description() {
        return $this->android->get_model()." plus a big size screen, ";  
    }

    public function cost() {
        return 100 + $this->android->cost();
    }
} 
```

应用以下模式后：

```
$android2 = new HTC();
$android2 = new BigScreenSize($android2);
$android2 = new LongLastingBattery($android2);

echo "<br/><br/>You have bought ".$android2->get_description()." for $".$android2->cost(); 
```

我明白了

> 您以 650 美元的价格购买了 Unkown 品牌和长效电池

**再次：**

我想知道为什么我得到`Unknown brand`而不是`HTC`from`get_model()`调用`get_description()`，**而`$650`被正确计算**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:42:22.497

When i first tested your code, php told me that the class `LongLastingBattery` does not exist, which is correct - it doesn't. I assume you meant `VideoCamera`; so your main function in my answer will begin with this:

```
$android2 = new HTC();
$android2 = new BigScreenSize($android2);
$android2 = new VideoCamera($android2); 
```

Your problem is that you are simply confusing the two methods `get_description()` and `get_model()`: You first call get_description() on the VideoCamera instance. There you have $this->android->get_model() where $this->android is an instance of BigScreenSize. The class BigScreenSize does not override the method get_model(). BigScreenSize extends FeaturesDecorator, that does not override this method either but extends Android, that has this method and returns `"unknown model"`.

To overcome this problem you could change `$this->android->get_model()` into `$this->android->get_description()` in both VideoCamera and BigScreenSize and rename the get_model() method in both Android and HTC into get_description(). Finally, you have to change FeaturesDecorator into this:

```
abstract class FeaturesDecorator extends Android {} 
```

Then you'll get this:

```
<br/><br/>You have bought HTC plus a big size screen,  plus a video camera,  for $800 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T20:00:03.620

你的`FeatureDecorator`继承自`Android`，而不是`HTC`。所以第一次添加装饰时，`$android2`将是 type`Android`而不是之前的`HTC`.

也许你的意思是：

```
abstract class FeaturesDecorator extends HTC {
  // ...
} 
```

这应该为您的示例提供正确的输出。

* * *

**编辑**你可以将你的`model`成员变量移动到`Android`类；也应该工作：

```
abstract class Android {
  protected $model = "unknown model";

  public function get_model() {
    return $this->model;
  }
} 
```

这种方式`model`直接存储在 中`Android`，可以从所有子类中设置，并且可以从任何其他持有 `Android`对象引用的类中检索。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T23:22:32.087

```
$android1=new HTC();
$android2=new BigScreenSize($android1);
$android3=new VideoCamera($android2); 
```

在 $android2 和 3 上执行 var_dump 将为您提供它们持有的对象（必须更改为摄像机，因为您提供的代码中不存在电池类）并且 android3 持有 bigscreensize 对象而不是 htc，因此是“未知”。如果你想获得你的结果（'HTC'），你必须（首先让 $android 公开而不是私有）和

```
echo $android3->android->get_description(); 
```

或根据您的示例（仍然在您的课程中公开 $android）

```
echo $android2->android->get_description(); 
```

应用这些更改给了我：

> 您以 800 美元的价格购买了 HTC 和大尺寸屏幕

最后，我仍然坚持我最初的想法，即你应该修改你所采取的方法。也许添加一个方法，从它的父级获取 $model 并在构造函数中使用它。这样您就可以跟踪模型并使用本地属性。（在我上面的示例中，摄像机在执行 get_description() 时尝试访问 bigscreensize->get_model()，此方法在 bigscreensize 中不存在，但在作为 bigscreensize 父级的父级的 android 中存在。继承在这里工作得很好。请注意，您的装饰器不知道 htc 类的存在，因此除非您为所有装饰器提供访问/传递“模型”变量的方法。通过第一个装饰器，您将无法访问它。cost() 有效，因为它存在在每个班级。

我应该在昨晚回答之前阅读这个问题。对不起。

# python - 使用 Windows API 获取窗口的名称

> ID：11511497
> 
> 赞同：0
> 
> 时间：2012-07-16T19:48:01.250
> 
> 标签：python, winapi

我是 python 新手，我正在尝试编写一个脚本，当某个窗口关闭时退出循环。我在让代码正常工作时遇到问题，它甚至不会进入循环。我认为这是因为我没有正确获取窗口名称。我想知道是否有任何关于 Win32Gui 扩展的好的教程可以帮助我理解它是如何工作的。

编辑

这就是我所拥有的，它正在做它应该做的事情，但我相信有一种更简单的方法可以做到这一点。

```
def answerCalls(local, network):
t = 0
count = 0
while t == 0:
    time.sleep(1)
    if win32gui.GetWindowText(win32gui.GetForegroundWindow()) == "Incoming Call":
        time.sleep(10)   
        getApplicationPos("Incoming Call")
        clickOnElement(******.IncomingCall_AnswerButton())
        time.sleep(10)
        if win32gui.GetWindowText(win32gui.GetForegroundWindow()) == "Video Call":
            count += 1
            writeFile("Answering Calls", count, local)
            uploadToServer(local, network) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:00:25.360

以下示例 (Python 3) 获取所有窗口的标题列表：

```
import win32gui

def enum_window_titles():
    def callback(handle, data):
        titles.append(win32gui.GetWindowText(handle))

    titles = []
    win32gui.EnumWindows(callback, None)
    return titles

titles = enum_window_titles() 
```

# excel - 在 Excel VBA 中创建进度条

> ID：11511500
> 
> 赞同：0
> 
> 时间：2012-07-16T19:48:08.583
> 
> 标签：excel, vba

我找到了一个 Excel VBA 脚本和“教程”，但它并没有真正破坏代码，而是将条形码分成单独的部分。

[http://spreadsheetpage.com/index.php/tip/displaying_a_progress_indicator/](http://spreadsheetpage.com/index.php/tip/displaying_a_progress_indicator/)

当进度条穿过时，附加到“演示”的脚本将随机数添加到 Excel 工作表中。

工作表上的这段代码没有做的是将部分分解，所以说'这是随机数的代码，'这是实际进度条的代码。

有人可以剖析这段代码，让它对那些不会说 VBAeese 的人以及那些似乎写过它的人更“用户友好”吗？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:56:41.837

这是为您提供的代码的大量注释版本：

```
Sub Main()
'   Inserts random numbers on the active worksheet
    Dim Counter As Integer
    Dim RowMax As Integer, ColMax As Integer
    Dim r As Integer, c As Integer
    Dim PctDone As Single

    If TypeName(ActiveSheet) <> "Worksheet" Then Exit Sub
    '- if this subroutine is ran on a sheet that is not called "Worksheet" then exit
    '-- change 'Worksheet' to whatever sheet you want the progress bar on

    Cells.Clear
    '- clear all cells in active worksheet

    Application.ScreenUpdating = False
    '-disables updating the screen in the for loop that follows
    '- that way if we are editing 1000 cells int he workbook it only needs to update them at the end when
    '- this is set back to true

    Counter = 1 '- counter counts what cell we are on
    RowMax = 100 '- this is how many rows will be filled with data
    ColMax = 25 '- this is how many columns will be filled with data

    '- note that Rowmax * ColMax = 2,500 co counter will go from 1 to 2,500

    For r = 1 To RowMax
        '-for each row 1 to 100 we will loop through the 25 columns to add the random number
        For c = 1 To ColMax
            '- enter a random number into the cell we are on (Cells(r,c))
            Cells(r, c) = Int(Rnd * 1000)
            '- +1 to the coutner so we can count which cell we ar eon out of 2,500
            Counter = Counter + 1
        Next c
        '- after finishing each column but before starting the next row
        '- check what percent done we are (to update the userform)
        PctDone = Counter / (RowMax * ColMax)

        '- Edit the progressbar called "UserForm1" (already exists in workbook)
        With UserForm1
            'Userform has 2 items in it a Label called 'FrameProgress' and a onject called 'LabelProgress'
            'Change the text in the Label called 'FrameProgress' to display the percent done we calculated earlier
            .FrameProgress.Caption = Format(PctDone, "0%")
            ' Resize the object called 'LabelProgress' to be X perxent of the width of the previous label (minus 10 to leave room on the edge)
            ' - where X is the percent we are done
            .LabelProgress.Width = PctDone * (.FrameProgress.Width - 10)
        End With
'       The DoEvents statement is responsible for the form updating
        DoEvents
    Next r
    '- exit form when it is at 100%
    Unload UserForm1
End Sub 
```

the only parts of the code that are useful to you are to note that while it is looping it is figuring out what percent it is done, then using that to update the form.

If you had a lot of code you could simply put the follwoing throughout it (assuming you build the form)

```
Sub Example()
    'wait a few seconds
    Application.Wait (100000)
    'your code goes here instead of .wait

    PctDone = 0.3
    With UserForm1
        'Userform has 2 items in it a Label called 'FrameProgress' and a onject called 'LabelProgress'
        'Change the text in the Label called 'FrameProgress' to display the percent done we calculated earlier
        .FrameProgress.Caption = Format(PctDone, "0%")
        ' Resize the object called 'LabelProgress' to be X perxent of the width of the previous label (minus 10 to leave room on the edge)
        ' - where X is the percent we are done
        .LabelProgress.Width = PctDone * (.FrameProgress.Width - 10)
    End With
    'The DoEvents statement is responsible for the form updating
    DoEvents

    Application.Wait (100000)
    'your code goes here instead of .wait

    PctDone = 0.6
    With UserForm1
        .FrameProgress.Caption = Format(PctDone, "0%")
        .LabelProgress.Width = PctDone * (.FrameProgress.Width - 10)
    End With
    DoEvents

    Application.Wait (100000)
    'your code goes here instead of .wait

    PctDone = 0.9
    With UserForm1
        .FrameProgress.Caption = Format(PctDone, "0%")
        .LabelProgress.Width = PctDone * (.FrameProgress.Width - 10)
    End With
    DoEvents

    Application.Wait (100000)
    'your code goes here instead of .wait

End Sub 
```

# jquery - 只显示 1 ，显示更多 onClick？

> ID：11511502
> 
> 赞同：2
> 
> 时间：2012-07-16T19:48:12.300
> 
> 标签：jquery

这是 id 喜欢做的事情。我有一张有一堆行的桌子。我只想显示第一个 1，其余的将使用`display:none`. 将有一个链接，当点击时，将删除`display:none`一个额外的行。这是我到目前为止得到的[http://jsfiddle.net/dBdV7/](http://jsfiddle.net/dBdV7/)。

问题：

1.  首先，它说 loadmore 没有定义..为什么？
2.  一旦显示所有行，我如何让加载更多链接消失？
3.  我不确定这是否`slice`会正常工作，但我试图做的是将所选儿童限制为一个。
4.  最后，我手动添加了`hide_row`类，jquery如何自动将它添加到表onload的所有子表中，除了第一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:53:24.100

试试这个，你可以使用`:not`和`:first`选择器：

```
$('tr:not(:first)').addClass('hide_row') // adds the class to all tr elements except the first one 
```

[演示](http://jsfiddle.net/dBdV7/23/)

```
$('a').click(function(e){
   e.preventDefault()
   $('.hide_row:hidden:first').removeClass('hide_row');
}) 
```

[演示](http://jsfiddle.net/dBdV7/13/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:59:19.667

这是一个简单的解决方案 -

鉴于此标记 -

```
​&lt;table>
  <tr><td>1</td></tr>
  <tr class="hide"><td>2</td></tr>
  <tr class="hide"><td>3</td></tr>
  <tr class="hide"><td>4</td></tr>
  <tr class="hide"><td>5</td></tr>
  <tr class="hide"><td>6</td></tr>
</table>​​​​​​​​​​ 
```

该类`hide`只是有一个定义`{ display : none; }`

这行 jQuery 每次都会显示另一行。

```
$('table tr').not(':visible').filter(':eq(0)').show(); 
```

我将逐个选择器进行选择器，每个级别都指定一个定义，直到我们找到我们正在寻找的元素。

*   `$('table tr')`- 这些是所有表格行
*   `.not(':visible')`- 这些都是“隐藏”行
*   `.filter(':eq(0)')`- 这是第一个结果
*   `.show()`- 显示行

[小提琴 1](http://jsfiddle.net/VEavW/1/)

* * *

这当然可以进一步最小化为 -

`$('table tr:not(:visible):first').show();`

[小提琴 2](http://jsfiddle.net/VEavW/)

这将达到相同的结果 - 但 IMO 有时最好更冗长，以便您的代码变得更具可读性......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T19:59:58.963

```
<script>
var current=2;
function loadmore() {
    $('.main_table tr:nth-child('+current+')').show();
    current++;
}
</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T20:00:58.533

**编辑：**

要加载多个`tr`（两个乘两个或更多...），请在答案下方的我的评论中找到演示。

## *[jsFiddle 演示](http://jsfiddle.net/roXon/dBdV7/29/)*

感谢@Lix 的评论：**添加/查看**下一行 - 而不仅仅是使用这个 jQuery：

```
var curr = 0;
var rowN = $('.main_table tr').length;

$('.main_table tr').eq(curr).siblings().hide();  // no need for CSS

$('a.load_more').on('click',function(e){
    e.preventDefault();   
    $('.main_table tr').eq(++curr).show();
}); 
```

* * *

**前：**

## *[jsFiddle 演示](http://jsfiddle.net/roXon/dBdV7/25/)*

我创建了一个不错的脚本，可以让你循环！
这意味着**，如果您在某个时候到达最后一个`tr`，它将带您回到第一个！**

HTML：

```
<table class="main_table">
    <tr><td>Row 1</td></tr>
    <tr><td>Row 2</td></tr>
    <tr><td>.....</td></tr>
</table>

<a class="load_more" href="#">Click to load another row</a> 
```

jQuery：

```
var curr = 0;                     // set desired starting one (zero based)!
var rowN = $('.main_table tr').length;

$('.main_table tr').eq(curr).siblings().hide(); // hide all but current one

$('a.load_more').on('click',function(e){
    e.preventDefault(); // prevent default anchor behavior

    ++curr;
    if(curr===rowN){curr=0;} // reset to 0 at some point

    $('.main_table tr').eq(curr).show().siblings().hide();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T19:54:12.917

首先，您正在定义 loadmore 函数，`jQuery(function () { ... });`这意味着它对 onClick 事件不可见。我建议使用以下代码，而不是在 HTML 中使用 onClick 事件：

```
$('a').click(function() {
  e.preventDefault();
  $('.main_table').find(".hide_row").slice(0,1).removeClass('hide_row');
}); 
```

如果要添加该功能，使用切片而不是`first`选择器可以一次显示多行。否则，我会使用`first`选择器，因为它可以让其他人清楚您要完成的工作。

# android - 如何在 onLayout 期间调整 Android UI 元素的大小？

> ID：11511503
> 
> 赞同：2
> 
> 时间：2012-07-16T19:48:13.303
> 
> 标签：android, layout, view, measure

我有一个基于 a 的按钮类`LinearLayout`，其中包含两个`TextView`s，并且我希望按钮始终是方形的（我正在使用`onMeasure()`），并且`TextView`s 的上部自动调整大小以适应按钮。我希望下部`TextView`有固定大小的文本，所以它看起来大致像

```
|---------|
|         |
|  1 8 0  |
|         |
|   foo   |
|---------| 
```

“180”在可用空间中尽可能大。

我正在调用一个`onLayout()`函数`adjustTextSize()`：

```
private void adjustTextSize() {

    float height = mHeight - mTitleView.getMeasuredHeight() - 4 * mPadding - getPaddingTop() - getPaddingBottom(); //title text view

    int numberheight = (int) (height * 0.75);
    int extravertpadding = 0;//(int) (height * 0.125);

    mTitleView.setPadding(mPadding, 0, mPadding, mPadding);

    mNumberView.setTextSize(TypedValue.COMPLEX_UNIT_PX, numberheight);
    mNumberView.setPadding(mPadding, mPadding + extravertpadding, mPadding, mPadding + extravertpadding);

    if(mNumberView.getMeasuredWidth() > mWidth) {
        float reduction = mWidth / mNumberView.getMeasuredWidth();
        extravertpadding = (int) ((numberheight - height*reduction) / 2);
        numberheight = (int) (height*reduction);
        mNumberView.setTextSize(TypedValue.COMPLEX_UNIT_PX, numberheight);
        mNumberView.setPadding(mPadding, mPadding + extravertpadding, mPadding, mPadding + extravertpadding);
    }

    mNumberView.setTextSize(TypedValue.COMPLEX_UNIT_PX, numberheight);
    mNumberView.setPadding(mPadding, mPadding + extravertpadding, mPadding, mPadding + extravertpadding);

} 
```

`mWidth`并`mHeight`设置在`onLayout()`.

但是，我有两个初始问题：首先，将文本大小设置为某个像素值会使该像素值`View`略大于*像素*值。我想计算出将文本高度设置为多大以适合可用空间；四分之三似乎可以，但我宁愿有一个确切的值。

第二个问题是，`getMeasuredWidth()`在我更改了文本大小之后， 的值似乎没有改变。为什么不？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:51:31.913

对第 2 部分的回答：

有必要打电话

```
mNumberView.measure(
    MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED),
    MeasureSpec.makeMeasureSpec(0, MeasureSpec.UNSPECIFIED)
); 
```

告诉系统测量视图，就好像它的大小没有限制一样。调用此方法后，您可以了解*如果*空间不是对象时视图的大小，并相应地缩小视图。

# user-interface - 如何在 Qt Creator 中设置选项卡小部件的背景颜色？

> ID：11511504
> 
> 赞同：6
> 
> 时间：2012-07-16T19:48:16.553
> 
> 标签：user-interface, qt4, qt-designer

我正在使用 Qt Creator。在我的 GUI 中，我使用了一个选项卡小部件。此小部件应具有与主窗口相同的灰色背景色（图片 A）。我通过在 Qt Designer 中编辑样式表来完成此操作：

```
background-colour: rgb(240, 240, 240); 
```

但是现在我有两个无法解决的新问题：

*   按钮（--> 发送）不再四舍五入。
*   编辑框的背景颜色也变为灰色。

在我更改样式表之前，GUI 看起来像图片 B 中的样子。

我也试过

```
QPalette pal = m_pUi->tabWidget->palette();
pal.setColor(m_pUi->tabWidget->backgroundRole(), Qt::blue);
m_pUi->tabWidget->setPalette(pal); 
```

但这只会改变选项卡后面的颜色，而不是整个“选项卡窗口表面”的整个颜色。

我是否必须进行额外的样式描述，还是有更简单的解决方案？

![图片 A - 带样式表](../Images/c55eb6e2d64f03da8616c587aa5ab88a.png)

图片 A - 带样式表

![图片 B - 没有样式表](../Images/f0734d9feb9728e249c9786e10e0eb7c.png)

图片 B - 没有样式表

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-09-29T22:08:30.003

我遇到了同样的问题，我发现您需要将此属性设置为每个选项卡：

```
ui->tab->setAutoFillBackground(true); 
```

我不确定，但我认为也有必要将该属性设置`QTabWidget`为。

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T11:34:15.137

您要访问的“事物”称为 QTabBars。记住这一点，您可以编写如下样式表：

```
QTabBar::tab 
{
    background: #48555E;
    color: white;   
    border-color: #48555E;
}

QTabBar::tab:selected, 
QTabBar::tab:hover 
{
    border-top-color: #1D2A32;
    border-color: #40494E;
    color: black;
    background: qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1, stop: 0 #C1D8E8, stop: 1 #F0F5F8); 
} 
```

此外，您可能会发现[这个问题](https://stackoverflow.com/questions/2480773/qt-styling-qtabwidget)和这个[官方文档](http://doc.qt.digia.com/qt/stylesheet-examples.html#customizing-qtabwidget-and-qtabbar)很有见地。

# c++ - 如何分配返回的 auto_ptr？

> ID：11511508
> 
> 赞同：2
> 
> 时间：2012-07-16T19:48:44.370
> 
> 标签：c++, auto-ptr

我正在尝试学习 auto_ptr，所以我编写了下面的代码，但结果是

`..\src\main.cpp:23: error: no match for 'operator=' in 'p1 = source()()'`

我做错了什么？如何分配返回的 auto_ptr？

```
#include <stdio.h>
#include <memory>

using namespace std;

auto_ptr<int> source() {
    int *i = new int();
    *i = 100;
    return auto_ptr<int>(i);
}

int main() {
    std::auto_ptr<int> p1, p2;

    p1 = p2;
    p1 = source();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:55:51.730

你不能。

`auto_ptr`是一个从根本上破碎的班级。您必须使用`unique_ptr`. 问题的核心是`auto_ptr`不能复制，但是C++03不涉及移动语义。实际上具有的语义`auto_ptr`是无用的破坏黑客。

# c++ - 使用 copy 和 back_inserter 将向量附加到自身时出现错误的结果

> ID：11511510
> 
> 赞同：11
> 
> 时间：2012-07-16T19:48:48.933
> 
> 标签：c++, stl, iterator, undefined-behavior, stl-algorithm

受[这个问题](https://stackoverflow.com/questions/11511115/under-the-hood-stl-concatenating-an-stdvector-to-itself-without-new-vector)的启发，询问如何将向量附加到自身，我的第一个想法是以下（是的，我现在意识到`insert`这是一个更好的选择）：

```
#include <algorithm>
#include <iostream>
#include <iterator>
#include <vector>

int main() {
    std::vector<int> vec {1, 2, 3};
    std::copy (std::begin (vec), std::end (vec), std::back_inserter (vec));

    for (const auto &v : vec)
        std::cout << v << ' ';
} 
```

但是，这会打印：

```
1 2 3 1 * 3 
```

每次运行程序时，* 都是不同的数字。只有 2 被替换的事实很奇特，如果真的有对此的解释，我很想听听。继续，如果我附加到不同的向量（原始的副本），它会正确输出。如果我在一行之前添加以下行，它也会正确输出`copy`：

```
vec.reserve (2 * vec.size()); 
```

我的印象`std::back_inserter`是一种将元素添加到容器末端的安全方法，尽管事先没有保留内存。如果我的理解是正确的，复制线有什么问题？

我认为这与编译器无关，但我使用的是 GCC 4.7.1。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-16T19:55:15.160

`std::back_inserter`创建一个将元素插入容器的插入迭代器。每次取消引用此迭代器时，它都会调用`push_back`容器将新元素附加到容器中。

对于`std::vector`容器，调用`push_back`where`v.size() == v.capacity()`将导致*重新分配*：创建一个新数组来存储向量的内容，将其当前内容复制到新数组中，并销毁旧数组。此时任何进入向量的迭代器都是*无效*的，这意味着它们不能再被使用。

在您的程序中，这包括由算法定义`begin(vec)`和`end(vec)`从中复制的输入范围。`copy`算法会继续使用这些迭代器，即使它们已失效，因此您的程序会表现出未定义的行为。

* * *

即使您的容器有足够的容量，它的行为仍然是未定义的：规范指出，在插入时，“如果没有发生重新分配，则插入点之前的所有迭代器和引用仍然有效”（C++11 §23.3.6.5 /1)。

调用`push_back`等同于在末尾插入，因此`std::end(vec)`您传入的结束迭代器 ( )`std::copy`在单次调用 后失效`push_back`。如果输入范围非空，则程序因此表现出未定义的行为。

* * *

`std::deque<int>`请注意，如果您使用 a或 a ，您的程序的行为将是明确定义的`std::list<int>`，因为当添加元素时，这些容器都不会使迭代器无效。

# php - 如何从 base64 数据 URI 保存 PNG 图像服务器端

> ID：11511511
> 
> 赞同：257
> 
> 时间：2012-07-16T19:48:49.477
> 
> 标签：php, javascript, base64, html5-canvas

我正在使用 Nihilogic 的“Canvas2Image”JavaScript 工具将画布绘图转换为 PNG 图像。我现在需要的是使用 PHP 将这个工具生成的那些 base64 字符串转换为服务器上的实际 PNG 文件。

简而言之，我目前正在做的是使用 Canvas2Image 在客户端生成一个文件，然后检索 base64 编码的数据并使用 AJAX 将其发送到服务器：

```
// Generate the image file
var image = Canvas2Image.saveAsPNG(canvas, true);   

image.id = "canvasimage";
canvas.parentNode.replaceChild(image, canvas);

var url = 'hidden.php',
data = $('#canvasimage').attr('src');

$.ajax({ 
    type: "POST", 
    url: url,
    dataType: 'text',
    data: {
        base64data : data
    }
}); 
```

此时，“hidden.php”收到一个数据块，看起来像***data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABE...***

从这一点开始，我几乎被难住了。根据我的阅读，我相信我应该使用 PHP 的*imagecreatefromstring*函数，但我不确定如何从 base64 编码的字符串实际创建一个实际的 PNG 图像并将其存储在我的服务器上。请帮忙！

* * *

## 回答 #1

> 赞同：504
> 
> 时间：2012-07-16T19:55:25.340

您需要从该字符串中提取 base64 图像数据，对其进行解码，然后将其保存到磁盘，您不需要 GD，因为它已经是 png。

```
$data = 'data:image/png;base64,AAAFBfj42Pj4';

list($type, $data) = explode(';', $data);
list(, $data)      = explode(',', $data);
$data = base64_decode($data);

file_put_contents('/tmp/image.png', $data); 
```

作为单线：

```
$data = base64_decode(preg_replace('#^data:image/\w+;base64,#i', '', $data)); 
```

提取、解码和检查错误的有效方法是：

```
if (preg_match('/^data:image\/(\w+);base64,/', $data, $type)) {
    $data = substr($data, strpos($data, ',') + 1);
    $type = strtolower($type[1]); // jpg, png, gif

    if (!in_array($type, [ 'jpg', 'jpeg', 'gif', 'png' ])) {
        throw new \Exception('invalid image type');
    }
    $data = str_replace( ' ', '+', $data );
    $data = base64_decode($data);

    if ($data === false) {
        throw new \Exception('base64_decode failed');
    }
} else {
    throw new \Exception('did not match data URI with image data');
}

file_put_contents("img.{$type}", $data); 
```

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2012-07-16T19:52:33.183

试试这个：

```
file_put_contents('img.png', base64_decode($base64string)); 
```

[file_put_contents 文档](http://php.net/manual/en/function.file-put-contents.php)

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2014-03-03T13:21:41.037

我必须用加号替换空格`str_replace(' ', '+', $img);`才能使其正常工作。

这是完整的代码

```
$img = $_POST['img']; // Your data 'data:image/png;base64,AAAFBfj42Pj4';
$img = str_replace('data:image/png;base64,', '', $img);
$img = str_replace(' ', '+', $img);
$data = base64_decode($img);
file_put_contents('/tmp/image.png', $data); 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2016-05-18T11:36:25.417

值得一提的是，讨论的主题记录在 RFC 2397 - “数据” URL 方案 ( [https://www.rfc-editor.org/rfc/rfc2397](https://www.rfc-editor.org/rfc/rfc2397) )

因此，PHP 有一种处理此类数据的本机方式 - “数据：流包装器”（[http://php.net/manual/en/wrappers.data.php](http://php.net/manual/en/wrappers.data.php)）

因此，您可以使用 PHP 流轻松操作数据：

```
$data = 'data:image/gif;base64,R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub//ge8WSLf/rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0CcguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7';

$source = fopen($data, 'r');
$destination = fopen('image.gif', 'w');

stream_copy_to_stream($source, $destination);

fclose($source);
fclose($destination); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-08-05T16:39:28.587

采用@dre010 的想法，我将其扩展为适用于任何图像类型的另一个函数：PNG、JPG、JPEG 或 GIF，并为文件名提供唯一名称

功能分离图像数据和图像类型

```
function base64ToImage($imageData){
    $data = 'data:image/png;base64,AAAFBfj42Pj4';
    list($type, $imageData) = explode(';', $imageData);
    list(,$extension) = explode('/',$type);
    list(,$imageData)      = explode(',', $imageData);
    $fileName = uniqid().'.'.$extension;
    $imageData = base64_decode($imageData);
    file_put_contents($fileName, $imageData);
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-01-18T22:18:40.637

那么您上面的解决方案取决于图像是 jpeg 文件。对于我使用的一般解决方案

```
$img = $_POST['image'];
$img = substr(explode(";",$img)[1], 7);
file_put_contents('img.png', base64_decode($img)); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-08-22T03:49:07.727

总的担忧：

```
$data = 'data:image/png;base64,AAAFBfj42Pj4';

// Extract base64 file for standard data
$fileBin = file_get_contents($data);
$mimeType = mime_content_type($data);

// Check allowed mime type
if ('image/png'==$mimeType) {
    file_put_contents('name.png', $fileBin);
} 
```

> [http://php.net/manual/en/wrappers.data.php](http://php.net/manual/en/wrappers.data.php)
> 
> [http://php.net/manual/en/function.mime-content-type.php](http://php.net/manual/en/function.mime-content-type.php)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-01-14T17:11:36.570

单线性解。

```
$base64string = 'data:image/png;base64,R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub//ge8WSLf/rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0CcguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7';
file_put_contents('img.png', base64_decode(explode(',',$base64string)[1])); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-01-17T10:56:14.627

此代码适用于我检查以下代码：

```
<?php
define('UPLOAD_DIR', 'images/');
$image_parts = explode(";base64,", $_POST['image']);
$image_type_aux = explode("image/", $image_parts[0]);
$image_type = $image_type_aux[1];
$image_base64 = base64_decode($image_parts[1]);
$file = UPLOAD_DIR . uniqid() . '.png';
file_put_contents($file, $image_base64);
?> 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-08-18T21:26:05.550

基于draw010示例，我制作了一个工作示例以便于理解。

```
imagesaver("data:image/jpeg;base64,/9j/4AAQSkZJ"); //use full base64 data 

function imagesaver($image_data){

    list($type, $data) = explode(';', $image_data); // exploding data for later checking and validating 

    if (preg_match('/^data:image\/(\w+);base64,/', $image_data, $type)) {
        $data = substr($data, strpos($data, ',') + 1);
        $type = strtolower($type[1]); // jpg, png, gif

        if (!in_array($type, [ 'jpg', 'jpeg', 'gif', 'png' ])) {
            throw new \Exception('invalid image type');
        }

        $data = base64_decode($data);

        if ($data === false) {
            throw new \Exception('base64_decode failed');
        }
    } else {
        throw new \Exception('did not match data URI with image data');
    }

    $fullname = time().$type;

    if(file_put_contents($fullname, $data)){
        $result = $fullname;
    }else{
        $result =  "error";
    }
    /* it will return image name if image is saved successfully 
    or it will return error on failing to save image. */
    return $result; 
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2014-09-23T07:18:14.473

试试这个...

```
$file = $_POST['file']; //your data in base64 'data:image/png....';
$img = str_replace('data:image/png;base64,', '', $file);
file_put_contents('img/imag.png', base64_decode($img)); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-04-14T16:08:57.517

PHP 已经公平对待**base64 -> 文件转换**

我用这种方式完成它：

```
$blob=$_POST['blob']; // base64 coming from an url, for example

//Now, let's save the image file:

file_put_contents('myfile.png',file_get_contents($blob)); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-12-09T11:09:25.550

假设您在 $filename 中有文件名，在 $testfile 我的 oneliner 中有 base64encoded 字符串：

```
file_put_contents($filename,base64_decode(explode(',', $testfile)[1]))
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-06-18T03:51:46.353

这个功能应该可以工作。这具有保存 base64 字符串的 photo 参数以及现有图像目录的路径，如果您已经拥有要在保存新图像时取消链接的现有图像。

```
 public function convertBase64ToImage($photo = null, $path = null) {
    if (!empty($photo)) {
        $photo = str_replace('data:image/png;base64,', '', $photo);
        $photo = str_replace(' ', '+', $photo);
        $photo = str_replace('data:image/jpeg;base64,', '', $photo);
        $photo = str_replace('data:image/gif;base64,', '', $photo);
        $entry = base64_decode($photo);
        $image = imagecreatefromstring($entry);

        $fileName = time() . ".jpeg";
        $directory = "uploads/customer/" . $fileName;

        header('Content-type:image/jpeg');

        if (!empty($path)) {
            if (file_exists($path)) {
                unlink($path);
            }
        }

        $saveImage = imagejpeg($image, $directory);

        imagedestroy($image);

        if ($saveImage) {
            return $fileName;
        } else {
            return false; // image not saved
        }
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-01-06T10:14:48.247

这很简单 ：

假设您正在尝试在 js 框架、ajax 请求或移动应用程序（客户端）中上传文件

1.  首先，您发送一个包含 base64 编码字符串的数据属性。
2.  在服务器端，您必须对其进行解码并将其保存在本地项目文件夹中。

***在这里如何使用 PHP***

```
<?php 

$base64String = "kfezyufgzefhzefjizjfzfzefzefhuze"; // I put a static base64 string, you can implement you special code to retrieve the data received via the request.

$filePath = "/MyProject/public/uploads/img/test.png";

file_put_contents($filePath, base64_decode($base64String));

?> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-03-22T19:36:12.380

如果您想随机重命名图像，并将数据库上的图像路径存储为 blob 并将图像本身存储在文件夹中，此解决方案将为您提供帮助。您的网站用户可以存储任意数量的图像，而出于安全目的，图像将被随机重命名。

# php代码

生成随机 varchars 以用作图像名称。

```
function genhash($strlen) {
        $h_len = $len;
        $cstrong = TRUE;
        $sslkey = openssl_random_pseudo_bytes($h_len, $cstrong);
        return bin2hex($sslkey);
}
$randName = genhash(3); 
#You can increase or decrease length of the image name (1, 2, 3 or more). 
```

从 image 获取图像数据扩展名和 base_64 部分（data:image/png;base64, 之后的部分）。

```
$pos  = strpos($base64_img, ';');
$imgExten = explode('/', substr($base64_img, 0, $pos))[1];
$extens = ['jpg', 'jpe', 'jpeg', 'jfif', 'png', 'bmp', 'dib', 'gif' ];

if(in_array($imgExten, $extens)) {

   $imgNewName = $randName. '.' . $imgExten;
   $filepath = "resources/images/govdoc/".$imgNewName;
   $fileP = fopen($filepath, 'wb');
   $imgCont = explode(',', $base64_img);
   fwrite($fileP, base64_decode($imgCont[1]));
   fclose($fileP);

}

# => $filepath <= This path will be stored as blob type in database.
# base64_decoded images will be written in folder too.

# Please don't forget to up vote if you like my solution. :) 
```

# .net - 通过 NANT 的 Xsl 转换过程不会更新所有请求的 xpath

> ID：11511514
> 
> 赞同：0
> 
> 时间：2012-07-16T19:49:08.793
> 
> 标签：.net, msbuild, nant, xslcompiledtransform

这对我来说很难解释，但我会尽力而为。添加评论以澄清/补充我可能遗漏的任何内容。

背景资料：

*   执行 msbuild 的 NANT（构建过程）版本 0.85.2478.0
*   CruiseControl.NET
*   Windows Server 2008 R2 64 位
*   .NET 框架 3.5

我正在尝试更新/修改 Web 应用程序的 web.config 中的一些设置。我们使用 NANT 代码运行通过 CruiseControl.NET 执行的构建过程。我们正在通过 XslCompiledTransform 并使用样式表和设置文件来更新配置文件。

以下是“UpdateConfig.xslt”文件的样子：

```
<?xml version="1.0" encoding="UTF-8"?>
    <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">

      <!-- Set the file output mode -->
      <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes" />

      <!-- Get the parameters from the calling application -->
      <xsl:param name="defaultSettings" select="'C:\BuildServer\Configuration\ConfigFiles\Defaults.xml'" />
      <xsl:param name="buildTypeSettings" select="'NoFile'" />
      <xsl:param name="environmentSettings" select="'NoFile'" />
      <xsl:param name="projectSettings" select="'NoFile'" />
      <xsl:param name="mode" select="''"/>

      <!-- Load the various ConfigFileSettings XML files. -->
      <xsl:include href="GetSettings.xslt" />
      <xsl:variable name="fileset">
        <xsl:if test="$defaultSettings != 'NoFile'">
          <xsl:element name="File"><xsl:value-of select="$defaultSettings" /></xsl:element>
        </xsl:if>
        <xsl:if test="$buildTypeSettings != 'NoFile'">
          <xsl:element name="File"><xsl:value-of select="$buildTypeSettings" /></xsl:element>
        </xsl:if>
        <xsl:if test="$environmentSettings != 'NoFile'">
          <xsl:element name="File"><xsl:value-of select="$environmentSettings" /></xsl:element>
        </xsl:if>
        <xsl:if test="$projectSettings != 'NoFile'">
          <xsl:element name="File"><xsl:value-of select="$projectSettings" /></xsl:element>
        </xsl:if>
      </xsl:variable>
      <xsl:variable name="Settings">
        <xsl:call-template name="loadSettings">
          <xsl:with-param name="fileset" select="$fileset" />
        </xsl:call-template>
      </xsl:variable>

      <!-- Define the root node template to distinguish output types. -->
      <xsl:template match="/">
        <xsl:choose>
          <xsl:when test="$mode = 'display'">
            <xsl:call-template name="display" />
          </xsl:when>
          <xsl:otherwise>
            <xsl:copy>
              <xsl:apply-templates select="@*|node()" />
            </xsl:copy>
          </xsl:otherwise>
        </xsl:choose>
      </xsl:template>

      <!-- Define the default copy template. -->
      <xsl:template match="*|node()|comment()|processing-instruction()" priority="-100">
        <xsl:copy><xsl:apply-templates select="@*|node()" /></xsl:copy>
      </xsl:template>

      <!-- Skip certain comments. -->
      <xsl:template match="comment()[contains(., '=tuc0') and contains(., '&lt;publisher')]" />
      <xsl:template match="comment()[contains(., 'add key=&quot;')]" priority="10">
        <xsl:variable name="key" select="substring-before(substring-after(., 'add key=&quot;'), '&quot;')" />
        <xsl:if test="count(//add[@key=$key]) = 0"><xsl:copy /></xsl:if>
      </xsl:template>

      <!-- Look up attribute settings in the $Settings block for all attributes. -->
      <xsl:template match="@*">
        <xsl:choose>
          <xsl:when test="name() = '@key'"><xsl:copy /></xsl:when>
          <xsl:otherwise>

            <!-- First, build a full xpath to this key as it should appear in settings. -->
            <xsl:variable name="setting">
              <xsl:call-template name="getSetting">
                <xsl:with-param name="node" select="." />
              </xsl:call-template>
            </xsl:variable>

            <!-- Next, get the value from the config file if it's there. -->
            <xsl:variable name="value">
              <xsl:choose>
                <xsl:when test="count(msxsl:node-set($Settings)//setting[@xpath=$setting]) = 1">
                  <xsl:value-of select="msxsl:node-set($Settings)//setting[@xpath=$setting]/@value" />
                </xsl:when>
                <xsl:otherwise>
                  <xsl:value-of select="." />
                </xsl:otherwise>
              </xsl:choose>
            </xsl:variable>

            <!-- Finally, return the attribute with its new value -->
            <xsl:attribute name="{name()}"><xsl:value-of select="$value" /></xsl:attribute>
          </xsl:otherwise>
        </xsl:choose>
      </xsl:template>

      <!-- Handle SQL Connection Strings -->
      <xsl:template match="@*[(contains(translate(., 'ACDEGILNORSTU ', 'acdegilnorstu'), 'initialcatalog=')
                           or contains(translate(., 'ABDEST ', 'abdest'), 'database='))
                          and not(contains(translate(., 'PROVIDE ', 'provide'), 'provider='))]"
                priority="1">

        <!-- Normalize the connection string -->
    <xsl:variable name="lcString" select="translate(., 'ABCDEGILNORSTU ', 'abcdegilnorstu')" />

    <!-- Get the database from the string -->
    <xsl:variable name="dbname">
      <xsl:choose>
        <xsl:when test="contains($lcString, 'initialcatalog=')">
          <xsl:value-of select="substring-before(substring-after($lcString, 'initialcatalog='), ';')" />
        </xsl:when>
        <xsl:when test="contains($lcString, 'database=')">
          <xsl:value-of select="substring-before(substring-after($lcString, 'database='), ';')" />
        </xsl:when>
      </xsl:choose>
    </xsl:variable>
    <xsl:variable name="SqlDB" select="concat('Initial Catalog=', $dbname, ';')" />

    <!-- Get SQL Settings from $Settings. -->
    <xsl:variable name="SqlAuth">
      <xsl:choose>
        <xsl:when test="translate(msxsl:node-set($Settings)//SqlAuth, 'TRUE', 'true') = 'true'">
          <xsl:text>Trusted_Connection=YES;</xsl:text>
        </xsl:when>
        <xsl:otherwise><xsl:text>Trusted_Connection=NO;</xsl:text></xsl:otherwise>
      </xsl:choose>
    </xsl:variable>
    <xsl:variable name="SqlServer">
      <xsl:choose>
        <xsl:when test="count(msxsl:node-set($Settings)//SqlServer) > 0">
          <xsl:value-of select="concat('Data Source=', msxsl:node-set($Settings)//SqlServer, ';')" />
        </xsl:when>
        <xsl:otherwise>.</xsl:otherwise>
      </xsl:choose>
    </xsl:variable>
    <xsl:variable name="SqlUser">
      <xsl:if test="$SqlAuth = 'Trusted_Connection=NO;' and string-length(msxsl:node-set($Settings)//SqlUser) > 0">
        <xsl:value-of select="concat('user id=', msxsl:node-set($Settings)//SqlUser, ';')" />
      </xsl:if>
    </xsl:variable>
    <xsl:variable name="SqlPass">
      <xsl:if test="$SqlAuth = 'Trusted_Connection=NO;' and string-length(msxsl:node-set($Settings)//SqlPass) > 0">
        <xsl:value-of select="concat('password=', msxsl:node-set($Settings)//SqlPass, ';')" />
      </xsl:if>
    </xsl:variable>
    <xsl:variable name="SqlApp">
      <xsl:if test="string-length(msxsl:node-set($Settings)//SqlApp) > 0">
        <xsl:value-of select="concat('APP=', msxsl:node-set($Settings)//SqlApp, ';')" />
      </xsl:if>
    </xsl:variable>

        <xsl:attribute name="{name()}"><xsl:value-of select="concat($SqlServer,$SqlDB,$SqlAuth,$SqlUser,$SqlPass,$SqlApp)" /></xsl:attribute>
      </xsl:template>

      <xsl:template name="getSetting">
    <xsl:param name="node" />
    <xsl:param name="xpath" select="name($node)" />
    <xsl:param name="r" select="'1'" />

    <xsl:for-each select="$node"> <!-- Sets the node as current context -->
      <!-- Handle any special formatting for identifying settings -->
      <xsl:variable name="setting">
        <xsl:choose>
          <xsl:when test="name(..) = 'FTPLocation' and ../@name">
            <xsl:value-of select='concat("[@name=&apos;", ../@name, "&apos;]/@", $xpath)' />
          </xsl:when>
          <xsl:when test="name() = 'value' and name(..) = 'add' and ../@key">
            <xsl:value-of select='concat("[@key=&apos;", ../@key, "&apos;]/@", $xpath)' />
          </xsl:when>
          <xsl:when test="not(self::*)">
            <xsl:value-of select="concat('/', '@', $xpath)" />
          </xsl:when>
          <xsl:otherwise>
            <xsl:value-of select="concat('/', $xpath)" />
          </xsl:otherwise>
        </xsl:choose>
      </xsl:variable>

      <xsl:choose>
        <xsl:when test="name(..) = ''">
          <xsl:value-of select="$setting" />
        </xsl:when>
        <xsl:otherwise>
          <xsl:call-template name="getSetting">
            <xsl:with-param name="node" select=".." />
            <xsl:with-param name="xpath" select="concat(name(..), $setting)" />
            <xsl:with-param name="r" select="$r + 1" />
          </xsl:call-template>
        </xsl:otherwise>
      </xsl:choose>
    </xsl:for-each>
</xsl:template> 
```

这是我传递的设置文件的一部分，其中包含一些有效的值，以及一些无效的值：

```
<setting xpath="/configuration/General/Settings/add[@key='enableAddrValidationService']/@value" value="true" create="false" dynamic="false" />
<setting xpath="/configuration/General/Settings/add[@key='AddrValidationUrl']/@value" value="bogus" create="false" dynamic="false" />
<setting xpath="/configuration/system.serviceModel/client/endpoint[@name='ValidationServiceSoap']/@address" value="bogus" create="false" dynamic="false" />
<setting xpath="/configuration/applicationSettings/ARTS.Properties.Settings/setting[@name='addrValidationUser']/value" value="bogus" create="false" dynamic="false" /> 
```

问题：当我开始构建我们的 Web 应用程序时，它并没有更新我想要/指定的所有配置部分。

我已经用 XmlSpy、Notepad++ 和 XmlQuire 验证了所有的 xpath 表达式，所以我知道 100% 它们是正确的。

我唯一认为不正确的是它在样式表（UpdateConfig.xslt）中，但是这个构建过程不是我编写的，我很难阅读它。

如果有人对出了什么问题或如何更好地调试过程有任何想法，我很想听听他们的意见。

哦，不更新的部分是这个 xpath：

```
<setting xpath="/configuration/system.serviceModel/client/endpoint[@name='ValidationServiceSoap']/@address" value="bogus" create="false" dynamic="false" /> 
```

# emacs - Emacs 启动时的密码

> ID：11511521
> 
> 赞同：0
> 
> 时间：2012-07-16T19:49:45.693
> 
> 标签：emacs, emacs23, emacs24

我想知道在启动 Emacs 时是否有办法要求输入特定密码？我想我可以要求一个预定义的密码，我可以在我的 .emacs 文件中定义，但我不知道怎么做？我主要有兴趣在 x 或图形环境中执行此操作..

顺便说一句，我确实知道可以看到 .emacs 文件等等。但就我而言，这不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:23:31.887

我`epg`用来将加密数据保存在文件中。然后它只是作为普通的 emacs lisp 文件加载，就像在[我的 config](https://github.com/alexott/emacs-configs/blob/master/.emacs#L132)中一样。`EPG`将自动询问密码，您可以分析`load`函数的返回码来确定是否加载成功

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T22:40:58.760

如果我理解正确，那么您的情况是多个人在一台计算机上共享同一个帐户——也就是说，他们不仅会运行相同的`emacs`二进制文件，而且他们还有相同的主目录，Emacs 在其中搜索`.emacs`文件。

似乎您不仅想阻止其他人读取`.emacs`文件，而且实际上根本不希望他们能够运行`emacs`。

不幸的是，Emacs 可以启动，`-q`或者`-Q`在这种情况下`.emacs`根本不评估文件。因此，任何依赖于您的`.emacs`文件的“保护”都可以很容易地被规避。

如何限制对`emacs`二进制文件的访问呢？也许让它只对某个 Unix 组的成员可执行（如果多人共享同一个帐户，这当然是没有意义的），或者类似的东西。但请注意，这不会阻止他们安装自己的 Emacs 本地副本。

# android - 字节数组图像到位图

> ID：11511522
> 
> 赞同：1
> 
> 时间：2012-07-16T19:49:46.460
> 
> 标签：android, bitmap, bytearray

我正在尝试将字节数组图像转换为位图，但转换后它给了我黑色图像，为什么？

```
// Camera arg conversion to Bitmap
                Bitmap cameraBitmap = BitmapFactory.decodeByteArray(arg0, 0,
                        arg0.length);
                 Bitmap background = Bitmap.createBitmap(cameraBitmap.getWidth(),
                 cameraBitmap.getHeight(), Bitmap.Config.ARGB_8888); 
```

我希望将相机图像转换为位图。任何建议。提前致谢！！

```
07-17 02:22:18.149: E/AndroidRuntime(398): FATAL EXCEPTION: main
07-17 02:22:18.149: E/AndroidRuntime(398): java.lang.IllegalArgumentException: only support ImageFormat.NV21 and ImageFormat.YUY2 for now
07-17 02:22:18.149: E/AndroidRuntime(398):  at android.graphics.YuvImage.<init>(YuvImage.java:82)
07-17 02:22:18.149: E/AndroidRuntime(398):  at com.exercise.AndroidCamera.AndroidCamera$4.onPictureTaken(AndroidCamera.java:225)
07-17 02:22:18.149: E/AndroidRuntime(398):  at android.hardware.Camera$EventHandler.handleMessage(Camera.java:320)
07-17 02:22:18.149: E/AndroidRuntime(398):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-17 02:22:18.149: E/AndroidRuntime(398):  at android.os.Looper.loop(Looper.java:123)
07-17 02:22:18.149: E/AndroidRuntime(398):  at android.app.ActivityThread.main(ActivityThread.java:4627)
07-17 02:22:18.149: E/AndroidRuntime(398):  at java.lang.reflect.Method.invokeNative(Native Method)
07-17 02:22:18.149: E/AndroidRuntime(398):  at java.lang.reflect.Method.invoke(Method.java:521)
07-17 02:22:18.149: E/AndroidRuntime(398):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-17 02:22:18.149: E/AndroidRuntime(398):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-17 02:22:18.149: E/AndroidRuntime(398):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:56:15.503

不幸的是，相机的图像格式不是 ARGB_8888。很可能它是 YUV420p 之类的东西，甚至可能是 JPEG 压缩数据。

首先，确定你的情况。

您有两个选择：对于 YUV（这是一种交错格式），使用一些转换格式，对于 JPEG，为您的 arg0 数组创建一个内存流并从中读取位图。

这里有类似的问题：[BitmapFactory null issue in android](https://stackoverflow.com/questions/8364933/bitmapfactory-null-issue-in-android)

这里甚至还有一个解决方案：[Android byte[] to image in Camera.onPreviewFrame](https://stackoverflow.com/questions/5212531/android-byte-to-image-in-camera-onpreviewframe)

编辑：您只需要稍微修改数组中的字节即可。

This [wiki article](http://en.wikipedia.org/wiki/YUV) explains how to convert the YUV422/420 to YUY2, required by the Android API. Search for the "Y'UV422 can also be expressed in YUY2 FourCC format code" substring there.

# c# - 重现异常：指定的参数超出了有效值的范围。参数名称：索引

> ID：11511524
> 
> 赞同：0
> 
> 时间：2012-07-16T19:49:54.493
> 
> 标签：c#, wpf, exception, crash, wpfdatagrid

我们经常收到 DataGrid 的此异常，我们正在尝试重现它，但我们无法找到此问题的原因。

StackTrace 是这样的：

* * *

System.Windows.Controls.ItemCollection.GetItemAt(Int32 index) System.Windows.Controls.VirtualizedCellInfoCollection.Contains(DataGridCell cell) System.Windows.Controls.DataGridCell.PrepareCell(Object item, DataGridRow ownerRow, Int32 index) 系统。 Windows.Controls.DataGridCell.PrepareCell(Object item, ItemsControl cellsPresenter, DataGridRow ownerRow) en System.Windows.Controls.ItemsControl.MS.Internal.Controls.IGeneratorHost.PrepareItemContainer(DependencyObject container, Object item) en System.Windows.Controls.ItemContainerGenerator .OnItemReplaced(Object oldItem, Object newItem, Int32 index) en System.Windows.Controls.ItemContainerGenerator.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args) en System.Windows.Controls.ItemContainerGenerator.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType,对象发送者，EventArgs e) zh System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList 列表) zh System.Windows.WeakEventManager.DeliverEvent(Object sender, EventArgs args) zh System.Collections.Specialized.NotifyCollectionChangedEventHandler.Invoke( Object sender, NotifyCollectionChangedEventArgs e) en System.Windows.Data.CollectionView.OnCollectionChanged(NotifyCollectionChangedEventArgs args) en System.Windows.Controls.ItemCollection.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e) en System.Windows .WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list) en System.Windows.WeakEventManager.DeliverEvent(Object sender, EventArgs args) en System.Windows.Data.CollectionView。OnCollectionChanged(NotifyCollectionChangedEventArgs args) en System.Windows.Data.ListCollectionView.ProcessCollectionChangedWithAdjustedIndex(NotifyCollectionChangedEventArgs args, Int32adjustedOldIndex, Int32adjustedNewIndex) en System.Windows.Controls.MultipleCopiesCollection.set_CopiedItem(Object value) en System.Windows.Controls.DataGridRow.NotifyPropertyChanged( DependencyObject d, String propertyName, DependencyPropertyChangedEventArgs e, DataGridNotificationTarget 目标) en System.Windows.Controls.DataGridRow.NotifyPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e, DataGridNotificationTarget 目标) en System.Windows.Controls.DataGridRow.OnNotifyRowPropertyChanged(DependencyObject d, enDependencyPropertyChangedEventArgs e) System.Windows.DependencyObject。OnPropertyChanged(DependencyPropertyChangedEventArgs e) en System.Windows.FrameworkElement.OnPropertyChanged(DependencyPropertyChangedEventArgs e) en System.Windows.Controls.DataGridRow.OnPropertyChanged(DependencyPropertyChangedEventArgs e) en System.Windows.DependencyObject.NotifyPropertyChange(DependencyPropertyChangedEventArgs args) en System.Windows.DependencyObject。 UpdateEffectiveValue(EntryIndex entryIndex, DependencyProperty dp, PropertyMetadata metadata, EffectiveValueEntry oldEntry, EffectiveValueEntry& newEntry, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType) en System.Windows.DependencyObject.SetValueCommon(DependencyProperty dp, Object value, PropertyMetadata metadata, Boolean coerceWithDeferredReference, Boolean coerceWithCurrentValue, OperationType operationType,Boolean isInternal) en System.Windows.DependencyObject.SetValue(DependencyProperty dp, Object value) en System.Windows.Controls.DataGridRow.PrepareRow(Object item, DataGrid owningDataGrid) en System.Windows.Controls.DataGrid.PrepareContainerForItemOverride(DependencyObject element, Object item) en System.Windows.Controls.ItemsControl.MS.Internal.Controls.IGeneratorHost.PrepareItemContainer(DependencyObject container, Object item) en System.Windows.Controls.VirtualizingStackPanel.InsertContainer(Int32 childIndex, UIElement container, Boolean isRecycled) en System。 Windows.Controls.VirtualizingStackPanel.AddContainerFromGenerator(Int32 childIndex, UIElement child, Boolean newRealized) en System.Windows.Controls.VirtualizingStackPanel.GeneratePreviousChild(Int32 childIndex, Size layoutSlotSize) en System.Windows.Controls.VirtualizingStackPanel。EnsureTopCapGenerated(Size layoutSlotSize) en System.Windows.Controls.VirtualizingStackPanel.MeasureOverride(Size constraint) en System.Windows.Controls.Primitives.DataGridRowsPresenter.MeasureOverride(Size constraint) en System.Windows.FrameworkElement.MeasureCore(Size availableSize) en System. Windows.UIElement.Measure(Size availableSize) 和 System.Windows.ContextLayoutManager.UpdateLayout() 和 System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg) System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks() 和 System.Windows.Media。 MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget) zh System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) zh System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) zh MS.Internal.Threading。ExceptionFilterHelper.TryCatchWhen（对象源，委托方法，对象参数，Int32 numArgs，委托 catchHandler）

* * *

或者这个：

* * *

在 System.Windows.Controls.ItemCollection.GetItemAt(Int32 index) 在 System.Windows.Controls.VirtualizedCellInfoCollection.Contains(DataGridCell cell) 在 System.Windows.Controls.DataGridCell.PrepareCell(Object item, DataGridRow ownerRow, Int32 index) 在 System .Windows.Controls.DataGridCell.PrepareCell(Object item, ItemsControl cellsPresenter, DataGridRow ownerRow) 在 System.Windows.Controls.Primitives.DataGridCellsPresenter.SyncProperties(Boolean forcePrepareCells) 在 System.Windows.Controls.DataGridRow.SyncProperties(Boolean forcePrepareCells) 在 System System.Windows.Controls.DataGrid.PrepareContainerForItemOverride（DependencyObject 元素，对象项）中的 .Windows.Controls.DataGridRow.PrepareRow（对象项，DataGrid owningDataGrid）。Windows.Controls.ItemsControl.MS.Internal.Controls.IGeneratorHost。PrepareItemContainer（DependencyObject 容器，对象项）在 System.Windows.Controls.VirtualizingStackPanel.InsertContainer（Int32 childIndex，UIElement 容器，Boolean isRecycled）在 System.Windows.Controls.VirtualizingStackPanel.AddContainerFromGenerator（Int32 childIndex，UIElement child，Boolean newRealized）在系统.Windows.Controls.VirtualizingStackPanel.GeneratePreviousChild(Int32 childIndex, Size layoutSlotSize) 在 System.Windows.Controls.VirtualizingStackPanel.EnsureTopCapGenerated(Size layoutSlotSize) 在 System.Windows.Controls.VirtualizingStackPanel.MeasureOverride(大小约束) 在 System.Windows.Controls。在 System.Windows.FrameworkElement.MeasureCore(Size availableSize) 在 System.Windows.UIElement.Measure(Size availableSize) 在 System.Windows 的 Primitives.DataGridRowsPresenter.MeasureOverride（大小约束）。ContextLayoutManager.UpdateLayout() 在 System.Windows.ContextLayoutManager.UpdateLayoutCallback(Object arg) 在 System.Windows.Media.MediaContext.FireInvokeOnRenderCallbacks() 在 System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget) 在 System.Windows.Media。 MediaContext.RenderMessageHandler(Object resizedCompositionTarget) at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs,委托 catchHandler)RenderMessageHandlerCore(Object resizedCompositionTarget) 在 System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) 在 System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) 在 MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(对象源、Delegate 方法、Object args、Int32 numArgs、Delegate catchHandler)RenderMessageHandlerCore(Object resizedCompositionTarget) 在 System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) 在 System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) 在 MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(对象源、Delegate 方法、Object args、Int32 numArgs、Delegate catchHandler)

* * *

我们发现了一些关于 EnableColumnVirtualization（设置为 false）的帖子，但这没有帮助，我们仍然遇到同样的异常。对于如何重现或修复此异常，我们几乎没有想法。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:46:50.170

可能的解决方法：

[http://www.actiprosoftware.com/community/thread/5522/argumentoutofrangeexception-when-using-wpf-da](http://www.actiprosoftware.com/community/thread/5522/argumentoutofrangeexception-when-using-wpf-da)

查看解决方法选项卡：

[http://connect.microsoft.com/VisualStudio/feedback/details/643908/argumentoutofrangeexception-buried-deep-in-datagrid-code#](http://connect.microsoft.com/VisualStudio/feedback/details/643908/argumentoutofrangeexception-buried-deep-in-datagrid-code#)

修补程序：

[http://support.microsoft.com/kb/2484832](http://support.microsoft.com/kb/2484832)

# menu - Orchard CMS：选择管理菜单后出现 404 错误

> ID：11511525
> 
> 赞同：1
> 
> 时间：2012-07-16T19:50:00.563
> 
> 标签：menu, navigation, http-status-code-404, orchardcms

在 Orchard CMS 中，我在导航中创建了一个菜单并填充了它。但是当我尝试返回管理菜单时，我收到 404 错误提示`the resource is not found`。我使用高级菜单创建了另外两个菜单，没有问题。

然后我尝试了一个副本，希望它可能会提示我一个已经存在。现在我无法获取资源以将其删除，也无法创建另一个菜单来管理而不会出现 404 错误。我不知道在哪里看。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T09:03:44.007

您可能创建了一个菜单，其名称包含空格或其他在 URL 中无效的字符。您可以在 database-table 中手动更改它`Szmyd_Orchard_Modules_Menu_AdvancedMenuPartRecord`。

# python - 连接似乎在服务器端被接受，但在我的 python 脚本中似乎被拒绝

> ID：11511530
> 
> 赞同：0
> 
> 时间：2012-07-16T19:50:41.827
> 
> 标签：python, mongodb, pymongo

我有一个 python 脚本正在运行以将文档添加到远程 mongodb 数据库的集合中。该文件如下：

```
from pymongo import Connection
ip    = 'x.x.x.x' #edited out

conn  = Connection()
db    = conn['netmon']

users = db.users
print 'number of users: ' + str(users.count())
if users.count() == 0:
  print 'Please create a new account.'
  t_user = raw_input('Username:')
  users.insert({'username':unicode(t_user)})
conn.close() 
```

当我运行这个脚本时，我有一些有趣的行为。在服务器日志中，似乎接受了连接，运行了查询，然后关闭了连接。

```
# Mongodb logs
14:27:18 [initandlisten] connection accepted from 108.93.46.75:39558 #1
14:27:18 [conn1] run command admin.$cmd { ismaster: 1 }
14:27:18 [conn1] command admin.$cmd command: { ismaster: 1 } ntoreturn:1 reslen:71 0ms
14:27:18 [conn1] run command netmon.$cmd { count: "users", fields: null, query: {} }
14:27:18 [conn1] Accessing: netmon for the first time
14:27:18 [conn1] command netmon.$cmd command: { count: "users", fields: null, query: {} } ntoreturn:1 reslen:58 10ms
14:27:18 [conn1] end connection 108.93.46.75:39558 
```

但是，这是我从 python 脚本中得到的：

```
# Python error
> python testmongo.py
Traceback (most recent call last):
  File "testmongo.py", line 7, in <module>
    conn  = Connection()
  File "/usr/local/lib/python2.7/dist-packages/pymongo-2.2.1-py2.7-linux-x86_64.egg/pymongo/connection.py", line 290, in __init__
    self.__find_node()
  File "/usr/local/lib/python2.7/dist-packages/pymongo-2.2.1-py2.7-linux-x86_64.egg/pymongo/connection.py", line 586, in __find_node
    raise AutoReconnect(', '.join(errors))
pymongo.errors.AutoReconnect: could not connect to localhost:27017: [Errno 111] Connection refused
charles@charles-mbp:~/Desktop$ python testmongo.py
Traceback (most recent call last):
  File "testmongo.py", line 7, in <module>
    conn  = Connection()
  File "/usr/local/lib/python2.7/dist-packages/pymongo-2.2.1-py2.7-linux-x86_64.egg/pymongo/connection.py", line 290, in __init__
    self.__find_node()
  File "/usr/local/lib/python2.7/dist-packages/pymongo-2.2.1-py2.7-linux-x86_64.egg/pymongo/connection.py", line 586, in __find_node
    raise AutoReconnect(', '.join(errors))
pymongo.errors.AutoReconnect: could not connect to localhost:27017: [Errno 111] Connection refused
charles@charles-mbp:~/Desktop$ python testmongo.py
Traceback (most recent call last):
  File "testmongo.py", line 7, in <module>
    conn  = Connection()
  File "/usr/local/lib/python2.7/dist-packages/pymongo-2.2.1-py2.7-linux-x86_64.egg/pymongo/connection.py", line 290, in __init__
    self.__find_node()
  File "/usr/local/lib/python2.7/dist-packages/pymongo-2.2.1-py2.7-linux-x86_64.egg/pymongo/connection.py", line 586, in __find_node
    raise AutoReconnect(', '.join(errors))
pymongo.errors.AutoReconnect: could not connect to localhost:27017: [Errno 111] Connection refused 
```

一些有用的信息： 远程服务器是在 OpenVZ 上运行的 VPS。我知道存在与 count() 和迭代器相关的兼容性问题，但我（假设）通过使用 --smallfiles 选项修复了它们，并将我的 nssize 限制为 100。我两边的防火墙都是完全打开的。

我还注意到，在错误中，自动重新连接正在尝试连接到 localhost，即使我指定了不同的 IP 地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:55:58.670

您需要通过 IP -`conn = Connection(ip)`

# php - OAuth: what to do if user refuses to share his data

> ID：11511534
> 
> 赞同：-3
> 
> 时间：2012-07-16T19:50:57.707
> 
> 标签：php, oauth

I'm trying to implement OAuth login. After a user is redirected to login-provider and suggested to share his data, he can refuse. The question is where shall I be redirected and how do I know that user refused to share his data?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:42:39.573

From the [OAuth 2.0 draft](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-30):

> **4.1.2.1\. Error Response**
> 
> If the request fails due to a missing, invalid, or mismatching
> redirection URI, or if the client identifier is missing or invalid,
> the authorization server SHOULD inform the resource owner of the
> error, and MUST NOT automatically redirect the user-agent to the
> invalid redirection URI.
> 
> If the resource owner denies the access request or if the request
> fails for reasons other than a missing or invalid redirection URI,
> the authorization server informs the client by adding the following
> parameters to the query component of the redirection URI using the
> "application/x-www-form-urlencoded" format, per Appendix B:

The draft indicates what the error code will be depending on why the token was not granted.

# haskell - Haskell 中的运行时错误

> ID：11511536
> 
> 赞同：2
> 
> 时间：2012-07-16T19:51:09.330
> 
> 标签：haskell, tuples, runtime-error

我的程序正在**搜索** 我写的元组列表如下

```
import List
data BookInfo = Book Int String [String]
  deriving(Show)

enter :: Int->String->[String]->BookInfo
enter id name subject=Book id name subject
bookId   (Book id _     _  ) = id

index :: BookInfo -> Int
index (Book id name subject) =  bookId  (Book id name subject) 

arrayentering ::BookInfo->[BookInfo]->[BookInfo]
arrayentering (Book id name subject) [] =[(Book id name subject)]
arrayentering (Book  _  "     " ["    "]) [] =[]
arrayentering (Book id name subject) [(Book it namr suject)]=                         
              (Book id name subject):[(Book it name suject)]
toList::[BookInfo]->[Int]
toList [(Book id name subject) ]=   map index [ (Book id name subject)]

bubbleSort::(Ord t) => [t]->[t]
bubbleSort[x,y,z,xs]=
                if x<y then x : [y,z,xs]
                       else y : [x,z,xs]

superBubble::(Ord t) => [[t]]->[[t]]
superBubble a=map bubbleSort a

combining::[BookInfo]->[[Int]]
combining [(Book id name subject)]=superBubble [toList [(Book id name subject)]] 
```

并从任何语法错误中清除它，但是在我尝试输入一个元组列表之后，`combining()`它会给我运行时错误说

`Exception:Not Exhaustive pattern in function Main.combining`

这是什么意思？

**请只给我指示。如果可能的话，我想自己修复它。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:57:27.953

函数定义中的模式

```
combining [(Book id name subject)]=superBubble [toList [(Book id name subject)]] 
```

只匹配只有一个元素的列表。你有一个类似的问题`bubbleSort`，其中

```
bubbleSort[x,y,z,xs]= 
```

只匹配恰好有四个元素的列表和其他地方。

我还没有弄清楚你打算如何工作，也许使用变量模式（匹配所有参数）

```
combining books = superBubble (toList books) 
```

合适吗？

* * *

我猜测

```
arrayentering ::BookInfo->[BookInfo]->[BookInfo]
arrayentering (Book id name subject) [] =[(Book id name subject)]
arrayentering (Book  _  "     " ["    "]) [] =[]
arrayentering (Book id name subject) [(Book it namr suject)]=                         
              (Book id name subject):[(Book it name suject)] 
```

真的应该

```
arrayentering book bookList
    | empty book = bookList
    | otherwise  = book : bookList
      where
        empty (Book _ name subject) = all isSpace name && all (all isSpace) subject 
```

（`empty`可能是错误的）。

并且`toList`应该只是`map index`.

# ipad - 在 iPad 上触摸 Web 应用程序的某些部分时出现奇怪的屏幕着色

> ID：11511538
> 
> 赞同：0
> 
> 时间：2012-07-16T19:51:22.447
> 
> 标签：ipad, mobile, touch, tint

当用户触摸我们 Web 应用程序的任何部分时，我会发生这种奇怪的行为。该接口由一个具有两个嵌套 iframe 的 iframe 组成。当触摸 iframe 的任何部分时，整个部分会变暗或变暗？不接触时色调/暗淡消失。它与标准的 iOS“复制”行为非常相似，只是没有“复制”选项。有没有人知道可能导致这种情况的原因？

我在触摸图像期间添加了一个指向说明问题的视频的链接。

**触摸图像期间**：[http ://www.smartertools.com/images/misc/img_0599.jpg](http://www.smartertools.com/images/misc/img_0599.jpg)

**视频**：[http ://www.smartertools.com/images/misc/img_0597.mov](http://www.smartertools.com/images/misc/img_0597.mov)

# environment-variables - 从巡航控制执行 ms dos 批处理脚本并传递变量

> ID：11511545
> 
> 赞同：0
> 
> 时间：2012-07-16T19:52:04.587
> 
> 标签：environment-variables, cruisecontrol.net, batch-file

我正在尝试从巡航控制执行 msdos 批处理脚本并传递一些变量。我可以很好地执行批处理脚本，但无法访问批处理脚本中的环境变量。这是我的 ccnet 配置文件的内容：

```
<exec>
        <executable>myscript.BAT</executable>
        <environment>
            <variable name="var1" value="value1" />
            <variable name="var2" value="value2" />
        </environment>
</exec> 
```

如何访问 myscript.BAT 中的 var1 和 var2？我做“%var1%”时得到的只是空白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T17:11:05.867

您还可以分别将值作为参数和引用`var1`以及`var2`by`$1`和by 传递`$2`。

# iphone - 如果用户输入所有必需的信息，如何禁用和启用按钮

> ID：11511546
> 
> 赞同：1
> 
> 时间：2012-07-16T19:52:05.543
> 
> 标签：iphone, nsthread

**给定**：下面是用户必须输入的表单，右上角是一个按钮，允许用户导航到另一个屏幕。

![在此处输入图像描述](../Images/2069ec05e357127cf1a038329ac2fff4.png)

**目标**：在用户输入所有必填字段之前，右上角的按钮被禁用。一旦用户输入了所有必填字段，按钮将被启用，用户将被允许按下它允许导航到下一个屏幕

**问题**：如何**在 iphone 中使用线程来完成这项任务。**

如果您对此有任何线索，请提供帮助

谢谢

PS：对于一开始不清楚的问题，我深表歉意。我刚刚更新了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:56:42.713

UIButton 继承自 UIControl

只需使用 button.enabled 属性。

```
button.enabled = false;

// Detect when all inputs are valid

button.enabled = true; 
```

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIControl_Class/Reference/Reference.html#//apple_ref/occ/instp/UIControl/state](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIControl_Class/Reference/Reference.html#//apple_ref/occ/instp/UIControl/state)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:04:03.313

快速天真的解决方案：

为每个文本字段设置一个唯一标签：

```
- (UITableViewCell*)tableView:(UITableView*) cellForRowAtIndexPath:(NSIndexPath*)indexPath
{
    // Create/Re-use Table Cell code here...

    cell.theTextField.tag = indexPath.row;
} 
```

为每个文本字段创建布尔标志。

实现 UITextViewDelegate 并将其设置为每个文本字段的委托。您需要创建此方法：

```
- (void)textFieldDidEndEditing:(UITextField *)textField 
```

检查用户是否设置了有效输入，如果设置了，则将对应于该文本字段的布尔标志设置为 true。

验证每个文本字段后，检查所有标志是否为真。如果是，请启用导航按钮。

# ios - 在 ios 应用程序上缓存图像的最佳方法？

> ID：11511548
> 
> 赞同：50
> 
> 时间：2012-07-16T19:52:10.577
> 
> 标签：ios, image, uitableview, caching, load

很快，我就有了一个`NSDictionary`我需要在我的`UITableView`. 每个单元格都有一个标题和一个图像。我成功地做到了这一点，尽管滚动滞后，因为看起来细胞每次进入屏幕时都会下载它们的图像。我搜索了一下，发现`SDWebImage`在github上。这使得滚动滞后消失了。我不完全确定它做了什么，但我相信它做了一些缓存。但！每次我第一次打开应用程序时，我都看不到任何图像，我必须向下滚动并备份它们才能到达。如果我用主页按钮退出应用程序，然后再次打开，那么似乎缓存正在工作，因为屏幕上的图像是可见的，但是，如果我向下滚动一个单元格，则下一个单元格没有图像。直到我滚动过去并备份，或者如果我点击它。这是缓存应该如何工作的吗？或者缓存从网络下载的图像的最佳方法是什么？图像更新很少，所以我几乎只是将它们导入项目，但我希望有可能在不上传更新的情况下更新图像..

是否不可能在启动时从缓存中加载整个 tableview 的所有图像（假设缓存中有东西）？这就是为什么我有时会看到没有图像的细胞？

是的，我很难理解缓存是什么。

**- 编辑 -**

我只使用相同尺寸（500x150）的图像进行了尝试，并且纵横比错误消失了，但是当我向上或向下滚动时，所有单元格上都有图像，但起初它们是错误的。单元格在视图中停留几毫秒后，就会出现正确的图像。这非常烦人，但也许它必须是这样的？..它似乎一开始从缓存中选择了错误的索引。如果我滚动缓慢，那么我可以看到图像从错误的图像闪烁到正确的图像。如果我快速滚动，那么我相信始终可以看到错误的图像，但由于快速滚动，我无法判断。当快速滚动变慢并最终停止时，仍然会出现错误的图像，但在停止滚动后会立即更新为正确的图像。我也有一个习惯`UITableViewCell`上课，但我没有做任何大的改变..我还没有仔细检查我的代码，但我想不出可能有什么问题..也许我有一些错误的顺序..我有用 java、c#、php 等编写了很多程序，但我很难理解 Objective-c，所有的`.h`和`.m`......我也有

```
@interface FirstViewController : UITableViewController{

/**/
NSCache *_imageCache;
} 
```

（在其他变量中）在`FirstViewController.h`. 这不正确吗？

这是我的`cellForRowAtIndexPath`。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"hallo";
CustomCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil)
{
    cell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

NSMutableArray *marr = [hallo objectAtIndex:indexPath.section];
NSDictionary *dict = [marr objectAtIndex:indexPath.row];

NSString* imageName = [dict objectForKey:@"Image"];
//NSLog(@"url: %@", imageURL);

UIImage *image = [_imageCache objectForKey:imageName];

if(image)
{
    cell.imageView.image = image;
}
else
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

        NSString* imageURLString = [NSString stringWithFormat:@"example.com/%@", imageName];
        NSURL *imageURL = [NSURL URLWithString:imageURLString];
        UIImage *image = [[UIImage alloc] initWithData:[NSData dataWithContentsOfURL:imageURL]];

        if(image)
        {
            dispatch_async(dispatch_get_main_queue(), ^{
                CustomCell *cell =(CustomCell*)[self.tableView cellForRowAtIndexPath:indexPath];
                if(cell)
                {
                    cell.imageView.image = image;
                }
            });
            [_imageCache setObject:image forKey:imageName];
        }
    });
}

cell.textLabel.text = [dict objectForKey:@"Name"];

return cell;
} 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-07-16T20:10:05.367

缓存只是意味着保留您需要的数据的副本，这样您就不必从一些较慢的源加载它。例如，微处理器通常具有高速缓存存储器，它们在其中保存数据副本，这样它们就不必访问速度慢得多的 RAM。硬盘通常具有内存缓存，文件系统可以从中更快地访问最近访问过的数据块。

同样，如果您的应用程序从网络加载了大量图像，那么将它们缓存在您的设备上而不是每次需要它们时都下载它们可能符合您的兴趣。有很多方法可以做到这一点——听起来你已经找到了一种。您可能希望将下载的图像存储在应用程序的 /Library/Caches 目录中，尤其是在您不希望它们发生变化的情况下。从辅助存储加载图像将比通过网络加载要快得多。

您可能还对鲜为人知的用于将所需图像保存在内存中的[NSCache类感兴趣。](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/NSCache_Class/Reference/Reference.html)NSCache 像字典一样工作，但是当内存紧张时，它会开始释放其中的一些内容。您可以先检查给定图像的缓存，如果在那里找不到它，您可以查看您的缓存目录，如果在那里找不到它，您可以下载它。这些都不会在您第一次运行应用程序时加快图像加载速度，但是一旦您的应用程序下载了所需的大部分内容，它的响应速度就会更快。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-07-16T20:25:09.380

我认为 Caleb 很好地回答了缓存问题。我只是想谈谈在检索图像时更新 UI 的过程，例如假设你有一个`NSCache`名为`_imageCache`：

首先，为tableview定义一个操作队列属性：

```
@property (nonatomic, strong) NSOperationQueue *queue; 
```

然后在 中`viewDidLoad`，初始化：

```
self.queue = [[NSOperationQueue alloc] init];
self.queue.maxConcurrentOperationCount = 4; 
```

然后在 中`cellForRowAtIndexPath`，您可以：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"ilvcCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // set the various cell properties

    // now update the cell image

    NSString *imagename = [self imageFilename:indexPath]; // the name of the image being retrieved

    UIImage *image = [_imageCache objectForKey:imagename];

    if (image)
    {
        // if we have an cachedImage sitting in memory already, then use it

        cell.imageView.image = image;
    }
    else
    {
        cell.imageView.image = [UIImage imageNamed:@"blank_cell_image.png"];

        // the get the image in the background

        [self.queue addOperationWithBlock:^{

            // get the UIImage

            UIImage *image = [self getImage:imagename];

            // if we found it, then update UI

            if (image)
            {
                [[NSOperationQueue mainQueue] addOperationWithBlock:^{
                    // if the cell is visible, then set the image

                    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
                    if (cell)
                        cell.imageView.image = image;
                }];

                [_imageCache setObject:image forKey:imagename];
            }
        }];
    }

    return cell;
} 
```

我只提到这一点是因为我最近在 SO 上看到了一些代码示例，它们使用 GCD 来更新适当的`UIImageView` `image`属性，但是在将 UI 更新分派回主队列的过程中，它们采用了奇怪的技术（例如，重新加载单元格或表格，仅更新`cell`顶部返回的现有对象的图像属性`tableView:cellForRowAtIndexPath`（如果该行已滚动离开屏幕并且该单元格已出列并被重新用于新行，则这是一个问题）等.)。通过使用`cellForRowAtIndexPath`（不要与 混淆`tableView:cellForRowAtIndexPath`），您可以确定单元格是否仍然可见和/或它是否可能已滚动并已出列并重用。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-10-24T16:53:08.447

最简单的解决方案是使用经过压力测试的大量使用的东西。

SDWebImage 是一个强大的工具，它帮助我解决了类似的问题，并且可以很容易地与可可豆荚一起安装。在 podfile 中：

```
platform :ios, '6.1'
pod 'SDWebImage', '~>3.6' 
```

设置缓存：

```
SDImageCache *imageCache = [[SDImageCache alloc] initWithNamespace:@"myNamespace"];
[imageCache queryDiskCacheForKey:myCacheKey done:^(UIImage *image)
{
    // image is not nil if image was found
}]; 
```

缓存图片：

```
[[SDImageCache sharedImageCache] storeImage:myImage forKey:myCacheKey]; 
```

[https://github.com/rs/SDWebImage](https://github.com/rs/SDWebImage)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-14T11:22:26.427

我认为像 DLImageLoader 这样的用户会更好。更多信息-> [https://github.com/AndreyLunevich/DLImageLoader-iOS](https://github.com/AndreyLunevich/DLImageLoader-iOS)

```
[[DLImageLoader sharedInstance] loadImageFromUrl:@"image_url_here"
                                   completed:^(NSError *error, UIImage *image) {
                                        if (error == nil) {
                                            imageView.image = image;
                                        } else {
                                            // if we got an error when load an image
                                        }
                                   }]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-01T13:46:39.347

对于错误图像的部分问题，这是因为单元格的重用。单元格的重用意味着现有的单元格，这些单元格不在视野范围内（例如，当您向下滚动时，从顶部离开屏幕的单元格是从底部再次返回的单元格。）所以你得到不正确的图像。但是一旦单元格出现，获取正确图像的代码就会执行，并且您会获得正确的图像。

您可以在单元格的“prepareForReuse”方法中使用占位符。此功能主要用于当您需要重新设置单元格以供重用时的值时。在此处设置占位符将确保您不会得到任何不正确的图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-06T01:34:00.740

缓存图像可以像这样简单地完成。

**图像服务.m**

```
@implementation ImageService{
    NSCache * Cache;
}

const NSString * imageCacheKeyPrefix = @"Image-";

-(id) init {
    self = [super init];
    if(self) {
        Cache = [[NSCache alloc] init];
    }
    return self;
}

/** 
 * Get Image from cache first and if not then get from server
 * 
 **/

- (void) getImage: (NSString *) key
        imagePath: (NSString *) imagePath
       completion: (void (^)(UIImage * image)) handler
    {
    UIImage * image = [Cache objectForKey: key];

    if( ! image || imagePath == nil || ! [imagePath length])
    {
        image = NOIMAGE;  // Macro (UIImage*) for no image 

        [Cache setObject:image forKey: key];

        dispatch_async(dispatch_get_main_queue(), ^(void){
            handler(image);
        });
    }
    else
    {
        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH,0ul ),^(void){

            UIImage * image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:[imagePath stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]]];

            if( !image)
            {
                image = NOIMAGE;
            }

            [Cache setObject:image forKey: key];

            dispatch_async(dispatch_get_main_queue(), ^(void){
                handler(image);
            });
        });
    }
}

- (void) getUserImage: (NSString *) userId
           completion: (void (^)(UIImage * image)) handler
{
    [self getImage: [NSString stringWithFormat: @"%@user-%@", imageCacheKeyPrefix, userId]
         imagePath: [NSString stringWithFormat: @"http://graph.facebook.com/%@/picture?type=square", userId]
        completion: handler];
} 
```

**SomeViewController.m**

```
 [imageService getUserImage: userId
                    completion: ^(UIImage *image) {
            annotationImage.image = image;
    }]; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-07T10:45:04.143

```
////.h file

#import <UIKit/UIKit.h>

@interface UIImageView (KJ_Imageview_WebCache)

-(void)loadImageUsingUrlString :(NSString *)urlString placeholder :(UIImage *)placeholder_image;

@end

//.m file

#import "UIImageView+KJ_Imageview_WebCache.h"

@implementation UIImageView (KJ_Imageview_WebCache)

-(void)loadImageUsingUrlString :(NSString *)urlString placeholder :(UIImage *)placeholder_image
{

    NSString *imageUrlString = urlString;
    NSURL *url = [NSURL URLWithString:urlString];

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,     NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *getImagePath = [documentsDirectory stringByAppendingPathComponent:[self tream_char:urlString]];

    NSLog(@"getImagePath--->%@",getImagePath);

    UIImage *customImage = [UIImage imageWithContentsOfFile:getImagePath];

    if (customImage)
    {
        self.image = customImage;

        return;
    }
    else
    {
         self.image=placeholder_image;
    }

    NSURLSession *session = [NSURLSession sharedSession];
    NSURLSessionDataTask *uploadTask = [session dataTaskWithURL:url completionHandler:^(NSData * _Nullable data, NSURLResponse * _Nullable response, NSError * _Nullable error) {

        if (error)
        {
            NSLog(@"%@",[error localizedDescription]);

           self.image=placeholder_image;

            return ;
        }

        dispatch_async(dispatch_get_main_queue(), ^{

            UIImage *imageToCache = [UIImage imageWithData:data];

            if (imageUrlString == urlString)
            {

                self.image = imageToCache;
            }

            [self saveImage:data ImageString:[self tream_char:urlString]];

        });

    }];

    [uploadTask resume];

}

-(NSString *)tream_char :(NSString *)string
{
    NSString *unfilteredString =string;

    NSCharacterSet *notAllowedChars = [[NSCharacterSet characterSetWithCharactersInString:@"!@#$%^&*()_+|abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"] invertedSet];
    NSString *resultString = [[unfilteredString componentsSeparatedByCharactersInSet:notAllowedChars] componentsJoinedByString:@""];
    NSLog (@"Result: %@", resultString);

    return resultString;

}

-(void)saveImage : (NSData *)Imagedata ImageString : (NSString *)imageString
{

    NSArray* documentDirectories = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask,YES);

    NSString* documentDirectory = [documentDirectories objectAtIndex:0];
    NSString* documentDirectoryFilename = [documentDirectory stringByAppendingPathComponent:imageString];

    if (![Imagedata writeToFile:documentDirectoryFilename atomically:NO])
    {
        NSLog((@"Failed to cache image data to disk"));
    }
    else
    {
        NSLog(@"the cachedImagedPath is %@",documentDirectoryFilename);
    }

}

@end

/// call 

 [cell.ProductImage loadImageUsingUrlString:[[ArrProductList objectAtIndex:indexPath.row] valueForKey:@"product_image"] placeholder:[UIImage imageNamed:@"app_placeholder"]]; 
```

# c# - 干净地验证传递给 Mock 的参数的许多属性[单独在单个验证调用之外]？

> ID：11511550
> 
> 赞同：1
> 
> 时间：2012-07-16T19:52:21.643
> 
> 标签：c#, mocking, moq

```
saveThemeAS.Verify(service => service.Execute(FakeUserID, It.Is<LayoutENT.Theme>(savedTheme => 
            savedTheme != null
            && savedTheme.Name == FakeCopiedThemeName
            && savedTheme.ThemeID == 0
            && savedTheme.WidgetSkins.Any(skin => skin.Name == FakeWidgetSkinName && skin.WidgetSkinID == 0)
            && savedTheme.SiteStyles.Any(style => style.SiteStyleID == FakeStyleID && style.SiteStyleID == 0)
            ))); 
```

> 对模拟的预期调用至少一次，但从未执行过：

这里的基本问题是我只是失败了，但我不知道*具体*是什么失败/什么设置不正确，因为它可能是上述 5 个条件中的任何一个。

我想分别检查上面的每个条件。有没有一种巧妙的方法可以在不创建多个测试的情况下使用 Moq 做到这一点？我认为能够捕获传递给模拟的参数然后对其进行测试会很好，但我无法找到一种优雅的方式来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:05:37.643

本质上，您要求的是让您的内部 lambda 执行一系列断言，而不是简单地评估为布尔值。

所以让我们这样做:)

```
saveThemeAS.Verify(service => service.Execute(FakeUserID, It.Is<LayoutENT.Theme>(savedTheme => 
   {
      Assert.IsNotNull(savedTheme);
      Assert.AreEqual(FakeCopiedThemeName, savedTheme.Name);
      Assert.AreEqual(0, savedTheme.ThemeID)

      etc...

      return true;     
   }
))); 
```

为了清楚起见，您可以将断言移至单独的方法。

如果你想摆脱“return true;” 您可以为 Action<T> 编写一个包装器，它返回一个始终返回 true 的 Func<T,bool>。这样你就可以写一些类似的东西：

```
saveThemeAS.Verify(service => service.Execute(FakeUserID, It.Is<LayoutENT.Theme>(ReturnsTrue(CheckTheme)))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T23:15:44.320

我认为我解决这个问题的方法是在模拟设置中使用回调，以便回调保存传递给它的 savedTheme 对象的副本。然后我会在稍后的单元测试中执行断言。这保留了 AAA（排列、动作、断言）模式，并且看起来比将断言逻辑放入模拟设置更清晰。例如：

```
protected static LayoutENT.Theme savedTheme;
// Arrange
themeParam = null;
saveThemeAS.Setup(service => service.Execute(FakeUserID, It.Is<LayoutENT.Theme>)
    .Callback<layoutENT.Theme>(p =>  savedTheme = p);

// Act
// Calls the subject under test

// Assert
Assert.IsNotNull(savedTheme); 
Assert.AreEqual(FakeCopiedThemeName, savedTheme.Name); 
Assert.AreEqual(0, savedTheme.ThemeID) 
```

ETC...

# windows-phone-7 - wp7 XNA 检测用户是否触摸了自定义形状

> ID：11511551
> 
> 赞同：0
> 
> 时间：2012-07-16T19:52:21.930
> 
> 标签：windows-phone-7, xna, vector-graphics

我正在创建许多彼此相邻放置的自定义形状（4 个坐标）。我想检测用户何时触摸其中一个形状并确定他们触摸了哪个形状。

我已经知道如何注册触摸并且我已经在其他应用程序中完成了碰撞检测。问题是，如果您将菱形放置在“格子”（不重叠）中，那么您不能简单地查看触摸点是否在 x 和 y 范围内。

本质上，我希望生成一个像素列表，这些像素构成了我可以将我的触摸点与之进行比较的形状。

有人可以帮帮我吗？

编辑：

![在此处输入图像描述](../Images/0edf596be9bb9bb0507c8c87fcac4271.png)

点是用户的触摸。由于触摸不与任何边缘接触，我不能使用对象碰撞。如果您将菱形视为矩形，那么在此示例中，程序会认为您已经触及了两者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:08:06.630

要确定一个点是否在多边形内，您可以使用[此处](http://erich.realtimerendering.com/ptinpoly/)概述的任何方法，或“ [PNPOLY](http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html) ”算法。

当然——如果你想让事情变得简单，你可以使用[Farseer](http://farseerphysics.codeplex.com/)及其[碰撞系统](http://www.box2d.org/manual.html#_Toc258082970)为你执行计算（Box2D 和 Farseer 具有相同的功能，所以我为碰撞位提供了 Box2D 链接）。您也可以直接获取给定多个 PolygonShapes 的碰撞点。

# ios - 使用 MKMapView 时出错

> ID：11511554
> 
> 赞同：4
> 
> 时间：2012-07-16T19:52:42.860
> 
> 标签：ios, xcode, mkmapview

我用故事板创建了一个单视图应用程序。在我看来，只有 MKMapView，就是这样。它编译时没有错误或警告，但是当我运行它时，我在控制台窗口中收到此错误：

```
<Error>: ImageIO: CGImageReadSessionGetCachedImageBlockData ***   CGImageReadSessionGetCachedImageBlockData: readSession [0x8ab5750] has bad readRef [0x14b79c70] 
```

我正在使用 Xcode 4.3 和 iPhone 模拟器 5.1。有什么想法吗？

.h 文件

```
#import UIKit/UIKit.h
#import CoreLocation/CoreLocation.h
#import MapKit/MapKit.h

@interface WhereamiViewController : UIViewController <CLLocationManagerDelegate, MKMapViewDelegate>
{ 
IBOutlet MKMapView *worldView;
IBOutlet UIActivityIndicatorView *activityIndicator;
IBOutlet UITextField *locationTitleField;
}

@end 
```

.m 文件

```
#import "WhereamiViewController.h"

@interface WhereamiViewController ()

@end

@implementation WhereamiViewController

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

@end 
```

![在此处输入图像描述](../Images/6421eae55faac13e40858eb2c7ff146f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-12T06:28:20.600

刚碰到这个：

简单修复：确保在界面生成器中选中 MapView 的“显示用户位置”框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-20T05:24:17.627

可能我不应该回答将近一年的问题，但我遇到了同样的问题，原因是我在**viewDidLoad方法上调用****CLLocationManager** * *startUpdateLocation* * ，当我将其更改为**viewWillAppear**时，问题消失了。

 ***** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-29T13:40:29.317

在我看来，这就像框架中的一个错误。使用[Apple Bug Reporter](http://bugreport.apple.com)报告它，看看它是否是一个已知问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-06T06:37:11.863

我也遇到了同样的问题。我通过注释掉所有代码并编译程序来解决它。然后我在每次编译后一个一个地取消注释每个方法。出于某种原因，这似乎摆脱了我的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-12T08:54:09.283

更正你的代码如下，并创建地图视图的出口。

```
#import <UIKit/UIKit.h>
#import <CoreLocation/CoreLocation.h>
#import <MapKit/MapKit.h> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-14T05:16:41.613

我的 PNG 包含一些透明部分，我认为这导致了问题，因为删除这些部分后，错误消失了。也许我的 PNG 文件中有一些错误，因为应该支持透明度。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-06T16:04:49.423

好吧，我正在做一个更简单的项目，所以我不确定它是否会对您有所帮助。但无论如何我都会给你看我的代码。您可能只想从这里开始，然后看看是否可以从那里构建。

所以对于 ViewController.h 它应该是……

```
#import <UIKit/UIKit.h>
#import <MapKit 
```****

# .htaccess - htaccess 将带有文件扩展名和尾部斜杠的 url 重定向到无斜杠

> ID：11511558
> 
> 赞同：1
> 
> 时间：2012-07-16T19:52:54.217
> 
> 标签：.htaccess, mod-rewrite, redirect

有人可以帮我弄清楚如何重定向这样的网址。

```
http://www.example.com/file.html/ 
```

至

```
http://www.example.com/file.html 
```

我试过这个

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)\.html/ $1\.html [L,R=301] 
```

但它重定向到

```
http://www.example.com/usr/www/users/user/folder/file.html 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:21:36.487

尝试在规则的目标中添加前导斜杠：

```
# slash here ------------V
RewriteRule ^(.*)\.html/ /$1\.html [L,R=301] 
```

# javascript - JavaScript/jQuery - 性能问题

> ID：11511562
> 
> 赞同：0
> 
> 时间：2012-07-16T19:53:11.357
> 
> 标签：javascript, jquery, performance

我这里有某种 webapp，它当然包含 JavaScript 和 jQuery。在加载时，一个函数`span`会围绕文本的每个字母 - 大约 150 个字母。然后用户可以选择字母并在确认后显示结果。一切都很顺利，只有最后一部分真正扼杀了性能。

结果保存在三个数组中。单击后，将触发向单击的元素添加类的功能（这是确认）。

我这样做（每个数组3次）：

```
$.each(myArr, function( i, v ){
    $(v).addClass( "my-class" );
}); 
```

它以这种方式工作，但是因为我大量操作 DOM，它会降低性能。

我使用的是 2.26 GHz 和 2 GB RAM 的 MacBook，在添加类后我无法运行简单的工具提示或任何内容。特别是如果一个阵列真的满了，这会对性能产生负面影响。

我已经尝试过优化脚本。我缓存了每个多次使用的 DOM 对象，但并非在每种情况下都是可能的（我认为......）。我还使用了选择器，例如`.my-class`and`#my-id`而不是`span[class = my-class]`and`span[id = my-id]`来加速一切。只有最后一个数组部分是坏的。

有没有办法优化这`$.each`部分？缓存还是什么？或者也许使用另一种技术？

*我不希望脚本超级快 - 但在显示结果后添加一个简单的工具提示应该是可能的。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:37:44.750

问题似乎是你导致了很多浏览器重排。每次您对 DOM 中的对象进行某些更改（例如更改其大小、删除/附加它等）时，都会发生这种情况。为了防止这种情况发生，您可以：

*   通过删除包含所有对象的父对象一次删除所有对象（这会导致一次重排）。
*   在对象不是 DOM 的一部分时进行所有必要的更改。
*   将父对象放回 DOM 中（这再次导致回流）。

如果删除父对象导致视觉干扰，您可以改为深度克隆它 ( `var clone = parent.cloneNode(true)`)，对克隆进行所有更改，然后替换父对象 ( `parent.parentNode.replaceChild(clone, parent)`)。请注意，如果对象有任何 JavaScript 事件侦听器，您需要将它们重新绑定到克隆对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:56:33.397

为什么不连接数组：

```
 myArr = myArr[0].concat(myArr[1],myArr[2]); 
  $(myArr).addClass( "my-class" ); 
```

我认为它可以更快。

# ios - 获取 iOS 的私有 API 方法的签名

> ID：11511570
> 
> 赞同：3
> 
> 时间：2012-07-16T19:53:56.423
> 
> 标签：ios, reverse-engineering, disassembly, iphone-privateapi

我知道 SpringboardService 包含很多私有 API（例如：SBGetApplicationState、SBDimScreen 等）。我使用“nm”工具获得了这些方法的列表。

我想找到一个工具来获取这些私有 API 方法的签名。据我了解，SBGetApplicationState 是一个 C 调用（与 Objective C 方法相比）。所以我不确定是否可以在不拆卸和额外手动操作的情况下恢复签名。但是，我希望至少存在半自动化的过程。

几个注意事项：

a) 我看过这个链接（iOS 运行时私有头文件）： [https ://github.com/nst/iOS-Runtime-Headers](https://github.com/nst/iOS-Runtime-Headers)

它只包含 Objective C 头文件。

b) 我看过这个链接（SpringBoard.app/MIG 子系统） [http://iphonedevwiki.net/index.php/SpringBoard.app/MIG_subsystem](http://iphonedevwiki.net/index.php/SpringBoard.app/MIG_subsystem)

它包含一些有趣的信息，但文档有点过时（适用于 iOS 3.1-4.2）

c) 我正在进行研究，我不打算向 AppStore 提交任何申请。我很清楚基于使用私有 API 的 AppStore 拒绝

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:09:05.723

1.  不幸的是，您对 C 函数的假设是正确的——您无法自动获得它们的签名。
2.  但是，您可以使用 Objective-C 消息来做到这一点——看看[class-dump](http://www.codethecode.com/projects/class-dump/)（或者，更好的是[class-dump-z](http://code.google.com/p/networkpx/wiki/class_dump_z)）。

# apache - apache mod rewrite for subdomain

> ID：11511576
> 
> 赞同：0
> 
> 时间：2012-07-16T19:54:11.013
> 
> 标签：apache, mod-rewrite, webserver

On my webserver, I have one website located at `example.com/site` (in `/var/www/site`).

I want it to be accessed through `site.example.com`, and I'm aware I need to use mod-rewrite to enable this.

Is there a concise snippet I can use to do this? I need to make it extensible so other sites can be accessed this way as well. Thanks in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:38:15.863

如果这是一个特定子域的问题：`site`，那么你应该明确地重写那个子域：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^site\.example\.com$ [NC]
RewriteCond %{REQUEST_URI} !^/site/
RewriteRule ^(.*)$ /site/$1 [L] 
```

第二个条件防止内部重写循环并使您的 URI 看起来像`/site/site/site/site/site/site/`等等......

这将进入文档根目录中的 .htaccess 文件中，`/var/www/`

如果你真的想任意重定向任何子域，你可以试试这个：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^([^\.]*)\.example\.com$ [NC]
RewriteCond %{REQUEST_URI}:%1 !^/([^/]+)[^:]*:\1 [NC]
RewriteRule ^(.*)$ /%1/$1 [L] 
```

在这里，第二个条件具有相同的目的，它试图确保请求 URI 不以来自主机的子域匹配开始。有关更好的解释，请参阅[https://stackoverflow.com/a/11508430/851273](https://stackoverflow.com/a/11508430/851273)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T19:56:58.247

首先，您需要将服务器配置为接受域 example.com 的任何子域，并将其重定向到也必须接受任何子域的虚拟主机。之后，您可以使用以下规则将该子域在内部重写为具有相同名称的文件夹：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} !^www\.
RewriteCond %{HTTP_HOST} ^([^/.]+)\.example\.com$
RewriteRule ^ %1%{REQUEST_URI} [L] 
```

# drupal - 如何修复由于 Drupal 中的模块造成的不可逆损坏

> ID：11511580
> 
> 赞同：4
> 
> 时间：2012-07-16T19:54:23.120
> 
> 标签：drupal, drupal-7

这非常令人沮丧。我在 Drupal 安装中安装了一个模块[Finder 。](http://drupal.org/project/finder/)我在其中调整了一些设置，然后在更改了一些设置后，它开始显示一些 Ajax 错误，然后出现白屏，显示此错误：

> 致命错误：在第 9 行的 /var/www/drupal/sites/all/modules/views/includes/plugins.inc 中调用未定义的函数 views_include()

使用 Drush，我禁用了 Finder 模块并清除了缓存。但是什么也没发生。然后我禁用了 Views 模块。白屏现在消失了。

现在我被困住了。我在这个站点上做了一些非常好的工作，当我重新启用视图时，白屏重新出现。在我看来，Finder 模块似乎在 Views 的某处做了一些不可逆转的改变。我的意思是当我清除缓存并且 Finder 被禁用时，我的视图为什么不起作用？

有人在 Drupal 中遇到过这样的事情吗？你是怎么解决的？

**更新** 我刚刚发现“Finder”模块的开发人员声称它是 V​​iews 中的一个错误。见这里：[http](http://drupal.org/node/1611106) ://drupal.org/node/1611106 。正如建议的那样，注释掉 Views 模块的 plugins.inc 中的特定第 9 行确实有效。但是，我仍然对接受成为 Views 中的错误持怀疑态度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:28:50.140

这不是 Finder；要么是 Drush 搞砸了更新，要么是您重新定位了模块，导致注册表过时。检查 views.module 是否确实存在，在系统表中启用 Views，然后按照*nmc*的建议[重建注册表。](http://drupal.org/project/registry_rebuild)

 *`views_include('base');`这应该可以解决它，但在最坏的情况下，您可以在 plugins.inc 顶部注释掉该调用，作为恢复您网站的快速破解方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T06:19:40.210

我也刚收到这个错误。有趣的是，它也是在玩 finder 模块中的设置时。准确地说，使用 ajax 设置。

无论如何，要在出现错误和白屏时恢复您的网站，请关闭浏览器并在您网站以外的页面重新打开它并清除所有浏览器缓存。然后，您应该能够再次看到您的网站。

在编辑查找器页面的表单标题下将“Ajax”设置为“是”后，它发生在我身上。重新打开浏览器并清除浏览器缓存后，直接转到作为罪魁祸首的 finder 的编辑页面，并将“ajax”设置为“no”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:01:00.897

也许注册表重建模块可以帮助你。

> 您什么时候需要重建注册表？
> 
> 你可能会得到类似的东西：
> 
> `PHP Fatal error: Class 'EntityAPIControllerExportable' not found in` `...sites/all/modules/rules/includes/rules.core.inc on line 11`
> 
> 如果在您尝试运行 update.php 时发生这种情况，并且在您尝试清除缓存时发生这种情况，那么您就有麻烦了。这就是注册表重建的目的。

我自己从未使用过它，所以我建议您在运行它之前查看代码，但我希望它对您有所帮助。

请参阅 [http://randyfay.com/node/105](http://randyfay.com/node/105)和 [http://drupal.org/project/registry_rebuild](http://drupal.org/project/registry_rebuild)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-20T16:38:34.630

For me, rebuilding the registry with `drush rr` didn't work. Disabling the module, uninstalling ad reinstalling didn't help also. The only thing which worked was to clear the `sessions` table.*

# objective-c - 确定 Objective-C 方法在运行时是否可变参数

> ID：11511585
> 
> 赞同：5
> 
> 时间：2012-07-16T19:54:41.720
> 
> 标签：objective-c, runtime, objective-c-runtime, variadic-functions, method-signature

有没有办法在运行时找出给定方法是否是可变参数类型？类似的东西`method_getTypeEncoding()`; 这不会告诉我一个方法是否接受可变数量的参数。或者有什么诀窍可以这么说？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-17T19:58:13.447

罗伯特的评论是正确的。考虑：

```
@interface Boogity
@end
@implementation Boogity
- (void)methodWithOneIntArg:(int)a {;}
- (void)variadicMethodWithIDSentinel:(id)a, ... {;}
@end 
```

在生成的二进制文件上运行`strings`（还有 stock `main()`）：

```
strings asdfasdfasdf 
Boogity
methodWithOneIntArg:
variadicMethodWithIDSentinel:
v20@0:8i16
v24@0:8@16
Hello, World! 
```

如果我将可变参数方法更改为声明为`- (void)variadicMethodWithIDSentinel:(int)a, ...`，则`strings`输出变为：

```
Boogity
methodWithOneIntArg:
variadicMethodWithIDSentinel:
v20@0:8i16
Hello, World! 
```

所以，不，没办法说。

# android - android应用程序上方或下方的按钮栏

> ID：11511590
> 
> 赞同：0
> 
> 时间：2012-07-16T19:54:48.763
> 
> 标签：android

我怎么能`Button`在我的 android 应用程序的顶部或底部放置一个栏？

也就是说，在`Activities`我的应用程序中，我想要`Button`所有这些栏中的栏。

一个快速访问的栏`Buttons`（一个按钮主页，另一个退出按钮......等）

如何实施？

非常感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:59:55.210

使用 a`RelativeLayout`您可以将`Views`它们放在 parent 的底部`View`或 parent 的顶部`View`。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relativelayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/button1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="left top of parent" />

        <Button
            android:id="@+id/button2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="right top of parent" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/button3"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="left bottom of parent" />

        <Button
            android:id="@+id/button4"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="right bottom of parent" />
    </LinearLayout>

</RelativeLayout> 
```

* * *

![在此处输入图像描述](../Images/aa7980c238f596dd1f6f98c8487564a9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:14:12.443

您可以做的是，您可以为该按钮栏创建一个新类，并将该 UI 元素包含在您的所有屏幕中。这个概念被称为片段。如果您更改片段的代码一次，它将反映在所有其他屏幕上。 [这](http://www.vogella.com/articles/Android/article.html#fragments)是关于片段的教程。

# xml - 具有递归元素的 XSL 转换

> ID：11511595
> 
> 赞同：2
> 
> 时间：2012-07-16T19:55:01.477
> 
> 标签：xml, xslt, recursion, transformation

我有一个具有大致以下结构的 XML，这里的相关特征是元素对“F”和“Child_Fs”的递归关系。“Child_Fs”可以包含任意数量的“F”，而“F”只能包含一个“Child_Fs”：

```
<A>
    <B>
        <F id="1">
            <J/>
            <K/>
            <Child_Fs>
                <F id="1.1">
                    <J/>
                    <K/>
                    <Child_Fs>
                        <F id="1.1.1">
                            <J/>
                            <K/>
                            <Child_Fs>
                                    ...
                            </Child_Fs>
                        </F>
                        <F id="1.1.2">
                            ...
                        </F>
                        <F id="1.1.3">
                            ...
                        </F>
                        <F id="1.1.4">
                            ...
                        </F>
                        .
                        .
                        .
                    </Child_Fs>
                </F>
                <F id="1.2">
                    ...
                </F>
                <F id="1.3">
                    ...
                </F>
                <F id="1.4">
                    ...
                </F>
                .
                .
                .
            </Child_Fs>
        </F>
        <F id="2">
            ...
        </F>
        <F id="3">
            ...
        </F>
        <F id="4">
            ...
        </F>
        .
        .
        .
        <G/>
        <H/>
        <I/>
    </B>
    <C/>
    <D/>
    <E/>
</A> 
```

我的实际 XML 不包含 ID，我只是在此示例中编写它们以用于说明目的。

所以我想在转换后得到以下 XML，其中所有“F”元素都是其对应的最高“F/Child_Fs”祖先的子元素。这意味着 F 元素的最大深度应仅出现两次 (F/Child_Fs/F/Childfs)。这里的另一个重要要求是保持所有数据（包括属性和文本）完好无损，这只是一个重定位操作：

```
<A>
    <B>
        <F id="1">
            <J/>
            <K/>
            <Child_Fs>
                <F id="1.1">
                    <J/>
                    <K/>
                    <Child_Fs>
                    </Child_Fs>
                </F>
                <F id="1.1.1">
                    <J/>
                    <K/>
                    <Child_Fs>
                    </Child_Fs>
                </F>
                ...
                <F id="1.1.2">
                    ...
                </F>
                <F id="1.1.3">
                    ...
                </F>
                <F id="1.1.4">
                    ...
                </F>
                .
                .
                .
                <F id="1.2">
                    ...
                </F>
                <F id="1.3">
                    ...
                </F>
                <F id="1.4">
                    ...
                </F>
                .
                .
                .
            </Child_Fs>
        </F>
        <F id="2">
            ...
        </F>
        <F id="3">
            ...
        </F>
        <F id="4">
            ...
        </F>
        .
        .
        .
        <G/>
        <H/>
        <I/>
    </B>
    <C/>
    <D/>
    <E/>
</A> 
```

如果有人能给我一个提示，我将不胜感激。直到现在我还没有想出一个正确的 XSL 样式表。

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T01:24:40.157

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="Child_Fs[ancestor::Child_Fs]">
   <xsl:apply-templates/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<A>
    <B>
        <F id="1">
            <J/>
            <K/>
            <Child_Fs>
                <F id="1.1">
                    <J/>
                    <K/>
                    <Child_Fs>
                        <F id="1.1.1">
                            <J/>
                            <K/>
                            <Child_Fs>
                                    ...
                            </Child_Fs>
                        </F>
                        <F id="1.1.2">
                            ...
                        </F>
                        <F id="1.1.3">
                            ...
                        </F>
                        <F id="1.1.4">
                            ...
                        </F>
                        .
                        .
                        .
                    </Child_Fs>
                </F>
                <F id="1.2">
                    ...
                </F>
                <F id="1.3">
                    ...
                </F>
                <F id="1.4">
                    ...
                </F>
                .
                .
                .
            </Child_Fs>
        </F>
        <F id="2">
            ...
        </F>
        <F id="3">
            ...
        </F>
        <F id="4">
            ...
        </F>
        .
        .
        .
        <G/>
        <H/>
        <I/>
    </B>
    <C/>
    <D/>
    <E/>
</A> 
```

**产生想要的正确结果：**

```
<A>
   <B>
      <F id="1">
         <J/>
         <K/>
         <Child_Fs>
            <F id="1.1">
               <J/>
               <K/>
               <F id="1.1.1">
                  <J/>
                  <K/>
                                        ...
                                </F>
               <F id="1.1.2">
                                ...
                            </F>
               <F id="1.1.3">
                                ...
                            </F>
               <F id="1.1.4">
                                ...
                            </F>
                            .
                            .
                            .
                        </F>
            <F id="1.2">
                        ...
                    </F>
            <F id="1.3">
                        ...
                    </F>
            <F id="1.4">
                        ...
                    </F>
                    .
                    .
                    .
                </Child_Fs>
      </F>
      <F id="2">
                ...
            </F>
      <F id="3">
                ...
            </F>
      <F id="4">
                ...
            </F>
            .
            .
            .
            <G/>
      <H/>
      <I/>
   </B>
   <C/>
   <D/>
   <E/>
</A> 
```

**说明**：

正确使用和覆盖**[身份规则](http://www.dpawson.co.uk/xsl/sect2/identity.html)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T01:35:20.410

只要您描述的结构保持到位，您就可以使用如下所述的相当简单的算法。如果结构变得更加自由形式，那么它就会成为一个更难的问题。

## 算法

Child_Fs 正好有 1 个祖先 F：

*   这些是收件人。他们将拉入所有后代 F

具有超过 1 个祖先 F 的 Child_Fs：

*   这些是捐助者。复制其他孩子但排除 F 孩子

d

```
<xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      exclude-result-prefixes="xsl xi">
 <xsl:output method="xml" indent="yes"/>
 <xsl:strip-space elements="*" />

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="Child_Fs[count(ancestor::F)=1]">
 <!-- Child_F which is recipient of all Fs. -->
 <xsl:copy>
  <xsl:apply-templates select="@* | node() | //F" />
 </xsl:copy>
</xsl:template> 

<xsl:template match="Child_Fs[count(ancestor::F) &gt; 1]">
 <!-- Child_F which is donor of Fs. -->
 <xsl:copy>
  <xsl:apply-templates select="@* | node()[not(self::F)]" />
 </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

# templates - D 模板请求

> ID：11511600
> 
> 赞同：1
> 
> 时间：2012-07-16T19:55:19.233
> 
> 标签：templates, inline, d

我刚刚阅读了 D 编程语言中模板的整个文档，但似乎无法为我非常简单的任务找到一种方法，对于我需要在每个函数的开头插入 3 个汇编指令的函数，我想通过一个宏，所以我不必每次都手动编写它。

```
__gshared void jump()
{
    asm{db START_KEY;}

    //bla bla bla

    asm{mov EBX, ip;add ip,4;jmp dword ptr [EBX];db END_KEY;}
} 
```

像这样的东西应该被替换为

```
__gshared void jump()
{
    mixin starttemplate();

    //bla bla bla

    mixin endtemplate();
} 
```

在 CI 中会做这样的事情

```
#define STARTASM() asm{.......} 
```

但如果我尝试这样的事情

```
template endtemplate()
{
    asm{mov EBX, ip;add ip,4;jmp dword ptr [EBX];db END_KEY;}
} 
```

它会抛出一个错误，说我必须在模板上声明一个变量（我不想这样做，因为这里绝对需要性能）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:30:29.717

将 asm 命令保存为字符串并使用 mixin 怎么样？

```
immutable string ASM_START=q{
    asm{db START_KEY;}
}
immutable string ASM_END=q{
    asm{mov EBX, ip;add ip,4;jmp dword ptr [EBX];db END_KEY;}
}

__gshared void jump()
{
    mixin(ASM_START);
    //bla bla bla
    mixin(ASM_END);
} 
```

另一种选择是使用混合来创建整个函数，并将其签名和 content(=body) 作为参数传递：

```
string functionWithAsm(string signature,string content)(){
    return Format!(q{
        %s
        {
            asm{db START_KEY;}
            %s
            asm{mov EBX, ip;add ip,4;jmp dword ptr [EBX];db END_KEY;}
        }
        },signature,content);
}

mixin(functionWithAsm!("__gshared void jump()",q{
            /*some actual code*/
            })()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:25:14.887

模板 mixins 只能包含声明（[如此处所指定](http://dlang.org/template-mixin.html)）。如果要插入任意代码，则需要字符串混合：

```
enum startTemplate = "asm{...}";
enum endTemplate = "asm{...}";

__gshared void jump()
{
    mixin(startTemplate);
    ...etc...
    mixin(endTemplate);
} 
```

您可以使用此机制插入可以使用简单 D 函数生成的自定义程序集（[由编译器在编译时执行！](http://dlang.org/function.html#interpretation)）：

```
string customAsm(string param1, bool param2)() @property
{
    string ret = "asm{";

    // append to ret, building up some code

    return ret ~ "}";
}

void myfunc()
{
    mixin(customAsm!("foo", false));
} 
```

# .net - 单击“如果较新则复制”始终下载文件

> ID：11511609
> 
> 赞同：0
> 
> 时间：2012-07-16T19:55:42.680
> 
> 标签：.net, deployment, clickonce

我的 clickonce 应用程序有一个 .ini 文件（来自 3 方 dll 的配置），必须包含在应用程序根目录中。我将文件添加为链接并标记为“内容”和“如果更新则复制”。问题是每次我部署更新时，单击一次再次下载文件会覆盖所有更改。

为什么clickonce不尊重“ `copy if newer`”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:00:14.563

> 为什么clickonce不尊重“如果更新则复制”？

因为编译器在复制到 bin（或二进制文件编译到的任何位置）时会使用它。此设置与 clickonce 无关。

我建议将您的 INI 重命名为“base.ini”或类似名称。当您的应用程序启动时，当且仅当它不存在时，将其复制到具有新名称的新文件中。像这样的东西：

```
if (!File.Exists("yourinifile.ini"))
{
    File.Copy("base.ini", "yourinifile.ini");
} 
```

**编辑**：

您可以在 ClickOnce 清单中将文件标记为数据文件。去做这个，

1.  打开项目的属性
2.  选择“发布”选项卡
3.  单击“应用程序文件...”按钮
4.  在文件列表中找到您的 INI 文件，并将发布状态更改为“数据文件”。

# haskell - 为 haskell 设置 emacs

> ID：11511610
> 
> 赞同：6
> 
> 时间：2012-07-16T19:55:45.683
> 
> 标签：haskell, emacs

您使用哪些 emacs 扩展以及如何配置它以高效工作？

PS 我使用加了 ghc-mod 的 haskell 模式。我喜欢它，但它不支持导航到符号，并且完成看起来不像 IDE，但它仍然可用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:20:24.537

在自动完成包中启用 haskell 支持 - 它将完成编译指示、函数名称等。haskell-mode 还包括对 hlint 和 haskell 扫描的支持 - 检查源代码中的“坏”代码等。在 Haskell 支持方面进行了工作CEDET，但还没有完成 :-( 在 CEDET 中实施这种支持将允许“自动”获得符号导航和代码完成，因为 CEDET 实现了这个开箱即用的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:38:10.630

[haskell wiki](http://www.haskell.org/haskellwiki/Haskell_mode_for_Emacs)上有一些信息。

# jsoup - 如何使用 jsoup 限制下载大小？

> ID：11511614
> 
> 赞同：6
> 
> 时间：2012-07-16T19:55:56.917
> 
> 标签：jsoup

我正在尝试使用 JSoup 限制下载页面/链接的大小，如下所示（Scala 代码）：

`val document = Jsoup.connect(theURL).get();`

我只想获取给定页面的前几 KB，然后停止尝试下载。如果有一个非常大的页面（或者`theURL`是一个不是 html 的链接，并且是一个大文件），我不想花时间下载其余的。

我的用例是 IRC 机器人的页面标题搜索器。

奖金问题：

有什么理由`Jsoup.connect(theURL).timeout(3000).get();`不让大文件超时？如果有人粘贴诸如永无止境的音频流或大型 ISO 之类的东西（这可以通过在不同线程中获取 URL 标题（或使用 Scala 演员并在那里超时）来解决），它最终会导致机器人退出，但是当我认为`timeout()`应该完成相同的最终结果时，对于一个非常简单的机器人来说似乎有点矫枉过正）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T20:26:34.183

现在您可以使用 maxBodySize() 方法限制版本 1.7.2 的最大身体尺寸。 [http://jsoup.org/apidocs/org/jsoup/Connection.Request.html#maxBodySize()](http://jsoup.org/apidocs/org/jsoup/Connection.Request.html#maxBodySize()) 默认限制为 1MB，这样可以防止内存泄漏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-15T02:53:21.953

奖励问题的奖励答案：超时定义为连接和套接字传输超时。因此，如果连接花费的时间少于超时时间，并且您从服务器接收数据包的频率高于超时时间，则永远不会触发超时。

我知道这不是非常直观，并且希望将其移至总已用挂钟超时。但是为了向后兼容，我可能需要使用不同的方法（征求意见）。

现在应该在 1.7.2+ 中使用最大主体大小来阻止永无止境的音频流。但是如果没有挂钟超时，它仍然会被故意缓慢的服务器捕获，这些服务器会以 3 秒的延迟一点一点地做出响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T03:41:05.280

不要以为你可以用 JSoup 做到这一点。JSoup 没有流模式（InputStream 将被转换为字符串）。

如果你想下载几 KB 的数据，我建议你使用 Apache HTTPClient 或 Ning AsyncHttpClient 来玩响应流。您可以随时停止检索数据。

# java - 压力测试 Java 应用程序代理实用程序

> ID：11511616
> 
> 赞同：1
> 
> 时间：2012-07-16T19:56:06.707
> 
> 标签：java, proxy, stress-testing, utility

我编写了一个独立的 Java 实用程序，它充当代理，在内部调用远程托管在 Tomcat JVM 上的 MBean 上的操作。（几个基于 Java 的客户端应用程序初始化它的新实例以更新 MBean）。有哪些可用的方法/工具来对该代理进行压力测试，以模拟并发用户并找出瓶颈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T20:58:58.773

I found a framework to leverage existing Junit tests with Contiperf2\. Able to run few of the tests. Seems to be promising.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:00:14.843

我会推荐**Fuzzing**

*   [http://en.wikipedia.org/wiki/Fuzz_testing](http://en.wikipedia.org/wiki/Fuzz_testing)
*   [http://www.fuzzing.org/](http://www.fuzzing.org/)
*   [https://www.owasp.org/index.php/Fuzzing](https://www.owasp.org/index.php/Fuzzing)

这种方法可以为您提供**压力测试**和**模糊 I/O 以带出可能的错误代码**（未处理的异常、内存不足等）。

# playframework - 如何在 Play 中管理 DB 相关异常！2.0/Scala 使用 Anorm

> ID：11511618
> 
> 赞同：6
> 
> 时间：2012-07-16T19:56:25.800
> 
> 标签：playframework, playframework-2.0, scala-2.8, anorm

我目前正在玩 Play 2.0 (Scala)。我必须承认这很有趣。我有一个与**数据库操作异常**有关的问题。

假设我有**Car**作为域类，并且我对其中一个字段有完整性约束，比如说**模型**，因此在数据库中我不能有两 (2) 行具有相同的模型名称：

```
case class Car(id: Pk[Long], name: String, model: String) 
```

我正在尝试像这样在数据库中插入一条记录：

```
def create(car: Car): Option[Long] = {
    DB.withConnection { implicit connection =>
      try {
          SQL("insert into cars (name, model) values ({name},{model}").on("name" -> car.name, "model" -> car.model).executeInsert()
      } catch {
          case e: Exception => {
          Logger.debug(e.getMessage())
          None
      } 
    }
} 
```

如果我没有像前面的代码那样捕获异常，那么当我从控制器调用此方法时，模型的值已经存在于数据库中，我会抛出以下异常：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException: Duplicate entry 'Enzo' for key 'model' 
```

有没有办法捕获**MySQLIntegrityConstraintViolationException**而不是**Exception**，以便我可以对可能出现的问题进行细粒度控制，然后为我的用户提供更简洁的反馈，例如（在浏览器或移动设备上）？

这是处理与数据库相关的操作和异常的最佳方法，还是每个人都使用的最佳实践？

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T09:24:15.157

我认为您看起来像以下几行：

```
import com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException

catch {
  case e:MySQLIntegrityConstraintViolationException => Logger.debug("Whoops")
  case e:Exception  => {
    Logger.debug(e.getMessage())
    None
  }
} 
```

**重要说明**：确保您导入`com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException`，而不是`com.mysql.jdbc.exceptions.MySQLIntegrityConstraintViolationException`。更准确地说，确保您的导入与堆栈跟踪中的异常匹配。

至于最佳实践，我不知道，因为我也在玩这个框架:)。

至于对用户的反馈……也许 Flash Scope 是一种将单行代码传达给“下一页”的好方法（例如，汽车是否成功存放）。请参阅：[http](http://www.playframework.org/documentation/2.0/ScalaSessionFlash) ://www.playframework.org/documentation/2.0/ScalaSessionFlash （向下滚动到“Flash 范围”。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-05T08:52:54.230

我在一个有点不同的游乐场工作，但据我所知，我解决了同样的问题。我正在使用liftweb、maven 和scala 2.9。

异常用 RuntimeException 包装。为了抓住它，我抓住了 RuntimeException 并检查了它的原因。如果它是违反约束的，我会做我的事，否则我会抛出异常。请参阅以下代码：

```
import com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException
...
  } catch {
      case e: RuntimeException => {
        e.getCause match {
          case cause: MySQLIntegrityConstraintViolationException => {
          ...
          }
          case _ => throw e
        }
      }
    } 
```

如果构建失败并出现以下错误：

```
error: object mysql is not a member of package com 
```

检查 maven pom 上 mysql 包的定义。在我的情况下，它被定义为运行时范围。将其更改为编译范围允许构建成功，并且在运行时此捕获正常工作。这是 maven pom.xml 中的 mysql 依赖部分：

```
 <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.18</version>
        <scope>runtime</scope>
    </dependency> 
```

# ms-access-2003 - 如何显示组合框中所选字段的空值计数？

> ID：11511620
> 
> 赞同：1
> 
> 时间：2012-07-16T19:56:29.170
> 
> 标签：ms-access-2003

我试过使用 DCOUNT 和 SQL，但没有任何效果。我在下面粘贴了两个查询。当我运行 SQL 时，列表框中没有任何内容。当我运行 DLOOKUP 时，我收到错误消息“运行时错误 '2001”：您取消了之前的操作。组合框名称为 ScrubbedList。表名为 Scrubbed。

DCOUNT

```
Dim strScrubbedValue As String
strScrubbedValue = Me.ScrubbedList
Dim intCountNull As Integer

intCountNull = DCount("*", "Scrubbed", "IsNull" & strScrubbedValue)
Text267 = intCountNull 
```

SQL

```
Dim strSQL As String
Dim strScrubbedValue As String

strScrubbedValue = Me.ScrubbedList
strSQL = "SELECT Count(*) As CountAll" & strScrubbedValue & " FROM Scrubbed"
strSQL = strSQL + "WHERE" & strScrubbedValue = ""
Me.List265.RowSource = strSQL 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:57:53.367

尝试：

```
 intCountNull = DCount("*", "Scrubbed", "SomeField Is Null") 
```

所以对于组合：

```
 intCountNull = DCount("*", "Scrubbed", strScrubbedValue & " Is Null") 
```

连接字符串时确保包含相关空格很重要。

```
Dim strSQL As String
Dim strScrubbedValue As String

strScrubbedValue = Me.ScrubbedList
strSQL = "SELECT Count(*) As CountAll " & strScrubbedValue & " FROM Scrubbed"
strSQL = strSQL & " WHERE " & strScrubbedValue & " Is Null"
Me.List265.RowSource = strSQL 
```

请注意，Null 和零长度字符串 (ZLS) 不同。

要同时获得两者，您可以说：

```
 strSQL = strSQL & " WHERE " & strScrubbedValue & " & '' = ''" 
```

VBA 中的字符串连接符是 &，而不是 +。加号必须小心使用，因为它可能导致意外的空值。

# android - Android可点击地图图片

> ID：11511623
> 
> 赞同：0
> 
> 时间：2012-07-16T19:56:34.930
> 
> 标签：android, imagemagick, clickable

我正在创建一个应用程序，它将作为背景美国地图。我想点击地图，无论我点击哪里，我都想创建一个小红点。但它不应该在地图边界之外创建。我可以使用 GridView 吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:28:01.067

您可以创建一个以美国地图为背景的线性布局，然后设置一个`onTouchListener`线性布局，在用户`onTouch`单击的 x 和 y 坐标上添加一个红点。像这样的东西：

```
public class MyAppActivity extends Activity {    

LinearLayout mLayout;
double x, y;    

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);       

    mLayout = (LinearLayout) findViewById(R.id.yourID); 
    mLayout.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {

            x = event.getX();
            y = event.getY();
            //Draw a ball using the x and y coordinates. You can make a separate class to do that.

            return false;
    });        

 }
} 
```

你的 xml 可能看起来像：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/yourID"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/yourUSABackGround"
    >

</LinearLayout> 
```

希望有帮助。

# regex - 注释如何在正则表达式 switch 语句的上下文中工作

> ID：11511628
> 
> 赞同：2
> 
> 时间：2012-07-16T19:56:46.547
> 
> 标签：regex, tcl

好的，所以我似乎无法弄清楚这到底是如何工作的。运行时附加的代码导致无效的命令名称“”，同时执行从“switch -regexp -- $line {”（以及文件的其余部分）中调用的“\t”（“#”arm line 1）

我遇到了这个问题，最后发现 # 正在这样做，我尝试使用 regsub 转义它（如下所示）。我可以解析字符串的唯一方法是如果我从字符串中一起删除 # （inputString 更改为删除 # 符号）。

基于 TCL 将所有行读取为文本（包括命令）的声明，我只能假设正在读取的字符串包含 # 并且无法完成该行，当然返回了错误。然而转义（尝试 1 \ 和 2 \'s）并没有做任何事情来使它更好它所做的只是将 \ 添加到我所有其他“非单词字符”（我有 - 工作正常，但现在有 \的...：S）

如果我删除或取消注释开关部分 {^[ \t] *TEST.* $} 东西工作正常。

我正在修改一个脚本并忽略了几个特定的​​案例，并决定将它们注释掉。

有人可以解释到底发生了什么，我能做些什么来解决它？似乎 .tcl 文件仍在解析 # 部分，即使它们是注释，并且感到困惑。

尝试修复

```
regsub -all {\W} $line {\\&} line; 
```

代码：

```
 proc doConversion fname {
    set inputString "* |# Bits\n*  # Bits \n";

    foreach line [split $inputString "\n"] { 
       switch -regexp  -- $line {
                # {^[ \t]*TEST.*$}
                # {
                   # # Do nothing
                # }
               default {

                       }
            }
       }

    }

doConversion "test" 
```

更新：我确实找到了这个资源，它（在一定程度上）解释了评论的混乱性质，但我想我仍然不确定我能做些什么：[“为什么我不能在 Tcl 评论中放置不匹配的大括号”](http://wiki.tcl.tk/462)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:50:17.030

我不是 100% 清楚你想要做什么，所以如果这不能回答你的问题，我提前道歉，但是：结果是，`#`除非它在某个地方需要命令，否则不表示评论. 例如，这个：

```
switch -regexp a#b {
    # {
        echo 'a#b' contains '#'
    }
} 
```

打印这个：

```
'a#b' contains '#' 
```

因为字符串`a#b`成功匹配正则表达式`#`。

由于`$line`contains `#`，您的代码：

```
 switch -regexp  -- $line {
                # {^[ \t]*TEST.*$}
                ...
            } 
```

将运行此命令：

```
^[ \t]*TEST.*$ 
```

其中（由于方括号）运行此命令：

```
\t 
```

因此您会收到一条错误消息，告诉您`"   "`（即制表符）是无效的命令名称。

如果要禁用 a 的一个分支，`switch`最好将其包装在永远不会满足的条件中：

```
 proc doConversion fname {
    set inputString "* |# Bits\n*  # Bits \n";

    foreach line [split $inputString "\n"] { 
       switch -regexp  -- $line {
               this-regexp-will-never-match {
                  {^[ \t]*TEST.*$}
                  {
                   # # Do nothing
                  }
               }
               default {

                       }
            }
       }

    }

doConversion "test" 
```

# html - 如何保证所有应用缓存资源都被下载？

> ID：11511633
> 
> 赞同：0
> 
> 时间：2012-07-16T19:56:58.973
> 
> 标签：html, offline, offline-caching

我遇到了最初似乎是间歇性问题，我的应用程序无法脱机工作。

关于我的申请的一些细节：

*   我的应用程序的入口点是登录页面
*   我的应用程序中的所有页面（登录页面除外）都显示动态数据。并且为了确保显示动态数据的页面不会被缓存，我选择只让登录页面在其 html 元素中包含 manifest 属性。
*   我的清单文件中列出的资产的总大小约为 1MB。

我为重现该问题所采取的步骤（假设我的浏览器/设备上没有缓存 applicationCache 资源）：

*   导航到登录页面（applicationCache 资源将开始下载）
*   立即登录应用程序
*   下线并请求离线资源
*   注意浏览器未能从 applicationCache 提供资源

虽然我没有任何具体的证据，但我最终发现的是离开登录页面，而浏览器正在检索 applicationCache 资产的过程中，中断了 appCache 资产的下载并导致离线时无法提供离线资源. 这是预期的浏览器行为吗？如果我等待足够长的时间并让浏览器有机会下载资产，那么离线功能就会起作用。

为了确保离线功能，我是否需要阻止用户离开登录页面，直到触发 applicationCache 缓存事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T12:41:59.713

> 这是预期的浏览器行为吗？

这确实是预期的行为。见[http://diveintohtml5.info/offline.html#debugging](http://diveintohtml5.info/offline.html#debugging)

`if even a single resource listed in your cache manifest file fails to download properly, the entire process of caching your offline web application will fail. Your browser will fire the error event, but there is no indication of what the actual problem was.`

我能想到的一种解决方案是检查`beforeunload`the`window.applicationCache.status`是否为`checking`或`downloading`.

或者您可以在用户 localStorage 中设置一个标志，指示上次尝试未成功，使用`error`事件（见下文）并尝试重新获取文件，直到所有内容都成功加载。

如果你有很多东西要缓存，你可以显示一个进度条和一些文本，要求用户在页面加载时耐心等待。对于进度条，您可以在缓存处理函数`event.loaded`的`event.total`进度事件中使用。

```
var appCache = window.applicationCache;

// Fired after the first cache of the manifest.
appCache.addEventListener('cached', handleCacheEvent, false);

// Checking for an update. Always the first event fired in the sequence.
appCache.addEventListener('checking', handleCacheEvent, false);

// An update was found. The browser is fetching resources.
appCache.addEventListener('downloading', handleCacheEvent, false);

// The manifest returns 404 or 410, the download failed,
// or the manifest changed while the download was in progress.
appCache.addEventListener('error', handleCacheError, false);

// Fired after the first download of the manifest.
appCache.addEventListener('noupdate', handleCacheEvent, false);

// Fired if the manifest file returns a 404 or 410.
// This results in the application cache being deleted.
appCache.addEventListener('obsolete', handleCacheEvent, false);

// Fired for each resource listed in the manifest as it is being fetched.
appCache.addEventListener('progress', handleCacheEvent, false);

// Fired when the manifest resources have been newly redownloaded.
appCache.addEventListener('updateready', handleCacheEvent, false);

function handleCacheEvent(e){
    if(e.type && (e.type=='progress' || e.type=='ProgressEvent')){
        console.log('percent:', Math.round(e.loaded/e.total*100)+'%', 'total:', e.total, 'loaded:',e.loaded);
    }
} 
```

# .net - 列出 2 个 DateTimes 中的可用时间

> ID：11511634
> 
> 赞同：7
> 
> 时间：2012-07-16T19:57:00.323
> 
> 标签：.net, sql, vb.net, sql-server-2008

我知道这可能会让人有些困惑，我只是想考虑一下最好的表达方式！我现在已经在几个论坛上发布了这个，但我似乎没有任何运气。希望有人可以就如何做到这一点提供一些建议。

**示例表 (tbl_Bookings)**

```
ID  DateStarted       DateEnded         RoomID
1   16/07/2012 09:00  16/07/2012 10:00    1
2   16/07/2012 12:00  16/07/2012 13:00    1 
```

基本上，我想输入 2 个日期时间，例如 16/07/2012 08:30 和 16/07/2012 13:30，它会查询我上面的示例表并返回“可用”时间，IE，我会喜欢它输出以下内容。

```
16/07/2012 08:30 - 16/07/2012 09:00
16/07/2012 10:00 - 16/07/2012 12:00
16/07/2012 13:00 - 16/07/2012 13:30 
```

我的问题是，这在 SQL 中完全可能吗？我试图考虑如何在 VB 中做到这一点，我也在努力解决这个问题。我的想法/尝试一直在使用 Ron Savage 的 fn_daterange（如下图所示）

```
if exists (select * from dbo.sysobjects where name = 'fn_daterange') drop function fn_daterange;
go
create function fn_daterange
(
@MinDate as datetime,
@MaxDate as datetime,
@intval  as datetime
)
returns table
as
return
WITH times (startdate, enddate, intervl) AS
(
SELECT @MinDate as startdate, @MinDate + @intval - .0000001 as enddate, @intval as intervl
UNION ALL
SELECT startdate + intervl as startdate, enddate + intervl as enddate, intervl as intervl
FROM times
WHERE startdate + intervl <= @MaxDate
)
select startdate, enddate from times;
go 
```

然后我打算使用下面的方法来调用它，但我的问题是，me.DateEnded 在 dr.enddate 之外，因此发生率为“0”：

```
SELECT dr.startdate, dr.enddate, count(me.DateStarted) as occurrence
FROM fn_daterange('16/07/2012 08:30', '16/07/2012 13:30', '00:30:00' ) dr
LEFT OUTER JOIN tbl_Bookings me
ON me.DateStarted BETWEEN dr.startdate AND dr.enddate
AND me.DateEnded BETWEEN dr.startdate AND dr.enddate)
GROUP BY dr.startdate, dr.enddate 
```

任何人都可以提出更好的方法，或者希望为我目前尝试的方式提供解决方案吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:00:59.617

我相信我在 SQL 中有一个可行的解决方案。这假设数据`tbl_Bookings`是一致的，即给定房间的开始/结束时间没有重叠。可能是一种更简单的方法，但诀窍是订购预订并将结束时间与以下开始时间配对。`Start`在您指定之后但在第一次预订之前，有两个额外的查询联合起来获取任何间隔。同样对于`End`.

**编辑：**在最后两个查询中添加`WHERE NOT EXISTS`了警卫，以防万一`@Start`或`@End`落在预定的时间间隔内。

```
DECLARE @Start DateTime = '05/07/2012 08:30'
DECLARE @End DateTime = '05/07/2012 13:30'

;WITH Bookings (RoomId, RowNum, Started, Ended) AS (
     SELECT RoomId,
     ROW_NUMBER() OVER (PARTITION BY RoomId ORDER BY DateStarted) AS RowNum,
     DateStarted, DateEnded
     FROM tbl_Bookings
)
SELECT RoomId, B.Ended AS S, C.Started AS E
FROM Bookings B
CROSS APPLY (
    SELECT B2.Started FROM Bookings B2
    WHERE B2.RowNum = B.RowNum + 1
    AND B2.Started <= @End
    AND B2.RoomId = B.RoomId
) C
WHERE B.Ended >= @Start

UNION

-- Show any available time from @Start until the next DateStarted, unless @Start 
-- falls within a booked interval.
SELECT RoomId, @Start, MIN(DateStarted)
FROM tbl_Bookings
WHERE DateStarted > @Start
    AND NOT EXISTS (
        SELECT 1 FROM Bookings WHERE Started < @Start AND Ended > @Start
    )
GROUP BY RoomId

UNION

-- Show any available time from the last DateEnded to @End, unless @End 
-- falls within a booked interval.
SELECT RoomId, MAX(DateEnded), @End
FROM tbl_Bookings
WHERE DateEnded < @End
    AND NOT EXISTS (
        SELECT 1 FROM Bookings WHERE Started < @End AND Ended > @End
    )
GROUP BY RoomId 
```

工作[SqlFiddle](http://sqlfiddle.com/#!3/24476/4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:58:54.643

我会用以下逻辑来解决这个问题。为所需的开始时间和您在数据中看到的第一个开始时间之间的时间段创建一条记录（如果有）。为所需结束时间和您在数据中看到的最后一个结束时间之间的时间段创建一条记录（如果有）。然后，为您拥有的时间创建中间记录。

下面的查询有这个想法。我不确定当所需的开始时间和结束时间在预定期间的中间时它是否有效。

```
with const as (select @starttime as StartTime, @endtime as EndTime)
select *
from ((Select c.StartTime, MIN(DateStarted), RoomId
       from tbl_Bookings b cross join const c
       where b.DateStarted >= c.StartTime
       group by RoomID
       having c.StartTime <> MIN(DateStarted)
      ) union all
      (Select max(DateEnded), c.EndTime, RoomId
       from tbl_Bookings b cross join const c
       where b.DateEnded <= c.EndTime
       group by RoomID
       having c.EndTime <> max(DateEnded)
      ) union all
      (select *
       from (select b.DateEnded as DateStarted, min(b.DateStarted) as DateEnded
             from tbl_Bookings b join
                  tbl_Bookings bnext
                  on b.RoomId = bnext.RoomId and
                     bnext.DateStarted > b.DateStarted cross join
                  const c
             where b.DateStarted < c.endtime and
                   b.DateEnded > c.StartTime and
                   bnext.DateStart < c.EndTime and
                   bnext.DateEnded > c.StartTime
             group by b.DateEnded
            ) b cross join const c
       where DateStarted <> DateEnded
      )
     ) 
```

最后一个子查询相当复杂。它正在执行自连接以获得与lead() 函数等效的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:46:25.940

我不知道如何使用集合解决问题，但以下基于光标的方法应该可以工作。这就是你在 VB 或 C# 中的做法：

```
CREATE FUNCTION GetAvailableTimes
(
    @MinDate datetime,
    @MaxDate datetime
)
RETURNS @result TABLE
(
    DateStarted datetime,
    DateEnded datetime,
    RoomID int
)
AS
BEGIN
    DECLARE @DateStarted datetime
    DECLARE @DateEnded datetime
    DECLARE @CurrentDate datetime
    DECLARE @RoomID int
    DECLARE @CurrentRoom int

    DECLARE c CURSOR FOR
        SELECT DateStarted, DateEnded, RoomID 
        FROM tbl_Bookings 
        WHERE DateStarted BETWEEN @MinDate AND @MaxDate
            OR DateEnded BETWEEN @MinDate AND @MaxDate
        ORDER BY RoomID, DateStarted

    SET @CurrentRoom = 0

    OPEN c
    FETCH NEXT FROM c
    INTO @DateStarted, @DateEnded, @RoomID

    WHILE @@FETCH_STATUS = 0
    BEGIN

        IF @CurrentRoom <> @RoomID BEGIN
            IF @CurrentRoom <> 0 AND @CurrentDate < @MaxDate BEGIN
                INSERT INTO @result VALUES (@CurrentDate, @MaxDate, @CurrentRoom)
            END

            SET @CurrentDate = @MinDate
            SET @CurrentRoom = @RoomID
        END

        IF @CurrentDate < @DateStarted BEGIN
            INSERT INTO @result VALUES (@CurrentDate, @DateStarted, @CurrentRoom)
        END

        SET @CurrentDate = @DateEnded

        FETCH NEXT FROM c
        INTO @DateStarted, @DateEnded, @RoomID
    END
    CLOSE c
    DEALLOCATE c

    IF @CurrentRoom <> 0 AND @CurrentDate < @MaxDate BEGIN
        INSERT INTO @result VALUES (@CurrentDate, @MaxDate, @CurrentRoom)
    END

    RETURN
END 
```

下面的调用现在将为您提供您正在寻找的测试数据的结果。

```
SELECT * FROM dbo.GetAvailableTimes('20120716 8:30', '20120716 13:30') 
```

我还假设可能有不止一个房间，并且您正在寻找所有房间的可用时间。

我只是快速测试了该功能，因此我很确定仍有一些边界情况没有得到妥善解决。但你应该明白这一点。

# xpages - 在点击事件上触发文件上传控制 - xpage

> ID：11511635
> 
> 赞同：1
> 
> 时间：2012-07-16T19:57:06.843
> 
> 标签：xpages

谁能建议在 IE 中的 OnClick 或 Onfocus 事件期间如何在 Xpage 中触发文件上传控制？它在 Firefox 中默认工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T15:07:43.667

严格来说，当一个人在File Upload控件中选择一个文件时，与该文件关联后，就准备上传（请求阶段数据）。本机控件有一些我希望在将来的版本中缺少的东西，但基本上是为了实现“上传”按钮功能，我建议出于以下原因，您应该：

*   创建一个触发完全刷新的按钮控件（如果 fileUpload 控件的 SSJS getFilename() 为 true，则返回 true）；请注意，它必须是完全刷新！
*   确保在选中“未经验证的处理数据”的情况下运行它（又名 disableValidators="true"）

您的按钮应如下所示：

```
    <xp:button value="上传" id="button1">
        <xp:eventHandler event="onclick" 提交="true"
        refreshMode="complete" disableValidators="true">
        <xp:this.action><![CDATA[#{javascript:
    getComponent("fileUpload1").getFilename()?true:false}]]></xp:this.action>
        </xp:eventHandler>
    </xp:按钮>

```

我遇到的所有用户都*期待*一个“上传”按钮。我并不是说这是最好或最优化的方式，但这是人们所寻求的。我的经验告诉我要迎合用户的期望。他们的期望可能是错误的，但至少在我们在这里所做的事情的背景下是有意义的。

我确信有一种方法可以自动触发完全刷新，可能使用 onComplete 事件。我不确定这是否可能是 xp:fileUpload 控件的 onBlur 事件，或者是 getComponent("fileUpload1").getFilename() 值的不同侦听器。也许是更有经验的 XPage Dev。可以具体回答。

希望这可以帮助。

# php - API 响应用奇怪的字符填充

> ID：11511637
> 
> 赞同：1
> 
> 时间：2012-07-16T19:57:10.933
> 
> 标签：php, api, encoding

我找到了一个返回随机字典单词的 API。

```
http://randomword.setgetgo.com/get.php 
```

虽然我跑了一个

```
file_get_contents("http://randomword.setgetgo.com/get.php") 
```

我收到的回复是：

```
ï»¿antitragal 
```

字符串前面的这些字符是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:01:21.757

那是一个 UTF-8 BOM [http://en.wikipedia.org/wiki/Byte_order_mark](http://en.wikipedia.org/wiki/Byte_order_mark)

# android - Android MapView POI 缓存策略

> ID：11511638
> 
> 赞同：1
> 
> 时间：2012-07-16T19:57:24.957
> 
> 标签：android, google-maps, caching, android-mapview

我有一个 Android 应用程序，它在启动时会膨胀 MapView，获取用户的位置，然后向我的服务器发出请求，以在其位置的某个半径范围内以 JSON 格式获取所有兴趣点 (POI)，并在地图上绘制这些点。我希望用户能够在地图上平移并在超出初始数据负载时看到更多的兴趣点负载，就像谷歌地图一样。

我最初的想法是处理平移事件，当平移停止时，获取地图中心，并在该位置的某个半径范围内向 POI 发出另一个服务器请求。在我看来，这将很快达到发送冗余数据并发出不必要的服务器请求的地步。

我正在寻找一种缓存策略，我可以在其中发出获取新数据的请求，但不必对相同的数据发出额外的请求。我的 POI 也不会经常更改，因此缓存将是加速我的应用程序后续启动的理想选择。有没有针对这种事情的最佳实践？还是更喜欢预先提出更大的数据请求并在必要时获取新数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T16:45:49.230

例如，我不由自主地想到将 POI 划分为方形瓷砖。这些切片具有 lastUpdate 时间戳，客户端和服务器都根据切片进行通信，而不是地理位置中心点和半径。您的客户端将始终将缓存切片的 lastUpdate 时间戳发送到服务器，并且服务器只会在请求切片的时间戳确实发生更改时以更新的数据进行响应。另一个优点是，与“圆点”计算相比，检索 POI 的算法要快得多。

您的客户端应用程序可以根据时间戳决定何时重新请求磁贴。这取决于您的服务器数据更改的频率。如果它每天只更改一次，那么让您的应用程序每天只重新请求一次缓存切片。我的建议是基于固定大小的瓷砖（例如 2 平方英里）。否则，您将很难跟踪 lastUpdate 时间戳。但是，您可以为缩放级别创建几个不同的“细节级别”，或者您的应用程序需要根据当前缩放计算左上角可见图块和右下角可见图块。

# google-app-engine - gwt 示例项目 rpc 调用失败

> ID：11511641
> 
> 赞同：1
> 
> 时间：2012-07-16T19:57:29.780
> 
> 标签：google-app-engine, gwt

当我尝试运行 gwt 示例项目时，它给出“RPC 调用失败。尝试联系服务器时发生错误。请检查您的网络连接并重试”。它之前运行良好，但在我更新程序和库之后它给出了该错误。哪个更新导致此错误或有其他原因？

Appengine 版本：1.7.0 GWT 版本：2.4.0 Eclipse 版本：4.2(juno) JDK 版本：1.7.0_05

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:23:04.800

这可能不是您面临的问题，但它似乎是最常见的问题。

让我预测一下——你上一次尝试 GWT 是在四年前，你囤积了示例项目，希望有一天能把它拿出来。

昨天，你确实把它拉出来了。它有点工作，然后你决定升级到最新的 2.4.0。（其实最新的是2.5.0-rc1）。

哎呀。您项目的 web-inf/lib 仍然忠实地使用 2.2 版之前的 gwt-servlet jar。

不，你不能那样做。GWT-RPC 数据传输格式是版本不稳定的。不保证从一个版本到下一个版本兼容。

简单的解决方案 - 使用新的 Google 插件重新创建一个新的 GWT 项目。然后将你项目的src和web.xml复制到新项目中。

或者用最新的替换 gwt-servlet.jar。如果你使用 gwt-servlet-deps.jar，你也需要升级它（但我怀疑，因为如果你确实使用了 gwt-servlet.deps.jar，你就不会问这个问题）。

**但是为什么**要保留旧项目中的 gwt 样本呢？

多年来，样本一直保持不变。为什么不使用新 GWT 2.4.0 下载中的示例。您不必保留样品。您应该尝试重新构建示例项目。

GWT 目录位于 Eclipse 的 plugins 目录下，名称很长。喜欢

插件/com.google.gwt.eclipse.sdkbundle_2.4.0.v201205091048-rel-r37/gwt-2.4.0。

您将在其中找到示例目录。

# ruby-on-rails-3 - 试图将社区引擎集成到我的应用程序中

> ID：11511644
> 
> 赞同：6
> 
> 时间：2012-07-16T19:57:59.027
> 
> 标签：ruby-on-rails-3

# 错误

```
Bundler could not find compatible versions for gem "multi_json":
  In Gemfile:
    community_engine (>= 0) ruby depends on
      multi_json (~> 1.0.0) ruby

    uglifier (>= 1.0.3) ruby depends on
      multi_json (1.3.6) 
```

# 宝石文件

```
gem 'rails', '3.2.6'
gem 'sqlite3'
gem 'json'
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end
gem 'jquery-rails'
gem 'community_engine', :github => 'bborn/communityengine', :branch => 'rails3' 
```

# 怀疑

尽管遵循社区引擎自述文件中的所有说明，但总是给出相同的错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T13:59:33.303

加入`gem "multi_json"`Gemfile

删除 Gemfile.lock 文件

然后运行`bundle install`

这帮助我克服了上述错误。

# javascript - 从具有特定类的跨度中获取文本

> ID：11511650
> 
> 赞同：0
> 
> 时间：2012-07-16T19:58:15.963
> 
> 标签：javascript, jquery

我有下面的 HTML 和 JQuery 代码，我需要一些帮助来执行以下操作，我有一些带有运费类型的单选按钮，当用户选择其中一个时，我需要得到它的价格，它在类的范围内`price`. 我试过使用[`.closest()`](http://api.jquery.com/closest/)，但我得到了空结果（JQuery v1.7.2）。任何人都可以帮我得到这个吗？

**HTML**

```
<div class="freight">
    <input type="radio" name="freight-type" id="FX" value="FX" />
    <label for="FX">
        <span class="blue">Fedex</span>- 
        <strong>US$ <span class="price">12.42</span> </strong>
        <span class="small-text"> (Delivery time: <strong>3 business days)</strong></span>
    </label>
</div> 
```

**jQuery**

```
$("input[name=freight-type]").change(function() {

    alert( $(this).closest(".price").text() )

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:03:33.280

[http://jsfiddle.net/4AEyp/](http://jsfiddle.net/4AEyp/)

一个例子

```
$("input[name='freight-type']").change(function() {
   alert($(this).parent().find('.price').text());
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:02:35.360

试试这个：

```
$("input[name=freight-type]").change(function() { 
    alert( $(this).parent().find(".price:first").text() )
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:11:43.403

close() 向上遍历 DOM 树，因此它会开始在 div.fregith 中查找，然后从那里向上遍历 DOM 树。

试试这个作为你的选择器：

```
$(this).next('label').find('.price') 
```

# html - 字段集上的第一个孩子问题

> ID：11511655
> 
> 赞同：1
> 
> 时间：2012-07-16T19:58:56.827
> 
> 标签：html, css

我如何到达第一个字段集。我试过这个。

```
#enterAccountInfo fieldset:first-child{
} 
```

也试过这个：

```
#enterAccountInfo:first-child fieldset{
} 
```

以上似乎都不起作用。

```
<div id="wrapper">
  <form id="enterAccountInfo">
        <fieldset class="even">
            <div class="centerWarpper">
                <h2 class="subtitle">blaa</h2>
         </div>
        </fieldset>
        <fieldset class="odd">
            <div class="centerWarpper">
                <h2 class="subtitle">bllll</h2>
         </div>
        </fieldset>
        <fieldset class="even">
            <div class="centerWarpper">
                <h2 class="subtitle">bllll</h2>
         </div>
        </fieldset>
        <fieldset class="odd">
            <div class="centerWarpper">
                <h2 class="subtitle">bllll</h2>
         </div>
        </fieldset>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:29:58.807

第一种选择是正确的，并且有效。如果不是，则问题出在其他地方，您需要发布更完整的代码，并确定测试的浏览器。检查您是否拥有准确的代码，并使用[W3C CSS Validator](http://jigsaw.w3.org/css-validator/)检查任何语法错误。

第一种选择是指作为`fieldset`元素的第一个子元素的元素`id="enterAccountInfo"`，即你想要的。

第二种选择指的是`fieldset`元素内部的任何元素，`id="enterAccountInfo"`如果后者是其父元素的第一个子元素（就像这里一样），所以它选择`fieldset`这里的所有元素——现在不是你想要的。

# ruby-on-rails - Tweetstream 和 Rails - 无法得到任何回应

> ID：11511656
> 
> 赞同：0
> 
> 时间：2012-07-16T19:58:56.737
> 
> 标签：ruby-on-rails, twitter, tweetstream

我正在为 Rails 使用 Tweetstream gem，并且一直卡在等待任何更新..

我基本上做了这个例子（当然还有我的 oauth 数据等）：

```
 require 'Tweetstream'

TweetStream.configure do |config|
  config.consumer_key       = 'consumer_key'
  config.consumer_secret    = 'secret'
  config.oauth_token        = 'token'
  config.oauth_token_secret = 'token_secret'
  config.auth_method        = :oauth
end

TweetStream::Client.new.sample do |status|
      puts "SOMETHING HERE?"
  puts "#{status.text}"
end 
```

什么都没有发生......控制台只是永远等待任何事情发生......

甚至没有“这里有什么？” 正在打印..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T20:33:02.997

我会大胆猜测并说您将其放入初始化程序中？宝石不能以这种方式工作。TweetStream 是一个基于事件的库，并且具有与 Rails 应用程序不同的运行时配置文件。

您需要将 TweetStream 与 Rails 一起运行，作为收集推文的守护进程，将它们存储在数据库中，Rails 将访问同一个数据库。

使用 Rails Runner (http://guides.rubyonrails.org/command_line.html#rails-runner) 在 Rails 上下文中运行您的 TweetStream 守护程序，这应该可以让您访问模型。

# ant - 修改现有任务以添加新依赖项

> ID：11511657
> 
> 赞同：1
> 
> 时间：2012-07-16T19:58:57.237
> 
> 标签：ant

是否可以修改任务并为其添加先决条件？例如，我有一个`build.xml`要导入的外部文件。它包括一个调试任务。我想将依赖项添加`-prebuild-copy`到该任务。

我只会创建一个包装器任务，但我的项目包含的任何库都会调用调试目标，我需要确保为所有库`-prebuild-copy`运行该目标。我可以复制和修改另一个构建文件，但它是 android 附带的，我不想在每次更新 SDK 时都尝试更新我的自定义版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T18:51:57.597

ANT 有两个用于导入通用构建逻辑的任务：

*   [进口](http://ant.apache.org/manual/Tasks/import.html)
*   [包括](http://ant.apache.org/manual/Tasks/include.html)

以下示例使用更现代[的 include](http://ant.apache.org/manual/Tasks/include.html)。

# 例子

```
|-- build-common.xml
`-- build.xml 
```

项目运行如下

```
$ ant debug
Buildfile: /home/mark/tmp/build.xml

-prebuild-copy:
     [echo] PREBUILD TARGET

common.debug:
     [echo] I AM A DEBUG TARGET

debug:
     [echo] MY DEBUG TASK 
```

## 构建-common.xml

```
<project name="build-common">

    <target name="debug">
        <echo message="I AM A DEBUG TARGET"/>
    </target>

</project> 
```

## 构建.xml

```
<project name="demo" default="debug">

    <include file="build-common.xml" as="common"/>

    <target name="-prebuild-copy">
        <echo message="PREBUILD TARGET"/>
    </target>

    <target name="debug" depends="-prebuild-copy, common.debug">
        <echo message="MY DEBUG TASK"/>
    </target>

</project> 
```

# css - Django CSS 元素未按预期对齐

> ID：11511664
> 
> 赞同：0
> 
> 时间：2012-07-16T19:59:15.640
> 
> 标签：css, django-templates

我创建了一个带有下面给出的页眉、横幅、页脚的 html 文件。我试图对齐导航链接，但由于某种原因它没有对齐内联。问题在于导航 ID。任何帮助都会有很大帮助。

Base.html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "XHTML1-s.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head> 
     <title>DJANGO E-Commerce website</title>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
     <title>{% block title %}{% if page_title %}{{ page_title }} - {% endif %} ?     
          {{ site_name }}{% endblock %}</title> 
     <meta name="keywords" content="{{ meta_keywords }}" /> 
     <meta name="description" content="{{ meta_description }}" />
     <link rel="Stylesheet" type="text/css" href="{{ MEDIA_URL }}css.css" />
     <!-- <link rel="stylesheet" href="/site_media/css.css"
        type="text/css" />  -->

    <!--<script src="/site_media/jquery.js" type="text/javascript"></script>-->
</head> 
<body> 
    {% block site_wrapper %}{% endblock %} 
</body>
</html> 
```

目录.html

```
{% extends "base.html" %} 
{% block site_wrapper %} 
<div id="main"> 
     <a href="#content" class="skip_link">Skip to main content</a> 
     <div id="banner"> 
          <div class="bannerIEPadder"> 
               <div class="cart_box"> 
                [link to cart here] 
                </div>
              Modern Musician 
          </div> 
     </div> 
     <div id="navigation"> 
          <div class="navIEPadder"> 
                {% include "tags/navigation.html" %}
          </div> 
     </div> 
     <div id="middle"> 
          <div id="sidebar"> 
               <div class="sidebarIEPadder"> 
                [search box here] 
               <br /> 
                {% include "tags/category_list.html" %} 
               </div> 
          </div> 
          <div id="content"> 
               <a name="content"></a> 
               <div class="contentIEPadder"> 
                    {% block content %}{% endblock %} 
               </div> 
          </div> 
     </div> 
     <div id="footer"> 
          <div class="footerIEPadder"> 
               [footer here] 
           </div> 
     </div> 
</div> 
{% endblock %} 
```

导航.html

```
<u1>
    <li><a href="/catalog/">Home</a></li>
    <li><a href="/catalog/">About</a></li>
    <li><a href="/catalog/">Privacy</a></li>
    <li><a href="/catalog/">Products</a></li>
    <li><a href="/catalog/">Contact</a></li>
</u1>
<div class="cb"></div> 
```

css.css

```
*{ 
    margin:0; 
    padding:0; 
}

html{ 
    font-size:medium; 
} 

html,body{ 
    background-color:Blue;
}

.cb{ 
    clear:both; 
} 

.fr{ 
    float:right; 
}

.fl{ 
    float:left; 
}

.bn{ 
    border:none; 
}

#main{ 
     margin: 0 auto; 
     width:900px; 
     background-color:White; 
} 

.bannerIEPadder, .sidebarIEPadder, .contentIEPadder{ 
     padding:10px;  
}

.navIEPadder, .footerIEPadder{ 
     padding:5px; 
}

#banner{ 
     width:900px; 
     height:75px; 
     background-color:DarkOrange; 
     color:White; 
     font-size:36px; 
     font-weight:bold; 
     position:relative; 
}

div.cart_box{ 
     position:absolute; 
     top:20px; 
     right:10px; 
     font-size:medium; 
}

div.cart_box a{ 
     color:white; 
} 

#sidebar{ 
     width:200px; 
     float:left;
}

#content{ 
     width:700px; 
     float:left; 
}

#footer{ 
     clear:both; 
     background-color:#98AC5E; 
     color:White; 
     text-align:center; 
}

a.skip_link{ 
     position:absolute; 
     left:-1000px; 
     top:-1000px; 
} 

#navigation ul{
    list-style-type:None;
    margin:0;
    padding:0;
}

#navigation ul li{
    float:left;
    margin-right:15px;
    display:inline;
}

#navigation ul li a{
    color:White;
    font-weight:bold;
    text-decoration:underline;
    display:inline;
}

#navigation ul li a:hover{
    color:#616161;
    background-color:Red;
    text-decoration:none;
}

a{ 
     color:#98AC5E; 
     font-weight:bold; 
     text-decoration:none; 
} 
a:hover{ 
     text-decoration:underline; 
} 

/* category page styles */ 
div.product_thumbnail{ 
     text-align:center; 
     float:left; 
     width:150px; 
     height:200px; 
} 

/* product page styles */ 
div.product_image{ 
     float:left; 
     padding:0 10px 10px 0; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:22:24.493

我认为你不需要在你的李上显示：内联。

您还应该将 float:left 放在导航 UL 中的“a”标签上，并删除它们上的 display:inline。

你也可以把overflow:auto放在类'navIEPadder'上。

希望有帮助。

# css - DIV定位问题

> ID：11511667
> 
> 赞同：0
> 
> 时间：2012-07-16T19:59:35.163
> 
> 标签：css, css-float, css-sprites

在此[页面](http://gloucestercountykarate.com/martial-arts/)上添加空手道图像后，它会从徽标上切掉一些块。我尝试使用`z-index`负边距，但它并没有解决问题。我希望标志留在空手道图像的顶部。CSS如下所示：

```
#rack #header #logo {

    float: left;
    height: auto;
    width: auto;
    margin-bottom: -54px;
    z-index: -999;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:01:42.543

`z-index`仅适用于`position:relative`or `position:absolute`。

用这个，

```
#rack #header #logo {    
    float: left;
    height: auto;
    width: auto;
    margin-bottom: -54px;
    z-index: 100;
    position: relative;
} 
```

# osgi - 如何将 OSGI 捆绑包添加到 JBOSS AS 7.1.1.Final

> ID：11511683
> 
> 赞同：1
> 
> 时间：2012-07-16T20:00:29.573
> 
> 标签：osgi, eclipselink, jboss7.x

我正在尝试将 OSGI 捆绑包添加到 JBOSS AS 7.1.1.Final。这甚至有意义吗？我要添加的包是：[EclipseLink 2.4.0 OSGi Bundles Zip](http://www.eclipse.org/eclipselink/downloads/)。是否有捷径可寻？

我猜我可能会为每个 jar 创建模块条目，但这似乎不是正确的做法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T07:45:40.707

由于 JBoss 本身是在 Apache Felix 之上开发的：是的，有一个简单的方法；）只需启动您的 JBoss 实例（独立）：

1.  转到管理网页（主要是 localhost:8080）
2.  在*运行时操作*下单击*OSGi*
3.  如果系统询问您是否启动 OSGi，请启动它。如果你已经拥有了，你会看到一大堆已安装的捆绑包
4.  现在复制你想要添加到你的 JBoss 实例的包
5.  现在转到您的 JBoss 主文件夹，选择文件夹*jboss-as-7.1.1.Final\standalone\deployments*并将您复制的包粘贴到其中
6.  您的捆绑包将在您将其粘贴到每个 hotdeploy 的文件夹中时部署

也许您已经注意到主要步骤（部署 4-6）与部署 war 文件的步骤相同。通过管理页面也可以进行部署。

# sql-server - MDF 文件缺少扩展名

> ID：11511684
> 
> 赞同：0
> 
> 时间：2012-07-16T20:00:43.760
> 
> 标签：sql-server, database-restore, mdf

我已将 4 个数据库恢复到我的新 SQL 2008 R2 服务器中。两个数据库来自 SQL 2000 备份，另外两个来自 SQL 2005。为什么当我查看存储行数据文件的文件夹并查看文件下的数据库属性时，2000 数据库文件的 MDF 扩展名为类型 SQL 数据库主数据文件，来自 2005 年的那些没有“文件”类型的扩展名？

所有数据库都正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:03:09.873

我猜是因为这些文件在 Windows 资源管理器中没有 .mdf 扩展名。这不一定是一件可怕的事情，它只是意味着建立原始数据库的人`CREATE DATABASE`在命名物理文件名时使用了一个语句并且忘记了使用扩展名。

如果你想解决这个问题，你可以按照这个过程：

```
ALTER DATABASE whatever SET OFFLINE;

ALTER DATABASE whatever MODIFY FILE (name = 'logical_name', 
  filename = 'path with .mdf added to the end');

-- repeat for log file with .ldf extension 
```

现在手动重命名 Windows 资源管理器中的文件，添加扩展名。

然后：

```
ALTER DATABASE whatever SET ONLINE; 
```

缺少扩展名的至少一个问题是，如果您正在运行病毒或恶意软件，并且它被设置为忽略 SQL Server 文件，例如，它不能忽略没有扩展名的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-05T12:34:25.347

数据库可以有三个文件作为它的内部部分，它们是 1).mdf 文件 2).ldf 文件
3).ndf 文件 默认数据文件是 MDF，日志文件是 LDF。其他数据文件通常具有 .NDF 扩展名。

# php - 字符串到整数转换的 PHP 编码类型

> ID：11511695
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:01:23.637
> 
> 标签：php, encoding

我想知道如何从包含字母和数字的字符串中生成一个数字。要求是相同的字符串必须始终生成相同的数字。

我试图在 PHP 中找到一种编码类型，它返回一个字符串的整数。

我不需要将其转换回字符串。有没有这样的编码可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:12:12.337

我想我得到了解决方案。

我一直在寻找类似 crc32 的东西。它给了我一个字符串的整数。

谢谢你们的帮助，我很抱歉再次不清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:14:51.453

您正在寻找一个[散列函数](http://en.wikipedia.org/wiki/Hash_function)。我在这里发布了一个示例算法，用于从字符串中生成一个小数：

```
// making hex hash from sentence
$s = hash( 'ripemd160', "I'm a dog" );

// taking last 5 hex digits
$s2 = substr( $s, -5 );

// converting hex digits to number
echo hexdec( $s2 ); 
```

示例算法说明：

*   从一个字符串做一个[哈希。](http://php.net/manual/en/function.hash.php)'ripemd160' 是哈希算法的名称，其他哈希算法：“md5”、“sha256”、“haval160,4”等。“I'm a dog”是要哈希的句子样本。
*   从散列中只取几位数字就可以取一个小数字。为此，我[取最后 5 位数字](http://php.net/manual/en/function.substr.php)。
*   最后将[十六进制数字转换为数字](http://php.net/manual/en/function.hexdec.php)。

请注意，这只是从字符串生成数字的多种方法的示例。

**测试：**

```
dani@egg-v2:~$ php5
<?php
$a=array( "I'm a dog", "I'm a cat", "I'm a car" );
foreach ($a as $e) {
   $s = hash( 'ripemd160', $e) ;
   $s2 = substr( $s, -5 );
   echo "Hash of $e: " . hexdec( $s2 ) . "\n";
}
?>
Hash of I'm a dog: 147508
Hash of I'm a cat: 23112
Hash of I'm a car: 563887  <-- little change in string but big change in number 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:16:39.417

整数只能存储有限数量的数据，而字符串可能存储的数据远不止这些。如果您将字符串转换为整数，不知何故，它总是会与其他东西发生冲突（用两个词来说，它不是唯一的！）....最好选择其他东西（可能是加盐的 MD5？）！

# android - 防止 Thread.sleep 使屏幕变黑

> ID：11511696
> 
> 赞同：0
> 
> 时间：2012-07-16T20:01:24.853
> 
> 标签：android

我想在开始视频之前加载布局后在我的创建中插入一个暂停。

在开始视频之前，布局会加载我想要显示 3 秒的图像。

这是我尝试过的（此代码在`onCreate`方法中）

```
 setContentView(R.layout.layout_name);
      try {
          Thread.sleep(3000);
      } catch ...
           ...
      }
      startVideo(); 
```

问题是呼叫`Thread.sleep`使显示器变黑，然后视频开始。

如何让屏幕不黑屏？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:06:33.950

您正在阻止 UIThread 这就是导致它变为空白的原因...用`try {...}`以下内容替换您的块：

```
new Handler().postDelayed(new Runnable() {

        @Override
        public void run() {
            startVideo();
        }
    }, 3000); 
```

并考虑将其放入`onStart`or `onResume`...

您还应该阅读[进程和线程](http://developer.android.com/guide/components/processes-and-threads.html)，以了解什么运行在哪里，在哪里可以阻塞，在哪里不能......

# android - 如果 Activity 类中没有发生异常，则通知用户

> ID：11511701
> 
> 赞同：0
> 
> 时间：2012-07-16T20:01:45.723
> 
> 标签：android

My`Activity`拥有一个成员`member_one`，该成员拥有另一个`member_two`可以抛出`Exception`. `Toast`如果发生这种情况，我需要向用户展示`Exception`。为了显示 a`Toast`我需要`Exception`从`member_tow`to`member_one`然后从`member_one`to 我的`Activity`. 这种方法会导致很大的变化，我不想这样做。可能我只是想错了，有没有简单的方法来处理异常？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:35:10.730

到目前为止，我知道这个问题有两种解决方案。

*   传递`Context`给你`member_one`，`member_two`然后用它`Context`来制作 Toast。`Like Toast.makeText(mContext, "Exception Occurred", Toast.LENGTH_SHORT).show();`

第二种方法将通过`Interface`

`Interface`-在你的类中创建一个方法`member_one`等等

像

```
public interface OnErrorOccured {
        public void whatIsErr(String msg);
    }

    OnErrorOccured onError;

    public void setOnDetailsLoadListener(OnErrorOccured onError) {
        this.onError = onError;
    }
` 
```

当你`Exception`接到电话时`onError.whatIsErr(e.toString());`

主要是`Activity`

```
 member_one.setOnErrorListener(mErrorOccured);

 OnErrorOccured mErrorOccured =new OnErrorOccured() {

    @Override
    public void whatIsErr(String msg) {
        // Do what ever you want..show Toast, or do any UI update

    }
}; 
```

其他程序员如何知道他们是否想使用其中一个需要设置侦听器的类？

那么为此你强制构造函数传递一个监听器。

像

```
public yourConstructor(OnErrorOccured errorListener,.....)
{
   this.setOnErrorListener(errorListener);
   ...

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:09:43.890

我做过的一件事（虽然我不确定它是否干净，因为我是一个新手开发人员）是`Activity`作为参数传递，如下所示：

```
foo.bar(this, ...); 
```

然后，我可以像这样在其他方法中捕获异常：

```
bar(final Activity activity, ...)
{
   try
   {
      // Whatever
   }
   catch (Exception e)
   {
      Toast.makeText(activity, "You dun goofed!", Toast.LENGTH_SHORT)
           .show();
   }
} 
```

同样，我不能保证这是安全的做法，我很想听到更好的解决方案。

# python - 在 Python 中 base64 编码一个 zip 文件

> ID：11511705
> 
> 赞同：8
> 
> 时间：2012-07-16T20:02:33.290
> 
> 标签：python, zip, base64

有人可以给我一些关于如何在 Python 中将 zip 文件编码为 base64 的建议吗？有关于如何使用模块 base64 在 Python 中对文件进行编码的示例，但我还没有找到任何关于 zipfile 编码的资源。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-16T20:11:40.747

这与编码任何其他文件没有什么不同......

```
import base64

with open('input.zip', 'rb') as fin, open('output.zip.b64', 'w') as fout:
    base64.encode(fin, fout) 
```

注意：这避免了将文件读入内存进行编码，因此应该更有效。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-16T20:06:49.313

```
import base64

with open("some_file.zip", "rb") as f:
    bytes = f.read()
    encoded = base64.b64encode(bytes) 
```

# jquery - 在彼此旁边插入jquery？

> ID：11511706
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:02:34.790
> 
> 标签：jquery, html, css, web

我需要帮助，我正在使用 JCapSlide，我希望 4 个图块穿过我的标题，但是当我添加它们时，它们只会插入到彼此的下方。我该怎么做才能将它们彼此相邻插入。

这是我现在其中一个的代码我如何在此右侧插入另一个

```
<div id="header_image_home">
        <div id="capslide_img_cont6" class="ic_container">
                <img src="images/example2.jpg" width="180" height="240" alt=""/>
                <div class="overlay" style="display:none;"></div>
                <div class="ic_caption">
                    <class="ic_category">Categor
                    <h3>Amazing Image Title</h3>
                    <class="ic_text">
                       Description Here
                </div>
            </div>
        </div>
    </div>  
</div> 
```

演示的第一行[http://tympanus.net/jCapSlide/](http://tympanus.net/jCapSlide/)是我想要实现的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:06:39.050

您需要将`float:left`CSS 样式应用于元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:09:50.563

您可能应该`float: left;`在这种情况下使用，并且不要忘记`overflow: hidden;`在包含的 div 上放置一个或`clear: both;`在下一个上放置一个。

# php - 编写一个看似自动的注释更新功能，可以保存更改时的注释

> ID：11511709
> 
> 赞同：0
> 
> 时间：2012-07-16T20:02:52.777
> 
> 标签：php, javascript, html

我想在我的网站上实现一个“添加注释”功能，这对用户来说似乎毫不费力。

这个想法很简单：每个项目旁边都会有一个文本字段。更改输入文本字段的文本将自动在数据库中更新，用户无需点击“保存”或单击任何按钮来加载或保存注释。

（最初，每个项目旁边都会有一个空白文本字段）

实现这一点的最佳方法是什么？

```
<?php
//Create mysql connect variable
$conn = mysql_connect('samplesource.com', 'example', 'pass');

//kill connection if error occurs
if(!$conn){
    die('Error: Unable to connect.' . '<br>' . mysql_error());
}
//connect to mysql database
mysql_select_db("mydb", $conn);

session_start();
$userid = $_SESSION['id'];

$results = ("SELECT * FROM notes WHERE userid='$userid'");
?>

<html>
<head>
</head>
<body>

<textarea style="resize:none; width:300px; height:200px;"> </textarea>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:06:35.007

这是一个 jQuery ajax 调用来更新您的数据库的调用。从 ajax 调用中，您可以挂钩 onblur 事件，然后更新数据库中的注释，请记住，这将导致大量后端压力，并将导致 MySql 服务器陷入不断更新的困境。您可能还需要研究某种缓存和缓冲保存以防止这种情况发生。

jQuery Ajax： [http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

jQuery OnChange： [http ://api.jquery.com/change/](http://api.jquery.com/change/)

```
$(document).change( function() {
    $(".sometext").blur( function() { 
        //make ajax call to update database
    });
}); 
```

# jquery-ui - 使用 jquery datepicker 作为静态日历仅供参考

> ID：11511710
> 
> 赞同：0
> 
> 时间：2012-07-16T20:03:01.310
> 
> 标签：jquery-ui, datepicker

我只想使用 jQuery datepicker 来获取信息。出于这个原因，我想在单击特定日期时禁用“悬停”效果和颜色变化。

我尝试了一些组合，但没有任何成功。

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:27:34.460

您可以只使用 CSS 来修改样式。

**[jsFiddle 示例](http://jsfiddle.net/j08691/84b6G/)**

```
.ui-state-default, 
.ui-widget-content .ui-state-default, 
.ui-state-hover, 
.ui-widget-content .ui-state-hover, 
.ui-state-focus, 
.ui-widget-content .ui-state-focus { 
    border: 1px solid #cccccc; 
    background: #f6f6f6 url(images/ui-bg_glass_100_f6f6f6_1x400.png) 50% 50% repeat-x; 
    font-weight: bold; 
    color: #1c94c4; 
    outline: none;
    cursor:default;    
}​ 
```

# javascript - 在 中查找文本，然后有条件地更改另一个中的文本

> ID：11511713
> 
> 赞同：2
> 
> 时间：2012-07-16T20:03:10.363
> 
> 标签：javascript, jquery, asp.net, html

我正在使用`asp:Repeater`，我需要一些帮助。在我的表格中，我有一个`<td`>，我想更改颜色，当且仅当`<td>`它的右侧包含某个文本。

代码如下所示：

```
 <asp:Repeater ID="myRepeater" runat="server">
        <HeaderTemplate>
            <div id="myDiv">
                <table id="table">
                    <thead>
                        <tr>
                            <th class="class">
                                Row 1
                            </th>
                            <th class="class">
                                Row 2
                            </th>
                            <th class="class">
                                Row 3                               
                            </th>
                        </tr>
                    </thead>
                    <tbody>
        </HeaderTemplate>
        <ItemTemplate>
            <tr>
                <td class="myClass">
                </td>
                <td class="changeMyColor!">
                </td>
        <td class="lookAtMe">
         certainText
        </td>
    </ItemTemplate> 
```

在这种情况下，如果包含“certainText”，我想给背景颜色。这对我来说也具有挑战性，中继器中的每个项目都必须这样做。

我在 jsfiddle 上找到了[这个](http://jsfiddle.net/alpacalips/9fbrU/1/)，但是在我的解决方案中使用它来实现它没有任何运气。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:20:52.363

试试这个例子：

[http://www.c-sharpcorner.com/blogs/7592/change-the-forecolor-of-an-item-in-a-repeater-based-on-the-s.aspx](http://www.c-sharpcorner.com/blogs/7592/change-the-forecolor-of-an-item-in-a-repeater-based-on-the-s.aspx)

您可以在您使用的 sql 适配器类型上使用**foreach**，并验证调用**IF的方法**

> dt.NewRow();

，在示例中，因此验证每个字段并为其分配您想要的颜色

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:14:26.090

尝试这个 ：

```
$(document).ready(function()
{
  $('td').each(function(index) 
  {
    if($(this).text().indexOf("certainText") >= 0 )
    {
      $(this).css('background-color','red');
    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:24:24.873

我不知道你`DataSource`是什么，但你可以改变下面的代码来做它的 ASP.NET 方式：

**标记：**

```
 <asp:Repeater ID="myRepeater" runat="server"                 
           OnItemDataBound="myRepeater_ItemDataBound">
  ................
 <ItemTemplate>
        <tr>
            <td class="myClass" id="td1" runat="server">
            </td>
            <td class="changeMyColor!" id="td2" runat="server">
            </td>
    <td class="lookAtMe">
     <asp:label id="lookAtMe" Text="<%#Eval("LookAtMe")%>" />
    </td>
 </ItemTemplate> 
```

**代码隐藏：**

```
 protected void myRepeater_ItemDataBound(Object Sender, RepeaterItemEventArgs e) {

      if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem) 
      {
         YourDataObject data = (YourDataObject)e.Item.DataItem;
         HtmlGenericControl td1 = e.Item.FindControl("td1") as HtmlGenericControl;
         HtmlGenericControl td1 = e.Item.FindControl("td2") as HtmlGenericControl;           

         if (data.YourProperty == "CertainText") {                                 
            td1.Attributes.Add("class","whateverClass");
            td2.Attributes.Add("class","whateverClass2");
         }

      }
   } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T22:40:36.677

```
jQuery(document).ready(function($) {

  //Find <td>'s in your table id="table" which contains text 'certainText'
  $('#table tbody td.lookAtMe:contains(certainText)').each(function() {

    //You said the test was for the <td> to the right of it
    //which means .prev() will return the <td> to the left
    //select that <td> and change its color
    $(this).prev().css({'background-color':'#a90000'});
  });
}); 
```

# opencv - 通过未知类型的 Mat 进行 OpenCV 索引

> ID：11511715
> 
> 赞同：6
> 
> 时间：2012-07-16T20:03:28.947
> 
> 标签：opencv, matrix

我想访问未知类型矩阵的元素：

```
for(int ii = 0; ii < origCols; ii++)
{
  colIdx.at<img.type()>(0,ii) = ii+1; // make one based index
} 
```

定义类型的表达式（在 <> 内）必须是一个常量，所以上面的代码不起作用。除了切换不同的图像类型之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T22:14:25.530

在浏览了一些文档之后，我认为没有一种原生的 OpenCV 方法可以在不避免分支的情况下做到这一点。

如果您只关心更简洁的代码，只要您不介意模板，就可以尝试模板方法：

```
template <typename T> void dostuff(cv::Mat& colIdx, int origCols)
{
   for(int ii = 0; ii < origCols; ii++)
   {
       colIdx.at<T>(0,ii) = (T)(ii+1); // make one based index
   }
}

void dostuff_poly(cv::Mat& colIdx, int origCols)
{
    switch(colIdx.type())
    {
        case CV_8UC1: dostuff<char>(colIdx, origCols); break;
        case CV_32FC1: dostuff<float>(colIdx, origCols); break;
        case CV_64FC1: dostuff<double>(colIdx, origCols); break;
        // and so on
        default:
    }
} 
```

在此示例中，代码相当小，因此模板似乎不是一个糟糕的选择，并且可以为您提供所需的多态性，而无需编写一堆冗余代码。

也许其中一些教程会给你一个更好的主意：

[OpenCV 文档：核心模块教程](http://docs.opencv.org/doc/tutorials/core/table_of_content_core/table_of_content_core.html)

[OpenCV 文档：如何扫描图像](http://docs.opencv.org/doc/tutorials/core/how_to_scan_images/how_to_scan_images.html#howtoscanimagesopencv)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T14:18:36.767

没有针对您的问题的本地 Opencv 解决方案，而且这个库经常让人感到痛苦。有三种可能的解决方案：

1.  始终使用具有相同深度的矩阵。我想这不是你想听到的。
2.  通过矩阵中包含的元素的类型来模板调用代码的方法：这仅适用于单通道矩阵，因为 .at<> 方法的模板必须是 cv::Point2f 用于矩阵的东西多个渠道。
3.  创建一个“智能”迭代器类，它将知道如何根据矩阵深度访问矩阵数据。就像是：

    ```
    class PtrMat
    {
      PtrMat(cv::Mat& mat, int row)
      {
        if(mat.depth() == CV_32F) { _ptr = new PtrFloat(mat, row); }
        else if(mat.depth() == CV_8U) { _ptr = new PtrUchar(mat, row); }
        ...
      }
      Ptr* _ptr
    };

    class Ptr
    {
      virtual void set(const float& val)=0;
    };
    class PtrFloat: public Ptr
    {
      PtrFloat(const cv::Mat& mat, int row){ _val = mat.ptr<float>(row); }
      void set(const float& val) { _val = val; }
      float* _val;
    }
    class PtrUchar: public Ptr
    {
      PtrUchar(const cv::Mat& mat, int row){ _val = mat.ptr<uchar>(row); }
      void set(const float& val) { _val = val; }
      uchar* _val;
    } 
    ```

当然，使用第三种解决方案，您最终会得到大量重复的代码。浮动铸造也可以减慢你的循环。在这种情况下，没有任何解决方案是完美的。

# iphone - 如何使声音滑块在暂停菜单中消失？

> ID：11511716
> 
> 赞同：0
> 
> 时间：2012-07-16T20:03:29.000
> 
> 标签：iphone, objective-c, ios, xcode, cocos2d-iphone

我一直不知道如何摆脱暂停菜单上的滑块。我想知道是否有一段代码或任何想法，如果您单击恢复，您将终止控制音乐的滑块

./m 文件

```
 -(void)PauseButtonTapped:(id)sender
 {
   if(_pauseScreenUp ==FALSE)
   {
    _pauseScreenUp=TRUE;
    //if you have music uncomment the line bellow
    //[[SimpleAudioEngine sharedEngine] pauseBackgroundMusic];
    [[CCDirector sharedDirector] pause];
    CGSize s = [[CCDirector sharedDirector] winSize];
    pauseLayer = [CCColorLayer layerWithColor: ccc4(150, 150, 150, 125) width: s.width height: s.height];
    pauseLayer.position = CGPointZero;
    [self addChild: pauseLayer z:8];

    _pauseScreen =[[CCSprite spriteWithFile:@"pause picture.png"] retain];
    _pauseScreen.position= ccp(250,150);
    [self addChild:_pauseScreen z:8];

    CCMenuItem *ResumeMenuItem = [CCMenuItemImage
                                  itemFromNormalImage:@"resume.png" selectedImage:@"resume.png"
                                  target:self selector:@selector(ResumeButtonTapped:)];
    ResumeMenuItem.position = ccp(250, 230);

    CCMenuItem *QuitMenuItem = [CCMenuItemImage
                                itemFromNormalImage:@"quit.png" selectedImage:@"quit.png"
                                target:self selector:@selector(QuitButtonTapped:)];
    QuitMenuItem.position = ccp(250, 50);

    CCMenuItem *MainMenuItem = [CCMenuItemImage
                                itemFromNormalImage:@"mainmenubutton.png" selectedImage:@"mainmenubutton.png"
                                target:self selector:@selector(MainButtonTapped:)];
    MainMenuItem.position = ccp(250, 145);         

    CCControlSlider *slider = [CCControlSlider sliderWithBackgroundFile:@"sound bar.png" progressFile:@"sound bar.png" thumbFile:@"sound icon.png"];

    slider.minimumValue = 0.0f; // Sets the min value of range
    slider.maximumValue = 1.0f; // Sets the max value of range

    // When the value of the slider will change, the given selector will be call
    [slider addTarget:self action:@selector(valueChanged:) forControlEvents:CCControlEventValueChanged];

    [slider setPosition:ccp(240,68)];        

    [self addChild:slider z:8];         

    CCControlSlider *slider1 = [CCControlSlider sliderWithBackgroundFile:@"sound bar2.png" progressFile:@"sound bar2.png" thumbFile:@"devil2.png"];

    slider1.minimumValue = 0.0f; // Sets the min value of range
    slider1.maximumValue = 1.0f; // Sets the max value of range

    // When the value of the slider will change, the given selector will be call
    [slider1 addTarget:self action:@selector(valueChanged1:) forControlEvents:CCControlEventValueChanged];

    [slider1 setPosition:ccp(240,8)];        

    [self addChild:slider1 z:10];         

    _pauseScreenMenu = [CCMenu menuWithItems:ResumeMenuItem,QuitMenuItem,MainMenuItem, nil];
    _pauseScreenMenu.position = ccp(0,0);
    [self addChild:_pauseScreenMenu z:10];

}
 }

 -(void)ResumeButtonTapped:(id)sender{
[self removeChild:_pauseScreen cleanup:YES];
[self removeChild:_pauseScreenMenu cleanup:YES];
[self removeChild:pauseLayer cleanup:YES];
[[CCDirector sharedDirector] resume];
_pauseScreenUp=FALSE;
 }

 -(void)QuitButtonTapped:(id)sender{
[self removeChild:_pauseScreen cleanup:YES];
[self removeChild:_pauseScreenMenu cleanup:YES];
[self removeChild:pauseLayer cleanup:YES];
[[CCDirector sharedDirector] resume];
_pauseScreenUp=FALSE;
[[UIApplication sharedApplication] performSelector:@selector(terminateWithSuccess)];

  }

 -(void)MainButtonTapped:(id)sender{
[self removeChild:_pauseScreen cleanup:YES];
[self removeChild:_pauseScreenMenu cleanup:YES];
[self removeChild:pauseLayer cleanup:YES];
[[CCDirector sharedDirector] resume];
_pauseScreenUp=FALSE;
[[CCDirector sharedDirector] replaceScene:[MainMenuScene scene]];    
   }

  - (void)soundOnOrOff:(id)sender
{

if ([[SimpleAudioEngine sharedEngine] mute]) {
    // This will unmute the sound
    [[SimpleAudioEngine sharedEngine] setMute:0];
}
else {
    //This will mute the sound
    [[SimpleAudioEngine sharedEngine] setMute:1];
}

 }

- (void)valueChanged:(CCControlSlider *)sender
{
// Change volume of your sounds

[[SimpleAudioEngine sharedEngine] setBackgroundMusicVolume:sender.value];
 }

  - (void)valueChanged1:(CCControlSlider *)sender
 {
// Change volume of your sounds
[[SimpleAudioEngine sharedEngine] setEffectsVolume:sender.value];

[[SimpleAudioEngine sharedEngine] playEffect:@"boom.mp3"];      
  } 
```

当我点击暂停菜单时，滑块出现，当我点击恢复时它不会消失:(。任何建议都会很好。我在想当你触摸恢复时可以消除或隐藏声音滑块的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:04:12.413

只是示例性地挑选出对我大喊大叫的部分代码（听起来像“Hiiiilp！Hiiiilp！”）。

```
_pauseScreen =[[CCSprite spriteWithFile:@"pause picture.png"] retain]; 
```

您保留一个自动释放的对象，该对象也由父节点保留，因为您将其作为子节点添加到 self。现在我没有看到任何`release`让我相信你正在泄漏这个和其他此类保留对象的地方。

建议：不要保留通过 addChild 添加到节点层次结构的对象。这是多余的。对于下一个项目，使用 ARC。

# java - 如何从 SOAP api 获取 Magento 产品 URL

> ID：11511719
> 
> 赞同：1
> 
> 时间：2012-07-16T20:03:34.813
> 
> 标签：java, api, url, magento, xml-rpc

我是Magento的初学者。我一直在玩 Magento XML-RPC api。我正在使用Java来实现api。除了产品网址之外，我能够获得有关产品的所需信息。我正在使用 product.info api 方法来获取该信息。

作为 api 请求结果的产品对象包含 url_key、url_path。例如对于产品 id：35，
url_key=coalesce-functioning-on-impatience-t-shirt-small
url_paht=coalesce-functioning-on-impatience-t-shirt-small.html

将产品 url 公式化为**STORE_HOST_URL + url_path**仅适用于某些产品。不适用于所有产品。如何使用我拥有的信息可靠地制定产品网址。

有没有办法只使用 api 方法而不是调整 PHP 代码来获取产品 url。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:42:09.840

我使用`http://freeshipping.in.ua/catalog/product/view/id/[PRODUCT_ID]`，这有效。当然这不是最好的方法，但我在 API 响应中没有发现任何更有用的东西......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T06:05:54.513

你是什​​么意思

> 将产品 url 公式化为 STORE_HOST_URL + url_path 仅适用于某些产品。不适用于所有产品。

**也许您可以尝试重新索引您的 url_path 和 url_key 每个产品。**

1.  清空你的 ../var/cache/*
2.  在 - Admin > System > Cache management > Refresh Catalog Rewrites 中修复目录 URL
3.  重新索引 URL - 管理 > 系统 > 索引管理 > 检查目录 URL 重写 > 重新索引；

# objective-c - 使用未声明的标识符 NSLinkAttributeName

> ID：11511727
> 
> 赞同：1
> 
> 时间：2012-07-16T20:04:05.850
> 
> 标签：objective-c, ios5

我正在尝试通过 NSLinkAttributeName 函数添加指向 NSAttributedString 的链接，但我不断收到未声明的标识符错误。我已经导入了 Foundation.framework，但我仍然收到此错误。这是出现错误的代码：

```
 NSAttributedString *string = [[NSAttributedString alloc] initWithString:nonAttrString 
                                                              attributes:[NSDictionary dictionaryWithObjectsAndKeys:NSLinkAttributeName, @"http://www.google.com", nil]; 
```

知道问题是什么吗？

谢谢，皮特

编辑：澄清， NSLinkAttributeName 是未识别的部分。

编辑编辑：好的，愚蠢的错误，答案是 NSLinkAttributeName 不在标准库或 CoreText 库中，所以我必须导入 AppKit/AppKit.h 才能摆脱错误。

话虽如此，AppKit 需要我没有的 NSGeometry 库，我在哪里可以找到这个或者 NSLinkAttributeName 在 ios 上是不可能的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:29:38.817

[iOS 上的 NSAttributedString 和 Links](https://stackoverflow.com/questions/5772791/nsattributedstring-and-links-on-ios)这个问题已经得到解答，但没有意识到它是 iOS 特定的。

# c++ - C ++在函数中转换指针

> ID：11511729
> 
> 赞同：1
> 
> 时间：2012-07-16T20:04:17.300
> 
> 标签：c++, pointers, casting, template-function

我目前有这个宏

```
#define bind(OBJECT, ROLE) \
assert( sizeof(*ROLE) == 1 ); \
ROLE = reinterpret_cast<decltype(ROLE)>(OBJECT); 
```

它导致了一些名称冲突问题，所以我想把它移到一个模板函数中，比如

```
template<typename T1, typename T2>
void bind(T1 obj, T2 r) {
    assert( sizeof(*r) == 1 );
    r = reinterpret_cast<T2>(obj);
}; 
```

但是，我怀疑这是不可能的，但想对此进行确认？为了改变r，我必须有一个指向指针的指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:07:14.227

您至少需要一个参考：

```
template<typename T1, typename T2>
void bind(T1 obj, T2& r)
{
    assert( sizeof(*r) == 1 );
    r = reinterpret_cast<T2>(obj);
} 
```

另一种选择是使用模板转换运算符。然后您可以使用以下语法调用：

```
ROLE = bind(OBJ); 
```

代码或多或少是这样的：

```
template<typename T1> class auto_converter
{
    const T1& value;
public:
    auto_converter(const T1& v) : value(v) {}

    // template conversion operator
    template<typename T2>
    operator T2() const
    {
        assert(sizeof (*T2()) == 1);
        return reinterpret_cast<T2>(value);
    }
};

template<typename T1>
autoconverter<T1> bind(const T1& obj) { return obj; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:06:40.093

声明 r 作为参考以更改它：

```
template<typename T1, typename T2>
void bind(T1 obj, 
          T2 &r) //<-- here 
{
    assert( sizeof(*r) == 1 );
    r = reinterpret_cast<T2>(obj);
}; 
```

# jquery - 在与“删除按钮”相同的容器中抓取 h4 的内容 - jQuery

> ID：11511731
> 
> 赞同：0
> 
> 时间：2012-07-16T20:04:27.050
> 
> 标签：jquery, dialog

所以，我让 jquery 吐出里面有 h4 的容器。这些容器中的每一个都包含一个“删除”按钮。当您单击此删除按钮时，您会收到一个 jquery UI 对话框确认提示。这个提示基本上说：

您确定要删除 ((H4 标签的内容)) 吗？

**这是html...**

> ```
> <div class="container">
>     <h4>Title of Item</h4>
>     <div class="remove">Remove</div>
> </div>
> 
> <div class="remove-dialog">
>     Do you wish to <strong>remove the <span class="account-name">((Account Type))</span></strong>  account from 
> ```
> 
> 你的申请？

```
**Here is my jQuery**
    // Remove Added Account and Subtract from Account count
        $('.remove').live('click',function() {
            var current = this
            var AccountName = $(this).closest('div').children('h4')
            console.log(AccountName)    

            $(".remove-dialog").dialog({
                buttons : {
                    "Yes" : function() {
                        $(this).dialog("close");
                        $(current).parents("div:first").remove()
                        Accounts--
                        $('.account-count').val(Accounts).change()
                },
                    "No" : function() {
                        $(this).dialog("close");
                    }
              }
            });
            $('.remove-dialog').dialog("open"); 
        }); 
```

所以我想要的是在同一个容器中用 h4 填充 ((Account Type)) 。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:17:38.027

像[这样](http://jsfiddle.net/ATraE/3/)的东西？

正是这一行让你得到了标题：

```
var AccountName = $(this).parent().find('h4').text(); 
```

此行设置文本：

```
$(".account-name").text(AccountName); 
```

# events - JSF f:event 可以安全地传递参数吗？

> ID：11511738
> 
> 赞同：2
> 
> 时间：2012-07-16T20:04:56.337
> 
> 标签：events, jsf

我是 JSF 的新手，所以我对一些标签的了解不是很好。而且我想知道在这种情况下传递参数有多安全：

```
<f:event listener="#{backBean.myMethod(**param**)}" type="preRenderView"/> 
```

因为，当我要传递这个“参数”时，用户不能访问这个信息（改变这个值意味着一个安全漏洞，这不可能发生）。所以我问这个是否知道使用这个事件是否有可能打破这个代码（传递另一个参数）？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:14:32.380

如果`param`最终用户无法控制该值，那么您是安全的。就那么简单。您直接或间接（通过 JSF 或从数据库！）从最终用户的**完全**控制`HttpServletRequest`下提取的任何内容。

 **因此，例如，如果您对其进行硬编码，

```
<f:event listener="#{backBean.myMethod('foo')}" type="preRenderView"/> 
```

那么你就安全了。

但是如果你传递一个用户控制的请求参数，

```
<f:event listener="#{backBean.myMethod(param.foo)}" type="preRenderView"/> 
```

那么只有在服务器端**验证**它的值时你才是安全的。**

# hibernate - 多对多下拉列表

> ID：11511743
> 
> 赞同：0
> 
> 时间：2012-07-16T20:05:42.563
> 
> 标签：hibernate, jsf-2

我是 hibernate / jsf 的菜鸟，所以我想知道处理以下（相当标准）场景的标准方法是什么。

我有 2 节课：

```
public Class Appointment
   Client client;
   Date   date;

public Class Client
   String name;
   String address; 
```

约会和客户之间存在多对一的关系（客户可以有很多约会）。但是，在创建约会时，我希望用户能够从下拉列表中选择客户端。在我看来，要做到这一点，我需要在约会和客户之间建立多对多的关系。这是标准方法吗？有替代品吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:15:38.123

我认为您必须只使用多对一映射，因为只有客户才能有很多约会，如果我得到您想要做的事情，约会是特定于唯一客户的。所以你必须使用一对多注释，并且不要忘记指定 mappedby 属性，以便你的关系可以从两侧起作用

祝你好运，对不起我的英语：s

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:55:54.077

极其常见的任务。不，你不想要多对多，这意味着同一个约会应该有多个客户。尝试类似：

豆：

```
private Long clientId;
private Date date;
private List<Client> clients;

public List<Client> getClients(){
    if(clients == null){
        clients = clientDAO.findAll(); // Lazy loading since JSF has a habit of calling the getter multiple times.
    }
    return clients;
}

// Getters and setters for client and date

public void saveAppointment(){
    applicationDAO.createAppointment(date, clientId);
} 
```

xhtml:

```
<h:selectOneMenu value="#{bean.clientId}">
    <f:selectItems value="#{bean.clients}" var="client" itemLabel="#{client.name]" itemValue="#{client.id}"/>
</h:selectOneMenu> 
```

# apache - 我可以像这样使用 Apache 2.2.22 设置虚拟主机配置吗？

> ID：11511744
> 
> 赞同：0
> 
> 时间：2012-07-16T20:05:49.867
> 
> 标签：apache, httpd.conf, vhosts

我有 2 个网站正在尝试使用 Apache Vhost 进行设置。网站设置在 IP 地址/文件夹名称，但尚未对外暴露，没有 DNS。因此，当我尝试像这样对它们进行 Vhost 时：

```
<VirtualHost *:80>

   DocumentRoot "c:/wamp/www/marion"
   ServerName IP-address/marion

   <Directory "c:/wamp/www/marion">

      Options Indexes FollowSymLinks
          AllowOverride all
          Order Allow,Deny
      Allow from all

   </Directory>

</VirtualHost>

<VirtualHost *:80>

   DocumentRoot "c:/wamp/www/redcreek"
   ServerName IP-address/redcreek

   <Directory "c:/wamp/www/redcreek">

      Options Indexes FollowSymLinks
          AllowOverride all
          Order Allow,Deny
      Allow from all

   </Directory>

</VirtualHost> 
```

并浏览到任一站点，例如`IPaddress/redcreek`，我收到错误`"The requested URL /redcreek/ was not found on this server."`它就像我激活 Vhost 配置文件后无法识别 IP 地址一样。

`httpd-vhosts.conf`在我注册 DNS 名称之前是否可以这样配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:24:33.143

`IPaddress/redcreek`并且`IP-address/marion` [不是有效`ServerName`身份](http://httpd.apache.org/docs/2.0/mod/core.html#servername)，因为它不是 FQDN。

如果您希望能够访问`http://ip-address/marion`，`http://ip-address/redcreek`那么您应该使用文档根目录创建一个 vhose `c:/wamp/www/`，服务器名称作为 IP 地址，并包括`<Directory "c:/wamp/www/marion">`和`<Directory "c:/wamp/www/redcreek">`块。

一旦你有了 DNS 名称，比如`marion.yourdomain.com`和`redcreek.yourdomain.com`，你就可以使用你拥有的设置并`IP-address/marion`用`marion.yourdomain.com`和`IP-address/redcreek`替换`redcreek.yourdomain.com`。

# objective-c - 为什么没有从 UITableViewCell 调用 prepareForSegue？(Xcode 4.3.3)

> ID：11511749
> 
> 赞同：2
> 
> 时间：2012-07-16T20:06:27.393
> 
> 标签：objective-c, ios5, xcode4

在 Xcode 4.3.3 中，我试图将一个故事板从一个故事板连接到另一个故事板。

我在 UITableViewCell 和我的目标控制器之间建立连接，保存更改并部署到 iPhone 模拟器。

如果我在 prepareForSegue 的开头添加一个断点，当我单击 UITableViewCell 时，该方法永远不会被调用。

什么问题会导致这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:12:42.540

解决方案非常简单：

*   对您的项目执行**清理**
*   **在 iPhone 模拟器中再次**构建**并**运行应用程序****

 **我无法复制这种情况，所以我不知道为什么更新的故事板 Xml 文件没有进入模拟器。如果再次发生，我会发布我发现的内容。

为其他有类似问题的人添加了这个。**

# javascript - 带有 Google Places 库的 Google Maps 中不同地点类型的不同图像

> ID：11511757
> 
> 赞同：2
> 
> 时间：2012-07-16T20:06:40.313
> 
> 标签：javascript, google-maps, google-maps-markers, google-places

我是 javascript 的新手，无法弄清楚使用谷歌地图中的地点库为不同类型地点的结果使用不同自定义图标的逻辑。例如 - 这将要求体育场和公园

```
var request = {
      location: myLatLng,
      radius: 20000,
      types: ['stadium','park']
    };
    infowindow = new google.maps.InfoWindow();
    var service = new google.maps.places.PlacesService(map);
    service.search(request, callback); 
```

回调函数包括创建标记函数

```
function callback(results, status) {
    if (status == google.maps.places.PlacesServiceStatus.OK) {
      for (var i = 0; i < results.length; i++) {
        createMarker(results[i]); 
      } 
    }
} 
```

创建标记函数如下所示

```
var emu = 'EMU_test_icon.png'

function createMarker(place) {
    var placeLoc = place.geometry.location;
    var marker = new google.maps.Marker({
      map: map,
      icon: emu,
      position: place.geometry.location
    }); 
```

所以我知道如何分配所有标记以使用 EMU_test_icon 图像，但是如何将“体育场”位置类型的结果定向到我列出的图标（emu），但为“公园”的结果创建标记到不同的自定义图标（image2）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T08:10:14.277

传递给 createMarker 方法的“place”参数有一个可以提供帮助的“type”属性。请参阅[PlaceSearchResults](https://developers.google.com/maps/documentation/javascript/places#place_search_responses)标题下的参考。

您可以将这两个图标存储在地图中，并根据地点类型查找图标类型。

```
// store the icons in a map, key'd by type
var iconMap = {'stadium': 'EMU_test_stadium_icon.png', 'park': 'EMU_test_park_icon.png'};

// access types array from PlaceResult object
//  search to find the string "stadium" and "park"
//  default the type to stadium and check to see if place is a park
//  if its a park update the type of icon we select
//  in the original call to create a marker, get the icon string by type
function createMarker(place) {

    var placeLoc = place.geometry.location,
        isStadium = place.types.indexOf("stadium") !== -1,
        isPark = place.types.indexOf("park") !== -1,
        iconType = "stadium";

    if (isPark) {
        iconType = "park";
    }

    new google.maps.Marker({
        map: map,
        icon: iconMap[iconType],
        position: place.geometry.location
    });

} 
```

*注意：这在 IE < 9 中不起作用（不向数组原型添加 indexOf 函数）

*注2：假设您的“地图”变量在其他地方声明

# android - strings.xml 中的 Android 变量

> ID：11511760
> 
> 赞同：10
> 
> 时间：2012-07-16T20:06:52.623
> 
> 标签：android, xml, parsing, variables

在某处我读到了如何在 XML 文档中使用变量。他们说这很简单，我猜是这样。我在 Android strings.xml 文件中成功地使用了它。我一整天都在使用它，直到突然 android 停止解析它并停止将其视为变量。

我以这种方式使用它：

```
<resources>
<string name="some_string">string1</string>
<string name="another_string"> {$some_string} trolololo </string>
</resources> 
```

并在java中通过以下方式访问它： getApplicationContext().getString(R.strings.another_string);

```
getApplicationContext().getString(R.strings.another_string); 
```

在输出中，我曾经接收过如下字符串：

```
string1 trolololo 
```

现在我只收到：

```
{$some_string} trolololo 
```

有谁知道出了什么问题？我知道 Android 的 XML 可能与标准 XML 不同，但它曾经可以工作。Awww ...感谢您的任何建议。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-16T23:16:01.760

假设您想将字符串值作为参数传递，`another_string`那么您的字符串格式不正确，无法接收该参数，如果您尝试使用它，您的输出将为`{$some_string} trolololo`.

> 如果您需要使用**String.format(String, Object...)**格式化字符串，则可以通过将格式参数放入字符串资源中来实现。

```
<resources>
<string name="some_string">string1</string>
<string name="another_string">%1$s trolololo</string>
</resources> 
```

现在您可以使用应用程序中的参数格式化字符串，如下所示：

```
String arg = "It works!";
String testString = String.format(getResources().getString(R.string.another_string), arg);
Log.i("ARG", "another_string = " + testString); 
```

这样做的输出字符串将是`another_string = It works! trolololo`.

[在此处](http://developer.android.com/guide/topics/resources/string-resource.html#FormattingAndStyling)查看 Android 开发人员官方文档。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T20:13:34.183

这将解决您的问题：

```
<resources>
    <string name="some_string">string1</string>
    <string name="another_string">@string/some_string trolololo</string>
</resources> 
```

现在`getApplicationContext().getString(R.strings.another_string)`will 的输出是`string1 trolololo`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-03T09:23:52.437

或者，您可以直接使用`getResources().getString(R.string.activity_title, arg)`.

例如

```
<resources>
   <string name="postfix_title">%s Gallery</string>
</resources> 
```

然后简单地说，

```
String arg = "Colors";
String title = getResources().getString(R.string.postfix_title, arg); 
```

这将导致`title`包含 value `Colors Gallery`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:47:04.747

我不确定你做的第一件事是如何使用大括号，但我之前遇到过这个问题并且找不到解决方案..

现在我要做的是分别调用这些字符串并在运行时将它们连接起来。

# ios - 应用内购买 Apple ID 与服务器用户

> ID：11511761
> 
> 赞同：5
> 
> 时间：2012-07-16T20:07:00.083
> 
> 标签：ios, iphone, in-app-purchase, webserver, mkstorekit

我正在尝试使用应用内购买来实现多平台应用。我正在使用 MKStoreKit 和非消耗性内容。我会在服务器端使用用户注册。该应用程序无需注册任何用户即可使用，因此无需注册即可下载内容。

问题来了，因为我不是在处理购买，而是苹果（使用 Apple ID）。

*   如果我用 userA 购买了一个内容，然后以 userB 身份登录并尝试购买相同的内容，会弹出一条警告，提示“您已经购买了此应用内购买但尚未下载。”，如何我处理这个？

*   如果我在没有注册的情况下购买了一些内容然后注册了一个用户，我如何发送我的购买并将它们只与这个用户绑定？

*   如果我用 userA 购买了一些内容，然后更改了我的 Apple ID，根据我的 Apple ID，我将不再拥有该内容，我该如何处理这种情况？

处理Apple ID，注册和非注册用户似乎有点乱......购买消耗性硬币会更容易，但我害怕Apple拒绝。

我真的很纠结这个...

谢谢你的帮助。

# php - exec - PHP return_val 是 126

> ID：11511762
> 
> 赞同：7
> 
> 时间：2012-07-16T20:07:01.703
> 
> 标签：php, exec, executable

我试图在 PHP 脚本中执行 shell 命令，但 exec 返回 126 代码，这意味着“调用的命令无法执行”（权限问题或命令不是可执行文件）。但最有趣的是，如果我在 cli 下运行相同的 php 脚本，它运行良好。它出什么问题了？

也许环境有一些问题？因为当我在 Apache 下运行它时，如果我不使用可执行文件的绝对路径，它会返回 127 代码（在 cli 下它运行良好并返回 0，即使我只使用文件名）。文件存储在 /usr/local /bin 文件夹。

更新：

正如评论中所要求的，我展示了我的代码示例，但没有什么特别之处。

这部分在 cli 下工作正常，但在 apache 下不起作用（`$retval`将等于 127）：

```
$output = array();
$retval = 0;
exec( "myexecutablefile /full/path/to/someotherfile.js", $output, $retval );
echo implode( PHP_EOL, $output ); 
```

这段代码将返回`$retval = 126`

```
$output = array();
$retval = 0;
exec( "/usr/local/bin/myexecutablefile /full/path/to/someotherfile.js", $output, $retval );
echo implode( PHP_EOL, $output ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:09:21.857

您需要指定可执行文件的完整路径，并确保您的 Apache 用户有权执行它。

Apache 不使用 bash 运行，也不关心您自己的个人路径设置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-01T12:52:18.087

尝试将 chmod 0777 放入可执行文件：

```
chmod($file,0777); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-06-28T11:29:21.327

显然，PHP exec() 函数调用了 Linux exec() 系统调用。如果您的可执行文件是 bash 脚本，则必须使用 /bin/bash 显式启动它：

```
exec( "/bin/bash /usr/local/bin/myexecutablefile /full/path/to/someotherfile.js", $output, $retval ); 
```

因为您不能在 Linux 上使用 exec() 系统调用来运行 shell 脚本；只有像 bash 这样的 shell 才能解释其中的命令。/bin/bash 是一个可执行文件，可以在 Linux 上使用 exec() 完美启动，然后运行您的脚本。

# php - 在 JpGraph 中的条上叠加文本

> ID：11511766
> 
> 赞同：2
> 
> 时间：2012-07-16T20:07:16.257
> 
> 标签：php, text-alignment, jpgraph

我正在使用 JpGraph 为会议制作甘特图。我在页面底部找到[了这个](http://jpgraph.net/download/manuals/chunkhtml/ch16s04.html)示例，我正在尝试将其更改为我需要显示的内容。我能够将 设置`leftMark`到我希望文本出现的栏的一侧。但是，文本不在栏内。我尝试将对齐方式更改为，`"left, top"`但出现错误 `$bar->leftMark->title->SetTextAlign('left','top');`

> 致命错误：在第 82 行的 C:\xampp\htdocs\ganttChart\chart.php 中调用未定义的方法 Text::SetTextAlign()

或对图表没有影响。

请看我的例子，我可以用图表做什么：[例子](http://leobee.com/android/push/so/ganttChart/chart.php)。

问题：

1.  为了完成此任务，我缺少哪些类、包含或代码？

2.  您是否知道我可以遵循的示例与我正在寻找的效果相同，在上面的段落和示例中进行了描述？

PHP代码：

```
<?php // content="text/plain; charset=utf-8"
// Gantt hour example
require_once ('jpgraph/src/jpgraph.php');
require_once ('jpgraph/src/jpgraph_gantt.php');
require_once ('jpgraph/src/jpgraph_canvas.php');
require_once ('jpgraph/src/jpgraph_canvtools.php');
require_once ('jpgraph/src/jpgraph_text.inc.php');

// Report simple running errors
error_reporting(E_ERROR | E_WARNING | E_PARSE);

// Reporting E_NOTICE can be good too (to report uninitialized
// variables or catch variable name misspellings ...)
error_reporting(E_ERROR | E_WARNING | E_PARSE | E_NOTICE);

// Report all errors except E_NOTICE
// This is the default value set in php.ini
error_reporting(E_ALL ^ E_NOTICE);

// Report all PHP errors (see changelog)
error_reporting(E_ALL);

// Report all PHP errors
error_reporting(-1);

// Same as error_reporting(E_ALL);
ini_set('error_reporting', E_ALL);
$graph = new GanttGraph();
$graph->SetMarginColor('blue:1.7');
$graph->SetColor('white');

$graph->SetBackgroundGradient('navy','white',GRAD_HOR,BGRAD_MARGIN);
$graph->scale->hour->SetBackgroundColor('lightyellow:1.5');
$graph->scale->hour->SetFont(FF_FONT1);
$graph->scale->day->SetBackgroundColor('lightyellow:1.5');
$graph->scale->day->SetFont(FF_FONT1,FS_BOLD);

$graph->title->Set("Example of hours in scale");
$graph->title->SetColor('white');
$graph->title->SetFont(FF_VERDANA,FS_BOLD,14);

$graph->ShowHeaders(GANTT_HDAY | GANTT_HHOUR);

$graph->scale->week->SetStyle(WEEKSTYLE_FIRSTDAY);
$graph->scale->week->SetFont(FF_FONT1);
$graph->scale->hour->SetIntervall(1);

$graph->scale->hour->SetStyle(HOURSTYLE_HM24);
$graph->scale->day->SetStyle(DAYSTYLE_SHORTDAYDATE3);

$data = array(
    array(0,"Room 1", "2001-01-26 04:30","2001-01-26 14:00"),
    array(0,"Room 1", "2001-01-26 15:30","2001-01-26 19:00"),
    array(1,"Room 2", "2001-01-26 10:00","2001-01-26 18:00"),
    array(2,"Room 3", "2001-01-26","2001-01-27 10:00")
);

for($i=0; $i<count($data); ++$i) {

    $bar = new GanttBar(
    $data[$i][0],
    $data[$i][3],
    $data[$i][2],
    $data[$i][3],
    "",100);

    if( count($data[$i])>4 )
    $bar->title->SetFont($data[$i][4],$data[$i][5],$data[$i][6] );
    $bar->SetPattern(BAND_RDIAG,"yellow");
    $bar->SetFillColor("red");
    //$bar->SetTextAlign('left');

    $bar->leftMark->Show();    
    //$bar->rightMark->title->Set("Events name");
    $bar->leftMark->title->Set("Events name");
    //$bar->rightMark->SetType(MARK_FILLEDCIRCLE);
    //$bar->rightMark->SetWidth(10);
    //$bar->rightMark->SetColor("red");
    //$bar->rightMark->SetFillColor("red");
    //$bar->leftMark->title->SetTextAlign('left');
    $bar->leftMark->title->Center(50,150,75);
    $bar->leftMark->title->SetFont(FF_ARIAL,FS_BOLD,12);
    $bar->leftMark->title->SetColor("black");
    $bar->leftMark->title->SetAlign('left','top');
    $graph->Add($bar);
}

$graph->Stroke();

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T10:58:04.987

我想通了，请参阅下面的示例和代码：[示例](http://leobee.com/android/push/so/ganttChart/chart.php)

代码：

```
<?php // content="text/plain; charset=utf-8"
// Gantt hour example
require_once ('jpgraph/src/jpgraph.php');
require_once ('jpgraph/src/jpgraph_gantt.php');
require_once ('jpgraph/src/jpgraph_canvas.php');
require_once ('jpgraph/src/jpgraph_canvtools.php');
require_once ('jpgraph/src/jpgraph_text.inc.php');

// Report simple running errors
error_reporting(E_ERROR | E_WARNING | E_PARSE);

// Reporting E_NOTICE can be good too (to report uninitialized
// variables or catch variable name misspellings ...)
error_reporting(E_ERROR | E_WARNING | E_PARSE | E_NOTICE);

// Report all errors except E_NOTICE
// This is the default value set in php.ini
error_reporting(E_ALL ^ E_NOTICE);

// Report all PHP errors (see changelog)
error_reporting(E_ALL);

// Report all PHP errors
error_reporting(-1);

// Same as error_reporting(E_ALL);
ini_set('error_reporting', E_ALL);
$graph = new GanttGraph();
$graph->SetMarginColor('blue:1.7');
$graph->SetColor('white');

$graph->SetBackgroundGradient('navy','white',GRAD_HOR,BGRAD_MARGIN);
$graph->scale->hour->SetBackgroundColor('lightyellow:1.5');
$graph->scale->hour->SetFont(FF_FONT1);
$graph->scale->day->SetBackgroundColor('lightgreen:1.5');
$graph->scale->day->SetFont(FF_FONT1,FS_BOLD);

$graph->title->Set("Example of hours in scale");
$graph->title->SetColor('white');
$graph->title->SetFont(FF_VERDANA,FS_BOLD,14);

$graph->ShowHeaders(GANTT_HDAY | GANTT_HHOUR);

$graph->scale->week->SetStyle(WEEKSTYLE_FIRSTDAY);
$graph->scale->week->SetFont(FF_FONT1);
$graph->scale->hour->SetIntervall(1);

$graph->scale->hour->SetStyle(HOURSTYLE_HMAMPM);
$graph->scale->hour->grid->SetColor('lightgray');
$graph->scale->day->SetStyle(DAYSTYLE_SHORTDAYDATE3);

$data = array(
    array(0,"Room 1", "2001-01-26 02:30","2001-01-26 14:00:00","Sonic"),
    array(0,"Room 1", "2001-01-26 15:30","2001-01-26 19:00","SailorMoon"),
    array(1,"Room 2", "2001-01-26 10:00","2001-01-26 18:00","Gundam Wing"),
    array(2,"Room 3", "2001-01-26","2001-01-26 10:00","No appologies")
);

for($i=0; $i<count($data); ++$i) {

$txt = new Text();
$txt->SetScalePos($data[$i][2],$data[$i][0]);
$txt->SetMargin(50);
$txt->SetFont(FF_VERDANA,FS_BOLD,12);
$txt->SetAlign('left','center');
$txt->Set($data[$i][4]);
$txt->SetParagraphAlign('left');
//$txt->SetWordWrap(10);
$txt->SetBox('lightyellow');
$txt->SetShadow();
$graph->Add($txt); 

    $bar = new GanttBar(
    $data[$i][0],
    $data[$i][1],
    $data[$i][2],
    $data[$i][3],
    $data[$i][4],100);

    if( count($data[$i])>4 )
    $bar->title->SetFont($data[$i][4],$data[$i][5],$data[$i][6] );
    $bar->title->SetFont(FF_VERDANA,FS_BOLD,12);
    $bar->SetPattern(BAND_RDIAG,"yellow");
    $bar->SetFillColor("red");
    $graph->Add($bar);
}

$graph->Stroke();

?> 
```

# xcode - 我的子视图在旋转后没有自动调整大小

> ID：11511770
> 
> 赞同：0
> 
> 时间：2012-07-16T20:07:46.663
> 
> 标签：xcode, ipad, rotation, autoresize

我正在尝试在 iPad 上制作一个简单的应用程序。现在我只在自定义视图中显示全屏图片。我的问题是 iPad 旋转时我的视图没有自动调整大小……旋转效果很好，但我的图像大小仍然相同。

我的应用就是基于[这个](https://github.com/Dillion/iOS-Flip-Transform)，因为我在切换图片的时候想要这个效果。基本上，产生效果的观点是`FlipView`继承形式`GenericAnimationView`继承形式`UIView`。还有显示 1 个动画周期所需的`AnimationFrame`继承。`NSObject`最后，`AnimationDelegate`继承`NSObject`自转换操作的句柄回调。

这是我的`AnimationViewController`

```
 #import "AnimationViewController.h"
    #import "FlipView.h"
    #import "AnimationDelegate.h"

    @implementation AnimationViewController

    @synthesize flipView2;
    @synthesize panRecognizer;
    @synthesize panRegion;
    @synthesize imageBluehound,imageDoggie,imagePointy,imagePurpGuy,imageRedDog,imageWoof;

    - (id)init
    {
        self = [super init];
        if (self) {
            // Custom initialization
            step = 0;
        }
        return self;
    }

    - (void)didReceiveMemoryWarning
    {
        // Releases the view if it doesn't have a superview.
        [super didReceiveMemoryWarning];

        // Release any cached data, images, etc that aren't in use.
    }

    #pragma mark - View lifecycle

    /*
    // Implement loadView to create a view hierarchy programmatically, without using a nib.
    - (void)loadView
    {
    }
    */

    - (void)dealloc
    {
        [flipView2 release];
        [panRecognizer release];
        [panRegion release];

        [super dealloc];
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];

        self.view.backgroundColor = [UIColor whiteColor];

        self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemCancel target:self action:@selector(onBackButtonPressed:)];

        // memorisation des imagesx
        imageBluehound = [UIImage imageNamed:@"Bluehound.gif"];
        imageDoggie = [UIImage imageNamed:@"Doggie.gif"];
        imagePointy = [UIImage imageNamed:@"Pointy.gif"];
        imagePurpGuy = [UIImage imageNamed:@"PurpGuy.gif"];
        imageRedDog = [UIImage imageNamed:@"RedDog.gif"];
        imageWoof = [UIImage imageNamed:@"Woof.gif"];

        animationDelegate2 = [[AnimationDelegate alloc] initWithSequenceType:kSequenceControlled
                                                               directionType:kDirectionForward];
        animationDelegate2.controller = self;
        animationDelegate2.perspectiveDepth = 1000;

        self.flipView2 = [[FlipView alloc] initWithAnimationType:kAnimationFlipHorizontal
                                                           frame:CGRectMake(0, 0,[UIScreen mainScreen].bounds.size.width, [UIScreen mainScreen].bounds.size.height)];
        animationDelegate2.transformView = flipView2;

        [self.view addSubview:flipView2];

        [flipView2 printText:@"" usingImage:imageBluehound backgroundColor:[UIColor greenColor] textColor:nil];
        [flipView2 printText:@"" usingImage:imageDoggie backgroundColor:[UIColor greenColor] textColor:nil];
        [flipView2 printText:@"" usingImage:imagePointy backgroundColor:[UIColor greenColor] textColor:nil];
        [flipView2 printText:@"" usingImage:imagePurpGuy backgroundColor:[UIColor greenColor] textColor:nil];
        [flipView2 printText:@"" usingImage:imageRedDog backgroundColor:[UIColor greenColor] textColor:nil];
        [flipView2 printText:@"" usingImage:imageWoof backgroundColor:[UIColor greenColor] textColor:nil];

        self.panRegion = [[UIView alloc] initWithFrame:CGRectMake(0, 0,[UIScreen mainScreen].bounds.size.width, [UIScreen mainScreen].bounds.size.height)];
        [self.view addSubview:panRegion];

        self.panRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panned:)];
        panRecognizer.delegate = self;
        panRecognizer.maximumNumberOfTouches = 1;
        panRecognizer.minimumNumberOfTouches = 1;
        [self.view addGestureRecognizer:panRecognizer];

    }

    - (void)onBackButtonPressed:(UIBarButtonItem *)sender
    {
        [self dismissModalViewControllerAnimated:YES];
    }

    - (void)panned:(UIPanGestureRecognizer *)recognizer
    {
        switch (recognizer.state) {
            case UIGestureRecognizerStatePossible:
                break;
    //        case UIGestureRecognizerStateRecognized: // for discrete recognizers
    //            break;
            case UIGestureRecognizerStateFailed: // cannot recognize for multi touch sequence
                break;
            case UIGestureRecognizerStateBegan: {
                // allow controlled flip only when touch begins within the pan region
                if (CGRectContainsPoint(panRegion.frame, [recognizer locationInView:self.view])) {
                    if (animationDelegate2.animationState == 0) {
                        [NSObject cancelPreviousPerformRequestsWithTarget:self];
                        animationDelegate2.sequenceType = kSequenceControlled;
                        animationDelegate2.animationLock = YES;
                    }
                }
            }
                break;
            case UIGestureRecognizerStateChanged: {
                if (animationDelegate2.animationLock) {
                    switch (flipView2.animationType) {
                        case kAnimationFlipVertical: {
                            float value = [recognizer translationInView:self.view].y;
                            [animationDelegate2 setTransformValue:value delegating:NO];
                        }
                            break;
                        case kAnimationFlipHorizontal: {
                            float value = [recognizer translationInView:self.view].x;
                            [animationDelegate2 setTransformValue:value delegating:NO];
                        }
                            break;
                        default:break;
                    }
                }
            }
                break;
            case UIGestureRecognizerStateCancelled: // cancellation touch
                break;
            case UIGestureRecognizerStateEnded: {
                if (animationDelegate2.animationLock) {
                    // provide inertia to panning gesture
                    float value = sqrtf(fabsf([recognizer velocityInView:self.view].x))/10.0f;
                    [animationDelegate2 endStateWithSpeed:value];
                }
            }
                break;
            default:
                break;
        }
    }

    // use this to trigger events after specific interactions
    - (void)animationDidFinish:(int)direction 
    {
        switch (step) {
            case 0:
                break;
            case 1:
                break;
            default:break;
        }
    }

    - (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)orientation duration:(NSTimeInterval)duration
    {
        if (UIInterfaceOrientationIsLandscape(orientation))
        {
            if (orientation == UIInterfaceOrientationLandscapeLeft)
            {
                NSLog(@"landscape left");
                self.flipView2.transform = CGAffineTransformMakeRotation(0);
            }
            else
            {
                NSLog(@"landscape right");
                self.flipView2.transform = CGAffineTransformMakeRotation(0);
            }
        }
    }

    - (void)viewDidUnload
    {
        [super viewDidUnload];
        // Release any retained subviews of the main view.
        // e.g. self.myOutlet = nil;
    }

    - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
    {
        // Return YES for supported orientations
        return YES;
    }

@end 
```

在这里.h

```
#import <UIKit/UIKit.h>

@class FlipView;
@class AnimationDelegate;

@interface AnimationViewController : UIViewController <UIGestureRecognizerDelegate> {

    // use this to choreograph a sequence of animations that you want the user to step through
    int step;

    //the controller needs a reference to the delegate for control of the animation sequence
    AnimationDelegate *animationDelegate2;

    BOOL runWhenRestart;

}

//@property (nonatomic, retain) UIButton *boutonMenuGlissant;

@property (nonatomic, retain) UIImage *imageBluehound;
@property (nonatomic, retain) UIImage *imageDoggie;
@property (nonatomic, retain) UIImage *imagePointy;
@property (nonatomic, retain) UIImage *imagePurpGuy;
@property (nonatomic, retain) UIImage *imageRedDog;
@property (nonatomic, retain) UIImage *imageWoof;

@property (nonatomic, retain) FlipView *flipView2;
@property (nonatomic, retain) UIView *panRegion;
@property (nonatomic, retain) UIPanGestureRecognizer *panRecognizer;

- (void)onBackButtonPressed:(UIBarButtonItem *)sender;
- (void)panned:(UIPanGestureRecognizer *)recognizer;
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)orientation duration:(NSTimeInterval)duration;

// animation delegate will notify the controller when the animation frame has reached a position of rest
- (void)animationDidFinish:(int)direction;

@end 
```

我在其他帖子中看到他们谈到了 autoSized 面具，但我做不到......

有什么想法或建议吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:36:19.137

尝试修改视图/图像的支柱和字符串。单击图像后，转到实用程序检查器的大小选项卡。“自动调整大小”旁边的示例将显示视图在框架更改时的外观。打开/关闭红色连接器和箭头，使图像在方向改变时看起来像您想要的那样。

# javascript - 如何通过将高度设置为百分比来设置 div 的滚动

> ID：11511771
> 
> 赞同：1
> 
> 时间：2012-07-16T20:07:49.017
> 
> 标签：javascript, jquery, html, css

我有一个 div 我想让它滚动到顶部。当我将其高度设置为像素时，我正在滚动，但是当我将其设置为百分比时，我没有滚动

```
<div id="lblAlert" runat="server" class="warning-message" style="overflow:auto" >

// working code

scrollfun()
{
lblAlert.style.height = 65; 
}
// not working code
scrollfun()
{
lblAlert.style.height = '2%'; 
} 
```

我将如何做到这一点，如何将像素转换为百分比？请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:25:15.407

尝试使用获取父元素的高度

```
var element_Height = $(element).parent().css('height'); 
```

并使用它计算滚动高度

```
height = (2 / 100) * element_Height; 
```

这将为您提供滚动高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:35:50.293

继承人我的 jsFiddle 做你想要的[http://jsfiddle.net/F8Qpx/](http://jsfiddle.net/F8Qpx/)

```
changeHeight = function (){
var obj = document.getElementById('lblAlert');
var parent = obj.parentNode;
obj.style.height = (parent.offsetHeight/100)*2 + "px";//Make 2%
}​ 
```

这段代码应该可以工作

# c# - 在 Word 中禁用另存为

> ID：11511774
> 
> 赞同：1
> 
> 时间：2012-07-16T20:08:02.330
> 
> 标签：c#, ms-word, office-interop

我需要在 word 中禁用 SaveAs 或阻止用户更改文件名。

我的应用程序允许用户使用我为他们提供的标头创建 MailMerge 文档。这适用于用户只是简单地保存并退出 Word。如果用户另存为，则应用程序锁定。

我正在使用`Microsoft.Office.Interop.Word`.

```
 //MyWordApp & doc is initialized.

 MyWordApp.Application.Visible = true;

 While(WordIsOpen())//Holds execution here while User is editing in Word
 {
 } 
```

WordIsOpen 定义：

```
 public bool WordIsOpen()
 {
       if (MyWordApp.Application.Visible)//Locks up here
       {
           return true;
       }
       else
           return false;
 } 
```

锁起来：

```
 //I have a BeforeSave event that Saves the doc and quits Word

 DocumentBeforeSave(Doc, SaveAsUI, Cancel)
 {
      //Save Doc

      MyWordApp.Quit(ref objFalse, ref objNull, ref objNull);//Also, Locks up here
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T15:51:55.860

我不完全确定最终导致此问题的原因。我确定它与 COM 行为有关。在调试模式下使用 Word 互操作时存在一个已知错误。我遇到的唯一可能解决此问题的方法是拦截在 SaveAs 之前或之上发生的 COM 事件。我没有实施那个解决方案，所以我不知道这涉及到什么。

# php - Memcached open_basedir 限制生效

> ID：11511778
> 
> 赞同：0
> 
> 时间：2012-07-16T20:08:15.850
> 
> 标签：php, memcached

我正在尝试将 Memcached 集成到我的 Zend Framework 网站中以加快 Ajax 调用，但我遇到了麻烦。我尝试用这个函数在我的引导程序中初始化它：

```
public function _initMemcached(){
    $memcache = new Memcached; 
    $memcache->connect('127.0.0.1', 11211);
    Zend_Registry::set('memcached', $memcache);
} 
```

但这只会引发php找不到类的错误。根据托管我网站的数据中心，Memcached 应该安装在 中`/root/memcached-1.4.13/`，所以我尝试添加一个 require_once，现在它抛出了这个错误：

```
Warning: require_once() [function.require-once]: open_basedir restriction in effect.     File(/root/memcached-1.4.13/Memcached.php) is not within the allowed path(s): 
```

我试图在我的引导程序中重置 open_basedir，但它似乎不起作用。我怎样才能摆脱这个错误，以便我可以实例化一个 memcached 对象并继续我的业务？

编辑：

数据中心告诉我 memcached.so 在里面，`/usr/local/lib/php/extensions/no-debug-non-zts-###/`但我无法通过 SSH 访问它来确认。我将`extension_dir`in php.ini 设置为`/usr/local/lib/php/extensions/no-debug-non-zts-###/`并且我有`extension=memcached.so`，但我仍然找不到 Class。我的设置不正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:13:29.443

`memcached`是一个 php 扩展，而不是一个 php 脚本。这意味着，它必须在内部启用`php.ini`，例如

```
extension=/root/memcached-1.4.13/memcached.so 
```

或类似的东西。找出扩展名是如何命名的。

[http://php.net/memcached.setup](http://php.net/memcached.setup)

# c++ - 指针和多维数组

> ID：11511779
> 
> 赞同：3
> 
> 时间：2012-07-16T20:08:28.567
> 
> 标签：c++

> **可能重复：**
> [如何在 C++ 中使用数组？](https://stackoverflow.com/questions/4810664/how-do-i-use-arrays-in-c)
> [二维数组是双指针吗？](https://stackoverflow.com/questions/7586702/is-2d-array-a-double-pointer)
> [二维数组和指针](https://stackoverflow.com/questions/8669773/two-dimensional-arrays-and-pointers)

我知道这是一个非常基本的问题，但没有多少谷歌搜索为我解决了这个问题。这就是为什么在这里发布它。在 c++ 中考虑声明`int x[10];`

这是一个一维数组，其中 x 是基指针，它包含数组第一个元素的地址。所以`x`给我那个地址并`*x`给出第一个元素。

同样的声明

```
 int x[10][20]; 
```

这里有什么样的变量`x`。当我做

```
 int **z = x; 
```

编译器说它不能转换`int (*)[20]`为`int **`。为什么`cout<<x;`和`cout<<*x;`给出相同的值？而且，如果我将指针数组声明为

```
 int *p[10]; 
```

`x`那么和`p`（在它们的类型中）有区别吗？因为当一个人声明`int x[10]`然后分配给`int *p`它是有效的，但在二维数组的情况下不是这样？为什么？有人可以为我清除这个，或者提供一个很好的资源材料。`x``p`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:13:16.840

数组和指针不是一回事。在 C 和 C++ 中，多维数组只是“数组的数组”，不涉及指针。

```
int x[10][20]; 
```

是一个由 10 个数组组成的数组，每个数组包含 20 个元素。如果您`x`在上下文中使用它将衰减为指向其第一个元素的指针，那么您最终会得到一个指向其中一个 20 元素数组的指针 - 那就是您的`int (*)[20]`. 请注意，这样的东西*不是*指向指针的指针，因此转换是不可能的。

```
int *p[10]; 
```

是一个由 10 个指针组成的数组，所以是的，它与 x 不同。

特别是，您可能会遇到麻烦，因为您似乎认为数组和指针是同一件事 - 您的问题是：

> 这是一个一维数组，其中 x 是基指针，它包含数组第一个元素的地址。所以 x 给了我那个地址， *x 给了第一个元素。

这不是真的。一维`x`是一个数组，只是在某些情况下，数组衰减为指向其第一个元素的指针。

阅读[常见问题解答](http://c-faq.com/aryptr/index.html)，了解您想了解的有关此主题的所有信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T20:17:46.923

多维数组只是语法糖。在幕后，这只是一个 10 * 20 `int`s 长的一维数组。当您在`x[5][6]`编译器处访问一个元素时，会生成等价于`x[5 * 20 + 6]`;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T21:33:03.663

这是它的真正工作原理，请参阅代码和注释：

```
#include <stdio.h>

int x[3][5] =
{
  {  1,  2,  3,  4,  5 },
  {  6,  7,  8,  9, 10 },
  { 11, 12, 13, 14, 15 }
};

int (*pArr35)[3][5] = &x;
// &x is a pointer to an array of 3 arrays of 5 ints.

int (*pArr5a)[5] = x;
// x decays from an array of arrays of 5 ints to
// a pointer to an array of 5 ints,
// x is a pointer to an array of 5 ints.

int (*pArr5b)[5] = &x[0];
// &x[0] is a pointer to 0th element of x,
// x[0] is an array of 5 ints,
// &x[0] is a pointer to an array of 5 ints.

int *pInta = x[0];
// x[0] is 0th element of x,
// x[0] is an array of 5 ints,
// x[0] decays from an array of 5 ints to
// a pointer to an int.

int *pIntb = *x;
// x decays from an array of arrays of 5 ints to
// a pointer to an array of 5 ints,
// x is a pointer to an array of 5 ints,
// *x is an array of 5 ints,
// *x decays from an array of 5 ints to
// a pointer to an int.

int *pIntc = &x[0][0];
// x[0][0] is 0th element of x[0],
// where x[0] is an array of 5 ints,
// x[0][0] is an int,
// &x[0][0] is a pointer to an int.

int main(void)
{
  printf("&x=%p x=%p &x[0]=%p x[0]=%p *x=%p &x[0][0]=%p\n",
         pArr35, pArr5a, pArr5b, pInta, pIntb, pIntc);
  return 0;
} 
```

样本输出：

> &x=0040805c x=0040805c &x[0]=0040805c x[0]=0040805c *x=0040805c &x[0][0]=0040805c

所有生成的指针在值方面都是相同的，因为我显式或隐式使用了 0 的索引，并且因为数组是连续的，并且它们的第一个（IOW，第 0 个）元素始终位于数组中的最低地址。因此，即使有 3 种不同的指针类型，它们都有效地指向 x[0][0]，指向等于 1 的元素。

数组到指针的衰减是 C 和 C++ 的一个非常重要的特性，尽管很难立即掌握。

它让我们在将指针传递给数组时编写更紧凑的代码，我们可以只写数组的名称而不是获取其第一个元素的地址：

```
char str1[] = { 's', 't', 'r', '1', '\0' };
char str2[] = "str2";
printf("%s %s %s %s\n", &str1[0], str1, &str2[0], str2); 
```

输出：

> str1 str1 str2 str2

它还让我们做一些疯狂的事情：

```
int y[3] = { 10, 20, 30 };
printf("%d %d %d %d\n", y[2], *(y+2), *(2+y), 2[y]); 
```

输出：

> 30 30 30 30

这一切`a[b]`都等同`*(a+b)`于数组和指针。

# three.js - 检测与精灵相交的光线

> ID：11511787
> 
> 赞同：6
> 
> 时间：2012-07-16T20:09:10.780
> 
> 标签：three.js

在鼠标单击时，我会投射一条射线以查看哪些对象与单击相交。我有一堆可以使用的 Mesh 对象。但是，当我将 Sprite 添加到对象列表时，从未检测到 Sprite。

1) 是否应该检测到 Sprite？有什么东西使它们无法检测到吗？我需要做些什么来使它们看起来“坚固”吗？2）如果无法检测到精灵，使它们可点击的最佳方法是什么？在它们周围添加隐形圆柱体？

这是一些适用于 Mesh 的部分代码。

```
var containerPosition = $container.position();
var vector = new THREE.Vector3(((event.clientX - containerPosition.left) / scene.WIDTH) * 2 - 1, - ((event.clientY - containerPosition.top) / scene.HEIGHT) * 2 + 1, 0.5);
new THREE.Projector().unprojectVector(vector, scene.camera);
var ray = new THREE.Ray(scene.camera.position, vector.subSelf(scene.camera.position).normalize());
var intersects = ray.intersectObjects(scene.solidObjects);
if (intersects.length > 0) { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T01:18:24.510

似乎`intersectObject`Raycaster 类中的方法仅配置为查找与 THREE.Particle 和 THREE.Mesh 的碰撞。查看当前源代码：

[https://github.com/mrdoob/three.js/blob/master/src/core/Raycaster.js](https://github.com/mrdoob/three.js/blob/master/src/core/Raycaster.js)

# php - 将此 sql 语句转换为 Zend_Db_Table

> ID：11511795
> 
> 赞同：0
> 
> 时间：2012-07-16T20:09:45.557
> 
> 标签：php, zend-framework, zend-db, zend-db-table

我有这个工作正常的测试查询：

```
select `name` from `Role` as rl, `UserRole` as ur 
WHERE rl.id = ur.roleId AND ur.userId = '1' 
```

结果：`'test'`

我正在尝试使用 Zend_Table 做同样的事情，但我似乎做错了。这就是我的工作：

```
$usrRole = new Schema_UserRole(array ('db' => $db));
$role = new Schema_Role(array ('db' => $db));
$select = $role->select();
$select
    ->setIntegrityCheck(false)
    ->from(array ('rl' => $role))
    ->join(array ('ur' => $usrRole), 'rl.id = ur.roleId')
    ->where('ur.userId = ?', '1');
$rowset = $role->fetchRow($select);
$out = $rowset->toArray(); 
```

结果：`''`

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:15:48.743

我找到了，似乎它的第一个参数需要一个字符串`join`。

```
$select
    ->setIntegrityCheck(false)
    ->from($role, array('name'))
    ->joinLeft('UserRole', 'Role.id = UserRole.roleId', '')
    ->where('UserRole.userId = ?', '1'); 
```

# ruby-on-rails - 将 pengwynn linkedin gem 与设计/omniauth 相结合？

> ID：11511804
> 
> 赞同：0
> 
> 时间：2012-07-16T20:10:59.530
> 
> 标签：ruby-on-rails, devise, omniauth, linkedin

我正在尝试关注此链接以帮助将linkedin gem 与omniauthable 设计Rails 平台集成。

[http://renderedtext.com/blog/2011/08/17/how-to-use-linkedin-gem-with-omniauth/](http://renderedtext.com/blog/2011/08/17/how-to-use-linkedin-gem-with-omniauth/)

两个快速的问题！

1.  底部的“LinkedinFactory 类”文件将位于应用程序中的什么位置，它会被称为什么？我在上面的链接中没有看到目录/文件名。

2.  当我尝试通过linkedin登录时，我的应用程序当前失败：

    OmniauthCallbacksController#linkedin 中的 NoMethodError

    nil:NilClass 的未定义方法“create_linkedin_connection”

我将在哪里以及如何定义“create_linkedin_connection”方法？它在 omniauth_callbacks.rb 控制器的第 3 行中调用：

```
def linkedin
    omniauth_hash = env["omniauth.auth"]
    current_user.create_linkedin_connection(
      :token  => omniauth_hash["extra"]["access_token"].token,
      :secret => omniauth_hash["extra"]["access_token"].secret,
      :uid    => omniauth_hash["uid"]
    )
    redirect_to root_path, :notice => "You've successfully connected your LinkedIn account."
  end 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T23:24:28.147

1) 用户定义的类通常应该放在你的**lib 目录中**

2) 您在 current_user 上调用“create_linkedin_connection”方法，在这种情况下，该方法需要在用户控制器中。更改后，您需要确保在您的 routes.rb 文件中指定路由。路线应该这样定义

```
match '/auth/callback', to: 'users#create_linkedin_connection' 
```

# sql - 在 Derby WHERE 子句中使用 timestampdiff

> ID：11511805
> 
> 赞同：4
> 
> 时间：2012-07-16T20:10:59.653
> 
> 标签：sql, derby, javadb

我想在 Derby 数据库中模拟以下类型的查询（即 Microsoft SQL Server 语法）的效果。目标是返回表中存储在“someColumn”中的日期小于 7 天的所有记录。这是我希望实现的 Microsoft SQL 语法...

`select * from someTable where datediff(dd, someColumn, getdate()) < 7`

我已经能够确定在 Derby 中它将涉及使用 timestampdiff 函数。但是我不知道 Derby 中 WHERE 子句中函数使用的语法，我找不到任何示例。我发现了很多在“返回什么”子句中使用函数的例子，比如这个......

`select {fn timestampdiff(SQL_TSI_HOUR, startdate, enddate)} as diff`

但是我还没有找到如何在 WHERE 子句中使用这样的函数的示例。

我承认我的问题实际上是“如何在 Derby WHERE 子句中使用函数”，是的，它非常基本。我还发誓，在发布之前我真的很努力地寻找示例。我希望有人能帮帮忙。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-19T03:55:40.657

[您可以在原始补丁电子邮件](http://mail-archives.apache.org/mod_mbox/db-derby-dev/200505.mbox/%3C4284D2C1.3090902@sbcglobal.net%3E)中看到一个示例，

```
SELECT * FROM t WHERE {fn TIMESTAMPDIFF( SQL_TSI_DAY, CURRENT_DAY, promisedDate)} <= 1 
```

# python - 艰难地学习 Python 练习 46：在 Windows 上安装 Python 包（pip、nose 等）

> ID：11511809
> 
> 赞同：3
> 
> 时间：2012-07-16T20:11:21.217
> 
> 标签：python, installation, pip, nose

我正在使用 PowerShell 在 Windows 上使用 Zed Shaw 的“Learn Python the Hard Way”来学习 Python。我在[练习 46](http://learnpythonthehardway.org/book/ex46.html)中设置了一个骨架项目。我下载了[pip](http://pypi.python.org/pypi/pip)、[distribute](http://pypi.python.org/pypi/distribute)、[nose](http://pypi.python.org/pypi/nose/)和[virtualenv](http://pypi.python.org/pypi/virtualenv)并通过键入以下内容安装了它们：

> `python <filename>.py install`

但是，可能是因为它们没有安装在应该安装的位置，当我尝试时

> `nosetests`

我收到错误提示“术语 'nosetests' 未被识别为 cmdelt、函数、脚本文件或可运行程序的名称。请检查 mae 的拼写，或者如果包含路径，请验证路径是否正确并且再试一次...... CommandNotFoundException”。

我一直在炼功，所以我认为路径是正确的，但你现在必须改变它吗？现在，我有我的骨架（..project/skelton）的目录下的包。对于一个真正的初学者问题，我很抱歉，但如果有人可以帮助我解决这个问题，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-04T12:37:43.610

我有同样的错误，但答案在书中。在powershell中输入这个，希望它也适合你。

```
[Environment]::SetEnvironmentVariable("Path", "$env:Path;C:\Python27", "User") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:30:54.223

尝试这个：

> ```
> // make sure you have pip and virtualenv installed
> cd project
> // create a virtual environment
> virtualenv venv --distribute
> // activate the virtual environment 
> // I'm not 100% sure, but I think this is correct way on windows
> venv\Scripts\activate.bat
> // install nose
> pip install nose 
> ```

只要您的 virtualenv 被激活，您现在应该能够运行鼻子测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-25T11:48:12.773

也许这对您的问题来说已经晚了，但这可能会帮助其他将遇到与我们遇到的相同问题的人。我有我的工作做ff。脚步：

（假设你已经下载了书中讨论的所有包）：

1.  [来自https://bootstrap.pypa.io/get-pip.py](https://bootstrap.pypa.io/get-pip.py)的pip （将其保存为 python 文件）
2.  从[http://pypi.python.org/pypi/distribute分发](http://pypi.python.org/pypi/distribute)
3.  [来自http://pypi.python.org/pypi/nose/](http://pypi.python.org/pypi/nose/)的鼻子
4.  [来自http://pypi.python.org/pypi/virtualenv](http://pypi.python.org/pypi/virtualenv)的 virtualenv

按照这个安装所有：

*   以管理员身份运行 Windows Powershell
*   cd C:\Path_Where_You_Downloaded_get-pip.py
*   使用命令“python get-pip.py”安装 pip
*   以管理员身份运行命令提示符
*   cd 到 Python27 脚本的位置（在我的例子中是 C:\Python27\Scripts）
*   尝试使用命令 'pip install --upgrade pip' 更新 pip
*   使用此命令安装 Nose 'pip install C:\Path_Where_You_downloaded_nose'
*   使用命令“pip install deploy”安装分发

希望这可以帮助！

# sql-server - 如何在 SQL Server 2008 上调试 EXCEPTION_ACCESS_VIOLATION

> ID：11511810
> 
> 赞同：4
> 
> 时间：2012-07-16T20:11:21.387
> 
> 标签：sql-server, sql-server-2008

使用数据库的应用程序突然中断。我开始调查并注意到一个简单的计数查询

```
SELECT count(uberdataid) FROM [Alexander].[dbo].[UberData] 
```

在 SQL Server 中创建错误：

> 消息 0，级别 11，状态 0，行 0 当前命令发生严重错误。结果，如果有的话，应该丢弃

一些想法：

*   当我检查错误的堆栈跟踪时，它说有一个 EXCEPTION_ACCESS_VIOLATION。该异常的名称使我认为查询中可能存在权限问题。但是我在许多不同的用户帐户上都遇到了同样的错误（之前都能够毫无问题地查询数据库）。

*   这个关于 SO ( [Exception Access Violation in SQL](https://stackoverflow.com/questions/1098392/exception-access-violation-in-sql) ) 的讨论让我认为查询可能会遇到一个挥之不去的记录锁，但我已经重新启动了服务器，所以这似乎不太可能。

网上其他留言板也有一些其他未解决的讨论。

有任何想法吗？

Stackoverflow 不会让我发布整个跟踪（太长），但如果人们需要查看相关部分，我很乐意发布。我不知道跟踪中的哪些部分最重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:40:38.167

这看起来像一个 SQL Server 错误。`EXCEPTION_ACCESS_VIOLATION`意味着 SQL Server 内部的代码试图访问“无效”内存（例如，取消引用`NULL`指针）。它与 SQL Server 安全设置无关。

即使这可能是一个错误，我建议您运行

```
DBCC CHECKDB WITH EXTENDED_LOGICAL_CHECKS, DATA_PURITY, NO_INFOMSGS 
```

在有问题的数据库上。可能存在触发 SQL Server 错误的损坏。

# objective-c - NSMutableArray 计数总是返回 (null)

> ID：11511815
> 
> 赞同：0
> 
> 时间：2012-07-16T20:11:43.797
> 
> 标签：objective-c, nsmutablearray

谁能告诉我为什么 [NSMutableArray count] 在调试窗口中总是返回（null）？它已初始化，匹配的字母正在注册，但它仍然不返回任何内容，但为 null。

```
@implementation NSString (Word)
-(NSMutableArray *)placeOfLetter: (char)letterAsked;{

    NSMutableArray *matchingLetters;
    matchingLetters=[[NSMutableArray alloc]init];
    int len=(int)[self length];
    NSLog(@"length of word: %i, letterAsked=%c",len,letterAsked);
    NSUInteger counter=[matchingLetters count];

    for (NSUInteger x=0; x<[self length]; x++) {
        if ([self characterAtIndex:x]==letterAsked){
            NSNumber *foundPosition = [NSNumber numberWithUnsignedInteger:x];
            [matchingLetters addObject:foundPosition];
            NSLog(@"found at place : %@",foundPosition);
            NSLog(@"counter: %@",counter);
        }
    }
    if ([matchingLetters count]<=0){
         NSLog(@"counter: %@",counter);
         NSLog(@"no letters ");
        return nil;
    }else{
        return matchingLetters;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:21:42.823

我假设您指的是`counter`变量？您在添加任何元素**之前**`matchingLetters`将计数分配给此变量，因此此时它当然被分配为 0。

 **当您稍后`NSLog()`计算 的值时，它仍然为 0。一旦您将元素添加到此数组`counter`，没有自动更新机制会神奇地使用新计数更新计数器。`matchingLetters`它显示为 (null)，因为您使用`%@`的是`%qu`.

如果这不是您所指的，您是否指的是在调试器中破坏您的应用程序然后进入`p -[matchingLetters count]`？还是您指的是调试控制台左侧显示的部分变量（如果是这样，您所看到的屏幕截图可能会有所帮助）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:26:04.963

> NSLog(@"计数器：%@",counter);

您在`%@`此处使用格式说明符，这意味着`NSLog`需要一个对象指针。但是你传入的`NSUInteger`只是一个数字。

如果您在这里得到“（null）”，那么您很幸运该数组中没有任何对象。如果数组有一些对象，你会得到一个像`7`back 这样的数字，并将其解释为指向对象的指针可能会导致崩溃。

解决方法是简单地使用正确的格式说明符 ( `%u`) 代替：

```
NSLog(@"counter: %u",counter); 
```**

# matlab - 圆与线的交点

> ID：11511816
> 
> 赞同：-2
> 
> 时间：2012-07-16T20:11:48.093
> 
> 标签：matlab, geometry

> **可能重复：**
> [圆线碰撞检测](https://stackoverflow.com/questions/1073336/circle-line-collision-detection)

如何找到具有不同斜率的圆和直线（非直线）的交点。

线的点如下所示：

θ=0:.01:2*pi;

x1=5*cos(θ)+4；

y1=5*cos(θ)+1；

```
x=[1 1 4 7 7 8 8 8]
y=[2 3 3 3 5 8 8 8] 
```

还有，我如何计算这条线的长度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:20:40.493

如果您有折线，请在折线的每个直线段上使用[此处包含的数学公式。](http://mathworld.wolfram.com/Circle-LineIntersection.html)您之前已经问过这个问题，因此您应该能够针对单个线段进行此操作。您需要做的就是将多段线分解为其组成部分并解决每个部分的问题并存储交点。

# c++ - 读取协议缓冲区中枚举扩展的值

> ID：11511822
> 
> 赞同：4
> 
> 时间：2012-07-16T20:12:18.780
> 
> 标签：c++, protocol-buffers

我刚刚问 [了这个问题](https://stackoverflow.com/questions/11474416/define-dictionary-in-protocol-buffer)，并决定在我的协议缓冲区中编写枚举值的扩展。但是，即使使用这个简单的 .proto 文件，我也很难真正读回这些值：

```
package test;

import "google/protobuf/descriptor.proto";

extend google.protobuf.EnumValueOptions {
  optional string abbr = 54321;
}

message Person {
    required string name = 1;
    required int32 id = 2;
    optional string email = 3;
    enum PhoneType { MOBILE = 0 [(abbr)="Mobile ph"]; HOME = 1 [(abbr)="HomePhone"]; WORK = 2 [(abbr)="Work number"]; }

    message PhoneNumber {
        required string number = 1;
        optional PhoneType type = 2 [default = HOME];
    }

    repeated PhoneNumber phone = 4;
}

message AddressBook {
    repeated Person person = 1;
} 
```

我一直在尝试这些和其他变体：

```
test::Person::PhoneNumber::descriptor()->options().GetExtension(test::abbr);
test::Person::PhoneNumber::descriptor().GetExtension(test::abbr);
test::Person::descriptor()->options().GetExtension(test::abbr);

const google::protobuf::Descriptor* message = test::Person::PhoneNumber::descriptor();
const google::protobuf::Descriptor* desc = phone2.descriptor();
desc->options().GetExtension(test::abbr); //D.N.E.

google::protobuf::MessageOptions opts = message->options();
opts.GetExtension(test::abbr);

const google::protobuf::EnumDescriptor* enm = message->FindEnumTypeByName("PhoneNumber"); // null, not found
google::protobuf::EnumValueOptions opts2 = enm->value(1)->options();
opts2.GetExtension(test::abbr);

test::Person::PhoneNumber::descriptor()->options().GetExtension(test::abbr); 
```

以上都不起作用 - 方法根本不存在，或者没有对该函数签名的匹配调用。我已经阅读了几个小时的文档无济于事。我知道这应该是可能的，但唯一的例子是编写 .proto 文件，而不是从它们中读取——我该怎么做？一个简短的例子将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T00:58:05.850

这有点令人费解，但您需要获取[`EnumValueDescriptor`](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor#EnumValueDescriptor)电话类型，然后调用`options().GetExtension(test::abbr)`它。

例如：

```
test::Person person;
person.set_name("Caol Ila");
person.set_id(1);

test::Person::PhoneNumber *phone = person.add_phone();
phone->set_number("01496 840207");
phone->set_type(test::Person::MOBILE);

phone = person.add_phone();
phone->set_number("01496 840207");
phone->set_type(test::Person::HOME);

phone = person.add_phone();
phone->set_number("01496 840207");
phone->set_type(test::Person::WORK);

phone = person.add_phone();
phone->set_number("01496 840207");

const google::protobuf::EnumDescriptor* enum_desc =
    test::Person::PhoneType_descriptor();
std::string value;

for (int phone_index = 0; phone_index < person.phone_size(); ++phone_index) {
  if (person.phone(phone_index).has_type()) {
    int phone_type = person.phone(phone_index).type();
    value = enum_desc->value(phone_type)->options().GetExtension(test::abbr);
  }
} 
```

# sql-server - 在更新语句中连接多个表

> ID：11511826
> 
> 赞同：7
> 
> 时间：2012-07-16T20:12:48.190
> 
> 标签：sql-server

我正在尝试在更新语句中加入三个表，但到目前为止我一直没有成功。我知道这个查询适用于连接两个表：

```
update table 1
set x = X * Y
from table 1 as t1 join table 2 as t2 on t1.column1 = t2.column1 
```

但是，就我而言，我需要加入三个表：

```
update table 1
set x = X * Y
from table 1 as t1 join table 2 as t2 join table3 as t3 
on t1.column1 = t2.column1 and t2.cloumn2 = t3.column1 
```

不管用。我还尝试了以下查询：

```
update table 1
set x = X * Y
from table 1, table 2, table 3
where column1 = column2 and column2= column3 
```

有谁知道实现这一目标的方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-16T20:15:06.190

你肯定不想使用`table, table, table`语法；[这就是为什么](https://sqlblog.org/2009/10/08/bad-habits-to-kick-using-old-style-joins)。至于您的中间代码示例，连接语法遵循与 . 的规则大致相同的`SELECT`规则`UPDATE`。`JOIN t2 JOIN t3 ON ...`无效，但`JOIN t2 ON ... JOIN t3 ON`有效。

所以这是我的建议，虽然它应该被更新以完全限定`y`来自哪里：

```
UPDATE t1
  SET x = x * y  -- should either be t2.y or t3.y, not just y
  FROM dbo.table1 AS t1
  INNER JOIN table2 AS t2
  ON t1.column1 = t2.column1
  INNER JOIN table3 AS t3
  ON t2.column2 = t3.column1; 
```

# regex - 在 vim 中使用 :g 命令进行多个操作

> ID：11511827
> 
> 赞同：6
> 
> 时间：2012-07-16T20:12:48.157
> 
> 标签：regex, vim, command, macvim, text-processing

我怎样才能使用这样的东西？

```
:g/^$/kJ 
```

这里 kJ 是两个命令，而不仅仅是一个（如 'd'）

我的具体例子：我有多行看起来像这样

```
queryBuilder
    .append("xyz"); 
```

我想让它们看起来像这样：

```
queryBuilder.append("xyz"); 
```

所以我想为每一行做的是

```
:g/^[\t]*\..*$/kJx 
```

它匹配正确的模式，但似乎只执行 k。

其他 vim 命令适合这里吗？您将如何执行此任务？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T20:17:08.937

添加`normal`指令以执行所有这些指令，例如：

```
:g/^[\t]*\..*$/normal kJx 
```

# magento - Magento 简单的产品图片

> ID：11511829
> 
> 赞同：1
> 
> 时间：2012-07-16T20:13:02.473
> 
> 标签：magento

我有一个关于 Magento 简单产品图像作为可配置产品变体的问题。因此，如开发指南中所述，需要上传每个产品变体（简单产品）的图像，以便使用 Colorswatch 扩展，以便能够通过单击颜色样本来更改前端的产品图像。每个产品也有大小属性​​，这使得很多产品变体和很多相同的图像上传。如果我有 5 种尺寸和 3 种颜色的产品，以及每种颜色的 5 张图片，我必须为每种颜色上传 5 次（5 种尺寸）整套图片（在这种情况下为 5 张图片）。问题是，有没有办法只上传一组颜色变化的所有尺寸的一种颜色的图像？由于库存控制，将可配置产品与简单产品一起用于变化至关重要。

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:25:45.473

不幸的是，您必须为每个产品变体上传图片。
但是，您可以自定义 Magento 以同步相同颜色和不同尺寸的每个简单产品的图像（在可配置产品内部）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-27T09:45:37.973

正如[Roman Snitko](https://stackoverflow.com/users/473281/roman-snitko)建议的那样，我们可以在具有不同属性（颜色、尺寸）的产品下显示多个图像/单个图像。

在 Magnto-2.1.8 中，您可以按照以下步骤执行此操作。

1.  去`Products > Catalog`
2.  选择要编辑的产品。
3.  `Content > Configurations > Edit Configurations`.
4.  根据您的要求选择/创建所需的属性。
5.  创建属性值。
6.  选择是要对同一产品使用不同的图像还是使用单个图像来表示具有不同属性值的产品。（对于具有不同属性值的同一产品，我们可以使用不同的价格和数量）。
7.  保存配置更改。

# android - 使用太多 Fragment 有什么缺点吗？

> ID：11511830
> 
> 赞同：2
> 
> 时间：2012-07-16T20:13:03.697
> 
> 标签：android, android-fragments

我正在开发一个平板电脑用户界面，所有内容都显示在一个屏幕上。基本上，我主要有两个内容，一个是ListFragment，一个是内容。但是，我需要显示：

*   动态更新的当前位置。
*   我还需要显示带有当前日期和时间的数字时钟。
*   一个计时器，显示自应用程序启动以来已经过去了多长时间。
*   跟踪器显示列表中的项目数和当前正在显示的项目等。

所有这些功能都被设计为保留在一个单独的位置。

所以现在我不确定我是否将它们放入自己的 Fragment 中是否会对将它们全部放入一个活动中产生任何后果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:34:39.153

A`Fragment`应该代表一个独立的行为。您的所有四个点都是全局属性（即当前日期/时间、位置、计时器）或依赖于另一个`Fragment`（即当前选定的列表项）。所以听起来你想将所有四个组合成一个`Fragment`。然后为活动实现一个回调方法，该方法将更新当前选定的列表项编号。

# c# - 我如何遍历两个列表 在另一个列表中？然后把琴弦放到一个键上？几乎可以工作

> ID：11511831
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:13:06.180
> 
> 标签：c#

在for循环中我做了：

```
string[] xFrames = new string[wocl.Count];
            string[] yFrames = new string[wocl.Count];
            List<float> Xframes = new List<float>(wocl.Count);
            List<float> Yframes = new List<float>(wocl.Count);
            for (int i = 0; i < wocl.Count; i++)
            {
                string X = xFrames[i] = string.Format("Frame_X_{0} ", i + 1);
                string Y = yFrames[i] = string.Format("Frame_Y_{0} ", i + 1);

                for (int j = 0; j < wocl[i].Point_X.Count; j++)
                {
                   // xFrames[i] += string.Format("{0},", wocl[i].Point_X[j]);
                   // yFrames[i] += string.Format("{0},", wocl[i].Point_Y[j]);
                    Xframes.Add(wocl[i].Point_X[j]);
                    Yframes.Add(wocl[i].Point_X[j]);

                }

                //xFrames[i].Trim(",".ToCharArray());
                //yFrames[i].Trim(",".ToCharArray());

                setting_file.SetListFloatKey(X, Xframes);
                setting_file.SetListFloatKey(Y, Yframes);

            } 
```

文本文件中的结果是：

```
Frame_X_1 =325,332,322,332,325
Frame_Y_1 =325,332,322,332,325
Frame_X_2 =325,332,322,332,325,318,332,322,332,325
Frame_Y_2 =325,332,322,332,325,318,332,322,332,325
Frame_X_3 =325,332,322,332,325,318,332,322,332,325,318,332,322,355,325
Frame_Y_3 =325,332,322,332,325,318,332,322,332,325,318,332,322,355,325
Frame_X_4 =325,332,322,332,325,318,332,322,332,325,318,332,322,355,325,318,388,322,355,325
Frame_Y_4 =325,332,322,332,325,318,332,322,332,325,318,332,322,355,325,318,388,322,355,325 
```

不知道为什么 = 之后右边的数字应该在每帧 x 和 y 相同的数字/坐标中。

像在 Frame_X_1 而不是在 Frame_X_4 或不像在 Frame_X_2 出于某种原因，它不断添加数字。

我使用的 setting_file 连接到 OptionsFile 类：

```
/*----------------------------------------------------------------
 * Module Name  : OptionsFile
 * Description  : Saves and retrievs application options
 * Author       : Danny
 * Date         : 10/02/2010
 * Revision     : 1.00
 * --------------------------------------------------------------*/

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.IO;
using System.Configuration;

/*
 *  Introduction :
 * 
 *  This module helps in saving application options
 * 
 * 
 *  Typical file could look like this:
 *  user_color=Red
 *  time_left=30
 *  
 * 
 * 
 * 
 * 
 * */

namespace DannyGeneral
{
    class OptionsFile
    {
        /*----------------------------------------
         *   P R I V A T E     V A R I A B L E S 
         * ---------------------------------------*/

        /*---------------------------------
         *   P U B L I C   M E T H O D S 
         * -------------------------------*/
        string path_exe;
        string temp_settings_file;
        string temp_settings_dir;
        string Options_File;
        StreamWriter sw;
        StreamReader sr;

/*----------------------------------------------------------
 * Function     : OptionsFile
 * Description  : Constructor
 * Parameters   : file_name is the name of the file to use
 * Return       : none
 * --------------------------------------------------------*/
    public OptionsFile(string settings)
    {
        if (!File.Exists(settings))
        {
            if (!Directory.Exists(Path.GetDirectoryName(settings)))
            {
                Directory.CreateDirectory(Path.GetDirectoryName(settings));
            }
            File.Create(settings).Close();
        }
        path_exe = Path.GetDirectoryName(Application.LocalUserAppDataPath);
        Options_File = settings; 
    }

/*----------------------------------------------------------
 * Function     : GetKey
 * Description  : gets the value of the key.
 * Parameters   : key
 * Return       : value of the key if key exist, null if not exist
 * --------------------------------------------------------*/
    public string GetKey(string key)
    {

      //  string value_of_each_key;
        string key_of_each_line;
        string line;
        int index;
        string key_value;
        key_value = null;

        sr = new StreamReader(Options_File);
        while (null != (line = sr.ReadLine()))
        {

            index = line.IndexOf("=");

           //    value_of_each_key = line.Substring(index+1);

            if (index >= 1)
            {
                key_of_each_line = line.Substring(0, index);
                if (key_of_each_line == key)
                {
                    key_value = line.Substring(key.Length + 1);
                }

            }
            else
            {
            }

        }
        sr.Close();
        return key_value;
    }

/*----------------------------------------------------------
 * Function     : SetKey
 * Description  : sets a value to the specified key
 * Parameters   : key and a value
 * Return       : none
 * --------------------------------------------------------*/
    public void SetKey(string key , string value)
    {
        bool key_was_found_inside_the_loop;
        string value_of_each_key;
        string key_of_each_line ;
        string line;
        int index;
        key_was_found_inside_the_loop = false;

        temp_settings_file = "\\temp_settings_file.txt";
        temp_settings_dir = path_exe + @"\temp_settings";
        if (!Directory.Exists(temp_settings_dir))
        {
            Directory.CreateDirectory(temp_settings_dir);
        }

        sw = new StreamWriter(temp_settings_dir+temp_settings_file);
        sr = new StreamReader(Options_File);
        while (null != (line = sr.ReadLine()))
        {

            index = line.IndexOf("=");
            key_of_each_line = line.Substring(0, index);
            value_of_each_key = line.Substring( index + 1);
         //   key_value = line.Substring(0,value.Length);
            if (key_of_each_line == key)
            {
                sw.WriteLine(key + " = " + value);
                key_was_found_inside_the_loop = true;

            }
            else
            {
                sw.WriteLine(key_of_each_line+"="+value_of_each_key);
            }

        }

        if (!key_was_found_inside_the_loop)
        {
           sw.WriteLine(key + "=" + value);
        }
        sr.Close();
        sw.Close();
        File.Delete(Options_File);
        File.Move(temp_settings_dir + temp_settings_file, Options_File);
        return;

    }

    public List<float> GetListFloatKey(string keys)
    {
        List<float> result = new List<float>();
        string s = GetKey(keys);
        if (s != null)
        {
            string[] items = s.Split(new char[] { ',' });
            float f;
            foreach (string item in items)
            {
                if (float.TryParse(item, out f))
                    result.Add(f);
            }
            return result;
        }
        else
        {
            return result;
        }
    }

    public void SetListFloatKey(string key, List<float> Values)
    {
        StringBuilder sb = new StringBuilder();
        foreach (float value in Values)
        {
            sb.AppendFormat(",{0}", value);
        }
        if (Values.Count == 0)
        {
        }
        else
        {
            SetKey(key, sb.ToString().Substring(1));
        }
    } 
```

不知道这里的数字有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:21:06.397

您以这种方式使用双循环：

```
string[] xFrames = new string[wocl.Count];
string[] yFrames = new string[wocl.Count];

for (int i = 0; i < wocl.Count; i++)
{
   xFrames[i] = string.Format("Frame_X_{0} ", i + 1);
   yFrames[i] = string.Format("Frame_Y_{0} ", i + 1);

   for(int j =0; j < wocl[i].Length; j++)
   {
       xFrames[i] += string.Format("{0},", wocl[i].Point_X[j]);
       yFrames[i] += string.Format("{0},", wocl[i].Point_Y[j]);
   }

   xFrames[i].Trim(",".ToCharArray());
   yFrames[i].Trim(",".ToCharArray());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:21:22.910

很难说出你想要做什么。但据我所知，您希望通过应用某种转换或组合来生成结果列表，将两个或更多列表组合成其他列表。

为此，我认为您可能需要查看[`Enumerable.ZipEnumerable.Zip<TFirst, TSecond, TResult>`](http://msdn.microsoft.com/en-us/library/dd267698.aspx)扩展方法。

例如，如果您有两个列表（伪代码）：

```
val = 1, 2, 3, 4
names = "one", "two", "three", "four" 
```

Zip 算法将允许您将这些组合成一个 int、string 元组的列表：

```
result = (1,"one"), (2,"two"), (3,"three"), (4,"four") 
```

希望我在这里适合您尝试做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:23:05.103

您似乎想要迭代迭代。

```
var output = new StringBuilder();
for(var index=0; index < wocl.Count; index++)
{
  var item = wocl[index];
  output.AppendFormat("Frame_X_{0}", index);

  for(var index2=0; index2 < item.Point_X.Count; index2++ )
  {
     output.AppendFormat(" {0}", item.Point_X[index2]);
  }

  output.AppendFormat("Frame_Y_{0}", index);

  for(var index2=0; index2 < item.Point_Y.Count; index2++ )
  {
     output.AppendFormat(" {0}", item.Point_Y[index2]);
  }
}

string resultText = output.ToString(); 
```

# c++ - 多种类型的锯齿状数组

> ID：11511833
> 
> 赞同：2
> 
> 时间：2012-07-16T20:13:16.290
> 
> 标签：c++, c#-4.0, jagged-arrays

我不确定是否可能，但锯齿状数组是否可以包含多种类型

我需要一个分层的数据结构，其中第一个 2D 层是字节类型然后接下来的 2D 层可以是整数类型或浮点类型，最后 2D 层将再次是字节，层的总数可以变化。

如果是的话，这可能吗，我将如何在 C# 中声明它以及如何在 C++ 中声明它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:15:18.683

我不了解 C#，但你不能在 C++ 中做到这一点（至少不能以同时有用、有意义和明确定义的方式）。

作为第一种解决方法，我建议使用数组结构：¹

```
struct Stuff {
    byte *bytes;
    int  *ints;
    byte *bytesAgain;
}; 
```

这并不能满足您希望层数变化的愿望。目前尚不清楚这如何工作。你怎么知道每一层应该包含什么？

[*也许如果您编辑问题以解释您要解决的问题，我可以给出更集中的答案。*]

* * *

[1\. 由于这是 C++，而不是 C，请考虑使用类似容器`std::vector`而不是原始 C 样式的数组和指针。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:29:44.113

C# 中的一种方法可能是以下之一：

```
// Base class for each layer
abstract class Layer
{
    public abstract int Rank { get; }
    public abstract int GetLength(int dimension);
}

// Individual layers would inherit from the base class and handle
// the actual input/output
class ByteLayer : Layer
{
    private byte[,] bytes;

    public override int Rank { get { return 2; } }

    public override int GetLength(int dimension)
    {
        return this.bytes.GetLength(dimension);
    }

    public ByteLayer(byte[,] bytes)
    {
        this.bytes = bytes;
    }

    // You would then expose this.bytes as you choose
}
// Also make IntLayer and FloatLayer 
```

然后，您可以创建一个抽象来保存这些层类型中的每一个：

```
class Layers : IEnumerable<Layer>
{
    private ByteLayer top, bottom;
    private List<Layer> layers = new List<Layer>();

    public ByteLayer Top { get { return top; } }
    public IEnumerable<Layer> Middle { get { return this.layers.AsEnumerable(); } }
    public ByteLayer Bottom { get { return bottom; } }

    public Layers(byte[,] top, byte[,] bottom)
    {
        this.top = top;
        this.bottom = bottom;
    }

    public void Add(int[,] layer)
    {
        this.layers.Add(new IntLayer(layer));
    }

    public void Add(float[,] layer)
    {
        this.layers.Add(new FloatLayer(layer));
    }

    public IEnumerator<Layer> GetEnumerator()
    {
        yield return bottom;
        foreach (var layer in this.layers) yield return layer;
        yield return top;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:26:42.267

图层对象的矢量将起作用。Layer 对象将有一个指向 2D 数组的指针和一个表示 2D 数组类型的“提示”值。添加新图层时，您将向向量推送一个图层，该图层在构造时会被告知它是什么类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T20:22:53.470

您已经将数据结构划分为层，为什么不在代码中也这样做呢？对第一层和最后一层使用两个 2D 字节数组，对中间的层集使用一个 3D 数组？

对于中间层中的数据类型，如果您注意记住哪个类型存储在哪个元素中，则可以使用联合。如果没有，您可以使用结构甚至类。

此外，您也可以将整个内容包装在一个类中。

虽然这是一个可疑的具体问题。您已经决定需要存储一个包含各种类型的锯齿状数组。*为什么？*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T20:19:10.117

当然可以。只需使用一些对象和一些抽象。

你有没有锯齿状的数组是一些对象类型。然后该对象可以有一个 getType() 和一个 getValue()。GetType() 将返回一些枚举，而 getValue() 将返回实际对象。

我认为这是不直观且不易维护的。有没有更好的方法可以存储您的数据？将每个“层”作为单独的数组/对象怎么样？

# python - python字典，存储在mongodb中，在ruby on rails中检索

> ID：11511840
> 
> 赞同：0
> 
> 时间：2012-07-16T20:13:48.417
> 
> 标签：python, ruby, mongodb

我有一个运行周期性进程的 python 脚本，然后在 mongodb 中存储许多未知大小的列表字典。

例如，

`[0:{1, 2, 3}, 1: {8, 9, 10}, 2: {5, 12, 12}]`

然后我尝试从 ruby​​ on rails (ror) 应用程序中检索这些数据。

有没有办法以预先格式化的方式（例如在哈希中）在 ror 中检索这些字典？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:18:38.400

这里最好的答案是不要将数据存储为 Python 字典，因为这是一种您不太可能在 Ruby 中找到易于阅读的解决方案的格式。我敢打赌，Ruby 中有一个很好的 JSON 实现，而[Python 中也有一个](http://docs.python.org/library/json.html)- 所以我会说在 Python 中编码为 JSON，在 Ruby 中解码。

# ruby - 在 Ruby 中设置哈希等于另一个哈希

> ID：11511841
> 
> 赞同：5
> 
> 时间：2012-07-16T20:13:49.503
> 
> 标签：ruby, hashtable

我想跟踪一些任意命名的字符串的计数，然后将计数重置为零。我的想法是执行以下操作：

```
reset_hash={"string1"=>0,"string2"=>0,"string3"=>0}
=> {"string1"=>0, "string2"=>0, "string3"=>0} 

new_hash = reset_hash
=> {"string1"=>0, "string2"=>0, "string3"=>0} 

new_hash["string1"]=1
new_hash["string3"]=1
new_hash
=> {"string1"=>1, "string2"=>0, "string3"=>1} 
```

...

现在我想将 new_hash 重置为 reset_hash：

```
new_hash = reset_hash
=> {"string1"=>1, "string2"=>0, "string3"=>1}
reset_hash
=> {"string1"=>1, "string2"=>0, "string3"=>1} 
```

这里发生了什么？看来reset_hash实际上已经设置为new_hash，这与我想要的相反。如何实现所需的行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T20:28:36.237

正如其他人提到的，您必须使用[clone](http://ruby-doc.org/core-1.9.3/Object.html#method-i-clone)。您的任务应如下所示：

```
reset_hash={"string1"=>0,"string2"=>0,"string3"=>0}
new_hash = reset_hash.clone

new_hash["string1"]=1
new_hash["string3"]=1
new_hash

new_hash = reset_hash.clone
reset_hash 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T20:25:24.310

当你有一个指向一个对象的变量时，你实际上只是有一个对该对象的引用。如果 a 和 b 都指向哈希 {1=>3, "foo" => 54}，则更改 a 或 b 将更改另一个。

但是，您可以结合使用两种方法来制作您想要的东西。

哈希的默认值：

```
new_hash = Hash.new(0) 
```

这为未使用的值提供了默认值 0：

```
new_hash["eggs"]  # -> 0 
```

然后，您可以添加计数：

```
new_hash["string1"] += 1 # => 1 
```

完成后只需致电

```
new_hash.clear # => {} 
```

并且您的哈希将被重置，但新访问仍将默认为 0。

请注意，如果您将默认值设置为数字以外的对象类型，您可能会因为上面提到的整个参考问题而进行更改。

```
irb(main):031:0> b = Hash.new("Foo") #=> {}
irb(main):032:0> b[3] #=> "Foo"
irb(main):033:0> b[33] #=> "Foo"
irb(main):034:0> b[33].upcase! #=> "FOO"
irb(main):035:0> b[3] # => "FOO" 
```

为了解决这个问题，您可以将一个块传递给您的哈希：

```
h = Hash.new {|hash, key| hash[key] = "new default value"} 
```

这每次都会在 key 处创建一个新对象，因此对一个对象的更改不会产生涟漪：

```
d = Hash.new{ |hash,key| hash[key] = "string"} #=> {}
d[3] # => "string"
d[3].upcase! #=> "STRING"
d[5] #=> "string" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T20:16:35.843

您正在修改单个哈希。

两个变量都引用同一个哈希。当您更改散列中的项目时，两个引用都将反映该更改 - 因为它是相同的散列实例。

也许您想先复制哈希？如果你这样做了，并且你有一个包含复杂对象的哈希，你还需要研究浅拷贝和深拷贝/克隆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T20:17:26.157

您需要使用克隆来制作副本。

见[https://stackoverflow.com/a/4157438/1118101](https://stackoverflow.com/a/4157438/1118101)

否则，您只会创建 2 个指向同一个哈希的“指针”，而不是复制内容。

然后使用 replace 将克隆的内容复制回您现有的哈希中。

# c++ - 如何访问“askpass”程序以在 GUI 中获取 root 权限？

> ID：11511842
> 
> 赞同：1
> 
> 时间：2012-07-16T20:13:52.370
> 
> 标签：c++, linux, qt, ubuntu, root

我正在构建我计划上传到 Ubuntu 软件中心的第一个相当大的 Linux 程序，但我遇到了一个问题：我认为`system("sudo mkdir /opt/test");`在图形程序中调用类似的东西会自动弹出一个询问 root 的小对话框密码，但它没有。我收到错误：“sudo：不存在 tty，也没有指定 askpass 程序”

那么我假设当用户无权访问终端时自动处理这是不正确的吗？如果是这样，Ubuntu 的默认“askpass”程序是什么，我该如何称呼它？我可以使用 gksudo 吗？

我真的很感激一些帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:54:12.270

我想到了。您可以为此使用*gksudo ，并格式化命令以满足您的需要。*

```
system("gksudo mkdir testdir"); 
```

# sql - 选择并加入问题

> ID：11511843
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:13:57.187
> 
> 标签：sql, sql-server-2005, join, select-into

我的问题源于此：

[VBA（Excel）与 SQL - 比较两行中的值（循环）](https://stackoverflow.com/questions/11420983/vba-excel-vs-sql-comparing-values-in-two-rows-loop)

我稍微修改了脚本，它看起来像这样：

```
;WITH data AS 
( 
   SELECT a.i, a.M, b.M as NextM, 
   CASE WHEN a.M = 65 AND b.M = 120 THEN 1 ELSE 0 END AS shouldIncreaseQ   
   FROM MyTable a       
   LEFT OUTER JOIN MyTable b      
   ON a.i + 1 = b.i 
), test as
(
   SELECT data.M, data.NextM, 
   (SELECT COUNT(*) + 1 FROM data AS ref 
   WHERE ref.shouldIncreaseQ = 1 AND ref.i <= data.i) as Q FROM data 
) 
```

所以现在让我们从测试中选择 *。我得到看起来像这样的东西。

```
M      NextM     Q
65     65        1
65     65        1
65     120       2
120    63        2
65     120       3
120    NULL      3 
```

现在.. 我想要的只是获取 Q 列（其中 Q 与 NextM 相关）并将其放入我原来的 mytable 中。

所以是这样的：

```
i     M      Q
1     65     1
2     65     1
3     120    2
4     63     2
5     120    3
6     55     3 
```

我希望这是有道理的。我一直在玩select into，甚至插入所有DAY（字面意思是小时），但没有运气。（使用你能想象到的每一种加入方式）

先感谢您。（也有人可以告诉我如何让我的表格看起来更好......你使用html来做还是什么）？

更新：

```
;WITH data AS 
 ( 
   SELECT a.i, a.M, b.M as NextM, 
   CASE WHEN a.M = 65 AND b.M = 120 THEN 1 ELSE 0 END AS shouldIncreaseQ   
   FROM MyTable a       
   LEFT OUTER JOIN MyTable b      
   ON a.i + 1 = b.i 
 ), 
test as
(
   SELECT data.i, data.M, data.NextM, 
   (SELECT COUNT(*) + 1 FROM data AS ref 
   WHERE ref.shouldIncreaseQ = 1 AND ref.i <= data.i) as Q FROM data 
),
final as
(
   select a.i, a.M as zw_step,  b.Q as prodid
   from test a
   left outer join test b
   on a.i - 1 = b.i
)

SELECT final.i, final.zw_step, final.prodid
FROM final 
```

现在.. select 语句是我喜欢的方式。除了该死的东西不适用于 insert into 命令..（您可能不得不与 final 混为一谈）。我现在害怕 CTE，我可能永远不会再使用它们了。

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T13:11:21.150

好的，我不太确定我是否正确理解您要查找的内容。但你可能想更换

```
SELECT final.i, final.zw_step, final.prodid
FROM final; 
```

和

```
UPDATE MT
  SET MT.Q = F.prodid
  FROM MyTable AS MT
  INNER JOIN final AS F ON MT.i = F.i AND MT.M = F.zw_step; 
```

这会将 in 列中的值替换为 in 列`Q`中的`MyTable`值。这是你想要做的吗？（基于“现在..我想要的只是获取 Q 列（其中 Q 与 NextM 相关）并将其放入我原来的 mytable 中。”）`prodid``final`

# google-app-engine - webapp2的数据库迁移工具

> ID：11511844
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:14:01.290
> 
> 标签：google-app-engine, google-cloud-datastore, webapp2, sqlmigrations

我是 webapp2 和 GAE 的新手。我想知道，我是否必须为我的模型声明所有数据库表？我不介意手动编写 SQL。但我不想重新发明轮子。Webapp2 是否有任何数据库迁移工具？

# 编辑

我有一个模型：

```
import logging                                             
from google.appengine.ext import db                        
from google.appengine.api import rdbms                     

_INSTANCE_NAME = 'webosteam1:webosteamdb'                  
_DataBase = 'webosdb'                                      

class Usr(db.Model):                                       
    usrID = db.IntegerProperty()                           
    usrName = db.StringProperty()                          
    usr = db.UserProperty()                                
    loginType = db.IntegerProperty()                       
    usrType = db.IntegerProperty()                         
    geoLoc = db.ReferenceProperty(GeoLoc) #GeoLoc reference
    dateCreated = db.DateTimeProperty(auto_now_add=True) 
```

＃ ETC..

当我在本地启动 dev-server 时出现错误：

```
Connecting to MySQL with kwargs {'passwd': '', 'db': 'webosdb', 'unix_socket':   '/var/run/mysqld/mysqld.sock', 'host': 'localhost', 'user': '', 'port': 3306}
CRITICAL 2012-07-16 20:47:08,203 rdbms_mysqldb.py:107] MySQL connection failed! Ensure  that you have provided correct values for the --mysql_* flags when running dev_appserver.py 
```

在我为我的本地 MySQL 数据库传递正确的键后，我有一个关于此数据库为空的错误。所以我在想这一切是如何运作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:47:03.737

所以现在我假设您使用的是 Google Cloud Sql，并且您在开发服务器中测试您的应用程序时遇到了麻烦。

请按照此处提供的示例[https://developers.google.com/academy/apis/cloud/appengine/cloud-sql/application_with_local_mysql](https://developers.google.com/academy/apis/cloud/appengine/cloud-sql/application_with_local_mysql)了解如何在开发环境中使用本地数据库。

# c# - 从网站中提取域和路径

> ID：11511845
> 
> 赞同：-2
> 
> 时间：2012-07-16T20:14:06.660
> 
> 标签：c#, path, extract

我想从网站列表中提取域和路径。例如，如果网站是[http://www.domain.com/path1/page1.html](http://www.domain.com/path1/page1.html)我想获取[http://www.domain.com/path1/](http://www.domain.com/path1/)，如果网站是[http://www。 domain2.com/path2/page2/](http://www.domain2.com/path2/page2/)我想获得[http://www.domain2.com/path2/](http://www.domain2.com/path2/)。

我尝试下载页面并检索所有锚点，但我只能获取文件的相对路径（在本例中为 /page1.html 和 /page2/）。有没有办法让我实现我想要的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:28:22.883

path2 并非总是存在于所有 url 中。所以你不会得到一个现成的方法来解析它。我建议非常粗略地为此编写一个函数，以给您一个想法：

```
var index = url.IndexOf(".com/");
var substringAfterFirstSlash = url.SubString(index, url.Length + 1 - index)
var indexOfSecondSlash = substringAfterFirstSlash.IndexOf("/") + index;
var yourPath = url.SubString(0, indexOfSecondSlash+1 ); 
```

# google-maps - 在 iOS 6 中打开带有当前位置和方向的地图

> ID：11511846
> 
> 赞同：11
> 
> 时间：2012-07-16T20:14:08.913
> 
> 标签：google-maps, ios5, ios6, directions, ios6-maps

我正在构建一个应用程序，它可以打开地图应用程序，其中包含从用户当前位置到另一个位置的方向。代码如下所示：

```
- (id)resolveDirectionsFromCoordinate:(CLLocationCoordinate2D)startCoordinate toCoordinate:(CLLocationCoordinate2D)endCoordinate
{
    NSString* url = [NSString stringWithFormat: @"http://maps.google.com/maps?saddr=%f,%f&daddr=%f,%f",
                 startCoordinate.latitude, startCoordinate.longitude,
                 endCoordinate.latitude, endCoordinate.longitude];
    [[UIApplication sharedApplication] openURL: [NSURL URLWithString: url]];

    return nil;
} 
```

Thos 在 iOS 5.x 中运行良好。然而，在 iOS 6 中，这会带来 Safari，因为 Maps 不再使用 Google Maps。

有谁知道我应该在 iOS 6 中调用哪个 URL？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-20T10:28:50.700

[Apple 文档](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html)建议使用等效的maps.apple.com URL 方案

所以用

```
http://maps.apple.com/maps?saddr=%f,%f&daddr=%f,%f 
```

代替

```
http://maps.google.com/maps?saddr=%f,%f&daddr=%f,%f 
```

要向后兼容，您的代码将是

```
 NSString* versionNum = [[UIDevice currentDevice] systemVersion];
    NSString *nativeMapScheme = @"maps.apple.com";
    if ([versionNum compare:@"6.0" options:NSNumericSearch] == NSOrderedAscending){
        nativeMapScheme = @"maps.google.com";
    }
    NSString* url = [NSString stringWithFormat: @"http://%@/maps?saddr=%f,%f&daddr=%f,%f", nativeMapScheme startCoordinate.latitude, startCoordinate.longitude,
                 endCoordinate.latitude, endCoordinate.longitude];
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:url]]; 
```

或者，您也可以使用该`maps://saddr=%f,%f&daddr=%f,%f`方案，但它似乎不支持所有参数。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-13T14:20:51.367

使用`+ (BOOL)openMapsWithItems:(NSArray *)mapItems launchOptions:(NSDictionary *)launchOptions`方法。从[MKMapItem 类参考](https://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKMapItem_class/Reference/Reference.html)：

> 您可以使用此方法将一个或多个地图项传递给地图应用程序。例如，您可以使用此方法要求地图应用程序显示您的应用程序生成的基于位置的搜索结果。地图会在您指定的每个位置显示图钉，并使用每个地图项对象的内容来显示附加信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T10:27:12.607

```
// Check for iOS 6
Class mapItemClass = [MKMapItem class];
if (mapItemClass && [mapItemClass     respondsToSelector:@selector(openMapsWithItems:launchOptions:)]) 
{
    // Create an MKMapItem to pass to the Maps app
    CLLocationCoordinate2D coordinate = 
                CLLocationCoordinate2DMake(16.775, -3.009);
    MKPlacemark *placemark = [[MKPlacemark alloc] initWithCoordinate:coordinate 
                                        addressDictionary:nil];
    MKMapItem *mapItem = [[MKMapItem alloc] initWithPlacemark:placemark];
    [mapItem setName:@"My Place"];

    // Set the directions mode to "Driving"
    // Can use MKLaunchOptionsDirectionsModeWalking instead
    NSDictionary *launchOptions = @{MKLaunchOptionsDirectionsModeKey :   MKLaunchOptionsDirectionsModeDriving };
    // Get the "Current User Location" MKMapItem
    MKMapItem *currentLocationMapItem = [MKMapItem mapItemForCurrentLocation];
   // Pass the current location and destination map items to the Maps app
   // Set the direction mode in the launchOptions dictionary
   [MKMapItem openMapsWithItems:@[currentLocationMapItem, mapItem] 
                launchOptions:launchOptions];
   } 
```

就这些 ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-07T12:32:04.950

I recommend checking out [CMMapLauncher](https://github.com/citymapper/CMMapLauncher), a mini-library that I built to launch Apple, Google, and other iOS mapping apps with a specific mapping request. With CMMapLauncher, the code to get the directions in your question would be:

```
[CMMapLauncher launchMapApp:CMMapAppAppleMaps
          forDirectionsFrom:[CMMapPoint mapPointWithName:@"Origin"
                                              coordinate:startCoordinate]
                         to:[CMMapPoint mapPointWithName:@"Destination"
                                              coordinate:endCoordinate]]; 
```

As you can see, it also encapsulates the version checking required between iOS 6 & others.

# powershell - 在 powershell 中丢失类型信息

> ID：11511853
> 
> 赞同：0
> 
> 时间：2012-07-16T20:14:51.157
> 
> 标签：powershell, powershell-2.0

我有两个在 powershell 中协同工作的功能：

```
Function Get-PropertyValue($fileName, $property)
{
    $path = (Get-Item $fileName).FullName
    $shell = New-Object -COMObject Shell.Application
    $folder = Split-Path $path
    $file = Split-Path $path -Leaf
    $shellfolder = $shell.Namespace($folder)
    $shellfile = $shellfolder.ParseName($file)
    $shellfolder.GetDetailsOf($shellfile,$property)
}
Function Create-List($files, $property)
{
    $list = @{}
    foreach ($file in $files)
    {
        $list.Add($file.toString(),(Get-PropertyValue $file $property).toString())
    }
    $list.GetEnumerator() | Sort-Object Value
} 
```

这得到了我正在寻找的带有一个小缺陷的输出。我希望能够获取哈希表的键，并将其用作文件（类型`DirectoryInfo`）。

这是一个与powershell中的哈希表相关的问题（至少据我所知，而不是特定于我上面的代码（它被包括在内，因为这是我遇到这个需求的方式，它不会很长，并且将不胜感激有关如何使其“更惯用”的评论）。

如何从哈希表中取出文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:29:24.787

好吧，对于您`$file.ToString()`用作密钥的人，因此缺陷不在于 PowerShell 而在于您的代码。

您应该能够将`DirectoryInfo`实例直接用作哈希表中的键（至少它是不可变的并且可以覆盖`object.Equals`）。

# javascript - jstree jquery插件 - 获取父节点的所有子节点和子子节点

> ID：11511858
> 
> 赞同：5
> 
> 时间：2012-07-16T20:15:03.757
> 
> 标签：javascript, jquery-plugins, jstree

我正在使用[jsTree jquery 插件](http://jstree.com)

我正在尝试获取选定父节点的所有节点和子节点。但不知何故，除非我使用递归，否则它不起作用。jsTree 是否有更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:19:29.207

您可以使用此选择器获得完整的树：`$("#demo1").find("li > a")`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-01T14:01:46.453

我尝试了以前的解决方案，但它不适用于最新版本的 jsTree (v3.2.1)。以下是获取父节点的子节点和子节点的更新解决方案。

```
$("#myTree").bind('selected_node.jstree', function (node, data) {
    var selectedNodes = $("#myTree").jstree(true).get_json(data.node.id, { flat: true });
    for (var i = 0; i < selectedNodes.length; i++) {
       // Apply logic here
       // ...
       // ...
       // ...
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T22:11:58.357

我找到了一种方法来做到这一点。就我而言，我使用 xml 作为树的数据源。我通过以下方式将 open_node 事件绑定到 jstree。请注意，即使我使用的是 xml，内部结构也是 html 数据的结构。

```
// jsTree Configuration hash
var jsTreeConfig = {};

$("#demo1").jstree( jsTreeConfig )
            .bind('open_node.jstree', function( e, data ) {
                var parentObj = data.rslt.obj; // parent object
                var jstreeInstance = data.inst; // jstree instance
                $(data.rslt.obj).find("li").each( function( idx, listItem ) {
                    var child = $(listItem); // child object
                    // do Stuff with child which can be any level of hierarchy depth
                    // ...
                });
            }); 
```

# java - JXTreeTable - 从外部应用程序操作复选框 - 可能吗？

> ID：11511860
> 
> 赞同：1
> 
> 时间：2012-07-16T20:15:05.723
> 
> 标签：java, swing, qtp, jxtreetable, jtreetable

使用 Java 代码，我试图操纵另一个外部 Java swing 应用程序，我无法访问有关它是如何编码的任何信息。具体来说，我正在尝试操作 JXTreeTable。布尔类型的列之一包含复选框。

我尝试做的一件事是编写双击然后空格键操作的代码，该操作*有效*。但是，我的经理希望我想办法在不使用空格键的情况下切换复选框。

我想知道 - 尽管我对原始应用程序的设计视而不见，但有人知道使用 Java 方法切换复选框的方法吗？我尝试将 setCellData() 与布尔参数一起使用。奇怪的是，在返回我修改它的值后立即调用 getCellData() 到单元格上，但复选框本身并没有被切换 - 另外，在提交表单时，它是发送的复选框反映的值，而不是布尔值细胞。

此外，布尔列中的复选框带有标签。我感觉这些标签是由 TableRenderer 生成的，但是我怎样才能获取标签上的值呢？

注意：我正在通过我正在编写的自动化测试脚本执行所有 Java 代码（准确地说是在 QTP 中）。因此，我可以使用的许多方法都受到限制（例如，我无法编写自己的自定义 Java 类）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:37:06.963

假设列数据由数据模型中的布尔值支持，请更改数据模型中的值。

只需使用您触发所需的表更改事件，以便 UI 可以更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-25T14:44:11.020

这就是我最终解决问题的方式：

然而，正如我现在发现的那样，我的特殊情况最终变得更加复杂。事实证明，直接修改**模型**没有任何效果——我必须通过树中的实际**节点对象来完成所有表的更改。**通过盲目跟踪方法，我发现开发人员编写了自定义节点处理程序，其中包含更改复选框状态*和*模型中数据的方法。为了更新表格显示，我使用了 treeTable.updateUI()。

# java - Java 可以使用 GridBagLayout 来组织 CardLayout 中使用的 JPanel

> ID：11511864
> 
> 赞同：1
> 
> 时间：2012-07-16T20:15:22.380
> 
> 标签：java, swing, awt, gridbaglayout, cardlayout

我是布局的新手，我现在使用的是 CardLayout，它有两张不同的卡片，目前有一个背景图像和一个按钮。如下所示，该按钮位于屏幕顶部，我想将其放置在更靠近底部的位置。我的理解是 GridBagLayout 将是实现这一目标的最佳方式。所以我的第一个问题是，这是真的吗？而且，如果我想要放置 GridBagLayout 的 JPanel 是 CardLayout 中的卡片，是否可以这样做。当我进一步进入项目时，我想将许多其他对象放入 GridBagLayout （如果这是最好的方法并且如果可能的话），所以任何关于正确方向的建议将不胜感激。

![](../Images/4eb7c0aef03483d923c69097620736b6.png)

```
import java.awt.*;
import java.awt.event.*;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.swing.*;

public class Cards implements ActionListener {    
private JPanel cards;
private JButton button1;
private JButton button2;
private Image backgroundImage;

public void addComponentToPane(Container pane) throws IOException {
    try {           
        backgroundImage = ImageIO.read(getClass().getResource("resources/background.jpg"));         
    } catch (IOException ex) {
        ex.printStackTrace(System.err);
    }

    //create cards
    JPanel card1 = new JPanel()
    {
        @Override
        public void paintComponent(Graphics g)
        {
            super.paintComponent(g);
            g.drawImage(backgroundImage, 0, 0, null);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(
                    backgroundImage.getWidth(null),
                    backgroundImage.getHeight(null));
        }
    };
    JPanel card2 = new JPanel()
    {
        @Override
        public void paintComponent(Graphics g)
        {
            super.paintComponent(g);
            g.drawImage(backgroundImage, 0, 0, null);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(
                    backgroundImage.getWidth(null),
                    backgroundImage.getHeight(null));
        }
    };
    //create buttons
    button1 = new JButton("Button 1");
    button2 = new JButton("Button 2");
    button1.addActionListener(this);
    button2.addActionListener(this);
    //add buttons to cards
    card1.add(button1);        
    card2.add(button2);
    //create panel that contains cards
    cards = new JPanel(new CardLayout());
    cards.add(card1, "Card 1");
    cards.add(card2, "Card 2");
    pane.add(cards, BorderLayout.SOUTH);        
}

public void itemStateChanged(ItemEvent evt) {
    CardLayout cl = (CardLayout)(cards.getLayout());
    cl.show(cards, (String)evt.getItem());
}

public static void createAndShowGUI() throws IOException  {
    //create and setup window
    JFrame frame = new JFrame("Frame"); 
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);        
    //create and setup content pane
    Cards main = new Cards();
    main.addComponentToPane(frame.getContentPane());        
    //display window
    frame.pack();       
    //frame.setResizable(false);
    frame.setVisible(true);
}

public void actionPerformed(ActionEvent ae) {
    if (ae.getSource() == button1) {
        CardLayout cl = (CardLayout) (cards.getLayout());
        cl.show(cards, "Card 2");     
    } else if (ae.getSource() == button2) {
        CardLayout cl = (CardLayout) (cards.getLayout());
        cl.show(cards, "Card 1");
    }        
}            

public static void main(String[] args) {
    //set look and feel
    try {
        UIManager.setLookAndFeel("javax.swing.plaf.metal.MetalLookAndFeel");
    } catch (UnsupportedLookAndFeelException ex) {
        ex.printStackTrace();
    } catch (IllegalAccessException ex) {
        ex.printStackTrace();
    } catch (InstantiationException ex) {
        ex.printStackTrace();
    } catch (ClassNotFoundException ex) {
        ex.printStackTrace();
    }                

    //schedule job for the event dispatch thread creating and showing GUI        
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() {                   
                    try {
                        createAndShowGUI();
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    }                
        }
    });     
}   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:23:12.753

a`GridBagLayout`会做你想做的，是的。它是可用的最灵活（但也是最复杂`LayoutManager`的）之一。这是否是“最佳”方法取决于您要添加到面板的其他控件，是否要调整它们的大小，调整父`JPanel`级大小时想要发生的情况以及其他因素。

回复：嵌套具有不同布局的 JPanel，是的。将 a`JPanel`与`GridBagLayout`JPanel 的`CardLayout`内部与 a 的内部`JPanel`与`BorderLayout`[etc...]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:18:56.707

退房`BorderLayout`。它有 5 个不同的区域，您可以在其中放置其他容器：左、右、顶部、中心和底部。

[http://docs.oracle.com/javase/tutorial/uiswing/layout/border.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/border.html)

# mysql - MYSQL：合并重复行

> ID：11511869
> 
> 赞同：4
> 
> 时间：2012-07-16T20:15:52.773
> 
> 标签：mysql, group-by, duplicates, group-concat

我有一个问题，我需要合并一堆重复的数据。我从一个从两个不同来源合并的表开始。数据的一个例子是：

aID, bID, value1, value2, value3, value4

问题是在某些情况下，aID 与 bID 匹配，但仅填写了其他字段之一：

1, 1, samedata, null, null, 1
1, 1, samedata, 红色, null, null
1, 1, samedata, null, htmldata, null

我正在寻找一种方法来显示整行数据，但汇总所有非空值，以便每个匹配的 id 有一行。我一直在尝试 Group By 和 Group_Concat，但还没有找到秘诀。

我想从上面的例子中得到的第一行是：

1, 1, 相同数据, 红色, htmldata, 1

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:21:39.447

一个技巧是使用`MAX`or `MIN`，因为它们会更喜欢非空值而不是空值：

```
SELECT aID,
       bID,
       MAX(value1) AS value1,
       MAX(value2) AS value2,
       MAX(value3) AS value3,
       MAX(value4) AS value4
  FROM ...
 GROUP
    BY aID,
       bID
; 
```

（当我`MAX`为此目的使用时，我通常会在注释中注明这一点，因为这对于普通读者来说并不是很明显。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:19:19.947

尝试这个：：

```
Select 
aID,
bId,
value1,
value2, value3
from table 
group by CONCAT(ifnull(aID,-1),ifnull(bId) 
```

# php-5.3 - 升级到 PHP 5.3.3 后应用程序停止运行

> ID：11511871
> 
> 赞同：0
> 
> 时间：2012-07-16T20:16:24.253
> 
> 标签：php-5.3

我刚刚将我的开发盒从 php 5.1.6 升级到 php 5.3.3 (LAMP)，我的应用程序停止工作。我不知道出了什么问题，但`index.php`没有完全加载。加载数据的实际代码得到了注释（当我使用“检查元素”进行检查时）。我在错误和访问日志中看不到任何特定错误。我需要对代码进行任何更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:27:08.200

您将需要查看迁移指南，因为 5.3 中有很多向后不兼容的更改。

*   [PHP 5.1.x 到 5.2.x](http://www.php.net/manual/en/migration52.php)
*   [PHP 5.2.x 到 5.3.x](http://www.php.net/manual/en/migration53.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:27:44.363

经过一番反复试验，我发现我的 php 失败的原因是在我的脚本中，`<?`而不是`<?php`. 有人可以确认`<?php`PHP 5.3是否强制使用符号吗？

# json - 如何强制spring返回“text/html”而不是“application/json”？

> ID：11511875
> 
> 赞同：2
> 
> 时间：2012-07-16T20:16:40.370
> 
> 标签：json, spring, spring-mvc, file-upload, response

我有一个文件附件插件（[来自 Valums 的 AJAX 文件上传插件](http://valums.com/ajax-upload/)），它要求返回 json 的类型为“text/html”。我正在开发的 Web 应用程序使用 Spring 框架，它强制返回类型为“application/json”。我希望 json 以“text/html”的形式返回。由于返回的 json 是“application/json”类型，我得到一个文件下载对话框，这是用户不应该看到的（文件应该自动上传）。

```
@RequestMapping(value="attachmentUpload", method=RequestMethod.POST)
public @ResponseBody Map<String, String> attachmentUpload(
        @ModelAttribute("fileUploadFB") @Valid final FileUploadFormBean fileUploadFB,
        BindingResult result,
        SessionStatus sessionStatus,
        HttpServletResponse response) {

    final Map<String, String> resultMap = new HashMap<String, String>();

    resultMap.put("success", "true");

    // vain attempts to force text/html; do not work
    response.setContentType("text/html;charset=UTF-8");
    response.setHeader("Content-Type", "text/html");

    return resultMap;
} 
```

如果有人有任何建议，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T14:38:59.787

我不再返回哈希图；返回一个字符串以及将“produces="text/html"" 添加到 RequestMapping 作品中！

# dynamics-crm - CRM 2011 流程执行时间混乱

> ID：11511876
> 
> 赞同：1
> 
> 时间：2012-07-16T20:16:45.267
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm

我正在尝试编写一个工作流来检查我的一个实体上的日期时间字段的条件。我想确定这个日期时间是否正好是 14 天前。例如，如果今天的日期是 2012 年 7 月 16 日，我想查找日期时间为 2012 年 7 月 2 日的所有记录。

我尝试过使用 Process Execution Time，但我一直得到奇怪的结果。当我尝试使用“流程执行时间前 14 天的日期时间”时，我在 7 月 2 日的所有记录中得到了 0 个结果。当我尝试在流程执行时间前 13 或 15 天使用时，我一直得到 0 个结果。

然后，我尝试将“日期时间在流程执行时间之前 15 天**或之后**”与“日期时间在流程执行时间**之前 13 天或之前**”结合起来，我得到了 2 条记录：1 条用于 7 月 2 日，另一条用于 7 月 3 日。

然后，我将上述内容更改为“日期时间在流程执行时间之前 15 天或之后”，“日期时间在流程执行时间之前 14 天或之前”，我得到了 0 条记录。

我真的对这些结果感到困惑。工作流程是否考虑到这些记录的日期**和**时间？例如，如果流程执行时间是 2012 年 7 月 16 日下午 1:13，“在 14 天或之后”是否考虑了下午 1:13 部分？2012 年 7 月 2 日下午 12:00 是否会在搜索条件之外，而 2012 年 7 月 2 日下午 2 点会在搜索条件之内吗？

更新：经过一番调查，我发现数据库以 UTC 存储时间戳，而 UI 将它们转换为 PST（对于我们的时区）。然后我发现“打开”比较使用的是 UTC 值。这对我来说毫无意义。例如，我在数据库中有 2 条记录，如下所示：

日期名称

2012-06-30 06:18:29.000 鲍勃

2012-06-30 07:00:00.000 亨利

但在 Dynamics 中，它们在 Advanced Find 中显示为：

2012 年 6 月 29 日鲍勃

2012 年 6 月 30 日亨利

每当我尝试使用“开”比较时，我似乎总是得到两条记录。当我将日期向上或向下移动 1 天时，我会得到 0 条记录。我唯一的结论是 On/On 或 After 使用的是 UTC 数据库日期，而 UI 将它们显示为转换后的 PST 日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T12:54:11.200

在这种情况下，有两件事，但您需要注意。

首先，执行时间确实包括时间部分，并且在或之前的条件条件也将考虑时间部分。

其次，您需要确保您正确处理 UTC 时间。仅仅因为实体的时间从 UI 看起来像是 7 月 2 日，由于 UTC 偏移，它可能是不同的日期。因此，当您尝试确保查询表达式正确运行时，请确保您知道记录中的实际 UTC 时间。

你的结论是正确的。UI 将始终以用户的时区显示日期和时间，但数据库将所有时间存储为 UTC。请参阅[此](https://stackoverflow.com/questions/11364982/server-side-fetchxml-returns-different-results/11367508#11367508)答案以了解如何转换您的时间 UTC（假设您正在运行 C# 部分到您的工作流程）

# python - 将 python pandas DataFrame 转换为 R 数据帧以与 rpy2 一起使用的问题

> ID：11511880
> 
> 赞同：7
> 
> 时间：2012-07-16T20:17:12.427
> 
> 标签：python, r, dataframe, pandas, rpy2

我无法将`DataFrame`Python 中的 pandas 转换为 R 对象，以便将来使用 rpy2 在 R 中使用。

新的 pandas 版本 0.8.0（几周前发布）具有将 pandas DataFrames 转换为 R DataFrames 的功能。问题在于转换我的 pandas DataFrame 的第一列，该列由 python datetime 对象（依次按时间序列）组成。转换为 R 数据帧返回日期和时间的 StrVector，而不是我认为称为“POSIXct”对象的 R 日期时间类型对象的向量。

我知道使用命令“as.POSIXct('yyyy-mm-dd hh:mm:ss')”将返回类型的字符串转换为 POSIXct 的命令。不幸的是，我无法弄清楚使用 python 和 rpy2 将 StrVector 中的所有这些字符串转换为 POSIXct 的方法。日期需要采用 POSIXct 格式才能与 R 中的 TTR 库一起使用。下面是相关的 python 代码：

```
import pandas
from pandas import *
import pandas.rpy.common as com
import rpy2.robjects as robjects
r = robjects.r
r.library('TTR')        #library contains the function ADX, to be used later

dataframe = read_csv('file_name', parse_dates = [0], names  = ['Date','Col1','Col2','Col3']     #command makes 1st column into datetime.datetime object
r_dataframe = com.convert_to_r_dataframe(dataframe)

ADX = r['ADX']          #creating a name for an R function in python
adx = ADX(r_dataframe)    #will not work because the dates in r_dataframe are in a StrVector 
```

此外，由于 StrVector 的定义，我不相信可以迭代 StrVector 以将每个对象单独转换为 POSIXct 对象。也许有一种方法可以将 StrVector 转换为通用的？

非常感谢您对此事的任何帮助/见解。我是一名新手程序员，现在已经为此工作了几个小时，但无济于事。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T20:34:51.053

您的`ADX`调用失败的原因是因为它需要一个具有 3 列的 xts 或类似矩阵的对象：High、Low、Close。您的对象包含 4 列。`r_dataframe`在传递到之前删除日期列`ADX`，一切都应该工作。然后，您可以将 datetime 列添加回`ADX`输出。

或者，如果您可以将`row.names`R data.frame 的属性设置为列的值，`Date`然后删除该`Date`列，则可以通过调用将 R data.frame 转换为 xts 对象`as.xts(r.data.frame)`。然后您可以将其传递给`ADX`并将结果转换回 pandas DataFrame。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-08T23:14:40.083

GitHub 上的 dalejung 最近在使用 rpy2 创建更紧密的 pandas-xts 接口方面做了很多工作，你可以联系他或加入 PyData 邮件列表

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-11-12T02:50:41.643

这不是你想要的答案。但是如何使用 piper 库呢？

它只是 python 和 R 之间的“管道”。因此它不会很少出现关于转换的问题。 [https://pypi.python.org/pypi/piper](https://pypi.python.org/pypi/piper)

# c# - Winforms 中的 System.UnauthorizedAccessException C#

> ID：11511881
> 
> 赞同：2
> 
> 时间：2012-07-16T20:17:16.640
> 
> 标签：c#, linq, permissions

问题是*回收站*或*文档和设置*文件夹/文件上的 System.UnauthorizedAccessException。（VS2010 .NET 4.0 C#）

以下 LINQ 代码用于查询目录大小。我已经尝试过 GetFiles 和 EnumerateFiles。我肯定以管理员身份运行。在注释代码中，您可以看到我尝试测试另一篇 Stack 帖子中的某些属性但没有成功。

```
DirectorySize(new DirectoryInfo(@"C:\\"),true);

public static long DirectorySize(DirectoryInfo dInfo, bool includeSubDir)
{
    // Enumerate all the files
    long totalSize = dInfo.EnumerateFiles().Sum(file => file.Length);
        //.Where(d => (d.Attributes & FileAttributes.ReparsePoint) == 0 && (d.Attributes & FileAttributes.System) == 0)
        //.Sum(file => file.Length);

    if (includeSubDir) // Subdirs?
    {
        // Enumerate all sub-directories
        totalSize += dInfo.EnumerateDirectories().Sum(dir => DirectorySize(dir, true));
            //.Where(d => (d.Attributes & FileAttributes.ReparsePoint) == 0 && (d.Attributes & FileAttributes.System) == 0)
            //.Sum(dir => DirectorySize(dir, true));
    }
    return totalSize;
} 
```

我想获得一个简洁的 LINQ 方法，我不必手动循环和测试每个文件夹/目录。我发现了一些类似操作的重复项的 MS 代码。它的错误也是一样的。

预先感谢您，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:30:23.030

Stack Overflow 中还有其他对此的引用；但您可能需要为您的应用程序本身定义权限。 [设置权限](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/206cfa9d-3e5b-43be-840f-49a221e10749)

还有这个小块 [ C:\Users is a JUNCTION]; [C#：访问路径 <'filepath'> 被拒绝](https://stackoverflow.com/questions/9228426/c-access-to-path-filepath-is-denied)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:29:11.447

`try/catch`[如以下文章](http://msdn.microsoft.com/en-us/library/bb513869.aspx)所示进行救援。还有[替代品](http://rwtools.codeplex.com/)。

# vb.net - 将文件从 TFS 中的项目添加到不同的项目

> ID：11511887
> 
> 赞同：1
> 
> 时间：2012-07-16T20:17:44.490
> 
> 标签：vb.net, tfs

我在 TFS 的一个项目中有几个模块，我想将它们用作新项目的起点。我不想要确切的模块，但其中大部分在新项目中很有用。除了这些模块之外，第二个项目与第一个项目几乎完全不同。同样，模块将从原始模块进行修改。

有没有好方法将这些添加到新项目中？我在 VB 2008 中编写代码。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T23:12:37.313

总体而言，TFS 确实非常关心您存储代码的位置。无论您创建了多少个团队项目，我们的电子代码都存储在同一个根目录 ($/) 下，只要您有权访问源代码，您就可以导航到它。在大多数情况下，您只需要 1 个源代码副本位于源代码控制中的某个位置。

话虽这么说，您有很多选项...在所有选项中，最简单的选择是将源保留在原处并调整对其的访问权限，以允许其他团队成员（在其他团队项目中）访问它. 然后创建工作区映射以控制当您执行获取最新时它将该源放在本地计算机上的位置。

如果您计划为每个解决方案独立更改该代码，您可以复制它并将其签入（将其视为新代码），或者您可以通过右键单击将其从当前位置分支到新位置创建新团队项目后，您要分支的每个文件夹并选择分支选项。目标位置可以是您在新团队项目下的文件夹。通常，不建议使用后两个选项，因为那样您将维护代码的多个副本，这可能会变得昂贵！

# flowplayer - Flowplayer，从 Flash 对象获取 javascript 中的事件

> ID：11511889
> 
> 赞同：0
> 
> 时间：2012-07-16T20:17:49.097
> 
> 标签：flowplayer

我正在使用 Flowplayer 在我的网站上播放视频。我也在页面上加载了 FlowPlayer.js，但我使用的是对象嵌入代码而不是纯 js 嵌入。

所以我有以下

```
<object id="flowplayer" width="480" height="294" data="http://localhost/oembed/Content/flash/flowplayer-3.2.7.swf"
type="application/x-shockwave-flash" bgcolor="#000000">
<param name="movie" value="http://localhost/oembed/Content/flash/flowplayer-3.2.7.swf" />
<param name="allowfullscreen" value="true" />
<param value="always" name="allowscriptaccess"/>
<param value="true" name="cachebusting"/>
<param name="flashvars" value='config={"clip":{"url":"http://localhost/video.mp4","autoPlay": true}}' />
</object> 
```

现在我想获取 onStart、onFinish 和 onPause 事件，但到目前为止我无法让它们为我触发。

我已经尝试了所有我能想到的 $f(...) 组合，但没有任何效果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:54:49.173

使用备用嵌入方法时不支持播放器事件。请参阅 Flowplayer 文档： http: [//flowplayer.org/demos/installation/alternate/index.html](http://flowplayer.org/demos/installation/alternate/index.html)（第一段）

# wordpress - 如何阻止 Wordpress 博客不断地转发我的所有内容？

> ID：11511892
> 
> 赞同：0
> 
> 时间：2012-07-16T20:18:15.930
> 
> 标签：wordpress

一个 Wordpress 博客不断地逐字逐句地重新写博客，并以图像对图像的方式对我网站的内容进行重新博客。显然，Wordpress 有一个“reblog”功能，这使得它非常容易做到。

有没有办法禁用此功能，或者至少使复制粘贴我的内容变得更加困难或更耗时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T07:50:17.530

你确定他们正在使用转发功能吗？他们也很容易使用您的 RSS 提要抓取整个帖子，而且这种情况已经发生了很长时间。您可以通过将 RSS 提要设置切换为部分来查看是否是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:44:36.700

Wordpress 重新博客功能不应该抓取整个帖子，除非它少于 85（ish）字。

话虽如此，它仍然很烦人，并且可能有一种方法可以部分阻止您的内容。我还没有测试过，但我相信“重新博客”会抓取帖子中的第一张图片，所以如果你在内容之前放置了一个透明像素，他们就有可能取而代之。

值得一试，但我不知道有一种方法可以完全避免这种刮擦。

除非您的博客发布在图片上：D

# html - 在网站上显示一个大的 txt 文件

> ID：11511893
> 
> 赞同：0
> 
> 时间：2012-07-16T20:18:20.023
> 
> 标签：html, ruby-on-rails

我一直在制作一个 Web UI 来查看非常大（最多 10,000-150,000 行）的 txt 文件。我一直在使用 Ruby on Rails 来执行此操作，并且我所使用的界面已经足够好了。我目前遇到了与这些文件过大有关的问题。目前，当用户选择要显示的文件时，它会将该文件的全部内容（逐行）读取到可滚动元素中。

对于大文件，如果用户想要选择一个新文件，这会导致网站在完成之前挂起一点，并且挂起更长时间（这让我更加困惑，也许我需要先刷新其内容的元素或其他东西？）。

您是否看到了加快用户体验的方法？我唯一的想法是一次只加载文件的一部分。我看到这个实现的最方便的方法就是当用户滚动到文件底部时将更多的文件读取到 div 中。我不确定这是一个好的解决方案，因为切换文件时网站会挂起。

一个理想的解决方案可能是一次仅将文件的可见部分加载到 div 中，但我不确定如何实现这一点。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:22:41.957

默认情况下，您可以考虑仅将前 X 行加载到视图中。然后为用户提供查看完整文件的选项，此时您可以触发 javascript 请求以通过 AJAX 将完整内容填充到容器中。

# javascript - 实时监控网站更新

> ID：11511894
> 
> 赞同：3
> 
> 时间：2012-07-16T20:18:25.797
> 
> 标签：javascript, node.js, real-time

我很好奇如何实时监控网站的更新，最好是在 node.js 中。

让我们以维基百科为例。有人决定用一些相关信息更新一篇文章。我将如何订阅页面并立即在我的 node.js 服务器中获取事件，而不必每 X 秒轮询一次网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:22:55.107

如果您可以选择“指示”网站通知您，您可以创建网站在内容更新时将调用的 Web 服务。但是，当然，该网站应该有这样的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T20:38:03.103

一般来说，如果没有其他可能性（如新闻提要），您将需要对网站进行调查。你不能强迫他们提供这样的服务。

对于 Wikipedia 的详细信息，有[实时更新 IRC 流](http://meta.wikimedia.org/wiki/IRC/Channels#Recent_changes)，每个项目一个。[Wikistream](http://wikistream.inkdroid.org/about/)就是这样一个读取提要的应用程序，您可以在 github 上查看它的开源 node.js 代码。

# binary-search-tree - 将二叉搜索树转换为双向链表

> ID：11511898
> 
> 赞同：7
> 
> 时间：2012-07-16T20:18:48.757
> 
> 标签：binary-search-tree, tree-traversal, doubly-linked-list

这个问题是在最近的一次编码采访中被问到的。

**问：**给定一棵二叉树，编写一个程序将其转换为双向链表。双向链表中的节点按锯齿形层序遍历形成的顺序排列

**我的方法**

我总是可以对树进行之字形级别的顺序遍历并将其存储在一个数组中，然后制作一个双链表。但问题需要就地解决方案。任何人都可以帮助解释应该使用递归方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-17T20:02:28.797

这是递归方法。请注意，此处的 root 将指向所形成列表的某个中间元素。因此，只需从根向后遍历即可获得头部。

```
#define NODEPTR struct node*

NODEPTR convert_to_ll(NODEPTR root){
    if(root->left == NULL && root->right == NULL)
        return root;
    NODEPTR temp = NULL;
    if(root->left != NULL){
        temp = convert_to_ll(root->left);
        while(temp->right != NULL)
            temp = temp->right;
        temp->right = root;
        root->left = temp;
    }
    if(root->right != NULL){
        temp = convert_to_ll(root->right);
        while(temp->left != NULL)
            temp = temp->left;
        temp->left = root;
        root->right = temp;
    }
    return root;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-14T11:05:49.530

**最简单的方法**。在单中序遍历中，只需 O(1) 的空间复杂度，我们就可以实现这一点。保留一个名为**lastPointer**的指针，并在访问每个节点后对其进行跟踪。使用左右

```
public void toll(T n) {
    if (n != null) {
        toll(n.left);
        if(lastPointer==null){
            lastPointer=n;
        }else{
            lastPointer.right=n;
            n.left=lastPointer;
            lastPointer=n;
        }
        toll(n.right);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T15:09:47.730

C++ 代码：

```
 Node<T> *BTtoDoublyLLZigZagOrder(Node<T> *root)
 {
        if (root == 0)
            return 0;
        if (root->mLeft == 0 && root->mRight == 0)
            return root;

        queue<Node<T> *> q;
        q.push(root);
        Node<T> *head = root;
        Node<T> *prev = 0,*curr = 0;

        while(!q.empty())
        {
            curr = q.front();
            q.pop();
            if (curr->mLeft)
                q.push(curr->mLeft);
            if (curr->mRight)
                q.push(curr->mRight);
            curr->mRight = q.front();
            curr->mLeft = prev;
            prev = curr;
        }

        return head;
 } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-06T16:27:22.460

斯坦福图书馆链接中提到的解决方案是 BST 到循环 DLL 的完美解决方案，下面的解决方案并不完全是 BST 到循环 DLL 的转换，而是可以通过连接 DLL 的末端来实现循环 DLL。它也不完全是 zig zag 有序树到 dll 的转换。

**注意：**这个解决方案不是从 BST 到循环 DLL 的完美转换，而是一个易于理解的 hack

**JAVA代码**

```
public Node bstToDll(Node root ){
        if(root!=null){
            Node lefthead = bstToDll(root.left); // traverse down to left 
            Node righthead = bstToDll(root.right); // traverse down to right
            Node temp = null;
            /*
             * lefthead represents head of link list created in left of node
             * righthead represents head of link list created in right
             * travel to end of left link list and add the current node in end
             */
            if(lefthead != null) {
                temp = lefthead;
                while(temp.next != null){
                    temp = temp.next;
                }
                temp.next = root;
            }else{
                lefthead = root;
            }
            root.prev = temp;
            /*
             *set the next node of current root to right head of right list
             */
            if(righthead != null){
                root.next = righthead;
                righthead.prev = root;
            }else{
                righthead = root;
            }
            return lefthead;// return left head as the head of the list added with current node
        }
        return null;
} 
```

希望它可以帮助某人

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-02-04T17:37:42.303

没有全局变量的反向中序遍历 - [c#](/questions/tagged/c%23 "显示标记为“c#”的问题")实现。调用时，最初将*null传递给**正确*的参数。最终返回值是双向链表的*头部*

```
public static Node ToDLL(Node node, Node right)
{
    if (node == null)
        return null;

    var rnd = ToDLL(node.Right, right);

    if (rnd != null)
    {
        node.Right = rnd;
        rnd.Left = node;
    }
    else
    {
        node.Right = right;
        if (right!= null)
            right.Left= node;
    }
    return ToDLL(node.Left, node) ?? node;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-18T07:11:56.207

我们可以使用中序遍历并跟踪之前访问过的节点。对于每个访问过的节点，可以分配前一个节点右和当前节点左。

```
void BST2DLL(node *root, node **prev, node **head)
{
    // Base case
    if (root == NULL) return;

    // Recursively convert left subtree
    BST2DLL(root->left, prev, head);

    if (*prev == NULL) // first iteration
        *head = root;
    else
    {
        root->left = *prev;
        (*prev)->right = root;
    }
    *prev = root; // save the prev pointer 

    // Finally convert right subtree
    BST2DLL(root->right, prev, head);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-05T08:51:30.437

我们将使用两个哨兵节点头和尾，并按顺序遍历树。第一次我们必须将头部链接到最小节点，反之亦然，并且还将最小节点链接到尾部，反之亦然。在第一次之后，我们只需要重新链接当前节点和尾部，直到遍历完成。遍历后，我们将删除哨兵节点并正确重新链接头部和尾部。

```
public static Node binarySearchTreeToDoublyLinkedList(Node root) {

    // sentinel nodes
    Node head = new Node();
    Node tail = new Node();

    // in-order traversal
    binarySearchTreeToDoublyLinkedList(root, head, tail);

    // re-move the sentinels and re-link;
    head = head.right;
    tail = tail.left;

    if (head != null && tail != null) {
        tail.right = head;
        head.left = tail;
    }

    return head;
}

/** In-order traversal **/
private static void binarySearchTreeToDoublyLinkedList(Node currNode, Node head, Node tail) {
    if (currNode == null) {
        return;
    }

    // go left
    //

    binarySearchTreeToDoublyLinkedList(currNode.left, head, tail);

    // save right node for right traversal as we will be changing current
    // node's right to point to tail
    //

    Node right = currNode.right;

    // first time
    //

    if (head.right == null) {

        // fix head
        //

        head.right = currNode;
        currNode.left = head;

        // fix tail
        //

        tail.left = currNode;
        currNode.right = tail;

    } else {

        // re-fix tail
        //

        Node prev = tail.left;

        // fix current and tail
        //

        tail.left = currNode;
        currNode.right = tail;

        // fix current and previous
        //

        prev.right = currNode;
        currNode.left = prev;
    }

    // go right
    //

    binarySearchTreeToDoublyLinkedList(right, head, tail);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-14T14:19:55.807

```
struct node{
int value;
struct node *left;
struct node *right;
};
typedef struct node Node;

Node * create_node(int value){
  Node * temp =  (Node *)malloc(sizeof(Node));
  temp->value = value;
  temp->right= NULL;
  temp->left = NULL;
  return temp;
}
Node * addNode(Node *node, int value){
  if(node == NULL){
    return create_node(value);
  }
  else{
    if (node->value > value){
        node->left = addNode(node->left, value);
    }
    else{
        node->right = addNode(node->right, value);
    }
  }
  return node;
}

void treeToList(Node *node){

    Queue *queue = NULL;
    Node * last = NULL;
    if(node == NULL)
            return ;

    enqueue(&queue, node);
    while(!isEmpty(queue)){
       /* Take the first element and put 
          both left and right child on queue */
            node = front(queue);
            if(node->left)
                    enqueue(&queue, node->left);
            if(node->right)
                    enqueue(&queue, node->right);
            if(last != NULL)
                    last->right = node;
            node->left = last;
            last = node;
            dequeue(&queue);
      }
  } 
  /* Driver program for the function written above */
 int main(){
    Node *root = NULL;
   //Creating a binary tree
    root = addNode(root,30);
    root = addNode(root,20);
    root = addNode(root,15);
    root = addNode(root,25);
    root = addNode(root,40);
    root = addNode(root,37);
    root = addNode(root,45);

    treeToList(root);

    return 0;
} 
```

队列 API 的实现可以在 [http://www.algorithmsandme.com/2013/10/binary-search-tree-to-doubly-linked.html找到](http://www.algorithmsandme.com/2013/10/binary-search-tree-to-doubly-linked.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-25T15:41:49.010

```
node* convertToDLL(node* root, node*& head, node*& tail)
{
    //empty tree passed in, nothing to do
    if(root == NULL)
        return NULL;

    //base case
    if(root->prev == NULL && root->next == NULL)
        return root;

    node* temp = NULL;
    if(root->prev != NULL)
    {
        temp = convertToDLL(root->prev, head, tail);

        //new head of the final list, this will be the left most
        //node of the tree.
        if(head == NULL)
        {
            head=temp;
            tail=root;
        }

        //create the DLL of the left sub tree, and update t
        while(temp->next != NULL)
            temp = temp->next;
        temp->next = root;
        root->prev= temp;
        tail=root;
    }

    //create DLL for right sub tree
    if(root->next != NULL)
    {
        temp = convertToDLL(root->next, head, tail);
        while(temp->prev != NULL)
            temp = temp->prev;
        temp->prev = root;
        root->next = temp;

        //update the tail, this will be the node with the largest value in
        //right sub tree
        if(temp->next && temp->next->val > tail->val)
            tail = temp->next;
        else if(temp->val > tail->val)
            tail = temp;
    }
    return root;
}

void createCircularDLL(node* root, node*& head, node*& tail)
{
    convertToDLL(root,head,tail);

    //link the head and the tail
    head->prev=tail;
    tail->next=head;
}

int main(void)
{

    //create a binary tree first and pass in the root of the tree......
    node* head = NULL;
    node* tail = NULL;
    createCircularDLL(root, head,tail);

    return 1;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-29T22:34:10.303

这是Java代码。复杂度为 O(N)。我还为这个问题添加了一些测试用例。

```
public class BinaryToDoubleLinkedList {

    static class Node {
        int value;
        Node left;
        Node right;

        public Node(int value, Node left, Node right) {
            this.value = value;
            this.left = left;
            this.right = right;
        }
    }

    static class Pair {
        Node head;
        Node tail;

        public Pair(Node head, Node tail) {
            this.head = head;
            this.tail = tail;
        }
    }

    static Pair convertToDoubleLinkedList(Node root) {
        return convert(root);
    }

    static Pair convert(Node root) {
        if (root == null) return new Pair(null, null);

        Node head, last;

        Pair left = convert(root.left);
        if (left.tail != null) {
            left.tail.right = root;
            root.left = left.tail;
            head = left.head;
        } else {
            head = root;
        }

        Pair right = convert(root.right);
        if (right.head != null) {
            right.head.left = root;
            root.right = right.head;
            last = right.tail;
        } else {
            last = root;
        }

        return new Pair(head, last);
    }

    static void Print(Node root, boolean fromLeft) {
        System.out.println("---------");
        if (fromLeft) {
            while (root != null) {
                System.out.print(root.value + ",");
                root = root.right;
            }
        } else {
            while (root != null) {
                System.out.print(root.value + ",");
                root = root.left;
            }
        }

        System.out.println();
    }

    public static void main(String[] args) {
        test1();
        test2();
        test3();
    }

    // test 1: normal test case
    public static void test1() {
        Node root = new Node(10, null, null);
        root.left = new Node(12, null, null);
        root.right = new Node(15, null, null);

        root.left.left = new Node(25, null, null);
        root.left.right = new Node(30, null, null);
        root.right.left = new Node(36, null, null);

        Pair res = convertToDoubleLinkedList(root);
        Print(res.head, true);
        Print(res.tail, false);
    }

    // test 2: binary tree as linked list
    public static void test2() {
        Node root = new Node(1, null, null);
        root.left = new Node(2, null, null);
        root.left.left = new Node(3, null, null);
        root.left.left.left = new Node(4, null, null);

        Pair res = convertToDoubleLinkedList(root);
        Print(res.head, true);
        Print(res.tail, false);
    }

    // test 3: null and single
    public static void test3() {
        Node root = new Node(1, null, null);
        Pair res = convertToDoubleLinkedList(root);
        Print(res.head, true);
        Print(res.tail, false);

        res = convertToDoubleLinkedList(null);
        Print(res.head, true);
        Print(res.tail, false);
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-23T02:32:56.170

我意识到这已经很老了，但我在准备面试时解决了这个问题，我意识到如果你考虑每个递归函数调用接收、更新和返回链表的当前头部，它会简单得多。如果您有兴趣返回头部，最好使用逆序遍历。将头部传递给递归函数也不需要静态或全局变量。这是Python代码：

```
def convert(n, head=None):
  if n.right:
    head = convert(n.right, head)
  if head:
    head.left = n
  n.right = head
  if n.left:
    head = convert(n.left, n)
  else:
    head = n
  return head 
```

希望这对某人有用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-25T13:40:42.047

找到按顺序的前任并将左右指向当前根的前任将为您完成这项工作。运行以下代码的时间复杂度是`O(N)`并且将占用辅助空间`O(H)`，其中`H = Height of the Tree`，隐式用于递归堆栈。下面的代码是使用`Python 3`.

```
def convertToDLL(root):
    # Base check
    if root is None:
        return root

    # Converting left sub-tree to root
    if root.left:

        # Convert the left subtree
        left = convertToDLL(root.left)

        while left.right:
            left = left.right

        left.right = root
        root.left = left

    # Converting right sub-tree to root
    if root.right:

        # Convert the right subtree
        right = convertToDLL(root.right)

        while right.left:
            right = right.left

        right.left = root
        root.right = right

    return root

def bToDLL(root):
    if root is None:
        return root

    # Convert to DLL
    root = convertToDLL(root)

    while root.left:
        root = root.left

    return root

def display(head):
    # Display
    if head is None:
        return
    while head:
        print(head.data, end=" ")
        head = head.right 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-11T10:22:56.243

希望这会帮助你。

```
class Solution(){
public:
    TreeNode* convertBST2DLL(TreeNode* root){
        TreeNode left, right;
        convert(root, &left, &right);
        TreeNode* head = left.right;
        head->left = NULL;
        right.left->right = NULL;
        return head;
    }   
    void convert(TreeNode* root, TreeNode* left, TreeNode* right){
        if(root->left == NULL){
            left->right = root;
            root->left = left;
        }
        else{
            convert(root->left, left, root);
        }
        if(root->right == NULL){
            right->left = root;
            root->right = right;
        }
        else{
            convert(root->right, root, right);
        }
    }
}; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-20T23:04:46.583

脚步：

1.  树的中序遍历

2.  在节点处理步骤中，跟踪头部和尾部并不断增加尾部

3.  最后重新连接头部和尾部

    ```
     def binarysearchtreeToLL(root):  
         def dfsInorder(node):  
             nonlocal head, tail 

             if not node:  
                 return None  

             dfsInorder(node.left)  

             if tail:  
                  tail.right = node  
                   node.left = tail  
              else:  
                   head = node  
              tail = node  

              dfsInorder(node.right)  

          if not root:  
              return None  
          head, tail = None, None  
          dfsInorder(root)  
          head.left = tail  
          tail.right = head  
          return head 
    ```

时间复杂度：O(n) 空间复杂度：在进行 n 次递归堆栈调用的最坏情况下为 O(n)。

# jquery - 如何更正 jQuery UI 中的选项卡内容区域？

> ID：11511902
> 
> 赞同：0
> 
> 时间：2012-07-16T20:18:56.007
> 
> 标签：jquery, css, jquery-ui, user-interface

我有 jQuery UI 演示页面，用于新的 jQuery UI 下载，大部分示例都被注释掉了。没有被注释掉的主要内容是手风琴的代码，我希望它作为左侧导航侧边栏，以及选项卡的代码，这将是页面的大部分内容。

目前我已经添加到 CSS 中：

```
 div#accordion
            {
            float: left;
            position: absolute;
            width: 18%;
            }
        div#tabs
            {
            margin-left: 20%;
            } 
```

我在手风琴上没有绝对位置的情况下尝试的所有操作都会导致选项卡中文本的顶部与手风琴的一部分对齐。

有没有更好的方法来编码手风琴位于左侧边栏而选项卡区域位于右侧？最好有一个不会在屏幕底部被截断的实现。

# desire2learn - 带有 API GET 类列表/等级调用的禁止错误消息

> ID：11511903
> 
> 赞同：0
> 
> 时间：2012-07-16T20:18:57.237
> 
> 标签：desire2learn

我正在对班级列表以及 D2L 的成绩进行 API 调用。我不断收到未知错误，禁止错误消息。我可以通过 API 调用访问个人资料和组织信息，但不能访问成绩和班级列表。这是我的学习套件可以配置的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T22:56:22.023

由于所有 API 调用都发生在特定用户权限的上下文中，因此您进行调用的调用用户上下文可能没有适当的权限来访问班级列表/成绩信息。

例如，对于类列表 - 有与访问类列表相关的特定角色权限（请参阅“类列表”角色权限组）：请注意，这些权限适用于组织单位类型，并且可能需要打开对于课程设置和父组织单位类型（也许是部门）。

# r - aes() 中的传递选项和 ggplot2 中的传递选项之间的区别

> ID：11511911
> 
> 赞同：13
> 
> 时间：2012-07-16T20:19:45.373
> 
> 标签：r, plot, ggplot2, size

在 ggplot2 中摆弄点大小选项后，我注意到`aes()`在`geom_point()`. 从[Hadley 网站上的 `geom_point() 页面](http://had.co.nz/ggplot2/geom_point.html)：

```
p <- ggplot(mtcars, aes(wt, mpg))

# passed inside
p + geom_point(aes(size = qsec)) 
p + geom_point(aes(size = qsec)) + scale_area() 

# passed outside
p + geom_point(colour = "red", size = 3) 
p + geom_point(colour = "grey50", size = 4) 
```

当涉及到传说时，我发现这些行为有所不同。通过内部时，`aes()`我可以看到一个图例，尽管我需要设置休息点，即使我只有两个不同大小的点；否则，即使只使用了 2 个，我也会得到 5 个点大小的范围。

此外，传递的尺寸也没有意义。我需要使用指定相对大小`range=c(min,max)`并将中断设置为只有两个大小，而不是默认的五个。

如果我通过 size 之外的`aes()`尺寸，尺寸似乎很荣幸，但我无法在我的情节上获得传奇；我试过了`scale_size`，`scale_size_continuous`但`scale_size_manual`没有成功。

从`geom_point()`页面有这个：

> 以下美学可以与 geom_point 一起使用。美学通过 aes 函数映射到数据中的变量：`geom_point(aes(x = var))`
> 
> ...
> 
> 比例控制变量如何映射到美学并在每个美学之后列出。
> 
> [此处列出所有美学选项（形状、颜色、尺寸等）]

从那时起，仍然不清楚内部和外部的选项（这个问题中的大小，但这对其他美学应该是有意义的）如何`aes()`影响结果。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-16T20:43:03.023

当在内部指定时`aes`，美学被*映射*到数据中变量的值。由于数据和视觉美学之间存在映射，因此有一个图例显示了这种映射。在`aes`通话之外，美学只是*设置*为特定值。在您展示的示例中，所有点的大小（和颜色）都设置为相同的值。在这种情况下，不需要图例，因为大小（或颜色）不传达任何意义（关于基础数据）。

您在图例中看到的问题是由于大小被映射到连续变量。碰巧这个变量在您的数据中只有两个值，但原则上，连续变量可以采用任何值。如果它真的只是一个二选一的变量，请将其作为一个因素（在原始数据或审美调用`aes(size=factor(qsec))`中）。

# php - PHP crypt 函数结果：它是如何工作的？

> ID：11511912
> 
> 赞同：0
> 
> 时间：2012-07-16T20:19:59.373
> 
> 标签：php, crypt

当我在 PHP 中执行下一个脚本时：

```
 $hash1 = crypt('test','$2a$08$useasillystringforsalt$');<br/>
   echo 'hash1:'.$hash1.'<br/>';
   $hash2 = crypt('test','$2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6');<br/>
   echo 'hash2: '.$hash2.'<br/>';      
   $hash3 = crypt('test','$2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6');
<br/>
   echo 'hash3: '.$hash3.'<br/>';   
   $hash4 = crypt('test','$2a$08$useasillystringforsalfaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
<br/>
   echo 'hash4: '.$hash4.'<br/>';   
   $hash5 = crypt('test','$2a$08$useasillystringforsaldaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
<br/>
   echo 'hash5: '.$hash5.'<br/>';   
   $hash6 = crypt('test','$2a$08$useasillystringforsaleaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa');
<br/>
   echo 'hash6: '.$hash6.'<br/>'; 
```

我得到以下结果：

```
hash1: $2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6
<br/>
hash2: $2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6
<br/>
hash3: $2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6
<br/>
hash4: $2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6
<br/>
hash5: $2a$08$useasillystringforsalOnUtWGdo1WqxrpPXy7Lrt0SHVxn5XeU6
<br/>
hash6: $2a$08$useasillystringforsaley3TiRUWCAPaejcvjzQFYCRitqtaPur6 
```

hash1 是以下结果：

```
crypt('test',$2a$08$useasillystringforsalt); 
```

我的问题是：

除了 hash5 之外，所有结果怎么可能相同？我认为盐的最轻微变化会产生完全不同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:23:28.453

**在您的情况下，您使用的是标准的基于 des 的 crypt algorithm**。

在这种情况下，盐只作为输出的前两个字符返回，因此如果您只更改一个非常长的盐字符串中的一个字母，那么您很可能会为多个“几乎相同”的盐获得相同的字符串。

来自 PHP 手册：

[http://php.net/manual/en/function.crypt.php](http://php.net/manual/en/function.crypt.php)

> 基于标准 DES 的 crypt() 将 salt 作为输出的前两个字符返回。它也只使用 str 的前八个字符，因此以相同八个字符开头的较长字符串将生成相同的结果（当使用相同的盐时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:43:36.113

事实证明，它只是出于某种原因忽略了最后一个字符。多么愚蠢的实现。大概没什么好担心的。没有合理的方法可以将安全性提高到超过盐长度限制所施加的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:45:01.760

需要结束 $:

```
$hash4 = crypt('test','$2a$08$useasillystringforsalfaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa$'); 
```

# c# - C# Outlook 加载项数组从 1 开始？

> ID：11511913
> 
> 赞同：7
> 
> 时间：2012-07-16T20:20:00.950
> 
> 标签：c#, outlook, outlook-addin

我一直在用头撞墙 25 分钟，试图弄清楚为什么我无法访问数组的“第一个”索引，而我试图用数组 [0] 来做。我不断收到数组索引越界异常。只是为了看看会发生什么，我尝试使用 array[1] ...并且它起作用了。完美。我不知道为什么。

```
for (int i = 1; i < itemCounter+1; i++)
{
     if (explorer.CurrentFolder.Items[i] is Outlook.MailItem)
     { //Do something }
} 
```

整个事情运作良好。这里发生了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-16T20:31:23.257

Outlook 对象模型似乎是 Office 对象模型的一部分，正如[http://msdn.microsoft.com/en-us/library/aa189134%28v=office.10%29.aspx](http://msdn.microsoft.com/en-us/library/aa189134%28v=office.10%29.aspx)所述，

> Office 应用程序中使用的大多数集合（Access 除外）都是从一开始的，即集合中第一项的索引号为 1。

此外， http: [//msdn.microsoft.com/en-us/library/522xhsa3%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/522xhsa3%28v=vs.90%29.aspx)特别告诉我们

> 要访问 Microsoft Office 应用程序对象模型中集合的第一项，请使用索引 1 而不是 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:28:57.767

是的，它看起来像 Items 返回一个[集合 object](http://msdn.microsoft.com/en-us/library/bb176540%28v=office.12%29)，并且当使用这样的数组修饰符访问时，这些都是已知的。您应该能够执行 .ToArray() 来获得您期望的行为，否则您可以简单地使用`foreach var item in items`并获取文件夹中的所有内容，并且构造也可以保证终止。

# android - 重命名android应用程序包错误

> ID：11511914
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:20:15.430
> 
> 标签：android, eclipse, package, rename

**更新我的 ADT 后，尝试通过Androi Tools > Rename Application Package**在 Eclipse 中重命名我的 android 应用程序包时出现以下错误。我也尝试将内存提升到 xmx512 但仍然抛出**内部错误**。

```
java.lang.reflect.InvocationTargetException
    at org.eclipse.jface.operation.ModalContext.run(ModalContext.java:421)
    at org.eclipse.ui.internal.WorkbenchWindow$13.run(WorkbenchWindow.java:1666)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.ui.internal.WorkbenchWindow.run(WorkbenchWindow.java:1663)
    at org.eclipse.ltk.ui.refactoring.RefactoringWizard.createChange(RefactoringWizard.java:663)
    at org.eclipse.ltk.ui.refactoring.RefactoringWizard.computeUserInputSuccessorPage(RefactoringWizard.java:502)
    at org.eclipse.ltk.ui.refactoring.RefactoringWizard.getStartingPage(RefactoringWizard.java:472)
    at org.eclipse.jface.wizard.WizardDialog.showStartingPage(WizardDialog.java:1271)
    at org.eclipse.jface.wizard.WizardDialog.createContents(WizardDialog.java:610)
    at org.eclipse.jface.window.Window.create(Window.java:431)
    at org.eclipse.jface.dialogs.Dialog.create(Dialog.java:1089)
    at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation$1.run(RefactoringWizardOpenOperation.java:178)
    at org.eclipse.swt.custom.BusyIndicator.showWhile(BusyIndicator.java:70)
    at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:202)
    at org.eclipse.ltk.ui.refactoring.RefactoringWizardOpenOperation.run(RefactoringWizardOpenOperation.java:122)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.RenamePackageAction.initiateAndroidPackageRefactoring(RenamePackageAction.java:168)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.RenamePackageAction.promptNewName(RenamePackageAction.java:151)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.RenamePackageAction.run(RenamePackageAction.java:106)
    at org.eclipse.ui.internal.PluginAction.runWithEvent(PluginAction.java:251)
    at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(ActionContributionItem.java:584)
    at org.eclipse.jface.action.ActionContributionItem.access$2(ActionContributionItem.java:501)
    at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(ActionContributionItem.java:411)
    at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
    at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1053)
    at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:4169)
    at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3758)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916)
    at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86)
    at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585)
    at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
    at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540)
    at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
    at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
    at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
    at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
    at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
    at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
    at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
    at org.eclipse.equinox.launcher.Main.main(Main.java:1414)
Caused by: java.lang.NullPointerException
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.ApplicationPackageNameRefactoring.updateJavaFileImports(ApplicationPackageNameRefactoring.java:149)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.ApplicationPackageNameRefactoring$JavaFileVisitor.visit(ApplicationPackageNameRefactoring.java:426)
    at org.eclipse.core.internal.resources.Resource$2.visit(Resource.java:126)
    at org.eclipse.core.internal.resources.Resource$1.visitElement(Resource.java:85)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:82)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.iterate(ElementTreeIterator.java:127)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:95)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:52)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:124)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:108)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.ApplicationPackageNameRefactoring.createChange(ApplicationPackageNameRefactoring.java:126)
    at org.eclipse.ltk.core.refactoring.CreateChangeOperation.run(CreateChangeOperation.java:124)
    at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2344)
    at org.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:87)
    at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121)
Root exception:
java.lang.NullPointerException
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.ApplicationPackageNameRefactoring.updateJavaFileImports(ApplicationPackageNameRefactoring.java:149)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.ApplicationPackageNameRefactoring$JavaFileVisitor.visit(ApplicationPackageNameRefactoring.java:426)
    at org.eclipse.core.internal.resources.Resource$2.visit(Resource.java:126)
    at org.eclipse.core.internal.resources.Resource$1.visitElement(Resource.java:85)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:82)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.doIteration(ElementTreeIterator.java:86)
    at org.eclipse.core.internal.watson.ElementTreeIterator.iterate(ElementTreeIterator.java:127)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:95)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:52)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:124)
    at org.eclipse.core.internal.resources.Resource.accept(Resource.java:108)
    at com.android.ide.eclipse.adt.internal.refactorings.renamepackage.ApplicationPackageNameRefactoring.createChange(ApplicationPackageNameRefactoring.java:126)
    at org.eclipse.ltk.core.refactoring.CreateChangeOperation.run(CreateChangeOperation.java:124)
    at org.eclipse.core.internal.resources.Workspace.run(Workspace.java:2344)
    at org.eclipse.ltk.internal.ui.refactoring.WorkbenchRunnableAdapter.run(WorkbenchRunnableAdapter.java:87)
    at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:14:30.443

检查您的课程并确保将其重命名。我遇到了一个问题，它没有更改课程顶部的包名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T11:00:10.557

最后我找到了。这是因为我的 java 包名与我的 android 包名相同。

# html - 将图像水平居中定位并使高度为视口的 100%

> ID：11511918
> 
> 赞同：5
> 
> 时间：2012-07-16T20:20:39.663
> 
> 标签：html, css

我有一张占据视口整个高度的图像。图像高度应跨越整个视口高度（100%），以便适合从其查看的屏幕（已在此处完成），并且宽度应与高度成相对比例。正如您在我的页面 ( [http://lamininbeauty.co.za](http://lamininbeauty.co.za) ) 中看到的，页面的两侧有空间。我希望图像水平居中。下面是我的代码：

CSS：

```
body{
    margin: 0px;
    padding: 0px;
    overflow: hidden;
}

#main{
    margin: auto;
}

img.bg {
        /* Set rules to fill background */
        max-height: 100%;

        /* Set up proportionate scaling */
        height: auto;

        /* Set up positioning */
        position: fixed;

} 
```

HTML：

```
<body>
<div id="main">
    <img class="bg" src="images/massage2.jpg" border="none" />  
</div>
</body> 
```

注意：我不希望图像失去纵横比，它应该始终适合垂直 100%，没有图像被切断，也没有垂直滚动。水平居中。我尽量远离 background-size 属性，因为 IE8 及更低版本不支持它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-16T21:04:21.437

只需添加`left:0;right:0;margin:0 auto;`到`img.bg`（[示例](http://jsfiddle.net/JnwWH/)）：

```
body{
    margin: 0px;
    padding: 0px;
    overflow: hidden;
}

#main{
    margin: auto;
}

img.bg {
    /* Set rules to fill background */
    max-height: 100%;

    /* Set up proportionate scaling */
    height: auto;

    /* Set up positioning */
    position: fixed;

    /* Align horizontally */
    left:0;
    right:0;
    margin:0 auto;   
} 
```

## 替代解决方案

如果您希望图像永远不会被切断（水平或垂直）并始终居中，请尝试使用此代码（来自[https://stackoverflow.com/a/6284195/526741](https://stackoverflow.com/a/6284195/526741)）：

```
<img class="absoluteCenter" src="PATHTOIMAGE"> 
```

```
/* Don't Change - Positioning */
.absoluteCenter {
 margin:auto;
 position:fixed;
 top:0;
 bottom:0;
 left:0;
 right:0;
}

/* Sizing */
img.absoluteCenter {
 max-height:100%;
 max-width:100%;
} 
```

*   [宽幅图像](http://jsfiddle.net/nzxPV/3/)
*   [高大的形象](http://jsfiddle.net/nzxPV/4/)
*   [小图](http://jsfiddle.net/nzxPV/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:02:14.137

将 img 放入 div 并设置`text-align: center`。使 div 固定，而不是 img。要拉伸较小的图像，请使用`height: 100%`而不是`max-height`.

```
div.bg {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    text-align: center;
}
div.bg img {
    height: 100%;
}​ 
```

**工作演示：http:** [//jsfiddle.net/Mt7ce/](http://jsfiddle.net/Mt7ce/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T21:02:21.807

我假设您`main`将包含其他项目，因此使用第二个包装器`div`：

```
<div id="main">
    <div class="bg">
        <img src="http://lamininbeauty.co.za/images/massage2.jpg" border="none" />
        <span>Some text.</br>And Some More.</span>
    </div>  
</div> 
```

你可以设置这个CSS：

```
body {
    overflow: hidden;
}

.bg{
    width: 100%;
    height: 100%;
    text-align: center;
    position: fixed;
}

.bg img {
    max-height: 100%;
    height: auto;
}

.bg span {
    display: block;
    position: absolute;
    width: 100%;
    font-size: 20px; /* sizing this to the dynamic height of img will be a challenge */
    top: 20%;
} 
```

并得到你想要的（现在有文字）[，如图所示](http://jsfiddle.net/eujaH/17/)。如前所述，添加文本时，您将面临的最大挑战是调整文本的大小。您可能需要使用 javascript 或一`@media`组来更改文本大小`height`。就个人而言，除非文本很重要（如果这是背景，我会认为它不是），我会将文本放在图像中，以便它随大小缩放并与图像保持正确的关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T21:00:35.667

好吧我不知道你是否可以设置主要高度，但如果你可以设置高度然后

```
body{
    margin: 0px;
    padding: 0px;
    overflow: hidden;
}

#main{
    text-align: center;
    height: 300px;
}

img.bg {
        /* Set rules to fill background */
        max-height: 100%;

        /* Set up proportionate scaling */
        height: auto;       
} 
```

我只在FF上测试过。对于 main 的高度，您始终可以使用 jquery 将其设置为视口。如果不设置那个高度，我无法想出你想要的东西。

# php - url查询参数解析，最佳选择

> ID：11511921
> 
> 赞同：0
> 
> 时间：2012-07-16T20:20:50.420
> 
> 标签：php

我的网址中有这个

```
http://www.test.com/?jjjanu@gmail.com&amp;tid=RetEm_Welcome_resp_05232012 
```

问题是它不是

```
http://www.test.com/?email = jjjanu@gmail.com&amp;tid=RetEm_Welcome_resp_05232012

notice email = jjjanu@gmail.com 
```

所以我无法`$_GET['email']` 从上面的字符串中获取电子邮件地址？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:25:01.227

给出的两个示例都不适用于所需的`$_GET['email']`.

第一个示例，`http://www.test.com/?jjjanu@gmail.com&tid=RetEm_Welcome_resp_05232012`没有电子邮件地址的“键”，因此获取它的唯一方法是遍历每个查询字符串参数，并假设无键值是电子邮件地址或执行正则表达式-匹配它。一些（非常）基本的东西是：

```
$email = '';
foreach ($_GET as $key => $val) {
    if (strpos($key, '@') && ($val == '')) {
        // assume this is an email address
        $email = $key;
        break;
    }
} 
```

第二个示例，`http://www.test.com/?email = jjjanu@gmail.com&tid=RetEm_Welcome_resp_05232012`，“电子邮件”一词后的空格计入名称。它可以通过以下方式检索： `$email = $_GET['email '];`

`?email=[email address]`常规查询字符串不起作用是否有特定原因？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T20:32:21.423

显而易见的答案已经`foreach`结束`$_GET`，并在密钥中查找电子邮件地址。**但是**这不起作用，因为 PHP 会将`.`电子邮件地址中的 （以及可能的其他字符）转换`_`为向后兼容的字符`register_globals`。这使任务更加困难，~~但并非不可能：~~

只是一直在玩它，实际上这*是*不可能的，因为 PHP 实际上会`.`使用电子邮件地址中的 并将其转换为`_`即使您从`$_SERVER['QUERY_STRING']`. 对不起。

它可能适用于 POST 请求，因为我认为 PHP 不会修改可以从中获取的数据`php://input`- 但如果您可以修改它，您可能可以修改请求 URL，使其具有正确的密钥，而这些都没有会是个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:29:12.657

您可以通过以下方式获取请求 uri 字符串

```
$query=$_SERVER['REQUEST_URI']; 
```

之后，您可以根据需要解析此查询

# ember.js - 在排序时刷新 containerView

> ID：11511925
> 
> 赞同：2
> 
> 时间：2012-07-16T20:21:11.380
> 
> 标签：ember.js

我正在尝试在 containerView 已经显示后对其进行排序。但是，由于数组的长度不会改变，而只是顺序改变，因此视图不会刷新。是否有关于如何强制视图重新渲染的最佳实践？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T21:15:27.510

如果您在此处获取 Embers GitHub 页面的最新版本：[https](https://github.com/emberjs/ember.js/downloads) ://github.com/emberjs/ember.js/downloads ，它包括 Ember.ArrayController，而后者又使用 Ember.SortableMixin。

你像这样定义你的控制器：

```
HS.BlogPostsListController = Em.ArrayController.create({
    content: [],
    sortAscending: false,
    sortProperties: ['postDate'],
    //the rest of your controller definition...
} 
```

然后你绑定你的视图你的控制器的排列内容属性，如下所示：

```
{{#view MyApp.view contentBinding="HS.BlogPostListController.arrangedContent" ...}} 
```

这将使您的视图在排序更改时保持更新（当您更改 sortAscending 或 sortProperties 属性时）。

如果您不想拉取最新版本，您应该查看 SortableMixin 源代码，看看是否可以将其合并到您自己的应用程序中：[https ://github.com/emberjs/ember.js/blob/master /packages/ember-runtime/lib/mixins/sortable.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-runtime/lib/mixins/sortable.js)

编辑：您可以在 GitHub 上看到 HS.BlogPostListController 的运行情况：[https ://github.com/joachimhs/haagen-software.no/blob/master/app/controllers.js](https://github.com/joachimhs/haagen-software.no/blob/master/app/controllers.js)

# sql - 按嵌套选择分组时列名无效

> ID：11511927
> 
> 赞同：0
> 
> 时间：2012-07-16T20:21:12.503
> 
> 标签：sql, tsql

我有以下代码，当我按原样运行它时，它将返回给我我想要的数据：

```
select tagid, 
  (select TOP 1 Locations.CostCenter
  from item
  inner join transactions on transactions.itemid = item.id 
  inner join recvlocationmapping on recvlocationid = transactions.locationid 
  left outer join locations on locations.id = servicelocationid  
  where tagid = c.TagID
  and costcenter != '' 
  and Costcenter is not null 
  order by transdate desc) as CostCenter
from item as c where createddate between '07-01-2012' and '07-05-2012' 
```

当我想将 group by 添加到其中一列时，问题就来了。然后它会抛出一个错误，说该列不存在，但是当我在没有 Group By 列和名称的情况下运行查询时。

这是我遇到问题的按代码分组：

```
select Count(tagid), 
  (select TOP 1 Locations.CostCenter
  from item
  inner join transactions on transactions.itemid = item.id 
  inner join recvlocationmapping on recvlocationid = transactions.locationid 
  left outer join locations on locations.id = servicelocationid  
  where tagid = c.TagID
  and costcenter != '' 
  and Costcenter is not null 
  order by transdate desc) as CostCenter
from item as c where createddate between '07-01-2012' and '07-05-2012'
group by CostCenter 
```

我认为这是我如何返回数据的问题，但我对 SQL 的了解还不够，无法弄清楚如何解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:27:34.973

部分声明的别名`select ...`不能用于`group by`. 您要么必须复制嵌套选择，`group by`要么使用以下内容：

```
select Count(q.tagid), q.CostCenter
from
    (select 
       tagid, 
       (select TOP 1 Locations.CostCenter
           from item
           inner join transactions on transactions.itemid = item.id 
           inner join recvlocationmapping on recvlocationid = transactions.locationid 
           left outer join locations on locations.id = servicelocationid  
           where tagid = c.TagID
           and costcenter != '' 
           and Costcenter is not null 
           order by transdate desc
       ) as CostCenter
       from item as c where createddate between '07-01-2012' and '07-05-2012'
    ) q
group by q.CostCenter 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:33:43.303

您可以在`APPLY`此处使用 T-SQL 功能，它类似于您使用的相关子查询，但可以多次引用而无需重复相同的代码，并且如果需要还可以返回多个列/行。

```
SELECT  COUNT(tagid), 
        CostCenter
FROM    item as c 
        OUTER APPLY
        (   SELECT  TOP 1 Locations.CostCenter
            FROM    item
                    INNER JOIN transactions 
                        ON transactions.itemid = item.id 
                    INNER JOIN recvlocationmapping 
                        ON recvlocationid = transactions.locationid 
                    INNER JOIN locations 
                        ON locations.id = servicelocationid  
            WHERE   tagid = c.TagID
            AND     costcenter != '' 
            ORDER BY transdate DESC
        ) AS CostCenter
WHERE   createddate BETWEEN '07-01-2012' AND '07-05-2012'
GROUP BY CostCenter 
```

我还对您的子查询进行了一些修改，我将`LEFT JOIN`on 位置更改为 an ，`INNER JOIN`因为您不需要`AND CostCenter IS NOT NULL`a并且s 会表现得更好。其次是多余的，因为`LEFT JOIN``INNER JOIN``AND CostCenter IS NOT NULL``AND CostCenter != ''``NULL != ''`

**编辑**

经过进一步思考，我认为您可以从中完全删除相关的子查询并使用`JOINS`. 这应该会导致更有效的执行：

```
;WITH CostCenter AS
(   SELECT  TagID, CostCenter, ROW_NUMBER() OVER(PARTITION BY TagID ORDER BY TransDate DESC) AS RowNumber
    FROM    item
            INNER JOIN transactions 
                ON transactions.itemid = item.id 
            INNER JOIN recvlocationmapping 
                ON recvlocationid = transactions.locationid 
            INNER JOIN locations 
                ON locations.id = servicelocationid  
    WHERE   costcenter != '' 
)
SELECT  COUNT(TagID), CostCenter
FROM    Item
        INNER JOIN CostCenter
            ON Item.TagID = CostCenter.TagID
            AND RowNumber = 1
WHERE   createddate BETWEEN '07-01-2012' AND '07-05-2012'
GROUP BY CostCenter 
```

# ruby-on-rails - 谷歌搜索引擎

> ID：11511936
> 
> 赞同：0
> 
> 时间：2012-07-16T20:21:41.013
> 
> 标签：ruby-on-rails, backbone.js, google-search

我有 Rails + Backbonejs 应用程序。并且许多对搜索内容有用的页面都使用backbonejs显示-因此所有搜索信息都使用js添加。据我了解，谷歌搜索仅使用 html 响应来获取内容，并且无法在“js”页面下爬行。

在这种情况下，谷歌搜索引擎创建html页面是否可以接受和有效，与“js”页面内容相同，并且只允许google bot请求。其他请求将重定向到适当的“js”页面？

例如：google bot 查找 html 页面 'sitename.com/users/N'。并将其与所有内容编入索引。在搜索结果中将显示链接“sitename.com/users/N”。用户点击它，他重定向到“sitename.com/#users/N”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T23:03:03.380

设置您的服务器，以便“sitename.com/users/N”提供与访问“sitename.com/#users/N”所看到的内容相同的内容。这将适用于任何搜索引擎（信不信由你，谷歌不是唯一的......）以及文本浏览器、屏幕阅读器和禁用 js 的浏览器。然后，您的 js 可以劫持链接和输入元素（如果可用）。

# jquery - 在表单提交中包含 iframed WYSIWYG 编辑器

> ID：11511943
> 
> 赞同：0
> 
> 时间：2012-07-16T20:22:34.963
> 
> 标签：jquery, wysiwyg

我试图在最终通过 AJAX 发送到服务器的表单中包含 WYSIWYG 编辑器。问题是序列化表单不包括编辑器输入，因为它正在页面上的 iframe 中呈现。这似乎是“所有”编辑都这样做的方式（我只尝试了 4 个）。

我的问题是：

1.) 如何在序列化表单中包含或检索 iFramed WYSIWYG 编辑字段以进行 POST

或者

2.) 是否有一个基本的 WYSIWYG HTML 编辑器*不*使用 iFrame 方法，并且会以正在发布的表单呈现输入字段

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T21:01:58.070

如果您使用 CKEditor（正如您声明已测试过的那样），您可以在序列化表单之前调用[updateElement](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.editor.html#updateElement)并且 textarea 将拥有当前数据，或者您可以通过调用[getData](http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.editor.html#getData)来检索它。

对于正常提交，该操作是自动的，但由于您不使用表单提交，因此它不会自行工作。

# css - 如何在分页中突出显示当前页码

> ID：11511944
> 
> 赞同：0
> 
> 时间：2012-07-16T20:22:34.200
> 
> 标签：css

我使用了下面的代码，但它不能完全正常工作。我的意图是用蓝色突出显示当前页面而不悬停，其他页面在鼠标悬停时应该用蓝色突出显示。但是我的代码在没有悬停的情况下没有突出显示当前页面。

HTML：

```
<div class="pagination" align="right" style="margin:8px 16px; 8px; padding-top:5px">
<div class='pagenumbers'>
<a class='number current'>1</a>
<a href="http://url/2" class='number'>2</a>
<a href="http://url/2">Next &gt;&gt; </a>&nbsp;<a  href="url">Last Page &gt;&gt; </a>       </div>
</div> 
```

CSS：

```
.pagination, .pagination a {
    background: #f7f7f7;
    padding: 5px 10px;
    text - decoration: none;
    color: #7e7e7e;
    border: 1px solid # c6c6c6;
    font - weight: bold;
    border - radius: 3px;
}

.pagination: hover {
    background: #f7f7f7;
    padding: 5px 10px;
    text - decoration: none;
    color: #7e7e7e;
    border: 1px solid # c6c6c6;
    font - weight: bold;
    border - radius: 3px;
}

.current a {
    background: #9ad6fb;
    padding: 5px 10px;
    text-decoration: none;
    color: # 7e7e7e;
    border: 1px solid#c6c6c6;
    font - weight: bold;
    border - radius: 3px;
    background: linear - gradient(top, #9ad6fb 0%,# 9ad6fb 52 % , #ebebeb 100 % );
    background: -webkit - linear - gradient(top, #9ad6fb 0%,# 9ad6fb 52 % , #ebebeb 100 % );
    box - shadow: inset 0 4px 3px rgba(255, 255, 255, 0.6),
    0 1px 3px rgba(0, 0, 0, .2);
}

.pagenumbers current: a {
    background: #9ad6fb;
    border: 1px solid # 72ade4;
    color: #4879a6;
    background: linear-gradient(top, # 9ad6fb 0 % ,
    #77c4fc 100%);
    background: -webkit-linear-gradient(top, # 9ad6fb 0 % ,
    #77c4fc 100%);
    box-shadow: inset 0 1px 4px rgba(255,255,255,0.75), 0 1px 3px rgba(79,126,167,.5);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T20:25:51.993

```
.pagenumbers current:a { 
```

应该

```
.pagenumbers a.current { 
```

[小提琴](http://jsfiddle.net/bqT3u/)

# search - 如何使用机器学习创建最佳自动建议

> ID：11511960
> 
> 赞同：5
> 
> 时间：2012-07-16T20:23:40.480
> 
> 标签：search, autocomplete, machine-learning

我正在构建一个自动建议功能。

我有一组大约 23k 个条目的数据，在这个数据中是单词，以及多个单词的组合，即“London College of Arts”和“London”。

我想编写一个自动完成搜索功能，它考虑到已经输入的字母，比如“LO”，还有我拥有的其他一些数据点：

*   地点，

*   一年中的一天，

*   以前的搜索次数，

*   得分项目 - 比如说伦敦艺术学院有 20,000 名学生，这使得它的排名高于只有 5,000 名等的“伦敦经济学院”。

我从初步研究中猜想我需要开始学习某种机器学习技术，但是我仍然很难看到哪种机器学习技术最适合这个问题，SVN、NN 等。我发现很难找到任何这些算法的实际示例用于此类问题，非常感谢任何帮助或指向良好资源的指针。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:46:05.020

查找[Apache Solr](http://lucene.apache.org/solr/)（它可能只满足您对自动建议的需求），但提供了相当不错的自动建议 OOTB，而无需您从头开始创建。由于它提供了一个 RESTful 界面，因此您可以集成到大多数选择的语言中。

您还可以通过上下文变量（例如位置、日期等）进行加权。Solr 是一个强大的工具，它不仅可以自动建议，而且可以满足您的需求。

# php - PHP in_array() 总是返回 false

> ID：11511962
> 
> 赞同：6
> 
> 时间：2012-07-16T20:24:16.030
> 
> 标签：php, arrays

当我使用 in_array() 时 PHP 总是返回 false，它是否在数组中并不重要。例如：

```
$list = 'test
list
example';
$list_arr = array();
$list_arr = explode("\n",$list);
if (in_array('test',$list_arr)) {
    echo 'Found';
}
else {
    echo 'Not Found';
} 
```

即使 'test' 是数组中的值，也返回 'Not Found'

```
$list = 'test
list
example';
$list_arr = array();
$list_arr = explode("\n",$list);
if (in_array('qwerty',$list_arr)) {
    echo 'Found';
}
else {
    echo 'Not Found';
} 
```

返回“未找到”，因为它应该

为什么它应该为真时返回假？请提出任何建议。我实际使用的列表有超过 10K 的值，因此我只是在这里缩短了它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-16T20:26:50.427

如果您正在使用这个确切的示例并在 Windows PC 上进行编码，那么问题出在 Windows 使用以下方式存储换行符这一事实：

```
\r\n 
```

因此，当您在 \n 上拆分时，您只会在项目末尾保留一个不可见的 \r ，因此它们不匹配。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-16T20:26:31.977

您的列表实际上是用 分隔的`\r\n`，而不仅仅是`\n`.

```
$list_arr = explode("\r\n",$list); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:35:57.403

这是将值放入列表的一种非常奇怪的方式。因此，我假设您最终尝试将单独文件中的行放入数组中。在这种情况下，你会做

```
file('path/to/file'); 
```

将每一行读入一个单独的数组项。

引用的文件如下所示：

```
test
list
example 
```

如果您知道代码示例中的值，则应该将它们放入数组中，而不是从字符串中读取它们。

如果您只是必须从字符串中读取值，我建议使用 PHP_EOL 常量来定义换行符。像这样：

```
$list = 'test' . PHP_EOL . 'list' . PHP_EOL . 'example';
$list_arr = explode(PHP_EOL, $list); 
```

PHP_EOL 常量将为您提供一种更好的独立于平台的方式来获取定义换行符的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T20:29:23.120

如前所述，Windows 使用 \r\n 作为行尾字符。Unix 使用\n，Mac 使用\r。要制作可移植代码，请使用 PHP_EOL 常量来分解您的字符串：

```
$list_arr = explode(PHP_EOL, $list) 
```

这样，您可以确定它始终正常工作。

# c# - Linq 获取不同的

> ID：11511964
> 
> 赞同：3
> 
> 时间：2012-07-16T20:24:26.277
> 
> 标签：c#, linq, random, distinct

我有一个查询：

```
var q = (
    from c in db.tblStoreRecommendations
    where
    itemIDsInCart.Contains(c.ItemID)
    && !itemIDsInCart.Contains(c.RecommendItemID)
    select c
); 
```

它将返回以下内容：

```
ID    ItemID    RecommendItemID    Message
------------------------------------------
1     25        3                  Msg here
2     26        3                  Something else
3     27        8                  Another message 
```

我需要查询过滤掉具有相同的结果`RecommendItemID`，这不应该多次出现在返回的结果中。

如果存在两个，它可以使用任何一个（最好随机选择）。所以返回的结果应该省略记录 ID 1 或 2。

谁能告诉我如何做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T20:31:15.940

一种方法是使用 GroupBy，然后从每个组中选择第一项：

```
var q = (
    from c in db.tblStoreRecommendations
    where
        itemIDsInCart.Contains(c.ItemID)
     && !itemIDsInCart.Contains(c.RecommendItemID)
    select c
).GroupBy(c => c.RecommendItemID)
 .Select(g => g.First()); 
```

* * *

如果您使用它来显示随机评论，我建议将其强加到使用代码而不是 LINQ 查询中，通过省略`First`类似这样：

```
var q = (
    from c in db.tblStoreRecommendations
    where
        itemIDsInCart.Contains(c.ItemID)
     && !itemIDsInCart.Contains(c.RecommendItemID)
    select c
).GroupBy(c => c.RecommendItemID)
 .Select(g => g.ToArray());

var random = new Random();
foreach (var r in q)
{
    var rec = r[random.Next(r.Length)];
    // use your recommendation
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T20:31:16.597

我相信您可以在 linq 表达式的末尾添加一个独特的比较，例如：

```
var q = (
  from c in db.tblStoreRecommendations
  where
  itemIDsInCart.Contains(c.ItemID)
  && !itemIDsInCart.Contains(c.RecommendItemID)
  select c
)
.Distinct((x, y) => x.RecommendItemID == y.RecommendItemID); 
```

* * *

*编辑*

我刚刚意识到我是使用我自己编写的扩展方法来做到这一点的，并且通常可以方便地使用......这是它的代码：

```
 /// <summary>
    /// Provides a way to get a distinct list of items based on a lambda comparison operator.
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="source"></param>
    /// <param name="equalityComparer">A comparison function that returns true of the two items are considered equal.</param>
    /// <returns>The list of distinct items.</returns>
    public static IEnumerable<T> Distinct<T>(this IEnumerable<T> source, Func<T, T, bool> equalityComparer)
    {
        var distincts = new List<T>();
        foreach (var item in source)
        {
            var found = false;
            foreach (var d in distincts)
            {
                found = equalityComparer(item, d);
                if (found)
                    break;
            }

            if (!found)
            {
                distincts.Add(item);
                yield return item;
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T20:48:16.243

让我们尝试尽可能地坚持查询表达式：

```
var q = from c in db.tblStoreRecommendations
        where itemIDsInCart.Contains(c.ItemID)
          && !itemIDsInCart.Contains(c.RecommendItemID)
        group c by c.RecommendItemID into matches
        select matches.First(); 
```

上下文关键字[`into`](http://msdn.microsoft.com/en-us/library/bb311045.aspx)在这里肯定会派上用场。

这是[随机化](http://msdn.microsoft.com/en-us/library/aa329891%28v=vs.71%29.aspx)它的方法：

```
private static Random random = new Random(); 
```

* * *

```
var q = from c in db.tblStoreRecommendations
        where itemIDsInCart.Contains(c.ItemID)
          && !itemIDsInCart.Contains(c.RecommendItemID)
        group c by c.RecommendItemID
        into matches
        select matches.AsEnumerable().ElementAt(random.Next(matches.Count())); 
```

由于 LINQ to SQL 无法处理调用，因此我在从分组中选择 Random 元素之前`ElementAt`编辑了执行查询的答案（通过调用）。`AsEnumerable`

# python - 从没有类或 id 的 HTML 中选择图像标签 attr

> ID：11511970
> 
> 赞同：0
> 
> 时间：2012-07-16T20:24:51.187
> 
> 标签：python, lxml

我有通过 Python 和 Lxml 解析的 HTML 页面。问题是我必须从没有任何类或 id 属性的 HTML 图像标签的值中获取。像这样：

```
<table cellspacing="0" cellpadding="0" border="0">
<tbody><tr>
<td align="left" valign="top" style="padding: 0 10px 0 60px;">
<img src="/files/135.jpg" width="64" height="64">
</td>
<td align="left" valign="middle"><h1>Archer / Арчер</h1>
</td>
</tr>
</tbody></table> 
```

所以，为了解决我的任务，我有一个问题 - 是否可以编写类似 jquery 的表达式来从这个 HTML 中选择图像标签，或者我必须通过迭代所有 img 标签并获取具有特定宽度和高度的 src 属性来提取属性?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:54:31.587

您应该尝试[xpath](http://lxml.de/xpathxslt.html) - lxml 支持。您可以使用 mozilla firefox 的 firepath 插件来稍微使用 xpath。你的 xpath 表达式的结尾可以是 (width > 64 ?) ........../img[@border="0"]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:57:46.463

此`xpath`查询适用于您的示例数据：

```
import lxml.html

root = lxml.html.fromstring('your sample data').getroottree()
root.xpath("//img[@width='64' and @height='64']/@src")
# ['/files/135.jpg'] 
```

# python - 长期数据采集

> ID：11511974
> 
> 赞同：-1
> 
> 时间：2012-07-16T20:25:13.170
> 
> 标签：python, matplotlib, typeerror, nonetype

我正在尝试运行一个用于长期实验室数据采集（约 1 个月）的 Python 脚本。下面的脚本应该从 SQL 数据库中获取数据并从 DAQ 设备中获取数据并将其保存到文本文件中。然后它会实时绘制 1 小时的数据。由于我遇到的内存错误，实时绘图已被注释掉，但这不是我关心的问题。

运行代码 3-4 天会给我以下错误：

```
Trackback (most recent call last):
 file *** line 105 in <module>
    deltay=float(float(tupline[3]/10-float(tupline2[3])/10)
TypeError: 'NoneType' object has to attribute '__getitem__' 
```

关于如何让这个脚本运行更长时间的任何想法？

```
import ctypes
from UniversalLibrary import *
import time
import datetime
from numpy import *
from scipy import *
import MySQLdb as mdb
import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import random

boardNum=0
portNum=10
inputVoltage = 3

BoardNum = 0
Gain = BIP5VOLTS
Chan = 0

spTimes =14*24*60*60     ##here you set the time
timeDuration=spTimes
padsToVisualize =[0,1,2,3,4]  ##pads that will be measured and visualized

#plt.ion()    ##this command is necassary in order to have new points on the plot without erasing the old ones

curTime=time.clock()
movingWinDur=60    ##seconds
print "curtime=",curTime

str_one_line=[]
straverage=[]
while (curTime < timeDuration):
    del str_one_line[:]
    padCounter=0;

    d=datetime.datetime.now()
    str_one_line=[(d.strftime("%Y-%m-%d %H:%M:%S")),',']   ##formatting the date -- this format is chosen based on the requirements for connecting to SQL database

    while (padCounter <len(padsToVisualize)):

        #fig1=plt.figure(padsToVisualize[padCounter])    ## making figures for plotting different pads

        print "pad No.: ", str(padsToVisualize[padCounter])
        #l=cbAOut(BoardNum,Chan,Gain,3019)   ## sets the voltage to 3.0 volts (the number 3019 is based on 12-bit resolution --> DAQ resolution)
        #n=cbDConfigPort(BoardNum,portNum,1)   ##the variable n serves aas a command line where the command is sent to the DAQ
        #b=cbDOut(BoardNum,portNum,(63-padsToVisualize[padCounter])) #####based on Prof. Mayer's solution, the line sends the pad number that we are interested in to the DAQ to get the signals 
        curTime=time.clock()
        d=datetime.datetime.now()
        #########################################################################

        ########## this part will use the datetime to fetch the temperature from the SQL data base
        ########## since the time stamps may not exactly match, the code uses a method of interpolation
        freq = 5
        time.sleep(1.8*freq) ## 1.8 is an arbitrary number ; to make sure there is data on sql database
        searchfor=d   ## the following lines find the temperature at time=searchfor
        print searchfor
        minussearchfor = searchfor-datetime.timedelta(0,freq/1.2)
        STRminussearchfor = minussearchfor.strftime("%Y-%m-%d %H:%M:%S")
        print "STRminussearchfor=", STRminussearchfor
        print "minussearchfor= ", minussearchfor
        plussearchfor =searchfor+datetime.timedelta(0,freq/1.2)
        print "plussearchfor= ", plussearchfor
        STRplussearchfor = plussearchfor.strftime("%Y-%m-%d %H:%M:%S")
        print "STRplussearchfor=", STRplussearchfor
        ##Database connection
        db = mdb.connect("localhost", "root", "qwerty@12345", "bondtest")
        cur = db.cursor()
        cur.execute("SELECT * FROM bondtest_data WHERE DateTime BETWEEN %(date1)s AND %(date2)s ORDER BY DateTime",{'date1':STRminussearchfor,'date2':STRplussearchfor})
##        con=pymssql.connect(host='LAB10-PC\SQLEXPRESS2008R2',user='sa',password='qwerty@12345')
##        cur = con.cursor()
##        cur.execute('SELECT * FROM OVEN11SQL.dbo.OvenLog1 WHERE DateTime BETWEEN %(date1)s AND %(date2)s ORDER BY DateTime',{'date1':STRminussearchfor,'date2':STRplussearchfor})
        tupline1 = cur.fetchone()
##        print 'between1= ',tupline1[1]
        delta = tupline1[1]-searchfor
##        print "delta = " ,delta
        if (int(searchfor.strftime("%S"))-int(tupline1[1].strftime("%S"))>0):
            delta = int(searchfor.strftime("%S"))-int(tupline1[1].strftime("%S"))
        else:
            delta = int(tupline1[1].strftime("%S"))-int(searchfor.strftime("%S"))
##        print 'delta= ',delta
        time1=tupline1[1]-datetime.timedelta(0,freq/1.2)
        STRtime1=time1.strftime("%Y-%m-%d %H:%M:%S")
        time2=tupline1[1]-datetime.timedelta(0,3*freq/1.2)
        STRtime2=time2.strftime("%Y-%m-%d %H:%M:%S")
##        time.sleep(2*freq) ##the program needs to wait for 3*frequency/2 so that the next point is available in SQL data base for interpolation
        cur.execute('SELECT * FROM bondtest_data WHERE DateTime BETWEEN %(date1)s AND %(date2)s ORDER BY DateTime',{'date1':STRtime2,'date2':STRtime1})
        tupline2 = cur.fetchone()   ##next point is fetched in order to find the slope of the line for temperature change
##        print 'between2= ', tupline2[1]
        deltay=float(float(tupline1[3])/10-float(tupline2[3])/10)
        deltax = int(tupline1[1].strftime("%S"))-int(tupline2[1].strftime("%S"))
        deltax = freq
##        print "deltay= ", deltay
##        print "deltax= ", deltax
        slope = deltay/deltax
##        print 'slope= ', slope

        ##in the following if statements depending on whether the temperature is increasing or decreasing the temperature for the desired point will be calculated
        if (tupline2[3]<tupline1[3]):
            tempsearchfor = float(tupline1[3])/10+delta*slope
##            print '+delta*slope= ',delta*slope
        elif (tupline2[3]>tupline1[3]):
            tempsearchfor = float(tupline1[3])/10-delta*slope
##            print '-delta*slope= ',delta*slope
        else:
            tempsearchfor = float(tupline1[3])/10
##        print 'tempserachfor= ',tempsearchfor

        #########################################################################

        strng = [str(int(padsToVisualize[padCounter])),',',(d.strftime("%Y-%m-%d %H:%M:%S")),',',str(round(curTime,4)),',',str(inputVoltage),',']
        str_one_line.extend(strng)         ##str_one_line is the line that contains the values that will be written to the text file , the order is specified in the variables lists excel file
        xyzCounter=Chan
        EngUnits= array(range(50*1),dtype=float).reshape(50,1)    ## constructing the array that will hold the 50 values for each set of signals and is later used for finding the average
        average = array(range(3*1),dtype=float).reshape(3,1)      ## holds the average of the t50 points for x,y,z
##        straverage=array(range(3*1),dtype=str).reshape(3,1)   ##this array will hold the strings for x,y,z signal to be written into txtfile
        del straverage[:]
        while(xyzCounter<3):   ##the way the oven is set up it has x,y,z outputs from channel 0,1,2 accordingly
            #n=cbDConfigPort(BoardNum,portNum,1)
            #b=cbDOut(BoardNum,portNum,(63-padsToVisualize[padCounter]))     #####based on Prof. Mayer's solution, the line sends the pad number that we are interested in to the DAQ to get the signals
            a=0
            time1=time.clock()
            while (a<50):    ## this while loop takes 50 measurements and writes the average of those points in to average array

                #DataValue=cbAIn(BoardNum, xyzCounter, Gain)
                #EngUnits[a,0]=float((cbToEngUnits(BoardNum,Gain,DataValue))/3/100*1000)
                EngUnits[a,0] = random.uniform(0,0.5)
                average[xyzCounter,0]=float(sum(EngUnits))/len(EngUnits)
                a+=1
            time2=time.clock()
            timePerSample=(time2-time1)/50
            print "time per sample= ",timePerSample
            print "samples per second =", (1/timePerSample)   ##measuring the frequency of the emasurements
            tempstr=str(round((average[xyzCounter,0]),3))    ##in order to remove the two brackets temp refers to temporary
            #tempstr=tempstr[1:-1]
            straverage.append(tempstr)
            xyzCounter+=1

        #print average
        temperaturearray=array(range(1*1),dtype=str).reshape(1,1)
        temperaturearray=[str(tempsearchfor)]
        three_sens_signals=array(range(1*5),dtype=str).reshape(1,5)
        three_sens_signals=[str((straverage[0])),',',str((straverage[1])),',',str((straverage[2])),',']
        str_one_line.extend(three_sens_signals)
        str_one_line.extend(temperaturearray)
        str_one_line.extend(',')

        padCounter+=1
        filename='log_simulation.txt'
        f = open(filename,"a")
      ## writing to file section
    print "padcounter=",padCounter,"   str_one_line=", str_one_line
    for item in str_one_line:  
        f.write("%s" % item )
    f.write("\n")
    f.close()

    curTime=time.clock() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:48:07.583

简而言之，这段代码有很多地方需要改进/修改（从编辑所有 import * 语句开始，并像你应该使用的那样使用命名空间）。话虽如此（代码显然大部分都按原样工作），但由于任何原因，存储在 tupline 或 tupline2 中的值都是 None ，所以出现了问题。在您的代码中，这些变量是使用 sql 语句分配的

```
tupline = cur.fetchone()
tupline2 = cur.fetchone() 
```

其中一个调用显然运行不顺畅（无论出于何种原因，数据或表已损坏），导致它返回“无”。也许有人正在删除或更换桌子？您可以添加一些语义来检查这种情况，报告并尝试继续。类似的东西

```
if tupline == None or tupline2 == None:
    print "Why does tupline = None?"
    continue 
```

您应该弄清楚 sql .fetchone() 方法何时不返回任何值。确实，您应该做一些更好的日志记录，但这可能会让您进入下一步的调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-04T19:12:39.420

正如 Paul Seeb 所指出的，错误消息的出现是因为`tupline`或者`tupline2`是`None`当代码到达该`deltay=...`行时。`tupline`您的代码（成功）在分配之后，在到达该`deltay`行之前访问元素。所以问题一定出在`tupline2`.

我的猜测是数据库不包含与`tupline2`查询匹配的记录；那肯定是要检查的东西。我还注意到，您已经在查询之前注释掉了延迟，`tupline2`这暗示该查询不能可靠地返回记录。我不知道你的程序逻辑，但你可以在`tupline2`查询之后用这样的行来解决问题：

```
if tupline2 is None:
    continue` 
```

或者您可以重试`tupline2`查询，直到它成功

```
while True:
    cur.execute(
        """SELECT * FROM bondtest_data 
            WHERE DateTime BETWEEN %(date1)s AND %(date2)s 
            ORDER BY DateTime""",
        {'date1':STRtime2,'date2':STRtime1}
    )
    tupline2 = cur.fetchone()
    if tupline2 is None:
        print "Failed to obtain a record for tupline2; trying again..."
        time.sleep(<some duration>)
    else:
        break 
```

我还注意到，您的代码`db`每次通过循环时都会创建一个新的数据库连接 ()，并且从未显式关闭它。我建议将`db = mdb.connect(...)`命令移到主循环开始的上方，或者在最后一个命令`db.close()`之后添加某个位置。`fetchone()`您的代码很可能达到某种连接限制，但这可能会引发不同的异常。`db`当重新分配并且旧连接超出范围时，您更有可能从某种自动关闭连接中受益。

# java - SQLiteOpenHelper onUpgrade 被多次调用

> ID：11511977
> 
> 赞同：1
> 
> 时间：2012-07-16T20:25:14.630
> 
> 标签：java, android, sqlite

我的 android 应用程序中有一个只读数据库，我会定期更新。该应用程序始终在其资产中携带最新版本的数据库。

我增加了传递给我的 SQLiteOpenHelper 子类的构造函数的版本号，将它（在本例中）提升到版本 4。

我有以下代码：

```
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // copy from assets to local storage; version really doesn't matter;
    // DB will be opened from the target location. 
    copyDataBase();
} 
```

当我调用以获取可读数据库时，会调用它：

```
SQLiteDatabase db = myDBHelper.getReadableDatabase();
// Here db.getVersion() correctly returns "4", the newVersion.
// db is also usable and has the correct data. 
```

但是每次我调用 getReadableDatabase onUpgrade 时，都会从 oldVersion=3 调用到 newVersion=4。

任何想法为什么版本不坚持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:23:35.583

有几件事。

“copyDataBase()”调用有点可疑，因为它可能正在复制一些保存的数据库副本，其中包含旧版本代码。db.getVersion() 可能正在使用传递给辅助类的构造函数的任何内容，而实际上并未从任何地方读取它。所以我会仔细检查或发布它。

还要确保您确实从子类中调用了超级构造函数：

```
 DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        Log.d("DatabaseHelper", "constructor. Version="+DATABASE_VERSION);
    } 
```

并确保在您的情况下日志输出显示“4”而不是 3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-08T11:42:18.317

这只是一个猜测。我遇到了同样的问题，所以我遇到了这篇文章。后来我意识到我正在使用`sqLiteDatabase.beginTransaction();`，`sqLiteDatabase.endTransaction();` 但`sqLiteDatabase.setTransactionSuccessful();`在我结束交易之前没有打电话。我把它放进去，它修好了。希望这会有所帮助，尽管我知道它已经很晚了。

# iphone - 如何仅在按钮后进行动作摇晃？

> ID：11511984
> 
> 赞同：0
> 
> 时间：2012-07-16T20:25:51.867
> 
> 标签：iphone, xcode, motion

> **可能重复：**
> [如何在按下按钮之前停止响应摇晃？](https://stackoverflow.com/questions/11865161/how-to-stop-responding-to-a-shake-before-a-button-is-pressed)

我有一个应用程序，目前如果您单击“播放”按钮，标签显示说“摇一摇播放”，问题是我是一个完全的初学者，我不知道如何订购它，所以用户必须先按下按钮，然后当标签显示时，如果用户摇动标签消失。这就是我所需要的，因为在那之后我已经整理了应用程序的其他部分。感谢任何提供帮助的人，请记住我是新手，所以请解释任何答案:) 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:42:13.797

最明显的方法是创建一个 iVar 或 @property，并在按下“播放”按钮后发生的操作中，将 iVar/@property 设置为 YES。在你检测到抖动的motionBegan:withEvent: 中，如果iVar/@property 不是YES，则直接返回而不执行抖动动作。并在您接受用户在适当的时间摇晃时将标签设置为隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T21:42:44.090

创建一个 BOOL 类型的实例变量。比如说，playIsTouched。在视图控制器的 viewDidLoad 方法中将其设置为 NO。在处理对 Play 按钮的触摸的方法中，将 playIsTouched 设置为 YES。在处理抖动的方法中，只有当 playIsTouched == YES 时才使标签消失。在相同的方法中，您可能希望将 playIsTouched 设置回 NO（如果您希望用户在摇动之前再次触摸按钮）。

# opengl - 在OpenGL中以正确的经度和纬度在地球上渲染点

> ID：11511988
> 
> 赞同：4
> 
> 时间：2012-07-16T20:26:18.207
> 
> 标签：opengl, latitude-longitude

从经度和纬度数据中获得正确的输出，我一天中的大部分时间都在头疼。我知道这个数据是正确的，通过在谷歌地图中绘制它。例如，我将显示这些经纬度坐标的数据：经度：4.905396 纬度：52.364643

在谷歌地图中绘制时，它显示了正确的位置，即荷兰的阿姆斯特丹： ![在 gmaps 上绘制阿姆斯特丹的位置](../Images/d1ad62dc0630b5df8ead77a3ab554211.png)

现在，当我在我的应用程序中绘制它时，它看起来如下： ![显示位置的自制应用程序](../Images/48175352e02eaf41e4bed30687245112.png)

是的，谷歌地图是 2D 表示，我的是 3D，但这只是为了证明经度和纬度值是正确的，所以如果我将它们转换为 3D 空间的公式是正确的，它们应该出现在同一个位置。

我一直在阅读网络上的很多文章以及 stackoverflow 本身。我已经阅读了这些文章并应用了我看到的所有不同类型的公式：

[将纬度和经度转换为 3D 空间中的点](https://stackoverflow.com/questions/10473852/convert-latitude-and-longitude-to-point-in-3d-space)

和

[球体上的 3D 坐标到纬度和经度](https://stackoverflow.com/questions/5674149/3d-coordinates-on-a-sphere-to-latitude-and-longitude)

这两个似乎有很好的例子的明确解释，但似乎没有任何效果。我现在正在做的是计算 3D 空间中的位置，然后对其进行归一化并使用它作为方向来绘制一条末端带有点的线，正如您在我的应用程序的屏幕截图中看到的那样。当使用大多数示例中使用的地球半径时，这与仅从中心绘制一条线到计算位置没有什么不同。

我现在的公式是：

```
X = r * cos(latitude) * cos(lontitude);
Y = r * cos(latitude) * sin(longitude);
Z = r * sin(latitude); 
```

我知道这是错误的，但我浏览了我在网上看到的所有示例，但没有一个显示正确的数据。通过使用来自谷歌地图的数据进行测试，我知道至少输入是正确的。

更新1：

我检查了纹理的拓扑结构，当它的纬度和经度分别为 0.0000 和 0.0000 时会发生这种情况： ![用 0.0000 和 0.0000 检查经纬度](../Images/e8b75dc1240daa7366c454d015107f51.png)

所以这意味着这已经是错误的，但它的偏移量是奇数，正如谷歌地图显示的那样，它应该是这样的： ![谷歌地图经纬度 0.0000, 0.0000](../Images/881abc383af1732f5bf5ce152e702e17.png)

绿色箭头是 0.0000、0.0000 标记。所以我的很明显，它偏向一边。我想它可能（不这么认为/希望如此）是纹理，我正在使用这个： http: [//naturalearth.springercarto.com/ne3_data/16200/textures/2_no_clouds_16k.jpg](http://naturalearth.springercarto.com/ne3_data/16200/textures/2_no_clouds_16k.jpg)

我从中获得：[Shadedrelief Natural Earth textures](http://www.shadedrelief.com/natural3/pages/textures.html)

更新 2：我用纹理检查了我的球体的拓扑结构，它似乎对 0.0 和 0.0 关闭，但我也怀疑我的公式。我从网上尝试了很多不同的方法，其中一些得到的 0.0 0.0 与我的第一个公式相同，但很多都没有。我的经度和纬度以-180~180和-90~90为单位。

更新 3：这是阿姆斯特丹地块的视图，它有点偏离，就像 0.0 0.0 lat/long piont。我猜地图或计算在某个地方是错误的。我会尝试调整纹理以稍微移动。 ![几乎固定](../Images/de2a38524b6c290553686386d4e7bba9.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-17T19:05:29.737

您必须首先将角度设为弧度，而不是度数。

然后检查：哪个轴向上？您的公式与 Z 向上（北极）和 X 在屏幕外（您将地球旋转到 0,0）一致

然而，更常见的是用 Y 向上和 Z 在屏幕外渲染视图。

检查纹理坐标是如何生成的，以查看哪个轴与 sin 一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T18:52:21.133

到目前为止还没有提到，但请确保传递给 cos 和 sin 的角度是弧度而不是度数[http://en.cppreference.com/w/cpp/numeric/math/cos](http://en.cppreference.com/w/cpp/numeric/math/cos)

# netfilter - 使用 libnetfilter_queue，重新注入的数据包不会影响更改，但是数据包的注入副本成功。为什么？

> ID：11511993
> 
> 赞同：1
> 
> 时间：2012-07-16T20:26:35.597
> 
> 标签：netfilter

我在 libnetfilter_queue 库中使用。

我需要更改数据包中的 dest ip。我更改 dest ip 并重新注入数据包： nfq_set_verdict(qh, id, NF_ACCEPT,size, originalPacket);

但改变没有生效。

但是，如果我更改数据包，请将其复制到新的 char 数组并调用以使用复制的数组设置判决，而不是更改生效。

难道我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T15:59:33.013

需要使用 NF_REPEAT 判决将数据包重新注入同一链。使用 NF_ACCEPT 判决将数据包注入后续链。但是为了这个目的，你应该标记数据包以避免循环，即：

```
iptables -t raw -A PREROUTING -p tcp -m tcp --dport 80 -m mark !
--mark 0x1/0x1 -m tcp -j NFQUEUE
iptables -t raw -A PREROUTING -p tcp -m tcp --dport 80 -m mark --mark
0x80/0x80 -m tcp ACCEPT # altered packets
iptables -t raw -A PREROUTING -p tcp -m tcp --dport 80 -m mark --mark
0x1/0x1 -m tcp ACCEPT # rest 
```

# qt - 使用 Windows 中的 Linaro 工具链为嵌入式 Linux 交叉编译的 Qt 4.8

> ID：11511994
> 
> 赞同：3
> 
> 时间：2012-07-16T20:26:39.647
> 
> 标签：qt, arm, cross-compiling, embedded-linux, toolchain

我正在尝试使用 Linaro Toolchain Windows Binary ( [https://launchpad.net/linaro-toolchain-binaries/trunk/](https://launchpad.net/linaro-toolchain-binaries/trunk/) ) 的 2012.06 版本来交叉编译 Qt 4.8 源以针对嵌入式 Linux ARM Cortex-8 板. 我可以使用这篇文章中提到的 CodeSourcery 工具链来做到这一点 --> [http://c2143.blogspot.com/?view=classic](http://c2143.blogspot.com/?view=classic)。但是目标板软件是使用 Linaro 工具链构建的，所以我正在为此努力。

我已经修补了上面帖子中提到的 mkspec，如下所示：

```
#
# qmake configuration for building with arm-none-linux-gnueabi-g++
#
include(../common/unix.conf)
include(../common/gcc-base-unix.conf)
include(../common/g++-unix.conf)
include(../common/qws.conf)

MAKEFILE_GENERATOR      = MINGW
CONFIG                 += no_import_libs no_generated_target_info
# modifications to g++.conf
QMAKE_CC                = arm-linux-gnueabihf-gcc
QMAKE_CXX               = arm-linux-gnueabihf-g++
QMAKE_LINK              = arm-linux-gnueabihf-g++
QMAKE_LINK_SHLIB        = arm-linux-gnueabihf-g++
QMAKE_LIB               = arm-linux-gnueabihf-ar
QMAKE_AR                = arm-linux-gnueabihf-ar cqs
QMAKE_OBJCOPY           = arm-linux-gnueabihf-objcopy
QMAKE_STRIP             = arm-linux-gnueabihf-strip
QMAKE_RUN_CC            = $(CC) -c $(CFLAGS) $(INCPATH) -o $obj $src
QMAKE_RUN_CC_IMP        = $(CC) -c $(CFLAGS) $(INCPATH) -o $@ $<
QMAKE_RUN_CXX           = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $obj $src
QMAKE_RUN_CXX_IMP       = $(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<
QMAKE_INCDIR            =
QMAKE_INCDIR_QT         = $$[QT_INSTALL_HEADERS]
QMAKE_LIBDIR_QT         = $$[QT_INSTALL_LIBS]
QMAKE_MOC               = $$[QT_INSTALL_BINS]\\moc.exe
QMAKE_UIC               = $$[QT_INSTALL_BINS]\\uic.exe
QMAKE_IDC               = $$[QT_INSTALL_BINS]\\idc.exe
QMAKE_COPY              = copy /y
QMAKE_COPY_DIR          = xcopy /s /q /y /i
QMAKE_MOVE              = move
QMAKE_DEL_FILE          = del
QMAKE_MKDIR             = mkdir
QMAKE_DEL_DIR           = rmdir
QMAKE_CHK_DIR_EXISTS    = if not exist
QMAKE_IDL               = midl
QMAKE_ZIP               = zip -r -9
CODESOURCERY_ARM_CFLAGS = -march=armv7-a -mtune=cortex-a8 -mthumb -mfpu=vfp -mfloat-abi=softfp -Wa,-mimplicit-it=thumb -marm -mthumb-interwork
#modifications to gcc-base.conf
QMAKE_CFLAGS           += $$CODESOURCERY_ARM_CFLAGS
QMAKE_CXXFLAGS         += $$CODESOURCERY_ARM_CFLAGS
QMAKE_LIBS             += -lrt -lpthread -ldl
QMAKE_LFLAGS           += $${QMAKE_LFLAGS_RPATH}$$[QT_INSTALL_LIBS]
!isEmpty(TARGET_QTDIR) {
    QMAKE_LFLAGS       += $${QMAKE_LFLAGS_RPATH}$${TARGET_QTDIR}/lib
}
!isEmpty(TARGET_SYSROOT) {
    QMAKE_LFLAGS       += $${QMAKE_LFLAGS_RPATH}$${TARGET_SYSROOT}/lib:$${TARGET_SYSROOT}/usr/lib
    QMAKE_LFLAGS       += -Wl,--dynamic-linker=$${TARGET_SYSROOT}/lib/ld-linux.so.3
}
load(qt_config) 
```

当我在顶层 Makefile 上运行 mingw32-make 以便为 ARM 板生成 Qt 库时，它会编译一段时间，但不可避免地会出现以下错误：

```
collect2.exe: error: ld returned 1 exit status
mingw32-make[1]: *** [..\..\lib\libQtCore.so] Error 1
mingw32-make[1]: Leaving directory `C:/Users/user/Desktop/qt_creator_toolchain...
mingw32-make: *** [sub-corelib-make_default-ordered] Error 2 
```

此错误发生在许多投诉之后，例如：

```
*.so uses VFP register arguments, *obj does not 
```

我研究了该错误并尝试将以下每个选项传递给我的 mkespec 并使用相同的错误进行重建：

```
-mfloat-abi=softfp
-mfloat-abi=soft
-mfloat-abi=hard 
```

我显然不明白为什么“-mfloat-abi=softfp”选项适用于 CodeSourcery Windows 工具链但不适用于 Linaro。其余的编译器标志显示在上面的 mkspec 中。

有人对如何使这项工作有任何见解或想法吗？提前致谢。

更新：

事实证明，如果我从这个修改 mkspec 中的 C_FLAGS：

```
-march=armv7-a -mtune=cortex-a8 -mthumb -mfpu=vfp -mfloat-abi=softfp -Wa,-mimplicit-it=thumb -marm -mthumb-interwork 
```

对此：

```
-march=armv7-a -mtune=cortex-a8 -mthumb -mfpu=neon -mfloat-abi=hard -Wa,-mimplicit-it=thumb -marm -mthumb-interwork 
```

然后我终于可以成功编译Qt了。这将如何影响我在板上运行 Qt 应用程序的性能/或能力？为什么我不能用 Linaro 做 softfp 但我可以用 CodeSourcery？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-18T02:08:36.867

- 嗨，phil999，
Cortex-A 系列程序员指南版本：2.0
，位于[http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.den0013a/index.html](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.den0013a/index.html)

从文档中可知，
-mfpu=vfp 指定目标具有 VFP 硬件。（与指定选项 -mfpu=neon 一样。）
因此，根据您的 C_FLAGS，选项“-mfpu=vfp”等同于选项“-mfpu=neon”，Linaro 的区别可能在于选项“-mfloat-abi= softfp”和选项“-mfloat-abi=hard”。

## 根据提供的错误，

此错误发生在许多投诉之后，例如：*.so 使用 VFP 寄存器参数，*obj 没有

* * *

似乎 lib 文件是用“-mfloat-abi=hard”编译的，这是由“使用 VFP 寄存器参数”识别的。

因为如果选项“-mfloat-abi=softfp”用于编译 lib 文件，浮点参数将在 R0-R3 和堆栈空间中传递；
一旦在 VFP 或 NEON 浮点寄存器中传递浮点参数，必须指定选项“-mfloat-abi=hard”。

所以，为了链接那些用“-mfloat-abi=hard”编译的lib文件，你也应该用“-mfloat-abi=hard”编译QT，否则，你会遇到一些类似的抱怨。

此外，来自 gcc-linaro-arm-linux-gnueabihf-2012.06-20120625_win32\gcc-linaro-arm-linux-gnueabihf-2012.06-20120625_win32\share\doc\gcc-linaro-arm-linux-gnueabihf 中的自述文件

## readme中的一些要点如下

目标兼容性

* * *

arm-linux-gnueabihf 版本针对 Ubuntu 12.04“Precise Pangolin”的 Linaro 评估构建 12.05 版本。默认配置是：

*   在所有 Cortex-A 配置文件设备上运行
*   针对 Cortex-A9 进行了调整
*   拇指 2
*   “硬浮动”调用约定
*   使用 VFPv3-D16 FPU
*   启用多架构和多库
*   EGLIBC 2.15
*   GCC 4.7 系列 libgcc 和 libstdc++

* * *

## 使用 softfp 或 hard

两点：
1\. 使用带有“softfp”的float-abi，它向后兼容旧的softfp ABI代码。
2\. 使用“-mfloat-abi=hard”，效率更高，但不向后兼容softfp abi代码。

更多详细信息请参见开头列出的 Cortex-A 系列程序员指南版本：2.0 中的“18.2 VFP support in GCC”和“15.1.1 VFP and NEON register usage”。

谢谢。

# php - Sed 和 PHP 关联数组

> ID：11511997
> 
> 赞同：3
> 
> 时间：2012-07-16T20:27:05.190
> 
> 标签：php, sed, gettext

我有PHP代码：

```
<?php
$vF = array('nazwa' => 'Nazwa', 'telefon' => 'Telefon', 'email' => 'E-mail', 'adres' => 'Adres');
?> 
```

我想用 sed 把它改成这样：

```
<?php
$vF = array('nazwa' => _('Nazwa'), 'telefon' => _('Telefon'), 'email' => _('E-mail'), 'adres' => _('Adres'));
?> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-10T05:13:24.047

和`perl`

```
perl -pe 's/(?<=> )([^,]+)(?=[,;])/_($1)/g' foo.php 
```

### 测试：

```
$ cat foo.php
<?php
$vF = array('nazwa' => 'Nazwa', 'telefon' => 'Telefon', 'email' => 'E-mail', 'adres' => 'Adres');
?>

$ perl -pe 's/(?<=> )([^,]+)(?=[,;])/_($1)/g' foo.php
<?php
$vF = array('nazwa' => _('Nazwa'), 'telefon' => _('Telefon'), 'email' => _('E-mail'), 'adres' => _('Adres'));
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T20:29:57.783

如果这是整个文件，并且采用该特定格式，那么您可以使用以下内容`sed`：

```
sed "s/\\('[^']*'\\)\\([,)]\\)/_(\\1)\\2/g" b.php 
```

否则，请查看[`token_get_all()`](http://php.net/token_get_all)完整的精度解析器。您可以读取您的 PHP 文件，然后使用它`token_get_all()`来找出数组中字符串的确切位置，然后您可以将它们替换为所需的字符串并呈现修改后的源代码。

# mysql - 间歇性慢 ActiveRecord / MySQL 查询

> ID：11511999
> 
> 赞同：0
> 
> 时间：2012-07-16T20:27:11.687
> 
> 标签：mysql, ruby-on-rails, activerecord

希望这里有人可以给我一些指示。我们有一个 Rails 应用程序，跨 5 个 ruby​​ 实例水平扩展，指向一个 MySQL 数据库。我们对此应用程序发出的 POST 请求通常在 600 毫秒范围内返回。但是，有时这些请求会运行很长时间，例如 50 多秒。ruby 代码中似乎没有发生任何不寻常的事情。这是否意味着我们需要扩展我们的 MySQL 实例？据我所知，我们并没有那么努力，当然不是每秒 20k+ 请求，我认为这是它可以处理的。将不胜感激任何关于从哪里开始寻找的指针。我们也开始使用 NewRelic 分析我们的应用程序。

```
Started POST "/api/something" for *** at 2012-07-16 19:00:19 +0000
  Processing by SomethingController#create as JSON
  Parameters: {}
Completed 200 OK in 59542ms (Views: 1.8ms | ActiveRecord: 59265.2ms) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T23:20:20.453

1.) 查看在`params`应用程序生成 59 秒数据库查询之前发送的哈希。将其与其他参数进行比较，并寻找可能导致麻烦的差异。

2.) 从记录服务器处理的所有查询`mysqld`的`--log=/path/to/log.log`选项开始，并查看需要这么长时间的查询。

3.) 检查是否所有外键都有索引。默认情况下，Rails 不会为外键列添加索引。这是一些 Rails 开发人员忽略的普遍问题。当您有一些没有索引的外键时，通过迁移为它们添加索引。