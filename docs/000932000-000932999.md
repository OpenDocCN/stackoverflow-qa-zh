# StackOverflow 问答 000932000-000932999

# sql - 如何在 SQL 中获得一年内数值字段的最大每日值

> ID：932001
> 
> 赞同：0
> 
> 时间：2009-05-31T12:53:55.973
> 
> 标签：sql, sql-server

如何在 MS-SQL 中获得一年内数值字段的最大每日值

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T12:58:06.167

这将查询 2008 年的每日最大值：

```
select 
    datepart(dayofyear,datecolumn)
,   max(value)
from yourtable
where '2008-01-01' <= datecolumn and datecolumn < '2009-01-01'
group by datepart(dayofyear,datecolumn) 
```

或每年的每日最大值：

```
select 
    datepart(year,datecolumn), 
,   datepart(dayofyear,datecolumn)
,   max(value)
from yourtable
group by datepart(year,datecolumn), datepart(dayofyear,datecolumn) 
```

或一年中价值最高的日子：

```
select 
    Year = datepart(year,datecolumn),
,   DayOfYear = datepart(dayofyear,datecolumn)
,   MaxValue = max(MaxValue)
from yourtable
inner join (
    select 
        Year = datepart(year,datecolumn), 
    ,   MaxValue = max(value)
    from yourtable
    group by datepart(year,datecolumn)
) sub on 
    sub.Year = yourtable.datepart(year,datecolumn)
    and sub.MaxValue = yourtable.value
group by 
    datepart(year,datecolumn),
    datepart(dayofyear,datecolumn) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T12:59:16.570

您没有提到您使用的是哪种 RDBMS 或 SQL 方言。以下将适用于 T-SQL (MS SQL Server)。它可能需要对其他方言进行一些修改，因为日期函数往往会在它们之间发生很大变化。

```
SELECT
     DATEPART(dy,  my_date),
     MAX(my_number)
FROM
     My_Table
WHERE
     my_date >= '2008-01-01' AND
     my_date < '2009-01-01'
GROUP BY
     DATEPART(dy, my_date) 
```

DAY 函数可以是任何函数或函数组合，它以您希望获得的格式为您提供日期。

此外，如果有几天根本没有行，那么它们将不会被返回。如果您还需要这些日子以及 NULL 或前一天的最高值，则需要稍微更改查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T12:58:34.747

就像是

```
SELECT dateadd(dd,0, datediff(dd,0,datetime)) as day, MAX(value) 
FROM table GROUP BY dateadd(dd,0, datediff(dd,0,datetime)) WHERE 
datetime < '2009-01-01' AND datetime > '2007-12-31' 
```

假设 datetime 是您的日期列， dateadd(dd,0, datediff(dd,0,datetime)) 将仅提取日期部分，然后您可以按该值分组以获得最大每日值。不过，可能有一种更漂亮的方法可以只获取日期部分。

您还可以使用 between 构造来避免小于和大于。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T12:59:24.837

按日期分组，使用`max`委托获取每个日期的最高值，按值排序，得到第一条记录。

例子：

```
select top 1 theDate, max(theValue)
from TheTable
group by theDate
order by max(theValue) desc 
```

（日期字段只需要包含此分组工作的日期，即时间部分必须为零。）

如果您需要限制特定年份的查询，请在子句中使用开始和结束日期`where`：

```
select top 1 theDate, max(theValue)
from TheTable
where theDate between '2008-01-01' and '2008-12-13'
group by theDate
order by max(theValue) desc 
```

# iphone - 应该在哪里托管视频以流式传输 iphone 应用程序

> ID：932015
> 
> 赞同：1
> 
> 时间：2009-05-31T13:00:28.097
> 
> 标签：iphone, video

寻找一种不在 iphone 应用程序中使用公共托管视频的方法。Youtube 或 Vimeo 似乎是免费托管视频的明显选择，但公共性质令人沮丧。想对视频内容收费，所以让所有人免费就达不到目的了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T13:14:50.237

您可能需要一个**CDN、内容分发/交付网络**，然后编写一个授权访问该内容的前端应用程序。

[http://en.wikipedia.org/wiki/Content_delivery_network](http://en.wikipedia.org/wiki/Content_delivery_network)

Level3，AT&T 都有某种产品。有些比其他的更有活力。

**祝你好运**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T13:15:44.540

获得某种具有足够带宽和存储空间的付费托管将是自然的选择。

# visual-studio - 寻找可以通过代码控制的 Visual Studio 2008 集成差异

> ID：932016
> 
> 赞同：1
> 
> 时间：2009-05-31T13:00:53.743
> 
> 标签：visual-studio, sharepoint, diff

我正在开发一个显示来自 SharePoint 的文件的 Visual Studio 2008 加载项。可以从 Visual Studio 中编辑 SharePint 中的文件，我想说明当前文档与保存在 ShaerPoint 中的版本与 SharePoint 中最后发布的版本之间的差异。

过去有 Super Diff，但 Visual Studio 2008 仍然支持它吗？是否可以从代码中控制它？还有其他工具吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T14:24:58.363

如果您正在寻找免费的，可以使用 SourceGear 的[DiffMerge](http://www.sourcegear.com/diffmerge/)。

这篇非常有用的[文章](http://blogs.msdn.com/jmanning/articles/535573.aspx)描述了您可以合并到 Visual Studio 中的许多差异工具的命令行值。

本文介绍[了更改 Visual Studio 使用的 diff/merge 程序](http://whyiamright.wordpress.com/2008/01/18/changing-the-diffmerge-program-used-by-visual-studio/)。它针对 BeyondCompare（商业），但任何差异工具都可以遵循这些步骤（使用上一个链接中的参数）。

还有[WinMerge](http://winmerge.org/)。

编辑：刚刚注意到您希望能够从代码中进行控制。这两个工具都有一个命令行界面。

# html - 在 CSS 中使用 .Class 或 #ElementId 有什么区别？

> ID：932020
> 
> 赞同：0
> 
> 时间：2009-05-31T13:04:17.870
> 
> 标签：html, css

我一直在想……在 CSS 中，创建样式类和将其应用为元素，或使用#elementId 表示法创建样式（除了能够将类分配给不同的元素）之间有什么区别吗？

例如...

```
#div1
{
 background-color: Yellow;
}

<div id="div1">
    Hello world!
</div> 
```

或者

```
.div1
{
 background-color: Yellow;
}

<div class="div1">
    Hello world!
</div> 
```

谢谢！**:)**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T13:07:51.343

[ID](http://www.w3.org/TR/html401/struct/global.html#adef-id)在文档中必须是唯一的。[类](http://www.w3.org/TR/html401/struct/global.html#adef-class)可以以任意数量和组合使用。所以你可以在多个元素上使用一个类，在一个元素上使用多个类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T13:10:30.323

另一个区别；id-selector 比 class-selector 更具体，所以我相信它们会“胜过”任何其他存在的选择器。您可以使用“重要”来做同样的事情，但 id 选择器可能更容易。

但应谨慎使用 id-selectors...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T13:07:35.460

许多类可以包括给定的“类”，而给定的 ID 只能标识一个元素。如果您需要找到唯一的元素使用 ID，否则如果您希望标记许多基本相同但位于 html 中不同位置的元素，请使用“类”。

您有点回答了自己的问题，它们只是“识别”元素的机制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T13:07:58.423

使用 #elementID 仅适用于由该 id 唯一标识的元素。一个类可以被多个元素使用

但是有一个优先顺序。使用 id 的选择器比使用类的选择器具有更大的权重，当发生冲突时，#id 选择器将优先

编辑：有关选择器优先级的更多详细信息，请参见[http://kiribao.blogspot.com/2008/03/css-selectors-precedence-and-ways-to.html](http://kiribao.blogspot.com/2008/03/css-selectors-precedence-and-ways-to.html)

[编辑：另请参阅http://www.w3.org/TR/CSS21/cascade.html#specificity](http://www.w3.org/TR/CSS21/cascade.html#specificity)上的 w3c 规范

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T13:08:20.420

性能或功能方面，没有区别[需要引用]。

唯一真正的区别是语义，如果您正在处理具有唯一 ID 的单个节点，或者如果您需要标记多个节点的可重用类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T13:24:35.270

有一些区别：

### 独特性

ID 必须是唯一的，类可以重复。如果您查看它们的预期用法，这是合乎逻辑的。

### 用法

ID 应该用于表示网站的大部分内容（例如 #header），或通过 Javascript 访问的唯一元素（例如 #killSession）

类应该用于可重用的部分。

### 特异性

ID 被分配了 100 的特异性值，而类只值 1。

所以这个规则：

```
#id .class 
```

价值101分。

这条规则：

```
#id #id2 
```

价值 200 分，并且总是胜过 #id .class 规则（无论源顺序如何）。

### 表现

性能方面，通过 ID 获取元素总是比类更快，尤其是在使用 Javascript 时。我很乐意看到有人为此添加一些冷硬的数字。

### 讨论

*   可以在[Shaun Inman 的博客](http://www.shauninman.com/archive/2008/05/05/css_qualified_selectors#comment_3942)中找到关于选择器性能的有趣讨论。
*   Jeff Croft[将 OOP 概念应用于 CSS中讨论了类的使用](http://jeffcroft.com/blog/2009/may/20/applying-oop-concepts-css/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T13:19:56.187

类将共享相似功能（用于脚本）和/或布局（用于样式）的元素组合在一起。ID 应该始终是元素的唯一标识符。

应该有 ID 的一个很好的例子是文档的内容区域，通常使用 #content ID。类适用于文档中可能出现两次的其他任何内容，例如应该具有特殊标记或行为的标题，或者应该打开灯箱而不是正常的“转到 URL”行为的链接。

HTH。

# c# - 将代码注入本机进程

> ID：932022
> 
> 赞同：1
> 
> 时间：2009-05-31T13:05:18.837
> 
> 标签：c#, code-injection

您好，我在使用 C# 代码注入进程时遇到了麻烦。我正在使用 Mike Stall 的 CreateRemoteThread 方法。但是，在尝试注入进程时，我得到了 Last Win32 Error 1008。

（顺便说一句。我尝试注入 DLL（它运行我的代码）但我没有成功。我会发布代码链接，但我不能）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T13:24:15.177

这绝不是一项简单的任务，而且涉及的不仅仅是一点 Win32 API 黑客技术。

事实上，我确实在前一段时间确实尝试过这一点，并且花了很多时间处理 API 调用/参数编组才能让它工作——尽管我最终让它变得相当稳定。[您可以在我的Windows SSH Server](https://launchpad.net/windows-ssh-server)项目（特别是`ConsoleDotNet`Visual Studio 项目）的存储库中找到我编写的代码。本机 C++ DLL 的代码也应完整包含在内。

我相信您应该能够逐字重用大部分代码（或只需进行少量修改）。如果我没记错的话，它也应该得到相当好的评论。不过，如果您在理解它时有任何困难，请告诉我。祝你好运！

# asp.net - MVC App 在 IIS 7 中工作，在 Cassini 中不工作（IIS 7 也一样）

> ID：932031
> 
> 赞同：1
> 
> 时间：2009-05-31T13:08:45.507
> 
> 标签：asp.net, asp.net-mvc, iis-7, cassini

我有一个混合应用程序（asp.net webforms，后来添加了 mvc），它在 vista 上的 iis 7 中运行，但不能在同一个盒子上的 cassini 上运行，并且在 webroot 中具有完全相同的文件。实际上，网络表单按预期工作，但所有 mvc 路由都是 404。我该怎么做才能诊断这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T13:30:57.113

首先尝试使用 Phil 的 Haack 路由调试器。你可以在那里找到它：http: [//haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T13:26:25.143

你的项目结构是什么？

我记得有一个由几个不同的 Web 表单应用程序组成的解决方案——当我在 Cassini 中运行该解决方案时，每个应用程序都在不同的端口中打开。是否可能是这样，当您在 Cassini 上进行测试时，您单击了在一个端口上浏览的 Web 表单应用程序中的一个 url，而 MVC 应用程序却找不到，因为它在另一个端口上运行？

# .net - 如何获取现有 .NET 线程的堆栈大小

> ID：932037
> 
> 赞同：2
> 
> 时间：2009-05-31T13:14:58.053
> 
> 标签：.net, multithreading, stack

我想找出 CLR 4.0 中 .NET 线程池线程的堆栈大小。有任何想法吗？

缺口

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T17:33:39.097

在 SO 上查看类似的问题[。](https://stackoverflow.com/questions/53827/checking-available-stack-size-in-c)看起来并不乐观。此外，请参阅MS 专家关于此问题的[此链接](http://www.eggheadcafe.com/conversation.aspx?messageid=29909854&threadid=29909843)。

[这也是我在](http://www.experts-exchange.com/Programming/System/Windows__Programming/Q_10014490.html)汇编程序中找到的未经测试的参考：

* * *

```
// OK, let's go assembly:

DWORD dwStackSize; //size of current thread's stack
_asm {
     mov eax,fs:[4]
     sub eax,fs:[8]
     mov dwStackSize,eax
}

// Don't know how to do this on non-intel CPU's. 
```

* * *

祝你好运。此外，一定要问自己，你在做什么真正需要这些信息，以及是否没有其他解决方案可以解决你的问题。

# c# - 在 DataGridView 中触发复选框值更改事件

> ID：932040
> 
> 赞同：33
> 
> 时间：2009-05-31T13:16:36.910
> 
> 标签：c#, winforms, events, datagridview, checkbox

我有一个带有复选框列的网格视图，并且我想在切换单元格的值后立即触发绘图事件。我尝试了 ValueChaged 和 CellEndEdit 和 BeginEdit，并选择了选择模式为 CellSelect。至于前两个事件，该事件是在编辑模式结束时触发的，比如移出当前单元格，或者来回移动。这只是一种奇怪的行为。

一旦单元格值更改，是否有任何东西会触发网格视图上的事件？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2011-02-09T23:49:46.843

我使用 CellContentClick 事件，它确保用户单击了复选框。即使用户留在同一个单元格中，它也会触发多次。一个问题是 Value 没有得到更新，并且对于未选中总是返回“false”。诀窍是使用单元格的 .EditedFormattedValue 属性而不是 Value 属性。EditedFormattedValue 将使用复选标记进行跟踪，并且当 CellContentClick 被触发时，它是人们希望 Value 包含在其中的内容。

不需要计时器，不需要任何花哨的东西，只需使用 CellContentClick 事件并检查 EditedFormattedValue 来判断复选框正在进入/刚刚进入的状态。如果 EditedFormattedValue = true，则选中该复选框。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-01-14T10:01:29.707

我的一位同事建议捕获 CurrentCellDirtyStateChanged 事件。请参阅[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentcelldirtystatechanged.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.currentcelldirtystatechanged.aspx)。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2011-03-22T01:21:02.237

另一种方法是处理 CellContentClick 事件（它不会为您提供单元格的 Value 属性中的当前值），调用 grid.CommitEdit(DataGridViewDataErrorContexts.Commit) 来更新值，这反过来将触发 CellValueChanged ，然后您可以获得实际（即正确）DataGridViewCheckBoxColumn 值。

```
private void grid_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
   grid.CommitEdit(DataGridViewDataErrorContexts.Commit);
}

private void grid_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    // do something with grid.Rows[e.RowIndex].Cells[e.ColumnIndex].Value
} 
```

目标 .NET 框架：2.0

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-31T13:36:24.670

尝试挂钩 CellContentClick 事件。DataGridViewCellEventArgs 将有一个 ColumnIndex 和一个 RowIndex，因此您可以知道是否确实单击了 ChecboxCell。这个事件的好处是它只会在实际的复选框本身被点击时触发。如果单击复选框周围单元格的白色区域，它将不会触发。这样，您几乎可以保证在此事件触发时复选框值已更改。然后，您可以调用 Invalidate() 来触发绘图事件，如果需要，还可以调用 EndEdit() 来触发行编辑的结束。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-02T13:15:25.940

我终于以这种方式实现了

```
 private void dataGridView1_CellMouseClick(object sender, DataGridViewCellMouseEventArgs e)
    {

        if (e.ColumnIndex >= 0 && e.RowIndex >= 0)
        {
            if (dataGridView1[e.ColumnIndex, e.RowIndex].GetContentBounds(e.RowIndex).Contains(e.Location))
            {
                cellEndEditTimer.Start();
            }
        }

    }

    private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
    { /*place your code here*/}

    private void cellEndEditTimer_Tick(object sender, EventArgs e)
    {
        dataGridView1.EndEdit();
        cellEndEditTimer.Stop();
    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-01-20T02:48:19.900

我有同样的问题，但想出了一个不同的解决方案：

如果您将列或整个网格设置为“只读”，那么当用户单击复选框时，它不会更改值。

幸运的是，该`DataGridView.CellClick`事件仍然被触发。就我而言，我在`cellClick`事件中执行以下操作：

```
if (jM_jobTasksDataGridView.Columns[e.ColumnIndex].CellType.Name == "DataGridViewCheckBoxCell") 
```

但是，如果您有多个复选框列，则可以检查列名。

然后我自己进行数据集的所有修改/保存。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-05T16:23:37.603

小更新..确保您使用`EditedFormattedValue`而不是`value`像我尝试的那样，`value`但它永远不会给出正确的状态，大多数网站仍在使用`value`，但在最新的*c# 2010 express*中使用的是一种访问方式..

```
grdJobDetails.Rows[e.RowIndex].Cells[0].EditedFormattedValue 
```

少数人建议或使用的事件也必须在某些情况下可用，但如果您正在寻找每个单元格`_CellValueChanged`的检查/取消选中，请确保您`_CellContentClick`根据我的通知使用 else`_CellValueChanged`一遍又一遍地它不会触发`_CellValueChanged`，但是如果您交替单击，例如，您有两个复选框并在其他`_CellValueChanged`事件被触发后单击一个，但通常如果每次都在任何单元格被选中/取消选中时寻找触发事件，`_CellValueChanged`则不会触发。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-07-14T09:50:19.960

“EditingControlShowing”事件不会在复选框值更改时触发。因为复选框单元格的显示样式不会改变。

我使用的解决方法如下。（我使用了 CellContentClick 事件）

```
 private void gGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {
        if (string.Compare(gGridView1.CurrentCell.OwningColumn.Name, "CheckBoxColumn") == 0)
        {
            bool checkBoxStatus = Convert.ToBoolean(gGridView1.CurrentCell.EditedFormattedValue);
            //checkBoxStatus gives you whether checkbox cell value of selected row for the
            //"CheckBoxColumn" column value is checked or not. 
            if(checkBoxStatus)
            {
                //write your code
            }
            else
            {
               //write your code
            }
        }
    } 
```

以上对我有用。如果需要更多帮助，请告诉我。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-06-19T18:30:36.973

我找到了一个简单的解决方案。

单击单元格后只需更改单元格焦点。

```
private void DGV_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
    if (e.ColumnIndex == "Here checkbox column id or name") {
        DGV.Item(e.ColumnIndex, e.RowIndex + 1).Selected = true;
        //Here your code

    }
} 
```

不要忘记检查 (ckeckbox + 1) 索引的列是否存在。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-26T19:16:22.447

每个`CellClick`和`CellMouseClick`答案都是错误的，因为您可以使用键盘更改单元格的值，并且不会触发事件。此外，`CurrentCellDirtyStateChanged`仅触发一次，这意味着如果您多次选中/取消选中同一个框，您将只会得到一个事件。结合上面的几个答案给出了以下简单的解决方案：

```
private void dgvList_CurrentCellDirtyStateChanged(object sender, EventArgs e)
{
    if (dgvList.CurrentCell is DataGridViewCheckBoxCell)
        dgvList.CommitEdit(DataGridViewDataErrorContexts.Commit);
}

private void dgvList_CellValueChanged(object sender, DataGridViewCellEventArgs e)
{
    // Now this will fire immediately when a check box cell is changed,
    // regardless of whether the user uses the mouse, keyboard, or touchscreen.
    //
    // Value property is up to date, you DO NOT need EditedFormattedValue here.
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-02-15T05:23:20.050

**cellEndEditTimer.Start();**

此行使 datagridview 更新复选框列表

谢谢你。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-11-02T22:52:35.210

我发现前两个答案的组合给了我我需要的东西。我使用了 CurrentCellDirtyStateChanged 事件并检查了 EditedFormattedValue。

```
private void dgv_CurrentCellDirtyStateChanged(object sender, EventArgs e)
{
   DataGridView dgv = (DataGridView)sender;
   DataGridViewCell cell = dgv.CurrentCell;
   if (cell.RowIndex >= 0 && cell.ColumnIndex == 3) // My checkbox column
     {
        // If checkbox checked, copy value from col 1 to col 2
        if (dgv.Rows[cell.RowIndex].Cells[cell.ColumnIndex].EditedFormattedValue != null && dgv.Rows[cell.RowIndex].Cells[cell.ColumnIndex].EditedFormattedValue.Equals(true))
        {
           dgv.Rows[cell.RowIndex].Cells[1].Value = dgv.Rows[cell.RowIndex].Cells[2].Value;
        }
     }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-02-28T10:44:56.047

当您想`checkedChanged`在 DataGrid 视图中使用事件时，请使用此代码：

```
private void grdBill_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
    grdBill.CurrentCell =  grdBill.Rows[grdBill.CurrentRow.Index].Cells["gBillNumber"];
}

private void grdBill_CellEndEdit(object sender, DataGridViewCellEventArgs e)
{
    calcBill();
}

private void calcBill()
{
    listBox1.Items.Clear();
    for (int i = 0; i < grdBill.Rows.Count - 1; i++)
    {
        if (Convert.ToBoolean(grdBill.Rows[i].Cells["gCheck"].Value) == true)
        {
            listBox1.Items.Add(grdBill.Rows[i].Cells["gBillNumber"].Value.ToString());
        }
    }
} 
```

在这里，`grdBill = DataGridView1, gCheck = CheckBox in GridView(First Column), gBillNumber = TextBox`在网格（第二列）中。

因此，当我们想为每次点击触发 checkchanged 事件时，首先执行 CellContentClick，当用户单击文本框时它会触发，然后它将当前单元格移动到下一列，因此 CellEndEdit 列会触发，它会检查是否选中复选框并在列表框中添加“gBillNumber”（在函数 calcBill 中）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-12-12T09:26:36.290

使用未绑定的控件（即我以编程方式管理内容），没有 EndEdit() 它只调用 CurrentCellDirtyStateChanged 一次，然后再也不会；但是我发现使用 EndEdit() CurrentCellDirtyStateChanged 被调用了两次（第二次可能是由 EndEdit() 引起的，但我没有检查），所以我做了以下操作，这对我来说效果最好：

```
 bool myGridView_DoCheck = false;
    private void myGridView_CurrentCellDirtyStateChanged(object sender, EventArgs e)
    {
        if (!myGridView_DoCheck)
        {
            myGridView_DoCheck = true;
            myGridView.EndEdit();
            // do something here
        }
        else
            myGridView_DoCheck = false;
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-07T02:44:49.353

**使用*.EditedFormattedValue*属性可以解决问题**

要在每次单击单元格中的复选框切换值时收到通知，您可以使用*CellContentClick*事件并访问初始单元格值*.EditedFormattedValue*。

当事件被触发时，*.EditedFormattedValue*尚未在视觉上应用于复选框，也尚未提交给 .Value 属性。

```
private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
   var checkbox = dataGridView1.CurrentCell as DataGridViewCheckBoxCell;

   bool isChecked = (bool)checkbox.EditedFormattedValue;

} 
```

该事件在每次单击时触发，并且*.EditedFormattedValue*切换

# winforms - 如何使用 GDI(+) 在内存中渲染渐变

> ID：932041
> 
> 赞同：1
> 
> 时间：2009-05-31T13:16:53.557
> 
> 标签：winforms, graphics, gdi+, gdi

我正在尝试在内存中渲染一个尺寸为 1x16 的 Image 对象。此图像用作平铺背景。渐变本身应该以非线性方式具有 3 种颜色。

像素 1 到 6：渐变颜色 1 到颜色 2

像素 7 到 16：渐变颜色 3 到颜色 4

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:33:27.320

我刚刚发现自己该怎么做。我期待这样的答案：

```
 Bitmap bmp = new Bitmap(1, 16);
        Graphics g = Graphics.FromImage(bmp);

        System.Drawing.Drawing2D.LinearGradientBrush b1 =
            new System.Drawing.Drawing2D.LinearGradientBrush(
                new Rectangle(0, 0, 1, 6),
                Color1,
                Color2,
                System.Drawing.Drawing2D.LinearGradientMode.Vertical);

        System.Drawing.Drawing2D.LinearGradientBrush b2 =
            new System.Drawing.Drawing2D.LinearGradientBrush(
                new Rectangle(0, 7, 1, 16),
                Color3,
                Color4,
                System.Drawing.Drawing2D.LinearGradientMode.Vertical);

        g.FillRectangle(b1, new Rectangle(0, 0, 1, 6));
        g.FillRectangle(b2, new Rectangle(0, 7, 1, 16));
        g.Dispose(); 
```

位图 bmp 现在具有 2 渐变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T13:24:20.763

您可以使用[GradientFill](http://msdn.microsoft.com/en-us/library/dd144957(VS.85).aspx)函数。

对于自定义解决方案，请查看[本文](http://msdn.microsoft.com/en-us/library/ms229655.aspx)是否可以提供帮助。

# java - 为什么小程序不需要 main()？

> ID：932052
> 
> 赞同：11
> 
> 时间：2009-05-31T13:27:55.327
> 
> 标签：java, applet, main

这适用于 Applet、Servlet、Midlet 等的子类。

为什么他们不需要一个`main()`？如果我想创建一个`Craplet`以或类似的方式开始的类，`init()`它的设计是否糟糕，或者我将如何去做？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-31T13:37:38.303

它实际上是一个很好的设计，但并不明显，你想做的事情不会有任何效果，所以它有点违反直觉。

这些类型的应用程序生活在容器中，因此它们的入口点由这些容器必须遵守的标准决定。这些标准的设计者选择不将入口点称为 main。您可以将您的功能放在一个被覆盖的方法中。所有小程序都有以下四种方法：

```
public void init();
public void start();
public void stop();
public void destroy(); 
```

他们有这些方法是因为他们的超类`java.applet.Applet`, 有这些方法。

超类在这些中除了虚拟代码之外什么都没有：

```
public void init() {} 
```

如果你想派生一个类来扩展或改变你的名字，`init()`你应该实现你的类并调用你的方法`init()`。这将使用多态性让您可以随意调用该方法。除非您正在编写 servlet 容器，否则您可能会浪费时间。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-31T13:34:56.717

Applet 和 Servlet 不会启动它们自己的进程。相反，它们在容器内运行。因此，它们不需要静态的 main 方法（启动进程），而是一种与容器交互的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T13:37:47.337

'main' 只是 C、C++ 和 java 通常支持的约定，但例如，如果您直接针对 Win32 API 编写 C 或 C++，则不必使用 main()，而是使用 WinMain。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T13:36:13.703

小程序的执行环境（通常是您的 Web 浏览器）根据所达到的渲染阶段在不同的点调用小程序方法。`main()`这提供了比简单方法更适合 Web 的抽象级别。此外，使用方法启动任意 Java 程序`main()`通常会被认为存在安全风险。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-17T12:42:52.287

Applet 不使用 main()，因为当 applet 加载时，它会自动调用 applet 类的某些方法来启动并执行 applet 代码。而且applet有自己的生命周期。

# c# - ASP .NET c#远程检索总非分页内存使用情况

> ID：932060
> 
> 赞同：1
> 
> 时间：2009-05-31T13:36:35.230
> 
> 标签：c#, asp.net, memory

我正在开发一个简单的 ASP .NET 健康检查器，但遇到了一些障碍。

1）我需要能够从远程机器（在同一网络上）获取完整的非分页内存使用情况。我尝试过使用 System.Diganostics.Process.NonpagedSystemMemorySize64 但是我开始意识到内核的非分页使用量将从该总数中丢失。这是我正在做的一个快速示例：

```
Process[] myprocess = Process.GetProcesses("computername");

foreach (Process p in myprocess)
{
nonpaged += p.NonpagedSystemMemorySize64;
} 
```

2）我可以通过使用 System.Diagnostics.PerformanceCounter 在本地克服这个问题，但是您只能在本地访问该类的 API。还有其他适合我需要的课程吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T15:51:53.850

我之前用来获取机器诊断的一种解决方案是使用 DLLImport。

[参见 P-Invoke](http://www.pinvoke.net/default.aspx/kernel32.GlobalMemoryStatus)

希望这可以帮助

皮特

回答您的评论

使用 DLL 导入时，您必须自己声明函数包装器。在下面的代码中，您可以看到 public static extern void 告诉编译器这是对位于 DLLImported kernel32.dll 中的名为 GlobalMemoryStatus 的函数的外部调用。作为函数输出参数的 MemoryStatus 结构填充在 kernel32 dll 中，并返回完全填充的内容。

将其复制到您的代码中并阅读它们应该可以帮助您理解它的注释。

```
/// <summary>
        /// Populates a memory status struct with the machines current memory status.
        /// </summary>
        /// <param name="stat">The status struct to be populated.</param>
        [DllImport("kernel32.dll")]
        public static extern void GlobalMemoryStatus(out MemoryStatus stat);

        /// <summary>
        /// The memory status struct is populated by the GlobalMemoryStatus external dll call to Kernal32.dll.
        /// </summary>
        public struct MemoryStatus
        {
            public uint Length;
            public uint MemoryLoad;
            public uint TotalPhysical;
            public uint AvailablePhysical;
            public uint TotalPageFile;
            public uint AvailablePageFile;
            public uint TotalVirtual;
            public uint AvailableVirtual;
        } 

// copy the guts of this method and add it to your own method.
public void InspectMemoryStatus()
{

MemoryStatus status = new MemoryStatus();
            GlobalMemoryStatus(out status);

    Debug.WriteLine(status.TotalVirtual);
} 
```

这应该允许您获得机器的内存诊断。

# c# - Linq to SQL 奇怪的缓存？

> ID：932065
> 
> 赞同：2
> 
> 时间：2009-05-31T13:39:37.377
> 
> 标签：c#, linq, linq-to-sql

我有一个奇怪的（如果我错了，请纠正我）Linq to SQL 的错误/功能，这让我感到困惑并试图了解正在发生的事情。

所以我在程序上完成了整个过程，希望能找到一个解决方案，但到目前为止一直无法解决。

这是正在发生的事情的再现：

1.  记录对数据库表“ETTickets”所做的更改。将“可用性”列从 9 更改为 8（见下文） [对数据库所做的更改 http://www.composeandshoot.com/soverflow/changemadetodb.jpg](http://www.composeandshoot.com/soverflow/changemadetodb.jpg)

2.  刷新页面，其中有一个 ASP 转发器数据绑定到 ETickets 表。这仍然显示“9”。

3.  查看有关数据绑定的 quickwatch 以查看从数据库返回的值（见下文）： [quickwatch http://www.composeandshoot.com/soverflow/linqtosqlquickwatch.jpg](http://www.composeandshoot.com/soverflow/linqtosqlquickwatch.jpg)

4.  因此，我随后查看了 SQL 服务器上运行的查询。启动 SQL Server Profiler 并得到以下结果（见下文）： [SQL profiler http://www.composeandshoot.com/soverflow/linqquery.jpg](http://www.composeandshoot.com/soverflow/linqquery.jpg)

5.  运行查询

    exec sp_executesql N'SELECT [t0].[id], [t0].[eventid], [t0].[availability], [t0].[cost] FROM [dbo].[ETickets] AS [t0] WHERE [ t0].[id] = @p0',N'@p0 唯一标识符',@p0='2642C0EF-C0C5-4881-9AC8-53C023B444D2'

6.  SQL Server 返回“8”作为可用性！然而数据绑定仍然显示“9”。我没有启用任何 SQL 缓存依赖项。

请有人可以在这里指出我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T13:42:24.550

数据上下文的生命周期是什么？它是*相同*的数据上下文，还是每次都是新的？（应该是后者）。

如果您重新使用数据上下文，则当它看起来相同时，它必须始终将**相同的对象返回给您。**因此，如果它以前为您提供了 9 的版本，即使基础数据发生更改，它也会继续为您提供该参考。

目前，这仍然是往返；为避免往返，您需要使用：

```
var obj = ctx.SomeTable.Single(x=>x.Id == id); 
```

即，如果它已经在本地身份缓存中拥有该对象`Id == id`，则它根本不会执行数据库查询。

任何其他构造都将进行往返。4.0 中有一个[修复程序，](http://marcgravell.blogspot.com/2009/02/linq-to-sql-not-quite-dead-yet.html)这样`.Where(x=>x.Id == id).Single()`可以避免往返，这应该具有查询语法，即

```
var obj = (from x in ctx.SomeTable
           where x.Id == id
           select x).Single(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T15:44:26.147

您是否正在使用一个 DataContenxt 进行更新，而您后来查询的那个仍然存在？

如果是，这是您应该期待的回应。

如果您在更新之后创建了一个新的 DataContenxt，或者更新和读取是在同一个 DataContext 上完成的，那么您应该得到正确的响应。

# php - 如何使用 Zend Lucene 搜索邮政编码？

> ID：932066
> 
> 赞同：2
> 
> 时间：2009-05-31T13:41:03.570
> 
> 标签：php, zend-framework, symfony1, lucene, zend-search-lucene

我有非常简单的 Zend Lucene 公司索引，使用它来创建索引：

```
// store company primary key to identify it in the search results
$doc->addField(Zend_Search_Lucene_Field::Keyword('pk', $this->getId()));

// index company fields
$doc->addField(Zend_Search_Lucene_Field::Unstored('zipcode', $this->getZipcode(), 'utf-8'));
$doc->addField(Zend_Search_Lucene_Field::Unstored('name', $this->getName(), 'utf-8')); 
```

我可以搜索公司名称，但不能搜索邮政编码。Zend Lucene Search 索引整数有问题吗？如果 s/o 可以阐明谁有经验，请帮助我。我只能想象使用 Lucene 按邮政编码搜索是很常见的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-20T22:57:45.750

我相信 Zend Lucene 的默认文本分析器默认不搜索数字。Zend 附带了几个不同的文本分析器。使用 TextNum 分析器搜索数字和字符。在 zend/search/lucene/analysis/analyzer/common 文件夹中还有一些您可能会发现有用的其他分析器。

您可以使用以下代码更改默认分析器：

```
Zend_Search_Lucene_Analysis_Analyzer::setDefault(
    新 Zend_Search_Lucene_Analysis_Analyzer_Common_TextNum());

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T09:49:26.870

我相信您的问题出在[Analyzer](http://framework.zend.com/manual/en/zend.search.lucene.extending.html#zend.search.lucene.extending.analysis)上。我建议您使用`Zend_Search_Lucene_Field::Keyword`, 而不是`Zend_Search_Lucene_Field::Unstored`邮政编码字段。这样，Lucene 分析器在索引时不会修改邮政编码。Java Lucene 具有可用于调试搜索的[explain() 。](http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/IndexSearcher.html#explain(org.apache.lucene.search.Weight,%20int))您可能需要打印一些中间值来模拟 explain()，看看这是否确实是问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-05T12:47:21.190

例如，如果您正在搜索 123，您将获得 123 和 34123 的所有命中。所以你必须确保你是索引并且你的查询字符串是明确的。

我建议将邮政编码索引为字符串，例如“000123”。之后，您可以使用“000123”在索引上搜索，您将获得正确的结果集，而不是像 34123 这样的结果。您只需将邮政编码转换为“正确”的查询字符串。

# entity-framework - 延迟加载、TDD、数据优先方法：这些杀手锏是实体框架的核心吗？

> ID：932067
> 
> 赞同：2
> 
> 时间：2009-05-31T13:41:40.243
> 
> 标签：entity-framework, tdd

**编辑：伙计们，我的意思是实体框架而不是 ASP.NET MVC，这很可能是一个错字！** 昨天我翻到[这篇文章](http://efvote.wufoo.com/forms/ado-net-entity-framework-vote-of-no-confidence/)，列出了 Entity Framework 的一些坏东西。在做了一些谷歌的东西之后，我发现[了这个](http://msmvps.com/blogs/kathleen/archive/2008/06/24/entity-framework-petition.aspx)基本上是这里的防守者。这两个帖子讨论了实体框架的一些主要问题，例如：

*   EF 不是失败，因为它不适合 TDD 开发
*   EF 不是失败，因为业务逻辑进入部分类
*   EF 并非失败，因为它将数据视为 biz 对象的重要组成部分
*   EF 不是失败，因为它接受大多数人做数据优先开发
*   EF 不是失败，因为延迟加载很难——延迟加载会破坏性能
*   EF 不是失败，因为它的设计工具是 1.0 级别
*   EF 并非失败，因为它在合并到源代码控制方面的策略很差

现在，我在上面的列表中真正关心的问题是 TDD 适应性、延迟加载泄漏和源代码控制问题。

这是我的问题：

1.  如果我使用 EF，我不能对我的应用程序方法进行足够好的单元测试吗？
2.  延迟加载很难是什么意思？EF根本不支持吗？
3.  EF 在合并到源代码控制方面的策略很差是什么意思？不是所有文件都像解决方案中的任何普通文件一样被签入和签出吗？

希望这能清除我在这里想问的问题，并感谢你们的帮助！欣赏它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T13:56:23.023

感谢您从问题中删除错字。现在我也可以让我的答案更短一点:-)

Entity 框架并没有真正支持 TDD / SOLID / Alt.Net 人群喜欢的编程风格。这就是不信任投票的意义所在。EF 迫使您围绕持久性框架设计业务逻辑，从而使测试和维护业务逻辑变得更加困难。积极的一面是，由于围绕实体框架的所有工具，它允许您快速启动并运行对象模型和持久层。

在较新版本的 EF 中，这变得更好了。我不知道 EF 4 是否允许持久性无知对象模型，这是最重要的缺点。但在我看来，这并没有真正改变这样一个事实，即 EF 是为与不信任投票的作者想要的不同的编程风格而构建的。EF 非常依赖工具，并引导您以以数据库为中心的方式构建软件。构建软件的默认方式仍然是创建一个数据库并从中生成您的对象模型。

我认为围绕 EF 的大多数问题都不是关于什么是可能的。您始终可以从业务逻辑中抽象出 EF 部分并构建您的应用程序测试驱动。问题在于哪种编程风格更容易。我认为您应该为正确的工作使用正确的工具。如果您在一个熟悉数据驱动开发风格的团队中构建企业软件，您应该使用 EF。如果您正在构建持久性不如业务逻辑重要的软件，并且您在一个熟悉 TDD DDD、BDD、SOLID 和所有这些东西的团队中工作，那么最好使用 nHibernate 之类的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T19:52:27.873

开发人员对 Entity Framework 1.0 (.NET 3.5 SP1) 有很多不满。EF 4.0 的当前版本（版本 2，之所以这么称呼，是因为它是作为 .NET 4.0 的一部分发布的）解决了大部分此类投诉。如果您是 MSDN 订阅者，您已经可以[下载 EF 4](http://blogs.msdn.com/adonet/archive/2009/05/20/entity-framework-4-0-beta-1-bits-now-available-in-the-vs-2010-and-net-4-beta-1.aspx) Beta 1。

[Entity Framework Design](http://blogs.msdn.com/efdesign/)团队和[ADO.NET 团队博客](http://blogs.msdn.com/adonet/default.aspx)最近发布了一系列文章，讨论了 EF 4.0 中的各种场景支持，其中最大的是 Persistence Ignorance 和 POCO 支持、N-Tier 支持、T4 模板等等. TDD 和 Data/Model/Entities First 也通过上述更改得到支持。延迟加载也在那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T15:58:17.067

关于 EF，事情即将变得更好！:) EF4 指日可待，尽管有些声音仍然在抱怨，但我不明白他们为什么要打扰。EF 终于变得可能不成熟了，它只投入了几年时间，但至少是一个可靠且灵活的框架。

# python - 在 Python 中构建最小的插件架构

> ID：932069
> 
> 赞同：202
> 
> 时间：2009-05-31T13:46:41.670
> 
> 标签：python, architecture, plugins

我有一个用 Python 编写的应用程序，由相当技术性的受众（科学家）使用。

我正在寻找一种让用户可以扩展应用程序的好方法，即脚本/插件架构。

我正在寻找**非常轻量级**的东西。大多数脚本或插件不会由第三方开发和分发并安装，而是由用户在几分钟内完成，以自动执行重复任务，添加对文件格式的支持，等等。所以插件应该具有绝对最小的样板代码，并且除了复制到文件夹之外不需要“安装”（所以像 setuptools 入口点，或者 Zope 插件架构似乎太多了。）

是否有任何类似的系统已经存在，或者任何实施类似方案的项目，我应该寻找想法/灵感？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2009-05-31T13:51:05.453

我的基本上是一个名为“plugins”的目录，主应用程序可以轮询它，然后使用[imp.load_module](https://docs.python.org/library/imp.html#imp.load_module)来获取文件，寻找一个可能带有模块级配置参数的知名入口点，然后从那里开始。我使用文件监控的东西来实现插件处于活动状态的一定量的动态，但这是一个不错的选择。

当然，任何伴随着说“我不需要[大而复杂的东西] X；我只想要一些轻量级的东西”的需求都会冒着一次重新实现一个发现的需求的风险。但这并不是说无论如何你都不能从中获得乐趣:)

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-06-01T01:11:18.790

`module_example.py`：

```
def plugin_main(*args, **kwargs):
    print args, kwargs 
```

`loader.py`：

```
def load_plugin(name):
    mod = __import__("module_%s" % name)
    return mod

def call_plugin(name, *args, **kwargs):
    plugin = load_plugin(name)
    plugin.plugin_main(*args, **kwargs)

call_plugin("example", 1234) 
```

它肯定是“最小的”，它绝对没有错误检查，可能有无数的安全问题，它不是很灵活——但它应该向你展示 Python 中的插件系统是多么简单。

您可能也想研究[imp](http://docs.python.org/library/imp.html)`__import__`模块，尽管您可以使用和`os.listdir`一些字符串操作来做很多事情。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-31T13:54:12.217

查看[现有插件框架/库的概述](http://wehart.blogspot.com/2009/01/python-plugin-frameworks.html)，这是一个很好的起点。我非常喜欢[yapsy](http://yapsy.sourceforge.net/)，但这取决于您的用例。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-05-31T15:54:28.627

虽然这个问题真的很有趣，但我认为如果没有更多细节，这很难回答。这是一个什么样的应用程序？它有图形用户界面吗？它是命令行工具吗？一套脚本？具有唯一入口点的程序等...

鉴于我掌握的信息很少，我将以非常笼统的方式回答。

你必须添加插件是什么意思？

*   您可能必须添加一个配置文件，其中将列出要加载的路径/目录。
*   另一种方式是说“将加载该插件/目录中的任何文件”，但是要求您的用户移动文件很不方便。
*   最后一个中间选项是要求所有插件位于同一个插件/文件夹中，然后使用配置文件中的相对路径激活/停用它们。

在纯代码/设计实践中，您必须清楚地确定您希望用户扩展哪些行为/特定操作。确定将始终被覆盖的公共入口点/一组功能，并确定这些操作中的组。一旦完成，扩展您的应用程序应该很容易，

*使用hooks*的示例，灵感来自 MediaWiki（PHP，但语言真的很重要吗？）：

```
import hooks

# In your core code, on key points, you allow user to run actions:
def compute(...):
    try:
        hooks.runHook(hooks.registered.beforeCompute)
    except hooks.hookException:
        print('Error while executing plugin')

    # [compute main code] ...

    try:
        hooks.runHook(hooks.registered.afterCompute)
    except hooks.hookException:
        print('Error while executing plugin')

# The idea is to insert possibilities for users to extend the behavior 
# where it matters.
# If you need to, pass context parameters to runHook. Remember that
# runHook can be defined as a runHook(*args, **kwargs) function, not
# requiring you to define a common interface for *all* hooks. Quite flexible :)

# --------------------

# And in the plugin code:
# [...] plugin magic
def doStuff():
    # ....
# and register the functionalities in hooks

# doStuff will be called at the end of each core.compute() call
hooks.registered.afterCompute.append(doStuff) 
```

另一个例子，灵感来自 mercurial。在这里，扩展只将命令添加到*hg*命令行可执行文件，扩展行为。

```
def doStuff(ui, repo, *args, **kwargs):
    # when called, a extension function always receives:
    # * an ui object (user interface, prints, warnings, etc)
    # * a repository object (main object from which most operations are doable)
    # * command-line arguments that were not used by the core program

    doMoreMagicStuff()
    obj = maybeCreateSomeObjects()

# each extension defines a commands dictionary in the main extension file
commands = { 'newcommand': doStuff } 
```

对于这两种方法，您可能需要对扩展进行通用*初始化*和*最终确定。*您可以使用所有扩展都必须实现的通用接口（更适合第二种方法；mercurial 使用 reposetup(ui, repo) 为所有扩展调用），或者使用钩子类型的方法，使用hooks.setup 钩子。

但同样，如果您想要更有用的答案，您将不得不缩小您的问题范围；）

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-05-31T18:05:31.367

我是一名退休的生物学家，他处理数字显微图像，发现自己必须编写一个图像处理和分析包（从技术上讲不是一个库）才能在 SGi 机器上运行。我用 C 编写代码并使用 Tcl 作为脚本语言。GUI 是使用 Tk 完成的。Tcl 中出现的命令形式为“extensionName commandName arg0 arg1 ... param0 param1 ...”，即简单的以空格分隔的单词和数字。当 Tcl 看到“extensionName”子字符串时，控制权被传递给了 C 包。这反过来通过词法分析器/解析器（在 lex/yacc 中完成）运行命令，然后根据需要调用 C 例程。

操作包的命令可以通过 GUI 中的一个窗口一一运行，但批处理作业是通过编辑文本文件来完成的，这些文本文件是有效的 Tcl 脚本；您将选择执行您想要执行的文件级操作的模板，然后编辑副本以包含实际目录和文件名以及包命令。它就像一个魅力。直到 ...

1) 世界转向 PC 和 2) 脚本变得超过 500 行，此时 Tcl 的组织能力开始变得真正的不便。时间飞逝 ...

我退休了，Python 被发明出来了，它看起来像是 Tcl 的完美继承者。现在，我从来没有做过移植，因为我从来没有面对过在 PC 上编译（相当大的）C 程序、用 C 包扩展 Python 以及在 Python/Gt?/Tk?/? 中做 GUI 的挑战。 ?. 然而，拥有可编辑模板脚本的旧想法似乎仍然可行。此外，以原生 Python 形式输入包命令不应该是太大的负担，例如：

packageName.command(arg0, arg1, ..., param0, param1, ...)

一些额外的点、括号和逗号，但这些都不是亮点。

我记得看到有人在 Python 中完成了 lex 和 yacc 的版本（尝试：[http](http://www.dabeaz.com/ply/) ://www.dabeaz.com/ply/ ），所以如果仍然需要它们，它们就在身边。

这种漫无边际的意义在于，在我看来，Python 本身就是科学家可以使用的理想“轻量级”前端。我很想知道你为什么认为它不是，我是认真的。

* * *

稍后添加：应用程序*gedit*预计会添加插件，并且他们的网站对我在几分钟内环顾四周发现的简单插件过程有最清晰的解释。尝试：

[https://wiki.gnome.org/Apps/Gedit/PythonPluginHowToOld](https://wiki.gnome.org/Apps/Gedit/PythonPluginHowToOld)

我仍然想更好地理解你的问题。我不清楚您是 1）希望科学家能够以各种方式非常简单地使用您的（Python）应用程序，还是 2）希望允许科学家为您的应用程序添加新功能。选择 #1 是我们面对图像的情况，这导致我们使用我们修改的通用脚本以适应当下的需要。是选择#2 引导你想到插件的想法，还是你的应用程序的某些方面使得向它发出命令变得不切实际？

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-03-14T12:14:17.813

[Marty Allchin 的简单插件框架](http://martyalchin.com/2008/jan/10/simple-plugin-framework/)是我根据自己的需要使用的基础。我真的建议看一下它，如果您想要一些简单且易于破解的东西，我认为这确实是一个好的开始。您也可以将其[作为 Django Snippets](http://www.djangosnippets.org/snippets/542/)找到。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-10-28T13:31:23.733

当我搜索 Python 装饰器时，发现了一个简单但有用的代码片段。它可能不适合您的需求，但非常鼓舞人心。

[Scipy 高级 Python#Plugin 注册系统](http://scipy-lectures.github.io/advanced/advanced_python/#a-plugin-registration-system)

```
class TextProcessor(object):
    PLUGINS = []

    def process(self, text, plugins=()):
        if plugins is ():
            for plugin in self.PLUGINS:
                text = plugin().process(text)
        else:
            for plugin in plugins:
                text = plugin().process(text)
        return text

    @classmethod
    def plugin(cls, plugin):
        cls.PLUGINS.append(plugin)
        return plugin

@TextProcessor.plugin
class CleanMarkdownBolds(object):
    def process(self, text):
        return text.replace('**', '') 
```

# 用法：

```
processor = TextProcessor()
processed = processor.process(text="**foo bar**", plugins=(CleanMarkdownBolds, ))
processed = processor.process(text="**foo bar**") 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-05-31T20:16:38.290

我很喜欢 Andre Roberge 博士在 Pycon 2009 上对不同插件架构的精彩讨论。他很好地概述了实现插件的不同方法，从一些非常简单的东西开始。

它可作为[播客](http://blip.tv/pycon-us-videos-2009-2010-2011/plugins-and-monkeypatching-increasing-flexibility-dealing-with-inflexibility-1958972 "插件和猴子补丁：增加灵活性，处理不灵活")（在猴子修补解释之后的第二部分）附带一系列[六个博客条目](http://aroberge.blogspot.ch/2008/12/plugins-part-1-application.html)。

我建议您在做出决定之前快速听一下。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-10-24T02:23:28.570

我来到这里是为了寻找一个最小的插件架构，并发现了很多对我来说似乎有点矫枉过正的东西。所以，我实现[了 Super Simple Python Plugins](https://github.com/samwyse/sspp)。`__init__.py`要使用它，您需要创建一个或多个目录并在每个目录中放置一个特殊文件。导入这些目录将导致所有其他 Python 文件作为子模块加载，并且它们的名称将被放置在`__all__`列表中。然后由您来验证/初始化/注册这些模块。README 文件中有一个示例。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-08-26T11:46:54.290

实际上*setuptools*使用“插件目录”，如下面的例子取自项目的文档： [http://peak.telecommunity.com/DevCenter/PkgResources#locating-plugins](http://peak.telecommunity.com/DevCenter/PkgResources#locating-plugins)

示例用法：

```
plugin_dirs = ['foo/plugins'] + sys.path
env = Environment(plugin_dirs)
distributions, errors = working_set.find_plugins(env)
map(working_set.add, distributions)  # add plugins+libs to sys.path
print("Couldn't load plugins due to: %s" % errors) 
```

从长远来看，*setuptools*是一个更安全的选择，因为它可以加载插件而不会发生冲突或缺少需求。

另一个好处是插件本身可以使用相同的机制进行扩展，而无需原始应用程序关心它。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-01-29T09:03:27.960

[setuptools 有一个 EntryPoint](http://setuptools.readthedocs.io/en/latest/pkg_resources.html#entry-points)：

> 入口点是发行版“宣传” Python 对象（例如函数或类）以供其他发行版使用的一种简单方法。可扩展应用程序和框架可以搜索具有特定名称或组的入口点，无论是从特定分发版还是从 sys.path 上的所有活动分发版，然后随意检查或加载广告对象。

如果您使用 pip 或 virtualenv，AFAIK 这个包总是可用的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-10-09T15:21:33.140

作为插件系统的另一种方法，您可以查看[Extend Me project](https://pypi.python.org/pypi/extend_me)。

例如，让我们定义简单的类及其扩展

```
# Define base class for extensions (mount point)
class MyCoolClass(Extensible):
    my_attr_1 = 25
    def my_method1(self, arg1):
        print('Hello, %s' % arg1)

# Define extension, which implements some aditional logic
# or modifies existing logic of base class (MyCoolClass)
# Also any extension class maby be placed in any module You like,
# It just needs to be imported at start of app
class MyCoolClassExtension1(MyCoolClass):
    def my_method1(self, arg1):
        super(MyCoolClassExtension1, self).my_method1(arg1.upper())

    def my_method2(self, arg1):
        print("Good by, %s" % arg1) 
```

并尝试使用它：

```
>>> my_cool_obj = MyCoolClass()
>>> print(my_cool_obj.my_attr_1)
25
>>> my_cool_obj.my_method1('World')
Hello, WORLD
>>> my_cool_obj.my_method2('World')
Good by, World 
```

并展示隐藏在幕后的东西：

```
>>> my_cool_obj.__class__.__bases__
[MyCoolClassExtension1, MyCoolClass] 
```

*extend_me*库通过元类操作类创建过程，因此在上面的示例中，当创建新类的实例时，`MyCoolClass`我们得到了新类的实例，它是两者的子类`MyCoolClassExtension`并`MyCoolClass`具有它们的功能，这要归功于 Python 的[多重继承](https://docs.python.org/2/tutorial/classes.html#multiple-inheritance)

为了更好地控制类的创建，这个库中定义了一些元类：

*   `ExtensibleType`- 通过子类化允许简单的可扩展性

*   `ExtensibleByHashType`- 类似于 ExtensibleType，但能够构建类的特殊版本，允许基类的全局扩展和类的特殊版本的扩展

这个库在[OpenERP Proxy Project](https://github.com/katyukha/openerp-proxy)中使用，并且似乎工作得很好！

有关使用的真实示例，请查看[OpenERP 代理 'field_datetime' 扩展](https://github.com/katyukha/openerp-proxy/blob/master/openerp_proxy/ext/field_datetime.py)：

```
from ..orm.record import Record
import datetime

class RecordDateTime(Record):
    """ Provides auto conversion of datetime fields from
        string got from server to comparable datetime objects
    """

    def _get_field(self, ftype, name):
        res = super(RecordDateTime, self)._get_field(ftype, name)
        if res and ftype == 'date':
            return datetime.datetime.strptime(res, '%Y-%m-%d').date()
        elif res and ftype == 'datetime':
            return datetime.datetime.strptime(res, '%Y-%m-%d %H:%M:%S')
        return res 
```

`Record`这是可扩展的对象。`RecordDateTime`是扩展。

要启用扩展，只需导入包含扩展类的模块，并且（在上述情况下）`Record`在它之后创建的所有对象都将在基类中具有扩展类，从而具有其所有功能。

这个库的主要优点是，操作可扩展对象的代码不需要了解扩展，扩展可以改变可扩展对象中的一切。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-04-11T16:19:47.617

扩展@edomaur 的答案，我建议看一下[simple_plugins （无耻插件），这是一个受](https://bitbucket.org/petar/simple_plugins)[Marty Alchin 工作](http://martyalchin.com/2008/jan/10/simple-plugin-framework/)启发的简单插件框架。

基于项目 README 的简短使用示例：

```
# All plugin info
>>> BaseHttpResponse.plugins.keys()
['valid_ids', 'instances_sorted_by_id', 'id_to_class', 'instances',
 'classes', 'class_to_id', 'id_to_instance']

# Plugin info can be accessed using either dict...
>>> BaseHttpResponse.plugins['valid_ids']
set([304, 400, 404, 200, 301])

# ... or object notation
>>> BaseHttpResponse.plugins.valid_ids
set([304, 400, 404, 200, 301])

>>> BaseHttpResponse.plugins.classes
set([<class '__main__.NotFound'>, <class '__main__.OK'>,
     <class '__main__.NotModified'>, <class '__main__.BadRequest'>,
     <class '__main__.MovedPermanently'>])

>>> BaseHttpResponse.plugins.id_to_class[200]
<class '__main__.OK'>

>>> BaseHttpResponse.plugins.id_to_instance[200]
<OK: 200>

>>> BaseHttpResponse.plugins.instances_sorted_by_id
[<OK: 200>, <MovedPermanently: 301>, <NotModified: 304>, <BadRequest: 400>, <NotFound: 404>]

# Coerce the passed value into the right instance
>>> BaseHttpResponse.coerce(200)
<OK: 200> 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-08-17T15:00:30.490

您可以使用[pluginlib](https://pypi.org/project/pluginlib)。

插件很容易创建，并且可以从其他包、文件路径或入口点加载。

创建一个插件父类，定义任何需要的方法：

```
import pluginlib

@pluginlib.Parent('parser')
class Parser(object):

    @pluginlib.abstractmethod
    def parse(self, string):
        pass 
```

通过继承父类创建插件：

```
import json

class JSON(Parser):
    _alias_ = 'json'

    def parse(self, string):
        return json.loads(string) 
```

加载插件：

```
loader = pluginlib.PluginLoader(modules=['sample_plugins'])
plugins = loader.plugins
parser = plugins.parser.json()
print(parser.parse('{"json": "test"}')) 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-05-31T12:10:46.463

当我时不时地在 Python 中搜索插件框架时，我花时间阅读了这个线程。我[用过一些，但它们有缺点](http://lml.readthedocs.io/en/latest/design.html)。这是我在 2017 年为您的审查提出的，一个无界面、松耦合的插件管理系统：[稍后加载](http://lml.readthedocs.io/en/latest/)。以下是有关如何使用它的[教程。](http://lml.readthedocs.io/en/latest/tutorial.html)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-12-04T14:04:45.493

我花了很多时间试图找到适合我需要的 Python 小插件系统。但后来我只是想，如果已经有继承，自然灵活，为什么不使用它。

对插件使用继承的唯一问题是您不知道最具体的（继承树上最低的）插件类是什么。

但这可以通过元类来解决，它跟踪基类的继承，并且可能可以构建类，从大多数特定插件继承（下图中的“根扩展”）

[![在此处输入图像描述](https://i.stack.imgur.com/c9xKg.png)](https://i.stack.imgur.com/c9xKg.png)

所以我通过编写这样一个元类来提供一个解决方案：

```
class PluginBaseMeta(type):
    def __new__(mcls, name, bases, namespace):
        cls = super(PluginBaseMeta, mcls).__new__(mcls, name, bases, namespace)
        if not hasattr(cls, '__pluginextensions__'):  # parent class
            cls.__pluginextensions__ = {cls}  # set reflects lowest plugins
            cls.__pluginroot__ = cls
            cls.__pluginiscachevalid__ = False
        else:  # subclass
            assert not set(namespace) & {'__pluginextensions__',
                                         '__pluginroot__'}     # only in parent
            exts = cls.__pluginextensions__
            exts.difference_update(set(bases))  # remove parents
            exts.add(cls)  # and add current
            cls.__pluginroot__.__pluginiscachevalid__ = False
        return cls

    @property
    def PluginExtended(cls):
        # After PluginExtended creation we'll have only 1 item in set
        # so this is used for caching, mainly not to create same PluginExtended
        if cls.__pluginroot__.__pluginiscachevalid__:
            return next(iter(cls.__pluginextensions__))  # only 1 item in set
        else:
            name = cls.__pluginroot__.__name__ + 'PluginExtended'
            extended = type(name, tuple(cls.__pluginextensions__), {})
            cls.__pluginroot__.__pluginiscachevalid__ = True
return extended 
```

因此，当您拥有 Root 基础、使用元类创建并拥有从它继承的插件树时，您可以自动获取类，该类仅通过子类化从最具体的插件继承：

```
class RootExtended(RootBase.PluginExtended):
    ... your code here ... 
```

代码库非常小（大约 30 行纯代码），并且在继承允许的情况下非常灵活。

如果您有兴趣，请参与@ [https://github.com/thodnev/pluginlib](https://github.com/thodnev/pluginlib)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-09-25T18:38:18.200

你也可以看看[Groundwork](https://github.com/useblocks/groundwork "基础工作")。

这个想法是围绕可重用​​组件（称为模式和插件）构建应用程序。插件是派生自`GwBasePattern`. 这是一个基本示例：

```
from groundwork import App
from groundwork.patterns import GwBasePattern

class MyPlugin(GwBasePattern):
    def __init__(self, app, **kwargs):
        self.name = "My Plugin"
        super().__init__(app, **kwargs)

    def activate(self): 
        pass

    def deactivate(self):
        pass

my_app = App(plugins=[MyPlugin])       # register plugin
my_app.plugins.activate(["My Plugin"]) # activate it 
```

还有更高级的模式来处理例如命令行接口、信号或共享对象。

Groundwork 通过以编程方式将它们绑定到应用程序（如上所示）或自动通过`setuptools`. 包含插件的 Python 包必须使用特殊的入口点声明它们`groundwork.plugin`。

这是[文档](https://groundwork.readthedocs.io/en/latest/ "文档")。

**免责声明**：我是 Groundwork 的作者之一。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-10-08T09:30:33.410

在我们当前的医疗保健产品中，我们有一个使用接口类实现的插件架构。我们的技术堆栈是用于 API 的 Python 之上的 Django 和用于前端的 nodejs 之上的 Nuxtjs。

我们有一个为我们的产品编写的插件管理器应用程序，它基本上是符合 Django 和 Nuxtjs 的 pip 和 npm 包。

对于新插件开发（pip 和 npm），我们将插件管理器作为依赖项。

在 Pip 包中：在 setup.py 的帮助下，您可以添加插件的入口点以使用插件管理器（注册表、启动等） [https://setuptools.readthedocs.io/en/latest/setuptools .html#自动脚本创建](https://setuptools.readthedocs.io/en/latest/setuptools.html#automatic-script-creation)

在 npm 包中：与 pip 类似，npm 脚本中有钩子来处理安装。 [https://docs.npmjs.com/misc/scripts](https://docs.npmjs.com/misc/scripts)

我们的用例：

插件开发团队现在与核心开发团队分开。插件开发的范围是与在任何产品类别中定义的第 3 方应用程序集成。插件界面分类为例如：- 传真、电话、电子邮件...等插件管理器可以增强到新的类别。

在您的情况下：也许您可以编写一个插件并重用它来做事。

如果插件开发人员需要重用核心对象，则可以通过在插件管理器中进行一定程度的抽象来使用该对象，以便任何插件都可以继承这些方法。

只是分享我们是如何在我们的产品中实现的，希望它能提供一些想法。

# vb.net - 查找字符串中子字符串第一次出现的位置

> ID：932073
> 
> 赞同：5
> 
> 时间：2009-05-31T13:51:37.573
> 
> 标签：vb.net

我不想要一种在另一个字符串中查找字符串的方法。它应该返回子字符串第一次出现的位置。（在 VB 2008 中！）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T13:53:37.053

[String.IndexOf](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T13:58:03.957

我认为您正在寻找 InStr 函数，请参阅：[InStr at msdn](http://msdn.microsoft.com/en-us/library/8460tsh1(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-29T17:04:20.117

位置 = instr([stringField] & " ", " ")

在可能是名为 [stringField] 的空字符串中查找第一个空格。' & " "' 避免了 [stringField] 中没有空格的错误情况。

# javascript - 检测 IFRAME 的文档是否格式错误

> ID：932075
> 
> 赞同：0
> 
> 时间：2009-05-31T13:53:37.210
> 
> 标签：javascript, html, iframe, malformed

我正在将页面加载到 IFRAME 中，我想知道下载是否不完整 .. 并且 HTML 格式不正确，并且缺少结束标记，例如`</body>`and `</html>`。

有没有办法在 JavaScript 中检测到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T14:33:44.850

我不确定您是否可以测试格式错误的 HTML 或缺少的元素，而无需确切知道会发生什么并专门对其进行测试。

如果您有权访问 iframe 页面的源代码，则可以在`</body>`绑定到父窗口结束之前调用 javascript 函数变量；（或使用 window.onLoad() 事件调用触发调用。）

在您的容器页面中定义此方法。

```
window.iAmLoaded = function() { 
    alert('iframe loaded OK');
}; 
```

然后从 iframe 调用它；

```
 <script type="text/javascript" charset="utf-8">    
        window.parent.iAmLoaded();    
    </script>
</body> 
```

如果这不是一个选项，并且 iframe 有一个众所周知的 DOM，或者在页面末尾附近有一个独特的元素，您可以使用 getElementById 或您喜欢的库的 CSS 选择器方法来定位元素。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-05-31T14:26:47.063

您可以使用 iframe 的 onLoad 事件来判断其何时完成加载。 [http://www.w3schools.com/jsref/jsref_onload.asp](http://www.w3schools.com/jsref/jsref_onload.asp)

用于检测格式错误的 html：您正在寻找验证器。浏览器不这样做，除了，也许，对于 xhtml 严格。很可能有js验证软件。

拉里

# c - 数组上的就地位反转随机播放

> ID：932079
> 
> 赞同：8
> 
> 时间：2009-05-31T13:55:47.080
> 
> 标签：c, signal-processing, fft

对于 FFT 函数，我需要以位反转的方式排列或打乱数组中的元素。这是 FFT 的一项常见任务，因为两种大小的 FFT 函数的大多数功能要么期望或以位反转的方式返回它们的数据。

例如，假设数组有 256 个元素，我想用它的位反转模式交换每个元素。这里有两个例子（二进制）：

```
Element 00000001b should be swapped with element 10000000b
Element 00010111b should be swapped with element 11101000b 
```

等等。

知道如何快速且更重要地做到这一点：就地？

我已经有一个执行此交换的功能。写一篇不难。由于这是 DSP 中如此常见的操作，我觉得有比我非常幼稚的循环更聪明的方法来做到这一点。

有问题的语言是 C，但任何语言都可以。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-31T16:29:32.633

要通过单次就地交换，请在索引递增的所有元素中迭代一次。仅当索引小于反向索引时才执行交换——这将跳过双重交换问题以及回文情况（元素 00000000b、10000001b、10100101b），它反转为相同的值并且不需要交换。

```
// Let data[256] be your element array 
for (i=0; i<256; i++)
    j = bit_reverse(i);
    if (i < j)
    {
        swap(data[i],data[j]);
    } 
```

bit_reverse() 可以使用 Nathaneil 的位操作技巧。bit_reverse() 将被调用 256 次，但 swap() 将被调用少于 128 次。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-31T14:03:07.627

一种快速的方法是交换每个相邻的单个位，然后交换 2 位字段等。快速的方法是：

```
x = (x & 0x55) << 1 | (x & 0xAA) >> 1; //swaps bits
x = (x & 0x33) << 2 | (x & 0xCC) >> 2; //swapss 2-bit fields
x = (x & 0x0F) << 4 | (x & 0xF0) >> 4; 
```

虽然难以阅读，但如果这是需要优化的内容，您可能希望这样做。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-31T15:01:09.617

此代码使用查找表非常快速地反转 64 位数字。对于您的 C 语言示例，我还包括了 32、16 和 8 位数字的版本（假设 int 是 32 位）。在面向对象的语言（C++、C# 等）中，我只会重载该函数。

*目前我手头没有 C 编译器，所以希望我没有错过任何东西。*

```
unsigned char ReverseBits[] = 
{
  0x00, 0x80, 0x40, 0xC0, 0x20, 0xA0, 0x60, 0xE0, 0x10, 0x90, 0x50, 0xD0, 0x30, 0xB0, 0x70, 0xF0, 
  0x08, 0x88, 0x48, 0xC8, 0x28, 0xA8, 0x68, 0xE8, 0x18, 0x98, 0x58, 0xD8, 0x38, 0xB8, 0x78, 0xF8, 
  0x04, 0x84, 0x44, 0xC4, 0x24, 0xA4, 0x64, 0xE4, 0x14, 0x94, 0x54, 0xD4, 0x34, 0xB4, 0x74, 0xF4, 
  0x0C, 0x8C, 0x4C, 0xCC, 0x2C, 0xAC, 0x6C, 0xEC, 0x1C, 0x9C, 0x5C, 0xDC, 0x3C, 0xBC, 0x7C, 0xFC, 
  0x02, 0x82, 0x42, 0xC2, 0x22, 0xA2, 0x62, 0xE2, 0x12, 0x92, 0x52, 0xD2, 0x32, 0xB2, 0x72, 0xF2, 
  0x0A, 0x8A, 0x4A, 0xCA, 0x2A, 0xAA, 0x6A, 0xEA, 0x1A, 0x9A, 0x5A, 0xDA, 0x3A, 0xBA, 0x7A, 0xFA,
  0x06, 0x86, 0x46, 0xC6, 0x26, 0xA6, 0x66, 0xE6, 0x16, 0x96, 0x56, 0xD6, 0x36, 0xB6, 0x76, 0xF6, 
  0x0E, 0x8E, 0x4E, 0xCE, 0x2E, 0xAE, 0x6E, 0xEE, 0x1E, 0x9E, 0x5E, 0xDE, 0x3E, 0xBE, 0x7E, 0xFE,
  0x01, 0x81, 0x41, 0xC1, 0x21, 0xA1, 0x61, 0xE1, 0x11, 0x91, 0x51, 0xD1, 0x31, 0xB1, 0x71, 0xF1,
  0x09, 0x89, 0x49, 0xC9, 0x29, 0xA9, 0x69, 0xE9, 0x19, 0x99, 0x59, 0xD9, 0x39, 0xB9, 0x79, 0xF9, 
  0x05, 0x85, 0x45, 0xC5, 0x25, 0xA5, 0x65, 0xE5, 0x15, 0x95, 0x55, 0xD5, 0x35, 0xB5, 0x75, 0xF5,
  0x0D, 0x8D, 0x4D, 0xCD, 0x2D, 0xAD, 0x6D, 0xED, 0x1D, 0x9D, 0x5D, 0xDD, 0x3D, 0xBD, 0x7D, 0xFD,
  0x03, 0x83, 0x43, 0xC3, 0x23, 0xA3, 0x63, 0xE3, 0x13, 0x93, 0x53, 0xD3, 0x33, 0xB3, 0x73, 0xF3, 
  0x0B, 0x8B, 0x4B, 0xCB, 0x2B, 0xAB, 0x6B, 0xEB, 0x1B, 0x9B, 0x5B, 0xDB, 0x3B, 0xBB, 0x7B, 0xFB,
  0x07, 0x87, 0x47, 0xC7, 0x27, 0xA7, 0x67, 0xE7, 0x17, 0x97, 0x57, 0xD7, 0x37, 0xB7, 0x77, 0xF7, 
  0x0F, 0x8F, 0x4F, 0xCF, 0x2F, 0xAF, 0x6F, 0xEF, 0x1F, 0x9F, 0x5F, 0xDF, 0x3F, 0xBF, 0x7F, 0xFF
};

unsigned long Reverse64Bits(unsigned long number)
{    
    unsigned long result;

    result = 
        (ReverseBits[ number        & 0xff] << 56) |
        (ReverseBits[(number >>  8) & 0xff] << 48) | 
        (ReverseBits[(number >> 16) & 0xff] << 40) | 
        (ReverseBits[(number >> 24) & 0xff] << 32) | 
        (ReverseBits[(number >> 32) & 0xff] << 24) |
        (ReverseBits[(number >> 40) & 0xff] << 16) | 
        (ReverseBits[(number >> 48) & 0xff] <<  8) | 
        (ReverseBits[(number >> 56) & 0xff]);

    return result;
}

unsigned int Reverse32Bits(unsigned int number)
{
    unsigned int result;

    result = 
        (ReverseBits[ number        & 0xff] << 24) |
        (ReverseBits[(number >>  8) & 0xff] << 16) | 
        (ReverseBits[(number >> 16) & 0xff] <<  8) | 
        (ReverseBits[(number >> 24) & 0xff]);

    return result;
}

unsigned short Reverse16Bits(unsigned short number)
{
    unsigned short result;

    result = 
        (ReverseBits[ number       & 0xff] <<  8) | 
        (ReverseBits[(number >> 8) & 0xff]);

    return result;
}

unsigned char Reverse8Bits(unsigned char number)
{
    unsigned char result;

    result = (ReverseBits[number]);

    return result;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-31T17:01:35.033

如果您考虑位交换索引发生了什么，它的计数方式与非位交换索引的计数方式相同，只是位的使用顺序与传统计数相反。

您可以手动实现一个“++”等效项，它使用错误顺序的位来执行双索引 for 循环，而不是每次通过循环都对索引进行位交换。我已经验证了 O3 处的 gcc 内联了增量函数，但至于它是否比每次通过查找来位交换数字更快，这是分析器说的。

这是一个说明性的测试程序。

```
#include <stdio.h>

void RevBitIncr( int *n, int bit )
{
    do
    {
        bit >>= 1;
        *n ^= bit;
    } while( (*n & bit) == 0 && bit != 1 );
}

int main(void)
{
    int max = 0x100;
    int i, j;

    for( i = 0, j = 0; i != max; ++i, RevBitIncr( &j, max ) )
    {
        if( i < j )
            printf( "%02x <-> %02x\n", i, j );
    }

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T13:59:37.057

使用预先构建的查找表进行映射似乎是显而易见的解决方案。我想这取决于您要处理的数组有多大。但即使直接映射是不可能的，我仍然会去查找表，也许是字节大小的模式，您可以使用它来为最终索引构建字大小的模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-10T17:21:34.193

以下方法从前一个索引中计算下一个位反转索引，就像 Charles Bailey 的答案一样，但以更优化的方式。请注意，增加一个数字只会翻转一系列最低有效位，例如 from`0111`到`1000`。因此，为了计算下一个位反转索引，您必须翻转一系列最高有效位。如果您的目标平台有 CTZ（“计数尾随零”）指令，这可以有效地完成。

使用 GCC 的示例`__builtin_ctz`：

```
void brswap(double *a, unsigned n) {
    for (unsigned i = 0, j = 0; i < n; i++) {
        if (i < j) {
            double tmp = a[i];
            a[i] = a[j];
            a[j] = tmp;
        }

        // Length of the mask.
        unsigned len = __builtin_ctz(i + 1) + 1;
        // XOR with mask.
        j ^= n - (n >> len);
    }
} 
```

如果没有 CTZ 指令，您也可以使用整数除法：

```
void brswap(double *a, unsigned n) {
    for (unsigned i = 0, j = 0; i < n; i++) {
        if (i < j) {
            double tmp = a[i];
            a[i] = a[j];
            a[j] = tmp;
        }

        // Compute a mask of LSBs.
        unsigned mask = i ^ (i + 1);
        // Using division to bit-reverse a single bit.
        unsigned rev = n / (mask + 1);
        // XOR with mask.
        j ^= n - rev;
    }
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-31T14:07:20.193

> 元素 00000001b 应与元素 10000000b 交换

我认为您的意思是“元素 00000001b 应该与第一行的元素 11111110b 交换”？

您可以将数组转换为 (long long*) 并交换 32 个“long long”值，而不是等待 256 个字节，这在 64 位机器上应该更快（或在 32 位机器上使用 64 个 long 值）。

其次，如果你天真地遍历数组并用它的补码交换所有值，那么你将交换所有元素两次，所以你什么也没做:-)所以你首先必须确定哪些是补码并将它们排除在你的循环之外.

# javascript - 使用 jquery 将 javascript（用于 Quicktime）插入到

> ID：932086
> 
> 赞同：1
> 
> 时间：2009-05-31T14:00:44.153
> 
> 标签：javascript, html

我对 javascript 和编程非常陌生，并且在我的项目中遇到了障碍。我有一个 div，其中包含嵌入 quicktime 播放器的 javascript，当第一次加载页面时，页面没有指向 .mov 文件，因此占位符 div 是“未隐藏”并且播放器 div 设置为`style.display = 'none'`.

到目前为止一切顺利，然后用户输入新电影的名称，占位符 div 隐藏，播放器 div 未隐藏。我的问题是，当 div 可见时，播放器 div 中的 javascript 没有运行，如果我将播放器的脚本制作成一个单独的函数，然后在播放器 div 未隐藏时调用它，那么播放器运行全屏而不是在 div 中。

在 div 可见但似乎无法获取`$("#player").load(somescript)`或`$("#player").html(htmlwithjavain)`添加脚本后，我尝试使用 jquery 将 javascript 添加到 div 中。

我知道可以更改播放器 div 内容，因为我可以使用`$("#player").empty();`和`$("#player").html();`操作它。

感谢阅读，希望对您有所帮助

以下是相关代码：-

```
<html>
    <head>
        <title>Browse Media Player</title>

                <link rel="stylesheet" type="text/css" href="CSS/browser.css" />

        <script type="text/javascript">

        <!--

                var userinterrupt=false;
                var runonce=false;

                var currentfile;
                var basemediapath = "http://10.255.10.71/IsilonBrowse/movfiles/";

                var playerheight = 750;
                var playerwidth = 900;

                var currenttc;
                var basetime;
                var baseduration;
                var currentduration = "no tc available";
                var tcoffset = 35990;

                var playspeed = 1;
                var boolisplaying=true;
                var boolonslide=false;

                //function to fire off other methods when the DOM is loaded
                //Use in place of body onload, using jquery library
                //

            $(document).ready(function()
                {
                  //showEvents('jquery running');
                  showhideplayer(null);
                });

              //-->
             </script>

    </head>
    <body onload="forceslider(); timecode()">

      <div class="container">

           <div id="timecode_container">
                <div class="tc_overlay"></div>
                <div id="timecode" class="timecode"></div>
           </div>

           <div id="player" class="playerdiv" style="display:none;">

               **javascript for player goes here...**

           </div>

           <div id="noclipoverlay" class="playerdiv" style="display:none;">
           <p>No media loaded...
           </div>

           <div id="noclipoverlay2" class="playerdiv" style="display:none;">
           <p>loading media....
           </div>

      </div>

        <div id="loadstatus"></div>
        <div id="alerts"></div>

    </body>
</html> 
```

现在应该添加 javascript 代码的 mainstuff.js 文件：-

```
 //function to switch the player div and mask div is no media file is
         //defined in the 'currentfile' variable
         //
         function showhideplayer(state)
         {

          if (!currentfile)
          {
                showEvents('wtf no media');
                document.getElementById("player").style.display = 'none';
                document.getElementById("noclipoverlay").style.display = 'block';
          }

          else if (currentfile)
          {

           document.getElementById("player").style.display = 'block';
           document.getElementById("noclipoverlay").style.display = 'none';
           showEvents('valid media file');

           }

           }

            //end of showhideplayer

         //function to change movie files, note SetResetPropertiesOnReload must be set to false
         //otherwise the B'stard player will default all attributes when setURL runs
         //
         function changemovie(newmovie)
         {
            oldfile = currentfile;
            if (newmovie == currentfile)
            {
              showEvents('same file requested so no action taken');
              return;
            }

            if (newmovie != currentfile)
            {
              showEvents('changing movie');
              //switch the divs around to hide the 'no media slide'
              document.getElementById("player").style.display = 'block';
              document.getElementById("noclipoverlay").style.display = 'none';
            }

            showEvents('movie changed to: '+newmovie);
            currentfile=newmovie;

            if (!oldfile)
            {
              $("#player").empty();
              showEvents('the old media file was blank');

              $("#player").load("/path/loadplayer.js");

            }

            document.movie1.Stop();
            document.movie1.SetResetPropertiesOnReload(false);
            document.movie1.SetURL(currentfile);

            //showEvents('movie changed to: '+newmovie);

            if (boolisplaying)
            {
              document.movie1.Play();
            }

         } 
```

[编辑] 这是 loadplayer.js 的内容：-

```
 var movie1 = QT_WriteOBJECT(
        currentfile, playerwidth, playerheight, "",
        "controller","false",
        "obj#id", "movie1",
        "emb#id","qt_movie1",
        "postdomevents","True",
        "emb#NAME","movie1",
            "enablejavascript","true",
        "autoplay","true",
        "scale","aspect",
        "pluginspage","http://www.apple.com/quicktime/download/"
            ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T16:19:25.240

在不知道你的 loadplayer.js 文件的内容的情况下，很难给你一个解决方案。

例如，如果脚本在页面加载后尝试执行 document.write()，它将创建一个新页面，覆盖当前页面。当你说快速电影正在全屏运行时，这就是你的意思吗？

此外，加载 SCRIPT 元素并将其作为 HTML 插入通常不是一个好主意。当您将 HTML 添加到页面时，jQuery 会查找所有 SCRIPT 元素并在全局上下文中评估它们，这可能会给您带来意想不到的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T04:40:46.913

如果您想返回字符串，请使用 AC_QuickTime.js 中的 QT_GenerateOBJECTText_XHTML 或 QT_GenerateOBJECTText。

# java - 带类的 Java 泛型

> ID：932090
> 
> 赞同：9
> 
> 时间：2009-05-31T14:04:26.673
> 
> 标签：java, generics

所以我有一张地图：

```
Map<String, Class> format = new HashMap<String, Class>(); 
```

我会像这样向它添加元素：

```
format.put("Vendor Number", Integer.class);
format.put("Vendor Dispatch", Date.class); 
.... 
```

我有一个通用方法如下：

```
public static <T> T verifyType(String name, Class<T> type) {
    if (type == Integer.class) {
        return type.cast(new Integer(Integer.parseInt(name)));
    }
             ......
    return null;
} 
```

现在这段代码运行良好，没有编译器问题：

```
Integer i = verifyType("100",Integer.class); 
```

但是，当我尝试这个时：

```
 Integer i = verifyType("100",format.get("Vendor Number"));

OR 

    Class type = Integer.class
    Integer i = verifyType("100",type); 
```

编译器向我显示此警告：类型安全：通用方法 verifyType(String, Class) 的未经检查的调用 verifyType(String,Class)

这让我感到困惑......请帮助......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T14:13:56.857

改变：

```
Class type = Integer.class
Integer i = verifyType("100",type); 
```

到

```
Class<Integer> type = Integer.class
Integer i = verifyType("100",type); 
```

通过仅将类型声明为“类”，您将丢失泛型参数，并且 verifyType() 方法无法推断类，因此会出现未经检查的警告。

这个问题：

```
Map<String, Class> format = new HashMap<String, Class>();
format.put("Vendor Number", Integer.class);
format.put("Vendor Dispatch", Date.class);
Integer i = verifyType("100",format.get("Vendor Number")); 
```

由于类型擦除，无法真正解决。编译器无法根据运行时消失的泛型参数推断类型。这是因为 Java 泛型只不过是用于铸造的烟雾和镜子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T14:52:54.827

您必须泛化您对 Class 的引用。例如：

```
Class<Integer> type = Integer.class
Integer i = verifyType("100",type); 
```

可以正常工作。

就像这样：

```
Map<String, Class<?>> format = new HashMap<String, Class<?>>(); 
```

但是，这永远不会奏效：

```
Integer i = verifyType("100",format.get("Vendor Number")); 
```

因为格式未定义为：

```
Map<String, Class<Integer>> 
```

如果是这样，铸造会起作用，但设计将毫无意义。

您可以获得的最接近的是：

```
Integer i = verifyType("100",(Class<Integer>) format.get("Vendor Number")); 
```

然而，你会得到一个编译器警告，这是你必须要做的——它本质上是不安全的强制转换。编译器相信你的话 format.get 语句将返回一个整数。如果您确定这一点，那么这就是不安全演员表的用途。如果你想摆脱编译器警告，你可以这样做：

```
 Class<?> type = format.get("Vendor Number");
    Integer i = null;
    if (type == Integer.class) {
        i = verifyType("100", Integer.class);
    } else {
        //What do you want to do?
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T14:11:19.810

这是因为您的 HashMap 返回一个

```
Class 
```

对象，但验证函数需要一个

```
Class<T> 
```

目的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T14:16:22.827

您收到此错误的原因是，在第一种情况下，编译器会看到您将 Class 对象传递给它，并且能够在编译时将 T 绑定到 Integer，但在第二种情况下，编译器只会看到您正在向其传递 Class目的。

归根结底，您将无法做到

```
Integer i = verifyType("100",format.get("Vendor Number")); 
```

以类型安全的方式，因为编译器不知道你会得到一个整数（如果有人在调用之前做了一个 format.put("Vendor Number", X.class) 怎么办？）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T16:03:49.220

对我来说很奇怪，你的编译器在线

```
Integer i = verifyType("100",format.get("Vendor Number")); 
```

抱怨未经检查的调用，但没有显示“类型不匹配：无法从对象转换为整数”之类的错误。

这条线对我来说没有意义。如果 verifyType 接收 Date.class 作为第二个参数，您期望它返回什么？也是一个整数（那么verifyType的返回类型无效）？还是约会？如果您期望一个日期，编译器如何知道这一点

```
format.get("Vendor Number"); 
```

返回 Integer.class，但

```
format.get("Vendor Dispatch"); 
```

返回 Date.class

调用

```
Integer i = verifyType("100",format.get("Vendor Dispatch")); 
```

必须失败，因为 Date 不是整数。所以，在我看来（以及在我的编译器看来）编译

```
Integer i = verifyType("100",format.get("Vendor Number")); 
```

必须失败。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T14:15:11.720

类`Class`本身就是一个泛型类。如果你试试

```
Class<Integer> type = Integer.class;
Integer i = verifyType("100", type); 
```

它应该工作得更好。输入参数的生成使编译器相信您知道自己在做什么，足以让您的代码在没有警告的情况下编译。

您还可以通过使用禁止警告来说服编译器

```
@SuppressWarning("unchecked") 
```

在特定的代码行或方法之前。

# c++ - Qt 库中控件的默认 HTML 样式

> ID：932092
> 
> 赞同：1
> 
> 时间：2009-05-31T14:05:47.670
> 
> 标签：c++, qt

这是一个关于 Qt 库的问题，而不是关于 Web 设计的问题。

对于 QLabel 和其他控件，我可以设置 HTML 文本，例如“<h3>Some Text</h3>”。问题是：默认的 HTML 样式在哪里定义？如何找出 <h3> 标签使用的字体？

下一个问题：我可以更改默认的 HTML 样式吗？

编辑：我想在我的代码中的一个地方指定我的控件将如何显示。在所有标签中指定 css 样式对我来说似乎不是一个优雅的解决方案。

Edit2：似乎人们没有得到这个问题。我会再尝试。假设我执行以下操作：

```
 QLabel* label = ...
label->setText("This <b>is</b> a <h3>Header</h3>"); 

```

问题：标签文本渲染将使用哪些字体？我该如何控制它们？有没有办法指定 <h3> 标题的默认字体大小？

Edit3：Thomi 建议使用 QTextDocument::setDefaultStyleSheet。但这只是一种解决方法。我必须手动将 css 样式应用于界面中的所有 QTextEdits（而不是 QLabels）。问题是：如何*找出*默认样式表？QTextDocument::setDefaultStyleSheet 只是为单个 QTextDocument 对象覆盖它。也许 QTextDocument::defaultStyleSheet 返回它？我现在没有安装 Qt 的计算机，所以我无法检查它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-20T07:18:52.700

你想要的不能用 QLabel 完成。QLabel 旨在保存原始文本标签 - 它的 HTML 支持相当... 绳索。

但是，您*可以*使用 QTextEdit 和 QTextDocument 来实现这一点。

尝试这样的事情（我是从内存中写出来的，所以它可能无法编译或 100% 正确）：

```
QTextDocument *doc = new QTextDocument(this);
doc->setDefaultStyleSheet("h3 { font-color: red; }");
QTextEdit *edit = new QTextEdit(this);
edit->setDocument(doc);
edit->setHTML("this is a red <h3>heading</h3>"); 
```

重要的是使用 QTextDocument，它允许您更改 HTML 样式表。来自 QT 文档：

```
默认样式表应用于插入到文档中的所有新的 HTML 格式文本，例如使用 setHtml() 或 QTextCursor::insertHtml()。

样式表需要符合 CSS 2.1 语法。

注意：更改默认样式表对文档的现有内容没有任何影响。

```

[看到这里了解更多信息](http://doc.trolltech.com/4.5/qtextdocument.html#defaultStyleSheet-prop)

# 编辑：

要获取默认样式表，您可以调用`QTextDocument::DefaultStyleSheet()`- 但是，这仅适用于 QTextDocuments，可能适用于所有 Qt 控件（包括 QLabel），也可能不适用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T15:33:50.377

如其他答案中所述，您可以为小部件样式执行此操作，但不能为 HTML 标记执行此操作。唯一的方法是在你的 widgets`text`属性中单独设置 CSS 样式。

Qt 使用其富文本引擎来呈现根据 HTML 4 规范中的规则定义的 HTML 标签。请参阅[支持的 HTML 子集](http://doc.qt.io/archives/qt-4.8/richtext-html-subset.html)

如果您的所有标签只需要一种样式，为什么不这样设置它`setStyleSheet()`：

```
MainWindow w;    
w.setStyleSheet("QLabel{font-size:20px; color:purple;};"); 
```

除非您想在标签中使用多种样式（例如：“多种**样式**”） ，否则这***是***正确的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T14:19:28.047

查看[有关样式表的 Qt 文档](http://doc.trolltech.com/4.5/stylesheet.html)

您可能可以使用`QApplication::setStyleSheet()`或`QWidget::setStyleSheet()`完成它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-19T08:51:21.523

在最新的 QT 中，即在 QT4 上 ..上述答案有效。告诉您正在使用哪个 QT 版本...尝试以下操作...

```
 QLabel{
     border: 2px solid green;
     border-radius: 4px;
     padding: 2px;
     background-image: url(images/welcome.png);
 } 
```

[关联](http://doc.trolltech.com/4.3/stylesheet-examples.html#customizing-the-foreground-and-background-colors)

# language-agnostic - ID 列推荐使用什么数据类型？

> ID：932102
> 
> 赞同：14
> 
> 时间：2009-05-31T14:12:50.010
> 
> 标签：language-agnostic, database-design, types, primary-key, database-agnostic

*我意识到这个问题很可能以前被问过，但我在 StackOverflow 上的问题中搜索了一些，但我并没有真正找到我的答案，所以就这样吧。如果您发现重复，请链接到它。*

出于某种原因，我更喜欢将`Guid`s （`uniqueidentifier`在 MsSql 中）用于我的主键字段，但我真的不知道为什么这样会更好。在我最近学习的许多教程中，都使用了自动递增`int`的方法。我可以看到两者的优缺点：

*   A`Guid`始终具有相同的大小和长度，没有理由担心用完它们，而在用完适合`int`.
*   `int`是（至少在 C# 中）可以为空的类型，在查询数据时会打开几个快捷方式。
*   并且`int`更容易阅读。
*   我敢打赌，你至少可以在这里想出更多的东西。

所以，正如标题所说的那样简单：**数据库中 ID（主键）列的推荐数据类型是什么？**

编辑：收到几个简短的答案后，我还必须添加这个后续问题。没有它，您的答案既不具有说服力，也不具有教育意义……；）**您为什么这么认为，而另一个选项的缺点是什么使您*不*选择它？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-31T14:15:22.640

任何大小足以存储预期数据范围的整数类型。通常，对于具有大量行或更改的表，32 位整数被视为太小（正确或错误）。一个 64 位的 int 就足够了。许多数据库没有或不会使用该整数类型，但将使用具有指定比例和精度的 NUMBER 类型。10-15 位数是相当常见的尺寸。

选择整数类型的原因有两个：

1.  尺寸; 和
2.  速度。

整数的大小为：

*   32位：4字节；
*   64位：8字节；
*   二进制编码的十进制：每个字节两位数加上符号、比例和/或精度的一个字节。

将其与 128 位的[GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)或普通字符串进行比较，每个字符至少一个字节（在某些字符编码中更多）加上可能只有一个字节（终止 null）或可能更多的开销在某些情况下。

对整数进行排序是微不足道的，假设它们是唯一的并且范围足够小，实际上可以在 O(n) 时间内完成，而充其量是 O(n log n)。

同样重要的是，大多数数据库可以通过自动递增列和/或序列来生成唯一 ID。否则，保证应用程序的唯一性实际上非常困难，而且往往会导致密钥膨胀。

另外，自动生成的整数键通常是松散或绝对有序的（取决于数据库和配置），这是一个有用的品质。随机生成的 GUID 基本上是无序的，用处不大。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-31T14:24:31.890

多年来，流行的数据库允许更大的自动增量字段，所以这不是一个问题。

至于用什么，永远是一个选择。一种并不明显*优于*另一种，它们具有不同的特性，并且在不同的场景中都很好。随着时间的推移，我已经使用了这两种模式，下一个我使用的模式我会同时考虑这两种模式。

GUID 的优点：

*   在计算机中应该是唯一的。
*   随机的、令人难忘的粘性物意味着人们可能*仅*将其用于不透明标识符的预期目的。

自动增量的优点：

*   人类可以理解。
*   顺序分配意味着您可以使用聚集索引并影响性能。
*   适用于数据分区。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-31T14:25:46.210

使用 GUID 键的一大缺点是很难手动执行“临时”查询。有时您可以这样做非常有用：

SELECT * FROM 用户，其中用户 ID=452245

使用 GUID 键，这会变得非常烦人。

我会推荐 64 位整数

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T14:15:38.040

如果使用 long，则每秒可以创建超过 1000 个，并且在 2900 万年内不会用完主键。

其他人已经提到了使用整数类型而不是 UUID/GUID 的一些优点。一大优势是索引的速度和紧凑性。

我最近参与的一个应用程序，我在其中进行数据库设计，我需要 UUID，但不想放弃使用 long 作为主键的优势，所以我有一个“allIds”表来映射数据库中的每个主键系统到 UUID。我所有的主键都是从一个序列生成的，所以它们在所有表中都是唯一的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-31T14:26:12.947

告诉我你认为哪些标准很重要。

需要的是在表中是唯一的*。*

GUID 是全局概率唯一标识符。它也很大。如果您需要您的索引在 epsilon 内对宇宙中的所有其他数据库安装都是唯一的，那么这是一个不错的选择。否则，它会不必要地使用大量空间。

自增数是好的；它很小，而且在表中肯定是独一无二的。另一方面，它不能为您提供防止重复的保护；除了幻数之外，两个相同的条目很容易创建。

使用与所描述的实体相关的一些值可以避免这种情况，但是您会遇到处理唯一性的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T14:47:38.770

如果数据库是分布式的，您可以从其他数据库中获取记录，则主键*在所有数据库*的表中必须是唯一的。GUID 解决了这个问题，尽管以空间为代价。自动增量和命名空间的组合将是一个很好的权衡。

如果数据库可以为带有“前缀”的自动增量提供内置支持，那就太好了。因此，在一个数据库中，我得到了 X1、X2、X3 ... 等 ID，而在另一个数据库中，它可能是 Y1、Y2、Y3 ... 等等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T14:49:47.160

我问了一个类似的问题，其中有一些可能会有所帮助的答案。复制似乎是使用 GUID 的最大优势。

[不使用自动递增数字作为主键的原因](https://stackoverflow.com/questions/262547/reasons-not-to-use-an-auto-incrementing-number-for-a-primary-key)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-21T18:53:00.863

遵循 Cletus 的建议，另外需要注意的是，这在很大程度上取决于您的存储方式。永远不要使用 GUID。GUID 有很多缺点，只有一两个优点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-06T11:40:46.997

我从不喜欢整数和递增的标识符。当您想要跨不同表（两个表相同 ID）或跨不同数据库复制数据时，就会出现问题。Guid 作为一个字符串代表很大，当您在 Web 应用程序 url 中包含 id 时也会出现问题。所以我决定使用一个短字符串版本的 Guid，它在数据库中就像 varchar(16)。请参见下面的代码（方法 WebHash()）：

```
public static class IdentifyGenerator
{
    private static object objLock = new object();

    private static char[] sybmols = {
                         '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
                         'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j',
                         'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't',
                         'u', 'v', 'w', 'x', 'y', 'z',
                     };

    /// <summary>
    /// Creates a new Unique Identity HashCode (length 16 chars)
    /// </summary>
    /// <returns></returns>
    public static string WebHash(Guid fromGuid = default(Guid))
    {
        lock (objLock)
            return RandomString(16, (fromGuid != default(Guid) ? fromGuid.ToByteArray() : null));
    }

    public static string RandomString(int length, byte[] customBytes = null)
    {
        Stack<byte> bytes = customBytes != null ? new Stack<byte>(customBytes) : new Stack<byte>();
        string output = string.Empty;

        for (int i = 0; i < length; i++)
        {
            if (bytes.Count == 0)
                bytes = new Stack<byte>(Guid.NewGuid().ToByteArray());
            byte pop = bytes.Pop();
            output += sybmols[pop % sybmols.Length];
        }
        return output;
    }
} 
```

唯一的缺点是在 SQL 中创建新行时。所以你必须创建一个类似的 sql 函数。

很高兴在我的地址中收到任何批评。

# visual-studio - 折叠除注释之外的所有类字段

> ID：932112
> 
> 赞同：1
> 
> 时间：2009-05-31T14:17:24.603
> 
> 标签：visual-studio

有没有可能的方法来折叠除评论之外的所有类字段？Ctrl+M、Ctrl+O 快捷键折叠所有包括注释。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T14:21:48.120

你也许能在[这里](https://stackoverflow.com/questions/20507/give-me-awesome-visual-studio-keyboard-short-cuts)找到一些有趣的东西。第二个答案（不是标记为绿色的那个）有一个指向[Visual C# 2008 Keybinding Reference Poster](http://www.microsoft.com/downloads/details.aspx?FamilyID=e5f902a8-5bb5-4cc6-907e-472809749973&DisplayLang=en)的链接，其中可能包含一些有趣的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T14:37:24.500

该任务对于特定的（可按键绑定的）VS 任务来说有点太专业了。但是，编写为 DXCore 插件可能并不太难。（DXCore 是运行 Developer's Express 的 CodeRush 的免费提供的引擎（DXCore 可以在[http://www.devexpress.com](http://www.devexpress.com)找到）

# c++ - 寻找教程的初学者在 C++ 中编程 Outlook 插件

> ID：932114
> 
> 赞同：0
> 
> 时间：2009-05-31T14:17:45.477
> 
> 标签：c++, outlook, add-in

一般来说，我是 Outlook 编程和 Windows GUI 编程的绝对初学者。但是我在一般的 C++ 编程（不是 GUI）方面有很多年的经验，我需要开发一个 Outlook 插件，我的问题是从哪里开始？我需要知道什么才能让我开始？你能给我一些有用的链接来学习吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T08:01:23.297

[OutlookCode.com](http://outlookcode.com/)及其[论坛](http://outlookcode.com/forums.aspx)始终是我使用 Outlook 相关编程的第一个呼叫点。另请参阅[Office 开发人员中心](http://msdn.microsoft.com/office/default.aspx)。

对于您的特定方案，[COM 加载项](http://outlookcode.com/article.aspx?ID=36)页面链接到以下[ATL/C++ 示例](http://luifit.net/blogs/jluif/PermaLink.aspx?guid=90da1b84-3ea3-41de-a12c-d457dcc637fb)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T14:22:31.050

你可以使用 Outlook ActiveX 库或 CDO COM 库，如果你确定用户已经安装了 Outlook，最好的选择是使用第一个

# asp.net - ASP.NET 请求排队，我可以识别这些请求是什么吗？

> ID：932133
> 
> 赞同：4
> 
> 时间：2009-05-31T14:37:31.053
> 
> 标签：asp.net, request-queueing

当队列阻塞时，找出队列中当前有哪些类型的请求似乎很有帮助。有什么方法可以让我知道他们的信息吗？例如请求 url、客户端 ip、cookie、正文...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-01T07:54:16.690

您可以在此期间查看[ASP.NET 跟踪](http://msdn.microsoft.com/en-us/library/bb386420.aspx)。这将列出页面处理时间、请求的 IP 地址、请求的页面以及当前使用的会话、表单、请求和应用程序变量等内容。

但是，这些都是在请求服务后记录的，因此不会显示实时更新，但它应该可以帮助您查看什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-24T23:47:18.523

> 有什么方法可以让我知道他们的信息吗？

技术上缓慢的请求在 IIS 日志中的持续时间很长。使用[LogParser](https://gallery.technet.microsoft.com/office/Log-Parser-Studio-cd458765)查看哪些请求花费的时间最长，并使用最大时间和标准偏差来发现可能已排队的请求。

使用 LogParser 和这个查询

```
/*  Returns the number of times a particular page (in this case .as* files) was hit, with the average, minimum, and maximum time taken, along with the standard deviation.  */

SELECT TO_LOWERCASE(cs-uri-stem) AS csUriStem, COUNT(*) AS Hits, DIV ( MUL(1.0, SUM(time-taken)), Hits )  AS AvgTime, 
SQRROOT ( SUB ( DIV ( MUL(1.0, SUM(SQR(time-taken)) ), Hits ) , SQR(AvgTime) ) ) AS StDev, Max(time-taken) AS Max, Min(time-taken) AS Min, 
TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) AS Status, Min(TO_LOCALTIME(date)) AS LastUpdate 
FROM '[LOGFILEPATH]'
 WHERE cs-uri-stem like '%.as%' GROUP BY TO_LOWERCASE(cs-uri-stem), TO_REAL(STRCAT(TO_STRING(sc-status), STRCAT('.', TO_STRING(sc-substatus)))) HAVING COUNT(*) > 2
order by AvgTime desc 
```

# c# - 关于 DLR (.NET 4.0 beta 1) 的最佳信息来源是什么？

> ID：932137
> 
> 赞同：23
> 
> 时间：2009-05-31T14:39:30.143
> 
> 标签：c#, dynamic, c#-4.0, dynamic-language-runtime

我目前正在深入研究 C# 的第二版，并尝试实现“动态协议缓冲区”——即在我现有的协议缓冲区库之上的动态支持级别。因此，我有一个`DlrMessage`派生自`DynamicObject`. 在玩了一点之后，我设法让它以非常少的代码响应简单的属性，但我想走得更远 - 并真正了解发生了什么。

到目前为止，我还没有找到对 DLR 的任何好的解释——而且很多博客文章现在实际上已经过时了，因为在以前的 CTP 和 .NET 4.0 beta 1 之间发生了变化（我相信）[。MSDN 文档对于 DynamicObject](http://msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject(VS.100).aspx)目前非常少。

我最直接的疑问是是否有一种简单的说法，“使用反射来绑定我无法处理的任何调用，使用这个特定的对象。” （换句话说，如果可能的话，我想增加现有的反射绑定，而不是自己做所有事情。）不幸的是，我并没有靠猜测走得太远。

是否有任何我应该知道的明确和最新的文档来源？我知道关于新技术的部分写作*是*探索，但我们将不胜感激:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-31T17:52:19.470

我发现并经常阅读的最佳来源是 Chris Burrow 在[他的博客](http://blogs.msdn.com/cburrows/)上发表的最后几年的文章。

还有[官方 DLR 文档页面](http://www.codeplex.com/dlr/Wiki/View.aspx?title=Docs%20and%20specs)，该页面位于[DLR 主站点](http://dlr.codeplex.com/Wiki/View.aspx?title=Home)之外。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T18:11:42.420

我目前也在研究这个，还没有太多信息。我无法帮助您查询，但以下是我找到的一些信息：

PDC 视频中有相当数量的内容。

[http://channel9.msdn.com/pdc2008/TL44/](http://channel9.msdn.com/pdc2008/TL44/)

[http://channel9.msdn.com/pdc2008/TL10/](http://channel9.msdn.com/pdc2008/TL10/)

本文讨论了 DLR 如何与 IronPython 一起工作：http: [//msdn.microsoft.com/en-us/magazine/cc163344.aspx](http://msdn.microsoft.com/en-us/magazine/cc163344.aspx)

培训工具包预览中的数量非常少，网址为：http: [//www.microsoft.com/downloads/details.aspx? FamilyID=752cb725-969b-4732-a383-ed5740f02e93&displayLang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=752cb725-969b-4732-a383-ed5740f02e93&displayLang=en)

希望这可以帮助

亚历克斯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T23:40:12.593

默认情况下，如果您的 Try* 函数返回 false，DynamicObject 会说“回退到反射”。因此，如果动态路径不进行查找，您已经可以继承并向子类添加属性/字段/方法，所有这些都将由反射处理。

更深入地了解您可能需要查看 IDynamicMetaObjectProvider。在这个较低级别，您所说的回退到反射的方式是在传入的 DynamicMetaObjetBinder 上调用 Fallback* 方法。然后，这让调用语言提供解决方案。然后，您可以返回该 AST 或将其组合成您返回的更大的 AST。基本上 Fallback* 让您获得调用语言将产生的 AST，包括正确的错误（异常、在 JS 中未定义等）。

DynamicObject 回退到反射的方式是它实际上调用了活页夹的 Fallback* 方法两次。第一次回退时没有“errorSuggestion”参数。这会得到错误或使用反射构建的 AST。然后它会产生一个 AST，类似于：

```
if(TryGetMember("name", out value)) {
   return value;
} else {
   return resultOffallback;
} 
```

然后，它采用这个组合的 AST 并将其作为第二次回退的 binder 的错误建议提交。如果绑定不成功，则绑定器应遵守此错误建议。但是，如果存在 .NET 成员，则会丢弃 errorSuggestion 并优先使用 .NET 绑定。最后，如果该语言不知道绑定是否成功（例如，该语言具有“方法缺失”类型特征），它可以再次将 AST 与它的动态检查结合起来。所以使用 Fallback 你不仅可以说做反射，还可以选择动态或静态成员优先。

# php - 使用 MySQL 数据库和 PHP 填充表单

> ID：932140
> 
> 赞同：0
> 
> 时间：2009-05-31T14:41:47.067
> 
> 标签：php, mysql

我正在考虑对我的 PHP 应用程序采取下一步行动并使选项字段动态化。这将为更多的自动化打开大门。

我在整个项目中都有下拉菜单，它们用于选择特定用户，并在添加新用户时手动更新它们（这也是手动过程）。但是，如果我迈出第一步并让这些下拉列表由 MySQL 数据库填充，那么我可以继续进行动态用户创建。

我知道如何实现这一目标，但我对其他一些选择（如果有的话）很好奇。

这是我会做的..

```
$query = ** MySQL Select * From Database Query **

echo '<select name="usernames">';

while($row == mysql_fetch_array($query))
{
     echo '<option>' . $row['username'] . '</option>';
}

echo '</select>'; 
```

所以我的问题是，你会这样做吗？为什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T14:52:59.837

你的方法很好，但有两件事需要改变：
-在所有回显的 HTML 上**运行[htmlentities](http://php.net/htmlentities) () 或[htmlspecialchars](http://php.net/htmlspecialchars) () 以避免 XSS。**除非您已经在数据库输入时对其进行了清理，但我发现这种做法很愚蠢。
- 为每个标签添加一个`value`属性`<option>`，否则您将无法检索选择的用户名。我建议使用用户名的相应 ID 或该用户独有的其他内容。如果它是一个字符串，也可以在其上使用 htmlentities/htmlspecialchars。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T15:01:07.120

你正在做的事情会很好。我喜欢把它变成一个函数，这样如果我需要另一个页面上的下拉菜单，我就不必再写很多代码了。

```
function userDD()
{
   $query = ** MySQL Select * From Database Query **
   $html = '<select name="usernames">';

   while($row == mysql_fetch_array($query))
   {
        $html .= '<option>' . $row['username'] . '</option>';
   }

   $html .= '</select>';

   return $html;
} 
```

此代码与您的代码完全一样，只是它不使用 echo。相反，您使用变量 ($html) 来存储所有数据，然后在完成后将其返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T04:51:26.947

## .php 文件

```
$users = getUsers();

include('template.tpl'); 
```

## 模板

```
<select name="username">
<?php foreach( $users as $user ): ?>
    <li><?= e( $user['username'] ) ?></li>
<?php endforeach; ?>
</select> 
```

e 是一个转义字符串以防止 xss 攻击的函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T14:57:58.703

我不会将 SQL 查询放在与我的输出相同的文档中......

我会在函数中创建一个包含所有 SQL 查询的文档，并包含该文件。只是为了让事情分开。

# actionscript-3 - 根据鼠标位置缩放对象

> ID：932141
> 
> 赞同：2
> 
> 时间：2009-05-31T14:42:00.200
> 
> 标签：actionscript-3

我有一个大的 Sprite，当您旋转鼠标滚轮时，我想放大和缩小鼠标位置作为枢轴点，这正是谷歌地图或 Photoshop 缩放的工作原理。

为了实现缩放效果，我在 scaleX 和 scaleY 属性之间进行了补间，但固定点是 (0,0)，而我需要成为鼠标位置（当然，每次都会改变）。

我怎样才能改变这个？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T15:01:41.457

我刚刚在[Google 上搜索](http://www.google.co.uk/search?rlz=1C1GGLS_enGB326GB326&sourceid=chrome&ie=UTF-8&q=zoom+about+an+arbitrary+point)了“缩放任意点”（减去引号），第一个结果看起来很有希望。

您必须将原始偏移量从比例中取出，然后以新比例重新应用它。我自己做了这个，但现在手头没有代码，所以我看看能不能把它挖出来，然后再贴出来。

伪代码是这样的（来自内存）：

```
float dir = UP ? 1 : -1;
float oldXscale = Xscale;
float oldYscale = Yscale;
Xscale += dir * increment;
Yscale += dir * increment;
newX = (oldX - Xoffset) / Xscale;
newY = (oldY - Yoffset) / Yscale;
Xoffset += (newX * oldXscale) - (newX * Xscale);
Yoffset += (newY * oldYscale) - (newY * Yscale); 
```

任何未声明的都是“全局”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T19:41:30.093

通过在谷歌上搜索正确的词发现...这个链接解释了仿射变换[http://gasi.ch/blog/zooming-in-flash-flex/](http://gasi.ch/blog/zooming-in-flash-flex/) 所以我可以补间变换矩阵：

```
var affineTransform:Matrix = board.transform.matrix;
affineTransform.translate( -mouseX, -mouseY );
affineTransform.scale( 0.8, 0.8 );
affineTransform.translate( mouseX, mouseY );
var originalMatrix:Matrix = board.transform.matrix;
TweenLite.to(originalMatrix, 0.7, {a:affineTransform.a, b:affineTransform.b, c:affineTransform.c, d:affineTransform.d, tx:affineTransform.tx, ty:affineTransform.ty, onUpdate:applyMatrix, onUpdateParams:[originalMatrix]}); 
```

:-)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-11-19T21:08:01.207

```
private static function onMouseWheel(event:MouseEvent):void {
    var zoomAmount:Number = 0.03;

    if (event.delta < 0)
        zoomAmount *= -1;

    var x:int = largeLargeSprite.mouseX;
    var y:int = largeLargeSprite.mouseY;
    largeLargeSprite.scaleX += zoomAmount;
    largeLargeSprite.scaleY += zoomAmount;
    largeLargeSprite.x -= x * zoomAmount;
    largeLargeSprite.y -= y * zoomAmount;
} 
```

# asp.net - VB.NET Repeater 无数据源的简单数据绑定

> ID：932142
> 
> 赞同：0
> 
> 时间：2009-05-31T14:42:50.293
> 
> 标签：asp.net, vb.net, datarepeater

我是 ASP.NET 初学者。我之前问过如何在没有数据源的情况下对转发器进行一些数据绑定。这里。[VB.NET Repeater 无数据源的简单数据绑定](https://stackoverflow.com/questions/926619/vb-net-repeater-simple-data-binding-without-datasource)

这是有人为我找到的解决方案

```
Dim repeatTimes((TotalAdInsured)) As Integer

    myRepeater.DataSource = repeatTimes
    myRepeater.DataBind() 
```

但是，我现在需要知道如何为转发器中的每个项目获取索引。IE

```
<% #index %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T14:46:36.120

```
 <asp:Repeater runat="server" ID="rptAwesome">
        <ItemTemplate>
            <%# Container.DataItem %> <%# Container.ItemIndex %><br />
        </ItemTemplate>
    </asp:Repeater> 
```

# rest - RESTful 发布许多实体的策略

> ID：932144
> 
> 赞同：4
> 
> 时间：2009-05-31T14:45:04.983
> 
> 标签：rest, post, uploading

我仍在适应以 REST 方式做事的过程中。

在我的情况下，客户端软件将与 RESTful 服务进行交互。很少，客户端会上传其整个实体数据库（每个实体序列化为大约 5kb 的 xml 块）。

也许我错了，但正确的 RESTful 策略似乎是循环遍历每个实体并单独发布每个实体。然而，这些实体可能有数万个，而且不知何故，这么多快速射击的帖子似乎并不合乎情理。

在这种情况下，感觉就像将所有实体打包成一个大的 xml 表示会违反 RESTful 的做事方式，但它也会避免需要数千个 POST。

是否有一些标准做法来实现这一点？提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T18:30:31.140

我不明白为什么不能将“实体包”视为资源。事务性写入当然可以将数据库事务视为一种资源。我承认我没有读过 Fielding 的论文，但我不明白将多个资源包装到一个表示中会如何使 REST 无效。

数据库事务做这样的事情。它们会将较小的资源包装在事务资源中。确实，他们通常这样做是为了让您可以单独发布那些仍然很大的较小资源。但是由于事务本身被认为是一种资源，我不相信为它提出一个可以作为一个 POST 请求发布的表示会使这个设计变得不那么 RESTful。

它也习惯于另一个方向。当客户端从服务器获取搜索结果时，服务器可能会将这些结果包装在一个结果资源中，这样客户端就可以只获取这一个资源，而不是几个单独的资源。

所以我想说将这些 5kb 的小资源包装在一个更大的集合资源中可以被认为是 RESTful 并且可能是您应该采用的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T19:33:17.443

只要大包装器具有有效的媒体类型，就可以将其视为单个资源。弄清楚该媒体类型将是什么是棘手的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T19:42:04.337

这里至少有两个问题阻止您使用 RESTful。

1.  每个资源都需要通过一个 URI 来标识。对资源进行操作意味着您必须使用 HTTP 调用来调用 URI。因此，您不能在一次 HTTP 调用中调用多个资源中的多个操作。

2.  资源由名词标识并代表实体。这意味着要插入 Employee 和 Car，您需要为每个实体调用两个不同的资源。

所以总而言之，你不能在这里采取纯粹的 RESTful 方法。但是，REST 旨在通过约定提供帮助，而不是限制您。这里最好的解决方案是让您创建一个自定义操作来满足您的需求。

或者，您可以使用 INSERT、UPDATE 和其他将不同数据块作为 XML 接收的操作来创建通用包装实体。但是，这会破坏您的其他端点，因为现在可以通过通用包装器和`/Car/`URI 插入 Car 记录。

在不了解您的实际需求的情况下，我建议您不要专门通过 REST 公开此功能。一旦您分解传入的集合（如果是不同的对象），您仍然可以在幕后调用您在各种控制器中的 INSERT 操作方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T15:34:18.063

没有什么能阻止您在添加时创建更多资源，也就是使用 POST 将作为 X 列表的资源发布到作为 X 列表的资源。

然后，您将发送回一个 201，该 201 使用创建的所有资源的 URIS 列表创建。同样，这一切都是完全可以允许的。

您失去的是 PUT 对中介的可见性，这会阻止它们缓存或修改特定 URI 处的特定资源。尽管智能中介会出于缓存目的处理 201。

拥有一个并不会阻止您让每个创建的资源都有自己的 URI 创建后（在 POST 之后）并在这些资源上启用 PUT / DELETE。或组合。

# wpf - WPF 创建一个数据绑定的 ControlTemplate

> ID：932146
> 
> 赞同：0
> 
> 时间：2009-05-31T14:45:12.520
> 
> 标签：wpf, controltemplate, databound

我有一个绑定到对象的控件，一切都很好，但我想把它变成一个绑定到类似类型的不同对象的控件模板。如果可能的话，我想专门在 xaml 中执行此操作。任何概述步骤的好教程？

```
<TextBlock Text="{Binding Source={StaticResource BorderControl}, Path=ControlName}"/> 
```

编辑：有了更多的经验，事实证明我需要的是能够根据控件的属性设置绑定源。IE

```
<TextBlock Text="{Binding Source={StaticResource {TemplateBinding Tag}}, Path=ControlName}"/> 
```

该控件存在于 ControlTemplate 中，但如果我将其直接绑定到数据，则它可以正常工作——如果这会产生影响的话。我不知道这是否可能，或者这是否是正确的方法。欢迎任何想法！

编辑：

这也不起作用。

```
<TextBlock Text="{Binding Source={TemplateBinding Tag}, Path=ControlName}"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T08:48:27.850

我认为您希望 ContentPresenter 在这里（[http://msdn.microsoft.com/en-us/library/system.windows.controls.contentpresenter.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.contentpresenter.aspx)） - 将其视为 ItemsControl 的一行，它有一个内容和一个对代表该内容的模板的引用。

# c# - c# 和 Encoding.ASCII.GetString

> ID：932148
> 
> 赞同：2
> 
> 时间：2009-05-31T14:45:23.377
> 
> 标签：c#, encoding, ascii

```
byte[] header = new byte[]{255, 216}; 

string ascii =  Encoding.ASCII.GetString(header); 
```

我希望 ASCII 等于 FFD8（JPEG SOI 标记）

相反，我得到“？？？？？？”

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-31T15:36:30.250

在这种情况下，您最好比较字节数组而不是转换为字符串。

如果您必须转换为字符串，我建议使用编码 Latin-1 aka ISO-8859-1 aka Code Page 28591 编码，因为此编码会将所有十六进制值在 0-255 范围内的字节映射到 Unicode 字符相同的十六进制值 - 在这种情况下很方便。以下任何一项都将获得此编码：

```
Encoding.GetEncoding(28591)
Encoding.GetEncoding("Latin1")
Encoding.GetEncoding("ISO-8859-1") 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-31T14:47:23.233

是的，那是因为[ASCII](http://en.wikipedia.org/wiki/ASCII)只有 7 位 - 它没有定义任何高于 127 的值。编码通常将未知的二进制值解码为“？” （尽管这可以使用[DecoderFallback](http://msdn.microsoft.com/en-us/library/system.text.decoderfallback.aspx)进行更改）。

如果您要提及“扩展 ASCII”，我怀疑您实际上想要`Encoding.Default`的是“操作系统的默认代码页”……我相信大多数西方系统上的[代码页 1252](http://en.wikipedia.org/wiki/Windows-1252)。

你期待什么角色？

编辑：根据接受的答案（我怀疑这个问题是在我添加答案后被编辑的；我不记得最初看到任何关于 JPEG 的内容）你不应该将二进制数据转换为文本，除非它是真正编码的文本数据。JPEG 数据是*二进制*数据 - 因此您应该根据预期字节检查实际字节。

每当您使用“纯”文本编码（如 ASCII、UTF-8 等）将任意二进制数据（如图像、音乐或视频）转换为文本时，都存在数据丢失的风险。如果您*必须*将其转换为文本，请使用既美观又安全的 Base64。但是，如果您只想将其与预期的二进制数据进行比较，最好不要将其转换为文本。

编辑：好的，这是一个帮助给定字节数组的图像检测方法的类。我还没有让它特定于 HTTP。我不完全确定您是否应该真正获取`InputStream`，只阅读一点，然后再次获取流。我通过坚持字节数组来回避这个问题:)

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;

public sealed class SignatureDetector
{
    public static readonly SignatureDetector Png =
        new SignatureDetector(0x89, 0x50, 0x4e, 0x47);

    public static readonly SignatureDetector Bmp =
        new SignatureDetector(0x42, 0x4d);

    public static readonly SignatureDetector Gif =
        new SignatureDetector(0x47, 0x49, 0x46);

    public static readonly SignatureDetector Jpeg =
        new SignatureDetector(0xff, 0xd8);

    public static readonly IEnumerable<SignatureDetector> Images =
        new ReadOnlyCollection<SignatureDetector>(new[]{Png, Bmp, Gif, Jpeg});

    private readonly byte[] bytes;

    public SignatureDetector(params byte[] bytes)
    {
        if (bytes == null)
        {
            throw new ArgumentNullException("bytes");
        }
        this.bytes = (byte[]) bytes.Clone();
    }

    public bool Matches(byte[] data)
    {
        if (data == null)
        {
            throw new ArgumentNullException("data");
        }
        if (data.Length < bytes.Length)
        {
            return false;
        }
        for (int i=0; i < bytes.Length; i++)
        {
            if (data[i] != bytes[i])
            {
                return false;
            }
        }
        return true;
    }    

    // Convenience method
    public static bool IsImage(byte[] data)
    {
        return Images.Any(detector => detector.Matches(data));
    }        
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T14:55:23.823

如果您随后写道：

```
Console.WriteLine(ascii) 
```

并期望“FFD8”打印出来，这不是 GetString 的工作方式。为此，您需要：

```
 string ascii = String.Format("{0:X02}{1:X02}", header[0], header[1]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T20:25:20.270

我曾经写过一个自定义编码器/解码器，它将字节 0-255 编码为 un​​icode 字符 0-255 并再次返回。

它仅对在实际上不是字符串的东西上使用字符串函数非常有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T14:48:56.990

你确定吗 ”？？？？” 结果是什么？

结果是什么：

```
(int)ascii[0]
(int)ascii[1] 
```

另一方面，纯 ASCII 只是 0-127...

# c# - MainForm.Refresh(); 没有做我认为会做的事

> ID：932149
> 
> 赞同：0
> 
> 时间：2009-05-31T14:45:46.107
> 
> 标签：c#, winforms

我有一个表单，它从文本文件中获取其中一个标签的名称。这在启动应用程序时工作正常。但是从另一个表单，文本文件发生变化，我希望标签相应地改变。当进行这些文本文件更改的表单关闭时，会发生此刷新。我认为刷新它会和我使用 MainForm_Load 时发生的事情一样。但我想不会。我是不是做错了什么或者只是误解了 Refresh 的作用？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T15:01:52.640

该`Refresh`方法仅调用该`Invalidate`方法，因此它只会导致使用当前数据重新绘制控件。

将从文本文件中获取数据的代码放在一个单独的方法中，以便您可以从`Load`事件处理程序以及任何需要导致重新加载的代码中调用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T15:37:01.500

表单上的所有 Refresh 方法都是使表单无效，然后调用 Update（归结为[UpdateWindow](http://msdn.microsoft.com/en-us/library/dd145167(VS.85).aspx)调用）

解决问题的一种方法是使用 FileSystemWatcher 对象来监视文本文件的更改。当检测到更改时，它可以调用您的代码来打开文件并将数据输出到您的标签。

```
FileSystemWatcher fsw = new FileSystemWatcher();
fsw.Path = @"c:\temp";  // path to file
fsw.Filter = "yourfile.txt";
fsw.Changed += fsw_Changed;
fsw.EnableRaisingEvents = true; 
```

然后在您刚刚定义的更改事件中

```
void fsw_Changed(object sender, FileSystemEventArgs e)
{
  updateLabelFromTextFile();
}

private void updateLabelFromTextFile()
{
  var fs = File.OpenText(@"c:\temp\yourfile.txt");
  string sContent = fs.ReadToEnd();
  fs.Close();
  fs.Dispose();

  if (label1.InvokeRequired)
  {
    MethodInvoker mi = delegate { label1.Text = sContent; };
    this.BeginInvoke(mi);
  }
  else
    label1.Text = sContent;
} 
```

请注意，FileSystemWatcher 事件在单独的线程中触发，因此需要 BeginInvoke。

这是一个[示例](http://www.c-sharpcorner.com/UploadFile/thiagu304/FileSystemWatcher03192007133144PM/FileSystemWatcher.aspx)的链接（只需在 FileSystemWatcher 上进行搜索，您会发现更多示例）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T14:52:51.897

您的帖子有点令人困惑，但请尝试 MainForm.Invalidate(true) 而不是 MainForm.Refresh()...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T15:25:13.937

据我所知，Form.Load 在创建表单实例时引发一次。为了使更新标签的逻辑重新执行，每当标签更新时，必须从其他地方调用它

一种可能是将标签更新代码重构为方法，然后使用 FileSystemWatcher 在文件内容更改时接收事件，然后执行更新方法作为响应

# iphone - 在 UITableViewCell 中处理 touchesBegan 会禁用 didSelectRowAtIndexPath

> ID：932151
> 
> 赞同：7
> 
> 时间：2009-05-31T14:47:11.440
> 
> 标签：iphone, cocoa-touch, uitableview

我正在我的 customtableviewcell 控件中实现滑动手势，因此我可以实现 touchesBegan 事件。我能够实现滑动，但不幸的是，因为 touchesBegan 是在 customcell 中处理的，所以我没有在 tablecontroller 上收到 didSelectRowAtIndexPath 消息。如果 touchesBegan 方法被禁用，它可以工作。

这应该如何处理？我希望在处理完 touchesBegan 后，触摸事件会在响应者链中冒泡。我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-31T14:57:50.340

我确定您可以看到这种情况正在发生，因为您正在覆盖以前在超类上定义的方法。这样做意味着没有调用事件。

你试过打电话给[super touchesBegan]吗？这样所有上游的东西都被处理了。您可以覆盖滑动手势。

或者另一种选择是在您自己的触摸方法中检测到触摸时调用委托。

类似的东西（你可能也会有其他触摸事件的实现）

```
-(void) touchesBegan
{
 //logic to detect tap only.
 [tablecell.delegate didSelectRowAtIndexPath:(some way to determin touched row)]
} 
```

# string - 在 C# 中获取文本中搜索字符串的上下文

> ID：932156
> 
> 赞同：0
> 
> 时间：2009-05-31T14:49:53.413
> 
> 标签：string, search

给定一个包含换行符的字符串文本，有一个与文本中的项目匹配的搜索关键字。

如何在 C# 中实现以下内容：

searchIdx = 搜索索引（从 0 开始，然后是 1，以此类推，每次连续调用 GetSearchContext。最初从 0 开始。

contextsTxt = 要搜索的字符串数据

searchTxt = 在 contextsTxt 中搜索的关键字

numLines = 在找到的 searchTxt 周围返回的行数（即 1 = 找到 searchTxt 的行，2 = 找到 searchTxt 的行，3 = 找到 searchTxt 上方的行，searchTxt 所在的行找到，并且在 searchTxt 下面的行找到）

根据参数返回“上下文”

string GetSearchContext(int searchIdx, string contentsTxt, string searchTxt, int numLines);

如果有更好的功能接口来完成此操作，请随时提出建议。

我尝试了以下方法，但似乎并没有一直正常工作：

```
 private string GetSearchContext(string contentValue, string search, int numLines)
    {
        int searchIdx = contentValue.IndexOf(search);

        int startIdx = 0;
        int lastIdx = 0;
        while (startIdx != -1 && (startIdx = contentValue.IndexOf('\n', startIdx+1)) < searchIdx)
        {
            lastIdx = startIdx;
        }

        startIdx = lastIdx;

        if (startIdx < 0)
            startIdx = 0;

        int endIdx = searchIdx;
        int lineCnt = 0;

        while (endIdx != -1 && lineCnt++ < numLines)
        {
            endIdx = contentValue.IndexOf('\n', endIdx + 1);
        }

        if (endIdx == -1 || endIdx > contentValue.Length - 1)
            endIdx = contentValue.Length - 1;

        string lines = contentValue.Substring(startIdx, endIdx - startIdx + 1);
        if (lines[0] == '\n')
            lines = lines.Substring(1);

        if (lines[lines.Length - 1] == '\n')
        {
            lines = lines.Substring(0, lines.Length - 1);
        }

        if (lines[lines.Length - 1] == '\r')
        {
            lines = lines.Substring(0, lines.Length - 1);
        }

        return lines;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T15:03:39.237

这实际上不是一个家庭作业问题。我正在尝试建立一个个人搜索引擎。我刚刚弄清楚了为什么它并不总是有效的问题，这是由于区分大小写的搜索。

只需要添加 StringComparison.CurrentCultureIgnoreCase 就可以了！在发帖之前没有想到这一点，我感到很愚蠢。

# ruby-on-rails - Rails 中的模型类型和排序？

> ID：932160
> 
> 赞同：4
> 
> 时间：2009-05-31T14:52:08.713
> 
> 标签：ruby-on-rails, model

这是我已经坚持了一段时间的事情，我必须提前为这么简单的问题介绍这么多细节而道歉。我只是想说明我在这里想要做什么。

## 设想

所以，有一个模型 Foo，每个 Foo 可以是红色、绿色或蓝色。拥有 URL 喜欢`/reds`列出所有红色对象，并`/reds/some-red-object`显示某个对象。在那个“显示”视图中，应该有下一个/上一个链接，基本上“按字母顺序查找下一个 RedFoo，一旦在最后一个 RedFoo，下一个记录应该是第一个 GreenFoo，按字母顺序继续，等等在”。

我已经尝试以几种方式实现这一点，但最终都在某个地方遇到了障碍。不过，我确实让它在很大程度上与单表继承一起工作，有这样的东西：

```
class Foo < ActiveRecord::Base
class RedFoo < Foo
class GreenFoo < Foo
class BlueFoo < Foo 
```

每个子类的模型和控制器都是相同的，只需替换模型名称即可。所以控制器看起来像：

```
class RedFoosController < ApplicationController
  def index
    @foos = RedFoo.find(:all, :order => "title ASC")

    respond_to do |format|
      format.html { render :template => 'foos/index'}
      format.xml  { render :xml => @foos }
    end
  end

  def show
    @foo = RedFoo.find(params[:id])

    respond_to do |format|
      format.html { render :template => 'foos/show'}
      format.xml  { render :xml => @foo }
    end
  end

  def new
    @foo = RedFoo.new

    respond_to do |format|
      format.html { render :template => 'foos/new'}
      format.xml  { render :xml => @foo }
    end
  end

  def edit
    @foo = RedFoo.find(params[:id])

    respond_to do |format|
      format.html { render :template => 'foos/edit'}
    end
  end

  def create
    @foo = RedFoo.new(params[:foo])

    respond_to do |format|
      if @foo.save
        flash[:notice] = 'Foo was successfully created.'
        format.html { redirect_to(@foo) }
        format.xml  { render :xml => @foo, :status => :created, :location => @foo }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @foo.errors, :status => :unprocessable_entity }
      end
    end
  end

  def update
    @foo = RedFoo.find(params[:id])

    respond_to do |format|
      if @foo.update_attributes(params[:foo])
        flash[:notice] = 'Foo was successfully updated.'
        format.html { redirect_to(@foo) }
        format.xml  { head :ok }
      else
        format.html { render :action => "edit" }
        format.xml  { render :xml => @foo.errors, :status => :unprocessable_entity }
      end
    end
  end

  def destroy
    @foo = RedFoo.find(params[:id])
    @foo.destroy

    respond_to do |format|
      format.html { redirect_to(foos_url) }
      format.xml  { head :ok }
    end
  end
end 
```

这些模型只包含下一个/上一个的方法，这些方法工作得很好，令人惊讶。

```
class RedFoo < Foo
  def next
    if self == RedFoo.find(:all, :order => "title ASC").last
      GreenFoo.find(:all, :order => "title ASC").first
    else
      RedFoo.find(:first, :conditions => ["title > ?", self.title], :order => "title ASC")
    end
  end

  def previous
    if self == RedFoo.find(:all, :order => "title ASC").first
      BlueFoo.find(:all, :order => "title ASC").last
    else
      RedFoo.find(:first, :conditions => ["title < ?", self.title], :order => "title DESC")
    end
  end
end 
```

## 问题

无论出于何种原因，当我尝试创建和编辑记录时，都没有将属性保存在数据库中。它只是添加一个带有完全空列的新记录，而不管表单中填写了什么。脚本/服务器输出或日志文件中不会返回任何错误。但是，从脚本/控制台中，一切正常。我可以创建新记录并更新它们的属性没有问题。

我的控制器/模型中有很多代码重复，这也是一种非常糟糕的代码气味（它们使用与基本模型相同的视图，所以这很好）。但我认为这是不可避免的，除非我使用一些元善。

关于解决这个记录保存问题的任何建议或建议都会很棒，但我详细发布我的设置的原因是因为我觉得我可能会以错误的方式处理整个事情。因此，如果您知道比使用 STI 更实用的方法，我愿意接受其他方法。谢谢。

### 更新

参数哈希看起来很正确：

```
{"commit"=>"Create", "authenticity_token"=>"+aOA6bBSrZP2B6jsDMnKTU+DIAIkhc8fqoSicVxRJls=", "red_foo"=>{"title"=>"Hello world!"}} 
```

但@foo.inspect 返回以下 RedFoo 对象（全为零，类型除外）：

```
#<RedFoo id: nil, title: nil, type: "RedFoo", created_at: nil, updated_at: nil> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T17:17:07.760

请查看[此页面](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)上名为“单表继承”的部分，如果它解决了您的问题，请告诉我们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T09:00:13.910

问题是参数

```
:red_foo 
```

是视图中参数的名称，而您使用

```
params[:foo] 
```

在控制器中，我认为最好的方法是使用：foo，在视图中使用 text_field_tag 而不是任何（我假设可以是）表单构建器 text_field。

你可以通过使用一个模块来做基本的杂乱无章的事情来摆脱控制器的气味，因为我假设大多数新的/创建/编辑/更新/销毁的东西都是一样的

或者

您可以将所有路由映射到 foo 控制器并使用某种从路由传入的参数，或通过 URI 分析来获取红色/绿色/蓝色 foo

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T17:56:26.860

必须承认，我处理 STI 的方法是在模型中使用 set_table_name。

例如

```
class RedFoo < AR::Base
  set_table_name "foos"
  include FooModule
  extend FooClassModule # for self methods

  def next; ...; end
end 
```

但是无论如何，对于这种情况，当您在保存之前执行@foo.inspect 时，您的记录器会说什么，以及在插入/更新时运行的 SQL 是什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:18:17.883

对，所以@foo.inspect 在日志中给你“nil”？

我的意思是（如果我不够清楚的话）是：

```
def create
@foo = RedFoo.new(params[:foo])
logger.error "******************* foo: #{@foo.inspect} **************"
respond_to do |format|  
  if @foo.save
  ... 
```

如果您这样做并 tail -f 您的日志，您可以轻松找出 foo 发生的事情并将其与传入的 params 哈希值进行比较

事实上，这也是一些有用的信息，params hash 是什么？

# sql - 如何在我的数据库表上修复此 Identity int？

> ID：932164
> 
> 赞同：0
> 
> 时间：2009-05-31T14:54:00.740
> 
> 标签：sql, identity

大约一周前，一些数据被导入到数据库表中。简单表：

Id INT PK NOT NULL IDENTITY Name VARCHAR(20)

现在，我今天注意到第一个 id 从 0 开始。问孩子，他在测试期间重新播种。所以第一个条目是零。是个意外。

我不确定如何最好地更新值。我怎样才能将所有内容都推高一个数字？令我痛苦的是，还有一些 FK 依赖项。如果我有级联更新，是否应该修复依赖关系？

另外，我应该从上到下更新每个数字（但是我这样做吗？？）..例如。从最高数字开始，然后 +1。然后下去。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T15:00:14.627

首先，你为什么要强调？ID=0 完全有效，如果有点不寻常。（请注意，零*不是* `NULL`）

如果你真的想摆脱 0：

*   添加一个虚拟记录，
*   注意它的ID，
*   如果有指向记录 0 的外键，则将它们更新为虚拟记录。
*   删除该记录。（推进内部 ID 计数器）。
*   只需将 ID 0 更改为该值。

# cocoa - 通过单击可可中的 NSRect 打开一个 NSWindow

> ID：932171
> 
> 赞同：0
> 
> 时间：2009-05-31T14:58:35.940
> 
> 标签：cocoa, mouseevent

在我的程序中，我能够确定是否在某个 NSRect 内进行了鼠标点击。如何通过单击此 NSRect 打开一个新的 NSWindow？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T17:13:51.227

如果要显示现有窗口（使用 Interface Builder 创建），只需在窗口对象上调用[makeKeyAndOrderFront 。](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/index.html)
如果您想以编程方式创建一个新窗口，您可以在[此处](https://stackoverflow.com/questions/314256/how-do-i-create-a-cocoa-window-programmatically)找到答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T01:29:01.483

要处理事件，您需要在 NSView 或 NSViewController 子类中实现 NSResponder 的相关方法。例如，您可以实现`mouseDown:`并`-mouseUp:`处理鼠标点击（以相当简单的方式），如下所示：

```
- (void) mouseDown: (NSEvent *) event
{
    if ( [event type] != NSLeftMouseDown )
    {
        // not the left button, let other things handle it
        [super mouseDown: event];
        return;
    }

    NSPoint location = [self convertPoint: [event locationInWindow] fromView: nil];
    if ( !NSPointInRect(location, self.theRect) )
    {
        [super mouseDown: event];
        return;
    }

    self.hasMouseDown = YES;
}

- (void) mouseUp: (NSEvent *) event
{
    if ( (!self.hasMouseDown) || ([event type] != NSLeftMouseUp) )
    {
        [super mouseUp: event];
        return;
    }

    NSPoint location = [self convertPoint: [event locationInWindow] fromView: nil];
    if ( !NSPointInRect(location, self.theRect) )
    {
        [super mouseDown: event];
        return;
    }

    self.hasMouseDown = NO;

    // mouse went down and up within the target rect, so you can do stuff now
} 
```

# eclipse - eclipse.org 有用户反馈论坛吗？

> ID：932172
> 
> 赞同：1
> 
> 时间：2009-05-31T15:00:12.457
> 
> 标签：eclipse

我不是在谈论错误报告。他们如何决定在新版本中添加哪些功能？大概在某处有一些用户评论流可以告知他们的决策过程。IDE 看起来非常灵活，很难想象它不是由一些公共愿望清单驱动的。理想情况下，他们会有类似stackoverflow的东西=）

无论如何，我多年来一直在查看他们的网站，但还没有找到类似的东西。可能我只是瞎了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T15:47:45.693

您正在寻找[Eclipse.org 新闻门户](http://www.eclipse.org/newsportal/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T17:07:08.427

归根结底，无论新闻组讨论什么，如果您有想要添加的功能，[错误系统都是可以使用的机制。](https://bugs.eclipse.org/bugs/)只需将严重性标记为“增强”即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-02T18:09:20.750

最终，代码会说话。如果您希望 Eclipse 项目提供一些您关心的功能，那么您确实需要参与项目本身。错误报告是提出新功能的好方法，但如果您认真对待它，请考虑为该过程贡献自己的一些努力。

# c# - 跨越多行的正则表达式/识别注释行

> ID：932174
> 
> 赞同：1
> 
> 时间：2009-05-31T15:00:23.317
> 
> 标签：c#, regex

我想通过正则表达式解析 VB6 代码。然而，作为 Regex 的新手，我遇到了一些关于要使用的正则表达式的问题。目前，我在识别这些结构时遇到问题：

```
' Subs
' Sub Test
Private Sub Test(ByVal x as Integer)
    'Private Sub Test(ByVal y as Integer)
    Dim dummy as String
    dummy = "Private Sub Test(ByVal y as Integer)"
End Sub 
```

我基本上有这两个问题：我如何编写一个匹配子定义的正则表达式，并在其定义之上包含所有注释（和空）行？以及如何防止被注释禁用或包含在字符串中的子定义不匹配？另外，我需要支持跨越多行的定义，例如：

```
' Subs
' Sub Test
Private Function Test2( _
   ByVal x as Integer _
) As Long
    'Private Sub Test(ByVal y as Integer)
    Dim dummy as String
    dummy = "Private Sub Test(ByVal y as Integer)"
End Function 
```

任何提示将不胜感激。我提出的解决方案不适用于多行或仅捕获一个 Sub 定义。然后由于贪婪匹配，它只匹配到最后一个 End Sub 出现的末尾。

我在 C# 中的尝试目前看起来像这样：

```
(('(?<comment>[\S \t]+[\n\r]+))*((?<accessmodifier>(Private|Public))\s+_?)(?<functiontype>(Sub|Function))\s+_?(?<name>[\S]+)\((?<parameters>[\S \t]*)\)([ \t]+As[ \t]+(?<returntype>\w+))?)|(?<endfunction>End (Sub|Function)) 
```

我正在使用`Multiline`, `Singleline`, `IgnoreCase`, `ExplicitCapture`。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T15:18:09.490

我怀疑除了最简单的情况外，这对所有情况都是不可能的。使用正则表达式，您无法解析递归结构，并且语言（例如 VB）将具有递归特性。有关更多信息，请参阅[此 CodingHorror 博客条目](http://www.codinghorror.com/blog/archives/000253.html)。

除非您有非常简单的案例，否则我认为某种形式的解析器将成为前进的方向。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-01T00:49:39.457

为什么要解析这段代码？如果您尝试创建自己的编译器，那么您需要的不仅仅是正则表达式。如果您正在编写一个带有语法高亮和预先输入完成的编辑器，那么正则表达式可以在第一个方面做得很好，但在第二个方面就不行了。

也就是说，我在您的正则表达式中看到的最大问题是您没有正确处理行延续。this：`\s+_?`匹配一个或多个空白字符，可选地后跟一个下划线。但是如果有一个下划线，它应该跟一个你不匹配的换行符。这很容易补救——`\s+(_\s+)?`但我不确定你需要那么具体。我怀疑这一点：`[\s_]+`也会这样做。

至于避免在注释和字符串中出现明显的子/函数声明，最简单的方法是只在左边距匹配它们，可能有一些制表符或空格用于缩进。这是作弊，我知道，但不管你在做什么，它可能已经足够好了。当我为 EditPad Pro编写 Java[文件导航方案](http://www.editpadpro.com/fns.html)时，我非常依赖这个技巧。如果不使用大量的噱头和简化假设，你就不能用正则表达式做这种事情。试试这个正则表达式：

```
^(?>('(?<评论>.*[\n\r]+))*)
[ \t]*(?<访问修饰符>(私有|公共))
[\s_]+(?<函数类型>(子|函数))
[\s_]+(?<名称>\S+)
[\s_]*\((?<参数>[^()]*)\)
([\s_]+As[\s_]+(?<returntype>\w+))?
|
^[ \t]*(?<endfunction>End (Sub|Function))
```

当然，您需要先重新组装它。它应该使用`Multiline`,`IgnoreCase`和`ExplicitCapture`选项编译，而不是`Singleline`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T15:18:28.490

你知道，最终会出现正则表达式还不够的时候。这个级别的解析就是其中之一。

考虑改为编写一个简单的真实解析器，也许使用递归下降。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T15:21:30.167

不要尝试编写一个正则表达式来为您执行此操作（本质上它不能）。你需要的是一个解析器。可能最简单的解决方案是使用[递归下降解析器](http://en.wikipedia.org/wiki/Recursive_descent_parser)。我不使用 C#，但快速搜索出现了[Spart](http://www.codeproject.com/KB/recipes/spart.aspx?display=Print)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T16:04:41.433

鉴于 Visual Basic 的复杂性和复杂性，您可能需要使用标记器/解析器来解析代码。您不能对*所有事情都*依赖正则表达式；）

对于它的价值，[VB 形式语法可在此处获得](http://msdn.microsoft.com/en-us/library/aa711638(VS.71).aspx)。玩得开心！

# jquery - jQuery 文本框和 html

> ID：932177
> 
> 赞同：1
> 
> 时间：2009-05-31T15:01:16.060
> 
> 标签：jquery, textbox

我正在处理 ms ajax 中的一些数据并返回一个字符串，我使用 jQuery.val() 将其插入到文本框中。不幸的是，文本框既不解释也不解释
\ n，所以我怎样才能让它呈现文本框内的文本，这样它仍然看起来不错？

更新（按要求）：我使用类似的东西：

```
var sendEmailText = Hi, you found these items<ul><li>Car1</li><li>car2</li></ul><br><br/>Bye!      
jQuery('.CssReceiverMessage').val(sendEmailText); 
```

基本上它只是显示带有 html 标签的代码，而不是解释它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T15:31:15.313

大概您正在尝试发送样式化的电子邮件，并且文本框将包含邮件的文本。我建议您做两件事——首先使用 DIV 向用户显示文本。如果需要边框等，您可以设置它的样式，使其看起来像一个文本框/区域。然后有一个隐藏的输入，该输入实际上包含将发送回服务器的数据。这样，您的显示器就会按照您想要的方式工作，但数据会原封不动地传回，以便发送电子邮件。或者，您可以让服务器格式化电子邮件并将数据作为 JSON 或服务器可以解释的其他格式传回。

```
var sendEmailText = "Hi, you found these items<ul><li>Car1</li><li>car2</li></ul><br><br/>Bye!"     
jQuery('#receiverMessage').val(sendEmailText);
jQuery('.receiverDisplay').html(sendEmailText);

<div style="border: 1px solid #0000ff;" class="receiverDisplay">
</div>
<input type="hidden" id="receiverMessage" name="recevierMessage" /> 
```

**编辑**：如果用户需要编辑消息，如您对另一个答案的评论所示，请考虑使用降价编辑器，例如[WMD](http://github.com/cky/wmd/tree)（用于 SO）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T15:16:35.670

`<input>`不能在文本框（元素）中使用 HTML

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T15:25:45.090

不要使用 TextBox，而是使用 span 或 div。在页面上创建一个 Span。

```
<span id="ReceiverMessage"></span> 
```

然后在您的 jQuery 代码中将其 html() 设置为 sendEmailText：

```
jQuery("#ReceiverMessage").html(sendEmailText); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T15:48:51.607

你考虑过使用 TinyMCE 的 FCKEditor 吗？两者都替换了标准文本框并为您提供了丰富的 HTML 编辑器。

# java - 解析请求 URL 时如何获取 URL 标签？

> ID：932184
> 
> 赞同：7
> 
> 时间：2009-05-31T15:04:30.687
> 
> 标签：java, url, label, servlets

URL 可以有一个标签，用“#”号分隔，位于 URL 参数之后。例如[http://example.com/foo/bar.jsp?p1=v1#test_label](http://example.com/foo/bar.jsp?p1=v1#test_label)

我希望标签是 request.getQueryString() 和 request.getRequestURL().toString() 的一部分。但它似乎不存在。

有没有办法从服务器端的 HttpServletRequest 检索标签值？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-31T15:08:42.330

我认为 HTTP 规范决定“锚点”（这就是它们的名称吗？无论如何，哈希符号和后面的标签）不会传递给服务器，它们只是用于客户端滚动页面，或在 JavaScript 中使用。因此，除了在页面加载后通过 Ajax 请求将一个小脚本传递给您的服务器之外，您无法获得该值，但这不是很方便。

# asp.net - ASP.NET 动态更改中继器项内的下拉控件 ID

> ID：932186
> 
> 赞同：2
> 
> 时间：2009-05-31T15:04:52.637
> 
> 标签：asp.net, vb.net, datarepeater

有人可以告诉我如何让这个工作。我想区分转发器控件内的下拉控件。我现在了解了生命周期以及缓冲区是如何被写入的，但是我的替代方案是什么？这是发生的事情

代码文件

```
 Dim repeatTimes((TotalAdInsured - 1)) As Integer

    myRepeater.DataSource = repeatTimes
    myRepeater.DataBind() 
```

文件

```
<asp:Repeater ID="myRepeater" runat="server">
    <ItemTemplate>
         <asp:DropDownList ID="AdTitle<%# Container.ItemIndex %>" runat="server">
             <asp:ListItem Selected="True" Value="" Text=""/>
             <asp:ListItem Selected="False" Value="Miss" Text="Miss"/>
             <asp:ListItem Selected="False" Value="Ms" Text="Ms"/>
             <asp:ListItem Selected="False" Value="Mrs" Text="Mrs"/>
             <asp:ListItem Selected="False" Value="Mr" Text="Mr"/>
             <asp:ListItem Selected="False" Value="Other" Text="Other"/>
         </asp:DropDownList>
    </ItemTemplate>
</asp:Repeater> 
```

返回此错误

> 解析器错误消息：“AdTitle<%# Container.ItemIndex %>”不是有效标识符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T15:19:46.520

> 我想区分转发器控件内的下拉控件。

你不需要。以下是一些可能对您有所帮助的示例代码：

标记：

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Label runat="server" ID="lblMsg" Text="Click a button" />
        <hr />
        <asp:Repeater runat="server" ID="rptAwesome" onitemcommand="rptAwesome_ItemCommand"
            >
            <ItemTemplate>
                <asp:Button runat="server" ID="btnAwesome"
                    Text='<%# "Button #" + Container.ItemIndex %>'
                    CommandArgument='<%# Container.DataItem %>'/><br />
            </ItemTemplate>
        </asp:Repeater>
    </div>
    </form>
</body>
</html> 
```

代码隐藏：

```
using System;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            var x = new int[] { 1, 2, 3, 4, 5 };
            rptAwesome.DataSource = x;
            rptAwesome.DataBind();
        }
    }
    protected void rptAwesome_ItemCommand(object source, RepeaterCommandEventArgs e)
    {
        Button btnAwesome = (Button)e.CommandSource;
        lblMsg.Text = string.Format("btnAwesome.ID = {0}, e.CommandArgument = {1}", btnAwesome.ID, e.CommandArgument);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T15:19:22.387

您不能通过这样的标记在转发器内创建唯一 ID。但是，您可以使用中继器上的[FindControl](http://msdn.microsoft.com/en-us/library/486wc64h.aspx)在代码隐藏中检索下拉列表。

```
Dim adTitle As DropDownList = MyRepeater.FindControl("AdTitle")
If (Not adTitle Is Nothing) Then
  ''Do something here
End If 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T15:18:32.623

好的...简而言之，您无法以当前的方式做您想做的事情。

> 控件的 ID 属性只能使用标记中的 ID 属性和简单值来设置。例子：`<asp:Button runat="server" id="Button1" />`

我可以看到你想做什么，但我真的不明白为什么......

中继器控件将包含 1 个项目，每个项目在您的数据源中，因此只需调用您的 DropDownList`ID="AdTitle"`就可以了，因为这将`'AdTitle'`与下一行中的不同。

要将它们返回服务器端，您只需遍历中继器中的项目 &`FindControl("AdTitle")`以获取该项目的特定 DropDownList。

如果绝对有必要让 ID 递增，您需要以编程方式执行此操作（可能在`ItemDataBound`事件中创建 DropDownList 并将其添加到您的 ItemTemplate.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-05T21:36:06.967

扩展 BC 的答案：我最近遇到了同样的问题，尽管有一个复选框，但我需要设置我在坚持选择时使用的 ID。有点笨拙，但我在项目数据绑定时做到了。

这是标记：

> ```
> <asp:Repeater ID="Repeater1" runat="server" >
> <HeaderTemplate>Header<br /><br /></HeaderTemplate>
> <ItemTemplate>
>     <asp:CheckBox ID="cb" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "Name") %>' />
>      ...other controls removed for brevity
> </ItemTemplate>
> <FooterTemplate>
>     <asp:Button ID="Button1" runat="server" OnClick="Submit" Text="Submit" />
> </FooterTemplate>
> </asp:Repeater> 
> ```

我设置并绑定了这个类的集合

```
public class mst
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Number { get; set; }
    public bool NumberRequired { get; set; }
} 
```

在 Page_Load 中执行必要的操作

```
 Repeater1.ItemDataBound += new RepeaterItemEventHandler(Repeater1_ItemDataBound);
        Repeater1.DataSource = listOfMsts;
        Repeater1.DataBind(); 
```

其次，这是我设置 ID 的地方：

> ```
>  void Repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e)
>     {
>         if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
>         {
>             var mst = (mst)e.Item.DataItem;
>             ((CheckBox)e.Item.FindControl("cb")).ID = mst.Id.ToString();
>         }
>     } 
> ```

因此，当点击提交按钮时，我可以循环并获取已检查的 ID 并保存：

> ```
>  protected void Submit(object sender, EventArgs e)
>     {
>     foreach (var item in Repeater1.Items)
>         {
>             var checkboxes = ((RepeaterItem)item).Controls.OfType<CheckBox>().ToList();
>             if (checkboxes[0].Checked)
>             {
>                 Save(checkboxes[0].ID);
>                 ....other stuff
>             }
>         }
>     } 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T15:15:46.950

您可以将事件处理程序添加到 Repeater.ItemDataBound 并使用对项目容器的引用在处理程序中创建控件。

# c#-3.0 - 模拟对象何时进入重播状态？

> ID：932191
> 
> 赞同：10
> 
> 时间：2009-05-31T15:07:50.353
> 
> 标签：c#-3.0, rhino-mocks

执行此代码的第二行时，Rhino Mocks 抛出 InvalidOperationException 并显示消息“当模拟对象处于重播状态时，此操作无效”

```
var mockScanner = MockRepository.GenerateMock<PortScanner>(null);
        mockScanner.Expect((scanner => { scanner.Scan(null, null); })); 
```

在调试器中单步执行代码可以看到调试器运行类中定义的方法，并且在控制离开该方法后立即发生异常。

另一个测试中的类似代码确实可以正常工作

```
var mockView = MockRepository.GenerateMock<IScanView>(null);
        mockView.Expect(view => { view.Close(); });
        var controller = new ScanController(mockView);
        controller.Exit();
        mockView.VerifyAllExpectations(); 
```

我能想到的唯一区别可能是这两个测试之间的任何后果是 Exit 是接口上的成员，而 Scan 是类上的虚拟成员

我错过了什么？

***更新***
进一步的探索表明这与 Rhino 处理虚拟方法的方式有关。我现在专注于研究这里的文档

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T02:53:28.083

异常是因为 Rhino Mocks 没有对类型进行正确模拟所需的访问级别。使用 InternalsVisibleTo 授予对 Rhino Mocks 程序集的内部访问权限解决了该问题。

值得注意的是，这不会影响接口。我相信这是因为模拟框架需要覆盖接口上没有的类的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T15:19:58.673

如果从第一个表达式中删除额外的括号集会发生什么？

```
var mockScanner = MockRepository.GenerateMock<PortScanner>(null);
mockScanner.Expect( scanner => { scanner.Scan(null, null); } ); 
```

# vb.net - 关于 System.Data.Odbc / OdbcDataReader 的良好描述和教程

> ID：932192
> 
> 赞同：1
> 
> 时间：2009-05-31T15:08:20.117
> 
> 标签：vb.net

任何指向 OdbcDataReader 上好的描述和/或教程（使用 VB.net 2008）的链接？我试过了，但没有找到很多。在这种情况下，MSDN 并不是一个很好的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T04:44:34.487

你是绝对正确的。在 VB.Net 中很难找到 ODBC 的教程。以下是我找到的链接。希望能帮助到你。

*   [在 .NET 应用程序中使用 ODBC](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5793285.html) - VB.Net 和 C# 中的示例
*   [VB.NET 中的 ODBC 数据库到网格](http://www.dreamincode.net/forums/showtopic90770.htm)

# html - 如何请求浏览器始终更新（也就是从不缓存）某些页面元素，例如 CSS 表格？

> ID：932195
> 
> 赞同：4
> 
> 时间：2009-05-31T15:12:22.527
> 
> 标签：html, css, browser-cache

在开发我的页面时，我注意到一个一直困扰我的问题：虽然 Firefox（我的通用“开发”浏览器）总是在 CSS 和图像在服务器上发生更改时更新它们，但 Internet Explorer 并不总是这样做。通常，我需要在 IE 中刷新页面，然后它才会向服务器询问更新版本的东西。

据我了解，浏览器不应该至少检查每个请求的所有服务器端对象的时间戳，然后根据需要更新它们客户端吗？有没有办法我可以...不强制，但是..“鼓励”浏览器对某些项目执行此操作？

我在这里遇到的主要问题是我的页面上有一些 JavaScript，这些 JavaScript 依赖于以某种方式初始化的 CSS，反之亦然。当一个更新而另一个不更新时（在 IE 中很常见，当两者都在自己的外部页面中时），它会导致混乱，并且页面上偶尔会出现飞溅的结果。我可以自己处理“刷新页面”的舞蹈以进行开发，但是当我在网站上进行脚本狂潮时，我不想鼓励我的用户“刷新页面或其他”。

任何建议将不胜感激。页面本身更新顺利（它是 PHP），所以最坏的情况是我可以将 CSS 和 JavaScript 吐到页面本身，但这*真的很难*看，当然我会不惜一切代价避免它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T15:19:37.270

将您的网站设计成客户端只需要获取外部 JavaScript 和 CSS 一次是一种很好的做法。

将外部资源设置为未来 1 年到期。将版本号附加到每个文件名，因此不要`style.css`使用“”，而是使用“ `style-1.2.4.css`”，然后当您要更新客户端的 CSS 时，增加版本号。

增加版本号会强制客户端下载更新的文件，因为它被视为完全独立的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T15:15:56.950

在所有 URL 的末尾添加一点随机查询字符串。它很丑陋，但在开发时它可以工作。例如：

```
<link rel="stylesheet" type="text/css" href="/mycss.css?foo=<?php echo rand(); ?>"/> 
```

您可以对脚本、背景图像等执行相同操作。（并且不要忘记在您的网站上线时删除这些内容；））

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T15:19:05.337

这只是开发过程中的一个问题，当文件经常更改时。一旦您发布了站点，访问者将获得当前版本，并且缓存机制将或多或少地满足您的需求。

与其修改我的网站的工作方式，我只是养成了在开发过程中刷新之前清除缓存的习惯。正如你所说，在 Firefox 中，这通常不是问题，但如果我需要确定，我使用 Shift+Ctrl+Del，回车（我的清除私人数据设置只选中“缓存”。）在 IE 上，还有旧的 Shift+F5。

当然，正如其他人所提到的，您的易失文件上的随机查询字符串可以为您节省一些击键次数。但请理解，这实际上只是为了您自己的方便，而不是生产现场真正需要的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T15:25:32.937

最好将上次更改时间戳作为 GET-data 放在源的末尾 - 这样您就可以确保不会出现任何缓存错误。

完全删除缓存只是愚蠢的，因为它会导致页面变慢。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T15:19:33.323

如果您使用的是 apache，请在该 css 文件的 .htaccess 中：

```
<FilesMatch "mycssfile\.css$">
  Header set Cache-Control: "private, pre-check=0, post-check=0, max-age=0"
  Header set Expires: 0
  Header set Pragma: no-cache
</FilesMatch> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T21:35:20.940

浏览器通常根据服务器告诉它们的指令将页面存储在内部缓存中。不，如果根据上次检查显示文件未过期，则无需重新加载文件。当然，当您点击重新加载时，它们会显式地重新加载主页，但它们在 js 和样式方面的行为可能会有所不同。

正是出于这个原因，我使用具有“**开发**” -> “**禁用缓存**”菜单的Safari 进行开发。我敢肯定 Firefox 也有类似的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T21:50:39.037

我对 DanHerbert 的方法稍作改动。我倾向于为样式表使用相同的名称，但我在查询字符串中附加了一个版本号，以便浏览器在选择添加版本时将文件视为不同的文件。事情仍然会被缓存，但您可以根据自己的选择使其无效。

它比更改文件名更简洁，并且适合作为集中管理的解决方案，尤其是在具有来自四风的大量脚本和样式表的复杂应用程序中。

# wpf - 在 ResourceDictionary 内的共享 WPF 资源中启用数据绑定

> ID：932196
> 
> 赞同：4
> 
> 时间：2009-05-31T15:13:48.157
> 
> 标签：wpf, data-binding, resourcedictionary

我在 WPF 中使用 MV-VM 模式，并且我有一个我将经常使用的背景画笔，我想将它移到一个共享的 ResourceDictionary 中。

唯一的问题是画笔使用了一种颜色，它通过数据绑定到它的托管上下文中。

无论如何，我可以将刷子移到 ResourceDictionary 并仍然让它找到它需要的值吗？

刷子：

```
<RadialGradientBrush>
    <RadialGradientBrush.RelativeTransform>
        <TransformGroup>
            <ScaleTransform CenterX="0.5"
                            CenterY="0.5"
                            ScaleX="2.3"
                            ScaleY="2.3" />
            <TranslateTransform X="-0.3"
                                Y="-0.3" />
        </TransformGroup>
    </RadialGradientBrush.RelativeTransform>
    <GradientStop Color="{Binding Path=BackdropColor}"
                  Offset="1.2" />
    <GradientStop Color="#FFFFFFFF"
                  Offset="-0.1" />
</RadialGradientBrush> 
```

在将其重新分解为 ResourceDictionary 并添加一个键后，我将其称为：

```
<StackPanel Grid.Row="0"
            Margin="0,0,0,0"
            Orientation="Horizontal"
            Background="{DynamicResource BackdropRadGradBrush}"> 
```

但这导致调试器中出现以下输出：

*System.Windows.Data 错误：2：找不到目标元素的管理 FrameworkElement 或 FrameworkContentElement。绑定表达式：路径=背景颜色；数据项=空；目标元素是 'GradientStop' (HashCode=16001149); 目标属性是“颜色”（类型“颜色”）*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T15:24:03.843

我认为您不能将其保留`Brush`在资源字典中并使用绑定来提取颜色。由于画笔只创建一次（这就是为什么你首先希望它在资源字典中），在创建时 WPF 不知道它将在哪里使用，所以它不能拉入值颜色。

例如，如果颜色保留在“设置”中，那可能会起作用-但我猜这对您没有帮助，因为您可能希望在使用它的每个控件上更改颜色（否则，您可以只对颜色进行硬编码，否则它已经在设置中）。

也许您可以创建一个`RadialGradientBrush`子类，并将第一种`GradientStop`颜色公开为`DependencyProperty`? 然后，您可以在任何需要的地方创建此子类的实例，并使用绑定在此处提取正确的颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T17:46:23.613

这有点晚了，但是看看使用 a[`StaticResource`](http://msdn.microsoft.com/en-us/library/ms750950.aspx)或 a[`DynamicResource`](http://msdn.microsoft.com/en-us/library/ms748942.aspx)而不是 a `Binding`- 它允许您访问另一个资源。不完全是`Binding`，但总比没有好。

# c - 针对特定场景的最佳 Linux 内核锁定机制是什么

> ID：932197
> 
> 赞同：6
> 
> 时间：2009-05-31T15:15:23.723
> 
> 标签：c, concurrency, linux-kernel, locking, mutual-exclusion

我需要解决这种情况下的锁定问题：

1.  多CPU系统。
2.  所有 CPU 都使用公共（软件）资源。
3.  对资源的只读访问是很常见的。（处理传入的网络数据包）
4.  写访问的频率要低得多。（几乎只有配置更改）。

目前我使用`read_lock_bh`, `write_lock_bh`（自旋锁）机制。问题是 CPU 越多，我在编写器上下文中获得的软锁定就越多。

我读了[这本书](http://www.makelinux.net/ldd3/)的并发章节，但不太明白在使用自旋锁时，读者或作者是否会获得优先权。

所以问题是：

1.  Linux自旋锁机制是否优先考虑读取器/写入器/没有它们？
2.  有没有更好的机制可以用来避免在我的场景中出现这些软锁定，或者在使用我当前的解决方案时，我是否可以在尝试获取锁时优先考虑写入器？

谢谢，尼尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-09T19:20:31.167

[这是来自Essential Linux Device Drivers](http://www.elinuxdd.com/)的直接引用，这可能是您正在寻找的。看起来最后处理 RCU 的部分可能是你感兴趣的。

**读写锁**

另一种专门的并发调节机制是自旋锁的读写器变体。如果临界区的使用使得单独的线程可以读取或写入共享数据结构，但不要同时执行这两种操作，那么这些锁很自然。允许同时在一个关键区域内有多个读取器线程。阅读器自旋锁定义如下：

```
rwlock_t myrwlock = RW_LOCK_UNLOCKED;

read_lock(&myrwlock);             /* Acquire reader lock */
/* ... Critical Region ... */
read_unlock(&myrwlock);           /* Release lock */ 
```

但是，如果一个写线程进入临界区，其他读线程或写线程就不能进入。要使用写入器自旋锁，您可以这样写：

```
rwlock_t myrwlock = RW_LOCK_UNLOCKED;

write_lock(&myrwlock);            /* Acquire writer lock */
/* ... Critical Region ... */
write_unlock(&myrwlock); /* Release lock */ 
```

查看中的 IPX 路由代码，`net/ipx/ipx_route.c`了解读写器自旋锁的真实示例。称为读写锁的读写器`ipx_routes_lock`保护 IPX 路由表不被同时访问。需要查找路由表以转发数据包的线程请求读取器锁。需要从路由表中添加或删除条目的线程获取写入器锁。这提高了性能，因为路由表查找的实例通常比路由表更新的实例多得多。

像普通的自旋锁一样，读写锁也有相应的 irq 变体——即 , `read_lock_irqsave()`, `read_lock_irqrestore()`,`write_lock_irqsave()`和`write_lock_irqrestore()`. 这些函数的语义类似于常规自旋锁的语义。

在 2.6 内核中引入的序列锁或 seqlocks 是读写器锁，其中写入器优先于读取器。如果对变量的写操作远多于读访问，这很有用。`jiffies_64`本章前面讨论的变量就是一个例子 。编写器线程不会等待可能在临界区中的读者。因此，阅读器线程可能会发现它们在临界区中的条目已失败并且可能需要重试：

```
u64 get_jiffies_64(void) /* Defined in kernel/time.c */
{
   unsigned long seq;
   u64 ret;
   do {
      seq = read_seqbegin(&xtime_lock);
      ret = jiffies_64;
   } while (read_seqretry(&xtime_lock, seq));
   return ret;
} 
```

`write_seqlock()`编写器使用和保护关键区域`write_sequnlock()`。

2.6 内核引入了另一种称为**读取复制更新 (RCU) 的**机制，当读取器的数量远远超过写入器时，***它会提高性能***。基本思想是阅读器线程可以在没有锁定的情况下执行。编写器线程更复杂。它们对数据结构的副本执行更新操作并替换读者看到的指针。原始副本会一直保留到所有 CPU 上的下一次上下文切换，以确保完成所有正在进行的读取操作。请注意，使用 RCU 比使用迄今为止讨论的原语更复杂，并且只有在您确定它是适合该工作的工具时才应该使用它。RCU 数据结构和接口函数在`include/linux/rcupdate.h`. 中有充足的文档 `Documentation/RCU/*`。

**有关 RCU 使用示例**，请查看`fs/dcache.c`. 在 Linux 上，每个文件都与目录条目信息（存储在名为 dentry 的结构中）、元数据信息（存储在 inode 中）和实际数据（存储在数据块中）相关联。每次对文件进行操作时，都会解析文件路径中的组件，获取对应的dentries。dentry 被缓存在称为 dcache 的数据结构中，以加快未来的操作。在任何时候，dcache 查找的数量都远远多于 dcache 更新，因此对 dcache 的引用使用 RCU 原语进行保护。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-01T16:00:14.783

这不是 RCU 旨在处理的那种用例吗？请参阅[http://lwn.net/Articles/262464/](http://lwn.net/Articles/262464/)了解它的使用情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T21:30:50.293

如果你在持有锁时所做的工作很小，你可以尝试一个普通的互斥锁，非读写器。它更有效率。

# php - PHP 回显性能

> ID：932214
> 
> 赞同：3
> 
> 时间：2009-05-31T15:20:15.927
> 
> 标签：php, performance, printing, echo

我总是在 PHP 中使用一个输出变量，在我回显它之前我会收集所有内容。然后我在某处（我不记得在哪里）读到，如果将输出变量拆分为数据包，然后回显每个数据包而不是整个输出变量，您将获得最佳性能。

真的怎么样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T15:25:38.693

如果您使用 echo 输出非常大的字符串，最好使用多个 echo 语句。

这是因为[Nagle 的算法](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)导致数据通过 TCP/IP 缓冲的方式。

找到关于它的 Php-bugs 的注释：
[http ://bugs.php.net/bug.php?id=18029](http://bugs.php.net/bug.php?id=18029)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T15:28:08.033

这将自动将大字符串分解成更小的块并回显它们：

```
function echobig($string, $bufferSize = 8192) {
  $splitString = str_split($string, $bufferSize);

  foreach($splitString as $chunk) {
    echo $chunk;
  }
} 
```

资料来源：[http ://wonko.com/post/seeing_poor_performance_using_phps_echo_statement_heres_why](http://wonko.com/post/seeing_poor_performance_using_phps_echo_statement_heres_why)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-15T02:01:55.070

我认为这里提出了一个更好的解决方案....

[http://wonko.com/post/seeing_poor_performance_using_phps_echo_statement_heres_why#comment-5606](http://wonko.com/post/seeing_poor_performance_using_phps_echo_statement_heres_why#comment-5606)

...........

伙计们，我想我进一步缩小了范围！

如前所述，PHP 缓冲会让 PHP 跑到脚本的末尾，但之后它仍然会在尝试将所有数据传递给 Apache 时“挂起”。

现在我不仅能够测量这一点（参见前面的评论），而且能够真正消除 PHP 内部的等待期。我通过使用 SendBufferSize 指令增加 Apache 的 SendBuffer 来做到这一点。

这可以更快地将数据从 PHP 中推出。我想下一步是让它更快地脱离 Apache，但我不确定 Apache 和原始网络带宽之间是否真的存在另一个可配置层。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-16T19:02:33.710

这是我的解决方案版本，仅当连接未中止时才会回显。如果用户断开连接，则函数退出。

```
<?php
function _echo(){
    $args    = func_get_args();
    foreach($args as $arg){
        $strs = str_split($arg, 8192);
        foreach($strs as $str){
            if(connection_aborted()){
                break 2;
            }
            echo $str;
        }
    }
}
_echo('this','and that','and more','and even more');
_echo('or just a big long text here, make it as long as you want'); 
```

# esb - 使用什么 ESB？

> ID：932219
> 
> 赞同：0
> 
> 时间：2009-05-31T15:23:41.630
> 
> 标签：esb

我们正在考虑一个 ESB 基础架构。

您什么时候会考虑像 Mule 这样的开源产品，什么时候会考虑像 TIBCO、BizTalk 或 Oracle Fusion 这样的软件包？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T15:40:12.170

成本和支持是明显的两个显着特征。

如果您没有钱购买许可证，那么开源是一个不错的选择。

如果您因为管理层的反对而不喜欢开源，那么您将使用许可产品。

使用开源，您希望确保获得的东西具有一定的使用寿命。标志是充满活力的开发人员和用户社区、轻松获得论坛支持、软件的定期更新、基于标准的可用替代方案等。您不想为基础设施等基础设施做出选择并后悔一年后来因为开源项目已经分崩离析。

ESB 可以扮演很多角色：

1.  与外部方的 B2B 网关
2.  服务之间的消息传递
3.  格式之间的转换（EDI、XML 等）
4.  服务编排
5.  交叉关注点的集中化，如审计、日志记录、指标等。

您需要做出谨慎的决定来满足所有这些需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T02:42:07.820

我对他们的产品一无所知，但[松散耦合与解耦......](http://blogs.progress.com/soa_infrastructure/2008/04/loose-coupling.html)简要讨论了一个经常被忽略的重要点，并且稍后可能会非常难受。

我担心 BizTalk 正在被 Microsoft 内部的 .Net 类型所取代，并且可能会朝着 WCF 紧密绑定的接口方向发展。多读书，多问问题。不要期望太多的开源产品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T15:18:48.740

除其他问题外，鉴于 ESB 设计模式的性质，性能非常重要。那里发表了许多结果。这是 2013 年 1 月完成的[最新一轮 ESB 性能](http://wso2.org/library/articles/2013/01/esb-performance-65)。然而，在性能领域，建议运行您自己的性能测试并选择您的选择，而不是依赖于已发布的内容。

除了性能、易用性、可扩展性之外，还需要考虑通过 ESB 集成系统所需的开发工作量。有时，您可能会开始与 ESB 集成，随后，随着系统的发展，管理解决方案的能力、安全性、监控能力、计量和计费能力、支持的连接器数量将会显现出来。因此，您可能需要注意围绕 ESB 的相关解决方案。

通常，与任何软件一样，总拥有成本 (TCO) 也是关键。有时，从一个供应商开始似乎成本较低，但随着时间的推移，成本可能会激增。特别是，考虑到 ESB 使用的核心特性，可支持性和可维护性很重要。

# python - 实施科赫曲线？

> ID：932222
> 
> 赞同：3
> 
> 时间：2009-05-31T15:24:10.507
> 
> 标签：python, fractals

我正在查看 Koch Snowflake 的 wikipedia 页面（[此处](http://en.wikipedia.org/wiki/Koch_snowflake)），并被所有采用徽标/海龟样式的示例所困扰。所以我开始制作我自己的返回列表或坐标的。

我的实现是在 python 中，我基本上撕掉了 python turtle 的实现，但是用基本的 trig 替换了海龟特定的东西。它导致了一些丑陋的代码。我对你的挑战是要么改进我的代码，要么自己想出一个更优雅的解决方案。它可以是 python，也可以是你最喜欢的语言。

我的代码：

```
from math import sin, cos, radians

def grow(steps, length = 200, startPos = (0,0)):
    angle = 0
    try:
        jump = float(length) / (3 ** steps)
    except:
        jump = length

    set="F"
    for i in xrange(steps): set=set.replace("F", "FLFRFLF")

    coords = [startPos]
    for move in set:
        if move is "F": 
            coords.append(
              (coords[-1][0] + jump * cos(angle),
               coords[-1][1] + jump * sin(angle)))
        if move is "L":
            angle += radians(60)
        if move is "R":
            angle -= radians(120)

    return coords 
```

编辑：由于懒惰复制，我忘记了导入

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T17:25:20.963

我不认为它特别难看，我只会逐步重构它，例如作为第一步（我已经删除了，`try/except`因为我不知道你想要防止什么......如果它需要回到它应该更明确一点，恕我直言）：

```
import math

angles = [math.radians(60*x) for x in range(6)]
sines = [math.sin(x) for x in angles]
cosin = [math.cos(x) for x in angles]

def L(angle, coords, jump):
    return (angle + 1) % 6
def R(angle, coords, jump):
    return (angle + 4) % 6
def F(angle, coords, jump):
    coords.append(
        (coords[-1][0] + jump * cosin[angle],
         coords[-1][1] + jump * sines[angle]))
    return angle

decode = dict(L=L, R=R, F=F)

def grow(steps, length=200, startPos=(0,0)):
    pathcodes="F"
    for i in xrange(steps):
        pathcodes = pathcodes.replace("F", "FLFRFLF")

    jump = float(length) / (3 ** steps)
    coords = [startPos]
    angle = 0

    for move in pathcodes:
        angle = decode[move](angle, coords, jump)

    return coords 
```

如果需要第二步，我可能会将这个功能整合到一个类中，但我不确定这会使事情变得更好（或者，实际上更好；-）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-14T17:13:00.840

我非常喜欢你的问题，所以我将它的答案作为一个新问题发布，以便其他人可以改进它：

[https://stackoverflow.com/questions/7420248](https://stackoverflow.com/questions/7420248)

我没有使用 Logo/Turtle 的东西，也没有使用三角函数。

恭喜您成为第一个将这个问题带到 StackOverflow 的人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-09T08:07:10.973

Mathematica 在数学方面更胜一筹：

```
points = {{0.0, 1.0}};
koch[pts_] := Join[
    pts/3,
    (RotationMatrix[60 Degree].#/3 + {1/3, 0}) & /@ pts,
    (RotationMatrix[-60 Degree].#/3 + {1/2, 1/Sqrt[12]}) & /@ pts,
    (#/3 + {2/3, 0}) & /@ pts
];
Graphics[Line[Nest[koch, points, 5]], PlotRange -> {{0, 1}, {0, 0.3}}] //Print 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-01T02:59:16.770

需要考虑的一点是，如果不是为了您的实现，那么为了测试您的实现，Python turtle 可以记录它正在做什么并给您返回坐标。您使用`begin_poly()`和`end_poly()`围绕您要记录的代码，然后使用它`get_poly()`来获得积分。

在此示例中，我将根据[此站点的代码](http://openbookproject.net/thinkcs/python/english3e/recursion.html)绘制雪花，然后将这些坐标注册为新的海龟形状，我将随机（并快速）在屏幕上标记：

```
import turtle
from random import random, randrange

def koch_curve(turtle, steps, length):
    if steps == 0:
        turtle.forward(length)
    else:
        for angle in [60, -120, 60, 0]:
            koch_curve(turtle, steps - 1, length / 3)
            turtle.left(angle)

def koch_snowflake(turtle, steps, length):
    turtle.begin_poly()

    for _ in range(3):
        koch_curve(turtle, steps, length)
        turtle.right(120)

    turtle.end_poly()

    return turtle.get_poly()

turtle.speed("fastest")

turtle.register_shape("snowflake", koch_snowflake(turtle.getturtle(), 3, 100))

turtle.reset()

turtle.penup()

turtle.shape("snowflake")

width, height = turtle.window_width() / 2, turtle.window_height() / 2

for _ in range(24):
    turtle.color((random(), random(), random()), (random(), random(), random()))
    turtle.goto(randrange(-width, width), randrange(-height, height))
    turtle.stamp()

turtle.done() 
```

如果您不希望用户看到此步骤，您可以在多边形生成期间隐藏笔和海龟。

[![在此处输入图像描述](https://i.stack.imgur.com/gwDgc.png)](https://i.stack.imgur.com/gwDgc.png)

# ms-word - 如何在 Word 2007 中最好地显示代码示例？

> ID：932223
> 
> 赞同：3
> 
> 时间：2009-05-31T15:24:46.603
> 
> 标签：ms-word

我希望代码示例具有行号、边框、背景颜色和快递。代码示例应该能够跨页，因此文本框可能不是最佳解决方案。是否有可用的样式表来执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T19:04:00.527

你在使用 Visual Studio 吗？如果是这样，那么您应该能够将其从 VS-IDE 剪切并粘贴到 word 中。由于 VS-IDE 代码 Copy 是富文本格式，因此 Word 将在粘贴时保留格式。我一直这样做（包括 SQL），它比我来的任何其他方法都好得多跟上。

（如果你没有使用 Visual Studio，那么对不起，我不知道。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T15:27:40.110

虽然它不是最好的做事方式，但一种流行的方法是在您最喜欢的编辑器中截取窗口的屏幕截图并将图像嵌入到 Word 文档中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T20:27:37.957

粘贴 -> 特殊 -> 无格式文本？

# parsing - 重构布尔方程

> ID：932226
> 
> 赞同：1
> 
> 时间：2009-05-31T15:25:32.873
> 
> 标签：parsing, boolean, expression, equation

假设您有一个像这样的布尔规则/表达式

```
(A OR B) AND (D OR E) AND F 
```

您想将其转换为尽可能多的 AND 表达式，就像这样

```
A AND D AND F
A AND E AND F
B AND D AND F
B AND E AND F 
```

你只是在减少 OR，所以它变成了

```
(A AND D AND F) OR (A AND E AND F) OR (...) 
```

布尔代数中是否有可以做到这一点的属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T15:30:25.563

看看[德摩根](http://hyperphysics.phy-astr.gsu.edu/HBASE/electronic/demorgan.html)定理。该链接指向与电子门有关的文档，但理论保持不变。

它说任何逻辑二进制表达式保持不变，如果我们

1.  将所有变量更改为它们的补码。
2.  将所有 AND 操作更改为 OR。
3.  将所有 OR 操作更改为 AND。
4.  取整个表达式的补码。

（引用上述链接文件）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T15:56:28.220

您的示例正在利用 AND 对 OR 的分布性，如此处[所示](http://en.wikipedia.org/wiki/Boolean_algebra_(introduction)#Laws)。

您需要做的就是依次应用它。例如，使用`x*(y+z) = (x*y)+(x*z)`（其中 * 表示 AND，+ 表示 OR）：

```
0\. (A + B) * (D + E) * F
1\. Apply to the first 2 brackets results in ((A+B)*D)+((A+B)*E)
2\. Apply to content of each bracket results in (A*D+B*D)+(A*E+B*E)
3\. So now you have ((A*D+B*D)+(A*E+B*E))*F
4\. Applying the law again results in (A*D+B*D)*F+(A*E+B*E)*F
5\. Apply one more time results in A*D*F+B*D*F+A*E*F+B*E*F, QED 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T17:02:04.983

您可能有兴趣阅读有关[卡诺图](http://en.wikipedia.org/wiki/Karnaugh_map)的内容。它们是简化布尔表达式的工具，但您也可以使用它们来确定所有单独的表达式。我不确定您如何将其概括为可以编写程序的算法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T18:39:20.797

您可能对[Conjunctive Normal form](http://en.wikipedia.org/wiki/Conjunctive_normal_form)或其兄弟[Disjunctive normal form](http://en.wikipedia.org/wiki/Disjunctive_normal_form)感兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T15:34:20.983

据我所知，布尔代数不能仅使用 AND 和 OR 运算来构建。如果您只有这两个操作，您将无法接收 NOT 操作。

您可以将任何表达式转换为**完整**的布尔运算集。

这是一些完整的套装：

*   与与非
*   OR 和 NOT

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T15:46:18.923

假设您可以使用 NOT 操作，您可以仅使用 AND 或仅使用 OR 来重写任何布尔表达式。在你的情况下：

```
(A OR B) AND (D OR E) AND F 
```

我倾向于对上述内容使用工程速记并写道：

*   并且作为产品（。或什么都没有）；
*   或作为总和 (+)；和
*   不作为单引号 (')。

所以：

```
(A+B)(D+E)F 
```

算术的推论实际上对于分解项非常有用。

根据[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan's_laws)：

```
(A+B) => (A'B')' 
```

因此，您可以将表达式重写为：

```
(A+B)(D+E)F
(A'B')'(D'E')'F 
```

# c# - 文本框中更改值的问题

> ID：932230
> 
> 赞同：0
> 
> 时间：2009-05-31T15:26:20.050
> 
> 标签：c#, winforms

简化我有一个文本框和一个按钮 该按钮只是使用文本框中的文本创建一个消息框。但是我更改了文本框的值，出现了新值（例如：键入 123），但消息框不显示该值。

如果我尝试在编程中使用该值（通过 textbox1.text 获取值）该变量什么都没有（textbox1.text = ""）但我仍然可以看到我在表单中输入的内容。

有人有任何线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T15:44:39.640

您的按钮的单击事件处理程序应如下所示

```
private void button_Click(object sender, EventArgs e)
{
MessageBox.Show(textBox.Text);
} 
```

我怀疑您已经有与此类似的代码，并且在某些时候文本框被清除或设置为 String.Emppty 但没有看到实际代码很难帮助您

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T07:02:11.653

您何时/何处检查 textBox1.Text 的值？如果您在构造函数、Form1_Load 或在您输入文本*之前发生的任何其他事情中检查它，您将得到一个空值。*

要正确检查 textBox1.Text 的值，您应该在调用 MessageBox.Show(textBox1.Text) 的行上设置所谓的断点。为此，请单击包含 MessageBox.Show(..) 的行的源代码编辑器的灰色区域（位于最左侧）。将出现一个红色圆圈，您的代码应突出显示。当您运行应用程序并单击按钮时，您的应用程序应该暂停，Visual Studio 将突出显示该行，从这里您可以将鼠标悬停在 MessageBox.Show() 行中的“textBox1.Text”上，它应该向您显示当前值.

如果您的应用程序与表单、文本框和您的 button1_Clicked 事件处理代码一样简单，那么这应该没有问题。如果不是这么简单，那么您需要在代码中查找设置 textBox 值的任何内容，并确保它没有使用断点传递任何空白值。

但是，要正确解决这个问题，我们确实需要更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T11:47:48.300

感谢 Eric 和 Crippledsmurf。正如你们俩所说，没有代码很难提供帮助。我发现的问题是，在调用表单时，我通过引用发送了一些对象，所以我可以追踪它们，我发现当（不要问我为什么会这样，我还在努力）构造函数被称为他制作了一个新组件，因此界面中的组件不再代表变量“textbox1”所指向的那个（是Crash893，我没有拼错名字）。

我发现我在引用方面弄得一团糟，这可能是导致问题的原因。我通过更改代表和事件的引用执行的操作来解决问题，但我无法找到问题的确切来源。

再次感谢大家的见解。

# project-management - 您如何管理争夺有限资源的多个客户需求

> ID：932232
> 
> 赞同：0
> 
> 时间：2009-05-31T15:27:09.987
> 
> 标签：project-management

所以我为一个内部开发团队管理项目。那就是我们所有的客户都是企业内部的。

我试图找出他整理请求和分配我们拥有的资源的最佳方式。（不幸的是，企业并没有为开发人员提供无穷无尽的预算，但他们仍然希望一切都完成）

我想做某种积压和功能规划，但我如何跨多个客户和多个产品做到这一点。

最后但并非最不重要的紧急请求。有人说我们明天需要这个，你怎么处理。我似乎每周都有一个，我们可以做到这一点，我们永远不会吃掉功能积压。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T15:45:35.943

根据子项目的合作程度，您可以按单一优先级顺序管理功能和积压工作（因此，组织最重要的任务是第一位的 - 透明，但决策者必须能够集中注意力优先级），或拆分时间/团队，然后在分配给客户端的时间或资源片内与每个客户端管理优先级。在整个组织范围内，这不是最有效的方式，但是一旦做出这个艰难的决定，您就可以自由地独立管理每个项目。

紧急请求也是如此。一个开明的组织将能够在不同的部门中对此进行优先级排序 - 即紧急安全修复对任何功能进行排名而不考虑所有权，但更有可能的是“紧急”内容将作为分配给客户的“切片”的一部分完成，或者根据“紧急请求者”可以产生多少压力。

看起来你正在发生很多变化。如果您还没有使用敏捷过程，例如 XP，您应该尝试 - 至少管理需求/功能并经常交付部件。随着从任务到任务的进展变得更加明显，经常交付更改也可以减轻您的一些压力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T15:56:00.530

我同意 MaxVT 的观点，即您可能希望查看 XP 之类的东西，因为即使您正在交付功能有限的程序，它们仍然会得到一些可以提供帮助的东西。

您可能还想根据积压清单中已有的内容，开始为提出要求的人设定期望。

这意味着您应该与开发人员一起检查您的积压工作，并确定需要完成哪些任务，并为每个任务分配时间。这将提供一种方式来说明项目 A 有 x 小时，所以你可以告诉别人你什么时候可以完成它。

通过敏捷，您可以查看必须实现哪些功能才能使应用程序有用，然后让应用程序达到这一点。然后，您可以以某种优先方式跟踪要添加的功能，因此您首先实现最重要的功能，然后当您有时间向它添加更多功能时。

了解每个功能必须做什么以及需要花费多少时间将更好地帮助您进行项目管理，并为您生成报告给您上面的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T16:10:20.810

当您的资源有限且紧急情况占用了您的大部分时间时，您可以做的最好的事情之一（除了处理紧急情况）就是使效果可见，以便您拥有与利益相关者进行更高级别讨论的数据（例如，“这真的是紧急情况吗？可以做些什么来防止这成为紧急情况？”等）

在考虑优先待办事项时，您走在正确的轨道上，部分原因是关于优先事项的讨论是您可以（或可能能够）推回内部客户的讨论。

紧急情况“免排队！” 工作，我见过的一件事是使用“红牌”，要么将它们直接跳过到队列的最前面，要么将它们限制为一次只有一个在进行中，这样你就可以取得进展与不在紧急情况下工作的团队的其他成员一起进行非紧急情况工作。

无论您采取何种方法，一个关键部分是收集足够的数据以支持与您的客户进行数据驱动的讨论。以最简单的形式，让团队粗略估计待办事项中每个项目的大小，这样您就可以跟踪每周完成的工作量以及待办事项中的工作量。几周后，您将获得支持数据提供给您的老板，以支持“我们将 90% 的时间用于处理紧急情况。我们将如何处理？” 讨论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T00:51:40.213

一切都在调度和资源中（稍后将详细介绍资源）。您的问题还有一个方面的变更控制。

**调度**

我使用谷歌电子表格是因为它很简单，每个人都对它感到舒服/熟悉，而且每个人都可以同时访问它（它也是免费的！）。

如果您看下面的图片，您会看到有一个“分配给”列 - 这是程序员的初始值。你会有多个这样的时间表，每个项目一个。

![替代文字](https://1.bp.blogspot.com/_TUs17IBrSL4/SIM_POgz93I/AAAAAAAAACw/Ckaihs1RXGw/s400/blog_pic_03.png)

在第二张图片中，您可以看到一些摘要。包括程序员在项目上分配了多少小时。这使您可以计划他们何时可以参与另一个项目。

![替代文字](https://2.bp.blogspot.com/_TUs17IBrSL4/SINAVA28OOI/AAAAAAAAAC4/woJhPR-BrqM/s400/blog_pic_01.png)

本文的其余部分在这里 ->[使用 Google 电子表格的项目时间表](http://pm4web.blogspot.com/2008/07/google-spreadsheets-for-project.html)

**资源**

您可能已经制定了项目时间表，但是如果您所有的内部程序员都已经忙于项目，您会怎么做？你实际上已经没有资源了。这就是外包承包商可以提供帮助的地方。如果你没有这方面的预算，那么人们只需要等到程序员离开他们被分配到的项目（例如“对不起老板，但格雷格不会再完成他当前的项目 2 周。如果你想让他离开那个项目，我们可以，但是那个项目会延迟交付”<-祝你好运:)

**错误管理和变更控制**

也有错误管理和变更控制的方法，但我不想深入了解它们，然后说每周花 2-3 个小时进入每个程序员的 Outlook 日历进行调试。将功能运进来，收集 5-10 个并记录它们，然后再将它们交给程序员进行编码（用它们制作一个包，如 v1.1）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-07T10:06:47.267

这有两个方面，实际的和政治的。第一个是直截了当，第二个是一团糟。

其中一些听起来是可怕的管理/营销胡说八道，所以我提前道歉，但这很好。

为了在实践层面上对优先级进行排序，我从对努力和收益的高层次评估开始，每一个都在 1 到 10 的范围内，然后将它们绘制在矩阵上（X 轴上的努力，Y 轴上的收益）。业务必须评估收益（并证明其合理性），IT 团队和业务共同评估工作量（业务团队不会弄乱 IT 的估计，但他们可能需要自己增加时间）。

从广义上讲，高努力低收益象限（右下）中的任何东西都会立即被杀死 - 太多而太少。任何高努力、高收益（右上）都被归类为重大项目，需要进一步调查，因为这些通常是您发现一项或其他评估的地方。任何高收益低努力（左上角）都是快速获胜并跃居榜首。最后，低努力低收益（左下）是问号。与主要项目一样，这些需要进一步检查，尽管在这种情况下，您试图将它们变成一个快速的胜利（您可能能够修改范围以增加收益或减少工作量）或表明它们'实际上，工作量比人们想象的要多，应该被杀死。

但一般来说，事情越接近左上角（低努力，高收益），就应该越早完成。

一件关键的事情 - 所有信息和整个矩阵都是公开的 - 如果存在分歧，开发人员只是管理流程，而不是对其进行裁决。每周发布最新的矩阵（和由此产生的时间表），并在所有相关方之间定期通话，以确保每个人都同意它。

这涉及到政治方面——你知道某事是在浪费时间，但它是被某个非常重要的人要求的。理想情况下，这是您的经理获得保留的地方，但通常如果您有一个透明的流程（即收益/努力得分和矩阵都是公开的），那么推动不值得的事情的人要么会（a）挣扎，因为其他人回击指出他的改变是垃圾，根本不应该发生，更不用说优先考虑了，或者（b）有足够的影响力，这并不重要，但至少你被覆盖为其他会向你施加压力的人理解那。

透明的流程是您处理最后一分钟请求的方式。如果每个有请求的人都知道他们在队列中的哪个位置，那么人们在没有通知的情况下将东西放入对其他人来说会变得更加困难，因为他们不仅会惹恼开发人员，还会惹恼他们的同行并推迟他们的项目。

一般来说，那些这样做的人要么有足够的影响力，以至于你无论如何都无法阻止它，要么会激怒其他要求改变的人，以至于他们将被迫尽量减少他们的不良行为。

这些最后一分钟问题的一个有趣的子集是时间相关的项目，即如果在本周完成比等待六个月的好处更大的项目。一个例子可能是在立法税收变化之前有三个月的窗口，该项目将允许公司利用这一点。

在这种情况下，该项目会根据其最大可行收益进行评估，然后在将其放入进度表时对其进行重新评估-因此，如果具有最大收益，明天就会发生，那就太好了，但是即使具有最大收益，也不会在两个月内发生根据该时间点将提供的收益放弃收益并重新评估（通常这会杀死它）。

简而言之：

*   良好的收益/努力评估允许您选择对业务产生最大积极影响的那些
*   由开发商管理而不是裁决的透明明确的过程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T16:55:53.273

如果是为外部客户开发，我会说您需要为“紧急”请求收取更多费用。然而，除了改变您组织的内部收费模式（以及您的 F&A 分支机构），您在这方面无能为力。

你有一个很好的理由再引入一名开发人员，但当然，$$$ 总是很紧张。

坦率地说，我喜欢 FogBUGZ（公平地说，还有其他案例/事件跟踪器，FB 是我的最爱）。我可以快速查看队列中的内容及其优先级（无论项目/客户如何）。

我给你的其他建议是：

1.  宣传您的工作队列的大小。可能需要一些内部保密，但也许您可以在墙上/网站上发布您在旅途中拥有的所有项目。

2.  获取现有项目的组织优先级。您组织中的某个人必须知道什么时候需要什么，什么是最重要的——无论是经理、首席执行官还是董事会。
    .
    其他一切都排在队列的末尾。
    .
    如果 Bob 有紧急请求，而您正在处理 Jim 和 Mary 的请求；让鲍勃先经过玛丽和吉姆，以获得允许在队列中跳过他们（或者如果有必要超过他们的头）。
    或者，Bob 可以选择将队列中较高的一个或多个项目下推，并将其替换为他的紧急请求。无论哪种方式，它都会对紧急请求产生固有的额外成本。那些不是真正紧急情况的事情往往不再被称为紧急情况。有点像 ER 行“即使您不需要立即将每个实验室请求标记为 STAT”

例如，

```
[Jim1] <- [Mary1] <- [Bob1] <- [Jim2] <- [Jim3]
[Jim1] <- [Mary1] <- [Bob1] <- [Jim2] <- [Jim3] <- [Bob2]
                       |-------------swap-------------|
[Jim1] <- [Mary1] <- [Bob2] <- [Jim2] <- [Jim3] <- [Bob1] 
```

您的内部（和外部）客户的答案几乎总是肯定的（有时出于技术原因否定）。但是，“是”后面总是跟着“但是”。

```
You - Yes bob, we can work on that project for you, but we can't start until 
around X months from now.

bob - That's not good enough

You - OK, you have a couple options. If you want to shift some of your other 
requests around we can push it to the start of your queue, that would get it 
started in Y months. 

Bob - Still not good enough

You - Well, you can negotiate with Jim and Mary to leapfrog their projects.

Bob - They won't budge

You - Then go over their heads, and talk to Mr. Dithers`

[some time later]

You - Yes Mr. Dithers, we can work on Jim's requests. You are aware that will 
push back Jim and Mary's requests.

Mr. Dithers - Yup.

You - Aye-Aye Capt'n.

[some time later]

Jim - Why the $%#$%#$5 aren't you working on my request

You - Talk to Mr. Dithers 
```

请记住，如果一切都是重中之重，那么没有什么是重中之重。

**编辑：**
除了 FogBUGZ（因为你问过），它不仅仅是问题/错误跟踪。您也有功能请求、查询和计划项目（您可能需要升级到最新版本才能利用这些功能）。充分利用它。

确保您在 FB 中包含您的功能请求。您转入 FB 的次数越多，它给您的图片就越好。请记住使用过滤器和网格视图。

FB 有一个维基。在那里发布您的小组高级工作列表以供所有人查看。

# c++ - 如何对大文本文件运行字典搜索？

> ID：932237
> 
> 赞同：1
> 
> 时间：2009-05-31T15:27:43.807
> 
> 标签：c++, regex, string, grep

我们正处于发布主机游戏的最后阶段。当然，在 Wii 上，我们在内存方面遇到的问题最多，所以我们正忙于寻找草率的编码、打包位等等。

我已经完成了内存转储并使用 strings.exe（来自 sysinternals）来分析它，但它提出了很多像这样的垃圾：

```
''''$$$$    %%%%
''''$$$$%%%%####&&&&
''''$$$$((((!!!!$$$$''''((((####%%%%$$$$####((((
''))++.-$$%&''))
'')*>BZf8<S]^kgu[faniwkzgukzkzkz
'',,..EDCCEEONNL 
```

我对这样的字符串更感兴趣：

```
wood_wide_end.bmp
restroom_stonewall.bmp 
```

...这意味着我们仍在嵌入一些需要转换为 ID 的字符串。

所以我的问题是：有什么好的方法可以找到我们可以消除的调试数据？

我可以做一些 rx 来破解符号或只搜索某些类型的字符串。但我真正想做的是获取一个标准字典文件并根据它搜索我的字符串文件。如果我要使用 aardvaark|almony|archetype 等构建一个大 rx，这似乎很慢。或者，如果我为它做一个 .NET 编译的 rx 程序集，它会工作得很好吗？

寻找关于如何找到我们想要消除的东西的其他想法。快速而肮脏的解决方案，不需要优雅。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T16:16:22.307

首先，我会得到一个很好的单词表。 [这个 NPL 页面](http://www.puzzlers.org/dokuwiki/doku.php?id=solving:wordlists:about:start)有一个很好的列表，包含不同大小和来源的单词列表。我要做的是为单词列表中的所有单词构建一个哈希表，然后根据单词列表测试输出的每个单词`strings`。这在 Python 中很容易做到：

```
import sys

dictfile = open('your-word-list')
wordlist = frozenset(word.strip() for word in dictfile)
dictfile.close()

for line in sys.stdin:
    # if any word in the line is in our list, print out the whole line
    for word in line.split():
        if word in wordlist:
            print line
            break 
```

然后像这样使用它：

```
strings myexecutable.elf | python myscript.py 
```

但是，我认为您将注意力集中在错误的地方。消除调试字符串的收益非常递减。尽管消除调试数据是任天堂要求您执行的技术认证要求，但我认为他们不会因为您的 ELF 中有几个额外的字符串而拒绝您。

使用分析器并尝试确定您使用最多内存的位置。如果您将精力集中在正确的位置，很有可能会有一种方法可以轻松地节省大量内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T16:01:48.080

这听起来像是支持正则表达式的快速而肮脏的脚本的理想任务。如果是我，我可能会很快在 python 中做一些事情。

下面是我将如何进行：每次遇到字符串（来自 strings.exe 输出）时，提示用户他们是想在字典中记住它还是永久忽略它。如果用户选择永久忽略该字符串，那么以后遇到它时，不要提示用户并丢弃它。您可以选择保留一个反字典文件，以便在以后运行脚本时记住这一点。建立字典文件并为每个字符串保留一个计数或您想要的任何其他信息。可以选择按字符串出现的次数排序，这样您就可以专注于最严重的违规者。

这听起来像是学习脚本语言的理想任务。我不会打扰 C#/C++ 或任何真正花哨的东西来实现它。

# c# - 将远程对象传递给 C# 中的远程方法

> ID：932239
> 
> 赞同：0
> 
> 时间：2009-05-31T15:28:12.697
> 
> 标签：c#, remoting

我试图将远程对象作为参数传递给远程方法，但是当远程对象尝试在接收到的远程对象上运行方法时，我得到了一个安全异常。

这是一个示例远程对象：

```
public class SharpRemotingDLL : MarshalByRefObject
{
    public String getRemoteMessage(SharpRemotingDLL server)
    {
        // the exception is raised here
        return server.getMessage();
    }

    public String getMessage()
    {
         return "Hello World!";
    }
} 
```

这是服务器启动器（其中两个实例正在运行，一个在 127.0.0.10025 上，另一个在 127.0.0.10026 上）：

```
public static int Main(string[] args)
{
    TcpServerChannel channel;
    channel = new TcpServerChannel(10025);
    ChannelServices.RegisterChannel(channel, false);
    RemotingConfiguration.RegisterWellKnownServiceType(
        typeof(SharpRemotingDLL),
        "SharpRemotingDLL",
        WellKnownObjectMode.Singleton);
    Console.ReadLine();
    return 0;
} 
```

这是客户端：

```
static void Main(string[] args)
{
    SharpRemotingDLL server0 = (SharpRemotingDLL)
        Activator.GetObject(typeof(SharpRemotingDLL),
        "tcp://localhost:10025/SharpRemotingDLL");
    SharpRemotingDLL servers[1] = (SharpRemotingDLL)
        Activator.GetObject(typeof(SharpRemotingDLL),
        "tcp://localhost:10026/SharpRemotingDLL");
    Console.WriteLine(server0.getRemoteMessage(server1));
} 
```

如何正确地将 server1 作为参数传递给 getRemoteMessage 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T16:53:51.190

我以前写过这种代码，但我从来没有尝试过以这种方式将一个服务器对象传递给另一个服务器对象。我不是安全专家，但我能理解为什么不允许这样做。

您应该直接从 Server1 获取消息，而不是要求另一个远程服务器返回它。换句话说，您的消息检索逻辑需要在客户端中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T18:57:09.293

维比贾尼，

这篇文章应该对您的问题有所了解：

[http://weblogs.asp.net/jan/archive/2003/06/01/8106.aspx](http://weblogs.asp.net/jan/archive/2003/06/01/8106.aspx)

如果这不起作用，您可以在此处获得几个相关的 Google 点击：

[由于安全限制，无法访问类型 System.Runtime.Remoting.ObjRef](http://www.google.com/search?hl=en&q=Because+of+security+restrictions%2C+the+type+System.Runtime.Remoting.ObjRef+cannot+be+accessed&btnG=Search&aq=f&oq=&aqi=g1)

# javascript - 谷歌地图 - 标记点击加载窗口

> ID：932240
> 
> 赞同：2
> 
> 时间：2009-05-31T15:28:20.497
> 
> 标签：javascript, google-maps

我正在尝试创建一个带有多个标记的谷歌地图，当单击标记时会加载警报。

```
var map = null;
function setupMap() { 

    map = new GMap2(document.getElementById("map")); 
    map.setUIToDefault();
    map.setCenter(new GLatLng( 0, 0 ), 1); 
    map.enableDoubleClickZoom(); 

    // Create the marker icon - will be repeated for each icon but
    // truncated for brevity in example
    var icon1 = new GIcon(G_DEFAULT_ICON);
    icon1.image = "uploads/1.jpg";
    icon1.shadow = "";
    icon1.iconSize = new GSize( 50, 50 );

    var latlng = new GLatLng( 0, 0 );
    markerOptions = { icon:icon1 };     
        marker1 = new GMarker( latlng, markerOptions );
    map.addOverlay( marker1 );
    GEvent.addListener( marker1, "click", loadInfo(1) );    

} 

function loadInfo( a ) {
    alert( a );
}

window.onload = setupMap; 
```

在工作示例中，我将标记对象传递给 loadInfo()，然后加载一个 InfoWindow，但现在，我只是尝试在单击标记时执行操作。实际发生的是，当地图加载时，正在加载一个警告框（如预期的那样，其中包含“1”）。多个标记不会加载多个警报框，并且在初始警报框已加载（我不想要）之后，单击标记不会执行任何操作。

非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T15:40:56.960

在您的`addListener`调用中，您实际上是在调用`loadInfo`而不是传递对它的引用。请尝试以下操作：

```
GEvent.addListener( marker1, "click", function() { 
  loadInfo(1); 
}); 
```

这将创建一个包装您`loadInfo`的方法的匿名函数，在执行匿名函数时调用该方法。

或者，如果您没有在 中使用任何参数`loadInfo`，只需删除括号也可以：

```
GEvent.addListener( marker1, "click", loadInfo); 
```

Something worth keeping in mind when using such function references is the scope in which it will be called. If you were to use the `'this'` reference, you'll run into the situation where `'this'` within the callback function will in fact not refer to the scope in which it was created, but to the scope within which it's being executed which most likely will not contain the fields or methods you're expecting to call, resulting in errors stating `Undefined` instead. As Jonathan points out, you'll have to use the `call()` and `apply()` methods to bind explicitly to ensure your function executes within the correct scope.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T15:37:51.110

您在 .addListener 中调用 loadInfo，而不是提供对它的引用。

```
GEvent.addListener( marker1, "click", loadInfo(1) ); 
```

尝试：

```
function wrap(method) {
    var args = Array.prototype.slice.apply(arguments,1);
    return function () {
         return method.apply(this,args);
    }
}

GEvent.addListener( marker1, "click", wrap(loadInfo,1) ); 
```

有关将参数绑定到函数的更多信息，请参阅[http://www.alistapart.com/articles/getoutbindingsituations](http://www.alistapart.com/articles/getoutbindingsituations)。另请参阅[https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/apply)了解有关非常有用的 apply() 的更多信息（也建议您查看 call() ）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T15:41:26.740

`loadInfo(1)` means execute this function immediately, but you need to pass a callback function to the GEvent.addListener() method. For that, you can use anonymous function:

```
GEvent.addListener( marker1, "click", function() { loadInfo(1) }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-21T10:29:23.563

Even though GEvent.addListener( marker1, "click", function() { loadInfo(1); }); was used, am not getting link to the marker to move next

# assembly - 本机可执行文件的哪一部分（特别是）使其不可移植？

> ID：932241
> 
> 赞同：6
> 
> 时间：2009-05-31T15:28:37.330
> 
> 标签：assembly, code-generation, linker, cpu-architecture

起初这听起来像是一个愚蠢的问题，但请耐心等待。

众所周知，一种 CPU 架构的二进制文件不会在其他架构上运行。例如，不可能在 sparc64 芯片上运行 x86 二进制文件（没有某种兼容层）。指令集是不同的，所以很明显这是行不通的。

但是，当二进制文件用于同一个 CPU，但用于不同的操作系统时，代码的哪一部分会阻止执行。例如，在 x86 Linux 机器上运行 x86 Solaris 二进制文件。我假设存在某种与运行时链接器或进程调度器相关的平台特定存根？

我很想知道。谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-31T15:37:26.693

有很多原因。主要的，按“与金属的距离”排序的是：

1.  操作系统对于可执行文件可能具有不同的二进制格式。在这种情况下，您将无法首先加载二进制文件。
2.  程序可以使用另一种方法来表明他们希望进行系统调用（例如 INT21 与 INT80）。
3.  该程序可能依赖于其他操作系统中不存在的系统调用（例如 dlopen()）
4.  该程序可能依赖于其他操作系统上不存在的标准库。
5.  该程序可能依赖于其他操作系统上不可用的其他库。

当然，在意想不到的环境中运行的程序可能会以多种方式严重失败。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T15:39:42.840

有四个问题：

1.  不同的操作系统以不同的方式打包它们的二进制可执行文件（例如 Linux ELF 与 Windows 格式）；
2.  不同 CPU 架构上的不同指令集；
3.  不同的操作系统有不同的系统调用（例如 Win32 中的 CreateProcess() 与 Linux/Unix 中的 fork()）；
4.  路径、合法字符、目录分隔符等差异。

假定两者都存在非系统库，否则这是另一个区别。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T15:32:51.813

主要是API。例如，Win32 API 在 Linux 上并不真正可用。不过，有可能解决这个问题，请参阅[Wine](http://www.winehq.org/)。可执行格式也可能不同（ELF/PE），但可以很容易地修复（Wine 可以做到这一点；它允许 PE 可执行文件在 Linux 上执行）。

此外，您的 Solaris 和 Linux 可执行文件混合示例将相当容易实现，因为操作系统非常相似（ELF 表示可执行格式、POSIX API、X 窗口系统等）。FreeBSD 已经可以运行 Linux 可执行文件。这种情况不常见的原因很简单，就是对它的需求不多。Windows 程序比 *NIX 程序多得多，因此创建了 Wine。Linux 程序比 FreeBSD 程序多得多，因此 FreeBSD 实现了 Linux 兼容层。Solaris 最终也可能实现类似的东西。但是，不要指望相反（Linux 上的 Solaris/BSD 可执行文件），因为没有需求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-06T12:48:22.820

除了二进制格式和其他“打包”功能（这也可能不完全是微不足道的）之外，您还可以在几乎每个代码片段中找到一些后果。像这样的东西

1.  PIC 可能会导致每个全局访问依赖于系统特定的重新加载 GOT 指针的假设，以及额外偏移量的假设。
2.  许多系统都有特定的 ABI，在寄存器中传递小结构，为对齐目的跳过寄存器，为特殊目的保留寄存器有些有几个（如 ARM EABI 和 OABI）
3.  线程本地存储相关问题，每个线程实例化的变量与操作系统指定的设施紧密耦合。寄存器选择，偏移量等。
4.  一些操作系统（最值得注意的是）窗口支持某种格式的异常处理，以允许跨语言甚至跨机器（通过 DCOM）异常处理。
5.  更高级别的跨程序系统（如 COM，还有 Mac 上的 Objective C 互操作性，或与某个 KDE-gcc 版本组合的兼容性）也可能对 VMT 布局有某些要求。
6.  一些链接器和格式支持对部分负偏移，有些则不支持。

请注意，这只是一些有趣的东西。它可能不完整，并且并非所有内容都适用。上面的某些点可能会重叠（例如，为 TLS 或 PIC 保留寄存器也是 ABI 更改）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T15:31:51.317

它是系统特定的库，并不总是可移植的。例如，您不能在 vanilla linux 上使用 win32 窗口 api（是的，我意识到有一些工作场所，例如 wine，它不是最好的例子）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T15:34:20.407

系统库和 API。实际的简单代码应该可以工作。这就是为什么像 Wine 这样的层不做任何 CPU 仿真，它们只是重新实现 Windows API。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-31T15:39:42.870

除了其他人所说的，可执行文件的实际格式可能有所不同。因此，当操作系统开始加载它时，它不会在文件的正确位置找到它期望的代码、数据段等值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-31T15:35:05.150

正如已经指出的那样，不兼容与可执行文件格式本身的关系不大，与可执行文件引用的库有关。

我相信 linux 实际上与许多不同的可执行格式兼容，尽管我在这里可能是错的

# asp.net - iis7下Web应用程序的许多appdomains

> ID：932244
> 
> 赞同：0
> 
> 时间：2009-05-31T15:29:54.957
> 
> 标签：asp.net, iis-7, castle-monorail

我有一个在 iis7 上运行的单轨 Web 应用程序。看起来两个并发请求是在两个不同的应用程序域上处理的！据我所知，每个应用程序都应该有一个appdomain和多个httpapplications来处理请求......

有什么我想念的吗？（也许是配置？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T07:42:49.463

看你自己找到了解决方案:)

Asp.net 监视大量目录和文件以执行不同的操作，这将导致 appdomain 卸载。（global.asax、web.config、BIN、App_Code ++）

如果您想了解更多信息，请查看 msdn blogs.msdn.com/tmarq/archive/2007/11/02/asp-net-file-change-notifications-exactly-which-files-and-directories 上的此博客被监控的.aspx

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T07:28:13.597

我正在将输出文件写入 Web 应用程序的 bin 目录中的文件夹。由于此文件夹被监视，它导致应用程序池回收，这就是第二个请求在不同（新）应用程序域上处理的原因。

出于某种原因，我认为只有 web.config，global.asax 被观看......

# jquery - jQuery - 如果数据库被更新，更新页面

> ID：932249
> 
> 赞同：2
> 
> 时间：2009-05-31T15:31:10.320
> 
> 标签：jquery, database, ajax

Righteo，刚开始弄乱Jquery，我可以用它更新数据库等，但我想知道是否有一种方法可以显示发布到数据库中的新信息（即使它不是刚刚发布的）而无需重新加载等等

不要为我写出来，只要给我指明正确的方向......我想自己把它放在一起......最好的学习方法：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T15:37:11.483

最简单的解决方案是定期轮询服务器。

如果您希望服务器推送给您，请使用[Comet](http://en.wikipedia.org/wiki/Comet_(programming))。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-21T10:47:38.210

```
 var dataString="variable="+variablevalue;
    // Check if there is any updates every 3 second.
    var x=setInterval(doUpdates,3000);

    function doUpdates() {
        $.ajax({
        type: 'POST',
        url: "yourfile.php",
        data: dataString,                 
        success: function(data) {
            $('#yourid').html(data)
            //This will update the HTML code.
        }
    }) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-31T15:34:28.193

唯一的方法是让网页定期轮询服务器以获取新信息。

无法从服务器端发起交互。

**编辑：**

没有办法，只能使用为您处理轮询的框架。

# python - Django 的搜索功能

> ID：932255
> 
> 赞同：2
> 
> 时间：2009-05-31T15:33:44.247
> 
> 标签：python, database, django, search, full-text-search

我正在使用 Django 开发一个网络应用程序，我很快需要添加搜索功能。搜索将针对两种模型实现，一种是 auth 用户类的扩展，另一种是具有`name`、`tags`和字段的`description`。所以我想在搜索文本的上下文中没有什么太可怕的了。

对于开发，我使用[SQLite](http://en.wikipedia.org/wiki/SQLite)，并且由于没有完成特定于数据库的工作，我可以自由地在生产中使用任何数据库。我正在考虑在[PostgreSQL](http://en.wikipedia.org/wiki/PostgreSQL)或[MySQL](http://en.wikipedia.org/wiki/MySQL)之间进行选择。

我在互联网上浏览了几篇关于搜索解决方案的帖子，但我想就我的简单案例征求意见。以下是我的问题：

1.  就我而言，全文搜索是否过大？

2.  依赖数据库的全文搜索支持会更好吗？如果是这样，我应该使用哪个数据库？

3.  我应该使用外部搜索库，例如[Whoosh](http://whoosh.ca/)、[Sphinx](http://en.wikipedia.org/wiki/Sphinx_%28search_engine%29)或[Xapian](http://en.wikipedia.org/wiki/Xapian)吗？如果有，是哪一个？

**编辑：** `tags`是一个位于 m2m 关系上的 Tagfield（来自 django-tagging 应用程序）。`description`是一个包含 HTML 的字段，最大长度为 1024 字节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T16:15:01.433

如果该字段的`tags`意思是我认为的意思，即您计划存储一个字符串，该字符串连接一个项目的多个标签，那么您可能需要对其进行全文搜索......但这是一个糟糕的设计；相反，您应该在项目和标签表之间建立多对多关系（在另一个表中，ItemTag 或其他东西，具有 2 个外键，它们是项目表和标签表的主键）。

我不知道您是否需要全文搜索，`description`因为我不知道它是什么 - 也不知道您是否需要 MySQL 5.1 和 PostgreSQL 8.3 提供的合理但有些基本的全文搜索，或者更强大的一个在例如狮身人面像...也许多谈谈您的应用程序的上下文以及您为什么要考虑全文搜索？

编辑：所以似乎对全文搜索的唯一可能需要可能是 on `description`，并且看起来它可能足够有限，以至于 MySQL 5.1 或 PostgreSQL 8.3 都可以很好地服务它。我，我对 PostgreSQL 很感兴趣（尽管我也是 MySQL 方面的专家），但这是普遍偏好，与全文搜索问题没有特别关联。[这个博客](http://www.espace.com.eg/blog/2009/02/15/full-text-search-postgresql-beats-mysql/)确实提供了一个喜欢 PostgreSQL 的理由：你可以进行全文搜索并且仍然是事务性的，而在 MySQL 中，全文索引只适用于 MyISAM 表，而不适用于 InnoDB [[当然，除非你添加 sphinx]]]（也看到[这个后续](http://www.espace.com.eg/blog/2009/03/15/postgresql-an-ultimate-strategy-for-full-text-search/)更多关于 PostgreSQL 和 Lucene 中的全文搜索的信息）。尽管如此，在选择数据库时当然还有其他考虑因素，我认为你不会对任何一个都做得很糟糕（除非必须为全文和事务添加 sphinx 是一个大问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T18:38:27.350

Django在其 QuerySet 过滤器中支持[全文搜索。](http://docs.djangoproject.com/en/dev/ref/models/querysets/#search)现在，如果您只有两个模型需要搜索，只需创建一个搜索两个字段的视图：

```
search_string = "+Django -jazz Python"
first_models = FirstModel.objects.filter(headline__search=search_string)
second_models = SecondModel.objects.filter(headline__search=search_string) 
```

如有必要，您可以进一步过滤它们以确保结果是唯一的。

此外，还有一个[正则表达式过滤器](http://docs.djangoproject.com/en/dev/ref/models/querysets/#regex)可能更好地处理您的 html 字段和标签，因为正则表达式可以指示过滤器准确地处理任何分隔符或标记。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T16:35:01.307

是否需要外部库取决于您的需求。我们在谈论多少流量？就性能而言，外部库通常更好，但一如既往地有利有弊。我正在使用带有 django-sphinx 插件的 Sphinx，如果您要进行大量搜索，我会推荐它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T16:45:25.503

[干草堆](http://haystacksearch.org/)看起来很有希望。它在后端支持[Whoosh 。](http://whoosh.ca/)

# algorithm - 您如何计算除 10 以外的基数中的浮点数？

> ID：932263
> 
> 赞同：3
> 
> 时间：2009-05-31T15:34:33.013
> 
> 标签：algorithm, floating-point, decimal-point, radix, radix-point

鉴于维基百科关于[Radix Point](http://en.wikipedia.org/wiki/Radix_point)的文章，如何计算 10.1 的二进制等价物或 17.17 的十六进制等价物？对于前者，十分之一的二进制等价物是多少？对于后者，17/100 的十六进制表示？

我正在寻找一种算法，而不是仅仅针对这两个示例的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T19:26:03.730

要将十进制 10.1 转换为二进制，请将整数和小数部分分开并分别转换。

要转换整数部分，请使用重复的整数除以 2，然后以相反的顺序写出余数：

10/2 = 5 余数 0

5/2 = 2 余数 1

2/2 = 1 余数 0

1/2 = 0 余数 1

答案：1010

要转换小数部分，请使用重复乘以 2，在每一步减去整数部分。整数部分按生成顺序表示您的二进制数：

0.1 * 2 = 0.2

0.2 * 2 = 0.4

0.4 * 2 = 0.8

0.8 * 2 = 1.6

0.6 * 2 = 1.2

0.2 * 2 = 0.4

0.4 * 2 = 0.8

...（循环永远重复）

所以十进制 0.1 是二进制 0.000110011001100...

（有关更详细的解释，请参阅我的文章[http://www.exploringbinary.com/base-conversion-in-php-using-bcmath/](http://www.exploringbinary.com/base-conversion-in-php-using-bcmath/)中的例程 dec2bin_i() 和 dec2bin_f() 。）

对于十六进制，使用相同的过程，但除数/乘数为 16 而不是 2。大于 9 的余数和整数部分必须直接转换为十六进制数字：10 变为 A，11 变为 B，...，15 变为 F .

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T15:59:05.973

该算法非常简单，但在实践中，您可以使用查找表和日志进行大量调整以加快速度。但是对于基本算法，您可以尝试这样的事情：

```
shift=0;

while v>=base,  v=v/base, shift=shift+1;  

Next digit: 
if v<1.0 && shift==0, output the decimal point
else 
   D=floor(v)
   output D
   v=v-D
v=v*base
shift = shift-1
if (v==0) exit;
goto Next Digit 
```

您也可以在其中进行测试以在 N 位之后停止打印，以获得更长的重复小数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T16:37:13.517

以 b [1]为基数的终止数（可以由有限位数表示的数字）n [1可能最终成为不同基数 b] [2]的非终止数。相反，一个底数b [1]中的非终止数可能会变成底数b [2]中的终止数。

转换为二进制时的数字 0.1 [10]是非终止数，转换为十六进制数时的 0.17 [10也是如此。]但是以 3 为底的终止数字 0.1 [3]转换为以 10 为底的数字是非终止的重复数字 0.(3) [10]（表示数字 3 重复）。类似地，将 0.1 [10]转换为二进制，将 0.17 [10]转换为十六进制，最终会得到非终止的重复数字 0.0(0011) [2]和 0.2(B851E) [16]

因此，在将此类数字从一个基数转换为另一个基数时，您可能会发现自己不得不近似该数字，而不是获得完全准确的表示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T16:31:08.217

十分之一的“二进制等价物”是二分之一，即不是 1/10^1，而是 1/2^1。

每个数字代表二的幂。小数点后面的数字是相同的，只是它们代表 1 的 2 的幂：

```
 8 4 2 1 . 1/2 1/4 1/8 1/16 
```

所以对于 10.1，你显然需要一个“8”和一个“2”来制作 10 部分。1/2 (0.5) 太多了，1/4 (0.25) 太多了，1/8 (0.125) 太多了。我们需要 1/16 (0.0625)，剩下的就是 0.0375。1/32 是 0.03125，所以我们也可以取它。到目前为止，我们有：

```
 8 4 2 1 . 1/2 1/4 1/8 1/16 1/32
 1 0 1 0    0   0   0   1     1 
```

误差为 0.00625。1/64 (0.015625) 和 1/128 (0.0078125) 都太多了，1/256 (0.00390625) 会起作用：

```
 8 4 2 1 . 1/2 1/4 1/8 1/16 1/32 1/64 1/128 1/256
 1 0 1 0    0   0   0   1     1    0   0     1 
```

误差为 0.00234375。

.1 不能用二进制精确表示（就像 1/3 不能用十进制精确表示一样）。根据您放置基数的位置，您最终必须停下来，可能会舍入并接受错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T14:26:13.050

在我根据我的 GMP 库讨论这个问题之前，这里是我尝试使 Rick Regan 的 PHP 代码对从 2 到 36 的任何基数都通用的地方。

```
Function dec2base_f(ByVal ddecimal As Double, ByVal nBase As Long, ByVal dscale As Long) As String
    Const BASES = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ" 'up to base 36
    Dim digitCount As Long
    Dim wholeNumber As Double
    Dim digit As String * 1
    digitCount = 0
    dscale = max(dscale, Len(CStr(ddecimal)) - Len("0."))
    Dim baseary_f As String
    baseary_f = "0."
    Do While ddecimal > 0 And digitCount < dscale
        ddecimal = ddecimal * nBase
        digit = Mid$(BASES, Fix(ddecimal) + 1)
        baseary_f = baseary_f & digit '"1"
        ddecimal = ddecimal - Fix(ddecimal)
        digitCount = digitCount + 1
    Loop
    dec2base_f = baseary_f
End Function

Function base2dec_f(ByVal baseary_f As String, nBase As Double) As Double
    Const BASES As String = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
    Dim decimal_f As Double
    Dim i As Long
    Dim c As Long
    For i = Len(baseary_f) To Len("0.") + 1 Step -1
        c = InStr(BASES, Mid$(baseary_f, i, 1)) - 1
        decimal_f = decimal_f + c
        decimal_f = decimal_f / nBase
    Next
    base2dec_f = decimal_f
End Function

Debug.Print base2dec_f(dec2base_f(0.09, 2, 200), 2) --> 0.09
Debug.Print base2dec_f(dec2base_f(0.09, 8, 200), 8) --> 0.09
Debug.Print base2dec_f(dec2base_f(0.09, 16, 200), 16) --> 0.09 
```

# c# - 如何在文本框中整齐地对齐文本并在导出为 .txt 时保留它

> ID：932267
> 
> 赞同：4
> 
> 时间：2009-05-31T15:37:10.547
> 
> 标签：c#, winforms, textbox

我有一个愚蠢的小问题，我希望你们能加入你的经验。

我需要一个包含以下（动态）数据的文本框：

```
TEXT    
TEXT
TEXT
TEXT

_______________________
Name:          Amount:
Blah                  3
Blahblah             10
_______________________ 
```

但是框内的文字是问题所在。到目前为止，我正在使用`StringBuilder`被调用`SB`的方式制作所有这些文本，最后我设置了`MyTextBox.Text`= `SB.ToString()`;

我在框内设置标题，如下所示：

```
SB.AppendLine("Name\t\Amount:"); 
```

我在这样的循环中生成数据：

```
SB.AppendLine(name + "\t\t" + amount); 
```

但它不像我的例子那样整齐排列！如果名称比以前的名称长，金额将出现在行上一个完全不同的位置 - 与以前相比。

外汇。像这样：

```
TEXT
TEXT
TEXT
TEXT

__________________
Navn        Antal:
SpecSaver           1
MadEyes       1
Gucci       1
__________________ 
```

**我的第一个问题：**如何防止这种情况发生？当您需要一个多行文本框来包含大量数据时，您通常会做什么。 **我的第二个问题：**当我将它导出到这样的 .txt 文档时：

```
using(var text = new StreamWriter("textfile.txt", false))
{
    text.Write(SB);
} 
```

它提供了另一个版本的数据，完全错位。它应该与 MyTextBox.Text 相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T15:58:01.357

首先，您需要[`Fixed-Width`](http://en.wikipedia.org/wiki/Monospaced_font)为文本框选择一种字体。

接下来，您可以提供[Padding 数量](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)to `string.Format()` （或 to `StringBuilder.AppendFormat`）

```
 StringBuilder sb = new StringBuilder();
        sb.AppendLine(string.Format("{0, -20}{1, -10}", "Title 1", "Title 2"));
        sb.AppendLine(string.Format("{0, -20}{1, -10}", "Val Col 1 A", "Val Col 2 A"));
        sb.AppendLine(string.Format("{0, -20}{1, -10}", "Val Col 1 B", "Val Col 2 B"));

        Console.WriteLine(sb.ToString()); 
```

结果是：

```
Title 1             Title 2
Val Col 1 A         Val Col 2 A
Val Col 1 B         Val Col 2 B 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T15:47:06.817

使用固定间距字体实现字符对齐 - 选择类似`courier-new`字体作为文本框和打印的字体。

请参阅[string-padding-problem](https://stackoverflow.com/questions/763257/string-padding-problem)（也许您的 MessageBox 正在显示可变间距字体？）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T15:42:14.150

（不完整地）回答你的第一个问题。您需要计算字符串中的字符数，而不是为每个字符串使用相同数量的制表符，因为它可能包含一个、两个或多个“制表符”的额外字符。例如，考虑以下两个字符串：

```
"Hi"
"Hello there" 
```

如果您为每个选项卡添加相同数量的选项卡，则第二个选项卡仍然会更长，假设选项卡有 4 个空格。

您可以在开始添加选项卡之前手动执行此操作，然后仅添加足够的选项卡以使长度达到所需数量，或者您可以使用格式声明（请参阅 Eoin 的答案）。

（也许）回答你的第二个问题。计算完初始文本的长度后，您可以添加所需数量的空格而不是制表符，然后，假设您使用的是非比例字体，数字将始终对齐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:01:13.137

您还可以查看 .padleft .padright(int) 方法，这些方法在左侧或右侧添加空格以帮助保持对齐。

你也可以看看你的字体Curior是guly，但它的制作是为了让每个宪章占用完全相同的空间WM我的东西就像在其他字体中我会占用比W更少的空间

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-25T15:15:32.043

如果只是数字，导致间距问题，[数字空间](http://wikipedia.org/wiki/Figure_space)可以正确对齐它们。

```
int bigNumber = 1234;
int smallNumber = 5;

string bigNumberString = bigNumber.ToString();
string smallNumberString = smallNumber.ToString();

// This works only in a TextBox with a monospaced font.
textBox1.Text = string.Format("{0,4}\n{1,4}",
    bigNumberString,
    smallNumberString);

// This works in TextBoxes with any font.
textBox1.Text = string.Format("{0}\n{1}",
    bigNumberString,
    smallNumberString.PadLeft(bigNumberString.Length, '\u2007')); 
```

# string - 从特定字符开始截断 NSString 的一部分

> ID：932273
> 
> 赞同：3
> 
> 时间：2009-05-31T15:38:42.387
> 
> 标签：string, cocoa-touch, nsstring, truncate

我有一个字符串

```
NSString * myOldString = @"This is a string (and this part is between brackets)" 
```

现在，我想以这样一种方式截断字符串，即基本上括号之间的所有内容，包括括号，都被截断。

更准确地说：我根本不在乎第一个括号之后发生了什么。

我不能做一个简单的`stringByReplacingOccurrencesOfString:`，因为我无法预测括号之间会是什么。因此，生成的字符串应该是：

```
"This is a string" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T16:04:52.260

一种方法：

```
NSArray *components = [myOldString componentsSeparatedByString:@"("];
NSString *newString = [components objectAtIndex:0]; 
```

也应该适用于没有“（”的情况

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T15:47:03.213

应该很简单

```
NSRange r = [myOldString rangeOfString:@"("]
NSString new string = [myOldString substringToIndex:r.location]; 
```

如果刹车还在那里，只有-1

# c# - xsd验证问题

> ID：932282
> 
> 赞同：3
> 
> 时间：2009-05-31T15:41:38.813
> 
> 标签：c#, xsd

我有以下（错误）Xml：

```
<jobs>
    <job>
        <id>1</id>
        <state><![CDATA[IL]]></state>
    </job>
    <job>
        <id>2</id>
    </job>
</jobs> 
```

id 和 state 节点都是必需项。我为它写了一个 Xsd：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="importvalidator"
    elementFormDefault="qualified"
    targetNamespace="http://foo.org/importvalidator.xsd"
    xmlns="http://foo.org/importvalidator.xsd"
    xmlns:mstns="http://foo.org/importvalidator.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="jobs">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="job" minOccurs="1" maxOccurs="unbounded">
              <xs:complexType>
                <xs:all>
                  <xs:element name="id" type="xs:string" minOccurs="1"/>
                  <xs:element name="state" type="xs:string" minOccurs="1"/>
                </xs:all>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

它仍然被验证为结构上有效的 Xml。我在这里想念什么？

Update1：​​我正在使用的代码是在 C# 中：

```
 XmlSchemaSet schemas = new XmlSchemaSet();
        schemas.Add("http://foo.org/importvalidator.xsd", "validator.xsd");

        XDocument doc = XDocument.Load(fileName);
        if (doc == null | doc.Root == null)
        {
            throw new ApplicationException("xml error: the referenced stream is not xml.");
        }

        doc.Validate(schemas, (o, e) =>
        {
            throw new ApplicationException("xsd validation error: xml file has structural problems");
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T16:28:37.063

请格式化您的 xml，使其更易于阅读 - 如下所示：

```
<jobs>
  <job>
    <id>1</id>
    <state><![CDATA[IL]]></state>
  </job>
  <job>
    <id>2</id>
  </job>
</jobs> 
```

我认为您实际上并没有验证它 - 命名空间意味着 XML 不会验证，即使`<state>`在第二个“”中使用“ ”也是如此`<job>`。具体来说，XSD 有一个目标命名空间“ `http://foo.org/importvalidator.xsd`”，但 XML 没有给定命名空间。

设置一个简单的 XSD 和 XML 测试用例，您肯定知道它会失败 - 使用它来追踪您不验证的原因。

此外，您的 XSD 缺少元素和架构的关闭标签，因此它应该给出错误 - 或者它只是错误粘贴:-)

* * *

您可以从架构中删除 targetNamespace：

```
<xs:schema id="importvalidator"
    elementFormDefault="qualified"
    targetNamespace="http://foo.org/importvalidator.xsd    ← DELETE THIS"
    xmlns="http://foo.org/importvalidator.xsd"
    xmlns:mstns="http://foo.org/importvalidator.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
```

所以它看起来像这样：

```
<xs:schema id="importvalidator"
    elementFormDefault="qualified"
    xmlns="http://foo.org/importvalidator.xsd"
    xmlns:mstns="http://foo.org/importvalidator.xsd"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
```

PS：任何人都知道您是否/如何使用 SO 的降价来突出显示部分源代码？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T17:20:06.710

@13ren 有正确答案。如果一个节点不匹配任何模式，这不是错误。这只是一个警告。我可以在下面的代码中看到警告：

```
private static void ValidateDocument(XmlSchemaSet schemas, string uri)
{
    var settings = new XmlReaderSettings
                       {
                           Schemas = schemas,
                           ValidationFlags =
                               XmlSchemaValidationFlags.
                                   ProcessIdentityConstraints |
                               XmlSchemaValidationFlags.
                                   ReportValidationWarnings,
                           ValidationType = ValidationType.Schema
                       };
    settings.ValidationEventHandler += OnValidationEventHandler;
    using (var validatingReader = XmlReader.Create(uri, settings))
    {
        XDocument.Load(
            validatingReader,
            LoadOptions.SetBaseUri | LoadOptions.SetLineInfo);
    }
    return;
} 
```

这会产生以下结果：

警告：找不到元素“作业”的架构信息。警告：找不到元素“作业”的架构信息。警告：找不到元素“id”的架构信息。警告：找不到元素“状态”的架构信息。警告：找不到元素“作业”的架构信息。警告：找不到元素“id”的架构信息。

更改您的 XML 并再次运行：

```
<?xml version="1.0" encoding="utf-8" ?>
<jobs xmlns="http://foo.org/importvalidator.xsd">
  <job>
    <id>1</id>
    <state><![CDATA[IL]]></state>
  </job>
  <job>
    <id>2</id>
  </job>
</jobs> 
```

产生您预期的错误：

[错误：命名空间“ http://foo.org/importvalidator.xsd](http://foo.org/importvalidator.xsd) ”中的元素“job”内容不完整。预期的可能元素列表：命名空间“ [http://foo.org/importvalidator.xsd](http://foo.org/importvalidator.xsd) ”中的“状态”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T15:50:52.840

您使用的是哪种解析器/语言？过去，如果您使用 Java，您必须告诉 Xerces 解析器您想要 XSD 验证。但是在检查了[最新的发布](http://xerces.apache.org/xerces2-j/faq-xs.html)文档之后，我发现验证现在是内置的。所以看来版本很重要。如果您是 .NET 开发人员，最好检查其设置需要是什么。

只是好奇-为什么在您的示例中围绕状态的 CDATA？没有必要，AFAIK。您甚至可以在 XSD 中嵌入限制，以确保您只获得有效的美国州代码。

但首先要做的是 - 让架构验证。

# iphone - iPhone Dev：从子控制器和 TabBar 中的另一个控制器重新加载表格视图的数据

> ID：932288
> 
> 赞同：5
> 
> 时间：2009-05-31T15:45:18.097
> 
> 标签：iphone, uitableview, uitabbarcontroller, reload

我正在实现一个笔记管理器应用程序，它在 tabBar 中有一个 tableView，其中显示了它的笔记的主要信息。访问一个笔记时，您可以编辑其属性。在 tabBar 的一个按钮中，您可以选择注释在 tableView 中的显示方式。

我遇到的问题是我不知道如何从子控制器或 tabBar 的另一个控制器重新加载数据。我不知道如何从他们那里引用 tableView，所以我可以使用 reloadData 从他们那里更新 TableView 的信息。

我是 iPhone 开发的新手……任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-12-28T05:16:00.920

你应该试试`NSNotificationCenter`。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(doSomething:) name:@"doSomethingNotification" object:nil];

[[NSNotificationCenter defaultCenter] postNotificationName:@"doSomethingNotification" object:nil]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T16:19:23.803

将您的表格更新代码放入 viewWillAppear: 而不是 viewDidLoad - 这样每次您从子控制器返回父控制器时，数据都会重新加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T15:56:27.533

MVC 模式在这里会有所帮助，

只要您使用所需的信息不断更新您的模型，并且您的控制器正在从该模式更新。当您在视图之间回弹时，您最终会自动更新视图。

这样你就可以调用你的重新加载数据方法，它们会得到更新。

```
[tableviewController.tableview reloadData]; 
```

是您访问重新加载数据消息的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-07T22:07:43.307

我在处理原型单元时遇到了同样的问题。奇怪的是，我很确定我做的一切都是正确的。

然后我开始思考 XCode 是否有问题。所以我清理了所有东西，重新启动了 XCode，它仍然在抱怨。

最后，我尝试重做我对故事板的最新更改，即添加一个 tableviewcell 类并将其与我所有的 ui 控件挂钩。最后它停止了抱怨。

我不认为此错误是由您的代码或其他原因引起的，我在 iOS 5 中遇到了几个奇怪的错误。它仍在测试中并且有很多错误。

无论如何，故事板很棒，我会尽量习惯它，它描绘了你的应用程序的大图，并且很容易处理不同视图之间的关系。另外，我真的很喜欢他的 prepareforsegue 方法。

好的祝你好运。

# powershell - 从 Windows 批处理文件调用 powershell cmdlet

> ID：932291
> 
> 赞同：20
> 
> 时间：2009-05-31T15:46:15.430
> 
> 标签：powershell, batch-file

好的，这么简单的事情对我不起作用。我有一个接受单个参数的 cmdlet。我正在尝试在 Windows 批处理文件中调用 cmdlet。批处理文件包含：

```
cd %SystemRoot%\system32\WindowsPowerShell\v1.0
powershell Set-ExecutionPolicy Unrestricted
powershell 'C:\convert-utf8-to-utf16.ps1 C:\test.txt'
powershell Set-ExecutionPolicy Restricted
pause 
```

我的 ps1 文件再次没有做任何特别的事情：

```
function convert-utf8-to-utf16 {   
  $tempfile = "C:\temp.txt"
  set-ExecutionPolicy Unrestricted
  get-content -Path $args[0] -encoding utf8 | out-file $tempfile -encoding Unicode
  set-ExecutionPolicy Restricted
} 
```

当我执行 bat 文件时，它只是运行完成（没有错误消息），并且似乎没有创建 temp.txt 文件。

我可以在 PS 命令提示符下运行 powershell 命令文件，但不能在 cmd 中运行！

任何人有任何想法可能是错的？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-05-26T20:17:07.193

从 Powershell 版本 2 开始，您可以像这样运行 Powershell 脚本......

```
powershell -ExecutionPolicy RemoteSigned -File "C:\Path\Script.ps1" "Parameter with spaces" Parameter2 
```

现在，如果我只能找到一种方法来处理[将文件拖放到 Powershell 脚本](https://stackoverflow.com/questions/2819908/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-25T20:49:20.167

[我在我的博客文章中](http://blog.danskingdom.com/allow-others-to-run-your-powershell-scripts-from-a-batch-file-they-will-love-you-for-it/)解释了为什么要从批处理文件中调用 PowerShell 脚本以及如何执行此操作。

这基本上就是您要寻找的内容：

```
PowerShell -NoProfile -ExecutionPolicy Bypass -Command "& 'C:\convert-utf8-to-utf16.ps1' 'C:\test.txt'" 
```

如果您需要以管理员身份运行 PowerShell 脚本，请使用以下命令：

```
PowerShell -NoProfile -ExecutionPolicy Bypass -Command "& {Start-Process PowerShell -ArgumentList '-NoProfile -ExecutionPolicy Bypass -File ""C:\convert-utf8-to-utf16.ps1"" ""C:\test.txt""' -Verb RunAs}" 
```

不过，我建议不要硬编码 PowerShell 脚本的整个路径，而是将批处理文件和 PowerShell 脚本文件放在同一目录中，正如我的博客文章所述。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-08-14T04:44:56.390

问题出在 ps1 文件中 - 您声明了一个函数，但没有调用它。我会这样修改它：

```
param($path)
function convert-utf8-to-utf16 {   
 $tempfile = "C:\temp.txt"
 set-ExecutionPolicy Unrestricted
 get-content -Path $args[0] -encoding utf8 | out-file $tempfile -encoding Unicode
 set-ExecutionPolicy Restricted
}

convert-utf8-to-utf16 $path 
```

它会起作用的。但是，它不是必需的，您可以简单地省略函数声明并将主体移动到脚本本身：

```
param($path)
$tempfile = "C:\temp.txt"
set-ExecutionPolicy Unrestricted
get-content -Path $path -encoding utf8 | out-file $tempfile -encoding Unicode
set-ExecutionPolicy Restricted 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-15T17:04:14.833

```
# Test-Args.ps1
param($first, $second)
write-host $first
write-host $second 
```

从命令提示符调用：

```
PowerShell.exe -NoProfile -Command "& {./Test-Args.ps1 'C:\Folder A\One' 'C:\Folder B\Two'}" 
```

令人困惑的是，如果脚本位于包含空格的文件夹路径中，PowerShell 将无法识别引号中的脚本名称：

```
PowerShell.exe -NoProfile -Command "& {'C:\Folder X\Test-Args.ps1' 'C:\Folder
 A\One' 'C:\Folder B\Two'}" 
```

但是您可以使用以下方法解决此问题：

```
PowerShell.exe -NoProfile -Command "& {set-location 'C:\Folder X';./Test-Args.ps1 'C:\Folder
 A\One' 'C:\Folder B\Two'}" 
```

不要在你的 .PS1 文件名中使用空格，否则你就不走运了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T02:50:32.613

我得到了这个工作...... ps1 文件不需要被包装到一个函数中。只是这个声明是可以的。

```
$tempfile = "C:\temp.txt"  
get-content -Path $args[0] -encoding utf8 | out-file $tempfile -encoding unicode 
```

bat文件将其称为：

```
cd %SystemRoot%\system32\WindowsPowerShell\v1.0
powershell Set-ExecutionPolicy Unrestricted
powershell "& 'C:\convert-utf8-to-utf16.ps1 C:\test.txt' 'C:\test.txt'"
powershell Set-ExecutionPolicy Restricted
pause 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T15:56:14.367

请尝试以下语法：

```
cd %SystemRoot%\system32\WindowsPowerShell\v1.0
powershell {Set-ExecutionPolicy Unrestricted}
powershell "& C:\convert-utf8-to-utf16.ps1 C:\test.txt"
powershell {Set-ExecutionPolicy Restricted}
pause 
```

# c# - C# 对象排名，多个条件

> ID：932300
> 
> 赞同：9
> 
> 时间：2009-05-31T15:50:06.397
> 
> 标签：c#, linq, linq-to-objects, ranking

我正在为我编写的 LAN 派对网站构建一个插件，该插件将允许使用循环锦标赛。

一切进展顺利，但我对根据两个标准进行排名的最有效方法有一些疑问。

基本上，我想要以下排名布局：

```
 Rank  Wins  TotalScore
PersonE  1     5     50
PersonD  2     3.5   37
PersonA  2     3.5   37
PersonC  4     2.5   26
PersonB  5     2.5   24
PersonF  6     0     12 
```

在 SQL Server 中，我会使用：

```
SELECT
    [Person],
    RANK() OVER (ORDER BY Wins DESC, TotalScore DESC) [Rank],
    [Wins],
    [TotalScore] 
```

现在，我只有 List、Dictionary 等可以使用

具体来说：

```
Dictionary<TournamentTeam, double> wins = new Dictionary<TournamentTeam, double>();
Dictionary<TournamentTeam, double> score = new Dictionary<TournamentTeam, double>(); 
```

**有没有办法用 LINQ 进行这种排名方式？**

如果没有，是否有一种*可扩展*的方式可以让我以后考虑赢-输-平，而不是如果我选择只赢？

**编辑：**

我对 TheSoftwareJedi 的回答的改编：

```
private class RRWinRecord : IComparable
{
    public int Wins { get; set; }
    public int Losses { get; set; }
    public int Draws { get; set; }
    public double OverallScore { get; set; }
    public double WinRecord
    {
        get
        {
            return this.Wins * 1.0 + this.Draws * 0.5 + this.Losses * 0.0;
        }
    }

    public int CompareTo(object obj) { ... }

    public override bool Equals(object obj) { ... }
    public override int GetHashCode() { ... }
    public static bool operator ==(RRWinRecord lhs, RRWinRecord rhs) { ... }
    public static bool operator !=(RRWinRecord lhs, RRWinRecord rhs) { ... }
    public static bool operator >(RRWinRecord lhs, RRWinRecord rhs) { ... }
    public static bool operator <(RRWinRecord lhs, RRWinRecord rhs) { ... }
    public static bool operator >=(RRWinRecord lhs, RRWinRecord rhs) { ... }
    public static bool operator <=(RRWinRecord lhs, RRWinRecord rhs) { ... }
}

...

    int r = 1, lastRank = 1;
    RRWinRecord lastRecord = null;

    var ranks = from team in records.Keys
                let teamRecord = records[team]
                orderby teamRecord descending
                select new RRRank() { Team = team, Rank = r++, Record = teamRecord };

    foreach (var rank in ranks)
    {
        if (rank.Record != null && lastRecord == rank.Record)
        {
            rank.Rank = lastRank;
        }

        lastRecord = rank.Record;
        lastRank = rank.Rank;

        string scoreDescription = String.Format("{0}-{1}-{2}", rank.Record.Wins, rank.Record.Losses, rank.Record.Draws);
        yield return new TournamentRanking(rank.Team, rank.Rank, scoreDescription);
    }

    yield break; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-01T01:57:34.470

排名不是太难。只需将 OrderBy 和 Select 实现模式混合在一起，您就可以拥有一个易于使用的 Ranking 扩展方法。像这样：

```
 public static IEnumerable<U> Rank<T, TKey, U>
    (
      this IEnumerable<T> source,
      Func<T, TKey> keySelector,
      Func<T, int, U> selector
    )
    {
        if (!source.Any())
        {
            yield break;
        }

        int itemCount = 0;
        T[] ordered = source.OrderBy(keySelector).ToArray();
        TKey previous = keySelector(ordered[0]);
        int rank = 1;
        foreach (T t in ordered)
        {
            itemCount += 1;
            TKey current = keySelector(t);
            if (!current.Equals(previous))
            {
                rank = itemCount;
            }
            yield return selector(t, rank);
            previous = current;
        }
    } 
```

这是一些测试代码

```
string[] myNames = new string[]
{ "Bob", "Mark", "John", "Jim", "Lisa", "Dave" };
//
var query = myNames.Rank(s => s.Length, (s, r) => new { s, r });
//
foreach (var x in query)
{
  Console.WriteLine("{0} {1}", x.r, x.s);
} 
```

这会产生以下结果：

```
1 Bob
1 Jim
3 Mark
3 John
3 Lisa
3 Dave 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T16:03:09.703

假设您有一个`List<Result>`结构，其中`Result`对象具有以下参数...

```
Pesron     - string
Rank       - int
Wins       - double
TotalScore - int 
```

您可以编写一个自定义比较器，然后将其传递给`List.Sort(Comparison<Result> comparison)`

或者，您可以让您的`Result`对象实现`IComparable<Result>` 并将其粘贴在您的课程中。

```
 #region IComparable Members

        public int CompareTo(Result obj)
        {
            if (this.Rank.CompareTo(obj.Rank) != 0)
                return this.Rank.CompareTo(obj.Rank);

            if (this.Wins.CompareTo(obj.Wins) != 0)
                return (this.Wins.CompareTo(obj.Wins);

            return (this.TotalScore.CompareTo(obj.TotalScore) ;

        }

        #endregion 
```

然后你可以打电话`List<Result>.Sort()`;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T16:26:07.813

这应该适用于非密集等级：

```
static class Program
{

    static IEnumerable<Result> GetResults(Dictionary<TournamentTeam, double> wins, Dictionary<TournamentTeam, double> scores)
    {
        int r = 1;
        double lastWin = -1;
        double lastScore = -1;
        int lastRank = 1;

        foreach (var rank in from name in wins.Keys
                             let score = scores[name]
                             let win = wins[name]
                             orderby win descending, score descending
                             select new Result { Name = name, Rank = r++, Score = score, Win = win })
        {
            if (lastWin == rank.Win && lastScore == rank.Score)
            {
                rank.Rank = lastRank;
            }
            lastWin = rank.Win;
            lastScore = rank.Score;
            lastRank = rank.Rank;
            yield return rank;
        }
    }
}

class Result
{
    public TournamentTeam Name;
    public int Rank;
    public double Score;
    public double Win;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T15:58:47.813

这可能是一个开始：

```
Dictionary<TournamentTeam, double> wins = new Dictionary<TournamentTeam, double>();
Dictionary<TournamentTeam, double> score = new Dictionary<TournamentTeam, double>();
Dictionary<TournamentTeam, int> ranks = new Dictionary<TournamentTeam, int>();

int r = 1;

ranks = (
    from name 
    in wins.Keys 
    orderby wins[name] descending, scores[name] descending
    select new { Name = name, Rank = r++ })
    .ToDictionary(item => item.Name, item => item.Rank); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T21:35:46.197

我意识到我参加聚会迟到了，但无论如何我都想试一试。

这是一个专门使用 LINQ 的版本：

```
private IEnumerable<TeamRank> GetRankings(Dictionary<TournamentTeam, double> wins, Dictionary<TournamentTeam, double> scores)
{
    var overallRank = 1;

    return
        from team in wins.Keys
        group team by new { Wins = wins[team], TotalScore = scores[team] } into rankGroup
        orderby rankGroup.Key.Wins descending, rankGroup.Key.TotalScore descending
        let currentRank = overallRank++
        from team in rankGroup
        select new TeamRank(team, currentRank, rankGroup.Key.Wins, rankGroup.Key.TotalScore);
} 
```

返回类型：

```
public class TeamRank
{
    public TeamRank(TournamentTeam team, int rank, double wins, double totalScore)
    {
        this.Team = team;
        this.Rank = rank;
        this.Wins = wins;
        this.TotalScore = totalScore;
    }

    public TournamentTeam Team { get; private set; }

    public int Rank { get; private set; }

    public double Wins { get; private set; }

    public double TotalScore { get; private set; }
} 
```

# asp.net - ASP.NET 在中继器控件中查找下拉值

> ID：932301
> 
> 赞同：1
> 
> 时间：2009-05-31T15:50:20.640
> 
> 标签：asp.net, vb.net, datarepeater

好的，我对这个主题有几个问题，我希望这次我更清楚。

我想从转发器控件内的许多下拉控件中找到值。我最终想构建一个多维数组，这样我就可以遍历每个项目并将它们添加到数据库表中。

```
<asp:Repeater ID="myRepeater" runat="server">
<ItemTemplate>
     <asp:DropDownList ID="AdTitle" runat="server">
         <asp:ListItem Selected="True" Value="" Text=""/>
         <asp:ListItem Selected="False" Value="Miss" Text="Miss"/>
         <asp:ListItem Selected="False" Value="Ms" Text="Ms"/>
         <asp:ListItem Selected="False" Value="Mrs" Text="Mrs"/>
         <asp:ListItem Selected="False" Value="Mr" Text="Mr"/>
         <asp:ListItem Selected="False" Value="Other" Text="Other"/>
     </asp:DropDownList>

     <asp:TextBox ID="AdFullName" runat="server"></asp:TextBox>
</ItemTemplate>

<ItemTemplate>
     <asp:DropDownList ID="AdTitle" runat="server">
         <asp:ListItem Selected="True" Value="" Text=""/>
         <asp:ListItem Selected="False" Value="Miss" Text="Miss"/>
         <asp:ListItem Selected="False" Value="Ms" Text="Ms"/>
         <asp:ListItem Selected="False" Value="Mrs" Text="Mrs"/>
         <asp:ListItem Selected="False" Value="Mr" Text="Mr"/>
         <asp:ListItem Selected="False" Value="Other" Text="Other"/>
     </asp:DropDownList>

     <asp:TextBox ID="AdFullName" runat="server"></asp:TextBox>
</ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T15:59:53.213

您需要遍历中继器项目并获取每个值。下面的代码示例是用 C# 编写的，但应该能够相对容易地转换为 VB.NET。

```
foreach (RepeaterItem ri in myRepeater.Items)
{
    switch (ri.ItemType)
    {
        case ListItemType.Item:
        case ListItemType.AlternatingItem:

            DropDownList AdTitle = (DropDownList) ri.FindControl("AdTitle");
            TextBox AdFullName = (TextBox) ri.FindControl("AdFullName");

            string selectedAdTitle = AdTitle.SelectedValue;
            string enteredAdFullName = AdFullName.Text;

            // Do something with values here

        break;
    }
} 
```

# .net-4.0 - Microsoft 是否在 .NET 4.0 中重写了 Windows Workflow Foundation？

> ID：932312
> 
> 赞同：4
> 
> 时间：2009-05-31T15:56:41.777
> 
> 标签：.net-4.0, workflow-foundation

我从一位朋友那里听说，Microsoft 再次重写了所有 Windows Workflow Foundation (WF)，并更改了 .Net 3.5 中的所有内容。

真的吗？

那么我们在 3.0 和 3.5 中对 WF 的了解又如何呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-31T16:03:57.813

根据这篇文章：

[http://visualstudiomagazine.com/articles/2009/01/01/windows-workflow-changes-direction.aspx](http://visualstudiomagazine.com/articles/2009/01/01/windows-workflow-changes-direction.aspx)

Windows Workflow Foundation 4.0 是“采用全新思维的自下而上重写...WF 3.0/3.5 仍将是框架的一部分，并将与 WF 4.0 一起运行。这让您可以在适合您的时间管理过渡。组织更广泛的目标。”

......这是代码，“我们知道我们只是搞砸了你的编程模型，但我们有一个长期的战略，所以我们希望你能原谅我们。”

文章接着说

> 收益是巨大的：自定义活动占据中心位置，创作它们要简单得多；工作流程完全是声明性的；您可以无缝组合三种工作流样式。除了 10 到 100 倍的运行时性能改进之外，您还可能会看到创建和调试工作流所需的时间缩短了 10 倍。

这种变化并非没有批评者。在[DotNetKicks](http://www.dotnetkicks.com/wwf/Windows_Workflow_a_total_rewrite_in_Dot_Net_4_0)上的这篇文章中，作者指出，“Microsoft 严重损害了 DotNet 开发人员社区和行业内的采用这些半生不熟的产品版本和出货后的突然转变。”

这就是为什么我通常会等待 Microsoft 技术的 2.0 或 3.0 版本，尽管我对 ASP.NET MVC 做了一个例外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T17:12:25.877

我们发现当需要传入和传出数据时，工作流产品很难让您理解。Scott Allen 有一系列文章很好地描述了这个过程，但这仍然不是一件容易的事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T16:05:55.117

这就是[街上的词](http://my-tech-talk.blogspot.com/2008/11/microsoft-rewrites-workflow-foundation.html)。并在[互联网](http://visualstudiomagazine.com/articles/2009/01/01/windows-workflow-changes-direction.aspx)上。3.0 和 3.5 将被弃用，但仍然可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T16:28:08.420

此更改不在 Visual Studio 2010 beta 1 中吗？下载它，找出并告诉 Microsoft 您对它的看法。

# c - 定义结构的问题

> ID：932313
> 
> 赞同：0
> 
> 时间：2009-05-31T15:57:26.317
> 
> 标签：c

我正在用 C 做一个小应用程序，我想定义一个结构。我已经这样做了：

```
类型定义结构{
    项目元素[TAILLE_TAMPON]；
    sem_t 互斥体，attendreVide，attendrePlein；
    int ptEntre, ptSortie;
} 卫生棉条；

```

但是当我使用 ITEM 构建项目时出现错误是由于包含问题吗？

*   标准输出
*   标准库文件
*   时间.h
*   信号量.h
*   pthread.h
*   “睡眠.h”

“psleep.h”包括“unistd.h”

感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T16:01:51.323

听起来好像在您的一个标题中声明了 ITEM 类型，尽管您需要提供更多信息才能确定。检查以确保 #include 定义了 ITEM 结构的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T16:03:18.033

不，这根本不是由于包含。鉴于您向我们展示的内容，这是因为 ITEM 不是已定义的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T16:12:58.860

ITEM 应在 TAMPON 之前声明。您是否尝试在 TAMPON 之后声明它？

确保您的包含顺序保证您需要定义其他结构的结构类型在引用它们的结构之前被引入。例如，如果您有一个使用 TAMPON 的 BOX_OF_TAMPONS 结构，您将在 TAMPON 之后声明 BOX_OF_TAMPONS。

# c++ - 为什么我的单选按钮不起作用？

> ID：932315
> 
> 赞同：2
> 
> 时间：2009-05-31T15:57:45.600
> 
> 标签：c++, visual-studio-2005, mfc, dialog, radio-button

我正在使用 Visual C++ 2005 开发 MFC 对话框应用程序。我的单选按钮是 m_Small、m_Medium 和 m_Large。它们都没有在我的 m_Summary 编辑框中显示它们应该显示的内容。有什么问题？

这是我的代码。

```
 // Pizza_ProgramDlg.cpp : implementation file
//

#include "stdafx.h"
#include "Pizza_Program.h"
#include "Pizza_ProgramDlg.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// CAboutDlg dialog used for App About

class CAboutDlg : public CDialog
{
public:
    CAboutDlg();

// Dialog Data
    enum { IDD = IDD_ABOUTBOX };

    protected:
    virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support

// Implementation
protected:
    DECLARE_MESSAGE_MAP()
};

CAboutDlg::CAboutDlg() : CDialog(CAboutDlg::IDD)
{
}

void CAboutDlg::DoDataExchange(CDataExchange* pDX)
{
    CDialog::DoDataExchange(pDX);
}

BEGIN_MESSAGE_MAP(CAboutDlg, CDialog)
END_MESSAGE_MAP()

// CPizza_ProgramDlg dialog

CPizza_ProgramDlg::CPizza_ProgramDlg(CWnd* pParent /*=NULL*/)
    : CDialog(CPizza_ProgramDlg::IDD, pParent)
    , m_Name(_T(""))
    , m_Address(_T(""))
    , m_Phone(_T(""))
    , m_Summary(_T(""))
    , m_Extra(FALSE)
    , m_Pepperoni(FALSE)
    , m_Sausage(FALSE)
    , m_Peppers(FALSE)
    , m_Mushrooms(FALSE)
    , m_Onions(FALSE)
    , m_Eatin(0)
    , m_Medium(0)
    , m_Large(0)
    , m_Takeout(0)
    , m_Delivery(0)
    , m_Small(0)
{
    m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);
}

void CPizza_ProgramDlg::DoDataExchange(CDataExchange* pDX)
{
    CDialog::DoDataExchange(pDX);
    DDX_Text(pDX, IDC_EDIT_NAME, m_Name);
    DDV_MaxChars(pDX, m_Name, 1000);
    DDX_Text(pDX, IDC_EDIT_ADDRESS, m_Address);
    DDV_MaxChars(pDX, m_Address, 1000);
    DDX_Text(pDX, IDC_EDIT_PHONE, m_Phone);
    DDV_MaxChars(pDX, m_Phone, 1000);
    DDX_Text(pDX, IDC_EDIT_SUMMARY, m_Summary);
    DDV_MaxChars(pDX, m_Summary, 1000);
    DDX_Check(pDX, IDC_CHECK_EXTRA, m_Extra);
    DDX_Check(pDX, IDC_CHECK_PEPPERONI, m_Pepperoni);
    DDX_Check(pDX, IDC_CHECK_SAUSAGE, m_Sausage);
    DDX_Check(pDX, IDC_CHECK_PEPPERS, m_Peppers);
    DDX_Check(pDX, IDC_CHECK_MUSHROOMS, m_Mushrooms);
    DDX_Check(pDX, IDC_CHECK_ONIONS, m_Onions);
}

BEGIN_MESSAGE_MAP(CPizza_ProgramDlg, CDialog)
    ON_WM_SYSCOMMAND()
    ON_WM_PAINT()
    ON_WM_QUERYDRAGICON()
    //}}AFX_MSG_MAP
    ON_EN_CHANGE(IDC_EDIT_SUMMARY, &CPizza_ProgramDlg::OnEnChangeEditSummary)
    ON_BN_CLICKED(IDOK, &CPizza_ProgramDlg::OnBnClickedOk)
    ON_BN_CLICKED(IDC_BUTTON_PROCESS, &CPizza_ProgramDlg::OnBnClickedButtonProcess)
END_MESSAGE_MAP()

// CPizza_ProgramDlg message handlers

BOOL CPizza_ProgramDlg::OnInitDialog()
{
    CDialog::OnInitDialog();

    // Add "About..." menu item to system menu.

    // IDM_ABOUTBOX must be in the system command range.
    ASSERT((IDM_ABOUTBOX & 0xFFF0) == IDM_ABOUTBOX);
    ASSERT(IDM_ABOUTBOX < 0xF000);

    CMenu* pSysMenu = GetSystemMenu(FALSE);
    if (pSysMenu != NULL)
    {
        CString strAboutMenu;
        strAboutMenu.LoadString(IDS_ABOUTBOX);
        if (!strAboutMenu.IsEmpty())
        {
            pSysMenu->AppendMenu(MF_SEPARATOR);
            pSysMenu->AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
        }
    }

    // Set the icon for this dialog.  The framework does this automatically
    //  when the application's main window is not a dialog
    SetIcon(m_hIcon, TRUE);         // Set big icon
    SetIcon(m_hIcon, FALSE);        // Set small icon

    // TODO: Add extra initialization here

    return TRUE;  // return TRUE  unless you set the focus to a control
}

void CPizza_ProgramDlg::OnSysCommand(UINT nID, LPARAM lParam)
{
    if ((nID & 0xFFF0) == IDM_ABOUTBOX)
    {
        CAboutDlg dlgAbout;
        dlgAbout.DoModal();
    }
    else
    {
        CDialog::OnSysCommand(nID, lParam);
    }
}

// If you add a minimize button to your dialog, you will need the code below
//  to draw the icon.  For MFC applications using the document/view model,
//  this is automatically done for you by the framework.

void CPizza_ProgramDlg::OnPaint()
{
    if (IsIconic())
    {
        CPaintDC dc(this); // device context for painting

        SendMessage(WM_ICONERASEBKGND, reinterpret_cast<WPARAM>(dc.GetSafeHdc()), 0);

        // Center icon in client rectangle
        int cxIcon = GetSystemMetrics(SM_CXICON);
        int cyIcon = GetSystemMetrics(SM_CYICON);
        CRect rect;
        GetClientRect(&rect);
        int x = (rect.Width() - cxIcon + 1) / 2;
        int y = (rect.Height() - cyIcon + 1) / 2;

        // Draw the icon
        dc.DrawIcon(x, y, m_hIcon);
    }
    else
    {
        CDialog::OnPaint();
    }
}

// The system calls this function to obtain the cursor to display while the user drags
//  the minimized window.
HCURSOR CPizza_ProgramDlg::OnQueryDragIcon()
{
    return static_cast<HCURSOR>(m_hIcon);
}

void CPizza_ProgramDlg::OnEnChangeEditSummary()
{

    // TODO:  If this is a RICHEDIT control, the control will not
    // send this notification unless you override the CDialog::OnInitDialog()
    // function and call CRichEditCtrl().SetEventMask()
    // with the ENM_CHANGE flag ORed into the mask.

    // TODO:  Add your control notification handler code here
}

void CPizza_ProgramDlg::OnBnClickedOk()
{
    // TODO: Add your control notification handler code here
    OnOK();
}

void CPizza_ProgramDlg::OnBnClickedButtonProcess()
{
    // TODO: Add your control notification handler code here

    UpdateData(TRUE);
    m_Summary += "Customer's Name: ";
    m_Summary += m_Name;
    m_Summary += char(13);
    m_Summary += char(10);
    m_Summary += "Customer's Address: ";
    m_Summary += m_Address;
    m_Summary += char(13);
    m_Summary += char(10);
    m_Summary += "Customer's Phone Number: ";
    m_Summary += m_Phone;

   if (m_Small==TRUE)
{
    m_Summary += char(13);
    m_Summary += char(10);
    m_Summary += "Small Pizza $5.00";
}
   else if (m_Medium==TRUE)
{
    m_Summary += char(13);
    m_Summary += char(10);
    m_Summary += "Medium Pizza $10.00";
}
   else if (m_Large==TRUE)
   { 
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Large Pizza $15.00";
   }

   if (m_Extra==TRUE)
   {
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Extra Cheese +$1.00";
   }

      if (m_Pepperoni==TRUE)
   {
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Pepperoni +$1.00";
   }

         if (m_Sausage==TRUE)
   {
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Sausage +$1.00";
   }

        if (m_Peppers==TRUE)
   {
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Peppers +$1.00";
   }

           if (m_Mushrooms==TRUE)
   {
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Mushrooms +$1.00";
   }
              if (m_Onions==TRUE)
   {
       m_Summary += char(13);
       m_Summary += char(10);
       m_Summary += "Onions +$1.00";
   }

    UpdateData(FALSE);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T22:57:53.380

您需要[`DDX_Radio`](http://msdn.microsoft.com/en-us/library/fchz3yh5.aspx)在类的`DoDataExchange`函数中添加调用。

为此，您应该将`m_Small`、`m_Medium`和`m_Large`成员变量替换为单个整数：

```
int m_Size; 
```

假设第一个单选按钮的 ID 是`IDC_SMALL`，那么`DDX_Radio`调用将是：

```
DDX_Radio(pDX, IDC_SMALL, m_Size); 
```

（不幸的是，您不能声明`m_Size`为 an`enum`因为`DDX_Radio`需要一个`int`。）

此外，正如[Aiden Ryan 正确指出的那样](https://stackoverflow.com/questions/932315/why-do-my-radio-buttons-not-work/932631#932631)，在 Visual Studio 资源编辑器中，确保单选按钮按对话框选项卡顺序依次显示。第一个单选按钮的 Group 属性应设置为 True，其他单选按钮的 Group 属性应设置为 False。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T16:13:52.523

单选按钮往往用于具有两个以上值的变量，而不是具有三个变量：

```
BOOL m_Small;
BOOL m_Medium;
BOOL m_Large; 
```

你会有一个枚举：

```
enum PizzaSize {Small, Medium, Large}; 
```

和这种类型的变量：

```
PizzaSize m_Size; 
```

单选按钮将设置此变量。

您的代码将变为：

```
switch (m_Size)
{
    case Small:
        m_Summary += char(13);
        m_Summary += char(10);
        m_Summary += "Small Pizza $5.00";
        break;
    case Medium:
        m_Summary += char(13);
        m_Summary += char(10);
        m_Summary += "Medium Pizza $10.00";
    case Large:
        m_Summary += char(13);
        m_Summary += char(10);
        m_Summary += "Large Pizza $15.00";
} 
```

自从我完成 C++ 和 MFC 以来已经有一段时间了，所以将其视为起点而不是最终代码；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T19:03:57.550

ChrisF 的回答非常好，在 MFC 中做单选按钮的正确方法。

一个非常重要的注意事项：确保单选按钮在对话框选项卡顺序中按顺序排列，就像在枚举中一样。

# ruby-on-rails - 指定手动调用有效？

> ID：932327
> 
> 赞同：1
> 
> 时间：2009-05-31T16:00:15.693
> 
> 标签：ruby-on-rails, ruby, rspec

大家好，我完全迷失了这个。

我在网上找到了一个代码片段，以帮助在用户输入字段时通过 ajax 验证字段。因此，我正在尝试针对其中的一部分编写规范，但我无法让它通过。

这是代码

```
def validate
  field = params[:field]
  user = User.new(field => params[:value])
  output = ""
  user.valid?
  if user.errors[field] != nil
    if user.errors[field].class == String
      output = "#{field.titleize} #{user.errors[field]}" 
    else
      output = "#{field.titleize} #{user.errors[field].to_sentence}" 
    end
  end
  render :text => output
end 
```

到目前为止，这是我的测试

```
 describe "POST validate" do
    it "retrieves the user based on the past in username" do
      mock_errors ||= mock("errors")
      mock_errors.stub!(:[]).and_return(nil)
      User.should_receive(:new).with({'username'=>"UserName"}).and_return(mock_user)
      mock_user.should_receive(:valid?).and_return(true)
      mock_errors.should_receive(:[]).with("username").and_return(nil)
      put :validate, :field=>'username', :value=>'UserName'      
      response.should == ""
    end
  end 
```

我得到这个错误 -

> 1) Spec::Mocks::MockExpectationError in 'UsersController POST validate 根据用户名中的过去检索用户' Mock 'errors' 收到意外消息：[] with ("username")

我似乎无法弄清楚世界上如何模拟对 user.errors[field] 的调用。理想情况下，此规范测试快乐的路径，没有错误。然后我会为验证失败写另一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T18:48:27.503

我没有看到 mock_user。这是一个镜头：

```
describe "POST validate" do
  it "retrieves the user based on the past in username" do
    mock_errors = mock("errors")
    mock_user = mock("user")
    mock_user.stub!(:errors).and_return([mock_errors])
    mock_errors.stub!(:[]).and_return(nil)
    User.should_receive(:new).with({'username'=>"UserName"}).and_return(mock_user)
    mock_user.should_receive(:valid?).and_return(true)
    mock_errors.should_receive(:[]).with("username").and_return(ActiveRecord::Errors.new({}))
    put :validate, :field=>'username', :value=>'UserName'      
    response.should == ""
  end
end 
```

关键是您需要您的用户模拟通过返回空哈希或字段名/错误的哈希来响应错误方法。另一种方法是使用其中一种夹具更换工具。我现在正在使用机械师，这可能会将整个事情简化为：

```
describe "POST validate" do
  it "retrieves the user based on the past in username" do
    @user = User.make{'username'=>"UserName"}
    @user.should_receive(:valid?).and_return(true)
    @user.errors.should_receive(:[]).with("username").and_return(ActiveRecord::Errors.new({}))
    put :validate, :field=>'username', :value=>'UserName'      
    response.should == ""
  end
end 
```

# python - Python：定义我自己的运算符？

> ID：932328
> 
> 赞同：89
> 
> 时间：2009-05-31T16:01:39.517
> 
> 标签：python, operators

我想定义我自己的运营商。python支持这样的事情吗？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2009-05-31T18:18:32.767

虽然从技术上讲，您不能在 Python 中定义新的运算符，但这个[巧妙的技巧](http://code.activestate.com/recipes/384122/)可以解决这个限制。它允许您像这样定义中缀运算符：

```
# simple multiplication
x=Infix(lambda x,y: x*y)
print 2 |x| 4
# => 8

# class checking
isa=Infix(lambda x,y: x.__class__==y.__class__)
print [1,2,3] |isa| []
print [1,2,3] <<isa>> []
# => True 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-05-31T16:03:03.133

不，Python 带有一[组预定义但可覆盖的操作符](http://docs.python.org/library/operator.html#mapping-operators-to-functions)。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2009-05-31T16:06:16.050

不，您不能创建新的运算符。但是，如果您只是评估表达式，您可以自己处理字符串并计算新运算符的结果。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-12-18T19:47:32.217

Sage 提供了这个功能，本质上是使用@Ayman Hourieh 描述的“聪明的技巧”，但作为装饰器被合并到一个模块中，以提供更清晰的外观和附加功能——您可以选择运算符重载，从而选择评估顺序。

```
from sage.misc.decorators import infix_operator

@infix_operator('multiply')
def dot(a,b):
    return a.dot_product(b)
u=vector([1,2,3])
v=vector([5,4,3])
print(u *dot* v)
# => 22

@infix_operator('or')
def plus(x,y):
    return x*y
print(2 |plus| 4)
# => 6 
```

有关更多信息，请参阅[Sage 文档](http://www.sagemath.org/doc/reference/misc/sage/misc/decorators.html)和[此增强跟踪票证](http://trac.sagemath.org/ticket/6245)。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2015-01-09T10:32:36.123

Python 3.5 引入了`@`额外运算符的符号。

[PEP465](http://legacy.python.org/dev/peps/pep-0465/)为矩阵乘法引入了这个新的运算符，以简化许多数字代码的符号。该运算符不会针对所有类型实现，而仅针对类似数组的对象。

您可以通过实现来支持您的类/对象的运算符`__matmul__()`。

PEP 为非数组类对象的运算符的不同用法留出了空间。

当然，您也可以`@`对类似数组的对象使用不同于矩阵乘法的任何类型的操作来实现，但用户体验会受到影响，因为每个人都希望您的数据类型以不同的方式表现。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-31T16:27:43.553

如果您打算将操作应用于特定类的对象，您可以覆盖与您的函数最接近的运算符...例如，覆盖`__eq__()`将覆盖`==`运算符以返回您想要的任何内容。这适用于几乎所有的运营商。

# .net - 允许多站点品牌化的 ASP.NET 免费（开源）电子商务站点？

> ID：932332
> 
> 赞同：0
> 
> 时间：2009-05-31T16:02:31.963
> 
> 标签：.net, portal, branding, affiliate

我正在寻找免费/开源的电子商务产品。具体来说，我需要的是多站点支持，允许每个站点都为供应商打上烙印。基本上，我有一家实体店，我想提供一项服务，让人们拥有自己的网站来访问我的库存。有点像 CafePress.com，但不完全一样。

我看过 mojoPortal（没有功能齐全的电子商务）、nopCommerce、dashCommerce 和 DNN。我没有在功能中找到对多站点的引用。我怀疑 DNN 可能能够根据支持的大小来做到这一点。

有没有人对上述多站点电子商务有任何经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-07T14:25:16.443

您可以为自己做一些简单的事情，并更快地完成一些事情。

与其为您的供应商提供电子商务网站，不如为他们提供一组 Web 服务，他们可以使用这些服务来检查您的库存，以及进行预订和订购。

这将由能够拥有自己的站点或希望集成其后端系统的供应商使用。

稍后您可以为您的电子商务网站使用相同的网络服务。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-12T03:45:08.947

我熟悉 Nopcommerce 并且非常有信心您可以通过设置多个不同的站点或一个具有多个主题的站点来做到这一点，其中根据域/子域使用正确的主题（包括品牌）......并删除 Nopcommerce text 只需 50 美元，使其成为一个非常具有成本效益的解决方案......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T03:46:20.987

虽然许多产品支持多站点/门户，但我没有找到任何允许门户透明品牌的东西。

我的解决方案是采用 NB_Store [http://www.codeplex.com/NBStore](http://www.codeplex.com/NBStore)，一个用于 DNN 的开源电子商务模块，并根据我的需要修改代码。

# c# - C# 更改桌面模式

> ID：932336
> 
> 赞同：2
> 
> 时间：2009-05-31T16:03:41.823
> 
> 标签：c#, user-interface, design-patterns, wallpaper

我正在制作一个简单的壁纸更换器。它在更换壁纸时有效，但我无法更改壁纸的图案。我试过这样的东西，但它不起作用：S

```
SystemParametersInfo(SPI_SETDESKPATTERN, 0, "Center",
SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE); 
```

有人可以告诉我设置壁纸图案的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T01:00:04.787

我假设您的意思是居中/拉伸/平铺设置，这将是第二个过去值 int 1-3

```
[DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern Int32 SystemParametersInfo(UInt32 action, UInt32 uParam, String vParam, UInt32 winIni);
        private static readonly UInt32 SPI_SETDESKWALLPAPER = 0x14;
        private static readonly UInt32 SPIF_UPDATEINIFILE = 0x01;
        private static readonly UInt32 SPIF_SENDWININICHANGE = 0x02;

        private void SetWallpaper(string path)
        {
            if (File.Exists(path))
            {
                Image imgInFile = Image.FromFile(path);
                try
                {
                    imgInFile.Save(SaveFile, ImageFormat.Bmp);
                    SystemParametersInfo(SPI_SETDESKWALLPAPER, 3, SaveFile, SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
                }
                catch
                {
                    MessageBox.Show("error in setting the wallpaper");
                }
                finally
                {
                    imgInFile.Dispose();
                }
            }
        } 
```

# c# - .NET 程序集插件安全性

> ID：932339
> 
> 赞同：11
> 
> 时间：2009-05-31T16:04:03.900
> 
> 标签：c#, security, reflection, plugins

我在许多应用程序中使用了以下代码来加载公开插件的 .DLL 程序集。

但是，我以前总是关心功能，而不是安全性。

我现在计划在一个 Web 应用程序上使用这种方法，该应用程序可以由我以外的组使用，并且我想确保该功能的安全性符合要求。

```
private void LoadPlugins(string pluginsDirectory)
{
    List<IPluginFactory> factories = new List<IPluginFactory>();

    foreach (string path in Directory.GetFiles(pluginsDirectory, "*.dll"))
    {
        Assembly assembly = Assembly.LoadFile(path);
        foreach (Type type in assembly.GetTypes())
        {
            IPluginEnumerator instance = null;
            if (type.GetInterface("IPluginEnumerator") != null)
                instance = (IPluginEnumerator)Activator.CreateInstance(type);
            if (instance != null)
            {
                factories.AddRange(instance.EnumerateFactories());
            }
        }
    }

    // Here, I would usually collate the plugins into List<ISpecificPlugin>, etc.
} 
```

我最关心的几个问题：

1.  该函数读取整个目录，并不关心它加载了哪些程序集，而只是加载了所有程序集。有没有办法在使用 Assembly.LoadFile() 加载程序集之前检测程序集是否是有效的、功能正常的 .NET 程序集？
2.  应该在函数中添加什么样的异常处理来防止程序集的初始化停止我的代码？
3.  如果我想拒绝程序集执行以下操作的权利：读/写文件、读/写注册表等，我该怎么做？

还有其他我应该担心的安全问题吗？

**编辑：请记住，我希望任何人都能够编写插件，但我仍然想要安全。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-08-29T00:23:51.300

1）用某个键强命名程序集。

*   您不必**将**其放入 GAC
*   您可以重复使用密钥来签署多个程序集
*   当您重新使用密钥时，您会在每个签名程序集中获得相同的“公钥”

2）在加载时，检查程序集是否已使用您期望的密钥进行强命名

*   您可以将公钥存储为二进制文件、嵌入式资源或使用执行程序集的现有公钥
*   最后一种方法可能不是最好的方法，因为您可能希望区分使用“插件”密钥签名的程序集与使用常规密钥签名的程序集）

例子：

```
public static StrongName GetStrongName(Assembly assembly)
{
    if(assembly == null)
        throw new ArgumentNullException("assembly");
    AssemblyName assemblyName = assembly.GetName();

    // get the public key blob
    byte[] publicKey = assemblyName.GetPublicKey();
    if(publicKey == null || publicKey.Length == 0)
       throw new InvalidOperationException( String.Format("{0} is not strongly named", assembly));

    StrongNamePublicKeyBlob keyBlob = new StrongNamePublicKeyBlob(publicKey);

    // create the StrongName
    return new StrongName(keyBlob, assemblyName.Name, assemblyName.Version);
}

// load the assembly:
Assembly asm = Assembly.LoadFile(path);
StrongName sn = GetStrongName(asm);

// at this point
// A: assembly is loaded
// B: assembly is signed
// C: we're reasonably certain the assembly has not been tampered with
// (the mechanism for this check, and it's weaknesses, are documented elsewhere)

// all that remains is to compare the assembly's public key with 
// a copy you've stored for this purpose, let's use the executing assembly's strong name
StrongName mySn = GetStrongName(Assembly.GetExecutingAssembly());

// if the sn does not match, put this loaded assembly in jail
if (mySn.PublicKey!=sn.PublicKey)
    return false; 
```

注意：代码未经测试或编译，可能包含语法错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-28T18:21:14.430

我不知道这是否是最好的方法，但是当您在无效程序集上调用 LoadFile 时，您将收到 BadImageFOrmatException，因为程序集没有清单。

您当前编写代码的方式非常容易受到[Process Control Attack](http://cwe.mitre.org/data/definitions/114.html)的影响。任何可以访问该目录并下拉实现您的接口的程序集的人都可以执行此攻击。他们甚至不必很好地实现接口，他们只需提供一个默认构造函数并在其中造成所有损害。这允许攻击者在您的应用程序的权限下执行代码，这总是不好的。

因此，您当前唯一的保护是保护对操作系统级别的目录的访问。这可能对您有用，但它只是一种防御级别，您依赖于您无法控制的安全状态。

您可以查看以下两件事：

1.  强命名程序集并要求在 GAC 中注册程序集很可能是最安全的方法。如果你能做到这一点，你需要找到一种方法来为你的应用程序提供程序集的全名并使用 Assembly.Load() 加载它。

但是我怀疑你想将这些插件安装到 GAC 中，所以你可以这样做：

2.  在您的应用程序中为用户提供一种注册插件的方式，本质上是一个迷你 GAC。当他们这样做时，您存储程序集的位置和名称以及公钥。这要求大会是强命名的。

这样，您将只加载对您的应用程序具有权限的人提供的程序集，很可能是有权添加插件的人。在加载程序集之前，您可以检查公钥是否与注册程序集时提供的内容相匹配，以防止攻击者只是替换程序集。这段代码相当简单：

```
 private bool DoPublicKeysCompare(Assembly assembly, byte[] expectedPublicKey)
    {
        byte[] assemblyKey = assembly.GetName().GetPublicKey();
        return expectedPublicKey.SequenceEqual(assemblyKey);
    } 
```

因此，现在要对您执行攻击，我必须以某种方式获得更改 PublicToken 值并访问目录并更改文件的特权。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T16:35:54.113

1.  如果您担心程序集的安全性，您应该[强烈命名](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)它们。这提供了高级别的安全性，该程序集确实是您想要的程序集。

2.  加载过程中可能遇到的异常如下。在您的加载尝试周围添加 try/catch Assembly.Load() 并根据错误类型做出反应：

    *   参数NullException
    *   文件加载异常
    *   FileNotFoundException
    *   坏图像格式异常
3.  您动态加载的程序集应该与加载它们的用户帐户具有相同的权限，除非此程序集在 GAC 中。创建一个具有所需权限的服务帐户，并使用此帐户运行您的应用程序以控制访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T17:07:12.780

如果您运行的是 3.5，那么对于新的 System.AddIns 内容有很多话要说 - 请查看[http://www.codeplex.com/clraddins](http://www.codeplex.com/clraddins)以获取示例。

-Oisin

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-29T00:49:01.463

看看 Microsoft 的 AddIn 框架，因为它提供了一些您正在寻找的功能，例如安全性和隔离性。

我还建议您使用仅反射方法，例如 ReflectionOnlyLoad 和 ReflectionOnlyLoadFrom，以确保在您检查元数据的程序集中不会执行任何操作。一旦您确定程序集具有您要查找的内容，您就可以加载它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-31T18:26:30.727

我自己的偏好是使用 Assembly.ReflectionOnlyLoadFrom(...)

有关详细信息，请参阅以下 MSDN 文章：

[如何：将程序集加载到仅反射上下文中](http://msdn.microsoft.com/en-us/library/ms172331.aspx)

# version-control - 从一个代码库开发多种产品的策略

> ID：932344
> 
> 赞同：6
> 
> 时间：2009-05-31T16:05:55.473
> 
> 标签：version-control, build-process, release-management

我正在开发一个项目，该项目将（很快）分支为多个不同版本（试用版、专业版、企业版等）。

自从 Subversion 首次发布（以及之前的 CVS）以来，我一直在使用它，所以我对分支和标签的抽象概念感到满意。但在我所有的开发经验中，我只真正研究过主干代码。在极少数情况下，其他一些开发人员（拥有存储库）要求我将更改提交到某个分支，而我只是按照他的要求去做。我认为“合并”是一种奇异的魔法，而且我只是在仔细监督下尝试过。

但在这种情况下，我负责存储库，这种事情对我来说是全新的。

绝大多数代码将在所有产品之间共享，因此我假设代码将始终驻留在主干中。我还假设每个版本都有一个分支，每个产品的发布版本都有标签。

但除此之外，我知道的不多，而且我敢肯定有一千零一种不同的方法来搞砸它。如果可能的话，我想避免把它搞砸。

例如，假设我想为专业版和企业版开发一个新功能，但我想从演示版中排除该功能。我将如何做到这一点？

在我的日常开发中，我还假设我需要在工作时将我的开发快照从一个分支切换到另一个分支（或返回到主干）。以最小化混乱的方式做到这一点的最佳方法是什么？

你们还有什么其他的策略、指导方针和技巧建议？

* * *

**更新：**

好吧，那好吧。

看起来分支根本不是正确的策略。因此，我更改了问题的标题以删除“分支”焦点，并且我正在扩大问题范围。

我想我的其他一些选择是：

1) 我始终可以分发具有所有功能的软件的完整版本，并使用许可证根据许可证中的授权选择性地启用和禁用功能。如果我采用这条路线，我可以想象 if/else 块的老鼠巢调用某种单例“许可证管理器”对象。在这种情况下避免代码意大利面的最佳方法是什么？

2）我可以使用依赖注入。但总的来说，我讨厌它（因为它将逻辑从源代码移动到配置文件中，这使得项目更难理解）。即便如此，我仍在分发完整的应用程序并在运行时选择功能。如果可能，我宁愿不将企业版二进制文件分发给演示用户。

3) 如果我的平台支持条件编译，我可以使用#IFDEF 块和构建标志来选择性地包含功能。这对于像整个 GUI 面板这样的大而粗的功能来说效果很好。但是对于较小的跨领域音乐会呢……例如日志记录或统计跟踪？

4）我正在使用ANT来构建。是否有类似 ANT 的构建时依赖注入之类的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T16:09:54.727

你想通过 Subversion 做到这一点吗？我会使用 Subversion 来维护不同的*版本*（每个版本都有一个分支，例如 v1.0、v2.0 等），但我会考虑从*同一个*代码库构建不同的版本（试用版/专业版等）。

这样，您只需通过构建启用或禁用各种功能，而不必担心同步不同的分支。如果您使用 Subversion 来管理不同的发行版和不同的版本，我可以在不久的将来看到分支/标签的爆炸式增长。

对于切换，您可以简单地维护一个签出的代码库，并使用[svn switch](http://svnbook.red-bean.com/en/1.0/re27.html)签出不同的版本。这比为每个交换机执行新的检查要少得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T01:54:58.180

一个最有趣的问题。我喜欢分发所有内容然后使用许可证密钥来启用和禁用某些功能的想法。您确实担心通过代码并继续检查用户是否获得特定功能的许可需要大量工作。这听起来很像您在使用 java 工作，所以我建议您考虑使用方面编织器在构建时插入用于许可证检查的代码。仍然会有一个对象，所有对许可证检查的调用都会进入其中，但是如果您使用的是方面，这并不是一种糟糕的做法，我会说这是一种很好的做法。

在大多数情况下，您只需要阅读某些内容是否已获得许可，并且您将拥有少量组件，因此该表可以始终保存在内存中，并且因为它只是读取，所以您不应该在线程方面遇到太多麻烦.

作为替代方案，您可以分发多个 jar，每个组件一个，每个组件都获得许可，并且只允许加载获得许可的类。您必须绑定到类加载器才能实现这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T16:29:05.427

你不要这么快跳上分支和合并车是对的。这是一个皮塔饼。

我想要分支 subversion 存储库的唯一原因是如果我想与其他开发人员共享我的代码。例如，如果您一起处理一个功能但尚未完成，您应该使用分支进行通信。否则，我会尽可能地呆在树干上。

我赞同 Brian 的建议，以区分构建版本而不是代码库版本。

# c# - C# 位图图像、字节数组和流！

> ID：932353
> 
> 赞同：1
> 
> 时间：2009-05-31T16:11:39.547
> 
> 标签：c#, arrays, image, stream, byte

我有一个将文件提取到字节数组（数据）中的函数。

```
 int contentLength = postedFile.ContentLength;
        byte[] data = new byte[contentLength];
        postedFile.InputStream.Read(data, 0, contentLength); 
```

后来我用这个字节数组构造了一个System.Drawing.Image对象（其中data是字节数组）

```
 MemoryStream ms = new MemoryStream(data);
       Image bitmap = Image.FromStream(ms); 
```

我收到以下异常“ArgumentException：参数无效”。

原始发布的文件包含一个 500k 的 jpeg 图像......

任何想法为什么这不起作用？

注意：我向您保证，我有充分的理由先转换为字节数组，然后再转换为内存流！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T16:27:17.140

这很可能是因为您没有将所有文件数据都放入字节数组中。Read 方法不必返回您请求的字节数，它返回实际放入数组中的字节数。您必须循环直到获得所有数据：

```
int contentLength = postedFile.ContentLength;
byte[] data = new byte[contentLength];
for (int pos = 0; pos < contentLength; ) {
   pos += postedFile.InputStream.Read(data, pos, contentLength - pos);
} 
```

这是从流中读取时的常见错误。我已经多次看到这个问题。

编辑：
正如马修建议的那样，通过检查流的提前结束，代码将是：

```
int contentLength = postedFile.ContentLength;
byte[] data = new byte[contentLength];
for (int pos = 0; pos < contentLength; ) {
   int len = postedFile.InputStream.Read(data, pos, contentLength - pos);
   if (len == 0) {
      throw new ApplicationException("Upload aborted.");
   }
   pos += len;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T16:25:21.837

您没有检查postedFile.InputStream 的返回值。[阅读](http://msdn.microsoft.com/en-us/library/system.io.stream.read.aspx)。完全*不能*保证在第一次调用时填充数组。这将在数​​据中留下损坏的 JPEG（0 而不是文件内容）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T16:26:22.460

您是否检查过 Read() 调用的返回值，以验证它实际上正在读取所有内容？也许 Read() 只返回流的一部分，需要您循环 Read() 调用，直到所有字节都用完。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T17:47:05.080

您不简单地这样做的任何原因：

```
Image bitmap = Image.FromStream(postedFile.InputStream); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T16:25:26.067

我在 .NET 中加载可由更强大的图像库打开的图像时遇到问题。.NET 可能不支持您拥有的特定 jpeg 图像。jpeg 文件不仅是一种编码类型，还允许使用多种可能的压缩方案。

您可以尝试使用另一个您知道其格式受支持的图像。

# file - 如何将文件夹中的文件名提取为文本？

> ID：932356
> 
> 赞同：6
> 
> 时间：2009-05-31T16:13:01.167
> 
> 标签：file, directory

例如在 Windows 资源管理器中？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-31T16:16:38.127

在没有*任何*进一步信息的情况下，

```
c:> cd directory
c:> dir > files.txt 
```

将文件列表写入文本文件 (files.txt)

编辑：`dir /b`简单地生成裸文件名

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-31T16:21:04.927

仅用于文件名：

```
c:\dir /b > files.txt 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-31T16:46:01.527

我不确定您是否关心区分文件和目录。下面将当前目录下的文件名写入`listing.txt`.

在 DOS 中：

```
C:\> IF EXIST listing.txt ERASE listing.txt
C:\> FOR %I IN (*.*) DO (ECHO %~nxI) >>listing.txt 
```

在任何[基于 Bourne 的](http://en.wikipedia.org/wiki/Bourne_Shell#Descendants)shell 中：

```
machine$ rm listing.txt
machine$ for f in *; do [ -f $f ] && echo "$f" >> listing.txt ; done 
```

或者：

```
machine$ find . -type f -depth 1 -print > listing.txt 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-31T16:25:19.327

对于 Unix 环境，`cd mydirectory && ls > filelist.txt`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T16:21:02.290

如果我们在谈论 C#，那么以下内容将返回字符串数组中的完整路径：

```
string[] files = Directory.GetFiles(directory); 
```

要获取文件名：

```
foreach (string file in files)
{
    Console.WriteLine(Path.GetFileName(file));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T16:27:46.440

在蟒蛇！它以路径为论据。

```
import os
import sys

if __name__ == '__main__':
    path = sys.argv[1]

    dir = os.listdir(path)
    for fname in dir:
        print fname 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T16:27:51.807

要添加一些额外的通用风格，在 PHP 单行中，如何：

```
<?php file_put_contents("listing.txt", implode(PHP_EOL, glob('*'))); 
```

# entity-framework - 如果我直到现在才与 Entity Framework 相处，有没有机会我会喜欢 .Net 4.0 中的新 EF

> ID：932361
> 
> 赞同：1
> 
> 时间：2009-05-31T16:16:12.510
> 
> 标签：entity-framework, visual-studio-2010, .net-4.0

到目前为止，我不喜欢 EF。虽然我喜欢这些工具以及创建某些类型的映射和关系是多么容易，但其他类型很痛苦，而且 EF 中的 Linq 支持不是那么好（无法创建我自己的过滤器扩展方法）。

.Net 4.0 中的新 EF 是否更好。鉴于我到目前为止所说的，我有机会喜欢它。

我问这个的原因是因为我经常使用 linq2sql 并且不喜欢我正在使用的平台即将过时的感觉。我想升级到与我已有的尽可能相似的东西。

感谢您的意见

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T16:24:30.900

这只是一个意见，但我相信新的EF会有很大的改进。他们几乎肯定会有某种从 Linq 到 SQL 的迁移路径。它是否看起来像 Linq to SQL 是另一回事。这两种工具有一些不同的理念。

虽然 EF 是为企业场景设计的，但我希望下一个版本仍然足够轻量级，足以在小型应用场景中充当 L2S 的充分替代品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T20:58:42.933

到目前为止，我对 EF 4.0 感到非常乐观。MSDN 订阅者已经可以使用[beta 版本](http://blogs.msdn.com/adonet/archive/2009/05/20/entity-framework-4-0-beta-1-bits-now-available-in-the-vs-2010-and-net-4-beta-1.aspx)，它解决了关于 POCO、持久性无知、N 层支持等所有问题。我继续推荐阅读 ADO.NET[团队博客](http://blogs.msdn.com/adonet/)作为了解更改的重要资源。

您无法将它与第一个版本进行比较，因为这是一次非常大的改革，并且发生了很多变化。

也就是说，最初的采用者总是最糟糕的，因为他们是第一个遇到错误和新问题的人，而后来者可以从早期采用者的经验教训中受益。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T20:13:03.630

有很多改进。我遇到了几个奇怪的问题，但还没有解决不了的问题。我花了几个小时才了解 POCO 是如何工作的，这意味着他们花了很多钱。我建议您下载 VS2010 并自己尝试一下！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-03T05:25:04.210

看看这个演示文稿，你就会知道为什么 EF 值得你花时间。

如何像实体框架演示一样思考：http: [//blogs.teamb.com/craigstuntz/2009/09/11/38394/](http://blogs.teamb.com/craigstuntz/2009/09/11/38394/)

# c# - 在 MVC 中实现任务优先级的字典、枚举或其他替代方法？

> ID：932364
> 
> 赞同：0
> 
> 时间：2009-05-31T16:17:08.110
> 
> 标签：c#, model-view-controller, dictionary, enums

我的数据库中有一个任务表，其中包含一个从 1 到 4 的整数值作为测试的优先级字段。我正在使用 LINQ to SQL dbml 文件，所以我有一个任务类，我希望能够在我的视图中向用户显示优先级的文本值，作为选择列表中的值。

我已将以下代码添加到我的任务类中：

```
 static enum Priorities {
        High = 1,
        Medium = 2,
        Low = 3,
        None = 4
    }

    public String GetPriority {
        get {
            Priorities p = (Priorities)priority;
            return p.ToString();
        }
    } 
```

我想在下拉列表中使用优先级，但我不确定如何执行此操作，首先获取要放入选择列表的值列表，然后为任务对象选择正确的值:(

我正在考虑改为执行以下操作并使用字典，但如果有人有一些建议或更好的解决方案，这将非常有用，谢谢。

```
 static IDictionary<string, int> priorityDictionary =
      new Dictionary<string, int>(){
    {"High", 1},
    {"Medium", 2},
    {"Low", 3},
    {"None", 4}
  };

    public static IEnumerable<string> Priorities {
        get { return priorityDictionary.Keys; }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T16:34:43.567

既然最终您将需要它作为`IEnumerable<SelectListItem>`，为什么不创建一个延迟加载的静态属性，其中包含它作为菜单呢？

```
private static List<SelectListItem> priorities;
public static IEnumerable<SelectListItem> PriorityMenu
{
    get
    {
         if (priorities == null)
         {
             priorities = new List<SelectListItem>();
             foreach (var i in Enum.GetValues(typeof(Priority)))
             {
                 priorities.Add( new SelectListItem
                                 {
                                     Text = Enum.GetName( typeof(Priority), i ),
                                     Value = i.ToString()
                                 });
             }
         }
         return priorities;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-11T20:12:13.063

如果您希望您的字符串表示形式与其 Enum.GetName 不同，同时仍保持类型安全，请查看： [C# String enums](https://stackoverflow.com/questions/424366/c-string-enums/4881040#4881040)

# xml - 我可以创建一个 XSD 架构，将一个属性放在所有复杂类型上吗？

> ID：932371
> 
> 赞同：3
> 
> 时间：2009-05-31T16:22:10.793
> 
> 标签：xml, xsd, schema, xml-attribute

我想创建一个 XSD，它定义了一个属性，该属性可以放置在来自其他模式的元素或不在任何模式中的元素上。例如，模式看起来像这样：

```
<xs:schema id="MySchema"
    targetNamespace="http://tempuri.org/MySchema"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/MySchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:attribute name="myAttribute" />
</xs:schema> 
```

该文档可能如下所示：

```
<someElement xmlns="http://tempuri.org/OtherSchema" xmlns:m="http://tempuri.org/MySchema">
  <someOtherElement someAttribute="value" m:myAttribute="value2" />
</someElement> 
```

此示例的“OtherSchema”如下所示：

```
<xs:schema id="OtherSchema"
    targetNamespace="http://tempuri.org/OtherSchema"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/OtherSchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:element name="someElement">
    <xs:complexType>
      <xs:sequence>
        <xs:element minOccurs="0" maxOccurs="unbounded" name="someOtherElement">
          <xs:complexType>
            <xs:attribute name="someAttribute" />
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

可以从[http://dl.getdropbox.com/u/407740/SchemaTest.zip](http://dl.getdropbox.com/u/407740/SchemaTest.zip)下载完整的示例，包括执行验证的 C# 控制台应用程序。我的目标是在无需修改“OtherSchema”的情况下进行验证。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T18:15:04.953

我必须添加一个包装器，将两个不同的模式导入一个（因为 xmllint 只接受一个 xml 模式）：

```
<xs:schema id="Wrapper" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import schemaLocation="MySchema.xsd" namespace="http://tempuri.org/MySchema"/>
  <xs:import schemaLocation="OtherSchema.xsd" namespace="http://tempuri.org/OtherSchema"/>
</xs:schema> 
```

我可以让问题之类的东西起作用的唯一方法是编辑 OtherSchema,xsd （问题不允许这样做），因此附加一个属性通配符（在现有通配符之后）：

```
 <xs:attribute name="someAttribute" />
 <xs:anyAttribute namespace="##other"/> 
```

作为 XML Schema 的专家，我还不足以说“这是不可能的”，但对我来说似乎是不可能的。

您的提案的一个问题是您没有指定新属性应出现的*位置。*通常，如果您声明一个属性（或 complexElement、modelgroup 等），您可以随意引用或不引用它。如果你没有明确地引用它，它就没有效果。因此，我认为您的提案将被视为已声明但未引用的属性。

您真正想要的是一种说“将此属性添加到*每个*现有的 complexType”的方式 - 但您不会这么说。而且，不幸的是，似乎没有办法这么说。（甚至没有办法说“将此属性添加到这个特定的现有 complexType” - 您必须将其包含在原始定义中或根本不包含。）

*部分*做到这一点的一种方法是`<redefine>`输入另一个模式 - 我将在第二个答案中添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T18:38:04.550

您可以**重新定义**架构，随心所欲地扩展它们。通过这种方式，您可以修改现有模式的定义，而无需实际更改文件。但它不适用于您给出的示例，因为无法重新定义元素（只有 complexTypes 等，请参阅 [http://www.w3.org/TR/xmlschema-1/#element-redefine](http://www.w3.org/TR/xmlschema-1/#element-redefine)）。因此，我已将您的示例分解为显式的 complexTypes，以便重新定义它们。

**重新定义OtherSchema.xsd：**

```
<xs:schema id="RedefineOtherSchema"
    targetNamespace="http://tempuri.org/OtherSchema"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/OtherSchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:m="http://tempuri.org/MySchema">          <!-- for the ref -->

  <xs:import schemaLocation="MySchema.xsd"
    namespace="http://tempuri.org/MySchema"/>       <!-- import -->

  <xs:redefine schemaLocation="OtherSchema.xsd">    <!-- redefine -->
    <xs:complexType name="SomeOtherElement">
      <xs:complexContent>
        <xs:extension base="SomeOtherElement">
          <xs:attribute ref="m:myAttribute" />      <!-- the ref -->
        </xs:extension>
      </xs:complexContent>
    </xs:complexType>
  </xs:redefine>
</xs:schema> 
```

**其他架构：**

```
<xs:schema id="OtherSchema"
    targetNamespace="http://tempuri.org/OtherSchema"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/OtherSchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:element name="someElement" type="SomeElement"/>

    <xs:complexType name="SomeElement">
      <xs:sequence>
        <xs:element minOccurs="0" maxOccurs="unbounded"
                    name="someOtherElement" type="SomeOtherElement"/>
      </xs:sequence>
    </xs:complexType>

    <xs:complexType name="SomeOtherElement">
      <xs:attribute name="someAttribute" />
    </xs:complexType>
</xs:schema> 
```

**MySchema：（未**更改）

```
<xs:schema id="MySchema"
    targetNamespace="http://tempuri.org/MySchema"
    elementFormDefault="qualified"
    xmlns="http://tempuri.org/MySchema"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:attribute name="myAttribute"/>
</xs:schema> 
```

**为什么`<complexContent>`？** 重新定义必须是现有类型的扩展（或限制） - 这就是它修改先前定义的方式。扩展名必须在`<complexContent>`（我相信）。

**为什么`<import>`？** 您不能在 xsd 中的多个命名空间中定义事物（只有一个“targetNamespace”）。但是您可以通过从另一个 xsd 导入定义来解决这个问题（然后您没有“定义”它）。【还有其他方法吗？】

HTH :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T20:46:26.273

这正是 NVDL（基于命名空间的验证和调度语言）所提供的。它允许组合多个模式/词汇来验证文档，而无需更改这些模式。NVDL 是一个 ISO 标准。

处理您的案例的工作 NVDL 脚本如下

```
<rules xmlns="http://purl.oclc.org/dsdl/nvdl/ns/structure/1.0" startMode="other">
  <mode name="other">
    <namespace ns="http://tempuri.org/OtherSchema">
      <validate schema="other.xsd" useMode="validateMyAttributes"/>
    </namespace>
  </mode>
  <mode name="validateMyAttributes">
    <namespace ns="http://tempuri.org/MySchema" match="attributes">
      <validate schema="my.xsd"/>
    </namespace>
  </mode>
</rules> 
```

基本上，它说使用 other.xsd 模式验证 ...tempuri.org/OtherSchema 命名空间上的内容以及使用 my.xsd 模式的 ...tempuri.org/MySchema 中的属性。

有关 NVDL 的更多信息，请参见 www.nvdl.org。上面的脚本是用 oNVDL 测试的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-31T16:25:01.823

考虑 xsi:nil、xsi:schemaLocation 和 xsi:noNamespaceSchemaLocation。答案是肯定的。

也不会花很长时间去试一试。

* * *

您在架构中缺少 targetNamespace。试试这个：

```
<xs:schema xmlns="MySchema" xmlns:xs="http://www.w3.org/2001/XMLSchema"
    targetNamespace="MySchema">
  <xs:attribute name="myAttribute" />
</xs:schema> 
```

# mfc - 具有分页功能的 ListView 控件

> ID：932373
> 
> 赞同：0
> 
> 时间：2009-05-31T16:23:58.483
> 
> 标签：mfc

我正在寻找一种类似于 FeedDemon 2.7 中使用的控件。它是一个具有分页功能的 ListView。它将内容分成页面。在控件的底部，您可以看到第 1 页，共 3 页，依此类推。您可以在所附图片的底部看到我的意思：第 1 页，共 3 页。

我希望你明白我的意思。

谢谢。[替代文字 http://img193.imageshack.us/img193/133/listview.jpg](http://img193.imageshack.us/img193/133/listview.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T17:45:36.263

我想屏幕底部的“寻呼机”是与列表本身不同的控件...

看看[这里](http://www.codeproject.com/KB/miscctrl/controls_pager.aspx)作为一个起点。高温高压

# iphone - 黑色 UIToolbar 上的 iPhone UISegmentedControl 按钮状态

> ID：932378
> 
> 赞同：2
> 
> 时间：2009-05-31T16:25:24.130
> 
> 标签：iphone, uisegmentedcontrol, uitoolbar

我在黑色 UIToolbar 上有一个 UISegmentedControl。我已将样式设置为 Bar 并将背景颜色设置为清除（也尝试过黑色）。我尝试将 tintColor 设置为清晰（也尝试过黑色）。我的按钮变成黑色以匹配黑色 UIToolbar。但是，当 UISegmentedControl 是默认的蓝色/灰色时，按钮不再指示单击状态。我该怎么做才能使按钮指示黑色/灰色单击状态？请告诉我。到目前为止用于设置 UISegmentedControl 的颜色的代码：

```
viewTypeSelection.segmentedControlStyle = UISegmentedControlStyleBar;
viewTypeSelection.backgroundColor = [UIColor clearColor]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-28T12:58:27.600

虽然不是一个完美的解决方案，但效果很好

```
 // set the color
viewTypeSelection.segmentedControlStyle = UISegmentedControlStyleBar;
viewTypeSelection.tintColor = [UIColor darkGrayColor]; 
```

按钮有状态变化，看起来不错。这是一篇包含更多详细信息的帖子，可能会帮助寻找类似解决方案的人：

[UISegmentedControl 黑色？](http://forums.macrumors.com/showthread.php?t=541508)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-23T22:55:45.227

您可能已经设置了条形的颜色，`tintColor`而不是`barStyle`像这样设置：

```
self.navigationController.navigationBar.barStyle = UIBarStyleBlackOpaque; 
```

# c++ - gdb 说“无法打开共享对象文件”

> ID：932384
> 
> 赞同：6
> 
> 时间：2009-05-31T16:27:39.560
> 
> 标签：c++, linux, emacs, gdb

我有一个二进制库和一个共享库。共享库编译为：

```
all:
g++ -g -shared -fpic $(SOURCES) -o libmisc.so 
```

二进制文件编译为：

```
LIBS=-L../../misc/src

LDFLAGS=-lmisc

all:
g++ -g -o mainx $(INCLUDE) $(SOURCE) $(LIBS) $(LDFLAGS) 
```

我进去了`~/.bashrc`

```
export LD_LIBRARY_PATH=/mnt/sda5/Programming/misc/src/ 
```

到`libmisc.so`输出路径。

从控制台调试工作正常：

```
gdb mainx 
```

但是，从 Emacs22 启动 gdb 失败并显示以下消息：

> 启动程序：/mnt/sda5/Programming/main/src/mainx /mnt/sda5/Programming/main/src/mainx：加载共享库时出错：libmisc.so：无法打开共享对象文件：没有这样的文件或目录

目前这看起来很棘手，我无法解决。我不确定这是否是 emacs 的问题，或者我应该在 gdb 的命令行中传递一个参数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T16:36:44.173

Emacs 在调用 gdb 之前可能不会读取您的 .bashrc。尝试将 'set solib-search-path' 和 'set solib-absolute-path 放在 .gdbinit 文件中

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T18:16:08.777

Emacs 不会通过 bash 调用 gdb，而是直接调用它，因此 .bashrc 更改不会生效`LD_LIBRARY_PATH`且未设置。

如果你退出 emacs，打开一个新的 shell（如此`LD_LIBRARY_PATH`设置），在其中启动 emacs，然后执行`M-X gdb`，那么它会工作。

在 GDB 中设置`solib-search-path`是一个 hack。

更好的解决方法是以不需要`LD_LIBRARY_PATH`开头的方式构建可执行文件：

```
LDFLAGS=-lmisc -Wl,-rpath=/mnt/sda5/Programming/misc/src 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-08-12T14:48:18.423

另一种方法是在您的文件中创建一个`.gdbinit`文件`$HOME`并在那里设置 LD_LIBRARY_PATH：

```
# file .gdbinit
set env LD_LIBRARY_PATH=/mnt/sda5/Programming/misc/src/ 
```

如果您需要经常使用 LD_LIBRARY_PATH 进行调试（并且不想记住每次都从 shell 运行 emacs），这很方便。

# c# - 如何从 url 保存图像？

> ID：932390
> 
> 赞同：0
> 
> 时间：2009-05-31T16:28:56.797
> 
> 标签：c#, asp.net

如何从 url 获取图像并将其保存在本地？

[http://someurl.com/imagename.jpg](http://someurl.com/imagename.jpg) -> c:\apppath\imgfolder

ASP.NET C#

我对 IO 的东西不是很好，希望有人能帮助我:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T16:31:18.250

试试这个。

```
System.Net.WebClient wc = new System.Net.WebClient();

wc.DownloadFile("http://www.domin.com/picture.jpg", @"C:\Temp\picture.jpg"); 
```

由于您已使用 ASP.NET 对此进行了标记，因此值得指出的是，如果您将此代码放入您的 ASP.NET 网站/Web 应用程序中，则需要确保您的应用程序运行的身份/帐户，有权将文件写入文件系统。

# iphone - 防止 sqlite 转义反斜杠

> ID：932396
> 
> 赞同：2
> 
> 时间：2009-05-31T16:33:55.813
> 
> 标签：iphone, cocoa-touch, sqlite, uitextview

我在 sqlite 数据库中有一个 varchar 列。特定的文本行有一个反斜杠，它与“\n”一起用于 UITextView 中的回车。当通过 SELECT 从数据库中读取值时：

```
myobject.text = [NSString stringWithUTF8String: (char *)sqlite3_column_text(selectstmt, 2)]; 
```

反斜杠被转义，看起来像：

```
"\\n" rather than "\n" 
```

这不解释为回车。如果我在文本中添加两个黑斜线，第二个也将被转义并最终导致在将 textview 添加为子视图时出现异常：

由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[setValue:forUndefinedKey:]：此类不符合键值编码的键测试。”

有没有办法防止这些逃逸或者我需要手动清理它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T16:53:02.437

反斜杠无疑就在列的文本中——您“看到”它是双倍的，因为这就是反斜杠的显示方式（以避免与转义序列混淆）。当您查询时， sqlite 不会*更改*您放在那里的文本——但可以说，数据库中的文本不是您想要接收的。

您需要做的是将两个字符 backslash-n 更改为单个字符`newline`，您可以在数据库中（一劳永逸，或在每个查询中）或在您的 Objective-C 代码中（在每个查询中） ) 取决于您的确切需求。

# java - 使用泛型、类类型解决 IDE 警告

> ID：932398
> 
> 赞同：2
> 
> 时间：2009-05-31T16:34:15.580
> 
> 标签：java, generics, class

```
class Test1<T> {
  Test1(Class<T> type) {}
}

class Test2 extends Test1<Class> {
  Test2() {
    super(Class.class);
  }
} 
```

这可行，但是，我被警告在“ `Test1<Class>`”中使用原始泛型类型。我明白这一点，但是，将其更改为“ `Class<?>`”（应该是等效的？）在调用 super() 时会出现编译器错误——Class.class 显然是“ `Class<Class>`”类型而不是“ `Class<Class<?>>`”。

这些变体似乎都会导致编译错误。

谁能看到如何解决这个问题，这样我总是使用带有 Class 的类型参数，因此不会收到 IDE 警告？那样似乎更好，即使它按原样工作。只要保留基本意图，我对这两个类的结构的更改持开放态度：Test2 是 Test1 的一种特殊类型，专门用于“类”对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T17:00:24.690

`Class`并且`Class<?>`不*完全*等价。它们在*语义上*是等价的，但后者有效地告诉编译器，“是的，我知道这是一个泛型类型，但我对类型参数一无所知。” 前者只是原始类型，这通常表明它是尚未迁移到使用泛型的旧代码。

[Java 泛型常见问题解答](http://www.angelikalanger.com/GenericsFAQ/JavaGenericsFAQ.html)中对此进行了介绍- 请参阅问题“无界通配符参数化类型和原始类型之间有什么区别？” 在[参数化类型部分](http://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedTypes.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T20:28:47.767

您的警告源于它`Class`本身就是一个参数化类的事实：`public final class Class<T>`. 删除警告的最简单方法是`T`使用 type 参数而不是`Class<T>`：

```
class Test1<T> {
    Test1(T type) { Class<?> classType = type.getClass();}
}

class Test2 extends Test1<String> {
    Test2() {
        super("");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T16:37:31.053

我使用 Java 1.6.0_14，编译器在编译该代码时没有给我任何警告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T18:06:34.330

这可能是适合以下情况的时间之一：

```
@SuppressWarnings("unchecked")
class Test2 extends Test1<Class> {
  Test2() {
    super(Class.class);
  }
} 
```

除非您*总是*使用`Test1<Class>`，否则我看不到解决此警告的另一种方法。（如果你跑了，你可能会得到同样的警告`javac -Xlint:unchecked`，但我对此并不肯定。）这里的问题是你通常（我假设）将你的类`Test1`与非泛型值一起使用，但 Class 是一个泛型类将 Class 对象作为其参数。我没有看到任何解决方法，所以我认为最好的解决方案是抑制这个特定的警告，以便*真正的*问题会脱颖而出。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-31T21:57:25.560

简短的回答是没有办法指定类型参数。这是因为 Class 对象（例如，List.class，而不仅仅是 Class.class）不理解泛型类型参数 - 它在编译期间被删除。

我的 IDE，Intellij IDEA，给出了同样的警告。这是IDE过于激进。您可以使用 IDEA 抑制警告（它会生成一个 @SuppressWarnings 注释），但解决它的代码（如 Robert Munteau 的巧妙解决方法）确实引入了一些令人讨厌的设计，只是为了避免出现真正不正确的 IDE 消息 - JDK 确实如此不要将此案视为删除。

编辑：鉴于投反对票，我至少应该在这里证明我的想法。

考虑以下几点：

```
 List.class 
```

这代表一个类型的类对象：

```
 Class<List> 
```

它不能代表以下类型：

```
 Class<List<?>> 
```

因为不知道给定的列表是否真的有一个通用参数或者它将是什么。List.class 对象必须代表所有类型，就参数化 Class 而言。

JDK 不将此视为不安全操作的证据是，如果您编译代码，它不会给您任何警告。

所以IDE只是过于敏感。尽管提问者没有指定他使用哪个 IDE，但我在 Intellij IDEA 8.1.2 中看到了这种行为。

# c# - 如何获取 MessageBox 按钮标题？

> ID：932401
> 
> 赞同：7
> 
> 时间：2009-05-31T16:35:01.150
> 
> 标签：c#, .net, winforms, messagebox

我正在制作一个允许您复制文本的自定义消息框，但我希望它看起来与标准消息框完全一样，因此我想将按钮文本设置为任何系统语言，就像 MessageBox 类一样。有谁知道如何获取该文本（“是”、“否”、“取消”等）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T18:17:25.403

感谢您对 Snarfblam 链接的回答，我可以弄清楚其余的。

```
class Program {

[DllImport("user32.dll", CharSet = CharSet.Auto)]
static extern int LoadString(IntPtr hInstance, uint uID, StringBuilder lpBuffer, int nBufferMax);
[DllImport("kernel32")]
static extern IntPtr LoadLibrary(string lpFileName);

private const uint OK_CAPTION = 800;
private const uint CANCEL_CAPTION = 801;
private const uint ABORT_CAPTION = 802;
private const uint RETRY_CAPTION = 803;
private const uint IGNORE_CAPTION = 804;
private const uint YES_CAPTION = 805;
private const uint NO_CAPTION = 806;
private const uint CLOSE_CAPTION = 807;
private const uint HELP_CAPTION = 808;
private const uint TRYAGAIN_CAPTION = 809;
private const uint CONTINUE_CAPTION = 810;

static void Main(string[] args) {
    StringBuilder sb = new StringBuilder(256);

    IntPtr user32 = LoadLibrary(Environment.SystemDirectory + "\\User32.dll");

    LoadString(user32, OK_CAPTION, sb, sb.Capacity);
    string ok = sb.ToString();

    LoadString(user32, CANCEL_CAPTION, sb, sb.Capacity);
    string cancel = sb.ToString();

    LoadString(user32, ABORT_CAPTION, sb, sb.Capacity);
    string abort = sb.ToString();

    LoadString(user32, RETRY_CAPTION, sb, sb.Capacity);
    string retry = sb.ToString();

    LoadString(user32, IGNORE_CAPTION, sb, sb.Capacity);
    string ignore = sb.ToString();

    LoadString(user32, YES_CAPTION, sb, sb.Capacity);
    string yes = sb.ToString();

    LoadString(user32, NO_CAPTION, sb, sb.Capacity);
    string no = sb.ToString();

    LoadString(user32, CLOSE_CAPTION, sb, sb.Capacity);
    string close = sb.ToString();

    LoadString(user32, HELP_CAPTION, sb, sb.Capacity);
    string help = sb.ToString();

    LoadString(user32, TRYAGAIN_CAPTION, sb, sb.Capacity);
    string tryAgain = sb.ToString();

    LoadString(user32, CONTINUE_CAPTION, sb, sb.Capacity);
    string cont = sb.ToString();

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T17:46:48.793

这些字符串似乎存储在 User32.dll 库中。[在 Pure BASIC 论坛的讨论](http://www.purebasic.fr/english/viewtopic.php?t=24134&sid=cf59f7045f38869cb347d09ad9e73f6e)中有详细信息，靠近底部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T17:20:09.673

您可以在[Reflector](http://www.red-gate.com/products/reflector/)中打开 System.Windows.Forms.dll并查看它是如何设置按钮文本的。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-05-31T17:08:19.593

在您输入该消息时，您可以输入“Yes”、“No”、“Ok”、“Cancel”……

# html - 如何在 XML Schema 中创建允许任何 HTML 元素作为其子元素的元素？

> ID：932408
> 
> 赞同：1
> 
> 时间：2009-05-31T16:37:29.913
> 
> 标签：html, xml, namespaces, xsd

我正在尝试在 XML 模式中创建一个元素，以便只有标准 (X)HTML 元素可以用作子元素。我试过的是这样的：

```
<xs:element name="description">
    <xs:complexType>
        <xs:sequence minOccurs="0" maxOccurs="unbounded">
            <xs:any namespace="http://www.w3.org/1999/xhtml" />
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

当然，这不起作用，因为以下 XML 没有明确指定命名空间：

```
<description>
    <p>this is a test</p>
    <p>this is a <b>bold</b> test</p>
    <h1>Those were the tests</h1>
</description> 
```

我是否需要在文档中的某处指定名称空间，还是可以在架构中获取它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T16:43:18.020

我认为您需要因此禁用内容处理：

```
 <xs:any namespace="http://www.w3.org/1999/xhtml" processContents="skip"/> 
```

请参阅XML Schema 规范中的[第 5.5 节（特别是示例）](http://www.w3.org/TR/xmlschema-0/#any)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-06T08:45:46.350

您的架构看起来不错。请注意，xs:any/@processContents 的默认值是严格的，这意味着您的 XHTML 元素也将被验证，因此您还需要一个 XHTML 模式并将其从您的模式中导入。您可以在 xs:any 中使用 processContents="lax" 来指定仅当存在这些元素的架构时才会应用验证。

您的问题在于您应该为 XHTML 元素指定名称空间的情况。您可以将 XHTML 命名空间声明为每个元素的默认命名空间，例如

```
<p xmlns="http://www.w3.org/1999/xhtml">this is a test</p> 
```

或者您可以声明它绑定到一个前缀，例如 h，然后使用该前缀来限定您的 XHTML 元素：

```
<description xmlns:h="http://www.w3.org/1999/xhtml">
  <h:p>this is a test</h:p>
  <h:p>this is a <b>bold</b> test</h:p>
  <h:h1>Those were the tests</h:h1>
</description> 
```

DTD 不知道命名空间，并且命名空间声明只是属性，因此可以在元素上声明一个固定的 xmlns 属性以将其自动放入特定的命名空间。XML Schema 可以识别命名空间，并且您不能将命名空间声明作为固定属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T20:44:30.123

我认为您确实需要[查看此页面](http://msdn.microsoft.com/en-us/library/ms190756.aspx)

# database - 如何在发布之前在本地服务器或测试服务器上开发 drupal 站点

> ID：932411
> 
> 赞同：0
> 
> 时间：2009-05-31T16:38:03.907
> 
> 标签：database, svn, version-control, drupal

（实际站点名称已更改）

我在elephantboarding.com 上安装了drupal，它处于版本控制之下。

在我 svn 在 megafishoil.com 中提交安装后，我在landonwinters.com/elephantboarding 中更新了 svn。

但是landonwinters.com/elephantboarding 看起来很奇怪，好像它没有正确设置默认主题，它是无主题的。不过它确实有一个登录的地方，它在顶部显示 www.elephantboarding.com。

我假设它与数据库有关......但如果我将landonwinters.com/elephantboarding 是 megafishoil.com 的镜像，并且如果我可以在没有看到的情况下对 landonwinters.com/elephantboarding 进行更改，那肯定会很酷在我更新 svn 之前，elephantboarding.com 中的这些变化。

抱歉新手，提前感谢您的帮助！

哦，我确实有一个本地服务器，虽然我不知道如何 svn checkout 到我自己的电脑......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T17:18:00.067

是的，有可能——我在[http://www.blah.net运行一个 drupal 站点，在](http://www.blah.net)[http://dev.blah.net](http://dev.blah.net)运行一个开发/测试站点。它们都使用相同的代码，从共享的 svn 存储库中签出，并且都使用相同的数据库。

根据以下条件，这对我来说很好：

您的 settings.php 中定义 $base_url 的行需要被注释掉。

定义 $cookie_domain 的行需要替换为服务器名称的条件，以防止登录变得疯狂。：

```
if(preg_match('/dev/i', $_SERVER['SERVER_NAME'])) {
    $cookie_domain = 'dev.blah.net';
} else {
    $cookie_domain = 'www.blah.net';
} 
```

虽然这对我来说一切都很好，那是因为我的路径映射方式完全相同（drupal 应用程序都位于域的根目录上）。我最初有 www.blah.net/dev，但由于路径不再起作用，所以它坏了。

Soo，解决方案是确保路径映射。您是否有足够的访问权限在要测试的站点上实现 Apache VirtualHost？如果是这样，那么您可以像这样添加一个虚拟主机条目：

```
<VirtualHost dev.blah.net:80>
        ServerName dev.blah.net
        ServerAlias blah.net

        DirectoryIndex index.php

        #change this to the path to the drupal install
        DocumentRoot /www/htdocs/ 

        <Directory "/www/htdocs">
                ## Allow CGI and Symbolic Links
                Options +FollowSymLinks +ExecCGI

                # NOTE - The FileInfo override allows rewrites to work in htaccess files
                AllowOverride All

                Order allow,deny
                Allow from all
        </Directory>

</VirtualHost> 
```

另一个注意事项是，虽然您可以毫无问题地维护单独的模板和物理文件，但如果您通过管理面板更改配置，这些设置将存储在数据库中，因此将对共享数据库的所有安装生效。块是这个问题的一个典型例子，因为它们存储在数据库中。

基本上你不能有两组不同的drupal路径映射（当然，你可以做一些疯狂的apache重写，但这会变得非常混乱）。如果您有足够的访问权限，虚拟主机的答案可能是最不痛苦的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-27T07:45:35.117

复制 Drupal 安装（包括数据库）后，我遇到了类似的问题。

就主题而言，如果您使用了颜色模块，则需要在新安装中重新创建该文件。

只需转到主题配置页面，确保颜色符合您的要求，单击保存配置，Drupal 将为颜色制作正确的文件，主题将从完全丢失到工作正常。

# c# - 使用 C# 生成 Word 文档

> ID：932414
> 
> 赞同：2
> 
> 时间：2009-05-31T16:38:57.057
> 
> 标签：c#, .net, reporting-services, ms-word, openxml

给定一个邮寄地址列表，我需要打开一个现有的 Word 文档，该文档的格式可以打印标签，然后将每个地址插入表格的不同单元格中。当前解决方案打开 Word 应用程序并移动光标以插入文本。但是，在阅读了与从 Web 应用程序打开较新版本 Word 相关的安全问题和问题后，我决定需要使用另一种方法。

我已经研究过使用 Office Open XML，但我还没有找到任何好的资源来提供关于如何使用它的具体信息。另外，有人建议我使用 SQL 报告服务，但搜索有关如何使用它们的信息，却一无所获。

您认为哪种方法最适合我的问题？

代码示例和优秀教程的链接将非常有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-02T22:39:56.393

感谢所有答案，但我真的不想为插件付费，而且使用 Word 自动化是不可能的。所以我一直在寻找，最终通过反复试验，找到了一些答案。

在彻底搜索了微软的网站后，我发现了一些关于 Office Open XML SDK 的更新文章。我下载了新工具并开始浏览它们。

然后我找到了 Document Reflector，它创建了一个类来基于现有的 Word 文档 (.docx) 生成 XML 代码。使用我的标签模板文档和该工具生成的代码，我完成并添加了一个循环，为每个地址附加表格单元格。事实证明，它比使用 Word 自动化相当简单且速度更快。

因此，如果您仍在使用 Word 自动化，请查看 Office Open XML 工具。它们令人惊讶地广泛，可从 Microsoft 免费下载。

[Office Open XML SDK 2.0 下载](http://www.microsoft.com/downloads/details.aspx?FamilyId=C6E744E5-36E9-45F5-8D8C-331DF206E0D0&displaylang=en)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T16:44:58.127

我使用[Aspose.com](http://www.aspose.com/)的 Words 插件进行邮件合并（[编程指南](http://www.aspose.com/documentation/file-format-components/aspose.words-for-.net-and-java/perform-mail-merge.html)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T19:07:31.177

您可以在 dnrTV ( [www.dnrtv.com](http://www.dnrtv.com/archives.aspx) ) 上观看 137 和 138 节目。在这些视频中，Beth Massi 展示了如何使用 OpenXML 进行一些编辑和邮件合并。她通过在 VB 中使用 Open XML SDK 和 xml 文字来做到这一点。它不需要第三方组件。它也不需要在机器上安装 MS Office。

这个视频启发了我作为一个 C# 开发人员（并且没有 VB 经验）在 VB 中的一个单独的 dll 中进行一些 XML 操作。我从我的 C# 应用程序调用这个 dll。

值得一试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T16:57:49.360

我们有 tvanfosson 提到的产品 Aspose。我们购买的版本与 SQL Reporting Services 一起使用，因此可以与调度程序一起使用以创建输出。它真的是一个很棒的产品，我们在一个需要在最终文档中支持韩文字符的系统中使用它。它工作得很好，在支持下不到 1000 美元。不错。

使用这样的产品的优点是您可以继续管理您的数据，并且生成文档所需的技能集处于各种开发人员可以支持其使用的水平。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T16:49:04.080

范斯蒂，

如果您真的想在代码中执行此操作，请查看我刚刚在 Google 上找到的这篇文章

[http://kellychronicles.spaces.live.com/blog/cns!A0D71E1614E8DBF8!1364.entry](http://kellychronicles.spaces.live.com/blog/cns!A0D71E1614E8DBF8!1364.entry)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T12:09:04.153

如果您正在使用报告服务，您不能将单词 doc 中的信息移动到数据库表中并从那里读取，从而将单词排除在等式之外？

# http - Google Wave 中的实时输入是如何工作的？

> ID：932415
> 
> 赞同：34
> 
> 时间：2009-05-31T16:39:23.843
> 
> 标签：http, gwt, html, google-wave

我确信 Wave 不会每毫秒轮询服务器以查明其他用户是否输入了某些内容……那么我如何才能看到其他人在输入时输入的内容？并且不会占用带宽。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-31T16:43:49.063

持久 HTTP，[彗星](http://en.wikipedia.org/wiki/Comet_(programming))

保持 HTTP 连接处于活动状态并在输入字符时发送字符

* 2014 年编辑：另外，看看 WebSocket 和[HTTP/1.1 升级标头](http://en.wikipedia.org/wiki/HTTP/1.1_Upgrade_header)。浏览器在 2010 年左右开始实施此功能，因此我将其添加到原始答案中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T09:06:21.007

他们可能使用 Web Sockets，也就是服务器发送的事件：[http](http://www.w3.org/TR/websockets) ://www.w3.org/TR/websockets可以[在 IETF](https://datatracker.ietf.org/doc/html/draft-hixie-thewebsocketprotocol)找到底层协议（作为草案） 。

更新：似乎 WebSockets 还没有任何实现；[来自 Google I/O 的视频](http://code.google.com/intl/fr-FR/events/io/sessions/GoogleWavePoweredByGWT.html)（转到 11:00）讲述了一个长期存在的 HTTP GET 请求。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-17T21:29:25.913

[GWT 中的服务器推送](http://code.google.com/p/google-web-toolkit-incubator/wiki/ServerPushFAQ)

服务器推送是等待、响应、关闭、重新打开的范例：

*   等待：当 GWT 代码向您的服务器调用一些您还没有的数据时，冻结（等待）

*   响应：一旦请求的数据
    可用，就用它来响应

*   关闭：然后，关闭连接。

*   重新打开：一旦您的 GWT 代码收到响应，立即打开一个新连接以查询下一个事件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T17:50:53.077

观看视频Google Wave：在第 55 分钟左右[由 GWT 提供支持（接近尾声）](http://code.google.com/events/io/sessions/GoogleWavePoweredByGWT.html)

问：你如何实现持久连接，长期存在的 http 连接

A：未来计划：HTML5 Web Sockets。长期。这就是我们目前使用的。

问：有没有可以下载和玩的平台或库？

答：不确定。不要这么想

PS：他是这么说的。对我来说，这没有多大意义（“未来计划”与“目前使用”）。任何以英语为母语的人都可能想验证我是否正确转录？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-05T08:35:24.857

纯粹的猜测，但它可以使用HTML 5 规范中的[服务器端 DOM事件吗？](http://www.whatwg.org/specs/web-apps/2007-10-26/multipage/section-server-sent-events.html#server-sent-events)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-23T15:11:27.850

WebSockets 的全部原因是让浏览器保持一个对服务器开放的双向套接字，以便可以使用实时通信。当有人在另一端打字时，在 wave 客户端中，它会触发一个发送到服务器的事件，然后服务器会查看谁也应该接收该事件并将该事件传递给他们，在这种情况下是键入的字母。

WebSocket 和 Comet 是不同的。

格兰维尔

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-14T21:30:29.547

未来可能是现在的彗星 websocket。因为它可以在 Firefox 3.5 中运行，并且根据我的阅读，websocket 仅在 FF 的夜间版本中可用......不过我可能是错的......因为它似乎根本无法在 IE 中运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-24T01:08:31.320

[我花了一些时间对 Google Wave 客户端代码进行逆向工程（ http://antimatter15.com/misc/read/](http://antimatter15.com/misc/read/)的无耻插件，它是用于所有公共 wave 的 google wave 的只读公共客户端，无需机器人或小工具一个月前，当谷歌没有启动升级时，它更有用）。

无论如何，Google 使用 GWT 框架和 Google Closure 库的某些方面（实际上是开源的并记录在案），他们使用 goog.net.BrowserChannel 库，从评论中该库也用于 gmail 中的聊天功能。

[http://closure-library.googlecode.com/svn/docs/closure_goog_net_browserchannel.js.html](http://closure-library.googlecode.com/svn/docs/closure_goog_net_browserchannel.js.html)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-11-22T19:04:58.017

我会假设他们使用 ajax 请求。执行一个异步的 XMLHttpRequest，当服务器有东西要发送给您的浏览器时，注册的 javascript 回调会获取数据并对其进行任何处理。所以基本上浏览器请求下一个事件，处理它，无限重复。

# jquery - jQuery UI datepicker 在对话框中自动打开

> ID：932420
> 
> 赞同：31
> 
> 时间：2009-05-31T16:42:44.447
> 
> 标签：jquery, ajax, jquery-ui, dialog, datepicker

我有一个在 jQuery 对话框对象中使用的日期选择器。对话框内容的来源是使用 加载的`.load()`。在对话框中，我创建了一个脚本，该脚本为文本输入创建了一个日期选择器。

```
$("#date").datepicker({ ... }); 
```

当我第一次打开对话框时 - 一切都很好，但是如果我关闭它并再次重新打开，日期选择器会自动触发（并且没有像这样的选项`autoOpen:false`）有什么方法可以防止这种情况或我做错了什么?

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-10-22T20:03:44.930

我发现了更简单的方法：

```
$("#dialogPopper").click(
                    function() {
                        $("#date").datepicker("disable");
                        $("#dialog").dialog("open");
                        $("#date").datepicker("enable");
                        return false;
                    }
                  ); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2010-11-22T21:29:50.607

当您将 datepicker 字段放在对话框的开头时，它会自动打开。您可以在对话框的开头放置一个隐藏的输入。

```
<input type="text" style="width: 0; height: 0; top: -100px; position: absolute;"/> 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-07T21:06:18.080

我遇到了这个确切的问题，并且只对 tvanfosson 的技术稍作改动就解决了它。出于某种原因，我不得不手动将“点击”事件附加到日期选择器字段，如下所示。

```
 $('#dialog').dialog({
 open: function(event, ui) {
    $(ui).find('#date').datepicker().click(function(){
        $(this).datepicker('show');
    });
 },
 close: function(event,ui) {
    $(ui).find('#date').datepicker('destroy');
 }}); 
```

（抱歉——我更愿意将此作为评论发布到 tvanfosson 的帖子，但没有必要的代表。）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-31T16:58:15.317

您可能想考虑在对话框关闭时销毁日期选择器，并在对话框的打开事件处理程序中创建它，而不是将其作为脚本包含在对话框创建中。

```
 $('#dialog').dialog({
     open: function(event, ui) {
        $(ui).find('#date').datepicker();
     },
     close: function(event,ui) {
        $(ui).find('#date').datepicker('destroy');
     }
 }); 
```

您还可以尝试不同的事件/方法，看看您是否真的需要重新创建它，但我认为这会奏效。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-10-30T16:50:28.567

原因是：您在模态表单中的第一个项目是日期选择器文本字段，当触发模态时，活动控件是包含日期选择器的控件。

我发现了两种替代解决方案：

1.  更改字段的顺序。避免使用 datepicker 保持在第一位。

2.  不要在单独的代码段中将 datepicker 设置为该字段，而是在打开对话框的函数中进行（在 opening 之后`$("#dialog").dialog("open");`）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-12-09T17:51:42.133

选择器自行打开的原因是，在您第一次打开选择器后输入字段保持焦点。

你需要模糊它：

```
$input.datepicker({
  onClose: function(dateText) {
    $(this).trigger('blur');
  }
}); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-04-13T19:45:01.520

这只是对话焦点：[api.jqueryui.com/dialog/](http://api.jqueryui.com/dialog/)

> 打开对话框后，焦点会自动移至与以下内容匹配的第一个项目
> 
> 1.  对话框中具有 autofocus 属性的第一个元素
> 2.  对话框内容中的第一个 :tabbable 元素
> 3.  对话框按钮窗格中的第一个 :tabbable 元素
> 4.  对话框的关闭按钮
> 5.  对话框本身

A solution is to use the `autofocus` attribute on other fields than `datepicker`.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-26T14:57:50.807

我遇到了类似的问题。我在 jquery ui 对话框中有一个 jquery datepicker。当我打开对话框时，日期选择器在 IE 中自动打开。在 Firefox 或 Chrome 中并没有这样做...我通过在 $(document).ready 中创建时禁用日期选择器来解决问题，如下所示：

```
$('.ConfirmMove #from').datepicker({
  duration: ''
}).datepicker('disable'); 
```

然后，当我打开包含此日期选择器的对话框时，我在对话框的打开事件处理程序中启用了它：

```
$(".ConfirmMove").dialog({
  close: function() { 
     $('.ConfirmMove #from').datepicker('disable'); 
  },
  open: function() {
     $('.ConfirmMove #from').datepicker('enable');
  }
}); 
```

您还必须记住在关闭对话框时将其禁用。

这样，您每次打开和关闭对话框时也不会破坏和重新创建日期选择器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-15T19:12:34.987

这就是我为解决我的问题所做的。

此代码在对话框的创建中。

```
document.getElementById('date').disabled = true;
setTimeout('document.getElementById("date").disabled = false;', 100); 
```

这样，当对话框打开时，它将在另一个控件中获得焦点。

您可以测试超时以减少延迟，但 100 对我来说没问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-11-17T05:07:18.363

My decision is to combine jsonx's and Pawel Furmaniak's solutions:

```
<input id='fake-input' type='text' style='width: 0; height: 0; top: -100px; position: absolute;'/>

$( '.datepickerclass' ).datepicker({
   onClose: function() {
$('#fake-input').trigger("focus");
 } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-17T00:36:16.863

我知道这是一个老问题，但对我有用的一个解决方案是触发日历图标：

```
$( ".date" ).datepicker({
  showOn: "button",
  buttonImage: "../css/imgs/calendar.gif",
  buttonImageOnly: true
}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-29T11:54:05.427

由于某种原因，当我在初始化程序中填写动画选项时，日历停止了这种行为：

showAnim: Drop

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-05-05T07:36:59.477

从源代码中我发现`jQuery.Dialog`始终跟踪对话框内元素上的事件，并在对话框获得活动状态后`focusin`触发该元素上的事件。`focus`为了防止这种行为，只需停止从被关注的元素中冒泡事件传播。

```
$("#input").on("focusin", function (e) {
   return false; // or e.stopPropagation();
}).datepicker(); 
```

*   `jQuery`请注意，版本之间存在差异
*   票务[http://bugs.jqueryui.com/ticket/9125](http://bugs.jqueryui.com/ticket/9125)

# ruby-on-rails - 为 Rails 应用程序存储共享密钥

> ID：932423
> 
> 赞同：2
> 
> 时间：2009-05-31T16:44:11.107
> 
> 标签：ruby-on-rails, ruby, security

我的一个 Rails 应用程序将依赖于内存中的密钥，因此只有管理员进入某个页面并上传有效密钥后，它的所有功能才可用。

问题是这个密钥需要安全地存储，所以同一台机器上的其他进程应该不能访问它（所以 memcached 和文件系统不适合）。一个好主意是将其存储在应用程序的某个配置变量中，但新生成的实例将无法访问该变量。任何想法如何在 RubyEE/Apache/mod_passenger 上实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T17:27:48.417

真的没有办法实现这个目标。（这是所有 DRM 系统都存在的相同问题）

你不能对操作系统保密。您的应用程序必须在内存中的某处拥有密钥，并且操作系统内核可以读取它想要的任何内存位置。

您需要能够信任操作系统，这意味着您也可以信任操作系统以正确执行文件访问权限。这反过来意味着可以将密钥存储在只有 rails-user-process 可以读取的文件中。

可以这样想：即使您根本没有密钥，如何阻止服务器上的攻击者简单地更改应用程序代码本身以访问禁用的功能？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T17:11:19.497

我将使用文件系统，仅对文件所有者具有读取权限，并确保 ruby​​ 进程是该用户拥有的唯一进程。（使用`chmod 400 file`）

您可以变得比这更复杂，但这一切都归结为使用 unix 用户和权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T16:47:11.337

在文件系统中对其进行大量加密？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T17:04:06.793

将其视为常规密码并使用[加盐哈希](http://www.zacharyfox.com/blog/ruby-on-rails/password-hashing)怎么样？一旦用户进行身份验证，他就可以访问网站的功能。

# xcode - xcode 中的 $PATH 设置在哪里？

> ID：932424
> 
> 赞同：29
> 
> 时间：2009-05-31T16:44:25.007
> 
> 标签：xcode, path

看起来 xcode 的 $PATH 环境设置与我的用户 shell 环境不同。

xcode 从哪里获取 $PATH 设置以及附加到搜索路径的最佳方式是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-31T17:11:07.890

如果您正在编写 Run Shell Script 构建阶段，您可以这样做：

```
PATH=${PATH}:/opt/local/bin 
```

或脚本内容中的任何内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-31T16:58:03.507

这仅适用于 OSX 10.7 及更早版本。

XCode 从 ~/.MacOSX/environment.plist 以与其他 OS X 进程相同的方式获取其环境变量。

查看[developer.apple.com/qa/qa2001/qa1067.html](http://developer.apple.com/qa/qa2001/qa1067.html)了解如何设置的详细信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-27T10:15:08.263

最简单的解决方案是在 Xcode 中添加 PATH 变量。

`PATH=${PATH}:/usr/local/bin`

[![在此处输入图像描述](https://i.stack.imgur.com/vnxRL.png)](https://i.stack.imgur.com/vnxRL.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-30T01:22:45.573

在 Xcode 5 中，您可以将 PATH 作为变量添加到目标或项目设置中。

1.  `+`在页面顶部添加带有符号的自定义变量
2.  编辑变量的名称`PATH`并添加您的首选值（例如`/usr/local/bin`，对于 homebrew.xml 的默认安装）

![目标构建设置](https://i.stack.imgur.com/cB037.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-31T21:06:27.770

如果您专门讨论[名为 PATH 的可执行搜索路径环境变量](http://developer.apple.com/documentation/Darwin/Reference/ManPages/man7/environ.7.html)，那么它设置在几个地方：

*   如果它是命令行工具，请在[您的 shell 设置中。](http://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html#Bash-Startup-Files)根据您的外壳，这可能是`~/.cshrc`, `~/.profile`,`~/.bash_profile`等。
*   在`environment.plist`前面提到的文件中。
*   如果您在调试器中，那么[无论`gdb`使用](http://sourceware.org/gdb/current/onlinedocs/gdb_3.html#SEC10)什么. 我相信如果 gdb`~/.gdbinit`存在，它会从中读取命令。
*   [XCode 允许您在信息页面中为可执行文件](http://developer.apple.com/iphone/library/documentation/DeveloperTools/Conceptual/XcodeProjectManagement/080-Defining_Executable_Environments/executable_environments.html#//apple_ref/doc/writerid/xcode_user_guide_command_line_arguments_and_environment_variables_setting)设置环境变量。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-12-01T19:14:56.357

这些答案有些混乱，因为其中一些正在尝试解决`$PATH`Xcode 运行的构建可执行文件的问题。但问题是关于 Xcode，暗示它与构建过程本身有关。

例如，在运行 Homebrew 安装的可执行文件的构建阶段运行脚本步骤中。对构建过程进行硬编码以包含特定于一台构建机器的路径并不是一个好主意（新的 macOS 版本出现，新的开发人员加入团队等）

问题有多个层面：

## 更改//`$PATH`对shell 会话生效，但在 macOS 应用程序中不生效`bashrc``zshrc``profile`

要解决此问题，您可以使用以下方法为应用程序设置 PATH：

```
sudo launchctl config user path $PATH 
```

然后，您将需要重新启动计算机以使更改生效。如果您更改`$PATH`.

（这来自[GitHub 上的评论](https://github.com/ersiner/osx-env-sync/issues/1#issuecomment-230053839)。）

## Xcode 默认不使用系统`$PATH`，并用它自己的净化值替换它

这可以通过更改用户默认值来解决。这可能有一些风险，因为 Xcode 进行这种清理是为了确保使用它自己的构建工具，如果你在其他地方有同名的可执行文件，它们可能会被运行。买者自负！

```
defaults write com.apple.dt.Xcode UseSanitizedBuildSystemEnvironment -bool NO 
```

（这部分来自[这个答案](https://stackoverflow.com/a/33237548/1589422)。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-10-22T08:27:16.857

这是对更高版本的 macOS 和 Xcode 的更新，因为事情已经发生了变化。这是 Xcode 11.0 和 macOS 10.14

最大的问题是 ~/.MacOSX/environment.plist 现在没有被读取。

1.  **构建设置**

这意味着如果在构建中您需要 PATH 集，例如对于外部构建并且它们运行可执行文件，则没有简单的解决方案。/etc/paths 似乎也没有被读取。

解决方案与[@GhostLyrics 回答](https://stackoverflow.com/a/25578150/151019)中一样，在构建设置中添加 PATH 变量。然而，正如评论中指出的那样，Xcode 不仅会使用该值，还会在其之前放置自己的值。它还直接进行文本替换，因此您还需要添加 PATH 使用的分隔符，即：（冒号）。我添加的价值是`:opt/local/bin`我还发现您只能针对目标执行此操作，而不能在项目级别执行此操作。

2.  **运行外壳脚本**

这是[这个答案中的简单案例](https://stackoverflow.com/a/932471/151019)

```
PATH=${PATH}:/opt/local/bin 
```

或脚本内容中的任何内容。

或者，将此更改放在您的非登录 shell 启动文件中，例如 ~/.bashrc ~/.zshrc

3.  **运行可执行文件**

这是在运行部分的模式中完成的。按照此处答案中的说明在环境变量中设置 PATH 。注意我没有尝试过，我不确定 PATH 需要设置多少。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-31T21:20:53.623

Xcode 不会查看您的 shell 路径环境。

看看 NSProcessInfo；并做一个 NSLog 看看会发生什么。

如果您想要一个应用到所有图形程序的路径，您需要设置 ~/.MacOSX/environment.plist。如所述。

设置环境变量的推荐方法实际上是在 /etc/paths 和 etc/paths.d 中，尽管 Xcode 也没有采用这些方法。

[我在这里](https://stackoverflow.com/questions/386783/nstask-not-picking-up-the-expected-path-from-the-users-environment)问过这个。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-21T21:41:07.607

在 XCode 7 中没有什么对我有用。
您需要在 XCode 方案中设置 PATH 变量。

在哪里找到解决方案： [在哪里为应用程序设置环境变量？](https://stackoverflow.com/questions/17393053/where-to-set-environment-variables-for-app)

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2015-02-20T01:08:08.357

尝试从终端打开您的 xcode 项目，这对我有用：`open some.xcodeproj`

而不是打开 xcode 然后加载项目或双击它。

我知道……傻

# c++ - 管理类的聚合/组合成员之间的关系

> ID：932435
> 
> 赞同：2
> 
> 时间：2009-05-31T16:50:01.693
> 
> 标签：c++, relationship, aggregation, composition

我正在使用聚合和组合为模拟创建实体。

在以下 C++ 示例中：

```
class CCar
{
    CCar( CDriver* pDriver )
    { m_pDriver = pDriver; }

    CDriver* m_pDriver;

    CEngine m_Engine;

    CDriverControls m_Controls;
}; 
```

在上面的例子中，一辆汽车由一个发动机和一组驾驶控制（按组合）组成。一辆车还必须有一个司机（通过聚合）。

但这只是解释了层次关系——驾驶员属于汽车，引擎和控件也属于汽车。但是这些成员也都相互关联——驾驶员必须对控件执行操作，控件必须对引擎执行操作。这些关系也可以在多个方向上发挥作用——发动机可能会熄火并导致控制装置失灵，或者控制装置可能会疯狂旋转并伤害驾驶员？如果驾驶员不喜欢发动机的声音并离开汽车怎么办？这些关系如何运作？

我正在从经常与其他对象交互的许多不同对象中合成许多不同的实体，并且对如何以设计的方式管理这些关系感兴趣。

谢谢你！

**编辑：**

正如回复所暗示的，管理此问题的一种方法是将汽车指向驾驶员，并为驾驶员提供指向汽车的指针等。这很有意义并解决了这个具体的例子。然而，在设计意义上，这增加了驾驶员的责任，这个对象的任务是跟踪它属于哪辆车，但这肯定是容器的责任来跟踪哪些对象属于一起？同样，让 CCar 负责管理这些关系会将 CCar 变成一个 blob。是否有处理这些关系的设计解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T16:55:02.310

您将它们构建到每个类的方法中。您所描述的是每个班级的行为。您的要求表明关系也是双向的。您的 Controls 类将具有采用 Engine 参数并调用其方法的方法。发动机将对其 RPM、HP、扭矩等进行限制，由控制器控制，这些限制将内置于其中（例如，“如果您的 RPM 降得太低，则熄火”）。

它不仅仅是作曲。您将行为和规则构建到方法中。这些方法可能采用表达您需要的参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T17:02:27.933

问题应该是“我的应用程序需要这种关系吗？” 例如，如果您正在为一个简单的驾驶游戏模拟驾驶汽车，您可能根本不需要担心天窗的电机。方向盘可能需要知道它与车轮相连，但不需要反向关系。

底线 - 在现实世界中，一切都是相互联系的，但在我们为解决特定问题而建立的那个世界的计算机模型中，它们不是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T02:56:02.213

强调接口而不是组合、聚合或继承可能很有用。例如，可以编写您的驱动程序类，使其可以使用“方向盘”接口。自然，您的方向盘实现提供了“方向盘”接口的实现。同样，汽车提供了一个“汽车接口”，可以编写方向盘实现以利用该接口。

您的实现可能使用组合、聚合和继承。但在这种方法中，真正驱动设计的是接口。无论您在给定实例中使用组合、聚合还是继承，都只是实现细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T16:56:04.710

您可能需要汽车和驾驶员之间的双向关联：

```
CCar( CDriver* pDriver ) :
     m_pDriver(pDriver)
{
    m_pDriver->SetCar(this);
} 
```

然后驱动程序可以通过 Car 的公共接口访问 Car 的成员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:40:13.207

要解决这个问题，首先要确定每个组件的作用。

CCar - 一个容纳组件和聚合体的容器。

CDriver - 表示驱动程序的对象

CEngine - 表示引擎的对象

等等

对于一个小而简单的程序，应该使用一个简化的设计，给司机一个指向汽车的指针

```
CCar( CDriver* pDriver )
{
m_pDriver = pDriver;
m_pDriver->SetCar(this);
} 
```

对于更大的应用程序，如果 CCar 可能需要添加新组件等，这是不可接受的，并且让驾驶员可以访问整个 CCar 将是糟糕的设计实践——在这里，驾驶员不仅可以更换方向盘，还可以更换汽车颜色等，这显然不是本意。

让驱动程序访问它需要的位怎么样？

```
m_pDriver->SetSteeringWheel( m_SteeringWheel );
m_pDriver->SetHandBrake( m_HandBrake ); 
```

这解决了这个问题，现在驾驶员无法访问汽车的其他属性（例如颜色）。但是，它赋予 CDriver 类更多的职责。CDriver 可以使用很多控件，类可以变得非常大，并负责操作这些方向盘和手刹对象。如果驾驶员乘坐的车辆类型与其他车辆不同，该怎么办？现在驾驶员必须弄清楚如何使用其拥有的控件来操作车辆？额外的逻辑。额外的斑点。

所有这一切的解决方案是使用中介类（或变体）来控制驾驶员与车辆的交互方式。这可以通过以下两种方式之一来完成，驾驶员可以拥有汽车的中介，它控制驾驶员与汽车的交互方式。或者，驾驶员可以为它必须处理的汽车的每个组件或集合设置一个调解器。这可能是一个更好的解决方案，因为调解器可以重复用于不同类型的汽车。中介必须能够处理组件之间的双向关系。

作为容器的 CCar 负责维护中介，从而维护其组件之间的关系。就是它应该的样子。

中介者负责处理组件之间的这种关系。

```
class CMediatorDriverToSteeringWheel
{
CMediatorDriverToSteeringWheel( CDriver* pDriver, CSteeringWheel* pSteeringWheel )
{
m_pDriver = pDriver;
m_pSteeringWheel = pSteeringWheel;
m_pDriver->AddMediator(this);
m_pSteeringWheel->AddMediator(this);
}
};

... 

CCar::CCar( CDriver* pDriver )
{
m_pDriver = pDriver;
new CMediatorDriverToSteeringWheel( m_pDriver, &m_SteeringWheel );
new CMediatorDriverToHandbrake( m_pDriver, &m_HandBrake );
} 
```

# c++ - 帮助算法动态更新文本显示

> ID：932441
> 
> 赞同：4
> 
> 时间：2009-05-31T16:55:24.870
> 
> 标签：c++, perl, console-application, ascii-art

## 首先，一些背景故事：

我正在制作一个可能相当于“ [roguelike](http://en.wikipedia.org/wiki/Roguelike) ”的游戏，这样我就可以运用我脑海中浮现的一些有趣的想法。游戏玩法不会是地牢爬行，但无论如何，显示将以类似的方式完成，带有简单的 ascii 字符。

由于这是一个自我练习，*我努力自己编写大部分代码*。

最终，我希望游戏可以在任意大的游戏世界上运行。（到了我设想将游戏联网并跨越计算机实验室中的许多显示器的地步）。

现在，我有一些代码可以读取和写入文本控制台的任意部分，并设置了一个简单的分区系统，以便我可以有效地进行路径查找。

* * *

## 现在的问题是：

我已经运行了一些基准测试，最大的瓶颈是重新绘制文本控制台。

拥有这么大的游戏世界需要对显示进行智能更新。我不想每帧都重新推送我的整个游戏缓冲区...**我需要一些关于如何设置它的指针，以便它只绘制游戏的部分已经更新。**（而不仅仅是我现在拥有的单个角色）

我一直在通过 windows.h 操作 Windows 控制台，但我也有兴趣让它通过连接到服务器的 puTTY 客户端在 linux 机器上运行。

我尝试过调整一些视频处理程序，因为像素和字符之间的比例接近 1:1，但我没有运气。

真的，我想简单解释一下它背后的一些原则。但是一些示例（psudo）代码也会很好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T17:30:05.840

使用 Curses，或者如果您需要自己做，请阅读 VTnnn 控制代码。这两个都应该在 Windows 和 *nix 术语和控制台（和 Windows）上工作。您还可以查阅 nethack 源代码以获取提示。这将使您可以在发生更改的地方更改屏幕上的字符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T17:01:02.630

我不会声称自己理解这一点，但我相信这与 James Gosling 的传奇[Gosling Emacs](http://en.wikipedia.org/wiki/Gosling_Emacs)重绘代码背后的问题很接近。请参阅他的论文，标题恰当，“A Redisplay Algorithm”，以及一般[的字符串到字符串校正问题](http://en.wikipedia.org/wiki/String-to-string_correction_problem)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T09:33:23.390

> 拥有这么大的游戏世界需要对显示进行智能更新。我不想每帧都重新推送我的整个游戏缓冲区...我需要一些关于如何设置它的指针，以便它只绘制游戏的部分已经更新。（而不仅仅是我现在拥有的单个角色）

游戏世界的大小并不真正相关，因为您需要做的就是计算出每个客户端的可见区域并发送该数据。如果您有一个典型的 80x25 控制台显示器，那么您每次将只发送 2 或 3 KB 的数据，即使您添加了颜色代码等。这是大多数此类网络游戏的典型特征：更新人们可以看到的内容，而不是世界上的所有内容。

If you want to experiment with trying to find a way to cut down what you send, then feel free to do that for learning purposes, but we're about 10 years past the point where it is inefficient to update a console display in something approaching real time and it would be a shame to waste time fixing a problem that doesn't need fixing. Note that the PDF linked above gives an O(ND) solution whereas simply sending the entire console is half of O(N), where N is defined as the sum of the lengths of A and B and D.

# model-view-controller - ASP.NET MVC 的下一个完整发布日期（MVC 1.1 / 1.5 / 2.0 有人吗？）

> ID：932449
> 
> 赞同：2
> 
> 时间：2009-05-31T16:59:25.830
> 
> 标签：model-view-controller, version

有人知道 ASP.NET MVC 的下一版本何时发布吗？

Futures 程序集有许多重要的特性（异步控制器、调用部分操作等），但我不想在生产网站中使用 beta/futures 代码 - 所以，有没有人知道下一个版本是什么时候出来？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-29T14:27:36.890

4 月 12 日（截至 2010 年 1 月 29 日） [链接文本](http://www.internetnews.com/software/article.php/3858841/Microsoft+Confirms+Visual+Studio+2010+Ship+Date.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-07T13:56:34.250

ASP.Net MVC 2 将随 Visual Studio 2010 一起提供。

[http://haacked.com/archive/2009/07/30/asp.net-mvc-released.aspx](http://haacked.com/archive/2009/07/30/asp.net-mvc-released.aspx)

没有固定日期，但我认为应该是 2010 年上半年。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T17:28:30.397

不知道，但是如果您密切注意签入，您可以从 codeplex 站点获得提示。

[http://aspnet.codeplex.com/](http://aspnet.codeplex.com/)

# sql-server - SQL Server 报告服务编程问题

> ID：932451
> 
> 赞同：1
> 
> 时间：2009-05-31T16:59:50.697
> 
> 标签：sql-server, service, reporting

我了解如何手动连接到 SQL Server 数据源并输入 SQL 语句以在 Web 上生成/发布报告。我的问题是，我希望最终用户输入一些参数值，然后使用这些参数值作为 SQL 语句参数值（例如使用最终用户输入的时间范围作为 SQL 语句参数）——然后根据这些参数动态生成报告。我正在寻找任何相关的样本/文件。有什么建议吗？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T17:06:02.670

我相信您正在寻找报告参数。

可以在 [此站点上找到有关该主题的非常好的教程。](http://www.sql-server-performance.com/articles/reporting/report_parameters_p1.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T17:03:34.327

如果您设置了参数，将在报告管理器中请求它们。

这是一个[教程](http://en.csharp-online.net/Building_Reports_in_SQL_Server_2005%E2%80%94Setting_Report_Parameters_with_Stored_Procedures)

# java - 我应该什么时候返回接口，什么时候返回具体类？

> ID：932452
> 
> 赞同：25
> 
> 时间：2009-05-31T17:00:03.380
> 
> 标签：java, collections, abstraction

在用 Java 编程时，我几乎总是出于习惯，写这样的东西：

```
public List<String> foo() {
    return new ArrayList<String>();
} 
```

大多数时候甚至没有考虑它。现在，问题是：我是否应该*始终*将接口指定为返回类型？还是建议使用接口的实际实现，如果可以，在什么情况下？

很明显，使用接口有很多优点（这就是它存在的原因）。在大多数情况下，库函数使用什么具体实现并不重要。但也许在某些情况下它确实很重要。例如，如果我知道我将主要随机访问列表中的数据，a`LinkedList`会很糟糕。但是如果我的库函数只返回接口，我根本不知道。为了安全起见，我什至可能需要将列表显式复制到`ArrayList`：

```
List bar = foo();
List myList = bar instanceof LinkedList ? new ArrayList(bar) : bar; 
```

但这看起来很可怕，我的同事可能会在自助餐厅私刑处死我。理所当然地。

你们有什么感想？你的指导方针是什么，你什么时候倾向于抽象解决方案，你什么时候透露你的实现细节以获得潜在的性能提升？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-31T17:08:17.130

返回适当的接口以隐藏实现细节。你的客户应该只关心你的对象提供了什么，而不是你如何实现它。如果您从私有 ArrayList 开始，然后决定其他更合适的方法（例如，LinkedLisk、跳过列表等），您可以在返回接口时更改实现而不影响客户端。返回具体类型的那一刻，机会就丢失了。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-31T17:23:13.570

> 例如，如果我知道我将主要随机访问列表中的数据，那么 LinkedList 会很糟糕。但是如果我的库函数只返回接口，我根本不知道。为了安全起见，我什至可能需要将列表显式复制到 ArrayList。

正如其他人所提到的，您不必关心库如何实现功能，以减少耦合并提高库的可维护性。

如果您作为图书馆客户，可以证明实施对您的用例表现不佳，则可以联系负责人并讨论遵循的最佳路径（此案例的新方法或只是更改实施） .

也就是说，您的示例带有过早优化的味道。

如果该方法是或可能是关键的，它可能会在文档中提及实现细节。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-31T17:05:12.093

由于无法用大量的 CS 引用来证明它的合理性（我是自学成才的），我在设计课程时总是遵循“接受最少派生，返回最多派生”的口头禅，这让我非常满意这些年。

我想这意味着就接口与具体返回而言，如果您试图减少依赖关系和/或解耦，返回接口通常更有用。但是，如果具体类实现*的不仅仅是*该接口，那么对于您的方法的调用者来说，获取具体类（即“最派生的”）通常更有用，而不是将它们任意限制为该返回对象功能的子集- 除非你真的*需要*来限制他们。再说一次，您也可以只增加界面的覆盖范围。像这样不必要的限制，我将其比作漫不经心的封课；你永远不会知道。只是谈谈该咒语的前一部分（对于其他读者），接受最小派生也为您的方法的调用者提供了最大的灵活性。

-Oisin

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-31T17:21:51.013

在OO编程中，我们希望尽可能多地封装数据。尽可能隐藏实际实现，尽可能高地抽象类型。

在这种情况下，我会回答*只返回什么是有意义的*。返回值是具体的类是否有意义？在你的例子中，问问自己：有人会在 foo 的返回值上使用 LinkedList 特定的方法吗？

*   如果不是，只需使用更高级别的接口。它更加灵活，并且允许您更改后端
*   如果是，问问自己：我不能重构我的代码以返回更高级别的接口吗？:)

您的代码越抽象，更改后端时所需的更改就越少。就这么简单。

另一方面，如果您最终将返回值强制转换为具体类，那么这是一个强烈的信号，表明您可能应该返回具体类。您的用户/队友不必了解或多或少的隐式合同：如果您需要使用具体方法，只需返回具体类，以清楚起见。

简而言之：代码**抽象**，但**明确**:)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-07-11T20:01:32.513

很抱歉不同意，但我认为基本规则如下：

*   对于**输入**参数，使用最**通用**的.
*   对于**输出**值，最**具体**的.

因此，在这种情况下，您希望将实现声明为：

```
public ArrayList<String> foo() {
  return new ArrayList<String>();
} 
```

**原理**：输入用例大家都知道，解释一下：使用接口，句号。但是，输出情况可能看起来违反直觉。您希望返回实现，因为您希望客户端获得有关接收内容的最多信息。在这种情况下，**更多的知识就是更多的力量**。

示例 1：客户端想要获取第 5 个元素：

*   返回集合：必须迭代到第 5 个元素与返回列表：
*   返回列表：`list.get(4)`

示例 2：客户想要删除第 5 个元素：

*   return List：必须创建一个没有指定元素的新列表（`list.remove()`可选）。
*   返回数组列表：`arrayList.remove(4)`

因此，使用接口很棒，这是一个很大的事实，因为它促进了可重用性，减少了耦合，提高了可维护性并让人们开心......但只有在用作**输入**时。

因此，同样，该规则可以表述为：

*   对您提供的内容保持灵活。
*   提供您提供的信息。

所以，下一次，请返回执行。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-31T17:09:12.933

通常，对于 API 等面向公众的接口，返回接口（例如`List`）而不是具体实现（例如`ArrayList`）会更好。

使用`ArrayList`or`LinkedList`是该库的最常见用例应考虑的库的实现细节。当然，在内部，有`private`方法传递`LinkedList`s 不一定是一件坏事，如果它提供了使处理更容易的设施。

没有理由不应该在实现中使用具体类，除非有充分的理由相信`List`稍后会使用其他一些类。但是话又说回来，只要面向公众的部分设计得很好，更改实现细节就不应该那么痛苦。

图书馆本身对消费者来说应该是一个黑匣子，所以他们不必担心内部发生了什么。这也意味着应该设计该库，以便按照预期的方式使用它。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-31T21:47:37.907

API 方法返回接口还是具体类并不重要。尽管这里的每个人都这么说，但一旦编写了代码，您几乎永远不会更改实现类。

更重要的是：始终为您的方法*参数*使用最小范围接口！这样，客户就拥有最大的自由，并且可以使用您的代码甚至不知道的类。

当一个 API 方法返回时`ArrayList`，我对此完全没有疑虑，但是当它需要一个`ArrayList`（或者，所有常见的，`Vector`）参数时，我考虑追捕程序员并伤害他，因为这意味着我不能使用`Arrays.asList()`，`Collections.singletonList()`或者`Collections.EMPTY_LIST`.

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-31T17:09:13.167

通常，如果我在某个库的私有内部工作中，我只会传回内部实现，即使如此，也只是很少。对于所有公开且可能从模块外部调用的内容，我使用接口以及工厂模式。

以这种方式使用接口已被证明是编写可重用代码的一种非常可靠的方式。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-31T21:27:48.960

主要问题已经得到解答，您应该始终使用该界面。然而，我只想评论

> 很明显，使用接口有很多优点（这就是它存在的原因）。在大多数情况下，库函数使用什么具体实现并不重要。但也许在某些情况下它确实很重要。例如，如果我知道我将主要随机访问列表中的数据，那么 LinkedList 会很糟糕。但是如果我的库函数只返回接口，我根本不知道。为了安全起见，我什至可能需要将列表显式复制到 ArrayList。

如果您要返回一个您知道随机访问性能较差的数据结构 - O(n) 并且通常是大量数据 - 您应该指定其他接口而不是 List，例如 Iterable，以便使用该库的任何人都会充分意识到只有顺序访问可用。

选择正确的返回类型不仅仅是接口与具体实现的关系，还与选择正确的接口有关。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-31T17:05:15.357

您使用接口从实际实现中抽象出来。该接口基本上只是您的实现可以做什么的蓝图。

接口是好的设计，因为它们允许您更改实现细节而不必担心它的任何消费者会受到直接影响，只要您的实现仍然按照您的接口所说的那样做。

要使用接口，您可以像这样实例化它们：

```
IParser parser = new Parser(); 
```

现在 IParser 将成为您的接口，而 Parser 将成为您的实现。现在，当您使用上面的解析器对象时，您将针对接口 (IParser) 进行操作，而接口将针对您的实现 (Parser) 进行操作。

这意味着您可以随心所欲地更改 Parser 的内部工作，它永远不会影响与您的 IParser 解析器接口一起工作的代码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-02T20:44:44.517

如果您不需要具体类的功能，通常在所有情况下都使用接口。请注意，对于列表，Java 添加了一个[RandomAccess](http://java.sun.com/javase/6/docs/api/java/util/RandomAccess.html)标记类，主要是为了区分算法可能需要知道 get(i) 是否为常数时间的常见情况。

对于代码的使用，上面的 Michael 是对的，在方法参数中尽可能通用通常更为重要。在测试这种方法时尤其如此。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-31T17:12:10.137

您会发现（或已经发现）当您返回接口时，它们会渗透到您的代码中。例如，您从方法 A 返回一个接口，然后您*必须*将一个接口传递给方法 B。

您正在做的是通过合同进行编程，尽管方式有限。

这为您提供了在幕后更改实现的巨大空间（前提是这些新对象满足现有合同/预期行为）。

鉴于所有这些，您在选择实现以及如何替代行为（包括测试 - 例如使用模拟）方面受益匪浅。如果您没有猜到，我完全赞成这一点，并尽可能减少（或引入）接口。

# php - 预选选项卡的打开页面不是第一个选项卡

> ID：932478
> 
> 赞同：5
> 
> 时间：2009-05-31T17:14:02.770
> 
> 标签：php, jquery, jquery-ui

我有一个带有 jqueryui 标签集的页面。我希望能够打开带有第一个选项卡以外的选项卡的页面。如果页面上有四个选项卡，我需要能够选择四个选项卡中的任何一个作为“打开”选项卡。

这可能是来自另一个页面的链接或来自同一框架集中的页面的链接。

在幕后一切都是PHP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T17:20:21.077

您需要通过 JavaScript 在页面初始加载时选择一个选项卡。以下是如何选择选项卡的示例：

[http://docs.jquery.com/UI/API/1.7/Tabs#method-select](http://docs.jquery.com/UI/API/1.7/Tabs#method-select)

```
<script type="text/javascript">
  $(function() {
    $("#tabs").tabs( 'select' , index )
  });
</script> 
```

其中 index 变量是您要选择的选项卡的整数。它是基于 0 的，因此如果您想选择第三个选项卡，您需要为 index.html 指定 2。

页面准备好后，您需要执行此操作：

[http://www.learningjquery.com/2006/09/introducing-document-ready](http://www.learningjquery.com/2006/09/introducing-document-ready)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-12T18:52:25.857

上面的答案对于当前版本的 jQuery UI v1.10.0 不再有效。根据 jQuery UI API，该选项现在**处于活动状态**并且不再*选择*。

这是 API 的链接：http: [//api.jqueryui.com/tabs/#option-active](http://api.jqueryui.com/tabs/#option-active)

> 使用指定的活动选项初始化选项卡：

```
$(".selector").tabs({ active: 1 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-08T16:28:08.927

**[`selected`](http://docs.jquery.com/UI/Tabs#option-selected)可以在初始化选项卡时使用选项**预先**选择选项卡。**

 **```
$("#tabs").tabs({
    selected: index //index of the tab to be preselected
}); 
```

这很重要的一种情况是索引 0 处的选项卡加载了 ajax。如果您像往常一样初始化选项卡，然后使用该`select`方法更改选定的选项卡，最初将发送一个 ajax 请求来加载选项卡 0。但是由于您想立即显示另一个选项卡，所以这个请求是不必要的。该`selected`选项允许您跳过此请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T13:58:27.943

只需将`ui-tabs-selected`类添加到预期`<li>`元素。

jQuery 将通过以下路径选择要激活的选项卡

1.  是否`selected`设置了选项
2.  如果未设置，则`location.hash`匹配任何标签`hash`的`<a>`标签
3.  如果没有哈希匹配，是否有任何`<li>`元素具有`ui-tabs-selected`类
4.  如果不尝试选择第一个未禁用 ( `ui-state-disabled`) 选项卡

有点老问题。已回答，因为此页面是 google 上的第一个页面

# java - Java2D：扩展问题

> ID：932479
> 
> 赞同：8
> 
> 时间：2009-05-31T17:14:04.597
> 
> 标签：java, scaling, java-2d

我是一位经验丰富的 Java 程序员，但对 Java2D 来说相对较新。我正在尝试缩放图像，但结果质量很差。该图像是面板的预览，因此包含文本和文本字段等内容。我会一直缩小，从不放大。

目前我正在使用以下代码： -

```
g.drawImage(panelImage, 0, 0, scaledWidth, scaledHeight, null); 
```

其中 panelImage 是全尺寸预览 (BufferedImage)，scaledWidth 和 scaledHeight 是各自的目标尺寸。我似乎在文本和文本字段等内容的边缘丢失了很多细节。

我应该使用更好的调用来缩放图像吗？

谢谢，约翰

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-31T17:28:54.250

我可以提出的建议是首先将图像调整为单独的[`BufferedImage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html). 原因是，为了产生更好质量的缩放图像，可以获得一个[`Graphics2D`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics2D.html)对象。`BufferedImage`

`Graphics2D`可以接受“渲染提示”，它指示对象应执行图像处理的方式`Graphics2D`。该[`setRenderingHint`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics2D.html#setRenderingHint(java.awt.RenderingHints.Key,%20java.lang.Object))方法是可用于设置那些渲染提示的方法之一。[`RenderingHints`](http://java.sun.com/javase/6/docs/api/java/awt/RenderingHints.html)可以使用类中的渲染提示。

然后，使用该`Graphics2D`对象，可以`BufferedImage`使用之前指定的渲染提示将图像绘制到该对象。

粗略（未经测试）的代码将按以下方式工作：

```
BufferedImage scaledImage = new BufferedImage(
    scaledWidth,
    scaledHeight,
    BufferedImage.TYPE_INT_RGB
);

Graphics2D g = scaledImage.createGraphics();
g.setRenderingHints(
    RenderingHints.Key.KEY_INTERPOLATION,
    RenderingHints.VALUE_INTERPOLATION_BICUBIC
);

g.drawImage(panelImage, 0, 0, scaledWidth, scaledHeight, null);
g.dispose(); 
```

其他感兴趣的渲染提示可能包括：

*   [`KEY_ANTIALIASING`](http://java.sun.com/javase/6/docs/api/java/awt/RenderingHints.html#KEY_ANTIALIASING)
*   [`KEY_RENDERING`](http://java.sun.com/javase/6/docs/api/java/awt/RenderingHints.html#KEY_RENDERING)

The Java Tutorials 的[控制渲染质量](http://java.sun.com/docs/books/tutorial/2d/advanced/quality.html)部分也有更多关于如何控制`Graphics2D`对象渲染质量的信息。

对于一般处理图形界面的非常好的信息来源，强烈推荐 Chet Haase 和 Romain Guy 的[Filthy Rich Clients 。](http://filthyrichclients.org/)书中有一节涉及缩放图像的问题，这似乎很相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T17:25:04.537

也许你应该打电话：

```
 g.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY); 
```

和

```
g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-29T07:44:52.343

Coobird 是正确的，您需要逐步缩小（最好使用 BICUBIC）以获得足够小的缩略图的美观结果。Image.getScaledInstance 曾经使用 AREA_AVERAGED 方法来做到这一点，但它比 Chris Campbell 在他的“Image.getScaledInstance() 的风险”一文中最初提出的增量缩减要慢得多。

请原谅这里的自我推销，但是当涉及到图像缩放时，我将一些“原生 Java 最佳实践”放入了一个名为[imgscalr](http://www.thebuzzmedia.com/software/imgscalr-java-image-scaling-library/)的库中。

它在 Apache 2 许可下可用，源代码都在 GitHub 上；该库的目标是使本机 Java 中的图像缩放变得非常容易（1 个类，5 个静态方法）并确保获得最佳外观（这是您最初想要的），最快的结果（在大图像之间缩放时很棒) 或两者之间的平衡，让图书馆决定使用哪一个。

我只是想要一个可以“调整我的图像大小并避开我的方式”的库，并且在阅读了所有这些帖子几天后，当我解决了痛点（我自己也是如此）之后，我只是回过头来为任何人分享工作否则它可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T17:53:23.197

[酷鸟](https://stackoverflow.com/questions/932479/java2d-scaling-issues/932502#932502)有正确的想法。我也会尝试`RenderingHints.VALUE_INTERPOLATION_BILINEAR`插值，看看它是否更好看。不过，在升级时双三次效果更好。为了在缩小规模时获得最佳结果，应该**分几个步骤缩小规模**。首先将分辨率减半，然后再减半，依此类推，直到接近所需的分辨率（即不能减半，否则图像会变得太小）。最后一步是缩小到所需的分辨率。

例如，假设您的输入图像是**800x600**并且您希望缩小到**160x120**：

1.  缩小**50%**。--> **400x300**
2.  缩小**50%**。--> **200x150**
3.  缩小到**160x120**。

# macos - 为模拟器共享 iPhone 应用程序

> ID：932480
> 
> 赞同：9
> 
> 时间：2009-05-31T17:14:26.967
> 
> 标签：macos, testing, ios-simulator

为模拟器构建的 iPhone 应用程序存储在这里：

```
/Users/<username>/Library/Application Support/iPhone Simulator/User/Applications 
```

是否可以复制**<GUID>.sb**和**<GUID>**目录并将它们安装在不同的计算机上（安装了开发工具）？

这对于测试/演示非常有用，而无需为所有经理和外部客户购买 iPhone。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-08-16T12:54:49.930

我找到了一种只需要多一点设置的方法，但对非开发人员来说更容易：

## 给您的用户/测试人员的说明：

1.  按照 Apple 的说明安装 Xcode
2.  双击附加的应用程序 - iPhone 模拟器将启动，安装应用程序并自动启动它。

## 如何设置：

1.  从以下位置下载并解压缩（到桌面或任何地方的文件夹）“模拟器捆绑器”：http: [//github.com/landonf/simlaunch/downloads](http://github.com/landonf/simlaunch/downloads)
2.  将您的 XCode 构建目标设置为所需的模拟器配置（iPad/iPhone/哪个 iOS 版本）
3.  执行“构建和归档”
4.  找到它：在管理器中选择“归档应用程序”，右键单击相关构建，选择“在 Finder 中显示归档应用程序”
5.  将应用程序（yourAppName，无扩展名）拖到 Simulator Bundler 应用程序上

完毕。这将在同一文件夹中创建一个独立的 Mac OS X yourAppDisplayName.app 文件（以您的应用程序的图标作为图标），您可以将其粘贴在 FTP 服务器上或通过电子邮件发送给您的用户/测试人员。

--

我认为这比解释在哪里复制文件、如何启动模拟器等等要简洁/流畅得多。如果有什么事情搞砸了，他们可以通过熟悉的点击并按住 + (x) 手势卸载模拟器 UI，然后再次双击您发送给他们的应用程序。

您还可以生成其中几个包，更改构建之间的包标识符，允许它们并排安装在测试人员的模拟器中；比如说获得一些用户对不同 UI 设计的反馈，或者配置一个用于生产服务器和一个用于暂存/QA 服务器，这样您的内容编辑器就可以在它们上线或其他任何东西之前检查他们的更改。

从桌面图标重新安装应用程序的能力对于本地化测试也非常方便：启动模拟器，卸载应用程序（如果存在），设置所需的区域格式和语言，双击桌面上的图标，测试；对每个所需的语言环境重复。（保证每次都重新安装，我发现在安装应用程序的情况下切换语言会导致各种奇怪的行为）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T17:36:37.173

是的，如果您将这些文件发送给另一个人，他们将它们放入该目录，他们也可以在 iPhone 模拟器中测试应用程序 :)

# excel - 最后匹配的返回值

> ID：932486
> 
> 赞同：0
> 
> 时间：2009-05-31T17:17:56.120
> 
> 标签：excel, excel-formula

我需要一个公式来返回“文本”的最后一个匹配项的数据值。行号也是可以接受的。宏是不可接受的。名称列未排序，无法排序！只有列“名称”用作查找值。我宁愿使用一个/多个辅助列而不是数组公式。

```
Row Name    Data
1   Joe     10
2   Tom     20
3   Eva     30
4   Adam    40
5   Tom     21 
```

LARGE 仅适用于数字，而 VLOOKUP 仅返回第一个匹配项。LOOKUP 有时只起作用，所以它也不起作用。

因此，如果我想要“Tom”的最后一场比赛，那么它应该返回“21”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-30T23:35:29.027

使用辅助列可以避免使用数组公式。假设在 F1 中有要匹配的名称（即 Tom） 在辅助列 C2 行中输入

```
=IF(A2<>$F$1,0,row()) 
```

然后沿着数据复制公式。

现在列 C 包含 0 用于不匹配的名称和匹配的行号。最大化列产生解决方案的行。现在结果很简单，只需使用正确的偏移量和函数偏移量：

```
=OFFSET(B1,max(C:C)-1,0) 
```

PS：我的 excel 副本是意大利语的，所以我无法测试这个公式的英文翻译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T14:00:46.600

我认为这是最简单的方法。

```
=LOOKUP("Tom";A2:B7) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T17:35:09.560

使用数组公式创建一列（使用 Ctrl+Shift+Enter 输入）：

```
=VLOOKUP(MAX(IF($B$2:$B$6=B2, $A$2:A$6, 0)), $A$2:$C$6, 3, FALSE) 
```

为确保您做对了，请单击单元格，公式应显示在大括号 ({}) 中。

注意：这假设“行”在 A1 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:57:42.123

我想出了一个解决方案，但它要求数据中的数字是并发的，就像这样

```
Name        Data
Joe         1
Tom         1
Eva         1
Adam        1
Tom         2
Tom         3
Eva         2 
```

但这没关系，因为无论如何我的数据看起来都是这样。因此，如果之前使用 Name ，则它必须是旧的最高 +1 即并发。

名称是 A1，数据是 B1，这个公式进入 C2：

```
FLOOR(SQRT(2*SUMIF(A2:A7,A2,B2:B7)),1) 
```

# asp.net - ASP.NET 在中继器控件中查找下拉值第二部分

> ID：932503
> 
> 赞同：0
> 
> 时间：2009-05-31T17:29:17.243
> 
> 标签：asp.net, vb.net, datarepeater

我对这个主题有几个问题，仍然有问题。

我想从转发器控件内的许多下拉列表和文本框控件中查找值。

```
db.ConnectionString = SystemConnString
    db.Open()

    Dim selectedAdTitle As String = ""
    Dim enteredAdFullName As String = ""

    cmd.Parameters.Add(New SqlParameter("@TransactionID", TransactionID))
    cmd.Parameters.Add(New SqlParameter("@AdTitle", selectedAdTitle))
    cmd.Parameters.Add(New SqlParameter("@AdFullName", enteredAdFullName))

    For i As Integer = 0 To myRepeater.Items.Count - 1

        Dim AdTitle As DropDownList = DirectCast(myRepeater.Items(i).FindControl("AdTitle"), DropDownList)
        Dim AdFullName As TextBox = DirectCast(myRepeater.Items(i).FindControl("AdFullName"), TextBox)

        selectedAdTitle = AdTitle.Text
        enteredAdFullName = AdFullName.Text

        cmd.Parameters("@AdTitle").Value = selectedAdTitle
        cmd.Parameters("@AdFullName").Value = enteredAdFullName

        SQL = ""
        SQL = SQL & "INSERT INTO InsuredPersons (TransactionID,Title,FullName) VALUES ("
        SQL = SQL & "@TransactionID,"
        SQL = SQL & "@AdTitle,"
        SQL = SQL & "@AdFullName"
        SQL = SQL & ")"

        cmd.CommandText = SQL
        cmd.Connection = db
        cmd.ExecuteNonQuery()
    Next 
```

AdTitle 和 AdFullName 似乎没有带来价值观。没有错误，因此他们发现控件正常。下面是 ASPX 文件代码。

```
<asp:Repeater ID="myRepeater" runat="server">
    <ItemTemplate>
        <asp:DropDownList ID="AdTitle" runat="server">
            <asp:ListItem Selected="True" Value="" Text=""/>
            <asp:ListItem Selected="False" Value="Miss" Text="Miss"/>
            <asp:ListItem Selected="False" Value="Ms" Text="Ms"/>
            <asp:ListItem Selected="False" Value="Mrs" Text="Mrs"/>
            <asp:ListItem Selected="False" Value="Mr" Text="Mr"/>
            <asp:ListItem Selected="False" Value="Other" Text="Other"/>
        </asp:DropDownList>

       <asp:TextBox ID="AdFullName" runat="server"></asp:TextBox>
   </ItemTemplate> 
```

编辑：

转发器是在页面加载时构建的

```
 Dim repeatTimes((TotalAdInsured - 1)) As Integer

    myRepeater.DataSource = repeatTimes
    myRepeater.DataBind() 
```

DirectCast 在按钮单击时完成

```
Protected Sub continueButtonDetails_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles continueButtonDetails.Click 
```

答案：必须将 IsPostback 放在中继器构造周围。

```
If Not IsPostBack() Then

        Dim repeatTimes((TotalAdInsured - 1)) As Integer

        myRepeater.DataSource = repeatTimes
        myRepeater.DataBind()

    End If 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T18:01:04.650

首先我认为你想要：

```
myDropDown.SelectedItem.Text 
```

而不是

```
myDropDown.Text 
```

另外为什么你有两个 ItemTemplates？我不知道你甚至可以做到这一点...

您是否在页面生命周期的任何其他时间点与任何 TextBoxes 或 DropDowns 进行交互？

尝试围绕转发器数据绑定进行 PostBack 检查。我认为发生的事情是您动态加载控件，因此它们没有视图状态，因此值将始终为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T17:41:32.110

确保您在页面生命周期的正确位置运行代码。如果你做得太早（例如在 OnInit 中），那么它还没有来自客户端的值。尝试将其移至您的 OnCommand()/OnSubmit() 事件，看看会发生什么。以下是 ASP.NET 页面生命周期的一些参考资料：

1.  [http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)
2.  [http://www.15seconds.com/issue/020102.htm](http://www.15seconds.com/issue/020102.htm)
3.  [http://www.beansoftware.com/ASP.NET-Tutorials/Page-Life-Cycle.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/Page-Life-Cycle.aspx)
4.  [asp.net页面生命周期图](http://blog.krisvandermast.com/content/binary/ASP.NET-2.0-life-cycle.png)

# oop - PHP clone 关键字 vs clone() 命令行 CLI 问题

> ID：932505
> 
> 赞同：0
> 
> 时间：2009-05-31T17:30:45.230
> 
> 标签：oop, php

我一直在使用 clone 关键字来复制对象，如下所示：

```
$x = clone $obj; 
```

按照[手册](http://php.net/language.oop5.cloning)。

这在浏览器访问时工作正常。`phpinfo()`报告 PHP 版本 5.2.6。

但是，当由 cron 或从 CLI 运行时，我得到

> “解析错误：语法错误，意外的 T_VARIABLE”

来自 clone 关键字。

`php -v`报告 PHP 4.4.9 (cli)

这个错误来自版本冲突吗？

如果我`clone()`像这样在我的脚本中使用：

```
$_SESSION['user'] = clone($userObject); 
```

`$_SESSION['user']`使用 clone 关键字时，我会遇到奇怪的间歇性问题。

这对任何人都有意义吗？

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T17:40:14.157

似乎该`clone $foo`关键字仅在 PHP 5 和更新版本上可用。

此外，如果您仍在使用 PHP 4.4.9，那可能是一个更大的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T18:47:01.687

原来服务器安装了 4 和 5 并且 CLI 报告 4.4.9 仅仅是由于 PATH 顺序：

来自支持：

“在 shell 中运行“php -v”命令将始终返回 V4。这是因为我们在您的服务器上安装了两个单独的 PHP。一个用于 V4，一个用于 V5，PHP 4 解释器显示在您的 PATH 环境变量中首先。如果您想通过 shell 使用 V5，您需要确保使用完整路径“

# python - 如何在 Python 中以字母数字顺序获取下一个字符串？

> ID：932506
> 
> 赞同：5
> 
> 时间：2009-05-31T17:33:15.057
> 
> 标签：python, string

我需要一个简单的程序，它给定一个字符串，以字母数字顺序（或只是字母顺序）返回给我下一个。

```
f("aaa")="aab"
f("aaZ")="aba" 
```

等等。

在其中一个模块中是否已经有此功能？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-31T17:46:17.203

我认为没有内置功能可以做到这一点。以下应该有效：

```
def next_string(s):
    strip_zs = s.rstrip('z')
    if strip_zs:
        return strip_zs[:-1] + chr(ord(strip_zs[-1]) + 1) + 'a' * (len(s) - len(strip_zs))
    else:
        return 'a' * (len(s) + 1) 
```

解释：你找到最后一个不是 a 的字符`z`，增加它，然后用`a`'s 替换它后面的所有字符。如果整个字符串是`z`'s，则返回`a`一个更长的字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T17:42:06.070

您[如何将其从 Perl 翻译成 Python？](https://stackoverflow.com/questions/604721/how-would-you-translate-this-from-perl-to-python/604777)充足的？不是 100% 你要问的，但接近...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T19:51:51.633

一个不同的，更长的，但也许更易读和更灵活的解决方案：

```
def toval(s):
    """Converts an 'azz' string into a number"""
    v = 0
    for c in s.lower():
        v = v * 26 + ord(c) - ord('a')
    return v

def tostr(v, minlen=0):
    """Converts a number into 'azz' string"""
    s = ''
    while v or len(s) < minlen:
        s = chr(ord('a') + v % 26) + s
        v /= 26
    return s

def next(s, minlen=0):
    return tostr(toval(s) + 1, minlen)

s = ""
for i in range(100):
    s = next(s, 5)
    print s 
```

您将字符串转换为一个数字，其中每个字母代表一个以 26 为基数的数字，将数字加一并将数字转换回字符串。这样，您可以对表示为字母字符串的值进行任意数学运算。

''minlen'' 参数控制结果的位数（因为 0 == a == aaaaa）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T20:06:12.810

糟透了，python 没有 ruby​​ 所拥有的东西：`String#next`所以这是一个处理字母数字字符串的糟糕解决方案：

```
def next_string(s):
  a1 = range(65, 91)  # capital letters
  a2 = range(97, 123) # letters
  a3 = range(48, 58)  # numbers
  char = ord(s[-1])
  for a in [a1, a2, a3]:
    if char in a:
      if char + 1 in a:
        return s[:-1] + chr(char + 1)
      else:
        ns = next_string(s[:-1]) if s[:-1] else chr(a[0])
        return ns + chr(a[0])

print next_string('abc')  # abd
print next_string('123')  # 124
print next_string('ABC')  # ABD

# all together now
print next_string('a0')   # a1
print next_string('1a')   # 1b
print next_string('9A')   # 9B

# with carry-over
print next_string('9')    # 00
print next_string('z')    # aa
print next_string('Z')    # AA

# cascading carry-over
print next_string('a9')   # b0
print next_string('0z')   # 1a
print next_string('Z9')   # AA0

print next_string('199')  # 200
print next_string('azz')  # baa
print next_string('Zz9')  # AAa0

print next_string('$a')   # $b
print next_string('$_')   # None... fix it yourself 
```

不是很好。有点适合我。

# wpf - 如何分隔 StackPanel 的子元素？

> ID：932510
> 
> 赞同：201
> 
> 时间：2009-05-31T17:34:03.573
> 
> 标签：wpf, silverlight, xaml, stackpanel

给定一个 StackPanel：

```
<StackPanel>
  <TextBox Height="30">Apple</TextBox>
  <TextBox Height="80">Banana</TextBox>
  <TextBox Height="120">Cherry</TextBox>
</StackPanel> 
```

即使子元素本身具有不同的大小，将子元素隔开以使它们之间存在相同大小的间隙的最佳方法是什么？可以在不为每个单独的孩子设置属性的情况下完成吗？

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2009-05-31T18:39:46.803

使用 Margin 或 Padding，应用于容器内的范围：

```
<StackPanel>
    <StackPanel.Resources>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="Margin" Value="0,10,0,0"/>
        </Style>
    </StackPanel.Resources> 
    <TextBox Text="Apple"/>
    <TextBox Text="Banana"/>
    <TextBox Text="Cherry"/>
</StackPanel> 
```

编辑：如果您想重新使用两个容器之间的边距，您可以将边距值转换为外部范围内的资源，fe

```
<Window.Resources>
    <Thickness x:Key="tbMargin">0,10,0,0</Thickness>
</Window.Resources> 
```

然后在内部范围内引用这个值

```
<StackPanel.Resources>
    <Style TargetType="{x:Type TextBox}">
        <Setter Property="Margin" Value="{StaticResource tbMargin}"/>
    </Style>
</StackPanel.Resources> 
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2011-05-29T22:29:12.317

另一种不错的方法可以在这里看到：http: [//blogs.microsoft.co.il/blogs/eladkatz/archive/2011/05/29/what-is-the-easiest-way-to-set-spacing-between- items-in-stackpanel.aspx](http://blogs.microsoft.co.il/blogs/eladkatz/archive/2011/05/29/what-is-the-easiest-way-to-set-spacing-between-items-in-stackpanel.aspx) 链接已损坏 ->[这是](http://web.archive.org/web/20120711175633/http://blogs.microsoft.co.il/blogs/eladkatz/archive/2011/05/29/what-is-the-easiest-way-to-set-spacing-between-items-in-stackpanel.aspx)此链接的网络存档。

它展示了如何创建附加行为，这样这样的语法就可以工作：

```
<StackPanel local:MarginSetter.Margin="5">
   <TextBox Text="hello" />
   <Button Content="hello" />
   <Button Content="hello" />
</StackPanel> 
```

这是将 Margin 设置为面板的多个子项的最简单和最快的方法，即使它们不是同一类型。（即按钮、文本框、组合框等）

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-01-17T12:28:53.547

我改进了[Elad Katz 的回答](https://stackoverflow.com/a/6170824/134761)。

*   将 LastItemMargin 属性添加到 MarginSetter 以专门处理最后一项
*   添加具有垂直和水平属性的间距附加属性，可在垂直和水平列表中的项目之间添加间距，并消除列表末尾的任何尾随边距

[gist 中的源代码](https://gist.github.com/angularsen/90040fb174f71c5ab3ad)。

例子：

```
<StackPanel Orientation="Horizontal" foo:Spacing.Horizontal="5">
  <Button>Button 1</Button>
  <Button>Button 2</Button>
</StackPanel>

<StackPanel Orientation="Vertical" foo:Spacing.Vertical="5">
  <Button>Button 1</Button>
  <Button>Button 2</Button>
</StackPanel>

<!-- Same as vertical example above -->
<StackPanel Orientation="Vertical" foo:MarginSetter.Margin="0 0 0 5" foo:MarginSetter.LastItemMargin="0">
  <Button>Button 1</Button>
  <Button>Button 2</Button>
</StackPanel> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-06-16T10:18:32.407

您真正想要做的是包装所有子元素。在这种情况下，您应该使用项目控件，而不是求助于可怕的附加属性，您最终将拥有一百万个您希望设置样式的属性。

```
<ItemsControl>

    <!-- target the wrapper parent of the child with a style -->
    <ItemsControl.ItemContainerStyle>
        <Style TargetType="Control">
            <Setter Property="Margin" Value="0 0 5 0"></Setter>
        </Style>
    </ItemsControl.ItemContainerStyle>

    <!-- use a stack panel as the main container -->
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>

    <!-- put in your children -->
    <ItemsControl.Items>
        <Label>Auto Zoom Reset?</Label>
        <CheckBox x:Name="AutoResetZoom"/>
        <Button x:Name="ProceedButton" Click="ProceedButton_OnClick">Next</Button>
        <ComboBox SelectedItem="{Binding LogLevel }" ItemsSource="{Binding LogLevels}" />
    </ItemsControl.Items>
</ItemsControl> 
```

![在此处输入图像描述](https://i.stack.imgur.com/br4sc.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-06-23T13:46:58.653

+1 谢尔盖的回答。如果你想把它应用到你所有的 StackPanel 上，你可以这样做：

```
<Style TargetType="{x:Type StackPanel}">
    <Style.Resources>
        <Style TargetType="{x:Type TextBox}">
            <Setter Property="Margin" Value="{StaticResource tbMargin}"/>
        </Style>
    </Style.Resources>
</Style> 
```

**但请注意：**如果您在 App.xaml（或合并到 Application.Resources 中的另一个字典）中定义这样的样式，它*可能*会覆盖控件的默认样式。对于像 stackpanel 这样的大多数看起来不显眼的控件，这不是问题，但是对于文本框等，您可能会偶然发现[这个问题](https://stackoverflow.com/questions/2901664/how-do-i-alter-the-default-style-of-a-button-without-wpf-reverting-from-aero-to-c)，幸运的是，它有一些解决方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-11T10:15:45.527

按照 Sergey 的建议，您可以定义和重用整个 Style（具有各种属性设置器，包括 Margin），而不仅仅是一个 Thickness 对象：

```
<Style x:Key="MyStyle" TargetType="SomeItemType">
  <Setter Property="Margin" Value="0,5,0,5" />
  ...
</Style> 
```

...

```
 <StackPanel>
    <StackPanel.Resources>
      <Style TargetType="SomeItemType" BasedOn="{StaticResource MyStyle}" />
    </StackPanel.Resources>
  ...
  </StackPanel> 
```

请注意，这里的技巧是对隐式样式使用样式继承，从某些外部（可能从外部 XAML 文件合并）资源字典中的样式继承。

*边注：*

起初，我天真地尝试使用隐式样式将控件的 Style 属性设置为外部 Style 资源（例如使用键“MyStyle”定义）：

```
<StackPanel>
  <StackPanel.Resources>
    <Style TargetType="SomeItemType">
      <Setter Property="Style" Value={StaticResource MyStyle}" />
    </Style>
  </StackPanel.Resources>
</StackPanel> 
```

这导致 Visual Studio 2010 立即关闭并出现 CATASTROPHIC FAILURE 错误（HRESULT: 0x8000FFFF (E_UNEXPECTED)），如[https://connect.microsoft.com/VisualStudio/feedback/details/753211/xaml-editor-window-fails中所述-当-​​a-style-tries-to-set-style-property 时发生灾难性失败#](https://connect.microsoft.com/VisualStudio/feedback/details/753211/xaml-editor-window-fails-with-catastrophic-failure-when-a-style-tries-to-set-style-property#)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-07-06T15:17:59.990

[Grid.ColumnSpacing](https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.grid#Windows_UI_Xaml_Controls_Grid_ColumnSpacing)、[Grid.RowSpacing](https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.grid#Windows_UI_Xaml_Controls_Grid_RowSpacing)、[StackPanel.Spacing](https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.stackpanel#Windows_UI_Xaml_Controls_StackPanel_Spacing)现在在 UWP 预览版中，所有这些都可以更好地完成这里的要求。

这些属性目前仅在 Windows 10 Fall Creators Update Insider SDK 中可用，但应该会达到最后阶段！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-31T18:22:27.097

UniformGrid 在 Silverlight 中可能不可用，但有人从 WPF 移植了它。[http://www.jeff.wilcox.name/2009/01/uniform-grid/](http://www.jeff.wilcox.name/2009/01/uniform-grid/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-04-16T00:14:07.160

我的方法继承了 StackPanel。

用法：

```
<Controls:ItemSpacer Grid.Row="2" Orientation="Horizontal" Height="30" CellPadding="15,0">
    <Label>Test 1</Label>
    <Label>Test 2</Label>
    <Label>Test 3</Label>
</Controls:ItemSpacer> 
```

所需要的只是以下简短的课程：

```
using System.Windows;
using System.Windows.Controls;
using System;

namespace Controls
{
    public class ItemSpacer : StackPanel
    {
        public static DependencyProperty CellPaddingProperty = DependencyProperty.Register("CellPadding", typeof(Thickness), typeof(ItemSpacer), new FrameworkPropertyMetadata(default(Thickness), FrameworkPropertyMetadataOptions.BindsTwoWayByDefault, OnCellPaddingChanged));
        public Thickness CellPadding
        {
            get
            {
                return (Thickness)GetValue(CellPaddingProperty);
            }
            set
            {
                SetValue(CellPaddingProperty, value);
            }
        }
        private static void OnCellPaddingChanged(DependencyObject Object, DependencyPropertyChangedEventArgs e)
        {
            ((ItemSpacer)Object).SetPadding();
        }

        private void SetPadding()
        {
            foreach (UIElement Element in Children)
            {
                (Element as FrameworkElement).Margin = this.CellPadding;
            }
        }

        public ItemSpacer()
        {
            this.LayoutUpdated += PART_Host_LayoutUpdated;
        }

        private void PART_Host_LayoutUpdated(object sender, System.EventArgs e)
        {
            this.SetPadding();
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-25T13:41:01.023

有时您需要设置 Padding，而不是 Margin 以使项目之间的空间小于默认值

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-30T13:05:30.810

通常，我使用`Grid`而不是`StackPanel`这样：

> 卧式案例

```
<Grid>
 <Grid.ColumnDefinitions>
    <ColumnDefinition Width="auto"/>
    <ColumnDefinition Width="*"/>
    <ColumnDefinition  Width="auto"/>
    <ColumnDefinition Width="*"/>
    <ColumnDefinition  Width="auto"/>
 </Grid.ColumnDefinitions>
 <TextBox Height="30" Grid.Column="0">Apple</TextBox>
 <TextBox Height="80" Grid.Column="2">Banana</TextBox>
 <TextBox Height="120" Grid.Column="4">Cherry</TextBox>
</Grid> 
```

> 垂直案例

```
<Grid>
     <Grid.ColumnDefinitions>
        <RowDefinition Width="auto"/>
        <RowDefinition Width="*"/>
        <RowDefinition  Width="auto"/>
        <RowDefinition Width="*"/>
        <RowDefinition  Width="auto"/>
     </Grid.ColumnDefinitions>
     <TextBox Height="30" Grid.Row="0">Apple</TextBox>
     <TextBox Height="80" Grid.Row="2">Banana</TextBox>
     <TextBox Height="120" Grid.Row="4">Cherry</TextBox>
</Grid> 
```

# javascript - 让 jQuery 在 Jetpack 中工作

> ID：932518
> 
> 赞同：1
> 
> 时间：2009-05-31T17:39:20.863
> 
> 标签：javascript, jquery, firefox-addon, firefox-addon-sdk

我正在试验 Jetpack，我想在给定的 html 页面中解析所有年份，然后用指向 Wiki 页面的链接包装年份。我在 jquery 中尝试了代码，它在那里工作，但现在我在 Jetpack 中使用它，它给出了一个错误 $(doc).replace is not a function。我绝对是 Jquery / Jetpack 的新手，所以也许我错过了一些非常简单的东西，但非常感谢您的帮助。

编辑：我已经尝试了这些建议，但我仍然卡住了。奇怪的是，这

JQuery 函数的工作原理：

```
(function($) {
    $.fn.clickUrl = function() {  
            var regexp = /([1-2][0-9][0-9][0-9])/gi;
            this.each(function() {
            $(this).html(
                  $(this).html().replace(regexp,'<ahref=\"http://nl.wikipedia.org/wiki/$1\">$1<\/a>')
            );
        });
    return $(this);
    }
})(jQuery); 
```

基本上，我想将此功能“移植”到 Jetpack。

这是我的 JQuery 函数到 Jetpack 的“旧”非工作端口：

```
jetpack.statusBar.append({  
    html: "Hyperlink Years",  
    width: 80,  
    onReady: function(widget){  
        $(widget).click(function(){  
        var regexp = /([1-2][0-9][0-9][0-9])/gi;
        var doc = jetpack.tabs.focused.contentDocument;
            $(doc).each(function() {
            $(this).html(
                    $(doc).replace(regexp,'<a href=\"http://nl.wikipedia.org/wiki/$1\">$1<\/a>'));
            });
       return $(doc); 
     });  
   }  

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T20:16:45.373

我不熟悉喷气背包，但你的 jquery 似乎很乱。

如果“doc”是 HTML 文档，那么执行 $(doc).each() 就没有任何意义。它只会循环一次，并且“this”将与 doc 相同。

然后稍后您正在执行 $(doc).replace(regexp, ...)，但 replace() 不是 jquery 函数。你可能想做 .html().replace(regexp, ...); 但是，我不建议这样做，因为它不起作用 - 您最终只会替换文档中的任何数字，即使它们是另一个 URL 或页面 HTML 的一部分。

有关更多信息，请参阅此问题或 google 获取 jquery 文本节点： [使用 jQuery 查找文本字符串？](https://stackoverflow.com/questions/926580/find-text-string-using-jquery/926881#926881)

# c++ - 使用 c++ 在 unix 上打开文件

> ID：932519
> 
> 赞同：8
> 
> 时间：2009-05-31T17:39:40.007
> 
> 标签：c++, unix

我正在尝试在 C++ 中打开一个文件，并且运行程序的服务器基于 tux。

```
string filename = "../dir/input.txt"; works but
string filename = "~jal/dir1/dir/input.txt"; fails 
```

当提供的文件名是第二种格式时，有什么方法可以在 c++ 中打开文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-31T17:43:23.200

`~jal`扩展由 shell（bash/csh/whatever）执行，而不是由系统本身执行，因此您的程序试图查看名为 的文件夹，`~jal/`而不是`/home/jal/`.

我不是 C 编码员，但`getpwent()`可能是您需要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-31T18:13:34.570

您可以扫描字符串，替换`~user`为适当的目录。

[POSIX](http://www.opengroup.org/onlinepubs/9699919799/functions/wordexp.html)函数可以做到这[`wordexp`](http://www.kernel.org/doc/man-pages/online/pages/man3/wordexp.3.html)一点，还有其他一些事情

*   变量替换，就像你可以使用`$HOME`
*   可选的命令替换，例如`$(echo foo)`（可以禁用）
*   算术扩展，例如`$((3+4))`
*   分词，就像`~/a ~/b`分成两个词
*   通配符扩展，例如`*.cpp`
*   并引用，`"~/a ~/b"`仍然如此

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-31T18:20:42.780

这是一段现成的代码，用于执行此任务：

> [如何像 shell 一样在文件名中扩展 `~'？](http://www.unixguide.net/unix/programming/2.9.shtml)

# c# - 为什么我的随机数生成器在 C# 中看起来不是随机的？

> ID：932520
> 
> 赞同：21
> 
> 时间：2009-05-31T17:39:45.840
> 
> 标签：c#, random

我正在使用 Microsoft Visual C# 2008 Express。

我找到了这段代码：

```
 public static int RandomNumber(int min, int max)
    {
        Random random = new Random();

        return random.Next(min, max);
    } 
```

问题是我已经运行了 100 多次，当我的 min = 0 和 max = 1 时，它总是给我相同的答案。我每次都得到 0。（我创建了一个测试函数来运行它——真的——我每次都得到 0）。我很难相信这是一个巧合......我还能做些什么来检查或测试这个吗？（我确实用 min = 0 和 max = 10 重新运行了测试，前 50 次，结果总是“5”，第二次 50 次，结果总是“9”。

?? 我需要一些更一致的随机...

-阿迪娜

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-31T17:43:58.940

min = 0 和 max = 1 的问题在于 min 是包容性的，而 max 是独占性的。因此，该组合的唯一可能值是 0。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-31T17:43:39.580

```
random = new Random(); 
```

这将启动具有当前时间（以秒为单位）的随机数生成器。当您在系统时钟更改之前多次调用您的函数时，随机数生成器以相同的值启动，因此它返回相同的值序列。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-31T17:47:59.353

不要为 Next 创建包装方法。它浪费了创建 Random 类的新实例的周期。只需使用相同的！

```
Random myRand = new Random();

for(int i = 0; i < 10; i++)
{
    Console.WriteLine(myRand.Next(0, 10).ToString());
} 
```

那应该给你十个随机值。

正如已经说过的——随机是伪随机的（就像所有的实现一样），如果你用相同的种子创建 100 个实例，你将得到 100 个相同结果的实例。确保您正在重用该类。

另外，正如人们所说，请注意 MinValue 是包容性的，而 MaxValue 是独占性的。对于您想要的，执行 myRand.Next(0, 2)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-31T17:45:28.513

Next() 的重载返回：

> 大于或等于 minValue 且小于 maxValue 的 32 位有符号整数；即返回值的范围包括minValue，但不包括MaxValue。如果 minValue 等于 maxValue，则返回 minValue。

0 是它返回的唯一可能值。也许您想要 random.NextDouble()，它将返回一个介于 0 和 1 之间的双精度数。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-31T17:43:18.113

最小值包含在内，但最大值不包含在内。 [查看 API](http://msdn.microsoft.com/en-us/library/2dx6wyd4.aspx)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-31T18:02:22.573

你总是得到 0 因为`Random.Next`返回整数。您需要调用`Random.NextDouble`，它将返回一个介于 0 和 1 之间的数字。此外，您应该重用 Random 实例，如下所示：

```
[ThreadStatic]
static Random random;
public static Random Random { 
    get {
        if (random == null) random = new Random();
        return random;
    }
}
public static int RandomInteger(int min, int max)
{
    return Random.Next(min, max);
}
public static double RandomDouble() //Between 0 and 1
{ 
    return Random.NextDouble();
} 
```

如果您想要加密安全的随机数，请使用`RNGCryptoServiceProvider`该类；看[这篇文章](http://msdn.microsoft.com/en-us/magazine/cc163367.aspx)

编辑：线程安全

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-31T17:50:14.530

除了其他答案中已经提到的 0-1 问题外，当您正在寻找 0-10 范围并连续 50 次获得相同结果时，您的问题是真正的问题。

`new Random()`应该返回一个随机数，其中包含从计时器初始化的种子（当前秒），但显然您每秒调用此代码 50 次。 [MSDN](http://msdn.microsoft.com/en-us/library/system.random(VS.71).aspx)建议：“为了提高性能，创建一个 Random 以随着时间的推移生成许多随机数，而不是重复创建一个新的 Random 以生成一个随机数。”。如果您在方法之外创建随机生成器，那应该可以解决您的“非随机性”问题并提高性能。

如果您需要“更高质量”的伪随机数，还可以考虑[这篇文章](http://www.c-sharpcorner.com/UploadFile/rmcochran/random07172006175425PM/random.aspx)以获得比系统提供的更好的伪随机数生成器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-31T17:51:04.637

正如其他人所提到的，每秒构建多次的 Random 使用与种子相同的秒数，因此我将 Random 构造函数放在循环之外，并将其作为参数传递，如下所示：

```
public static int RandomNumber(Random random, int min, int max)
{
    return random.Next(min, max);
} 
```

也正如其他人所提到的，最大值是独占的，所以如果你想要一个 0 或 1，你应该使用 [0,2] 作为你的 [min,max]，或者一些更大的最大值，然后用 1 进行二进制与。

```
public static int RandomOneOrZero(Random random)
{
    return random.Next(0, int.MaxValue) & 1;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-31T18:25:54.190

这是任何答案的附录，因为这个特定问题的答案是边界应该是 (0, 2) 而不是 (0, 1)。

但是，如果您想使用静态包装方法，那么您必须记住它`Random`不是线程安全的，因此您需要提供自己的同步机制或提供每个线程的实例。这是一个很大程度上非阻塞的实现，它使用一个生成器来为每个线程生成器播种：

```
public static class ThreadSafeRandom
{
    private static readonly Random seed = new Random();

    [ThreadStatic]
    private static Random random;

    public static int Next(int min, int max)
    {
        if (random == null)
        {
            lock (seed)
            {
                random = new Random(seed.Next());
            }
        }

        return random.Next(min, max);
    }

    // etc. for other members
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-25T17:41:55.357

您误解了“random.Next(min, max)”这一行。“min”代替允许随机生成的最小数字。虽然“max”是在不允许生成的最小数字的位置，但它不是在允许绘制的最大数字的位置。所以当这条线是 random.Next(0, 1) 你基本上只允许绘制 0 。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-31T19:26:14.680

几位张贴者表示 Random() 使用基于系统时钟上当前秒的种子，并且在同一秒内创建的任何其他 Random 实例将具有相同的种子。这是不正确的。Random 的无参数构造函数的种子基于滴答计数或自启动时间以来的毫秒数。此值在大多数系统上大约每 15 毫秒更新一次，但它可能会因硬件和系统设置而异。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-10-26T11:49:37.933

我找到了一种非常简单但有效的方法来生成随机数，只需获取当前日期时间毫秒的最后两位数：

```
 int seed = Convert.ToInt32(DateTime.Now.Millisecond.ToString().Substring(1, 2));
   int cnr = new Random(seed).Next(100); 
```

它很粗糙，但它有效！:-)

当然，它会在统计上每百次生成相同的数字。或者，您可以采用所有三个数字或与其他日期时间值（例如秒左右）连接。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-25T06:21:11.717

你的范围不正确。minValue 包含在范围内，而 maxValue 在范围内不包含（意味着它不会包含在范围内）。所以这就是为什么它只返回 0。

另一个有用的注意事项：在方法中创建一个 Random 实例并不理想，因为它可能在调用时获得相同的种子。所以我会说使用：

```
static Random gen = new Random();

public static int RandomNumber(int minValue, int maxValue){
    return gen.Next(minValue, maxValue);
} 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-05-31T17:42:32.217

在 VB 中，我总是从 Randomize() 函数开始。只需调用 Randomize() 然后运行您的随机函数。我还执行以下操作：

```
Function RandomInt(ByVal lower As Integer, ByVal upper As Integer) As Integer
    Return CInt(Int((upper - lower + 1) * Rnd() + lower))
End Function 
```

希望这可以帮助！:)

# asp.net-mvc - 如何调度在 ASP.Net MVC 中提交 AJAX 表单的结果？

> ID：932539
> 
> 赞同：1
> 
> 时间：2009-05-31T17:47:12.677
> 
> 标签：asp.net-mvc, ajax, forms

在 ASP.Net MVC 中，具有或多或少像这样的形式：

```
<% using (Ajax.BeginForm(new AjaxOptions() { OnSuccess="onSuccess"})) {%>
  <p>
    <label for="Comment">Comment:</label>
    <%= Html.TextArea("Comment")%>
    <%= Html.ValidationMessage("Comment", "*")%>
  </p>
  <p><input type="submit" value="Submit comment" /></p>
<% } %> 
```

onSuccess Javascript 函数如何知道结果是否是表单的另一个版本，因为它没有验证，是作为 div 添加到评论列表中的评论，还是应该弹出用于登录的登录页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T17:52:37.457

您可以在返回的 JSON 或您使用的任何传输方法中定义它吗？

不确定这是否是您要查找的内容，而且：这就是 onSuccess 函数的调用方式：

```
YourFunction(ajaxContext); 
```

AjaxContext 定义如下：

```
AjaxContext ajaxContext = new AjaxContext(request, updateElement, loadingElement, ajaxOptions.InsertionMode); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T19:32:08.320

您应该用新的局部视图替换 ajax 表单中的代码，然后您将从控制器返回该局部视图。部分观点包括：

```
<p>
    <label for="Comment">Comment:</label>
    <%= Html.TextArea("Comment")%>
    <%= Html.ValidationMessage("Comment", "*")%>
</p>
<p><input type="submit" value="Submit comment" /></p> 
```

这样，您的局部视图就像常规视图一样工作。不幸的是，没有简单的方法来执行 javascript 作为响应（因为您正在使用视图进行响应）。如果您的响应是 Json 字符串会更容易，但在这种情况下，您不能使用 AjaxForm，因为提交表单（并处理其响应）会在屏幕上呈现 Json 字符串。虽然这可能有效（我还没有尝试过）：

```
<p>
    <label for="Comment">Comment:</label>
    <%= Html.TextArea("Comment")%>
    <%= Html.ValidationMessage("Comment", "*")%>
</p>
<p><input type="submit" value="Submit comment" /></p>
<script type="text/javascript">
    function processResponse(data){
        // blah blah blah
    }
    processResponse(<%= ViewData["dataFromTheController"] %>);
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T19:37:58.323

您可以简单地将不同的 CSS 类添加到响应的根元素（例如 .form、.comments、.login）。然后（例如在 jQuery 中）：

```
var response = $(responseContent);
$('.form', response).each(function() {
    // $(this) is form
});
$('.comments', response).each(function() {
    // $(this) is comments
});
$('.login', response).each(function() {
    // $(this) is login page
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:04:58.907

> onSuccess Javascript 函数如何知道结果是否是表单的另一个版本，因为它没有验证，是作为 div 添加到评论列表中的评论，还是应该弹出用于登录的登录页面？

简短的回答是，除非您明确验证它，否则它不能。这是因为 JSON 是作为字符串传输的，并且当客户端 Javascript 获取字符串时。

对于初学者，您应该隐含地知道期望什么样的对象。如果您正在调用 Web 服务 @`Cars/List`那么您知道返回的对象将是汽车列表，您可以在客户端中适当地解析它。您可能会遇到错误，您应该通过重试请求或记录它们或显示错误消息来适当地处理这些错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-22T06:31:17.540

我建议你使用[jquery.form 插件](http://jquery.malsup.com/form/#getting-started)，这样你就可以有一个正常的表单来像一个 ajax 一样，像这样：

```
 <script type="text/javascript"> 
        // wait for the DOM to be loaded 
        $(document).ready(function() { 
            // bind 'myForm' and provide a simple callback function 
            $('#myForm').ajaxForm(function() { 
                alert("Thank you for your comment!"); 
            }); 
        }); 
    </script> 

<form id="myForm" action="comment.php" method="post"> 
    Name: <input type="text" name="name" /> 
    Comment: <textarea name="comment"></textarea> 
    <input type="submit" value="Submit Comment" /> 
</form> 
```

# javascript - 自动重启/重置倒数计时器

> ID：932540
> 
> 赞同：0
> 
> 时间：2009-05-31T17:47:16.220
> 
> 标签：javascript, jquery, scripting

我想要的是，当计时器到达结束日期和时间时，它会自动重新开始，但从 60 秒开始倒计时。我是 jquery 的新手，我被这个问题困扰了将近 3 天，我无法让它运行。我的倒计时与从数据库插入的结束数据完美配合，但是当它到达结束日期和时间（例如：0 天 0 小时 0 分钟 0 秒）时，它应该从 60 秒倒计时开始到零。

有人可以帮忙解决这个问题吗？下面是我正在使用的代码的平静。我将它与 PHP 结合使用，因此它还将创建用于倒计时的 div。

查询：

```
$data = '<script type="text/javascript">
$(function () {';
    foreach( $datarows as $key => $value ) { // start php foreach

    $data .= '
              $(\'#wincountdown'.$datarows[$key]['uid'].'\').countdown({ until: new Date( '. strftime( '%Y,%m - 1,%d,%H,%M',$datarows[$key]['end_bidding']).' ) }) ;
    ';
    } // end php foreach
$data .= '
});
</script>'; 
```

HTML

```
<div id="wincountdown<#nr#>">  </div> //build by db array 
```

所以上面的代码工作正常。现在它只应在到达结束日期时自动重新启动。所以我的问题是我如何实现这段代码来实现我想要它做的事情，或者我应该使用和添加来自 jquery 的什么功能？也许有人得到了一段已经在做类似事情的代码并且想要分享它？

请问有人可以帮我吗？如果我不够清楚，请让我更好地解释。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T17:51:32.983

使用[JQuery 倒计时](http://keith-wood.name/countdown.html)插件。

它具有可以在计时器达到零时触发的回调事件。发生这种情况时，只需重置和计时器。

假设这是我们的 html：

```
<div id="shortly"></div>
<button id="shortlyStart">Start</button> 
```

这大致是您需要重置倒数计时器的 JQuery。

```
// restart the timer on expiry
$('#shortly').countdown({until: shortly,  
    onExpiry: restart, onTick: watchCountdown}); 

$('#shortlyStart').click(function() { 
    // restart the timer on click
    restart();
}); 

function restart() { 
    shortly = new Date(); 
    shortly.setSeconds(shortly.getSeconds() + 5.5); 
    $('#shortly').countdown('change', {until: shortly}); 
} 

// show the timer results 
function watchCountdown(periods) { 
    $('#monitor').text('Just ' + periods[5] + ' minutes and ' + 
        periods[6] + ' seconds to go'); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T23:44:17.500

我再次研究了你上面的代码（这次更好一点）......当达到零时我的重新启动正在工作！是啊。必须在代码中调整一些其他的东西，但我的主要目标已经达到......非常感谢，这真的帮助我更好地理解 jquery。基本上它很简单，但首先必须了解基础:)

非常感谢！

# batch-file - 批量设置=log.txt

> ID：932552
> 
> 赞同：2
> 
> 时间：2009-05-31T17:59:50.817
> 
> 标签：batch-file, set, logging, text-files

我喜欢一个 log.txt 文件，其中包含：

```
MyName 
```

我的批次：

```
@echo off
set name= [log.txt] 
```

在 [log.txt] 部分，它应该从 log.txt 文件中读取“MyName”，将其设置为“name”。

如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T18:19:07.413

你也可以使用

```
set /p name=<log.txt 
```

这可能被认为更短且不那么丑陋。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T18:01:26.787

在 cmd.exe 中，只有这种丑陋的方式：

```
@echo off
for /f "usebackq tokens=* delims=" %%i in ("log.txt") do (
    set name=%%i
) 
```

# jsp - JSP中的编码问题

> ID：932559
> 
> 赞同：7
> 
> 时间：2009-05-31T18:03:09.623
> 
> 标签：jsp, encoding, utf-8, webforms

我有一个带有多个文本字段的 html 表单。

当我尝试提交非英文字符（在我的情况下为俄语）时，服务器收到“不可读”字符串（不是问题 - “???”，而是一些奇怪的字符）。

我简化了代码以在此处显示：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
  <head><title>Simple jsp page</title></head>
  <body>
    <c:out value="${param.rustext}"/>
    <form action="/test" method="post">
        <input type="text" name="rustext" width="30">
        <input type="submit" value="Submit">
    </form>
  </body>
</html> 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T18:38:42.827

Tomcat 使用 ISO-8859-1 作为 URL 参数的默认字符编码，而不考虑包含 URL 的页面的编码。这可以通过其连接器配置中的[“URIEncoding”属性进行更改。](http://tomcat.apache.org/tomcat-5.5-doc/config/http.html)其他应用服务器可能有类似的设置。

[本文](http://weblogs.java.net/blog/joconner/archive/2005/07/charset_traps.html "JSP/Servlet 容器中的字符集陷阱")涵盖了使用 JSP 时经常遇到的许多问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-29T07:41:25.463

埃里克森在此页面上很好地解释了这一点。与服务器无关的解决方案是使用字符编码过滤器，例如 org.springframework.web.filter.CharacterEncodingFilter。请参见下面的示例：

```
import java.io.IOException;
import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;

public class EncodingFilter implements Filter {
    private String encoding = "utf-8";
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain filterChain) throws IOException, ServletException {
        request.setCharacterEncoding(encoding);
        filterChain.doFilter(request, response);
    }
    public void init(FilterConfig filterConfig) throws ServletException {
        String encodingParam = filterConfig.getInitParameter("encoding");
        if (encodingParam != null) {
            encoding = encodingParam;
        }
    }
    public void destroy() {
        // nothing todo
    }
} 
```

在 web.xml 中的相应部分添加过滤器声明和过滤器 url 映射：

```
 <filter>
  <filter-name>EncodingFilter</filter-name>
  <description>
    <![CDATA[Changes the encoding of the request, in order to help the appserver to correctly interpret request params]]>
  </description>
  <filter-class>com.mypackage.EncodingFilter</filter-class>  
 <init-param>
    <param-name>encoding</param-name>
    <param-value>ISO-8859-15</param-value>
  </init-param>   
</filter>

  <filter-mapping>
      <filter-name>EncodingFilter</filter-name>
      <url-pattern>/*</url-pattern>
  </filter-mapping> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T19:12:05.490

当使用 POST（必须使用编码）时，表单作为内容类型“application/x-www-form-urlencoded”发送。您可以指定 form-attribute accept-charset="UTF-8" 来指定您的编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-08T13:14:48.420

这与 Victor Ionescu 提出的相同，但您不需要编写自己的编码过滤器。

将以下过滤器添加到 web.xml

```
<filter>
    <filter-name>charsetFilter</filter-name>
    <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
    <init-param>
        <param-name>encoding</param-name>
        <param-value>UTF-8</param-value>
    </init-param>
</filter>

<filter-mapping>
    <filter-name>charsetFilter</filter-name>
    <url-pattern>*.admin</url-pattern>
</filter-mapping> 
```

# .net - 使用.net RichTextEdit，但过滤数据类型？

> ID：932575
> 
> 赞同：3
> 
> 时间：2009-05-31T18:16:07.263
> 
> 标签：.net, drag-and-drop, richtextbox, copy-paste

.NET 中的`RichTextEdit`控件完成了我需要为我的应用程序执行的 99% 的操作，除了一些小事情：

1.  我想禁止将图像粘贴/拖动到控件中
2.  将文本粘贴/拖动到控件中时，我想将其样式重置为控件的默认值

据我所知，微软没有在这个控件上提供任何类型的“无图像”属性，你可以使用，这将是理想的。

我的想法是我可以响应“ `textChanged`”事件，然后在图像呈现到屏幕之前删除图像和/或重置文本样式。当然，这将是一个彻头彻尾的黑客攻击。一方面，用户的拖放鼠标图标表明图像是可拖放的，而实际上不是。

`RichTextEdit`长话短说，有没有办法对控件可以通过复制粘贴和拖放操作导入的数据类型设置过滤器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-17T21:07:59.723

这个有可能; 但是，您必须离开 .NET RichTextBox 接口的限制才能执行此操作，因为所需的回调位于[IRichEditOleCallback](https://msdn.microsoft.com/en-us/library/bb774308%28v=vs.85%29.aspx) COM 接口中。

为了让您了解所涉及的内容，在 ATL C++ 中（但不能保证这会起作用，并且您必须适应它，但是您可以使用您正在使用的任何语言创建一个普通的 Ol' COM 对象）：

```
#include <windows.h>
#include <Richole.h>
#include <atlbase.h>
#include <atlcom.h>
#include <atlcomcli.h>
#include <string>

struct RattyRichEditOleCallbackImpl: public CComObjectRoot, public IRichEditOleCallback
{
  HWND* hRichEdit;
  RattyRichEditOleCallbackImpl(): hRichEdit(NULL) {}
  HRESULT SetRichEditCtl(HWND *hCtl)
  {
    hRichEdit = hCtl;
    return S_OK;
  }
  HRESULT QueryAcceptData(LPDATAOBJECT lpdataobj, CLIPFORMAT* lpcfFormat, DWORD reco, BOOL fReally, HGLOBAL hMetaPict)
  {
    // This list of image formats covers all the standard ones listed in
    // the [MSDN docs](https://msdn.microsoft.com/en-us/library/ff729168.aspx)
    // if there are more CF_blahs that correspond to images, add them here
    if (*lpcfFormat == CF_DIB || *lpcfFormat == CF_DIBV5
      || *lpcfFormat == CF_BITMAP || *lpcfFormat == CF_TIFF
      || *lpcfFormat == CF_ENHMETAFILE || *lpcfFormat == CF_METAFILEPICT
      || *lpcfFormat == CF_PALETTE || *lpcfFormat == CF_DSPBITMAP
      || *lpcfFormat == CF_DSPMETAFILEPICT || *lpcfFormat == CF_DSPENHMETAFILE
      || *lpcfFormat >= CF_GDIOBJECTFIRST || *lpcfFormat <= CF_GDIOBJECTLAST)
    {
      // Bail out with an error HRESULT because we don't want some stinkin' image in our rich edit control!
      return E_NOTIMPL;
    }
    // Try to convert anything else to plain ol' Unicode text
    else
    {
      *lpcfFormat = CF_UNICODETEXT;
      // Are we being asked to paste this?
      if (fReally)
      {
        // Insert the data as text with the default style
        FORMATETC fmt = {*lpcfFormat, NULL, DVASPECT_CONTENT, -1, TYMED_HGLOBAL};
        STGMEDIUM stg;
        HRESULT res = E_UNEXPECTED;
        if (hRichEdit && (res = lpdataobj->GetData(fmt, stg)) == S_OK)
        {
          // Lock the HGLOBAL as it might not be ordinary heap mem
          WCHAR* pText = GlobalLock(stg.hGlobal);
          if (!pText)
          {
            ReleaseStgMedium(stg);
            return res;
          }
          std::wstring text(pText);

          // Do a bit of selection trickiness to ensure we have the default text style -- we can't just EM_PASTESPECIAL due to recursion issues
          DWORD cursorPos, selPos;
          SendMessageW(hRichEdit, EM_GETSEL, &cursorPos, &selPos);
          if (cursorPos == selPos)
          {
            // No selection, so select the character after the cursor, fetch it, and append it to the text
            SendMessageW(hRichEdit, EM_SETSEL, cursorPos, cursorPos + 1);
            WCHAR buffer[2];
            TEXTRANGEW tr = {{cursorPos, cursorPos + 1}, buffer};
            SendMessageW(hRichEdit, EM_GETTEXTRANGE, 0, &tr);
            text.append(buffer[0]);
          }
          // Now that we have ourselves a selection -- we can unformat it then replace it
          CHARFORMAT2 cf;
          cf.cbSize = sizeof(CHARFORMAT2);
          SendMessageW(hRichEdit, EM_GETCHARFORMAT, SCF_DEFAULT, &cf);
          SendMessageW(hRichEdit, EM_SETCHARFORMAT, SCF_SELECTION, &cf);
          SendMessageW(hRichEdit, EM_REPLACESEL, TRUE, text.c_str());

          GlobalUnlock(stg.hGlobal);
          ReleaseStgMedium(stg);
          // We did the work ourselves, so don't ask the control to do anything for us, unless something broke that is
          res = S_FALSE;
        }
        return res;
      }
      else
      {
        // Have the control check for us to see if it can coerce what's on the clipboard to CF_UNICODETEXT
        return S_OK;
      }
    }
  }
};

typedef CComObject<RattyRichEditOleCallbackImpl> RattyRichEditOleCallback;

inline void AttachRattyCallbackToRichEdit(HWND *hRichEdit)
{
  RattyRichEditOleCallback* pCb;
  if (RattyRichEditOleCallback::CreateInstance(&pCb) == S_OK)
  {
    CComPtr cb(pCb);
    cb->SetRichEditCtl(hRichEdit);
    SendMessage(hRichEdit, EM_SETOLECALLBACK, 0, cb);
  }
} 
```

# xpath - 使用 XPath 查询 html 标签

> ID：932579
> 
> 赞同：1
> 
> 时间：2009-05-31T18:18:15.950
> 
> 标签：xpath, selenium

我正在写硒测试。

我在那里有一个标签“分配设计器”，选择框紧跟在标签后面。不幸的是，选择框具有动态 id，我无法通过 id 或任何其他属性查询它。

我可以构建返回“文本'分配设计器'之后的第一个选择标签”的 XPath 查询吗？

PS。Selenium 仅支持 XPath 1.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T18:21:46.380

这将是这样的：

```
//label[text() = 'Assign Designer']/following-sibling::select[1] 
```

注意：

*   // 简写的效率很低，因为它会导致文档范围的扫描。如果您可以更具体地了解标签的位置，我建议您这样做。但是，如果文档很小，这将不是问题。
*   由于我对 Selenium 了解不多，所以我使用了“标签”。如果不是 a `<label>`，您当然应该使用实际的元素名称。;-)
*   `[1]`每当您使用像“”这样的轴时，请务必包含一个位置谓词（在这种情况下） `following-sibling`。它很容易被遗忘，如果是，你的表达可能会产生意想不到的结果。

# lisp - Allegro Webactions 不在 SBCL 上提供服务。调试方法或可能的解决方案？

> ID：932582
> 
> 赞同：1
> 
> 时间：2009-05-31T18:19:16.230
> 
> 标签：lisp, common-lisp, allegro

我正在尝试在 SBCL 上启动和运行 Portable Allegro Serve 和 Webactions。到目前为止，我已经设法让 paserve 正确地服务页面。但是 webactions 在控制台中出现以下警告：

```
1-aserve-worker: 05/27/09 - 21:28:43 - processing clp file "/home/user/pages/index.html"  got error The value NIL
                                                                 is not of type
                                                                   FUNCTION.
1-aserve-worker: 05/27/09 - 21:28:43 - while processing command "GET /testing/index.html HTTP/1.0"
got error The slot NET.ASERVE::OBJECTS is unbound in the object #<NET.ASERVE:CLP-ENTITY {C1C8201}>. 
```

关于为什么会发生这种情况的任何想法？或者，关于我如何闯入这个来检查/调查正在发生的事情的任何想法？

软件版本：在 debian 2.6.26 上运行的 SBCL 1.0.28，PAServe 1.2.47。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T03:48:51.573

似乎 asdf-install 附带的 acl-compat 库与 paserve 附带的 acl-compat 库不同。

我从来没有解决过上述问题，但是使用不同的 acl-compat 层使问题消失了。

# parsing - 如何在编译器中实现前向引用？

> ID：932583
> 
> 赞同：5
> 
> 时间：2009-05-31T18:20:00.720
> 
> 标签：parsing, yacc, bison, compiler-development, forward-reference

我正在使用 Lex 和 YACC（实际上是 Flex 和 Bison）创建一个编译器。该语言允许无限前向引用任何符号（如 C#）。问题是在不知道标识符是什么的情况下解析语言是不可能的。

我所知道的唯一解决方案是对整个源进行 lex，然后进行“广度优先”解析，因此类声明和函数声明等更高级别的内容在使用它们的函数之前得到解析。但是，对于大文件，这会占用大量内存，并且很难用 YACC 处理（我必须为每种类型的声明/正文创建单独的语法）。我还必须手写词法分析器（这不是什么大问题）。

我不太关心效率（尽管它仍然很重要），因为一旦我完成它，我将自己重写编译器，但我希望那个版本很快（所以如果有任何快速通用的不能在 Lex/YACC 中完成但可以手工完成的技术，也请提出建议）。所以现在，易于开发是最重要的因素。

这个问题有什么好的解决方案吗？这通常如何在 C# 或 Java 等语言的编译器中完成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T18:32:12.667

完全可以解析它。尽管标识符和关键字之间存在歧义，但 lex 很乐意通过给予关键字优先级来解决这个问题。

我看不出还有什么其他问题。您无需在解析阶段确定标识符是否有效。在解析时，您正在构建解析树或抽象语法树（差异很细微，但与本讨论的目的无关）。之后，您通过在解析期间生成的 AST 上执行传递来构建嵌套符号表结构。然后，您再次通过 AST 以检查使用的标识符是否有效。在 AST 上进行一个或多个附加解析以生成输出代码或其他一些中间数据结构，然后你就完成了！

编辑：如果您想了解它是如何完成的，请查看 Mono C# 编译器的源代码。这实际上是用 C# 而不是 C 或 C++ 编写的，但它确实使用了与 yacc 非常相似的 Jay 的 .NET 端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T16:43:30.120

一种选择是通过仅扫描和缓存令牌来处理前向引用，直到您遇到您知道如何使用的东西（有点像“恐慌模式”错误恢复）。运行完整文件后，返回并尝试重新解析之前未解析的位。

至于必须手写词法分析器；不要，使用 lex 生成一个普通的解析器，然后通过一个手写的 shim 从中读取，让您返回并从缓存中提供解析器以及 lex 生成的内容。

至于制作几个语法，在 yacc 文件上使用预处理器会有点乐趣，你应该能够将它们全部从同一个原始源中制作出来

# git - 子模块和分支之间的中间地带？

> ID：932586
> 
> 赞同：1
> 
> 时间：2009-05-31T18:21:40.077
> 
> 标签：git, branch, git-submodules

我刚刚开始为我的项目未完成的功能创建主题分支，由 Git 管理。它们都是非常独立的，一个主题分支不直接与另一个主题分支相关。然而，所有分支都有一些共同点，master分支是系统的核心，主题分支只是扩展了master分支的功能。

如果我理解正确，如果我在主分支中做一些影响（m）任何主题分支的事情（例如，更改用于在核心和各个功能之间进行通信的 API），那么更改不会传播到主题分支自动，以便可以相应地固定分支。这些更改需要手动合并或挑选到其他分支中。

我知道使用子模块可以实现这一点。然而，子模块导致主项目和潜在功能项目之间的分离过多，主要是因为这些功能不能自我维持。他们依靠核心。

所以，我正在寻找某种方法来说明某些文件/目录对于某个分支是唯一的，其他所有内容都来自主分支。缺少一个更好的类比，用 Photoshop 术语来说，我希望*master*是背景层，每个主题分支都是在它上面的一个部分透明的图像层，具有一些独特的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T21:07:49.000

Git 不支持“组合”或“配置继承”的概念，如“[灵活与静态分支](https://stackoverflow.com/questions/763099/flexible-vs-static-branching-git-vs-clearcase-accurev)”问题中所述。只有合并允许您“组合”所需的确切文件集。

子模块功能可帮助您识别一组连贯的文件，这些文件必须有自己的生命周期并按照自己的节奏进行标记。这不是您的功能的情况。

您的方法应该保持“[基于系统](https://stackoverflow.com/questions/769786/vendor-branches-in-git/769941#769941)”的方法，您可以在其中开发、标记和合并所有系统。如果主分支上发生了一些变化，则需要在功能分支上进行合并。
如果功能涉及的文件集与在主分支中修改的文件不同，那么合并将是微不足道的。如果没有，您可以按照[mateusza 的建议](https://stackoverflow.com/questions/932586/middle-ground-between-submodules-and-branches/932613#932613)，使用中间分支来解决冲突并评估这种合并的结果，同时保持特性分支不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T18:42:45.407

假设您有分支 master 和一堆分支：feature1、feature2、feature3 ......

```
$ git checkout feature1
$ git branch master-with-feature1
$ git checkout master-with-feature1
$ git merge master 
```

*每当您对master*或*feature1*进行任何更改时，您都可以签出到*master-with-feature1*并合并它们。

# c# - .Net 中最简单的唯一标识符是什么？

> ID：932589
> 
> 赞同：3
> 
> 时间：2009-05-31T18:23:53.740
> 
> 标签：c#, .net, guid, class-design

所以我有这个

```
public class Foo
{
    public int UniqueIdentifier;

    public Foo()
    {
        UniqueIdentifier = ????
    }    
} 
```

如何获得一个完全唯一的号码？

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-31T18:24:55.440

```
System.Guid  guid = System.Guid.NewGuid();
String id = guid.ToString(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T18:33:13.740

虽然不是 int，但创建唯一标识符的方法通常使用 GUID。您可以使用 Guid.NewGuid() 生成一个。

有一些不同的转换方法，包括字节数组和字符串。有关 GUID 的更多信息，您可以在[Wikipedia](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)上阅读它们。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T21:26:04.813

像这样使用`Guid`结构。

```
public class Foo
{
    public readonly Guid UniqueIdentifier;

    public Foo()
    {
        UniqueIdentifier = Guid.NewGuid();
    }    
} 
```

# visual-studio - Visual Studio 将 asp.net 标记突出显示为超链接

> ID：932590
> 
> 赞同：0
> 
> 时间：2009-05-31T18:24:05.487
> 
> 标签：visual-studio

从截图可以看出，vs2008认为asp标签是超链接。我已经重置了所有设置，但问题仍然存在。我尝试过不同的项目并且存在相同的问题。我已将项目移至另一个 Visual Studio 安装，但问题一直存在，直到我将它们移回。

有谁知道为什么会这样？

[替代文字 http://img12.imageshack.us/img12/9033/20090531191305.png](http://img12.imageshack.us/img12/9033/20090531191305.png)

[http://img12.imageshack.us/img12/9033/20090531191305.png](http://img12.imageshack.us/img12/9033/20090531191305.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T18:52:10.583

不得不说很奇怪。虽然我一无所知，但我还是会努力的。

这些是真正的超链接还是只是带下划线的文本？如果有下划线的文本，那么您可以更改设置（由于您提到了重置设置，这将不起作用）。如果它们是真正的超链接，我很难过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T19:15:03.003

`asp:`没有前缀的标签是否会发生这种情况。

例如，您能否创建一个 UserControl，然后将其拖入并给它一个不同的标签前缀

```
<cc1:MyCustomControl /> 
```

如果没有，那么听起来您的系统上已经设置了一些被视为`asp`协议的东西:(

但老实说，我完全不知道为什么会发生这种情况。

# apache - apachebench 中止并显示一条奇怪的错误消息

> ID：932595
> 
> 赞同：2
> 
> 时间：2009-05-31T18:26:46.327
> 
> 标签：apache, apache2, benchmarking

我在 apache 上运行了一个非常简单的 php 文件。然后我对apache进行基准测试，使用

```
ab -n 10000 -c 5  http://localhost/~me/hello.php?name=Niko 
```

但我收到此错误消息，具体取决于 c（对于 c=1，一切正常）：

```
apr_socket_connect(): Operation already in progress (37) 
```

我在 OSX 10.5.7 上使用 ApacheBench，版本 2.3。

非常简单的 PHP 文件就是这个：

```
<h1>Hello <?=$_REQUEST['name']?></h1> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T18:35:28.620

这可能与[http://www.nabble.com/ab(1)-fix-(Operation-already-in-progress-(37))-td22821642.html](http://www.nabble.com/ab(1)-fix-(Operation-already-in-progress-(37))-td22821642.html)相关。

这可能是它。帖子说：

> 固定在后备箱
> 
> 变化很大，所以我没有计划在短期内建议向后移植到 2.2.x 分支。在各种平台上的主干中进行一些测试/日常使用，以后可能适合向后移植。

好。这意味着我必须等待 2.3 或直接使用后备箱。我只是在做业余爱好，所以：不用了，谢谢。

# wpf - 绑定路径属性应该设置为什么？

> ID：932599
> 
> 赞同：1
> 
> 时间：2009-05-31T18:32:21.653
> 
> 标签：wpf, binding, path, itemssource

假设我在 C# 中有这个结构定义：

```
 public struct TimeSlotInfo
    {
        public int TimeSlotID;
        public int StartMin;
        public int CalcGridColumn;
        public string BackgroundCol;
        public bool ToDisable;
    } 
```

我有一个 linq 查询：

```
var TimeSlotsInfo = 
from ts in datacon.TimeSlots
select new TimeSlotInfo
{
    TimeSlotID = ts.TimeSlotID,
    StartMin = ts.StartMin,
    CalcGridColumn = CalcTimeSlotGridColumn(ts.StartMin),
    BackgroundCol = ts.ColorName,
    ToDisable = false
}; 
```

如果我将 ListBox 的 ItemsSource 属性设置如下：

```
lstBox.ItemsSource = TimeSlotsInfo; 
```

现在，如何设置绑定路径以从上述查询结果中引用“BackgroundCol”字段？

我已经尝试过 {Binding Path=TimeSlotInfo.BackgroundCol}、{Binding Path=TimeSlotInfo/BackgroundCol}，最后是 {Binding Path=BackgroundCol} ...它们似乎都没有工作..

任何人都可以帮忙吗？我试图尽可能简化这个例子。希望我的问题足够清楚。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T18:38:59.597

最后一个是正确的（{Binding Path=BackgroundCol}） - 但是，您不能绑定到字段，您只能绑定到属性。将您的类定义为：

```
class TimeslotInfo {
    public int TimeslotId {get; set;}
    /* Etc... */
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T18:42:46.390

你不仅应该像 Paul 所说的那样使用属性进行绑定，而且通常你应该首先[避免使用公共字段](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)。

此外，这感觉不应该是一个结构——你真的想要值类型语义吗？如有疑问，您应该默认在 C# 中创建类 - 您*真正*想要一个结构是非常罕见的。

最后，即使你*确实*想要一个结构，你也应该几乎总是让结构不可变。你几乎肯定会从可变结构中得到意想不到的结果。这一切都定义明确并且有充分的理由，但这可能不是您期望的行为。可变结构是邪恶的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T18:37:20.427

如果您希望您的项目显示存储在 BackgroundCol 中的任何内容，您只需将 ListBox 上的 DisplayMemberPath 属性设置为“BackgroundCol”。如果这不是您想要实现的目标，请更具体。

希望这可以帮助！！

# database-design - 如何跟踪用户每天访问该网站 X 天？

> ID：932610
> 
> 赞同：7
> 
> 时间：2009-05-31T18:39:55.960
> 
> 标签：database-design, methodology

Stack Overflow 上有一个新徽章。“ [woot](https://stackoverflow.com/badges/71/woot-enthusiast) ”徽章授予在 30 天内每天访问该网站的用户。如何实现这样的功能？您如何以最简单的方式跟踪用户在 X 天内每天访问该网站的情况？

我想有两个字段——一个用于上次登录的时间戳，另一个用于计算用户连续访问该站点的天数。逻辑是首先将计数器设置为1，并存储登录时间。在下一次登录时，检查自上次登录以来是否不超过一天，并增加计数器，或将其设置回 1。然后将时间戳字段更新为当前日期。

你能做得更简单吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T20:41:33.420

您确实需要一个 cookie，因为人们可能不会每天都*登录*- 例如因为他们会自动登录 2 周，或者因为他们在您的网站上不停地做事 50 小时不睡觉和吃午饭： ) 您可能实际上想要计算用户访问该站点的时间。

现在，理论上可以记录每次访问并执行数据库查询，正如上面建议的那样，但你可能会认为（就像我一样）它在有用性和隐私+简单性之间取得了错误的平衡。

您指定的算法明显存在缺陷：由于您仅存储整数天数，因此您错过了每 12 小时登录和注销的用户（您的算法会将天数保持为 1）

这是我发现每个用户有**两个**日期字段的最干净的解决方案，在一种不言自明的非面向对象的 Python 中：

```
# user.beginStreak----user.lastStreak is the last interval when 
# user accessed the site continuously without breaks for more than 25h 

def onRegister (user):
    ...
    user.beginStreak = user.endStreak = time() # current time in seconds 
    ...

def onAccess (user): 
    ...
    if user.endStreak + 25*60*60 < time():
        user.beginStreak = time()
    user.endStreak = time()
    user.wootBadge = ( user.endStreak-user.beginStreak > 30*24*60*60 )
    ... 
```

（请原谅我的 Pythonic 技能，我是一名学术和首次站点用户）

你不能用**一个**变量来完成这项任务。我相信有人可以写一个干净的论据来证明这一事实。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T20:07:14.440

实际上，如果会员的访问是在一个 SQL 数据库中，你可以用一个 SQL 查询来完成整个事情。这也可能比将所有数据发送到客户端程序来检查它更快：

```
/*
    Find all members who visited at least once every day
  for 30 or more days.  --RBarryYoung, 2009-05-31
*/
;WITH
  cteVisitDays as (
    Select
      MemberID
    , DATEDIFF(dd,'2008-06-01',VisitTime) as VisitDay
     From tblMembersLog
     Where Not Exists( Select * From tblMemberTags T
    Where T.MemberID = tblMembersLog.MemberID
     And T.TagName = 'WOOT!' )
     Group By MemberID
        , DATEDIFF(dd,'2008-06-01',VisitTime)
    )
, cteVisitRunGroups as (
    Select 
      MemberID
    , VisitDay - Row_Number() Over(
            Partition By MemberID
            Order By VisitDay
        ) as RunGrouping
     From cteVisitDays
     )
SELECT Distinct
  MemberID
 From cteVistRunGroups
 Group By MemberId, RunGrouping
 Having COUNT(*) >= 30 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T18:43:12.847

使用时间戳跟踪数据库中的每次访问（您可能已经这样做了）。然后创建一条sql语句，将结果按天分组，同时统计当天的访问次数。在过去 30 天内，不允许有 0-visit day...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T18:50:06.080

我第二个 ropstah 的方法。登录时间等用户统计信息通常在数据库中可用。我们需要从可用数据中得出某些事实。因此，与其为每次访问设置一个计数器并增加内容，我更喜欢在用户登录数据上运行并发布当天结果的批处理作业。

但是，一旦用户“吸引”了用户，您可能希望停止为该用户计算“吸引”。否则，用户每天都有可能被“吸引”，直到遇到无登录日。（但这是一个小问题）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T18:47:50.187

如果这是您想要记录的唯一内容，那么也许这是一个很好的解决方案。但是，我喜欢将逻辑和日志分开，既可以增加我可以使用的原始信息量，也可以在不破坏现有数据的情况下调整逻辑。

在这种情况下，我会记录每次访问或每次操作（取决于要求/空间/等），然后在某处编写一个存储过程或方法来检查数据并返回 true（匹配徽章标准）或 false（不匹配标准）。

我会创建一个特定的模式来保存这样的信息的唯一情况是，如果所需的计算时间太长，要么是因为数据量大，要么是因为数据的复杂性。

# asp.net-mvc - 如何将 MVC 路由添加到特定控制器？

> ID：932611
> 
> 赞同：7
> 
> 时间：2009-05-31T18:41:22.820
> 
> 标签：asp.net-mvc

我的大脑不知为何一片空白。我该怎么做呢：

我有一个`RegistrationController`并希望 URL`/register`能够`Register`在该控制器上执行操作。我必须在 global.asax 中添加什么作为地图路线？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-31T19:53:15.030

其实，你想要的是这样的：

```
routes.MapRoute(
            "RegisterRoute",
            "Register",
            new { controller = "Registration", action = "Register" }
        ); 
```

现在您可以使用以下网址访问您的页面：

[http://www.yoursite.com/register](http://www.yoursite.com/register)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T18:53:01.253

```
routes.MapRoute(
                "MyCustomRoute",                                              // Route name
                "Registration/Register",                           // URL with parameters
                new { controller = "Registration", action = "Register" }  // Parameter defaults
            ); 
```

# facebook - 如何从 FB 连接应用程序发布 FB 通知？

> ID：932616
> 
> 赞同：1
> 
> 时间：2009-05-31T18:44:03.907
> 
> 标签：facebook

如何仅使用 FMBL 从 FB Connect APP 发布通知？可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T20:53:22.523

仅使用 fbml 是不可能的。一方面，您需要以某种方式指定*哪些*朋友会收到通知，这意味着某种逻辑是必要的。

您需要在客户端使用 JS 调用 REST API：

[http://wiki.developers.facebook.com/index.php/JS_API_M_FB.ApiClient.Notifications_send](http://wiki.developers.facebook.com/index.php/JS_API_M_FB.ApiClient.Notifications_send)

或在后端使用 xml：

[http://wiki.developers.facebook.com/index.php/Notifications.send](http://wiki.developers.facebook.com/index.php/Notifications.send)

有最常见的 Web 语言（python/php/ruby）的 api 客户端库。

# java - servlet 上下文的多个动态数据源

> ID：932625
> 
> 赞同：0
> 
> 时间：2009-05-31T18:52:51.347
> 
> 标签：java, tomcat, jdbc, jndi

我正在开发一个 java servlet Web 应用程序，该应用程序管理来自多个数据库（结构相同）的信息，每个数据库对应于不同的“业务”。用户选择存储在会话中的“当前业务”，应用程序可以显示或修改该“当前业务”。

我想以动态的方式使用 tomcat 资源，以便使用 jndi 访问这些业务。通过这种方式，我可以在 servlet 中使用 jstl sql 标记或上下文查找。我无法在 web.xml 文件中定义每个资源，因为它们存储在 SQL 表中。最终结果是能够编写具有以下行的简单 jsp：

```
<%@ taglib uri="http://java.sun.com/jstl/sql" prefix="sql" %>

<sql:query var = "users" dataSource="sources/${sessionScope.currentBusiness}">
  select id, firstName, lastName FROM user
</sql:query> 
```

或可以有这样的行的 servlet

```
String request.getSession().getAttribute("currentBusiness");

Context initial = new InitialContext();
Context context = (Context) initial.lookup("java:comp/env");
DataSource source = (DataSource) context.lookup("sources/" + currentBusiness); 
```

我可以在哪里获得“当前业务”的正确数据源。

我已经尝试编写自己的从 javax.naming.spi.ObjectFactory 派生的 ObjectFactories，但没有成功。关于如何轻松做到这一点的任何指示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-31T15:24:37.343

我最终选择了以下由 SessionListener 和 Servlet 组成的解决方案，其工作方式如下。SessionListener 具有以下形式：

```
public class SessionListener implements HttpSessionListener {

  public void sessionCreated(HttpSessionEvent event) {

    HttpSession session = event.getSession();

    // get list of possible data sources available to this session
    List<DataSource> sources = new ArrayList<DataSource>();
    ... code to get the available sources

    // get the current data source
    DataSource source = null;
    ... code to get the current source                               
    source = sources.get(0); // for example

    // setup the session attributes
    session.setAttribute("availableSources", sources);
    session.setAttribute("currentSource", source); 

  }

} 
```

每当用户登录并创建会话时，可用数据源列表和当前数据源列表都会放入会话中。这是在会话级别完成的，因为数据源依赖于用户登录。现在可以从应用程序内部访问它们。为了更改当前的数据源，我使用这个简化版本创建了一个 Servlet：

```
public abstract class BoxletServlet extends HttpServlet {

  protected void doGet(HttpServletRequest request, HttpServletResponse response) 
    throws ServletException, IOException {

    HttpSession session = request.getSession(true);
    String s = request.getParameter("source");

    // based on 's' choose from the available DataSource
    List<DataSource> sources = (List<DataSource>) session.getParameter("availableSources");
    Source source = chooseFrom(sources, s);                                                       
    session.setParameter("currentSource", source);          

    // forward to a page saying that the DataSource changed

  } 
```

}

通过这个实现，现在可以创建以下 jsps：

```
<%@ taglib uri="http://java.sun.com/jstl/sql" prefix="sql" %>

<sql:query var = "users" dataSource="${sessionScope.currentSource}">
  select id, firstName, lastName FROM user
</sql:query> 
```

希望它可以帮助别人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T20:15:48.823

[在ServletContextListener](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletContextListener.html)中创建数据源并将它们放在[ServletContext](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletContext.html)中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T20:47:47.403

这种方法肯定会“奏效”，但对我来说，为每个企业建立一个单独的、相同的数据库的概念似乎是错误的。当然，能够在模式中的某处描绘业务似乎是可能的。以这种方式分离它们需要每个企业都有一个新的数据库，其中模式只需要一个新的企业标识符。

我还认为，跨业务数据挖掘的任何可能性都会丢失，除非您将来自不同数据库的数据 ETL 到一个维度多维数据集中以进行临时报告和查询。

并且 JSTL <sql> 标签应该只用在最简单的 web 应用程序中。当您放弃中间层的验证时，您就会对 SQL 注入攻击的可能性持开放态度。

更新：

您必须在 web.xml AFAIK 中声明资源，因此每当您有一个新数据库时，您都必须停止应用程序、配置新的 JNDI 源并重新启动 Tomcat。我希望您是集群的，因为每次添加新业务/数据库时，所有以前的客户端都会受到应用程序关闭的影响。

# sharepoint - 移动 SharePoint (MOSS 2007) 网站

> ID：932630
> 
> 赞同：1
> 
> 时间：2009-05-31T19:03:36.287
> 
> 标签：sharepoint, sharepoint-2007

我有一个具有以下结构的网站集：

*   销售部网站（网站集顶级网站）
    *   销售部分站1
    *   销售部分站2

我们现在需要插入一个新的顶级站点，以便新结构如下所示：

*   销售公共站点（站点集合顶级站点）
    *   销售部现场
        *   销售部分站1
        *   销售部分站2

因此，我需要将所有现有内容下移一个级别，并在站点集合顶级站点中插入新内容。

实现这一目标的最佳方法是什么？我的想法是创建一个新的网站集，其中包含我需要的顶级网站（销售公共网站）。然后，我可以导出销售部站点的内容并将其作为子站点导入到新站点集中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T08:50:51.667

您可以通过顶级站点上“站点操作”菜单中的“管理内容和结构”移动整个站点，因此无需导出和导入站点。

如果“站点操作”菜单中不存在“管理内容和结构”，请按照[本指南访问。](http://office.microsoft.com/en-us/sharepointserver/HA101317231033.aspx#1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T05:23:31.087

这种方法应该奏效。最简单的方法是导出站点模板，但这确实有一个相当小的大小限制。对于较大的站点，您可以使用内容部署向导获得一些东西。

当然，任何假设当前结构的网站定制都不能保证继续工作。是否可以简单地更改 url 和导航以使其看起来像主站点的一部分？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T08:51:48.670

你的方法是正确的。但是，如果您使用的是 MOSS，您应该使用**管理内容和结构**功能而不是导出站点。此功能允许您移动您的网站并重组您的收藏。[学到更多...](http://office.microsoft.com/en-us/sharepointserver/HA101317231033.aspx#5)

如果您将网站集创建为纯协作网站，则必须在顶级网站上激活 SharePoint 标准发布功能才能启用此选项。

请注意：此功能在 WSS 中不可用。

# c# - C# 和 ASP.NET 中的换行符变化是什么？（\r\n 对比\n）

> ID：932633
> 
> 赞同：1
> 
> 时间：2009-05-31T19:04:25.987
> 
> 标签：c#, asp.net, asp.net-mvc, newline

我从一开始就一直在为 ASP.NET 编写代码，今天我遇到了以前从未见过的东西。通常，我通过期待“\r\n”来寻找 C# 中的换行符（例如，当从文本区域在 ASP.NET 中发布时）。现在我正在使用 MVC 框架，从 textarea 传过来的文本只是用“\n”表示换行符。

老式的 TextBox 控件中是否发生了使换行符正常化的事情？由于 MVC 只是按原样使用表单数据，这是否正常？很想得到一些见解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T19:11:10.077

我观察到实际的换行顺序因浏览器而异。

如果您在页面上有一个多行文本区域并且该页面已提交，则：

IE 返回 "\r\n" 表示换行。在这种情况下，FF 返回“\n”。

我在 2006 年底的某个地方对其进行了测试，所以现在可能会有所不同。

我不相信它与 WebForms 与 MVC 有任何关系。两者都只是处理提交的输入并将其原样返回给您。

如果您希望以某种方式处理和替换这些字符，那么按从多到少的顺序进行操作是有意义的：

```
string userText = form["Text"];
userText = userText.Replace ("\r\n", "<br/>").Replace ("\r", "<br/>"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T19:09:26.103

\n 是 *nix 风格系统上的换行符。\r\n 是 Windows 特定的行尾行为。

如果您正在检查行尾并将您的界面暴露给非 Windows 环境，请确保不仅要检查 \r\n 还要单独检查 \n。

有关更多背景信息，请查看 Wikipedia 上的[Newline](http://en.wikipedia.org/wiki/Newline)文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-04T18:51:40.767

我正在使用[Environment.NewLine](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)：

```
string userText = form["Text"];
userText = userText.Replace (Environment.NewLine, "<br />") 
```

还可以查看[@Haacked](https://stackoverflow.com/users/598/haacked)关于一些[换行文本区域怪癖](http://haacked.com/archive/2008/11/18/new-line-quirk-with-html-textarea.aspx)的帖子。

# sql-server - CardFiveID 打印软件的 Db 图像格式

> ID：932635
> 
> 赞同：0
> 
> 时间：2009-05-31T19:05:38.870
> 
> 标签：sql-server, image, integration

我正在为 ID 卡打印机使用 Card Five ID 打印软件。它是卡片设计软件，我想用存储在 MSSQL Server 数据库中的数据打印卡片。问题在于存储员工的照片。我尝试了不同格式的 JPG、BMP，并使用 C# 中的二进制阅读器来填充数据库中的图像文件。

如果有人知道如何解决这个问题，以及卡五软件使用什么格式的数据，我会很感激？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T10:27:18.537

根据他们的网站，Card Five 支持（至少）JPEG 图像。

你是如何存储图像的？为了在 FILESTREAM 出现之前存储文件，我们使用 varbinary(max) 字段并编写了一个简单的 C# 前端来获取流并根据 MIME 类型保存（或打开它）（我们使用数据）。虽然 MIME 确实增加了一点开销，但处理数据要容易得多。

# delphi - 有没有办法从包含文件中获取当前单位的名称？

> ID：932638
> 
> 赞同：5
> 
> 时间：2009-05-31T19:07:54.483
> 
> 标签：delphi, include, compiler-warnings

我正在将一些代码从一个框架库移植到另一个框架库，这需要我注释掉大部分代码只是为了让它编译，然后小心地恢复它们。与此同时，由于所有注释掉的代码，我收到了大量警告。所以我决定写一个快速的包含文件来抑制它们：

```
{$MESSAGE WARN 'Warnings suppressed for unported unit with commented-out code'}
{$WARN NO_RETVAL OFF}
{$WARN USE_BEFORE_DEF OFF} 
```

我将它包含在所有给我大量警告的单元中，但是现在当我编译时，编译器返回的消息如下：

[DCC 警告] unfinished.inc(1)：未移植单元的 W1054 警告被抑制，带有注释掉的代码

我希望它告诉我警告来自执行包含的单元，而不是包含文件本身。有没有办法做到这一点，或者将单元的名称放入消息中，而无需实际将 $MESSAGE 指令从包含文件中移出并移到我执行此操作的每个单元中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-31T23:47:06.573

这是一个技巧，它使用了这样一个事实，即“未使用的私有方法”的编译器提示包含单元的名称，该类在其中声明，即使具有私有方法的类在包含文件中声明也是如此。

**这要求包含文件的包含指令出现在允许声明的单元的一部分中**，因此在接口部分的使用子句之后或实现部分的使用子句之后。

```
interface

uses Foo, Bar, Socks;

{$include Unfinished.inc} 
```

您的包含文件应如下所示：

```
{$MESSAGE WARN 'Warnings suppressed for unported unit with commented-out code, Unit name see next line'}
type
  TUnit_With_Suppressed_Warnings = class
  private
    procedure UnitWithSuppressedWarnings; virtual; abstract;
  end;

{$WARN NO_RETVAL OFF}
{$WARN USE_BEFORE_DEF OFF} 
```

现在，对于包含该包含文件的每个单元，您将收到以下两条消息：

> [DCC 警告] unfinished.inc(1)：未移植单元的 W1054 警告被取消，代码被注释掉，单元名称见下一行
> [DCC 提示]actualunitname.pas(5)：私有符号 UnitWithSuppressedWarnings 已声明但从未使用。

请注意，实际单位的名称出现在第二行。

备注：如果关闭编译器提示，您将看不到第二行。

# haskell - Haskell：不能使用“map putStrLn”？

> ID：932639
> 
> 赞同：64
> 
> 时间：2009-05-31T19:08:18.757
> 
> 标签：haskell, io, monads

我有一个字符串列表，并尝试了这个：

```
ls = [ "banana", "mango", "orange" ]

main = do
       map PutStrLn list_of_strings 
```

那没有用，我不明白为什么。

```
ghc print-list.hs
print-list.hs:3:0:
    Couldn't match expected type `IO t' against inferred type `[IO ()]'
    In the expression: main
    When checking the type of the function `main' 
```

有什么提示吗？我想这与 map 返回一个列表而不是一个值有关，但我没有找到一种简单的方法来解决这个问题。

现在我知道打印字符串列表的唯一方法是编写一个函数来迭代列表，打印每个元素（如果列表是 [a] 则打印，但如果它是 (a:b) 则打印并递归）。但是只使用地图会简单得多*......*

谢谢！

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-05-31T19:28:13.367

函数的类型`main`应该是`IO t`（`t`类型变量在哪里）。的类型`map putStrLn ls`是`[IO ()]`。这就是您收到此错误消息的原因。您可以通过在中运行以下命令自己验证这一点`ghci`：

```
Prelude> :type map putStrLn ls
map putStrLn ls :: [IO ()] 
```

[`mapM`](http://haskell.org/ghc/docs/latest/html/libraries/base/Control-Monad.html#v%3AmapM)该问题的一种解决方案是使用`map`. 或者你可以使用[`mapM_`](http://haskell.org/ghc/docs/latest/html/libraries/base/Control-Monad.html#v%3AmapM_)which 相同`mapM`但不收集函数的返回值。既然你不关心 的返回值`putStrLn`，这里用起来比较合适`mapM_`。`mapM_`具有以下类型：

```
mapM_ :: Monad m => (a -> m b) -> [a] -> m () 
```

以下是如何使用它：

```
ls = [ "banana", "mango", "orange" ]
main = mapM_ putStrLn ls 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-31T19:32:48.597

艾曼的回答对这种情况最有意义。一般来说，如果你有`[m ()]`并且你想要`m ()`，然后使用`sequence_`，其中`m`可以是任何单子，包括`IO`.

# javascript - 如何从循环对象中释放内存

> ID：932640
> 
> 赞同：0
> 
> 时间：2009-05-31T19:08:40.783
> 
> 标签：javascript, memory-leaks, javascript-framework

我正在尝试动态更新使用 Prototip 和 Prototype 制作的工具提示。我尝试这样做的方式可能不是最好的方式（所以如果你知道更好的方式会有所帮助），但我能想到的唯一方法是将javascript保存在 div 元素中并更新div 元素内的 javascript 以更新工具提示。但是，这似乎是内存泄漏，因为每次更新 javascript 时，都会创建一个新的 Tip 对象并将其存储在内存中。如果没有更好的方法，我该如何清除内存？

我制作了这个简单的脚本来测试内存泄漏，现在我需要弄清楚如何制作它，以便在这个示例中修补内存泄漏。

```
for (i=0; i<1000; i++) {
    $('testdiv').update("<script type='text/javascript'> new Tip('chips_tip', 'Your Chips', {style: 'creamy',stem: 'topLeft',hook: { mouse: true, tip: 'topLeft' },offset: { x: 10, y: 16 },delay: 0.04,width: 85}); <\/script>");
} 
```

以下是工具提示的 javascript 通常是什么：

```
new Tip('element', "Description", {
    style: 'creamy',
    stem: 'topLeft',
    hook: { mouse: true, tip: 'topLeft' },
    offset: { x: 10, y: 16 },
    delay: 0.04,
    width: 85
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T20:05:38.330

似乎新的 Tip 构造可以将元素而不是工具提示文本作为参数。您可能想尝试使用它。我没有这样做，所以你必须自己尝试。首先，创建工具提示布局（包含工具提示文本的 div 标签）并像往常一样设置样式。将此 div 的样式属性设置为“display:none”。然后尝试像这样创建提示：

```
new Tip('source', $('tooltip_container')); 
```

然后，您可以使用以下方法更改工具提示的文本：

```
$('tooltip_container').update('new tooltip text'); 
```

将工具提示构造分配给全局空间中的变量是不够的，因为在我看来，prototip 将它自己的工具提示 html 内容插入到 dom 中。我的猜测是，每次您调用“新提示”时，您都会在 dom 中添加额外的 html。这些对象然后引用 dom 节点，因此它们永远不会被垃圾收集。您应该很容易使用您的测试代码和萤火虫来检查 dom。

最后一个选项是查看 prototip 源代码，看看它是否有某种 setTooltipText 函数。然后你也许可以做这样的事情：

```
var tooltip = new Tip('element', 'text');
// snip
tooltip.setText('some new text'); 
```

如果这没有帮助，只需向 prototip 的作者发送电子邮件即可。我相信他会很乐意提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T19:50:44.817

正如您所注意到的，简单地实例化一个新的 Tip 将意味着一个新的 Tip 对象被创建并存储在内存中。

为了解决这个问题，您需要将 Tip 分配给全局范围内的唯一变量。即实例化变量“tooltip”，然后在您的例程中使用“tooltip = new Tip”（这将允许一次仅使用 1 个工具提示，我认为这是您想要的，因为只能显示一个）。垃圾收集应该照顾其余的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T19:51:04.363

通过实例化“提示”对象，您实际上执行了构造函数调用，例如简单的函数调用，它相应地处理和更新可视元素，但是一旦该对象没有被任何变量引用，它应该被垃圾收集器收集。如果您想确定可以执行以下操作：

```
var tip = new Tip( whatever);
// before next update do delete tip; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T19:58:27.143

看起来这实际上是 Prototype 中的内存泄漏。 [据此](http://www.nickstakenburg.com/forum/comments.php?DiscussionID=955&page=1#Item_0)，泄漏已在 1.6.1 中修复。

# html-select - 帮助 html 选择替换

> ID：932644
> 
> 赞同：2
> 
> 时间：2009-05-31T19:10:59.733
> 
> 标签：html-select

我讨厌默认选择控件，那是因为它不能在 IE 中使用 CSS 设置样式。这就是为什么我从头开始开发一个新的选择控件，使用 HTML + CSS + JavaScript。在过去的两天里，我将 CSS 和 HTML 匹配在一起做得很好，但今天我发现了一个看起来很难修复的错误。

在 IE 7 中，当我在同一页面上有两个控件时，顶部的控件不会覆盖底部的控件。

查看图片：coolrgb dot com/files/select-help.jpg

下载演示页面（HTML + CSS + Javascript）：coolrgb dot com/files/select-help.zip

请帮助我，这个控件对我来说看起来很不错，我想从现在开始在我的所有项目中使用它。这个错误扼杀了我的希望和大量时间。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T19:24:21.127

*编辑：重读问题后，这个答案现在似乎完全不相关，但我还是把它留在这里。*

不是真正的答案，而是试图解释：

在 Internet Explorer 中，``<select>``标签被实现为简单的[窗口控件](http://blogs.msdn.com/oldnewthing/archive/2005/02/11/371042.aspx "老新事物：无窗口控件并不神奇")，而所有其他元素都是无窗口控件（这允许它们被设置样式）。这就是为什么这些标签总是在顶部并且不遵循 z 顺序规则。（下拉菜单部分必须是可设置样式的，因此它是一个无窗口控件，因此它显示在主要部分下方。）

在 Firefox 中，所有元素都是无窗口的，在 IE8 中也应该如此。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T19:29:49.977

如果您给每个控件相同的 z-index，那么您将无法控制堆叠顺序。

我建议修改您的控件，使其表现得更像一个真正的 SELECT 元素：一次只能打开一个，否则失去焦点会导致它关闭。或者，您可以在控件具有焦点时设置较高的 z-index，而在没有焦点时设置较低的 z-index。

另一件需要注意的事情：尝试将其他一些控件（如单选、复选框和选择）置于您的控制之下。您可能会发现，即使您给它们一个不同的 z-index，IE 也不会悬停在它们上面（正如@grawity 在他的回答中解释的那样）。这就是为什么您通常会看到小部件演示显示在这些元素之上，如下所示：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

解决此问题的典型方法是使用 iframe，但这可能值得提出一个完全不同的问题。

# .net - .NET Framework 4.0 中的类型差异

> ID：932650
> 
> 赞同：6
> 
> 时间：2009-05-31T19:14:10.367
> 
> 标签：.net, generics, types, covariance, contravariance

`IEnumerable<T>`，`IComparable<T>`还有一些现在是类型变体的。`IList<T>`，`ICollection<T>`而许多其他人不是。为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-31T19:16:41.063

.NET Framework 4.0 引入了**安全**协/逆变。`IList<T>`并且`ICollection<T>`have `T`both in input 和 output locations 而`IEnumerable<T>`has `T` *only in output locations*并且`IComparable<T>`has `T` *only in input locations* .

假设`IList<T>`支持的类型变化：

```
static void FailingMethod(IList<object> list) {
    list[0] = 5;
}

static void Test() {
    var a = new List<string>();
    a[0] = "hello";
    FailingMethod(a); // if it was variant, this method call would be unsafe
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T21:28:17.787

另请参阅：[C# 4.0 协方差*不能*做什么](http://marcgravell.blogspot.com/2009/02/what-c-40-covariance-doesn-do.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T19:22:23.783

Anders Hejlseberg 在他的演讲“C# 的未来”中有一个简短但富有启发性的讨论，描述了协变/逆变。他关于协变和逆变的讨论从演讲开始的 50 分 17 秒开始。

[http://channel9.msdn.com/pdc2008/TL16/](http://channel9.msdn.com/pdc2008/TL16/)

# javascript - 如何防止按钮提交表单

> ID：932653
> 
> 赞同：1094
> 
> 时间：2009-05-31T19:16:36.010
> 
> 标签：javascript, html

在接下来的页面中，Firefox 的删除按钮提交表单，但添加按钮不提交。

如何防止`remove`按钮提交表单？

```
function addItem() {
  var v = $('form :hidden:last').attr('name');
  var n = /(.*)input/.exec(v);

  var newPrefix;
  if (n[1].length == 0) {
    newPrefix = '1';
  } else {
    newPrefix = parseInt(n[1]) + 1;
  }

  var oldElem = $('form tr:last');
  var newElem = oldElem.clone(true);
  var lastHidden = $('form :hidden:last');

  lastHidden.val(newPrefix);

  var pat = '=\"' + n[1] + 'input';

  newElem.html(newElem.html().replace(new RegExp(pat, 'g'), '=\"' + newPrefix + 'input'));
  newElem.appendTo('table');
  $('form :hidden:last').val('');
}

function removeItem() {
  var rows = $('form tr');
  if (rows.length > 2) {
    rows[rows.length - 1].html('');
    $('form :hidden:last').val('');
  } else {
    alert('Cannot remove any more rows');
  }
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<html>
<body>
    <form autocomplete="off" method="post" action="">
        <p>Title:<input type="text" /></p>
        <button onclick="addItem(); return false;">Add Item</button>
        <button onclick="removeItem(); return false;">Remove Last Item</button>
        <table>
            <th>Name</th>

            <tr>
                <td><input type="text" id="input1" name="input1" /></td>
                <td><input type="hidden" id="input2" name="input2" /></td>
            </tr>
        </table>
        <input id="submit" type="submit" name="submit" value="Submit">
    </form>
</body>

</html>
```

* * *

## 回答 #1

> 赞同：2231
> 
> 时间：2012-05-31T14:56:42.077

您正在使用 HTML5 按钮元素。请记住，原因是此按钮具有提交的默认行为，如 W3 规范中所述，如下所示： [W3C HTML5 按钮](https://www.w3.org/TR/2011/WD-html5-20110525/the-button-element.html#the-button-element)

所以你需要明确指定它的类型：

```
<button type="button">Button</button> 
```

为了覆盖默认提交类型。我只想指出发生这种情况的原因。

* * *

## 回答 #2

> 赞同：638
> 
> 时间：2009-05-31T19:22:35.593

在按钮上设置类型：

```
<button type="button" onclick="addItem(); return false;">Add Item</button>
<button type="button" onclick="removeItem(); return false;">Remove Last Item</button> 
```

...这将防止他们在事件处理程序中发生异常时触发提交操作。然后，修复您的`removeItem()`函数，使其不会触发异常：

```
function removeItem() {
  var rows = $('form tr');
  if ( rows.length > 2 ) {
    // change: work on filtered jQuery object
    rows.filter(":last").html('');
    $('form :hidden:last').val('');
  } else {
    alert('Cannot remove any more rows');
  }
} 
```

请注意更改：您的原始代码从 jQuery 集合中提取了一个 HTML 元素，然后尝试对其调用 jQuery 方法 - 这引发了异常，导致按钮的默认行为。

FWIW，您可以使用另一种方法...使用 jQuery 连接您的事件处理程序，并使用jQuery[事件对象上的](http://docs.jquery.com/Events/jQuery.Event)[preventDefault()](http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29)方法预先取消默认行为：

```
$(function() // execute once the DOM has loaded
{

  // wire up Add Item button click event
  $("#AddItem").click(function(event)
  {
    event.preventDefault(); // cancel default behavior

    //... rest of add logic
  });

  // wire up Remove Last Item button click event
  $("RemoveLastItem").click(function(event)
  {
    event.preventDefault(); // cancel default behavior

    //... rest of remove last logic
  });

});

...

<button type="button" id="AddItem" name="AddItem">Add Item</button>
<button type="button" id="RemoveLastItem" name="RemoveLastItem">Remove Last Item</button> 
```

这种技术将您的所有逻辑保存在一个地方，使其更易于调试......它还允许您通过`type`将按钮更改回`submit`并处理事件服务器端来实现回退 - 这被称为[不显眼JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-03-21T09:29:03.560

前段时间我需要一些非常相似的东西......我得到了它。

因此，我在这里介绍的是如何使表单能够通过 JavaScript 提交而无需任何验证，并且仅在用户按下按钮（通常是发送按钮）时才执行验证。

对于示例，我将使用一个最小的表单，只有两个字段和一个提交按钮。

记住需要什么：从 JavaScript 必须能够在没有任何检查的情况下提交。但是，如果用户按下这样的按钮，则必须完成验证，并且只有通过验证才能发送表单。

通常一切都会从这个附近的东西开始（我删除了所有不重要的额外内容）：

```
<form method="post" id="theFormID" name="theFormID" action="">
   <input type="text" id="Field1" name="Field1" />
   <input type="text" id="Field2" name="Field2" />
   <input type="submit" value="Send" onclick="JavaScript:return Validator();" />
</form> 
```

看看表单标签是如何没有`onsubmit="..."`的（记住它是没有它的条件）。

问题是表单总是被提交，无论是`onclick`返回`true`还是`false`.

如果我更改`type="submit"`为`type="button"`，它似乎工作但没有。它从不发送表单，但这很容易完成。

所以最后我用了这个：

```
<form method="post" id="theFormID" name="theFormID" action="">
   <input type="text" id="Field1" name="Field1" />
   <input type="text" id="Field2" name="Field2" />
   <input type="button" value="Send" onclick="JavaScript:return Validator();" />
</form> 
```

在`function Validator`, where `return True;`is 上，我还添加了一个 JavaScript 提交语句，类似于以下内容：

```
function Validator(){
   //  ...bla bla bla... the checks
   if(                              ){
      document.getElementById('theFormID').submit();
      return(true);
   }else{
      return(false);
   }
} 
```

`id=""`仅适用于 JavaScript ，仅适用`getElementById`于`name=""`它出现在 POST 数据中。

以这种方式，它可以按我的需要工作。

我只为那些不需要`onsubmit`表单上的功能，但在用户按下按钮时进行一些验证的人。

为什么我不需要在表单标签上提交？很简单，在其他 JavaScript 部分我需要执行提交，但我不希望有任何验证。

原因：如果用户是执行我想要的提交并且需要完成验证的用户，但如果是 JavaScript，有时我需要执行提交，而这样的验证会避免它。

这听起来可能很奇怪，但在思考时却不是这样：在登录时……有一些限制……比如不允许使用 PHP 会话，也不允许使用 cookie！

所以任何链接都必须转换成这样的表单提交，这样登录数据才不会丢失。当尚未完成登录时，它也必须工作。因此，不必对链接执行验证。但是，如果用户没有输入用户和通行证这两个字段，我想向用户显示一条消息。因此，如果缺少一个，则不得发送该表格！有问题。

看到问题：只有当用户按下按钮时，一个字段为空时才不能发送表单，如果它是 JavaScript 代码，则必须能够发送。

如果我`onsubmit`对表单标签进行处理，我需要知道它是用户还是其他 JavaScript。由于不能传参数，所以不能直接传，所以有人加了一个变量来判断是否必须做验证。验证功能的第一件事是检查变量值等......太复杂了，代码并没有说明真正想要什么。

所以解决方案是不要在表单标签上设置 onsubmit。Insead 把它放在了真正需要的地方，就在按钮上。

另一方面，为什么要放置 onsubmit 代码，因为从概念上讲我不想要 onsubmit 验证。我真的想要按钮验证。

不仅代码更清晰，而且它必须在哪里。请记住这一点： - 我不希望 JavaScript 验证表单（必须始终由服务器端的 PHP 完成） - 我想向用户显示一条消息，告诉所有字段不能为空，需要 JavaScript（客户端边）

那么为什么有些人（想或告诉我）必须在现场验证上完成？不，从概念上讲，我没有在客户端进行 onsumbit 验证。我只是在按下按钮上做某事，那么为什么不让它实现呢？

好吧，代码和样式完美地解决了问题。在我需要发送我刚刚输入的表单的任何 JavaScript 上：

```
document.getElementById('theFormID').action='./GoToThisPage.php'; // Where to go
document.getElementById('theFormID').submit(); // Send POST data and go there 
```

当我不需要它时，它会跳过验证。它只是发送表单并加载不同的页面等。

但是，如果用户单击提交按钮（也称为`type="button"`not `type="submit"`），则在提交表单之前完成验证，如果无效则不发送。

希望这可以帮助其他人不要尝试冗长而复杂的代码。`onsubmit`如果不需要，请不要使用，然后使用`onclick`. 但是请记住更改`type="submit"`为`type="button"`并且请不要忘记`submit()`通过 JavaScript 进行操作。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2009-05-31T19:28:30.870

我同意 Shog9，但我可能会改用：

```
<input type = "button" onClick="addItem(); return false;" value="Add Item" /> 
```

[根据 w3schools](http://www.w3schools.com/TAGS/tag_button.asp)，`<button>`标签在不同的浏览器上有不同的行为。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2018-05-26T06:30:17.667

您可以使用 jQuery 简单地获取按钮的引用，并防止其传播，如下所示：

```
 $(document).ready(function () {
    $('#BUTTON_ID').click(function(e) {

            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();

            return false;
    });}); 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2012-06-27T15:39:30.033

`$("form").submit(function () { return false; });` 这将阻止按钮提交，或者您可以将按钮类型更改为“按钮” `<input type="button"/>`，而不是`<input type="submit"/>` 仅当此按钮不是此表单中的唯一按钮时才有效。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2015-06-24T16:46:18.620

假设您的 HTML 表单有`id="form_id"`

```
<form id="form_id">
<!--your HTML code-->
</form> 
```

将此 jQuery 片段添加到您的代码中以查看结果，

```
$("#form_id").submit(function(){
  return false;
}); 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2014-01-17T01:27:17.713

这是一个 html5 错误，就像已经说过的那样，您仍然可以将按钮作为提交（如果您想同时涵盖 javascript 和非 javascript 用户）使用它，例如：

```
 <button type="submit" onclick="return false"> Register </button> 
```

这样，您将取消提交，但仍然执行您在 jquery 或 javascript 函数中所做的任何事情，并为没有 javascript 的用户执行提交。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2021-01-12T14:21:18.967

像`<button>Click to do something</button>`提交按钮这样的按钮。

您必须添加`type`

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2019-04-15T12:13:34.907

return false 防止默认行为。但 return false 打破了额外点击事件的冒泡。这意味着如果在调用此函数后还有任何其他点击绑定，则其他的不考虑。

```
 <button id="btnSubmit" type="button">PostData</button>
 <Script> $("#btnSubmit").click(function(){
   // do stuff
   return false;
}); </Script> 
```

或者简单地说你可以这样放

```
 <button type="submit" onclick="return false"> PostData</button> 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2019-07-31T11:28:51.857

只需添加`e.preventDefault();`您的方法即可阻止您的页面提交表单。

```
function myFunc(e){
       e.preventDefault();
} 
```

根据[MDN 网络文档](https://developer.mozilla.org/fr/docs/Web/API/Event/preventDefault)

> Event 接口的 preventDefault () 方法告诉用户代理，如果事件没有被显式处理，那么它的默认操作不应该像通常那样被考虑在内。事件继续像往常一样传播，除非它的一个侦听器调用`stopPropagation ()`或`stopImmediatePropagation ()`，其中任何一个都会终止传播。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-05-31T19:24:12.377

我确信在 FF

```
removeItem 
```

函数遇到 JavaScript 错误，这在 IE 上没有发生

当出现 javascript 错误时，“return false”代码将无法运行，从而使页面回发

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2018-04-09T20:03:48.260

> 以正常方式设置按钮并使用 event.preventDefault like..

```
 <button onclick="myFunc(e)"> Remove </button>  
   ...
   ...

   In function...

   function myFunc(e){
       e.preventDefault();
   } 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2014-03-04T12:30:14.497

```
return false; 
```

您可以在函数结束时或函数调用后返回 false。

只要它是最后发生的事情，表单就不会提交。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-01-07T03:19:32.503

这是一个简单的方法：

```
$('.mybutton').click(function(){

    /* Perform some button action ... */
    alert("I don't like it when you press my button!");

    /* Then, the most important part ... */
    return false;

}); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-31T19:39:50.940

我现在无法对此进行测试，但我认为您可以使用 jQuery 的[preventDefault](http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29)方法。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-02-15T07:39:29.613

以下示例代码向您展示了如何防止按钮单击提交表单。

你可以试试我的示例代码：

```
 <form autocomplete="off" method="post" action="">
   <p>Title:
     <input type="text" />
   </p>
   <input type="button" onclick="addItem()" value="Add Item">
   <input type="button" onclick="removeItem()" value="Remove Last Item">
   <table>
     <th>Name</th>

     <tr>
       <td>
         <input type="text" id="input1" name="input1" />
       </td>
       <td>
         <input type="hidden" id="input2" name="input2" />
       </td>
     </tr>
   </table>
   <input id="submit" type="submit" name="submit" value="Submit">
 </form>
<script language="javascript">
function addItem() {
return false;
}

function removeItem() {
return false;
}
</script> 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-31T19:39:15.653

函数 removeItem 实际上包含一个错误，这使得表单按钮执行其默认行为（提交表单）。在这种情况下，javascript 错误控制台通常会给出一个指针。

查看 javascript 部分中的函数 removeItem ：

该行：

```
rows[rows.length-1].html(''); 
```

不起作用。试试这个：

```
rows.eq(rows.length-1).html(''); 
```

# html - 为什么只有部分系统字体在我的 HTML 中有效？

> ID：932663
> 
> 赞同：3
> 
> 时间：2009-05-31T19:24:14.887
> 
> 标签：html, fonts, typekit

我在进行开发的机器上安装了 Din Engshrift 和其他晦涩的字体。但是当我尝试从 HTML 访问它们时，它们看起来完全扭曲了。像“Courier New”这样的字体可以正常工作。是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T20:02:01.363

DIN Engschrift 提供 OTF、PS 和 FF 格式，适用于 Mac 和 PC。您使用的浏览器可能不完全支持您安装的字体格式。尝试添加其他格式，或尝试其他浏览器。

[http://new.myfonts.com/fonts/urw/engschrift/](http://new.myfonts.com/fonts/urw/engschrift/)

我假设您已经意识到，您使用不寻常的 font5s 制作的任何 HTML 页面在缺少这些字体的机器上都不会呈现相同的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T20:13:19.327

使用除标准字体之外的任何东西可能只是最近才使用：h [ttp://www.tudy.ro/2008/09/02/embedded-web-fonts-are-back/](http://www.tudy.ro/2008/09/02/embedded-web-fonts-are-back/)。

不过，它不适用于所有浏览器。

**更新**：

这也可能很有趣：[Typekit](http://blog.typekit.com/2009/05/27/introducing-typekit/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T21:30:09.313

支持的字体取决于浏览器，尽管我 Mac 上的 Firefox 显然允许我使用计算机上可用的任何字体。但是，由于我是一名 Web 开发人员，因此我希望拥有不同操作系统的人能够看到我的网站，因此我只使用“Windows/Mac Web 安全”的字体（Mac OS X 有助于将这些字体列为 Font Book 中的一个集合)

这并不多，但世界并不理想。

CSS Fonts 模块可以告诉浏览器加载您想要的字体（@font 命令），但实际支持不是很好。

# jquery - 让所有子元素触发 jQuery mouseout 事件

> ID：932665
> 
> 赞同：1
> 
> 时间：2009-05-31T19:25:16.443
> 
> 标签：jquery, events, mouseout, propagation

我在 Div 中有一个包含 8 个图像的表格，我想为表格或 div 触发 mouseout 事件，但它不会触发。我猜这是因为鼠标实际上离开了每个图像，或 td，或 tr 等......有没有办法让整个表的 mouseout 事件传播起来，以便它甚至被触发从子元素？标记很简单：

```
<div id=container>
  <table id="tbl">
    <tr>
      <td><img src=""></td>
      <td><img src=""></td>
      <td><img src=""></td>
      <td><img src=""></td>
    </tr>
    <tr>
      <td><img src=""></td>
      <td><img src=""></td>
      <td><img src=""></td>
      <td><img src=""></td>
    </tr>
  </table>
</div> 
```

我的jQuery代码是：

```
$("#tbl").mouseout(function(){
  alert("out home");
}); 
```

我无法为图像触发单独的 mouseout 事件，因为有时它们上方绝对放置了元素，这会导致 mouseout 事件过早触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T19:28:08.077

应该：

```
$("#tbl").mouseout(function(){
  alert("out home");
}); 
```

您错过了“#”。如果您只想要图像，请尝试：

```
$("#tbl >img").mouseout(function(){
  alert("out home");
}); 
```

PS。您是否考虑过使用 $("...").hover() 来代替？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T19:29:19.353

您不应该使用#tbl 来选择表格吗？

```
$("#tbl").mouseout(function(){
  alert("out home");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-05T12:16:47.853

使用`mouseleave`事件，它具有完全相同的功能，但不会与子元素一起触发。

```
$("#tbl").bind("mouseleave",function(){
  alert("out home");
}); 
```

# objective-c - 使用 NXXMLParser 在 XML 文档（UTF-8 编码）中出现单词“Nestlé”的问题。任何想法？

> ID：932666
> 
> 赞同：0
> 
> 时间：2009-05-31T19:25:23.870
> 
> 标签：objective-c, xml, parsing, encoding, nsxmlparser

我们在 Objective-C 中使用 NSXMLParser 来解析我们的 XML 文档，这些文档都是 UTF-8 编码的。一个文档中有一个字符串“Nestlé”（如 中`...<title>Nestlé Novelties</title>...`）。解析器刚刚退出，报告错误代码=9，由于“雀巢”一词末尾的法语字母“e”。此外，我们尝试使用 IE、Chrome、Safari 直接显示相同的文档。他们报告了类似的编码错误。

我们对所有传入的 XML 文档使用 UTF-8，这意味着它们都以“ `<?xml version="1.0" encoding="UTF-8" ?>`”作为文档的顶部。

这是编码问题吗？如果是这样，我们如何解决这个问题？我们应该为所有的 XML 文档使用什么编码？提前致谢！

巴克莱

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T20:05:10.280

您是否使用十六进制编辑器检查了文件以验证“é”确实是 UTF-8 `0xC3` `0xA9`，？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T20:08:31.273

在 HTML 中，我会使用`Nestl&eacute;`这适用于您的应用程序吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-01T16:18:46.013

我刚才在一个示例 XML 文件中看到的是，一个包含用户定义输入（恰好包含 é 字符）的字符串将包含标签的内容包装在 CDATA 声明中。这具有使解析器完全忽略其中包含的字符的效果。

# asp.net - 自动将视频格式转换为 Flash 视频

> ID：932667
> 
> 赞同：6
> 
> 时间：2009-05-31T19:25:30.047
> 
> 标签：asp.net, flash, video

我需要允许网站用户以各种常见格式将视频上传到我的网站。从这些我需要将它们转换为 Flash 视频，并限制它们的长度和大小。作为网站处理的一部分，我需要自动执行此操作。

有没有一些简单的工具可以让我做到这一点？如果没有，您能否指出一个可能对我有帮助的方向。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T21:02:06.467

使用[ffmpeg](http://ffmpeg.org/)，您可以运行以下命令将 input.avi 转换为用于 flash 的 output.flv：

```
ffmpeg -y -i input.avi -acodec mp3 -f flv output.flv 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T19:34:27.940

[ffmpeg](http://ffmpeg.org)或[mencoder](http://www.mplayerhq.hu)通常用于这种事情。

当您使用 asp.net 时，您确实应该与 DLL 进行交互。还有一个可用于 ffmpeg的[c# 包装器。](http://sourceforge.net/projects/sharpffmpeg/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-01T11:25:57.113

我使用 ffmpeg，它在我的视频中效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-22T10:43:49.687

我最近也遇到了这个问题，我不想走在服务器上实现视频转换后端的路线。

最后，似乎一个合理的折衷方案是使用由其中一个在线服务提供的视频转换服务 - 类似于[run 的 API 上的位](http://www.bitsontherun.com/system-apis/)，虽然它是一项付费服务​​，但它似乎足够直截了当实现为 Web 服务。

但是，如果这个额外的成本是不可接受的，那么在 PHP 世界中，我会尝试使用类似[ffmpeg-php 的](http://ffmpeg-php.sourceforge.net/)东西。我想在 asp.net 世界中也必须有一个等价物，但请记住，视频转换可能需要很长时间，如果您正在等待请求完成，或面临执行超时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-20T08:22:40.757

我认为您需要像 Adob​​e Flash Media Server 这样的服务器端软件。它可以在您的服务器上自动将视频转换为 flv。

# smtp - 一个好的、免费的、简单的、非“试用”的本地 SMTP 服务器用于开发？

> ID：932679
> 
> 赞同：20
> 
> 时间：2009-05-31T19:30:27.713
> 
> 标签：smtp

我在我的开发机器上运行 Windows Vista... 到目前为止尝试了四台 SMTP 服务器（2 台崩溃，2 台在被提升为“免费”后被证明是试用件）。所以我没有可用的 IIS6 SMTP。

您知道我可以使用的任何简单、无忧的 SMTP 服务器吗？我绝对不需要花里胡哨。它需要做的就是监听 25 端口并发送电子邮件。

帮助？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T19:36:13.270

试用[Mercury 邮件](http://www.pmail.com/overviews/ovw_mercwin.htm)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-29T08:43:47.117

[Free SMTP Server](http://www.softstack.com/freesmtp.html)是一个简单而小型的 SMTP 服务器。它总是将电子邮件转发给recipents。就这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T19:34:24.430

查看[Lamson](http://lamsonproject.org/)，一个 Python 中的 SMTP 服务器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T19:35:18.407

你很难比[pysmtp更自由或更简单](http://www.hare.demon.co.uk/pysmtp.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T19:34:07.847

在虚拟 ubuntu 机器上安装 sendmail 并通过它发送电子邮件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T19:35:49.153

在 Windows XP 中，“添加/删除 Windows 组件”下的 IIS 类别中有一个“SMTP 服务”——不确定 Vista 是否也有。

# drag-and-drop - 将 Mootools 元素拖动转换为原型

> ID：932680
> 
> 赞同：0
> 
> 时间：2009-05-31T19:30:34.890
> 
> 标签：drag-and-drop, mootools, prototypejs

我目前使用下面的代码能够在 div 容器内拖动一个元素（这很重要，它不能只是在页面上的任何地方拖动）。我使用 mootools 来完成此操作，但我将所有内容都转换为使用原型，但我无法弄清楚如何让它与原型一起使用。

```
 window.addEvent('domready', function(){
        var container = $('containment');
        new Drag.Move('dragger1', {'container': container});
    }); 
```

*更新：* 我发现我可以使用 script.aculo.us 进行拖动，但无论如何我看不到将移动限制在定义的空间或 div 元素内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-02T05:23:46.923

我不知道你可以用 Prototype/Scriptaculous 限制可拖动区域。

您可以限制放置目标，使其只能放置在特定位置，但我不知道有一种方法可以强制它保持在某个边界内。

如果你能确定收容元素的位置，你可能会写一些东西，但这可能比你想的要麻烦。:)

# mysql - Rails 中消息系统的棘手 MySQL 查询 - 请帮助

> ID：932683
> 
> 赞同：1
> 
> 时间：2009-05-31T19:32:31.687
> 
> 标签：mysql, ruby-on-rails, group-by

我正在为 Rails 应用程序编写一个 facebook 风格的消息系统，但在选择收件箱的消息时遇到了问题（使用 will_paginate）。

消息以线程的形式组织，在收件箱中，线程的最新消息将显示，并带有指向该线程的链接。线程是通过与自身的 parent_id 1-n 关系组织的。

到目前为止，我正在使用这样的东西：

```
class Message < ActiveRecord::Base
  belongs_to :sender, :class_name => 'User', :foreign_key => "sender_id"
  belongs_to :recipient, :class_name => 'User', :foreign_key => "recipient_id"
  has_many :children, :class_name => "Message", :foreign_key => "parent_id"
  belongs_to :thread, :class_name => "Message", :foreign_key => "parent_id"
end

class MessagesController < ApplicationController

  def inbox
    @messages = current_user.received_messages.paginate :page => params[:page], :per_page => 10, :order => "created_at DESC"
  end
end 
```

这给了我所有的消息，但是对于一个线程，线程本身和最新消息将出现（而不仅仅是最新消息）。我也不能使用 GROUP BY 子句，因为对于线程本身（可以说是父级），parent_id = nil 当然。

任何人都知道如何以优雅的方式解决这个问题？我已经考虑过将 parent_id 添加到父级本身，然后按 parent_id 分组，但我不确定这是否有效。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T19:44:39.167

我的解决方案是获取线程列表（我假设可以通过没有父 ID 的消息获得）。然后在 Message 模型上，添加一个方法，该方法将在线程中查找最新消息并返回它。然后，您可以使用该方法获取每个线程中的最新方法，并轻松放入指向线程头部的链接。

（伪）代码：

```
class Message < ActiveRecord::Base
  belongs_to :sender, :class_name => 'User', :foreign_key => "sender_id"
  belongs_to :recipient, :class_name => 'User', :foreign_key => "recipient_id"
  has_many :children, :class_name => "Message", :foreign_key => "parent_id"
  belongs_to :thread, :class_name => "Message", :foreign_key => "parent_id"

  def get_last_message_in_thread()
    last_message = self
    children.each do |c|
       message = c.get_last_message_in_thread()
       last_message = message if message.created_at > last_message.created_at
    end
    return last_message
  end
end

class MessagesController < ApplicationController

  def inbox
    @messages = current_user.received_messages.find_by_parent_id(Null).paginate :page => params[:page], :per_page => 10, :order => "created_at DESC"
  end
end 
```

与使用递归函数查找线程中的最后一条消息相比，您可能做得更好，但这是我能想到的最简单的解决方案来演示这个想法。我也不确定在收件箱函数中查找未设置的父 ID 的语法是否正确，这就是我将代码标记为伪代码的原因:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T20:11:56.477

唯一有效的方法是拥有一个 Thread 模型并使用 GROUP BY 正如您所提到的 - 其他任何事情都需要对消息进行迭代。

**阅读评论中的更新**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T20:19:20.347

将父级本身作为父级可以很容易地创建在整个线程上运行的查询，因为您可以按 parent_id 分组（或任何类似的）。

如果您以不同的方式处理父母，那么您的所有查询也必须考虑到这一点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-20T01:09:23.990

我不知道如何在 Rails 中做到这一点，但这是我直接在 MySQL 中做到的：

select * from messages where message_id in ( select max(message_id) from messages where to_uid = 51 group by thread_id ) order by timestamp desc

我使用子查询来获取线程中的最新消息，然后使用主查询来获取子查询中找到的消息的所有字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T08:57:42.930

我认为唯一好的解决方案是使用第二个模型来存储每个线程的最新消息（因为将 GROUP BY 与子选择一起使用时的性能问题，请参阅我的评论）。它不会在数据库中占用太多空间，因为我们只存储 id 而没有文本甚至 blob。

最近消息模型看起来像这样：

```
create_table :recent_messages do |t|
  t.integer :sender_id
  t.integer :recipient_id
  t.integer :message_id
  t.integer :message_thread_id

  t.timestamps
end

class RecentMessage < ActiveRecord::Base

  belongs_to :message
  belongs_to :message_thread, :class_name => 'Message'
  belongs_to :sender, :class_name => 'User', :foreign_key => "sender_id"
  belongs_to :recipient, :class_name => 'User', :foreign_key => "recipient_id"

end 
```

主要思想是：所有的消息都存储在一个模型（Messages）中。每当向线程添加新消息（或创建线程）时，都会发生两件事（例如，使用 after_save 回调）：

*   将新消息存储在 RecentMessages 模型中（即 sender_id、receiver_id、message_id、message_thread_id (= parent_id || id)）
*   获取最新消息（来自消息中的这个线程），其中 sender_id == recipient_id 反之亦然（注意：这仅适用于消息模型应仅支持 2 个用户之间的消息）并将其存储在 RecentMessages 模型中（如果找到，如果它还没有）

当然应该只有最大值。在任何给定时间，为每个 message_thread 存储在数据库中的 2 个最近消息。

如果要显示收件箱，则必须执行以下操作：

```
@messages = current_user.recent_received_messages.paginate :page => params[:page], :per_page => 10, :order => "created_at DESC", :include => :message 
```

这是迄今为止我想出的最好的。我仍然认为它很丑，但它很快而且有效。如果有人提出更好的解决方案，我将不胜感激！

# .net - WCF:: ServiceHost: Oddity...即使线程死了还活着吗？

> ID：932690
> 
> 赞同：3
> 
> 时间：2009-05-31T19:35:03.540
> 
> 标签：.net, wcf, multithreading, servicehost

这里有一个新成员。很高兴看到这样一个整洁的社区。

经过一番研究，我决定在我的应用程序中使用 WCF 进行进程间通信，因此我使用了 NetNamedPipeBinding 绑定。

ServiceHost 托管应用程序不是专用服务器，因此它必须通过线程生成 ServiceHost。到现在为止还挺好。

所以我有以下内容：

```
Foo()
{
    Thread serverThread = new Thread(new ThreadStart(ServerThread));
    serverThread.Start();
    Console.WriteLine("Foo Exited");
}

ServerThread()
{
   Uri baseAddress = new Uri("net.pipe://localhost/service");
   ServiceHost serviceHost = new ServiceHost(typeof(MyService), baseAddress);
   ...
   serviceHost.Open();
   Console.WriteLine("Server Thread Exited");
} 
```

正如预期的那样，我看到：

```
->   Server Thread Exited
->   Foo Exited 
```

但令我惊讶的是，即使服务器运行的线程已经兴奋，客户端仍然可以连接到 serviceHost 并且服务主机正确处理请求！

那么为什么 ServiceHost 仍然在处理和处理请求，即使它的主线程（它创建的那个）已经死了？

还有一种更好的方法可以让 ServerThread 保持活动状态一段时间（true）{Thread. 睡眠（100）；}？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-31T19:55:18.583

当您在 ServiceHost 上调用 Open 时，将创建一个额外的线程来侦听传入的服务请求。这样，您的线程可能已经完成运行，但已创建另一个线程，并将继续运行，直到您在 ServiceHost 上调用“关闭”。

在您的情况下，您可能不需要自己生成线程。只需在应用程序的主线程中打开您的 ServiceHost。然后你可以在你的主线程中做其他事情，当你准备好杀死主机时，只需调用 serviceHost.Close()。

这是我发现的一个很好的描述：

[http://www.code-magazine.com/article.aspx?quickid=0701041&page=1](http://www.code-magazine.com/article.aspx?quickid=0701041&page=1)

# c# - 直接调用委托、使用 DynamicInvoke 和使用 DynamicInvokeImpl 有什么区别？

> ID：932699
> 
> 赞同：27
> 
> 时间：2009-05-31T19:40:09.473
> 
> 标签：c#, delegates

DynamicInvoke 和 DynamicInvokeImpl 的文档说：

> 动态调用（后期绑定）当前委托所代表的方法。

我注意到 DynamicInvoke 和 DynamicInvokeImpl 采用对象数组而不是特定的参数列表（这是我猜测的后期绑定部分）。但这是唯一的区别吗？DynamicInvoke和DynamicInvokeImpl有什么区别。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-31T21:04:28.740

`Invoke(...)`直接调用它（它是 的简写）和使用它的主要区别在于`DynamicInvoke`性能；根据我的测量，超过 *700 的系数（下）。

使用直接/`Invoke`方法，参数已经通过方法签名进行了预先验证，并且代码已经存在以直接将它们传递到方法中（我会说“作为 IL”，但我似乎记得运行时直接提供了这个,*没有*任何 IL)。它需要通过`DynamicInvoke`反射从数组中检查它们（即它们是否都适合此调用；它们是否需要拆箱等）；这很**慢**（如果您在紧密循环中使用它），应尽可能避免。

例子; 首先是结果（我增加了`LOOP`上一次编辑的计数，以便进行合理的比较）：

```
Direct: 53ms
Invoke: 53ms
DynamicInvoke (re-use args): 37728ms
DynamicInvoke (per-cal args): 39911ms 
```

带代码：

```
static void DoesNothing(int a, string b, float? c) { }
static void Main() {
    Action<int, string, float?> method = DoesNothing;

    int a = 23;
    string b = "abc";
    float? c = null;
    const int LOOP = 5000000;

    Stopwatch watch = Stopwatch.StartNew();
    for (int i = 0; i < LOOP; i++) {
        method(a, b, c);
    }
    watch.Stop();
    Console.WriteLine("Direct: " + watch.ElapsedMilliseconds + "ms");

    watch = Stopwatch.StartNew();
    for (int i = 0; i < LOOP; i++) {
        method.Invoke(a, b, c);
    }
    watch.Stop();
    Console.WriteLine("Invoke: " + watch.ElapsedMilliseconds + "ms");

    object[] args = new object[] { a, b, c };
    watch = Stopwatch.StartNew();
    for (int i = 0; i < LOOP; i++) {
        method.DynamicInvoke(args);
    }
    watch.Stop();
    Console.WriteLine("DynamicInvoke (re-use args): "
         + watch.ElapsedMilliseconds + "ms");

    watch = Stopwatch.StartNew();
    for (int i = 0; i < LOOP; i++) {
        method.DynamicInvoke(a,b,c);
    }
    watch.Stop();
    Console.WriteLine("DynamicInvoke (per-cal args): "
         + watch.ElapsedMilliseconds + "ms");
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-09-30T14:15:38.660

巧合的是，我发现了另一个不同之处。

如果`Invoke`抛出异常，它可以被预期的异常类型捕获。然而`DynamicInvoke`抛出一个`TargetInvokationException`. 这是一个小演示：

```
using System;
using System.Collections.Generic;

namespace DynamicInvokeVsInvoke
{
   public class StrategiesProvider
   {
      private readonly Dictionary<StrategyTypes, Action> strategies;

      public StrategiesProvider()
      {
         strategies = new Dictionary<StrategyTypes, Action>
                      {
                         {StrategyTypes.NoWay, () => { throw new NotSupportedException(); }}
                         // more strategies...
                      };
      }

      public void CallStrategyWithDynamicInvoke(StrategyTypes strategyType)
      {
         strategies[strategyType].DynamicInvoke();
      }

      public void CallStrategyWithInvoke(StrategyTypes strategyType)
      {
         strategies[strategyType].Invoke();
      }
   }

   public enum StrategyTypes
   {
      NoWay = 0,
      ThisWay,
      ThatWay
   }
} 
```

* * *

当第二个测试变为绿色时，第一个测试面临 TargetInvokationException。

```
using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using SharpTestsEx;

namespace DynamicInvokeVsInvoke.Tests
{
   [TestClass]
   public class DynamicInvokeVsInvokeTests
   {
      [TestMethod]
      public void Call_strategy_with_dynamic_invoke_can_be_catched()
      {
         bool catched = false;
         try
         {
            new StrategiesProvider().CallStrategyWithDynamicInvoke(StrategyTypes.NoWay);
         }
         catch(NotSupportedException exc)
         {
            /* Fails because the NotSupportedException is wrapped
             * inside a TargetInvokationException! */
            catched = true;
         }
         catched.Should().Be(true);
      }

      [TestMethod]
      public void Call_strategy_with_invoke_can_be_catched()
      {
         bool catched = false;
         try
         {
            new StrategiesProvider().CallStrategyWithInvoke(StrategyTypes.NoWay);
         }
         catch(NotSupportedException exc)
         {
            catched = true;
         }
         catched.Should().Be(true);
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-31T19:47:38.863

两者之间确实没有功能差异。如果您在反射器中提取实现，您会注意到 DynamicInvoke 只是使用相同的参数集调用 DynamicInvokeImpl。没有进行额外的验证，它是一个非虚拟方法，所以它的行为不可能被派生类改变。DynamicInvokeImpl 是一个虚拟方法，所有实际工作都在其中完成。

# scala - Scala：两种方法，不同的参数类型但相同的代码：如何统一？

> ID：932701
> 
> 赞同：4
> 
> 时间：2009-05-31T19:41:43.667
> 
> 标签：scala

我有以下课程：

```
case class Vec2(x: Int, y: Int) { def +(other: Vec2) = Vec2(x + other.x, y + other.y) }
case class Vec3(x: Int, y: Int, z: Int) { def +(other: Vec3) = Vec3(x + other.x, y + other.y, z + other.z) } 
```

以及以下方法：

```
def doStuff1(a: Vec2, b: Vec2) = (a, a + b)
def doStuff2(b: Vec3, b: Vec3) = (a, a + b) 
```

我的问题：如何以类型安全的方式将这两个函数合并为一个通用函数？可以以任何方式更改类。

就像是

```
def doStuff[V](a: V, b: V) = (a, a + b) 
```

显然不会工作，因为调用了“+”方法。我已经尝试了各种疯狂的东西（具有抽象类型的通用基类、显式类型的自引用、差异......）但无法提出解决方案。

我能想出的最好办法是运行时检查（模式匹配或 isInstanceOf/asInstanceOf），但这不满足类型安全要求。我只是认为/希望必须有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-31T19:55:03.030

```
trait Vector[V <: Vector[V]] { this: V =>
  def +(other: V): V
}

case class Vec2(x: Int, y: Int) extends Vector[Vec2] {
  override def +(other: Vec2): Vec2 = Vec2(x + other.x, y + other.y)
}

case class Vec3(x: Int, y: Int, z: Int) extends Vector[Vec3] {
  override def +(other: Vec3): Vec3 = Vec3(x + other.x, y + other.y, z + other.z)
}

def doStuff[V <: Vector[V]](a: V, b: V): (V, V) = (a, a + b) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T06:40:35.943

您可以尝试某种[Structural Type](http://docs.scala-lang.org/style/types.html#structural_types)。像这样：

```
def doStuff[V <: {def +(other: V): V }](a: V, b: V) = (a, a + b) 
```

# c# - C# MDI 事件帮助

> ID：932704
> 
> 赞同：0
> 
> 时间：2009-05-31T19:44:16.577
> 
> 标签：c#, events, mdi

我有一个表格，它是一个 MDI 容器。在该表单中，我生成 6 个子表单，每个子表单都有一个标签：

```
for (int i = 0; i < 6; i++)
{
    Form window = new Form();
    window.Width = 100;
    window.Height = 100;

    window.MdiParent = this;
    window.FormBorderStyle = FormBorderStyle.FixedToolWindow;

    Label label = new Label();
    label.AutoSize = true;
    label.Location = new System.Drawing.Point(1, 1);
    label.Size = new System.Drawing.Size(35, 13);
    label.TabIndex = 1;
    label.Name = "label" + i.ToString();
    label.Text = window.Top.ToString();

    window.LocationChanged += new System.EventHandler(HERE);

    window.Controls.Add(label);
    window.Show();              
} 
```

我在 locationchanged for window 上添加了一个事件。现在怎么做才能使标签更新到窗口位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T19:50:55.003

我认为这条线会为你解决问题：

```
window.LocationChanged += new EventHandler(delegate(object o, EventArgs evtArgs) { 
    label.Text = window.Location.ToString(); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T19:50:58.360

好吧，使用 lambda 表达式或匿名方法最简单：

```
window.LocationChanged += (sender, args) => label.Text = window.Top.ToString(); 
```

如果您使用的是 C# 1.1，则需要有点棘手，因为在 C# 2+ 中会自动捕获标签 - 您必须像这样创建一个新类：

```
internal class LocationChangeNotifier
{
    private readonly Label label;

    internal LocationChangeNotifier(Label label)
    {
        this.label = label;
    }

    internal void HandleLocationUpdate(object sender, EventArgs e)
    {
        label.Text = ((Control) sender).Top.ToString();
    }
} 
```

然后将其用作：

```
LocationChangeNotifier notifier = new LocationChangeNotifier(label);
window.LocationChanged += new EventHandler(notifier.HandleLocationUpdate); 
```

捕获的变量不是很好吗？:)

# c++ - 如何以编程方式缓慢移动窗口，就好像用户正在这样做一样？

> ID：932706
> 
> 赞同：2
> 
> 时间：2009-05-31T19:45:28.293
> 
> 标签：c++, c, winapi

我知道 MoveWindow() 和 SetWindowPos() 函数。我知道如何正确使用它们。但是，我想要完成的是缓慢而平稳地移动窗口，就好像用户正在拖动它一样。

我还没有让它正常工作。我尝试使用 GetWindowRect() 获取当前坐标，然后使用 setwindow 和 movewindow 函数，每次调用将 Right 递增 10 个像素。

有任何想法吗？

这是我所有定义之外的内容。

```
while(1)
{
     GetWindowRect(notepad,&window);

     Sleep(1000);
     SetWindowPos(
        notepad,
        HWND_TOPMOST,
        window.top - 10,
        window.right,
        400,
        400,
        TRUE
        );
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T20:04:09.347

如果您想要流畅的动画，则需要使其基于时间，并允许 Windows 在动作之间处理消息。[设置一个计时器](http://msdn.microsoft.com/en-us/library/ms644906.aspx)，并根据动画开始后的[经过时间](http://msdn.microsoft.com/en-us/library/ms724408.aspx)将窗口移动一段距离来响应[WM_TIMER 通知。](http://msdn.microsoft.com/en-us/library/ms644902.aspx)对于看起来自然的运动，不要使用线性函数来确定距离 - 而是尝试类似[Robert Harvey](https://stackoverflow.com/questions/932706/how-to-programmatically-move-a-window-slowly-as-if-the-user-were-doing-it/932738#932738)建议的函数。

伪代码：

```
//
// animate as a function of time - could use something else, but time is nice.
lengthInMS = 10*1000; // ten second animation length
StartAnimation(desiredPos)
{
   originalPos = GetWindowPos();
   startTime = GetTickCount();
   // omitted: hwnd, ID - you'll call SetTimer differently 
   // based on whether or not you have a window of your own
   timerID = SetTimer(30, callback); 
}

callback()
{
   elapsed = GetTickCount()-startTime;
   if ( elapsed >= lengthInMS )
   {
      // done - move to destination and stop animation timer.
      MoveWindow(desiredPos);
      KillTimer(timerID);
   }

   // convert elapsed time into a value between 0 and 1
   pos = elapsed / lengthInMS; 

   // use Harvey's function to provide smooth movement between original 
   // and desired position
   newPos.x = originalPos.x*(1-SmoothMoveELX(pos)) 
                  + desiredPos.x*SmoothMoveELX(pos);
   newPos.y = originalPos.y*(1-SmoothMoveELX(pos)) 
                  + desiredPos.y*SmoothMoveELX(pos);       
   MoveWindow(newPos);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T20:12:37.410

我发现这段代码应该做你想做的事。它在 c# 中，但你应该能够适应它：

使用小增量（.03？）在 0 和 1 之间增加一个变量（让我们称之为“inc”并使其成为全局变量）并使用下面的函数来提供平滑的运动。

数学是这样的：

currentx=x1*(1-smoothmmoveELX(inc)) + x2*smoothmmoveELX(inc)

当前y=y1*(1-smoothmmoveELX(inc)) + y2*smoothmmoveELX(inc)

代码：

```
public double SmoothMoveELX(double x) 
{ 
    double PI = Atn(1) * 4;
    return (Cos((1 - x) * PI) + 1) / 2; 
} 
```

[http://www.vbforums.com/showthread.php?t=568889](http://www.vbforums.com/showthread.php?t=568889)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T20:00:43.020

自然移动的窗户在开始移动时会加速，在停止时会减速。速度与时间图看起来像[钟形曲线](http://commons.wikimedia.org/wiki/File:Bellcurve.svg)，或者可能是[三角波](http://commons.wikimedia.org/wiki/File:Triangle_wave.svg)的顶部。三角波会更容易实现。

当你移动盒子时，你需要在每次循环中稳定地增加你移动盒子的像素数，直到你到达点 a 和点 b 之间的中点，在这个点你将稳步减少你的像素数正在移动盒子。不涉及特殊的数学；这只是加法和减法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:14:54.940

如果你够无聊，可以自己做环回VNC来拖动鼠标。

现在，至于你为什么想要我不知道。

# ruby - 使用 ruby 管理 IIS

> ID：932707
> 
> 赞同：1
> 
> 时间：2009-05-31T19:46:03.313
> 
> 标签：ruby, iis, windows-administration

我会保持这个简短而简单的。我需要找出在使用 Ruby 的 Windows 机器上管理 IIS 必须采取的步骤。我要实现的主要目标是将现有网站的主目录设置为不同的文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T05:52:03.767

我不是 ruby​​ 用户，所以我不确定它的功能。基础是 IIS 提供了很多管理接口，

1.  ADSI,
2.  西米，
3.  通过几个 C 头文件或 COM 的本机接口
4.  .NET API（在 IIS 7 中提供）

因此，如果可以使用 ruby​​ 来操作这些接口，您就可以实现管理目标。

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/9041b0a5-c314-46d9-8f56-01506687f357.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/9041b0a5-c314-46d9-8f56-01506687f357.mspx?mfr=true)

[http://learn.iis.net/page.aspx/173/overview-of-mwa--mwm-for-iis-7/](http://learn.iis.net/page.aspx/173/overview-of-mwa--mwm-for-iis-7/)

[http://mvolo.com/blogs/serverside/archive/2007/07/12/Creating-IIS7-sites_2C00_-applications_2C00_-and-virtual-directories.aspx](http://mvolo.com/blogs/serverside/archive/2007/07/12/Creating-IIS7-sites_2C00_-applications_2C00_-and-virtual-directories.aspx)

# sql-server - 为什么我无法连接到我的计算机上的 SQL？

> ID：932711
> 
> 赞同：0
> 
> 时间：2009-05-31T19:49:07.207
> 
> 标签：sql-server, sql-server-express

我使用的是 SQL Server 2008 速成版。我以前连接过。现在我收到此错误消息：

> ## 标题：连接到服务器
> 
> 无法连接到 GEF65439\SQLEXPRESS。
> 
> - - - - - - - - - - - - - - - 附加信息：
> 
> 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）（Microsoft SQL Server，错误：2）
> 
> 如需帮助，请单击： http: [//go.microsoft.com/fwlink ?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=2&LinkId=20476](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=2&LinkId=20476)
> 
> - - - - - - - - - - - - - - - 纽扣：
> 
> ## 好的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T19:51:53.957

查看管理工具\服务并重新启动您的进程**SQL Server (SQLEXPRESS)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T19:53:01.770

检查是否在管理工具 -> 服务中启动了 Sql Server 服务。

当您 telnet 到 Sql Server 端口（默认为 1433）时会发生什么？

```
telnet localhost 1433 
```

# iphone - UITableView 作为 UIScrollView

> ID：932714
> 
> 赞同：0
> 
> 时间：2009-05-31T19:50:51.743
> 
> 标签：iphone, cocoa-touch, uitableview, uiscrollview

我一直在使用 a`UIScrollView`并且有大约 200 个项目可以滚动浏览......到目前为止。这不起作用，因为加载所有视图大约需要 45 秒。我尝试在主线程上加载前 20 个（大约 4 秒），然后在其他线程上加载 50 个块。我让前 20 个滚动浏览，但其他的没有出现。

只是为了让其`UIScrollView`正常工作需要付出很多努力，但仍然存在一些问题。`UITableView`它将为我解决所有这些问题，因为它重用了单元格。它类似于`UIScrollView`除了更有效之外。

我想让一个单元格占据整个查看区域，并让用户浏览每个单元格。滚动不会在单元格中自由滚动，而是会在每个单元格处停止，用户必须再次轻弹才能进入下一个单元格。据`UITableView`我所知，不这样做。有没有办法用 a 来获得这种行为`UITableView`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T19:02:48.123

`UITableView`是 的子类`UIScrollView`。您是否尝试过简单的设置`yourTableView.pagingEnabled = YES`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T20:35:31.060

简短的回答：没有。

您可以尝试使用委托方法控制 UITableView 的滚动行为，或者更好的是，坚持使用 UIScrollView 并在 UIScrollViewDelegate 方法中一一加载视图。

# haskell - 纯函数式语言中的高效堆

> ID：932721
> 
> 赞同：38
> 
> 时间：2009-05-31T19:52:23.240
> 
> 标签：haskell, functional-programming, binary-heap, heapsort, purely-functional

作为 Haskell 的一个练习，我正在尝试实现堆排序。堆通常在命令式语言中实现为数组，但这在纯函数式语言中效率非常低。因此，我查看了二进制堆，但到目前为止我发现的所有内容都从命令式的角度描述了它们，并且所呈现的算法很难转化为功能设置。如何用 Haskell 等纯函数式语言高效地实现堆？

*编辑：*高效我的意思是它仍然应该在 O(n*log n) 中，但它不必击败 C 程序。另外，我想使用纯函数式编程。在 Haskell 中这样做还有什么意义？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-31T21:53:54.383

[*在 Okasaki 的Purely Functional Data Structures*](http://www.eecs.usma.edu/webs/people/okasaki/pubs.html#cup98)的附录中有许多 Haskell 堆实现。（源代码可以在链接中下载。这本书本身很值得一读。）它们都不是二进制堆，但[“左派”堆](http://en.wikipedia.org/wiki/Leftist_tree)非常相似。它具有 O(log n) 的插入、删除和合并操作。还有更复杂的数据结构，如[倾斜堆](http://en.wikipedia.org/wiki/Skew_heap)、[二项堆](http://en.wikipedia.org/wiki/Binomial_heap)和[展开堆](http://en.wikipedia.org/wiki/Splay_heap)，它们的性能更好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-02-02T19:01:00.977

Jon Fairbairn 早在 1997 年就在 Haskell Cafe 邮件列表中发布了一个函数堆排序：

[http://www.mail-archive.com/haskell@haskell.org/msg01788.html](http://www.mail-archive.com/haskell@haskell.org/msg01788.html)

我在下面复制它，重新格式化以适应这个空间。我还稍微简化了merge_heap 的代码。

> 我很惊讶 treefold 不在标准前奏中，因为它非常有用。翻译自我 1992 年 10 月在《思考》中所写的版本——乔恩·费尔贝恩

```
module Treefold where

-- treefold (*) z [a,b,c,d,e,f] = (((a*b)*(c*d))*(e*f))
treefold f zero [] = zero
treefold f zero [x] = x
treefold f zero (a:b:l) = treefold f zero (f a b : pairfold l)
    where 
        pairfold (x:y:rest) = f x y : pairfold rest
        pairfold l = l -- here l will have fewer than 2 elements

module Heapsort where
import Treefold

data Heap a = Nil | Node a [Heap a]
heapify x = Node x []

heapsort :: Ord a => [a] -> [a]    
heapsort = flatten_heap . merge_heaps . map heapify    
    where 
        merge_heaps :: Ord a => [Heap a] -> Heap a
        merge_heaps = treefold merge_heap Nil

        flatten_heap Nil = []
        flatten_heap (Node x heaps) = x:flatten_heap (merge_heaps heaps)

        merge_heap heap Nil = heap
        merge_heap node_a@(Node a heaps_a) node_b@(Node b heaps_b)
            | a < b = Node a (node_b: heaps_a)
            | otherwise = Node b (node_a: heaps_b) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-31T20:20:44.383

您还可以使用`ST`monad，它允许您编写命令式代码，但安全地公开一个纯函数式接口。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-05T23:40:53.817

作为 Haskell 中的一个练习，我使用 ST Monad 实现了一个命令式堆排序。

```
{-# LANGUAGE ScopedTypeVariables #-}

import Control.Monad (forM, forM_)
import Control.Monad.ST (ST, runST)
import Data.Array.MArray (newListArray, readArray, writeArray)
import Data.Array.ST (STArray)
import Data.STRef (newSTRef, readSTRef, writeSTRef)

heapSort :: forall a. Ord a => [a] -> [a]
heapSort list = runST $ do
  let n = length list
  heap <- newListArray (1, n) list :: ST s (STArray s Int a)
  heapSizeRef <- newSTRef n
  let
    heapifyDown pos = do
      val <- readArray heap pos
      heapSize <- readSTRef heapSizeRef
      let children = filter (<= heapSize) [pos*2, pos*2+1]      
      childrenVals <- forM children $ \i -> do
        childVal <- readArray heap i
        return (childVal, i)
      let (minChildVal, minChildIdx) = minimum childrenVals
      if null children || val < minChildVal
        then return ()
        else do
          writeArray heap pos minChildVal
          writeArray heap minChildIdx val
          heapifyDown minChildIdx
    lastParent = n `div` 2
  forM_ [lastParent,lastParent-1..1] heapifyDown
  forM [n,n-1..1] $ \i -> do
    top <- readArray heap 1
    val <- readArray heap i
    writeArray heap 1 val
    writeSTRef heapSizeRef (i-1)
    heapifyDown 1
    return top 
```

顺便说一句，我认为如果它不是纯粹的功能，那么在 Haskell 中这样做是没有意义的。我认为我的玩具实现比使用模板在 C++ 中实现的要好得多，将东西传递给内部函数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-17T08:56:19.637

这是 Haskell 中的斐波那契堆：

[https://github.com/liuxinyu95/AlgoXY/blob/algoxy/datastruct/heap/other-heaps/src/FibonacciHeap.hs](https://github.com/liuxinyu95/AlgoXY/blob/algoxy/datastruct/heap/other-heaps/src/FibonacciHeap.hs)

以下是基于 Okasaki 工作的其他一些 k-ary 堆的 pdf 文件。

[https://github.com/downloads/liuxinyu95/AlgoXY/kheap-en.pdf](https://github.com/downloads/liuxinyu95/AlgoXY/kheap-en.pdf)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-31T20:20:35.163

就像用 Haskell 编写的高效快速排序算法一样，您需要使用 monads（状态转换器）来就地执行操作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-31T20:50:25.027

Haskell 中的数组并没有您想象的那么低效，但 Haskell 中的典型做法可能是使用普通数据类型来实现这一点，如下所示：

```
data Heap a = Empty | Heap a (Heap a) (Heap a)
fromList :: Ord a => [a] -> Heap a
toSortedList :: Ord a => Heap a -> [a]
heapSort = toSortedList . fromList 
```

如果我要解决这个问题，我可能会先将列表元素填充到一个数组中，以便更轻松地为它们创建索引以创建堆。

```
import Data.Array
fromList xs = heapify 0 where
  size = length xs
  elems = listArray (0, size - 1) xs :: Array Int a
  heapify n = ... 
```

如果您使用的是二进制最大堆，您可能希望在删除元素时跟踪堆的大小，以便在 O(log N) 时间内找到右下角的元素。您还可以查看通常不使用数组实现的其他类型的堆，例如二项式堆和斐波那契堆。

关于数组性能的最后一点说明：在 Haskell 中，使用静态数组和使用可变数组之间存在权衡。对于静态数组，您必须在更改元素时创建数组的新副本。对于可变数组，垃圾收集器很难将不同代的对象分开。尝试使用 STArray 实现堆排序，看看你喜欢它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-01-15T17:14:16.640

我试图将标准二进制堆移植到功能设置中。有一篇文章描述了这个想法：[A Functional Approach to Standard Binary Heaps](http://arxiv.org/pdf/1312.4666v1.pdf)。文章中的所有源代码清单都在 Scala 中。但它可能很容易移植到任何其他函数式语言中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-31T19:59:30.043

这是一个包含 ML 版本的 HeapSort 的页面。它非常详细，应该提供一个很好的起点。

[http://flint.cs.yale.edu/cs428/coq/doc/Reference-Manual021.html](http://flint.cs.yale.edu/cs428/coq/doc/Reference-Manual021.html)

# sql - SQL Server 数据库保护聪明的管理员？

> ID：932728
> 
> 赞同：3
> 
> 时间：2009-05-31T19:54:08.617
> 
> 标签：sql, database, security

我想保护存储在一个表中的事件，该表与其他表有关系。事件通过 windows 服务插入，即连接到硬件并从硬件读取。

在事件表中是 PK、日期和时间以及 3 个不同的值。

问题是每个管理员都可以登录并在此表中插入/更新/删除数据，例如使用 sql management studio。我创建触发器来防止更新和删除，所以如果管理员不知道触发器，他就无法更改数据，但如果他知道触发器，他可以轻松禁用触发器并做任何他想做的事情。

因此，经过长时间的思考，我有了一个想法，将新列（字段）添加到表中并在该字段中存储校验和之类的内容，该校验和将根据其他值计算。该校验和将在插入/更新语句中生成。如果有人手动插入/更新某些东西，我会知道的，因为如果我用校验和检查数据，就会出现不匹配的情况。

我的问题是，如果你有类似的问题，你是如何解决的？校验和使用什么算法？如何保护删除语句（我知道 PK 中的空号，但这还不够）？

我正在使用 SQL Server 2005。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-02-21T10:24:58.267

由于管理员有权在您的 SQL Server 上执行所有操作，因此我建议使用明显的审核解决方案。在这种情况下——数据库或 SQL Server 实例上发生的所有事情都被捕获并保存在一个明显的存储库中。如果有权限的人（如管理员）从存储库中修改或删除审计数据，将被报告

[ApexSQL Comply](http://solutioncenter.apexsql.com/methods-for-auditing-sql-server-data-changes-part-9-the-apexsql-solution)就是这样一个解决方案，它具有内置的完整性检查选项。有几种防篡改措施可提供不同的完整性检查并检测篡改，即使它是由受信任的一方完成的。为确保数据完整性，该解决方案使用哈希值。哈希值是使用唯一标识它的特定算法创建的数值

中央存储库数据库中的每个表都有 RowVersion 和 RowHash 列。RowVersion 包含行时间戳 - 上次修改行的时间。RowHash 列包含使用其他表列的值计算的行的唯一行标识符

当审计存储库中的原始记录被修改时，ApexSQL Comply 会自动更新 RowVersion 值以反映上次更改的时间。为了验证数据完整性，ApexSQL Comply 根据现有行值计算行的 RowHash 值。数据完整性验证中使用的值现在已更新，因此新计算的 RowHash 值将不同于存储在中央存储库数据库中的 RowHash 值。这将被报告为涉嫌篡改

为了隐藏篡改，我必须为 RowHash 计算一个新值并更新它。这并不容易，因为用于计算的公式很复杂且未公开。但这还不是全部。RowHash 值是使用前一行的 RowHash 值计算的。因此，为了掩盖篡改，我将不得不重新计算和修改所有后续行中的 RowHas 值

对于 ApexSQL Comply 中央存储库数据库中的某些表，RowHash 值是根据其他表中的行计算的，因此要覆盖一个表中的篡改痕迹，管理员必须修改多个中央存储库数据库表中的记录 此解决方案不是防篡改的，但肯定会使覆盖回火轨道变得非常困难

*免责声明：我作为支持工程师在 ApexSQL 工作*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-31T20:00:34.003

通过默默无闻的安全是一个坏主意。如果有计算校验和的公式，有人可以手动完成。

如果你不能信任你的数据库管理员，你就会遇到更大的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-31T20:33:25.857

管理员可以撤消您在服务器级别执行的任何操作。这就是其角色的定义，您无法阻止它。

在 SQL 2008 中，您可以请求使用 X 事件对所述 SQL 服务器进行审核，请参阅[http://msdn.microsoft.com/en-us/library/cc280386.aspx](http://msdn.microsoft.com/en-us/library/cc280386.aspx)。这是防篡改的符合 CC 标准的解决方案。这意味着管理员可以停止审核并执行其恶作剧的操作，但会记录审核的停止。

在 SQL 2005 中，推荐的审计解决方案是使用[分析器基础](http://msdn.microsoft.com/en-us/library/ms187346.aspx)结构。这可以在正确部署时变得明显。您将使用触发器和约束来防止数据更改并审核 DDL 更改。如果管理员更改触发器，这在审核中可见。如果管理员停止审核，这在审核中也可见。

您是否将其计划为针对流氓管理员的一次性行动，还是将其添加到您的产品中？在应用程序周期中，使用数字签名对所有应用程序数据进行签名可能会非常昂贵。您还必须设计一个安全方案来显示记录没有被删除，包括最后的记录（即，不是身份列中的简单间隙）。例如。您可以通过[BINARY_CHECKSUM(*)计算](http://msdn.microsoft.com/en-us/library/ms173784.aspx)[CHECSUM_AGG](http://msdn.microsoft.com/en-us/library/ms188920.aspx)，在应用程序中对结果进行签名，并在每次更新后存储每个表的签名值。不用说，这会减慢您的应用程序，因为基本上您会序列化每个操作。对于单个行校验和/哈希，您必须计算应用程序中的整个签名，这可能需要您的应用程序尚不具备的值（即身份列值*分配*给您的插入）。你想走多远？如果管理员掌握了您的应用程序并以什么顺序监控您的哈希值（这很容易实现），则可以破坏一个简单的哈希值。然后他可以重新计算相同的哈希值。HMAC 要求您在应用程序中存储一个秘密，这对于一个坚定的黑客来说基本上是不可能的。这些担忧可能看起来有点过头了，但如果这是您出售的应用程序，那么*黑客*只需破解您的哈希序列或 hmac 机密即可。谷歌最终会确保其他人都能发现它。

我的观点是，如果您试图通过技术阻止*管理员，那么您将面临一场失败的战斗。**管理员*是您**信任**的人，如果这在您的情况下被破坏，问题在于信任，而不是技术。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-31T20:02:14.403

最终，即使管理员没有删除权限，他们也可以授予自己访问权限，将更改更改为不拒绝删除，删除行然后恢复权限，然后撤消访问权限以进行权限更改。

如果您对此进行审核，那么当他们授予自己访问权限时，您就会解雇他们。

就有效的防篡改校验和而言，可以使用公钥/私钥签名。这意味着如果签名与消息匹配，那么除了记录说创建/修改记录的人之外，没有人可以做到这一点。任何人都可以使用自己的密钥更改和签署记录，但不能像其他人一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T20:02:33.843

我只指出[在 SQL Server 2008 中保护 DBA 的敏感信息](https://stackoverflow.com/questions/903432/protect-sensitive-information-from-the-dba-in-mssql-server)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T20:03:42.920

应用程序计算校验和的想法是一个很好的想法。我建议您研究消息身份验证代码或 MAC，以获得更安全的方法。

简而言之，一些 MAC 算法 (HMAC) 使用散列函数，并将密钥作为散列输入的一部分。因此，即使管理员知道所使用的散列函数，他也无法重现散列，因为他不知道所有输入。

此外，在您的情况下，序列号应该是哈希输入的一部分，以防止删除整个条目。

理想情况下，您应该使用 SHA-2 系列中的强大加密哈希函数。MD5 有已知漏洞，在 SHA-1 中怀疑有类似问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T20:00:41.023

尝试锁定表的权限可能更有效。通过校验和，恶意用户似乎可以欺骗它，或者插入看似有效的数据。

[http://www.databasejournal.com/features/mssql/article.php/2246271/Managing-Users-Permissions-on-SQL-Server.htm](http://www.databasejournal.com/features/mssql/article.php/2246271/Managing-Users-Permissions-on-SQL-Server.htm)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-31T20:02:49.630

如果您担心人们修改数据，您还应该担心他们修改校验和。

你不能简单地用密码保护该数据库的某些权限吗？

# visual-studio - 如何将标准库项目更改为 silverlight 库项目？

> ID：932740
> 
> 赞同：1
> 
> 时间：2009-05-31T20:02:07.667
> 
> 标签：visual-studio, silverlight, compilation

我已经下载了 Ninject SVN 视觉工作室项目，我想针对 Silverlight 库编译它以制作与 Silverlight 兼容的 DLL。

是否有更改某处的设置以使其成为 Silverlight 库项目，或者我是否需要在这里和那里交换引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T20:35:34.150

没有设置，您需要在适当的 SL 库中进行交换，它不仅仅是“这里和那里”，它实际上是“无处不在”。然后，您需要希望该项目不使用 SL 库中不存在的任何内容。

# asp.net - 如何获取 ASP.NET 应用程序的完整虚拟路径

> ID：932745
> 
> 赞同：36
> 
> 时间：2009-05-31T20:03:33.090
> 
> 标签：asp.net, path, virtual

我如何知道我的应用程序当前托管的完整虚拟路径？例如：

```
http://www.mysite.com/myApp 
```

或者

```
http://www.mysite.com/myApp/mySubApp 
```

我知道 HttpRequest 的应用程序路径，但它只返回我的应用程序当前托管的文件夹名称，但我如何获得初始部分？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-05-31T20:13:35.537

路径的域名部分实际上并不是应用程序本身的属性，而是取决于请求的 URL。您可能能够从许多不同的主机名访问一个网站。**要获取与当前请求**关联的域名以及当前应用程序的虚拟路径，您可以执行以下操作：

```
Request.Url.GetLeftPart(UriPartial.Authority) + Request.ApplicationPath 
```

从技术上讲，“应用程序”是在 IIS 中定义的虚拟目录，并且`Request.ApplicationPath`完全返回该目录。如果要获取处理当前**请求**的文件夹，可以这样做：

```
VirtualPathUtility.GetDirectory(Request.Path) 
```

如果在 IIS 中没有将子应用程序定义为虚拟目录，那么 ASP.NET 不知道如何区分您的子应用程序和更大的应用程序。如果没有在 IIS 中注册，它只会将整个事物视为一个应用程序。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-31T20:16:55.577

```
Request.Url 
```

它包含您可能会考虑使用的几个点，请参见下图：

![在此处输入图像描述](https://i.stack.imgur.com/j631H.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-23T07:50:43.000

下面的代码将解决这个目的，但是您必须对两种类型的场景进行一些调整：

1.  作为单独的 Web 应用程序托管。
2.  在 Web 应用程序中托管为虚拟应用程序。

    HttpContext.Current.Request.Url.GetLeftPart(UriPartial.Authority) + HttpRuntime.AppDomainAppVirtualPath;

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-02-03T03:27:23.310

在 .NET 4.5 中

```
 VirtualPathUtility.ToAppRelative(path) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-31T20:08:27.810

试试这个（没试过）

```
public string GetVirtualPath(string physicalPath)
{
string rootpath = Server.MapPath("~/");
physicalPath = physicalPath.Replace(rootpath, "");
physicalPath = physicalPath.Replace("\\", "/");
return "~/" + physicalPath;
} 
```

[链接 1](http://weblogs.asp.net/pleloup/archive/2004/06/24/164706.aspx)

[链接 2](http://www.teknowmagic.net/GetTip.aspx?tip=6)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-12T19:17:20.900

**`Url.Content("~")`**对我来说效果很好，而且很简单。我在这样的视图中使用它：

```
<a href="@(Url.Content("~" + attachment))"> 
```

这是我`attachment`的路径，例如*"/Content/Documents/Blah.PDF"*。

当我的应用程序发布到使用虚拟目录的 IIS 站点时，会`Url.Content("~")`解析为虚拟目录名称，例如*"/app-test"*。

# iphone - iPhone 3.0 SDK 支持串口通讯吗？

> ID：932750
> 
> 赞同：0
> 
> 时间：2009-05-31T20:04:59.970
> 
> 标签：iphone

已经有一个[黑客可以](http://devdot.wikispaces.com/Iphone+Serial+Port+Tutorial)通过 iPhone 的 30 针连接器进行串行通信，这需要一部越狱的手机。查看[iPhone 开发网站](http://developer.apple.com/iphone/program/accessories/)，3.0 SDK 在与 3rd 方硬件通信方面似乎更友好一些。

我不是开发人员计划的一部分，因此无法深入了解 3.0 SDK 的任何技术细节，但我想知道是否支持通过物理连接器的串行支持。它说将支持蓝牙，并且可以使用蓝牙<->串行，但我专门询问物理连接器。

我正在考虑的是一个 iPhone 应用程序，它连接到我拥有的现有设备，它会说串行。我从未做过任何 iPhone 开发或黑客活动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T20:17:57.383

3.0 SDK 仍处于 NDA 之下，因此没有注册开发者可以随意谈论它。再等一周，3.0 SDK 很有可能会在 6 月 8 日的 WWDC 主题演讲中公开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T17:26:32.330

物理连接和蓝牙连接都仅限于“Made for iPod”设备。如果您的设备是 MFi，那么您可以通过任何您想要的协议进行通信。如果没有，那么您将不会在没有越狱的情况下进行连接。

# image - 镜像源更新完成时 Flex 强制调整大小

> ID：932760
> 
> 赞同：0
> 
> 时间：2009-05-31T20:11:39.987
> 
> 标签：image, events, apache-flex

我更新图像的源属性。加载图像后，我想重新绘制边框皮肤以适应图像的新大小。

```
newImgEdit.addEventListener(Event.COMPLETE, loadImgComplete);
newImgEdit.source = myurl_ressource;

private function loadImgComplete(evt:Event):void {
    trace("redraw !!");
    //invalidateDisplayList();
    this.setStyle("borderSkin", ShapeContainerBorderOn);
    var img:Image = evt.currentTarget as Image;
    img.removeEventListener(Event.COMPLETE, loadImgComplete);
} 
```

一旦加载图像，似乎会发生“重绘”痕迹，但边框仍然没有以正确的高度和宽度重绘。

我需要删除侦听器还是稍后将其作为垃圾收集？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-01T13:57:13.780

You can [manually force a component to update its layout](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf633a0-7fff.html#WS2db454920e96a9e51e63e3d11c0bf69084-7dfd) by calling `validateNow()`.

# jquery - jQuery 重新加载 div 的内容（动态渲染）

> ID：932777
> 
> 赞同：4
> 
> 时间：2009-05-31T20:19:37.037
> 
> 标签：jquery, plugins, refresh, reload

我有一个通过表达式引擎生成 html 的 div。我正在使用ajax提交：

```
$('#login-form').ajaxForm({  
    // success identifies the function to invoke when the server response 
    // has been received; here we apply a fade-in effect to the new content 
    success: function() { 
    $("#panel").RELOAD!!();//Just refresh this div!
    } 
}); 
```

我只想让#panel div 重新加载/刷新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T20:30:00.387

我假设您正在寻找类似的东西：

```
$('#login-form').ajaxForm({  
    success: function( data) { 
    $("#panel").html( data);//Will insert new content inside div element.
    } 
}); 
```

使固定：

```
$('#login-form').ajaxForm({ 
    target: '#panel', //Will update the "#panel"
    success: function( data) { 
    alert( "Success");
    } 
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T20:46:25.143

jQuery 的“操作”部分中列出的几乎所有方法都会做你想做的事：http: [//docs.jquery.com/Manipulation](http://docs.jquery.com/Manipulation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T20:50:29.300

为了你漂亮的淡入淡出

```
success : function(data) {
   $("#panel").hide().html(data).fadeIn('fast');
} 
```

# svn - 当我使用 svn:keywords 时如何为 subversion 设置作者姓名

> ID：932779
> 
> 赞同：2
> 
> 时间：2009-05-31T20:20:39.390
> 
> 标签：svn, properties, version-control-keywords

我想将我的全名（或我选择的名称）设置为在提交时出现在 $Id$ 区域中，而不是我的昵称。有没有办法做到这一点？

操作系统：Ubuntu 8.10

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T21:42:27.230

你想要一个上面有你名字的文件，然后

```
svn propset svn:keywords "Author" file.txt 
```

如 http://svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html 中所示

$Id$ 是修订号、日期、作者和 URL 的组合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T17:18:16.863

如果存储库允许，您可以更改作者。不过我建议不要这样做，因为每次提交后你都必须这样做。

你不能只改变你的登录名吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-08T06:35:43.987

没有办法设置它:(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-22T03:30:26.787

假设您有权执行此操作，[我被告知](http://www.tty1.net/blog/2008-07-01-svn-author-renaming_en.html)您可以使用命令执行此操作

```
svn ps svn:author "author_name" --revprop -r revision_number "repository_url" 
```

如果出现错误，则需要[添加 pre/post propset hooks](http://home.introweb.nl/d/dodger/svnauthor.html)。

# image - 如何在 PHP 中选择对比度更高的图像？

> ID：932781
> 
> 赞同：1
> 
> 时间：2009-05-31T20:21:53.867
> 
> 标签：image, contrast

对于缩略图引擎，我想开发一种算法，该算法从图像中获取 x 个随机缩略图（裁剪，不调整大小），分析它们的对比度并选择具有最高对比度的那个。我正在使用 PHP 和 Imagick，但我会很高兴获得一些关于如何计算图像对比度的一般提示。

似乎有很多事情比计算对比度更容易，例如计算颜色、计算亮度等。

您在分析图片材料方面有哪些经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T20:51:34.977

我会这样做（伪代码）：

```
L[256] = {0,0,0...}

loop over each pixel:
    luminance = avg(R,G,B)
    increment L[luminance] by 1

for i = 0 to 255:
    if L[i] < C: L[i] = 0       // C = threshold of your chose

find index of first and last non-zero value of L[]
contrast = last - first 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T02:12:34.480

在寻找“具有最高对比度”的图像时，您需要非常小心地定义图像的对比度。用最简单的方式，对比度是图像中最低强度和最高强度之间的差异。在您的情况下，这不会很有用。

我建议您使用直方图方法来描述给定图像的对比度，然后比较直方图的属性以确定您定义时对比度最高的图像。您可以使用各种众所周知的容器来表示代码中的直方图，或者构造一个类来满足您的特定需求。（我并不是暗示您需要以图表的形式创建直方图 - 只是强度值的统计表示。）您可以直接使用每个直方图的方差作为对比度的度量，或者使用标准偏差，如果这更容易使用。

关键在于如何定义图像的对比度。一般来说，我会将高对比度图像定义为所有或几乎所有可能值都存在值的图像。我还要补充一点，在这个高对比度图像的定义中，图像的强度值将倾向于以统一的方式分布在可能值的范围内。

使用这种方法，低对比度图像将倾向于具有相对较少的离散强度值，并且它们将倾向于紧密地组合在一起而不是均匀分布。（作为一般规则，它们也倾向于向范围的中心分组。）

# binding - 你如何进行语言绑定？

> ID：932782
> 
> 赞同：12
> 
> 时间：2009-05-31T20:23:30.900
> 
> 标签：binding

尽管我或多或少地了解什么是语言绑定，但我很难理解它们是如何工作的。例如，谁能解释一下如何为 WinAPI 制作 Java 绑定？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T21:07:37.207

如果您搜索 Foreign Function Interface 或 FFI，您会发现更好的结果。FFI 允许您调用用不同语言（即外语）编写的函数。不同的语言和运行时有很大不同的 FFI，你必须单独学习每一个。学习 FFI 还迫使您比通常习惯的更多地了解语言的内部结构及其运行时。一些 FFI 让你用目标语言编写代码，比如 Haskell（FFI 代码必须用 Haskell 编写），而另一些 FFI 让你用源语言编写代码，比如 Python（FFI 代码必须用 C 编写）。

某些语言不使用术语 FFI（尽管如果他们这样做会很好）。对于 Java，它被称为[Java Native Interface，](http://en.wikipedia.org/wiki/Java_Native_Interface)或 JNI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T21:08:35.440

语言（通常）已经定义了调用“本机”代码的语法。因此，如果您有导出方法的库，那么`foo()`进行投标将意味着您将创建，例如，带有方法的 Java 类`foo()`。这样，您可以`MyBinding.foo()`从代码的其余部分调用，无论是纯 Java 方法还是编译的 C 代码都没有区别。

同样对于 Java，您可能想查看[JNI](http://java.sun.com/developer/onlineTraining/Programming/JDCBook/jni.html)文档。其他语言也有类似的机制。有像[SIP](http://www.riverbankcomputing.co.uk/software/sip/intro)这样的工具会获取一堆 C(++) 头文件，并为其生成 Python 绑定。我猜其他语言也可能有类似的工具。

# python - 表达式到注释或行尾

> ID：932783
> 
> 赞同：3
> 
> 时间：2009-05-31T20:23:33.783
> 
> 标签：python, regex

虽然这个问题类似于[这个线程](https://stackoverflow.com/questions/175103/regex-to-match-url-end-of-line-or-character)

我认为在使用正则表达式构建代码时我可能做错了什么。

我想将一行中的任何内容匹配到注释（“#”）或行尾（如果它没有注释）。

我正在使用的正则表达式是：`(.*)(#|$)`

`(.*)`= 一切
`(#|$)`= 注释或行尾

编码：

```
OPTION = re.compile(r'(?P<value>.*)(#|$)')
file = open('file.txt')
lines = file.read()
for line in lines.split('\n'):
    get_match = OPTION.match(line)
    if get_match:
        line_value = get_match.group('value')
        print "Match=  %s" % line_value 
```

以上有效，但没有删除评论。如果文件有如下一行：

```
this is a line   # and this is a comment 
```

运行代码时我仍然得到整行。

我是否缺少正则表达式中的其他值/信息，还是需要更改代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-31T20:36:46.473

* 是贪婪的（尽可能多地消耗字符串），因此消耗了整行（经过 # 并到行尾）。改成 ”。*？” 它会起作用。

有关更多信息，请参阅[正则表达式 HOWTO](http://docs.python.org/howto/regex.html#repeating-things)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T20:27:35.213

这是执行以下操作的正确正则表达式：

```
([^#]*)(#.*)? 
```

另外，你为什么不直接使用

```
file = open('file.txt')
for line in file: 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T21:00:17.283

@Can、@Benji 和 @ ΤZΩΤZΙΟΥ 提供了三个出色的解决方案，并且很有趣地给它们计时，看看它们的匹配速度有多快（这就是`timeit`目的——有趣的无意义的微基准测试；-）。例如：

```
$ python -mtimeit -s'import re; r=re.compile(r"([^#]*)(#.*)?"); s="this is a line   # and this is a comment"' 'm=r.match(s); g=m.group(1)'
100000 loops, best of 3: 2.02 usec per loop 
```

对比

```
$ python -mtimeit -s'import re; r=re.compile(r"^(.*?)(?:#|$)"); s="this is a line   # and this is a comment"' 'm=r.match(s); g=m.group(1)'
100000 loops, best of 3: 4.19 usec per loop 
```

对比

```
$ python -mtimeit -s'import re; r=re.compile(r"(.*?)(#|$)"); s="this is a line   # and this is a comment"' 'm=r.match(s); g=m.group(1)'
100000 loops, best of 3: 4.37 usec per loop 
```

获胜者是......模式的混合！-)

```
$ python -mtimeit -s'import re; r=re.compile(r"(.*?)(#.*)?"); s="this is a line   # and this is a comment"' 'm=r.match(s); g=m.group(1)'
1000000 loops, best of 3: 1.73 usec per loop 
```

免责声明：当然，如果这是一个真正的基准测试练习并且速度确实很重要，人们会尝试许多不同的和相关的值`s`，在这样的微基准测试之外的测试等等等等。但是，我仍然找到`timeit`了取之不尽的乐趣！ -)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:56:14.187

使用这个正则表达式：

```
^(.*?)(?:#|$) 
```

使用非贪婪修饰符 ( `?`)，*只要*达到井号或行尾，`.*`表达式就会匹配。默认是尽可能匹配*，*这就是为什么你总是得到整行。

 **# php - 长篇文章如何分割存入数据库，方便检索和分页？

> ID：932788
> 
> 赞同：4
> 
> 时间：2009-05-31T20:27:59.673
> 
> 标签：php, database, database-design, schema

假设是一篇很长的文章（比如 100,000 字），我需要编写一个 PHP 文件来显示文章的第 1、2 或第 38 页，通过

```
display.php?page=38 
```

但是每页的字数会随着时间的推移而变化（例如，现在如果是每页 500 字，但下个月我们可以轻松地将其更改为每页 300 字）。有什么好办法把长篇文章分好存入数据库？

**PS**如果我们要显示 500 字但包括整个段落，设计可能会更加复杂。也就是说，如果我们已经显示了 480 个单词，但该段落还有 100 个单词，那么即使它超过了 500 个单词的限制，也要显示这 100 个单词。（然后，下一页不应再显示这 100 个单词）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T20:33:29.613

您当然可以每页准确输出 500 个单词，但更好的方法是在您的文章中加入某种中断（句末、段末）。把它们放在适合休息的地方。这样一来，您的页面中每个单词就不会正好有 X 个单词，而是大约或最多 X 个单词，并且不会将句子或段落分开。当然，在显示页面时，不要显示这些中断标记。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T20:51:28.627

我会在保存它们时通过在 chuks 上拆分文章来做到这一点。保存脚本将使用您设计的任何规则拆分文章，并将每个块保存到如下表中：

```
CREATE TABLE article_chunks (
    article_id int not null,
    chunk_no int not null,
    body text
} 
```

然后，当您加载文章的页面时：

```
$sql = "select body from article_chunks where article_id = "
    .$article_id." and chunk_no=".$page; 
```

每当您想更改将文章拆分为页面的逻辑时，您都可以运行一个脚本，将所有块拉到一起并重新拆分它们：

**更新：**给出建议我认为您的应用程序是阅读密集型而不是写入密集型，这意味着阅读文章的频率高于撰写文章的频率

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T20:39:20.010

您可能希望首先使用 split 命令将文章分成一组段落： [http ://www.php.net/split](http://www.php.net/split)

```
$array = split("\n",$articleText); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T20:57:33.700

手动剪切文本是更好的方法，因为离开一个决定剪切位置的程序不是一个好主意。有时它会在 h2 标签之后被剪切，并在下一页继续显示文本。

这是一个简单的数据库结构：
article(id, title, time, ...)
article_body(id, article_id, page, body, ...)

SQL查询：

```
SELECT a.*, ab.body, ab.page
FROM article a
INNER JOIN article_body ab
    ON ab.article_id = a.id
WHERE a.id = $aricle_id AND ab.page= $page
LIMIT 1; 
```

在应用程序中，您可以使用 jQuery 为另一个页面简单地添加新的 textarea...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T22:12:56.543

你的桌子可能是这样的

```
CREATE TABLE ArticleText (
  INTEGER artId,
  INTEGER wordNum,
  INTEGER wordId,
  PRIMARY KEY (artId, wordNum),
  FOREIGN KEY (artId) REFERENCES Articles,
  FOREIGN KEY (wordId) REFERENCES Words
) 
```

当然，这可能会非常占用空间或速度很慢等，但是您需要进行一些测量来确定这一点（很大程度上取决于您的数据库引擎）。顺便说一句，我希望很清楚 Articles 表只是一个包含由 artId 键入的文章的元数据的表，而 Words 表是一个由 wordId 键入的每篇文章中所有单词的表（试图通过识别已知单词来节省一些空间输入文章时，如果可行的话...）。一个特殊的词必须是“段落结尾”标记，这样可以很容易地识别出来，并且与每个真实的词不同。

如果您确实像这样构建数据，则您在按页面检索时获得了很大的灵活性，并且页面长度可以立即更改，如果您愿意，甚至可以逐个查询。获取页面：

```
SELECT wordText
FROM  Articles
 JOIN ArticleText USING (artID)
 JOIN Words USING (wordID)
 WHERE wordNum BETWEEN (@pagenum-1)*@pagelength AND @pagenum * @pagelength + @extras
  AND Articles.artID = @articleid 
```

parameters `@pagenum`, `@pagelength`, `@extras`,`@articleid`将在查询时插入到准备好的查询中（使用您的数据库和语言之类的任何语法，例如`:extras`编号参数或其他）。

因此，我们得到`@extras`超出预期页尾的单词，然后在客户端我们检查这些额外的单词以确保其中一个是段落结尾标记 - 否则我们将执行另一个查询（使用不同的`BETWEEN`值）来获取更多的。

远非理想，但是，鉴于您强调的​​所有问题，值得考虑。如果您可以指望页面长度总是例如 100 的倍数，您可以基于 100 字的块（并且没有`Words`表格，只是每行直接存储的文本）采用这种轻微的变化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-01T14:00:49.887

让作者自己把文章分成几部分。

作者知道如何通过将文章划分为逻辑部分来使文章变得有趣和可读，例如“第 1 部分 - 安装”、“第 2 部分 - 配置”等。让算法来做是一个糟糕的决定，恕我直言。

在错误的地方砍文章只会让读者生气。不要这样做。

我的 2¢

```
/0 
```

# asp.net - Firefox中的asp.net重定向不起作用

> ID：932789
> 
> 赞同：3
> 
> 时间：2009-05-31T20:28:32.480
> 
> 标签：asp.net, firefox, response.redirect

在我的 .net 3.5 Web 应用程序中，我使用 response.redirect 将用户重定向到另一个页面。

这适用于所有 ie 浏览器，但不适用于 firefox 浏览器。我不知道为什么？

```
Response.Redirect("~/"+ GlobalConsts.ARTICLE_ANALYSER_URL +"?"+ GlobalConsts.QUERYSTRING_KEY_ONE + 
            SessionHandler.RedirectToArticleID + GlobalConsts.QUERYSTRING_KEY_TWO + 
            SessionHandler.RedirectToArticleParentOrChild); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T20:54:48.527

尝试安装此 Firefox 扩展并记录发送到客户端的标头：

[https://addons.mozilla.org/en-US/firefox/addon/3829](https://addons.mozilla.org/en-US/firefox/addon/3829)

标题可能会让您更深入地了解问题所在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-21T16:01:04.687

始终先与[提琴手](http://fiddler2.com/fiddler2/)核对。

我喜欢在您链接的论坛中提出的建议，这不是重定向错误，而是浏览器缓存的问题。尝试设置 expires 标头。

如果以上没有做到这一点，请与 fiddler 分享更多您的发现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-27T07:51:58.507

**更新**

而不是使用 Response.Redirect 只需手动进行重定向：

```
Response.Clear();
Response.Status = "302 Found";
Response.StatusCode = 302;
Response.AddHeader("Location", url);
Context.ApplicationInstance.CompleteRequest(); 
```

**旧帖子**

根据这篇文章[http://www.mrclay.org/2011/07/03/firefox-5-shibboleth-issues/ ，这可能是一个缓存问题](http://www.mrclay.org/2011/07/03/firefox-5-shibboleth-issues/)

您可能需要删除您在响应中发送的任何缓存标头。所以将缓存头设置为不缓存，然后响应重定向：

```
Response.Cache.SetCacheability(HttpCacheability.NoCache); 
Response.Redirect("~/"+ GlobalConsts.ARTICLE_ANALYSER_URL +"?"+ GlobalConsts.QUERYSTRING_KEY_ONE + 
            SessionHandler.RedirectToArticleID + GlobalConsts.QUERYSTRING_KEY_TWO + 
            SessionHandler.RedirectToArticleParentOrChild); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-25T15:35:26.800

试试这个：

```
Response.Redirect("~/"+ GlobalConsts.ARTICLE_ANALYSER_URL +"?"+ GlobalConsts.QUERYSTRING_KEY_ONE + 
            SessionHandler.RedirectToArticleID + GlobalConsts.QUERYSTRING_KEY_TWO + 
            SessionHandler.RedirectToArticleParentOrChild,false); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T20:32:44.967

在 Firefox 中，检查您的**about:config**设置**network.http.redirection-limit**（应该大于 1）。

使用 FireFox 进行一般开发故障排除的快速提示：获取[Firebug](http://www.getfirebug.com)扩展。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-22T08:59:56.833

您可以创建一个 javascript 函数并在需要进行重定向时调用它，

```
//javascript
function RedirectJS(url){
    window.location.href=url;
} 
```

在代码隐藏中修改按钮的onclick属性

```
//C#
protected void Page_Load(object sender, EventArgs e)
{
     if(!IsPostBack)
     {
          Button1.OnClientClick = "RedirectJS('"+HttpContext.Current.Request.ApplicationPath+"/"+GlobalConsts.ARTICLE_ANALYSER_URL +"?"+ GlobalConsts.QUERYSTRING_KEY_ONE + SessionHandler.RedirectToArticleID + GlobalConsts.QUERYSTRING_KEY_TWO + SessionHandler.RedirectToArticleParentOrChild+"');";
     }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-06-22T14:20:25.273

试试这个： Response.RedirectPermanent(url, true);

# php - 没有 .htaccess 的安全目录密码保护

> ID：932793
> 
> 赞同：1
> 
> 时间：2009-05-31T20:30:06.267
> 
> 标签：php, directory, security, password-protection

我打算使用 .htaccess 密码保护我正在编写的 php 脚本的目录，因为我不相信我的 PHP 技能可以创建安全登录，但我发现你不能使用 AuthUserFile 的相对路径，我不能概括这一点。

如果您能指导我使用安全的 PHP 登录脚本来密码保护目录，我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T20:48:07.447

您可以做的一件事是将所有“秘密”文件保存在服务器 webroot 之外的目录中。所有对这些文件的访问都可以通过您目录中的单个 PHP 脚本进行路由。像这样的东西：

[http://www.example.com/protected-directory/access.php?file=/foo/document.doc](http://www.example.com/protected-directory/access.php?file=/foo/document.doc)

使用这样的目录结构：

```
+--+ /server_root
   |
   +--+ /web_root
   |  |
   |  +--+ /protected-directory
   |     +-- access.php
   |     +-- access-denied.html
   |
   +--+ /protected_root
      |
      +--+ /foo
         +-- document.doc 
```

在你的`access.php`你会做这样的事情：

```
$file = $_REQUEST['file'];
if ($user->hasAccessTo($file)) {
    readfile("/server_root/protected_root/$file");
} else {
    readfile('access-denied.html');
} 
```

现在，您必须小心，确保没有人使用您的`file`-parameter 并传递类似`"../../../etc/passwd"`. 此外，您可能希望确保在上面的示例中发送正确的标头，为了清楚起见，我省略了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T20:42:07.240

您可以使用 AuthUserFile 的绝对路径，并安排将该文件放在 Web 服务器无法访问的位置。我已经这样做了很多年了。工作正常。

# python - 如何使用正则表达式解析角度值

> ID：932796
> 
> 赞同：3
> 
> 时间：2009-05-31T20:33:01.893
> 
> 标签：python, regex, angle

我使用正则表达式的经验很少，我需要使用正则表达式解析表示为方位角的角度值，例如：

"N45°20'15.3"E"

代表：45度，20分15.3秒，位于NE象限。

限制是：

*   第一个字符可以是“N”或“S”
*   最后一个字符可以是“E”或“W”
*   0 <= 度 <= 59
*   0 <= 分钟 <= 59
*   0 <= second < 60，可以省略。

最好使用 Python 或任何其他语言。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T20:41:01.550

试试这个正则表达式：

```
^([NS])([0-5]?\d)°([0-5]?\d)'(?:([0-5]?\d)(?:\.\d)?")?([EW])$ 
```

它匹配任何字符串……</p>

*   **`^([NS])`**   以`N`或开头`S`
*   **`([0-5]?\d)°`**   后跟一个度数，可以是`0`和`9`( `\d`) 之间的单个数字，也可以是两个数字，第一个`0`和`5`( `[0-5]`) 之间，第二个`0`和`9`，因此在`0`and之间`59`，后跟`°`
*   **`([0-5]?\d)'`**   后跟一个分钟值（同样介于`0`和之间`59`）和`'`
*   **`(?:([0-5]?\d)(?:\.\d)?")?`**   可选地后跟一个秒值和`"`符号，秒值之间`0`和`59`一个可选的附加小数点，和
*   **`([EW])$`**   以`E`or结尾`W`。

如果您不想让十以下的值前面有零，请将 更改`[0-5]`为`[1-5]`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T20:36:55.240

您可以使用的模式：

```
pat = r"^([NS])(\d+)°(\d+)'([\d.]*)\"?([EW])$" 
```

一种使用方法：

```
import re
r = re.compile(pat)
m = r.match(thestring)
if m is None:
  print "%r does not match!" % thestring
else:
  print "%r matches: %s" % (thestring, m.groups()) 
```

正如您会注意到的那样，在匹配时，会为您提供匹配每个括号括起来的“组”`m.groups()`的各个部分——一个字母 N 或 S，然后是一个或多个数字的度数，等等。我想这就是你这里的意思是“解析”。`thestring``pat`

# c# - C# 窗体移动停止事件

> ID：932800
> 
> 赞同：6
> 
> 时间：2009-05-31T20:34:55.587
> 
> 标签：c#, winforms, events, move, wndproc

当窗体停止移动时，C# 中是否有任何事件触发。不是在它移动的时候。

如果没有事件，有没有办法用 WndProc 做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-31T21:21:44.353

ResizeEnd 事件在移动结束后触发。也许你可以使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T21:15:28.267

这不是故障安全解决方案，但它是纯 .NET，而且非常简单。在表单中添加一个计时器，将其设置为相对较短的延迟（100-150 毫秒对我来说似乎没问题）。为 Form.LocationChanged 和 Timer.Tick 事件添加以下代码：

```
private void Form_LocationChanged(object sender, EventArgs e)
{
    if (this.Text != "Moving")
    {
        this.Text = "Moving";
    }
    tmrStoppedMoving.Start();
}

private void Timer_Tick(object sender, EventArgs e)
{
    tmrStoppedMoving.Start();
    this.Text = "Stopped";
} 
```

如果您想要更精确的处理（确切知道鼠标按钮何时在标题栏中释放等），您可能需要深入监控 Windows 消息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-27T15:52:47.240

我对用户控件有同样的问题，但它没有 ResizeEnd 事件。有效的解决方案是覆盖 WndProc 方法并监听 EXITSIZEMOVE。

[在此处](http://bytes.com/topic/net/answers/767350-net-2-0-user-control-not-able-find-resize-end-event)查看示例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T20:44:57.830

当 onmove 事件被触发时，只需将标志设置为 true。如果发生 mouseup 事件并且标志为真，则窗体停止移动。

我承认这在用户通过键盘移动表单的情况下可能不起作用，但这种情况很少见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-16T12:46:43.330

我测试了 ResizeChanged 事件，它工作正常，但是我不知道移动和调整大小之间的关系，但它对我有用

# iphone - 如何将@selector 作为参数传递？

> ID：932801
> 
> 赞同：51
> 
> 时间：2009-05-31T20:34:58.317
> 
> 标签：iphone, objective-c, selector

对于方法：

```
[NSThread detachNewThreadSelector:@selector(method:) toTarget:self withObject:(id)SELECTOR]; 
```

我如何传入@selector？我尝试将其转换为 (id) 以使其编译，但它在运行时崩溃。

* * *

更具体地说，我有这样的方法：

```
+(void)method1:(SEL)selector{
[NSThread detachNewThreadSelector:@selector(method2:) toTarget:self withObject:selector];   
} 
```

它崩溃了。如何在不崩溃的情况下传入选择器，以便新线程在线程准备好时可以调用选择器？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-31T21:13:55.413

这里的问题不是将选择器传递给方法本身，而是将选择器传递到预期对象的位置。要将非对象值作为对象传递，您可以使用[`NSValue`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSValue_Class/Reference/Reference.html). In this case, you'll need to create a method that accepts an NSValue and retrieves the appropriate selector. 这是一个示例实现：

```
@implementation Thing
- (void)method:(SEL)selector {
    // Do something
}

- (void)methodWithSelectorValue:(NSValue *)value {
    SEL selector;

    // Guard against buffer overflow
    if (strcmp([value objCType], @encode(SEL)) == 0) {
        [value getValue:&selector];
        [self method:selector];
    }
}

- (void)otherMethodShownInYourExample {
    SEL selector = @selector(something);
    NSValue *selectorAsValue = [NSValue valueWithBytes:&selector objCType:@encode(SEL)];
    [NSThread detachNewThreadSelector:@selector(methodWithSelectorValue:) toTarget:self withObject:selectorAsValue];
}
@end 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-04-23T01:58:07.297

`NSStringFromSelector()`您可以使用and`NSSelectorFromString()`函数在选择器和字符串对象之间进行转换。所以你可以只传递字符串对象。

或者，如果您不想更改您的方法，您可以创建一个`NSInvocation`来为您的方法调用创建一个调用（因为它可以使用非对象参数设置调用），然后调用它 do`[NSThread detachNewThreadSelector:@selector(invoke) toTarget:myInvocation withObject:nil];`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-31T21:14:48.097

使用 NSValue，如下所示：

```
+(void)method1:(SEL)selector {
    NSValue *selectorValue = [NSValue value:&selector withObjCType:@encode(SEL)];
    [NSThread detachNewThreadSelector:@selector(method2:) 
                             toTarget:self 
                           withObject:selectorValue];
} 
```

NSValue 旨在作为任意非对象类型的对象包装器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-31T20:54:21.553

请参阅：[将方法作为参数传递](https://stackoverflow.com/questions/519600/is-it-possible-to-pass-a-method-as-an-argument-in-objective-c)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T20:55:22.613

如果您不想指定对象，请使用 nil。

```
[NSThread detachNewThreadSelector:@selector(method:) toTarget:self withObject:nil]; 
```

如果您需要将对象传递给选择器，它看起来像这样。

在这里，我将一个字符串传递给方法“setText”。

```
NSString *string = @"hello world!";
 [NSThread detachNewThreadSelector:@selector(setText:) toTarget:self withObject:string];

-(void)setText:(NSString *)string {
    [UITextField setText:string]; 
} 
```

# windows - 我的安装程序应该在 Vista 上安装应用程序的目录是什么？

> ID：932807
> 
> 赞同：3
> 
> 时间：2009-05-31T20:37:59.310
> 
> 标签：windows, windows-vista, installation, windows-installer

我几乎完成了为 Windows 开发的游戏，我很好奇应该在哪里安装安装程序。我知道它曾经在“程序文件”中，但在 Vista 下有变化吗？

我知道魔兽世界现在安装在用户/公共/游戏下……微软推荐的游戏位置是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T20:44:27.813

您应该使用[环境变量](http://vlaurie.com/computers2/Articles/environment.htm)。

即为`%PROGRAMFILES%`你。

只需更彻底地阅读这个问题。根据我对 Vista 的经验，大多数 gubbins 仍然安装到`%PROGRAMFILES%`. 也许 /users/public... 路径是可以安装（和更新）东西的地方，而不必一直获得管理员权限。（一个完整的猜测）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T04:15:31.380

在 Vista 中，推荐的目录仍然是 %PROGRAMFILES%。

请注意，在 Windows 7 中，Microsoft 已启用创建真正的每用户安装，包括对每用户程序文件的支持。这是 Windows Installer 5.0 的一项功能，您可以在此处阅读更多信息：

[http://msdn.microsoft.com/en-us/library/dd408068(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd408068(VS.85).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T03:16:32.453

看起来您应该使用[SHGetKnownFolderPath](http://msdn.microsoft.com/en-us/library/bb762188(VS.85).aspx)来询问[FOLDERID_Games KNOWNFOLDERID](http://msdn.microsoft.com/en-us/library/bb762584(VS.85).aspx)的位置。

**编辑**：不，看起来不对。 [该线程](http://www.quartertothree.com/game-talk/showthread.php?t=47562)讨论了 FOLDERID_Games 并指出它是一个虚拟目录。 [这篇知识库文章](http://support.microsoft.com/default.aspx/kb/936828)讨论了 Windows Vista 游戏资源管理器。而[这篇文章](http://www.gamesforwindows.com/en-US/AboutGFW/Pages/WindowsVista.aspx)有一些更具体的 Vista 信息。

对不起 - 这已经变成了一个非答案，但也许这些链接会帮助你找到答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:22:25.217

推荐的目录还是Program Files，大家都说了。但是，如果您想要按用户安装，则可以将其安装在 AppData 文件夹中。我知道谷歌浏览器这样做是为了允许安装而无需管理员身份，也可以用于特定于用户的安装。

# java - 将 Quartz 调度器置于待机模式

> ID：932817
> 
> 赞同：2
> 
> 时间：2009-05-31T20:42:51.827
> 
> 标签：java, scheduling, quartz-scheduler

您可以将 Quartz 调度程序置于待机模式。在此期间，所有触发器都不会触发正在执行的作业。但是如果standby(); 会发生什么？命令在执行过程中出现，假设它正在写入文件？

例子：

*// start() 之前在调度程序上调用过

scheduler.standby();

// 现在调度程序不会触发触发器/执行作业

// ...

调度程序.start();

// 现在调度程序将触发触发器并执行作业*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T20:46:15.453

我相信调用standby()只会停止触发器的进一步执行，它不会停止或中止任何已经执行的作业。

# python - 如何在运行时在 python 中检索变量的名称？

> ID：932818
> 
> 赞同：32
> 
> 时间：2009-05-31T20:44:07.567
> 
> 标签：python

有没有办法在运行时（从代码中）知道变量的名称？还是在编译过程中忘记了变量的名称（字节码与否）？

例如：

```
>>> 变异 = 15
>>> 打印变量。~~名字~~()
'变量'

```

**注意**：我说的是普通数据类型变量（`int`,`str`等`list`）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-31T20:52:27.703

不要忘记变量名，您可以通过自省访问变量（并查看您拥有哪些变量），例如

```
>>> i = 1
>>> locals()["i"]
1 
```

但是，因为 Python 中没有指针，所以如果不实际写入变量名，就无法引用变量。因此，如果您想打印变量名称及其值，您可以使用 via`locals()`或类似的函数。（`[i]`变成`[1]`并且没有办法检索`1`实际来自的信息`i`。）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-31T20:48:26.497

变量名在编译后的代码中保持不变（这就是例如`dir`内置代码的工作方式），但是那里的映射从名称到值，反之亦然。因此，如果有几个变量都值得，例如，`23`没有办法仅根据值来区分它们`23`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-05T09:59:55.037

这是我用来打印变量值的函数，它适用于本地和全局：

```
import sys
def print_var(var_name):
    calling_frame = sys._getframe().f_back
    var_val = calling_frame.f_locals.get(var_name, calling_frame.f_globals.get(var_name, None))
    print (var_name+':', str(var_val)) 
```

所以下面的代码：

```
global_var = 123
def some_func():
    local_var = 456
    print_var("global_var")
    print_var("local_var")
    print_var("some_func")

some_func() 
```

产生：

```
global_var: 123
local_var: 456
some_func: <function some_func at 0x10065b488> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-06-28T09:35:49.787

这适用于简单的数据类型（str、int、float、list 等）

```
def my_print(var_str) :
    print var_str+':', globals()[var_str] 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-04-08T18:11:55.933

这里有一个显示其参数名称的基本（可能很奇怪）函数......这个想法是分析代码并搜索对函数的调用（在**init**方法中添加它可以帮助找到实例名称，尽管使用更复杂的代码分析）

```
def display(var):
    import inspect, re
    callingframe = inspect.currentframe().f_back
    cntext = "".join(inspect.getframeinfo(callingframe, 5)[3]) #gets 5 lines
    m = re.search("display\s+\(\s+(\w+)\s+\)", cntext, re.MULTILINE)
    print m.group(1), type(var), var 
```

请注意：从调用代码中获取多行有助于以防调用被拆分，如下例所示：

```
display(
        my_var
       ) 
```

但会产生意想不到的结果：

```
display(first_var)
display(second_var) 
```

如果您无法控制项目的格式，您仍然可以改进代码以检测和管理不同的情况......

总的来说，我想静态代码分析可能会产生更可靠的结果，但我现在懒得检查它

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-30T11:36:24.800

你可以做到，只是不漂亮。

```
import inspect, sys

def addVarToDict(d, variable):
    lineNumber = inspect.currentframe().f_back.f_lineno
    with open(sys.argv[0]) as f:
        lines = f.read().split("\n")

    line = lines[lineNumber-1]

    varName = line.split("addVarToDict")[1].split("(")[1].split(",")[1].split(")")[0].strip()
    d[varName] = variable

d = {}

a=1

print d # {}
addVarToDict(d,a)
print d # {'a': 1} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-09T00:56:42.997

我从上面的帖子中尝试了以下链接，但没有成功：谷歌搜索返回了这个。

[http://pythonic.pocoo.org/2009/5/30/finding-objects-names](http://pythonic.pocoo.org/2009/5/30/finding-objects-names)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-31T21:31:11.823

就在昨天，我看到了一篇博客文章，其中的工作代码就是这样做的。这是链接：

[http://pyside.blogspot.com/2009/05/finding-objects-names.html](http://pyside.blogspot.com/2009/05/finding-objects-names.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-07T19:37:01.817

使用 f-string 格式的简单解决方案，它是 Python 3.6 及更高版本的本机：

```
vari = 15
vari_name = f"{vari=}".split("=")[0]
print(vari_name) 
```

产生：

```
vari 
```

# c++ - 我可以创建多少个 CRITICAL_SECTION？

> ID：932823
> 
> 赞同：9
> 
> 时间：2009-05-31T20:46:40.633
> 
> 标签：c++, multithreading, winapi, windows-xp, thread-safety

我可以初始化和使用的关键部分的数量是否有限制？

我的应用程序创建了许多（几千个）需要线程安全的对象。如果我在每个中都有一个关键部分，那会占用太多资源吗？

我认为因为我需要声明自己的 CRITICAL_SECTION 对象，所以我不会像使用 Win32 Mutex 或 Event 那样浪费内核资源？但我只是有一个挥之不去的疑问......？

老实说，对于我的应用程序来说，并不是所有这些对象都*需要*是线程安全的，但关键部分位于库中的一些低级基类中，我确实需要几千个！

我可能有机会修改这个库，所以我想知道是否有任何方法可以懒惰地创建（然后从那时起使用）关键部分，只有当我检测到对象正在从不同的线程使用它时创建于？或者这就是 Windows 会为我做的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-31T20:53:33.427

`CRITICAL_SECTION` *您可以声明的结构*的数量没有限制——它们只是最低级别的 POD 数据结构。*您可以使用 初始化*的数量可能有一些限制[`InitializeCriticalSection()`](http://msdn.microsoft.com/en-us/library/ms683472(VS.85).aspx)。根据文档，它可能会`STATUS_NO_MEMORY`在 Windows 2000/XP/Server 2003 上引发异常，但显然它可以保证在 Vista 上成功。在您初始化它们之前，它们不会占用任何内核资源（如果它们完全占用）。

如果您发现`STATUS_NO_MEMORY`引发了异常，则可以尝试仅在`CRITICAL_SECTION`给定对象有可能在多个线程中使用的情况下对其进行初始化。如果您知道特定对象将仅用于一个线程，请设置一个标志，然后跳过对`InitializeCriticalSection()`、`EnterCriticalSection()`、`LeaveCriticalSection()`和的所有调用`DeleteCriticalSection()`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-31T22:29:00.270

如果您仔细阅读[IntializeCriticalSectionWithSpinCount()](http://msdn.microsoft.com/en-us/library/ms683476(VS.85).aspx)的文档，很明显每个临界区都由一个 Event 对象支持，尽管临界区的 API 将它们视为不透明的结构。此外，对 dwSpinCount 参数的“Windows 2000”注释指出事件对象是“按需分配的”。

我不知道有任何文档说明什么条件满足“按需”，但我怀疑它是在线程进入临界区时阻塞之前创建的。对于具有自旋计数的临界区，可能直到自旋等待耗尽。

根据经验，我曾开发过一个应用程序，据我所知该应用程序至少创建了 60,000 个活动 COM 对象，每个对象都与自己的 CRITICAL_SECTION 同步。我从未见过任何表明我已用尽内核对象供应的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T14:36:18.850

Afaik Windows 上的大多数句柄/资源类型都受到内存或 maxint 的限制，无论哪个先出现。（我猜理论上可能会发生 64 位 maxint）。

您在这个主题上找到的有时乏味的文本通常只与 Win9x 相关，它有一些限制。（总共 64k 内核对象）

# c++ - 如何使用 Qt 获取系统代理？

> ID：932824
> 
> 赞同：2
> 
> 时间：2009-05-31T20:47:45.810
> 
> 标签：c++, qt, proxy

我有以下代码，我试图从中提取系统代理设置：

```
QList<QNetworkProxy> listOfProxies = QNetworkProxyFactory::systemProxyForQuery();
foreach ( QNetworkProxy loopItem, listOfProxies ) {
    qDebug() << "proxyUsed:" << loopItem.hostName();
} 
```

我只拿回一件物品，而且主机名是空白的。有什么我想念的想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-01T15:06:51.503

通过放置：

```
QNetworkProxyQuery npq(QUrl("http://www.google.com"));
QList<QNetworkProxy> listOfProxies = QNetworkProxyFactory::systemProxyForQuery(npq); 
```

我似乎得到了代理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-03T14:48:26.757

QNetworkProxyQuery npq(QUrl( **QLatin1String** (" [http://www.google.com](http://www.google.com) ")));

不要忘记使用 QLatin1String :)

# .net - 应用程序运行的 WCF 返回命令

> ID：932843
> 
> 赞同：0
> 
> 时间：2009-05-31T20:55:10.040
> 
> 标签：.net, wcf

在我正在设置的信息亭系统中，所有信息亭都与中央服务器通信以签入和接收更新命令。我不使用双 Http 通信，因为我无法保证客户端站点将允许哪些端口，因此始终从 Kiosk（客户端）启动通信。我目前有一个更新合同，它返回一个名为 KioskAction 的枚举，它代表信息亭可以执行的所有命令（UpdateClient、SendLogFile、UpdateSetting 等）。这工作得很好，但我想知道是否有更优雅的方式来处理这个问题。

Kiosk 上的当前更新方法看起来像......

```
var kioskAction = KioskService.Update(kioskId);
switch(kioskAction)
{
    case KioskAction.SendLogFile:
        KioskService.SendLogFile(kioskId, GetLogFile());
        break;
    case KioskAction.UpdateSettings:
        Setting[] settings = KioskService.GetKioskSettings(guid kioskId);
        UpdateSettings(settings);
        break;
    ...
} 
```

我的问题是，为了添加更多信息亭功能，我必须重建和重新部署信息亭应用程序和 WCF 服务。我正在考虑返回某种类型的脚本（可能是 IronPython），它实际上包含执行操作所需的代码。然后我可以通过向系统添加新脚本来添加新功能，而无需对 Kiosk 应用程序或 Kiosk 服务进行任何更改。

显然存在一些安全问题，因为 Kiosk 客户端本质上运行的是 Kiosk 服务返回的任何代码，因此，如果 Kiosk 服务受到破坏，所有 Kiosk 也可能受到影响。在朝这个方向前进之前，我还需要注意什么，或者我应该考虑什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T12:56:15.213

您可能还会考虑 Windows Workflow Foundation 工作流，而不是代码。如果您使用仅声明性工作流程（有时称为“仅 xoml”工作流程），您应该能够将它们放在目录中并一般激活它们。它旨在允许这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T11:57:27.330

我看到了一些风险。

1.  当已经有远程管理/更新工具时，您是否正在为您的目的构建一些特定的东西？这是一个虚荣的项目吗？您宁愿自己构建它也不愿重复使用已经存在的东西？
    也许在构建自己的 IronPython 远程和执行之前做一些额外的研究。
    *   一方面，请查看 PowerShell，特别是 powershell 托管功能（通过 RunSpace）。您可以将 powershell 代码发送到客户端并在WCF 客户端拥有[的 powershell RunSpace 中运行它。](http://channel9.msdn.com/ShowPost.aspx?PostID=318112)此外，不久前的[RemoteRunSpace 事情](http://www.hanselman.com/blog/ScriptBlockAndRunspaceRemotingInPowerShell.aspx)可能很有趣。不确定 Powershell v2 是否内置了此功能。如果有，它可能对您有用。
    *   [StockTrader](http://msdn.microsoft.com/en-us/netframework/bb499684.aspx)中的 ConfigService会更新应用程序设置，但不会“运行任意代码”。ConfigService的源代码和[Arch 文档](http://download.microsoft.com/download/4/8/6/486b4b4f-5a87-4b5c-beec-455290f83274/ConfigServiceTechnicalGuide.pdf)可用。
2.  如果您选择“运行任何代码”路线，请务必在系统中添加一个大的红色重置按钮，以防您的某个脚本没有完全按照预期执行，并导致 1000 个远程信息亭被隔离。

# javascript - JavaScript 事件处理程序在 3 秒后启动

> ID：932845
> 
> 赞同：2
> 
> 时间：2009-05-31T20:55:48.463
> 
> 标签：javascript, dom, javascript-events

我需要在关注图像 3 秒后启动事件处理程序。我应该怎么做？

此外，当我在图像的特定部分时，我需要触发另一个事件处理程序，比如图像的大致中间。我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T21:04:07.493

使用 javascript 的[setTimeout 和 setInterval](http://www.itnewb.com/v/Guide-to-JavaScript-Timers-with-setTimeout-and-setInterval)函数。

```
// alert after 2 seconds
setTimeout("alert('Hello World!')", 2000);

// alert every 2 seconds
setInterval("alert('Hello, world!')", 2000); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T21:23:53.773

JavaScript

```
var timeout;
function message(){
    alert('Hey there');
}

function start(){
    timeout = setTimeout(message,3000);
}

function stop(){
    clearTimeout(timeout);
} 
```

HTML

```
<img src="HappyCow.jpg" onmouseover="start()" onmouseout="stop()" /> 
```

这里的事件处理很粗糙（内联>.<），但我认为这可以帮助您入门。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T21:00:16.673

对于问题 #1：查看计时器 - 当图像处于焦点时（或鼠标悬停在其上等），您将启动它，然后在 3 秒（或任何其他时间段）后调用一个函数。该函数将在三秒钟后处理您想要执行的操作。（也许还要检查图像是否仍然“活跃”。）

对于问题 #2：一种方法是 Imagemaps，但可能还有其他/更好的选择。

希望这可以帮助！

# iphone - 调用 iPhone 静态库中包含的类别的方法会导致 NSInvalidArgumentException

> ID：932856
> 
> 赞同：35
> 
> 时间：2009-05-31T21:01:23.693
> 
> 标签：iphone, cocoa-touch, xcode, exception

我创建了一个静态库来存放我的一些代码，例如类别。

我在“UIView-Extensions.h”中有一个 UIViews 类别，名为 Extensions。

在这个类别中，我有一个方法叫做：

```
- (void)fadeOutWithDelay:(CGFloat)delay duration:(CGFloat)duration; 
```

在调试配置的模拟器上调用此方法可以正常工作。

但是，如果尝试在设备上运行应用程序，我会收到 NSInvalidArgumentException：

```
[UIView fadeOutWithDelay:duration:]: unrecognized selector sent to instance 0x1912b0
 *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[UIView fadeOutWithDelay:duration:]: unrecognized selector sent to instance 0x1912b0 
```

似乎出于某种原因 UIView-Extensions.h 未包含在设备构建中。

* * *

**我检查过/尝试过的**

我确实尝试为 NSString 包含另一个类别，并且遇到了同样的问题。

其他文件，如整个类和函数工作正常。这是一个***只***发生在类别中的问题。

我清理了所有目标，但没有解决问题。

我检查了静态库项目，类别包含在目标的“复制标题”和“编译源”组中。

静态库包含在主要项目“将二进制文件与库链接”组中。

我添加了静态库的另一个项目可以正常工作。

我没有运气删除并重新添加了静态库

-ObjC 链接器标志已设置

有任何想法吗？

* * *

**纳米输出**

```
libFJSCodeDebug.a(UIView-Extensions.o):
000004d4 t -[UIView(Extensions) changeColor:withDelay:duration:]
00000000 t -[UIView(Extensions) fadeInWithDelay:duration:]
000000dc t -[UIView(Extensions) fadeOutWithDelay:duration:]
00000abc t -[UIView(Extensions) firstResponder]
000006b0 t -[UIView(Extensions) hasSubviewOfClass:]
00000870 t -[UIView(Extensions) hasSubviewOfClass:thatContainsPoint:]
000005cc t -[UIView(Extensions) rotate:]
000002d8 t -[UIView(Extensions) shrinkToSize:withDelay:duration:]
000001b8 t -[UIView(Extensions) translateToFrame:delay:duration:]
         U _CGAffineTransformRotate
000004a8 t _CGPointMake
         U _CGRectContainsPoint
         U _NSLog
         U _OBJC_CLASS_$_UIColor
         U _OBJC_CLASS_$_UIView
         U ___CFConstantStringClassReference
         U ___addsf3vfp
         U ___divdf3vfp
         U ___divsf3vfp
         U ___extendsfdf2vfp
         U ___muldf3vfp
         U ___truncdfsf2vfp
         U _objc_enumerationMutation
         U _objc_msgSend
         U _objc_msgSend_stret
         U dyld_stub_binding_helper 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-09T20:02:59.647

唯一有效的解决方案是包括：

“-all_load”

在其他链接器标志中。

**编辑：**请务必将此标志添加到包括静态库在内的项目中，而不是添加到静态库本身。

我知道这不是正确的方法，但它现在有效。

这可能是 OS 3.0 的问题，因为这也是 Three20 的解决方法。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-31T22:39:24.947

不幸的是，由于哪些类别有效以及 Objective-C 运行时的动态特性，并不是所有的东西都适用于静态库。您收到此错误的原因是静态库中的类别实现从未真正链接到可执行映像，因为编译器无法知道在运行时将需要实现代码。

为了解决这个问题，您可以强制链接器从静态存档中复制任何和所有 Objective-C 类和类别图像的目标文件。缺点是您的可执行文件将包含您可能根本不使用的类的图像代码。要让链接器包含类别代码，请添加`-ObjC`到`OTHER_LD_FLAGS`Xcode 中的构建设置。您的类别实现现在将从静态存档复制到您的可执行文件，并且您不会得到运行时异常。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-06-11T00:17:25.557

我刚刚和一位苹果工程师谈过这个问题，这个问题已经在 ld 版本>100 中得到解决。这包含在 Xcode 4 中。他引导我完成了这个，我自己尝试了一下，确实修复了类别问题。

取出“-all_load”并使用新链接器返回构建设置中的“-ObjC”。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-08-07T13:27:09.533

如果您使用的是 Xcode 3.2，则可以避免使用 -all_load 而是仅对有问题的库使用 -force_load，这应该会更有效。

这在最近更新的 Apple 技术 QA 中有所描述：http: [//developer.apple.com/mac/library/qa/qa2006/qa1490.html](http://developer.apple.com/mac/library/qa/qa2006/qa1490.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-10T08:09:04.630

`-all_load`链接类别需要`-force_load`链接器标志的问题已[在 LLVM 中得到修复](http://llvm.org/bugs/show_bug.cgi?id=7431)。该修复程序作为 LLVM 2.9 的一部分包含该修复程序的第一个 Xcode 版本是与 LLVM 3.0 一起发布的 Xcode 4.2。**使用 Xcode 4.2 时不再需要上述修复。`-ObjC`链接 ObjC 二进制文件时仍然需要该标志**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-24T03:38:04.810

我最近遇到了这个问题。当我注意到另一个类别我有 DID 工作时，我无法让 -all_load 工作。我对这个类别很懒惰，并将其包含在另一个文件中。

我最终创建了一个虚拟类（没有方法、实例变量），并将我的类别的实现包含在该虚拟类的 .m 文件中。这样做之后，即使我删除了 -all_load 标志，我的类别也开始工作。

这是在 iPhone OS 3.1.3 上。

这当然不是修复它的正确方法，但它似乎有效。

我的（琐碎）类别的完整示例代码在我的[博客上。](http://iphonedevelopmentexperiences.blogspot.com/2010/03/categories-in-static-library.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-30T18:28:15.133

我只是遇到了同样的问题，但是添加所描述的标志（-ObjC、-all_load、-force_load）的任何组合都不起作用。

原来我在将文件添加到项目时没有选中“添加到目标”框。我从项目中删除了文件并再次添加它们，这次确保选中了该框。这解决了问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-13T22:06:09.697

在过去，我能够强制使用 -u .objc_category_name_UIView_Extensions 链接类别，但 3.0 开发环境已损坏，唯一的选择似乎是 -all_load。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-04-21T10:11:20.903

我的静态库中的类别也有同样的问题。就我而言，“-all_load”没有帮助，因为它会导致大量构建错误（我的静态库是另一个私有 C/C++ 库的包装器）。

[我通过http://iphonedevelopmentexperiences.blogspot.com/2010/03/categories-in-static-library.html](http://iphonedevelopmentexperiences.blogspot.com/2010/03/categories-in-static-library.html)建议的 hack 解决了这个问题，它只涉及向类别文件添加一个虚拟（空）类定义。使用这个 hack，我保留了“-ObjC”，但在应用程序链接器设置中删除了“-all_load”，它在设备上运行良好。

# iphone - 从 TableViewCell 中的 URL 预加载图像

> ID：932859
> 
> 赞同：1
> 
> 时间：2009-05-31T21:03:59.070
> 
> 标签：iphone, image, preload

我正在为 iPhone 制作一个简单的 rss 阅读器。饲料（[http://feeds.feedburner.com/foksuk/gLTI](http://feeds.feedburner.com/foksuk/gLTI)) 包含对我想在 TableView 中显示的图像的引用。默认情况下，据我了解，iPhone 仅在需要时尝试加载图像：它只会加载显示的行的图像。只有当用户向下滚动时，它才会开始加载需要显示的那些。对？现在，由于图像是从网上下载的（它们不是太大，但仍然），我的 TableView 的滚动结结巴巴。这是在模拟器中，所以在设备本身上只会更糟。幸运的是，这个特定的提要只列出了该博客的最新 12 个条目。所以我想我应该可以先下载一个缓存所有的图像，这样它们就可以从内存中加载，而不是从 URL 中加载。这里的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T22:56:55.190

我遇到了同样的问题，我的 TableView 必须在显示单元格之前下载每个图像。就像您说的那样，它会导致滚动速度大大减慢。您需要做的是在后台下载图像，然后在完成下载后将它们插入单元格中。这就是应用商店应用程序的做法。

这篇文章包含您需要知道的所有内容，包括您可以立即使用的类文件：

[http://www.markj.net/iphone-asynchronous-table-image/](http://www.markj.net/iphone-asynchronous-table-image/)

# regex - 用于解析请求参数的正则表达式

> ID：932865
> 
> 赞同：1
> 
> 时间：2009-05-31T21:06:42.870
> 
> 标签：regex, pcre

我正在寻找一个可以解析以下形式的字符串的 perl 兼容正则表达式：

参数 1=值 1&...&参数 2=值 2&...

并仅提取 param1 和 param2 的值。但

1.  param2 可能在 param1 之前
2.  可能没有 param1 或 param2
3.  param1 或 param2（或两者）可能有空值，即 param1=&...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T21:18:50.913

我不会费心编写您自己的请求解析器。只需使用[`CGI.pm`](http://search.cpan.org/dist/CGI.pm/CGI.pm).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T21:20:13.733

```
/[?&]([^=]+)=([^=&]+)/g 
```

这将匹配任何由 = 分隔的非 = 字符，并将它们放入 $1 和 $2 中。

或者...

```
my %argsHash = split(/=|&/, $args); 
```

这会给你一个带有参数和值的散列，看起来效果很好，但是 CGI.pm 是一个更好的主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T21:12:30.380

`/(.*?)=(.*?)&/`循环和捕获`$1`，`$2`应该可以工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T02:04:42.910

If this is for C++, consider using an existing CGI library that parses the query parameters for you instead of reinventing that sort of thing yourself.

One such library is `cgic`, a CGI library for C: [http://www.boutell.com/cgic/#functions](http://www.boutell.com/cgic/#functions)

# c# - 如何使用 web 服务通信验证调用者

> ID：932866
> 
> 赞同：3
> 
> 时间：2009-05-31T21:07:22.790
> 
> 标签：c#, asp.net, web-services

我继承了一个系统，它以数据集的形式从 web 方法获取数据。数据可能很敏感。对此让我印象深刻的一件事是，有些方法无法知道或检查调用者是谁，而另一些方法则需要整数来识别调用者。这个整数从 0 开始并且是连续的并且与不同的公司/数据集相关联。显然不够好。（我很容易通过猜测数字来查看我不应该访问的数据

我的问题是，是否有一种最佳实践方式来验证呼叫者，改进这个系统

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T21:26:02.817

它是什么类型的服务？这些天，我将它写为 WCF，并使用任何常规身份模型进行身份验证（我通常使用 TransportWithMessageCredential - 即在正文中带有用户名/密码的 SSL）。然后您可以通过`Principal`( `Thread.CurrentPrincipal.Identity.Name`) 来检查身份。

对于 SOAP 服务，您可以使用 SOAP 标头进行身份验证，也可以将身份信息作为方法参数包含在内 - 可以是用户名/密码对，也可以是可以解析以获取身份的单独身份令牌。在任何情况下，您都应该只通过 SSL 等安全传输“按原样”传递身份信息。还有其他技术不需要传递密码，但它们更复杂（特别是如果涉及多个域等）；kerberos 或联合安全是选项。就个人而言，我保持简单，因为并非所有客户端都可以*使用*联合等 - 但大多数客户端可以通过 SSL 传递用户名/密码对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T21:22:15.163

如果您可以控制 Web 服务代码，则可以对其进行修改以要求身份验证或创建代理。

请阅读这篇[文章](http://www.codeplex.com/WCFSecurityGuide/Wiki/View.aspx?title=Ch%2013%20-%20Internet%20%u2013%20WCF%20and%20ASMX%20Client%20to%20Remote%20WCF%20Using%20Transport%20Security%20(Trusted%20Subsystem%2C%20HTTP)&referringTitle=Home)。

# c# - C# 不区分大小写的字符串

> ID：932870
> 
> 赞同：0
> 
> 时间：2009-05-31T21:10:50.210
> 
> 标签：c#, string, case-insensitive

考虑下面的类
- 我可以做任何事情来实现不区分大小写的字符串吗？

```
public class Attibute
{
    // The Name should be case-insensitive
    public string Name
    {
        get;
        set;
    }

    public Attibute()
    {
    }
}

public class ClassWithAttributes
{
    private List<Attributes> _attributes;

    public ClassWithAttributes(){}

    public AddAttribute(Attribute attribute)
    {
        // Whats the best way to implement the check?
        _attributes.add(attribute);
    }
} 
```

[HTML 4 文档的结构](http://htmlhelp.com/reference/html40/structure.html#elements)

我已将课程编辑为更加客观和具体

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T21:16:41.010

你不能有不区分大小写的属性——你只能有不区分大小写的操作，比如比较。如果有人访问 XHtmlOneDTDElementAttibute.Name，他们将得到一个字符串，无论它是用什么大小写创建的。

每当您使用 .Name 时，您都可以以忽略字符串大小写的方式实现该方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T21:42:01.223

在回答重组后的问题时，您可以这样做：

```
public class Attribute { public string Name { get; set; } }

public class AttributeCollection : KeyedCollection<string, Attribute> {
    public AttributeCollection() : base(StringComparer.OrdinalIgnoreCase) { }
    protected override string GetKeyForItem(Attribute item) { return item.Name; }
}

public class ClassWithAttributes {
    private AttributeCollection _attributes;

    public void AddAttribute(Attribute attribute) {
        _attributes.Add(attribute);    
        //KeyedCollection will throw an exception
        //if there is already an attribute with 
        //the same (case insensitive) name.
    }
} 
```

如果您使用它，您应该将其`Attribute.Name`设为只读或在更改时调用 ChangeKeyForItem。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T21:19:04.907

这取决于您要对字符串做什么。

如果要不考虑大小写比较字符串，请调用`String.Equals`with `StringComparison.OrdinalIgnoreCase`。如果要将它们放入字典中，请制作字典的 comparer `StringComparer.OrdinalIgnoreCase`。

因此，您可以制作如下函数：

```
public class XHtmlOneDTDElementAttibute : ElementRegion {
    public bool IsTag(string tag) {
        return Name.Equals(tag, StringComparison.OrdinalIgnoreCase);
    }

    // The Name should be case-insensitive
    public string Name { get; set; }

    // The Value should be case-sensitive
    public string Value { get; set; }
} 
```

如果您想要更具体的解决方案，请告诉我您在使用该`Name`物业做什么

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T21:19:18.273

好吧，在浏览了规范之后，我对此的看法是，您不需要做任何事情来使字符串属性不区分大小写。无论如何，这个概念并没有真正的意义：字符串不区分大小写或不区分大小写；对它们的操作（如搜索和排序）是。

（我知道 W3C 的 HTML 建议基本上是这样说的。措辞很糟糕。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T21:34:01.677

或者，您可能希望使属性始终为大写，就像这样。

```
public class XHtmlOneDTDElementAttibute : ElementRegion {
    string name;

    // The Name should be case-insensitive
    public string Name {
        get { return name; }
        set { name = value.ToUpperInvariant(); }
    }

    // The Value should be case-sensitive
    public string Value { get; set; }
} 
```

# svn - svn 仓库创建

> ID：932876
> 
> 赞同：1
> 
> 时间：2009-05-31T21:15:51.153
> 
> 标签：svn

我已经安装了 SVN Tortoise 并想创建一个存储库。我按照手册并在命令提示符的正确目录上键入“svnadmin ........”。它不识别单词 svnadmin: 'svnadmin' 不被识别为内部或外部命令............

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T21:22:00.000

Tortoise 不安装命令行工具。要创建新存储库：

*   使用资源管理器创建目录
*   切换到目录
*   右键单击空目录窗格
*   从 Tortoise 菜单中选择“在此处创建存储库”

如果您需要命令行工具，可以[在此处](http://www.sliksvn.com/en/download/)获取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T21:22:12.573

您可以通过创建一个空文件夹来创建存储库，然后打开它并右键单击并选择 TortoiseSVN->在此处创建存储库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T21:17:47.530

您应该相应地设置您的 %PATH% 变量。虽然，我想知道为什么安装程序没有为您执行此操作。确保 TortoiseSVN 也确实安装了 svn 工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T21:25:39.137

如果您想从命令行使用 TortoiseSVN，请查看[本教程](http://www.methylblue.com/blog/using-tortoisesvn-from-the-command-line/)。bash 脚本也应该很容易移植到 Windows。你基本上用一些参数调用“Program Files/TortoiseSVN/bin/TortoiseProc.exe”。

尽管您似乎无法以这种方式创建存储库，而只能执行诸如提交/更新之类的基本任务。

# cherrypy - 任何文件对象的serve_file

> ID：932892
> 
> 赞同：1
> 
> 时间：2009-05-31T21:24:02.040
> 
> 标签：cherrypy

在cherrypy.lib.static.py 中有一个方法：

```
 serve_file(path, content_type=None, disposition=None, name=None) 
```

其中参数“path”必须是真实文件（绝对路径）。是否有类似的东西可以为任何 Python 文件对象提供服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T21:41:22.147

从研究[http://www.cherrypy.org/browser/trunk/cherrypy/lib/static.py](http://www.cherrypy.org/browser/trunk/cherrypy/lib/static.py)我不得不说，不：该`serve_file`功能是“单片的”，并且它自己的`bodyfile = open(path, 'rb')`，似乎也没有任何替代方式。可惜，因为很容易重构函数并添加另一个例如`serve_open_file`来覆盖您的情况，同时将两者都委托给“硬”逻辑的内部函数，例如多部分/字节范围服务。可能值得您在cherrypy.org 上打开一个功能请求（“增强票证”）——可能不是一个杀手级功能，但我可以看到用例，并且实施它对于cherrypy 的人来说并不难（访问[他们的网站](http://www.cherrypy.org/newticket)并按照页面上的说明“登录”到它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-12T17:05:18.193

只要您的文件或类似文件的对象是可迭代的，只需从处理函数返回它而不是字符串。

**更新：**

要将其用作下载，请设置 Content-Type 和 Content-Disposition 标头，如下所示：

```
cherrypy.response.headers["Content-Type"] = "application/x-download"
cd = 'attachment; filename="%s"' % name
cherrypy.response.headers["Content-Disposition"] = cd 
```

或者，使用`serve_fileobj`最新版本中的功能`cherrypy/lib/static.py`，它可以为您做更多的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-08T19:58:28.440

重新审视[http://www.cherrypy.org/browser/trunk/cherrypy/lib/static.py](http://www.cherrypy.org/browser/trunk/cherrypy/lib/static.py)，它看起来`serve_fileobj`正是您想要的。

编辑：我现在已经尝试过了，它只将文件内容呈现到屏幕上，而不是允许下载文件。

# variables - 在同一台服务器上运行 JBoss 4.2.3 和 JBoss 5.1

> ID：932904
> 
> 赞同：0
> 
> 时间：2009-05-31T21:30:45.070
> 
> 标签：variables, jboss, environment

我想在同一台服务器上运行 JBoss 4.2.3 和 JBoss 5.1，但不能同时运行。我只需要能够在两者之间来回切换进行测试，所以我不需要更改端口或类似的东西。我的问题是 JBOSS_HOME 环境变量。当我设置 /soft/JBoss-4.2.3.GA 目录和 /soft/JBoss-5.1.0.GA 目录时，我可以运行各自的 bin run.sh 命令，但是，两者都尝试使用 $JBOSS_HOME 和$PATH 环境变量，设置为首次安装 (JBoss-4.2.3)。那么，如何设置单独的环境变量呢？或者告诉我的新 JBoss 5.1 安装为 JBOSS_HOME 使用另一个环境变量？我将如何让这两个一起运行？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T21:55:43.897

一个快速的解决方案是将 run.sh 中的 $JBOSS_HOME 和 $PATH 变量设置为每个 JBoss 实例的相应目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T14:05:50.543

在这种情况下，最好的解决方案是使用虚拟 IP 接口，您将保留默认端口，只需更改 de IP 地址。

要启动 jboss 绑定到另一个 IP，只需在 run.sh 中添加此参数（或在 run.conf 中持久）：

```
sh run.sh -b 192.168.0.1 
```

而另一个实例只是开始指向另一个 IP

```
sh run.sh -b 192.168.0.2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-26T15:12:20.537

我最近遇到了类似的问题，我的解决方法是为每个 JBoss AS 版本提供一对包装脚本。

# security - 是否有从登录对话框中删除用户字段的安全方法？

> ID：932910
> 
> 赞同：2
> 
> 时间：2009-05-31T21:35:38.913
> 
> 标签：security, authentication, passwords

浏览 Coding Horror，我看到[了这篇](http://www.codinghorror.com/blog/archives/000413.html)关于从登录对话框中删除用户字段的文章。

这是一个有趣的概念，尽管它是 2005 年的旧概念。不过，我开始思考它并想知道：

您将如何以安全的方式做到这一点？

如果您通过密码来识别用户，这意味着所有密码都必须是唯一的 - 是吗？

如果所有密码都必须是唯一的，当有人输入一个已经在使用的密码时，你会怎么做？

你不能告诉他们它已经在使用，因为这会泄露其他人的登录信息。

我想不出一种方法可以以安全的方式实现这一点……有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T22:01:56.910

您不是通过密码*来识别*用户，而是通过用户名来识别他们。您通过密码对用户进行*身份验证。*想一想通过密码识别是什么意思。我加入系统，他让我输入新密码。我说'foo'，他说'foo 已经在使用中'。我说“tyvm”，然后打开登录窗口。当出现提示时，我只需输入“foo”，他就会说“欢迎总统先生”......

不，绝对不能要求*密码*是唯一的，这在任何系统中都是一个巨大的安全漏洞，因为它**依赖于信息泄露来运行**：通过重复你泄露某人的密码。即使使用名称/密码组合，一旦您透露“密码正在使用”，我所要做的就是遍历帐户列表，尝试您刚刚向我透露的密码，一种组合*就会*成功。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T21:42:00.677

我的第一个想法，也是文章中提到的，是增加密码复杂性要求以避免冲突。

16 字节的 GUID 可以很好地避免冲突（每颗星可以有 6.8×1015 GUID），所以应该不会太难。显然，人工生成的输入并不那么随机，但是如果您添加足够的要求，例如小写/大写/数字/符号/长度，它可能会运行得很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T21:45:38.267

好吧，我想您可以寻找其他一些“唯一化”数据，与密码结合使用。对于 Web 应用程序，这可能是插入到 cookie 中的哈希值，来自之前的访问。很难保证唯一性（例如，来自单个计算机上的单个配置文件的多个用户）。

我的银行基本上采用这种方法，使用我的公共 IP 地址。实际上，这有点烦人。每次我的 DHCP 租约到期时，我的银行网站都会“无法识别”我，并在我获得标准用户名/密码屏幕之前询问几个安全问题之一。

多因素安全性使用类似的东西（硬件密钥或硬件提供的标识符，结合密码）。

这种方法让我觉得过于聪明，而且聪明很少是接近安全系统的正确方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T21:41:21.583

我相信你做不到。

通过输入您的用户名，您提供了您的身份，通过输入您的密码，您为服务器提供了一种验证此身份的方法。

除非您有其他确定身份的方法（IP、钥匙卡等），否则两者都是必需的

基本上你不能指望任何人相信你就是你所说的那样，当你*不*说你是谁时！

# sql-server - 什么时候有一个身份列不是一个好主意？

> ID：932913
> 
> 赞同：8
> 
> 时间：2009-05-31T21:36:44.667
> 
> 标签：sql-server, performance

在只需要 1 列作为键并且该列中的值*可以*是整数的表中，什么时候不应该使用标识字段？

相反，在同一个表和列中，您何时会手动生成其值，并且您不会为每条记录使用自动生成的值？

我想当表中有很多插入和删除时会出现这种情况。我对吗？还有哪些其他情况？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T21:51:56.507

如果您已经解决了[Great Primary Key Debacle](http://en.wikipedia.org/wiki/Surrogate_key)的代理问题，那么我找不到不使用身份密钥的单一理由。通常的替代方案是 guid（它们有很多缺点，主要来自大小和随机性）和应用层生成的密钥。但是在应用程序层创建代理键比看起来要困难一些，而且也不包括与应用程序无关的数据访问（即批量加载、导入、其他应用程序等）。一种特殊情况是分布式应用程序，此时 guid 甚至顺序 guid 可能会为站点 id + 身份密钥提供更好的替代方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-31T21:39:52.943

我想如果您要创建一个多对多链接表，其中两个字段都是[外键](http://en.wikipedia.org/wiki/Foreign_key)，则不需要标识字段。

现在我想大多数[ORM 都](http://en.wikipedia.org/wiki/Object-relational_mapping)希望每个表中都有一个标识字段。一般来说，提供一个是一种很好的做法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T22:12:35.327

我不确定我是否足够了解您的上下文，但我将您的问题解释为：

“如果我需要数据库创建一个唯一列（无论出于何种原因），它什么时候不应该是一个单调递增的整数（身份）列？”

在这些情况下，没有理由使用 DBMS 提供的工具以外的任何东西。在您的情况下（SQL Server？），这是一个身份。

除了：

如果您需要将表与其他来源的数据合并，请使用 GUID，这将防止重复键发生冲突。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T22:14:22.547

如果您需要合并数据库，则无需重新生成密钥会容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T01:20:04.450

不想要身份字段的一种情况是一对一的关系。辅助表将具有与主表相同的值作为其主键。在这种情况下拥有身份字段的唯一原因似乎是满足 ORM。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T21:49:51.613

在插入标识列时，您不能（通常）指定值，例如，如果将“id”列指定为标识，则以下 SQL 将失败：

```
INSERT INTO MyTable (id, name) VALUES (1, 'Smith') 
```

为了执行这种插入，您需要为该表启用 IDENTITY_INSERT - 这并不打算正常启用，并且只能在任何时间点对数据库中最多 1 个表启用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-01T00:34:24.700

如果我需要一个代理，我会根据对全局唯一性的需要使用 IDENTITY 列或 GUID 列。

如果存在自然主键，或者主键定义为其他外键的唯一组合，那么我通常没有 IDENTITY，也不会将其用作主键。

有一个例外，即我正在使用审计触发器跟踪的快照配置表。在这种情况下，通常有一个逻辑“主键”（通常是快照的日期和行的自然键——比如行是配置记录的成本中心或总帐帐号），而不是使用自然键“主键”作为主键，我添加一个 IDENTITY 并将其设为主键，并对日期和自然键创建唯一索引或约束。虽然理论上日期和自然键不应该改变，但在这些表中，如果用户这样做而不是添加新行并删除旧行，我想要审计（这反映了对其主键标识的行的更改) 以真正反映行中的变化 - 而不是键的消失和新键的出现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-01T01:30:54.273

我最近在 C# 中实现了一个 Suffix Trie，它可以索引小说，然后允许以极快的速度完成搜索，与搜索字符串的大小成线性关系。部分需求（这是一个家庭作业）是使用离线存储，所以我使用了 MS SQL，并且需要一个结构来表示表中的节点。

我最终得到了以下结构：NodeID Character ParentID 等，其中 NodeID 是主键。

出于两个主要原因，我不希望将其作为自动递增标识来完成。

1.  将 NodeID 添加到数据库/数据表后，如何获取它的值？
2.  在生成我自己的 ID 时，我想要更多的控制权。

# asp.net-ajax - ASP.net Ajax：Canlendar 扩展器日期范围

> ID：932914
> 
> 赞同：1
> 
> 时间：2009-05-31T21:38:08.347
> 
> 标签：asp.net-ajax

有没有办法使用 ASP.net 日历扩展器来限制日期范围？

例如，我有一个日历扩展器附加到一个文本框，该文本框是一个“开始日期”供用户选择，然后另一个文本框使用日历扩展器调用“结束日期”。

当用户选择开始日期为 2009 年 5 月 31 日时，结束日期只能是 2009 年 5 月 31 日（即 2009 年 6 月 27 日）的 30 天。无论用户选择哪个日期，用户都只能选择开始日期后 30 天内的结束日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T10:23:03.480

不，你不能。不过，您可以：

1.  添加 RangeValidator 以验证范围（不限制，但告诉用户他错了 :)） - [http://www.dotnetcurry.com/ShowArticle.aspx?ID=149](http://www.dotnetcurry.com/ShowArticle.aspx?ID=149)

2.  如此处所述使用 MaskedEdit：[http ://forums.asp.net/p/1205865/2112772.aspx#2112772](http://forums.asp.net/p/1205865/2112772.aspx#2112772)

# search-engine - 为什么 M# 比 C# 更难谷歌？

> ID：932915
> 
> 赞同：1
> 
> 时间：2009-05-31T21:39:23.523
> 
> 标签：search-engine, google-search

我刚才在对另一个题为“[有效谷歌搜索短名称”的问题的评论中阅读](https://stackoverflow.com/questions/930488/effective-googling-for-short-names)

> C# 对 Google 来说一点也不差。顺便说一句，如果它被称为 M#，那就更难了*。*

为什么？我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-31T21:55:20.917

事实证明我错了。我原*以为*C# 恰好受益于对音调的理解——搜索“G#”会发现很多关于 G# 的音调的结果。（顺便说一句，这是通过实验证明的——尽管我在谷歌工作，但我对搜索引擎一无所知。至少，不是在这方面。）

但是，在这种情况下，C# 不仅受益于音乐键方面，而且 Google 自己的帮助页面解释了[C# 和其他编程语言是特殊情况的](http://www.google.com/support/websearch/bin/answer.py?answer=136861#exceptions_punctuations)：

> **不被忽略的标点符号**
> 
> *   具有特定含义的流行术语中的标点符号，例如 [ C++ ] 或 [ C# ]（两者都是编程语言的名称），不会被忽略。
> *   美元符号 ($) 用于表示价格。[ nikon 400 ] 和 [ nikon $400 ] 会给出不同的结果。
> *   连字符 - 有时用作表示它周围的两个单词非常紧密连接的信号。（除非 - 之后没有空格，而在它之前有一个空格，在这种情况下它是一个负号。）
> *   下划线 _ 在连接两个单词时不会被忽略，例如 [ quick_sort ]。

知道理论语言“M#”需要多长时间才能被搜索到会很有趣……但我不会开始在公共论坛上推测这一点:)

[（请注意，当您在Google 中搜索 Spec#](http://www.google.co.uk/search?q=spec%23)时，Spec# 主页作为*第二个*链接出现。至少它在那里并且非常突出。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T21:52:19.813

我会根据我的评论提出我的意见。

正如其他人所建议的那样，谷歌会忽略特殊字符。但是由于音符 C# 可能允许搜索“C# 中的某些音乐”，C# 可能在不被忽略（或至少变成“C”）方面处于领先地位。M# 不会因此受益。

# .net - 任何人都可以推荐一个 .Net 开源替代 Windows Workflow 吗？

> ID：932924
> 
> 赞同：12
> 
> 时间：2009-05-31T21:42:01.257
> 
> 标签：.net, open-source, workflow-foundation

.Net 堆栈中的 Windows 工作流有哪些替代方案？如果您使用过这些解决方案，是什么让您选择了 Windows Workflow，这是一个不错的选择。

* * *

更新：

我继续选择了由 Nicholas Blumhardt 创建的[stateless 。](http://blogs.msdn.com/nblumhardt/archive/2009/04/16/state-machines-in-domain-models.aspx)这是对域中的状态进行建模的一种非常简单的方法。以下是谷歌提供的示例代码：

```
var phoneCall = new StateMachine<State, Trigger>(State.OffHook);

phoneCall.Configure(State.OffHook)
    .Allow(Trigger.CallDialed, State.Ringing);

phoneCall.Configure(State.Ringing)
    .Allow(Trigger.HungUp, State.OffHook)
    .Allow(Trigger.CallConnected, State.Connected);

phoneCall.Configure(State.Connected)
    .OnEntry(t => StartCallTimer())
    .OnExit(t => StopCallTimer())
    .Allow(Trigger.LeftMessage, State.OffHook)
    .Allow(Trigger.HungUp, State.OffHook)
    .Allow(Trigger.PlacedOnHold, State.OnHold);

phoneCall.Configure(State.OnHold)
    .SubstateOf(State.Connected)
    .Allow(Trigger.TakenOffHold, State.Connected)
    .Allow(Trigger.HungUp, State.OffHook)
    .Allow(Trigger.PhoneHurledAgainstWall, State.PhoneDestroyed); 
```

如您所见，状态机使用泛型对状态及其各自的触发器进行建模。换句话说，您可以使用枚举、整数、字符串等来满足您的需求。状态机的每个状态都可以配置有条件触发器，这些触发器将根据特定条件触发。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T08:16:10.613

**在某些情况下**， Windows Workflow Foundation对我来说**有点矫枉过正**。然后，实现自己的工作流引擎变得更加容易和简单。

 **示例参考：

*   [CodePlex 上的简单状态机项目](http://www.codeplex.com/SimpleStateMachine)
*   [Google 代码上的无状态](http://code.google.com/p/stateless/)

# linq-to-sql - ADO.NET - 实体数据模型与 LINQ To SQL

> ID：932927
> 
> 赞同：1
> 
> 时间：2009-05-31T21:46:23.727
> 
> 标签：linq-to-sql

我正在尽力了解“ADO.NET - 实体数据模型”和“LINQ To SQL”之间的区别，但我无法弄清楚。有人可以解释一下两者之间的区别以及优缺点吗？

谢谢弗兰克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T21:55:02.943

Linq to SQL 实际上是 Linq 的概念证明。请参阅[LINQ to SQL 的起源](http://blogs.msdn.com/mattwar/archive/2007/05/31/the-origin-of-linq-to-sql.aspx)。微软正在大力支持 Entity Framework，尽管我相信它还没有准备好迎接黄金时段。

无论如何，[这篇 StackOverflow 帖子](https://stackoverflow.com/questions/8676/entity-framework-vs-linq-to-sql)提供了一些关于差异的额外细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T21:59:03.653

据说 Linq to SQL 已经死了（不过我不这么认为——它受到了开发社区的好评）。如果您愿意，实体框架是它的继任者。它可以访问更多的数据源（更多的数据库类型，以及不同类型的源，如报告服务、商业智能等）。它比 Linq to SQL 复杂得多，并且具有更陡峭的学习曲线，例如 EF 允许一个类-多表映射。EF 无法实现其他事情，例如指定延迟加载——这只是 Linq to SQL。

# ruby-on-rails - Rails：如何获取 /users/2/events/2009-02.html 之类的 url

> ID：932931
> 
> 赞同：1
> 
> 时间：2009-05-31T21:49:05.827
> 
> 标签：ruby-on-rails, ruby, rest

出于缓存目的，我不能拥有像 /users/2/index?month=2009-02 这样的网址。这种方法的问题是，如果我进行页面缓存，那么即使 /users/2/index?month=2009-03 也会返回相同的页面。

为了解决缓存问题，我想要像 /users/2/events/2009-02.html 这样的 url。我已经将用户定义为一个宁静的资源。

地图资源：用户

有谁知道如何获取 /users/2/events/2009-02.html 之类的 url，它将映射到

控制器 = 用户操作 = 事件 id = 2 或 user_id = 2 个月 = 2009-02

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-01T00:40:13.533

在应用程序的路由文件中，您可以像这样设置命名路由：

```
map.user_events '/users/:user_id/events/:month.html',
                :controller => :users, :action => :events,
                :requirements => {:month => /[0-9]{4}-[0-9]{2}/} 
```

Rails 3 中的路由 DSL 发生了很大变化。现在你可以做一些类似这样的事情：

```
get '/users/:user_id/events/:month.html' => 'users#events',
    :constraints => {:month => /[0-9]{4}-[0-9]{2}/} 
```

这里有更多关于路由的信息：http: [//guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

# asp.net - 来自 IIS7 上的 ASP.NET 应用程序的 FTP 失败

> ID：932939
> 
> 赞同：0
> 
> 时间：2009-05-31T21:51:53.030
> 
> 标签：asp.net, iis-7, ftp

我有一个问题，只有当我从 IIS 运行我的应用程序时才会出现。

我正在尝试从我的 ASP.NET 应用程序 FTP 到外部站点。

我一般可以从服务器 FTP，但不能从我的应用程序。我的请求超时。

我网站的所有者现在设置为具有完全控制权的 IIS_IUSRS 用户。

有谁知道是什么让我无法成功？

任何帮助都会非常感激。

我的截止日期是在 12 小时内，我被彻底搞砸了……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T22:01:06.070

快速修复可能是将 IIS 使用的匿名用户设置为*您的*用户帐户，而不是 IUSR 帐户（在 IIS 中）。这似乎是一个权限问题。

第二个赌注是使用 Wireshark/Etherreal 之类的工具，检查是否与 FTP 站点建立了任何连接，然后从那里进行调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T22:12:56.170

我找到了解决方案

Windows 防火墙和非安全 FTP 流量

可以使用 netsh 命令从命令行配置 Windows 防火墙。需要 2 个简单的步骤来设置 Windows 防火墙以允许不安全的 FTP 流量

1）在防火墙上打开21端口

netsh advfirewall 防火墙添加规则名称="FTP (no SSL)" action=allow protocol=TCP dir=in localport=21

2) 激活 FTP 的防火墙应用程序过滤器（又名有状态 FTP），它将动态打开数据连接端口

netsh advfirewall 设置全局 StatefulFtp 启用

我真的不知道那只是做了什么，但它成功了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-16T09:38:39.647

同样的问题解决**UsePassive**。也许您可以在防火墙上为 FTP 添加允许端口 20,21（对我来说不是必需的）。

```
FtpWebRequest reqFTP;
reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(@"ftp://ftp.example.com/"));
reqFTP.UseBinary = true;
reqFTP.Credentials = new NetworkCredential("user", "password");
reqFTP.Proxy = null;
reqFTP.KeepAlive = false;
reqFTP.UsePassive = true; 
```

# dns - 使用 WMI 创建 DNS 条目

> ID：932942
> 
> 赞同：1
> 
> 时间：2009-05-31T21:52:15.540
> 
> 标签：dns, wmi

是否可以使用 WMI (Windows Management Instrumentation) 创建 DNS 条目？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T22:13:39.350

也许这会有所帮助：**[添加 DNS 资源](http://msdn.microsoft.com/en-us/library/ms682130(VS.85).aspx#_dns_add_a_resource_record)**

**编辑：**这是一个可能有用的 VBScript[片段](http://www.winscripter.com/WSH/ADSI/272.aspx)

```
 var sHostName = "SomeMachine"
 var strRRsufix    = ". IN A 192.168.51.200";  //some ip address
 var strRR= sHostName + strRRsufix;
 var objDNS       = GetObject("winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\MicrosoftDNS");
 var objRR        = objDNS.Get("MicrosoftDNS_ResourceRecord");
 var objDNSServer = objDNS.Get("MicrosoftDNS_Server.Name=\".\"");
 objRR.CreateInstanceFromTextRepresentation(objDNSServer.Name, strDomain, strRR); 
```

# entropy - 数字的哪一部分有更多的熵？

> ID：932946
> 
> 赞同：2
> 
> 时间：2009-05-31T21:53:55.240
> 
> 标签：entropy, information-theory

给定来自某个来源的序列 pf 数字`N`[1] `, N`[2] `, N`[3]`...`，而不是 PRNG，而是说传感器或某种类型的记录数据，假设这样处理它是否安全

> `N`[`n`]`/ B = Q`[n] `Rem M`[`n`]

会导致序列`Q`的熵比序列少`M`吗？

注意：假设`B`两者`Q`和`M`具有相同大小的范围。

* * *

这与[观察到**大多数**现实世界的数据集，无论来源或来源，都具有对数分布](http://www.billthelizard.com/2009/04/benfords-law.html)有关；以 1 开头的数字比以 9 开​​头的数字更常见。但这对低阶部分几乎没有说明。

用一种有趣的方式来测试这个（并通过让他的计算机陷入困境来惹恼你的系统管理员）在 bash 中运行它：

```
 ll -R 2>/dev/null | grep -v -e "^\./" | sed "s/[-rdwxlp]*\W*[0-9]*\W*[a-z]*\W*[a-z]*\W*\([0-9]\).*/\1/" | sort | uniq -c 
```

并获取文件大小第一位的直方图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T22:07:08.520

这取决于顺序。例如，取 [1 * 7 = 7, 3 * 7 = 21, 6 * 7 = 42 ... (2 * N - 1) * 7] 和 B = 7。Qn 将是 [1, 3, 6, ... 2 * N - 1] 并且 Mn 将始终为 0。通常，Q 的熵会更少，因为它就像移动一些位一样，但并不总是这样。

当然，这不适用于来自 (P)RNG 的数据，因为 Qn 的范围将与 Mn 的范围相同，并且对于两者来说，数字（几乎）是均匀分布的。

# php - 在网站中实现此 PHP/XML 功能的理想方式是什么？

> ID：932951
> 
> 赞同：3
> 
> 时间：2009-05-31T21:57:01.770
> 
> 标签：php, html, xml

我编写了这段代码来获取一些天气数据并在我的网站上提供：

```
if( ! $xml = simplexml_load_file('http://www.weather.gov/data/current_obs/KBED.xml') ) 
{ 
    echo 'unable to load XML file'; 
} 
else 
{ 
  $temp = $xml->temp_f.' Degrees';
  $wind = $xml->wind_mph;
  $wind_dir = $xml->wind_dir;
  $gust = $xml->wind_gust_mph;
  $time = $xml->observation_time;
  $pres = $xml->pressure_in;
  $weath = $xml->weather;
} 
```

然后我只是在我想要它们的标签内回显它们。我的网站流量很低，但我想知道如果我要大幅增加流量，那么“最好”的方法是什么。我是否应该每小时（刷新 XML 时）将我想要的那些变量写入数据库，并使用 cron 作业来保存每次对服务器的 ping 操作，或者这不是坏习惯？我知道这有点主观，但我没有其他人可以要求“最佳方式”。谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T22:20:22.927

我建议如下：

*   当您第一次获取 xml 的内容时，对其进行解析并将其序列化为文件，并以某种方式将时间戳附加到文件中（可能作为序列化数据结构的一部分）

*   每次页面加载时，获取序列化数据，并检查时间戳。如果超过了某个点，请再次获取 xml 并将其缓存，确保更新时间戳。如果没有，只需使用该数据。

这应该可行，这意味着您只需要偶尔获取 xml，而且，一旦缓存过期，即使没有人访问，您也不会浪费定期获取它（因为它只是更新应要求）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T22:08:52.450

*   设置一个 cron 作业以定期获取 XML 文档、解析它并将变量存储在数据库中。
*   当请求页面时，从数据库中获取变量并呈现您的页面。
*   最好将上次更新的时间戳也存储在数据库中，这样您就可以判断数据何时过时（因为天气网站已关闭左右）。

这个设置对我来说看起来很合理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T22:16:11.763

您可以缓存外部站点的输出，并让它每 5-10 秒更新一次。这将消除您网站上大量“ping”的影响。这实际上取决于时间准确性对您的客户/客户的重要性。

在高流量情况下，我将有一个单独的脚本来运行守护程序或 cron 作业，并每隔指定的时间间隔获取天气，并在完成后覆盖公共网站页面。这样，您就不必担心缓存是由后台任务完成的，您的访问者只是从 Web 服务器访问静态页面。这也避免或至少最小化了将数据库合并到方程中的需要，并且相当轻量级。

不利的一面是，它确实会产生第二个故障点，如果信息需要准确到页面访问时间，它可能会非常无用。

# partitioning - 如何将问题划分为更小的可理解部分？

> ID：932966
> 
> 赞同：1
> 
> 时间：2009-05-31T22:04:28.853
> 
> 标签：partitioning, decomposition

我不确定是否可以就该主题提供一般性建议，但请尝试。很难解释我的情况，因为它太复杂而无法解释。这正是问题所在。

我似乎经常偶然发现我尝试设计项目的某些部分的情况，但是要考虑的事情太多了，我无法掌握它。

是否有任何关于如何一次查看我的系统的一般提示或建议？如何找到可以单独设计的较小部分？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-31T22:13:50.567

创建词汇表。

换句话说，确定对项目领域有意义的术语——不是从程序员的角度，而是从熟悉主题的用户的角度。

*然后尽可能精确*和*离散*地定义这些术语。这种形式的良好定义可以作为一种伪代码。

由于您甚至没有确定问题的领域，因此我将选择一个随机示例。在文职人事系统中，您可能有以下术语：

*   **方坯**：特定等级和步骤的服务期限（从开始日期到结束日期）
*   **employee**：与特定 SSN 关联的一系列方坯
*   **等级和步骤**：联邦总表中的行和列

等等。这并不是要识别功能单元，因为这听起来像是您正在尝试做的那样，但这是在这样做之前的一个很好的准备步骤，以便您可以用明确定义的术语表达您的功能步骤。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T22:15:51.593

自上而下和自下而上进行问题分解很有用。

如果您无法将一个大问题拆分为两个或多个小问题，请尝试考虑需要解决的最小问题。处理完这些问题后，当您处理原始的大问题时，您可能会开始看到将它们组合成更大问题的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T22:47:15.007

您的主要目标是：

*   **高内聚**：一个块/模块/分区内的代码（方法、字段、类）应该密集交互；这些元素相互了解应该*是有意义的。*如果您发现其中一些与其他部分没有太多交互，则它们可能属于其他地方或应该形成自己的分区。如果您发现外部代码与分区密切交互并且对其内部工作了解太多，那么它可能属于内部。典型的例子可以在以过程风格编写的 OO 代码中找到，其中包含“哑”数据对象和对它们进行操作但实际上应该是数据对象的一部分的“管理器”代码。
*   **松散耦合：片段/模块/分区***之间*的交互应该只通过狭窄的、定义明确的、记录良好的 API 发生。尝试识别此类 API，并查看实现它们所需的代码以及将使用它们的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T22:08:54.790

当我发现自己复制和粘贴代码块时进行了最小的调整，我意识到这是一个“分区”，然后创建了一个类、方法、函数或其他任何东西。

实际上，整个面向对象的方法就是它的全部内容。试着把你的应用程序看作是有形的东西。编写描述事物是什么以及它们做什么的伪代码，我发现很多这样的“分区”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T00:14:20.653

这是一个尝试，一种疯狂的猜测。

人们通常会低估完成这项工作需要多长时间。如果您的项目很大，那么您很可能需要几个人来处理它，因此您可以尝试考虑这一点进行规划。现在可以期望一个人只控制头部的一个区域，因此您需要向他准确解释他应该执行什么样的任务。

所以我想说你应该试着写一份工作描述，尽可能多地包含一个人认真专注的内容。重复，直到您将项目分解为您想要的部分。作为一个好处，你已经准备好组建你的团队了。但是如果你发现零件很小，也许你仍然可以自己做。

# javascript - javascript 开发人员需要了解 jquery 吗？

> ID：932967
> 
> 赞同：11
> 
> 时间：2009-05-31T22:04:40.930
> 
> 标签：javascript, jquery, frameworks, mootools

如果您要聘请 javascript 开发人员，您会期望他们了解 jquery 吗？

我这周刚开始使用堆栈溢出，并且知道 jquery 领先，但直到我注意到 MooTools（我最喜欢的）有 59 个问题而 jquery 有超过 4000 个问题时才意识到它的程度。（当然，一个好的统计学家可以将 jquery 的更多问题归因于它的可用性，而不是它的受欢迎程度——但我们知道这是错误的）

然后我开始注意到，当他们的代码的每一行都是 jquery 时，许多人使用标签“javascript”而不是“jquery”发布问题——就像它是事实上的 javascript 2.0，或者他们甚至没有意识到他们不是' t 写“javascript”，而是 jquery。

无论如何，我问这个是因为我一直是自由职业者，可以在项目中使用我想要的任何框架。但最近我被推荐成为几家公司的前端开发人员。我想了解社区的期望，以了解在探索可能提供的职位之前是否应该暂停其他一些个人项目以选择 jquery。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-31T22:09:29.827

不，我希望他们知道 JS 是如何工作的。一个优秀的 JS 开发人员会在不到一周的时间内学会 jQuery，可能是几个小时。

了解 jQuery 但不了解 JS 的开发人员需要学习很多东西，并且只会考虑担任最初级的角色。

jQuery 绝对不是 JS2.0 - 如果你仍然需要针对 IE8 等，它是一个很棒的标准化框架，但它在移动端不是很好，它不能加载`async`or `defer`，它不支持像被动事件这样的新功能, 它的主要优化是关于在已构建的 DOM 中查找元素（这意味着它不会为客户端 DOM 构建器增加太多价值）。

我希望他们听说过它，并且能够谈论它相对于其他框架的优势和劣势。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-31T22:08:23.743

他们至少应该知道 JQuery 是什么，并且能够说出他们选择它或其他框架的原因。除此之外，对最流行的 javascript 框架的基本了解永远不会受到伤害。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-23T10:04:25.877

当我遇到 mootools 时，我就开始了，从那以后就没有回头。但是最近，我花了相当多的时间来完善我的“香草”javascript，并且还开始研究 jquery（出于纯粹的好奇心）。事实证明，如果您希望能够翻译您的技能并能够自由地重构它们之间的代码，那么您需要了解很多关于框架、它们之间的差异以及 javascript 如何工作的知识。

例如，将其视为 2 个框架之间的逻辑代码重构

模拟工具

```
$("elementId").addEvent("click", function() {
    this.setStyles({
        border: "1px solid #000"
    });
}); 
```

jQuery

```
$("elementId").click(function() {
    this.css({
        border: "1px solid #000"
    }); // fails. 
}); 
```

我惊讶地发现 jquery 不起作用 - 然后认为 mootools 通过添加 .setStyles 扩展了元素的原型，而 jquery 是基于函数的。解决方法显然是改用**$(this).css** - 只是一开始并不那么明显。这让我意识到，要想在两者之间进行交换，需要的不仅仅是阅读界面文档。

正如有人所说，即使你有很强的 javascript/mootools（或其他框架）背景，也需要一周的时间来了解 jquery 的所有细微差别，但这不会是一个挑战。但是，从 jquery 迁移到 mootools - 如果您不精通 vanilla javascript 和 OOP，这将不是一件容易的事。

简短的回答是，我不希望 javascript 程序员只*知道*jquery，但我希望 jquery*用户*了解 javascript。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T22:10:01.777

JQuery 是当今 javascript 开发中非常重要的一部分，所以是的，我希望 JS 开发人员知道如何使用它，即使它只是基础知识。

它在商业应用程序开发领域突然获得动力的原因之一是微软给予了支持，并同意将其与最新的 Web 框架一起分发（请参阅 ASP.NET MVC）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T22:11:02.977

这一切都取决于他们正在开发什么。如果 Web 应用程序广泛使用 ajax，如果可能的话，你可以争辩说应该这样做），那么 JQuery 是一种很好的方法。与单纯的 javascript 相比，JQuery 减少了开发时间。底线，如果是我在做推荐 是的，两者都知道

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T22:22:35.197

我希望 JavaScript 开发人员了解 jQuery，因为它出名是有原因的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-31T22:30:47.320

我不希望他们知道 jQuery，如果他们可以使用它，那就更好了，因为我更喜欢 jQuery。就像许多人一样，他/她可能对 jQuery 有自己的偏好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-18T10:56:02.327

Jquery 现在很流行。它使开发更加高效和容易。并且有大量的插件和脚本可供选择。

# objective-c - 在目标 c 中管理类变量/方法的内存的正确方法是什么？

> ID：932971
> 
> 赞同：2
> 
> 时间：2009-05-31T22:06:11.910
> 
> 标签：objective-c, memory-management

我正在学习 Objective-C 并来自一个垃圾收集的世界。我正在创建一个字典的类（静态）变量，我不确定我是否正确地进行内存管理。我正在使用一种方便的方法，因此应该自动释放对象，但我真的不知道是否需要在我的类中释放或保留它。

我找不到关于如何管理类级别对象的明确文档 - 任何建议都值得赞赏。谢谢。

```
+(NSDictionary*) polygonNames{        
        NSDictionary* polygonNames = [NSDictionary dictionaryWithObjectsAndKeys:
                                      @"Triangle", @"3",
                                      @"Square", @"4",
                                      @"Square", @"4",
                                      @"Pentagon", @"5",
                                      @"Hexagon", @"6",
                                      @"Heptagon", @"7",
                                      @"Octagon", @"8",
                                      @"Nonagon", @"9",
                                      @"Decagon", @"10",
                                      @"Hendecagon", @"11",
                                      @"Dodecagon", @"12",
                                      nil];
        return polygonNames;

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T22:48:02.900

如果您的数据结构是不可变的并且不会更改，则可以使用*静态*变量，如下所示：

```
+ (NSDictionary *) polygonNames
{
    static NSDictionary *polygonNames = nil;
    if (!polygonNames) polygonNames = [[NSDictionary alloc] initWithObjectsAndKeys:/* objects and keys */];
    return polygonNames;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T22:55:24.273

我可以推荐网站 CocoaDev.com。您将在其中找到以下经验法则：

*   如果你分配、保留或复制它，释放它是你的工作。否则不是。
*   如果你分配、保留或复制它，释放它是你的工作。否则不是。是的：再读一遍！

搜索“经验法则”。因为我不允许添加超链接..

基本上所有名为`dictionary*`,`array*`等等的类方法都会返回一个自动释放的对象，您不必保留/释放。

为了进一步阅读，我可以推荐“内存管理”页面。

# sql - 选择多个字段，仅将 DISTINCT 应 用于一个特定字段

> ID：932986
> 
> 赞同：1
> 
> 时间：2009-05-31T22:11:23.443
> 
> 标签：sql, sql-server

在 SQL Server 中，如何实现选择多个字段（没有聚合函数）并将 DISTINCT 语句仅应用于一个特定字段？

例如：如果我有一个存储用户操作的表，伪模式将是这样的：

```
UserActions
------------
id,
User,
Action
insertDate 
```

我想在不重复“操作”字段的情况下获取给定用户的最新操作？

例如，如果表格内容是：

```
1, john, update, 01/01/09
2, john, update, 01/02/09
3, john, update, 01/03/09
4, john, delete, 01/04/09
5, john, insert, 01/05/09
6, john, delete, 01/06/09 
```

我想得到：

```
6, john, delete, 01/06/09
5, john, insert, 01/05/09
3, john, update, 01/03/09 
```

提前谢谢了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-31T22:20:24.860

内部查询应为用户“john”的每个操作选择最大 id，外部查询将选择与内部查询中的 id 集合匹配的那些记录，因此您应该只获取指定用户的每个操作的最后一个。

```
select id, user, action, insertDate
from userActions
where id in (select max(id)
                 from userActions
                 where user ='john'
                 group by action) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-31T22:32:14.663

一种值得考虑的替代方案（在 SQL Server 2008 中；不确定 SS 2005）：

```
SELECT id, User, Action, InsertDate
FROM Table
WHERE User = 'john'
AND ROW_NUMBER() 
    OVER(PARTITION BY Action ORDER BY InsertDate DESC) 
    = 1 
```

（看，妈，没有聚合函数！-）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T16:30:44.093

忽略 OP 不需要聚合函数（仍然不确定为什么......）

我对给定答案的问题是：

1.  允许任何其他用户不是动态的 - 说“标记”
2.  它假设一个动作的 max(id) 将匹配最新的动作 - 测试数据表明这一点，但我不认为这是一个规则。

所以考虑到这些，需要构建一个更动态的查询

在测试数据中添加了 2 行

```
 7, john, update, 04/01/09
 8, mark, insert, 01/02/09 
```

答案没有给出OP想要的

这是我的初稿 - 稍后会整理

```
select
    userActions.id,
    userActions.[user],
    userActions.Action,
    userActions.insertDate

from
userActions
join
    (
    select
        [user], action, max(insertdate) as maxinsertdate
    from userActions
    group by
        [user], action
    ) aggsubquery
    on userActions.[user] = aggsubquery.[user] 
         and userActions.action = aggsubquery.action 
         and userActions.insertdate = aggsubquery.maxinsertdate 
```

更新....

第 2 版使用 ID 获取不同的行，其中特定用户可能多次执行操作，即如果测试数据也有以下行

```
 9, john, delete, 06/01/09 
```

那么您需要在第 6 行和第 9 行之间决定要返回哪一个。我随意选择使用 max(id)，因为我猜数据很重要而不是行 id

```
select
    max(userActions.id) as id,
    userActions.[user],
    userActions.Action,
    userActions.insertDate  
from
userActions
join
    (
    select
        [user], action, max(insertdate) as maxinsertdate
    from userActions
    group by
        [user], action
    ) aggsubquery
    on userActions.[user] = aggsubquery.[user] 
        and userActions.action = aggsubquery.action 
        and userActions.insertdate = aggsubquery.maxinsertdate 
group by
    userActions.[user],
    userActions.Action,
    userActions.insertDate 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T22:15:17.380

不知道如何仅使用 SQL 来做到这一点。您可以执行完整查询（看起来您想按 InsertDate DESC 排序），然后仅手动提取您想要的查询。

```
set s = new set()
while (has more results) {
   var r = next result
   if (!s.contains(r)) {
      process result
      s.add(r)
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T22:17:03.867

如果您有一组固定的操作，您可以为每个操作编写一个查询，然后将结果合并在一起：

```
SELECT TOP 1 [id], [User], [InsertDate] 
FROM [UserActions] 
WHERE [Action] = 'insert' 
ORDER BY [InsertDate] DESC

UNION

SELECT TOP 1 [id], [User], [InsertDate] 
FROM [UserActions] 
WHERE [Action] = 'update' 
ORDER BY [InsertDate] DESC

UNION

SELECT TOP 1 [id], [User], [InsertDate] 
FROM [UserActions] 
WHERE [Action] = 'delete' 
ORDER BY [InsertDate] DESC 
```

# c# - C# 窗体控件移动

> ID：932988
> 
> 赞同：3
> 
> 时间：2009-05-31T22:12:07.170
> 
> 标签：c#, user-interface, move, wndproc

无论如何可以控制可以移动表单的位置吗？

所以如果我移动一个表格，它只能在垂直轴上移动，当我尝试水平移动它时，什么也没有发生。

我不想要像 locationchanged 或 move 事件这样的错误实现并将其弹出回内联。我没有办法使用 WndProc 覆盖之类的东西，但搜索了一段时间后，我找不到任何东西。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T23:45:51.317

例如：

```
using System.Runtime.InteropServices;

protected override void WndProc(ref Message m)
{
    if (m.Msg == 0x216)  // WM_MOVING = 0x216
    {
        Rectangle rect = 
           (Rectangle) Marshal.PtrToStructure(m.LParam, typeof (Rectangle));
        if (rect.Left < 100)
        {
            // compensates for right side drift
            rect.Width = rect.Width + (100 - rect.Left);
            // force left side to 100
            rect.X = 100;
            Marshal.StructureToPtr(rect, m.LParam, true);
        }
    }
    base.WndProc(ref m);
} 
```

上面的代码将最小左手位置设置为 100。

不需要像 driis 那样重新创建 RECT 结构，.NET 原生 Rectangle 可以正常工作。但是，您必须通过 X 属性设置位置，因为 Left 是仅限获取的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T22:56:44.380

您很可能想要覆盖 WndProc 并处理 WM_MOVING 消息。[根据 MSDN](http://msdn.microsoft.com/en-us/library/ms632632(VS.85).aspx)：

> WM_MOVING 消息被发送到用户正在移动的窗口。通过处理此消息，应用程序可以监视拖动矩形的位置，并在需要时更改其位置。

这将是一种方法，但是，您显然需要根据需要对其进行调整：

```
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace VerticalMovingForm
{
    public partial class Form1 : Form
    {
        private const int WM_MOVING = 0x0216;
        private readonly int positionX;
        private readonly int positionR;

        public Form1()
        {
            Left = 400;
            Width = 500;                            
            positionX = Left;
            positionR = Left + Width;
        }
        protected override void WndProc(ref Message m)
        {
            if (m.Msg == WM_MOVING)
            {
                var r = (RECT)Marshal.PtrToStructure(m.LParam, typeof(RECT));
                r.Left = positionX;
                r.Right = positionR;
                Marshal.StructureToPtr(r, m.LParam, false);
            }
            base.WndProc(ref m);                
        }

        [StructLayout(LayoutKind.Sequential)]
        private struct RECT
        {
            public int Left;
            public int Top;
            public int Right;
            public int Bottom;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-28T06:08:09.580

VB.NET 版本：

```
Protected Overloads Overrides Sub WndProc(ByRef m As Message)
    If m.Msg = &H216 Then
        ' WM_MOVING = 0x216
        Dim rect As Rectangle = DirectCast(Marshal.PtrToStructure(m.LParam, GetType(Rectangle)), Rectangle)
        If rect.Left < 100 Then
            ' compensates for right side drift
            rect.Width = rect.Width + (100 - rect.Left)
            ' force left side to 100
            rect.X = 100
            Marshal.StructureToPtr(rect, m.LParam, True)
        End If
    End If
    MyBase.WndProc(m)
End Sub 
```******