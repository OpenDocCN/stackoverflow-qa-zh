# StackOverflow 问答 000470000-000470999

# java - JAXB 文档注释

> ID：470001
> 
> 赞同：11
> 
> 时间：2009-01-22T17:10:37.760
> 
> 标签：java, xsd, jaxb

我有以下带有 JAXB @XMLRootElement 注释的 java 类

```
@XmlRootElement(name="ClientData")
public class ClientData {

/**
 * The first address field of the person
 */
private String address1 = null;
} 
```

当我生成 xsd 模式时，它会产生这个 xml 片段

```
<xs:complexType name="clientData">
  <xs:sequence>
   <xs:element minOccurs="0" name="address1" type="xs:string"/> 
```

是否可以使用 JAXB 注释，以便将 address1 字段上的文档详细信息作为 xs:annotation/xs:documentention 元素包含在我的最终模式中？

```
<xs:complexType name="clientData">
  <xs:sequence>
   <xs:element minOccurs="0" name="address1" type="xs:string">
    <xs:annotation>
      <xs:documentation>The first address field of the person</xs:documentation>
    </xs:annotation>
   </xs:element> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T09:29:30.433

简单的回答：不，使用内置 JAXB 是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T17:33:11.783

我不知道这是否可能，因为我从未使用过它。但据我所知，API 不支持文档元素。但是，您可以使用[@XMLElement](https://jaxb.dev.java.net/nonav/2.1.9/docs/api/javax/xml/bind/annotation/XmlElement.html)注释为您的成员提供更具描述性的名称。

```
//Example: Code fragment
public class USPrice {
   @XmlElement(name="itemprice")
   public java.math.BigDecimal price;
}

<!-- Example: Local XML Schema element -->
<xs:complexType name="USPrice"/>
   <xs:sequence>
     <xs:element name="itemprice" type="xs:decimal" minOccurs="0"/>
   </sequence>
</xs:complexType> 
```

# asp.net - AJAX - 嵌套更新面板。如何防止inner被更新？

> ID：470002
> 
> 赞同：0
> 
> 时间：2009-01-22T17:10:46.743
> 
> 标签：asp.net, ajax

我有一个外部更新面板，里面有几个按钮和一个内部更新面板。

它们都设置为 updatemode=conditional。我希望更新彼此独立。但是，当单击外部更新面板中的按钮时，内部更新面板也会更新。

有没有办法防止这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T17:21:53.227

我认为您无法使用您描述的结构来做到这一点，因为外部面板中的更新将导致整个面板（包括内部面板）更新。一种解决方案是添加另一个更新面板，这样你最终会得到类似的结果：

```
<asp:UpdatePanel ID="outer" ...>
<asp:UpdatePanel ID="inner1" ...>

</asp:UpdatePanel>
<asp:UpdatePanel ID="inner2" ...>

</asp:UpdatePanel> 
```

这样你就可以独立控制每个部分

# python - AppEngine 和 Django：包括一个模板文件

> ID：470008
> 
> 赞同：4
> 
> 时间：2009-01-22T17:12:54.993
> 
> 标签：python, django, google-app-engine, templates, include

正如标题所示，我使用的是 Google App Engine 和 Django。

我的模板中有很多相同的代码，并希望通过包含模板文件来减少这种情况。因此，在我的主应用程序目录中，我有 python 处理程序文件、主模板和我想要包含在主模板中的模板。

我原以为包括 {% include "fileToInclude.html" %} 会单独工作，但这根本不包括任何东西。我假设我必须设置一些东西，也许使用 TEMPLATE_DIRS，但我自己无法弄清楚。

编辑：

我试过了：

```
TEMPLATE_DIRS = (os.path.join(os.path.dirname(__file__), 'templates'), ) 
```

但无济于事。我也会尝试一些其他的可能性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T18:07:57.097

首先，您应该考虑使用[模板继承](http://docs.djangoproject.com/en/dev/topics/templates/#template-inheritance)而不是`include`标签，这通常是合适的，但有时远不如模板继承。

不幸的是，我没有使用 App Engine 的经验，但根据我使用常规 Django 的经验，我可以告诉您，您需要设置您的`TEMPLATE_DIRS`列表以包含您想要包含模板的文件夹，如您所指示的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-02T20:25:05.583

如果我不先加载模板并使用 Context 对象渲染它们，我发现它“开箱即用”。相反，我使用[AppEngine 教程](http://code.google.com/appengine/docs/python/gettingstarted/templates.html)中显示的标准方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-23T02:22:30.747

我遇到了同样的问题并将其追踪到 ext.webapp 包中。在 template.py 中，您会在第 33 行找到以下注释：

Django 对查找模板的目录使用全局设置。这在 webapp 模块的上下文中是不自然的，因此我们的 load 方法采用完整的模板路径，并且我们会自动设置这些设置。因为我们必须在每个方法调用上设置和使用全局设置，所以这个模块不是线程安全的，尽管这对应用程序来说不是问题。

请参阅同一文件中的第 92 行。您可以看到模板目录被压缩：

```
directory, file_name = os.path.split(abspath)
new_settings = {
    'TEMPLATE_DIRS': (directory,),
    'TEMPLATE_DEBUG': debug,
    'DEBUG': debug,
    } 
```

更新：这是对我有用的解决方法 - [http://groups.google.com/group/google-appengine/browse_thread/thread/c3e0e4c47e4f3680/262b517a723454b6?lnk=gst&q=template_dirs#262b517a723454b6](http://groups.google.com/group/google-appengine/browse_thread/thread/c3e0e4c47e4f3680/262b517a723454b6?lnk=gst&q=template_dirs#262b517a723454b6)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-25T16:58:12.603

我已经完成了以下操作来使用包括：

```
def render(file, map={}):
  return template.render(
    os.path.join(os.path.dirname(__file__), '../templates', file), map)  

table = render("table.html", {"headers": headers, "rows": rows})   
final = render("final.html", {"table": table})

self.response.out.write(final) 
```

# sql - 如何在 SQL Server Compact Edition 中进行此查询？

> ID：470009
> 
> 赞同：2
> 
> 时间：2009-01-22T17:12:57.723
> 
> 标签：sql, sql-server, sql-server-ce

此子查询适用于 SQL Server：

```
select systemUsers.name, 
    (select count(id) 
     from userIncidences 
     where idUser = systemUsers.id ) 
from systemUsers 
```

如何在 SQL Compact 中制作它？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-15T16:02:20.313

在某些情况下，您无法避免子查询，例如，如果您必须包含使用来自当前行和上一行的数据的计算列。考虑这个查询，例如：

```
SELECT     
     (Current.Mileage - Last.Mileage)/Quantity as MPG
FROM         
     GasPurchases AS Current
     LEFT OUTER JOIN GasPurchases AS Last
     ON Last.Date =
        (SELECT MAX(PurchaseDate)
        FROM GasPurchases
        WHERE PurchaseDate < Current.PurchaseDate) 
```

会导致解析错误：

> SQL 执行错误。
> 
> 错误来源：SQL Server Compact ADO.NET 数据提供程序错误消息：解析查询时出错。

我在 MSDN 上找到了这个有解决方法的[线程。](http://social.msdn.microsoft.com/Forums/en-US/sqlce/thread/3a6351a2-6c10-4595-9b50-2ad4dc54470b/)通过更改子查询使其返回一个集合而不是一个标量值，我能够保存并运行以下查询。

```
SELECT     
     (Current.Mileage - Last.Mileage)/Quantity as MPG
FROM         
     GasPurchases AS Current
     LEFT OUTER JOIN GasPurchases AS Last
     ON Last.Date IN
        (SELECT MAX(PurchaseDate)
        FROM GasPurchases
        WHERE PurchaseDate < Current.PurchaseDate) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T17:19:17.990

试试这个：

```
SELECT su.Name, COUNT(ui.ID)
FROM systemUsers su
LEFT JOIN userIncidences ui ON ui.idUser = su.ID
GROUP BY su.Name 
```

[编辑：]
我最初像 Tomalak 一样有一个 INNER JOIN，但我意识到这会排除没有事件的用户，而不是用 0 计数显示他们。这甚至可能是您想要的，但它与您的原件不符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-23T07:59:16.917

谢谢大家，DoctaJonez，我发现你的小帖子对我的子查询最有帮助。您的语法似乎适用于 SQL Server Compact v3.5。这是我尝试过的查询（有效）。

顺便说一句，你看到的硬编码值 (38046)，我在运行查询时知道

```
insert into tLink (start,stop,associativeobject,linktype,id,name,guid,createTime,modifyTime,externalID,description,linkLabel,LinkDetails)
select newtable.id,stop,associativeobject,linktype,newtable.id,name,guid,createTime,modifyTime,externalID,description,linkLabel,LinkDetails from tLink l, (select id, '38046' as newid from tObject Where name = 'Step 1' and id <> '38046') as newtable
where l.start = newtable.newid and start in (38046) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-07T10:46:08.630

像这样的东西？（使用Northwind.Order Details]

代码片段：

```
SELECT     [Unit Price] * Quantity AS Cost,

[Unit Price] * Quantity * 1.25 AS CostWithVAT
FROM         [Order Details] 
```

源 [航空订票系统项目](http://freedownloadbcamcaproject.in/ProjectView.aspx?RefID=77&title=Airline-Reservation-System-Project&pageno=webpage_1)

# .net - 用于 .NET 开发的命令行（或等效）工具

> ID：470010
> 
> 赞同：6
> 
> 时间：2009-01-22T17:13:00.657
> 
> 标签：.net, visual-studio, command-line, powershell, cmd

我大部分时间都花在 Visual Studio 中并使用所有 IDE 工具，我希望我可以花更多时间使用以下任一工具。

*   Visual Studio 中的命令行窗口
*   命令行程序
*   [赛格温](http://en.wikipedia.org/wiki/Cygwin)、[明格](http://en.wikipedia.org/wiki/MinGW)...
*   电源外壳。
*   脚本？

与键盘快捷键或四处点击相比，您最喜欢和必不可少的命令是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T17:59:18.863

最关键的 PowerShell 命令是 Get-Command（别名 gcm）和 Get-Member（别名 gm）。这两个命令允许您探索和利用大部分可用功能。Get-Member 非常适合以交互方式探索和使用 .NET 对象。

其他有用的命令系列是：

```
[System.Reflection.Assembly]::LoadFrom($relativepath)
[System.Reflection.Assembly]::LoadFile($absolutepath) 
```

它允许您将其他程序集加载到 PowerShell 中以使用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T17:16:57.043

[NAnt](http://en.wikipedia.org/wiki/NAnt)和[booi](http://boo.codehaus.org/Interactive+Interpreter)对我来说是最大的。NAnt 提供了构建，而 booi 提供了一种运行 .NET 代码的简单方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T19:24:18.753

在我较大的项目中，我开始创建自定义的[build.cmd](http://devio.wordpress.com/2008/08/18/building-visual-studio-solutions-from-batch-file/)批处理文件，这些文件本身调用命令行工具，例如：

*   [grabx](http://www.devio.at/index.php/graspx)检查 .aspx 文件，
*   **osql**从 SQL Server 数据库模式生成 C# 代码并备份开发数据库，
*   **scptxfr**为架构编写脚本，
*   **msbuild**构建应用程序，
*   **devenv**构建设置解决方案，
*   **7za**（7-Zip）压缩东西。

偶尔的[IISReset](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/iis/003ed2fe-6339-4919-b577-6aa965994a9b.mspx)也有帮助；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T17:20:12.670

在创建非常小的单文件命令行实用程序时，我喜欢使用比 Visual Studio 更简单的代码，例如[Notepad2](http://en.wikipedia.org/wiki/Notepad2)。然后我使用**mcs**（与 .NET Framework 捆绑在一起的命令行编译器）将源代码编译成程序集。

[我认为，在不一直主动使用IntelliSense](http://en.wikipedia.org/wiki/IntelliSense)的情况下，有时看看我实际上记得如何使用框架的多少，这对我的记忆力是很有趣和有益的。抱歉，这里有点跑题了。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T19:29:20.397

对于标准开发，我使用 csc.exe 和 msbuild.exe。其他有用的工具是用于 Web 服务开发的 wsdl.exe 和 svcutil.exe，在极少数情况下还有[ildasm.exe](http://msdn.microsoft.com/en-us/library/496e4ekx%28v=vs.80%29.aspx)和 tlbimp.exe。

哦，是的，然后我非常喜欢[PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)，但那是一本书本身:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T18:44:23.653

我创建助手批处理文件并从命令行运行它们。

我还用于`msbuild`构建 Visual Studio 解决方案，并`nunit-console`运行 NUnit 单元测试（我有一个批处理文件）。加上所有常规的 cmdline 优点，例如`grep`,`vim`和`svn`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T22:17:58.480

我曾经看到的一个极好的模式是使用预编译命令从 Web 服务中检索[WSDL](http://en.wikipedia.org/wiki/Web_Services_Description_Language)并使用 wsdl.exe 工具生成适当的包装器类。我在最近的一个项目中采用了相同的模式，并让该`xsd.exe`工具从我的 XML 模式文件生成类。

虽然您不会以交互方式输入命令，但您当然需要开发一些同样有效的东西并熟悉主机（.bat 脚本、[PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)等）。Visual Studio 公开了一些有趣的类似环境的变量，以帮助定位您的项目源等。好东西。

# jquery - 使用 ASP.NET MVC JsonResult 和 jQuery 的安全性和跨域

> ID：470011
> 
> 赞同：1
> 
> 时间：2009-01-22T17:13:19.360
> 
> 标签：jquery, asp.net-mvc, ajax, json, cross-domain

我正在使用 asp.net MVC 开发一个具有 ajax 交互的应用程序。我在控制器中有 JsonResult 方法返回我的 json 序列化数据。例如，当向[http://somesite.com/findwidgets/](http://somesite.com/findwidgets/)发出请求时， mvc 将数据序列化为 json 并将其发送回。

我在客户端使用 jQuery 来处理 ajax 请求，然后操纵结果。我在获取数据时没有遇到任何问题，但我发现我可以从浏览器的地址栏向[http://somesite.com/findwidgets/](http://somesite.com/findwidgets/)发出请求，它会将 json 数据作为下载返回。

另外，我如何确保其他人不能简单地使用[http://somesite.com/findwidgets/](http://somesite.com/findwidgets/)发出请求和获取数据？

跨域是正确的主题还是与其他安全问题有关？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T17:19:30.847

> 另外，我如何确保其他人不能简单地使用 [http://somesite.com/findwidgets/](http://somesite.com/findwidgets/)发出请求和获取数据？

您描述的问题与人们在询问他们如何阻止人们从另一个站点发布到他们的表单时所指的问题相同。我见过的唯一合理的答案是使用某种类型的会话密钥系统，其中为每个请求生成一个密钥，并且每个后续请求都必须通过先前生成的密钥进行验证。没有密钥或无效密钥的请求被拒绝访问。

> 我发现我可以从浏览器的地址栏向[http://somesite.com/findwidgets/](http://somesite.com/findwidgets/)发出请求 ，它会返回 json 数据作为下载。

这是因为 JSON 不被识别为文本 mime 类型，浏览器只会在浏览器中直接显示文本 mime 类型。其他任何内容都将作为下载提供，而不是内联显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T02:21:18.017

考虑检查请求主机，并将其限制在当前域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T23:58:48.057

您也可以使用控制器的 IsAjaxRequest() 属性（如果它为 false - 例如返回 null 结果）。为了防止从其他站点发布/获取数据，您可以检查 Request.UrlReferrer 属性（但浏览器可能会撒谎）。

# language-agnostic - 同一首老歌 - 旧事物的新名称

> ID：470014
> 
> 赞同：4
> 
> 时间：2009-01-22T17:13:46.240
> 
> 标签：language-agnostic

读到[这个话题](https://stackoverflow.com/questions/466365/design-patterns-are-the-problem-not-the-solution#466688)，我想起了一些总是让我烦恼的事情。

有一些实践、方法或任何东西，它们存在了很长时间，众所周知并被使用。然后有人写了一本书，在上面加上了一个新奇的名字，然后它就从无到有开始出现了一些新的、革命性的、下一件大事，等等……

设计模式是众所周知的解决方案的组合，成熟并成为“集体智慧”，它们不是普遍规律，也不是由 GoF 创建的。您无需阅读本书即可本能地应用其中一些。这些模式是自己进化的，GoF 只是把它们粘在一本书里。

正如[Phil Factor 所指出的](http://www.simple-talk.com/community/blogs/philfactor/archive/2007/10/24/38759.aspx)，极限编程也不是什么新鲜事。

还有什么其他的事情让你觉得“我以前看过这个……”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T17:18:51.487

Ajax 是由许多人完成的，早在这个名字出现之前。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T17:35:27.367

REST 基本上就是 HTML 的设计初衷。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T19:35:05.503

我认为[Greenspun 的第十条编程规则](http://en.wikipedia.org/wiki/Greenspun%27s_Tenth_Rule)就是你所问的一个例子：

> 任何足够复杂的 C 或 Fortran 程序都包含一个临时的、非正式指定的、充满错误的慢速实现，它是 Common Lisp 的一半。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T17:19:54.493

[这里](https://stackoverflow.com/questions/432922/significant-new-inventions-in-computing-since-1980)有很长的清单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T17:28:04.853

[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)看起来很像人们在 Java 早期所做的事情，其中​​一切都有一个接口，即使是不需要它的东西。变成了界面汤。虽然在它上面加上一个漂亮的名字，然后构建一个框架让它再次变得很酷。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T18:24:38.843

[“目录”](http://en.wikipedia.org/wiki/Directory_(file_systems))（UNIX）/“文件夹”（Mac/Windows）等的无偿新名称（ [HDF5中的“组”，](http://www.hdfgroup.org/HDF5/doc/UG/UG_frame09Groups.html) [SurroundSCM](http://www.seapine.com/kb/questions/1209/Understanding+the+Differences+between+Surround+SCM+Working+Directories+and+Repositories)中选择不当的“存储库” ， [Visual SourceSafe](http://msdn.microsoft.com/en-us/library/5fdkw2w1(VS.80).aspx)中的“项目”等） .等等等等）

对于集成开发环境的 GUI 状态的序列化，“项目”、“会话”、“工作区”、“解决方案”(Visual Studio) 等术语的重新发明和混淆使用也是如此。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T19:32:20.203

我想很多人会承认 Ruby 是对 Smalltalk 的重新发明。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-22T19:44:55.997

重构是我们一直在做的事情的新名称，以更好的方式重写现有代码。

我同意克里斯特·埃里克森（ [Christer Ericson](http://realtimecollisiondetection.net/blog/?p=79)）所说的“重写”某些东西从来都不是“从头开始重写”的意思。当我重写一些东西时，如果我看不出有什么特别的理由要扔掉每一行代码，我总是根据以前的版本来做。因此，“重构”对我来说似乎是一个毫无意义的词。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T19:56:39.920

分布式版本控制系统背后的许多想法很久以前就存在于大型机上。

# character-encoding - 摩尔达瓦的可用字符集

> ID：470016
> 
> 赞同：0
> 
> 时间：2009-01-22T17:13:54.040
> 
> 标签：character-encoding

有谁知道摩尔达瓦使用的是哪个字符集。我们为摩尔达瓦准备我们的软件（和数据库）。我想 UTF-8 应该可以工作，不是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T17:32:08.200

UTF-8 适用于一切 :-)

问题是您的软件是否需要与“本地”应用程序交互。如果是这样，它可能需要了解该软件使用的编码。这些很可能是用于西里尔文字[的 ISO-8859-5](http://en.wikipedia.org/wiki/ISO/IEC_8859-5)和用于拉丁文字[的 ISO-8859-16 。](http://en.wikipedia.org/wiki/ISO/IEC_8859-16)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T17:22:52.353

摩尔多瓦对使用什么脚本存在一些争议（德涅斯特河沿岸使用[摩尔多瓦西里尔字母](http://en.wikipedia.org/wiki/Moldovan_Cyrillic_alphabet)，大陆使用带有很多变音符号的拉丁文）。

无论如何，UTF-8 总是一个不错的选择。

# .net - 调用程序集获取应用程序名称

> ID：470020
> 
> 赞同：7
> 
> 时间：2009-01-22T17:16:38.200
> 
> 标签：.net, vb.net, system.reflection

我有一个`MyProgram.EXE`引用实用程序程序集的控制台应用程序 ()。

在我的实用程序程序集中，我有代码：

```
Dim asm As Assembly = Assembly.GetExecutingAssembly()
Dim location As String = asm.Location
Dim appName As String = System.IO.Path.GetDirectoryName(location)
Conole.WriteLine("AppName is: {0}", appName) 
```

当我调用它时`MyProgram.EXE`，我收到“ `AppName is: Utilities.dll`”

我要的是“ `AppName is: MyProgram.EXE`”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-22T17:19:28.567

改为使用`GetEntryAssembly()`来获取包含入口点的程序集。

更好的方法是使用`System.Environment.CommandLine`属性。

具体来说：

```
Dim location As String = System.Environment.GetCommandLineArgs()(0)
Dim appName As String = System.IO.Path.GetFileName(location)
Conole.WriteLine("AppName is: {0}", appName) 
```

顺便说一句，你想使用`GetFileName`而不是`GetDirectoryName`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-07-19T14:47:10.797

由于您询问的是 VB.NET，因此您可以*轻松地*从“我的”命名空间中提取此信息，如下所示：

```
My.Application.Info.AssemblyName 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-02-28T09:57:43.863

我用：

```
CallingAppName = System.Reflection.Assembly.GetEntryAssembly.GetName().Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-03T21:26:32.697

就我而言，我无法访问 My.Application，可能是因为我在一个全局类中，所以我使用了：

```
AppName = System.Reflection.Assembly.GetExecutingAssembly().GetName().Name 
```

# sql - WCF、Linq-to-SQL 和参数化构造函数

> ID：470025
> 
> 赞同：1
> 
> 时间：2009-01-22T17:17:22.410
> 
> 标签：sql, linq, wcf, linq-to-sql, constructor

如何让 WCF 允许以下操作？

```
Dim EmployeeID as Integer = 10
Dim emp As New WcfServiceLibrary1.Employee(EmployeeID)
Response.write (emp.LastName) 
```

目前我必须这样做，因为我无法找到 WCF 允许参数化构造函数的方法：

```
Dim EmployeeID as Integer = 10
Dim emp As New WcfServiceLibrary1.Employee()
emp = emp.GetEmployee(EmployeeID)
Response.write (emp.LastName) 
```

我不得不采取这个额外的步骤似乎很奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T00:55:48.567

您正在使用构造函数创建与普通类不同的服务类的实例，此外，这里 WCF 正在处理对象封送处理。您将无法使用服务合同来实现您想要实现的目标。

# c++ - boost::bind 与具有引用参数的函数绑定

> ID：470040
> 
> 赞同：30
> 
> 时间：2009-01-22T17:19:34.450
> 
> 标签：c++, boost-bind

我注意到，当将引用参数传递给 boost 绑定时，这些参数不会像引用一样起作用。相反，boost 创建了成员的另一个副本，并且原始传入的变量保持不变。

当我更改对指针的引用时，一切正常。

我的问题是：

是否有可能获得工作引用，或者至少在尝试使用引用参数时给出编译错误？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-22T17:22:36.533

[bind](http://www.boost.org/doc/libs/1_37_0/libs/bind/bind.html#with_functions)的boost 文档建议您可以为此使用 boost::ref 和 boost::cref。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-13T18:18:14.433

每当绑定中使用的方法被声明为采用引用参数时，我遇到了类似的问题，期望通过引用传递绑定参数。然而，这种情况并非如此！无论方法如何声明，您都需要在 boost::ref() 或 boost::cref() 中显式包装绑定参数（即通过引用传递）。

例子：

```
ClassA myClassAParameter
void Method(ClassA &param); 
```

现在，以下绑定：

```
callback = boost::bind(&Method, myClassAParameter); 
```

实际上会复制 ClassA 对象（我知道这是一个临时分配，并且被调用的方法不应该**保留**对它的引用，因为这不是实际对象的引用，而是对象的副本）。

但是，以下绑定：

```
callback = boost::bind(&Method, boost::ref(myClassAParameter)); 
```

不会复制，而是使用**引用****来**创建绑定对象。

# vb6 - VB6 IsNumeric 会出错吗？

> ID：470041
> 
> 赞同：5
> 
> 时间：2009-01-22T17:19:42.623
> 
> 标签：vb6, casting, isnumeric

是否可以使用 IsNumeric() 测试字符串并使其返回 true，但是当您使用 CInt() 将相同的字符串转换为整数并将其分配给整数类型的变量时，它会给出类型不匹配错误？

我问是因为我遇到了类型不匹配错误，所以我在尝试强制转换之前使用 IsNumeric() 检查字符串是否为数字，但我仍然收到错误。

我用这个把头发扯掉了。

这是有问题的代码。 `iGlobalMaxAlternatives = CInt(strMaxAlternatives)`是发生错误的地方。

```
Dim strMaxAlternatives As String
Dim iGlobalMaxAlternatives As Integer
iGlobalMaxAlternatives = 0
bSurchargeIncInFare = True

strMaxAlternatives = ReadStringKeyFromRegistry("Software\TL\Connection Strings\" & sConn & "\HH", "MaxAlt")

If IsNumeric(strMaxAlternatives) And strMaxAlternatives <> "" Then
    iGlobalMaxAlternatives = CInt(strMaxAlternatives)
End If 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T17:28:16.850

由于最大整数大小，您可能会溢出；货币类型实际上非常适合大量数字（但要注意任何区域问题）。有关 Int64 讨论，请参阅下面的编辑。

根据[IsNumeric](http://msdn.microsoft.com/en-us/library/6cd3f6w1.aspx)上的 MSDN 文档：

*   如果 Expression 的数据类型为 Boolean、Byte、Decimal、Double、Integer、Long、SByte、Short、Single、UInteger、ULong 或 UShort，或包含其中一种数字类型的 Object，则 IsNumeric 返回 True。如果 Expression 是可以成功转换为数字的 Char 或 String，它也返回 True。

*   如果 Expression 的数据类型为 Date 或 Object 的数据类型并且它不包含数值类型，则 IsNumeric 返回 False。如果 Expression 是不能转换为数字的 Char 或 String，IsNumeric 将返回 False。

由于您遇到类型不匹配，因此 Double 可能会干扰转换。IsNumeric 不保证它是一个整数，只是它匹配一种数字可能性。如果数字是双精度数，则可能是区域设置（逗号与句点等）导致异常。

您可以尝试将其转换为双精度，然后再转换为整数。

```
' Using a couple of steps
Dim iValue As Integer
Dim dValue As Double
dValue = CDbl(SourceValue)
iValue = CInt(iValue)
' Or in one step (might make debugging harder)
iValue = CInt(CDbl(SourceValue)) 
```

编辑：在您澄清之后，您似乎正在获得溢出转换。首先尝试使用 Long 和 CLng() 而不是 CInt()。仍然有可能入口是 Int64，这在使用 VB6 时更加困难。

我已将以下代码用于 LARGE_INTEGER 和 Integer8 类型（均为 Int64），但它可能不适用于您的情况：

```
testValue = CCur((inputValue.HighPart * 2 ^ 32) + _
                  inputValue.LowPart) / CCur(-864000000000) 
```

此示例来自[LDAP 密码过期示例](http://support.microsoft.com/kb/323750)，但就像我说的那样，它可能适用于您的场景，也可能不适用。如果您没有 LARGE_INTEGER 类型，它看起来像：

```
Private Type LARGE_INTEGER
    LowPart As Long
    HighPart As Long
End Type 
```

搜索 LARGE_INTEGER 和 VB6 以获取更多信息。

编辑：对于调试，暂时避免错误处理然后在通过令人不安的行后重新打开它可能很有用：

```
If IsNumeric(strMaxAlternatives) And strMaxAlternatives <> "" Then
    On Error Resume Next
    iGlobalMaxAlternatives = CInt(strMaxAlternatives)
    If Err.Number <> 0 Then
        Debug.Print "Conversion Error: " & strMaxAlternatives & _
                    " - " & Err.Description
    EndIf
    On Error Goto YourPreviousErrorHandler
End If 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T17:22:39.793

是的，“3.41”将是数字但不是整数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T18:24:55.410

VB6 没有提供好的方法来保证 CInt 不会失败。我发现最简单的方法就是使用错误处理。

```
function TryParse(byval text as string, byref value as integer) as boolean
  on error resume next
  value = CInt(text)
  TryParse = (err.number = 0)
endfunction 
```

当然，您的错误处理偏好可能会有所不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T17:25:25.733

根据 VB6 文档，“如果 Expression 的数据类型为 Boolean、Byte、Decimal、Double、Integer、Long、SByte、Short、Single、UInteger、ULong 或 UShort，或者包含其中之一的 Object，则 IsNumeric 返回 True数字类型。如果 Expression 是可以成功转换为数字的 Char 或 String，它也返回 True。

其中许多不能转换为整数。例如“1.5”是数字，但它不是整数。因此，您可以将其转换为数字，但不一定是整数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T18:15:41.513

是的。试试这个：

```
If IsNumeric("65537") Then
    Dim i As Integer
    i = CInt("65537") 'throws an error on this line!
End If 
```

这是一个溢出，但我认为它说明了 IsNumeric() 一般的不可靠性（特别是对于整数 - 对于双打来说它更可靠）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T17:58:57.990

以下代码在 Visual BASIC 6 中没有类型不匹配错误的情况下工作

```
Dim I As Integer
I = CInt("3.41") 
```

此变体相同

```
Dim I As Integer
Dim TempS As String
TempS = "3.41"
I = CInt(TempS) 
```

发布有问题的代码将有助于回答您的问题。基本上VB6中有几个函数用于将字符串转换为数字。

CInt 和 Int 转换为数字，但处理舍入不同。直接赋值有效，相当于使用 CInt。但是，我建议您继续使用 CInt 以使您和您的开发人员在未来清楚地了解操作。

CInt 可以处理带有逗号的数字，例如“3,041.41”，但是 VB6 处理区域设置有问题，所以如果您使用标准美式英语以外的符号，您会得到奇怪的结果和错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T18:59:37.867

你最好的办法是开始用它正在使用的实际值记录错误，这样你就可以弄清楚发生了什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T19:27:50.057

如果 IsNumeric 可以将字符串转换为数字，它将返回 true。即使字符串中有非数字字符。我总是一次循环遍历字符串一个字符并测试每个字符。如果一个字符失败，那么我可以返回一个错误。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-29T20:50:04.600

刚找到这个金块。如果您运行以下命令，脚本 #1 返回 TRUE，但脚本 #2 和 #3 将失败：

```
SELECT ISNUMERIC('98,0') AS isNum   -- Fails

SELECT CONVERT(INT, '98,0')   -- Fails

SELECT CONVERT(NUMERIC(11,4), '98,0')     -- Fails 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-22T19:43:00.133

两种选择...

改变

```
If IsNumeric(strMaxAlternatives) And strMaxAlternatives <> "" Then
    iGlobalMaxAlternatives = CInt(strMaxAlternatives)
End If 
```

到

```
If IsNumeric(strMaxAlternatives) And strMaxAlternatives <> "" Then
    iGlobalMaxAlternatives = CDbl(strMaxAlternatives) ' Cast to double instead'
End If 
```

或者

```
If IsNumeric(strMaxAlternatives) And strMaxAlternatives <> "" Then
    If CDbl(strMaxAlternatives) Mod 1 = 0 Then ' Make sure there\'s no decimal points'
        iGlobalMaxAlternatives = CInt(strMaxAlternatives)
    End If
End If 
```

# .net - .NET Compact Framework GetHashCode(Object) 等效项

> ID：470044
> 
> 赞同：2
> 
> 时间：2009-01-22T17:20:44.213
> 
> 标签：.net, compact-framework

以下方法的 .NET Compact Framework 等效项是什么？是否有任何可用的 P/Invoke 调用？

System.Runtime.CompilerServices.RuntimeHelpers.GetHashCode（对象）

我正在将一个开源项目移植到 .NET Compact Framework 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T17:36:30.607

此方法无法调用 PInvoke。RuntimeHelpers.GetHashCode() 实际上只是调用内部 CLR 方法 (Object.InternalGetHashCode)。PInovke 无法使用这样的功能。

该方法实际上只是以非虚拟方式调用 Object.GetHashCode() 。不幸的是，没有办法静态地做到这一点。C# 不支持以非虚拟方式调用给定对象的方法（CLR 认为此代码不可验证）。

您最好的选择是通过反射调用 Object.InternalGetHasheCode。不过，您必须检查并查看该方法是否在 Compact Framework 上实现。我的期望是它会，但我没有方便的 CF 的 mscorlib。

RuntimeHelpers.GetHashCode 的文档：http: [//msdn.microsoft.com/en-us/library/11tbk3h9.aspx](http://msdn.microsoft.com/en-us/library/11tbk3h9.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-31T23:59:30.903

我已经编写了一些代码来获得一个身份哈希码方法的委托，该方法适用于标准框架和 Compact Framework，尽管它依赖于 Compact Framework 的未记录内部结构。我忘记了实际的 P/Invoke 调用（它是从 的序数导出`mscoree.dll`）；这只是从名称中获取内部 P/Invoke 原型`mscorlib`。

```
private static readonly Func<object, int> _IdentityHashCode;

static ClassName()
{
    Assembly mscorlib = typeof(object).Assembly;
    Type t;
    MethodInfo mi;

    // Try the official way first.
    if ((t = mscorlib.GetType("System.Runtime.CompilerServices.RuntimeHelpers")) != null)
    {
        if ((mi = t.GetMethod("GetHashCode", BindingFlags.Public | BindingFlags.Static)) != null)
        {
            _IdentityHashCode = (Func<object, int>)Delegate.CreateDelegate(typeof(Func<object, int>), null, mi);
            return;
        }
    }

    // On Compact Framework we have to go in through the back door.
    if ((t = mscorlib.GetType("System.PInvoke.EE")) != null)
    {
        if ((mi = t.GetMethod("Object_GetHashCode", BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Static)) != null)
        {
            _IdentityHashCode = (Func<object, int>)Delegate.CreateDelegate(typeof(Func<object, int>), null, mi);
            return;
        }
    }

    _IdentityHashCode = LastDitchHashFunction;
}

private static int LastDitchHashFunction(object obj)
{
    // A legal if very inefficient implementation ...
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-01T15:56:39.520

我写了[A is A](https://bitbucket.org/JonHanna/aisa)来处理这个问题，而不依赖于`Runtime.CompilerServices.RuntimeHelpers`（并非在每个运行时版本中都可用）、`Reflection.Emit`（同样的问题）或 PInvoking 到未记录的方法（可能会改变）。

它与该方法做同样的事情`Reflection.Emit`，但直接写在相关的 CIL 中：

```
ldarg.1
call instance int32 [mscorlib]System.Object::GetHashCode()
ret 
```

正如 CIL 所说，这很简单——尽管 99% 的情况下这是一个愚蠢的想法*，因为`GetHashCode()`出于某种原因是虚拟的，因此 99% 的时间`call`而不是`callvirt`一个错误。因此，虽然 C#`callvirt`与非虚拟方法一起使用这一事实引起了一些人（好吧，我）的争论，但没有 C# 直接表达这一点的方式确实是有道理的。

*项目名称背后的部分灵感；同一定律可以追​​溯到亚里士多德，但“A 是 A”与我 99% 认为愚蠢的哲学最密切相关。

# xslt - 如何打破 XSLT 中的 for-each 循环？

> ID：470045
> 
> 赞同：22
> 
> 时间：2009-01-22T17:20:57.830
> 
> 标签：xslt

如何打破 XSLT 中的 for-each 循环？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-22T17:34:46.853

XSLT 是用一种非常实用的风格编写的，在这种风格中没有等效的`break`语句。你可以做的是这样的：

```
<xsl:for-each select="...nodes...">
    <xsl:if test="...some condition...">
        ...body of loop...
    </xsl:if>
</xsl:for-each> 
```

这样，`for-each`仍然会遍历所有节点，但只有在条件为真时才会执行循环体。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-12-14T15:37:22.350

将停止“循环”的条件放在元素的`select`属性中。`for-each`例如，在四个元素之后“中断”：

```
<xsl:for-each select="nodes[position()&lt;=4]"> 
```

迭代到但不包括满足某些特定条件的节点：

```
<xsl:for-each select="preceding-sibling::node[condition]"> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-22T17:37:25.177

XSLT 不是过程语言。不要将 for-each 视为 Java 中的循环方式的“循环”。For-each 是一种将模板应用于一堆项目中的每一个的方法。它不一定以特定的顺序发生，因此您不能将其视为“将此模板应用于一堆项目中的每一个，直到某某发生，然后停止”。

也就是说，您可以使用 select 属性来过滤结果，因此它更像是“将模板应用于一堆项目中的每一个，但前提是它们是这样那样的”。

如果您真正想要的是“将模板应用于一堆项目中的每一个，其中某某是真的，但只适用于第一个这是真的”，您可以将 select 属性与位置结合起来（） 功能。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T22:42:44.703

**XSLT 指令主体的“中断”`<xsl:for-each>`不能使用句法结构指定**，但***可以模拟***。

topxml.com 上的这段代码片段详细描述了该技术：

[**如果您需要 xsl:for-each 循环中的“中断”**](http://www.topxml.com/code/cod-422_10067_in-case-you-need-a-break-from-an-xslfor-each-loop.aspx)

**基本上讨论了两种技术**：

1.  `<xsl:for-each>` 仅在满足特定条件时才在体内执行某些操作。`select`如果可以在属性中指定条件，则可以改进`<xsl:for-each>`-- 在这种情况下，只会处理必要的节点。参见例如：[https ://stackoverflow.com/a/7532602/36305](https://stackoverflow.com/a/7532602/36305)

2.  指定不使用`<xsl:for-each>`但使用递归的处理。有许多使用 XSLT 进行递归处理的示例。参见代码：[https ://fxsl.sf.net/](https://fxsl.sf.net/)

**第二种方法的好处是能够立即执行退出**，而第一种方法即使在满足退出条件后仍必须执行许多“空循环”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-23T14:20:47.420

我有类似的情况，这是我编写的代码。出于逻辑原因，我无法适应 condition01 的其他条件。

```
<xsl:for-each select="msxsl:node-set($DATA6)[condition01]"> 
<xsl:choose>
<xsl:when test="not((condtion02 or  condition03) and condition04)">
--body of for loop 
</xsl:when>
</xsl:choose>
</xsl:for-each> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T09:51:57.880

您好，我知道这是一篇旧帖子，但也许它可以帮助其他开发人员。我找到了一种在 XSLT 中打破 a for each 的方法，这并不是一个简单的中断，但如果你看到代码，你就会得到它。如您所知或不知道，您可以在 xslt 中使用内联 C# 代码。在此示例中，我想循环所有节点并使用 Value RC 获取第一个 NTE 节点但是如果我得到一个与 NTE 节点不同的节点，我想停止查看条件。所以我在 C# 代码中设置了一个全局变量，每次通过一个节点时我都会询问该值：

```
 <xsl:value-of select="userCSharp:SetStopForeach('true')" />
<xsl:for-each select="following-sibling::node()">

        <xsl:if test="local-name()='NTE_NotesAndComments_3' and userCSharp:GetStopForeach()" >

        <xsl:for-each select="NTE_4_CommentType">
            <xsl:if test="(CE_0364_0_IdentifierSt)[text()=&quot;RC&quot;]"> 
        <ns0:RESULTAAT_COMMENTAAR>
                    <xsl:for-each select="../NTE_3_Comment">

                        <xsl:value-of select="./text()" />
                    </xsl:for-each>
                </ns0:RESULTAAT_COMMENTAAR> 
            </xsl:if>
        </xsl:for-each>
        </xsl:if>
        <xsl:if test="local-name()='ORC_CommonOrder'" >
            <xsl:value-of select="userCSharp:SetStopForeach('false')" />
        </xsl:if>
    </xsl:for-each>

    .....

    <msxsl:script language="C#" implements-prefix="userCSharp">
 <![CDATA[ 

    public bool StopForeach=false;
    public bool GetStopForeach() {
        return StopForeach;
    }
    public string SetStopForeach(bool aValue) {
         StopForeach=aValue;
         return "";
    }

      ]]> 
      </msxsl:script> 
```

# visual-studio - 我需要购买 Visual Studio Professional 吗？

> ID：470057
> 
> 赞同：6
> 
> 时间：2009-01-22T17:23:30.277
> 
> 标签：visual-studio, visual-studio-2005

我一直在使用 Visual Studio Express 版本。我曾经使用完整的 Pro VS 2005。我无法弄清楚我在 Express 版本中缺少什么。购买完整版 VS 有什么好处？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-22T17:29:24.727

[干得好。](http://msdn.microsoft.com/en-us/library/zcbsd3cz(VS.80).aspx) 此链接特定于 vs2005，而不是最近的 2008，但这是您询问的版本。

一些亮点：

*   不支持移动设备
*   无对象测试台
*   没有扩展
*   没有内置的源代码控制支持（他们应该真正改变这一点）
*   没有远程调试
*   没有 Office 开发支持
*   不支持 64 位编译器
*   没有 Visual Studio 包支持
*   没有分析器
*   没有 SQL Server 调试集成
*   有限的部署选项

这个列表实际上很长，但是除了源代码控制之外，如果你真的需要的话，作为一个单独的开发人员，它们大部分是你*可以*做的事情。甚至源代码控制也可以由像 Tortoise 这样的仅文件系统工具来处理。

显然，如果您正在构建智能手机应用程序或 VS 扩展之类的东西，那么它是一个初学者，因此您需要评估您真正在做什么。其他一些缺失的功能，如对象测试台或分析器，可以部分替换为第三方工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T17:30:11.527

这是 Microsoft 提供的可下载[Visual Studio 2008 产品比较指南](http://www.microsoft.com/downloads/details.aspx?FamilyId=727BCFB0-B575-47AB-9FD8-4EE067BB3A37&displaylang=en)的链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T17:31:34.283

Visual Studio 的完整版支持一些额外的功能和工具。

最大的区别之一是更多的调试选项（您可以指定调试的中断条件，与 express 版本不同）。仅此功能可能就值得了。

您还可以安装 3rd 方插件来添加额外的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T18:04:54.357

没有[Resharper](http://www.jetbrains.com/resharper/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T17:26:11.143

对代码版本系统的支持是一项非常重要的功能。

微软需要你的钱来继续实施新的、热门的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T17:27:31.920

此外，您可以将 VisualSVN 和 Resharper 等插件添加到 pro 中。你不能进入快递。

Matze 可能是对的——MS 需要钱——今天裁员 5000 人，利润只有 4.7b！:(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T17:30:45.177

取决于你做什么。查看[产品矩阵](http://msdn.microsoft.com/en-us/vsts2008/products/cc149003.aspx)，了解您通过更高 SKU 获得的功能。测试、智能设备等可能与您相关，也可能不相关。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T17:31:11.507

这真的只需要一点谷歌搜索。

您可以在此处查看付费版本的比较，并[在此处](http://www.microsoft.com/visualstudio/products/teamsystem/default.mspx#compare_products)[查看](http://www.microsoft.com/Express/)Express 版本的概述

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T17:32:06.327

看看这个：

[http://blogshare.members.winisp.net/docs/VisualStudio2008-ProductComparison-v1.02-Revisions.xps](http://blogshare.members.winisp.net/docs/VisualStudio2008-ProductComparison-v1.02-Revisions.xps)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-22T17:33:22.847

如果您正在使用 Visual Studio 进行任何类型的专业开发，您应该至少购买标准版。没有它，您将失去源代码控制集成，恕我直言，这是至关重要的，绝对不能为专业发展提出任何问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-22T17:37:24.507

我用了一段时间VS2003，目前正在使用VS2008 C# Express。

就我个人而言，我想念设置条件断点而不是在击中一行时简单地中断的能力，以及线程窗口。

# iphone - 嵌套的 UIScrollView 不绘制

> ID：470066
> 
> 赞同：1
> 
> 时间：2009-01-22T17:27:18.863
> 
> 标签：iphone, cocoa-touch

我正在构建一个允许用户每天查看和编辑数据的应用程序。为了实现这一点，我在界面构建器中创建了一个包含所有日常数据的视图，并且我在适当大小的 UIScrollView 中“平铺”了这个视图，以允许用户在这些天之间滑动。该视图包含两个 UITextField、一对 UILabel 和一个 UITextView。在任何给定时间，我都有这个视图的五个实例，我重新定位并更新适当位置的数据。

除了 UITextView，一切都很好。UITextView 在用户与之交互之前不会显示其 Text 属性（我猜这会触发重绘）。

有没有一种简单的方法可以让 UITextView 在其不在屏幕上时“绘制”其内容（但仍作为子视图添加到另一个视图）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-11T09:28:48.090

您可以尝试的一件事，也就是我刚刚为解决同样的问题所做的事情，就是挂钩到父滚动视图的 scrollViewDidScroll 委托函数。然后在该函数中，向 UITextView 发送一条强制重绘的消息，我的方法是将其帧设置为同一帧。这是相当蛮力，但总比没有好。

# php - 在提交操作之前呈现 Drupal 表单

> ID：470074
> 
> 赞同：1
> 
> 时间：2009-01-22T17:28:29.203
> 
> 标签：php, drupal, drupal-6, drupal-fapi

我有一个 Drupal 模块页面，我在其中填充了一个包含用户可以上传的一组文件的可用部分列表的下拉列表。一旦用户上传了某种类型的文件，它就会从列表中删除该选项，并且当所有可用文件都上传后，表单将不会被呈现。

问题是 Drupal 在执行提交操作之前正在绘制表单，因此在用户看来该操作在重新加载页面之前不起作用。

处理这种情况的常用方法是什么？将 form_state['redirect'] 设置为转到该页面似乎不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T17:48:32.690

您修改表单，以便保存有关表单状态的一些信息。然后在提交函数的开头添加一个新案例，如果您没有完成所有文件的上传，该函数会立即返回，并且它将重新绘制表单。

```
function modulename_uploader_form(&$form_stuff=null) {
//the function that sets your form array
$stuff = (isset($form_stuff['values'])) ? 
    $form_stuff['storage']['done_uploading'] : 
    false; //if values isnt set, this is the first visit. 
$form_stuff['storage']['done_uploading'] = done_uploading();
.... the rest of your form creation function.

function modulename_uploader_submit($form, &$form_stuff) {
    if($form_stuff['storage']['done_uploading']) {
return;
}
... rest of the function 
```

确保在处理完表单后取消设置存储变量。您还可以在 drupal 中搜索多页表单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:28:22.453

在提交处理程序中设置 $form_state['redirect'] 只会导致表单重新加载，新鲜，没有旧数据。这是一种清除表单的方法，这样旧值就不会作为默认值存在。

您可能想要使用 $form_state['rebuild']，它使您的表单构建函数有机会在表单提交处理程序运行后重新构建表单的实际结构、添加更多字段或从其他字段中删除选项。

[这篇博](http://www.ferolen.com/blog/how-to-create-multistep-form-in-drupal-6-tutorial/)文有一个关于在 D6 中进行多阶段表单的粗略教程，Drupal.org 上的[Drupal 5 到 6 升级文档](http://drupal.org/node/144132#form-state)包含对 $form_state 工作原理及其各种标志的有用概述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T17:31:35.580

> 问题是 Drupal 在执行提交操作之前正在绘制表单，因此在用户看来该操作在重新加载页面之前不起作用。

我不相信。确定吗？

# c# - 将类视为使用接口定义的

> ID：470084
> 
> 赞同：2
> 
> 时间：2009-01-22T17:31:04.520
> 
> 标签：c#, casting, interface, enumeration

我有 100 个类，它们有一些相似的元素和一些独特的元素。我创建了一个接口来命名那些类似的项目，例如：接口 IAnimal。我通常会做的是：

```
class dog : IAnimal 
```

但是有 100 个课程，我不想通过所有课程来寻找可以应用 IAnimal 的课程。

我想做的是：

```
dog scruffy = new dog();
cat ruffles = new cat();

IAnimal[] animals = new IAnimal[] {scruffy as IAnimal, ruffles as IAnimal} // gives null 
```

或者

```
IAnimal[] animals = new IAnimal[] {(IAnimal)scruffy, (IAnimal)ruffles} //throws exception 
```

然后做

```
foreach (IAnimal animal in animals)
{
   animal.eat();
} 
```

有没有办法让 c# 让我将褶边和邋遢视为 IAnimal 而不必在编写类时编写：IAnimal。

谢谢！

编辑（不懒惰）：这些类是从 sql 存储的 proc 元数据生成的，这意味着每次生成它时我都必须返回并添加它们，或者修改代码生成器以识别接口中的成员，实际上那不是一个坏主意。我希望有某种泛型方法或其他东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T17:35:04.403

您所要求的称为鸭子类型，恐怕不是 C# 的一部分。任何解决方案都将涉及反射和查看属性，我认为手动检查类会更快。

不过，这将是一个有趣的项目。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T17:43:23.137

您可以使用**部分类**来解决这个问题：让机器生成/重新生成的代码位于每个类的一个源文件中，而手动编码的部分（定义 IAnimal 的子类）在另一个源文件中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T17:34:16.480

解决办法是修改代码生成器。目前它对于您的需求来说太简单了。如果类中存在相关的属性和/或方法，它应该添加接口实现。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T17:57:16.277

您可以创建一个`eat`通过反射访问“”的适配器，这是一个穷人的鸭子打字：

```
public class Adapter<T> : IAnimal
{
   private T x;

   Adapter(T x)
   {
     this.x = x;
   }

   public void eat()
   {
     x.GetType().GetMethod("eat").Invoke(this);
   }
} 
```

然后你可以像这样使用它：

```
dog scruffy = new dog();
cat ruffles = new cat();

IAnimal[] animals = new IAnimal[] {new Adapter<dog>(scruffy), new Adapter<cat>(ruffles )}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T17:35:27.320

假设你真的不能修改 cat 类有充分的理由，

您可以为继承自 IAnimal 的 cat 编写适配器，即：

```
 class cat_adapter : IAnimal
  {
       private cat baseCat;
       public cat_adapter( cat aCat)
       {
           baseCat = aCat;
       }

       // Implement IAnimal interface and redirect to baseCat
       public void eat()
       {
            baseCat.munchOnMeowMix();
       }

  } 
```

在 C++ 中，您可以使用模板，假设所有生成的类都需要调用相同的函数：

```
 template <class BaseType>
  class CAnimalAdapter : public IAnimal
  {
  private:
        BaseType* m_baseInstance;
  public:
        CAnimalAdapter(BaseType* baseInstance) :
            m_baseInstance(baseInstance)
        {
        }

        void eat()
        {
            // You will get a compiler error if BaseType doesn't have this implemented
            baseInstance->doEat();                
        }

  } 
```

也许比我更 C#-py 的人可以对反射做同样的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T17:35:32.827

我知道这并不容易，您可以使用反射进行后期绑定调用，但最好花时间编辑类或编写宏来执行此操作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T18:09:23.273

如果代码生成器将类生成为部分，您可以添加另一个实现接口的部分定义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T17:34:19.723

不，如果没有具体的基类或接口，你就无法让 C# 让你这样做。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T17:35:38.660

如果您已经实现了该方法并且只想实现接口，则可以在 IDE 中使用带有替换文件命令的正则表达式。

否则，请查看扩展方法。它们可能适合您的需要。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-22T17:37:58.047

你的类必须实现接口 IAnimal。两个不同类上的同名方法/属性不被认为是等效的，除非它们都是接口/基类的实现。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-22T17:46:15.207

如果将生成的类实现为部分类，则可以在这些类上实现接口，然后将代码生成器更改为仅生成部分类的一半。这将允许您在不丢失接口实现（或您决定添加的任何其他自定义逻辑）的情况下重新生成类。

这种方法是 LINQ to SQL 生成类文件的方式。

# c# - 如何在 UML 中表示 C# 属性？

> ID：470097
> 
> 赞同：37
> 
> 时间：2009-01-22T17:33:28.680
> 
> 标签：c#, .net, properties, uml

不完全是属性，也不完全是方法。刻板印象？`<<get>>` `<<set>>`?

* * *

*我正在对现有系统进行复古建模，所以我需要清楚地反映这与只读字段或方法对不同（不管 IL 说什么），所以我想我会采用刻板印象，但我会接受独立于语言的 get_set_ 作为一般解决方案。谢谢大家的理智测试。*

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-22T18:02:48.730

我通常在 Visio 中准备我的 UML 图（我知道，我知道；但是你要做什么？）。

在绘制属性图表时，它们最终是这样的：

```
+------------------------+
| MyClass                |
|------------------------|
| - _foo : int           |
|------------------------|
| «property» + Foo : int |
+------------------------+ 
```

«property» 是从 «operator» 派生的自定义构造型。

丑陋，我知道。但它有效，而且很清楚。我以同样的方式做构造函数。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-22T17:41:22.160

属性只是一种方便的编写`get_MyValue()`和`set_MyValue(value)`允许赋值的方式，而不是普通的方法调用（使用括号）。

您正在访问的实际上是一个 .NET 属性，C# 有自己的语法来访问这些属性。由于在皮肤下创建了真实`get_`和`set_`方法，因此您可以简单地显示这些方法（使您的 UML 语言独立 - 例如使您的 UML 同样适用于 VB.NET 开发人员）

... 或者正如您所建议的，介绍您自己的刻板印象！

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-22T17:40:00.883

您可以用与字段相同的方式表示属性。要指定附加信息，如只读或只写，您可以使用

+名称：字符串 {READONLY}

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-05-03T12:50:05.713

我一直在属性名称旁边使用`<<get>>`和构造型，因此它们看起来像字段，但允许您区分or的访问修饰符：`<<set>>``get``set`

```
+=============================+
| ClassName                   |
+-----------------------------+
| +<<get>> Id : int           |
| -<<set>> Id : int           |
| +<<get>> IsSomething : bool |
+-----------------------------+
| + Method1(arg1 : string)    |
+=============================+ 
```

或者，如果您不想多次出现一个属性，这也可以工作：

```
+=============================+
| ClassName                   |
+-----------------------------+
| +<<get>> -<<set>> Id : int  | 
```

为了减少混乱，如果`get`和`set`具有相同的访问修饰符：

```
+====================================+
| ClassName                          |
+------------------------------------+
| +<<get, set>> Description : string |
| +<<get>> -<<set>> Id : int         | 
```

这清楚地传达了属性是否具有 get 或 set，以及它是否是只读的（通过`<<set>>`在类图中不存在）。所以基本上你在问题中所说的。

虽然属性是 getter 和 setter 方法的语法糖，但它们应该感觉像字段，我相信 UML 图应该反映这一事实，同时也传达什么是公共的和什么是私有的，以及是否是 setter存在与否。

* * *

**更新：**我使用这个符号已经有一段时间了，并做了一些细微的修改。

**只读属性**

```
+<<get>> IsVisible : bool 
```

没有集合的 get 意味着：

```
public bool IsVisible => // logic goes here 
```

**具有只读支持字段的自动属性**

```
+<<get>> Id : int {readonly} 
```

暗示：

```
public int Id { get; } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-06T12:48:45.630

我会将它们作为 UML 中的公共字段，因为这就是它们的概念。UML 不是您的编程语言的语法（尽管一些工具供应商声称它是）。

关于您的实现语言如何处理属性的详细信息不需要在 UML 中显示。这将完全违背使用 UML 作为抽象实现细节并让您专注于设计的工具的意义。

如果该属性在某些方面是特殊的，例如它是派生的或只读的，您可以使用构造型注释对其进行标记。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T17:36:02.747

嗯，我只是把它作为我的伪UML图中的一种方法。:-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-22T17:39:28.653

属性是用一些更好的语法包装的 Get/Set 方法。只需将它们作为方法放入，或为它们创建一些新的 UML 语法 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-10-19T14:21:46.227

将属性描述为单个字段的问题在于，对于使用 2.0 框架及更高版本的 C#，get 和 set 可以具有不同的访问修饰符。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-26T12:22:20.420

我同意workmad3。属性只是使 get/set 方法更好一点的技巧。出于这个原因，我认为它应该保存为两种不同的方法。在这种情况下，您还可以为他们设置不同的访问权限

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-08-12T13:02:27.193

您可以对类图中的字段使用称为“property”的构造型（例如<< Property >> PropertyName）。刻板印象用于扩展 UML 表示法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-06T12:52:34.140

我这样用

```
-memberThePropertyWillExpose
+memberThePropertyIsExposing 
```

好吧，如果这是正确的方法，欢迎对此发表评论！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-29T18:29:13.467

在 Visio 中，您可以为属性创建一个 <<readonly>> 构造型，并且只为每个只读属性使用这个构造型。只写也一样。它会告诉你一个很好的符号：

```
<<readonly>> +PropertyName : int 
```

它没有什么丑陋的。标准 Visio 的 Changeable 选项更难看，因为它没有任何可视化表示，您实际上需要打开每个属性的属性才能看到它，没有机会在打印的图表上看到它。

# web-services - 使用 Netbeans 平台使用 Web 服务

> ID：470098
> 
> 赞同：3
> 
> 时间：2009-01-22T17:34:00.567
> 
> 标签：web-services, netbeans, platform

我有一个使用 NetBeans Platform 5.5 编写的应用程序。我无法使用 Web 服务。

如果我在 NetBeans 中创建 Java SE 应用程序，我可以毫无问题地添加 Web 服务引用。

由于我的应用程序使用的是 NetBeans 平台，因此许多菜单选项发生了变化。因此，我无法弄清楚如何添加对 Web 服务的引用。我已经通过多种方式搜索了这个主题，但没有找到任何处理通过平台使用服务的页面。他们都在谈论使用 Java SE 应用程序使用服务。

从平台架构更改应用程序不是一种选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-14T08:12:15.940

这是在 NetBeans 平台上设置提要阅读器的[好教程。](http://platform.netbeans.org/tutorials/nbm-feedreader.html)它涵盖了使用 Web 服务的一些配置问题

包含有关制作 Web 服务客户端的[条目](http://tdamir.blogspot.com/2008/03/netbeans-platform-based-web-service.html)的博客

如果您可以提供有关您想要访问的服务的信息，我很乐意尝试给您一个更具体的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-27T14:04:30.677

发现这个：

1.  [使用本教程](http://www.netbeans.org/kb/60/websvc/jax-ws.html)创建 Web 服务和客户端
2.  为 Web 服务客户端创建库包装模块（您不需要包含 JAX-WS 库，只需包含您的客户端 jar）
3.  在您的包装模块中添加以下依赖项（重要）：
    *   JAX-WS 2.1 API
    *   JAX-WS 2.1 和 JAXB 2.1 库（为此，您必须在“添加模块依赖项”窗口中检查显示非 API 模块）
4.  如果您在这些步骤之后尝试构建模块，它将无法告诉您您的模块不是 " 的朋友`path-to-netbeans"/java2/modules/org-netbeans-modules-websvc-jaxws21.jar`。右键单击 JAX-WS 2.1 和 JAXB 2.1 库并选择编辑。选择实现版本。

从[这里](http://tdamir.blogspot.com/2008/03/netbeans-platform-based-web-service.html)。

# web-services - 查看 MyService.svc?wsdl 时 WCF 不使用计算机名而不是域名

> ID：470111
> 
> 赞同：32
> 
> 时间：2009-01-22T17:36:27.660
> 
> 标签：web-services, wcf, iis, ssl, configuration

我的 WCF 服务似乎使用的是计算机名而不是域名。当我查看`MyService.svc?wsdl`链接时，它显示我的计算机名称。

在 web.config 中的何处添加我的域名？端点地址、基地址或身份？

注意：我使用的是 SSL，所以它必须是`https://www.example.com/myservice.svc`

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-11-09T10:17:36.070

WCF 4.0 在某些情况下通过使用请求标头的新配置选项解决了这个问题：

```
 <behaviors>
        <serviceBehaviors>
            <behavior name="AutoVaultUploadBehavior">
                <useRequestHeadersForMetadataAddress>
                    <defaultPorts>
                        <add scheme="https" port="443" />
                    </defaultPorts>
                </useRequestHeadersForMetadataAddress> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-21T08:22:27.833

对于 IIS7，您不需要将其添加到 web.config，而是添加到 IIS 配置文件中。

首先编辑您的网站的绑定，以便 HTTP 协议指定一个主机名（如果您还没有） - 这将确保它在 HTTP 下获得正确的名称。

导航到 C:\Windows\System32\inetsrv\config 并打开 applicationHost.config

寻找网站部分。您将看到类似以下内容

```
<sites>
  <site name="Default Web Site" id="1">
    <application path="/">
        <virtualDirectory path="/" physicalPath="%SystemDrive%\inetpub\wwwroot" />
    </application>
    <bindings>
      <binding protocol="http" bindingInformation="*:80:puck" />
      <binding protocol="net.tcp" bindingInformation="808:*" />
      <binding protocol="net.pipe" bindingInformation="*" />
      <binding protocol="net.msmq" bindingInformation="localhost" />
      <binding protocol="msmq.formatname" bindingInformation="localhost" />
      <binding protocol="http" bindingInformation="*:80:puck.idunno.org" />
      <binding protocol="http" bindingInformation="*:80:localhost" />
      <binding protocol="https" bindingInformation="*:443:" />
    </bindings>
  </site>
  ....
</sites> 
```

您可以看到 http 协议的绑定指定了主机标头，但 https 没有。当你在浏览网页时，你不能通过 HTTPS 使用主机头，但是 WCF 在生成 WSDL 时仍然使用它——如果它找不到一个，它将回退到机器名称。

因此，您需要做的就是像这样编辑 HTTPS 绑定

```
 <binding protocol="https" bindingInformation="*:443:puck" /> 
```

将正确的 FQDN 附加到绑定信息的末尾。重置 IIS 和 WCF 应该现在就可以了。

IIS6 解决方案已经由darin 发布

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-07T10:38:59.627

如此链接中所述，[WCF 使用计算机名称而不是 IP 地址，无法解析](https://stackoverflow.com/questions/6863464/wcf-is-using-the-computer-name-instead-of-the-ip-address-and-cannot-be-resolved)

它解决了我的问题，可能是因为我在同一主机上有多个网站，而且非常简单。

```
<system.serviceModel>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-21T09:26:39.430

解决此问题 在 web.config 文件中配置 httpGetEnabled 属性和 httpsGetEnabled 属性

```
<serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" /> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-21T08:08:11.670

我们正在使用[WCFExtras](http://wcfextras.codeplex.com/)来更改主机的名称。

WCFExtras 是一个小型开源库，可让您编写以下代码来更改主机名：

```
<behaviors>
  <endpointBehaviors>
    <behavior name="xxx">
      <wsdlExtensions location="http://some-hostname-visible-from-outside/path-to-a-service/service.svc" singleFile="True" />
    </behavior>
  ... 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-01T18:28:55.947

只是添加 `<useRequestHeadersForMetadataAddress></useRequestHeadersForMetadataAddress>` 到解决我的问题。似乎 WCF 4.0 通过添加我使用 SSL 访问 WCF 服务来处理标头。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-13T12:56:47.567

虽然它是一个旧帖子，但这里有一个答案。在 Service Behavior --> ServiceMetaData 添加服务 url。

请注意，如果您不添加 myService，它将引发另一个错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-03T14:51:35.887

我的生产服务器遇到了这个问题。我找到了有关 IIS 和 WCF 问题的多个主机标头的各种文章，但是如果您使用 SSL，则无法将主机标头添加到 IIS UI 中的网站身份，您只能将它们添加到正常的 HTTP 身份：

![在此处输入图像描述](https://i.stack.imgur.com/RlKtt.jpg)

但是，您可以通过命令提示符脚本添加 SSL 主机标头，这为我解决了这个问题：

```
cscript.exe adsutil.vbs set /w3svc/<site identifier>/SecureBindings ":443:<host header>" 
```

有关这方面的更多信息，请参阅此链接：[http ://blumenthalit.net/blog/Lists/Posts/Post.aspx?ID=14](http://blumenthalit.net/blog/Lists/Posts/Post.aspx?ID=14)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-08-09T16:58:01.577

这些解决方案都对我没有帮助。我能够通过一个非常简单的自定义服务工厂来解决这个问题。

[在共享主机站点上安装 WCF 服务，重新访问](http://www.itscodingtime.com/post/Installing-a-WCF-Service-on-a-Shared-Hosting-Site-Revisited.aspx)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-06-23T08:14:48.553

我在这里添加了解决方案， http: [//knowledgebaseworld.blogspot.com/2010/06/domain-name-replaced-with-machine-name.html](http://knowledgebaseworld.blogspot.com/2010/06/domain-name-replaced-with-machine-name.html)。它应该对你们所有人都有效，因为它在本地、分期和生产方面与我一起工作良好，而无需对 iis 进行绑定

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-10-05T10:44:18.600

您是否尝试过[在 IIS 中设置主机标头](http://gavinmckay.wordpress.com/2009/03/24/howto-fix-wcf-host-name-on-iis/)？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-06-09T14:51:10.677

这篇文章为我解决了这个问题。我需要将我的域名与我在 IIS 中的 IP 地址和网站相关联。

[http://www.codemeit.com/wcf/wcf-wsdl-xsdimport-schemalocations-link-to-local-machine-name-not-domain-name-while-hosted-in-iis.html](http://www.codemeit.com/wcf/wcf-wsdl-xsdimport-schemalocations-link-to-local-machine-name-not-domain-name-while-hosted-in-iis.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-02-20T06:05:54.410

感谢卡纳斯罗伯特。解决我的问题的步骤 - 1.在浏览器中生成 wsdl 并保存到文件（通过从浏览器中点击 .svc?wsdl）另存为 .wsdl

2.  通过从 wsdl（xsd=xsd0 等）点击 url 生成 xsd 文件，并从浏览器保存到文件，另存为 .wsdl

3.  用域名（或 IP 地址）替换来自 wsdl 的所有机器名引用并更改 xsd 引用并保存并用域名（或 IP 地址）替换来自 xsd 文件的所有机器名引用确保使用 .xsd 扩展名命名 xsd 文件（即, name0.xsd, name1.xsd, name2.xsd)

4.  将 wsdl 和 xsd 文件复制到虚拟目录添加到您的 web.config 以下行：

```
<behaviors>
      <serviceBehaviors>
        <behavior name="MyServiceBehavior">
          <serviceMetadata httpGetEnabled="true" externalMetadataLocation="http://IPorDomainName/MyServices/FileTransferService.wsdl"  />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
```

# .net - ObjectIDGenerator 与 HashSet

> ID：470114
> 
> 赞同：1
> 
> 时间：2009-01-22T17:36:58.220
> 
> 标签：.net, hash

谁能告诉我 ObjectIDGenerator 在遍历对象层次结构（可能是递归/循环）时如何更好（更糟？）然后使用 HashSet，并且不想遍历同一个对象两次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T17:42:50.347

基本区别在于每个人如何平等。

ObjectIdGenerator 查看引用身份。当检查对象是否已经存在时，它将简单地对两个对象实例执行 == 调用。这将归结为参考比较，因为此时对象是静态类型的对象。除非您的对象明确使用 .Equals() 来表示相等，否则这很好。如果两个对象通过 .Equals() 相等但引用不同，ObjectIDGenerator 将认为它们是不同的对象。可能不是你想要的。

另一方面，HashSet 允许您自定义通过 IEqualityComparer<T> 参数比较对象的方式。如果没有指定，它将使用 EqualityComparer<T>.Default ，它将使用值相等。此方法将调用 .Equals() 并依赖它来确定两个对象是否相等。如果您没有为您的类型定义 .Equals() 方法，它将默认返回到引用相等，这几乎可以肯定是您想要的。

简而言之，使用 HashSet :)

显示差异的示例代码：

```
class Person
{
    public readonly string Name;
    public Person(string name) { Name = name; }
    public override int GetHashCode()
    {
        return Name.GetHashCode();
    }
    public override bool Equals(object obj)
    {
        var other = obj as Person;
        if (other == null)
        {
            return false;
        }
        return StringComparer.Ordinal.Equals(Name, other.Name);
    }
}

public static void Example()
{
    var gen = new ObjectIDGenerator();
    bool isFirst;
    var person1 = new Person("John");
    var person2 = new Person("Bob");
    gen.GetId(person1, out isFirst);    // isFirst = true
    gen.GetId(person1, out isFirst);    // isFirst = false
    gen.GetId(person2, out isFirst);    // isFirst = true
    gen.GetId(new Person("John"), out isFirst); // isFirst = true even though they are .Equals()

    var set = new HashSet<Person>();
    set.Add(person1);
    var contains1 = set.Contains(person1);              // true
    var contains2 = set.Contains(new Person("John"));   // true
} 
```

# c# - 如何将 DTE.ActiveWindow.Selection 转换为 VS2008 宏中最接近的 CodeElement？

> ID：470117
> 
> 赞同：2
> 
> 时间：2009-01-22T17:37:46.940
> 
> 标签：c#, .net, visual-studio, visual-studio-macros, envdte

我正在使用 Visual Studio 2008 对象模型，如下所示：[VS2008 Automation Object Model Chart](http://msdn.microsoft.com/en-us/library/za2b25t3.aspx "VS2008自动化对象模型图")。

我想对`CodeElement`VS2008 Marco 中的 a 采取行动，这是由当前 .cs 文档中用户的文本选择所选择的。

虽然我真的不在乎我是如何得到它的，但这是我尝试过的：VS 对象模型为您`DTE.ActiveWindow.Selection`提供 type `TextSelection`，然后有一个`DTE.ActiveDocument.ProjectItem.FileCodeModel.CodeElementFromPoint()`方法将 a`TextPoint`和`vsCMEElement`作为参数并返回`CodeElment`我想要的。

但是我似乎无法`TextElement`从`TextSelection`.

有人能告诉我如何`CodeElement`从 .cs 文件中的选定文本中获取一个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T14:55:16.520

试试这个：

textSelection = DTE.ActiveWindow.Selection

codeElement = textSelection.ActivePoint.CodeElement(vsCMElement.vsCMElementClass)

# standards - 何时最好更改代码以符合标准？

> ID：470120
> 
> 赞同：2
> 
> 时间：2009-01-22T17:38:39.433
> 
> 标签：standards, coding-style, puremvc

我最近负责调试两个不同的程序，它们最终至少需要共享一个 XML 解析脚本。一个是用 PureMVC 编写的，另一个是从头开始构建的。虽然最初从头开始编写它是有意义的（它节省了大量内存，但内存问题已经解决）。

移植非 PureMVC 应用程序将花费大量时间和精力，这并不需要使用，但它会使文档和代码共享更容易。它还将降低整体学习曲线。考虑到这一点：

## 1.在考虑是否最好将事物移至一个标准时应该考虑什么？

* * *

### （在相关说明中）

有些代码有点奇怪。因为解释应用程序必须将命令从一种语法转换为另一种语法，所以有一个解释器对象是有意义的。因为需要与外部环境进行通信，所以让一个对象与环境交互并*专门*与解释器打交道更有意义。

实际上，创建了一个反单身人士。该对象只会与解释器交互，仅此而已。如果另一个类的成员试图调用其公共方法之一，则该对象将引发异常。

有更好的方法可以做到这一点，但这肯定有点奇怪。有更多标准的方法来完成同样的事情，尽管它们通常涉及创建非常大的类或类文件。我能找到的唯一符合标准的解决方案将涉及当前所需的评论和解释，如果不是更多的话。考虑到这一点：

## 2\. 如果某些代码很古怪，但很有效，是否最好对其进行更改以使其不那么古怪，即使它变得更笨拙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T17:43:14.557

在我看来，这种类型的重构通常不会在时间表中考虑，只能在有额外时间的情况下进行。

通常情况下，交付代码的标准是它是否有效，**而不一定是它是否是最好的代码解决方案**。

因此，在回答您的问题**时，我会在有时间的时候尝试重构**。优先级仍然是生成一段功能代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T03:20:48.227

需要考虑的事项：

*   它按原样工作吗？

正如 Galwegian 所说，这是许多商店的唯一标准。然而，IMO 同样重要的是：

*   将要维护它的程序员有多熟练？他们有没有遇到过非标准代码？将他们学习它的时间成本（包括延迟发布的成本）与重构它的时间成本进行比较。

如果您要维护它，请考虑：

*   在代码库的预期生命周期（例如，从现在到重写整个代码之间的时间），处理非标准代码会花费您多少时间？

这很难猜测，但考虑到许多代码库远比其原始作者所设想的有用性要长。（Y2K 有人吗？）我逐渐形成了一种重构的感觉，什么时候值得重构，什么时候不值得，主要是因为经常在“不”这一边犯错，后来又后悔了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T17:42:08.070

仅当您无论如何都需要进行更改时才更改它。但不那么古怪总是一个好目标。花在特定软件上的大部分时间都花在了维护上，所以如果你能做些事情让它变得更容易，你就会减少花在这段代码上的总时间。尽管如此，如果它正在工作并且不需要任何修改，请不要更改某些内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-04T07:41:03.430

如果你有时间，现在。如果您没有时间，可以避免，以后再做。

# visual-studio - Perforce 和 SourceSafe 可以在 Visual Studio 中共存吗？

> ID：470134
> 
> 赞同：6
> 
> 时间：2009-01-22T17:41:08.710
> 
> 标签：visual-studio, version-control, visual-sourcesafe, perforce

更具体地说，Visual Studio 2008。我们正在测试迁移到 Perforce 以进行源代码控制，所以我想安装 P4SCC 插件来玩转。但是，我还想继续为尚未迁移的项目使用 SourceSafe 的 IDE 功能。两者能否和平共存，或者对于特定的 VS 安装，两者是其中之一？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T17:47:38.183

Visual Studio 可以处理多个源代码管理插件/系统，但您需要确保您的项目绑定到正确的提供程序（文件->源代码管理->更改源代码管理）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-11T23:54:06.780

是的，Visual Studio 支持多个提供程序。整个 VS 架构都是基于插件的，而 SCC 提供程序只是另一种插件（通常在 VS 术语中实现为“包”）。

您一次只能激活一个 SCC 提供者。因此，您不能在同一解决方案中将不同的项目绑定到不同的提供商。

可以通过以下方式切换活动的 SCC 提供程序：

*   转到工具 -> 选项 -> 源代码管理（自 VS 2005 起提供）-或-
*   使用[SccSwitcher](http://www.codeproject.com/KB/applications/sccswitcher.aspx)之类的工具直接修改注册表（VS 2003 及更早版本需要）
*   打开已写入 SCC 绑定的解决方案

您无法从“绑定”对话框（文件 -> 源代码管理 -> 更改 SCC）中更改提供程序。您所能做的就是绑定/取消绑定，或者对于像 SourceSafe 这样的一些奇怪的提供程序，编辑服务器路径。

要更改现有解决方案的提供者，您将使用“绑定”对话框删除现有绑定，从“工具”->“选项”（或 SCCSwitcher，如果需要）更改活动提供者，然后从“解决方案资源管理器”启动“将解决方案添加到源代码管理”向导。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T23:37:02.923

我用：

[SCC 切换器](http://www.codeproject.com/KB/applications/sccswitcher.aspx)

帮我解决这个问题。它很方便，因为它为您提供了一个用于切换的托盘栏图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-08T16:30:36.793

我还推荐 TraySource 与 SCC Switcher 相同

我经常需要在 Perforce 和 Source Safe 之间切换，发现这非常适合它

# c# - 如何通过 P/Invoke 编组 cstring*？

> ID：470135
> 
> 赞同：1
> 
> 时间：2009-01-22T17:41:10.567
> 
> 标签：c#, pinvoke

我正在尝试从 C# 调用第 3 方 DLL，但在编组一些字符串数据时遇到了麻烦。DLL 是用 Clarion 编写的，我对所使用的数据类型不是很熟悉。具体来说，规范有一个我无法工作的功能的签名：

```
Bool QuerySoftwareVersion( cstring* version)  // edited documentation typo
//Returns Software version (20 character cstring). 
```

我假设 cstring 只是一个以 null 结尾的字符串，但我无法让它`out char[] version`在我的定义中使用。有人知道处理这个问题的正确方法吗？

编辑：实际上，到目前为止我所发现的表明 Clarion 中的 cstring 确实只是一个以空字符结尾的字符串。

更新：我更新了问题的标题和详细信息，因为事实证明 DLL 文档中有错字。有问题的`version`参数被声明为 type `cstring*`not `cstringt*. And in Clarion,`cstring` 显然只是一个 c 风格的、以 null 结尾的字符串。所以编组不应该那么复杂，因为他们声称它是用 C 调用约定编写的。有没有人成功地 p/invoked 通过引用参数传递字符串的 Clarion DLL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-01T23:11:17.933

I've never called into Clarion, but I've got a DLL (in C) that is called from both Clarion and C#, and I'd interop that as:

```
[DllImport("clarionlib.dll", CharSet=CharSet.Ansi,
CallingConvention = CallingConvention.Cdecl,
ExactSpelling=true, EntryPoint="QuerySoftwareVersion")] static extern
            bool QuerySoftwareVersion(StringBuilder sName); 
```

Note also that the StringBuilder parameter you pass has to be sized up to the maximum expected return size (pardon my C#, I'm sure there's a shorter equivalent):

```
System.Text.StringBuilder buffer;
buffer = new System.Text.StringBuilder();
buffer.EnsureCapacity(21);
QuerySoftwareVersion(buffer);
string myString = buffer.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-19T16:28:30.687

我在 DLL API 中使用 CString 引用取得了一些成功：

```
SCODE WINAPI Test( const CString& str ); 
```

我使用以下 C# 代码导入：

```
[DllImport("CBData.Dll")]
public static extern int Test( [MarshalAs(UnmanagedType.LPStr)] ref String str ); 
```

这个 C# 代码调用：

```
String b = "Some text";
int x = Test(ref b); 
```

这对我有用 - 我不确定这是否安全。我希望这可以帮助你。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-22T17:50:20.190

尝试使用 StringBuilder：

```
[DllImport("mylibrary.dll")]
static extern bool QuerySoftwareVersion([Out] StringBuilder version); 
```

# asp.net - 在 IIS 中配置 ASP.NET 应用程序

> ID：470136
> 
> 赞同：2
> 
> 时间：2009-01-22T17:41:12.033
> 
> 标签：asp.net, iis, iis-6, web-config

我继承了一些 aspx（包括 web.config 文件）并收到以下错误。我已经为它创建了一个虚拟目录，但我不确定如何“将它配置为应用程序”？

```
Configuration Error 
Description: An error occurred during the processing of a configuration file
required to service this request. Please review the specific error details 
below and modify your configuration file appropriately. 

Parser Error Message: It is an error to use a section registered as 
allowDefinition='MachineToApplication' beyond application level.  This error 
can be caused by a virtual directory not being configured as an application 
in IIS.

Source Error: 

Line 49:             ASP.NET to identify an incoming user. 
Line 50:         -->
Line 51:        <authentication mode="Windows"/>
Line 52: 
Line 53:     <customErrors mode="Off"/>

Source File: C:\<MYPATH>\web.config    Line: 51 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T17:45:24.583

进入虚拟目录的属性，单击“虚拟目录”选项卡，然后单击“应用程序设置”下的“创建”按钮，然后将“执行权限”设置为“仅脚本”

还要检查 ASP.NET 选项卡以确保它设置为您的应用程序的正确版本。

最后，确保用于虚拟目录的应用程序池仅由使用相同版本 ASP.NET 的其他站点和虚拟目录使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T17:47:34.063

右键单击您的虚拟目录-属性-选项卡“虚拟目录”单击中间的按钮“创建”并为您的应用程序命名

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T17:45:41.167

在 IIS6 MMC 中，右键单击应用程序部署到的文件夹，单击属性，然后单击创建按钮。

这将创建一个 IIS 应用程序。

哦，确保从 ASP.NET 选项卡中选择正确的 ASP.NET 版本，并确保它驻留在所选 ASP.NET 版本的正确应用程序池中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T17:45:56.003

调出 vdir 的属性。验证它是否是应用程序，在虚拟目录选项卡上查看应用程序设置，如果它不是应用程序，请单击创建。

如果文件夹是应用程序，则 vDir 图标也不同，应用程序是打开的小框，非应用程序 vdir 显示带有小地球的文件夹图标。

# python - 为什么 1+++2 = 3？

> ID：470139
> 
> 赞同：31
> 
> 时间：2009-01-22T17:41:44.513
> 
> 标签：python, evaluation, operator-precedence

Python 如何评估表达式`1+++2`？

我在两者之间放了多少`+`，它正在打印`3`作为答案。请任何人都可以解释这种行为

因为`1--2`它正在打印`3`，`1---2`它正在打印`-1`

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-22T17:46:08.390

您的表达方式与以下内容相同：

```
1+(+(+2)) 
```

任何数字表达式都可以在其前面加上`-`负数，或者`+`什么都不做（该选项是为了对称而存在的）。带有负号：

```
1-(-(2)) = 1-(-2)
         = 1+2
         = 3 
```

和

```
1-(-(-2)) = 1-(2)
          = -1 
```

我看到你澄清了你的问题，说你来自 C 背景。在 Python 中，没有像C 中的`++`和这样的增量运算符`--`，这可能是您困惑的根源。要增加或减少变量`i`或`j`在 Python 中使用此样式：

```
i += 1
j -= 1 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-22T17:47:04.330

额外的 + 不是增量符（如 c++ 中的 ++a 或 a++）。他们只是表明这个数字是正数。

没有这样的 ++ 运算符。但是有一个一元 + 运算符和一个一元 - 运算符。一元 + 运算符对其参数没有影响。一元 - 运算符否定其运算符或将其乘以 -1。

```
+1 
```

-> 1

```
++1 
```

-> 1

这与 +(+(1)) 相同

```
 1+++2 
```

-> 3 因为和 1 一样 + (+(+(2))

同样，您可以使用 --1 来表示 - (-1)，即 +1。

```
 --1 
```

-> 1

为了完整起见，没有 * 一元运算符。所以 *1 是一个错误。但是有一个 ** 运算符是幂的，它需要 2 个参数。

```
 2**3 
```

-> 8

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T17:46:22.977

1+(+(+2)) = 3

1 - (-2) = 3

1 - (-(-2)) = -1

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-22T17:47:47.903

尝试[一元加号和一元减号](http://docs.python.org/reference/expressions.html#unary-arithmetic-operations)：

> 一元 - （减号）运算符产生其数字参数的否定。
> 
> 一元 +（加号）运算符产生其数字参数不变。

```
>>> +2
2
>>> ++2
2
>>> +++2
2
>>> -2
-2
>>> --2
2
>>> ---2
-2
>>> 1+(++2)
3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T17:47:08.230

将其视为 1 + (+1*(+1*2)))。第一个 + 是运算符，后面的加号是第二个操作数 (= 2) 的符号。

就像 1---2 与 1 - -(-(2)) 或 1- (-1*(-1*(2)) 一样

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T17:47:36.030

我相信它被解析为，第一个 + 作为二元运算（加法），其余作为一元运算（正数）。

```
 1 + (+(+2)) 
```

# java - 将 Hudson 作业移动到另一台服务器

> ID：470141
> 
> 赞同：10
> 
> 时间：2009-01-22T17:42:23.390
> 
> 标签：java, continuous-integration, hudson

我已经使用在 Tomcat 上运行的 Hudson 设置了一个持续集成构建。我现在需要移动这个不同的 Tomcat 实例，但不想从头开始配置所有内容。

是否有一个配置文件定义了我可以复制到新服务器的每个作业，或者可以通过用户界面导入/导出作业？

谢谢，唐

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-22T17:55:12.740

检查运行 hudson 进程的用户的主目录中的 .hudson 目录。（至少：如果您在 Linux 上使用 java -jar hudson.war 运行它，那么这就是 hudson 将其配置文件写入的位置）。

另外：[http ://wiki.eclipse.org/Administering_Hudson](http://wiki.eclipse.org/Administering_Hudson)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-07T14:24:29.737

由于我不能投票，我会补充说西蒙的答案是最好的。可在以下位置找到有关复制和移动作业的相关部分的链接： [http ://wiki.hudson-ci.org/display/HUDSON/Administering+Hudson#AdministeringHudson-Moving/copying/renamingjobs](http://wiki.hudson-ci.org/display/HUDSON/Administering+Hudson#AdministeringHudson-Moving/copying/renamingjobs)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T17:55:31.303

当我们迁移到新服务器时，我们只是将`jobs`文件夹复制到新服务器。`builds`每个作业的文件夹中可能有大量数据，因此我们将其排除在外。

转移后一切对我们来说都很好，但我们有一个相当简单的初始设置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T16:10:57.030

工作导入插件就可以了。从另一个 Jenkins 实例导入作业。

这是 Jenkins Job 导入插件：

[https://wiki.jenkins-ci.org/display/JENKINS/Job+Import+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Job+Import+Plugin)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T16:54:00.907

One best practice is to create an environment variable HUDSON_HOME on the server running Hudson. This variable name will be used by Hudson to store all configuration and job data.

Without this variable Hudson will create a folder under $USERHOME/.hudson (On Windows it will be c:\Documents and Settings[user].hudson].

One advantage of using HUDSON_HOME variable is that it will allow you to start Hudson with any user, what is somehow common when using a remote Windows server to host.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-10T18:28:00.737

In the jobs/[job name] directory there is a config.xml file. This is the one I typically mark for backup when I backup a new Hudson job.

You should be able to just copy it over and maybe modify minor details, depending on your Hudson setup and environment variables.

# c# - ASP.NET 多字段验证

> ID：470161
> 
> 赞同：3
> 
> 时间：2009-01-22T17:46:33.380
> 
> 标签：c#, asp.net

在 ASP.NET 2 中，我使用了 Field Validators 和 RequiredField 验证器，但我不确定如何处理这样的情况。
我在一个页面上有两个复选框，我需要确保至少设置了一个。因此，如果您以二进制形式查看，它可以是 01、10 或 11，但不能是 00。我的问题是，使用复选框最好的方法是什么？

普通的 ASP 验证器可以处理这个问题，还是我需要像上面提到的那样创建一个整数值，隐藏在某个地方并使用 RangeValidator 进行测试以确保该值永远不会为零？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T17:51:17.240

最坏的情况是你可以编写一个 CustomValidator 来做任何你喜欢的事情。听起来你需要的是：

isValid = Check1.Checked | 检查2.检查

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T17:49:01.923

使用[自定义验证器](http://msdn.microsoft.com/en-us/library/9eee01cx.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T17:49:03.983

这个控件（由我编写）支持 CheckBox 和 CheckBoxList：

[http://www.codeproject.com/KB/validation/AtLeastOneOfValidator.aspx](http://www.codeproject.com/KB/validation/AtLeastOneOfValidator.aspx)

只需将其添加到 Visual Studio，将其放在您的页面上，然后将您的复选框添加到它的控件列表中。它将像任何其他验证器控件一样工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T19:15:43.777

自定义验证器是显而易见的解决方案。此外，当使用自定义验证器时，您还应该在服务器端检查有效性，以防 javascript 由于某种原因而失败。

PS：不要总是相信客户端（浏览器）发送给你的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-14T04:37:28.040

这是我写的关于这个确切问题的文章。我还想验证多个控件，这很容易使用 CustomValidator，但我不满意的问题之一是，如果您更正了验证问题，则错误在您发回之前不会消失。

我想出了一种方法来隐藏错误消息并重新验证并写了一篇关于它的小博客文章。检查一下，看看你的想法。

[http://coding.infoconex.com/post/ASPNET-CustomValidator-that-validates-multiple-controls-using-both-Server-Side-and-Client-Side-scripting.aspx](http://coding.infoconex.com/post/ASPNET-CustomValidator-that-validates-multiple-controls-using-both-Server-Side-and-Client-Side-scripting.aspx)

# c - 将 32 位变量的类型更改为 64 位变量？

> ID：470167
> 
> 赞同：0
> 
> 时间：2009-01-22T17:47:40.820
> 
> 标签：c

我的应用程序在 pSOS 操作系统上运行。代码使用 Diab C 编译器编译。

该应用程序定义了许多已声明为的计数器

```
unsigned int call_count; 
```

由于其中一些有可能在很短的时间内溢出，我决定将计数器声明为

```
unsigned long long int call_count; 
```

我相信这至少在我有生之年不会溢出。

我的问题是这种转换无害吗？有没有我需要关心的开销。当应用程序处于压力之下时， call_count 将不断增加。性能会受到打击吗？SNMP 管理器也将每 15 秒查询一次这些计数器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T07:08:08.643

您的代码是否假设递增 32 位变量是原子操作？在 32 位 CPU 上递增 64 位变量可能不会是原子的，除非您竭尽全力做到这一点。

例子：

1.  `call_count`等于`0x00000005FFFFFFFF`来电时。
2.  的下半部分`call_count`递增：`call_count`设置为`0x000000500000000`并且 CPU 的进位位设置为 1。
3.  的上半部分`call_count`由进位位递增：`call_count`设置为`0x0000000600000000`。

如果另一个线程或中断处理程序读取第`call_count`2 步和第 3 步之间的值，它将得到错误的结果（`0x000000500000000`而不是`0x000000600000000`）。解决方案是同步访问`call_count`. 几种可能性：

*   禁用中断（如果适用）
*   使用锁序列化访问
*   使用原子/互锁函数读取和写入（例如：`InterlockedIncrement()`在 Windows 上）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T17:51:21.983

我怀疑是否存在性能问题，至少如果您使用 64 位处理器，因为变量几乎总是在缓存中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T17:53:43.477

在广泛的范围内，这种变化是无害的。您需要确保任何访问该值的代码都准备好处理 64 位数量，并且任何格式化其值的代码都需要更改，但除此之外，它应该足够安全——在没有任何有关将被更改破坏的其他代码的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T03:18:38.763

你应该没事。

我假设（来自 pSOS）您正在编写 Moto 68000，它是一个 32 位处理器；在那里使用 64 位数字会稍微慢一些，因为它需要更多指令（例如，添加、检查进位、分支或添加到高位字），但我怀疑您是否非常担心四个周期的成本。如果您使用的是 64 位处理器，那么 64 位操作与 32 位操作完全一样快。

这样做当然会增加你的内存存储开销，但如果你有很多包含这些计数器的结构，这只是一个问题。

# web-services - ColdFusion WSDL 在第一次调用时超时

> ID：470174
> 
> 赞同：3
> 
> 时间：2009-01-22T17:49:12.750
> 
> 标签：web-services, coldfusion, wsdl

我在网站的一小部分设置了 Web 服务，虽然网站整体获得了大量流量，但该特定服务却没有。每天一次，当我通过 Web 服务发送请求时，第一次尝试会失败，但第二次重试请求就可以了。就好像它不再缓存在内存中并在启动时超时。

有没有办法让这项服务在我端或网络服务提供商端保持活跃，这也是 CF 应用程序（我们公司的独立部门）？故障排除有点困难，因为它只会在很长一段时间后发生一次。而且我不想设置一个单独的进程来继续 ping 这个服务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-23T03:21:51.627

如果在调用模板之间定期重新启动服务器，请确保在管理员中启用“保存类文件”设置（在缓存下），以防止在每次服务器重新加载后重新编译模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T20:32:33.640

尝试增加 requesttimeout 看看是否有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T00:01:52.463

您可以尝试在 Web 服务客户端使用以下方法。CF7+ 内置了coldfusion.server.ServiceFactory Java 服务。

代码看起来像

```
<cftry>
    <!--- here goes attempt to invoke service method, maybe dummy "ping" --->
<cfcatch type="any">
    <!--- trying to refresh WSDL --->
    <cfset createObject("java","coldfusion.server.ServiceFactory").XmlRpcService.refreshWebService(ServiceURL) />
</cfcatch>
</cftry>
<!--- usual code ---> 
```

希望这可以帮助。

注意：这个工厂包含很多有用的方法，但互联网上的文档几乎为零。好主意是丢弃它并进行一些探索。

# vba - 从宏创建 Excel 加载项时遇到问题

> ID：470186
> 
> 赞同：1
> 
> 时间：2009-01-22T17:55:28.837
> 
> 标签：vba, excel, excel-addins

我创建了两个在当前工作簿中使用时运行良好的 VBA 宏函数。我保存为 .xla 并作为加载项导入。然后，我通过 excel 中的菜单找到并激活了加载项，但是当我使用这些函数时，我收到 #NAME 错误和“公式包含无法识别的文本”的描述。我被困住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T18:40:11.930

如果您打开 VBA 编辑器，您的插件会显示在列表中吗？我之前在使用 Excel VBA 插件时遇到过问题，即使插件列表显示插件已加载，它也不会显示在 VBA 编辑器中，除非我取消选中它并在列表中重新选中它。这很烦人，而且我还没有找到找到我选择的插件列表的方法，以便在必要时自动重新加载它们......

希望有帮助...

# java - Java 泛型和数组初始化

> ID：470198
> 
> 赞同：18
> 
> 时间：2009-01-22T17:58:17.193
> 
> 标签：java, arrays, generics

下面的解释是什么：

```
public class GenericsTest {
    //statement 1
    public ArrayList<Integer>[] lists;

    public GenericsTest()
    {
            //statement 2
        lists = new ArrayList<Integer>[4];
    }
} 
```

编译器接受语句 1。编译器将语句 2 标记为“创建通用数组”。

我见过的关于禁止泛型数组的一个很好的解释是[this one](http://www.ibm.com/developerworks/java/library/j-jtp01255.html)，认为由于数组是协变的，而泛型不是，如果允许泛型数组，则可以颠覆泛型类型。

撇开关于语言是否应该竭尽全力在泛型处理中制造这种复杂的不一致的争论，以防止你不管你多么努力地射击自己（如果有人知道关于相对的任何好的讨论问题的优点/缺点请张贴，我很想看看论点），如果（2）不是，为什么要允许声明（1）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T18:19:54.297

这是因为您无法创建，但您可以**使用**它们：

```
public class GenericsTest {
    //statement 1
    public ArrayList<Integer>[] lists;

    public GenericsTest()
    {
        //statement 2
        lists = new ArrayList[4];
        //statement 3
        lists[0].add(new Integer(0));
        //statement 4
        lists[0].add(new String(""));
    }
} 
```

语句 3 是可能的，语句 4 会导致编译器错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:24:39.717

似乎有一些模糊的情况，您可能会无意中导致 ClassCastException，如此处所述 [http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf](http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf)（第 7.3 节）

可以在此处找到有关此主题的有趣讨论 [http://courses.csail.mit.edu/6.170/old-www/2006-Spring/forum/index.php%3Ftopic=324.msg1131.html](http://courses.csail.mit.edu/6.170/old-www/2006-Spring/forum/index.php%3Ftopic=324.msg1131.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T01:04:05.633

所以实际的问题是：为什么声明泛型数组没有错误？?

当你做错事时，你总会得到一个错误。在技​​术上没有问题的地方添加错误只会增加混乱（尽管编辑可能想向您指出这一点）。

在某些情况下，您可能希望通过未经检查的演员来稍微改变规则。没有必要强制代码在不必要的情况下使用更多的警告抑制（除了指出愚蠢之外）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-22T20:59:55.610

在这种情况下，出于这个原因，我会避免使用数组。原始代码中“列表”的声明可能是

```
List<List<Integer>> lists = new ArrayList<List<Integer>>(4);
for(int i = 0; i < 4; i++) lists.add(null); // or add an empty ArrayList<Integer> 
```

（你应该在变量声明中使用接口而不是实现）

您将使用 get() 或 set() 代替数组 [] 语法。除此之外，它是等价的。

# c# - 使用线程计算 C# 事件中的循环

> ID：470201
> 
> 赞同：2
> 
> 时间：2009-01-22T17:58:34.107
> 
> 标签：c#, multithreading

编辑：它不是一个列表框。我的错。这是一个列表视图。

我有一个让我发疯的列表视图控件。它是一个多选列表框，因此如果用户选择了 5000 行，然后通过选择单行取消选择它们，则 SelectedIndexChanged 会触发 5001 次。这会导致我的应用程序挂起。

我正在尝试使用线程来计算事件触发的次数，然后让最后一次迭代完成所有实际工作。

这是我开始的代码。**最大的收获：**由于我无法控制的项目，我需要“做花哨的计算”与调用事件在同一个线程中。

编辑：我*知道*这段代码不起作用。Join() 阻塞了当前线程，这否定了创建线程的全部目的。我的问题是：我该怎么做这样的事情。

我最大的问题不是创建线程。这是我的“做幻想”必须在同一个线程中。

 `````
 void IncrPaintQueue()
    {
        PaintQueue++;
        Thread.Sleep(100);
    }

    int PaintQueue = 0;

    private void SegmentList_SelectedIndexChanged(object sender, EventArgs e)
    {
        // We need to know how many threads this may possibly spawn.
        int MyQueue = PaintQueue;

        // Start a thread to increment the counter.
        Thread Th = new Thread(IncrPaintQueue);
        Th.IsBackground = true;
        Th.Start();
        Th.Join();

        // if I'm not the last thread, then just exit. 
        // The last thread will do the right calculations.
        if (MyQueue != PaintQueue - 1)
            return;

        // Reset the PaintQueue counter.
        PaintQueue = 0;

        // ... do fancy calculations here...
    } 
````  `* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T18:15:16.223

[我记得以前](http://bytes.com/groups/net-c/723916-c-listview-selection-change)解决过这个问题：

> 也许对您来说更好的方法是在您的 ItemSelectionChange 处理程序中放置一个最小的延迟。说——50毫秒。使用计时器，一旦选择更改，重新启动计时器。如果选择在延迟期内多次更改，则忽略原来的选择，但在延迟期满后，执行逻辑。
> 
> 像这样：

```
public class SelectionEndListView : ListView
{
private System.Windows.Forms.Timer m_timer;
private const int SELECTION_DELAY = 50;

public SelectionEndListView()
{
   m_timer = new Timer();
   m_timer.Interval = SELECTION_DELAY;
   m_timer.Tick += new EventHandler(m_timer_Tick);
}

protected override void OnSelectedIndexChanged(EventArgs e)
{
   base.OnSelectedIndexChanged(e);

   // restart delay timer
   m_timer.Stop();
   m_timer.Start();
}

private void m_timer_Tick(object sender, EventArgs e)
{
   m_timer.Stop();

   // Perform selection end logic.
   Console.WriteLine("Selection Has Ended");
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:14:30.330

一个可能的解决方案是延迟工作，这样您就知道是否有更多的事件被触发。这假设选择的顺序并不重要；重要的是当前状态。

与其在事件触发后立即执行工作，不如设置一个计时器在事件触发后几毫秒执行此操作。如果计时器已经在运行，则什么也不做。以这种方式，用户应该不会感觉到任何差异，但动作不会挂起。

您也可以在另一个线程上完成工作，但有一个标志来指示工作正在完成。如果在选择事件触发时，工作仍在完成，则设置一个标志，指示应该重复工作。将 'repeat_work' 设置为 true 5000 次并不昂贵。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T18:19:18.947

我的印象是您正试图通过蛮力解决问题。我建议尝试不同的事件：

```
private void myListView_ItemSelectionChanged(object sender, ListViewItemSelectionChangedEventArgs e)
{
    if (e.IsSelected)
    {
        // do your logic here
     }
} 
```

我建议尽可能避免创建线程，因为它们有开销。从您的示例中我看不出需要并行性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T18:13:00.487

首先，当您正确同步对 PaintQueue 的访问时，我觉得在这种情况下更多的是偶然而不是设计。如果您有其他代码在其他线程上访问 PaintQueue，那么您就有问题了。

其次，这段代码没有意义。您正在后台处理一个新线程，增加该线程上的值，然后等待 1/10 秒。问题是，启动线程的代码正在等待该线程完成。因此，您只是在 UI 线程中等待。

即使您将 SelectedIndexChange 事件排队，您也无法阻止您的应用程序挂起。每次您选择一个项目时都会触发 SelectedIndexChange 事件，如果用户选择了 5000 个项目，那么您需要处理所有 5000 个事件。您可以给他们一个窗口（每 n 秒或其他任何时间处理一次），但这相当随意，并且您将用户置于计时器上，这很糟糕。

您应该做的不是将操作绑定到 SelectedIndexChanged 事件。相反，让用户选择项目，然后让他们执行一些其他操作（例如单击按钮），这些操作将对所选项目起作用。

如果您必须在 UI 线程上长时间处理多个项目，您的应用程序仍然会挂起，但至少选择项目不会挂起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T18:23:30.950

通过启动一个新线程然后立即加入它，您并没有真正实现任何类型的并发。上面代码的唯一“效果”是您的方法由另一个线程运行。

此外，如果您想使用后台线程并确保新线程相当昂贵的成本，您应该使用线程池。

# asp.net - ASP.net Bin 目录-dll 加载

> ID：470203
> 
> 赞同：5
> 
> 时间：2009-01-22T17:58:50.283
> 
> 标签：asp.net, dll

我需要在我的 asp.net 应用程序中使用 dll。如何加载不是从 bin 目录中的 dll？

也许我应该提到，该应用程序是 asp 代码和 asp.net 代码的混合体。所以，当我在我的机器上开发它时，我在 bin 目录中放置了一个 dll，但是在我将代码移动到实时环境之后，我不想为使用 asp.net 的每个部分都有一个单独的 bin 目录。

我要移动的只是 .aspx 和 .aspx.cs 文件。有没有办法加载一个 dll NOT FROM /bin（用“使用”语句指定它）？看起来它会自动在 /bin....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T18:01:27.080

您可以将 DLL 放在应用程序根目录的 bin 文件夹中，也可以[使用 gacutil 将其安装到全局程序集缓存 (GAC)](http://msdn.microsoft.com/en-us/library/ex0ss12c(VS.80).aspx)（这需要程序集具有强名称和签名）。

我只会把它放在垃圾箱里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T18:03:47.637

.net 应用程序在项目的 /bin 中查找，以及您放置系统共享 DLL-s 的 GAC（全局程序集缓存）。

如果您的应用程序是一个 .net 应用程序（在 IIS 中配置为一个应用程序），但子文件夹中有 aspx 文件，它们应该会看到根 /bin 文件夹。我会坚持将 dll 保存在 /bin 中，如果这不是 bin 的十分之几（这意味着您的应用程序组织存在问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T18:02:44.127

GAC 和 bin 是唯一常用的选项。

您也许还可以[将其他文件夹配置为额外的 bin 文件夹](http://www.hanselman.com/blog/PermaLink.aspx?guid=4d0ef4fb-f8ae-4355-a658-3c0432c98dbe)，但我不会屏住呼吸——这是从 1.1 开始的，您仍​​然需要与主应用程序位于同一个 vdir 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-02T13:35:48.187

只需将其他 dll 的目录添加到您的路径环境变量中。必须重新启动 asp.net 进程/Visual Studio 才能使更改生效。为我工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T18:06:07.553

就是这样：因为它的组织很差（它是 asp 和 asp.net 的混合体），它肯定没有正确配置....我认为现在最好有“10,000 个垃圾箱”。

多谢你们！

# c# - 在 C# 中从程序集及其依赖项创建实例

> ID：470208
> 
> 赞同：5
> 
> 时间：2009-01-22T18:00:01.293
> 
> 标签：c#, .net, assemblies, dependencies

我有一个应用程序（我们称之为 MyApp），它可以动态地为一个类创建源代码然后编译它。当它编译源代码时，我还引用了另一个文件夹中已经存在的另一个 DLL（即这个新创建的类的基类）。我执行以下操作来编译和输出 DLL：

```
//Create a C# code provider 
CodeDomProvider provider = CodeDomProvider.CreateProvider("CSharp");

//Set the complier parameters
CompilerParameters cp = new CompilerParameters();
cp.GenerateExecutable = false;
cp.GenerateInMemory = false;
cp.TreatWarningsAsErrors = false;
cp.WarningLevel = 3;
cp.OutputAssembly = "SomeOutputPathForDLL";

// Include referenced assemblies
cp.ReferencedAssemblies.Add("mscorlib.dll");
cp.ReferencedAssemblies.Add("System.dll");
cp.ReferencedAssemblies.Add("System.Core.dll");
cp.ReferencedAssemblies.Add("System.Data.dll");
cp.ReferencedAssemblies.Add("System.Data.DataSetExtensions.dll");
cp.ReferencedAssemblies.Add("System.Xml.dll");
cp.ReferencedAssemblies.Add("System.Xml.Linq.dll");
cp.ReferencedAssemblies.Add("MyApp.exe");
cp.ReferencedAssemblies.Add("SomeFolder\SomeAdditionalReferencedDLL.dll");

// Set the compiler options
cp.CompilerOptions = "/target:library /optimize";
CompilerResults cr = provider.CompileAssemblyFromFile(cp, "PathToSourceCodeFile"); 
```

稍后在我的应用程序中（或下次应用程序运行时），我尝试创建该类的一个实例。我知道新创建的类（我们称之为 Blah）和基类的 DLL 在哪里。我使用以下代码尝试创建新类的实例：

```
Assembly assembly = Assembly.LoadFile("PathToNewClassDLL");
Blah newBlah = assembly.CreateInstance("MyApp.BlahNamespace.Blah") as Blah; 
```

当我像上面那样调用 Assembly.CreateInstance 时，我收到一条错误消息，指出它无法创建实例。当我检查 assembly.GetReferencedAssemblies() 它有标准引用和我的应用程序的引用（MyApp.exe），但它没有我最初编译类时使用的依赖基类的引用（SomeAdditionalReferencedDLL.dll） .

我知道我必须以某种方式添加基类引用才能创建实例，但我不确定如何执行此操作。当我拥有程序集及其所有依赖项时，如何从程序集中创建类的实例？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T19:07:40.067

如果您手动加载外部 DLL（程序集），它不会自动加载您引用的内容。

因此，您必须创建一个 AssemblyLoader。检查程序集的引用程序集并自行加载它们的代码。

有关驻留在计算机上奇怪文件夹中而不是与已编译 DLL 一起的引用程序集的复杂情况，请查看 AppDomain.CurrentDomain.AssemblyResolve 事件。（您使用它来欺骗 .NET 以接受正在加载的程序集，即使它不在 GAC 中或与您编译的 DLL 中）

使用代码手动加载引用的 DLL 后，CreateInstance 将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-18T20:40:40.533

first of all i think you have circular dependency .. your last paragraph sums it up. You need to rethink your application and decide if you have responsibilities setup correctly.

Why circular dependency:

For the new dll to be generated it requires MyApp.exe;

MyApp.exe cannot be used without the new dll.

maybe post what your goal is and we can help structure your app correctly.

With proper responsibility delegated MyApp.exe should be making the new generated assembly do work not require MyApp.exe to use objects from the new dll.

Example you should only have Execute on the new generated assembly .....

```
 public static void RenderTemplate(String templatepath, System.IO.Stream outstream, XElement xml, Dictionary<String, object> otherdata)
    {
        var templateFile = System.IO.File.ReadAllText(templatepath);

        var interpreter = new Interpreter();
        interpreter.ReferencedAssemblies.Add("System.Core.dll"); // linq extentions
        interpreter.ReferencedAssemblies.Add("System.Xml.dll");
        interpreter.ReferencedAssemblies.Add("System.Xml.Linq.dll");

        interpreter.UsingReferences.Add("System.Linq");
        interpreter.UsingReferences.Add("System.Xml");
        interpreter.UsingReferences.Add("System.Xml.Linq");
        interpreter.UsingReferences.Add("System.Collections.Generic");
        interpreter.Execute(templateFile, outstream, xml, otherdata);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T18:06:47.817

您确定它在编译时引用了您认为它正在引用的 DLL 实例吗？它可能正在解析到您认为的其他地方的路径，这样在实例化您的类时，它再也找不到该 DLL。我建议获取编译过程和类型创建的 Fusion 日志，以查看如何解析类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T18:07:13.230

我认为.Net 正在尝试在您的 bin 或 GAC 中找到“SomeAdditionalReferencedDLL.dll”。在创建新的 Blah 之前，您是否尝试过为“SomeAdditionalReferencedDLL.dll”执行 Assembly.Load？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T18:08:56.503

这听起来像您在动态生成的程序集中引用的程序集不在标准探测路径之一中。

相对于其他一切，它位于何处？

您应该启动[融合日志查看器](http://msdn.microsoft.com/en-us/library/e74a18c4(VS.80).aspx)以查看哪里出了问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-01T08:33:34.350

```
//Constructor
static MyClass()
    {
        //Provoque l'événement quand .Net ne sait pas retrouver un Assembly référencé
        AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(CurrentDomain_AssemblyResolve);

    }
    /// <summary>
    /// Mémorise les assembly référencés par d'autres qui ne sont pas dans le répertoire principal d'EDV
    /// </summary>
    static Dictionary<string, string> _AssembliesPath;
    /// <summary>
    /// .Net ne sait pas retrouver un Assembly référencé
    /// Cherche et charge d'après les assembly référencés par d'autres qui ne sont pas dans le répertoire principal d'EDV        
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="args"></param>
    /// <returns></returns>
    static Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
    {
        if (_AssembliesPath != null && _AssembliesPath.ContainsKey(args.Name))
        {
            Assembly lAssembly = Assembly.LoadFile(_AssembliesPath[args.Name]);
            AddAssemblyReferencedAssemblies(lAssembly, System.IO.Path.GetDirectoryName(lAssembly.Location));
            return lAssembly;
        }
        Error = string.Format("L'assembly {0} n'a pu être chargé", args.Name);
        return null;
    }
    /// <summary>
    /// Mémorise les assembly référencés par d'autres qui ne sont pas dans le répertoire principal d'EDV        
    /// </summary>
    /// <param name="pAssembly"></param>
    /// <param name="psRootPath"></param>
    static void AddAssemblyReferencedAssemblies(Assembly pAssembly, string psRootPath)
    {
        if (_AssembliesPath == null) _AssembliesPath = new Dictionary<string, string>();
        foreach (AssemblyName lRefedAss in pAssembly.GetReferencedAssemblies())
            if (!_AssembliesPath.ContainsKey(lRefedAss.FullName))
            {
                string lsRoot = psRootPath + "\\" + lRefedAss.Name + ".";
                string lsExt;
                if (System.IO.File.Exists(lsRoot + (lsExt = "dll")) || System.IO.File.Exists(lsRoot + (lsExt = "exe")))
                {
                    _AssembliesPath.Add(lRefedAss.FullName, lsRoot + lsExt);
                }
            }
    } 
```

//函数调用Assembly lAssembly = Assembly.LoadFile(lsExternalAssemblyPath); AddAssemblyReferencedAssemblies(lAssembly, System.IO.Path.GetDirectoryName(lsExternalAssemblyPath));

# wpf - 在 WPF 应用程序中托管网页并与之交互

> ID：470222
> 
> 赞同：24
> 
> 时间：2009-01-22T18:04:52.127
> 
> 标签：wpf, web-applications

我需要为 LOB 应用程序创建一个基于 Web 的仪表板工具。本质上，用户需要能够登录到一个允许他们查看各种数据位的统计信息的网站，以及查看与他们相关的任何通知。我们的主要应用程序是使用 WPF 为桌面构建的。我们还需要提供一个相同的仪表板，它将托管在我们的 WPF 应用程序中。主要区别在于，在 WPF 版本中，它们将具有打开应用程序其他部分以更改数据或执行任何必要操作的按钮。

主要问题是管理层只想编写 1 个可以在 Web 和 WPF shell 中使用的版本。他们不想写入不同版本的 UI。因此，解决方案是为 Web 编写仪表板，但将其托管在我们的桌面应用程序中供本地用户使用，而将其托管在浏览器中供远程用户使用。

所以这是我的问题：

1.  如何在我的 WPF 应用程序中托管网页
2.  如何根据我是在我的 WPF 应用程序中还是在 IE 资源管理器之类的东西中隐藏/删除按钮？
3.  如果在浏览器中单击链接或按钮，WPF 应用程序如何对这些单击做出反应并打开应用程序内的相关屏幕？
4.  有什么更好的方法？

我意识到这个想法可能很糟糕，所以不要因此而抨击我。我只是想用正确的方法来提供管理。欢迎所有建议。

谢谢！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-22T19:12:27.873

您可以使用在 .NET 3.5 SP1 中添加的 WebBrowser 控件在 WPF 应用程序中托管网页：

```
<Grid>
    <WebBrowser Name="browser" />
</Grid> 
```

在代码隐藏中，您必须将 Uri 设置为您的页面和一个要从 java 脚本调用的对象（应该是 com-visible）：

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

        string uri = AppDomain.CurrentDomain.BaseDirectory + "TestPage.html";
        this.browser.Navigate(new Uri(uri, UriKind.Absolute));
        this.browser.ObjectForScripting = new ScriptingHelper();
    }

    [ComVisible(true)]
    public class ScriptingHelper
    {
        public void ShowMessage(string message)
        {
            MessageBox.Show(message);
        }
    }
} 
```

最后在您的页面中，您必须使用 window.external 调用代码，如下所示：

```
<head>
    <title></title>

    <script type="text/javascript">
        function OnClick()
        {
            var message = "Hello!";
            window.external.ShowMessage(message);
        }
    </script>
</head>
<body>
    <a href="#" onclick="OnClick()">Click me</a>
</body> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-22T19:28:50.617

o，并且您应该在 head 标签上方添加 [从 url=(0014)about:internet 注释](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f73bb9fa-3252-4c7e-b8e4-6cdad59fd825/) 以使 IE 不会阻止 javascript

# c# - 在 ASP.Net MVC 中，使用静态方法在视图上查找缓存对象是不好的做法吗？

> ID：470224
> 
> 赞同：3
> 
> 时间：2009-01-22T18:06:07.460
> 
> 标签：c#, asp.net-mvc, caching, static

我正在创建一个门户，许多站点将在其中运行相同的 MVC 应用程序。我有一个存储在 HttpRuntime.Cache 中的站点列表。通过静态方法访问缓存是错误的吗？我应该将其传递给视图数据吗？

例如，这在视图上是否错误：

SiteHelper 的代码在哪里：

```
public class SiteHelper {
private static object @lock = new object();
private const string siteKey = "FelixSites";

public static Site CurrentSite {
    get {
        var context = HttpContext.Current.Wrap();
        var sites = context.Cache[siteKey] as Site[];
        if (sites == null) {
            lock (@lock) {
                if (sites == null) {
                    sites = SiteService.GetSites();
                    context.Cache[siteKey] = sites;
                }
            }
        }
        return sites.Single(s => s.Domain == context.Request.UrlReferrer.AbsoluteUri);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T18:10:52.613

使用静态属性可能不好的唯一原因是破坏了视图和模型之间的关注点分离。模型应该是唯一关心如何检索数据的模型——即使是来自同一应用程序域中的对象。

虽然通过它向视图呈现这些数据似乎有点矫枉过正，`ViewData`但它确实是最佳实践，因为它保留了关注点的分离。您越积极地保留这种分离，您的应用程序就越能更好地处理重构和错误修复。

# javascript - 在 actionscript 3.0 中使用函数创建对象

> ID：470230
> 
> 赞同：4
> 
> 时间：2009-01-22T18:07:05.477
> 
> 标签：javascript, actionscript-3, object

由于 actionscript 3.0 基于 ECMAscript，它与 javascript 有一些相似之处。我一直在玩的一个相似之处是从函数创建对象。

在javascript中创建一个对象，

```
var student = new Student( 33 );
document.write( student.age );

function Student( age ){
   this.age = age;
} 
```

在 actionscript 3.0 中，对象通常是通过类创建的，但也可以像在 javascript 中一样，通过构造函数创建对象。

```
package{
   import flash.display.Sprite;

   public class Main extends Sprite{
      public function Main(){
         var student = new Student( 33 );
         trace( student.age );
      }
   }
}

function Student( age ) {
   this.age = age;
} 
```

但是，上面的代码出现编译错误

```
加载配置文件 C:\Program Files\Adobe\Flex Builder 3\sdks\3.1.0\frameworks\flex-config.xml
C:\Documents and Settings\mallen\Desktop\as3\Main.as(5): col: 23 错误：参数数量不正确。预期 0

                        var 学生 = 新学生（33）；
                                            ^

```

我想知道这是为什么？为了让事情变得更奇怪，下面的代码确实有效

```
package{
    import flash.display.Sprite;

    public class Main extends Sprite{

        public function Main(){
            Student( 33 );

            var student = new Student();
            trace(student.age);

          /* When I add the two lines below, the code wont compile? */
            //var student2 = new Student( 33 );
            //trace(student2.age);
        }
    }
}

function Student( age ){
    this.age = age;
    trace(age);
} 
```

此代码的输出是

```
33
不明确的
不明确的

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T19:42:18.263

从句法上讲，这是两者分歧的一个领域（在众多领域中）。;)

您可以使用函数创建对象：

```
private var studentName:String = "Joe";

private function init():void
{
    var s = new Student("Chris");

    trace(s.studentName);
    trace(this.studentName);    
    trace(typeof s);
    trace(typeof Student);

    s.sayHi();
    trace("Hello, " + s.studentName + ". I'm " + studentName + ".");
}

var Student:Function = function(studentName:String):void
{
    this.studentName = studentName;

    this.sayHi = function():void
    {
        trace("Hi!  I'm " + this.studentName + ".");    
    };
};

// Chris
// Joe
// object
// function
// Hi!  I'm Chris.
// Hello, Chris. I'm Joe. 
```

...只是语法略有不同。Function 类也是动态的，这意味着您可以在运行时将方法移植到它的实例上（就像我在上面使用 sayHi() 所做的那样），就像您可能使用 JavaScript 的“原型”属性一样。

实际上，我不确定使用这种方法可能会遇到什么样的烦恼、命名冲突、奇怪等等，因为我还没有深入研究它的文档——但它确实有效！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:58:58.007

您需要在文件中的自己的类中声明 Student。这样，学生就可以在 Main 中的任何地方访问。

```
package{
   import flash.display.Sprite;

   public class Main extends Sprite{
      public function Main(){
         var student = new Student( 33 );
         trace( student.age );
      }
   }
}

class Student
{
   public var age : uint
   public function Student( age : uint ) 
   {
      this.age = age;
   }
} 
```

# bash - Bash脚本：获取文件的子列表

> ID：470232
> 
> 赞同：1
> 
> 时间：2009-01-22T18:07:32.323
> 
> 标签：bash, shell

我将特定版本的 SQL 脚本存储在以发布版本命名的“脚本”子目录中，例如

```
...
./scripts/1.8.3/script-1.8.3.sql
./scripts/1.8.4/script-1.8.4.sql
./scripts/1.8.4.1/script-1.8.4.1.sql
./scripts/1.8.4.2/script-1.8.4.2.sql
./scripts/1.8.4.3/script-1.8.4.3.sql
./scripts/1.9.0/script-1.9.0.sql
./scripts/1.9.1/script-1.9.1.sql
./scripts/1.9.2/script-1.9.2.sql
./scripts/1.9.3/script-1.9.3.sql
./scripts/1.9.4/script-1.9.4.sql
./scripts/1.9.5/script-1.9.5.sql
./scripts/1.9.6/script-1.9.6.sql
./scripts/1.9.6.1/script-1.9.6.1.sql
... 
```

在 bash 脚本中，我需要获取适用于某个版本号之外的所有 SQL 文件。例如，如果此版本号是 1.9.4，我想获取列表

```
./scripts/1.9.4/script-1.9.4.sql
./scripts/1.9.5/script-1.9.5.sql
./scripts/1.9.6/script-1.9.6.sql
./scripts/1.9.6.1/script-1.9.6.1.sql
... 
```

我知道我可以通过以下方式获取按发布排序的完整文件列表

```
all_files = `find . -name '*.sql' | sort` 
```

但我不确定如何过滤此列表以获取特定版本“上或之后”的所有文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T18:14:57.003

```
echo 1.2.3 | awk -F'.' '{ ver=1000000*$1 + 1000*$2 + $3; if (ver > 1002001) print $_ }' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T18:23:37.127

蛮力（使用正则表达式匹配模式）：

```
find . -name "*.sql" | egrep -v "1\.[0-8]|1\.9\.[0-3]" 
```

更好的方式`sed`：

```
% find . -name "*.sql" | sort -r | sed '/1\.9\.4/ {q}'
...
./scripts/1.9.6/script-1.9.6.sql
./scripts/1.9.6.1/script-1.9.6.1.sql
./scripts/1.9.5/script-1.9.5.sql
./scripts/1.9.4/script-1.9.4.sql 
```

说明：反向排序，然后用于`sed`在版本（1.9.4）匹配时停止处理输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T19:17:41.013

如果文件是按时间顺序创建的，一个转折是

```
find . -name \*.sql -newer ./scripts/$VERSION/script-$VERSION.sql -print 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-24T23:29:04.727

这是基于 Quassnoi 的通用版本。

认为

```
 $ ls -1 releases/
  program-0.0.1.app
  program-0.0.10.app
  program-0.0.9.app
  program-0.3.1.app
  program-3.3.1.app
  program-3.30.1.app
  program-3.9.1.app 
```

（注意 0.0.10 在 0.0.9 之前，这是错误的）。但是，如果我们执行一些“版本数学”，我们会得到正确的顺序：

```
 $ ls -1 releases/ | sed 's/\(program-\)\(.*\)\(\.app\)/\2 \1\2\3/g' | awk -F '.' '{ ver=1000000*$1 + 1000*$2 + $3; printf "%010d %s\n", ver, $0}' | sort | awk '{print $3}'
 program-0.0.1.app
 program-0.0.9.app
 program-0.0.10.app
 program-0.3.1.app
 program-3.3.1.app
 program-3.9.1.app
 program-3.30.1.app 
```

# php - Web 应用程序架构：面向未来

> ID：470238
> 
> 赞同：3
> 
> 时间：2009-01-22T18:09:24.817
> 
> 标签：php, database, web-applications, cron

我有一个当前发送电子邮件的 Web 应用程序。在我的 Web 应用程序发送电子邮件时（发送电子邮件是基于用户操作 - 不是自动的），它必须运行其他进程，例如压缩文件。

我正在尝试使我的应用程序“面向未来” - 所以当有大量用户时，我不希望服务器紧张，所以我认为放置需要发送的电子邮件和需要压缩的文件在队列中。将它们放在表中，然后使用 cron 作业每秒检查一次并执行它们（一次 x 行）。

以上是个好主意吗？还是有更好的方法？我真的需要帮助才能正确完成这项工作，以免以后让自己头疼:)

谢谢大家

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T18:20:09.303

这是一个很好的方法，但是您现在可以做的最重要的事情是有一个用于排队消息的清晰界面，以及一个用于消费队列的界面。不要将两端的用法硬编码到数据库中。

稍后，如果这成为瓶颈，您可能希望从甚至可能无法访问数据库的不同机器上完成邮件发送，因此前期的这笔小额投资将为您提供以后的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T18:28:11.923

您可能忽略的一个方面是您使用的压缩速度，在压缩过程中使用较轻的压缩级别可能符合您的最大利益，因为这可以大大改善压缩时间（很容易加倍），这可以加起来当您进入多个用户的领域时会很多。

如果您在压缩已压缩的大型文件（MP3、ZIP、DOCX、XLSX、JPG、GIF 等）时使压缩变得智能并且不使用压缩，而当您有简单的文本文件（TXT、XML 、DOC、XLS 等），因为即使是重度压缩，它们也会很快压缩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T18:48:10.247

重要的一点可能是，与其让 cron 作业每秒运行一次，不如让一个始终运行的守护进程在退出时自动重新启动 - 或类似的东西。

一个原因是，正如您自己描述的那样，如果很多用户要求发送电子邮件并且队列建立起来，那么一个 cronjob 将没有时间在 ext one 统计之前完成，并且您有可能让您的系统被淹没与流程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T19:16:39.580

以上是个好主意吗？是的

是否有更好的解决方案来处理未来数百万用户？可能..但这不是重要的。重要的是您已经构建了抽象层。如果有一天你有疯狂的交通并且你的 cron 队列没有跟上你可以替换该层的功能而不更改任何使用它的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-27T02:26:25.287

唔。我真的不喜欢 cron 每秒运行一些东西的想法。这似乎太频繁了。如果您的应用程序确实需要响应，那么我认为您应该保持同步。也就是说，将处理保留在您的 Web 应用程序中，并寻找其他方法来降低服务器压力。

如果您可以在检查之间等待更长的时间，那么最好让您的 cron 作业一次检查队列中的 1 个项目。如果有，则处理它，然后在不退出的情况下再次检查下一个。如果没有，请退出，五分钟左右不要再试一次。

然而，话虽如此，任何体面的邮件传输代理（sendmail、postfix、Exchange）都将内置队列。它可能会比您确保在意外发生时进行交付做得更好。在处理排队的电子邮件时需要考虑很多事情。我通常更愿意在此过程中尽早将出站电子邮件移交给 MTA。

--
bmb

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-27T02:31:00.127

构建一些可以进行分布式排队的东西。当您扩展卷时，您可以扩展可能出现瓶颈的层的不同层。

有理由每秒运行 cron 吗？音量有那么大吗？我想说尽你最大的努力让它保持一个 n 层的实现，因为你会在它们争夺你的注意力时交换东西和重构比特。

在几周内尽量不要构建任何你设计的东西。通常，在事情被锁定之前，您会遇到其他情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-27T02:38:48.600

好办法。一些改进：

1.  不要使用 cron 作业，而是在计时器上查询。
2.  包括一个状态标志以保持多个读取器/写入器排序。
3.  读者应该排空队列 - 在队列读取为空之前不要阻塞。
4.  把事情简单化。将复杂性和微妙性放入作者/读者的对话中。

根据我的经验，这将很好地扩展。

# c# - 在 StringBuilder 中使用布尔表达式

> ID：470242
> 
> 赞同：1
> 
> 时间：2009-01-22T18:09:38.093
> 
> 标签：c#, string, syntax, boolean

我正在使用字符串生成器来构建一些 SQL 脚本。我有一些布尔属性，我想测试它们，然后根据真/假输出不同的文本。在为变量赋值时，我有下面的 C# 语法，但它不适用于这种特殊情况。有任何想法吗？

我习惯做的事情：

```
string someText = (dbInfo.IsIdentity) ? "First Option" : "Second Option"; 
```

试图在 StringBuilder 方法中复制相同的东西，但这不起作用..

```
script.Append("sometext" + (dbInfo.IsIdentity) ? " IDENTITY(1,1)" : ""); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T18:11:30.897

添加括号：

```
script.Append("sometext" + ((dbInfo.IsIdentity) ? " IDENTITY(1,1)" : "")); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T18:13:15.340

那这个呢？

```
script.Append( "sometext" );
script.Append( dbInfo.IsIdentity ? " IDENTITY(1,1)" : "" ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T18:14:11.000

除了说明如果您有一个字符串生成器，您应该使用它来连接字符串。

也就是说，下面的代码应该可以工作。

```
script.Append("sometext");
script.Append(dbInfo.IsIdentity ? " IDENTITY(1,1)" : ""); 
```

在这种特殊情况下，您还可以这样做：

```
script.Append("sometext");
if(dbInfo.IsIdentity) script.Append(" IDENTITY(1,1)"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-22T18:15:11.153

额外的括号甚至更好地使用 AppendFormat

```
script.AppendFormat("sometext{0}", dbInfo.IsIdentity ? " IDENTITY(1,1)" : ""); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T18:11:56.387

只是预感，但我认为您需要更多括号：

```
script.Append("sometext" + ((dbInfo.IsIdentity) ? " IDENTITY(1,1)" : "")); 
```

为了便于阅读，我会敦促您使用临时变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T18:12:21.627

首先，我会尝试将 if/then/else 包含在一组括号中，看看是否能解决问题。评估该表达式的顺序可能有问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T18:16:53.087

一个快速的建议：如果你正在生成这样的 SQL，你可能有更好的时间使用像[StringTemplate](http://www.stringtemplate.org/)这样的模板来生成它，而不是使用直接的 C#。

# c# - 如何在 Excel 2002 中将一组工作表打印为 PDF？

> ID：470244
> 
> 赞同：2
> 
> 时间：2009-01-22T18:10:36.030
> 
> 标签：c#, excel, pdf, pdf-generation

我试过 CutePDF，但程序访问需要通过注册表项进行，这不是线程安全的。我也尝试过 PDF Writer，但是当多个用户登录到同一台机器尝试同时打印时，程序会出现严重问题。

我正在寻找一个简单的 C# 或 VBA 命令，我可以对它说——打印这个 .xls，它不需要我费力地完成它。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T18:54:37.517

我想你会在那里进行艰苦的搜索。大多数“源到 PDF”转换器都基于打印流，您可以在其中打印任何您想要的内容到标准打印流中，该标准打印流被包装/转换为 PDF。而且 printstream(spooler) 是非常异步的（不是线程安全的）并且容易在同一台机器上出现多个用户的问题。

那里有很少的编程解决方案，我认为它们都需要花钱，但我可能错了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T20:09:21.080

当然，您可以使用 Open Office——导出为 pdf 在 writer 中效果很好。也许 Calc 有类似的支持？

另请参阅标记为 openoffice.org 的其他答案

例如[openoffice-command-line-pdf-creation](https://stackoverflow.com/questions/355447/openoffice-command-line-pdf-creation)

# c# - process.WaitForExit() 异步

> ID：470256
> 
> 赞同：68
> 
> 时间：2009-01-22T18:13:58.397
> 
> 标签：c#, .net, winforms, user-interface, asynchronous

我想等待一个进程完成，但`process.WaitForExit()`挂起我的 GUI。是否有基于事件的方式，或者我是否需要生成一个线程以阻塞直到退出，然后自己委托事件？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2013-09-30T21:40:35.943

从 .NET 4.0/C# 5 开始，使用异步模式更好地表示这一点。

```
/// <summary>
/// Waits asynchronously for the process to exit.
/// </summary>
/// <param name="process">The process to wait for cancellation.</param>
/// <param name="cancellationToken">A cancellation token. If invoked, the task will return 
/// immediately as canceled.</param>
/// <returns>A Task representing waiting for the process to end.</returns>
public static Task WaitForExitAsync(this Process process, 
    CancellationToken cancellationToken = default(CancellationToken))
{
    if (process.HasExited) return Task.CompletedTask;

    var tcs = new TaskCompletionSource<object>();
    process.EnableRaisingEvents = true;
    process.Exited += (sender, args) => tcs.TrySetResult(null);
    if(cancellationToken != default(CancellationToken))
        cancellationToken.Register(() => tcs.SetCanceled());

    return process.HasExited ? Task.CompletedTask : tcs.Task;
} 
```

用法：

```
public async void Test() 
{
   var process = new Process("processName");
   process.Start();
   await process.WaitForExitAsync();

   //Do some fun stuff here...
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-22T18:23:21.497

[process.EnableRaisingEvents](https://msdn.microsoft.com/en-us/library/system.diagnostics.process.enableraisingevents.aspx) = true;
[process.Exited](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx) += [EventHandler]

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2018-05-22T07:01:54.757

这是一个稍微干净的扩展方法，因为它清除了取消令牌注册和退出事件。它还处理竞争条件边缘情况，在这种情况下，进程可以在它开始之后但在附加 Exited 事件之前结束。它使用 C# 7 中新的局部函数语法。

```
public static class ProcessExtensions
{
    public static async Task WaitForExitAsync(this Process process, CancellationToken cancellationToken = default)
    {
        var tcs = new TaskCompletionSource<bool>(TaskCreationOptions.RunContinuationsAsynchronously);

        void Process_Exited(object sender, EventArgs e)
        {
             tcs.TrySetResult(true);
        }

        process.EnableRaisingEvents = true;
        process.Exited += Process_Exited;

        try
        {
            if (process.HasExited)
            {
                return;
            }

            using (cancellationToken.Register(() => tcs.TrySetCanceled()))
            {
                await tcs.Task.ConfigureAwait(false);
            }
        }
        finally
        {
            process.Exited -= Process_Exited;
        }
    }
} 
```

**编辑：**

我已经添加`TaskCreationOptions.RunContinuationsAsynchronously`到构造函数中，它应该修复尝试同步运行延续`TaskCompletionSource`时可能发生的死锁。`TrySetResult()`

这种死锁条件实际上很难追查。事实证明，`TaskCompletionSource.SetResult()`默认情况下同步运行延续，这将导致等待下的所有代码在`SetResult()`. 这通常不会成为问题，因为`Process.Exited`它是在线程池线程上运行的。但是，整个`Process.Exited`回调*在一个 lock on`this`*内运行，在新的线程池线程内，`this`实例`Process`在哪里。这可以在[这里](https://github.com/dotnet/corefx/blob/e99ec129cfd594d53f4390bf97d1d736cff6f860/src/System.Diagnostics.Process/src/System/Diagnostics/Process.cs#L1093-L1106)看到。

`process.Exited -= Process_Exited;`也锁定*this* ，这是由于 C# 语言规范实现事件处理程序的方式。最终结果是两个单独的线程池线程最终阻塞了`Process`实例上的锁。疯狂的！更疯狂的是，如果你没有同步上下文，紧接在它下面的代码也可能同步运行，所以你最终会在回调内部`await WaitForExitAsync()`运行大量代码。如果你不知道这种行为是非常危险的！`lock``Process.Exited``TaskCompletionSource`

解决方案是添加`TaskCreationOptions.RunContinuationsAsynchronously`到`TaskCompletionSource`构造函数中。这允许`TaskCompletionSource.SetResult()`立即返回，并且一切都将“按预期”工作。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-10-07T14:20:47.640

如果您选择@MgSam 答案，请注意，如果您通过`WaitForExitAsync`一些`CancellationToken`，那将在指定延迟后自动取消，您可以获得一个`InvalidOperationException`. 要解决这个问题，你需要改变

```
cancellationToken.Register(tcs.SetCanceled); 
```

到

```
cancellationToken.Register( () => { tcs.TrySetCanceled(); } ); 
```

PS：别忘了及时处理`CancellationTokenSource`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-22T18:21:27.477

[根据此链接](http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx)，WaitForExit() 方法用于使当前线程等待，直到相关进程终止。但是，Process 确实有一个您可以挂钩的 Exited 事件。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-05-08T10:36:25.750

Ryan 解决方案在 Windows 上运行良好。在 OSX 上发生了奇怪的事情，它可能是死锁`tcs.TrySetResult()`！有2个解决方案：

**第一：**

包装`tcs.TrySetResult()`到 Task.Run()：

```
 public static async Task WaitForExitAsync(this Process process, CancellationToken cancellationToken = default)
    {
        var tcs = new TaskCompletionSource<bool>();

        void Process_Exited(object sender, EventArgs e)
        {
            Task.Run(() => tcs.TrySetResult(true));
        }

        process.EnableRaisingEvents = true;
        process.Exited += Process_Exited;

        try
        {
            if (process.HasExited)
            {
                return;
            }

            using (cancellationToken.Register(() => Task.Run(() => tcs.TrySetCanceled())))
            {
                await tcs.Task;
            }
        }
        finally
        {
            process.Exited -= Process_Exited;
        }
    } 
```

关于这个和更多细节的对话： [以非阻塞方式调用 TaskCompletionSource.SetResult](https://stackoverflow.com/questions/19481964/calling-taskcompletionsource-setresult-in-a-non-blocking-manner)

**第二个：**

```
 public static async Task WaitForExitAsync(this Process process, CancellationToken cancellationToken)
    {
        while (!process.HasExited)
        {
            await Task.Delay(100, cancellationToken);
        }
    } 
```

您可以将轮询间隔从 100 毫秒增加到更多，具体取决于您的应用程序。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-04-23T13:08:23.610

截至`.NET5`目前， [Process](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process?view=net-5.0)提供了[WaitForExitAsync](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.process.waitforexitasync?view=net-5.0)。 `class`

```
await process.WaitForExitAsync( token ); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-07-20T14:27:52.057

快速简单的解决方案：

```
async Task RunProcessWait(string Path)
{
    Process MyProcess = Process.Start(Path);
    while (!MyProcess.HasExited)
        await Task.Delay(100);
}

await RunProcessWait("C:\...") 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-22T18:19:02.940

采用`System.Diagnostics.Process.Exited`

# eclipse - 在 OSX 下卸载 Eclipse？

> ID：470261
> 
> 赞同：49
> 
> 时间：2009-01-22T18:14:19.533
> 
> 标签：eclipse, macos, uninstallation

我在 Mac OS X 10.5.6 上运行 Eclipse SDK 3.4.0。

每次我尝试通过“软件更新”安装新内容时，都会显示“您选择的软件项目可能对当前安装无效”的消息。

所以我要卸载它并重新安装 Eclipse。

我应该删除 Eclipse 文件夹还是有办法卸载它？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-01-04T10:50:33.063

实际上 Eclipse 确实创建了一些不在它的目录中的其他文件，这些文件在删除它的目录后仍然存在。

在 Snow Leopard 中，查看您的用户帐户：

*   `~/Library/Caches/org.eclipse.eclipse`
*   `~/Library/Preferences/org.eclipse.eclipse.plist`

不确定您是否需要打开隐藏文件的查看才能看到这些文件。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-01-28T06:45:31.120

在 Lion 下，我删除了以下文件和文件夹：

*   **日食**（`/Applications`显然）

*   **.eclipse** in`~`

*   **.eclipse_keyring**中`~`

*   **org.eclipse.eclipse**在`~/Library/Caches`

*   **org.eclipse.eclipse.savedState**在 ~/Library/Saved Application State/

其中一些是隐藏的，因此您应该通过终端删除它们。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-08-10T17:19:53.990

这是我要为 OSX Mountain Lion 删除的内容列表

~/.eclipse（文件夹）；

~/Library/Saved Application/org.eclipse.eclipse.savedState；

~/Library/Preferences/org.eclipse.eclipse.plist；

~/Library/Caches/org.eclipse.eclipse；

...当然还有 eclipse 安装文件夹

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-22T18:28:09.240

不需要卸载任何东西，你可以删除 eclipse/ 文件夹，但你也应该使用一个新的工作空间或删除 workspace/.metadata 文件夹。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-03-11T13:51:18.863

在我使用 High Sierra 的情况下，除了 eclipse 文件夹之外，我还删除了：

*   ~/.eclipse
*   ~/.p2/pool/plugins/org.eclipse.*
*   ~/.p2/pool/.eclipseextension/
*   ~/.p2/org.eclipse.equinox.p2.repository/
*   ~/.p2/org.eclipse.equinox.p2.engine/
*   ~/.p2/org.eclipse.equinox.p2.core/

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-22T18:28:32.953

删除eclipse文件夹就相当于卸载了。事实上，如果您不想篡改现有安装，您可以创建另一个 eclipse 实例并从新位置运行。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-11-08T02:46:36.983

1.  从终端，找到所有 Eclipse 目录

    `sudo find / -iname "Eclipse"`

2.  `rm`使用命令删除这些目录。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-26T20:03:58.367

Eclipse 对 Mac OS 超出它的目录没有影响，所以卸载没有问题。

我认为您所面临的是 Eclipse 最近切换插件分发系统的结果。现在有两种冗余且不太兼容的插件安装方式。这是一团糟。您最好（如果可能的话）安装更新版本的 Eclipse（甚至可能是 3.5 里程碑），因为它们在这方面似乎更稳定。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-26T19:50:39.267

顺便提一句。AppZapper 是一款出色的 OSX 工具，用于卸载应用程序及其偏好。

它有时是 MacHeist 的一部分

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-05-22T09:23:39.533

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-10-19T13:12:27.747

对于 BigSur，我确实考虑了以上所有内容。

1.  从应用程序文件夹中删除
2.  `rm -rf ~/.eclipse/`
3.  `rm -rf ~/.p2/pool/`
4.  `rm -rf ~/.p2/org.eclipse.equinox.p2.repository/`
5.  `rm -rf ~/.p2/org.eclipse.equinox.p2.engine/`
6.  `rm -rf ~/.p2/org.eclipse.equinox.p2.core/`
7.  `rm -rf ~/Library/Caches/org.eclipse.platform.ide/`
8.  `rm ~/Library/Preferences/org.eclipse.oomph.setup.installer.product.with-jre.restricted.plist`
9.  `rm ~/Library/Preferences/org.eclipse.platform.ide.plist`
10.  `rm -rf ~/Library/Saved\ Application\ State/org.eclipse.oomph.setup.installer.product.with-jre.restricted.savedState/`
11.  `rm -rf ~/Library/Saved\ Application\ State/org.eclipse.platform.ide.savedState/`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-24T23:10:59.630

只需删除**eclipse**文件夹，无论它在哪里

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-03-04T22:47:21.980

我刚刚遇到了类似的问题，GWT-PlugIn 没有出现在界面中。删除eclipse文件夹没有解决，GWT还在！删除工作区无效！但是删除主目录中的 .eclipse 文件夹确实如此！我在这里工作在 WINdows 7 下，但它应该与 OSX 相同。但是您可能必须先使该文件夹可见。在基于 linux 的系统下，默认情况下，以点开头的文件夹是不可见的。

这个文件夹可能是我首先遇到问题的原因。如果我没记错的话，我从基本的 Eclipse 切换到了 EE，但没有删除这个文件夹。

在我看来，卸载脚本对 Eclipse 来说会非常好。

# c# - 你会如何处理这个设计？

> ID：470272
> 
> 赞同：0
> 
> 时间：2009-01-22T18:18:40.040
> 
> 标签：c#, interface

我有`ControlA`哪个接受一个`IInterfaceB`具有类型属性的 `List<unknownType>`

如果`ControlA`我需要在...`unknownType`中的列表中添加一个新实例`IInterfaceB`

`unknownType`需要特定的属性所以我立即认为它可能是一个接口，但快速实现的接口无法实例化......

你会如何设计这个系统？

**编辑**当前的继承链如下所示：

```
topLevelClass -> baseObject -> IBaseObject (which is implemented in topLevelClass) 
```

因此，如果我向链中添加了一个新类，它将需要进行继承和实现，这是不可能的（afaik）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T18:25:08.187

如果我正确地解释了这一点，您可以在 unknownType 上添加一个约束，使其成为包含您需要的属性的某个接口：

```
class ControlA
{
    void Frob<T>(IInterfaceB<T> something) where T : IHasSomeProperties, new()
    {
        something.ListOfT.Add(new T() { SomeProperty = 5 });
        something.ListOfT.Add(new T() { SomeProperty = 14 });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T18:22:30.047

对类型的限制会起作用吗？

```
List<T> where T : IInterface 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T18:24:48.310

您的规范不够具体，无法很好地回答，但请尝试对 T 施加约束。

```
public interface IInterfaceB<T>
    where T : new()
{
    List<T> Whatever { get; }
} 
```

这使您可以这样做：

```
T iDoNotCare = new T(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T18:36:59.957

为什么 List 必须是未知类型？为什么它不能是一个真正的类，它具有你需要的真实属性以及你需要的构造函数来实例化？如果您需要扩展该类，则可以从它继承。根据您提供的信息，如果您只需要进入此列表的类中的一些属性，那么一个好的旧类应该可以解决问题。

# asp.net - 如何添加通用代码（特别是标记为 WebMethod() 的方法）

> ID：470275
> 
> 赞同：0
> 
> 时间：2009-01-22T18:19:39.990
> 
> 标签：asp.net, vb.net, web-services

我有一些 ASP.NET 页面和 webservice WebMethod() 方法，我想添加一些通用代码。例如：

```
<WebMethod()> _
Public Function AddressLookup(ByVal zipCode As String) As Address
    #If DEBUG Then
        ' Simulate a delay
        System.Threading.Thread.Sleep(2000)
    #End If
    Return New Address()
End Function 
```

我目前在我的所有 WebMethod() 方法中都有 #If Debug 代码，但我认为必须有更好的方法来执行此操作，而无需实际输入代码。

有没有办法确定请求是否是对 Application_EndRequest 中的 WebMethod 的，以便我可以在整个项目范围内添加这个延迟？

请注意，有些方法是 Page 方法，有些是 Web 服务方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T18:23:20.497

您可以查看 Application_EndRequest 中的请求 URL 以确定它是否是 Web 方法调用。例如这样的事情（对不起，它在 C# 中）：

```
protected void Application_EndRequest(Object sender, EventArgs e)
{
  if (Request.Url.ToString().IndexOf("MyWebService.asmx") > 0)
  {
    // Simulate a delay
    System.Threading.Thread.Sleep(2000);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:24:44.847

将代码封装`#if DEBUG`在一个方法中，并用`<Conditional("DEBUG")>`. 这样，您只需在 each 中编写一个方法调用`<WebMethod>`。可能有用。

# cocoa - “MouseDragged”，但 NSOpenGlView 直到“MouseUp”才刷新

> ID：470285
> 
> 赞同：3
> 
> 时间：2009-01-22T18:22:35.493
> 
> 标签：cocoa, opengl

我对 MainView 继承自 NSOpenGlView 的 App 有一个奇怪的问题。我可以在其中绘制很多东西，比如基本的 OpenGL 教程....但是当我尝试实现基本轨迹球时，看起来应用程序会等到我释放鼠标按钮后才会刷新我的视图...甚至如果我直接从“MouseDragged”回调中调用“DrawRect”回调，它的作用是一样的。然后，我真的不知道如何做这样一个基本的事情，我的解决方案有什么问题..

任何想法？

我的 NSOpenGLVIew 有双缓冲和额外的深度缓冲。以下是主要信息。

///////////////////////////////////////// ///////////////////////////////////////// ///////////////////

```
- (void)mouseDragged:(NSEvent *)theEvent {

//[[self openGLContext] makeCurrentContext];

float curPos[3], dx, dy, dz;

dx = curPos[0] - lastPos[0];
dy = curPos[1] - lastPos[1];
dz = curPos[2] - lastPos[2];

angle = 90.0 * sqrt(dx*dx + dy*dy + dz*dz);
axis[0] = lastPos[1]*curPos[2] - lastPos[2]*curPos[1];
axis[1] = lastPos[2]*curPos[0] - lastPos[0]*curPos[2];
axis[2] = lastPos[0]*curPos[1] - lastPos[1]*curPos[0];

//glutPostRedisplay();

//[self drawRect:self.bounds]; // different attempts
[self setNeedsDisplay:YES]; //
//[self display]; 

}

#pragma mark Mouse Handling

- (void)mouseDown:(NSEvent *)theEvent {

m_PreviousMouseLoc = [self convertPoint:[theEvent locationInWindow] fromView:nil];
ptov(m_PreviousMouseLoc.x,m_PreviousMouseLoc.y,m_width,m_height,lastPos);

}

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

- (void)mouseUp:(NSEvent *)theEvent {

[self setNeedsDisplay:YES];

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void ptov(int x, int y, int width, int height, float v[3]){

float a,d;

// project x,y onto  1/2 sphere  centered within width and height
v[0] = (2.0*x - width)/ width;
v[1] = (height - 2.0*y)/ height;
d = sqrt(v[0]*v[0] + v[1]*v[1]);
v[2] = cos((PI/2)*((d < 1.0) ? d : 1.0));
a = 1.0 / sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2]);
v[0] *=a;
v[1] *=a;
v[2] *=a;

}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

 -(void)prepareOpenGL{

if( ![ self loadGLTextures ] ){
    NSLog(@"Failed to load GL Textures");
}

 GLint swapInt = 1;

 [[self openGLContext] setValues:&swapInt forParameter:NSOpenGLCPSwapInterval];     // set to vbl sync 

//glEnable( GL_TEXTURE_2D );                // Enable texture mapping
glShadeModel( GL_SMOOTH );                // Enable smooth shading
glClearColor( 0.0f, 0.0f, 0.0f, 0.5f );   // Black background
glClearDepth( 1.0f );                     // Depth buffer setup
glEnable(GL_DEPTH_TEST);                                // Enables Depth Testing
    glEnable (GL_BLEND);
glDepthFunc(GL_LEQUAL);                                 // The Type Of Depth Testing To Do
glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST);  // Really Nice Perspective Calculations

glBlendFunc (GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); 

glPolygonOffset (1.0f, 1.0f);

firstOccurenceOfDrawRect = NO;

/* // set start values...
rVel[0] = 0.3; rVel[1] = 0.1; rVel[2] = 0.2; 
rAccel[0] = 0.003; rAccel[1] = -0.005; rAccel[2] = 0.004;*/

    [[self window] setAcceptsMouseMovedEvents: YES]; 

glViewport(0, 0, (GLsizei) self.bounds.size.width, (GLsizei) self.bounds.size.height);  
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

 - (void) drawRect: (NSRect) rect
 { 
 ///    if (firstOccurenceOfDrawRect)
//  [self initGL];

 // On charge la matrice de projection pour définir ce que l'on va voir et comment
glMatrixMode(GL_PROJECTION);

// On centre
glLoadIdentity();

// On prend du recul
glOrtho(-1.0f, 1.0f, -1.5f, 1.5f, -10.0f, 10.0f);

// On efface ce qui a été dessiné auparavant
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

// On va maintenant définir ce que l'on veut dessiner
glMatrixMode(GL_MODELVIEW);

// Avant de commencer à dessiner, on va affecter de deux rotations le repère des coordonnées du cube pour le faire "bouger"
glLoadIdentity();
glRotatef(angle, axis[0], axis[1], axis[2]); 

//  [self resizeGL]; // forces projection matrix update (does test for size changes)
//  [self updateModelView];

    glColor3f (1.0, 1.0, 1.0); 
    glDisable(GL_CULL_FACE);
    glFrontFace(GL_CW);
    glutSolidTeapot(200.0);
    glFrontFace(GL_CCW);

    glEnable(GL_TEXTURE_2D);

    glBindTexture( GL_TEXTURE_2D, texture[ 0 ] );   // Select our texture

    glBegin( GL_QUADS );
    // Front
    glTexCoord2f( 0.0f, 0.0f );
    glVertex3f( -1.0f, -1.0f,  0.0f );   // Bottom left
    glTexCoord2f( 1.0f, 0.0f );
    glVertex3f(  1.0f, -1.0f,  0.0f );   // Bottom right
    glTexCoord2f( 1.0f, 1.0f );
    glVertex3f(  1.0f,  1.0f,  0.0f );   // Top right
    glTexCoord2f( 0.0f, 1.0f );
    glVertex3f( -1.0f,  1.0f,  0.0f );   // Top left
    glEnd();

    glBindTexture( GL_TEXTURE_2D, texture[ 1 ] );   // Select our texture

    glBegin( GL_QUADS );
    // side
    glTexCoord2f( 1.0f, 0.0f );
    glVertex3f(  0.0f, -1.0f, -1.0f );   // Bottom right
    glTexCoord2f( 1.0f, 1.0f );
    glVertex3f(  0.0f,  1.0f, -1.0f );   // Top right
    glTexCoord2f( 0.0f, 1.0f );
    glVertex3f(  0.0f,  1.0f,  1.0f );   // Top left
    glTexCoord2f( 0.0f, 0.0f );
    glVertex3f(  0.0f, -1.0f,  1.0f );   // Bottom left
    glEnd();

    glBindTexture( GL_TEXTURE_2D, texture[ 2 ] );   // Select our texture

    glBegin( GL_QUADS );
    // Top
    glTexCoord2f( 0.0f, 1.0f );
    glVertex3f( -1.0f,  0.0f, -1.0f );   // Top left
    glTexCoord2f( 0.0f, 0.0f );
    glVertex3f( -1.0f,  0.0f,  1.0f );   // Bottom left
    glTexCoord2f( 1.0f, 0.0f );
    glVertex3f(  1.0f,  0.0f,  1.0f );   // Bottom right
    glTexCoord2f( 1.0f, 1.0f );
    glVertex3f(  1.0f,  0.0f, -1.0f );   // Top right
    glEnd();

    glDisable(GL_TEXTURE_2D); 

 glColor3f (1.0, 1.0, 1.0); 
 glDisable(GL_CULL_FACE);
 glFrontFace(GL_CW);
 glutSolidTeapot(200.0);

[self postRemoteImage];

[[self openGLContext] flushBuffer];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T22:54:57.783

这是相关方法的完整代码吗？如果是这样，您在拖动时永远不会抓住鼠标的位置。curPos[] 未初始化，每次收到 mouseDragged: 消息时可能返回相同的值。这可能会使您的对象始终旋转到相同的位置，使其看起来好像没有移动。

尝试在你的 mouseDragged: 方法中插入一个 NSLog 以确保它被调用以进行鼠标拖动（它可能是，但最好检查一下）。

您可能没有让主运行循环有机会刷新显示，但我认为这不太可能。我在我的代码中做了类似的事情，并让它在主线程上的所有东西上都能正常工作。

与其滚动您自己的轨迹球实现，我建议您查看 Bill Dudney 的[轨迹球示例代码](http://bill.dudney.net/roller/objc/entry/using_the_trackball)。虽然它适用于 iPhone 并处理 Core Animation，但他使用的轨迹球对象应该适用于您的情况。

# c# - .NET XML：XmlDocument.TransformNode 的 .NET 等价物是什么？

> ID：470286
> 
> 赞同：2
> 
> 时间：2009-01-22T18:23:18.580
> 
> 标签：c#, .net, xml

在本机编程中，IXMLDOMDocument2 对象有一个[`tranformNode()`](http://msdn.microsoft.com/en-us/library/ms896487.aspx)方法：

```
public BSTR transformNode(IXMLDOMNode stylesheet); 
```

所以最后我可以使用以下方法转换 XML 文档：

```
public string TransformDocument(IXMLDOMDocument2 doc, IXMLDOMDocument2 stylesheet)
{
   return doc.TransformNode(stylesheet);
} 
```

我正在尝试找到托管的等效项。我已经发现了[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)对象：

```
public string TransformDocument(XmlDocument doc, XmlDocument stylesheet)
{
   //return doc.TransformNode(stylesheet); //TransformNode not supported
} 
```

那么转换xml的托管方式是什么？

我偶然发现了**已弃用的** [XslTransform](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xsltransform.aspx)对象，但 18 个重载中没有一个使用 xml 文档或 xml 样式表。

微软表示的替换是满嘴：[System.Xml.Xsl.XslCompiledTransform](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.aspx)。但就像它已被弃用的表亲一样，XslCompiledTransform 的 14 个重载都没有将 xml 作为输入参数。

那么在 C# .NET 2.0 中转换 xml 的公认方法是什么？

换一种说法：完成以下辅助方法：

```
public string TransformDocument(XmlDocument doc, XmlDocument stylesheet)
{
   //todo: figure out how to transform xml in C#
} 
```

* * *

## 回答

[瓦卡斯给出](https://stackoverflow.com/questions/470286/-net-xml-what-is-the-net-equivalent-of-xmldocument-transformnode#470405)了答案。这是另一个非常相似的解决方案：

```
/// <summary>
/// This method simulates the XMLDOMDocument.TransformNode method
/// </summary>
/// <param name="doc">XML document to be transformed</param>
/// <param name="stylesheet">The stylesheet to transform with</param>
/// <returns></returns>
public static string Transform(XmlDocument doc, XmlDocument stylesheet)
{
    XslCompiledTransform transform = new XslCompiledTransform();
    transform.Load(stylesheet); // compiled stylesheet

    System.IO.StringWriter writer = new System.IO.StringWriter();
    transform.Transform(doc, XmlWriter.Create(writer));

    return writer.ToString();   
} 
```

**注意：**如果你是一个性能弱者，你可能想要创建一个重载来传递预编译的转换，如果你要转换不止一次。

```
public static string Transform(XmlDocument doc, XslCompiledTransform stylesheet)
{
   ...
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T19:06:07.370

这些函数将 IXPathNavigable 对象作为输入（并且 XmlDoucment/XmlNode 类实现 IXPathNavigable）。

以下是它的工作原理：

```
public string TransformDocument(XmlDocument doc, XmlDocument stylesheet)
{
   XslCompiledTransform transform = new XslCompiledTransform();
   transform.Load(stylesheet); // compiled stylesheet
   System.IO.StringWriter writer = new System.IO.StringWriter();
   transform.Transform(doc, null, writer);
   return writer.ToString();
} 
```

优化和改进：

*   如果您多次使用它，请缓存已编译的样式表。
*   将 XSL 直接加载到 XslCompiledTransform 中，而不是先构建 XmlDocument。
*   使用 XmlNode 而不是 XmlDocument 使函数更通用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T18:48:33.910

首先加载 XSL 和 XML 文档。

```
XmlDocument xsldoc = new XmlDocument();
xsldoc.Load(xslfile);

XmlDocument xmldoc = new XmlDocument();
xmldoc.Load(xmlfile); 
```

将 xsl 加载到转换对象中。

```
XslCompiledTransform xsldoctrans = new XslCompiledTransform();
xsldoctrans.Load(xsldoc); 
```

将其转换为可以读取的内存流。

```
MemoryStream ms = new MemoryStream();
xsldoctrans.Transform(xmldoc, (XsltArgumentList)null, ms); 
```

然后获取转换后的数据：

```
byte[] bTransformeddata = ms.ToArray();
string sTransformeddata = xsldoctrans.OutputSettings.Encoding.GetString(bTransformeddata); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T19:07:07.993

怎么样：

```
static void Main(string[] args)
{
    XmlDocument doc = new XmlDocument();
    doc.LoadXml(pathToXmlOrXMLString);

    XslCompiledTransform xsl = new XslCompiledTransform();
    xsl.Load(pathToXsl);

    string result = TransformDocument(doc, xsl);

}

static string TransformDocument(XmlDocument doc, XslCompiledTransform xsl)
{    
    StringBuilder sb = new StringBuilder();
    using (StringWriter sw = new StringWriter(sb))
    {
        xsl.Transform(doc.CreateNavigator(), null, sw);
    }

    return sb.ToString();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T19:07:57.927

我在生产代码中使用的解决方案看起来类似于 Wolf 的解决方案，但使用 XPathDocument（可从包含 XML 的字符串初始化）和将输出定向到 StringBuilder 的 XmlWriter 调用 XslCompiledTransform.Transform 方法。

# asp.net - ASP.net：绑定到控件（例如gridview）时如何使对象列表可排序？

> ID：470302
> 
> 赞同：1
> 
> 时间：2009-01-22T18:26:34.547
> 
> 标签：asp.net

我有一门课，我们称之为 Blah。我使用 ObjectDataSource 从数据库中获取数据，并将其值绑定到 Blah 的属性，例如，Column Foo 在我的班级中是 Blah.Foo。我可以将带有 Blah 列表的 ObjectDataSource 绑定到 gridview，但由于数据源不是数据表，我无法使其可排序。有没有人有关于如何使对象可排序以进行控制的链接或教程，如gridview。

谢谢

杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T18:55:45.910

首先，您可以在您的字段上使用带有 SortExpression 的 gridview 的 AllowSorting 属性。这是一个[教程](http://www.eggheadcafe.com/tutorials/aspnet/e07f0f1a-4243-4050-8278-00d32b2e5121/aspnet--sorting-a-gridv.aspx)

其次，您可以制作 Blah 的通用列表，然后调用 .Sort()

```
List<Blah> test = new List<Blah>;
test.AddRange(ObjectDataSource);
test.Sort(); 
```

[msdn信息](http://msdn.microsoft.com/en-us/library/b0zbh7b6.aspx)

第三，您可以直接从表达式中对 gridview 进行排序，例如

```
CustomersGridView.Sort(expression, direction); 
```

[关联](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.sort.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T18:41:20.757

您需要实现 IComparable 接口。您可能还需要实现其他接口，但它们都是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T19:02:38.033

您必须实现 Icomparable 然后将排序表达式从 gridview 传递给您的自定义排序方法。

[Imar Spaanjaars](http://imar.spaanjaars.com/ViewContentList.aspx)有一个很好的教程和代码示例，用于创建可以绑定到 asp.net 控件的可排序业务对象集合

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T03:43:01.023

您可能想尝试使用匿名代表对列表进行排序：

```
List<YourObject> MyList = new List<YourObject>();

MyList.Sort(delegate(YourObject o1, YourObject o2)
{ return o1.SomeProperty.CompareTo(o2.SomeProperty);}); 
```

更多关于匿名和委托：[MSDN](http://msdn.microsoft.com/en-us/library/0yw3tz5k(VS.80).aspx)

# javascript - 使用 Javascript 向端口发送文本

> ID：470309
> 
> 赞同：4
> 
> 时间：2009-01-22T18:28:50.597
> 
> 标签：javascript, html, post, port, printing

我最近买了一台新打印机（特别是 HP Photosmart C6380，如果有帮助的话），它允许我将文本发送到端口 9100 进行打印。Telnet 进入它并输入要打印的文本工作正常，但我想知道我是否可以使用 HTML 和 Javascript 制作一个可以直接向其发送文本的网页。

我目前正在使用文章[Cross Site Printing (pdf) 中的代码，](http://aaron.weaver2.googlepages.com/CrossSitePrinting.pdf)但缺点是当它打印出来时，它会显示整个 POST 请求，而不仅仅是文本。

所以我的问题是我能否仅发送 POST 请求的内容或仅使用 HTML 和 Javascript 去除不需要的字符？

注意：它仅限于 HTML 和 Javascript 的原因是因为我希望我可以在 iPhone 或 iPod Touch 上使用它。

**编辑**：似乎没有办法摆脱 HTTP 标头，所以现在我的问题是我可以制作一个自定义 POST 请求，以最小化标头中发送的内容吗？例如，我可以不发送用户代理，因为打印机不关心用户代理是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T18:38:04.837

不，没有办法摆脱客户端 JavaScript 中的 HTTP 标头。为此，您需要设置一个服务器端脚本，然后实际连接到打印机端口。

**编辑：**服务器端脚本不会向您的打印机发送 HTTP 请求：它应该打开一个新套接字，因此可以完全控制发送的内容！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T18:37:31.873

您可以在 JS 中进行 HTTP-Request，因此无论您发送到哪个端口，您总是有一个 HTTP-Header。所以答案是：不。

# windows - 在哪里可以找到与 mod_perl2 一起使用的代码分析和/或代码覆盖模块？

> ID：470310
> 
> 赞同：1
> 
> 时间：2009-01-22T18:28:53.700
> 
> 标签：windows, profiling, code-coverage, apache2.2, mod-perl2

有没有办法在 mod_perl2 下获得这个功能？

它可以通过网络请求而不是命令行触发吗？或者我是否需要伪造我的脚本所需的任何 $ENV 变量和查询字符串和 cookie 并以某种方式使用命令行？

Google 和 CPAN 搜索似乎都指向了一些东西，它们要么一开始就不支持 mod_perl，要么支持，但已经过时并且没有提到 mod_perl2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-19T23:11:53.837

假设你想分析你的 perl 代码，而不是服务器本身，分析器通常不关心它是 mod_perl 还是 mod_perl2，主要区别在于 apache API 模块以及你可以让 apache 使用 perl 为你做什么。

看看[Devel::NYTProf](http://metacpan.org/pod/Devel::NYTProf)，它相对较新，得到积极维护和改进，并提供了一些非常好的分析功能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-22T19:21:04.593

这里的策略略有不同，但看看[Apache2::ASP](http://search.cpan.org/perldoc?Apache2::ASP)。

您可以使用 Devel::Cover 和 Devel::NYTProf 进行代码覆盖和代码分析。

示例：[使用 Apache2::ASP 进行代码覆盖测试](http://www.devstack.com/articles/apache2-asp-code-coverage/)

示例：[使用 Apache2::ASP 进行代码分析](http://www.devstack.com/articles/apache2-asp-code-profiling/)

奖励 - 您可以对 Web 应用程序本身执行[单元测试](http://www.devstack.com/articles/apache2-asp-testing/)。

免责声明：我编写了 Apache2::ASP。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-10-13T20:56:28.460

没有任何符合标准的。

# sql - 在 .NET 中，将数据从 SQL 流式传输到文件

> ID：470311
> 
> 赞同：3
> 
> 时间：2009-01-22T18:29:32.077
> 
> 标签：sql, asynchronous

我必须从 SQL 中获取 DataTable，然后将其转换为 XML（我不能使用 SQL XML）并保存到文件中。问题是该文件将是 5 GB，我没有足够的内存来下载它并在内存中一次将其转换为 XML。我知道我应该能够使用 DataReader 将数据分块转换并推送到文件流，但我不知道如何真正做到这一点。我该怎么做？

1.  异步连接到 SQL 服务器
2.  异步调用存储过程
3.  从 DataReader 异步读取数据
4.  将数据从 DataReader 转换为 XML 并异步保存到文件

这一切都必须是异步的，因为它在处理多个请求的服务器上，我们不能为每个请求设置一个线程阻塞。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T18:39:32.073

为什么需要异步执行任何操作？这可能会表现得更好，但会复杂得多。

这样做的简单方法：

*   执行查询以获取 DataReader
*   创建一个写入文件的 XmlWriter
*   尝试读取一行
    *   如果没有更多的行了，你就完成了。（确保关闭编写器/连接等）
    *   如果*确实*得到一行，请将其写入 XmlWriter（添加一个元素或您需要做的任何事情）。
*   返回上一步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-26T20:59:39.930

大行 (BLOB) 少，还是小行多？对于大型 BLOB，这两篇文章包含从 C# 以流方式处理 SQL Server BLOB 所需的代码：

*   [通过 ASP.Net MVC 从 SQL Server 下载和上传图像](http://rusanu.com/2010/12/28/download-and-upload-images-from-sql-server-with-asp-net-mvc/)
*   [FILESTREAM MVC：从 SQL Server 下载和上传图像](http://rusanu.com/2011/02/06/filestream-mvc-download-and-upload-images-from-sql-server/)

第一个处理普通 BLOB，第二个处理 FILESTREAM BLOB。

对于许多小行，您不需要任何花哨的东西，只需打开阅读器并开始流式传输到您的 XmlWriter 中。唯一可以异步的部分是初始查询执行，一旦结果开始返回，您的回调将完成并且读取结果 SqlDataReader 是一个同步操作。这意味着线程在结果读取和 XML 文件写入的整个持续时间内被阻塞，根本没有 ADO.Net API 可以避免这个问题。您担心这会导致问题（它会）是对的，但我不得不问：为什么您的系统要对 XML 文件进行如此大的下载？是否要将结果序列化回 HTTP 响应？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T18:39:12.213

你需要的是一个[XmlWriter](http://msdn.microsoft.com/en-us/library/system.xml.xmlwriter.aspx)

# c# - .NET：如何在没有 DOCTYPE 声明的情况下使用 DTD 验证 XML 文件

> ID：470313
> 
> 赞同：9
> 
> 时间：2009-01-22T18:32:08.827
> 
> 标签：c#, .net, xml, vb.net, dtd

我有一个没有 DOCTYPE 声明的 XML 文件，我想在阅读时使用外部 DTD 进行验证。

```
Dim x_set As Xml.XmlReaderSettings = New Xml.XmlReaderSettings()
x_set.XmlResolver = Nothing
x_set.CheckCharacters = False
x_set.ProhibitDtd = False
x = XmlTextReader.Create(sChemin, x_set) 
```

您如何设置该外部 DTD 的路径？你如何验证？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-25T07:25:24.593

我之前成功使用过以下功能，应该很容易适应。这如何依赖于创建一个 XmlDocument ，如 magnifico 所述。这可以通过以下方式实现：

```
XmlDocument doc = new XmlDocument();
doc.Load( filename );
doc.InsertBefore( doc.CreateDocumentType( "doc_type_name", null, DtdFilePath, null ), 
    doc.DocumentElement );

/// <summary>
/// Class to test a document against DTD
/// </summary>
/// <param name="doc">XML The document to validate</param>
private static bool ValidateDoc( XmlDocument doc )
{
    bool isXmlValid = true;
    StringBuilder xmlValMsg = new StringBuilder();

    StringWriter sw = new StringWriter();
    doc.Save( sw );
    doc.Save( TestFilename );

    XmlReaderSettings settings = new XmlReaderSettings();
    settings.ProhibitDtd = false;
    settings.ValidationType = ValidationType.DTD;
    settings.ValidationFlags = XmlSchemaValidationFlags.ReportValidationWarnings;
    settings.ValidationEventHandler += new ValidationEventHandler( delegate( object sender, ValidationEventArgs args )
    {
        isXmlValid = false;
        xmlValMsg.AppendLine( args.Message );
    } );

    XmlReader validator = XmlReader.Create( new StringReader( sw.ToString() ), settings );

    while( validator.Read() )
    {
    }
    validator.Close();

    string message = xmlValMsg.ToString();
    return isXmlValid;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T06:54:09.603

您能否使用所需的 DTD 创建一个 Xml.XmlDocument，然后将 XML 文件数据附加到内存中的 Xml.XmlDocument，然后进行验证？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-11-03T20:02:40.283

```
private static bool _isValid = true;
static void Main(string[] args)
{
    using (MemoryStream ms = new MemoryStream())
    {
        using (FileStream file = new FileStream("C:\\MyFolder\\Product.dtd", FileMode.Open, FileAccess.Read))
        {
            byte[] bytes = new byte[file.Length];
            file.Read(bytes, 0, (int) file.Length);
            ms.Write(bytes, 0, (int) file.Length);
        }
        using (FileStream file = new FileStream("C:\\MyFolder\\Product.xml", FileMode.Open, FileAccess.Read))
        {
            byte[] bytes = new byte[file.Length];
            file.Read(bytes, 0, (int) file.Length);
            ms.Write(bytes, 0, (int) file.Length);
        }
        ms.Position = 0;

        var settings = new XmlReaderSettings();
        settings.DtdProcessing = DtdProcessing.Parse;
        settings.ValidationType = ValidationType.DTD;
        settings.ValidationEventHandler += new ValidationEventHandler(OnValidationEvent);
        var reader = XmlReader.Create(ms, settings);

        // Parse the file.  
        while (reader.Read()) ;
    }
    // Check whether the document is valid or invalid.
    if (_isValid)
        Console.WriteLine("Document is valid");
    else
        Console.WriteLine("Document is invalid");
}

private static void OnValidationEvent(object obj, ValidationEventArgs args)
{
    _isValid = false;
    Console.WriteLine("Validation event\n" + args.Message);
} 
```

# asp.net - 在 ListView InsertItemTemplate 中绑定 DropDownList 会引发错误

> ID：470315
> 
> 赞同：6
> 
> 时间：2009-01-22T18:33:51.257
> 
> 标签：asp.net, linq-to-sql, data-binding

我有一个 ListView 绑定到 LinqDataSource 并显示选定的位置。插入项包含一个下拉列表，该下拉列表从另一个 LinqDataSource 中提取以提供所有未选择的位置。

问题是加载页面时出现以下错误：

Eval()、XPath() 和 Bind() 等数据绑定方法只能在数据绑定控件的上下文中使用。

我在网站的另一个页面上做了一个非常相似的设置，它没有给我们这个错误，所以我很困惑。我知道我可以通过不绑定、手动查找控件并获取值来解决此问题，但这应该可行，但我不明白为什么不可行。

有什么想法吗？

源代码的更好部分如下。

```
<asp:LinqDataSource ID="ldsLocations" runat="server" 
    ContextTypeName="ClearviewInterface.ESLinqDataContext" EnableDelete="true" EnableInsert="true"
    OnInserting="ldsLocations_Inserting" OnDeleting="ldsLocations_Deleting" 
    TableName="crmLocations" OrderBy="addr1" OnSelecting="ldsLocations_Selecting" />

<asp:LinqDataSource ID="ldsFreeLocations" runat="server" 
    ContextTypeName="ClearviewInterface.ESLinqDataContext" OrderBy="addr1" 
    TableName="v_CVLocations" OnSelecting="ldsFreeLocations_Selecting" />

<asp:ListView ID="lvLocations" DataSourceID="ldsLocations" DataKeyNames="ID" InsertItemPosition="LastItem" runat="server" >

<InsertItemTemplate>
        <tr>
            <td colspan="6"><hr /></td>
        </tr>
        <tr>
            <td colspan="2">

                <asp:DropDownList    ID="ddlFreeLocations" DataSourceID="ldsFreeLocations" DataTextField="addr1" 
                                        DataValueField="record" MarkFirstMatch="true" SelectedValue='<%# Bind("record") %>' 
                                        runat="server" />
            </td>
            <td><asp:ImageButton ID="btnAdd" CommandName="Insert" SkinID="Insert" runat="server" /></td>
        </tr>

    </InsertItemTemplate> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-10T00:02:00.873

正如[Joteke 的博客](http://aspadvice.com/blogs/joteke/archive/2008/08/24/Is-_2200_Databinding-methods-such-as-Eval_280029002C00_-XPath_280029002C00_-and-Bind_28002900_-can-only-be-used-in-the-context-of-a-databound-control_2E002200_-causing-you-grief_3F00_.aspx)上所解释的，这里是一个引用的解决方案。

> 您是否使用`<%#Eval("field")%>`表达式来绑定控件？如果将其更改为`<%#DataBinder.Eval(Container.DataItem,"field")%>`，这似乎可以解决错误吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T08:05:43.187

看看这个线程[http://forums.asp.net/t/1187425.aspx](http://forums.asp.net/t/1187425.aspx)

基本上你不能使用 Bind 语法，因为 InsertItemTemplate 中的控件只是“单向”的。使用后面的代码来获取值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-01T04:00:41.890

对于这种情况，我们可以考虑以下解决方案：

1.  对于内部嵌套控件，我们使用其他方法来填充其项目，而不是数据绑定。例如，我们可以使用 for 循环将项目添加到下拉列表中，而不是数据绑定。因此，不会计算 <%# ...%> 表达式。

2.  我们还可以对容器 DetailsView 控件进行更改。我们可以手动使用诸如“RowDataBound”之类的事件来将数据项填充到某个内部控件，而不是 <%# %> 表达式。并且在执行更新/插入时，手动从适当事件中的控件中提取值（例如 ItemUpdating 或 ItemInserting...）。

来源：http: [//blogs.msdn.com/b/stcheng/archive/2009/01/15/aspnet-system-invalidoperationexception-databinding-methods-such-as-eval-xpath-and-bind-can-only-在嵌套数据绑定-scenario.aspx 的上下文中使用](http://blogs.msdn.com/b/stcheng/archive/2009/01/15/aspnet-system-invalidoperationexception-databinding-methods-such-as-eval-xpath-and-bind-can-only-be-used-in-the-context-of-a-databound-control-error-in-nested-databinding-scenario.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-05T05:54:21.890

这会起作用

```
 protected void lstCompContctPerson_ItemCreated(object sender, RadListViewItemEventArgs e)
        {

        if ((e.Item != null) && (e.Item.ItemType == RadListViewItemType.InsertItem))
        {
            System.Web.UI.Control ddlCompNames = e.Item.FindControl("ddlCompNames");

           (ddlCompNames as RadDropDownList).DataSource = (from _company in objshortcut.GetAllCompanies()
            select new
            {
                  CompanyID = _company.CompanyID,
                  CompContctName = _company.CompanyName
             }).Distinct();

        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-27T12:15:24.323

使用 #Eval 可能值得使用 DataBinder.Eval() 来确保绑定在正确的时间发生。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T21:01:29.943

我有一个类似的问题。如果您不更新该字段的值，请尝试使用#Eval。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-27T10:55:00.120

我已经成功了。我有一个带有 SqlDataSource 的 Formview，在表单视图上有一个带有 SQLdataSource 的下拉列表。

当请求新记录时，我为两个数据源重新发出选择命令 - 下拉列表源提供选项列表，而 formview 数据源不返回任何内容。

然后我在表单视图和下拉列表上都使用 DataBind() ，一切都很好。

我是 ASP.Net 的新手，但这对我有用，让我可以做我想做的事——在下拉列表中使用 Bind，在表单视图中使用文本框

我希望这可以帮助内森

# javascript - 更改现有 onclick 函数的值

> ID：470321
> 
> 赞同：0
> 
> 时间：2009-01-22T18:36:50.033
> 
> 标签：javascript, jquery

我有一个页面通过 iframe 拉入来自预先存在的内容管理系统的 html 内容页面，我无法直接更改其内容。我想使用 jquery 来动态改变一些链接和按钮的位置。

对于页面内的链接，我能够更改 href attr 值

```
<a href="/content.asp">more</a> 
```

从 content.asp 到 content2.asp 使用

```
$("a[href^='/content.asp']")
.each(function()   {       this.href = this.href.replace("content.asp",          "content2.asp");   }); 
```

但是拉入的页面也有包含 javascript onclick 功能的表单按钮，例如

```
<INPUT type="button" value="Add to basket" onClick="document.location='/shopping-basket.asp?mode=add&id_Product=1076';"> 
```

我基本上想使用 jquery 来选择任何这样的按钮并将 shopping-basket.asp 更改为 shopping-basket2.asp

如何选择这些按钮/点击功能并更改位置字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T19:00:46.303

对这个解决方案不是很自豪，但它确实有效....

```
var getid = /id_Product=(\d+)/;
$('input[type="button"]').each(function() {
    var onclick = String(this.onclick);
    var id = onclick.match(getid);
    if(id) {
        this.onclick = function() {
            window.location = "/shopping-basket2.asp?mode=add&id_Product=" + id[1];
        };
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T19:08:47.457

[http://docs.jquery.com/Selectors/attributeContains#attributevalue](http://docs.jquery.com/Selectors/attributeContains#attributevalue)

```
$("input[onClick*='shopping-basket.asp']").each( ... ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T18:42:03.970

给你的按钮一个唯一的`id`，然后从一个javascript脚本中引用它：

`document.getElementById("idOfButton").onClick`

只需将值设置为新的文本字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-20T04:47:39.377

只是想我会更新这个答案，因为我在 JQuery 1.4.1 中尝试了几种组合

1) onclick=function() - 不工作

```
$("input").each(function() {
    $(this).onclick = function() {
        window.location.href= 'http://www.google.com';
        return false;
    }
} 
```

2) $newclick = eval(...) 不工作

```
$("input").each(function() {
    $jscript = "window.location.href= 'http://www.google.com'; return false;"
    $newclick = eval("(function(){" + $jscript + "});");
    $(this).onclick = newclick; 
```

}

顺便提一句。$newclick 被评估为未定义

3）适用于 JQuery 1.4.1 的新答案

```
$("input").each(function() {
     $(this).click(function() {
        window.location.href = "http://www.google.com";
        return false;
 }); 
```

我搜索了 JQuery API 并且没有 onclick 文档。看起来 click() 是要走的路。让我知道我是否犯了任何错误。

干杯

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-22T18:39:48.670

[使用.attr](http://docs.jquery.com/Attributes/attr#keyvalue)方法更改属性。

```
$("a").each(function(){
  $(this).attr("href","content.asp");
}); 
```

您也应该能够替换硬编码的 onClick 文本。要选择这些按钮，您可以抓住所有按钮：

```
$("input.convertMe").each(function(){...}); 
```

或者您可以向您特别感兴趣的按钮添加类：

```
<input type="button" class="convertMe"...> 
```

一旦你完成了这两个中的任何一个，你只需运行每个测试它们的 onClick 属性，并确定是否需要进行任何更改：

```
$("input.convertMe").each(function(){
  // Test onClick attr, and replace string.
}); 
```

# c# - 为什么我不能将 Linq 的结果转换为 SQL？

> ID：470323
> 
> 赞同：1
> 
> 时间：2009-01-22T18:37:23.637
> 
> 标签：c#, asp.net, linq-to-sql

我有一个带有 SQL 函数的 Linq to SQL DataContext。虽然检索对象很好，但我想为对象添加一个属性，同时缩短对象名称。因此，我创建了一个对象 Reminder，它从 Linq 继承到 SQL 对象 fnRTHU_ReminderByTaskResult，并具有我想要的属性。

```
public class Reminder : fnRTHU_ReminderByTaskResult
{
    public string MyProperty {get;set;}
} 
```

然后，当函数绑定到列表时，我尝试在 aspx 文件中执行以下操作：

```
<asp:Literal runat="server" Text='<%# ((Reminder)DataBinder.Container).MyProperty %>' /> 
```

其中 DataBinder.Container 的类型为 fnRTHU_ReminderByTaskResult。这会导致 InvalidCastException，无法将对象类型 fnRTHU_ReminderByTaskResult 转换为 Reminder 类型。我不明白，因为我继承了我要转换的类型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T18:43:09.630

由于 Linq to Sql 函数返回该基类，因此您的对象绝不是派生类的对象。因此，当试图向下施法时，它是做不到的。但是，您可以在您的类中提供隐式和显式转换实现，以允许这种转换工作。

[看这里](http://msdn.microsoft.com/en-us/library/aa288476(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:42:46.153

问题是您试图将 Base 类的实例转换为 Child 类。这是无效的，因为 Child 继承自 Base。不能保证从 Base 到 Child 的案例会奏效（这被称为 downcaste）。向上施法（儿童到基地）是安全的。

如果 Container 属性是 Reminder 的实例，这将起作用。在这种情况下，它似乎不是。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-22T18:42:01.380

不幸的是，您正试图贬低哪个 C# 不支持。您无法从父类型转换为子类型。

# c - ANSI C89/ISO C90 中空指针的界限

> ID：470331
> 
> 赞同：0
> 
> 时间：2009-01-22T18:40:11.963
> 
> 标签：c, void-pointers, c89

**有没有办法在 ANSI C89/ISO C90 中可移植地确定 void-pointer 值的上限和下限？**（我目前没有标准的副本（我家里有一个）。当然，如果保证 void-pointer 值是无符号的，这个任务是微不足道的（通过 sizeof(void *)）；但是，我不能回想一下这是否得到保证。我可以想到一些非常低效的算法（递增直到溢出等），但我想知道是否有人有相对便宜（就时间复杂性而言）和可移植的方法计算这些界限。）

- 编辑 -

**另外：**是否有一种可移植的方法来确定指针值的有效性？

**原因：**这是在与一位同事的讨论中提出的，这让我很困惑。我不知道他在做什么，但我只是想知道，因为我有兴趣！:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T19:05:04.157

没有可移植的方法来确定给定指针是否有效。你必须知道你正在处理什么样的记忆系统。根据操作系统和处理器，可能有也可能没有查询虚拟内存管理器的页表以确定指针的有效范围的方法。

例如，在 Linux 上，您可以检查下面的特殊`mmap`文件`/proc`以获取进程的虚拟内存映射。下面是一个`cat`读取它自己的内存映射的例子：

```
$猫/proc/self/mmap
08048000-0804c000 r-xp 00000000 09:00 5128276 /bin/cat
0804c000-0804d000 rw-p 00003000 09:00 5128276 /bin/cat
0804d000-0806e000 rw-p 0804d000 00:00 0 [堆]
f7ca7000-f7e40000 r--p 00000000 09:00 3409654 /usr/lib/locale/locale-archive
f7e40000-f7e41000 rw-p f7e40000 00:00 0
f7e41000-f7f68000 r-xp 00000000 09:00 2654292 /lib/tls/i686/cmov/libc-2.3.6.so
f7f68000-f7f6d000 r--p 00127000 09:00 2654292 /lib/tls/i686/cmov/libc-2.3.6.so
f7f6d000-f7f6f000 rw-p 0012c000 09:00 2654292 /lib/tls/i686/cmov/libc-2.3.6.so
f7f6f000-f7f72000 rw-p f7f6f000 00:00 0
f7f83000-f7f85000 rw-p f7f83000 00:00 0
f7f85000-f7f9a000 r-xp 00000000 09:00 2637871 /lib/ld-2.3.6.so
f7f9a000-f7f9c000 rw-p 00014000 09:00 2637871 /lib/ld-2.3.6.so
ff821000-ff836000 rw-p 7ffffffea000 00:00 0 [堆栈]
ffffe000-fffff000 r-xp ffffe000 00:00 0 [vdso]

```

您可以看到有效指针的范围，以及指示内存是否为 (r) 可读、 (w) 可写、 e(x) 可执行或 (p) 可重新发送（即未分页到磁盘）的位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T18:43:07.727

规范保证指针是无符号的。但是你到底为什么要找到界限呢？“0x00000001 和 0xffffffff 之间的所有内容”并不是一个真正有用的测试，因为*有效*指针的数量只是其中的一小部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T19:00:09.597

我知道在 Win32 上，64 位指针是符号扩展的。如果您不签署扩展指针，从 64 位机器检查 32 位小型转储会很有趣。

请参阅[此处](http://msdn.microsoft.com/en-us/library/aa384264(VS.85).aspx)了解 64 位指针 ( `POINTER_64`) 如何在 Win32 上工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T19:15:22.483

void * 总是大到足以容纳指向可寻址内存的指针。大联盟棒球协会严禁任何其他用途。

示例：dec-10 是具有 36 位字的 36 位架构。然而地址是 18 位，你可以在任何寄存器/字中保存 2 个指针。

是的 - 这是一个极端的例子。如果你必须用指针做数学，sizeof 是有效的；但是在连续数组以外的任何东西上进行指针数学运算都比狡猾。

最后 - 永远不要使用 'void *' 来存储指向对象的指针或指向 C++ 中成员的指针。许多编译器实现实际上使用多个“物理”指针来实现具体（或部分具体）类的多重继承。实际上，这几乎从来没有出现过，因为很少有人以这种方式使用多重继承，而且当他们这样做时，很少会分片和取消分片指针。当它出现时，真的很难弄清楚发生了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T19:28:33.033

`void *`您必须从内存中的实际位模式中辨别出可以将 a 转换为的整数值 - 将 a`void *`转换为整数类型可能涉及转换！

假设`sizeof(void *) == sizeof(long)`，对于 a`void * p`以下很可能是错误的：

```
((long)p) == *((long *)&p) 
```

此外，标准没有指定是否存在*足够*大的整数类型来保存所有有效指针的值！

因此，没有可移植的方式来做你想做的事......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-23T03:32:42.277

除了对应于 NULL 的区域之外，对内存地址根本没有（可移植的）限制。一个充分强化的操作系统可以利用各种 CPU/OS 机制在每次调用 malloc() 时为每个进程提供随机且分布良好的地址，并且位置独立的可执行文件加上 ASLR 也可以允许代码从任何地址运行。

# linq - TOP PERCENT 的 LINQ 版本

> ID：470339
> 
> 赞同：6
> 
> 时间：2009-01-22T18:42:11.163
> 
> 标签：linq, linq-to-sql

有没有办法使用百分比执行顶级（Take）linq 查询？T-SQL 应该是：

```
SELECT TOP 20 PERCENT ... 
```

但 LINQ 似乎只需要一个 int。

看来我必须先数数，然后再拍。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T18:56:49.103

本质上，您必须执行两次查询。您必须执行一次才能获得计数，然后再次计算百分比（因为您将传递与等于 20% 的计数相对应的数字）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T19:19:37.763

我认为 LINQ to SQL 中没有内置任何内容。您可以使用存储过程来做到这一点。我不太喜欢，除非你碰巧使用了一个过程，但它可能比使用两个单独的查询更好。

# asp.net - 如何将 Javascript 属性添加到 ASP.NET RadioButtonList 项？

> ID：470346
> 
> 赞同：1
> 
> 时间：2009-01-22T18:44:34.060
> 
> 标签：asp.net, javascript, radiobuttonlist

我正在尝试为**RadioButtonList的每个****ListItem**的任何 <input>、<td> 或 <label> 元素添加一些**onmouseover**和**onmouseout**属性。我该怎么做呢？这是我尝试过的。这不起作用...

 ****ASPX 文件...

```
<asp:RadioButtonList ID="RadioButtonListPaymentFrequency"
    runat="server"
    RepeatDirection="Vertical"
    RepeatLayout="Table"
    RepeatColumns="1" /> 
```

VB代码背后...

```
将 ListItemOneTimeOnly 调暗为新的 ListItem("One-Time Only", "1")
ListItemOneTimeOnly.Attributes.Add("onmouseover", "ddrivetip('示例：一次性支付 300 美元的总金额意味着 1 次支付 300 美元。')")
ListItemOneTimeOnly.Attributes.Add("onmouseout", "hideddrivetip()")
RadioButtonListPaymentFrequency.Items.Add(ListItemOneTimeOnly)

将 ListItemMonthly 调暗为新 ListItem("Monthly", "12")
ListItemMonthly.Attributes.Add("onmouseover", "ddrivetip('示例：每月支付 300 美元的总金额意味着 12 次支付 25 美元。')")
ListItemMonthly.Attributes.Add("onmouseout", "hideddrivetip()")
RadioButtonListPaymentFrequency.Items.Add(ListItemMonthly)

将 ListItemQuarterly 调暗为新 ListItem("Quarterly", "4")
ListItemQuarterly.Attributes.Add("onmouseover", "ddrivetip('示例：每季度支付 300 美元的总金额意味着 4 次支付 75 美元。')")
ListItemQuarterly.Attributes.Add("onmouseout", "hideddrivetip()")
RadioButtonListPaymentFrequency.Items.Add(ListItemQuarterly)

Dim ListItemSemiannually As New ListItem("Semiannually", "2")
ListItemSemiannually.Attributes.Add("onmouseover", "ddrivetip('示例：每月支付 300 美元的总金额意味着 2 次支付 150 美元。')")
ListItemSemiannually.Attributes.Add("onmouseout", "hideddrivetip()")
RadioButtonListPaymentFrequency.Items.Add(ListItemSemiannually)

```

生成的 HTML...

```
<table id="RadioButtonListPaymentFrequency" border="0">
    <tbody>
        <tr>
            <td>
                <input id="RadioButtonListPaymentFrequency_0" name="RadioButtonListPaymentFrequency" value="1" type="radio">
                <label for="RadioButtonListPaymentFrequency_0">One-Time Only</label>
            </td>
        </tr>
        <tr>
            <td>
                <input id="RadioButtonListPaymentFrequency_1" name="RadioButtonListPaymentFrequency" value="12" type="radio">
                <label for="RadioButtonListPaymentFrequency_1">Monthly</label>
            </td>
        </tr>
        <tr>
            <td>
                <input id="RadioButtonListPaymentFrequency_2" name="RadioButtonListPaymentFrequency" value="4" type="radio">
                <label for="RadioButtonListPaymentFrequency_2">Quarterly</label>
            </td>
        </tr>
        <tr>
            <td>
                <input id="RadioButtonListPaymentFrequency_3" name="RadioButtonListPaymentFrequency" value="2" type="radio">
                <label for="RadioButtonListPaymentFrequency_3">Semiannually</label>
            </td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:06:50.677

你没有。除非您使用[解决方法](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q309338)或[子类](http://aspnet.4guysfromrolla.com/articles/091405-1.aspx)RadioButtonList。我个人只是使​​用[JQuery](http://jquery.com/)来附加事件处理程序。

# shell - MacFUSE：保活？

> ID：470349
> 
> 赞同：2
> 
> 时间：2009-01-22T18:46:44.383
> 
> 标签：shell, timeout, keep-alive, macfuse

如果远程主机设置为由于不活动而中断连接，有没有办法配置 MacFUSE 以保持挂载的卷处于活动状态？如果没有直接的方法来配置它，是否有办法编写脚本来完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-06-15T13:21:41.640

试试[Fuse4x](http://fuse4x.org)。它包含对 MacFUSE 的几个修复。sshfs 的这个问题可能在那里得到解决。您也可以询问 fuse4x.org 论坛。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T16:52:11.430

根据 Maksim 的回答，这里有一些快速而肮脏的东西。将此代码复制并粘贴到 Scipt Editor 中并将其保存为应用程序。如果您需要在 900 分钟结束之前退出它，则必须强制退出它。

```
repeat 900 times
    do shell script "touch path/to/file/dummyfile.txt"
    --sleep for 1 minute
    do shell script "/bin/sleep 60"
end repeat 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:36:27.210

您可以使用“touch [filename]”来触摸驱动器上的文件。在 Apple 脚本中使用此命令，它应该可以正常工作。我还没有测试过。当我写完这个脚本时，大家都编辑我的帖子。

# django - 为什么我的 Django 应用程序不能与 Apache/mod_python 一起使用？

> ID：470356
> 
> 赞同：0
> 
> 时间：2009-01-22T18:50:58.727
> 
> 标签：django, apache, mod-python

我有 Apache 设置来服务来自该目录的[http://www.mysite.com](http://www.mysite.com)请求：

/var/www/html/www.mysite.com

Django 站点位于 /var/www/html/www.mysite.com/mysite。

当我向 /mysite/app/foo 发出请求时出现此错误：

（大堆栈跟踪）AttributeError：'module'对象没有属性'common'

'myapp.common' 是settings.py 文件中 INSTALLED_APPS 中所有 django 应用程序（例如 'django.contrib.admin'）*之后*列出的第一项。如果我更改列出的模块的顺序，Django 会在它遇到的我的一个应用程序的第一个路径上阻塞。

Python 导入路径似乎是正确的，因为它找到了 mysite.settings：

```
<位置“/mysite/”>
    SetHandler python 程序
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mysite.settings
    PythonOption django.root /mysite
    Python调试开启
    PythonPath "['/var/www/html/www.mysite.com'] + sys.path"
</位置>

```

可能是什么问题呢？奇怪的是，当实际列表包含“mysite.common”时，它却在抱怨“common”：

```
INSTALLED_APPS = (
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'mysite.common',
    ……

```

这是 Django 错误还是我配置错误？也许需要将一些外部依赖项添加到导入路径中？它适用于 Django 开发服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:18:34.677

您的`mysite`目录是否包含`__init__.py`文件？它应该将其[标记为 package](http://docs.python.org/tutorial/modules.html#packages)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T22:49:03.720

I'm guessing you're obscuring your actual module name intentionally, which is fine... but I got this error when I had named my Django site (mysite, in your case) with the same name as a Python module that exists elsewhere in sys.path.

For example, if you created a Django site called math, with an app called common inside of it, you'd get this error because the Python system math module doesn't contain an attribute or submodule named common.

You'll have to rename your Django site to not collide with the other module name.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T02:19:52.600

`mysite.common`包裹是否存放在下`/var/www/html/www.mysite.com/mysite/common`？如果是这样，请尝试使用`common`而不是`mysite.common`in `INSTALLED_APPS`。

# email - 报告订阅 SSRS 中的电子邮件传递

> ID：470363
> 
> 赞同：1
> 
> 时间：2009-01-22T18:54:13.353
> 
> 标签：email, reporting-services, subscription

我有一份 SSRS 报告。我尝试创建一个订阅，要求通过电子邮件将报告发送到我的邮件帐户，但它失败了，并给出了以下错误消息：

> 一位或多位收件人的电子邮件地址无效。

我有一个浏览器角色。

谁能告诉我原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T23:36:36.620

有几个问题可能会导致这种情况：

将电子邮件别名与 Windows Vista 或 Windows Server 2008 ( [http://support.microsoft.com/kb/945601](http://support.microsoft.com/kb/945601) )结合使用

报告服务器无权通过 Exchange 服务器中继电子邮件 ( [http://blogs.technet.com/jonathanalmquist/archive/2008/04/01/scheduled-reports-email-address-not-valid.aspx](http://blogs.technet.com/jonathanalmquist/archive/2008/04/01/scheduled-reports-email-address-not-valid.aspx) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-15T02:41:21.517

我最初也遇到了一些麻烦。我的问题是当 SSRS 需要分号时，我用逗号分隔电子邮件地址。

# sharepoint - SharePoint 网站设计和实施：“在线手册”

> ID：470365
> 
> 赞同：2
> 
> 时间：2009-01-22T18:54:39.453
> 
> 标签：sharepoint, moss, sharepoint-2007

我希望在 MOSS 2007 中创建一个“在线手册”站点模板，以便创建多个站点来保存有关一系列主题的静态信息。

*   我应该使用什么网站模板，我目前正在考虑发布网站，但 Wiki 可能有用吗？
*   我应该如何显示不同“章节”的导航（在左侧面板中）？我可以使用“目录”webpart、列表上的自定义视图或其他东西。
*   我应该如何存储创建的“页面”、1 个大型页面库或每个“章节”的单独列表
*   最后，我是否应该将导航 web 部件硬编码到母版页，以便它出现在每个页面上？

**编辑：**

我真正的问题是“*我将如何创建左侧导航，以显示在每个页面上？* ”

它应该是一种目录类型的视图，其中所有页面都按章节分组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T15:51:39.497

谢谢你们每一个人的帮助！我只是想让你知道我最终做了什么来创建“在线手册”。

我创建了一个自定义

1) 母版页以允许所需的 2 列布局。

2) 页面布局以在所有页面上保留导航控件。

3) 带有“章节”和“排序顺序”自定义列的文档库

4) 使用对象模型从文档库中检索所有页面并将它们显示在按“章节”分组并按“排序顺序”排序的列表中的 Web 部件（在 C# 中）

我使用 Publishing 站点模板允许贡献者更自由地创建内容。

再次感谢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T20:25:08.927

将站点保留为发布站点模板，因为您需要能够发布页面。如有必要，您始终可以将 wiki 添加到发布站点模板。

wiki 不适合静态在线手册内容，因为它本质上是一个允许用户动态添加/编辑的列表。wiki 可以作为手册的附件，允许用户添加支持信息。

手册中棘手的部分是页面的排序，因为在每个阶段，您都需要按正确的顺序列出下一页/后退和每页的列表。

我们创建了一个自定义导航提供程序，它根据页面中的值生成信息。然而，这些页面没有被订购。

[除非您要处理每个列表超过 2000 个页面，](http://go.microsoft.com/fwlink/?LinkId=95450&clcid=0x409)否则将“页面”存储在不同的列表中将比快乐更痛苦。.

我认为尽可能简单。

有几个页面布局，一个用于“内容页面”，一个用于普通“页面”。为每个布局创建一个新的内容类型，以便您可以在每个页面上存储特定信息（例如下一个/上一个页面 url）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T20:39:40.883

网站必须在 Sharepoint 中吗？有许多 wiki 引擎/框架在这方面非常出色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T15:57:36.177

我认为列表视图 web 部件将是要走的路。假设您的文档在章节内排序，您需要将视图类型设置为递归，然后按文件夹名称分组（我认为您可以这样做，目前我无法访问 SP 安装以核实）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T03:04:21.527

我过去使用 Sharepoint wiki 构建了用户指南并取得了一些成功。

左侧导航可以通过将 Sharepoint 的标准左侧菜单更改为指向 wiki 页面的链接列表来完成。这是通过转到**站点设置 -> 导航（在外观下）**并更改**导航编辑和排序**列表来完成的。理论上你可以在那里添加每一页，但为了便于阅读，我会坚持只使用章节标题。

您还可以更改站点的权限，以便只有您（或您的文档人员）有权编辑页面。

# asp.net - ASP.NET 页面上的多种语言（英语、法语）

> ID：470366
> 
> 赞同：10
> 
> 时间：2009-01-22T18:55:03.617
> 
> 标签：asp.net, localization, internationalization, globalization

我只是想知道在网页上处理多种语言的最佳方法是什么？我应该在负载中创建一个事件，将所有控件的标签更改为适当的语言文本，还是有更好的方法？我正在使用 .NET 框架，谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-22T18:59:49.787

对于 ASP.NET，使用资源文件。这将让您提供多语言功能，并且您可以添加翻译而无需重新编译。

[http://www.beansoftware.com/ASP.NET-Tutorials/Globalisation-Multilingual-CultureInfo.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/Globalisation-Multilingual-CultureInfo.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:58:36.543

您将需要查看 MSDN 文档中处理 ASP.NET 应用程序的本地化和全球化的部分：

[http://msdn.microsoft.com/en-us/library/c6zyy3s9.aspx](http://msdn.microsoft.com/en-us/library/c6zyy3s9.aspx)

# wcf - 使用 DTO 在对象关系映射器和数据访问层之间传输数据

> ID：470372
> 
> 赞同：1
> 
> 时间：2009-01-22T18:57:11.617
> 
> 标签：wcf, orm, soa, data-access-layer

使用 DTO 在对象关系层和数据访问层之间传输数据是否有意义？这种模式什么时候有用，什么时候是反模式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:25:10.310

当您想将业务代码与数据库隔离时，它非常有用。用非常简单的术语来说，DTO 是通过从数据库中选择来创建的，而对 DTO 的更改由数据访问层转换回数据库。在某些情况下，您甚至可以实现数据库供应商独立性（至少在代码的业务方面）。

常见的缺点是当您有非常特定的 SQL 来处理复杂的连接、联合等或最大化性能时。在这些情况下，让 DAL 允许某种“绕过”方法非常有用，您可以在其中发送动态 sql 或存储过程并取回数据。

# iis-7 - 在 IIS7 的 web.config 中设置集成模式

> ID：470374
> 
> 赞同：3
> 
> 时间：2009-01-22T18:57:43.127
> 
> 标签：iis-7, web-config

在 IIS7 中，您现在拥有集成模式和经典模式。是否可以使用 web.config 强制站点以集成模式运行，并且无法访问 IIS7。

我问的原因是我最近注册了 Mosso，需要以集成模式而不是经典模式运行我的网站。

我知道我可以打电话给他们，也许让他们改变它......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T19:14:28.087

这是您无法通过应用程序更改的设置`web.config`。

管道模式是应用程序池的一个属性，配置如下：

> `C:\Windows\System32\inetsrv\config\applicationHost.config`

在下面：

> 配置->system.applicationHost->applicationPools

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-09T21:33:46.573

您还需要注意 web.config 中有用于集成模式的新节点。如果您使用 http 标头，则需要将它们从 system.web 移动到 system.webserver。这里有一些很好的文章讨论这个问题： http://www.telerik.com/help/aspnet-ajax/registering_the_httphandlers_on_windows_vista_iis_7_integrated_mode.html和这里：http: [//msdn.microsoft.com/en-us/library/46c5ddfy](http://www.telerik.com/help/aspnet-ajax/registering_the_httphandlers_on_windows_vista_iis_7_integrated_mode.html) [。 aspx](http://msdn.microsoft.com/en-us/library/46c5ddfy.aspx)

# c# - C#：如何获取从 SelectedIndexChanged 中为 ListView 控件单击的实际项目？

> ID：470375
> 
> 赞同：2
> 
> 时间：2009-01-22T18:58:09.070
> 
> 标签：c#, winforms, multithreading

我正在使用具有 listView 的 winForms 应用程序。该 listView 启用了多选，并且列表中有很多很多项目（在行视图中）。

当我选择最后一行（即项目）时，然后按住 shift 单击第 5000 行，SelectedIndexChanged 会触发 5000 次。如果发生这种情况，我最终会陷入一个非常讨厌的循环。单击的最后一行不能保证是“SelectedItems”列表中的最后一项。如何获得点击的实际项目？

编辑：更好的说明：如何获得导致 SelectedIndexChanged 事件的特定迭代的 ListViewItem ？...即使我必须检查所有 5000 个。我需要知道我在看哪一个。EventArgs 没有 index 属性，sender 是 ListView，而不是 ListViewItem。

有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T20:20:26.783

哦，为了皮特的爱……（*感觉比石头还笨*）

我找到了我的答案。请注意，我使用的是 SelectedIndexChanged。我*应该*使用另一个事件：ItemSelectionChange。

使用该事件时，我现在有一些事件可以告诉我选择中哪些项目发生了变化，它告诉我该项目是已选择还是未选择。很美丽。

我希望这可以帮助其他正在解决这个问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T19:05:21.380

这是我能想到的最佳解决方案。处理 ListView 的 OnMouseMove 事件。每当鼠标移动时，记录鼠标的位置。然后，当您获得 SelectedIndexChangedEvent 时，您可以调用 ListView.FindNearestItem(SearchDirectionHint, Point) 并将最后一个鼠标坐标作为 Point 参数传递。这应该为您提供实际单击的项目。

请注意，您不能依赖它实际返回一个项目。完全可以在不使用鼠标的情况下选择一个项目。几个制表符和空格键就可以了。但是对于实际点击，这应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T19:09:11.060

有一个方法`ListView`被调用`HitTest`。通过处理该事件`MouseClick`，您可以确定最后单击的项目是什么。

如果您想弄清楚最后选择的项目是什么，请不要忘记键盘。在列表视图控件中，您可以按住`Ctrl+(arrow key)` 以移动焦点矩形，然后单击`Ctrl+Space`以添加到选择中。如果你想要最后选择的项目，你也必须处理这个。

# php - 处理从 Amazon S3 下载的多个文件？

> ID：470378
> 
> 赞同：0
> 
> 时间：2009-01-22T18:58:54.077
> 
> 标签：php, amazon-s3

我有一个私人存储桶，为客户存储全尺寸图像，所有缩略图和较小尺寸都在网络服务器上。当用户想要下载多个图像时，我想压缩上述图像，然后将它们作为一个文件交付给用户。

目前，我能想到发生这种情况的唯一方法是将文件从 S3 传输到 Web 服务器，压缩，然后向下传输到最终用户。

似乎可以或应该有更好的方法来解决这个问题。有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T19:05:08.167

有一个 EC2 实例来执行此操作。EC2 和 S3 之间的流量是免费的（作为内部流量，速度更快），因此您不会像使用外部服务器那样为双倍的带宽付费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-22T00:13:00.290

显然，有一些 Actionscript 库允许在客户端发生这种情况，例如 Fzip ...您是否已经找到解决方案？

# security - 如何存储被安全过滤器拒绝的 url，以便在用户登录后访问它

> ID：470382
> 
> 赞同：2
> 
> 时间：2009-01-22T18:59:55.027
> 
> 标签：security, struts, containers

我为 Intranet Web 应用程序使用应用程序管理的安全性。

我的 web.xml 文件中有下一个过滤器：

```
<filter>
  <filter-name>employeeAccessFilter</filter-name>
  <filter-class>security.AuthorizationFilter</filter-class>
  <init-param>
      <param-name>roles</param-name>
      <param-value>employee</param-value>
  </init-param>
  <init-param>
      <param-name>onError</param-name>
      <param-value>../index.jsp</param-value>
   </init-param>
</filter>
<filter-mapping>
   <filter-name>employeeAccessFilter</filter-name>
   <url-pattern>/corporate/*</url-pattern>
</filter-mapping> 
```

*index.html*包含一个登录框。当用户登录时，他们会转到 Intranet 的仪表板。过滤器效果很好。

看下一种情况：

*   有人收到一封带有内网页面的电子邮件，例如：[http ://appname.com/corporate/page.do?id=6](http://appname.com/corporate/page.do?id=6)
*   他单击链接，他的默认浏览器存储了一个 cookie，他会自动登录，并且页面可以正常显示。

但：

*   有人收到一封带有 Intranet 页面链接的电子邮件，例如：[http ://appname.com/corporate/page.do?id=6](http://appname.com/corporate/page.do?id=6)
*   他单击该链接，他的默认浏览器没有应用程序 cookie，因此不会自动登录。他被重定向到登录屏幕。他登录但他转到仪表板而不是链接中提到的页面。

有没有简单的方法来解决这个问题？

我基本上有两个想法：

B) - 使用 Basic - 容器管理的安全性，这将解决问题。

A) - 在身份验证过滤器中实现一种机制，将被拒绝的 url 存储为请求属性。- 将被拒绝的 url 作为登录框的隐藏字段。- 更改登录逻辑以使用字段 url 而不是总是仪表板。

他们两个似乎有点工作？有人有更好的主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:08:51.793

大多数需要登录的网站似乎都使用方法 A。例如，在 Stack Overflow 上，如果您访问需要登录的页面，您会被重定向到`/users/login?returnurl=...`，这会导致`returnurl`在登录表单中将字段作为隐藏字段发出。

# user-interface - CRUD 应用程序中网格的替代方案？

> ID：470386
> 
> 赞同：6
> 
> 时间：2009-01-22T19:00:30.157
> 
> 标签：user-interface, crud

因此，您被分配构建一个基本的 CRUD 应用程序。它有一个用于列出所有库存项目的页面......如果您的用户想要编辑其中任何一个，每个项目旁边都有“编辑”按钮。

你知道该怎么做。

我最近的任务是修改其中一个这样的 CRUD 页面，它看起来相当难看。所以我决定它可以使用一些抛光。

但是考虑一下......我想知道在创建显示大量数据的 CRUD 页面时使用网格有什么好的替代方法？

抛开 ajax/速度/安全/实施问题...

> **在大型 CRUD 页面中使用网格有哪些好的替代方法？**

如果这很重要，我愿意用一些可用性换取美学。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T03:22:53.233

对于为大量记录显示相对较少的字段，像网格这样的表格显示没有任何问题，尤其是当任务涉及搜索或比较记录时。*编辑按钮打开单独的窗口或页面进行*编辑有问题。这意味着用户必须学习两个窗口以及如何在它们之间导航，而且这需要更长的时间。

一个很大的可用性改进是就地编辑：而不是只读网格，在网格（或代替网格）中为字段（文本框、复选框、组合框等）提供一组适当的控件）。页面上的单个“保存”按钮可保存对所有记录的所有更改（或者您为相应事件自动发布更改）。

如果您需要为少量记录显示大量字段，则类似表单的布局（可能是选项卡式）是表格布局的替代方案。您可以提供分页控件（例如，看起来像 Recordset 控件的东西）以允许用户在记录之间进行分页。

如果您有大量记录*和*大量字段，则可以通过主从组合将表格与类似表单的布局结合起来。页面顶部的表格显示记录的关键字段，而页面底部的表格显示表格中当前具有焦点的任何记录的“溢出”字段。

另一种选择是以图形方式显示记录。选择两个字段并用 x 和 y 坐标表示每条记录的值，这些坐标用于在页面上定位图标。如果任务涉及搜索模式或相互关联的记录，这很好。具有焦点的记录（图标）的附加字段可以在页面的详细信息部分以类似表单的布局显示。

您可以做的另一件事是在表格或类似表单的布局中以图形方式表示某些字段（例如，使用图标、迷你条形图、阴影或颜色编码等）。这可以帮助用户搜索具有特定值的记录。它还可以在很小的空间中显示大量数据的一般要点（例如，作为迷你图）。

为您的用户、任务和工作环境选择能够最大限度地提高用户性能的布局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T19:08:27.520

单击时打开更多字段进行编辑的列表（而不是网格），或者打开新窗口或表单。这样一来，屏幕就不会从一开始就被数据过载，只要最重要的数据可用，它就非常有用。

一个示例是 Gmail 聊天联系人列表（[此处](http://blogs.zdnet.com/Google/?p=786)为屏幕截图）。

在某些应用程序中，有助于减少显示所需信息的非常好的可用性触摸是一个很好的搜索/过滤框：当您在框中键入时，列表被过滤为匹配的条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-20T09:26:26.207

要显示的数据是表格数据，因此以表格形式显示它们是有意义的，我看不到任何其他可接受的解决方案。

但是，可以组合不同的解决方案以功能方式呈现数据：

*   如果您的主数据表检索并显示来自关系 MySQL 表的一些数据，您可以将它们显示在可折叠的嵌套表中
*   原生浏览器滚动条有点丑，你可以使用一些Javascript插件比如[OverlayScrollbars](https://kingsora.github.io/OverlayScrollbars/#!overview)来改善用户体验
*   一些 MySQL 数据必须第一眼显示，主要的重要信息，而另一些则是次要数据，只有用户想看才能显示的细节。为此，我使用了另一个插件，它将第一列添加到表中，当您单击它时，它会显示一个带有附加辅助数据的可折叠行。
*   最后，如果您希望可以将表格主标题粘贴到顶部，以便用户始终可以看到列标题。

[您可以在MySQL Sakila 数据库演示](https://www.phpcrudgenerator.com/admin/home)中看到所有这些技巧。

# c++ - 我的 C++ 目标文件太大

> ID：470388
> 
> 赞同：7
> 
> 时间：2009-01-22T19:01:04.573
> 
> 标签：c++, compiler-optimization, filesize, object-files

我正在开发一个 C++ 程序，从一个 1200 行文件（它初始化一个相当复杂的状态机）中编译的目标代码接近 1 兆字节。是什么让文件如此之大？有没有办法可以找到目标文件中占用空间的内容？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T19:07:08.397

当目标文件大于它们的最小值时，可能有几个原因：

*   静态包含依赖库
*   使用调试信息构建
*   使用分析信息构建
*   使用模板创建（非常）复杂的数据结构（可能是递归提升结构）
*   编译时不打开优化标志（节省不多，如果使用过度可能会导致困难）

首先，我建议检查您是否正在使用调试信息进行构建，这在我的经验中会导致最臃肿。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T19:06:05.857

（我假设您已启用优化和死代码剥离）。

打开链接器的“生成映射文件”选项并检查输出。

常见的罪魁祸首是产生大量代码的宏/模板和大型全局对象。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-22T19:06:40.177

可能是一些模板实例化（尤其是`std::iostream`s），也可能是广泛的内联（即完全定义在头文件中的类）。但是，首先 1 兆字节的目标文件有什么问题？在链接期间，它很可能会产生一个很小的二进制文件。我在这里有一个项目，其中包含 20 MiB 的目标文件，例如链接到 700 KiB 的二进制文件。

更新：也可能是一些大型静态数组/对象。除此之外，使用 MSVC++ 和 GCC，您可以查看为文件生成的程序集，这可以为您提供一些提示（对于 GCC，它是`g++ -S foo.cpp`，对于 MSVC++，它是['/FAs'](http://msdn.microsoft.com/en-us/library/367y26c6.aspx)）。要么你会看到*很多*模板实例，那么这些就是原因。如果不是，则为对象的对象大小`static`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T09:45:47.673

另一个可能的原因是链接时间代码生成，一个 VC++ 选项。这会将编译器的后端移动到链接器中。这允许更好的优化，但目标文件现在必须包含通常在前端和后端之间传递的所有内部数据结构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-13T14:40:53.750

一个不错的选择是查看[工具中提到的用于分析 ELF 部分和符号大小](https://stackoverflow.com/questions/11720340/tool-to-analyze-size-of-elf-sections-and-symbol)的可能性，例如：

```
nm -C --print-size --size-sort --radix=d tst.o
size -A -d tst.o | sort -k2 -n 
```

我已经看到调试符号在 C++ 中非常大的情况，例如[比二进制文件的其余部分大 30 倍](https://gem5.atlassian.net/browse/GEM5-539)，所以这绝对是要注意的事情之一，`size`由于大量的调试相关部分，上述命令会立即提示您，您可以通过使用`strip`或剥离二进制文件来仔细检查`g++ -s`。

另一件需要注意的事情是您是否可以通过显式模板实例化节省一些空间/时间：[显式模板实例化 - 何时使用？](https://stackoverflow.com/questions/2351148/explicit-template-instantiation-when-is-it-used/59614755#59614755)该答案的“如何快速分析您的构建以查看它是否会从模板实例化中获得很多收益”部分还包含一种在大型（C++）项目中跨对象文件查找重复对象的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-09T12:14:37.053

您可以通过添加编译标志`-flto -Wl,-allow-multiple-definition`，您可以添加`-fuse-linker-plugin`. `-Wa,-mbig-obj`不适用于 x86/32 位架构（仅限 x64）

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-22T19:07:46.993

这是我用来查看编译时间值的宏：

```
template <size_t N> struct compile_time_number { private: typedef int check; };
#define compiler_check_number(N) ((compile_time_number< N >::check)0) 
```

然后在编译时高兴地查看哪些符号占用了空间。

编辑：由于似乎没有人理解这一点，我会澄清一下：使用它的方法是添加`compiler_check_number(sizeof(<insert struct or global variable here>))`. 编译器会将变量或结构的大小作为编译时错误吐出。很少有代码是巨大目标文件的原因。

我一直使用它来查看事情有多大，而无需运行调试器。

# vb.net - 主 UI 窗口未更新控件 - 跨线程操作无效

> ID：470390
> 
> 赞同：1
> 
> 时间：2009-01-22T19:01:35.430
> 
> 标签：vb.net, winforms, multithreading, backgroundworker

好的..这是问题

我有一个主 UI 表单，它有一个控件容器，我可以向它添加一些按钮项，而且我还有一个启动侦听器的 backgroundworker 对象。当侦听器事件触发时，我想在主 UI 表单上的该控件容器中创建一个按钮。在我尝试向该容器添加新的控件项之前，一切似乎都运行良好。我得到以下异常

“跨线程操作无效：控制 'RadMagnifier_AcceptReject' 从创建它的线程以外的线程访问。”

代码像这样流动

```
Private Sub Mainform_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.SessionTableAdapter.Fill(Me.BCSSDataSet1.Session)
    FormatColumns()
    Me.BackgroundWorker2.RunWorkerAsync()
End Sub

Private Sub BackgroundWorker2_DoWork(ByVal sender As Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker2.DoWork
    Notifications()
End Sub

Private Sub Notifications()
    'Start listing for events when event is fired try to add a button to a controls container on the UI thread, and that when i get the problem
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T13:24:48.430

假设您将所有 UI 操作移到 RunWorkerCompleted 方法中，它看起来像一个错误：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=116930](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=116930) [http://thedatafarm.com/devlifeblog/archive/2005/12/21/39532.aspx](http://thedatafarm.com/devlifeblog/archive/2005/12/21/39532.aspx)

我建议使用防弹（伪代码）：

```
if(control.InvokeRequired)
  control.Invoke(Action);
else
  Action() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T13:52:01.617

您不能从 UI 线程以外的其他线程更新 UI 元素。

将按钮添加代码添加到 RunWorkerCompleted 事件，因为它将在 UI 线程上触发。DoWork 事件在线程池线程上运行，而不是在 UI 线程上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-14T21:24:42.463

您可以使用 Control.BeginInvoke，在您的表单上调用它，从后台线程传递一个 deleate 以添加新按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T19:40:45.100

您必须使用[RunWorkerCompleted](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted.aspx)事件，因为它是在 UI 线程上执行的。从 DoWork 事件在窗体上添加控件是错误的，因为此函数在与创建主窗体的线程不同的线程上执行。

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.BackgroundWorker1.RunWorkerAsync()
End Sub

Private Sub BackgroundWorker1_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorker1.DoWork
    Thread.Sleep(1000)
    'Do not modify the UI here!!!
End Sub

Private Sub BackgroundWorker1_RunWorkerCompleted(ByVal sender As System.Object, ByVal e As System.ComponentModel.RunWorkerCompletedEventArgs) Handles BackgroundWorker1.RunWorkerCompleted
    Me.Controls.Add(New Button())
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T20:32:59.893

嗯..当我将通知程序移动到 RunworkerCompleted 事件中时，它给了我同样的错误。我不能直接在 RunworkerCompleted 事件中添加按钮，因为通知过程是在创建新按钮之前等待事件发生。

这是一个更清晰的例子

Private Sub Notifications() 将 NotificationObj 调暗为新 NotificationEngine()

```
 ' register a handler to listen for receive events
    AddHandler Noification.ReceiveCompleted, AddressOf NotificationReceive

    ' start the notification processor
    NotificationObj.Start()

End Sub 
```

然后当我创建一个新按钮并将其添加到主窗体上的控件容器时触发 NotificationReceive 事件。

# asp.net - 网络开发设置

> ID：470391
> 
> 赞同：3
> 
> 时间：2009-01-22T19:02:07.613
> 
> 标签：asp.net, version-control, environment

我正在建立一个完整的网络开发环境。目前，有两名开发人员，一名专注于后端编程（C#、.NET），另一名专注于前端开发（HTML、CSS、XSLT）。

每个人都安装了 MS Visual Studio 2008 并通过 Visual Source Safe 2005 共享源代码。他们既签出文件又在本地开发。

我已经设置了一个测试服务器，它是合并和测试代码最终应该结束的计划，并且该服务器应该始终是“正确”版本。

3 个安装中的每一个都共享相同的数据库。

我认为这个设置应该有点规模，因为我正在为更多的开发人员做准备，但是我们在文件同步和快速更改的轻松访问方面存在很多问题。通常我们需要非常快速地更改一些布局和设计并最终手动将文件复制到测试服务器（我不希望网络服务器上有任何 .NET/C# 代码文件），并且站点失败:-(

我们使用标准的 CMS 来构建我们所有的前端工作，如果它包含在源代码安全中，它确实会减慢速度。

我希望我们所有的前端工作都与我们的后端代码完全分开，这样很容易进行更改。

例如。我们希望对设计进行一些更改并将其快速部署到我们的生产环境中，而无需考虑 .NET 代码。

有什么我遗漏的，或者设置 Web 开发环境的最佳实践是什么？

期待一些帮助/经验:-)

/托马斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T19:16:37.723

您可能应该研究一个功能更强大的版本控制系统。SVN 具有强大的工具支持（包括用于 VS2008 集成的[AnkhSVN](http://ankhsvn.open.collab.net/)和[VisualSVN](http://www.visualsvn.com/)），而 Mercurial、Git 或 Bazaar 等分布式版本控制系统将为您提供更多选择，并以更基本的工具支持为代价。

您可能需要简单的分支，如果您可以轻松地将它们部署到生产环境（即运行“svn up”），那么使用版本控制系统管理相关资源会变得更加容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T20:49:41.153

我无法为您提供有关如何处理 CMS 内容的信息，但我已经设置或使用了几个构建服务器。

在许多项目中使用 Visual Source Safe 并在一些项目中使用 Team Foundation Server，如果可以的话，我会远离它。

我们最近的构建服务器由 Nant 脚本组成，这些脚本从 Subversion 存储库中检查源代码。构建本身由 MSBuild 完成。然后将构建的结果复制到阶段和生产中。

应该有一种简单的方法将数据库更改从开发转移到阶段和生产。我们有一个工具 ( [http://www.codeplex.com/ScriptDB](http://www.codeplex.com/ScriptDB) ) 为开发数据库编写脚本。结果被检入 Subversion。很容易看到 Subversion 日志中发生了什么变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-29T22:05:15.913

> 3 个安装中的每一个都共享相同的数据库。

这似乎是一个糟糕的决定。如果 dev1、dev2 和 test 都使用同一个数据库，那么 dev1 如何在不干扰 dev2 和 test 的情况下尝试更改架构（假设尚未签入使用实验架构的代码）。

此外，数据库成为单点故障，因此如果有人不小心删除/截断了关键表，那么所有工作都会停止。

理想情况下，每个环境都应该有自己的数据库。我想如果您使用的是像 Oracle 这样的非免费数据库，那么您可能无法为每个环境提供自己的服务器，但至少每个环境都应该有自己的架构。

# javascript - 闪光灯有焦点时停止刷新

> ID：470397
> 
> 赞同：0
> 
> 时间：2009-01-22T19:04:18.373
> 
> 标签：javascript, flash, refresh

当 Flash 对象在弹出窗口中具有焦点时，如何阻止浏览器刷新？

是的，我也讨厌弹出窗口。然而，我们有一个 Flash 问卷被使用刷新的用户破坏。

我也已经有 js 可以有效地阻止刷新，直到 flash 获得焦点并且用户按下刷新。

我可以通过我们的 Flash 开发人员访问 Flash，但他不确定如何执行此操作。我们能想到的最接近的方法是使用 fscommand trapallkeys，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T20:12:32.650

不会发生。

您最好的选择是横幅上写着“请勿刷新此页面”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T06:25:33.473

您将永远无法阻止用户刷新，无论是使用键盘还是使用鼠标推动刷新。与其花时间试图阻止它，我建议找到一种方法来***支持***它。

一个好方法是使用本地共享对象，将当前进度保存到用户的 Flash 插件。这些可以将变量本地保存在用户的机器上，而无需使用 javascript 或 cookie。

[这是 Flash 共享对象的文档。](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_16194)

使用这种技术，当用户刷新时，只需重新加载到目前为止存储的变量并显示问卷，就像用户离开时一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T19:15:00.737

您可以尝试捕获 onbeforeunload，但您无能为力。

参见：[onbeforeunload 支持检测](https://stackoverflow.com/questions/158673/onbeforeunload-support-detection)

和：[关闭浏览器窗口时获取重定向警报的 Javascript](https://stackoverflow.com/questions/447885/javascript-to-get-an-alert-to-redirect-when-closing-the-browser-window)

编辑：

刷新是应用程序级别的事件，而不是客户端级别的事件。你运气不好。

# php - PHP 缓存而不弄乱文件权限（另外，如何在 PHP 中模拟 ASP 应用程序变量）

> ID：470399
> 
> 赞同：1
> 
> 时间：2009-01-22T19:04:51.850
> 
> 标签：php, caching, file-permissions, application-variables

我正在尝试在 PHP 脚本中实现某种缓存，该脚本将发送到许多不同的客户端/站点，这些客户端/站点将由相当非技术的用户使用各种 Web 主机进行部署。由于用户的非技术性质，我想避免要求他们调整文件权限。缓存需要跨会话，因此不使用会话变量。如果我在 ASP 中对此进行编码，我会使用应用程序变量，但它们在 PHP 中不存在（据我所知）

有没有人对如何做到这一点有任何建议？

以下是我考虑过的一些可能性，对此的任何评论都会很有用：

*   通过系统临时文件夹中的文件进行缓存 - 我可以使用 sys_get_temp_dir() （或 PHP4 上的一些家庭推出的类似函数）来帮助找到这样的文件夹。这里的缺点是它可能不适用于使用 openbase_dir 限制的主机
*   我看过的一些网站提到欺骗 PHP 使所有用户会话共享相同的会话状态，从而迫使会话变量像会话变量一样工作。当然，我现在找不到那个帖子了……无论如何，这似乎很可怕。（一旦我再次找到它，我会用这个帖子的链接更新这个问题）
*   使用像亚马逊的简单存储服务这样的第三方数据存储——看起来有点矫枉过正
*   在我控制的服务器上缓存数据，并让客户端在每次点击时从那里下载新数据。

再一次，对这些想法或任何新想法的任何评论将不胜感激。

**更新：**我尝试使用 session_id() 来使用共享会话状态，但它不起作用。每个会话都维护自己的“GlobalCache”，有什么想法吗？：

```
// This code doesn't work, but the similar code in my answer does!

function test() {
    if (!$_SESSION['session_count']) $_SESSION['session_count'] = 0;
    $_SESSION['session_count']++;

    $count = get_cache( 'count' );

    print "pre application count: $count<br>";

    if ( !$count )
        $count = 0;

    $count++;

    print "session_id: " . session_id() . "<br>";
    print "post application count: $count<br>";
    print "session_count: " . $_SESSION['session_count'] . "<br>";

    set_cache('count', $count);
}

function set_cache( $name, $value ) {
    $old_session = session_id();
    print "old_session (set): $old_session<br>";

    session_id("GlobalCache");
    print "new_session (set): " . session_id() .  "<br>";

    $_SESSION[$name] = $value;
    session_id( $old_session );
}

function get_cache( $name ) {
    $old_session = session_id();
    print "old_session (get): $old_session<br>";

    session_id("GlobalCache");
    print "new_session (get): " . session_id() .  "<br>";

    $value = $_SESSION[$name];
    session_id( $old_session );
    return $value;
}

session_start();
test(); 
```

**更新：**有些人建议使用 memcached，这实际上对某些人来说是一个很好的解决方案，但由于我无法控制终端服务器环境，所以它不是一个选项。这个想法是有一个脚本，人们可以通过 FTP 上传到一个开箱即用的共享主机帐户。

**更新：**有人建议使用脚本创建我自己的缓存文件夹，但我不需要在已经具有写入权限的文件夹中创建这样的文件夹吗？

**更新，找到解决方案：**我最终找出了我的全局会话脚本中的问题，并为此发布了我自己的答案。感谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T01:58:19.330

好的，我想出了如何通过使用共享/全局会话状态模拟 ASP 样式的应用程序变量来做到这一点。相关更新中我的非工作代码的两个关键更改：

1.  要切换会话状态，我们必须结束当前会话，切换到新会话，然后启动它。我已经将此过程封装在 switch_session() 中

2.  由于我们正在切换会话 ID，因此我们必须使用 ob_start()/ob_end_flush() 缓冲页面的输出，以便不会过早发送会话 cookie。

完整的工作代码如下（也清理了！）。这可以通过在 IE 和 Firefox 窗口中加载页面并重新加载几次以观察计数器上升来轻松测试：

```
<?php
function test() {

    // Do a regular session count
    print "session_id: " . session_id() . "<br>";
    if (!$_SESSION['session_count']) $_SESSION['session_count'] = 0;
    $_SESSION['session_count']++;
    print "session count: " . $_SESSION['session_count'] . "<br>";

    // Do an application count
    $count = get_cache( 'count' );
    if ( !$count ) $count = 0;
    $count++;
    print "application count: $count<br>";
    set_cache('count', $count);
}

function set_cache( $name, $value ) {
    $old_session = switch_session("GlobalCache");
    $_SESSION[$name] = $value;
    switch_session( $old_session );
}

function get_cache( $name ) {
    $old_session = switch_session("GlobalCache");
    $value = $_SESSION[$name];
    switch_session( $old_session );
    return $value;
}

function switch_session( $session_id ) {

    // switch the session and return the original
    $old_id = session_id();

    session_write_close();
    session_id($session_id);
    session_start();
    return $old_id;
}

ob_start();
session_start();
test();
ob_end_flush();
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T19:18:42.867

您可以使用具有固定会话密钥的会话。

[http://de.php.net/manual/en/function.session-id.php](http://de.php.net/manual/en/function.session-id.php)：

> session_id([id]) 用于获取或设置`id`当前会话的会话。如果指定了 id，它将替换当前会话 id。为此，需要在 session_start() 之前调用 session_id()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T19:23:22.017

在应用程序的目录中使用您自己的缓存目录。因此，您不必为各种服务器和/或 PHP 设置而苦恼，并获得最佳的可移植性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T19:10:31.090

我投票赞成“在我控制的服务器上缓存数据，并让客户端在每次点击时从那里下载新数据”。

所有其他路径都会导致某种疯狂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T20:42:11.840

查看 memcached 的 php - 它工作得非常好。

[http://www.php.net/memcache](http://www.php.net/memcache)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-22T13:25:53.473

我使用作者的更新函数作为缓存简单数据库查询结果的一种方式，因为我期待高负载。我还存储了一个时间戳，以便我可以定义页面更新数据库结果的频率，而不仅仅是获取缓存值。

我可以告诉你，这个缓存函数的性能比在每次请求时直接访问数据库要差得多。我实际上杀死了服务器。一旦我切换回简单地查询数据库，服务器就会全速运行，甚至没有注意到相当大的负载。

# php - 我可以加密 PHP 源代码或编译它以便其他人看不到吗？如何？

> ID：470409
> 
> 赞同：5
> 
> 时间：2009-01-22T19:06:56.713
> 
> 标签：php, obfuscation

我需要加密一些我已向公众发布的 PHP 源代码。

这可能吗？PHP可以“编译”吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T19:18:11.387

您可以查看可以从 PHP 生成可执行文件的[phc 。](http://www.phpcompiler.org/)它还有一些其他选项可以从原始 PHP 源代码创建 C 代码、XML、优化的 PHP 等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T19:23:58.690

您可以购买[Zend Guard](http://www.zend.com/en/products/guard/)来编码您的 PHP 源代码，然后使用[Zend Optimizer](http://www.zend.com/en/products/guard/optimizer/)来运行它。还有一个开源/免费的 PHP 编译器项目（[bcompiler](http://it2.php.net/bcompiler)，也可以看看[这个](http://pecl.php.net/package/bcompiler)），但我从未使用过它，因为当时我需要它，该项目仍然不完整。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T20:20:14.927

> 因为它们需要在各种机器上运行，其中一些机器无法安装 Zend Optimizer 和 PHP Express Loader 之类的东西

如果您需要您的代码能够在没有任何模块的情况下在标准版本的 PHP 上运行，那么答案是否定的。没有一种编译方法适用于各种不同的 PHP 安装。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T19:20:08.230

[Nusphere](http://nusphere.com)（PhpED 的制造商）有一个名为[Nu-coder](http://www.nusphere.com/products/nucoder.htm)的产品可以做到这一点。虽然不是免费的，但它会做你想做的事。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-01T14:50:44.650

ioncube 和 zend 的问题——

它们都是可破解的，并且有大约 500.00 美元的应用程序可以让您窃取代码。

他们都需要装载机来运行——你为什么问这是个问题？如果这个项目要出售给公众，那么你肯定会收到大量关于 ioncube 的技术支持问题，我不需要告诉你支持别人的代码/软件是什么感觉。

我发现在这种情况下，没有一个是好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-11T15:30:21.107

我想说也试试 ionCube - 他们是 PHP 编码软件历史最悠久和成功的创建者之一。我们将它们用于我们的 Web 开发项目，虽然需要安装“加载器”有点不利，但它们现在提供了我们捆绑给用户的加载器向导脚本，它为他们提供了逐步说明。

此外，我一直发现他们的支持非常有帮助:)

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-01-22T19:19:05.767

有一些软件可用于加密 PHP 源以保护知识产权。不过，我不知道任何免费的。如果您对支付/共享软件没问题，只需谷歌搜索“php encrypt source”之类的内容。

# flash - 有没有人把 Flash Page Flip 变成可拖动的 Pick Up Paper？

> ID：470419
> 
> 赞同：0
> 
> 时间：2009-01-22T19:08:41.420
> 
> 标签：flash, actionscript, actionscript-2

我正在尝试将 flash 页面翻转（来源：http: [//76design.com/shiftcontrol/index.php/2005/07/03/dynamic-page-flip/](http://76design.com/shiftcontrol/index.php/2005/07/03/dynamic-page-flip/)）变成可以抬起的单个页面，拖了一圈，又坐了下来。一切看起来都非常逼真。

有没有人认为他们可以做到这一点？或者你有没有在任何地方看到过这种修改？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T19:56:33.913

我不确定这是否是您要找的，但是您看过[Flex Book](http://demo.quietlyscheming.com/book/Anatomy.html)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:23:48.750

谢谢你的建议。

我试图创建一个交互式组件，它可以从页面上剥离，移动到新位置，然后放回原处。只有一页 - 所以不需要翻页。

我能够创造出合适的东西。我使用了我的问题中提供的链接。最初，我试图使用同事发现的更难的代码来做到这一点。

这是我要完成的工作的链接。

[http://beeppeep.com/peel/peelndrag.html](http://beeppeep.com/peel/peelndrag.html)

# c# - Symbol MC30xx 条码阅读器设备 - 如何将数据传输到 PC

> ID：470426
> 
> 赞同：0
> 
> 时间：2009-01-22T19:09:51.107
> 
> 标签：c#, compact-framework, usb

我正在为 Symbol MC3000 设备开发应用程序。它运行的是 Windows CE 4.2 Professional。应用程序是简单的数据驱动应用程序，它存储有关商店中产品的信息。

我的客户希望通过串行和 USB 接口与设备通信并读取存储在应用程序中的数据。这就是我被困的地方。

他不想通过控制台向设备发送命令：

回复：获取：数据？- 以 spec.format 接收来自设备的所有数据

回复：获取：越南？- 获取软件版本。

等等。

串行线没什么大不了的。但是您将如何通过 USB 端口实现这一点。（没有活动同步或网络套接字）

（设备可能连接到 linux 或 windows 机器上的 USB，这些终端命令应该可以工作）

你有什么想法如何设计这个问题吗？

各位大神能给我推荐一些文献或资料吗？

非常感谢。

阿莱夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:38:39.723

简单而简短的回答是“你不知道”。

更复杂、更冗长的答案是它可以完成，但所需的工作量可能比价值高得多，应该考虑替代方案（例如，如果您有任何网络接口机制，请使用插座）。

对于 USB 端，您必须了解 USB 的工作原理，至少在一般意义上。当您将该设备插入 PC 时，PC 需要具有了解如何与设备通信的驱动程序。同时，该设备需要有一个了解如何与 PC 对话的驱动程序。这些司机需要了解彼此的工作方式，以便他们能够有效地沟通。

当您使用 ActiveSync 时，会发生什么（使用较旧的 4.2 版本）PC 上的 ActiveSync 有一个串行 USB 驱动程序，因此当您插入设备时，PC 会说“嘿，这看起来像一个串行设备”并且ActiveSync 本身使用该串行层通过串行连接执行 PPP。在设备上，当建立连接时，OEM 放入的驱动程序（具体为usbser.dll）启动并与PC 协商，然后启动ActiveSync 的设备客户端并完成创建该网络。做完了。较新的设备使用类似的机制，但通常使用 RNDIS 而不是 USB 上的串行，因为 PC 附带了 ENDIS 支持，并且它更强大、更快。

现在您要删除 ActiveSync，您必须为两端提供这些驱动程序。阻力最小的路径可能是使用[HID](http://en.wikipedia.org/wiki/USB_human_interface_device_class)。至少PC端是这样完成的（它与鼠标使用的协议相同，因此任何理解USB鼠标的PC，无论是Windows还是Linux，都将拥有此驱动程序）。您仍然需要为设备编写 HID 驱动程序。一旦你有了它，你就可以为每一端编写一个应用程序，以使用该 USB 管道进行通信。

当然，所有这些还需要您将驱动程序部署到设备和可能的 PC 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T13:35:52.293

在设备和 PC 之间建立 USB 串行链路是很困难的。对于 Windows 平台，您可以使用 RAPI 作为解决方法。该设备将通过 ActiveSync 连接到 PC。然后使用 RAPI，您可以（除其他外）读取远程设备的注册表，开始在设备中执行应用程序，在两者之间传输文件。

我想如果您不希望实时传输数据，这将起作用。对于 Linux，我不知道是否有可用的 RAPI SDK。在 Windows 中，您可以使用 OpenNetCF 的 RAPI SDK，这将使您的生活更轻松。

# java - java.util.logging.Logger 不尊重 java.util.logging.Level？

> ID：470430
> 
> 赞同：54
> 
> 时间：2009-01-22T19:12:27.857
> 
> 标签：java, logging

在纯 Java SE 6 环境中：

```
Logger l = Logger.getLogger("nameless");
l.setLevel(Level.ALL);
l.fine("somemessage"); 
```

Eclipse 控制台中没有显示任何内容。*l.info("")*及以上工作正常，但低于正常的任何*工作*似乎都不起作用。有什么问题？TIA。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-01-22T19:30:06.103

即使 Logger 级别设置为 ALL，ConsoleHandler（记录器上的默认 Handler）仍然具有默认级别 INFO。这来自*JAVA_HOME/jre/lib中的默认 logging.properties*

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-11T13:55:21.263

我宁愿只设置控制台处理程序的级别，而不是遍历所有处理程序并设置日志记录级别：

```
//get the top Logger
Logger topLogger = java.util.logging.Logger.getLogger("");

// Handler for console (reuse it if it already exists)
Handler consoleHandler = null;
//see if there is already a console handler
for (Handler handler : topLogger.getHandlers()) {
    if (handler instanceof ConsoleHandler) {
        //found the console handler
        consoleHandler = handler;
        break;
    }
}

if (consoleHandler == null) {
    //there was no console handler found, create a new one
    consoleHandler = new ConsoleHandler();
    topLogger.addHandler(consoleHandler);
}
//set the console handler to fine:
consoleHandler.setLevel(java.util.logging.Level.FINEST); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-10-22T18:52:51.657

我工作场所的一个人发现以下工作：

```
public class Foo {
    private final static Logger logger = Logger.getLogger(Foo.class.getName());
    public static final void main(String[] args) {
        ConsoleHandler ch = new ConsoleHandler();
        ch.setLevel(Level.FINEST);
        Foo.logger.addHandler(ch);
        Foo.logger.setLevel(Level.FINEST);
        Foo.logger.finest("test");
    }
} 
```

如果您只是将根或处理程序设置为最好（唯一），那么它不起作用。当我将两者都设置为时，`FINEST`它可以工作。他的解释是：

> logger 和它的 handlers 都有 Log Levels……过滤的顺序是 Logger 然后 Handlers。这意味着它首先检查日志消息是否通过记录器过滤器，然后将消息发送到各个处理程序进行过滤。

他使用以下示例进一步解释了这一点：

*   `Logger myLogger`有一个级别`FINEST`和一个`ConsoleHandler myHandler`有一个级别的`INFO`

*   `myLogger.fine("foo")`à 消息使其通过记录器的过滤器，但被处理程序的过滤器阻止......没有输出。

*   `myLogger.info("foo")`à 通过两个过滤器并`foo`输出。

现在…

*   `Logger myLogger`有一个级别`INFO`和一个`ConsoleHandler myHandler`有一个级别的`FINEST`

*   `myLogger.fine("foo")`à 消息被记录器的过滤器停止，并且永远不会到达处理程序......没有输出。

*   `myLogger.info("foo")`à 通过两个过滤器并`foo`输出。

现在…

*   `Logger myLogger`有一个级别`FINEST`和一个`ConsoleHandler myHandler`有一个级别的`FINEST`

*   `myLogger.fine("foo")`à 通过两个过滤器并`foo`输出“”。

*   `myLogger.info("foo")`à 通过两个过滤器并`foo`输出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-01T08:11:59.590

您需要在记录器中的处理程序和记录器本身上设置日志级别。日志记录仅在两个级别中的“最粗略”执行。这是一个完成这项工作的日志记录类。

```
import java.io.PrintWriter;
import java.io.StringWriter;
import java.time.Instant;
import java.time.ZoneId;
import java.time.ZonedDateTime;
import java.time.format.DateTimeFormatter;
import java.util.logging.ConsoleHandler;
import java.util.logging.Formatter;
import java.util.logging.Handler;
import java.util.logging.Level;
import java.util.logging.LogRecord;
import java.util.logging.Logger;

public class Log {

    private static final Logger logger = Logger.getGlobal();

    private static Level logLevel = Level.INFO;
    static {
        // Remove all the default handlers (usually just one console handler)
        Logger rootLogger = Logger.getLogger("");
        Handler[] rootHandlers = rootLogger.getHandlers();
        for (Handler handler : rootHandlers) {
            rootLogger.removeHandler(handler);
        }

        // Add our own handler
        ConsoleHandler handler = new ConsoleHandler();
        handler.setLevel(logLevel);
        handler.setFormatter(new LogFormatter());
        logger.addHandler(handler);
        logger.setLevel(logLevel);
    }

    public static class LogFormatter extends Formatter {
        @Override
        public String format(LogRecord record) {
            String stackTrace = "";
            Throwable thrown = record.getThrown();
            if (thrown != null) {
                StringWriter stacktraceWriter = new StringWriter();
                try (PrintWriter writer = new PrintWriter(stacktraceWriter)) {
                    thrown.printStackTrace(writer);
                }
                stackTrace = stacktraceWriter.toString();
            }
            return ZonedDateTime.ofInstant(Instant.ofEpochMilli(record.getMillis()), ZoneId.of("UTC")).format(DateTimeFormatter.ISO_ZONED_DATE_TIME) + "\t" + record.getLevel()
                    + "\t" + record.getMessage() + "\n" + stackTrace;
        }
    }

    private static final String classname = Log.class.getName();

    private static String callerRef() {
        StackTraceElement[] stackTraceElements = Thread.currentThread().getStackTrace();
        if (stackTraceElements.length < 4) {
            return "";
        } else {
            int i = 1;
            for (; i < stackTraceElements.length; i++) {
                if (stackTraceElements[i].getClassName().equals(classname)) {
                    break;
                }
            }
            for (; i < stackTraceElements.length; i++) {
                if (!stackTraceElements[i].getClassName().equals(classname)) {
                    break;
                }
            }
            if (i < stackTraceElements.length) {
                return stackTraceElements[i].toString();
            } else {
                return "[in unknown method]";
            }
        }
    }

    public static void setLogLevel(Level newLogLevel) {
        logLevel = newLogLevel;
        for (Handler handler : logger.getHandlers()) {
            handler.setLevel(newLogLevel);
        }
        Log.logger.setLevel(newLogLevel);
    }

    public static int getLevelNum() {
        return logLevel.intValue();
    }

    public static int getLevelNum(Level level) {
        return level.intValue();
    }

    public static void fine(String msg) {
        logger.log(Level.FINE, msg);
    }

    public static void info(String msg) {
        logger.log(Level.INFO, msg);
    }

    public static void warning(String msg) {
        logger.log(Level.WARNING, msg + "\t " + callerRef());
    }

    public static void error(String msg) {
        logger.log(Level.SEVERE, msg + "\t " + callerRef());
    }

    public static void exception(String msg, Throwable cause) {
        logger.log(Level.SEVERE, msg + "\t " + callerRef(), cause);
    }

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-23T10:54:49.060

其他用户已经给出了很好的答案为什么会发生（ConsoleHandler 有一个单独的级别变量）。我重用我的应用程序记录器的级别并将其复制到父层次结构。还提供了在运行时随时刷新关卡的简便方法。

```
// Set same level all loggers and handlers up to the parent level
// OFF,SEVERE,WARNING,INFO,CONFIG,FINE,FINER,FINEST,ALL
Logger logger = Logger.getLogger(this.getClass().getPackage().getName());
//Level level = Level.parse("FINEST");
Level level = logger.getLevel();
Logger tempLogger = logger;
while(tempLogger != null) {
   tempLogger.setLevel(level);
   for(Handler handler : tempLogger.getHandlers())
      handler.setLevel(level);
   tempLogger = tempLogger.getParent();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-31T18:55:32.897

```
private final static Logger LOGGER = Logger.getLogger(WoTServer.class.getName());
for(Handler h : LOGGER.getParent().getHandlers()){
    if(h instanceof ConsoleHandler){
        h.setLevel(Level.ALL);
    }
} 
```

# ruby-on-rails - 文件从 Flex 上传到 Rails 2 服务器

> ID：470437
> 
> 赞同：0
> 
> 时间：2009-01-22T19:15:15.447
> 
> 标签：ruby-on-rails, apache-flex, session, upload

使用默认的 Cookie 会话存储时，有什么方法可以将文件从 flex 应用程序上传到 rails 2.2 后端？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-02T23:35:47.490

不，它不起作用的原因是 Flex 在使用 FileReference#upload 时不传输 cookie。一种解决方法（对于 Rails 2.3）是为 flash 请求插入一个自定义中间件处理程序，该处理程序接受查询字符串中的参数，并在到达 Rails 之前将它们添加到 HTTP_COOKIE 环境。

```
require 'rack/utils'

class FlashSessionCookieMiddleware
  def initialize(app, session_key = '_session_id')
   @app = app
   @session_key = session_key
  end

  def call(env)
    if env['HTTP_USER_AGENT'] =~ /^(Adobe|Shockwave) Flash/
      params = ::Rack::Utils.parse_query(env['QUERY_STRING'])
      env['HTTP_COOKIE'] = [ @session_key, params[@session_key] ].join('=').freeze unless params[@session_key].nil?
    end
    @app.call(env)
  end
end 
```

确保文件在您的加载路径中并将其添加到您的 session_store.rb：

```
ActionController::Dispatcher.middleware.use FlashSessionCookieMiddleware, ActionController::Base.session_options[:key] 
```

然后您需要将会话密钥输出到某处的视图并使用 Flex 内部的 ExternalInterface 加载它：

```
def upload_path_with_session_information
  session_key = ActionController::Base.session_options[:key]
  uploads_path(session_key => cookies[session_key], request_forgery_protection_token => form_authenticity_token)
end 
```

如您所见，我有一个名为 uploads 的资源，我使用`upload_path_with_session_information`帮助程序给我一个不错的 URL，当从 FLEX 发布到该 URL 时，您可以为其他所有内容保留 cookie 存储。

老实说，我不记得我是在哪里在线找到这些信息的，但我不能把它归功于它。希望它对你有意义。

# c# - 如何仅选择 LINQ 中日期最高的记录

> ID：470440
> 
> 赞同：124
> 
> 时间：2009-01-22T19:16:12.013
> 
> 标签：c#, .net, linq, linq-to-sql

我有一个表“lasttraces”，其中包含以下字段。

```
Id, AccountId, Version, DownloadNo, Date 
```

数据如下所示：

```
28092|15240000|1.0.7.1782|2009040004731|2009-01-20 13:10:22.000
28094|61615000|1.0.7.1782|2009040007696|2009-01-20 13:11:38.000
28095|95317000|1.0.7.1782|2009040007695|2009-01-20 13:10:18.000
28101|15240000|1.0.7.1782|2009040004740|2009-01-20 14:10:22.000
28103|61615000|1.0.7.1782|2009040007690|2009-01-20 14:11:38.000
28104|95317000|1.0.7.1782|2009040007710|2009-01-20 14:10:18.000 
```

我如何才能在[LINQ to SQL](http://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_SQL)中仅获取每个 AccountId 的最后一个跟踪（日期最高的那个）？

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2009-01-22T19:35:59.027

如果您只想要每个帐户的最后日期，您可以使用：

```
var q = from n in table
        group n by n.AccountId into g
        select new {AccountId = g.Key, Date = g.Max(t=>t.Date)}; 
```

如果你想要整个记录：

```
var q = from n in table
        group n by n.AccountId into g
        select g.OrderByDescending(t=>t.Date).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-04-12T13:17:28.737

这是一个简单的方法

```
var lastPlayerControlCommand = this.ObjectContext.PlayerControlCommands
                                .Where(c => c.PlayerID == player.ID)
                                .OrderByDescending(t=>t.CreationTime)
                                .FirstOrDefault(); 
```

也看看这个很棒的 LINQ 地方 - [LINQ to SQL Samples](http://msdn.microsoft.com/en-us/vstudio/bb688085)

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2016-03-24T03:30:41.570

如果你想要整个记录，这里有一个 lambda 方式：

```
var q = _context
             .lasttraces
             .GroupBy(s => s.AccountId)
             .Select(s => s.OrderByDescending(x => x.Date).FirstOrDefault()); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-22T19:38:17.507

它可能是这样的：

```
var qry = from t in db.Lasttraces
          group t by t.AccountId into g
          orderby t.Date
          select new { g.AccountId, Date = g.Max(e => e.Date) }; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-11-21T10:35:07.293

采取一种简单的方法来做到这一点：-

创建了一个类来保存以下信息

*   等级（数）
*   网址（网站的网址）

转到存储在 ArrayList 对象上的站点列表。并执行以下查询以按级别降序对其进行排序。

```
var query = from MyClass object in objCollection 
    orderby object.Level descending 
    select object 
```

将集合按降序排序后，我编写了以下代码来获取作为顶行的对象

```
MyClass topObject = query.FirstRow<MyClass>() 
```

这就像魅力一样。

# c# - .NET：使用路径和参数启动进程

> ID：470459
> 
> 赞同：0
> 
> 时间：2009-01-22T19:22:09.677
> 
> 标签：c#, .net, process

路径是相对于当前目录的。我已经尝试过大量的引用、取消引用、更改到父目录和删除的组合`..`，但是当我尝试启动进程时总是会收到 FileNotFound 错误。

```
bridge_process = System.Diagnostics.Process.Start(
    @"../Tools/RunHidden",
    @"../My-Bridge.bat"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:26:04.163

与其传递一个相对目录，不如传递一个完全限定的路径？您可以使用 System.IO 命名空间中 Path 类的静态方法来帮助您创建路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T19:34:01.650

根据我的经验，“当前目录”在某些情况下可以是 c:\windows\system32。

试试这个：

```
 string fullapppath = Assembly.GetExecutingAssembly().Location;
    string apppath = System.IO.Path.GetDirectoryName(fullapppath);

    string path1 = System.IO.Path.Combine(apppath, @"../Tools/RunHidden");
    string path2 = System.IO.Path.Combine(apppath, @"../My-Bridge.bat");

    bridge_process = System.Diagnostics.Process.Start(path1, path2); 
```

# user-interface - 非常简单、简洁和容易的 GUI 编程“框架”

> ID：470468
> 
> 赞同：60
> 
> 时间：2009-01-22T19:24:29.767
> 
> 标签：user-interface, scripting, open-source, declarative

请列出允许*快速*编写 GUI 应用程序的 GUI 编程库、工具包和框架。我的意思是这样的

*   GUI 完全在一个人类可读（和人类可写）的纯文本文件（代码）中描述
*   代码很简洁（每个小部件/事件对 1 或 2 行代码），适用于脚本
*   从代码中可以看出 GUI 的结构和操作（小部件的嵌套和事件流）
*   隐藏了有关*如何*构建 GUI 的详细信息（诸如 mainloop、附加事件侦听器等）
*   支持自动布局（vbox、hbox 等）

正如答案所暗示的那样，这可能被定义为*声明*式 GUI 编程，但不一定如此。如果可行，任何方法都可以，易于使用且简洁。

有一些像这样的 GUI 库/工具包。它们在下面列出。如果您发现缺少符合条件的工具包，请扩展该列表。指出项目是否跨平台、成熟、活跃，并在可能的情况下举例说明。

请使用此 wiki*仅讨论开源*项目。

这是到目前为止的列表（按字母顺序）：

### 软糖

[Fudgets](http://www.md.chalmers.se/Cs/Research/Functional/Fudgets/Intro/ex2.html)是一个 Haskell 库。平台：Unix。状态：实验性，但仍保持。一个例子：

```
 import Fudgets
  main = fudlogue (shellF "Hello" (labelF "Hello, world!" >+< quitButtonF)) 
```

[![Fudgets 示例屏幕截图](https://i.stack.imgur.com/gZpvz.gif)](https://i.stack.imgur.com/gZpvz.gif)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/02/40/1883597_93x80.gif)）]

### GNUstep 文艺复兴

[Renaissance](http://www.gnustep.it/Renaissance/Screenshots.html)允许用简单的 XML 描述 GUI。平台：OSX/GNUstep。状态：GNUstep 的一部分。下面的一个例子：

```
<window title="Example">
  <vbox>
    <label font="big">
      Click the button below to quit the application
    </label>
    <button title="Quit" action="terminate:"/>
  </vbox>
</window> 
```

[![文艺复兴示例截图](https://i.stack.imgur.com/rTq0B.png)](https://i.stack.imgur.com/rTq0B.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/03/19/1884098_289x80.png)）]

### HTML

基于 HTML 的 GUI (HTML + JS)。跨平台，成熟。可以完全在客户端使用。

寻找一个不错的“helloworld”示例。

[![HTML 图形用户界面示例](https://i.stack.imgur.com/JRURg.png)](https://i.stack.imgur.com/JRURg.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/02/44/1883635_264x60.png)）]

### JavaFX

[JavaFX](http://hackety.org/2007/05/09/soGooeyCanYouSeeTheButton.html)可用于独立（桌面）应用程序以及 Web 应用程序。不完全跨平台，还没有完全开源。状态：1.0 版本。一个例子：

```
 Frame {
    content: Button {
      text: "Press Me"
      action: operation() {
         System.out.println("You pressed me");
      }
    }
    visible: true
  } 
```

*需要截图。*

### 福伊

[Phooey](http://www.haskell.org/haskellwiki/Phooey#One_example.2C_two_interfaces)是另一个 Haskell 库。跨平台（wxWidgets），HTML+JS 后端计划。成熟而活跃。一个例子（比 helloworld 多一点）：

```
 ui1 :: UI ()
  ui1 = title "Shopping List" $
        do a <- title "apples"  $ islider (0,10) 3
           b <- title "bananas" $ islider (0,10) 7
           title "total" $ showDisplay (liftA2 (+) a b) 
```

[![Phooey 示例屏幕截图](https://i.stack.imgur.com/Xb2sr.png)](https://i.stack.imgur.com/Xb2sr.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/02/33/1883543_236x187.png)）]

### 蟒蛇卡

[PythonCard](http://pythoncard.sourceforge.net/index.html)在 Python 字典中描述 GUI。跨平台（wxWidgets）。一些应用程序使用它，但该项目似乎停滞不前。有一个活跃的分叉。

*我跳过[PythonCard 示例](http://www.halfcooked.com/presentations/osdc/pythoncard.html)，因为它对于比赛来说太冗长了。*

[![PythonCard 示例截图](https://i.stack.imgur.com/M4lro.gif)](https://i.stack.imgur.com/M4lro.gif)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/02/46/1883646_199x99.gif)）]

### 鞋

[鲁比鞋](http://shoooes.net/tutorial/)。平台：Win/OSX/GTK+。状态：年轻但活跃。一个最小的应用程序如下所示：

```
 Shoes.app {
     @push = button "Push me"
     @note = para "Nothing pushed so far"
     @push.click {
        @note.replace "Aha! Click!"
     }
  } 
```

[![鞋子示例截图](https://i.stack.imgur.com/Xip3H.png)](https://i.stack.imgur.com/Xip3H.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/03/14/1884011_227x71.png)）]

### Tcl/Tk

[Tcl/Tk](http://wiki.tcl.tk/488)。跨平台（它自己的小部件集）。成熟（甚至可能过时）和活跃。一个例子：

```
 #!/usr/bin/env wish
  button .hello -text "Hello, World!" -command { exit }
  pack .hello
  tkwait window . 
```

[![Tcl/Tk 示例截图](https://i.stack.imgur.com/IWNGJ.png)](https://i.stack.imgur.com/IWNGJ.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/02/51/1883672_111x58.png)）]

### 泰克UI

[Lua（和 C）的tekUI](http://tekui.neoscientists.org/)。平台：X11、DirectFB。状态：Alpha（可用，但 API 仍在发展）。一个例子：

```
 #/usr/bin/env lua
  ui = require "tek.ui"
  ui.Application:new {
    Children = {
      ui.Window:new  {
        Title = "Hello",
        Children = {
          ui.Text:new {
            Text = "_Hello, World!", Style = "button", Mode = "button",
          },
        },
      },
    },
  }:run() 
```

[![tekUI helloworld 截图](https://i.stack.imgur.com/tzI7A.png)](https://i.stack.imgur.com/tzI7A.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/03/01/1883821_290x55.png)）]

### 树松

[Python 的Treethon](http://code.google.com/p/treethon/)。它在 YAML 文件中描述 GUI（*YAML 树中的 Python*）。平台：GTK+。状态：进行中。一个简单的应用程序如下所示：

```
 _import: gtk
  view: gtk.Window()
  add:
      - view: gtk.Button('Hello World')
        on clicked: print view.get_label() 
```

[Treethon helloworld 截图 http://treethon.googlecode.com/svn/trunk/treethon_gtk_tutorial/base.png](http://treethon.googlecode.com/svn/trunk/treethon_gtk_tutorial/base.png)

### Richard Jones 未命名的 Python 库：

这个还没有发布。这个想法是使用 Python 上下文管理器（`with`关键字）来构建 GUI 代码。有关详细信息，请参阅[Richard Jones 的博客](http://www.mechanicalcat.net/richard/log/Python/Something_I_m_working_on.3)。

```
with gui.vertical:
    text = gui.label('hello!')
    items = gui.selection(['one', 'two', 'three'])
    with gui.button('click me!'):
        def on_click():
            text.value = items.value
            text.foreground = red 
```

### 许尔

[XUL](https://developer.mozilla.org/en/Getting_started_with_XULRunner) + Javascript 可用于创建带有 XULRunner 以及 Mozilla 扩展的独立桌面应用程序。成熟、开源、跨平台。

```
 <?xml version="1.0"?>
  <?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
  <window id="main" title="My App" width="300" height="300"
  xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
    <caption label="Hello World"/>
  </window> 
```

[![XUL helloworld 示例](https://i.stack.imgur.com/UOy86.png)](https://i.stack.imgur.com/UOy86.png)
[（来源：[picamatic.com](http://www.picamatic.com/show/2009/01/28/03/27/1884209_228x108.png)）]

* * *

感谢您的贡献！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-22T20:34:32.980

不是小子，而是 HTML。

它是跨平台的，并在一个简单的文本文件中总结了 gui 布局。它绝对是成熟的，并且易于理解且有据可查。

有很多方法可以为动态内容模板化 HTML 文件，如果您不喜欢尖括号，还有其他方法可以将自定义语法转换为 HTML。

使用 Javascript 的客户端脚本，使用 PHP/Ruby/Python/Perl 的服务器端脚本。

它并不适合所有目的，但对许多人来说，它已经足够好了。也没有理由必须提供它 - 如果需要，您可以将 HTML 文件分发给您的客户 - 请参阅[TiddlyWiki](http://www.tiddlywiki.com/)以了解可以去哪里的一个很好的例子。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T21:10:37.370

您所描述的是，除了鞋子之外，声明式编程的新概念。我将鞋子更多地描述为一种 GUI[领域特定语言](http://en.wikipedia.org/wiki/Domain-specific_language)。好吧，我说的是新奇的：Visual Basic 表单，如果你从 IDE 设计器后面看的话，它是声明性的。所以，再往前看，是 Oracle 的 SQL*Forms，尽管用文本编辑器组装它们是一个只有最勇敢的人才能进行的过程。

为了将另一个添加到列表中，Microsoft 拥有[XAML](http://msdn.microsoft.com/en-us/library/ms752059.aspx)，其中描述了为[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)构建的 GUI 。

虽然提到的一些方案相当简单，但声明式定义的 GUI 可以像代码中定义的任何东西一样复杂，但它们更简单、更简洁：它们说出你想要发生的“什么”并将其留给底层框架来处理“如何”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T21:21:56.223

[TCL/TK](http://www.tcl.tk/)是一种用于交互式构建 GUI 的脚本语言。它适用于各种平台，包括 Unix、Windows 和 Mac OS X。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-08T17:30:03.503

睡衣 -[http://pyjs.org](http://pyjs.org) - 这是一个桌面小部件集，伪装成基于 AJAX 的 web 2.0 小部件集。它非常不像网络小部件集，我实际上将它移植*到*桌面 -[http://pyjd.org](http://pyjd.org) - 使用 webkit（adobe AIR、google chrome、safari 等中的相同引擎）

这是“你好世界”：

```
从 pyjamas.ui.RootPanel 导入 RootPanel
从 pyjamas.ui.Button 导入按钮
从睡衣导入窗口

def 问候（弗雷德）：
    Window.alert("你好，AJAX！")

如果 __name__ == '__main__'：
    b = Button("点击我", 问候)
    RootPanel().add(b)

```

这立即回答了五个要求中的前四个。要求 5 通过以下方式满足：

```
从 pyjamas.ui.RootPanel 导入 RootPanel
从 pyjamas.ui.Horizo​​ntalPanel 导入 Horizo​​ntalPanel
从 pyjamas.ui.HTML 导入 HTML

p = 水平面板（）
p.add(HTML("<b>你好</b>"))
p.add(HTML("世界"))
RootPanel().add(p)

```

它再简单不过了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T17:14:14.183

[wxLua](http://wxlua.sourceforge.net/)是 Lua 的 wxWidgets 库的包装器。它使用 Connect 方法将 gui 小部件事件附加到函数（函数是 JS 中的第一类）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T20:56:33.777

[XUL](http://www.mozilla.org/projects/xul/)（它非常易于使用，而且功能强大——大部分 Firefox 使用 XUL 实现 GUI 结构，+ javascript 用于逻辑处理）

[XUL 教程](https://developer.mozilla.org/En/XUL_Tutorial)有一些很好的例子。这是[tabboxes](https://developer.mozilla.org/en/XUL_Tutorial/Tabboxes)的一个。页面底部有可切换的选项卡、按钮、编辑框和组框，而且相当简单（没有 Javascript/CSS/XBL/键绑定/等）。[然后，他们稍后会逐渐](https://developer.mozilla.org/en/XUL_Tutorial/More_Menu_Features) 添加[更多](https://developer.mozilla.org/en/XUL_Tutorial/Popup_Menus) [内容](https://developer.mozilla.org/en/XUL_Tutorial/Trees)，这对于指定它的文件的长度来说是很多功能。（至少在你开始添加 javascript 来处理有问题的逻辑之前）如果我不得不在 Win32 中做这样的事情，那将是一个真正的痛苦。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-17T14:42:45.370

[GTK-server](http://www.gtk-server.org)使用起来非常简单，可以使用 30 多种语言，包括 Bash 和 Visual Basic。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-06-08T13:37:44.147

[SDL/Swing](http://www.ikayzo.org/confluence/display/SSW/Home)非常简洁、易读、不显眼（283k 库，没有依赖关系）并且易于使用。例子：

```
menus {
    "File" {
        "Open" do="open" // calls "open()" in the controller
        "---"
        "Exit" do="exit"
    }
} 
```

它是开源的，但享有来自 Ikayzo.com 的商业支持。.NET 和 iOS 的端口正在进行中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-05-26T04:25:24.257

我今天遇到了[SDL/Swing](http://ikayzo.org/confluence/display/SSW/Home;jsessionid=673750C9685362ACA8E5EFA8015650C3)。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-26T19:27:50.590

如果你在 .NET 平台上，你应该看看 XAML

# c# - 如何使用 asp.net mvc 基于单选按钮切换列表？

> ID：470495
> 
> 赞同：0
> 
> 时间：2009-01-22T19:31:11.220
> 
> 标签：c#, asp.net-mvc

假设我有一张门票清单。当用户第一次进入工单/索引页面时，我想显示所有打开的工单并检查名称为 ticketStatus 和值为 Open 的单选按钮。

如果用户选中 Closed 单选按钮，其值为 Closed 和 ticketStatus 名称，我想提交并获取已关闭票证列表返回到我的票证/索引页面并检查已关闭单选按钮。

任何关于从哪里开始的建议将不胜感激？我可以使用 javascript 提交，这样我就不需要表格还是应该只制作一个表格？

在视图中：

```
<%= Html.RadioButton("ticketStatus", "Open", true) %>&nbsp;Open&nbsp;&nbsp;  
<%= Html.RadioButton("ticketStatus", "Closed", false) %>&nbsp;Closed (Last 60 Days) 
```

在控制器中：

```
public ActionResult Index()  
{  
    ViewData["Title"] = "Ticket List";  
    IServiceCallService scService = new ServiceCallService();  
    IList<ServiceCall> serviceCalls = scService.GetOpenServiceCalls("");  
    return View(serviceCalls);  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T20:03:52.043

我将按照我的理解进行回复：

> 假设我有一张门票清单。当用户第一次进入工单/索引页面时，我想显示所有打开的工单并检查名称为 ticketStatus 和值为 Open 的单选按钮。

```
<div class="statusfilter">
<%foreach(TicketStatus status in view.PickableTicketStatus){%>
<input 
   type="radio" 
   name="ticketStatusFilter"
   value="<%=status%>"
   <%= viewlogic.IsSelectedStatusFilter(status) ? "selected='selected'" : "" %>
/>
<%}>
</div>
<ul class="tickets">
<%foreach(var t in view.Tickets){%>
  <li>
    <input type="hidden" name="ticketsToChange" value="<%=t.Key%>" /> 
    <%=t.Title.AsHtmlEncoded()%>
  </li>
<%}%>
</ul> 
```

> 如果用户选中 Closed 单选按钮，其值为 Closed 和 ticketStatus 名称，我想提交并获取已关闭票证列表返回到我的票证/索引页面并检查已关闭单选按钮。

1：您需要处理所有输入 type="radio" 上的更改事件

```
<!-- with jquery -->
$(document).ready(function(){
  // register anonymous event handler to status radio change
  $('div.statusfilter input[type='radio']")
    .change(function(){
      // see 2:
    });
}); 
```

2：您需要将选择状态发布到服务器并获得一些响应，两种解决方案：

*   ajax 请求并得到响应
*   普通的http刷新

一些建议：

如果它是您的主要形式：对 UI 的其他部分（搜索框、导航...）使用并使用 ajax

想想你为什么要发布数据（ajax 或普通），如果只需要显示票证并通过一些控制切换更喜欢这些解决方案之一：

*   使用纯 href 并获取 url 参数
*   使用票证列表的部分刷新

用很少的状态项来获得更好的设计，使用选项卡或方便的 UI

如果您需要更多详细信息，请随时提出任何具体问题。

希望这可以帮助

编辑：

*   只是提到这个问题不属于asp.net mvc，这是一个一般的html/http/form场景
*   也不要将ajax强加给您的客户端，导航的最高部分应在初级级别使用get/post处理，然后添加非侵入式ajax进行导航

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:05:27.923

所以我做了一点改变来让它工作。不确定这是否是最优雅的解决方案。

```
<script type="text/javascript">
    $(document).ready(function() {
        $("input[name='ticketStatus']").bind("click", radioClicks)
    });

    function radioClicks() {
        window.location = "/Tickets/" + $(this).val();
    }
</script> 
```

谢谢。

# php - 用于在 PHP 中解析 CSV 的正则表达式

> ID：470505
> 
> 赞同：7
> 
> 时间：2009-01-22T19:34:33.037
> 
> 标签：php, regex, csv

我已经设法使用此正则表达式拆分 CSV 文件： "/,(?=(?:[^\"] *\"[^\"]* \") *(?![^\"]* \"))/"

但我最终得到了一个包含开始和结束双引号的字符串数组。现在我需要一个正则表达式来去除分隔符双引号的那些字符串。

据我所知，CSV格式可以将字符串封装在双引号中，所有已经是字符串一部分的双引号都会加倍。例如：

我的“另一只”猫

变成

“我的”“其他”“猫”

我基本上需要的是一个正则表达式，它将用 (N/2 - 四舍五入) 双引号序列替换所有 N 双引号序列。

或者，还有更好的方法 ？提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-22T19:42:36.780

有读取csv文件的功能：[fgetcsv](http://www.php.net/fgetcsv)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T19:42:58.293

当有 fgetcsv 函数为您完成所有艰苦的工作时，您为什么还要费心用正则表达式拆分文件？

您可以传入分隔符和定界符，它会检测到要做什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T22:53:05.117

我同意其他人说你应该使用 fgetcsv 函数而不是正则表达式的观点。正则表达式可能在格式良好的 CSV 数据上工作正常，但如果 CSV 格式错误或损坏，正则表达式将静默失败，可能会在此过程中返回虚假结果。

然而，问题是关于在初始拆分后去除不需要的引号。一个提议的解决方案（到目前为止）太天真了，它只处理字段内的转义引号，而不是实际的分隔符。（我知道 OP 没有询问这些，但它们确实需要被删除，所以为什么不和其他人一样做呢？）这是我的解决方案：

```
$csv_field = preg_replace('/"(.|$)/', '\1', $csv_field); 
```

此正则表达式匹配后跟任何字符或字符串末尾的引号，并将匹配的字符替换为第二个字符，或者如果`$`匹配的是空字符串，则替换为空字符串。根据规范，CSV 字段可以包含行分隔符；这似乎不会发生太多，但如果需要，您可以将 's' 修饰符添加到正则表达式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-20T19:47:10.643

对于那些不想使用正则表达式而不是 fgetcsv 的人。这是一个完整的示例，如何使用正则表达式从 csv 创建一个 html 表。

```
 $data = file_get_contents('test.csv');
    $pieces = explode("\n", $data);

    $html .= "<table border='1'>\n";
    foreach (array_filter($pieces) as $line) {

            $html .= "<tr>\n";
            $keywords = preg_split('/,(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/', $line,-1,PREG_SPLIT_DELIM_CAPTURE);

            foreach ($keywords as $col) {
                    $html .= "<td>".trim($col, '"')."</td>\n";
            }
            $html .= "</tr>\n";
    }
    $html .= "</table>\n"; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-15T14:52:35.260

```
preg_split('/,(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))/', $line,-1,PREG_SPLIT_DELIM_CAPTURE); 
```

像“Toys”R“Us”这样的字符串内部有“问题”

所以你应该改用：

```
preg_split('/'.$seperator.'(?=(?:[^\"])*(?![^\"]))/', $line,-1, PREG_SPLIT_DELIM_CAPTURE); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T19:41:26.520

这是我的快速尝试，尽管它只适用于单词边界。

```
preg_replace('/([\W]){2}\b/', '\1', $csv) 
```

# diff - diff 中的选项以显示包含某个单词的行的差异

> ID：470508
> 
> 赞同：1
> 
> 时间：2009-01-22T19:34:58.497
> 
> 标签：diff

有没有办法使用**diff**仅在包含特定单词的行中显示差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T19:42:01.697

您可以指定选项“-I *regexp* ”以忽略与指定正则表达式匹配的行。如果您反转正则表达式，您可以忽略所有不包含您要查找的单词的行。

有关更多信息，请参阅[diff 手册页](http://linux.die.net/man/1/diff)或[此处](http://docs.freebsd.org/info/diff/diff.info.Specified_Folding.html)获取特定示例。

# javascript - IE点击声音和jQuery

> ID：470512
> 
> 赞同：2
> 
> 时间：2009-01-22T19:37:15.310
> 
> 标签：javascript, jquery, internet-explorer

使用 jQuery，有没有办法在你发布时禁用 IE 中的点击声音？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T19:38:24.917

IE 点击声音是您无法通过 JavaScript 控制的浏览器功能。禁用它的唯一方法是在控制面板中的系统声音中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T19:48:51.730

使用此解决方案很可能：[http ://www.julienlecomte.net/blog/2007/11/30/](http://www.julienlecomte.net/blog/2007/11/30/)

但简而言之，John 是正确的，它是一种不受 javascrípt 控制的浏览器声音，或者除了注册表更改之外的任何其他东西，这是一个网站无法做到的。

我知道上面的“技巧”之前已经奏效了，所以如果没有任何改变，它仍然可以奏效。

# cross-platform - 什么是好的跨平台游戏 API？

> ID：470520
> 
> 赞同：7
> 
> 时间：2009-01-22T19:41:00.873
> 
> 标签：cross-platform

我正在用 C++ 设计/构建跨平台游戏引擎。我想使用一个具有 2D/3D 图形、输入、网络、音频等的游戏 API。我发现除了音频之外满足其中许多要求的一个 API 是[Amaltheia](http://home.gna.org/amaltheia/)。任何人都可以建议一个满足我所有要求的 API 或满足大多数要求的 API，它比[Amaltheia](http://home.gna.org/amaltheia/)更好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-22T19:56:00.717

你可以看看[SDL](http://www.libsdl.org/)，它是一个流行的跨平台多媒体库，用于许多游戏。

[Game Programming Wiki](http://web.archive.org/web/20090301052144/http://gpwiki.org/)也是游戏编程[库](http://web.archive.org/web/20090301053452/http://gpwiki.org/index.php/Libraries)和[引擎](http://web.archive.org/web/20090301042508/http://gpwiki.org/index.php/Game_Engines)列表的良好来源

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-04T10:19:30.220

现在很多人都在使用[SFML](http://www.sfml-dev.org/)~~，它比 SDL 更新一点。~~

（答案编辑为 SDL 终于看到了更新，因为我最初发布了这个！然而，SFML 仍然是一个值得选择的选择。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-22T20:04:06.833

[快板](http://alleg.sourceforge.net/)很受欢迎。这里还有一个大型社区网站[。](http://www.allegro.cc/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-02T21:31:54.187

如果你厌倦了 C++，还有一些更简单的东西：BlitzBasic

[http://www.blitzbasic.com/](http://www.blitzbasic.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T23:28:18.037

如果您的创作是在 OSX 中完成的，请查看[Unity Engine](http://unity3d.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T19:53:07.167

[Ideaworks 3D](http://www4.ideaworks3d.com/)有一个很棒的 AP​​I，它可以在比你能用的更多的系统上工作（包括 windows 和 linux），包括网络、声音和 3d。虽然有点贵...

# ssl - SSL 究竟是如何工作的？

> ID：470523
> 
> 赞同：157
> 
> 时间：2009-01-22T19:41:54.270
> 
> 标签：ssl, ssl-certificate

SSL 是如何工作的？

客户端（或浏览器？）和服务器（或 Web 服务器？）上安装的证书在哪里？

当您将 URL 输入浏览器并从服务器获取页面时，信任/加密/身份验证过程如何开始？

HTTPS协议如何识别证书？当证书完成所有信任/加密/身份验证工作时，为什么 HTTP 不能使用证书？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2011-09-11T22:26:58.123

> 注意：我很仓促地写了我的原始答案，但是从那以后，这已经变成了一个相当流行的问题/答案，所以我对其进行了扩展并使其更加精确。

# TLS 功能

“SSL”是最常用于指代该协议的名称，但 SSL 特指 Netscape 在 90 年代中期设计的专有协议。“TLS”是基于 SSL 的 IETF 标准，所以我将在我的回答中使用 TLS。这些天来，您在网络上的几乎所有安全连接实际上都在使用 TLS，而不是 SSL。

TLS 具有多种功能：

1.  加密您的应用层数据。（在您的情况下，应用层协议是 HTTP。）
2.  向客户端验证服务器。
3.  向服务器验证客户端。

#1 和#2 很常见。#3 不太常见。您似乎专注于＃2，所以我将解释那部分。

# 验证

服务器使用证书向客户端验证自己。证书是一团数据[1]，其中包含有关网站的信息：

*   域名
*   公钥
*   拥有它的公司
*   什么时候发出
*   到期时
*   谁发的
*   等等。

您可以通过使用证书中包含的公钥加密只能由相应私钥解密的消息来实现机密性（上面的＃1），该私钥应该安全地存储在该服务器上。 [2] 让我们将此密钥对称为 KP1，以便我们以后不会混淆。您还可以验证证书上的域名是否与您正在访问的站点匹配（上面的#2）。

但是，如果攻击者可以修改发送到服务器和从服务器发送的数据包，并且如果攻击者修改了您提供的证书并插入了他们自己的公钥或更改了任何其他重要细节，该怎么办？如果发生这种情况，攻击者可以拦截和修改您认为已安全加密的任何消息。

为了防止这种攻击，证书由其他人的私钥以加密方式签名，使得任何拥有相应公钥的人都可以验证签名。让我们将此密钥对称为 KP2，以明确这些密钥与服务器使用的密钥不同。

# 证书颁发机构

那么谁创造了KP2？谁签署了证书？

稍微简化一下，*证书颁发机构*创建了 KP2，并且他们出售使用他们的私钥为其他组织签署证书的服务。例如，我创建了一个证书，然后我向 Verisign 这样的公司付费，让他们使用他们的私钥对其进行签名。 [3] 由于除了 Verisign 之外没有人可以访问此私钥，因此我们任何人都无法伪造此签名。

为了验证签名，我个人如何获得 KP2 中的公钥？

好吧，我们已经看到证书可以保存公钥——计算机科学家喜欢递归——那么为什么不将 KP2 公钥放入证书并以这种方式分发呢？起初这听起来有点疯狂，但实际上这正是它的工作原理。继续以威瑞信为例，威瑞信生成一个证书，其中包含有关他们是谁、允许他们签署什么类型的东西（其他证书）以及他们的公钥的信息。

现在，如果我有该 Verisign 证书的副本，我可以使用它来验证我要访问的网站的服务器证书上的签名。容易，对吧？！

嗯，没那么快。我不得不从*某个地方*获得威瑞信证书。如果有人欺骗了 Verisign 证书并将他们自己的公钥放在那里怎么办？然后他们可以在服务器证书上伪造签名，我们又回到了我们开始的地方：中间人攻击。

# 证书链

继续递归思考，我们当然可以引入第三个证书和第三个密钥对 (KP3) 并使用它来签署 Verisign 证书。我们称之为证书链：链中的每个证书都用于验证下一个证书。希望您已经可以看到这种递归方法一直只是海龟/证书。它停在哪里？

由于我们不能创建无限数量的证书，证书链显然必须在*某个地方*停止，这是通过在链中包含一个*自签名*的证书来完成的。

> 我会暂停片刻，等你捡起脑袋里爆炸的脑物质碎片。*自签？！*

是的，在证书链（又名“根”）的末尾，会有一个证书使用它自己的密钥对来签名。这消除了无限递归问题，但不能解决身份验证问题。任何人都可以创建一个自签名的证书，上面写着什么，就像我可以创建一个假的普林斯顿文凭，上面写着我主修政治、理论物理和应用屁股踢，然后​​在底部签上我自己的名字。

这个问题的[有点令人兴奋的]解决方案只是选择一组您明确信任的自签名证书。例如，我可能会说“我*信任*这个威瑞信自签名证书”。

有了明确的信任，现在我可以验证整个证书链。无论链中有多少证书，我都可以验证每个签名一直到根。当我到达根目录时，我可以检查该根证书是否是我明确信任的。如果是这样，那么我可以信任整个链条。

# 授予信任

TLS 中的身份验证使用*授予信任*的系统。如果我想聘请汽车修理工，我可能不相信我找到的任何随机修理工。但也许我的朋友担保了一个特定的机械师。既然我信任我的朋友，那我就可以信任那个机械师。

当您购买计算机或下载浏览器时，它会附带数百个它明确信任的根证书。 [4] 拥有和运营这些证书的公司可以通过签署他们的证书将这种信任授予其他组织。

这远非一个完美的系统。有时，CA 可能会错误地颁发证书。在这些情况下，可能需要吊销证书。撤销很棘手，因为颁发的证书在密码学上总是正确的；需要一个带外协议来找出哪些以前有效的证书已被吊销。在实践中，其中一些协议不是很安全，而且许多浏览器也不会检查它们。

有时整个 CA 都会受到威胁。例如，如果您要闯入 Verisign 并窃取他们的根签名密钥，那么您可以欺骗世界上的*任何*证书。请注意，这不仅会影响 Verisign 客户：即使我的证书是由 Thawte（Verisign 的竞争对手）签署的，也没关系。我的证书仍然可以使用威瑞信泄露的签名密钥进行伪造。

这不仅仅是理论上的。它发生在野外。[DigiNotar 因被黑客入侵](http://en.wikipedia.org/wiki/DigiNotar)而闻名，随后破产。[Comodo 也被黑](http://www.infoworld.com/d/security/the-real-security-issue-behind-the-comodo-hack-811)了，但莫名其妙地他们至今仍在营业。

即使 CA 没有直接受到威胁，该系统中也存在其他威胁。例如，政府使用法律强制手段强制 CA 签署伪造的证书。您的雇主可以在您的员工计算机上安装他们自己的 CA 证书。在这些不同的情况下，您期望“安全”的流量实际上对于控制该证书的组织是完全可见/可修改的。

有人提出了一些替代方案，包括[Convergence](http://en.wikipedia.org/wiki/Convergence_(SSL))、[TACK](http://tack.io/draft.html)和[DANE](http://en.wikipedia.org/wiki/DNS-based_Authentication_of_Named_Entities)。

# 尾注

[1] TLS 证书数据按照[X.509 标准](http://en.wikipedia.org/wiki/X.509)进行格式化。X.509 基于[ASN.1](http://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One)（“Abstract Syntax Notation #1”），这意味着它*不是*二进制数据格式。因此，X.509 必须*编码*为二进制格式。[DER 和 PEM](https://polarssl.org/kb/cryptography/asn1-key-structures-in-der-and-pem)是我所知道的两种最常见的编码。

[2] 在实践中，协议实际上切换到对称密码，但这是与您的问题无关的细节。

[3] 据推测，CA 在签署您的证书之前实际上会验证您的身份。如果他们不这样做，那么我可以为 google.com 创建一个证书并要求 CA 对其进行签名。有了该证书，我就可以在中间人任何“安全”连接到 google.com。因此，验证步骤是 CA 运行中非常重要的因素。不幸的是，这个验证过程在全球数百个 CA 中的严格程度还不是很清楚。

[4] 请参阅 Mozilla 的[受信任 CA 列表](https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/included/)。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2014-08-05T03:41:49.863

HTTPS 是**HTTP**和**SSL（安全套接字层）**的组合，用于在客户端（浏览器）和 Web 服务器（应用程序托管在这里）之间提供加密通信。

**为什么需要它？**

HTTPS 对通过网络从浏览器传输到服务器的数据进行加密。因此，没有人可以在传输过程中嗅探数据。

浏览器和 Web 服务器之间如何建立 HTTPS 连接？

1.  浏览器尝试连接到[https://payment.com](https://payment.com)。
2.  payment.com 服务器向浏览器发送证书。该证书包括payment.com 服务器的公钥，以及该公钥实际上属于payment.com 的一些证据。
3.  浏览器验证证书以确认它具有正确的 payment.com 公钥。
4.  浏览器随机选择一个新的对称密钥 K 用于连接到 payment.com 服务器。它在 payment.com 公钥下加密 K。
5.  payment.com 使用其私钥解密 K。现在浏览器和支付服务器都知道 K，但没有其他人知道。
6.  任何时候浏览器想向payment.com发送一些东西，它都会在K下加密；payment.com 服务器在收到后对其进行解密。每当 payment.com 服务器想要向您的浏览器发送内容时，它都会在 K 下对其进行加密。

这个流程可以用下图表示： ![在此处输入图像描述](https://i.stack.imgur.com/WRNrD.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-01-11T10:28:38.497

我写了一篇简短的博客文章，简要讨论了这个过程。请随意看看。

[SSL 握手](http://www.devcodenote.com/2016/01/ssl-handshake.html)

来自相同的一个小片段如下：

“客户端通过 HTTPS 向服务器发出请求。服务器发送其 SSL 证书 + 公钥的副本。在使用其本地受信任的 CA 存储验证服务器的身份后，客户端生成一个秘密会话密钥，使用服务器的公共密钥对其进行加密密钥并发送它。服务器使用其私钥解密秘密会话密钥并向客户端发送确认。已建立安全通道。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-06-23T12:45:30.827

Mehaase 已经详细解释过了。我将把我的 2 美分加到这个系列中。我有很多关于 SSL 握手和证书的博文。虽然其中大部分都围绕 IIS Web 服务器，但该帖子通常仍然与 SSL/TLS 握手相关。这里有几个供您参考：

*   [SSL 握手和 IIS](https://blogs.msdn.microsoft.com/kaushal/2013/08/02/ssl-handshake-and-https-bindings-on-iis/)
*   [SSL 握手中的客户端证书身份验证](https://blogs.msdn.microsoft.com/kaushal/2015/05/27/client-certificate-authentication-part-1/)

> 不要将**证书**和**SSL**视为一个主题。将它们视为 2 个不同的主题，然后尝试查看它们与谁一起工作。这将帮助您回答问题。

**通过证书存储在通信方之间建立信任**

SSL/TLS 通信仅在信任的基础上工作。互联网上的每台计算机（客户端/服务器）都有一个它维护的根 CA 和中间 CA 的列表。这些会定期更新。在 SSL 握手期间，这用作建立信任的参考。例如，在 SSL 握手期间，当客户端向服务器提供证书时。服务器将尝试检查颁发证书的 CA 是否存在于其 CA 列表中。当它不能这样做时，它声明它不能进行证书链验证。（这是答案的一部分。它还着眼于**AIA**为此。）客户端还对其在 Server Hello 中收到的服务器证书进行类似的验证。在 Windows 上，您可以通过 PowerShell 查看客户端和服务器的证书存储。从 PowerShell 控制台执行以下命令。

> PS Cert:> ls Location : CurrentUser StoreNames : {TrustedPublisher, ClientAuthIssuer, Root, UserDS...}
> 
> 位置：LocalMachine StoreNames：{TrustedPublisher、ClientAuthIssuer、远程桌面、根...}

Firefox 和 Opera 等浏览器不依赖底层操作系统进行证书管理。他们维护自己独立的证书存储。

SSL 握手使用对称和公钥加密。服务器身份验证默认发生。客户端身份验证是可选的，取决于服务器端点是否配置为对客户端进行身份验证。请参阅我的博客文章，因为我已经详细解释了这一点。

**最后对于这个问题**

> HTTPS协议如何识别证书？当证书完成所有信任/加密/身份验证工作时，为什么 HTTP 不能使用证书？

**证书**只是一个文件，其格式由[X.509](https://en.wikipedia.org/wiki/X.509)标准定义。它是一种证明通信方身份的电子文件。 **HTTPS = HTTP + SSL**是一种协议，它定义了 2 方应如何相互通信的准则。

**更多信息**

*   为了理解证书，您必须了解证书是什么，并阅读证书管理。这些很重要。
*   一旦理解了这一点，然后继续进行 TLS/SSL 握手。您可以为此参考 RFC。但它们是定义准则的骨架。包括我在内的几篇博文都详细解释了这一点。

如果完成了上述活动，那么您将对证书和 SSL 有一个大致的了解。

# c# - .NET Framework 中是否存在用于比较的现有委托？

> ID：470528
> 
> 赞同：2
> 
> 时间：2009-01-22T19:42:39.963
> 
> 标签：c#, .net, sorting, delegates

.NET 框架为常见任务提供了一些方便的通用委托，例如[`Predicate<T>`](http://msdn.microsoft.com/en-us/library/bfcke1bz.aspx)和[`EventHandler<T>`](http://msdn.microsoft.com/en-us/library/system.eventhandler(VS.71).aspx).

是否有相当于 CompareTo() 的内置委托？

签名可能是这样的：

```
delegate int Comparison<T>(T x, T y); 
```

这是为了实现排序，以便我可以为实际的排序例程（特别是 ListView.ListViewItemSorter）提供 lambda 表达式，因此欢迎使用任何其他方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T19:47:36.663

你甚至得到了正确的名字:)

看[`System.Comparison<T>`](http://msdn.microsoft.com/en-us/library/tfakywbh.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T19:46:12.780

寻找：[`System.Collections.Generic.Comparer<T>`](http://msdn.microsoft.com/en-us/library/cfttsh47.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T19:47:43.837

为什么不直接使用 Func？

```
void Example<T>(Func<T,T,int> comparereDel) {
  ...
} 
```

# javascript - 提升浏览器的javascript权限？

> ID：470531
> 
> 赞同：1
> 
> 时间：2009-01-22T19:44:31.490
> 
> 标签：javascript, xss

我正在开发一个内部工具，我记得有一些方法可以让你的脚本提示提升权限，如果被接受，允许跨站点请求等......因为这是一个内部工具，这可能会完成我需要的事情.

有谁知道如何做到这一点？

详细地说，我实际上是在尝试读取（在 javascript 中）注入我们页面的 3rd 方跟踪 iframe 的内容，以提供一些性能分析信息。这些 iframe 显然来自不同的域。如果我要代理他们，他们将不再提供准确的信息，因此该选项已失效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T20:03:25.257

我认为您实际上不能让您的脚本请求提升权限，但您可以检查它并要求用户在需要时更改其浏览器安全级别。

Mozilla.org 有一篇关于可配置安全策略的有趣文章：[http ://www.mozilla.org/projects/security/components/ConfigPolicy.html](http://www.mozilla.org/projects/security/components/ConfigPolicy.html)

如果您只需要绕过同源策略，您可以使用其他技巧，例如服务器端代理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T23:36:49.290

对于 Firefox/Mozilla，我认为您的意思`netscape.security.PrivilegeManager.enablePrivilege()`是在[另一个问题](https://stackoverflow.com/questions/371875/local-file-access-with-javascript)中。

您需要 UniversalBrowserRead 权限才能允许跨站点 AJAX。（我用它为一个简单的股票报价页面构建了一组本地文件，该页面从雅虎的金融服务中获取数据。当您第一次在该页面上运行浏览器时，浏览器会询问您（用户）是否要授予权限。您不必再次授予权限，直到您重新启动浏览器并再次阅读同一页面。）

# c# - 对 C# 的开源面向方面库的建议

> ID：470535
> 
> 赞同：2
> 
> 时间：2009-01-22T19:45:34.933
> 
> 标签：c#, open-source, aop

对 c# 的开源面向方面库的任何建议。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T19:56:20.263

[发布夏普](http://www.postsharp.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T19:50:19.777

春天.NET

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T19:56:43.367

我正在使用 Castle Windsor 和 Dynamic Proxy，它们共同提供了一种通过外部 XML 配置应用标准 AOP 方法拦截的简单方法。

如果您有更高级的 AOP 需求，[Aspect#](http://www.castleproject.org/aspectsharp/)可能有用（也依赖于动态代理） - 但我发现 Windsor 完美地满足了我的需求。

请注意，动态代理仅提供运行时 AOP。有一些解决方案可以在编译时混合到您的方面（尽管我不记得其中任何一个的名称）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T19:57:40.777

[CastleProject 的DynamicProxy](http://www.castleproject.org/dynamicproxy/index.html)可能是关于动态拦截的最轻量级和最强大的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-07T16:21:19.320

我也建议使用 Spring.NET，但这只是因为这是我唯一有经验的。Spring.NET 提供了更多（IoC、事务管理、良好的验证框架），但您可以使用您所需要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-06T16:17:44.290

Spring.NET 总的来说很棒，它的 AOP 支持也是如此。

不知道为什么人们说要避免它。事实上，它是 .NET 世界中最稳定、最可靠的框架之一。

开发进度缓慢，但这很好，因为它已经功能丰富且稳定。

# sql - 排序后如何限制 Oracle 查询返回的行数？

> ID：470542
> 
> 赞同：1204
> 
> 时间：2009-01-22T19:48:43.930
> 
> 标签：sql, oracle, pagination, sql-limit

有没有办法让`Oracle`查询表现得像它包含 MySQL`limit`子句一样？

在 MySQL 中，我可以这样做：

```
select * 
from sometable
order by name
limit 20,10 
```

获得第 21 到第 30 行（跳过前 20 行，给出接下来的 10 行）。行是在 之后选择的`order by`，因此它实际上是按字母顺序从第 20 个名称开始的。

在 Oracle 中，人们唯一提到的是`rownum`伪列，但它是*在之前* `order by`评估的，这意味着：

```
select * 
from sometable
where rownum <= 10
order by name 
```

将返回一组按名称排序的随机十行，这通常不是我想要的。它也不允许指定偏移量。

* * *

## 回答 #1

> 赞同：865
> 
> 时间：2009-01-22T19:55:58.797

您可以为此使用子查询

```
select *
from  
( select * 
  from emp 
  order by sal desc ) 
where ROWNUM <= 5; 
```

还可以查看Oracle/AskTom上的[关于 ROWNUM 和限制结果的主题以获取更多信息。](https://blogs.oracle.com/oraclemagazine/post/on-rownum-and-limiting-results)

**更新**：为了限制结果的下限和上限，事情变得有点臃肿

```
select * from 
( select a.*, ROWNUM rnum from 
  ( <your_query_goes_here, with order by> ) a 
  where ROWNUM <= :MAX_ROW_TO_FETCH )
where rnum  >= :MIN_ROW_TO_FETCH; 
```

（从指定的 AskTom 文章复制）

**更新 2**：从 Oracle 12c (12.1) 开始，有一种语法可用于限制行或从偏移量开始。

```
SELECT * 
FROM   sometable
ORDER BY name
OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY; 
```

有关更多示例，请参[见此答案](https://stackoverflow.com/a/26051830/57601)。感谢 Krumia 的提示。

* * *

## 回答 #2

> 赞同：809
> 
> 时间：2014-09-26T04:01:24.983

从 Oracle 12c R1 (12.1) 开始，有*一个*行[限制子句](http://www.oracle-base.com/articles/12c/row-limiting-clause-for-top-n-queries-12cr1.php)。它不使用熟悉`LIMIT`的语法，但可以通过更多选项更好地完成工作。您可以在[此处找到完整的语法](http://docs.oracle.com/database/121/SQLRF/statements_10002.htm#BABBADDD)。[（另请阅读此答案](https://stackoverflow.com/a/57547541/1461424)中有关其在 Oracle 内部如何工作的更多信息）。

要回答原始问题，请输入以下查询：

```
SELECT * 
FROM   sometable
ORDER BY name
OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY; 
```

（对于早期的Oracle版本，请参考此问题中的其他答案）

* * *

## 例子：

以下示例来自[链接页面](http://www.oracle-base.com/articles/12c/row-limiting-clause-for-top-n-queries-12cr1.php)，以防止链接腐烂。

### 设置

```
CREATE TABLE rownum_order_test (
  val  NUMBER
);

INSERT ALL
  INTO rownum_order_test
SELECT level
FROM   dual
CONNECT BY level <= 10;

COMMIT; 
```

### 桌子上有什么？

```
SELECT val
FROM   rownum_order_test
ORDER BY val;

       VAL
----------
         1
         1
         2
         2
         3
         3
         4
         4
         5
         5
         6
         6
         7
         7
         8
         8
         9
         9
        10
        10

20 rows selected. 
```

### 获取第一`N`行

```
SELECT val
FROM   rownum_order_test
ORDER BY val DESC
FETCH FIRST 5 ROWS ONLY;

       VAL
----------
        10
        10
         9
         9
         8

5 rows selected. 
```

### 获取第一`N`行，如果`N`^(第 th)行有平局，则获取所有平局行

```
SELECT val
FROM   rownum_order_test
ORDER BY val DESC
FETCH FIRST 5 ROWS WITH TIES;

       VAL
----------
        10
        10
         9
         9
         8
         8

6 rows selected. 
```

### 前`x`% 的行

```
SELECT val
FROM   rownum_order_test
ORDER BY val
FETCH FIRST 20 PERCENT ROWS ONLY;

       VAL
----------
         1
         1
         2
         2

4 rows selected. 
```

### 使用偏移量，对分页非常有用

```
SELECT val
FROM   rownum_order_test
ORDER BY val
OFFSET 4 ROWS FETCH NEXT 4 ROWS ONLY;

       VAL
----------
         3
         3
         4
         4

4 rows selected. 
```

### 您可以将偏移量与百分比结合起来

```
SELECT val
FROM   rownum_order_test
ORDER BY val
OFFSET 4 ROWS FETCH NEXT 20 PERCENT ROWS ONLY;

       VAL
----------
         3
         3
         4
         4

4 rows selected. 
```

* * *

## 回答 #3

> 赞同：193
> 
> 时间：2011-06-30T14:20:24.020

我对以下方法进行了一些性能测试：

### 阿斯通

```
select * from (
  select a.*, ROWNUM rnum from (
    <select statement with order by clause>
  ) a where rownum <= MAX_ROW
) where rnum >= MIN_ROW 
```

### 分析型

```
select * from (
  <select statement with order by clause>
) where myrow between MIN_ROW and MAX_ROW 
```

### 空头替代

```
select * from (
  select statement, rownum as RN with order by clause
) where a.rn >= MIN_ROW and a.rn <= MAX_ROW 
```

# 结果

表有 1000 万条记录，排序在未索引的日期时间行上：

*   解释计划显示所有三个选择的值相同 (323168)
*   但获胜者是 AskTom（分析紧随其后）

选择前 10 行需要：

*   AskTom：28-30 秒
*   分析：33-37 秒
*   短替代：110-140 秒

选择 100,000 到 100,010 之间的行：

*   AskTom：60 秒
*   分析：100 秒

选择 9,000,000 到 9,000,010 之间的行：

*   AskTom：130 秒
*   分析：150 秒

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2009-01-23T14:28:08.537

只有一个嵌套查询的分析解决方案：

```
SELECT * FROM
(
   SELECT t.*, Row_Number() OVER (ORDER BY name) MyRow FROM sometable t
) 
WHERE MyRow BETWEEN 10 AND 20; 
```

`Rank()`可以替换，`Row_Number()`但如果 name 有重复值，则返回的记录可能比您预期的要多。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2013-09-24T03:09:56.120

在 Oracle 12c 上（参见[SQL 参考](http://docs.oracle.com/database/121/SQLRF/statements_10002.htm#SQLRF01702)中的行限制子句）：

```
SELECT * 
FROM sometable
ORDER BY name
OFFSET 20 ROWS FETCH NEXT 10 ROWS ONLY; 
```

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2019-08-13T19:48:03.207

## SQL 标准

由于版本 12c，Oracle 支持 SQL:2008 标准，该标准提供以下语法来限制 SQL 结果集：

```
SELECT
    title
FROM
    post
ORDER BY
    id DESC
FETCH FIRST 50 ROWS ONLY 
```

## Oracle 11g 及更早版本

在版本 12c 之前，要获取[Top-N](https://vladmihalcea.com/sql-query-limit-top-n-rows/)记录，您必须使用派生表和`ROWNUM`伪列：

```
SELECT *
FROM (
    SELECT
        title
    FROM
        post
    ORDER BY
        id DESC
)
WHERE ROWNUM <= 50 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2014-04-12T17:32:50.717

在 Oracle 中，带有排序的分页查询非常棘手。

Oracle 提供了一个 ROWNUM 伪列，它返回一个数字，指示数据库从一个表或一组连接视图中选择行的顺序。

ROWNUM 是一个伪列，会给很多人带来麻烦。ROWNUM 值不会永久分配给行（这是一个常见的误解）。实际分配 ROWNUM 值时可能会造成混淆。**ROWNUM 值在通过查询的过滤谓词之后**但**在查询聚合或排序之前**分配给行。

更重要的是，ROWNUM 值只有在分配后才会增加。

这就是以下查询不返回任何行的原因：

```
 select * 
 from (select *
       from some_table
       order by some_column)
 where ROWNUM <= 4 and ROWNUM > 1; 
```

查询结果的第一行没有通过 ROWNUM > 1 谓词，因此 ROWNUM 不会递增到 2。因此，没有 ROWNUM 值大于 1，因此，查询不返回任何行。

正确定义的查询应如下所示：

```
select *
from (select *, ROWNUM rnum
      from (select *
            from skijump_results
            order by points)
      where ROWNUM <= 4)
where rnum > 1; 
```

[在我的Vertabelo](http://www.vertabelo.com/)博客文章中了解有关分页查询的更多信息：

*   [Oracle ROWNUM 解释](http://www.vertabelo.com/blog/oracle-rownum)
*   [Top-N 和分页查询](http://www.vertabelo.com/blog/pagination-queries)

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2019-08-18T19:02:48.890

作为[公认答案](https://stackoverflow.com/a/26051830/5070879)的扩展， Oracle 在内部使用`ROW_NUMBER/RANK`函数。`OFFSET FETCH`语法是语法糖。

可以通过以下**`DBMS_UTILITY.EXPAND_SQL_TEXT`**程序观察到：

准备样品：

```
CREATE TABLE rownum_order_test (
  val  NUMBER
);

INSERT ALL
  INTO rownum_order_test
SELECT level
FROM   dual
CONNECT BY level <= 10;
COMMIT; 
```

询问：

```
SELECT val
FROM   rownum_order_test
ORDER BY val DESC
FETCH FIRST 5 ROWS ONLY; 
```

是常规的：

```
SELECT "A1"."VAL" "VAL" 
FROM  (SELECT "A2"."VAL" "VAL","A2"."VAL" "rowlimit_$_0",
               ROW_NUMBER() OVER ( ORDER BY "A2"."VAL" DESC ) "rowlimit_$$_rownumber" 
      FROM "ROWNUM_ORDER_TEST" "A2") "A1" 
WHERE "A1"."rowlimit_$$_rownumber"<=5 ORDER BY "A1"."rowlimit_$_0" DESC; 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=oracle_18&fiddle=a2de7bf87764e964393ecb76bdc1cb88)**

获取扩展的 SQL 文本：

```
declare
  x VARCHAR2(1000);
begin
 dbms_utility.expand_sql_text(
        input_sql_text => '
          SELECT val
          FROM   rownum_order_test
          ORDER BY val DESC
          FETCH FIRST 5 ROWS ONLY',
        output_sql_text => x);

  dbms_output.put_line(x);
end;
/ 
```

* * *

`WITH TIES`扩展为`RANK`：

```
declare
  x VARCHAR2(1000);
begin
 dbms_utility.expand_sql_text(
        input_sql_text => '
          SELECT val
          FROM   rownum_order_test
          ORDER BY val DESC
          FETCH FIRST 5 ROWS WITH TIES',
        output_sql_text => x);

  dbms_output.put_line(x);
end;
/

SELECT "A1"."VAL" "VAL" 
FROM  (SELECT "A2"."VAL" "VAL","A2"."VAL" "rowlimit_$_0",
              RANK() OVER ( ORDER BY "A2"."VAL" DESC ) "rowlimit_$$_rank" 
       FROM "ROWNUM_ORDER_TEST" "A2") "A1" 
WHERE "A1"."rowlimit_$$_rank"<=5 ORDER BY "A1"."rowlimit_$_0" DESC 
```

和偏移：

```
declare
  x VARCHAR2(1000);
begin
 dbms_utility.expand_sql_text(
        input_sql_text => '
          SELECT val
FROM   rownum_order_test
ORDER BY val
OFFSET 4 ROWS FETCH NEXT 4 ROWS ONLY',
        output_sql_text => x);

  dbms_output.put_line(x);
end;
/

SELECT "A1"."VAL" "VAL" 
FROM  (SELECT "A2"."VAL" "VAL","A2"."VAL" "rowlimit_$_0",
             ROW_NUMBER() OVER ( ORDER BY "A2"."VAL") "rowlimit_$$_rownumber" 
       FROM "ROWNUM_ORDER_TEST" "A2") "A1" 
       WHERE "A1"."rowlimit_$$_rownumber"<=CASE  WHEN (4>=0) THEN FLOOR(TO_NUMBER(4)) 
             ELSE 0 END +4 AND "A1"."rowlimit_$$_rownumber">4 
ORDER BY "A1"."rowlimit_$_0" 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-03-02T14:32:32.123

更少的 SELECT 语句。此外，更少的性能消耗。致谢：anibal@upf.br

```
SELECT *
    FROM   (SELECT t.*,
                   rownum AS rn
            FROM   shhospede t) a
    WHERE  a.rn >= in_first
    AND    a.rn <= in_first; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-06-01T10:31:02.940

我已经开始准备 Oracle 1z0-047 考试，针对 12c 进行了验证 在准备它时，我遇到了称为“FETCH FIRST”的 12c 增强功能，它使您能够根据自己的方便获取行/限制行。它有几个选项可用

```
- FETCH FIRST n ROWS ONLY
 - OFFSET n ROWS FETCH NEXT N1 ROWS ONLY // leave the n rows and display next N1 rows
 - n % rows via FETCH FIRST N PERCENT ROWS ONLY 
```

例子：

```
Select * from XYZ a
order by a.pqr
FETCH FIRST 10 ROWS ONLY 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2022-01-02T07:48:27.347

使用 21c 版本，您可以简单地应用如下限制：

```
select * from course where ROWNUM <=10; 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-10-15T09:13:25.717

对于查询返回的每一行，ROWNUM 伪列返回一个数字，指示 Oracle 从表或连接行集中选择行的顺序。选择的第一行的 ROWNUM 为 1，第二行为 2，依此类推。

```
 SELECT * FROM sometable1 so
    WHERE so.id IN (
    SELECT so2.id from sometable2 so2
    WHERE ROWNUM <=5
    )
    AND ORDER BY so.somefield AND ROWNUM <= 100 
```

我已经在`oracle`服务器中实现了这个`11.2.0.1.0`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-04-12T11:01:46.577

```
select * FROM (SELECT 
   ROW_NUMBER() OVER (ORDER BY sal desc),* AS ROWID, 
 FROM EMP ) EMP  where ROWID=5 
```

大于值找出

```
select * FROM (SELECT 
       ROW_NUMBER() OVER (ORDER BY sal desc),* AS ROWID, 
     FROM EMP ) EMP  where ROWID>5 
```

小于然后值找出

```
select * FROM (SELECT 
       ROW_NUMBER() OVER (ORDER BY sal desc),* AS ROWID, 
     FROM EMP ) EMP  where ROWID=5 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2009-01-22T20:21:56.483

（未经测试）这样的事情可能会完成这项工作

```
WITH
base AS
(
    select *                   -- get the table
    from sometable
    order by name              -- in the desired order
),
twenty AS
(
    select *                   -- get the first 30 rows
    from base
    where rownum < 30
    order by name              -- in the desired order
)
select *                       -- then get rows 21 .. 30
from twenty
where rownum > 20
order by name                  -- in the desired order 
```

还有分析函数排名，您可以使用它来排序。

# c++ - 调用 _tcsstr 并分配给 wchar_t* 时出现编译错误

> ID：470544
> 
> 赞同：0
> 
> 时间：2009-01-22T19:49:00.327
> 
> 标签：c++, visual-studio-2008

尝试构建以前有效的 C++ 项目时出现编译错误。

代码如下：

```
const wchar_t* pdest;
pdest = _tcsstr(ConnStr, Name); 
```

错误如下： Error 10 error C2440: '=' : cannot convert from 'const char *' to 'const wchar_t

我正在使用Visual Studio 2008。错误消息很好地解释了问题，但我知道这个程序用于编译，我做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T19:54:01.923

你的代码很危险。_tcsstr 是一个 TCHAR 宏，因此它的定义可以根据是否定义了 UNICODE 来改变。wchar_t 是固定的。您看到的错误是由于这个确切的问题 - 环境正在使用 _tcsstr 的单字节版本（可能是因为未定义 UNICODE）。

不要只定义 UNICODE。先修复代码。要么对两者都使用 TCHAR 宏，要么对宽字符函数使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T20:02:28.147

_tcsstr 用于 TCHAR。根据编译设置，这是 char 或 wchar_t。

所以要么使用`TCHAR`, 要么`wcsstr`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-07T17:05:49.480

这应该可以解决这个问题：

> 属性 -> 配置属性 -> 常规 -> 字符集：使用多字节字符集。

# vim - 粘贴一大段代码时，vim 中的智能缩进（通常很好）是一场灾难

> ID：470551
> 
> 赞同：13
> 
> 时间：2009-01-22T19:51:05.033
> 
> 标签：vim, terminal, text-editor, copy-paste

我猜其他编辑器足够聪明，可以关闭这些东西以进行粘贴，但是在终端中使用 vim 时，它无法区分粘贴和实际输入。

您对此有哪些解决方案或解决方法？

补充：还有一个设置可以让评论在下一行自动继续。缩进至少不会改变代码的语义，但自动注释延续确实把事情搞砸了。想想看，我应该完全关闭它——有人知道那个选项叫什么吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-22T20:04:50.293

:set paste 是要走的路，但如果你忘记了，就像我经常做的那样，那么如果你使用的语言是 {} 作为块的打开/关闭，那么在第一个 { 或最后一个 } 上执行 =% 将重新应用缩进。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-22T19:53:41.690

：设置粘贴

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-03-24T10:43:05.213

将此添加到您的 .vimrc 中，并在添加代码块之前和之后将其与 F2 键一起使用来切换粘贴状态：

```
set pastetoggle=<F2> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-16T15:17:34.597

假设您正确设置了系统剪贴板，另一种方法是执行此操作

```
"*p 
```

这将从系统剪贴板粘贴。

检查您的`vim --version`. 我相信在 OS X 上你需要`+clipboard`和在 Linux 上。`+xterm_clipboard`

如果您在 OS X 上，您可以随时`brew install macvim`使用并使用`mvim -v`捆绑的 Vim（它不是用 编译的`+clipboard`）。

# html - 选择菜单内的上标注册标记“®”

> ID：470552
> 
> 赞同：4
> 
> 时间：2009-01-22T19:51:05.250
> 
> 标签：html, css, menu, superscript

选择菜单中是否可以有上标注册标记“®”？如果是这样，这是如何完成的？你可以使用 CSS 来实现这一点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T19:54:53.277

没有办法在`<option>`. 您被常规的 ® ( `&reg;`) 卡住了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-18T19:28:20.077

您可以在棘手的情况下使用此方法[使用 jQuery 为特殊字符上标](http://adaldesign.com/web-development/superscript-special-characters-reg-jquery)来获得结果。但我必须承认，在一个选项中......我是空白的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-02T11:34:26.103

**CSS1**：数字需要根据您的字体和磅值进行调整。

```
<div style="font-size:96px;">
Registered<span style="vertical-align:2.7em; font-size:0.2em;">&reg;</span>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T19:54:37.710

我不知道这是否可以通过 CSS 实现，但在 html 中您可以编写：

```
Company<sup>&reg;</sup> 
```

# nhibernate - 使用 nHibernate 2.0 的 Session.Get 时遇到问题 在具有复合 ID 的类上

> ID：470554
> 
> 赞同：5
> 
> 时间：2009-01-22T19:51:14.720
> 
> 标签：nhibernate, nhibernate-mapping

我遇到了一些（我认为）应该很简单但找不到任何明确信息的问题。

在我有三个表的场景中，描述一个人可以拥有多个工作的域：

Person - 有 PersonId，名称
Job - 有 JobId，JobName
PersonJob - 有 PersonId，JobId，YearsOfEmployment

注意：在我的对象模型中，我有代表每个表的实体。我有第三个实体来表示人员/工作关系，因为那里有有用的元数据（YearsOfEmployment），而不仅仅是一个简单的连接表。

那么，如果我知道 PersonId 和 JobId，是否有一种简单的方法可以让我使用会话并返回与这些 Id 匹配的对象？

或者，换一种方式，因为我已经知道主键是否存在脑死，简单的方法我可以将 SQL“SELECT YearsOfEmployment FROM PersonJob WHERE PersonId=1 AND JobId=1”变成类似的东西：

`var keys = new {PersonId=1, JobId=2};
PersonJob obj = Session.Get<PersonJob>(keys);`

顺便说一句：地图看起来像这样：

```
<class name="Person" table="dbo.Person" lazy="true">
  <id name="PersonId">
    <generator class="native"/>
  </id>
  <property name="Name"/>
</class>
<class name="Job" table="dbo.Job" lazy="true">
  <id name="JobId">
    <generator class="native"/>
  </id>
  <property name="JobName"/>
</class>
<class name="PersonJob" table="dbo.PersonJob" lazy="true">
  <composite-id>
    <key-property name="PersonId"></key-property>
    <key-property name="JobId"></key-property>
  </composite-id>
  <property name="YearsOfEmployment"/>
</class> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T20:21:08.717

好吧，我回答了我自己的问题。我认为发布您的问题几乎与与某人谈论它一样宣泄。如果我要让 PersonJob 的复合 ID 成为组件或类，即

```
<class name="PersonJob" table="dbo.PersonJob" lazy="true">
    <composite-id name="PersonJobKey" class="PersonJobKey">
      <key-property name="PersonId"></key-property>
      <key-property name="JobId"></key-property>
    </composite-id>
</class> 
```

然后我可以简单地这样做：

```
PersonJobKey key = new PersonJobKey() { PersonId = 1, JobId = 1 };  
PersonJob obj = Session.Get<PersonJob>(key);  
int yearsOfEmployment = obj.YearsOfEmployment; 
```

凉爽的。希望这可以帮助其他人弄清楚这一点...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-06T14:46:29.873

感谢您在上面发布答案，我正在针对我已映射的复合键没有名称或类的对象查看它。当我尝试创建一个类来表示复合键时，它改变了对象在其他代码使用时的行为方式。我也想写一些类似的东西；

```
Session.Get<SalesRepArea>(new { AreaCode = "ACode", RegionCode = "RCode"}); 
```

我发现 nHibernate 无法理解匿名对象，但我确实意识到我不需要复合键的名称或类类型。实际上，nHibernate Get 方法所追求的是一个瞬态对象，以便它可以从数据库中获取它的等效对象（这就是为什么必须在 C# 类中重写 equals 方法才能使复合键工作的原因）。所以对于下面的地图

```
<class name="SalesRepArea">
   <composite-id>
      <key-property 
         name="AreaCode" column="AreaCode" type="String" length="12" />
      <key-property 
         name="RegionCode" column="RegionCode" type="String" length="12" />
   </composite-id> 
```

我写的代码少了一点，并且省去了代表获取密钥的对象

```
SalesRepArea myArea = Session.Get<SalesRepArea>(
   new SalesRepArea()
   { 
      AreaCode = "ACode", 
      RegionCode = "RCode" 
   }
); 
```

我并不是说命名键方法不好，代码越少并不总是越好，这只是表明 Hibernate 正在寻找键所在的对象以从数据库中获取特定对象。

如果我弄错了，请告诉我，但我希望这会有所帮助，因为我在这方面遇到了一些麻烦。

谢谢，

标记

# asp.net - 当我部署为网站时，我应该分发数据集 XSD 文件吗？

> ID：470556
> 
> 赞同：0
> 
> 时间：2009-01-22T19:51:53.800
> 
> 标签：asp.net, deployment, dataset, strongly-typed-dataset

VS 2003 .NET 1.1

我知道当我将网站构建成 DLL 时，我不必分发 cs 文件。

当我的项目包含基于 XSD 文件构建的强类型数据集时，我是否也应该分发 XSD 文件，或者生成的 cs 文件（以及 DLL）是否包含使用数据集所需的所有信息？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T19:58:57.233

生成的 cs 文件（以及 DLL）包含创建强类型 DataSet 类的实例所需的所有信息。

# python - ISO编码的附件名称和python

> ID：470567
> 
> 赞同：1
> 
> 时间：2009-01-22T19:54:50.953
> 
> 标签：python, email, attachment

首先，我在这台计算机上没有代码示例，但我有一个非常相似的示例。

（[http://docs.python.org/library/email-examples.html](http://docs.python.org/library/email-examples.html)）

第4个。

我的问题在于这段代码

```
counter = 1
for part in msg.walk():
    # multipart/* are just containers
    if part.get_content_maintype() == 'multipart':
        continue
    # Applications should really sanitize the given filename so that an
    # email message can't be used to overwrite important files
    filename = part.get_filename()
    if not filename:
        ext = mimetypes.guess_extension(part.get_content_type())
        if not ext:
            # Use a generic bag-of-bits extension
            ext = '.bin'
        filename = 'part-%03d%s' % (counter, ext)
    counter += 1
    fp = open(os.path.join(opts.directory, filename), 'wb')
    fp.write(part.get_payload(decode=True))
    fp.close() 
```

当我获取没有 iso 或 utf 编码文件名的电子邮件时，此代码可以正常工作。但是当附件名称是 iso 编码时，文件名不在 get_filename 内，但文件名在 part["Content-type"] 内采用编码形式（我相信）

上面的例子试图猜测扩展名，如果找不到文件名，它只是给它一个部分文件名。我想要的是文件名。

有没有人处理过这样的问题，你做了什么来解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T09:38:26.210

我发现了问题，它与

```
mimetypes.guess_extension(part.get_content_type()) 
```

以及内容类型为“image/pjpeg”的图片

@S.Lott 我已将代码更改为类似于上面的示例，但我添加了此代码以修复 pjpeg 问题。

```
if not filename:
    ext = mimetypes.guess_extension(part.get_content_type())

if not ext:
    guess = part["Content-Type"].split(";")

    if guess[0] == "image/pjpeg":
        guess[0] = "image/jpeg"

    ext = mimetypes.guess_extension(guess[0])

if not ext:
    ext = ".bin" 
```

# .net - 如何将 GPU 用作 .Net 中的第二个处理器？

> ID：470569
> 
> 赞同：7
> 
> 时间：2009-01-22T19:54:55.133
> 
> 标签：.net, gpu

这个问题真的说明了一切。我希望我不必在 c++ .dll 中编写代码，然后从托管代码中调用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T19:58:10.837

通过快速谷歌搜索，我发现这[称为加速器。](http://blog.lab49.com/archives/356)[它是在这里找到](http://research.microsoft.com/en-us/projects/Accelerator/) 的一个微软研究项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T22:31:19.077

您只能使用着色语言为 GPU 编写代码。所有着色语言本身都是正确的语言（不是 C++、.NET 语言或其他任何语言），但它们与 C++ 非常相似。

最常见的着色语言是：

*   [**GLSL**](http://www.opengl.org/documentation/glsl/)（用于 OpenGL）

*   [**Cg**](http://developer.nvidia.com/page/cg_main.html)（与 directX 和 OpenGL 兼容的 nVidia 着色语言）

*   [**HLSL**](http://msdn.microsoft.com/en-us/library/bb509561(VS.85).aspx)（directX 的微软着色语言）。

您需要使用着色语言编写要在 GPU 上运行的代码，然后动态编译并下载到 GPU。您用于动态编译和下载的代码通常是任何支持 directX/OpenGL 东西的代码（据我所知，有 Java、.NET 和 C++ API - 尽管大多数人使用 C++，所以您会找到的大多数示例将是用 C++ 编写）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T19:55:58.893

我可以肯定地告诉你一件事：截至 2008 年 12 月，Nvidia 和 ATI 没有为他们的 GPU 提供托管类。不知道他们近期有没有这方面的打算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-11T18:34:02.433

[CUDAfy](http://www.hybriddsp.com/)

允许您使用 C# 编写代码，并为您静态或动态地转换为 CUDA C++。它在大多数情况下运行良好，但如果不直接更改库，更复杂的事情可能会很困难。自从我使用它以来，它可能已经有所改善。我也觉得 OpenCL 会在某个时候得到支持。

# apache-flex - 有人用 Adob e 的 Project Alchemy 做过什么吗？

> ID：470589
> 
> 赞同：3
> 
> 时间：2009-01-22T19:59:07.997
> 
> 标签：apache-flex, air, flash, alchemy

今年在 MAX 上再次亮相的是Adob​​e 的 C/C++ 到 AVM2 字节码编译器[Alchemy 。](http://labs.adobe.com/technologies/alchemy/)这似乎是非常有趣的东西——我还没有时间真正深入研究并亲自尝试它，但我绝对可以想象把它好好利用起来。想知道你们中是否有人有机会看过它，如果有，你们尝试过什么样的事情，它们是如何进行的，你们的意见是什么等等。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-25T11:32:30.637

我玩过炼金术；试图将 swfmill 移植到 AS3。

我的项目停滞不前，因为我真的需要一个好的压缩库……毕竟我不能将库与我的 C 代码一起拖动；）

另外，我发现在这个阶段，从 Flex 读取文件然后将其内容传递给 C 代码比尝试在 C 代码本身中读取它们更可靠。

我在我的博客上有一个如何做到这一点的例子。

# .net - 在通过 XML 修改 PrintTickets 方面需要帮助

> ID：470591
> 
> 赞同：3
> 
> 时间：2009-01-22T20:00:39.787
> 
> 标签：.net, xsd, system.printing

通过 System.Printing 框架（主要类是 PrintQueue、PrintTicket 和 PrinterCapabilities）做一些关于控制打印的工作。就像我最近一直在做的大多数事情一样，关于它的信息太少了。我希望在这个问题中汇编一些好的信息来帮助充实这个主题。

PrintTickets 让开发人员可以很好地处理最常见的打印配置设置。这很幸运，因为我不想用旧的 DEVMODE 方式来做（你可以将 DEVMODE 二进制流与 PrintTickets 相互转换，这很方便！）。

问题是有很多打印机，每一个都有独特的配置。这些不属于为 PrintTickets 创建的漂亮属性和枚举。如果您必须配置其设置超出此界面的打印机，则必须将您的 PrintTicket 序列化为 xml 并在那里进行修改。

当您使用 PrintTicket xml 时，您的生活由三个或更多模式支配：两个由 Microsoft 和一个或多个由打印机制造商。两个 MS 模式是

*   PrintSchemaFramework [http://schemas.microsoft.com/windows/2003/08/printing/printschemaframework](http://schemas.microsoft.com/windows/2003/08/printing/printschemaframework)
*   PrintSchemaKeywords [http://schemas.microsoft.com/windows/2003/08/printing/printschemakeywords](http://schemas.microsoft.com/windows/2003/08/printing/printschemakeywords)

我在处理原始 xml 时遇到的第一个问题是我找不到任何涵盖这些模式的 XSD。

**有人知道我在哪里可以获得这些模式的 XSD 吗？**

我遇到的第二个大问题是将用户输入映射到 PrintTicket xml。最理想的情况是，我想接受用户的输入，比如“Tray 3”，然后通过 PrintCapabilities 进行映射，以确定为该功能设置的选项的值。打印功能的文档有些不清楚，我担心如果我做得不对，它会充满边缘情况，会回来咬我。

**有没有人有任何修改 PrintTicket XML 的好例子？**

这是这个wiki的一个很好的起点......

* * *

问题1的更新：

向我从 2005 年的 WinHEC PPT 中获得的地址发送了一封电子邮件，并得到了 Windows 体验 - 文档和打印的项目经理 Justin Hutchings 的实际回复（很酷，不是吗？）：

将要，

打印模式命名空间没有 XSD。您应该查看 Print Schema Specification 1.0 并使用它来验证您的一致性。[http://www.microsoft.com/whdc/xps/downloads.mspx](http://www.microsoft.com/whdc/xps/downloads.mspx)

我们还在 PrintVerifier 中内置了 PrintSchema 验证。有关获取和配置 Print Verifier 的更多信息，请访问以下网址：

*   [http://blogs.msdn.com/PrintVerifier/](http://blogs.msdn.com/PrintVerifier/)
*   [http://www.microsoft.com/whdc/device/print/PrtTrblSh.mspx](http://www.microsoft.com/whdc/device/print/PrtTrblSh.mspx)
*   [http://download.microsoft.com/download/5/E/6/5E66B27B-988B-4F50-AF3A-C2FF1E62180F/CON-T608_WH08.pptx](http://download.microsoft.com/download/5/E/6/5E66B27B-988B-4F50-AF3A-C2FF1E62180F/CON-T608_WH08.pptx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T08:17:16.170

似乎您正在尝试做的事情以大纲形式描述在：

[http://msdn.microsoft.com/en-us/library/aa970573.aspx#ExtendingthePrintTicketClass](http://msdn.microsoft.com/en-us/library/aa970573.aspx#ExtendingthePrintTicketClass)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T11:18:26.313

查看有关选择托盘的主题：

[http://social.msdn.microsoft.com/forums/en-US/windowsxps/thread/f5859148-26f1-4e89-949c-180413bc​​c898/](http://social.msdn.microsoft.com/forums/en-US/windowsxps/thread/f5859148-26f1-4e89-949c-180413bcc898/)

CAnderson 和 Jo0815 正在询问 PrintQueue 的 PrintCapabilities 以询问与输入箱相关的功能。之后，他们将 DefaultPrintTicket 中的 XML 加载到 XMLDocument 中以插入节点以指定 bin，将 XMLDocument 写入流，然后从该流构建新的 PrintTicket。[（与创建 WholePrintTicket 类的过程](http://msdn.microsoft.com/en-us/library/aa970573.aspx#ExtendingthePrintTicketClass)中描述的连接然后删除重复项的过程相比，这可能是更直接的方法。）

相同的技术可以应用于标准 PrintTicket 未公开的其他功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T02:43:11.040

现在在 Microsoft 的网站上有一个打印模式规范（日期为 2013 年 7 月 28 日）：

[http://msdn.microsoft.com/en-us/windows/hardware/gg463385.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg463385.aspx)

这有 300 多个规范，还包括[http://schemas.microsoft.com/windows/2003/08/printing/printschemaframework的架构](http://schemas.microsoft.com/windows/2003/08/printing/printschemaframework)

# java - 如何将属性文件附加到 jar？

> ID：470592
> 
> 赞同：4
> 
> 时间：2009-01-22T20:00:55.043
> 
> 标签：java, jar, ant

我有一个使用串口的项目，它需要两个文件才能运行，win32.dll 文件（位于 java 运行时环境 bin 文件夹中）和 javax.comm.properties 文件（位于 java 运行时环境中lib 文件夹）。当我从 eclipse 运行项目时，它可以工作，但是当我尝试构建一个 jar 文件进行分发时，它就不起作用了。我怀疑这是因为 dll 和属性文件不包含在 jar 中。我如何指定他们需要在那里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T21:44:49.763

您通常不会将 dll 和属性文件放在 jar 中。需要将属性文件以及其他 jar 文件添加到类路径中。jar 文件有一个清单文件，它定义了使用的类路径。你不能用 eclipse 编辑它。您需要定义一个 ant build.xml 文件并执行以下操作：

```
<jar jarfile="${dist}/MyJar.jar" basedir="${build}">
  <manifest>
    <attribute name="Main-Class" value="MyClass"/>
    <attribute name="Class-Path" value="."/>
  </manifest>
</jar> 
```

然后将属性文件放在与jar相同的文件夹中。您可以通过右键单击 build.xml 并选择“Run as Ant target”来运行 ant 目标。

如果我没记错的话，将dll文件放在jre的bin目录中就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T20:26:09.067

我认为 javax.comm.properties 只需要在你的类路径上。您可以将其添加到您交付的罐子的顶层。

InputStream = MainClass.class.getResourceAsStream("javax.comm.properties"); if (is == null) {属性缺失....}

我认为 win32.dll 只需要在 %PATH%(windows) 或 $LD_LIBRARY_PATH(unix) 上......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T20:15:05.420

jar 文件只是一个普通的 zip 文件。如果要向其中添加文件，只需使用诸如 winzip 之类的工具即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T21:07:23.960

使用 Ant，您可以将所有想要的东西打包到您的 Jar 中。所以让 Ant 创建你的 Jar，而不是 Eclipse :)

# arrays - 确定一个值是否在排序数组中的 O 时间是多少？

> ID：470605
> 
> 赞同：1
> 
> 时间：2009-01-22T20:04:58.343
> 
> 标签：arrays, complexity-theory, big-o, binary-search

我有一个 5000 个整数的排序数组。我能以多快的速度判断一个随机整数是否是数组的成员？一般来说，C 和 Ruby 的答案会很好。

数组值的形式为

```
c * c + 1 
```

其中`c`可以是 1 到 5000 之间的任何整数。

例如：

```
[2, 5, 10, 17, 26, 37, 50 ...] 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-22T20:06:11.023

log(n) 用于 c 上的二进制搜索

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-22T20:20:53.537

我会说它是 O(const)！:)

给定一个随机数 r，检查它是否是一个可以用 (n*n+1) 形式表示的数字是很简单的。只需检查 sqrt(r-1) 是否为整数！

（嗯，它可能比这更复杂一点，因为您的编程语言可能会在处理整数与浮点数时引入一些复杂性，但仍然：您根本不需要搜索数组：只需检查数字是否在这种特殊的形式。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T20:11:33.743

正如其他人所提到的，二分搜索是 O(log2N)，并且可以递归编码：

```
 BinarySearch(A[0..N-1], value, low, high) {
       if (high < low)
           return -1 // not found
       mid = (low + high) / 2
       if (A[mid] > value)
           return BinarySearch(A, value, low, mid-1)
       else if (A[mid] < value)
           return BinarySearch(A, value, mid+1, high)
       else
           return mid // found
   } 
```

或迭代：

```
 BinarySearch(A[0..N-1], value) {
       low = 0
       high = N - 1
       while (low <= high) {
           mid = (low + high) / 2
           if (A[mid] > value)
               high = mid - 1
           else if (A[mid] < value)
               low = mid + 1
           else
               return mid // found
       }
       return -1 // not found
   } 
```

`sqrt(N-1)`但是，如果您正在寻找最快的方法，您可以根据您的数字设置一个查找表。只需 5,000 个单词的内存，您就可以通过这种方式实现 O(1) 查找。

解释：

由于对于从 1 到 N 的整数 N，所有数字的形式为 N^2 + 1，因此您可以创建一个包含 N 个元素的表。位置 i 处的元素将指定 i^2 + 1 是否在您的数组中。该表可以用长度为 N 的简单数组来实现。构建需要 O(N) 和 N 个单词的空间。但是一旦你有了表，所有的查找都是 O(1)。

例子：

这是 Python 中的示例代码，读起来像伪代码，一如既往:-)

```
import math

N = 5000
ar = [17, 26, 37, 50, 10001, 40001]

lookup_table = [0] * N

for val in ar:
    idx = int(math.sqrt(val - 1))
    lookup_table[idx] = 1

def val_exists(val):
    return lookup_table[int(math.sqrt(val - 1))] == 1

print val_exists(37)
print val_exists(65)
print val_exists(40001)
print val_exists(90001) 
```

建表最多占用 O(N)，查找是 O(1)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-22T20:23:01.287

从技术上讲，在固定大小的数组中查找元素的复杂性是恒定的，因为 log [2] 5000 不会改变。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T20:07:47.667

二分查找是 O(log n)

[维基百科](http://en.wikipedia.org/wiki/Binary_search)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T20:07:00.273

O(log n) 如果数组有 n 个元素

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-22T20:09:22.577

只是为了扩展：它是**lg** *n*测试，即**log** [2] n。这使它成为*O( **log** n)*。为什么？因为二进制搜索的每次尝试都会将数组分成两半；因此需要**lg** n 次试验。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-22T20:07:11.520

使用二分搜索，它是 Log(N) 搜索时间。

```
bool ContainsBinarySearch(int[] array, int value) {
  return Array.BinarySearch(arrray, value) >= 0;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-22T20:31:46.963

# 在 Perl 中：

我会将这些值加载到静态哈希中，然后它将是 O(1)。

# 构建查找哈希

lookup_hash{$_} = 1 foreach (@original_array);

# 查找语法

($lookup_hash{$lookup_value}) && print "Found it in O(1) - no loop here\n";

# iis - 使用 IIS 的 URL 中的端口处理自定义错误

> ID：470606
> 
> 赞同：0
> 
> 时间：2009-01-22T20:05:05.020
> 
> 标签：iis, ports, custom-errors

我正在尝试指定一个自定义（ASPX）页面来处理 404 错误。

我似乎无法使用 IIS 执行此操作，因为我使用的端口不是默认端口。

我有两个版本的站点，一个是公开的（默认端口），一个在另一个端口上，用于测试。我首先尝试在测试模式下执行此操作。

如果我这样做： [http](http://www.mysite.com/notapage) ://www.mysite.com/notapage ...我收到 IIS 404 错误。

如果我这样做： [http](http://www.mysite.com:1234/notapage) ://www.mysite.com:1234/notapage ...我收到一个 Google 错误（我使用 Google Chrome），好像它无法解析我的网站，即使[http://www.mysite.com/](http://www.mysite.com/)作品。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T06:50:04.367

您在哪个级别上将此 ASPX 页面配置为 404？如果您在默认网站上执行此操作，则它仅适用于您提供的第一个测试链接。

端口 1234 应由另一个网站监控。请检查您的 IIS 设置并确保该站点配置正确。

# .net - Treeview --> 父节点值

> ID：470607
> 
> 赞同：1
> 
> 时间：2009-01-22T20:05:14.707
> 
> 标签：.net, wpf, treeview

我是 WPF 世界的新手。我有 treeView 包含

树视图

授权 -->

```
 Portfolio
           ---->portfolio1 
```

基准

```
 Category
          ------>Name1  etc.. 
```

我想知道如何在 WPF 中获取父节点值？例如，如果我选择portfolio1 如何获取父父值。在这种情况下，授权。

简而言之，我想知道用户是否点击 Name1 --> 我应该得到 Benchmarks，如果用户点击 Portfolio1 那么我应该得到 Portfolio。

非常感谢您的指导。

感谢和问候，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T20:20:48.000

您可以将 VisualTreeHelper.GetParent 用于 Name1，然后是其父级。

或者您可以迭代地执行此操作，直到获得 TreeViewItem 类型的对象，这样您在更改 xaml 时就不必更新代码。

如果你用第二种方法，它看起来像这样：

```
DependencyObject parent = VisualTreeHelper.GetParent(Name1);
while(!(parent is TreeViewItem))
    parent = VisualTreeHelper.GetParent(parent);
TreeViewItem item = (TreeViewItem) parent; 
```

# c# - 哪个是首选：Regex.Replace() 或。aRegexObject.Replace()？

> ID：470608
> 
> 赞同：2
> 
> 时间：2009-01-22T20:05:22.273
> 
> 标签：c#, regex

这是对[这个问题的跟进](https://stackoverflow.com/questions/262448/replace-non-numeric-with-empty-string#262466)

前两个答案既正确又完整，最终产生完全相同的结果。但是，一个使用 Regex 对象并调用 aRegex.Replace(...) 方法（乔尔的回答），另一个使用静态 Regex.Replace(...) 方法。（CMS的回答）。

首选哪种方法？
在什么情况下你会改变主意？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T20:11:02.107

`Regex`使用静态实例每次都会创建一个新对象，因此最好自己实例化它。这是我在 System.dll 上使用 Reflector 时发现的：

```
public static string Replace(string input, string pattern, string replacement)
{
    return new Regex(pattern, RegexOptions.None, true).Replace(input, replacement);
} 
```

另外，如果您实例化自己的实例，您也可以编译它并提高多种用途的性能。

您*可以*发送`RegexOptions.Compiled`到静态`Replace`重载之一，但这毫无意义，因为`Regex`将使用此标志实例化的对象无法再次使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T21:14:06.207

它并不像看起来那么低效。使用反射器进入 Regex 构造函数，它会缓存已编译的 regex 代码。这可能是最耗时的部分。

我最初通常会使用 Regex.Replace() ，因为它更方便，并且只有在出现性能问题时才会更改。

为方便起见，您还可以在字符串上编写扩展方法，例如：

```
public static string RegexReplace(this string source, string pattern, string replacement)
{
    return Regex.Replace(source, pattern, replacement);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T20:10:18.363

使用正则表达式对象意味着正则表达式只编译一次，因此您可以获得更好的性能（您需要将正则表达式对象保存在某个地方）。

# .net - Linq DataContext 在捕获异常后无法恢复？

> ID：470612
> 
> 赞同：1
> 
> 时间：2009-01-22T20:06:30.400
> 
> 标签：.net, vb.net, linq

我第一次使用 LINQ，我遇到了一些我对 DataContext 不完全理解的行为。希望 StackOverflow 可以提供帮助。

基本上，似乎一旦我的 DataContext 遇到异常，它要么缓存该异常，要么永远不会完全恢复。在我的特定情况下，一旦我尝试将一个太大的字符串传递给我的数据库，它会为所有后续字符串引发相同的异常。

我有一张这样的桌子：

```
 DisplayString(
  StringID nvarchar(255)
  ,CultureCode varchar(25)
  ,DisplayString nvarchar(255)
 ) 
```

在 .Net 中，我创建了一个 DataContext，我使用 LINQ to SQL 类将其映射到该表。

```
Dim context As New LinqTableMappingDataContext(
  My.Settings.LocalizationStringsConnectionString) 
```

然后我创建了一堆测试字符串，遍历每个字符串并将它们发送到我的表。

```
Dim arr As String() = 
  {"aaaaa",  "adsfs", "wefwf", "dfgsfg", "ergsdfg", 
   "fsdgergd", "Sdgdfgegd", "ergdfgsfd"}

  For Each a As String In arr
     addToLinq(a)
  Next 
```

这工作正常。但是，如果我在索引 1 处添加以下字符串，所有后续插入都会失败，抛出与长字符串相同的异常 (SqlException)。

```
"WARNING: This computer program is protected by copyright law and international
treaties. Unauthorized reproduction of this program, or any portion of it, may
result in severe civil and criminal penalties, and will be prosecuted to the
maximum extent possible under the law." 
```

这是我的 AddToLinq() 方法。

```
Private Sub AddToLinq(ByVal stringID As String)

  Dim f As New DisplayString
  Try

     Dim count As Integer = (From str In context.DisplayStrings _
       Where str.StringID = stringID Select str).Count

     If count = 0 Then

        f.StringID = stringID
        f.CultureCode = "en-US"
        f.DisplayString = stringID

        context.DisplayStrings.InsertOnSubmit(f)
        context.SubmitChanges()
        Console.WriteLine("SUBMITTED: " & stringID)
    End If

  Catch ex1 As SqlException
     Console.WriteLine("------------------------------------------------")
     Console.WriteLine("EXCEPTION: " & ex1.Message)
     Console.WriteLine(stringID)
     Console.WriteLine(stringID.Length)
     Console.WriteLine("------------------------------------------------")

  Catch ex As DuplicateKeyException
     Console.WriteLine(ex.Message)

  End Try
End Sub 
```

如果有人可以帮助我，那就太好了，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T21:50:10.597

如果您观察 DataContext 的[GetChangeSet 方法](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.getchangeset.aspx)，您会发现它仍然想要插入第一个字符串。这就是它无法恢复的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T20:14:12.600

每次需要时创建一个新上下文，而不是重用全局/静态上下文成员。问题是您的上下文对象处于错误状态。

```
....
if (count = 0)
   Dim context As New [Your context here]
   ....
end if 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T20:21:00.993

它实际上在同一插入上失败，因为您没有从数据上下文中删除失败的字符串，并且每次调用 SubmitChanges 时它都会尝试插入它。正如@confusedGeek 建议的那样，您可以通过为每个插入实例化一个新的数据上下文来解决这个问题。或者，您可以将 ConflictMode 设置为 ContinueOnConflict，我相信其余的更改将被插入。由于您在每次添加时都提交更改，因此我会选择前一种解决方案并为每个插入创建单独的上下文。

**编辑**：另一种选择是让您的异常处理程序处理旧上下文并在错误时创建一个新上下文。我不确定这是否有很大的改进——似乎比必要的要复杂一些。数据上下文是非常轻量级的实体，所以我不会太担心根据需要创建一个新实体。

# php - 如何在 PHP 中获取当前日期和时间？

> ID：470617
> 
> 赞同：978
> 
> 时间：2009-01-22T20:09:18.460
> 
> 标签：php, datetime

哪个 PHP 函数可以返回当前日期/时间？

* * *

## 回答 #1

> 赞同：692
> 
> 时间：2009-01-23T00:19:36.567

时间将按您的服务器时间计算。一个简单的解决方法是在调用or函数[`date_default_timezone_set`](http://php.net/manual/en/function.date-default-timezone-set.php)之前手动设置时区。[`date()`](http://www.php.net/manual/en/function.date.php)[`time()`](http://www.php.net/manual/en/function.time.php)

我在澳大利亚墨尔本，[所以](http://php.net/manual/en/timezones.australia.php)我有这样的事情：

```
date_default_timezone_set('Australia/Melbourne'); 
```

或者另一个例子是 LA - [US](http://php.net/manual/en/timezones.america.php)：

```
date_default_timezone_set('America/Los_Angeles'); 
```

您还可以通过以下方式查看服务器当前所在的时区：

```
date_default_timezone_get(); 
```

所以像：

```
$timezone = date_default_timezone_get();
echo "The current server timezone is: " . $timezone; 
```

因此，您的问题的简短答案是：

```
// Change the line below to your timezone!
date_default_timezone_set('Australia/Melbourne');
$date = date('m/d/Y h:i:s a', time()); 
```

那么所有时间都将是您刚刚设置的时区:)

* * *

## 回答 #2

> 赞同：584
> 
> 时间：2012-03-06T14:42:58.253

```
// Simply:
$date = date('Y-m-d H:i:s');

// Or:
$date = date('Y/m/d H:i:s');

// This would return the date in the following formats respectively:
$date = '2012-03-06 17:33:07';
// Or
$date = '2012/03/06 17:33:07';

/** 
 * This time is based on the default server time zone.
 * If you want the date in a different time zone,
 * say if you come from Nairobi, Kenya like I do, you can set
 * the time zone to Nairobi as shown below.
 */

date_default_timezone_set('Africa/Nairobi');

// Then call the date functions
$date = date('Y-m-d H:i:s');
// Or
$date = date('Y/m/d H:i:s');

// date_default_timezone_set() function is however
// supported by PHP version 5.1.0 or above. 
```

有关时区参考，请参阅*[支持的时区列表](http://php.net/manual/en/timezones.php)*。

* * *

## 回答 #3

> 赞同：236
> 
> 时间：2013-05-29T12:44:05.737

由于 PHP `5.2.0`，您可以使用[`DateTime()`](http://www.php.net/manual/en/datetime.construct.php)该类：

```
use \Datetime;

$now = new DateTime();
echo $now->format('Y-m-d H:i:s');    // MySQL datetime format
echo $now->getTimestamp();           // Unix Timestamp -- Since PHP 5.3 
```

并指定`timezone`：

```
$now = new DateTime(null, new DateTimeZone('America/New_York'));
$now->setTimezone(new DateTimeZone('Europe/London'));    // Another way
echo $now->getTimezone(); 
```

* * *

## 回答 #4

> 赞同：108
> 
> 时间：2013-08-29T18:49:06.580

Reference: Here's [a link](http://php.net/manual/en/function.date.php)

This can be more reliable than simply adding or subtracting the number of seconds in a day or a month to a timestamp because of daylight saving time.

The PHP code

```
// Assuming today is March 10th, 2001, 5:16:18 pm, and that we are in the
// Mountain Standard Time (MST) Time Zone

$today = date("F j, Y, g:i a");                 // March 10, 2001, 5:16 pm
$today = date("m.d.y");                         // 03.10.01
$today = date("j, n, Y");                       // 10, 3, 2001
$today = date("Ymd");                           // 20010310
$today = date('h-i-s, j-m-y, it is w Day');     // 05-16-18, 10-03-01, 1631 1618 6 Satpm01
$today = date('\i\t \i\s \t\h\e jS \d\a\y.');   // it is the 10th day.
$today = date("D M j G:i:s T Y");               // Sat Mar 10 17:16:18 MST 2001
$today = date('H:m:s \m \i\s\ \m\o\n\t\h');     // 17:03:18 m is month
$today = date("H:i:s");                         // 17:16:18
$today = date("Y-m-d H:i:s");                   // 2001-03-10 17:16:18 (the MySQL DATETIME format) 
```

* * *

## 回答 #5

> 赞同：74
> 
> 时间：2009-01-22T20:13:24.723

PHP 的[time()](http://us3.php.net/time)返回当前的 Unix 时间戳。有了这个，您可以使用[date()](http://us3.php.net/date)函数将其格式化为您的需要。

```
$date = date('Format String', time()); 
```

正如 Paolo 在评论中提到的，第二个论点是多余的。以下代码段等同于上面的代码段：

```
$date = date('Format String'); 
```

* * *

## 回答 #6

> 赞同：72
> 
> 时间：2009-01-22T20:11:43.930

您可以使用[`$_SERVER['REQUEST_TIME']`变量](http://docs.php.net/manual/en/reserved.variables.server.php)（自 PHP 5.1.0 起可用）或[`time()`函数](http://docs.php.net/manual/en/function.time.php)来获取当前的 Unix 时间戳。

* * *

## 回答 #7

> 赞同：64
> 
> 时间：2009-01-22T21:36:55.210

您可以同时使用**`$_SERVER['REQUEST_TIME']`**变量或**`time()`**函数。这两个都返回一个 Unix 时间戳。

大多数情况下，这两种解决方案将产生完全相同的[Unix Timestamp](https://www.unixtimestamp.com/)。它们之间的区别在于`$_SERVER['REQUEST_TIME']`返回最近的服务器请求的时间戳并`time()`返回当前时间。根据您的应用程序，这可能会在精度上产生细微的差异，但在大多数情况下，这两种解决方案都应该足够了。

[根据上面的示例代码，一旦获得Unix Timestamp](https://www.unixtimestamp.com/)，您将需要格式化此信息。未格式化的[Unix 时间](https://en.wikipedia.org/wiki/Unix_time)如下所示：`1232659628`

因此，为了获得可以工作的东西，您可以使用该**`date()`**函数对其进行格式化。

[**PHP 手册**](http://us.php.net/date)`date()`中提供了有关使用该函数的方法的一个很好的参考。[](http://us.php.net/date)

 **例如，以下代码返回如下所示的日期`01/22/2009 04:35:00 pm`：

```
echo date("m/d/Y h:i:s a", time()); 
```

* * *

## 回答 #8

> 赞同：47
> 
> 时间：2015-04-17T11:43:10.423

PHP 的[日期](http://php.net/manual/en/function.date.php)函数可以完成这项工作。

[**日期（）**](http://php.net/manual/en/function.date.php)

**描述：**

```
string date(string $format [, int $timestamp = time()]) 
```

返回根据给定格式字符串格式化的字符串，使用给定的整数时间戳或当前时间（如果没有给出时间戳）。

**例子：**

```
$today = date("F j, Y, g:i a");               // March 10, 2001, 5:16 pm
$today = date("m.d.y");                       // 03.10.01
$today = date("j, n, Y");                     // 10, 3, 2001
$today = date("Ymd");                         // 20010310
$today = date('h-i-s, j-m-y, it is w Day');   // 05-16-18, 10-03-01, 1631 1618 6 Satpm01
$today = date('\i\t \i\s \t\h\e jS \d\a\y.'); // it is the 10th day.
$today = date("D M j G:i:s T Y");             // Sat Mar 10 17:16:18 MST 2001
$today = date('H:m:s \m \i\s\ \m\o\n\t\h');   // 17:03:18 m is month
$today = date("H:i:s");                       // 17:16:18
$today = date("Y-m-d H:i:s");                 // 2001-03-10 17:16:18 (the MySQL DATETIME format) 
```

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2019-06-15T17:45:37.023

对于新的 PHP 程序员可能会混淆为什么有很多方法可以获取当前日期和时间以及在他们的项目中使用哪一种。

**1.`date`方法**（PHP 4、PHP 5、PHP 7）

这是在 php 中获取日期和时间的最常见且最简单的方法。

```
// set the default timezone to use. Available since PHP 5.1
date_default_timezone_set('UTC');

// Prints something like: Monday
echo date("l");

// Prints something like: Monday 8th of August 2005 03:12:46 PM
echo date('l jS \of F Y h:i:s A');

// Prints: July 1, 2000 is on a Saturday
echo "July 1, 2000 is on a " . date("l", mktime(0, 0, 0, 7, 1, 2000));

/* use the constants in the format parameter */
// prints something like: Wed, 25 Sep 2013 15:28:57 -0700
echo date(DATE_RFC2822);

// prints something like: 2000-07-01T00:00:00+00:00
echo date(DATE_ATOM, mktime(0, 0, 0, 7, 1, 2000)); 
```

[你可以在这里](https://www.php.net/manual/en/function.date.php)了解更多

**2.`DateTime`类**（PHP 5 >= 5.2.0，PHP 7）

当您想将 PHP 与 OOP 一起使用时，这是获取日期和时间的最佳方式。

```
<?php
// Specified date/time in your computer's time zone.
$date = new DateTime('2000-01-01');
echo $date->format('Y-m-d H:i:sP') . "\n";

// Specified date/time in the specified time zone.
$date = new DateTime('2000-01-01', new DateTimeZone('Pacific/Nauru'));
echo $date->format('Y-m-d H:i:sP') . "\n";

// Current date/time in your computer's time zone.
$date = new DateTime();
echo $date->format('Y-m-d H:i:sP') . "\n";

// Current date/time in the specified time zone.
$date = new DateTime(null, new DateTimeZone('Pacific/Nauru'));
echo $date->format('Y-m-d H:i:sP') . "\n";

// Using a UNIX timestamp.  Notice the result is in the UTC time zone.
$date = new DateTime('@946684800');
echo $date->format('Y-m-d H:i:sP') . "\n";

// Non-existent values roll over.
$date = new DateTime('2000-02-30');
echo $date->format('Y-m-d H:i:sP') . "\n";
?> 
```

[你可以在这里](https://www.php.net/manual/en/datetime.construct.php)了解更多

**3\. Carbon Date时间包**

如果你使用[Composer](https://getcomposer.org/)、[Laravel](https://laravel.com)、[Symfony](https://symfony.com)或任何框架，这是获取日期和时间的最佳方式。此包还扩展了 php 中的 DateTime 类，因此您可以使用 Datetime 类中的所有方法。这个像 laravel 这样的内置框架，所以你不必单独安装它。

```
printf("Right now is %s", Carbon::now()->toDateTimeString());
printf("Right now in Vancouver is %s", Carbon::now('America/Vancouver')); // automatically converted to string
$tomorrow = Carbon::now()->addDay();
$lastWeek = Carbon::now()->subWeek();

// Carbon embed 823 languages:
echo $tomorrow->locale('fr')->isoFormat('dddd, MMMM Do YYYY, h:mm');
echo $tomorrow->locale('ar')->isoFormat('dddd, MMMM Do YYYY, h:mm');

$officialDate = Carbon::now()->toRfc2822String();

$howOldAmI = Carbon::createFromDate(1975, 5, 21)->age;

$noonTodayLondonTime = Carbon::createFromTime(12, 0, 0, 'Europe/London');

$internetWillBlowUpOn = Carbon::create(2038, 01, 19, 3, 14, 7, 'GMT');

if (Carbon::now()->isWeekend()) {
    echo 'Party!';
}
echo Carbon::now()->subMinutes(2)->diffForHumans(); // '2 minutes ago' 
```

[你可以在这里](https://carbon.nesbot.com/docs/)了解更多

希望这会有所帮助，如果您知道任何其他获取日期和时间的方法，请随时编辑答案。

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2009-01-22T22:32:20.557

利用：

```
$date = date('m/d/Y h:i:s a', time()); 
```

有用。

* * *

## 回答 #11

> 赞同：27
> 
> 时间：2013-06-07T09:59:01.703

```
 $date = new DateTime('now', new DateTimeZone('Asia/Kolkata'));
 echo $date->format('d-m-Y H:i:s'); 
```

**Update**

```
 //Also get am/pm in datetime:
 echo $date->format('d-m-Y H:i:s a'); // output 30-12-2013 10:16:15 am 
```

For the date format, *[PHP date() Function](http://www.w3schools.com/php/func_date_date.asp)* is useful.

* * *

## 回答 #12

> 赞同：27
> 
> 时间：2017-03-18T11:12:11.827

> 它非常简单
> 
> echo $date = date('Ymd H:i:s');

* * *

## 回答 #13

> 赞同：18
> 
> 时间：2017-03-28T10:13:35.570

```
echo date("d-m-Y H:i:sa"); 
```

此代码将获取运行代码的服务器的日期和时间。

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2016-10-12T07:02:33.737

您也可以使用这种格式：

```
$date = date("d-m-Y"); 
```

或者

```
$date = date("Y-m-d H:i:s"); 
```

* * *

## 回答 #15

> 赞同：15
> 
> 时间：2013-09-26T04:28:10.240

根据文章*[How to Get Current Datetime (NOW) with PHP](http://www.pontikis.net/tip/?id=18)*，有两种常用的方法来获取当前日期。要使用 PHP 获取当前日期时间（现在），您可以使用任何 PHP 版本的类，或者使用 PHP >= 5.2`date`更好的类。`datetime`

此处提供了各种日期格式表达式。

### 使用日期的示例

此表达式将以 NOW 格式返回`Y-m-d H:i:s`。

```
<?php
    echo date('Y-m-d H:i:s');
?> 
```

### 使用日期时间类的示例

此表达式将以 NOW 格式返回`Y-m-d H:i:s`。

```
<?php
    $dt = new DateTime();
    echo $dt->format('Y-m-d H:i:s');
?> 
```

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2012-12-09T08:46:44.230

```
<?php
echo "<b>".date('l\, F jS\, Y ')."</b>";
?> 
```

像这样打印

**2012 年 12 月 9 日，星期日**

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2017-01-19T09:07:11.670

```
<?php
// Assuming today is March 10th, 2001, 5:16:18 pm, and that we are in the
// Mountain Standard Time (MST) Time Zone

$today = date("F j, Y, g:i a");                 // March 10, 2001, 5:16 pm
$today = date("m.d.y");                         // 03.10.01
$today = date("j, n, Y");                       // 10, 3, 2001
$today = date("Ymd");                           // 20010310
$today = date('h-i-s, j-m-y, it is w Day');     // 05-16-18, 10-03-01, 1631 1618 6 Satpm01
$today = date('\i\t \i\s \t\h\e jS \d\a\y.');   // it is the 10th day.
$today = date("D M j G:i:s T Y");               // Sat Mar 10 17:16:18 MST 2001
$today = date('H:m:s \m \i\s\ \m\o\n\t\h');     // 17:03:18 m is month
$today = date("H:i:s");                         // 17:16:18
$today = date("Y-m-d H:i:s");                   // 2001-03-10 17:16:18 (the MySQL DATETIME format)
?> 
```

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2014-04-11T07:14:53.890

设置您的时区：

```
date_default_timezone_set('Asia/Calcutta'); 
```

然后调用日期函数

```
$date = date('Y-m-d H:i:s'); 
```

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2016-03-14T06:43:39.620

```
date(format, timestamp) 
```

该`date`函数使用给定的整数时间戳或当前时间（如果没有给定时间戳）返回根据给定格式字符串格式化的字符串。换句话说，`timestamp`是可选的，默认为 time() 的值。

参数是 -

> 格式 - 必需。指定时间戳的格式
> 
> 时间戳 - （可选）指定时间戳。默认为当前日期和时间

### 如何获得一个简单的约会

函数所需的格式参数`date()`指定如何格式化`date (or time)`.

以下是一些常用的日期字符：

1.  d - 代表月份中的某天（01 到 31）
2.  m - 代表一个月（01 到 12）
3.  Y - 代表年份（四位数）
4.  l（小写“L”）——代表星期几

`"/", ".", or "-"`也可以在字符之间插入其他字符以添加其他格式。

下面的示例以三种不同的方式格式化今天的日期：

```
<?php
    echo "Today is " . date("Y/m/d") . "<br>";
    echo "Today is " . date("Y.m.d") . "<br>";
    echo "Today is " . date("Y-m-d") . "<br>";
    echo "Today is " . date("l");
?> 
```

### 一些有用的链接

*   [gmdate()](http://php.net/manual/en/function.gmdate.php) - 格式化 GMT/UTC 日期/时间
*   [idate()](http://php.net/manual/en/function.idate.php) - 将本地时间/日期格式化为整数
*   [getdate()](http://php.net/manual/en/function.getdate.php) - 获取日期/时间信息
*   [getlastmod()](http://php.net/manual/en/function.getlastmod.php) - 获取最后一页修改的时间
*   [mktime()](http://php.net/manual/en/function.mktime.php) - 获取日期的 Unix 时间戳
*   [strftime()](http://php.net/manual/en/function.strftime.php) - 根据区域设置格式化本地时间/日期
*   [time()](http://php.net/manual/en/function.time.php) - 返回当前的 Unix 时间戳
*   [strtotime()](http://php.net/manual/en/function.strtotime.php) - 将任何英文文本日期时间描述解析为 Unix 时间戳
*   [预定义的日期时间常数](http://php.net/manual/en/class.datetime.php#datetime.constants.types)

* * *

## 回答 #20

> 赞同：11
> 
> 时间：2017-04-14T00:44:21.330

日期格式也取决于：

```
echo date("d/m/Y H:i:sa"); // 13/04/2017 19:38:15pm 
```

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2014-05-12T21:40:12.417

```
date_default_timezone_set('Europe/Warsaw');
echo("<p class='time'>".date('H:i:s')."</p>");
echo("<p class='date'>".date('d/m/Y')."</p>"); 
```

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2014-02-01T11:55:45.510

如果您想要不同的时间刻度，请使用：

```
$tomorrow  = mktime(0, 0, 0, date("m")  , date("d")+1, date("Y"));
$lastmonth = mktime(0, 0, 0, date("m")-1, date("d"),   date("Y"));
$nextyear  = mktime(0, 0, 0, date("m"),   date("d"),   date("Y")+1);

date_default_timezone_set("Asia/Calcutta");
echo date("Y/m/d H:i:s"); 
```

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2017-06-19T08:04:07.983

您可以使用以下代码：

```
<?php
    $currentDateTime = date('Y-m-d H:i:s');
    echo $currentDateTime;
?> 
```

* * *

## 回答 #24

> 赞同：10
> 
> 时间：2019-04-01T12:28:28.603

很简单

```
date_default_timezone_set('Asia/Kolkata');
$date = date('m/d/Y H:i:s', time()); 
```

* * *

## 回答 #25

> 赞同：9
> 
> 时间：2012-10-19T14:13:16.037

我发现在 PHP 中获取当前时间的最简单方法是这样的。

```
//Prints out something like 10:00am Just be sure to set your timezone correctly.
date_default_timezone_set("America/Chicago");
$TIME = date('G:ia'); 
```

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2017-01-26T11:13:42.130

另一种简单的方法是获取当前日期和时间的时间戳。使用**mktime()**函数：

```
$now = mktime(); // Return timestamp of the current time 
```

然后您可以将其转换为另一种日期格式：

```
//// Prints something like: Thursday 26th of January 2017 01:12:36 PM
echo date('l jS \of F Y h:i:s A',$now); 
```

更多日期格式在这里： http: [//php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

* * *

## 回答 #27

> 赞同：6
> 
> 时间：2019-02-27T04:13:50.753

```
echo date('y-m-d'); // Today 
```

> 这将返回今天的日期。

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2015-08-19T23:57:33.207

```
// Set the default timezone to use. Available since PHP 5.1
date_default_timezone_set('UTC');

// Prints something like: Monday
echo date("l");

// Prints something like: Monday 8th of August 2016 03:12:46 PM
echo date('l jS \of F Y h:i:s A');

// Prints: July 1, 2016 is on a Saturday
echo "July 1, 2016 is on a " . date("l", mktime(0, 0, 0, 7, 1, 2016));

/* Use the constants in the format parameter */
// Prints something like: Wed, 25 Sep 2013 15:28:57 -0700
echo date(DATE_RFC2822);

// Prints something like: 2016-07-01T00:00:00+00:00
echo date(DATE_ATOM, mktime(0, 0, 0, 7, 1, 2000)); 
```

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2017-03-15T09:52:51.330

如果您是孟加拉国人，并且想获得[达卡](https://en.wikipedia.org/wiki/Dhaka)的时间，请使用以下命令：

```
$date = new DateTime();
$date->setTimeZone(new DateTimeZone("Asia/Dhaka"));
$get_datetime = $date->format('d.m.Y H:i:s'); 
```

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2018-07-03T09:52:26.000

通常，这个日期函数对每个人都有用：**date("Y/m/d");**

但是时间是不同的，因为时间函数取决于 PHP 版本或系统日期。

所以可能像这样使用它来获取我们自己的时区：

```
$date = new DateTime('now', new DateTimeZone('Asia/Kolkata'));
echo $date->format('H:m:s'); 
```

此功能显示 24 小时时间。

* * *

## 回答 #31

> 赞同：5
> 
> 时间：2020-11-19T13:42:31.627

以下是一些常用的时间字符：

*   d - 代表月份中的某天（01 到 31）

*   m - 代表一个月（01 到 12）

*   Y - 代表年份（四位数）

*   l（小写“L”）——代表星期几

*   H - 一个小时的 24 小时格式（00 到 23）

*   h - 小时的 12 小时格式，带前导零（01 到 12）

*   i - 带前导零的分钟（00 到 59）

*   s - 带前导零的秒数（00 到 59）

*   a - 小写的 Ante meridiem 和 Post meridiem（am 或 pm）

例子 ：

```
echo "Today " . date("Y/m/d") ;
echo "time " . date("h:i:sa"); 
```

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2017-08-29T13:24:01.987

以下是一些常用的时间字符：

1.  h - 小时的 12 小时格式，带前导零（01 到 12）
2.  i - 带前导零的分钟（00 到 59）
3.  s - 带前导零的秒数（00 到 59）
4.  a - 小写的 Ante meridiem 和 Post meridiem（am 或 pm）

获取您的时区

```
<?php
    date_default_timezone_set("America/New_York");
    echo "The time is " . date("h:i:sa");
?> 
```

看看这个*（可选）*

```
<?php
    $d = mktime(11, 14, 54, 8, 12, 2014);
    echo "Created date is " . date("Y-m-d h:i:sa", $d);
?> 
```

**日期**

```
<?php
    echo "Today is " . date("Y/m/d") . ;
    echo "Today is " . date("Y.m.d") . ;
    echo "Today is " . date("Y-m-d") . ;
    echo "Today is " . date("l");
?> 
```

以下是一些常用的日期字符：

1.  d - 代表月份中的某天（01 到 31）
2.  m - 代表一个月（01 到 12）
3.  Y - 代表年份（四位数）
4.  l（小写“L”）——代表星期几

[来源-W3-学校](https://www.w3schools.com/php/php_date.asp)

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2018-03-14T07:19:04.823

获取当前时间和日期的最佳方法是通过PHP中的[date 函数：](http://php.net/manual/en/function.date.php)

```
$date = date('FORMAT'); // FORMAT E.g.: Y-m-d H:i:s

$current_date = date('Y-m-d H:i:s'); 
```

使用 Unix 时间戳：

```
$now_date = date('FORMAT', time()); // FORMAT Eg : Y-m-d H:i:s 
```

设置服务器时区：

```
date_default_timezone_set('Asia/Calcutta'); 
```

一个不同的时区列表在[这里](http://php.net/manual/en/timezones.php)。

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2020-08-24T06:25:10.003

只需使用： `date("Y-m-d H:i:s")` 这将为您提供日期和时间，例如 '2020-08-22 12:20:30' this 。在 date() 函数之前添加`date_default_timezone_set("your time zone")`以获取您所在地区/区域的时间日期。 [在这里你可以找到你的时区](https://www.php.net/manual/en/function.date-default-timezone-get.php)

* * *

## 回答 #35

> 赞同：4
> 
> 时间：2017-12-27T11:32:55.603

我们可以使用该`date`函数并设置默认时区：

```
<?php
    date_default_timezone_set("Asia/Kolkata");
    echo "Today is " . date("Y/m/d") . "<br>";
    echo "Today is " . date("Y.m.d") . "<br>";
    echo "Today is " . date("Y-m-d") . "<br>";
    echo "Today is " . date("l");
    echo "The time is " . date("h:i:sa");
?> 
```

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2016-03-12T10:35:10.770

If you want to get the date like ***12-3-2016***, separate each day, month, and year value, then copy-paste this code:

```
$day = date("d");
$month = date("m");
$year = date("y");
print "date" . $day . "-" . $month . "-" . $year; 
```

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2016-12-09T20:24:16.990

PHP 以秒为单位返回当前时间。您需要将它们格式化为您想要的任何格式。

```
<?php
    // time() returns current time in seconds
    $in_seconds = time();

    // strftime - Format a local time/date according to locale settings
    echo strftime("%m/%d/%y", $in_seconds);
?> 
```

参考： http: [//php.net/manual/en/function.strftime.php](http://php.net/manual/en/function.strftime.php)

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2019-11-14T07:50:58.927

您可以简单地使用此代码获取当前日期和时间

```
echo date('r', time()); 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2022-01-03T17:06:13.747

您所在国家/地区的时区：[支持的时区列表](https://www.php.net/manual/en/timezones.php)

```
date_default_timezone_set('Asia/Kolkata');

$dateYmd = date('Y-m-d');
echo "Current Year Month Day: $dateYmd"; 
```

> 本年月日：2022-01-03

```
$datehms = date('h:i:s');
echo "Current Hour Minute Second: $datehms"; 
```

> 当前时分秒：11:05:38

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2018-06-13T09:20:50.467

Linux 服务器时间与 PHP time() 时区差异如下：

```
<?php
    putenv("TZ=Asia/Kabul");
    $t = time();
    echo date('d/m/Y H:i:sa', $t);
?> 
```

# .net - XmlSerializer 和 InternalsVisibleTo 属性

> ID：470630
> 
> 赞同：2
> 
> 时间：2009-01-22T20:13:25.987
> 
> 标签：.net, xml-serialization, internalsvisibleto

是否可以`XmlSerializer`通过使用`InternalsVisibleTo`属性来序列化内部类成员？

如果是，我应该让我的内部组件对哪个组件可见。换句话说，我应该为`InternalsVisibleTo`属性提供什么程序集名称和公钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T20:18:45.617

这是一个常见的问题，请参阅此帖子：

[属性的内部设置器可以序列化吗？](https://stackoverflow.com/questions/420662/can-an-internal-setter-of-a-property-be-serialized)

这`DataContractSerializer`将使您可以序列化您想要的任何成员。由于它是一种可选的序列化方法，因此您需要根据需要对类进行注释。

### 编辑

重新阅读您的问题后，`DataContractSerializer`可能会起作用，但这可能不是您想要做的。XMLSerializer 可以使用，`InternalsVisibleTo`因为它将能够看到这些成员，但我建议您查看`DataContractSerializer`它（在我看来）是一个更好的序列化程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-25T14:54:50.657

[从这些评论](https://stackoverflow.com/questions/1347102/serialize-to-xml-private-properties)中，似乎 jrista 的 omment 并不完全正确：XmlSerializer 类是动态生成的，因此无法预先知道要添加到“InternalsVisibleTo”的类的名称。除非您按照另一个问题中的说明预编译这些序列化程序。

# php - 在 html 中嵌入音频 - 即使用 php 和 firefox

> ID：470647
> 
> 赞同：1
> 
> 时间：2009-01-22T20:19:15.287
> 
> 标签：php, javascript, html, audio, embed

我正在尝试为视障人士创建一个音频验证系统。我有一个系统可以将几个波形文件粘合在一起，但是我无法将它们嵌入到 ie 和 firefox 中。

```
<script type="text/javascript"> 
function EvalSound(soundobj)
{
    var thissound=document.getElementById(soundobj);
    thissound.Play();
}
</script>

<embed src="createaudiocaptcha.php?x=46765" autostart="false" width="0" height="0" id="sound1" enablejavascript="true"> 

<a href="javascript:EvalSound('sound1')"><img src="gfx/speaker.gif" border="0" alt="Audio capture for visually impaired"></a> 
```

使用这个工程，但是 ie (vista) 只会立即播放声音，它应该等到扬声器被点击。win xp 上的 IE 似乎由于某种原因被锁定。

我已经尝试为此更改嵌入：

```
<object type="application/x-mplayer2" height="0" width="0" id="sound1">
    <param name="src" value="createaudiocaptcha.php?x=19329">
    <param name="autostart" value="0">
    <param name="playcount" value="1">
</object> 
```

但是，即在winxp 上仍然会锁定- 即在vista 上会立即播放声音，而firefox 不会播放它说没有play() 功能。

有人知道为什么 ie 在 windows xp 上会锁定吗？- 建议赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T20:31:44.263

有一个音频服务基本上可以做这个确切的事情，称为 ReCaptcha ( [http://recaptcha.net/](http://recaptcha.net/) )。

如果您想了解更多信息，可以阅读[ReadWriteWeb上的服务评论。](http://www.readwriteweb.com/archives/recaptcha_enhanced_audio_captchas.php)

谷歌还提供音频验证码。这里有一篇关于谷歌官方博客的[文章](http://googleblog.blogspot.com/2006/11/audio-captchas-when-visual-images-are.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-13T19:12:36.863

我正在用相同的脚本做和你一样的事情。我的 IE 请求我安装 Media Player 插件。一旦我点击了顶部的 ActiveX 栏，如果 IE 安装它......不再锁定。检查 IE 中的安全选项和/或将 Java 更新到最新和最好的。对于它的价值......安装插件后，我确实让我的工作在 IE 和 FF 上具有 5 种不同的声音。哦......我把线放在了......前面一个，最后一个 /object 。也许这会对你有帮助？？！？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T21:43:24.540

为什么不只根据需要嵌入音频文件。仅当有人单击“我需要音频验证码”时才使用 JavaScript 写出嵌入/对象标签

在页面上放置一些标签，例如：

```
<a href="javascript:void(0);" onclick="getMeTheAudio();">Please play the audio Captcha</a><br />
<div id="audioCaptcha">

</div> 
```

然后 getMeTheAudio() 函数用嵌入/对象填充 audioCaptcha div 的 innerHTML。如果你想花哨的话，你可以嗅探浏览器类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T21:06:15.333

Scriptaculos 有一个非常好的[声音库](http://wiki.github.com/madrobby/scriptaculous/sound)。你可以玩和停下来；它应该满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-13T20:58:18.363

您将在下面的链接中找到多个可能的选项，

[http://www.phon.ucl.ac.uk/home/mark/audio/play.htm#](http://www.phon.ucl.ac.uk/home/mark/audio/play.htm#)

# installation - 如何使用 WiX 在开始菜单中创建多级子文件夹

> ID：470662
> 
> 赞同：13
> 
> 时间：2009-01-22T20:24:20.130
> 
> 标签：installation, wix, windows-installer, wix3

如何使用 WiX 在 Windows 开始菜单中创建子文件夹（深几级）？

目前，我可以将快捷方式放在“开始”菜单中，但只能放在“程序”（开始/程序/MyFolder）下的文件夹中，但我想更深地嵌套快捷方式（开始/程序/MyPlatform/MyProduct/等）。我尝试了不同的组合，但唉。

```
<DirectoryRef Id="StartMenuMyProduct">
    <Component Id="ApplicationShortcut" Guid="{PUT-SOME-GUID-HERE}">
        <Shortcut Id="ApplicationStartMenuShortcut"
                  Name="Configure My Product"
                  Description="Add or remove this and that"
                  Target="[MYPRODUCTDIR]ConfigureMyProduct.exe"
                  WorkingDirectory="MYPRODUCTDIR"/>
        <RemoveFolder Id="StartMenuMyProduct"
                      On="uninstall"/>
        <RemoveFolder Id="StartMenuMyPlatform"
                      On="uninstall"/>
        <RegistryValue Root="HKCU"
                       Key="SOFTWARE\MyCompany\MyPlatform\My Product"
                       Name="Installed"
                       Type="integer"
                       Value="1"
                       KeyPath="yes"/>
    </Component>
</DirectoryRef>

<!-- Shortcut to the configuration utility in the Windows Start menu -->
<Directory Id="ProgramMenuFolder">
    <!--<Directory Id="StartMenuMyPlatform" Name="MyPlatform">-->
      <Directory Id="StartMenuMyProduct" Name="My Product" />
    <!--</Directory>-->
</Directory> 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-22T23:08:50.920

有趣的是，MSI 要求创建一个注册表值来检测组件是否已安装。如果我们希望为所有快捷方式只创建一个这样的注册表值，那么我们必须将所有快捷方式放在一个组件中。

幸运的是，可以通过使用[Shortcut 元素](http://wix.sourceforge.net/manual-wix3/wix_xsd_shortcut.htm)上的 Directory 属性来创建跨越多个目标目录的组件。

```
 <!-- shortcuts to applications in the start menu -->
   <DirectoryRef Id="ProgramMenuProductFolder">
      <Component Id="ProgramMenuShortcutsComponent" Guid="PUT-GUID-HERE">
         <!-- create folders -->
         <CreateFolder Directory="ProgramMenuVendorFolder" />
         <CreateFolder Directory="ProgramMenuProductFolder" />
         <CreateFolder Directory="ProgramMenuSubFolder" />
         <!-- remove folder -->
         <RemoveFolder Id="RemoveProgramMenuVendorFolder"
            Directory="ProgramMenuVendorFolder"
            On="uninstall" />
         <RemoveFolder Id="RemoveProgramMenuProductFolder"
            Directory="ProgramMenuProductFolder"
            On="uninstall" />
         <RemoveFolder Id="RemoveProgramMenuProductSubFolder"
            Directory="ProgramMenuProductSubFolder"
            On="uninstall" />
         <!-- main shortcut -->
         <Shortcut
            Id="MainShortcut"
            Name="My Product"
            Target="[SomeInstalledFolder]app1.exe" />
         <!-- shortcut in subfolder -->
         <Shortcut
            Id="SubFolderShortcut"             
            Name="mySubFolderShortcut"
            Target="[SomeInstalledFolder]app2.exe"
            Directory="ProgramMenuProductSubFolder" />
         <!--
            RegistryValue whichs serves as KeyPath
         -->
         <RegistryValue
            Root="HKCU"
            Key="Software\MyVendor\MyProduct"
            Name="InstalledStartMenuShortcuts"
            Type="integer"
            Value="1" />
      </Component>
   </DirectoryRef>

   <!-- shortcut directories -->
   <Directory Id="ProgramMenuFolder">
      <Directory Id="ProgramMenuVendorFolder" Name="MyVendor">
         <Directory Id="ProgramMenuProductFolder" Name="MyProduct">
            <Directory Id="ProgramMenuProductSubFolder" Name="MySubFolder" />
         </Directory>
      </Directory>
   </Directory> 
```

# sql - SQL函数作为默认参数值？

> ID：470664
> 
> 赞同：114
> 
> 时间：2009-01-22T20:25:02.187
> 
> 标签：sql, sql-server, stored-procedures

我尝试使用以下方法更改默认参数值：

```
ALTER PROCEDURE [dbo].[my_sp]
@currentDate datetime = GETDATE() 
```

所有 SQL 预编译器给我的都是这个错误：

> 消息 102，级别 15，状态 1，过程 my_sp，第 8 行 '(' 附近的语法不正确。

我已经创建了程序。（我不确定这是否相关。）我使用的是空默认值并稍后检查它，但这似乎不合适。我可以在一行中做到这一点吗？

* * *

更新：我离开了[MSDN 对存储过程参数的描述](http://msdn.microsoft.com/en-us/library/ms186755.aspx "创建函数 (Transact-SQL)")：

> [ = default ] 是参数的默认值。如果定义了默认值，则无需为该参数指定值即可执行该函数。
> 
> > 注意：
> > 可以为 CLR 函数指定默认参数值，但 varchar(max) 和 varbinary(max) 数据类型除外。
> 
> 当函数的参数有默认值时，调用该函数时必须指定关键字DEFAULT来检索默认值。此行为与在存储过程中使用具有默认值的参数不同，其中省略参数也意味着默认值。

我读错了吗？

非常感谢。

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2009-01-22T20:29:43.597

存储过程参数的默认值必须是***常量***。您需要执行以下操作...

```
ALTER Procedure [dbo].[my_sp]
@currentDate datetime = null
AS
IF @currentDate is null
SET @currentDate = getdate() 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-01-22T20:27:56.707

我认为这是不可能的，您必须使用文字（常量）值作为默认值。

但是，您可以这样做：

```
Set @currentDate = Coalesce(@currentDate , GetDate()) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-08-20T17:42:07.543

您可以尝试如下：

```
Set @CurrentDate=IsNull(@CurrentDate,GetDate()) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-22T20:33:17.427

我从示例中的方括号中推断您正在使用 Microsoft SQL Server。

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms174979(SQL.90).aspx)：

> 只有一个常量值，比如字符串；标量函数（系统、用户定义或 CLR 函数）；或 NULL 可以用作默认值。

该函数`GETDATE()`不时返回不同的值，因此它不是常量表达式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T20:30:33.550

该值不是确定性的，不能使用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T20:37:38.137

建议：

将默认设置为`NULL`

`GETDATE()`在前端执行默认值。

# coding-style - When is the right time and the wrong time to do the quick and dirty solution?

> ID：470672
> 
> 赞同：3
> 
> 时间：2009-01-22T20:29:15.597
> 
> 标签：coding-style

When is it the right time and when is it the wrong time to take the quick and dirty approach versus the proper elegant solution?

This started from the comments on my question: [Decode Base64 data in Java](https://stackoverflow.com/questions/469695/decode-base64-data-in-java).

I wanted a way to do something using only internal Java or something I wrote. The only built in way is to use the sun.* package which is unsupported. So when is it the right time and when is it the wrong time to take that approach?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T20:38:31.067

In my opinion the only "right time" to use a quick and dirty solution (aka hack) is when...

1.  There is a mission-critical bug that needs immediate fixing and the proper solution is significantly complicated to implement.
2.  It's an internal application and some higher ups need a quick feature implemented (hey, neither you nor your customers use it).

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-22T20:34:54.663

In any situation, you have to balance the time that will be spent on solving the problem, and then the time that will be spent in maintaining that solution. If the lifetime of whatever you do is expected to be lengthy, then the extra time spent up front to do things the right way will, presumably, be easier to maintain and will save you in the long run.

However, if there are time constraints, the penalties for going over may far outweigh the maintenance cost. For example, if you MUST get a product out the door, do a quick-and-dirty solution now, and then log it as a bug to get fixed later in a patch, or the next version. That will require you to re-do the work, but like I said, it is all a balancing act, and often driven by cost at it's root.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T20:35:33.023

The right answer is that its *never* time to do the quick and dirty solution. But sometimes (when having a big customerbase and lots of programs out there) its better to ship a fix with a Q&D that maybe breaks something, but FOR SURE fix more.

I dont know if I understand the question right but Ill leave it with this.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-22T21:07:21.633

If there exists a simple but less elegant solution that closely matches the style and techniques used elsewhere in the code base (and consequently, is more easily understood by your colleagues), it may be safer to take that path -- compared to the solution that is perfect from an academic point of view, but difficult to understand if you never happened to read that specific paper.

Similarly, a small change may be considerably safer than a major refactoring effort that the elegant solution would basically require. This is especially relevant in any world that lacks unit tests.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-22T21:47:27.747

If the project is a "proof of concept" work rather than a production implementation, it may be the right time for a quick and dirty solution that gets the job done of illustrating how easy or hard some particular part is of a system. I'm thinking of where one may want to test out a new ERP or CRM system and just want to see the mechanics of it without spending a ton of time and money to get a more realistic prototype working.

In most other cases, it is a question of trade offs. How many defects can something have that gets released into the wild? Are just no showstoppers bugs OK or does there have to be few only a few minor or cosmetic bugs left. If some project managers or business units want something quick but not necessarily fully working then it the quick and dirty solution may work if those asking understand the risks. In a way this is like the question of how many tests should a doctor give before making a diagnosis: Should you be examined head to toe through a variety of different waves of energy, e.g. X-ray, CT scan, MRI, etc. Or can the doctor just look at what you are doing and know what is wrong like Dr. House does from time to time.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-22T22:15:36.347

It seems to me that quick and dirty solution is more often necessitated by a lack of planning somewhere moreso than it is because of a sudden change of business rules (not to say that doesn't happen though!). Either someone wasn't given appropriate tools to do their job, someone vastly underestimated the amount of time something will take, or someone got too attached to a feature that is overly complicated. In most of those cases, it's best to push back your release or scale back the features in the release.

In the case that it *was* necessitated by a business priority that you have no control over (like a legal issue), then you need to get it out the door as quickly as possible. But you should make the fix better for the next release!

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-22T20:44:51.837

It's the right time to use a quick and dirty solution when:

*   You need the solution to be quick (assuming no professional solution exists that is approximately as quick), and
*   You don't suffer consequences for it being dirty.

In some ways, that's a flippant answer, but it does cover it.

In your situation, you can't introduce a new library quickly. And you do have a process to mitigate the risk of using experimental code. As long as that process is reliable, and you are confident that production code won't include your quick & dirty solution, then go ahead.

Once my company was struggling to get some code working for a demo at a trade show. They were running out of time, the demo just one day away. I suggested they hard-code some options instead of making them configurable and dynamic.

It worked -- they got the demo running for the next day's show. Then when they got back to the office, they *immediately* removed the hard-coded part and finished their feature.

If you can rely on replacing the quick & dirty hack being *top priority*, then quick & dirty can be appropriate. It's just so seldom the case that it's top priority, that using this solution is usually a bad idea.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-22T21:23:08.000

As noted by tj111 and others, there are times when the *risk* of an elegant solution are greater than that of the quick and dirty. I.e., you deliver something beautiful, but by that time the customers no longer want it, want something different, or are pissed off.

To be sure though, there is always a long-term cost with doing a quick and dirty solution and it is important to deliver a firm and forceful "by the way" caveat to management. Else the quick and dirty becomes like crack to management who often do not know or care of the difference between the elegant and dirty (especially when it is under the hood). That is until things start to go to hell, and even then the fixitnow stress is offloaded to the hapless (often new) technical team.

So yeah, sometimes you have to do it because of $$ and time considerations, but don't cloak it or forget it and strive and push to re-factor soon when the crisis wanes.

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-22T21:38:46.437

Remember a lot Application get built off of their prototypes.

We always want to think its throw away code. But it will grow!

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-22T20:36:04.553

In my case I work in a research and development position where we have a long process for getting approval when adding external libraries.

If code is marked as experimental it will be cleaned up before moving to production. I needed this for a quick experiment to see if something was even going to make sense for us to work on and needed to get the data processing quickly. So the quick and dirty approach was the right one to get things done asap. If we decide to work on the experiment I will have time to replace the functionality properly.

In the standard case where as kdgregory put it in the comments of one answer:

> Bzzt. In a professional environment, using an unsupported, undocumented feature is never the correct decision. And in a corporate environment, "experiments" become "production code" with no chance to fix the hacks.

I think he is correct that it is not the appropriate approach when you work in a position where you have even a doubt that it may go into production. The only exception with this is if you absolutely do not have the time for a proper fix but can mark it as being a high priority issue in some visible public place (bug tracker) and will definitely be able to fix it in a future release.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-02-06T02:27:28.373

Sometimes a quick and dirty solution is synonymous with an unmaintainable solution. Other times it just means solving the (simple) problem you actually have, not the (more complex) generalization of that problem. I'm a grad student doing research in bioinformatics and I often need to write small programs that do simple things like reformat or summarize a few hundred megs of data. Occasionally I need to write several of these apps **per day**. If I wrote "proper" solutions to these I'd never get anything done.

Solving the general case (not quick and dirty) would mean making an app that handled errors robustly, was usable by people other than me, was configurable, etc. This would solve lots of problems that I don't have. I'm probably the only one that will ever use these programs. All the configurability I need is a few command line options and the ability to edit the source file as needed. All the error handling I need is displaying a decent error message and exiting if there's a problem.

Of course, sometimes these programs do grow into something more important and sometimes I do end up reusing code from them. Maintainability counts. Even in a quick and dirty solution, magic numbers should not be hard coded, variables should not be named "foo", "bar", and "stuff", and programs should not be written as one giant 400-line `main()` function. I learned these the hard way.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-22T20:40:07.493

Sometimes you have to do things in Q&D way. What you need to do in that circumstance is to protect yourself by hiding the dirty implementation behind an interface or an adapter.

To use the cited example, the Sun.* package works for now, but may not sometime in the future. Fine. Then wrap it in an adapter that implements the desired interface. Then, when Sun changes the API (hopefully providing something permanent like Java.BASE64), you can quickly update your implementation to cope with the change.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-22T20:47:33.250

I do a quick and dirty fix when three conditions are met:

*   There isn't enough time to do a proper solution
*   The fix and it's scope are clear and contained (it's easy to come back, know what the fix addressed, can be easily removed and replaced by a proper implementation)
*   The fix is atomic or has no dependencies

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-22T20:52:28.497

"Quick and Dirty", is often synonymous with "cheap yet actually works", which is generally all you need to get the job done. If anybody criticizes your code, pretty much the best defence is to say "yeah- it was just a quick and dirty solution". That way your coder colleagues can feel superior to you, whilst you pointy haired boss looks on, rubbing his chin in silent approval.

# c++ - 在托管包装器中包装非托管 c++

> ID：470678
> 
> 赞同：1
> 
> 时间：2009-01-22T20:31:04.203
> 
> 标签：c++, memory, unmanaged, managed, allocation

我有一个非托管 C++ 库。我想公开 .NET 应用程序的功能。我不确定如何处理一个特定的功能：

typedef void (free_fn*) (void*); void put (void *data, free_fn deallocation_function);

这个想法是您将动态分配的缓冲区传递给函数并提供一个释放函数。库将异步处理数据，并在以后不再需要数据时释放缓冲区：

无效 *p = malloc (100); ... 填充缓冲区... put (p, free);

我怎样才能将这种东西暴露给 .NET 应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T21:37:02.447

执行此操作时要非常小心。.NET 非常非常希望在进入非托管例程的过程中将其对象固定，并在退出时取消固定。如果您的非托管代码持有一个指针值，该指针值在进入的过程中被固定，那么很有可能内存将被移动或垃圾收集或两者兼而有之。

对于编组到函数指针的代表尤其如此（相信我 - 我发现编组的代表正在对我进行垃圾收集 - 我让 Microsoft 的人员为我验证了这一点）。这个问题的最终解决方案是将委托的副本存储在与唯一事务 id 配对的静态表中，然后创建一个非托管函数，该函数在调用时通过事务 id 在表中查找委托，然后执行它。它很丑，如果我有其他选择，我会使用它。

在您的情况下，这是执行此操作的最佳方法 - 因为您的非托管代码使用 set it and forget it 模型，所以您应该使您的 API 更粗。在托管 C++ 中创建一个包装器，该包装器通过非托管例程分配内存，将数据复制到其中，然后将其与指向非托管释放器的指针一起传递。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T21:08:08.620

通常，您的库的 .NET 使用者不会将动态创建的数组传递给您的函数。据我所知，.NET 中的所有容器都是垃圾收集器。

无论如何，您都需要为非托管代码创建一个托管包装器。关于这方面的教程和文章有很多，[这里有一篇从](http://www.codeguru.com/cpp/cpp/cpp_managed/general/article.php/c10653).

在为未管理的代码编写 .NET 包装器时，我发现您希望更多地关注保留功能，而不是让每个函数都可以在 .NET 中访问。在您的示例中，最好让托管包装器将数组复制到非托管内存中并在库中执行您需要的任何操作。这样，您不必为了规避 .NET 运行时的垃圾回收而对托管内存进行任何固定或将托管内存编组到非托管内存。但是，如何实现托管包装器实际上取决于该函数的用途。

如果你真的想在 .NET 中实现这个函数，你需要查看[.NET 中的 Marshal 类](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal_members.aspx)来控制非托管代码中的托管内存。

对于您的回调函数，您首先需要创建可以在托管代码中分配的 .NET 委托。然后，您需要在库内部创建一个非托管自由函数，该函数由 put 函数的非托管版本调用。如果用户分配了一个，那么这个非托管自由函数将负责调用托管委托。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T03:44:09.947

之前的一些海报一直在使用已弃用的 MC++。C++/CLI 是一种更为优雅的解决方案。

最好的互操作技术是隐式互操作，而不是显式互操作。我不相信有人对此发表评论。但是，它使您能够从托管<->本机编组您的类型，如果您对类型定义或结构布局进行更改，它不会导致重大更改（显式互操作会这样做）。

这篇维基百科文章记录了一些差异，是了解更多信息的良好起点。

[P/Invoke（显式和隐式）](http://en.wikipedia.org/wiki/Platform_Invocation_Services)

此外，站点[marshal-as.net](http://www.marshal-as.net/ "元帅")有一些关于这种较新方法的示例和信息（同样，更理想的是，如果重新定义原生结构，它不会破坏您的代码）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T21:51:15.697

您绝对不想固定托管缓冲区，因为尝试在非托管代码中释放它似乎是通往疯狂的最短途径。如果您不能在完全托管的代码中重写这部分，那么最好的选择是在包装器中制作数据的副本，或者完全对托管世界隐藏缓冲区管理。

如果您有胆量（和受虐的耐力），您*可以*将缓冲区固定在包装器中，然后传入取消固定缓冲区的托管函数的编组委托。但是，我不建议这样做。不得不做几个托管包装器教会了我公开绝对*最小*的非托管功能的价值，即使这意味着您必须在托管代码中重写一些东西。跨越这个边界就像从东德到西德一样容易，更不用说性能打击了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T23:24:03.120

大多数回复建议应将数据从托管缓冲区复制到非托管缓冲区。你会怎么做呢？以下实施可以吗？

```
void managed_put (byte data_ __gc[], size_t size_)
{
    //  Pin the data
    byte __pin *tmp_data = &data_[0];

    //  Copy data to the unmanaged buffer.
    void *data = malloc (size_);
    memcpy (data, (byte*) tmp_data, size_);

    //  Forward the call
    put (data, size_, free);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T23:03:23.943

既然你提到它是异步的，我会这样做。.Net 公开的函数只接受数据但不接受委托。您的代码将固定数据和函数指针传递给将简单地取消固定数据的函数。这会将内存清理留给 GC，但要确保在异步部分完成之前它不会清理它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T20:33:33.713

您必须拥有函数本身的托管包装器（如果您想传入托管函数，则必须使用非托管包装器）。否则，将非托管函数指针视为托管世界中的不透明句柄。

# performance - 内存分配/释放瓶颈？

> ID：470683
> 
> 赞同：51
> 
> 时间：2009-01-22T20:32:06.900
> 
> 标签：performance, optimization, memory-management, garbage-collection, malloc

在典型的实际程序中，内存分配/释放有多少瓶颈？欢迎来自性能通常很重要的任何类型的程序的答案。malloc/free/garbage 收集的体面实现是否足够快以至于它只是少数极端情况下的瓶颈，或者大多数性能关键软件会从尝试降低内存分配量或拥有更快的 malloc/free/ 中显着受益垃圾回收实现？

注意：我在这里**不是**在谈论实时的东西。我所说的性能关键是指吞吐量很重要但延迟并不一定的东西。

编辑：虽然我提到了 malloc，但这个问题**并不是**针对 C/C++ 的。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-22T20:41:25.603

这很重要，尤其是随着碎片的增加，分配器必须在更大的堆中更加努力地寻找您请求的连续区域。大多数对性能敏感的应用程序通常会编写自己的固定大小的块分配器（例如，它们一次向操作系统请求 16MB 的内存，然后将其分配为 4kb、16kb 等固定块）以避免此问题。

在游戏中，我看到对 malloc()/free() 的调用会消耗多达 15% 的 CPU（在编写不佳的产品中），或者使用精心编写和优化的块分配器，仅消耗 5%。鉴于游戏必须具有 60 赫兹的稳定吞吐量，因此在垃圾收集器偶尔运行时让它停顿 500 毫秒是不切实际的。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-22T20:49:11.750

现在几乎每个高性能应用程序都必须使用线程来利用并行计算。这就是编写 C/C++ 应用程序时真正的内存分配速度杀手的用武之地。

在 C 或 C++ 应用程序中，malloc/new 必须为每个操作锁定全局堆。即使没有争用锁也远非免费，应尽可能避免。

Java 和 C# 在这方面做得更好，因为从一开始就设计了线程，并且内存分配器从每个线程池中工作。这也可以在 C/C++ 中完成，但它不是自动的。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-22T20:47:19.617

首先，既然你说 malloc，我假设你在谈论 C 或 C++。

内存分配和释放往往是现实世界程序的一个重要瓶颈。当您分配或取消分配内存时，“幕后”会发生很多事情，而且所有这些都是系统特定的；内存实际上可能被移动或碎片整理，页面可能被重新组织——没有独立于平台的方式来知道影响是什么。一些系统（如许多游戏机）也不进行内存碎片整理，因此在这些系统上，随着内存碎片化，您将开始出现内存不足错误。

一个典型的解决方法是预先分配尽可能多的内存，然后一直使用它直到程序退出。您可以使用该内存来存储大量的单片数据集，或者使用内存池实现将其分块分发。正是出于这个原因，许多 C/C++ 标准库实现自己进行了一定数量的内存池。

不过，没有两种方法——如果你有一个时间敏感的 C/C++ 程序，那么做大量的内存分配/释放会降低性能。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-22T20:42:05.257

一般来说，内存分配的成本可能与**大多数**应用程序中的锁争用、算法复杂性或其他性能问题相比相形见绌。总的来说，我想说这可能不在我担心的前 10 名性能问题之列。

现在，获取非常大的内存块可能是个问题。抓取但没有正确清除记忆是我担心的事情。

在 Java 和基于 JVM 的语言中，新建对象现在非常、非常、非常快。

这是一个了解他的东西的人写的一篇不错的文章，底部有一些参考，指向更多相关链接： [http ://www.ibm.com/developerworks/java/library/j-jtp09275.html](http://www.ibm.com/developerworks/java/library/j-jtp09275.html)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-23T10:21:17.880

在 Java（以及可能具有良好 GC 实现的其他语言）中，分配对象非常便宜。在 SUN JVM 中，它只需要 10 个 CPU 周期。C/c++ 中的 malloc 更昂贵，只是因为它必须做更多的工作。

即使 Java 中的分配对象仍然非常便宜，对于许多并行 Web 应用程序的用户来说，这样做仍然会导致性能问题，因为会触发更多的垃圾收集器运行。因此，在 Java 中存在由 GC 完成的释放引起的分配的间接成本。这些成本很难量化，因为它们在很大程度上取决于您的设置（您有多少内存）和您的应用程序。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-07-06T09:23:58.777

Java VM 将几乎独立于应用程序代码正在执行的操作从操作系统中声明和释放内存。这允许它以大块的形式获取和释放内存，这比在微小的单个操作中执行此操作要高效得多，就像您通过手动内存管理获得的一样。

[这篇文章](http://www.ibm.com/developerworks/java/library/j-jtp09275.html?ca=dgr-jw22JavaUrbanLegends)写于 2005 年，JVM 风格的内存管理已经遥遥领先。从那时起，情况才有所改善。

> 哪种语言拥有更快的原始分配性能，Java 语言还是 C/C++？答案可能会让您大吃一惊——现代 JVM 中的分配比性能最佳的 malloc 实现要快得多。HotSpot 1.4.2 及更高版本中 new Object() 的公共代码路径大约是 10 条机器指令（数据由 Sun 提供；请参阅参考资料），而 C 中性能最佳的 malloc 实现平均需要每次调用 60 到 100 条指令（ Detlefs 等人；参见参考资料）。并且分配性能并不是整体性能的一个重要组成部分——基准测试表明，许多现实世界的 C 和 C++ 程序，例如 Perl 和 Ghostscript，

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-22T20:44:16.890

在性能方面分配和释放内存是相对昂贵的操作。现代操作系统中的调用必须一直深入到内核，以便操作系统能够处理虚拟内存、分页/映射、执行保护等。

另一方面，几乎所有现代编程语言都将这些操作隐藏在使用预分配缓冲区的“分配器”后面。

大多数关注吞吐量的应用程序也使用此概念。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-23T10:40:45.017

这是 c/c++ 的内存分配系统工作得最好的地方。对于大多数情况，默认分配策略是可以的，但可以根据需要进行更改。在 GC 系统中，您无法更改分配策略。当然，这是要付出代价的，那就是需要跟踪分配并正确释放它们。C++ 更进一步，可以使用 new 运算符为每个类指定分配策略：

```
class AClass
{
public:
  void *operator new (size_t size); // this will be called whenever there's a new AClass
   void *operator new [] (size_t size); // this will be called whenever there's a new AClass []
  void operator delete (void *memory); // if you define new, you really need to define delete as well
  void operator delete [] (void *memory);define delete as well
}; 
```

许多 STL 模板也允许您定义自定义分配器。

与所有与优化有关的事情一样，在编写自己的分配器之前，您必须首先通过运行时分析确定内存分配是否真的是瓶颈。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-03T07:09:06.673

我知道我之前回答过，但是，这是对其他答案的回答，而不是对您的问题的回答。

直接与您交谈，如果我理解正确，您的性能用例标准是吞吐量。

对我来说，这意味着您应该几乎只关注[NUMA](http://developer.amd.com/documentation/articles/pages/4172007166.aspx) [感知](http://software.intel.com/en-us/blogs/2009/03/11/learning-experience-of-numa-and-intels-next-generation-xeon-processor-i/) [分配器](http://developer.amd.com/Assets/AMD_Webcast_2008_RM.pdf)。

没有早期的参考资料；IBM JVM 论文、Microquill C、SUN JVM。涵盖这一点，所以我高度怀疑他们今天的应用，至少在 AMD ABI 上，NUMA 是卓越的内存 CPU 管理器。

把手放下; 真实世界、虚假世界、任何世界……NUMA 感知内存请求/使用技术更快。不幸的是，我目前正在运行 Windows，我还没有找到 linux 中可用的“numastat”。

我的一个[朋友在他对](http://jeffr-tech.livejournal.com/)[FreeBSD](http://www.usenix.org/events/bsdcon03/confrpts.pdf)内核的实现中对此进行了深入的描述。

尽管我能够在远程节点上显示 at-hoc，通常非常大量的本地节点内存请求（强调明显的性能***吞吐量***优势），您可以自己进行基准测试，这可能是您需要做的因为您的表现特征将非常具体。

我确实知道，在很多方面，至少早期的 5.x VMWARE 相当糟糕，至少在那个时候，因为没有利用 NUMA，经常需要来自远程节点的页面。但是，在内存划分或容器化方面，VM 是一种非常独特的野兽。

我引用的参考资料之一是微软针对 AMD ABI 的 API 实现，它具有 NUMA 分配专用接口，供用户土地应用程序开发人员利用；）

这是一些浏览器插件开发人员比较 4 种不同的堆实现的最新[分析，视觉和全部。](http://blog.pavlov.net/2008/03/11/firefox-3-memory-usage/)自然而然地，他们[开发](http://www.canonware.com/~ttt/2007/11/firefox-fragmentation.html)的那个会排在首位（奇怪的是，做测试的人经常表现出最高分）。

他们确实在某些方面可以量化地覆盖，至少对于他们的用例，空间/时间之间的确切权衡是什么，通常他们已经确定了 LFH（哦，顺便说一下，LFH 显然只是标准堆的一种模式）或类似设计的方法本质上会立即消耗更多的内存，但是随着时间的流逝，最终可能会使用更少的内存... grafix也很整洁...

但是，我认为，在您充分理解之后根据您的典型工作负载选择 HEAP 实现；）是一个好主意，但要充分了解您的需求，首先要确保您的基本操作是正确的，然后再优化这些零碎的东西；）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-02T09:08:46.323

根据[MicroQuill SmartHeap 技术规范](http://www.microquill.com/smartheap/sh_tspec.htm#2.4.1)，“一个典型的应用程序 [...] 将其总执行时间的 40% 用于管理内存”。你可以把这个数字作为一个上限，我个人觉得一个典型的应用程序花费了 10-15% 的执行时间来分配/释放内存。它很少成为单线程应用程序的瓶颈。

在多线程 C/C++ 应用程序中，由于锁争用，标准分配器成为一个问题。这是您开始寻找更具可扩展性的解决方案的地方。但请记住[阿姆达尔定律](http://en.wikipedia.org/wiki/Amdahl%27s_law)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-02T11:27:36.797

如果您谈论的是 Microsoft 堆**，**那么几乎所有的人都不在话下。同步化和碎片化一样轻松处理。

当前 perferrred heap 是 LFH，（***LOW*** *FRAGMENTATION* HEAP），它是 vista+ 操作系统的默认值，可以在 XP 上通过 gflag 进行配置，没有太多麻烦

很容易避免任何锁定/阻塞/争用/总线带宽问题以及与

```
HEAP_NO_SERIALIZE 
```

HeapAlloc 或 HeapCreate 期间的选项。这将允许您创建/使用堆而无需进入互锁等待。

我建议使用 HeapCreate 创建几个堆，并定义一个宏，也许是 mallocx(enum my_heaps_set, size_t);

很好，当然，你需要 realloc，free 也可以适当地设置。如果您想花哨，请通过评估指针的地址，甚至添加一些逻辑以允许 malloc 根据其线程 id 识别要使用的堆，并构建 free/realloc 自动检测它自己的堆句柄每个线程堆和共享全局堆/池的层次结构。

Heap* api 由 malloc/new 在内部调用。

这是一篇关于一些动态[内存管理](http://entland.homelinux.com/blog/2008/08/19/practical-efficient-memory-management/)问题的好文章，还有一些更好的[参考资料](http://mconover.openrce.org/)。检测和分析堆活动。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-02T09:31:12.347

其他人已经涵盖了 C/C++，所以我将添加一些关于 .NET 的信息。

在 .NET 中，堆分配通常非常快，因为它只是在堆的第 0 代部分中获取内存。显然这不能永远持续下去，这就是垃圾收集的用武之地。垃圾收集可能会显着影响应用程序的性能，因为在内存压缩期间必须暂停用户线程。完整收集越少越好。

您可以采取多种措施来影响 .NET 中垃圾收集器的工作量。一般来说，如果你有很多内存引用，垃圾收集器将不得不做更多的工作。例如，通过使用邻接矩阵而不是节点之间的引用来实现图，垃圾收集器将不得不分析更少的引用。

这在您的应用程序中是否真正重要取决于几个因素，您应该在转向此类优化之前使用实际数据分析应用程序。

# java - 如何自动生成 N 个“不同”颜色？

> ID：470690
> 
> 赞同：227
> 
> 时间：2009-01-22T20:34:00.127
> 
> 标签：java, colors, color-scheme, color-picker

我编写了以下两种方法来自动选择 N 种不同的颜色。它通过在 RGB 立方体上定义分段线性函数来工作。这样做的好处是，如果您想要的话，您也可以获得渐进式比例，但是当 N 变大时，颜色可能会开始看起来相似。我也可以想象将 RGB 立方体均匀地细分为格子，然后绘制点。有人知道其他方法吗？我排除了定义一个列表，然后只是循环浏览它。我还应该说，我通常不在乎它们是否发生冲突或看起来不好看，它们只需要在视觉上与众不同。

```
public static List<Color> pick(int num) {
    List<Color> colors = new ArrayList<Color>();
    if (num < 2)
        return colors;
    float dx = 1.0f / (float) (num - 1);
    for (int i = 0; i < num; i++) {
        colors.add(get(i * dx));
    }
    return colors;
}

public static Color get(float x) {
    float r = 0.0f;
    float g = 0.0f;
    float b = 1.0f;
    if (x >= 0.0f && x < 0.2f) {
        x = x / 0.2f;
        r = 0.0f;
        g = x;
        b = 1.0f;
    } else if (x >= 0.2f && x < 0.4f) {
        x = (x - 0.2f) / 0.2f;
        r = 0.0f;
        g = 1.0f;
        b = 1.0f - x;
    } else if (x >= 0.4f && x < 0.6f) {
        x = (x - 0.4f) / 0.2f;
        r = x;
        g = 1.0f;
        b = 0.0f;
    } else if (x >= 0.6f && x < 0.8f) {
        x = (x - 0.6f) / 0.2f;
        r = 1.0f;
        g = 1.0f - x;
        b = 0.0f;
    } else if (x >= 0.8f && x <= 1.0f) {
        x = (x - 0.8f) / 0.2f;
        r = 1.0f;
        g = 0.0f;
        b = x;
    }
    return new Color(r, g, b);
} 
```

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2010-12-07T22:06:46.000

这个问题出现在很多SO讨论中：

*   [生成独特颜色的算法](https://stackoverflow.com/questions/1168260/algorithm-for-generating-unique-colors)
*   [生成独特的颜色](https://stackoverflow.com/questions/773226/generate-unique-colours)
*   [在图形中生成明显不同的 RGB 颜色](https://stackoverflow.com/questions/309149/generate-distinctly-different-rgb-colors-in-graphs)
*   [如何为任何自然数 n 生成 n 种不同的颜色？](https://stackoverflow.com/questions/2328339/how-to-generate-n-different-colors-for-any-natural-number-n)

提出了不同的解决方案，但没有一个是最佳的。幸运的是，*科学*来拯救

**任意N**

*   [分类图像的彩色显示](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.65.2790)（免费下载）
*   [个性化地图着色的网络服务](http://icaci.org/documents/ICC_proceedings/ICC2009/html/nonref/13_18.pdf)（免费下载，网络服务解决方案应该在下个月之前可用）
*   [一种用于选择高对比度颜色集的算法](http://onlinelibrary.wiley.com/doi/10.1002/%28SICI%291520-6378%28199904%2924:2%3C132::AID-COL8%3E3.0.CO;2-B/abstract)（作者提供免费的 C++ 实现）
*   [高对比度的颜色集](http://www.opticsinfobase.org/abstract.cfm?URI=ao-21-16-2936)（该问题的第一个算法）

最后两个将通过大多数大学图书馆/代理免费提供。

**N 是有限的并且相对较小**

在这种情况下，可以选择列表解决方案。该主题的一篇非常有趣的文章是免费提供的：

*   [颜色字母表和颜色编码的限制](http://eleanormaclure.files.wordpress.com/2011/03/colour-coding.pdf)

有几个颜色列表需要考虑：

*   Boynton 列出的几乎从不混淆的 11 种颜色（可在上一节的第一篇论文中找到）
*   凯利的 22 色最大对比度（可在上面的论文中找到）

我还遇到了一个麻省理工学院的学生[这个](http://web.media.mit.edu/~wad/color/palette.html)调色板。最后，以下链接可能有助于在不同颜色系统/坐标之间进行转换（例如，文章中的某些颜色未在 RGB 中指定）：

*   [http://chem8.org/uch/space-55036-do-blog-id-5333.html](http://chem8.org/uch/space-55036-do-blog-id-5333.html)
*   [https://metacpan.org/pod/Color::Library::Dictionary::NBS_ISCC](https://metacpan.org/pod/Color::Library::Dictionary::NBS_ISCC)
*   [颜色理论：如何将 Munsell HVC 转换为 RGB/HSB/HSL](https://stackoverflow.com/questions/3620663/color-theory-how-to-convert-munsell-hvc-to-rgb-hsb-hsl/4353544#4353544)

对于 Kelly 和 Boynton 的列表，我已经转换为 RGB（白色和黑色除外，这应该很明显）。一些 C# 代码：

```
public static ReadOnlyCollection<Color> KellysMaxContrastSet
{
    get { return _kellysMaxContrastSet.AsReadOnly(); }
}

private static readonly List<Color> _kellysMaxContrastSet = new List<Color>
{
    UIntToColor(0xFFFFB300), //Vivid Yellow
    UIntToColor(0xFF803E75), //Strong Purple
    UIntToColor(0xFFFF6800), //Vivid Orange
    UIntToColor(0xFFA6BDD7), //Very Light Blue
    UIntToColor(0xFFC10020), //Vivid Red
    UIntToColor(0xFFCEA262), //Grayish Yellow
    UIntToColor(0xFF817066), //Medium Gray

    //The following will not be good for people with defective color vision
    UIntToColor(0xFF007D34), //Vivid Green
    UIntToColor(0xFFF6768E), //Strong Purplish Pink
    UIntToColor(0xFF00538A), //Strong Blue
    UIntToColor(0xFFFF7A5C), //Strong Yellowish Pink
    UIntToColor(0xFF53377A), //Strong Violet
    UIntToColor(0xFFFF8E00), //Vivid Orange Yellow
    UIntToColor(0xFFB32851), //Strong Purplish Red
    UIntToColor(0xFFF4C800), //Vivid Greenish Yellow
    UIntToColor(0xFF7F180D), //Strong Reddish Brown
    UIntToColor(0xFF93AA00), //Vivid Yellowish Green
    UIntToColor(0xFF593315), //Deep Yellowish Brown
    UIntToColor(0xFFF13A13), //Vivid Reddish Orange
    UIntToColor(0xFF232C16), //Dark Olive Green
};

public static ReadOnlyCollection<Color> BoyntonOptimized
{
    get { return _boyntonOptimized.AsReadOnly(); }
}

private static readonly List<Color> _boyntonOptimized = new List<Color>
{
    Color.FromArgb(0, 0, 255),      //Blue
    Color.FromArgb(255, 0, 0),      //Red
    Color.FromArgb(0, 255, 0),      //Green
    Color.FromArgb(255, 255, 0),    //Yellow
    Color.FromArgb(255, 0, 255),    //Magenta
    Color.FromArgb(255, 128, 128),  //Pink
    Color.FromArgb(128, 128, 128),  //Gray
    Color.FromArgb(128, 0, 0),      //Brown
    Color.FromArgb(255, 128, 0),    //Orange
};

static public Color UIntToColor(uint color)
{
    var a = (byte)(color >> 24);
    var r = (byte)(color >> 16);
    var g = (byte)(color >> 8);
    var b = (byte)(color >> 0);
    return Color.FromArgb(a, r, g, b);
} 
```

以下是十六进制和每通道 8 位表示的 RGB 值：

```
kelly_colors_hex = [
    0xFFB300, # Vivid Yellow
    0x803E75, # Strong Purple
    0xFF6800, # Vivid Orange
    0xA6BDD7, # Very Light Blue
    0xC10020, # Vivid Red
    0xCEA262, # Grayish Yellow
    0x817066, # Medium Gray

    # The following don't work well for people with defective color vision
    0x007D34, # Vivid Green
    0xF6768E, # Strong Purplish Pink
    0x00538A, # Strong Blue
    0xFF7A5C, # Strong Yellowish Pink
    0x53377A, # Strong Violet
    0xFF8E00, # Vivid Orange Yellow
    0xB32851, # Strong Purplish Red
    0xF4C800, # Vivid Greenish Yellow
    0x7F180D, # Strong Reddish Brown
    0x93AA00, # Vivid Yellowish Green
    0x593315, # Deep Yellowish Brown
    0xF13A13, # Vivid Reddish Orange
    0x232C16, # Dark Olive Green
    ]

kelly_colors = dict(vivid_yellow=(255, 179, 0),
                    strong_purple=(128, 62, 117),
                    vivid_orange=(255, 104, 0),
                    very_light_blue=(166, 189, 215),
                    vivid_red=(193, 0, 32),
                    grayish_yellow=(206, 162, 98),
                    medium_gray=(129, 112, 102),

                    # these aren't good for people with defective color vision:
                    vivid_green=(0, 125, 52),
                    strong_purplish_pink=(246, 118, 142),
                    strong_blue=(0, 83, 138),
                    strong_yellowish_pink=(255, 122, 92),
                    strong_violet=(83, 55, 122),
                    vivid_orange_yellow=(255, 142, 0),
                    strong_purplish_red=(179, 40, 81),
                    vivid_greenish_yellow=(244, 200, 0),
                    strong_reddish_brown=(127, 24, 13),
                    vivid_yellowish_green=(147, 170, 0),
                    deep_yellowish_brown=(89, 51, 21),
                    vivid_reddish_orange=(241, 58, 19),
                    dark_olive_green=(35, 44, 22)) 
```

对于所有 Java 开发人员，这里是 JavaFX 颜色：

```
// Don't forget to import javafx.scene.paint.Color;

private static final Color[] KELLY_COLORS = {
    Color.web("0xFFB300"),    // Vivid Yellow
    Color.web("0x803E75"),    // Strong Purple
    Color.web("0xFF6800"),    // Vivid Orange
    Color.web("0xA6BDD7"),    // Very Light Blue
    Color.web("0xC10020"),    // Vivid Red
    Color.web("0xCEA262"),    // Grayish Yellow
    Color.web("0x817066"),    // Medium Gray

    Color.web("0x007D34"),    // Vivid Green
    Color.web("0xF6768E"),    // Strong Purplish Pink
    Color.web("0x00538A"),    // Strong Blue
    Color.web("0xFF7A5C"),    // Strong Yellowish Pink
    Color.web("0x53377A"),    // Strong Violet
    Color.web("0xFF8E00"),    // Vivid Orange Yellow
    Color.web("0xB32851"),    // Strong Purplish Red
    Color.web("0xF4C800"),    // Vivid Greenish Yellow
    Color.web("0x7F180D"),    // Strong Reddish Brown
    Color.web("0x93AA00"),    // Vivid Yellowish Green
    Color.web("0x593315"),    // Deep Yellowish Brown
    Color.web("0xF13A13"),    // Vivid Reddish Orange
    Color.web("0x232C16"),    // Dark Olive Green
}; 
```

以下是按上述顺序未分类的凯利颜色。

[![未分类的凯利颜色](https://i.stack.imgur.com/oIczY.png)](https://i.stack.imgur.com/oIczY.png)

以下是根据色调排序的凯利颜色（注意有些黄色不是很对比）

[![分类的凯利颜色](https://i.stack.imgur.com/3lb9t.png)](https://i.stack.imgur.com/3lb9t.png)

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-01-22T20:50:10.030

您可以使用[HSL 颜色模型](http://en.wikipedia.org/wiki/HSL_and_HSV)来创建颜色。

如果您想要的只是不同的色调（可能），以及亮度或饱和度的细微变化，您可以像这样分配色调：

```
// assumes hue [0, 360), saturation [0, 100), lightness [0, 100)

for(i = 0; i < 360; i += 360 / num_colors) {
    HSLColor c;
    c.hue = i;
    c.saturation = 90 + randf() * 10;
    c.lightness = 50 + randf() * 10;

    addColor(c);
} 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2012-12-08T19:35:38.917

就像 Uri Cohen 的回答一样，但它是一个生成器。将从使用相距很远的颜色开始。确定性。

示例，先左颜色： ![样本](https://i.stack.imgur.com/qJcEu.png)

```
#!/usr/bin/env python3
from typing import Iterable, Tuple
import colorsys
import itertools
from fractions import Fraction
from pprint import pprint

def zenos_dichotomy() -> Iterable[Fraction]:
    """
    http://en.wikipedia.org/wiki/1/2_%2B_1/4_%2B_1/8_%2B_1/16_%2B_%C2%B7_%C2%B7_%C2%B7
    """
    for k in itertools.count():
        yield Fraction(1,2**k)

def fracs() -> Iterable[Fraction]:
    """
    [Fraction(0, 1), Fraction(1, 2), Fraction(1, 4), Fraction(3, 4), Fraction(1, 8), Fraction(3, 8), Fraction(5, 8), Fraction(7, 8), Fraction(1, 16), Fraction(3, 16), ...]
    [0.0, 0.5, 0.25, 0.75, 0.125, 0.375, 0.625, 0.875, 0.0625, 0.1875, ...]
    """
    yield Fraction(0)
    for k in zenos_dichotomy():
        i = k.denominator # [1,2,4,8,16,...]
        for j in range(1,i,2):
            yield Fraction(j,i)

# can be used for the v in hsv to map linear values 0..1 to something that looks equidistant
# bias = lambda x: (math.sqrt(x/3)/Fraction(2,3)+Fraction(1,3))/Fraction(6,5)

HSVTuple = Tuple[Fraction, Fraction, Fraction]
RGBTuple = Tuple[float, float, float]

def hue_to_tones(h: Fraction) -> Iterable[HSVTuple]:
    for s in [Fraction(6,10)]: # optionally use range
        for v in [Fraction(8,10),Fraction(5,10)]: # could use range too
            yield (h, s, v) # use bias for v here if you use range

def hsv_to_rgb(x: HSVTuple) -> RGBTuple:
    return colorsys.hsv_to_rgb(*map(float, x))

flatten = itertools.chain.from_iterable

def hsvs() -> Iterable[HSVTuple]:
    return flatten(map(hue_to_tones, fracs()))

def rgbs() -> Iterable[RGBTuple]:
    return map(hsv_to_rgb, hsvs())

def rgb_to_css(x: RGBTuple) -> str:
    uint8tuple = map(lambda y: int(y*255), x)
    return "rgb({},{},{})".format(*uint8tuple)

def css_colors() -> Iterable[str]:
    return map(rgb_to_css, rgbs())

if __name__ == "__main__":
    # sample 100 colors in css format
    sample_colors = list(itertools.islice(css_colors(), 100))
    pprint(sample_colors) 
```

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2012-03-14T11:33:00.770

为了子孙后代，我在这里添加了 Python 中公认的答案。

```
import numpy as np
import colorsys

def _get_colors(num_colors):
    colors=[]
    for i in np.arange(0., 360., 360\. / num_colors):
        hue = i/360.
        lightness = (50 + np.random.rand() * 10)/100.
        saturation = (90 + np.random.rand() * 10)/100.
        colors.append(colorsys.hls_to_rgb(hue, lightness, saturation))
    return colors 
```

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2009-01-22T21:26:16.463

这是一个想法。想象一个 HSV 气缸

![](https://upload.wikimedia.org/wikipedia/commons/8/8f/HSV_cylinder.jpg)

定义您想要的亮度和饱和度的上限和下限。这在空间内定义了一个方形横截面环。

现在，在这个空间内随机散布 N 个点。

然后对它们应用迭代排斥算法，要么进行固定次数的迭代，要么直到点稳定。

现在你应该有 N 个点代表 N 种颜色，它们在你感兴趣的颜色空间中尽可能不同。

雨果

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2015-06-17T01:51:21.300

每个人似乎都错过了非常有用的 YUV 颜色空间的存在，它旨在表示人类视觉系统中感知到的颜色差异。YUV 中的距离代表人类感知的差异。我需要 MagicCube4D 的这个功能，它实现了 4 维魔方和无限数量的其他具有任意数量面孔的 4D 曲折谜题。

我的解决方案首先在 YUV 中选择随机点，然后迭代分解最接近的两个点，并仅在返回结果时转换为 RGB。该方法是 O(n^3) 但这对于小数字或可以缓存的数字并不重要。它当然可以提高效率，但结果似乎非常好。

该功能允许可选地指定亮度阈值，以免产生没有成分比给定量更亮或更暗的颜色。IE 你可能不想要接近黑色或白色的值。当生成的颜色将用作稍后通过照明、分层、透明度等进行着色并且必须仍然与其基色不同时，这很有用。

```
import java.awt.Color;
import java.util.Random;

/**
 * Contains a method to generate N visually distinct colors and helper methods.
 * 
 * @author Melinda Green
 */
public class ColorUtils {
    private ColorUtils() {} // To disallow instantiation.
    private final static float
        U_OFF = .436f,
        V_OFF = .615f;
    private static final long RAND_SEED = 0;
    private static Random rand = new Random(RAND_SEED);    

    /*
     * Returns an array of ncolors RGB triplets such that each is as unique from the rest as possible
     * and each color has at least one component greater than minComponent and one less than maxComponent.
     * Use min == 1 and max == 0 to include the full RGB color range.
     * 
     * Warning: O N^2 algorithm blows up fast for more than 100 colors.
     */
    public static Color[] generateVisuallyDistinctColors(int ncolors, float minComponent, float maxComponent) {
        rand.setSeed(RAND_SEED); // So that we get consistent results for each combination of inputs

        float[][] yuv = new float[ncolors][3];

        // initialize array with random colors
        for(int got = 0; got < ncolors;) {
            System.arraycopy(randYUVinRGBRange(minComponent, maxComponent), 0, yuv[got++], 0, 3);
        }
        // continually break up the worst-fit color pair until we get tired of searching
        for(int c = 0; c < ncolors * 1000; c++) {
            float worst = 8888;
            int worstID = 0;
            for(int i = 1; i < yuv.length; i++) {
                for(int j = 0; j < i; j++) {
                    float dist = sqrdist(yuv[i], yuv[j]);
                    if(dist < worst) {
                        worst = dist;
                        worstID = i;
                    }
                }
            }
            float[] best = randYUVBetterThan(worst, minComponent, maxComponent, yuv);
            if(best == null)
                break;
            else
                yuv[worstID] = best;
        }

        Color[] rgbs = new Color[yuv.length];
        for(int i = 0; i < yuv.length; i++) {
            float[] rgb = new float[3];
            yuv2rgb(yuv[i][0], yuv[i][1], yuv[i][2], rgb);
            rgbs[i] = new Color(rgb[0], rgb[1], rgb[2]);
            //System.out.println(rgb[i][0] + "\t" + rgb[i][1] + "\t" + rgb[i][2]);
        }

        return rgbs;
    }

    public static void hsv2rgb(float h, float s, float v, float[] rgb) {
        // H is given on [0->6] or -1\. S and V are given on [0->1]. 
        // RGB are each returned on [0->1]. 
        float m, n, f;
        int i;

        float[] hsv = new float[3];

        hsv[0] = h;
        hsv[1] = s;
        hsv[2] = v;
        System.out.println("H: " + h + " S: " + s + " V:" + v);
        if(hsv[0] == -1) {
            rgb[0] = rgb[1] = rgb[2] = hsv[2];
            return;
        }
        i = (int) (Math.floor(hsv[0]));
        f = hsv[0] - i;
        if(i % 2 == 0)
            f = 1 - f; // if i is even 
        m = hsv[2] * (1 - hsv[1]);
        n = hsv[2] * (1 - hsv[1] * f);
        switch(i) {
            case 6:
            case 0:
                rgb[0] = hsv[2];
                rgb[1] = n;
                rgb[2] = m;
                break;
            case 1:
                rgb[0] = n;
                rgb[1] = hsv[2];
                rgb[2] = m;
                break;
            case 2:
                rgb[0] = m;
                rgb[1] = hsv[2];
                rgb[2] = n;
                break;
            case 3:
                rgb[0] = m;
                rgb[1] = n;
                rgb[2] = hsv[2];
                break;
            case 4:
                rgb[0] = n;
                rgb[1] = m;
                rgb[2] = hsv[2];
                break;
            case 5:
                rgb[0] = hsv[2];
                rgb[1] = m;
                rgb[2] = n;
                break;
        }
    }

    // From http://en.wikipedia.org/wiki/YUV#Mathematical_derivations_and_formulas
    public static void yuv2rgb(float y, float u, float v, float[] rgb) {
        rgb[0] = 1 * y + 0 * u + 1.13983f * v;
        rgb[1] = 1 * y + -.39465f * u + -.58060f * v;
        rgb[2] = 1 * y + 2.03211f * u + 0 * v;
    }

    public static void rgb2yuv(float r, float g, float b, float[] yuv) {
        yuv[0] = .299f * r + .587f * g + .114f * b;
        yuv[1] = -.14713f * r + -.28886f * g + .436f * b;
        yuv[2] = .615f * r + -.51499f * g + -.10001f * b;
    }

    private static float[] randYUVinRGBRange(float minComponent, float maxComponent) {
        while(true) {
            float y = rand.nextFloat(); // * YFRAC + 1-YFRAC);
            float u = rand.nextFloat() * 2 * U_OFF - U_OFF;
            float v = rand.nextFloat() * 2 * V_OFF - V_OFF;
            float[] rgb = new float[3];
            yuv2rgb(y, u, v, rgb);
            float r = rgb[0], g = rgb[1], b = rgb[2];
            if(0 <= r && r <= 1 &&
                0 <= g && g <= 1 &&
                0 <= b && b <= 1 &&
                (r > minComponent || g > minComponent || b > minComponent) && // don't want all dark components
                (r < maxComponent || g < maxComponent || b < maxComponent)) // don't want all light components

                return new float[]{y, u, v};
        }
    }

    private static float sqrdist(float[] a, float[] b) {
        float sum = 0;
        for(int i = 0; i < a.length; i++) {
            float diff = a[i] - b[i];
            sum += diff * diff;
        }
        return sum;
    }

    private static double worstFit(Color[] colors) {
        float worst = 8888;
        float[] a = new float[3], b = new float[3];
        for(int i = 1; i < colors.length; i++) {
            colors[i].getColorComponents(a);
            for(int j = 0; j < i; j++) {
                colors[j].getColorComponents(b);
                float dist = sqrdist(a, b);
                if(dist < worst) {
                    worst = dist;
                }
            }
        }
        return Math.sqrt(worst);
    }

    private static float[] randYUVBetterThan(float bestDistSqrd, float minComponent, float maxComponent, float[][] in) {
        for(int attempt = 1; attempt < 100 * in.length; attempt++) {
            float[] candidate = randYUVinRGBRange(minComponent, maxComponent);
            boolean good = true;
            for(int i = 0; i < in.length; i++)
                if(sqrdist(candidate, in[i]) < bestDistSqrd)
                    good = false;
            if(good)
                return candidate;
        }
        return null; // after a bunch of passes, couldn't find a candidate that beat the best.
    }

    /**
     * Simple example program.
     */
    public static void main(String[] args) {
        final int ncolors = 10;
        Color[] colors = generateVisuallyDistinctColors(ncolors, .8f, .3f);
        for(int i = 0; i < colors.length; i++) {
            System.out.println(colors[i].toString());
        }
        System.out.println("Worst fit color = " + worstFit(colors));
    }

} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2018-11-16T05:09:44.917

HSL 颜色模型可能非常适合“分类”颜色，但如果您正在寻找视觉上不同的颜色，您肯定需要[Lab](https://en.wikipedia.org/wiki/CIELAB_color_space)颜色模型。

> CIELAB 被设计为在人类色觉方面在感知上是一致的，这意味着这些值中相同数量的数值变化对应于大约相同数量的视觉感知变化。

一旦你知道了，从各种颜色中找到 N 颜色的最优子集仍然是一个（NP）难题，有点类似于[旅行商问题](https://en.wikipedia.org/wiki/Travelling_salesman_problem)，所有使用 k-mean 算法或其他东西的解决方案都不会真正帮助。

也就是说，如果 N 不太大，并且如果您从一组有限的颜色开始，您将很容易根据具有简单随机函数的 Lab 距离找到一个非常好的不同颜色子集。

我已经编写了这样一个工具供我自己使用（你可以在这里找到它：[https](https://mokole.com/palette.html) ://mokole.com/palette.html ），这是我为 N=7 得到的： [![在此处输入图像描述](https://i.stack.imgur.com/q2TdR.png)](https://i.stack.imgur.com/q2TdR.png)

这都是 javascript，所以请随意查看页面的源代码并根据自己的需要进行调整。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-22T21:51:25.010

这是管理您的“独特”问题的解决方案，这完全被夸大了：

创建一个单位球体并在其上放置具有排斥电荷的点。运行粒子系统，直到它们不再移动（或增量“足够小”）。此时，每个点都尽可能远离彼此。将 (x, y, z) 转换为 rgb。

我提到它是因为对于某些类别的问题，这种类型的解决方案比蛮力更有效。

我最初在[这里看到了这种](http://traipse.com/nine/)用于镶嵌球体的方法。

同样，遍历 HSL 空间或 RGB 空间的最明显的解决方案可能会正常工作。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2021-07-16T19:57:13.770

那里有很多非常好的答案，但如果有人正在寻找快速的 Python 解决方案，提及 python 包[distinctify可能会很有用。](https://pypi.org/project/distinctipy/)它是 pypi 提供的一个轻量级包，使用起来非常简单：

```
from distinctipy import distinctipy

colors = distinctipy.get_colors(12)

print(colors)

# display the colours
distinctipy.color_swatch(colors) 
```

它返回一个 rgb 元组列表

```
[(0, 1, 0), (1, 0, 1), (0, 0.5, 1), (1, 0.5, 0), (0.5, 0.75, 0.5), (0.4552518132842178, 0.12660764790179446, 0.5467915225460569), (1, 0, 0), (0.12076092516775849, 0.9942188027771208, 0.9239958090462229), (0.254747094970068, 0.4768020779917903, 0.02444859177890535), (0.7854526395841417, 0.48630704929211144, 0.9902480906347156), (0, 0, 1), (1, 1, 0)] 
```

[![在此处输入图像描述](https://i.stack.imgur.com/GDkJv.png)](https://i.stack.imgur.com/GDkJv.png)

它还具有一些额外的不错的功能，例如生成与现有颜色列表不同的颜色。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-03-06T06:57:39.520

我会尝试将饱和度和亮度固定到最大，只关注色调。如我所见，H 可以从 0 变为 255，然后回绕。现在，如果您想要两种对比色，您将采用该环的相对两侧，即 0 和 128。如果您想要 4 种颜色，您将采用相隔 1/4 的圆 256 长度的一些颜色，即 0、64,128,192。当然，正如其他人建议的那样，当您需要 N 种颜色时，您可以将它们分开 256/N。

我对这个想法的补充是使用二进制数的反向表示来形成这个序列。看这个：

```
0 = 00000000  after reversal is 00000000 = 0
1 = 00000001  after reversal is 10000000 = 128
2 = 00000010  after reversal is 01000000 = 64
3 = 00000011  after reversal is 11000000 = 192 
```

...这样，如果您需要 N 种不同的颜色，您可以只取前 N 个数字，将它们反转，并且您获得尽可能多的远点（因为 N 是 2 的幂），同时保留每个前缀顺序差别很大。

这是我的用例中的一个重要目标，因为我有一个图表，其中颜色按该颜色覆盖的区域排序。我希望图表的最大区域具有较大的对比度，并且我可以让一些小区域具有与前 10 名相似的颜色，因为读者只需观察该区域就可以清楚地知道哪个是哪个。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-06-24T20:51:26.223

我们只需要一系列 RGB 三元组对，这些三元组之间的距离最大。

我们可以定义一个简单的线性渐变，然后调整该渐变的大小以获得所需的颜色数量。

在蟒蛇中：

```
def distinguishable_colors(n, shuffle = True, 
                           sinusoidal = False,
                           oscillate_tone = False): 
    ramp = ([1, 0, 0],[1,1,0],[0,1,0],[0,0,1], [1,0,1]) if n>3 else ([1,0,0], [0,1,0],[0,0,1])

    coltrio = np.vstack(ramp)

    colmap = np.round(resize(coltrio, [n,3], preserve_range=True, 
                             order = 1 if n>3 else 3
                             , mode = 'wrap'),3)

    if sinusoidal: colmap = np.sin(colmap*np.pi/2)

    colmap = [colmap[x,] for x  in range(colmap.shape[0])]

    if oscillate_tone:
        oscillate = [0,1]*round(len(colmap)/2+.5)
        oscillate = [np.array([osc,osc,osc]) for osc in oscillate]
        colmap = [.8*colmap[x] + .2*oscillate[x] for x in range(len(colmap))]

    #Whether to shuffle the output colors
    if shuffle:
        random.seed(1)
        random.shuffle(colmap)

    return colmap 
```

[![在此处输入图像描述](https://i.stack.imgur.com/O5IhW.png)](https://i.stack.imgur.com/O5IhW.png)

[![在此处输入图像描述](https://i.stack.imgur.com/4NbkR.png)](https://i.stack.imgur.com/4NbkR.png)

[![在此处输入图像描述](https://i.stack.imgur.com/3pwFy.png)](https://i.stack.imgur.com/3pwFy.png)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-22T20:43:11.433

如果 N 足够大，您将获得一些外观相似的颜色。世界上只有这么多。

为什么不将它们均匀地分布在频谱中，如下所示：

```
IEnumerable<Color> CreateUniqueColors(int nColors)
{
    int subdivision = (int)Math.Floor(Math.Pow(nColors, 1/3d));
    for(int r = 0; r < 255; r += subdivision)
        for(int g = 0; g < 255; g += subdivision)
            for(int b = 0; b < 255; b += subdivision)
                yield return Color.FromArgb(r, g, b);
} 
```

如果您想混合序列以使相似的颜色不会彼此相邻，您可能会打乱结果列表。

我在想这个吗？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-07-09T06:40:54.347

这在 MATLAB 中是微不足道的（有一个 hsv 命令）：

```
cmap = hsv(number_of_colors) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-11-02T17:32:13.580

我为 R 编写了一个名为[qualpalr](https://CRAN.R-project.org/package=qualpalr)的包，专门为此目的而设计。我建议您查看[小插图](https://cran.r-project.org/web/packages/qualpalr/vignettes/introduction.html)以了解其工作原理，但我将尝试总结要点。

qualpalr 采用[HSL 颜色空间](https://en.wikipedia.org/wiki/HSL_and_HSV)中的颜色规范（之前在此线程中进行了描述），将其投影到 DIN99d 颜色空间（在感知上是均匀的）并找到`n`使任何 oif 之间的最小距离最大化的颜色。

```
# Create a palette of 4 colors of hues from 0 to 360, saturations between
# 0.1 and 0.5, and lightness from 0.6 to 0.85
pal <- qualpal(n = 4, list(h = c(0, 360), s = c(0.1, 0.5), l = c(0.6, 0.85)))

# Look at the colors in hex format
pal$hex
#> [1] "#6F75CE" "#CC6B76" "#CAC16A" "#76D0D0"

# Create a palette using one of the predefined color subspaces
pal2 <- qualpal(n = 4, colorspace = "pretty")

# Distance matrix of the DIN99d color differences
pal2$de_DIN99d
#>        #69A3CC #6ECC6E #CA6BC4
#> 6ECC6E      22                
#> CA6BC4      21      30        
#> CD976B      24      21      21

plot(pal2) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/xxPal.png)](https://i.stack.imgur.com/xxPal.png)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-02-08T13:12:26.710

我认为这个简单的递归算法补充了公认的答案，以生成不同的色调值。我为 hsv 制作了它，但也可以用于其他颜色空间。

它在循环中生成色调，在每个循环中尽可能地相互分离。

```
/**
 * 1st cycle: 0, 120, 240
 * 2nd cycle (+60): 60, 180, 300
 * 3th cycle (+30): 30, 150, 270, 90, 210, 330
 * 4th cycle (+15): 15, 135, 255, 75, 195, 315, 45, 165, 285, 105, 225, 345
 */
public static float recursiveHue(int n) {
    // if 3: alternates red, green, blue variations
    float firstCycle = 3;

    // First cycle
    if (n < firstCycle) {
        return n * 360f / firstCycle;
    }
    // Each cycle has as much values as all previous cycles summed (powers of 2)
    else {
        // floor of log base 2
        int numCycles = (int)Math.floor(Math.log(n / firstCycle) / Math.log(2));
        // divDown stores the larger power of 2 that is still lower than n
        int divDown = (int)(firstCycle * Math.pow(2, numCycles));
        // same hues than previous cycle, but summing an offset (half than previous cycle)
        return recursiveHue(n % divDown) + 180f / divDown;
    }
} 
```

我在这里找不到这种算法。希望对你有帮助，这是我在这里的第一篇文章。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-01-25T07:31:31.497

对于 Python 用户来说， [seaborn 非常](https://seaborn.pydata.org/generated/seaborn.color_palette.html)简洁：

```
>>> import seaborn as sns
>>> sns.color_palette(n_colors=4) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/8ucB1.png)](https://i.stack.imgur.com/8ucB1.png)
它返回 RGB 元组列表：

```
[(0.12156862745098039, 0.4666666666666667, 0.7058823529411765),
(1.0, 0.4980392156862745, 0.054901960784313725),
(0.17254901960784313, 0.6274509803921569, 0.17254901960784313),
(0.8392156862745098, 0.15294117647058825, 0.1568627450980392)] 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-13T13:12:01.600

`n`此 OpenCV 函数使用 HSV 颜色模型在 0<=H<=360º 周围生成均匀分布的颜色，最大 S=1.0 和 V=1.0。该函数输出 BGR 颜色`bgr_mat`：

```
void distributed_colors (int n, cv::Mat_<cv::Vec3f> & bgr_mat) {
  cv::Mat_<cv::Vec3f> hsv_mat(n,CV_32F,cv::Vec3f(0.0,1.0,1.0));
  double step = 360.0/n;
  double h= 0.0;
  cv::Vec3f value;
  for (int i=0;i<n;i++,h+=step) {
    value = hsv_mat.at<cv::Vec3f>(i);
    hsv_mat.at<cv::Vec3f>(i)[0] = h;
  }
  cv::cvtColor(hsv_mat, bgr_mat, CV_HSV2BGR);
  bgr_mat *= 255;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-07-14T23:36:59.893

Janus 的答案，但更容易阅读。我还稍微调整了配色方案并标记了您可以自己修改的位置

我已将此片段直接粘贴到 jupyter 笔记本中。

```
import colorsys
import itertools
from fractions import Fraction
from IPython.display import HTML as html_print

def infinite_hues():
    yield Fraction(0)
    for k in itertools.count():
        i = 2**k # zenos_dichotomy
        for j in range(1,i,2):
            yield Fraction(j,i)

def hue_to_hsvs(h: Fraction):
    # tweak values to adjust scheme
    for s in [Fraction(6,10)]:
        for v in [Fraction(6,10), Fraction(9,10)]: 
            yield (h, s, v) 

def rgb_to_css(rgb) -> str:
    uint8tuple = map(lambda y: int(y*255), rgb)
    return "rgb({},{},{})".format(*uint8tuple)

def css_to_html(css):
    return f"<text style=background-color:{css}>&nbsp;&nbsp;&nbsp;&nbsp;</text>"

def show_colors(n=33):
    hues = infinite_hues()
    hsvs = itertools.chain.from_iterable(hue_to_hsvs(hue) for hue in hues)
    rgbs = (colorsys.hsv_to_rgb(*hsv) for hsv in hsvs)
    csss = (rgb_to_css(rgb) for rgb in rgbs)
    htmls = (css_to_html(css) for css in csss)

    myhtmls = itertools.islice(htmls, n)
    display(html_print("".join(myhtmls)))

show_colors() 
```

[![颜色](https://i.stack.imgur.com/Mz1gf.png)](https://i.stack.imgur.com/Mz1gf.png)

# delphi - 在弹出菜单的禁用菜单项上显示工具提示提示

> ID：470696
> 
> 赞同：6
> 
> 时间：2009-01-22T20:37:32.100
> 
> 标签：delphi, user-interface, delphi-2007, tooltip

所以我有一个 TMenuItem 附加到 TDBGrid 的 TPopupMenu 上的 TAction （实际上是第 3 方，但你明白了）。根据网格中选定的行，启用或禁用 TAction。我想要的是能够向用户显示一个提示，解释为什么该项目被禁用。

至于为什么我想要一个禁用菜单项的提示，可以说我[同意 Joel](https://stackoverflow.com/questions/79033/rules-about-disabling-or-hiding-menu-items#79068)。

所有 TMenuItem 都有一个提示属性，但尽我所能告诉他们，它们仅使用 TApplicationEvent.OnHint 事件处理程序将提示粘贴在 TStatusBar 或其他一些特殊处理中。我[找到了一篇](http://delphi.about.com/od/vclusing/a/menuitemhints.htm)关于如何为 TMainMenu 的 TMenuItems 创建自己的偶数窗口的文章，但它不适用于 TPopupMenu 的 TMenuItem。它通过处理 WM_MENUSELECT 消息来工作，据我所知，该消息不是在 TPopupMenu 上发送的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T22:18:20.680

WM_MENUSELECT 确实也为弹出菜单中的菜单项处理，但不是由包含（弹出）菜单的窗体的 windows proc 处理，而是由 Menus.PopupList 创建的不可见帮助窗口处理。幸运的是，您可以（至少在 Delphi 5 下）通过 Menus.PopupList.Window 获得这个 HWND。

现在，您可以使用老式方法对窗口进行子类化，如[CodeGear 文章](http://dn.codegear.com/article/27295)中所述，也可以为弹出菜单处理 WM_MENUSELECT。HWND 将在第一个 TPopupMenu 创建之后到最后一个 TPopupMenu 对象被销毁之前有效。

对问题中链接文章中的演示应用程序进行快速测试应该可以揭示这是否可行。

**编辑：**它确实有效。我更改[了链接示例](http://delphi.about.com/od/vclusing/a/menuitemhints.htm)以显示弹出菜单的提示。以下是步骤：

将 OnDestroy 的处理程序、旧窗口 proc 的成员变量和新窗口 proc 的方法添加到表单：

```
TForm1 = class(TForm)
  ...
  procedure FormCreate(Sender: TObject);
  procedure FormDestroy(Sender: TObject);
  procedure ApplicationEvents1Hint(Sender: TObject);
private
  miHint : TMenuItemHint;
  fOldWndProc: TFarProc;
  procedure WMMenuSelect(var Msg: TWMMenuSelect); message WM_MENUSELECT;
  procedure PopupListWndProc(var AMsg: TMessage);
end; 
```

将表单的 OnCreate 处理程序更改为隐藏 PopupList 窗口的子类，并在 OnDestroy 处理程序中实现窗口 proc 的正确恢复：

```
procedure TForm1.FormCreate(Sender: TObject);
var
  NewWndProc: TFarProc;
begin
  miHint := TMenuItemHint.Create(self);

  NewWndProc := MakeObjectInstance(PopupListWndProc);
  fOldWndProc := TFarProc(SetWindowLong(Menus.PopupList.Window, GWL_WNDPROC,
    integer(NewWndProc)));
end;

procedure TForm1.FormDestroy(Sender: TObject);
var
  NewWndProc: TFarProc;
begin
  NewWndProc := TFarProc(SetWindowLong(Menus.PopupList.Window, GWL_WNDPROC,
    integer(fOldWndProc)));
  FreeObjectInstance(NewWndProc);
end; 
```

实现子类窗口过程：

```
procedure TForm1.PopupListWndProc(var AMsg: TMessage);

  function FindItemForCommand(APopupMenu: TPopupMenu;
    const AMenuMsg: TWMMenuSelect): TMenuItem;
  var
    SubMenu: HMENU;
  begin
    Assert(APopupMenu <> nil);
    // menuitem
    Result := APopupMenu.FindItem(AMenuMsg.IDItem, fkCommand);
    if Result = nil then begin
      // submenu
      SubMenu := GetSubMenu(AMenuMsg.Menu, AMenuMsg.IDItem);
      if SubMenu <> 0 then
        Result := APopupMenu.FindItem(SubMenu, fkHandle);
    end;
  end;

var
  Msg: TWMMenuSelect;
  menuItem: TMenuItem;
  MenuIndex: integer;
begin
  AMsg.Result := CallWindowProc(fOldWndProc, Menus.PopupList.Window,
    AMsg.Msg, AMsg.WParam, AMsg.LParam);
  if AMsg.Msg = WM_MENUSELECT then begin
    menuItem := nil;
    Msg := TWMMenuSelect(AMsg);
    if (Msg.MenuFlag <> $FFFF) or (Msg.IDItem <> 0) then begin
      for MenuIndex := 0 to PopupList.Count - 1 do begin
        menuItem := FindItemForCommand(PopupList.Items[MenuIndex], Msg);
        if menuItem <> nil then
          break;
      end;
    end;
    miHint.DoActivateHint(menuItem);
  end;
end; 
```

对循环中的所有弹出菜单执行此操作，直到找到第一个匹配项或子菜单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T20:53:57.200

不确定它是否有帮助，但我创建了自己的多行提示窗口（用于 Delphi7），以便能够显示多于一行的文本。它是开源的，你可以在[这里](https://monex.svn.sourceforge.net/svnroot/monex/trunk/Komponente/KalkulatorEdit/MultiLineHint.pas)找到它。

在屏幕上的正确位置显示它涉及一些工作，但您可以完全控制它。

# c# - 开发具有高质量视频流的视频聊天应用程序

> ID：470698
> 
> 赞同：20
> 
> 时间：2009-01-22T20:38:07.323
> 
> 标签：c#, video, streaming, chat

我在一家公司工作，我们正在为现有应用程序开发视频聊天支持。我已经查看了各种解决方案，例如

1.  在 C# 中使用 Managed Direct show 进行视频捕获和流式传输
2.  代码项目中的一些代码示例，我们在其中获取图像并通过网络传递（我将其称为相当粗略的解决方案，因为这会占用大量带宽。
3.  从头开始编写压缩算法并使用它来压缩-解压缩视频。

现在的挑战是我们正在寻求实现非常高质量的视频流，并且容器应用程序是用 C#.NET 编码的

这是我迄今为止提出的。流数据的网络逻辑是用 C# 编写的，视频压缩是用 VC++ 编写的，并使用 pinvoke 或 CLI 调用这个 VC++ dll 可能的方式。

我正在寻找一个比我在这个领域更有经验的人，如果我是正确的，或者这仍然可以改进，他们可以建议我。

最终目标是高质量的视频流。编解码器可以是 h.2633、h.264 等任何东西。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-12-26T10:13:16.507

我已经使用了几种方法来轻松地使用 .net 获得视频流/会议，而无需深入研究 directshow。（好吧，挖一些，但不深:)

1) 使用普通的 Windows Media Encoder 组件。它与 Windows Media Encoder SDK 中的示例一起记录。适用于任何高分辨率流媒体，但对于实时聊天来说延迟太大（最多 0.5-2 秒）。Modern Express Encoder SDK 另一种选择。

2) Microsoft Research ConferenceXP [http://cct.cs.washington.edu/](http://cct.cs.washington.edu/)全功能会议 API，包括应用程序流。它们太低级 Windows Media 编码过滤器并将它们包装到托管代码中。效果很好。轻松定制。现在看起来有点废弃了。

3) Microsoft RTC Client 最高版本 1.3 - windows messenger 的核心。

优点：来自 Microsoft 的托管示例、良好的文档、可靠的性能、可自由再分发、与 Microsoft 兼容（良好）的 SIP 堆栈。像 Emblaze VCON 这样的主要会议供应商在不久的将来基于它的解决方案，现在还不确定，但我知道 Tandberg 获得了 Microsft 的 VC-1 的许可。

缺点：最高 1.3 的版本仅支持 h261-h263 视频。支持 VC-1(h264) 编解码器的现代版本不允许直接无服务器 ip-ip 连接。它确实需要 Microsoft Live Communications 服务器。较新版本的 SDK 不能很好地覆盖视频会议通话。

[http://msdn.microsoft.com/en-us/library/ms775892(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms775892(VS.85).aspx)

请告诉我们您选择的平台。顺便说一句，我什至将 ConferenceXP 视频 rtp 部分与 RTC 1.3 语音/SIP 功能一起使用以提高视频质量，因此您可以在这里选择多种托管技术。另一件事是 Live Meeting，我还没有机会好好看看。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-03T23:29:09.330

省去麻烦并使用 VLC。有一些不错的 .NET 包装器（[http://forum.videolan.org/viewtopic.php?f=32&t=52021&start=30](http://forum.videolan.org/viewtopic.php?f=32&t=52021&start=30)）

我们将 C# 和 VLC 用于 IPTV 网络。我们通过 Windows XP 服务器上的 Osprey-450 视频捕获设备从 DISH 网络卫星中获取输入。从那里，我们有一个用 C# 编写的 .NET 服务器组件，它在后台使用 VLC（在 .NET 中启动单独的进程来控制 vlc.exe 实例）。VLC 处理转码并通过网络传输信号（.h264 或 MPEG-4，我们都成功地完成了）。

在客户端，我们有一个 C# WinForm 应用程序，它使用嵌入式 VLC 查看器来查看多播信号。此应用程序主要用于命令和控制。当我们连接到电视的机顶盒解码和显示流时，才会真正使用多播信号。

我们认为我们也必须编写自己的 DirectX 编码器，但不要费尽心思。VLC 工作得非常好，并且有足够的 C# 支持非常有用。如果您对实施有具体问题，请随时给我发电子邮件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-05-30T17:12:23.467

您应该查看 Ucentrik SDK。此 SDK 将使您能够在您的应用程序中集成富媒体功能，例如视频、音频、聊天、远程桌面共享和控制以及视频录制。支持的视频编解码器是 VP8 (Google)、Theora 和 x.264。此外，富媒体流量被封装在 HTTP 协议中，使其能够穿越支持正常 Web 流量的防火墙。该技术是完全免费的，您可以下载 SDK 并请求 API 密钥，这样您就可以进行评估，而无需花费任何时间来设置基础设施。在接下来的几个月中，我们将发布一个服务器组件，以便您可以下载和托管您自己或您的客户的基础架构。该技术支持一对多连接，这意味着您可以根据需要创建视频会议。这些功能是高度模块化的，因此您可以使用相同的 SDK 仅集成视频或音频或桌面共享或技术组合......您应该在此处请求可用的 SDK：www.ucentrik.com。此外，这里还有一些视频： [http://www.youtube.com/user/ucentrik](http://www.youtube.com/user/ucentrik)

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-07T02:32:41.640

Ucentrik 刚刚发布了一个集成了 CTX 技术的开源呼叫中心应用程序。此呼叫中心应用程序实现了 CTX API 提供的视频、音频、桌面/应用程序共享（带控制）、文本聊天功能。该应用程序还包括一些业务逻辑，专门围绕提供将呼叫路由到可用或具有特定技能集的代理的能力。该项目可在[http://vcca.codeplex.com](http://vcca.codeplex.com)获得- 请注意，您需要访问 Ucentrik CTX SDK，该 SDK 可在 Ucentrik 网站 (www.ucentrik.com) 上索取。祝你好运。

# css - CSS 选择器 CSS有什么办法可以根据输入的类型来定位所有输入吗？我有一个用于各种禁用表单元素的禁用类，我正在为文本框设置背景颜色，但我不希望我的复选框获得那种颜色。 我知道我可以用单独的类来做到这一点，但如果可能的话，我宁愿使用 CSS。我敢肯定，我可以在 javascript 中设置它，但再次寻找 CSS。 我的目标是IE7 +。所以我不认为我可以使用 CSS3。 问问题 Josh 问问题 2009-01-22T20:39:43.843 138803 次 This question shows research effort; it is useful and clear 108 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. CSS有什么办法可以根据输入的类型来定位所有输入吗？我有一个用于各种禁用表单元素的禁用类，我正在为文本框设置背景颜色，但我不希望我的复选框获得那种颜色。 我知道我可以用单独的类来做到这一点，但如果可能的话，我宁愿使用 CSS。我敢肯定，我可以在 javascript 中设置它，但再次寻找 CSS。 我的目标是IE7 +。所以我不认为我可以使用 CSS3。 编辑 使用 CSS3 我可以做类似的事情吗？ INPUT[type='text']:disabled那会更好地完全摆脱我的课... 编辑 好的，感谢您的帮助！所以这是一个选择器，它可以修改所有已禁用的文本框和区域，而无需设置任何类，当我开始这个问题时，我从没想过这是可能的...... INPUT[disabled][type='text'], TEXTAREA[disabled] { background-color: Silver; } 这适用于 IE7 抱歉，简短的回答是否定的。CSS (2.1) 只会标记 DOM 的元素，而不是它们的属性。您必须对每个输入应用一个特定的类。 我知道这很糟糕，因为那将非常有用。 我知道你说过你更喜欢 CSS 而不是 JavaScript，但你仍然应该考虑使用 jQuery。它提供了一种非常简洁优雅的方式来基于属性向 DOM 元素添加样式。 cssinternet-explorercss-selectors 4 4 回答 4 This answer is useful 159 是的。IE7+ 支持属性选择器： input[type=radio] input[type^=ra] input[type*=d] input[type$=io] 具有属性类型的元素输入，其包含等于、开始、包含或结束于某个值的值。 其他安全 (IE7+) 选择器有： 父母 > 孩子有：p > span { font-weight: bold; } 前面有 ~ 元素，即：span ~ span { color: blue; } 哪个 for<p><span/><span/></p>会有效地给你： <p> <span style="font-weight: bold;"> <span style="font-weight: bold; color: blue;"> </p> 进一步阅读： quirksmode.com 上的浏览 器 CSS 兼容性 我很惊讶其他人都认为这是不可能的。CSS 属性选择器已经出现了一段时间。我想是时候清理我们的 .css 文件了。 于 2009-01-22T21:00:26.563 回答 This answer is useful 3 可悲的是，其他海报是正确的，您 ...实际上已被 kRON 纠正，您对 IE7 和严格的文档没问题，但我们大多数有 IE6 要求的人都被简化为 JS 或类引用，但它是一个 CSS2 属性，只是一个没有 IE^h^h 浏览器足够支持的属性。 出于完整性考虑，类型选择器是 - 类似于 xpath - 的形式[attribute=value]，但存在许多有趣的变体。当它可用时，它会非常强大，记住 IE8 是件好事。 w3 参考 浏览器支持参考 于 2009-01-22T20:55:02.953 回答 This answer is useful 1 你可以用 jQuery 做到这一点。使用它们的选择器，您可以按属性进行选择，例如类型。但是，这确实要求您的用户打开 Javascript，并下载一个附加文件，但如果它有效... 于 2009-01-22T20:47:33.187 回答 This answer is useful 0 抱歉，简短的回答是否定的。CSS (2.1) 只会标记 DOM 的元素，而不是它们的属性。您必须对每个输入应用一个特定的类。 我知道这很糟糕，因为那将非常有用。 我知道你说过你更喜欢 CSS 而不是 JavaScript，但你仍然应该考虑使用 jQuery。它提供了一种非常简洁优雅的方式来基于属性向 DOM 元素添加样式。 于 2009-01-22T20:43:48.217 回答 Related 11 php - PHP Debug Echo 的 1 javascript - 在对象树中查找特定字段值的所有出现 2 java - 在Java中查找手机号码的国家代码 1 java - 加载前检测编译代码的缺点 0 facebook - 在关注“分页”facebook php sdk 3 时，一次又一次地收到相同的数据 1 c# - WPF“地图”控件；使用画布显示大量位图图像 1 php - 如何从 Propel(Symfony) 中删除自动插入的查询？ 1 apache - Apache htaccess 重定向 3 seo - 使用 .htaccess 删除 www 规范：我还应该在网站管理员工具中验证 www 和非 www 吗？ 1 java - 连接一个本身有构造函数的 Bean Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：470702
> 
> 赞同：108
> 
> 时间：
> 
> 标签：css, internet-explorer, css-selectors

CSS有什么办法可以根据输入的类型来定位所有输入吗？我有一个用于各种禁用表单元素的禁用类，我正在为文本框设置背景颜色，但我不希望我的复选框获得那种颜色。

我知道我可以用单独的类来做到这一点，但如果可能的话，我宁愿使用 CSS。我敢肯定，我可以在 javascript 中设置它，但再次寻找 CSS。

我的目标是IE7 +。所以我不认为我可以使用 CSS3。

**编辑**

使用 CSS3 我可以做类似的事情吗？

`INPUT[type='text']:disabled`那会更好地完全摆脱我的课...

**编辑**

好的，感谢您的帮助！所以这是一个选择器，它可以修改所有已禁用的文本框和区域，而无需设置任何类，当我开始这个问题时，我从没想过这是可能的......

```
INPUT[disabled][type='text'], TEXTAREA[disabled]
{   
    background-color: Silver;
} 
```

这适用于 IE7

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-01-22T21:00:26.563

是的。IE7+ 支持属性选择器：

```
input[type=radio]
input[type^=ra]
input[type*=d]
input[type$=io] 
```

具有属性类型的元素输入，其包含等于、开始、包含或结束于某个值的值。

其他安全 (IE7+) 选择器有：

*   父母 > 孩子有：`p > span { font-weight: bold; }`
*   前面有 ~ 元素，即：`span ~ span { color: blue; }`

哪个 for`<p><span/><span/></p>`会有效地给你：

```
<p>
    <span style="font-weight: bold;">
    <span style="font-weight: bold; color: blue;">
</p> 
```

进一步阅读： [quirksmode.com 上的浏览​​器 CSS 兼容性](http://www.quirksmode.org/css/contents.html)

我很惊讶其他人都认为这是不可能的。CSS 属性选择器已经出现了一段时间。我想是时候清理我们的 .css 文件了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T20:55:02.953

~~可悲的是，其他海报是正确的，您~~ ...实际上已被 kRON 纠正，*您*对 IE7 和严格的文档没问题，但*我们大多数*有 IE6 要求的人都被简化为 JS 或类引用，但它*是*一个 CSS2 属性，只是一个没有 IE^h^h 浏览器足够支持的属性。

出于完整性考虑，类型选择器是 - 类似于 xpath - 的形式`[attribute=value]`，但存在许多有趣的变体。当它可用时，它*会*非常强大，记住 IE8 是件好事。

*   [w3 参考](http://www.w3.org/TR/CSS2/selector.html#attribute-selectors)

*   [浏览器支持参考](http://dev.l-c-n.com/CSS3-selectors/browser-support.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T20:47:33.187

你可以用 jQuery 做到这一点。使用它们的选择器，您可以按属性进行选择，例如类型。但是，这确实要求您的用户打开 Javascript，并下载一个附加文件，但如果它有效...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T20:43:48.217

抱歉，简短的回答是否定的。CSS (2.1) 只会标记 DOM 的元素，而不是它们的属性。您必须对每个输入应用一个特定的类。

我知道这很糟糕，因为那将非常有用。

我知道你说过你更喜欢 CSS 而不是 JavaScript，但你仍然应该考虑使用 jQuery。它提供了一种非常简洁优雅的方式来基于属性向 DOM 元素添加样式。

# c# - 使用 iTextSharp 填充其他字段时，如何在 PDF 中强制格式化和计算？

> ID：470707
> 
> 赞同：6
> 
> 时间：2009-01-22T20:40:47.880
> 
> 标签：c#, pdf, pdf-generation, itextsharp, itext

我有一个带有许多文本字段的 PDF 表单。在这些字段中输入的值用于计算其他字段中的值（计算的字段是只读的）。

当我在 Adob​​e Reader 中打开表单并填写字段时，计算的字段会自动重新计算。

但是，我正在使用 iTextSharp 填写字段，展平生成的表单，然后将展平的表单通过网络流回给用户。

这部分工作得很好，除了计算的字段从不计算。我假设由于没有触发用户触发的事件（如按键或焦点或模糊），因此不会发生计算。

显然，我可以从可填写的表格中删除计算，并在填写字段时在服务器上完成所有计算，但我希望可填写的表格既可供人类使用，也可供服务器使用。

有谁知道如何强制计算？

编辑：我在这里感觉不太喜欢 iText/iTextSharp...

这里还有一些细节。将 stamper.AcroFields.GenerateAppearances 设置为 true 没有帮助。

我*认为*答案在于页面操作中的某个地方，但我不知道如何触发它......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-01T15:31:24.803

Paulo Soares（iText 的主要开发者之一和 iTextSharp 的当前维护者）[说](http://www.mail-archive.com/itext-questions@lists.sourceforge.net/msg26180.html)：

> iText 不会做任何努力来修复计算字段，因为大多数时候这是不可能的。PdfCopyFields 对它有一些支持，有时有效，有时无效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-22T14:08:10.450

我通过在 Doc 对象上调用 javascript 方法 calculateNow 更新了我的 pdf 的所有计算字段。

根据 adobe javascript 文档`this.calculateNow();`

> 强制计算当前文档中的所有计算字段。
> 
> 当一个表单包含许多计算时，用户将数据输入到一个字段后可能会有很大的延迟，即使它不是一个计算字段。一种策略是在某个时候关闭计算，然后再将其重新打开（参见示例）。

使用 iTextSharp 包含 javascript 调用：

```
using (PdfReader pdfReader = new PdfReader(pdfTemplate))
using (PdfStamper pdfStamper = new PdfStamper(pdfReader, new FileStream(newFile, FileMode.Create)))
{
    // fill f1 field and more...
    AcroFields pdfFormFields = pdfStamper.AcroFields;
    pdfFormFields.SetField("f1", "100");
    //...

    // add javascript on load event of the pdf
    pdfStamper.JavaScript = "this.calculateNow();";
    pdfStamper.Close();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-03T18:50:42.863

我已经想出了如何做到这一点。请参阅我对 stackoverflow 问题的回答：

[如何刷新非计算字段的格式并刷新可填写 PDF 表单中的计算字段](https://stackoverflow.com/questions/16093162/how-to-refresh-calculated-fields-in-pdf-form-using-itextsharp/16903682#16903682)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T21:35:46.603

在服务器端，查看计算字段中是否有答案。如果没有，请计算它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-01T17:18:29.267

正如 Greg Hurlman 所说，您应该在服务器上自己进行计算。这不仅仅是为了方便，实际上还有一个很好的理由。

客户拥有的任何文件，他们都有可能搞砸。我不知道 PDF 表格的用途，但它可能以某种方式与金钱有关，因此人们有可能通过计算显示错误的结果来作弊。如果您信任在客户端完成的计算，您将无法检测到它。

当您从客户那里收到 PDF 表格时，您应该重做所有计算，以便您知道它们是正确的。然后，如果您还有要比较的客户端版本，您应该检查它们是否被搞砸了。

你不觉得你的客户那么不可靠吗？对你有好处，但证据不同意。我最早对编程的介绍之一是为 SimCity 开放存档游戏，以便给自己更多的钱。如果存在以某种方式作弊的机会，那么在某些时候人们会尝试它。

# perl - 如何进行 Perl 机器或平台相关的 TDD？

> ID：470711
> 
> 赞同：5
> 
> 时间：2009-01-22T20:41:34.760
> 
> 标签：perl, unit-testing, tdd, multiplatform

如何测试依赖于机器或平台的功能或模块？例如，看起来/依赖于`$^O`或像[Net::Ifconfig::Wrapper](http://search.cpan.org/dist/Net-Ifconfig-Wrapper)这样的模块的东西？我不需要测试 Net::Ifconfig::Wrapper 是否返回正确的值，但我确实需要测试我是否使用这些值做正确的事情。

谢谢！

编辑：测试`$^O`结果比我想象的要容易：

```
{
    # <~> $ perl -e 'print $^O'
    # linux

    local $^O = 'linux';
    $rc = GetOSType();
    is($rc, $OS_LINUX, 'OS Check - linux');
} 
```

出于某种原因，我认为它是一个只读变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T21:07:53.613

要跟进 Jason 的[模拟对象](http://en.wikipedia.org/wiki/Mock_object)建议，您应该查看[Misko Hevery 的文章“与难以测试的第三方控件交互”](http://misko.hevery.com/2009/01/04/interfacing-with-hard-to-test-third-party-code/)。它直接解决了测试第三方组件的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T21:00:47.577

通常，您使用[模拟对象](http://en.wikipedia.org/wiki/Mock_object)来“伪造”这些系统调用的结果。

在测试期间，使用模拟对象并让它们在不同平台上返回您期望的各种结果，测试您的代码在这些情况下是否正确反应。

# c# - 挑战：快速填充装饰器类的字段

> ID：470718
> 
> 赞同：3
> 
> 时间：2009-01-22T20:43:45.660
> 
> 标签：c#

假设我们有一个`Model`带有几个属性的模型，我们想要创建这个模型的装饰器类来增强它的一些额外属性。现在我们要创建一个`DecoratedModel`填充了 的所有属性值的新实例`Model`，可能使用带有`Model`参数的构造函数：

```
public class DecoratedModel : Model
{
    public DecoratedModel(Model baseModel)
    {
        // Populate decorated model generically from baseModel
    }
} 
```

什么是最通用、最简洁的方式来`DecoratedModel`填充`Model`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T22:25:27.653

好吧，您应该能够使用反射来反射基类属性，然后使用它来设置子类属性。我没有对此进行广泛的测试，但这样的事情可能会奏效：

```
 public DecoratedModel(Model m)
        {
            foreach (var prop in typeof(Model).GetProperties())
            {
                this.GetType().GetProperty(prop.Name).SetValue(this, prop.GetValue(m, null),null);
            }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T20:48:47.973

虽然它确实需要模型类有一个复制构造函数来复制装饰器类中的模型数据，但这样做至少可以确保对于所有装饰器，您只需调用基类复制构造函数。

```
public class DecoratedModel : Model
{
    public DecoratedModel(Model baseModel)
        : base(baseModel)
    {
        // Populate decorated model generically from baseModel
    }
}

public class Model
{
    public Model(Model copy)
    {
        this.x = copy.x;
        // etc.
    }
} 
```

# java - 在 Java 文件中定义类

> ID：470724
> 
> 赞同：4
> 
> 时间：2009-01-22T20:45:53.160
> 
> 标签：java, class

我在我的 Java 程序中发现了一个错误：

> 公共类型 abc 类必须定义在自己的类中

如何解决此错误？我正在使用 Eclipse。我是 Java 编程新手。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-22T20:49:10.063

每个源文件必须只包含一个**公共**类。一个名为的类`ClassName`应该在一个名为 的文件中`ClassName.java`，并且只应该在其中定义该类。

匿名类和内部类除外，但了解您是 Java 的初学者，这是一个高级主题。现在，每个文件保留一个类。

回答你的补充：继承类是可以的，这完全没问题。这没关系，每个类仍然应该有自己的文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T20:52:18.840

公共顶级类（即不嵌套在其他类中的公共类）必须在与类名匹配的文件中定义。所以类“Foo”的代码必须存在于“Foo.java”中。

从[语言规范，第 7.6 节](http://java.sun.com/docs/books/jls/third_edition/html/packages.html#26783)：

* * *

当包存储在文件系统中时（第 7.2.1 节），如果在由类型名称加上如果以下任一情况为真，则为扩展名（例如 .java 或 .jav）：

*   该类型由声明该类型的包的其他编译单元中的代码引用。

*   该类型被声明为公共的（因此可以从其他包中的代码中访问）。

* * *

*编译器不必*遵循这条规则，几乎得到普遍遵守。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T21:05:34.260

好的，也许一个例子会有所帮助。

在文件 MySuperClass.java 中：

```
public class MySuperClass {
    // whatever goes here
}
public class MySubClass1 extends MySuperClass {
    // compile error: public class MySubClass1 should be in MySubClass1.java
}
class MySubClass2 extends MySuperClass {
    // no problem (non-public class does not have to be in a file of the same name)
} 
```

在文件 MySubClass3.java 中：

```
public class MySubClass3 extends MySuperClass {
    // no problem (public class in file of the same name)
} 
```

这会让事情变得更清楚吗？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-22T20:46:57.620

名称为“abc”的公共类必须位于名为 abc.java 的文件中

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T21:05:56.333

如果它是私有的，您*可以*在现有文件中创建一个新类，但您*不应该*这样做。

每个班级创建一个文件。如果您创建一个新类，Eclipse 会为您执行此操作。

对于 Java 编程，您必须了解类、包和文件的构造。即使 Eclipse 可以帮助您，您也必须自己了解它。所以开始阅读 Java 书籍或教程吧！

# .net - WCF 和接口继承 - 这是一件可怕的事情吗？

> ID：470726
> 
> 赞同：6
> 
> 时间：2009-01-22T20:46:10.787
> 
> 标签：.net, wcf, inheritance, interface

我的应用程序有 2 个“服务”，假设一个是基本（整数）计算器，一个是浮点计算器。我将这些表示为如下接口：

```
public interface IBasicCalculator
{
    int Add( int a, int b );
}

public interface IFloatingPointCalculator
{
    double Add( double a, double b );
} 
```

我想通过 WCF 公开这些。不幸的是，WCF 似乎与您想要公开的每个可能的操作都必须通过一个服务接口的概念紧密相关——您不能在服务之间共享会话，这对于客户端来说很麻烦，因为您需要创建一个每个人都有单独的代理，似乎没有任何“子服务”等......

所以，我收集到我需要呈现一个“组合”界面（也可以称之为外观），如下所示：

```
[ServiceContract]
public interface ICalculatorService : IBasicCalculator, IFloatingPointCalculator
{
    [OperationContract(Name = "AddInt")]
    new int Add( int a, int b );

    [OperationContract(Name = "AddDouble")]
    new double Add( double a, double b );
} 
```

如果我这样做，那么 WCF 会向客户端公开这两种方法，客户端可以调用它们，这一切都有效。

然而，像这样“继承接口”似乎很笨拙。*特别*是和。严格来说，在方法上表示隐藏底层方法，我实际上根本没有这样做。我可以省略，但是我只是得到编译器警告，相当于“我想我隐藏了这个方法，你需要重命名它的方法或在它上面加上'new'”。**`new`** `int Add`**`new`** `double Add``new``new`

所以，这是一个两部分的问题：

1.  我的“将所有内容组合到一个界面”逻辑上是否步入正轨，或者实际上是否有一种方法可以使用 WCF 公开“子服务”或“多个链接服务”？

2.  如果这是需要做的，有没有更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T21:09:38.447

我刚刚发现您可以将多个端点（每个端点使用不同的接口）暴露给同一个服务，并且您仍然只需要在客户端上生成一个代理库即可访问所有端点，这完全解决了我的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T21:00:51.490

我一般会说，不。请记住，您处理的是分布式应用程序技术，而不是分布式对象技术，因此继承之类的概念不适用。

一般来说，我不会走这条路，而是有特定的合同，代表您希望通过端点公开的操作的逻辑分组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-23T20:43:48.950

我相信您所描述的并不是真正的最佳实践。当然，在一个服务类型上实现多个服务契约是可行的，因为它只是实现多个接口的问题。

WCF 无疑使支持使用唯一 URI 和独立合同进行通信的多个端点成为可能。然而，例如，ClientBase 类仅接受一种合约接口类型这一事实几乎意味着代理类，即使它们存储在同一个库中，仍然需要明确地实现仅一种合约接口。

如果您实际上只成功地创建了一个代理类定义，我很想知道您是如何做到这一点的。不过，我可能会误解您的需求。实现不同的代理类为您提供了最大的灵活性，因为像 IsInitiating 和 IsTerminating 这样的 OperationContractAtrribute 值对于不同的合约可能会有所不同。如您的示例所示，结合两个合同的接口可能会改变您将方法归因于 Service 合同的方式。

# .net - ASP.NET MVC 参考问题？

> ID：470739
> 
> 赞同：2
> 
> 时间：2009-01-22T20:49:02.467
> 
> 标签：.net, asp.net-mvc

在做一个 MVC 项目时，我得到了以下 2 个编译错误：

1.  该类型`System.Web.Mvc.ViewPage`在未引用的程序集中定义。您必须添加对程序集的引用：

> System.Web.Mvc，版本=1.0.0.0，文化=中性，PublicKeyToken=null。

2.  以下方法或属性之间的调用不明确：

> System.Web.Mvc.Html.LinkExtensions.ActionLink(System.Web.Mvc.HtmlHelper, string, string, string) 和 System.Web.Mvc.Html.LinkExtensions.ActionLink(System.Web.Mvc.HtmlHelper, string, string ， 细绳）

我认为我在`web.config`

```
<compilation debug="true">
  <assemblies>
    <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Abstractions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Data.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
  </assemblies>
</compilation> 
```

和

```
<namespaces>
    <add namespace="System.Web.Mvc"/>
    <add namespace="System.Web.Mvc.Ajax"/>
    <add namespace="System.Web.Mvc.Html"/>
    <add namespace="System.Web.Routing"/>
    <add namespace="System.Linq"/>
    <add namespace="System.Collections.Generic"/>       
</namespaces> 
```

而且，我参考了我在其中安装了 asp.net mvc 的 3 个 dll：

```
C:\Program Files\Microsoft ASP.NET\ASP.NET MVC Beta\Assemblies 
```

3个dll：

```
System.Web.Abstractions.dll
System.Web.Routing.dll
System.Web.Mvc.dll 
```

有人可以解释一下出了什么问题以及如何解决它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T21:59:57.067

我从 CodePlex 下载了最新的 mvc 源并构建了它。我通过将 System.Web.Mvc.dll 引用到我下载的版本和其他 2 个 dll 引用 C:\Program Files\Microsoft ASP.NET\ASP.NET MVC Beta\Assemblies 文件夹中的 dll 来修复第一个错误。

现在第一个错误不存在，但第二个错误仍然存​​在，即

以下方法或属性之间的调用不明确：'System.Web.Mvc.Html.LinkExtensions.ActionLink(System.Web.Mvc.HtmlHelper, string, string, string)' 和 'System.Web.Mvc.Html.LinkExtensions .ActionLink（System.Web.Mvc.HtmlHelper，字符串，字符串，字符串）'

这几乎发生在每个视图页面上。我能做些什么来解决这个问题？

太感谢了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T22:06:55.023

第二个错误可能是由于其中一个视图中的一些错误。我在使用 ASP.NET MVC 时遇到了类似的问题。当视图中有错误时，编译器错误不是很具体。因此，请关注视图，特别是调用 Html.ActionLink() 的代码部分。那最终应该将您带到错误的根源...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:56:46.013

因为您引用了所有正确的程序集，而我看不出您的 Web.Config 文件有任何问题，所以我想知道您是否引用了正确**版本**的程序集。已经发布了多个版本的 ASP.NET MVC，也许您仍在引用 System.Web.Mvc.dll 的早期版本（版本 1.0.0.0 之前）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-26T14:32:49.610

第二个错误是因为 IDE 从两个不同的来源获取引用。结果它不能决定选择哪一个。

我将 System.Web.Mvc 和 System.Web.Mvc.Html 添加到命名空间部分 web.config 文件中。我删除了 System.Web.Mvc.Html 并得到了修复。

如果有人遇到同样的问题，这是屏幕截图：![在此处输入图像描述](https://i.stack.imgur.com/HnM2J.png)

# windows - 是否有用于读取 .hlp 帮助文件内容的库/api？

> ID：470752
> 
> 赞同：2
> 
> 时间：2009-01-22T20:52:58.870
> 
> 标签：windows, winhelp

我的程序有一个帮助文件，当用户浏览它们时，我被要求在工具栏中添加对菜单的描述。所以我想我可以只使用菜单的开头描述的帮助，但找不到如何访问它的内容。

我看到 WinHelp 有一个宏语言，所以我想可能是通过这个，但我找不到任何关于这个的参考。

任何人现在有一些热的指针或例子来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T21:13:11.577

winhelpcgi 实用程序包含可以读取 .hlp 文件的库代码。来源在这里：[链接](http://www.herdsoft.com/ftp/downloads.html#winhelpcgi)

我没有使用它，所以我不能保证它的使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T13:26:43.140

首先，您的帮助系统应该有一个关于每个主题的索引，允许您打开帮助并显示该主题（如果没有，请查看[帮助和手册](http://www.ec-software.com/products_hm_screenshots.html)——它将帮助您构建更完整的帮助文件）。但是，这并不能直接解决您的问题，因为据我了解，您希望它在工具帮助窗口中弹出。

因此，您需要深入了解帮助系统如何使用密钥来提取适当的信息。但是，直接访问 WinHelp 文件中特定的、已编入索引的文本块并非易事（据我所知）。您可以[在这里](http://www.russotto.net/chm/chmformat.html)找到一些有用的信息。您可能还想浏览帮助和手册网站上的论坛。

不过，这里有一个更大的问题：当用户将鼠标悬停在菜单项或按钮上时，弹出整个帮助主题（即使很短）真的有意义吗？这对我来说不是，我在贝尔实验室的 UI 设计小组工作了多年。A) 信息太多，B) 会让有经验的用户在视觉上分散注意力（因此令人难以置信的恼怒）。这里公认的做法是弹出一个工具帮助窗口，其中包含一个非常短（1-4 个字）的按钮描述符（“打开”或“打开文件”）。

如果您希望每个菜单项或按钮都可以使用帮助，我建议您选择两种选择之一。

首先，考虑使用“帮助光标模式”，其中光标使用帮助图标（带问号的箭头）。用户通过按钮栏上的帮助按钮访问它。在帮助光标模式下，用户单击任何项​​目都会将他们带到该项目的帮助主题。我对这种方法有点冷淡，因为它是模态的，但我肯定已经看到它完成了。

其次，您可以简单地加强您的帮助系统。也就是说，在帮助系统中创建一个主题，其中包含应用程序的屏幕截图。在此屏幕截图中，为每个菜单项和/或按钮创建热点，并允许用户通过单击转到相应的主题。做得对，这为用户提供了他们希望了解的主题的视觉键，而不会干扰程序的正常运行。

最重要的是：在执行所有必要的工作以实施您当前的计划之前，请*确保*它是正确的计划！

# menu - 改变 YUI 菜单的鼠标行为

> ID：470756
> 
> 赞同：0
> 
> 时间：2009-01-22T20:55:09.240
> 
> 标签：menu, yui

我正在使用 Yui 构建一个“弹出”菜单，该菜单与鼠标的工作方式与平时有所不同。这*不是*ContextMenu，因为我希望它响应*左键*单击，而 ContextMenu 似乎倾向于响应右键单击。

按照示例，如果我这样做，菜单就会出现，并且一切都接近我想要的：

```
YAHOO.util.Event.addListener(myClickTarget, 'click', myThingGotClicked); 
```

在我的 myThingGotClicked 函数中，我手动设置了菜单的位置`show()`。

我的问题是我想将菜单可见性“绑定”到鼠标按钮的状态。也就是说，在 mouseDown 上，我希望菜单出现，而在 mouseUp 上，我希望菜单消失（选择活动项目，如果有的话）。所以，监听“点击”事件并没有做正确的事情，因为“点击”只在 mouseUp 之后发送。

“明显”的解决方案是这样做：

```
YAHOO.util.Event.addListener(myClickTarget, 'mousedown', myThingGotClicked); 
```

但这不起作用。在调试器中单步执行，您可以看到它确实会在鼠标按下时调出菜单，但随后会立即隐藏菜单。全速行驶时，似乎什么都没有发生。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T23:37:29.943

问题是 MenuManager 类在文档级别侦听 mousedown 事件并隐藏所有可见的 Menu 实例。因此，由于您正在构建一种独特的 Menu 实现，因此您需要在处理程序中停止 mousedown 事件的传播，以便 MenuManager 不会处理该事件。这是给你的一些伪代码：

```
var myThingGotClicked = function (event) {

    YAHOO.util.Event.stopPropagation(event);

    // Do other stuff

};

YAHOO.util.Event.on(myClickTarget, 'mousedown', myThingGotClicked); 
```

*   托德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T19:32:51.407

这有点接近，因为确实会弹出菜单，但是如果您尝试在菜单中进行选择，则下方页面的文本选择会有点疯狂。我认为，我还需要添加一个 mouseup 处理程序，因为菜单不会在鼠标释放时关闭。

我真正想要的是在每个版本的 Mac OS 上像菜单一样工作的菜单（直到最近，当 OS X 添加“单击以使菜单‘粘’到默认行为时）。

# .net - 界面良好实践

> ID：470759
> 
> 赞同：1
> 
> 时间：2009-01-22T20:56:10.720
> 
> 标签：.net

拥有一个没有方法而只有属性的接口是一个好习惯吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T21:06:10.857

想象一下，我们有两个不同的类，它们不是从同一个基础派生的：用户和企业。在我们项目的某个时刻，我们决定用户和企业都需要引用地址元素，例如 Street1、Street2、City、State 和 Zip。我们还有某种代理类，它需要能够直接操作这些值，而不管它们是在哪个类中定义的。

实现此目的的一种方法是创建一个像这样的接口（c# 中的示例）：

```
public interface IHasAddress {
  public string Street1 { get; set; }
  public string Street2 { get; set; }
  public string City { get; set; }
  public string State { get; set; }
  public string Zip { get; set; }
} 
```

现在，我们可以在另一个类中拥有一个方法，该方法执行以下操作：

```
public static class Test {
  public static void CheckZip(IHasAddress addressContainer) {
    if (addressContainer == null) return;
    if (addressContainer.Zip == "33314") addressContainer.State = "FL";
  }
} 
```

只要 User 和 Business 都实现了 IHasAddress 接口，下面的代码就会按预期编译和工作：

```
User user = new User();
Business business = new Business();
Test.CheckZip(user);
Test.CheckZip(business); 
```

这是一个纯粹的理论问题/解决方案，但它确实证明了对这种结构的完美需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T20:59:25.083

接口是否有方法并不重要。接口公开的成员应该由该接口的客户端的要求驱动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T20:57:55.630

如果您打算拥有一组具有类似基本结构的数据对象，这将是有意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T21:21:37.220

不要忘记，属性只不过是通常命名为 get_PropertyName 或 set_PropertyName 的方法。

所以不，我认为只有属性的接口没有问题。它们仍然是方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T21:08:09.980

这是 Java 在获得正确枚举之前定义一堆相关常量的常用方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T21:08:55.063

我看不出有什么问题。如果你的应用程序需要一个契约来实现一堆属性，那就这样吧。

# naming-conventions - 替换 API/类的命名约定

> ID：470761
> 
> 赞同：1
> 
> 时间：2009-01-22T20:57:13.433
> 
> 标签：naming-conventions, maintenance

您是否对正在逐步采用以替换执行相同功能/担任相同角色的旧版本的 API 或类的命名约定？

例如，Windows 通过在函数末尾添加“Ex”来做到这一点：

```
ShellExecute // old
ShellExecuteEx // new 
```

你更喜欢什么，你的理由是什么？

*   附加`2`, `V2`, `New`, `NowInStereo`?
*   将旧 API 一次性重命名为`Something`to`SomethingOld`并`Something`用于新的东西？当涉及到版本控制时，这个选项让我很担心，但它似乎也最不可能在未来被一个`V3`或`ReallyNew`问题所困扰。
*   组成一个完全不同的名称，可能不太准确地描述功能，但至少是不同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T14:45:15.367

很多时候，您可以通过更改包名而不是类名本身来摆脱困境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:04:01.873

为什么要改变它？接口就是它们的契约，你为什么要在一切都使用它之后破坏接口。

编辑：很抱歉打扰您的评论乔什......

我认为，如果您费心创建界面，您需要尽一切努力维护它。你之前评论的时候在想什么样的错误选择？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:06:45.630

如果新类执行与旧类相同的功能，我将删除旧类并用同名的新类替换它。如果需要，我仍然可以在版本控制中查阅旧版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-19T21:35:01.687

如果函数的参数由于对函数的新要求而发生更改，您只需要创建一个新函数。

API 的最佳命名约定是 API 用户所期望的。如果 API 仅在 Windows 上使用，则添加 Ex（或 Ex2 用于下一个版本）可能是合适的。我不知道其他平台上的其他约定。此外，您的编程语言可能有扩展 API 方法的约定。

如果您使用的是面向对象的语言并且这是一个对象方法，则不必更改名称，因为您可以拥有具有相同名称和不同签名的方法。但是，提供一个新名称以让用户知道您希望他们迁移到新方法可能仍然有意义。

# web - 虚拟化：您是否将 Web 内容存储在虚拟机中？

> ID：470765
> 
> 赞同：2
> 
> 时间：2009-01-22T20:58:27.160
> 
> 标签：web, virtualization

在创建虚拟 Web 服务器（对我来说是 VirtualBox）时，Web 内容通常会进入虚拟机“内部”，还是通常有一个文件服务器在裸机上运行，​​为所有虚拟机提供文件（内容）？

是否存在为虚拟服务器存储内容的典型场景？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T21:54:33.723

这要看是开发还是生产？如果具有多台服务器的生产将所有内容存储在具有快速网络访问权限的文件共享中，那么您就不必处理更新每台服务器的麻烦。如果是开发，只需将所有内容都放在虚拟服务器上，因为性能并不重要，而且更简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-22T21:55:33.783

你创建虚拟服务器是为了什么？

我通常使用 vms 作为测试机器，在这种情况下，内容将进入“内部”（运行 apache 的地方）。

如果您尝试模拟网络系统（如负载平衡器或其他东西），您将在模拟机器上设置内容，以代表您场景中的文件服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T21:34:18.100

这取决于您的架构以及信息将如何更新。如果信息要经常更新并在多台机器上复制，那么在裸机上安装一个文件服务器可能是有意义的，VM 通过网络连接到该服务器。但是，您应该知道，尤其是使用 VirtualBox，即使安装了来宾工具，您也会对网络性能造成相当大的影响。我注意到我从 VirtualBox 获得了大约 20% 的 VMWare 网络速度。

# html - 在 IE 6 或 7 中使用 AJAX 加载 HTML 时处理样式标签的最佳方法是什么？

> ID：470768
> 
> 赞同：0
> 
> 时间：2009-01-22T20:58:32.777
> 
> 标签：html, css, ajax

我们的 AJAX 框架的工作原理是它发送回可能包含标签的 HTML 片段。然后，我们获取该 HTML 片段并将其设置为元素的 innerHTML。在 IE 6/7 中，它似乎忽略了标签，因此返回的 HTML 样式不正确。

我想知道其他人是否遇到过类似的问题，如果有，他们是如何处理的。我知道我可以使用 javascript 库（我们使用 YUI）来动态获取外部样式表，因此我可以将其转换为外部样式表。只是想知道是否有其他方法可以解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T21:09:28.417

当然最好的方法是纯DOM方案，即`document.createElement`用来生成服务器返回的所有元素。

但是，（当然）有一个 IE hack 可以解决`innertHTML`. 与其将响应直接粘贴到 DOM 中，不如先创建一个元素，附加其`innerHTML`，然后将其附加到 DOM。

```
function responseHandler(response) {
    var div = document.createElement('div');
    div.innertHTML = response.responseText
    document.getElementById('ZE_ELEMENT').appendChild(div);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:17:44.873

应识别内联样式标签。样式表块不会，因为它们是在页面的初始渲染时加载的。

您可以在现有样式表中动态添加类，但您必须解析 HTML 片段以获取那里的内容并在脚本中执行。

请参阅：[使用 Javascript 完全 Pwn CSS](http://www.hunlock.com/blogs/Totally_Pwn_CSS_with_Javascript)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-28T17:31:35.493

您可以尝试使用 jquery而不是`empty().append()`使用IE 6 到 IE 8。它适用于我加载具有内联样式的完整 html 文档。这是代码示例。`html()``innerHTML`

```
var url = "inline.html";
$.ajax({
    url: url,
    success: function (html) {
        $('#content').empty();
        $('#content').append(html);
    },
    error: function () { return null; }
}); 
```

有关更多详细信息，请查看博客链接[解决方案：使用 IE6 到 IE8 的内联 CSS 问题和 Ajax 调用](http://ciintelligence.blogspot.com/2012/06/solution-inline-css-issue-and-ajax-call.html)

# javascript - jQuery 是否具有与 Prototype 的 Element.identify 等价的功能？

> ID：470772
> 
> 赞同：9
> 
> 时间：2009-01-22T20:59:20.027
> 
> 标签：javascript, jquery, ajax, dom, prototypejs

是否有内置方法或事实上的默认插件可以让您自动为 jQuery 中的元素分配唯一 ID，或者您是否需要自己实现类似的东西？我正在寻找与[原型的识别方法等效的 jQuery](http://prototypejs.org/api/element/identify)

这是一个例子。我在一个看起来像这样的页面上有一些 HTML 结构

```
<span id="prefix_1">foo bar</span>
...
<div id="foo">
   <span></span>
   <span></span>
   <span></span>
</div> 
```

我想为每个跨度分配一个对页面唯一的 ID。所以在调用这样的东西之后

```
$('#foo span').identify('prefix');   //fake code, no such method 
```

渲染的 DOM 看起来像这样

```
<span id="prefix_1">foo bar</span>
...
<div id="foo">
   <span id="prefix_2"></span>
   <span id="prefix_3"></span>
   <span id="prefix_4"></span>
</div> 
```

jQuery 有什么官方/强大的东西，还是大多数 jQuery 开发人员自己推出的东西？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-22T21:09:30.943

```
jQuery.fn.identify = function(prefix) {
    var i = 0;
    return this.each(function() {
        if(this.id) return;
        do { 
            i++;
            var id = prefix + '_' + i;
        } while($('#' + id).length > 0);            
        $(this).attr('id', id);            
    });
};

$('span').identify('test'); 
```

对此进行了测试：

```
<span id='test_2'></span>
<span>test1</span>
<span>test2</span>
<span>test3</span> 
```

变成：

```
<span id="test_2"></span>
<span id="test_1">test1</span>
<span id="test_3">test2</span>
<span id="test_4">test3</span> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T21:03:34.810

我不知道，但您可以通过添加`id`属性并提供 GUID 自己执行此操作。

添加属性：

```
$(foo).attr( "id", createGuid() ); 
```

有关`createGuid()`实施，[请参阅此问题](https://stackoverflow.com/questions/105034/how-to-create-a-guid-in-javascript)。

请注意，您可以轻松地将其转换为[jQuery 插件，](http://blog.jeremymartin.name/2008/02/building-your-first-jquery-plugin-that.html)以便此函数（您甚至可以命名它`identify()`）可用于任何`$-`表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-22T21:20:10.390

基于 Paolo 的解决方案：

```
jQuery.fn.identify = function(prefix) {
    var i = 0;
    return this.each(function() {
        if($(this).attr('id')) return;
        do { 
            i++;
            var id = prefix + '_' + i;
        } while($('#' + id).length > 0);            
        $(this).attr('id', id);            
    });
};

$('span').identify('test'); 
```

一个小改动可以避免重新计算已经使用的 id。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-12T17:30:41.040

我会稍微修改给定的函数并使其成为：

```
jQuery.fn.identify = function(prefix) {
    var i = 0;
    return this.each(function() {
        if($(this).attr('id')) return;
        do { 
            i++;
            var id = prefix + '_' + i;
        } while(document.getElementById(id) != null);            
        $(this).attr('id', id);            
    });
}; 
```

ID 可能包含需要转义才能与 jQuery 的 CSS 选择器引擎正常工作的特殊字符，例如“.”。因此，与其找到它们并转义它们，不如用 document 方法替换它更简单、更快捷。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-22T21:05:21.153

也许试试

```
$("#foo span").each(function(){
   $(this).attr("id", "prefix_" + $(this).parent().index($(this)));
}); 
```

# c# - LINQ to SQL 表达式中的 DataContractSerializer？

> ID：470779
> 
> 赞同：1
> 
> 时间：2009-01-22T21:00:42.223
> 
> 标签：c#, linq-to-sql, iqueryable, datacontractserializer

我是 LINQ 表达式的新手，并试图让以下工作：

```
public IQueryable<Models.Powerups.Powerup> GetPowerups(Guid userid)
{
    return from p in dc.Powerups
           where p.UserId == userid
           select (Models.Powerups.Powerup) new DataContractSerializer(Type.GetType(p.Type, true)).ReadObject(new XmlTextReader(new StringReader(p.Data)));
} 
```

它显然不起作用，因为 LINQ 试图将整个表达式转换为 SQL。

你知道这样做的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T21:05:26.460

最好的办法是这样做：

```
public IQueryable<Models.Powerups.Powerup> GetPowerups(Guid userid)
{
        return from p in dc.Powerups
                   where p.UserId == userid
                   select p.Data;
} 
```

然后在从数据库中取回 xml 后自行反序列化。LINQ to SQL 提供程序不知道如何将其转换为 SQL，而且您也不希望它这样做。序列化对象的反序列化无论如何都应该发生在 CLR 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:08:39.447

您需要将其分为两部分，第一部分从数据库中获取数据，然后在该查询之外对数据进行转换。您可以在 C# 中使用自动生成的迭代器来帮助：

```
public IEnumerable<Models.Powerups.Powerup> GetPowerups(Guid userid)
{
  // Create the serializer here.
  DataContractSerializer s = new DataContractSerializer(typeof(Models.Powerups.Powerup));

  // Iterate through the powerups.
  foreach (var p in dc.Powerups)
  {
    // Create the string reader, xml reader, then deserialize and return
    // instance.
    using (StringReader stringReader = new StringReader(p.Data))
    using (XmlTextReader xmlTextReader = new XmlTextReader(stringReader))
    {
      // Return the deserialized instance.
      yield return (Models.Powerups.Powerup) s.ReadObject(xmlTextReader);
    }
  }
} 
```

这样做的好处是它也允许延迟执行。

# java - 如何以编程方式导入 Java 类

> ID：470786
> 
> 赞同：5
> 
> 时间：2009-01-22T21:04:01.750
> 
> 标签：java, reflection

Java中有没有办法以编程方式导入一个给定全名的类作为字符串（即like `"com.mydummypackage.MyClass"`）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-22T21:05:44.010

如果“导入”是指“加载一个`Class`对象以便运行反射方法”，则使用：

```
Class<?> clazz = Class.forName( "com.mypackage.MyClass" ); 
```

（我们的读者对您的“import”一词感到困惑的原因是，这通常是指在`import`Java 类文件顶部附近使用的关键字，用于告诉编译器如何扩展类名，例如`import java.util.*;`）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T21:11:54.307

Java 文档是此类知识的重要来源，我建议您阅读可在此处找到的类对象文档：http: [//java.sun.com/j2se/1.4.2/docs/api/ java/lang/Class.html](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Class.html)

正如 Jason Cohen 的回答中提到的，您可以使用以下代码行加载 Class 对象，然后创建该类的实例，您将执行 Class 对象的 newInstance 方法，如下所示：

```
Class<?> clazz = Class.forName( "com.mypackage.MyClass" );
Object o = clazz.newInstance(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T23:44:30.413

不要将“导入”与类加载混淆。

import 语句不加载任何东西。它所做的只是让您不必输入完全解析的类名。如果您导入 foo.bar.Baz，您可以在代码中引用 Baz 类，而不必拼写出来。这就是所有的进口手段。

# design-patterns - Should object properties be filled in the constructor

> ID：470789
> 
> 赞同：2
> 
> 时间：2009-01-22T21:04:39.987
> 
> 标签：design-patterns, architecture

I'm designing a new application and I'm undecided if I should fill my object properties on the constructor

```
Public Sub New(UserId as integer)
    ' get database values
    dr = DataReader
    Me.FirstName = dr.fields(0)
    Me.LastName = dr.fields(1)
End Sub 
```

Or create a factory with a method for each object type?

```
Public Function getUser(UserId as integer) as User
    Dim myUser as new User
    ' get database values
    dr = DataReader
    myUser.FirstName = dr.fields(0)
    myUser.LastName = dr.fields(1)
    return myUser
End Function 
```

I realize that the code is rough, but I'm hoping it's enough to get my point across. I've see both implemented and not sure what the long term pros and cons are.

Specifically, I'm using VB.NET, if it matters.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T21:09:11.770

My opinion:

A constructor *creates* an object. The constructor of a `User` class should *create* a new user.

Static member functions like your `getUser` *retrieve* an object which already exists.

I would use the latter form.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T21:08:27.013

I like types to be immutable where that doesn't create other problems. For a "person" type it may not be suitable, but it's worth considering. You should also try to construct objects so that after the constructor has been called, the object is in a valid state.

On the other hand, you should try to avoid doing too much work in the constructor itself - this is where static factory methods tend to be nice, as they can do significant work to grab all the data needed to construct the object, then pass it on to a simple constructor to create a complete, valid and potentially immutable object.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T21:08:38.543

It really depends on the language because some languages cannot guarantee the state of the object until the constructor and all base constructors have finished executing.

I find it best to populate whatever members you need and then call methods to do the rest of the work. This tends to make the code more readable as you won't have lots of code in your constructors.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T21:48:04.953

I would use a Factory-Pattern and make the constructor private/protected and make a static NewObject() method. The NewObject-method can then call the appropriate constructor. The pro on this is that if you need to change the behaviour of the Object during runtime you can plug-in (override) the NewObject-method and have your own NewObject-method "mixed in". The downside of this is that it can get very complex very fast - especially if you're debugging it.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T21:29:09.657

1.  You are instantiating the userhandler-object and using that to get different users, and let you work with all users. Have a GetUser-function and nothing in the constructor.

2.  You are instantiationg the userobject and working only with THE user, have the constructor handeling witch user to work with.

My 5 cents.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T23:47:58.080

An object should be 100% ready for use when it's constructed. A default constructor should have sensible, non-null default values for all references.

If you find that your constructor has "too much" code, perhaps it's time to consider refactoring that object.

# linux - Ghostscript：拆分大 PDF 会导致“pdfmark 目标页面”错误

> ID：470806
> 
> 赞同：2
> 
> 时间：2009-01-22T21:07:59.230
> 
> 标签：linux, pdf, debian, ghostscript

我正在尝试使用 gs（Debian Lenny 上的 Ghostscript 版本 8.62）将 PDF 拆分为 2 个较小的 PDF。我手头只有 Debian Linux，所以请不要提供 Windows 或 Mac 解决方案。

指定时`-dLastPage=740`，我收到错误：

```
GPL Ghostscript 8.62: ERROR: A pdfmark destination page 1203 points
beyond the last page 740. 
```

我已经搜索了 Ghostscript 文档以了解如何完全禁用 pdfmark（我不需要直接打印 pdf 的链接或书签）。 `-dDOPDFMARKS=false`不起作用。

我已经在互联网上搜索了任何报告类似错误的人。我还没有找到解决办法。

请帮忙！

作为参考，我使用的命令是：

```
gs -dSAFER -dBATCH -sDEVICE=pdfwrite -DNOPAUSE -sPAPERSIZE=halfletter -
dFIXEDMEDIA -dEmbedAllFonts=true -sOutputFile=library.1of2.pdf -
dLastPage=740 -dPDFFitPage library.pdf 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T04:02:07.287

试试[CAM::PDF](http://search.cpan.org/dist/CAM-PDF/)（注意：我是作者）。语法是：

```
deletepdfpage.pl library.pdf 741- library.1of2.pdf
deletepdfpage.pl library.pdf -740 library.2of2.pdf 
```

或以编程方式，大致是这样的：

```
use CAM::PDF;
my $pdf = CAM::PDF->new('library.pdf') || die;
$pdf->deletePages('741-');
$pdf->cleanoutput('library.1of2.pdf'); 
```

它是开源的，而且速度也很快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T06:48:17.077

事实证明，这个错误不是致命的。无论如何都会生成pdf，因为我不关心pdf链接或书签的功能，所以这个问题对我来说已经解决了。

不过，总的来说，最好知道 pdfmark 或 ghostscript 失败的原因，以及如何生成带有功能链接的有效 pdf。如果有人有答案，我还是想听听。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-11T13:31:47.877

您应该提出一个新问题，该问题详细说明您希望如何以及在何处生成什么样的“具有功能链接的 PDF”。

# php - 即使正在使用会话，文件名也不同于数据库中存在的文件名

> ID：470807
> 
> 赞同：0
> 
> 时间：2009-01-22T21:08:07.013
> 
> 标签：php, database, session, file, save

我使用 PHP 将文件名的一部分保存为 session_id，如下所示：

```
$newFileName = 'upload_160687_'.session_id().'_160687_'.$originalFileName; 
```

然后我在数据库中使用 PHP 将文件名保存为字符串，它看起来像这样：

```
upload_160687_l4eef6nqlekhbirv2pvmuf5660_160687_Apple_Microsoft_desktop1-1.jpg 
```

但是，当我查看文件系统时，相同的文件保存为：

```
upload_160687_41d99tblerr1tr6qq3n854jt05_160687_Apple_Microsoft_desktop1-1.jpg 
```

你可以看到差异，但到底是什么原因？？？？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T04:04:42.367

由于其单一共享进程，我们能否确认并关闭问题并将其标记为 FireFox session_id 怪癖？

# apache-flex - 在 Flex 中的多个控件上使用相同的验证器

> ID：470815
> 
> 赞同：2
> 
> 时间：2009-01-22T21:08:58.887
> 
> 标签：apache-flex, flex3

假设我在 flex 中有一个电话号码验证器，并且我有两个用于电话号码的 TextInput 控件。我不想定义两个具有基本相同属性的单独验证器控件......但每个验证器只有一个“源”属性。如何在多个控件上使用相同的验证器？（或任何等效的解决方案）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-23T01:51:24.900

不是内联的，但您可以通过编程方式执行验证，例如，在提交表单时，或者当用户跳出控件时等等。这是一个使用单个 PhoneNumberValidator 来验证两个表单字段的示例；单击提交按钮时会发生验证：

```
<mx:Script>
    <![CDATA[

        private function validatePhoneNumber(txt:TextInput):void
        {
            v.listener = txt;
            v.validate(txt.text);
        }

        private function btn_click():void
        {
            validatePhoneNumber(p1);
            validatePhoneNumber(p2);
        }

    ]]>
</mx:Script>

<mx:PhoneNumberValidator id="v" allowedFormatChars="()- .+" property="text" requiredFieldError="Required." wrongLengthError="Invalid length." invalidCharError="Invalid character." />

<mx:Form>
    <mx:FormItem label="Phone Number 1">
        <mx:TextInput id="p1" />    
    </mx:FormItem>
    <mx:FormItem label="Phone Number 2">
        <mx:TextInput id="p2" />    
    </mx:FormItem>
    <mx:FormItem>
        <mx:Button id="btn" label="Submit" click="btn_click()" />
    </mx:FormItem>
</mx:Form> 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-24T08:04:00.350

**重现步骤：**

1.  TextInput 动态创建

    ```
    textInputBox = new MyTextInput;
    textInputBox.restrict = “0-9.”;
    textInputBox.maxChars = 24;
    amountValidator = new NumberValidator();
    amountValidator.source = textInputBox;
    amountValidator.property = “text”;
    amountValidator.allowNegative = false;
    amountValidator.domain = “real”;
    amountValidator.precision = 4;
    amountValidator.required = false;
    amountValidator.maxValue = 999999999999.9999;
    amountValidator.trigger = textInputBox;
    amountValidator.triggerEvent = Event.CHANGE;
    amountValidator.addEventListener(ValidationResultEvent.VALID, amountValid);
    amountValidator.addEventListener(ValidationResultEvent.INVALID, amountInvalid);

    private function amountValid(event:ValidationResultEvent):void
    {
        valid = true;
        fieldsValidated = true;
    }

    private function amountInvalid(event:ValidationResultEvent):void
    {
        valid = false;
        fieldsValidated = true;
    } 
    ```

2.  正如创建中提到的，当我们超过限制时，它会显示错误我的红色边框，同时如果您在达到给定可接受的限制时按DEL键删除它们，很快就会自动变为绿色。
3.  离开该字段并更改另一个文本输入的值（这只是一个文本输入，这是一个表单，还有一些表单元素），然后通过 SHIFT+TABS 回到超出文本字段的值并删除额外输入的数字，当你来的时候很快你的价值就会被接受。
4.  现在再次输入更多值，现在您处于警告区域，然后离开该字段并在其他表单元素中进行一些更改。
5.  然后返回到鼠标单击提交的值超出文本，并从 DEL 开始删除，即使您删除了附加值，仍然字段显示您处于警告区域。

**实际结果：** 即使删除额外的数字，仍然是红色的

**预期结果：** 如果删除额外的数字，字段应该会恢复正常状态。

可以在[查看屏幕截图中查看此问题的图片](http://bugs.adobe.com/jira/browse/SDK-24372)

# performance - 为什么 Internet Explorer 中的内存使用量增加页面会变慢

> ID：470820
> 
> 赞同：3
> 
> 时间：2009-01-22T21:09:44.843
> 
> 标签：performance, internet-explorer, memory-leaks

我浏览到有 javascript 内存泄漏的网页。如果我多次刷新页面，最终会占用大量内存，页面上的 javascript 会变慢。在这个特定的页面上，我注意到当 IE 获得高达 100MB 的 RAM 时，速度非常显着，即使我有多个 GB 可用。

我的问题是为什么泄漏的对象会导致 javascript 运行缓慢？有没有人了解 IE 中的 JS 解释器是如何设计的，这样会发生这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T10:13:52.123

即使没有交换，这是由 IE 中 Javascript 的垃圾收集器的“愚蠢”实现引起的。如果有更多对象，它会使用一些更频繁地调用 GC 的启发式方法。

除了避免像地狱一样的内存泄漏以及避免创建过多的 Javascript 对象外，您无法避免这种情况。

问候， 马库斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:02:04.987

我想内存泄漏可能会导致一些内存碎片，这可能会减慢应用程序的速度。我不确定这是如何工作的，但是部分 js 代码是否可能仍在后台运行 - 作为孤立进程？这可以解释放缓的原因——随着页面变得越来越繁忙，而您实际上并没有看到旧副本正在运行。

不过，我可能会把它从我的屁股里拉出来。

# sql-server - 如何从 CD 运行 SQL Server Management Studio Express

> ID：470827
> 
> 赞同：2
> 
> 时间：2009-01-22T21:12:23.293
> 
> 标签：sql-server, ssms

是否可以从 CD 运行 SQL Server Management Studio Express 而无需在计算机上安装它？

我有时需要它来为客户端提供支持，但不想安装/卸载它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T21:29:23.073

如果您正在做基本支持，您可以简单地使用[SQLCMD](http://msdn.microsoft.com/en-us/library/ms162773.aspx)来运行查询/过程。除此之外，我认为没有任何方法可以在不安装它的情况下运行它。关于管理 Studio 的替代品，有一些关于 SO 的问题，您可以将它们安装在 cd/key 上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:20:30.280

不，你不能必须安装它

你不能远程连接吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:10:16.750

据我所知，您必须安装它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-23T04:41:52.950

SQL 2000 isqlw.exe 是独立的 IIRC，可以在一定程度上管理 SQL 2005。

# javascript - 从相对 URL 获取绝对 URL。（IE6问题）

> ID：470832
> 
> 赞同：80
> 
> 时间：2009-01-22T21:15:32.383
> 
> 标签：javascript, url, internet-explorer-6

我目前正在使用以下函数将相对 URL“转换”为绝对 URL：

```
function qualifyURL(url) {
    var a = document.createElement('a');
    a.href = url;
    return a.href;
} 
```

这在大多数浏览器中运行良好，但 IE6 仍然坚持返回相对 URL！如果我使用 getAttribute('href')，它会做同样的事情。

我能够从 IE6 中获取合格 URL 的唯一方法是创建一个 img 元素并查询它的 'src' 属性 - 问题在于它会生成服务器请求；我想避免的事情。

所以我的问题是：有没有办法从一个相对的（没有服务器请求）获取 IE6 中的完全限定 URL？

* * *

在你推荐一个快速的正则表达式/字符串修复之前，我向你保证它不是那么简单。基本元素 + 双周期相对 url + 大量其他潜在变量真的很糟糕！

必须有一种方法可以做到这一点，而不必创建一个庞大的正则表达式解决方案？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-23T12:37:39.010

How strange! IE does, however, understand it when you use innerHTML instead of DOM methods.

```
function escapeHTML(s) {
    return s.split('&').join('&amp;').split('<').join('&lt;').split('"').join('&quot;');
}
function qualifyURL(url) {
    var el= document.createElement('div');
    el.innerHTML= '<a href="'+escapeHTML(url)+'">x</a>';
    return el.firstChild.href;
} 
```

A bit ugly, but more concise than Doing It Yourself.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-10-18T23:13:17.283

只要浏览器正确实现 <base> 标签，哪些浏览器倾向于：

```
function resolve(url, base_url) {
  var doc      = document
    , old_base = doc.getElementsByTagName('base')[0]
    , old_href = old_base && old_base.href
    , doc_head = doc.head || doc.getElementsByTagName('head')[0]
    , our_base = old_base || doc_head.appendChild(doc.createElement('base'))
    , resolver = doc.createElement('a')
    , resolved_url
    ;
  our_base.href = base_url || '';
  resolver.href = url;
  resolved_url  = resolver.href; // browser magic at work here

  if (old_base) old_base.href = old_href;
  else doc_head.removeChild(our_base);
  return resolved_url;
} 
```

这是一个 jsfiddle，您可以在其中进行试验：http: [//jsfiddle.net/ecmanaut/RHdnZ/](http://jsfiddle.net/ecmanaut/RHdnZ/)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-06-26T18:31:23.620

你可以让它在 IE6 上工作，只需克隆元素：

```
function qualifyURL(url) {
    var a = document.createElement('a');
    a.href = url;
    return a.cloneNode(false).href;
} 
```

^(（在 IE6 和 IE5.5 模式下使用 IETester 测试）)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-04-07T16:45:39.630

我在这个[博客](http://grack.com/blog/2009/11/17/absolutizing-url-in-javascript/)上发现了另一种看起来像@bobince 解决方案的方法。

```
function canonicalize(url) {
    var div = document.createElement('div');
    div.innerHTML = "<a></a>";
    div.firstChild.href = url; // Ensures that the href is properly escaped
    div.innerHTML = div.innerHTML; // Run the current innerHTML back through the parser
    return div.firstChild.href;
} 
```

我发现它更优雅一点，没什么大不了的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-01-30T13:31:24.073

[URI.js](http://medialize.github.io/URI.js/)似乎解决了这个问题：

```
URI("../foobar.html").absoluteTo("http://example.org/hello/world.html").toString() 
```

另请参阅[http://medialize.github.io/URI.js/docs.html#absoluteto](http://medialize.github.io/URI.js/docs.html#absoluteto)

未使用 IE6 进行测试，但可能对其他搜索一般问题的人有所帮助。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-01-28T01:29:46.093

我实际上想要一种不需要修改原始文档（甚至暂时不需要）但仍然使用浏览器的内置 url 解析等的方法。此外，我希望能够提供自己的基础（如 ecmanaught 的回答）。它相当简单，但使用 createHTMLDocument （可以替换为 createDocument 可能更兼容）：

```
function absolutize(base, url) {
    d = document.implementation.createHTMLDocument();
    b = d.createElement('base');
    d.head.appendChild(b);
    a = d.createElement('a');
    d.body.appendChild(a);
    b.href = base;
    a.href = url;
    return a.href;
} 
```

[http://jsfiddle.net/5u6j403k/](http://jsfiddle.net/5u6j403k/)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-05-03T20:45:56.457

此解决方案适用于所有浏览器。

```
/**
 * Given a filename for a static resource, returns the resource's absolute
 * URL. Supports file paths with or without origin/protocol.
 */
function toAbsoluteURL (url) {
  // Handle absolute URLs (with protocol-relative prefix)
  // Example: //domain.com/file.png
  if (url.search(/^\/\//) != -1) {
    return window.location.protocol + url
  }

  // Handle absolute URLs (with explicit origin)
  // Example: http://domain.com/file.png
  if (url.search(/:\/\//) != -1) {
    return url
  }

  // Handle absolute URLs (without explicit origin)
  // Example: /file.png
  if (url.search(/^\//) != -1) {
    return window.location.origin + url
  }

  // Handle relative URLs
  // Example: file.png
  var base = window.location.href.match(/(.*\/)/)[0]
  return base + url 
```

但是，它不支持其中包含“..”的相对 URL，例如“../file.png”。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-01-05T21:36:18.543

这是我用来解析基本相对 URL 的函数：

```
function resolveRelative(path, base) {
    // Absolute URL
    if (path.match(/^[a-z]*:\/\//)) {
      return path;
    }
    // Protocol relative URL
    if (path.indexOf("//") === 0) {
      return base.replace(/\/\/.*/, path)
    }
    // Upper directory
    if (path.indexOf("../") === 0) {
        return resolveRelative(path.slice(3), base.replace(/\/[^\/]*$/, ''));
    }
    // Relative to the root
    if (path.indexOf('/') === 0) {
        var match = base.match(/(\w*:\/\/)?[^\/]*\//) || [base];
        return match[0] + path.slice(1);
    }
    //relative to the current directory
    return base.replace(/\/[^\/]*$/, "") + '/' + path.replace(/^\.\//, '');
} 
```

在 jsfiddle 上进行测试：[https ://jsfiddle.net/n11rg255/](https://jsfiddle.net/n11rg255/)

它既适用于浏览器，也适用于 node.js 或其他环境。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-03-15T22:53:38.773

我发现这篇博客文章建议使用图像元素而不是锚点：

[http://james.padolsey.com/javascript/getting-a-fully-qualified-url/](http://james.padolsey.com/javascript/getting-a-fully-qualified-url/)

这可以可靠地扩展 URL，即使在 IE6 中也是如此。但问题是，我测试过的浏览器会在设置 image src 属性后立即下载资源——即使您在下一行将 src 设置为 null。

我将尝试使用 bobince 的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-22T21:37:03.587

*如果`url`不以'/'开头*

取当前页面的 url，去掉最后一个 '/' 之后的所有内容；然后附加相对网址。

*否则如果`url`以'/'开头*

获取当前页面的 url 并砍掉单个 '/' 右侧的所有内容；然后附加网址。

*否则，如果`url`以 # 或 ? 开头*

获取当前页面的 url 并简单地追加`url`

* * *

希望这对你有用

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-11-27T10:51:59.727

如果它在浏览器中运行，这种对我有用..

```
 function resolveURL(url, base){
    if(/^https?:/.test(url))return url; // url is absolute
    // let's try a simple hack..
    var basea=document.createElement('a'), urla=document.createElement('a');
    basea.href=base, urla.href=url;
    urla.protocol=basea.protocol;// "inherit" the base's protocol and hostname
    if(!/^\/\//.test(url))urla.hostname=basea.hostname; //..hostname only if url is not protocol-relative  though
    if( /^\//.test(url) )return urla.href; // url starts with /, we're done
    var urlparts=url.split(/\//); // create arrays for the url and base directory paths
    var baseparts=basea.pathname.split(/\//); 
    if( ! /\/$/.test(base) )baseparts.pop(); // if base has a file name after last /, pop it off
    while( urlparts[0]=='..' ){baseparts.pop();urlparts.shift();} // remove .. parts from url and corresponding directory levels from base
    urla.pathname=baseparts.join('/')+'/'+urlparts.join('/');
    return urla.href;
  } 
```

# git - 对 Grails .gitignore 的建议

> ID：470833
> 
> 赞同：28
> 
> 时间：2009-01-22T21:16:45.967
> 
> 标签：git, grails

到目前为止，我收集了以下内容：

```
*.iws
*。战争
.classpath
.DS_Store
。项目
.settings
/*。发射
/*.tmproj
/出去/**
堆栈跟踪日志
测试/报告

```

还有其他建议吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-08-20T09:33:05.040

您可以使用以下命令让 Grails 自动生成 .gitignore 文件：

```
grails integrate-with  --git 
```

Grails 2.1.0 在我的机器上生成了以下文件内容：

```
*.iws
*Db.properties
*Db.script
.settings
stacktrace.log
/*.zip
/plugin.xml
/*.log
/*DB.*
/cobertura.ser
.DS_Store
/target/
/out/
/web-app/plugins
/web-app/WEB-INF/classes 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-22T22:50:53.250

5年后（2014年4月）更新：

正如下面其他答案中提到的，两个站点现在能够提供良好的默认 .gitignore 文件，包括 Grails 项目。

*   GitHub，在创建新仓库时（基于[github/gitignore 项目](https://github.com/github/gitignore)）。
    =>[`Grails.gitignore`](https://github.com/github/gitignore/blob/master/Grails.gitignore)

*   **[gitignore.io](http://www.gitignore.io/)**
    => [Grails gitignore](http://www.gitignore.io/api/grails)

* * *

（原始答案，2009 年 1 月）

只能添加**`/web-app/WEB-INF`**到您的列表中：这是此类 gitignore 文件[的完整示例](http://www.nabble.com/.gitignore-example-td19560531.html)。

```
# .gitignore for Grails 1.0.3

# web application files that are overwritten by "grails upgrade"
#  cf. GRAILS_HOME/scripts/Upgrade.groovy, target( upgrade )
/web-app/WEB-INF

# IDE support files that are overwritten by "grails upgrade"
#  cf. GRAILS_HOME/scripts/CreateApp.groovy, target( createIDESupportFiles )
# to be specific, you could replace "/*" below with your project name,
#  e.g. "foobar.launch" (no slash)
.classpath
.project
.settings
/*.launch
/*.tmproj

# logs
stacktrace.log
/test/reports

# project release file
*.war 
```

* * *

请注意，如此[处提到的](http://blog.sinequanon.net/2008/09/grails-gitignore/)，即：

*   `build.xml`不是该列表的一部分，因为 grails 不会覆盖它。
*   eclipse dot 文件`.classpath`, `.project`, 和`.settings`如果它们存在也不会被覆盖，但一开始可以忽略它们。
*   对于以前版本的 Grail，您还需要（至少）一行`/plugins/core`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-26T09:20:17.510

恕我直言，像 .DS_Store 和 *.tmproj 这样的东西不应该在项目 .gitignore 中，而应该在[您自己的用户范围的 ignore-file](https://stackoverflow.com/q/5724455 "我可以制作用户特定的 gitignore 文件吗？")中，因为它们与项目无关，而与*您*在存储库中的工作方式有关。

否则，可以提出一个论点，包括对来自 Eclipse、vim、emacs、XCode 的临时文件的忽略...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-04T18:51:57.513

我玩游戏很晚了，但我发现了这个模板链接[https://github.com/github/gitignore](https://github.com/github/gitignore)有一个用于 grails： [https://github.com/github/gitignore/blob/master/ Grails.gitignore](https://github.com/github/gitignore/blob/master/Grails.gitignore)。希望它可能对通过搜索“git ignore for grails”首先找到此页面的任何其他人有用

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-24T06:23:11.513

如果您使用 Intelli J IDEA，还应添加以下内容：

```
.idea
*.iml
*.iws
*.ipr 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-29T10:47:33.510

Heroku 还提供了`.gitgnore`文件建议（[Heroku 上的 Grails 入门](https://devcenter.heroku.com/articles/getting-started-with-grails#check-in-to-git)）：

```
*.iws
*Db.properties
*Db.script
.settings
.classpath
.project
eclipse
stacktrace.log
target
/plugins
/web-app/plugins
/web-app/WEB-INF/classes
web-app/WEB-INF/tld/c.tld
web-app/WEB-INF/tld/fmt.tld 
```

我们应该一起承担这个线程的所有建议并创建一个公共文件。使用 NetBeans IDE 时，还可以排除一些文件（例如`nbprojects`文件夹）。

# c++ - 一个 C++ 迭代器适配器，它包装和隐藏内部迭代器并转换迭代类型

> ID：470835
> 
> 赞同：16
> 
> 时间：2009-01-22T21:17:55.513
> 
> 标签：c++, templates, iterator, wrapper, adapter

玩弄过这个我怀疑这是不可能的，但我想我会问专家。我有以下 C++ 代码：

```
I类接口
{
    虚拟 void SomeMethod() = 0;
};

类对象
{
    IInterface* GetInterface() { ... }
};

类容器
{
私人的：
    结构项目
    {
        对象* pObject；
        [... 其他成员 ...]
    };
    std::list<项目> m_items;
};

```

我想将这些方法添加到容器中：

```
    MagicIterator<IInterface*> Begin();
    MagicIterator<IInterface*> End();

```

为了调用者可以写：

```
容器 c = [...]
for (MagicIterator<IInterface*> i = c.Begin(); i != c.End(); i++)
{
    IInterface* pItf = *i;
    [...]
}

```

所以本质上我想提供一个类，它似乎在迭代 IInterface 指针的某些集合（不允许 Begin() 和 End() 的调用者看到），但实际上是在迭代指向其他指针的集合可以转换为 IInterface 指针的对象（专用于 Container 类）。

几个关键点：

*   `MagicIterator`是要在外面定义的`Container`。
*   `Container::Item`必须保持私密。

*   `MagicIterator`必须迭代`IInterface`指针，尽管事实上`Container`持有一个`std::list<Container::Item>`. `Container::Item`包含一个`Object*`, 并且`Object`可以用来获取`IInterface*`.

*   `MagicIterator`必须可与多个类似于 Container 的类重用，但可能在内部具有不同的列表实现，其中包含不同的对象 ( `std::vector<SomeOtherItem>`, `mylist<YetAnotherItem>`)，并且`IInterface*`每次都以不同的方式获得。

*   `MagicIterator`不应该包含特定于容器的代码，尽管它可以委托给这样做的类，前提是这种委托没有硬编码到内部的特定容器`MagicIterator`（例如，编译器会以某种方式自动解析）。

*   该解决方案必须在 Visual C++ 下编译，而不使用其他库（例如 boost），这需要其作者的许可协议。

*   此外，迭代可能不会分配任何堆内存（因此没有`new()`或`malloc()`在任何阶段），并且没有`memcpy()`.

感谢您的宝贵时间，即使您只是在阅读；这个真的一直困扰着我！

**更新：**虽然我得到了一些非常有趣的答案，但还没有一个满足上述所有要求。值得注意的是，棘手的领域是 i) 以某种方式将 MagicIterator 与 Container 分离（默认模板参数不会削减它），以及 ii) 避免堆分配；但我真的在寻求涵盖所有上述项目符号的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-23T09:38:43.957

我认为您在这里有两个不同的问题：

首先，创建一个迭代器，它将`IInterface*`从您的`list<Container::Item>`. 这很容易做到`boost::iterator_adaptor`：

```
class cont_iter
  : public boost::iterator_adaptor<
        cont_iter                       // Derived
      , std::list<Container::Item>::iterator // Base
      , IInterface*                     // Value
      , boost::forward_traversal_tag    // CategoryOrTraversal
      , IInterface*                     // Reference :)
    >
{
 public:
    cont_iter()
      : cont_iter::iterator_adaptor_() {}

    explicit cont_iter(const cont_iter::iterator_adaptor_::base_type& p)
      : cont_iter::iterator_adaptor_(p) {}

 private:
    friend class boost::iterator_core_access;
    IInterface* dereference() { return this->base()->pObject->GetInterface(); }
}; 
```

您可以将此类型创建为 inner in`Container`并从其`begin()`和`end()`方法返回 in。

其次，您需要 runtime-polymorphic `MagicIterator`。这正是这样`any_iterator`做的。`MagicIterator<IInterface*>`is just ，`any_iterator<IInterface*, boost::forward_traversal_tag, IInterface*>`并且`cont_iter`可以分配给它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T22:00:25.460

创建一个抽象`IteratorImplementation`类：

```
template<typename T>
class IteratorImplementation
{
    public:
        virtual ~IteratorImplementation() = 0;

        virtual T &operator*() = 0;
        virtual const T &operator*() const = 0;

        virtual Iterator<T> &operator++() = 0;
        virtual Iterator<T> &operator--() = 0;
}; 
```

还有一个`Iterator`围绕它的类：

```
template<typename T>
class Iterator
{
    public:
        Iterator(IteratorImplementation<T> * = 0);
        ~Iterator();

        T &operator*();
        const T &operator*() const;

        Iterator<T> &operator++();
        Iterator<T> &operator--();

    private:
        IteratorImplementation<T> *i;
}

Iterator::Iterator(IteratorImplementation<T> *impl) :
    i(impl)
{
}

Iterator::~Iterator()
{
    delete i;
}

T &Iterator::operator*()
{
    if(!impl)
    {
        // Throw exception if you please.
        return;
    }

    return (*impl)();
}

// etc. 
```

（您可以在`IteratorImplementation`“内部”创建一个类`Iterator`以保持整洁。）

在您的类中，返回一个具有自定义子类的`Container`实例：`Iterator``IteratorImplementation``ctor`

```
class ObjectContainer
{
    public:
        void insert(Object *o);
        // ...

        Iterator<Object *> begin();
        Iterator<Object *> end();

    private:
        class CustomIteratorImplementation :
            public IteratorImplementation<Object *>
        {
            public:
                // Re-implement stuff here.
        }
};

Iterator<Object *> ObjectContainer::begin()
{
    CustomIteratorImplementation *impl = new CustomIteratorImplementation();  // Wish we had C++0x's "var" here.  ;P

    return Iterator<Object *>(impl);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T22:19:22.767

听起来不太复杂。您可以在外部定义迭代器。您还可以使用 typedef。我认为这样的东西会适合。请注意，如果 MagicIterator*不是*免费模板，而是 Item 的成员，可能会在 Container 中进行类型定义，这样会更简洁。就像现在一样，其中有一个循环引用，这使得编写一些丑陋的解决方法代码变得很有必要。

```
namespace detail {
    template<typename T, typename U>
    struct constify;

    template<typename T, typename U>
    struct constify<T*, U*> {
        typedef T * type;
    };

    template<typename T, typename U>
    struct constify<T*, U const*> {
        typedef T const * type;
    };
}

template<typename DstType, 
         typename Container,
         typename InputIterator>
struct MagicIterator;

class Container
{
private:
    struct Item
    {
        Object* pObject;
    };

    std::list<Item> m_items;

public:

    // required by every Container for the iterator
    typedef std::list<Item> iterator;
    typedef std::list<Item> const_iterator;

    // convenience declarations
    typedef MagicIterator< IInterface*, Container, iterator > 
        item_iterator;
    typedef MagicIterator< IInterface*, Container, const_iterator > 
        const_item_iterator;

    item_iterator Begin();
    item_iterator End();
};

template<typename DstType, 
         typename Container = Container,
         typename InputIterator = typename Container::iterator>
struct MagicIterator : 
    // pick either const T or T, depending on whether it's a const_iterator.
    std::iterator<std::input_iterator_tag, 
                  typename detail::constify<
                           DstType, 
                           typename InputIterator::value_type*>::type> {
    typedef std::iterator<std::input_iterator_tag, 
                 typename detail::constify<
                          DstType, 
                          typename InputIterator::value_type*>::type> base;
    MagicIterator():wrapped() { }
    explicit MagicIterator(InputIterator const& it):wrapped(it) { }
    MagicIterator(MagicIterator const& that):wrapped(that.wrapped) { }

    typename base::value_type operator*() {
        return (*wrapped).pObject->GetInterface();
    }

    MagicIterator& operator++() {
        ++wrapped;
        return *this;
    }

    MagicIterator operator++(int) {
        MagicIterator it(*this);
        wrapped++;
        return it;
    }

    bool operator==(MagicIterator const& it) const {
        return it.wrapped == wrapped;
    }

    bool operator!=(MagicIterator const& it) const {
        return !(*this == it);
    }

    InputIterator wrapped;
};

// now that the iterator adepter is defined, we can define Begin and End
inline Container::item_iterator Container::Begin() {
    return item_iterator(m_items.begin());
}

inline Container::item_iterator Container::End() {
    return item_iterator(m_items.end());
} 
```

现在，开始使用它：

```
for(MagicIterator<IInterface*> it = c.Begin(); it != c.End(); ++it) {
    // ...
} 
```

您还可以使用 boost 提供的迭代器 mixin，其工作方式类似于 boost::function_output_iterator 的输入版本。它调用您的迭代器`operator()`，然后返回适当的值，按照我们`operator*`的原则执行上述操作。你在`random/detail/iterator_mixin.hpp`. 这可能会导致更少的代码。但它也需要我们绞尽脑汁来确保朋友的东西，因为 Item 是私有的，并且迭代器没有在 Item 中定义。无论如何，祝你好运:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T21:36:21.200

它实际上取决于, 因为和`Container`的返回值是实现定义的。`c.Begin()``c.End()`

如果`Container`已知可能的 s列表，则`MagicIterator`可以使用包装类。

```
template<typename T>
class MagicIterator
{
    public:
        MagicIterator(std::vector<T>::const_iterator i)
        {
            vector_const_iterator = i;
        }

        // Reimplement similarly for more types.
        MagicIterator(std::vector<T>::iterator i);
        MagicIterator(std::list<T>::const_iterator i);
        MagicIterator(std::list<T>::iterator i);

        // Reimplement operators here...

    private:
        std::vector<T>::const_iterator vector_const_iterator;
        std::vector<T>::iterator       vector_iterator;
        std::list<T>::const_iterator   list_const_iterator;
        std::list<T>::iterator         list_iterator;
}; 
```

**简单**的方法是使用接受`Container`'s 类型的模板：

```
// C++0x
template<typename T>
class Iterator :
    public T::iterator
{
    using T::iterator::iterator;
};

for(Iterator<Container> i = c.begin(); i != c.end(); ++i)
{
    // ...
} 
```

[更多信息在这里。](https://stackoverflow.com/questions/407881/can-i-use-templates-instead-of-macros-for-exception-class-creation)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T21:25:35.717

我看不出你为什么不能完全按照你的规定来实现它……我错过了什么吗？

为了澄清，您需要在 Container 类上放置某种访问器方法。它们可以是私有的，您可以将 MagicIterator 声明为朋友，如果您认为这是封装它的最佳方式，但我会直接公开它们。这些访问器方法将使用 Container 内的普通 STL 迭代器并执行到 IInterface 的转换。因此，迭代实际上将使用 Container 的访问器方法完成，而 MagicIterator 将只是一种代理对象，以使其更容易。为了使其可重入，您可以让 MagicIterator 传入某种 ID 以在 Container 中查找 STL 迭代器，或者实际上可以让它作为`void *`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-24T17:53:10.200

我现在找到了一个更适合我最初目的的解决方案。不过我还是不喜欢：）

该解决方案涉及在 IInterface* 上对 MagicIterator 进行模板化，并使用指向迭代器的 void*、所述迭代器的字节大小以及指向在所述 void* 上执行标准迭代函数（例如递增、递减、取消引用等。 MagicIterator 假定将给定的迭代器 memcpy 到内部缓冲区是安全的，并通过将自己的缓冲区作为 void* 传递给提供的函数来实现其自己的成员，就好像它是原始迭代器一样。

然后容器必须实现静态迭代函数，将提供的 void* 转换回 std::list::iterator。Container::begin() 和 Container::end() 只需构造一个 std::list::iterator，将指向它的指针连同其迭代函数表一起传递给 MagicIterator，然后返回 MagicIterator。

这有点恶心，打破了我关于“no memcpy()”的原始规则，并对所讨论的迭代器的内部进行了假设。但它避免了堆分配，保持 Collection 的内部（包括 Item）私有，使 MagicIterator 完全独立于相关集合和 IInterface*，并且理论上允许 MagicIterators 与任何集合一起工作（前提是它的迭代器可以安全地 memcopy()' d)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-27T08:16:10.687

访问者可能是一个更简单（因此更容易维护）的解决方案。

# visual-studio-2005 - 你能启动和停止边界检查器（DevPartner）吗？

> ID：470836
> 
> 赞同：1
> 
> 时间：2009-01-22T21:17:57.713
> 
> 标签：visual-studio-2005, bounds-checker, devpartner

我正在尝试使用 boundschecker 来分析一个相当复杂的程序。使用 boundschecker 运行程序几乎太慢了，无法使用，因为我需要将近一天的时间才能将程序运行到代码中我怀疑存在问题的位置。谁能给我一些关于如何在 Visual Studio 2005 中使用 boundschecker (DevPartner) 检查我的软件的某些部分的想法？

提前感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T15:27:27.700

几年前我最后一次使用 BoundsChecker，并且遇到了同样的问题。对于大型项目，它会使一切运行得如此缓慢以至于毫无用处。我们最终放弃了它。

但是，我们仍然需要它的一些功能，但像您一样，不需要整个程序。所以我们必须自己做。

在我们的案例中，我们主要使用它来尝试追踪内存泄漏。如果这也是您的目标，那么还有其他选择。

1.  当程序退出时，Visual Studio 可以很好地告诉您有关内存泄漏的信息
2.  它按照创建的顺序报告泄漏
3.  如果你的源文件在顶部有这个，它会告诉你泄漏的内存是在哪里创建的

```
#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif 
```

这些帮助很大，但通常还不够。在任何地方添加该片段并不总是可行的。如果您使用工厂类，那么知道分配内存的位置根本没有帮助。因此，当所有其他方法都失败时，我们会利用 #2。

添加如下内容：

```
#define LEAK(str) {char *s = (char*)malloc(100); strcpy(s, str);} 
```

然后，用 "LEAK("leak1");" 给你的代码添点色彩 管他呢。运行程序，然后退出。您的新泄漏字符串将显示在 Visual Studio 的泄漏转储中，围绕现有泄漏。继续添加/移动您的 LEAK 语句并重新运行程序以缩小搜索范围，直到您确定确切的位置。然后修复泄漏，删除调试泄漏，一切就绪！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-14T23:39:46.093

BoundsChecker 非常详细地跟踪所有内存分配和释放。例如，它知道这样那样的内存分配是从 C 运行时堆中完成的，而后者又是从 Win32 堆中获取的，而 Win32 堆又开始作为由 VirtualAlloc 分配的内存。如果应用程序被检测（FinalCheck），它还具有有关哪些指针引用内存的详细信息。

这是事情缓慢的（许多）原​​因之一。

如果 BC 延迟连接到应用程序，它将不会构建任何这些数据，并且会 (1) 立即将其全部挖掘出来，或者 (2) 开始猜测事情。这两种解决方案都不是很实用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-29T14:58:33.250

减轻 BoundsChecker 的一种方法是从检测中排除除您感兴趣的少数模块之外的所有模块。我知道这不是很好，因为如果您知道泄漏在哪里，您就不需要 BoundsChecker。我通常建议您首先使用 BC 的 Active Check 模式，只有 Memory Tracking 可用。你错过了 API 验证，但你总是可以单独重新运行它。在您运行 Active Check 并获得有关哪些模块容易出现问题的线索后，您才可以为感兴趣的一个或多个模块及其依赖项启用检测。我们知道 Final Check 非常慢，但正如 Mistiano 正确指出的那样，使用 Final Check 不仅可以保存所有已分配块的图表，还可以保存所有指向它们的指针和上下文。Final Check 的神奇之处就在于如何在发生时发现泄漏和损坏，而不仅仅是在应用程序关闭或故障时。无耻的插件：我在 DevPartner 团队工作。我们将于 2011 年 2 月 4 日发布 DPS 10.5，在 BC 中支持 x64 应用程序。与仅提供 Active Check 的 Itanium 相对古老且销量较低的 BC64 不同，DPS 10.5 为 x64 应用程序提供完整的 Final Check 支持，包括纯 C++ 和在 .NET 进程中运行的本机模块。有关详细信息，请参阅 MF Developer 下的 microfocus.com。5 为 x64 应用程序提供完整的最终检查支持，包括纯 C++ 和在 .NET 进程中运行的本机模块。有关详细信息，请参阅 MF Developer 下的 microfocus.com。5 为 x64 应用程序提供完整的最终检查支持，包括纯 C++ 和在 .NET 进程中运行的本机模块。有关详细信息，请参阅 MF Developer 下的 microfocus.com。

# c++ - 如何使用 Boost Filesystem Library 在 MSCV 中解决 LNK1104 错误？

> ID：470840
> 
> 赞同：10
> 
> 时间：2009-01-22T21:20:13.293
> 
> 标签：c++, visual-c++, boost, filesystems, linker

我无法让我的项目链接到 Microsoft Visual C++ 2008 Express Edition 中的 Boost（版本 1.37.0）文件系统 lib 文件。Filesystem 库**不是**仅头文件库。我一直在关注官方 boost 网页上发布的*[Windows 入门指南。](http://www.boost.org/doc/libs/1_37_0/more/getting_started/windows.html)*以下是我采取的步骤：

1.  我使用 bjam 来构建完整的 lib 文件集：

    ```
    bjam --build-dir="C:\Program Files\boost\build-boost" --toolset=msvc --build-type=complete 
    ```

2.  我将*/libs*目录（位于*C:\Program Files\boost\build-boost\boost\bin.v2*）复制到*C:\Program Files\boost\boost_1_37_0\libs。*

3.  在 Visual C++ 中，在*Project > Properties > Additional Library Directories*下，我添加了以下路径：

    *   *C:\Program Files\boost\boost_1_37_0\libs*
    *   *C:\Program Files\boost\boost_1_37_0\libs\filesystem\build\msvc-9.0express\debug\link-static\threading-multi*

    无奈之下，我加了第二个。它是*libboost_system-vc90-mt-gd-1_37.lib*所在的确切目录。

4.  在*Configuration Properties > C/C++ > General > Additional Include Directories*我添加了以下路径：

    *   *C:\Program Files\boost\boost_1_37_0*
5.  然后，为了锦上添花，在*Tools > Options VC++ Directories > Library files*下，我添加了步骤 3 中提到的相同目录。

尽管如此，当我构建我的项目时，我收到以下错误：

```
fatal error LNK1104: cannot open file 'libboost_system-vc90-mt-gd-1_37.lib' 
```

此外，这是我尝试编译的代码以及（假定正确的）lib 文件所在的上述目录的屏幕截图：

```
#include "boost/filesystem.hpp"   // includes all needed Boost.Filesystem declarations
#include <iostream>               // for std::cout
using boost::filesystem;          // for ease of tutorial presentation;
                                  //  a namespace alias is preferred practice in real code

using namespace std;

int main()
{
    cout << "Hello, world!" << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-22T22:54:04.943

费鲁乔的回答包含了大部分的洞察力。然而，Pukku 让我意识到我的错误。我发布自己的答案以给出完整的解释。正如 Ferruccio 解释的那样，Filesystem 依赖于两个库。对我来说，这些是：

*   libboost_system-vc90-mt-gd-1_37.lib
*   libboost_filesystem-vc90-mt-gd-1_37.lib

我一定没有注意到，当我提供*libboost_filesystem-vc90-mt-gd-1_37.lib*的目录时，错误输出从

```
fatal error LNK1104: cannot open file 'libboost_filesystem-vc90-mt-gd-1_37.lib' 
```

到

```
fatal error LNK1104: cannot open file 'libboost_system-vc90-mt-gd-1_37.lib' 
```

让我认为错误仍然存​​在。这导致我发布一些相当不准确的信息。另外，在阅读了 Filesystem 需要两个库之后，我现在看到了关键字**stage**对于 bjam 命令的意义。供应

```
bjam --build-dir="C:\Program Files\boost\build-boost" --toolset=msvc --build-type=complete stage 
```

导致 bjam在*boost_1_37_0*目录中放置一个名为*stage*的附加目录。此文件夹包含一个名为*/lib*的文件夹，该文件夹在一个位置包含所有 lib 文件的副本。这对 Visual C++ 来说很方便，因为您可以为它提供这个单一目录，它会处理所有依赖项。

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T22:07:48.563

boost::filesystem 依赖于 boost::system，所以你需要两个路径。

部分问题是您使用的是构建目录之外的 boost 库而不是安装目录（boost 构建过程应该同时创建两者）。install/lib 目录包含所有库，因此您只需指定一个路径。

boost 构建过程在其自己的目录中构建每个库。最后，它将所有这些 .lib 文件复制到一个公共 lib 目录中。

由于您没有将安装目录指定为构建命令的一部分（使用 --prefix=...），我相信默认值为 C:\Boost。检查该目录是否存在，如果存在，请使用 C:\boost\include\ boost-1_37 作为包含路径，使用 C:\boost\lib 作为库路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-22T10:28:51.937

我认为真正的原始问题与 windows 上的默认 boost 构建过程有关，该过程需要静态链接一个具有 name 的库`beginning libboost_sytem<etc..>`。你需要的宏是

```
#define BOOST_SYSTEM_DYN_LINK 
```

这确保了 Boost.System 库是动态链接的。动态库名称`boost_system<etc...>`与静态库名称相同`libboost_sytem<etc...>`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-24T15:08:53.660

最后一个答案是对的。但是你应该找到 boost 配置文件 $BOOST\config\user.hpp 并取消注释这个指令#define BOOST_ALL_DYN_LINK。现在它开始使用带有 boost 的动态链接，它应该可以工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-22T21:22:32.460

您发布的错误抱怨文件 libboost_system-vc90-mt-gd-1_37.lib，但在目录中您只有 libboost_*文件*system-vc90-mt-gd-1_37.lib，对吗？

查找 libboost_system-vc90-mt-gd-1_37.lib。如果找到了，将对应的目录添加到库搜索路径中。如果找不到，请查看是否有 boost_system-vc90-mt-gd-1_37.lib（就像我一样），然后尝试将其复制到所需的文件名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T21:28:54.493

bjam 命令行应该已经构建了所有库的所有版本。不过，当你用

```
bjam --build-dir="C:\Program Files\boost\build-boost" --toolset=msvc --build-type=complete stage 
```

（注意`stage`最后）所有库都被复制到一个通用的 libs/ 文件夹中，因此当您只将此 libs/ 文件夹添加到您的库路径时，MSVC 的自动链接功能就会起作用。

我不知道 bjam 是否`stage`仍将所有这些文件复制到一个文件夹中。如果没有，请执行这样的`stage`构建来执行此操作。如果它们是，好吧，对不起，配置似乎是正确的，也许是某个地方的小打字错误？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-11T18:47:49.220

我遇到了同样的问题，您需要做的是将顶级 boost 文件夹下的“lib”目录添加到 Visual C++ 中的库路径中。

这绝对为我解决了这个问题。

# c# - Winforms WPF 互操作 - WPF 内容无法绘制

> ID：470846
> 
> 赞同：10
> 
> 时间：2009-01-22T21:21:43.120
> 
> 标签：c#, .net, wpf, winforms

我有一个使用 ElementHost 来显示 WPF 用户控件的 WinForm。当表单加载 WPF 内容时，每 50 次左右无法绘制一次。您可以通过 WinForm chrome 查看下方的任何内容。调整窗口大小会显示 WPF 内容。

这是一个已知的问题？任何人都可以提出解决方法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T23:19:23.537

我们以前曾解决过这些类型的问题。有关我们特定风格的更多信息，请参阅此 WPF 论坛[帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/a8a5eebc-3d9e-44bb-abe3-8ce0d4e48263/)（我不知道这是否是同一个问题）。

我们发现唯一可行的方法是**更改​​ ElementHost 的大小**。

```
_elementHost.Width++; 
```

这是一个完整的黑客，丑陋，我什至都不好意思发布它。但没有其他任何东西对我们有用。因此，这绝对是一种解决方法。（咧嘴笑）

我们在 ElementHost 上尝试了 Invalidate、Refresh 和我们能想到的一切……。我们还在 WPF 托管内容上尝试了 InvalidateMeasure、InvalidateArrange 和 InvalidateVisual。没运气。

如果您找到另一种方法来解决您的问题，我很想听听。

祝你好运，我知道我在这个上掉了一些头发。

**更新 1：** 我已经提交了另一个 WPF 论坛[帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/c221382e-82f1-4736-956a-806dc2a8cb37)。也许我们可以得到微软的回应。当然对我来说似乎是一个错误。

**更新 2：** 在我用上述 hack 修复了刷新问题之后……我还有另一个问题需要解决，我认为这里值得一提。也就是说：在屏幕刷新之前有一定的延迟。这使得用户看起来好像正在导航到另一个屏幕（它不是......它只是双缓冲缓冲区的内容）。我最终不得不在托管 ElementHost 的控件上手动调用 System.Windows.Forms.Control.Refresh()。这样一来，即使暂停仍然存在……至少屏幕是空白的……而且看起来用户没有导航到某个地方……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T13:37:41.597

以下对我有用。
在`Form_Activated`活动中，我添加了以下内容

```
elementHost1.HostContainer.InvalidateVisual(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-11T17:58:28.820

我知道这个帖子很老了，但是在.net的更高版本（即3.5）中，你可以尝试使用软件渲染模式。当您在 ElementHost 中托管 WPF 控件时，这似乎解决了很多问题。

参考：[软件渲染模式 - WPF](https://stackoverflow.com/questions/4951058/software-rendering-mode-wpf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T21:25:58.850

也许在 ElementHost 上调用 Invalidate？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T15:28:39.467

您是否尝试过使用反射来查看 _elementHost.Width++ 背后的代码？

# matlab - 如何检查图形是否打开以及如何关闭它？

> ID：470851
> 
> 赞同：11
> 
> 时间：2009-01-22T21:24:31.803
> 
> 标签：matlab

我的 m 文件根据参数打开图形。有时是一个数字，有时它会打开 2 个数字。

如果用户调用该函数，数字就会出现。如果他再次使用其他参数调用该函数，我将在新绘图之前使用 clf 清除数字。

如果第二个调用设置为仅绘制一个图形，则第二个（由前一个调用打开）保持灰色（因为 clf）。

有没有办法检查它是否打开和关闭？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-22T21:54:32.070

```
close all 
```

将关闭所有打开的数字。

您可以`findobj()`通过指定搜索参数来查找可能存在的对象。例如：

```
figure('name','banana') 
```

创建一个名为香蕉的图窗。

```
close(findobj('type','figure','name','orange')) 
```

什么都不做，因为没有打开名称为橙色的图形。

```
close(findobj('type','figure','name','banana')) 
```

关闭图窗。

您可以指定搜索参数以满足您的需要。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-22T23:27:26.750

我有点不清楚你所说的“开放”是什么意思。数字实际上没有“打开”或“关闭”状态。它们要么存在，要么不存在。[图形](http://www.mathworks.com/help/techdoc/ref/figure.html)命令将返回一个句柄到它制作的图形：

```
hFig = figure(...your arguments here...); 
```

您还可以从[FINDOBJ](http://www.mathworks.com/help/techdoc/ref/findobj.html)函数中获取图形句柄，该函数将查找与您传递给它的属性值匹配的所有图形对象：

```
hFig = findobj(...your property/value pairs here...); 
```

您可以使用以下任一命令摆脱图形：

```
close(hFig);
delete(hFig); 
```

[您可以使用函数ISHANDLE](http://www.mathworks.com/help/techdoc/ref/ishandle.html)检查图形是否已关闭/删除：

```
ishandle(hFig)  %# Returns 'true' if the figure exists, 'false' if it doesn't 
```

图形也可以是“可见的”或“不可见的”。它们有一个[`'Visible'`属性](http://www.mathworks.com/help/techdoc/ref/figure_props.html#Visible)，您可以获取或设置以下值：

```
get(hFig,'Visible')        %# Returns 'on' or 'off'
set(hFig,'Visible','off')  %# Makes a figure invisible, but it still
                           %#   exists (i.e. it's not closed) 
```

如果你想检查一个数字是否被最小化，那可能会有点困难。我相信在 MathWorks File Exchange 上有一些文件可以帮助您：这里有[一个](http://www.mathworks.com/matlabcentral/fileexchange/3407)可以查看。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-23T19:16:37.940

在 MATLAB 中，您可以获取有关“根”的信息。数字是“根”的子级（根的句柄为 0），它们是根的唯一子级。

[http://www.mathworks.com/help/techdoc/creating_plots/f7-41259.html](http://www.mathworks.com/help/techdoc/creating_plots/f7-41259.html)

知道了这一点，您可以尝试使用此代码查找 root 的孩子，并为您提供一个列表。

```
>> close all
>> get(0,'children')
ans =
   Empty matrix: 0-by-1
>> figure(1)
>> get(0,'children')
ans =
     1
>> figure(3)
>> get(0,'children')
ans =
     3
     1 
```

我想你会发现这是查询哪些数字是开放的最直接的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-05T15:17:12.807

```
isempty(findobj('name','Your_Figure_Name')) 
```

如果答案是 0，那么你的图是开放的

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-02T23:01:31.003

如果在您的方法中，您将创建一个没有“名称”的图形：

```
function [] = myMethod()
    myFigure = figure()
end 
```

下次您将无法访问 myFigure 句柄。所以：

```
function [] = myMethod()
    if ishandle(myFigure) % will fault, cant find variable myFigure
        close(myFigure)  % will fault
        delete(myFigure) % will fault
    end

    myFigure = figure()
end 
```

当他说：

> 您可以使用 ISHANDLE 函数检查图形是否已关闭/删除：

他的意思是您只能在恢复手柄后检查：

```
function [] = createMyFigure()
    recoveredHandle = findobj('type','figure', 'Name', 'myFigureName')
    close(recoveredHandle)
    delete(recoveredHandle)
    ishandle(recoveredHandle)

    myFigure = figure('Name','myFigureName') % now create figure
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T21:37:16.567

要关闭图形，有“关闭”功能。我还在找一个来检查一个数字是否打开。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-04-02T08:57:32.440

```
for f=1:numel(findobj('type','figure'))
    close(figure(f));
end
clear('f') 
```

# iphone - iPhone 上的免费*常规* 应用程序 - 如何显示广告？

> ID：470852
> 
> 赞同：4
> 
> 时间：2009-01-22T21:25:02.177
> 
> 标签：iphone

哪些广告网络可供想要分发受广告支持的免费常规应用程序（不是 Web 小程序）的 iPhone 开发人员使用？

[由这个关于每小时 200 美元的糟糕应用程序的故事提示。](http://www.appleinsider.com/articles/09/01/22/iphone_developer_app_store_rewards_crap_apps.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T22:38:18.173

这是一个：

*   [捏媒体](http://www.pinchmedia.com/)

我正在制作这个社区 Wiki，以便任何人都可以添加到这个列表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T00:05:13.040

我见过一个塔防游戏（TapDefense），它让用户点击付费应用的链接来保存游戏。它使用 AdMob 作为其广告分销商。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T23:25:33.447

[The Deck](http://decknetwork.net/)以自己是一个非常“高质量”的广告网络而自豪。我在一些 iPhone 应用程序上见过它们，但它们显然对允许谁投放广告很挑剔。

# javascript - 将参数传递给匿名 Javascript 函数

> ID：470857
> 
> 赞同：0
> 
> 时间：2009-01-22T21:26:05.123
> 
> 标签：javascript, xmlhttprequest, dom-events, anonymous-methods

考虑下面的代码：

```
this.usedIds = 0;

this.SendData = function(data)
{
    var id = this.usedIds;
    this.usedIds++;

    this.xmlHttpThing.open("POST", "/Upload.aspx", true);
    this.xmlHttpThing.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

    var currentObject = this;
    this.xmlHttpThing.onreadystatechange = function() { currentObject.UploadComplete(id) };
    this.xmlHttpThing.send(data);
};
this.UploadComplete = function(id)
{
    if (this.xmlHttpThing.readyState == 4)
    {
        //First time id is 0
        //Second time id is 0                 <<<--------- Why??
        //Third time id is 1
        //Fourth time id is 2
        //Fifth time id is 3 ....         

        this.SendData("blabla");
    }
}; 
```

为什么我传递给匿名函数的 id 在第一次调用后会被一次调用延迟？

只有在 Firefox 中似乎是这种方式，在 IE`UploadComplete`中以正确的顺序接收 id。

在第二个循环中，我可以在 send(data) 行停止调试器并确认 id 实际上是 1，但是当我到达时，`UploadComplete`它在那个参数中结果是 0 :(

**编辑：找到解决方案：**
在 FireBug 中禁用控制台日志记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-22T21:31:07.577

我过去也有同样的问题。我不记得究竟是什么原因造成的，但我通过将增量移动到响应处理程序来修复它。

```
this.UploadComplete = function(id)
{
    if (this.xmlHttpThing.readyState == 4)
    {      
        this.usedIDs++;
        this.SendData("blabla");
    }
}; 
```

编辑：经过考虑，我的情况可能与您的情况不同。为什么`this.usedIDs`在分配时不增加`id`？

```
var id = this.usedIDs++; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:47:28.120

在 Firebug 中禁用控制台登录解决了这个问题！

# c# - 使用大量控件填充 FlowLayoutPanel 并按需绘制缩略图

> ID：470863
> 
> 赞同：6
> 
> 时间：2009-01-22T21:27:42.217
> 
> 标签：c#, .net, winforms, onpaint, flowlayoutpanel

我正在尝试制作`ImageListBox`一种可以显示大量缩略图的控件，例如 Picasa 使用的控件。

这是我的设计：

我有一个`FlowLayoutPanel`填充了很多对象的`UserControl`对象，例如 4,000 个。每个人都`UserControl`被分配了一个代表该`Paint`事件。当`Paint`事件被调用时，它会检查缩略图的内存缓存，如果图像不在缓存中，它会从磁盘中检索它。

我有两个要解决的问题：

1.  `Paint`即使`UserControl`不在视图中，WinForms 似乎也会触发一个事件。实际上只有 10 个左右的控件在视图中，其余的不是（`FlowLayoutPanel.AutoScroll`设置为`true`）。结果，它尝试检索所有图像的缩略图，这需要很长时间。

2.  将`UserControl`对象添加到其中`FlowLayoutPanel`需要一些较长的时间，大约 2-3 秒。我可以忍受它，但我想知道是否有比以下更好的方法：

    ```
    UserControl[] boxes = new UserControl[N];
    // populate array
    panel.SuspendLayout();
    panel.Controls.AddRange(boxes);
    panel.ResumeLayout(); 
    ```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T20:29:01.680

要提高使用用户控件填充 FlowLayoutPanel 的速度，请在添加控件时禁用布局更新。

在你的循环之前，先调用[`SuspendLayout()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.suspendlayout.aspx)，然后在结束调用[`ResumeLayout()`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.resumelayout.aspx)。`ResumeLayout()`即使发生异常，也要确保使用 try-finally 来保证运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T21:32:53.783

我不会添加那么多用户控件。相反，我将有一系列数据结构来存储有关要使用的缩略图、定位等信息，然后处理所需的每个缩略图的呈现。

当然，您只会渲染您需要的内容，方法是检查控件中的绘制事件参数并渲染视图中需要渲染的缩略图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T22:16:43.630

啊哈！我发现了一些东西。

当 UserControl 不在视图中并且它接收到 Paint 事件时，则 e.ClipRectangle.IsEmpty 为真！

# asp.net - 上传大文件时 InputStream 何时可用？

> ID：470865
> 
> 赞同：0
> 
> 时间：2009-01-22T21:28:42.027
> 
> 标签：asp.net, large-files, inputstream

上传大文件时 PostedFile.InputStream 何时可用？

我想将 Stream 传递给另一个进程，我希望如果正在上传一个大文件，我可以将 Stream 直接传递给该新进程，而无需写入文件系统。由于该过程和/或上传可能需要一段时间，我想知道是否可以立即开始读取 InputStream，或者是否必须等待整个文件传输到服务器才能处理。

我想一个更普遍的问题是 - 涉及文件上传时 POST 请求的生命周期是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T21:45:21.323

在`PostedFile.InputStream`整个文件上传之前不可用。IIS6 将文件缓存在内存中，而 IIS7 现在将文件缓存到磁盘，然后再将输入流传递给您的方法。

您可以获得一个 HttpModule，例如[NeatUpload](http://www.brettle.com/neatupload)，它允许您在上传时访问这些位。

# sorting - 如何对 FogBugz 案例表等数据表进行排序

> ID：470866
> 
> 赞同：6
> 
> 时间：2009-01-22T21:28:51.280
> 
> 标签：sorting, fogbugz

有人见过fogbugz如何对他们的表进行排序吗？当您单击对列进行排序时，它们实际上将表分解为许多具有每种信息类别的小表。

想知道是否有人知道他们是如何做到这一点的？

希望实现此功能。

如果您查看案例页面并进行排序，您就会明白我的意思。

任何帮助都是极好的！

这个还没想通。

**编辑：** @Peter，我不想在每次单击标题标题进行排序时回发并重新创建表格。我也想知道他们是否是一个通用的解决方案。如果我通过javascript单击标题进行排序，它将“一个”表分成许多表，我想知道它们是否是任何通用解决方案，因为它只是查看排序表的更好方法。

**编辑：**我确实需要一个 javascript 排序器，但如果你低头看fogbugz 的实现，它会产生不同的结果......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-12T21:00:10.010

是的，Rich 明白了（我很久以前就把这个功能编码到 FogBugz 中了）。

如果您必须在客户端上执行此操作，您别无选择，只能对数据进行排序，遍历它生成表行后的表行，并且每次点击新的排序值时，您都会创建一个带有适当信息的新标题。

老实说，这将是对这个 jQuery 插件的一个非常酷的修改：http: [//tablesorter.com/docs/](http://tablesorter.com/docs/)，您将能够利用他们的*大量*工作。如果您打算投入时间并创建一个通用解决方案，不妨让社区可以访问它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T18:24:40.747

在不知道 Fog Creek 是如何实现这一点的情况下，我的做法是输出一个表头，然后遍历列表，每次组值更改时输出一个页脚和一个新的表头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T22:12:24.093

不知道你期望什么答案。对此的 SQL 查询将简单地对选定列使用排序，并且每次该值更改时 UI 都会启动新表。

这是 FogBugz 的屏幕截图，点击 Priority 列后进行了排序。

[http://img297.imageshack.us/img297/6974/76755363ee3.png](http://img297.imageshack.us/img297/6974/76755363ee3.png)

当然，开始新表对每一列（标题、案例#）都没有意义。

* * *

编辑：如果我理解正确，您正在寻找一种如何在浏览器中执行此操作而不加载新页面的方法。如果是这种情况，我建议至少提供一些服务器端支持，这会以正确的顺序返回您的数据，并为子表正确结构化（在 xml/json/无论您使用什么）。您的 javascript 将使用此数据重新创建表。我相信其他有更多 web-ui 经验的人会为您提供更好的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T22:49:38.083

我使用了来自 Kryogenix的[Sortable Tables 脚本，结果很好。](http://www.kryogenix.org/code/browser/sorttable/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T11:22:00.017

我不知道它是否相关，但是我们将查询的结果存储在 SQL 中的临时表中，然后引用 current-row-less-one 以查看 Category 是否已更改，并在结果集中指出这一点。

在某些情况下，我们用包含

```
<tr><td colspan=999>Category Heading</td></tr> 
```

这样网页就可以将其“注入”到它正在构建的表中。

```
SELECT Col1, Col2, ...,
       [CATEGORY] = CASE WHEN T1.CategoryCol <> COALESCE(T2.CategoryCol, '')
           THEN '<tr><td colspan=999>' + T1.CategoryCol + '</td></tr>'
           ELSE ''
           END
FROM #MyTempTable AS T1
     LEFT OUTER JOIN #MyTempTable AS T2
         ON T2.ID = T1.ID - 1 
```

# sql - SQL查询返回一个或多个字段包含特定值的所有行

> ID：470875
> 
> 赞同：0
> 
> 时间：2009-01-22T21:30:36.517
> 
> 标签：sql

是否可以在表上运行选择以快速找出是否**有任何**（一个或多个）字段包含某个值？

或者您是否必须在 where 子句中写出所有列名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T21:41:49.363

正如其他人所说，您可能必须手动或以编程方式将所有列写入 WHERE 子句。SQL 不包含直接执行此操作的功能。一个更好的问题可能是“你为什么需要这样做？”。需要使用这种类型的查询可能是一个很好的指标，表明您的数据库没有正确[规范化](http://en.wikipedia.org/wiki/Database_normalization)。如果您告诉我们您的架构，我们也可以帮助解决该问题（如果这是一个实际问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:36:41.077

我认为您需要列出 where 子句中的所有列。不过，我离 SQL 向导还很远……也许其他人知道方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:36:50.717

你必须写出来

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T21:37:25.350

当然，您必须写出要用作标准的所有列。

如果您添加您正在使用的编程语言以及您在什么类型的环境中工作，我们可以为您提供有关如何动态执行此操作的线索或解决方案。

我认为您的问题实际上是如何根据程序用户在“搜索”表单中填写的内容动态地执行此操作。我对吗？

如果没有，那么.. 给我们更多信息。;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-22T21:49:49.177

挖这个...它将搜索数据库中的所有表，但您可以将其修改为仅一个表。

```
/*This script will find any text value in the database*/
/*Output will be directed to the Messages window. Don't forget to look there!!!*/

SET NOCOUNT ON
DECLARE @valuetosearchfor varchar(128), @objectOwner varchar(64)
SET @valuetosearchfor = '%staff%' --should be formatted as a like search 
SET @objectOwner = 'dbo'

DECLARE @potentialcolumns TABLE (id int IDENTITY, sql varchar(4000))

INSERT INTO @potentialcolumns (sql)
SELECT 
    ('if exists (select 1 from [' +
    [tabs].[table_schema] + '].[' +
    [tabs].[table_name] + 
    '] (NOLOCK) where [' + 
    [cols].[column_name] + 
    '] like ''' + @valuetosearchfor + ''' ) print ''SELECT * FROM [' +
    [tabs].[table_schema] + '].[' +
    [tabs].[table_name] + 
    '] (NOLOCK) WHERE [' + 
    [cols].[column_name] + 
    '] LIKE ''''' + @valuetosearchfor + '''''' +
    '''') as 'sql'
FROM information_schema.columns cols
    INNER JOIN information_schema.tables tabs
        ON cols.TABLE_CATALOG = tabs.TABLE_CATALOG
            AND cols.TABLE_SCHEMA = tabs.TABLE_SCHEMA
            AND cols.TABLE_NAME = tabs.TABLE_NAME
WHERE cols.data_type IN ('char', 'varchar', 'nvchar', 'nvarchar','text','ntext')
    AND tabs.table_schema = @objectOwner
    AND tabs.TABLE_TYPE = 'BASE TABLE'
ORDER BY tabs.table_catalog, tabs.table_name, cols.ordinal_position

DECLARE @count int
SET @count = (SELECT MAX(id) FROM @potentialcolumns)
PRINT 'Found ' + CAST(@count as varchar) + ' potential columns.'
PRINT 'Beginning scan...'
PRINT ''
PRINT 'These columns contain the values being searched for...'
PRINT ''
DECLARE @iterator int, @sql varchar(4000)
SET @iterator = 1
WHILE @iterator <= (SELECT Max(id) FROM @potentialcolumns)
BEGIN
    SET @sql = (SELECT [sql] FROM @potentialcolumns where [id] = @iterator)
    IF (@sql IS NOT NULL) and (RTRIM(LTRIM(@sql)) <> '')
    BEGIN
        --SELECT @sql --use when checking sql output
        EXEC (@sql)
    END
    SET @iterator = @iterator + 1
END

PRINT ''
PRINT 'Scan completed' 
```

# c# - 为每个环境的配置文件使用单独的 MSI 构建

> ID：470876
> 
> 赞同：1
> 
> 时间：2009-01-22T21:30:59.510
> 
> 标签：c#, .net, deployment, build-environment

对于一个客户，我必须交付他们在 QA 和生产中使用的构建。构建文件的校验和必须匹配——它在 QA 和生产之间根本不能改变。每个环境的配置都不同，所以我有一个只包含代码的构建，然后为每个环境单独构建一个只包含环境特定配置文件的构建。无论环境如何，构建的配置文件都会将文件放在相同的位置，因此代码始终可以加载 c:\myapp\myconfig.xml，其中将包含该环境的设置。我读过的大多数文章（例如[Scott Hanselman 的](http://www.hanselman.com/blog/ManagingMultipleConfigurationFileEnvironmentsWithPreBuildEvents.aspx)) 涉及每个环境的不同构建，但这不起作用，因为校验和值会不同。我应该以其他方式部署这些配置文件，还是有可行的解决方案？我当前解决方案的一个问题是它需要多个几乎相同但不完全相同的配置文件。因此，必须将一项更改添加到多个文件中，这是我想避免的，但我不知道该怎么做，除非在构建时或使用复制正确文件的外部脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:16:29.563

不确定您的设置是否更复杂，但我们有类似的问题，我们添加了一个自定义操作类，该类根据环境（用户在安装过程中选择）更新配置文件，然后将此自定义操作项目添加到您的设置中项目。这样，无论您要安装到什么环境，您都可以使用一个安装程序 exe。

如果您有兴趣，请告诉我，我可以发布一些示例或更多关于我们如何完成它的信息。

以下是更多细节：

1.  向您的安装项目添加一个新对话框以向用户请求环境（我们使用 4 个单选按钮对话框与我们拥有的 4 个环境：dev、qa、staging 和 production）
2.  配置 4 个单选按钮的值和该值将设置的属性，即“环境”（稍后由 CustomActions 类使用）
3.  使用单个类 (CustomActions) 将 dll 项目添加到您的解决方案
4.  在 CustomAction 类中，您将我们在第二步中配置的属性读取为：

    ```
     if(!this.Context.Parameters.ContainsKey("environment"))
        {
            string error = "'environment' argument is null. Please configure config file manually";
            //...handle your error, etc.
            return;
        }

        string env = this.Context.Parameters["environment"]; 
    ```

5.  现在您的 env 变量包含我们在步骤中分配给每个单选按钮的值。然后，您可以使用 switch 语句来决定用户选择的环境。并使用以下命令适当地更新您的配置文件：

配置配置 = ConfigurationManager.OpenExeConfiguration(this.servicePath); //例如，要更改您将使用的连接字符串： config.ConnectionStrings.ConnectionStrings["oracle"] = "dev conn string here";

6.  回到您的设置项目，将 CustomActions 项目的输出添加到您的 CustomActions 编辑器（查看菜单 -> 编辑器 -> 自定义操作）

7.  最后，配置安装项目的 CustomActionData 属性以将环境和其他变量传递给 CustomAction 类（我的看起来像这样：/serviceFolder="[TARGETDIR]\" /serviceExe="blahblah.exe" /serviceName="MyServiceName " /environment="[环境]"

希望这有意义并适用于您的解决方案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T23:58:56.687

假设：

1) XML 配置文件

2）构建之间的更改总数很少（即使复制到许多配置文件）

我会让安装程序在安装时处理更新配置文件

例如，我们将 WiX v3 用于我们的安装程序，并在安装期间使用 XmlFile 元素更新几个配置文件的值

<util:XmlFile Action="setValue" File="[DIRECTORIES.WEBSERVICES]web.config" ElementPath="//configuration/system.web/compilation" Name="debug" Value="false" Permanent="yes" / >

# apache - 重写文件路径中的 RewriteRule 检查文件是否存在

> ID：470880
> 
> 赞同：15
> 
> 时间：2009-01-22T21:31:22.677
> 
> 标签：apache, mod-rewrite, caching

如何使用 ModRewrite 检查缓存文件是否存在，如果存在，则重写缓存文件，否则重写动态文件。

例如，我有以下文件夹结构：

```
pages.php
缓存/
  页数/
   1.html
   2.html
   textToo.html
   等等

```

您将如何为此设置 RewriteRules，以便可以像这样发送请求：

```
example.com/pages/1

```

并且如果缓存文件存在rewrite to the cache file，如果缓存文件不存在，rewrite to pages.php?p=1

它应该是这样的：（注意这不起作用，否则我不会问这个）

```
RewriteRule ^pages/([^/\.]+) 缓存/pages/$1.html [NC,QSA]
RewriteCond %{REQUEST_FILENAME} -f [NC,OR]
RewriteCond %{REQUEST_FILENAME} -d [NC]
RewriteRule cache/pages/([^/\.]+).html pages.php?p=$1 [NC,QSA,L]

```

我可以使用 PHP 粗略地做到这一点，但我认为必须使用 mod_rewrite 才能做到。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-23T05:31:01.993

```
RewriteRule ^pages/([^/\.]+) cache/pages/$1.html [NC,QSA]

# At this point, we would have already re-written pages/4 to cache/pages/4.html
RewriteCond %{REQUEST_FILENAME} !-f

# If the above RewriteCond succeeded, we don't have a cache, so rewrite to 
# the pages.php URI, otherwise we fall off the end and go with the
# cache/pages/4.html
RewriteRule ^cache/pages/([^/\.]+).html pages.php?p=$1 [NC,QSA,L] 
```

关闭 MultiViews 也很重要（如果您启用了它们）。

```
Options -MultiViews 
```

否则，初始请求（/pages/...）将在 mod_rewrite 启动之前自动转换为 /pages.php。您也可以将 pages.php 重命名为其他名称（并更新最后的重写规则）以避免多视图冲突。

编辑：我最初包括`RewriteCond ... !-d`但它是无关的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-23T10:06:02.840

另一种方法是首先查看是否有可用的 chached 表示：

```
RewriteCond %{DOCUMENT_ROOT}/cache/$0 -f
RewriteRule ^pages/[^/\.]+$ cache/$0.html [L,QSA]

RewriteRule ^pages/([^/\.]+)$ pages.php?p=$1 [L,QSA] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-17T12:39:14.207

概括问题：将其插入到文件存在时不应匹配的规则上方。

```
RewriteCond %{REQUEST_FILENAME} !-f 
```

Sean Bright 的回答为缓存问题提供了一个很好的示例，但这条线的工作范围更广。就我而言，我有一个链接缩短器，人们可以在其中选择自定义 URL，我不希望它能够覆盖现有文件，例如`favicon.ico`. 在重写之前添加此行修复了该问题。

# java - OS X 上的 Intellij IDEA 设置

> ID：470882
> 
> 赞同：43
> 
> 时间：2009-01-22T21:32:43.940
> 
> 标签：java, macos, grails, intellij-idea

在 OS X 上为 Intellij IDEA 配置 jdk 和全局库源代码的可接受过程和路径是什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2010-11-01T05:44:16.377

截至最新版本：

*   适用于 Mac OS X 10.6 更新 3 的 Java
*   适用于 Mac OS X 10.5 更新 8 的 Java

苹果已经改变了一些事情。

引用 java-dev 邮件列表中的 Apple Java 人的话：

> 1.  系统 JVM 位于 /System/Library/...
>     
>     
>     *   这些 JVM 仅由 Apple 提供，一次只有 1 个主要平台版本。
>     *   一个版本始终会升级，并且只能通过 Apple 软件更新进行。
>     *   它应该始终是 GM 版本，开发人员可以恢复到，尽管他们安装了任何开发人员预览版或 3rd 方 JVM。
>     *   像 /System 中的其他所有内容一样，它属于 root rx，所以不要乱用它！
> 2.  开发人员 JVM 位于 /Library/Java/JavaVirtualMachines 下
>     
>     
>     *   Apple Java Developer Previews 安装在 /Library 下。
>     *   Developer .jdk 包包含开发人员可能需要的所有内容（src.jar、docs.jar 等），但太大而无法交付给数以千万计的 Mac 客户。
>     *   3rd 方 JVM 应该安装在这里。
> 3.  开发 JVM 本身的开发人员可以使用 ~/Library/Java/JavaVirtualMachines
>     
>     
>     *   从此目录符号链接到您当前的构建产品很方便，并且不会影响其他用户
> 4.  Java IDE 应该可能偏向于使用 /Library 或 ~/Library 检测到的 JVM，但如果这是唯一安装的 JVM，则应该能够回退到使用 /System/Library JVM（但不要指望 src 或 JavaDoc）。
>     
>     
> 
> 这使 Java 开发人员能够最大程度地灵活地安装多个版本的 JVM 以回归错误，甚至可以自己在 Mac 上开发 JVM。它还确保所有 Mac 客户都拥有一个安全、精简、安全的 JVM 版本，并且每次我们软件更新他们的 JVM 时，我们不会无休止地占用他们的磁盘空间。

因此，不应将 Intellij 指向 /System/Library/Frameworks/JavaVM.framework，而应指向 /Library/Java/JavaVirtualMachines 或 /System/Library/Java/JavaVirtualMachines 中的 JDK

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-22T22:20:31.953

在“项目设置”窗口中，转到“平台设置”下的“JDKs”部分。单击小加号并选择“JSDK”。文件选择器应在 /System/Library/Frameworks/JavaVM.framework/Versions 目录中打开。如果不是，那么只需导航到它。您可以在此处选择要添加的版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T22:19:29.243

IntelliJ 应该检测您安装的 JDK，因为它们位于 Apple 提供的标准位置。如果您想要 JDK 的源代码，也可以从 Apple 下载。注册一个免费的 ADC 帐户，然后您就可以获得访问权限。

对于全局库，我一直在享受最新版本中的 Maven 集成。它通过从 Maven 存储库中提取内容来减轻设置全局库的需要。它还将下载源代码和 javadoc jar。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T19:50:18.167

osx 自带的 JDK 不包含源码。您需要使用您的苹果帐户登录苹果开发者网站，才能找到包含 src.jar 的 SDK 的开发者版本。

[http://connect.apple.com/cgi-bin/WebObjects/MemberSite.woa/wo/5.1.17.2.1.3.3.1.0.1.1.0.3.1.3.3.1](http://connect.apple.com/cgi-bin/WebObjects/MemberSite.woa/wo/5.1.17.2.1.3.3.1.0.1.1.0.3.1.3.3.1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-25T20:14:47.107

Intellij 支持页面上的帖子解释了如何配置 Intellij 用来运行自身的 JDK。 [https://intellij-support.jetbrains.com/entries/23455956-Selecting-the-JDK-version-the-IDE-will-run-under](https://intellij-support.jetbrains.com/entries/23455956-Selecting-the-JDK-version-the-IDE-will-run-under)

# asp.net - ASP.NET Web 应用分发

> ID：470885
> 
> 赞同：5
> 
> 时间：2009-01-22T21:33:03.640
> 
> 标签：asp.net, web-applications, distribution

分发 asp.net Web 应用程序的最简单方法是什么？我试图查看一些开源的 asp.net 项目，看看他们如何分发他们的应用程序以及他们如何进行更新，它们对我来说似乎相当复杂（不是为了我自己，而是为了非技术用户）。其中很多需要备份整个安装的项目，删除特定文件夹并保存部分 web.config。我希望找到一种解决方案，使更新过程尽可能简单。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-22T21:40:10.773

我现在正在做一个有类似要求的项目。我们决定使用[WiX](http://wix.sourceforge.net/)创建一个安装程序，该安装程序可以在安装站点的服务器或机器上运行。WiX 非常强大，但需要一点时间才能掌握。

还有许多其他开源和付费安装程序技术。 [这是一个帖子](https://stackoverflow.com/questions/458900/free-software-for-windows-installers-nsis-vs-wix)，其中包含一些信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T21:39:04.817

CommunityServer 提供了一个设置 msi，它将创建一个虚拟目录、生成 SQL 数据库并使用默认数据填充它。更新点发布仍然是一个手动过程，涉及一个 update.sql 文件，让每个人都下载然后合并二进制和静态文件更改。

他们可能也创建了一个更新 msi，但是因为有很多人自定义 CommunityServer，所以让人们自己合并更改可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:38:47.373

您是指将功能分解为可以在不同机器上处理的层，例如，3 台服务器用于 3 层架构，其中一台是数据库服务器，一台处理中间件，另一台处理 ASP.Net 中的请求? 这里的另一点是在扩展方面从一个 Web 服务器到多个 Web 服务器。

还是您指的是[部署](http://en.wikipedia.org/wiki/Software_deployment)？

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-22T21:47:43.707

这是一个网络应用程序，伙计。公开服务，要求注册，然后继续。这不是 Web 应用程序的重点吗？

# vba - 我的宏怎么会被其他word文档中的事件触发

> ID：470886
> 
> 赞同：1
> 
> 时间：2009-01-22T21:33:12.907
> 
> 标签：vba, ms-word

我正在对 中的`WindowSelectionChange`事件执行代码`Microsoft Word`。为什么当我打开另一个文档时，其中没有引用此宏，代码仍在被调用`WindowSelectionChange`。我没有将宏存储在默认模板中，它存储在我的其他 Word 文档未引用的模板中。

有没有办法将此事件限制为包含`VBA`代码的文档？

* * *

宏事件仅在它们应该触发的文档同时打开时才会触发。该项目存储在我自己的 .dot 文件中，而不是默认模板。

这只是 word 中绑定事件的本质吗？它影响所有打开的文档。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-23T18:24:32.553

我相信 WindowSelectionChange 事件是在应用程序级别调用的，对吧？所以基本上我认为解决这个问题的方法是修改 WindowSelectionChange 中的代码，使其仅在 ActiveDocument = ThisDocument 时执行。ThisDocument 是存储您的代码的文档，因此您可以使代码仅在 ThisDocument 是 Word 中的活动文档时执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T21:43:54.073

您是否有可能在默认模板中而不是在特定文档中创建宏？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T21:48:55.480

是的，在宏编辑器中，确保您的代码在您的文档的项目中，并且位于名为“Normal”的项目中。

# .net - 如何使用 Deblector？

> ID：470892
> 
> 赞同：11
> 
> 时间：2009-01-22T21:35:23.200
> 
> 标签：.net, debugging, reflector

我正在使用第三方框架，代码很糟糕，而且我遇到了我无法弄清楚的异常。我能够使用[.NET Reflector](http://en.wikipedia.org/wiki/.NET_Reflector)进行反编译，现在我正在尝试使用[Deblector](http://deblector.codeplex.com/)进行调试，但我什至无法弄清楚如何设置断点。为什么没有此工具的文档？

没有关于如何使用它的信息。内置帮助只是提供了一个命令列表，我理解得很好，因为它们是标准的调试器命令......但我不知道如何让它工作，所以我可以单步执行代码，我需要也检查变量。

我在谷歌上搜索了很长时间，我能找到的只是博客说这个工具有多棒。好吧，我敢肯定，如果我能让它发挥作用，那将是非常酷的。文档在哪里，或者我如何设置断点？

我可以让它附加到我的进程中，但我不能暂停或任何事情，即使我已经激活了该选项，当异常发生时它也不会中断。

说真的......我们应该做一些文档 - 我会将它们发布到谷歌可以到达的地方。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-18T15:29:23.777

也许这会帮助你：

首先，我正在使用来自[http://www.codeplex.com/deblector的](http://www.codeplex.com/deblector)*DeblectorAddin-1.01-Alpha*（我不知道它在旧版本中是否也这样工作）。

使用此版本，使用以下过程非常简单：

*   附加到进程

    *   在命令行中使用**a[ttach]命令：** **a <pid>**。
    *   使用工具栏中的附加按钮（带有齿轮的窗口）。
*   如果附加成功（您在控制台中看到这一点，使用 Tools->Deblector 激活）应该加载所有引用的程序集。

*   设置断点（您必须暂停程序才能设置断点）：

    *   使用**b[reak]**命令：例如**b <Namespace.Class.Function>** - 有更多可用的选项使用**帮助 b**。
    *   简单得多：使用 Break 按钮（或`F9`）并在 Deblector [IL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)视图中选择一行。

* * *

***附加使用说明：***

**Deblector 命令行：**
如果您当前附加到某个进程并正在运行，则命令行将不会响应，您必须先停止，否则它将无法正确响应。

**对于 64 位平台：**
应用程序必须设置为作为 32 位应用程序运行，否则无法附加。

*在 Visual Studio 中：*项目 -> 属性 -> 构建平台目标：x86

*使用[corflags](http://msdn.microsoft.com/en-us/library/ms164699.aspx)工具*：这应该与 Visual Studio 一起安装（使用 Visual Studio 命令提示符）。

```
 To set 32-bit mode: corflags <ProgramName> /32BIT+ 
 To unset it:        corflags <ProgramName> /32BIT- 
```

**要查找进程 ID 并检查程序是否以 32 位或 64 位模式运行**：
[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)对此非常有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-05T10:03:09.070

现在有 Reflector Pro，它就是这样做的。它将托管程序集反编译为 C# 或 VB.NET，并创建必要的 PDB。然后，您可以设置断点并单步执行您喜欢的任何托管程序集。

[http://www.red-gate.com/products/reflector/walkthrough.htm](http://www.red-gate.com/products/reflector/walkthrough.htm)

# database - 将用户数据从一个软件复制到另一个软件的模式

> ID：470927
> 
> 赞同：0
> 
> 时间：2009-01-22T21:42:29.910
> 
> 标签：database, replication

我有一个与流行的论坛软件 (phpBB) 集成的网站。我已经设置好了，所以自动登录到主站点的用户也可以登录到论坛软件。我通过同时通过论坛的 API 进行身份验证来做到这一点。

当有人注册该站点时，一个条目进入主站点数据库，一个条目进入论坛用户数据库（使用论坛 API）。

论坛用户表的主 ID 存储在主站点用户数据库的列中。这是在注册时保存的：注册过程首先创建一个论坛用户，然后将 ID 传递回在主站点中创建用户的查询。

当用户登录时，如果他们通过主站点进行身份验证，则会提取该 ID 并将其传递到论坛登录 API 以登录正确的人。

然而，一件奇怪的事情似乎是随机发生的：每 30 或 40 个注册的人中就有一个人在主站点用户表中得到一个不属于他们自己的论坛用户 ID。我知道如何查找这些问题并根据具体情况进行修复，并有脚本来执行此操作，但这似乎更像是一个创可贴，而不是修复。

在链接这样的数据时，这是一个常见问题，还是这似乎与软件更具体？由于这个问题的随机性，它很难调试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T22:16:00.530

我会怀疑会话管理。您是有意还是无意地重用会话 ID？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T12:11:01.447

我用 vbulletin 做了类似的事情，直接使用论坛的 mysql 数据库来验证主站点和其他站点（它们都在同一台机器上）......

在您的情况下，我会在站点的数据库中添加不在 phpBB 数据库中的特定于站点的字段，并通过 user_id 将其链接到 phpbb ...它可能是插入两个数据库的主要站点上的一种形式（一些在主站点数据库中，其他在 phpBB 数据库中 - 具有更多权限字段），我会使用我自己的非标准验证码，比如生成一个扭曲的图像“x 和 y 是什么”，其中 x 和 y 作为随机数，+ 可能替换为其他操作，或“输入单词 ORANGE”或“再次输入您的用户名”的图像

我会禁用默认的 phpBB 注册...有很多机器人知道如何使用它...

这将保证您有一个信息来源，并且您可以一次填写所有信息。

# .net - 如何在 ASP.NET MVC 中验证这种情况？

> ID：470930
> 
> 赞同：2
> 
> 时间：2009-01-22T21:43:16.273
> 
> 标签：.net, asp.net, asp.net-mvc, validation, forms

首先，一点背景（因为我知道你们都喜欢它！）：

我有一个名为**Note**的模型。它有一个名为**Type**的字段，在数据库中，它是一个整数值，用于指定该注释属于哪种类型的对象（1 = 客户，2 = 销售线索等）。名为**Source**的第二个字段指定此便笺所属的特定对象的 ID。

例如，如果我想向 Customer #34 添加注释，我会将**Type**设置为 1，**Source**设置为 34。

为了帮助使事情更具可读性，我有一个名为**DataObjectType**的 Enum ，它包含每个可能的**Type**整数值到友好名称的映射。因此，例如，**DataObjectType.Customer与****Type**字段中的值 1 相同。

接下来，我有一个自定义路线：

```
/Notes/New/{type}/{id} 
```

和两个控制器动作来处理新笔记的创建：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult New(DataObjectType type, int id) {
    Note note = new Note { Type = type, Source = id };
    return View(note);
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create(Note note) {
    // This is just an example
    note.Persist();
    return View("New", note);
} 
```

首先，我需要确保提供给**{type}**路由值的值对于**DataObjectType**枚举有效。这可以通过路由约束来完成吗？目前，**New()**的类型参数将接受任何整数，无论​​它是否存在于**DataObjectType**中。

其次，我需要确保用户尝试添加注释的对象在显示新注释表单之前确实存在于数据库中。我可以在**New()**方法中轻松地做到这一点，但有时用户可能会直接将数据发布到**Create()**而不访问**New()**。在这种情况下，我还需要验证对象是否存在于**Create()**方法中。在不重复代码的情况下，在这两种方法中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T22:21:28.427

设置路线时，您可以使用一个参数来指定约束（通过正则表达式完成）。您可以使用它来限制那里的 id，但您必须为这种情况创建一个单独的路由，因为您不希望所有“id”都根据该规则进行过滤。

或者，您可以在控制器操作开始时粘贴此检查。

至于确保该注释已存在于数据库中，我看不出有任何方法可以在创建操作的开头进行检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T12:42:15.693

您是正确的，New 和 Create 操作都需要确保它们具有传递给它们的有效模型。执行此操作的正确位置是在模型活页夹中。如果传递了无效对象（或 Id），模型绑定器应添加模型状态错误。New 和 Create 可能使用相同的模型绑定器。

Don't confuse route constraints with user input validation. Route constraints simply help the routing system find the appropriate route when you don't specify the route yourself (i.e., when you use Html.ActionLink instead of RouteLink). If you use named routes, and you should, then the constraint is not needed to find the appropriate route, because you have specified the route directly. Route constraints are intended to prevent a certain route from being selected for actions it is not designed to handle, and are not the place to validate user input.

The feature you are asking for is a kind of user input validation, even though user input in question happens to be in the URL. If you are going to go beyond this simple, single case, you might want to look into using a validation framework, as this will make other types of validation much simpler. [Here is one which looks interesting to me](http://blog.codeville.net/2009/01/10/xval-a-validation-framework-for-aspnet-mvc/ "xVal - a validation framework for ASP.NET MVC").

# xml - 使用 NSXMLParser for iPhone 处理 RSS 标签

> ID：470934
> 
> 赞同：1
> 
> 时间：2009-01-22T21:43:43.993
> 
> 标签：xml, cocoa-touch

我找到了以下用于通过 RSS 解析的代码，但它似乎不允许嵌套元素：

```
- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{     
    NSLog(@"ended element: %@", elementName);
    if ([elementName isEqualToString:@"item"]) {
        // save values to an item, then store that item into the array...
        [item setObject:currentTitle forKey:@"title"];
        [item setObject:currentLink forKey:@"link"];
        [item setObject:currentSummary forKey:@"summary"];
        [item setObject:currentDate forKey:@"date"];
        [item setObject:currentImage forKey:@"media:thumbnail"]; 
```

要使用的 RSS 是：

```
 <item><title>Knife robberies and burglaries up</title>
<description>The number of robberies carried out at knife-point has increased sharply and burglaries are also up, latest crime figures indicate</description>
<link>http://news.bbc.co.uk/go/rss/-/1/hi/uk/7844455.stm</link>
<guid isPermaLink="false">http://news.bbc.co.uk/1/hi/uk/7844455.stm</guid>
<pubDate>Thu, 22 Jan 2009 13:02:03 GMT</pubDate><category>UK</category>
<media:thumbnail width="66" height="49" url="http://newsimg.bbc.co.uk/media/images/45400000/jpg/_45400861_policegeneric_pa.jpg"/>
</item> 
```

我需要从“媒体”标签中提取“url”元素。

谢谢马丁

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T03:10:59.950

您需要在元素开始时获取属性（包括 URL）：

```
parser:didStartElement:namespaceURI:qualifiedName:attributes: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-24T05:30:08.030

正如 August 所指出的，您将不得不使用 didStartElement 来获取标签的属性。属性作为字典返回，属性名称作为键，属性值作为值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-15T19:50:38.640

[我刚刚发布了一个适用于 iPhone](http://bit.ly/mwfeedparser)的开源RSS/Atom Parser ，希望它可能会有用。

我也很想听听你的想法！

# php - 应用程序访问服务器负载

> ID：470938
> 
> 赞同：0
> 
> 时间：2009-01-22T21:44:57.127
> 
> 标签：php, javascript, mysql

我用 PHP + JavaScript 开发了一个应用程序。我使用 MySQL 作为数据库支持。这个应用程序的每个帐户都将带有一个子域......所以客户端 Stardust 会有`stardust.mysite.com`。我想将应用程序文件放在外部的`public_html`文件夹中，并通过将保留在每个子域中的配置文件将创建的每个子域中的每个帐户链接到该文件夹​​。仅用于指定数据库信息。我的问题是：如果我让每个客户都从同一个文件夹访问文件，我是否会比我将文件分别放在每个子域中，分别为每个客户端访问更多的服务器负载？500 位客户同时从一个位置访问文件是否与 500 位客户分别从其自己的文件夹中访问文件相同？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T22:01:01.353

操作系统会缓存文件，因此拥有 500 个副本意味着比一份副本更多的缓存和更多的磁盘 IO。您可能只想拥有一个理解子域的“主”应用程序（即 user1 与 subdomain1 相关联）并使用 apache 重定向/等将所有请求发送到主应用程序/等。

# javascript - 在纯 JavaScript 中做一个简单的父子下拉列表的最佳方法是什么？

> ID：470941
> 
> 赞同：0
> 
> 时间：2009-01-22T21:45:35.427
> 
> 标签：javascript, forms, drop-down-menu, parent

我需要做一个快速而肮脏的`Country`-->`State`在 Web 表单上下拉关系。我只关心美国和加拿大的州、省和地区，这将是一种相对较少使用的形式，因此纯 JavaScript 解决方案可能是理想的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T21:48:19.493

创建一个 JSON 数组：

```
array = [ { name: "United States", states: [...] }, { ... } ]; 
```

当下拉列表的值发生变化时，用数组中特定元素的内容填充另一个下拉列表。

# silverlight - UserControl.InitializeComponent() 中的间歇性 InavlidCastException

> ID：470942
> 
> 赞同：2
> 
> 时间：2009-01-22T21:45:38.000
> 
> 标签：silverlight, silverlight-2.0

这是设置：

我有一个 Silverlight 控件库“控件”，其中定义了一个用于呈现对话框的客户控件：

```
public class Dialog : ContentControl
{
    public Dialog()
        : base()
    {
        DefaultStyleKey = typeof(Dialog);
    }

<...normal custom control stuff...>
} 
```

默认样式也在 generic.xaml 中：

```
<Style TargetType="src_general:Dialog">
    <Setter Property="Padding" Value="25"/>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="src_general:Dialog">
                <Grid x:Name="RootElement" >
                    <vsm:VisualStateManager.VisualStateGroups>
                        <vsm:VisualStateGroup x:Name="DiakogStyleStates">
                            <vsm:VisualState x:Name="OkCancel">
                                <Storyboard>
                                </Storyboard>
                            </vsm:VisualState>
                            <vsm:VisualState x:Name="OkOnly">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Duration="0:0:0" Storyboard.TargetName="CancelButton" Storyboard.TargetProperty="Visibility" >
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" >
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </vsm:VisualState>
                            <vsm:VisualState x:Name="CancelOnly">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Duration="0:0:0" Storyboard.TargetName="OkButton" Storyboard.TargetProperty="Visibility" >
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" >
                                            <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </vsm:VisualState>
                            <vsm:VisualState x:Name="None">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Duration="0:0:0" Storyboard.TargetName="CancelButton" Storyboard.TargetProperty="Visibility" >
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" >
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                         <ObjectAnimationUsingKeyFrames Duration="0:0:0" Storyboard.TargetName="OkButton" Storyboard.TargetProperty="Visibility" >
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" >
                                            <DiscreteObjectKeyFrame.Value>
                                                    <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </vsm:VisualState>
                        </vsm:VisualStateGroup>
                    </vsm:VisualStateManager.VisualStateGroups>
                         <Popup x:Name="DialogPopup">
                        <src_general:WindowFrame x:Name="Frame">
                            <Grid >
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <ContentPresenter Grid.Row="0" x:Name="ContentPresenter" Margin="{TemplateBinding Padding}"/>
                                     <!--Action Buttons-->
                                <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="15">
                                    <src_general:GlassButton x:Name="CancelButton" Content="Cancel" Margin="2"/>
                                    <src_general:GlassButton x:Name="OkButton" Content="Ok" Margin="2"/>
                                </StackPanel>
                            </Grid>

                        </src_general:WindowFrame>
                    </Popup>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我在很多地方都使用这个对话框没有问题。但是，在一个应用程序中，从 RootVisual 中嵌套了大约 3-4 个用户控件，我使用它的方式如下：

```
<general:Dialog x:Name="AddUpdateDialog" DialogStyle="OkCancel" Title="Add/Update Connection" Closed="AddUpdateDialog_Closed" ValidationGroup="AddConnection">
            <Grid Width="300">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Name:" Style="{StaticResource LabelText}"/>
                <TextBox Grid.Row="0" Grid.Column="2" Text="{Binding Name, Mode=TwoWay}" Style="{StaticResource TextBoxInput}" MaxLength="49">
                    <val:ValidationManager.Validator>
                        <val:RequiredValidator ManagerName="AddConnection" ErrorMessage="Name is required."/>
                    </val:ValidationManager.Validator>
                </TextBox>
            </Grid>
        </general:Dialog> 
```

当我运行此应用程序时，我会间歇性地运行（大约每 5-10 次启动会出现以下异常：

“无法将类型的对象`System.Windows.Controls.ContentControl`转换为 type `hookitupright.com.silverlight.controls.general.Dialog`。” 发生在上述 XAML `InitializeComponent()`的父级中。`UserControl`

具体来说，它发生在这里：

```
this.AddUpdateDialog = ((hookitupright.com.silverlight.controls.general.Dialog)(this.FindName("AddUpdateDialog"))); 
```

当我在那里放置断点时，大多数情况下 FindName 返回一个 Dialog 类型的对象，但有时，它返回一个 ContentControl（Dialog 的基础）并且失败。XAML 没有改变。它是静态的......由于异常是间歇性的并且发生在生成的代码中，我很茫然。

我试过了：

1.  将 Dialog 的所有内容移动到单独的 UserControl 中 - 似乎只会让问题变得更糟
2.  注释掉部分，看看它什么时候起作用......好吧，如果我完全注释掉 TextBox，它就不再失败了。其他所有内容（包括自定义验证附加属性）似乎都没有影响。

    2a。认为这可能与 TextBox 的 TwoWay 绑定有关，我删除了绑定。还是失败。

更新：因此，鉴于上面的 (2)，我离开了已注释掉的文本框，决定继续做其他事情，然后回到这里，希望有些事情会向我展示。不幸的是，它似乎也因文本框而失败，只是频率较低。

此外，我在同一个应用程序的另一个用户控件中（并且在 VisualTree 中的同一级别）的另一个用户控件中具有完全相同的配置，并且它根本不会失败。因此，我从字面上将失败的 XAML 复制并粘贴到 Main.xaml（我的根视觉对象）中，当然，它也不会在那里失败。假设 XAML 按顺序（从上到下）加载，失败的控件可能是最后加载的控件之一。我现在唯一的假设是发生了一些时间问题，当我仍在加载可视化树时，我开始从通过 WCF 服务加载数据中获取 *Completed 事件，并且这些事件会在可视化树之前触发布局满载会导致一些不良副作用......我会测试一下。

问题是它不会每次都失败。它大约有 20% 的时间会爆炸。当它工作时，即使这个对话框也能正常工作？

如果不是同一个问题，这个问题是相关的：当我通过注释掉所需的功能来“修复”无效转换时，我将不那么频繁但间歇性地获得[这个](https://stackoverflow.com/questions/229117/xamlparseexception-attribute-in-custom-control-missing-but-its-defined#473015)无效属性（当属性/属性实际上存在时）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T00:32:43.033

经过大量研究和挫折，我相信它与此有关：http: [//blogs.msdn.com/silverlight_sdk/archive/2008/10/24/loaded-event-timing-in-silverlight.aspx](http://blogs.msdn.com/silverlight_sdk/archive/2008/10/24/loaded-event-timing-in-silverlight.aspx)

Silverlight 中的 Loaded 事件与 (a) WPF 中的定义不匹配，因此 (b) 他们从 WPF 粘贴到 Silverlight 文档中的定义

怎么回事？？？

我已经根据上述修改了一些代码，现在它似乎没有失败。我希望我能准确地告诉你为什么它做了什么以及为什么我做了什么修复它（或者至少再次掩盖它？？），但我不能。也许其他人会遇到这个并且可以弄清楚。

这是我在做什么以及我改变了什么：

上面的文本框使用了验证器的附加属性（如 ASP.NET 验证器，类似于 Silverlight 工具包中的验证器）。当 Validator（RequireValidator 的基类）附加到控件时，它链接到该控件以提供作为附加行为的验证。诀窍是它然后尝试 Validate() 当前控件。对于TextBox 控件上的RequiredValidator，它为linkedControl 上的Text 属性调用string.IsNullOrEmpty()。所有这些都可以正常工作，因为这些只是 TextBox 控件上的属性。然而，在那之后，验证器需要以某种方式告诉控件显示错误指示器和任何错误消息。我通过提供一个包含两个新 VisualStates（“ValidInput”和“InvalidInput”

好的，足够的背景。从文档中，我知道我只能在应用模板后访问 TextBox 样式的元素（新的 visualStates 和通知图标），因此我为验证器的链接元素挂钩了 Loaded 事件并调用了 Validate()第一次在那里。好吧，MS 的某个人通过从 WPF 复制粘贴加载的事件描述节省了大约 15 分钟，这让我心痛大约 3-4 天。事实证明，不能保证模板在 silverlight 的 Loaded Event 中应用。因此，我只是在链接元素的 Loaded 事件处理程序中添加了对 ApplyTemplate() 的调用，失败就消失了。

我的猜测是错误是间歇性的，因为布局（以及模板的应用程序）异步发生，有时当我点击加载事件时它就在那里，有时它不是。但我仍然认为这是一个 Silverlight 错误，关于错误在哪里表现出来，甚至可能指向一个安全漏洞（如果，但是某些操作，在代码的其他地方，我可以导致 XAML 解析器返回一个不同于实际的 XAMl 表示什么...）。哦，好吧......它现在似乎正在工作。也许这会帮助别人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-30T11:42:08.833

也许这对某人也有帮助：看看我在另一个线程中的[答案：](https://stackoverflow.com/questions/229117/xamlparseexception-attribute-in-custom-control-missing-but-its-defined/1063206#1063206)

# c# - 在 Web 应用程序中使用 StringBuilder 是否值得？

> ID：470944
> 
> 赞同：2
> 
> 时间：2009-01-22T21:46:23.460
> 
> 标签：c#, stringbuilder

在网络应用程序中，我正在拆分字符串并分配给链接名称或字符串集合。将 stringbuilder 用于 Web 应用程序是否有显着的性能优势？

编辑：2 个功能：将链接拆分为 5-10 个字符串。然后重新打包成另一个字符串。此外，每次单击链接时，我都会一次将一个字符串附加到链接。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-22T21:51:32.620

您将连接多少个字符串？你确定会有多少，还是取决于数据库中有多少记录等？

有关更多详细信息和指南，请参阅[我关于此主题](http://pobox.com/~skeet/csharp/stringbuilder.html)的文章 - 但基本上，在 Web 应用程序中与使用 StringBuilder 相比，字符串连接的成本是多少没有区别。

编辑：恐怕从这个问题中你仍然不能完全清楚你在做什么。如果您有一组固定的字符串要连接，并且您可以一次完成所有操作，那么使用连接会更快并且可能更具可读性。例如：

```
string faster = first + " " + second + " " + third + "; " + fourth;

string slower = new StringBuilder().Append(first)
                                   .Append(" ")
                                   .Append(second)
                                   .Append(" ")
                                   .Append(third)
                                   .Append("; ")
                                   .Append(fourth)
                                   .ToString(); 
```

当然，另一种选择是使用格式字符串。这可能是最慢但最易读的：

```
 string readable = string.Format("{0} {1} {2}; {3}",
                                 first, second, third, fourth); 
```

您的问题中提到“每次添加链接”的部分建议在该方面使用 StringBuilder - 任何自然导致循环的东西都使用 StringBuilder 更有效（对于中到大的数字）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-22T21:49:53.030

是的，连接常规字符串很昂贵（实际上将字符串附加到另一个字符串的末尾）。每次更改字符串时，.net 都会删除旧字符串并使用新值创建一个新字符串。它是一个不可变的对象。

编辑：

Stringbuilder 应谨慎使用，并像任何其他方法一样进行评估。有时将两个字符串连接在一起会更有效，应根据具体情况进行评估。

[Atwood 有一篇与此相关的有趣文章。](http://www.codinghorror.com/blog/archives/001218.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-22T21:52:06.770

你应该看看[Jon Skeet](http://www.yoda.arachsys.com/csharp/stringbuilder.html)的这篇关于连接字符串的优秀文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T21:50:42.997

为什么 Web 应用程序或 winforms 应用程序的性能会有所不同？

由于内存和对象分配，使用 stringbuilder 是一个很好的做法，无论您为什么构建代码，这些规则都适用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-22T21:55:23.910

如果您在循环中创建具有大量迭代的字符串，那么使用 stringbuilder 是一个好主意。否则，字符串连接是你最好的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T22:27:11.643

首先，你还在写这个应用程序吗？如果是，则停止性能调整！其次，将正确性置于速度之上。出于显而易见的原因，从长远来看，可读性更为重要。第三，我们不知道您正在编写的确切情况和代码。如果这种微优化对您的代码性能是否重要，我们无法真正告诉您。测量差异。我强烈推荐 Red Gate 的 Ants Profiler。

# jquery - 使用 jQuery 返回没有 id 的 div 的正确语法是什么？

> ID：470951
> 
> 赞同：2
> 
> 时间：2009-01-22T21:47:50.663
> 
> 标签：jquery

我正在使用 jQuery 1.3.1，当我尝试遍历表单并删除任何不带 id 的 div 时，我得到了一个异常。

未捕获的异常：语法错误，无法识别的表达式：[@id]

```
$('form:eq(1)').children().each(
        function()
        {
            this2 = this;
            if ($(this2).find('div').not('[@id]')) { $(this).remove(); }
        }
    ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T21:49:46.417

@ 运算符已被弃用一段时间，最终在 1.3 版中被删除。只需从属性声明中删除它：

```
.not('[id]')... 
```

编辑：以下应该做你所说的，而不是你的原始代码：

```
if($(form).find('div').filter(function(){ 
     return $(this).attr('id') == '';
}).remove(); 
```

# javascript - 在 jQuery 中包装事件是否有可能，以及最简单的方法是什么？

> ID：470960
> 
> 赞同：0
> 
> 时间：2009-01-22T21:49:23.593
> 
> 标签：javascript, jquery

**背景**

我想模拟大多数浏览器在单击链接时支持的“活动”行为。对于任何元素和事件，我希望能够在事件期间向元素添加一个 css 类。所以在伪jQuery代码中我想这样做：

```
$(".button").click(function() { alert('clicked'); });

.....

$(".button").each( function()
    {
        var self = $(this);
        var innerClick = self.click;
        self.click( function()
            {
                self.addClass('active');
                innerClick();
                self.removeClass('active');
            });
    }); 
```

如果我将进一步的处理程序绑定到“点击”，任何可以提出足够强大的解决方案以维持包装的人的奖励积分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T07:12:57.683

问题是没有通用的方法来确定异步调用何时完成。在 AJAX 调用（例如）完成后，您需要设置某种标志并使用 setInterval 对其进行轮询。

使用同步函数，浏览器可能在单击处理程序完成之前不会更新显示，因此您永远不会看到活动状态。您可以通过使用 setTimeout 在 1/10 秒后删除活动类来解决此问题。对于这种情况，您可以编写如下函数：

```
function makeClickHandler(innerFunction) {
    return function(event) {
        var self = this;
        $(self).addClass('active');

        innerFunction.call(self, event);

        window.setTimeout(function() {
            $(self).removeClass('active');
        }, 100);
    }
} 
```

然后，您可以在 makeClickHandler 函数中包装任何点击处理程序：

```
$(".button").click(makeClickHandler(function() { alert('clicked'); })); 
```

这是一个如何处理异步事件的示例，但此时，在单个事件处理程序中添加/删除类可能会更容易。

```
function makeAsyncClickHandler(innerFunction) {
    return function(event) {
        var self = this;
        $(self).addClass('active').data("done", false);

        innerFunction.call(self, event);

        var intervalID = window.setInterval(function() {
            if ($(self).data("done")) {
                $(self).removeClass('active');
                window.clearInterval(intervalID);
            }
        }, 100);
    }
} 
```

内部函数必须调用

```
$(this).data("done", true); 
```

当异步部分完成时。

编写“开始”和“结束”函数可能会更容易，您可以在函数开始时和事件完成后调用元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:52:32.063

好吧，对于奖励积分，它是免费的，因为您可以为同一事件提供尽可能多的处理程序。不，关于你最初的问题，我没有明白这一点。你想模拟非链接元素的“活动”行为吗？如果是这样，将 mousedown/mouseup 事件绑定到 addClass/removeClass 方法应该可以解决问题。

# ruby-on-rails - 在 Apache 下的子目录中配置 Ruby On Rails App

> ID：470961
> 
> 赞同：11
> 
> 时间：2009-01-22T21:49:40.830
> 
> 标签：ruby-on-rails, ruby, apache2, windows-server-2003

我在 Windows 上有 apache2.2。我正在尝试同时提供颠覆 (/svn) 和 redmine (/redmine)。我的 svn 在这个配置下运行良好：

```
<Location /svn>
  DAV svn
  SVNParentPath C:/svn_repository
  ...
</Location> 
```

这很好用——我的 svn 用户可以点击[http://mybox/svn](http://mybox/svn)就好了。

现在我想为 Rails 应用程序（RedMine）添加另一个目录：

我按照[这个问题](https://stackoverflow.com/questions/148838/how-do-i-configure-apache-2-2-for-ruby-on-rails-in-windows)中的建议设置了一个混合服务器并让 apache 代理客户端通过它。如果我将其设为根目录，它工作正常——但我无法在子目录中创建它：

```
<Location /redmine>
  ProxyPass http://localhost:3000/
  ProxyPassReverse http://localhost:3000/
</Location> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-22T21:51:23.323

这是我必须改变的：

我删除了尾部斜杠：

```
<Location /redmine>
  ProxyPass http://localhost:3000
  ProxyPassReverse http://localhost:3000/
</Location> 
```

在我的 Rails 应用程序中：

```
# added to end of file C:\redmine\config\environment.rb
ActionController::AbstractRequest.relative_url_root = "/redmine" 
```

现在它正在工作！

* * *

我对这种方法并不完全满意——我遇到了一些重定向问题。这是迄今为止似乎运作良好的另一种尝试。

*   [没有虚拟主机的快速 CGI](http://wiki.rubyonrails.org/rails/pages/Fast+CGI+and+Apache2+for+Windows+XP)和[快速 CGI](http://wiki.rubyonrails.org/rails/pages/Fast+CGI+and+Apache2+for+Windows+without+VirtualHosts)
*   [调整快速 CGI](http://scottstuff.net/blog/articles/2005/07/20/apache-tuning-for-rails-and-fastcgi)

第二种方法似乎更好。

* * *

**更新：**

如评论中所述，对于在 Rails 2.3.2+ 上运行的最新应用程序，请改用：

```
config.action_controller.relative_url_root = '/redmine' 
```

我把它放在新`additional_environment.rb`文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T16:39:44.523

如果您仍然希望使用反向代理来使用 Mongrel + Apache，这里是我在我们的系统（Win2k3、Apache 2.2、Redmine 的主干）上解决相同问题的方法。秘诀是安装您的杂种服务，使用`--prefix /redmine`它告诉它从`http://localhost:port/redmine`

在 Apache httpd.conf（或合适的包含文件）中：

```
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so

<IfModule mod_proxy.c>
ProxyRequests Off
#No need to forward on static content - let apache do it faster
ProxyPass /redmine/images ! 
ProxyPass /redmine/stylesheets ! 
ProxyPass /redmine/javascript ! 
# Remove the following entry on public sites as this is insecure
ProxyPass /redmine/plugin_assets !
ProxyPass /redmine/help ! 
ProxyPass /redmine http://localhost:4000/redmine
ProxyPassReverse /redmine http://localhost:4000/redmine
ProxyPreserveHost On
#continue with other static files that should be served by apache
Alias /redmine/images C:/Repositories/redmine/public/images/
Alias /redmine/stylesheets C:/Repositories/redmine/public/stylesheets/
Alias /redmine/javascript C:/Repositories/redmine/public/javascript/
# Remove the following on public sites as this is insecure
Alias /redmine/plugin_assets C:/Repositories/redmine/public/plugin_assets/
Alias /redmine/help C:/Repositories/redmine/public/help/
</IfModule>

# Make sure apache can see public and all subfolders - not suitable for public sites
<Directory "C:/Repositories/redmine/public/">
    Allow from all
    Order allow,deny
</Directory> 
```

Mongrel 是这样安装的：

```
mongrel_rails service::install --prefix /redmine -N redmine_prod -p 4000 -e production -c C:\Repositories\redmine 
```

希望对某人有所帮助。最初，我尝试设置 Apache + fastcgi 等，但我失去了更多宝贵的头发——它不适合 Windows。

Ps 我发现这个 PDF 是一个非常有用的参考：http: [//www.napcsweb.com/howto/rails/deployment/RailsWithApacheAndMongrel.pdf](http://www.napcsweb.com/howto/rails/deployment/RailsWithApacheAndMongrel.pdf)

/达米安

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T01:59:38.067

乘客 ( [http://modrails.com](http://modrails.com) ) 是 fastcgi 的更好替代品，因为它非常易于配置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T17:37:48.113

我同意雷达。[乘客](http://www.modrails.com/)真的很容易设置，让 Rails 应用程序共享内存，消除管理杂种集群的负担，几乎不需要配置。您只需要一个特殊的“config.ru”文件，其中包含一个[RackUp 配置](http://www.modrails.com/documentation/Users%20guide.html#_rackup_specifications_for_various_web_frameworks)和一个指向 Apache 中设置的 RAILS_ROOT/public 的 DocumentRoot。

# javascript - 以数字开头的类或方法名称，为什么不呢？

> ID：470982
> 
> 赞同：2
> 
> 时间：2009-01-22T21:52:39.483
> 
> 标签：javascript, naming-conventions, naming

我最近正在快速缩短 JavaScript 文件中的一些方法名称，并在转换一个方法名称时遇到了问题：

前：

```
RefreshSevenDayGrid(){
    // some stuff
} 
```

后：

```
7Day() {    
    // some stuff
} 
```

我很快发现 javascript 不再有效。我从几个人那里听说，数字永远不应该用于方法或类名。有没有例外？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-22T21:56:57.040

它往往会导致适合语言解析器。它看到一个前导数字，因此希望开始读取数字文字，然后在看到一个字母时会倒掉。即使是代数约定，字母左侧的数字也是一个单独的数字文字，省略了空格，因此*7x*将被视为两个标记。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-22T22:16:41.120

除了 Jeffrey Hantin 所说的之外，还有一些数字常量，例如

```
3e7  // 3x10^7
40L  // C, C++, etc for a long integer
0x88 // hexadecimal 
```

在大多数语言中广泛使用的标识符的一般约定是，`[S except for 0-9][S]*`其中 S 是一组有效字符（AZ、az、0-9，有时是 _、$ 或 -）——所以第一个字符不能是数字，但其余的可以。

# sql - 您首选的布尔值对是什么：1/0 是/否 True/False？

> ID：470984
> 
> 赞同：2
> 
> 时间：2009-01-22T21:53:32.493
> 
> 标签：sql, naming-conventions, project-planning

1.  在处理 MySQL 时，我一般使用 BOOLEAN 类型，相当于 TINYINT(1)，也就是 1/0
2.  在我使用的大多数语言中，true/false 是首选
3.  显示表单时，有时“是/否”更有意义

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-22T22:11:34.343

```
enum Bool 
{ 
    True, 
    False, 
    FileNotFound 
}; 
```

[http://thedailywtf.com/Articles/What_Is_Truth_0x3f_.aspx](http://thedailywtf.com/Articles/What_Is_Truth_0x3f_.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-22T21:56:27.370

在代码中：真/假。

在 UI 中：是/否或确定/取消

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-22T22:01:41.557

`true`并且`false`对我来说更有意义，在代码中 - 部分是通过熟悉，我敢肯定。我怀疑我很快就习惯`yes`了。`no`1 和 0 确实对我不起作用。

考虑表达式

```
age == 5 
```

这是对真实性的考验。值是`age`5吗？对，是真的。“是”和“否”对我来说都很好，但是对于“是`age`5 的值吗？”这个问题的答案的想法。是“1”对我来说似乎很违反直觉。仅仅因为这是真理罩的典型二进制表示并不意味着它在更高的抽象中是有用的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-22T21:58:12.203

哪个更容易阅读？

```
while(true) {}
while(yes) {}
while(1) {} 
```

在大多数情况下，我会坚持使用 true。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-22T22:20:16.387

这是我生活的规则...

## 规则1

在用于与 CPU 通信的编程语言中使用定义明确的常量，即布尔值在大多数现代情况下为真/假。如果数据库提供布尔类型或类似的等价物，当然应该使用它。

## 规则 #2

通过使用他们喜欢的语言和习惯用法与您的软件用户进行交互，即是/否问题应该提供是/否（或者可能是否的替代方案，例如取消）。

## 规则#3

不确定性应该用范围来表达，即“取决于”，然后是“基于什么？”的问题。我知道开发人员通过将他们可能需要的几乎每个依赖项复制并粘贴到项目的每个代码文件中作为“使用”语句来回答这个问题。这只是草率，请费心按字母顺序排列或至少将命名空间组合在一起。

## 当布尔还不够时

顺便说一句，在 C# 中可用的一个有趣的转折是 Nullable；

你可以写

```
Nullable<bool> RespondToIritatingQuestion()
{
    return new Nullable<bool>();

} 
```

或者

```
bool? RespondToIritatingQuestionWithSytle()
{
    return new bool?();

} 
```

提问者需要先评估你的回答，然后才能知道答案（如果有的话）可能是什么......

```
bool? answer = RespondToIritatingQuestionWithStyle();

if (answer.HasValue)
    Trace.WriteLine("The bloke responded with " + answer.Value.ToString());
else
    Trace.WriteLine("The bloke responded with 'depends'."); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-22T22:26:01.303

1 或 0 用于 SQL。SQL 有一个布尔类型是有原因的。此外，在非常大的数据库中，它会影响性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T21:57:57.990

我对数据库中的真/假字段使用布尔值。有些人使用`ENUM('true', 'false')`，但这不是我的偏好。对于编程语言，我总是使用 true/false，即使将其设置为 0 或 1 也可以。如果表单需要“是”/“否”，我仍然使用布尔值来表示值，但将它们显示为更合乎逻辑的字符串。

# asp-classic - 如何使用 ASP Classic 获取当前虚拟目录的名称？

> ID：470987
> 
> 赞同：2
> 
> 时间：2009-01-22T21:54:31.320
> 
> 标签：asp-classic, virtual-directory

如何使用 ASP Classic 获取当前虚拟目录的名称？在 ASP.NET 中，您可以使用它`Request.ApplicationPath`来找到它。

例如，假设您有一个这样的 URL：

```
http://localhost/virtual_directory/subdirectory/file.asp
```

在 ASP.NET 中，`Request.ApplicationPath`将返回**/virtual_directory**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-28T20:45:49.730

您可以从多个服务器变量之一获取文件的虚拟路径 - 尝试：

*   `Request.ServerVariables("PATH_INFO")`
*   `Request.ServerVariables("SCRIPT_NAME")`

（但不像`INSTANCE_META_PATH`以前建议的那样 - 这给了你元基本路径，而不是你期望的虚拟路径）。

任一服务器变量都会为您提供包括任何子目录和文件名的虚拟路径 - 以您的示例为例，您将获得“/virtual_directory/subdirectory/file.asp”。如果您只想要虚拟目录，则需要使用您喜欢从路径中提取目录的任何方法在第二个正斜杠之后剥离所有内容，例如：

```
s = Request.ServerVariables("SCRIPT_NAME")
i = InStr(2, s, "/")
If i > 0 Then
    s = Left(s, i - 1)
End If 
```

或者：

```
s = "/" & Split(Request.ServerVariables("SCRIPT_NAME"), "/")(1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:21:25.370

尝试使用：Request.ServerVariables("SCRIPT_NAME")

或尝试使用 Request.ServerVariables("INSTANCE_META_PATH") 如果这对您不起作用。

有关其他服务器变量的列表，请尝试以下链接：

[http://www.w3schools.com/asp/coll_servervariables.asp](http://www.w3schools.com/asp/coll_servervariables.asp)

# sql - 如何计算SQL中不同项目的数量

> ID：470992
> 
> 赞同：3
> 
> 时间：2009-01-22T21:56:17.043
> 
> 标签：sql

数据库结构：

```
Clubs: ID, ClubName
Teams: ID, TeamName, ClubID
Players: ID, Name
Registrations: PlayerID, TeamID, Start_date, End_date, SeasonID 
```

俱乐部拥有几支球队。球员可能会在一年内注册到几支球队（同一俱乐部内或不同俱乐部）。我必须生成一个查询来列出在一个赛季中注册到不同俱乐部的所有球员。因此，如果球员交换了属于同一俱乐部的球队，那么这不算数。

到目前为止我的尝试：

```
SELECT
c.short_name,
p.surname,
r.start_date,
r.end_date,
(select count(r2.id) from ejl_registration as r2
    where r2.player_id=r.player_id and r2.season=r.season) as counter
FROM
ejl_registration AS r
left Join ejl_players AS p ON p.id = r.player_id
left Join ejl_teams AS t ON r.team_id = t.id
left Join ejl_clubs AS c ON t.club_id = c.id
WHERE
r.season =  '2008'
having counter >1 
```

我不知道如何计算和只显示不同的俱乐部......（现在想清楚已经太迟了）。我使用 MySQL。

报告应类似于：球员姓名、俱乐部名称、开始日期、结束日期

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-22T22:20:21.533

这是此答案的第二次尝试，将其简化为仅计算不同的俱乐部，而不是报告俱乐部名称的列表。

```
SELECT p.surname, r.start_date, r.end_date, COUNT(DISTINCT c.id) AS counter
FROM ejl_players p
 JOIN ejl_registration r ON (r.player_id = p.id)
 JOIN ejl_teams t ON (r.team_id = t.id)
 JOIN ejl_clubs c ON (t.club_id = c.id)
WHERE r.season = '2008'
GROUP BY p.id
HAVING counter > 1; 
```

请注意，由于您使用的是 MySQL，因此对于选择列表中的列与 GROUP BY 子句中的列不匹配，您可以非常灵活。其他品牌的 RDBMS 对单值规则更为严格。

没有理由像您的示例中那样使用 LEFT JOIN 。

* * *

好的，这是查询的第一个版本：

您有如下关系链：

```
club1 <-- team1 <-- reg1 --> player <-- reg2 --> team2 --> club2 
```

这样 club1 不能与 club2 相同。

```
SELECT p.surname,
  CONCAT_WS(',', GROUP_CONCAT(DISTINCT t1.team_name), 
    GROUP_CONCAT(DISTINCT t2.team_name)) AS teams,
  CONCAT_WS(',', GROUP_CONCAT(DISTINCT c1.short_name), 
    GROUP_CONCAT(DISTINCT c2.short_name)) AS clubs
FROM ejl_players p
 -- Find a club where this player is registered
 JOIN ejl_registration r1 ON (r1.player_id = p.id)
 JOIN ejl_teams t1 ON (r1.team_id = t1.id)
 JOIN ejl_clubs c1 ON (t1.club_id = c1.id)
 -- Now find another club where this player is registered in the same season
 JOIN ejl_registration r2 ON (r2.player_id = p.id AND r1.season = r2.season)
 JOIN ejl_teams t2 ON (r2.team_id = t2.id)
 JOIN ejl_clubs c2 ON (t2.club_id = c2.id)
-- But the two clubs must not be the same (use < to prevent duplicates)
WHERE c1.id < c2.id
GROUP BY p.id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:06:34.010

这是一个赛季的球员名单。

```
SELECT sub.PlayerId
FROM
(
  SELECT
    r.PlayerId,
    (SELECT t.ClubID FROM Teams t WHERE r.TeamID = t.ID) as ClubID
  FROM Registrations r
  WHERE r.Season = '2008'
) as sub
GROUP BY PlayerId
HAVING COUNT(DISTINCT sub.ClubID) > 1 
```

这是所有赛季的球员和赛季列表。

```
SELECT PlayerId, Season
FROM
(
SELECT
  r.PlayerId,
  r.Season,
  (SELECT t.ClubID FROM Teams t WHERE r.TeamID = t.ID) as ClubID
FROM Registrations r
) as sub
GROUP BY PlayerId, Season
HAVING COUNT(DISTINCT sub.ClubID) > 1 
```

顺便说一句，这适用于 MS SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T22:44:03.170

```
SELECT p.Name, x.PlayerID, x.SeasonID
  FROM (SELECT DISTINCT r.PlayerID, r.SeasonID, t.ClubID
          FROM Registrations r
          JOIN Teams t ON t.ID = r.TeamID) x
  JOIN Players p ON p.ID = x.PlayerID
 GROUP BY p.rName, x.PlayerID, x.SeasonID
HAVING COUNT(*) > 1 
```

# .net - UNC 虚拟文件夹

> ID：470994
> 
> 赞同：1
> 
> 时间：2009-01-22T21:56:32.143
> 
> 标签：.net, wcf, api, service, filesystems

我想将一些服务功能公开为虚拟文件共享，以允许常规应用程序将虚拟文件夹用作真实文件夹。

例如，一个文件路径由

`\\\\Server\VirtualShare\File.ext`

意味着它`VirtualShare`并不真正存在，只有在我的服务正在运行时才可用。具有虚拟共享的文件访问必须隐式使用我的服务。

我的问题是，是否存在一些（样本）API 来公开自己的虚拟文件共享。WCF 是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T22:22:04.307

您需要编写文件系统驱动程序来执行此操作。这很有趣，但非常困难，只能用 C（甚至 C++）来完成。如果您有兴趣，请查看[Windows 驱动程序工具包](http://www.microsoft.com/whdc/devtools/wdk/default.mspx)。

编辑：您可以查看一些用户模式文件系统的东西，例如[Dokan](http://dokan-dev.net/en/)，这很有趣，但我不会在生产中使用它，或者[Callback File System](http://www.eldos.com/cbfs/desc.php)是我很少听说的商业系统，所以我不能以一种方式推荐它或其他。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-22T22:51:02.157

如果您只需要在本地机器上使用它，请查看[Dokan](http://dokan-dev.net/en/)以编写用户态文件系统。.Net 包装器也可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T00:10:39.037

我会向您推荐这个类似的问题：

[Windows共享上的数据库查询表示模拟文件？](https://stackoverflow.com/questions/24408/database-query-representation-impersonating-file-on-windows-share)

我建议在 Linux 和 FUSE 上使用 WinFUSE 或 SAMBA。********``