# StackOverflow 问答 000822000-000822999

# .net - 如何将 .Net 日期时间转换为 T-SQL 日期时间

> ID：822000
> 
> 赞同：5
> 
> 时间：2009-05-04T20:50:41.627
> 
> 标签：.net, asp.net, tsql, datetime

```
MyDataSource.SelectParameters["startDate"].DefaultValue =
                                     fromDate.SelectedDate.Date.ToString(); 
```

如您所见，我正在.Net SqlDataSource 中设置参数的默认值。我不认为字符串输出正确的格式。什么是正确的格式，以便 T-SQL 日期时间正确匹配？

以下是现在输出的格式：

*   2009 年 5 月 1 日凌晨 12:00:00
*   2009 年 5 月 4 日晚上 11:59:59

**编辑：**在我有 DataSource 之前应该写 SqlDataSource

这是一些代码

```
<asp:SqlDataSource ID="MyDataSource" runat="server" ConnectionString="<%$ ConnectionStrings:sampledb %>" SelectCommand="Recording_Select" SelectCommandType="StoredProcedure" OnSelecting="MyDataSource_Selecting">
    <SelectParameters>
        <asp:ControlParameter ControlID="respondentID" DefaultValue="%" Name="RespondentID" PropertyName="Text" Type="String" />
        <asp:SessionParameter Name="projectCode" SessionField="proj" Type="String" />
        <asp:ControlParameter ControlID="interviewerList" Name="InterviewerID" PropertyName="SelectedValue" Type="String" />
        <asp:ControlParameter ControlID="dispCodeList" Name="dispCode" PropertyName="SelectedValue" Type="Int32" />
        <asp:ControlParameter ControlID="fromDate" DefaultValue="1/1/1900" Name="startDate" PropertyName="SelectedValue" Type="DateTime" />
        <asp:ControlParameter ControlID="toDate" DefaultValue="1/1/1900" Name="endDate" PropertyName="SelectedValue" Type="DateTime" />
    </SelectParameters>
</asp:SqlDataSource> 
```

**编辑：** 好吧，我发现了问题，看起来有点傻。该代码从未调用 DefaultValue，因为始终存在一个值。所以我唯一的解决方案是制作一个新的隐藏标签控件并将更正的日期时间加载到其中。这几乎成功了。我不知道我怎么忽略了这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T20:54:07.060

有一个 SqlDateTime 结构可以用于此

```
DateTime DotNetDateTime = new DateTime(2009, 5, 4);
System.Data.SqlTypes.SqlDateTime sqlDateTime = new System.Data.SqlTypes.SqlDateTime(DotNetDateTime); 
```

或者直接在一行中（因为 SqlDateTime 在构造函数重载之一中采用与 .NET DateTime 类相同的参数）：

```
System.Data.SqlTypes.SqlDateTime sqlDateTime = new System.Data.SqlTypes.SqlDateTime(2009, 5, 4); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T20:52:19.967

我会用这个：

```
MyDataSource.SelectParameters["startDate"].DefaultValue =
                                     fromDate.SelectedDate.Date.ToString("yyyyMMdd HH:mm:ss"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T20:55:09.383

您最初是如何创建参数的？您当时应该能够将数据类型指定为日期时间。然后将您的日期时间直接分配给参数，而不是尝试将其转换为字符串。

* * *

根据您发布的代码，您最好的选择可能只是预先填充您的控件。此外，这对于该上下文中的默认值来说看起来不错，所以我怀疑问题出在其他地方。尝试将`CancelSelectOnNullParameter`控件的属性设置为 False。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T20:58:55.943

这应该可以解决问题：

```
MyDataSource.SelectParameters["startDate"].DefaultValue = fromDate.SelectedDate.Date.ToString("yyyy-MM-dd HH:mm:ss") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T20:56:43.827

当作为参数传递时，我总是强制我的日期为 MMM dd yyyy，这样就不会弄乱和翻转。

# python - Python套接字缓冲

> ID：822001
> 
> 赞同：24
> 
> 时间：2009-05-04T20:50:59.707
> 
> 标签：python, sockets, buffering

假设我想使用标准`socket`模块从套接字读取一行：

```
def read_line(s):
    ret = ''

    while True:
        c = s.recv(1)

        if c == '\n' or c == '':
            break
        else:
            ret += c

    return ret 
```

究竟发生了`s.recv(1)`什么？每次都会发出系统调用吗？无论如何，我想我应该添加一些缓冲：

> 为了与硬件和网络现实进行最佳匹配，*bufsize*的值应该是 2 的相对较小的幂，例如 4096。

[http://docs.python.org/library/socket.html#socket.socket.recv](http://docs.python.org/library/socket.html#socket.socket.recv)

但是编写高效且线程安全的缓冲似乎并不容易。如果我使用`file.readline()`怎么办？

```
# does this work well, is it efficiently buffered?
s.makefile().readline() 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-05T00:38:27.380

如果您关心性能并完全控制套接字（例如，您没有将其传递到库中），那么请尝试在 Python 中实现您自己的缓冲——Python string.find 和 string.split 等可以非常快。

```
def linesplit(socket):
    buffer = socket.recv(4096)
    buffering = True
    while buffering:
        if "\n" in buffer:
            (line, buffer) = buffer.split("\n", 1)
            yield line + "\n"
        else:
            more = socket.recv(4096)
            if not more:
                buffering = False
            else:
                buffer += more
    if buffer:
        yield buffer 
```

如果您希望有效负载由不太大的行组成，那么它应该运行得非常快，并且避免不必要地跳过太多层的函数调用。我很想知道这与 file.readline() 或使用 socket.recv(1) 的比较。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-04T21:05:08.173

通过`recv()`调用 C 库函数直接处理调用。

它将阻塞等待套接字有数据。实际上它只会让`recv()`系统调用阻塞。

`file.readline()`是一种有效的缓冲实现。它不是线程安全的，因为它假定它是唯一读取文件的人。（例如通过缓冲即将到来的输入。）

如果您使用的是文件对象，则每次`read()`使用正参数调用时，底层代码都将`recv()`只请求请求的数据量，除非它已经被缓冲。

如果出现以下情况，它将被缓冲：

*   你调用了 readline()，它读取了一个完整的缓冲区

*   行尾在缓冲区结束之前

从而将数据留在缓冲区中。否则缓冲区通常不会过满。

问题的目标不明确。如果您需要在读取之前查看数据是否可用，您可以使用 .`select()`或将套接字设置为非阻塞模式`s.setblocking(False)`。然后，如果没有等待数据，读取将返回空，而不是阻塞。

您是否正在读取一个文件或具有多个线程的套接字？我会让一个工作人员读取套接字并将接收到的项目送入队列以供其他线程处理。

建议参考[Python Socket Module 源码](http://svn.python.org/view/python/tags/r262/Lib/socket.py?revision=71601&view=markup#readline)和[进行系统调用的 C 源码](http://svn.python.org/view/python/tags/r262/Modules/socketmodule.c?revision=71601&view=markup)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-05T16:49:27.513

```
def buffered_readlines(pull_next_chunk, buf_size=4096):
  """
  pull_next_chunk is callable that should accept one positional argument max_len,
  i.e. socket.recv or file().read and returns string of up to max_len long or
  empty one when nothing left to read.

  >>> for line in buffered_readlines(socket.recv, 16384):
  ...   print line
    ...
  >>> # the following code won't read whole file into memory
  ... # before splitting it into lines like .readlines method
  ... # of file does. Also it won't block until FIFO-file is closed
  ...
  >>> for line in buffered_readlines(open('huge_file').read):
  ...   # process it on per-line basis
        ...
  >>>
  """
  chunks = []
  while True:
    chunk = pull_next_chunk(buf_size)
    if not chunk:
      if chunks:
        yield ''.join(chunks)
      break
    if not '\n' in chunk:
      chunks.append(chunk)
      continue
    chunk = chunk.split('\n')
    if chunks:
      yield ''.join(chunks + [chunk[0]])
    else:
      yield chunk[0]
    for line in chunk[1:-1]:
      yield line
    if chunk[-1]:
      chunks = [chunk[-1]]
    else:
      chunks = [] 
```

# php - PEAR MDB2 执行StoredProc 并返回结果集。可能的？值得？

> ID：822008
> 
> 赞同：0
> 
> 时间：2009-05-04T20:52:24.320
> 
> 标签：php, mysql, stored-procedures, mdb2, mysql-error-1312

在过去的几个小时里，我一直在努力完成这项工作。我有一个名为 get_log_entries 的简单存储过程：

```
CREATE DEFINER=`root`@`localhost` PROCEDURE `get_log_entries`(p_min_id INT)
BEGIN
  SET p_min_id = IFNULL(p_min_id, -1);
  SELECT * FROM db_log WHERE item_id > p_min_id;
END 
```

它非常简单，它在两列中返回结果：item_id (int) 和 log_description (varchar)。

我正在尝试使用 MDB2 对象执行此操作，但到目前为止还没有运气。这是尝试执行此操作的代码：

```
$conn = MDB2::factory('mysql://myUser:myPassword@localhost/my_db');

if (PEAR::isError($conn)) {
    die ("Cannot connet to DB(10): " . $conn->getMessage());
}

// loading the Function module
$conn->loadModule('Function');

$params = array('null');

$result = $conn->executeStoredProc('get_log_entries', $params);

if (PEAR::isError($result)) {
    $msg = $result->getMessage() . "<br /><br />" . $result->getUserInfo();
    die ($msg);
} 
```

在这一点上，这个很好的错误显示在消息中：

> “_doQuery：[错误消息：无法执行语句] [上次执行的查询：CALL get_log_entries()] [本机代码：1312] [本机消息：PROCEDURE wh_search.get_log_entries 无法在给定上下文中返回结果集]”

现在我有几个问题：
1\. 是否可以使用 MDB2 执行 SP 并返回结果集？
2\. 还是自己为“本机”PHP-MySQL 函数编写一个包装类更好？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-10T08:44:50.403

没关系，包装 mysqli 以调用 SP。还有很多乐趣...

# javascript - 为什么在 javascript 中使用基于类的 OOP 样式继承？

> ID：822014
> 
> 赞同：5
> 
> 时间：2009-05-04T20:53:39.420
> 
> 标签：javascript, oop, inheritance, prototypal-inheritance

如果我没有完全错，那么 JavaScript 中的每个框架/库/方法现在都倾向于模仿基于类的 OOP 样式继承。造成这种情况的原因似乎是人们认为基于类的 OOP 继承更容易理解，并且大多数程序员都知道 OOP。

以我的经验，我没有找到支持这两种观点的证据。我认为 javascript 原型继承很好（而且我怀疑将另一种范式强加于一种语言而不是它所基于的语言的有用性）。我遇到的大多数开发人员在经典 OOP 方面也不是那么好。那么选择经典 OOP 风格继承而不是原型继承的原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T21:51:47.313

请注意，即使您在争论基于原型的 OOP，您也将其称为“原型”，而基于类的 OOP 只是“OOP”。因此，您自己也受到这种偏见的困扰，认为 OOP=> 类、原型 => 其他东西。

而且由于大多数人认为无论遇到什么问题，OOP 都是*正确的方法，那么原型肯定是次要的。*

所以，要回答你的问题，有两个因素：

1.  一个错误的定义：“OOP => 类”
    *   宣传：“一定是OOP，不然你不配”

由于您仍然受第一个限制，因此您尝试解释原型是第二个的例外。纠正它们要容易得多：

1.  有很多方法可以做对象，类只是静态语言最简单的一种。大多数人都被教导使用静态语言进行编程，并且他们中的大多数人都尝试使用任何一种语言，就像他们所学的第一种语言一样。

    *   有很多方法可以构建编程解决方案，OOP 在某些方面非常出色，而在其他方面则很糟糕。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T20:58:52.730

我认为答案就在您的问题中-大多数程序员对基于类的 OOP 比基于原型的 OOP 熟悉得多。

事实上，我什至会说大多数人不相信你可以拥有没有类的对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-04T22:47:50.970

我觉得你好像已经知道你的问题的答案，因为你在说的时候说了一部分

> 造成这种情况的原因似乎是人们认为基于类的 OOP 继承更容易理解，并且大多数程序员都知道 OOP。

对于解决问题，两种范式都不比另一种更正确。我相信主要原因是现在每个人都通过 Java 学习 OOP。因此，当人们遇到 OOP 时，他们会认为“哦，类”，因为这是他们所熟悉的。每当他们想解决问题时，他们很可能会使用他们所知道的。

我还要声明，程序员使用他不熟悉的范式并没有什么好处。我们大多数人*必须*使用 javascript 进行客户端 Web 开发，并在服务器上使用基于类的 OOP 语言。每当我不得不查看应用程序的 javascript 端时，我个人不希望 OOP 阻抗不匹配。

在某种程度上，每个人都试图在 javascript 中实现基于类的 OOP 是一个教育问题。在另一个层面上，这是一个心理层面。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T23:01:03.950

长期以来，我认为基于原型的 OOP 是基于类的 OOP 的弱、坏和错误的版本。然后，在大量信息泄露到我的脑海之后，我现在以更抽象的方式理解 OOP，并且发现两种方式都可以接受。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-10-29T05:56:37.810

> 那么选择经典 OOP 风格继承而不是原型继承的原因是什么？实际上，我相信一些框架是“某种”组合方法。以寄生组合继承模式为例。这就是 YAHOO.lang.extend 正在做的事情。

它使用原型继承和辅助函数来继承原型和构造函数窃取。哇，这听起来很复杂......嗯是的 - 这是我的实现和测试，例如：

```
// Prototypal Inheritance
Object.prototype.inherit = function(p) {
    NewObj = function(){};
    NewObj.prototype = p;
    return new NewObj(); 
};

// Paraphrasing of Nicholas Zakas's Prototype Inheritance helper
function inheritPrototype(subType, superType) {
    var prototype = Object.inherit(superType.prototype);
    prototype.constructor = subType;
    subType.prototype = prototype;
};
function SubType(name, age) {
    Parent.call(this, name);
    this.age = age;    
};
inheritPrototype(SubType, Parent);  
SubType.prototype.getAge = function() {
    return this.age;
}; 
```

我对此代码进行了测试：

```
 describe 'Parisitic Combination Inheritance'
 it 'should use inheritPrototype (to call parent constructor once) and still work as expected'
     sub = new SubType("Nicholas Zakas", 29)
     sub.toString().should.match /.*Nicholas Zakas/
     sub.getAge().should.eql 29
     charlie = new SubType("Charlie Brown", 69)
     charlie.arr.should.eql([1,2,3])
     charlie.arr.push(999)
     charlie.arr.should.eql([1,2,3,999])
     sub.arr.should.eql([1,2,3]) 
     sub.should.be_an_instance_of SubType
     charlie.should.be_an_instance_of SubType
     (sub instanceof SubType).should.eql true 
     (sub instanceof Parent).should.eql true 
 end
    end 
```

当然，如果你注意我的文字，你会看到：Nicholas Zakas，我从那里得到这个的人；）这个的大胜利：instanceof 有效（有人说很重要，我有点同意）；实例不共享引用类型（如数组）的状态（一个大问题！）；父构造函数只调用一次（一个大问题！）。

顺便说一句，我在这里有大多数流行继承模式的示例：[我的 TDD JS 示例](http://github.com/roblevintennis/Testing-and-Debugging-JavaScript)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T21:59:51.427

我认为该语言本身通过选择“新”作为关键字，并通过在语言规范中引入“构造函数”等概念来引导人们进入经典思维模式。在某种程度上，这是有限的——想象一下，如果我们有一个克隆关键字，思维方式的变化，以及特质 ala SELF 的概念。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T21:00:19.120

当我编写我的第一个脚本时，拥有如此简单的语言既酷又方便。但是今天您不仅想切换按钮颜色，还想用 JavaScript 构建复杂的应用程序。其他人可能喜欢使用您流行的应用程序，并希望看到社区提供插件。

现在，使用 OOP 实现这一点要容易得多——尤其是因为很多程序员都熟悉 OOP 概念。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T21:07:06.267

一个原因可能是您的服务器端很可能是 OO（ASP.NET、Java 等），因此在客户端上使用相同的范例更容易思考。不一定*更好*，但更容易。

# wpf - 如何使用 ObjectDataProvider 将 WPF 控件绑定到 WCF 方法

> ID：822015
> 
> 赞同：1
> 
> 时间：2009-05-04T20:53:50.137
> 
> 标签：wpf, wcf, binding

我第一次测试 WPF，并尝试使用 ObjectDataProvider 调用 WCF 服务。

名为 WcfService1 的 WCF 服务使用一个方法：

```
namespace WcfService1
{
    public class Service1 : IService1
    {

        public String HelloWorld()
        {
            return "Hello World!";
        }
    }
} 
```

我向我的 WPF 项目添加了一个服务引用并将其命名为 TestService

在我的主窗口中，我可以在后面的代码中毫无问题地调用它。看起来很简单；就像一个网络服务调用：

TestService.Service1Client 服务 = 新 TestService.Service1Client(); MessageBox.Show(service.HelloWorld());

我正在尝试创建一个指向该服务的 ObjectDataProvider。我想我对 ObjectType 应该是什么感到困惑？我试过本地，服务命名空间，src；我迷路了：

```
<Window.Resource>
    <ObjectDataProvider 
        x:Key="odpTestService" 
        ObjectType="{x:Type **TestService**:Service1Client}" 
        MethodName="HelloWorld" />
</Window.Resources> 
```

最终它将绑定到 TextBlock：

```
<TextBlock Grid.Column="0" Grid.Row="0" 
Grid.ColumnSpan="2" Background="AliceBlue"
Text="{Binding Source={StaticResource odpTestService}}" /> 
```

我试图从这里发布的 Flickr 示例中工作：http: [//khason.net/blog/wpf-binding-to-wcf-and-more/](http://khason.net/blog/wpf-binding-to-wcf-and-more/)

**更新：** 丹尼斯的回答确实解决了这里的部分问题。现在，我在编译时遇到错误：System.Windows.Data 错误：34：ObjectDataProvider：尝试调用类型方法失败；

ObjectDataProvider 不能调用 IService1 类型的 HelloWorld 方法（使用我的示例中的方法和类型）。任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T21:15:04.437

您需要通过文件顶部的 xmlns 指令导入服务的命名空间：

假设引用已直接添加到您的应用程序，并且您的应用程序的根命名空间是“MyApplication”：

```
<Window x:class="MyApplication.MyWindow"
        xmlns:srv="MyApplication.TestService">

        <Window.Resource>
            <ObjectDataProvider 
                x:Key="odpTestService" 
                ObjectType="{x:Type srv:Service1Client}" 
                MethodName="HelloWorld" />
        </Window.Resources>

        <TextBlock Grid.Column="0" Grid.Row="0" 
          Grid.ColumnSpan="2" Background="AliceBlue"
          Text="{Binding Source={StaticResource odpTestService}}" />

</Window> 
```

# sharepoint - 使用 SSRS 2008 访问 SharePoint 列表数据的问题

> ID：822028
> 
> 赞同：0
> 
> 时间：2009-05-04T20:55:44.280
> 
> 标签：sharepoint, reporting-services, wss-3.0, ssrs-2008

我正在尝试使用 SSRS 2008 访问列表数据。

我创建了一个带有以下连接字符串的 XML 数据源：“ [http://[Your_Site_Name]/_vti_bin/lists.asmx](http://[Your_Site_Name]/_vti_bin/lists.asmx) ”。

然后，我使用以下查询创建了一个数据集：

`<Query> <SoapAction>http://schemas.microsoft.com/sharepoint/soap/GetListItems</SoapAction> <Method Namespace="http://schemas.microsoft.com/sharepoint/soap/" Name="GetListItems"> <Parameters> <Parameter Name="listName"> <DefaultValue>Your_List_Name</DefaultValue> </Parameter> </Parameters> </Method> <ElementPath IgnoreNamespaces="True">*</ElementPath> </Query>`

现在的问题：

我在读取具有 html 标记/标签（特别是“多行文本”字段类型）的列值时遇到问题。当 Reporting Services 遇到这样的一个列时，它会在数据集中创建一个名为“行”的字段。

我尝试删除这个“行”字段并手动创建实际字段。然后，我在占位符属性中将列值设置为 HTML（SSRS 2008 中的一项新功能，其中 HTML 标记被视为样式），但不起作用。

例如，“问题跟踪列表”中的评论列存储为“div”

在 CAMLBuilder 中执行相同的查询可以完美地显示所有列。

我该如何克服这个问题。有什么帮助吗？

提前致谢

**PS：**我在 MSDN SQL Server 报告服务论坛上发布了相同的查询。这是[链接](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/332ce140-1e8b-4e69-b29c-60f516caf5cd)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T06:19:46.717

我在 MSDN SQL Server 报告服务论坛上发布了相同的查询。这是[链接](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/332ce140-1e8b-4e69-b29c-60f516caf5cd)。MSFT 版主已找到解决此问题的方法。

# php - PHP 的 md5() 的 Javascript 等价物也适用于多字节字符串？

> ID：822036
> 
> 赞同：2
> 
> 时间：2009-05-04T20:57:00.033
> 
> 标签：php, javascript, md5, multibyte

**编辑：** *问题中提到的脚本，以及答案中指出的另一个脚本，都适用于多字节字符串 - 结果我的问题出在其他地方。*

有谁知道这样的实现？[http://phpjs.org/functions/view/469](http://phpjs.org/functions/view/469)上的脚本运行良好，只是不适用于多字节字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T21:04:41.763

[此实现](http://pajhome.org.uk/crypt/md5/)似乎可以正确处理 UTF-8 字符串。如果要测试演示，请确保首先在浏览器设置中将页面的编码更改为 UTF-8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:01:36.483

您发布的脚本有`str = utf8_encode(str);`.
您可能应该删除此行并将您的西里尔字母作为 UTF-8 传递。

# wiki - 在 MediaWiki 之后使用哪个 wiki？

> ID：822038
> 
> 赞同：5
> 
> 时间：2009-05-04T20:57:12.343
> 
> 标签：wiki, mediawiki

我们正在考虑从我们现有的 MediaWiki 安装转移到功能更丰富的东西。我试图找出人们今天使用 MediaWiki 的所有痛点（主要是与 Word 相比，它对外部文档的处理很差，编辑能力也不够完美）。

我们正在使用 wiki 来获取设计、规范和流程指南。我们有几个外部文档（文档、powerpoints），我们目前将它们放在一个共享文件夹中并从 wiki 链接到（因为在 MediaWiki 中上传文件不是很方便）。我们正在努力使摩擦最小化，这样任何人都不会有借口或理由不使用它。

我们正在考虑的一些选项是 Confluence、Trac 和 Sharepoint。钱不是一个大问题，只有易用性（和维护）和功能齐全。你会用什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-04T21:04:43.370

我会将我的特定功能需求的详细信息插入到出色的[WikiMatrix](http://www.wikimatrix.org/)选择向导中，并让它提出建议。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-17T05:12:35.460

我建议要么

*   Foswiki ( [http://foswiki.org](http://foswiki.org) )，（由 TWiki 的整个开发人员社区分叉以避免商标威胁），用于功能丰富且完全开放的程序员 wiki。访问 irc.freenode.net 上的#foswiki 与社区聊天。
*   Mindtouch 的 Deki Wiki ( [http://www.mindtouch.com/](http://www.mindtouch.com/) ) 显然是最用户友好的高级和创新 wiki，它是现代商业 + 开源产品。与 Office 文档的完美集成。

我会避免汇合。Confluence 做出了一个设计选择（禁止将 html 与 Wiki 语法混合在页面中），这对所见即所得的任何尝试都是致命的，因为它使用标准的 HTML 编辑器进行所见即所得，这会将其转换为保存在非常有限的子集中，产生令人沮丧的给用户带来惊喜（例如 foswiki 将 wiki 语法不处理的部分保存为 html，如表格单元格中的项目符号列表）。Confluence 有很多很棒的方面，特别是它与 atlassian 伟大工具的集成作为他们的 JIRA bugtracker，（我们在工作中使用它并取得了很好的结果）但不打算定制它。

托管 wiki 上也有很多不错的选择（基于出色的 jotspot 引擎的 Google 网站就是其中之一）。

当然，永远不要使用 Sharepoint。它的 wiki 功能是一个仅限 IE 的笑话，Sharepoint 整个架构是脑死的（将所有数据 - 甚至是巨大的文档 - 存储在非分布式数据库中，这违反了 Microsoft 自己的建议）。如果您想要一个具有良好 Office 集成的 DMS，请查看 KT（知识树）。 [http://www.knowledgetree.com/](http://www.knowledgetree.com/)。出于政治原因，我们被迫在工作中使用 Sharepoint，但我们将其限制为基本文档管理（从​​不使用 MOSS 更高层，因为它破坏了版本之间的兼容性）并集成了 foswiki 前端（将文档列表和元数据转储到 xml 和在 foswiki 中提供导航，并使用谷歌框搜索）

但我**真正的**建议是……等待 Google Wave，它有望彻底改变 wiki 的概念。

免责声明：我是 foswiki 社区的一员。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-07T13:49:06.310

在您离开 Mediawiki 之前，我会敦促您考虑许多可用的扩展。IMO 没有多少 wiki 提供比 MW 更多的功能，尤其是当您考虑扩展的数量时。见[http://www.mediawiki.org/wiki/Category:Extensions](http://www.mediawiki.org/wiki/Category:Extensions)

例如，对于编辑，有类似于 Word 的基于浏览器的编辑器。甚至还有用于 Word 的宏，允许您从 Word 中从 MS Word 导出到您的 Wiki。

此外，请查看 Semantic Mediawiki 扩展。这些给知识管理领域带来了巨大的好处。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-19T14:45:08.590

我个人建议不要从 Wiki 迁移到 SharePoint。最大的问题是 SP 对图像的可怕处理。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-02-03T10:32:29.993

首先，我会远离 Sharepoint。时期。

我也不会考虑切换到 Trac，因为 Trac 特别关注问题跟踪，并且对外部文档的支持很差。

我会考虑切换到**Confluence**，因为：

*   钱不是问题（如你所说）
*   您想尽量减少维护工作（如您所说）
*   您想使用 wiki 处理外部文档（如您所说）

我通常是开源技术的坚定拥护者，但是根据您提出的要求，我认为它们不会让您满意。例如，如果您有人员可用于维护和为您的系统提供定制，我肯定会建议尝试 Foswiki，否则它也可以很好地满足您的需求。但是，如果您真的想远离任何额外的维护工作，Foswiki 不是一个好的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-25T17:09:11.840

我在 Tiki Wiki CMS Groupware 上工作，我将分享一些链接。这个问题出现了很多，所以我们有一个专门的页面：[http ://tiki.org/Tiki+vs+MediaWiki](http://tiki.org/Tiki+vs+MediaWiki)

> 我们正在考虑从现有的 MediaWiki 安装迁移

*   Tiki 和 MediaWiki 都是 PHP/MySQL，因此您可以使用相同的服务器。
*   Tiki 有一个内置的导入器： http: [//doc.tiki.org/MediaWiki+importer](http://doc.tiki.org/MediaWiki+importer)

> 到功能更丰富的东西。

*   Tiki 是[http://tiki.org/FOSS+Web+Application+with+the+most+built-in+features](http://tiki.org/FOSS+Web+Application+with+the+most+built-in+features)

> 我们正在使用 wiki 来获取设计、规范和流程指南。我们有几个外部文档（文档、powerpoints），我们目前将它们放在一个共享文件夹中并从 wiki 链接到（因为在 MediaWiki 中上传文件不是很方便）。我们正在努力使摩擦最小化，这样任何人都不会有借口或理由不使用它。

*   [http://doc.tiki.org/WYSIWYG](http://doc.tiki.org/WYSIWYG)
*   [http://doc.tiki.org/File+Gallery](http://doc.tiki.org/File+Gallery)（而不是您的共享文件夹）
*   [http://doc.tiki.org/Docs](http://doc.tiki.org/Docs)（基于网络的 ODF）
*   [http://doc.tiki.org/Spreadsheet](http://doc.tiki.org/Spreadsheet)（基于网络）
*   [http://doc.tiki.org/Slideshow](http://doc.tiki.org/Slideshow)（基于网络）
*   [http://doc.tiki.org/Draw](http://doc.tiki.org/Draw)（基于网络）

> 我们正在考虑的一些选项是 Confluence、Trac 和 Sharepoint。钱不是一个大问题，只有易用性（和维护）和功能齐全。你会用什么？

Tiki 是免费/开源的。但是如果你有钱烧你的口袋:-) [http://tiki.org/Donation](http://tiki.org/Donation)

您还可以聘请顾问提供培训/支持并加速实施和/或赞助功能开发 [http://info.tiki.org/Consultants](http://info.tiki.org/Consultants)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T21:51:09.303

您是否考虑过与[Google Docs](http://docs.google.com)共享您的 Word 文档？它具有修订控制和协作功能，例如 wiki，以及可以导入和导出大量格式的富文本编辑器。

听起来 TWiki 对您来说也是一个不错的选择。我自己没有使用过它，但它也有一个富文本编辑器，以及大量的企业项目管理功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T21:15:04.547

很多人似乎都喜欢 Confluence。我个人不知道。如果您还没有使用它，并且您想要比[xwiki](http://www.xwiki.org)功能更丰富的东西，那么它可能适合您。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-14T12:02:39.060

我会为 WYSIWYG 添加[FCK 编辑器](http://www.mediawiki.org/wiki/Extension:FCKeditor_%28Official%29)，获得一个像样的文档管理系统来与 wiki 一起运行并继续使用 MediaWiki！

# c++ - 具有无效函数类型或数组类型参数的 SFINAE？

> ID：822059
> 
> 赞同：21
> 
> 时间：2009-05-04T21:05:17.987
> 
> 标签：c++, arrays, templates, sfinae

请考虑以下代码：

```
template<typename T>
char (&f(T[1]))[1];

template<typename T>
char (&f(...))[2];

int main() { char c[sizeof(f<void()>(0)) == 2]; } 
```

我预计它会做 SFINAE 并选择第二个重载，因为替换`T`为`T[1]`产量

```
 void [1]() 
```

当然，这是无效的类型。在将模板参数替换为函数参数并检查有效的结果类型（如 14.8.2 [temp.deduct] 描述）之后，完成参数类型（数组->指针）的调整。

但是 comeau 和 GCC 都无法编译上述内容。两者都有不同的诊断。

科莫 说：

> “ComeauTest.c”，第 2 行：错误：不允许使用函数数组`char (&f(T[1]))[1];`

GCC 说（版本`4.3.3`）：

> 错误：ISO C++ 禁止零大小数组`c`

意思是，GCC 没有替换失败，但是它选择了 的第一个重载`f`，返回`sizeof`1 的 a，而不是像 Comeau 那样没有替换它。

什么编译器是正确的，我的代码是否有效？请在您的答案中参考或引用适当的标准部分。谢谢！

* * *

**更新**：标准本身在列表中包含这样一个示例`14.8.2/2`。我不知道，为什么我首先忽略了它：

```
template <class T> int f(T[5]);
int I = f<int>(0);
int j = f<void>(0); // invalid array 
```

虽然这个例子只是提供信息，但它显示了所有这些神秘段落的意图，并且似乎表明上面的代码应该可以工作并拒绝第一个重载。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T13:32:25.413

一个小提示，虽然非常罕见，但我发现了一些我认为 Comeau 编译器出错的情况 - 尽管这些情况非常罕见，因此总是值得双重和三次检查您的假设！

我可能对 g++ 的行为有原因。我不确定在调整参数类型时是否准确指定：

考虑以下：

```
template<typename T>
struct A
{
  void bar (T[10]);
};

template<typename T>
void A<T>::bar (T*)
{
} 
```

'bar' 的定义是合法的，因为 "T[10]" 衰减为 "T*"。我在标准中没有看到任何禁止编译器针对模板声明执行 8.3.5 调整的内容，并且在重载匹配方面也提高了性能。

将此应用于您的示例，g++ 可能会将其视为：

```
template<typename T>
char (&f( T* ))[1];

template<typename T>
char (&f(...))[2];

int main() { char c[sizeof(f<void()>(0)) == 2]; } 
```

在上面，被替换的参数是一个合法的函数指针，而不是一个函数数组。

所以，我的问题是 - 是否有什么东西禁止对函数参数（8.3.5）进行两次调整？

就个人而言，我认为允许调整发生两次是有意义的，否则会使函数模板重载的匹配变得复杂

总之，我认为 g++ 根据它如何处理衰减的数组参数来选择第一个重载是有效的，而 Comeau 不对函数数组进行演绎失败是错误的。

当然，现在这意味着（如果 Comeau 已修复）那么每个编译器都会选择不同的重载，并且仍然符合标准！:(

**编辑：**

为了说明我的观点，请考虑以下代码：

```
template <typename T> void foo ( T * );
template <typename T> void foo ( T * const );
template <typename T> void foo ( T [] );
template <typename T> void foo ( T [10] );
template <typename T> void foo ( T [100] );

void bar () 
{
  foo < void() > ( 0 );
} 
```

在这里， foo 已经多次声明和重新声明。编译器应该应用 14.8.2 中列出的规则，哪个声明，以及哪个参数类型？

我的观点是，该标准对上述内容没有任何说明。我还要说，任何关于此的措辞都必须将其保留为“未定义”或“实现定义”的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:14:27.980

令人惊讶的是——这在 VS2008 中确实有效。我认为这不一定是正确行为的证据，尽管...

Visual Studio 正在解释

```
char (&f(T[1]))[1]; 
```

作为一个函数，它接受一个大小为 1 的 T 数组，并返回一个对大小为 1 的字符数组的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T21:34:52.347

我将尝试描述我从阅读标准中理解的模板参数推导的过程。

1.  如 14.8.2/2 中所述检查显式模板参数。
2.  根据 8.3.5 调整生成的函数签名（即执行数组到指针衰减）。
3.  根据 14.8.2.1 推导出隐式模板参数（这是在步骤 2 中的部分替换签名上执行的）。

第一个重载的推导在步骤 1 中失败，因此重载解析返回第二个重载。我不相信这个程序是错误的。

# communication - 是否存在更适合与编程相关的讨论的交流工具？

> ID：822062
> 
> 赞同：-2
> 
> 时间：2009-05-04T21:05:30.013
> 
> 标签：communication

我问这个问题是因为 SO 不是特别适合这种任务，因为它是为提出这样的问题而设计的。因此，我既不问它相对于 SO。我问是否有比老式论坛、邮件列表、wiki、IRC 或 afk 聊天更适合编程相关讨论的工具。

像这样的工具可以让人们提炼有趣的讨论，总结它，帮助他们进行逻辑分析，并比我刚才描述的任何服务更好地提出建设性的讨论。

所以继续，回答，我会看看哪个答案最匹配。

（不标记这个“讨论”，因为即使它相关，讨论标签也被用来忽略需要讨论的问题。这个问题显然不是这样，因为一个人可以用软件名称回答这个问题。）

（为什么我需要这种应用程序？我会从非常熟练的人那里得到更多，我遇到的更难的问题是非常难回答或根本没有答案。除非我花费数月或数年的时间来寻找此类问题的答案问题 - 或者更糟糕的是，寻求答案只是为了发现没有答案 - 我认为除了建立一个关于它们的讨论之外，没有其他方法可以回答这些问题。另外我相信很多人会再次提出相同的问题，所以我充其量不会连问题都不需要问，他们已经被我问过了。我只需要找到它们……我想问这个的时候我真的很懒。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T21:06:35.253

不，没有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:09:54.980

你要找的是一个可以交谈的社区，而不是一个工具。如果人们想讨论他们喜欢什么，他们就会——不管他们被迫使用什么工具来做这件事。

# c# - 适用于商业应用程序的原生 C++ 或 .NET？

> ID：822066
> 
> 赞同：1
> 
> 时间：2009-05-04T21:06:37.220
> 
> 标签：c#, .net, c++, platform, windows-server-2000

**事情是这样的：我正在计划一个绝对必须**支持 Win2k的中型商业应用程序。AFAIK，对 Win2k 的官方 .NET 支持不久前被废弃（IIRC，它停止在 2.0 版）。

现在，我已经（很久以前）用 C++ 编写了库，它允许我完成最终结果（即完成这个项目），就像我在 .NET 框架的帮助下编写这个应用程序一样快——所以 .NET 的RAD 的“优势”几乎被否定了。

我敢肯定，这里有很多人处理需要支持旧操作系统的业务应用程序。那么，鉴于我的图书馆情况，使用 .NET 优于原生 C++ 对我有什么优势，反之亦然？我只是不确定两者中的哪一个适合这份工作——因为我似乎可以使用其中任何一个。再说一次，有那个框架支持问题需要处理......

如果需要，我很乐意添加更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T21:48:04.513

在 Windows 2000 下运行的最后一个 .NET 版本是*.NET 2.0 SP2*。它确实包含*System.Core.dll*（这是 .NET 3.5 的一部分）所需的功能。

答案是肯定的，如果您不打算使用*.NET 3.0*库（WCF、WF、WPF、CardSpace），则可以在 Windows 2000 下使用*.NET 3.5 SP1 。*但是你有 LINQ、LINQ to XML、LINQ to SQL。

 *您唯一需要做的就是部署三个核心*.NET 3.5 SP1*文件：

*   System.Core.dll
*   System.Xml.Linq.dll（LINQ to XML）
*   System.Data.Linq.dll (LINQ to SQL)

这种方法的缺点（仔细阅读）：

*   不确定 EULA（最终用户许可协议）是否允许或禁止
*   Microsoft 不支持此方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T21:09:56.587

我想看看 Mono ( [mono-project](http://www.mono-project.com) ) 是否适合你。即在win2k 上运行——如果它运行，它将允许您将您的应用程序移植到MS .NET 和更高版本的操作系统，以防项目后期出现需要。任何 .NET 都将比 C++ 恕我直言：)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T21:12:21.743

最大的不同是，在您开始做其他事情之后，您（或您的老板）更有可能找到开发人员来维护您的 .NET 代码。

C++ 具有为您提供工作稳定性的优势——尽管这可能不是您想要的。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T21:13:09.823

我认为，鉴于您的情况，归结为您在写作时感觉更舒服。如果 C++ 对您来说是一种舒适的语言，那就去做吧。它将帮助您进入代码并使其更容易完成。

我也会注意牢记未来。如果 Win2K 要求下降，如果你用 C++ 编写，可能需要你重写。可能不会。在您决定如何进行时，请记住这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T21:58:39.747

您可以使用 .NET 进行开发，但将编译器选项设置为面向 .NET 2.0 框架。如果操作系统在近期（或远期）升级，您可以升级您的程序以针对 3.5 框架。我会走这条路，因为它可以让其他人更轻松地进行未来维护。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T04:41:29.590

你考虑过德尔福吗？您可以[免费下载 Turbo Delphi](http://www.turboexplorer.com)，您可以轻松地编写面向 Windows 2000 的代码。使用 Delphi，您将获得出色的 RAD（可以说比您在 C++ 中找到的任何东西都要好……除非您使用 C++ Builder）。

Delphi 创建本地代码，并且没有运行时要求。

当然，缺点是如果您不了解 Delphi（Object-Pascal），您必须熟悉一门新语言。但是，如果您了解 C++，您很快就会对 Delphi 感到宾至如归。

# javascript - 交互式 Javascript 控制台（最好与 Firebug 集成）

> ID：822071
> 
> 赞同：10
> 
> 时间：2009-05-04T21:08:35.093
> 
> 标签：javascript, debugging, firefox, firebug

我正在寻找一种具有交互式 JIT 调试器的方法，最好与 Firebug 集成。

我从 PHPEd 得到这个想法，它有一个“立即”调试选项卡，您可以在其中输入 PHP 代码并即时修改对象。这使得调试变得轻而易举，因为您可以在不离开程序的情况下多次重新分配变量、重新执行函数等。

这是我认为非常棒的： - 在 Firebug 中设置断点 - 到达断点 - 有一个执行 JS 选项卡，可以在其中输入 JS 代码，类似于我上面描述的

这样的事情已经存在了吗？

TIA。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-04T21:12:41.730

您已经可以在 Firebug 中执行此操作。只需到达一个断点，然后转到“控制台”选项卡，然后在底部的命令行中输入您的命令（那里有“>>>”）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T21:14:56.480

如果我正确理解了这个问题，我认为可以在萤火虫中做到这一点。

*   设置断点（或使用调试器关键字）
*   单击控制台选项卡
*   底线允许您输入 javascript 命令。
*   如果您需要更多空间，请单击浏览器右下角看起来像倒置 v 的图标。

您可能还喜欢[JS 执行扩展](https://addons.mozilla.org/en-US/firefox/addon/1729)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T21:15:44.700

实际上，Firebug 可以做到这一点，只需[在他们的网站上](http://getfirebug.com/)进行一些调查即可了解如何做到最好:) 祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T04:10:28.417

Agree with parents that Firebug is the best choice. Another option that requires a good deal of configuration would be [Aptana](http://www.aptana.com/). For folks using the Eclipse IDE, Aptana is a solid editor for Javascript work. The plus with Aptana is that it's tied more to a code editing environment.

# cross-browser - 用于查看网站在 IE7 中的外观的服务？

> ID：822077
> 
> 赞同：3
> 
> 时间：2009-05-04T21:10:22.140
> 
> 标签：cross-browser

在开发过程中，您是否可以使用任何好的服务来尝试您的网站在不同浏览器中的呈现方式？我们在 Mac 上开发。我希望能够每月支付 20 美元或类似的费用，并且能够在 IE6、IE7、Opera 等中使用 VNC 并测试我的网站，而不必保留 Windows 框。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T21:17:53.587

您可以使用 VMware 并安装您自己的 Windows 客户操作系统，并按照您的喜好对其进行配置。避开中间人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T21:13:02.337

[浏览器截图](http://browsershots.org/)。它是免费的，您可以在几乎任何可以想象的浏览器上测试您的网站。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T21:14:52.113

[http://browsershots.org/](http://browsershots.org/)是一项免费服务

[http://litmusapp.com/](http://litmusapp.com/)提供免费服务和一些付费服务

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T21:16:10.770

如果您需要远程访问而不仅仅是屏幕截图，[http://www.browsercam.com](http://www.browsercam.com)可以做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T21:20:33.287

[其他人建议的Browsershots](http://browsershots.org/)可以工作，但如果您需要测试功能，虚拟机中的 Windows 可能是更好的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-03T06:46:42.363

尽管我不喜欢 Windows，但虚拟化是我发现在每个浏览器附近进行测试的唯一方法。

Widows 7 Ultimate（XP 模式）=> Safari、IE6、IE7、IE8、IE9、Chrome、Opera

添加 VirtualBox 和 Linux 来宾，如 Ubuntu => Konqueror

请注意，您不能同时运行 2 个虚拟化软件，除非有人在这里指定我们如何为每个软件分配单独的处理器。

# c# - 为什么我不能使用 DataContractSerializer 序列化对象？

> ID：822082
> 
> 赞同：3
> 
> 时间：2009-05-04T21:12:41.493
> 
> 标签：c#, .net, wcf, datacontractserializer

我正在尝试使用 DataContractSerializer 序列化一个类型，并得到以下异常。这不适用于 SOA 服务，但如果可能，我仍然希望使用 DataContractSerializer。我正在使用.Net 3.5 SP1。

> 预计不会使用数据合同名称“DelegateSerializationHolder.DelegateEntry: [http://schemas.datacontract.org/2004/07/System ”键入“System.DelegateSerializationHolder+DelegateEntry”。](http://schemas.datacontract.org/2004/07/System)将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T21:21:27.557

你能发布你的类定义吗？

似乎您正在尝试序列化一个具有委托类型字段的类，我很确定这会使序列化程序窒息。

您是否使用 DataContract / DataMember 属性装饰了您的班级？在 3.5 SP1 中，序列化程序有一个默认行为，如果没有用这些属性标记，默认情况下序列化类中的所有公共内容。也许您应该使用 DataMember 属性明确标记需要序列化的每个属性，并忽略那些不应该序列化的属性。

除此之外，我们需要查看您的类定义以获得更多帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-04T03:42:47.957

有 3 种可能的方法可以避免[http://blogs.microsoft.co.il/blogs/oshvartz/archive/2009/10/10/passing-event-handlers-over-wcf.aspx中描述的错误](http://blogs.microsoft.co.il/blogs/oshvartz/archive/2009/10/10/passing-event-handlers-over-wcf.aspx)

# c# - 在呈现文本框的自定义服务器控件上附加RequiredValidator

> ID：822085
> 
> 赞同：-1
> 
> 时间：2009-05-04T21:12:56.750
> 
> 标签：c#, asp.net, servercontrols

我不知道这是否真的可能，但我正在尽力而为。

如果我有一个（复杂的）自定义服务器控件（在其他控件旁边）在 UI 上呈现一个 TextBox。将服务器控件放置在页面上时，是否可以将RequiredField 验证器附加到该服务器控件，以便验证器验证该控件的Text 属性，该控件指向所呈现的TextBox 的Text 属性？

当然，我可以将RequiredField 验证器直接合并到服务器控件中，但由于其他原因，这是不可能的（我们在UI 上自动呈现RequiredField 验证器）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T21:40:44.907

我认为一种解决方案是将 TextBox 控件放在 Panel 中，然后在 Page_Load 事件处理程序上动态添加 RequiredValidator 控件。

```
<asp:Panel ID="Panel1" runat="server">
 <MyCustomTextBox ID="TextBox1" runat="server"></MyCustomTextBox>
 </asp:Panel>
<asp:Button ID="Button1" runat="server" Text="Button" /> 
```

然后

```
protected void Page_Load(object sender, EventArgs e)
        {
            var validator = new RequiredFieldValidator();
            validator.ControlToValidate = "TextBox1";
            validator.ErrorMessage = "This field is required!";
            Panel1.Controls.Add(validator);

        } 
```

我将 CustomTextBox 放在面板内，以确保添加时验证控件位置正确

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:19:18.870

我知道了，这是我第二次回答我自己的帖子:) 下次我会做更深入的研究。

对于那些可能遇到同样问题的人。您必须`ValidationProperty`在服务器控件的类上指定属性。例如，如果您的服务器控件公开了一个属性“Text”，该属性显示给用户并且也应该进行验证，则添加以下内容：

```
[ValidationProperty("Text")] 
```

然后它应该工作。

# php - 如何将子域路由到帐户页面？域掩码如何工作？

> ID：822100
> 
> 赞同：3
> 
> 时间：2009-05-04T21:15:39.710
> 
> 标签：php, zend-framework, web-applications, url-routing

## 第1部分

我想构建一个用户可以注册使用的 PHP Zend Framework 应用程序。当他们注册时，我希望应用程序创建一个指向他们的公共页面的子域，该子域提供特定于该客户端的内容。

例如： http: [//mywebapp.com/username](http://mywebapp.com/username)或[http://username.mywebapp.com](http://username.mywebapp.com)

**更新：** [“使用子域作为帐户密钥”](http://www.noginn.com/2008/09/03/using-subdomains-as-account-keys/)是一个很好的教程，它几乎回答了我在这个问题上的问题。这涉及使用[`Zend_Controller_Router_Route_Hostname`](http://framework.zend.com/manual/en/zend.controller.router.html#zend.controller.router.routes.hostname).

但是，我仍然想知道...

**问题 #1：**本教程没有提到设置通配符子域。为了实现这一目标，这是必要的吗？有没有办法使用通配符子域？

* * *

## 第2部分

我还需要为用户提供注册域名并将他们指向他们的页面的能力。因此，如果您要访问[http://clientdomain.com](http://clientdomain.com)，您会看到[http://clientname.mywebapp.com](http://clientname.mywebapp.com)，但您永远无法分辨，因为地址栏中的 url 显示[http://client1 .com](http://client1.com) _ 那有意义吗？我认为这个过程称为域屏蔽。我基本上想为我的用户提供免费的域掩码。

**更新：**我刚刚发现了域名经销商 API 的世界。[OpenSRS](http://opensrs.com/)看起来不错。你有推荐的吗？

**问题 #2：**域屏蔽如何工作？它可以与域经销商 API 一起使用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T17:16:32.737

首先，你是对的。您不希望应用程序有多个实例/安装。设置多个 Apache 虚拟主机指向 Doc Root。

```
ServerName  www.serverOne.com
DocumentRoot "/htdocs/myapp/public"
SetEnv CONFIG_ENV "serverOne"   

ServerName www.serverTwo.com
DocumentRoot "/htdocs/myapp/public"    
SetEnv CONFIG_ENV "serverTwo" 
```

将所有基本 url、路径等放在 Zend_Config_Xml 文件的不同部分。

```
<?xml version="1.0" standalone="yes"?>
<config>
<siteOne>
   <base_url>http://www.siteOne.com</base_url>
       <image_path>/images/siteOne/</image_path>
       <database>
          <host>34.23.34.457</host>
          <name>siteOne_DB</name>
          <user>siteOne</user>
          <pass>**********</pass>
       </database>
    </siteOne>
    <siteTwo>
   <base_url>http://www.siteTwo.com</base_url>
       <image_path>/images/siteTwo/</image_path>
       <database>
          <host>34.23.34.456</host>
          <name>siteTwo_DB</name>
          <user>siteTwo</user>
          <pass>**********</pass>
       </database>
    </siteTwo>
</config> 
```

然后在你的 /public/index.php

```
<?php
require '../common/config/Bootstrap.php';
$bootstrap = new Bootstrap($_SERVER['CONFIG_ENV']);
$bootstrap->runApp();
?> 
```

在 Bootstrap.php 的 runApp() 方法中：

```
function runApp($env)
{
   $root   = realpath(dirname(__FILE__) . '/..');
   $config = new Zend_Config_Xml($root . '/config.xml', $env); 
```

这将与相对链接完美配合，并且不需要任何模式匹配:)

如果您没有 Bootstrap.php 文件，您可以在 Manning Press 的“Zend Framework In Action”一书中了解如何创建和使用，该书可立即作为 PDF 下载。它帮助我度过了一些艰难的时期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T05:56:35.240

对于您问题的第 1 部分，您可以在此处实施任何解决方案-但我不确定您是否需要路由器-您不会为每个站点提供不同的功能-您只想根据 URL 加载不同的内容。我们以非常简单的方式处理这个问题：

1.  在您的 bootstrap.php 中，您需要获取服务器 URL
2.  获取 URL 并去掉 http:// 之后和 .mywebapp.com 之前的部分
3.  在数据库表中查找此前缀并加载您需要的有关用户的任何信息或与此前缀有关的其他信息
4.  将一个对象放入 Zend_Config 中，然后您可以从任何带有站点详细信息的页面访问该对象（我们称之为 siteinfo）。
5.  修改您的控制器或视图以根据站点信息做出不同的响应 - 即。更改他们检索的数据等

您将需要修改 apache 来处理这个问题 - 最简单的方法是确保您的默认域（无法识别 URL 时出现的页面）设置为您的应用程序。

处理 DNS 更改并不容易——您需要有一个可以处理通配符回复的 DNS 服务器。

**第 2 部分：** 我认为您是在说，如果我输入 URL [http://grouchal.com](http://grouchal.com)这将重定向到[http://grouchal.yourwebapp.com](http://grouchal.yourwebapp.com)。这将需要我更新 grouchal.com 的现有 DNS 服务器条目，以便找到您的服务器。

如果你想在实践中看到一个很好的例子，你应该为你的域帐户设置一个谷歌应用程序。我有像 mail.grouchal.com 这样的网址，一旦输入就变成了 mail.google.com/a/grouchal.com。这需要我将 grouchal.com DNS 服务器设置为指向 google 服务器。然后，谷歌服务器会设置一个重定向以将 URL 更改为他们需要的 URL。

[回到我上面提出的解决方案，您将对其进行修改，以便除了检查您的域名何时存在的前缀（即从http://grouchal.mywebapp.com](http://grouchal.mywebapp.com)中删除 grouchal ）之外，它还将查找备用域. 因此，如果地址中没有 mywebapp.com，那么它将在数据库 grouchal.com 中查找，然后使用该数据设置站点信息。

希望这是有道理的 - 您将遇到的问题不会出现在 PHP 中，而是在设置通配符 DNS 服务器和让您的客户正确配置他们的 DNS 服务器时。祝你项目好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T09:38:58.627

由于 Zend Framework 使用 MVC 模式，您可以拥有单个模型和控制器，然后为每个域提供不同的视图。

自定义视图后，您可以检测键入的域并显示正确的视图。例如，在您的引导程序中，您可以通过以下方式检测域：

```
// Bootstrap or controller
$domain = array_reverse(split('[.]', $_SERVER['SERVER_NAME']));
$domain = $domain[1] . '.' . $domain[0];

// Store domain in registry
Zend_Registry::set('domain', $domain);

// Calling the view from the controller
$domain = Zend_Registry::get('domain');
$this->render($domain . 'home'); 
```

这只是和想法！

# msbuild - MSBuild (SDC) 和 WIX 中的 XPath

> ID：822104
> 
> 赞同：0
> 
> 时间：2009-05-04T21:15:56.853
> 
> 标签：msbuild, xpath, wix, microsoft.sdc.tasks

新鲜问这个问题->

我有一个需要使用 MSBuild 修改的 WIX 文件。它是这样开始的：

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:iis="http://schemas.microsoft.com/wix/IIsExtension">

  <?--... Various Removed Params ...-->

  <Product Id='$(var.ProductCode)'
    UpgradeCode='$(var.UpgradeCode)'
    Name='$(var.AppName)' Language="1033" Version='$(var.ProductVersion)'
    Manufacturer='$(var.Manufacturer)'>
    <Package Id='$(var.PackageCode)' InstallerVersion="200" 
    Compressed="yes" />

  <?--... More of the WIX XML file ...-->

  <iis:WebApplication Id='STWebApp' Name='MyWebSite' Isolation='medium' />

  <?--... Rest of the WIX XML file ...--> 
```

我的问题是 SDC 任务似乎无法引用任何与 WIX 相关的 xml 节点。例如：

```
<XmlFile.SetAttribute Path="$(MSBuildProjectDirectory)\TestProduct.wxs"
         XPath="//iis:WebApplication" Namespaces="@(Namespaces)" 
         Name="Name" Value="$(VersionTag)"/> 
```

工作得很好，因为它不使用任何 Wix 节点（只是一个 iis 节点），但是如果我使用它的完整 XPath 路径（*/Wix/Product/iis:WebApplication*）任务返回： **找不到资源字符串没有找到匹配项对于 XPath 表达式**

在我想引用目录节点（/Wix/Product/Directory/Directory/Directory/Directory[@Id='STWebSiteDir']）之前，这不是问题

我尝试使用完整的 XPath 和较短的 //Directory[@Id='STWebSiteDir']。我尝试过单引号和双引号，**我尝试将 WIX 命名空间添加到调用中（没有前缀）。**

```
<ItemGroup>
  <Namespaces Include="http://schemas.microsoft.com/wix/IIsExtension">
    <Prefix>iis</Prefix>
    <Uri>http://schemas.microsoft.com/wix/IIsExtension</Uri>
  </Namespaces>
  <Namespaces Include="http://schemas.microsoft.com/wix/2006/wi">
    <Prefix></Prefix>
    <Uri>http://schemas.microsoft.com/wix/2006/wi</Uri>
  </Namespaces>
</ItemGroup> 
```

我什至试图获得对 /Wix/Product 的引用，即使这样也失败了：

```
<XmlFile.SetAttribute Path="$(MSBuildProjectDirectory)\TestProduct.wxs" 
            XPath="/Wix/Product" Namespaces="@(Namespaces)" 
            Name="Name" Value="MODIFIED"/> 
```

我显然错过了一些东西。任何人都暗示去哪里让它工作？

瓦卡诺

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T03:39:18.897

您可以在命令行上将变量定义为预处理器吗？

```
candle -dVariableName=ValueForVariable 
```

那可能会容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:27:06.750

您是否在 @(Namespaces) 中包含了 Wix 默认命名空间？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-24T03:42:29.073

```
<ItemGroup>
  <Namespaces Include="http://schemas.microsoft.com/wix/IIsExtension">
    <Prefix>iis</Prefix>
    <Uri>http://schemas.microsoft.com/wix/IIsExtension</Uri>
  </Namespaces>
  <Namespaces Include="http://schemas.microsoft.com/wix/2006/wi">
     <Prefix>wis</Prefix>
    <Uri>http://schemas.microsoft.com/wix/2006/wi</Uri>
  </Namespaces>
</ItemGroup> 
```

你也应该为wi命名空间添加一个前缀，之后就可以了，我已经测试过了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T22:06:17.513

好的，所以这是答案：

wix 部分需要缺少命名空间前缀，而不仅仅是留空

```
<ItemGroup>
  <Namespaces Include="http://schemas.microsoft.com/wix/IIsExtension">
    <Prefix>iis</Prefix>
    <Uri>http://schemas.microsoft.com/wix/IIsExtension</Uri>
  </Namespaces>
  <Namespaces Include="http://schemas.microsoft.com/wix/2006/wi">

    <Uri>http://schemas.microsoft.com/wix/2006/wi</Uri>
  </Namespaces>
</ItemGroup> 
```

然后您需要在文件中的 wix 命名空间中添加一个前缀值。我用过tst。

瓦卡诺

# ant - 使用通配符更新属性值

> ID：822117
> 
> 赞同：0
> 
> 时间：2009-05-04T21:19:59.683
> 
> 标签：ant

我原以为如果您不提供目标，xmltask 会修改源文件并替换它，但显然情况并非如此，因为以下代码不起作用：

```
<xmltask source="**\plugin.xml"> 
    <attr path="plugin" attr="version" value="12345" /> 
</xmltask> 
```

如果我指定一个目的地，我会收到一条错误消息“多个输入，但只有一个目的地”：

```
<xmltask source="**\plugin.xml" dest="**\plugin.xml"> 
    <attr path="plugin" attr="version" value="12345" /> 
</xmltask> 
```

我怎样才能让它与通配符一起使用？可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T23:27:07.460

不要用 指定单个输出文件，而是用`dest`指定输出目录`todir`：

```
<xmltask source="**\plugin.xml" todir="output"> 
   <attr path="plugin" attr="version" value="12345" /> 
</xmltask> 
```

# javascript - 解压缩/解压缩 JavaScript 的工具

> ID：822119
> 
> 赞同：436
> 
> 时间：2009-05-04T21:20:32.833
> 
> 标签：javascript, code-formatting, minify, compression, unminify

是否有任何命令行脚本和/或在线工具可以逆转缩小的效果，类似于 Tidy 如何清理可怕的 HTML？

（我特别希望取消缩小一个缩小的 JavaScript 文件，因此变量重命名可能仍然是一个问题。）

* * *

## 回答 #1

> 赞同：507
> 
> 时间：2009-05-04T21:24:00.563

你可以使用这个： http: [//jsbeautifier.org/](http://jsbeautifier.org/) 但这取决于你使用的 minify 方法，这个只是格式化代码，它不会改变变量名，也不会解压缩 base62 编码。

编辑：实际上它可以解压“打包”脚本（与 Dean Edward 的打包程序打包： http: [//dean.edwards.name/packer/](http://dean.edwards.name/packer/)）

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2011-08-22T15:22:33.323

Chrome 开发者工具内置了这个功能。调出开发者工具（按 F12 是一种方式），在 Sources 选项卡中，左下方的栏有一组图标。“{}”图标是“Pretty print”并按需进行此转换。

更新：IE9“F12 开发人员工具”在“工具”图标下的“脚本”选项卡中也有“格式化 JavaScript”功能。（*请参阅*F12中的提示 #4[最好的 Web 调试秘密](http://blogs.msdn.com/b/cdndevs/archive/2011/10/18/f12-the-best-kept-web-debugging-secret.aspx)）

[![在此处输入图像描述](https://i.stack.imgur.com/wIMSh.jpg)](https://i.stack.imgur.com/wIMSh.jpg)

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-06-22T16:26:04.827

知道了！[JSBeautifier](http://jsbeautifier.org/)正是这样做的，您甚至可以选择自动格式化。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-05-04T21:25:38.467

你不能只使用 javascript 格式化程序 ( [http://javascript.about.com/library/blformat.htm](http://javascript.about.com/library/blformat.htm) ) 吗？

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-10-03T12:46:54.493

在 Firefox、SpiderMonkey 和 Rhino 中，您可以将任何代码包装到匿名函数中并调用其[`toSource`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/toSource)方法，这将为您提供格式良好的函数源。

`toSource`还剥离评论。

*例如。*：

```
(function () { /* Say hello. */ var x = 'Hello!'; print(x); }).toSource() 
```

将转换为字符串：

```
function () {
    var x = "Hello!";
    print(x);
} 
```

*PS*：它不是一个“在线工具”，但所有关于一般美化技术的问题都作为这个问题的重复而关闭。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2011-10-11T22:53:24.020

如果您有 Mac 和 TextMate - 格式化 Javascript 的简单替代方法是：

1.  使用 Textmate 打开文件。
2.  单击 > Bundles > JavaScript > 重新格式化文档
3.  打开啤酒。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-06-21T17:09:10.010

大多数 IDE 还提供自动格式化功能。例如**，在 NetBeans 中，只需按 CTRL+K**。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-09-21T22:57:18.930

作为替代方案（因为直到现在我才知道 jsbeautifier.org），我使用了一个书签，它重新启用了 Dean Edward 的 Packer 中的解码按钮。

[我在这里](http://yaisb.blogspot.com/2006/10/defeating-dean-edwards-javascript.html)找到了说明和书签。

这是书签（以防网站关闭）

```
javascript:for%20(i=0;i<document.forms.length;++i)%20{for(j=0;j<document.forms[i].elements.length;++j){document.forms[i].elements[j].removeAttribute(%22readonly%22);document.forms[i].elements[j].removeAttribute(%22disabled%22);}} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-05-23T03:18:44.127

我不确定您是否需要源代码。[在http://www.blackbeltcoder.com/Resources/JSFormatter.aspx](http://www.blackbeltcoder.com/Resources/JSFormatter.aspx)有一个免费的在线 JavaScript 格式化程序。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2011-10-22T12:59:54.037

试试这个，用代码着色：

[http://labs.swelen.com/tools/javascript/beauty.html](http://labs.swelen.com/tools/javascript/beauty.html)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-01-18T05:52:22.943

点击这些链接进行JS deminification。这将作为扩展安装在 FF 上，帮助您在运行时调试 js。

[https://addons.mozilla.org/en-US/firefox/addon/javascript-deminifier/eula/141018?src=dp-btn-primary](https://addons.mozilla.org/en-US/firefox/addon/javascript-deminifier/eula/141018?src=dp-btn-primary)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-06-13T11:53:14.673

与[Stone](https://stackoverflow.com/users/122183/stone)的回答类似，但适用于 Windows/.NET 开发人员：

如果您有 Visual Studio 和 ReSharper - 格式化 Javascript 的一个简单替代方法是：

*   用 Visual Studio 打开文件；
*   点击 ReSharper > 工具 > 清理代码 (Ctrl+E, C)；
*   选择“默认：重新格式化代码”，点击确定；
*   打开啤酒。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-08-13T12:49:09.423

尽管[JSPretty](http://www.jspretty.com/)的界面远非漂亮，但它是一个很好的、免费的在线工具，可以让 javascript 源代码成为人类可读的。您可以强制执行您喜欢的缩进类型，它还可以检测混淆。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-04-29T08:34:02.277

如果一个人在 JS 中使用 Firefox 的可能性更大。如果它的 Firefox 插件是为了救援。下面一个特别有用。

[https://addons.mozilla.org/en-US/firefox/addon/phoenix/](https://addons.mozilla.org/en-US/firefox/addon/phoenix/)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-07-29T10:04:59.953

**[Pretty Diff](http://prettydiff.com/?m=beautify)**将以符合[JSLint](http://jslint.com/)和[JSHint](http://jshint.com/)空白算法的方式美化（漂亮打印）JavaScript。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-11-18T20:21:39.387

我对 jsbeautifier.org 的输出内容并不满意，因此我进行了更多搜索并找到了这个网站：[http ://www.centralinternet.com.br/javascript-beautifier](http://www.centralinternet.com.br/javascript-beautifier)

对我来说工作得非常好。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2012-12-28T03:56:23.447

[http://unminify.appspot.com/](http://unminify.appspot.com/) unminify javascript 和 json 的好工具

# algorithm - 模糊日期算法

> ID：822124
> 
> 赞同：32
> 
> 时间：2009-05-04T21:21:38.040
> 
> 标签：algorithm, date, formatting, nsdate, fuzzy

我正在寻找一种模糊日期算法。我刚开始写一个，就意识到这是一项多么乏味的任务。它很快退化成许多可怕的代码来处理特殊情况，例如“昨天”、“上周”和“上个月末”之间的差异，所有这些都可以（在某些情况下）指同一天，但单独正确基于今天的日期。

我确信一定有一个开源的模糊日期格式化程序，但我找不到它。理想情况下，我想要使用 NSDate (OSX/iPhone) 及其格式化程序的东西，但这并不难。有谁知道模糊日期格式化程序采用相对于现在的任何时间段并返回一个字符串，例如（但不限于）：

*   几分钟前
*   在最后五分钟
*   今天早些时候
*   今天早上
*   昨晚
*   上个星期
*   上周三
*   上月初
*   去年六月
*   几年前

在一个理想的世界中，我希望字符串尽可能丰富（即返回“Just a moment ago”的随机变体，例如“just now”）。

澄清。我正在寻找比基本的buckts和string更微妙的东西。我想要知道“昨天”和“上周三”都可以指同一时期但今天是星期四时只有一个是正确的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-08-22T05:06:47.567

NSDateFormatter 中有一个属性-“doesRelativeDateFormatting”。它仅出现在 10.6/iOS4.0 及更高版本中，但它会将日期格式化为正确区域设置中的相对日期。

来自[Apple 的文档](http://developer.apple.com/mac/library/documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/doc/uid/20000447-SW50)：

> 如果日期格式化程序使用相对日期格式化，它会在可能的情况下用表示相对日期的短语（例如“今天”或“明天”）替换其输出的日期部分。可用的短语取决于日期格式化程序的语言环境；而对于未来的日期，英语可能只允许“明天”，法语可能允许“后天后天”，如下例所示。

## 代码

以下代码将打印出给定语言环境的大量相关字符串。

```
NSLocale *locale = [NSLocale currentLocale];
//    NSLocale *locale = [[[NSLocale alloc] initWithLocaleIdentifier:@"fr_FR"] autorelease];

NSDateFormatter *relativeDateFormatter = [[NSDateFormatter alloc] init];
[relativeDateFormatter setTimeStyle:NSDateFormatterNoStyle];
[relativeDateFormatter setDateStyle:NSDateFormatterMediumStyle];
[relativeDateFormatter setDoesRelativeDateFormatting:YES];
[relativeDateFormatter setLocale:locale];

NSDateFormatter *normalDateFormatter = [[NSDateFormatter alloc] init];
[normalDateFormatter setTimeStyle:NSDateFormatterNoStyle];
[normalDateFormatter setDateStyle:NSDateFormatterMediumStyle];
[normalDateFormatter setDoesRelativeDateFormatting:NO];
[normalDateFormatter setLocale:locale];

NSString * lastUniqueString = nil;

for ( NSTimeInterval timeInterval = -60*60*24*400; timeInterval < 60*60*24*400; timeInterval += 60.0*60.0*24.0 )
{
    NSDate * date = [NSDate dateWithTimeIntervalSinceNow:timeInterval];

    NSString * relativeFormattedString = [relativeDateFormatter stringForObjectValue:date];
    NSString * formattedString = [normalDateFormatter stringForObjectValue:date];

    if ( [relativeFormattedString isEqualToString:lastUniqueString] || [relativeFormattedString isEqualToString:formattedString] )
        continue;

    NSLog( @"%@", relativeFormattedString );
    lastUniqueString = relativeFormattedString;
} 
```

笔记：

*   不需要语言环境
*   英语的替代品并不多。在撰写本文时，有：“昨天，今天，明天”。苹果未来可能会包括更多。
*   更改语言环境并查看其他语言的可用内容很有趣（例如，法语比英语多一些）
*   如果在 iOS 上，您可能需要订阅[UIApplicationSignificantTimeChangeNotification](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/c/data/UIApplicationSignificantTimeChangeNotification)

## 界面生成器

您可以在 Interface Builder 中设置“doesRelativeDateFormatting”属性：

*   选择您的 NSDateFormatter 并选择 Inspector Palette 的“Identity Inspector”选项卡（最后一个 [command-6]）。
*   在名为“用户定义的运行时属性”的小节下，您可以为所选对象（在本例中为您的 NSDateFormatter 实例）上的键添加自己的值。添加“doesRelativeDateFormatting”，选择“Boolean”类型，并确保已选中。
*   **请记住**：它可能看起来根本不起作用，但这可能是因为您的语言环境只有几个替代值。在确定是否设置不正确之前，请至少尝试选择昨天、今天和明天的日期。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-04T21:24:18.410

[这个问题应该让你开始。](https://stackoverflow.com/questions/11/how-do-i-calculate-relative-time)它有这个网站用来计算其相对时间的代码。它可能没有您想要的特定范围，但是一旦设置好它们就很容易添加。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-04T21:35:15.607

您可能想查看我在下面粘贴的[date_helper.rb](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#M001663)`distance_of_time_in_words`中的 Rail函数。

```
# File vendor/rails/actionpack/lib/action_view/helpers/date_helper.rb, line 59
def distance_of_time_in_words(from_time, to_time = 0, include_seconds = false, options = {})
 from_time = from_time.to_time if from_time.respond_to?(:to_time)
 to_time = to_time.to_time if to_time.respond_to?(:to_time)
 distance_in_minutes = (((to_time - from_time).abs)/60).round
 distance_in_seconds = ((to_time - from_time).abs).round

 I18n.with_options :locale => options[:locale], :scope => 'datetime.distance_in_words''datetime.distance_in_words' do |locale|
   case distance_in_minutes
     when 0..1
       return distance_in_minutes == 0 ?
              locale.t(:less_than_x_minutes, :count => 1) :
              locale.t(:x_minutes, :count => distance_in_minutes) unless include_seconds

       case distance_in_seconds
         when 0..4   then locale.t :less_than_x_seconds, :count => 5
         when 5..9   then locale.t :less_than_x_seconds, :count => 10
         when 10..19 then locale.t :less_than_x_seconds, :count => 20
         when 20..39 then locale.t :half_a_minute
         when 40..59 then locale.t :less_than_x_minutes, :count => 1
         else             locale.t :x_minutes,           :count => 1
       end

     when 2..44           then locale.t :x_minutes,      :count => distance_in_minutes
     when 45..89          then locale.t :about_x_hours,  :count => 1
     when 90..1439        then locale.t :about_x_hours,  :count => (distance_in_minutes.to_f / 60.0).round
     when 1440..2879      then locale.t :x_days,         :count => 1
     when 2880..43199     then locale.t :x_days,         :count => (distance_in_minutes / 1440).round
     when 43200..86399    then locale.t :about_x_months, :count => 1
     when 86400..525599   then locale.t :x_months,       :count => (distance_in_minutes / 43200).round
     when 525600..1051199 then locale.t :about_x_years,  :count => 1
     else                      locale.t :over_x_years,   :count => (distance_in_minutes / 525600).round
   end
 end
end 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-06-29T15:37:18.677

所以，这是我在 NSDate 上为那些仍然感兴趣的人写的类别。问题是其中一个变得有点不切实际的问题。它基本上是一个巨大的 switch 语句（尽管我在一系列级联 if() 中实现了它以使其更具可读性。

然后，对于每个时间段，我从一组随机的时间告诉方式中进行选择。

总而言之，这让我们的一些用户感到高兴，但我不确定这是否值得。

```
NSTimeInterval const kTenSeconds = (10.0f );
NSTimeInterval const kOneMinute = (60.0f);
NSTimeInterval const kFiveMinutes = (5.0f*60.0f);
NSTimeInterval const kFifteenMinutes = (15.0f*60.0f) ;
NSTimeInterval const kHalfAnHour = (30.0f*60.0f) ;
NSTimeInterval const kOneHour = 3600.0f;    // (60.0f * 60.0f);
NSTimeInterval const kHalfADay = (3600.0f * 12.0f);
NSTimeInterval const kOneDay = (3600.0f * 24.0f);
NSTimeInterval const kOneWeek = (3600.0f * 24.0f * 7.0f);

@implementation NSDate (Fuzzy)

-(NSString*)fuzzyStringRelativeToNow;
{
    static NSArray* secondsStrings;
    static NSArray* minuteStrings;
    static NSArray* fiveMinuteStrings;
    static NSArray* halfHourStrings;
    static NSArray* earlyMonthStrings;

    NSTimeInterval timeFromNow = [self timeIntervalSinceNow];
    if((timeFromNow < 0))       // In the past
    {
        timeFromNow = - timeFromNow;

        if ( (timeFromNow <  kTenSeconds))
        {
            if(!secondsStrings)
            {   
                secondsStrings = [[NSArray arrayWithObjects:@"just now",
                                                            //@"a few seconds ago",
                                                            //@"right this instant",
                                                            @"moments ago",
                                                            nil] retain];
            }

            unsigned int index = random() % ([secondsStrings count] - 1);
            return [secondsStrings objectAtIndex:index];
        }

        if ( (timeFromNow < kOneMinute))
        {
            if(!minuteStrings)
            {

                minuteStrings = [[NSArray arrayWithObjects:@"just now",
                                  @"very recently",
                                  @"in the last minute",
                                  nil] retain];
            }

            unsigned int index = random() % ([minuteStrings count] - 1);
            return [minuteStrings objectAtIndex:index];
        }

        if (timeFromNow < kFiveMinutes)
        {
            if(!fiveMinuteStrings)
            {
                fiveMinuteStrings = [[NSArray arrayWithObjects:@"just now",
                                      @"very recently",
                                      //@"in the last minute",
                                      @"a few minutes ago",
                                      //@"in the last five minutes",
                                      nil] retain];
            }
            unsigned int index = random() % ([fiveMinuteStrings count] - 1);
            return [fiveMinuteStrings objectAtIndex:index];
        }

        if (timeFromNow < kFifteenMinutes)
        {
            return @"in the last 15 minutes";
        }

        if (timeFromNow < kHalfAnHour)
        {
            if(!halfHourStrings)
            {
                halfHourStrings = [[NSArray arrayWithObjects:@"in the last half hour",
                                                            //@"in the last half an hour",
                                                            @"in the last 30 minutes",
                                                            //@"about half an hour ago",
                                                            @"fairly recently",
                                                            nil] retain];
            }
            unsigned int index = random() % ([halfHourStrings count] - 1);
            return [halfHourStrings objectAtIndex:index];
        }

        if (timeFromNow < kOneHour)
        {
            return @"in the last hour";
        }

        if ((timeFromNow < (kOneHour + kFiveMinutes)) && (timeFromNow > (kOneHour - kFiveMinutes)))
        {
            return @"about an hour ago";
        }

        if((timeFromNow < ((kOneHour*2.0f) + kFiveMinutes ))&& (timeFromNow > ((kOneHour*2.0f) - kFiveMinutes)))
        {
            return @"a couple of hours ago";
        }

        // Now we're over an hour, we need to calculate a few specific dates to compare against

        NSDate *today = [NSDate date];

        NSCalendar *gregorian = [[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] autorelease];

        NSUInteger unitFlags = NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit;
        NSDateComponents* todayComponents = [gregorian components:unitFlags fromDate:today];

        todayComponents.hour = 12;

        NSDate* noonToday = [gregorian dateFromComponents:todayComponents];

        NSTimeInterval timeSinceNoonToday = [self timeIntervalSinceDate:noonToday];

        if (timeSinceNoonToday > 0)                         // sometime since noon
        {
            if (timeSinceNoonToday > kOneHour * 9)          // i.e. after 9pm today
                return @"earlier tonight";
            if (timeSinceNoonToday > kOneHour * 7)          // i.e. after 7pm today
                return @"earlier this evening";
            if (timeSinceNoonToday < kOneHour * 1)          // between noon and 1pm
                return @"early this afternoon";

            return @"this afternoon";
        }

        NSTimeInterval timeSinceMidnight = kHalfADay -timeSinceNoonToday;   // Note sign is reversed.   

        if ((timeSinceNoonToday < 0) & (timeSinceNoonToday > -kHalfADay))       // between midnight and noon today
        {
            if (timeSinceMidnight < kFiveMinutes)
                return @"around midnight";
            if (timeSinceMidnight < kOneHour * 2)           // up to 2am
                return @"very early this morning";
            if (timeSinceMidnight < kOneHour * 5)           // up to 5am
                return @"early this morning";
            else if (timeSinceMidnight < kOneHour * 11)
                return @"late this morning";
            else
                return @"this morning";
        }

        // NSTimeInterval timeSinceNoonYesterday = timeSinceNoonToday - kOneDay;

        // timeSinceMidnight = -timeSinceMidnight;

        if (timeSinceMidnight < kOneHour * 24)      // not the day before...
        {

            if (timeSinceMidnight < kFiveMinutes)
                return @"around midnight";
            if (timeSinceMidnight < kFifteenMinutes)
                return @"just before midnight";
            if (timeSinceMidnight < kOneHour * 2)           // after 10pm
                return @"late last night";
            if (timeSinceMidnight < kOneHour * 5)           // After 7
                return @"yesterday evening";
            else if (timeSinceMidnight < kOneHour * 7)
                return @"yesterday evening";                // after 5pm
            else if (timeSinceMidnight < kOneHour * 7)
                return @"yesterday evening";                // after 5pm
            else if (timeSinceMidnight < kOneHour * 10)
                return @"yesterday afternoon";              // after 5pm
            else if (timeSinceMidnight < kOneHour * 12)
                return @"early yesterday afternoon";        // before 1pm
            else if (timeSinceMidnight < kOneHour * 13)
                return @"late yesterday morning";           // after 11m
            else if (timeSinceMidnight < kOneHour * 17)
                return @"yesterday morning";                
            else 
                return @"early yesterday morning";
        }

        NSDateFormatter* formatter = [[[NSDateFormatter alloc] init] autorelease];

        int integerSeconds = timeSinceMidnight;
        int integerDay = kOneDay;
        int secondsIntoDay = integerSeconds % integerDay;
        NSString* formatString = @"last %@";

        if (timeFromNow < kOneWeek)
        {
            if (secondsIntoDay < kFifteenMinutes)
                formatString = @"around midnight on %@";
            //else if (secondsIntoDay < kFifteenMinutes)
            //  formatString = @"just before midnight on %@";
            else if (secondsIntoDay < kOneHour * 2)         // after 10pm
                formatString = @"late on %@ night";
            else if (secondsIntoDay < kOneHour * 5)         // After 7
                formatString = @"on %@ evening";
            else if (secondsIntoDay < kOneHour * 10)
                formatString = @"on %@ afternoon";              // after 5pm
            else if (secondsIntoDay < kOneHour * 12)
                formatString = @"early on %@ afternoon";        // before 1pm
            else if (secondsIntoDay < kOneHour * 13)
                formatString = @"late on %@ morning";           // after 11am
            else if (secondsIntoDay < kOneHour * 17)
                formatString = @"on %@ morning";                
            else if (secondsIntoDay < kOneHour * 24)        // not the day before...
                formatString = @"early on %@ morning";

            [formatter setDateFormat:@"EEEE"];  /// EEEE is long format of day of the week see: http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns
            return [NSString stringWithFormat:formatString, [formatter stringFromDate: self]]; 
        }

        //formatString = @"on %@ the week before last";
        /*if (secondsIntoDay < kOneHour * 2)            // after 10pm
            formatString = @"early on %@ the week before last";
        else if (timeSinceMidnight > kOneHour * 13)
            formatString = @"late on %@ the week before last";          // after 11m*/

        //if (timeFromNow < kOneWeek * 2)
        //{
        //  [formatter setDateFormat:@"EEE"];           /// EEE is short format of day of the week see: http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns
        //  return [NSString stringWithFormat:formatString, [formatter stringFromDate: self]]; 
        //}

        if (timeFromNow < kOneWeek * 2)
            {
            return @"the week before last";
            }

        NSDateComponents* myComponents = [gregorian components:unitFlags fromDate:self];

        int monthsAgo = myComponents.month - todayComponents.month;

        int yearsAgo = myComponents.year - todayComponents.year;
        if (yearsAgo == 0)
        {
            if (monthsAgo == 0)
            {
                if(myComponents.day > 22)
                    return @"late this month";
                if(myComponents.day < 7)
                {

                    if(!earlyMonthStrings)
                    {   
                        earlyMonthStrings = [[NSArray arrayWithObjects:@"earlier this month",
                                                                       //@"at the beginning of the month",
                                                                       @"early this month",
                                                                       nil] retain];
                    }

                    unsigned int index = random() % ([earlyMonthStrings count] - 1);
                    return [earlyMonthStrings objectAtIndex:index];
                }
                return @"earlier this month";
            }

            if (monthsAgo == 1)
            {
                if(myComponents.day > 22)
                    return @"late last month";
                if(myComponents.day < 7)
                    return @"early last month";
                return @"last month";
            }

            formatString  = @"in %@ this year";
            /*if(myComponents.day > 22)
                formatString  = @"late in %@ this year";
            if(myComponents.day < 7)
                formatString  = @"early in %@ this year";*/

            [formatter setDateFormat:@"MMMM"];          /// MMM is longformat of month see: http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns
            return [NSString stringWithFormat:formatString, [formatter stringFromDate: self]];  
        }

        if (yearsAgo == 1)
        {
            formatString  = @"in %@ last year";
            /*if(myComponents.day > 22)
                formatString  = @"late in %@ last year";
            if(myComponents.day < 7)
                formatString  = @"late in %@ last year";*/

            [formatter setDateFormat:@"MMM"];           /// MMM is longformat of month see: http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns
            return [NSString stringWithFormat:formatString, [formatter stringFromDate: self]];  
        }

        // int daysAgo = integerSeconds / integerDay;

    // Nothing yet...
        [formatter setDateStyle:kCFDateFormatterMediumStyle];
        //[formatter setTimeStyle:kCFDateFormatterShortStyle];

        return [NSString stringWithFormat:@"on %@",[formatter stringFromDate: self]];

    }
    else
    if(timeFromNow > 0) // The future
    {
        AICLog(kErrorLogEntry, @"FuzzyDates: Time marked as in the future: referenced date is %@, local time is %@", self, [NSDate date]);
        return @"moments ago";

    }
    else
        return @"right now";    // this seems unlikely.

    return [self description];  // should never get here.
} 
```

抱歉这么久才发这个。。。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-09-05T03:35:10.847

这是基于 Pretty and Humane 日期和时间线程中的代码。我添加了对“上周一下午 5 点”的处理，因为我在 x 天前更喜欢它。这可以处理长达几个世纪的过去和未来。我热衷于国际化方面，所以这最终需要做更多的工作。计算采用当地时区。

```
public static class DateTimePretty
{
    private const int SECOND = 1;
    private const int MINUTE = 60 * SECOND;
    private const int HOUR = 60 * MINUTE;
    private const int DAY = 24 * HOUR;
    private const int WEEK = 7 * DAY;
    private const int MONTH = 30 * DAY;

    private const int YEAR = 365;

    const string now = "just now";
    const string secondsFuture = "in {0} seconds", secondsPast = "{0} seconds ago";
    const string minuteFuture = "in about a minute", minutePast = "about a minute ago";
    const string minutesFuture = "in about {0} minutes", minutesPast = "about {0} minutes ago";
    const string hourFuture = "in about an hour", hourPast = "about an hour ago";
    const string hoursFuture = "in about {0} hours", hoursPast = "about {0} hours ago";
    const string tomorrow = "tomorrow, {0}", yesterday = "yesterday, {0}";
    const string nextDay = "{0}", nextWeekDay = "next {0}", lastDay = "last {0}";
    //const string daysFuture = "in about {0} days", daysPast = "about {0} days ago";
    const string weekFuture = "in about a week", weekPast = "about a week ago";
    const string weeksFuture = "in about {0} weeks", weeksPast = "about {0} weeks ago";
    const string monthFuture = "in about a month", monthPast = "about a month ago";
    const string monthsFuture = "in about {0} months", monthsPast = "about {0} months ago";
    const string yearFuture = "in about a year", yearPast = "about a year ago";
    const string yearsFuture = "in about {0} years", yearsPast = "about {0} years ago";
    const string centuryFuture = "in about a century", centuryPast = "about a century ago";
    const string centuriesFuture = "in about {0} centuries", centuriesPast = "about {0} centuries ago";

    /// <summary>
    /// Returns a pretty version of the provided DateTime: "42 years ago", or "in 9 months".
    /// </summary>
    /// <param name="dateTime">DateTime in local time format, not Utc</param>
    /// <returns>A pretty string</returns>
    public static string GetPrettyDate(DateTime dateTime)
    {
        DateTime dateTimeNow = DateTime.Now;
        bool isFuture = (dateTimeNow.Ticks < dateTime.Ticks);
        var ts = isFuture ? new TimeSpan(dateTime.Ticks - dateTimeNow.Ticks) : new TimeSpan(dateTimeNow.Ticks - dateTime.Ticks);

        double delta = ts.TotalSeconds;

        if (delta < 10)
            return now;
        if (delta < 1 * MINUTE)
            return isFuture ? string.Format(secondsFuture, ts.Seconds) : string.Format(secondsPast, ts.Seconds);
        if (delta < 2 * MINUTE)
            return isFuture ? minuteFuture : minutePast;
        if (delta < 45 * MINUTE)
            return isFuture ? string.Format(minutesFuture, ts.Minutes) : string.Format(minutesPast, ts.Minutes);
        if (delta < 2 * HOUR)
            return isFuture ? hourFuture : hourPast;
        if (delta < 7 * DAY)
        {
            string shortTime = DateTimeFormatInfo.CurrentInfo.ShortTimePattern;
            string shortWeekdayTime = "dddd, " + shortTime;
            int dtDay = (int) dateTime.DayOfWeek;
            int nowDay = (int) dateTimeNow.DayOfWeek;
            if (isFuture)
            {
                if (dtDay == nowDay)
                {
                    if (delta < DAY)
                        return string.Format(hoursFuture, ts.Hours);
                    else
                        return string.Format(nextWeekDay, dateTime.ToString(shortWeekdayTime));
                }
                else if (dtDay - nowDay == 1 || dtDay - nowDay == -6)
                    return string.Format(tomorrow, dateTime.ToString(shortTime));
                else
                    return string.Format(nextDay, dateTime.ToString(shortWeekdayTime));
            }
            else
            {
                if (dtDay == nowDay)
                {
                    if (delta < DAY)
                        return string.Format(hoursPast, ts.Hours);
                    else
                        return string.Format(lastDay, dateTime.ToString(shortWeekdayTime));
                }
                else if (nowDay - dtDay == 1 || nowDay - dtDay == -6)
                    return string.Format(yesterday, dateTime.ToString(shortTime));
                else
                    return string.Format(lastDay, dateTime.ToString(shortWeekdayTime));
            }
        }
        //if (delta < 7 * DAY)
        //    return isFuture ? string.Format(daysFuture, ts.Days) : string.Format(daysPast, ts.Days);
        if (delta < 4 * WEEK)
        {
            int weeks = Convert.ToInt32(Math.Floor((double) ts.Days / 30));
            if (weeks <= 1)
                return isFuture ? weekFuture : weekPast;
            else
                return isFuture ? string.Format(weeksFuture, weeks) : string.Format(weeksPast, weeks);
        }
        if (delta < 12 * MONTH)
        {
            int months = Convert.ToInt32(Math.Floor((double) ts.Days / 30));
            if (months <= 1)
                return isFuture ? monthFuture : monthPast;
            else
                return isFuture ? string.Format(monthsFuture, months) : string.Format(monthsPast, months);
        }

        // Switch to days to avoid overflow
        delta = ts.TotalDays;
        if (delta < 100 * YEAR)
        {
            int years = Convert.ToInt32(Math.Floor((double) ts.TotalDays / 365.25));
            if (years <= 1)
                return isFuture ? yearFuture : yearPast;
            else
                return isFuture ? string.Format(yearsFuture, years) : string.Format(yearsPast, years);
        }
        else
        {
            int centuries = Convert.ToInt32(Math.Floor((double) ts.TotalDays / 365.2425));
            if (centuries <= 1)
                return isFuture ? centuryFuture : centuryPast;
            else
                return isFuture ? string.Format(centuriesFuture, centuries) : string.Format(centuriesPast, centuries);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-04T21:31:03.167

我不知道你为什么说这将是一种可怕的编码实践。每个返回字符串实际上都是父集的一个子集，因此您可以非常优雅地在 if/elseif 链中执行此操作。

```
if timestamp < 5sec
    "A moment ago"
elseif timestamp < 5min 
    "Few minutes ago"
elseif timestamp < 12hr && timestamp < noon
    "Today Morning"
...
elseif timestamp < 1week 
    "Few days ago"
elseif timestamp < 1month
    "Few weeks ago"
elseif timestamp < 6month
    "Few Months ago" 
...
else
    "Really really long time ago" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T21:26:23.910

根据我的经验，这些类型的日期生成器根本不是“模糊的”。事实上，它们只是一堆基于时间段的 if 语句。例如，任何小于 30 秒的时间是“片刻前”，360 到 390 天是“一年前”等。其中一些将使用目标日期来计算特殊名称（六月、星期三等）。很抱歉打破了你的幻想。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-04T21:34:30.973

不用说（但我还是会说）不要使用每年减少 365 天的 where 循环，即使在 366 天闰年（否则你会发现自己处于 Zune 开发人员的行列）

这是 ac# 版本：

[http://tiredblogger.wordpress.com/2008/08/21/creating-twitter-esque-relative-dates-in-c/](http://tiredblogger.wordpress.com/2008/08/21/creating-twitter-esque-relative-dates-in-c/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-04T22:37:06.970

我知道这样的表达时间最近变得非常流行，但请考虑将其作为切换相对“模糊”日期和正常绝对日期的选项。

例如，知道一条评论是在 5 分钟前发表的很有用，但告诉我评论 A 是 4 小时前，评论 B 是 9 小时前，当时是上午 11 点，我宁愿知道评论 A 是今天早上有人醒来时写的，评论 B 是有人熬夜写的（假设我知道他们在我的时区）。

- 编辑：仔细观察您的问题，您似乎通过引用一天中的时间而不是“X 前”在某种程度上避免了这种情况，但另一方面，如果用户处于不同的时间，您可能会给人一种错误的印象区域，因为您的“今天早上”可能是相关用户的半夜。

根据其他用户的时区，用一天中的相对时间来增加时间可能很酷，但这假设用户愿意提供它并且它是正确的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-09T10:40:10.340

我对另一个问题的解决方案不满意。所以我自己使用日期时间类。海事组织，它的清洁剂。在我的测试中，它像我想要的那样工作。希望这可以帮助某人。

```
DateTime now = DateTime.Now;

long nowticks = now.Ticks;
long thenticks = dt.Ticks;

long diff = nowticks - thenticks;

DateTime n = new DateTime(diff);

if (n.Year > 1)
{
    return n.Year.ToString() + " years ago";
}
else if (n.Month > 1)
{
    return n.Month.ToString() + " months ago";
}
else if (n.Day > 1)
{
    return n.Day.ToString() + " days ago";
}
else if (n.Hour > 1)
{
    return n.Hour.ToString() + " hours ago";
}
else if (n.Minute > 1)
{
    return n.Minute.ToString() + " minutes ago";
}
else
{
    return n.Second.ToString() + " seconds ago";
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-04T21:27:23.143

这几乎总是使用巨大的 switch 语句来完成，而且实现起来很简单。

请记住以下几点：

*   始终首先测试最小的时间跨度
*   不要忘记保持字符串可本地化。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-04T21:31:45.693

您可能会发现[timeago 的源代码](http://timeago.yarp.com/jquery.timeago.js)很有用。该插件的描述是“一个 jQuery 插件，可以轻松支持自动更新模糊时间戳（例如“4 分钟前”或“大约 1 天前”）。

它本质上是 Rail`distance_of_time_in_words`函数的 JavaScript 端口，塞进了一个 jQuery 插件。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-04T22:13:04.720

我的公司有[这个 .NET 库](http://precisionsoftware.blogspot.com/2009/03/natural-language-net-date-parser.html)，它可以做一些你想做的事情，因为它可以进行非常灵活的日期时间解析（包括一些相对格式），但它只做非相对输出。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-05-12T05:44:09.673

查看 Chrono 以获取 Javascript 启发式日期解析器。

Chrono 支持大多数日期和时间格式，例如：

```
Today, Tomorrow, Yesterday, Last Friday, etc
17 August 2013 - 19 August 2013
This Friday from 13:00 - 16.00
5 days ago
Sat Aug 17 2013 18:40:39 GMT+0900 (JST)
2014-11-30T08:15:30-05:30 
```

[https://github.com/wanait/chrono](https://github.com/wanasit/chrono)

# latex - 在 multicols 环境中关闭 marginpar (marginparwidth)

> ID：822126
> 
> 赞同：3
> 
> 时间：2009-05-04T21:22:07.150
> 
> 标签：latex

当我开始一个新的 multicols 环境时，我试图关闭 marginpar：

```
\renewenvironment{multicols}[1]{%
  \let\oldmarginparwidth\marginparwidth
  \setlength{\marginparwidth}{0}%
  \begin{multicols}{#1}
}{%
  \end{多列}%
  \setlength{\marginparwidth}{\oldmarginparwidth}%
}

```

但是，它不起作用。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T00:17:15.617

你在那里的命令在页面中间不起作用，你需要使用 changepage 包来做到这一点。

```
\usepackage{changepage} 
```

我认为您正在尝试占据页面的整个宽度。我从 tufte-latex 类中删除了这个：

首先，定义一个“悬垂”量，它将在开始时添加到 textwidth 并在结束时减去：

```
\newlength{\overhang}
\setlength{\overhang}{\marginparwidth}
\addtolength{\overhang}{\marginparsep} 
```

然后在要删除 marginpar 空间时使用 \adjustwidth 和悬垂量：

```
\begin{adjustwidth}{}{-\overhang}
% This will be displayed full-width
\end{adjustwidth}{}{-\overhang} 
```

正如 Damien 指出的那样，您仍然可以像这样使用 marginpars，它们只会超过页面宽度。\multicols 会阻止你使用浮点数，但是。

希望这就是你所需要的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T02:25:33.613

我不确定你在这里寻找什么，但通常在 multicols 中已经不允许使用 marginpars 了。从多列文档：

> ...当前实现中不允许使用浮点数和边距 [这是由于时间不足。要实现浮点数，必须重新实现整个 LATEX 输出例程。]。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T11:52:53.507

我已经设法通过使用 chngpage 包并定义一个新环境来使其工作，该环境在该环境之前/之后设置/重置不同的值。

但是，我在每个\chapter的最后一页仍然有一个问题：章节[最后一页的标题宽度](https://stackoverflow.com/questions/829212/latex-header-width-on-the-last-page-of-the-chapter)

# java - 在 Java 中修改 .txt 文件

> ID：822150
> 
> 赞同：30
> 
> 时间：2009-05-04T21:29:21.360
> 
> 标签：java

我有一个要使用 Java 编辑的文本文件。它有数千行。我基本上想遍历这些行并更改/编辑/删除一些文本。这需要经常发生。

从我在其他网站上看到的解决方案来看，一般的方法似乎是：

*   使用 BufferedReader 打开现有文件
*   读取每一行，对每一行进行修改，并将其添加到 StringBuilder
*   读取和修改所有文本后，将 StringBuilder 的内容写入新文件
*   用新文件替换旧文件

这个解决方案对我来说似乎有点“hacky”，特别是如果我的文本文件中有数千行。

有人知道更好的解决方案吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-04T21:33:13.503

我最近没有在 Java 中这样做过，但是将整个文件写入内存似乎是个坏主意。

我能想到的最好的主意是同时以写入模式打开一个临时文件，并为每一行读取它，如有必要进行修改，然后写入临时文件。最后，删除原始文件并重命名临时文件。

如果您对文件系统具有修改权限，则您可能还具有删除和重命名权限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T06:28:41.267

如果文件只有几千行，您应该能够一次读取整个文件并将其转换为字符串。

您可以使用具有如下方法的 apache IOUtils。

```
public static String readFile(String filename) throws IOException {
    File file = new File(filename);
    int len = (int) file.length();
    byte[] bytes = new byte[len];
    FileInputStream fis = null;
    try {
        fis = new FileInputStream(file);
        assert len == fis.read(bytes);
    } catch (IOException e) {
        close(fis);
        throw e;
    }
    return new String(bytes, "UTF-8");
}

public static void writeFile(String filename, String text) throws IOException {
    FileOutputStream fos = null;
    try {
        fos = new FileOutputStream(filename);
        fos.write(text.getBytes("UTF-8"));
    } catch (IOException e) {
        close(fos);
        throw e;
    }
}

public static void close(Closeable closeable) {
    try {
        closeable.close();
    } catch(IOException ignored) {
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-28T02:38:25.873

您可以在 Java 中使用 RandomAccessFile 在一个条件下修改文件：必须固定每行的大小，否则，当写回新字符串时，它可能会覆盖下一行中的字符串。

因此，在我的示例中，我将行长设置为 100，并在创建文件并写回文件时使用空格字符串填充。

因此，为了允许更新，您需要将行的长度设置为略大于该文件中行的最长长度。

```
public class RandomAccessFileUtil {
public static final long RECORD_LENGTH = 100;
public static final String EMPTY_STRING = " ";
public static final String CRLF = "\n";

public static final String PATHNAME = "/home/mjiang/JM/mahtew.txt";

/**
 *  one two three
    Text to be appended with
    five six seven
    eight nine ten
 * 
 * 
 * @param args
 * @throws IOException
 */
public static void main(String[] args) throws IOException
{
    String starPrefix = "Text to be appended with";
    String replacedString = "new text has been appended";

    RandomAccessFile file = new RandomAccessFile(new File(PATHNAME), "rw");

    String line = "";
    while((line = file.readLine()) != null)
    {
        if(line.startsWith(starPrefix))
        {
            file.seek(file.getFilePointer() - RECORD_LENGTH - 1);
            file.writeBytes(replacedString);
        }

    }
}

public static void createFile() throws IOException
{
    RandomAccessFile file = new RandomAccessFile(new File(PATHNAME), "rw");

    String line1 = "one two three";
    String line2 = "Text to be appended with";
    String line3 = "five six seven";
    String line4 = "eight nine ten";

    file.writeBytes(paddingRight(line1));
    file.writeBytes(CRLF);
    file.writeBytes(paddingRight(line2));
    file.writeBytes(CRLF);
    file.writeBytes(paddingRight(line3));
    file.writeBytes(CRLF);
    file.writeBytes(paddingRight(line4));
    file.writeBytes(CRLF);

    file.close();

    System.out.println(String.format("File is created in [%s]", PATHNAME));
}

public static String paddingRight(String source)
{
    StringBuilder result = new StringBuilder(100);
    if(source != null)
    {
        result.append(source);
        for (int i = 0; i < RECORD_LENGTH - source.length(); i++)
        {
            result.append(EMPTY_STRING);
        }
    }

    return result.toString();
} 
```

}

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T21:34:04.923

如果文件很大，您可能希望使用 FileStream 进行输出，但这似乎是执行您所要求的最简单的过程（并且没有更具体的内容，即您的更改/编辑/删除类型'正在尝试做，不可能确定更复杂的方法可能有效）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T21:38:28.500

没有理由缓冲整个文件。

只需在阅读时写下每一行，必要时插入行，必要时删除行，必要时替换行。

从根本上说，您不必重新创建文件批发，特别是如果它只是一个文本文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T23:05:04.890

它是什么样的数据？你控制文件的格式吗？

如果文件包含名称/值对（或类似的），您可能会使用[Properties](http://java.sun.com/j2se/1.3/docs/api/java/util/Properties.html)运气好，或者可能使用平面文件 JDBC 驱动程序拼凑一些东西。

或者，您是否考虑过不经常写入数据？对文件的内存副本进行操作应该相对简单。如果没有需要实时更新文件的外部资源，则无需每次修改时都去磁盘。如果您担心数据备份，可以运行计划任务将定期更新写入磁盘。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T21:34:28.620

通常，您无法就地编辑文件；它只是一个很长的字符序列，恰好包括换行符。如果您的更改不会更改每行中的字符数，您可以就地编辑。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-10T11:58:41.900

如果您知道要更改的内容，就不能使用正则表达式吗？[Jakarta Regexp](http://jakarta.apache.org/regexp/index.html)应该可以解决问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-10T22:13:34.287

我认为，`FileOutputStream.getFileChannel()`会有很大帮助，请参阅 FileChannel api [http://java.sun.com/javase/6/docs/api/java/nio/channels/FileChannel.html](http://java.sun.com/javase/6/docs/api/java/nio/channels/FileChannel.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-04T11:19:59.800

虽然这个问题是前一段时间发布的，但我认为将我的答案放在这里很好。我认为最好的方法是在这种情况下使用`FileChannel`from `java.nio.channels`package 。**但这，只有当你需要有一个好的表现！**您需要`FileChannel`通过 a获得 a `RandomAccessFile`，如下所示：

```
java.nio.channels.FileChannel channel = new java.io.RandomAccessFile("/my/fyle/path", "rw").getChannel();
```

在此之后，您需要创建一个`ByteBuffer`您将从`FileChannel`.

这看起来像这样：

```
 java.nio.ByteBuffer inBuffer = java.nio.ByteBuffer.allocate(100);
int pos = 0;
int aux = 0;
StringBuilder sb = new StringBuilder();

while (pos != -1) {

    aux = channel.read(inBuffer, pos);
    pos = (aux != -1) ? pos + aux : -1;

    b = inBuffer.array();
    sb.delete(0, sb.length());

    for (int i = 0; i < b.length; ++i) {

         sb.append((char)b[i]);

    }

    //here you can do your stuff on sb

    inBuffer = ByteBuffer.allocate(100);

} 
```

希望我的回答对你有帮助！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-25T14:32:15.730

```
private static void modifyFile(String filePath, String oldString, String newString) {
    File fileToBeModified = new File(filePath);
    StringBuilder oldContent = new StringBuilder();
    try (BufferedReader reader = new BufferedReader(new FileReader(fileToBeModified))) {
        String line = reader.readLine();
        while (line != null) {
            oldContent.append(line).append(System.lineSeparator());
            line = reader.readLine();
        }
        String content = oldContent.toString();
        String newContent = content.replaceAll(oldString, newString);
        try (FileWriter writer = new FileWriter(fileToBeModified)) {
            writer.write(newContent);
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-05-11T10:11:32.797

您可以通过单击“另存为”并保存 *.java 扩展名来将 txt 文件更改为 java。

# c# - 有没有比 String.Replace 更好的方法从字符串中删除退格？

> ID：822155
> 
> 赞同：11
> 
> 时间：2009-05-04T21:31:09.280
> 
> 标签：c#, string

我从另一个来源（例如“\b\bfoo\bx”）读取了一个字符串。在这种情况下，它将转换为单词“fox”，因为前 2 个 \b 被忽略，最后一个 'o' 被删除，然后被替换为 'x'。还有另一种情况是“patt\b\b\b\b\b\b\b\b\b\bfoo”应该被翻译成“foo”

我想出了一些使用 String.Replace 的东西，但它很复杂，我担心它不能正常工作，它还会创建很多我想避免的新字符串对象。

有任何想法吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-04T21:47:21.600

可能最简单的方法是迭代整个字符串。鉴于您的输入，以下代码在 1-pass 中完成了技巧

```
public string ReplaceBackspace(string hasBackspace)
{
    if( string.IsNullOrEmpty(hasBackspace) )
        return hasBackspace;

    StringBuilder result = new StringBuilder(hasBackspace.Length);
    foreach (char c in hasBackspace)
    {
        if (c == '\b')
        {
            if (result.Length > 0)
                result.Length--;
        }
        else
        {
            result.Append(c);
        }
    }
    return result.ToString();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T21:41:44.030

我会这样做的方式是低技术的，但很容易理解。

创建一堆字符。然后从头到尾遍历字符串。如果字符是普通字符（非斜线），则将其压入堆栈。如果是斜线，并且下一个字符是 'b'，则弹出栈顶。如果堆栈为空，则忽略它。

最后，依次弹出每个字符，将其添加到 StringBuilder 中，并反转结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T22:16:48.627

正则表达式版本：

```
var data = @"patt\b\b\b\b\b\b\b\b\b\bfoo";
var regex = new Regex(@"(^|[^\\b])\\b");

while (regex.IsMatch(data))
{
    data = regex.Replace(data, "");
} 
```

* * *

优化版本（这个适用于退格 '\b' 而不是字符串 "\b"）：

```
var data = "patt\b\b\b\b\b\b\b\b\b\bfoo";
var regex = new Regex(@"[^\x08]\x08", RegexOptions.Compiled);

while (data.Contains('\b'))
{
    data = regex.Replace(data.TrimStart('\b'), "");
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T22:23:42.633

```
public static string ProcessBackspaces(string source)
{
    char[] buffer = new char[source.Length];
    int idx = 0;

    foreach (char c in source)
    {
        if (c != '\b')
        {
            buffer[idx] = c;
            idx++;
        }
        else if (idx > 0)
        {
            idx--;
        }
    }

    return new string(buffer, 0, idx);
} 
```

**编辑**

到目前为止，我已经对答案中发布的代码进行了快速、粗略的基准测试（处理问题中的两个示例字符串，每个字符串一百万次）：

```
 ANSWER                 | TIME (ms)
------------------------|-----------
 Luke (this one)        |       318
 Alexander Taran        |       567
 Robert Paulson         |       683
 Markus Nigbur          |      2100
 Kamarey (new version)  |      7075
 Kamarey (old version)  |     30902 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T21:39:09.123

您可以向后遍历字符串，随时创建一个字符数组。每次点击退格键时，增加一个计数器，每次点击普通字符时，如果您的计数器不为零，则跳过它并减少计数器。

我不确定最好的 C# 数据结构是什么来管理它，然后能够快速以正确的顺序获取字符串。 `StringBuilder`有一种`Insert`方法，但我不知道在开始时继续插入字符是否有效。您可以将字符放在堆栈中并`ToArray()`在最后击中 - 这可能会或可能不会更快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T21:55:27.490

```
String myString = "patt\b\b\b\b\b\b\b\b\b\bfoo";
      List<char> chars = myString.ToCharArray().ToList();
      int delCount = 0;

      for (int i = chars.Count -1; i >= 0; i--)
      {
        if (chars[i] == '\b')
        {
          delCount++;
          chars.RemoveAt(i);
        } else {
          if (delCount > 0 && chars[i] != null) {
            chars.RemoveAt(i);
            delCount--;
          }
        }
      } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T22:08:16.510

我会这样：代码未经测试

```
char[] result = new char[input.Length()];
int r =0;
for (i=0; i<input.Length(); i++){
if (input[i] == '\b'  && r>0) r--;
 else result[r]=input[i];

}

string resultsring = result.take(r); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-04T21:33:21.833

创建一个 StringBuilder 并复制除退格字符以外的所有内容。

# tfs - TFS Team Build 中的自定义构建摘要条目

> ID：822157
> 
> 赞同：1
> 
> 时间：2009-05-04T21:31:28.017
> 
> 标签：tfs, msbuild, tfsbuild

我已成功将自定义构建步骤添加到我的 TFS 团队构建脚本中，但是，在我的构建失败后（如我的自定义构建步骤所预期的那样），我想在“摘要”部分中向我的自定义失败报告添加一个 URL构建报告的顶部。
这是说...
“构建名称：”
“请求者：”
“团队项目：”
等的部分

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T05:17:06.947

使用当前版本的 Team Foundation Server 无法做到这一点。您可以在 TFS2008 中自定义的唯一事情是更改构建日志位置以指向一个 URL，该 URL 包含您感兴趣的信息以及指向实际构建日志的链接（如果有人想查看完整详细信息）。

有关更新日志位置的更多信息，请查看我的以下博客文章：

[http://www.woodwardweb.com/team/000415.html](http://www.woodwardweb.com/teamprise/000415.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T21:49:10.533

看起来这似乎是做不到的。请参阅这篇文章的第一部分进行确认。

[http://blogs.blackmarble.co.uk/blogs/rfennell/archive/2008/12/22/update-in-using-stylecop-in-tfs-team-build.aspx](http://blogs.blackmarble.co.uk/blogs/rfennell/archive/2008/12/22/update-in-using-stylecop-in-tfs-team-build.aspx)

您可以将其添加到 IBuildInformation 以编程方式访问（如果说，您有一个自定义仪表板来显示您的构建状态）。

瓦卡诺

# jquery - 使用 jQuery AJAX 通过 Web 服务从数据库中获取数据

> ID：822159
> 
> 赞同：1
> 
> 时间：2009-05-04T21:31:57.953
> 
> 标签：jquery, ajax, database, web-services

我试图通过使用 JQuery Ajax 调用 Web 服务例程从数据库中检索值。Web 服务例程设置正确并返回我需要的值，但是我对 jquery ajax 的工作方式感到困惑......我不知道如何检索该值

```
$.ajax({
        type: 'POST',
        url: 'myservices.asmx/getRowName',
        dataType: 'xml',
        data: ({ param1: someData, param2: someData }),
        success: function(data) {
            alert( data.getElementsByTagName("string")[0].firstChild.data );
        },
        error: function(msg) { alert(msg.statusText); }
    }); 
```

因此，成功后，我可以访问通过该函数返回的数据（我已经检查过并且它返回了正确的数据），但是如果我想在该函数之外使用数据怎么办？

是否`$.ajax`返回任何我可以检索我需要的数据的地方？如...

```
data = $.ajax({...all the settings...}); 
```

或者...

```
data = $.ajax({...settings...}).responseText; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T21:36:47.630

您建议您想要做的问题是 AJAX 是一个异步过程，并且试图将 AJAX 调用的结果分配给一个变量，这表明代码需要“挂”在那里直到结果回来。这不是 Javascript 的处理方式。大多数时候，我在成功回调本身中对我的数据做任何我需要做的事情。如果这还不够，那么实现它的方法是拥有一个接受数据作为参数的函数，并在完成后调用它。如果您来自其他语言，这对您来说可能看起来很奇怪，但在 Javascript 中，事情更多地基于事件（“当这种情况发生时执行此操作”），因此您必须相应地设置您的代码：

```
function doStuffWithData(data) {
    // do whatever you want here
}

$.ajax({
    type: 'POST',
    url: 'myservices.asmx/getRowName',
    dataType: 'xml',
    data: ({ param1: someData, param2: someData }),
    success: function(data) {
        doStuffWithData(data);
    },
    error: function(msg) { alert(msg.statusText); }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-03T10:27:38.627

请在 JQuery [http://codernd.com/DevelopersFile/Reading-XML-file-using-JQuery.aspx中找到一个更好的例子](http://codernd.com/DevelopersFile/Reading-XML-file-using-JQuery.aspx)

# python - 如何从作为二进制和其他形式内容容器的文件中分离内容

> ID：822161
> 
> 赞同：2
> 
> 时间：2009-05-04T21:32:00.513
> 
> 标签：python, text, encoding, file, binary

我正在尝试解析一些 .txt 文件。这些文件充当可变数量的“子”文件的容器，这些“子”文件在容器内用 SGML 标记进行设置或标识。使用 python，我可以轻松地分离子文件。但是，我无法将二进制内容作为二进制文件（比如 gif 或 jpg）写回。在最简单的情况下，容器可能有一个嵌入的 html 文件，后跟一个由 html 调用的图形。我假设我的问题是因为我正在使用 open(filename,'r') 读取原始 .txt 文件。但这似乎是找到 sgml 标签来分割文件的唯一选择。

我将不胜感激任何帮助以确定一些相关的阅读材料。

我很欣赏这些建议，但我仍在努力解决最基本的问题。例如，当我使用写字板打开文件并向下滚动到标记为 gif 的部分时，我会看到：

```
<FILENAME>h65803h6580301.gif
<DESCRIPTION>GRAPHIC
<TEXT>
begin 644 h65803h6580301.gif
M1TE&.#EA(P)I`=4@`("`@,#`P$!`0+^_OW]_?_#P\*"@H.#@X-#0T&!@8!`0
M$+"PL"`@('!P<)"0D#`P,%!04#\_/^_O[Y^?GZ^OK]_?WX^/C\_/SV]O;U]? 
```

我可以很容易地找到该部分，但是 gif 文件从哪里开始。标题是否以 644 开头，单词开头的空格或以 MITE 开头的行？

接下来，当文件被读入 python 时，它会对在读回时必须撤消的二进制代码做任何事情吗？

我可以找到图形开始的线条：

```
filerefbin=file('myfile.txt','rb')
wholeFile=filerefbin.read()
import re
graphicReg=re.compile('<DESCRIPTION>GRAPHIC')
locationGraphics=graphicReg.finditer(wholeFile)
graphicsTags=[]
for match in locationGraphics:
    graphicsTags.append(match.span()) 
```

我可以轻松地使用相同的过程来获取单词开头，或者识别文件名并在“第一”行中获取文件名的末尾。我也成功地完成了嵌入的 gif 文件。但我似乎无法写出正确的组合，所以当我双击 h65803h6580301.gif 时，它已被隔离并保存，我可以看到图形。

有趣的是，当我在 rb 中打开文件时，行尾似乎仍然存在，即使它们在记事本中似乎没有任何影响。所以这显然是我的问题之一，我可能需要在删除 \n 后读取行并将行连接在一起

我喜欢这个网站，我也喜欢 PYTHON

一旦我阅读了bendin的帖子，这太容易了。我只需要剪掉以单词 begin 开头的部分并将其保存在 txt 文件中，然后运行以下命令：

```
import uu
uu.decode(r'c:\test2.txt',r'c:\test.gif') 
```

在剩下的时间里，我必须处理其他一些事情，但当我更仔细地研究这个时，我会在这里发布更多内容。我需要发现的第一件事是如何使用文件以外的东西，因为我将整个 .txt 文件读入内存并剪掉了具有我需要使用剪裁部分而不是写入它的图像的部分到 test2.txt。我相信只要弄清楚如何去做就可以做到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:27:56.093

您正在查看的不是“二进制”，而是**[uuencoded](http://en.wikipedia.org/wiki/Uuencode)**。Python 的标准库包括模块[uu](http://docs.python.org/library/uu.html#module-uu)，用于处理 uuencoded 数据。

模块[uu](http://docs.python.org/library/uu.html#module-uu)需要使用临时文件进行编码和解码。[您可以通过使用 Python 的编解码器](http://docs.python.org/library/codecs.html)模块来完成此操作，而无需使用临时文件，如下所示：

```
import codecs

data       = "Let's just pretend that this is binary data, ok?"
uuencode   = codecs.getencoder("uu")
data_uu, n = uuencode(data)
uudecode   = codecs.getdecoder("uu")
decoded, m = uudecode(data_uu)

print """* The initial input:
%(data)s
* Encoding these %(n)d bytes produces:
%(data_uu)s
* When we decode these %(m)d bytes, we get the original data back:
%(decoded)s""" % globals() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T21:39:13.833

如果内容包含 JPEG 图像，您肯定需要以二进制模式阅读。

同样，Python 包括一个 SGML 解析器[http://docs.python.org/library/sgmllib.html](http://docs.python.org/library/sgmllib.html)。

那里没有示例，但您需要做的就是设置 do_ 方法来处理您希望的 sgml 标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T22:27:41.347

您需要以`open(filename,'rb')`二进制模式打开文件。请注意，这会导致 python 在某些操作系统上给您带来令人困惑的两字节行尾。

# c# - 使用 C# 序列化 Java 可反序列化对象

> ID：822163
> 
> 赞同：5
> 
> 时间：2009-05-04T21:32:47.513
> 
> 标签：c#, java, serialization

我有两个需要相互交谈的应用程序。App1 需要能够序列化 App2 然后可以反序列化的对象。很容易做到的，对吧？这就是问题所在；App1 基于 C#，App2 基于 Java。所以App1需要以Java二进制文件格式写出文件。如何才能做到这一点？

在我看来，我有两个选择。首先是想办法在 C# 中序列化 Java 对象，以便 App1 只创建适当的文件。我的另一个选择是用 Java 编写一个转换器，它读取文件并相应地填充对象并序列化新填充的对象。这样，C# 应用程序只需写出转换器随后解释的某种格式化文本文件。

我无法对 Java 应用程序进行任何更改。

这应该怎么做？

更新：

Java 应用程序已经在客户手中，因此更改序列化方案将导致客户现有数据不兼容。Java 应用程序在处理此对象时使用本机 java 序列化。无法修改 Java 应用程序。

C# 应用程序使用协议缓冲区来序列化自己的数据。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T21:35:03.907

最佳答案是选项 3：使用与语言无关的序列化方案。

我使用 JavaScript。Thrift 是另一种选择，我认为协议缓冲区更专注于 RPC，但也应该可用于序列化。XML 或自定义二进制格式将是其他选项。

编辑：抱歉，没有注意到您不能对 Java 应用程序进行更改。也就是说，最好的方法可能是创建自己定义明确的格式，编写一个可以读取该格式的 java 应用程序，然后为遗留应用程序输出一个序列化的 java 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:36:37.880

“ [IKVM](http://www.ikvm.net/) ”可能是您可以使用的东西。该产品允许您将已编译的 java 字节码（.jar 等）转换为 .NET DLL。它非常易于使用，并且可能为您提供所需的互操作性。

除此之外，在没有二进制级互操作的情况下完成此任务的最简单方法是仅使用纯文本格式，例如 CSV 或 XML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T21:38:32.337

只需使用 XML 序列化。这两个框架都有很好的支持，简单性将使调试/维护更容易。用 Java 编写一个只导入 XML 并写入二进制文件的小程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T21:41:23.500

您最好的选择是编写使用 Java Native 接口的东西。不好玩，但它会工作。

您可以使用 JNI 直接执行此操作（不好玩但可行），或者可能有一些工具可以为您生成代码 - 看看 SWIG：[http ://www.swig.org/](http://www.swig.org/)

您可以从 C# 调用 Java 来为您执行持久性。

# asp.net - aspnet_regsql.exe 能否用于创建能够存储多个电子邮件地址的数据库

> ID：822171
> 
> 赞同：0
> 
> 时间：2009-05-04T21:34:30.570
> 
> 标签：asp.net, authentication, asp.net-membership, forms-authentication

第一季度

A) 有没有办法创建会员数据库（使用 aspnet_regsql 工具），每个用户在注册过程中可以指定多个电子邮件地址（而不仅仅是一个）？

B）在创建新用户帐户时，是否还有一种方法可以以某种方式“通知”WAT 中的安全向导以包括新的输入字段（将在其中输入其他电子邮件地址）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T21:57:03.463

我认为个人资料会解决您的问题。这是[ScottGu](http://weblogs.asp.net/scottgu/archive/2005/10/18/427754.aspx)的一篇关于使用配置文件实现成员资格的博客文章。

# c# - 为什么从查询字符串中删除反斜杠 - ASP.NET & Javascript

> ID：822180
> 
> 赞同：3
> 
> 时间：2009-05-04T21:36:44.807
> 
> 标签：c#, asp.net, javascript

我正在尝试生成一个包含 UNC 路径作为查询字符串变量之一的 URL。当用户单击 ASP.NET 按钮控件时，该 URL 将在弹出窗口中打开。单击按钮时，反斜杠会从 UNC 路径中删除，从而导致页面中断。

该按钮在带有所有反斜杠的页面源文件中正确呈现。

有什么办法可以防止这种情况发生吗？

这是我的源代码：

后面的代码：

```
string unc = @"\\myserver\myfolder\myfile.txt";
string url = string.Format("http://www.mysite.com/page.aspx?a={0}", unc);

MyButton.Attributes.Add("onclick", @"javascript:FullPop('" + url + @"')"); 
```

ASPX 页面

```
<script language="javascript" type="text\javascript">
    function FullPop(Newurl) {
        Win = window.open( Newurl,"Monitor", "fullscreen=0,toolbar=1,location=1,directories=1,status=1,menubar=1,scrollbars=1,resizable=1,width=800,height=600,top=50,left=50");
        Win.focus();
    }
</script>

<asp:button id="MyButton" runat="server" cssclass="mycss" text="View Actual Target" /> 
```

**更新**

Server.UrlEncode 不起作用。相同的行为。

**更新 1**

根据 Daniel Lew 的回答，我开发了以下解决方案：

```
protected void Page_Load(object sender, EventArgs e)
{  
    string unc = @"\\myserver\myfolder\myfile.txt";
    string url = string.Format("http://www.mysite.com/page.aspx?a={0}", unc);

    MyButton.Attributes.Add("onclick", @"javascript:FullPop('" + this.EscapeforJavaScript(url) + @"')");
}

private string EscapeforJavaScript(string url)
{
    return url.Replace(@"\", @"\\"); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T21:44:33.930

您必须对您在 URL 中输入的值进行 URL 编码：

```
string url = "http://www.mysite.com/page.aspx?a=" + Server.UrlEncode(unc); 
```

编辑：
为了安全地将 url 放入 Javascript 代码中，您还必须将字符串编码为文字字符串：

```
MyButton.Attributes.Add("onclick", @"FullPop('" + url.Replace(@"\", @"\\").Replace("'", @"\'") + @"')"); 
```

（javascript: 协议仅在 Javascript 用作链接的 href 时使用，而不是在您将代码放入诸如 onclick 之类的事件中时使用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:44:04.023

我对 asp.net 一无所知，但是在通过模板将文本直接添加到 JavaScript 之前，我遇到过一些问题。您是否尝试过转义 url 上的反斜杠以避免这种情况？

```
// Returns "\myservermyfoldermyfile.txt", due to escpaing the backslash.
alert("\\myserver\myfolder\myfile.txt");

// Returns correct value of "\\myserver\myfolder\myfile.txt"
alert("\\\\myserver\\myfolder\\myfile.txt"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T21:45:12.167

您可能想尝试使用以下方法在服务器端对字符串进行 URLEncoding：

```
public static string UrlFullEncode(string strUrl) 
{
    if (strUrl == null)
        return "";
    strUrl = System.Web.HttpUtility.UrlEncode(strUrl);
} 
```

我不是 100% 确定它是否会替换反斜杠，但值得一试。

# c++ - C++中最随机的函数是什么？

> ID：822182
> 
> 赞同：5
> 
> 时间：2009-05-04T21:37:00.827
> 
> 标签：c++, random

我用过

```
#include<stdlib>
#include<time>
using namespace std;
srand((unsigned)time(0));
int n=(rand()>>8)%4; 
```

但是还有哪些其他随机函数，或者还有哪些其他函数可以用作随机数生成器？

编辑：我真的没有特别的理由问这个问题，我只是想知道 C++ 是否有任何其他随机函数。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-04T21:42:09.660

*   [Boost Random Number Library](http://www.boost.org/doc/libs/release/libs/random)提供了广泛的生成器（质量与性能）和一些典型的随机分布。一切都相当不错且易于使用。
*   如果你想要一些其他的方法/库 - 然后谷歌密码随机数，你也可以使用[这个文档](http://www.cypherpunks.to/~peter/06_random.pdf)作为参考。
*   不要发明自己的解决方案，除非您是该领域的专家/研究人员/等，利用通常由聪明人编写并由其他聪明人彻底检查的现有解决方案。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-04T21:55:52.390

rand() 和 srand() 函数都是 C++ 标准指定的。如果涉及到自己编写，请注意 John von Neumann 所说的：

> “任何考虑产生随机数字的算术方法的人当然处于罪恶状态”

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-05T00:08:44.783

这段代码非常有效。尽管用户可能会在几次迭代后开始注意到一种模式。

```
int FastRandom()
{
  return 10;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T21:40:02.660

不是严格意义上的 C++，而是特定于 Windows 的：

[CryptGenRandom](http://msdn.microsoft.com/en-us/library/aa379942.aspx)

我确信所有操作系统都有其等效的加密安全随机生成器功能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T21:52:40.150

```
int unixrand()
{
   int x;
   int f = open("/dev/random", O_RDONLY);
   if (f < 0) return -1; /* Error */
   if (sizeof(x) != read(f, &x, sizeof(x))) {
       close(f);
       return -1;
   }
   close(f);       
   if (x < 0) x = ~x;
   return x;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T23:15:54.397

[（从我刚刚写给](https://stackoverflow.com/questions/822323/how-to-generate-a-random-number-in-c/822366#822366)类似问题的答案交叉发布）

看看[ISAAC](http://burtleburtle.net/bob/rand/isaacafa.html)（间接、移位、累加、加和计数）。其分布均匀，平均循环长度为 2^8295。

它也很快，因为它不涉及乘法或模数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T23:43:53.270

Bruce Schneier 和 John Kelsey 编写了一个您可能感兴趣[的随机数生成器。相反，它是一个种子生成器。](http://www.schneier.com/yarrow.html)即使不再支持 Yarrow，您可能会对它如何收集熵感兴趣。

[OpenSSL 有一个](http://www.openssl.org/docs/crypto/RAND_bytes.html#)相对容易访问且非常便携的 API。Mozilla 提供[了一个体面的 API，可以封装操作系统提供的任何内容](http://www.mozilla.org/projects/nspr/reference/html/prrng.html)。

不过，就个人而言，我通常使用已经建议的 Boost.Random。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-04T21:40:21.070

Random 在均匀分布时为您提供了一个很好的随机数，并且在这方面做得很好。

其他任何事情都意味着您想要实际扭曲分布。

例如，使用 Microsoft 的 GUID 生成器会为您提供一个不太可能重复的随机 id，并考虑到时间和计算机等因素。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-05-04T21:40:00.697

时间通常是最随机的操作，执行起来也很便宜，但仍然可以预测。

如果您想要真正的随机性，使用某种外部输入是您唯一的解决方案。

[Quantum Random Bit Generator](http://random.irb.hr/)是一种提供此类数据的服务。

# javascript - 如何用 JavaScript 编写一个简单的 WYSIWYG 编辑器？

> ID：822184
> 
> 赞同：10
> 
> 时间：2009-05-04T21:37:35.973
> 
> 标签：javascript, html, editor, wysiwyg

在我的项目中，我需要编写小型 WYSIWYG 编辑器（只需让用户将文本设为粗体/斜体/下划线，也许还有更多）。所以我不想使用像tinymce或fckeditor这样的怪物。我的问题是我需要知道哪些 HTML 元素和 javascript 函数？在这个问题中，我可以在其中编辑和格式化文本的 HTML 元素是一件非常有趣的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T21:40:37.777

如果您想自己动手，请查看[Midas](http://www.mozilla.org/editor/midas-spec.html)。它适用于 FF3+、IE、Safari、Opera、Chrome。

基本上，您使用 contentEditable 和 execCommand 将浏览器变成 RTE。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T21:40:35.157

```
document.getElementById('edit').contentDocument.designMode = "on"; 
```

看看[http://www.mozilla.org/editor/ie2midas.html](http://www.mozilla.org/editor/ie2midas.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-05T11:14:58.383

有[http://www.gosu.pl/steditor/](http://www.gosu.pl/steditor/)代码非常简单明了。它使用其他答案中提到的 designMode 和 execCommand 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T22:44:43.863

或者使用 markdown 或 Textile 等简单语言并提供实时预览。

我认为大多数人会得到*强调的星号*和**粗体的双星**号。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-04T22:39:14.517

我过去使用过[YUI](http://developer.yahoo.com/yui/)的所见即所得编辑器，它允许您配置按钮，以便您可以轻松使用它并将按钮限制为粗体/斜体/下划线。

# c - If 和等式语句

> ID：822186
> 
> 赞同：0
> 
> 时间：2009-05-04T21:38:12.150
> 
> 标签：c, if-statement, conditional-statements, equality

我试图在[这里](http://pages.cpsc.ucalgary.ca/~johnz/ccpc/problems/A.pdf)解决问题，但我不知道为什么我的代码不起作用。任何帮助表示赞赏。编辑：编辑以进行下面提到的更正，但输出的第二行仍然有一个额外的“15”（粗体），我不明白它来自哪里。

我的输出是

18662658515 5552272 **15**

```
#include <stdlib.h>
#include <stdio.h>

int main(void){
  int n;
  int j;
  scanf("%d\n", &n);
  int i = 0;
  char mystr[15];

  for(;i<n;i++){
    fgets(mystr,15,stdin);

    for(j=0;j<15;j++){
      if(isdigit(mystr[j])){
        printf("%c", mystr[j]);
        continue;
      }
      if ('A' <= mystr[j] && mystr[j] <= 'C')
        printf("2");
      if ('D' <= mystr[j] && mystr[j] <= 'F')
        printf("3");
      if ('G' <= mystr[j] && mystr[j] <= 'I')
        printf("4");
      if ('J' <= mystr[j] && mystr[j] <= 'L')
        printf("5");
      if ('M' <= mystr[j] && mystr[j] <= 'O')
        printf("6");
      if ('P' <= mystr[j] && mystr[j] <= 'S')
        printf("7");
      if ('T' <= mystr[j] && mystr[j] <= 'V')
        printf("8");
      if ('W' <= mystr[j] && mystr[j] <= 'Z')
        printf("9");
    }
    printf("\n");
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T21:42:37.913

一方面，我认为你的比较是倒退的。例如，您应该测试“if ('A' <= mystr[j] && mystr[j] <= 'C')”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T22:03:51.293

问题是您正在遍历输入字符串中的所有 15 个字符，而不管输入的长度如何。第一个测试用例有 11 个字符，但第二个用例只有 8 个。在第二次迭代中，您不小心处理了第一个输入的最后两个字符，即`15`.

要修复它，只需在点击 NUL 字符 0 时停止迭代，这会通过更改此行来终止字符串

```
for(j=0;j<15;j++){ 
```

到

```
for(j=0; mystr[j] != 0; j++){ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T21:57:06.707

也许，有一个函数 between() 会有所帮助（道歉；我的 C 生锈了）：

```
bool between(char c, char before, char after) {
    return before <= c && c <= after;
} 
```

所以

```
if ('A' <= mystr[j] && mystr[j] <= 'C')
        printf("2"); 
```

变成

```
if (between(mystr[j], 'A', 'C')
        printf("2"); 
```

通常最好使用半开范围，其中下限包括在内，上限不包括在内。这样，每个测试的最后一个元素将是前一个测试的第一个元素，这可以帮助您更容易地检测某些类型的错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T21:48:11.720

考虑到您可能希望以相同的顺序比较事物。在编写代码之前用简单的英语说出来。如果 myLetterCode 大于 A.code && myLetterCode 小于 C.Code（它必须是 B！）。

把你的信放在左边，把它与之比较的东西放在右边。否则它会很快变得非常混乱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T22:04:55.627

使用查找表不是更容易吗？

```
int numbers[] = {              2, 2, 2,  3, 3, 3,
                     4, 4, 4,  5, 5, 5,  6, 6, 6,
                  7, 7, 7, 7,  8, 8, 8,  9, 9, 9, 9};

... cut ...

if (isdigit (mystr[j]))
    printf ("%c", mystr[j]);
else
    printf ("%d", numbers[mystr[j] - 'A']);

... cut ... 
```

# python - Emacs Pabbrev 和 Python

> ID：822195
> 
> 赞同：3
> 
> 时间：2009-05-04T21:39:58.760
> 
> 标签：python, emacs, pabbrev

通常，当您在 emacs python 模式下的空行上单击制表符时，它将循环显示可用的制表符缩进。当我在该点处于最深缩进级别时点击制表符时，我会得到包含最后一个最佳匹配选项的 pabbrev 缓冲区。有没有其他人有这个问题，有没有不写任何elisp的简单方法？

编辑：特雷，我想让 pabbrev 在 python 模式下工作而不是关闭它。

因此，假设有 2 个缩进级别，要么没有，要么通常为 1 级，如果它按 3 次制表符，第一个将把点放在 4 个空格（或任何缩进设置），第二个回到 0 个空格，然后第三回4格。

使用 pabbrev 模式时，第一个缩进标记为 4 个空格，第二个缩进为自动完成提供了一个缓冲区。如果我的观点左侧没有字母，则不应发生这种情况。这更有意义吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T04:48:39.090

根据明确的要求，您需要类似的东西。我很确定你不能不写一些省略号就逃脱。好的（IMO）是这应该适用于所有模式，而不仅仅是python模式。

```
(defadvice pabbrev-expand-maybe (around pabbrev-expand-maybe-when-not-after-whitespace activate)
  "prevent expansion when only whitespace between point and beginning of line"
  (if (save-match-data
        (save-excursion
          (let ((p (point)))
            (string-match "^\\s-*$" (buffer-substring-no-properties (progn (beginning-of-line) (point)) p)))))
      (let ((last-command (if (eq last-command this-command) (pabbrev-get-previous-binding) last-command))
            (this-command (pabbrev-get-previous-binding)))
        (pabbrev-call-previous-tab-binding))
    ad-do-it)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T20:35:42.167

这对于迟到的反应如何？

多亏了 Trey 的补丁，这现在应该可以开箱即用了。以 pabbrev.el 的方式绑定 tab 有点调皮，但是如果你想要快速扩展怎么办。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T21:54:38.693

没有省略号？当然：

```
M-x pabbrev-mode 
```

应该将其关闭。但是，如果您不介意剪切/粘贴 elisp，您可以在 python 缓冲区中关闭 pabbrev 模式：

```
(add-hook 'python-mode (lambda () (pabbrev-mode -1))) 
```

# mysql - 导入所有 MySQL 数据库

> ID：822210
> 
> 赞同：1
> 
> 时间：2009-05-04T21:41:58.040
> 
> 标签：mysql

我`mysqldump --all-databases`每晚作为备份。但是在将此转储导入全新安装时，我显然遇到了几个问题。

1.  我显然不能（也不想）覆盖新的 information_schema。
2.  除非我覆盖`mysql`数据库，否则我的所有用户和权限设置都将丢失。

在这种情况下，标准做法是什么？在上传之前从 .sql 文件中解析出 information_schema？我是否覆盖`mysql`数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T21:56:15.337

信息架构不会有问题

[http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html) mysqldump 不会转储 INFORMATION_SCHEMA 数据库。如果您在命令行上显式命名该数据库，mysqldump 会默默地忽略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:36:38.170

对于排除数据库，试试这个 bash 脚本。

```
 for DB in $(echo "show databases" | mysql -u <username> -p'<password>' | grep -v Database  grep -v <some_db_to_exclude>)
do
    mysqldump -u <username> -p'<password>' ${DB}
done 
```

# sql-server - 在 TSQL 中增加一个唯一标识符

> ID：822211
> 
> 赞同：1
> 
> 时间：2009-05-04T21:42:03.187
> 
> 标签：sql-server, tsql, uniqueidentifier

我正在寻找一种在 TSQL 中将 uniqueidentifier 递增 1 的方法。例如，如果 id 是 A6BC60AD-A4D9-46F4-A7D3-98B2A7237A9E，我希望能够选择 A6BC60AD-A4D9-46F4-A7D3-98B2A7237A9F。

@rein 用于数据导入。我们有一个中间表，其中包含我们从中生成记录的 ID，我们稍后会在导入时加入这些 ID。不幸的是，现在其中一些记录在下一个表中生成了几条记录，因此我们需要一个可重现的新 id。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-02-02T16:52:03.563

您想要增加 Guid 的方式对于 SQL Server 是不正确的，因为 Guid 是字节组中具有不同字节顺序的结构，请查看： [http ://sqlblog.com/blogs/alberto_ferrari/archive/2007/08 /31/how-are-guids-sorted-by-sql-server.aspx](http://sqlblog.com/blogs/alberto_ferrari/archive/2007/08/31/how-are-guids-sorted-by-sql-server.aspx) 并注意以下内容：

> 现在，当我运行修改后的 Alberto 查询时，我得到以下序列：3、2、1、0、5、4、7、6、9、8、15、14、13、12、11、10
> 
> 这意味着，GUID 的字节 #3 是最不重要的，而 GUID 的字节 #10 是最重要的 [从 SQL Server ORDER BY 子句的角度来看]。

这是一个简单的函数来增加一个唯一标识符来解决这个问题：

```
create function [dbo].[IncrementGuid](@guid uniqueidentifier) 
returns uniqueidentifier 
as 
begin 
declare @guid_binary binary(16), @b03 binary(4), @b45 binary(2), @b67 binary(2), @b89 binary(2), @bAF binary(6)

select @guid_binary = @guid

select @b03 = convert(binary(4), reverse(substring(@guid_binary,1,4)))
select @b45 = convert(binary(2), reverse(substring(@guid_binary,5,2)))
select @b67 = convert(binary(2), reverse(substring(@guid_binary,7,2)))
select @b89 = convert(binary(2), substring(@guid_binary,9,2))
select @bAF = convert(binary(6), substring(@guid_binary,11,6))

if (@b03 < 'FFFFFFFF')
begin
    select @b03 = convert(binary(4), cast(@b03 as int) + 1)
end
else if (@b45 < 'FFFF')
begin
    select @b45 = convert(binary(2), cast(@b45 as int) + 1)
end
else if (@b89 < 'FFFF')
begin
    select @b89 = convert(binary(2), cast(@b89 as int) + 1)
end
else
begin
    select @bAF = convert(binary(6), cast(@bAF as bigint) + 1)
end

return convert(binary(16), reverse(convert(char(4),@b03)) + reverse(convert(char(2),@b45)) + reverse(convert(char(2),@b67)) + convert(char(2),@b89) + convert(char(6),@bAF))
end 
```

请注意，字节 6 和 7 不递增，因为它们包含 Guid 版本位。但正如其他人指出的那样，你真的**不**应该这样做。在您的情况下，为这些 Guid 创建一个临时表可能会更好（有两列：一个整数作为索引，第二个带有生成的 Guid）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T22:46:37.323

您可以使用这种方法，但我没有考虑溢出低 8 个字节的情况。

```
declare @guid uniqueidentifier, @binaryUpper8 binary(8), @binaryLower8 binary(8), @binary16 binary(16), @bigint bigint
set @guid = 'A6BC60AD-A4D9-46F4-A7D3-98B2A7237A9E'
set @binary16 = cast(@guid as binary(16))

--harvest lower 8 bytes
select @binaryUpper8= substring(@binary16, 1, 8)
    ,@binaryLower8  = substring(@binary16, 9, 8)
set @bigint = cast(@binaryLower8 as bigint)

--increment
set @bigint = @bigint + 1

--convert back
set @binaryLower8 = cast(@bigint as binary(8))
set @binary16 = @binaryUpper8 + @binaryLower8
set @guid = cast(@binary16 as uniqueidentifier)
select @guid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T21:43:53.977

这是我想出的一种方法，但我希望有更好的方法。

```
LEFT([ID], 19) + RIGHT(CONVERT(uniqueidentifier, CONVERT(binary(16), CONVERT(binary(16), [ID]) + CONVERT(bigint, 1))), 17) AS 'MyNewID' 
```

# c# - 根据ac#datetime，将月份输出为MM？

> ID：822217
> 
> 赞同：0
> 
> 时间：2009-05-04T21:43:21.280
> 
> 标签：c#, datetime

我有一个日期时间对象（已初始化），如何将月份部分输出为 MM？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T21:44:05.413

```
Your_Date_Time_Object.ToString("MM") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T21:45:19.903

```
DateTime date = DateTime.Now;              // Use current date
string format = "MM";                      // Use this format
Console.WriteLine(date.ToString(format));  // Write to console 
```

# php - PHP显示所有声明的类的名称？

> ID：822223
> 
> 赞同：3
> 
> 时间：2009-05-04T21:44:41.213
> 
> 标签：php, class, instance-variables

可以说我有这个代码：

```
<?php
class hello {
    var $greeting = "hello";
    function hello(){
        echo $this->greeting;
        return;
    }
}

$hello1 = new hello;
$hello2 = new hello;
$hello4 = new hello;
?> 
```

我如何让它回显实例化对象的所有名称（如果可能，它们各自的类），以便它回显（可能在数组中）“hello1 => hello，hello2 => hello，hello4 => hello”。

如果这是不可能的，有没有办法从类中告诉实例的名称，比如 echo instance_name($this); 会让我“hello1”。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T21:52:08.903

您可以调用`get_defined_vars`来获取所有存在的对象的数组，然后使用`get_class`来获取每个对象的类名（代码未经测试，但它应该可以工作）：

```
$vars = array();
foreach (get_defined_vars() as $var) {
    $vars[$var] = get_class($var);
} 
```

仅供参考，您所说的“声明的类”更广为人知的是“对象”。

你的第二个问题是不可能的。举个例子：

```
$hello1 = $hello2 = new hello(); 
```

现在，如果我打电话`instance_name`，它应该返回“hello1”还是“hello2”？

# javascript - 在 Internet Explorer 中将焦点设置在 html 元素上

> ID：822228
> 
> 赞同：2
> 
> 时间：2009-05-04T21:45:25.770
> 
> 标签：javascript, internet-explorer

我正在尝试使用将焦点设置在文本输入元素上

```
document.getElementById( 'id' ).focus() 
```

这适用于 Firefox 3，但不适用于 Internet Explorer 8。

在 Internet Explorer 中将焦点设置在 HTML 元素上的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T21:52:11.773

您确定您的代码没有其他问题吗？我没有要测试的 IE8，但这个独立的示例在 IE7 中完美运行 - 也许您可以在 IE8 中尝试它？

```
<html><body>
<form><input type='text' id='bim'></form>
<script>document.getElementById('bim').focus()</script>
</body></html> 
```

# delphi - 字符数组的 D2009 问题 - 我如何“优雅地”修复我的代码？

> ID：822229
> 
> 赞同：2
> 
> 时间：2009-05-04T21:46:12.100
> 
> 标签：delphi, arrays, delphi-2009, char, byte

浏览我的一些较旧的 Delphi 项目并将它们升级到 D2009，因为我发现这个版本对所有以前的版本都有很大的改进（Generics.Collections - wow！;)），我遇到了各种问题。我设法解决了这个问题，但解决方案似乎没有我认为的那么优雅。（注意，我已经有大约三年没有编写 Delphi 代码了，即使在那时，它也只是业余的黑客行为，而不是对正在发生的事情的深入理解）。

我的代码将有一个 TFileStream 并从中读取。这些文件以前是由我的旧 Delphi 应用程序编写的，文件中的前三个字符将是 CTR，以将文件类型识别为有效。阅读器会将前三个字节读入一个字符数组（这就是问题所在，现在 sizeof(char) 是 2 个字节），然后将此数组视为字符串以查看它是否读取“CTR”。

```
var ...
buffer: array[0..2] of char;
begin
...
InStream.read(buffer, 3);
if buffer <>'CTR' then begin ShowMessage('Not a valid file!'); exit; end;
... 
```

*这将编译并且它曾经可以工作，但现在缓冲区实际上是 6 个字节长，因此永远*不等于“CTR” 。

我通过将缓冲区更改为来解决此问题，`array[0..2] of byte`并引入了更多局部变量来执行以下操作：

```
for b in buffer do s := s + chr(b); //notice the for..in loop now available in D2009
if s<>'CTR'... 
```

所以基本上我将单个字节转换为字符串，然后进行比较，但必须有更直接的方法来做到这一点。你能解释一下这个问题吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-04T21:49:02.857

您可以将缓冲区设置为

```
var
  buffer: array[0..2] of AnsiChar; 
```

你会读到和以前一样的东西。

# php - 这是 Advantage 数据库的错误吗？

> ID：822232
> 
> 赞同：1
> 
> 时间：2009-05-04T21:47:09.523
> 
> 标签：php, sql, advantage-database-server

我遇到了在我看来是 Advantage Database PHP Extension 中的一个错误（我知道，我知道......）。我已经将它报告为一个错误，但仍然没有收到任何回复，所以我想我会由你们来运行它。

**工作代码：**

```
for ($i = 0; $i < 100; $i++)
{
    $connection = ads_connect( 'DataDirectory=\\some\path\;ServerTypes=2;RightsChecking=Off;TrimTrailingSpaces=true;CommType=TCP_IP;', '', '' );

    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');

    ads_close( $connection );
} 
```

这只是循环 100 次，连接到数据库，执行查询，然后断开连接。

**非工作代码：**

```
for ($i = 0; $i < 100; $i++)
{
    $connection = ads_connect( 'DataDirectory=\\some\path\;ServerTypes=2;RightsChecking=Off;TrimTrailingSpaces=true;CommType=TCP_IP;', '', '' );

    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');
    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');

    ads_close( $connection );
} 
```

注意到第二个查询执行了吗？此循环在第 51 个周期失败（数据库服务器将每个应用程序限制为 50 个同时连接）并出现错误

> 错误 6303：超出最大 Advantage 数据库服务器连接数。

我尝试了其他几件事，包括没有成功：

```
for ($i = 0; $i < 100; $i++)
{
    $connection = ads_connect( 'DataDirectory=\\some\path\;ServerTypes=2;RightsChecking=Off;TrimTrailingSpaces=true;CommType=TCP_IP;', '', '' );

    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');
    ads_free_result( $results );

    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');
    ads_free_result( $results );

    ads_close( $connection );
} 
```

但是，这**确实**解决了问题，并且两个查询仍然成功且准确地执行！

```
for ($i = 0; $i < 100; $i++)
{
    $connection = ads_connect( 'DataDirectory=\\some\path\;ServerTypes=2;RightsChecking=Off;TrimTrailingSpaces=true;CommType=TCP_IP;', '', '' );

    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');
    ads_close( $connection );

    $results = ads_do( $connection , 'SELECT TOP 1 * FROM projects');
    ads_close( $connection );   
} 
```

这一切对我来说似乎很奇怪......有什么想法吗？

**编辑：**我在 PHP 5.2.5 和 ADS 8.1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T22:18:29.260

知识库中有关于 6303 错误以及如何增加可能来自客户端的连接数的项目，[http:](http://devzone.advantagedatabase.com/dz/content.aspx?Key=17&RefNo=981124-0621) //devzone.advantagedatabase.com/dz/content.aspx?Key=17&RefNo=981124-0621 。R&D 目前正在研究这个问题，并努力在下一个服务版本中解决它。

# svn - 如何为同一个项目维护单独的 svn 存储库？

> ID：822233
> 
> 赞同：0
> 
> 时间：2009-05-04T21:47:13.690
> 
> 标签：svn, version-control

我正在使用一个带有少量（十几个源文件）本地修改和添加的大型（数千个源文件）公共项目。本地修改与大项目的其他用户无关。该项目使用svn，我们自己的项目也是如此。我希望能够在项目更新并合并我们的更改时从项目中获取更新；我还希望我们的更改保持在源代码控制之下。

目前，我只是在需要时更新我们的大项目的工作副本，将我们的更改检出到不同的目录中，并将我们的更改复制到大项目中的相应目录中，并手动对修改进行一些调整。这是可行的；它很少改变，没什么大不了的，这种方式很有效。但是，如果我们或他们的事情变化得更频繁，那就不切实际了。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T21:55:28.117

您确实想使用单个存储库，将现有项目分支以创建您的版本，然后使用该分支。当主版本更改时，您可以将它们的更新合并到您的分支中（因为您只会获得自上次合并以来所做的更改，手动合并 2 棵树要容易得多）

如果您无法将项目添加到主存储库，并且必须维护自己的项目，那么[svk](http://svk.bestpractical.com/view/HomePage)是值得研究的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:52:29.277

您应该考虑为您的特定修改创建一个分支。这是关于从 svn 书[分支](http://svnbook.red-bean.com/en/1.1/ch04.html)出来的章节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T21:57:36.487

在不知道您为什么这样做的细节的情况下，它会限制潜在的建议，但我认为这与使用 SVN 为您提供的一样好。Git 就是为处理这种事情而设计的，但是如果你不能在更大的项目中添加几个文件，那么你当然不能改变整个源代码控制系统。

我希望以其他人都拥有它们但忽略它们的方式将这些文件添加到主干。例如，您在一个文件中有一个属性，它更改您的构建脚本以获取这些文件，并为其他所有人忽略它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T21:51:03.803

您可以为此查看 svk 。不过已经有一段时间了，所以我不能给你详细的咒语。

# asp.net - VS2008 ASP.NET 网站与 Web 应用程序

> ID：822235
> 
> 赞同：2
> 
> 时间：2009-05-04T21:47:54.407
> 
> 标签：asp.net, visual-studio-2008

在 C# 中的 Visual Studio 2008 ASP.NET 中，从 ASP.NET 网站与 ASP.NET Web 应用程序开始的优缺点是什么？

哪个是最先介绍的？一种方法是“更现代”的方法吗？在什么情况下你会使用其中一种与另一种？

谢谢！

亚当

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T21:54:12.533

Web Site 模型是在 VS 2005 (IIRC) 中引入的，它取代了 VS 2003 的网站模型，它更像今天的 Web 应用程序模型。

Web 应用程序模型后来作为附加组件交付。自 VS 2008 以来，它是 Visual Studio 的常规部分。

至于任一模型的优点和它们之间的差异，请参阅许多类似/重复的问题（[https://stackoverflow.com/search?q=website web application](https://stackoverflow.com/search?q=website%20web%20application)），尤其是这个答案以获得很好的总结：[ASP.NET网站还是 ASP.NET Web 应用程序？](https://stackoverflow.com/questions/398037/asp-net-web-site-or-web-application/398049#398049)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T21:57:48.983

自 VS 2003 以来，我没有使用过 Web 应用程序。网站项目现在拥有一切：母版页、网站内容的组织文件夹（即 - App_Data、App_Themes 等）、站点地图文件。

自从 MS 将 Cassini 作为用于在 VS 中调试的内置 Web 容器引入以来，使用网站变得更加容易。

# ruby - 使用 Ruby CSV::Writer 生成包含换行符的字段

> ID：822240
> 
> 赞同：4
> 
> 时间：2009-05-04T21:48:21.877
> 
> 标签：ruby, excel, csv, fastercsv

我想让 CSV::Writer 在带引号的字符串中生成换行符：

```
A,B,"Line
Line",C 
```

这样该行将在 Excel 中显示为：

```
A,B,Line,C
    Line 
```

是否可以防止 CSV:Writer 去除换行符？如果没有，切换到 FasterCSV 会解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T17:22:47.900

当前的 CSV 模块支持单个单元格中的换行符。

从 IRB 会话：

```
 require 'csv'
  CSV.open("./testfile.csv", "w") do |csv|
    csv << ["row", "of", "CSV\nCSV", "data"]
  end 
```

切换到 FasterCSV 也可以。从另一个 IRB 会话：

```
require 'fastercsv'
FasterCSV.open("./testfile.csv", "w") do |csv|
  csv << ["row", "of", "CSV\nCSV", "data"]
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-10T02:16:51.940

如果您将行分隔符设置为默认值以外的其他值（即 \r\n 或 \n），看起来您可以。这是一个示例（查看在调用 CSV.parse_row 时指定的最后一个参数）：

```
require 'csv'

src = "a,test\ntest,b\ra,test\ntest,b,c"
idx = 0
begin
  parsed = []
  parsed_cells, idx = CSV.parse_row(src, idx, parsed, ',', ?\r)
  puts "Parsed #{ parsed_cells } cells."
  p parsed
end while parsed_cells > 0 
```

这是输出：

```
Parsed 3 cells.
["a", "test\ntest", "b"]
Parsed 4 cells.
["a", "test\ntest", "b", "c"] 
```

希望这可以帮助。

# google-app-engine - 是否可以防止 Google App Engine 上的 DoSing？

> ID：822247
> 
> 赞同：18
> 
> 时间：2009-05-04T21:50:11.187
> 
> 标签：google-app-engine, resource-management

我正在考虑为 Google App Engine 开发一个应用程序，它应该不会获得太多流量。我真的宁愿不支付超过免费配额的费用。但是，通过使应用程序过载并超出配额似乎很容易引起拒绝服务攻击。是否有任何方法可以防止或使其更难超过免费配额？例如，我知道我可以限制来自 IP 的请求数量（使其更难超过 CPU 配额），但有没有办法让超过请求或带宽配额更难？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-04T21:55:35.197

没有内置工具可以防止 DoS。如果您使用 java 编写 Google Apps，那么您可以使用`service.FloodFilter`过滤器。以下代码将在您的任何 Servlet 执行之前执行。

```
package service;

import java.io.IOException;
import java.util.HashMap;
import java.util.Map;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;

/**
 * 
 * This filter can protect web server from simple DoS attacks
 * via request flooding.
 * 
 * It can limit a number of simultaneously processing requests
 * from one ip and requests to one page.
 *
 * To use filter add this lines to your web.xml file in a <web-app> section.
 * 
    <filter>
        <filter-name>FloodFilter</filter-name>
        <filter-class>service.FloodFilter</filter-class>
        <init-param>
            <param-name>maxPageRequests</param-name>
            <param-value>50</param-value>
        </init-param>
        <init-param>
            <param-name>maxClientRequests</param-name>
            <param-value>5</param-value>
        </init-param>
        <init-param>
            <param-name>busyPage</param-name>
            <param-value>/busy.html</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>JSP flood filter</filter-name>
        <url-pattern>*.jsp</url-pattern>
    </filter-mapping>
 *  
 *  PARAMETERS
 *  
 *  maxPageRequests:    limits simultaneous requests to every page
 *  maxClientRequests:  limits simultaneous requests from one client (ip)
 *  busyPage:           busy page to send to client if the limit is exceeded
 *                      this page MUST NOT be intercepted by this filter
 *  
 */
public class FloodFilter implements Filter
{
    private Map <String, Integer> pageRequests;
    private Map <String, Integer> clientRequests;

    private ServletContext context;
    private int maxPageRequests = 50;
    private int maxClientRequests = 10;
    private String busyPage = "/busy.html";

    public void doFilter( ServletRequest request, ServletResponse response, FilterChain chain ) throws IOException, ServletException
    {
        String page = null;
        String ip = null;

        try {
            if ( request instanceof HttpServletRequest ) {
                // obtaining client ip and page URI without parameters & jsessionid
                HttpServletRequest req = (HttpServletRequest) request;
                page = req.getRequestURI();

                if ( page.indexOf( ';' ) >= 0 )
                    page = page.substring( 0, page.indexOf( ';' ) );

                ip = req.getRemoteAddr();

                // trying & registering request
                if ( !tryRequest( page, ip ) ) {
                    // too many requests in process (from one client or for this page) 
                    context.log( "Flood denied from "+ip+" on page "+page );
                    page = null;
                    // forwarding to busy page
                    context.getRequestDispatcher( busyPage ).forward( request, response );
                    return;
                }
            }

            // requesting next filter or servlet
            chain.doFilter( request, response );
        } finally {
            if ( page != null )
                // unregistering the request
                releaseRequest( page, ip );
        }
    }

    private synchronized boolean tryRequest( String page, String ip )
    {
        // checking page requests
        Integer pNum = pageRequests.get( page );

        if ( pNum == null )
            pNum = 1;
        else {
            if ( pNum > maxPageRequests )
                return false;

            pNum = pNum + 1;
        }

        // checking client requests
        Integer cNum = clientRequests.get( ip );

        if ( cNum == null )
            cNum = 1;
        else {
            if ( cNum > maxClientRequests )
                return false;

            cNum = cNum + 1;
        }

        pageRequests.put( page, pNum );
        clientRequests.put( ip, cNum );

        return true;
    }

    private synchronized void releaseRequest( String page, String ip )
    {
        // removing page request
        Integer pNum = pageRequests.get( page );

        if ( pNum == null ) return;

        if ( pNum <= 1 )
            pageRequests.remove( page );
        else
            pageRequests.put( page, pNum-1 );

        // removing client request
        Integer cNum = clientRequests.get( ip );

        if ( cNum == null ) return;

        if ( cNum <= 1 )
            clientRequests.remove( ip );
        else
            clientRequests.put( ip, cNum-1 );
    }

    public synchronized void init( FilterConfig config ) throws ServletException
    {
        // configuring filter
        this.context = config.getServletContext();
        pageRequests = new HashMap <String,Integer> ();
        clientRequests = new HashMap <String,Integer> ();
        String s = config.getInitParameter( "maxPageRequests" );

        if ( s != null ) 
            maxPageRequests = Integer.parseInt( s );

        s = config.getInitParameter( "maxClientRequests" );

        if ( s != null ) 
            maxClientRequests = Integer.parseInt( s );

        s = config.getInitParameter( "busyPage" );

        if ( s != null ) 
            busyPage = s;
    }

    public synchronized void destroy()
    {
        pageRequests.clear();
        clientRequests.clear();
    }
} 
```

*   来自：[http ://forums.sun.com/thread.jspa?threadID=5125779&tstart=13545](http://forums.sun.com/thread.jspa?threadID=5125779&tstart=13545)

如果您使用的是 python，那么您可能必须滚动自己的过滤器。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-04T21:54:26.340

我不确定这是否可能，但[App Engine 常见问题解答](http://code.google.com/appengine/kb/billing.html#dos)表明，如果您可以证明这是 DOS 攻击，那么他们将退还与该攻击相关的任何费用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T02:27:22.350

似乎他们现在有一个可用于 Python 和 Java 的基于 IP 地址的过滤器（我知道这是一个旧线程，但它在 Google 搜索中仍然很高）。

[https://developers.google.com/appengine/docs/python/config/dos](https://developers.google.com/appengine/docs/python/config/dos)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-28T18:21:41.510

始终可以在 App Engine 应用程序前使用提供拒绝服务保护功能的服务。例如，Cloudflare 提供了备受推崇的服务[https://www.cloudflare.com/waf/](https://www.cloudflare.com/waf/)，还有其他的。我的理解（免责声明：我没有亲自使用过该服务）这些功能在免费计划中可用。

在应用程序本身中构建基于内存缓存的速率限制实现也相当容易。这是我从谷歌搜索此方法中获得的第一个结果：http: [//blog.simonwillison.net/post/57956846132/ratelimitcache](http://blog.simonwillison.net/post/57956846132/ratelimitcache)。这种机制是合理的，并且具有成本效益，因为共享的 memcache 使用可能就足够了并且是免费的。此外，走这条路线可以让您控制旋钮。缺点是应用程序本身必须处理 HTTP 请求并决定允许或拒绝它，因此可能需要处理成本（或 [免费] 配额耗尽）。

完全披露：我在 Google 的 App Engine 工作，与 Cloudflare 或 Simon Willison 没有任何关系。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-26T03:39:56.817

[GAE 防火墙](https://cloud.google.com/appengine/docs/standard/python/application-security#app_engine_firewall)最近发布，旨在取代以前相当有限的[DoS 保护服务](https://cloud.google.com/appengine/docs/standard/python/config/dos)。

它支持通过（REST）管理 API 以编程方式更新防火墙规则：[apps.firewall.ingressRules](https://cloud.google.com/appengine/docs/admin-api/reference/rest/v1beta/apps.firewall.ingressRules)可以与其他答案中描述的用于 DoS 检测的应用内逻辑相结合。不同之处在于，一旦部署了规则，违规请求将不再产生费用，因为它们不再到达应用程序，因此不需要应用程序内过滤本身。

# jsp - 使用 Hashmap 查找在 JSP 中执行任务

> ID：822252
> 
> 赞同：0
> 
> 时间：2009-05-04T21:51:23.850
> 
> 标签：jsp, struts

我有一个 Hashmap 和一组键。对于每个键，我想根据它是否存在于哈希图中执行一项任务。有人可以展示一种方法吗？我在我的应用程序中使用 Struts 和 JSP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-08T17:35:32.037

这个问题很老了，但是，你是否试图做这样的事情？：

```
for (String key : setOfKeys) {
    if (hm.containsKey(key)) {
        doSomething(hm, key);
    }
} 
```

# python - 我需要一个正则表达式作为python中mp3文件url的href属性

> ID：822260
> 
> 赞同：2
> 
> 时间：2009-05-04T21:52:19.200
> 
> 标签：python, regex

基于先前的堆栈溢出问题和 cgoldberg 的贡献，我使用 python re 模块想出了这个正则表达式：

```
import re
urls = re.finditer('http://(.*?).mp3', htmlcode) 
```

变量 urls 是一个可迭代对象，如果有多个，我可以使用循环单独访问每个 mp3 文件 url：

```
for url in urls:
    mp3fileurl = url.group(0) 
```

然而，这种技术有时只有效。我意识到正则表达式不会像成熟的解析器模块那样可靠。但是，有时，这对于同一页面是不可靠的。

我有时会在 http 之前收到一些 url 条目的所有内容。

我对正则表达式比较陌生。所以，我只是想知道是否有更可靠的方法来解决它。

提前致谢。stackoverflow 的新手，也期待提供一些答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T22:56:19.997

正如其他答案所指出的，使用正则表达式来解析 HTML = 坏主意。

考虑到这一点，我将添加我最喜欢的解析器的代码： [BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)：

```
from BeautifulSoup import BeautifulSoup

soup = BeautifulSoup(htmlcode)
links = soup.findAll('a', href=True)
mp3s = [l for l in links if l['href'].endswith('.mp3')]
for song in mp3s:
    print link['href'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T22:12:26.593

首先，是的，您可能应该使用 HTML 解析器。下面是一些使用 Python 自带的 HTMLParser 模块的示例代码：

```
from HTMLParser import HTMLParser

class ImgSrcHTMLParser(HTMLParser):
  def __init__(self):
    HTMLParser.__init__(self)
    self.srcs = []

  def handle_starttag(self, tag, attrs):
    if tag == 'img':
      self.srcs.append(dict(attrs).get('src'))

parser = ImgSrcHTMLParser()
parser.feed(html)
for src in parser.srcs:
  print src 
```

这会从 img 标签中收集 src。假设您想要以“.mp3”结尾的“a”标签的href，它应该很容易适应您的目的。

假设您真的想使用正则表达式，那么您的正则表达式存在一些问题。您没有分隔 URL，而是在 URL 内使用点。这样做最糟糕的副作用是非 mp3 URL 后跟 mp3-URL 将被视为一个长 URL。例如：“ [http://foo/bar.gif](http://foo/bar.gif) snarf snarf [http://baz/quux.mp3](http://baz/quux.mp3) ”。您可能需要某种分隔符（空格、引号，取决于您在做什么）并禁止 URL 中的某些字符（可能是相同的字符和/或 URL 中不允许的任何字符）。另外，您忘记转义“。” 在“.mp3”中。所以“ [http://foo/mp3icon.gif](http://foo/mp3icon.gif) ”将匹配为“ [http://foo/mp3](http://foo/mp3) ”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T22:31:59.090

与往常一样，我建议使用像[lxml.html](http://codespeak.net/lxml/lxmlhtml.html)这样的 html 解析器而不是正则表达式来从 html 文件中提取信息：

```
import lxml.html

tree = lxml.html.fromstring(htmlcode)
for link in tree.findall(".//a"):
    url = link.get("href")
    if url.endswith(".mp3"):
        print url 
```

# c# - .Net 2.0 频繁文件 I/O 导致 Vista 中出现 UnauthorizedAccessException

> ID：822262
> 
> 赞同：4
> 
> 时间：2009-05-04T21:52:38.887
> 
> 标签：c#, vb.net, windows-vista, windows-xp, unauthorized

在工作中，我们已经从 Windows XP 迁移到 Windows Vista。迁移后，我的一些使用 nUnit 的单元测试开始随机失败，并引发 System.UnauthorizedAccessException。每个失败的测试都涉及将用于测试的文件作为嵌入式资源存储在测试 DLL 中写入当前目录，运行测试，然后快速连续地删除它们，通常是在 setup/teardown 或 fixture setup/teardown 中。我这样做是为了让我的测试与每个开发人员驱动器上运行它们的位置无关，而不用担心相对文件路径。

在对此进行故障排除时，我发现它与文件的创建和删除有关。删除时，每个删除都遵循以下模式：

```
if( File.Exists(path) ) { File.Delete(path) } 
```

当我用 try-catch 块和 catch 上的断点包围它时（如果抛出异常），该文件将已经从磁盘中删除。对于文件创建失败，通常使用 XmlWriter 或 StreamWriter，如果文件存在，则分别指定覆盖文件。

奇怪的是，在调查时，我创建了这个似乎重新创建异常的 C# 程序：

```
class Program
{
    static void Main(string[] args)
    {
        int i = 0;
        try
        {              
            while (true)
            {
                System.IO.TextWriter writer = new System.IO.StreamWriter("file.txt");
                i++;
                System.Console.Out.WriteLine(i);
                writer.Write(i);
                writer.Close();
                System.IO.File.Delete("file.txt");
            }
        }
        catch (System.UnauthorizedAccessException ex)
        {
            System.Console.Out.WriteLine("Boom at: " + i.ToString());
        }

    }
} 
```

在我们的一台仍然有 XP 的机器上，它会不断迭代到数十万个，无一例外，直到我杀死它。在我们的任何 Vista 机器上，它会在 150 到 500 次迭代之间的任何地方打印“Boom”。

由于我在工作之余无法访问 Vista 机器，因此我无法确定这种特殊的“怪癖”是因为我的雇主对 Vista 的安全配置还是由于 Vista 本身。

可以说，我很困惑。

编辑：

我要感谢大家的回复。我使用了 Christian 建议的 Process Monitor，发现 Windows Vista SearchIndexer 和 TortoiseSVN 的 TSVNCache 进程在我的代码运行时尝试访问目标文件，正如 Martin 所建议的那样。

再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T06:55:03.263

在 vista 中，转到 Performace Monitor (controlpanrl->Administrative tools) 并观察应用程序运行时的虚拟字节（内存泄漏）。性能监视器为您提供了有关您要调查的进程的大量详细信息。我怀疑您的应用程序没有释放资源，因为它在文件系统上大量工作。

Also play around with performance monitor to try and see other measures that might have caused your issue. It is difficult to blame one or the other service with out doing little investigation.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T07:10:45.847

Could it be occassionally colliding with a background service, such a file indexing? Try switching off as many of these services as you can.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T23:29:42.740

你有任何病毒扫描程序吗？尝试禁用它们或从[http://www.sysinternals.com使用 ProcMon 观看文件活动](http://www.sysinternals.com)

# user-interface - 自动化 GUI 测试：与我们相遇

> ID：822275
> 
> 赞同：10
> 
> 时间：2009-05-04T21:55:18.193
> 
> 标签：user-interface, testing, selenium, automated-tests

我的任务是开发一个用于自动化 GUI 测试的系统，我可以使用一些建议。幸运的是，我们正在对我们的 GUI 进行重大重新设计，从事这项工作的开发人员愿意让他们的代码对自动化更加友好。我的问题是我不确定要他们添加什么。无论添加什么钩子都不会影响界面的功能、外观或安全性，也不会对性能产生明显影响。除此之外，天空才是极限！

有问题的应用程序是通过 AJAX 访问的基于 Web 的 Java 应用程序。大多数现有功能都是使用 jsp、Javascript 和一点点 Flash 8 编写的。下一波功能将使用[YUI Javascript 库](http://developer.yahoo.com/yui/)来完成。由于它的灵活性和价格标签（免费），我几乎将[Selenium作为一种测试工具。](http://seleniumhq.org/)要点：我的目标是测试可重用性和易于维护。我的偏好是编写检测、验证和练习页面元素的代码，而不是使用记录和回放系统进行测试开发。

谁能提供一些关于可以在代码中放置哪些钩子或一些最佳实践以使测试开发更容易并使测试本身更健壮的指导？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-08T05:27:08.363

基本指导原则：如果他们想让你测试一些东西，测试人员需要一种让应用程序进入该状态的方法，一旦进入该状态，就需要一种方法来验证该状态是否正确。

因此，首先要确保他们了解自动化就是编程，而 UI 就是您的 API。

*   同意不随意更改 UI——如果测试员 Bob 看到组件从按钮变为链接，并且符合规范，则单击并继续。虽然自动化中的代码更改相对容易，但可能必须在多个位置进行更改。（作为测试人员，您的工作是了解发生的变化并将维护成本降至最低；他们的工作是只进行重要的更改并了解影响）

*   一种确定您在哪个页面上的方法.... Bob 可以分辨登录和订单输入之间的区别，但是自动化如何知道呢？如果输入字段带有“用户名”标签，则为登录页面。如果输入字段带有订单号，则订单字段。

不好——更好的做法是使用一致的 UI 元素来标识页面——页面标题、隐藏组件等。

*   一种唯一标识您需要与之交互的每个元素（单击、输入、验证等）而不是 INPUT_42....

*   询问开发人员测试人员可以向他们提供哪些信息以加快调试速度，并要求他们将其放入日志文件中

*   能够转储程序的状态

*   一致的错误处理和报告（也只是好的 UI 设计）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T22:44:04.817

与大多数问题一样，这取决于。主要是关于您的网站的外观以及页面上的控件类型 - 是否有很多重复的元素等？

我使用 Selenium RC 和 Selenium IDE 取得了很大的成功。最主要的是习惯使用 Selenium 及其命令。习惯于在页面上定位对象（XPath 和 CSS 选择器，以及“包含”功能）也很有帮助。您不想要的是许多具有相同选择路径的元素。如果下面的表格和 div 没有独特的部分，它会给您的测试增加额外的复杂性。

```
<html>
  <body>
    <table>
      <tr>
        <td>
          <div></div>
          <div></div>
          <div></div>
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td>
          <div></div>
          <div></div>
          <div></div>
        </td>
      </tr>
    </table>
  </body>
</html> 
```

要测试图像，很高兴能够根据图像文件名以外的其他内容检查它们的存在，因此您不必在更新图像时更改测试。如果您需要测试 Flash 对象，[请查看此站点](http://code.google.com/p/flash-selenium/)。

除此之外，我没有注意到很多可以合并到开发方面的东西。一旦您开始设置测试并在页面上定位元素，您可能很快就会看到开发人员需要做些什么来帮助您。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-05T19:34:19.913

一条建议：将您的测试代码保持在**至少两层抽象中**：

1.  **上层**：这应该是某种面向特定应用程序术语/操作等的外观。该层**不**直接使用 Selenium RC 库。在后台它使用...
2.  ...**下层**：具有一些常见测试模式的库（例如：“*断言选择了单选按钮控件的值 X* ”），它使用 Selenium RC 库。

这样，您的测试将更易于维护，并且在测试内容方面更易于理解。我们甚至尝试了三层方法，[第三层（最上层）是使用 XML 指定的测试](http://code.google.com/p/projectpilot/wiki/AutomatedAcceptanceTesting)。这是为了让我们的非编程测试人员能够在不深入研究 C# 代码的情况下指定验收测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T14:43:26.883

添加到 McWafflestix 和 s_hewitt 的评论中 - gui 元素需要正确标记、独特且可预测，才能成功实现 gui 自动化。如果元素 id 不可预测，您将遇到麻烦。可预测并不一定意味着静态。对于像用户名字段或登录按钮这样的静态页面元素，我希望它们的名称/ID 从构建到构建和运行到运行都是静态的。对于复选框、单选按钮、动态内容，我希望它们是动态的，但可预测的。例如，您可能有一个带有 class = "contentdetail" 和 id = "12345" 的 div。只要您可以制作 xpath 以找到需要与之可靠交互的对象，您就应该很好。

编辑：开发人员支持测试自动化的一个好方法是使用测试设置。根据您的应用程序，自动化测试设置和拆卸可能会出现问题。例如，在仓库工作流应用程序中，工作流开始时的测试（接受物品进入仓库）很容易设置，但工作流结束时的测试（将物品从仓库运送到客户）有这样的设置许多依赖项（项目必须在仓库中，有足够的数量，在正确的库存位置等），您的大多数自动化代码可能只需通过应用程序导航和输入您的方式即可到达您可以执行的点一个测试。在这些情况下，使用某种外部实用程序（在应用程序之外，因此主 gui 不受影响）注入依赖项或将数据库重置为某个已知状态可能是有益的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T22:03:13.807

我对（正确的）单元测试很陌生，但是遇到了一些你应该尝试避免测试你的 GUI 的提及。他们通常会省略具体的原因，所以我无法真正支持他们。

我采用的方法（我认为 Juval Lowy 在“Programming .NET Components”中建议的方法）是尝试通过接口从 GUI 中抽象出实际代码，这让我可以为所有由触发的业务逻辑编写单元测试GUI 没有实际测试 GUI 本身。

它工作得很好，代码更简洁，业务逻辑与 GUI 分离得很好，也使 GUI 修改的压力大大减轻。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T22:12:10.557

开发人员可以添加到代码中来提供帮助的东西很少。

问题是，如果你想测试代码路径的执行和这些代码路径的有效性，那应该在单元测试中完成，并且应该完全脱离你的 GUI。但是如果你真的想测试你的 GUI，那么你只需要模拟用户输入。可以对此有所帮助的一件事是正确标记您的对象和控件，以便您的测试框架可以正确检测并执行它们。除此之外，没有什么可以做的（尽管这本身可以帮助很多）。

# cocoa - 如何使用 Cocoa 访问桌面上所有打开的窗口？

> ID：822297
> 
> 赞同：1
> 
> 时间：2009-05-04T21:59:28.713
> 
> 标签：cocoa

有没有办法控制 OS X 桌面上打开的窗口并更改每个窗口的属性，即大小或位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T22:06:36.217

不久前我对此进行了一些挖掘，但没有发现使用 Cocoa API 的真正方法。我认为您可能可以为此使用 Carbon，但我最终使用的是 Cocoa-AppleScript Bridge 来访问系统事件 AppleScript 字典，该字典具有表示应用程序进程、这些进程的窗口等的对象。

# php - 将 csv 保存为附件文件，PHP+Apache 设置不起作用

> ID：822301
> 
> 赞同：0
> 
> 时间：2009-05-04T22:00:43.343
> 
> 标签：php, csv, save, content-disposition

我有一个有趣的问题，我认为它与服务器有关。我希望在用户单击按钮时将 CSV 数据保存为 CSV 文件。它在我的开发服务器上运行良好，但在生产中它只是将内容回显到页面。我的猜测是它一定是服务器问题，但我真的不确定它可能是什么。GZIP 会影响这个吗？

我的标题代码如下：

```
header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
header("Content-Length: " . strlen($out));
header("Content-type: text/x-csv");
header("Content-Disposition: attachment; filename=$filename");
echo $out; 
```

所以上面的代码在开发服务器上工作，在生产环境中只会将 CSV 回显到页面。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T22:17:25.333

我唯一能想到的就是哑剧类型。从一台服务器移动到另一台服务器时，我遇到了一些 mime 类型（尤其是 .flv 文件）的问题。

我用于 .csv 文件的是`application/octet-stream`.

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T22:26:10.570

是的，我猜它也是哑剧类型。您可能想尝试使用 csv 特定的“text/csv”（[RFC 4180](https://www.rfc-editor.org/rfc/rfc4180#section-3)）或通用的“application/octet-stream”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T23:40:24.853

只需使用 Wireshark ( [http://www.wireshark.org](http://www.wireshark.org) ) 并捕获这两种情况的 HTTP 流量并寻找差异。提琴手也应该工作

# ruby-on-rails - 如何向已创建的控制器添加新操作？

> ID：822304
> 
> 赞同：3
> 
> 时间：2009-05-04T22:01:57.087
> 
> 标签：ruby-on-rails

我正在使用rails，我需要知道如何向我的控制器添加新动作，我是rails的初学者，所以我真的不知道我是否只是在controller.rb中输入“def action”还是他们更多的是?

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T22:08:21.673

不，就是这样……只需向控制器类添加一个方法，就会自动为该控制器创建一个新操作（至少在默认设置下）。

[在《 Beginning Ruby on Rails](http://books.google.com/books?id=BaWayIR0CvkC&pg=PA96&lpg=PA96&dq=rails+actions&source=bl&ots=Ju7EwCFdEX&sig=LzYRDfpbv686qWGVFiHtUEkhw24&hl=en&ei=aWf_SZqDFZu4sgPu07zqBQ&sa=X&oi=book_result&ct=result&resnum=5)》一书中有一小部分关于这个。此外，阅读 Ruby on Rails[入门指南](http://guides.rubyonrails.org/getting_started.html)可能会有所帮助。它证明了这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T22:27:20.380

好吧，这实际上取决于您的路由设置方式。如果它通过默认路由：

```
map.connect ':controller/:action/:id' 
```

然后你就没有别的事可做了（参见[ActionController::Routing](http://api.rubyonrails.org/classes/ActionController/Routing.html)）。

如果您使用的是 RESTful 资源，则需要在 routes.rb 文件中明确提及操作（和请求类型）（请参阅[ActionController::Resources](http://api.rubyonrails.org/classes/ActionController/Resources.html)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T02:26:20.320

除了在控制器中定义新方法外，您可能还需要设置视图。默认情况下，视图对应于控制器和操作名称。

因此，带有动作索引的控制器主要在以下位置查找模板：

```
views/main/index 
```

# path - 如何快速创建具有绝对路径的别名？

> ID：822310
> 
> 赞同：0
> 
> 时间：2009-05-04T22:03:17.520
> 
> 标签：path, alias, absolute-path

我在制作别名时经常犯错误：

```
ln -S $Personal/Books $Buy/Books      (1) 
```

相反，我必须编写整个路径才能使最后一个命令正常工作：

```
ln -S /Users/user/something/.../Books /Users/user/something/.../Books     (2) 
```

我真的很想得到类似于（1）的东西。做（2）非常耗时。如何快速创建别名的绝对路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T01:02:11.223

我假设在您的示例中，路径*Personal*和*Buy*都是您的主目录中的目录。然后您可以通过键入来创建相对符号链接

```
cd Buy
ln -s ../Personal/Books Books 
```

# vb.net - VB.NET 打开word文档

> ID：822318
> 
> 赞同：0
> 
> 时间：2009-05-04T22:07:18.040
> 
> 标签：vb.net

在 VB.NET 中如何打开 word/PDF 文档？我曾经有过代码，我记得它很短。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T22:13:19.290

假设注册了一个应用程序来处理 .PDF 或 .DOC 文件，您可以使用以下内容：

```
System.Diagnostics.Process.Start("C:\path\filename.pdf")
System.Diagnostics.Process.Start("C:\path\filename.doc")

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:24:28.837

您在考虑[VSTO](http://en.wikipedia.org/wiki/Visual_Studio_Tools_for_Office)（Visual Studio Tools for Office）吗？

# extjs - 如何在 ExtJS TreePanel 中找到选定的节点？

> ID：822319
> 
> 赞同：16
> 
> 时间：2009-05-04T22:07:18.773
> 
> 标签：extjs, treepanel

当用户单击按钮时，我正在尝试检索 TreePanel 的选定节点（如果有）。如何检索 TreePanel 中的选择节点？谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T13:19:37.363

您要做的是创建一个事件处理程序。每个 ExtJs 对象都有许多与它们自动关联的事件。您将编写一个事件处理程序（一个函数），然后您可以将其分配给一个事件侦听器。因此，在这种情况下，您可能希望为 TreePanel 组件的“单击”事件分配一个事件处理程序。

```
var tbPan = new Ext.tree.TreePanel({
    itemId:'navTree',
    autoScroll: true,
    root: new Ext.tree.TreeNode({
        id: 'root',
        text: 'My Tree Root',
        rootVisible: true
    }),
    listeners: {
        click: {
            fn:clickListener
        }
    }
});

clickListener = function (node,event){
    // The node argument represents the node that
    // was clicked on within your TreePanel
}; 
```

但是，如果你想知道一个已经被选中的节点会发生什么？此时您需要访问 TreePanel 的选择模型。你提到了一个按钮动作。假设您想对该按钮的单击处理程序应用一个函数以获取选定的节点：

```
var btn = new Ext.Button({
    text: 'Get Value',
    handler: function (thisBtn,event){
        var node = Ext.fly('navTree').getSelectionModel().getSelectedNode();
    }
}); 
```

您使用享元元素快速参考 TreePanel 本身，然后使用 TreePanel 的内部方法获取它的选择模型。之后，您使用该选择模型（在本例中为 DefaultSelectionModel）的内部方法来获取选定节点。

您将在 Ext JS 文档中找到大量信息。在线（和离线 AIR 应用程序）API 非常广泛。Ext Core 手册还可以让您深入了解 ExtJS 开发，即使您不直接使用 Core。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-19T09:02:52.233

```
var tree = Ext.create('Ext.tree.Panel', {
    store: store,
    renderTo: 'tree_el',
    height: 300,
    width: 250,
    title: 'ExtJS Tree PHP MySQL',
    tbar : [{
        text: 'get selected node',
        handler: function() {
            if (tree.getSelectionModel().hasSelection()) {
                var selectedNode = tree.getSelectionModel().getSelection();

                alert(selectedNode[0].data.text + ' was selected');
            } else {
                Ext.MessageBox.alert('No node selected!');
            }

        }

    }]

}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-04-30T16:01:32.577

在 Ext JS 4 中，您可以像这样在树面板上放置一个监听器：

```
listeners: {

    itemclick: {
        fn: function(view, record, item, index, event) {
            //the record is the data node that was clicked
            //the item is the html dom element in the tree that was clicked
            //index is the index of the node relative to its parent
            nodeId = record.data.id;
            htmlId = item.id;
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-11T06:11:17.670

```
var selectednode = tree.getSelectionModel().getSelectedNode();

                //alert(selectednode);
                if(selectednode!=tree.getRootNode())
                selectednode.remove(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-11-25T11:19:16.667

```
var nodesSelected = Ext.getCmp('foldersTree').getSelectionModel().selected.items;
if(nodesSelected.length > 0)
{
    var node = nodesSelected[0];
    console.log(node.internalId);
} 
```

这是用于 ExtJS4 TreePanel

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-04T13:15:02.127

对于 ExtJS 4...

我在树面板中添加了以下侦听器：

```
listeners: 
{
  itemclick: function(view, record, item, index, e)
  {
    selected_node = record;
  }
} 
```

其中 selected_node 是一个全局变量。可以将 append 和 remove 之类的函数与此记录变量一起使用，例如：

```
selected_node.appendChild({text: 'New Node', leaf: true});
selected_node.remove(); 
```

我已经为添加节点和删除节点创建了按钮，它们使用上述内容将节点附加和删除到所选节点。remove() 将删除选定的节点以及所有子节点！

您也可以随时使用（通过鼠标左键和右键单击进行选择）获取所选节点： var selected_node = Ext.getCmp('tree_id').getSelectionModel().getSelection()[0];

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-22T18:06:01.077

@史蒂夫

`Ext.fly('navTree').getSelectionModel().getSelectedNode();`

不会工作，使用

`Ext.getCmp('navTree').getSelectionModel().getSelectedNode();`

反而。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-11-08T10:18:00.107

在 ExtJS4 中，您可以使用 getLastSelected() 方法返回树中最后选择的项目。

见 ExtJS：[http ://docs.sencha.com/ext-js/4-0/#!/api/Ext.selection.Model-method-getLastSelected](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.selection.Model-method-getLastSelected)

一个示例可能如下所示：

```
var tree = this.up("window").down("supportedcontrolcircuitmodelselector");
var selectedCircuit = tree.getSelectionModel().getLastSelected() 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-06-29T10:50:27.607

```
var myTree = Ext.getCmp('tree-panel');
var selectednode = myTree.selModel.selNode 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-06T11:59:03.877

简单的 ....

```
itemclick: function(view, record, item, index, e)
{
   alert(record.data.text);
} 
```

# java - 如何实现具有多个键的 Map？

> ID：822322
> 
> 赞同：175
> 
> 时间：2009-05-04T22:07:39.117
> 
> 标签：java, data-structures

我需要一个行为类似于 Map 的数据结构，但使用多个（不同类型的）键来访问其值。
*（我们不要太笼统，我们说**两个**键）*

**密钥保证是唯一的。**

就像是：

```
MyMap<K1,K2,V> ... 
```

使用以下方法：

```
getByKey1(K1 key)...
getByKey2(K2 key)...
containsKey1(K1 key)...
containsKey2(K2 key)... 
```

**你有什么建议吗？**

我唯一能想到的是：
编写一个在内部使用两个 Map 的类。

**编辑** 有些人建议我使用**tuple**、 a **pair**或类似的键作为 Java 映射的键，但这对我**不起作用**：
如上所述，我必须能够仅通过两个键中的一个来搜索值指定的。
地图使用键的哈希码并检查它们的相等性。

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-05-04T22:14:48.163

两张地图。一个`Map<K1, V>`和一个`Map<K2, V>`。如果您必须有一个接口，请编写一个实现上述方法的包装类。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-05T01:32:26.393

Commons-collections 提供您正在寻找的内容： [https ://commons.apache.org/proper/commons-collections/apidocs/](https://commons.apache.org/proper/commons-collections/apidocs/)

看起来现在输入了 commons-collections 。

可以在以下位置找到打字版本： [https ://github.com/megamattron/collections-generic](https://github.com/megamattron/collections-generic)

这将完全支持您的用例：

```
 MultiKeyMap<k1,k2,...,kn,v> multiMap = ?? 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-05-04T23:57:50.037

我仍然会建议使用 2 地图解决方案，但需要注意的是

```
Map<K2, K1> m2;
Map<K1, V>  m1; 
```

此方案允许您拥有任意数量的关键“别名”。

它还允许您通过任何键更新值，而不会导致地图不同步。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2013-05-15T07:59:57.237

另一个解决方案是使用[Google 的 Guava](https://code.google.com/p/guava-libraries/wiki/CollectionUtilitiesExplained#Multimaps)

```
import com.google.common.collect.Table;
import com.google.common.collect.HashBasedTable;

Table<String, String, Integer> table = HashBasedTable.create(); 
```

用法很简单：

```
String row = "a";
String column = "b";
int value = 1;

if (!table.contains(row, column)) {
    table.put(row, column, value);
}

System.out.println("value = " + table.get(row, column)); 
```

该方法`HashBasedTable.create()`基本上是这样做的：

```
Table<String, String, Integer> table = Tables.newCustomTable(
        Maps.<String, Map<String, Integer>>newHashMap(),
        new Supplier<Map<String, Integer>>() {
    public Map<String, Integer> get() {
        return Maps.newHashMap();
    }
}); 
```

如果您正在尝试创建一些自定义地图，您应该选择第二个选项（正如@Karatheodory 建议的那样），否则您应该可以使用第一个选项。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-11-08T18:11:43.597

您如何声明以下“Key”类：

```
public class Key {
   public Object key1, key2, ..., keyN;

   public Key(Object key1, Object key2, ..., Object keyN) {
      this.key1 = key1;
      this.key2 = key2;
      ...
      this.keyN = keyN;
   }

   @Override   
   public boolean equals(Object obj) {
      if (!(obj instanceof Key))
        return false;
      Key ref = (Key) obj;
      return this.key1.equals(ref.key1) && 
          this.key2.equals(ref.key2) &&
          ...
          this.keyN.equals(ref.keyN)
   }

    @Override
    public int hashCode() {
        return key1.hashCode() ^ key2.hashCode() ^ 
            ... ^ keyN.hashCode();
    }

} 
```

声明地图

```
Map<Key, Double> map = new HashMap<Key,Double>(); 
```

声明关键对象

```
Key key = new Key(key1, key2, ..., keyN) 
```

填写地图

```
map.put(key, new Double(0)) 
```

从地图中获取对象

```
Double result = map.get(key); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-04T22:49:18.783

**正如一些回答者所建议的那样：**

```
public interface IDualMap<K1, K2, V> {

    /**
    * @return Unmodifiable version of underlying map1
    */
    Map<K1, V> getMap1();

    /**
    * @return Unmodifiable version of underlying map2
    */
    Map<K2, V> getMap2();

    void put(K1 key1, K2 key2, V value);

}

public final class DualMap<K1, K2, V>
        implements IDualMap<K1, K2, V> {

    private final Map<K1, V> map1 = new HashMap<K1, V>();

    private final Map<K2, V> map2 = new HashMap<K2, V>();

    @Override
    public Map<K1, V> getMap1() {
        return Collections.unmodifiableMap(map1);
    }

    @Override
    public Map<K2, V> getMap2() {
        return Collections.unmodifiableMap(map2);
    }

    @Override
    public void put(K1 key1, K2 key2, V value) {
        map1.put(key1, value);
        map2.put(key2, value);
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-06T19:21:01.997

为什么不直接放弃键必须是特定类型的要求，即只使用 Map<Object,V>。

有时泛型只是不值得额外的工作。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-10-10T11:59:08.670

我推荐这样的东西：

```
 public class MyMap {

      Map<Object, V> map = new HashMap<Object, V>();

      public V put(K1 key,V value){
        return map.put(key, value);
      }

      public V put(K2 key,V value){
        return map.put(key, value);
      }

      public V get(K1 key){    
        return map.get(key);
      }

      public V get(K2 key){    
        return map.get(key);
      }

      //Same for conatains

    } 
```

然后你可以像这样使用它：
`myMap.put(k1,value)`或者`myMap.put(k2,value)`

**优点**：简单，强制类型安全，并且不存储重复数据（就像两个地图解决方案一样，尽管仍然存储重复值）。
**缺点**：不通用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-04T22:40:39.240

我可以看到以下方法：

a) 使用 2 张不同的地图。您可以按照您的建议将它们包装在一个类中，但即使这样也可能是矫枉过正。直接使用地图：key1Map.getValue(k1), key2Map.getValue(k2)

b）您可以创建一个类型感知的密钥类，并使用它（未经测试）。

```
public class Key {
  public static enum KeyType { KEY_1, KEY_2 }

  public final Object k;
  public final KeyType t;

  public Key(Object k, KeyType t) {
    this.k = k;
    this.t= t;
  }

  public boolean equals(Object obj) {
    KeyType kt = (KeyType)obj;
    return k.equals(kt.k) && t == kt.t;
  }

  public int hashCode() {
   return k.hashCode() ^ t.hashCode();
  }
} 
```

顺便说一句，在很多常见的情况下，空间`key1`和空间`key2`不相交。在这种情况下，您实际上不需要做任何特别的事情。只需定义一个包含条目的映射`key1=>v`以及`key2=>v`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-01-07T07:52:33.503

sol: 连接两个键并制作一个最终键，将其用作键。

对于键值，

将 ket-1 和 key-2 与 beetween 中的 " , " 连接起来，将其用作原始密钥。

键 = 键 1 + "," + 键 2；

myMap.put(key,value);

在检索值时类似。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-02-02T15:22:12.403

所有多键都可能失败，导​​致 put([key1, key2], val) 和 get([null, key2]) 最终使用 [key1, key2] 和 [null, key2] 的等号。如果支持映射不包含每个键的哈希桶，那么查找真的很慢。

我认为要走的路是使用索引装饰器（请参见上面的 key1、key2 示例），如果额外的索引键是存储值的属性，则可以在放置时使用属性名称和反射来构建辅助映射（键, val) 并添加一个额外的方法 get(propertyname, propertyvalue) 来使用该索引。

get(propertyname, propertyvalue) 的返回类型可以是一个集合，所以即使没有唯一键被索引......

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-02-04T23:08:51.827

我创建它是为了解决类似的问题。

数据结构

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;

public class HashBucket {
    HashMap<Object, ArrayList<Object>> hmap;

    public HashBucket() {
        hmap = new HashMap<Object, ArrayList<Object>>();
    }

    public void add(Object key, Object value) {
        if (hmap.containsKey(key)) {
            ArrayList al = hmap.get(key);
            al.add(value);
        } else {
            ArrayList al = new ArrayList<Object>();
            al.add(value);
            hmap.put(key, al);
        }
    }

    public Iterator getIterator(Object key) {
        ArrayList al = hmap.get(key);
        return hmap.get(key).iterator();

    }

} 
```

检索一个值：

（注意*将对象转换回插入的类型。在我的情况下，它是我的事件对象）

```
 public Iterator getIterator(Object key) {
        ArrayList al = hmap.get(key);
        if (al != null) {
            return hmap.get(key).iterator();
        } else {
            List<Object> empty = Collections.emptyList();
            return empty.iterator();
        }

    } 
```

插入

```
Event e1 = new Event();
e1.setName("Bob");
e1.setTitle("Test");
map.add("key",e1); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-04T22:13:51.050

听起来像一个 Python 元组。遵循这种精神，您可以创建自己设计的不可变类，实现 Comparable 并且您将拥有它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-03-06T19:27:17.120

我将这样的实现用于多个关键对象。它允许我使用无数的键来映射。它是可扩展的并且非常简单。但它有局限性：键是根据构造函数中的参数顺序排序的，并且由于使用 Arrays.equals()，它不适用于 2D 数组。要修复它 - 你可以使用 Arrays.deepEquals();

希望它会帮助你。如果您知道为什么它不能用作此类问题的解决方案 - 请告诉我！

```
public class Test {

    private static Map<InnumerableKey, Object> sampleMap = new HashMap<InnumerableKey, Object>();

    private static class InnumerableKey {

        private final Object[] keyParts;

        private InnumerableKey(Object... keyParts) {
            this.keyParts = keyParts;
        }

        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (!(o instanceof InnumerableKey)) return false;

            InnumerableKey key = (InnumerableKey) o;

            if (!Arrays.equals(keyParts, key.keyParts)) return false;

            return true;
        }

        @Override
        public int hashCode() {
            return keyParts != null ? Arrays.hashCode(keyParts) : 0;
        }
    }

    public static void main(String... args) {
        boolean keyBoolean = true;
        double keyDouble = 1d;
        Object keyObject = new Object();

        InnumerableKey doubleKey = new InnumerableKey(keyBoolean, keyDouble);
        InnumerableKey tripleKey = new InnumerableKey(keyBoolean, keyDouble, keyObject);

        sampleMap.put(doubleKey, "DOUBLE KEY");
        sampleMap.put(tripleKey, "TRIPLE KEY");

        // prints "DOUBLE KEY"
        System.out.println(sampleMap.get(new InnumerableKey(true, 1d)));
        // prints "TRIPLE KEY"
        System.out.println(sampleMap.get(new InnumerableKey(true, 1d, keyObject)));
        // prints null
        System.out.println(sampleMap.get(new InnumerableKey(keyObject, 1d, true)));
    }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-10-24T18:59:19.337

像这样的东西怎么样：

他的声明说键是唯一的，因此很有可能针对不同的键保存相同的值对象，并且当您发送与所述值匹配的任何键时，我们将能够返回值对象。

请参见下面的代码：

一个值对象类，

```
 public class Bond {
    public Bond() {
        System.out.println("The Name is Bond... James Bond...");
    }
    private String name;
    public String getName() { return name;}
    public void setName(String name) { this.name = name; }
}

public class HashMapValueTest {

    public static void main(String[] args) {

        String key1 = "A";
        String key2 = "B";
        String key3 = "C";

        Bond bond = new Bond();
        bond.setName("James Bond Mutual Fund");

        Map<String, Bond> bondsById = new HashMap<>();

        bondsById.put(key1, bond);
        bondsById.put(key2, bond);
        bondsById.put(key3, bond);

        bond.setName("Alfred Hitchcock");

        for (Map.Entry<String, Bond> entry : bondsById.entrySet()) {
            System.out.println(entry.getValue().getName());
        }

    }

} 
```

结果是：

```
The Name is Bond... James Bond...

Alfred HitchCock

Alfred HitchCock

Alfred HitchCock 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-07-23T09:33:32.767

如果键是唯一的，则不需要 2 个映射、映射映射、mapOfWhateverThereIs。只需要一个单一的地图和一个简单的包装方法，将您的键和值放入该地图。例子：

```
Map<String, String> map = new HashMap<>();

public void addKeysAndValue(String key1, String key2, String value){
    map.put(key1, value);
    map.put(key2, value);
}

public void testIt(){
    addKeysAndValue("behemoth", "hipopotam", "hornless rhino");
} 
```

然后像往常一样使用您的地图。你甚至不需要那些花哨的 getByKeyN 和 containsKeyN。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-09-02T18:17:10.437

来自 Commons 或 Guava 的 MultiMap 或 MultiKeyMap 都可以使用。

但是，考虑到键是原始类型，一个快速简单的解决方案可能是扩展 Map 类购买自己处理复合键。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-04T22:11:33.427

定义一个具有 K1 和 K2 实例的类。然后将其用作类作为您的键类型。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-04T22:11:55.813

见[谷歌收藏](http://code.google.com/p/google-collections/)。或者，正如您所建议的，在内部使用地图，并让该地图使用一对。你必须写或找到 Pair<>; 这很容易，但不是标准集合的一部分。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-04T22:18:43.550

听起来您的解决方案非常适合这种需求，如果您的两种密钥类型确实不同，我真的认为它没有问题。只需确保您为此编写自己的实现并在需要时处理同步问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-04T22:19:27.013

如果您打算使用多个键的组合作为一个，那么也许 apache commnons [**MultiKey**](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/keyvalue/MultiKey.html)是您的朋友。我不认为它会一个接一个地起作用..

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-05-04T23:56:30.510

根据它的使用方式，您可以使用两张地图`Map<K1, V>`和`Map<K2, V>`或者使用两张地图`Map<K1, V>`和`Map<K2, K1>`。如果其中一个键比另一个更永久，则第二个选项可能更有意义。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-05-05T00:53:04.490

在我看来，您在问题中想要的方法由 Map 直接支持。你似乎想要的是

```
put(K1 key, K2 key, V value)
put(K1 key, V value)
put(K2 key, V value) 
```

请注意，在 map`get()`等中`containsKey()`都带有`Object`参数。没有什么可以阻止您使用一种`get()`方法委托给您组合的所有复合地图（如您的问题和其他答案中所述）。也许您需要类型注册，这样您就不会遇到类转换问题（如果它们是特殊的 + 天真地实现的话。

基于类型的注册还允许您检索要使用的“正确”映射：

```
Map<T,V> getMapForKey(Class<T> keyClass){
  //Completely naive implementation - you actually need to 
  //iterate through the keys of the maps, and see if the keyClass argument
  //is a sub-class of the defined map type.  And then ordering matters with 
  //classes that implement multiple interfaces...
  Map<T,V> specificTypeMap = (Map<T,V) maps.get(keyClass);
  if (specificTypeMap == null){
     throw new IllegalArgumentException("There is no map keyed by class" + keyClass);
  }
  return maps.get(keyClass);
}

V put(Object key, V value) {
  //This bit requires generic suppression magic - but 
  //nothing leaves this class and you're testing it right? 
  //(You can assert that it *is* type-safe)
  Map map = getMapForKey(key.getClass());
  map.put(object, key);
}

void put(Object[] keys, V value) { //Or put(V value, Object ... keys)
   //Might want to catch exceptions for unsupported keys and log instead?
   .....
} 
```

只是一些想法...

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-08-20T22:03:15.710

我建议结构

```
Map<K1, Map<K2, V>> 
```

虽然搜索第二个键可能效率不高

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-04-19T16:26:43.480

另一种提供更复杂键的可能性的解决方案可以在这里找到：http: [//insidecoffe.blogspot.de/2013/04/indexable-hashmap-implementation.html](http://insidecoffe.blogspot.de/2013/04/indexable-hashmap-implementation.html)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-12-05T18:42:23.653

使用 trie 数据结构怎么样？

[http://en.wikipedia.org/wiki/Trie](http://en.wikipedia.org/wiki/Trie)

trie 的根为空白。第一级兄弟姐妹将是您的地图的主键，第二级兄弟姐妹将是您的辅助键，第三级将是终端节点，其值为 null 以指示该分支的终止。您还可以使用相同的方案添加两个以上的密钥。

查找是简单的 DFS。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-06-18T21:31:52.430

一个肮脏而简单的解决方案，如果您仅使用映射进行排序，可以说是向键添加一个非常小的值，直到该值不存在，但不要添加最小值（例如 Double.MIN_VALUE），因为它会导致错误。就像我说的，这是一个非常肮脏的解决方案，但它使代码更简单。

# c - 如何在 C 中生成随机整数？

> ID：822323
> 
> 赞同：642
> 
> 时间：2009-05-04T22:07:59.787
> 
> 标签：c, random

是否有在 C 中生成随机 int 数的函数？还是我必须使用第三方库？

* * *

## 回答 #1

> 赞同：779
> 
> 时间：2009-05-04T22:18:36.453

> **注意**：不要`rand()`用于安全。如果您需要加密安全号码，[请参阅此答案](https://stackoverflow.com/a/39475626/2224584)。

```
#include <time.h>
#include <stdlib.h>

srand(time(NULL));   // Initialization, should only be called once.
int r = rand();      // Returns a pseudo-random integer between 0 and RAND_MAX. 
```

在 Linux 上，您可能更喜欢使用[random 和 srandom](https://linux.die.net/man/3/random)。

* * *

## 回答 #2

> 赞同：276
> 
> 时间：2009-05-04T22:17:27.283

中的`rand()`函数`<stdlib.h>`返回一个介于 0 和 之间的伪随机整数`RAND_MAX`。您可以使用`srand(unsigned int seed)`来设置种子。

通常的做法是`%`结合使用运算符`rand()`来获得不同的范围（尽管请记住，这会在一定程度上影响一致性）。例如：

```
/* random int between 0 and 19 */
int r = rand() % 20; 
```

如果你*真的*关心一致性，你可以这样做：

```
/* Returns an integer in the range [0, n).
 *
 * Uses rand(), and so is affected-by/affects the same seed.
 */
int randint(int n) {
  if ((n - 1) == RAND_MAX) {
    return rand();
  } else {
    // Supporting larger values for n would requires an even more
    // elaborate implementation that combines multiple calls to rand()
    assert (n <= RAND_MAX)

    // Chop off all of the values that would cause skew...
    int end = RAND_MAX / n; // truncate skew
    assert (end > 0);
    end *= n;

    // ... and ignore results from rand() that fall above that limit.
    // (Worst case the loop condition should succeed 50% of the time,
    // so we can expect to bail out of this loop pretty quickly.)
    int r;
    while ((r = rand()) >= end);

    return r % n;
  }
} 
```

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2016-09-13T17:16:22.953

### 如果您需要安全的随机字符或整数：

如[如何在各种编程语言中安全地生成随机数中](https://paragonie.com/blog/2016/05/how-generate-secure-random-numbers-in-various-programming-languages#c-csprng)所述，您需要执行以下操作之一：

*   使用[libsodium](https://github.com/jedisct1/libsodium)的`randombytes`API
*   非常小心地从[libsodium 的 sysrandom 实现](https://github.com/jedisct1/libsodium/blob/master/src/libsodium/randombytes/sysrandom/randombytes_sysrandom.c)中重新实现你需要的东西
*   更广泛地说，[使用`/dev/urandom`](http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/)，而不是`/dev/random`。不是 OpenSSL（或其他用户空间 PRNG）。

例如：

```
#include "sodium.h"

int foo()
{
    char myString[32];
    uint32_t myInt;

    if (sodium_init() < 0) {
        /* panic! the library couldn't be initialized, it is not safe to use */
        return 1; 
    }

    /* myString will be an array of 32 random bytes, not null-terminated */        
    randombytes_buf(myString, 32);

    /* myInt will be a random number between 0 and 9 */
    myInt = randombytes_uniform(10);
} 
```

`randombytes_uniform()`在密码学上是安全且无偏见的。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-01-30T07:41:02.063

让我们来看看这个。首先，我们使用该`srand()`函数来播种随机发生器。基本上，计算机可以根据输入的数字生成随机数`srand()`。如果您给出相同的种子值，那么每次都会生成相同的随机数。

因此，我们必须使用一个始终在变化的值来为随机发生器播种。我们通过用`time()`函数向它提供当前时间的值来做到这一点。

现在，当我们调用 时`rand()`，每次都会产生一个新的随机数。

```
 #include <stdio.h>

    int random_number(int min_num, int max_num);

    int main(void)
    {
        printf("Min : 1 Max : 40 %d\n", random_number(1,40));
        printf("Min : 100 Max : 1000 %d\n",random_number(100,1000));
        return 0;
    }

    int random_number(int min_num, int max_num)
    {
        int result = 0, low_num = 0, hi_num = 0;

        if (min_num < max_num)
        {
            low_num = min_num;
            hi_num = max_num + 1; // include max_num in output
        } else {
            low_num = max_num + 1; // include max_num in output
            hi_num = min_num;
        }

        srand(time(NULL));
        result = (rand() % (hi_num - low_num)) + low_num;
        return result;
    } 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-05-31T08:14:18.173

如果您需要比`stdlib`提供的质量更好的伪随机数，请查看[**Mersenne Twister**](http://en.wikipedia.org/wiki/Mersenne_twister)。它也更快。示例实现很丰富，例如[这里](http://www.cs.hmc.edu/~geoff/mtwist.html)。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-07-08T01:34:55.400

标准 C 函数是`rand()`. 为纸牌发牌已经足够了，但它很糟糕。许多`rand()`循环的实现通过一个简短的数字列表，并且低位具有更短的循环。一些程序调用的方式`rand()`很糟糕，计算一个好的种子传递给`srand()`它是困难的。

在 C 中生成随机数的最佳方法是使用第三方库，如 OpenSSL。例如，

```
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <openssl/rand.h>

/* Random integer in [0, limit) */
unsigned int random_uint(unsigned int limit) {
    union {
        unsigned int i;
        unsigned char c[sizeof(unsigned int)];
    } u;

    do {
        if (!RAND_bytes(u.c, sizeof(u.c))) {
            fprintf(stderr, "Can't get random bytes!\n");
            exit(1);
        }
    } while (u.i < (-limit % limit)); /* u.i < (2**size % limit) */
    return u.i % limit;
}

/* Random double in [0.0, 1.0) */
double random_double() {
    union {
        uint64_t i;
        unsigned char c[sizeof(uint64_t)];
    } u;

    if (!RAND_bytes(u.c, sizeof(u.c))) {
        fprintf(stderr, "Can't get random bytes!\n");
        exit(1);
    }
    /* 53 bits / 2**53 */
    return (u.i >> 11) * (1.0/9007199254740992.0);
}

int main() {
    printf("Dice: %d\n", (int)(random_uint(6) + 1));
    printf("Double: %f\n", random_double());
    return 0;
} 
```

为什么这么多代码？Java 和 Ruby 等其他语言具有随机整数或浮点数的函数。OpenSSL 只提供随机字节，所以我尝试模仿 Java 或 Ruby 如何将它们转换为整数或浮点数。

对于整数，我们要避免*模偏差*。假设我们从 中得到一些随机的 4 位整数`rand() % 10000`，但`rand()`只能返回 0 到 32767（就像在 Microsoft Windows 中一样）。从 0 到 2767 的每个数字比从 2768 到 9999 的每个数字出现的频率更高。为了消除偏差，我们可以`rand()`在值低于 2768 时重试，因为从 2768 到 32767 的 30000 个值均匀映射到从 0 到 10000 个值9999。

对于浮点数，我们需要 53 个随机位，因为 a`double`拥有 53 位精度（假设它是 IEEE 双精度）。如果我们使用超过 53 位，我们就会得到舍入偏差。一些程序员编写类似 的代码`rand() / (double)RAND_MAX`，但`rand()`可能只返回 31 位，或者在 Windows 中只返回 15 位。

OpenSSL 的`RAND_bytes()`种子本身，也许是通过`/dev/urandom`在 Linux 中阅读。如果我们需要很多随机数，那么从 中读取它们会太慢`/dev/urandom`，因为它们必须从内核中复制。允许 OpenSSL 从种子中生成更多随机数会更快。

更多关于随机数：

*   [Perl 的 Perl_seed()](https://github.com/Perl/perl5/blob/v5.22.0/util.c#L4487)是如何在 C 中计算种子的示例`srand()`。如果无法读取，它会混合来自当前时间、进程 ID 和一些指针的位`/dev/urandom`。
*   [OpenBSD 的 arc4random_uniform()](http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/lib/libc/crypt/arc4random_uniform.c?rev=1.1&content-type=text/x-cvsweb-markup)解释了模偏差。
*   [java.util.Random 的 Java API](http://docs.oracle.com/javase/8/docs/api/java/util/Random.html)描述了从随机整数中消除偏差并将 53 位打包成随机浮点数的算法。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-08-08T22:38:17.087

如果您的系统支持该[`arc4random`](https://linux.die.net/man/3/arc4random)系列功能，我建议您使用这些功能而不是标准`rand`功能。

该`arc4random`家庭包括：

```
uint32_t arc4random(void)
void arc4random_buf(void *buf, size_t bytes)
uint32_t arc4random_uniform(uint32_t limit)
void arc4random_stir(void)
void arc4random_addrandom(unsigned char *dat, int datlen) 
```

`arc4random`返回一个随机的 32 位无符号整数。

`arc4random_buf`将随机内容放入其参数`buf : void *`中。内容量由`bytes : size_t`参数决定。

`arc4random_uniform`返回一个随机的 32 位无符号整数，它遵循以下规则：`0 <= arc4random_uniform(limit) < limit`，其中 limit 也是一个无符号 32 位整数。

`arc4random_stir`从中读取数据`/dev/urandom`并将数据传递给以`arc4random_addrandom`另外随机化其内部随机数池。

`arc4random_addrandom`用于`arc4random_stir`根据传递给它的数据填充其内部随机数池。

如果您没有这些功能，但您使用的是 Unix，那么您可以使用以下代码：

```
/* This is C, not C++ */
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <errno.h>
#include <unistd.h>
#include <stdlib.h> /* exit */
#include <stdio.h> /* printf */

int urandom_fd = -2;

void urandom_init() {
  urandom_fd = open("/dev/urandom", O_RDONLY);

  if (urandom_fd == -1) {
    int errsv = urandom_fd;
    printf("Error opening [/dev/urandom]: %i\n", errsv);
    exit(1);
  }
}

unsigned long urandom() {
  unsigned long buf_impl;
  unsigned long *buf = &buf_impl;

  if (urandom_fd == -2) {
    urandom_init();
  }

  /* Read sizeof(long) bytes (usually 8) into *buf, which points to buf_impl */
  read(urandom_fd, buf, sizeof(long));
  return buf_impl;
} 
```

该`urandom_init`函数打开`/dev/urandom`设备，并将文件描述符放入`urandom_fd`.

该`urandom`函数与对 的调用基本相同`rand`，除了更安全之外，它返回一个`long`（易于更改）。

但是，`/dev/urandom`可能会有点慢，因此建议您将其用作不同随机数生成器的种子。

如果您的系统没有`/dev/urandom`，但*确实*有`/dev/random`或类似的文件，那么您可以简单地更改传递给`open`in的路径`urandom_init`。使用的调用和 API`urandom_init`和`urandom`（我相信）符合 POSIX 标准，因此，应该适用于大多数（如果不是全部）符合 POSIX 标准的系统。

注意：如果可用的熵不足，则读取`/dev/urandom`不会阻塞，因此在这种情况下生成的值可能在密码学上是不安全的。如果您对此感到担心，请使用`/dev/random`，如果熵不足，它将始终阻塞。

如果您在另一个系统（即 Windows）上，则使用`rand`或某些内部 Windows 特定平台相关的非可移植 API。

`urandom`、`rand`或`arc4random`调用的包装函数：

```
#define RAND_IMPL /* urandom(see large code block) | rand | arc4random */

int myRandom(int bottom, int top){
    return (RAND_IMPL() % (top - bottom)) + bottom;
} 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-05-04T22:10:47.160

C 不存在 STL。您必须调用`rand`，或者更好的是，`random`。这些在标准库头文件中声明`stdlib.h`。`rand`是 POSIX，`random`是一个 BSD 规范函数。

`rand`和之间的区别在于`random`它`random`返回一个更有用的 32 位随机数，并且`rand`通常返回一个 16 位数字。BSD 联机帮助页显示 的低位`rand`是循环且可预测的，因此`rand`对于小数字可能无用。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-05-04T22:18:23.583

看看[ISAAC](http://burtleburtle.net/bob/rand/isaacafa.html)（间接、移位、累加、加和计数）。其分布均匀，平均循环长度为 2^8295。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-08-27T22:27:46.337

这是在您选择的两个数字之间获取随机数的好方法。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

    #define randnum(min, max) \
        ((rand() % (int)(((max) + 1) - (min))) + (min))

int main()
{
    srand(time(NULL));

    printf("%d\n", randnum(1, 70));
} 
```

第一次输出：39

第二次输出：61

第三次输出：65

您可以将之后的值更改为`randnum`您选择的任何数字，它会在这两个数字之间为您生成一个随机数。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-05-04T22:14:59.957

你想用`rand()`. 注意（**非常重要**）：确保为 rand 函数设置种子。如果你不这样做，你的随机数就**不是真正的随机**数。这是非常非常非常重要的。值得庆幸的是，您通常可以使用系统滴答计时器和日期的某种组合来获得好种子。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-05-04T22:17:28.610

FWIW，答案是肯定的，有一个`stdlib.h`函数叫做`rand`; 此功能主要针对速度和分布进行调整，而不是针对不可预测性。几乎所有各种语言和框架的内置随机函数都默认使用此函数。还有一些“加密”随机数生成器，它们的可预测性要低得多，但运行速度要慢得多。这些应该用于任何类型的安全相关应用程序。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-08-27T10:17:25.620

希望这比仅使用`srand(time(NULL))`.

```
#include <time.h>
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv)
{
    srand((unsigned int)**main + (unsigned int)&argc + (unsigned int)time(NULL));
    srand(rand());

    for (int i = 0; i < 10; i++)
        printf("%d\n", rand());
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2017-01-16T16:33:18.167

在我最近的应用程序中，我遇到了一个伪随机数生成器的严重问题：我通过 Python 脚本反复调用我的 C 程序，并使用以下代码作为种子：

```
srand(time(NULL)) 
```

但是，由于：

*   rand 将生成相同的伪随机序列，并在 srand 中给出相同的种子（请参阅`man srand`）；
*   如前所述，时间函数仅在秒之间发生变化：如果您的应用程序在同一秒内多次运行，`time`则每次都将返回相同的值。

我的程序生成了相同的数字序列。你可以做 3 件事来解决这个问题：

1.  将时间输出与运行时更改的其他一些信息混合（在我的应用程序中，输出名称）：

    ```
    srand(time(NULL) | getHashOfString(outputName)) 
    ```

    我使用[djb2](http://www.cse.yorku.ca/%7Eoz/hash.html)作为我的哈希函数。

2.  提高时间分辨率。在我的平台上，`clock_gettime`可用，所以我使用它：

    ```
    #include<time.h>
    struct timespec nanos;
    clock_gettime(CLOCK_MONOTONIC, &nanos)
    srand(nanos.tv_nsec); 
    ```

3.  同时使用这两种方法：

    ```
    #include<time.h>
    struct timespec nanos;
    clock_gettime(CLOCK_MONOTONIC, &nanos)
    srand(nanos.tv_nsec | getHashOfString(outputName)); 
    ```

选项 3 确保您（据我所知）最好的种子随机性，但它可能只会在非常快速的应用程序中产生差异。在我看来，选项 2 是一个安全的选择。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2017-08-22T04:07:37.793

**C程序生成9到50之间的随机数**

```
#include <time.h>
#include <stdlib.h>

int main()
{
    srand(time(NULL));
    int lowerLimit = 10, upperLimit = 50;
    int r =  lowerLimit + rand() % (upperLimit - lowerLimit);
    printf("%d", r);
} 
```

**一般我们可以在lowerLimit和upperLimit-1**之间生成一个随机数

 **即 lowerLimit 是包容性的，或者说**r ∈ [ lowerLimit, upperLimit )**

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-05-04T22:13:27.167

好吧，STL 是 C++，而不是 C，所以我不知道你想要什么。但是，如果您想要 C，则有`rand()`and`srand()`函数：

```
int rand(void);

void srand(unsigned seed); 
```

这些都是 ANSI C 的一部分。还有以下`random()`功能：

```
long random(void); 
```

但据我所知，`random()`不是标准的 ANSI C。第三方库可能不是一个坏主意，但这完全取决于您真正需要生成的数字的随机程度。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-11-23T19:36:12.040

`rand()`是生成随机数最方便的方法。

您还可以从任何在线服务（如 random.org）中捕获随机数。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-11-14T20:21:20.333

```
#include <stdio.h>
#include <stdlib.h>

void main() 
{
    int visited[100];
    int randValue, a, b, vindex = 0;

    randValue = (rand() % 100) + 1;

    while (vindex < 100) {
        for (b = 0; b < vindex; b++) {
            if (visited[b] == randValue) {
                randValue = (rand() % 100) + 1;
                b = 0;
            }
        }

        visited[vindex++] = randValue;
    }

    for (a = 0; a < 100; a++)
        printf("%d ", visited[a]);
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-11-13T19:24:43.543

在现代 x86_64 CPU 上，您可以通过以下方式使用硬件随机数生成器[`_rdrand64_step()`](https://software.intel.com/sites/landingpage/IntrinsicsGuide/#expand=5212,1794,594,533,533,3146,5223,5218,5213,5226,5224,4642,3170,3170,3170,2670,4708,5068,5661,740,740,5459,5495,568,594,3889,390,3567,3576,3923,5553,2381,4929,201,406,694,4602,5003,5098,555,5089,4648,4642,5105,4893,555,5159,5340,5340,5340,307,1481,3625,415,1481,5720,325,318,280,1725,435,2399,5483,5513,3250,443,576,579,4070,441,439,5532,5534,397,391,579,395,397,551,30,4953,4677,2399,4247,4247&techs=AVX,AVX2,FMA,Other&text=random)

示例代码：

```
#include <immintrin.h>

uint64_t randVal;
if(!_rdrand64_step(&randVal)) {
  // Report an error here: random number generation has failed!
}
// If no error occured, randVal contains a random 64-bit number 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2014-02-24T09:08:51.207

```
#include <stdio.h>
#include <dos.h>

int random(int range);

int main(void)
{
    printf("%d", random(10));
    return 0;
}

int random(int range)
{
    struct time t;
    int r;

    gettime(&t);
    r = t.ti_sec % range;
    return r;
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-11-17T17:46:37.870

尽管这里有所有人的建议，但除非必须，否则您`rand()`不想使用`rand()`！产生的随机数`rand()`通常非常糟糕。引用 Linux 手册页：

> `rand()`Linux C 库中的和版本`srand()`使用与 和 相同的随机数生成器`random(3)`，`srandom(3)`因此低位应该与高位一样随机。但是，在较旧的 rand() 实现中，以及在不同系统上的当前实现中，*低阶位的随机性远低于高阶位*。当需要良好的随机性时，请勿在旨在可移植的应用程序中使用此功能。（改为**使用`random(3)`。**）

关于可移植性，`random()`POSIX 标准也定义了相当长的一段时间。`rand()`较旧，它已经出现在第一个 POSIX.1 规范（IEEE Std 1003.1-1988）中，而`random()`首次出现在 POSIX.1-2001（IEEE Std 1003.1-2001）中，但当前的 POSIX 标准已经是 POSIX.1-2008 （IEEE Std 1003.1-2008），一年前才收到更新（IEEE Std 1003.1-2008，2016 版）。所以我认为`random()`它非常便携。

POSIX.1-2001 还介绍了`lrand48()`and`mrand48()`函数，[见这里](http://pubs.opengroup.org/onlinepubs/9699919799/functions/seed48.html)：

> 该系列函数应使用线性同余算法和 48 位整数运算生成伪随机数。

相当不错的伪随机源是`arc4random()`许多系统上可用的功能。不是任何官方标准的一部分，1997 年左右出现在 BSD 中，但你可以在 Linux 和 macOS/iOS 等系统上找到它。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-08-22T06:58:04.627

```
#include<stdio.h>
#include<stdlib.h>
#include<time.h>

//generate number in range [min,max)
int random(int min, int max){
    int number = min + rand() % (max - min);
    return number; 
}

//Driver code
int main(){
    srand(time(NULL));
    for(int i = 1; i <= 10; i++){
        printf("%d\t", random(10, 100));
    }
    return 0;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-10-20T03:39:54.760

听到一个很好的解释为什么使用`rand()`在给定范围内产生均匀分布的随机数是一个坏主意，我决定看看输出实际上是如何倾斜的。我的测试用例是公平的掷骰子。这是C代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int main(int argc, char *argv[])
{
    int i;
    int dice[6];

    for (i = 0; i < 6; i++) 
      dice[i] = 0;
    srand(time(NULL));

    const int TOTAL = 10000000;
    for (i = 0; i < TOTAL; i++)
      dice[(rand() % 6)] += 1;

    double pers = 0.0, tpers = 0.0;
    for (i = 0; i < 6; i++) {
      pers = (dice[i] * 100.0) / TOTAL;
      printf("\t%1d  %5.2f%%\n", dice[i], pers);
      tpers += pers;
    }
    printf("\ttotal:  %6.2f%%\n", tpers);
} 
```

这是它的输出：

```
 $ gcc -o t3 t3.c
 $ ./t3 
        1666598  16.67%     
        1668630  16.69%
        1667682  16.68%
        1666049  16.66%
        1665948  16.66%
        1665093  16.65%
        total:  100.00%
 $ ./t3     
        1667634  16.68%
        1665914  16.66%
        1665542  16.66%
        1667828  16.68%
        1663649  16.64%
        1669433  16.69%
        total:  100.00% 
```

我不知道你需要你的随机数有多统一，但上面的内容似乎足以满足大多数需求。

编辑：最好用比`time(NULL)`.

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-10-02T18:48:42.550

对于 Linux C 应用程序：

这是我从上面的答案中修改的代码，它遵循我的 C 代码实践并返回任意大小的随机缓冲区（具有正确的返回代码等）。确保`urandom_open()`在程序开始时调用一次。

```
int gUrandomFd = -1;

int urandom_open(void)
{
    if (gUrandomFd == -1) {
        gUrandomFd = open("/dev/urandom", O_RDONLY);
    }

    if (gUrandomFd == -1) {
        fprintf(stderr, "Error opening /dev/urandom: errno [%d], strerrer [%s]\n",
                  errno, strerror(errno));
        return -1;
    } else {
        return 0;
    }
}

void urandom_close(void)
{
    close(gUrandomFd);
    gUrandomFd = -1;
}

//
// This link essentially validates the merits of /dev/urandom:
// http://sockpuppet.org/blog/2014/02/25/safely-generate-random-numbers/
//
int getRandomBuffer(uint8_t *buf, int size)
{
    int ret = 0; // Return value

    if (gUrandomFd == -1) {
        fprintf(stderr, "Urandom (/dev/urandom) file not open\n");
        return -1;
    }

    ret = read(gUrandomFd, buf, size);

    if (ret != size) {
        fprintf(stderr, "Only read [%d] bytes, expected [%d]\n",
                 ret, size);
        return -1;
    } else {
        return 0;
    }
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-05-28T22:30:05.967

这是我的方法（一个包装器`rand()`）：

我还缩放以允许 min`INT_MIN`和 max 的情况`INT_MAX`，这通常是不可能`rand()`单独使用的，因为它返回的值来自`0`to `RAND_MAX`（包括 1/2 范围）。

像这样使用它：

```
const int MIN = 1;
const int MAX = 1024;
// Get a pseudo-random number between MIN and MAX, **inclusive**.
// Seeding of the pseudo-random number generator automatically occurs
// the very first time you call it.
int random_num = utils_rand(MIN, MAX); 
```

定义和 doxygen 描述：

```
#include <assert.h>
#include <stdbool.h>
#include <stdlib.h>

/// \brief      Use linear interpolation to rescale, or "map" value `val` from range
///             `in_min` to `in_max`, inclusive, to range `out_min` to `out_max`, inclusive.
/// \details    Similar to Arduino's ingenious `map()` function:
///             https://www.arduino.cc/reference/en/language/functions/math/map/
///
/// TODO(gabriel): turn this into a gcc statement expression instead to prevent the potential for
/// the "double evaluation" bug. See `MIN()` and `MAX()` above.
#define UTILS_MAP(val, in_min, in_max, out_min, out_max) \
    (((val) - (in_min)) * ((out_max) - (out_min)) / ((in_max) - (in_min)) + (out_min))

/// \brief      Obtain a pseudo-random integer value between `min` and `max`, **inclusive**.
/// \details    1\. If `(max - min + 1) > RAND_MAX`, then the range of values returned will be
///             **scaled** to the range `max - min + 1`, and centered over the center of the
///             range at `(min + max)/2`. Scaling the numbers means that in the case of scaling,
///             not all numbers can even be reached. However, you will still be assured to have
///             a random distribution of numbers across the full range.
///             2\. Also, the first time per program run that you call this function, it will
///             automatically seed the pseudo-random number generator with your system's
///             current time in seconds.
/// \param[in]  min         The minimum pseudo-random number you'd like, inclusive. Can be positive
///                         OR negative.
/// \param[in]  max         The maximum pseudo-random number you'd like, inclusive. Can be positive
///                         OR negative.
/// \return     A pseudo-random integer value between `min` and `max`, **inclusive**.
int utils_rand(int min, int max)
{
    static bool first_run = true;
    if (first_run)
    {
        // seed the pseudo-random number generator with the seconds time the very first run
        time_t time_now_sec = time(NULL);
        srand(time_now_sec);
        first_run = false;
    }

    int range = max - min + 1;
    int random_num = rand();  // random num from 0 to RAND_MAX, inclusive

    if (range > RAND_MAX)
    {
        static_assert(
            sizeof(long int) > sizeof(int),
            "This must be true or else the below mapping/scaling may have undefined overflow "
            "and not work properly. In such a case, try casting to `long long int` instead of "
            "just `long int`, and update this static_assert accordingly.");

        random_num = UTILS_MAP((long int)random_num, (long int)0, (long int)RAND_MAX, (long int)min,
                               (long int)max);
        return random_num;
    }

    // This is presumably a faster approach than the map/scaling function above, so do this faster
    // approach below whenever you don't **have** to do the more-complicated approach above.
    random_num %= range;
    random_num += min;

    return random_num;
} 
```

## 也可以看看：

1.  *[我在上面写下我的答案后*发现了这个问答，但它显然非常相关，并且他们对非缩放范围的情况做同样的事情][如何从 rand() 获得特定范围的数字？](https://stackoverflow.com/questions/1202687/how-do-i-get-a-specific-range-of-numbers-from-rand)
2.  [我还需要学习和阅读这个答案——似乎有一些关于通过不单独使用模数来保持良好随机性的好处][如何从 rand() 获得特定范围的数字？](https://stackoverflow.com/a/18386648/4561887)
    1.  [http://c-faq.com/lib/randrange.html](http://c-faq.com/lib/randrange.html)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-10-07T21:59:54.953

例如，如果您需要 128 个安全随机位，则符合 RFC 1750 的解决方案是读取已知会生成可用熵位的硬件源（例如旋转磁盘）。更好的是，好的实现应该使用*混合函数*组合多个源，最后通过*重新*映射或删除输出来消除它们的输出分布。

如果您需要比这更多的位，那么合规的做法是从 128 个安全随机位的序列开始，并将其*拉伸*到所需的长度，将其映射到人类可读的文本等。

如果您想在 CI 中生成一个安全的随机数，请遵循此处的源代码：

[https://wiki.sei.cmu.edu/confluence/display/c/MSC30-C.+Do+not+use+the+rand%28%29+function+for+generating+pseudorandom+numbers](https://wiki.sei.cmu.edu/confluence/display/c/MSC30-C.+Do+not+use+the+rand%28%29+function+for+generating+pseudorandom+numbers)

Note that for Windows BCryptGenRandom is used, not CryptGenRandom which has become unsecure within the past two decades. You can confirm for yourself that BCryptGenRandom is compliant with RFC 1750.

For POSIX-compliant operating systems, e.g. Ubuntu (a flavor of Linux), you can simply read from `/dev/urandom` or `/dev/random`, which is a file-like interface to a device that generates bits of entropy by combining multiple sources in an RFC 1750 compliant fashion. You can read a desired number of bytes from these "files" with `read` or `fread` just like you would any other file, but note that reads from `/dev/random` will block until a enough new bits of entropy are available, whereas `/dev/urandom` will not, which can be a security issue. You can get around that by checking the size of the available entropy pool, either my reading from `entropy_avail`, or by using `ioctl`.

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2016-08-06T10:01:22.460

我的简约解决方案应该适用于 range 中的随机数`[min, max)`。`srand(time(NULL))`在调用函数之前使用。

```
int range_rand(int min_num, int max_num) {
    if (min_num >= max_num) {
        fprintf(stderr, "min_num is greater or equal than max_num!\n"); 
    }
    return min_num + (rand() % (max_num - min_num));
} 
```

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2020-08-18T03:35:59.813

您可以使用**悬空指针**的概念。

**指向已被删除（或释放）的内存位置的指针称为悬空指针。**

它会在打印时显示随机值。

* * *

## 回答 #29

> 赞同：-4
> 
> 时间：2013-09-14T20:40:28.030

试试这个，我把上面已经提到的一些概念放在一起：

```
/*    
Uses the srand() function to seed the random number generator based on time value,
then returns an integer in the range 1 to max. Call this with random(n) where n is an integer, and you get an integer as a return value.
 */

int random(int max) {
    srand((unsigned) time(NULL));
    return (rand() % max) + 1;
} 
```

# c# - C# syntax for declaring a variable of an abstract generic type

> ID：822326
> 
> 赞同：4
> 
> 时间：2009-05-04T22:08:30.517
> 
> 标签：c#, generics, abstract-class

I have a class defined as follows;

```
public abstract class Repository<TEntity, TDataContext> : DisposableBaseClass
   where TEntity : class
   where TDataContext : DataContext, new()
{...contains Linq to SQL related functionality 
```

In the concrete sub-class I define the types as so;

```
public class ConcreteRepo : Repository<LSTableClass, LSDataContext> 
```

At the next tier up, I have business objects which hold the Repository object as a private variable.

This was fine;

```
private ConcreteRepo _repository; 
```

However, I then refactored this out into a parent class for all the business objects - this parent class holds the repository/ implements Dispose pattern to dispose of repository etc.

My problem is that I just can't get the syntax right for the declaration of the variable.

The closest I have come is;

```
protected Repository<Object, DataContext> _repository; 
```

but this gives the compile error:

**"Error 1 'System.Data.Linq.DataContext' must be a non-abstract type with a public parameterless constructor in order to use it as parameter 'TDataContext' in the generic type or method '....Repository'..."**

I've tried various other things but hit other problems.

In the business layer object inheriting this abstract class I am creating and using the _repository variable with a cast;

```
(Repository<LSTableClass, LSDataContext>)_repository = new ConcreteRepo(); 
```

*   and I think this will be fine, assuming I can get this declaration right in the parent.

If I can't get this to work I have to declare the _repository in each business object, with the full/ concrete type details, and implement the dispose pattern in each one to clear up. Not the end of the world, but I'd like to not have to.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T22:40:47.663

If I understand your problem correctly, you need to add a third generic parameter, the repository type, which is constrained to be a descendant of `Repository` with the appropriate argument types.

To outline it some more:

```
public abstract class Repository<TEntity,TDataContext>
    where TEntity : class
    where TDataContext : DataContext, new() {}

public abstract class BusinessObject<TEntity,TDataContext,TRepository>
    where TEntity : class
    where TDataContext : DataContext, new()
    where TRepository : Repository<TEntity,TDataContext>
{
    TRepository _repository;
}

public class ConcreteObject : BusinessObject<LSTableClass,LSDataContext,ConcreteRepo>
{ // ... 
```

I know it's probably not as compact as you would like, but what's needed to reduce this down effectively yet still retain the strong typing, is higher order generic types (called type classes in Haskell): a way of indicating that type parameters are themselves generic, and can take type parameters.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T22:54:56.133

Your declaration

```
protected Repository<Object, DataContext> _repository; 
```

Didn't work because of the constraint you placed upon it:

```
...    
where TDataContext : DataContext, new() 
```

Specifically the `new()` part.

I'm guessing that you want to 'inject' an object satisfying your generic interface.

Two things:

*   You can't convert between `Repository<Object, DataContext>` and `Repository<LSTableClass, LSDataContext>`. Not with C# 3\. This is called Contravariance/Covariance and won't be available until C# 4\. In C# 3 these are two completely different types.

*   If you want to store a generic member inside of a class, then the type arguments either have to be concrete types, or they must be declared as type parameters in the parent class declaration (making **that** generic).

Options:

*   Use generic type arguments on your parent class.
*   Remove the new() constraint from your class declaration.

# wcf - WCF 服务合同上的数据注释

> ID：822328
> 
> 赞同：6
> 
> 时间：2009-05-04T22:09:11.017
> 
> 标签：wcf, data-annotations

我有一个 WCF 服务，其中定义了一个 [DataContract] 类。每个属性都有 [DataMember] 属性，并且我已将几个数据注释属性 [Required] 和 [StringLength] 添加到几个属性中。

然后，我在 asp.net MVC 应用程序中使用此服务作为服务引用。当我得到所有属性的列表时

```
var attr= from prop in TypeDescriptor.GetProperties(instance).Cast<PropertyDescriptor>()
                        from attribute in prop.Attributes.OfType<ValidationAttribute>()
                        select attribute; 
```

我看到没有一个数据注释通过。这是 WCF 的限制还是我在这里做一些根本错误的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T22:33:02.237

当您的数据合同通过网络发送时，这些属性不会被序列化。您在本质上与属性关联的元数据中创建的新属性以及属性所属的类型。这不是数据，将不可用。

我猜您已经在您的 asp.net mvc 应用程序中添加了一个服务引用，除非指定，否则它将创建代表您的数据合同的新代理类。

添加服务引用时，如果单击高级按钮，请确保选中“使用现有类型”。这确保您的服务将使用您现有的合同。

这可能不是最佳实践，因为客户端应用程序必须了解您从服务返回的类型。如果您的服务仅供您自己使用，这可能没问题，在这种情况下，您需要在您的 asp.net mvc 应用程序中添加对您的合同的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-24T23:18:08.533

OData 团队正在研究一种将验证元数据公开为“词汇表”的解决方案。

更多信息：[http ://www.odata.org/blog/vocabularies](http://www.odata.org/blog/vocabularies)

# sharepoint - 在 Sharepoint 中组织大型文档卷

> ID：822335
> 
> 赞同：3
> 
> 时间：2009-05-04T22:11:27.203
> 
> 标签：sharepoint, document-library

我需要将当前位于文件服务器上的大约 100,000 个（MS-Word）文档上传到 Sharepoint - 在过去 7 年中添加。我读过一个共享点文档库确实应该限制为 2,000 个文档，并且一旦超过，就会出现性能问题。

我考虑过为每个日历年创建一个文档库，但即便如此，每个日历中仍然会有超过 10,000 个文档......

我读到在 Doc Libraries 上创建视图会提高性能，但我不知道会怎样。添加索引怎么样？

最好的解决方案是什么？有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T22:17:43.477

软限制是 2000 每个*视图*。当前“可接受的性能”的文档库限制是（如果他们达到此目标，上帝会帮助任何人）：每个*库*500 万：

[http://technet.microsoft.com/en-us/library/cc287790.aspx](http://technet.microsoft.com/en-us/library/cc287790.aspx)

也许每年都有一个图书馆，每个月都有一个文件夹（是的，我知道，文件夹很糟糕）？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T22:17:04.880

我认为问题不一定在于图书馆中有数千个文档，而只是视图中有数千个文档 - 如果您将视图设置为按月排序，您可能会没事。

编辑：根据 Vinny 的回答，除非有人试图一次查看所有内容，否则您应该没问题。简单的解决方案：不要让他们:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T03:43:33.287

请注意，您需要在用作视图过滤器的字段上设置索引。否则可能会出现问题。

另一个选项是“每个容器 2000 个项目”，这实际上是指文件夹。

# file - 批量提取名称中带有空格的 rars

> ID：822339
> 
> 赞同：2
> 
> 时间：2009-05-04T22:11:56.033
> 
> 标签：file, batch-file, space

我正在尝试批量提取某些目录中某些 zip 中的一些 rar。长话短说，这是我通过 rar 文件的循环：

```
for %%r in (*.rar) do (

unrar x %%r
) 
```

问题是 %%r 得到了错误的值。如果文件名为“file name.rar”，则 %%r 获取值“file” - 它在文件名的第一个空格处停止。

如何让这个循环处理名称中带有空格的文件文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T22:37:29.963

试试这个：

```
for /f "usebackq delims==" %i in (`dir /b *.rar`) do unrar x "%i" 
```

如果您在批处理文件中使用它，请记住您需要将百分号加倍才能转义它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T08:02:02.353

`%%r`将包含完整的文件名，包括空格。这是你的电话`unrar`有问题。如果文件名包含空格，则必须将其括在引号中，否则`unrar`将无法看到这两个（空格分隔）参数`file`，`name.rar`并且实际上是带有空格的单个文件名。

所以以下将起作用：

```
for %%r in (*.rar) do unrar "%%r" 
```

此外，如果您对问题出在哪里感到好奇，有时将程序调用简单地替换为 echo 会很有帮助：

```
for %%r in (*.rar) do @echo %%r 
```

您将在其中看到 %%r 在文件名中包含空格并且不会将它们分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T22:22:46.130

问题是“for”使用空格作为默认分隔符。您可以使用 delims = xxx 进行设置。[在此处](http://www.ss64.com/nt/for_f.html)查找语法。或者您可以使用[ForFiles](http://www.ss64.com/nt/forfiles.html)。

# iphone - 我应该使用什么类型的 iPhone 应用程序文件？

> ID：822347
> 
> 赞同：2
> 
> 时间：2009-05-04T22:13:57.260
> 
> 标签：iphone, cocoa-touch, uitableview, tabbar

我应该使用什么类型的 iPhone 应用程序文件？

之前，我试图制作一个从 RSS 获取信息，然后填充 tableview 的应用程序。

该应用程序将使用标签栏，并具有许多不同的视图。

在我尝试使用“标签栏应用程序”之前，我做错了一些事情（我不确定是什么），我不得不重新开始。

那么我应该使用哪种应用程序类型？

谢谢！-担

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T22:27:57.600

如果您想要一个基于标签栏的应用程序，请制作一个标签栏应用程序。

看起来你对事物还是很陌生，所以实际上可能更有益的是制作一个空白应用程序，并学习如何从头开始创建标签栏应用程序。那里几乎没有魔法，然后当“它坏了”时，你就会知道如何修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T02:54:22.687

我是一个新手，在玩 TabBar 模板时，我想在其中一个选项卡视图中添加一个导航控制器。我完全搞砸了，至少又开始了两次。

从我的错误中，我了解到自定义标签栏应用程序的最佳方法是首先在 IB 中打开 MainWindow.xib 文件。打开该文件并按 Cmd+0。它将打开一个窗口，显示 nib 文件中的对象。您通常应该看到一个标签栏控制器、一个应用程序委托，可能还有一个文件的所有者。在那里展开“TabBarController”。您的不同视图将在此处列出，并且默认情况下每个视图都将从 UIViewController 继承。您可以通过将“NavigationController”从库中拖到视图上来更改它们。就这么简单。避免浏览那个基于窗口的应用程序模板。尝试使用模板文件。如果你被卡住了，再做一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T22:26:33.783

你可以使用任何你想要的。“应用程序类型”只是帮助您入门的模板。您可以以任何方式修改它们，并且您选择的模板根本不会限制您。

# implementation - 非常非常长的小数的算术运算

> ID：822356
> 
> 赞同：0
> 
> 时间：2009-05-04T22:17:14.973
> 
> 标签：implementation, long-integer, bignum, bigint

我一直很好奇：我怎样才能对很长的小数进行算术运算——例如，将 pi 计算到小数点后 3000 位（尤其是在命令式语言中）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T22:23:09.187

使用支持任意精度数字的语言或库...？

在 Python 中，int 将自动提升为任意大小的 long。您可以使用第二个值来跟踪要移动的小数位数以获得一种任意精度的浮点数。

在 Java 中，您可以使用[BigDecimal](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)类，它表示“不可变的、任意精度的有符号十进制数”。

我确信其他语言中存在其他示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T22:25:03.550

对于不支持 bignums 计算的语言，通常有库。例如，您可能会查看[GMP](http://gmplib.org/)。文档将为您提供一些典型算法方法的指针。

使 bignum 算术变得快速是困难的，所以那里有一些非常复杂的算法......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T22:21:30.610

您要么必须在数字级别处理数据（例如，以增量方式或确定性方式计算每个数字），要么定义具有足够位数以提供足够精度的新数据结构。

# nhibernate - 如何使用 NHibernate 向我的更新命令添加附加条件？

> ID：822357
> 
> 赞同：0
> 
> 时间：2009-05-04T22:17:22.073
> 
> 标签：nhibernate

我遇到消息表具有主键 (Id) 和外键 (Site) 的情况。任何站点都可以创建消息记录，但只有创建记录的站点才能更新它。问题是默认情况下它将根据 Id 而不是 Id 和 Site 进行更新。我可以将主键更改为由 id 和站点组成的复合/复合 id 或使用 Native SQL；但是，我想知道是否有办法添加额外的更新标准。

例如，这是您默认获得的：

```
公共无效消息更新（消息oneMessage）
{
    使用（ISession 会话 = SessionFactory.OpenSession()）
    使用(ITransaction trans = session.BeginTransaction())
    {
        session.Update(oneMessage);
        trans.Commit();
    }
}

```

那么如何在 NHibernate 中执行此操作而不创建复合 id 或使用 Native SQL：

```
更新 MessageTable 设置 MessageStatus = 2 其中 Id = ? 和站点 = ?;

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T00:31:51.017

我对您的问题的理解是，该规则是业务需求，因此NHibernate 可能不是该规则的地方。您可以尝试在更新事件上实现监听器：http: [//nhibernate.info/blog/2009/04/29/nhibernate-ipreupdateeventlistener-amp-ipreinserteventlistener.html](http://nhibernate.info/blog/2009/04/29/nhibernate-ipreupdateeventlistener-amp-ipreinserteventlistener.html)

另一种解决方案是将带有 update 的属性标记为 false 以防止更改记录的站点？[http://nhibernate.info/doc/nh/en/index.html#mapping-generated](http://nhibernate.info/doc/nh/en/index.html#mapping-generated)（见生成的属性）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T00:50:53.170

您不能直接在 NHibernate 中执行此操作，但您可以将更新方法更改为：

```
public void MessageUpdate(Message oneMessage, string currentSite)
{
    if (oneMessage.Site != currentSite)
    {
        throw new Exception("meaningful error message");
    }
    using(ISession session = SessionFactory.OpenSession())
    using(ITransaction trans = session.BeginTransaction())
    {
        session.Update(oneMessage);
        trans.Commit();
    }
} 
```

假设 Site 是一个字符串和 Message 的一个属性。此外，如果发生异常，您将希望将更新包装在 try..catch 中并回滚事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T15:28:11.967

我想对我最初的问题的简短回答是你不能在更新中添加标准。您可以按照我最初的建议使用本机 SQL 来处理这种情况：

更新 MessageTable 设置 MessageStatus = 2 其中 Id = ? 和站点 = ?;

或者您可以按照 Jamie Ide 的建议解决问题，但需要对数据库进行额外查询才能提取原始消息。

# java - 证明：为什么 java.lang.String.hashCode() 的实现与其文档匹配？

> ID：822363
> 
> 赞同：10
> 
> 时间：2009-05-04T22:17:36.440
> 
> 标签：java, algorithm, math, hashcode

[著名](https://stackoverflow.com/questions/299304)的 JDK 文档说：[`java.lang.String.hashCode()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#hashCode())

> String 对象的哈希码计算为
> 
> ```
> s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] 
> ```
> 
> 使用`int`算术运算，其中`s[i]`是`i`字符串的第 * 个字符，是字符串`n`的长度，`^`表示取幂。

这个表达式的标准实现是：

```
int hash = 0;
for (int i = 0; i < length; i++)
{
    hash = 31*hash + value[i];
}
return hash; 
```

看着这让我觉得我正在通过我的算法课程睡觉。该数学表达式如何转换为上面的代码？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-04T22:26:17.557

展开循环。然后你得到：

```
int hash = 0;

hash = 31*hash + value[0];
hash = 31*hash + value[1];
hash = 31*hash + value[2];
hash = 31*hash + value[3];
...
return hash; 
```

现在您可以进行一些数学运算，为初始哈希值插入 0：

```
hash = 31*(31*(31*(31*0 + value[0]) + value[1]) + value[2]) + value[3])... 
```

再简化一下：

```
hash = 31^3*value[0] + 31^2*value[1] + 31^1*value[2] + 31^0*value[3]... 
```

这本质上是给出的原始算法。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-04T22:45:36.560

我不确定您是否错过了该文档中“^ 表示求幂”（不是 xor）的位置。

每次通过循环，hash 的前一个值*再次*乘以 31，然后再添加到 的下一个元素`value`。

人们可以通过归纳证明这些事情是相等的，但我认为一个例子可能更清楚：

假设我们正在处理一个 4 字符的字符串。让我们展开循环：

```
hash = 0;
hash = 31 * hash + value[0];
hash = 31 * hash + value[1];
hash = 31 * hash + value[2];
hash = 31 * hash + value[3]; 
```

现在通过将 hash 的每个值代入以下语句，将它们组合成一个语句：

```
hash = 31 * (31 * (31 * (31 * 0 + value[0]) + value[1]) + value[2])
     + value[3]; 
```

31 * 0 为 0，所以简化：

```
hash = 31 * (31 * (31 * value[0] + value[1]) + value[2])
     + value[3]; 
```

现在将两个内项乘以第二个 31：

```
hash = 31 * (31 * 31 * value[0] + 31 * value[1] + value[2])
     + value[3]; 
```

现在将三个内部项乘以前 31：

```
hash = 31 * 31 * 31 * value[0] + 31 * 31 * value[1] + 31 * value[2]
     + value[3]; 
```

并转换为指数（不再是真正的 Java）：

```
hash = 31^3 * value[0] + 31^2 * value[1] + 31^1 * value[2] + value[3]; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-04T22:31:50.477

归纳证明：

```
T1(s) = 0 if |s| == 0, else s[|s|-1] + 31*T(s[0..|s|-1])
T2(s) = s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1]
P(n) = for all strings s s.t. |s| = n, T1(s) = T2(s)

Let s be an arbitrary string, and n=|s|
Base case: n = 0
    0 (additive identity, T2(s)) = 0 (T1(s))
    P(0)
Suppose n > 0
    T1(s) = s[n-1] + 31*T1(s[0:n-1])
    T2(s) = s[0]*31^(n-1) + s[1]*31^(n-2) + ... + s[n-1] = s[n-1] + 31*(s[0]*31^(n-2) + s[1]*31^(n-3) + ... + s[n-2]) = s[n-1] + 31*T2(s[0:n-1])
    By the induction hypothesis, (P(n-1)), T1(s[0:n-1]) = T2(s[0:n-1]) so
        s[n-1] + 31*T1(s[0..n-1]) = s[n-1] + T2(s[0:n-1])
    P(n) 
```

我想我有它，并要求提供证明。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-04T22:31:46.577

看看前几次迭代，你会看到模式开始出现：

```
散列0 = 0 + s 0 = s 0
散列1 = 31(散列0 ) + s 1 = 31(s 0 ) + s 1
散列2 = 31(散列1 ) + s 2 = 31(31(s 0 ) + s 1 ) + s 2 = 31 2 (s 0 ) + 31(s 1 ) + s 2
...

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-21T14:54:15.487

**从所有字符**中算出字符串的哈希码难道一点用都没有吗？想象一下将完整路径放入 HashSet 的文件名或类名。或者使用字符串文档的 HashSets 而不是 Lists 的人，因为“ [HashSet 总是胜过 Lists](https://stackoverflow.com/questions/150750/hashset-vs-list-performance) ”。

我会做类似的事情：

```
int off = offset;
char val[] = value;
int len = count;

int step = len <= 10 ? 1 : len / 10;

for (int i = 0; i < len; i+=step) {
   h = 31*h + val[off+i];
}
hash = h 
```

最后，哈希码只不过是一个提示。

# php - CakePHP 脚手架问题

> ID：822384
> 
> 赞同：0
> 
> 时间：2009-05-04T22:23:19.047
> 
> 标签：php, scaffolding, scaffold

我有一个连接表，它将用户表和通信表放在一起。我在 Cake 中建立了适当的关系。当我`var $scaffold;`在控制器中使用时，一切都完美无缺。我可以双向查看、添加和编辑记录。但是，当我通过 Bake 控制台删除该`var $scaffold`功能并让 bake 创建标准索引、查看、添加、编辑文件时，所有这些功能都消失了。

我的印象是，从食谱手册中，烘焙会重新创建索引、查看、添加、编辑文件，就像`var $scaffold;`创建它们一样，因此我可以按照我认为合适的方式编辑它们。我在这个假设上错了吗？

是否有某种方法可以查看脚手架在渲染视图时生成的代码。我知道脚手架模板，但我必须承认它们仍然比我的知识库略高。

顺便说一句，喜欢这个网站。

谢谢你

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-04T23:05:04.703

您是否单独烘焙 MVC 的每个组件？如果是这样，当您烘焙控制器时，它会询问您是否要包含基本的 CRUD 操作（添加、编辑、查看、删除）。之后，烘焙视图，它会询问您是否需要 CRUD 视图（如果我没记错的话，默认为否）。

# java-me - 如何在摩托罗拉手机上安装应用程序签名证书？

> ID：822388
> 
> 赞同：4
> 
> 时间：2009-05-04T22:24:28.967
> 
> 标签：java-me, certificate, sign

摩托罗拉手机没有用于代码签名的 Verisign/Thawte 根证书。他们只嵌入了 Java UTI 证书，这要求您为您想要为应用程序签名的每个手机型号付费来签署您的应用程序（并且每次您想要一个新版本的应用程序时）。

我创建了一个指向证书（DER 格式）的简单网页，以检查是否可以安装证书。

在诺基亚手机上，它工作正常。在摩托罗拉，手机显示“未知文件格式”。

有没有办法使这项工作？该文件具有“.cer”扩展名，是错误的吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T10:33:09.410

上次我不得不做这样的事情时，恐怕需要让摩托罗拉自己签署申请。不过，那是在摩托罗拉移动部门当前问题之前。希望这仍然是可能的。

# web-services - 设置 Content-Type 以从 Firefox 进行测试

> ID：822392
> 
> 赞同：4
> 
> 时间：2009-05-04T22:25:57.560
> 
> 标签：web-services, rest, firefox-addon, content-type

我需要从 Firefox 进行一些 REST 服务测试，在其中我将 Content-Type HTTP 标头设置为特定值（以检索 XML 或 JSON）。

有没有 Firefox 插件可以做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T22:31:10.573

有修改标头“...您可以修改用户代理字符串，添加标头来欺骗移动请求（例如 x-up-calling-line-id）...”

[https://addons.mozilla.org/en-US/firefox/addon/967](https://addons.mozilla.org/en-US/firefox/addon/967)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-27T09:43:15.330

已接受答案中建议的插件似乎不再存在。

Firefox 有一些扩展允许构建具有特定标头或正文内容的 HTTP/REST 请求，例如：

*   [休息](http://resting.owlcode.eu)
*   [休息](https://github.com/frigus02/RESTer)

免责声明：我是 Resting 的创建者和维护者

# iphone - 如何设置 CMake 为 iPhone 构建应用程序

> ID：822404
> 
> 赞同：25
> 
> 时间：2009-05-04T22:28:54.977
> 
> 标签：iphone, xcode, cmake

[这与我之前的问题](https://stackoverflow.com/questions/794137/how-to-set-up-cmake-to-build-a-library-for-the-iphone)密切相关，即使用 CMake 在 iPhone 上构建静态库。我得到了它的工作设置`CMAKE_OSX_SYSROOT`。

但是，这不适用于构建应用程序。我的`CMakeLists.txt`样子：

```
project(TEST)

set(CMAKE_OSX_SYSROOT iphoneos2.2.1)
set(CMAKE_OSX_ARCHITECTURES "$(ARCHS_STANDARD_32_BIT)")
set(CMAKE_EXE_LINKER_FLAGS
"-framework Foundation -framework OpenGLES -framework AudioToolbox -framework CoreGraphics -framework QuartzCore -framework UIKit -framework OpenAL"
)

set(SRC --my files--)

add_executable(iphone-test MACOSX_BUNDLE ${SRC}) 
```

几点注意事项：

*   我明确给出了`-framework`链接选项，因为`find_library`不适用于所有框架（它找到了大多数框架，但没有找到`OpenGLES`）。我不明白为什么，因为它们都在同一个文件夹`${SDK}/System/Library/Frameworks`中。这让我相信我做错了什么，但我不知道是什么。
*   我添加`MACOSX_BUNDLE`到`add_executable`命令中，以便生成的产品类型将`com.apple.product-type.application`代替`com.apple.product-type.tool`，这在 iPhone 上显然不存在。

无论如何，该应用程序可以正确编译和链接，但是当我在模拟器中运行它时，我会感到害怕

```
Failed to launch simulated application: Unknown error. 
```

在 google 和 stackoverflow 上有很多关于此问题的报告实例，但所有解决方案都涉及清理或创建新项目和移动文件；但是我在 CMake 完成它的工作之后编译了一个新的副本，所以这些都不适用。

我在 CMake 邮件列表中找到[了这个线程](http://www.mail-archive.com/cmake@cmake.org/msg20676.html)，但它只报告了构建库的成功，然后逐渐消失。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-09T21:22:59.237

我终于想出了如何做到这一点。这是我的`CMakeLists.txt`文件的样子：

```
project(test)
set(NAME test)

file(GLOB headers *.h)
file(GLOB sources *.cpp)

set(CMAKE_OSX_SYSROOT iphoneos2.2.1)
set(CMAKE_OSX_ARCHITECTURES $(ARCHS_STANDARD_32_BIT))
set(CMAKE_CXX_FLAGS "-x objective-c++")
set(CMAKE_EXE_LINKER_FLAGS
    "-framework AudioToolbox -framework CoreGraphics -framework QuartzCore -framework UIKit"
)
link_directories(\${HOME}/\${SDKROOT}/lib)

set(MACOSX_BUNDLE_GUI_IDENTIFIER "com.mycompany.\${PRODUCT_NAME:identifier}")
set(APP_TYPE MACOSX_BUNDLE)

add_executable(${NAME}
    ${APP_TYPE}
    ${headers}
    ${sources}
)

target_link_libraries(${NAME}
    # other libraries to link
)

# code signing
set_target_properties(${NAME} PROPERTIES XCODE_ATTRIBUTE_CODE_SIGN_IDENTITY "iPhone Developer: My Name") 
```

显然，更改`mycompany`为您的公司名称，并更改`My Name`为您的名称。我发现添加`\${HOME}/\${SDKROOT}/lib`上面的链接目录非常有用，这样如果您的应用程序链接到静态库（尤其是通用（非 iPhone）库），您可以构建单独的 iPhoneOS 和 iPhoneSimulator 库并轻松链接到正确的库，而不是担心通用二进制文件。

此外，当您使用 CMake 构建项目时，Xcode 似乎没有正确添加资源，因此我将这一部分添加到`CMakeLists.txt`文件中。它将整个文件夹复制`/data`到我的资源文件夹中（好像我在 Xcode 中添加了一个“蓝色”文件夹链接）。

```
# copy resource phase

set(APP_NAME \${TARGET_BUILD_DIR}/\${FULL_PRODUCT_NAME})
set(RES_DIR ${test_SOURCE_DIR}/data)
add_custom_command(
    TARGET ${NAME}
    POST_BUILD
    COMMAND /Developer/Library/PrivateFrameworks/DevToolsCore.framework/Resources/pbxcp -exclude .DS_Store -exclude CVS -exclude .svn -resolve-src-symlinks ${RES_DIR} ${APP_NAME}
) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-31T00:38:39.173

对于框架，我发现这条消息[http://www.mail-archive.com/cmake@cmake.org/msg24659.html](http://www.mail-archive.com/cmake@cmake.org/msg24659.html)我为此获取了足够的信息：

```
SET(TARGETSDK iPhoneOS3.1.2.sdk)
SET(CMAKE_OSX_SYSROOT /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/${TARGETSDK})
macro(ADD_FRAMEWORK fwname appname)
    find_library(FRAMEWORK_${fwname}
        NAMES ${fwname}
        PATHS ${CMAKE_OSX_SYSROOT}/System/Library
        PATH_SUFFIXES Frameworks
        NO_DEFAULT_PATH)
    if( ${FRAMEWORK_${fwname}} STREQUAL FRAMEWORK_${fwname}-NOTFOUND)
        MESSAGE(ERROR ": Framework ${fwname} not found")
    else()
        TARGET_LINK_LIBRARIES(${appname} ${FRAMEWORK_${fwname}})
        MESSAGE(STATUS "Framework ${fwname} found at ${FRAMEWORK_${fwname}}")
    endif()
endmacro(ADD_FRAMEWORK) 
```

现在我没有设置 CMAKE_EXE_LINKER_FLAGS，而是：

```
ADD_FRAMEWORK(AudioToolbox MyApp)
ADD_FRAMEWORK(CoreGraphics MyApp)
ADD_FRAMEWORK(QuartzCore MyApp)
ADD_FRAMEWORK(UIKit MyApp) 
```

这也适用于 OpenGLES。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-08T02:19:58.057

最近的 CMake 版本将 .m 和 .mm 文件传递​​给 C++ 编译器，该编译器通过扩展检测语言，因此您无需在标志中显式添加“-x objective-c++”。

# apache - 检查 apache 的 access.log 文件的最佳方法是什么？

> ID：822411
> 
> 赞同：1
> 
> 时间：2009-05-04T22:31:37.747
> 
> 标签：apache, logging

对于基于 apache 的 access.log 文件的相对简单（没什么花哨的）图表，你们会推荐什么工具？理想情况下，我会在服务器上运行一些东西，并且可以访问目录并理解文件是 .1、.2、.3 等，并且知道如何解析它们（并且有一个 Web 前端）。我假设有很多解决方案，我并没有真正通过谷歌找到任何东西......有什么建议吗？

或者您可能会建议完全跳过 .log 文件，而只使用其他一些解决方案来衡量使用指标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T22:35:34.307

我使用 webalizer。它使用简单，似乎可以满足您的所有要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T22:35:40.967

[AWStats](http://awstats.sourceforge.net/)为各种数字生成漂亮的图表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T23:18:49.273

我们现在使用 webalizer。过去我们使用模拟。

# visual-studio - Visual Studio 2005 对于 C++ 速度很慢

> ID：822414
> 
> 赞同：2
> 
> 时间：2009-05-04T22:31:53.130
> 
> 标签：visual-studio

VS 2005 突然花费了非常非常长的时间来编译我的 C++ 解决方案。我尝试删除 Intellisense DLL 并删除 .suo 和 .ncb 文件，但没有帮助。在我构建进程资源管理器的大部分时间里，几乎所有的 CPU 时间都花在了系统空闲进程中，所以我不知道 Visual Studio 是在浪费什么时间。

另外，Team System 中的“Team Manager”在你做任何事情时都需要 8 年的时间来更新。我尝试使用 MS 提示禁用“CMI”，但没有太大帮助。

关于如何加快速度的任何想法？

编辑：不通过网络共享访问东西。我打开了 VSS 集成，但我将其关闭了。

编辑第二个：感谢您的帮助。没有什么特别突出的，我想这只是 VS 中堆积的不好的东西。我只是要删除并重新安装 VS 2005 而根本不安装 Team Explorer 的东西，希望这会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T23:06:44.717

当事情开始变得很慢而没有任何活动迹象（CPU，硬盘）时，通常是因为某些组件正在等待其他东西（通常是网络）。如果其域控制器消失或变得无响应，Windows 本身可能会从响应变为无法使用的缓慢。重新启动通常可以解决此问题。有些事情可能取决于连接到 Internet 来执行各种任务，如果发出请求的组件没有意识到网络不可用，这可能会导致速度变慢。

我曾经遇到过这样一种情况，即一切都花费了比看起来必要的时间更长的时间。事实证明，Windows“安全”事件日志被设置为最大大小，被设置为仅在条目达到一定天数后才覆盖条目，并且事件日志已满。似乎每当 Windows 想要写入安全事件日志条目时，内核都会坐在那里*等到*最旧的条目足够老可以删除！我最终不得不关闭机器，以管理员身份登录，修复设置，然后再次重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:05:59.193

关闭 Visual Studio 后，尝试删除项目目录中的临时文件，尤其是 ncb。这通常可以解决莫名其妙的减速问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-04T22:41:13.170

固态磁盘存储、更多内存和更快的机器。如果您使用的是 VS 2005，您可能在硬件方面也不是最先进的......

# iphone - 为什么我不能用 NSDateFormatter 正确解析这个日期字符串？

> ID：822417
> 
> 赞同：2
> 
> 时间：2009-05-04T22:32:14.860
> 
> 标签：iphone, cocoa, cocoa-touch, string-formatting, nsdateformatter

我正在尝试解析由 NSDateFormatter 使用另一个具有相同格式的 NSDateFormatter 生成的字符串。

与其试图使前面的句子有意义，不如使用以下代码：

```
NSDateFormatter *format = [[NSDateFormatter alloc] init];
[format setDateFormat:@"MMM dd, YYYY HH:mm"];

NSDate *now = [[NSDate alloc] init];

NSString *dateString = [format stringFromDate:now];

NSDateFormatter *inFormat = [[NSDateFormatter alloc] init];
[inFormat setDateFormat:@"MMM dd, YYYY HH:mm"];

NSDate *parsed = [inFormat dateFromString:dateString];

NSLog(@"\n"
      "now:        |%@| \n"
      "dateString: |%@| \n"
      "parsed:     |%@|", now, dateString, parsed); 
```

当我运行此代码时，我希望*parsed包含与**现在*相同的日期，但我得到以下输出：

```
现在：|2009-05-04 18:23:35 -0400|
日期字符串：|2009 年 5 月 4 日 18:23|
解析：|2008-12-21 18:23:00 -0500|

```

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T23:22:50.107

您的问题是“YYYY”不是有效的 ICU 日期格式选项。你想要“yyyy”。

大写的“Y”仅在与“一年中的周”选项一起使用时有效（即“Y 的‘周’w’）。

# definition - 当用作技术术语时，“表面处理”是什么意思？

> ID：822419
> 
> 赞同：2
> 
> 时间：2009-05-04T22:32:42.083
> 
> 标签：definition

Joel Spolsky 在 SO 播客中提到了“表面处理”。

这是什么意思？是不是类似于“暴露”，就像“暴露接口”一样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T22:45:33.237

[这是播客 51](https://stackoverflow.fogbugz.com/default.asp?W29044)的文字记录 wiki 中的一段引述，其中他们提到了“表面处理”。我想他们也提到过几次。

> 阿特伍德：没错。我们刚刚推出的一件事是，我们现在正在问题页面上显示一些评论，我不喜欢评论的一件事是它们基本上无法搜索，因为它们是通过 Javascript 和 Ajax 加载的

我认为它基本上是确保某些内容对搜索引擎可见，而不是由 ajax 或其他东西加载。或者默认情况下使它们可见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T22:37:16.360

堆焊

*ñ*。

1.  [浮出水面并变得明显](http://wordnetweb.princeton.edu/perl/webwn?s=surfacing)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T23:32:12.830

我听说它最近使用过几次，在这些情况下，它本质上意味着“暴露一个界面”，正如你所建议的那样。你在一个框架中有一些功能，你想让那个框架的用户可以访问它。所以我想这是在“从深处带出一些特征并使其可见”的意义上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T23:51:12.610

除了其正常的英语含义之外，该术语本身没有任何特殊含义。在编程上下文中，surface 作为动词最常见的用法可能是显示错误或异常，这也并不意味着任何精确的东西。这可能意味着记录它们而不是什么都不做，或者使请求失败而不仅仅是记录错误。

# regex - 在 mod_rewrite 规则正则表达式中匹配问号

> ID：822421
> 
> 赞同：24
> 
> 时间：2009-05-04T22:32:54.330
> 
> 标签：regex, apache, mod-rewrite

我希望用多个子字符串重写 url。一个子字符串被请求为子目录，而其他任何子字符串都被请求为正常的查询字符串参数。

例如，我想从

```
http://www.mysite.com/mark/friends?page=2 
```

到

```
http://www.mysite.com/friends.php?user=mark&page=2 
```

除了问号字符外，我能够做到这一点。这是我的重写规则：

```
...
RewriteEngine On
RewriteBase /
RewriteRule ^([A-Za-z0-9-_]+)/friends[?]?([^/\.]+)?$ friends.php?user=$1&$2 [L] 
```

如果我将问号更改为任何其他字符，效果很好。似乎问题在于'？字符被错误地解释为新查询字符串的开始。

我需要按原样传递 /user/friends 之后出现的任何参数。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-04T22:36:34.303

您应该使用该`[QSA]`标志而不是尝试重写查询字符串。`[QSA]`将查询字符串传递给重写的 URL。

所以你的规则应该是这样的：

```
...
RewriteEngine On
RewriteBase /
RewriteRule ^([A-Za-z0-9-_]+)/friends/? friends.php?user=$1 [QSA,L] 
```

[您的情况与在 mod_rewrite 食谱中使用 QSA 标志的示例](http://mod-rewrite.org/)非常相似。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-04T22:44:35.313

该[查询不是 URL 路径的一部分，因此无法使用`RewriteRule`指令](http://httpd.apache.org/docs/2.2/rewrite/intro.html#rewriterule)进行处理。这只能通过[`RewriteCond`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)指令来完成（参见 参考资料`%{QUERY_STRING}`）。

但[正如 Chad Birch 已经说过](https://stackoverflow.com/questions/822421/match-question-mark-in-modrewrite-rule-regex/822439#822439)的那样，只需设置[`QSA`标志](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriterule)即可自动获取附加到新 URL 的原始请求查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-23T11:45:11.270

除了使用重写标志 QSA 之外，还可以使用 QUERY_STRING 环境变量，如下所示：

```
RewriteEngine On
RewriteBase /
RewriteRule ^([A-Za-z0-9-_]+)/friends$ /friends.php?user=$1&%{QUERY_STRING} 
```

和有问题的网址

```
http://www.example.com/mark/friends?page=2 
```

将被重写为（如指定）：

```
http://www.example.com/friends.php?user=mark&page=2 
```

# sql-server-2005 - 如何将 655 的数据库附加到 SQL 2005 612 实例？

> ID：822425
> 
> 赞同：0
> 
> 时间：2009-05-04T22:33:12.237
> 
> 标签：sql-server-2005

我试图将我的数据库附加到运行 SQL2005 的服务器上，但遇到一个错误，指出我的数据库是 655 版，在 612 系统上不受支持。有没有办法改变我的数据库以获得附加或找出导致阻止我附加数据库的结构变化的原因？

**解决方案**

如果您右键单击要升级的数据库并生成脚本。然后，您可以为目标版本生成数据库副本，并从错误列表中找出哪些表有问题以及这些问题是什么。更改数据库后，您可以在目标计算机上使用该脚本。不要忘记选择将索引和数据添加到脚本中。

我不知道为什么没有人在任何地方写过这个，但对于那些遭受痛苦的人，我会推荐它作为你的第一选择。它对我很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T22:38:32.600

在我看来，这听起来像是 SQL 服务器中的版本检查，以确保您不会将新的数据库文件与旧的（未修补的）数据库一起使用并在此过程中损坏它。

2个选项：

1) 给你的数据库打补丁（把它升级到最新的补丁级别）

2）将您的数据库附加到具有所需补丁级别的数据库上，导出/备份它，将备份移动到有问题的服务器并再次导入/恢复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:37:02.270

如果您右键单击要升级的数据库并生成脚本。然后，您可以为目标版本生成数据库副本，并从错误列表中找出哪些表有问题以及这些问题是什么。更改数据库后，您可以在目标计算机上使用该脚本。不要忘记选择将索引和数据添加到脚本中。

我不知道为什么没有人在任何地方写过这个，但对于那些遭受痛苦的人，我会推荐它作为你的第一选择。它对我很有用。

# java - 如何使 JCombobox 看起来像 JTextField

> ID：822432
> 
> 赞同：6
> 
> 时间：2009-05-04T22:34:38.317
> 
> 标签：java, swing

有没有一种好的（简单的）方法可以让 JCombobox 看起来像 JTextField？我的意思是不应该有一个下拉按钮，但是当用户输入一些东西时，它应该显示多个结果。

基本上与 google、youtube、facebook 等的工作方式相同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-25T08:21:12.717

```
JComboBox comboBox = new JComboBox();
comboBox.setUI(new BasicComboBoxUI() {
    @Override
    protected JButton createArrowButton() {
        return new JButton() {
            @Override
            public int getWidth() {
                return 0;
            }
        };
    }
}); 
```

使 getWidth() 返回 0 可确保：
a) 未显示按钮
b) 没有为其保留空间，让您输入整个字段

我发现我必须调用`.setUI()`via `SwingUtilities.invokeLater()`，但根据您的代码结构，您可能不必这样做。

如果您想要自动完成，请将一些项目添加到组合框中，然后使用`AutoCompleteDecorator.decorate(comboBox)`. 如前所述，该类`AutoCompleteDecorator`是[SwingX的一部分。](https://swingx.dev.java.net/)

这可能会使您的框在使用另一个 L&F 时看起来很奇怪，因此您必须选择要实例化的 CombiBoxUI，以获得正确的外观。

如果您不希望在组合框中没有任何内容时出现下拉菜单，请在 BasicComboBoxUI 中重写此方法：

```
@Override
public void setPopupVisible(JComboBox c, boolean v) {
    // keeps the popup from coming down if there's nothing in the combo box
    if (c.getItemCount() > 0) {
        super.setPopupVisible(c, v);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-31T13:52:44.343

我有一个非常相似的问题，我不关心弹出箭头，但是我需要控制禁用组件时的文本外观。

我想显示当前值，但禁用列表选择/编辑。使用 JComboBox 获得此行为的唯一方法是使用 comboBox.setEnabled(false); 这使文本成为不可读的浅灰色。

我创建了一个 ComoBoxUIDecorator，并截取了一些绘制方法。这具有完全正确的效果 - 箭头显示为灰色，而当前值显示为黑色且可读（好像已启用）。

```
public class ComboBoxUIDecorator extends ComboBoxUI {
 private ComboBoxUI m_parent;

 public ComboBoxUIDecorator(ComboBoxUI x) {
  m_parent = x;
 }
 ...
 public boolean isFocusTraversable(JComboBox c) {
  return m_parent.isFocusTraversable(c);
 }

 public void paint(Graphics g, JComponent c) {
  c.setEnabled(m_displayEnabledState);
  m_parent.paint(g, c);
  c.setEnabled(m_realEnabledState);
 }
} 
```

您可以尝试类似的方法；如果你能找到箭头按钮，你可以在调用 m_parent.paint() 后在箭头上绘制

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T22:55:43.230

你的意思是你想让它表现得像一个自动完成先前输入的值的文本字段吗？[SwingX](http://swinglabs.org/index.jsp)支持向文本组件添加自动完成功能。

您可以查看的另一个库是[JIDE Common Layer](http://www.jidesoft.com/products/oss.htm)。他们的 IntelliHints 功能可能正是您想要的。您可以从[这里](http://www.jidesoft.com/products/download.htm)下载一个演示。

# mysql - 如何在 mysql 中编写电子邮件模式？

> ID：822435
> 
> 赞同：0
> 
> 时间：2009-05-04T22:35:36.460
> 
> 标签：mysql

我尝试过的如下：

```
mysql> select 'abc@b.c' REGEXP '[a-zA-Z0-9_]+(?:[\-\+\.][a-zA-Z0-9_]+)*@[a-zA-Z0-9_]+(?:[\-\.\+][a-zA-Z0-9_]+)*\.[a-zA-Z0-9_]+(?:[\-\.\+][a-zA-Z0-9_]+)*'; 
```

错误 1139 (42000)：从正则表达式中得到错误“重复运算符操作数无效”

而且我不知道它有什么问题。

这里有谁能给我合适的可以工作的吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T22:39:21.753

一个应该匹配大多数电子邮件地址的简单正则表达式：

```
[A-z0-9_.%+-]+@[A-z0-9_.%+-]+\.[A-z]{2,4} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T22:46:40.863

请参阅[此处](http://www.regular-expressions.info/email.html)以了解有关使用正则表达式检查电子邮件的信息。看来这是一个相当复杂的问题:-)

# sql - 字符列长度

> ID：822445
> 
> 赞同：1
> 
> 时间：2009-05-04T22:38:21.040
> 
> 标签：sql, database-design

指定列长度有哪些好的经验法则？人们会随意将“VARCHAR(50)”用于名称字段等......但这大部分都是猜测工作。有没有人有他们使用的任何资源？指定字符长度时遵循的经验法则是什么？例如，对于 URL - 这些可能很长，特别是给定最大长度的查询字符串 - 但是使用 VARCHAR(MAX) 似乎超出了顶部，即使将其设为 VARCHAR 只会占用实际字符串数据所需的空间。

请建议/分享-

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T22:47:43.217

诸如 URL 和电子邮件地址之类的 RFC 可能很有用。URL 有 2083 个字符的限制，而电子邮件地址的最大长度为 320 个字符（名称为 64 个，@ 为 1 个，域为 255 个）。

一般来说，对于任何存储用户数据的东西，我都会犯“太长”的错误。对于内部使用，我尝试更加严格。我通常使用 50 作为键，255 作为描述，等等。除非您进行搜索或其他操作，否则您不会看到对性能的太大影响，因此其中很多选择都取决于您的个人喜好。

简而言之：

1.  此数据（URL、电子邮件地址等）存在规范：准确无误
2.  用户数据：喜欢名字之类的东西，为评论文本之类的东西设置一个合理的限制
3.  内部使用：任何漂浮你的船

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T18:25:14.743

通常我会考虑我能想到的字段的最长数据条目的预期长度，然后通常将其添加 10-20% 作为起点，除非我知道数据有指定的限制（邮政编码有指定的长度实例）和我使用它。如果长度在硬限制中（它必须是那个长度而不是其他长度，我使用 Char 数据类型，否则我使用 varchar 或 nvarchar 作为字符串数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T22:42:49.717

至少在 mysql 中，VARCHAR 字段的开销是一个字节，最大宽度可达 255 个字节，或者两个字节，对于任何更大的最大宽度。因此，一个好的经验法则是当您不希望您的数据超过 255 个字节时使用 VARCHAR(255)，或者在其他地方使用 VARCHAR(65535)。

当然，如果您希望对数据有一个真正的硬限制，您可能希望在列定义中设置一个限制以充当第二级数据验证（但如果它足够远导致数据库错误，它应该被认为是更高级别的错误）。

来源：[http ://dev.mysql.com/doc/refman/6.0/en/char.html](http://dev.mysql.com/doc/refman/6.0/en/char.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T22:44:18.107

对于 URL，我会查阅 RFC 以获取 URL。我通常使用 100 个字符的名字和姓氏 - 正如你所说的那样并不重要，因为 (N)VARCHAR 只占用它需要的空间。

我倾向于做的事情：

*   我通常会使用 NVARCHAR 而不是 VARCHAR 作为名称，因为很多名称都需要特殊字符。
*   我确保无论我在数据库中选择什么长度，我都会在 UI 中强制执行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T22:47:34.573

谨慎开始，但保守，可以让你以后扩展，从巨大的长度开始可能会给性能和使用带来未知数 - 并且可能会使以后难以修剪。

你会有很多很多很多很多你不确定的列吗？以后更改它们会是一项艰巨的任务吗？如果没有，那就保守一点，如果你达到了极限，那么你可以扩展——只要记住你不希望这些约束遍布你的代码；尽可能集中它们并在需要时执行它们。

尝试选择比您预期更长的长度，但并非完全不可能。如果它是一个你认为 25 是合理的字段，那么将它设为 50；如果 150 看起来正确，那么将其设为 200。

通常我们将 nvarchar(100) 用于名称，255 用于 URL 或其他可能很长的字段（这些通常只是域名，而不是站点特定页面/资源的完整 URL）。我们的大型机施加了类似的限制，并且每年我们都有一些领域扩展——但我们预料到了这一点，修改它们并不是什么大不了的事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T22:48:22.123

你想优化什么？正如所指出的，常规的 VARCHAR 在成本上没有太大差异，因此不值得为此付出很多努力。您可能关心的另一个原因是某种验证规则，在这种情况下，您需要弄清楚是什么决定了字段值是否有效。然后应用它。

# iphone - 我应该将它存储在一个数组中，还是什么？

> ID：822451
> 
> 赞同：0
> 
> 时间：2009-05-04T22:39:42.767
> 
> 标签：iphone, uitableview, cocoa-touch, rss, populate

我正在制作一个应用程序（iPhone 应用程序），它从 RSS 提要获取信息（笑话），然后填充 tableView。现在，我会获取 RSS 并将其存储在一个数组中，然后填充 tableView，还是什么？

以及如何从 RSS 提要接收信息？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T22:53:39.270

创建一个笑话对象并创建一个充满笑话对象的数组。

提取 RSS 提要数据的一个简单示例是 Apple 开发人员示例站点上的地震 xml 示例，网址为：http: [//developer.apple.com/iphone/library/samplecode/SeismicXML/index.html](http://developer.apple.com/iphone/library/samplecode/SeismicXML/index.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T23:01:11.920

将 NSDictionary 的实例存储在 NSArray 中。通过返回 NSArray 的计数来填充表的行数。通过返回指定行值的 NSArray 的 objectAtIndex 来填充表的行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T23:18:20.507

您可以使用 UITableViewDataSource 为 UITableView 提供数据。你可能想看看[斯坦福 CS193P 的第](http://www.stanford.edu/class/cs193p/cgi-bin/index.php)8 讲，我相信它解释了如何在 iPhone 上使用 TableViews（带有代码示例和来自 Apple 工程师的解释）。

如果您浏览讲义，您可能会找到第二个问题的答案，即如何通过网络获取数据-不是特定于 RSS，但您可能会明白（第 9 讲？-不确定我还没有那么远……）。讲座通过 iTunesU 免费提供，质量极佳，解释了如何构建 iPhone 应用程序。

# javascript - 从文本 JavaScript 中剥离 HTML

> ID：822452
> 
> 赞同：767
> 
> 时间：2009-05-04T22:39:54.607
> 
> 标签：javascript, html, string

有没有一种简单的方法可以在 JavaScript 中获取一串 html 并去除 html？

* * *

## 回答 #1

> 赞同：864
> 
> 时间：2009-05-04T22:48:21.233

如果您在浏览器中运行，那么最简单的方法就是[让浏览器为您完成...](http://jsfiddle.net/8JSZX/)

```
function stripHtml(html)
{
   let tmp = document.createElement("DIV");
   tmp.innerHTML = html;
   return tmp.textContent || tmp.innerText || "";
} 
```

注意：正如人们在评论中指出的那样，如果您不控制 HTML 的源，最好避免这种情况（例如，不要在任何可能来自用户输入的内容上运行它）。对于这些情况，您*仍然*可以让浏览器为您完成工作 -[请参阅 Saba 关于使用现在广泛使用的 DOMParser 的回答](https://stackoverflow.com/questions/822452/strip-html-from-text-javascript/47140708#47140708)。

* * *

## 回答 #2

> 赞同：702
> 
> 时间：2009-05-04T22:42:52.213

```
myString.replace(/<[^>]*>?/gm, ''); 
```

* * *

## 回答 #3

> 赞同：268
> 
> 时间：2011-12-26T01:26:00.003

最简单的方法：

```
jQuery(html).text(); 
```

从一串html中检索所有文本。

* * *

## 回答 #4

> 赞同：203
> 
> 时间：2017-11-06T15:46:44.117

我想分享[**Shog9**已批准答案](https://stackoverflow.com/a/822486/5317080)的编辑版本。

* * *

正如**Mike Samuel**在评论中指出的那样，该函数可以执行内联 javascript 代码。
但是**Shog9**说“让浏览器为你做这件事……”是对的。

所以..这是我编辑的版本，使用[DOMParser](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser)：

```
function strip(html){
   let doc = new DOMParser().parseFromString(html, 'text/html');
   return doc.body.textContent || "";
} 
```

这里是测试内联javascript的代码：

```
strip("<img onerror='alert(\"could run arbitrary JS here\")' src=bogus>") 
```

此外，它不会在解析时请求资源（如图像）

```
strip("Just text <img src='https://assets.rbl.ms/4155638/980x.jpg'>") 
```

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2013-01-15T12:20:49.297

作为 jQuery 方法的扩展，如果您的字符串可能不包含 HTML（例如，如果您尝试从表单字段中删除 HTML）

```
jQuery(html).text(); 
```

如果没有 HTML，将返回一个空字符串

采用：

```
jQuery('<p>' + html + '</p>').text(); 
```

反而。

**更新：** 正如评论中所指出的，在某些情况下，`html`如果 的值`html`可能受到攻击者的影响，则此解决方案将执行其中包含的 javascript，请使用不同的解决方案。

* * *

## 回答 #6

> 赞同：46
> 
> 时间：2009-08-06T08:30:22.097

## 将 HTML 转换为纯文本电子邮件，保持超链接 (a href) 不变

hypoxide 发布的上述函数工作正常，但我想要的东西基本上可以转换在 Web RichText 编辑器（例如 FCKEditor）中创建的 HTML 并清除所有 HTML 但保留所有链接，因为我想要 HTML 和纯文本版本，以帮助为 STMP 电子邮件（HTML 和纯文本）创建正确的部分。

在我自己和我的同事在 Javascript 中使用正则表达式引擎搜索 Google 很长时间之后，我想出了这个：

```
str='this string has <i>html</i> code i want to <b>remove</b><br>Link Number 1 -><a href="http://www.bbc.co.uk">BBC</a> Link Number 1<br><p>Now back to normal text and stuff</p>
';
str=str.replace(/<br>/gi, "\n");
str=str.replace(/<p.*>/gi, "\n");
str=str.replace(/<a.*href="(.*?)".*>(.*?)<\/a>/gi, " $2 (Link->$1) ");
str=str.replace(/<(?:.|\s)*?>/g, ""); 
```

变量开始是`str`这样的：

```
this string has <i>html</i> code i want to <b>remove</b><br>Link Number 1 -><a href="http://www.bbc.co.uk">BBC</a> Link Number 1<br><p>Now back to normal text and stuff</p> 
```

然后在代码运行后它看起来像这样：-

```
this string has html code i want to remove
Link Number 1 -> BBC (Link->http://www.bbc.co.uk)  Link Number 1

Now back to normal text and stuff 
```

正如您所看到的，所有的 HTML 都已被删除，并且链接已被保留，超链接文本仍然完好无损。我还用 (newline char) 替换了`<p>`and`<br>`标记，`\n`以便保留某种视觉格式。

要更改链接格式（例如`BBC (Link->http://www.bbc.co.uk)`），只需编辑`$2 (Link->$1)`，其中`$1`是 href URL/URI，而`$2`是超链接文本。大多数 SMTP 邮件客户端使用纯文本正文中的链接直接转换这些链接，以便用户能够单击它们。

希望您觉得这个有帮助。

* * *

## 回答 #7

> 赞同：35
> 
> 时间：2013-07-31T20:14:59.567

对已接受答案的改进。

```
function strip(html)
{
   var tmp = document.implementation.createHTMLDocument("New").body;
   tmp.innerHTML = html;
   return tmp.textContent || tmp.innerText || "";
} 
```

这样运行的东西不会有任何害处：

```
strip("<img onerror='alert(\"could run arbitrary JS here\")' src=bogus>") 
```

Firefox、Chromium 和 Explorer 9+ 是安全的。Opera Presto 仍然很脆弱。字符串中提到的图像也不会在 Chromium 和 Firefox 中下载保存 http 请求。

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2017-01-20T05:49:54.657

这应该可以在任何 Javascript 环境（包括 NodeJS）上工作。

```
 const text = `
    <html lang="en">
      <head>
        <style type="text/css">*{color:red}</style>
        <script>alert('hello')</script>
      </head>
      <body><b>This is some text</b><br/><body>
    </html>`;

    // Remove style tags and content
    text.replace(/<style[^>]*>.*<\/style>/gm, '')
        // Remove script tags and content
        .replace(/<script[^>]*>.*<\/script>/gm, '')
        // Remove all opening, closing and orphan HTML tags
        .replace(/<[^>]+>/gm, '')
        // Remove leading spaces and repeated CR/LF
        .replace(/([\r\n]+ +)+/gm, ''); 
```

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2012-01-10T12:59:46.957

我更改了[Jibberboy2000 的答案](https://stackoverflow.com/a/1237620/238722)以包含几种`<BR />`标签格式，删除内部的所有内容`<SCRIPT>`和`<STYLE>`标签，通过删除多个换行符和空格来格式化生成的 HTML，并将一些 HTML 编码的代码转换为正常的。经过一些测试，您似乎可以将大部分完整网页转换为保留页面标题和内容的简单文本。

在简单的例子中，

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!--comment-->

<head>

<title>This is my title</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style>

    body {margin-top: 15px;}
    a { color: #D80C1F; font-weight:bold; text-decoration:none; }

</style>
</head>

<body>
    <center>
        This string has <i>html</i> code i want to <b>remove</b><br>
        In this line <a href="http://www.bbc.co.uk">BBC</a> with link is mentioned.<br/>Now back to &quot;normal text&quot; and stuff using &lt;html encoding&gt;                 
    </center>
</body>
</html> 
```

变成

> 这是我的标题
> 
> 这个字符串有我要删除的 html 代码
> 
> 在这一行中，提到了带有链接的BBC ( [http://www.bbc.co.uk )。](http://www.bbc.co.uk)
> 
> 现在回到“普通文本”和使用的东西

JavaScript 函数和测试页面如下所示：

```
function convertHtmlToText() {
    var inputText = document.getElementById("input").value;
    var returnText = "" + inputText;

    //-- remove BR tags and replace them with line break
    returnText=returnText.replace(/<br>/gi, "\n");
    returnText=returnText.replace(/<br\s\/>/gi, "\n");
    returnText=returnText.replace(/<br\/>/gi, "\n");

    //-- remove P and A tags but preserve what's inside of them
    returnText=returnText.replace(/<p.*>/gi, "\n");
    returnText=returnText.replace(/<a.*href="(.*?)".*>(.*?)<\/a>/gi, " $2 ($1)");

    //-- remove all inside SCRIPT and STYLE tags
    returnText=returnText.replace(/<script.*>[\w\W]{1,}(.*?)[\w\W]{1,}<\/script>/gi, "");
    returnText=returnText.replace(/<style.*>[\w\W]{1,}(.*?)[\w\W]{1,}<\/style>/gi, "");
    //-- remove all else
    returnText=returnText.replace(/<(?:.|\s)*?>/g, "");

    //-- get rid of more than 2 multiple line breaks:
    returnText=returnText.replace(/(?:(?:\r\n|\r|\n)\s*){2,}/gim, "\n\n");

    //-- get rid of more than 2 spaces:
    returnText = returnText.replace(/ +(?= )/g,'');

    //-- get rid of html-encoded characters:
    returnText=returnText.replace(/&nbsp;/gi," ");
    returnText=returnText.replace(/&amp;/gi,"&");
    returnText=returnText.replace(/&quot;/gi,'"');
    returnText=returnText.replace(/&lt;/gi,'<');
    returnText=returnText.replace(/&gt;/gi,'>');

    //-- return
    document.getElementById("output").value = returnText;
} 
```

它与此 HTML 一起使用：

```
<textarea id="input" style="width: 400px; height: 300px;"></textarea><br />
<button onclick="convertHtmlToText()">CONVERT</button><br />
<textarea id="output" style="width: 400px; height: 300px;"></textarea><br /> 
```

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2018-07-06T10:39:57.127

```
var text = html.replace(/<\/?("[^"]*"|'[^']*'|[^>])*(>|$)/g, ""); 
```

这是一个正则表达式版本，它对格式错误的 HTML 更具弹性，例如：

**未封闭的标签**

`Some text <img`

**标签属性内的“<”、“>”**

`Some text <img alt="x > y">`

**换行符**

`Some <a href="http://google.com">`

编码

```
var html = '<br>This <img alt="a>b" \r\n src="a_b.gif" />is > \nmy<>< > <a>"text"</a'
var text = html.replace(/<\/?("[^"]*"|'[^']*'|[^>])*(>|$)/g, ""); 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2020-09-03T15:52:21.943

来自 CSS 技巧：

[https://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/](https://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/)

```
const originalString = `
  <div>
    <p>Hey that's <span>somthing</span></p>
  </div>
`;

const strippedString = originalString.replace(/(<([^>]+)>)/gi, "");

console.log(strippedString);
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-05-04T23:14:30.483

另一个显然不如 nickf 或 Shog9 优雅的解决方案是从 <body> 标记开始递归遍历 DOM 并附加每个文本节点。

```
var bodyContent = document.getElementsByTagName('body')[0];
var result = appendTextNodes(bodyContent);

function appendTextNodes(element) {
    var text = '';

    // Loop through the childNodes of the passed in element
    for (var i = 0, len = element.childNodes.length; i < len; i++) {
        // Get a reference to the current child
        var node = element.childNodes[i];
        // Append the node's value if it's a text node
        if (node.nodeType == 3) {
            text += node.nodeValue;
        }
        // Recurse through the node's children, if there are any
        if (node.childNodes.length > 0) {
            appendTextNodes(node);
        }
    }
    // Return the final result
    return text;
} 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2016-08-04T07:38:10.677

如果您想保留链接和内容的结构（h1、h2 等），那么您应该查看[TextVersionJS](http://textversionjs.com/)您可以将它与任何 HTML 一起使用，尽管它是为了将 HTML 电子邮件转换为纯文本而创建的。

用法很简单。例如在 node.js 中：

```
var createTextVersion = require("textversionjs");
var yourHtml = "<h1>Your HTML</h1><ul><li>goes</li><li>here.</li></ul>";

var textVersion = createTextVersion(yourHtml); 
```

或者在纯js的浏览器中：

```
<script src="textversion.js"></script>
<script>
  var yourHtml = "<h1>Your HTML</h1><ul><li>goes</li><li>here.</li></ul>";
  var textVersion = createTextVersion(yourHtml);
</script> 
```

它也适用于 require.js：

```
define(["textversionjs"], function(createTextVersion) {
  var yourHtml = "<h1>Your HTML</h1><ul><li>goes</li><li>here.</li></ul>";
  var textVersion = createTextVersion(yourHtml);
}); 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-12-29T19:11:59.760

也可以使用神奇的[htmlparser2](https://github.com/fb55/htmlparser2)纯 JS HTML 解析器。这是一个工作演示：

```
var htmlparser = require('htmlparser2');

var body = '<p><div>This is </div>a <span>simple </span> <img src="test"></img>example.</p>';

var result = [];

var parser = new htmlparser.Parser({
    ontext: function(text){
        result.push(text);
    }
}, {decodeEntities: true});

parser.write(body);
parser.end();

result.join(''); 
```

输出将是`This is a simple example.`

在这里查看它的实际效果：[https ://tonicdev.com/jfahrenkrug/extract-text-from-html](https://tonicdev.com/jfahrenkrug/extract-text-from-html)

如果您使用 webpack 之类的工具打包您的 Web 应用程序，这在节点和浏览器中都有效。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-01-27T06:55:53.137

很多人已经回答了这个问题，但我认为分享我编写的从字符串中剥离 HTML 标记但允许您包含不想被剥离的标记数组的函数可能会很有用。它很短，对我来说效果很好。

```
function removeTags(string, array){
  return array ? string.split("<").filter(function(val){ return f(array, val); }).map(function(val){ return f(array, val); }).join("") : string.split("<").map(function(d){ return d.split(">").pop(); }).join("");
  function f(array, value){
    return array.map(function(d){ return value.includes(d + ">"); }).indexOf(true) != -1 ? "<" + value : value.split(">")[1];
  }
}

var x = "<span><i>Hello</i> <b>world</b>!</span>";
console.log(removeTags(x)); // Hello world!
console.log(removeTags(x, ["span", "i"])); // <span><i>Hello</i> world!</span> 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2020-04-07T13:33:59.480

为了更简单的解决方案，试试这个=> [https://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/](https://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/)

```
var StrippedString = OriginalString.replace(/(<([^>]+)>)/ig,""); 
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2011-10-04T14:02:41.853

我对原始的 Jibberboy2000 脚本做了一些修改希望它对某人有用

```
str = '**ANY HTML CONTENT HERE**';

str=str.replace(/<\s*br\/*>/gi, "\n");
str=str.replace(/<\s*a.*href="(.*?)".*>(.*?)<\/a>/gi, " $2 (Link->$1) ");
str=str.replace(/<\s*\/*.+?>/ig, "\n");
str=str.replace(/ {2,}/gi, " ");
str=str.replace(/\n+\s*/gi, "\n\n"); 
```

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2015-06-11T22:06:11.093

在尝试了所有提到的答案之后，如果不是全部的话，它们都有边缘情况并且不能完全支持我的需求。

我开始探索 php 是如何做到的，并遇到了复制 strip_tags 方法的 php.js 库：http: [//phpjs.org/functions/strip_tags/](http://phpjs.org/functions/strip_tags/)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2015-12-29T18:46:15.533

```
function stripHTML(my_string){
    var charArr   = my_string.split(''),
        resultArr = [],
        htmlZone  = 0,
        quoteZone = 0;
    for( x=0; x < charArr.length; x++ ){
     switch( charArr[x] + htmlZone + quoteZone ){
       case "<00" : htmlZone  = 1;break;
       case ">10" : htmlZone  = 0;resultArr.push(' ');break;
       case '"10' : quoteZone = 1;break;
       case "'10" : quoteZone = 2;break;
       case '"11' : 
       case "'12" : quoteZone = 0;break;
       default    : if(!htmlZone){ resultArr.push(charArr[x]); }
     }
    }
    return resultArr.join('');
} 
```

> 内部属性和`<img onerror="javascript">`新创建的 dom 元素中的帐户。

用法：

```
clean_string = stripHTML("string with <html> in it") 
```

演示：

[https://jsfiddle.net/gaby_de_wilde/pqayphzd/](https://jsfiddle.net/gaby_de_wilde/pqayphzd/)

最佳答案的演示做可怕的事情：

[https://jsfiddle.net/gaby_de_wilde/6f0jymL6/1/](https://jsfiddle.net/gaby_de_wilde/6f0jymL6/1/)

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2012-07-12T20:38:21.760

这是一个解决@MikeSamuel 安全问题的版本：

```
function strip(html)
{
   try {
       var doc = document.implementation.createDocument('http://www.w3.org/1999/xhtml', 'html', null);
       doc.documentElement.innerHTML = html;
       return doc.documentElement.textContent||doc.documentElement.innerText;
   } catch(e) {
       return "";
   }
} 
```

请注意，如果 HTML 标记不是有效的 XML，它将返回一个空字符串（也就是必须关闭标签并且必须引用属性）。这并不理想，但确实避免了具有安全漏洞利用潜力的问题。

如果没有有效的 XML 标记是您的要求，您可以尝试使用：

```
var doc = document.implementation.createHTMLDocument(""); 
```

但由于其他原因，这也不是一个完美的解决方案。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-01-10T05:40:34.597

我认为最简单的方法就是像上面提到的那样使用正则表达式。尽管没有理由使用一堆。尝试：

```
stringWithHTML = stringWithHTML.replace(/<\/?[a-z][a-z0-9]*[^<>]*>/ig, ""); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2013-08-19T16:12:49.413

我只需要去掉`<a>`标签并将它们替换为链接的文本。

这似乎工作得很好。

```
htmlContent= htmlContent.replace(/<a.*href="(.*?)">/g, '');
htmlContent= htmlContent.replace(/<\/a>/g, ''); 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2015-07-14T12:56:53.937

下面的代码允许您保留一些 html 标签，同时剥离所有其他标签

```
function strip_tags(input, allowed) {

  allowed = (((allowed || '') + '')
    .toLowerCase()
    .match(/<[a-z][a-z0-9]*>/g) || [])
    .join(''); // making sure the allowed arg is a string containing only tags in lowercase (<a><b><c>)

  var tags = /<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,
      commentsAndPhpTags = /<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;

  return input.replace(commentsAndPhpTags, '')
      .replace(tags, function($0, $1) {
          return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';
      });
} 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2016-05-27T00:12:48.387

接受的答案大部分都可以正常工作，但是在 IE 中，如果`html`字符串是`null`你得到的`"null"`（而不是''）。固定的：

```
function strip(html)
{
   if (html == null) return "";
   var tmp = document.createElement("DIV");
   tmp.innerHTML = html;
   return tmp.textContent || tmp.innerText || "";
} 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2019-03-25T20:44:36.647

用 jQuery 剥离 html 的一种更安全的方法是首先使用[jQuery.parseHTML](http://api.jquery.com/jQuery.parseHTML/)创建一个 DOM，忽略任何脚本，然后让 jQuery 构建一个元素，然后只检索文本。

```
function stripHtml(unsafe) {
    return $($.parseHTML(unsafe)).text();
} 
```

可以安全地从以下位置剥离 html：

```
<img src="unknown.gif" onerror="console.log('running injections');"> 
```

和其他漏洞。

开心！

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2012-09-03T15:03:35.140

使用 jQuery，您可以简单地使用

```
$('#elementID').text() 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2012-11-09T16:06:12.267

我自己创建了一个工作正则表达式：

```
str=str.replace(/(<\?[a-z]*(\s[^>]*)?\?(>|$)|<!\[[a-z]*\[|\]\]>|<!DOCTYPE[^>]*?(>|$)|<!--[\s\S]*?(-->|$)|<[a-z?!\/]([a-z0-9_:.])*(\s[^>]*)?(>|$))/gi, ''); 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2013-07-05T09:18:26.177

简单的 2 行 jquery 来剥离 html。

```
 var content = "<p>checking the html source&nbsp;</p><p>&nbsp;
  </p><p>with&nbsp;</p><p>all</p><p>the html&nbsp;</p><p>content</p>";

 var text = $(content).text();//It gets you the plain text
 console.log(text);//check the data in your console

 cj("#text_area_id").val(text);//set your content to text area using text_area_id 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2016-12-09T08:41:42.893

使用jQuery：

```
function stripTags() {
    return $('<p></p>').html(textToEscape).text()
} 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2017-06-14T14:32:08.953

`input`元素[仅支持一行文本](https://www.w3.org/wiki/HTML/Elements/input/text)：

> 文本状态表示元素值的单行纯文本编辑控件。

```
function stripHtml(str) {
  var tmp = document.createElement('input');
  tmp.value = str;
  return tmp.value;
} 
```

**更新：**这按预期工作

```
function stripHtml(str) {
  // Remove some tags
  str = str.replace(/<[^>]+>/gim, '');

  // Remove BB code
  str = str.replace(/\[(\w+)[^\]]*](.*?)\[\/\1]/g, '$2 ');

  // Remove html and line breaks
  const div = document.createElement('div');
  div.innerHTML = str;

  const input = document.createElement('input');
  input.value = div.textContent || div.innerText || '';

  return input.value;
} 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2022-01-09T11:19:59.333

```
const getTextFromHtml = (t) =>
  t
    ?.split('>')
    ?.map((i) => i.split('<')[0])
    .filter((i) => !i.includes('=') && i.trim())
    .join('');

const test = '<p>This <strong>one</strong> <em>time</em>,</p><br /><blockquote>I went to</blockquote><ul><li>band <a href="https://workingclasshistory.com" rel="noopener noreferrer" target="_blank">camp</a>…&lt;/li></ul><p>I edited this as a reviewer just to double check</p>'

getTextFromHtml(test)
  // 'This onetime,I went toband camp…I edited this as a reviewer just to double check' 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2012-03-16T06:25:57.750

```
 (function($){
        $.html2text = function(html) {
            if($('#scratch_pad').length === 0) {
                $('<div id="lh_scratch"></div>').appendTo('body');  
            }
            return $('#scratch_pad').html(html).text();
        };

    })(jQuery); 
```

将其定义为 jquery 插件并按如下方式使用它：

```
$.html2text(htmlContent); 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-11-08T10:44:34.393

对于转义字符，这也可以使用模式匹配：

```
myString.replace(/((&lt)|(<)(?:.|\n)*?(&gt)|(>))/gm, ''); 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2019-02-09T12:48:26.657

[https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)

```
var div = document.getElementsByTagName('div');
for (var i=0; i<div.length; i++) {
    div[i].insertAdjacentHTML('afterend', div[i].innerHTML);
    document.body.removeChild(div[i]);
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2019-12-14T21:28:33.543

方法一：

```
function cleanHTML(str){
  str.replace(/<(?<=<)(.*?)(?=>)>/g, '&lt;$1&gt;');
}

function uncleanHTML(str){
  str.replace(/&lt;(?<=&lt;)(.*?)(?=&gt;)&gt;/g, '<$1>');
} 
```

方法二：

```
function cleanHTML(str){
  str.replace(/</g, '&lt;').replace(/>/g, '&gt;');
}

function uncleanHTML(str){
  str.replace(/&lt;/g, '<').replace(/&gt;/g, '>');
} 
```

另外，不要忘记如果用户碰巧发表了数学评论`(ex: 1 < 2)`，您不想删除整个评论。浏览器（仅经过测试的 chrome）不会将 unicode 作为 html 标签运行。如果您将字符串中的 all 替换`<`为`&lt;`everyware，则 unicode 将显示`<`为文本而不运行任何 html。我推荐方法2。jquery也很好用`$('#element').text();`

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2021-06-08T15:07:34.717

```
var STR='<Your HTML STRING>''
var HTMLParsedText="";
   var resultSet =  STR.split('>')
   var resultSetLength =resultSet.length
   var counter=0
   while(resultSetLength>0)
   {
      if(resultSet[counter].indexOf('<')>0)
      {    
        var value = resultSet[counter];
        value=value.substring(0, resultSet[counter].indexOf('<'))
        if (resultSet[counter].indexOf('&')>=0 && resultSet[counter].indexOf(';')>=0) {
            value=value.replace(value.substring(resultSet[counter].indexOf('&'), resultSet[counter].indexOf(';')+1),'')
        }
      }
        if (value)
        {
          value = value.trim();
          if(HTMLParsedText === "")
          {
              HTMLParsedText = value;
          }
          else
          {
            if (value) {
              HTMLParsedText = HTMLParsedText + "\n" + value;
            }
          }
          value='';
        }
        counter= counter+1;
      resultSetLength=resultSetLength-1;
   }
  console.log(HTMLParsedText); 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-07-05T09:31:20.433

如果您不想为此创建 DOM（也许您不在浏览器上下文中），您可以使用[striptags](https://www.npmjs.com/package/striptags) npm 包。

```
import striptags from 'striptags'; //ES6 <-- pick one
const striptags = require('striptags'); //ES5 <-- pick one

striptags('<p>An HTML string</p>'); 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2021-07-11T08:13:33.890

这个包非常适合剥离 HTML：[https ://www.npmjs.com/package/string-strip-html](https://www.npmjs.com/package/string-strip-html)

它适用于浏览器和服务器（例如 Node.js）。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2022-01-19T08:53:18.730

```
const strip=(text) =>{
    (new DOMParser()?.parseFromString(text,"text/html"))
    ?.body?.textContent
}

const value=document.getElementById("idOfEl").value

const cleanText=strip(value) 
```

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2018-07-04T21:59:23.113

```
function strip_html_tags(str)
{
   if ((str===null) || (str===''))
       return false;
  else
   str = str.toString();
  return str.replace(/<[^>]*>/g, '');
} 
```

# javascript - javascript字符串拆分中的正则表达式，浏览器兼容性问题

> ID：822454
> 
> 赞同：5
> 
> 时间：2009-05-04T22:40:30.067
> 
> 标签：javascript, regex, cross-browser

我一直在调查这个问题，我越深入，它似乎只会变得更糟。

我开始天真地尝试使用这个表达式来分割 HTML 'br' 标签上的字符串：

```
T = captions.innerHTML.split(/<br.*?>/g); 
```

这适用于所有浏览器（FF、Safari、Chrome），除了 IE7 和 IE8，示例输入文本如下：

```
is invariably subjective. <br /> 
The less frequently used warnings (Probably/Possibly) <br /> 
```

请注意，示例文本在“/”之前包含一个空格，并且在换行之前。

以下两项都将匹配每个浏览器中的所有 HTML 标记：

```
T = captions.innerHTML.split(/<.*?>/g);
T = captions.innerHTML.split(/<.+?>/g); 
```

然而，令人惊讶的是（至少对我而言），这在 FF 和 Chrome 中不起作用*：*

```
T = captions.innerHTML.split(/<br.+?>/g); 
```

编辑：

这（在下面的回复中多次建议）不适用于 IE 7 或 8：

```
T = captions.innerHTML.split(/<br[^>]*>/g); 
```

（它确实适用于 Chrome 和 FF。）

我的问题是：有没有人知道在所有当前浏览器中都可以使用的表达式来匹配上面的“br”标签（但不是其他 HTML 标签）。任何人都可以确认上面的最后一个示例应该是有效匹配，因为示例文本中在“>”之前存在两个字符。

PS - 我的文档类型是 HTML 过渡。

编辑：

我想我有证据表明这是特定于 IE 上的 string.split() 行为，而不是一般的正则表达式。您必须使用 split() 来查看此问题。我还发现了一个测试矩阵，当我在 IE 上运行它时，它显示 split() 测试用例的失败率约为 30%。同样的测试在 FF 和 Chrome 上通过了 100% 的测试：

[http://stevenlevithan.com/demo/split.cfm](http://stevenlevithan.com/demo/split.cfm)

到目前为止，我还没有找到IE的解决方案，并且那个测试矩阵的作者提供的库也没有解决这个问题。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T00:13:36.223

您的代码无法正常工作的原因是，当您通过 innerHTML 阅读 HTML 时，IE 会解析 HTML 并使标签变为大写。例如，如果您有这样的 HTML：

```
<div id='box'>
Hello<br>
World
</div> 
```

然后你使用这个 Javascript（在 IE 中）：

```
alert(document.getElementById('box').innerHTML); 
```

您将收到一个警告框：

```
Hello<BR>World 
```

注意`<BR>`现在是大写的。要解决此问题，只需在标志之外添加`i`标志`g`以使正则表达式不区分大小写，并且它将按您预期的方式工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T22:53:36.837

试试这个：

```
/<br[^>]*>/gi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T22:54:34.993

代替

```
/<br.*?>/ 
```

你可以试试

```
/<br[^>]*>/ 
```

即匹配`"<br"`，后跟除 , 之外的任何`'>'`字符`'>'`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T22:54:05.090

正则表达式根本不擅长解析 HTML（请参阅[您能否提供一些示例，说明为什么用正则表达式解析 XML 和 HTML 很困难？](https://stackoverflow.com/questions/701166)为什么）。您需要的是一个 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

特别是您可能对[JavaScript+DOM 答案](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser/773894#773894)感兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T22:57:05.957

好吧，不幸的是我没有各种各样的浏览器在工作（只是 IE - 叹息）但马上我可以看到一种优化你的正则表达式的方法：

```
T = captions.innerHTML.split(/<br[^>]*?>/g); 
```

内联字符类定义 [^>] 指示表达式匹配除大于号之外的任何字符。您可能还希望使其不区分大小写（在末尾传递 gi 而不仅仅是 g）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T00:06:39.003

在 Firefox 3 和 IE7 中测试：

```
/<br.*?>/gi 
```

在这里自己尝试一下：http: [//jsbin.com/ofoke](http://jsbin.com/ofoke)

```
var input = "one <br/>\n" 
          + "two <br />\n" 
          + "three <br>\n" 
; 

alert(input.replace(/<br.*?>/gi, '')); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T04:01:19.703

<\s *br\s* /?\s*>

火柴

```
<br>, <br />, < br >,<br / > 
```

我在 IE.6 中进行[了测试。](http://www.pagecolumn.com/tool/regtest.htm)如果march没问题，js当然可以根据正则进行拆分。

# drm - 有开源的 DRM 解决方案吗？

> ID：822468
> 
> 赞同：53
> 
> 时间：2009-05-04T22:43:54.427
> 
> 标签：drm

是否有一些开源、有据可查和使用的 DRM 框架/库？

我想编写一些用于购买和销售数字产品的框架，我想以某种方式实施，让卖方有可能用某种 DRM 锁定文件，只有授权的计算机才能打开它（一些像 iTunes FairPlay）。

它可以并且可能必须涉及使用一些登录凭据联系我的服务器。

另一方面，我希望客户端是开源的，服务器也可能是开源的……这可能吗？通过默默无闻的安全性不起作用，但 DRM 并不完全是“安全性”......

我所能找到的只是[这个关于 slashdot 的讨论，有完全相同的问题](http://it.slashdot.org/article.pl?sid=08/01/22/0230217)，但它以“DRM IS BAD”和 Sun 的 DReaM 项目结束，但我不知道如何获得[框架的实际代码/用法他们的网站](http://www.openmediacommons.org/)。

如果您认为开源 DRM 是不可能的，请告诉我。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-05T00:16:20.867

这声称是 OMA DRM2 的开源实现。我假设它包含构建服务器和客户端所需的软件组件，而将硬件作为练习留给读者：

[http://sourceforge.net/projects/openipmp](http://sourceforge.net/projects/openipmp)

许可证是 MPL，它是非 GPL 兼容的 FOSS 许可证。

我没有这种实现的经验，但有一点 OMA DRM，当时它似乎是一个可行的 DRM 方案，就像任何 DRM 方案都是可行的一样。OMA DRM 标准有据可查，并且（或至少已经）被移动电话行业广泛使用。

开源 DRM 的根本问题在于，虽然所有算法和源代码都可以在不损害方案的情况下发布，但客户端设备必须得到版权发布者的“信任”才能尊重权利，即不做任何禁止的事情。这与 FOSS 不兼容，后者表示设备的用户应该完全控制它的功能。

*通过默默无闻的安全性不起作用，但 DRM 并不完全是“安全性”*

*通过算法*的晦涩难懂的安全性通常很弱。*通过信息*保密的安全性是进行加密、签名等的唯一方法。DRM 不需要算法的模糊性（这就是为什么 OMA DRM 是一个已发布的标准，以及实现的源代码如何可以发布和免费使用） ，但它确实要求播放器设备可以访问设备用户无法访问的信息（某种密钥），并且这不是算法/源的一部分。

通常，安全保护设备的所有者/用户免受外部攻击者的威胁模型。在 DRM 威胁模型中，设备的所有者/用户*是*攻击者，权利所有者是受到保护的。如果设备的用户可以完全控制它，那么原则上显然游戏结束了。

在实践中，这可能不会那么直接，但在开源案例中，允许人们编写自己的 DRM 客户端以防止他们复制您的受版权保护的数据将要求他们非常诚实。

有时可以说服用户遵守法律，在这种情况下，DRM 起到提醒他们的作用，如果他们跳过箍来绕过限制，那么他们可能会触犯法律。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-04T23:49:03.757

开源 DRM 几乎是不可能的。

DRM 的目的是防止用户解密某些数据，同时允许他们在某些情况下这样做。加密的理论框架使这一点变得荒谬 - 如果用户将其用于批准的目的，他们怎么可能只有解密某些数据的密钥？

现有 DRM 系统采用的解决方案是不遗余力地隐藏密钥 - 一个完美的隐秘安全示例 - 但如果源代码可用，只需修改代码以将密钥交给用户是微不足道的。在这一点上，无论您的加密有多好，用户都拥有破解它所需的一切。

所有这一切的一种解决方案是在某些机器上使用[受信任的平台模块](http://en.wikipedia.org/wiki/Trusted_Platform_Module)来验证所有可能能够访问密钥的软件的二进制映像，并确保密钥本身是不可访问的（由刻录到的秘密衍生的密钥加密-硬件价值）。但是，我不确定 TPM 有多常见，而且这在很大程度上违背了开源软件的初衷，因为您将无法以任何方式修改它而不会失去对 DRM 密钥的访问权限。

最后，在更实际的情况下，DRM 似乎无论如何都在退出 - 例如，iTunes 已经完全摆脱了 DRM，而电影业似乎也在朝着这个方向发展......

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-04T22:51:38.870

对于开源 DRM 解决方案，可能会有开源破解。

许多 DRM 解决方案实际上是基于“隐匿安全”原则工作的。这意味着其中一些尚未损坏，因为他们的模型是保密的。即使这样也不能防止主要的 DRM 系统被破坏。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-06-30T15:16:46.453

DRM 被破坏是因为它依赖于“隐匿安全”原则。

还有其他解决方案，例如水印。
当您向客户出售商品时，您会在其上加上客户名称的水印。如果您在共享网络上找到此水印，您将知道泄漏在哪里。如果客户知道有水印（我认为警告他更诚实），他可能不会分享。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-19T18:53:25.357

I am generally anti-DRM. However, I have seen one implementation of DRM that I could support, and it used the user's credit card info as the decryption key. While not foolproof, it at least has the advantage of using information the user WANTS to keep private. (At least in theory.) It was still portable between my own devices. However, with such a visible key, plus a open source reader, the possibility exists that a user could store and copy the decrypted data, rendering the DRM moot.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-26T08:26:46.307

值得一提的是，它取决于您要保护的内容。如果您想保护您自己拥有的内容，并且内容泄漏造成的损失不是毁灭性的，那么您可以例如查看前面提到的 Open IPMP。Suns DReaM 项目仍然可以在线使用，但值得注意的是，该项目由于不活动而关闭。当您想要保护您不拥有的内容时，就会出现问题。内容所有者很可能不允许他们的内容受到开源 drm 解决方案的保护。内容所有者倾向于使用 Microsoft WMDRM/PlayReady、Marlin 或 Helix 等专有解决方案。因此，如果您的框架将用于销售好莱坞内容，我不建议您将时间花在开源 drm 解决方案上。

# linux - 是否有任何小型 Unix 或 BSD 发行版？

> ID：822469
> 
> 赞同：10
> 
> 时间：2009-05-04T22:44:03.147
> 
> 标签：linux, unix, bsd

我想知道是否有任何小的 BSD 或 unix 版本。我见过的看起来不错的最小 Linux 版本是 partedmagic（大约 70MB）。免费 BSD 需要 4 张 CD，也许更多。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-04T22:47:50.563

**小型发行版**

*   [汤姆srtbt](http://www.toms.net/rb/) ***~1.7M***
*   [微型内核 Linux](http://www.tinycorelinux.com/) ***10mb***
*   迷你BSD [80mb](https://neon1.net/misc/minibsd.html)
*   [越狱 (Linux)](http://jailbait.sourceforge.net/) **16mb**
*   [拜占庭操作系统 (Linux)](http://byzgl.sourceforge.net/wiki/index.php/Main_Page) 32mb
*   [小狗 Linux](http://www.puppylinux.org/home/overview) 94mb
*   [该死的小Linux](http://www.damnsmalllinux.org/) 50mb
*   [该死的小BSD](http://code.google.com/p/evoke/) 50mb
*   [BerliOS (Linux)](https://developer.berlios.de/projects/bonzai/) 180mb
*   [哈曹 (Linux)](http://dotpups.de/hacao) 70mb
*   [mfsBSD](http://mfsbsd.vx.sk/) 25mb

**单张 CD BSD 发行版**

*   [LiveBSD](http://www.livebsd.com/)
*   [FreeSBIE](http://www.freesbie.org/)
*   [蜻蜓BSD](http://www.dragonflybsd.org/)
*   [FreeBSD LiveCD](http://livecd.sourceforge.net/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T03:56:58.090

PicoBSD 是一个基于软盘的微型 BSD。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T22:49:23.103

有一些不错的小型 Linux 发行版。你要找多小？

首先想到的两个是[Damn Small Linux (DSL)](http://www.damnsmalllinux.org/)和[Puppy Linux](http://www.puppylinux.com/)。

DSL <60MB，Puppy 小于 100MB

查看[Distrowatch](http://distrowatch.com/)以获得非常全面且方便的列表 :)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T22:57:07.483

你打赌。

*   DSL（“该死的小 linux”）
*   MINIX（当然属于 UNIX 系列和一些不错的现代特性）
*   有许多小到非常[小的 Solaris 版本](http://opensolaris.org/os/downloads/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-20T22:01:19.707

[tomsrtbt](http://www.toms.net/rb/) ~1.7M; 适合 1.44M 软盘。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T22:48:40.187

是的，有。谷歌是你的朋友。

示例（谷歌“bsd small”上的#1）：

[http://code.google.com/p/evoke/](http://code.google.com/p/evoke/) 70MB FreeBSD 实时环境。

还有很多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T22:50:26.940

这是一个适合 50Mb 的小型 linux 发行版。
[http://damnsmalllinux.org/](http://damnsmalllinux.org/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-04T22:51:11.243

[该死的小型 Linux](http://damnsmalllinux.org/)和[小狗 Linux](http://www.puppylinux.org/home/overview)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-05T04:14:22.370

说 FreeBSD 需要 4 张 CD 有点傻。您可以使用网络安装 CD“仅引导”来安装任何规模的台式机或服务器。它小于 50MB。然后，它只需要下载您需要的相应软件包。如果您想要一些更自定义的东西并且其中一个要求是在没有网络连接的情况下安装它，我认为之前在这个线程中推荐的任何小型发行版都无法提供足够的软件包来使其成为任何比 FreeBSD 的网络安装更可行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-03T20:30:11.677

*   [该死的小Linux](http://damnsmalllinux.org/)
*   [迷你 BSD](https://neon1.net/misc/minibsd.html)

# objective-c - 可可objective-c类中变量前面的下划线如何工作？

> ID：822487
> 
> 赞同：158
> 
> 时间：2009-05-04T22:48:21.437
> 
> 标签：objective-c, cocoa-touch, cocoa, variables, syntax

我在一些 iPhone 示例中看到属性在变量前面使用了下划线 _。有谁知道这意味着什么？或者它是如何工作的？

我正在使用的接口文件如下所示：

```
@interface MissionCell : UITableViewCell {
    Mission *_mission;
    UILabel *_missionName;
}

@property (nonatomic, retain) UILabel *missionName;

- (Mission *)mission; 
```

我不确定上面到底做了什么，但是当我尝试设置任务名称时：

```
aMission.missionName = missionName; 
```

我得到错误：

> 在非结构或联合的情况下请求成员“missionName”

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-05-04T23:40:12.153

如果您为您的 ivars 使用下划线前缀（这只不过是一种通用约定，但一种有用的约定），那么您需要做 1 件额外的事情，以便自动生成的访问器（用于属性）知道要使用哪个 ivar。具体来说，在您的实现文件中，您`synthesize`应该如下所示：

```
@synthesize missionName = _missionName; 
```

更一般地说，这是：

```
@synthesize propertyName = _ivarName; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-05T02:10:07.567

这只是可读性的约定，它对编译器没有任何特殊的作用。您会看到人们在私有实例变量和方法名称上使用它。Apple 实际上建议不要使用下划线（如果您不小心，您可能会覆盖超类中的某些内容），但您不应该因为忽略该建议而感到难过。:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-06-16T01:58:45.923

我看到的唯一有用的目的是如上所述区分局部变量和成员变量，但这不是必要的约定。当与@property 配对时，它会增加综合语句的冗长性——`@synthesize missionName = _missionName;`而且到处都很丑陋。

不要使用下划线，只需在不冲突的方法中使用描述性变量名称。当它们必须发生冲突时，**方法中的变量名应该带有下划线，而不是可能被多个方法使用的成员变量**。唯一有用的地方是在 setter 或 init 方法中。此外，它将使@synthesize 语句更加简洁。

```
-(void)setMyString:(NSString*)_myString
{
    myString = _myString;
} 
```

**编辑：** 使用自动合成的最新编译器功能，我现在对 ivar 使用下划线（在极少数情况下，我需要使用 ivar 来匹配自动合成的功能。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T22:51:19.510

它实际上并没有任何意义，它只是一些人用来区分成员变量和局部变量的约定。

至于错误，听起来 aMission 的类型错误。它的声明是什么？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-05T06:16:46.927

这仅适用于综合属性的命名约定。

当您在 .m 文件中合成变量时，Xcode 会自动为您提供 _variable 智能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-19T05:13:58.197

使用下划线不仅可以在不使用*self.member*语法的情况下解析您的 ivars，而且还可以使您的代码更具可读性，因为您知道变量何时是 ivar（因为它的下划线前缀）或成员参数（没有下划线）。

例子：

```
- (void) displayImage: (UIImage *) image {

    if (image != nil) {
        // Display the passed image...
        [_imageView setImage: image];
    } else {
        // fall back on the default image...
        [_imageView setImage: _image];
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-29T14:20:59.567

这似乎是有关 self.variableName 与 _variablename 问题的“主”项。让我陷入困境的是在.h中，我有：

```
...
@interface myClass : parentClass {
className *variableName;    // Note lack of _
}

@property (strong, nonatomic) className  *variableName;
... 
```

这导致 self.variableName 和 _variableName 成为 .m 中的两个不同变量。我需要的是：

```
...
@interface myClass : parentClass {
className *_variableName;    // Note presence of _
}

@property (strong, nonatomic) className  *variableName;
... 
```

然后，在类'.m 中，self.variableName 和_variableName 是等价的。

我仍然不清楚的是为什么许多示例仍然有效，即使很难做到这一点。

射线

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-24T13:51:01.453

而不是下划线，您可以使用 self.variable 名称，或者您可以合成变量以使用不带下划线的变量或出口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-29T17:57:05.303

其他答案中缺少的是 using`_variable`可以防止您心不在焉地键入`variable`和访问 ivar 而不是（假定的）属性。

编译器将强制您使用`self.variable`或`_variable`。使用下划线使得无法键入`variable`，从而减少了程序员的错误。

```
- (void)fooMethod {

    // ERROR - "Use of undeclared identifier 'foo', did you mean '_foo'?"
    foo = @1;

    // So instead you must specifically choose to use the property or the ivar:

    // Property
    self.foo = @1;

    // Ivar
    _foo = @1;

} 
```

# iphone - 在定时间隔访问和设置 iPhone 的警报/用户警报

> ID：822490
> 
> 赞同：2
> 
> 时间：2009-05-04T22:48:49.937
> 
> 标签：iphone, alert, alarm

有什么方法可以访问或设置 iphone 的闹钟吗？我假设如果这不可用，唯一的另一种方法是推送通知以在定时间隔内提醒用户。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T23:42:35.167

没有用于访问日历或警报的公共 API。

# c# - 我应该先用 C# 编写然后移植到 Web 吗？

> ID：822493
> 
> 赞同：2
> 
> 时间：2009-05-04T22:49:30.997
> 
> 标签：c#, asp.net, prototype

我想写一个网站，但我几乎不知道网络编程。我查看了 ASP.NET，我想知道。我是否应该使用带有表单和许多按钮来测试每个页面/组件的直接 C# 编写我的应用程序？然后移植或有人帮我移植？还是我应该从一开始就直接从 ASP.NET 开始？

-edit- 我在前 6 个答案之后编辑了以下内容，因此它们可能看起来很奇怪

我在想，如果我只使用 C# 和 sqlite，我可以完成更多工作，因为我可以更快地编写废品和测试代码并更快地获得原型。ASP.NET 将花费大量时间来处理简单的基本事情。

注意：我不会做繁重的表单编码。只需简单的 IO 即可从数据库中放置和提取数据。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T22:51:29.243

只需从 asp.net 开始。

WinForms 和 WebForms 不能很好地翻译。特别是如果你正在学习 asp.net

* * *

考虑到您对问题的更新，这仍然是正确的方法。WinForms != WebForms != MVC 或其他任何东西。了解一个并不意味着了解另一个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T22:51:38.183

如果您不了解 Web 编程，那么您在 C# 中所做的任何事情都会非常糟糕地移植到 ASP.NET。你需要先了解网络。

* * *

即使给出您的评论，我的建议仍然有效。首先学习网络编程。如果您愿意，可以先创建一个单独的 DAL 和业务逻辑层；您甚至可以使用测试驱动开发来创建那些。但是在你接触 UI 之前，你需要了解网络是关于什么的，否则你会犯一些你会后悔的错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T22:52:29.320

执行此操作的正确方法是在 C# 中创建一个组件（库）来处理所有数据库工作（读取和存储数据以及验证该数据）。您可以在此基础上构建一个 winform 以确保您的库正常工作。

完成后，从您的 ASP.NET 页面使用该库，您无需担心已经测试过的较低级别的逻辑。

不要试图将你的 winform 代码移植到网络上，因为这不会很好地工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T23:56:56.280

如果这是您第一次使用 C#，您甚至可能更适合通过将代码层与表示层完全分离来开始。我开始在 web 和 win forms 应用程序中使用 UI，而不是学习优秀的编码实践和代码分离。如果您从头开始，您可以先学习代码分离，而不必担心 UI 会做什么。

**所以简而言之，两者都不是。从数据库和自定义数据类之间的良好代码分离开始，然后从那里开始。**

* * *

*这绝不是要完美地说明如何进行良好的代码分离，而是更多关于如何开始的项目符号列表。您可能希望搜索依赖注入、存储库模式等以获得更多最佳实践视图……*

例如，假设您想创建一个联系人管理器应用程序。您知道您将拥有用于插入、更新和删除的代码以及一些搜索和一般联系人列表。

1.  我将首先使用您将知道的所有字段创建您的数据库。
2.  然后我会在数据库中添加一些虚拟数据。
3.  现在我将在我的应用程序中创建数据层。最好这是一个单独的项目，全部编译成一个简单的 DLL。
4.  现在您已经构建了用于存储联系信息的数据类，是时候创建将实际获取数据的层了。转到您的解决方案并添加一个将编译为 DLL 的新项目。
5.  确保数据库可用于您的代码。
    一个。LINQ2SQL
    B. 企业图书馆
6.  创建用于添加、编辑和删除联系人的功能。该参数很可能是您在#3 中创建的联系人对象。
7.  创建用于搜索和返回联系人列表的函数。这应该返回一个在 #3 中创建的 List 或类似的东西......
8.  通过在您的 UI 项目中引用这两个 DLL 来添加任何 UI 层（可以是控制台、Web、win...）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T23:37:01.710

编写所有后端代码，并使用单元测试框架，以确保其正常工作。

一旦你完成了除了显示代码之外的所有工作，你就可以看看做显示，然后选择你想要使用的技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T22:52:44.343

我会说直接写到 ASP.NET。如果您已经了解 WinForms 上的 C#，我认为学习曲线对您来说不会那么糟糕，并且 ASP.NET 中的数据绑定模型在很多方面都不同，我认为您只需编写一次就会受益。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T22:52:56.917

如果您打算作为一名真正的程序员尝试它并且您打算创建一个网站，请在跳入 C# 之前继续学习 html 和 css。网上有很多很棒的免费资源。

学习 html 和 css，然后尝试使用 Asp.Net MVC 来轻松地进行动态 Web 开发。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T22:53:42.827

正如其他人所说，首先从asp.net开始。我建议首先编写一个小测试应用程序，它可以在小空间内完成您需要大应用程序执行的操作。

winforms 和 asp.net 页面之间的差异有一些绊脚石。所以以上内容应该可以帮助您克服其中的一些问题。

# c# - 这将如何运作？（接口和非虚函数）

> ID：822494
> 
> 赞同：2
> 
> 时间：2009-05-04T22:50:24.333
> 
> 标签：c#, .net, interface

```
interface I { int J(); }

class A : I
{
   public  int J(){return 0; }  // note NOT virtual (and I can't change this)
}

class B : A, I
{
   new public int J(){return 1; }
}

B b = new B();
A a = b;
I ib = b, ia = a;

b.J(); // should give 1
a.J(); // should give 0 (IMHO)

ia.J(); // ???
ib.J(); // ??? 
```

我知道我可以尝试一下，但我正在为整个角落寻找一个好的*权威*来源，我宁愿不只是开始短视地挖掘 MSDN 文本（我不知道谷歌的目的是什么）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T23:48:05.287

**重写：**因为我们正在讨论实现 IDisposable，所以*真正*重要的是确保 Derived 和 Base 类都有机会运行它们各自的清理代码。这个例子将涵盖场景的 2/3；但是，由于它派生自 Base() 并且 Base.Dispose() 不是虚拟的，因此对 ((Base)Child).Dispose() 的调用不会为 Child 类提供清理的机会。

唯一的解决方法是不要从 Base 派生 Child；然而这已经被排除了。调用 ((IDisposable)Child).Dispose() 和 Child.Dispose() 将允许 Child 和 Base 执行它们的清理代码。

```
class Base : IDisposable
{
    public void Dispose()
    {
        // Base Dispose() logic
    }
}

class Child : Base, IDisposable
{
    // public here ensures that Child.Dispose() doesn't resolve to the public Base.Dispose()
    public new void Dispose()
    {
        try
        {
            // Child Dispose() logic
        }

        finally
        {
            // ensure that the Base.Dispose() is called
            base.Dispose();
        }
    }

    void IDisposable.Dispose()
    {
        // Redirect IDisposable.Dispose() to Child.Dispose()
        Dispose();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T22:53:27.540

与基类或接口提供的合同对话无关紧要，它们都将返回 1，因为您正在与 B 类的实例对话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-01T07:45:46.473

Jeffrey Richter（通过 C# 的 CLR）：“C# 编译器要求将实现接口的方法标记为 public 。CLR 要求将接口方法标记为 virtual 。如果您没有在源代码中明确地将方法标记为 virtual , 编译器将该方法标记为虚拟和密封；这可以防止派生类覆盖接口方法。如果您将方法显式标记为虚拟，编译器会将方法标记为虚拟（并使其未密封）；这允许派生类覆盖接口方法”

# wcf - WCF 继承/多态和序列化

> ID：822503
> 
> 赞同：3
> 
> 时间：2009-05-04T22:51:50.633
> 
> 标签：wcf, datacontractserializer

我有一个类，`ReportDef`，它是一个具体的类，我根据需要使用`[DataContract]`和`[DataMember]`属性进行了装饰。 与我的,一起`ReportDef`组装。然后我有另一个类，，它派生自并在 assembly 。 没有服务关心的附加状态。 `A1``ServiceContract``IReportService``UiReportDef``ReportDef``A2``UiReportDef`

我想用`UiReportDef`. 有没有办法（除了手动构造一个`ReportDef`实例`UiReportDef`）在我的服务不知道的情况下做到这一点`A2`？我知道`KnownType`。我不想参考`A2`。

* * *

**编辑：**这里有一些上下文可能会让我的问题更容易理解。我的`ServiceContract`工具`IReportService`定义了一个方法，`RunReport(ReportDef report)`. `ReportDef`用`DataContract`属性装饰，并且有用 . 装饰的私有成员`DataMember`。 `UiReportDef`是在依赖于UI相关程序集等的程序集中。我没有设计现有的类层次结构。我需要将`ReportDefs`and `UiReportDefs`(as `ReportDefs`) 传递给新服务。由于`ReportDef`是具体的，我希望序列化程序`UiReportDefs`在`ReportDefs`没有任何其他信息的情况下处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T09:40:47.093

我没听懂你的问题。

但我想我现在理解了一部分，你想反序列化一个没有引用它的程序集中的对象吗？

如果是这样，除非您愿意进行大量反思并将其定义/引用为“对象”，否则您不能这样做

执行此操作并试图在我之前的回答中解释的常用方法是您应该使用客户端/服务器都可以引用的接口。

在这种情况下，通常的做法是创建只包含接口的存根程序集。

或者正如您对问题的评论所暗示的那样，您可以使用 DTO 对象。 [http://en.wikipedia.org/wiki/Data_Transfer_Object](http://en.wikipedia.org/wiki/Data_Transfer_Object)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-08T15:14:58.327

这个线程可能有很大帮助：[WCF Inheritance and DataContract](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/dd9adca0-7422-4d51-bd79-487dafe3386d/)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-05T09:35:03.317

WCF 不是多态的，因为它不是面向对象的。因此这是不可能的。

# windows - 如何在winforms中重新绑定组合框？

> ID：822504
> 
> 赞同：3
> 
> 时间：2009-05-04T22:52:17.497
> 
> 标签：windows, vb.net, winforms, combobox

我有一个 Winforms 应用程序和一个组合框，当表单加载时，它的数据源设置为 DataTable。数据在组合框中显示良好。

然后，在用户单击按钮后，我想创建一个新的 DataTable 并将该数据表分配为组合框的数据源。

问题是在将数据源设置为新数据表后，组合框中的项目不会改变。这是我正在使用的代码。

```
dlCustomer.DataSource = Nothing
        dlCustomer.DataSource = dtCustomers
        dlCustomer.DisplayMember = "Name"
        dlCustomer.Refresh() 
```

有谁知道如何在我第二次为其分配数据源时在组合框中显示正确的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T23:21:43.977

它应该可以工作，至少在我一起进行的快速测试中它确实有效。这是代码；它只需要一个带有 ComboBox 和 Button 的表单：

```
 Public Class Form1

        Private dtOne As DataTable
        Private dtTwo As DataTable

        Private Sub InitializeTables()
            dtOne = New DataTable("TableOne")
            With dtOne
                .Columns.Add("Text", GetType(String))
                .Columns.Add("Value", GetType(Integer))
            End With

            dtTwo = New DataTable("TableTwo")
            With dtTwo
                .Columns.Add("Text", GetType(String))
                .Columns.Add("Value", GetType(Integer))
            End With

            Dim newRow As DataRow
            For index As Integer = 0 To 2
                newRow = dtOne.NewRow
                newRow.ItemArray = (New Object() {SpellIt(index), index})
                dtOne.Rows.Add(newRow)
            Next

            For index As Integer = 2 To 0 Step -1
                newRow = dtTwo.NewRow
                newRow.ItemArray = (New Object() {SpellIt(index), index})
                dtTwo.Rows.Add(newRow)
            Next

            dtOne.AcceptChanges()
            dtTwo.AcceptChanges()

        End Sub

        Private Shared Function SpellIt(ByVal int As Integer) As String
            Select Case int
                Case 0 : Return "Zero"
                Case 1 : Return "One"
                Case 2 : Return "Two"
                Case Else : Throw New ArgumentOutOfRangeException("Bleh!")
            End Select
        End Function

        Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
            InitializeTables()

            Me.Label1.DataBindings.Add("Text", ComboBox1, "SelectedValue")

            Me.ComboBox1.DataSource = dtOne
            Me.ComboBox1.DisplayMember = "Text"
            Me.ComboBox1.ValueMember = "Value"

        End Sub

        Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
            Me.ComboBox1.DataBindings.Clear()
            Me.ComboBox1.DataSource = Nothing

            Me.ComboBox1.DataSource = dtTwo
            Me.ComboBox1.DisplayMember = "Text"
            Me.ComboBox1.ValueMember = "Value"

        End Sub

    End Class 
```

# wiki - 需要一个简单的 wiki 系统来代替 DokuWiki 与我的主页集成

> ID：822506
> 
> 赞同：0
> 
> 时间：2009-05-04T22:52:39.647
> 
> 标签：wiki

目前我正在使用 DokuWiki 来管理我的应用程序/脚本文档，我写的一些文章和类似的东西......我非常喜欢 DokuWiki，它简单而强大，但对于我在过去 1/2 年。

我需要一些别的东西，一些不同的东西......

我正在寻找一种方法将我喜欢的 DokuWiki 中的小东西集成到我自己的网站中，而不需要像 DokuWiki 这样的脚本，它有自己的管理页面。网站本身，我的主页，我喜欢自己编写大部分内容，以便它成为我想要的。然而，我没有太多时间去做的事情，这就是我使用 DokuWiki 的原因。

我想放弃 DokuWiki 和类似的脚本，因为我什至没有使用它们的一半功能。wiki 是一个平台，人们可以在这个平台上齐心协力，共同协作写东西，它也有一个修订系统。这是我自己并不关心的关于 wiki 的两个非常重要的方面。我是那里唯一一个写东西的人，我不关心修订，从不需要它们。

我喜欢 DokuWiki 的地方在于，我可以将浏览器指向 wiki 域中的任何 URL，如果它不存在，则从那里创建一个页面。我也非常喜欢 DokuWiki 的语法，但有时它非常有限，我不能做我想做的事。您在命名空间等之间链接的方式也非常好。太完成了，媒体/文件管理器也非常方便。这些可能是我在 DokuWiki 中最重要的方面。

基本上，我正在寻找一些东西，也许是一个脚本，它可以让我以一种我可以集成到我自己的网站中而无需特殊管理区域的方式来完成我上面描述的事情。

有谁知道这样的事情，或者我最好自己编写代码，因为我的要求一开始并不那么棘手，我只是不想做额外的工作......

或者也许还有其他建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T23:01:25.430

也许你会想看看像[TiddlyWiki](http://tiddlywiki.com/)这样的东西，它是一个单文件 wiki，你甚至可以把它放在 U 盘上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-13T21:17:40.607

我选择了 xwiki 而不是 dokuwiki。

另一个简单的wiki 是fogbugz 附带的。它最多可供 2 个用户免费托管，并且可能适合您的项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-24T15:04:15.197

我可能不在，但没有管理和用户的非常简单的 wiki 是[LionWiki](http://lionwiki.0o.cz/)。我不知道将它集成到您​​的网站有多么容易。

它只是一个文件，不使用数据库（如 DokuWiki）。

虽然它没有很多功能。它还使用与 DokuWiki 不同的语法。

# internet-explorer - 如何向 IE6/IE7 浏览器显示升级到 IE8 的消息并让 IE8 不显示 IE7 警告？

> ID：822508
> 
> 赞同：24
> 
> 时间：2009-05-04T22:52:55.217
> 
> 标签：internet-explorer, internet-explorer-8

我只想允许使用 IE8（不是 IE6、IE7）或其他浏览器的用户在登录时访问我的网站。

我关注了：[http](http://code.google.com/p/ie6-upgrade-warning/) ://code.google.com/p/ie6-upgrade-warning/ 但我也希望它不允许 IE7 用户在登录时使用主站点（他们可以查看公共页面。）原因是主 Web 应用程序有很多 JavaScript 效果，只能在 IE8 呈现模式（或除 IE 之外的任何其他浏览器）下 100% 工作。

将 ie6 升级警告修改为 ie7 的问题在于，它看起来像 IE8 以 IE7 呈现模式显示我的网页，并且“谎报”为 ie7 并触发 IE7 样式表代码。

那么如何强制 IE8 始终以 IE8 模式呈现我的页面？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-04T23:19:44.170

使用这个标签：

```
<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-04T23:00:52.967

更正 AdamSane 的示例：

> `<!--[if lt IE 8]> Special instructions for IE 7 or less here <![endif]-->`

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-07-27T15:25:03.370

这是一个很好的链接，建议一些解决方案

[http://garmahis.com/tools/ie6-update-warning/](http://garmahis.com/tools/ie6-update-warning/)

我个人喜欢第四个解决方案（[http://www.browser-update.org/](http://www.browser-update.org/)）

只是小菜一碟

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-09-04T21:01:03.677

出于安全原因，我个人建议用户升级 IE。我会使用条件注释来定位 IE8 以下的浏览器。

```
 <!--[if lt IE 8]>You are using an outdated version of Internet Explorer.  For security reasons you should upgrade your browser. Please go to Windows Updates and install the latest version.<![endif]--> 
```

这条信息应该不显眼但优雅。您还应该使网站可供那些无法升级浏览器的人使用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-02-15T16:10:32.813

我没有尝试强制 IE 8+ 模式，而是结合使用条件注释和简单的 javascript 检查。该`document.documentMode`属性是在版本 8 中添加到 IE 中的，因此如果它存在（无论值如何，尽管此代码必须为 7），这意味着我们处于兼容模式并且不应显示警告：

```
<!--[if lte IE 7]>
    <script>
        if (!document.documentMode) { //if documentMode exists, this is a later IE in compatibility mode
            showBadBrowserMessage();
        }
    </script>
<![endif]--> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-01-22T21:47:14.153

这是适用于所有旧浏览器的酷脚本：

```
<script type="text/javascript"> 
    var $buoop = {vs:{i:7,f:5,o:12,s:5,n:9}}; 
    $buoop.ol = window.onload; 
    window.onload=function(){ 
     try {if ($buoop.ol) $buoop.ol();}catch (e) {} 
     var e = document.createElement("script"); 
     e.setAttribute("type", "text/javascript"); 
     e.setAttribute("src", "//browser-update.org/update.js"); 
     document.body.appendChild(e); 
    } 
</script> 
```

注意：如果访问者忽略了该建议，它将在一段时间内不会再次出现。

更多可以找到：[这里](http://browser-update.org/#install)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T22:59:36.387

取决于您如何编写 (X)HTML，但如果您有严格的文档类型，IE8 应该使用标准模式（而不是 IE7 模式），例如：

```
<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

在 HTML 文件的顶部。

[XHTML 1.0 规范 - 严格符合文档](http://www.w3.org/TR/xhtml1/#strict)

这是一篇关于不同 doctypes/etc 如何影响 IE8 的呈现模式的好文章：[Understanding Compatibility Modes in Internet Explorer 8](http://blogs.msdn.com/askie/archive/2009/03/23/understanding-compatibility-modes-in-internet-explorer-8.aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-04T23:13:31.860

如果他们使用的是旧版本的 IE，最好的方法可能是检测用户的浏览器 User-Agent 字符串并将他们重定向到要求他们升级（或下载不同的浏览器，如 firefox 或 chrome）的页面。[您可以在此IE 开发人员博客条目](http://blogs.msdn.com/ie/archive/2009/01/09/the-internet-explorer-8-user-agent-string-updated-edition.aspx)中查看 IE 7 和 8 的用户代理示例。旧版本的 IE 遵循类似的模式。

但是，您不应该做的一件事是假设任何不遵循特定模式的用户代理字符串都是无效的。只需检查 MSIE ([0-9]) 并查看它是否在范围内；如果它完全丢失，则假设浏览器受支持。如果是 MSIE 7，则进一步检查指示兼容模式的 Trident 标记（并且，我想，请用户将其关闭）。这将允许其他未来的新贵浏览器有机会呈现您的页面，而无需将它们拒之门外:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-04T23:20:05.510

如前所述，我建议实现此目的的最佳方法是使用条件注释来包含特定于 8 之前的所有 IE 版本的样式表：

```
<!--[if lt IE 8]> Include CSS here <![endif]--> 
```

包含的 CSS 可以将警告设置为可见，或者在页面上启用“锁定”用户的覆盖。包含一些隐藏页面上重要元素的规则可能是个好主意，否则如果它们不能按预期工作，可能会使用户感到困惑。

您的另一个选择是将用户重定向到另一个页面 - 我不是重定向的忠实粉丝，但如果小心使用它们可能是一个合适的解决方案。

您是否考虑过**为什么**要将大量用户锁定在您的网站之外？也许您应该花时间研究如何优雅地降级您的 JavaScript，或者反过来；使用 JavaScript “逐步增强”。

另一方面，您可能可以控制使用您的站点的组织使用的系统，在这种情况下，您可能可以阻止人们使用非标准系统。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-04T22:58:40.147

您可以使用 CSS 条件注释

```
<!--[if IE 8]>
Special instructions for IE 6 here
<![endif]--> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-04T23:06:55.120

使用 javascript 您可以询问哪个浏览器发送了请求>

```
<script type="text/javascript">
function detectBrowser()
{
var browser=navigator.appName;
var b_version=navigator.appVersion;
var version=parseFloat(b_version);
if (browser=="Microsoft Internet Explorer")
  && (version>=8))
  {
  alert("Your browser is good enough!");
  }
  else
  {
  alert("It's time to upgrade your browser!");
  }
  }
 </script> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-29T19:13:16.257

这个聚会结束了吗？><

是的，但我认为这里的信息可以更新一点。

按照今天的标准，“今天”是 2013 年 10 月 29 日，您可以使用此元标记来触发最新的 IE 浏览器和文档模式，并触发在旧 IE 中安装 Google 的 Chrome 框架：

`<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">`

这允许您服务器特定的 IE6/7 样式。请记住，我说的是“样式”而不是“样式表”，意思是：您只使用一个 CSS 文件，其中包含您所有的 IE6 和 IE7 样式。这是为了尽量减少 HTTP 请求……但那是完全不同的对话。

无论如何，使用上面的代码片段就不需要脚本或条件注释。

**注意：** Google Chrome Frame 将于 2014 年 1 月停用 -[更多信息请点击此处](http://blog.chromium.org/2013/06/retiring-chrome-frame.html)。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2009-05-04T23:01:37.397

您从您的网站“禁止”IE 6 和 7 用户的想法是荒谬的。很多人因为工作限制或不知道如何升级浏览器或安装另一个浏览器。从长远来看，禁止这些人使用您的网站只会让您的用户付出代价。

要么修复你的 JavaScript，解决问题，要么优雅地降级，以便网站即使关闭也能正常工作。

编辑：我在下面的评论中发布了更多信息，这些信息应该在这篇文章中：

通常可以检测到 IE 并解决它。天啊，你甚至可以使用条件注释来加载不同版本的 JavaScript。使用 JS 框架会将浏览器之间的差异抽象到您无需担心的程度。或者只是抓住[IE7.js](http://code.google.com/p/ie7-js/)并将其粘贴在网站上 - 我听说它可以让您难以置信的工作。

# selenium-rc - 带巡航控制的 selenium rc - testng 错误消息 - 无法实例化“测试”

> ID：822510
> 
> 赞同：1
> 
> 时间：2009-05-04T22:53:25.480
> 
> 标签：selenium-rc, cruisecontrol, testng

我目前正在尝试设置 Cruisecontrol 来运行我的硒测试套件。在我运行构建之前一切正常，我收到以下消息：

在构建文件 C:\Project\src\build.xml 中调用目标 [执行测试]
进入 C:\Project\src\build.xml...
退出 C:\Project\src\build.xml。
task location="C:\Project\src\build.xml:30:" name="antcall" time="0 seconds"
target name="execute-test" time="0 seconds"
task location="C:\ Project\src\build.xml:37: "name="testng" time="0 seconds"
使用参数执行 'C:\Program Files (x86)\Java\jdk1.6.0_06\jre\bin\java.exe' : '-ea' '-classpath' 'C:\testng;C:\testng\testng-5.9-jdk15.jar;C:\testng\commons-lang-2.0.jar;C:\testng\testng-5.9- jdk14.jar''org.testng.TestNG''@C:\DOCUME~1\SERVER~1\LOCALS~1\Temp\1\testng10509'

可执行文件和参数周围的 ' 字符不是命令的一部分。
[Parser] 运行：
C:\Project\src\TestSuite.xml
[TestRunner] 在 'testInpagePlacement' 中以并行模式运行测试：false
[RunInfo] 添加方法选择器：org.testng.internal.XmlMethodSelector@9664a1 优先级：10
[ ClassHelper] 无法实例化 testcase1：testcase1
[ClassHelper] 无法实例化 testcase1：testcase1
================================= ==============
[烟雾测试]
[总测试运行：0，失败：0，跳过：0]
================= ==============================
[org.testng.TestNGException:]
[在类路径中找不到类：testcase1]
在 org.testng.xml.XmlClass.getSupportClass(XmlClass.java:55)
在 org.testng.internal.Utils.xmlClassesToClasses(Utils.java:79)
在 org.testng.TestRunner.initMethods(TestRunner.java:289)
在org.testng.TestRunner.init(TestRunner.java:235)
at org.testng.TestRunner.init(TestRunner.java:197)
at org.testng.TestRunner.(TestRunner.java:141)
at org.testng.SuiteRunner$ DefaultTestRunnerFactory.newTestRunner(SuiteRunner.java:488)
at org.testng.SuiteRunner.privateRun(SuiteRunner.java:250)
at org.testng.SuiteRunner.run(SuiteRunner.java:204)
at org.testng.TestNG.createAndRunSuiteRunners(TestNG .java:877)
在 org.testng.TestNG.runSuitesLocally(TestNG.java:842)
在 org.testng.TestNG.run(TestNG.java:751)
在 org.testng.TestNG.privateMain(TestNG.java:914)
在 org.testng.TestNG.main(TestNG.java:887)
测试失败。

这是在网络服务器上运行的，我通过 intellij 在本地测试了 testsuite.xml，一切正常。我觉得这是网络服务器的配置问题，如果我的假设是错误的，请告诉我，并指出正确的方向来解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-08T02:02:27.513

您的类路径中没有您的类（测试和目标类）。

# ftp - 在 FTP 上传期间，发送文件的总大小？

> ID：822528
> 
> 赞同：2
> 
> 时间：2009-05-04T22:58:15.873
> 
> 标签：ftp

当您通过 HTTP 发送文件时，Web 浏览器会在 http 标头中发送文件总大小。

你认为它与 FTP 协议相同吗？

马丁

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T23:24:40.867

FTP 有多种传输模式，但没有一种会预先发送文件的整个长度。[您可以在RFC 959](http://www.faqs.org/rfcs/rfc959.html)的第 3.4 节中看到它们。

请注意，[RFC 3659](https://www.rfc-editor.org/rfc/rfc3659#section-4.1)中定义的 SIZE 命令纯粹用于下载，而不是上传。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:23:07.157

不，FTP 文件传输被视为在连接正常关闭时结束的字节流。RFC3659 中为 FTP 定义了一个新的“SIZE”命令，但这是一个相当新的添加，我猜它并没有看到很多用处。

# c# - Outlook 2007 MailItem 信息 - 慢

> ID：822534
> 
> 赞同：0
> 
> 时间：2009-05-04T23:00:40.953
> 
> 标签：c#, visual-studio-2008, outlook, outlook-2007

我正在尝试在 Outlook 2007 中解析电子邮件。我需要尽快对其进行精简，但似乎遇到了一些麻烦。

基本上是：

```
foreach( Folder fld in outllookApp.Session.Folders )
{
    foreach( MailItem mailItem in fld )
    {
        string body = mailItem.Body;
    }
} 
```

对于 5000 封电子邮件，这需要 100 多秒。在我看来，这似乎不应该花这么长时间。

如果我添加：

```
string entry = mailItem.EntryID; 
```

它最终是一个额外的 30 秒。

我正在做各种字符串操作，包括使用这些字符串的正则表达式并将其写入数据库，但这两行仍然占用了我运行时间的 50%。

我正在使用 Visual Studio 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T23:10:20.277

我不知道这是否会解决您的具体问题，但最新的 Office 2007 服务包为包含大量邮件的 Outlook 带来了显着的性能差异（改进）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T12:14:39.413

做这种事情需要很长时间，因为您必须从每个项目的交换存储中提取数据。

我认为你在这里有几个选择..

在其他过程中使用 CDO/RDO 在带外处理此信息。或者使用 MapiTables，因为这是获取属性的最快方法，但有一些注意事项，您可能在您的进程中做一些可以带入表格的事情。

兑换包装 - [http://www.dimastr.com/redemption/mapitable.htm](http://www.dimastr.com/redemption/mapitable.htm)

MAPI 表[http://msdn.microsoft.com/en-us/library/cc842056.aspx](http://msdn.microsoft.com/en-us/library/cc842056.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T23:31:24.093

你*只是*在这个循环中读取这些字符串，还是在读取一个字符串，处理它，然后继续下一个？您可以尝试将所有消息读入循环内的 HashTable 中，然后在它们被加载后处理它们——这可能会给您带来一些收益。

任何类型的 UI 更新都非常昂贵；如果您要写出文本或增加进度条，最好谨慎行事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T17:18:34.180

即使文件夹在本地并且没有网络延迟，我们也遇到了完全相同的问题。

通过将每封电子邮件的副本存储在为我们需要的搜索而调整的本地 Sql Server CE 表中，我们获得了 10 倍的加速。我们还使用更新事件来确保本地数据库与 Outlook/Exchange 文件夹保持同步。

为了完全消除用户延迟，我们将搜索从 Outlook 线程中取出，并将其放入自己的线程中。滞后的感觉比看起来的实际延迟更糟糕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-05T08:13:06.537

我在尝试通过 VBA（在 excel 中）访问 Outlook 邮件时遇到了类似的情况。但是，在我的情况下它要慢得多：**每秒 1 封电子邮件**！（由于我在 VBA 上实现了它，因此我的情况可能比您的情况慢）。

无论如何，我成功地通过使用 SetColumnns 提高了速度（例如[https://docs.microsoft.com/en-us/office/vba/api/Outlook.Items.SetColumns](https://docs.microsoft.com/en-us/office/vba/api/Outlook.Items.SetColumns)）

我知道..我知道..这仅适用于少数属性，例如“主题”和“接收时间”，不适用于正文！但再想一想，你真的想通读所有电子邮件的正文吗？或者它只是一个子集？也许基于它的“主题”行或“接收时间”？我的要求是进入电子邮件正文，以防其主题与特定字符串匹配！

因此，我做了以下事情：

我添加了第二个名为“myFilterItemCopyForBody”的“Outlook.Items”obj，并应用了与另一个“Outlook.Items”相同的过滤器。所以，现在我有两个“Outlook.Items”：“myFilterItem”和“myFilterItemCopyForBody”，它们都具有相同的电子邮件项目，因为两者都应用了相同的限制条件。

'myFilterItem'- 仅保存相关邮件的 'Subject' 和 'ReceivedTime' 属性（使用 SetColumns 完成） 'myFilterItemCopyForBody'- 保存邮件的所有属性（包括正文）

现在，'myFilterItem' 和 'myFilterItemCopyForBody' 都使用 'ReceivedTime' 进行排序，以使它们具有相同的顺序。

排序后，两者都会在每个循环的嵌套中同时循环，并选择相应的属性（在计数器的帮助下），如下面的代码所示。

```
Dim myFilterItem As Outlook.Items

Dim myItems As Outlook.Items
Set myItems = olFldr.Items

Set myFilterItemCopyForBody = myItems.Restrict("@SQL=""urn:schemas:httpmail:datereceived"" > '" & startTime & "' AND ""urn:schemas:httpmail:datereceived"" < '" & endTime & "'")
    Set myFilterItem = myItems.Restrict("@SQL=""urn:schemas:httpmail:datereceived"" > '" & startTime & "' AND ""urn:schemas:httpmail:datereceived"" < '" & endTime & "'")

myFilterItemCopyForBody.Sort ("ReceivedTime")
myFilterItem.Sort ("ReceivedTime")

myFilterItem.SetColumns ("Subject, ReceivedTime")

    For Each myItem1 In myFilterItem
        iCount = iCount + 1
        For Each myItem2 In myFilterItemCopyForBody
            jCount = jCount + 1
            If iCount = jCount Then
               'Display myItem2.Body if myItem1.Subject contain a specific string
                'MsgBox myItem2.Body
                jCount = 0
                Exit For
            End If
        Next myItem2
    Next myItem1 
```

***注意 1：***请注意，使用与“myFilterItemCopyForBody”对应的“myItem2”访问 Body 属性。

***注2：***编译器进入循环访问body属性的次数越少越好！您可以通过使用 Restrict 和逻辑来进一步提高效率，以降低编译器必须循环遍历逻辑的次数。

希望这会有所帮助，即使这不是什么新鲜事！

# sql - 在 Rails 中使用 activerecord 进行多个连接

> ID：822537
> 
> 赞同：1
> 
> 时间：2009-05-04T23:01:06.490
> 
> 标签：sql, ruby-on-rails, activerecord, join

我正在构建一个小型 twitter 风格的微博服务，用户可以在其中关注其他用户并获取他们的消息提要

我有以下型号：

```
class Follow < ActiveRecord::Base
  belongs_to :follower, :class_name => "User"
  belongs_to :followee, :class_name => "User"
end

class User < ActiveRecord::Base
  has_many :follows,   :foreign_key => 'follower_id',
                       :class_name => 'Follow'
  has_many :followers, :through => :follows
  has_many :followed,  :foreign_key => 'followee_id',
                       :class_name => 'Follow'
  has_many :followees, :through => :followed
  has_many :messages
end

class Message < ActiveRecord::Base
  belongs_to :user
end 
```

要获取当前用户的提要，我想执行以下 SQL 查询：

```
SELECT * FROM follows JOIN users JOIN messages WHERE follows.follower_id = current_user.id AND follows.followee_id = users.id AND users.id = messages.user_id; 
```

这样做的正确 ActiveRecord 方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T13:02:46.703

不知道你在找什么，但这是我的建议：

我假设您对该 Follow 课程还有其他目的，否则我看不到它的目的。

这样做的“正确方式”（即我完全主观的方式）实际上是这样的：

```
class User < ActiveRecord::Base
  has_and_belongs_to_many :followers, :foreign_key => 'followed_id', 
      :class_name => 'User', :association_foreign_key => 'follower_id', 
      :include => [:messages]
  has_and_belongs_to_many :follows, :foreign_key => 'follower_id', 
      :class_name => 'User', :association_foreign_key => 'followed_id'
  has_many :messages
end

class Message < ActiveRecord::Base
  belongs_to :user
end 
```

然后创建下表：

```
create_table :users_users, :id => false do |t|
  t.integer :followed_id
  t.integer :follower_id
end 
```

你已经设置好了：

```
followed = User.find :first
follower = User.find :last

followed.followers << follower

followed.followers.first.messages
followed.followers.first.followers.first.messages # etc... 
```

但是根据我的做法，您想同时显示来自所有关注者的所有消息。

~~这应该可以通过添加来实现~~

```
 has_and_belongs_to_many :followed_messages, :foreign_key => 'follower_id', 
  :class_name => 'Message', :association_foreign_key => 'followed_id' 
```

到*User*类，但我不知道这种方式有多正确。或者可以通过关联扩展来实现，但我真的不能给出任何例子。

**更新：** 通过更改 :class_name，它会将其与 相关联`Message.id`，没有考虑过，因此以这种方式不正确。

因此，唯一的“好”选项是像第一个示例一样通过 User 类。我能看到的唯一其他选项是关联扩展（我不能给你一个例子）或者可能使用 finder 语句。

```
 has_many :followed_messages, :class_name => 'Message',
  :finder_sql => 'select * from messages where user_id in(select followed_id from users_users where follower_id = #{id})' 
```

您可能必须自定义该 sql 语句才能使一切正常工作，但至少您应该得到图片:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T15:48:11.250

Keijro 的安排会更好，但如果您需要 Follow 表，那么您可以执行您指定的 SQL 查询，如下所示：

```
Follow.all(:joins => { :messages, :users }, :conditions => { "follows.follower_id" => current_user.id, "follows.followee_id" => "users.id", "users.id" => "messages.user_id"} ) 
```

# sql - 如何选择列值等于已知行值的行？

> ID：822540
> 
> 赞同：5
> 
> 时间：2009-05-04T23:01:27.410
> 
> 标签：sql

这里有张桌子：

```
 create table table1 (
        id integer primary key,
        user_id varchar(36),
        field1 varchar(100)) 
```

如何选择链接到用户的行，具有特定 id 的行所属的行。我希望能够查看行，按 id 选择消息并选择链接到同一用户的所有行。

```
 select * from table1
        where user_id = -- the same as of the row with id = 3 for example 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-04T23:03:22.367

[使用subqueries](http://dev.mysql.com/doc/refman/5.1/en/subqueries.html)非常容易，尤其是文档中的[使用 Subqueries](http://dev.mysql.com/doc/refman/5.1/en/comparisons-using-subqueries.html)进行比较：

```
SELECT * FROM table1 WHERE user_id = (SELECT user_id FROM table1 WHERE id = 3) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T23:04:50.430

不确定这是什么 sql 但在 SQL Server 中：

```
select * from table1
where user_id = (select user_id from table1 where id = 3) 
```

# javascript - 如何生成 xml 文件并允许用户使用 javascript 将其保存在本地？

> ID：822547
> 
> 赞同：0
> 
> 时间：2009-05-04T23:04:14.567
> 
> 标签：javascript, xml

我正在通过 JavaScript 生成 XML 文档，需要提示用户将其保存到本地计算机。

这是我目前的代码：

```
var xmlWindow = window.open("", "");
xmlWindow.document.write("<node>data</node>"); 
```

这会将 xml 写入一个新窗口，然后用户可以点击 file->save 进行下载。

1.  有没有更优雅的方式来做到这一点？
2.  有什么方法可以设置新窗口的 mimeType 以便 xml 正确显示？
3.  有没有办法指定标题，所以当用户点击保存时，文件名设置正确？

注意：需要与大多数brosers（IE6、IE7、FF、Chrome）兼容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T00:03:24.440

您可以通过 XMLHttpRequest 将 XML 发送到服务器上的脚本以生成 xml 文件，然后将 window.location 设置为新 xml 文件的位置。系统将提示他们保存它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:27:38.487

“在本地保存”：如果您想跨浏览器兼容，这是一个艰难的决定。看到[这个帖子](https://stackoverflow.com/questions/371875/)。

[TiddlyWiki](http://www.tiddlywiki.com/)设法为某些浏览器（不确定它支持哪些浏览器）做到这一点，但只能通过让用户安装某些文件来实现。

# ruby-on-rails - 是否可以在 Rails 中使用“前端控制器”？

> ID：822554
> 
> 赞同：3
> 
> 时间：2009-05-04T23:06:11.753
> 
> 标签：ruby-on-rails, dispatcher, front-controller

在 Spring MVC 中，Dispatcher servlet 用作“前端控制器”来处理所有应用程序请求并适当地路由它们。

是否可以在 Rails 中使用这种方法，或者是否需要为每种类型的操作编写单独的控制器，而无需“交通警察”（前端控制器）指导流程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T23:09:34.757

检查所有路线上的铁轨，我*认为*这就是您所追求的：

[http://railscasts.com/episodes/46-catch-all-route](http://railscasts.com/episodes/46-catch-all-route)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T23:14:27.397

如果您想要对路由进行更细粒度的控制，也许 Merb 更适合您。

# iphone - iPhone 内存管理

> ID：822555
> 
> 赞同：0
> 
> 时间：2009-05-04T23:06:35.853
> 
> 标签：iphone, memory

我正要自欺欺人，但我注意到这里有很多友好和耐心的人，所以我试一试：

我正在开发一个包含汽车评论数据库的 iPhone 应用程序。我希望用户能够通过电子邮件分享评论。因此，当他/她在应用程序中发现一辆有趣的汽车时，他/她会点击一个按钮，应用程序会通过 iPhone 的 Mail.app 撰写一封电子邮件。

现在。我是一个新手，我不得不承认我对 iPhone 上的内存管理不太熟悉。我编写的代码，这个特定的邮件方法，以可怕的“程序接收信号：“EXC_BAD_ACCESS””消息退出应用程序。一些谷歌搜索表明这是内存管理不善的结果。

对这件事了解的不多，我开始显式初始化，然后释放所有临时变量，就像疯了一样。尽管如此，“EXC_BAD_ACCESS”仍然不断出现。

有趣的一点是：一旦我杀死我的应用程序，构造的 URL 仍然会触发 Mail.app，并愉快地为我创建电子邮件。

请考虑以下示例代码，然后向我射击。

```
- (IBAction) sendCartoFriend
{
    CarAppDelegate *appDelegate = (CarAppDelegate *)[[UIApplication sharedApplication] delegate];

    //Read the html template
    NSString *resourcePath = [[NSBundle mainBundle] resourcePath];
    NSString *emailFile = [resourcePath stringByAppendingPathComponent:@"MailDummy.html"];
    NSMutableString *eMailRaw = [[[NSMutableString alloc] initWithContentsOfFile:emailFile]autorelease];

    //set the variables
    NSString *carNamePlaceholder = [[NSString alloc] initWithString:@"CarTitle"];
    NSString *carName = [[NSString alloc] initWithString:car.shortname];
    [eMailRaw replaceOccurrencesOfString:carNamePlaceholder withString:carName options:NSCaseInsensitiveSearch range:NSMakeRange(0, [eMailRaw length])];
    [carNamePlaceholder release];
    [carName release];

    NSString *carReviewPlaceholder = [[NSString alloc] initWithString:@"CarReview"];
    NSString *carReview = [[NSString alloc] initWithString:car.review];
    [eMailRaw replaceOccurrencesOfString:carReviewPlaceholder withString:carReview options:NSCaseInsensitiveSearch range:NSMakeRange(0, [eMailRaw length])];
    [carReviewPlaceholder release];
    [carReview release];

    //there are 5 more of these find/replace actions. the "CarReview" though is the biggest. It might contain several hundred of characters.

    //compose the message
    NSString *eMailSubject = @"Nice little car!";
    NSString *encodedSubject = [[NSString alloc] initWithString:[eMailSubject stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; 
    NSString *eMailBody = eMailRaw;
    NSLog(eMailBody);
    NSString *encodedBody = [[NSString alloc] initWithString:[eMailBody stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];

    NSString *urlString = [[NSString alloc] initWithString:[NSString stringWithFormat:@"mailto:?subject=%@&body=%@", encodedSubject, encodedBody]];
    NSURL *url = [[NSURL alloc] initWithString:urlString];

    [urlString release];
    [encodedBody release];
    [encodedSubject release];
    [eMailRaw release];

    [[UIApplication sharedApplication] openURL:url];

    [url release];
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T23:16:26.517

嗯..乍一看：

您正在发布 eMailRow，即使它设置为自动发布。

这可能是问题吗？

# perl - 如何在 Perl 中同时遍历多个列表？

> ID：822563
> 
> 赞同：9
> 
> 时间：2009-05-04T23:08:37.317
> 
> 标签：perl, arrays, list

我需要创建一个文本文件**（aptest.s）**，我可以用它来读入另一个程序。我正在使用 Perl，因为我有一个很大的列表可供使用。我的代码如下（它没有给出所需的输出 - 显示在代码和实际输出之后）。任何帮助，将不胜感激。

```
#!/usr/bin/perl -w
chdir("D://projects//SW Model ODME");
@link = ("319-116264||319-118664","320-116380||320-116846","321-119118||321-119119","322-115298||322-119087");
@link1 = ("116264-319||118664-319","116380-320||116846-320","119118-321||119119-321","115298-322||119087-322");
open (FSAS, ">>aptest.s");
foreach $link (@link) {
    foreach $link1 (@link1){
    print FSAS "other code \n";
    print FSAS "PATHLOAD SELECTLINK=(Link=".$link."), VOL[2]=MW[1] \n";
    print FSAS "PATHLOAD SELECTLINK=(Link=".$link1."), VOL[3]=MW[2] \n";
    print FSAS "other code \n";
}
} 
```

**实际输出**：

```
other output
PATHLOAD SELECTLINK=(Link=319-116264||319-118664), VOL[2]=MW[1] 
PATHLOAD SELECTLINK=(Link=116264-319||118664-319), VOL[3]=MW[2] 
other output 

other output
PATHLOAD SELECTLINK=(Link=**319-116264||319-118664**), VOL[2]=MW[1] 
PATHLOAD SELECTLINK=(Link=**116380-320||116846-320**),      VOL[3]=MW[2] 
other output 
```

**期望的输出**

```
other output
PATHLOAD SELECTLINK=(Link=319-116264||319-118664), VOL[2]=MW[1] 
PATHLOAD SELECTLINK=(Link=116264-319||118664-319), VOL[3]=MW[2] 
other output

other output
PATHLOAD SELECTLINK=(Link=**320-116380||320-116846**), VOL[2]=MW[1] 
PATHLOAD SELECTLINK=(Link=**116380-320||116846-320**), VOL[3]=MW[2] 
other output 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-04T23:17:36.937

参见[List::](http://search.cpan.org/perldoc?List::MoreUtils)**`each_array`** MoreUtils ：

```
#!/usr/bin/perl

use strict;
use warnings;

use List::MoreUtils qw( each_array );

my @x = qw( A B C D E F );
my @y = (10, 11, 12, 13, 14, 15);

my $it = each_array( @x, @y );
while ( my ($x, $y) = $it->() ) {
    print "$x = $y\n";
}
__END__ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T23:22:51.603

我*认为*您正在尝试创建*四个*单独的块，数组中的每个元素都与`link`数组中的相应元素相关联`link2`？

但是，您实际上输出了*16 个*块，每个和的*组合*一个。`link``link1`

而是尝试：

```
foreach $i (0 .. $#link) {

   $link = $link[$i];
   $link1 = $link1[$i];

   ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T01:17:43.277

阅读您的问题，很难说出您真正想知道的内容。我相信 Sinan Unur 是正确的，并且您希望同时迭代两个数组。正如他所说，List::MoreUtils 提供了非常方便的`each_array()`功能。

通过索引遍历一个或多个数组也很简单。

您可以生成索引列表以用于正常的 for 循环。这用于`$#`获取数组中最后一个值的索引。

```
for ( 0..$#array ) { ... } 
```

或者您可以使用 C 风格的 for 循环来生成索引。这使用了在标量上下文中评估的数组返回元素数的事实。

```
for ( my $i=0; $i<@array; $i++ ) { ... } 
```

也可以使用以下方式编写`$#`：

```
for ( my $i=0; $i<=$#array; $i++ ) { ... } 
```

阅读您的代码后，很明显您并不熟悉[Perl 的引用运算符](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)。有效地使用它们使您的脚本更容易编写和阅读。

本着友好的精神，请允许我整理一下您的脚本：

```
#!/usr/bin/perl

# Always:
use strict;
use warnings;

#my $TARGET_DIR  = 'D://projects//SW Model ODME';
my $TARGET_DIR  = '.';

my $TARGET_FILE = 'aptest.s';

# Using qw() makes long lists of 
# literals easier to type and read.
# Consider finding better names than link and link1.
# Something that describes the relationship between
# the two arrays.
my @link = qw(
    319-116264||319-118664
    320-116380||320-116846
    321-119118||321-119119
    322-115298||322-119087
);

my @link1 = qw(
    116264-319||118664-319
    116380-320||116846-320
    119118-321||119119-321
    115298-322||119087-322
);

# check the results of chdir.  
chdir($TARGET_DIR) 
    or die "Unable to enter $TARGET_DIR - $!\n";

# Use a lexical filehandle.
# Use 3 arg open
# Check the results of open - you need to know if it fails.
open (my $fsas, '>>', $TARGET_FILE)
    or die "Unable to open $TARGET_FILE - $!\n";

# Verify that the link arrays are both sized appropriately.
die "Link arrays are not the same size."
    unless @link == @link1;

# Loop over the indexes of the array.
# For very (very) large arrays it is 
# more efficient to use a C-style for loop:
#   for( my $i = 0; $i < @link; $i++ ) {
foreach my $i (0..$#link) {
    my $link  = $link[$i];
    my $link1 = $link1[$i];

    print $fsas Get_Link_Text($link, $link1);
}

# Broke out your formatting code into a routine for readability.
# Used a heredoc to make the formatting easier to read.
# Also, took advantage of variable interpolation in the heredoc to further
# improve readability.
# I preserved the whitespace at the end of lines, is it really necessary?
sub Get_Link_Text {
    my $link = shift;
    my $link1 = shift;

    return <<"--END_TEXT--"; 
RUN PGM=HWYLOAD 
MATI=daily_trucks.MAT  
NETI=FAF_Network_V11.net  
NETO=MiamiDade.NET 
PARAMETERS MAXITERS=1, GAP=0.001, COMBINE=EQUI  
FUNCTION {   
TC[1] = T0*(1+0.15*(V/100)^(4))}    
FUNCTION V = (VOL[1]) 
PHASE=ILOOP 
PATHLOAD PATH=TIME, MW[1]=MI.1.1, SELECTLINK=(Link=$link), VOL[2]=MW[1] 
PATHLOAD PATH=TIME, MW[2]=MI.1.1, SELECTLINK=(Link=$link1), VOL[3]=MW[2] 
ENDPHASE  
ENDRUN 

--END_TEXT--
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T23:15:38.890

您能否在仍然重现错误的同时减小代码和示例数据的大小？我无法立即看到实际输出和预期输出之间的差异。

有时，找到导致问题的最小代码和数据集将使解决方案显而易见。

仔细看，只有一点输出代码是可变的：

```
print FSAS "PATHLOAD PATH=TIME, MW[1]=MI.1.1, SELECTLINK=(Link=".$link."), VOL[2]=MW[1] \n";
print FSAS "PATHLOAD PATH=TIME, MW[2]=MI.1.1, SELECTLINK=(Link=".$link1."), VOL[3]=MW[2] \n"; 
```

您的错误可能存在。

# python - 如何遍历 Beautiful Soup 元素的 HTML 属性？

> ID：822571
> 
> 赞同：19
> 
> 时间：2009-05-04T23:14:02.093
> 
> 标签：python, beautifulsoup

如何遍历 Beautiful Soup 元素的 HTML 属性？

就像，给定：

```
<foo bar="asdf" blah="123">xyz</foo> 
```

我想要“bar”和“blah”。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-04T23:24:13.970

```
from BeautifulSoup import BeautifulSoup
page = BeautifulSoup('<foo bar="asdf" blah="123">xyz</foo>')
for attr, value in page.find('foo').attrs:
    print attr, "=", value

# Prints:
# bar = asdf
# blah = 123 
```

# c++ - 我应该使用什么 C++ 库来实现 HTTP 客户端？

> ID：822581
> 
> 赞同：44
> 
> 时间：2009-05-04T23:17:59.773
> 
> 标签：c++, http, client

我正在寻找一个实现或启用 HTTP 客户端实现的 C++ 库。它也应该处理 cookie。

你会提出什么建议？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-04T23:21:09.300

[Curl++](http://www.curlpp.org/) : 是一个选项，特别是如果你想要更多 C++ 风格的东西。

[cpp-netlib](http://cpp-netlib.org/#)：非常好用且简单易用，可在 ubuntu 上使用

```
sudo apt-get install libcppnetlib-dev 
```

例子：

```
using namespace boost::network;
using namespace boost::network::http;

client::request request_("http://127.0.0.1:8000/");
request_ << header("Connection", "close");
client client_;
client::response response_ = client_.get(request_);
std::string body_ = body(response_); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-07-31T12:13:25.763

看看[Poco 图书馆](http://pocoproject.org/)。

我开始使用它们是因为它们是便携的，而且使用起来很愉快。简单而干净——虽然我暂时还没有深入研究任何花哨的东西。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-05-04T23:21:02.373

*   [卷曲](http://curl.haxx.se/)
*   [库www](http://www.w3.org/Library/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-04T23:21:45.943

默认情况下，C++ (STL) 没有 HTTP 或网络库，您将不得不处理其他事情。

[libcurl](http://curl.haxx.se/)应该做你想做的事。[cURL++](http://curl.haxx.se/libcurl/cplusplus/)是包装在闪亮的 C++ 包装器中的同一个 libcurl。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T05:44:38.720

你可以试试WinInet

[http://msdn.microsoft.com/en-us/library/aa385331(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa385331(VS.85).aspx)

与 WinHTTP 相比，它更面向客户端。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T02:05:28.390

如果是用于 Windows，请查看 Windows HTTP 服务 (WinHTTP)

[http://msdn.microsoft.com/en-us/library/aa384273(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa384273(VS.85).aspx)

> Microsoft Windows HTTP 服务 (WinHTTP) 为开发人员提供了一个 HTTP 客户端应用程序编程接口 (API)，以通过 HTTP 协议将请求发送到其他 HTTP 服务器。
> 
> WinHTTP 提供适用于基于 Active Server Pages (ASP) 的应用程序的 C/C++ 应用程序编程接口 (API) 和组件对象模型 (COM) 自动化组件。

对于 Cookie [http://msdn.microsoft.com/en-us/library/aa383261(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa383261(VS.85).aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-27T09:53:30.033

所有替代库都在这里可用，如果您需要复杂的 http API，请尝试 curl，如果只想获取文件，请尝试 http-tiny

[http://curl.haxx.se/libcurl/competitors.html](http://curl.haxx.se/libcurl/competitors.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-04T23:33:46.193

[`IWebBrowser2`](http://msdn.microsoft.com/en-us/library/aa752127.aspx)在 Windows 上，您可以使用界面驱动 IE 。

# .net - C3374：除非创建委托实例，否则无法获取“函数”的地址

> ID：822582
> 
> 赞同：4
> 
> 时间：2009-05-04T23:18:20.007
> 
> 标签：.net, c++-cli, clr

我在使用第三方库注册函数注册回调时遇到了困难。我正在用 C++ CLI 编写，并访问用 C 或 C++ 编写的库。

上面的编译器错误是什么意思？

这是供应商定义的注册功能：

```
MYCO int WINAPI MyCo_Device_Register_CallbackFunc(LPVOID func, LPVOID lpParam, DWORD mask); 
```

这是供应商定义的回调：

```
typedef void (CALLBACK* MyCo_Device_CallbackProc)(DWORD ddStatus, LPVOID lpParam); 
```

我的回调函数：

```
public ref class Device 
{
    void CallBackFunc(DWORD ddStatus, LPVOID lpParam) {};
} 
```

我的电话（失败）：

```
MyCo_Device_Register_CallbackFunc((LPVOID) Device::CallBackFunc, nullptr, 0xFFFF); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T23:27:41.170

如果我不得不猜测一下，您正在尝试获取 MANAGED 函数的地址并将其作为 NATIVE 函数指针传递。那根本行不通。要么写一个本地桥（更难而且可能没有优势），或者（这是更简单的方法），创建一个委托并使用[Marshal.GetFunctionPointerForDelegate](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getfunctionpointerfordelegate.aspx)。不要忘记委托必须在本机代码期望回调的时间内保持活动状态，因此您很可能需要将其存储在某个地方。

哦，如果不清楚，则 ref 类或值类中的所有函数都是托管函数。

[编辑] 扩展答案以涵盖评论中的问题。第一步是创建一个匹配的委托。对于您提供的功能，它将如下所示：

```
public delegate void CallbackFuncDelegate(DWORD ddStatus, LPVOID lpParam); 
```

然后，您需要创建一个：

```
CallbackFuncDelegate del = gcnew CallbackFuncDelegate(CallbackFunc); 
```

如前所述，您应该将该类存储为成员，以确保它不会消失。最后，您需要获取函数指针并将其传递：

```
MyCo_Device_Register_CallbackFunc((MyCo_Device_CallbackProc) Marshal::GetFunctionPointerForDelegate(del).ToPointer(), 0, 0); 
```

我认为这涵盖了一切。您只需要使用命名空间系统；你应该没事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:49:21.197

你的回调函数是一个成员——指向成员的指针和指向函数的指针是不同的东西。

即使在 Promit 的解决方案中：

```
CallbackFuncDelegate(CallbackFunc) 
```

CallbackFunc 不应该是类成员

你可以简单地写

```
public ref class Device 
{
    static void CallBackFunc(DWORD ddStatus, LPVOID lpParam) {};
} 
```

然后使用

```
Device::CallBackFunc 
```

# c# - 不变性和静态变量

> ID：822597
> 
> 赞同：1
> 
> 时间：2009-05-04T23:23:03.007
> 
> 标签：c#, .net, parallel-processing

我正在设计一些不可变的类，但我必须有一些变量，比如说`.Count`有实例的总数。但是有一个静态变量会影响多线程吗？

因为像 Add、Remove 等方法必须更新`.Count`值。也许我应该让它成为惰性属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T23:30:19.230

您可能需要考虑使用 Interlocked 类中的函数，至少在您给出的示例中是这样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T23:30:33.630

如果您只是在做一个计数器，则联锁操作也可能是一种选择，而不是锁定。MSDN在引用计数的上下文中有一个[很好的例子。](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T23:37:49.943

> 但是有一个静态变量会影响多线程吗？

当然！共享状态受定义和多线程的影响。

> 因为像 Add、Remove 等方法必须更新 .Count 值。也许我应该让它成为惰性属性？

最好使用一个[执行原子添加](http://www.albahari.com/threading/part4.aspx)的类（如java中的[AtomicInteger](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/atomic/AtomicInteger.html)）以避免锁定：[看看这里](http://en.wikipedia.org/wiki/Lock-free_and_wait-free_algorithms)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T23:28:07.923

是的，每当您在多线程环境中更新共享变量时，您只需将这些更新包装在锁中即可。

# ios - 如何从 iPhone 应用程序启动 Safari？

> ID：822599
> 
> 赞同：128
> 
> 时间：2009-05-04T23:23:51.490
> 
> 标签：ios, safari, launch

这可能是一个相当明显的问题，但是您可以从 iPhone 应用程序启动 Safari 浏览器吗？

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2009-08-27T19:40:49.557

应该如下：

```
NSURL *url = [NSURL URLWithString:@"http://www.stackoverflow.com"];

if (![[UIApplication sharedApplication] openURL:url]) {
    NSLog(@"%@%@",@"Failed to open url:",[url description]);
} 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-05-05T00:25:35.743

UIApplication 有一个名为 openURL 的方法：

例子：

```
NSURL *url = [NSURL URLWithString:@"http://www.stackoverflow.com"];

if (![[UIApplication sharedApplication] openURL:url]) {
  NSLog(@"%@%@",@"Failed to open url:",[url description]);
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-03-14T14:16:37.830

您可以使用以下方法在 safari 中打开网址：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"https://www.google.com"]]; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-09-21T20:35:11.093

在 iOS 10 中，我们有一种不同的**完成处理程序**方法：

目标C：

```
NSDictionary *options = [NSDictionary new];
//options can be empty
NSURL *url = [NSURL URLWithString:@"http://www.stackoverflow.com"];
[[UIApplication sharedApplication] openURL:url options:options completionHandler:^(BOOL success){
}]; 
```

迅速：

```
let url = URL(string: "http://www.stackoverflow.com")
UIApplication.shared.open(url, options: [:]) { (success) in
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-04-13T15:10:41.297

在 swift 4 和 5 中，随着 OpenURL 的贬值，一个简单的方法就是

```
if let url = URL(string: "https://stackoverflow.com") {
    UIApplication.shared.open(url, options: [:]) 
} 
```

您也可以使用`SafariServices`. 类似于应用程序中的 Safari 窗口。

```
import SafariServices

...

if let url = URL(string: "https://stackoverflow.com") {
    let safariViewController = SFSafariViewController(url: url)        
    self.present(safariViewController, animated: true)
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-06-28T17:59:33.833

也许有人可以使用 Swift 版本：

在 Swift 2.2 中：

```
UIApplication.sharedApplication().openURL(NSURL(string: "https://www.google.com")!) 
```

和 3.0：

```
UIApplication.shared().openURL(URL(string: "https://www.google.com")!) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-28T00:46:50.850

在 Swift 3.0 中，你可以使用这个类来帮助你进行交流。框架维护者已弃用或删除了以前的答案。

```
导入 UIKit

类 InterAppCommunication {
    静态函数 openURI(_ URI: String) {
        UIApplication.shared.open(URL(string: URI)!, options: [:], completionHandler: { (succ: Bool) in print("Complete! Success? \(succ)") })
    }
}
```

# sql - 将查询排除在 JSP 之外 - 如何？

> ID：822600
> 
> 赞同：0
> 
> 时间：2009-05-04T23:24:02.287
> 
> 标签：sql, jsp, jstl

我非常喜欢将应用程序逻辑保留在 servlet 中，并使 JSP 尽可能简单。原因之一是任何优秀的网页设计师都应该能够扩展他的 HTML 知识以构建一些 JSTL 标记来进行简单的迭代、访问 bean 等。我们还保留了更复杂的/ajax/js 组件一个标签库（类似于 displayTag 但用于我们自己的组件）。

大多数时候一切正常 - servlet 执行它需要的任何 SQL，并将结果存储在 bean 中以供 JSP 访问。我们遇到的问题是我们希望访问的记录是由设计指定的。

最明显的例子是主页——它需要引人注目且有效。它不需要像网站的其他部分一样统一。这里有很多一次性或“特殊情况”，我们想要查询特定的产品记录，或者其他什么。

设计师真正想要的是一种通过产品 id 获取产品 bean 的方法，以便他可以正常访问属性。我们显然不想查询所有产品，我也不想在演示文稿中查询。

我很确定我在这里问的是不可能的事情，我必须放弃一些东西。我的问题是什么？

**编辑**

我认为在调用 JSP*之前应该完成所有应用程序逻辑是错误的吗？*我的印象是最好的做法是在 servlet 中进行所有查询/计算/处理，然后将（相当）愚蠢的 bean 传递给（非常）愚蠢的 JSP。

有几种方法可以将查询的实际复杂性封装在另一个类（自定义标记或 bean）中，并且 JSP 可以调用它。这使 JSP 保持简单（目标 1），但 JSP 仍在“触发”查询 - 在此过程中相当晚。

*   我是否完全错了，这样做很好。
*   这是一般规则吗，但在这种情况下这样做是完全可以的。
*   我会遇到问题吗？

**编辑 - 示例**

我希望这个例子会有所帮助：

主页不像类别/搜索页面那样是“模板” - 它是定制设计的，可以很好地与营销图像和几个特定的​​产品图像配合使用。然而，它确实有关于应该动态获取的这两种产品的信息（所以名称，重要的是价格）与数据库保持同步。

servlet 无法知道这些产品将是哪些产品，因为如果设计人员想要更改/删除它们/添加更多产品，他应该只需要编辑 JSP（可能还有 XML 作为建议的答案）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T23:32:25.590

听起来您需要更好地分离显示代码和数据库代码。您应该有单独的类来处理与数据库的交互，而对显示一无所知。

然后，您只需创建一个方法，该方法将通过 id 查找产品并返回该 bean，以便显示可以提取它想要的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T00:06:19.033

您需要创建一个自定义 bean，它将为前端执行查询。实际上，根据您这里所说的，它可能更像是为您获取数据的几个bean。

从设计的角度来看，这样做没有问题；只是主页的特定设计比您网站的其他部分具有更多的异构要求。确保您的设计师知道他需要将他的需求很好地传达给开发团队，以便为您的主页（或其他任何内容）创建 BO，并且一切都会顺利进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T00:25:26.930

如果我理解正确，您在 JSP 中有需要特定产品的逻辑，但此时您不想从数据库中查询，而 servlet 意识到它为时已晚。

（附带说明，虽然我尊重您保持关注点分离的意愿，但这是一个问题这一事实清楚地表明您的框架在表示层中有太多逻辑......但是因为我们可能无法解决这个问题...... 。继续）。

我的建议是您的设计人员创建一个配置 XML 文件，其中包含前端所需的任何特殊情况，您的 servlet 可以读取该文件，然后将哑 bean 传递回 JSP。

或者...您使用 XMLHTTPRequest 将事情分解为多个请求，并为每个单独的查询回调 servlet，然后在客户端上组装页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T00:27:27.783

您认为在呈现 JSP 之前应该完成所有应用程序逻辑并没有错。

如果需要获取更多内容以在 JSP 中显示，这将是对服务器的另一个请求和另一个页面循环。如果您正在寻找“交互式”加载体验，您可以使用 AJAX。

在单页生命周期中，我很难理解为什么必须从 JSP 调用数据库调用。该页面之前不是已经发布了所有必需的表单变量来帮助您在 Servlet/Helper 类中查找数据吗？

如果你能举一个案例的例子，那会很有帮助。

**[编辑]**看看你的例子，是的，你的设计师（或网站管理员）应该将该信息设置为配置，而不是 JSP 的一部分。或者，您可以有一个小的应用程序/管理页面来维护数据库中的信息，以便可以随时更改它。当您显示主页时，请阅读配置并加载适当的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T23:30:19.743

我不确定问题是什么。如果您想从 jsp 页面中获取 sql 语句，那么您可以将它们放在属性文件中，然后从 jsp 页面中读取属性文件。

# sql - 将 SELECT 的行折叠成字符串的最佳方法是什么？

> ID：822615
> 
> 赞同：6
> 
> 时间：2009-05-04T23:29:29.137
> 
> 标签：sql, sql-server

在 SQL 语句（或过程）中，我想将此表的行折叠成一个逗号分隔的字符串。

```
simpleTable

id  value
--  ----- 
1    "a"
2    "b"
3    "c" 
```

折叠到：

```
"a, b, c" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T23:36:56.670

您可以在查询中使用嵌入的“set”语句进行连接：

```
声明@combined varchar(2000)
选择@combined = isnull(@combined + ', ','') + isnull(value,'')
从简单表

打印@combined
```

（请注意，第一个 isnull() 初始化字符串，第二个 isnull() 如果 'value' 列中可能存在空值，则尤其重要，因为否则单个空值可能会消除整个串联）

（注释后编辑代码和解释）

**编辑（十年后）：**

SQL Server 2017 引入了[STRING_AGG()](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-agg-transact-sql?view=sql-server-2017)函数，它提供了一种连接来自不同行的字符串的官方方法。与其他聚合函数如 COUNT() 一样，它可以与 GROUP BY 一起使用。

所以对于上面的例子，你可以这样做：

```
select string_agg(value, ', ')
from simpleTable 
```

如果您有其他列并且您想连接该列的值，您将添加一个“分组依据”子句，例如：

```
select someCategory, string_agg(value, ', ') as concatValues
from simpleTable
group by someCategory 
```

注意 string_agg 仅适用于 SQL 2017 及更高版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T23:41:46.143

这仅适用于 MSSQL 2005+

```
select value + ',' from simpletable for xml path ('') 
```

..一种防止多余逗号的方法：

```
select case(row_number() over (order by id))
when 1 then value else ',' + value end
from simpletable
for xml path ('') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T23:37:27.403

```
DECLARE @EmployeeList varchar(100)

SELECT @EmployeeList = COALESCE(@EmployeeList + ', ', '') + 
   CAST(Emp_UniqueID AS varchar(5))
FROM SalesCallsEmployees
WHERE SalCal_UniqueID = 1

SELECT @EmployeeList 
```

结果：

```
1, 2, 4 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:44:20.540

这是基于@codeulike 的答案，但会防止丢失在连接空“值”之前连接的字符串部分。

```
declare @combined varchar(2000)
select @combined = isnull(@combined + ', ','') + ISNULL(value,'')
from simpleTable

print @combined 
```

# iphone - 有谁知道标签栏的好教程？

> ID：822622
> 
> 赞同：1
> 
> 时间：2009-05-04T23:31:13.953
> 
> 标签：iphone, cocoa-touch, uiviewcontroller, xib, tabbar

有谁知道标签栏的好教程？

我的应用程序目前是一个“基于视图”的应用程序。我需要一个关于如何制作它的教程，以便我的主笔尖从其他笔尖加载视图，当我单击不同的选项卡时，它会加载其他笔尖。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T03:35:48.360

Erica Sadun 的 iPhone Developers' Cookbook 在第 126 页上有一个很好的标签栏配方，包括从控制器列表中自定义栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T00:02:56.267

你看过这个网站吗？

[http://www.cocoadevcentral.com/](http://www.cocoadevcentral.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T01:48:11.363

Apple SDK 中的 TheElements 示例代码——StackOverflow 和其他地方的许多链接用于与导航控制器结合（总是将导航控制器添加到选项卡栏，反之亦然！）

# mercurial - 如何快速判断哪些文件在 mercurial 修订中有所不同

> ID：822628
> 
> 赞同：7
> 
> 时间：2009-05-04T23:32:41.407
> 
> 标签：mercurial

这似乎应该很明显，但我无法弄清楚。

假设我有 mercurial 修订版 4 和 7，并且我想查看在这些修订版之间更改了哪些文件。我可以`hg diff -r 4 -r 7`列出整个差异集...有没有办法只列出已更改的文件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-04T23:42:25.487

```
hg status --rev 4:7 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-06T05:11:27.793

您可以为此使用“hg log”。

```
hg log --verbose --rev=4:7 --style=changelog 
```

例子：

```
$ hg log -v -r4:7 --style=changelog
2008-08-03 21:40 +0200  XXXXX  <XXXXXX.YYYY@xxxxxxxx.com>  (475752c35880)

        * osinfo.py: new file.
        * os-info.py: deleted file.
        * os-info.py, osinfo.py:
        Rename os-info.py -> osinfo.py.

2008-08-03 21:52 +0200  XXXXXX  <XXXXXX.YYYY@xxxxxxxx.com>  (babf6df75ff4)

        * iterate_file_lines.py, osinfo.py:
        Add keyword substitution strings.

2008-08-03 21:53 +0200  XXXXXX  <XXXXXX.YYYY@xxxxxxxx.com>  (bc6fc22adb8e)

        * iterate_file_lines.py:
        Remove comment about coding conventions.

2008-08-08 19:43 +0200  XXXXXX  <XXXXXX.YYYY@xxxxxxxx.com>  (dbea6914b20f)

        * .hgignore: new file.
        * .hgignore:
        Add .hgignore. 
```

# hash - 是否有任何已发表的研究表明对 MD5 的原像攻击迫在眉睫？

> ID：822638
> 
> 赞同：19
> 
> 时间：2009-05-04T23:38:38.727
> 
> 标签：hash, cryptography, md5, cryptographic-hash-function

我继续阅读关于 MD5 已损坏、破产、过时且永远不会使用的信息。这让我很生气。

事实上，对 MD5 的[碰撞攻击](http://en.wikipedia.org/wiki/Birthday_attack)现在相当容易。有些人将碰撞攻击归结为一门艺术，甚至我们可以用它们来[预测选举](http://www.win.tue.nl/hashclash/Nostradamus/)。

我发现大多数MD5“破碎”的例子都不那么有趣。即使是[著名的 CA 证书黑客攻击](http://www.crunchgear.com/2008/12/30/md5-collision-creates-rogue-certificate-authority/)也是一种碰撞攻击，这意味着可以证明该方同时生成了 GOOD 和 EVIL 证书。这意味着，如果 EVIL CA 进入野外，则可以证明它是从拥有良好 CA 的人那里泄露出来的，因此无论如何都是值得信任的。

更令人担忧的是原[像](http://en.wikipedia.org/wiki/Preimage_attack)或第二原像攻击。

对 MD5 进行原像攻击的可能性有多大？目前是否有任何研究表明它迫在眉睫？MD5 易受碰撞攻击这一事实是否使其更容易遭受原像攻击？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-08T06:01:03.337

在密码学中，建议通常不是通过预测未来来做出的，因为这是不可能的。相反，密码学家试图评估已知和已发布的内容。为了适应潜在的未来攻击，密码系统通常被设计成有一定的安全余量。例如，通常选择的加密密钥比绝对必要的要长一点。出于同样的原因，一旦发现弱点，就会避免使用算法，即使这些弱点只是证明性的。

In particular, the RSA Labs recommended to abandon MD5 for signatures already in 1996 after Dobbertin found collisions in the compression function. Collisions in the compression function do not imply that collisions in the hash function exist, but we can't find collisions for MD5 unless we can find collisions for its compression function. Thus the RSA Labs decided that they no longer have confidence in MD5s collision resistance.

Today, we are in a similar situation. If we are confident that a hash function is collision resistant then we can also be confident that the hash function is preimage resistant. But MD5 has significant weaknesses. Hence many cryptographers (including people like Arjen Lenstra) think that MD5 no longer has the necessary safety margin to be used even in applications that only rely on preimage resistance and hence recommend to no longer use it. Cryptographers can't predict the future (so don't look for papers doing just that), but they can recommend reasonable precautions against potential attacks. Recommending not to use MD5 anymore is one such reasonable precaution.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T00:01:14.413

我们不知道。

这种进步往往是“突然”到来的——有人在理论上取得了突破，并找到了一种比以前最好的方法好 2^10（或其他）的方法。

看起来原像攻击可能还有些遥远。[最近的一篇论文](http://portal.acm.org/citation.cfm?id=1427259)声称，在 MD5 的 44 轮缩减版本上，原像的复杂度为 2^96。然而，这不是一个可能性的问题，而是一个人是否足够聪明，能够走到最后一步，并将真正交易的复杂性带入现实的边缘。

也就是说，由于碰撞攻击已经非常真实（[典型笔记本电脑上的一分钟](http://eprint.iacr.org/2006/105)），并且原像攻击可能（或可能不会）指日可待，因此通常认为现在切换到更强大的攻击是谨慎的做法，以免为时已晚。

如果碰撞对您来说不是问题，您可能有时间等待[NIST SHA-3 竞赛](http://csrc.nist.gov/groups/ST/hash/sha-3/index.html)提出新的东西。但是，如果您有足够的处理能力和比特，使用 SHA-256 或类似的可能是一种谨慎的预防措施。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-13T20:33:36.250

Cryptographically speaking MD5's pre-image resistance is *already* broken, see [this paper from Eurocrypt 2009](http://link.springer.com/chapter/10.1007/978-3-642-01001-9_8). In this formal context "broken" means faster than brute force attacks, i.e. attacks having a complexity of less than (2^128)/2 on average. Sasaki and Aoki presented an attack with a complexity of 2^123.4 which is by far only theoretical, but every practical attack is build on less potent theoretical attack, so even a theoretical break casts *serious* doubts on its medium-term security. What is also interesting is that they reuse a lot of research that has gone into collision attacks on MD5\. That nicely illustrates Accipitridae's point that MD5's safety margin on pre-image resistance is gone with the collision attacks.

Another reason why the use of MD5 in 2009 has been and now the use of SHA1 is strongly discouraged for *any application* is that most people do not understand which exact property the security of their use case relies on. You unfortunately proved my point in your question stating that the 2008 CA attack did not rely on a failure of collision resistance, as caf has pointed out.

To elaborate a bit, every time a (trusted) CA signs a certificate it also signs possibly malicious data that is coming from a customer in form of a certificate signing request (CSR). Now in most cases all the data that is going to be signed can be pre-calculated out of the CSR and some external conditions. This has the fatal side effect that the state the hash function will be in, when it is going to hash the untrusted data coming out of the CSR is completely known to the attacker, which facilitates a collision attack. Thus an attacker can precompute a CSR that will force the CA to hash and sign data that has a collision with a shadow certificate only known to the attacker. The CA cannot check the preconditions of the shadow certificate that it would usually check before signing it (for example that the new certificate does not claim to be a root certificate), as it only has access to legitimate CSR the attackers provided. Generally speaking, once you have collision attacks and part of your data is controlled by an attacker then you no longer know what else you might be signing beside the data you see.

# java - java分类广告应用

> ID：822639
> 
> 赞同：-3
> 
> 时间：2009-05-04T23:38:49.130
> 
> 标签：java

有人知道用 Java 编写的好的分类广告应用程序吗？

**更新** ...“分类应用程序”是指处理买卖、广告等的应用程序，类似于“ [http://www.ikiclassifieds.com/](http://www.ikiclassifieds.com/) ”，但仅用 Java 编写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T00:27:03.120

在这种情况下，谷歌一如既往地似乎是你的朋友；“[分类广告 java](http://www.google.co.uk/search?q=classified+ads+java) ” 产生了各种目录，这些目录似乎链接到此类产品，尽管我不能说我已经详细检查了结果。

这是一个相当广泛的问题，征求一般意见，而不提供与您正在寻找的内容相关的任何真实细节。您可能会说，“推荐一个用 Java 编写的博客引擎”，您可以轻松地为此进行研究并找到满足您需求的解决方案。

更有趣的问题可能包括，“我正在用 Java 开发分类广告解决方案，但我被这个特定方面所困扰”，或者甚至，“有没有人对基于 Java 的分类广告系统 XYZ 有任何具体经验？ '正在尝试评估它”。

# c# - .NET 的 MappedBytesBuffer 等价物？

> ID：822642
> 
> 赞同：1
> 
> 时间：2009-05-04T23:39:47.570
> 
> 标签：c#, java

我正在考虑将应用程序从 Java 移植到 .NET。该应用程序大量使用了 .NET 中完全不存在的 NIO 包。

MappedBytesBuffer 是难以在 .NET 上复制的关键区别之一，因为它用于访问文件的隔离部分。

谁能帮我找到一种替代方法来复制这些功能？十分感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T12:11:09.323

如果您可以等到 .net 4.0，这可能会有用： [What's New in the BCL in .net 4.0](http://blogs.msdn.com/bclteam/archive/2008/11/04/what-s-new-in-the-bcl-in-net-4-0-justin-van-patten.aspx)

或者，您可以为 Win32 apis CreateFileMapping 和 MapViewOfFile 滚动您自己的包装器

# interface - FxCop + MVP：“属性不应该是只写的”

> ID：822644
> 
> 赞同：2
> 
> 时间：2009-05-04T23:39:53.997
> 
> 标签：interface, mvp, fxcop

假设我正在实现一个 MVP 模式，并且我有一个这样的视图界面：

```
interface IView {

    string SuperRadString { set; }
} 
```

演示者没有理由需要从视图中检索此字符串，所以我可以安全地忽略此错误吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T23:51:12.160

嗯，是...

但是，从语义上讲，拥有一种设置值的方法比“黑洞属性”更有意义。

# java - 从子类访问父类的私有实例变量？

> ID：822648
> 
> 赞同：30
> 
> 时间：2009-05-04T23:40:58.703
> 
> 标签：java, oop, class, inheritance, polymorphism

假设我们有一个`foo`具有私有实例变量的类`bar`。

现在让我们有另一个类，`baz`，其中`extends foo`。如果没有定义访问器方法，`baz`可以访问`foo`变量中的非静态方法吗？`bar``foo`

顺便说一句，我正在使用 Java。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-04T23:52:32.780

不，不是根据[Java 语言规范，第 3 版](http://java.sun.com/docs/books/jls/third_edition/html/names.html#6.6.8)：

> **6.6.8 示例：私有字段、方法和构造函数**
> 
> 私有类成员或构造函数只能在包含成员或构造函数声明的顶级类（第 7.6 节）的主体内访问。它不被子类继承。

但不管这种语言限制如何，您*都可以* [通过反射访问私有字段](http://tutorials.jenkov.com/java-reflection/private-fields-and-methods.html)：

```
Field privateStringField = 
   MyClass.class.getDeclaredField("privateString");
privateStringField.setAccessible(true);

String fieldValue = (String) privateStringField.get(privateObject);
System.out.println("fieldValue = " + fieldValue); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-04T23:42:56.390

不，你应该使用`protected.`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-04T23:48:36.707

对于这样的问题，这里的网站上的表格在哪里：http: [//java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html)

基本上，您希望在 foo 中声明 public 或 protected 变量，因为这些是子类从其父类继承的变量，因此可以在 baz 中看到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-28T20:37:16.440

要在子类中使用超类的私有变量，需要访问器方法。否则使用受保护的修饰符而不是私有的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T23:43:05.703

子类不能访问私有成员（这是私有访问控制的重点）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T23:49:20.260

*...如果 foo 中没有定义访问器方法？*

你需要访问器。此外，请注意继承，该 var 真的应该在父级中吗？记住 IS-A 检查..

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T00:05:35.010

您不能访问后代类中的私有变量。通常，您需要为此使用“受保护”或“包”（默认）级别的访问权限。但是，如果您想变得非常棘手，则可以使用反射和[AccessibleObject](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/reflect/AccessibleObject.html)来解决它。除非您确实处于绑定状态，否则我不建议对生产代码这样做；用于测试等，没关系。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-09T19:22:08.880

一个类的私有变量总是在该类内部有一个作用域。如果必须在子类之间共享，则应将其声明为“受保护”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-06T19:05:33.323

子类的实例中存在（继承）私有成员。由于子类的对象也是超类的对象，但对子类不可见

它们可以通过 Super 类的非私有方法间接访问。这些方法可以访问和操作私有成员

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-15T05:47:18.360

不，baz 将无法访问 bar 变量。bar 变量应该是 protected 或 public 。

# javascript - 问题等待直到函数在尝试再次执行之前完成执行

> ID：822653
> 
> 赞同：1
> 
> 时间：2009-05-04T23:42:44.427
> 
> 标签：javascript, jquery, ajax, scroll

我正在使用 $(window).scroll(); 指定当用户滚动得太靠近顶部或底部时要调用的函数。

该函数需要一秒钟才能执行，如果它们继续滚动，它会在第一个完成之前执行多次。

有什么方法可以让函数开始执行，然后告诉 $(window).scroll() 函数它需要等待才能再次执行该函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T23:47:04.837

您可以设置一个您已经在检查滚动位置的布尔值：

```
checkingPosition = false;
$window.scroll(function() {
   if(checkingPosition) return;
   checkingPosition = true;
   //do stuff
   checkingPosition = false;
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T00:21:52.087

我会做这样的事情，通过将数据封装到一个对象中来避免范围问题/混淆......在这种情况下，jQuery对象（在窗口元素上）：

```
$(function() {
    $(window).data('checking_scroll',false);
    $(window).scroll(function() {
        if($(this).scrollTop() >= 200 /* or whatever... */) {
            if($(this).data('checking_scroll') === true) {
                return false;
            } else {
                whatever_function();                   
            }     
        }
    });
});

function whatever_function() {
    $(window).data('checking_scroll',true);
    // do all your stuff...
    $(window).data('checking_scroll',false);
} 
```

……但那只是我。

# c# - 使用 WebClient 类模拟来自 IE 客户端的请求？

> ID：822660
> 
> 赞同：0
> 
> 时间：2009-05-04T23:45:30.863
> 
> 标签：c#, .net, webclient

我正在使用 .NET 3.5 中的 WebClient 类下载文件。我想确保在服务器端，请求的文件似乎是通过 IE 客户端下载的。我到底要改变什么？

我是否只需将 IE 生成的标头信息复制到 WebClient 对象的 Header 属性中？还有什么我需要做的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T23:49:32.240

根据您的需要，只需设置用户代理标头就足够了。[http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)有一个例子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T23:52:11.907

简短的回答是肯定的。

以下代码提供了完整的标头信息，只需在您想要的浏览器中运行它即可完成您应该完成的设置。

```
<html>
<body>

<script type="text/javascript">
var x = navigator;
document.write("CodeName=" + x.appCodeName);
document.write("<br />");
document.write("MinorVersion=" + x.appMinorVersion);
document.write("<br />");
document.write("Name=" + x.appName);
document.write("<br />");
document.write("Version=" + x.appVersion);
document.write("<br />");
document.write("CookieEnabled=" + x.cookieEnabled);
document.write("<br />");
document.write("CPUClass=" + x.cpuClass);
document.write("<br />");
document.write("OnLine=" + x.onLine);
document.write("<br />");
document.write("Platform=" + x.platform);
document.write("<br />");
document.write("UA=" + x.userAgent);
document.write("<br />");
document.write("BrowserLanguage=" + x.browserLanguage);
document.write("<br />");
document.write("SystemLanguage=" + x.systemLanguage);
document.write("<br />");
document.write("UserLanguage=" + x.userLanguage);
</script>

</body>
</html> 
```

# vb.net - 更改面板中的图像时减少闪烁

> ID：822662
> 
> 赞同：1
> 
> 时间：2009-05-04T23:46:50.627
> 
> 标签：vb.net, panel, flicker

如何减少 vb2005 面板中的闪烁？在父面板中，我正在使用另外 2 个面板。

最外面的面板包含一个背景精灵，两个最里面的面板是叠加层，它们会改变以适应背景精灵中的位置。

当我更改覆盖精灵时，我想减少闪烁并使其从一个精灵平滑过渡到下一个精灵。

这是更改覆盖面板中图像的代码，如果新值与旧值相同，则覆盖面板不会更改

```
 Private Sub TrackBar2_Scroll(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TrackBar2.Scroll, TrackBar1.Scroll
    If (Panel2.Tag <> TrackBar1.Value) Then
        Panel2.Tag = TrackBar1.Value
        Panel2.BackgroundImage = tops(TrackBar1.Value) //img array for the top panel
        Panel2.Update()
    End If
    If (Panel3.Tag <> TrackBar2.Value) Then
        Panel3.Tag = TrackBar2.Value
        If (TrackBar2.Value > 0) Then
            Panel3.Location = New Point(182, 210)
        Else
            Panel3.Location = New Point(182, 209)
        End If
        Panel3.BackgroundImage = bottoms(TrackBar2.Value)//img array for the bottom panel
        Panel3.Update()
    End If 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T23:57:43.640

你不会喜欢这个答案的。闪烁是由于默认的 .NET 面板没有双缓冲这一事实引起的 - 所以它直接在可见内存中进行所有绘图，而不是后台缓冲区。

您需要继承 Panel 类并在新类上启用双缓冲。这可以通过执行

```
SetStyle 
```

在启用了标志 OptimisedDoubleBuffering 和 DoubleBuffering 的情况下调用构造函数。

一旦有了双缓冲的新面板类，就可以在应用程序中使用它们而不是标准面板。

我告诉过你你不会喜欢这个答案；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T00:03:31.943

Rein 是对的，子类化是最好的方法。但与此同时，将该调用从 Update 更改为 Invalidate；这可能会有所帮助。

# xml - 使用 AS3 解析 XML

> ID：822663
> 
> 赞同：0
> 
> 时间：2009-05-04T23:47:01.873
> 
> 标签：xml, flash, actionscript-3, parsing, e4x

这是我的整个脚本，因为我似乎无法弄清楚问题出在哪里。

症状是我 addChild(book) 的地方，不适合用拇指正确和按顺序添加它。结果，令我惊讶的是，到目前为止，我能让这些出现的唯一方法是编写一个错误的跟踪语句，它以某种方式将它们弹出在左上角。任何建议将不胜感激！谢谢！！

```
var rowsW:Number;
var my_xW:Number;
var my_yW:Number;
var my_thumb_widthW:Number;
var my_thumb_heightW:Number;
var my_imagesW:XMLList;
var my_totalW:Number;

var container_mcW:MovieClip;
var preloaders_mcW:MovieClip;
var book:TextField = new TextField();
var author:TextField = new TextField();
var publisher:TextField = new TextField();
book.selectable = true;

var x_counterW:Number = 0;
var y_counterW:Number = 0;

var my_tweensW:Array = [];
var container_mc_tweenW:Tween;

var myXMLLoaderW:URLLoader = new URLLoader();

myXMLLoaderW.load(new URLRequest("WORKS.xml"));
myXMLLoaderW.addEventListener(Event.COMPLETE, processXMLW);

createContainerW();
callThumbsW();

function processXMLW(e:Event):void {
var myXMLW:XML = new XML(e.target.data);

rowsW = myXMLW.@ROWS;
my_xW = myXMLW.@XPOSITION;
my_yW = myXMLW.@YPOSITION;
my_thumb_widthW = myXMLW.@WIDTH;
my_thumb_heightW = myXMLW.@HEIGHT;
my_imagesW = myXMLW.IMAGE;
my_totalW = my_imagesW.length();

myXMLLoaderW.removeEventListener(Event.COMPLETE, processXMLW);
myXMLLoaderW = null;

}

function createContainerW():void {
container_mcW = new MovieClip();
container_mcW.x = my_xW;
container_mcW.y = my_yW;
addChild(container_mcW);

preloaders_mcW = new MovieClip();
preloaders_mcW.x = container_mcW.x;
preloaders_mcW.y = container_mcW.y;
addChild(preloaders_mcW);
}

function callThumbsW():void {
for (var i:Number = 0; i < my_totalW; i++) {

    var thumb_urlW = my_imagesW[i].@THUMB;
    book.text = my_imagesW[i].@TITLE;
    author.text = my_imagesW[i].@AUTHOR;
    publisher.text = my_imagesW[i].@PUBLISHER;

    var thumb_loaderW = new Loader();
    thumb_loaderW.load(new URLRequest(thumb_urlW));

thumb_loaderW.contentLoaderInfo.addEventListener(Event.COMPLETE,thumbLoadedW);

    thumb_loaderW.name = i;

    book.x = (40)*x_counterW;
    book.y = (my_thumb_heightW+40)*y_counterW;
    thumb_loaderW.x = (my_thumb_widthW+10)*x_counterW;
    thumb_loaderW.y = (my_thumb_heightW+10)*y_counterW;

    container_mcW.addChild(book);
    container_mcW.addChild(author);
    container_mcW.addChild(publisher);
    trace("my x equals" (book.x));

    if (y_counterW+1 < rowsW) {
        y_counterW++;
    } else {
        y_counterW = 0;
        x_counterW++;
    }
    var preloader_pbW:ProgressBar = new ProgressBar();
    preloader_pbW.source = thumb_loaderW.contentLoaderInfo;
    preloader_pbW.x = thumb_loaderW.x;
    preloader_pbW.y = thumb_loaderW.y;
    preloader_pbW.width = my_thumb_widthW;
    preloader_pbW.height = my_thumb_heightW;
    preloaders_mcW.addChild(preloader_pbW);

    preloader_pbW.addEventListener(Event.COMPLETE, donePbW);

}
}

function thumbLoadedW(e:Event):void {
var my_thumbW:Loader = Loader(e.target.loader);
container_mcW.addChild(my_thumbW);

my_tweensW[Number(my_thumbW.name)]=new Tween(my_thumbW, "alpha", Strong.easeIn, 0,1,0.5, true);

my_thumbW.contentLoaderInfo.removeEventListener(Event.COMPLETE, thumbLoadedW);
}

function donePbW(e:Event):void {
var my_pbW:ProgressBar = ProgressBar(e.target);
preloaders_mcW.removeChild(my_pbW);
my_pbW.removeEventListener(Event.COMPLETE, donePbW);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T03:18:18.260

在我看来，您似乎没有正确加载 XML。您应该使用 URLLoader，而不是加载器来加载 XML。然后，您需要等待直到触发 Event.COMPLETE 来解析数据并添加您的文本字段。

来自 sephiroth ( [http://www.sephiroth.it/tutorials/flashPHP/E4X/](http://www.sephiroth.it/tutorials/flashPHP/E4X/) ):

```
import flash.net.URLLoader
import flash.net.URLRequest
import flash.xml.XML
import flash.event.*
import flash.error.*

var mainXML:XML;
var loader:URLLoader = new URLLoader();
loader.addEventListener(Event.COMPLETE, onComplete);
loader.load(new URLRequest("http://www.sephiroth.it/tutorials/flashPHP/E4X/files/test.xml"));

function onComplete(evt:Event)
{
    mainXML = new XML(loader.data)
    trace("xml loaded, start parsing using E4X syntax");
} 
```

好吧，既然您已经大量编辑了您的问题，是的，很明显您已经在其中有了它。在您尝试将其解析为 xml 对象之前，我会尝试跟踪/观察 loader.data，以查看您尝试将哪些数据解析为 XML。听起来你可能会得到一些你不期望的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T10:43:36.107

我的代码最多只显示 XML 列表中的一个结果的原因是因为我在循环之外实例化了一个 TextField，该循环从 XML 的许多节点中绘制了 var i。为了正确显示每个节点的文本字段，我需要为每个 var i 实例化 TextField。像这样 ：

```
function callThumbsW():void {
for (var i:Number = 0; i < my_totalW; i++) {

    var thumb_urlW = my_imagesW[i].thumb;
    var book = my_imagesW[i].TITLE;

    var textHolder:TextField = new TextField;
    container_mcW.addChild(textHolder); 
```

这会带来即时的满足感。

# java - 带有 JDK 1.6.0 的 Axis 1.2 Web 服务

> ID：822665
> 
> 赞同：1
> 
> 时间：2009-05-04T23:47:11.123
> 
> 标签：java, axis, jdk1.6

我们迁移了一个使用 JDK 1.4 和 axis 1.0 构建的轴 Web 服务。

我们正在尝试使用轴 1.2 将其迁移到 JDK 1.6.0，但我收到以下空指针异常。

只要切换回 JDK 1.4，相同的代码就可以正常工作。

有什么帮助吗？提前致谢。

```
java.lang.NullPointerException
    at au.com.michaelpage.placement.model.rdb.dao.StatusDAO.statusAlreadyExists(StatusDAO.java:275)
    at au.com.michaelpage.placement.model.rdb.dao.StatusDAO.insert(StatusDAO.java:176)
    at au.com.michaelpage.pseweb.migrator.MigratorManager.processOnlinePlacement(MigratorManager.java:55)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.axis.providers.java.RPCProvider.invokeMethod(RPCProvider.java:388)
    at org.apache.axis.providers.java.RPCProvider.processMessage(RPCProvider.java:283)
    at org.apache.axis.providers.java.JavaProvider.invoke(JavaProvider.java:323)
    at org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)
    at org.apache.axis.SimpleChain.doVisiting(SimpleChain.java:118)
    at org.apache.axis.SimpleChain.invoke(SimpleChain.java:83)
    at org.apache.axis.handlers.soap.SOAPService.invoke(SOAPService.java:453)
    at org.apache.axis.server.AxisServer.invoke(AxisServer.java:281)
    at org.apache.axis.transport.http.AxisServlet.doPost(AxisServlet.java:699)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
    at org.apache.axis.transport.http.AxisServletBase.service(AxisServletBase.java:327)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:227)
    at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:125)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:292)
    at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:175)
    at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3495)
    at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
    at weblogic.security.service.SecurityManager.runAs(Unknown Source)
    at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2180)
    at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2086)
    at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1406)
    at weblogic.work.ExecuteThread.execute(ExecuteThread.java:201)
    at weblogic.work.ExecuteThread.run(ExecuteThread.java:173) 
```

新的堆栈跟踪。

```
(404)Not Found
    at org.apache.axis.transport.http.HTTPSender.readFromSocket(HTTPSender.java:744)
    at org.apache.axis.transport.http.HTTPSender.invoke(HTTPSender.java:144)
    at org.apache.axis.strategies.InvocationStrategy.visit(InvocationStrategy.java:32)
    at org.apache.axis.SimpleChain.doVisiting(SimpleChain.java:118)
    at org.apache.axis.SimpleChain.invoke(SimpleChain.java:83)
    at org.apache.axis.client.AxisClient.invoke(AxisClient.java:165)
    at org.apache.axis.client.Call.invokeEngine(Call.java:2765)
    at org.apache.axis.client.Call.invoke(Call.java:2748)
    at org.apache.axis.client.Call.invoke(Call.java:2424)
    at org.apache.axis.client.Call.invoke(Call.java:2347)
    at org.apache.axis.client.Call.invoke(Call.java:1804)
    at au.com.michaelpage.pseweb.migrator.ws.PseMigratorSoapBindingStub.processOnlinePlacement(PseMigratorSoapBindingStub.java:115)
    at au.com.michaelpage.pseweb.migrator.MigratorScheduledTask.run(MigratorScheduledTask.java:47)
    at au.com.michaelpage.pseweb.migrator.MigratorScheduledTask.main(MigratorScheduledTask.java:35) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T00:58:18.503

异常看起来像是来自您的代码：

```
au.com.michaelpage.placement.model.rdb.dao.StatusDAO.statusAlreadyExists(StatusDAO.java:275) 
```

您使用的是哪个版本的 WebLogic？唯一通过 JDK 6 认证的版本是 WebLogic 10.3。

我无法从堆栈跟踪中分辨出来，但我敢打赌这与代理生成和 JAR 版本冲突有关。

我认为从 JDK 1.4 和 Axis 1.0 到 JDK 6 和 Axis 1.2 的提升和负载充满了危险。有很多变化。你遇到困难并不奇怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T02:34:16.200

您首先在第 275 行的 StatusDAO.java 类中调查 NullPointerException 的原因。了解对象为空的原因。

不确定这里的根本原因是什么，但我在升级到较新版本的 Jibx 时遇到了类似的问题。Jibx 将 XML 转换为 Java 对象，反之亦然。如果一个特定的节点列表是空白的，它曾经用空白的 ArrayList 设置它，但在较新的版本中，它将它设置为 null，这会导致许多地方出现空指针。通过跟踪空指针，我设法找到了根本原因并修复了它。

# sql-server - SQL Server 2000 企业管理器：无法查看添加到视图设计器的表中的列

> ID：822667
> 
> 赞同：0
> 
> 时间：2009-05-04T23:47:45.180
> 
> 标签：sql-server, sql-server-2000

我有一个 SQL Server 2000 数据库，它不会在企业管理器的“设计器”视图中显示任何表的列列表 当设计新视图或编辑现有视图时，会出现此问题。图表中每个表显示的所有内容都是“*（所有列）”。否则，这些观点有效。

我对任何其他数据库都没有这个问题。

我在这个数据库上运行了 DBCC CHECKDB，它报告了 0 个错误。

SQL Server 日志文件不报告除“错误：15457，严重性：0，状态：1”之外的任何错误，IIRC 并不是真正的错误，与此问题无关。

我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T00:16:38.103

（咳）嗯……这似乎是企业管理器中的一个错误，当数据库名称中有句号时会发生这种错误。

检查数据库名称中是否有句号（“.”），如果有，则使用不同的名称恢复数据库，省略句号。

（从上面的评论对话中收集到的答案）

# c# - ReSharper 在获得之前是否需要经验？

> ID：822670
> 
> 赞同：3
> 
> 时间：2009-05-04T23:48:38.513
> 
> 标签：c#, visual-studio

我有大约 4-5 年的 C# 和 C++ 编程背景。我最近得到了一份实习，每天都在使用 C#。我对自己的工作充满信心，记住语法或类似的东西没有任何问题。所以我想知道你对重新锐化有什么看法？我打算先演示它，但我只是想听听关于它的其他意见。基本上我想问的是，我是否应该等待获得它并变得更有经验并仅使用 Visual Studios 及其内置的智能感知和其他东西进行更多练习，还是可以得到它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T23:52:16.230

没有它我不会工作。它复制了一堆 Visual Studio 的东西，并添加了更多。它只是改进了 Visual Studio，并且完全不会影响您学习 c#。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T23:55:37.610

我是一名开发人员，从 .net 1.0 天开始每天都在使用 C#，我通常喜欢保持安装的基本原理，这样如果我的开发环境以某种方式被破坏，我可以尽快恢复运行尽可能。但是，我最近与另一个需要安装 Resharper 的开发人员进行了一些配对。我发现的是：

1.  我学到了很多关于 C# 功能的知识，我从来没有新的存在过。
2.  它的测试运行器比 VS 好得多。
3.  有更好的重构工具。

关于我唯一不喜欢的是它重新排列了一些默认的 VS 键盘快捷键，但是在选项对话框中进行了一些修改后，我能够关闭我不需要的功能。

我现在想念它，在审判之后。不幸的是，我目前无法负担许可证的费用（现金流问题，而不是不值得的问题），并且无法说服我的老板为我获得许可证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T23:52:24.090

在你的研究过程中尝试使用[Refactor Pro 和 CodeRush](http://devexpress.com/Products/Visual_Studio_Add-in/Coding_Assistance/)作为 Resharper 的替代品。它们共同构成了一台不可阻挡的生产力机器。当我在 C# 中开发时，我使用它们多年，没有它们工作感觉就像我错过了一个额外的我。:-)

当然，您应该研究这两种产品。这不是要记住语法，而是要减少每个人一直犯的编码错误的数量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T23:52:42.593

我可以根据我的经验告诉你，无论你的技能多么扎实，ReSharper 都会让人上瘾，而且它对 VS 中的 C# 编程来说是一个很大的增强。事实上，上瘾来自于这样一个事实，即它真的可以让你节省大量时间，否则会花在做乏味的任务上，同时它会帮助你编写干净的代码，从而减少重构所花费的时间（通过ReSharper 无论如何）。如果配置正确，它可能是 - 在我看来 - 最有价值的 VS 插件，我真的不明白为什么你应该拒绝自己访问它:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T23:59:54.807

物有所值，特别是如果您可以让您的公司为您购买它。理论上我可以在没有它的情况下工作，但我不想这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T00:30:17.353

Resharper 就像学习钢琴和弦，然后能够演奏你听到的任何歌曲。您可以以“错误”的方式编写代码，突出显示其中的一些内容，进行组合键，然后将其清理干净。

v4.5 在性能方面也取得了巨大进步。一些大的解决方案会陷入困境，但这个解决方案要快得多。从上到下都很牢固。

# silverlight - 如何使用 Silverlight2 ItemsControl 在画布上定位项目集合？

> ID：822680
> 
> 赞同：3
> 
> 时间：2009-05-04T23:51:44.887
> 
> 标签：silverlight, listbox, canvas, silverlight-2.0, itemscontrol

在 WPF 中，您可以创建一个带有 Canvas 作为 ItemsPanel 的 ListBox，并在该画布上放置项目。执行此操作的代码如下所示：

```
<ListBox ItemsSource="{Binding}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=Name}"/>
        </DataTemplate>
    </ListBox.ItemTemplate>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <Canvas Width="200" Height="200"/>
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
    <ListBox.ItemContainerStyle>
        <Style TargetType="ListBoxItem">
            <Setter Property="Canvas.Left" Value="{Binding Path=XPos}"/>
            <Setter Property="Canvas.Top" Value="{Binding Path=YPos}"/>
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

你能在 Silverlight2 ListBox 或者最好是 ItemsControl 中做同样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T00:06:47.317

我找到**了**解决方案，但（对我而言）它闻起来很臭。

```
<ListBox ItemsSource="{Binding}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Canvas Width="200" Height="200">
                <TextBlock 
                    Text="{Binding Path=Name}" 
                    Canvas.Left="{Binding Path=XPos}" 
                    Canvas.Top="{Binding Path=YPos}" />
            </Canvas>
        </DataTemplate>
    </ListBox.ItemTemplate>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <Canvas Width="200" Height="200"/>
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
</ListBox> 
```

每个项目都有自己的画布，因此它们最终堆叠在一起。

# ruby-on-rails - 了解 Rails 世界最新消息的最佳方式是什么？

> ID：822683
> 
> 赞同：1
> 
> 时间：2009-05-04T23:52:07.307
> 
> 标签：ruby-on-rails

当我在这里阅读一些答案时，我注意到有些人知道即将对 Rails 语法进行更改，但我不确定他们是如何找到这些更改的。有关 Rails 语法更改或更新的最新信息的好来源是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T23:56:57.107

官方的[Riding Rails 博客](http://weblog.rubyonrails.org/)会定期详细介绍即将发生的变化（通常标题为“本周在 Edge Rails 中”）并回顾新版本发布时发生的变化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T23:56:03.940

[Fresh Cup](http://afreshcup.com)几乎在每个工作日都会提供许多链接，其中包括有关 Rails 核心更改的信息等。

[The Week in Edge Rails](http://weblog.rubyonrails.org/edge)是另一个可能感兴趣的新签到的好资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T00:00:49.610

或者您可以从消防水管中喝水并关注[github 上的 rails 项目](http://github.com/rails/rails/tree/master)，您甚至可以获得一个 rss 提要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T14:52:22.103

我喜欢[http://twitter.com/rails](http://twitter.com/rails)。他们通常在 rails 博客或其他地方发布指向更改的链接。

# java - 字符串到字符串中的Java字符串

> ID：822694
> 
> 赞同：2
> 
> 时间：2009-05-04T23:55:59.043
> 
> 标签：java, string

我有这个字符串：`"\"Blah \'Blah\' Blah\""`。里面还有一根绳子。我如何将其转换为：`Blah 'Blah' Blah`？（你看，取消转义字符串。）这是因为我得到了一个 SQL Where 查询：

```
WHERE blah="Blah \'Blah\' Blah" 
```

当我解析这个时，我得到了上面的字符串（仍然在引号内并转义。）我将如何提取它，取消转义字符串？还是有一些更简单的方法来做到这一点？谢谢，
艾萨克

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T00:30:03.033

# 不要这样做。

按照正确的步骤对数据库/平台上的查询进行参数化，您不必逃避任何事情。您还将保护自己免受注入漏洞的侵害。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T00:15:29.027

将字符串放在属性文件中，Java 支持 XML 属性文件，并且引号字符在 XML 中不需要转义。

使用 Properties 类的 loadFromXML(InputStream in) 方法。

然后，如果需要，您可以使用 MessageFormat 类将值插入到字符串中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T00:27:58.810

这应该是对的。这假设如果它以引号开头，则以引号结尾。

```
if (val.startsWith("\"") || val.startsWith("\'")) 
   val = val.substring(1, val.length-2); 
```

您可能也希望添加`val = val.trim();`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-04T23:59:34.790

```
"\"Blah \'Blah\' Blah\"".replaceAll("\"", "") 
```

# c# - 未从 C# 中的 HttpWebResponse 对象生成完整响应

> ID：822704
> 
> 赞同：0
> 
> 时间：2009-05-04T23:59:30.347
> 
> 标签：c#, asp.net, httpwebrequest, query-string, httpwebresponse

我正在从另一个 aspx 页面创建一个 HttpWebRequest 对象，以将响应流保存到我的数据存储中。我用来创建 HttpWebRequest 对象的 URL 具有查询字符串来呈现正确的输出。当我使用任何旧浏览器浏览页面时，它会正确呈现。当我尝试使用 HttpWebResponse.GetResponseStream() 检索输出流时，它会呈现我的内置错误检查。

为什么它会在浏览器中正确呈现，但不使用 HttpWebRequest 和 HttpWebResponse 对象？

这是源代码：

目标页面后面的代码：

```
protected void PageLoad(object sender, EventsArgs e)
{
   string output = string.Empty;

   if(Request.Querystring["a"] != null)
   {
      //generate output
      output = "The query string value is " + Request.QueryString["a"].ToString();
   }
   else
   {
      //generate message indicating the query string variable is missing
      output = "The query string value was not found";
   }

   Response.Write(output);
} 
```

创建 HttpWebRequest 对象的页面背后的代码

```
string url = "http://www.mysite.com/mypage.aspx?a=1";
HttpWebRequest request = (HttpWebRequest) WebRequest.Create(url)

//this if statement was missing from original example
if(User.Length > 0)
{
    request.Credentials = new NetworkCredentials("myaccount", "mypassword", "mydomain");
    request.PreAuthenticate = true;
}

request.UserAgent = Request.UserAgent;
HttpWebResponse response = (HttpWebResponse) request.GetResponse();
Stream resStream = response.GetResponseStream();  
Encoding encode = System.Text.Encoding.GetEncoding("utf-8");
StreamReader readStream = new StreamReader(resStream, encode, true, 2000);
int count = readStream.Read(read, 0, read.Length);
string str = Server.HtmlEncode(" ");

while (count > 0)
{
    // Dumps the 256 characters on a string and displays the string to the console.
    string strRead = new string(read, 0, count);
    str = str.Replace(str, str + Server.HtmlEncode(strRead.ToString()));
    count = readStream.Read(read, 0, 256);
}

// return what was found
result = str.ToString();

resStream.Close();
readStream.Close(); 
```

**更新**

@David McEwing - 我正在创建带有完整页面名称的 HttpWebRequest。该页面仍在生成错误输出。我更新了目标页面的代码示例，以准确演示我在做什么。

@Chris Lively - 我没有重定向到错误页面，我生成一条消息，指示未找到查询字符串值。我更新了源代码示例。

**更新1：**

我尝试使用 Fiddler 来跟踪 HttpWebRequest，但它没有出现在 Web Sessions 历史记录窗口中。我是否在源代码中遗漏了某些内容以获得完整的 Web 请求和响应。

**更新 2：**

我的示例中没有包含以下代码部分，这是导致问题的罪魁祸首。我正在使用服务帐户而不是导致问题的 AD 帐户设置`Credentials`属性。`HttpWebRequest`

我更新了我的源代码示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T00:18:29.083

你用的是什么网络服务器？我记得在过去使用 IIS 做某事时，有一个问题是[http://example.com/](http://example.com/)和[http://example.com/default.asp](http://example.com/default.asp)之间的重定向丢弃了查询字符串。

也许运行 Fiddler（或协议嗅探器）并查看是否发生了您未预料到的事情。

还要检查传递完整页面名称是否有效。如果确实如此，则几乎可以肯定是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T01:15:37.980

或者，您可以尝试使用 HttpRequestObject 的[AllowAutoRedirect](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.allowautoredirect.aspx)属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:41:28.627

我需要替换以下代码行：

```
request.Credentials = new NetworkCredentials("myaccount", "mypassword", "mydomain"); 
```

和：

```
request.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials; 
```

# php - PHP生成文件以供下载然后重定向

> ID：822707
> 
> 赞同：66
> 
> 时间：2009-05-05T00:00:48.033
> 
> 标签：php, redirect, header

我有一个 PHP 应用程序，它创建一个强制使用标题下载的 CSV 文件。这是代码的相关部分：

```
header('Content-Type: application/csv'); 
header("Content-length: " . filesize($NewFile)); 
header('Content-Disposition: attachment; filename="' . $FileName . '"'); 
echo $content;
exit(); 
```

我想做的是在构建文件并发送下载提示后将用户重定向到新页面。预期只是添加`header("Location: /newpage")`到末尾没有用，所以我不确定如何安装它。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-05-05T00:09:56.013

我不认为这是可以做到的——尽管我不是 100% 确定。

常见的事情（例如在流行的下载站点中）是相反的：首先您转到*后*页，然后开始下载。

因此，将您的用户重定向到*最后*一页（除其他外）：

您的下载应该会自动开始。如果没有点击`[a href="create_csv.php"]here[/a]`。

至于启动下载（例如自动调用 create_csv.php），您有很多选择：

*   HTML：`[meta http-equiv="refresh" content="5;url=http://site/create_csv.php"]`
*   Javascript：`location.href = 'http://site/create_csv.php';`
*   框架：`[iframe src="create_csv.php"][/iframe]`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-11-21T15:15:43.670

在确实需要的情况下很容易做到。

但是你需要在 JavaScript 和 cookie 方面做一些工作：

在 PHP 中，您应该添加设置 cookie

```
header('Set-Cookie: fileLoading=true'); 
```

然后在您调用下载的页面上，您应该使用 JS 跟踪（例如每秒一次），如果有这样的 cookie（这里使用了插件[jQuery cookie](https://github.com/carhartl/jquery-cookie)）：

```
setInterval(function(){
  if ($.cookie("fileLoading")) {
    // clean the cookie for future downoads
    $.removeCookie("fileLoading");

    //redirect
    location.href = "/newpage";
  }
},1000); 
```

现在，如果文件开始被下载，JS 会识别它并在 cookie 被删除后重定向到所需的页面。

当然，你可以告诉你需要浏览器接受cookies、JavaScript等，但它确实有效。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-05T00:07:09.423

您发送的标头是 HTTP 标头。浏览器将其作为页面请求并将其作为页面处理。在您的情况下，它需要下载一个页面。

所以添加一个重定向头会混淆下载文件的整个过程（因为头被收集，生成一个头然后发送到浏览器，你可以通过设置多个重定向头IIRC来尝试这个）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-09-15T07:52:25.397

这是一个很老的问题，但这是我通过 JS 实现的方法。

```
// Capture the "click" event of the link.
var link = document.getElementById("the-link");
link.addEventListener("click", function(evt) {
  // Stop the link from doing what it would normally do.
  evt.preventDefault();
  // Open the file download in a new window. (It should just
  // show a normal file dialog)
  window.open(this.href, "_blank");
  // Then redirect the page you are on to whatever page you
  // want shown once the download has been triggered.
  window.location = "/thank_you.html";
}, true); 
```

通过 - [https://www.daniweb.com/web-development/php/threads/463652/page-not-redirecting-after-sending-headers-in-php](https://www.daniweb.com/web-development/php/threads/463652/page-not-redirecting-after-sending-headers-in-php)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-10-24T21:26:02.627

但是请记住，为 IE 用户自动启动可下载文件将触发安全警告选项卡。Daremon 概述的所有三种方法都会显示此警告。你根本无法解决这个问题。如果您提供真实的链接，您将获得更好的服务。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-12-23T17:15:11.347

```
<?php 
    function force_file_download($filepath, $filename = ''){
        if($filename == ''){
            $filename = basename($filepath);
        }

        header('Content-Type: application/octet-stream');
        header("Content-Transfer-Encoding: Binary"); 
        header("Content-disposition: attachment; filename=\"" . $filename . "\""); 
        readfile($filepath); // do the double-download-dance (dirty but worky)  
    }

    force_file_download('download.txt');
?>
<script type="text/javascript">
    location = 'page2.php'
</script> 
```

这是使用javascript的解决方案。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-14T17:21:27.997

我找到了一种依赖于 javascript 的解决方法，因此它并不完全安全，但对于不安全的关键站点，它似乎可以工作。

有一个带有标题为“下载”按钮的表单，其操作设置为指向下载脚本，然后使用 javascript 在 onsubmit 处理程序上放置一些东西，该处理程序去除下载按钮并替换屏幕上的消息。下载应该仍然发生并且屏幕会改变。显然，如果下载脚本有问题，那么即使它没有触发，下载看起来仍然是成功的，但这是我现在最好的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-09-07T09:46:31.323

**更新：**新解决方案：

```
<a id="download-link" 
   href="https://example.com/uploads/myfile.pdf" 
   class="btn">Download</a> 
```

* * *

```
<script>
    jQuery(document).ready(function(  ) {
        jQuery("#download-link").click(function(e) {
            e.preventDefault(); 
            var url = jQuery(this).attr('href');
            var _filename = url.split('/');
            _filename = _filename[_filename.length - 1];
            console.log(_filename);

            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json; charset=utf-8'
                },
            })
            .then(response => response.blob())
            .then(response => {
                const blob = new Blob([response], {type: 'application/pdf'});
                const downloadUrl = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = downloadUrl;
                a.download = _filename;
                document.body.appendChild(a);
                a.click();
            });

        });
    });
</script> 
```

* * *

[来源](https://stackoverflow.com/questions/34586671/download-pdf-file-using-jquery-ajax/61313254#61313254)

**老答案：**

答案是：
这是工作！
您需要三个不同的代码部分：

**HTML**

```
<a id="download_btn" class="btn btn-primary" href="?file=filename&download=1">Download<&/a> 
```

**jQuery**

```
$('#download_btn').click(function(){
    window.location.href = '<?=base_url()?>/?file=<?=$file;?>&download=1';
}).focusout (function(){
    window.location.href = '<?=base_url()?>';
    return false;
}); 
```

**PHP**

```
 if(isset($_GET['download']) && isset($_GET['file'])){

            $zip_path = 'path_to/'.$_GET['file'].'.zip';

            if(file_exists($zip_path)){
                header('Content-Type: application/zip');
                header('Content-Disposition: attachment; filename="'.basename($zip_path).'"');
                header('Content-Length: ' . filesize($zip_path));
                header('Location: '.$zip_path);
            }

        } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-03-21T15:39:08.793

您可以尝试重定向到 URL 以及表示文件内容的参数。并且在重定向中，您可以输出文件内容以供下载。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-05-10T23:48:04.593

使用以下命令启动包含 CSV 下载的 PHP 文件：

```
<a onclick="popoutWin(\'csvexport.php\')" >Download CSV File</a> 
```

或者

```
<input name="newThread" type="button" value="Download CSV File"
        onclick="popoutWin(\'csvexport.php\')" /> 
```

JavaScript 函数在`popoutWin`哪里

```
/*
 * Popout window that self closes for use with downloads
 */
function popoutWin(link){
    var popwin = window.open(link);
    window.setTimeout(function(){
        popwin.close();
    }, 500);
} 
```

这将打开一个窗口，显示 CSV 下载提示，然后立即关闭窗口，只留下提示。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-10-29T12:51:06.997

嗯……

将下面的代码放在网站的主要 javascript 中。

```
 if (window.location.pathname == '/url_of_redirect/') {
        window.open(location.protocol + '//' + location.hostname + '/url_of_download.zip', '_parent');
    } 
```

解释：它使用 php 将正常重定向到您将定义的某个 url，在 javascipt 中它说：如果路径名与重定向的路径相同 '/url_of_redirect/' 然后它会在新页面上打开 url，生成下载。

# c++ - 如何在 C/C++ 中使用 WinHTTP 下载文件？

> ID：822714
> 
> 赞同：11
> 
> 时间：2009-05-05T00:03:19.477
> 
> 标签：c++, c, windows, http, winhttp

我知道如何下载 html/txt 页面。例如 ：

```
//Variables 
DWORD dwSize = 0;
DWORD dwDownloaded = 0;
LPSTR pszOutBuffer;
vector <string>  vFileContent;
BOOL  bResults = FALSE;
HINTERNET  hSession = NULL, 
           hConnect = NULL,
           hRequest = NULL;

// Use WinHttpOpen to obtain a session handle.
hSession = WinHttpOpen( L"WinHTTP Example/1.0",  
                        WINHTTP_ACCESS_TYPE_DEFAULT_PROXY,
                        WINHTTP_NO_PROXY_NAME, 
                        WINHTTP_NO_PROXY_BYPASS, 0);

// Specify an HTTP server.
if (hSession)
    hConnect = WinHttpConnect( hSession, L"nytimes.com",
                               INTERNET_DEFAULT_HTTP_PORT, 0);

// Create an HTTP request handle.
if (hConnect)
    hRequest = WinHttpOpenRequest( hConnect, L"GET", L"/ref/multimedia/podcasts.html",
                                   NULL, WINHTTP_NO_REFERER, 
                                   NULL, 
                                   NULL);

// Send a request.
if (hRequest)
    bResults = WinHttpSendRequest( hRequest,
                                   WINHTTP_NO_ADDITIONAL_HEADERS,
                                   0, WINHTTP_NO_REQUEST_DATA, 0, 
                                   0, 0);

// End the request.
if (bResults)
    bResults = WinHttpReceiveResponse( hRequest, NULL);

// Keep checking for data until there is nothing left.
if (bResults)
    do 
    {

        // Check for available data.
        dwSize = 0;
        if (!WinHttpQueryDataAvailable( hRequest, &dwSize))
            printf( "Error %u in WinHttpQueryDataAvailable.\n",
                    GetLastError());

        // Allocate space for the buffer.
        pszOutBuffer = new char[dwSize+1];
        if (!pszOutBuffer)
        {
            printf("Out of memory\n");
            dwSize=0;
        }
        else
        {
            // Read the Data.
            ZeroMemory(pszOutBuffer, dwSize+1);

            if (!WinHttpReadData( hRequest, (LPVOID)pszOutBuffer, 
                                  dwSize, &dwDownloaded))
            {
                printf( "Error %u in WinHttpReadData.\n", 
                        GetLastError());
            }
            else
            {
                        printf("%s", pszOutBuffer);
                            // Data in vFileContent
                vFileContent.push_back(pszOutBuffer);
            }

            // Free the memory allocated to the buffer.
            delete [] pszOutBuffer;
        }

    } while (dwSize>0);

// Report any errors.
if (!bResults)
    printf("Error %d has occurred.\n",GetLastError());

// Close any open handles.
if (hRequest) WinHttpCloseHandle(hRequest);
if (hConnect) WinHttpCloseHandle(hConnect);
if (hSession) WinHttpCloseHandle(hSession);

// Write vFileContent to file
ofstream out("test.txt",ios::binary);
for (int i = 0; i < (int) vFileContent.size();i++)
out << vFileContent[i];
out.close(); 
```

当我尝试下载图片时，我只得到文件的第一行并且没有错误消息。该问题似乎与 WinHttpOpenRequest 函数中的此参数（ppwszAcceptTypes）有关。

[链接文本](http://msdn.microsoft.com/en-us/library/aa384099(VS.85).aspx)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T09:21:39.947

仅以二进制模式打开 ofstream 不会改变 << 运算符的工作方式 - 它们将始终执行格式化输出。您需要使用流的 write() 函数，该函数执行未格式化的输出。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-05T01:37:49.487

解决方案 ：

```
FILE * pFile; // NEW
pFile = fopen("file.bin", "w+b"); // NEW

if (bResults)
    do 
    {
        // Check for available data.
        dwSize = 0;
        if (!WinHttpQueryDataAvailable( hRequest, &dwSize))
            printf( "Error %u in WinHttpQueryDataAvailable.\n",
                    GetLastError());

        // Allocate space for the buffer.
        pszOutBuffer = new char[dwSize+1];

        if (!pszOutBuffer)
        {
            printf("Out of memory\n");
            dwSize=0;
        }
        else
        {
            // Read the Data.
            ZeroMemory(pszOutBuffer, dwSize+1);

            if (!WinHttpReadData( hRequest, (LPVOID)pszOutBuffer, 
                                  dwSize, &dwDownloaded))
            {
                printf( "Error %u in WinHttpReadData.\n", 
                        GetLastError());
            }
            else
            {
                            printf("%s", pszOutBuffer);
                fwrite(pszOutBuffer, (size_t)dwDownloaded, (size_t)1, pFile); // NEW

            }

            // Free the memory allocated to the buffer.
            delete [] pszOutBuffer;
        }

    } while (dwSize>0);

fclose (pFile); // NEW 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T01:04:15.243

看起来MSDN上的这个线程是一样的并且有解决方案

[http://social.msdn.microsoft.com/forums/en-US/vclanguage/thread/45ccd91c-6794-4f9b-8f4f-865c76cc146d](http://social.msdn.microsoft.com/forums/en-US/vclanguage/thread/45ccd91c-6794-4f9b-8f4f-865c76cc146d)

# c# - C# - 使用 LINQ 将两个变量放入二维数组？

> ID：822717
> 
> 赞同：6
> 
> 时间：2009-05-05T00:03:37.637
> 
> 标签：c#, linq

我有一个带有两个变量“startLocation”和“endLocation”的“区域”类的列表<>。我想将这两者组合成一个新的排序二维数组，其中只有 Location 和一个整数，表示它的开始还是结束。

例如，如果列表包含三个区域对象

> [区域 1]：startLocation = 5，endLocation = 7
> 
> [区域 2]：startLocation = 3，endLocation = 5
> 
> [区域 3]：startLocation = 8，endLocation = 9

我想得到一个排序的二维数组（或列表或类似的），看起来像：

> [3] [1]
> 
> [5] [1]
> 
> [5] [-1]
> 
> [7] [-1]
> 
> [8] [1]
> 
> [9] [-1]

（最好我希望重叠将它们的第二个值加在一起，因此数组中的两个单独的 5 将组合成 [5 0] ......但这不是太重要）

我目前正在使用常规的 forloop 逐个遍历并一次将它们添加到列表中。这个实现很慢，因为我正在处理大型数据集，而且我猜有一种更优雅/更快的方法可以通过 LINQ 完成此操作。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T00:10:38.883

您需要定义一个辅助方法，它将一个区域分成两部分，并且使用新结构与二维数组更容易表示这一点

```
struct Data {
  public int Value;
  public bool IsStart;
}

public static IEnumerable<Data> Split(this Region region) {
  yield return new Data() { Value = region.StartLocation, IsStart=true};
  yield return new Data() { Value = region.EndLocation, IsStart=false};
} 
```

然后，您可以使用以下 LINQ 查询将它们分解并排序。

```
List<Region> list = GetTheList();
var query = list
  .SelectMany(x =>  x.Split())
  .OrderBy(x => x.Data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T00:10:25.857

除了智力练习之外，这不是适合 LINQ 的解决方案。循环将`foreach`与任何拼凑在一起的 LINQ 实现一样快（实际上可能更快）。

作为旁注，我假设您使用的是`foreach`而不是`for`. `foreach`如果没有，那么您可以通过切换到循环来显着加快您的流程。

```
foreach(Region r in regionList)
{
    // add your entries using r
} 
```

会比..快得多

```
for(int i = 0; i < regionList.Count; i++)
{
    // add your entires using the indexer
} 
```

# logging - 我应该关闭 IIS 6 日志记录吗？

> ID：822718
> 
> 赞同：3
> 
> 时间：2009-05-05T00:04:26.463
> 
> 标签：logging, iis-6

为什么我不想为小型（100 个用户）Intranet 应用程序完全禁用 IIS 日志记录的一些原因是**什么**？

我不是 Ops 人（只是假装是这个应用程序的人），所以我以前从未关心过这些东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T00:19:46.367

1.  日志可帮助您更快地排除故障和诊断问题。如果您的网络出现问题，这可以为您节省数小时。

2.  日志可帮助您识别任何不应发生的权限提升（用户访问他们不应访问的内容）。

3.  日志可以与日志解析器结合使用，以识别网络上的故障点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T01:21:05.483

日志是您在需要它们之前不关心的事情之一。到那时，回到过去并再次打开它们为时已晚。

只需将其保持打开状态并制定清理策略以存档/删除超过特定时间段的日志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T00:33:03.120

您可以随时关闭它们，但是在尝试调试时您必须打开它们。这样做的缺点是，如果您尝试调试的问题是间歇性的，您可能很难知道何时打开/关闭日志记录。

我会留下登录并设置为“IIS 日志”。您的日志文件不会那么详细，但至少您将能够看到需要调试的任何问题的“历史记录”。

# c++ - 如何从程序创建/运行 .exe？(C++)

> ID：822728
> 
> 赞同：0
> 
> 时间：2009-05-05T00:08:03.680
> 
> 标签：c++, function, parameters, executable

是否可以（如果可以，如何）用 C++ 编写一个带有参数的程序，然后从另一个 C++ 程序运行该程序。

即：我可以创建一个添加两个数字的函数：

```
int add(int a,int b){return a+b;} 
```

是否可以做同样的事情，除了一个单独的 C++ .exe 而不是一个函数？

编辑：由于很多人不理解我的问题，我会尽量准确地说出我想知道该怎么做。

我想要一个程序，我们称之为“p1”。

我希望该程序从用户那里获得两个数字：

```
int x,y;
cin>>x;
cin>>y; 
```

现在我想创建另一个程序，它需要两个数字并将它们相加，就像一个函数一样，除了一个单独的程序。

然后我想用从用户那里得到的数字从第一个程序运行第二个程序。IE：

```
#include<iostream>
using namespace std;
int main()
{
     int x,y;
     cin>>x;
     cin>>y;
     add(x,y); //this is how I would call a function named "add".  I want to know how to do that with a separate program instead of just a separate function.
     return 0;
} 
```

编辑：我想出了如何使用

```
(void)system("C:\\Program Files\\test.exe"); 
```

我将如何使用它来传递参数，以及如何编写一个接受这些参数的程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T00:17:01.707

我不确定你想做什么，但你可以通过多种方式在 Windows 中启动应用程序。最常见的“windows”方式是：

*   使用[ShellExecute](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)在 Windows 中启动程序。
*   如果需要取回返回值，可以改用[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425.aspx)。

听起来您想从源应用程序中获取 argc 和 argv 值，然后将这些值用作上述函数的参数来启动您的第二个应用程序。

您可以通过使用管道、套接字、文件甚至第二个程序的返回码以多种方式在进程之间进行通信。

您最好创建一个 DLL 以从您的第一个应用程序加载。DLL 可以做任何你想做的事情，并且可以直接将值返回给你，而无需额外的通信层。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T02:12:07.983

在大多数操作系统上，您可以在 system() 中通过空格分隔参数来传递参数：

```
system("someapp.exe 42 24"); 
```

当然，这个字符串可以由 sprintf 或 std::ostringstream 或你有的东西建立。

然后你只需要在另一个程序中处理你的参数：

```
int main(int argc, char **argv) {
  // important - make sure we have enough args
  if (argc != 3) { // first (zeroth) argument is always the program name, so 1+2 args is needed
    fprintf(stderr, "Wrong number of arguments\n");
    return EXIT_FAILURE;
  }
  int a = atoi(argv[1]);
  int b = atoi(argv[2]);
  // do stuff
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T00:10:36.200

你的问题有点不清楚。

您是否有机会寻找类似系统调用的东西？[http://en.wikipedia.org/wiki/System_(C_standard_library)](http://en.wikipedia.org/wiki/System_(C_standard_library))

使用*system*您可以调用任何可执行文件并将任意数量的命令行参数传递给该可执行文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T00:14:05.693

是的，有几种方法，如套接字、管道、rpc ... [http://en.wikipedia.org/wiki/Inter-process_communication](http://en.wikipedia.org/wiki/Inter-process_communication)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T00:17:17.090

不确定我是否理解这个问题，但您可以使用以下命令向 C/C++ 程序添加参数：

```
int main (int argc, char *argv[])
{
   if (argc == 1)

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T00:42:52.753

是的，singinanarchist 是在正确的轨道上。C++ 控制台应用程序以 call 开头`main( int argc, char* argv[] )`，它接受两个参数：

*   `argc`= 参数计数：输入参数的数量
*   `argv`= 参数向量：`char*`参数数组

因此，如果您将程序编译为`prog.exe`，并希望将其运行为

```
prog 12 23 
```

然后`argc`是 3，参数向量`argv`等价于

```
argv[0] = "prog" ; // (or "prog.exe")
argv[1] = "12" ;
argv[2] = "23" ; 
```

您可以在其中对输入参数执行您想要的操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T02:24:37.767

这是一个特定于 Windows 的解决方案，但您可能能够调用在另一个可执行文件中定义的函数。这通常是 DLL 的任务，但 EXE 和 DLL 无论如何都是相同的格式（有一些不同的标志，但它们都是可移植可执行文件 (PE) 格式），所以它应该可以工作。你必须做这样的事情：

调用者.cpp：

```
#include <windows.h>

// [...]

HMODULE moduleHandle = LoadLibrary("callee.exe"); // or .dll
int(*add)(int, int) = (int(*)(int, int))GetProcAddress(moduleHandle, "add");
int result = add(1, 1); 
```

被调用者.h：

```
// Not sure if dllexport will work for EXEs
__declspec(dllexport) int add(int a, int b); 
```

被调用者.cpp：

```
#include "callee.h"

int add(int a, int b) { return a + b; } 
```

免责声明：

*   未经测试（语法和逻辑）
*   没有错误检查/资源释放

**参考：**
[LoadLibrary](http://msdn.microsoft.com/en-us/library/ms684175.aspx)
[GetProcAddress](http://msdn.microsoft.com/en-us/library/ms683212.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-14T18:42:05.367

有几点需要解决：

1) 永远不要使用 system()。这是邪恶的（不是独立于平台的，安全漏洞等）。system() 假设目标计算机有一个命令解释器，它可能没有！

2）如果你想使用系统，这样做（假设你有一个称为args的参数向量，要调用的进程在一个名为proc的字符串中）

```
string final = proc;
final += " ";
for (int j = 0; j < args.size(); j++) {
  final += args[j];
  final += " ";    
}
system(final.c_str()); 
```

您可以通过假设目标 PC 有一个编译器（再次强调，不安全）并调用它（例如 g++ source.cpp）来进行编译。

3）使用管道。代码示例：

```
inline std::string exec_proc(const char* cmd) {
    std::array<char, 128> buffer;
    std::string result;
    std::shared_ptr<FILE> pipe(popen(cmd, "r"), pclose);
    if (!pipe) cout << "Launch failed, possible permission error" << endl;
    while (!feof(pipe.get())) {
        if (fgets(buffer.data(), 128, pipe.get()) != NULL)
            result += buffer.data();
    }
    return result;
} 
```

# c - 使用 GMP 的 bignum 的平方根

> ID：822734
> 
> 赞同：6
> 
> 时间：2009-05-05T00:10:26.357
> 
> 标签：c, bignum, gmp

我需要准确地得到一个 210 位数字的平方根，我认为 GMP 是适合这项工作的工具，我做错了什么？

```
#include <stdlib.h>
#include <stdio.h>
#include "gmp.h"

int
main (int argc, char *argv[])
{
  mpz_t sq_me, sq_out, test;
  mpz_init(sq_me);
  mpz_init(sq_out);
  mpz_init(test);
  mpz_set_str (sq_me, argv[1], 10);

  mpz_sqrt(sq_out, sq_me);
  mpz_mul(test,sq_out,sq_out);

  gmp_printf ("%Zd\n\n", sq_out);
  gmp_printf ("%Zd\n\n", test);

  return 0;
} 
```

### 输入：

> 24524664490027821197651766357308801846702678767833275974341445171506160083003858 72169522083993320715491036268271916798640797767232430056005920356312465612184658 17904100131859299619933817012149335034875870551067

### 输出：

> 49522383313031109809242226159886283348695660460381271324714928680654813093947239 9634016783775955618921028
> 
> 24524664490027821197651766357308801846702678767833275974341445171506160083003858 72169522083993320715491034366358025027526868495267716284867043049443779615862887 47102011391915422793532619329760963626718900576784

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T02:26:10.943

这是浮点平方根所需的代码，您可以看到初始输入和最终输出是相同的。

```
#include <stdlib.h>
#include <stdio.h>
#include "gmp.h"

int main (int argc, char *argv[]) {
    mpf_t sq_me, sq_out, test;
    mpf_set_default_prec (10000);
    mpf_init(sq_me);
    mpf_init(sq_out);
    mpf_init(test);
    mpf_set_str (sq_me, argv[1], 10);

    mpf_sqrt(sq_out, sq_me);
    mpf_mul(test,sq_out,sq_out);

    gmp_printf ("Input:       %Ff\n\n", sq_me);
    gmp_printf ("Square root: %.200Ff\n\n", sq_out);
    gmp_printf ("Re-squared:  %Ff\n\n", test);

    return 0;
} 
```

这是您的参数的输出：

```
Input:       2452466449002782119765176635730880184670267876783327597434144
51715061600830038587216952208399332071549103626827191679864079776723243005
60059203563124656121846581790410013185929961993381701214933503487587055106
7.000000

Square root: 4952238331303110980924222615988628334869566046038127132471492
86806548130939472399634016783775955618921028.19202568258368255653837168412
92356432661548614332014106174638951390596672950394981098992388116308833260
04535647648563996144250924277757344248059826024201642748515325655438898558
17807282091590722890002

Re-squared:  2452466449002782119765176635730880184670267876783327597434144
51715061600830038587216952208399332071549103626827191679864079776723243005
60059203563124656121846581790410013185929961993381701214933503487587055106
7.000000 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T00:14:25.770

你得到的结果是一个整数，然后平方。输入的数字不能是完美的平方，所以它会截断小数并降低数字的精度。查看浮点函数的“mpf”类别，而不是整数的“mpz”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-27T23:29:04.293

我正在使用 libgmp-3.dll

在 vb.net 中，我为高精度平方根编写了这个函数。我还没有彻底测试它，但它可以让我得到 3 的平方根，达到我需要的任何精度

```
 Public Shared Function SquareRoot(ByVal Value As BigInt, ByVal Precision As Integer) As String
    Dim Ten As New BigInt(10)
    Dim DecLen As Integer = Value.Sqrt.ToString.Length
    Dim RootDigits As String = (Value * Ten.Power(Precision * 2)).Sqrt

    'Add trailing zeros
    RootDigits = RootDigits.PadRight((DecLen + Precision), "0")
    Return RootDigits.Substring(0, DecLen) & "." & RootDigits.Substring(DecLen)
End Function 
```

# c# - .NET Regex 无法在代码中匹配，适用于每个测试工具

> ID：822737
> 
> 赞同：4
> 
> 时间：2009-05-05T00:11:25.853
> 
> 标签：c#, .net, regex

这对我来说是一个真正的头疼...

```
var matches = Regex.Matches("<p>test something<script language=\"javascript\">alert('hello');</script> and here's <b>bold</b> and <i>italic</i> and <a href=\"http://popw.com/\">link</a>.</p>", "</?(?!p|a|b|i)\b[^>]*>"); 
```

正则表达式应该捕获不是 p、a、b 或 i 的任何 HTML 标记（打开或关闭）。我已经将输入字符串和正则表达式插入到无数测试页面中，并且每个测试页面都返回脚本标记（打开和关闭）作为匹配项。但它在代码中绝对不起作用。匹配变量的计数为 0。

我错过了一些非常明显的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T00:16:03.533

您忘记转义模式字符串中的反斜杠。

```
"</?(?!p|a|b|i)\\b[^>]*>" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T01:32:23.460

`(?! )`是一个负前瞻。如果包含的模式与当前位置不匹配，则匹配零个字符。

`(?!p|a|b|i)\\b`将查看下一个字符以查看它是否匹配`p|a|b|i`。如果是这样，则前瞻将无法匹配任何内容。如果包含的模式匹配失败，则前瞻成功，并尝试从相同位置匹配模式中的下一个标记。在这种情况下是单词边界。

你想要的可能是这样的：

```
@"</?(?!(?:p|a|b|i)\b)\w+[^>]*>" 
```

它向前寻找匹配的东西`(?:p|a|b|i)\b`。如果该模式未能匹配，则前瞻成功，它将匹配至少一个单词字符，然后匹配任意数量的字符，直到结束`">"`。

# jsp - XQuery 作为 Web 服务的 JSP/Java 的替代品？

> ID：822738
> 
> 赞同：0
> 
> 时间：2009-05-05T00:12:18.193
> 
> 标签：jsp, web-applications, xquery

我注意到 DataLogic（或者是 MarkLogic？）和 SqlServer 2005 都支持用于 RDBMS 访问的 xquery 并且（似乎；我自己还没有尝试过）在 JSP/ASP 中提供 xquery。这让我想知道 java 代码是否会从表示层中消失。即 JSP/ASP 将只包含直接访问 DBMS 的 html 和 xquery 代码，没有通常的模型和控制器层。我想到的应用程序不需要/使用业务规则层，所以我并不担心。

有没有人试过这个？（顺便说一句，我知道 xquery 需要 java 才能工作；我更多地考虑减少程序员需要学习的语言数量才能让网络应用程序上线）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T05:35:13.587

另一种方法是使用存储 XML 数据的 XML 服务器，并使用 XQuery 在服务器端访问和传递结果（我在 MarkLogic 工作，我们制作了一个 XML 服务器，在这里尝试：http: [//developer.marklogic.com /下载/](http://developer.marklogic.com/download/) )

在此体系结构中，您有一个存储 XML 并执行 XQuery 的服务器。如果您提供 HTML 格式的结果，您现在有一个两层系统。当然，您可以使用 AJAX 直接从页面内访问 XML Server vis ReST。

这种架构的一种高级形式称为 XRX。有关更多信息，请参阅此帖子： [http ://www.oreillynet.com/xml/blog/2008/05/xrx_a_simple_elegant_disruptiv_1.html](http://www.oreillynet.com/xml/blog/2008/05/xrx_a_simple_elegant_disruptiv_1.html)

# c++ - 使用 C++ 和 Visual Studio 2008 设置 OpenGL

> ID：822750
> 
> 赞同：4
> 
> 时间：2009-05-05T00:18:14.997
> 
> 标签：c++, visual-studio-2008, opengl

嘿，我想知道是否有任何关于如何设置的好的教程？我已经看过 gamedev.net 上的 NeHe 教程，但其中一些似乎已经过时了……有什么线索吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T00:23:25.937

[NeHe](http://nehe.gamedev.net)可能有点老了，但肯定不会过时。与 DirectX 不同，OpenGL 很少更新。那里的教程仍然非常适合现代 OpenGL 编程。[第1 课](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=01)的 Visual C++ 代码几乎可以在任何非旧版本的 Visual Studio 中工作，并且大多数示例的代码可用于多种语言和平台。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-01-24T11:25:54.430

我认为这是一个很好的教程，一步一步，非常清楚库的路径：

[http://ins.nafsadh.com/2009/09/07/opengl-and-glut-in-c-with-ms-visual-studio-2008-msvs9/](http://ins.nafsadh.com/2009/09/07/opengl-and-glut-in-c-with-ms-visual-studio-2008-msvs9/)

另请查看我对类似问题的回答[。](https://stackoverflow.com/a/8985903/744859)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T18:10:23.360

您是否拥有 Visual Studio 2008 Professional 或“Express”版本之一？Express 版本需要 Windows 平台 SDK，因为它们不附带 OpenGL 头文件等。

此外，如果您要使用 GLUT，则需要单独下载。如果您需要更多信息，请告诉我们！

这是我在 Google 上找到的一个随机站点，解释了如何使其与 Express 版本一起使用。

[http://thoughtsfrommylife.com/article-748-OpenGL_and_Visual_Studio_Express_2008](http://thoughtsfrommylife.com/article-748-OpenGL_and_Visual_Studio_Express_2008)

编辑：我忘了提到明显的对立面——如果你有完整的 VS2008，OpenGL 就可以工作——不需要设置。如果您需要 GLUT，您仍然必须单独获取它。

# asp.net-mvc - ASP.NET MVC 中的多个表单

> ID：822751
> 
> 赞同：8
> 
> 时间：2009-05-05T00:18:19.053
> 
> 标签：asp.net-mvc, forms, post

**上下文**
假设我有：
在布局 Site.Master 中：

```
<div class="leftColumn">
    <asp:ContentPlaceHolder ID="MainContent" runat="server" />
</div>
<div class="rightColumn">
    <% Html.RenderPartial("_Login"); %>
    <asp:ContentPlaceHolder ID="SideContent" runat="server" />
</div> 
```

登录部分视图如下所示：

```
<form action="/myApp/Account/Login" method="post">
    <input name="name" />Name<br />
    <input name="password" type="password" />Password<br />
    <button>Login</button>
</form> 
```

是否可以只更新登录小部件表单，而不是整个内容页面？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T07:14:47.147

如果您指的是 http 帖子，则只有通过表单内的提交按钮启动的帖子（也可以由 javascript 启动）才会发布到服务器。

如果您的表单是嵌套的，那么这将不起作用。外部表单将始终发布到服务器。

在下面的示例 HTML 中，单击第一个表单上的提交按钮不会将值从第二个表单发送到服务器。同样，单击第二个提交按钮不会发布第一个表单中的值。

```
<html>
...
  <body> 
    <div>

      <form action="/Login/Login" method="post">
        <input type="text" name="username" value="" />
        <input type="text" name="passowrd" value="" />
        <input type="submit" name="login" value="Login" />
      </form>

      <form action="/Login/AdminLogin" method="post">
        <input type="text" name="username" value="" />
        <input type="text" name="passowrd" value="" />
        <input type="submit" name="login" value="Login Admin" />
      </form>
    </div>
</body>
</html> 
```

[如果您只想更新/更改表单部分之一，那么不使用 javascript 并执行 javascript 发布（又名Ajax](http://en.wikipedia.org/wiki/Ajax_(programming)) ）就无法做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-16T16:49:18.620

如果您构建一个接受 FormCollection 的控制器方法并且您的视图定义了两个表单，则返回的 formcollection 将使用表单 A 或表单 B 中的值填充。您可以检查 formCollection 并根据其中的值分支您的逻辑。如果您希望非常明确，您可以在两种形式中出现相同的隐藏变量，其值可以帮助您做出选择。

这是一种方法。我敢肯定，有几种方法可以解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-15T10:41:15.380

如果你有两种简单的形式，你可以使用这种方法：

您创建两个不同的局部视图。

```
@model CustomerInfoModel
@using (Ajax.BeginForm("CustomerInfo", "Customer", new AjaxOptions { HttpMethod = "Post", OnBegin = "InfoLoading", OnComplete = "InfoCompleted" }, new { id = "info", @class = "form-horizontal" }))
    {
    <input type="text" class="form-control" name="Name" id="Name" value="@Model.Name" />
    <input type="email" class="form-control" name="Email" id="Email"  value="@Model.Email" />
    <button type="submit" id="save-info" class="btn-medium red">Save</button>
    } 
```

和

```
@model CustomerPasswordChangeModel
@using (Ajax.BeginForm("CustomerPasswordChange", "Customer", new AjaxOptions { HttpMethod = "Post", OnBegin = "InfoLoading", OnComplete = "InfoCompleted" }, new { id = "change", @class = "form-horizontal" }))
{
<input type="password" class="form-control" name="OldPassword" id="OldPassword"  value="" />
<input type="password" class="form-control" name="NewPassword" id="NewPassword"  value="" />
<button type="submit" id="save-change" class="btn-medium red" autocomplete="off">Save</button>
} 
```

在你的父母看来，

```
@Html.Partial("CustomerInfo", Model.CustomerInfo) 
```

和

```
@Html.Partial("CustomerPasswordChange", Model.CustomerPasswordChange) 
```

在控制器中：

```
 [HttpPost]
    public ActionResult CustomerInfo([Bind(Include = "Name,Email")] CustomerInfoModel model)
    {
        if (ModelState.IsValid)
            return new Json(new { success=true, message="Updated.", errors=null);

// do you logic

        return new Json(new { success=false, message="", errors=getHtmlContent(ModelState.Values.SelectMany(v => v.Errors).ToList(), "ModelError"));
    }

    [HttpPost]
    public ActionResult CustomerPasswordChange([Bind(Include = "OldPassword,NewPassword")] CustomerPasswordChangeModel model)
    {
        if (ModelState.IsValid)
            return new Json(new { success=true, message="Updated.", errors=null);

// do you logic

        return new Json(new { success=false, message="", errors=getHtmlContent(ModelState.Values.SelectMany(v => v.Errors).ToList(), "ModelError"));
    } 
```

这将做你想做的事。

*注意：getHtmlContent 方法只是生成要在页面上显示的错误消息。没什么特别的。如果需要，我可以分享。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T00:38:16.103

```
if(pass != true) 
{ 
 ViewData["Message'] = "Hey your login failed!"; Return View("Login") 
} 
```

在 ViewPage 上

```
<form action="/tralala/Account/Login" method="post"> 
  <input name="name" />Name<br /> 
  <input name="password" type="password" />Password<br /> 

  <button>Login</button> 
 <div style="color: red"><%=ViewData["Message"] %><div> 
</form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T01:27:28.183

你的问题不是很清楚。

但据我所知，答案很可能是肯定的。您可以根据用户输入更新您想要的任何内容。

# haskell - 如果我已经知道 OCaml，我应该学习 Haskell 还是 F#？

> ID：822752
> 
> 赞同：24
> 
> 时间：2009-05-05T00:18:20.020
> 
> 标签：haskell, f#, ocaml, language-comparisons

我想知道我是否应该继续学习 OCaml 或切换到 F# 或 Haskell。

以下是我最感兴趣的标准：

*   **长寿**

    *   哪种语言会持续更长时间？我不想学习可能在几年内被用户和开发人员抛弃的东西。
    *   从长远来看，Inria、微软、格拉斯哥大学会继续支持各自的编译器吗？
*   **实用性**

    *   像[这样](http://flyingfrogblog.blogspot.com/2009/04/f-vs-ocaml-vs-haskell-hash-table.html)的文章让我害怕使用 Haskell。哈希表是快速检索的最佳结构。那里的 Haskell 支持者建议使用二叉树 Data.Map。
    *   除非好处很大，否则我不喜欢与庞大的 .NET 框架联系在一起。
    *   我希望能够开发的不仅仅是解析器和数学程序。
*   **精心设计**

    *   我喜欢我的语言保持一致。

请用合乎逻辑的论据和文章引用来支持你的观点。谢谢你。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-05T04:27:06.427

> 长寿

*   Haskell*实际上*是函数式编程研究的主要语言。Haskell 98 将以稳定的形式持续多年，而称为 Haskell 的东西可能会持续 10 到 30 年——尽管该语言将继续发展。社区对 Haskell 进行了重大投资，即使主要的 GHC 开发人员明天被公共汽车撞到（著名的“剑桥公共汽车错误”问题），也有很多其他人可以挺身而出。还有其他不太复杂的编译器。

*   Caml 由法国国家实验室 INRIA 的一个小组控制。他们也有很大的投入，其他的也有Caml的投入，而且代码是开源的，编译器也不太复杂，所以也会维护很久。我预测 Caml 将比 Haskell 稳定得多，因为 INRIA 的人们似乎不再将其用作探索新语言想法的工具（或者至少他们这样做的速度比过去要低）。

*   谁知道公司会做什么？如果 F# 成功，微软可以支持它 20 年。如果不成功，他们可能会在 2012 年拔掉插件。我猜不出来，也不会尝试。

> 实用性
> 
> > 哈希表是快速检索的最佳结构。那里的 Haskell 支持者建议使用二叉树 Data.Map。

这取决于您要搜索的内容。当您的键是字符串时，[三元搜索树](http://www.cs.princeton.edu/~rs/strings/)通常比哈希表更快。当您的键是整数时，Okasaki 和 Gill 的[二叉 Patricia 树](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.37.5452)可以与散列竞争。如果你真的想要，你可以使用 IO monad 在 Haskell 中构建一个哈希表，但很少需要这样做。

我认为惰性评估总会有性能损失。但“实用”不等于“尽可能快”。以下关于性能的说法是正确的：

*   最容易预测 Caml 程序的时间和空间行为。

*   F# 在中间（谁真正知道 .NET 和 JIT 会做什么？）。

*   最难预测 Haskell 程序的时间和空间行为。

*   Haskell 拥有最好的分析工具，从长远来看，这是产生最佳性能的原因。

> 我希望能够开发的不仅仅是解析器和数学程序。

要了解 Haskell 的功能范围，请查看xmonad[窗口](http://xmonad.org)管理器[和](http://hackage.haskell.org)[`hackage.haskell.org`](http://hackage.haskell.org).

> 除非好处很大，否则我不喜欢与庞大的 .NET 框架联系在一起。

我无法评论：

> 精心设计
> 
> > 我喜欢我的语言保持一致。

评估一致性的几点：

*   Haskell 的具体语法设计得非常好；Haskell 委员会的出色工作给我留下了深刻的印象。OCaml 语法还可以，但相比之下会受到影响。F# 从 Caml 核心语法开始，有很多相似之处。

*   Haskell 和 OCaml 都有关于运算符重载的非常一致的故事。Haskell 具有一致且强大的机制，您可以自行扩展。OCaml 没有任何类型的重载。

*   OCaml 具有最简单的类型系统，特别是如果您不编写对象和函子（许多 Caml 程序员不这样做，尽管在编写 ML 时不编写函子对我来说似乎很疯狂）。Haskell 的类型系统雄心勃勃且功能强大，但它在不断改进，这意味着由于历史原因存在一些不一致之处。F# 本质上使用 .NET 类型系统，以及类似 ML 的 Hindley-Milner 多态性（请参阅问题[“什么是 Hindley-Milner”](https://stackoverflow.com/questions/399312/what-is-hindley-milner)。）

*   OCaml 在它认为变体应该是静态类型还是动态类型方面并不太一致，因此它同时提供了（“代数数据类型”和“多态变体”）。由此产生的语言具有很强的表达能力，这对专家来说非常有用，但对于业余爱好者来说，使用哪种结构并不总是显而易见的。

*   OCaml 的评估顺序是官方未定义的，这在具有副作用的语言中是一个糟糕的设计选择。更糟糕的是，实现是不一致的：字节编码的虚拟机使用一种顺序，而本机代码编译器使用另一种。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-06T00:59:35.747

> 如果你知道 OCaml，你应该学习 F# 还是 Haskell？

我相信答案肯定是肯定的，理想情况下你应该学习所有这三种语言，因为每种语言都有一些东西可以提供，但 F# 是唯一一种前途光明的语言，所以，如果你只能学习一种语言，请通过阅读我的[Visual F# 来学习 F# 2010 年获得技术计算书籍](http://www.ffconsultancy.com/products/fsharp_for_technical_computing/?so)或订阅我们[的 F#.NET 期刊](http://www.ffconsultancy.com/products/fsharp_journal/?so)。

**长寿**

微软在四月份将 F# 作为 Visual Studio 2010 的一部分发布时承诺支持它。因此，F# 至少在几年内保证了美好的未来。凭借强大的实用功能组合，如高性能本机代码 REPL、.NET 4 内置的高级并行结构和生产质量的 IDE 模式，F#*远远*领先于任何其他函数式编程现在就现实世界的适用性而言的语言。坦率地说，在不久的将来，甚至没有人在研究任何可能与 F# 竞争的东西。我自己的开源[HLVM](http://www.ffconsultancy.com/ocaml/hlvm/?so)项目正在尝试这样做，但还远远没有准备好。

相比之下，OCaml 和 Haskell 的开发方向都非常低效。这已经扼杀了 OCaml 好几年了，我希望 Haskell 在接下来的几年里也会效仿。大多数以前的专业 OCaml 和 Haskell 程序员已经转向 F#（例如 Credit Suisse、Flying Frog Consultancy），而其余的大多数人无疑会在不久的将来迁移到更实用的替代方案，例如 Clojure 和 Scala。

具体来说，OCaml 的 QPL 许可证可以防止其他任何人修复其越来越多的基本设计缺陷（32 位机器上的 16Mb 字符串和数组限制、没有共享内存并行性、没有值类型、通过类型擦除的参数多态性、解释性 REPL、繁琐的 FFI等），因为他们必须*仅以*补丁的形式分发衍生作品到原始作品，并且 Debian 软件包维护者拒绝承认上游的替代品。添加到该语言中的新功能，例如 OCaml 3.12 中的一流模块，远没有多核功能那么有价值。

一些项目开始试图拯救 OCaml，但事实证明它们太少太晚了。[并行 GC](http://groups.google.com/group/fa.caml/msg/735752c0a7a0ba4c)几乎没用，David Teller 退出了[包含电池](http://batteries.forge.ocamlcore.org/)的项目（尽管它已被捡起并以缩减的形式发布）。因此，OCaml 已经从[2007 年最流行的函数式语言](http://ocamlnews.blogspot.com/2007/11/most-popular-functional-languages-on.html)变成了今天的严重衰退，[caml-list 的流量自 2007 年以来下降了 50% 以上](http://groups.google.co.uk/group/fa.caml/about?hl=en)。

Haskell 的工业用户比 OCaml 少，虽然它确实支持多核，但它仍在朝着一个非常低效的方向发展。Haskell 几乎完全由剑桥（英国）微软研究院的两个人开发。尽管纯粹的函数式编程在设计上不利于性能，但他们仍在继续尝试开发针对多核的并行 Haskell 解决方案，因为它所招致的大量不必要的复制撞到了内存墙并破坏了在一个可扩展并行性上的任何希望多核。

业界唯一的 Haskell 主要用户是[Galois](http://www.galois.com/)，拥有大约 30 名全职 Haskell 程序员。我怀疑他们会让 Haskell 彻底死掉，但这并不意味着他们会把它发展成一种更普遍有用的语言。

**实用性**

我写了你引用的关于哈希表的文章。它们是一个很好的数据结构。其他人提到了诸如三叉树和帕特里夏树之类的纯功能替代方案，但在实践中这些通常比哈希表慢约 10 倍。原因很简单，缓存未命中在当今的性能问题中占主导地位，并且树会导致额外的 O(log n) 指针间接寻址。

我个人偏爱可选的惰性和可选的纯度，因为两者在现实世界中通常会适得其反（例如，惰性使性能和内存消耗变得不可预测，而纯度严重降低了平均情况下的性能，并使互操作性成为一场噩梦）。我是仅有的通过我自己的公司完全靠函数式编程谋生的人之一。可以说，如果我认为 Haskell 是可行的，我会在几年前进行多元化投资，但我一直选择不这样做，因为我不相信它在商业上是可行的。

你说“我不喜欢被捆绑到一个庞大的 .NET 框架，除非好处很大”。好处是巨大的。您将获得一个生产质量的 IDE，一个生产质量的 JIT 编译器，它执行非常有效的优化，如类型专用泛型，生产质量的库，适用于从 GUI 编程（参见[32 行 F# 中的 Game of Life](http://fsharpnews.blogspot.com/2010/02/john-conways-game-of-life-in-32-lines.html)）到数字运算的所有内容。但 .NET 的真正好处，至少对我而言，是你可以出售你用 F# 编写的库并赚很多钱。没有人成功地向 OCaml 和 Haskell 程序员销售库（我是少数尝试过的人之一），但 F# 库已经大量销售。因此，如果您想通过编写软件谋生，那么庞大的 .NET 框架非常值得。

**精心设计**

这些语言都经过精心设计，但用途不同。OCaml 是专门为编写定理证明器而设计的，而 Haskell 是专门为研究 Haskell 而设计的。F# 旨在解决 OCaml 和 Haskell 的所有最严重的实际问题，例如互操作性差、缺乏并发垃圾收集以及缺乏像 WPF 这样的成熟现代库，以便为广大受众带来高效的现代语言。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-05T23:37:39.547

这不是您的标准之一，但您是否考虑过**工作机会**？Haskell 目前确实列出了 144 个工作，Ocaml 列表 12 和 C# 列表 26,000。这些数字并不完美，但我敢打赌，一旦 F# 发布，它的工作列表数量很快就会超过 Haskell 和 Ocaml。

到目前为止，Visual Studios 中包含的每种编程语言都有数以千计的工作列表。在我看来，如果你想要最好的机会使用函数式编程语言作为你的日常工作，那么 F# 很快就会出现。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-05-05T02:30:40.200

> 长寿

没有人能预知未来，但

*   OCaml 和 Haskell 多年来一直很好地生存，这对他们的未来来说是个好兆头
*   当 F# 附带 VS2010 时，MS 将有法律义务支持它至少 5 年

> 实用性

Perf：我对 Haskell 没有足够的第一手经验，但是基于二手和三手信息，我认为 OCaml 或 F# 更实用，从某种意义上说我认为你不太可能能够在 Haskell 中获得与在 F# 的 OCaml 中相同的运行时性能。

库：轻松访问 .Net Framework 是 F# 的一大优势。如果您愿意，您可以将其视为“与这个庞大的东西捆绑在一起”，但不要忘记“您可以访问一个庞大的、包含通常非常有用的东西的庞大库”。与 .Net 的“连接性”是 F# 的一大卖点。F# 更年轻，因此第三方库较少，但除了 .Net 上的“盒中”库之外，已经有[FsCheck](http://fscheck.codeplex.com/)、[FParsec](http://www.quanttec.com/fparsec/)、[Fake](http://code.google.com/p/fake/)和一堆其他库。

工具：我没有足够的个人经验来比较，但我认为 VS 与 F# 的集成优于你今天为 OCaml/Haskell 找到的任何东西（并且 F# 将在明年继续改进）。

更改：F# 在接近 VS2010 中的第一个受支持版本时仍在更改，因此在不久的将来您可能不得不忍受对语言/库的一些重大更改。

> 精心设计

Haskell 绝对是美丽和一致的。我不太了解 OCaml，但我的直觉是它同样具有吸引力。我认为 F# 比其中任何一个都“更大”，这意味着更多尘土飞扬的角落和不一致（主要是由于调解 FP 和 .Net 之间的阻抗不匹配），但总体而言 F# 对我来说仍然感觉“干净”，而且确实存在的不一致至少是有充分理由/有意的。

> 总体

在我看来，你会很好地了解这三种语言中的任何一种。如果你知道一个你想要使用它的大型长期项目，一个可能会脱颖而出，但我认为许多技能将是可以转移的（在 F# 和 OCaml 之间比在 Haskell 之间更容易转移，但在任何技能中也更容易转移）这三个比使用Java）。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-05T01:00:41.587

这个问题没有简单的答案，但这里有一些事情需要考虑：

Haskell 和 OCaml 都是具有强大实现的成熟语言。实际上，Haskell 有多种很好的实现，但我认为这对你的目的来说并不是一个重点。

F# 更年轻，谁能预测微软将决定把它带到哪里？你对此的感受更多地取决于你对微软的感受，而不是任何人能告诉你的关于编程语言的任何事情。

OCaml（或一般的 ML）是一种很好的实用语言选择，它支持做很酷的功能性东西，而不会强迫您以可能不舒服的方式工作。您可以充分利用代数数据类型、模式匹配、类型推断以及其他所有人最喜欢的东西。哦，还有对象。

Haskell 为您提供了所有这些（几乎除了对象），但也或多或少地迫使您重新思考您认为自己对编程了解的一切。如果您想学习新的东西，这可能是一件非常好的事情，但它可能比您想要的更多。我这样说是作为一个在成为一名高效、快乐的 Haskell 程序员的道路上可能只走了一半的人。

OCaml 和 Haskell 都被用于编写许多不同类型的程序，而不仅仅是编译器和 AI 等。谷歌是你的朋友。

最后一点：OCaml 为您提供哈希表，但如果您真的想接受函数式编程，在代码中使用它几乎不明智。持久化树（如 Data.Map）确实是 Haskell 的正确解决方案，并且具有许多不错的属性，这是您学习 Haskell 时要了解的很酷的事情之一。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-05T00:25:52.200

F# 和 OCaml 在语法上非常相似，但显然 F# 更适合 .NET。

您学习或使用哪一个应该取决于您的目标平台。

在 VS2010 中将包含 F#，由于它编译为 .NET 字节码，因此可以在支持您使用的 .NET 版本的 Windows 操作系统上使用。这会给你一个很大的区域，但是有一些限制，目前 F# 是 OCaml 没有的，因为 F# 似乎没有利用机器上的所有处理器，但是，这可能是由于 F# 仍在开发中，这可能是一个不那么重要的功能。

还有其他函数式语言，例如 Erlang，你可以看看，但是，基本上，如果你精通一种 FP 语言，那么你应该能够相当快地学会另一种语言，所以，只需选择一种你喜欢的并尝试在其中开发有趣且具有挑战性的应用程序。

最终，语言编写者会找到一种方法让 OO 语言在多核上很好地工作，而 FP 可能会再次被淘汰，但是，这似乎不会很快发生。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-13T08:10:55.790

这与 OP 关于是否学习 F# 的问题没有直接关系，而是在金融领域的真实世界 OCaml 使用示例：http: [//ocaml.janestreet.com/ ?q=node/61](http://ocaml.janestreet.com/?q=node/61)

很有趣的谈话。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-16T13:44:31.750

就寿命而言，很难判断语言的受欢迎程度，但只是在这里快速检查一下，这些是用适当（功能）语言标记的问题数量：-

2672 Scala，1936 Haskell，1674 F#，1126 Clojure，709 Scheme，332 OCaml

我想说这很好地表明了人们目前正在积极学习哪些语言，因此可能很好地表明了哪些语言在未来几年可能会流行。

# sql - SQL在组中查找重复的外键

> ID：822753
> 
> 赞同：3
> 
> 时间：2009-05-05T00:18:27.553
> 
> 标签：sql, postgresql

基本上像这样的表：

```
Elements
  id INT PRIMARY KEY
  ...

Observations
  id INT PRIMARY KEY
  ...

Data
  id INT PRIMARY KEY
  observation_id FOREIGN KEY
  element_id FOREIGN KEY
  value FLOAT
  ... 
```

我想找到所有在单个`observation_id`s 中有重复s 的 s 。例如，如果我有如下记录：`element_id``observation_id``Data`

```
1|50|23|4.5
2|50|24|9.9
3|66|23|4.4
4|66|23|4.1 
```

然后查询将报告`observation_id` `66`，因为它有两个关联的行`element_id` `23`。

（我使用的是 PostgreSQL，但这可能是一个基本的 SQL 问题。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T00:22:39.337

将 count() 聚合与“have”子句结合使用：

```
选择观察ID，元素ID，计数（*）
从数据
按观察 ID、元素 ID 分组
计数（*）> 1

```

# svn - 用分支重新组织 subversion 存储库

> ID：822754
> 
> 赞同：2
> 
> 时间：2009-05-05T00:18:27.633
> 
> 标签：svn, merge, branch, reorganize

我正在尝试重新组织具有分支的 subversion 1.6 存储库。看来，如果您在主干中移动文件并且该文件在分支中有更改，那么当这些更改合并到分支中时，它们不再存在。

我将尝试在下面进行说明：

```
1\. Repo before move
    trunk/a.txt
    trunk/b.txt
    branches/feature/a.txt
    branches/feature/b.txt

2\. File branches/feature/b.txt is changed.

3\. Repo reorganized
    trunk/a.txt
    trunk/new-location/b.txt
    branches/feature/a.txt
    branches/feature/b.txt

4\. Changes from trunk merged to feature
    trunk/a.txt
    trunk/new-location/b.txt
    branches/feature/a.txt
    branches/feature/new-location/b.txt 
```

文件夹**branch/feature**是**trunk**的副本。

完成第 4 步后，功能分支对文件 b.txt 的所有更改都不再存在。

我认为这是在 svn 1.5 中修复的？

如果这不是一个选项，我仍然需要以某种方式重组我的整个存储库。当分支全部合并到主干时进行移动不是一种选择。我总是在任何时候至少有 1 个分支和主干。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:01:12.810

合并移动的文件是一个[已知问题](http://subversion.tigris.org/issues/show_bug.cgi?id=898)。但是，如果 subversion[没有找到合并目标](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.advanced.html#svn.branchmerge.advanced.mergeconflicts)，它会通过此消息警告您：

> **跳过丢失的目标：'baz.c'**

如果您看到此消息，您可能需要采取手动操作。如果文件被移动并且新位置应该接收更改，那么您可以考虑在重命名的实体之间进行子树合并。

~~我不知道有任何版本控制系统会自动进行此类合并。~~ **编辑**：看起来像在[mercurial](http://www.selenic.com/mercurial/wiki/)中，这样的[合并*确实*遵循副本](http://hgbook.red-bean.com/read/mercurial-in-daily-use.html#chap:daily.copy)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T00:44:49.580

提供步骤 3 和 4 的详细信息。Subversion 合并与副本不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T01:39:09.373

您需要确保在步骤 3 中使用 SVN 重命名方法，以确保文件位置与未来的更改保持关联。

（我将这个从...中拉出来……好吧，我不确定以下内容）移动/重命名文件时存在祖先问题。确保在合并时未选择忽略祖先选项。

# asp.net - 对 COM 组件的调用已返回错误 HRESULT E_FAIL

> ID：822766
> 
> 赞同：4
> 
> 时间：2009-05-05T00:25:57.350
> 
> 标签：asp.net, wcf

我不知道这个“错误 HRESULT E_FAIL 已从对 COM 组件的调用中返回。”是怎么回事。各位知道怎么回事吗？我的 wcf 服务运行良好，但今天我收到此错误。我在谷歌上搜索但找不到答案。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T00:43:22.003

E_FAIL 是一个通用的未知错误。没有更具体的信息。

我不会搜索 E_FAIL，而是搜索对您正在使用的某些 COM 组件更具体的支持，特别是如果您能找到它，具体是哪个实际返回了此错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-29T11:24:39.830

这些是通用 vs 控件，我页面中的任何内容/所有内容都给出了相同的错误。即使在 vs 中创建了一个全新的站点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-18T09:47:53.477

可能与此有关： [Some sharepoint-blog](http://sriramkunapuli.com/2012/04/30/sharepoint-search-cant-crawl-sharepoint-site-error-hresult-e_fail-has-been-returned-from-a-call-to-a-com-component/)

那就是 - 更改为

```
 <configuration>
        <system.web>
            <identity impersonate="true" />
        </system.web>
    </configuration> 
```

在 web.config 中可能会起作用。不过，请调查其他可能的后果。

# java - Java菜鸟的陷阱是什么？

> ID：822768
> 
> 赞同：23
> 
> 时间：2009-05-05T00:27:07.643
> 
> 标签：java

我已经完成了一些关于 SO 的 Java 问题。而且我必须说这里的内容[写得很好](https://stackoverflow.com/questions/457822/what-are-the-things-java-got-right)，SO 上的 Java 人员真的可以给出答案。

但我总是找到 Java 人的 Java 答案。这本身就很棒，但我是一个 Java 菜鸟。所以我并不真正关心[“类型参数变化中的联合联合”](https://stackoverflow.com/questions/15496/hidden-features-of-java/42686#42686)的工作原理。它可能很方便，但现在......它不是。

那么对于菜鸟（来自 PHP 和 Python）的 Java，作弊码是什么？

如果您可以链接到一个 SO 答案（可能在那里但我找不到）或写出 Java 与其他语言的不同之处是什么？（在基本层面上）

有些人可能会称这些为 Java Gotchas（虽然我找不到官方的）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-05T00:34:26.673

有一组半官方的“陷阱”，称为 Java Puzzlers，并记录在[同名的书中](http://www.amazon.co.uk/Java-Puzzlers-Traps-Pitfalls-Corner/dp/032133678X/ref=sr_1_1?ie=UTF8&s=books&qid=1241483349&sr=8-1)；您可能还会在网络上找到一些截屏视频。定期地，Joshua Bloch 和 Neal Gafter 喜欢提出一堆看似无害的挑战，并继续系统地消除您对 Java 语言最模糊基础知识的任何概念。

在稍微不那么愤世嫉俗的情况下，如果您想避免许多常见的设计和实现错误，您可以看看前面提到的 Joshua Bloch 撰写的[Effective Java](http://www.amazon.co.uk/Effective-Java-Second-Joshua-Bloch/dp/0321356683/ref=sr_1_1?ie=UTF8&s=books&qid=1241483503&sr=1-1)，它对如何实现着手设计用 Java 编写组件的几个重要但经常写得不好的方面，包括全面解释如何正确实现 and 的契约`equals()`，`hashCode()`以及为什么应该`clone()`像瘟疫一样避免。

哦，不要将字符串与`==`运算符进行比较。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T01:21:02.723

说对象是通过引用传递的。

实际上，方法仅适用于按值传递的对象引用的副本。

[**Java 仅适用于按值传递。**](http://www.javaranch.com/campfire/StoryPassBy.jsp)

还值得一读：[Is-java-pass-by-reference？](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-05T00:45:58.067

一个小问题：在 Google 上搜索一个 Java 类并期望找到最新的信息。建议：始终包括版本号，即搜索“inputstream 6”而不是“inputstream”。同样，请注意网络上的教程，其中很多都是过时的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-05T00:55:09.977

书签 javadocs：http: [//java.sun.com/javase/6/docs/api/index.html](http://java.sun.com/javase/6/docs/api/index.html)

更好的是，在本地安装它们并在本地机器上为页面添加书签，以便更快地查找和离线浏览。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-05T18:46:24.647

我认为另一个常见的初学者陷阱是*重新发明轮子*。也就是说，当库已经提供（可能更好）实现时，自己编写一些（低级）算法、数据结构或实用程序。

有关这一点的详细说明，请阅读 Joshua Bloch 的*Effective Java*（第 2 版）中的第 47 条：**了解和使用库**。（阅读整本书，同时阅读！;-) 我将引用他给出的一些主要建议：

> 通过使用标准库，您可以利用编写它的专家以及在您之前使用它的人的经验。
> 
> [...] 每个程序员都应该熟悉 , 的内容`java.lang`， `java.util`并且在较小程度上 熟悉`java.io`.

具体来说，Java Collections [Framework](http://java.sun.com/docs/books/tutorial/collections/index.html)`java.util`对任何 Java 程序员（无论是否是新手）都非常有用；正如 Bloch 所说，它肯定“在提高性能的同时减少了编程工作量”。

除了 Java 平台本身附带的库之外，值得一提的 Java 库系列是[Apache Commons](http://commons.apache.org/)。它涵盖*了很多*领域，被广泛使用，并且经常在标准库停止的地方继续存在。另外，虽然我自己还没有使用过，但似乎 Google 最近推出了一些补充 Java 平台的优质 Java 库，例如[Google Collections](http://code.google.com/p/google-collections/)（[关于它的有趣文章](http://www.javalobby.org/articles/google-collections/)）。**编辑**: 现在我对 Google Collections 有了更深入的了解，我可以说这个库在学习 Java Collections 框架后绝对值得研究；这似乎是一个完美的扩展！从我链接到的 Javalobby 文章开始，并查看主要开发人员 Kevin Bourrillion 的此演示文稿：[第 1](http://www.youtube.com/watch?v=ZeO_J2OcHYM)部分和[第 2 部分](http://www.youtube.com/watch?v=9ni_KEkHfto)。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-05-05T00:38:09.037

`int`标量类型和装箱类型之间的差异`Integer`对于 Java 新手来说是令人惊讶的。

Java 一直对不是类的“标量”类型进行区分：（`boolean`真/假）、`char`（无符号 16 位）、`short`（有符号 16 位）、`int`（有符号 32 位）和`long`（有符号 64-少量）; 以及其他所有属于类并最终从`Object`该类派生的东西。

当您想使用像`List`. A`List`可以包含从 派生的任何内容`Object`，但*不能*包含标量值。因此，为了将`int`值存储到 中`List`，您需要将它们包装到`Integer`派生自的类的实例中`Object`。

在旧版本的 Java 中，您还需要`Integer`使用`.intValue()`方法调用显式地从类中获取值。在较新版本的 Java 中，这种转换称为“拆箱”，在某些情况下是自动的。

Sun 有一个[关于自动装箱的简短页面，](http://java.sun.com/j2se/1.5.0/docs/guide/language/autoboxing.html)该页面面向更有经验的程序员，但可能会提供信息。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-05-05T06:11:24.663

我认为最好的“作弊代码”是“不要聪明，写愚蠢的代码”。

这些术语有些负担，但基本上你希望在编写它们时让事情变得简单，因为这样当你稍后再回来时它们会很容易阅读。此外，如今 JVM 比您聪明得多，非愚蠢代码通常会尝试“更有效”地做一些事情，这可能会阻止 JVM 做一些更聪明的事情。

看看[http://java.sun.com/developer/technicalArticles/Interviews/devinsight_1/](http://java.sun.com/developer/technicalArticles/Interviews/devinsight_1/)

请注意：编写智能代码是可以的，您只需要先证明它是必要的 :)

* * *

编辑：还有一些事情。

*   写很多代码。熟能生巧 - 始终努力以最好的方式做到这一点。如果你稍后再回到你的代码，你可能已经学到了一两件事，因为这让你可以看到你之前的选择，让你在下次必须做出选择时做出更好的决定。*这包括文件*！文档允许其他人使用您的代码而无需详细了解它。

*   阅读大量代码。设置您的 IDE，以便您可以看到尽可能多的源代码。通过在 Eclipse 中使用 JDK 作为 JVM，源代码会自动附加，因此您可以查看源代码，了解您碰巧在断点中遇到的任何问题。在您的代码中包含来自例如 Apache 的 jar 时，请包含源代码，以便您可以看到它的作用。有一天，它会帮助你弄清楚为什么会发生某件事以及如何避免它。

*   与同行一起工作。其他处于类似水平的程序员可能会为某种情况提供输入——甚至他们只是听你的解释就能澄清你的想法——你也可以帮助他们。通过一起工作和一起评估，你可以互相利用。

*   Sun 的 Java 教程涵盖了很多 Java 库，学习那些涵盖运行时基本部分（java.lang、java.io）的内容并阅读其余部分（只是为了知道存在什么）将使您成为更熟练的程序员。你会知道你的工具箱里有什么！

*   参与堆栈溢出。为问题写出好的答案（即使它们已经得到了答案但很糟糕）将使您能够将您的经验转化为文字，这是编写文档的练习:)

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-05-05T10:35:13.890

考虑在您的代码上运行[FindBugs （](http://findbugs.sourceforge.net/)[作为 Eclipse 插件提供](http://findbugs.sourceforge.net/downloads.html)）。它可以标记许多常见错误。随着检查工具的发展，我认为它对初学者来说是一个很好的工具，因为它不会挑剔无关紧要的细节。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-05-05T00:55:04.597

这可能有点太基本的建议，所以如果我因为提出它而冒犯你，请原谅我，但我已经看到太多开始的 Java 代码`static`自由地抛出关键字，似乎不考虑它的用途。因此，如果您看到警告抱怨“对非静态值的静态引用”或类似的事情，请不要尝试通过随机放置`static`其他非静态事物来解决它，除非这样做有意义。

这是一个小技巧，在您知道它的术语之前，您可能很难搜索它：“package-private”。在 Java 中，存在与 C++ 等其他地方相同的公共、受保护和私有作用域。如果您还不知道，您可以阅读它们的用途。但是请注意，如果您不指定某事物是公共的、受保护的还是私有的，那么这些都不是。它是包私有的，除了缺少关键字外，没有指定它的关键字。包私有的东西对另一个包中的任何东西都是私有的，对同一个包中的东西是公共的。

另一个随机提示：使用包。您的 .java 文件可以不以`package com.whatever.foo;`一行开头，如果您使用命令行 javac，您会发现缺少该行的文件显示在您的工作目录中很好，但它几乎总是会结束以后很痛苦。无论如何都要停止使用命令行 javac。使用 Eclipse。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-05-05T03:04:02.837

如果您已经熟悉命令式 C 风格语言，Java 是一门非常简单的语言。深层问题与语言无关，但更广泛地与静态（和强）类型、单继承、OO 语言相关。

我在这里也谦虚地不同意我的 Java 兄弟，并建议您使用文本编辑器和命令行来学习基础知识。那是 JVM 的特定问题最为突出。

请记住 Java 和其他语言之间最重要的区别：Java 既是一种语言又是一种平台。

您需要了解类路径的概念；逻辑包结构与其在文件系统中的（类似）体现之间的关系。

在命令行中键入“java”、“javac”等会做什么？学习基础知识。

IDE 将彻底解决 Java*平台的这些**基本*问题。

 *如果您愿意，我还建议您阅读 Java 语言规范和（是的）JVM 规范。如果精通是您追求的目标，请确保在开始 Java 之旅时了解类加载器和相关问题。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-05-05T00:32:46.833

总有：

```
String a = "wow, not the same";
String b = "wow, not the same";
String c = new String("wow, not the same");
if (a == b) { //happens to evaluate to true, but you shouldn't do this
    ...
}
if (a == c) { //evaluates to false, which is why you shouldn't do it
    ...
}

//This is how you *should* do this
if (a.equals(b)) { //evaluates to true
    ...
}
if (a.equals(c)) { //evaluates to true
    ...
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-05-05T00:44:33.950

使用[Eclipse](http://www.eclipse.org)进行 Java 编辑/开发/调试。或者其他一些 IDE，但看在上帝的份上，不要使用记事本和命令行。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-05-05T06:48:34.997

注册到[JavaBlackBelt](http://www.javablackbelt.org/)并开始在那里进行测试。正如您从浏览首页快速看到的那样，它们几乎涵盖了从最简单的事情到令人难以置信的高级主题的所有内容。

并且不要为未能通过任何测试而感到羞耻，失败只是告诉您在继续之前应该了解更多信息:)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-05-05T08:53:52.823

我见过一些有编程经验但没有 Java 经验的人犯的一些错误：

1.  类隐式扩展`Object`
2.  类隐式导入`java.lang.*`
3.  instanceof 不需要非空检查
4.  向上转型，例如`((Object)new Integer(1)).toString()`，几乎从来没有用过，因为它不会影响动态方法选择
5.  字符串是不可变的。无需复制或克隆它们。
6.  不要依赖垃圾收集器或`finalize()`执行资源（而不是内存）管理。资源，例如文件，应该明确关闭。
7.  Swing 组件一旦显示，就只能从 AWT 事件线程（通常使用`SwingUtilities.invokeLater()`）访问。
8.  一般来说，当多个线程共享相同的可变/有状态对象时，要非常非常小心。要么先复制你的对象，要么准备使用大量的`synchronized`块，`wait()`然后`notify()`.

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2009-05-05T17:52:11.657

**痴迷于设计模式！**一开始我不会太担心设计模式。如果您知道它们的存在是很好的，这样您就会知道团队中的其他成员在谈论什么，但现在重要的是探索核心 Java API。当您对它们感到满意时，我真的会努力学习如何编写干净和自记录的代码。这将为您节省大量的时间和精力，以便您在将来返回并需要记住您在做什么时。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-05-05T18:05:00.080

静态决赛可以融入班级。

IE

```
public class Foo {
  public static final String A_STRING="A_STRING";
}

public class Bar { 
  public void printString() { System.out.println(Foo.A_STRING);}
} 
```

现在编译两者，然后更改“Foo”并重新编译 Foo 但*不是*Bar。Bar 仍会打印出 A_STRING 的旧值。要亲自体验这一点，请在 eclipse 中本地运行，它会默默地重新编译所有类，然后在服务器上进行增量更新。嘿，我的零钱去哪儿了？

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-05-05T00:41:50.540

*Java 与其他语言有哪些不同之处？（在基本层面上）*

在基本层面上，它与其他 OOP 语言没有什么不同。然而，与普通的程序编程相比，它是一个全新的世界……或者说是一个进化的世界。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-05-05T01:22:59.473

我不得不说。

最常见的新手陷阱短语之一，例如“方法的参数总是作为引用传递，因为对象变量是引用，对吗？”

所以当你看到类似的东西时：

```
public void foo(String str){
      str="yeah, this should work!";
}

String str = "";
foo (str);

System.out.println(str); 
```

你可以听到“等等，WTF！” 来自菜鸟。

根据我的经验，java 新手不知道 StringBuffer / StringBuilder。不可变对象也不行。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-05-05T01:12:06.973

另一个陷阱：认为调试器就是调试器，并使用 Eclipse 调试器而不花时间学习它。

既然您说您使用的是 Eclipse，这里有一系列关于调试器的 7 个优秀视频[教程](http://eclipsetutorial.sourceforge.net/debugger.html)。我强烈建议花时间（7*15 分钟）观看它们。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-05-05T11:44:33.443

避免比你需要的更具体。你可能会想把你的存储对象想象成一个 HashMap：

```
HashMap myStore = new HashMap(); 
```

但我建议仅将其视为 Map（界面）：

```
Map myStore = new Hashtable(); 
```

您的其余代码不需要知道我们如何实现 myStore，它只需要知道 myStore 是某种 Map。这样我们以后可以更改实现类型（HashMap,Hashtable,...），只影响一行代码。

我选择 Hashtable 作为示例，而不是 HashMap，因为 Hashtable 是线程安全的。在多线程应用程序中，这避免了两个线程同时读取和更改同一个 HashMap 会开始抛出异常的问题。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-08-17T23:44:41.943

确保您了解 OOP，而不是让一切都变得静态。并了解堆栈溢出以提出问题:-)。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-08-18T00:16:15.683

结合`equals()`自动装箱会变得非常疯狂：

```
Integer X = 9000;
Integer Z = 9000;
short y = 9000;
boolean b1 = (X == Z);  
boolean b2 = (X == y);    
boolean b3 = (X.equals(Z));
boolean b4 = (X.equals(y));
System.out.println(b1 + " " + b2 + " " + b3 + " " + b4); 
```

输出：

```
false true true false 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-03-17T00:18:52.050

根据我的经验，Java 新手永远不会覆盖`equals`和方法`hashCode`，`toString`无论对象的用途是什么。也没有人为设置简单的**日志系统**而烦恼。当我看到时，`System.out.println`我觉得我已经准备好折断手指了！但是许多经验丰富的编码人员也在投入大量的任务。

在更高级的注释中，习惯于先编码，`Specs`然后紧随其后`unit testing`- 但这不仅适用于 Java，而且更通用。但是，很多人再次对此进行了定位。

# layout - XUL中如何实现流布局？

> ID：822772
> 
> 赞同：2
> 
> 时间：2009-05-05T00:30:09.303
> 
> 标签：layout, xul, xulrunner

我正在使用 XUL 创建一个 UI。我有 N 个要添加的按钮，我关心的是它们都显示在表单上，​​而不管表单的大小。如果我稍后添加新按钮或删除现有按钮，我只想删除一个 <button> 元素，而不必在网格或 hbox/vbox 元素内移动东西。

有没有办法获得这种行为？*鉴于这是 HTML 中的默认*行为，我无法实现这一点似乎很奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-09T15:14:06.103

尝试这个：

```
 <description><button/><button/><button/><button/><button/>
              <button/><button/><button/><button/></description> 
```

[MDC 上的 XUL <描述>](https://developer.mozilla.org/en/XUL/description)

PS。如果您连续有大量且非常数量的按钮，您可能需要重新考虑您的 UI :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-13T14:34:09.303

您需要添加 display: block; 到父元素的样式。

有关详细信息，请参阅[http://starkravingfinkle.org/blog/2008/06/xul-tip-wrapping-boxes/](http://starkravingfinkle.org/blog/2008/06/xul-tip-wrapping-boxes/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T23:21:37.143

HTML 和 XUL 在基本层面上确实以不同的方式处理这个问题。XUL 是基于盒子的。您可以[在此处查看 MDC 上](https://developer.mozilla.org/en/Notes_on_HTML_Reflow#HTML_and_XUL_Interaction)讨论的差异。从文档中（对我来说）并不完全清楚，但 nsBoxToBlockAdaptor 可能是朝着您寻求的方向迈出的一步。

# c - 在哪里可以找到适用于 Windows 的符合标准的 C 编译器？

> ID：822782
> 
> 赞同：14
> 
> 时间：2009-05-05T00:36:47.573
> 
> 标签：c, windows

我正在为 Windows 寻找一个好的、免费的 C 编译器。我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T00:51:56.117

微型 C 编译器

[http://bellard.org/tcc/](http://bellard.org/tcc/)

它大约200kb。编译速度比 GCC 快 9 倍。无需安装，只需解压缩即可。

没有优化，但是学习K&R应该没问题

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-05T00:48:12.960

有很多。[Borland C++ Builder](http://www.codegear.com/downloads/free/cppbuilder)、[GCC](http://www.gnu.org/software/gcc/)（在 Windows 上，常用于[Cygwin](http://www.cygwin.com/)）、[DJGPP](http://www.delorie.com/djgpp/)、[Visual C++ Express](http://www.microsoft.com/express/vc/)和[LCC-Win32](http://www.cs.virginia.edu/~lcc-win32/)。

我使用过 GCC（通过 Linux 和 Cygwin）。几年前我使用过 DJGPP（它是/是 GCC 的一个分支，不知道它有多接近），效果很好。其他方面没有经验，真的。

编辑：和[MingGW](http://www.mingw.org/)，如果你不想要 Cygwin，这可能是你最好的选择。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T00:53:24.257

[Visual Studio 2008 express edition](http://www.microsoft.com/Express/)，如果您不介意 Microsoft 产品，它是免费的，并且具有 C++ 支持（因此，C 支持）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-05T00:39:08.377

[MinGW](http://www.mingw.org/)提供最新版本`gcc`和朋友。

请注意，最新版本的 Visual Studio 具有更好的 C 标准兼容性。社区[版许可证](https://www.visualstudio.com/license-terms/mt171547/)指定

> 如果您是个人开发自己的应用程序以进行销售或用于任何其他目的，您可以使用该软件来开发和测试这些应用程序。

您可以从[此处](https://www.visualstudio.com/vs/community/)下载[Visual Studio 社区版](https://www.visualstudio.com/vs/community/)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T00:48:30.057

**[Pelles C](http://www.smorgasbordet.com/pellesc/)**是一个不错的轻量级 Windows IDE，它捆绑了一个基于 LCC 的编译器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T01:36:57.570

这个 mingw 链接是更好和最新的。

[http://tdragon.net/recentgcc/](http://tdragon.net/recentgcc/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T00:50:32.250

[Open Watcom](http://www.openwatcom.org/index.php/Main_Page)是一个开源 C/C++ 编译器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T08:55:04.927

+1 Visual Studio 2008 速成版

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T12:24:51.910

[Digital Mars C 和 C++ 编译器](http://www.digitalmars.com/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-12T18:32:10.397

我使用 gcc 编译器和 netbeans IDE。这对我来说可以。注意：旧的 bo​​rland c++ 编译器不再支持 win 7，支持 win 7 的最新版本不能免费使用。此外，如果您不熟悉 Visual Studio 环境，最好不要选择 Visual Studio Express Edition 来编写 C 程序。

# c# - 在 TreeView 中显示节点列表

> ID：822789
> 
> 赞同：0
> 
> 时间：2009-05-05T00:38:29.130
> 
> 标签：c#, treeview, tree

我有一个指定节点级别的节点对象

```
public class Node
{
    public int Level { get; set; }
} 
```

我想使用有序的节点列表来构建树视图

```
var nodes = new[]
{
    new Node(){Level = 0},
        new Node(){Level = 1},
        new Node(){Level = 1},
        new Node(){Level = 1},
            new Node(){Level = 2},
        new Node(){Level = 1},
            new Node(){Level = 2},
            new Node(){Level = 2},
                new Node(){Level = 3},
}; 
```

什么是最有效的方法来做到这一点。

谢谢

罗汉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T02:14:18.523

循环遍历您的节点列表。从索引 0 开始，记录该节点的级别。在所有后续索引中，根据最后记录的级别检查级别。如果更高，则将其添加为最后添加的节点的子节点。如果较低，好吧..如果小写问题..找到适当的节点将其添加到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T03:34:48.563

继 Boo 之后，您将希望在迈向更高级别时保留一堆节点。如果当前节点的级别更高，则将前一个节点压入堆栈并将其用作父节点。如果级别低于前一个节点，则从堆栈中弹出 n 个节点（n = previous_level - current_level）并使用新的堆栈顶部作为父节点。

# iphone - 如何在 iPhone 上创建水平滚动视图？

> ID：822792
> 
> 赞同：1
> 
> 时间：2009-05-05T00:39:33.680
> 
> 标签：iphone, objective-c, cocoa-touch

我想在 UITableView 的顶部创建一个水平滚动字段（类似于在 Facebook 应用程序的主页部分可以找到的内容）。

我希望滚动字段填充六个部分，一次只能选择一个部分？

我该怎么做？

我知道我应该创建一个 UIScrollView 并将其设置为表格的标题视图，但我无法看到滚动条或看到它实际上水平滚动。我应该使用什么视觉对象来表示六个部分并确保一次只能选择一个部分（我知道我可能会使用分段控件，但我希望该部分看起来更像标签）？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T01:05:34.023

Facebook 应用程序的标签视图是[开源](http://github.com/joehewitt/three20/tree/master)的（Apache 许可）。退房`TTTabStrip`。

# linux - 关于进程的pid

> ID：822797
> 
> 赞同：0
> 
> 时间：2009-05-05T00:42:30.710
> 
> 标签：linux, process, pid

我有一个有点愚蠢的问题，如果我创建了一系列进程......这些不一定是某种继承，进程的 pid 必须是数字连续或随机 pid？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T00:47:25.673

这是由操作系统决定的。

通常，它们通常由操作系统按顺序分配。但是，这种行为不是决策的基础，因为大多数操作系统规范都声明进程 ID 分配不是确定性的（即：它可能是随机的，并且可能在未来的版本中发生变化等）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T00:48:09.980

在 Linux 上，pid 通常在系统范围内按顺序分配，但它们会定期回绕，并且可能存在由其他不相关进程引起的“间隙”。在极端情况下，您可能有足够宽的“间隙”来导致这种环绕。所以不要假设任何特定的顺序 - 而是明确地跟踪您的父或子进程的 PID。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T01:56:20.987

以下是测试系统功能的方法：

```
for i in $(seq 20); do ps; done | grep ps 
```

“ps”命令的 PID 是连续的进程，或者与任何其他调用者合理预期能够产生的接近连续的进程一样。

我在 Windows 上的 cygwin 终端随机分配它们，我的网络主机按顺序分配它们（偶尔会有间隙，可能是其他用户或服务器运行的进程）。

有些人认为顺序 PID 分配可能是一个轻微的安全问题，因为它可能会在多用户系统的用户之间泄漏信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T01:57:05.303

在 AIX 上，您经常会看到更大（例如 7 位）的 PI​​D，它们不一定是半顺序分配的（尽管我在测试时似乎以 2 为增量循环；机器上有另一个用户，所以它可能意义不大）。

在 AIX 5.3 机器上重新登录：

```
$ ps
     PID    TTY  TIME CMD
 1060910 pts/27  0:00 -ksh
 1155224 pts/27  0:00 ps
$ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T00:46:34.303

取决于您的平台，但您不应该依赖于您的 pid 的任何特定顺序。

在 Windows 上，pid 通常分配的数量越来越多，但是当进程退出时，pid 可以被回收，您会看到新进程的 pid 低于旧进程的情况。此外，pid 来自与 tid 相同的命名空间，因此当您启动新进程时，您不会看到 pid 增加 4。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T00:47:16.347

从您的角度来看，它们将是随机的。系统管理这些编号并在创建流程时分配它们。快速浏览一下我系统上当前的 PID，发现它们都可以被 4 整除……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T00:53:13.040

如果你正在创建那些你会知道 pid 的孩子，pid 取决于操作系统调度程序，你不关心这些东西。

# c# - Iif 在 C# 中等效

> ID：822810
> 
> 赞同：82
> 
> 时间：2009-05-05T00:47:27.033
> 
> 标签：c#, .net, conditional-operator, iif-function

C#中是否有`IIf`等价物？或者类似的捷径？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-05-05T01:06:46.940

C# 有`?`三元运算符，就像其他 C 风格的语言一样。但是，这并不完全等同于`IIf()`; 有两个重要的区别。

为了解释第一个区别，此`IIf()`调用的 false-part 参数会导致 a `DivideByZeroException`，即使布尔参数是`True`。

```
IIf(true, 1, 1/0) 
```

`IIf()`只是一个函数，并且像所有函数一样，必须在调用之前评估所有参数。换一种说法，*不*`IIf()`短路传统意义上的短路。另一方面，这个三元表达式确实短路了，所以非常好：

 *```
(true)?1:1/0; 
```

另一个区别是`IIf()`类型不安全。它接受并返回 type 的参数`Object`。三元运算符*是*类型安全的。它使用类型推断来了解它正在处理的类型。请注意，您可以使用自己的通用`IIF(Of T)()`实现非常轻松地解决此问题，但开箱即用并非如此。

如果你真的想要`IIf()`在 C# 中，你可以拥有它：

```
object IIf(bool expression, object truePart, object falsePart) 
{return expression?truePart:falsePart;} 
```

或通用/类型安全的实现：

```
T IIf<T>(bool expression, T truePart, T falsePart) 
{return expression?truePart:falsePart;} 
```

另一方面，如果您需要 VB 中的三元运算符，Visual Studio 2008 及更高版本提供了一个新的`If()` *运算符*，其工作方式类似于 C# 的三元运算符。它使用类型推断来知道它返回了什么，它实际上是一个运算符而不是一个函数。这意味着预评估表达式没有问题，即使它具有函数语义。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-05-05T00:49:05.140

VB.NET：

```
If(someBool, "true", "false") 
```

C＃

```
someBool ? "true" : "false"; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-05T00:49:03.097

三元运算符

```
bool a = true;

string b = a ? "if_true" : "if_false"; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-05T01:05:51.310

合并运算符 ?? 也很有用：

VB：

```
Return Iif( s IsNot Nothing, s, "My Default Value" ) 
```

C＃：

```
return s ?? "My Default Value"; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-12-08T02:04:03.667

```
booleanExpression ? trueValue : falseValue; 
```

例子：

```
string itemText = count > 1 ? "items" : "item"; 
```

[http://zamirsblog.blogspot.com/2011/12/c-vb-equivalent-of-iif.html](http://zamirsblog.blogspot.com/2011/12/c-vb-equivalent-of-iif.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T00:49:03.783

这是三元运算符`?`

```
string newString = i == 1 ? "i is one" : "i is not one"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-20T11:29:31.720

它的局限性在于您不能在其中放置语句。您只能将值（或返回/评估为值的事物）返回

这有效（'a' 是 Blah 类中的静态 int）

```
Blah.a=Blah.a<5?1:8; 
```

（圆括号隐含在等号和问号之间）。

这行不通。

```
Blah.a = Blah.a < 4 ? Console.WriteLine("asdf") : Console.WriteLine("34er");
or
Blah.a = Blah.a < 4 ? MessageBox.Show("asdf") : MessageBox.Show("34er"); 
```

所以只能使用 c# 三元运算符来返回值。所以它不太像 if 的缩短形式。Javascript 或者其他一些语言可以让您在其中放置语句。

# git - 显示哪些文件在两个修订版之间发生了更改

> ID：822811
> 
> 赞同：2255
> 
> 时间：2009-05-05T00:47:59.573
> 
> 标签：git, branch, git-branch, git-diff

我想合并两个已经分开一段时间的分支，想知道哪些文件被修改了。

遇到了这个链接： http: [//linux.yyz.us/git-howto.html](https://web.archive.org/web/20180830081303/http://linux.yyz.us/git-howto.html)这非常有用。

我遇到的比较分支的工具是：

*   `git diff master..branch`
*   `git log master..branch`
*   `git shortlog master..branch`

想知道是否有类似“git status master..branch”的东西只能看到两个分支之间不同的文件。

在不创建新工具的情况下，我认为这是您现在可以做到的最接近的方法（如果文件被多次修改，这当然会显示重复）：

*   `git diff master..branch | grep "^diff"`

想知道我是否错过了什么......

* * *

## 回答 #1

> 赞同：2770
> 
> 时间：2009-05-05T01:04:38.473

将当前分支与`main`分支进行比较：

```
$ git diff --name-status main 
```

比较任意两个分支：

```
$ git diff --name-status firstbranch..yourBranchName 
```

[官方文档](https://git-scm.com/docs/git-diff)`git diff`中有更多选项（特别是选项）。[`--name-status`](https://git-scm.com/docs/git-diff#Documentation/git-diff.txt---name-status)

* * *

## 回答 #2

> 赞同：432
> 
> 时间：2011-02-09T19:38:06.003

尝试

```
$ git diff --stat --color master..branchName 
```

这将为您提供有关每次更改的更多信息，同时仍使用相同数量的行。

如果您要以另一种方式合并，您还可以翻转分支以获得更清晰的差异图片：

```
$ git diff --stat --color branchName..master 
```

* * *

## 回答 #3

> 赞同：171
> 
> 时间：2012-10-11T01:22:19.643

还要记住，git 具有便宜且易于分支的功能。如果我认为合并可能有问题，我会为合并创建一个分支。因此，如果`master`有我想要合并的更改并且`ba`我的分支需要来自 master 的代码，我可能会执行以下操作：

```
git checkout ba
git checkout -b ba-merge
git merge master
.... review new code and fix conflicts....
git commit
git checkout ba
git merge ba-merge
git branch -d ba-merge
git merge master 
```

最终结果是，我必须先在一次性分支上尝试合并，然后再拧上我的分支。如果我把自己搞砸了，我可以删除`ba-merge`分支并重新开始。

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2013-04-03T14:01:39.227

如果有人试图从两个分支生成差异文件：

```
git diff master..otherbranch > myDiffFile.diff 
```

* * *

## 回答 #5

> 赞同：45
> 
> 时间：2013-06-14T06:01:20.873

还有一种基于 GUI 的方法。

您可以使用**gitk**。

1.  跑：

    ```
    $ gitk --all 
    ```

2.  右键单击分支的提交，然后在弹出菜单中选择*标记此提交。*

3.  右键单击另一个分支的提交并选择*Diff this -> 标记的提交*或*Diff 标记的提交 -> this*。

然后在右下面板中将有一个更改的文件列表，在左下面板中将有差异详细信息。

* * *

## 回答 #6

> 赞同：38
> 
> 时间：2014-04-24T13:23:31.407

另一种选择，在这种情况下使用融合：

```
git difftool -d master otherbranch 
```

这不仅允许查看文件之间的差异，还提供了一种简单的方法来指向和单击特定文件。

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2009-05-05T00:59:54.333

请注意，如果您不喜欢结果，git 可以很容易地尝试合并并避免出现任何问题。这可能比提前寻找潜在问题更容易。

* * *

## 回答 #8

> 赞同：19
> 
> 时间：2016-05-16T13:13:15.930

如果您只在某些文件中寻找更改，那么：

```
git diff branch1 branch2 -- myfile1.js myfile2.js 
```

branch1 是可选的，如果没有提供 branch1，将默认考虑您当前的分支（您所在的分支）。例如：

```
git diff master -- controller/index.js 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2015-03-24T03:21:32.840

在协作工作或同时处理多个功能时，上游甚至您的 master 包含未包含在您的分支中的工作，并且会错误地出现在基本差异中，这是很常见的。

如果您的上游可能已经移动，您应该这样做：

```
git fetch
git diff origin/master... 
```

仅使用 git diff master 可以包含或不包含相关更改。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2013-06-06T07:17:35.150

如果您使用的是[IntelliJ IDEA](http://www.jetbrains.com/idea/)，您还可以将任何分支与您当前的工作分支进行比较。有关详细信息，请参阅[http://www.jetbrains.com/idea/webhelp/merging-deleting-and-comparing-branches.html#d288093e3827](http://www.jetbrains.com/idea/webhelp/merging-deleting-and-comparing-branches.html#d288093e3827)。这在[免费版](http://www.jetbrains.com/idea/features/editions_comparison_matrix.html)中也可用。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2016-10-04T11:56:48.420

有两个分支可以说

*   A（您正在工作的分支）
*   B（您要与之比较的另一个分支）

在分支 A 中，您可以输入

```
git diff --color B 
```

那么这会给你一个输出

[![在此处输入图像描述](https://i.stack.imgur.com/Xn3Pb.png)](https://i.stack.imgur.com/Xn3Pb.png)

关于这一点的重要一点是

1.  绿色文本存在于分支 A 中

2.  分支 B 中存在红色文本

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2017-05-31T22:00:58.027

这里有很多答案，但我想添加一些我常用的东西。如果您在要比较的分支之一，我通常会执行以下操作之一。为了这个答案，我们会说我们在我们的二级分支中。取决于您当时需要的视图取决于您选择的视图，但大多数时候我使用的是两者中的第二个选项。如果您要恢复到原始副本，第一个选项可能会很方便 - 无论哪种方式，都可以完成工作！

这会将 master 与我们所在的分支（次要）进行比较，原始代码将是添加的行，新代码将被视为删除的行

```
git diff ..master 
```

或者

这也会将 master 与我们所在的分支（次要）进行比较，原始代码将是旧行，新代码将是新行

```
git diff master.. 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-12-03T09:37:32.557

如果您使用的是 Github / Github Enterprise，则可以通过点击`/compare`存储库路径的 url 来使用 Web UI，例如[https://github.com/http4s/http4s/compare](https://github.com/http4s/http4s/compare)。您可以选择要比较的分支/提交/标记： [![Github 对比截图](https://i.stack.imgur.com/D4mWv.png)](https://i.stack.imgur.com/D4mWv.png)

并且差异将显示在 github 界面中的 url `/compare/{x1}...{x2}`where are `x2`and `x1`are the branch / commit / tag 你要比较，例如： [https://github.com/http4s/http4s/compare/main...dotty](https://github.com/http4s/http4s/compare/main...dotty)

你可以在[Github Doc](https://help.github.com/en/github/committing-changes-to-your-project/comparing-commits-across-time#comparing-branches)中看到更多内容。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-04-17T04:55:52.760

对于正在寻找 GUI 解决方案的人，[Git Cola](https://git-cola.github.io/)有一个非常不错的“Branch Diff Viewer ( *Diff* -> *Branches..* )。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-03-01T09:49:19.010

```
git diff revision_n revision_m 
```

如果`revision_n`和`revision_m`是连续提交，那么它的输出与 `git show revision_m`

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2019-06-27T16:09:36.177

您还可以使用**[视觉差异](https://stackoverflow.com/q/12912985/5170571)**。

例如，如果您使用[Sourcetree](https://www.sourcetreeapp.com/)，您可以简单地[在 log view 中选择任意两个提交](https://stackoverflow.com/a/30178646/5170571)。

（我个人更喜欢在大多数情况下使用 GUI，我将这个发布给那些可能不熟悉 GUI 选项的人。）

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2018-06-19T23:21:20.643

如果您喜欢 GUI 并使用 Windows，这里有一个简单的方法。

1.  下载 WinMerge
2.  将两个分支签出到不同的文件夹中
3.  使用 WinMerge 逐个文件夹进行比较。如果其中一个分支是您正在处理的分支，您也可以轻松地进行修改。

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2017-10-18T09:53:19.417

您还可以使用**TortoiseGit**轻松比较已更改文件的分支。只需单击***Browse References***并选择要比较的分支。

例如，如果您将*您的分支*与*master*进行比较，您将得到一个文件列表，如果您决定将*您的分支*合并到*master*中，这些文件将在*master*中更改。

 **请记住，如果将*master*与*your-branch*以及*your-branch*与*master*进行比较，您将得到不同的结果。

# c - 如何处理输出结构中的字符串分配

> ID：822815
> 
> 赞同：0
> 
> 时间：2009-05-05T00:48:31.210
> 
> 标签：c

处理包含一些字符串的输出结构的最佳方法是什么？

```
struct info 
{ 
wchar_t * text; 
size_t text_len; 
}

void Foo(struct info * output); 
```

*   用户需要自己分配文本

    输出可以在循环中回收，
    很难知道需要分配多少内存，如果要存储输出可能会浪费内存（例如，保留一个项目列表）

*   在 Foo 中分配文本

    用户释放输出很痛苦，因为他必须在循环之前释放每个文本（可以制作 FreeStructInfo 来减轻痛苦）
    在循环中不太好

*   从 Foo 中分配输出

    Foo 可以在 struct info 中嵌入文本，用户只需释放输出即可释放所有内容。
    有利于存储（Foo知道它需要分配多少），
    但如果在循环中用作短期变量，可能会给内存带来很大压力，因为它不能被回收。

Windows 使用“用户需要自己分配文本”，要么分配足够的文本，要么需要调用该函数两次以获得所需的大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T00:52:17.597

没有一种最好的方法——您提出的所有选项都会在某个时候使用。重要的是对其进行良好的记录，并在可行的情况下在库中的所有函数中保持一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T00:53:29.607

您可以使用第一个成语（用户分配），如果字符串的空间不足，您可以重新分配。如果您和用户同意使用相同的分配（如 malloc/free），这将起作用。这将为您提供最佳性能（每次迭代都无需分配）并且对用户仍然很方便。

使用这个习惯用法，分配的存储空间会根据需要增长，但用户可以随时选择通过重新分配较小的存储空间来“缩小”它（如果需要，它将再次开始增长）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T01:03:24.670

lothar 总结了第一个成语的优点——很可能它是一般解决方案的最佳选择。

但是，有时第三个选项（修改后的）更好——如果你有很多输出。为避免内存压力，您可以将池添加到组合中。

# visual-studio - Vista中点击激活VS2005工具窗格导致双击

> ID：822822
> 
> 赞同：0
> 
> 时间：2009-05-05T00:51:44.370
> 
> 标签：visual-studio, visual-studio-2005, windows-vista

我一直在忍受这个，突然间我想：也许其他人遇到过这个！

在 Vista x86 上的 Visual Studio 2005 中，当我单击没有焦点的工具窗格时，它会双击。对属性窗口、工具箱、错误列表、输出窗口等执行此操作。

我注意到的一些事情：

*   这发生在全新安装的 VS2005 上，它排除了我的加载项和宏。
*   它发生在两台不同的 Vista 机器上，但没有发生在我使用过的任何 XP 机器上。
*   我不使用任何奇怪的罗技鼠标助手应用程序或其他系统鼠标挂钩背景的东西。
*   这是 VS2005 独有的：我使用的其他应用程序都没有这个问题。

更新：

*   我试过以管理员身份运行。我禁用了 UAC 的一台 Vista 机器 - 没有区别。
*   VS2005 SP1 已安装，Vista SP1 已安装，还有 VS2005 SP1 的 Vista 更新。完全修补。
*   我浏览了所有我能找到的发行说明和微软关于 2005 年的说明，但其中没有关于奇怪的 GUI 行为的内容。

有没有其他人遇到过这个？我的解决方法是先右键单击工具窗格，然后我可以在那里做我需要的事情。呜呜。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T01:05:49.437

您是否安装了适用于 Vista 的 VS2005 SP1 更新？您是否以管理员身份运行？ [这是微软在 Vista/VS2005 上的低调](http://msdn.microsoft.com/en-us/vstudio/aa948853.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T02:00:16.560

听起来很硬件。你有没有调整过你的鼠标灵敏度或类似的东西？您是否尝试过使用第二只鼠标来查看是否会发生这种情况？

# google-app-engine - 有没有办法在 AppEngine 上运行 OpenBravo？

> ID：822829
> 
> 赞同：3
> 
> 时间：2009-05-05T00:53:30.667
> 
> 标签：google-app-engine, open-source, openbravo

OpenBravo 是一个开源 ERP 系统，是否可以在 Google 的 Java AppEngine 上运行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-12-23T12:48:04.363

好吧，应用程序本身可以运行，但主要障碍是 Openbravo 附带的关系数据库。

它支持 Postgres 和 Oracle，并且由于它的很多业务逻辑都在存储过程和触发器中，因此需要大量工作才能将其转换为使用应用程序引擎的数据存储。

所以答案是否定的，不是没有很多工作。

# winapi - 无法绑定到 XP sp3 上的低端口号 (80)

> ID：822830
> 
> 赞同：1
> 
> 时间：2009-05-05T00:53:56.050
> 
> 标签：winapi, sockets, winsock, bind

我的套接字类中有这段代码：

```
bool GSocket::Listen(int Port)
{
    d->Socket = socket(AF_INET, SOCK_STREAM, 0);
    if (d->Socket >= 0)
    {
        sockaddr Addr;
        sockaddr_in *a = (sockaddr_in*) &Addr;
        ZeroObj(Addr);
        a->sin_family = AF_INET;
        a->sin_port = htons(Port);
        a->sin_addr.OsAddr = INADDR_ANY;

        if (bind(d->Socket, &Addr, sizeof(Addr)) >= 0)
        {
            if (listen(d->Socket, SOMAXCONN) != SOCKET_ERROR)
            {
                return true;
            }
            else
            {
                Error();
            }
        }
        else
        {
            Error();
        }
    }
    else
    {
        Error();
    }

    return false;
} 
```

“Error()”方法只是调用 WSAGetLastError 并将错误及其描述传递给应用程序。无论如何，它在我的机器（xp sp2）上运行良好，但在我的朋友 xp sp3 机器上却失败了。特别是绑定调用失败并且 WSAGetLastError 返回“2”，这甚至不是有效的套接字错误代码。传入的“端口”值是 80，我正在运行一个简单的 HTTP 服务器作为服务的 UI。我不完全确定为什么要检查 >= 0，但它可能与我也使用此代码的非 Windows 平台有关。在任何情况下，根据 MSDN，绑定错误的返回码是 SOCKET_ERROR，它是 -1，因此检查应该没问题。

我错过了一些简单的事情吗？

更新：我们刚刚尝试了一个不同的端口号“8888”，一切都按预期工作。所以看起来低端口号是问题所在。在我们运行我的服务之前，该端口上没有任何主动监听，所以我认为这是 SP3 中的某种新权限问题，它会停止监听端口 < 1024 的进程，除非它们具有某些权限，类似于 linux/unix 方式的做事。无论如何，我仍然希望能够解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-21T18:28:37.913

0 到 1023 范围内的端口号是[众所周知的端口](http://en.wikipedia.org/wiki/Well_known_ports)，操作系统可能需要管理权限才能绑定到它们。因此，任何尝试使用这些端口的应用程序都必须具有特权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T04:15:05.543

您正在那里进行有趣的指针运算...只需将 sockaddr_in 放在堆栈上，然后将指针传递给它以进行绑定。

```
sockaddr_in a = {0};
a.sin_family = AF_INET;
a.sin_port = htons(Port);
a.sin_addr.OsAddr = INADDR_ANY;

if (bind(d->Socket, (sockaddr *) &a, sizeof(a)) >= 0) 
```

另外，请尝试检查特权是否妨碍您。该端口上是否已经打开了某些东西（询问 netstat）

# sql-server - 使用 SSIS 将硬编码值映射为 Visual Studio 中一对多表迁移的一部分

> ID：822832
> 
> 赞同：5
> 
> 时间：2009-05-05T00:54:52.130
> 
> 标签：sql-server, visual-studio, ssis

使用 SQL Server 2005 和 Visual Studio 2005，我正在尝试创建一个 SSIS 包以将数据从 1 个表合并到其他几个表。

源表没有目标表的多个字段。例如“CreatedBy”和“CreatedDate”字段。我希望将这些硬编码（在某种意义上）作为包导入过程的一部分。

问题是不知道使用什么来促进这种映射。作为起点，对 createdBy 和 createdDate 分别使用硬编码的“1”和 GetDate() 是可以接受的。

“目标高级编辑器”选项对话框上的“输入和输出属性”或“列映射”选项卡对映射“默认”值（例如 GetDate()）没有任何明显的支持。

关于如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T07:30:01.683

创建新列（具有或不具有静态值）的 SSIS 方法是在源和目标之间的数据流中使用“派生列”转换。

这使您能够使用表达式指定其他列及其值。对于当前日期/时间，`Getdate()`用作表达式并将数据类型设置为“日期（DT_DATE）”。要对值进行硬编码，请在表达式中将其双引号（例如“1”）并指定相关的数据类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T07:37:29.620

与其使用表作为源，不如专门指定查询？这样，您可以将值静态定义为源的一部分。

例如

```
SELECT id, fieldOne, fieldTwo, '1' AS createdBy, GetDate() AS createdDate
FROM SourceTable 
```

我最近做了这件事。

要记住的一件重要事情是您需要确保您的数据类型匹配。我遇到了一些字符串数据类型不匹配的问题（UTF-8 等）。

# utf-8 - Firebird - UTF8 VarChar 大小

> ID：822837
> 
> 赞同：5
> 
> 时间：2009-05-05T00:57:03.920
> 
> 标签：utf-8, firebird, varchar

我正在将我们的 firebird 数据库中的所有 varchar 列更改为 UTF8，但是我不明白 varchar 大小的差异。

例如，将 charset 和 collat​​ion 设置为空，我们可以将 varchar 大小设置为 255，如果我们将 charset 和 collat​​ion 设置为 UTF8，当我们将 varchar 设置为 255 时，它会读取不同的值。

UTF8 中 varchar(255) 的等效 varchar 大小是多少？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T08:06:37.477

为字段使用 UTF8 字符集`VARCHAR(N)`需要为任何`N`UTF8 字符保留足够的空间。一个这样的字符的长度可能在 1 到 4 之间，因此唯一安全的做法是允许`N`每个长度为 4 的字符，这意味着需要有 200 个字节的空间来存储 50 个字符（最坏情况）。

您可以使用[FlameRobin](http://www.flamerobin.org)工具查看内部结构。假设你有一张桌子

```
CREATE TABLE "TableÅÄÖåäö"
(
  "ColÅÄÖåäö" Varchar(50)
); 
```

在具有默认字符集 UTF8 的数据库中。（请注意，您至少需要 Firebird 2.0。）

系统表存储有关所有关系及其字段的信息。在系统表`RDB$RELATION_FIELDS`中，该字段有一条记录，它（例如）`RDB$1`作为`RDB$FIELD_SOURCE`. 查看`RDB$FIELDS`有一个记录`RDB$1`，其值为`RDB$FIELD_LENGTH`200。

因此，回答您的问题：要拥有一个 UTF8 列，其中包含 255 个字符的空间，您将其输入为`VARCHAR(255)`，但在数据库中它的大小为 1020 字节。

# string - 您可以在 Silverlight 中进行 HtmlDecode 和 HtmlEncode 吗？

> ID：822838
> 
> 赞同：17
> 
> 时间：2009-05-05T00:57:57.897
> 
> 标签：string, silverlight, httpcontext, html-encode

因此，既然`System.Web`&`HttpContext`在 Silverlight 中不可用，有没有办法在 Silverlight 应用程序中执行`HtmlDecode`&`HtmlEncode`而不需要一些可怕的正则表达式？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-05T01:03:34.623

[System.Windows.Browser](http://msdn.microsoft.com/en-us/library/system.windows.browser(VS.95).aspx)有一个带有[HtmlEncode](http://msdn.microsoft.com/en-us/library/system.windows.browser.httputility.htmlencode(VS.95).aspx)和[HtmlDecode](http://msdn.microsoft.com/en-us/library/system.windows.browser.httputility.htmldecode(VS.95).aspx)方法的[HttpUtility](http://msdn.microsoft.com/en-us/library/system.windows.browser.httputility(VS.95).aspx)类。

# asp.net-mvc - Asp.Net MVC 不在 url 中显示索引操作

> ID：822840
> 
> 赞同：5
> 
> 时间：2009-05-05T00:58:24.430
> 
> 标签：asp.net-mvc, controller

我希望索引操作不会出现在 url 中。

例如，我想看看

www.mywebsite.com/MyController/1

代替

www.mywebsite.com/MyController/Index/1

在 Html.ActionLink 标记或 global.aspx 文件中我有什么特别需要做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T01:03:07.587

试试这个为你的路线。

```
routes.MapRoute(
    "Index",
    "/{controller}/{id}",
    new { controller = "Home", action = "Index" }
); 
```

它将操作设置为默认的“索引”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T01:05:02.950

是的，您可以像这样修改您的路线：

```
 routes.MapRoute(
                "Default",                                              // Route name
                "{controller}/{id}",                           // URL with parameters
                new { controller = "MyController", action = "Index", id = 1 }  // Parameter defaults
            ); 
```

# android - Android：最近的应用程序似乎有 Google 提供的广告，是否有一些新的 API 来解决这个问题？

> ID：822841
> 
> 赞同：1
> 
> 时间：2009-05-05T00:59:11.030
> 
> 标签：android, admob, ads

最近的几个应用程序（例如 Shazam）包含由 Google 处理的文字和图片广告。我找不到他们是怎么做到的。是否有一些新的 API 可用于在给定一些密钥的情况下显示广告，类似于 maps API 的工作方式？或者这是开发人员单独协商的事情？

具体来说，我对 Google 的广告很感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T13:27:58.507

最流行的 API 来自 AdMob，看看： http: [//www.admob.com/](http://www.admob.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T06:12:56.687

SDK 中没有任何内容支持这一点，不。但是，如果您访问[Google 的 AdSense 页面](https://www.google.com/adsense/)，就会看到有关移动广告的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-24T22:06:11.050

Google 最近推出了 AdSense for Mobile，您可以申请成为测试版的一部分。

[http://www.google.com/ads/mobileapps/developerform.html](http://www.google.com/ads/mobileapps/developerform.html)

请注意，您需要**申请**，并且要求是每天至少产生 100,000 次页面浏览量的应用程序。

这是 Shazam 正在使用的程序。

# html - 在 Flash 播放器中显示 html

> ID：822844
> 
> 赞同：0
> 
> 时间：2009-05-05T01:00:28.013
> 
> 标签：html, flash

有没有办法在 Flash 中呈现 HTML 页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T01:04:30.923

你的意思是一个 Flash html 渲染器？我知道这个：[http ://code.google.com/p/htmlwrapper/](http://code.google.com/p/htmlwrapper/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T02:45:36.500

参见：[Embedding HTML in a Flex application using an IFrame](http://www.deitte.com/archives/2006/08/finally_updated.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-19T23:45:41.747

这可能是一个答案：[http ://code.google.com/p/htmlwrapper/](http://code.google.com/p/htmlwrapper/)

它似乎是一个用 Flash 编写的 HTML 渲染器。可能对 IE6 用户有用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-05T01:05:09.080

因为你不具体

```
loadText = new LoadVars();
loadText.load("example.htm"); 
```

将 HTML 文本加载到 flash 中（作为字符串）

# java - 使用 Hibernate / Spring / JUnit 建立和拆除复杂的数据库状态

> ID：822846
> 
> 赞同：10
> 
> 时间：2009-05-05T01:01:04.207
> 
> 标签：java, hibernate, spring, junit

我有一个单元测试类，需要相当广泛的数据库设置才能运行各个测试方法。此设置需要很长时间：由于希望与手头的问题无关的原因，我需要以编程方式而不是从 SQL 转储填充数据库。

我遇到的问题是拆机。如何轻松回滚在数据库设置阶段所做的所有更改？

我目前正在使用 Hibernate + Spring Transactional Testing 支持，这样我的各个测试方法都包含在事务中。

一种解决方案是在每个测试方法中进行数据库设置，这样数据库设置将自动回滚。但是，测试方法将永远运行，因为每个方法都需要重新准备数据库。

还有其他想法吗？基本上，我正在寻找一种方法来运行我的数据库设置，运行我的个人测试（每个测试都包含在一个事务中，执行后会回滚），然后回滚初始数据库设置。关于使它以 Hibernate / Spring / Junit 方式工作的任何想法？是否有 Hibernate“删除所有表”等效命令？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T07:24:51.540

您是否坚持使用特定的数据库供应商？如果没有，您可以使用内存数据库，例如[HSQLDB](http://hsqldb.org/)。完成测试后，您只需丢弃状态。这仅适用于表在测试套件开始时可以为空的情况（即在您的程序设置之前）。

您仍然需要创建表，但如果使用 Hibernate 巧妙地映射所有内容，您可以使用 hbm2ddl 生成表。您所要做的就是将以下内容添加到您的*测试*会话工厂定义中：

```
<session-factory>
    ...
    <property name="hibernate.hbm2ddl.auto">create</property>
    ...
</session-factory> 
```

如果此解决方案似乎适用，我可以详细说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T01:52:20.760

您可能想查看 Junit 4 的 @AfterClass 注释。该注释将在测试完成后运行。

[http://cwiki.apache.org/DIRxDEV/junit4-primer.html](http://cwiki.apache.org/DIRxDEV/junit4-primer.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T01:52:27.313

DNUnit 应该在这方面为您提供帮助。如果您愿意，可以为每个单独的测试用例创建单独的数据集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T02:25:41.617

DBUnit 在这方面会有很大帮助。理论上你可以关闭 JDBC 上的自动提交，但它会变得很麻烦。最明显的解决方案是在运行测试之前使用 DBUnit 将数据设置为已知状态。如果由于某种原因您在运行测试后需要返回数据，您可以在运行所有测试的套件上查看 @AfterClass，但通常认为设置测试然后运行它们是更好的做法，所以如果测试失败，这不仅仅是因为它没有清理其他测试失败而没有预先确定的环境。您确保每个测试都直接设置其环境。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T03:17:45.983

您可能要考虑的一种解决方案是在数据库拆除中使用“手动”回滚或补偿事务。我想（如果不是，那么它应该是您的 Hibernate 实体的一个微不足道的附加组件）您的所有实体都有 datetime create 属性，指示它们何时被插入到表中。您的数据库设置方法应该在其他所有操作之前记录时间。然后，您有一个相当简单的 db 拆除程序，以删除在 db setup 中记录时间后创建的所有实体。

当然，这不适用于数据库设置中的更新...但是如果您的更新数量有限，请考虑为此类数据保存原始图像并在数据库拆除期间恢复它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T07:32:01.613

如果您正在使用相对较小的数据库，并且使用可以相对快速地对其进行备份/导出的 DBMS（如 MS SQL Server），您可以考虑在测试之前创建数据库备份，然后在所有测试完成时恢复它完全的。这使您能够设置开发/测试数据库并将其用作所有测试的起始状态。

我用原生 JDBC 完成了它，在测试之间执行了“备份数据库”和“恢复数据库”T-SQL，它运行得相当好。

但是，这种方法取决于在您的本地机器上拥有 DBMS 服务器（为了合理的速度），您有足够的权限（这应该不是问题），以及数据库的总大小不超过几十 MB - 在至少在我的经验中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T04:37:00.607

是否有理由必须连接到数据库才能运行单元测试？听起来重构你的类可能更容易，这样你就可以模拟与数据库的交互。您可以使用 EasyMock (www.easymock.org) 模拟类（有一些例外）以及接口。

如果您的类依赖于连接数据库中复杂的预先存在的状态，那么使用模拟编写更快的执行测试可能会更容易。我们不知道您的项目的规模或测试的运行频率，但可能需要考虑执行时间，尤其是在大型项目中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-03T13:50:37.073

Hibernate 有一个简洁的小功能，但文档严重不足且未知。您可以在数据库模式生成后立即在 SessionFactory 创建期间执行 SQL 脚本，以在新数据库中导入数据。您只需在类路径根目录中添加一个名为 import.sql 的文件，并将 create 或 create-drop 设置为 hibernate.hbm2ddl.auto 属性。

[http://in.relation.to/Bloggers/RotterdamJBugAndHibernatesImportsql](http://in.relation.to/Bloggers/RotterdamJBugAndHibernatesImportsql)

# html - 有什么方法可以跟踪电子邮件是否已打开？

> ID：822862
> 
> 赞同：23
> 
> 时间：2009-05-05T01:05:27.737
> 
> 标签：html, email, analytics

我开始研究我们在内部使用的邮件列表软件**（编辑：虽然我们也在外部发送电子邮件，所以我们不能对邮件客户端强制执行策略）**。当我向特定用户发送电子邮件时，是否有任何方法可以跟踪该电子邮件是否已被打开，而不是被标记为垃圾邮件或被删除而不被打开？

我想到的最简单的方法是提供一个需要从我们的服务器加载的单像素自定义图像，但是许多邮件客户端阻止了这种方法。是否有替代方法可以获得更好的数据？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-05T01:08:00.213

邮件客户端几乎可以阻止所有这些类型的尝试。最好的办法是给他们一个他们在阅读邮件时想看到的图像，因此他们选择在他们的邮件客户端中显示图像。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-05T01:08:23.020

没有万无一失的方法可以检查用户是否已阅读您的邮件。而且不应该有IMO。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-03-18T23:03:35.127

几个星期以来，我一直在寻找这个问题的答案，并在那里找到了几个选择。我喜欢的那个会将“开放”数据发送到 Google Analytics。

下面的图片应该插入到您的电子邮件正文中。我向其发送电子邮件的每个人都有一个唯一的客户编号，因此我可以看到打开/唯一打开，但它不能根据 Google 的条款识别特定客户。

```
 <img src="http://www.google-analytics.com/collect?v=1
                &tid=UA-12345678-1
                &cid=12345
                &t=event
                &ec=email
                &ea=open
                &el=recipient_id
                &cs=newsletter
                &cm=email
                &cn=Campaign_Name
                " /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T01:10:03.263

您可以索要已读回执（电子邮件功能），但大多数用户认为这很痛苦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T01:57:58.923

在电子邮件中添加透明 gif。当您的用户显示图像时，它将查询您的服务器并在您的文档中添加一行。也就是渲染率。这就是电子邮件营销人员过去所说的“打开率”。

您可以使用 MxM ( [http://www.m--x--m.net](http://www.m--x--m.net) ) 来传递您的电子邮件。他们会自动添加它并为您管理可传递性和反垃圾邮件。我们已经开源了那段代码，但它是用 Python 编写的。

（披露，我是这家公司的创始人）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T01:12:23.133

如果这是内部的，我假设您拥有 IMAP 服务器（或 Exchange 或您拥有的其他东西）。这有点难看，但这将是了解电子邮件客户端是否至少显示消息的“正确”方式。当然，您不能真正保证它已被阅读：-p

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T01:22:43.610

您可能会发送带有“已读回执”请求的邮件，然后强制执行所有邮件客户端在打开时自动发送通知的策略。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-20T13:13:39.550

跟踪用户是否阅读（下载）您的电子邮件的唯一方法是将信息不放在电子邮件中，而是放在图像或外部 html 页面之类的东西中，并且只有您的电子邮件链接到所述资源（通过外部浏览器或启用图像）在电子邮件客户端中）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-06T00:45:08.367

您可以通过重新分发内容来满足您的需求。以这样的方式设计电子邮件，让关心您的电子邮件的用户单击某个链接以了解更多信息/继续阅读。换句话说，我主张避免这个问题，因为没有一个可靠的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-07T20:21:22.990

对于 python，你可以使用[这个](https://github.com/powergo/pytracking)包。通过使用此包，您可以跟踪打开和单击邮件。

# drupal - 是否可以将模块的复选框设置为“只读”？

> ID：822865
> 
> 赞同：2
> 
> 时间：2009-05-05T01:05:43.680
> 
> 标签：drupal

我正在编写一个安全模块以允许为多站点 Drupal 设置启用某些模块。现在，我们可以使用以下代码段轻松禁用 Modules 表单。

我们想将表单元素设置为只读，然后启用仅启用/禁用子集的功能。

```
function disable_form_fields_form_alter(&$form, $form_state, $form_id) {

    //get handle on drupal user var
    global $user;

    //if we are uid == 1 then we can edit this stuff...
    if($user->uid !=1 && variable_get('osu_update_lockdown',1)==1){

        if ($form_id == 'system_modules'){

            //find all the modules not disabled
            $modules_to_disabled = array_diff_key($form['status']['#options'],     array_flip($form['status']['#disabled_modules']));

            //for each not in our disabled list lets add it in
            foreach($modules_to_disabled as $name => $value){
                $form['status']['#disabled_modules'][] = $name;
            }

            //disable non-checked boxes
            foreach($form['status']['#options'] as $key=>$val){
                $form['status']['#process']['system_modules_disable'][0][]=$key;
            }
            //disable checked boxes
            foreach($form['status']['#default_value'] as $key=>$val){
                $form['status']['#process']['system_modules_disable'][0][]=$val;
            }

            unset($form['buttons']['submit']);

        }
    } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-08T12:38:40.847

您是否尝试过在表单元素上使用“ [#access](http://api.drupal.org/api/file/developer/topics/forms_api_reference.html/6#access) ”=> FALSE 属性？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T13:56:38.043

是的，您可以使用此[#attributes](https://api.drupal.org/api/drupal/developer!topics!forms_api_reference.html/7#attributes)将其设置为只读：

```
'#attributes' => array('readonly' => 'readonly'), 
```

因此，对于您的表单，它是这样的：

```
$form['status']['#attributes'] = array('readonly' => 'readonly'); 
```

这将使您的表单只读。

# javascript - 网站真的需要迎合没有启用 Javascript 的浏览器吗？

> ID：822872
> 
> 赞同：46
> 
> 时间：2009-05-05T01:07:51.443
> 
> 标签：javascript

为什么许多专业的 Web 开发人员总是坚持开发适合禁用 Javascript 的浏览器的网站？

除了技术负责人和开发人员之外，大多数“普通”用户甚至都不知道它是什么。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-05T01:14:25.813

> 谁使用旧于 Firefox 2 或 IE6 的浏览器？

错误的问题。问题不在于浏览器的时代。有很多*新*的浏览器不支持或不能很好地支持 javascript，它们可能与最新的 safari 或 firefox 一样重要。

其他人提到了智能手机或 lynx，但我书中的主要内容是**Googlebot**。这是一个和其他浏览器一样的浏览器，它不会运行你的大部分 JavaScript。此外，即使你有 Firefox，你也可以使用 NoScript 之类的插件。这与在禁用 javascript 的情况下运行不同，但如果你做错了事情，你可能真的会为那些用户搞砸（即，在会话开始或创建帐户时检测一次 javascript 状态，然后不再提供 javascript页面，即使他们想为您启用它）。最后，如果您为美国政府工作，法律要求您支持某些可访问性标准，包括禁用 javascript。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-05T03:54:29.093

几个月前，我在我正在开发的一个拥有百万会员的主流网站上测试了用户群，大约 10% 的独立用户没有运行 Javascript。

考虑扭转这个问题：是否值得开发一个仅适用于具有 Ajax 能力的用户的网站？你真的会忽略搜索机器人、大多数手机和一堆其他用户吗？

回归本源。首先，使用**准系统 (X)HTML**创建您的站点，基于类似 REST 的原则（至少在需要 POST 请求来更改状态的范围内）。简单的语义标记，忘记 CSS 和 Javascript。

第一步是做到这一点，并让您的整个网站（或尽可能多的网站）以这种方式很好地为搜索机器人和类似 Lynx 的用户代理工作。

然后添加一个**视觉**层：CSS/graphics/media 进行视觉润色，但不要显着改变您原来的 (X)HTML 标记；允许原始纯文本网站保持完整和正常运行。保持标记干净！

三是添加**行为**层：Javascript（Ajax）。为使用支持 Ajax 的 JS 的用户/浏览器提供更快、更流畅、更好的体验……但仅限于那些用户。仍然欢迎没有 Javascript 的用户；搜索机器人、视障者、许多手机等也是如此。

这在网页设计界称为**渐进增强**。这样做，您的网站就会以某种合理的形式为所有人服务。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-05T01:09:41.177

我认为这是一个众所周知的事实，大约 10% 的人关闭了 JavaScript，因此考虑到这一点很重要。如果你觉得你可以放心地忽略多达 10% 的观众，那么吹掉它就可以了。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-05T01:11:04.120

[盲文终端用户](http://en.wikipedia.org/wiki/Braille_terminal)使用的许多面向文本的浏览器（如[Lynx](http://en.wikipedia.org/wiki/Lynx_(web_browser)) ）不支持 JavaScript。将这些人排除在访问网站之外是非常不礼貌的。

了解有关[Web 无障碍倡议](http://www.w3.org/WAI/)的更多信息。

**编辑：** 不要**将**文本浏览器[Lynx](http://en.wikipedia.org/wiki/Lynx_(web_browser))与图形浏览器[链接混淆](http://en.wikipedia.org/wiki/Links_(web_browser))

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-05T01:10:43.123

电话将是我能想到的主要产品。许多移动设备并不擅长处理大量 javascript 的网站。考虑到移动设备正迅速成为顶级互联网接入点之一，您可能需要重新考虑自己的立场……；）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-05T01:32:39.373

这更像是个人的烦恼，但......

当网页使用 AJAX 调用加载其他页面并且不提供在另一个选项卡中打开窗口的任何方法时，我真的不喜欢它。例如，在 gmail 上，如果您想在新窗口中打开草稿文件夹，您可以右键单击它并点击在新窗口中打开。那里没问题。

另一方面，如果您想打开联系人窗口，则没有非 JavaScript 方法可以做到这一点。因此，您无法右键单击并选择在新窗口中打开。**选项不存在！**

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-05T04:31:46.150

哇……我​​想我会是第一个说它的人，但是……“让所有禁用 JavaScript 的人见鬼去吧。” 如果您的网站*需要*运行 JavaScript，请忘记所有关闭它的人。严重地。如果您的网站真的好到可以担心失去大量受众，那么人们打开 JavaScript 可能就足够了。

例如，在关闭 JS 的情况下访问 Facebook、YouTube、Google Docs、Google Maps 或 Digg（哎呀，尝试用 SO 做一些更酷的事情），看看你能做什么（不是很多）。

网络浏览器正在变成更多基于云的操作系统，而不是“网站”的门户。允许 JavaScript 运行有很多令人信服的理由，而 IMO 则很少有理由不这样做。对我来说，关闭 JS 类似于在 Windows Vista 中启用 UAC。是的...它可以帮助您防止犯错，但是打开它太*烦人*了（但是相反的逻辑... :-)。

所以，无论如何......我可能会因为这个答案而受到很多批评，但我觉得我的理由是合理的，并且得到了许多*非常*成功的网站和 Web 应用程序的支持。

只要确保您希望被 Google（和大多数其他蜘蛛）索引的页面能够在没有 JavaScript 的情况下被访问。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-05T01:16:12.830

[由于NoScript](http://noscript.net/)等插件的安全问题，许多人禁用了 Javascript 。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-05T01:36:50.657

一个简单的事实是，强制使用 JavaScript 会限制您的受众。有一天，有人会尝试在没有 JavaScript 的情况下运行您的网站。如果他们做不到，他们要么打开它，要么生气离开。如果他们离开，他们很可能永远不会回来。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-05T01:11:43.743

在 PC 之外思考...许多手机的浏览器不支持 javascript。如果您希望他们可以看到您的网站，那么考虑这些客户的非 JavaScript 体验可能是值得的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-05T01:23:32.763

根据我将要访问的站点，我每天多次禁用和重新启用 JavaScript。例如，喜欢弹出窗口和调整我的窗口大小的新闻网站，与我保持静止。

普通用户并不需要花太多时间就知道这些事情是由一种叫做“JavaScript”的神秘东西完成的，以及在浏览器中的何处将其关闭。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-05T01:54:46.277

**默认情况下禁用所有脚本，只为他们需要的站点启用它们，至少是任何互联网用户的推荐做法。** 我什至会说不这样做是鲁莽和粗心的。有一些不错的插件可以让脚本有选择地用于选定的站点。

这意味着**您必须假设首次访问您网站的访问者不允许在他们的浏览器中使用任何脚本**。因此，您的站点应该能够**提供一个有用的界面来收集信息，而不需要用户允许脚本**。

在我看来，JavaScript 应该只用于提供超出简单信息显示的*附加功能。*

我的行为是这样的：当我偶然发现一个只显示“你需要启用 JavaScript”的网站时，我立即重新评估了我的兴趣，这让我来到了那里。在某些情况下，我只会关闭选项卡。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-05T02:02:03.297

值得担心一小部分人，还是努力实现最佳实践？优雅的失败是 Web 开发人员应该为之奋斗的目标，无论受影响的用户群如何。John Resig 在 Yahoo 上的演讲[“The DOM is Messy”](http://ejohn.org/blog/the-dom-is-a-mess/)为适应所有浏览器和配置的用户提供了一个很好的案例。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-05T04:23:17.420

没有明确的“是”或“否”答案；这完全取决于网站以及您如何使用 JavaScript。

基本上，如果您的网站要被 Google（或任何其他搜索引擎）编入索引，那么您会希望页面内容只是纯 HTML，以便任何人都可以轻松阅读它；使链接成为常规超链接而不是某些“window.navigate”脚本也是如此，因此可以适当地遵循它们。但是，如果您的“网站”实际上是一个更复杂的 Web 应用程序，那么如果您需要 JavaScript 支持，您可能能够为用户提供更好的体验；同样在这种情况下，您可能希望创建一个“移动”版本，以供不支持 JavaScript 的移动设备使用，如果这会是一个问题。

大多数情况下，需要 JavaScript 支持是可以的，但您仍然需要记住可能禁用 JavaScript 或完全不支持 JavaScript 的用户（和潜在用户）的百分比。

此外，例如，StackOverflow.com 将 JavaScript 用于您在登录时执行的操作，但不需要 JavaScript 支持即可仅查看单个页面或指向其他页面的超链接。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-05T15:47:13.220

大多数用户不是技术人员，因此他们不知道/关心什么是 javascript，所以如果它默认打开，那么这就是他们使用的。所以，如果他们看到你的网站，但它不起作用，他们就不会回来了。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-05T15:59:54.453

通常的原因是：

*   其良好的 SEO 实践，确保内容被搜索引擎正确解析和链接
*   一些支持网络的现代手机无法正确处理客户端脚本
*   508 合规性，除了有助于 SEO，在某种程度上是大多数政府项目所要求的
*   有些人只是出于某种原因将其关闭

一般规则是提供增强的功能，但对于那些不能使用增强功能集的人来说，可以优雅地降级。这意味着所有导航都应该可以在没有脚本的情况下访问，以及所有用于搜索引擎解析的内容。

想想SO。问题和答案在服务器端处理并发送到浏览器。直到最近，评论都是通过 javascript 按需检索到 Web 服务调用的。这意味着无论评论多么出色，它都不会被搜索引擎解析。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-05T16:00:02.737

想想手机，而不是人们是否打开或关闭 JS。有数以百万计的人在手机上浏览网页（当然不限于此）。仅此一项就是迎合非 JS 用户的原因。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-05T01:09:53.170

比 IE6 还早？百分之几。比 Firefox 2 还早？差不多。

您应该始终预料到那些关闭 Javascript 的人并适应那些打开它的人。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-05T01:33:48.323

对我来说，它看起来更像是产品经理做出的决定——由 PM 来决定产品的外观和目标受众是什么。作为开发人员，我所需要的只是要求“应该在每个浏览器中工作”或“应该在大多数浏览器中工作”。这不应该来自网络开发人员，除非他决定了你的产品应该是什么样子，这让他成为了 PM。这不是由开发人员争论的。

使用您的 SaaS 并为其付费的公司是一回事 - 在一个项目中，我们明确表示仅支持 IE 6-7，客户对此表示满意。可以在移动浏览器上访问的网站是另一回事。但是在移动浏览器上，仅仅没有 JS 可能还不够，您可能还需要简化页面布局并减少图形使用。如果你真的需要移动用户，你可以考虑制作两个版本的网站，全功能支持 JS 的桌面，以及移动用户的简化、缩减版。

当然，您永远不应该依赖客户端 JS 的安全性。

通常我更喜欢在没有 JS 的情况下提供大部分功能。例如，对 SO 的只读访问实际上并不需要 JS。如果他真的想发布问题，用户启用JS并不难。发布没有 JS 的问题也不是那么难，只是忘记自动加载类似的问题。

某些事情既可以在 JS 端也可以在服务器端完成，而且它通常仍然是产品特性，而不是技术决定使用哪种方式。例如，在 SO 中的投票可以在没有 JS 的情况下完成，但这会涉及页面重新加载——对用户来说更加沮丧和更多流量。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-05T16:05:57.293

我一般不接待关闭 javascript 的人，但我一定要让他们知道，因为他们关闭了它，某些功能将无法使用。

我认为如果没有 javascript，“破坏”您的网站是不可接受的，但在 imo 中，对使用您的网站所需的最低标准是可以接受的。

对于我的网站，这很有效……您的观众可能有不同的需求。

# python - 登录 mod_python/apache

> ID：822875
> 
> 赞同：1
> 
> 时间：2009-05-05T01:08:11.350
> 
> 标签：python, apache, logging, mod-python

使 python 的日志记录模块与 apache/modpython 一起工作的标准方法是什么？

我想调用 mylog.warn('whatever') 并调用 req.log_error() 其中 req 是 modpython 请求。

有没有简单的方法来设置它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T03:02:26.177

我从来没有做过，但似乎编写一个子类[`logging.Handler`](http://docs.python.org/library/logging.html#handlers)不应该那么难。像这样的东西应该可以解决问题。我不能说我实际上已经尝试过了，因为我目前没有安装 mod_python，但你应该可以打电话给`logging.root.addHandler(ApacheLogHandler())`某个地方并让它解决。YMMV。

```
import logging
import apache

class ApacheLogHandler(logging.Handler):
    LEVEL_MAP = {
        logging.DEBUG: apache.APLOG_DEBUG,
        logging.INFO: apache.APLOG_INFO,
        logging.WARNING: apache.APLOG_WARNING,
        logging.ERROR: apache.APLOG_ERR,
        logging.CRITICAL: apache.APLOG_CRIT,
        }
    def __init__(self, request=None):
        self.log_error = apache.log_error
        if request is not None:
            self.log_error = request.log_error
    def emit(self,record):
        apacheLevel = apache.APLOG_DEBUG
        if record.levelno in ApacheLogHandler.LEVEL_MAP:
            apacheLevel = ApacheLogHandler.LEVEL_MAP[record.levelno]
        self.log_error(record.getMessage(), apacheLevel) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-05T10:18:14.850

我们使用以下内容。它[在此处](http://docs.python.org/library/logging.html#module-logging)完整记录。

1.  我们将[logging.fileConfig](http://docs.python.org/library/logging.html#logging.fileConfig)与 logging.ini 文件一起使用。

2.  每个模块使用`logger= logging.getLogger(__name__)`

3.  然后我们可以在整个应用程序中执行 logger.error("blah blah blah")。

它完美地工作。logging.ini 文件定义了日志文件的位置，以便我们可以将它与我们的 Web 应用程序的其他日志文件一起保存。

# c# - 使用 C# 和 ASP.NET 的服务器端列表框可见性

> ID：822878
> 
> 赞同：1
> 
> 时间：2009-05-05T01:09:29.927
> 
> 标签：c#, asp.net, onmouseover

我有兴趣使用“onmouseover”事件使列表框出现和消失。我对 ASP.NET 很陌生，我还不想写 javascript。我正在尝试使用以下代码，它的颜色更改部分有效，但列表框可见性不起作用：

if (!IsPostBack) { Button2.Attributes.Add("onmouseover", "this.style.backgroundColor='Red', ListBox3.style.visibility='visible'"); }

```
 if (!IsPostBack)
        {
            Button2.Attributes.Add("onmouseout", "this.style.backgroundColor='Blue', ListBox3.style.visibility='hidden'");
        } 
```

我已经尝试过使用和不使用“PostBack”的代码，但仍然没有运气。有人看到我的代码在哪里失败了吗？

谢谢，

DFM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T01:12:24.943

尝试：

```
 if (!IsPostBack)
    {
        btnHide.Attributes.Add("onmouseout", "this.style.backgroundColor='Blue';ListBox3.style.display='none'");
        btnShow.Attributes.Add("onmouseover", "this.style.backgroundColor='Red';ListBox3.style.display='block'");
    } 
```

可见性属性的工作方式与显示属性稍有不同。当可见性属性设置为“隐藏”时，元素被隐藏但布局不受影响，而当将显示属性设置为“无”时，会完全删除可能影响布局的元素。

如果您确实希望在*不*影响布局的情况下修改列表的可见性，您可以使用 div 作为包装器，然后修改其可见性属性。

```
<div id="wrapper">          
    <asp:ListBox ID="ListBox3" runat="server"></asp:ListBox>            
</div>
<asp:Button ID="btnShow" runat="server" Text="Button" />
<asp:Button ID="btnHide" runat="server" Text="Button" /> 
```

修改 ASPX 以切换包含列表框的 div 元素的可见性属性。

```
if (!IsPostBack)
{
    btnHide.Attributes.Add("onmouseout", "this.style.backgroundColor='Blue';wrapper.style.visibility='hidden'");
    btnShow.Attributes.Add("onmouseover", "this.style.backgroundColor='Red';   wrapper.style.visibility='visible'");
} 
```

# c# - 在 Silverlight 中创建“联系人列表”的最佳方法是什么？

> ID：822879
> 
> 赞同：0
> 
> 时间：2009-05-05T01:09:37.853
> 
> 标签：c#, silverlight

我正在尝试创建一个 Silverlight 应用程序，它可以提取我的 Flickr 联系人和照片。我希望它们“很好地”显示。我打算创建一个控件，在他们的名字旁边显示用户和他们的图像。我希望每个用户一个接一个地列出。像这样的东西：

```
----------------------------
User Name: <Photo> <Photo>
           <Photo> <Photo>
----------------------------
User Name: <Photo> <Photo>
           <Photo> <Photo>
----------------------------
User Name: <Photo> <Photo>
           <Photo> <Photo>
----------------------------
User Name: <Photo> <Photo>
           <Photo> <Photo>
----------------------------
User Name: <Photo> <Photo>
           <Photo> <Photo>
---------------------------- 
```

我希望能够动态创建它并在需要时显示滚动条。（因此用户可以上下滚动）。

创建这样的东西的最佳方法是什么？是否有我应该遵循的控制或技术？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T02:23:55.287

你想要一个列表框。事实上，多个嵌套列表框。

首先，将您的数据放入一个可以很好地与 Silverlight 配合使用的结构中（我在这里假设为 Silverlight2）。为此，我会使用

```
ObservableCollection<Contact> 
```

其中 Contact 是代表一个联系人的类。该类应该有一个

```
ObservableCollection<FlickrPhoto> 
```

作为财产。

这是 XAML 的结构。您可能希望将模板移到资源中，或者创建一个用户控件来保存每个列表项。

```
<!-- needs the SilverlightToolkit for WrapPanel -->
<!-- xmlns:tk="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit" -->

<ListBox ItemsSource="{Binding}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid Width="400">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding UserName}"/>
                <ListBox 
                    Grid.Column="1" 
                    ItemsSource="{Binding FlickrPhotos}"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListBox.ItemsPanel>
                        <ItemsPanelTemplate>
                            <tk:WrapPanel/>
                        </ItemsPanelTemplate>
                    </ListBox.ItemsPanel>
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Image Source="{Binding Photo}" Width="80"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

笔记：

*   此代码只是一个非常粗略的示例
*   您需要禁用列表框上的水平滚动条以强制 WrapPanel 换行。
*   您需要将外部列表框（或祖先控件）的 DataContext 设置为您的联系人集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T02:34:12.440

一旦您了解了模板，这种布局在 Silverlight 中很容易。

如果您曾经使用过 ASP.net，请考虑使用类固醇的中继器（或者可能是最近版本中的 ListView）。

基本上你想要的是一个列表框，它用你的特定“模板”（用户名和四张照片）显示每个项目。

因此，假设您将列表框的 ItemsSource 属性设置为带有 UserName 属性的对象集合，以及 Photo1 到 Photo4：

```
<ListBox x:Name="Photos">
  <ListBox.ItemTemplate>
    <DataTemplate>
      <YOUR_ITEM_LAYOUT_HERE />
    </DataTemplate>
  </ListBox.ItemTemplate>
</ListBox> 
```

Where`<YOUR_ITEM_LAYOUT_HERE />`替换为您想要的一项（用户名和四张照片）的实际布局。

希望有帮助。如果您需要更多信息，请发表评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T01:45:49.357

这篇关于 Silverlight 和 Flicker 的文章可能会对您有所帮助[。](http://blogs.msdn.com/brada/archive/2008/04/25/silverlight-flickr-example.aspx)

至于用户控件的样式，您看过[MIX 视频](http://videos.visitmix.com/MIX09/All)吗？

# c - glibc 从哪里获得其 unicode 属性数据库？

> ID：822884
> 
> 赞同：6
> 
> 时间：2009-05-05T01:10:54.153
> 
> 标签：c, linux, open-source, unicode, glibc

glibc 从哪里获得它的 unicode 属性数据库，例如，`wcwidth()`？我有兴趣更正一些错误的条目，但我似乎无法找到这些信息在其源代码分发中的位置。

如果重要的话，我主要在 debian 或 ubuntu linux 下对此感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T04:27:43.470

看起来数据是由（显然是手动运行的）localedata/gen-unicode-ctype.c 从[http://unicode.org/Public/UNIDATA/](http://unicode.org/Public/UNIDATA/)上发布的 unicode 数据文件生成的。感谢 Naaff 为我指明了正确的方向！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T03:11:33.457

好的，所以我只是在自己周围摸索，所以我不确定，但是您要查找的表似乎位于相对于 glibc 根目录的以下位置：

```
localedata/locales/i18n 
```

这似乎是 Unicode（版本 5）语言环境。它包含以下内容，我认为您需要在其中进行更改：

```
% ENCLOSED ALPHANUMERICS/
   <U24D0>..<U24E9>;/ 
```

如果您想知道，函数 ctype_output (ld-ctype.c) 调用 allocate_arrays，后者调用 wcwidth_table_init。函数 wcwidth_table_init 由 3level.h 生成（它还生成遵循相同模板的其他表）。这是我跟踪 localedate/locales 中文件的链条。

就像我说的，我不能 100% 确定这是正确的桌子，但我想我会分享我发现的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T02:44:59.700

我相信它是在语言环境定义文件中定义的。有关语言环境的更多信息，请参阅[此页面](http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap07.html)。glibc 在 中包含一堆语言环境定义`localedate/locales`，尽管它们似乎都没有任何宽度信息。

# java - 如何创建自定义 Swing 组件

> ID：822899
> 
> 赞同：38
> 
> 时间：2009-05-05T01:19:23.400
> 
> 标签：java, swing, jcomponent

我一直想用 Java 创建自定义组件，或者自定义现有的组件，但我的搜索从未产生任何有用的结果。所以我决定问问 StackOverflow 社区：

**在哪里可以找到有关自定义 Java GUI 组件的一般信息？**

当我指的是定制时，我不是在谈论改变颜色、字体等。我的意思是**真正**定制它们。以下是两个样机示例组件：

![自定义组件样机](https://i.stack.imgur.com/t36RA.jpg)

**笔记**
我开始这个问题主要是为了找到如何创建上述两个自定义组件。但后来我意识到没有关于破解挥杆组件的普遍问题。所以我认为最好有一个资源列表。

如果您想知道模型中的两个组件是如何工作的，这里是：

一个自定义的 JScrollPane，每个方向都有两个滚动条。每个滚动条可以有不同的作用。例如，外部的滚动正常，内部的以更[类似于 Picasa](http://picasa.google.com/)的方式移动视图。[实际上，我从这里](http://groups.google.com/group/comp.lang.java.programmer/browse_thread/thread/7a3c3558d7924661/11e7beb95c003575?#11e7beb95c003575)的 google groups 得到了一个有效的（！）答案，但这只是代码。

第二个是自定义的 JComboBox，当弹出列表展开时，它的末尾有一个 JComponent。这可以是任何东西，从带有图标的简单 JLabel 到以某种方式操作列表的 JButton。

但是这个问题与那些特定的组件无关。它是关于**寻找资源（网站、书籍、文章等）来学习如何创建它们**。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-06-24T14:24:30.663

这篇文章[How To Write a Custom Swing Component](https://web.archive.org/web/20131027161222/http://today.java.net/pub/a/today/2007/02/22/how-to-write-custom-swing-component.html)应该很有帮助。它涵盖了复制具有离散步骤和连续范围的 Windows 滑块控件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-05T02:53:15.670

JDK 是开源的。要了解如何编写 Swing 组件，没有比 Swing 组件的源代码更好的地方了。通常，当您创建自定义组件时，您会对以下一项或多项感兴趣：{交互语义、视觉表示、组合结构}

从最简单的情况开始：

被动组件：`JLabel`
交互组件：`JButton`

`JLabel`将演示`JComponent`用于自定义绘制组件的准系统扩展；在这种情况下，它正在绘制“文本”字符串值作为其表示。

`JButton`除了绘制组件之外，还将演示用于用户交互的准系统扩展。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-07T05:21:51.973

[《肮脏的富客户](http://filthyrichclients.org/)》是一本关于这个主题的优秀、可读性强的书。它更多是关于改进 Swing 组件的外观和感觉，而不是创建全新的组件，但它确实深入到了 Swing 的核心并提供了许多实际示例。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T01:47:28.527

这是一个非常开放的问题，简短的回答是您[`JComponent`](http://java.sun.com/javase/6/docs/api/javax/swing/JComponent.html)继承或其中一个后代并添加您需要的功能。显然，根据您想要执行的操作，难度可能会有所不同。对于初学者，我建议您阅读 Sun[关于使用 Swing 组件的教程，](http://java.sun.com/docs/books/tutorial/uiswing/components/index.html)其中包含有关如何使用[滚动窗格](http://java.sun.com/docs/books/tutorial/uiswing/components/scrollpane.html)和[弹出菜单](http://java.sun.com/docs/books/tutorial/uiswing/components/menu.html#popup)的示例。一旦您通读了这些并进行了实验，您可能会遇到更具体的问题，人们更容易提供经过深思熟虑的答案。

如果您的模型中的两个组件都是您想要实现的，那么让我们更好地了解您希望它们如何运作将产生更好的答案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-23T16:30:10.603

我个人认为上述答案过于笼统或含糊。另外，由于有人不可避免地会像我一样碰到这个线程，我不妨提供我发现的内容：

*   [CodeProject 上的教程](http://www.codeproject.com/Articles/62099/UI-Component-Development-in-Java-Swing-Part-1-Desi)，以及，

*   [建立在前者之上的另一个博客条目](http://jhippjava.blogspot.cz/2011/11/creating-custom-swing-component.html)。

希望这可以帮助...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T05:07:59.510

阅读[Swing Hacks：构建杀手 GUI 的技巧和工具（Marinacci，Adamson）](http://oreilly.com/catalog/9780596009076/)。恕我直言，这是一本有效使用 Swing 的必备书籍。

# xampp - 从 Internet 访问 XAMPP 本地主机

> ID：822902
> 
> 赞同：65
> 
> 时间：2009-05-05T01:20:18.653
> 
> 标签：xampp, ip-address, static-ip-address

我在本地笔记本电脑上安装了 XAMPP。而且我有一个几乎静态的IP。我想将 ip 提供给其他人以从他们的浏览器运行它。我配置了 apache httpd-vhosts.conf 来监听我的 ip 地址：80 并将具有 ip 地址和域根的虚拟服务器添加到本地 httdocs 目录和服务器名称为 localhost。阿帕奇没有启动。我应该怎么做才能从外部计算机访问我的网站。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-05-05T03:02:12.590

首先，您需要将计算机配置为从路由器获取静态 IP。可以找到有关如何执行此操作的说明：[这里](http://www.hotcomm.com/FAQ/FAQ_staticIPXP.asp)

例如，假设您选择了 IP 地址 192.168.1.102。完成上述步骤后，您应该可以通过访问[http://localhost](http://localhost)和[http://192.168.1.102](http://192.168.1.102)访问本地计算机上的网站，因为您的计算机现在将始终拥有该 IP 地址网络。

如果您查找您的 IP 地址（例如[http://www.ip-adress.com/](http://www.ip-adress.com/)），您看到的 IP 实际上是您的路由器的 IP。当你的朋友访问你的网站时，你会给他这个IP。但是，您需要告诉您的路由器，当它收到对网页的请求时，将该请求转发到您的服务器。这是通过端口转发完成的。

可以在[此处](http://www.zeropaid.com/news/6160/introduction_to_port_forwarding/)和[此处](http://www.youtube.com/watch?v=GWPUdW1kIJA)找到有关如何执行此操作的两个示例，尽管您看到的确切屏幕会因路由器制造商而异（如果需要，请通过 Google 获取确切说明）。

对于我拥有的 Linksys 路由器，我输入[http://192.168.1.1/](http://192.168.1.1/)，输入我的用户名/密码，应用程序和游戏选项卡 > 端口范围转发。输入应用程序名称（随便你怎么称呼它）、起始端口（80）、结束端口（80）、协议（TCP）、IP地址（使用上面的例子，你将输入192.168.1.102，这是静态IP您分配了您的服务器），并确保选中以启用转发。重新启动路由器，更改应生效。

完成所有这些后，您的朋友现在应该能够通过访问他机器上的网络浏览器并输入[http://IP.address.of.your.computer](http://IP.address.of.your.computer)来访问您的网页（与您在[此处](http://www.ip-adress.com/)看到的相同） .

如前所述，无论您是否离线登录，您的 ISP 分配给您的 IP 地址最终都会改变。我*强烈*推荐使用完全免费的 DynDns。您可以在他们的域中选择一个主机名（例如 cuga.kicks-ass.net），然后您的朋友只需在浏览器中访问[http://cuga.kicks-ass.net即可随时访问您的网站。](http://cuga.kicks-ass.net)这是他们的网站：[DynDns](http://www.dyndns.com/services/dns/dyndns/)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2016-02-29T18:50:53.960

我想您可以在 5 分钟内完成此操作，而无需任何进一步的 IP/端口转发，以临时显示您的本地网站。

所有你需要做的，去[http://ngrok.com](http://ngrok.com) 下载小工具解压并以管理员身份运行该工具 [![在此处输入图像描述](https://i.stack.imgur.com/C2EMF.png)](https://i.stack.imgur.com/C2EMF.png)

输入命令
`ngrok http 80`

你会看到它会连接到服务器，并会为你创建一个临时 URL，你可以分享给你的朋友，让他浏览 localhost 或它的任何文件夹。

你可以在这里看到详细的过程。 [如何从另一台计算机访问/共享 xampp 或 localhost 网站](http://www.inteligentcomp.com/2016/02/access-share-xampp-localhost-on-internet.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T17:15:48.677

我知道这很古老，但为了未来：

我还使用了动态 dns 提供程序。想在我的（家庭）路由器**后面测试网站（IIS）。**所以我想我使用这样的东西：

my.dynamic.dnss.ip:8080 （因为我的路由器的端口 80 用于管理它）。

所以这似乎是唯一的解决方案。
**但是**：Paypal 似乎不喜欢端口 8080：只允许端口 80 和 443（不知道为什么！！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-29T12:39:33.767

您必须在路由器中打开服务端口，然后尝试将您的公共 ip 从您的所有网络中尝试，因为如果您从您的网络尝试，公共 ip 将始终将您重定向到您的路由器，但从外部它将重定向到你有的服务器

# iphone - 如何让 CoreData Debug 参数输出到控制台？

> ID：822906
> 
> 赞同：33
> 
> 时间：2009-05-05T01:21:12.723
> 
> 标签：iphone, cocoa, debugging, sqlite, core-data

根据[Apple 关于调试 Core Data 的文档，](http://developer.apple.com/documentation/Cocoa/Conceptual/CoreData/Articles/cdTroubleshooting.html#//apple_ref/doc/uid/TP40002320-SW15)它说我们应该能够将参数传递给应用程序，该应用程序将输出发送到 SQLite 的 SQL 核心数据。

我已经进入 XCode 中可执行文件的参数选项卡并指定了参数：

```
-com.apple.CoreData.SQLDebug 1 
```

但是，我在控制台中看不到 SQL。然后，我尝试在 Apple 提供的 CoreDataBooks 应用程序中使用此参数，以防我的程序中出现其他问题。

即使在 Apple 的示例中，我在控制台中也没有得到 SQL 输出。

难道我做错了什么？苹果的文档有错吗？我应该寻找控制台以外的其他地方吗？有没有其他人在这个论点上取得成功？

**更新：** Apple 已经用较新版本的 XCode 修复了输出错误；但是，要明确最终解决方案：

**参数是两个单独的参数，因此应在参数选项卡中输入。-com.apple.CoreData.SQLDebug 是一个参数，值 1 是第二个参数。**

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2011-03-13T12:12:03.070

XCode 4 (final) 似乎不一致。

使用一个参数在设备上有效，但在模拟器中失败：

`-com.apple.CoreData.SQLDebug 1`

使用两个参数适用于设备和模拟器：

`-com.apple.CoreData.SQLDebug`

`1`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T01:29:26.883

您是否将这些作为单个参数输入？它应该是 2 个参数：“-com.apple.CoreData.SQLDebug”和“1”。

更多信息：您实际上在这里覆盖了“默认值”。查看[有关基于参数的默认值的 Apple Docs 以](http://developer.apple.com/documentation/Cocoa/Conceptual/UserDefaults/Concepts/DefaultsDomains.html#//apple_ref/doc/uid/20000718-96930)获取更多信息。您会看到名称和值是 2 个单独的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-04T16:51:34.067

我也用头撞了一会儿。原来 iPhone 上还不支持使用 Core Data 的 SQLDebug。它由 Apple 错误 ID [6868205](https://bugreport.apple.com/cgi-bin/WebObjects/RadarWeb.woa/112/wo/j2wxWIapgEsau7DHNStox0/7.56)跟踪。

# xml - 如何使用 PowerShell 针对 XSD 验证 XML 文件？

> ID：822907
> 
> 赞同：31
> 
> 时间：2009-05-05T01:21:50.630
> 
> 标签：xml, powershell, xsd

作为我开发的一部分，我希望能够针对单个 XSD 文件验证整个文件夹的 XML 文件价值。PowerShell 函数似乎是一个很好的候选者，因为我可以像这样通过管道将文件列表传递给它： dir *.xml | Validate-Xml -Schema .\MySchema.xsd

我已经考虑从[Validating an Xml against Referenced XSD in C#](https://stackoverflow.com/questions/751511/validating-an-xml-against-referenced-xsd-in-c)问题中移植 C# 代码，但我不知道如何在 PowerShell 中添加处理程序。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-05-17T22:01:38.867

我想评论一下，当前接受的答案中的脚本不会验证有关`xs:sequence`. 例如：test.xml

```
<addresses xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation='test.xsd'>
  <address>
    <street>Baker street 5</street>
    <name>Joe Tester</name>
  </address>
</addresses> 
```

测试.xsd

```
<xs:schema xmlns:xs='http://www.w3.org/2001/XMLSchema'>    
<xs:element name="addresses">
      <xs:complexType>
       <xs:sequence>
         <xs:element ref="address" minOccurs='1' maxOccurs='unbounded'/>
       </xs:sequence>
     </xs:complexType>
    </xs:element>

     <xs:element name="address">
      <xs:complexType>
       <xs:sequence>
         <xs:element ref="name" minOccurs='0' maxOccurs='1'/>
         <xs:element ref="street" minOccurs='0' maxOccurs='1'/>
       </xs:sequence>
      </xs:complexType>
     </xs:element>

     <xs:element name="name" type='xs:string'/>
     <xs:element name="street" type='xs:string'/>
    </xs:schema> 
```

我写了另一个版本可以报这个错误：

```
function Test-XmlFile
{
    <#
    .Synopsis
        Validates an xml file against an xml schema file.
    .Example
        PS> dir *.xml | Test-XmlFile schema.xsd
    #>
    [CmdletBinding()]
    param (     
        [Parameter(Mandatory=$true)]
        [string] $SchemaFile,

        [Parameter(ValueFromPipeline=$true, Mandatory=$true, ValueFromPipelineByPropertyName=$true)]
        [alias('Fullname')]
        [string] $XmlFile,

        [scriptblock] $ValidationEventHandler = { Write-Error $args[1].Exception }
    )

    begin {
        $schemaReader = New-Object System.Xml.XmlTextReader $SchemaFile
        $schema = [System.Xml.Schema.XmlSchema]::Read($schemaReader, $ValidationEventHandler)
    }

    process {
        $ret = $true
        try {
            $xml = New-Object System.Xml.XmlDocument
            $xml.Schemas.Add($schema) | Out-Null
            $xml.Load($XmlFile)
            $xml.Validate({
                    throw ([PsCustomObject] @{
                        SchemaFile = $SchemaFile
                        XmlFile = $XmlFile
                        Exception = $args[1].Exception
                    })
                })
        } catch {
            Write-Error $_
            $ret = $false
        }
        $ret
    }

    end {
        $schemaReader.Close()
    }
} 
```

PS C:\temp\lab-xml-validation> 目录 test.xml | 测试 XML 文件 test.xsd

```
System.Xml.Schema.XmlSchemaValidationException: The element 'address' has invalid child element 'name'.
... 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-05T01:30:17.913

[PowerShell 社区扩展](https://github.com/Pscx/Pscx)有一个 Test-Xml cmdlet。唯一的缺点是扩展暂时没有更新，但大多数都可以在最新版本的 powershell（包括 Test-Xml）上工作。只需执行 Get-Childitem 并将列表传递给 foreach，在每个上调用 Test-Xml。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-05T02:16:47.910

我编写了一个 PowerShell 函数来执行此操作：

用法：

目录 *.xml | Test-Xml -Schema ".\MySchemaFile.xsd" -Namespace " [http://tempuri.org](http://tempuri.org) "

代码：

```
function Test-Xml {
param(
    $InputObject = $null,
    $Namespace = $null,
    $SchemaFile = $null
)

BEGIN {
    $failCount = 0
    $failureMessages = ""
    $fileName = ""
}

PROCESS {
    if ($InputObject -and $_) {
        throw 'ParameterBinderStrings\AmbiguousParameterSet'
        break
    } elseif ($InputObject) {
        $InputObject
    } elseif ($_) {
        $fileName = $_.FullName
        $readerSettings = New-Object -TypeName System.Xml.XmlReaderSettings
        $readerSettings.ValidationType = [System.Xml.ValidationType]::Schema
        $readerSettings.ValidationFlags = [System.Xml.Schema.XmlSchemaValidationFlags]::ProcessInlineSchema -bor
            [System.Xml.Schema.XmlSchemaValidationFlags]::ProcessSchemaLocation -bor 
            [System.Xml.Schema.XmlSchemaValidationFlags]::ReportValidationWarnings
        $readerSettings.Schemas.Add($Namespace, $SchemaFile) | Out-Null
        $readerSettings.add_ValidationEventHandler(
        {
            $failureMessages = $failureMessages + [System.Environment]::NewLine + $fileName + " - " + $_.Message
            $failCount = $failCount + 1
        });
        $reader = [System.Xml.XmlReader]::Create($_, $readerSettings)
        while ($reader.Read()) { }
        $reader.Close()
    } else {
        throw 'ParameterBinderStrings\InputObjectNotBound'
    }
}

END {
    $failureMessages
    "$failCount validation errors were found"
}
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-24T14:47:58.687

我正在使用这个简单的代码段，它总是有效的，你不需要复杂的功能。在这个示例中，我正在加载配置 xml，其中包含稍后用于部署和服务器配置的数据：

```
# You probably don't need this, it's just my way
$script:Context = New-Object -TypeName System.Management.Automation.PSObject
Add-Member -InputObject $Context -MemberType NoteProperty -Name Configuration -Value ""
$ConfigurationPath = $(Join-Path -Path $PWD -ChildPath "Configuration")

# Load xml and its schema
$Context.Configuration = [xml](Get-Content -LiteralPath $(Join-Path -Path $ConfigurationPath -ChildPath "Configuration.xml"))
$Context.Configuration.Schemas.Add($null, $(Join-Path -Path $ConfigurationPath -ChildPath "Configuration.xsd")) | Out-Null

# Validate xml against schema
$Context.Configuration.Validate(
    {
        Write-Host "ERROR: The Configuration-File Configuration.xml is not valid. $($_.Message)" -ForegroundColor Red

        exit 1
    }) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-09-04T08:34:31.750

(Flatliner DOA) 的解决方案在 PSv2 上运行良好，但在 Server 2012 PSv3 上运行良好。

(wangzq) 的解决方案正在 PS2 和 PS3 上运行！！

任何需要在 PS3 上进行 xml 验证的人都可以使用它（基于 wangzq 的功能）

```
function Test-Xml {
    param (
    [Parameter(ValueFromPipeline=$true, Mandatory=$true)]
        [string] $XmlFile,

        [Parameter(Mandatory=$true)]
        [string] $SchemaFile
    )

    [string[]]$Script:XmlValidationErrorLog = @()
    [scriptblock] $ValidationEventHandler = {
        $Script:XmlValidationErrorLog += $args[1].Exception.Message
    }

    $xml = New-Object System.Xml.XmlDocument
    $schemaReader = New-Object System.Xml.XmlTextReader $SchemaFile
    $schema = [System.Xml.Schema.XmlSchema]::Read($schemaReader, $ValidationEventHandler)
    $xml.Schemas.Add($schema) | Out-Null
    $xml.Load($XmlFile)
    $xml.Validate($ValidationEventHandler)

    if ($Script:XmlValidationErrorLog) {
        Write-Warning "$($Script:XmlValidationErrorLog.Count) errors found"
        Write-Error "$Script:XmlValidationErrorLog"
    }
    else {
        Write-Host "The script is valid"
    }
}

Test-Xml -XmlFile $XmlFile -SchemaFile $SchemaFile 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-08T15:47:16.020

我创建了一个单独的 PowerShell 文件，它可以使用内联架构引用对 XML 文件执行 XSD 验证。效果很好。下载和操作方法可在[https://knowledge.zomers.eu/PowerShell/Pages/How-to-validate-XML-against-an-XSD-schema-using-PowerShell.aspx](https://knowledge.zomers.eu/PowerShell/Pages/How-to-validate-XML-against-an-XSD-schema-using-PowerShell.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-02-11T15:51:32.293

我意识到这是一个老问题，但是我尝试了提供的答案，但无法让它们在 Powershell 中成功工作。

我创建了以下函数，它使用了这里描述的一些技术。我发现它非常可靠。

我之前必须在不同时间验证 XML 文档，但是我总是发现行号为 0。看来`XmlSchemaException.LineNumber`只有在加载文档时才可用。

如果您之后使用该`Validate()`方法进行验证，`XmlDocument`则 LineNumber/LinePosition 将始终为 0。

相反，您应该在阅读时进行验证`XmlReader`，并将验证事件处理程序添加到脚本块。

```
Function Test-Xml()
{
    [CmdletBinding(PositionalBinding=$false)]
    param (
    [Parameter(ValueFromPipeline=$true, Mandatory=$true)]
        [string] [ValidateScript({Test-Path -Path $_})] $Path,

        [Parameter(Mandatory=$true)]
        [string] [ValidateScript({Test-Path -Path $_})] $SchemaFilePath,

        [Parameter(Mandatory=$false)]
        $Namespace = $null
    )

    [string[]]$Script:XmlValidationErrorLog = @()
    [scriptblock] $ValidationEventHandler = {
        $Script:XmlValidationErrorLog += "`n" + "Line: $($_.Exception.LineNumber) Offset: $($_.Exception.LinePosition) - $($_.Message)"
    }

    $readerSettings = New-Object -TypeName System.Xml.XmlReaderSettings
    $readerSettings.ValidationType = [System.Xml.ValidationType]::Schema
    $readerSettings.ValidationFlags = [System.Xml.Schema.XmlSchemaValidationFlags]::ProcessIdentityConstraints -bor
            [System.Xml.Schema.XmlSchemaValidationFlags]::ProcessSchemaLocation -bor 
            [System.Xml.Schema.XmlSchemaValidationFlags]::ReportValidationWarnings
    $readerSettings.Schemas.Add($Namespace, $SchemaFilePath) | Out-Null
    $readerSettings.add_ValidationEventHandler($ValidationEventHandler)
    try 
    {
        $reader = [System.Xml.XmlReader]::Create($Path, $readerSettings)
        while ($reader.Read()) { }
    }

    #handler to ensure we always close the reader sicne it locks files
    finally 
    {
        $reader.Close()
    }

    if ($Script:XmlValidationErrorLog) 
    {
        [string[]]$ValidationErrors = $Script:XmlValidationErrorLog
        Write-Warning "Xml file ""$Path"" is NOT valid according to schema ""$SchemaFilePath"""
        Write-Warning "$($Script:XmlValidationErrorLog.Count) errors found"
    }
    else 
    {
        Write-Host "Xml file ""$Path"" is valid according to schema ""$SchemaFilePath"""
    }

    Return ,$ValidationErrors #The comma prevents powershell from unravelling the collection http://bit.ly/1fcZovr
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-22T13:01:18.837

我重写了它（我知道坏习惯），但是@Flatliner_DOA 的起始脚本太好了，不能完全丢弃。

```
function Test-Xml {
[cmdletbinding()]
param(
    [parameter(mandatory=$true)]$InputFile,
    $Namespace = $null,
    [parameter(mandatory=$true)]$SchemaFile
)

BEGIN {
    $failCount = 0
    $failureMessages = ""
    $fileName = ""
}

PROCESS {
    if ($inputfile)
    {
        write-verbose "input file: $inputfile"
        write-verbose "schemafile: $SchemaFile"
        $fileName = (resolve-path $inputfile).path
        if (-not (test-path $SchemaFile)) {throw "schemafile not found $schemafile"}
        $readerSettings = New-Object -TypeName System.Xml.XmlReaderSettings
        $readerSettings.ValidationType = [System.Xml.ValidationType]::Schema
        $readerSettings.ValidationFlags = [System.Xml.Schema.XmlSchemaValidationFlags]::ProcessIdentityConstraints -bor
            [System.Xml.Schema.XmlSchemaValidationFlags]::ProcessSchemaLocation -bor 
            [System.Xml.Schema.XmlSchemaValidationFlags]::ReportValidationWarnings
        $readerSettings.Schemas.Add($Namespace, $SchemaFile) | Out-Null
        $readerSettings.add_ValidationEventHandler(
        {
            try {
                $detail = $_.Message 
                $detail += "`n" + "On Line: $($_.exception.linenumber) Offset: $($_.exception.lineposition)"
            } catch {}
            $failureMessages += $detail
            $failCount = $failCount + 1
        });
        try {
            $reader = [System.Xml.XmlReader]::Create($fileName, $readerSettings)
            while ($reader.Read()) { }
        }
        #handler to ensure we always close the reader sicne it locks files
        finally {
            $reader.Close()
        }
    } else {
        throw 'no input file'
    }
}

END {
    if ($failureMessages)
    { $failureMessages}
    write-verbose "$failCount validation errors were found"

}
}

#example calling/useage  code follows:
$erroractionpreference = 'stop'
Set-strictmode -version 2

$valid = @(Test-Xml -inputfile $inputfile -schemafile $XSDPath )
write-host "Found ($($valid.count)) errors"
if ($valid.count) {
    $valid |write-host -foregroundcolor red
} 
```

该函数不再使用管道作为使用文件路径的替代方法，这是该用例不需要的复杂功能。随意破解开始/处理/结束处理程序。

# asp.net - Linq to SQL、Ajax 回发和 ASP.NET 中的页面状态

> ID：822921
> 
> 赞同：1
> 
> 时间：2009-05-05T01:30:18.210
> 
> 标签：asp.net, linq-to-sql, session-state

这必须是一个常见的问题，但似乎还没有。我正在将 Linq to SQL 用于允许对我的内存模型进行各种数据更改的应用程序，然后这些更改将被放入队列中以进行异步处理。所以，我不担心更新（还）。可以通过网页上的模式弹出窗口对数据的各个部分进行更改。有些是基于网格的，有些只是属性。我遇到了更改无法在回发周期中幸存的问题。显然，在进行所有更改并且用户提交页面之前，我不想将任何内容持久化到数据库中。

到目前为止我选择的路线是：

*   我禁用了延迟加载
*   我为我的根对象创建了一个 [serializable] 部分类
*   我将东西放入会话并在 onload 事件中检索它

这似乎在原则上有效。但是，当我在从会话中检索对象后尝试更新某些子项的属性时

```
p.PhysicianSpecialties[0].physician_specialty_code = 
    ddlSpecialty.SelectedItem.Value; 
```

我收到此错误：

```
Operation is not valid due to the current state of the object. 
```

该错误是由生成的 Linq setter 方法中的此方法调用引起的：

```
this.SendPropertyChanging(); 
```

其他属性更新得很好：

```
p.PhysicianNames[0].first_name = txtFirstName.Text.ToUpper(); 
```

这不会导致错误。

我的问题：我是否从根本上走错了路？有没有更好的方法来做到这一点？是什么导致错误？

更新：例外是“System.Data.Linq.ForeignKeyReferenceAlreadyHasValueException”。我想[我正在做某事](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/f9c4a01a-195a-4f2b-a1cb-e2fa06e28b25)，但我还不知道解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T02:07:23.673

我从 MSDN 获得了解决方案。问题是，[在这个线程](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/f9c4a01a-195a-4f2b-a1cb-e2fa06e28b25)中解释得比我能做的更好，一个人不能单方面改变关联，但必须在两端都这样做，通过分配一个新的子对象，而不仅仅是通过改变 id：

p.PhysicianSpecialties[0].PhysicianSpecialtyLookup = db.PhysicianSpecialtyLookups.Single(c => (c.physician_specialty_code == ddlSpecialty.SelectedItem.Value));

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T22:08:09.920

如果使用数据绑定，该怎么做呢？我在数据网格视图中有一个下拉列表，当我更改下拉值时开始抛出此错误。这让我觉得我必须要么删除关联，要么不使用数据绑定。

# javascript - 在javascript中剪切字符串并分配到数组中

> ID：822930
> 
> 赞同：2
> 
> 时间：2009-05-05T01:34:34.407
> 
> 标签：javascript

有谁知道我怎样才能剪切一个字符串，然后用javascript分配到一个数组中？例子：

变量字符串 = "15;24;67;34;56";

我希望 tp 将此字符串切割成以下格式并分配到数组中：

a[0] = 15 a[1] = 24 a[2] = 67 a[3] = 34 a[3] = 56

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T01:36:56.257

`var a = string.split(';');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T01:38:14.943

string.split(";")

不过，在本例中，您最终会得到一个额外的数组项，因此您需要单独处理它。

# unit-testing - 涉及外键插入的操作在单元测试阶段导致问题

> ID：822937
> 
> 赞同：0
> 
> 时间：2009-05-05T01:38:08.907
> 
> 标签：unit-testing, orm

我有以下架构：

```
create table statuslookup
{
  statusid int primary key,
  statusname string unique,
  description string
}

create table job
{
  jobid int primary key,
  jobname string unique,
  status_id foreign key reference statuslookup(statusid)
} 
```

当然，该表`statuslookup`将在模式设置期间预先填充，以便稍后我们在 table 中创建条目时`job`，我们可以引用它而不会出现外键错误。要在表中添加一个条目`job`，我们只需要使用一个简单的`insert command`：

```
job = new job();
job.jobname="mytest";
job.status_id=2; 
```

到目前为止一切顺利.. 它可以在生产环境中使用！

唯一的问题是在单元测试阶段。我测试了数据访问层，在测试开始时，数据库将被清除并重新填充初始数据。但问题是每次重新填充完成时，`statusid`and`jobid`都会增加。所以在单元测试中不能再像以前那样插入，因为`statusid`一直在变化。

我正在考虑改变我`insert statement`的，以便它对单元测试更友好..有什么想法吗？

**编辑：这应该是一个与数据库/ ORM 无关的问题。因为我使用 SQL server、MYSQL、MS Access 和 Propel、NHibernate 等。所以我想要一个可以应用于每种情况的通用解决方案。**

**编辑 2：插入标识字段值似乎不起作用。因为当您（通过 ORM）填充表时，您不能指定身份字段值，至少 Propel 不允许这样做。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T02:12:32.570

您的数据库是否支持插入身份字段？这是最明显的答案（在单元测试中使用已知 ID 填充状态表）。

# web-services - 子网站中的共享点 Web 服务

> ID：822941
> 
> 赞同：2
> 
> 时间：2009-05-05T01:38:22.433
> 
> 标签：web-services, sharepoint

我正在尝试构建一个对子Web 上下文敏感的Web 服务（即，它公开了一个WebMethod，该WebMethod 需要能够触摸特定子Web 中的列表）。

我已经使用以下文件部署了 Web 应用程序：

```
ISAPI/MyService.asmx
ISAPI/MyServiceWsdl.aspx
ISAPI/MyServiceDisco.aspx 
```

代码隐藏：

```
[WebService]
public class MyService : System.Web.Services.WebService
{
    [WebMethod]
    public ListSettings GetListSettings(string listName)
    {
        SPWeb site = SPControl.GetContextWeb(this.Context);
        SPList list = site.Lists[listName];

        return new ListSettings(list);
    }

    [WebMethod]
    public void UpdateListSettings(string listName, ListSettings settings)
    {
        SPWeb site = SPControl.GetContextWeb(this.Context);
        SPList list = site.Lists[listName];

        list.EnableFolderCreation = settings.EnableFolders;
        list.Update();
    }
}

public class ListSettings
{
    public ListSettings() { }

    internal ListSettings(SPList list)
    {
        EnableFolders = list.EnableFolderCreation;
    }

    public bool EnableFolders { get; set; }
} 
```

这似乎在我的网站集的根网站上工作得很好。但是，当我向[http://moss/subweb/_vti_bin/MyService.asmx](http://moss/subweb/_vti_bin/MyService.asmx)发出请求并在断点处停止 Web 方法以检查 HttpContext 时，我发现已向[http://moss/_vti_bin发出请求/MyService.asmx](http://moss/_vti_bin/MyService.asmx)。

我阅读了一些资源，这些资源描述了 WSDL/disco 文件和 ISAPI 中的 spdisco.aspx 文件中所需的调整，并进行了我应该做的调整。像这样：

在 MyServiceDisco.aspx 中：

```
<%@ Page Inherits="System.Web.UI.Page" Language="C#" %>
<%@ Assembly Name="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Import Namespace="Microsoft.SharePoint.Utilities" %>
<%@ Import Namespace="Microsoft.SharePoint" %>
<% Response.ContentType = "text/xml"; %>

<discovery xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/disco/">
  <contractRef ref=<% SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request) + "?wsdl", '"'); %> 
            docRef=<% SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request), '"'); %> 
            xmlns="http://schemas.xmlsoap.org/disco/scl/" />
  <soap address=<% SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request), '"'); %> 
        xmlns:q1="http://tempuri.org/" binding="q1:MyServiceSoap" xmlns="http://schemas.xmlsoap.org/disco/soap/" />
  <soap address=<% SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request), '"'); %> 
        xmlns:q2="http://tempuri.org/" binding="q2:MyServiceSoap12" xmlns="http://schemas.xmlsoap.org/disco/soap/" />
</discovery> 
```

在 MyServiceWsdl.aspx 的顶部：

```
<%@ Page Inherits="System.Web.UI.Page" Language="C#" %>
<%@ Assembly Name="Microsoft.SharePoint, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Import Namespace="Microsoft.SharePoint.Utilities" %>
<%@ Import Namespace="Microsoft.SharePoint" %>
<% Response.ContentType = "text/xml"; %> 
```

在底部：

```
<wsdl:service name="MyService">
    <wsdl:port name="MyServiceSoap" binding="tns:MyServiceSoap">
      <soap:address location=<% SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request), '"'); %> />
    </wsdl:port>
    <wsdl:port name="MyServiceSoap12" binding="tns:MyServiceSoap12">
      <soap12:address location=<% SPEncode.WriteHtmlEncodeWithQuote(Response, SPWeb.OriginalBaseUrl(Request), '"'); %> />
    </wsdl:port>
  </wsdl:service> 
```

最后，对 spdisco.aspx 的补充：

```
<contractRef ref=<% SPEncode.WriteHtmlEncodeWithQuote(Response, spWeb.Url + "/_vti_bin/MyService.asmx?wsdl", '"'); %>
            docRef=<% SPEncode.WriteHtmlEncodeWithQuote(Response, spWeb.Url + "/_vti_bin/MyService.asmx", '"'); %> 
            xmlns="http://schemas.xmlsoap.org/disco/scl/" />
  <discoveryRef ref=<% SPHttpUtility.AddQuote(SPHttpUtility.HtmlEncode(spWeb.Url + "/_vti_bin/MyService?disco"),Response.Output); %> 
                xmlns="http://schemas.xmlsoap.org/disco/" /> 
```

终于，我以为我已经做了一切必要的事情来让服务在网站集中的每个网站上正常工作，但是，唉，这似乎不正确。我忘了做什么？

**更新**：另一个信息是尝试获取发现 XML 会导致“未找到”共享点错误。换句话说，访问[http://moss/mysubsite/_vti_bin/MyService.asmx?disco](http://moss/mysubsite/_vti_bin/MyService.asmx?disco)会导致 Sharepoint“找不到文件”错误。

**更新**：原来在 MyServiceDisco.aspx 中有一个小错字导致“找不到文件”错误。但是，我解决了这个问题，现在服务完全崩溃了。使用 WCF 测试客户端，我收到一条错误消息“服务器无法处理请求。---> 对象引用未设置为对象的实例”，然后是堆栈跟踪。从我正在处理的应用程序中，当我调用生成的代理类“MyServiceSoapClient”时，响应是“远程服务器返回错误：NotFound”。

啊啊啊！

**更新**：好的，“对象引用未设置...”消息是我的一个愚蠢错误的结果。现在似乎一切正常，**除了**SPContext.Current.HttpRequestContext.Request.Path 属性始终显示根网站而不是当前网站下的服务的 url。我使用 Wireshark 来确保客户端发布到正确的 url（它是：[http://moss/subweb/_vti_bin/MyService.asmx](http://moss/subweb/_vti_bin/MyService.asmx)），我使用了 ASP.NET 跟踪工具并且没有注意到任何异常（请求以正确的 url 显示在跟踪中），并且我使用了 IIS 跟踪实用程序 (logman.exe)，它没有显示任何意外。一旦我在服务中遇到断点，唯一看起来不正确的是 HttpRequest 上下文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T18:58:58.157

Duuude... 我已经在各种 SharePoint 中遇到了足够多的此类问题，因此我完全确信它仍然是一个测试版产品。

终于，我发现使用 SPContext 而不是 SPControl 来获取当前的 web 可以满足我的需要。所有 MSDN 文档都说要像这样获取 Web：

```
SPControl.GetContextWeb(this.Context); 
```

而且，如果你反汇编内置的 web 服务，你会发现这也是内置 web 服务获取当前 web 的方式。对于我的服务，它不起作用，这确实：

```
SPContext.Current.Site.OpenWeb(); 
```

为什么？？？？为什么，微软，为什么？？？！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T03:52:38.147

你所拥有的对我来说看起来不错。我以前用过几次都没有问题。

我注意到的一个区别是我获取 SPWeb 的代码略有不同（并且更简单）：

```
 // Get the current site based on our context
        // Note that this approach does _not_ require a Dispose of the SPWeb
        SPWeb site = SPContext.Current.Web; 
```

# objective-c - 可可 -/+ 声明

> ID：822943
> 
> 赞同：2
> 
> 时间：2009-05-05T01:39:28.437
> 
> 标签：objective-c, cocoa

使用 Cocoa/Obj-C 声明时 - 和 + 有什么区别。

例如 `-(void)doSomething{}` 或 `+(void)doSomething{}`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T01:42:23.170

" `-`" 表示*实例*方法（表示相对于特定对象），而 " `+`" 表示*类*方法（表示一般类可以使用 - 它不必绑定到特定对象）。

例子：

对于“ `- (void)doSomething`”：

```
MyClass *obj = [[MyClass alloc] init];
[obj doSomething]; 
```

对比

```
[MyClass doSomething]; 
```

为“ `+ (void)doSomething`”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T01:50:46.990

只是为htw的答案添加一点类比：

*   + 表示 C++、C# 或 Java 中的静态方法
*   - 用于 C++、Java 的 C# 中的非静态（常规）方法

# cocoa - 用未弃用的 64 位代码替换 CMNewProfileSearch

> ID：822945
> 
> 赞同：1
> 
> 时间：2009-05-05T01:42:31.313
> 
> 标签：cocoa, macos, macos-carbon

我有现有的代码用于`CMNewProfileSearch`查找然后迭代系统上的颜色配置文件，以获取它们的名称和完整路径。不幸的是，`CMNewProfileSearch`在 Mac OS X 10.5 中已弃用，并且在编译 64 位应用程序时也不可用。

在阅读 ColorSync Manager 2.5 Reference 时，似乎迭代已安装颜色配置文件的新方法是使用该`CMIterateColorSyncFolder`功能。

1.  真的吗？
2.  有没有一种可可的方式来做我想做的事？
3.  有人有任何示例代码吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T02:15:27.663

1.  是的。正如您所指出的，[ColorSync 管理器参考](http://developer.apple.com/documentation/graphicsimaging/Reference/ColorSync_Manager/DeprecationAppendix/AppendixADeprecatedAPI.html)说明如下：

    CMNewProfileSearch 功能没有充分利用从 ColorSync 2.5 版开始提供的优化配置文件搜索。请改用 CMIterateColorSyncFolder。

2.  `CMIterateColorSyncFolder`是执行此操作的*官方*方法。此外，这也是*优化*的方式。

3.  来自[Apple 的 ImageApp 示例代码](http://developer.apple.com/SampleCode/ImageApp/listing16.html)：

编辑：我已修改代码示例以删除`NewCMProfileIterateUPP`和`DisposeCMProfileIterateUPP`.

```
 // Callback routine with a description of a profile that is 
    // called during an iteration through the available profiles.
    //
    static OSErr profileIterate (CMProfileIterateData *info, void *refCon)
    {
        NSMutableArray* array = (NSMutableArray*) refCon;

        Profile* prof = [Profile profileWithIterateData:info];
        if (prof)
            [array addObject:prof];

        return noErr;
    }

    // return an array of all profiles
    //
    + (NSArray*) arrayOfAllProfiles
    {
        NSMutableArray* profs=[[NSMutableArray arrayWithCapacity:0] retain];
        CMIterateColorSyncFolder(profileIterate, NULL, 0L, profs);
        return (NSArray*)profs;
    } 
```

事实证明，不需要`NewCMProfileIterateUPP`，`DisposeCMProfileIterateUPP`所以据我所知，它们没有被任何东西取代。相反，您可以使用与上述匹配的签名来定义回调函数`profileIterate`。然后，您可以直接将回调函数传递给`CMIterateColorSyncFolder`.

I've tested my changes in [ImageApp](http://developer.apple.com/SampleCode/ImageApp/index.html) on Mac OS X 10.5 it it works as expected.

# wpf - WPF iGoogle 停靠样式库

> ID：822947
> 
> 赞同：0
> 
> 时间：2009-05-05T01:43:33.903
> 
> 标签：wpf, igoogle

我正在寻找一个停靠库或讨论构建 iGoogle 样式停靠布局的资源。我今天玩了一些在这篇文章中提到的第三方控件（[关于 WPF 对接库的建议](https://stackoverflow.com/questions/344205/recommendations-on-a-wpf-docking-library)），但它不适合我正在寻找的布局样式。

想象一下像 iGoogle 这样的门户界面，您可以在其中排列元素（在我的例子中是用户控件）并将布局和状态保存到数据库中。我在 asp.net 中使用 Telerik 的 ajax 停靠控件完成了同样的事情，我们的业务希望将相同的样式和行为移植到我们的 WPF 应用程序。

有没有人做过这种风格的门户对接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T11:23:28.687

[Blacklight](http://blacklight.codeplex.com/)项目包含一个名为 Drag Drop Panel的控件，这正是您正在寻找的。它也适用于 WPF 和 Silverlight。

你可以在这里看到一个演示：http: [//mightyeaty.members.winisp.net/blacklight.silverlight/](http://mightymeaty.members.winisp.net/blacklight.silverlight/)

# asp.net-mvc - 未设置 MVC 下拉列表值

> ID：822952
> 
> 赞同：4
> 
> 时间：2009-05-05T01:46:58.357
> 
> 标签：asp.net-mvc

我确定我遗漏了一些明显的东西，但这让我发疯了！如果我指定 html 选项，则不会设置我的下拉列表的值。

在我的控制器中，我检索下拉列表的选项：

```
ViewData["Coordinator"] = new SelectList(userRepository.GetIdUserList(1),
                          “ID”、“签名”、edCenter.Coordinator）；
```

在我看来，我用以下内容填充下拉列表：

```
Html.DropDownList("Coordinator",(IEnumerable) ViewData["Coordinator"],
                   新 {style="width:175px"})
```

下拉值已完美填充，但未选择列表的值。

但是，如果我只是使用：

```
Html.DropDownList("协调器");
```

一切正常。

出了什么问题？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T13:12:39.207

我昨天遇到了类似的问题，所以如果你仍然得到相同的结果，还有一件事需要考虑。有时会忽略您的`DropDownList`选定值`SelectList`，这很烦人，但它的作用是尝试使用字段名称作为键从`ModelState`,和 Model 中获取选定的值。`ViewData`在您的情况下，您将列表存储在 中`ViewData["Coordinator"]`，该键与 DropDown 具有相同的名称。试试这个：

```
ViewData["CoordinatorList"] = new SelectList(userRepository.GetIdUserList(1), 
                          "ID",    "Signature",edCenter.Coordinator);

ViewData["Coordinator"] = dCenter.Coordinator; 
```

然后在视图中：

```
 <%=Html.DropDownList("Coordinator",((SelectList)ViewData["CoordinatorList"]).AsEnumerable(),
 new {style="width:175px"}) %> 
```

如果您想查看窗帘后面发生的情况，请打开反射器（或获取 MVC 源）并浏览此方法： `System.Web.Mvc.Html.SelectExtensions.SelectInternal()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T02:44:55.097

DropDown Helper 的第二个参数接受一个 IEnumerable(Of SelectListItem) 类型的对象，但您传递了一个 IEnumerable(Of SelectList) 类型的对象，所以应该这样编写代码：

```
 <%=Html.DropDownList("Coordinator",((SelectList)ViewData["Coordinator"]).AsEnumerable(),
 new {style="width:175px"}) %> 
```

# .net - 如何制作 Visual Studio 宏以将调试器附加到 w3wp.exe 的所有实例？

> ID：822955
> 
> 赞同：6
> 
> 时间：2009-05-05T01:48:39.100
> 
> 标签：.net, visual-studio, visual-studio-2005, debugging, visual-studio-macros

我通常在开发 Web 应用程序，而且我的大量工作时间都花在了“Ctrl + Alt + P”上，按进程名称排序，然后选择 w3wp.exe 来附加我的调试器。

更糟糕的是，我正在开发一个跨越多个应用程序池的应用程序，所以我通常有 2 或 3 个 w3wp.exe 实例，并且无法知道要附加到哪个实例，所以我通常最终附加到所有其中，这是矫枉过正但有效。

总而言之，这很烦人...

我的同事想出了一种方法让 VS 宏自动附加到 w3wp.exe（他基本上记录了这个）：

```
Sub AttachMacro()    
  Try    
    Dim dbg2 As EnvDTE80.Debugger2 = DTE.Debugger    
    Dim trans As EnvDTE80.Transport = dbg2.Transports.Item("Default")    
    Dim dbgeng(3) As EnvDTE80.Engine    
    dbgeng(0) = trans.Engines.Item("T-SQL")    
    dbgeng(1) = trans.Engines.Item("T-SQL")    
    dbgeng(2) = trans.Engines.Item("Managed")    
    Dim proc2 As EnvDTE80.Process2 = dbg2.GetProcesses(trans, "ENIAC").Item("w3wp.exe")    
    proc2.Attach2(dbgeng)    
  Catch ex As System.Exception    
    MsgBox(ex.Message)    
  End Try    
End Sub 
```

我不太确定是否所有这些都是必要的，或者其他什么，我从来没有为 VS 制作过宏，我真的不知道从哪里开始。

有没有办法修改这个宏，而不是将自己附加到w3wp.exe**的**实例，而是将自己附加到w3wp.exe 的**所有**实例？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-07T15:09:01.437

```
Sub MacroAttachToAllProcesses()

    Try

        Dim dbg2 As EnvDTE80.Debugger2 = DTE.Debugger
        Dim trans As EnvDTE80.Transport = dbg2.Transports.Item("Default")
        Dim dbgeng(3) As EnvDTE80.Engine

        dbgeng(0) = trans.Engines.Item("T-SQL")
        dbgeng(1) = trans.Engines.Item("T-SQL")
        dbgeng(2) = trans.Engines.Item("Managed")

        For Each theProcess As EnvDTE80.Process2 In dbg2.GetProcesses(trans, "COMPUTERNAME")
            If theProcess.Name.Contains("w3wp.exe") Then
                theProcess.Attach2(dbgeng)
            End If

        Next

    Catch ex As System.Exception
        MsgBox(ex.Message)
    End Try

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-21T02:55:16.363

我知道您正在为此任务寻找宏，我也有类似的宏。但是，我想解释一种在您开始调试时将调试器附加到解决方案中的项目的方法。

这是一个鲜为人知的功能 - 如果您在解决方案浏览器中右键单击您的解决方案文件，选择属性，然后您可以定义多个启动项目及其操作。您的调试器将在您运行时附加到列出的项目。

注意：如果你有一个网络服务，它会打开一个浏览器窗口，但是你可以在项目的属性中通过告诉它不要打开一个窗口来禁用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-04T17:56:42.340

这就是我附加到远程 w3wp 进程的方式。它比 DanC 的解决方案运行得快一点，并且有一些额外的错误处理。

```
Private Sub AttachToW3wp(ByVal machineName As String)
    ' In order for this to work, you have to be running the Visual Studio 2010 Remote Debugging Monitor
    ' as your (domain) user.  
    ' It won't work if the remote debugger is running as a service.  I've tried every permutation of 
    ' domain and username in the the transport qualifier, tried the obvious local system username,
    ' even tried looking at the network traffic 
    ' in WireShark, I can't figure it out how to make it work if you are running as a service.  
    ' If you are running the debugger as a service, even running the macro that gets created by VS's 
    ' macro recorder when you attach to a process doesn't work.
    Dim transportQualifier = machineName
    Try
        Dim processToAttachTo As String = "w3wp.exe"
        Dim dbg2 As EnvDTE80.Debugger2 = DTE.Debugger
        Dim trans As EnvDTE80.Transport = dbg2.Transports.Item("Default")
        Dim dbgeng(2) As EnvDTE80.Engine
        dbgeng(0) = trans.Engines.Item("T-SQL")
        dbgeng(1) = trans.Engines.Item("Managed (v2.0, v1.1, v1.0)")
        Dim processesRemote = dbg2.GetProcesses(trans, transportQualifier)
        Dim attached As Boolean = False
        Dim processRemote As EnvDTE80.Process2
        For Each processRemote In processesRemote
            ' For some reason it takes a much longer time to get the remote process names then it 
            ' does the user name, so let's skip over all the processes that have the wrong UserName.
            If processRemote.UserName = "NETWORK SERVICE" AndAlso _
               (Right(processRemote.Name, Len(processToAttachTo)) = processToAttachTo) Then
                If processRemote.IsBeingDebugged Then
                    MsgBox(processToAttachTo & " on " & machineName & " is already being debugged")
                Else
                    processRemote.Attach2(dbgeng)
                End If
                attached = True
            End If
        Next
        If Not attached Then
            MsgBox(processToAttachTo & " is not running on " & machineName & ".")
        End If
    Catch ex As System.Exception
        MsgBox("Exception attempting to attach to " & transportQualifier & ": " & ex.Message)
    End Try
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T01:54:18.947

您可能需要查看[gflags.exe](http://technet.microsoft.com/en-us/library/cc738763.aspx)。它的一个选项是附加到特定可执行文件的每次调用的调试器。

# computer-science - AP计算机科学明天考试。有人拿过吗？有小费吗？

> ID：822956
> 
> 赞同：0
> 
> 时间：2009-05-05T01:49:15.260
> 
> 标签：computer-science

嘿，伙计们，只是想知道你是否有任何关于我明天进入我的第一个 AP 的最后一分钟提示！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T02:03:56.147

不要学习。我考了A和AB，如果你现在还不知道材料，你可能考不好。去睡觉吃早餐；这是你目前能做的最好的事情。

这很容易，所以不用担心。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T01:51:48.407

是的，离开 Stack Overflow 并开始学习。还有祝你好运？我猜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-14T01:02:07.610

我没有上过课程，一年四季都在随便编程，前一天晚上就学习了。我不会撒谎，测试把我吓坏了，尤其是 GridWorld 部分。我以为我会得到 1 或 2，但我得到了 4！这比你想象的要容易得多，**很多**孩子考试不及格。

# jira - 是否可以从 JIRA 获得“活动页面”（如 redmine 中的那些）？

> ID：822959
> 
> 赞同：2
> 
> 时间：2009-05-05T01:50:57.317
> 
> 标签：jira, redmine

我是 JIRA 的新手，想知道是否有与 Redmine 中的“项目活动”屏幕类似的功能。

我发现能够查看所有代码更改、问题更新、wiki 页面更改，基本上是任何对项目重要的内容，都可以在一个很好的时间线页面中查看，这非常有用。

一个例子是这样的：

[http://www.redmine.org/projects/redmine/activity](http://www.redmine.org/projects/redmine/activity)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T22:49:14.157

是的，您需要[Atlassian Activity Stream Plugin](http://confluence.atlassian.com/display/JIRAEXT/Using+the+Atlassian+Activity+Stream+Plugin)。如何安装它的详细信息在[其插件页面上](http://confluence.atlassian.com/display/JIRAEXT/Atlassian+Activity+Stream+Plugin)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-03T14:05:53.590

Activity Stream 是 Jira 4 的标准配置

# linux - Linux socket编程调试？

> ID：822964
> 
> 赞同：1
> 
> 时间：2009-05-05T01:53:25.313
> 
> 标签：linux, linux-kernel, sockets, linux-device-driver

我有一个这样的功能：

```
static int
rcv_kern(int sock, void *buf, int len, struct sockaddr *addr,
     socklen_t *addrlen)
{
    struct timeval timeout = {1, 0};
    fd_set set;
    int status;

    FD_SET(sock, &set);
    if ((status = select(sock + 1, &set, NULL, NULL, &timeout)) == 0) {
        FD_ZERO(&set);
        fprintf(stderr, 
            "timeout while receiving answer from kernel\n");
        exit(1);
    } else if (status == -1) {
        FD_ZERO(&set);
        perror("recvfrom failed");
        exit(1);
    }
    FD_ZERO(&set);
    return recvfrom(sock, buf, len, 0, addr, addrlen);
} 
```

它用于使用 netlink 从内核空间接收消息。但是当我运行它时，结果总是显示“从内核接收答案时超时”的消息，从源代码中，这是由于“选择”方法总是返回“0”的原因。不知道原因，谁能给我一些建议，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T04:07:48.173

查理，
有几件事：

1）您可能应该循环您的 select() 调用，并且仅当 FD_ISSET() 在您的文件描述符上返回 true 时才调用 recvfrom。
2) 确保在 netlink 套接字上发送的实际驱动程序或内核代码实际上正在向其写入/发送数据。如果没有，那么如果您的函数在 1 秒内没有接收到数据，那么您的函数将超时。（这就是您设置的超时时间）。

一些一般性的评论... 在 Linux 中，当使用 select() 系统调用时。每次调用后超时数据结构都会重置，因此如果您将代码更改为围绕选择循环，您可能应该这样做..您必须为循环中的每次迭代重置超时值。

此外，如果 select 超时，这并不一定意味着它是一个错误。请记住，select 是一个非阻塞调用。它只会在给定的“超时”期间在套接字上等待并返回。如果您无论如何都想从文件描述符中读取......这意味着您希望您的 recv_kern() 函数阻塞，直到有数据返回，然后不要费心使用 select()。只需直接在文件描述符上调用 recvfrom() 即可。这样，您的 recv_kernel() 函数将阻塞并且仅在读取内核发送的数据后才返回。

如果不了解有关如何使用此代码的上下文的更多信息，很难在这里提供更具体的帮助。我假设这是您编写的自定义内核模块，它将数据发送到用户空间，对吗？
尝试将您的 recv_kern() 函数更改为阻塞（取出选择代码并调用 recvfrom()）。这种方式应该能够判断您的内核驱动程序是否实际上正在正确地将数据发送到用户空间。如果您在 recvfrom() 上阻塞并且没有任何东西返回..那么您的内核驱动程序也可能有问题。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T10:40:14.977

您应该像这样重写函数：

```
static int
rcv_kern(int sock, void *buf, int len, struct sockaddr *addr,
     socklen_t *addrlen)
{
    struct timeval timeout = {1, 0};
    fd_set set;
    int status;

    FD_ZERO(&set);
    FD_SET(sock, &set);
    if ((status = select(sock + 1, &set, NULL, NULL, &timeout)) == 0) {
        fprintf(stderr, 
                "timeout while receiving answer from kernel\n");
        exit(1);
    } else if (status < 0) {
        perror("recvfrom failed");
        exit(1);
    }
    if ((status = recvfrom(sock, buf, len, 0, addr, addrlen)) < 0) {
        perror("recvfrom error");
        exit(1);
    }
    if (status == 0) {
        fprintf(stderr, "kernel closed socket\n");
        exit(1);
    }
    return status;
} 
```

就像其他人说的那样，您需要在调用 select 之前调用 FD_ZERO。对 FD_ZERO 的其他调用是多余的。此外，您需要进行完整的错误检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T02:16:05.353

与超时无关，但需要在 FD_SET(sock, &set) 之前先 FD_ZERO(&set)，否则 fd_set 将未初始化并且可能包含许多设置位。此外，退出之前的 FD_ZERO() 是毫无意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T02:17:28.000

我在内核空间研究了我的代码，我知道内核无法使用“skb_dequeue(&sk->sk_receive_queue)”方法从客户端接收消息。我不知道它是怎么发生的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T03:02:14.913

`strerror(errno)`对于初学者，您可以通过在超时发生时打印出来（打印 errno 也是明智的）来找出实际错误是什么。

至于在没有 errno 的情况下猜测问题可能是什么，请注意，不能保证有什么可以读；即使您通过accept(2) 获得了套接字，它也可能只是一个已建立的连接，但客户端没有开始写入。通常你不会只做一次 select(2); 您希望有一个主循环一直调用 select(2) 直到程序想要退出，因为几乎任何时候都可能由于任何原因发生超时。

其他可能的问题：

*   客户端无法连接。
*   您未能正确绑定套接字。
*   在调用 bind(2) 之后，您忘记在服务器的套接字上调用 listen(2)。

如果您使用 IP 套接字，您可以使用 Wireshark 查看您的网络流量，以查看客户端是否按照您的预期执行。

# fluent-nhibernate - 没有主键的 Fluent-NHibernate 表映射

> ID：822966
> 
> 赞同：8
> 
> 时间：2009-05-05T01:54:26.527
> 
> 标签：fluent-nhibernate

我正在尝试创建到没有主键/引用的数据库表的映射。

```
public class TestMap : ClassMap<<Test>Test> {

    public TestMap() {

        WithTable("TestTable");

        Map(x => x.TestColumn);

    }

} 
```

这会失败并需要 id 或复合 id。这在流利的nhibernate中可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-05-23T13:11:28.227

至少在 Oracle 中，我为此使用了“ROWID”。对于 mssql，您可以使用“ROW_NUMBER()”内置函数对表进行只读访问，但我还没有尝试过...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T02:11:49.263

不可以。您必须添加代理主键，例如 SQL Server 中的标识列，才能映射此表。据我所知，NHibernate 本身不支持这一点。

为什么这张表上没有主键？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-08T11:31:14.597

如果表包含属于另一个实体的数据，您可以将其映射为**组件**的集合。组件不是自己标识的，而是属于另一个*被*标识的实体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T07:45:52.773

如果我们可以从没有主键/身份列的表中提取一列，那么我们可以使用 fluent 如下：

```
Id(x => x.TempID).Column("TempID"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-23T13:21:34.757

据我所知，nhibernate 不支持此功能。然而，作为一般经验法则，您确实应该始终拥有某种 ID，如果您发现自己处于认为不需要 ID 的情况，您应该评估您的数据模型。应该存在一个 ID，无论它是特定于表的主键，还是来自另一个表的代理键。这不仅确保了 nhibernate 可以处理表，而且通过索引提高了性能。

在您开始假设 nhibernate 无法满足您的需求之前，请考虑一下为什么您的桌子上没有钥匙以及没有钥匙有什么意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-14T21:01:22.387

您可以将实体映射到没有在数据库中定义键的表。我在旧版 SQL Server 数据库中这样做。但是，该表必须有一个**候选键**（一组实际存储唯一值组合的列）。**实体**的概念涉及某种**身份**的概念。取而代之的是，您在代码中尝试的是映射没有身份的实体，这是不可能的。

# c# - 如何在 .NET 中通过 Membership.Provider 使用 Secret Answer

> ID：822969
> 
> 赞同：0
> 
> 时间：2009-05-05T01:56:08.473
> 
> 标签：c#, asp.net, security, membership-provider

我在 MVC 应用程序中使用 Membership.Provider 来保证安全。我有一个忘记密码页面，询问您的用户名，然后给您存档的秘密问题。我的问题是如何根据文件中的内容检查秘密答案。我似乎找不到任何方法可以做到这一点

```
Membership.Provider.ResetPassword(userName, secretAnswer) 
```

这基本上批准了我输入的任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T02:13:15.063

您必须在 web.config 中设置一个设置来告诉成员资格提供者使用秘密问题。

这是`requiresQuestionAndAnswer="true"`您设置会员提供程序的地方。

编辑：在您的评论`requiresQuestionAndAnswer`中设置为“假” - 它应该是“真”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-08T14:04:09.813

您必须使用重置密码，请参阅示例 [http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.resetpassword.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.resetpassword.aspx)

# iphone - Xcode 错误：无法启动模拟应用程序

> ID：822972
> 
> 赞同：9
> 
> 时间：2009-05-05T01:57:07.660
> 
> 标签：iphone, xcode, crash, ios-simulator, osx-leopard

# 问题

不像人们在[这里](https://stackoverflow.com/questions/717453/multiple-targets-in-xcode-failed-to-launch-simulated-application-unknown-error)和 [这里](https://stackoverflow.com/questions/779115/iphone-failed-to-launch-simulated-application-unknown-error)问的那样，我在全新安装 Leopard (hackintosh) 后得到了这个错误，这个问题真的让我发疯，无处可寻，我用谷歌搜索并访问了与此相关的每一篇文章，仍然可以解决不了。

第一次安装 iPhone SDK 2.2.1 后，启动一个新项目（任何类型，基于导航，OpenGL ES 应用程序），然后构建并运行，我遇到以下问题：有时是：

> 无法启动模拟应用程序：未知错误。

有时是：

> 启动模拟应用程序失败：iPhone Simulator 找不到 com.yourcompany.[应用程序名称] 的进程 ID

看来模拟器中的应用程序立即崩溃了，所以 Xcode 可以找到进程 ID。

# 解决方案

[这个链接](http://iphonedevelopmentfaq.com/view-question.php?id=106)说这甚至无法解决。还有一些人一步一步做详细的：

1.  取消选中 Info.plist
2.  退出 XCode
3.  删除目录/Lib/Caches/com.apple.DeveloperTools.###
4.  打开 Xcode 项目
5.  清理所有目标
6.  重建

我重置了 iPhone 模拟器。这也没有解决问题……</p>

我什至尝试卸载SDK并重新安装它，仍然出现同样的错误......</p>

这是与硬件有关的问题吗？还是操作系统版本？我正在使用 hackintosh (iDenebv1.4 10.5.6)，所有其他软件都运行良好，包括 iTunes && vmware fusion。

非常感谢您提供任何进一步的提示或线索！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-28T17:17:21.183

已修复问题：iPhone Simulator 无法找到 com.yourcompany.[your application name] 的进程 ID

我在构建和模拟我在 OS 版本 2.2.1 下构建的项目时遇到问题，我无法再在 XCode 3.1.4 的模拟器中构建和运行该项目，即使我强制 XCode 为“模拟器 - 2.2”构建.1 调试”

我能够通过以下方式解决这个问题： - 关闭 iPhone 模拟器 - 将 XCode 放入 View->Detail - 打开“资源”文件夹中的“Info.plist”文件 - 在文件顶部附近，您应该会看到“信息.plist”，带有向上/向下箭头选择器 - 单击向上/向下箭头选择器 - 选择“清除文件历史记录”

专为：模拟器 - 2.2.1

XCode 版本：3.1.4（包括 OS3.1 Beta 3）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-24T03:47:45.940

我昨晚遇到了同样的问题，突然我的系统重新启动了。那时，我正试图将应用程序安装到模拟器中。当系统返回时，我再次尝试安装该应用程序，它说“无法启动模拟应用程序”

比我用谷歌搜索它，并尝试了许多解决方案，比如清除所有目标并尝试再次构建，但没有成功。

所以我找到了以下链接，其中描述了如何重置 iPhone 模拟器内容：

[http://developer.apple.com/iphone/library/documentation/Xcode/Conceptual/iphone_development/125-Using_iPhone_Simulator/iphone_simulator_application.html](http://developer.apple.com/iphone/library/documentation/Xcode/Conceptual/iphone_development/125-Using_iPhone_Simulator/iphone_simulator_application.html)

我厌倦了这样做，你们不会相信我，它奏效了:)，

解决方案是：“要将模拟器的用户内容和设置设置为出厂状态并删除已安装的应用程序，请选择 iPhone 模拟器 > 重置内容和设置”

祝大家好运........ :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-07T19:31:12.383

这最终成为产品名称问题：

解决方法是恢复到

${EXECUTABLE_NAME} ${PRODUCT_NAME}

对于 info.plist 中的可执行文件和 com..${PRODUCT_NAME}。

清理 XCode、退出、重新设置和退出模拟器，一切顺利。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T03:45:12.350

在 /var/log/system.log 中发现了一些奇怪的日志。

```
May  8 16:17:50 th084134 /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk/System/Library/CoreServices/SpringBoard.app/SpringBoard[1170]: MobileInstallationLookup: Generating the install map
May  8 16:17:50 th084134 /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.2.1.sdk/System/Library/CoreServices/SpringBoard.app/SpringBoard[1170]: load_application_info: Could not load signer identity from /Users/test/Library/Application Support/iPhone Simulator/User/Applications/5D55807A-7489-4DC5-B4D7-2ECD5E230F29/new1.app/new1
May  8 16:17:50 th084134 [0x0-0x2e02e].com.apple.iphonesimulator[1168]: error compiling query "SELECT value FROM _SqliteDatabaseProperties WHERE key = ?;": no such table: _SqliteDatabaseProperties
May  8 16:17:51 th084134 SpringBoard[1170]: Unable to obtain task name port for com.yourcompany.new1\. Either it failed to exec or it terminated immediately: (os/kern) failure
May  8 16:17:51 th084134 SpringBoard[1170]: Couldn't activate <SBApplication: 0x123e6d0> com.yourcompany.new1 activate: animated  deactivate: 
May  8 16:17:51 th084134 SpringBoard[1170]: Application <SBApplication: 0x123e6d0> com.yourcompany.new1 activate: animated  deactivate:  exited abnormally with signal 256: Unknown signal: 256
May  8 16:17:51 th084134 SpringBoard[1170]: Unable to obtain task name port for com.yourcompany.new1\. Either it failed to exec or it terminated immediately: (os/kern) failure
May  8 16:17:51 th084134 com.apple.launchd[164] (UIKitApplication:com.yourcompany.new1[0xa455][1171]): Bug: launchd_core_logic.c:2812 (23714):103: sandbox_init(j->seatbelt_profile, j->seatbelt_flags, &seatbelt_err_buf) != -1
May  8 16:17:51 th084134 com.apple.launchd[164] (UIKitApplication:com.yourcompany.new1[0xa455][1171]): Sandbox failed to init: Cannot apply builtin profile `/Users/test/Library/Application Support/iPhone Simulator/User/Applications/5D55807A-7489-4DC5-B4D7-2ECD5E230F29.sb': Policy not found
May  8 16:17:51 th084134 com.apple.launchd[164] (UIKitApplication:com.yourcompany.new1[0xa455][1171]): Exited with exit code: 1
May  8 16:17:51 th084134 [0x0-0x2e02e].com.apple.iphonesimulator[1168]: 2009-05-08 16:17:51.026 SpringBoard[1170:10b] Unable to obtain task name port for com.yourcompany.new1\. Either it failed to exec or it terminated immediately: (os/kern) failure 
```

[这](http://discussions.apple.com/thread.jspa?messageID=8508217)是一个关于如何通过命令行在模拟器中运行应用程序的讨论，希望它有助于理解 xcode 和模拟器是如何工作的。

但我没有解决。

好吧，我通过**安装另一个 hackintosh 发行版（IPC 10.5.6）“解决了”它，**完美！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-25T18:42:59.430

就我而言，我正在向一个一直有效的现有应用程序添加一个目标。就我而言，我忘记选择所有源代码、xib、框架等，然后单击它们的目标复选框。我的线索是构建是瞬间发生的，这没有任何意义。它从未建造过任何东西。它只是未能在模拟器中安装。一旦我包含了新目标的所有源文件等，它就可以很好地构建和安装。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-09T21:23:47.480

我有同样的问题，我通过另一个应用程序启动模拟器并删除我试图在其上运行的应用程序来修复它。然后尝试构建并运行并完美运行。

干杯

马特

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-18T14:59:34.360

只需通过模拟器的 UI 从模拟器（和/或设备，如果您尝试在设备上运行）删除应用程序，然后关闭模拟器并尝试重新运行应用程序。删除支持模拟器的实际文件也会删除应用程序并执行相同的操作（但通过模拟器的 UI 删除，如果它适合您，会更快更容易一些）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-27T14:51:28.777

我有同样的问题。我不小心将我的 info.plist 文件添加到了我的目标中，并且每次构建应用程序时它都会被复制到应用程序包中。所以捆绑包中有 2 个 .plist 文件——我的和由 XCode 创建的 Info.plist ——这让模拟器感到困惑。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T14:51:47.500

您的 CPU 是 Intel 的吗，并且，是分布在 Apple 硬件中的型号的吗？

我怀疑模拟器能否在非英特尔 CPU 和/或 VMWare 上可靠地工作（如果有的话）。模拟器是**非常**特定于 CPU 的，以反映 iPhone 的 arm 硬件。

SDK 仅支持来自 Apple 的 Intel 硬件。

创建模拟器需要付出巨大的努力，支持每个 CPU 并不容易或便宜（阅读，数千工时）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-23T21:52:26.933

我通过从项目中的 Info.plist 文件中删除“图标已包含光泽和斜角效果”属性来解决此问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-10T05:58:35.437

我的问题集中在模拟器根本不接受的产品名称上。选择替代名称让我克服了这个问题。每次将名字改回原来的嫌疑人都会让模拟器窒息。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-12-15T10:17:06.930

尝试将项目移动到本地硬盘驱动器并从那里打开它！这为我解决了这个问题（该项目曾经存储在 samba 共享中）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-06-24T08:16:24.830

我遇到了完全相同的问题 - 我重置了 iphone 模拟器，然后退出模拟器，然后再次启动它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-11-23T11:38:58.733

我的修复：

重新启动Mac并修复它。（在此之前尝试清除缓存，从 iPhone 模拟器中删除缓存，清理，重建，退出操作系统，退出模拟器，没有任何效果。）重新启动操作系统有效。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-03-14T16:26:21.173

这也困扰着我，但终于让它工作了。不幸的是，我无法重现我所做的，但这是我的操作列表供您参考。

导致问题的项目是我从 Apple 下载并进行了调整的项目。有趣的是，我仍然可以很好地启动我自己的项目。

因此，这是我执行的操作列表（请注意，以下操作均不能单独起作用）： - 关闭模拟器并执行“清除文件历史记录” - 重新启动模拟器 - 重新启动 - 重新启动 xcode - 使用重置内容重置 iPhone和设置

然而，当我用我下载的代码的新版本尝试上述所有方法时——它又可以工作了。只是出于兴趣，我将导致此问题的项目拖回桌面，现在可以了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-04-07T15:26:21.033

哇，好痛苦。我不得不通过命令行卸载 XCode 4，然后再次安装 XCode 3。确保在*重新*安装后重新启动。在职的...

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-01-30T09:13:40.403

为什么没有人告诉重新启动模拟器。

就我而言，

```
 Resetting the iPhone with Reset Content and Settings

 and 

 **ReStart Simulator** 
```

效果不错~

# sql-server - 网络是多少 - 确定 SQL Server 中的网络开销

> ID：822974
> 
> 赞同：2
> 
> 时间：2009-05-05T01:58:46.907
> 
> 标签：sql-server, sql-server-2005, performance

我们有一个运行 C# 的开发服务器，并在同一台机器上与 SQL 服务器通信。

我们有另一台服务器运行相同的代码并与另一台机器上的 SQL 服务器通信。

一个作业执行 60,000 次读取（即它调用存储过程 60,000 次 - 每次读取返回一行）。

该作业在第一台服务器上运行的时间是在第二台服务器上运行的时间的 1/40。

我们已经在研究两个 SQL Server（碎片、tempdb、内存等）之间的“内部”差异，但是确定第二个配置的速度有多慢的好方法仅仅是因为它必须通过网络？

[相当令人困惑的是，我找到了一个“SQL Server Ping”工具，但它实际上并没有尝试任何时间测量，据我所知，这是我们所需要的]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T15:31:56.493

在远程计算机上打开 SQL Server 管理服务器。开始一个新的查询。单击查询，包括客户统计信息。运行您的存储过程。在结果的“客户端统计信息”选项卡中，您将看到一些有关通过网络来回发送的数据包数量的一些基本信息。我的猜测是，对于一次阅读，您不会看到那么多开销。

为了获得更好的主意，我会尝试从您的远程计算机通过网络简单地选择 60,000 条记录（因为您说它会一一返回 60,000 条记录）。同样，这不会让您了解存储过程的开销，但它会让您快速了解机器之间的网络速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T02:03:07.257

SQL Server 附带 Profiler 实用程序。这将告诉您查询在每个 SQL Server 实例上的执行时间。注意任何差异。任何时间（在 ExecutionTime 列中）在这里不能被考虑的是传输时间......或客户端显示时间。也许您的客户端机器需要更长的时间来呈现结果或计算结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T18:53:18.840

你期待什么结果？在一台机器上运行所有东西与通过网络运行肯定会给你不同的时间。您最大的时间差异将是网络吞吐量。您需要以两种方式与联网服务器通信。

如果您可以将 NOCOUNT 设置为 on，这将有助于减少网络流量。

# asp.net - 为什么会无限循环？

> ID：822975
> 
> 赞同：0
> 
> 时间：2009-05-05T01:59:46.470
> 
> 标签：asp.net, vb.net, infinite-loop

所以我今天刚让我的网站启动服务器，我认为这个功能是罪魁祸首。谁能告诉我问题是什么？我似乎无法弄清楚：

```
Public Function CleanText(ByVal str As String) As String    
'removes HTML tags and other characters that title tags and descriptions don't like
    If Not String.IsNullOrEmpty(str) Then
        'mini db of extended tags to get rid of
        Dim indexChars() As String = {"<a", "<img", "<input type=""hidden"" name=""tax""", "<input type=""hidden"" name=""handling""", "<span", "<p", "<ul", "<div", "<embed", "<object", "<param"}

        For i As Integer = 0 To indexChars.GetUpperBound(0) 'loop through indexchars array
            Dim indexOfInput As Integer = 0
            Do 'get rid of links
                indexOfInput = str.IndexOf(indexChars(i)) 'find instance of indexChar
                If indexOfInput <> -1 Then
                    Dim indexNextLeftBracket As Integer = str.IndexOf("<", indexOfInput) + 1
                    Dim indexRightBracket As Integer = str.IndexOf(">", indexOfInput) + 1
                    'check to make sure a right bracket hasn't been left off a tag
                    If indexNextLeftBracket > indexRightBracket Then 'normal case
                        str = str.Remove(indexOfInput, indexRightBracket - indexOfInput)
                    Else
                        'add the right bracket right before the next left bracket, just remove everything
                        'in the bad tag
                        str = str.Insert(indexNextLeftBracket - 1, ">")
                        indexRightBracket = str.IndexOf(">", indexOfInput) + 1
                        str = str.Remove(indexOfInput, indexRightBracket - indexOfInput)
                    End If
                End If
            Loop Until indexOfInput = -1
        Next
    End If
    Return str
End Function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T02:31:49.403

这样的事情不会更简单吗？（好的，我知道它与发布的代码不同）：

```
public string StripHTMLTags(string text)
{
    return Regex.Replace(text, @"<(.|\n)*?>", string.Empty);
} 
```

（转换为 VB.NET 应该很简单！）

注意：如果您经常运行此程序，您可以对`Regex`.

一种是使用需要稍微重写的预编译表达式。

第二种是使用非捕获形式的正则表达式；.NET 正则表达式实现 (?:) 语法，它允许进行分组，而不会导致捕获的文本被记住为反向引用而导致性能损失。使用此语法，上述正则表达式可以更改为：

```
@"<(?:.|\n)*?>" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T02:48:49.610

这行也是错误的：

```
Dim indexNextLeftBracket As Integer = str.IndexOf("<", indexOfInput) + 1 
```

保证总是将 indexNextLeftBracket 设置为等于 indexOfInput，因为此时 indexOfInput 所指位置处的字符已经始终是“<”。改为这样做：

```
Dim indexNextLeftBracket As Integer = str.IndexOf("<", indexOfInput+1) + 1 
```

并且还要在 if 语句中添加一个子句，以确保您的字符串足够长以用于该表达式。

最后，正如其他人所说，如果你能让它工作，这段代码将是一个难以维护的野兽。最好寻找另一种解决方案，例如正则表达式，甚至只是将所有 '<' 替换为`&lt;`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T02:36:20.453

除了其他好的答案之外，您可能会阅读一些关于[循环不变量](http://en.wikipedia.org/wiki/Loop_invariant)的内容。拉出和放回你检查的绳子以终止你的循环应该引发各种警钟。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T02:11:36.080

只是一个猜测，但这就像罪魁祸首吗？indexOfInput = str.IndexOf(indexChars(i)) '找到 indexChar 的实例

根据[Microsoft 文档](http://msdn.microsoft.com/en-us/library/aa904283(VS.71).aspx)，返回值 - 如果找到该字符串，则返回 value 的索引位置，否则返回 -1。如果 value 为 Empty，则返回值为 0。

所以也许 indexOfInput 被设置为 0？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T02:25:37.547

如果你的代码试图清理字符串会发生什么`<a`？

当我读到它时，它发现 indexChar 在位置 0，但是 indexNextLeftBracket 和 indexRightBracket 都等于 0，你进入 else 条件，然后你在位置 -1 处插入一个“>”，它可能会在开头插入，给你字符串`><a`。新的 indexRightBracket 然后变为 0，因此您从位置 0 删除 0 个字符，留下`><a`. 然后`<a`代码再次在代码中找到 ，然后您将进入具有无限内存消耗循环的竞赛。

即使我错了，您也需要让自己进行一些单元测试，以确保这些边缘情况正常工作。如果我不在基地，那也应该可以帮助您找到实际的循环代码。

不过一般来说，即使你修复了这个特定的错误，它也永远不会变得非常健壮。解析 HTML 很困难，而且 HTML 黑名单总是会有漏洞。例如，如果我真的想在其中添加一个`<input type="hidden" name="tax"`标签，我将其编写为`<input name="tax" type="hidden"`，您的代码将忽略它。你最好的办法是让一个实际的 HTML 解析器参与进来，并且只允许你真正想要的（非常小的）标签子集。或者更好的是，使用其他形式的标记，并去除所有 HTML 标记（再次使用具有某种描述的真实 HTML 解析器）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T02:27:35.420

我必须通过一个真正的编译器运行它，但是 mindpiler 告诉我该`str = str.Remove(indexOfInput, indexRightBracket - indexOfInput)`行正在重新生成一个无效的标签，这样当你再次循环时它会发现同样的错误“修复”它，再试一次，发现错误“修复”它，等等。

FWIW 是一段从字符串中删除不需要的 HTML 标记的代码片段（它在 C# 中，但概念可以翻译）

```
public static string RemoveTags( string html, params string[] allowList )
{
    if( html == null ) return null;
    Regex regex = new Regex( @"(?<Tag><(?<TagName>[a-z/]+)\S*?[^<]*?>)",
                             RegexOptions.Compiled | 
                             RegexOptions.IgnoreCase | 
                             RegexOptions.Multiline );
    return regex.Replace( 
                   html, 
                   new MatchEvaluator( 
                       new TagMatchEvaluator( allowList ).Replace ) );
} 
```

MatchEvaluator 类

```
private class TagMatchEvaluator
{
    private readonly ArrayList _allowed = null;

    public TagMatchEvaluator( string[] allowList ) 
    { 
        _allowed = new ArrayList( allowList ); 
    }

    public string Replace( Match match )
    {
        if( _allowed.Contains( match.Groups[ "TagName" ].Value ) )
            return match.Value;
        return "";
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T02:33:12.690

这似乎不适用于简单的`<a<a<a`案例，甚至`<a>Test</a>`. 你有没有测试过这个？

就个人而言，我讨厌这样的字符串解析 - 所以我什至不会尝试找出你的错误在哪里。它需要一个调试器，而且比我愿意投入的更令人头疼。

# haskell - Haskell：打印出元组列表的内容

> ID：822979
> 
> 赞同：5
> 
> 时间：2009-05-05T02:02:55.103
> 
> 标签：haskell

基本上我需要做的是编写一个函数，该函数接受类型列表`[(String, String)]`并打印出内容，以便逐行输出如下所示：

```
FirstString : SecondString

FirstString : SecondString 
```

..etc，对于列表中的每个项目。我有以下代码并将其打印出来，但由于某种原因，它会打印出`[(),()]`最后包含的一行。

```
display :: Table -> IO ()
display zs = do { 
    xs <- sequence [putStrLn ( a ++ " = " ++ b) | (a, b) <- zs];
    print xs 
} 
```

有什么我做错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T02:09:05.823

最后的 print xs 是不必要的。这里的序列返回一堆 ()s（putStrLn 的返回值），并且 print 也将其打印出来。

当您使用它时，现在 print xs 已经消失了，您可以摆脱 xs 变量绑定，并将 sequence 放入 sequence_ 以丢弃返回值，给出：

```
display :: Table -> IO()
display zs = sequence_ [putStrLn (a++" = "++b) | (a,b) <- zs] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T05:56:44.027

你甚至可以使用`mapM`：

```
display :: Table -> IO ()
display = mapM_ (\(a,b) -> putStrLn (a++" = "++b)) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-05T08:08:59.217

我同意 ja 的观点，即您应该将代码拆分为两个函数：

*   一个*纯粹*的部分：一个将你的数据结构转化为字符串的函数
*   *不纯*的部分，将字符串呈现到控制台

这是一个简单的实现：

```
showTable :: Table -> String
showTable xs = concatMap format xs
  where
    format (a, b) = a ++ " : " ++ b ++ "\n"

display :: Table -> IO ()
display table = putStr (showTable table) 
```

这种设计有两个优点：

一方面，你的大部分“逻辑”都在代码的纯部分中，这很好，以一种函数式编程的方式。

其次，这只是简单的软件工程原理；如果您想在代码的另一部分格式化您的数据结构（似乎很可能），您现在有了一个可以使用的可重用函数。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T04:57:42.377

编写一个将元组转换为字符串的函数，按照您的意愿格式化。
然后 concatMap 该函数在您的列表中；打印结果。

# iphone - iPhone 内存管理和释放

> ID：822982
> 
> 赞同：6
> 
> 时间：2009-05-05T02:03:51.683
> 
> 标签：iphone, objective-c, cocoa, memory-management, nsview

这是我经常看到的一种常见做法（包括来自一本非常流行的 iPhone 开发者书籍）

在 .h 文件中：

```
@interface SomeViewController : UIViewController
{
  UIImageView *imgView;
} 
```

.m 文件中的某处：

```
imgView = [[UIImageView alloc] initWithFrame:[[UIScreen mainScreen]
applicationFrame]];
[imgView setImage:[UIImage imageNamed:@"someimage.png"]];
[self addSubview:imgView];
[imgView release]; 
```

后来，我们看到了这个...

```
- (void) dealloc
{
  [imgView release];
  [super dealloc];

} 
```

既然imgView有一个匹配的alloc和release，那么dealloc中imgView的release是否有必要呢？

addSubview 调用保留的 imgView 在哪里占？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T02:13:38.977

代码不正确。你最终会`imgView`在它被释放后释放。

在您的 .m 文件中，您：

1.  `alloc`它 --> 你拥有它
2.  将其添加为子视图->您和[UIView 拥有它](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instm/UIView/addSubview:)
3.  `release`它 --> 你不拥有它

然后在 中`dealloc`，您`release`imgView 即使正如我们在上面的步骤 3 中建立的那样，您并不拥有它。当您调用`[super dealloc]`时，视图将释放其所有子视图，我想您会遇到异常。

如果您想保留 ivar `imgView`，我建议您在将其添加为子视图后*不要*调用，并保持不变。这样，即使在某个点从视图层次结构中删除，您仍然可以对它进行有效引用。`release``dealloc``imgView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T02:24:57.047

代码不正确，您不应该在调用 dealloc 时在 init 方法中释放它（也就是说，如果您想将其保留为 ivar，则不需要，除非您需要在其他地方指向它的指针，因为 addSubview ：将为您保留视图）。

我相信它实际上没有崩溃的原因是因为它仍然被超类保留（来自对 addSubview 的调用：），所以当它在 dealloc 中释放时，实际上已经平衡了。该视图可能会在它之后立即被释放时从父视图中删除，因此当`[super dealloc]`被调用时它不会被过度释放。这是我的预感，至少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T02:39:09.510

初始化中的释放不正确。

您提到了“常见做法”和一本未命名的书。我建议查看 Apple 的规范示例：ViewTransitions 是这种情况的一个很好的示例（以及 2 个要启动的视图；）

[http://developer.apple.com/iphone/library/samplecode/ViewTransitions/index.html](http://developer.apple.com/iphone/library/samplecode/ViewTransitions/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T12:39:59.893

`[imgView release]`基本答案是，示例代码中应该只有一个（*无论是在 addSubview 之后还是在 dealloc 中*）。但是，我会`[imgView release]`在.`dealloc``addSubview`

iPhone有一个问题；使用`didReceiveMemoryWarning`，您可以将对象（*包括整个视图*）从您的下方释放出来。如果您有一个应用程序范围的保留集并且您不尊重内存，那么您可能会发现应用程序只是被杀死了。

一个很好的例子是：
如果您考虑嵌套的 3 个视图集，视图 1-> 视图 2-> 视图 3。接下来，考虑 ' `viewDidLoad`' 和 ' `viewDidUnload`' 调用。如果用户当前处于“视图 3”中，则视图 1 可能已卸载，这就是它变得令人讨厌的地方。
如果您在其中分配了一个对象`viewDidLoad`并且在将其添加到子视图后没有释放它，那么当 view1 卸载时您的对象不会被释放，但是 view1 仍然被卸载。
`viewDidLoad`将再次运行，您的代码将再次运行，但现在您的对象有两个实例而不是一个；一个对象将位于先前未加载的视图的无处，而新对象将用于当前可见的视图。冲洗、起泡并重复，您会发现您的应用程序因内存泄漏而崩溃。

在此示例中，如果给定的代码块是易失性的并且有机会再次执行（*无论是因为内存还是未加载的视图*），我`[imgView release];`将从 dealloc 中删除并在 addSubView 之后将其保留。

这是基本保留/释放概念的链接： [http ://www.otierney.net/objective-c.html#retain](http://www.otierney.net/objective-c.html#retain)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T02:33:30.287

（我还没有足够的声誉来**添加评论**。）

@bentford：如果我错了，请纠正我，但我相信为了使用 imgView 属性的综合设置器，您必须使用“self.imgView”：

```
self.imgView = [[UIImageView alloc] initWithFrame:[[UIScreen mainScreen] 
```

如果你没有**自我。**，它只是使用 ivar，并没有获得额外的保留。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-14T03:20:29.387

是的，该代码有问题。它~~过早释放 imgView 可能会在极少数情况下导致崩溃~~将对象存储在实例变量中而不保留它，而且它通常只是以错误的方式进行内存管理。

一种正确的方法是：

```
@interface SomeViewController : UIViewController
{
    UIImageView *imgView;
}
@property (nonatomic, retain) UIImageView *imgView; 
```

并在实施中；

```
@synthesize imgView; 
```

模块中的某处：

```
//Create a new image view object and store it in a local variable (retain count 1)
UIImageView *newImgView = [[UIImageView alloc] initWithFrame:self.view.bounds];
newImgView.image = [UIImage imageNamed:@"someimage.png"];

//Use our property to store our new image view as an instance variable,
//if an old value of imgView exists, it will be released by generated method,
//and our newImgView gets retained (retain count 2)
self.imgView = newImgView;

//Release local variable, since the new UIImageView is safely stored in the
//imgView instance variable. (retain count 1)
[newImgView release];

//Add the new imgView to main view, it's retain count will be incremented,
//and the UIImageView will remain in memory until it is released by both the
//main view and this controller. (retain count 2)
[self.view addSubview:self.imgView]; 
```

并且 dealloc 保持不变：

```
- (void) dealloc
{
    [imgView release];
    [super dealloc];
} 
```

# java - 为什么 getLocalhost() 有时会冻结？

> ID：822991
> 
> 赞同：1
> 
> 时间：2009-05-05T02:09:16.837
> 
> 标签：java, eclipse

对于 JRE6（Windows XP 上的 SUN VM），getLocalhost() 有时会冻结。

有趣的是，如果在 Eclipse 中的调试器中，它不会冻结。我使用老式 println 将其缩小到单个 getLocalhost() 调用。我可以看到，代码没有什么特别之处。

有没有其他人看到这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T05:51:23.573

你没有具体说明它冻结了多长时间......或者你的意思是完全冻结，永远不会回来。

如果本地主机名（从 JNI 调用返回）不是“localhost”，则使用 InetAddress.getAddressFromNameService() 解析本地名称的 IP 地址。这是一个 DNS 调用，可能会在未指定的时间内阻止查找和访问名称服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T13:36:53.037

使用wireshark 查看您的DNS 是否需要很长时间才能响应。*******